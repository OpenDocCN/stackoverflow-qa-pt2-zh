# StackOverflow 问答 14630000-14630999

# ios - 可扩展表格中的标题图像无法调整大小

> ID：14630001
> 
> 赞同：0
> 
> 时间：2013-01-31T16:05:15.367
> 
> 标签：ios, iphone, xcode, uitableview, expandable

我对 Xcode 很陌生，这个简单的问题让我发疯了！我创建了一个可以正常工作的可扩展表。这是 UIView 子类上的一些代码，用于在您点击单元格时展开的部分：

```
- (id)initWithFrame:(CGRect)frame WithTitle: (NSString *) title Section:(NSInteger)sectionNumber delegate: (id <SectionView>) Delegate
{
self = [super initWithFrame:frame];
if (self) {

    UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(discButtonPressed:)];
    [self addGestureRecognizer:tapGesture];

    self.userInteractionEnabled = YES;

    self.section = sectionNumber;
    self.delegate = Delegate;

    CGRect LabelFrame = CGRectMake(100, 100, 100, 100);
    LabelFrame.size.width -= 100;
    CGRectInset(LabelFrame, 1.0, 1.0);

    //BUTTON 
    CGRect buttonFrame = CGRectMake(LabelFrame.size.width, 0, 100, LabelFrame.size.height);
    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    button.frame = buttonFrame;
    //[button setImage:[UIImage imageNamed:@"carat.png"] forState:UIControlStateNormal];
    //[button setImage:[UIImage imageNamed:@"carat-open.png"] forState:UIControlStateSelected];
    [button addTarget:self action:@selector(discButtonPressed:) forControlEvents:UIControlEventTouchUpInside];
    [self addSubview:button];
    self.discButton = button;

    //My IMAGE
    NSString *imageName = @"gradient1.png";
    UIImage *myImage = [UIImage imageNamed:imageName];
    UIImageView *sectionHeaderView = [[UIImageView alloc] initWithImage:myImage];
    UIImageView *imageView = [[UIImageView alloc] initWithImage:myImage];
    imageView.frame = CGRectMake(20,50,100,100);
    [self addSubview:sectionHeaderView];
    self.headerBG = sectionHeaderView;

    //HEADER LABEL
    UILabel *label = [[UILabel alloc] initWithFrame: CGRectMake(22, 12, sectionHeaderView.frame.size.width, 35.0)];
    label.textAlignment = NSTextAlignmentLeft;
    label.backgroundColor = [UIColor clearColor];
    label.textColor = [UIColor whiteColor];
    label.shadowColor = [UIColor darkGrayColor];
    label.shadowOffset = CGSizeMake(0.0, -1.0);
    label.text = title;
    label.font = [UIFont fontWithName:@"AvenirNext-Bold" size:20.0];
    sectionHeaderView.backgroundColor = [UIColor clearColor];
    //label.textAlignment = UITextAlignmentLeft;
    [self addSubview:label];
    self.sectionTitle = label;
}

return self;
} 
```

我在单元格 @"gradient1.png" 上有一个自定义图像，但我似乎无法调整它的大小？这是 UITableViewController 中的标头代码：

```
 - (UIView *) tableView:(UITableView *)tableView viewForHeaderInSection:   (NSInteger)section
  {
SectionInfo *array  = [self.sectionInfoArray objectAtIndex:section];
if (!array.sectionView)
{
    NSString *title = array.category.name;
    array.sectionView = [[SectionView alloc] initWithFrame:CGRectMake(0, 10, self.tableView.bounds.size.width, 0) WithTitle:title Section:section delegate:self];
}
return array.sectionView;
} 
```

抱歉，如果这是一个微不足道的问题，非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:18:43.697

我看不到您要在哪里调整图像大小，所以我无法提供任何帮助说明为什么它没有调整大小，但我发现这令人困惑：

```
//My IMAGE
    NSString *imageName = @"gradient1.png";
    UIImage *myImage = [UIImage imageNamed:imageName];
    UIImageView *sectionHeaderView = [[UIImageView alloc] initWithImage:myImage];
    UIImageView *imageView = [[UIImageView alloc] initWithImage:myImage];
    imageView.frame = CGRectMake(20,50,100,100);
    [self addSubview:sectionHeaderView];
    self.headerBG = sectionHeaderView; 
```

在这部分代码中，您创建两个图像视图，然后调整一个的大小并将另一个添加到单元格（我假设是单元格）子视图中。您是否可能正在尝试调整从未添加为单元格子视图的视图的大小？

此外，调整大小应该发生在`- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`.

确保您调整了正确的视图大小，十确保您在正确的位置调整了它的大小。

# c# - 从方法调用 2 个输入值

> ID：14630005
> 
> 赞同：-1
> 
> 时间：2013-01-31T16:05:19.487
> 
> 标签：c#, oop

几天来，我一直在努力解决这个概念。我有一个包含 3 个类的控制台程序：

1) 主程序
2) 创建登录屏幕
3) 实际登录屏幕

这是代码：

```
class Program
{
    static void Main(string[] args)
    {           
       //Instantiate Main Menu
        Menu myMenu = new Menu();
        myMenu.mainMenu();

        //testing global values
        Login myLogin = new Login();
        Console.Write("The new Login is ");
        Console.WriteLine(myLogin.newLogin);

        //Pause
        Console.WriteLine("Press Any Key...");
        Console.ReadLine();
    }
}

class Menu
{         
    public void mainMenu()
    {          
        // [create menu that prints choices on the screen]
        start:
        Console.Clear();
        Console.WriteLine("PLEASE CHOOSE AN OPTION");
        Console.WriteLine();
        Console.WriteLine("[1] LOGIN \n[2] CREATE LOGIN");
        Console.WriteLine();
        Console.Write("> ");

        string menuChoice = Console.ReadLine();

        // [switch/case for Main Menu]
        switch (menuChoice) 
        {
            case "1":
                Console.WriteLine("You chose 1");
                break;
            case "2":                    
                // [instantiate createLogin]
                Login myLogin = new Login();                        
                myLogin.createLogin(); 
                Console.WriteLine(myLogin.newLogin);
                break;
            default:
                Console.WriteLine("INVALID OPTION... TRY AGAIN.");
                System.Threading.Thread.Sleep(5000);
                goto start;

        }
}

class Login
{
    // [empty containers for newLogin & newPass]
    public string newLogin { get; set; }
    public string newPass { get; set; }

    public void createLogin()
    {
        // [display new login screen & assign newLogin & newPass]
        Console.Clear();
        Console.WriteLine("CREATE NEW LOGIN");
        Console.WriteLine();
        Console.Write("LOGIN: ");
        newLogin = Console.ReadLine();
        Console.Write("PASSWORD: ");            
        newPass = Console.ReadLine();

        // [instantiate & return to main menu]
        Menu myMenu = new Menu();
        myMenu.mainMenu();
    }
} 
```

现在，当我尝试从主程序输出代码时，值为空。我在这里有错误的结构吗？我真的不需要存储多个登录名并通过（目前），因此此时不需要数组，但我肯定会在以后学习。我是自学的，所以我尽量让事情变得简单，直到我确定这个概念。

我想存储 newLogin 和 newPass 并在 main.xml 中打印值。请帮忙。

谢谢迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:09:01.870

在这段代码中：

```
 .....
 case "2":                    
   // [instantiate createLogin]
   Login myLogin = new Login();
   Console.WriteLine(myLogin.newLogin);  //WRITE TO CONSOLE
   myLogin.createLogin();                // QUERY AFTER WRITE
 ...... 
```

您*首先*编写一个空登录，然后只查询它。因此，您在屏幕上看不到任何登录信息是“正常的”，因为它是在初始化*之前*打印的，之后再也没有打印过。

要解决此问题，只需反转函数调用：

```
 .....
 case "2":                    
   // [instantiate createLogin]
   Login myLogin = new Login();       
   myLogin.createLogin();                // QUERY 
   Console.WriteLine(myLogin.newLogin);  //WRITE TO CONSOLE
 ... 
```

**编辑**

如果您想操作 over `Login`，可能的解决方案之一是：

```
class Menu
{
    private Login _login = new Login(); // EVERYWHERE IN MENU USE THIS FIELD, THE SAME INSTANCE

.....
 case "2":                    
   // [instantiate createLogin]
   //Login myLogin = new Login();        NO MORE NEW INSTANCE BUT USE ALREADY AVAILABLE ONE
   _login.createLogin();                // QUERY 
   Console.WriteLine(_login .newLogin);  //WRITE TO CONSOLE
 ...

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:11:49.273

您确定它在 Main() 中显示为 null 吗？您还在`myLogin.newLogin`菜单开关/外壳中打印。当您在菜单中打印它时，您会在调用 myLogin.createLogin() 之前打印它，因此它应该为空，但是当它返回到 Main() 时，它应该被正确设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T16:03:25.087

我找到了答案。它可能不是最好的，但它确实有效。一旦我纠正了查询/写入问题（如上所列），我开始更多地考虑实例，并意识到通过创建新实例我实际上是在清除数据。对不起上限，但我的目的是帮助其他一些自学者。

好的，所以理论上我想在案例中调用 createLogin 方法后保留它。我该如何保留它？我将 createLogin、newLogin 和 newPass 类设为静态，以便可以分配值，然后可以从 main 调用该类。通过调用它而不实例化它，它保持分配的值。

```
class Login
    {
    // [empty containers for newLogin & newPass]
    public static string newLogin { get; set; }
    public static string newPass { get; set; }

public static void createLogin()
{           
    // [display new login screen & assign values]
    Console.Clear();
    Console.WriteLine("CREATE NEW LOGIN");
    Console.WriteLine();
    Console.Write("LOGIN: ");
    newLogin = Console.ReadLine();
    Console.Write("PASSWORD: ");            
    newPass = Console.ReadLine();

    // [instantiate & return to main menu]
    //Menu myMenu = new Menu();
    //myMenu.mainMenu();
} 
```

主要是：

```
//testing global values            
            Console.Write("The new Login is ");                  
            Console.WriteLine(Login.newLogin); 
```

这工作，感谢大家的贡献。正是在其他人的评论中，我才能够弄清楚这一点。希望我的解决方案对其他人来说是清楚的。和平。

# php - 从本地文件访问 mysql db 和服务器端脚本

> ID：14630009
> 
> 赞同：0
> 
> 时间：2013-01-31T16:05:33.243
> 
> 标签：php, javascript, css, html, firefox-os

这是更一般的设计问题。我的主要项目是为 Firefox OS 创建原生应用程序。这意味着 JavaScript、jQuery、HTML5 和 css。这个应用程序应该有几个功能。但是作为一般设计，我需要在 firefox 操作系统下运行本地 html、css、js 应用程序，并且能够访问服务器 php 脚本和 mysql db，但是由于应用程序在客户端运行，所以我在应用程序和服务器之间的通信方面存在重大问题. 我可以使用哪些技术、语言、API 或 JS 函数进行登录检查、注册、消息传递。如何从本地（PC 或移动设备）文件访问服务器。有可能我遗漏了一些观点，或者我对问题的整体理解是错误的，但这可能吗？如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:08:34.963

> 应用程序是使用标准 Web 技术构建的，带有额外的元数据，允许用户代理发现、安装、启动和授予他们额外的权限。

所以说[MDN](https://developer.mozilla.org/en-US/docs/apps)。

与远程共享​​数据库交互的常用方法是在它们前面放置一个 RESTful HTTP 前端并使用 JavaScript/XMLHttpRequest 访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T09:51:32.160

XHR、WebSocket 或 TCPSocket。

财政年度：

*   [https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest)
*   [https://developer.mozilla.org/en/docs/WebSockets](https://developer.mozilla.org/en/docs/WebSockets)
*   MDN 上没有 TCPSocket 文档，但是可以学习 gaia email app。
    *   [https://raw.github.com/mozilla-b2g/gaia/master/apps/email/js/ext/gaia-email-opt.js](https://raw.github.com/mozilla-b2g/gaia/master/apps/email/js/ext/gaia-email-opt.js)

# css - 下拉 CSS 导航在 Firefox 中不起作用

> ID：14630013
> 
> 赞同：1
> 
> 时间：2013-01-31T16:05:49.657
> 
> 标签：css, list, firefox, drop-down-menu, navigation

我正在努力让我的网站启动并运行，但我在 Firefox 中的下拉导航菜单遇到了问题。

我一直在 Chrome 中使用该站点，它运行良好，它是一个简单的嵌套列表设置，用于选择。选项出现，但它们浮动到左侧，而不是直接位于相应部分的下方。

CSS：

```
/*sub-menu navigation*/
nav.primary ul ul 
{
    opacity: 0;
    filter: alpha(opacity=0);

    position: absolute;
    z-index: 999;
    background: #111111;

    height: 0px;
    overflow: hidden;

    min-width: 100%;

    -webkit-transition: opacity 0.4s ease-out;
    -moz-transition: opacity 0.4s ease-out;
    -o-transition: opacity 0.4s ease-out;
    -ms-transition: opacity 0.4s ease-out;
    transition: opacity 0.4s ease-out;

    -webkit-box-shadow: 0px 2px 2px rgba(0,0,0,0.3);
    -moz-box-shadow: 0px 2px 2px rgba(0,0,0,0.3);
    box-shadow: 0px 2px 2px rgba(0,0,0,0.3);
}

nav.primary ul li:hover ul 
{
    opacity: 10;
    filter: alpha(opacity=100);

    height: auto;
    overflow: auto;
}

nav.primary ul ul li 
{
    float: none;
    display: list-item;
    border-bottom: 1px solid #747474;
}

nav.primary ul ul li a 
{
    display: block;
    margin-left: 10px;
    line-height: 40px;
    font-size: 0.8em;
   /*text-transform: none;*/
    font-family: 'LibbyRegular', Helvetica, Arial, sans-serif;
} 
```

菜单 HTML

```
<ul>
                <li><a href="portfolio.html#individual" title="individual">independent work</a>

                    <ul>
                        <li><a href="bigAndUgly.html">>> big and ugly</a></li>
                        <li><a href="iceworld.html">>> iceworld</a></li>
                        <li><a href="gordonsGotGame.html">>> gordon's got game</a></li>
                    </ul>

                </li>
                <li><a href="portfolio.html#team" title="team">team projects</a>

                    <ul>
                        <li><a href="blastrobots.html">>> blastrobots</a></li>
                        <li><a href="#">>> ruined</a></li>
                    </ul>

                </li>
                <li><a href="portfolio.html#scripting" title="scripting">scripting</a>

                <ul>
                        <li><a href="#">>> hero man (C#)</a></li>
                        <li><a href="#">>> CloneOut (lua)</a></li>
                        <li><a href="#">>> shotgun (unrealscript)</a></li>
                    </ul>

                </li>
                <li><a href="resume.html" title="resume">resume</a></li>
            </ul> 
```

如果您想测试它，该站点是[http://lvsherman.com 。](http://lvsherman.com)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:14:37.223

尝试添加到您的内部 UL 元素。

```
left: 0;
top: WHATEVER; 
```

# mysql - MySQL：选择查询

> ID：14630016
> 
> 赞同：0
> 
> 时间：2013-01-31T16:05:57.960
> 
> 标签：mysql

我有一个表名 item_data，其中包含以下列和值：

```
id | name |value | price | matching_item
1  | item1|  5   | 1500  | NULL
2  | item2|  6   | 1700  | NULL
3  | item3|  4   |  500  | item1
4  | item3|  8   | 2000  | NULL 
```

我使用了一个选择查询：

```
SELECT * from `item_data` WHERE (value = 4) AND (price > 100); 
```

然后它给了我这样的结果：

```
id | name |  value | price | matching_item
3  | item3|    4   |   500 |    item1 
```

但我想要一个查询，它给我的结果如下：

```
id | name |  value | price | matching_item
3  | item3|    4   | 500   |    item1
1  | item1|    5   | 1500  |   NULL 
```

我想要配对结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:07:59.763

也许你只需要改变你的条件：

```
 SELECT * from item_data WHERE value IN (4,5) AND (price > 100) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:15:45.010

在没有真正理解您的问题（请更具描述性）的情况下，我的猜测是您想将找到的结果中的 matching_item 列加入到 name 列并返回该行以及找到的结果？

如果是这样，请考虑使用 UNION 来获得您想要的结果：

```
SELECT i.*
FROM Item_Data i
  LEFT JOIN Item_Data i2 on i.matching_item = i2.name
WHERE i.value = 4 and i.price > 100
UNION
SELECT i2.*
FROM Item_Data i
  INNER JOIN Item_Data i2 on i.matching_item = i2.name
WHERE i.value = 4 and i.price > 100 
```

还有[小提琴](http://sqlfiddle.com/#!2/7aab1/3)。

这是没有 UNION 的另一种方法：

```
SELECT i3.*
FROM Item_Data i
  LEFT JOIN Item_Data i2 on i.matching_item = i2.name
  LEFT JOIN Item_Data i3 on i3.id in (i.id, i2.id)
WHERE i.value = 4 and i.price > 100 
```

还有[小提琴](http://sqlfiddle.com/#!2/7aab1/4)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:16:17.680

好像你想要这个：

```
select *
from item_data i
where exists (select *
              from item_data d
              WHERE 
              (
                value = 4 
                AND price > 100
                and i.id = d.id
              )
              or i.name = d.matching_item); 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/79d5f/17)

返回结果：

```
| ID |  NAME | VALUE | PRICE | MATCHING_ITEM |
----------------------------------------------
|  1 | item1 |     5 |  1500 |        (null) |
|  3 | item3 |     4 |   500 |         item1 | 
```

# php - 如何用 PHP 解析这个 Google JSON 响应？

> ID：14630021
> 
> 赞同：0
> 
> 时间：2013-01-31T16:06:10.893
> 
> 标签：php, arrays, json, object, google-api

我想知道 Lat / Lng 的地名。为此，我找到了 Google API。我写的程序是

```
<?php

$url = 'http://maps.googleapis.com/maps/api/geocode/json?latlng=13.74349%2C100.489067&sensor=false';

$data = json_decode(file_get_contents($url));

echo '<pre>';

print_r($data);

?> 
```

输出如下

```
Array
(
    [0] => stdClass Object
        (
            [results] => Array
                (
                    [0] => stdClass Object
                        (
                            [address_components] => Array
                                (
                                    [0] => stdClass Object
                                        (
                                            [long_name] => Wang Doem 8
                                            [short_name] => Wang Doem 8
                                            [types] => Array
                                                (
                                                    [0] => route
                                                )

                                        )

                                    [1] => stdClass Object
                                        (
                                            [long_name] => Wat Arun
                                            [short_name] => Wat Arun
                                            [types] => Array
                                                (
                                                    [0] => sublocality
                                                    [1] => political
                                                )

                                        )

                                    [2] => stdClass Object
                                        (
                                            [long_name] => Bangkok Yai
                                            [short_name] => Bangkok Yai
                                            [types] => Array
                                                (
                                                    [0] => sublocality
                                                    [1] => political
                                                )

                                        )

                                    [3] => stdClass Object
                                        (
                                            [long_name] => Bangkok
                                            [short_name] => Bangkok
                                            [types] => Array
                                                (
                                                    [0] => locality
                                                    [1] => political
                                                )

                                        )

                                    [4] => stdClass Object
                                        (
                                            [long_name] => Thailand
                                            [short_name] => TH
                                            [types] => Array
                                                (
                                                    [0] => country
                                                    [1] => political
                                                )

                                        )

                                    [5] => stdClass Object
                                        (
                                            [long_name] => 10600
                                            [short_name] => 10600
                                            [types] => Array
                                                (
                                                    [0] => postal_code
                                                )

                                        )

                                )

                            [formatted_address] => Wang Doem 8, Wat Arun, Bangkok Yai, Bangkok 10600, Thailand
                            [geometry] => stdClass Object
                                (
                                    [bounds] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.7448616
                                                    [lng] => 100.4888865
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.7445018
                                                    [lng] => 100.4876895
                                                )

                                        )

                                    [location] => stdClass Object
                                        (
                                            [lat] => 13.7446807
                                            [lng] => 100.4882883
                                        )

                                    [location_type] => APPROXIMATE
                                    [viewport] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.7460306803
                                                    [lng] => 100.48963698
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.7433327197
                                                    [lng] => 100.48693902
                                                )

                                        )

                                )

                            [types] => Array
                                (
                                    [0] => route
                                )

                        )

                    [1] => stdClass Object
                        (
                            [address_components] => Array
                                (
                                    [0] => stdClass Object
                                        (
                                            [long_name] => Wat Arun
                                            [short_name] => Wat Arun
                                            [types] => Array
                                                (
                                                    [0] => sublocality
                                                    [1] => political
                                                )

                                        )

                                    [1] => stdClass Object
                                        (
                                            [long_name] => Bangkok Yai
                                            [short_name] => Bangkok Yai
                                            [types] => Array
                                                (
                                                    [0] => sublocality
                                                    [1] => political
                                                )

                                        )

                                    [2] => stdClass Object
                                        (
                                            [long_name] => Bangkok
                                            [short_name] => Bangkok
                                            [types] => Array
                                                (
                                                    [0] => locality
                                                    [1] => political
                                                )

                                        )

                                    [3] => stdClass Object
                                        (
                                            [long_name] => Thailand
                                            [short_name] => TH
                                            [types] => Array
                                                (
                                                    [0] => country
                                                    [1] => political
                                                )

                                        )

                                    [4] => stdClass Object
                                        (
                                            [long_name] => 10600
                                            [short_name] => 10600
                                            [types] => Array
                                                (
                                                    [0] => postal_code
                                                )

                                        )

                                )

                            [formatted_address] => Wat Arun, Bangkok Yai, Bangkok 10600, Thailand
                            [geometry] => stdClass Object
                                (
                                    [bounds] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.7481218
                                                    [lng] => 100.4919267
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.7361885
                                                    [lng] => 100.4803822
                                                )

                                        )

                                    [location] => stdClass Object
                                        (
                                            [lat] => 13.7434901
                                            [lng] => 100.4890647
                                        )

                                    [location_type] => APPROXIMATE
                                    [viewport] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.7481218
                                                    [lng] => 100.4919267
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.7361885
                                                    [lng] => 100.4803822
                                                )

                                        )

                                )

                            [types] => Array
                                (
                                    [0] => sublocality
                                    [1] => political
                                )

                        )

                    [2] => stdClass Object
                        (
                            [address_components] => Array
                                (
                                    [0] => stdClass Object
                                        (
                                            [long_name] => Bangkok Yai
                                            [short_name] => Bangkok Yai
                                            [types] => Array
                                                (
                                                    [0] => sublocality
                                                    [1] => political
                                                )

                                        )

                                    [1] => stdClass Object
                                        (
                                            [long_name] => Bangkok
                                            [short_name] => Bangkok
                                            [types] => Array
                                                (
                                                    [0] => locality
                                                    [1] => political
                                                )

                                        )

                                    [2] => stdClass Object
                                        (
                                            [long_name] => Thailand
                                            [short_name] => TH
                                            [types] => Array
                                                (
                                                    [0] => country
                                                    [1] => political
                                                )

                                        )

                                    [3] => stdClass Object
                                        (
                                            [long_name] => 10600
                                            [short_name] => 10600
                                            [types] => Array
                                                (
                                                    [0] => postal_code
                                                )

                                        )

                                )

                            [formatted_address] => Bangkok Yai, Bangkok 10600, Thailand
                            [geometry] => stdClass Object
                                (
                                    [bounds] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.7481218
                                                    [lng] => 100.4919267
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.722343
                                                    [lng] => 100.4615641
                                                )

                                        )

                                    [location] => stdClass Object
                                        (
                                            [lat] => 13.7341183
                                            [lng] => 100.4761897
                                        )

                                    [location_type] => APPROXIMATE
                                    [viewport] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.7481218
                                                    [lng] => 100.4919267
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.722343
                                                    [lng] => 100.4615641
                                                )

                                        )

                                )

                            [types] => Array
                                (
                                    [0] => sublocality
                                    [1] => political
                                )

                        )

                    [3] => stdClass Object
                        (
                            [address_components] => Array
                                (
                                    [0] => stdClass Object
                                        (
                                            [long_name] => 10600
                                            [short_name] => 10600
                                            [types] => Array
                                                (
                                                    [0] => postal_code
                                                )

                                        )

                                    [1] => stdClass Object
                                        (
                                            [long_name] => Wat Tha Phra
                                            [short_name] => Wat Tha Phra
                                            [types] => Array
                                                (
                                                    [0] => sublocality
                                                    [1] => political
                                                )

                                        )

                                    [2] => stdClass Object
                                        (
                                            [long_name] => Bangkok Yai
                                            [short_name] => Bangkok Yai
                                            [types] => Array
                                                (
                                                    [0] => sublocality
                                                    [1] => political
                                                )

                                        )

                                    [3] => stdClass Object
                                        (
                                            [long_name] => Bangkok
                                            [short_name] => Bangkok
                                            [types] => Array
                                                (
                                                    [0] => locality
                                                    [1] => political
                                                )

                                        )

                                    [4] => stdClass Object
                                        (
                                            [long_name] => Thailand
                                            [short_name] => TH
                                            [types] => Array
                                                (
                                                    [0] => country
                                                    [1] => political
                                                )

                                        )

                                )

                            [formatted_address] => Wat Tha Phra, Bangkok Yai, Bangkok 10600, Thailand
                            [geometry] => stdClass Object
                                (
                                    [bounds] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.7481218
                                                    [lng] => 100.5127718
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.694656
                                                    [lng] => 100.4615641
                                                )

                                        )

                                    [location] => stdClass Object
                                        (
                                            [lat] => 13.7247046
                                            [lng] => 100.4958678
                                        )

                                    [location_type] => APPROXIMATE
                                    [viewport] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.7481218
                                                    [lng] => 100.5127718
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.694656
                                                    [lng] => 100.4615641
                                                )

                                        )

                                )

                            [types] => Array
                                (
                                    [0] => postal_code
                                )

                        )

                    [4] => stdClass Object
                        (
                            [address_components] => Array
                                (
                                    [0] => stdClass Object
                                        (
                                            [long_name] => Bangkok
                                            [short_name] => Bangkok
                                            [types] => Array
                                                (
                                                    [0] => locality
                                                    [1] => political
                                                )

                                        )

                                    [1] => stdClass Object
                                        (
                                            [long_name] => Thailand
                                            [short_name] => TH
                                            [types] => Array
                                                (
                                                    [0] => country
                                                    [1] => political
                                                )

                                        )

                                )

                            [formatted_address] => Bangkok, Thailand
                            [geometry] => stdClass Object
                                (
                                    [bounds] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.9551109
                                                    [lng] => 100.9384077
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.4940968
                                                    [lng] => 100.3277368
                                                )

                                        )

                                    [location] => stdClass Object
                                        (
                                            [lat] => 13.7522222
                                            [lng] => 100.4938889
                                        )

                                    [location_type] => APPROXIMATE
                                    [viewport] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.9551109
                                                    [lng] => 100.9384077
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.4940968
                                                    [lng] => 100.3277368
                                                )

                                        )

                                )

                            [types] => Array
                                (
                                    [0] => locality
                                    [1] => political
                                )

                        )

                    [5] => stdClass Object
                        (
                            [address_components] => Array
                                (
                                    [0] => stdClass Object
                                        (
                                            [long_name] => Bangkok
                                            [short_name] => Bangkok
                                            [types] => Array
                                                (
                                                    [0] => administrative_area_level_1
                                                    [1] => political
                                                )

                                        )

                                    [1] => stdClass Object
                                        (
                                            [long_name] => Thailand
                                            [short_name] => TH
                                            [types] => Array
                                                (
                                                    [0] => country
                                                    [1] => political
                                                )

                                        )

                                )

                            [formatted_address] => Bangkok, Thailand
                            [geometry] => stdClass Object
                                (
                                    [bounds] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.9551109
                                                    [lng] => 100.9384077
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.4940968
                                                    [lng] => 100.3277368
                                                )

                                        )

                                    [location] => stdClass Object
                                        (
                                            [lat] => 13.7234186
                                            [lng] => 100.4762319
                                        )

                                    [location_type] => APPROXIMATE
                                    [viewport] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 13.9551109
                                                    [lng] => 100.9384077
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 13.4940968
                                                    [lng] => 100.3277368
                                                )

                                        )

                                )

                            [types] => Array
                                (
                                    [0] => administrative_area_level_1
                                    [1] => political
                                )

                        )

                    [6] => stdClass Object
                        (
                            [address_components] => Array
                                (
                                    [0] => stdClass Object
                                        (
                                            [long_name] => Thailand
                                            [short_name] => TH
                                            [types] => Array
                                                (
                                                    [0] => country
                                                    [1] => political
                                                )

                                        )

                                )

                            [formatted_address] => Thailand
                            [geometry] => stdClass Object
                                (
                                    [bounds] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 20.465143
                                                    [lng] => 105.636812
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 5.612851
                                                    [lng] => 97.343396
                                                )

                                        )

                                    [location] => stdClass Object
                                        (
                                            [lat] => 15.870032
                                            [lng] => 100.992541
                                        )

                                    [location_type] => APPROXIMATE
                                    [viewport] => stdClass Object
                                        (
                                            [northeast] => stdClass Object
                                                (
                                                    [lat] => 20.465143
                                                    [lng] => 105.636812
                                                )

                                            [southwest] => stdClass Object
                                                (
                                                    [lat] => 5.612851
                                                    [lng] => 97.343396
                                                )

                                        )

                                )

                            [types] => Array
                                (
                                    [0] => country
                                    [1] => political
                                )

                        )

                )

            [status] => OK
        )

) 
```

我不知道如何抓住`address_components`顶部。我尝试使用`$data[0]->results[0]->address_components`等。但它不起作用。请检查一次...谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:15:51.167

以下对我有用：

```
$data->results[0]->address_components[0]->long_name 
```

您可能还希望启用[json_decode](http://php.net/manual/en/function.json-decode.php)的`assoc`-parameter 以便将对象转换为关联数组。
例如

```
$data = json_decode(file_get_contents($url), true);
$data["results"][0]["address_components"][0]["long_name"] 
```

# javascript - 使用 Javascript 为 div 设置样式

> ID：14630023
> 
> 赞同：0
> 
> 时间：2013-01-31T16:06:16.057
> 
> 标签：javascript, css, firefox, cross-browser, styles

我需要让我的应用程序在所有浏览器上运行，我有一个 div，我使用语法在 Javascript 中设置 css 类

```
 divNew.className = "highlightItem"; 
```

它在 IE 上运行良好，但在 Firefox、Opera 和 Chrome 上它根本无法运行。我也尝试过其他版本，例如

```
 var theDiv = document.getElementById(divNew);
 theDiv.setAttribute("class", "highlightItem");
 theDiv.setAttribute("className", "highlightItem"); 
```

没有成功。通过样式设置所有属性也不起作用。

是否有任何其他方法可以为 div 设置 css 类以便它在上述浏览器上工作？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:11:06.420

在这条线上：

```
 var theDiv = document.getElementById(divNew); 
```

您需要将 div 的 id 作为字符串：

```
var theDiv = document.getElementById("my-div-ID"); 
```

除此之外它应该工作。

如果您想节省跨浏览器问题的时间，请查看[jQuery](http://api.jquery.com/addClass/) - 您只需执行以下操作：

```
$("#my-div-ID").addClass("highlightItem"); 
```

# django - 使用 AngularJS 和 Django 渲染模板隐藏 div

> ID：14630029
> 
> 赞同：1
> 
> 时间：2013-01-31T16:06:23.790
> 
> 标签：django, angularjs

我有一个由 Django 模板标签呈现的 HTML 表单，我想使用 AngularJS 来操作它。

在我的模板（未渲染）中，我有：

```
<html>
   <body>
       {{ form.as_p }}
   </body>
</html> 
```

这是 Django 呈现此模板的方式：

```
<html>
   <body>
      <form>
        <div id="div_id_street" class="ctrlHolder ">
        <label for="id_street">
            Street<span>*</span>
        </label>
        <input id="id_street" type="text" class="textInput textinput" name="street" maxlength="32">
        </div>
      </form>
   </body>
</html> 
```

我想隐藏 div **div_id_street**，但由于 Django 生成 HTML 代码的方式，我无法在我的 HTML 中添加 ng-show 或 ng-hide 指令。

是否可以在 AngularJS 控制器中显示/隐藏这个 div？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T18:08:41.267

我错了。可以更改 Django 呈现表单的模板。

在定义 django 表单时，我可以更改每个字段的小部件，因此我可以将 Angular 指令放入小部件中。

例如：

```
# forms.py
class MyForm(forms.Form):
    street = forms.CharField(max_length=80, 
        widget=forms.TextInput(attrs={
            'ng-model': 'street',
            'ng-show': 'false',
            'ng-change': 'validateStreet()',})
        ) 
```

这将呈现为：

```
<div id="div_street" class="ctrlHolder">
    <label for="id_street">Street</label>
    <input ng-model="street" name="street" maxlength="80" ng-change="validateStreet()"
      ng-show="false" type="text" class="textInput textinput ng-valid ng-dirty"
      id="id_street">
</div> 
```

所以在我的控制器中，我可以操纵整个领域。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:46:35.290

如果您无法修改模板，也不要向该特定 DIV 添加一个类来添加它`ng-show`，而是应该创建一个指令来处理此 DOM 操作。您不应该在控制器内进行 DOM 操作。正如[DOC 所述](http://docs.angularjs.org/guide/dev_guide.mvc.understanding_controller)，

> 不要将控制器用于：
> 
> *   任何类型的 DOM 操作——控制器应该只包含业务逻辑。DOM 操作——应用程序的表示逻辑——以难以测试而闻名。将任何表示逻辑放入控制器会显着影响业务逻辑的可测试性。Angular 为自动 DOM 操作提供数据绑定。如果您必须执行自己的手动 DOM 操作，请将表示逻辑封装在 [directives] [http://docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)中）。
> *   ...

我建议您使用所需的属性并从指令`$watch`的函数内部手动显示/隐藏元素。`link`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T17:09:37.437

> 是否可以在 AngularJS 控制器中显示/隐藏这个 div？

是的，但这“与 Angular 方式背道而驰” [——Misko](https://groups.google.com/forum/#!msg/angular/SYglWP_x7ew/lFtb75NWNWUJ)。注入 $element，然后使用选择器来查找和操作。$element 设置为定义控制器的元素。

```
function MyCtrl($scope, $element) {
  $scope.show = false;
  $scope.$watch('show', function (value) {
    if (value) {
        $element.find('#div_id_street').show();
    } else {
        $element.find('#div_id_street').hide();
    }
  })
} 
```

[小提琴](http://jsfiddle.net/nPmrS/)——在这个小提琴中，我使用了 ng-controller。

# css - 我可以在一个文件中包含多个 SVG 图像吗？

> ID：14630035
> 
> 赞同：23
> 
> 时间：2013-01-31T16:06:41.810
> 
> 标签：css, html, svg

而不是执行以下操作：

```
<html>
<body>
  <embed src="circle.svg" type="image/svg+xml" /> 
  <embed src="square.svg" type="image/svg+xml" /> 
  <embed src="triangle.svg" type="image/svg+xml" />  
</body>
</html> 
```

我宁愿做这样的事情

```
<html>
<body>
<embed src="shapes.svg" type="image/svg+xml" id="circle" /> 
<embed src="shapes.svg" type="image/svg+xml" id="square" /> 
<embed src="shapes.svg" type="image/svg+xml" id="triangle" />  
</body>
</html> 
```

带有可能看起来像这样的 svg 文件

```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" >

  <svg id="circle">
    <circle cx="100" cy="50" r="40" stroke="black"
    stroke-width="2" fill="red" />
  </svg> 

  <svg id="square">
    <rect width="100" height="100" style="fill:rgb(0,0,255);stroke-width:1;stroke:rgb(0,0,0)" />
  </svg>

  <svg id="triangle">
    <line x1="50" y1="0" x2="0" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
    <line x1="50" y1="0" x2="100" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
    <line x1="0" y1="50" x2="100" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
  </svg>
</svg> 
```

看起来 SVG 只是 XML，我应该能够将所有图像存储在一个文件中，该文件可以一次性下载并在整个站点中使用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-31T16:37:46.133

是的，但是 XML 文档需要一个根节点。你的有*三个*。尝试将三个节点包装在一个 svg 元素中，并将命名空间和版本号移动到它。似乎通过[http://validator.w3.org/check进行验证](http://validator.w3.org/check)

```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
    <svg id="circle">
      <circle cx="100" cy="50" r="40" stroke="black"
      stroke-width="2" fill="red" />
    </svg> 

    <svg id="square">
      <rect width="100" height="100" style="fill:rgb(0,0,255);stroke-width:1;stroke:rgb(0,0,0)" />
    </svg>

    <svg id="triangle">
      <line x1="50" y1="0" x2="0" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
      <line x1="50" y1="0" x2="100" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
      <line x1="0" y1="50" x2="100" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
    </svg>
</svg> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-31T16:45:45.620

html 文档中只能有一个根节点。尽管如此，有多种方法可以实现您想要的。

一种方法是[SVG 堆栈](http://simurai.com/post/20251013889/svg-stacks)，它的工作原理是将所有图形叠加在一起，然后使用 CSS 显示您想要查看的图形。

另一种方法可能是有一个像这样的shapes.svg，所有的图纸都在不同的地方

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">

  <g transform="translate(0,0)">
    <circle cx="100" cy="50" r="40" stroke="black" stroke-width="2" fill="red" />
  </g>

  <g transform="translate(0,200)">
    <rect width="100" height="100" style="fill:rgb(0,0,255);stroke-width:1;stroke:rgb(0,0,0)" />
  </g>
  <g transform="translate(0,400)">
    <line x1="50" y1="0" x2="0" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
    <line x1="50" y1="0" x2="100" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
    <line x1="0" y1="50" x2="100" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
  </g>
</svg> 
```

然后使用 svgView 只显示你想要的位。

```
<html>
<body>
<embed src="shapes.svg#svgView(viewBox(50,0,100,100))" style="width:100px;        height:100px" type="image/svg+xml" />
<embed src="shapes.svg#svgView(viewBox(0,200,100,100))" style="width:100px;height:100px" type="image/svg+xml"/> 
<embed src="shapes.svg#svgView(viewBox(0,400,100,100))" style="width:100px;height:100px" type="image/svg+xml"/>  
</body>
</html> 
```

所有这些确实意味着您在 UA 中使用了更多内存，因为整个 svg 文件被加载了 3 次，而您每次只能看到其中的一部分。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-05-01T17:43:32.517

**参考：**

```
<svg alt="">
    <use xlink:href="shapes.svg#circle"></use>
</svg>
<svg alt="">
    <use xlink:href="shapes.svg#square"></use>
</svg>
<svg alt="">
    <use xlink:href="shapes.svg#triangle"></use>
</svg> 
```

**形状.svg：**

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <symbol id="circle">
        <circle cx="100" cy="50" r="40" stroke="black" stroke-width="2" fill="red" />
    </symbol>
    <symbol id="square">
        <rect width="100" height="100" style="fill:rgb(0,0,255);stroke-width:1;stroke:rgb(0,0,0)" />
    </symbol>
    <symbol id="triangle">
        <line x1="50" y1="0" x2="0" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
        <line x1="50" y1="0" x2="100" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
        <line x1="0" y1="50" x2="100" y2="50" style="stroke:rgb(255,0,0);stroke-width:2" />
    </symbol>
</svg> 
```

# ember.js - 从使用 Ember-data 检索的 RecordArray 填充 Ember.Select 视图的内容

> ID：14630037
> 
> 赞同：5
> 
> 时间：2013-01-31T16:06:44.493
> 
> 标签：ember.js

我有一个使用此代码创建的选择列表：

```
 {{view Ember.Select
      contentBinding="App.riskCategories"
      optionValuePath="content.id"
      optionLabelPath="content.name"
      selectionBinding="riskCategory"
      class="input-medium"}} 
```

*riskCategory是为模板加载的**App.Facility*模型的属性，*App.RiskCategory*的列表中填充了以下代码：

```
App.ready = function() {
  App.riskCategories = App.RiskCategory.all()
} 
```

这可以正常工作并填充选择列表，但仅使用已加载到浏览器中的风险类别子集。如果我从浏览器控制台调用*App.RiskCategory.find()*则加载其余部分并更新选择列表，但是我无法让代码为我执行此操作。

所以我尝试了：

```
App.ready = function() {
  App.riskCategories = App.RiskCategory.find()
} 
```

或者：

```
App.ready = function() {
  App.RiskCategory.find()
  App.riskCategories = App.RiskCategory.all()
} 
```

但这两者都会导致以下错误：

```
Uncaught Error: Attempted to handle event `loadedData` on <App.Facility:ember417:1> while in state rootState.loaded.updated.uncommitted. Called with undefined 
```

对于填充选择列表的更好方式的任何帮助或建议，我将不胜感激。这些*App.RiskCategory*对象应被视为存储在数据库中的不可变常量集合。每个*App.Facility*对象都与这些*App.RiskCategories之一相关联*

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:55:41.650

尝试在路由中设置类别并通过控制器在模板中访问它

```
APP.YourRoute = Ember.Route.extend({
    setupController:function(controller,model) {
       this._super(controller,model);
       controller.set('riskCategories',App.RiskCategory.find());
    },  

}); 
```

假设您的选择视图与控制器在同一上下文中，您可以通过以下方式访问模板中的类别：

```
{{view Ember.Select
  contentBinding="controller.riskCategories"
  optionValuePath="content.id"
  optionLabelPath="content.name"
  selectionBinding="riskCategory"
  class="input-medium"}} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T06:40:22.887

我通过将每个*App.Facility*的渲染包装在 {{#if isLoaded}} 中解决了这个问题

所以代码看起来像：

```
{{#each client.facilities}}
  {{#if isLoaded}}
    {{view Ember.Select
      contentBinding="App.riskCategories"
      optionValuePath="content.id"
      optionLabelPath="content.name"
      selectionBinding="riskCategory"
      class="input-medium"}}
  {{/if}}
{{/each}} 
```

似乎设置 App.RiskCategory 的*App.Facility**对象*尚未完成加载，因此正在设置 默认*App.RiskCategory ，然后当触发**dataLoaded*事件时，由于该对象已经被抛出异常修改的。

 **** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T20:09:18.610

我遇到了类似的问题，使用的解决方案`#isLoaded`对我不起作用。但是，所做的是向元素添加一个`prompt`属性。`Ember.Select`我怀疑这与渲染视图和加载数据的异步性有关（在我的情况下，从`FIXTURES`，但据我所知`DS.FixtureAdapter`模拟加载数据的时间滞后）。***

# c++ - OSX 10.7.5 上的 node-gyp -- dyld：惰性符号绑定失败：未找到符号

> ID：14630044
> 
> 赞同：8
> 
> 时间：2013-01-31T16:06:57.910
> 
> 标签：c++, macos, node.js, dyld, node-gyp

我已经搜索了很多，我发现最接近同一个问题的是这个（也未回答的）问题：

[未找到符号：_libintl_gettext](https://stackoverflow.com/questions/13759044/symbol-not-found-libintl-gettext)

我正在尝试为 libpuzzle 制作一个精简的 c++ 包装器。

```
$ node --version
v0.8.18
$ npm --version
1.2.4
$ node-gyp --version
v0.8.3 
```

[github上的源代码](https://github.com/reklis/node-puzzle)

尝试构建（我已经用...缩短了路径）

```
$ node-gyp clean configure build && node test.js 
gyp info it worked if it ends with ok
gyp info using node-gyp@0.8.3
gyp info using node@0.8.18 | darwin | x64
gyp info spawn python
gyp info spawn args [ '/opt/local/lib/node_modules/node-gyp/gyp/gyp',
gyp info spawn args   'binding.gyp',
gyp info spawn args   '-f',
gyp info spawn args   'make',
gyp info spawn args   '-I',
gyp info spawn args   '/.../node-puzzle/build/config.gypi',
gyp info spawn args   '-I',
gyp info spawn args   '/opt/local/lib/node_modules/node-gyp/addon.gypi',
gyp info spawn args   '-I',
gyp info spawn args   '/.../.node-gyp/0.8.18/common.gypi',
gyp info spawn args   '-Dlibrary=shared_library',
gyp info spawn args   '-Dvisibility=default',
gyp info spawn args   '-Dnode_root_dir=/.../.node-gyp/0.8.18',
gyp info spawn args   '-Dmodule_root_dir=/.../node-puzzle',
gyp info spawn args   '--depth=.',
gyp info spawn args   '--generator-output',
gyp info spawn args   'build',
gyp info spawn args   '-Goutput_dir=.' ]
gyp info spawn make
  CXX(target) Release/obj.target/puzzle/puzzle.o
gyp info spawn args [ 'BUILDTYPE=Release', '-C', 'build' ]
  SOLINK_MODULE(target) Release/puzzle.node
  SOLINK_MODULE(target) Release/puzzle.node: Finished
gyp info ok 
dyld: lazy symbol binding failed: Symbol not found: __Z19puzzle_init_contextP14PuzzleContext_
  Referenced from: /.../node-puzzle/build/Release/puzzle.node
  Expected in: dynamic lookup

dyld: Symbol not found: __Z19puzzle_init_contextP14PuzzleContext_
  Referenced from: /.../node-puzzle/build/Release/puzzle.node
  Expected in: dynamic lookup 
```

好的，所以这个错误对我来说很有意义，显然它无法加载动态库。

起初我认为我必须调整我`binding.gyp`的以包含链接器设置，所以我尝试了几种不同的配置。目前这是它的样子：

```
{
    "targets": [
        {
            "target_name": "puzzle",
            "sources": [ "puzzle.cc" ],
            "link_settings": {
                "libraries": [
                    "/opt/local/lib/libgd.dylib",
                    "/opt/local/lib/libpuzzle.dylib"
                ],
            }
        }
    ]
} 
```

我在这里有库：

```
$ ll /opt/local/lib/libpuzzle.*
-rwxr-xr-x  1 root  admin    19K Jan 30 21:24 /opt/local/lib/libpuzzle.1.dylib
-rw-r--r--  1 root  admin    20K Jan 30 21:24 /opt/local/lib/libpuzzle.a
lrwxr-xr-x  1 root  admin    17B Jan 30 21:24 /opt/local/lib/libpuzzle.dylib -> libpuzzle.1.dylib
-rwxr-xr-x  1 root  admin   1.3K Jan 30 21:24 /opt/local/lib/libpuzzle.la

$ ll /opt/local/lib/libgd.*
-rwxr-xr-x  1 root  admin   252K Sep  2 23:59 /opt/local/lib/libgd.2.dylib
-rw-r--r--  1 root  admin   289K Sep  2 23:59 /opt/local/lib/libgd.a
lrwxr-xr-x  1 root  admin    13B Sep  2 23:59 /opt/local/lib/libgd.dylib -> libgd.2.dylib
-rwxr-xr-x  1 root  admin   1.2K Sep  2 23:59 /opt/local/lib/libgd.la 
```

我只是不知道如何让[dyld](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man1/dyld.1.html)看到他们。我尝试调整 DYLD_FRAMEWORK_PATH 和 DYLD_FALLBACK_LIBRARY_PATH 无济于事。

更新：[otool的输出](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/otool.1.html)

`otool -l build/Release/puzzle.node`

```
build/Release/puzzle.node:
Load command 0
      cmd LC_SEGMENT_64
  cmdsize 552
  segname __TEXT
   vmaddr 0x0000000000000000
   vmsize 0x0000000000002000
  fileoff 0
 filesize 8192
  maxprot 0x00000007
 initprot 0x00000005
   nsects 6
    flags 0x0
Section
  sectname __text
   segname __TEXT
      addr 0x0000000000000edc
      size 0x00000000000008d8
    offset 3804
     align 2^2 (4)
    reloff 0
    nreloc 0
     flags 0x80000400
 reserved1 0
 reserved2 0
Section
  sectname __stubs
   segname __TEXT
      addr 0x00000000000017b4
      size 0x000000000000010e
    offset 6068
     align 2^1 (2)
    reloff 0
    nreloc 0
     flags 0x80000408
 reserved1 0 (index into indirect symbol table)
 reserved2 6 (size of stubs)
Section
  sectname __stub_helper
   segname __TEXT
      addr 0x00000000000018c4
      size 0x000000000000021c
    offset 6340
     align 2^2 (4)
    reloff 0
    nreloc 0
     flags 0x80000400
 reserved1 0
 reserved2 0
Section
  sectname __cstring
   segname __TEXT
      addr 0x0000000000001ae0
      size 0x00000000000001ea
    offset 6880
     align 2^0 (1)
    reloff 0
    nreloc 0
     flags 0x00000002
 reserved1 0
 reserved2 0
Section
  sectname __unwind_info
   segname __TEXT
      addr 0x0000000000001cca
      size 0x000000000000008c
    offset 7370
     align 2^0 (1)
    reloff 0
    nreloc 0
     flags 0x00000000
 reserved1 0
 reserved2 0
Section
  sectname __eh_frame
   segname __TEXT
      addr 0x0000000000001d58
      size 0x00000000000002a8
    offset 7512
     align 2^3 (8)
    reloff 0
    nreloc 0
     flags 0x00000000
 reserved1 0
 reserved2 0
Load command 1
      cmd LC_SEGMENT_64
  cmdsize 472
  segname __DATA
   vmaddr 0x0000000000002000
   vmsize 0x0000000000001000
  fileoff 8192
 filesize 4096
  maxprot 0x00000007
 initprot 0x00000003
   nsects 5
    flags 0x0
Section
  sectname __dyld
   segname __DATA
      addr 0x0000000000002000
      size 0x0000000000000010
    offset 8192
     align 2^3 (8)
    reloff 0
    nreloc 0
     flags 0x00000000
 reserved1 0
 reserved2 0
Section
  sectname __got
   segname __DATA
      addr 0x0000000000002010
      size 0x0000000000000010
    offset 8208
     align 2^3 (8)
    reloff 0
    nreloc 0
     flags 0x00000006
 reserved1 45 (index into indirect symbol table)
 reserved2 0
Section
  sectname __la_symbol_ptr
   segname __DATA
      addr 0x0000000000002020
      size 0x0000000000000168
    offset 8224
     align 2^3 (8)
    reloff 0
    nreloc 0
     flags 0x00000007
 reserved1 47 (index into indirect symbol table)
 reserved2 0
Section
  sectname __data
   segname __DATA
      addr 0x0000000000002190
      size 0x0000000000000060
    offset 8592
     align 2^4 (16)
    reloff 0
    nreloc 0
     flags 0x00000000
 reserved1 0
 reserved2 0
Section
  sectname __const
   segname __DATA
      addr 0x00000000000021f0
      size 0x0000000000000030
    offset 8688
     align 2^4 (16)
    reloff 0
    nreloc 0
     flags 0x00000000
 reserved1 0
 reserved2 0
Load command 2
      cmd LC_SEGMENT_64
  cmdsize 72
  segname __LINKEDIT
   vmaddr 0x0000000000003000
   vmsize 0x0000000000002000
  fileoff 12288
 filesize 6648
  maxprot 0x00000007
 initprot 0x00000001
   nsects 0
    flags 0x0
Load command 3
          cmd LC_ID_DYLIB
      cmdsize 48
         name @rpath/puzzle.node (offset 24)
   time stamp 1 Wed Dec 31 19:00:01 1969
      current version 0.0.0
compatibility version 0.0.0
Load command 4
     cmd LC_SYMTAB
 cmdsize 24
  symoff 12720
   nsyms 138
  stroff 15344
 strsize 3592
Load command 5
            cmd LC_DYSYMTAB
        cmdsize 80
      ilocalsym 0
      nlocalsym 76
     iextdefsym 76
     nextdefsym 19
      iundefsym 95
      nundefsym 43
         tocoff 0
           ntoc 0
      modtaboff 0
        nmodtab 0
   extrefsymoff 0
    nextrefsyms 0
 indirectsymoff 14976
  nindirectsyms 92
      extreloff 14928
        nextrel 6
      locreloff 12288
        nlocrel 50
Load command 6
     cmd LC_UUID
 cmdsize 24
    uuid 9A75E329-2D02-3AC8-A249-A741702EB141
Load command 7
      cmd LC_VERSION_MIN_MACOSX
  cmdsize 16
  version 10.5
      sdk 10.7
Load command 8
          cmd LC_LOAD_DYLIB
      cmdsize 64
         name /opt/local/lib/libssl.1.0.0.dylib (offset 24)
   time stamp 2 Wed Dec 31 19:00:02 1969
      current version 1.0.0
compatibility version 1.0.0
Load command 9
          cmd LC_LOAD_DYLIB
      cmdsize 64
         name /opt/local/lib/libcrypto.1.0.0.dylib (offset 24)
   time stamp 2 Wed Dec 31 19:00:02 1969
      current version 1.0.0
compatibility version 1.0.0
Load command 10
          cmd LC_LOAD_DYLIB
      cmdsize 56
         name /opt/local/lib/libgd.2.dylib (offset 24)
   time stamp 2 Wed Dec 31 19:00:02 1969
      current version 3.0.0
compatibility version 3.0.0
Load command 11
          cmd LC_LOAD_DYLIB
      cmdsize 64
         name /opt/local/lib/libpuzzle.1.dylib (offset 24)
   time stamp 2 Wed Dec 31 19:00:02 1969
      current version 2.0.0
compatibility version 2.0.0
Load command 12
          cmd LC_LOAD_DYLIB
      cmdsize 56
         name /usr/lib/libstdc++.6.dylib (offset 24)
   time stamp 2 Wed Dec 31 19:00:02 1969
      current version 52.0.0
compatibility version 7.0.0
Load command 13
          cmd LC_LOAD_DYLIB
      cmdsize 56
         name /usr/lib/libSystem.B.dylib (offset 24)
   time stamp 2 Wed Dec 31 19:00:02 1969
      current version 159.1.0
compatibility version 1.0.0
Load command 14
          cmd LC_LOAD_DYLIB
      cmdsize 56
         name /usr/lib/libgcc_s.1.dylib (offset 24)
   time stamp 2 Wed Dec 31 19:00:02 1969
      current version 1094.0.0
compatibility version 1.0.0
Load command 15
      cmd LC_FUNCTION_STARTS
  cmdsize 16
  dataoff 12688
 datasize 32
Load command 16
      cmd LC_DATA_IN_CODE
  cmdsize 16
  dataoff 12720
 datasize 0 
```

`otool -L build/Release/puzzle.node`

```
build/Release/puzzle.node:
    @rpath/puzzle.node (compatibility version 0.0.0, current version 0.0.0)
    /opt/local/lib/libssl.1.0.0.dylib (compatibility version 1.0.0, current version 1.0.0)
    /opt/local/lib/libcrypto.1.0.0.dylib (compatibility version 1.0.0, current version 1.0.0)
    /opt/local/lib/libgd.2.dylib (compatibility version 3.0.0, current version 3.0.0)
    /opt/local/lib/libpuzzle.1.dylib (compatibility version 2.0.0, current version 2.0.0)
    /usr/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 52.0.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 159.1.0)
    /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1094.0.0) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-01T11:08:18.020

dyld 抱怨的符号是`__Z19puzzle_init_contextP14PuzzleContext_`. 在其未损坏的形式中，它是`puzzle_init_context(PuzzleContext_*)`. 重整表示编译器将其视为 C++ 符号。但是，libpuzzle 似乎导出了一个纯 C 接口。这意味着它*应该*寻找的符号是`_puzzle_init_context`。您可以通过将 包装`#include <puzzle.h>`在一个`extern "C" { … }`块中来解决此问题，以通知编译器标头的内容应被视为 C 代码，因此它将按照适当的规则处理符号名称。

这种错误通常由静态链接器检测，而不是在运行时由动态链接器检测。您的`Expected in: dynamic lookup`错误消息部分表明`puzzle.node`与 链接`-undefined dynamic_lookup`。这告诉静态链接器不要为未定义的符号发出任何错误，而是让动态链接器尝试在运行时解析符号。这很少是您想要的行为。

# c# - 将用户输入读入数组时出错

> ID：14630049
> 
> 赞同：1
> 
> 时间：2013-01-31T16:07:16.740
> 
> 标签：c#, input

所以我故意让我得到的家庭作业过于复杂，因为我很无聊，想了解更多关于 c# 的知识。原任务如下：

“计算 50 到 90 之间的五个考试分数的平均值。声明并使用这五个值执行编译时初始化。使用常数来定义分数的数量。显示所有分数和平均值，格式为无数字格式小数点右边。”

所以我决定不只是把 5 个分数放进去，我会允许用户将它们输入到一个数组中，然后从中计算它。

```
Console.WriteLine("Enter 5 test scores between 50 and 90:");
int i = 0;
double total = 0;
double[] Scores;
Scores = new double[5];

while (i < 5)
{
    Console.WriteLine("Input Score " + (i + 1) + ":");
    String input = Console.ReadLine();
    Scores[i] = double.Parse(input);
    total += Scores[i];
    i++;
}

Console.WriteLine("The average of the scores is: " + (total/5)); 
```

问题是`Scores[i] = double.Parse(input);`抛出一个错误，指出输入格式错误。所以程序甚至不会运行让我输入输入，但它说输入格式不正确。

有什么建议么？我可能遗漏了一些明显的东西。

编辑：好的，所以最终的工作是将代码更改为

```
Console.WriteLine("Input Score " + (i + 1) + ":");
Scores[i] = double.Parse(Console.ReadLine());
total += Scores[i];
i++; 
```

不确定它实际上发生了什么变化，但它似乎工作得非常完美！

# jquery-mobile - Jquery Mobile 通过更改屏幕方向跳转到起始页面

> ID：14630051
> 
> 赞同：0
> 
> 时间：2013-01-31T16:07:25.647
> 
> 标签：jquery-mobile, screen-orientation, multipage

我已经构建了一个 jQuery Mobile 应用程序，但有一个问题我不明白。我正在使用多页功能，但是当您在一个页面中并更改屏幕方向时，它会跳回起始页。我不明白如何在更改方向时停留在当前页面上。

我试过这个：

```
$(window).bind("orientationchange", function (e, ui) 
{ 
    var sPage ="#"+$.mobile.activePage.attr("id"); 
    $.mobile.changePage(sPage); 
    alert(sPage);
}); 
```

alert() 显示了我想停留的正确页面。

下面是一个如何制作多页的示例。如果我选择“Instellingen”选项，则会显示此页面。但是当我改变智能手机的方向时，它会跳回菜单。

```
<!DOCTYPE html> 
<html>
<head> 
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mobile</title>
<link rel="stylesheet"  href="../css/jquery.mobile-1.1.1.min.css" />
<link rel="stylesheet"  href="../css/jquery.dataTables.css" />
<script type="text/javascript" src="../js/jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="../js/jquery.mobile-1.1.1.min.js"></script>
<script type="text/javascript" src="../js/DataBase.js"></script>
<script type="text/javascript" src="../js/Webservice.js"></script>
<script type="text/javascript" src="../js/Misc.js"></script>
</head> 

<body>
<div id="Menu" data-role="page" data-title="Hoofdmenu">
  <div data-role="header">
    <h1>Menu</h1>
  </div>
  <ul data-role="listview" data-inset="true" data-theme="c" data-dividertheme="b">
        <li data-role="list-divider">Hoofd Menu</li>
                <li><a href="#Instellingen"><h3>Instellingen</h3>
<p>Algemene programma instellingen</p></a></li>
</ul>
</div>

<div id="Instellingen" data-role="page" data-title="Instellingen">
  <div data-role="header">
    <h1>Programma instellingen</h1>
     <a data-role="button" data-direction="reverse" data-rel="back" href="#Menu" data-icon="arrow-l" data-iconpos="left" data-theme="b">
        Back</a></div>
   <div data-role="content"  data-theme="b">
  <ul data-role="listview" data-inset="true" >
      <li><div><h1>WCF adres<input id="Adress" type="url"/></h1> </div> 
      <div data-role="controlgroup" data-type="horizontal">
        <a id="Test" data-role="button">Test</a>
        <a id="Opslaan" data-role="button">Opslaan</a>
                </div></li>
  </ul> 
```

```
<script type="text/javascript">
$(document).ready(function () {
    $("#Test").click(function () {
        if ($("#Adress").val().length > 0)
            CheckWebService($("#Adress").val(), function (Check) { alert(Check); })
        else
            alert("Geen adres of error")
    });
    $("#Opslaan").click(function () { saveURL($("#Adress").val()); });
    $("#Dummy").click(function () { alert("dummy"); });
    $("#ResetDatabase").click(function () { $.mobile.showPageLoadingMsg("b", "Sync");  ResetDatabase(); });

});

</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T15:49:34.320

几个月来我遇到了完全相同的问题，直到今天我将 screenSize 参数添加到 android 清单中，如下所示：

android:configChanges="方向|screenSize|keyboardHidden"

希望有帮助！

# javascript - form.serialize() 上的编码问题；一些特殊字符显示为 ASCII 码

> ID：14630053
> 
> 赞同：1
> 
> 时间：2013-01-31T16:07:27.487
> 
> 标签：javascript, jquery, character-encoding

我在javascript中遇到特殊字符问题。我有一个带有输入文本的表单，其中包含以下字符串：

```
10/10/2010 
```

在 form.serialize() 之后；我得到这个字符串

```
10%2F10%2F2010 
```

'/' 字符被转换成它的 ASCII 码 %2F。

我可以使用它进行转换，`String.fromCharCode(ascii_code)`但我的表单中有很多输入，所以这些字符串类似于：

```
var=14&var=10%2F10%2F2010&var=10%2F10%2F2010&var=10%2F10%2F2010 
```

只是一个例子，说明我必须通过这个字符串（“手动”）并找到这些值并转换它。

有没有简单的方法来执行该转换？奇怪的事情，因为我以前没有这个问题，我不知道为什么现在会发生这种情况。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T16:20:05.020

我是这样发生的，因为这就是[它的本意](http://api.jquery.com/serialize/)：

> **.serialize() 方法以标准 URL 编码表示**法创建文本字符串。它对表示一组表单元素的 jQuery 对象进行操作。

据我所知，没有可以反序列化的原生 jQuery 函数，但您的帖子表明您已经掌握了它，并且只停留在[URL 编码的字符串中](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/decodeURIComponent)：

> `decodeURIComponent(encodedURI)`
> 解码以前由 encodeURIComponent 或类似例程创建的统一资源标识符 (URI) 组件。

# python - Django/python：我想遍历表单中的字段并显示存储在数据库中的值

> ID：14630055
> 
> 赞同：0
> 
> 时间：2013-01-31T16:07:28.100
> 
> 标签：python, django, forms, models

这是我的models.py：

```
class UserProfile(models.Model):
    user = models.ForeignKey(User, unique=True)
    utype = models.ForeignKey(Usertype)
    school = models.ForeignKey(School)
    courses = models.ManyToManyField(Course, related_name='c+', blank=True)
    tutors = models.ManyToManyField(Course, related_name='t+', blank=True)
    account = models.IntegerField(max_length=20, blank=True, null=True)
    cellphone = models.BigIntegerField(max_length=14, unique=True, blank=True, null=True)
    credits = models.FloatField(default=0.0)
    transactions = models.ManyToManyField(Transaction, related_name='t+', blank=True)
    verified = models.BooleanField(default=False)
    paypalVerified = models.BooleanField(default=False)
    applicationAccepted = models.BooleanField(default=False)
    address = models.CharField(max_length=256, blank=True)
    apartment = models.CharField(max_length=20, blank=True)
    city = models.CharField(max_length=256, blank=True)
    state = models.ForeignKey(State, null=True, blank=True)
    zip = models.IntegerField(max_length=10, blank=True, null=True)
    country = models.ForeignKey(Country, null=True, blank=True) 
```

这是我的forms.py：

```
class ContactInfoForm(ModelForm):
def __init__(self, *args, **kwargs):
    super(ContactInfoForm, self).__init__(*args, **kwargs)
    self.fields['cellphone'].label = "Cell Phone Number"
    self.fields['address'].label = "Address"
    self.fields['apartment'].label = "Apartment"
    self.fields['city'].label = "City"
    self.fields['state'].label = "State"
    self.fields['zip'].label = "Zip Code"
    self.fields['country'].label = "Country"
class Meta:
    model = UserProfile
    fields = ('cellphone', 'address', 'apartment', 'city', 'state', 'zip', 'country') 
```

这是我的views.py：

```
def profile(request):
c=getUserContext(request)
c['contactInfoForm'] = ContactInfoForm(instance = c['profile'])
if request.method == 'POST':
    if request.POST['formType'] == "ContactInfo":
        c['contactInfoForm'] = ContactInfoForm(request.POST, instance = c['profile'])
        if c['contactInfoForm'].is_valid():
            c['contactInfoForm'].save()
return render_to_response('profile.html', c) 
```

如果用户在 ContactInfoForm 的所有字段中都输入了数据，我如何遍历表单中的字段并显示它们的值？

例如我想显示

手机号码 123-456-7890
地址 1 West Spring St ... 等

我无法遍历模型中的字段，因为其中包含许多我不想在个人资料页面的联系人信息部分显示的其他字段。

我已经为此苦苦挣扎了一段时间，但一无所获。如果我的问题不清楚，请告诉我，我将提供更多信息或尝试重新构建问题。

这是我当前在 profile.html 上向用户显示表单的方式：

```
{% for field in contactInfoForm %}
                    <tr>
                            <td class="fieldright">
                            <label class="inline">{{ field.label_tag }}</label>
                            </td>
                            <td>
                                {% if profile.field %}
                                    <div class="field">
                                        {{ profile.field }}
                                        <input type="hidden" name="{{ field }}" id="id_{{ field }}" value={{ profile.field }}>
                                    </div>
                                {% else %}
                                    {{ field }}
                                {% endif %}
                            </td>
                        </tr> 
                    {% endfor %} 
```

编辑：我将 profile.field 更改为 field.value，现在正在显示该值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:56:10.127

如果您想隐藏其他字段，只需在表单中使用 exclude 而不是字段

```
 class Meta:
     model = UserProfile
     exclude = ('', '') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:10:30.973

迭代表单的字段，而不是模型的字段。

# r - 为因子变量的水平生成预测值

> ID：14630056
> 
> 赞同：2
> 
> 时间：2013-01-31T16:07:34.593
> 
> 标签：r, regression

我正在使用 对连续结果变量的多个因子变量进行回归`lm()`。例如，

```
fit<-lm(dv~factor(hour)+factor(weekday)+factor(month)+factor(year)+count, data=df) 
```

我想`yhat`为一个因子变量的不同水平生成预测值 ( )，同时将其他变量保持在它们的中值或模态值。例如，如何`yhat`在保持其他因素不变的情况下为不同的工作日生成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:15:07.843

我可以根据@Roland 的评论提供帮助。我认为您想要普通的旧方差分析，这有助于确定因素是否重要。这里不需要考虑因素，整数或数字（类：数字）可以正常工作。我将以下代码放在一起作为示例：

```
#creates df
(df <- data.frame(h=c(1,3,4,0,2, 3),d=c(2*1:3), m=c(-1, 0, 3, 4, 7, 8), y=c(30,28,27,26,22, 21)))

#creates linear model, gives output
(fit<-lm(df$d~ df$h + df$m+ df$y))

#runs ANOVA on linear model
anova(fit)

#creates predictions from lm based on different values of df$h
predict.lm(fit) 
```

ANOVA 是回归的一种特殊情况。输出将告诉您该因素是否通过 P 值显着。

```
> anova(fit)
Analysis of Variance Table

Response: df$d
          Df  Sum Sq Mean Sq F value  Pr(>F)  
df$h       1 13.2923 13.2923 89.5846 0.01098 *
df$m       1  2.2832  2.2832 15.3879 0.05927 .
df$y       1  0.1277  0.1277  0.8608 0.45147  
Residuals  2  0.2968  0.1484 
```

在此示例中，小时数与您的因变量天数高度相关，而月数显示次高相关性。

请参阅链接以获取背景-

[http://www.cookbook-r.com/Statistical_analysis/ANOVA/](http://www.cookbook-r.com/Statistical_analysis/ANOVA/)

仅供参考 - 我建议您包含一些源代码来创建您的示例。通过这种方式，试图回答您问题的人都可以参考同一个示例。

FYI2 - 我建议您添加标签“回归”

HTH。

# wordpress - WordPress 元框不保存任何内容

> ID：14630057
> 
> 赞同：0
> 
> 时间：2013-01-31T16:07:36.883
> 
> 标签：wordpress, custom-post-type, meta-boxes

我的 wordpress 中有更多自定义元数据，其中一个没有保存任何内容。这是保存的代码

```
add_action('save_post', 'save_details');
function save_details($post_id){
$slug = 'homepage';
/* check whether anything should be done */
$_POST += array("{$slug}_edit_nonce" => '');
if ( !current_user_can( 'edit_post', $post_id ) ) {
    return;
}
if ( !wp_verify_nonce( $_POST["{$slug}_edit_nonce"], plugin_basename( __FILE__ ) ) ){
    return;
}
/* Request passes all checks; update the post's metadata */
if (isset($_REQUEST['link_homepage'])) {
    update_post_meta($post_id, 'link_homepage', $_REQUEST['link_homepage']);
} 
```

}

任何人都可以帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T18:23:26.537

我终于创建了一个工作代码，在我在 wordpress 中写入自定义字段并单击保存后，将其从 textarea 字段中删除，但保存它并且它可以工作。

这是新的代码：

```
<?php
// add meta box for post types
add_action("admin_init", "admin_init");   
function admin_init(){ 
    add_meta_box( 
        'settings_meta_id', 
        'Link Homepage', 
        'settings_meta', 
        'homepage', 
        'normal', 
        'high' 
    );
}    
function settings_meta( $post ){
    //global $post; 
    $values = get_post_custom( $post->ID );
    $links = isset( $values['link_homepage'] ) ? $values['link_homepage'][0] : '';
    wp_nonce_field( 'homepage_box_nonce', 'link_homepage_nonce' );
?>
<p>
    <label for="link_homepage">Link homepage:</label><br /> 
    <textarea cols="100" rows="2" name="link_homepage" style="width:98%;"><?php echo $link_homepage; ?></textarea>
</p> 
<?php }
add_action( 'save_post', 'save_custom_details' );
function save_custom_details( $post_id ) {
    global $post;   
    //skip auto save
    if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) {
        return $post_id;
    }
    //check for you post type only
    if( $post->post_type == "homepage" ) {
        if( isset($_POST['link_homepage']) ) { update_post_meta( $post->ID, 'link_homepage', $_POST['link_homepage'] );}

    }
}
?> 
```

如何修复该BUG，保存后将文本保留在那里？

# php - 错误的转换？字符串 => 整数

> ID：14630058
> 
> 赞同：0
> 
> 时间：2013-01-31T16:07:36.540
> 
> 标签：php

我在将字符串转换为 int 时遇到问题。数组 $input 包含以下值：

```
array(3) { [0]=> string(6) "30" [1]=> string(2) "01" [2]=> string(9) "2013" } 
```

首先，由于八角陷阱，我删除了前导零。所以这是我的代码：

```
foreach ($input as $key => $var) {
        $input[$key] = trim($var,"0");
        $input[$key] = (int)$var;
    } 
```

但不幸的是，结果并不令人满意。

```
array(3) { [0]=> int(0) [1]=> int(1) [2]=> int(2013) } 
```

30现在是零？这怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:09:25.840

```
[0]=> string(6) "30" 
```

该字符串的开头有一些不可打印的字符。它看起来像 2 个字符长，但实际上有 6 个字符。此类字符将导致字符串转换`0`为文档中的内容。

您应该尝试`bin2hex`在字符串上查看我们正在谈论的字节值，然后使用这些知识来确定它们来自哪里。

该`"2013"`字符串*也*有额外的字符，尽管在这种情况下它们看起来是*尾随*的。

# html - 正确的 HTML 标记语法？（删除行内块元素之间的空格）

> ID：14630061
> 
> 赞同：7
> 
> 时间：2013-01-31T16:07:49.663
> 
> 标签：html, css, syntax, html-parsing

当 html 代码没有被“美化”时，它看起来像

```
<div><img src="img1.jpg"/><img src="img2.jpg"/></div> 
```

然后这些图片呈现为

```
|=||=| //no gap between 
```

但是经过美化器[http://ctrlq.org/beautifier/](http://ctrlq.org/beautifier/)

```
<div>
    <img src="img1.jpg"/>
    <img src="img2.jpg"/>
 </div> 
```

它们是这样渲染的

```
|=| |=| // gap (space) between 
```

因此，相同的代码呈现不同的方式。我想弄清楚如何为 html 内联元素（和 html ）做正确的语法？

（内联甚至可以是“块”元素），所以我不知道如何编写人类可读和正确呈现的代码（至少内联元素之间没有间隙）。

有什么建议么？=)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T16:15:20.547

有几个选项可以以易于阅读的方式显示内联块元素，但没有一个是完美的。

**选项 1**：左浮动

这里有一个关于浮点数的教程：[http](http://css.maxdesign.com.au/floatutorial/) ://css.maxdesign.com.au/floatutorial/ 强烈建议所有前端开发人员精通这个主题。

**选项 2**：嵌套评论（已发布）

```
<div>
    <img src="img1.jpg"/><!-- 
 --><img src="img2.jpg"/>
</div> 
```

**选项 3（可能在未来）：（** `text-space-collapse: discard;`以前`white-space-collapse: discard;`）

`white-space-collapse`由于浏览器采用率低，不推荐使用 CSS 属性（请参阅下面的评论）。看来此属性不再是文本装饰规范的一部分。我还找到了参考，以`text-space-collapse`供将来考虑。

**选项4**：不要尝试

使用 display:inline-block 时，你不能期望有漂亮的代码。我认为，如果不使用 float:left，您对 inline-block 的使用和对漂亮代码的渴望是相互排斥的。

**选项 5**：添加`font-size: 0`到父元素。显然这不适用于 Safari，因此该解决方案与`white-space-collapse: discard;`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-31T16:09:00.427

根据您的浏览器，它可能会呈现为空间。你可以试试这个：

```
<div>
    <img src="img1.jpg"/><!-- 
 --><img src="img2.jpg"/>
</div> 
```

`<!--`是一个评论标签，浏览器会忽略它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T23:26:50.930

我知道我会因为这样说而被讨厌。呜呜呜……

如果您想将您的 img 精确地放在彼此旁边并且有“美化”代码，您需要使用一张表格。

`Cue screaming`

使用 css，您可以在 div 中使用 2 img 做任何您想做的事情，除了将它们精确定位为表格。

这段代码......

```
<div>
    <table cellspacing="0" cellpadding="0">
        <tr>
            <td>
                <img src="img1.jpg"/>
            </td>
            <td>
                <img src="img2.jpg"/>
            </td>
        </tr>
    </table>
</div> 
```

会得到你想要的结果，但问题是，你能和自己一起生活吗？

相关小提琴 [http://jsfiddle.net/t4Krs/](http://jsfiddle.net/t4Krs/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-14T08:58:59.400

它不漂亮，但在我看来它比评论技巧更漂亮：

```
<div>
  <
   img src="img1.jpg"/><
   img src="img2.jpg"
  >
</div> 
```

# html - wordpress - 无法看到网站中的页面

> ID：14630064
> 
> 赞同：0
> 
> 时间：2013-01-31T16:07:54.493
> 
> 标签：html, wordpress

我能够在 wordpress 仪表板中编辑页面，但是当我试图通过浏览器查看页面时，什么都没有显示。

除了主页之外，没有任何工作。

我尝试安装另一个主题，但在所有主题中，只有主页运行良好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:02:10.757

您是否浏览过 Wordpress 论坛？也许这个页面？[http://wordpress.org/support/topic/page-not-found-39](http://wordpress.org/support/topic/page-not-found-39)

您是否更改了站点权限（例如通过 FTP） 有时拥有特定站点权限可能会导致您的页面无法显示。

你有最新版本的 Wordpress 吗？

# python - Django 上传和处理正确编码的 CSV 文件

> ID：14630066
> 
> 赞同：5
> 
> 时间：2013-01-31T16:07:56.300
> 
> 标签：python, django

我尝试在我的 Django 项目中上传和处理 CSV 文件，但出现编码错误，CSV 文件是在 Mac 上使用 excel 创建的。

```
reader = csv.reader(request.FILES['file'].read().splitlines(), delimiter=";")
    if withheader:
        reader.next()

data = [[field.decode('utf-8') for field in row] for row in reader] 
```

使用此代码示例，我得到一个错误： http: [//puu.sh/1VmXc](http://puu.sh/1VmXc)

如果我使用 latin-1 解码，我会得到另一个“错误”..

```
data = [[field.decode('latin-1') for field in row] for row in reader] 
```

结果是：v¾gmontere，结果应该是：vægmontere

有谁知道该怎么做？..我已经尝试了很多！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T00:11:15.873

1.  Python 2`csv`模块带有很多 unicode 麻烦。[尝试`unicodecsv`改用](https://github.com/jdunck/python-unicodecsv)Python 3。
2.  Mac 上的 Excel 以损坏的编码导出为 CSV。不要使用它，而是使用像 LibreOffice 这样有用的东西（具有更好的 CSV 导出选项）。
3.  处理用户文件时：要么确保文件始终以 UTF-8 编码并且仅解码为 UTF-8（推荐），要么使用编码检测库，如[chardet](http://pypi.python.org/pypi/chardet)。

# c++ - 使用 VS2012 编译 libffi 失败并出现致命错误 LNK1281: Unable to generate SAFESEH image

> ID：14630069
> 
> 赞同：10
> 
> 时间：2013-01-31T16:08:06.787
> 
> 标签：c++, visual-studio, visual-c++, visual-studio-2012, libffi

使用 VS11 编译 libffi 会出现以下链接器错误

```
libffi\libffi-3.0.9\ms\Win32\Debug\ffi.dll : fatal error LNK1281: Unable to generate SAFESEH image. 
```

同一个项目用 VS10 编译得很好，但是用 VS2012 自动升级后，它开始给出链接器错误

[MSDN](http://msdn.microsoft.com/en-us/library/afa9eakh%28v=vs.80%29.aspx)中的解释太晦涩难懂了

我可能会用 重建`/SAFESEH:NO`，但我不确定其中的含义。

请告知可能出现的问题。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-31T17:10:30.497

没有的主要含义`SAFESEH`是您的应用程序不会被 Windows 8 商店或[Windows 8 桌面认证](http://msdn.microsoft.com/en-us/library/windows/desktop/hh749939)接受。如果这对您来说不是问题，请随意使用`/SAFESEH:NO`.

[文档](http://msdn.microsoft.com/en-us/library/9a89h429.aspx)说：

> 链接器无法生成图像的最常见原因是链接器的一个或多个输入文件（模块）与安全异常处理程序功能不兼容。模块与安全异常处理程序不兼容的一个常见原因是因为它是使用 Visual C++ 早期版本的编译器创建的。

项目升级到 VS2012 是否有可能将设置更改为`/SAFESEH:YES`. 也许您从未使用`SAFESEH`.

# javascript - 如何将Class添加到多个元素？

> ID：14630076
> 
> 赞同：-2
> 
> 时间：2013-01-31T16:08:40.440
> 
> 标签：javascript, jquery, html, css

我正在使用这段 javascript 向多个元素添加一个类。我试图引用多个 div 并向它们添加类。它仅适用于第一个。

**Javascript**

```
<script>            
            $(function(){           
            if ( $(window).width() < 230 ) {
              $('#item1').addClass('col1'); //max-width 80px

            }
            else 
                if ( $(window).width() >= 230 && $(window).width() < 330 ) {
              $('#item1').addClass('col2'); //max-width 180px

            }
            else 
           {
              $('#item1').addClass('col3'); //max-width 280px

            }

          });
        </script> 
```

如果我在页面上只有一个 #item1 但它似乎不想将该类添加到存在于同一 div id 中的多个项目中，它就可以工作。我什至尝试将该类添加到同一个 div 类而不是 id 中存在的多个项目中。如果你能弄清楚，任何一个都是 mw 的一个很好的解决方案。

**我的 HTML 代码是**

```
 <div id="item1" class="blue">
<label for="amount">Price range:</label>
<input type="text" id="amount" style="border:0; color:#f6931f; font-weight:bold;" />
<div class="slider-range"></div>
</div>

<div id="item1" class="blue">
<label for="amount2">Price range:</label>
<input type="text" id="amount2" style="border:0; color:#f6931f; font-weight:bold;"/>
<div class="slider-range2"></div>
</div> 
```

几个小时以来一直在试图解决这个问题，所以我想我会问是否有人能指出我正确的方向。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:11:13.223

ID 应该是唯一的。尝试添加一个类，例如“item”：

```
<div class="blue item">
    ...etc...
</div> 
```

然后在你的 JS 中：

```
$('.item').addClass('col1'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T16:13:53.297

类只添加到一个 div 的原因是因为 id 在 HTML 中应该是唯一的。使用 id 选择器时，jQuery 只会返回第一个匹配的项目。你有三个选择

选项一：代替 id`item1`使用一个类`item`并使用以下选择器

```
$('.item').addClass('col1'); 
```

选项二：将第二个 div 上的 id 更改为`item2`并使用以下选择器

```
$('#item1, #item2').addClass('col1'); 
```

选项三：使用属性选择器（这更像是一种技巧）

```
$('div[id="item1"]').addClass('col1'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T16:11:17.777

使用`class`而不是`id`进行操作：

IE

```
var newClass = '';
if ( $(window).width() < 230 ) {
    newClass = 'col1';
}
else if ( $(window).width() >= 230 && $(window).width() < 330 ) {
    newClass = 'col2';
}
else {
    newClass = 'col3';
}

$('.blue').addClass(newClass); // will apply to all elements with class blue 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T16:11:15.240

`id`每页只能有一个相同的元素。`ID`必须是唯一的。

将所有`<div id="item1">`标签更改为`<div class="item1">`，然后您的 jQuery 将如下所示：

```
 <script>            
            $(function(){           
            if ( $(window).width() < 230 ) {
              $('.item1').addClass('col1'); //max-width 80px

            }
            elseif ( $(window).width() >= 230 && $(window).width() < 330 ) {
              $('.item1').addClass('col2'); //max-width 180px

            }
            else 
           {
              $('.item1').addClass('col3'); //max-width 280px

            }

          });
        </script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-31T16:11:20.493

使用类选择器而不是 id：

```
$('.toAdd').addClass('col3'); 
```

这将向所有具有“toAdd”类的元素添加“col3”类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-31T16:11:34.023

具有相同 id 的多个元素不是有效的语法，jQuery 中的 id 选择器`$('#anyId')`总是返回具有该 id 的第一个项目，而不是多个项目。

`<div class="blue item">`改为在您的 html 和 jQuery 类选择器中使用`$('.item')`。

# tomcat - 运行简单的 JSF 应用程序时，Tomcat 7 日志会产生错误

> ID：14630081
> 
> 赞同：0
> 
> 时间：2013-01-31T16:09:10.753
> 
> 标签：tomcat, intellij-idea, tomcat7

我按照本指南 ( [http://wiki.jetbrains.net/intellij/Developing_JSF_applications](http://wiki.jetbrains.net/intellij/Developing_JSF_applications) ) 使用 JSF 创建了一个简单的 Hello world 应用程序。它运行良好，并生成一个`http://localhost:8080/index.faces`显示短语“Hello world”的页面。问题是 Tomcat 7 日志显示严重错误。这是它所说的：

> 2013 年 1 月 31 日下午 5:58:42 org.apache.catalina.core.StandardWrapperValve 调用严重：Servlet.service() 用于路径 [] 上下文中的 servlet [jsp] 引发异常 [处理 JSP 页面/索引时发生异常。第 14 行的 jsp
> 
> 11：简单jsp页面12：13：14：15：16：
> 17：
> 
> Stacktrace:] 与根本原因 java.lang.RuntimeException: 无法在 javax.faces.webapp.UIComponentClassicTagBase.setJspId(UIComponentClassicTagBase.java:1672) 的 javax.faces.webapp.UIComponentClassicTagBase.getFacesContext(UIComponentClassicTagBase.java:1855) 找到 FacesContext org.apache.jsp.index_jsp._jspx_meth_f_005fview_005f0(index_jsp.java:111) 在 org.apache.jsp.index_jsp._jspService(index_jsp.java:83) 在 org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java: 70) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:728) 在 org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432) 在 org.apache.jasper.servlet.JspServlet.serviceJspFile (JspServlet.java:390) 在 org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334) 在 javax.servlet.http.HttpServlet。service(HttpServlet.java:728) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) at org.apache .catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222) 在 org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123) 在 org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java :472) 在 org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99) 在 org.apache.catalina.valves 的 org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)。 AccessLogValve.invoke(AccessLogValve.java:936) 在 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118) 在 org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407) 在 org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004) 在 org.apache.coyote.AbstractProtocol$AbstractConnectionHandler .process(AbstractProtocol.java:589) 在 org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310) 在 java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) 在java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) 在 java.lang.Thread.run(Thread.java:722)AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589) at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java: 1110) 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) 在 java.lang.Thread.run(Thread.java:722)AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589) at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java: 1110) 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) 在 java.lang.Thread.run(Thread.java:722)
> 
> 2013 年 1 月 31 日下午 5:58:47 org.apache.catalina.core.ApplicationContext 日志

我是 JSF 的新手，所以我不明白这个错误是什么意思。有任何想法吗？比你。

PS：（我正在运行山狮，我正在使用 IntelliJ Idea Ultimate 12）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:46:08.627

可以忽略此异常，它发生在某些验证期间，当`index.jsp`请求 page 而不是`index.faces`.

如果您`index.faces`在浏览器中刷新，您将不会再看到任何错误，如果您打开`index.jsp`，您将在 Tomcat 日志中看到相同错误的第二个副本。

`index.jsp`是默认页面，因此如果`http://localhost:8080`被请求，您将收到此错误。

`web.xml`可以通过在下面添加以下内容来解决此问题`web-app`：

```
<welcome-file-list>
    <welcome-file>index.faces</welcome-file>
</welcome-file-list> 
```

这种方式`index.jsp`在打开的时候是不会访问的`http://localhost:8080`。

# asp.net - ASP.NET 成员资格在本地工作，但未部署到 Azure

> ID：14630082
> 
> 赞同：2
> 
> 时间：2013-01-31T16:09:10.957
> 
> 标签：asp.net, azure

我在 SQL Azure 上实现了 ASP .NET 成员资格，在我的本地计算机上一切正常，但是当我部署到 Azure 时，登录就莫名其妙地失败了。

我在这里尝试了解决方案， ASP.NET Membership - login 在本地工作，在 Azure和博客[上失败](https://stackoverflow.com/questions/8415822/asp-net-membership-login-works-locally-fails-on-azure)

[http://geekswithblogs.net/DavidHoerster/archive/2010/06/15/asp.net-membership-password-hash----.net-3.5-to-.net-4.aspx](http://geekswithblogs.net/DavidHoerster/archive/2010/06/15/asp.net-membership-password-hash----.net-3.5-to-.net-4.aspx)

但仍然没有运气？有人有类似的经历吗？

安迪。

# mysql - 编写此 MySQL 查询的更好方法？

> ID：14630085
> 
> 赞同：4
> 
> 时间：2013-01-31T16:09:21.877
> 
> 标签：mysql

我有一个 MySQL 查询

```
SELECT *,
       (SELECT COUNT(*) FROM B WHERE B.AID = A.ID) AS Sum1,
       (SELECT COUNT(*) FROM C WHERE C.AID = A.ID) AS Sum2
FROM A 
```

使用连接有哪些可能的替代方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:13:43.453

```
SELECT A.*, IFNULL(t1.sum, 0), IFNULL(t2.sum, 0)
FROM A
LEFT JOIN (SELECT AID, COUNT(AID) sum FROM B GROUP BY AID) t1 ON t1.AID = A.ID
LEFT JOIN (SELECT AID, COUNT(AID) sum FROM C GROUP BY AID) t2 ON t2.AID = A.ID 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:31:46.757

如果 B 和 C 表中有唯一的 ID，这将起作用。在我的示例中，这些字段称为 ID。

```
SELECT A.*,
       COUNT(DISTINCT B.ID) AS Sum1,
       COUNT(DISTINCT C.ID) AS Sum2

FROM   A

       LEFT JOIN B ON b.AID = A.ID
       LEFT JOIN C ON C.AID = A.ID

GROUP BY A.ID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:31:39.677

不确定这是否是您要查找的内容，以下是如何使用`join`: 但假设...您的表格看起来像我用作演示的示例。如果不是，请与我们分享您的表架构和示例数据，以及您的预期结果......

[http://sqlfiddle.com/#!2/1e65c/2](http://sqlfiddle.com/#!2/1e65c/2)

```
SELECT A.ID, A.NAME, 
CASE WHEN B.AID = A.ID THEN COUNT(*) END AS SUM1,
CASE WHEN B.AID = A.ID THEN COUNT(*) END AS SUM1
FROM A
INNER JOIN B
ON A.ID = B.AID
INNER JOIN C
ON B.AID = C.AID
GROUP BY A.ID, A.NAME
;

SELECT A.ID, A.NAME,  COUNT(B.AID) AS SUM1,
COUNT(C.AID) AS SUM1
FROM A
INNER JOIN B
ON A.ID = B.AID
INNER JOIN C
ON B.AID = C.AID
GROUP BY A.ID, A.NAME
;

| ID | NAME | SUM1 |
--------------------
|  1 | John |    2 |
|  2 |  Tim |    4 |
|  3 | Jack |    2 | 
```

# java - 如何在 Java 小程序中使用 keyListener

> ID：14630088
> 
> 赞同：3
> 
> 时间：2013-01-31T16:09:30.310
> 
> 标签：java, swing, awt, keylistener, japplet

我完全不知道如何`KeyListener`在小程序中使用（好吧，我有一个好主意）。我知道这与将焦点放在小程序上有关，但我不知道如何做到这一点。我的程序作为应用程序运行良好，但它不会将键盘输入作为小程序接收。如果有人可以给我一些帮助，那就太棒了。

**我的代码是：**

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

public class Window extends JApplet {

    static Ship ship;
    static ColorPanel panel;
    static boolean up=false, down=false, left=false, right=false;

            public static class PanelListener implements KeyListener{

        public void keyPressed(KeyEvent e){
            switch(e.getKeyCode()) {
                    case 38: ship.setMoving(true); down = true;break;
                    case 40: ship.setMoving(true); up = true;break;
                    case 37: ship.setMoving(true); left = true;break;
                    case 39: ship.setMoving(true); right = true;break;
                    case 32: ship.setFiring(true); break;
                    case 49: ship.setSwitching(true); ship.switchOrdinance(49); break;
                    case 50: ship.setSwitching(true); ship.switchOrdinance(50); break;
                    case 51: ship.setSwitching(true); ship.switchOrdinance(51); break;
                    case 52: ship.setSwitching(true); ship.switchOrdinance(52); break;
                    case 83: if(ship.shieldState()){ship.shieldOff();}else{ship.shieldOn();}
            }
            ship.setDirection(up,down,left,right);
            ship.setVelocity(3);
        }
        public void keyReleased(KeyEvent e){
            switch(e.getKeyCode()) {
                case 38: ship.setMoving(false); down = false; break;
                case 40: ship.setMoving(false); up = false; break;
                case 37: ship.setMoving(false); left = false; break;
                case 39: ship.setMoving(false); right = false; break;
                case 32: ship.setFiring(false); break;
                case 49: ship.setSwitching(false); break;
                case 50: ship.setSwitching(false); break;
                case 51: ship.setSwitching(false); break;
                case 52: ship.setSwitching(false); break;
                default: ship.setMoving(false); ship.setFiring(false); ship.setSwitching(false); left=false; right=false; up=false; down=false;
            }
            ship.setDirection(up,down,left,right);
            if(!up || !down || !right || !left){
                ship.setVelocity(0);
            }
        }
        public void keyTyped(KeyEvent e){
        }
    }

        public void init(){
            Container pane;
            ship=new Ship();
            panel = new ColorPanel(Color.black, 1340, 640);
            panel.sendShip(ship);
            pane=getContentPane();
            pane.add(panel);
            addKeyListener(new PanelListener());
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:38:29.763

您是对的，您需要在`init`方法结束时将其设置为可聚焦

```
setFocusable(true); 
```

如果您不这样做，您至少必须在面板中单击以获取遇到的键。

# java - Java中的Stream Tokenizer：尝试实现

> ID：14630089
> 
> 赞同：0
> 
> 时间：2013-01-31T16:09:31.793
> 
> 标签：java

我是 Java 新手，正在学习它。我编写了一个代码来获取用户输入并对其进行标记。它编译成功，但运行时会产生“-3”作为 o/p。

```
import java.io.*;

public class TokenTester{

    public static void main(String[] arguments){
    String name;
    StreamTokenizer token;
    BufferedReader reader;
    reader = new BufferedReader(new InputStreamReader(System.in));

     try{
            System.out.println("Enter a String  ");
            name = reader.readLine();
            System.out.println(name);
            token=new StreamTokenizer((new StringReader(name)));
           //token=new StreamTokenizer(name);
            // Using new StreamTokenizer(name) throws error
            //error: no suitable constructor found for StreamTokenizer(String)
             while(token.nextToken()!= token.TT_EOF)
            {
             System.out.println(token.nextToken());
                }
            }
        catch (IOException ioe){
             System.out.println("An unexpected error occured.");
        }

        }
    } 
```

此外，当我使用 new StreamTokenizer(name) 时会抛出错误“错误：找不到适合 StreamTokenizer(String) 的构造函数”

当我使用 while(token.nextToken()!= token.TT_EOF) 时，它显示无限循环为 -1 作为 o/p

下面的代码工作得很好：

```
import java.util.StringTokenizer;

 class TokenTester {

 public static void main(String[] arguments) {
 StringTokenizer st1, st2;

 String quote1 = "VIZY 3 -1/16";
 st1 = new StringTokenizer(quote1);
 System.out.println("Token 1: " + st1.nextToken());
 System.out.println("Token 2: " + st1.nextToken());
 System.out.println("Token 3: " + st1.nextToken());

 String quote2 = "NPLI@9 27/32@3/32";
 st2 = new StringTokenizer(quote2, "@");
 System.out.println("\nToken 1: " + st2.nextToken());
System.out.println("Token 2: " + st2.nextToken());
System.out.println("Token 3: " + st2.nextToken());
 }
 } 
```

我无法在我的代码中找出问题所在。请指导。

我参考过：

```
http://tutorials.jenkov.com/java-io/streamtokenizer.html
http://www.java-samples.com/showtutorial.php?tutorialid=397
http://docs.oracle.com/javase/7/docs/api/ 
```

谢谢高拉夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:16:11.103

在第一个示例中，您使用 StreamTokenizer，在第二个示例中使用 StringTokenizer。因此，在第一个示例中，为了使其可行，您应该将 StreamTokenizer 替换为 StringTokenizer。当然，您应该使用与 StringTokenizer 相关的适当方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:24:25.880

StreamTokenizer 类接受一个输入流并将其解析为“令牌”，从而允许一次读取一个令牌。解析过程由一个表和许多可以设置为各种状态的标志控制。流标记器可以识别标识符、数字、带引号的字符串和各种注释样式。

同时，字符串标记器类允许应用程序将字符串分解为标记。标记化方法比 StreamTokenizer 类使用的方法简单得多。

第一个示例说明了 StreamTokenizer，而第二个示例说明了 StringTokenizer。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:25:19.080

可以通过 token.sval 访问令牌的值

试试这个：

```
try{
        System.out.println("Enter a String  ");
        name = reader.readLine();
        System.out.println(name);
        token=new StreamTokenizer((new StringReader(name)));
        int numberOfTokens = token.nextToken(); //<----nextToken() returns an integer 
         while(numberOfTokens!= token.TT_EOF)
        {
         System.out.println(token.sval);  //<---- take sval
         numberOfTokens = token.nextToken();
            }
        }

    catch (IOException ioe){
         System.out.println("An unexpected error occured.");
    } 
```

> 当我使用 while(token.nextToken()!= token.TT_EOF) 时，它显示无限循环为 -1 作为 o/p

==> 这个无限循环的发生是因为你在一个单循环中增加了 2x：

*   第一个增量在这里：while( token.nextToken **()** != token.TT_EOF)

*   第二个增量在这里： System.out.println( **token.nextToken()** );

# html - 如何强制 Chrome 打开正确的链接

> ID：14630092
> 
> 赞同：0
> 
> 时间：2013-01-31T16:09:36.333
> 
> 标签：html, google-chrome

谷歌浏览器在点击时打开无效链接。

要重现，请打开页面

在 Chrome 中并将鼠标光标移动到文本

在页面源中，此链接定义为

```
<a class="fn" href="/store/Store/Details?product=CPU-EP0520EL01"
                        rel="product">
                        xxxxxxxxxxxxxxxxxx</a> 
```

因此应该打开链接`/store/Store/Details?product=CPU-EP0520EL01`

Chrome `/store/Store/Details?product=C225E`在底部显示错误链接并打开此错误页面。

如何解决这个问题？Internet Explorer 9 打开正确的页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:20:50.093

在我看来，您有一些无效的 html。如果您单击页面上的任意位置，它会打开到 /store/Store/Details?product=C225E。

尝试从第 206 行开始： `<a href="/store/ShoppingCart?Length=12" id="cart-status" style="margin-top:12px;margin-left:-5px;color:blue">(0)</a> </a>`

该页面也无法在 FF 中正确呈现。

-----------------编辑/更新----------------

![无效 html 示例](../Images/da84144f8f90f2bb2644476a9fab3ec0.png)

如您所见，我在内容上方，我的光标不是任何链接，但是如果您查看页面底部，我注意到它链接到无效的 url。直到您的第四个产品项目之后，我才注意到这种行为消失了。

检查第 206 行的无效 html 并查看它是否不是打开的链接标记，如前所述，这会导致您出现此问题。

# javascript - 首次加载时获取 cookie

> ID：14630094
> 
> 赞同：0
> 
> 时间：2013-01-31T16:09:38.593
> 
> 标签：javascript, cookies

所以我为这个创建了这个新线程，因为它解释得太糟糕了，但被告知要编辑这个：

**新文本**

我需要从外部网站接收 user_id。如果用户从站点 B 来到站点 A，我只需要收到此消息。因此，当他这样做时，我将该 user_id 保存在 cookie 中，该部分工作正常。但是我还需要在他第一次登陆页面时获取 cookie 的值，所以让我尝试解释一下我是如何做到的：

首先我看看用户是否来自另一个域：

```
var ownDomain = location.hostname,
    referrerDomain = document.referrer.split('/')[2],
    author = '';

if ( ownDomain != referrerDomain) {
  var script = document.createElement('script');
  script.src = '//javascript.mamp/json/?callback=setAuthorCookie';
  document.getElementsByTagName('head')[0].appendChild(script);
} 
```

如果他这样做，那么我们插入一个调用回调的 javascript，`setAuthorCookie()`如下所示：

```
function setAuthorCookie( data ) {
  var exdate = new Date(),
      exdays = 1,
      value = data['userId'],
      cookie = 'partnerOptimizerId',
      exdate = new Date();

   author = value;

   exdate.setDate(exdate.getDate() + exdays);
   var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
   document.cookie=cookie + "=" + c_value;
} 
```

现在你可以看到我在该函数中设置了作者值，所以我应该能够控制台注销作者的值并获得正确的值：

```
console.log( author ) 
```

我什么都不返回，这就是我现在卡住的地方。我想这是因为`setAutorCookie`在我之后运行了一些方法`console.log( author )`，但我希望有人可以帮助我，是因为`author`是局部变量`setAuthorCookie`吗？

**经过一些测试，我可以看到 setAuthorCookie 在最后一个 console.log() 之后运行，这就是为什么它是空的，但有人可以帮助我改变它吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:17:46.817

你只`getCookie()`在某些条件下返回一些东西：

```
 if (x==cookie)
  {
    return unescape(y);
  } 
```

所以如果 x != cookie，你的函数没有返回值。因此，当您说`var author = getCookie( 'partnerOptimizerId' );`，但`getCookie()`不返回任何内容时，`author`将是未定义的。

# kendo-ui - Kendo UI Timepicker 自定义间隔格式

> ID：14630096
> 
> 赞同：2
> 
> 时间：2013-01-31T16:09:42.773
> 
> 标签：kendo-ui

我希望用 kendoTimePicker 做的事情是在晚上 11:30 之前的所有时间都有 30 分钟的间隔，但在 11:30 之后显示所有后续时间，直到凌晨 12 点。不确定这个控件是否支持它。

基本上希望有这样的东西：

10:30 PM
11:00 PM
11:30 PM
11:31 PM
11:32 PM
11:33 PM
..等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T20:29:44.123

我能想到的唯一方法是手动更改下拉列表中的时间列表。Kendo 只是动态地将一个`<ul>`显示为弹出窗口的页面添加到您的页面，因此您可以自己清除和重建列表。

就像是：

```
<input id="timepicker" />

$("#timepicker").kendoTimePicker();
var listOfTimes = $("#timepicker_timeview");

// remove all existing <li> elements
listOfTimes.empty();

// add the times you want...
listOfTimes.append('<li tabindex="-1" role="option" class="k-item" unselectable="on">12:00 PM</li>');
listOfTimes.append('<li tabindex="-1" role="option" class="k-item" unselectable="on">12:01 PM</li>');
listOfTimes.append('<li tabindex="-1" role="option" class="k-item" unselectable="on">12:02 PM</li>');
// ...etc... 
```

或者从一个完全填充的列表开始，然后删除您不想要的列表。无论哪种方式，您都可以通过`<ul>`使用 jQuery 编辑来操作列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T14:45:25.523

另一种选择是将时间列表定义为 Date 对象。检查[日期选项](http://docs.kendoui.com/api/web/timepicker#dates-array)。每个 timepicker 都有 timeView 属性，它实际上是弹出元素。这个对象有一个 dataBind 方法，它接受一个 Date 对象的列表：

```
var timeView = $("#timepicker").data("kendoTimePicker").timeView;

//bind list
timeView.dataBind([new Date()]); 
```

您可以使用此方法动态更新可用时间列表。

不过，您始终可以修改 UL 元素，就像*CodingWithSpike*建议的那样。

# r - ggplot2：在自由尺度上反转每个方面的离散字符变量的顺序？

> ID：14630100
> 
> 赞同：7
> 
> 时间：2013-01-31T16:09:55.710
> 
> 标签：r, ggplot2

我想绘制一个多面的 ggplot2 点图。x 轴是连续的，y 轴是动物列表。根据饮食行为绘制和刻面两个变量。

y 轴是自由比例的，因为每只动物只出现在一个饮食行为类别中。

```
library(ggplot2)

# First clean up the data set:
msleep.noNA <- msleep[!is.na(msleep$vore),]
msleep.noNA.red <-  msleep.noNA[c(1,3,6,7)]
msleep.noNA.red <- msleep.noNA.red[!is.na(msleep.noNA.red[4]),]
msleep.noNA.red <- melt(msleep.noNA.red)

pg <- ggplot(msleep.noNA.red, aes(value, name, colour = variable)) +
      geom_point() +
      facet_grid(vore ~ ., scale="free_y", space = "free_y")
pg

# Try to reverse order of the y axis:
pg + scale_y_reverse()

# Not possible because its a factor, but it's not classified as such:
class(msleep.noNA.red$name) 
```

有人知道如何在每个子图中按字母顺序排列动物名称列表吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-31T16:49:38.963

您可以将字符串向量转换为因子并指定级别的顺序：

以下命令将创建一个因子。级别按字母降序排列：

```
msleep.noNA.red <- within(msleep.noNA.red,
                         name <- ordered(name, levels = rev(sort(unique(name))))) 
```

现在您可以绘制数据：

```
pg <- ggplot(msleep.noNA.red, aes(value, name, colour = variable)) +
  geom_point() +
  facet_grid(vore ~ ., scale="free_y", space = "free_y") 
```

![在此处输入图像描述](../Images/d7c275e0fbdfa25e7e7dd526ec394b0a.png)

# sql-server - 为每个成员选择最近的记录

> ID：14630103
> 
> 赞同：1
> 
> 时间：2013-01-31T16:10:07.327
> 
> 标签：sql-server, sql-server-2008, tsql, stored-procedures

使用 T-SQL 我有 2 个表，其中一个列出了所有成员（recEntrants）。第二个表（recEntrantStatus）包含每个成员的状态更新。目前我有以下 SQL 来检索所有成员的所有更新。

```
SELECT EN.Id, EN.artistName, GR.genre, ES.lastModifiedOn, EN.voteStatus, 
ES.notified
FROM recEntrantStatus AS ES
JOIN recEntrants AS EN
ON ES.entrantId = EN.Id
JOIN recGenre AS GR
ON EN.genreId = GR.Id
AND ES.judgeId = @judgeId
AND ES.roundId > 0
ORDER BY ES.voted DESC, ES.roundId, EN.Id 
```

新增以下要求：

```
SELECT EN.Id, EN.artistName, GR.genre, ES.lastModifiedOn, EN.voteStatus, 
ES.notified
FROM recEntrantStatus AS ES
LEFT JOIN recEntrants AS EN
ON ES.entrantId = EN.Id
LEFT JOIN recGenre AS GR
ON EN.genreId = GR.Id
WHERE ES.roundId = 2 
```

但是，我需要实现的是为每个成员提取最新的状态更新/记录。

Ps 我在 recEntrantStatus 上有一个 modifiedDate 列

对此的任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:26:27.480

使用`row_number()` *结束* `(partition by ES.entrantId order by ES.lastModifiedOn desc)`。如果您仍需要使用相同的顺序，请在子查询中添加 Order by column list。此外，如果您需要选择`NO status records`使用 a`LEFT JOIN`而不是 a 的记录`JOIN`

```
SELECT * FROM (
    SELECT EN.Id, EN.artistName, GR.genre, ES.lastModifiedOn, EN.voteStatus, 
       ES.notified,
       row_number() over (partition by ES.entrantId order by ES.lastModifiedOn desc) rn 
    FROM recEntrantStatus AS ES
    JOIN recEntrants AS EN
        ON ES.entrantId = EN.Id JOIN recGenre AS GR
        ON EN.genreId = GR.Id AND ES.judgeId = @judgeId AND ES.roundId > 0
) A
WHERE A.rn = 1
--ORDER BY A.voted DESC, A.roundId, A.Id 
```

**编辑**（根据 OP 编辑​​）：

```
SELECT * FROM (
    SELECT ES.entrantId Id, EN.artistName, GR.genre, ES.lastModifiedOn, EN.voteStatus, 
       ES.notified,
       row_number() over (partition by ES.entrantId order by ES.lastModifiedOn desc) rn 
    FROM recEntrantStatus AS ES
    LEFT JOIN recEntrants AS EN
        ON ES.entrantId = EN.Id LEFT JOIN recGenre AS GR
        ON EN.genreId = GR.Id 
    --AND ES.judgeId = @judgeId 
    WHERE ES.roundId = 2
) A
WHERE A.rn = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:14:28.443

如果不添加 ModifiedDate 列，则无法执行此操作，该列将包含该列的修改日期和时间。然后你可以这样做：

`select * from tableA where whatever='whatever' order by ModifiedDate desc`.

此外，您可能希望查看每次更新或插入发生时都会修改此列的插入/更新触发器。

但是，如果您只想要第一个条目，则需要`TOP()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:18:26.493

试试这个：

```
;WITH MostRecent
AS
(
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY entrantId ORDER BY lastModifiedOn DESC) RN,
        entrantId,
        judgeId,
        roundId,
        voted 
    FROM recEntrantStatus
)
SELECT
    EN.Id,
    EN.artistName,
    GR.genre,
    ES.lastModifiedOn,
    EN.voteStatus, 
    ES.notified
FROM MostRecent AS ES
    JOIN recEntrants AS EN
ON ES.entrantId = EN.Id
    JOIN recGenre AS GR
ON EN.genreId = GR.Id
   AND ES.judgeId = @judgeId
   AND ES.roundId > 0
WHERE ES.RN = 1
ORDER BY ES.voted DESC, ES.roundId, EN.Id 
```

# linux - 如何处理后台linux任务的输出

> ID：14630104
> 
> 赞同：9
> 
> 时间：2013-01-31T16:10:08.767
> 
> 标签：linux, bash, command-line, background-process

我有一个任务是不断地回显信息。

例如，如果您执行 git clone 并且想要将该任务发送到后台（通过使用 & 符号）

```
git clone https://github.com/mrdoob/three.js.git & 
```

然后 git clone 操作不断刷新屏幕与 git clone 进程的新百分比，即：

```
Receiving objects:  47% (22332/47018), 92.53 MiB | 480 KiB/s   1410/47018), 7.18 MiB | 185 KiB/s
Receiving objects:  53% (24937/47018), 99.40 MiB | 425 KiB/s   1410/47018), 7.18 MiB | 185 KiB/s 
```

所以我不能继续在前台执行其他操作，因为这些更新阻止我看到我正在尝试编写的内容。

你能告诉我如何有效地将这样一个冗长的任务发送到后台吗？

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T16:13:05.157

您可以让进程将其输出写入文件（如果您需要稍后查看），如下所示：

```
git clone https://github.com/mrdoob/three.js.git >output.txt & 
```

或像这样完全丢弃输出：

```
git clone https://github.com/mrdoob/three.js.git >/dev/null & 
```

编辑：

您还可以在上述任一选项中包含发送到 stderror 的任何错误`&`消息`2>&1 &`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T16:40:02.040

其他答案很好，但您也可以使用：

```
git clone -q ... 
```

[详情请看这里](http://www.kernel.org/pub/software/scm/git/docs/git-clone.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T16:12:39.553

重定向其标准输出：

```
git clone https://github.com/mrdoob/three.js.git > /dev/null & 
```

或使用命令的适当详细选项（在本例中为 git）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-31T16:40:06.210

如果您特别希望将其放在后台，您可以`&`在命令末尾附加一个 & 符号 ( )，或者在它运行时使用`ctrl+z`该命令`'bg'`在后台运行它。要将其恢复，请使用`jobs`列出您的工作，然后`fg %{job #}`将其恢复。希望这有助于并在这种独特的情况下起作用

# zend-framework - 基于模块的应用程序中的 ZEND_ACL 解决方案

> ID：14630106
> 
> 赞同：0
> 
> 时间：2013-01-31T16:10:18.517
> 
> 标签：zend-framework, zend-auth, zend-acl, zend-framework-modules

我正在 ZF 上开发一个应用程序。

我遇到了一个巨大的无法解决的问题 - ZEND_Acl

这对我来说是无法解决的，因为我发现的每篇文章都与基于 MODULE 的应用程序无关。

最近我发现了描述在模型中使用 ACL 的[packtpub 文章](http://www.packtpub.com/article/authorization-with-zend_acl-zend-framework-1.8)

但它看起来很复杂，很复杂，而不是我一直在寻找的那个。

它有 StoreFront - 一切都在那里，就我而言，我将所有东西都分成模块。

我在许多其他来源以及文档中看到了 ACL 实现技术。

我不知道如何解决以及从哪里开始（实际上是如何）开发/构建我的 ACL 实现。

我的应用程序如下所示：

```
application/ 
       configs/
       layouts/
               master.phtml
               admin.phtml
       modules/
               users/
                    controllers/
                                adminController
                                indexContoller
                    models/
                    views/
               blog/
                    controllers/
                                adminController
                                indexController
                    models/
                    views/
               orders/
                    controllers/
                                adminController
                                indexController
                    models/
                    views/ 
```

如您所见，我在 adminControllers 中有管理功能，在 indexControllers 中有前端功能。

在模块内部拥有 adminControllers 和视图的想法是拥有分散的模块架构，而不是为管理员创建单独的模块。

现在我想为我的应用程序实现 ACL。

通常我会有管理员——超级管理员、编辑、发布者——管理员将访问除`adminControllers`每个管理员之外的所有管理员，`action`并且确保用户无法访问管理员控制器。

和用户 - 访客、注册、付费，因此层次结构看起来像这样：

```
$acl = new Zend_Acl();
$acl->addRole(new Zend_Acl_Role('visitor')); 
$acl->addRole(new Zend_Acl_Role('registered'), 'visitor');
$acl->addRole(new Zend_Acl_Role('paid'), 'registered');
$acl->addRole(new Zend_Acl_Role('publisher'), 'paid');
$acl->addRole(new Zend_Acl_Role('editor'), 'publisher');
$acl->addRole(new Zend_Acl_Role('superadmin'), 'editor'); 
```

此层次结构将可跨应用程序使用。

目标是在每个模块中写入写入权限和资源，这样当特定项目不存在某些模块时，我可以避免在我的 ACL 文档中出现垃圾。

我还没有在 YouTube 上测试 Alexander Romanenko 的教程的方法，但是在开发 ACL 时，他从 FrontController 插件加载 ACL - 我的情况是什么方法？

在实现 ACL 时，我必须考虑到 ACL 动态断言，以备将来使用。而像“VISITORS”这样的时刻不能发表评论，注册用户也不能在博客中看到付费文章。

也许您可以帮助我将 ACL 集成到我的项目中，也许您知道在哪里可以找到 HOW TO 并按照说明进行操作的好资源。

**编辑**

将具有 ACL 的 preDispatch() 的控制器插件将用于每个模块（在本例中为用户）（对吗？）

我试图在模块的（用户）引导程序中自动加载插件：

```
$plugin = Zend_Controller_Front::getInstance();
$plugin->registerPlugin(new Users_Plugin_AccessCheck()); 
```

但似乎整个应用程序都需要这个插件并给出错误：

```
Fatal error: Uncaught exception 'Zend_Session_Exception' with message 'Session must be started before any output has been sent to the browser; output started in H:\Server\xampp\htdocs\c2g\application\modules\users\plugins\AccessCheck.php/6' in H:\Server\xampp\htdocs\c2g\library\Zend\Session.php:451 Stack trace: #0 ... So on 
```

我认为这是因为插件加载了两次。但是除了模块（USERS）本身之外，这种情况在每个页面上都会发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:30:14.653

我在我的一个应用程序中使用了类似的结构，因此希望我可以为您指明正确的方向。我设置它的方式是：

*   角色在我的主应用程序引导程序中初始化（这是您在问题中包含的代码），将 Zend_Acl 对象存储在注册表中以便在其他地方轻松访问
*   每个模块引导程序设置自己的 ACL 资源并定义哪些角色可以访问哪些内容
*   ACL 检查是使用控制器插件完成的。

资源名称只是任意字符串，因此只要遵守约定，就可以在插件中自动执行 ACL 检查。例如，假设您想要的只是每个模块的索引和管理控制器的资源。在每个模块引导程序中，您都有以下内容：

```
protected function _initAcl()
{
    $acl = Zend_Registry::get('acl');

    $frontendResource = new Zend_Acl_Resource('users');
    $adminResource = new Zend_Acl_Resource('users-admin');

    $acl->addResource($frontendResource);
    $acl->addResource($adminResource);

    // allow everyone frontend access
    $acl->allow('visitor', $frontendResource);

    // admins only for admin access
    $acl->allow('superadmin', $adminResource);
} 
```

然后在您的 ACL 控制器插件中，通过检查请求对象来计算资源名称并执行检查：

```
public function preDispatch(Zend_Controller_Request_Abstract $request)
{
    $acl = Zend_Registry::get('acl');

    $currentResource = $request->getModuleName().'-'.$request->getControllerName();
    if ($acl->has($currentResource) && !$acl->isAllowed($user->role, $currentResource)) {
        // permissions error
    }
} 
```

# java - JMenuItem 的工具提示

> ID：14630112
> 
> 赞同：3
> 
> 时间：2013-01-31T16:10:31.823
> 
> 标签：java, swing, tooltip, jmenu, jmenuitem

我向工具栏添加一个菜单，如下所示：

```
 JMenuBar menu = new JMenuBar();
    JMenu actions = new JMenu("Aktionen");
    Icon menuIcon = ImageUtilities.loadImageIcon("pathToIcon", true);
    actions.setIcon(menuIcon);

    // Add
    JMenuItem addItem = new JMenuItem("Add");       
    Icon addIcon = ImageUtilities.loadImageIcon("pathToIcon", true);
    addItem.setIcon(addIcon);
    addItem.setToolTipText("Add new Item");
    addItem.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
            AddItemAction someAction = new AddItemAction();
            someAction.actionPerformed(new ActionEvent(this, ActionEvent.ACTION_PERFORMED, null) {
                // Foo
            });
        }
    });        

    menu.add(actions);
    actions.add(addItem);
    toolbar.addSeparator();
    toolbar.add(menu); 
```

基本上，它工作正常。但是，它从不显示工具提示（“添加新项目”）。有什么提示吗？

编辑：以防万一遇到同样问题的人偶然发现：这是 L&F，正如我从一开始就应该怀疑的那样。它具有显示 JMenuItems 工具提示的属性；它默认为假。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T16:20:15.837

下面的[sscce](http://sscce.org/)工作正常。如果您仍然有问题，请编辑您的问题以包含一个展示您描述的问题的示例。

附录：我添加了`menu`a `JToolBar`，它仍然可以工作，无论是停靠还是自由浮动。

```
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JToolBar;

/** @see http://stackoverflow.com/a/14630345/230513 */
public class Test {

    private void display() {
        JFrame f = new JFrame("Test");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JMenuBar menu = new JMenuBar();
        JMenu actions = new JMenu("Aktionen");
        JMenuItem addItem = new JMenuItem("Add");
        addItem.setToolTipText("Add new Item");
        menu.add(actions);
        actions.add(addItem);
        JToolBar toolbar = new JToolBar("Tools");
        toolbar.add(menu);
        f.add(toolbar);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Test().display();
            }
        });
    }
} 
```

# javascript - 无法让此框在 JavaScript 中移动

> ID：14630113
> 
> 赞同：1
> 
> 时间：2013-01-31T16:10:32.453
> 
> 标签：javascript, jquery

当我按下箭头键时，我试图让一个盒子移动。我找到[了这个](https://stackoverflow.com/questions/4950575/how-to-move-a-div-with-arrow-keys)解决方案并试图将其复制进去，但它仍然不起作用（Sime Vidas 的最佳答案）。

我的 Jquery 文件肯定在同一个文件夹中，其他所有内容都只是从解决方案中复制和粘贴（在 JSFiddle 演示中有效）。所以我想问题不是 HTML、CSS 或 JavaScript，而是我把它们放在一起时犯了一些错误。

盒子出现了，但没有移动。为什么它不起作用？

```
<!doctype html>
<html>
<head>
<style>
#pane {
    position:relative;
    width:300px; height:300px;
    border:2px solid red;
}  

#box {
    position:absolute; top:140px; left:140px;
    width:20px; height:20px;          
    background-color:black;
}
</style>

<script type="text/javascript" src="jquery.js"></script>

<script type="text/javascript">
var pane = $('#pane'),
    box = $('#box'),
    maxValue = pane.width() - box.width(),
    keysPressed = {},
    distancePerIteration = 3;

function calculateNewValue(oldValue, keyCode1, keyCode2) {
    var newValue = parseInt(oldValue, 10)
                   - (keysPressed[keyCode1] ? distancePerIteration : 0)
                   + (keysPressed[keyCode2] ? distancePerIteration : 0);
       return newValue < 0 ? 0 : newValue > maxValue ? maxValue : newValue;
}

$(window).keydown(function(event) { keysPressed[event.which] = true; });
$(window).keyup(function(event) { keysPressed[event.which] = false; });

    setInterval(function() {
    box.css({
        left: function(index ,oldValue) {
            return calculateNewValue(oldValue, 37, 39);
        },
        top: function(index, oldValue) {
            return calculateNewValue(oldValue, 38, 40);
        }
    });
}, 20);

</script>

</head>

<body>

<div id="pane">
    <div id="box"></div>
</div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:13:20.843

您的代码在元素存在之前运行。

将代码放入[document.ready](http://api.jquery.com/ready/)：

```
$(function(){

    // code goes here

}); 
```

# regex - 使用 ColdFusion 替换所有重读元音

> ID：14630115
> 
> 赞同：3
> 
> 时间：2013-01-31T16:10:37.747
> 
> 标签：regex, coldfusion, replace

有没有办法动态替换重音字符，例如以下？

```
requesón => requeson 
```

我的意思是每个重音（或其他）字符都将被替换为正常字符。

这可能使用 ColdFusion 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T16:46:44.870

您可以通过 java 文本规范化和正则表达式修复重音字符。cflib 上有一个函数可以做到这一点：

来自：[http ://cflib.org/udf/deAccent](http://cflib.org/udf/deAccent)

```
function deAccent(str){
    //based on the approach found here: http://stackoverflow.com/a/1215117/894061
    var Normalizer = createObject("java","java.text.Normalizer");
    var NormalizerForm = createObject("java","java.text.Normalizer$Form");
    var normalizedString = Normalizer.normalize(str, createObject("java","java.text.Normalizer$Form").NFD);
    var pattern = createObject("java","java.util.regex.Pattern").compile("\p{InCombiningDiacriticalMarks}+");
    return pattern.matcher(normalizedString).replaceAll("");
} 
```

# silverlight-4.0 - 从 IIS 中托管的 Silverlight 应用程序打开数据库时出错

> ID：14630119
> 
> 赞同：0
> 
> 时间：2013-01-31T16:10:49.893
> 
> 标签：silverlight-4.0, iis-7.5, silverlight-5.0

我正在尝试创建托管在 IIS（Windows 7、VS 2010）中的 Silverlight 应用程序，但出现此错误：

[![ķ](../Images/496daf03b649aea7c23c6a1ea11905bc.png)](https://i.stack.imgur.com/o844B.jpg)

这是我所做的：

*   我创建了一个 Silverlight 应用程序（Silverlioght 5）

*   我进入 Silverlight.Web 项目属性并选中“使用本地 IIS Web 服务器”（我未选中“使用 IIS Express”和“覆盖应用程序根 URL”）

*   我为 AdventureWorks SQL Server Express 数据库创建了一个 ADO .NET 实体数据模型

*   我创建了一个 Silverlight UserControl，它只是通过将员工实体表（数据源）拖动到 UserControl 设计图面（它创建了一个 DomainDataSource）来创建一个数据网格

*   遵循“如何在 SQL Server 2008 中启用远程连接”（[http://blogs.msdn.com/b/walzenbach/archive/2010/04/14/how-to-enable-remote-connections-in-sql-server -2008.aspx](http://blogs.msdn.com/b/walzenbach/archive/2010/04/14/how-to-enable-remote-connections-in-sql-server-2008.aspx)）：

*   但是当我运行应用程序时，我得到了指定的错误。

我可能做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:14:58.737

您是否尝试过授予“IIS APPPOOL\ASP.NET v4.0”权限以登录和访问您的数据库？看起来您可能正在使用默认凭据进行模拟。您还可以在应用程序池上指定自定义身份。 [http://www.iis.net/learn/manage/configuring-security/application-pool-identities](http://www.iis.net/learn/manage/configuring-security/application-pool-identities)

# xml - 使用 Solr Dataimporthandler 索引 xml 属性值

> ID：14630120
> 
> 赞同：0
> 
> 时间：2013-01-31T16:10:50.800
> 
> 标签：xml, solr, namespaces

我需要索引一些使用命名空间的 XML 文档，例如：

```
<pm:Kroot>
<pm:root>
    <pm:meta>
        <dc:id xmlns:dc="http://purl.org/dc/elements/1.1/">1</dc:id>
        <dc:source>
            <dc:source>
                <pm:link pm:description="Tele" pm:source="8326"/>
            </dc:source>
        </dc:source>
    </pm:meta>
</pm:root>
</pm:Kroot> 
```

现在，当我使用以下 DataImport 时，Solr 设法获取 ID，但无法索引 Attributes 值：

```
<dataConfig>
 <dataSource  type="FileDataSource" encoding="UTF-8" />
 <document>
    <entity name="article"
            url="/sample.xml"
            processor="XPathEntityProcessor"
            stream="true"                               
            forEach="/Kroot/root" >

        <field column="id"              xpath="/Kroot/root/meta/id" />            
        <field column="news_id"    xpath="/Kroot/root/meta/source/source/link/@source" />
        <field column="news_name"  xpath="/Kroot/root/meta/source/source/link/@description" />

   </entity>
 </document> 
```

通过从 XML 文件中删除属性名称空间，Solr 设法索引所有数据！现在我正在寻找解决方案，但我找不到这种行为的解释。Solr wiki 说，在命名空间的情况下，我们应该只使用属性名称而不使用命名空间，就像我一样。我正在使用 Solr 4.1 顺便说一句。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T04:41:43.673

你可以试试例如`/Kroot/root/meta/source/source/link[@description]`

# java - LinkedHashMap 订单问题

> ID：14630138
> 
> 赞同：7
> 
> 时间：2013-01-31T16:11:29.433
> 
> 标签：java, linkedhashmap

[LinkedHashMap Javadocs](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedHashMap.html)中提到了它：

> 特别是，collection-views 上的操作不会影响 backing map 的迭代顺序。

“对集合视图的操作”是什么意思？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T16:14:44.560

[s](http://docs.oracle.com/javase/tutorial/collections/interfaces/map.html)的[集合视图`Map`](http://docs.oracle.com/javase/tutorial/collections/interfaces/map.html)是以下对象返回的对象：

*   `Map#keySet()`
*   `Map#values()`
*   `Map#entrySet()`

*对它们的*操作仅仅意味着对集合视图实例的任何方法调用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-31T16:27:12.270

这个测试应该证明它是如何工作的

```
 Map m = new LinkedHashMap(16, 0.75f, true);
    m.put(1, 1);
    m.put(2, 2);
    m.put(3, 3);
    System.out.println(m);
    m.get(2);
    System.out.println(m);
    Set keys = m.keySet(); //API: Returns a Set view of the keys contained in this map.
    keys.iterator().next();
    System.out.println(m); 
```

输出

```
{1=1, 2=2, 3=3}
{1=1, 3=3, 2=2}
{1=1, 3=3, 2=2} 
```

也就是说，访问条目 2-2 改变了迭代顺序，而访问 keySet 视图上的第一个条目 1-1 并没有

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-31T16:18:52.820

如果我理解得很好，也许我没有，collection-view 是`Collection`通过它的抽象获得的s，比如entrySet、values 和keySet。

`LinkedHashMap`当您使用使您的对象按访问顺序排序的特殊构造函数时，这些集合中的操作不会影响您内部对象的访问顺序。

# java - 在 Spring 控制器上的 $.ajax POST 后收到错误请求错误 (400)

> ID：14630139
> 
> 赞同：0
> 
> 时间：2013-01-31T16:11:33.723
> 
> 标签：java, jquery, ajax, spring, request-mapping

你好 StackOverFlow(s)

我已经解决了这个问题超过 2 个小时了 这很简单

**我正在尝试使用 $.ajax POST 调用将 JSON 对象发送到 Spring Controller**

我正在使用 AngularJS，但这一点没问题

这是服务器和客户端的代码以及spring配置

**提前致谢**

查询：

```
 $scope.push = function() {
    $.ajax({
        type: "PUT",
        url:"rest/todo/greeting/",
        data : {id:"1",title:"ajax",description:"ajax"},
        dataType: "json",
        contentType : "application/json",
        success : function(data) {
            $log.info(data)
        }
    })
} 
```

弹簧控制器：

```
@Controller
@RequestMapping("/todo")
public class TodoController {
@RequestMapping(value = "/greeting", method = RequestMethod.PUT,consumes="application/json",produces="text/html")
public @ResponseBody String push(@RequestBody Todo todo) {
    System.out.println(todo.getTitle());
    return "test";
} 
```

}

弹簧配置：

```
<mvc:annotation-driven />
<context:component-scan base-package="org.lab.todo.controller" />
<bean id="defaultViews" class="org.springframework.web.servlet.view.json.MappingJackson2JsonView" /> 
```

网页.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

<listener>
    <listener-class>
        org.springframework.web.context.ContextLoaderListener
    </listener-class>
</listener>

<!--
    Spring WEBMVC/REST Controllers
-->
<servlet>
    <servlet-name>todo-dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>todo-dispatcher</servlet-name>
    <url-pattern>/rest/*</url-pattern>
</servlet-mapping> 
```

Ajax 调用更新：

```
 $scope.push = function() {
    var jsonString = {id:"1",title:"ajax",description:"ajax"};
    var Todo = function(){}
    Todo.id = "id";
    Todo.title = "ajax";
    Todo.description = "ajax";
    $.post("rest/todo/greeting",JSON.stringify(Todo),function(response){console.log(response)},'json');
} 
```

小提琴原始请求标头：

```
POST http://localhost:8080/todo-rest/rest/todo/greeting HTTP/1.1
Host: localhost:8080
Connection: keep-alive
Content-Length: 0
Accept: application/json, text/javascript, */*; q=0.01
Origin: http://localhost:8080
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko)     Chrome/24.0.1312.56 Safari/537.17
Referer: http://localhost:8080/todo-rest/
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8,fr;q=0.6
Accept-Charset: UTF-8,*;q=0.5 
```

小提琴响应标头

```
HTTP/1.1 415 Unsupported Media Type
Server: Apache-Coyote/1.1
Content-Type: text/html;charset=utf-8
Content-Length: 1048
Date: Thu, 31 Jan 2013 17:11:40 GMT 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T21:57:50.597

这是答案

这只是正确编写 JSON 字符串的问题

代替

```
var jsonString = {id:"1",title:"ajax",description:"ajax"}; 
```

我是这样写的

```
var jsonString = '{"id":"1","title":"ajax","description":"ajax"}'; 
```

仍然奇怪的是 JSON.stringify(MyObject) 在我的情况下似乎不起作用！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:59:50.310

如果您收到 400 状态代码，则只能出于以下原因（来自[W3](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)）：

> 10.4.1 400 错误请求
> 
> 由于语法错误，服务器无法理解该请求。客户端不应该在没有修改的情况下重复请求。

对于 Spring，这要么意味着 ajax 请求是错误的（请参阅我关于数据 JSON 字符串的评论），要么它无法解析请求正文中的 JSON 字符串并将其转换为您的命令对象`Todo`。所以 Spring 有一个可以调用的方法，你的`push()`方法，但是它没有你想要传递给它的参数，所以它抛出一个 400 Bad Request。

`415 Unsupported Media Type`意味着 Spring 找不到使用您发送的内容的方法。您的`push()`Spring 方法`consumes="application/json"`，但您的请求未使用该内容类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:15:19.983

你能发布你的 web.xml 吗？由于您没有为您的请求定义后缀并在最后放置一个斜杠，因此您正在向该目录的 index.jsp 发出请求。

# python - 编译 UWSGI Emperor_mongodb 插件

> ID：14630141
> 
> 赞同：1
> 
> 时间：2013-01-31T16:11:35.483
> 
> 标签：python, mongodb, uwsgi

我目前正在使用 uWSGI 并尝试将附庸配置存储到我的 MongoDB 中。

但是，我无法使用 Emperor_mongodb 插件启动 uWSGI 实例。

关于明显的错误信息，emperor_mongodb 丢失（确实是，我已经检查过了），所以我尝试使用 uWSGI 方法编译它，但我面临一个与我缺乏技能直接相关的问题它。

错误信息：

```
[root@PRDUCE01 uwsgi]# ./uwsgi --plugin emperor_mongodb --emperor "mongodb://127.0.0.1:27107,emperor.vassals"
open("./emperor_mongodb_plugin.so"): No such file or directory [core/utils.c line 4755]
!!! UNABLE to load uWSGI plugin: ./emperor_mongodb_plugin.so: cannot open shared object file: No such file or directory !!!
*** Starting uWSGI 1.4.5 (64bit) on [Thu Jan 31 16:15:36 2013] *** 
```

那么，你能帮我建造它吗？

这是我想要使用的：

```
 python uwsgiconfig.py --plugin plugins/emperor_mongodb package emperor 
```

我知道包参数是存储在 /plugins/emperor.ini 上的 ini 文件，但我真的不知道在我的文件中放什么，除了这些行：

```
[uwsgi]
    main_plugin = emperor
    inherit = base
    bin_name = emperor_mongodb_plugin.so
    as_shared_library = true 
```

但这似乎不起作用：

```
python uwsgiconfig.py --plugin plugins/emperor_mongodb package emperor_mongo using profile: buildconf/package.ini

detected include path: ['/usr/lib/gcc/x86_64-redhat-linux/4.4.6/include', '/usr/include']

*** uWSGI building and linking plugin plugins/emperor_mongodb ***

[gcc -pthread] /usr/lib/uwsgi/emperor_mongo_plugin.so
gcc: error trying to exec 'cc1plus': execvp: No such file or directory

*** unable to build emperor_mongo plugin *** 
```

因此，如果您对如何将此功能编译为插件有任何线索，我会很高兴！D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:07:40.517

python uwsgiconfig.py --plugin plugins/emperor_mongodb/

（确保在 debian/ubuntu 上有 mongodb-dev 包）

# ios - 在 iOS 中触发联系人的自动链接

> ID：14630144
> 
> 赞同：2
> 
> 时间：2013-01-31T16:11:45.573
> 
> 标签：ios, abaddressbook

我正在制作一个在 iPhone 通讯录中创建联系人的应用程序。当将联系人添加到多个来源（即交易所、CardDAV、本地等）时，这有时会导致重复条目

我需要能够在通讯录中链接这些重复的联系人。[我发现这对于该线程中](https://stackoverflow.com/questions/6186513/programmaticly-change-linked-contacts-array-in-abaddressbook-abpersoncopyarrayo)的任何两个任意联系人都是不可能的。

但是，我只需要在手机上启用新源时触发“自动链接”。这种自动链接会导致所有相似的联系人自动链接在一起，这正是我想要的。

我能找到的唯一解决方案是要求用户禁用/启用他们的来源，但如果可以自动触发它会更顺畅。

有人知道如何解决这个问题吗？任何帮助表示赞赏。

# asp.net - Azure Blob 存储上传错误：（403）禁止

> ID：14630150
> 
> 赞同：1
> 
> 时间：2013-01-31T16:11:53.250
> 
> 标签：asp.net, azure, azure-blob-storage, http-status-code-403, blobstorage

我们创建了一个将文件上传到 Azure blob 的新流程。在本地运行应用程序时，文件上传正常且没有错误。当我们在服务器上运行相同的进程时，我们会收到错误消息：

> MESSAGE: Forbidden: header 'Content-Type' value denied SOURCE: Microsoft.WindowsAzure.StorageClient TARGETSITE: T get_Result() STACKTRACE: at Microsoft.WindowsAzure.StorageClient.Tasks.Task `1.get_Result() at Microsoft.WindowsAzure.StorageClient.Tasks.Task`1.ExecuteAndWait() at Microsoft.WindowsAzure.StorageClient.TaskImplHelper .ExecuteImpl(Func`1 impl) 在 Microsoft.WindowsAzure.StorageClient.CloudBlob.UploadFromStream(Stream source, BlobRequestOptions options) at Microsoft.WindowsAzure.StorageClient.CloudBlob.UploadFromStream(Stream source)
> 
> 内部异常：
> 
> MESSAGE：远程服务器返回错误：(403) Forbidden。
> 
> 来源：系统
> 
> 目标：System.Net.WebResponse EndGetResponse（System.IAsyncResult）
> 
> STACKTRACE：在 System.Net.HttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
> 
> 在 Microsoft.WindowsAzure.StorageClient.EventHelper.ProcessWebResponse（WebRequest 请求，IAsyncResult asyncResult，EventHandler`1 处理程序，对象发送者）

奇怪的是文件仍然上传到 Azure。有没有人经历过这个？我们在上传文件时没有设置内容类型，因为我们在下载文件时设置了它。我们尝试硬编码一个，它仍然产生同样的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:22:05.320

原来是Firefox的问题。我们必须修改代理以不允许任何内容类型从 Azure 返回给我们。文件似乎正在上传，但 Azure 想要响应我们对它的调用，而我们的防火墙阻止了响应。理想情况下，Azure 会通过在其响应中包含内容类型来解决此问题，因此我们不需要进行此类防火墙更改。

# java - antlr 4 无法加载为词法分析器或解析器

> ID：14630154
> 
> 赞同：6
> 
> 时间：2013-01-31T16:12:06.543
> 
> 标签：java, antlr4

我正在使用 antlr 4 来编写我的语法。我想看看我的语法生成的gui三。当我尝试在 antlr 站点（[http://www.antlr.org/wiki/display/ANTLR4/Getting+Started+with+ANTLR+v4](http://www.antlr.org/wiki/display/ANTLR4/Getting+Started+with+ANTLR+v4)）上运行该示例时，它可以工作，但如果我尝试使用我的语法它不会不行。特别是，我还尝试使用“在 TestRig 中运行..”命令在 NetBeans 和 AntlrWorks 2 上运行语法，但结果是相同的错误消息““无法将故障加载为词法分析器或解析器”。

这是我的语法：

```
 script 
    : include*
      systemDef
      labelsDef
      issueDef*
      observationDef*
      actionDef*
      procedure*
    ;

include
    : USE qualifiedName EOS;

systemDef
    : SYSTEM definition;

labelsDef
    : LABELS COLON '{' label* '}' EOS ;

label
    : IDENTIFIER COLON literal EOS
    ;

issueDef
    : ISSUES definition;

observationDef
    : OBSERVATIONS definition;

actionDef
    : ACTIONS definition;

definition
    : IDENTIFIER? parameters? ( COLON block )?  EOS
    ;

reference
    : IDENTIFIER? parameters? (COLON)? (atClause ( COMMA atClause )*)? EOS
    ;

parameters
    : '[' param (COMMA param)* ']'
    ;

param
    : literal
    | IDENTIFIER
    ;

literal
    : STRINGLITERAL
    | INTEGET_LITERAL
    | PERCENTAGELITERAL
    | FLOATLITERAL
    | TRUE
    | FALSE
    ;

block
    : '{' ( (marker)? (definition | reference) )+ '}'
    ;

marker
    : PLUS
    | MINUS
    | MULTIPLY
    | SHARP
    | QUESTION_MARK
    ;

atClause
    : '@' qualifiedName parameters?
    ;

qualifiedName
    : (DOT)? IDENTIFIER  (DOT IDENTIFIER)* 
    ;

procedure
    : PROCEDURE IDENTIFIER params? COLON body 
    ;

params
    : '[' IDENTIFIER (COMMA IDENTIFIER)* ']'
    ;

body
    : statement
    | '{' statement* '}'
    ;

statement
    : assignment 
    | expression // .str???
    | callExpression 
    | ifStatement
    | whileStatement
    | repeatStatement
    | forStatement
    ;

assignment
    : qualifiedName ASSIGN expression (EOS)?
    ;

expression
    : conditionalOrExpression (EOS)?;

conditionalOrExpression 
    : conditionalAndExpression ( OR conditionalAndExpression )*
    ;

conditionalAndExpression 
    : equalityExpression ( AND equalityExpression )*
    ;

equalityExpression 
    :  stringExpression (equalityOp stringExpression)?
    ;

equalityOp
    : EQUAL
    | NE
    ;

stringExpression
    : relationalExpression ('§' stringExpression)?
    ;

relationalExpression 
    : additiveExpression (relationalOp additiveExpression)*
    ;

relationalOp 
    : '<='
    | '>='
    | '<'
    | '>'
    ;

additiveExpression 
    : multiplicativeExpression (( PLUS | MINUS ) multiplicativeExpression )*
    ;

multiplicativeExpression 
    : unaryExpression (( MULTIPLY | DIVIDE ) unaryExpression )*
    ;

unaryExpression 
    : ( PLUS | MINUS | NOT )? basicExpression
    ;

basicExpression
    : rangeExpression 
    | callExpression
    | qualifiedName // .str > 
    | percentageExpression
    | '(' expression ')'
    | literal
    ;

percentageExpression
    : PERCENTAGELITERAL 'of' additiveExpression
    ;

rangeExpression
    : qualifiedName '(' ThreeDigits '..' ThreeDigits ')' (EOS)?
    ;

callExpression
    : qualifiedName arguments (EOS)?
    ;

arguments
    : '(' (expression (COMMA expression)*)? ')'
    ;

ifStatement // (ELSE body)?
    : IF '(' expression ')' body 
      (ELSE ifStatement | body )?
    ;

whileStatement
    : WHILE '(' expression ')' body
    ;

repeatStatement 
    : REPEAT body UNTIL '(' expression ')' EOS
    ;

forStatement 
    : FOR .qualifiedName ASSIGN value TO value STEP value body 
    ;

value
    : FLOATLITERAL
    ; 
```

这是我的文件 build.xml：

```
 <target name="-pre-compile" depends="antlr">
    </target>

    <target name="init-antlr">
        <!-- Full path to Antlr jar -->
        <property name="antlr-4.0-complete.jar" location="C:/Users/Mary/Documents/TesiMagistrale/lib/antlr-4.0-complete.jar"/>
        <!-- Grammar path -->
        <property name="antlr.grammar" location="src/troubles/lang/Troubles.g4"/>
        <!--<property name="antlr.lexer" location="src/trouble/lang/TroublesL.g4"/>-->
    </target>

    <target name="antlr" depends="init-antlr" unless="up-to-date">
        <!-- Compiling grammar -->
        <java classname="org.antlr.v4.Tool"  fork="true">
            <arg value="${antlr.grammar}"/>
            <!--<arg value="${antlr.lexer}"/>-->
            <arg value="-visitor"/>
            <classpath path="${antlr-4.0-complete.jar}"/>
        </java> 
    </target> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T03:17:15.913

我正在重写我的答案，以便更准确。

您无法在 NetBeans/antlrworks2 中成功运行 TestRig 的最可能原因是您将语法设置为在默认包以外的包中。如果你的语法中有这样的东西，

```
@header {
    package org.whatever.troubles;
} 
```

尝试将其注释掉并运行“在 TestRig 中运行...”。它应该以这种方式工作。

不幸的是，“在 TestRig 中运行...”功能不允许您指定包。您必须将语法保留在默认包中，或者在命令提示符下使用“grun”。

我建议手动运行 grun 直到这个问题得到解决。处理它的一个好方法是在源文件夹（.g4 所在的位置）中创建一个批处理文件（run.bat）。它将显示在 NetBeans 的 Projects 窗格中，您可以在其中右键单击它并选择“运行”。

而且，您的 CLASSPATH 仍然必须准确......

示例 run.bat 内容：

```
rem grun org.whatever.troubles.Troubles script -tokens -tree -gui test.txt

java -cp .;C:\workdir\proj\dist\troubles.jar;C:\antlr-4.0-complete.jar;"C:\Program Files\Java\jre7\lib" org.whatever.troubles.Troubles script -tokens -tree -gui test.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-24T15:18:18.253

可能有点晚了，但也许我可以帮助别人。我修补了一个版本的 TestRig 以支持您可以在此处找到的软件包：

[https://gist.github.com/bysse/2fc674a040a92a447c31](https://gist.github.com/bysse/2fc674a040a92a447c31)

# ruby-on-rails - 如何在 `root :to` 上包含定位

> ID：14630155
> 
> 赞同：0
> 
> 时间：2013-01-31T16:12:06.900
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, routes, root

```
root :to => 'StaticPages#index' 
```

返回`http://localhost:3000/`

但是，我想始终在根目录中显示完整路径，因为我将路径用于布局目的。我需要我的根始终是：

```
http://localhost:3000/en/home 
```

有谁知道如何实现它？

**编辑**- 原因：我正在突出显示当前页面。

```
link:
<%=  link_to (t 'nav.home'), home_path, id: current_p(home_path) %>

helper:
def current_p(path)
  "current" if current_page?(path)
end 
```

在页面之间导航时它工作正常。但是，它永远不会突出显示主页，因为没有路径。任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:35:17.913

在您的情况下，我会重写`current_p`帮助程序并直接重定向到本地化页面，而不是尝试与您的 root 一起破解某些内容，因为每个定义的 root 始终指的是 root path `/`。

```
def current_p(path)
  paths_to_match = path =~ /\/\w{2}\/home$/ ? ['/', home_path] : [path]
  current = nil  

  paths_to_match.each do |path_to_match|
    current = 'current' if current_page?(path_to_match)
  end

  current
end 
```

这会将`/(some locale)/home`和标记`/`为当前。

像这样，您可以完全控制您的实施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T12:07:41.947

感谢[Beat Richartz](https://stackoverflow.com/users/670034/beat-richartz)为我指明了正确的方向。他提供的代码解决了这个问题，但是我将在这里注册我实现的解决方案。

```
def current_p(path)
  if path == home_path
    'current' if current_page?(path) || current_page?('/')
  else
    'current' if current_page?(path)
  end
end 
```

# asp.net-mvc-4 - ASP.NET MVC 4 如何管理控制器内的用户 ID 和用户内容

> ID：14630158
> 
> 赞同：1
> 
> 时间：2013-01-31T16:12:15.487
> 
> 标签：asp.net-mvc-4, httpcontext, user-management, simplemembership

要了解我正在开发的 ASP.NET MVC 4 模式和必须管理一些数据和用户内容的应用程序。

这是数据库：

```
public DbSet<UserProfile> UserProfiles { get; set; }
public DbSet<Fund> Funds { get; set; }
public DbSet<Source> Sources { get; set; }
public DbSet<Portfolio> Portfolios { get; set; }
public DbSet<Quote> Quotes { get; set; }
public DbSet<Deposit> Deposits { get; set; } 
```

其中关系基数是：

*   UserProfile（用户） - 投资组合：1-N
*   用户资料 - 存款：1-N
*   投资组合 - 基金：NM
*   基金 - 来源：1-N
*   基金 - 报价：1-N
*   资金-存款：1-N

数据库中还有 ASP.NET 简单成员表：webpages_Membership、webpages_OAuthMembership、webpages_Roles、webpages_UsersInRoles。

**用户资料模型**：

```
[Table("UserProfile")]
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
} 
```

**投资组合模型**：

```
public class Portfolio
{
    public int Id { get; set; }

    [Display(Name = "Label")]
    [MaxLength(30)]
    [Required(ErrorMessage = "Insert a label.")]
    public string Label { get; set; }

    [DataType(DataType.Date)]
    [Display(Name = "Created on")]
    [DisplayFormat(DataFormatString = "{0:d}", ApplyFormatInEditMode = true)]
    public DateTime CreationDate { get; set; }

    public virtual int UserId { get; set; } // Foreign key for UserProfile table

    public virtual ICollection<Fund> Funds { get; set; } // Linked Funds
} 
```

也就是说，这就是应用程序应该让用户做的事情：

*   注册/登录；
*   仅查看/修改/创建自己的投资组合/存款；
*   管理基金和投资组合；
*   现在这几乎是全部......

我在这里发布了我对投资组合控制器的**索引操作的实际实现。***我需要用户名来获取作为投资组合表上的外键的 UserId*，以仅获取特定用户的投资组合。然后我使用 LINQ 进行查询。

```
[Authorize]
public class PortfolioController : Controller
{
    private readonly MyDb _db = new MyDb();

    public ActionResult Index()
    {
        string userName = null;

        if (HttpContext.User.Identity.IsAuthenticated)
        {
            userName = HttpContext.User.Identity.Name;
        }

        var result = _db.UserProfiles
                        .Where(u => u.UserName.Equals(userName))
                        .Join(_db.Portfolios, u => u.UserId, p => p.UserId, (u, p) => p);

        return View(result);
    }
} 
```

那么，这种方法呢？我已经知道这可能不是最好的解决方案......

然后，在**Create 操作中，** *我需要 UserId 将新的投资组合与正确的用户相关联*，那么我该怎么办？

```
//
// GET: /Portfolio/Create

public ActionResult Create()
{
    return View();
}

//
// POST: /Portfolio/Create

[HttpPost]
public ActionResult Create(Portfolio portfolio)
{
    if (ModelState.IsValid)
    {
        // TODO:
        // Here I need the UserId to associate the new portfolio with the user!
        // I don't want to make another LINQ query to get the UserId from Username.
        // ...

        _db.Portfolios.Add(portfolio);
        _db.SaveChanges();
        return RedirectToAction("Index");
    }

    return View(portfolio);
} 
```

当然，我需要用存款模型做同样的事情，因为用户创建了一个新的存款，并且只能查看/编辑他自己的存款。

**我想知道的是：**

在许多控制器操作和视图上，管理用户内容和 Username/UserId 需求的最佳模式（最正确/最优雅）是哪一种？

# javascript - Javascript - Sql 结果集按日期顺序排序

> ID：14630160
> 
> 赞同：0
> 
> 时间：2013-01-31T16:12:29.613
> 
> 标签：javascript, jquery, cordova, web-sql

我正在构建一个使用 websql 的 phonegap 应用程序。

在我的 phonegap 数据库中，我有录音，表格看起来像这样

ID, ref, startdate, enddate .... 等

在我的一个应用程序页面上，我获取了所有这些记录并将它们附加到列表视图（我正在使用 JQM）。

我想在开始日期之前订购这些，但它不像使用 SQL ORDER BY 那样简单，因为日期以 Javascript 日期对象格式存储，例如 - Tue Jan 29 15:59:02 GMT+0000(GMT ）。在将它们附加到我的列表之前，我想通过递减日期顺序来订购它们。

有人可以为我指出如何使用 javascript 实现这一目标的正确方向吗？

提前致谢！

# git - 如何将 Git 项目导入 TFS Cloud

> ID：14630161
> 
> 赞同：10
> 
> 时间：2013-01-31T16:12:31.613
> 
> 标签：git, tfs, visual-studio-2012, azure-devops

我访问了我们的 Team Foundation Service 页面，发现了一个很棒的新功能：

***新团队项目 + Git***

这是个好消息。我们在 Team Foundation Service 和 Git 中有项目。不是因为我喜欢 Git。它的功能给我留下了深刻的印象，但对它的界面却不满意。也就是说，Git 是公认的开源标准，我喜欢能够通过 TFS 管理我的 Git Repos 的想法。两全其美（我希望）。

我能够在 Git 中创建一个测试项目并且很兴奋。

**问题：**对于所有网站搜索、谷歌搜索、戳戳、刺激，我无法弄清楚如何将***现有的***Git 项目导入 TFS。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-31T16:50:03.313

**tl; dr**：设置遥控器并推送。

1.  确保在 Team Foundation Service 中启用备用凭据。

2.  设置你的遥控器： `git remote add <name> <url>`，
    例如`git remote add origin https://yourname.visualstudio.com/DefaultCollection/_git/ProjectName`

3.  推它： `git push <remote name> <name of branch>`，
    例如`git push origin branchname`

# visual-studio-2012 - Azure 打包失败 - 缺少程序集 - 根：解决方案无法在发布中构建

> ID：14630166
> 
> 赞同：0
> 
> 时间：2013-01-31T16:12:45.730
> 
> 标签：visual-studio-2012, solution, release-builds, azure-packaging

我刚刚将我的 MVC 应用程序移植到 Azure，将其添加为 Web 角色，但无法打包 Azure 项目。

它抱怨我位于解决方案文件夹中的解决方案中的工作流项目缺少程序集：

```
Application (Solution)
    | Application.Workflows (Solution Folder)
         | Application.Workflows.Registration (Workflow Project)
    | Application.Azure (Cloud Service Project)
    | Application.Web (MVC project) 
```

在首先确保相关程序集已`Copy Local`设置为之后，`true`我深入挖掘发现我无法`Application.Workflows.Registration`在发布模式下构建项目，这是我尝试将解决方案打包的模式。（调试构建工作正常。）

```
Warning Could not resolve this reference. Could not locate the assembly "Application.DataAccess" (SAME FOR Application.EntityModel). Check to make sure the assembly exists on disk. If this reference is required by your code, you may get compilation errors. 
```

该警告会导致大量此类错误：

```
Error The type or namespace name 'DataAccess' does not exist in the namespace 'Application' (are you missing an assembly reference?)    C:\Source Control\Application\Application.Workflows.Registration\Membership.cs 
```

同样，该解决方案在调试中构建良好，我查看了配置管理器和调试/发布配置是相同的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T18:11:40.920

好的，我解决了这个问题。

即使在发布版本中，它所抱怨的两个程序集也被 bin/Debug 引用。我必须重新添加选择了“发布”配置的两个程序集，以便从 bin/Release 中引用它们

# asp.net-mvc-3 - 在 ASP.NET MVC 中打印

> ID：14630169
> 
> 赞同：0
> 
> 时间：2013-01-31T16:12:52.797
> 
> 标签：asp.net-mvc-3, asp.net-mvc-4

假设我们在 asp.net mvc 中有一个网页，并且我们使用 css 应用了一些样式，现在我想在打印对话框中以确切的格式打印整个网页或网页的某些部分。是否有任何方法或 API 可以在 ASP.NET MVC 中打印网页。

我怎样才能实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:15:20.687

这与 ASP.NET MVC（服务器端）和 CSS（客户端）无关。

查看可用的[CSS 媒体类型](http://www.w3.org/TR/CSS2/media.html)。本质上，您要做的是创建一个针对“打印”媒体类型的单独样式表（或同一样式表中的单独规则）。然后，浏览器将在打印时使用该样式表（或那些样式规则）。

# java - JUnit Eclipse - 成功时显示堆栈跟踪

> ID：14630171
> 
> 赞同：5
> 
> 时间：2013-01-31T16:12:53.623
> 
> 标签：java, eclipse, junit4

我正在 Eclipse 中编写一些单元测试，这些测试期望抛出异常。

我想知道是否有一个选项可以在测试通过时显示堆栈跟踪，这在您第一次编写测试以检查是否真的由于您正在测试的情况而引发异常时很有用。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:19:56.427

你不应该这样做。

使用`@Test`带有`expected`参数的注释：

```
@Test(expected=MyAppException.class) 
```

如果测试*没有*抛出异常，那就是测试失败。

应该有一个 Eclipse 视图选项来显示测试日志记录输出，但一般来说，来自测试的显式日志记录没有价值。如果您不信任 JUnit 注释，也可以调试您的测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:18:15.837

为什么不将 System.out.print() 语句放在测试的 catch 块中？我不确定您还想如何显示测试的输出，因为它们通常被构建为在成功时保持沉默，因为它们太多了。

您是否考虑过使用 log4j 和 log.debug()？

# blit - 这个 DirectFB Blit 示例有什么问题？

> ID：14630174
> 
> 赞同：1
> 
> 时间：2013-01-31T16:13:02.440
> 
> 标签：blit, directfb

我得到了[directfb 图像示例](http://directfb.org/docs/DirectFB_Tutorials/image.html)，我正在尝试 blit 图像，如此[处](http://mail.directfb.org/pipermail/directfb-dev/2009-October/005299.html)所述。所以，这是我的代码：

```
#include <stdio.h>
#include <unistd.h>

#include <directfb.h>

static IDirectFB *dfb = NULL;
static IDirectFBSurface *primary = NULL;
static int screen_width = 0;
static int screen_height = 0;
#define DFBCHECK(x...)                                         \
  {                                                            \
    DFBResult err = x;                                         \
                                                               \
    if (err != DFB_OK)                                         \
      {                                                        \
        fprintf( stderr, "%s <%d>:\n\t", __FILE__, __LINE__ ); \
        DirectFBErrorFatal( #x, err );                         \
      }                                                        \
  }

/* reflection against y */
static int DFB_FIXED_POINT_ONE = 1;
static const s32 mat_y[9] = {
 -DFB_FIXED_POINT_ONE, 0,                   0,
  0,                   DFB_FIXED_POINT_ONE, 0,
  0,                   0,                   DFB_FIXED_POINT_ONE
};

static IDirectFBSurface *logo = NULL;
int main(int argc, char **argv) {
    int i;

    DFBSurfaceDescription dsc;
    IDirectFBImageProvider *provider;
    DFBCHECK(DirectFBInit (&argc, &argv));
    DFBCHECK(DirectFBCreate (&dfb));
    DFBCHECK(dfb->SetCooperativeLevel (dfb, DFSCL_FULLSCREEN));
    dsc.flags = DSDESC_CAPS;
    dsc.caps = DFBSurfaceCapabilities(DSCAPS_PRIMARY | DSCAPS_FLIPPING);
    DFBCHECK(dfb->CreateSurface( dfb, &dsc, &primary ));
    DFBCHECK(primary->GetSize (primary, &screen_width, &screen_height));
    DFBCHECK(dfb->CreateImageProvider (dfb, "iconC.png", &provider));
    DFBCHECK(provider->GetSurfaceDescription (provider, &dsc));
    DFBCHECK(dfb->CreateSurface( dfb, &dsc, &logo ));
    DFBCHECK(provider->RenderTo (provider, logo, NULL));
    provider->Release(provider);
    for (i = -dsc.width; i < screen_width; i++) {

        DFBCHECK(primary->SetRenderOptions(primary, DSRO_MATRIX));
        DFBCHECK(primary->SetMatrix(primary, mat_y));

        DFBCHECK(primary->FillRectangle (primary, 0, 0, screen_width, screen_height));
        DFBCHECK(primary->Blit (primary, logo, NULL, i, (screen_height - dsc.height) / 2));
        DFBCHECK(primary->Flip (primary, NULL, DSFLIP_WAITFORSYNC));
        usleep(1000*10); // 10 microseconds
    }
    logo->Release(logo);
    primary->Release(primary);
    dfb->Release(dfb);
    return 23;
} 
```

这个程序的输出有很多：

```
`(!!!)  *** WARNING [rotation not yet implemented] *** [gfxcard.c:2075 in dfb_gfxcard_blit()]`
`(!!!)  *** WARNING [rotation not yet implemented] *** [gfxcard.c:2075 in dfb_gfxcard_blit()]`
`(!!!)  *** WARNING [rotation not yet implemented] *** [gfxcard.c:2075 in dfb_gfxcard_blit()]` 
```

这是我的 DFB 版本的问题吗？我正在使用 DirectFB 1.4.11。

有没有办法让这个例子运行并blit图像？

*（顺便说一句，我不理解 DFB_FIXED_POINT_ONE 变量，所以我给它任何值来尝试）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-18T06:27:20.520

我想让 directfb 显示旋转 90 度的所有内容，这似乎是一个很好的起点。

有两点需要考虑：

首先，数字是定点 16.16 fmt - 所以高位是整数部分，低 16 位是小数部分 - 所以 0x10000 代表 1（即 1 << 16），而 0xffff0000 代表 -1（即 - 1 << 16)。

其次，计算似乎是针对实际（而不是标准化）屏幕坐标进行的，计算结果需要在范围 0 .. screen width - 1 for X 和 0 .. screen height - 1 for Y to被显示。

在您的情况下，正确的矩阵似乎是：

```
{
    (-1 < 16), 0,         ((screen_width - 1) << 16),
    0,         (1 << 16), 0,
    0,         0,         (1 << 16),
} 
```

请注意第一行的最后一项，它将 X 坐标移回 X 坐标的正确范围。

# c# - 获取图像，未经授权的访问异常错误

> ID：14630179
> 
> 赞同：2
> 
> 时间：2013-01-31T16:13:10.507
> 
> 标签：c#, windows-phone-7

我正在获取 json 数据，其中有一个链接可以再次获取图像

例如：

```
{"status":"403","message":"Not Authorized","image":"http:\/\/abc.com\/images\/1.jpg"} 
```

状态，消息 n 图像检索得非常好，因为我在文本框中显示了值。

此外，我想显示图像，所以我这样做：

```
public string link = ClassName.variableName; 
```

`link`现在持有价值`http//abc.com/images/1.jpg`。我在文本框中显示了它的值并且很好。所以我更进一步：

```
BitMapImage MyImage = new BitMapImage( new Uri (link, UriKind.RelativeOrAbsolute));

image1.source = MyImage; 
```

但是当我运行它时显示错误“未经授权的访问异常未处理”。为了交叉检查，我打开了一个新项目，而不是获取数据，而是直接提供了一个指向图像源的链接并显示了图像。

```
BitMapImage MyImage = new BitMapImage( new Uri ("http//abc.com/images/1.jpg", UriKind.RelativeOrAbsolute));

image1.source = MyImage; 
```

在这里它工作正常。显示图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:23:41.113

i wasn't using Deployment.Current.Dispatcher.BeginInvoke(() => now it works fine.

# c++ - 如果需要，我如何安全地在任何带有剪辑的数字类型之间进行转换？

> ID：14630182
> 
> 赞同：0
> 
> 时间：2013-01-31T16:13:24.523
> 
> 标签：c++

我想要以下形式的功能

```
template <typename T, typename U>
U clipAndCast(T x)
{
  ... 
  return y;  
 }, 
```

其中 y 是 x 强制转换为 U 类型，但如果需要，x 会被剪裁，以便此强制转换是明确定义的。

是否有库或增强功能可以做到这一点？我找不到，如果不是，那么编写这样一个函数的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:24:06.443

方法是测试进来的值是否大于等于出去的类型的最小值，小于等于出去的类型的最大值。您可以使用`std::numeric_limits<U>::min()`and`std::numeric_limits<U>::max()`来获取最小值和最大值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T07:29:50.853

看看[Boost 的数值转换](http://www.boost.org/doc/libs/1_52_0/libs/numeric/conversion/doc/html/index.html)库。

# windows-8 - Windows 应用商店应用自定义背景颜色

> ID：14630189
> 
> 赞同：0
> 
> 时间：2013-01-31T16:13:39.643
> 
> 标签：windows-8, windows-store-apps

有没有办法为 Windows 商店应用程序启动屏幕自定义背景颜色？我尝试使用颜色代码，但它会引发错误！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:21:30.083

启动画面颜色在您的应用清单中设置，在“启动画面”标题下的“背景颜色”选项中。这可能是清单编辑器中“应用程序 UI”选项卡中的最后一件事。您需要使用六位十六进制颜色代码，前面有一个突出符号，例如`#rrggbb`.

# actionscript-3 - 项目中整个焦点元素的 Enter 按钮事件的动作脚本

> ID：14630190
> 
> 赞同：2
> 
> 时间：2013-01-31T16:13:41.270
> 
> 标签：actionscript-3, apache-flex, actionscript, air

嗨，我正在开发一个 Adob​​e AIR 应用程序。我已经为我的项目中的所有按钮实现了单击事件。现在我想为焦点按钮添加“ENTER”键盘事件。有没有简单的方法来实现它？请给我建议。。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:26:58.440

你可以做这样的事情：

```
<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
                       xmlns:s="library://ns.adobe.com/flex/spark" 
                       xmlns:mx="library://ns.adobe.com/flex/mx"
                       addedToStage="addEnterFeature()">
    <fx:Script>
        <![CDATA[
            private function addEnterFeature() : void
            {
                stage.addEventListener(KeyboardEvent.KEY_DOWN, onKeyDown);
                myButton.addEventListener(MouseEvent.CLICK, onButtonClick);
            }

            private function onKeyDown(e : KeyboardEvent) : void
            {
                if(e.keyCode == Keyboard.ENTER && stage.focus is Button)
                    // Simulate a mouse click on current focused button
                    Button(stage.focus).dispatchEvent(new MouseEvent(MouseEvent.CLICK));
            }

            private function onButtonClick(e : Event) : void
            {
                trace("Button click handler");
            }

        ]]>
    </fx:Script>
    <s:Button label="Test" id="myButton" />
</s:WindowedApplication> 
```

如果您在应用程序中的每个按钮（具有焦点）上使用 Enter，它将模拟鼠标单击

# sql - 使用外键，我可以在复合主键中引用固定值吗？

> ID：14630192
> 
> 赞同：4
> 
> 时间：2013-01-31T16:13:44.703
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2012

我有一个数据库结构，其中包括下表：

```
CREATE TABLE dbo.PaymentProvidersForEntities
(
    PaymentProviderId SMALLINT NOT NULL,
    EntityId BIGINT NOT NULL, 
    CONSTRAINT PK_PaymentProvidersForEntities 
        PRIMARY KEY (PaymentProviderId, EntityId), 
    CONSTRAINT FK_PaymentProvidersForEntities_PaymentProviders 
        FOREIGN KEY (PaymentProviderId) 
        REFERENCES PaymentProviders(PaymentProviderId) 
        ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT FK_PaymentProvidersForEntities_Entities 
        FOREIGN KEY (EntityId) 
        REFERENCES Entities(EntityId) 
        ON DELETE CASCADE ON UPDATE CASCADE
) 
```

显然，这是一个带有复合主键的简单多对多链接表。我想要另一个引用该表但只为一个 PaymentProvider 提供数据的表（即 PaymentProviderId = 固定值）。就像是：

```
CREATE TABLE dbo.SpecificPaymentProviderExtraDetails
(
    EntityId BIGINT NOT NULL,
    ExtraDetails NVARCHAR(MAX) NOT NULL,
    CONSTRAINT PK_PaymentProviderExtraDetails 
        PRIMARY KEY (EntityId), 
    CONSTRAINT FK_PaymentProviderExtraDetails_PaymentProvidersForEntities 
        FOREIGN KEY (EntityId, 1) 
        REFERENCES PaymentProvidersForEntities(EntityId, PaymentProviderId) 
        ON DELETE CASCADE ON UPDATE CASCADE
) 
```

显然，我可以在 PaymentProvidersForEntities 表中添加一个可为空的“ExtraDetails”字段，但我觉得这不是很优雅，因为会有几种不同类型的支付提供商，每一种都需要不同类型的额外细节。有没有一种优雅的方式来做我想做的事？如果不是，那么实现相同目标的更好方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T17:20:51.847

最简单的方法是存储支付提供商 ID，并使用 CHECK() 约束来确保它是您想要的。假设您希望支付提供商 ID 始终等于 13。

```
CREATE TABLE dbo.PaymentProviderExtraDetails
(
    PaymentProviderID SMALLINT NOT NULL DEFAULT 13 CHECK(PaymentProviderID = 13),
    EntityId BIGINT NOT NULL,
    ExtraDetails NVARCHAR(MAX) NOT NULL,
    CONSTRAINT PK_PaymentProviderExtraDetails 
        PRIMARY KEY (PaymentProviderID, EntityId), 
    CONSTRAINT FK_PaymentProviderExtraDetails_PaymentProvidersForEntities 
        FOREIGN KEY (PaymentProviderID, EntityID) 
        REFERENCES PaymentProvidersForEntities(PaymentProviderId, EntityId) 
        ON DELETE CASCADE ON UPDATE CASCADE
); 
```

我更喜欢这种方法而不是持久列，因为这种方法遵循[最不意外的原则](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)。扩展到支持两个、三个或四个支付提供商而不是一个也更简单。

如果我是你，我会重新考虑表名。它*可能*应该以您为其记录数据的单一支付提供商命名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:56:15.863

您可以将持久计算列添加到引用列列表：

```
CREATE TABLE dbo.p(i1 INT, i2 INT, CONSTRAINT p_pk PRIMARY KEY CLUSTERED (i1,i2));
CREATE TABLE dbo.c(id INT PRIMARY KEY CLUSTERED,i1 INT, i2 AS 1 PERSISTED, CONSTRAINT c_fk FOREIGN KEY (i1,i2) REFERENCES dbo.p(i1,i2));
INSERT INTO dbo.p(i1,i2)VALUES(42,1);
INSERT INTO dbo.c(id,i1)VALUES(111,42); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-31T16:50:43.720

如果您的第二个表的主键是代理键，并且您为您想要的复合键部分创建一个外键，它将为您完成。

例如，伪sql

foo
bar int primarykey
foobar int primarykey

测试
testFoo int
primarykey foobar int foriengkey

只要确保你只把你想要的项目放在测试中。如果你真的想要安全，你可以限制`foobar`确保它只有你想要的值

# sharepoint - 在 SharePoint 2010 Foundation 中找不到审批工作流

> ID：14630193
> 
> 赞同：1
> 
> 时间：2013-01-31T16:13:46.993
> 
> 标签：sharepoint, sharepoint-workflow, sharepointfoundation2010

我是 SharePoint 的新手，我想开发一个利用审批工作流的休假表单应用程序，但我在 SharePoint Foundation 2010 上找不到它。如何启用它？我已经尝试了很多我在谷歌上找到的方法，但我仍然没有任何线索。请指导我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T14:51:12.420

我找到了答案；当我使用 SharePoint Foundation 时，除了三态工作流之外，现在提供了开箱即用的工作流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T22:02:21.163

可以直接从库设置中激活简单的审批工作流程：

转到您的列表-> 功能区中的库设置-> 版本控制设置-> 允许批准内容选项为是...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-01T15:27:21.127

从您的文档库中：

*   单击库选项卡
*   单击库设置磁贴
*   选择工作流程设置链接
*   单击添加工作流链接
*   批准应该在工作流模板列表中

如果这不起作用，请检查您的网站集功能并确保工作流已激活。

# android - 使用 hashmap 时刷新列表视图

> ID：14630197
> 
> 赞同：2
> 
> 时间：2013-01-31T16:14:04.527
> 
> 标签：android, android-listview, hashmap

我有一个多行列表视图，使用 hashmaps 实现。我从数据库中获取数据。

我有另一个活动，我正在添加我的项目，这些项目正在添加到数据库中。现在，当按下保存按钮时，新添加的项目应立即出现在片段中实现的列表视图中。我不知道如何刷新此活动中的列表视图。

这是我实现 listview 的片段：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {             
            myView = inflater.inflate(R.layout.fragment_layout, container, false);

            l = db.getAllEntries();

            list = (ListView) myView.findViewById(R.id.entrylist);
            mylist = new ArrayList<HashMap<String,String>>();

            HashMap<String,String> item;

            while(!l.isEmpty()){

                e = l.get(0);
                l.remove(0);

              item = new HashMap<String,String>();

              item.put( "line1", e._totime + " - " + e._totime);
              item.put( "line2", e._subject);
              item.put( "line3", e._place);
              mylist.add(n++,item);
            }

              sa = new SimpleAdapter(getActivity(), mylist,
                        R.layout.multi_line,
                        new String[] { "line1","line2", "line3" },
                        new int[] {R.id.line_a, R.id.line_b, R.id.line_c}); 

            list.setAdapter(sa);
return myView;
    } 
```

在这个活动中，我将项目添加到数据库中，它应该立即出现在我上面的列表视图中：

```
public boolean onOptionsItemSelected(MenuItem item) {
  switch (item.getItemId()) {
  case R.id.save:

      sub = subject.getText().toString();
      teach = teacher.getText().toString();
      pla = place.getText().toString();
      da = day.getSelectedItem().toString();
      fro = fromtime.getText().toString();
      to = totime.getText().toString();

      i = new Entries(sub,teach,pla,da,fro,to);
      db.addEntry(i);

      FragmentView1 f = (FragmentView1) this.getSupportFragmentManager().findFragmentByTag(FragmentView1.class.getName());

      l = db.getAllEntries();
      HashMap<String,String> map;

      while(!l.isEmpty()){

        e = l.get(0);
        l.remove(0);

        map = new HashMap<String,String>();

        map.put( "line1", e._fromtime + " - " + e._totime);
        map.put( "line2", e._subject);
        map.put( "line3", e._place);
        f.getArrayList().add(n++,map);    //nullpointerexception here
      }
      f.getMyListAdapter().notifyDataSetChanged();

        /*Toast.makeText(this, "You have chosen the " + getResources().getString(R.string.save) + " menu option",
                    Toast.LENGTH_SHORT).show();*/
        return true;

  default:
        return super.onOptionsItemSelected(item);
  } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:39:50.000

这可能是因为 findFragmentByTag() 无法找到所需的片段，因此返回 null，导致尝试访问它时出现 NullPointerException。您可以通过检索片段的标签并将其存储在活动类变量中以供进一步访问来尝试解决方法，如下所示：

在您的活动类中，为它声明一个私有字符串变量和 getter/setter 方法：

```
 public String fragmentView1Tag;

public String getfragmentView1Tag() {
    return fragmentView1Tag;
}

public void setfragmentView1Tag(String fragmentView1Tag) {
    this.fragmentView1Tag = fragmentView1Tag;
} 
```

在 FragmentView1 类中，检索片段的标签并设置 fragmentView1Tag 变量：

```
 String tag = getTag();
    ((YourActivityName) getActivity()).setfragmentView1Tag(tag); 
```

现在在活动类中检索片段时，使用上面的 getter 方法：

```
 FragmentView1 f = (FragmentView1) this.getSupportFragmentManager().findFragmentByTag(getfragmentView1Tag); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:36:21.907

使用游标从数据库中获取所有行。然后使用光标适配器填充列表。向数据库添加新行后，只需调用 notifyDataSetChanged(); 在光标适配器上。

# database - 数据库设计 - 特许经营

> ID：14630198
> 
> 赞同：0
> 
> 时间：2013-01-31T16:14:06.290
> 
> 标签：database, database-design

我正在尝试设计一个存储以下内容的数据库：

```
- Franchise Name (string)
- Employee Count (integer)
- Locations (zip-code) 
```

我遇到的问题是数据库的潜在大小（所有潜在的特许经营权以及位置）以及如何设计数据库以便特定特许经营权的邮政编码可以存储在同一个单元格中。这是否可能有一个单元格，其中包含“95432、12345、92534、68723”之类的内容，并且可以通过查询进行查询和修改以添加或删除邮政编码？我希望能够定期执行以下操作：

```
SELECT franchiseName
FROM database
WHERE zipCode = "12345" 
```

然后显然，显示在该邮政编码中具有位置的所有特许经营权。我不想为每个邮政编码创建一个单独的元组，对吗？不会是这样的：

```
Pizza Hut, 23, 95432
Pizza Hut, 12, 12345 
Pizza Hut, 07, 92534 
Pizza Hut, 15, 68723 
```

由于重复的特许经营名称的潜在数量，被认为是糟糕的设计？（想象一个麦当劳）

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:17:32.887

非规范化设计将有一家公司持有该名称，以及相关的特许经营权。

这也允许存储所有特许经营公司共有的公司信息（例如，总部信息）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:17:40.083

您应该将该信息拆分为两个表：

```
franchise(id,name, employee_count)
zipcode(franchise_id,zipcode) 
```

如果“位置”包含的信息不仅仅是邮政编码，您应该将所有位置放在一个单独的表中，并在特许经营和位置之间建立一个映射表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T16:18:31.230

基本上，您正在定义多对多关系。这种情况下的常见做法是使用包含所有位置的表和映射表。此映射表包含特许经营权的 ID 和位置之一。使用联接，您可以获得所需的所有信息，并且不会出现数据重复。

# php - 通过作曲家安装时出现 Symfony2 错误

> ID：14630199
> 
> 赞同：0
> 
> 时间：2013-01-31T16:14:13.030
> 
> 标签：php, symfony, installation, composer-php

我正在尝试通过 composer 在 Ubuntu 服务器上安装 Symfony2：

```
php composer.phar create-project symfony/framework-standard-edition /var/www/dev/myproject 2.1.7 
```

但它失败并出现以下错误：

```
- Installing doctrine/doctrine-bundle (v1.1.0)
    Downloading: 100%
    rm: cannot remove `/var/www/dev/myproject/vendor/doctrine/doctrine-bundle/Doctrine/Bundle/DoctrineBundle': Directory not empty

  [ErrorException]
  ZipArchive::extractTo(): File name too long 
```

谷歌没有帮助，知道问题可能是什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T08:35:25.527

我猜这个问题与作为 VM 的 linux 服务器有关，而我尝试在其中安装 symfony2 的文件夹是从 Windows（主机）共享的文件夹......

重新启动后，该错误消失了（给我留下了很多随机的作曲家错误，但这些都不在这个问题的范围内；））

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T01:14:51.930

尝试进入要安装它的目录，然后执行

`php composer.phar create-project symfony/framework-standard-edition myproject 2.1.7`

# android - 将 Android 移植到 BB：单击“信息”按钮时，应用程序崩溃

> ID：14630202
> 
> 赞同：0
> 
> 时间：2013-01-31T16:14:20.373
> 
> 标签：android, actionbarsherlock, porting, blackberry-10

最近我们在黑莓 10 上成功移植了一个 Android 应用程序。

一切正常，除了从屏幕底部出现的操作栏中单击“信息”按钮时 - 应用程序崩溃。

我想那个按钮应该显示一个关于或帮助页面。我们的应用程序中确实有一个这样的页面（作为 ActionBar 中的 ActionItem）。

有谁知道我们是否有办法解决这个问题，以便在单击“信息”按钮时显示我们的关于页面？或者至少做一些事情来防止应用程序崩溃，例如隐藏那个按钮。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T09:10:53.490

我在 BB 开发者论坛上发布了这个问题，并得到了一个很好的答案：

> 这实际上是 BlackBerry 10 模拟器版本上当前 Android Runtime 中的一个已知问题。它与您的应用程序无关，因为此操作栏是 Android 运行时的一部分，而不是您的应用程序。通常，当您选择“信息”按钮时，您会看到一个屏幕，显示您必须使用 Android 运行时应用程序中使用的向后滑动手势。如果您想要自己的“关于”按钮，则必须创建自己的菜单。

# html - 站点标题的语义标记，即使使用大纲

> ID：14630210
> 
> 赞同：4
> 
> 时间：2013-01-31T16:14:37.320
> 
> 标签：html, semantics, markup, outliner

通常，当我编写 HTML5 文档时，我使用以下语法：

```
<header class="site-header">
    <hgroup class="site-brand">
        <h1 class="brand-name">
            Brand Name
        </h1>
        <h2 class="brans-slogan">
            Awesome Slogan
        </h2>
    </hgroup>
</header>
<article>
    <header class="article-header">
        <h1 class="article-title">Article Header</h1>
    </header>
    [... content ...]
</article> 
```

它似乎是`header`站点标题的正确标签，但是在阅读了[规范](http://www.w3.org/TR/html-markup/header.html#header-details)并[概述了这段代码](http://gsnedders.html5.org/outliner/process.py?url=http%3A%2F%2Fcesarhdz.com%2Fdemo%2Fheader-markup.html)之后，我发现了两个缺点

*   `header`标签使其内容第一级，文章标题第二级
*   站点标题可能根本不包含标题，因为它的目的是告诉用户该页面属于谁。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:50:25.910

您的第一个问题是您有两个 h1 标签。这不是正确的语义标记。您对标题标签是正确的，最好在该区域放置高级 h 标签。

话虽如此，您最初的问题是设计和内容架构问题。如果您要在文章正文中使用 h1，那么您应该选择不同的标签在页面标题中使用。

规范说，“标题元素**通常包含**一个部分的标题（一个 h1-h6 元素或 hgroup 元素），以及该部分的介绍性材料或导航帮助等内容。”

不过，它不必这样做。h1 标签（和标题标签）是页面的主要语义指标。您不想要 2 个 h1 标签或标头标签，但是这两个标签不必放在一起……但是如果您能以这种方式构建它，那就太好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T16:43:50.797

您`header`在此示例中的使用是可以的。

但是，这里并不真正需要它。如果只包含`h1`-`h6`和`hgroup`，则*不需要*指定它是一个标题，因为它在定义上已经很清楚了。`header`如果您想包含其他内容，但不一定清楚它应该属于标题还是主要内容，这很有用。

但是`header`只使用标题并没有什么坏处，所以如果你喜欢它就继续使用它，CSS/JS 钩子需要它，将来可能包含额外的标题内容等等。

> `header`标签使其内容第一级，文章标题第二级

我不明白你的意思。该`header`元素不影响文档大纲。这是一种区分介绍性内容和主要内容的方法。

> 站点标题可能根本不包含标题，因为它的目的是告诉用户该页面属于谁。

该`header`元素不必*包含*标题。例如，这个例子很好：

```
<article>
  <header>I visited Berlin last week and in this post I document what I liked about it.</header>
  <p>…&lt;/p>
</article> 
```

该[`footer`元素](http://www.w3.org/TR/html5/sections.html#the-footer-element)是相似的，对于某些内容，这两个元素都可能是合适的。

如果你想给文章作者添加属性，它会进入一个`footer`.

# c# - 将未分配的对象自动分配给变量

> ID：14630211
> 
> 赞同：1
> 
> 时间：2013-01-31T16:14:38.893
> 
> 标签：c#, web-services

所以可以说我们有类似这个 websericeclient 对象的东西

```
var myname = new WebServiceClient().GetName ( ) ; 
```

这个对象（WebServiceClient()）会发生什么，它会自动处理还是留在内存中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:19:41.157

“处置”（调用 IDisposable.Dispose()）与内存无关。它与释放非托管资源（如文件或数据库句柄）有关。

当您不调用 Dispose() 时会发生什么情况，这些资源将一直保留到当垃圾收集器运行以从内存中释放对象时调用终结器。如果您需要这些资源（或者如果在它们被 Disposed() 时会发生一些有趣的事情），那么您不想等待任意时间 - 完成后立即调用 Dispose()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:19:40.333

这取决于`_GetName()_`方法。并且在`_WebServiceClient()_`.

让我们举个例子：

```
public class WebServiceClient : IDisposable
{
    private static WebServiceClient viciousReference = null;

    public WebServiceClient()
    {
        viciousReference = this;
    }

    ~WebServiceClient()
    {
        Dispose();
    }

    public void Dispose() 
    {  
        // Standard Dispose implementation 
    }
} 
```

如果您的对象实现`Dispose()`了，请始终尝试自己调用它。不要只依赖垃圾收集器。

# javascript - 使用带有 jquery 的 img src 动态填充锚点 href

> ID：14630212
> 
> 赞同：0
> 
> 时间：2013-01-31T16:14:43.323
> 
> 标签：javascript, jquery

基本上我正在尝试获取图像的 SRC，将其包装在一个锚中，然后使用 img 的 SRC 因为它是 HREF，到目前为止我已经得到了以下代码，但我有点不知道如何完成它，有什么想法吗？

```
$('#detail img').wrap(function() {
return '<a href="" rel="one" class="fancybox" />';
  });

$('#detail img a').attr('src',$('#detail img').attr('src')); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:16:22.743

```
$('#detail img').wrap(function() {
    return '<a href="' + this.src + '" rel="one" class="fancybox" />';
}); 
```

顺便说一句，如果您可以修改初始 HTML，那么使用 JS 会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:16:32.887

```
$('#detail img').wrap(function() {
    return '<a href="' + $(this).attr('src') + '" rel="one" class="fancybox" />';
}); 
```

您的第二行将始终仅使用找到的*第一* `img a`行。此外，`img a`无论如何都不是有效的选择器，因为`a`不能是`img`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:16:42.857

在[`.wrap()`](http://api.jquery.com/wrap/)函数内部，`this`指的是当前元素（特定的`<img>`），所以你可以这样做：

```
$('#detail img').wrap(function() {
    return '<a href="' + this.src + '" rel="one" class="fancybox" />';
}); 
```

# iphone - 列出日历年中的天数

> ID：14630214
> 
> 赞同：0
> 
> 时间：2013-01-31T16:14:45.723
> 
> 标签：iphone, ios, objective-c, nscalendar

我想列出（NSLog）格鲁吉亚日历年（2013 年）的所有日期。我设法使用以下方法获取当前日期：

```
 NSCalendar*       calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
    NSDateComponents* components = [calendar components:NSDayCalendarUnit
                                               fromDate:currDate];
    NSInteger  day = [components day];
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateStyle:NSDateFormatterLongStyle];
    NSString *dateString = [dateFormatter stringFromDate:currDate];
    NSLog(@"%@", dateString); 
```

如何打印出 2013 年的所有日期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:58:34.910

```
NSDateFormatter* dateFormatter = [NSDateFormatter new] ;
dateFormatter.dateStyle = NSDateFormatterLongStyle ;

NSDate* today = [NSDate date] ;
NSCalendar* calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar] ;
NSDateComponents* thisYearComponents = [calendar components:NSYearCalendarUnit fromDate:today] ;
NSDate* firstDateInThisYear = [calendar dateFromComponents:thisYearComponents] ;

NSDateComponents* addDaysComponents = [NSDateComponents new] ;
addDaysComponents.day = 0 ;

while ( TRUE ) {
    NSDate* nextDateInThisYear = [calendar dateByAddingComponents:addDaysComponents toDate:firstDateInThisYear options:0] ;
    NSDateComponents* yearOfNextDateComponents = [calendar components:NSYearCalendarUnit fromDate:nextDateInThisYear] ;
    if ( yearOfNextDateComponents.year == thisYearComponents.year )
        NSLog(@"%@", [dateFormatter stringFromDate:nextDateInThisYear]) ;
    else
        break ;
    addDaysComponents.day += 1 ;
} 
```

[WWDC 2011 session 117 - Performing Calendar Calculations](https://developer.apple.com/videos/wwdc/2011/?id=117)是一个很好的信息来源。它介绍了为什么最好在循环中将`n`天数添加到固定的参考日期，而不是重复地将 1 天添加到最近使用的日期。

它还建议在您不关心时间的 NSDate 中使用中午（中午 12 点）而不是午夜（上午 12 点），因为夏令时会导致某些地方的某些日期不存在午夜。但在我的例子中，我没有费心去做。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-31T17:06:07.237

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"yyyy-MM-dd"];
NSDate *date = [dateFormatter dateFromString:@"2013-01-01"];

NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];

NSDateComponents *components = [calendar components:kCFCalendarUnitYear fromDate:date];

while ([components year] < 2014) {
    NSDateFormatter *dateFormatter1 = [[NSDateFormatter alloc] init];
    [dateFormatter1 setDateStyle:NSDateFormatterLongStyle];
    NSString *dateString = [dateFormatter1 stringFromDate:date];
    NSLog(@"%@", dateString);
    date = [NSDate dateWithTimeInterval:60*60*24 sinceDate:date];
    components = [calendar components:kCFCalendarUnitYear fromDate:date];
} 
```

# javascript - JavaScript 继承、接口

> ID：14630215
> 
> 赞同：1
> 
> 时间：2013-01-31T16:14:51.310
> 
> 标签：javascript, inheritance, prototype

我对 JavaScript 继承和原型有一些问题。我在 stackoverflow/google 中所做的所有研究都引导我使用我的类的原型，但这是我想要避免的一点。我现在的 JavaScript 不是这样构思的，但我确信这是可能的，我只是卡住了。

我有两节课（或者以后可能更多）。一个是基础，它将是一切之母，我希望它具有所有基本属性和方法（就像一个基本的 OO）。我的对象用于几何。

```
 function EnvObject(){
      this.position = {x: 0, y: 0};
      this.velocity = {x: 0, y: 0};
      this.mass = 0; // kg
      this.restitution = 0; // Restitution
      this.A = 0;
      this.Cd = 0; // Drag force

      function init(_x, _y, _mass, _restitution)
      {
        blabla
      };
    };

    function oCircle()
    {
     function foo(){}
     function bar(){}
    }
    function oSquare()
    {
     function foo(){}
     function bar(){}
    } 
```

主类为我的类提供了所有信息，比如正方形或圆形......用原型扩展它会导致大问题和一件好事，方法很好共享（这很酷），但我的属性也是共享的，所以当我在我的 Square 类中更改它，属性也会在 Circle 中更改（这是一件坏事）

我知道主要的解决方案是不提供属性接口，只将它们放在 Square/Circle 类中，但它不是很干净（我的意思是我写了两次或更多相同的属性）。

*我的主要目标是创建一个具有 2 个或更多其他类的新类，而不共享任何东西或可能只是几个方法？并最终编写干净的代码？:)*

所以我尝试了很多脚本......他们都使用这种技术。或者也许我只是错了，这可能是真的。

我也知道 JS 中不存在该类，它只是一个大功能。像这样写对象更好吗？我倾向于非常喜欢它，因为在我看来使用函数有点混乱。也许以这种方式继承要容易得多？

```
var envObject = {
    position: {x, y}
}
var oCircle = {
    foo: function(){}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:33:12.657

使用原型对象的新实例：

```
function oCircle() {
    function Circle() {
        this.foo = function(){};
    }
    Circle.prototype = new EnvObject();
    return new Circle();
}; 
```

现在，无论何时调用`new oCircle()`，都会使用一个新的 EnvObject 实例。这就是您对基于类的继承的期望。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:35:21.893

您可能遇到[了嵌套对象](https://stackoverflow.com/q/10131052/1048572)( `position`, `velocity`) 的问题。您将需要分别为每个不同的实例创建子对象。

> 我也知道 JS 中不存在该类，它只是一个大功能。像这样写对象更好吗？

不，不是“更好”，只是不同而已。您可以只使用返回普通对象的函数，而不是使用通过调用`new`和设置属性的构造函数 - 减少混淆。`this`

> 也许以这种方式继承要容易得多？

不是 JavaScript 使用的[原型继承](http://en.wikipedia.org/wiki/Prototype-based_programming)。此外，您可能想看看这个关于“类”如何在 JavaScript 中工作的[答案。](https://stackoverflow.com/a/13418980/1048572)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-07T22:43:10.933

## 最好的方法......（我见过）

这是一个很好的起点——我们结合使用***构造函数窃取和原型继承*** *（上面的#ppoliani 指出）*：

```
function SuperType() {
    this.super = 'type';
}
SuperType.prototype = { m: function () { } };

function C() {
    SuperType.call(this);
    this.key = 'value';
};
C.prototype = (new (function () {
    $.extend(this, new SuperType());
    this.some = 'thing';
})());

var c = new C();
console.log(c); 
```

然而，这可能需要一些调整——例如，`C.prototype`对象（使用`new`以便我们可以使用`this`——这很好）扩展`this`了，`new SuperType()`并且方法被添加到`this`而*不是* `C.prototype`——不好。它还使用了非本机`$.extend`功能——不好。

**当然**，大量使用继承可能是一种非常不受欢迎的方法。*Complex-Deep-Inheritance-Hierarchies*通常会导致*Class Architecture*中的极端熵。如果您的层次结构很复杂，那么深层架构将成为维护、可移植性和适应性的噩梦。如果是这种情况，请开始实施[***装饰者模式***](http://publib.boulder.ibm.com/infocenter/rsdvhelp/v6r0m1/index.jsp?topic=%2Fcom.ibm.r2a.archdisc.doc%2Ftopics%2Frdesignpatterns.html)。

这是一个示范性的答案，可以为读者提供更好的工具来操作继承链。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T16:31:50.947

您是否尝试过应用原型链接和构造函数窃取的组合？

```
 function SuperType(){
        this.prop1 = // some value
        this.prop2 = // some other value
    }

    SuperType.prototype.function1 = function(){

    };

    function SubTypeA(){
        SuperType.call(this); // add inherited properties to this instance

        this.subTypeProperty1 = ...
    }

    SubTypeA.prototype = new SuperType();

    SubTypeA.prototype.subTypeFunction1 = function(){

    } 
```

每个子类型都有自己的继承属性。

# javascript - 仅当字符数超过设置限制时才添加 div

> ID：14630218
> 
> 赞同：0
> 
> 时间：2013-01-31T16:14:54.663
> 
> 标签：javascript, jquery

如果选项卡包含超过 540 个字符，我正在尝试将 div 附加到 pdpTab5 。我将通过模态创建一种“阅读更多......”的情况。

我正在使用它来截断文本。但是添加 div 的部分让我感到困惑。如果选项卡包含少于 540 个字符，我不想显示 div。

```
<script>
    $(function(){
        var myDiv = $('#pdpTab5');
        myDiv.html(myDiv.html().substring(0,540));
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:18:21.903

```
$(function() {
      var myDiv = $('#pdpTab5'),
          divChars = myDiv.text(),
          shortened = divChars.substring(0, 540) + "... <a href='#' class='readMore'>Read more</a>",
          $new =$(myDiv.clone().html(shortened));

      if (divChars.length > 540) {
          // Perform some action here, not quite sure what you wanted to do 
          myDiv.empty().append($new).find(".readMore").on("click", function() {

              $(this).parent().empty().text(divChars);
          });

      }
 }); 
```

[这是小提琴。](http://jsfiddle.net/JRk34/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:22:48.623

试试这个...

```
<script>
    $(function(){
        var myDiv = $('#pdpTab5');

        if(myDiv.html().length > 540){
            // create new div
            myDiv.parent().append("<div>" + myDiv.html().substring(540) + "</div>");
        }
        myDiv.html(myDiv.html().substring(0,540));
    });
</script> 
```

# javascript - 更改两个输入字段的属性

> ID：14630219
> 
> 赞同：4
> 
> 时间：2013-01-31T16:14:56.010
> 
> 标签：javascript, jquery

我在使用 jQuery 向这些输入字段添加属性时遇到了一些问题：

```
<input id='timetable_start'>
<input id='timetable_finish'>

<script>
attributes = {
    "class": "reloj",
    "maxlength": "5",
    "pattern": "^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$",
    "size": "6",
    "type": "text"
};

$('#timetable_finish').attr(attributes);
$('#timetable_start').attr(attributes);
</script> 
```

为什么只改了一个？我错过了什么？提前感谢您的时间
链接：http: [//jsbin.com/iqipan/4/edit](http://jsbin.com/iqipan/4/edit)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T16:19:59.120

因为当您尝试为第一个输入字段设置属性时，代码会引发错误：

> 未捕获的错误：无法更改类型属性。

从对象中删除`type`，一切都会好起来的。

* * *

某些浏览器（我猜是 IE）不允许在`input`创建元素后更改其类型，因此如果您尝试这样做，jQuery 会抛出异常。请参阅[使用 jQuery 更改输入字段的类型](https://stackoverflow.com/questions/1544317/jquery-change-type-of-input-field)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T16:19:10.683

利用

```
$("#timetable_finish, #timetable_start").attr(attributes); 
```

但是，您不能更改`type`输入的属性。您将不得不创建一个新输入：

```
$("#timetable_finish").replaceWith($("<input>", attributes)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-31T16:20:03.630

这是因为*属性* `type`是只读的——而*DOM 属性* `type`不是。

您可以使用：

```
$('#timetable_finish').prop(attributes);
$('#timetable_start').prop(attributes); 
```

成功改变两者。

# ios - 无法处理节点 Cocos2D 上的触摸

> ID：14630224
> 
> 赞同：1
> 
> 时间：2013-01-31T16:15:19.017
> 
> 标签：ios, objective-c, cocos2d-iphone

我试图弄清楚多个`CCNode`s 上的触摸处理。

我有

```
 Main CCLayer
            ------> z:2 Hud CCNode 
```

在`main layer`我选择一个对象时，在我想控制它的 hud 层上。我关注了这个 q&a 它非常有用的 [Cocos2d 处理多层触摸](https://stackoverflow.com/questions/5222375/cocos2d-handling-touch-with-multiple-layers)

在`Main Layer`触摸事件上，下面是 Hud 节点的工作：

```
-(void) registerWithTouchDispatcher
{
   [[CCDirector sharedDirector].touchDispatcher addTargetedDelegate:self priority:0 swallowsTouches:YES]; 
}
-(BOOL) ccTouchBegan:(UITouch*)touch withEvent:(UIEvent*)event
{
    //detects touched Object and sends it to hud 

    if (object != nil)
    {
        //sends it to hud
        return true;
    }

    return false;
}
-(void) ccTouchMoved:(UITouch*)touch withEvent:(UIEvent*)event

-(void) ccTouchEnded:(UITouch*)touch withEvent:(UIEvent*)event

-(void) ccTouchCancelled:(UITouch*)touch withEvent:(UIEvent*)event 
```

在 Hud CCNode 上，没有任何 ccTouchBegan/moved/ended 方法被触发

```
-(void) registerWithTouchDispatcher
{
  [[CCDirector sharedDirector].touchDispatcher addTargetedDelegate:self priority:0 swallowsTouches:YES];

}
-(BOOL) ccTouchBegan:(UITouch*)touch withEvent:(UIEvent*)event
{
    if (object!=nil) {
        NSLog(@"Touch began");
        return YES;
    }
    else
        return NO;
} 
```

编辑：我有一个按钮可以在 HUD Node 上设置对象的速度，这与它无关，`object!=nil`因为当我放置断点时，我看到它`-(BOOL) ccTouchBegan:(UITouch*)touch withEvent:(UIEvent*)event`从未被调用

```
-(void)speed1Tapped:(id)sender
{
    if (object!=nil) {
        NSLog(@"Moving Object is %@:",object!=nil);
     }
}
On Log I get:
object is <ObjectATC: 0x13763850> 
```

为什么在 CCNode 中不触发 ccTouchBegan/moved/ended 方法？

如何处理多个 CCNodes、CCLayers 上的触摸？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T15:02:37.373

我猜你没有收到触摸方法，因为你没有注册`touchDipatcher`

在您的`CCNodes`init 方法或`onEnter`方法中尝试注册它。

```
//register touches
- (void)onEnter {
    [[[CCDirector sharedDirector] touchDispatcher] addTargetedDelegate:self priority:0 swallowsTouches:YES];
    [super onEnter];
}

- (void)onExit {
    [[[CCDirector sharedDirector] touchDispatcher]removeDelegate:self];
    [super onExit];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:30:58.920

在您的触摸方法中，您有一个条件说`if (object != nil)`，但在您显示的代码中的任何地方都没有定义对象。是在别处定义的吗？否则，这就是它不发射的原因。

# c# - 如何从字符串中的某些模式单词中修剪字符？

> ID：14630229
> 
> 赞同：1
> 
> 时间：2013-01-31T16:15:21.620
> 
> 标签：c#, regex

给定以下字符串：

```
string s = "I need drop the 1 from the end of AAAAAAAA1 and BBBBBBBB1" 
```

如何从任何以 1 结尾的 8 个字符串中修剪“1”？我到目前为止找到了一个可以找到这些字符串的有效正则表达式模式，我猜我可以使用 TrimEnd 删除“1”，但是我该如何修改字符串本身呢？

```
Regex regex = new Regex("\\w{8}1");

foreach (Match match in regex.Matches(s))
{
    MessageBox.Show(match.Value.TrimEnd('1'));
} 
```

我正在寻找的结果是“我需要从 AAAAAAAA 和 BBBBBBBB 末尾删除 1”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T16:18:45.133

`Regex.Replace`是工作的工具：

```
var regex = new Regex("\\b(\\w{8})1\\b");
regex.replace(s, "$1"); 
```

我稍微修改了正则表达式，以更紧密地匹配您尝试做的事情的描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:22:17.013

这是一种非正则表达式方法：

```
s = string.Join(" ", s.Split().Select(w => w.Length == 9 && w.EndsWith("1") ? w.Substring(0, 8) : w)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:34:54.400

在带有 LINQ 的 VB 中：

```
Dim l = 8
Dim s = "I need drop the 1 from the end of AAAAAAAA1 and BBBBBBBB1"
Dim d = s.Split(" ").Aggregate(Function(p1, p2) p1 & " " & If(p2.Length = l + 1 And p2.EndsWith("1"), p2.Substring(0, p2.Length - 1), p2)) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-31T16:30:44.637

试试这个：

```
s = s.Replace(match.Value, match.Value.TrimEnd('1')); 
```

并且 s 字符串将具有您想要的值。

# sql - Null<> Number 不显示任何内容，即使对于 id 我们在一个中有 null 并且在另一个中有 number

> ID：14630230
> 
> 赞同：0
> 
> 时间：2013-01-31T16:15:23.100
> 
> 标签：sql

对不起，如果这是非常基本的。这是我注意到的以下是表格：

```
Table1                         Table2
ID     Value                 ID   Value
1      (null)                 1     0
2      2                      2     2
3      (null)                 3     3 
```

所以我使用了以下语句：

```
Select T1.ID,T1.Value,T2.value
from
Table1 T1,
Table2 T2
where 
T1.ID=T2.ID
and T1.Value<>T2.Value; 
```

我期待输出显示 1,3 ID 但它什么也没显示我很困惑假设我想在一个表对其他表值具有空值时查看所有值我该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:18:53.567

好吧，问题是与 NULL 的比较总是导致 FALSE，除了`IS NULL`. 所以该子句应该是：

```
where T1.ID=T2.ID and
      coalesce(T1.Value, t2.value - 1) <> coalesce(T2.Value, t1.value -1); 
```

或者与 NULL 值匹配的东西。

顺便说一句，您还应该使用正确的连接语法。因此，查询应该更像：

```
Select T1.ID,T1.Value,T2.value
from Table1 T1 join
     Table2 T2
     on T1.ID=T2.ID and
        ((T1.Value <> T2.Value) or
         (t1.value is not null and t2.value is null) or
         (t1.value is null and t2.value is not null)
        ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:17:12.823

你必须使用`LEFT JOIN`而不是`INNER JOIN`因为你想找到不匹配的值。

```
Select  t1.ID,T1.Value,T2.value
from    Table1 T1
        LEFT JOIN Table2 T2
            ON T1.ID=T2.ID AND
                t1.value = t2.value
where  t2.value IS NULL 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/a9a28/1)

要全面了解联接，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T16:20:14.840

```
Select T1.ID,T1.Value,T2.value
from
Table1 T1,
Table2 T2
where 
T1.ID=T2.ID
and (T1.Value<>T2.Value OR (T1.Value IS NULL AND T2.Value IS NOT NULL) OR (T2.Value IS NULL AND T1.Value IS NOT NULL)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T16:23:05.897

Null 值是特殊的。你可以用一个复杂的查询来做到这一点，比如

```
Select T1.ID,T1.Value,T2.value
  from
  Table1 T1,
  Table2 T2
  where 
  T1.ID=T2.ID
  and ((t1.value is null or t2.value is null)
       and !(t1.value is null and t2.value is null)
       or t1.value <> t2.value); 
```

[链接到 SQLFiddle](http://www.sqlfiddle.com/#!2/20fc33/1)

请注意，语法会有所不同，具体取决于您使用的 SQL 风格。

# c++ - 使用 boost 的多线程：编译器错误

> ID：14630231
> 
> 赞同：-1
> 
> 时间：2013-01-31T16:15:24.837
> 
> 标签：c++, multithreading, boost, g++

我正在尝试封装一个线程，如下所示：http: [//antonym.org/2009/05/threading-with-boost---part-i-creating-threads.html](http://antonym.org/2009/05/threading-with-boost---part-i-creating-threads.html)

但不知何故，我什至无法编译我的程序.. 这个：

```
/**
 *
 */
void AcceptConnectionThread::start(int param)
{
  m_thread = boost::thread(&AcceptConnectionThread::AcceptConnectionThreadRun, this, 0);
}

/**
 *
 */
int AcceptConnectionThread::AcceptConnectionThreadRun()
{
  return 0;
} 
```

只是给我这个：

```
Description Resource    Path    Location    Type   required from `boost::_bi::bind_t<R, F, L>::result_type boost::_bi::bind_t<R, F, L>::operator()() [with R = void; F = int (*)(); L = boost::_bi::list2<boost::_bi::value<AcceptConnectionThread*>, boost::_bi::value<int> >; boost::_bi::bind_t<R, F, L>::result_type = void]’   ServerNetwork       line 20, external location: /usr/include/boost/bind/bind_template.hpp   C/C++ Problem
Description Resource    Path    Location    Type   required from ‘void boost::detail::thread_data<F>::run() [with F = boost::_bi::bind_t<void, int (*)(), boost::_bi::list2<boost::_bi::value<AcceptConnectionThread*>, boost::_bi::value<int> > >]’    ServerNetwork       line 62, external location: /usr/include/boost/thread/detail/thread.hpp C/C++ Problem
Description Resource    Path    Location    Type too many arguments to function ServerNetwork       line 313, external location: /usr/include/boost/bind/bind.hpp   C/C++ Problem 
```

这是使用的模板构造函数：

```
template <class F,class A1,class A2>
thread(F f,A1 a1,A2 a2):
    thread_info(make_thread_info(boost::bind(boost::type<void>(),f,a1,a2)))
{
    start_thread();
} 
```

我真的不知道问题是什么..

编辑：

无论如何，它适用于此..但是这样我不能传递任何参数..

```
/**
 *
 */
void AcceptConnectionThread::start(int param)
{
  m_thread = boost::thread(&AcceptConnectionThread::AcceptConnectionThreadRun);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T08:47:20.700

使用[boost::bind](http://www.boost.org/doc/libs/1_64_0/libs/bind/doc/html/bind.html)

```
 /**
     *
     */
    void AcceptConnectionThread::start(int param)
    {
      int para_to_pass = 0;
      m_thread = boost::thread( boost::bind(&AcceptConnectionThread::AcceptConnectionThreadRun, this, para_to_pass));
    }

    /**
     *
     */
    int AcceptConnectionThread::AcceptConnectionThreadRun(int para)
    {
      // use para
      return 0;
    } 
```

# powershell - 检查时间并根据小时执行不同的指令

> ID：14630237
> 
> 赞同：2
> 
> 时间：2013-01-31T16:16:00.093
> 
> 标签：powershell, if-statement, scripting, batch-file

我在 Windows Server 2003 服务器上使用 Robocopy 命令将一系列 EDB 文件从用户工作站复制到特殊文件夹到服务器上。我想运行两次 robocopy 命令，一次在上午，一次在下午。

我知道如何做到这一点的方法是编写两个独立的批处理文件，这些文件计划在不同的时间运行。每个批次都会将 EDB 复制到不同的目录。

但我突然想到我应该能够通过以下方式在一个批处理文件中执行此操作：

1.  检查当前时间。
2.  请注意是在下午 1200 点之前还是在下午 1200 点之后。
3.  如果是在下午 1200 点之前，请运行这组 Robocopy 命令。
4.  如果是在下午 1200 点之后，请运行另一组 Robocopy 命令。

我将使用两个批处理文件以我知道的方式来实现它。我想学习如何以其他方式做到这一点。我愿意以任何方式这样做——Powershell、Python 等。诚然，我对在这个生产服务器上安装我通常不需要安装的任何东西持怀疑态度。例如，我*可以*安装 Python，但它只适用于这项工作，这似乎有点矫枉过正。（随意禁止我！）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T16:29:52.857

可能有几种方法可以满足您的要求。第一部分，根据一天中的时间运行不同的代码非常简单。只需使用这个：

```
if ( (Get-Date -UFormat %p) -eq "AM" ) {
    <Code if doing before noon> 
    } #End if
else {
    <code if doing after noon>
    } #end else 
```

您可以`robocopy`在 Powershell 中运行命令而无需任何花哨的技巧。[这是一个关于 robocopy 的问题的链接。](https://serverfault.com/a/129131/127432)
至于调度任务，[此链接](http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/43e19576-476d-4735-85ef-c508c18f11e8/) 将向您展示如何使用任务调度程序调度 powershell 脚本。
要获得其他任何东西，您将不得不进行一些试验和错误，然后带着失败或障碍回来以获得更多帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T18:58:41.703

另一种可能：

```
Switch ((get-date).tostring('tt')) 
 {
   'AM' {'Morning script'}
   'PM' {'Afternoon script'}
 } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T16:26:28.283

你可以使用这样的东西

```
set t=%time:0,2%
if %t% lss 12 (
REM First set of robocopy commands here
) else (
REM Second set of robocopy commands here
) 
```

# c# - 如何在javascript中解压缩字符串，在C#中压缩？

> ID：14630238
> 
> 赞同：2
> 
> 时间：2013-01-31T16:16:00.510
> 
> 标签：c#, javascript, image, compression

> **可能重复：**
> [ZLIB 解压 - 客户端](https://stackoverflow.com/questions/4507316/zlib-decompression-client-side)

我会尽量说清楚，我很抱歉我的英语不好。这就是问题所在：在我的 Web 应用程序中，我收到了一个字符串，该字符串表示使用此算法压缩的图像，用 C# 编写：

```
public static class Compression
{
    public static string Compress(string text)
    {
        byte[] buffer = Encoding.UTF8.GetBytes(text);
        MemoryStream ms = new MemoryStream();
        using (GZipStream zip = new GZipStream(ms, CompressionMode.Compress, true))
        {
            zip.Write(buffer, 0, buffer.Length);
        }

        ms.Position = 0;
        MemoryStream outStream = new MemoryStream();

        byte[] compressed = new byte[ms.Length];
        ms.Read(compressed, 0, compressed.Length);

        byte[] gzBuffer = new byte[compressed.Length + 4];
        System.Buffer.BlockCopy(compressed, 0, gzBuffer, 4, compressed.Length);
        System.Buffer.BlockCopy(BitConverter.GetBytes(buffer.Length), 0, gzBuffer, 0, 4);
        return Convert.ToBase64String(gzBuffer);
    }

    public static string Decompress(string compressedText)
    {

        byte[] gzBuffer = Convert.FromBase64String(compressedText);
        using (MemoryStream ms = new MemoryStream())
        {
            int msgLength = BitConverter.ToInt32(gzBuffer, 0);
            ms.Write(gzBuffer, 4, gzBuffer.Length - 4);

            byte[] buffer = new byte[msgLength];

            ms.Position = 0;
            using (GZipStream zip = new GZipStream(ms, CompressionMode.Decompress))
            {
                zip.Read(buffer, 0, buffer.Length);
            }

            return Encoding.UTF8.GetString(buffer);
        }
    }
} 
```

Decompress 方法用于服务器端应用程序。我收到一个 xml 文件，其中包含表示使用**Compress**方法压缩的图像的字符串，并且我希望能够在我的 Web 应用程序中解压缩我在 javascript 中收到的字符串。有没有办法做到这一点？还有其他解决方案吗？谢谢大家！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:29:11.967

最好的解决方案可能是将解压函数从 C# 转换为 Javascript。您可以使用 Javascript 中已经可用的一个，例如[this one](https://stackoverflow.com/questions/294297/javascript-implementation-of-gzip)，但是您需要更改图像的来源或在服务器上解压缩重新压缩，除非它恰好与您正在使用的压缩兼容。

另一种选择是在使用之前将图像转换为 .jpg 或 .png，再次在服务器上。从长远来看，这将为您提供更大的灵活性，但可能会根据流量和图像大小在服务器上增加负载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:29:19.073

您可以使用[JSXCompressor](http://jsxgraph.uni-bayreuth.de/wp/2009/09/29/jsxcompressor-zlib-compressed-javascript-code/)库进行解压缩（放气、解压缩）。

但是，如果您的网络服务器支持 http 级别的压缩，我认为您可以跳过压缩和解压缩。

# c# - 注入对 Session_End 事件的依赖

> ID：14630247
> 
> 赞同：0
> 
> 时间：2013-01-31T16:16:22.737
> 
> 标签：c#, asp.net, dependency-injection, global-asax

我试图注入对 Session_End 事件的依赖，`Global.asax.cs`但是当它被触发时，它会抛出 NullReferenceException，这是我的代码：

```
//This works
void Session_Start(object sender, EventArgs e)
{
   var accessLogger = DependencyResolver.Current.GetService<IAccessLogger>();
}
//This does NOT work
void Session_End(object sender, EventArgs e)
{
   var accessLogger = DependencyResolver.Current.GetService<IAccessLogger>();
} 
```

# android - 什么正则表达式可用于从 logcat 中过滤掉 dalvikvm 和 dalvikvm-heap 消息

> ID：14630253
> 
> 赞同：22
> 
> 时间：2013-01-31T16:16:43.477
> 
> 标签：android, regex, eclipse, logcat

使用[此链接](http://jmlinnik.blogspot.ca/2011/11/android-logcat-filter-in-eclipse.html)，我能够使用正则表达式创建一个过滤器`(?!dalvikvm\b)\b\w+`来过滤带有标签的消息`dalvikvm`，但是我已经尝试了正则表达式的几种变体，例如`(?!dalvikvm-heap\b)\b\w+`, `(?!dalvikvm\\-heap\b)\b\w+`,`(?!dalvikvm[-]heap\b)\b\w+`和许多其他的，我似乎无法摆脱这些`dalvikvm-heap`消息. 理想情况下，我想过滤它们，但我还没有弄清楚那部分。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-02-13T10:35:45.060

改为在标签字段中使用`^(?!dalvikvm)`。这将只显示标签不以“dalvikvm”开头的消息。

以下是有关其工作原理的说明；如果您不感兴趣，可以跳过它们。首先，您必须记住这个问题，“这个字符串是否与正则表达式匹配？” 真正的意思是，“这个字符串中是否有正则表达式匹配的位置？”

否定断言的棘手之`(?!x)`处在于它们匹配字符串的下一部分不匹配`x`的任何地方：但字符串“dalvikvm”中的每个位置都是如此，除了开头。您链接到的博客文章`\b`在末尾添加了 a ，以便表达式仅在不只是在“dalvikvm”之前**并且**是单词边界的位置匹配。但这仍然会匹配，因为字符串的结尾是单词边界，并且后面没有“dalvikvm”。所以博文`\w+`在它后面加了一个，表示在词边界之后必须有更多的词字符。

它确实适用于这种情况，但是制作正则表达式的方式有点奇怪，而且评估起来相对昂贵。正如您所注意到的，您无法将其调整为`(?!dalvikvm-heap\b)\b\w+`. “-”是一个非单词字符，所以紧随其后是单词边界，后面是单词字符，而不是“dalvikvm-heap”，所以正则表达式在该点匹配。

相反，我使用`^`，它只匹配字符串的开头，以及否定断言。总体而言，正则表达式仅在字符串的开头匹配，并且只有在字符串的开头没有跟随“dalvikvm”时才匹配。这意味着它不会匹配“dalvikvm”或“dalvikvm-heap”。评估也更便宜，因为正则表达式引擎知道它只能在开始时匹配。

以这种方式制作正则表达式，您可以通过将它们放在一起来过滤掉多个标签。例如，`^(?!dalvikvm)(?!IInputConnectionWrapper)`将过滤掉以“dalvikvm”或“IInputConnectionWrapper”开头的标签，因为字符串的开头必须不跟第一个，也不能跟第二个。

BTW, thanks for your link. I didn't realise that you could use the logcat filters that way, so I wouldn't have come up with my answer without it.

# android - Servlet 3.0 从 android 读取 gzip 作为 multipart

> ID：14630255
> 
> 赞同：2
> 
> 时间：2013-01-31T16:16:45.210
> 
> 标签：android, gzip, multipart, servlet-3.0

如果数据是作为 gzip 发送的，如何将发送到服务器的数据直接读取为部分？这是将文件上传到服务器的基本android代码

```
private void sendViaUrlConnection(String urlPost,
        ArrayList<BasicNameValuePair> pairList, File[] sentfileList) {
    HttpURLConnection connection = null;
    GZIPOutputStream gz = null;
    DataOutputStream outputStream = null;
    OutputStream serverOutputStream = null;
    try {
        URL url = new URL(urlPost);
        connection = (HttpURLConnection) url.openConnection();
        connection.setDoInput(true);
        connection.setDoOutput(true);
        connection.setUseCaches(false);
        connection.setRequestMethod("POST");
        connection.setRequestProperty("Connection", "Keep-Alive");
        connection.setRequestProperty("User-Agent",
            "Android Multipart HTTP Client 1.0");
        connection.setRequestProperty("Content-Type",
            "multipart/form-data; boundary=" + boundary);
        connection.setRequestProperty("accept-encoding", "gzip,deflate");
        connection.setRequestProperty("accept","text/html,application/xhtml"
                    + "+xml,application/xml;q=0.9,*/*;q=0.8");
        if (isServerGzip) {
            connection.setRequestProperty("Content-Encoding", "gzip");
            gz = new GZIPOutputStream(connection.getOutputStream());
            serverOutputStream = gz;
        } else {
            outputStream = new DataOutputStream(
                    connection.getOutputStream());
            serverOutputStream = outputStream;
        }
        getMultiPartData(pairList, sentfileList, serverOutputStream,
            boundary);
        serverResponseCode = connection.getResponseCode();
    } finally {}
} 
```

如果 isServerGzip 为 false，则 servlet 可以正常获取数据，但如果我尝试发送 GZIPOutputStream，则 servlet 中的 getParts() 函数会返回一个空列表。这是servlet的代码：

```
@WebServlet("/AddInfo.jsp")
@MultipartConfig()
public class AddInfo extends HttpServlet {

    private static final long serialVersionUID = 1L;

    protected void doPost(HttpServletRequest request,
            HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html");
        Collection<Part> parts = request.getParts();
        for (Part part : parts) {
            // Do something with each part
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T18:54:40.673

我怀疑（在我看到你之前无法确定`getMultiPartData()`）你正在传递给`GZIPOutputStream`多部分标题 - 比如：

```
writer.append("--" + boundary).append(CRLF);
writer.append(
        "Content-Disposition: form-data; name=\"binaryFile\"; filename=\""
            + file.getName() + "\"").append(CRLF);
writer.append(
        "Content-Type: "
            + ((isServerGzip) ? "application/gzip" : URLConnection
                    .guessContentTypeFromName(file.getName())))
            .append(CRLF); 
```

看[这里](https://stackoverflow.com/a/2793153/281545)

有关设法发送数据的类，请参见我的问题[。](https://stackoverflow.com/questions/18857271/file-corrupted-when-i-post-it-to-the-servlet-using-gzipoutputstream#18857271)请注意，我将连接的输出流包装在 GZIPOutputStream 中，但我没有在 GZIPOutputStream 中写入多部分标头。

# vb.net - Asp.Net MVC 4 ModelState.IsValid 返回 False

> ID：14630257
> 
> 赞同：0
> 
> 时间：2013-01-31T16:17:02.190
> 
> 标签：vb.net, razor, asp.net-mvc-4

我正在开发一个 Asp.Net MVC 4 应用程序，我有这两个模型类：

公司型号：

```
Public Class CompanyModel

    <Key()>
    Public Overridable Property CompanyID As Integer

    <Required(ErrorMessage:="Enter a company name.")>
    <Display(Name:="Company")>
    <StringLength(80, ErrorMessage:="The {0} must have {2} characters.", MinimumLength:=2)>
    Public Overridable Property Name As String

    <Required(AllowEmptyStrings:=False, ErrorMessage:="Enter the DB ID.")>
    <Display(Name:="DB ID")>
    Public Overridable Property DBID As Integer

End Class 
```

人物模型：

```
Public Class PersonModel

    <Key()>
    Public Overridable Property PersonID As Integer

    <Required(AllowEmptyStrings:=False, ErrorMessage:="Enter the name.")>
    <Display(Name:="Name")>
    Public Overridable Property Name As String

    <Required(AllowEmptyStrings:=False, ErrorMessage:="Enter the pass")>
    <DataType(DataType.Password)>
    <Display(Name:="Password")>
    Public Overridable Property Password As String

    <Required(AllowEmptyStrings:=False, ErrorMessage:="Enter the mail")>
    <Display(Name:="E-mail")>
    Public Overridable Property Email As String

    <Required(ErrorMessage:="Enter the company")>
    <Display(Name:="Company")>
    Public Overridable Property BcoID As CompanyModel

End Class 
```

个人控制器：

```
'
' POST: /Person/Create

<HttpPost()> _
Function Create(ByVal model As PersonModel) As ActionResult
    Try
        If ModelState.IsValid Then
            personDAO.Save(model)
        End If

        Return RedirectToAction("Index")
    Catch
        Return View()
    End Try
End Function 
```

我在 Views/Person/Create 中有这段代码：

```
<div class="editor-label">
    @Html.LabelFor(Function(model) model.BcoID)
</div>
<div class="editor-field">
    @Html.DropDownListFor(Function(model) model.BcoID.CompanyID, New SelectList(ViewBag.Company, "CompanyID", "Name"))
    @Html.ValidationMessageFor(Function(model) model.BcoID)
</div> 
```

当我创建新人员时，在 PersonController 上尝试保存时，我得到 ModelState.Isvalid = False，消息是“输入公司名称”。我不知道为什么会这样。

任何人都可以帮助我吗？

**编辑**

如果我将我的属性从 model.BcoID.CompanyID 更改为 model.BcoID.Name 并且我使用 EditorFor，而不是使用 DropDownListFor。ModelState.IsValid 是 True，但我需要一个 DropDownList，所以我放了一个 DropDownList，现在我的视图中有一个验证消息（“公司必须有 2 个字符。”）。

这是我现在拥有的：

```
<div class="editor-label">
    @Html.LabelFor(Function(model) model.BcoID.Name)
</div>
<div class="editor-field">
    @Html.DropDownListFor(Function(model) model.BcoID.Name, New SelectList(ViewBag.Company, "CompanyID", "Name"))
    @Html.ValidationMessageFor(Function(model) model.BcoID.Name)
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:22:58.407

确保您的视图中有一个公司名称属性，因为您的模型中需要此属性：

```
<div class="editor-label">
    @Html.LabelFor(Function(model) model.BcoID.Name)
</div>
<div class="editor-field">
    @Html.EditorFor(Function(model) model.BcoID.Name)
    @Html.ValidationMessageFor(Function(model) model.BcoID.Name)
</div> 
```

此外，Label 和 ValidationMessage 助手附加到您的 CompanyID 属性的错误属性。它应该是这样的：

```
<div class="editor-label">
    @Html.LabelFor(Function(model) model.BcoID.CompanyID)
</div>
<div class="editor-field">
    @Html.DropDownListFor(Function(model) model.BcoID.CompanyID, New SelectList(ViewBag.Company, "CompanyID", "Name"))
    @Html.ValidationMessageFor(Function(model) model.BcoID.CompanyID)
</div> 
```

请注意 Label 和 ValidationMessage 现在如何正确关联到 DropDownList。

# jquery - 将宽度应用于 DIV（分页）

> ID：14630260
> 
> 赞同：1
> 
> 时间：2013-01-31T16:17:11.347
> 
> 标签：jquery, css, width, center

我目前有一个无法在 ul/li 中完成的分页模块。它只是一个周围的 div，里面有一堆锚。

```
<div class="pagination">
    <a href="#">1</a>
    <a href="#">2</a>
    <a href="#">3</a>
    <a href="#">4</a>
</div> 
```

每个都有填充来制作宽度/高度，因为数字可以从一位数变为三位数（1-1##）。我需要将分页居中，但没有宽度我做不到。宽度总是根据分页中的数字而变化。如何将所有的宽度应用于包含 w/ 类“分页”？

```
var pagWidth = $('.pagination').width();
$('.pagination').css('width',pagWidth); 
```

我知道这是不正确的，因为它将应用的宽度将计算 div 所在宽度的 100%。请协助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:21:18.673

你可以用css做到这一点。要居中`div`使用以下内容：

```
.pagination
{
   margin:0px auto;
} 
```

或者在javascript中使用它的等价物。

计算所有孩子的宽度。

```
var totalWidth = 0;

$("div.pagination").children().each(function() {
   totalWidth = totalWidth + $(this).width();
});

$('.pagination').css('width',totalWidth); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:45:13.717

在您的情况下，只需添加 width: 100%; 是否可行？到分页 div （因为宽度总是在变化）？

```
.pagination {
   margin:0px auto;
   width: 100%;
} 
```

# matlab - for循环中的嵌套if语句

> ID：14630262
> 
> 赞同：0
> 
> 时间：2013-01-31T16:17:12.370
> 
> 标签：matlab, loops, for-loop

所以这是我的脚本

```
function printPower

sum=0;
filename=input('Enter a filename: ','s');
power=load(filename);
for i=1:length(power);
    if power(i)>=0;    
        sum=sum+power(i);
    end
    TP=sum/24;
 end
 fprintf('Total power: %.1f kWh.\n', TP); 
```

正在加载的文本文件中有负值，我希望它只对正值求和，但它仍然对所有值求和。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:43:49.210

你可以用类似的东西替换你的循环

```
total = sum(power(power>=0))/24 
```

就我个人而言，我认为使用 Matlab 内在函数的名称（例如`sum`，作为变量名）只是自找麻烦，尽管我不确定它是否会在您的情况下引起问题。这就是为什么我的陈述的 lhs 是变量`total`。

# javascript - 使用javascript根据屏幕大小更改按钮的href

> ID：14630272
> 
> 赞同：0
> 
> 时间：2013-01-31T16:17:41.590
> 
> 标签：javascript

我制作了一个基于流体网格的网站，现在我想在 iframe 中添加电影内容。由于 iframe 正在改变大小，因此我将要添加的内容设置为以下 3 种尺寸：

-option1 尺寸：720p：1280 x 720
-option2 尺寸：480p：854 x 480
-option3 尺寸：360p：640 x 360

现在我正在寻找一个脚本来测量用户的屏幕，然后将按钮的 href 更改为选项 1、2 或 3。

这就是我要走多远。我希望有人有一个例子。

```
<a target="iframe_cinema" onclick="myFunction() href="option1" id="window"  class="button2 white">
            <img src="images/3D.png"</div></a>

<script>
function myFunction()
{

var x=window.innerWidth
|| document.documentElement.clientWidth
|| document.body.clientWidth;

if (Width<640)
  {
  x="option1";
  }
else if (Width<854)
  {
  x="option2";
  }
else
  {
  x="option3";
  }

</script> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:20:30.720

另外一个选项。根据大小使用媒体查询和显示/隐藏按钮。

**CSS媒体方式**

```
<!DOCTYPE html>
<html>
  <head>
    <style>

        @media screen {
            #div3{ display : block; }
            #div1, #div2{ display : none; }
        }        

        @media screen and (max-width:800px) {
            #div2{ display : block; }
            #div1, #div3{ display : none; }
        }

        @media screen and (max-width:400px) {
            #div1{ display : block; }
            #div2, #div3{ display : none; }
        }

    </style>
  </head>
  <body>
      <div id="div1">ONE</div>
      <div id="div2">TWO</div>
      <div id="div3">THREE</div>
  </body>
</html> 
```

**你正在做的JavaScript方式：**

```
<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <a href="#option1" id="myLink">LINKY</a>
    <script>    
        (function(){    
            var link = document.getElementById("myLink");    
            function checkWidth() {
                var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,
                    newHref;
                if (width<640) {
                  newHref="#option1";
                } else if (width<854) {
                  newHref="#option2";
                } else {
                  newHref="#option3";
               }
               link.href=newHref;       
            }
            link.onclick = checkWidth;
            checkWidth();
        })();          
    </script> 
  </body>
</html> 
```

# mysql - SQL：不寻常的名称

> ID：14630274
> 
> 赞同：0
> 
> 时间：2013-01-31T16:17:53.870
> 
> 标签：mysql, sql

我正在尝试`online-players`使用 Left join in选择名称在表中的一些信息，`SQL`但是每次我运行代码时它只会返回以下错误。

```
"Unknown column 'ontime' in 'field list'" 
```

我假设它是因为`-`在表的名称中会出现错误。

有没有办法绕过它，所以它仍然可以获得信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:19:45.077

这不是真的，只有当相应的字段名称不存在时才会生成该错误。但是，您可以用反引号将字段和表名括起来以确保

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:20:17.823

需要反引号，仅此而已。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-31T16:20:07.627

您可以使用反引号 (`) 来引用表格。

```
select * from `online-players` 
```

前提是您的查询等中没有错字。

# objective-c - iPhone Sqlite，从数据库中获取数据时获取重复项

> ID：14630275
> 
> 赞同：1
> 
> 时间：2013-01-31T16:17:58.467
> 
> 标签：objective-c, sqlite

我正在将`sqlite`数据库用于我的一个项目。我正在使用以下查询，但是当我执行查询时，我得到了重复。

```
SELECT * FROM 
lcs_mobile_class_folder_content,    lcs_mobile_assignment,       lcs_mobile_quiz 
WHERE
 ( lcs_mobile_class_folder_content.folder_id = '70c12fcd-d0cb-4243-95ad-1979f90c8ba7' 
AND 
(lcs_mobile_class_folder_content.class_content_id =  ( lcs_mobile_quiz.quiz_id))) 
```

谁能告诉我为什么我得到重复项，即使`quiz_id`是`lcs_mobile_quiz`表的主键？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:33:05.050

当有多个`lcs_mobile_class_folder_content`记录匹配一条`lcs_mobile_quiz`记录时，您将获得多条结果记录。

此外，表上没有过滤器或连接`lcs_mobile_assignment`，因此所有其他结果最终将针对*每条* `lcs_mobile_assignment`记录重复。

# php - Symfony2 Docrtine - 每个实体都必须有一个标识符/主键 - 它确实有一个主键吗？

> ID：14630276
> 
> 赞同：1
> 
> 时间：2013-01-31T16:18:06.223
> 
> 标签：php, symfony, doctrine

SF2 和 Doctrine 有一个奇怪的问题。当尝试从 app.php 运行我的应用程序时，我得到了这个：

```
[2013-01-31 15:40:05] request.CRITICAL: Doctrine\ORM\Mapping\MappingException: No identifier/primary key specified for Entity 'ACME\MyBundle\Entity\MyEntity'. Every Entity must have an identifier/primary key. (uncaught exception) at /lib/Doctrine/ORM/Mapping/MappingException.php line 37 [] [] 
```

这似乎是不言自明的。但据我所见，我的实体上有一个主键：

我的实体：

```
/**
* @ORM\Entity
* @ORM\Table(name="milestone")
*/
class MyEntity
{

   /**
    * @ORM\Id
    * @ORM\Column(type="integer")
    * @ORM\GeneratedValue(strategy="AUTO")
    */
    protected $id;

   /**
    * @ORM\Column(type="string")
    * @Assert\NotBlank()
    * @Assert\MinLength(2)
    * @Assert\MaxLength(100)
    */
    protected $title;

   /**
    * @ORM\Column(type="datetime")
    * @Assert\NotBlank()
    */
    protected $date;
   //////ETC 
```

然后在 PHPMyAdmin 中：

```
 Action          Keyname Type    Unique  Packed  Column  Cardinality Collation   Null    Comment
 Edit    Drop   PRIMARY BTREE   Yes No  id  63  A 
```

我有主键。非为 NULL。

使用 app_dev.php 运行应用程序运行良好，我假设错误被抑制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T01:12:06.990

try using this. It is working for me

```
/**
     * @var integer $id
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-15T07:52:58.500

我建议将该字段设置为不可为空。

```
/**
 * @var integer
 *
 * @ORM\Column(name="id", type="integer", nullable=false)
 * @ORM\Id
 * @ORM\GeneratedValue(strategy="AUTO")
 */
 protected $id; 
```

在任何情况下，既然你有表，你总是可以使用学说的 cli 生成你的实体映射，这非常方便。

```
php [path-to-doctrine]/doctrine orm:convert-mapping --filter="TableNameInCamelCase"  --namespace="[your-entity-namespace]" --force --from-database annotation [destination-path-of-entities] 
```

甚至还有一个用于生成 getter 和 setter。

# arrays - 类名数组 AS3

> ID：14630281
> 
> 赞同：1
> 
> 时间：2013-01-31T16:18:15.597
> 
> 标签：arrays, actionscript-3, class, actionscript, class-names

我的 FLA 库中有几个应用了类名的影片剪辑。在我的 AS 包文件中，我有一个这些类名的数组。我想做的是在舞台上显示movieclips，如下所示：

*   加载 SWF 时，显示 Array[0]
*   单击 NEXT 按钮时，将 1 添加到数组中，然后显示
*   单击 PREV 按钮时，从数组中减去 1，然后显示

总n00b问题，我敢肯定。我了解基础知识，但调用类名让我感到困惑。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T14:12:44.007

如果您有一个类名数组，则首先必须检索类定义，然后才能动态实例化它。您可以为此使用[getDefinitionByName()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/package.html#getDefinitionByName%28%29)方法。

```
var clazz:Class = getDefinitionByName(myClassName) as Class;
var instance:MovieClip = new clazz(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T17:03:16.707

如果你有一个类数组，你可以像这样实例化一个类：

```
var classArray:Array = [ Class1, Class2, Class3 ];
// instantiate the first class in the array at index 0
var instance:MovieClip = new classArray[0](); 
```

# php - 匹配来自关联数组的函数参数和 PHP 中的函数调用

> ID：14630282
> 
> 赞同：0
> 
> 时间：2013-01-31T16:18:19.983
> 
> 标签：php, function, reflection

我有一个以下形式的关联数组：

```
$params = array(
    'paramName_4'=>'param_4', 
    'paramName_2'=>'param_2',
    // ...,
    'paramName_6'=>'param_6',
); 
```

我还有一个函数`myFunction`定义为：

```
public function myFunction($paramName_1, $paramName_2, $paramName_3, ....); 
```

PHP中是否存在“解析”函数，以便我可以`myFunction`通过匹配参数来调用函数（即使它们没有按`myFunction`参数顺序排序）？换句话说，我能做

```
my_magic(__NAMESPACE__.'\\myFunction', $params); 
```

这个“神奇”功能真的存在吗？如果没有，我该如何实施？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T16:24:56.353

您可以使用[反射](http://php.net/manual/en/intro.reflection.php)来实现它。就是这样：

```
// The input is the array of arguments and the function name
$arguments = array(....);
$functionName = __NAMESPACE__.'\\myFunction';

$reflector = new \ReflectionFunction($functioName);
$params = $reflector->getParameters();
$values = array();

foreach ($params as $param) {
    $name = $param->getName();
    $isArgumentGiven = array_key_exists($name, $arguments);
    if (!$isArgumentGiven && !$param->isDefaultValueAvailable() {
        die ("Parameter $name is mandatory but was not provided");
    }

    $values[$param->getPosition()] =
        $isArgumentGiven ? $arguments[$name] : $param->getDefaultValue();
}

// You can now call the function:
call_user_func($functionName, $values); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:27:42.473

是的，您可以按照@Jon 的示例使用反射，但如果问题只是参数的顺序不正确，为什么不直接使用`ksort()`或`uksort()`按正确的顺序排列它们。

然后你可以使用`call_user_func_array()`. 问题解决了。

```
$params = array(....);

uksort($params, function($a,$b) {
    //sort the params into the known order....
    $sortOrder = array('param1','param2','param3','param4');
    return (array_search($a, $sortOrder) > array_search($b, $sortOrder)) ? -1 : 1;
});

//now that $params is in the right order we can do this....
$retVal = call_user_func_array($func, $params); 
```

我在这里硬编码了参数顺序，因为这是最有效的方式。如果您正在调用一个事先不知道正确参数顺序的函数，那么是的，您需要使用反射。但我认为这不太可能（将未知参数列表传递给未知函数听起来像是黑客的金矿）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-28T00:36:09.513

这是一个为给定函数/方法解析参数的库：[ArgumentsResolver](https://github.com/rybakit/arguments-resolver)。

# python - UnicodeEncodeError：“charmap”编解码器无法编码 - 字符映射到 , 打印功能

> ID：14630288
> 
> 赞同：177
> 
> 时间：2013-01-31T16:18:30.710
> 
> 标签：python, encoding, decode, encode

我正在编写一个 Python (Python 3.3) 程序来使用 POST 方法将一些数据发送到网页。主要用于调试过程，我正在获取页面结果并使用`print()`函数将其显示在屏幕上。

代码是这样的：

```
conn.request("POST", resource, params, headers)
response = conn.getresponse()
print(response.status, response.reason)
data = response.read()
print(data.decode('utf-8')); 
```

该`HTTPResponse` `.read()`方法返回一个`bytes`对页面进行编码的元素（这是一个格式良好的 UTF-8 文档），直到我停止使用 Windows 的 IDLE GUI 并改用 Windows 控制台之前，它似乎还可以。返回的页面有一个 U+2014 字符（破折号），打印功能在 Windows GUI 中可以很好地翻译（我假设代码页 1252），但在 Windows 控制台中没有（代码页 850）。鉴于`strict`默认行为，我收到以下错误：

```
UnicodeEncodeError: 'charmap' codec can't encode character '\u2014' in position 10248: character maps to <undefined> 
```

我可以使用这个非常丑陋的代码来修复它：

```
print(data.decode('utf-8').encode('cp850','replace').decode('cp850')) 
```

现在它将有问题的字符“-”替换为`?`. 不是理想的情况（连字符应该是更好的替代品）但足以满足我的目的。

我的解决方案中有几件事我不喜欢。

1.  代码在所有的解码、编码和解码中都很丑陋。
2.  它解决了这种情况的问题。如果我为使用其他编码（latin-1、cp437、回到 cp1252 等）的系统移植程序，它应该能够识别目标编码。它不是。（例如，当再次使用 IDLE GUI 时，emdash 也会丢失，这在以前没有发生过）
3.  如果将 emdash 翻译成连字符而不是审讯号，那就更好了。

问题不在于 emdash（我可以想出几种方法来解决这个特别的问题），但我需要编写健壮的代码。我正在向页面提供来自数据库的数据，并且该数据可以返回。我可以预料到许多其他冲突的情况：'Á' U+00c1（可能在我的数据库中）可以转换为 CP-850（用于西欧语言的 DOS/Windows 控制台编码）但不能转换为 CP-437（用于美国的编码）英语，这是许多 Windows 安装中的默认设置）。

所以，问题：

是否有更好的解决方案使我的代码与输出接口编码无关？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2013-04-20T12:13:34.497

我看到了三个解决方案：

1.  更改输出编码，使其始终输出 UTF-8。请参阅[在 Python 中管道 stdout 时设置正确的编码](https://stackoverflow.com/questions/492483/setting-the-correct-encoding-when-piping-stdout-in-python)，但我无法让这些示例正常工作。

2.  以下示例代码使输出了解您的目标字符集。

    ```
    # -*- coding: utf-8 -*-
    import sys

    print sys.stdout.encoding
    print u"Stöcker".encode(sys.stdout.encoding, errors='replace')
    print u"Стоескер".encode(sys.stdout.encoding, errors='replace') 
    ```

    这个例子用问号正确地替换了我名字中的任何不可打印的字符。

    如果您创建自定义打印函数，例如调用`myprint`，使用该机制正确编码输出，您可以简单地将 print 替换为`myprint`必要的地方，而不会使整个代码看起来难看。

3.  在软件开始时全局重置输出编码：

    [http://www.macfreek.nl/memory/Encoding_of_Python_stdout](http://www.macfreek.nl/memory/Encoding_of_Python_stdout)页面很好地总结了如何更改输出编码。尤其是“Stdout 周围的 StreamWriter Wrapper”部分很有趣。本质上，它说要像这样更改 I/O 编码功能：

    在 Python 2 中：

    ```
    if sys.stdout.encoding != 'cp850':
      sys.stdout = codecs.getwriter('cp850')(sys.stdout, 'strict')
    if sys.stderr.encoding != 'cp850':
      sys.stderr = codecs.getwriter('cp850')(sys.stderr, 'strict') 
    ```

    在 Python 3 中：

    ```
    if sys.stdout.encoding != 'cp850':
      sys.stdout = codecs.getwriter('cp850')(sys.stdout.buffer, 'strict')
    if sys.stderr.encoding != 'cp850':
      sys.stderr = codecs.getwriter('cp850')(sys.stderr.buffer, 'strict') 
    ```

    如果在 CGI 输出 HTML 中使用，您可以将 'strict' 替换为 'xmlcharrefreplace' 以获得不可打印字符的 HTML 编码标签。

    随意修改方法，设置不同的编码，....请注意，它仍然无法输出未指定的数据。因此，任何数据、输入、文本都必须能够正确转换为 unicode：

    ```
    # -*- coding: utf-8 -*-
    import sys
    import codecs
    sys.stdout = codecs.getwriter("iso-8859-1")(sys.stdout, 'xmlcharrefreplace')
    print u"Stöcker"                # works
    print "Stöcker".decode("utf-8") # works
    print "Stöcker"                 # fails 
    ```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2015-05-01T14:08:47.427

根据 Dirk Stöcker 的回答，这里是 Python 3 打印函数的简洁包装函数。就像使用 print 一样使用它。

作为额外的奖励，与其他答案相比，由于最后一个解码步骤，这不会将您的文本打印为字节数组（'b“content”'），而是作为普通字符串（'content'）。

```
def uprint(*objects, sep=' ', end='\n', file=sys.stdout):
    enc = file.encoding
    if enc == 'UTF-8':
        print(*objects, sep=sep, end=end, file=file)
    else:
        f = lambda obj: str(obj).encode(enc, errors='backslashreplace').decode(enc)
        print(*map(f, objects), sep=sep, end=end, file=file)

uprint('foo')
uprint(u'Antonín Dvořák')
uprint('foo', 'bar', u'Antonín Dvořák') 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2015-08-24T00:52:02.810

出于调试目的，您可以使用`print(repr(data))`.

要显示文本，请始终打印 Unicode。不要在脚本中硬编码环境的字符编码，例如*Cp850*。要解码 HTTP 响应，请参阅[A good way to get the charset/encoding of an HTTP response in Python](https://stackoverflow.com/q/14592762/4279)。

要将 Unicode 打印到 Windows 控制台，您可以[使用`win-unicode-console`package](https://stackoverflow.com/a/30551552/4279)。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2017-05-09T08:03:28.590

我对此进行了更深入的研究，发现最好的解决方案就在这里。

[http://blog.notdot.net/2010/07/Getting-unicode-right-in-Python](http://blog.notdot.net/2010/07/Getting-unicode-right-in-Python)

就我而言，我解决了“UnicodeEncodeError：'charmap'编解码器无法编码字符”

原始代码：

```
print("Process lines, file_name command_line %s\n"% command_line)) 
```

新代码：

```
print("Process lines, file_name command_line %s\n"% command_line.encode('utf-8')) 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2017-05-26T01:19:47.290

如果您使用 Windows 命令行打印数据，您应该使用

```
chcp 65001 
```

这对我有用！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-01T23:08:17.200

如果您使用 Python 3.6（可能是 3.5 或更高版本），它不会再给我这个错误。我有一个类似的问题，因为我使用的是 v3.4，但是在我卸载并重新安装后它就消失了。

# php - URL 重写导致我的 web.config 文件出现 500 服务器错误

> ID：14630297
> 
> 赞同：2
> 
> 时间：2013-01-31T16:18:48.240
> 
> 标签：php, iis-7, url-rewriting, web-config, rewrite

我已经使用下面的代码来尝试为我的网站搜索结果实现干净的 URL。但是，当我将它实现到我的 web.config 文件中并将其上传到我的站点时，我收到了服务器 500 错误。我做错什么了？

我正在尝试清理一些 URL，请参见下面的链接：

> ```
> mydomain.com/dentists/zipcode/18954/us/
> 
> mydomain.com/dentists/name/18954/us/the-persons-name/
> 
> mydomain.com/dentists/phone/18954/us/3215558888
> 
> mydomain.com/dentists/details/person-company-goes-here/ 
> ```

**这就是我的 web.config 文件中的内容...**

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="Rewrite to store_locator_results.php">
                    <match url="^dentists/zipcode/([0-9]+)/([0-9]+)/([0-9]+)/([_0-9a-z-]+)/([_0-9a-z-]+)/" />
                    <action type="Rewrite" url="store_locator_results.php?lat={R:1}&amp;lng={R:2}&amp;postcode={R:3}&amp;countryIso={R:4}&amp;businessname={R:5}" />
                </rule>
            </rules>
            <rules>
                <rule name="Rewrite to store_locator_results_by_name.php">
                    <match url="^dentists/name/([0-9]+)/([0-9]+)/([0-9]+)/([_0-9a-z-]+)/([_0-9a-z-]+)/([_0-9a-z-]+)/" />
                    <action type="Rewrite" url="store_locator_results_by_name.php?lat={R:1}&amp;lng={R:2}&amp;postcode={R:3}&amp;countryIso={R:4}&amp;lastname={R:5}&amp;businessname={R:6}" />
                </rule>
            </rules>
            <rules>
                <rule name="Rewrite to store_locator_results_by_phone.php">
                    <match url="^dentists/phone/([0-9]+)/([0-9]+)/([0-9]+)/([_0-9a-z-]+)/([_0-9a-z-]+)/" />
                    <action type="Rewrite" url="store_locator_results_by_phone.php?lat={R:1}&amp;lng={R:2}&amp;postcode={R:3}&amp;countryIso={R:4}&amp;phone={R:5}" />
                </rule>
                <rule name="Rewrite to store_locator_results.php">
                    <match url="^dentists/details/([0-9]+)/" />
                    <action type="Rewrite" url="store_info.php?store={R:1}" />
                </rule>
            </rules>
            <outboundRules>
                <rule name="Rewrite to clean URL" preCondition="IsHTML">
                    <action type="Rewrite" value="/dentists/zipcode/{R:3}/{R:4}" />
                    <action type="Rewrite" value="/dentists/name/{R:3}/{R:4}/{R:5}/" />
                    <action type="Rewrite" value="/dentists/phone/{R:3}/{R:4}/{R:5}/" />
                    <action type="Rewrite" value="/dentists/details/{R:1}/" />
                </rule>
                <preConditions>
                    <preCondition name="IsHTML">
                        <add input="{RESPONSE_CONTENT_TYPE}" pattern="^text/html" />
                    </preCondition>
                </preConditions>
            </outboundRules>
        </rewrite>
    </system.webServer>
</configuration> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T19:29:24.827

`web.config`在标签之前`system.webServer`和标签内添加以下行`configuration`。

```
<configSections>
      <sectionGroup name="system.webServer">
           <sectionGroup name="rewrite">
                <section name="rewriteMaps" overrideModeDefault="Allow" />
                <section name="rules" overrideModeDefault="Allow" />
           </sectionGroup>
     </sectionGroup>
</configSections> 
```

这将覆盖`mod_rewrite`IIS 中的规则。

# ssl - SSL 证书颁发机构如何知道您拥有该域？

> ID：14630300
> 
> 赞同：-1
> 
> 时间：2013-01-31T16:18:53.100
> 
> 标签：ssl, certificate, ca

是什么阻止了一个人将签名的 SSL 证书发送到他/她不拥有的域？

即进行哪些检查以确保人们不能简单地为 google.com 购买新证书并继续做坏事......

当然，向 CA 提供（一笔可笑的）钱的全部目的是让人们毫无疑问地相信他们连接的服务器是正确的。不？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:53:56.757

由 CA 确保申请证书的人拥有该域。

一种经常用于廉价 SSL 证书的方法是[whois 查找](http://whois.net/)

但是方法可能因 CA 和证书提供的信任级别而异。

# android - 如何使用触摸板保持旋转不变？

> ID：14630302
> 
> 赞同：1
> 
> 时间：2013-01-31T16:18:52.957
> 
> 标签：android, libgdx

我有一个用触摸板旋转的精灵。我遇到的唯一问题是，当触摸板不移动时，旋转停止。即使触摸板处于 100% Y 值，如果它保持不动，精灵旋转也会停止。无论触摸板是否移动，如何保持旋转不变？我的代码如下

```
 public class RotationTest implements ApplicationListener {
   private OrthographicCamera camera;
   private SpriteBatch batch;
   private Texture texture;
   private Sprite sprite;
   Stage stage;
   public boolean leonAiming = true;

   @Override
   public void create() {      
      float w = Gdx.graphics.getWidth();
      float h = Gdx.graphics.getHeight();

      camera = new OrthographicCamera(1, h/w);
      batch = new SpriteBatch();

      texture = new Texture(Gdx.files.internal("data/libgdx.png"));
      texture.setFilter(TextureFilter.Linear, TextureFilter.Linear);

      TextureRegion region = new TextureRegion(texture, 0, 0, 512, 275);

      sprite = new Sprite(region);
      sprite.setSize(0.9f, 0.9f * sprite.getHeight() / sprite.getWidth());
      sprite.setOrigin(sprite.getWidth()/2, sprite.getHeight()/2);
      sprite.setPosition(-sprite.getWidth()/2, -sprite.getHeight()/2);

      stage = new Stage();
      Gdx.input.setInputProcessor(stage);

      Skin skin = new Skin(Gdx.files.internal("data/uiskin.json"));
         Texture touchpadTexture = new Texture(Gdx.files.internal("data/touchpad.png"));
         touchpadTexture.setFilter(TextureFilter.Linear, TextureFilter.Linear);     
         TextureRegion background = new TextureRegion(touchpadTexture, 0, 0, 75, 75);
         TextureRegion knob = new TextureRegion(touchpadTexture, 80, 0, 120, 120);
         TextureRegionDrawable backgroundDrawable = new TextureRegionDrawable(background);
         TextureRegionDrawable knobDrawable = new TextureRegionDrawable(knob);
         final Touchpad touchpad = new Touchpad(10, new Touchpad.TouchpadStyle(backgroundDrawable, knobDrawable));
         ChangeListener listener = null;
         touchpad.addListener(new ChangeListener() {

         @Override
         public void changed(ChangeEvent event, Actor actor) {
            sprite.rotate(touchpad.getKnobPercentY());
         }
      });

            touchpad.setBounds(15, 15, 225, 225);
         stage.addActor(touchpad);

   }

   @Override
   public void dispose() {
      batch.dispose();
      texture.dispose();
   }

   @Override
   public void render() {      
      Gdx.gl.glClearColor(1, 1, 1, 1);
      Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);

      batch.setProjectionMatrix(camera.combined);
      batch.begin();
      sprite.draw(batch);
      batch.end();
      stage.act();
      stage.draw();
   } 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:34:29.627

您正在[触摸板](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/ui/Touchpad.html)[`ChangeListener`](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/utils/ChangeListener.ChangeEvent.html)上注册 a 。它的方法只有在触摸板上发生变化时才会被调用。`changed`

您应该在`render()`方法中轮询触摸板的状态，而不是更新以响应输入事件（因此，每次绘制帧时，如果触摸板处于活动状态，则更新旋转）。

```
if (touchpad.isTouched()) {
    sprite.rotate(touchpad.getKnobPercentY());
} 
```

您可能希望缩放旋转速率，使其与时间成正比，而不是帧速率。见[`Gdx.graphics.getDeltaTime()`](http://libgdx.l33tlabs.org/docs/api/com/badlogic/gdx/Graphics.html#getDeltaTime%28%29)。

# javascript - jQuery 在第一次切换后仅在 Safari iOS5 中单击 3 次后触发

> ID：14630304
> 
> 赞同：0
> 
> 时间：2013-01-31T16:19:00.680
> 
> 标签：javascript, jquery, ios, mobile

我在 iOS 5 及以下设备上使用 jQuery 和 Safari 时遇到问题...
我有一个用于`onClick`切换菜单的按钮，在 iOS 5 上的 Safari 和菜单下方显示第一个`click`然后关闭第二个.. 太好了..但是，之后需要单击 3 次才能再次显示菜单。这不会发生在 iOS 6 或桌面浏览器上。

我尝试用`toggle()`以下内容替换 jQuery 函数，但这并没有帮助。

```
pull.data('menuState','closed');
$(pull).on('click', function (e) {
if (pull.data('menuState') === 'closed') {
    pull.data('menuState', 'open');
    currentMenu.show();
} else {
    pull.data('menuState', 'closed');
    currentMenu.hide();
}
return false;
}); 
```

`pull`并且`currentMenu`在我的代码中定义得更高。如果有任何帮助，该网站是建立在引导程序上的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:27:42.443

这是我为替换切换功能所做的，它似乎运行良好。只需将您的需求放在奇偶函数中：

```
 // place this before all of your code, outside of document ready.
$.fn.ToggleFix = function(odd, even) {
    return this.each(function() {
        var Toggled = false;
        $(this).on("click", function() {
            if (Toggled) {
                Toggled = false;
                return odd.apply(this, arguments);
            }
            Toggled = true;
            return even.apply(this, arguments);
        });
    });
};
//what do you want each toggle to do
function odd() {
    $(this).animate({"left": "+=50px"}, "slow");//EXAMPLE
}

function even() {
    $(this).animate({"left": "-=50px"}, "slow");//EXAMPLE
}
//call your toggle method like this after creating the function you want above
$(function(){ 
    $("YOUR ELEMENT").ToggleFix(even, odd);
 }); 
```

[**jsFIDDLE**](http://jsfiddle.net/aaaheatair/6xaU6/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T13:44:50.770

事实证明，iOS 5`window.resize`稍后在我的代码中触发了该功能，不是 100% 是最好的方法，但我检测到了围绕它进行编码的版本号。

```
function iOSversion() {
if (/iP(hone|od|ad)/.test(navigator.platform)) {
    var v = (navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);
    return [parseInt(v[1], 10), parseInt(v[2], 10), parseInt(v[3] || 0, 10)];
}
} 
```

# c++ - 是否可以使用 gcc 关闭任何自动并行化？

> ID：14630305
> 
> 赞同：2
> 
> 时间：2013-01-31T16:19:06.417
> 
> 标签：c++, gcc, parallel-processing, openmp

我正在使用 OpenMP 研究并行算法。从 CPU 使用率来看，我写的很多“顺序”代码实际上是并行执行的。

例如：

```
#pragma omp parallel for if (par == "parallel")
for (int64_t u = 1; u <= n; ++u) {
    for (int64_t v = u + 1; v <= n; ++v) {
        ....
    }
} 
```

如果设置了标志，则这是有条件的并行。设置标志后，我看到 16 核机器上的 CPU 使用率为 1500%。在未设置标志的情况下，我仍然看到 250% 的 CPU 使用率。

我想这是由于正在进行一些自动并行化。正确的？海湾合作委员会会这样做吗？

由于我需要比较顺序运行时间和并行运行时间，我希望未使用 ( `#pragma omp parallel...`etc.) 注释的代码仅在一个 CPU 上运行。我可以轻松实现这一目标吗？是否有一个 GCC 标志，我可以通过它切换自动并行化并在我用 OpenMP 显式注释的地方具有并行性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T17:43:24.893

请注意，OpenMP`if`子句对并发性施加*运行时而不是编译时*控制。这意味着虽然在`if`执行程序时子句中的条件可能会评估为 false，这会`parallel`通过将其团队中的线程数设置为 1 来停用该区域，但该区域仍将扩展为多个运行时调用，并为其提供一个单独的函数正文，尽管这不会导致并行执行。OpenMP 运行时还可能保持一个正在运行的 OpenMP 线程池忙于等待任务。

保证您的 OpenMP 代码将编译为明确的串行可执行文件（假设您没有链接到并行库）的唯一方法是在禁用 OpenMP 支持的情况下进行编译。在您的情况下，这意味着`-fopenmp`在编译代码时没有给 GCC 选项。

# wpf - 由 UI 或代码引发的 WPF 事件？

> ID：14630306
> 
> 赞同：0
> 
> 时间：2013-01-31T16:19:07.043
> 
> 标签：wpf, events, raiseevent

如何确定事件是由 UI 还是由代码引发的？我需要识别滑块的值是否由用户从 UI 更改或具有来自执行代码的新值？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T16:45:38.530

我假设您已经`Slider`连接到双向绑定，因此滑块的当前值可以通过用户拖动滑块`Thumb`或通过绑定类的代码更改属性的值来确定滑块是必然的。如果这是真的，那么我认为一种可行的方法是，如果您对 Slider **Thumb 的 `DragCompleted`event**使用处理程序。尽管我没有尝试过，但我相信这会起作用，因为看起来拇指只会被用户“拖动”，而不是您执行的代码会更改滑块绑定到的值（尽管我承认这将导致拇指“移动”，因此这将需要测试来验证）。

[**有关此类似问题**](https://stackoverflow.com/questions/723502/wpf-slider-with-an-event-that-triggers-after-a-user-drags)的更多指导，请参阅 YotaXP 和 Santo 的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T13:57:47.700

由于 Thumb 的 DragCompleted 事件没有解决用户单击滑块的情况，因此我使用了类似于 Peter 在[link](https://stackoverflow.com/questions/723502/wpf-slider-with-an-event-that-triggers-after-a-user-drags)中建议的内容，我使用了滑块的 PreviewMouseLeftButtonUp 事件。这解决了所有情况。

# actionscript-3 - Actionscript - 检测图像中的简单形状

> ID：14630311
> 
> 赞同：0
> 
> 时间：2013-01-31T16:19:22.573
> 
> 标签：actionscript-3, actionscript, webcam, detection

我想知道是否可以使用 ActionScript 3 检测图像中的简单形状，例如圆形或矩形。有人可以引导我走向正确的方向，甚至可以给我一个好的教程链接吗？我想用网络摄像头检测徽标。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T17:56:49.870

是的，我有可能为视频做了一个球检测算法。一旦您访问每一帧的位图（例如一个向量>，其中 uint 是向量[x][y] 中像素的颜色），它只是通用检测算法。休变换等。所以你继续，检测矩形。有很多[教程。](https://www.google.at/search?client=opera&q=rectangle%20detection&sourceid=opera&ie=utf-8&oe=utf-8&channel=suggest)它的数学很高.. 还有[FLARManager](http://words.transmote.com/wp/flarmanager/)，可以检测 Flash 中很酷的二维码。Lee Brimelow 做了一个很棒的[视频教程](http://www.gotoandlearn.com/play.php?id=114)。

# c# - 使用 StreamReader 读取文件夹中的所有文本文件

> ID：14630312
> 
> 赞同：2
> 
> 时间：2013-01-31T16:19:24.933
> 
> 标签：c#

我正在尝试使用流阅读器读取文件夹中的所有*.txt*文件。我现在有这个，它适用于一个文件，但我需要读取文件夹中的所有文件。这就是我到目前为止所拥有的。任何建议将不胜感激。

```
using (var reader = new StreamReader(File.OpenRead(@"C:\ftp\inbox\test.txt"))) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T16:21:22.933

您可以使用[`Directory.EnumerateFiles()`](http://msdn.microsoft.com/en-us/library/dd413233.aspx)方法代替。

> 返回与指定路径中的搜索模式匹配的可枚举文件名集合。

```
var txtFiles = Directory.EnumerateFiles(sourceDirectory, "*.txt");
foreach (string currentFile in txtFiles)
{
   ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:20:53.977

您可以调用`Directory.EnumerateFiles()`以查找文件夹中的所有文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T16:22:26.253

您可以检索目录的文件：

```
string[] filePaths = Directory.GetFiles(@"c:\MyDir\"); 
```

因此，您可以迭代执行任何您想要的每个文件。例如：阅读所有行。

您还可以使用文件掩码作为该`GetFiles`方法的第二个参数。

编辑：

`EnumerateFiles`在这篇文章中，您可以看到和之间的区别`GetFiles`。

[Directory.EnumerateFiles 与 Directory.GetFiles 有什么区别？](https://stackoverflow.com/questions/5669617/directory-enumeratefiles-vs-getfiles)

# javascript - 如何保护 HTML5 应用程序对服务器的 JSON 调用

> ID：14630315
> 
> 赞同：0
> 
> 时间：2013-01-31T16:19:33.813
> 
> 标签：javascript, jquery, ajax, security, authentication

我目前正计划开发一个 HTML5 应用程序。基本概念如下：

用户应该能够使用用户名和密码创建配置文件。服务器应该在 Ruby on Rails 中实现，提供 JSONP Api（用于跨域问题）。

因此，应用程序将向服务器发送 Ajax 请求并从中获取响应。

我现在的想法是在第一次响应时将 session_key（由服务器生成）传输回客户端。然后，客户端必须使用此令牌对自己进行身份验证。

但现在我有一些问题。

*   我如何保护客户的第一次呼叫（当他传输用户和密码时）？
*   我怎样才能保护会话密钥不被窥探？

我在安全方面是一个完整的菜鸟。因此，如果我能得到一些提示，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:25:30.683

使用 SSL 保护您的连接。除了将 's' 放在 'http' 之后之外，这应该不需要更改您的代码；-)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-31T16:26:46.267

我使用将校验和添加到 ajax 参数（使用提交的数据计算），然后将洞 ajax 请求加密为一个字符串。

类似 sRequest=459fdjnfdw4r908vn....

sRequests 保存我的数据 (sUser=user&sPass=pass&iCheck=34564)。

编辑：我的客户端代码未公开，编译为应用程序。

# css - 用于动画加载栏的 css 滑动门技术

> ID：14630317
> 
> 赞同：0
> 
> 时间：2013-01-31T16:19:36.093
> 
> 标签：css

我有一张图片用作加载动画，宽度为 755 像素。

[http://www.salts-studios.com/resources/working_large.gif](http://www.salts-studios.com/resources/working_large.gif)

事情是我在我正在开发的应用程序的一个部分有一个要求，其中图像宽度必须是流动的。

IE 8 是主要支持的浏览器（我知道，我知道），因此在需要时放大图像不是一个选项。

我无法更改图像，但我可以创建一个新的附加图像，只要它的样式与原始图像相同。

任何人都可以推荐任何技术来实现完全流动的宽度吗？

我尝试了各种推拉门技术，但随着图像的动画化，它们会倒下。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:30:31.830

有一个相当简单的解决方案。在父 div 中，将其设置为`width: 100%`，并将子图像也设置为`width: 100%`。这是一个例子：

```
.bar {
  width: 100%;
}

.bar img {
  width: 100%;
  height: 19px;
} 
```

这是一个[有一个工作示例的 JSBin](http://jsbin.com/edakug/1/edit)

将您的浏览器窗口拖动到不同的大小并观察图像宽度调整大小。让我知道这是否是您认为应该发生的事情。

# c# - c# 和日期选择器，如何更改格式？

> ID：14630318
> 
> 赞同：2
> 
> 时间：2013-01-31T16:19:37.297
> 
> 标签：c#, wpf, wpf-controls, datepicker

我的 C# 4.0 (WPF) 应用程序中有一个日期选择器，我想将文本框中可见的日期格式更改为 yyyy/MM/dd。现在我看到了 dd/MM/yyyy 格式。

在我的 datePicker 的 axml 中，我有以下代码：

```
<DatePicker Height="25" HorizontalAlignment="Left" Margin="5,36,0,0" Name="dtpStartDate"
                    SelectedDate="{Binding StartDateSelectedDate}" VerticalAlignment="Top" Width="115">
            <DatePicker.Resources>
                <Style TargetType="{x:Type DatePickerTextBox}">
                    <Setter Property="Control.Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <TextBox x:Name="PART_TextBox" 
                                    Text="{Binding Path=SelectedDate, RelativeSource={RelativeSource AncestorType={x:Type DatePicker}}, StringFormat={}{0:yyyy/MM/dd}}" />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </DatePicker.Resources>
        </DatePicker> 
```

这似乎是第一次一切正常，我可以看到我想要的格式的日期，我可以手动更改日期或使用日历，并且在这两种方式中到达 viewModel 的日期都是正确的。

但是我有一个问题，因为我想检测如果日期为空，在我的视图模型中控制这种情况。但是如果我清除日期选择器，在我的视图模型中会到达最后一个正确的日期，所以我无法检查日期是否为空。

那么如何修改日期选择器中的日期格式并控制日期是否为空/null？

谢谢。戴姆洛克。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T22:58:23.640

您可以尝试以下解决方案。

首先创建以下转换器：

```
public class StringToDateTimeConverter : IValueConverter
{

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value == null)
        {
            return null;
        }
        return ((DateTime)value).ToString(parameter as string, CultureInfo.InvariantCulture);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (string.IsNullOrEmpty(value as string))
        {
            return null;
        }
        try
        {
            DateTime dt = DateTime.ParseExact(value as string, parameter as string, CultureInfo.InvariantCulture);
            return dt as DateTime?;
        }
        catch (Exception)
        {
            return null;
        }
    }
} 
```

然后在 xaml 中，您将必须创建转换器的实例并在 DatePicker 的文本框中使用它

```
<Window x:Class="TestDatePicker.MainWindow"
    ... 
    xmlns:converters="clr-namespace:TestDatePicker"
    Title="MainWindow" Height="350" Width="525">
<Window.Resources>
    ...
    <converters:StringToDateTimeConverter x:Key="StringToDateTimeConverter" />
</Window.Resources>
<Grid DataContext="{StaticResource MainWindowVM}">
    ...
    <DatePicker Height="25" HorizontalAlignment="Left" Margin="5,36,0,0" Name="dtpStartDate"
                SelectedDate="{Binding StartDateSelectedDate}" VerticalAlignment="Top" Width="115">
        <DatePicker.Resources>
            <Style TargetType="{x:Type DatePickerTextBox}">
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <TextBox x:Name="PART_TextBox" 
                                Text="{Binding Path=SelectedDate, RelativeSource={RelativeSource AncestorType={x:Type DatePicker}}, Converter={StaticResource StringToDateTimeConverter}, ConverterParameter=yyyy/MM/dd}" />
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </DatePicker.Resources>
    </DatePicker>
    ...
</Grid> 
```

最后，在视图模型中，属性必须是 DateTime 类型？（即可以为空的日期时间）。

```
 private DateTime? _startDateSelectedDate;
    public DateTime? StartDateSelectedDate
    {
        get { return _startDateSelectedDate; }
        set
        {
            if (_startDateSelectedDate != value)
            {
                _startDateSelectedDate = value;
                RaisePropertyChanged(() => this.StartDateSelectedDate);
            }
        }
    } 
```

我希望这能帮到您

问候

克劳德

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:49:14.507

默认情况下，DateTimerPicker 不支持空值。

也许[这篇](http://social.msdn.microsoft.com/Forums/en/winforms/thread/f1f8cc0a-0ac9-4a3e-9ba4-9af495e8ff58)来自 MSDN 的相同主题的帖子可以帮助你。

在那里，您将找到其他想法如何实现它或一些可空日期时间选择器的代码项目。

# java - SocketException：网络不可达

> ID：14630319
> 
> 赞同：0
> 
> 时间：2013-01-31T16:19:37.670
> 
> 标签：java, urlconnection, socketexception

我开发了一个从远程服务器下载日志文件的小型 Gui 应用程序。如果我从 Netbeans IDE 7.2 中启动应用程序，它可以正常工作（没有连接问题）

但是如果我将它作为一个独立的 jar 文件启动，我会得到一个套接字异常，表明网络不可达。

创建连接的代码如下：

```
...
CookieManager manager = new CookieManager();
manager.setCookiePolicy(CookiePolicy.ACCEPT_ALL);
CookieHandler.setDefault(manager);

URL url = new URL(logFileRemotePath);
URLConnection conn = url.openConnection();
InputStream input = conn.getInputStream();
... 
```

收到的异常是：

```
java.net.SocketException: Network is unreachable: connect 
```

有任何想法吗

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:43:38.087

如果您的操作系统运行了防火墙，则可能以某种方式对其进行配置，即允许从 Netbeans 访问网络，但不允许执行 jar。

您是立即获得异常还是在正常超时时间后获得异常？如果是前者，则意味着您的应用程序和网络资源之间的某些组件正在立即重置您的连接 - 例如某些防火墙。

# java - 如何创建重置和暂停计时器的按钮？

> ID：14630323
> 
> 赞同：0
> 
> 时间：2013-01-31T16:19:41.203
> 
> 标签：java, swing, timer, jbutton

如何使显示的两个按钮重置/暂停计时器？计时器可以工作，但我想更改按钮的代码，以便它们更改计时器而不是输出到控制台。谢谢你。

代码：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class createWindow extends JFrame implements ActionListener
{
public static void main(String[] args)
{
    new createWindow();
}//end main

createWindow()
{
    super("Frame");
    setSize(400,70);
    setResizable(false);
    setDefaultCloseOperation(EXIT_ON_CLOSE);
    setLayout(new FlowLayout());
    show();

        final JLabel time = new JLabel("Timer");
        JButton reset = new JButton("Reset timer");
        JButton pause = new JButton("Pause timer");
        reset.setActionCommand("resetClicked");
        pause.setActionCommand("pauseClicked");
        reset.addActionListener(this);
        pause.addActionListener(this);
        add(pause);
        add(time);
        add(reset);

    long start = System.currentTimeMillis();

    while (true)
        {
            long  timer = System.currentTimeMillis() - start;
            final int seconds = (int) (timer / 1000);
            String display = Integer.toString(seconds);
            time.setText(display);
        }//end while loop
    }//end constructor

@Override
public void actionPerformed(ActionEvent e) 
{
    String buttonClicked = e.getActionCommand();
    if(buttonClicked.equals("resetClicked"))
    {
        System.out.println("The reset button was clicked"); //Change to reset timer
    }
    else if(buttonClicked.equals("pauseClicked"))
    {
        System.out.println("The pause button was clicked"); //Change to pause timer
    }
}//end listener
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:27:48.183

不要使用无限`while`循环。这会阻止`EDT`. 而是使用[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)。这将使您能够控制启动和停止`Timer`.

[秒表示例](http://ccac2.com/KKode/StopWatch/StopWatch.htm)

* * *

*旁注：*

*   不要使用`JFrame.show`，因为该方法已*弃用*。改为使用`JFrame.setVisible`。当所有组件都添加到框架中时也进行此调用。
*   的功能`JButtons`有很大不同，以保证`ActionListener`为每个按钮使用单独的实例。
*   首选方法是直接使用`JFrame`实例而不是扩展它。
*   Java 中的类名以大写开头，因此`createWindow`将变为`CreateWindow`.

# r - 如何根据子字符串匹配选择 R data.table 行（类似于 SQL）

> ID：14630335
> 
> 赞同：58
> 
> 时间：2013-01-31T16:20:05.273
> 
> 标签：r, data.table, string-matching

我有一个带有字符列的 data.table，并且只想选择那些包含子字符串的行。相当于 SQL`WHERE x LIKE '%substring%'`

例如

```
> Months = data.table(Name = month.name, Number = 1:12)
> Months["mb" %in% Name]
Empty data.table (0 rows) of 2 cols: Name,Number 
```

我如何只选择名称包含“mb”的行？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2013-01-31T16:46:24.453

`data.table`有一个`like`功能。

```
Months[like(Name,"mb")]
        Name Number
1: September      9
2:  November     11
3:  December     12 
```

或者，`%like%`看起来更好：

```
> Months[Name %like% "mb"]
    Name Number
1: September      9
2:  November     11
3:  December     12 
```

请注意，`%like%`并`like()`使用`grepl`（返回逻辑向量）而不是`grep`（返回整数位置）。这样它就可以与其他逻辑条件相结合：

```
> Months[Number<12 & Name %like% "mb"]
        Name Number
1: September      9
2:  November     11 
```

并且您也获得了正则表达式搜索的强大功能（不仅仅是 % 或 * 通配符）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-31T16:23:18.843

运算符`%in%`不进行部分字符串匹配，它用于查找值是否存在于另一组值中，即`"a" %in% c("a","b","c")`

要进行部分字符串匹配，您需要使用该`grep()`函数。您可以使用`grep`来返回其中包含的所有列的索引`"mb"`。然后按该索引对行进行子集化

```
Months[grep("mb", Name)]    # data.table syntax slightly easier 
```

# c# - 如何返回 MemoryStream docx 文件 MVC？

> ID：14630336
> 
> 赞同：10
> 
> 时间：2013-01-31T16:20:05.670
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, file-upload, docx

我有一个 docx 文件，我想在编辑后返回。我有以下代码...

```
object useFile = Server.MapPath("~/Documents/File.docx");
object saveFile = Server.MapPath("~/Documents/savedFile.docx");
MemoryStream newDoc = repo.ChangeFile(useFile, saveFile);
return File(newDoc.GetBuffer().ToArray(), "application/docx", Server.UrlEncode("NewFile.docx")); 
```

该文件看起来不错，但我收到错误消息（“文件已损坏”和另一个说明“Word 发现不可读的内容。如果您信任来源，请单击是”）。有任何想法吗？

提前致谢

**编辑**

这是我模型中的 ChangeFile ......

```
 public MemoryStream ChangeFile(object useFile, object saveFile)
    {
        byte[] byteArray = File.ReadAllBytes(useFile.ToString());
        using (MemoryStream ms = new MemoryStream())
        {
            ms.Write(byteArray, 0, (int)byteArray.Length);
            using (WordprocessingDocument wordDoc = WordprocessingDocument.Open(ms, true))
            {                    
                string documentText;
                using (StreamReader reader = new StreamReader(wordDoc.MainDocumentPart.GetStream()))
                {
                    documentText = reader.ReadToEnd();
                }

                documentText = documentText.Replace("##date##", DateTime.Today.ToShortDateString());
                using (StreamWriter writer = new StreamWriter(wordDoc.MainDocumentPart.GetStream(FileMode.Create)))
                {
                    writer.Write(documentText);
                }
            }
            File.WriteAllBytes(saveFile.ToString(), ms.ToArray());
            return ms;
        }
    } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-31T16:33:55.970

我使用[FileStreamResult](http://msdn.microsoft.com/en-us/library/system.web.mvc.filestreamresult%28v=vs.98%29.aspx)：

```
var cd = new System.Net.Mime.ContentDisposition
    {
        FileName = fileName,

        // always prompt the user for downloading, set to true if you want 
        // the browser to try to show the file inline
        Inline = false,
    };
Response.AppendHeader("Content-Disposition", cd.ToString());

return new FileStreamResult(documentStream, "application/vnd.openxmlformats-officedocument.wordprocessingml.document"); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-31T21:44:18.057

不要使用`MemoryStream.GetBuffer().ToArray()`使用`MemoryStream.ToArray()`。

原因`GetBuffer()`与用于创建内存流的数组有关，而不是与内存流中的实际数据有关。底层数组的大小实际上可能不同。

隐藏在 MSDN 上：

> 请注意，缓冲区包含可能未使用的已分配字节。例如，如果将字符串“test”写入 MemoryStream 对象，则从 GetBuffer 返回的缓冲区长度为 256，而不是 4，其中 252 个字节未使用。要仅获取缓冲区中的数据，请使用 ToArray 方法；但是，ToArray 会在内存中创建数据的副本。

# java - Java JTable -- 自定义行排序器

> ID：14630342
> 
> 赞同：1
> 
> 时间：2013-01-31T16:20:12.953
> 
> 标签：java, swing, jtable, tablerowsorter

我有一个 JTable，它从数据库加载数据，然后在表的底部生成一个摘要行。我希望用户能够对表格进行排序，但我希望摘要行始终保留在表格的底部。

我一直在尝试创建一个自定义 TableRowSorter，但我在弄清楚它并让它做我想做的事情时遇到了一些麻烦。

有人知道怎么做吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T17:21:57.837

You need a class which holds whether the value is a summary or not. Something like this

```
public class SummarizedValue {
  public Integer value;
  public boolean summarized;
  public String toString() { 
    return null == value? "" : value.toString();
  }
}

public class SummaryComparator implements Comparator<SummarizedValue> {
  public int compare(SummarizedValue v1, SummarizedValue v2) {
    if (v1.summarized) return 1;
    if (v2.summarized) return -1;
    return v1.value.compareTo(v2.value);
  }
}

public class SummaryBackComparator implements Comparator<SummarizedValue> {
  public int compare(SummarizedValue v1, SummarizedValue v2) {
    if (v1.summarized) return 1;
    if (v2.summarized) return -1;
    return v2.value.compareTo(v1.value);
  }
} 
```

You need to display the objects of class `SummarizedValue` in your column and your row sorter should return `SummaryComparator`. Also your need to override toggle behaviour in RowSorter to use `SummaryBackComparator`.

# ios - IBAction & Buttons 以编程方式

> ID：14630349
> 
> 赞同：4
> 
> 时间：2013-01-31T16:20:21.683
> 
> 标签：ios, objective-c, uibutton, uistoryboard, ibaction

我正在以编程方式创建按钮，然后我想添加功能，当它们被点击/按下时，它们会保持突出显示，除非再次点击。我现在正在做的是创建按钮，然后尝试添加 IBAction。但是，问题是我在一个方法中创建了按钮，然后我不确定如何在我的 IBAction 中引用该按钮。这是我的代码：

```
UIButton* testButn = [UIButton buttonWithType:UIButtonTypeCustom];
  [testButn setFrame:CGRectMake(0, 135, 40, 38)];
  [testButn setImage:[UIImage imageNamed:@"test_butn_un.png"] forState:UIControlStateNormal];
  [testButn setImage:[UIImage imageNamed:@"test_butn_pressed.png"]   forState:UIControlStateHighlighted];
[testButn addTarget:self action:@selector(staypressed:) forControlEvents:UIControlEventTouchUpInside];
[self.contentview addSubview:testButn

-(IBAction)staypressed:(id)sender{

//Not sure what to do here, since this method doesn't recognize testButn, How do I reference testButn 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T16:22:10.393

发件人是 testButn。您应该将 stayPressed 的参数类型从 (id) 更改为 (UIButton *)

除非一个操作方法连接到几个不同的对象类，否则最好将 id 替换为您正在使用的任何对象类。如果您在 IB 中连接事物，这将很有用，因为它不会让您将它连接到错误类型的对象。

它不起作用的事实并不是因为它不识别您的按钮。你的方法是错误的。我认为您需要连接一个动作才能触地，并且可能将选定状态设置为“是”。在您的按钮定义中，您需要为所选状态设置一个 imageForState:。按照您现在的操作方式，直到修改后才会调用该方法。

像这样的东西：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    UIButton* testButn = [UIButton buttonWithType:UIButtonTypeCustom];
    [testButn setFrame:CGRectMake(0, 135, 40, 38)];
    [testButn setImage:[UIImage imageNamed:@"New_PICT0019.jpg"] forState:UIControlStateNormal];
    [testButn setImage:[UIImage imageNamed:@"New_PICT0002.jpg"]   forState:UIControlStateSelected];
    [testButn addTarget:self action:@selector(stayPressed:) forControlEvents:UIControlEventTouchDown];
    [self.view addSubview:testButn];
}

-(void)stayPressed:(UIButton *) sender {
    if (sender.selected == YES) {
        sender.selected = NO;
    }else{
        sender.selected = YES;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:22:00.690

您需要将发件人转换为 UIButton。

```
- (IBAction)staypressed:(id)sender
{
    UIButton *theButton = (UIButton*)sender;

    //do something to theButton
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T16:55:49.513

```
UIButton* testButn = [UIButton buttonWithType:UIButtonTypeCustom];
  [testButn setFrame:CGRectMake(0, 135, 40, 38)];
  [testButn setImage:[UIImage imageNamed:@"test_butn_un.png"] forState:UIControlStateNormal];
  [testButn setImage:[UIImage imageNamed:@"test_butn_pressed.png"]   forState:UIControlStateHighlighted];
  [testButn addTarget:self action:@selector(staypressed:) forControlEvents:UIControlEventTouchUpInside];
  testButn.tag = 1;
  [self.contentview addSubview:testButn

-(IBAction)staypressed:(id)sender
 {
     if ([sender tag]==1)
     {
         somecodes...
     }
 } 
```

# php - Wordpress/PHP/Ajax 加载更多帖子

> ID：14630356
> 
> 赞同：6
> 
> 时间：2013-01-31T16:20:48.230
> 
> 标签：php, ajax, wordpress

我的 wordpress 类别页面上有一些代码，如果他们单击图形，则会加载更多帖子 - 在本例中为 15。

第一次按下时效果很好。但是，一旦再次按下，它不会引入下一组帖子（即第三个），而是引入第二个。

我知道问题是偏移量 - 即。它从哪里开始。因此，第一次按下时，偏移量应为 16，第二次为 31，第三次为 46，依此类推。

但是，我遇到困难的地方是通过这个偏移量。

这是js：

```
 $('#do-show-more-posts').live('click', function(){

    if( $(this).data("o-set")){
        $offset=$(this).data("o-set");
    }else
    {
        $offset=16 ; //assume this is 16 initially
    }

    var post_type = $(this).attr('post-type');
    var parent = $(this).attr('parent-id');
    var offset = $('.article').size();

    $(this).fadeTo(0,0);
    $('.load-more-posts-wrapper .loader').addClass('show');

    $.post( ajaxurl, { action: 'load_more_posts', post_type : post_type, parent : parent, offset : offset }, function(data){
        $load_more = $('.load-more-posts-wrapper');
        $load_more.find('.loader').removeClass('show');
        $load_more.find('.link').removeAttr('style');
        var load_more_button = '<div class="load-more-posts-wrapper">' + $load_more.html() + '</div>';
        $load_more.remove();

        if( data == '' || data == 'udefined' || data == 'No More Posts' || data == 'No $args array created' ){
            data = '';
            load_more_button = '<div class="load-more-posts-wrapper">There are no more posts.</div>';
            setTimeout("$('.load-more-posts-wrapper').fadeTo(1800,0)", 8000 );
        }

        $('#content').append( data );
        $('#content').append( load_more_button );
        $(this).data("o-set",$offset);
    });

}); 
```

这是PHP：

```
function load_more_posts() {

if( isset($_POST['post_type']) && $_POST['post_type'] == 'publication' ){

    $args = array(
        'offset'         => $_POST['offset'],
        'orderby'        => 'post_date',
        'order'          => 'DESC',
        'post_type'      => 'article',
        'post_status'    => 'publish',
        'meta_query'     => array(
            array(
                'key'    => 'related-publication',
                'value'  => $_POST['parent'],
                'meta_compare' => 'IN'
            )
        )
    );

} else if(isset($_POST['post_type']) && $_POST['post_type'] == 'category') {

    $args = array(
         'cat'       => $_POST['parent'],
         'offset'    => $_POST['offset'],
        'post_type' => array('post','article','publication')
     );

} else {

    // print_r($args);

}

$Query = new WP_Query( $args );
//print_r($Query);
if ( $Query->have_posts() ) {

    while ( $Query->have_posts() ) {
        $Query->the_post();
        get_template_part('loop', 'xxxry');
    }

} else {
    // print_r($args);
}

exit;
} 
```

我有一个想法来创建一个保存偏移值的会话，尽管这似乎不起作用。此外，如果有人返回该类别页面，我不确定如何删除它。

我使用的代码是这样的：

```
if (isset($_SESSION['posts_start'])){
    $_POST['offset']=$_SESSION['posts_start']+15;
    $_SESSION['posts_start']=$_POST['offset'];
} else {
    $_POST['offset']=15;
    $_SESSION['posts_start']=$_POST['offset'];
} 
```

我把它放在php函数的开头。如果已经有一个会话，它似乎没有注册 15 的添加。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:01:48.267

您可以使用WP_Query args 的参数，`posts_per_page`而不是使用偏移量。`paged`

```
function load_more_posts() {

//...

    $args = array(
        'posts_per_page' => $_POST['offset'],
        'paged'          => $_POST['page'],
        'orderby'        => 'post_date',
        'order'          => 'DESC',
        'post_type'      => 'article',
        'post_status'    => 'publish',
        'meta_query'     => array(
            array(
                'key'    => 'related-publication',
                'value'  => $_POST['parent'],
                'meta_compare' => 'IN'
            )
        )
    );

//...
} 
```

在你的 JS 中：

```
//EDIT2: (global page variable
$(document).ready(function(){
//...
var page = 1; //don't redefine this variable each time you click.
$('#do-show-more-posts').live('click', function(){
    //...
    $.post( ajaxurl, { action: 'load_more_posts', post_type : post_type, parent : parent, offset : $offset, page : page++ }, function(data){
    //EDIT:  --------------------------------------------------------------------------------------------------- ^
        $load_more = $('.load-more-posts-wrapper');
        $load_more.find('.loader').removeClass('show');
        $load_more.find('.link').removeAttr('style');
        var load_more_button = '<div class="load-more-posts-wrapper">' + $load_more.html() + '</div>';
        $load_more.remove();

    if( data == '' || data == 'udefined' || data == 'No More Posts' || data == 'No $args array created' ){
        data = '';
        load_more_button = '<div class="load-more-posts-wrapper">There are no more posts.</div>';
        setTimeout("$('.load-more-posts-wrapper').fadeTo(1800,0)", 8000 );
    }

    $('#content').append( data );
    $('#content').append( load_more_button );
    $(this).data("o-set",$offset);
    });
}
//...
} 
```

# javascript - 在画布上拖动图像闪烁

> ID：14630358
> 
> 赞同：0
> 
> 时间：2013-01-31T16:20:51.887
> 
> 标签：javascript, html, canvas, drag-and-drop

我正在尝试在我的画布上拖动图像，但这样做我遇到了一个问题，一旦图像处于负坐标中，我就会得到一个条件

```
mouseX - negativeImageCoords // 200 - minus 210 = 410 
```

让我的图像像画布上的爆米花小猫一样跳来跳去，而不是想要的效果。

这是我的代码，我希望它是愚蠢的，我可以把它归结为累了..

```
function (e) {
    var
        // The mouse x and y positions
        mx = e.offsetX,
        my = e.offsetY,

        // The last known position
        lx = cache.lx, // These are from a JSON object
        ly = cache.ly; 

    // The temporary image
    var img = $('#loadedImage');

    // Get the image context
    var canvas_context = this.mask(); 

    cache.lx = (mx - lx);
    cache.ly = (my - ly);

    console.log(mx, lx);
    console.log(my, ly);        

    // Redraw
    canvas_context.drawImage(img.get(0), cache.lx, cache.ly, img.width(), img.height());
} 
```

这是掩码功能（包括在肇事者的情况下..

```
function () {
    var mask_name = 'circle';
    var context = ctx.context();
    var mask;
    var isSameMask = false;
    var composition = 'lighter';

    // Add a check to see if it's the same mask
    if (cache.mask && cache.mask.src) {
        if (cache.mask.src !== 'images/masks/' + mask_name + '.png') {
            isSameMask = false;
        }
    }

    // If we don't have a cached mask, load it and cache it
    if (!cache.mask && !isSameMask) {
        // Create a new mask
        mask = new Image;

        // Draw when its loaded
        mask.onload = function () {
            //ctx.clear();
            context.drawImage(this, 0, 0);
            context.globalCompositeOperation = composition;
        };

        mask.src = 'images/masks/' + mask_name + '.png';
        // Set the cache as this new mask
        cache.mask = mask;

        imageEvents.size(0);
    } else {
        ctx.clear();
        // It's cached, so just redraw it
        context.drawImage(cache.mask, 0, 0);
        context.globalCompositeOperation = composition;
    }

    return context;
} 
```

为什么图像会跳来跳去？

必须注意的是，我已经将它放在一个 appjs 项目中，非常感谢大家的任何帮助/建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T14:18:02.487

对，设法让这个工作。修复是在 mousedown 上更新缓存的图像位置，并将缓存的位置添加到鼠标位置。这是代码：

```
function drag (e) { // :void
    var
        // The mouse x and y positions
        mx = e.offsetX,
        my = e.offsetY,

        // The last known position
        lx = mx+cache.lx,
        ly = my+cache.ly;

    // The temporary image
    var img = $('#loadedImage');

    // Get the image context
    var canvas_context = this.mask();

    cache.ix = lx;
    cache.iy = ly;

    // Redraw
    canvas_context.drawImage(img.get(0), lx, ly, img.width(), img.height());
    textEvents.draw();
} 
```

还有我的沮丧事件

```
 cache.ix = 0;
    cache.iy = 0;

    // Listen for a mousedown or touchstart event
    canvas.on('mousedown touchstart', function (e) {
        cache.lx = cache.ix - e.offsetX;
        cache.ly = cache.iy - e.offsetY;
        // Add a move listener
        canvas.on('mousemove touchmove', function (e) {
            that.drag.call(that, e);
        });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:32:30.157

如果没有看到实际的代码，很难提供答案，但可能是您指定的那些条件，例如：

```
if (lx < 0) {
    cache.lx = (mx + lx);
} else {
    cache.lx = (mx - lx);
} 
```

`lx`如果小于或大于，您当然不想更改总和`0`。让数学做它的工作。数学上：

`mx + -1`是相同的`mx - 1`

`mx + +1`是相同的`mx + 1`

`mx - -1`与`mx + 1`[双重否定]相同

这就是为什么 '200 - 负 210 = 410'; 这实际上是正确的。

**编辑**

变量`lx`是缓存的（因此是旧的）位置；`mx`是新职位。

因此`lx - mx`将返回缓存位置和新位置之间的差异，我认为（如果我理解正确的话）是您想要将图像移动一定量的内容。对`ly - my`.

在缓存新鼠标位置时，您肯定只想缓存当前位置，例如

```
cache.lx = mx; // current position cached for future reference 
```

缓存差异或求和只会增加混乱（再次，如果我理解你想要做什么）。

# birt - 无法加载 BIRT 库

> ID：14630361
> 
> 赞同：2
> 
> 时间：2013-01-31T16:21:02.093
> 
> 标签：birt

我有一个使用 BIRT 的桌面应用程序。在 jar 文件中，我在资源文件夹中有一个目录，其中包含设计和库文件。即使它们在同一个文件夹中，当我运行应用程序时，我也会收到一个异常，表明它找不到 rptlibrary 文件：

```
Jan 31, 2013 11:29:33 AM org.eclipse.birt.report.model.core.LayoutModule loadLibrarySilently
WARNING: Syntax error found, and see error details.
Error.DesignFileException.SYNTAX_ERROR - 1 errors found! 
1.)  org.eclipse.birt.report.model.parser.DesignParserException (code = Error.DesignParserException.FILE_NOT_FOUND, message : The file "pdv.rptlibrary" is not found.) 
```

如果我从以下位置更改 rptlibrary 中的库标记：

```
<list-property name="libraries">
    <structure>
        <property name="fileName">pdv.rptlibrary</property>
        <property name="namespace">pdv</property>
    </structure>
</list-property> 
```

至：

```
<list-property name="libraries">
    <structure>
        <property name="fileName">modelos_relatorio/pdv.rptlibrary</property>
        <property name="namespace">pdv</property>
    </structure>
</list-property> 
```

它可以工作，但是在尝试在 Eclipse 中预览时出现了一些错误，那么，有没有办法可以在代码中更改它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T16:11:02.717

您在设计器中将资源文件夹设置为什么？这可以在 window->preferences 中配置。 ![在此处输入图像描述](../Images/5d8f39f525e847f129f71d266276a729.png)

您可以为整个工作区或仅为特定项目配置它。如果您在应用程序中使用 API，您应该能够在 EngineConfig 中设置资源路径或设置 IResourceLocator 接口的特定实例，这实际上只需要实现两个称为 findResource 的方法。您可以查看源代码中的 org.eclipse.birt.report.model.util.ResourceLocatorImplBase 类作为示例。

# xpages - 在 dataTime 字段 xPages 中使用带有选择器的自定义模式

> ID：14630364
> 
> 赞同：0
> 
> 时间：2013-01-31T16:21:16.493
> 
> 标签：xpages

我正在尝试在 xPage 中添加一个 dateTime 编辑框，并且我想以我定义的特定模式显示日期和时间。模式是“MMM d, yyyy HH:mm”。打开 xPage 时，日期和时间以所需的格式显示。当我选中“使用日期/时间选择器弹出窗口”复选框时，就会出现问题。更改后，时间显示不正确。它始终是 00:00。这是一个错误吗？或者我是否需要对编辑框进行不同的配置才能使用我想要的模式并能够正确添加数据/时间选择器？

任何帮助将不胜感激。

非常感谢您的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:27:08.643

是的，这是错误。我已将其报告给 IBM 支持。

您可以使用 ExtLib Dojo 日期和时间控件。问题是日期和时间有一个单独的控件，并且没有内置的方法可以将它们保存在文档的同一项目中。不过，您可以使用一些 SSJS 来做到这一点。

我使用了一个常规的 Date/Time Edit Box ja ExtLib *Dojo Time Text Box*。编辑框设置为仅显示日期并绑定到数据源表单上的日期/时间字段。Dojo 时间文本框从文档上的相同日期/时间项获取其默认值。

在数据源*querySaveDocument*事件中，我有这段代码，它将时间添加到日期编辑框中选择的日期：

```
// When time field is empty we get Java Date.
var dtDate:java.util.Date = getComponent("inpDT").getValue();
var dtTime = getComponent("djTime").getValue();
if (typeof dtTime == "lotus.domino.local.DateTime") dtTime = dtTime.toJavaDate()

// Combine date and time.
if (dtDate != null && dtTime != null) { 
    var dtDateTime:NotesDateTime = session.createDateTime(dtDate);
    dtDateTime.setLocalTime(dtTime.getHour(), dtTime.getMinute(), 0, 0);
    dominoDocument.replaceItemValue("DT", dtDateTime);
} 
```

# c# - 为什么 Visual Studio 2010 C# Express 不能正确格式化嵌套代码？

> ID：14630368
> 
> 赞同：3
> 
> 时间：2013-01-31T16:21:22.310
> 
> 标签：c#, visual-studio, formatting, format, code-formatting

考虑这段代码...

```
Create(x,y,z,
null, null, null,
new Class1[     ] {
    new Class1(a,b,c),
    new Class1(a,b,c)
},
new Class2[] {
    new Class2(d,e,f    )
},
true); 
```

请注意参数逗号后缺少空格，以及 Class1 数组定义和 Class2 调用中的额外空格。

如果我格式化我的文档 -- Ctrl+E、D 或 Ctrl+K、D -- 代码被格式化为这个......

```
Create(x, y, z,
null, null, null,
new Class1[] {
    new Class1(a,b,c),
    new Class1(a,b,c)
},
new Class2[] {
    new Class2(d,e,f    )
},
true); 
```

请注意，“外部”代码中的参数逗号已正确格式化为空格（根据我的偏好），并且已从 Class1 数组定义中删除了额外的空格（同样，我的偏好）。但是，“内部”代码中的参数逗号格式不正确，并且额外的间距保留在 Class2 调用中。

代码绝对没有问题——它编译和运行没有错误。

每次我使用大括号创建嵌套的复杂调用时都会发生这种情况。我想我可以通过将代码全部分开并使用临时变量来使我的代码更长更复杂，但这似乎有点矫枉过正。

为什么 Visual Studio 2010 C# Express 不能正确格式化这样的嵌套代码？有没有其他人经历过这个？如有必要，我可以提供我的格式首选项。提前致谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T04:38:15.617

@tvwxyz: I could reproduce this issue with Ctrl+K, D.

But, interestingly if I enable "Automatically format completed block on }" it works fine (gets intended as expected) when I close the function.

> Tools -> Options -> Text Editor-> C#-> Formatting -> General -> Automatically format completed block on }

# objective-c - 异步加载网站数据时的延迟

> ID：14630372
> 
> 赞同：0
> 
> 时间：2013-01-31T16:21:32.950
> 
> 标签：objective-c, asynchronous

我编写了一个将网站数据解析为表格视图的应用程序。

我希望应用程序在完成数据下载并将其显示到表格视图之前阻止 UI，因此我使用 MBProgressHUD 在解析发生时向用户显示反馈。

我编写了以下方法来异步下载数据：

```
- (void)getDataFromUrlString:(NSString *)string
{
   NSDate *dateAtStartOfGetDataFromString = [[NSDate alloc] initWithTimeIntervalSinceNow:0];
   NSLog(@"dateAtStartOfGetDataFromString = %@", dateAtStartOfGetDataFromString);

   NSMutableString *databaseURL = [[NSMutableString alloc] initWithString:string];

   NSURL *url = [NSURL URLWithString:databaseURL];

   NSURLRequest *request = [NSURLRequest requestWithURL:url];
   NSOperationQueue *queue = [[NSOperationQueue alloc] init];

   [NSURLConnection sendAsynchronousRequest:request queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
   {
     if ([data length] > 0 && error == nil){
        [self loadReports:data];
     }else if ([data length] == 0 && error == nil){

     }else if (error != nil && error.code == NSURLErrorTimedOut){ //used this   NSURLErrorTimedOut from foundation error responses

     }else if (error != nil){

     }
 }];
 NSDate *dateAtEndOfGetDataFromString = [[NSDate alloc] initWithTimeIntervalSinceNow:0];
 NSLog(@"dateAtEndOfGetDataFromString = %@", dateAtEndOfGetDataFromString);

} 
```

这是 loadReports: 方法：

```
- (void)loadReports:(NSData *)data {
    //...Get the data into the table view data array

    [HUD hide:YES];
    _reports = newReports;

    [self.tableView reloadData];
    NSDate *dateAfterLoadReports = [[NSDate alloc] initWithTimeIntervalSinceNow:0];
    NSLog(@"dateAfterLoadReports = %@", dateAfterLoadReports);
} 
```

该应用程序加载速度非常快并显示 HUD，直到成功完成将数据加载到表视图。

问题是数据显示需要一点时间（5 秒）。

我检查了应用程序使用 NSDate 加载和解析数据的时间：

```
2013-01-31 18:06:52.508 TrafficReport[4472:c07] dateAtStartViewDidLoad = 2013-01-31 16:06:52 +0000
2013-01-31 18:06:52.513 TrafficReport[4472:c07] dateAtStartOfGetDataFromString = 2013-01-31 16:06:52  +0000
2013-01-31 18:06:52.513 TrafficReport[4472:c07] dateAtEndOfGetDataFromString = 2013-01-31 16:06:52 +0000
2013-01-31 18:06:52.516 TrafficReport[4472:c07] dateAtEndViewDidLoad = 2013-01-31 16:06:52 +0000
2013-01-31 18:06:52.664 TrafficReport[4472:4a03] dateAfterLoadReports = 2013-01-31 **16:06:52** +0000
2013-01-31 18:06:57.569 TrafficReport[4472:4a03] dateAtStartCellForRow = 2013-01-31 **16:06:57** +0000 
```

正如您在 loadReports 之后看到的那样，在执行 cellForRow 方法之前有 5 秒的延迟，我不知道它是什么以及如何修复它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:41:53.843

您必须在主线程中执行所有 UI 更改：

```
....
if ([data length] > 0 && error == nil){
    dispatch_async(dispatch_get_main_queue(), ^{
        [self loadReports:data];
    });
}
.... 
```

# r - 如何在 R 中获得精确的低 p 值（来自 F 检验）

> ID：14630375
> 
> 赞同：3
> 
> 时间：2013-01-31T16:21:46.020
> 
> 标签：r, floating-point-precision

我正在计算 R 中的 F 检验的 p 值，它似乎无法显示低于 1e-16 的任何内容。例如，对于从 80 到 90 且自由度为 1,200 的 F 值：

```
> 1-pf(80:90,1,200)
 [1] 2.220446e-16 2.220446e-16 1.110223e-16 1.110223e-16 0.000000e+00 0.000000e+00 0.000000e+00
 [8] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
```

如何提高`pf()`函数计算的精度？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-31T16:31:21.860

*无论如何，这么低的*p值毫无意义。*首先，大多数计算使用轻微的近似值，因此当您倾向于零*p*值时，不精确性会主导结果，其次，可能更重要的是，您的总体与建模分布的任何微小偏差都会压倒您想要的准确性。*

 *只需将 p 值引用*为*' *p* < 0.0001' 并完成它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T16:44:57.867

除了 Jack 关于 p 值的实用建议外，函数定义明确（如果不实用），因此我将给出有限精度的数学原因，这不起作用。

`.Machine$double.eps`是`2.220446e-16`，这是你可以加到 1 并得到不同的最小数字。所以与 1 不同，这是你得到的最小值。

```
> pf(80:90,1,200)
 [1] 1 1 1 1 1 1 1 1 1 1 1
> sprintf("%.17f",pf(80:90,1,200))
 [1] "0.99999999999999978" "0.99999999999999978" "0.99999999999999989"
 [4] "0.99999999999999989" "1.00000000000000000" "1.00000000000000000"
 [7] "1.00000000000000000" "1.00000000000000000" "1.00000000000000000"
[10] "1.00000000000000000" "1.00000000000000000"
> sprintf("%a", pf(80:90,1,200))
 [1] "0x1.ffffffffffffep-1" "0x1.ffffffffffffep-1" "0x1.fffffffffffffp-1"
 [4] "0x1.fffffffffffffp-1" "0x1p+0"               "0x1p+0"              
 [7] "0x1p+0"               "0x1p+0"               "0x1p+0"              
[10] "0x1p+0"               "0x1p+0" 
```

但是，您可以使用近似值 $1-p = -\ln(p)$ 并且您可以更精确地获得 p 值的对数

```
> -pf(80:90,1,200,log.p=TRUE)
 [1] 2.540347e-16 1.770938e-16 1.236211e-16 8.640846e-17 6.047690e-17
 [6] 4.238264e-17 2.974043e-17 2.089598e-17 1.470045e-17 1.035491e-17
[11] 7.303070e-18 
```*

# php - 将 CSV 转换为 PHP 数组 - 结束行问题 (CR LF)

> ID：14630378
> 
> 赞同：4
> 
> 时间：2013-01-31T16:21:47.613
> 
> 标签：php, csv

我正在使用下面的代码将 csv 文件转换为数组。但是，问题是行尾是**CR LF**，并且没有被检测到，所以数组有错误的偏移量。CR LF 被忽略并且它周围的“单元格”被合并。

我如何重写代码以正确检测此行结束并拆分数组？或者，有没有更好的方法将 csv 转换为数组？

这里有一些类似的问题，但我还没有找到解决这个问题的方法。

谢谢。

```
$fileName ='test.csv';   
$csvData = file_get_contents($fileName); 
$csvNumColumns = 11; 
$csvDelim = ";"; 
$data = array_chunk(str_getcsv($csvData, $csvDelim), $csvNumColumns); 

print_r($data); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:26:50.500

你试过使用`fgetcsv()`吗？[php.net](http://php.net/manual/en/function.fgetcsv.php)上的完整信息。

来自 php.net 的示例用法

```
<?php
$row = 1;
if (($handle = fopen("test.csv", "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        $num = count($data);
        echo "<p> $num fields in line $row: <br /></p>\n";
        $row++;
        for ($c=0; $c < $num; $c++) {
            echo $data[$c] . "<br />\n";
        }
    }
    fclose($handle);
}
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:24:16.673

我会避免使用 str_getcsv() 并使用 fgetcsv() 来避免处理一些行尾的 futz。

[http://php.net/manual/en/function.fgetcsv.php](http://php.net/manual/en/function.fgetcsv.php)

```
if (($handle = fopen("fileName", "r")) !== FALSE) {
    while (($data = fgetcsv($handle)) !== FALSE) {
      var_dump($data);  //array representation of one line of csv...
    }
}
fclose($handle); 
```

如果你在 Mac 上...

> 注意：如果 PHP 在读取 Macintosh 计算机上或由 Macintosh 计算机创建的文件时无法正确识别行尾，启用 auto_detect_line_endings 运行时配置选项可能有助于解决问题。

# amazon-s3 - 带有签名 URL 的 AWS Cloudfront 流式传输

> ID：14630381
> 
> 赞同：3
> 
> 时间：2013-01-31T16:21:53.450
> 
> 标签：amazon-s3, jwplayer, amazon-cloudfront

我已经设置了一个带有下载和流式分发的云端实例。我使用签名的网址将两者都设置为私有。我能够获得适用于带有签名网址的图像的下载分发的示例代码。我现在正试图让带有签名 URL 的 JW Player 的流媒体分发工作，但我遇到了问题。

Here is my signed URL format: rtmp://s1iq2cbtodqqky.cloudfront.net/2012-08-31_13-24-01_534.mp4?Expires=1359648770&Signature=Oi8RwL4Nf338NldW2uIsqFIv3zHnJkxXYbXIiVQh~J0Iq4kb00Ly5MLTgJw~87KmlUOmilmdRHy7p~UxeGYQxgkewPI11r27se0b~hTvpxq9y9Z5C-B-A58ZnngaCi9G2SHAujMzvss7ynLLEqUV3M6MVZl1qCxyfJbLdxCIEMY_&Key-Pair-Id =

这是我的 JW 播放器代码：

```
<script type="text/javascript" src="jwplayer/jwplayer.js"></script>
<div id="container">Loading the player ...</div>
<script type="text/javascript">
jwplayer("container").setup({
'flashplayer': 'jwplayer/jwplayer.flash.swf',
'file': '<?= $canned_policy_stream_name ?>',
'width': '480','height': '270',
'provider': 'rtmp',
'streamer': 'rtmp://s1iq2cbtodqqky.cloudfront.net/cfx/st/'

});
</script> 
```

有人知道这里有什么问题吗？如何单独测试 url？现在很难判断问题是 url 还是 JW Player 集成的代码。

-J

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-11T22:11:00.743

这里有很多陷阱。当我进入它时，我花了一段时间来完成它们。以下是我认为可能对很多人有帮助的一些步骤。

首先是我使用的技术堆栈：

*   导轨 3.x
*   Zencoder 用于编码
*   用于文件上传的回形针
*   用于上传的 Jquery Uload
*   JWPlayer

如果那不是你的平台，你可以填补一些空白，但很多学习对你仍然有用。

有很多关于如何将内容从用户上传到 S3 的文章，所以我将跳过该部分，有趣的部分是当您开始编码过程时，这实际上是问题开始的地方，涉及签名、流式传输在 jwplayer 或 flowplayer 中播放的内容。

首先，文件格式——我发现 MP4 和 M4A 是我最成功的文件格式。使用 zencoder，我能够使用开箱即用的 mp4 和 m4a 导出格式并让这些输出正常播放。

1.  在设置云端分发之前，将您的 zencoder 策略添加到存储桶中。
2.  如果您已经配置了 cloudfront，那么您应该小心如何将 zencoder 存储桶策略添加到存储桶中，并确保将其与那里的任何内容合并。Cloudfront 还将内容放入存储桶策略中，您需要这个和 zencoder 存储桶策略配置文件才能正常工作。

3.  存储桶策略*仅适用于存储桶所有者拥有的文件，*因此请务必与您的编码提供商联系，以确保他们使用您的访问密钥将文件放在云端。如果您没有让用户与在 S3 中拥有该文件的用户一样进行签名，它将无法正常工作，您将花费数小时想知道为什么

4.  一旦您确定您的存储桶设置正确，在进一步使用此工具来帮助验证您的文件将实际流式传输之前（开始时没有签名的 url 并允许云端流式传输未流式传输的文件。如果这不起作用你不会走远）。

    [http://d1k5ny0m6d4zlj.cloudfront.net/diag/CFStreamingDiag.html](http://d1k5ny0m6d4zlj.cloudfront.net/diag/CFStreamingDiag.html)

    要使用 amazons 工具，如果您的 rtmp url 是：

    “rtmp://s3b78u0kbtx79q.cloudfront.net/cfx/st/content/myfile.png”

    对于您要输入的流式传输网址：

    s3b78u0kbtx79q.cloudfront.net

    对于您要输入的视频文件名：

    content/myfile.png（没有前导的'/'）

5.  一旦您实际上可以通过诊断工具从亚马逊流式传输您的文件，现在继续执行您从 flowplayer 的 jwplayer 获得的任何步骤。

6.  关于在流式传输时设置 JWPlayer（我遇到的问题最少）的注意事项 - 还要安装调试版本的 flash。现在在调试期间，您可以右键单击闪存控件并将日志记录更改为“控制台”。现在你会从出现在 Firebug 中的 flash 控件中得到任何加载错误 - 所以可能先用 Firefox 进行测试。通常，在查看这些日志时，您不希望任何 html 控制字符被转义，转义通常会毁了您的一天。

7.  我想很多这样做的人会希望他们的内容安全并使用签名的 url（这样可疑的其他人不会只是撕掉你的 rtmp 路径并将其直接嵌入到他们的网站中，在你支付带宽的同时获得好处）。我可以不要强调这一点，在开始走这条路之前，请确保首先让您的 RTMP 流在您的云端存储桶中的公共流文件上播放，这样您就知道该机制正在工作。

8.  如果你走到这一步，你就在一个好地方，但现在是所有错误都可能击中你的时候，如果你遵循我上面的建议，那将比你错过其中一个步骤更短的一天（比如确保你的存储桶策略包括您的 cloudfront origin id 和您的编码提供商以您的规范 id 作为所有者而不是他们的所有者写入文件）。

9.  现在您已经通过 RTMP 将内容流式传输到播放器，接下来您将希望使其与签名 URL 一起工作（同样，因此其他站点不能只复制您的 RTMP 路径并通过他们自己的站点播放它并附加 jwplayer） . 至少在 Rails 中，生成签名 url 的最好方法是使用这个 gem：

    [https://github.com/58bits/cloudfront-signer](https://github.com/58bits/cloudfront-signer)

    根据您嵌入 url 的方式，您将需要使用不同类型的转义。如果您的 URL 无法播放，请尝试以下操作（不是很精确，但如果您在这里并且失去了头发，您会尝试任何方法，如果您已经尝试过让这个工作，您可能已经知道我的意思并且不会暂时需要理发）：

> ```
> <%=  AWS::CF::Signer.sign_path 'path/to/my/content', :expires => Time.now + 600 %>
> <%=raw AWS::CF::Signer.sign_path 'path/to/my/content', :expires => Time.now + 600 %>
> 
> <%=  AWS::CF::Signer.sign_path_safe 'path/to/my/content', :expires => Time.now + 600 %>
> <%=raw AWS::CF::Signer.sign_path_safe 'path/to/my/content', :expires => Time.now + 600 %> 
> ```

在我发现使用 raw 可以解决我所有的问题之前，我可能有一次搞砸了一个小时。

# objective-c - Xcode故事板如何检测触摸项目

> ID：14630387
> 
> 赞同：0
> 
> 时间：2013-01-31T16:22:16.310
> 
> 标签：objective-c, xcode, ios6, storyboard

我有一个带有选项卡式应用程序模板的故事板设置（默认设置）。

我想添加一个 BarItem 并在触摸时启动一个 URL。我不希望它进入应用程序中的视图。如何使用情节提要做到这一点？

我是故事板概念的新手，不确定要添加到故事板中以添加新的条形项目，然后使其调用方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:33:33.007

首先，您需要在 ViewController 代码中放置一个函数，例如...

```
- (IBAction)barButtonPressed:(id)sender
{
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://www.google.com"]];
} 
```

然后将按钮添加到情节提要中的视图控制器，然后按 ctrl 单击从按钮拖动到函数。

这将使按钮在按下时运行该功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:50:15.103

如果您的意思是导航栏

```
 //in viewDidLoad or wherever 
    UIBarButtonItem *openWebLink = [[UIBarButtonItem alloc] 
                                   initWithTitle: @"OpenWebLink" 
                                   style: UIBarButtonItemStyleBordered
                                   target: nil action: @selector(openLink)];

    [self.navigationItem setBackBarButtonItem: openWebLink];

-(void) openLink
{
     [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://www.google.com"]];
} 
```

如果您不这样做，请查看 Fogmeister 答案

代码未测试！

# android - Android 防止屏幕关闭

> ID：14630388
> 
> 赞同：2
> 
> 时间：2013-01-31T16:22:16.210
> 
> 标签：android, jquery-mobile, screen

所以我看到你可以制作一个像这样执行 LinearLayout 的 xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" android:layout_width="fill_parent"
    android:layout_height="fill_parent" android:keepScreenOn="true">
</LinearLayout> 
```

我的问题是：我正在做一个 jQuery Mobile 应用程序，我想我可以把它放在我的 web.xml 文件中。但是，当我尝试这样做时，我不断收到错误。这是我的 web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

<!-- The definition of the Root Spring Container shared by all Servlets 
    and Filters -->
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/spring/root-context.xml,
        /WEB-INF/spring/appServlet/security-context.xml</param-value>
</context-param>

<!-- Creates the Spring Container shared by all Servlets and Filters -->
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<listener>
    <listener-class>org.springframework.security.web.session.HttpSessionEventPublisher</listener-class>
</listener>
<!-- Processes application requests -->
<servlet>
    <servlet-name>appServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>appServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

有没有更简单的方法可以让我的 Android 平板电脑在我使用 Web 应用程序时不会关闭屏幕？就像我说的，我尝试将 LinearLayout 代码放入我的 web.xml 中，但它给了我很多错误。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:40:42.077

> 有没有更简单的方法可以让我的 Android 平板电脑在我使用 Web 应用程序时不会关闭屏幕？

这不可能。事实上，如果任意网站以这种方式影响设备，那将是非常令人不安的。

如果您选择创建本机应用程序，甚至可能是 PhoneGap 应用程序，那么您可以考虑尝试控制屏幕是否关闭。

# javascript - 获取一个表格单元格值，其中我选中了一个复选框

> ID：14630393
> 
> 赞同：0
> 
> 时间：2013-01-31T16:22:37.647
> 
> 标签：javascript, jquery

我是 JQuery 的新手，我遇到了麻烦。我想从有复选框的表格行中读取特定的单元格值。我有一个处理复选框选中事件的事件。这是我的代码：

```
$("#businesses input:checkbox").change(function (
        var $this = $(this);
        if ($this.is(":checked")) {

            //Here I want to read a value from a column in a row where is the checkbox

        } else {
            //Here I want to read a value from a column in a row where is the checkbox 
        }
}); 
```

我有一张名为“businesses”的表格，它有这种格式

```
<table id="businesses">
<tr>
  <th>Select Value</th>

  <th>Value</th>
</tr>
<tr>
  <td><input type="checkbox" class="selectedService" title="Seleccionar" /></td>
  <td>125</td> 
</tr>  
<tr>
  <td><input type="checkbox" class="selectedService" title="Seleccionar" /></td>
  <td>126</td> 
</tr>
</table> 
```

我想要做的是，当我选择一个复选框时，获取其行的值字段。

如果我按下第一个复选框，我想得到 125。

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:25:48.523

从您的复选框（`this`在事件处理函数中）开始，您需要向上到达包含`<td>`元素，到达下一个`<td>`元素，然后获取其文本：

```
$('#businesses input:checkbox').change(function(e) {
    if(this.checked) {
        var value = parseInt($(this).closest('td').next('td').text(), 10);
        // above will convert it from a string to an integer
    }
    else {
        // same as above? Seems redundant
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:27:58.697

您可以通过以下方式访问它：

```
$this.parent().next().text(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:26:07.097

父母的使用`siblings()`：

```
$this.closest('td').siblings().text(); 
```

如果这不是唯一的，其他`<td>` `siblings()`人会返回所有其余的，所以使用适当的选择器来过滤它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T16:34:06.733

尝试这个...

```
$("#businesses input:checkbox").on ('change', function (e)
        if ($(this).is(":checked")) {
            $( e.target ).closest("td").text();
        } else {
            //Here I want to read a value from a column in a row where is the checkbox 
        }
}); 
```

问候。

# sharepoint-2010 - Office365 Sharepoint、所有者帐户的权限问题

> ID：14630396
> 
> 赞同：0
> 
> 时间：2013-01-31T16:22:49.483
> 
> 标签：sharepoint-2010, permissions, office365

我刚刚负责监督 Office365 Sharepoint 团队网站，但最后一位管理员没有解决一个非常奇怪的遗留问题。我们有您希望看到的一组标准组（访问者、成员、所有者），这里的一个人同时属于成员（贡献）和所有者（完全控制）权限组。

然而，她接触事物的能力……很奇怪。她可以查看几乎所有内容，并向大多数内容（列表、表单等）添加新内容。但她无法编辑任何文档、列表项目等。她也无法删除项目。

有没有办法让她的权限（完全控制）与其他设置发生冲突？我应该寻找什么来进一步调查？

所有帮助将不胜感激，因为这是非常神秘的。

交叉列出在：[https ://sharepoint.stackexchange.com/questions/58306/permissions-issues-with-office365-sharepoint-owner-account](https://sharepoint.stackexchange.com/questions/58306/permissions-issues-with-office365-sharepoint-owner-account)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T13:36:25.730

您想查看有问题的文档库和列表，默认情况下它们继承权限，但这可以更改。选择库并从顶部功能区中选择权限图标以查看该特定用户对相关项目的权限。

# java - HibernateSearch 查询

> ID：14630399
> 
> 赞同：0
> 
> 时间：2013-01-31T16:22:58.560
> 
> 标签：java, hibernate, lucene, hibernate-search

我是hibernate Search的新手，我发现很难形成Hibernateserach查询。我需要使用 IN 运算符来 List the String in Hibernate query 。谁能帮我解决这个问题。我当前的查询看起来像这样

```
String querystring="country:"+profile.getCountry()+" AND religion:"+profile.getReligion()+"  AND caste:"+profile.getCaste()+" AND gender:"+profile.getGender()+"AND profession : "+professions+" AND age:["+profile.getFromage()+" TO "+profile.getToage()+"]" ; 
```

这里是专业是一个字符串列表。

问候， 阿伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T11:26:30.897

Lucene 查询语言中没有*IN运算符。*您必须自己扩展字符串。使用查询解析器的另一种方法是使用 Lucene *BooleanQuery*并将查询的不同部分添加到其中，例如*RangeQuery*等。QueryParser 在后台为您创建了这个较低级别的查询。查看 Lucene API 和*org.apache.lucene.search.Query*的不同子类。不过，您仍然必须自己扩展集合字符串。最后但同样重要的是，您可以使用 Hibernate Search 查询 DSL。如果您想了解更多信息，请查看 Hibernate Search 的在线文档 -[http://docs.jboss.org/hibernate/stable/search/reference/en-US/html_single/#search-query-querydsl](http://docs.jboss.org/hibernate/stable/search/reference/en-US/html_single/#search-query-querydsl)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-31T18:26:42.347

您需要将以下子句添加到查询 SELECT、FROM 和 WHERE。条件也缺少部分。例如这里是一个有效的查询。“从员工中选择 e，其中 e.country = :country 和 e.religion = :religion”...

# java - java.lang.ClassFormatError：无效的常量池索引 63

> ID：14630404
> 
> 赞同：2
> 
> 时间：2013-01-31T16:23:12.667
> 
> 标签：java, pool

我试图从 .jar 中提取一个 .class 文件，它可以工作，但后来我改变了一些东西，现在我得到了这个错误：

```
java.lang.ClassFormatError: Invalid constant pool index 63 
```

这是我的代码：

```
String path = new File(getClass().getProtectionDomain().getCodeSource().getLocation().getFile()).getAbsolutePath();
if (path.endsWith("."))
    path = path.substring(0, path.length() - 1);
String decodedPath = URLDecoder.decode(path, "UTF-8");

File file = new File(decodedPath + (decodedPath.endsWith("\\") ? "Classfile.class" : "\\Classfile.class"));

InputStreamReader read = new InputStreamReader(FileSync.class.getResourceAsStream("/Classfile.class"));
FileWriter write = new FileWriter(file);

int c;
while ((i = read.read()) > -1) {
    write.write(i);
}
write.flush();
read.close();
write.close();

ProcessBuilder builder = new ProcessBuilder(System.getProperty("java.home") + "\\bin\\java.exe", "Classfile", decodedPath + (decodedPath.endsWith("\\") ? "Program.jar" : "\\Program.jar"));
builder.directory(file.getParentFile());
Process process = builder.start(); 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:48:59.860

`InputStreamReader`并进行`FileWriter`隐式字节 <-> 字符转换。`FileInputStream`由于 java 类文件是二进制文件，因此通过和使用原始字节`FileOutputStream`。

可能，您可以使用十六进制编辑器并在写入前后打开类文件以验证新类文件中缺少/添加的内容。

# c# - WMI 远程连接，失败

> ID：14630406
> 
> 赞同：1
> 
> 时间：2013-01-31T16:23:15.537
> 
> 标签：c#, wmi, remote-access

## 已解决，如果any1需要它以供参考，已在其他线程中得到答案..

## 解释：

本地 WMI 工作，但现在我正在尝试远程进行。我已经尝试禁用两个防火墙，检查 WMI 权限（使用管理员帐户登录），这应该没问题。然而，当尝试连接 IP 时，我不断收到：0x800706BA 错误，但使用 PC 名称时，没有显示错误，但 WMI 没有显示任何结果。

Lansweeper 成功了。（[http://www.lansweeper.com/kb/3/WMI-Access-is-denied.html](http://www.lansweeper.com/kb/3/WMI-Access-is-denied.html)）

连接错误：managementScope.Connect() 处的 0x800706BA

> System.Runtime.InteropServices.COMException (0x800706BA)：RPC 服务器不可用。（来自 HRESULT 的异常：0x800706BA）在 System.Management.ManagementScope.Initialize() 的 System.Management.ThreadDispatch.Start() 在 System.Management.ManagementScope.Connect() 在 Admin_Helper.frmRemoteInformation.button1_Click(Object sender, EventArgs e)在 c:\Users\Stef\Documents\Visual Studio 2012\Projects\Admin_Helper\Admin_Helper\frmRemoteInformation.cs：System.Windows.Forms.Control.OnClick(EventArgs e) 处 System.Windows.Forms.Button.OnClick 的第 110 行(EventArgs e) 在 System.Windows.Forms.Button.OnMouseUp(MouseEventArgs 事件) 在 System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks) 在 System.Windows.Forms.Control.WndProc(Message& m) 在 System.Windows.Forms.ButtonBase。

-

## 问题：

检查连接是否成功/失败或其 wmi 以及如何修复它的最佳方法是什么。

```
 ManagementScope managementScope;
    ObjectQuery query;
    private void btnConnect_Click(object sender, EventArgs e)
    {
        try
        {
            ConnectionOptions remoteConnectionOptions = new ConnectionOptions();
            remoteConnectionOptions.Impersonation = ImpersonationLevel.Impersonate;
            remoteConnectionOptions.EnablePrivileges = true;
            remoteConnectionOptions.Authentication = AuthenticationLevel.Packet;
            remoteConnectionOptions.Username = txtUsername.Text;
            remoteConnectionOptions.Password = txtPassword.Text;

            managementScope = new ManagementScope(@"\\" + txtServer.Text + @"\root\CIMV2", remoteConnectionOptions);
            managementScope.Connect();
            MessageBox.Show("Connected");
        }
        catch (Exception ex) { MessageBox.Show(ex.Message); }

    }

    private void cmbClassSelection_SelectedIndexChanged(object sender, EventArgs e)
    {
            var dctPropertyList = new Dictionary<string, string>();
            query = new ObjectQuery(cmbClassSelection.SelectedItem.ToString());
            new Thread(() => FindWMI(managementScope, query, dctPropertyList, lstProperties)).Start();
    }
    private void FindWMI(ManagementScope scope, ObjectQuery query, Dictionary<string, string> dct, ListView listView)
    {
        try
        {
            List<ListViewItem> itemsList = new List<ListViewItem>();

            ManagementObjectSearcher moSearcher = new ManagementObjectSearcher(scope, query);
            Invoke(new MethodInvoker(() =>
            {
                listView.Items.Clear();
            }));

            foreach (ManagementObject moObject in moSearcher.Get())
            {
                if (moObject != null)
                {
                    foreach (PropertyData propData in moObject.Properties)
                    {
                        if (propData.Value != null && propData.Value.ToString() != "" && propData.Name != null && propData.Name != "")
                            dct[propData.Name] = propData.Value.ToString();
                    }
                }
            }
            foreach (KeyValuePair<string, string> listItem in dct)
            {
                ListViewItem lstItem = new ListViewItem(listItem.Key);
                lstItem.SubItems.Add(listItem.Value);
                itemsList.Add(lstItem);
            }

            Invoke(new MethodInvoker(() =>
            {
                listView.Items.AddRange(itemsList.ToArray());
            }));
        }
        catch (Exception) { }
    } 
```

## 更新：

问题似乎与 WMI 有关。

## 更新2：

. 有史以来最愚蠢的错误。不得不改变两件事：

1.  `remoteConnectionOptions.Username = txtUsername.Text; ==> remoteConnectionOptions.Username = txtServer.Text + @"\" + txtUsername.Text;` 这将给出：“服务器名称\用户名”

2.  查询 = 新 ObjectQuery(cmbClassSelection.SelectedItem.ToString()); ==> objectQuery = new ObjectQuery("select * from " + cmbClassSelection.SelectedItem.ToString());

因为我使用组合框，所以忘记了“select * from”。

万一有人需要代码，我会在清理一下之后更新它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:22:46.960

我自己想通了：

请务必检查防火墙和 WMI 设置...

好的，检查连接是否成功的一种方法是：

```
ManagementScope myscope = new ManagementScope(@"\\Server\Username", ConnectionOptions);

if (myscope.IsConnected) { MessageBox.Show("Connected"); } else { MessageBox.Show("Disconnected"); } 
```

现在您知道您的连接是否有效，然后只需搜索标准查询即可尝试并将其与您自己的代码进行比较...

示例：[msdn 上的示例](http://msdn.microsoft.com/en-us/library/ms257337%28v=vs.80%29.aspx)

## 完成代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Threading;
using System.Management;
using System.Diagnostics;

namespace Admin_Helper
{
public partial class frmRemoteInformation : Form
{
    public frmRemoteInformation()
    {
        InitializeComponent();
    }

    string strServername;
    string strUsername;
    string strPassword;
    string strClassSelection;
    ConnectionOptions rcOptions;
    ManagementObjectCollection moCollection;
    ObjectQuery oQuery;
    ManagementObjectSearcher moSearcher;
    ManagementScope mScope;

    private void frmRemoteInformation_Load(object sender, EventArgs e)
    {
        if (mScope.IsConnected == true) { lblConnectionStateWarning.Text = "Connected"; } else { lblConnectionStateWarning.Text = "Disconnected"; } //I have a label that displays connectionstate, you can leave that out
    }

    private void btnConnect_Click(object sender, EventArgs e)
    {
        try
        {
            strServername = txtServer.Text;
            strUsername = txtUsername.Text;
            strPassword = txtPassword.Text;

            remoteConnection(strServername, strUsername, strPassword);
        }
        catch (Exception ex) { MessageBox.Show(ex.Message); }

    }

    private void cmbClassSelection_SelectedIndexChanged(object sender, EventArgs e)
    {
            var dctPropertyList = new Dictionary<string, string>();
            strClassSelection = cmbClassSelection.SelectedItem.ToString();
            new Thread(() => FindWMI(strServername, strClassSelection, rcOptions, dctPropertyList, lstProperties)).Start();
    }

    private void remoteConnection(string servername, string username, string password)
    {
        try
        {
            rcOptions = new ConnectionOptions();
            rcOptions.Authentication = AuthenticationLevel.Packet;
            rcOptions.Impersonation = ImpersonationLevel.Impersonate;
            rcOptions.EnablePrivileges = true;
            rcOptions.Username = servername + @"\" + username;
            rcOptions.Password = password;

            mScope = new ManagementScope(String.Format(@"\\{0}\root\cimv2", servername), rcOptions);
            mScope.Connect();
            if (mScope.IsConnected == true) { MessageBox.Show("Connection Succeeded", "Alert"); } else { MessageBox.Show("Connection Failed", "Alert"); }
            if (mScope.IsConnected == true) { lblConnectionStateWarning.Text = "Connected"; } else { lblConnectionStateWarning.Text = "Disconnected"; } //I have a label that displays connectionstate, you can leave that out

        }
        catch (Exception ex) { MessageBox.Show(ex.Message); }
    }

    private void FindWMI(string servername, string classSelection, ConnectionOptions rcOptions, Dictionary<string, string> dct, ListView listView)
    {
        try
        {
            List<ListViewItem> itemsList = new List<ListViewItem>();
            oQuery = new ObjectQuery("select * from " + classSelection);
            moSearcher = new ManagementObjectSearcher(mScope, oQuery);
            moCollection = moSearcher.Get();

            Invoke(new MethodInvoker(() =>
            {
                listView.Items.Clear();
            }));

            foreach (ManagementObject mObject in moCollection)
            {
                if (mObject != null)
                {
                    foreach (PropertyData propData in mObject.Properties)
                    {
                        if (propData.Value != null && propData.Value.ToString() != "" && propData.Name != null && propData.Name != "")
                            dct[propData.Name] = propData.Value.ToString();
                    }
                }
            }

            foreach (KeyValuePair<string, string> listItem in dct)
            {
                ListViewItem lstItem = new ListViewItem(listItem.Key);
                lstItem.SubItems.Add(listItem.Value);
                itemsList.Add(lstItem);
            }

            Invoke(new MethodInvoker(() =>
            {
                listView.Items.AddRange(itemsList.ToArray());
            }));
        }
        catch (Exception) { }
    }

    private void frmRemoteInformation_FormClosed(object sender, FormClosedEventArgs e)
    {
        foreach (System.Diagnostics.Process myProc in System.Diagnostics.Process.GetProcesses())
        {
            if (myProc.ProcessName == "WmiPrvSE")
            {
                myProc.Kill();
            }
        }

        if (mScope.IsConnected == true) { mScope.Options.Authentication = AuthenticationLevel.None; }; //Change option so that the connection closes, no disconnect option
    }

}
} 
```

# c++ - C++ 重载运算符 +

> ID：14630408
> 
> 赞同：0
> 
> 时间：2013-01-31T16:23:20.653
> 
> 标签：c++, operator-overloading

我在网上找到了很多教程/片段，建议使用这种类型的重载：

`NumeroFarlocco operator+(NumeroFarlocco n1, NumeroFarlocco n2) { ... }`

但是如果我把这个定义放在我的 .h 文件中：

`NumeroFarlocco operator+(NumeroFarlocco n1, NumeroFarlocco n2);`

我有这个错误： http: [//msdn.microsoft.com/it-it/library/1zy85x1e (v=vs.80).aspx](http://msdn.microsoft.com/it-it/library/1zy85x1e(v=vs.80).aspx)

所以我发现我必须像这样定义重载：

```
NumeroFarlocco operator+( NumeroFarlocco n2 ); 
```

但在实现中，我无法理解如何访问操作中涉及的第一个元素的实例变量（我之前的代码中的 n1 元素），this->variable 不起作用，变量也不...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:26:17.800

有两种方法可以重载二元运算符：

*   作为班级成员
*   作为自由运营商

两者在不同的上下文中都有效：

```
struct A
{
    A operator+ (const A& other) const;
}; 
```

和

```
struct A
{};
operator+(const A& first, const A& second); 
```

*注意使用`const`.*

作为成员，要添加的两个对象是`*this`和`other`。第一个是隐式当前对象。

作为自由运算符，这两个对象是作为参数传递的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:25:53.050

```
NumeroFarlocco operator+(NumeroFarlocco n1, NumeroFarlocco n2) 
```

应该是一个out-of-class定义，也就是一个自由函数。

```
class NumeroFarlocco {
  // ...
};

NumeroFarlocco operator+(NumeroFarlocco n1, NumeroFarlocco n2) {
  // ...
} 
```

如果你使用`NumeroFarlocco operator+( NumeroFarlocco n2 );`它进入类定义。是的，`this`指针是您访问左侧值的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:54:28.927

我想稍微扩展一下 Luchian Grigore 的回答。正如他所说，从技术上讲，有两种定义二元运算符的方法。然而，在实践中，通常遵循一定数量的约定；特别是，返回新对象的二进制对象（如`operator+`）通常被定义为非成员，而那些修改左操作数（如 `operator+=`）的二进制对象通常被定义为成员。此外，经常使用修改对象的函数来定义返回对象的函数，例如：

```
MyType
operator+( MyType const& lhs, MyType const& rhs )
{
    MyType results( lhs );
    results += rhs;
    return results;
} 
```

事实上，我通常什至不编写返回值的函数。我编写了一个定义它们的基类模板，并从中派生：

```
template <typename DerivedClass>
class MathematicOperators
{
    friend DerivedClass
    operator+( DerivedClass const& lhs, DerivedClass const& rhs )
    {
        DerivedClass results( lhs );
        results += rhs;
        return results;
    }
    //  And so on for all of the binary operators...
};

class MyClass : MathematicOperators<MyClass>
{
    //  ...
    MyClass& operator+=( MyClass const& other )
    {
        //  modify *this...
        return *this;
    }
    //  ...
}; 
```

（注意这里的朋友`MathematicOperators`不是*为了*能够访问派生类的私有成员，而是为了能够在类模板中内联定义自由函数。）

我强烈建议遵循此程序。它将导致更少的代码，并将保证`+`并`+=` 具有预期的关系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T16:55:37.373

首先，您可能想阅读以下[教程](http://www.learncpp.com/cpp-tutorial/91-introduction-to-operator-overloading/)以了解有关如何重载运算符的一些基本规则。

从您的原始代码开始：

```
NumeroFarlocco operator+(NumeroFarlocco n1, NumeroFarlocco n2); 
```

这可能不是您真正想要声明的。您声明 operator+ 的方式取决于您想要实现的目标。

从你的问题假设，你想重载二进制+，所以你会这样做：

```
friend NumeroFarlocco operator+(NumeroFarlocco n1 , NumeroFarlocco n2 ); 
```

或者正如您在上面声明的那样：

```
NumeroFarlocco operator+( NumeroFarlocco n2 ); 
```

这两个声明的区别在于第一个是friend(free funcion)，而第二个是成员函数。

第一个（使用友元函数）意味着你不通过对象调用函数（它就像一个全局函数），第二个意味着你必须通过对象调用这个函数（就像你通常对成员函数所做的那样）。

另外，永远记住 operator 是一个函数。

```
NumeroFarlocco x, y, z; // suppose you have empty/default c'tor

x = y + z  is equivalent to x.operaotr=(y.operator+(z)) 
```

希望对你有帮助，辛迪加！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T16:26:50.203

这是两种不同的东西，

第一种方法：

```
NumeroFarlocco operator+(NumeroFarlocco n1, NumeroFarlocco n2); 
```

全局定义如何解释 + 运算符。

那确实意味着：

```
NumeroFarlocco n = operator+(n0,n2); 
```

至于第二个：

```
NumeroFarlocco operator+( NumeroFarlocco n2 ); 
```

定义如何解释一个到另一个的加法。

那是：

```
NumeroFarlocco n = n0.operator+(n1) 
```

# android - 如何在 MonoDroid 中向 Urban Airship 注册 APID

> ID：14630413
> 
> 赞同：1
> 
> 时间：2013-01-31T16:23:37.970
> 
> 标签：android, xamarin.android, urbanairship.com

我希望将推送通知添加到当前正在开发的应用程序中，Android 应用程序是使用 MonoDroid 构建的，我们正在使用 Urban Airship 进行推送通知。

是否有可用于 MonoDroid 的 Urban Airship 库，或者 Urban Airship 是否有可用于注册 APID 的 REST API？我们使用 iOS REST API ( [https://docs.urbanairship.com/display/DOCS/Server%3A+iOS+Push+API](https://docs.urbanairship.com/display/DOCS/Server%3A+iOS+Push+API) ) 为应用程序的 iOS 版本注册设备令牌。

让我知道是否有任何不清楚的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T03:07:12.590

看起来在[UrbanAirship-Android](https://github.com/bartsipes/UrbanAirship-Android)的 github 上有一个用于 android 库的单声道。

# c# - 使用 C# 和 SQL 在数据库中查找未使用的 ID

> ID：14630416
> 
> 赞同：0
> 
> 时间：2013-01-31T16:23:42.480
> 
> 标签：c#, sql

我正在尝试用 C# 编写一个简单的数据库管理工具。我正在编写一个将新行插入数据库的函数，但我遇到了一个问题。我需要能够检测哪些 ID 号尚未被使用。我做了一些研究，但没有找到任何明确的答案。

```
Example table:
ID    Name
---------------
1     John
2     Linda
4     Mark
5     Jessica 
```

如何添加一个自动检测 ID 3 为空并在那里放置新条目的函数？

**编辑：我真正的问题是；当我想通过 C# 插入新行时，如何处理自动递增的列？一个例子会很棒:)**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:27:06.110

我不喜欢给出这样的答案......但无论如何我都会在这个场合。

**别**

如果您将更多数据存储在另一个表中，该表中的 ID 具有外键，该怎么办？如果您重复使用数字，您将在后续的参考完整性方面遇到麻烦。

我假设你的领域是一个int？如果是这样，自动增量应该足以满足大多数用途。它使您的插入更简单，并保持完整性。

**编辑：**您可能有一个很好的理由这样做，但我想指出一点，以防有人出现并稍后看到这个认为这是个好主意的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:34:33.130

SQL：

```
SELECT ID From TABLE 
```

**或者**

```
SELECT  t.ID
FROM    ( SELECT    number + 1 AS ID
          FROM      master.dbo.spt_values
          WHERE     Type = 'p'
                    AND number <= ( SELECT  MAX(ID) - 1
                                    FROM    @Table
                                  )
        ) t
        LEFT JOIN @Table ON t.ID = [@Table].ID
WHERE   [@Table].ID IS NULL 
```

C＃

```
DataTable dt = new DataTable();
//Populate Dt with SQL
var tableInts = dt.Rows.Cast<DataRow>().Select(row => row.Field<int>("ID")).ToList<int>();
var allInts = Enumerable.Range(1, tableInts.Max()).ToList();
var minInt = allInts.Except(tableInts).Min(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:28:21.863

```
SELECT      #temp.Id
FROM        #temp
LEFT JOIN   table1 ON #temp.Id = table1.Id
WHERE       table1.Id IS NULL 
```

尝试这个？

但我的建议是，只需自动增加该字段。

你如何做到这一点，你将列的 IDENTITY 属性设置为 true，并将其设置为主键（非空）。

要处理插入，您可能需要触发器，它们类似于存储过程，但它们可以代替插入或更新或删除，或插入/更新/删除之前/之后

谷歌触发器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-02T17:29:45.957

来自[如何使用 SQL 在运行计数器中找到“差距”？](https://stackoverflow.com/questions/1312101/how-to-find-a-gap-in-running-counter-with-sql/17431748#17431748)

```
select
    MIN(ID)
from (
    select
        0 ID
    union all
    select
        [YourIdColumn]+1
    from
        [YourTable]
    where
        --Filter the rest of your key--
    ) foo
left join
    [YourTable]
    on [YourIdColumn]=ID
    and --Filter the rest of your key--
where
    [YourIdColumn] is null 
```

# android - Android：使用自定义适配器显示列表视图 - 过滤数组列表

> ID：14630417
> 
> 赞同：0
> 
> 时间：2013-01-31T16:23:48.470
> 
> 标签：android, android-listview, android-arrayadapter

我有一个特殊的问题。我正在解析一家餐馆的菜单卡。他们有英语和德语的。我有一个类 FoodItem 作为：

```
public class FoodItem {

private int foodClass;
    private String foodType;
    private String foodName;
    private String foodCost;
    private String hauptBeilage;
    private String salat;
} 
```

现在，我有一个使用 Jsoup 下载的 fooditems 的数组列表。我使用 . 分隔德语和英语菜单`String foodType`。

我想在开始时列出德语菜单。但是，我也将英文菜单附加到列表中。我应该如何解决这个问题？

我的下载线程（Jsoup）是：

```
public void run()
    {
        Log.i("downloadThread", "Inside run() - Starting getFoodItems");
        getDailyGerman(); 

        getDailyEnglish(); 

//Sending a message through handler here
            } 
```

在我的活动中，我有：

```
handler = new android.os.Handler() {
            @Override
            public void handleMessage(Message msg) {
                foodItemAdapter.notifyDataSetChanged();
            }
        }; 
```

如果我之后通过处理程序发送一条消息，`getDailyGerman();`我会`illegalstateexception`说适配器的内容已更改，但列表视图未更新。

我的适配器代码：

```
public FoodItemAdapter(Context context, int textViewResourceId, ArrayList<FoodItem> FoodItemArg) {
        super(context, textViewResourceId, FoodItemArg);
        FoodItemAdapter.foodItems = FoodItemArg;
        this.setNotifyOnChange(false);
        //      if(FoodItemAdapter.foodItems == null)
        //          Log.i("Adapter", "Problem Inside Adapter Constructor");
    }

    //=========================public methods============================

    public static ArrayList<FoodItem> getDailyEnglishFoodItems()
    {
        ArrayList<FoodItem> returnList = new ArrayList<FoodItem>();
        for(FoodItem eachItem : FoodItemAdapter.foodItems)
        {
            if(eachItem.getFoodClass() == 1)
            {
                Log.i("Adapter" , "Adding English Daily Food : " + eachItem.getFoodName());

                returnList.add(eachItem);
            }
        }

        return returnList;
    }

    public static ArrayList<FoodItem> getDailyGermanFoodItems()
    {
        ArrayList<FoodItem> returnList = new ArrayList<FoodItem>();
        for(FoodItem eachItem : FoodItemAdapter.foodItems)
        {
            if(eachItem.getFoodClass() == 2)
            {
                Log.i("Adapter" , "Adding German Daily Food : " + eachItem.getFoodName());
                returnList.add(eachItem);
            }
        }
        return returnList;
    }
@Override
    public View getView(int position, View convertView, ViewGroup parent) {
        /*
         * Describes each view in the list view.
         * Get the question and find the question text, timestamp and the votes.
         * Show them in the textview which is a part of the listview.
         */

        View v = convertView;
        FoodItem foodItem =(FoodItem) FoodItemAdapter.foodItems.get(position);
        if(foodItem == null)
        {
            Log.i("Adapter", "Null Food Item");
        }
        int colorPos = 0;

        if (convertView == null) {
            LayoutInflater inflater = (LayoutInflater)this.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = inflater.inflate(R.layout.fooditem_row, null);
            colorPos = position % colors.length;
        } 
```

请帮忙，因为我在这一点上被困了 3 天。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T11:44:08.623

根据我对您问题的理解，您希望将英语项目放在列表顶部，然后是德语项目。您可以使用 Collection.sort 方法并为手头的任务使用特定的比较器来做到这一点。

例如：

```
final List<FoodItem> combinedList  = getDailyGermanFoodItems();
combinedList.addAll(getDailyEnglishFoodItems());
Collections.sort(compinedList, new FoodItemComparator());
//then you call the handler to update the adapter and the listView
handler.post(new Runnable(){
        public void run(){
            FoodItemAdapter adapter = new FoodItemAdapter(activity.this, layout, combinedList);
            listView.setAdapter(adapter);   
}}); 
```

其中`FoodItemComparator`：

```
public class FoodItemComparatorimplements Comparator<FoodItem>{

    public int compare(FoodItem item1, item2) {

        String foodType1    = item1.getFoodType();
        String foodType2    = item2.getFoodType();
                    if (foodType1.equals(foodType2))
                        return 0;
                    if (foodType1.equals("English"))
                        return 1;
                    if (foodType2.equals("English))
                        return -1;
                    return foodType1.compareTo(foodType2);
    } 
```

}

假设 foodType 值保证仅为德语/英语。此外，您必须在 FoodItem 类中有一个 getter 函数，以便比较器可以访问它：

```
Class FoodItem
.......
public String getFoodType(){
        return foodType;
} 
```

**编辑** 如果您想单独显示每一个，则将两个列表存储在您的活动对象中，然后当用户选择一种语言（英语/德语）时：

```
FoodItemAdapter adapter = new FoodItemAdapter(activity.this, layout, germanList);
listView.setAdapter(adapter); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:53:17.730

添加项目并在 UI 线程问题中调用 notifyDataSetChanged() 后，我遇到了同样的问题

# java - 构造函数是未定义的，当它被明确定义时

> ID：14630420
> 
> 赞同：1
> 
> 时间：2013-01-31T16:23:54.680
> 
> 标签：java

我正在制作一个绘制原子衰变的程序。这是我的主要内容，它也执行逻辑。但是，当它在另一个类中明确定义时，我得到一个未定义的构造函数错误。为什么会这样？

注意：没有注明。饶了我你的怒火。

```
import java.util.Random;
import java.awt.*;
import javax.swing.*;
import javax.swing.JFrame;

public class Main {
    public static void main(String args[]) {
        int chance = 6;
        Random r = new Random();
        int num = 40;
        int[] decayed;
        int reps = 25;
        decayed = new int[reps];
        for (int j = 1; j < reps+1; j++) {
            for (int i = 0; i < num; i++) {
                int c = r.nextInt(chance);
                if (c == chance - 1) {
                    decayed[j]++;
                }
            }
            System.out.printf("\n Trial: " + j + "\n Number left: " + num
                    + "\n Decayed: " + decayed[j] + "\n\n");
            num = num - decayed[j];

        }
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.getContentPane().add(new Graph(decayed[])); //"Constuctor is undefined for type int" When I am clearly specifying an array.
        f.setSize(400,400);
        f.setLocation(200,200);
        f.setVisible(true);
    }
} 
```

还有我的 Graph.class。它是从某个论坛复制的（Credit to Creg Wood）。

```
import java.awt.*;
import javax.swing.*;
import java.util.*;
public class Graph extends JPanel
{
    int PAD = 20;
    boolean drawLine = true;
    boolean drawDots = true;
    int dotRadius = 3;

    // the y coordinates of the points to be drawn; the x coordinates are evenly spaced
    int[] data;
    public Graph(int points[]){ //This is the constructor which specifies type int[].
        for (int i = 0; i<points.length; i++){ //Copies points[] to data[]
            data[i] = points[i];
        }
    }

    protected void paintComponent (Graphics g)
    {
        super.paintComponent(g);
        Graphics2D g2 = (Graphics2D)g;
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        int w = getWidth();
        int h = getHeight();
        g2.drawLine(PAD, PAD, PAD, h-PAD);
        g2.drawLine(PAD, h-PAD, w-PAD, h-PAD);
        double xScale = (w - 2*PAD) / (data.length + 1);
        double maxValue = 100.0;
        double yScale = (h - 2*PAD) / maxValue;
        // The origin location
        int x0 = PAD;
        int y0 = h-PAD;

        // draw connecting line
        if (drawLine)
        {
            for (int j = 0; j < data.length-1; j++)
            {
                int x1 = x0 + (int)(xScale * (j+1));
                int y1 = y0 - (int)(yScale * data[j]);
                int x2 = x0 + (int)(xScale * (j+2));
                int y2 = y0 - (int)(yScale * data[j+1]);
                g2.drawLine(x1, y1, x2, y2);
            }
        }

        // draw the points as little circles in red
        if (drawDots)
        {
            g2.setPaint(Color.red);
            for (int j = 0; j < data.length; j++)
            {
                int x = x0 + (int)(xScale * (j+1));
                int y = y0 - (int)(yScale * data[j]);
                g2.fillOval(x-dotRadius, y-dotRadius, 2*dotRadius, 2*dotRadius);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T16:29:40.877

这里的问题是使用这些`[]`括号的使用。

尝试重新编写您的电话：

```
f.getContentPane().add(new Graph(decayed)); 
```

虽然您没有错，但请考虑重写您的构造函数以遵守 Java 标准和约定：

```
public Graph(int[] points){   // NOTE: I moved the [] to a the standard position
    for (int i = 0; i<points.length; i++){
        data[i] = points[i];
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T16:25:10.930

您的语法无效，要引用您的数组，只需使用变量名，不带`[]`：

```
f.getContentPane().add(new Graph(decayed)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T16:26:55.577

换这个就行了`f.getContentPane().add(new Graph(decayed[]));`

有了这个

`f.getContentPane().add(new Graph(decayed));`

只需使用您创建的变量的名称，而不使用`[]`.

这些`[]`括号仅在声明数组的方法参数时使用，而不是在调用方法时使用。

# asp.net - 如何在 ASP.NET MVC 单元测试中模拟 AutoMapper

> ID：14630422
> 
> 赞同：0
> 
> 时间：2013-01-31T16:23:59.343
> 
> 标签：asp.net, asp.net-mvc-4, unity-container, automapper

我在控制器中使用 AutoMapper 将我的模型对象映射到我的 ViewModel 对象。Unity 在我的控制器中注入了一个 IMappingEngine 对象，并且映射配置在 global.asax 中完成。

在我的控制器的单元测试中，我应该如何模拟在构造函数中作为参数传递的 IMappingEngine ？

我是否必须在单元测试项目中再次设置所有映射配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:08:52.940

如果您通过使用接口抽象 AutoMapper，那么您不必在单元测试中使用 AutoMapper。这是一个单元测试，因此您只测试控制器操作中的代码。您需要做的就是使用像 RhinoMocks 或 Moq 这样的模拟框架并模拟您的测试所需的行为。使用 RhinoMocks 你会得到这样的东西：

```
var mapper= MockRepository.GenerateStub<IMappingEngine>(); 
```

然后使用 mapper.Stub 添加您需要的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:28:38.057

为什么首先要注入 AutoMapper？

由于您的控制器（ViewModels）的输出取决于映射，您的测试应该测试什么？

我怀疑您的代码中有太多抽象。直接使用 AutoMapper 没有任何问题。

# multithreading - 将actor池的线程数限制为1

> ID：14630429
> 
> 赞同：1
> 
> 时间：2013-01-31T16:24:08.453
> 
> 标签：multithreading, scala, threadpool

在我的一个演员反应方法中，我通过执行以下操作输出线程池：

```
val scalaThreadSet = asScalaSet(Thread.getAllStackTraces().keySet());
scalaThreadSet.foreach(element => Console.println("Thread=" + element + ",state=" + 
                    element.getState())) 
```

我看到一堆线程：

```
Thread=Thread[ForkJoinPool-1-worker-6,5,main],state=WAITING
Thread=Thread[Signal Dispatcher,9,system],state=RUNNABLE
Thread=Thread[ForkJoinPool-1-worker-10,5,main],state=RUNNABLE
Thread=Thread[ForkJoinPool-1-worker-13,5,main],state=WAITING
Thread=Thread[ForkJoinPool-1-worker-7,5,main],state=WAITING
Thread=Thread[ForkJoinPool-1-worker-9,5,main],state=WAITING
Thread=Thread[ForkJoinPool-1-worker-14,5,main],state=WAITING 
```

我希望将线程池的大小减少到一个并且只看到一个线程，所以我传入：

所以我传入：

```
-Dactors.maxPoolSize=1 
```

作为VM参数。

我的期望是我现在应该只看到一个线程，但我仍然看到负载。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:44:21.770

**简短的回答**

尝试运行虚拟机

```
-Dactors.corePoolSize=1 
```

**解释**

是大多数运行 Java 1.6 或更高版本的操作系统的`ForkJoinScheduler`默认调度程序，它使用`DrainableForkJoinPool`under 来覆盖，据我所知，它忽略了该`maxPoolSize`属性。请参阅 的方法[`makeNewPool`](https://github.com/scala/scala/blob/42f34f61cefc8be17d13149703abc3e2547989ad/src/actors/scala/actors/scheduler/ForkJoinScheduler.scala#L40)和`ForkJoinScheduler`构造[函数](https://github.com/scala/scala/blob/42f34f61cefc8be17d13149703abc3e2547989ad/src/actors/scala/actors/scheduler/DrainableForkJoinPool.scala)。`DrainableForkJoinPool`

# sql-server - SQL Server Exam

> ID：14630431
> 
> 赞同：2
> 
> 时间：2013-01-31T16:24:11.280
> 
> 标签：sql-server

I am studying for the SQL Server Exam one test question is:

> *The `SpatialLocation` column in the `Person.Address` table of the `AdventureWorks2012` database uses the geography data type. You want to create a query that outputs the `AddressID` column with the contents of the `SpatialLocation` column as coordinates in longitude and latitude format.*

And the answer:

```
SELECT AddressID, CAST(SpatialLocation as VARCHAR(45)) as "LON/LAT" from Person.Address
SELECT AddressID, CONVERT(VARCHAR(45), SpatialLocation) as "LON/LAT" from Person.Address 
```

Just playing with code why wont the following work??

```
TRY_PARSE( SpatialLocation AS VARCHAR(45)) as "LON/LAT3" 
```

I get:

> *Invalid data type varchar in function `TRY_PARSE`*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:28:49.897

SpatialLocation has a `Geography` data type but `TRY_PARSE` takes a `nvarchar`.

```
TRY_PARSE ( string_value AS data_type ) 
```

Take a look here:

[http://msdn.microsoft.com/en-us/library/hh213126.aspx](http://msdn.microsoft.com/en-us/library/hh213126.aspx)

Good luck.

# c# - 从 C 和 C# 中的函数访问返回值

> ID：14630437
> 
> 赞同：-1
> 
> 时间：2013-01-31T16:24:28.733
> 
> 标签：c#, c++, c

我对 C/C++ 和 C# 中函数的返回值可用性的概念有疑问。我知道返回指向函数中创建的变量（局部变量）的指针是不正确的。在这种情况下，如果我想创建一个值数组（比如 int）并从函数返回这个数组，我该怎么做？而且，如果我直接返回一个局部变量（而不是通过指向它的指针），运行时何时回收为该变量分配的内存 - 是在返回的值分配给该值的接收者之后吗？

另一个相关问题是在 C# 中：在 C# 中使用“new”运算符在函数中创建的变量是在堆上创建的。在函数中创建局部变量的情况下是真的吗？如果返回的值是引用/地址，是不是违反了上面提到的规则（C++）？在 C# 中实现这一点的方式是什么？

我的问题可能看起来很幼稚，但我试图更好地理解编译器和运行时的行为。如果您能为我提供这些问题的答案，那将是非常有帮助的。

谢谢，拉克什。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:38:00.253

> 如果我想创建一个值数组（比如 int）并从函数返回这个数组，请使用 Blockquote 我该怎么做？

以下将在 C# 中执行此操作

```
public int[] Example(int size)
{

     int[] numbers = new int[size]; 
     return numbers;    

} 
```

> 而且，如果我直接返回一个局部变量（而不是通过指向它的指针），运行时何时回收为该变量分配的内存 - 是在返回的值分配给该值的接收者之后吗？

如果您没有返回指针，那么您只是返回了局部变量的副本。你问题的第二部分没有意义。

> 另一个相关问题是在 C# 中：在 C# 中使用“new”运算符在函数中创建的变量是在堆上创建的。在函数中创建局部变量的情况下是真的吗？

是的，它是在堆上创建的。

> 如果返回的值是引用/地址，是不是违反了上面提到的规则（C++）？在 C# 中实现这一点的方式是什么？

您不应该尝试将 C++ 与 C# 进行比较，因此不应回答此问题。此外......正在实现什么也不清楚。

> 我的问题可能看起来很幼稚，但我试图更好地理解编译器和运行时的行为。如果您能为我提供这些问题的答案，那将是非常有帮助的。

所有这些问题都在任何 C++ 或 C# 新手程序员的书中得到解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:36:35.597

我不确定你的问题是什么，但要返回一个整数数组，你需要为它分配不能被程序覆盖的内存，然后返回一个指向数组的指针，而不是数组本身：

```
int main(void)
{
    int *i; //integer pointer
    i = return_a_two_integer_array(); //i now points to the location in memory of the return value of return_a_two_integer_array();
    free(i); //the memory is no longer allocated and can be overwritten
}

int *return_a_two_integer_array
{
    int *two_integer_array;
    if(!(two_integer_array = malloc(sizeof(int)*2))) //allocate the memory
    {
        return 0x00; //memory allocation failed
    }
    two_integer_array[0] = 1;
    two_integer_array[1] = 2;
    return two_integer_array; //return the pointer 
} 
```

顺便说一句，这是在 C 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:39:19.127

> 如果我想创建一个值数组（比如 int）并从函数中返回这个数组，我该怎么做？

不同之处在于分配变量的位置。局部变量在堆栈中分配，而全局变量在堆中分配。您可以（在程序中的几乎任何地方）手动分配一些堆空间。这是由我的 malloc() （或类似的）或在内部调用 malloc() 的一些更高级别的函数完成的。当您使用 new 创建新对象时就是这种情况。

为了在 C 中返回一个数组，您必须使用堆：以*某种方式*分配一些堆空间（malloc() 或 new）并返回指向它的指针（显式或通过返回对象引用）

**在 C# 中，您将使用通用 List 或使用new**构造的数组。

如果您不使用 new 直接返回一个变量（例如返回类型为 int），则使用堆栈。当函数完成时，该值被写入代表调用者变量的寄存器。

# c# - Nhibernate：如何推迟更新或删除？

> ID：14630439
> 
> 赞同：0
> 
> 时间：2013-01-31T16:24:37.640
> 
> 标签：c#, wpf, database, hibernate, nhibernate

我需要帮助：我是 Nhibernate 的初学者。我创建了一个 wpf 应用程序，它加载与可观察集合绑定的数据网格。这个集合加载了存储库模式和 Nhibernate 查询数据库。我想用 UI 修改这个集合（编辑、添加、删除）。

当我单击**我的保存按钮**时，我想将我的更改保留到 db 表。我阅读了 nhibernate 文档，了解到有 2 级缓存，我的想法是修改一级缓存中的对象，当我确定我的更改时我想坚持。这样做有一些最佳实践吗？

**单击“保存更改”后**如何标记删除或更新对象并删除或更新它？****

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:49:34.673

这应该是一个有趣的阅读：[使用 NHibernate 构建桌面待办事项应用程序](http://msdn.microsoft.com/en-us/magazine/ee819139.aspx)

基本上，您应该使用`ISession`对象的方法，并在事务中进行操作，即`ISession.BeginTransaction()`

这取决于您如何获得实体。如果它们是根实体，例如员工，那么当您从网格中删除一个实体时，您应该跟踪这些已删除的实体并在所有这些实体上调用 delete。您还应该跟踪添加的实体。

然后基本上你剩下的是更新的实体。NH 跟踪状态并知道实体是否被修改。

我们有`ISession.Save/Update/Delete.`

当您为每个修改的实体完成此操作后，请在事务上调用 Commit。这会将更改保存到数据库中。

如果您的实体不是根，但例如是员工地址，那么在员工上调用 save 就足够了 - 如果您的映射是正确的。**

# jquery - 仅在 Chrome 中，添加 body 类时，DIV 标签的内部内容会溢出

> ID：14630441
> 
> 赞同：0
> 
> 时间：2013-01-31T16:24:55.133
> 
> 标签：jquery, css, drupal-7

**问题：**

此问题仅在 Chrome 中出现。

当我使用jQuery在body标签中添加一个类时，页面上有一个DIV标签，当新类添加到body时改变了它的样式，但是内部内容溢出了。当我刷新页面时，一切都以应有的方式组合在一起。

我已经在 IE 和 Firefox 中对此进行了测试，并且在两种浏览器中都可以正常工作，没有任何问题。

**描述：**

我正在使用 jQuery 向正文添加一个类：

```
$(document).load(function() {
  if (UNDER_CERTAIN_CONDITIONS) {
    $('body').addClass('some-new-class');
  }
}); 
```

然后我有一个样式表，可以相应地调整页面：

```
body.some-new-class div.requires-special-styling {
  /* ... */
} 
```

注意：我正在使用 Drupal 7 和 Bartik 主题的覆盖版本，以防有助于解决问题。

# node.js - node.js：找不到模块“它是”

> ID：14630443
> 
> 赞同：1
> 
> 时间：2013-01-31T16:24:59.550
> 
> 标签：node.js, unit-testing, module, require

我正在尝试运行[此](https://github.com/maxogden/conversationThreading-js/blob/master/jwz_test.js)node.js 单元测试，但出现此错误：

```
module.js:340
    throw err;
      ^
Error: Cannot find module 'it-is' 
```

从代码中可以明显看出，这个“it-is”模块是一个单元测试模块。即

```
var it = require('it-is');
...
it("Subject").equal(util.normalizeSubject("Re[2]:Subject")); 
```

然而，谷歌这样的框架几乎是不可能的，因为谷歌只是去掉了“it-is”部分。我搜索 node.js 单元测试找不到名为“it-is”的东西。

帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:26:45.647

看起来该项目缺少一个`package.json`文件来指定其依赖项。

因此，您需要自己安装它们：

```
npm install underscore
npm install it-is 
```

# php - php输出的奇怪的扩展ascii /非打印字符（字节顺序标记？）

> ID：14630444
> 
> 赞同：1
> 
> 时间：2013-01-31T16:24:59.673
> 
> 标签：php, utf-8, ascii

我继承了一个庞大的 php 站点。该站点在实时服务器上运行良好，但是我们有一个沙盒/QA 服务器可以在上面进行更改，并且在这个服务器上（几乎可以肯定有不同的 PHP 设置等）我看到在我想要的内容之前输出了一些奇怪的字符.

它们引起了许多问题，到目前为止，我已经通过使用`ob_start()`和`ob_clean_end()`在 php 脚本的开头，然后在我分别输出内容之前“修复”了它们。

但是，我现在遇到这个问题的次数太多了，以至于我无法继续进行下去。站点更改将于下周上线，沙盒/QA 服务器有可能成为实时服务器。如果发生这种情况，我想确保这个问题不会再次随机弹出。

有谁知道为什么带有 ASCII 码的字符（由`ord()`239、187 和 191 报告）。

它们似乎是 UTF-8 的字节顺序标记，但我不知道它们为什么在那里或如何防止它们在那里......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:29:50.987

UTF8 字节顺序标记由一些编辑器放置在 UTF8 编码文件中。它们不是必需的，因此解决问题的最佳方法是从文件中删除所有 BOM。

如果您有很多文件，最好使用脚本来自动化它。您可以在 google 上找到此类脚本的示例，例如[这个](http://thegreyblog.blogspot.fi/2010/09/shell-script-to-find-and-remove-bom.html)

# wordpress - wp侧边栏和页脚（小部件区域）消失了

> ID：14630451
> 
> 赞同：0
> 
> 时间：2013-01-31T16:25:18.877
> 
> 标签：wordpress, widget, footer, sidebar

我正在使用 wp-explorer 的[Adapt 主题](http://www.wpexplorer.com/adapt-free-responsive-wordpress-theme/)。虽然我已经做了很多 CSS 编辑，但直到最近一切正常。现在我的 wp 主题缺少侧边栏和页脚区域。例如[http://www.mipsmusic.com/media/](http://www.mipsmusic.com/media/)应该在右侧有一个侧边栏，在底部有一个页脚。在 wp-admin 区域中，小部件区域消失了。（仍然有小部件，但没有小部件区域可将小部件拖放到其中）

我努力了：

*   停用所有插件
*   检查 single.php 中的`<?php get_sidebar(); ?>`and`<?php get_footer(); ?>`和标签就在页面底部。
*   切换到二十一主题看看是不是主题问题。

每种情况下的结果都是相同的：后端没有侧边栏、没有页脚和小部件区域。

有没有人有什么建议？我需要手动进行全新的 wp 安装吗？如果是这样，有没有人知道一个很好的教程 - 我不想丢失我所有的编辑。

提前致谢！

更新：

我尝试了 wordpress 调试和小部件区域，我相信这是我的问题......但是我该怎么做才能解决这个问题？

致命错误：调用未定义的函数 dynamic_sidebar()

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:35:43.870

当您的侧边栏开始时，有一个致命的 PHP 错误。如果您查看页面的源代码（查看源代码），您可以看到这一点：

```
</article>
<!-- /post -->

<aside id="sidebar" class="clearfix"> 
```

那是你文件的最后。这些是最后几行。那就是发生致命错误的地方，它会停止页面的生成。您的主题或小部件中存在错误。启用[调试](http://codex.wordpress.org/Debugging_in_WordPress)，它应该会给你一个提示。编辑您的答案以包含该信息，我会尽力提供更多帮助。在那之前，这是我得到的最好的答案。

编辑：

您发布的未定义函数错误表明 WordPress 安装损坏，而不是小部件本身的问题。[`dynamic_sidebar`](http://codex.wordpress.org/Function_Reference/dynamic_sidebar)是 WordPress 的核心功能。它不应该真的是“未定义的”。`wp-includes`我建议将and文件夹重新上传`wp-admin`到您的站点。听起来您的文件丢失或损坏。

# java - 我使用 if/else 错误

> ID：14630454
> 
> 赞同：-3
> 
> 时间：2013-01-31T16:25:24.303
> 
> 标签：java, android, if-statement

> **可能重复：**
> [语法问题 IF ELSE (Java)](https://stackoverflow.com/questions/1496435/syntax-question-if-else-java)

我正在尝试制作一个计算器，如果在编辑框中没有输入任何值，它会显示一条消息。但它是FC的！很长一段时间后我正在制作应用程序，所以我很困惑。

```
private OnClickListener startListener = new OnClickListener() {
    public void onClick(View v) {               
        double a=0;
        double b=0;
        double c=0;
        EditText edit;
        EditText edit2;
        TextView edit3;
        String lname="";
        edit=(EditText)findViewById(R.id.edit);
        edit2=(EditText)findViewById(R.id.edit2);
        edit3=(TextView)findViewById(R.id.edit3); // everything defined above

        String editstr= edit.getText().toString(); // real work starts
        if(editstr.contentEquals(lname))
            edit3.setText("Enter value");
        else

        a=Double.parseDouble(edit.getText().toString()); // else add the stuff
        b=Double.parseDouble(edit2.getText().toString());
        c=a+b;
        edit3.setText(Double.toString(c));

    } }; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:27:48.323

在你的 if-else 周围加上括号，目前在 else 的情况下它只执行第一行，无论你的 if 通过还是失败，都会执行其他行。

```
if(editstr.contentEquals(lname)) {
    edit3.setText("Enter value");
} else {
    a=Double.parseDouble(edit.getText().toString()); // else add the stuff
    b=Double.parseDouble(edit2.getText().toString());
    c=a+b;
    edit3.setText(Double.toString(c));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:27:26.403

如所写，只有 the`a=Double.parseDouble(edit.getText().toString());`受 else 影响。如果你想要它的其余部分，请将块包围在`{}`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:28:52.047

它确实有效，只是永远不会触发。

你应该做

```
 if(editStr.isEmpty())
     editStr = "Enter value";
 else
 {
    //editStr.equals("someValue"); //test against some value
    //rest
 } 
```

# javascript - 为什么我的外部 javascript 文件不断重新加载？

> ID：14630462
> 
> 赞同：0
> 
> 时间：2013-01-31T16:25:45.367
> 
> 标签：javascript

我有一个显示表格数据的 jqGrid。当用户将鼠标悬停在网格内的超链接上时，我有一个 qTip2 弹出窗口显示一个小窗口。我注意到每次此弹出窗口显示信息时都会重新加载外部 javascript 文件。为显示此弹出窗口而调用的文件中未引用该脚本，并将加载该脚本以显示主页。

我看到文件被这种调用一遍又一遍地重新加载：

```
GET http://localhost:4111/Scripts/HelperScript.js?_=1359649163699
GET http://localhost:4111/Scripts/HelperScript.js?_=1359649165768 
```

等等...

有人可以让我了解为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:29:29.403

所以我只是仔细检查了一下，由于某种原因，我在正在加载的代码中调用了一个弹出窗口，该窗口也将引用我的脚本文件。

```
<script src="@Url.Content("~/Scripts/HelperScript.js")" type="text/javascript"></script> 
```

我假设因为它试图加载同一个 Javascript 文件的两个副本，所以它正在使用随机名称再次加载它以避免冲突？（从我的代码中删除上述引用已阻止脚本再次加载）

# android - 如何在 ScrollView 中启用缩放？

> ID：14630464
> 
> 赞同：1
> 
> 时间：2013-01-31T16:25:47.023
> 
> 标签：android, textview, zooming, scrollview

**如何启用放大`Scrollview`？**

这是一个很好地使用此功能并在 API9 及更多版本中工作的应用程序：

`zoomcontrol`2 秒后隐藏，无需用户交互。

![在此处输入图像描述](../Images/ad373cbb6498119595fb6af161e8b9e7.png)![在此处输入图像描述](../Images/7df039498727d53e0c1697c8453cdacd.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T17:10:35.207

[Waza_Be](https://stackoverflow.com/users/327402/waza-be)在他们的评论中提到了您所看到的视图**。`WebView`**

如果您想在 Android 中实现类似的功能，您可以使用`WebView`自己并将文本/图像等作为 HTML 代码添加到其中。请参阅[在 WebView 中构建应用程序](http://developer.android.com/guide/webapps/webview.html)。

如果您绝对必须使用`ScrollView`，**则必须创建自己的自定义实现**。

您可以有一个`RelativeLayout`包含 ScrollView 和`Buttons`用于放大和缩小的两个。拥有`Buttons`自己的`LinearLayout`with`orientation="horizontal"`并将其设置为与 parent 的右下角对齐`RelativeLayout`。

这会给你上方的浮动按钮`ScrollView`。

[然后，您可以使用此 StackOverflow 文章](https://stackoverflow.com/questions/3948934/synchronise-scrollview-scroll-positions-android)中给出的示例（不支持此类）来检测 上的点击`ScrollView`或滚动时的点击。`ScrollView``OnScrollListener`

当您检测到滚动/点击时，您可以将`Button`布局设置为**可见**，并在 2 秒后使用 a`Timer`或 a`Thread`休眠 2000 毫秒来移除可见性。

要实现缩放，您必须为每次**(+)**`TextView`单击增加字体大小，并为每次**(-)**单击减小字体大小。因为您可以类似地缩放以填充新大小。****`Bitmaps``Bitmap`****

 ****为您想要实现的目标付出了很多努力。尝试坚持`WebView`或寻找另一种方式来代表您的应用程序。****

# python - 在 Django init 上启动一个简单的 python 线程

> ID：14630467
> 
> 赞同：1
> 
> 时间：2013-01-31T16:25:55.860
> 
> 标签：python, django, python-2.7

我刚刚开始使用 django。在我的开发环境中，我使用以下方法启动 django 服务器：

```
python manage.py runserver 0.0.0.0:8000 
```

并且我的 Web 应用程序按预期工作，但我也有很多错误......但到目前为止，我想在服务器初始化上运行一个后台线程，我需要一些指导。

这是我要添加的线程代码：

```
def synchronized(L):
    def lock_around(f):
        def locked(*a, **k):
            with L:
                return f(*a, **k)
        locked.__name__ = f.__name__
        locked.__doc__ = f.__doc__
        return locked
    return lock_around

class ProcessMsgQueue:

    def __init__(self):
        try:
            print "jaojdajdoaj"
            self.dataCounter = 0
            self.errorCounter = 0
            self.setupQueueTable()
            self.wrapperFuns = structureWrapper.WrapperClass()
            msgStruct = MsgStruct()
            self.VerifyMsgQueue()
        except:
            raise

    def setupQueueTable(self):
        self.hash_object = QueueHandler("queue_details")
        self.hash_object.EnableListener()
        self.hash_object.createNewHashRef()
        self.hash_object.create("dataMsgQueue")
        self.hash_object.create("errorMsgQueue")

    @synchronized(lock)     
    def pendMessage(self):
        print "pendMsg"
        try:
            res_mq = posix_ipc.MessageQueue(RESPONSE_QUEUE_NAME)
            res_msg = None
            res_msg,t_size = res_mq.receive()
            #print res_msg.encode('hex')
            return res_msg
        except Exception as e:
            print e
            raise
        finally:
            res_mq.close()

    def VerifyMsgQueue(self):
        while(self.hash_object.Queuelisten):
            try:
                posixQueueMessage=self.pendMessage()
                if not posixQueueMessage == None:
                    msgStruct = None
                    msgStruct = MsgStruct()
                    self.wrapperFuns.memCopy(posixQueueMessage,msgStruct)
                    if(msgStruct.msgType == palMsgType["DOOR_OPEN_INSERVICE_MSG"]):
                        print "Added Error to hastable"
                        self.hash_object.set("errorMsgQueue",self.errorCounter,msgStruct.msgBuf)
                    else:
                        print "Added Data to hastable"
                        self.hash_object.set("dataMsgQueue",msgStruct.msgType,msgStruct.msgBuf)
                    posixQueueMessage=None
            except:
                raise 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:47:39.253

Try to call your init code from end of `wsgi.py` file. It will be executed once at start of server.

# python - 我可以使用“函数”类创建函数吗？

> ID：14630472
> 
> 赞同：2
> 
> 时间：2013-01-31T16:26:16.227
> 
> 标签：python, python-3.x

我想知道，只是为了好玩，如果我可以使用*函数*类构造函数创建函数，即没有语言构造*def*，就像通过实例化类型对象创建类一样。我知道，函数构造函数需要 2 个参数 - 代码对象和全局变量。但我不知道我应该如何正确**编译**源代码。

```
>>> def f(): 
...     pass

>>> Function = type(f) 
>>> Function
<class 'function'>
>>> code = compile("x + 10", "<string>", "exec")
>>> f = Function(code, globals())
>>> f()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<string>", line 1, in <module>
NameError: name 'x' is not defined
>>> f(20)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: <module>() takes 0 positional arguments but 1 was given 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T16:53:22.610

您需要在代码对象上设置许多属性，例如 co_varnames、co_nlocals 等。显然有效的是

```
code = compile("def foo(n):return n+10", "<string>", "exec").co_consts[0]
func = Function(code, globals()) 
```

但我想这会被认为是作弊。要真正从头开始定义代码对象，请执行（对于 3.3）

```
code = types.CodeType(1, 0, 1, 2, 67, b'|\x00\x00d\x01\x00\x17S', (None, 10), 
                      (), ('x',), '<string>', 'f', 1, b'\x00\x01')
func = Function(code, globals())
print(func(10)) 
```

当然，这需要您自己完成整个 compile() 操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:36:55.807

好吧，这行得通：

```
>>> x = 0
>>> def f(): pass
... 
>>> func = type(f)
>>> code = compile("global x\nx += 10","<string>","exec")
>>> nf = func(code,globals())
>>> nf()
>>> x
10 
```

不过，不知道如何将参数传递给函数。

# c# - Automapper DynamicMap 无法映射匿名类型列表

> ID：14630473
> 
> 赞同：5
> 
> 时间：2013-01-31T16:26:16.507
> 
> 标签：c#, automapper, anonymous-types

我有以下代码片段。

```
var files = query.ToList();
var testFile = Mapper.DynamicMap<EftFileDto>(files.First());
var filesDto = Mapper.DynamicMap<List<EftFileDto>>(files); 
```

`testFile`具有正确映射的值，但 filesDto 为空。

似乎 dynamicMap 适用于单个项目，但不适用于列表？

`files`是一个匿名对象列表。

**编辑**：如果我使用数组也不起作用。我可以让它工作，但是...

```
 var filesDto = query.Select(Mapper.DynamicMap<EftFileDto>).ToList(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T08:02:16.397

> 在大多数映射场景中，我们在编译时就知道要映射到的类型。在某些情况下，源类型直到运行时才知道，尤其是在我使用动态类型的场景或可扩展性场景中。
> 
> DynamicMap 调用为传入指定目标类型的源对象的类型创建配置。如果这两种类型已经被映射，AutoMapper 会跳过这一步（因为我可以在这个例子中多次调用 DynamicMap）。

资料来源： http: [//lostechies.com/jimmybogard/2009/04/15/automapper-feature-interfaces-and-dynamic-mapping/](http://lostechies.com/jimmybogard/2009/04/15/automapper-feature-interfaces-and-dynamic-mapping/)

较短的版本：**DynamicMap**与调用**CreateMap**然后**Map**相同。

一些虚拟的 Person 类

```
public class Person
    {
        public string Name { get; set; }
        public string Surname { get; set; }
        public int Age { get; set; }
    } 
```

假设您有一个人员列表。

```
var persons = new List<Person>();
for (int i = 0; i < 100; i++)
{
      persons.Add(new Person { 
                Name = String.Format("John {0}", i), 
                Surname = String.Format("Smith {0}", i), 
                Age = i });
} 
```

然后，您选择添加新属性的人员。

```
var anonymousTypes = persons.Select(p => new { 
            p.Name, 
            p.Surname, 
            FullName = String.Format("{0}, {1}", p.Surname,p.Name) }).ToList(); 
```

正确映射第一人称

```
var testFile = Mapper.DynamicMap<Person>(anonymousTypes.First()); 
```

要正确映射您将使用的所有人

```
var testFiles  = anonymousTypes.Select(Mapper.DynamicMap<Person>).ToList(); 
```

# entity-framework-5 - 规范模式和实体框架

> ID：14630478
> 
> 赞同：2
> 
> 时间：2013-01-31T16:26:28.473
> 
> 标签：entity-framework-5, specifications, generics

```
public interface IEntite
{
   int Id { get; set; }
   string NomEntite { get; }
}

public class SpecIdEntite<TEntite> : CompositeSpecification<TEntite> where TEntite : IEntite
{
   private int _id;
   public SpecIdEntite(int id)
   {
      _id = id;
   }

  public override Expression<Func<TEntite, bool>> IsSatisfiedBy()
  {
     return candidate => (candidate != null && candidate.Id == _id);
  }
} 
```

当我尝试这个规范时，我得到了这个错误：“无法将类型'类型名称'转换为类型'X'。LINQ to Entities 仅支持转换实体数据模型原始类型。”

有人知道如何实现这个概念吗？

我所有的实体都有一个 Id 属性，我想使用通用规范

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:28:58.760

我不知道确切原因，但唯一缺少的是`class`对类型的约束。这应该有效：

```
public interface IEntite
{
   int Id { get; set; }
   string NomEntite { get; }
}

public class SpecIdEntite<TEntite> : CompositeSpecification<TEntite> where TEntite : class, IEntite
{
   private int _id;
   public SpecIdEntite(int id)
   {
      _id = id;
   }

  public override Expression<Func<TEntite, bool>> IsSatisfiedBy()
  {
     return candidate => (candidate != null && candidate.Id == _id);
  }
} 
```

`class`约束指定类型类型必须是引用类型，如此处[所述](http://msdn.microsoft.com/en-us/library/d5x73970%28v=vs.110%29.aspx)。

# sql - 如何使用 SQL 将属性添加到存储为来自同一行中的其余列的字段的现有 xml 字符串

> ID：14630479
> 
> 赞同：2
> 
> 时间：2013-01-31T16:26:29.493
> 
> 标签：sql, sql-server, xml

我的问题很难解释，所以让我给你一个视觉效果。首先，我有这个观点可以使用： ![SQL 视图](../Images/57c8b59bebee2ff2fdf1a6ab8751c4fd.png)

我在`AuditValue`专栏中有 XML。我想将所有其他列作为属性添加到 XML 列。所以我的第一行看起来像这样：

```
<row ManufacturerID="6" 
     ManufacturerName="AMES999" 
     IsDeleted="0" Concurrency="AAAAAAABTAk=" 
     EntryID="1" 
     TableName="Manufacturers" 
     AuditDate="2013-01-30 15:48:24.69" ChangeType="U"/> 
```

我想动态地做到这一点。从语义上讲，我的意思是：对于视图中除 AuditValue 列之外的每一列，将该列作为属性添加到 AuditValue 列 XML。

在大多数情况下，我是 SQL 愚蠢的。我知道基础知识，但仅此而已。帮助将不胜感激。我可以或需要提供的任何更多信息，请告诉我。我很乐意提供任何需要的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:39:59.967

我发现无法将属性添加到查询中的现有节点。您当然可以从您的表中创建一个临时表并修改临时表中的 XML，一次添加一个属性。

另一种选择是接受这很难的事实，并决定要构建一个包含所有数据但不是以您想要的确切方式的 XML。例如这个查询。

```
select *
from YourTable
for xml raw 
```

会给你这样的XML。

```
<row EntryID="1" TableName="Manufacturers" AuditDate="2013-01-30T15:48:24.690" ChangeType="U">
  <AuditValue>
    <row ManufacturerID="6" ManufacturerName="AMES999" IsDeleted="0" Concurrency="AAAAAAABTAk=" />
  </AuditValue>
</row> 
```

或者你可以使用这个

```
select EntryID as '@EntryID',
       TableName as '@TableName',
       AuditDate as '@AuditDate',
       ChangeType as '@ChangeType',
       AuditValue as '*'
from YourTable
for xml path('row') 
```

获取 XML

```
<row EntryID="1" TableName="Manufacturers" AuditDate="2013-01-30T15:48:24.690" ChangeType="U">
  <row ManufacturerID="6" ManufacturerName="AMES999" IsDeleted="0" Concurrency="AAAAAAABTAk=" />
</row> 
```

如果您准备好让这个变得非常丑陋，您可以尝试结合使用 XML 和字符串操作。

```
select cast(replace(cast(AuditValue as nvarchar(max)), '/>', '') +
       stuff(cast((
                  select EntryID, TableName, AuditDate, ChangeType
                  for xml raw, type
                  ) as nvarchar(max)) ,1 , 4, '') as xml) as AuditValue
from YourTable 
```

结果：

```
<row ManufacturerID="6" 
     ManufacturerName="AMES999" 
     IsDeleted="0" 
     Concurrency="AAAAAAABTAk=" 
     EntryID="1" 
     TableName="Manufacturers" 
     AuditDate="2013-01-30T15:48:24.690" 
     ChangeType="U" /> 
```

[SQL小提琴](http://sqlfiddle.com/#!6/0cfcd/2)

# objective-c - 如何在符号化崩溃报告中获取行号而不是行偏移？

> ID：14630480
> 
> 赞同：3
> 
> 时间：2013-01-31T16:26:31.303
> 
> 标签：objective-c, symbolicatecrash

我有一个问题困扰了我一段时间。对于我们的符号化崩溃报告，对于我们拥有源代码的内部框架，符号化崩溃报告通常具有偏移量而不是行号。例如，符号化报告具有：

```
*AppName*   0x0025b0b2 -[*AppSpecificClass AppSpecificMessage*:] + 682 
```

当我们想要：

```
*AppName*   0x001c444d __39-[*AppSpecificClass AppSpecificMessage*] (*AppSpecificClass*.m:145) 
```

我尝试了一堆不同的构建设置排列，但我无法让它始终如一地工作（我们确实获得了崩溃某些部分的行号）。

感谢您的帮助，罗布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-14T12:44:36.263

你用的是什么工具？

通过 dwarfdump 在这里工作正常

```
7   MyApp                           0x0004e4d1 -[MyClassInstance myFunc] (in MyApp) 'MyModule.mm' line 100, column 9 with start address 0x000000000004e4a3 
```

# vim - 为什么不能将变量传递给 MacVim :colorscheme 函数？

> ID：14630490
> 
> 赞同：0
> 
> 时间：2013-01-31T16:26:50.703
> 
> 标签：vim, macvim

我想设置一个映射来循环遍历 MacVim 中的颜色方案列表。

理想情况下，我会有一系列这样的配色方案：

```
let s:schemes = ['zellner','ron','morning','murphy','peachpuff','torte'] 
```

并在函数中将颜色方案设置为此数组的索引：

```
colorscheme s:schemes[s:schemeindex] 
```

但是，上面的这条线不起作用。为什么？

相反，我使用了一个很好的解决方法：

```
function SwitchScheme()
    if s:schemeindex == 0
        colorscheme zellner
        s:schemeindex = 1
    elseif s:schemeindex == 1
        colorscheme ron
        s:schemeindex = 2
    ...
    endif
endfunction 
```

我的问题是，有没有更清洁的方法来做到这一点？我想将一个变量传递给颜色方案设置器函数，但这似乎不起作用。

这些方案名称是常量吗？如果是，如何将它们分配给变量？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T02:36:20.493

`:colorscheme`只是受到限制，就像其他一些，例如`:source`，因为它从字面上获取该行的其余部分，即它不能使用 VimL 表达式作为参数。这个限制通常可以通过使用来解决`:execute`，例如

```
execute 'colorscheme '.s:mycolors[current] 
```

这来自[Vim Tips wiki 上发布的一个配色方案切换器](http://vim.wikia.com/wiki/VimTip341)。

# salesforce - Web 选项卡内的站点在 IE 中无法正常工作

> ID：14630494
> 
> 赞同：0
> 
> 时间：2013-01-31T16:27:04.393
> 
> 标签：salesforce, visualforce

通过指向某个特定 URL 创建一个 Web 选项卡。它在 FF 和 Chrome 中都非常好用。但 IE 不想让我登录。但是我可以很好地在 Salesforce 之外使用这个站点。

我尝试创建 VF 页面并将 iframe 指向相同的 URL - 同样的情况。

也许还有其他选择可以实现我的目标？

# java - 蜂窝 XML 解析错误

> ID：14630497
> 
> 赞同：1
> 
> 时间：2013-01-31T16:27:08.750
> 
> 标签：java, android, xml-parsing, android-3.0-honeycomb, stringbuilder

我有一个正在解析的 XML 文件`DocumentBuilder`，它可以在手机上正确解析，但平板电脑会引发异常。我一直在阅读，有人建议使用 a `AsyncTask`，我已经实现了它，但它仍然没有解析。有谁知道这个问题或需要做些什么来解决它。下面是我的代码。

异步任务

```
@Override
protected void onCreate(Bundle savedInstanceState) {
DownloadWebPageTask task = new DownloadWebPageTask();
task.execute(new String[] { "url" });
}
 private class DownloadWebPageTask extends AsyncTask<String, Void, String> {
    @Override
    protected String doInBackground(String... urls) {
        //String response = "";
        for (String url : urls) {
            HttpClient httpclient = new DefaultHttpClient();
            HttpGet httpget = new HttpGet(url);

            HttpResponse responseGet = null;
            try {
                responseGet = httpclient.execute(httpget);
                final int status = responseGet.getStatusLine().getStatusCode();
                if (status != HttpStatus.SC_OK) {
                    // give message
                //  Log.i("Error", "No Connection");
                }
            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                  e.printStackTrace();
                  //Log.i("caught error","ClientException");
            } catch (IOException e) {
                // TODO Auto-generated catch block
                  e.printStackTrace();
                //  Log.i("caught error","IOException");
            }
            //String responseBody = null;
            try {
                responseBody = EntityUtils.toString(responseGet.getEntity());
            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                  e.printStackTrace();
                //  Log.i("caught error","ClientException");
            } catch (IOException e) {
                // TODO Auto-generated catch block
                  e.printStackTrace();
                //  Log.i("caught error","IOException");
            }
        }

        return responseBody;
        } 
```

这就是我所说的：

```
 @Override
    protected void onPostExecute(String result) {
    //  Log.i("returndata",result);

          ArrayList<String> custCount = new ArrayList<String>();
          ArrayList<String> custMinMax = new ArrayList<String>();
          ArrayList<String> hexcode = new ArrayList<String>();
          List<HashMap<String, String>> colorData = new LinkedList<HashMap<String, String>>();

          try {
              DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
              DocumentBuilder db = dbf.newDocumentBuilder();
             //encode the xml to UTF -8
              ByteArrayInputStream encXML = new ByteArrayInputStream(result.getBytes("UTF8"));

              Document doc = db.parse(encXML);
              doc.getDocumentElement().normalize();
              Log.i("XML parsing OK","ok");
       try { 
              NodeList nodeList = doc.getElementsByTagName("Section");
              NodeList nameList = null;
              for (int cc = 0; cc < nodeList.getLength(); cc++) {

                  Node custcountNode = nodeList.item(cc);

                  Element custcountElement = (Element) custcountNode;
                  NodeList custcountList = custcountElement
                          .getElementsByTagName("custcount");
                  Element custcountnameE = (Element) custcountList.item(0);
                  custcountList = custcountnameE.getChildNodes();

                  custcount = ((Node) custcountList.item(0))
                          .getNodeValue();
                  custCount.add(new String(custcount));

              }

              for (int i = 0; i < nodeList.getLength(); i++) {
                  rectOptions = new PolygonOptions();
                  Node node = nodeList.item(i);

                  Element locElement = (Element) node;
                  nameList = locElement
                          .getElementsByTagName("coords");

                  int curCustCount = Integer.valueOf(custCount.get(i));

                  for (int z = 0; z < colorData.size(); z++) {
                      int custmin = Integer.valueOf(colorData.get(z).get(
                              "custmin"));
                      int custmax = Integer.valueOf(colorData.get(z).get(
                              "custmax"));

                      if (curCustCount >= custmin && curCustCount <= custmax) {
                          curColor = (colorData.get(z).get("hexcode"));

                          break;
                      }

                  }

                  points = new ArrayList<String[]>();

                  for (int j = 0; j < nameList.getLength(); j++) {

                      Node nodel = nameList.item(j);

                      Element fstElement = (Element) nodel;

                      NodeList nameL = fstElement.getElementsByTagName("coords");
                      Element nameE = (Element) nameL.item(0);

                      nameL = nameE.getChildNodes();

                      String latit = ((Node) nameL.item(0)).getNodeValue();

                      String[] latt = latit.split(",");

                      points.add(latt);
                 }
                     // Do something here with points

          }
                    } 
                      catch (Exception e){
                      e.printStackTrace();

                 }
          }  
                   catch (Exception e) {
                   e.printStackTrace();
           }
    } 
```

这是我的格式`XML`

```
 <Section>
    <custcount>3</custcount>
    <location>
       <coords>35.25010,-90.08342</coords>
       <coords>35.29177,-90.08342</coords>
       <coords>35.29177,-90.04175</coords>
       <coords>35.25010,-90.04175</coords>
       <coords>35.25010,-90.08342</coords>
   </location>
 </Section>
<Section>
    <custcount>3</custcount>
    <location>
       <coords>35.25040,-90.08342</coords>
       <coords>35.29477,-90.08342</coords>
       <coords>35.29477,-90.04173</coords>
       <coords>35.25010,-90.04175</coords>
       <coords>35.25010,-90.08342</coords>
   </location>
 </Section> 
```

这是我的堆栈跟踪结果：

```
 01-31 09:50:07.541: W/System.err(21462): java.lang.NullPointerException
  01-31 09:50:07.541: W/System.err(21462):  at com.mlgw.map.MainActivity2$DownloadWebPageTask.onPostExecute(MainActivity2.java:381)
  01-31 09:50:07.541: W/System.err(21462):  at com.mlgw.map.MainActivity2$DownloadWebPageTask.onPostExecute(MainActivity2.java:1)
  01-31 09:50:07.541: W/System.err(21462):  at android.os.AsyncTask.finish(AsyncTask.java:590)
  01-31 09:50:07.541: W/System.err(21462):  at android.os.AsyncTask.access$600(AsyncTask.java:149)
  01-31 09:50:07.541: W/System.err(21462):  at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:603)
  01-31 09:50:07.541: W/System.err(21462):  at android.os.Handler.dispatchMessage(Handler.java:99)
  01-31 09:50:07.541: W/System.err(21462):  at android.os.Looper.loop(Looper.java:132)
  01-31 09:50:07.541: W/System.err(21462):  at android.app.ActivityThread.main(ActivityThread.java:4129)
  01-31 09:50:07.551: W/System.err(21462):  at java.lang.reflect.Method.invokeNative(Native Method)
  01-31 09:50:07.551: W/System.err(21462):  at java.lang.reflect.Method.invoke(Method.java:491)
  01-31 09:50:07.551: W/System.err(21462):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:855)
  01-31 09:50:07.551: W/System.err(21462):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:613)
  01-31 09:50:07.551: W/System.err(21462):  at dalvik.system.NativeStart.main(Native Method) 
```

看起来发生在第 381 行，这是我的坐标，它在手机上运行良好，但在平板电脑上获得空值。

任何需要添加或更改的建议将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:30:50.910

我找到了解决我的问题的方法。我基本上不得不重做存储数据的循环。不知道为什么原来的方式适用于手机而不是平板电脑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T12:10:42.097

节点节点 = ProfileNode.item(gd);

NodeList nodeList = node.getChildNodes();

字符串名称 = ((Node) (nodeList).item(0)).getNodeValue();

# java - 使用 ListActivity 时强制关闭应用程序和 ActivityNotFoundException

> ID：14630499
> 
> 赞同：2
> 
> 时间：2013-01-31T16:27:13.020
> 
> 标签：java, android, android-intent

我正在关注一个 youtube 教程来创建 android 应用程序。在其中一个教程中，他们讲述了如何使用 List 活动创建 Menu 类。

```
public class Menu extends ListActivity {

String classes[] = {"Start","example1","example2","example3","example4","example5","example6"};

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setListAdapter(new ArrayAdapter<String>(Menu.this, android.R.layout.simple_list_item_1, classes));
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    // TODO Auto-generated method stub
    super.onListItemClick(l, v, position, id);
    String cheese = classes[position];
    try{
        Class ourClass = Class.forName("com.example.add." + cheese);
        Intent ourIntent = new Intent(Menu.this,ourClass);
        startActivity(ourIntent);
    }catch(ClassNotFoundException e){
        e.printStackTrace();
    }
} 
```

并在清单中添加活动。

```
<activity
        android:name=".Splash"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <activity
        android:exported="false"
        android:name=".Menu"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MENU" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>

    <activity
        android:exported="false"
        android:name="com.example.add.Start"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.example.add.START" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity> 
```

我的项目有一个 Start 类，它向计数器添加一个并显示它，一个 Splash 类，它定义背景图像、音乐，它是主类。在添加 Menu 类之前，我的应用程序运行良好，但是在我添加它之后，我的应用程序开始强制关闭，并且 logcat 在第 28 行的 Splash 类中显示了 ActivityNotFoundException 和错误

```
public class Splash extends Activity{

MediaPlayer ourSong;

@Override
protected void onCreate(Bundle Dab) {
    // TODO Auto-generated method stub
    super.onCreate(Dab);
    setContentView(R.layout.splash);
    ourSong = MediaPlayer.create(Splash.this, R.raw.nodebeat);
    ourSong.start();
    Thread timer = new Thread(){
        public void run(){   //framework to start a new thread
            try{
                sleep(5000);
            }catch(InterruptedException e){
                e.printStackTrace();
            }finally{
                Intent openStart = new Intent("com.example.add.MENU");
                startActivity(openStart);
            }
        }
    };
    timer.start();
}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    ourSong.release();
    finish();
} 
```

所以请帮助我是 android 应用程序开发的新手，我在这里感到震惊。Logcat 日志的链接：- [https://docs.google.com/file/d/0BxLaXhL-q50-MHlhUW93SmxNT0U/edit](https://docs.google.com/file/d/0BxLaXhL-q50-MHlhUW93SmxNT0U/edit "调试日志")调试日志 [https://docs.google.com/file/d/0BxLaXhL-q50-b1pzbVpIcVNQR2s/编辑](https://docs.google.com/file/d/0BxLaXhL-q50-b1pzbVpIcVNQR2s/edit "错误日志")错误日志

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:30:06.680

您对尝试启动的内容使用了错误的意图过滤器。所以要么改变

```
 <action android:name="android.intent.action.MENU" /> 
```

至

```
 <action android:name="com.example.add.MENU" /> 
```

让一切都匹配。

**或者**在代码中更改您的调用，使其成为：

```
Intent openStart = new Intent("android.intent.action.MENU"); 
```

您应该阅读有关[Intent Filters](http://developer.android.com/guide/components/intents-filters.html)的信息。

您也可以使用显式 Intent，因为您没有导出此 Activity 并且您知道它的名称，所以我认为不需要 Intent 过滤器。

```
Intent openStart = new Intent(Splash.this, Menu.class);
startActivity(openStart); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:31:46.277

下面两个（1 和 2）地方的意图动作应该是相同的，但不是。使它们相同。

```
 <intent-filter>
        <action android:name="android.intent.action.MENU" />// (1)

        <category android:name="android.intent.category.DEFAULT" />
    </intent-filter> 
```

和

```
 Intent openStart = new Intent("com.example.add.MENU"); (2) 
```

# c++ - 复杂继承中的 C++ 模板

> ID：14630500
> 
> 赞同：0
> 
> 时间：2013-01-31T16:27:17.123
> 
> 标签：c++, templates

> **可能重复：**
> [我必须在哪里以及为什么要放置“模板”和“类型名称”关键字？](https://stackoverflow.com/questions/610245/where-and-why-do-i-have-to-put-the-template-and-typename-keywords)

我有一个模板类型定义如下：

```
template<class TCoupon>
class CatBond : public Instrument {
public:
    class arguments;
class engine;

    //actual content
} 
```

然后我想这样做：

```
template<class TCoupon>
    class CatBond<TCoupon>::engine :
        public GenericEngine<CatBond<TCoupon>::arguments,
                             CatBond<TCoupon>::results> {}; 
```

GenericEngine 在我尝试使用的 QuantLib 库中定义如下：

```
template<class ArgumentsType, class ResultsType>
class GenericEngine : public PricingEngine,
                      public Observer {
  public:
    PricingEngine::arguments* getArguments() const { return &arguments_; }
    const PricingEngine::results* getResults() const { return &results_; }
    void reset() { results_.reset(); }
    void update() { notifyObservers(); }
  protected:
    mutable ArgumentsType arguments_;
    mutable ResultsType results_;
}; 
```

但是，这不会编译：

```
Warning 1   warning C4346: 'Oasis::CatBond<TCoupon>::arguments' : dependent name is not a type  c:\users\ga1009\documents\dev\oasis\catbonds\CatBond.h  213
Error   2   error C2923: 'QuantLib::GenericEngine' : 'Oasis::CatBond<TCoupon>::arguments' is not a valid template type argument for parameter 'ArgumentsType'   c:\users\ga1009\documents\dev\oasis\catbonds\CatBond.h  213 
```

我怎样才能让它工作？当 CatBond 是一个具体的类型时，这个构造很好地工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T10:31:46.030

按照 Pubby 的提示，正确的实现是：

```
template<class TCoupon>
    class CatBond<TCoupon>::engine :
        public GenericEngine<typename CatBond<TCoupon>::arguments,
                             typename CatBond<TCoupon>::results> {}; 
```

问题是，`CatBond<TCoupon>::arguments`默认情况下，like 的构造被 C++ 编译器假定为变量而不是类型名，所以如果在我们的例子中，我们需要使用`typename`关键字明确声明这些是类型。

# xcode - 使用 UINavigationController 在 UIViewController 之间切换

> ID：14630501
> 
> 赞同：0
> 
> 时间：2013-01-31T16:27:25.437
> 
> 标签：xcode, uinavigationcontroller, uitableview, pushviewcontroller, popviewcontroller

我的应用程序中有一个部分有一个弹出框，每次显示弹出框时都会显示一个 UITableView。很容易在 UITableViews 之间导航，计算应该在下一个视图控制器中的文件的路径并使用 pushViewController，当需要返回到以前的 UITableViews 时，popViewController 也很容易。

当弹出框被解除以执行一些其他任务时，问题就出现了，之后，有必要回到弹出框。

哪些是获得能够保留最后呈现的 UITableView 及其属性及其以前的 UITableView 的结构的最佳实践，因此弹出框的呈现方式与解除时的完全相同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T00:21:02.000

这是一个基本的概念问题。我希望它可以帮助别人。

每次弹出窗口被解除时，我都在初始化 UINavigationController。当然，我从“当前表视图”中需要的信息丢失了。我刚刚将 UINavigationController 从局部变量转换为属性，现在弹出框每次都显示为“当前”UITableView。

# ruby-on-rails - Rails 中的 Morris.js 问题

> ID：14630503
> 
> 赞同：1
> 
> 时间：2013-01-31T16:27:27.347
> 
> 标签：ruby-on-rails, coffeescript, raphael, morris.js

我正在关注 Railscast #223，尝试使用 Morris.js 和 Raphael 将一些简单的折线图放入我的 Rails 3.2.9 站点。我已经下载了 raphael 和 morris javascript 文件并将它们添加到 vendor/assets/javascripts 文件夹，然后将相关行添加到 application.js：

```
//= require raphael
//= require morris 
```

然后我为图表创建了一个简单的 HTML div：

```
<div id="annual"></div> 
```

并将相关的 CoffeeScript 添加到相关的 javascript 文件（tenants.js.coffee）中：

```
jQuery ->
    Morris.Line
        element: 'annual'
        data: [
            {y: '2012', a: 100}
            {y: '2011', a: 75}
            {y: '2010', a: 50}
            {y: '2009', a: 75}
            {y: '2008', a: 50}
            {y: '2007', a: 75}
            {y: '2006', a: 100}
        ]
        xkey: 'y'
        ykeys: ['a']
        labels: ['Series A'] 
```

页面加载正常，但没有生成图表。我是 CoffeeScript 新手，所以我不确定如何调试它。我敢肯定这是我想念的简单的东西。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-07T07:25:57.607

在 CoffeeScript 中尝试这个解决方案：

```
Morris.Line({
  element: 'annual'
  data: [
    {y: '2012', a: 100}
    {y: '2011', a: 75}
    {y: '2010', a: 50}
    {y: '2009', a: 75}
    {y: '2008', a: 50}
    {y: '2007', a: 75}
    {y: '2006', a: 100}
  ]
  xkey: 'y'
  ykeys: ['a']
  labels: ['Series A']
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-01T10:13:42.557

如果使用的是简单的 js 文件，例如 Annual.js，则有使用代码：

```
jQuery(function() {
  return Morris.Line({
    element: 'annual',
    data: [
      {y: '2012', a: 100},
      {y: '2011', a: 80},
      {y: '2010', a: 75},
      {y: '2009', a: 70},
      {y: '2008', a: 65},
      {y: '2007', a: 60},
      {y: '2006', a: 55}
      ],
    xkey: 'y',
    ykeys: ['a'],
    labels: ['Series A']
  });
}); 
```

用于将 js 转换为咖啡 = [http://js2coffee.org/](http://js2coffee.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-16T19:55:06.373

确保您的 CoffeeScript 正确缩进（间距）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-05T06:10:05.483

没有什么只是删除 //= 需要 turbolinks 。这已通过问题解决

# asp.net-mvc - @Html.CheckBoxFor 剃刀视图中的问题？

> ID：14630504
> 
> 赞同：3
> 
> 时间：2013-01-31T16:27:28.887
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4

我有一个响应提交按钮的表单。

我有一个复选框，如下所示：

```
 @Html.CheckBoxFor(m => m.CheckBoxValue) 
```

如果检查是，我怎么能得到，否则最好在我的模型中作为字符串..

```
 public bool CheckBoxValue { get; set; } OR
  public string CheckBoxValue { get; set; } 
```

请帮忙。

谢谢

**更新**

这是要走的路。

```
 @Html.CheckBoxFor(m => m.CheckBoxValue)

   public bool CheckBoxValue { get; set; } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:34:17.007

您是否只是在寻找用户友好的价值显示？这应该发生在视图中，而不是模型中。像这样的东西：

```
@Html.CheckBoxFor(m => m.CheckBoxValue)
<!-- some other markup, blah blah blah -->
@(Model.CheckBoxValue ? "Yes" : "No") 
```

模型应尽可能只包含数据的结构和逻辑功能。任何用户友好性或用户看到并与之交互的任何内容都应该出现在视图中。

**编辑：**

根据您的评论，您*可以*在模型中添加如下内容：

```
public string CheckBoxDisplayValue
{
    get
    {
        return CheckBoxValue ? "Yes" : "No";
    }
} 
```

注意：这是对绑定到视图的属性*的补充，而不是代替它。*该模型需要一个布尔值，该布尔值也是如此。所有这一切都是为模型添加一个只读属性，以显示布尔值的用户友好显示。`bool``CheckBoxValue``CheckBoxValue`

但这不推荐。听起来您有一个未在此处的问题中指定的最终目标，并且可能有更好的方法来实现该最终目标。

# ruby-on-rails - 获得“未定义的局部变量或方法”错误

> ID：14630505
> 
> 赞同：0
> 
> 时间：2013-01-31T16:27:33.507
> 
> 标签：ruby-on-rails, typhoeus

我运行一个命令：

```
rake db:migrate RAILS_ENV=test    
ruby service.rb -p 3000 -e test 
```

我得到这个错误：

```
, [2013-01-31T10:25:22.197106 #999] DEBUG -- : env: test
service.rb:16:in `<main>': undefined local variable or method `databases' for main:Object (NameError) 
```

我对 Rails 很陌生，有人可以集思广益，看看我应该看什么来找到问题吗？这来自于使用 Typheous 为 Sinatra Rail 服务创建客户端应用程序的教程

**编辑**：这是给出错误的 service.rb 源文件的链接 [https://github.com/babakinks/HisFirstService/blob/master/service.rb](https://github.com/babakinks/HisFirstService/blob/master/service.rb)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:51:43.260

就像评论中提到的 Javid 我错过了定义变量“数据库”的行

添加了这个：

```
databases = YAML.load_file("config/database.yml") 
```

现在还有一些错误，但就这个问题而言，这就是所缺少的。

# c - 使用 Pthread 的 C 语言基本多线程程序说明

> ID：14630510
> 
> 赞同：-1
> 
> 时间：2013-01-31T16:27:44.080
> 
> 标签：c, multithreading

我正在尝试学习 C 中的多线程编程并尝试理解基本程序。我无法理解 runner 函数以及为什么它返回一个指向 void 类型的指针并传递一个也是指向 void 的指针的参数。另外，我无法理解 main 的参数。

```
int sum; / this data is shared by the thread(s) 
void *runner(void *param); / the thread 
int main(int argc, char *argv[])
{
 pthread_t tid; / the thread identifier /
 pthread.attr_t attr; / set of thread attributes /
if (argc != 2) {
fprintf(stderr,"usage: a.out <integer value>\n");
return -1;
}
if (atoi(argv[1]) < 0) {
fprintf(stderr,"%d must be >= 0\n",atoi(argv[1]));
return -1;
/ get the default attributes /
pthread.attr.init (&attr) ;
/ create the thread /
pthread^create(&tid,&attr,runner,argv[1]);
/ wait for the thread to exit /
pthread_join (tid, NULL) ;
printf("sum = %d\n",sum);
/ The thread will begin control in this function /
void *runner(void *param)
{<br />
int i, upper = atoi(param);
sum = 0;<br />
for (i = 1; i <= upper; i
sum += i;
pthread_exit (0) ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:32:59.250

第一个参数`main`。 `argc`是命令行参数的数量，包括程序名称。`argv`是一个指向零分隔字符串的指针数组，这些字符串本身就是参数。因此，如果您像这样从命令行运行程序：

```
myprog x y z 
```

然后`argc`将是 4，`argv`看起来像这样：

```
argv[0]: "myprog"
argv[1]: "x"
argv[2]: "y"
argv[3]: "z"
argv[4]: "" 
```

最后一个元素应该是一个空字符串。第一个元素（程序名称）的确切格式取决于操作系统和程序调用的确切方式。

您的`runner`函数是一种有时通常称为*回调*的函数。它由其他人（pthread 库）调用。为了让其他人调用你的函数，它必须知道它的返回类型和参数，所以这些都是固定的，即使它们不被使用。

所以`runner`必须返回一个`void *`（无类型指针）并接受一个`void *`参数，即使它实际上并没有使用任何一个（它可以返回`NULL`）。之所以如此，是因为这是 pthread 库所期望的。

# php - Mysql SELECT 寻找重复的“除了”当前的

> ID：14630511
> 
> 赞同：0
> 
> 时间：2013-01-31T16:27:47.107
> 
> 标签：php, mysql

我现在有一些代码可以查看是否使用了密钥。唯一的问题是，如果正在修改条目，它现在会找到它自己。什么是寻找重复“除了”当前重复的好方法？我确实有一个名为“id”的唯一 ID。我有一个人的钥匙列表。每把钥匙仅供一个人使用。有时，当办公室里的人从我们拥有的钥匙库中取出钥匙时。然后忘记从我们拥有的密钥库中删除密钥。然后，当下一个人拿钥匙时，他们会拿走最后一个使用过的钥匙。我们最终将游戏钥匙卖给了不同的人。这就是为什么我需要检查 viprek 中的重复项，但如果他们正在更改包含该密钥的条目，则不触发“此密钥已在使用”屏幕。

初始化文件

```
<?php
$con = mysql_connect(localhost, root, passwordexmaple);
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("arkamanc_vipre", $con);
?> 
```

修改.php

[http://pastebin.com/5shCfKWu](http://pastebin.com/5shCfKWu)

编辑.php

[http://pastebin.com/CVjaS8Lh](http://pastebin.com/CVjaS8Lh)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:39:25.520

```
SELECT c2.id FROM client AS c1, client AS c2
  WHERE c1.viprek = c2.viprek
  AND c1.viprek != :viprek
  AND c1.id < c2.id 
```

上面的查询将返回`id`table 的所有条目，这些条目是列`client`上另一个条目的副本`viprek`，但 value 保存在 中的条目除外`$_POST`。您应该只获得较新的副本（id rank-wise）。

这是您应该做的更改，以便在脚本中获得预期的行为：

```
$query = "SELECT * FROM client AS c1, client AS c2 WHERE c1.viprek = c2.viprek AND c1.viprek!=".mysql_real_escape_string($_POST[viprek])." AND c1.id < c2.id"; 
```

如果您想要的是包含`viprek`列的特定值而`id`不是特定值的条目，那么这里是查询。

```
SELECT id FROM client
   WHERE id != :id 
   AND viprek = :viprek 
```

您可以简单地修改您的`$query`变量以包含此查询，如上所示。

但是，强烈建议您使用 PDO 来执行所有数据库查询。我建议你学习如何去做或雇人来照顾它。这里有一个[教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)供您过渡到 PDO。

我不确定这是否是你想要的。

# scala - 字符串模板中的 Scala 和行尾

> ID：14630515
> 
> 赞同：2
> 
> 时间：2013-01-31T16:27:49.093
> 
> 标签：scala, eol, os-dependent

我正在编写验收测试，它验证来自嵌入式服务器的 HTTP 响应。所以看起来像

```
assert((200, """{
                |  "status" : "OK"
                |}""".stripMargin) === (code, response)) 
```

到目前为止，它在我的 Linux 机器上运行良好，但是当在 Windows 上调用测试时 - 它失败了。

```
org.scalatest.exceptions.TestFailedException: "{[
  "status" : "OK"
]
}" did not equal "{[
  "status" : "OK"]
}" 
```

我认为这是因为行尾 - Windows 中的行尾与 Linux 中的不同。是否有任何简单的方法可以在编译的测试数据中提供特定于操作系统的行尾？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:43:47.077

检查两者。因为“大多数文本 Internet 协议（包括 HTTP、SMTP、FTP、IRC 和许多其他协议）都要求在协议级别使用 ASCII CR+LF (0x0D 0x0A)，但建议宽容的应用程序也识别单独的 LF。”

享受。

# c++ - 如何使用 yaml-cpp 0.5.0 API 从列表中删除元素

> ID：14630516
> 
> 赞同：1
> 
> 时间：2013-01-31T16:27:55.867
> 
> 标签：c++, yaml-cpp

以下测试代码不会按预期从列表中删除元素：

```
YAML::Node node = YAML::Load("[1,2,3]");
node.remove(1); // expect that this should remove the middle element from the list

ofstream ofs("test.yml");
ofs << node;
ofs.close(); 
```

测试输出文件包含：

```
-1
-2
-3 
```

该文件似乎包含原始列表中的值，并且该元素未被删除。从列表中删除元素的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T18:49:21.547

现在没有办法做到这一点（我没有想到这个！）。我提交了一个错误（[http://code.google.com/p/yaml-cpp/issues/detail?id=190](http://code.google.com/p/yaml-cpp/issues/detail?id=190)），但我不确定语法应该是什么。如果您有任何建议，请在该问题上发表评论！

# php - PHP 变量访问

> ID：14630521
> 
> 赞同：0
> 
> 时间：2013-01-31T16:28:10.460
> 
> 标签：php, variables, global

好的，这可能是一个简单/愚蠢的问题，但无法弄清楚......

我有一堂课，我将其包含在另一个 php 脚本中。

所以，我打电话例如`$user->login`，但如果我想创建一个函数并使用这个变量`$user`或函数外部定义的任何其他变量，我需要在函数内部声明它 GLOBAL 。

**有没有办法在函数之外只声明一次 GLOBAL ，而不是在我需要的每个函数中声明它？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:30:01.860

不是真的，不。您可以根据情况做一些可怕的事情，但一般来说，只需使用`global`. 如果你发现这成为一个问题，你可能有太多的全局变量或出于错误的原因使用它们，你应该考虑将它们放入类（例如）中。

* * *

而且，只是为了它，说可怕的事情如下（按恐怖顺序）：

*   制作`user`一个函数并在每次需要`$user`全局时调用它
*   创建`user`一个类并使用共享状态静态引用所有内容，因为 PHP 通常没有线程
*   使用[runkit](http://www.php.net/manual/en/runkit.configuration.php)将该变量视为超全局变量
*   覆盖现有的超全局

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:29:55.670

> ...如果我想创建一个函数并使用此变量 $user 或在函数外部定义的任何其他变量...

你在这里不需要全局变量。将变量传递给您的函数。或者将其传递给您的类构造函数并将其存储在属性中。然后你可以在你的类的每个方法中访问该属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:35:31.907

好吧，所有全局变量都可以通过`$GLOBALS['var_name']`所以你可以使用`$GLOBALS['user']->login`，但你很快就会更喜欢声明`global $user`.

然后，您将 $user 作为参数添加到您的函数中。

# git - Git 在推送时尝试获取 Null 提交

> ID：14630523
> 
> 赞同：5
> 
> 时间：2013-01-31T16:28:22.347
> 
> 标签：git

`--bare`我已经使用该选项将一个 github 存储库克隆到另一个裸存储库中。但是，当我将提交推送到此存储库时，我会得到以下输出：

```
Fetching remote heads...
  refs/
  refs/tags/
  refs/heads/
  refs/remotes/
  refs/remotes/origin/
  fetch 0000000000000000000000000000000000000000 for refs/remotes/origin/HEAD
Unable to fetch 0000000000000000000000000000000000000000, will not be able to update server info refs
updating 'refs/heads/master'
  from db82a9e0b834b59922b42ff193984f7cbc4fb295
  to   b694385d28056e9182314f770b1380a424f49bfa
    sending 4 objects
    done
Unable to update server info
To http://www/git/asi-http-request.git
   db82a9e..b694385  master -> master 
```

我正在使用 DAV 传输，因此`git update-server-info`不执行仅包含的更新后挂钩，从而使最后一次提交不可见。我必须手动运行`update-server-info`命令

我注意到该文件包含一个不存在`refs/remotes/origin/HEAD`的符号引用。`refs/remotes/origin/master`我尝试在原始存储库中创建包含主分支的提交引用，但在推送新提交时我仍然面临同样的错误。

git 版本是 1.7.2.5

有谁知道发生了什么以及我该如何解决？

**编辑 2013 年 2 月 1 日**

远程存储库上的`git log HEAD`命令返回该输出（我删除了作者提交消息）：

```
commit b694385d28056e9182314f770b1380a424f49bfa
Author: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Date:   Tue Jan 29 18:44:05 2013 +0100

    ...

commit db82a9e0b834b59922b42ff193984f7cbc4fb295
Author: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Date:   Tue Jan 29 10:59:59 2013 +0100

    ...

commit 6300b759329d5d5d715d0fc76d15424c12a87bd4
Author: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Date:   Sat Jan 5 13:28:27 2013 +0100

    ... 
```

我不确定这是否相关，因为我跑了`git update-server-info`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T10:41:45.540

我会尝试不将 repo 克隆为`--bare`一个：

*   `cd your_bare`
*   `git clone --bare git@github.com...`

而是**先将其克隆成普通的**

创建你的裸仓库

*   `cd your_bare`
*   `git init --bare`

现在克隆回购

*   `cd /tmp`
*   `git clone git@github.com...`
*   `cd repo`
*   `git remote rename origin upstream`

并将其推送到您的裸仓库

*   `git remote add origin your_bare`
*   `git push origin master`

# firefox - 代码打开 IE 但需要 safari 和 Firefox

> ID：14630524
> 
> 赞同：0
> 
> 时间：2013-01-31T16:28:31.460
> 
> 标签：firefox, safari

如何让此代码与 Safari 或 Firefox 一起使用？

```
Public Function getGoogDistanceTime(startAddr As String, startCity As String, _
startState As String, startZip As String, endAddr As String, _
endCity As String, endState As String, endZip As String) As String
Dim sURL As String
Dim BodyTxt As String
Dim apan As String
Dim oXH As Object
    sURL = "http://maps.google.com/maps?f=d&source=s_d&saddr="
    sURL = sURL & Replace(startAddr, " ", "+") & ",+" & Replace(startCity, " ", "+") & ",+" & startState
    sURL = sURL & "&daddr=" & Replace(endAddr, " ", "+") & ",+" & Replace(endCity, " ", "+") & ",+" & endState
    sURL = sURL & "&hl=en"
    Set oXH = CreateObject("msxml2.xmlhttp")
            With oXH
              .Open "get", sURL, False
              .Send
              BodyTxt = .RESPONSETEXT
            End With

            apan = Application.WorksheetFunction.Trim(apan)
            apan = Mid(BodyTxt, InStr(1, BodyTxt, "<div class=""altroute-rcol altroute-info"">") + 49, 200)
            apan = Left(apan, InStr(1, apan, "</span>    </div>") - 1)
            apan = Replace(apan, "</span>", "")
            apan = Replace(apan, "<span>", "")
            getGoogDistanceTime = apan
    Set oXH = Nothing
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:30:22.530

您的代码是用 VBScript 编写的，这是一种仅限 Internet Explorer 的语言。您需要用所有浏览器都理解的 JavaScript 重写它。

您还使用仅 IE 代码来执行 AJAX，使用`msxml2`. 这将需要更改为使用更通用的 AJAX 代码，使用`XMLHttpRequest`对象。

我不知道是什么`Application.WorksheetFunction.Trim()`，但你需要找到一个 JavaScript 替代品。

# c# - 无法通过 WPF WebBrowser 控件的 InvokeScript 更改 VIDEO 标记大小

> ID：14630528
> 
> 赞同：0
> 
> 时间：2013-01-31T16:28:41.000
> 
> 标签：c#, javascript, wpf, xaml, webbrowser-control

我做了非常简单的事情：我需要通过 WPF WebBrowser 控件的 InvokeScript 更改 VIDEO 标记大小。

所以它显示“你好”，但大小根本没有变化。

注意：如果我直接打开此页面，它会更改任何浏览器的大小。

```
private void btSize_Click(object sender, RoutedEventArgs e)
{
   wb.InvokeScript("SetVideoSize");
}

function SetVideoSize() {

            try {
                document.getElementById("player1").style.height = '400px';
                document.getElementById("player1").style.width = '400px';
                alert('Hello2');
  } catch (e) {
               // alert(e.Message);
            }
        }

 <video width="10" height="10" style="margin: 0 !important; padding: 0 !important;
        overflow: hidden;" id="player1" name="mplayer1"  src="http://mysite.com/files/werweB"  type="video/mp4">
    </video>
     <script type="text/javascript">       
        MediaElement('player1', 
        {
            success: function (me) {
                me.play();
            }
        }); 
    </script> 
```

我什至试图这样做：

```
mshtml.HTMLDocument doc = (mshtml.HTMLDocument)wb.Document;
var player = doc.getElementById("player1");
player.setAttribute("width", "400");
player.setAttribute("height", "400"); 
```

但是完全没有任何视觉上的变化……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:58:18.540

我花了两天时间搜索，这就是我发现的：

您所要做的就是将以下`meta`标签添加到您的 HTML 中：

```
<meta http-equiv="X-UA-Compatible" content="IE=9" > 
```

# javascript - 在循环内排队异步函数以按顺序执行而无需回调

> ID：14630531
> 
> 赞同：0
> 
> 时间：2013-01-31T16:28:49.237
> 
> 标签：javascript, jquery, asynchronous, svg

我知道这里还有其他一些帖子有类似的问题，但没有一个能帮助我......

我需要按顺序执行一些函数（它们是异步的）来为 svg 元素设置动画，一个在前一个结束之后，但在一个循环内。这是我的代码：

```
 function begin (i,time){
        setTimeout(function(){
            $('.pie-chart animate')[i].beginElement();
        },time);
    }

    for(var i=0;i<$('.pie-chart animate').length;i++){
        dur = $('.pie-chart animate').eq(i).attr('dur');
        time = parseInt(dur.substr(0,1));
        time = time * 1000;
        begin(i,time);
    } 
```

此后，所有动画同时执行。谁能帮帮我，谢谢^^。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:41:15.923

'按顺序，我认为你的意思是同步的，而（不是 AJAX）我认为你的意思不是异步的。要正确执行此操作（异步），您应该使用回调。像这样的东西：

```
function begin (i){
    if (i >= $('.pie-chart animate').length) return;//you're done
    dur = $('.pie-chart animate').eq(i).attr('dur');
    time = parseInt(dur.substr(0,1));
    time = time * 1000;

    setTimeout(function(){
        $('.pie-chart animate')[i].beginElement();
        begin(i+1);    
    },time);
}

 begin(0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:43:12.907

看起来你的时间在循环中被重置了，所以如果你的所有动画都有*9*秒，那么所有动画都会在 9 秒后开始。

在循环中，您需要从当前之前的所有迭代元素的持续时间总和执行开始。看例子：

```
function begin (i,time){
    setTimeout(function(){
        $('.pie-chart animate')[i].beginElement();
    },time);
}

var time = 0;
for(var i=0;i<$('.pie-chart animate').length;i++){
    dur = $('.pie-chart animate').eq(i).attr('dur');
    time += parseInt(dur, 10) * 1000;
    begin(i, (i===0)?0:time);
} 
```

# r - 改进遗传算法匹配的建议

> ID：14630533
> 
> 赞同：1
> 
> 时间：2013-01-31T16:28:53.343
> 
> 标签：r, genetic-algorithm

我正在尝试将 GA 用于以下搜索问题：

有一组 30 个向量，每个向量有 1500 个元素：

一个[30x1500]

还有一个包含 2000 个向量的库，每个向量包含 1500 个元素

B[2000 x 1500]

我尝试在 B 中找到与 A 中的向量最接近的一组 (30) 个向量。

我正在使用 GA（基本选择->交叉->突变）并且得到了相当好的结果，但是代码真的很慢。我使用相关函数作为适应度，这可能是瓶颈，尽管迭代次数肯定也是瓶颈（大约 500 次迭代才能获得 95% 的相关性）。

有没有人用 GA 来解决类似的问题？或广泛使用 GA... 有什么常用技巧可以用来提高速度和/或收敛性吗？

谢谢！

PS：我的程序是用 R 编写的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:41:00.377

这实际上是一个相当微不足道的计算。您可以使用欧几里得距离计算它并分配计算。在多核机器上，您应该很快就会得到答案。

GA 绝对不是解决这个问题的方法。

# view - XPages 分类视图 expandlevel

> ID：14630534
> 
> 赞同：2
> 
> 时间：2013-01-31T16:28:56.680
> 
> 标签：view, xpages, lotus-domino

我正在尝试在 Lotus Domino XPage 中呈现一个分类视图，其中所有类别最初都已折叠。我已在 URL 中成功使用 page.xsp?expandLevel=1，并在视图面板中将属性 ExpandLevel 设置为 1。

问题是，当我单击任何类别以展开它时，第一次单击时它不会打开。相反，它把twistie 变成了好像类别被扩展了一样，但什么也不显示。如果我再次点击，它会关闭twistie。如果我第三次单击，它会正确打开该类别。

这种行为是一致的，我在几个视图上都试过了，也试过打开几个类别。我试过 Chrome 和 IE。我是唯一一个看到这个的人，还是只有我一个在乎的人？

我正在使用最新的代码 8.5.3FP3

有人知道解决方法或其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T20:04:36.537

我一直遇到同样的问题。我似乎只在第一次单击要展开的类别时才看到问题 - 我必须单击它两次。只要具有视图面板的页面保持打开状态，后续单击类别就会起作用。根据我的特殊经验，这是我想出的解决方法：

我继续`expandLevel="1"`在视图面板中使用。

```
<xp:dominoView var="vwSecurityType" viewName="bySecurityType" expandLevel="1">
</xp:dominoView> 
```

在“页面加载后”事件中，我添加了以下代码：

```
var viewPanel = getComponent("viewPanel1");
var model:com.ibm.xsp.model.domino.DominoViewDataModel = viewPanel.getDataModel();
var container:com.ibm.xsp.model.domino.DominoViewDataContainer = model.getDominoViewDataContainer();
container.expand("0"); 
```

我希望这对你也有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T15:17:52.690

这不是以前向代码 XPages 开发团队报告的问题。
但是，如果没有看到您的基础视图数据源是什么样的，我猜测您有多个子类别和/或对视图中的响应的响应。在这里，您可能会看到一个问题，或者更好地描述了在展开所有行已折叠的视图的一行后视图刷新的延迟 - expandLevel=1
这是在 9.0 中已解决的问题（尽管不在 Beta 版中），您应该会在这方面看到巨大的进步。
如果这是您所看到的潜在行为，那当然是这样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-04T23:19:48.717

在 8.5.3 中，expandLevel=1 似乎是一个明显的错误，正如@John 所说，它真的很容易重现。我不得不使用这个函数（类似于@bj，但没有 xp:dominoView）：

```
function collapseExpandAll(id, bColapse){
    var viewPanel = getComponent(id);
    var model:com.ibm.xsp.model.domino.DominoViewDataModel = viewPanel.getDataModel();
    var container:com.ibm.xsp.model.domino.DominoViewDataContainer = model.getDominoViewDataContainer();
    if(true === bColapse){
        container.collapseAll();    
    }else{
        container.expandAll()    
    }        
} 
```

并打电话

```
collapseExpandAll("viewPanel1", true) 
```

折叠所有和

```
colapseExpandAll("viewPanel1", false) 
```

扩大所有。

# ruby-on-rails-3 - DataMapper 关联“NoMethodError”

> ID：14630535
> 
> 赞同：0
> 
> 时间：2013-01-31T16:29:00.473
> 
> 标签：ruby-on-rails-3, datamapper, padrino

我遇到了一个问题，无法弄清楚问题出在哪里。因为我相对较新，所以希望您能帮助我:)。

首先，我将**padrino**与**datamapper** gem 一起使用。

我有一个具有 one_to_many 关系的旅行和住宿模型

模型长什么样： **Trip.rb**

```
class Trip
  include DataMapper::Resource

  # Associations
  has n, :accommodations

  property :id, Serial, :key => true
  # many more properties
end 
```

**住宿.rb**

```
class Accommodation
  include DataMapper::Resource

  has n, :appartments
  belongs_to :trip, :child_key => [:trip_id]

  # property <name>, <type>
  property :id, Serial
end 
```

根据 dm 文档，我认为该关联是有效的

我想实现以下应用程序行为：

用户可以选择特定的旅行并添加或删除住宿

这就是我的控制器的样子： **trips.rb**

```
HhtBackoffice.controllers :trips do
  get :index do
    @trips = Trip.all
    render 'trips/index'
  end

  get :show, :with => :id do
    @trip = Trip.get(params[:id])
    set_current_trip(Trip.get(params[:id]))
    render 'trips/show'
  end

  get :new do
    @trip = Trip.new
    render 'trips/new'
  end

  post :create do
    @trip = Trip.new(params[:trip])
    if @trip.save
      flash[:notice] = 'Neue Reise wurde erfolgreich hinzugef&uuml;gt'
      redirect url(:trips, :edit, :id => @trip.id)
    else 
      render 'trips/new'
    end
  end
..........
more code
........
end 
```

**住宿.rb**

```
HhtBackoffice.controllers :accommodations do
  get :index do
    @accommodations = Accommodation.all
    render 'accommodations/index'
  end

  get :new do
    @trip = current_trip
    @accommodation = @trip.accommodations.new  # <-- This function is not known according to the error
    render 'accommodations/new'
  end

  post :create do
    @trip = current_trip
    @accommodation = @trip.accommodations.new(params[:accommodation])
    if @accommodation.save
      flash[:notice] = 'Neue Reise wurde erfolgreich hinzugef&uuml;gt'
      redirect url(:accommodations, :edit, :id => @accommodation.id)
    else 
      render 'accommodations/new'
    end
  end
.... more code here ....
end 
```

如您所见，我使用了两个辅助函数。set_current_trip（当调用显示视图时）跟踪当前行程。和current_trip 得到current_trip。

这是我的**trips/show.haml**视图

```
.block
    .secondary-navigation
        %ul.wat-cf
            %li.first.active=link_to pat(:list), url(:trips, :index)
            %li=link_to pat(:new), url(:trips, :new)
    .content
        %h2.title

        .inner
            -@trip.accommodations.each do |acco|
                %ud
                    %li= acco.id
                    %li= acco.name
            =button_to pat(:new), url(:accommodations, :new), :method => :get, :class => :button_to

        .actions-bar.wat-cf
            .actions="&nbsp;" 
```

这是**住宿/新**景观

```
.block
  .secondary-navigation
    %ul.wat-cf
      %li.first=link_to pat(:list), url(:accommodations, :index)
      %li.active=link_to pat(:new), url(:accommodations, :new)
  .content
    %h2.title
      =pat(:new)
      =mt(:accommodation)
    .inner
      -form_for :accommodation, url(:accommodations, :create), :class => :form do |f|
        =partial "accommodations/form", :locals => { :f => f } 
```

这是**错误**

```
#<NoMethodError: undefined method `accommodations' for nil:NilClass>

/home/paddy/Projects/hht_backoffice/app/controllers/accommodations.rb in block (2 levels) in <top (required)>
    @trip.accommodations.new
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in call
            proc { |a,p| unbound_method.bind(a).call }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in block in route
            proc { |a,p| unbound_method.bind(a).call }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in []
        halt_response     = catch(:halt) { route_eval { @route.dest[self, @block_params] } }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in block (3 levels) in process_destination_path
        halt_response     = catch(:halt) { route_eval { @route.dest[self, @block_params] } }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/base.rb in route_eval
      throw :halt, yield
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in block (2 levels) in process_destination_path
        halt_response     = catch(:halt) { route_eval { @route.dest[self, @block_params] } }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in catch
        halt_response     = catch(:halt) { route_eval { @route.dest[self, @block_params] } }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in block in process_destination_path
        halt_response     = catch(:halt) { route_eval { @route.dest[self, @block_params] } }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in instance_eval
    Thread.current['padrino.instance'].instance_eval do
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in process_destination_path
    Thread.current['padrino.instance'].instance_eval do
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/http_router-0.10.2/lib/http_router/node/root.rb in []
      end
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/http_router-0.10.2/lib/http_router.rb in block in call
    response = catch(:success) { @root[request] }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/http_router-0.10.2/lib/http_router.rb in catch
    response = catch(:success) { @root[request] }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/http_router-0.10.2/lib/http_router.rb in call
    response = catch(:success) { @root[request] }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in route!
          if base.compiled_router and match = base.compiled_router.call(@request.env)
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/application/routing.rb in dispatch!
          route!
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/base.rb in block in call!
      invoke { dispatch! }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/base.rb in block in invoke
      res = catch(:halt) { yield }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/base.rb in catch
      res = catch(:halt) { yield }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/base.rb in invoke
      res = catch(:halt) { yield }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/base.rb in call!
      invoke { dispatch! }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/base.rb in call
      dup.call!(env)
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sass-3.2.5/lib/sass/plugin/rack.rb in call
        @app.call(env)
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/rack-1.5.1/lib/rack/head.rb in call
    status, headers, body = @app.call(env)
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/rack-1.5.1/lib/rack/methodoverride.rb in call
      @app.call(env)
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/reloader.rb in call
        @app.call(env)
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/logger.rb in call
        status, header, body = @app.call(env)
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/showexceptions.rb in call
      @app.call(env)
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/rack-1.5.1/lib/rack/session/abstract/id.rb in context
          status, headers, body = app.call(env)
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/rack-1.5.1/lib/rack/session/abstract/id.rb in call
          context(env)
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/base.rb in block in call
        synchronize { prototype.call(env) }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/base.rb in synchronize
          yield
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/sinatra-1.3.4/lib/sinatra/base.rb in call
        synchronize { prototype.call(env) }
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/router.rb in block in call
        return app.call(
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/router.rb in each
      @mapping.each do |host, path, match, app|
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/padrino-core-0.10.7/lib/padrino-core/router.rb in call
      @mapping.each do |host, path, match, app|
/home/paddy/.rvm/gems/ruby-1.9.3-p374/gems/rack-1.5.1/lib/rack/handler/webrick.rb in service
        status, headers, body = @app.call(env)
/home/paddy/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/webrick/httpserver.rb in service
      si.service(req, res)
/home/paddy/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/webrick/httpserver.rb in run
          server.service(req, res)
/home/paddy/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/webrick/server.rb in block in start_thread 
```

通过**padrino 控制台**执行“相同”操作没有任何问题：

```
irb(main):001:0> @trip = Trip.get(1)
  DEBUG - (0.000101) SET sql_auto_is_null = 0
  DEBUG - (0.000127) SET SESSION sql_mode = 'ANSI,NO_BACKSLASH_ESCAPES,NO_DIR_IN_CREATE,NO_ENGINE_SUBSTITUTION,NO_UNSIGNED_SUBTRACTION,TRADITIONAL'
  DEBUG - (0.000092) SELECT `id`, `name`, `type`, `starts_at`, `ends_at`, `no_of_free_places`, `no_of_guests`, `raceday`, `created_at`, `updated_at` FROM `trips` WHERE `id` = 1 LIMIT 1
=> #<Trip @id=1 @name="Rofl" @type="Wettkampfreise" @starts_at=nil @ends_at=nil @no_of_free_places=nil @no_of_guests=nil @raceday=nil @created_at=#<DateTime: 2013-01-31T15:00:16+01:00 ((2456324j,50416s,0n),+3600s,2299161j)> @updated_at=#<DateTime: 2013-01-31T15:16:40+01:00 ((2456324j,51400s,0n),+3600s,2299161j)>>

irb(main):02:0> @trip.accommodations.new
=> #<Accommodation @id=nil @name=nil @no_of_appartments=nil @location=nil @capacity=nil @trip_id=1> 
```

有关解决此问题的任何提示？

好吧，我有一个猜测。我的 current_trip 对象为零。这些是我的辅助方法：

**助手/trips.rb**

```
 def set_current_trip(trip=nil)
    @current_trip = trip
  end

  def current_trip 
    @current_trip 
  end 
```

提前致谢！

# 编辑 2

这是我的路线。也许嵌套是让它工作的好方法我想打电话

```
=button_to pat(:new), url(:accommodations, :new), :method => :get, :class => :button_to 
```

在我的**旅行/show.haml**

但我得到了错误

```
route mapping for url(:accommodations_new) could not be found! 
```

这是为什么？根据我的路线，我应该到达 /trips/:trip_id/accommodations/new

**路线**

```
URL                           REQUEST  PATH
    (:accommodations, :index)        GET    /trips/:trip_id/accommodations
    (:accommodations, :new)          GET    /trips/:trip_id/accommodations/new
    (:accommodations, :create)      POST    /trips/:trip_id/accommodations/create
    (:accommodations, :edit)         GET    /trips/:trip_id/accommodations/edit/:id
    (:accommodations, :update)       PUT    /trips/:trip_id/accommodations/update/:id
    (:accommodations, :destroy)    DELETE   /trips/:trip_id/accommodations/destroy/:id
    (:base, :index)                 GET    /
    (:trips, :index)                GET    /trips
    (:trips, :show)                 GET    /trips/show/:id
    (:trips, :new)                  GET    /trips/new
    (:trips, :create)              POST    /trips/create
    (:trips, :edit)                 GET    /trips/edit/:id
    (:trips, :update)               PUT    /trips/update/:id
    (:trips, :destroy)            DELETE   /trips/destroy/:id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T20:22:16.397

`current_trip`返回零。首先，确保在调用其中一个方法时@trip 不为零，因为如果还没有设置行程怎么办？

```
 get :new do
    @trip = current_trip
    if @trip
      @accommodation = @trip.accommodations.new  
      render 'accommodations/new'
    else
      # trip is nil. Call an error or something.
    end
  end 
```

其次，我不确定您的辅助方法是否会返回行程，因为 @current_trip 尚未初始化。current_trip 是做什么用的？您是否希望跨会话为用户保留它？如果是这样，您可能希望将 current_trip 保存在 cookie 中。

```
def set_current_trip(trip_id = 0)

  response.set_cookie 'current_trip', :value => trip_id, :path => '/', :expires => Time.now + 60 * 60 * 24 * 365 * 20

end

def current_trip 
  trip_id = request.cookies["current_trip"]
  current_trip = Trip.get trip_id
end 
```

# ios - UINavigationController 出现在 UIPopoverController 中时的 UIBarButtonItem 截止

> ID：14630536
> 
> 赞同：2
> 
> 时间：2013-01-31T16:29:03.053
> 
> 标签：ios

当导航控制器出现在 UIPopoverController 中时，我的 UIBarButtonItem 在导航栏中被切断。知道是什么原因造成的吗？

问题截图： http: [//www.flickr.com/photos/92771610@N02/8432176079](http://www.flickr.com/photos/92771610@N02/8432176079)

这是代码：

```
UIViewController *vc = [[[UIViewController alloc] init] autorelease];

UIBarButtonItem *saveButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemSave target:self action:@selector(saveAction:)];

vc.navigationItem.rightBarButtonItem = saveButton;

UINavigationController *navController = [[[UINavigationController alloc] initWithRootViewController:vc] autorelease];

UIPopoverController *popoverController = [[UIPopoverController alloc] initWithContentViewController:navController];
popoverController.delegate = self;

[popoverController presentPopoverFromRect:buttonThatMakesThePopoverAppear.frame
                                   inView:self.view.superview
                 permittedArrowDirections:UIPopoverArrowDirectionAny
                                 animated:YES]; 
```

谢谢，贡萨洛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-14T19:26:05.670

这是因为您没有遵守[iOS Human Interface Guidelines](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/MobileHIG/Introduction/Introduction.html)。

您的自定义`UIBarButtonItem`视图和这些元素的自定义背景图像应为 30 像素高。弹出框的斜角边框正确地剪裁了您的自定义图稿，因为它们不应该那么大。

当不通过 a 呈现时`UIPopoverController`，这些按钮在 iOS 6 中看起来很好，但这只是因为没有裁剪边界的视图。请注意，在 iOS 5 中确实会发生这种情况，因此虽然您应该看起来不错，但请确保您在旧版本中进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T18:51:34.747

在其他地方，使用外观管理器在 UINavigationController 和 UIBarButtonItem 上设置自定义图像/背景/标题位置会导致此问题，因为它没有考虑弹出框的斜角边框。解决方案：要么在使用前反转为自定义外观设置的值，要么使自定义适用于所有情况，包括在弹出窗口中使用导航栏。

# git - Git 合并在文件上失败，没有任何更改

> ID：14630537
> 
> 赞同：1
> 
> 时间：2013-01-31T16:29:03.350
> 
> 标签：git, github, merge, egit

我正在尝试将同事的更改合并到我的本地存储库中，但 git 一直抱怨我修改了文件并且我的更改将被覆盖（*“错误：您对以下文件的本地更改将被合并覆盖”*）。

如果我使用 egit 将我的文件与 HEAD 进行比较，它表示没有任何变化（不会忽略空格）。

如果我现在输入

```
git diff HEAD -- myfile 
```

它说该文件已完全更改。（我已经删除了文件的整个先前内容，然后重新添加了整个新内容）。

我的文件包含 XML，但文件的扩展名为“.inspector”。

我的 .gitattributes 文件包含以下内容：

```
* text=auto
*.fib text
*.inspector text
*.vm text
*.palette text
*.owl text
*.shema text
*.dict text 
```

在我的 git 配置中，我有以下信息（加上电子邮件、名称和分支/远程的东西）：

```
core.autocrlf=true
core.trustctime=false
core.repositoryformatversion=0
core.filemode=false
core.logallrefupdates=true
core.autocrlf=true 
```

我正在使用 git 1.7.5.1 在 Windows 上工作

我检查了这个[问题](https://stackoverflow.com/questions/5074136/git-rebase-fails-your-local-changes-to-the-following-files-would-be-overwritte)，但它对我不起作用。

我也尝试过

```
git checkout 1.5 -- myfile 
```

但问题仍然存在。

github 存储库（如果它对任何人都有用）位于：[https ://github.com/agilebirds/openflexo](https://github.com/agilebirds/openflexo)

有问题的文件如下： [https://github.com/agilebirds/openflexo/blob/1.5/flexodesktop/modules/flexoworkfloweditor/src/main/resources/Inspectors/WKF/Role.inspector](https://github.com/agilebirds/openflexo/blob/1.5/flexodesktop/modules/flexoworkfloweditor/src/main/resources/Inspectors/WKF/Role.inspector)最近由我编辑同事（在 Mac 上工作）。

如果需要任何其他信息，请不要犹豫，我会很乐意提供。

# java - 以编程方式使用 Spring 调度作业（动态设置 fixedRate）

> ID：14630539
> 
> 赞同：86
> 
> 时间：2013-01-31T16:29:12.410
> 
> 标签：java, spring, scheduled-tasks, spring-annotations, spring-scheduled

目前我有这个：

```
@Scheduled(fixedRate=5000)
public void getSchedule(){
   System.out.println("in scheduled job");
} 
```

我可以将其更改为使用对属性的引用

```
@Scheduled(fixedRateString="${myRate}")
public void getSchedule(){
   System.out.println("in scheduled job");
} 
```

但是，我需要使用以编程方式获得的值，以便可以在不重新部署应用程序的情况下更改计划。什么是最好的方法？我意识到使用注释可能是不可能的......

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2013-01-31T18:35:29.873

使用 a[`Trigger`](http://static.springsource.org/spring/docs/3.0.x/reference/scheduling.html#scheduling-trigger-interface)您可以即时计算下一个执行时间。

像这样的东西应该可以解决问题（改编自[Javadoc for`@EnableScheduling`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/scheduling/annotation/EnableScheduling.html)）：

```
@Configuration
@EnableScheduling
public class MyAppConfig implements SchedulingConfigurer {

    @Autowired
    Environment env;

    @Bean
    public MyBean myBean() {
        return new MyBean();
    }

    @Bean(destroyMethod = "shutdown")
    public Executor taskExecutor() {
        return Executors.newScheduledThreadPool(100);
    }

    @Override
    public void configureTasks(ScheduledTaskRegistrar taskRegistrar) {
        taskRegistrar.setScheduler(taskExecutor());
        taskRegistrar.addTriggerTask(
                new Runnable() {
                    @Override public void run() {
                        myBean().getSchedule();
                    }
                },
                new Trigger() {
                    @Override public Date nextExecutionTime(TriggerContext triggerContext) {
                        Calendar nextExecutionTime =  new GregorianCalendar();
                        Date lastActualExecutionTime = triggerContext.lastActualExecutionTime();
                        nextExecutionTime.setTime(lastActualExecutionTime != null ? lastActualExecutionTime : new Date());
                        nextExecutionTime.add(Calendar.MILLISECOND, env.getProperty("myRate", Integer.class)); //you can get the value from wherever you want
                        return nextExecutionTime.getTime();
                    }
                }
        );
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2019-12-06T08:52:30.993

您也可以为此使用 Spring 表达式语言 (SpEL)。

**初始化此值后，您将无法更新此值。**

```
@Scheduled(fixedRateString = "#{@applicationPropertyService.getApplicationProperty()}")
public void getSchedule(){
   System.out.println("in scheduled job");
}

@Service
public class ApplicationPropertyService {

    public String getApplicationProperty(){
        //get your value here
        return "5000";
    }
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2020-09-18T09:21:38.747

要创建和管理多个动态计划任务，

计划配置和bean：

```
import org.springframework.context.annotation.Configuration;
import org.springframework.scheduling.Trigger;
import org.springframework.scheduling.TriggerContext;
import org.springframework.scheduling.annotation.SchedulingConfigurer;
import org.springframework.scheduling.config.ScheduledTaskRegistrar;

import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;

@Configuration
@EnableScheduling
public class SchedulingConfigs implements SchedulingConfigurer {

    @Override
    public void configureTasks(ScheduledTaskRegistrar taskRegistrar) {
        taskRegistrar.addTriggerTask(new Runnable() {
            @Override
            public void run() {
                // Do not put @Scheduled annotation above this method, we don't need it anymore.
                System.out.println("Running Schedular..." + Calendar.getInstance().getTime());
            }
        }, new Trigger() {
            @Override
            public Date nextExecutionTime(TriggerContext triggerContext) {
                Calendar nextExecutionTime = new GregorianCalendar();
                Date lastActualExecutionTime = triggerContext.lastActualExecutionTime();
                nextExecutionTime.setTime(lastActualExecutionTime != null ? lastActualExecutionTime : new Date());
                nextExecutionTime.add(Calendar.MILLISECOND, getNewExecutionTime());
                return nextExecutionTime.getTime();
            }
        });
    }

    private int getNewExecutionTime() {
        //Load Your execution time from database or property file
        return 1000;
    }

    @Bean
    public TaskScheduler poolScheduler() {
        ThreadPoolTaskScheduler scheduler = new ThreadPoolTaskScheduler();
        scheduler.setThreadNamePrefix("ThreadPoolTaskScheduler");
        scheduler.setPoolSize(1);
        scheduler.initialize();
        return scheduler;
    }
} 
```

调度服务代码：

```
package io.loadium.resource.service;

import org.springframework.context.event.ContextRefreshedEvent;
import org.springframework.context.event.EventListener;
import org.springframework.scheduling.TaskScheduler;
import org.springframework.stereotype.Service;

import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import java.util.concurrent.ScheduledFuture;

@Service
public class ScheduleTaskService {

    // Task Scheduler
    TaskScheduler scheduler;

    // A map for keeping scheduled tasks
    Map<Integer, ScheduledFuture<?>> jobsMap = new HashMap<>();

    public ScheduleTaskService(TaskScheduler scheduler) {
        this.scheduler = scheduler;
    }

    // Schedule Task to be executed every night at 00 or 12 am
    public void addTaskToScheduler(int id, Runnable task, Date runningDate) {
        ScheduledFuture<?> scheduledTask = scheduler.schedule(task, runningDate);
        jobsMap.put(id, scheduledTask);
    }

    // Remove scheduled task
    public void removeTaskFromScheduler(int id) {
        ScheduledFuture<?> scheduledTask = jobsMap.get(id);
        if (scheduledTask != null) {
            scheduledTask.cancel(true);
            jobsMap.put(id, null);
        }
    }

    // A context refresh event listener
    @EventListener({ContextRefreshedEvent.class})
    void contextRefreshedEvent() {
        // Get all tasks from DB and reschedule them in case of context restarted
    }
} 
```

示例用法：

```
// Add a new task with runtime after 10 seconds
scheduleTaskService.addTaskToScheduler(1, () -> System.out.println("my task is running -> 1"), , Date.from(LocalDateTime.now().plusSeconds(10).atZone(ZoneId.systemDefault()).toInstant()));
// Remove scheduled task
scheduleTaskService.removeTaskFromScheduler(1); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-03-05T08:52:31.460

您也可以使用这种简单的方法：

```
private int refreshTickNumber = 10;
private int tickNumber = 0; 

@Scheduled(fixedDelayString = "${some.rate}")
public void nextStep() {
    if (tickNumber < refreshTickNumber) {
        tickNumber++;
        return;
    }
    else {
        tickNumber = 0;
    }
    // some code
} 
```

`refreshTickNumber`在运行时是完全可配置的，并且可以与`@Value`注释一起使用。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2017-10-25T06:54:39.953

您可以使用 TaskScheduler 和 ScheduledFuture 管理重新启动计划：

```
@Configuration
@EnableScheduling
@Component
public class CronConfig implements SchedulingConfigurer , SchedulerObjectInterface{

    @Autowired
    private ScheduledFuture<?> future;

     @Autowired
        private TaskScheduler scheduler;

    @Bean
    public SchedulerController schedulerBean() {
        return new SchedulerController();
    }

    @Bean(destroyMethod = "shutdown")
    public Executor taskExecutor() {
        return Executors.newScheduledThreadPool(100);
    } 

        @Override
    public void start() {
        future = scheduler.schedule(new Runnable() {
            @Override
            public void run() {
                //System.out.println(JOB + "  Hello World! " + new Date());
                schedulerBean().schedulerJob();
            }
        }, new Trigger() {
            @Override public Date nextExecutionTime(TriggerContext triggerContext) {
                Calendar nextExecutionTime =  new GregorianCalendar();
                Date lastActualExecutionTime = triggerContext.lastActualExecutionTime(); 
           nextExecutionTime.setTime(convertExpresssiontoDate());//you can get the value from wherever you want
                return nextExecutionTime.getTime();
            }
        });

    }

    @Override
    public void stop() {
        future.cancel(true);

    }

    @Override
    public void configureTasks(ScheduledTaskRegistrar taskRegistrar) {
        // TODO Auto-generated method stub
        start();
    }

} 
```

启停界面：

```
public interface SchedulerObjectInterface {    
    void start();
    void stop();
} 
```

现在您可以停止并重新开始（重新启动）使用@Autowired SchedulerObjectInterface 进行调度

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-01T14:11:36.587

简单的 Spring Boot 示例限制为秒、分钟和每小时间隔。此示例的目的是演示两个属性 TimeUnit 和间隔的条件处理。

特性：

```
snapshot.time-unit=SECONDS
snapshot.interval=5 
```

预定方法：

```
@Scheduled(cron = "*/1 * * * * *")
protected void customSnapshotScheduler()
{
    LocalDateTime now = LocalDateTime.now();
    TimeUnit timeUnit = TimeUnit.valueOf(snapshotProperties.getSnapshot().getTimeUnit());
    int interval = snapshotProperties.getSnapshot().getInterval();

    if (TimeUnit.SECONDS == timeUnit
            && now.getSecond() % interval == 0)
    {
        this.camService.writeSnapshot(webcam.getImage());
    }

    if (TimeUnit.MINUTES == timeUnit
            && now.getMinute() % interval == 0)
    {
        this.camService.writeSnapshot(webcam.getImage());
    }

    if (TimeUnit.HOURS == timeUnit
            && now.getHour() % interval == 0)
    {
        this.camService.writeSnapshot(webcam.getImage());
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-30T07:38:02.467

我使用 ThreadPoolTask​​Scheduler from`org.springframework.scheduling.concurrent.ThreadPoolTaskScheduler` 和 scheduleWithFixedDelay 方法创建了动态任务。我还添加了一个 redisson 锁，以防止在分布式环境中重复作业这是我的代码：

```
public class TaskRunnerService {

    private final ThreadPoolTaskScheduler taskScheduler;
    private final RedissonClient redissonClient;

    public TaskRunnerService(ThreadPoolTaskScheduler taskScheduler, RedissonClient redissonClient) {
        this.taskScheduler = taskScheduler;
        this.redissonClient = redissonClient;
    }

    @PostConstruct
    public void runTasks() {
        List<TaskDTO> taskDTOS = TaskHolder.createTasks();
        for (TaskDTO taskDTO : taskDTOS) {
            RLock lock = this.redissonClient.getFairLock("LoadAndRunScheduleService-" + taskDTO.getId());

            if (lock.tryLock()) {
                try {
                    this.taskScheduler.scheduleWithFixedDelay(() -> {
                        System.out.println(" running task " + taskDTO.getId() + " with delay " + taskDTO.getDelay() + " at " + new Date());
                    }, taskDTO.getDelay() * 1000L);
                }finally {
                    lock.unlock();
                }
            }
        }
    }

} 
```

我创建了一个 TaskDTO 类，以便能够在运行时获得延迟：

```
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;

    @AllArgsConstructor
    @NoArgsConstructor
    @Getter
    @Setter
    public class TaskDTO {

        private int id;
        private int delay;
    } 
```

和配置类是：

```
 @Configuration
    public class AppConfig {

        @Bean
        ThreadPoolTaskScheduler taskScheduler(){
            ThreadPoolTaskScheduler scheduler = new ThreadPoolTaskScheduler();
            scheduler.setThreadNamePrefix("ThreadPoolTaskScheduler");
            scheduler.setPoolSize(2);
            scheduler.initialize();
            return scheduler;
        }

    } 
```

# import - 正确使用：在 LESS 中使用 @import 将依赖文件放在一起

> ID：14630543
> 
> 赞同：0
> 
> 时间：2013-01-31T16:29:23.337
> 
> 标签：import, compilation, less

我正在尝试使用 .LESS 进行一些工作，并且遇到了与其他程序员的冲突，并试图在这里找出最佳用途。

本质上，争论是关于正确使用 @import 来将无法自行编译的 .less 文件组合在一起。例如，假设以下..

# 变量.less

```
// some variables are defined here 
```

# 重置.less

```
// variables are used here 
```

# 编译.less

```
@import("variables.less")
@import("reset.less") 
```

现在，如果您尝试 compile `reset.less`，它将失败。因为它需要来自`variables.less`. 对我们中的一个人来说，这非常好，因为它允许我们将项目模块化。但另一个不同意，因为他们声称每个文件都应该独立。

你们中一些更有经验的`.less`编码人员对这个问题有什么看法？什么是“接受”实践？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:52:13.977

显然，对于一家公司而言，“最佳实践”对于另一家公司而言可能并非如此。但是，按照您的说明将它们分开是一种非常常见的做法。[Bootstrap](https://github.com/twitter/bootstrap/tree/master/less)就是这样做的。

如果有必要能够单独编译每个，而且还希望模块化，那么您可以做的就是按照上面的说明保留它，但还要在每个子模块（如`reset.less`）中定义一个

```
@import-once "variables.less" 
```

一开始。这样，如果一个人只是编译`reset.less`它就可以工作，但`compile.less`它只会做文件的初始`import`部分，`variables.less`而不是来自子模块的任何后续调用。

# gradle - gradle 属性有时不起作用

> ID：14630545
> 
> 赞同：0
> 
> 时间：2013-01-31T16:29:25.600
> 
> 标签：gradle

这似乎与这个问题非常相关（哦，不要误会我的意思，gradle 是炸弹......只是偶尔会有一些像这样的小问题）。

[https://stackoverflow.com/questions/14594074/gradle-command-line-ordering-not-working-in-this-case-or-source-dirs-being-ignor](https://stackoverflow.com/questions/14594074/gradle-command-line-ordering-not-working-in-this-case-or-source-dirs-being-ignor)

我有一个 gradle 文件，如果我将以下 $buildDir 更改为输出，它可以工作（并且我在文件中的位置使用 $buildDir ALL 没有问题......

```
sourceSets { 
    main { 
       java {
           srcDir '$buildDir/generated-src'
       }
    }
} 
```

我的完整 gradle 文件在这里，它的失败类似于上面的问题，因为找不到生成的源代码:(。我不确定它是否是同一个问题。这是一个错误吗？

```
subprojects {
   apply plugin: 'java'
   apply plugin: 'eclipse'

   //override gradle's default output directory(build) on every project as it conflicts with 
   //our build script called build causing failures.
   buildDir = 'output'
   project.ext.versionDir = '$buildDir/version'

   repositories {
      mavenCentral()
   }

   if (project.hasProperty('myVersion')) {
     project.ext.realVersion = project.myVersion
     project.version = project.myVersion
   } else {
     project.ext.realVersion = 'Developer-Build'
     project.version = 'Developer-Build'
   }

    test {
        beforeTest { desc -> 
            println "Executing test ${desc.name} [${desc.className}]"
        }
    }

    //generate a version file in all the projects
    task versionFile() << {
        File f = new File('$task.project.name/$versionDir');
        f.mkdirs()
        File v = new File(f, 'version'+project.ext.realVersion)
        println('output version file='+v.getAbsolutePath())
        v.createNewFile()
    }

    task zip(type: Zip) {
    }
    zip.dependsOn('versionFile')
    zip.dependsOn('jar')
    assemble.dependsOn('zip')

    task hello << { task -> println "I'm $task.project.name" }
    build << { task -> println "MASTER: I'm building now" } //"building with classpath=$sourceSets.main.compileClasspath.files"
}

project(':webserver') {
    //play does not follow maven/gradle standard of src/main/java and src/test/java :( :(
    //so we override the directories here...(we should put test in the sourceSets.test.java.srcDirs instead)
    sourceSets.main{
        java.srcDirs = ['app', 'test']
        resources.srcDirs = ['app']
    }

    dependencies {
        compile fileTree(dir: 'lib', include: '*.jar')
        compile fileTree(dir: 'play-1.2.4/framework/lib', include: '*.jar')
        compile fileTree(dir: 'play-1.2.4/framework', include: 'play-*.jar')
    }

    task zip(type: Zip, overwrite: true) << {
        archiveName 'dashboard-'+project.version+'.zip'
        from($versionDir) {
            into('webserver')
        }
        from('..') {
            exclude '**/*.pyc'
            exclude '**/*.class'
            exclude '**/samples-and-tests/**'
            exclude '**/play-1.2.4/documentation/**'
            exclude 'webserver/conf/logback.xml'
            include 'webserver/run*.sh'
            include 'webserver/lib/**'
            include 'webserver/app/**'
            include 'webserver/conf/**'
            include 'webserver/play-1.2.4/**'
            include 'webserver/public/**'
        }
        rename 'prod.(.*)', '$1'
    }

    //playframework has it's own generation of .classpath and .project fils so do not 
    //overwrite their versions.  NEED to call "play.bat eclipsify" here...
    task eclipse(overwrite: true) << {
        if (System.properties['os.name'].toLowerCase().contains('windows')) {
            println "*** WINDOWS "
            def result = exec {
                commandLine 'cmd', '/c', 'play-1.2.4\\play.bat eclipsify' 
            }
        } else {
            println "*** NOT WINDOWS "
            def result = exec {
                commandLine './play-1.2.4/play eclipsify'
            }
        }
    }
}

project(':toneserver') {
    project.ext.genLibDir = file('$buildDir/thirdpartylibs')

    configurations {
        all*.exclude module: 'log4j'
    }

    dependencies {
        compile 'com.google.inject:guice:3.0'
        compile 'com.google.protobuf:protobuf-java:2.4.1'

        //weird, why is their maven not working(we drop it in the directory instead)...
        //compile 'org.asteriskjava:asterisk-java:1.0.0.M3'   

        //to be erased as soon as we get the chance...(we should try this NOW and see if it is needed anymore)
        compile 'commons-configuration:commons-configuration:1.8'
        compile 'org.bouncycastle:bcpg-jdk16:1.46'

        compile project(':webserver')

        //gradle is not sucking in transitive dependencies when they exist in another project so we suck them
        //in ourselves here...
        compile fileTree(dir: '../webserver/play-1.2.4/framework/lib', include: '*.jar')
        compile fileTree(dir: '../webserver/lib', include: '*.jar')
        compile fileTree(dir: '../webserver/play-1.2.4/framework', include: 'play-*.jar')

        compile 'org.bouncycastle:bcpg-jdk16:1.46'

        testCompile 'junit:junit:4.11'
    }

    task generateSources {
        project.ext.outputDir = file("$buildDir/generated-src")
        outputDir.exists() || outputDir.mkdirs()
        if (System.properties['os.name'].toLowerCase().contains('windows')) {
            println "*** WINDOWS "
            def result = exec {
                commandLine 'cmd', '/c', '..\\tools\\protoc\\protoc.exe', '--java_out=output\\generated-src', 'src\\schemas\\agentbridge.proto'
            }
        } else {
            throw new RuntimeException("DARN, protoc only works on windows :( :( right now")
        }
    }
    compileJava.dependsOn("generateSources")
    sourceSets {
        main {
            java {
                srcDir '$buildDir/generated-src'
            }
        }
    }

    tasks.eclipse.dependsOn("generateSources")

    task copyJars(type: Copy) {
        from(configurations.compile) {}
        into genLibDir
    }

    task initconfig(type:Copy) {
       from('src/staging/toneserver') {
          include '**/*'
       }

       into '$buildDir/staging'
    }

    task zip(type: Zip, overwrite: true) << {
        archiveName 'toneserver-'+project.version+'.zip'
        from('src/staging') {
            include 'toneserver/**'
        }
        from('output/thirdpartylibs') {
            into('toneserver/lib')
        }
        from('$versionDir') {
            into('toneserver')
        }
    }

    zip.dependsOn('copyJars')
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T17:53:32.657

你想懒洋洋地评估财产

```
sourceSets { 
    main { 
        java {
            srcDir { "$buildDir/generated-src" }
        }
    }
} 
```

该参数是按照[`Project#file`](http://gradle.org/docs/current/dsl/org.gradle.api.Project.html#org.gradle.api.Project%3afile%28java.lang.Object%29)描述如何将闭包的结果解析为值的方式解析的。这意味着评估会延迟到 buildDir 具有正确的值之后。

您还使用单引号而不是 GString （双引号），所以虽然这会将您的输入作为字符串文字，但现在正在寻找一个名为的 src 目录`$buildDir/generated-src`

# spring-webflow - 使用 Spring Webflow 跨屏幕共享对象

> ID：14630546
> 
> 赞同：1
> 
> 时间：2013-01-31T16:29:26.803
> 
> 标签：spring-webflow

例如，我正在尝试设置一些看起来像设置预订的多屏幕过程的东西。

*   屏幕 1 添加个人信息
*   屏幕 2 联系信息
*   屏幕 3 总结和确认

我已经设置了我的 .jsp 和 xml webflow 以及所有的类，但是我在链接它们时遇到了问题。我想在流程开始时创建一个 Account 类。填写第一个屏幕后，信息将存储在该类中。当在最后一个屏幕上，用户可以根据他提供的信息查看摘要并在必要时进行修改，当他返回第一个屏幕时，信息将已经为他填写好，因此他不必重新输入。

我为代码墙感到抱歉。我试图将它最小化到我能想到的错误的可能位置。

**我的 flow-config.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/webflow
    http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">

    <on-start>
        <evaluate expression="BookingManagementService.createBooking()" result="flowScope.booking" />
    </on-start>

    <view-state id="flow-config"  view="booking/BookingIdentificationScreen" model="booking">
    <binder>
        <binding property="username" />
    </binder>
    <transition on="next" to="enterContactDetails"/>
    <transition on="cancel" to="cancel"/>
</view-state>
    ... 
</flow> 
```

**我的一般 servlet-context.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:webflow="http://www.springframework.org/schema/webflow-config"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc 
        http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/webflow-config
        http://www.springframework.org/schema/webflow-config/spring-webflow-config-2.0.xsd">

    <annotation-driven />

    <resources mapping="/resources/**" location="/resources/" />

    <beans:bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <beans:property name="prefix" value="/WEB-INF/views/" />
        <beans:property name="suffix" value=".jsp" />
    </beans:bean>

    <context:component-scan base-package="com.mycompany.myapp" />

    <beans:bean id="handlerMapping" class="org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping" />
    <beans:bean name="/index.do" class="com.mycompany.myapp.IndexController" />
    <beans:bean name="/home.do" class="com.mycompany.myapp.HomeController" />

    <beans:bean class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <beans:property name="mappings" value="/account/flow-config.do=flowController" />
        <beans:property name="alwaysUseFullPath" value="true"/>
    </beans:bean>

    <!-- SPRING WEB FLOW STUFF -->
    <beans:bean id="flowController" class="org.springframework.webflow.mvc.servlet.FlowController">
        <beans:property name="flowExecutor" ref="flowExecutor"/>
    </beans:bean>

    <webflow:flow-executor id="flowExecutor" flow-registry="flowRegistry"/>

    <webflow:flow-registry id="flowRegistry" flow-builder-services="flowBuilderServices">
        <webflow:flow-location path="/WEB-INF/config/flow-config.xml"/>
    </webflow:flow-registry>

    <webflow:flow-builder-services id="flowBuilderServices" view-factory-creator="viewFactoryCreator"/>

    <beans:bean id="viewFactoryCreator" class="org.springframework.webflow.mvc.builder.MvcViewFactoryCreator">
        <beans:property name="viewResolvers">
            <beans:list>
                <beans:ref bean="viewResolver"/>
            </beans:list>
        </beans:property>
    </beans:bean>

</beans:beans> 
```

**BookingManagementService.java**

```
@Service("bookingService")
public class BookingManagementService{
    @Transactional(readOnly = true)
    public BookingIpl createBooking(Long hotelId, String username) {
        BookingIpl booking= new BookingIpl();
        return booking;
    }
} 
```

**BookingIpl.java**

```
@Entity
public class BookingIpl implements Serializable {
    public String username;
    ...
} 
```

**索引控制器**

```
 @Controller
   public class IndexController extends AbstractController {
    private BookingManagementService bookingService;

    @Autowired
    public IndexController(BookingManagementService bookingService) {
        this.bookingService = bookingService;
    }
    @Override
    protected ModelAndView handleRequestInternal(HttpServletRequest arg0,
            HttpServletResponse arg1) throws Exception {
        return new ModelAndView("index");
    }
} 
```

所以在我的第一个屏幕的java脚本中我会有类似的东西：

```
<form:form modelAttribute="booking" action="${flowExecutionUrl}" method="post">
     <form:input type="text" path="username"/>
</form:form> 
```

在提示到下一个屏幕之后，我想在摘要中返回值，例如

```
 <form:form modelAttribute="booking" action="${flowExecutionUrl}" method="post">
         <spring:bind path="username">${status.value}</spring:bind>
    </form:form> 
```

我得到的错误是：

```
SEVERE: Servlet.service() for servlet [appServlet] in context with path [/myapp] threw exception [Request processing failed; nested exception is org.springframework.webflow.execution.ActionExecutionException: Exception thrown executing [AnnotatedAction@778e65f2 targetAction = [EvaluateAction@25c73030 expression = bookingService.createBooking(), resultExpression = flowScope.booking], attributes = map[[empty]]] in state 'null' of flow 'flow-config' -- action execution attributes were 'map[[empty]]'] with root cause
org.springframework.expression.spel.SpelEvaluationException: EL1008E:(pos 0): Field or property 'bookingService' cannot be found on object of type 'org.springframework.webflow.engine.impl.RequestControlContextImpl' 
```

我尝试了另一种方法来完成所有这些，它在我的 servlet 中定义一个 bean，如下所示：

```
<beans:bean id="bookingBean" class="com.mycompany.myapp.BookingIpl" scope="prototype" /> 
```

但这也无济于事，给出了同样的错误。

我对 web-flow 和 spring 很陌生，所以如果我犯的错误很明显，请原谅我。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T15:29:11.660

使用 Spring Webflow 时使用会话范围不是最佳方式。如果您想在屏幕/流程之间共享对象，请使用对话范围。如果您需要在同一流程中的屏幕之间共享对象，请使用流程范围。

SWF 范围是在 http 会话中定义的会话和请求范围的一种特殊形式。

应用程序所需的任何内容都应存储在 http session 对象中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T13:21:03.743

从看起来你需要在多个流之间共享对象。我想您可以将对象存储在会话范围内

所以

```
<beans:bean id="bookingBean" class="com.mycompany.myapp.BookingIpl" scope="prototype" /> 
```

将改为

```
<beans:bean id="bookingBean" class="com.mycompany.myapp.BookingIpl" scope="session" /> 
```

# xcode - .dcproj 在 OSX finder 中显示为文件夹而不是项目文件

> ID：14630547
> 
> 赞同：0
> 
> 时间：2013-01-31T16:29:28.440
> 
> 标签：xcode, macos, svn, widget

我从 github 下载了一个 .dcproj 文件作为一个小部件（[https://github.com/donatj/Hidden-File-Toggle-Widget](https://github.com/donatj/Hidden-File-Toggle-Widget)），除了 github 已将其变成文件夹，因为据我所知，这就是所有 .dcproj文件是，一个目录结构。（我可能错了，因为我在日常旅行中不使用 .dcproj）

我怎样才能把它变成可用的东西，以便我可以从源代码创建一个小部件？

***编辑：***

我似乎找到了问题所在。似乎 Dashcode 不会随 Xcode 一起自动安装。我现在正在下载它。如果安装 dashcode 解决了问题，我会更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:46:53.007

确保您已安装 Dashcode 以打开 .dcproj 文件。它没有随 Xcode 一起提供。

# wordpress - 将页面显示为具有多个类别的博客 (Wordpress)

> ID：14630550
> 
> 赞同：0
> 
> 时间：2013-01-31T16:29:36.507
> 
> 标签：wordpress

所以这就是我想要做的：69.89.31.103/~infoconc/solutions-that-fit/

在那个页面上，我在旁边有一个类别列表。这些类别下有一大堆页面。当您单击类别链接时，我需要一个模板来巧妙地确定您所在的类别 - 并且只显示那里的代码。

我现在拥有的是这样的：

```
$temp = $wp_query;
$wp_query= null;
$wp_query = new WP_Query('post_type=page&showposts=&cat=id&paged=' . $paged); 
```

我认为需要另一条线，`cat=`但我不知道该放什么以使其动态读取类别，而谷歌没有帮助。:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T20:49:40.777

不要试图重新发明轮子；）只需将archive.php 文件添加到您的主题中。这个模板只需要包含标准循环加上 get_header()、get_footer()、get_sidebar() 和其他你的 index.php 或 page.php 已经包含的东西。WordPress 将自行决定特定类别。

无论如何，请阅读有关[循环](https://codex.wordpress.org/The_Loop)、[主题开发](https://codex.wordpress.org/Theme_Development)和[模板层次结构](https://codex.wordpress.org/Template_Hierarchy)的内容。

值得一读，可以为您节省大量时间。

# .net - 以编程方式更改配色方案excel

> ID：14630551
> 
> 赞同：1
> 
> 时间：2013-01-31T16:29:39.380
> 
> 标签：.net, vsto, excel-2007, excel-2010

我开发了一个 excel 插件，我需要使用一组用户定义的颜色来实现颜色选择器对话框。我发现我可以使用对话框“页面布局”->“主题”->“颜色”->“自定义颜色...”创建一个新的颜色主题。但是，我仍然找不到如何以编程方式更改主题颜色的方法。

也许，没有办法。

请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T20:06:44.357

这是一种方法。

```
 Globals.ThisWorkbook.ApplyTheme("theme.thmx") 
```

[http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k(MICROSOFT.OFFICE.TOOLS.EXCEL.WORKBOOKBASE.APPLYTHEME);k(TargetFrameworkMoniker-%22.NETFRAMEWORK%2cVERSION% 3dV4.0%22);k(DevLang-VB)&rd=true](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k(MICROSOFT.OFFICE.TOOLS.EXCEL.WORKBOOKBASE.APPLYTHEME);k(TargetFrameworkMoniker-%22.NETFRAMEWORK%2cVERSION%3dV4.0%22);k(DevLang-VB)&rd=true)

# android - 警报对话框默认大小

> ID：14630554
> 
> 赞同：1
> 
> 时间：2013-01-31T16:29:43.533
> 
> 标签：android

我有一个 AlertDialog 可以根据其内容自动调整大小（现在是一条简单的文本消息）。有没有办法在不创建自定义布局的情况下为对话框设置默认大小？

如果这是不可能的，我将如何进行自定义布局？我需要做的就是为对话框设置一个默认大小，比如 400 x 300 像素。

另外，对不起，如果这很多，但我将如何在我的代码中实现自定义布局？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:40:19.763

您需要的是 AlertDialog.Builder setView 方法： http: [//developer.android.com/reference/android/app/AlertDialog.Builder.html#setView(android.view.View)](http://developer.android.com/reference/android/app/AlertDialog.Builder.html#setView(android.view.View))

您可以制作自定义 xml 布局并将 layout_width 和 layout_height 属性设置为您希望的任何 DP（首选 PX）。然后，您只需使用 LayoutInflater 来膨胀该视图并将其设置为对话框视图。您甚至可以在视图中有一个 TextView 并在那里设置文本，或者只使用对话框 setMessage 或 setTitle 方法。

# google-drive-api - Google Drive SDK，它可以做到这一点吗？

> ID：14630559
> 
> 赞同：1
> 
> 时间：2013-01-31T16:29:52.670
> 
> 标签：google-drive-api

StackOverFlowers：

我不知道这是否可能，所以我想快速询问。

我可以吗：

1.  创建文档并与其他 Google 用户共享（使用 Google API）
2.  需要时更新该文档。主要是向电子表格中添加内容。

3 .. 如果 1 和 2 是可能的，我用什么库来做这个 .. 我现在正在看 Javascript API，过去我使用过 PHP 库。

任何指导都是有帮助的..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:44:44.403

是的，两者都可以使用 Drive SDK。更新文件可能很棘手，因为您必须下载它，在本地更新它然后重新上传它，但使用 CSV 之类的东西并不难。

对于 Javascript，请查看[Google Drive SDK Javascript 快速入门](https://developers.google.com/drive/quickstart-js)。

# python - 二进制转十进制（数学方式）

> ID：14630561
> 
> 赞同：1
> 
> 时间：2013-01-31T16:29:53.503
> 
> 标签：python, binary, decimal

如果有二进制数：10011100 十进制是156。

我想用数学方法将二进制转十进制。

例如：二进制：10011100

第一个数字是 1： 第四个数字是 1 `2**7`
： `2**4`
第五个数字是 1： `2**3`
第六个数字是 1： `2**2`

然后`2**7+2**4+2**3+2**2 = 156`

我想，我需要使用 string.find() 方法。

```
>>> my_str = '10011100'   
>>> my_str = my_str[::-1]   
>>> print(my_str)   
00111001   
>>> my_str.find('1')   
2   
>>> 
```

我只能找到第一个'1'。

如何找到'1'的所有索引？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T16:32:13.427

为什么要检索索引？您可以像这样简单地迭代这些位：

```
num = sum(2**i for i, bit in enumerate(my_str) if bit == '1') 
```

无论如何，如果您喜欢两个单独的步骤，您可以获得这样的索引：

```
indexes = [i for i, bit in enumerate(my_str) if bit == '1']
num = sum(2**i for i in indexes) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:47:11.107

您还可以检查采用基本参数的内置`int()`函数：

```
int(x[, base]) -> integer 
```

* * *

```
In [1]: my_str = '10011100'

In [2]: int(my_str,2)
Out[2]: 156 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-12T14:47:16.567

**二进制数：** 如果您正在考虑为什么二进制数总是以 2 为底，答案是二进制数以 2 为底，因为它只使用两个符号：通常是“0”（零）和“1”（一） . 例如 10011100（仅使用“零”和“一”）

* * *

如果有二进制数：10011100 十进制是156。这里的*二进制数*是 10011100 它总是有一个基数 2 即使它没有写**10011100** *与* **10011100 基数 2相同**

**将二进制转换为十进制**

*   我们从最右边的数字开始向左移动

    *   将二进制数乘以 2 为底数，幂 (^) 不断增加 1

        (0*2^0)+(0*2^1)+(1*2^2)+(1*2^3)+(1*2^4)+(0*2^5)+(0 *2^6)+(1*2^7)

        =156

* * *

如果您想更清楚地理解这里是一个链接 [ [https://www.mathwarehouse.com/non-decimal-bases/convert-binary-to-decimal.php?ref=driverlayer.com][1]](https://www.mathwarehouse.com/non-decimal-bases/convert-binary-to-decimal.php?ref=driverlayer.com][1])

# c - x86 程序集：在调用#define 的宏时使用#define 常量作为参数

> ID：14630563
> 
> 赞同：3
> 
> 时间：2013-01-31T16:29:56.677
> 
> 标签：c, gcc, assembly, macros, x86

我正在努力在 x86 程序集中手动构建一个 IDT 表。我在 .S 文件中使用 C 预处理器定义了以下宏：

```
// sets up an entry in the idt for a trap type
#define SETUP_IDT_ENTRY( name, num, istrap, segment, dpl ) \
    lea name, %edx; \
    movl $(KCODE << 16), %eax; \
    movw $0x8e00, %dx; \
    lea (idt + (8 * num)), %edi; \
    movl %eax, (%edi); \
    movl %edx, 4(%edi);

// sample set of args to a call to setup_dt_entry
#define M_DIVIDE _t_divide_ep, T_DIVIDE, 0, KCODE, 0

// the call
SETUP_IDT_ENTRY( M_DIVIDE ) 
```

但是，gcc 抱怨：`error: macro "SETUP_IDT_ENTRY" requires 5 arguments, but only 1 given`

我认为#define'd 函数的#define'd 参数在评估函数调用之前已扩展，在这种情况下`M_DIVIDE`将扩展为所需的五个参数并且`SETUP_IDT_ENTRY`会很高兴。我尝试了各种括号组合，但似乎没有任何效果；有没有办法使这项工作？

注意：我知道在 x86 程序集中构建 IDT 有其他方法，但这不是我要在这里回答的问题；我只是想弄清楚宏是否可以扩展为宏参数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T16:48:04.660

The arguments themselves are expanded, but the number of arguments must match the macro definition. You'll need an extra macro to make it work:

```
#define IDT1(x) SETUP_IDT_ENTRY(x)

IDT1(M_DIVIDE) 
```

More info [here](http://gcc.gnu.org/onlinedocs/cpp/Macro-Arguments.html) and [here](http://gcc.gnu.org/onlinedocs/cpp/Argument-Prescan.html#Argument-Prescan).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:47:09.720

它可以通过另一层间接来完成：

```
#define PLEASE_SETUP_IDT_ENTRY(...) SETUP_IDT_ENTRY(__VA_ARGS__)
// the delicate, civilized call
PLEASE_SETUP_IDT_ENTRY(M_DIVIDE) 
```

（如果我们想要一个新的变体只接受一个参数，就不需要变长宏。上面的定义接受一个*或*多个参数）。

# c# - 用 C# 解密 SHA1 值

> ID：14630566
> 
> 赞同：4
> 
> 时间：2013-01-31T16:30:05.520
> 
> 标签：c#, encryption, sha1

我有一个 PHP Web 服务，我发现它正在向我的 C# 传递一个 SHA-1 encrupted 值。传递给我的示例数据是“8cb2237d0679ca88db6464eac60da96345513964”，我知道它可以转换为“12345”。

如何使用类似于以下的代码将哈希值转换回“12345”

```
public static string HashCode(string str)
{
string rethash = "";
try
{

      System.Security.Cryptography.SHA1 hash = System.Security.Cryptography.SHA1.Create();
       System.Text.ASCIIEncoding encoder = new System.Text.ASCIIEncoding();
       byte[] combined = encoder.GetBytes(str);
       hash.ComputeHash(combined);
       rethash = Convert.ToBase64String(hash.Hash);
}
catch (Exception ex)
{
       string strerr = "Error in HashCode : " + ex.Message;
}
return rethash;
} 
```

*   编辑 *

这是一些 RUBY 代码，它也适用于“8cb2237d0679ca88db6464eac60da96345513964”和“12345”

```
require "digest/sha1"
class User
  attr_accessor :password
  def initialize(password)
    @password = hash_password(password)
  end
  def hash_password(password)
    Digest::SHA1.hexdigest(password)
  end
  def valid_password?(password)
    @password == hash_password(password)
  end
end
u = User.new("12345")
p u.password # => "8cb2237d0679ca88db6464eac60da96345513964"
p u.valid_password?("not valid") # => false
p u.valid_password?("12345") # => true 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T16:31:47.117

您无法解密 SHA1 哈希，因为它是单向哈希。

另一个散列方式的例子是 MD5

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T17:04:52.603

12345 将始终以 8cb2237d0679ca88db6464eac60da96345513964 的形式出现，并带有直接哈希。

这意味着，如果您为每个可能的结果创建了一个数据库，理论上您可以查找结果并从中查看 sha1 函数的原始输入是什么。

这是一个安全问题，可能存在诸如字典攻击和彩虹表之类的问题 ( [http://en.wikipedia.org/wiki/Rainbow_table](http://en.wikipedia.org/wiki/Rainbow_table) )。

为了解决这个问题，你永远不应该使用未加盐的哈希。即，您始终使用您已知的值自定义您的哈希值。

例如 sha1("12345" + "mySalt")。

现在您的哈希值很容易计算出来，但与世界上所有使用过 sha1 的人不同。

从技术上讲，你也不应该重复使用相同的盐两次，但这是一个更复杂的概念。

**编辑**：正如 owlstead 在下面指出的那样，应该使用 PBKDF2 和随机盐，而不是静态盐和散列。安全性要好得多。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-31T17:05:02.430

您发布的 ruby​​ 代码似乎没有反转哈希。

它似乎在做的是：

获取密码文本，对其进行哈希处理并存储。

稍后，当它想检查“用户”是否再次输入了相同的密码时，它会从用户那里获取密码文本，对其进行哈希处理，并将哈希值与存储的哈希值进行比较。

这是存储和检查密码的常用方法。不是“去散列”存储的值进行比较，而是散列新值并比较两个散列值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-24T19:22:51.597

您正在寻找的代码是这个

```
SHA1 sha = new SHA1CryptoServiceProvider();
ASCIIEncoding encoder = new ASCIIEncoding(); 
byte[] combined = encoder.GetBytes(pin);
string hash = BitConverter.ToString(sha.ComputeHash(combined)).Replace("-", ""); 
```

其中**pin**是未散列的值，而**hash**是您要比较的值

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-31T16:32:58.470

散列不是可逆操作，如加密。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-31T16:33:28.920

散列不是加密。散列是一种方法，在大多数情况下用于验证数据完整性。

# java - 如何使用 StAX 向现有 XML 文件添加元素？

> ID：14630569
> 
> 赞同：1
> 
> 时间：2013-01-31T16:30:21.453
> 
> 标签：java, xml, stax

我有一个类似于下面的 XML 文件：

```
<?xml version="1.0" encoding="UTF-8"?>  
<a>  
<b id="1">xxx</b>
<b id="2">yyy</b>
<b id="3">zzz</b>
</a> 
```

有没有办法在使用 StAX 解析器`<b id="4">ddd</b>`之后添加一个元素（例如） ？`<b id="3">zzz</b>`我想到的方法是将 XML 的第一部分写入一个新文件，如下所示。

```
<?xml version="1.0" encoding="UTF-8"?>  
<a>  
<b id="1">xxx</b>
<b id="2">yyy</b>
<b id="3">zzz</b> 
```

但是我想不出一个在最后一个元素 ( `<b id="3">zzz</b>`) 之后完全写入的解决方案。我是否需要再次打开一个新文件进行输出？是否可以使用 StAX 来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T05:58:18.093

一个如何自己做的例子：

```
public static void addElementToXML(String value){

      DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
      DocumentBuilder db = null;
      Document doc = null;
      try {

        String filePath = "D:\\Loic_Workspace\\Test2\\res\\test.xml";
        db = dbf.newDocumentBuilder();
        doc = db.parse(new File(filePath));
        NodeList ndListe = doc.getElementsByTagName("b");

        Integer newId = Integer.parseInt(ndListe.item(ndListe.getLength()-1).getAttributes().item(0).getTextContent()) + 1;

        String newXMLLine ="<b id=\""+newId+"\">"+StringEscapeUtils.escapeXml(value)+"</b>";

        Node nodeToImport = db.parse(new InputSource(new StringReader(newXMLLine))).getElementsByTagName("b").item(0);

        ndListe.item(ndListe.getLength()-1).getParentNode().appendChild(doc.importNode(nodeToImport, true));

          TransformerFactory tFactory = TransformerFactory.newInstance();
          Transformer transformer = tFactory.newTransformer();
          transformer.setOutputProperty(OutputKeys.INDENT, "yes");  

          DOMSource source = new DOMSource(doc);
          StreamResult result = new StreamResult(new StringWriter());

         transformer.transform(source, result);

          Writer output = new BufferedWriter(new FileWriter(filePath));
          String xmlOutput = result.getWriter().toString();  
          output.write(xmlOutput);
          output.close();

      } catch (ParserConfigurationException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (SAXException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (TransformerConfigurationException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (TransformerException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

} 
```

请注意，我使用了[Commons Lang](http://commons.apache.org/lang/)中的 StringEscapeUtils 方法。

```
XMLManager.addElementToXML("& dqsd apzeze /<>'"); 
```

**之前的文件：**

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<a>  
<b id="1">xxx</b>
<b id="2">yyy</b>
<b id="3">zzz</b>
</a> 
```

**之后的文件：**

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<a>  
<b id="1">xxx</b>
<b id="2">yyy</b>
<b id="3">zzz</b>
<b id="4">&amp; dqsd apzeze /&lt;&gt;'</b>
</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-13T11:05:35.547

是的，您需要一个临时文件来写入。以下是如何使用 StAX 执行此操作的示例：

```
Path in = Paths.get("file.xml");
Path temp = Files.createTempFile(null, null);
XMLEventFactory eventFactory = XMLEventFactory.newInstance();
try (FileWriter out = new FileWriter(temp.toFile())) {
    XMLEventReader reader = XMLInputFactory.newInstance().createXMLEventReader(new FileReader(in.toFile()));
    XMLEventWriter writer = XMLOutputFactory.newInstance().createXMLEventWriter(out);
    int depth = 0;
    while (reader.hasNext()) {
        XMLEvent event = reader.nextEvent();
        int eventType = event.getEventType();
        if (eventType == XMLStreamConstants.START_ELEMENT) {
            depth++;
        } else if (eventType == XMLStreamConstants.END_ELEMENT) {
            depth--;
            if (depth == 0) {
                List<Attribute> attrs = new ArrayList<>(1);
                attrs.add(eventFactory.createAttribute("id", "4"));
                writer.add(eventFactory.createStartElement("", null, "b", attrs.iterator(), null));
                writer.add(eventFactory.createCharacters("ddd"));
                writer.add(eventFactory.createEndElement("", null, "b"));
                writer.add(eventFactory.createSpace(System.getProperty("line.separator")));
            }
        }
        writer.add(event);
    }
    writer.flush();
    writer.close();
} catch (XMLStreamException | FactoryConfigurationError e) {
    throw new IOException(e);
}
Files.move(temp, in, StandardCopyOption.REPLACE_EXISTING); 
```

# c++ - 如何让信息记录更容易？

> ID：14630573
> 
> 赞同：1
> 
> 时间：2013-01-31T16:30:28.070
> 
> 标签：c++, logging

我正在开发一个 GUI 应用程序。我有一个主窗口。主窗口有一个信息窗口，用于记录当前操作的一些基本信息，例如在做什么，需要多长时间。代码如下：

```
class InfoWindow
{
public:
    InfoWindow();

    void Record(const string& info);
};

class MainWindow
{
public:
   void OperationInMainWindow()
   {
        // Perform the operation.
        ...

        // Record the operation information (okay here since m_infoWindow is
        // accessible.
        m_infoWindow.Record(...);
   }

private:
    InfoWindow m_infoWindow;

    // Many other windows. Other windows have also operations whose information
    // need to record. And getting worse, the other windows have children
    // windows who have to record operation information in the main window's
    // info window.
    OtherWindow1 m_otherWindow1; //  
    OtherWindow2 m_otherWindow2;
    ...        
}; 
```

如何让信息记录更容易？我尝试对信息窗口使用单例，但不是很满意，因为信息窗口的生命周期应该由主窗口控制。非常感谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:16:55.917

您所描述的是一种日志记录形式，并且日志记录通常使用单例对象完成。（这是单例的极少数合理用途之一。）

您可以有一个将消息定向到当前信息窗口的单例日志记录对象。所以你会创建你的日志对象，默认情况下，它只是把消息扔掉。创建 InfoWindow 时，它会将自身“注册”到日志对象。从那时起，日志对象将消息定向到信息窗口。当 InfoWindow 被销毁时，它会注销日志记录对象。

这样做的好处是您可以使用单例日志记录对象也将字符串复制到日志文件、控制台窗口或其他任何内容。

通过使用发布者/订阅者模型，您可以变得更加通用和解耦，但这可能比您目前想要和需要的更复杂。

# jquery-ui - jQuery 可拖动对通过 ajax 调用添加的元素不起作用

> ID：14630579
> 
> 赞同：4
> 
> 时间：2013-01-31T16:30:44.707
> 
> 标签：jquery-ui, jquery, dynamic, jquery-ui-draggable

我有一个要通过对话框更新的对象列表。当用户单击刷新按钮时，它会重新加载更新的列表并将同一个表附加到列表中。但是，当我重新加载更新的列表时，jQuery UI 的可拖动功能停止工作。我尝试在 ajax 成功处理程序中和发生 ajax 调用之后插入 $('draggable').draggable 行，但均未成功。我还有一个用于可拖动容器的 jquyer 实时事件处理程序，该处理程序在刷新列表时不起作用。

下面是我最初加载列表的代码、可拖动容器的实时函数以及用户单击刷新按钮时的函数。在下面的代码中，我还尝试将 ui-draggable 类添加到对象中，但这不起作用：

```
$.ajax({
 async: false,
 type: 'POST',
 url: 'collection.php',
 success: function(data) {
    $("#collection").append(data);
 }
});

$("#refresh_collection").click(function(){
$("#collection").html("");
$.ajax({
     async: false,
     type: 'POST',
     url: 'collection.php',
     success: function(data) {
        $("#collection").append(data);
        $('.draggable_container:not(.ui-draggable)').live("mouseover",     function(){
            $(".draggable_container").addClass("ui-draggable");
        });
     }
});
});

$('.draggable_container').live('mouseover',function(){
$(this).draggable({
    cursor: "move",
    cursorAt: { top: -5, left: -5 },
    stop: function(){}
})
}); 
```

* * *

我能够使用 on 函数而不是实时使可拖动对象工作，但现在我意识到在打开 jquery UI 对话框后它们不起作用，关闭它然后单击刷新按钮。如果我只是单击刷新按钮而不先打开对话框，那么一切正常。但是，如果我打开对话框，将其关闭然后单击刷新按钮，则可拖动会关闭，但如果我只是打开对话框并关闭它而不按刷新按钮，它确实有效。有想法该怎么解决这个吗？当我关闭对话框时，销毁可拖动对象然后重新初始化它听起来像解决方案吗？

我最终希望在对话框像这样关闭时发生 ajax 调用，但是这段代码仍然无法正常工作。任何帮助将不胜感激。

```
var $dialog = $("#upload_dialog").dialog({
autoOpen: false,
height: 375,
width: 500,
modal: false,
open: function() {
    $("body").draggable("destroy");
    $tab_title_input.focus();
},
close: function() {
    $.ajax({
         async: false,
         type: 'POST',
         url: 'collection.php',
         success: function(data) {
            $("#collection").html(data);
            $("body").on("mouseover", ".draggable_container", function(){
                $(".object_container").draggable({
                    cursor: "move",
                    cursorAt: { top: -5, left: -5 },
                    stop: function(){}
                })
            });
        }
    });
}
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T18:08:11.067

删除第一个`.live`调用并将第二个`.live`调用更改为以下内容：

```
 $('body').on('mouseover', '.draggable_container',
    function(){ 
        $(this).draggable({ cursor: "move", cursorAt: { top: -5, left: -5 }, stop: function(){} }); 
}); 
```

# c# - “前缀”和“作为”转换

> ID：14630581
> 
> 赞同：6
> 
> 时间：2013-01-31T16:30:55.553
> 
> 标签：c#, casting, type-conversion

这似乎是一个关于选角的非常愚蠢的问题，但是......

我有以下设置：

有许多类派生自一个主类。在某个时间和空间点，我得到一个项目，并希望将其作为子类的对象处理。

假设：

```
class subClassA : mainclass 
class subClassB : mainclass 
```

现在我有一些如果要问它是哪个类：

```
if(someObject is subClassA)
{
    subClassA aA = someObject as subClassA ;
} 
```

虽然对于大多数子类返回了正确的对象，但我为一个子类得到了一个`null`-Object。

如果我执行以下操作：

```
if(someObject is subClassA)
{
    subClassA aA = someObject as subClassA ; // <- aA = null; someObject is shown in debugger as object of subClassA

    object test = someObject as subClassA; // <- object is not null
    // or 
    subClassA aB = (subClassA)someObject; // <- object is not null, shows the correct object
} 
```

我在`test`和中有结果`aB`。

我不明白的是：

为什么`as`失败并且前缀转换成功？

* * *

现在我完全迷路了。

```
if(someObject is subClassA)
{
    subClassA aA = someObject as subClassA ; // <- aA = null; someObject is shown in debugger as object of subClassA

    subClassA aB = someObject as subClassA ; // <- aB != null.
}

if(someObject is subClassA)
{
    subClassA aB = someObject as subClassA ; // <- aB != null.
} 
```

名称 aA 是本地定义的。只有一个线程访问该方法。如果我只是重命名 aA 它可以工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:09:01.590

您所描述的场景至少可以说令人困惑，所以您可以尝试以下操作：

```
subClassA aA = (someObject as subClassA) ?? (subClassA)someObject; 
```

这行得通吗（例如`aA`不为空）？

您可能想参考以下帖子以了解有关以下内容的一些详细信息`as`：

[在 CLR 中强制转换与使用“as”关键字](https://stackoverflow.com/questions/496096/casting-vs-using-the-as-keyword-in-the-clr)

仍在调查更多，但我不确定如何重新创建场景......

编辑：

[从一些非常聪明的人（ Skeet](https://stackoverflow.com/users/22656/jon-skeet)和[Lippert](https://stackoverflow.com/users/88656/eric-lippert) ）那里阅读了很多内容，试图找到答案......

见`is`文档：

[http://msdn.microsoft.com/en-us/library/scekt9xw(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/scekt9xw(v=vs.110).aspx)

`as`/ 转换文件：

[http://msdn.microsoft.com/en-us/library/ms173105.aspx](http://msdn.microsoft.com/en-us/library/ms173105.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T18:23:27.783

在[MSDN](http://msdn.microsoft.com/en-us/library/cscsdfbt%28v=vs.71%29.aspx)中，“as”相当于：

```
expression is type ? (type)expression : (type)null 
```

因此，根据 MSDN，在您的代码中：

```
if(someObject is subClassA)
{
    subClassA aA = someObject as subClassA ;
} 
```

相当于

```
if(someObject is subClassA)
{
    subClassA aA = someObject is subClassA ? (subClassA)someObject : (subClassA)null ;
} 
```

由于`someObject is subClassA`出现在两条线上，我唯一能想到的就是 1) someObject 在某些情况下实际上是空的；或者，2）您有一个多线程应用程序并且您的代码不是线程安全的（即，有时“is”行是正确的，但是当到达“as”行时，隐含的“is " 变成了假的。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T01:30:53.043

> 虽然在大多数情况下会返回正确的对象，但有时我会得到一个空对象。

您的问题只有一个简单的解释。*someObject*引用正在被另一个线程修改。您需要使用*lock*语句来保护它。

# jquery - 几个div来划分外部div高度并填充它

> ID：14630583
> 
> 赞同：4
> 
> 时间：2013-01-31T16:31:09.427
> 
> 标签：jquery, css, html, height

我有几个 div，我需要它们来填充内容高度，以便每个 div 具有相同的高度。它们的高度必须响应浏览器窗口的大小调整，因此无法修复。div 的数量可以在 7 到 12 之间变化。我不知道这是否可以使用纯 css 或 jquery 来完成。

之前：
[原始 div http://imageshack.us/a/img14/9964/23446096.jpg](http://imageshack.us/a/img14/9964/23446096.jpg)

之后：
[调整大小的 div http://imageshack.us/a/img42/9183/76164750.jpg](http://imageshack.us/a/img42/9183/76164750.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:36:40.097

您必须将 jQuery 与以下内容一起使用：

```
var $yourDivs = $('div');
function update(){
    var $winHeight = $(window).height();
    var $divNumber = $yourDivs.length;
    var $newDivHeight = ($winHeight / $divNumber);
    $yourDivs.css('height', $newDivHeight + 'px');
}; 
```

但不是获取窗口高度，而是获取内容区域的高度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T17:01:26.853

这并没有我想象的那么糟糕。请参见下面的代码：

**HTML**

```
<html>
<head>
    <title>Test divs</title>
</head>
<body>
    <div id="header">Head</div>
    <div id="content">
        <div id="div1">Div 1</div>
        <div id="div2">Div 2</div>
        <div id="div3">Div 3</div>
        <div id="div4">Div 4</div>
        <div id="div5">Div 5</div>
    </div>
    <div id="footer">Footer</div>
</body> 
```

**CSS**

```
body, html {
    height: 100%;
}

body, body * {
    margin: 0;
    padding: 0;
}

#header, #content, #footer, #div1, #div2, #div3, #div4, #div5 {
    border: 1px solid black;
}

#content {
    position: relative;
    height: 80%;
}

#div1, #div2, #div3, #div4, #div5 {
    position: absolute;
    right: 0;
    height: 20%;
    width: 150px;
}

#div1 {
    top: 0;
}

#div2 {
    top: 20%;
}

#div3 {
    top: 40%;
}

#div4 {
    top: 60%;
}

#div5 {
    top: 80%;
} 
```

（边框仅供视觉参考）根据 div 有多少（100% / div 个数，从 0 开始）调整 div 的高度和顶部位置。根据对此问题的评论[，](https://stackoverflow.com/questions/1575141/make-div-100-height-of-browser-window)它在 IE8 中不起作用，但我目前无法对其进行测试。确认在 IE9、具有兼容模式的 IE9、Chrome 24 和 FF 18 中工作。

# ruby-on-rails-3 - 使用单个上传器验证 CarrierWave 多种文件类型

> ID：14630584
> 
> 赞同：4
> 
> 时间：2013-01-31T16:31:20.643
> 
> 标签：ruby-on-rails-3, carrierwave

使用单个上传器处理多种文件类型时如何验证上传文件的扩展名？

我正在使用单个模型，即包含属性文件的 Asset。上传器安装在文件属性上。资产模型还有一个名为 feature_id 的属性。feature_id 指的是视频、音频等特征。

那么，我应该如何根据 feature_id 值验证具有多个扩展名白名单的文件类型？

使用 ruby​​ 1.9 和 rails 3.2.11

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-28T12:51:14.663

尽管答案已被接受，但我对此有更好的方法。试试这个代码。

```
class MyUploader < CarrierWave::Uploader::Base
  def extension_white_list
    if model.feature_id == 1
      %w(jpg jpeg gif png)
    elsif model.feature_id == 2
      %w(pdf doc docx xls xlsx)
    elsif model.feature_id == 3
      %w(mp3 wav wma ogg)
    end
  end
end 
```

`feature_id == 1`意味着您只允许上传图片，`feature_id == 2`意味着只允许上传文件，并且只`feature_id == 3`允许您上传音频文件。

希望它能回答这个问题。您可以为其他类型的文件添加更多检查。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-15T00:18:10.613

在您的上传器中定义您的白名单，如carrierwave 的文档中所示。

```
class MyUploader < CarrierWave::Uploader::Base
  def extension_white_list
    %w(jpg jpeg gif png)
  end
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T20:06:14.743

我遇到了完全相同的用例：

在**Asset.rb 中** 验证文件名的格式

```
validates :asset_file,
                 format:{
                    with: %r{\.(pdf|doc|png)$}i, message: "Wrong file format"
                        } 
```

使用正则表达式来测试文件名：

在这里您可以使用正则表达式： [http ://rubular.com/r/Z3roRDDXAf](http://rubular.com/r/Z3roRDDXAf)

希望这可以帮助！

# iphone - 应用内购买未获取产品列表

> ID：14630587
> 
> 赞同：1
> 
> 时间：2013-01-31T16:31:22.853
> 
> 标签：iphone, in-app-purchase, storekit

我已经为我的产品注册了应用内购买。我创建了一个示例应用程序来获取产品。它工作得很好。

当我将该代码集成到我现有的应用程序中时，我得到了空的产品列表。两个项目中的应用内相关类相同，因此产品标识符也相同，并且所有请求响应过程都相同。

我试图将相同的捆绑标识符保留给我用于该应用程序注册产品的机器人应用程序，并且我的两个项目（主要和示例）中的配置文件也相同。

我不知道，但由于某种原因，我在将产品放入样品时没有将产品放入我的项目中。

这是代码

```
 -(void)requestProducts
 {
    NSSet * prodIdentifiers=[NSSet setWithObjects:@"com.test.product1", @"com.test.product2", nil];
    self.reqProdcut = [[[SKProductsRequest alloc] initWithProductIdentifiers:prodIdentifiers] autorelease];
    reqProdcut.delegate = self;
    [reqProdcut start];
    self.ReceiptData=[NSMutableData data];
}

- (void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response 
{
    NSLog(@"Received products results... %@", response.debugDescription);

    NSLog(@"%@",response.products);
    self.products =response.products; // here I get empty array in response.products

} 
```

请提供任何帮助。

**编辑**

刚刚浏览了这个 [Link]（[应用内购买 response.products 为空](https://stackoverflow.com/questions/6654316/in-app-purchase-response-products-empty)）

我的应用程序中的所有产品标识符都在我的示例中，`response.invalidProductIdentifiers`而在我的示例中都是正确的。

# assembly - 使用小数据区域的性能损失？

> ID：14630589
> 
> 赞同：0
> 
> 时间：2013-01-31T16:31:30.067
> 
> 标签：assembly, powerpc, sda

我正在查看 IBM 的[**Developing PowerPC Embedded Application Binary (EABI) Compliant Programs**](https://www-01.ibm.com/chips/techlib/techlib.nsf/techdocs/852569B20050FF77852569970071B0D6/$file/eabi_app.pdf)，特别是第 7 页的表 4。

![在此处输入图像描述](../Images/05563216544066a95ec858b552c02b7f.png)

基准测试结果是不使用 SDA 时为 88kDhry/sec，而使用 SDA 时仅为 77kDhry/ *sec*。我本来希望使用 SDA 不仅可以减少代码大小，还可以提高性能，因为访问变量只需要两条而不是三条指令。有人能解释一下表中的数字吗？

我错过了什么？

# c# - Timer.Stop 上的随机 NullReferenceException

> ID：14630591
> 
> 赞同：1
> 
> 时间：2013-01-31T16:31:36.577
> 
> 标签：c#

我有一个 System.Timers.Timer 在我调用 Stop() 方法时随机抛出 NullReferenceException。这可能发生在一个工作日大约 4 次。我已经看到该问题在多台计算机上重复出现。

```
void myTimer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
{
  if (myTimer != null) //trying to stop the exception here
  {
    myTimer.Stop(); //Null Reference Exception occurs here

    DoStuff();

    myTimer.Start();
  }
} 
```

堆栈如下所示：

![堆](../Images/c737ab79de7f40945d71afd60ad562c1.png)

最奇怪的是，我可以立即从异常位置再次启动程序，没有任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:49:37.583

尝试这个

```
void myTimer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
{
  lock(this) {
  if (myTimer != null) //trying to stop the exception here
  {
    myTimer.Stop(); //Null Reference Exception occurs here

    DoStuff();

    myTimer.Start();
  }
  }
} 
```

# php - 在其他站点使用 joomla 天气输出

> ID：14630596
> 
> 赞同：1
> 
> 时间：2013-01-31T16:31:47.747
> 
> 标签：php, joomla, joomla2.5

我有一个 Joomla 站点并安装了一个天气模块，现在天气显示在页面中。

我有另一个没有 Joomla cms (PHP) 的网站

如何在我的 PHP 站点中使用 Joomla 天气模块输出？

我使用的扩展：http: [//www.joomshaper.com/joomla-extensions/sp-weather](http://www.joomshaper.com/joomla-extensions/sp-weather)

模块一些代码：

```
defined('_JEXEC') or die('Restricted access');    
$moduleName             = basename(dirname(__FILE__));
$moduleID               = $module->id; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:22:04.373

直接与 yahoo 天气 api 集成会更容易。

[http://developer.yahoo.com/weather/](http://developer.yahoo.com/weather/)

# jquery - Cargo Collective 和 Tooltipster

> ID：14630599
> 
> 赞同：1
> 
> 时间：2013-01-31T16:31:57.373
> 
> 标签：jquery, tooltip, cargo, tooltipster

我试图到处寻找某种指导，但我真的不知道该怎么做。我经常来这个网站寻找以前回答的问题，但找不到任何关于货物和工具提示器的信息。这甚至可能是不可能的，我不确定。

* * *

**问题**：我已尽我所能遵循工具提示步骤。( [http://calebjacob.com/tooltipster/#getting-started](http://calebjacob.com/tooltipster/#getting-started) ) 我觉得我做的一切都是正确的，我不知道为什么它不起作用。请记住，我对 jquery 非常陌生，我正在努力做到最好，哈哈。

这是我的网站：[http](http://emengel.net/) ://emengel.net/我不确定要提供什么其他信息。我知道 cargo 已经在 jquery 上运行，我也可以拥有 tooltipster 吗？

# c - 使用指针将结构添加到数组

> ID：14630604
> 
> 赞同：0
> 
> 时间：2013-01-31T16:32:16.007
> 
> 标签：c, pointers, struct

我对 C 语言和分配内存/使用指针相当陌生。无论如何，我正在尝试读取文件，将这些值放入结构中，等等。我确切地知道我想要做什么，当然程序运行但输出不正确并且某种混乱的数字和字母。

每行都有一个包含新信息的文本文件。每条线代表一个对象。

文件中的一行可能如下所示：

```
肉牛腩 6.55 8 8.50 4
```

总的来说，我希望能够将所有`PRODUCT`对象存储在一个数组中（所以我有一个结构数组）。所以我尝试使用指针分配内存，使用行数，然后将指针发送到名为 read 的函数。在读取中，我通过指针将每个结构添加到数组中。该程序没有崩溃，输出不正确，我不知道为什么不。这很可能是带有指针的东西。如果有人可以帮助我，我将不胜感激。任何帮助都会很棒。

```
 //prototype
void read(pointerToArr);

typedef struct
{
    char supType[15];
    char prodName[15];
    double wholePrice;
    int quantWhole;
    double retPrice;
    int retProdQuantity;
}PRODUCT;

FILE *fr;
int lineCount = 0;
int main()
{
    PRODUCT *ptr;

    int i;
    char check[50];

     fr = fopen("ttt.txt", "r");

      while(fgets(check, sizeof(check), fr)!= NULL)
      {
          if(check[0] != '\n')
          {
              lineCount++;
          }
      }
    // allocate memory for array based on line count.
     PRODUCT prodContainter[lineCount];
     ptr = (PRODUCT*)malloc(sizeof(PRODUCT)*lineCount);
     ptr = prodContainter;

     read(ptr);

      //print after adding to array via pointer from other
      //function. this was a test.

      for(i = 0; i < lineCount; i++)
      {
          printf("%s ", prodContainter[i].supType);
          printf("%s ", prodContainter[i].prodName);
          printf("%f ", prodContainter[i].wholePrice);
          printf("%d ", prodContainter[i].quantWhole);
          printf("%f ", prodContainter[i].retPrice);
          printf("%d\n\n", prodContainter[i].retProdQuantity);

      }

    return 0;
}

void read(PRODUCT *pointerToArr)
{

    // objective in this method is to read in data from the file, create an object for every line and
    // then use the pointer array to add those objects to prodConstainer up above.

       char supplyName[15];
       char productName[15];
       double wholeP = 0;
       int  quantityWhole = 0;
       double retailPrice = 0;
       int retailProductQuant = 0;

    while(fscanf(fr, "%s %s %lf %d %lf %d", supplyName, productName, &wholeP, &quantityWhole, &retailPrice, &retailProductQuant) == 6)
    {
        PRODUCT record;
        int i;

        strcpy(record.supType, supplyName);
        strcpy(record.prodName, productName);
        record.wholePrice = wholeP;
        record.quantWhole = quantityWhole;
        record.retPrice = retailPrice;
        record.retProdQuantity = retailProductQuant;

        for(i = 0; i < lineCount; i++)
        {
            pointerToArr[i] = record;
        }
    }

    fclose(fr);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:34:31.540

您永远不会倒带文件，因此计算行数后的所有读取都会失败。

您正在打印的只是内存中的内容。

当然，有很多方法可以解决这个问题。

1.  倒带文件，使用[`rewind()`](http://linux.die.net/man/3/rewind)
2.  关闭文件并让您的`read()`函数（其名称与 POSIX 标准函数冲突，顺便说一句）重新打开文件。这也将涉及删除可怕的全局变量`fr`。
3.  重新构建结构，这样您就不会计算行数，只需读取并让`ptr`数组根据需要增长（请参阅 参考资料[`realloc()`](http://linux.die.net/man/3/realloc)）。

此外，您应该真正避免强制转换[in C](https://stackoverflow.com/a/605858/28169)[的返回值`malloc()`](https://stackoverflow.com/a/605858/28169)。这：

```
ptr = (PRODUCT*)malloc(sizeof(PRODUCT)*lineCount); 
```

最好写成：

```
ptr = malloc(lineCount * sizeof *ptr); 
```

这消除了强制转换，并且还使用`sizeof` *指向的类型的值* 来自动计算要分配的正确字节数。

# oracle11g - 不能tnsping但可以sqlplus连接

> ID：14630607
> 
> 赞同：1
> 
> 时间：2013-01-31T16:32:32.947
> 
> 标签：oracle11g

我有一个问题希望有人可以向我解释。我在服务器上正确安装了 Oracle 11g。在工作站上，我安装了 tnsname.ora 指向 Oracle 数据库的 oracle 客户端。我可以 ping 到安装了 oracle db 的服务器。我可以使用 sqlplus 连接到数据库，甚至可以使用 C# 以编程方式连接到数据库。但是，我不能 tnsping 到它。我在尝试这样做时收到错误消息 3511 未找到。所以我的问题是：在什么情况下使用 tnsping 以及如何使 tnsping 工作？换句话说，如果我的 tnsping 不起作用但我仍然可以使用 C# 以编程方式连接到数据库，那么我应该担心什么？我是甲骨文的新手.. 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T18:39:03.217

我尝试执行以下操作但没有成功，尽管它们是类似于我的类似场景的最流行的答案。

```
1) Set Oracle_Sid to my oracle sid
2) Set Oracle_Home to my oracle home directory 
```

我为解决问题所做的工作：

```
1) Uninstall oracle client
2) Reinstall the oracle client with the newest version 11.2.xx. 
```

我相信，重新安装早期版本的 oracle 客户端也可以。但是，由于我必须重新安装客户端，我可能想要获得最新版本。原因可能是第一次安装不正确，因为我们有预装应用程序的磁盘映像来自动准备新计算机。无法 tnsping 似乎不会妨碍其他 Oracle 操作（至少我不知道）。

如果有人知道不能 tnsping 但可以 sqlplus 连接、ping ... 的限制是什么，如果您能分享，我将不胜感激。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:37:55.833

您的 $Oracle_Home 值未设置或您的默认 sid 未在 $ORACLE_SID 中设置

试试这个 ：

```
set ORACLE_SID=mysid
export ORACLE_SID
tnsping mysid 
```

看看它会带来什么。

# c# - 为什么算术表达式未针对 C# 中的 0 乘法进行优化

> ID：14630609
> 
> 赞同：1
> 
> 时间：2013-01-31T16:32:40.420
> 
> 标签：c#, programming-languages, expression, compiler-optimization

为了评估乘法，您必须评估第一项，然后是第二项，最后将这两个值相乘。

假设每个数字乘以 0 都是 0，如果第一项的评估返回 0，我希望整个乘法被评估为 0，而不评估第二项。

但是，如果您尝试此代码：

```
var x = 0 * ComplexOperation(); 
```

尽管我们知道 x 为 0，但仍调用函数 ComplexOperation。

优化的行为也将与仅在第一项被评估为真时才评估第二项的布尔运算符“&&”一致。（'&' 运算符在任何情况下都会评估这两个术语）

我测试了这种行为，`C#`但我想几乎所有语言都是一样的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-31T16:33:29.240

首先，对于浮点，您的断言甚至不正确！考虑`0 * inf`不是 0，`0 * nan`也不是 0。

但更一般地说，如果你在谈论**优化**，那么我猜编译器可以自由地不评估`ComplexOperation`它是否可以证明没有副作用。

但是，我认为您实际上是在谈论**短路语义**（即语言功能，而不是编译器功能）。如果是这样，那么真正的理由是 C# 正在复制早期语言（最初是 C）的语义以保持一致性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-31T16:37:51.263

C# 不是函数式的，因此函数可能会产生副作用。例如，您可以从内部打印某些内容`ComlpexOperation`或更改全局静态变量。所以，是否被调用是由`*`合约定义的。

`&`您发现自己是与和的不同合同的示例`&&`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-31T16:36:45.150

该语言定义了哪些运算符具有短路语义，哪些没有。你的`ComplexOperation`函数可能有副作用，这些副作用可能是故意的，编译器不能自由地假设它们不应该仅仅因为函数的结果没有被有效地使用而发生。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-31T16:36:24.930

我还将添加这将是混淆的语言设计。会有很多这样的问题...

```
//why is foo only called 9 times?????????
for(int i = 0; i < 10; i++) {
    print((i-5)*foo());
} 
```

为什么允许短路布尔值而不是短路`0*`？好吧，首先我要说的是，将短路布尔值与副作用混合是代码中错误的常见来源 - 如果在将其理解为明显模式的维护者中使用得当，那么它可能没问题，但对我来说很难想象一下，程序员已经习惯了整数中的 0 洞。

# c++ - 使用 OpenAL 播放声音

> ID：14630610
> 
> 赞同：0
> 
> 时间：2013-01-31T16:32:49.397
> 
> 标签：c++, boost, openal, playsound

我不明白如何使用 OpenAL 库播放声音。我为 VoIP 编写程序。我得到每 10 毫秒的声音缓冲区。

```
size_t len = socket.read_some(boost::asio::buffer(buf),error); 
```

缓冲区是

```
boost::array <char, 441> buf; 
```

我需要用这个缓冲区做什么？我正在阅读示例，但不明白 :(。请帮助我。PS 我在 Visual Studio 2010 上使用 C++。编辑后

```
 alGenSources(1, &alSource);
    alGenBuffers(1, &alSampleSet);
    alBufferData(alSampleSet, AL_FORMAT_MONO16, buf.data(), sizeof(buf.data()), 44100);
    alSourcei(alSource, AL_BUFFER, alSampleSet);
    //
    alSourcei(alSource, AL_LOOPING, alSampleSet);
    alSourcePlay(alSource); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:19:36.437

`buf.data()`返回一个指针，它的*大小*可能是 32 位或 64 位。

相反的*大小*是; 请求的大小是缓冲区中的字节数，即数组中的元素数乘以每个元素的大小或。*[注意**可能有效，至少在当前的 Boost 实现中，但我认为这不能保证]*`array``buf.size()``alBufferData``buf.size()``sizeof(buf.front())``sizeof(char)`
*`sizeof(buf)`*

您正在指定一种`AL_FORMAT_MONO16`通道格式，但您使用的是一个奇数大小的 8 字节缓冲区。所以这可能是数组声明或格式规范中的错误。根据您的其余问题，我假设您的意思是`AL_FORMAT_MONO8`那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-05T22:48:45.640

你必须保持声音活着，试试这个功能。

```
void keepItPlay(unsigned int * source)
{
    ALint state;
    alGetSourcei(source, AL_SOURCE_STATE, &state);
    if(state == AL_STOPPED) CleanUp(source);
} 
```

# c++ - C ++ - 计算披萨中的切片数

> ID：14630612
> 
> 赞同：-1
> 
> 时间：2013-01-31T16:33:02.077
> 
> 标签：c++, visual-studio-2010

我编写了这个程序来计算给定大小的比萨饼（直径）的切片数。但结果似乎有点偏离......任何帮助将不胜感激:)

例如：如果我输入 18 英寸的披萨，结果是 4.00344 片……如果我输入 22 英寸的披萨，结果是 4.8931 片……

请参见下面的代码：

```
 #include <iostream>
using namespace std;
int main()
{
    // Title of CMD Window
    system("title How many Slices are in your Pizza?");
    // Declare variables    
    double  diameter = 0.0,     // Diameter of the pizza
            slices = 0.0,       // No. of slices in the pizza
            area = 0.0,         // Area of the whole pizza
            oneSlice = 14.125;  // Area of one pizza slice
    const double PI = 3.14159;
    // Display prompt   
    cout << "What is the diameter of the pizza (inches):" << "\n";
    cin >> diameter;
    //  Calculate the area of the pizza
    area = PI * diameter;
    // Calculate number of slices for the size of pizza given
    slices = area / oneSlice;
    // Display results
    cout << "\n\n" << "You have " << slices << " slice(s) in this pizza:" <<  "\n\n"
         << "************************************" << "\n"
         << "\tDiameter of pizza= " << diameter << "\n"
         << "\tArea of pizza= " << area << "\n"
         << "************************************" << "\n";
    system("pause"); 
    return 0;
} 
// End of program 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:36:03.390

圆的面积不是`pi * diameter`：那是周长。

你需要`area = PI * (diameter / 2.0) * (diameter / 2.0);`

# javascript - 将 2 位日期转换（格式化）为 4 位日期

> ID：14630613
> 
> 赞同：5
> 
> 时间：2013-01-31T16:33:02.963
> 
> 标签：javascript, jquery

我无法将 2 位日期正确格式化为 4 位日期。

我有一个文本输入字段：

```
<input type="text" value="" class="date"/> 
```

然后我想在用户输入日期后将其格式化为“mm/dd/yyyy”格式。所以我有一个 onChange 事件：

```
$('.date').on('change',function(){
    var date = new Date($(this).val());
    $(this).val((date.getMonth()+1)+'/'+date.getDate()+'/'+date.getFullYear());
}); 
```

好的，现在奇怪的事情来了（我将使用 12/12/12 作为示例日期）：

1) getFullYear() 在所有 IE、FF 中返回 1912。Chrome 2012 年回归。

2) getYear() 在 IE、Chrome 中返回 112。FF 返回 12。

因此，此时似乎唯一的选择是嗅探用户代理，并相应地使用它。有没有嗅探UA？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-03-08T02:19:10.397

使用[moment.js](http://momentjs.com/docs/#/parsing/)：

```
const moment = require("moment")
const date = moment("21", "YY")
const year = date.format("YYYY") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:45:16.163

您可以首先尝试分离输入的各个部分

```
...
var input=$(this).val();
var month=input.substr(0,2)-1;
var day=input.substr(3,2);
var year=parseInt("20"+ input.substr(6,2)); 
```

然后启动一个新的 Date 对象：

```
var date= new Date(year,month,day); 
```

或将其写回现场，就像您所做的那样：

```
$(this).val((date.getMonth()+1)+'/'+date.getDate()+'/'+date.getFullYear()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:35:49.120

在四处询问后，我最终使用了[Moment.js](http://www.momentjs.com)。我尝试[了 date.js](http://www.datejs.com)，但因为我部分使用了 unix 时间戳，所以 moment 似乎可以更好地处理这些（IMO）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-07T13:41:55.040

const [日、月、年] = values.date.split('/');

# c# - 如何在 Tridion 2011 中获取组件 UnPublish 事件的 (un-) PublicationTarget？

> ID：14630616
> 
> 赞同：7
> 
> 时间：2013-01-31T16:33:15.760
> 
> 标签：c#, tridion, tridion-2011

我正在使用 Tridion 2011 的事件系统在取消发布组件时执行一些额外的操作。我正在使用[此处](http://yatb.mitza.net/2012/04/how-to-publish-stuff-programmatically.html)找到的代码发布相关组件。

我正在注册我的事件处理程序，如下所示：

```
EventSystem.Subscribe<Component, UnPublishEventArgs>(
    RemoveAndRepublish, EventPhases.Initiated); 
```

...我的处理程序方法如下：

```
public void RemoveAndRepublish(Component cmp, UnPublishEventArgs args, 
                               EventPhases phase)
{
    // ... code to locate related component, and perform required actions...

    var instruction = new PublishInstruction(cmp.Session)
    {
        DeployAt = DateTime.Now,
        RenderInstruction = new RenderInstruction(cmp.Session)
        {
            RenderMode = RenderMode.Publish
        },
        ResolveInstruction = new ResolveInstruction(cmp.Session)
        {
            IncludeComponentLinks = true
        },
        RollbackOnFailure = true,
        StartAt = DateTime.MinValue
    };

    var target = args.Targets.FirstOrDefault();

    PublishEngine.Publish(new[] {related}, instruction, new[] {target});
} 
```

我的问题是该`UnPublishEventArgs.Targets`属性是一个`IList<PublishingTarget>`，在运行时结果是一个`List<TargetType>`，我需要一个`PublicationTarget`对象才能调用`PublishEngine.Publish(...)`。

我的问题是：有没有办法从 UnPublish 事件中获取当前的（未）PublicationTarget？

任何人都可以提供任何帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T16:39:48.413

您需要自己从*TargetType(s)*中找出*PublicationTarget(* s) 。根据项目的*TargetType*和*Publication*，您将需要遍历*PublicationTargets*以查看它们是否允许您的*Publication*发布给它们。这将（最终）为您提供*PublicationTargets*列表。不幸的是，这是相当多的工作:(

 ***说了这么多，你真的需要*PublicationTarget*吗？如果您需要从相同的发布/目标组合重新发布或取消发布项目，您应该能够将相同的*TargetType*数组解析为`PublishEngine.Publish(...)`方法。

当我搜索文档时，我在 PublishEngine() 上看到以下覆盖：

```
PublishEngine.Publish Method (IEnumerable<(Of <(<'IdentifiableObject>)>)>, PublishInstruction, IEnumerable<(Of <(<'TargetType>)>)>, PublishPriority)

public static ICollection<PublishTransaction> Publish(
    IEnumerable<IdentifiableObject> items,
    PublishInstruction publishInstruction,
    IEnumerable<TargetType> targetTypes,
    PublishPriority priority
) 
```***

# magento - 辅助 magento 商店页面上的零星重定向

> ID：14630617
> 
> 赞同：0
> 
> 时间：2013-01-31T16:33:18.340
> 
> 标签：magento, redirect, magento-1.7

最近将我的 Magento 1.7 商店转移到了新主机，并开始遇到令人沮丧的问题。

我们的商店位于登录 shell 后面 - 您可以在[http://www.seacadetshipsstore.com](http://www.seacadetshipsstore.com)看到它。基本交换将您带到根存储 (/magento/)，而 gearlocker 登录将您带到安全的子存储 (/magento/gearlocker/)。

问题是，自从转移到新主机后，/magento/gearlocker/ 偶尔会重定向到 /magento/。我每 10 次只能复制 1 次，但客户不断抱怨他们因此无法访问安全商店。

我还注意到，如果我关闭安全性并让客户端直接导航到 /magento/gearlocker/，它似乎可以解决大多数问题 - 他们在登录后不再获得重定向。只有少数人仍然有错误，他们都是各种浏览器上的PC用户。

我已经为堆栈设置了一个演示登录：
[https](https://www.seacadetshipsstore.com/login.php)
://www.seacadetshipsstore.com/login.php U：stack_login
P：谢谢

我怀疑这是基本 url 或基本链接 url 的问题，否则错误会更加一致。我已经阅读了 magento 的官方教程，并确保二级商店设置正确（请记住，它在旧主机上运行良好）。我也知道这与登录 shell 无关——它所做的只是验证用户的登录并重定向到 /magento/gearlocker/。

任何人都可以重现此错误吗？谁能告诉我发生了什么，或者我该如何解决？提前致谢！

# macos - 如何在 QTKit 中自动配对相机和麦克风

> ID：14630621
> 
> 赞同：0
> 
> 时间：2013-01-31T16:33:30.003
> 
> 标签：macos, video, qtkit

我正在使用 QTKit 编写视频捕获应用程序。它被设置为用户必须从使用 [QTCaptureDevice inputDevicesWithMediaType: QTMediaTypeVideo] 获得的列表中选择一个网络摄像头。我希望用户能够选择一个摄像头，并自动选择相应的麦克风，但我没有看到在 QTKit 中实现这一点的方法。

我的应用程序需要在 OSX 10.6 到 10.8 上运行，所以我不能使用 10.7 中的 AVFoundation。此时不推荐使用 QuickTime。

所以问题是：在 Mac OS 10.6 到 10.8 上，如何自动将网络摄像头与其嵌入式麦克风匹配。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-13T15:51:34.093

记录在案的方法可以在[QTCaptureDevice Class Reference](https://developer.apple.com/library/mac/documentation/QuickTime/Reference/QTCaptureDevice_Class/Reference/Reference.html)中找到，使用方法 attributeForKey 和 QTCaptureDeviceLinkeDevicesAttribute 键，可以这样调用。

```
QTCaptureDevice* device = [QTCaptureDevice deviceWithUniqueID:deviceUniqueID];
QTCaptureDevice* sibling = Nil;
NSArray* linkedDevices = [device attributeForKey: QTCaptureDeviceLinkeDevicesAttribute
NSUInteger linkedCount = [linkedDevices count];

for (NSUInteger i = 0; i < linkedCount; i++)
{
    sibling = [linkedDevicesobjectAtIndex: i];
    .
    .
    .
} 
```

但是，我还没有看到这项工作，返回的数组始终为 Nil。此外，[此 Apple 邮件列表存档](http://lists.apple.com/archives/quicktime-api/2011/Mar/msg00120.html)表明它可能仅适用于 Apple iSight 设备 :(。

最后，可以在此处找到其他示例：[Apple QTRecorder Sample](https://developer.apple.com/library/mac/samplecode/QTRecorder/Listings/QTRDocument_m.html)

# android - Android UDP套接字无法发送数据

> ID：14630624
> 
> 赞同：2
> 
> 时间：2013-01-31T16:33:47.250
> 
> 标签：android, sockets, udp

我是 Android 编程的新手，我想编写一段代码，只需在 127.0.0.1 上发送一个字符串，我就可以在 netcat 上观看它，但问题是当我在我的 android 项目上尝试它时没有任何反应，所以我尝试了一个普通的java项目，一切正常。所以经过大量研究后，我发现......什么都没有

我的安卓代码：

```
 import android.app.Activity;
   import android.os.Bundle;
   import android.view.Menu;
   import android.view.View;
   import android.view.View.OnClickListener;
   import android.widget.Button;

   import java.net.*;
   import java.io.*;

   public class MainActivity extends Activity {

public static final int MON_PORT = 5001;

    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button bouton2 = (Button)findViewById(R.id.envoi);
    bouton2.setOnClickListener(new OnClickListener(){

      public void onClick(View v){    
  try {

        int port=MON_PORT;
        InetAddress adresse = InetAddress.getByName("localhost");
        DatagramSocket socket;

        String leMessage = "test";
        int longueur = leMessage.length();
        byte[] message= new byte [longueur];
        message = leMessage.getBytes();

        socket = new DatagramSocket();                      
        DatagramPacket packet = new DatagramPacket(message,longueur,adresse,port);
        socket.send(packet);
        System.out.println("test d'execution");
        socket.close();

            } catch (UnknownHostException e)
                    {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                        catch (SocketException e)
                    {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    } catch (IOException e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }   

      }
  });   

 } 
```

我检查了我的 AndroidManifest.xml 和权限：

```
<uses-permission android:name="android.permission.INTERNET"> </uses-permission>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"> </uses-permission> 
```

不在应用程序标签之间

我使用基于 Android API 7 的 AVD，但我尝试过使用 API 16 的另一个 AVD，但结果相同，有人可以帮我找出问题所在吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T17:14:46.447

实际的问题是您的 PC 无法访问您发送的 UDP 数据包，因为该数据包是在设备“模拟器”通过[环回](http://en.wikipedia.org/wiki/Loopback)机制使用的不同 IP 地址上发送的。

事情就是这样。您可以放心地假设 Android 模拟器是一台通过 IP 网络远程连接到您的 PC 的远程机器，它有自己的 IP 地址并且可以与您的 PC 通信。您不能只使用环回 IP 通过 IP 与您的 PC 通信。请改用`10.0.2.2`本文档页面[Emulator](http://developer.android.com/tools/devices/emulator.html)中指定的方法。

使用该 IP，您将能够在 netcat 中看到数据包。

# extjs - 强制 Ext-Js 4 按钮失去焦点

> ID：14630626
> 
> 赞同：2
> 
> 时间：2013-01-31T16:33:53.917
> 
> 标签：extjs

使用 Ext-Js 4.1.0

我有一个非常简单的面板，只有一个按钮。该按钮有一个处理程序，它使用 Ext.Ajax.request 进行 REST 调用，这里是类似的代码：

```
...
handler: function(button) {
   button.disable();
   Ext.Ajax.request({
      url: '/path/to/rest',
      method: 'POST',
      success: function() {
         button.enable();
         alert('Success!');
      },
      failure: function() {
         button.enable();
         alert('Failed!');
      }
   });
} 
```

如您所见，我禁用按钮，然后在成功或失败后启用。问题是现在按钮有了焦点，因此有了焦点 CSS 类。

如何“取消聚焦”按钮，使其失去焦点 CSS 类并恢复到被选中之前的原始外观？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:10:07.107

我有[完全相同的问题](https://stackoverflow.com/a/10690431/1062992)。当按钮被禁用时，它会阻止`blur`事件触发。

我需要为我的事件禁用我的按钮（就像你一样），所以最简单的解决方案是`button.blur()`在我的处理程序链中的某处手动触发事件。

# php - PHP可以在刷新时保持窗口中的位置吗？如果没有，最好的方法？

> ID：14630630
> 
> 赞同：-5
> 
> 时间：2013-01-31T16:33:57.447
> 
> 标签：php, jquery, css, ajax

我有一个带有 CSS 样式的 div `overflow: scroll;`。这是一个长长的列表，向下滚动很远，但 div 的高度只有 300px。如果我向下滚动并单击一个项目，则内容会填充窗口的右侧（列表位于左侧）。但是，列表自然会顶到顶部来刷新（需要刷新才能从`MySQL`数据库中抓取内容）。

我知道，理想情况下，使用 JavaScript、jQuery 或 AJAX 的组合可能效果最好——但我只在小范围内使用 JS 和 jQuery，而根本没有 AJAX。我对PHP更熟悉。

**编辑：** 由于 PHP 不能做到这一点，什么是最好的实现方式以及如何实现？

**Edit2：** 这是我点击的链接：

```
<a href="items.php?id=<?php echo $cat_id; ?>&amp;item=<?php echo urlencode($row['item']); ?>"><?php echo $row['item']; ?></a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:47:00.390

刷新页面后，您是否尝试通过 ID 访问您的元素？

基本上在您的网址中添加“#elementClickedId”？

类似的东西： [http ://www.w3.org/TR/html4/struct/global.html#adef-id](http://www.w3.org/TR/html4/struct/global.html#adef-id)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:41:54.987

在您的 html 中：

```
<div class='item_in_list'><a href='javascript:item_click(<?php echo $id;?>)'>Item 1</a></div> 
```

然后是javascript：

```
function item_click(id)
{
$.ajax({
 type:'get',
 data:{item_id:id},
 url:'yourphppage.php',
 dataType:'html',
 success:function(response){
  $('#page_body').html(response);
  return false;
 }
});
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T16:52:39.063

尝试玩这个（假设 jQuery 已加载）：

```
<script>

$( '.list a' ).click( function( e ) {

    e.preventDefault();

    alert( 'Loading...' );

    $( '#resultboxontheright' ).load( 'foo.php?id=' + $( this ).attr( 'data-foo' ), function() {

        alert( 'Done!' );

    } );

} );

</script>

<ul class="list">
    <li><a href="foo.php?id=bar" data-foo="bar">Foobar</a></li>
    <li><a href="foo.php?id=foo" data-foo="foo">Foofoo</a></li>
</ul>

<div id="resultboxontheright"></div> 
```

和 foo.php：

```
<?php

echo '<h4>' . $_GET['id'] . '</h4>'; 
```

# solr - 使用布尔运算符进行 Solr 通配符搜索

> ID：14630631
> 
> 赞同：0
> 
> 时间：2013-01-31T16:33:59.653
> 
> 标签：solr

我正在尝试使用布尔运算符运行一些通配符搜索。当我运行以下查询时，我得到了适当的结果：-

```
q=field1:*val1 val2* AND field2:val3 
```

上面显示了在 field1 中以任意组合出现 val1 和 val2 且 field2 包含值 val3 的所有记录。

但是，如果我运行以下查询：-

```
q=field1:*val1 val2* AND field2:val3 AND -field3:(*val1 val2* *:*) 
```

field1 搜索开始表现异常。**据我了解 debugQuery 结果，上述查询首先搜索那些在 field1 中出现 val1 或 val2（或两者**）的记录，通过 field2 过滤它，然后过滤那些 field3 不包含val1 和val2。因此，此查询可以显示字段 1 中存在 val2（而不是 val1）的那些记录。

我也在 field1 中尝试了邻近搜索。没有效果。但后来，我读到邻近搜索不适用于通配符。

上面的字段定义为：-

```
<field name="field1" type="text_general" indexed="true" stored="false" multiValued="true" />
<field name="field2" type="text_general" indexed="true" stored="false" />

<fieldType name="text_general" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true" />
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true" />
        <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
      <analyzer type="select">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true" />
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>

    </fieldType> 
```

field3 是一个字符串，它没有任何问题。是否可以修改上述查询，以便对 field1 的搜索仅导致 val1 和 val2 都存在的那些记录（任何组合都可以接受）？

更新：当我执行以下操作时它起作用了：-

```
q=field1:*val1 AND field1:val2* AND field2:val3 AND -field3:(*val1 val2* *:*) 
```

但是，有没有办法在不将我的短语分成单个单词的情况下完成相同的操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:09:15.090

你说：

```
field1:*val1 val2* 
```

搜索任何内容都是 val1 和 val2 都发生。除非您自己实现了这种语法，否则我在 Lucene 或 Solr 中都找不到这种语法的任何文档。它应该搜索：

```
field1:*val1 OR defaultfield:val2* 
```

如果您想在 field1 中搜索两者的存在（不确定您打算为通配符完成什么，但暂时将它们留在原处）：

```
field1:(+*val1 +val2*) 
```

此外，`-field3:(*val1 val2* *:*)`这意味着您将省略所有包含`*val1`,`val2*`或`*:*`, 并且最后我读为任何包含冒号的结果，我不确定它是否能正常工作。

```
field1:(*val1 AND val2*) AND field2:val3 AND -field3:(*val1 val2* *:*) 
```

或者（因为我必须提供我喜欢的查询语法作为替代，至少）：

```
+field1:(+*val1 +val2*) +field2:val3 -field3:(*val1 val2* *:*) 
```

# java - Groovy/Grails Tool Suite（基于 Eclipse 的 IDE）存在很大的死锁问题

> ID：14630642
> 
> 赞同：3
> 
> 时间：2013-01-31T16:34:46.720
> 
> 标签：java, eclipse, spring, grails, sts-springsourcetoolsuite

我正在使用 GGTS 在 Grails 中创建一些项目，但是这个 IDE 非常慢。

我的 IDE 中有两个项目（有时两个项目都在运行），在进行小的更改后，GGTS 开始构建工作区，这需要很多时间，有时它永远不会结束，只是崩溃，有时它会造成如此严重的死锁，我必须重新启动计算机。

我的环境：win 7 64 位，Intel i5-2500 3,30GHz，8GB RAM，GGTS v. 3.1.0，java 1.6.0_30，grails 2.2.0。

我读过有可能做这样的事情：窗口->首选项->常规->工作区->链接资源-禁用链接资源，但我不确定我是否可以这样做，因为Grails项目已连接有了这个地方，我相信：C:\Users\username.grails\2.2.0\projects

我能做些什么？解决这个问题的唯一方法是购买 IntelliJ 还是使用一些文本编辑器和控制台？如何修复这个有缺陷的 Eclipse？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-02T07:13:16.173

转到项目->取消选中“自动构建”选项。这是默认选中的。因此，当您对代码进行任何更改时，它每次都会自动尝试构建。取消选中此选项将为您节省大量时间，因为您可以随时运行它（它仅在您运行代码时构建。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:42:05.863

我使用 emacs 进行 Grails 开发，但我肯定会推荐 IntelliJ，除非您可以在没有代码帮助的情况下工作。

从我所看到的带有插件的 Eclipse 来看，STS 或 GGTS 在使用 Grails 时非常容易出错：

*   工作区损坏
*   动态方法的完成度差
*   有时您无法保存文件
*   等等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-10T19:16:05.500

把这个： -vm C:\devsw\java\jdk7_67\jre\bin\server\jvm.dll 在我的 GGTS.ini 中（并重新启动 GGTS）已经停止了蓝色圆圈的旋转。

# database - 哪个数据库最适合处理图形和树状结构数据？

> ID：14630646
> 
> 赞同：2
> 
> 时间：2013-01-31T16:35:03.767
> 
> 标签：database, graph, tree, hierarchy, dapper

我计划与 Dapper.NET 合作建立一个家庭网站。

结构中会出现很多类似树的数据。哪个数据库提供了处理循环/非循环树关系的最佳查询？

我想知道分层查询的易用性和性能比较。IE。如 SQL Server 中的 CTE、Oracle 中的 Connect By/Start with 等。

dapper 是否是此类树状结构数据的 Micro ORM 的最佳选择？

在为此选择正确的数据库和正确的 Micro ORM 时，我需要意见。

对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T09:56:18.697

我的问题仍然存在：**您期望有多少数据？**

但除此之外，它不仅仅是您为数据选择的数据库类型，它也是表结构。层次树可以根据您的需要以各种不同的方式存储。

## 表结构

特定结构在遍历读取时可能非常快，但在插入/更新（即[嵌套集](http://en.wikipedia.org/wiki/Nested_set_model)）时很慢，其他结构（邻接列表）则相反。对于 99:1 的读：写比率（当今绝大多数应用程序的读取远多于写入），我可能会选择具有左、右、深度和父级的修改后的嵌套集结构。这为您提供了阅读场景的最佳可能性。

## 数据库类型

除非您的目标是大量数据，否则我建议您使用您最了解的任何 SQL 数据库（MSSQL、MySQL、Oracle）。但是，如果您的数据库将包含大量的层次结构节点，那么使用[专门的面向图形的数据库](http://en.wikipedia.org/wiki/Graph_database)可能是一个更好的选择。

## 8000 万个节点

如果您选择修改后的嵌套集解决方案（也使用负值，因此插入/更新一半的更新次数），您将拥有具有`left`. `right`，`ID`以及`ParentID`会产生大约 1.2 GB 表的列。但这是您使用至少两年后的最高估计。

## 我的建议

**快点和轻点**- 如果事实证明根本不需要它，请不要通过使用最好的数据库来存储您的层次结构来过度设计。因此，我建议您最初使用关系数据库，这样您就可以快速进入市场，即使解决方案在数百万条记录后开始挣扎。但是在你的数据库开始挣扎之前（我们在这里谈论几年）你会得到两件事：

1.  您将首先看到您的产品是否会起飞（已经有许多家谱服务），因此您不会投资学习新技术；因为您将使用经过验证和支持的技术，因此您可以快速进入市场
2.  如果您的产品确实成功（我真的希望它成功），它仍然会给您足够的时间来学习不同的存储解决方案并实施它；使用适当的代码层，以后在需要时切换存储应该不难

# xml - XSLT 如何使用逗号分隔的字符串查找值？

> ID：14630653
> 
> 赞同：1
> 
> 时间：2013-01-31T16:35:21.050
> 
> 标签：xml, string, xslt, lookup, comma

我想出了如何进行字符串查找以及如何分别解析逗号分隔的字符串。但是我想知道是否有一种有效的方法可以同时满足这两个要求。这是我的源 XML：

```
<?xml version="1.0" ?>
     <MATRIX>
     <DATA_RECORD>
      <COMPONENT1>1, 2</COMPONENT1> 
      <COMPONENT2>6, 7, 8, 9</COMPONENT2>  
     </DATA_RECORD>
    </MATRIX> 
```

我希望通过解析逗号分隔的字符串并使用每个令牌进行查找来生成以下 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
     <MATRIX>
     <DATA_RECORD>
      <COMPONENT1>A, B</COMPONENT1> 
      <COMPONENT2>F, G, H, I</COMPONENT2>  
     </DATA_RECORD>
    </MATRIX> 
```

这是我的查找 XML（COMPONENT_LOOKUPLIST.xml）：

```
<?xml version="1.0" ?>
    <MAIN>
      <DATA_RECORD>
        <COMPONENT_ID>1</COMPONENT_ID>
        <COMPONENT_NAME>A</COMPONENT_NAME>    
      </DATA_RECORD>
      <DATA_RECORD>
        <COMPONENT_ID>2</COMPONENT_ID>
        <COMPONENT_NAME>B</COMPONENT_NAME>    
      </DATA_RECORD>
        <DATA_RECORD>
        <COMPONENT_ID>3</COMPONENT_ID>
        <COMPONENT_NAME>C</COMPONENT_NAME>    
      </DATA_RECORD>
      <DATA_RECORD>
        <COMPONENT_ID>4</COMPONENT_ID>
        <COMPONENT_NAME>D</COMPONENT_NAME>    
      </DATA_RECORD>
        <DATA_RECORD>
        <COMPONENT_ID>5</COMPONENT_ID>
        <COMPONENT_NAME>E</COMPONENT_NAME>    
      </DATA_RECORD>
      <DATA_RECORD>
        <COMPONENT_ID>6</COMPONENT_ID>
        <COMPONENT_NAME>F</COMPONENT_NAME>    
      </DATA_RECORD>
        <DATA_RECORD>
        <COMPONENT_ID>7</COMPONENT_ID>
        <COMPONENT_NAME>G</COMPONENT_NAME>    
      </DATA_RECORD>
      <DATA_RECORD>
        <COMPONENT_ID>8</COMPONENT_ID>
        <COMPONENT_NAME>H</COMPONENT_NAME>    
      </DATA_RECORD>
      <DATA_RECORD>
        <COMPONENT_ID>9</COMPONENT_ID>
        <COMPONENT_NAME>I</COMPONENT_NAME>    
      </DATA_RECORD>
    </MAIN> 
```

我是 XSLT 的初学者。一些 XSLT 专家可以分享一些想法或提供示例代码吗？我从 Jeni 的网站获得了令牌代码：

```
 <xsl:template name="tokenize">
          <xsl:param name="string" />
          <xsl:param name="delimiter" select="','" />
          <xsl:choose>
            <xsl:when test="$delimiter and contains($string, $delimiter)">
              <token>
                <xsl:value-of select="substring-before($string, $delimiter)" />
              </token>

              <xsl:call-template name="tokenize">
                <xsl:with-param name="string" 
                                select="substring-after($string, $delimiter)" />
                <xsl:with-param name="delimiter" select="$delimiter" />
              </xsl:call-template>
            </xsl:when>

            <xsl:otherwise>
              <token><xsl:value-of select="$string" /></token>

            </xsl:otherwise>
          </xsl:choose>
        </xsl:template>

    <xsl:call-template name="tokenize">    
            <xsl:with-param name="string" select="/MATRIX/DATA_RECORD/COMPONENT1"></xsl:with-param>
          </xsl:call-template>

            <xsl:call-template name="tokenize">    
            <xsl:with-param name="string" select="/MATRIX/DATA_RECORD/COMPONENT2"></xsl:with-param>
          </xsl:call-template> 
```

并写了一个查找：

```
<xsl:variable name="lookup" select="document('COMPONENT_LOOKUPLIST.xml')/MAIN/DATA_RECORD"/>
                <xsl:for-each select="//DATA_RECORD">

 <token>
  <xsl:for-each select="*">      
   <xsl:value-of select="$lookup[COMPONENT_ID = current()]/COMPONENT_NAME"/>        
          </xsl:for-each>   
          </token>
        </xsl:for-each> 
```

但是将这两者结合在一起似乎具有挑战性。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:21:30.977

If you are stuck with XSLT1.0, one solution could be to amend the **tokenize** template to do the look-up, rather than spitting up **token** elements (If you kept with the **token** elements, you would have to do a two-pass transform to transform these back to strings based on your look-up).

So, instead of doing this in the **tokenize** template

```
<token>
   <xsl:value-of select="substring-before($string, $delimiter)" />
</token> 
```

Do, this instead

```
<xsl:value-of select="$lookup[COMPONENT_ID=normalize-space(substring-before($string, $delimiter))]/COMPONENT_NAME"/>
 <xsl:value-of select="$delimiter"/> 
```

Here is the full XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output omit-xml-declaration="yes" method="html"/>

   <xsl:variable name="lookup" select="document('C:\COMPONENT_LOOKUPLIST.xml')/MAIN/DATA_RECORD"/>

   <xsl:template match="DATA_RECORD/*">
      <xsl:copy>
         <xsl:call-template name="tokenize">
            <xsl:with-param name="string" select="."/>
         </xsl:call-template>
      </xsl:copy>
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>

   <xsl:template name="tokenize">
      <xsl:param name="string"/>
      <xsl:param name="delimiter" select="','"/>
      <xsl:choose>
         <xsl:when test="$delimiter and contains($string, $delimiter)">
            <xsl:value-of select="$lookup[COMPONENT_ID=normalize-space(substring-before($string, $delimiter))]/COMPONENT_NAME"/>
            <xsl:value-of select="$delimiter"/>
            <xsl:call-template name="tokenize">
               <xsl:with-param name="string" select="substring-after($string, $delimiter)"/>
               <xsl:with-param name="delimiter" select="$delimiter"/>
            </xsl:call-template>
         </xsl:when>
         <xsl:otherwise>
            <xsl:value-of select="$lookup[COMPONENT_ID=normalize-space($string)]/COMPONENT_NAME"/>
         </xsl:otherwise>
      </xsl:choose>
   </xsl:template>
</xsl:stylesheet> 
```

When applied to your XML, the following is output

```
<MATRIX>
   <DATA_RECORD>
      <COMPONENT1>A,B</COMPONENT1>
      <COMPONENT2>F,G,H,I</COMPONENT2>
   </DATA_RECORD>
</MATRIX> 
```

Note, this does remove the spaces too, but hopefully that isn't an issue...

EDIT: If you do want to keep the spaces, you do something like this:

```
<xsl:variable name="current" select="substring-before($string, $delimiter)" />
<xsl:value-of select="substring-before($current, normalize-space($current))" /> 
<xsl:value-of select="$lookup[COMPONENT_ID=normalize-space($)]/COMPONENT_NAME"/>
<xsl:value-of select="substring-after($current, normalize-space($current))" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T17:11:22.307

您是否考虑过使用像 Saxon 9 或 AltovaXML 或 XmlPrime 这样的 XSLT 2.0 处理器？在这种情况下，您可以轻松地执行例如

```
<xsl:key name="by-id" match="DATA_RECORD" use="COMPONENT_ID"/>

<xsl:param name="lk-doc-url" select="'COMPONENT_LOOKUPLIST.xml'"/>
<xsl:variable name="lk-doc" select="document($lk-doc-url)"/>

<xsl:template match="*[starts-with(local-name(), 'COMPONENT')]">
  <xsl:copy>
    <xsl:value-of select="for $id in tokenize(., ', ') return key('by-id', $id, $lk-doc)/COMPONENT_NAME"
       separator=", "/>
  </xsl:copy>
</xsl:template> 
```

[编辑] 这是一个完整且经过测试的示例：

```
<xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="2.0">

<xsl:key name="by-id" match="DATA_RECORD" use="COMPONENT_ID"/>

<xsl:param name="lk-doc-url" select="'test2013013103.xml'"/>
<xsl:variable name="lk-doc" select="document($lk-doc-url)"/>

<xsl:template match="@* | node()">
  <xsl:copy>
    <xsl:apply-templates select="@* , node()"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="*[starts-with(local-name(), 'COMPONENT')]">
  <xsl:copy>
    <xsl:value-of select="for $id in tokenize(., ', ') return key('by-id', $id, $lk-doc)/COMPONENT_NAME"
       separator=", "/>
  </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

当我将 Saxon 9.4 应用于输入时

```
<?xml version="1.0" ?>
     <MATRIX>
     <DATA_RECORD>
      <COMPONENT1>1, 2</COMPONENT1> 
      <COMPONENT2>6, 7, 8, 9</COMPONENT2>  
     </DATA_RECORD>
    </MATRIX> 
```

查找文件`test2013013103.xml`是

```
<?xml version="1.0" ?>
    <MAIN>
      <DATA_RECORD>
        <COMPONENT_ID>1</COMPONENT_ID>
        <COMPONENT_NAME>A</COMPONENT_NAME>    
      </DATA_RECORD>
      <DATA_RECORD>
        <COMPONENT_ID>2</COMPONENT_ID>
        <COMPONENT_NAME>B</COMPONENT_NAME>    
      </DATA_RECORD>
        <DATA_RECORD>
        <COMPONENT_ID>3</COMPONENT_ID>
        <COMPONENT_NAME>C</COMPONENT_NAME>    
      </DATA_RECORD>
      <DATA_RECORD>
        <COMPONENT_ID>4</COMPONENT_ID>
        <COMPONENT_NAME>D</COMPONENT_NAME>    
      </DATA_RECORD>
        <DATA_RECORD>
        <COMPONENT_ID>5</COMPONENT_ID>
        <COMPONENT_NAME>E</COMPONENT_NAME>    
      </DATA_RECORD>
      <DATA_RECORD>
        <COMPONENT_ID>6</COMPONENT_ID>
        <COMPONENT_NAME>F</COMPONENT_NAME>    
      </DATA_RECORD>
        <DATA_RECORD>
        <COMPONENT_ID>7</COMPONENT_ID>
        <COMPONENT_NAME>G</COMPONENT_NAME>    
      </DATA_RECORD>
      <DATA_RECORD>
        <COMPONENT_ID>8</COMPONENT_ID>
        <COMPONENT_NAME>H</COMPONENT_NAME>    
      </DATA_RECORD>
      <DATA_RECORD>
        <COMPONENT_ID>9</COMPONENT_ID>
        <COMPONENT_NAME>I</COMPONENT_NAME>    
      </DATA_RECORD>
    </MAIN> 
```

输出是

```
<?xml version="1.0" encoding="UTF-8"?><MATRIX>
     <DATA_RECORD>
      <COMPONENT1>A, B</COMPONENT1>
      <COMPONENT2>F, G, H, I</COMPONENT2>
     </DATA_RECORD>
    </MATRIX> 
```

所以我的建议有效，我不确定你没有得到任何内容的情况有什么不同。

# c# - WPF Custom Control Error

> ID：14630660
> 
> 赞同：1
> 
> 时间：2013-01-31T16:35:33.627
> 
> 标签：c#, .net, wpf, xaml

I have some problems with a WPF custom control, I'm trying to make it work but just don't get it:

Here is my problem, I'm creating a simple custom control that's almost the same to a TextBox. This control has a dependency property named "Texto", and the binding between the XAML and back-code of the custom control works fine, here is the code:

```
<UserControl x:Class="WpfCustomControlLibrary1.UserControl1"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="47" d:DesignWidth="147">
<Grid Height="43" Width="142">
    <TextBox Height="23" HorizontalAlignment="Left" Margin="12,8,0,0" Name="textBox1" VerticalAlignment="Top" Width="120" Text="{Binding Texto}"/>        
</Grid> 
```

And the dependency property code:

```
public static readonly DependencyProperty TextoProperty = DependencyProperty.Register("Texto", typeof(string), typeof(UserControl1));

    public string Texto
    {
        get
        {
            return (string)GetValue(TextoProperty);
        }

        set
        {
            SetValue(TextoProperty, value);
        }
    } 
```

Ok, now the problem: When I use this control in other windows I try to bind the "Texto" property to a viewmodel (as simple as everything else) but the property on the view model just dont change:

The ViewModel code:

```
 public class ViewModelTest
{
    public string SomeText { get; set; }
} 
```

And the code of the applicatoin Window:

```
public ViewModelTest test;

    public Window1()
    {
        InitializeComponent();
    }        

    private void button1_Click_1(object sender, RoutedEventArgs e)
    {
        MessageBox.Show(test.SomeText);
        MessageBox.Show(uc.Texto);
    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        test = new ViewModelTest();
        this.DataContext = test;
    } 
```

And the binding with the property of the view model:

```
<my:UserControl1 HorizontalAlignment="Left" Margin="27,12,0,0" Name="uc" VerticalAlignment="Top" Texto="{Binding Path=SomeText,Mode=TwoWay}"/> 
```

Just for make it clearer, if I write "Hello" in the custom control and then I push the "button1", the first message shows nothing and the second message shows "Hello".

As you can see I'm fairly new into this, so I hope some of you can help me. Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:47:48.493

Your binding `Texto="{Binding SomeText}"` works fine, the problem is the rebinding from your user control to the inner textbox. Remember binding will ALWAYS, if not modified, refere to the `DataContext`. But your DataContext doesn't contain the property Texto. Your control has that, To refere to that you need something called `TemplateBinding`, but this only works when you are in a ControlTemplate. Which you aren't so what is the solution? You can use a special form of binding, by changing the source from the DataContext to a control with a given name: First give your UserControl a name

```
<UserControl x:Class="WpfCustomControlLibrary1.UserControl1"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         x:Name="mainControl"
         d:DesignHeight="47" d:DesignWidth="147"> 
```

and now change the binding to refere to the control, not the DataContext of the control anymore.

```
 <TextBox Text="{Binding ElementName=mainControl, Path=Texto}"/> 
```

Now your ViewModel binds to your user control and the content of the user control binds to the user controls Texto property.

Also one minor thing, what you called custom control, is in fact a user control, custom controls are something else.

# mysql - 迄今为止在 mysql 上的新纪元

> ID：14630661
> 
> 赞同：9
> 
> 时间：2013-01-31T16:35:41.710
> 
> 标签：mysql, sql, date, datetime, datetime-format

我试过使用

```
FROM_UNIXTIME(`date`) 
```

并得到了 yyyy/mm/dd 小时

我怎样才能扭转它，那就是把它作为

hh:mm:secs mm/dd/yyyy

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-31T16:37:36.870

添加说明符[`FROM_UNIXTIME`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_from-unixtime)或使用[`DATE_FORMAT`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)：

**说明符**

```
%T 时间，24 小时制 (hh:mm:ss)
%m 月份，数字 (00..12)
%d 日期，数字 (00..31)
%Y 年份，数字，四位数
```

```
SELECT DATE_FORMAT(FROM_UNIXTIME(`date`), '%T %m/%d/%Y) 
```

或者

```
SELECT FROM_UNIXTIME(`date`, '%T %m/%d/%Y') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T16:37:40.407

利用[`DATE_FORMAT`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)

```
DATE_FORMAT(FROM_UNIXTIME(`date`), "%T %m/%d/%Y") 
```

这将从存储在数据库中的 unix 时间返回 hh:mm:ss dd/mm/YYYY。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T16:40:06.003

您必须定义您的自定义日期/时间格式。请看一下：

[http://dev.mysql.com/doc/refman/4.1/en/date-and-time-functions.html#function_from-unixtime](http://dev.mysql.com/doc/refman/4.1/en/date-and-time-functions.html#function_from-unixtime)

SELECT FROM_UNIXTIME(UNIX_TIMESTAMP(), '%h:%i:%s %M/%D/%Y');

# android - Android 旋转位图。setDuration 不会改变速度

> ID：14630664
> 
> 赞同：1
> 
> 时间：2013-01-31T16:35:52.103
> 
> 标签：android, animation, rotation

我有一个使用以下代码旋转的位图。问题是设置rotate.setDuration。我尝试将值更改为 900000，但是当我 ACTION_UP 位图始终以相同的速度旋转到起始位置时。

```
 switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN: {
            mCircle.clearAnimation();
            angleDegree = Math.toDegrees(Math.atan2(x - xc, yc - y));
            if (angleDegree>0){angleDegree=angleDegree-360;}
            angleDifference =angleDegree;      
            mCurrAngle =angleDegree-angleDifference;
            mPrevAngle = mCurrAngle;
            break;
        }
        case MotionEvent.ACTION_MOVE: {
            angleDegree = Math.toDegrees(Math.atan2(x - xc, yc - y));
            if (angleDegree>0){angleDegree=angleDegree-360;}
            mCurrAngle =angleDegree-angleDifference;
            mPrevAngle = mCurrAngle;
            animate(mPrevAngle, mCurrAngle, 0);
            break;
        }
        case MotionEvent.ACTION_UP : {
            timeback = 9000000;
            mPrevAngle = mCurrAngle = 0;
            animate(mPrevAngle, mCurrAngle, timeback);
            break;
        }
        }

    private void animate(double fromDegrees, double toDegrees, long setDuration) {
        final RotateAnimation rotate = new RotateAnimation((float) fromDegrees, (float) toDegrees,
                RotateAnimation.RELATIVE_TO_SELF, 0.5f,
                RotateAnimation.RELATIVE_TO_SELF, 0.5f);
        rotate.setDuration(setDuration);
        rotate.setFillEnabled(true);
        rotate.setFillAfter(true);
        mCircle.startAnimation(rotate);
} 
```

# c++ - 由于 std::pair 导致的 GCC (MoSync) 中的 C++ 构建错误

> ID：14630665
> 
> 赞同：0
> 
> 时间：2013-01-31T16:35:53.407
> 
> 标签：c++, gcc, compilation, g++, mosync

我正在使用 MoSync IDE 为移动平台构建我的 C++ 代码。最初，C++ 代码是由 Visual Studio 2010 单独构建的，没有任何问题。但是当我使用 MoSync IDE 重建 C++ 代码时，它会产生一些错误消息。我的 C++ 代码使用 STL 库，例如 std::pair 和 std::vector 类。下面是在 MoSync IDE 中编译为错误的代码。MoSync 使用 GCC 3.4.6。所以我认为这是由 GCC 编译器引起的。

```
template<typename T>
vector< pair<T, int> > histogram(const vector<T>& x, int numBins)
{
    T maxVal, minVal, range, delta, leftEdge, rightEdge;
    int i, dummyIdx;
    vector<T>::iterator pt;
    vector< pair<T, int> > counts(numBins, make_pair(T(), 0));
    vector<T> y(x);

//other code ...

} 
```

错误信息是：

**错误：预期 `;' 在“pt”之前（第 6 行）**

该模板函数在给定输入向量 x 和 numBins 的情况下计算直方图，并将“counts”作为 (bins, counts) 对返回。最初我在 Visual Studio 2010 中编译了这个 C++ 代码，没有任何错误。但是 MoSync IDE 中的 GCC 给了我这个错误信息。所以这让我很困惑，为什么它不能在 GCC 中构建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:39:33.617

`vector<T>::iterator`是依赖类型，所以你需要使用`typename`：

```
typename vector<T>::iterator pt; 
```

请参阅[我必须在何处以及为什么必须放置“模板”和“类型名称”关键字？](https://stackoverflow.com/questions/610245/where-and-why-do-i-have-to-put-the-template-and-typename-keywords)

# c++ - 从 shared_pointers 的映射中填充向量

> ID：14630667
> 
> 赞同：4
> 
> 时间：2013-01-31T16:35:55.917
> 
> 标签：c++, boost, stl

我一直在尝试从地图中填充矢量。我知道如何以更传统的方式做到这一点，但我试图用 STL 算法（单线）作为某种训练来实现它:)。

原点地图类型是：

```
std::map< std::string, boost::shared_ptr< Element > > 
```

目标向量是：

```
std::vector< Element > theVector; 
```

我到目前为止是这样的：

```
std::transform( theMap.begin(), theMap.end(),
        std::back_inserter( theVector ),
        boost::bind( &map_type::value_type::second_type::get, _1 )
        ); 
```

但这是试图在向量中插入一个不起作用的指针。我也试过这个：

```
using namespace boost::lambda;
using boost::lambda::_1;

std::transform( theMap.begin(), theMap.end(),
        std::back_inserter( theVector ),
        boost::bind( &map_type::value_type::second_type::get, *_1 )
        ); 
```

但它也不起作用。

编辑：

我有这个可行的解决方案，但我觉得它不那么令人印象深刻:)

```
std::for_each( theMap.begin(), theMap.end(), 
        [&](map_type::value_type& pair)
        {
            theVector.push_back( *pair.second );
        } ); 
```

Edit2：我在这里不太舒服的是 bind()，所以欢迎使用 bind() 解决方案！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:58:25.030

怎么样：

```
// Using std::shared_ptr and lambdas as the solution
// you posted used C++11 lambdas.
//
std::map<std::string, std::shared_ptr<Element>> m
    {
        { "hello", std::make_shared<Element>() },
        { "world", std::make_shared<Element>() }
    };
std::vector<Element> v;

std::transform(m.begin(),
               m.end(),
               std::back_inserter(v),
               [](decltype(*m.begin())& p) { return *p.second; }); 
```

[请参阅http://ideone.com/ao1C50](http://ideone.com/ao1C50)上的在线演示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T17:15:08.940

另一种选择可能是新`for`语法：

```
for(auto &cur_pair: the_map) { theVector.push_back(*(cur_pair.second)); } 
```

它至少是单线（有点），虽然它只是另一种方式，`std::for_each`但更紧凑。

# c# - c#异步服务器/客户端。套接字（在客户端）“随机”断开连接

> ID：14630668
> 
> 赞同：1
> 
> 时间：2013-01-31T16:35:59.660
> 
> 标签：c#, sockets, asynchronous

这是我在这里的第一篇文章，所以请温柔=）

我正在为我的办公室编写一个用于管理数据库的异步服务器/客户端应用程序，我在我的计算机上本地对其进行了测试，它运行良好。当我在另一台机器上上传服务器工具时，我发现了一些让我发疯的东西：服务器/客户端只处理第一个查询，当我发送另一个查询时，服务器和客户端都崩溃了。

在调试模式下通过行后，我发现了问题：在 beginconnect() 之后（在第二次查询期间），套接字已连接，但当调试器到达 beginend() 行时，套接字断开（这只发生在客户端，服务器端的套接字似乎已连接）。

我不知道它是怎么发生的，每次发送新查询时都会重新实例化套接字，当然在查询过程（发送/接收）完成后会关闭和处理。我的想法是套接字的处理不会立即发生，而是在一段时间后发生（但为什么总是在新的 beginconnect() 和 beginend() 之间？）。你对此有任何线索吗？或者我应该在精神病院预订一个房间？

***新部分（编辑）***

好吧..又来了！这次客户端的套接字在整个会话中保持打开状态（套接字关闭仅在客户端工具关闭时发生）但我收到另一种错误：“System.Net.Sockets.SocketException（0x80004005）：现有连接被强行关闭System.Net.Sockets.Socket.EndReceive(IAsyncResult asyncResult) 的远程主机”经过一番谷歌搜索后，我发现这种错误通常是由连接另一端的服务器触发的，所以我尝试“挖掘”服务器代码行来确定此连接关闭命令的位置。我发现问题可能出在以下代码中：

```
 private static void SendCallback(IAsyncResult ar)
    {
        Console.WriteLine("send callback");
        try
        {
            // Retrieve the socket from the state object.
            Socket handler = (Socket)ar.AsyncState;

            // Complete sending the data to the remote device.
            int bytesSent = handler.EndSend(ar);
            Console.WriteLine("\nQuery answer sent to client");

            handler.Shutdown(SocketShutdown.Both);
            //handler.Disconnect(true);
            //handler.Dispose();
            state.content = new List<byte[]>();
        }
        catch (Exception e)
        {
            Console.WriteLine(e.ToString());
            Console.ReadKey();
        }
    } 
```

删除 handler.shutdown 行，客户端不再能够检测到传输结束（不是真正的问题，是发送数据包的最后一部分，因此可以将其用作触发器......至少我认为）。有什么建议吗？我读了一些关于keepalive的东西，但我不明白如何设置它，以及在这种情况下是否真的有必要。提前感谢您的所有努力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:39:19.610

我建议不要像你一样打开和关闭套接字。
如果可能，请保持套接字打开，因为它需要由您的程序和操作系统释放。

# javascript - Express.JS + Node-Mysql 和每个 http 请求 1 个连接

> ID：14630669
> 
> 赞同：3
> 
> 时间：2013-01-31T16:36:00.740
> 
> 标签：javascript, node.js, express, node-mysql

我是 Express 的新手，我正试图围绕 Express + Node-Mysql。

我想为每个 http 请求使用一个新的 mysql 连接。

这是我的 app.js 文件：

```
var express = require( "express" ),
    mysql = require( "mysql" ),
    routes = require( "./routes" );

var app = module.exports = express(),
    db = mysql.createConnection( require( "./config/db" ) );

app.configure(function(){
    app.set( "views", __dirname + "/views" );
    app.set( "view engine", "jade" );
    app.set( "db", db );
    app.use( express.logger( "dev" ));
    app.use( express.bodyParser() );
    app.use( app.router );
    app.use( express.static( "front" ));
});

app.configure( "development", function(){
    app.use( express.errorHandler() );
});

routes( app );

app.listen(80); 
```

然后，在我的路由文件中，我执行以下操作：

```
module.exports = function( app ){

    var db = app.get( "db" );

    app.get( "/stuff", function( req, res ){

        db.connect( function(err){

            var sql = "SELECT * FROM stuff";

            db.query( sql, function( err, result ){

                res.send( result );
                db.end(function( err ){ });

            });

        });

    });

}; 
```

这有效，但我不确定它是否“正确”。有没有更清洁的方法来完成我所追求的？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:14:55.653

如果您想为每个请求做一个 db 连接，请输入以下行：

```
db = mysql.createConnection(require( "./config/db" )); 
```

在您的请求处理程序中（例如在 routes.js 中），就在您执行操作之前`db.connect()`。`db.end()`一旦您从查询中获得所有结果，请致电。

由于连接到数据库是一项相对昂贵的操作，您可能需要考虑使用连接池。保持几个连接打开并在需要时从池中拉出一个空闲连接将比为每个请求打开和关闭一个新连接更有效。[generic-pool](https://github.com/coopernurse/node-pool) [npm 模块](http://npm.im/generic-pool)是一个很好的模块。

# javascript - 显示禁用的选项元素 - html 下拉表单

> ID：14630672
> 
> 赞同：4
> 
> 时间：2013-01-31T16:36:09.613
> 
> 标签：javascript, jquery, html, css

我有一个下拉 html 表单并想显示`disabled=disabled`元素（查看下面的编辑）
乍一看，表单会跳过`disabled`元素并显示“选项 1”。

```
<select>
    <option disabled='disabled'>Title</option>
    <option>Option 1</option>
    <option>Option 2</option>
    <option>Option 3</option>
</select> 
```

这可能只用`html`or`css`吗？
如果不是，那么`jQuery`or`javascript`呢？

**编辑**
希望表单看起来像这样
![在此处输入图像描述](../Images/a23016454d57e8a4aeb6b403a11a8f43.png)

目前看起来像
![在此处输入图像描述](../Images/7151e9f18ae1f3dfa39eb8ae717a1e4e.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T16:49:45.173

添加`selected="selected"`到您的第一个选项。

```
<select>
    <option selected="selected" disabled='disabled'>Visible Title</option>
    <option>Option 1</option>
    <option>Option 2</option>
    <option>Option 3</option>
</select> 
```

**[jsFiddle 示例](http://jsfiddle.net/7sEyV/)**

# php - 获取模拟 Doctrine\ORM\QueryBuilder

> ID：14630674
> 
> 赞同：3
> 
> 时间：2013-01-31T16:36:20.360
> 
> 标签：php, symfony, doctrine-orm, mocking, phpunit

我整天都在尝试为解析自定义 DSL 并创建 DQL 查询的类编写一些测试。

我的班级要求我传入 a`queryBuilder`然后它用于构建查询并返回它。

我的问题是

*   得到一个`queryBuilder`我需要一个`entityManager`
*   得到一个`entityManager`我需要一个连接
*   要获得连接，我需要一个数据库

我宁愿我的单元测试不依赖于数据库，所以我一直在尝试使用创建模拟`queryBuilder`，`PHPUnit`但`queryBuilder`似乎依赖于`entityManager`后者又依赖于连接。

所以 2 个问题：
有没有更好的方法在 Doctrine 2 中动态构造查询？
有没有办法在`queryBuilder`没有`entityManager`（或至少没有真正的数据库）的情况下工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T15:11:05.997

我不确定如何使用 PHPUnit，但我建议您查看[Mockery](https://github.com/padraic/mockery)以满足您的 PHP 模拟需求。它是一个非常强大的库，它允许您非常轻松地模拟 EntityManager，因此它会返回任何东西。

对于您的用例，您可以轻松地创建一个模拟实体管理器，而不是返回一个模拟查询构建器：

```
$mockEm = \Mockery::mock('\Doctrine\ORM\EntityManager');
$mockQb = \Mockery::mock('\Doctrine\ORM\QueryBuilder');
$mockEm->shouldReceive('createQueryBuilder')->andReturn($mockQb); 
```

然后，您可以使用 Mockery 的核心功能来设置单元测试所需的期望。

顺便说一句，您还可以选择使用“被动”EntityManager 模拟，以防您想对包含一些数据库逻辑的函数进行单元测试，但您实际上并不想在单元测试中进入数据库.

```
public function getPassiveEntityManagerMock() {
    return \Mockery::mock('\Doctrine\ORM\EntityManager',
                          array('getRepository' => new FakeRepository(),
                                'getClassMetadata' => (object)array('name' => 'aClass'),
                                'persist' => null,
                                'flush' => null));
} 
```

[这是](https://gist.github.com/wowo/1331789)使用 PHPUnit 的建议方法，但我自己还没有尝试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T14:40:05.617

我最终创建了自己的模拟查询构建器；使用 PHPUnits 模拟框架可能获得相同的功能，但这就是我最终得到的结果：

```
<?php
namespace MyNameSpace\Tests\Mocks;
use Doctrine\ORM\QueryBuilder;
use Doctrine\Common\Collections\ArrayCollection;

class MockQueryBuilder extends QueryBuilder {

    protected $expr;
    protected $paramReflect;

    public function __construct($expr) {
        $this->expr = $expr;
        $this->paramReflect = new \ReflectionProperty('Doctrine\ORM\QueryBuilder', 'parameters'); 
        $this->paramReflect->setAccessible(true);
        $this->paramReflect->setValue($this, new ArrayCollection());
    }

    /*
     * @return Query\Expr
     */
    public function expr() {
        return $this->expr;
    }

    public function getEntityManager() {
        return null;
    }

    public function getQuery() {
        return array(
            'parameters' => clone $this->paramReflect->getValue($this),
            'dql' => $this->getDQL(),

        );
    }

} 
```

# javascript - 尝试在单击事件中创建单击事件但未获得所需结果

> ID：14630678
> 
> 赞同：0
> 
> 时间：2013-01-31T16:36:27.210
> 
> 标签：javascript, jquery

我对 jquery 还比较陌生，所以我会尽力解释。

我正在根据一个名为 Cardfight 的流行纸牌游戏创建代码！先锋。我的目标是最终创建一种方法来构建和保存可以编辑的一副牌。

到目前为止，在我的代码中，我在文本框中获取用户的输入，单击按钮时将其存储到数组中，然后使用 jquery 将元素附加到 div。

当点击附加到 div 的元素时（即这将是用户在文本框中输入的卡片名称），将调用搜索函数并返回有关该卡片的所有信息和统计信息。我在下面包含了我的代码和注释，以明确它的每个部分的作用。

我当前的问题是.... 每当用户单击带有 ID 输出的 div 上的 ANYWHERE 时...搜索功能被一遍又一遍地调用。

预期功能：

- 用户输入卡名 - 用户点击“搜索” - 卡名显示在带有 ID 输出的 div 中 - 用户点击显示的卡名 - 卡信息显示在其下方。例如：等级、力量、盾牌等 - 用户输入另一个卡名，并重复上述步骤

目前发生了什么： -用户可以在带有ID输出的div上单击ANYWHERE，卡片信息将不断显示，就像搜索功能不断被调用一样。我希望在用户单击卡名时只调用一次卡信息。

理想情况下，我还想这样做，如果用户第二次点击卡片名称，它将从列表中消失，但我想我可以解决这个问题。

我想知道的另一件事......这是一个相当开放的问题......将所有用户的输入保存到数组中是个好主意吗？从长远来看，我希望能够创建一种类似于清单的清单，一旦显示卡的正确信息...如果用户选择...他们可以单击它并将其保存到单独的列表中他们可以继续编辑他们的牌组。

这是我的代码：

HTML：

```
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <script type = "text/javascript" src='script.js'>
    </script>
    <title></title>
</head>
<body>
 <form name="searchForm">
     <input type="text" id="search" placeholder="Enter Card Name" name="searchItem"/>
 </form>
 <div id="button">Search!</div>
<br/>
<div id="output"></div>
<div id="save"></div>

</body>
</html> 
```

Javascript/Jquery：

```
// Vanguard object to obtain statistics of each card.
function Vanguard(name,grade,skill,power,shield,critical, type, nation, clan, race){
    this.name = name;
    this.grade = grade;
    this.skill = skill;
    this.power = power;
    this.shield = shield;
    this.critical = critical;
    this.type = type;
    this.nation = nation;
    this.clan = clan;
    this.race = race;
};

// This is where I can create and store new Vanguard objects easily
// I've only included 5 here for testing but there are hundreds 
// that I will include once I get the code working.
var database = {};
database['Asura Kaiser'] = new Vanguard("Asura Kaiser", 3, "Twin Drive!!", 11000, 0, 1, "Normal Unit", "Star Gate", "Nova Grappler", "Battleroid");
database['King of Knights, Alfred'] = new Vanguard("King of Knights, Alfred", 3, "Twin Drive!!", 10000, 0, 1, "Normal Unit", "United Sanctuary", "Royal Paladin", "Human");
database['Dragonic Overlord'] = new Vanguard("Dragonic Overlord", 3, "Twin Drive!!", 11000, 0, 1, "Normal Unit", "Dragon Sanctuary", "Kagerou", "Dragon");
database['CEO Amaterasu'] = new Vanguard("CEO Amaterasu", 3, "Twin Drive", 10000, 0, 1, "Normal Unit", "United Sanctuary", "Oracle Think Tank", "Human");
database['Alfred - Early'] = new Vanguard("Alfred - Early", 3, "Twin Drive!!", 10000, 0, 1, "Normal Unit", "United Sanctuary", "Royal Paladin", "Human");

// This is code to display all the card information to the user
// I am not sure why I need two parameters but 
// I couldn't get the code to work any other way.
function printVanguard(p, name){
    document.getElementById('output').innerHTML +=("<hr />");
    for (var p in database[name]){
       document.getElementById('output').innerHTML +=(p +': ' + database[name][p] + '<br />');
       }
       document.getElementById('output').innerHTML +=("<br />");
};

// This calls the printVanguard function for a specific card
var search = function(p, name){
    printVanguard(p, name);
};

// Jquery which is supposed to get the name of the card from the user.
// When the user clicks a button, it will store the name in an array.
// Then after it will append the input to a div for the user to see.
// If the user clicks on the input appended to the div,
// it will display all the statistics about that card.
$(document).ready(function() {
 var userInput = [];
 $('#button').click(function(){
  userInput.push($('input[name=searchItem]').val());
    for (i = 0; i < userInput.length; i++){
        if (i === userInput.length - 1){
            $('#output').append("<br />"  + userInput[i]); 
        }
    }
 $('#output, userInput').unbind("click").click(function(){
 for (i = 0; i < userInput.length; i++){
        if (i === userInput.length - 1){
            $('#save').append(search(userInput[i], userInput[i]));
        }
    }
 }); 
 });
}); 
```

如果你需要的话，还有 CSS ......（不是很漂亮，但不是我现在的首要任务）

```
form {
    display: inline-block;
}

#button{
    display: inline-block;
    height: 20px;
    width: 70px;
    background-color:#FF8C00;
    font-family:cursive, arial;
    font-weight:bold;
    color: #8B0000;
    border-radius:5px;
    text-align:center;
    margin-top:2px;
}

.list {
    font-family:garamond;
    color:#006400;
}

#output {
    font-family:garamond;
    color:#006400;
} 
```

感谢您的帮助...我尽力使代码尽可能简洁。如果您认为我可以改进它，请告诉我！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:40:01.047

在`div`元素中，创建`span`包含卡片名称的元素。将`onclick`处理程序附加到所有`span`元素而不是`div`元素。

**编辑**

对于您在 中的每个卡片名称`div`，您应该有一个单独的`span`元素，其中包含该特定卡片的名称和 onclick 函数。假设您的所有`span`元素也有一个名为`cardName`. 所以你的代码应该是这样的......

```
$('span.cardName').on('click', function(e) {
    var cardName = e.currentTarget.innerHTML; // Assuming you have nothing else within the span besides the card name

    // Insert whatever code here
} 
```

# html - 叠加蒙版偏离中心

> ID：14630682
> 
> 赞同：0
> 
> 时间：2013-01-31T16:36:41.673
> 
> 标签：html, css, overlay, positioning, mask

我正在尝试创建一个覆盖框并希望整个背景都被遮盖。

但是，掩码仅覆盖页面主体。我希望遮罩延伸到页面的边缘和顶部。

有没有办法手动定位蒙版以覆盖整个页面？

谢谢你。

CSS：

```
body
{
    background-color: #C75656;
    text-align:center;
    font-size:16px;
    font-variant:small-caps;
    font-family:Lucida,Helvetica,sans-serif;
    font-weight:500;
    text-decoration: none;
    position: absolute;
    left: 50%;
    width: 780px;
    margin-left: -390px;
}
#middleContainer {
    width:780px;
    margin: 5px  auto;
    padding: 10px 0;
}
.box {
    background:white;
    border-style:solid;
    border-width:1.5px;
    border-color:#071419;
    border-radius: 12px;
    -moz-border-radius: 12px;
}
.modal {
    background-color:#fff;
    display:none;
    width:700px;
    padding:15px;
    text-align:left;
    border:2px solid #333;

    opacity:0.8;
    -moz-border-radius:6px;
    -webkit-border-radius:6px;
    -moz-box-shadow: 0 0 50px #ccc;
    -webkit-box-shadow: 0 0 50px #ccc;
  }

.modal h2 {
    margin:0px;
    padding:10px 0 10px 45px;
    border-bottom:1px solid #333;
    font-size:20px;
  } 
```

HTML：

```
<!DOCTYPE html>
<html lang='en'>
<head>
<title>mySITE</title>
<!-- Meta tags go here -->
<!-- Links to Icon, favicon, css, jquery, ajax, etc. -->
<link rel='stylesheet' type='text/css' href='default.css' /> 
<script src="http://cdn.jquerytools.org/1.2.7/full/jquery.tools.min.js"></script>
<script>
$(document).ready(function() {
    var triggers = $(".modalInput").overlay({
      mask: {
        color: '#ebecff',
        loadSpeed: 200,
        opacity: 0.5,
      },
    });

    $("#login form").submit(function(e) {
      triggers.eq(1).overlay().close();
      var input = $("input", this).val();
      triggers.eq(1).html(input);
      return e.preventDefault();
    });
  });
</script>
</head>

<body>
<span><h1>my<font color="red">SITE</font></h1></span>
<a class="modalInput" rel="#login">Login</a>

<div id="middleContainer" class="box">
<div id="title">Content</div>
</div>

<div class="modal" id="login">
  <h2>Login or Regester.</h2>
  <form>
    <input />
    <button type="submit"> OK </button>
    <button type="button" class="close"> Cancel </button>
  </form>
  <br />
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T17:18:59.627

这就是我用于所有项目的东西

```
<style>
    .mask {
        position:fixed;
        top:0px;
        bottom:0px;
        left:0px;
        right:0px;
        z-index:1000;
        opacity: 0.5;
    }
    .overlay {
        position: absolute;
        width: 300px;
        height: 200px;
        top: 100px;
        left: -50%;
        margin-left: -150px;
        background: white;
        z-index: 1001
    }
</style>

<div class="mask"></div>
<div class="overlay"></div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T17:03:35.080

把它放在文件的开头

```
 <style type="text/css" media="all">
    .mask {    
        position: absolute; 
        top: 0; left: 0; 
        width: 100%; 
        height: 2000px;
        background: black;
        opacity: 0.5;
    }
    </style> 
```

然后放

```
<div class="mask"></div> 
```

在您的 html 中的任何位置，但我会将其放在顶部或底部。因为是绝对定位，所以真的无所谓。

# eclipse - Eclipse Juno for C/C++ 为选项卡插入空间不起作用

> ID：14630684
> 
> 赞同：0
> 
> 时间：2013-01-31T16:36:46.823
> 
> 标签：eclipse, perl, eclipse-cdt

我刚刚发现用于 C/C++ 的**Eclipse Juno “****为选项卡插入空间**”不起作用。Juno for Java 可以工作。有人有同样的问题吗？在我签入更改之前，有没有办法运行**脚本**将所有**.cpp**和**.h文件中的****制表符**更改为**4 个空格？**有人可以帮忙写剧本吗？谢谢，

 ******编辑：**

我在 Linux 中。

**编辑2**

[这](http://adrienbailly.wordpress.com/2010/04/17/replace-tabs-by-spaces-in-files/)也有效：

查找 ./ -name '*.cpp' -exec sed -i 's/\t/ /g' {} \;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:45:58.973

该脚本是您终端的单行代码：

```
$ perl -pi.bak -e 's{\t}{    }g' *.cpp *.h 
```

'.bak' 参数将创建文件的备份（例如 test.cpp --> test.cpp.bak）

对于 Windows，使用双引号而不是单引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-21T06:20:29.060

试试这个让它工作（而不是使用脚本）：

*   转到“窗口”->“首选项”
*   在树中选择：C/C++ -> 代码样式 -> 格式化程序
*   点击“编辑”按钮
*   选项卡“标识”：将“选项卡策略”设置为“仅限空格”（如果与我正在修复的设置不同的编辑器，请四处寻找）
*   单击“应用”/“确定”

高温高压****

# c# - 反序列化期间线程被中止错误（但没有中止）

> ID：14630687
> 
> 赞同：1
> 
> 时间：2013-01-31T16:36:52.367
> 
> 标签：c#, multithreading, xmlserializer, threadabortexception

非常奇怪的错误，基本上，一旦用户登录我的应用程序，我就会启动一个线程，该应用程序使用以下代码片段从 xml 文件加载数据：

```
 public static T Deserialize<T>(String Path)
    {
        T Result = Activator.CreateInstance<T>();

        try
        {
            if (File.Exists(Path))
            {
                using (FileStream fs = new FileStream(Path, FileMode.Open))
                {
                    if (fs.Length > 0)
                    {
                        System.Xml.Serialization.XmlSerializer s = new System.Xml.Serialization.XmlSerializer(typeof(T));
                        Result = (T)s.Deserialize(fs);
                    }
                    fs.Close();
                }

                // force clean up!
                GC.Collect();
            }

            return Result;
        }
        catch (Exception ex)
        {
            Console.WriteLine("Deserialize '{0}' : {1}", Path, ex.ToString());
            return Result;
        }
    } 
```

它正在加载的 XML 文件大约 3MB，如果这很重要的话。每次它在一个特定文件上失败，但有以下例外：

> 反序列化'C:\bin\Debug\Settings\Objects.xml'：System.Threading.ThreadAbortException：线程被中止。
> 
> 在 System.RuntimeMethodHandle.InvokeMethod（对象目标，对象 [] 参数，签名 sig，布尔构造函数）
> 
> 在 System.Reflection.RuntimeMethodInfo.UnsafeInvokeInternal（对象 obj，对象 [] 参数，对象 [] 参数）
> 
> 在 System.Reflection.RuntimeMethodInfo.Invoke（对象 obj，BindingFlags invokeAttr，Binder binder，Object[] 参数，CultureInfo 文化）在 System.Xml.Serialization.TempAssembly.InvokeReader（XmlMapping 映射，XmlReader xmlReader，XmlDeserializationEvents 事件，字符串 encodingStyle） System.Xml.Serialization.XmlSerializer.Deserialize（XmlReader xmlReader，字符串 encodingStyle，XmlDeserializationEvents 事件）在 System.Xml.Serialization.XmlSerializer.Deserialize（流流）
> 
> 在 c:\Classes\XmlSerializer.cs:line 82 中的 Classes.XmlSerializer.Deserialize[T](String Path) 无法加载以前的数据！System.Threading.ThreadAbortException：线程被中止。
> 
> 在 Classes.XmlSerializer.Deserialize[T](String Path) in c:\Classes\XmlSerializer.cs:line 96 at Controllers.ObjectDataCollection.ObjectThread.LoadData() in c:\Controllers\ObjectDataCollection.cs:line 74

对于如何进一步调试，我完全不知所措。我知道线程没有被中止，因为尝试反序列化后的下一行是一个扫描事物的循环，它运行得非常好（线程没有重新启动，它只是在一个地方启动）。

有人对我如何进一步调试有任何想法吗？我在这里完全不知所措。这是所有代码： http: [//pastebin.com/F30vD9KL](http://pastebin.com/F30vD9KL)

# python - 如何在 Flask 中使用 APSW

> ID：14630689
> 
> 赞同：2
> 
> 时间：2013-01-31T16:36:56.823
> 
> 标签：python, python-2.7, flask, flask-sqlalchemy, flask-extensions

我有一个 sqlite3 数据库，但数据库只有在我重新启动 Flask 服务器时才会更新。

我认为这是因为我没有告诉 Flask 它是一个数据库。所以我开始使用 SQLAlchemy 并设置

```
 db = SQLAlchemy(app) 
```

但是 SQLAlchemy 使用 pysqlite2 并且 pysqlite2 在我的计算机上不起作用。

有没有办法将 APSW（另一个 python sqlite3 包装器）与 SQLALchemy 一起使用？

或者有没有办法告诉烧瓶在没有 SQLAlchemy 的情况下使用我的数据库？

还是我的数据库没有更新的问题以另一种方式解决？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-31T17:08:15.273

只需使用这个烧瓶教程。它使用 sqlite，没有使用 sqlalchemy。

[http://flask.pocoo.org/docs/tutorial/](http://flask.pocoo.org/docs/tutorial/)

# c++ - 允许冲突的极快哈希函数

> ID：14630691
> 
> 赞同：-1
> 
> 时间：2013-01-31T16:37:04.060
> 
> 标签：c++, c, linux, hash, x86-64

我的密钥是 64 位地址，输出是 1 字节数 (0-255)。允许碰撞，但发生碰撞的概率应该很低。此外，假设要插入的元素数量很少，可以说不超过 255，以尽量减少鸽子洞效应。

地址是程序中函数的地址。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:38:58.190

```
uint64_t addr = ...
uint8_t hash = addr & 0xFF; 
```

我认为这可以满足您的所有要求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T16:42:17.853

我会将 2 个 LSB（最低有效字节）异或在一起，如果分布不好，则添加第三个，依此类推

这背后的基本原理如下：函数地址分布不均匀。问题通常在于较低 (lsb) 位。函数通常需要从可被 4/8/16 整除的地址开始，因此 2-4 lsb 可能毫无意义。通过与下一个字节进行异或运算，您应该可以摆脱大多数这些问题，而且速度仍然非常快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T16:47:48.103

Function addresses are, I think, quite likely to be aligned (see [this question, for instance](https://stackoverflow.com/questions/4909563/why-should-code-be-aligned-to-even-address-boundaries-on-x86)). That seems to indicate that you want to skip least significant bits, depending on the alignment.

So, perhaps take the 8 bits starting from bit 3, i.e. skipping the least significant 3 bits (bits 0 through 2):

```
const uint8_t hash = (address >> 3); 
```

This should be obvious from inspection of your set of addresses. In hex, watch the rightmost digit.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T16:48:24.117

How about:

```
uint64_t data = 0x12131212121211B12;

uint32_t d1 = (data >> 32) ^ (uint32_t)(data);
uint16_t d2 = (d1 >> 16) ^ (uint16_t)(d1);
uint8_t  d3 = (d2 >> 8) ^ (uint8_t)(d2);

return d3; 
```

It combined all bits of your 8 bytes with 3 shifts and three xor instructions.

# ant - 如何用ant脚本替换所有匹配项

> ID：14630692
> 
> 赞同：0
> 
> 时间：2013-01-31T16:37:09.707
> 
> 标签：ant

如何替换所有匹配的行？我想替换 *xml 文件中的所有匹配行。下面的脚本片段仅替换一行提前谢谢。brgds

```
<?xml version="1.0" encoding="windows-1252" ?>
<project default="init" basedir=".">
  <property file="build.properties"/>
  <target name="init">
    <tstamp/>
    <loadfile property="jndiurl"
              srcfile="${src.model}/META-INF/persistence.xml">
      <filterchain>
        <linecontains>
          <contains value="hibernate.jndi.url"></contains>
        </linecontains>
      </filterchain>
    </loadfile>
    <replace file="${src.model}/META-INF/persistence.xml" token="${jndiurl}"
             value="${hibernate.jndi.url.live}${line.separator}"/>
    <echo>${hibernate.jndi.url.live}</echo>
    <loadfile property="providerurl"
              srcfile="${src.structure}/com/arsivist/structure/connection.properties">
      <filterchain>
        <linecontains>
          <contains value="providerurl"></contains>
        </linecontains>
      </filterchain>
    </loadfile>
    <replace file="${src.structure}/com/arsivist/structure/connection.properties"
             token="${providerurl}"
             value="${providerurl.live}${line.separator}"/>
    <echo>${providerurl.live}</echo>
    <loadfile property="ucmusername"
              srcfile="${src.roketsanutil}/com/arsivist/util/ucmConnection.properties">
      <filterchain>
        <linecontains>
          <contains value="username"></contains>
        </linecontains>
      </filterchain>
  </target>
</project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:08:33.980

与其尝试就地编辑文件，不如将复制任务用作模板系统更简单，它支持可用于替换生产值的[过滤器集。](http://ant.apache.org/manual/Types/filterset.html)

# 例子

```
.
├── build.xml
└── src
    └── resources
        └── persistence.xml 
```

## 构建.xml

```
<project name="demo" default="template">

    <target name="template">
        <copy todir="build/META-INF">
            <fileset dir="src/resources" includes="*.xml"/>
            <filterset>
                <filter token="HIBERNATE.HBM2DDL.AUTO" value="create-drop"/>
            </filterset>
        </copy>
    </target>

    <target name="clean">
        <delete dir="build"/>
    </target>

</project> 
```

## 持久性.xml

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
             version="2.0">
   <persistence-unit name="sample">
      <jta-data-source>java:/DefaultDS</jta-data-source>
      <properties>
         <property name="hibernate.dialect" value="org.hibernate.dialect.HSQLDialect"/>
         <property name="hibernate.hbm2ddl.auto" value="@HIBERNATE.HBM2DDL.AUTO@"/>
      </properties>
   </persistence-unit>
</persistence> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T10:57:11.453

该片段对我有用：

```
<?xml version="1.0" encoding="windows-1252" ?>
<project default="init" basedir=".">
  <property file="build.properties"/>
  <target name="init">
    <tstamp/>
    <loadfile property="jndiurl"
              srcfile="${src.model}/META-INF/persistence.xml">
      <filterchain>
        <linecontains>
          <contains value="hibernate.jndi.url"></contains>
        </linecontains>
        <headfilter lines="1"/>
      </filterchain>
    </loadfile>
    <echo>${jndiurl}</echo>
    <replace file="${src.model}/META-INF/persistence.xml" token="${jndiurl}"
             value="${hibernate.jndi.url.live}${line.separator}"/>
    <echo>${hibernate.jndi.url.live}</echo>
</project> 
```

# django - 在 Django 中滥用自定义标签和过滤器是否有任何成本？

> ID：14630696
> 
> 赞同：1
> 
> 时间：2013-01-31T16:37:25.210
> 
> 标签：django

在 Django 中定义过多的自定义标签和过滤器是否有任何性能/架构成本（或收益）？我仍在努力思考这样一个事实，即几乎任何时候 Django 模板语言都不允许我做一些事情，我可以回过头来定义自己的解决方法。

我知道这是一个非常笼统的问题，但如果你能在过度依赖这些工具是好是坏时给我一些用例，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:19:01.400

这是有代价的，但除非你过度使用模板标签，否则你不应该关心。

顺便说一下，这就是为什么 Django 小部件的 html 模板是在 python 代码中而不是在模板中定义的。

请记住，无论您的模板有多复杂，最后，如果您使用某种缓存机制，模板只会偶尔生成一次。

我自己，我总是更喜欢模板标签和过滤器，即使是最小的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T17:41:55.773

有很多方法可以完成功能，而不是创建自定义标签。最好还是坚持原来的方式，因为不知道以后会不会有很多改进，其他功能就不能用了。

# c# - 检索基类列表时，NHibernate 加入子类会导致错误

> ID：14630697
> 
> 赞同：0
> 
> 时间：2013-01-31T16:37:35.713
> 
> 标签：c#, nhibernate, nhibernate-mapping

我有一个从我的数据库到我的 c# 代码的 Nhibernate 映射。我将列出结构的简单表示。

```
class ItemHolder
{
    public virtual ICollection<Item> ItemCollection {get;set;}
}

class Item
{
    public virtual int Id{get;set;}
    public virtual string SomeValue{get;set;}
} 
```

还有我的 NHibernate 映射

```
<class name="ItemHolder" table ="ItemHolders">
    ...
    <set name="ItemCollection" cascade="all-delete-orphan" inverse="true">
        <key column="ItemHolder"/>
        <one-to-many class="Item"/>
    </set>
</class>

<class name="Item" table="Items">
    <id name="ID" generator="native"/>
    ...
    <many-to-one name="ItemHolder" class="ItemHolder"/>
</class> 
```

所有这一切都很好，当我执行以下代码时，我会按预期检索所有内容。

```
bindingSource.DataSource = ISession.CreateQuery("select ih from ItemHolder as ih " +
            "left join fetch ih.ItemCollection")
            .SetResultTransformer(new DistinctRootEntityResultTransformer())
            .List<Item>(); 
```

就像我用 ItemHolders 填充绑定源一样，每个都有一个完全填充的 ItemCollection，里面装满了 Item。

然而

当我将加入的子类添加到 Item 以在我的程序中的其他地方使用时，如下所示：

```
class DerivedItem : Item
{
} 
```

添加到连接子类的 Item 映射。

```
<class name="Item" table="Items">
    <id name="ID" generator="native"/>
    ...
    <many-to-one name="ItemHolder" class="ItemHolder"/>
    <joined-subclass name="DerivedItem" table="DerivedItems" extends="Item">
        <key column="ID"/>
    </joined-subclass>
</class> 
```

现在事情变得有趣了。我可以毫无问题地从派生项目表中检索派生项目，但是当我尝试执行上述 c# 代码时出现错误。

如果我查看 ((ItemHolder)bindingSource.Current).ItemCollection ，那么集合中的第一个项目将映射到类类型 Item 但是列表中的第二个项目根本没有映射，从而导致错误。我可以在调试器中看到它的所有属性，但没有类型信息。

我已经隔离了错误，因此如果我从 Item 映射中删除加入的子类我没有问题，但是我希望拥有此功能。

我意识到这是非常具体的，并且我没有给出可能使事情难以理解的确切代码，但也许有人经历过类似的事情或者可以在我的映射中发现错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:31:03.323

我发现 DerivedItem 也在 Item 表中，因此 Item 被映射到派生项，导致添加到绑定源时出现问题，因为它们属于不同类型。

# c# - foreach 如何将对象转换为指定类型？

> ID：14630700
> 
> 赞同：4
> 
> 时间：2013-01-31T16:37:39.990
> 
> 标签：c#, foreach, ienumerable

我有一个关于`foreach`行为的问题`C#`。

我的自定义类实现了一个自定义`GetEnumerator`. 此方法返回另一个`object`可隐式转换为`string`.

但是，如果我这样做`foreach(string s in customClass)`，它会在运行时失败（“无法将 .. 类型的对象转换为字符串”）。

但是，如果我这样做`string x = new B()`，它就像一个魅力。

注意：这里没有什么特别需要实现的，我只是想了解发生了什么。我对这种*非*泛型行为特别感兴趣。

有任何想法吗？我缺少什么基础知识？

复制此代码的代码：

```
public class A : IEnumerable
{
    #region IEnumerable Members

    public IEnumerator GetEnumerator()
    {
        yield return new B();
    }

    #endregion
}

public class B
{
    public static implicit operator string( B b )
    {
        return "to-stringed implicit";
    }
}

// CODE:

A a = new A();

// Works.
B b = new B();
string xxx = b;

// Doesnt work.
foreach( string str in a )
{
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T16:56:46.923

仅当编译器认为可以在编译时使用隐式转换时才能使用它：

```
B b = new B();
string str = b; 
```

它不能在运行时使用：

```
B b = new B();
object obj = b;
string str = obj; // will fail at run-time 
```

*基本上，这是因为查看所有*`obj`可能的从到可能有效的转换的成本太高了`string`。（请参阅[此 Eric Lippert 博客文章](http://blogs.msdn.com/b/ericlippert/archive/2009/03/19/representation-and-identity.aspx)）。

* * *

您`IEnumerator`返回对象，因此调用`foreach (string str in a)`试图在运行时将 a 转换`object`为 a 。`B`

```
var e = a.GetEnumerator();
e.MoveNext();
object o = e.Current;
string str = o; // will fail at run-time 
```

如果您改为使用`foreach(B item in a) { string str = item; ... }`，则运行时转换是 from `object`to `B`（这有效，因为每个对象*都是*a `B`），并且 from `B`to的转换`str`可以由*编译器*进行。

```
var e = a.GetEnumerator();
e.MoveNext();
object o = e.Current;
B item = o;        // will work at run-time because o _is_ a B
string str = item; // conversion made by the compiler 
```

* * *

解决此问题的另一种方法是制作`A`implement`IEnumerable<B>`而不是`IEnumerable`. 然后，`foreach (string str in a)`更多地翻译为

```
var e = a.GetEnumerator();
e.MoveNext();
B b = e.Current; // not object!
string str = b;  // conversion made by the compiler 
```

因此编译器可以进行转换，而无需更改`foreach`循环。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-31T16:43:48.630

foreach 方法不需要您实现`IEnumerable`. 所需要的只是你的类有一个名为的方法`GetEnumerator`：

```
public class A
{
    public IEnumerator GetEnumerator()
    {
        yield return new B();
    }
} 
```

然后你可以在 a 中使用它`foreach`：

```
A a = new A();
foreach (B str in a)
{
    Console.WriteLine(str.GetType());
} 
```

但是 foreach 语句不会调用隐式运算符。您必须手动执行此操作：

```
foreach (B item in a)
{
    string str = item;
    // use the str variable here
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-31T17:15:04.023

基于 C# 规范中的“foreach 语句”部分（C# 5.0 规范的 8.8.4），我相信您的情况属于“枚举类型具有返回正确对象的 GetEnumerable”部分 - 没有隐式转换来确定元素的类型（如果类上没有唯一的 GetEnumerable，则有一些）

> 集合类型为 X，枚举类型为 E，元素类型为 Current 属性的类型。

在您的情况下，它`foreach`被翻译成以下代码（删除了 try/finally）：

```
// foreach( string str in items )
//    embedded-statement

IEnumerator enumerator = items.GetEnumerator();
while (enumerator.MoveNext()) 
  {
    string str = (string)(Object)enumerator.Current; // **
    embedded-statement
  }
} 
```

请注意，`**`要转换的对象的类型在线是`Object`（因为它由 non-generic 的情况下的结果确定`enumerator.Current`。`Object`如`IEnumerator`您所见，没有提及`B`允许您进行隐式转换的类型。

注意：规范可以在正常的 VS C# 安装中的以下位置找到：“Program Files (x86)\Microsoft Visual Studio XX.0\VC#\Specifications\YYYY”（XX 是 VS2010 的版本 10，VS2012 和 YYYY 的版本为 11是 EN-US 的语言环境 1033）。

# join - 创建 sql oracle 视图，使用连接，然后使用 orderby，然后使用 rownum <=1

> ID：14630702
> 
> 赞同：1
> 
> 时间：2013-01-31T16:37:44.613
> 
> 标签：join, view, sql-order-by, rownum

我要做的是创建一个连接 2 个表、人员和文档的视图。每个人会有很多文件，但我只想要那个人最近发布的文件。所以我想我加入了 2 个工作正常的表，然后我尝试从文档中订购发布日期以获得最新的，然后获得该行的顶部。对我来说这是有道理的，但我收到以下错误

```
 that the SQL code is not complete 
```

我的代码如下：

```
CREATE VIEW DisplayPersons
  AS
    SELECT 
      P.PERSON_ID AS "Person_ID",
      P.SURNAME AS "Surname",
      ...
      FROM PERSONS P
    LEFT JOIN
      DOCUMENTS D ON D.RECEIVED_BY = P.SURNAME||', '||P.INITIALS
      ORDER BY D.ISSUED_DATE DESC 
      WHERE ROWNUM <= 1; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:40:19.023

您的`WHERE`子句需要放在前面`ORDER BY`。

# php - Magento 手动将订单状态更改为“完成”

> ID：14630707
> 
> 赞同：5
> 
> 时间：2013-01-31T16:37:58.927
> 
> 标签：php, magento

我正在尝试手动更改订单状态以在我的代码中的某个点完成。这是我到目前为止所拥有的：

```
$order = Mage::getModel('sales/order')->load($_GET['orderid']);
$order->setState(Mage_Sales_Model_Order::STATE_COMPLETE, true, 'Pedido completado exitosamente.', true, false)->save(); 
```

当我这样做时，我得到了错误：

```
The Order state 'complete' must not be set manually. 
```

好的，所以我尝试了这个：

```
$order = Mage::getModel('sales/order')->load($_GET['orderid']);
$order->setStatus("complete");
$order->save(); 
```

当我这样做时，我得到了错误：

```
Call to a member function getMethodInstance() on a non-object 
```

那么如何手动设置订单状态完成。

我尝试使用第一个注释掉以下行`Sales/Order.php`：

```
if ($shouldProtectState) {
            if ($this->isStateProtected($state)) {
                Mage::throwException(
                    Mage::helper('sales')->__('The Order State "%s" must not be set manually.', $state)
                );
            }
        } 
```

但是不行，我仍然得到上面的未设置完成错误。

我正在使用 Magento 1.7.0.2。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T16:44:17.723

首先像你已经做的那样获取订单ID：

```
$order = Mage::getModel('sales/order')->load($_GET['orderid']); 
```

进而，

尝试

```
$order->addStatusToHistory(Mage_Sales_Model_Order::STATE_COMPLETE); 
```

或者

```
$order->setData('state', Mage_Sales_Model_Order::STATE_COMPLETE);
$order->save(); 
```

您不能使用`setState()`AFAIK 方法手动将订单状态设置为 COMPLETE 或 CLOSED。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-15T14:48:01.880

我用

```
$order->addStatusHistoryComment("My comment why the status was changed", 
Mage_Sales_Model_Order::STATE_COMPLETE); 
```

根据 Mage_Sales_Model_Order 代码，方法 addStatusToHistory 已被弃用。

# c - 为什么要在 main 中重新声明一个函数？

> ID：14630708
> 
> 赞同：8
> 
> 时间：2013-01-31T16:37:59.847
> 
> 标签：c

我遇到一个处理菜单的程序的一些例子..

正如我所理解的那样，他在 main 函数之前声明了所有函数，然后在 main 中也提到了一个 void 函数的函数：

```
char get_choice(void);
char get_first(void);
int get_int(void);
void count(void);
int main(void)
{
    int choice;
    void count(void);
    while ( (choice = get_choice()) != 'q')
    {
        switch (choice)
        {
            case 'a' : printf("Buy low, sell high.\n");
                break;
            case 'b' : putchar('\a'); /* ANSI */
                break;
            case 'c' : count();
                break;
            default : printf("Program error!\n");
                break;
        }
    }
    printf("Bye.\n"); 
```

...（功能实现）

你能告诉我这是为什么吗？tnx

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T16:42:26.153

完全没有理由，这只是原型的无意义重复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T16:47:35.520

These are just declaration of the functions not definitions.Not too sure why count function is declared twice though.The declaration is just saying to the compiler that there is something there with this name.Perhaps the programmer forgot to define the method?

A declaration provides basic attributes of a symbol: its type and its name. A definition provides all of the details of that symbol--if it's a function, what it does; if it's a class, what fields and methods it has; if it's a variable, where that variable is stored.

eg declaration looks like this:

```
void count(void); 
```

eg definition looks like this:

```
void count(void){

......

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-31T16:42:59.830

没关系 - 任何对您的程序有意义的地方。显然，如果它在 main 内部，那么在实际函数实现之前没有其他函数会“知道”函数原型是什么，这会产生影响。

我个人倾向于在调用该函数之前实现它，这样可以避免将原型放在哪里的问题[除非它放在头文件中，在这种情况下往往会解决问题]。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T21:48:47.733

> 你能告诉我这是为什么吗？tnx

除了这是一个简单的错误之外，没有其他*原因；*作者只是错过了多余的声明。只要两个声明相同，就不是问题（尽管它很难看，应该清理一下）。

FWIW，这就是为什么我总是在函数在同一个文件中使用之前*定义*它们。定义算作声明，所以只需要担心一个原型。

# .net - 将模板应用于相邻元素？

> ID：14630710
> 
> 赞同：0
> 
> 时间：2013-01-31T16:38:00.077
> 
> 标签：.net, xslt, xslt-1.0

给定如下输入：

```
<p>Some information about the proceeding source listing:</p>
<code language="CSharp"><![CDATA[ ... ]]></code>
<code language="AnotherLanguage"><![CDATA[ ... ]]></code>

<p>This is a different example which perhaps applies to just one language:</p>
<code language="CSharp"><![CDATA[ ... ]]></code>

<p>Another example:</p>
<code language="CSharp"><![CDATA[ ... ]]></code>
<code language="AnotherLanguage"><![CDATA[ ... ]]></code>
<code language="YetAnotherLanguage"><![CDATA[ ... ]]></code> 
```

使用 XSLT 1.0，我如何将相邻`<code>`元素分组如下：

```
<p>Some information about the proceeding source listing:</p>
<div class="source-selector">
    <ul class="tabs">
        <li class="tab" data-language="CSharp">CSharp</li>
        <li class="tab" data-language="AnotherLanguage">AnotherLanguage</li>
    </ul>
    <div data-language="CSharp">
        <pre>...</pre>
    </div>
    <div data-language="AnotherLanguage">
        <pre>...</pre>
    </div>
</div>

<p>This is a different example which perhaps applies to just one language:</p>
<div class="source-selector">
    <ul class="tabs">
        <li class="tab" data-language="CSharp">CSharp</li>
    </ul>
    <div data-language="CSharp">
        <pre>...</pre>
    </div>
</div>

<p>Another example:</p>
<div class="source-selector">
    <ul class="tabs">
        <li class="tab" data-language="CSharp">CSharp</li>
        <li class="tab" data-language="AnotherLanguage">AnotherLanguage</li>
        <li class="tab" data-language="YetAnotherLanguage">YetAnotherLanguage</li>
    </ul>
    <div data-language="CSharp">
        <pre>...</pre>
    </div>
    <div data-language="AnotherLanguage">
        <pre>...</pre>
    </div>
    <div data-language="YetAnotherLanguage">
        <pre>...</pre>
    </div>
</div> 
```

这就是我目前无法正常工作的内容，因为所有源代码都在所有其他内容之后被分组到一个选择器中（如本例中的段落）。

```
<!-- Display paragraphs first -->
<xsl:apply-templates select="*[not(name() = 'code')]"/>

<!-- Display consecutive source code within selector -->
<div class="source-selector">
    <ul class="tabs">
    <xsl:for-each select="code">
        <li class="tab" data-language="{@language}"><include item="{@language}Label"/></li>
    </xsl:for-each>
    </ul>
<xsl:for-each select="code">
    <div data-language="{@language}">
        <pre><xsl:copy-of select="node()"/></pre>
    </div>
</xsl:for-each>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:54:24.943

您可以在 XSLT 1.0 中通过让模板一次跳到元素的下一个邻居来完成此操作，如下所示：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="/*">
    <div>
      <xsl:apply-templates select="*[not(self::code)]" />
    </div>
  </xsl:template>

  <xsl:template match="/*/*[not(self::code)]">
    <xsl:copy-of select="."/>
    <!-- Select the next neighbor element, but only if it is a <code> -->
    <xsl:variable name="firstCode" select="following-sibling::*[1][self::code]" />
    <div class="source-selector">
      <!-- Skip the part with the <ul> if there are no <code> neighbors-->
      <xsl:if test="$firstCode">
        <ul>
          <xsl:apply-templates select="$firstCode" mode="list" />
        </ul>
        <xsl:apply-templates select="$firstCode" mode="samples" />
      </xsl:if>
    </div>
  </xsl:template>

  <xsl:template match="code" mode="list">
    <li class="tab" data-language="{@language}">
      <xsl:value-of select="@language"/>
    </li>
    <!-- Apply this template to the next neighbor, if it is a <code> -->
    <xsl:apply-templates select="following-sibling::*[1][self::code]" mode="list" />
  </xsl:template>

  <xsl:template match="code" mode="samples">
    <div data-language="{@language}">
      <pre>
        <xsl:value-of select="string(.)"/>
      </pre>
    </div>
    <!-- Apply this template to the next neighbor, if it is a <code> -->
    <xsl:apply-templates 
                       select="following-sibling::*[1][self::code]" mode="samples" />
  </xsl:template>

</xsl:stylesheet> 
```

在您的示例输入上运行时，这会产生：

```
<div>
  <p>Some information about the proceeding source listing:</p>
  <div class="source-selector">
    <ul>
      <li class="tab" data-language="CSharp">CSharp</li>
      <li class="tab" data-language="AnotherLanguage">AnotherLanguage</li>
    </ul>
    <div data-language="CSharp">
      <pre> ... </pre>
    </div>
    <div data-language="AnotherLanguage">
      <pre> ... </pre>
    </div>
  </div>
  <p>This is a different example which perhaps applies to just one language:</p>
  <div class="source-selector">
    <ul>
      <li class="tab" data-language="CSharp">CSharp</li>
    </ul>
    <div data-language="CSharp">
      <pre> ... </pre>
    </div>
  </div>
  <p>Another example:</p>
  <div class="source-selector">
    <ul>
      <li class="tab" data-language="CSharp">CSharp</li>
      <li class="tab" data-language="AnotherLanguage">AnotherLanguage</li>
      <li class="tab" data-language="YetAnotherLanguage">YetAnotherLanguage</li>
    </ul>
    <div data-language="CSharp">
      <pre> ... </pre>
    </div>
    <div data-language="AnotherLanguage">
      <pre> ... </pre>
    </div>
    <div data-language="YetAnotherLanguage">
      <pre> ... </pre>
    </div>
  </div>
</div> 
```

# ruby-on-rails - has_many :through 关系中的视图

> ID：14630711
> 
> 赞同：1
> 
> 时间：2013-01-31T16:38:13.873
> 
> 标签：ruby-on-rails, ruby, views, many-to-many, has-and-belongs-to-many

我一直在修补这个有一段时间了，似乎无法弄清楚这一点。这可能很简单，但这里有：

我有一个has_many：'层压'和'标准'之间的低谷关系以及一个联合模型'标准化'。

**标准.rb**

```
class Standard < ActiveRecord::Base
attr_accessible :description, :name
has_many :standardizations
has_many :laminates, :through => :standardizations
end 
```

**标准化.rb**

```
class Standardization < ActiveRecord::Base
  attr_accessible :laminate_id, :standard_id
  belongs_to :laminate
  belongs_to :standard
end 
```

**层压板.rb**

```
class Laminate < ActiveRecord::Base
attr_accessible :name, :standard_ids
has_many :standardizations
has_many :standards, :through => :standardizations
end 
```

场景是层压板可以属于多个标准，并且我已经在视图的新部分中完成了所有工作 - 复选框和所有内容。我的问题是在尝试显示给定层压板的相应标准的名称时。到目前为止，我能够显示层压板被分配到的标准，但不仅仅是标准的名称。

我的 show.html.erb 说：

```
<%= @laminate.standards %> 
```

这会返回一切正确，但是说

```
 <%= @laminate.standards.name %> 
```

...不起作用。**我到底如何才能利用每个人的姓名、指定的标准？**

**层压板控制器：**

```
class LaminatesController < ApplicationController
# GET /laminates
# GET /laminates.json
def index
@laminates = Laminate.all
@standards = Standard.all

respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @laminates }
end
end

# GET /laminates/1
# GET /laminates/1.json
def show
@laminate = Laminate.find(params[:id])
@standard = Standard.find(params[:id])

respond_to do |format|
  format.html # show.html.erb
  format.json { render json: @laminate }
end
end

# GET /laminates/new
# GET /laminates/new.json
def new
@laminate = Laminate.new

respond_to do |format|
  format.html # new.html.erb
  format.json { render json: @laminate }
end
end

# GET /laminates/1/edit
def edit
@laminate = Laminate.find(params[:id])
end

# POST /laminates
# POST /laminates.json
def create
@laminate = Laminate.new(params[:laminate])

respond_to do |format|
  if @laminate.save
    format.html { redirect_to @laminate, notice: 'Laminate was successfully created.' }
    format.json { render json: @laminate, status: :created, location: @laminate }
  else
    format.html { render action: "new" }
    format.json { render json: @laminate.errors, status: :unprocessable_entity }
  end
  end
end

# PUT /laminates/1
# PUT /laminates/1.json
def update
@laminate = Laminate.find(params[:id])

respond_to do |format|
  if @laminate.update_attributes(params[:laminate])
    format.html { redirect_to @laminate, notice: 'Laminate was successfully updated.' }
    format.json { head :no_content }
  else
    format.html { render action: "edit" }
    format.json { render json: @laminate.errors, status: :unprocessable_entity }
  end
 end
end

# DELETE /laminates/1
# DELETE /laminates/1.json
def destroy
@laminate = Laminate.find(params[:id])
@laminate.destroy

respond_to do |format|
  format.html { redirect_to laminates_url }
  format.json { head :no_content }
  end
 end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:40:07.813

以下`@laminate.standards`返回标准列表。此处调用名称不起作用，您应该在列表中执行每个循环：

```
# replace the following:
<%= @laminate.standards.name %>
# with this code:
<% @laminate.standards.each do |standard| %>
  <%= standard.name %>
<% end %> 
```

如果您想要更短的版本但可定制性较低：

```
<%= @laminate.standards.map{ |standard| standard.name }.join(', ') %>
# This will show all the standards' name with a coma-space ',' between it

# same a above but shorter:
<%= @laminate.standards.map(&:name).join(', ') %>
# this will call the 'name' method on each standard of @laminate.standards
# and join them with a coma-space
# something that would look like this:
# name1, name2, name3 
```

# javascript - 用数组中的数据替换字符串中的单词

> ID：14630712
> 
> 赞同：-2
> 
> 时间：2013-01-31T16:38:15.243
> 
> 标签：javascript, jquery, string

使用 jquery 我需要识别字符串中的字符序列并将它们替换为不同的字符串。

从此开始：

```
 var data = {
       name    : 'Brian',
       surname : 'Logan',
       city    : 'London'
    }

var msg = ' hello <name> <surname> from <city>! ' 
```

我需要处理字符串'msg'来得到这个：

“你好，来自伦敦的布赖恩·洛根！”

当我在名为'textmerge'的visual foxpro中工作时，我使用了类似的方法，但我找不到执行相同操作的jquery函数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:43:08.667

只需将替换函数传递给`replace`：

```
String.prototype.format = function(mapping) {
    return this.replace(/<(.*?)>/g, function(match, name) {
        return mapping[name];
    });
}; 
```

你可以这样称呼它`msg.format(data)`。

# html - emmet 是否允许布尔属性？

> ID：14630725
> 
> 赞同：3
> 
> 时间：2013-01-31T16:39:10.747
> 
> 标签：html, shortcut, emmet

当我在理解 emmet 的编辑器中键入以下文本时：

```
div.fragment>pre>code.javascript[contenteditable] 
```

它扩展到：

```
<div class="fragment">
    <pre><code class="javascript" contenteditable=""></code></pre>
</div> 
```

这几乎是完美的，除了布尔属性不应该有引号。有没有办法编写快捷方式，以便它像这样正确扩展：

```
<div class="fragment">
    <pre><code class="javascript" contenteditable></code></pre>
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-10-29T02:28:55.133

自 2013 年 10 月起，这已成为可能。

```
input[type=checkbox checked.] 
```

默认情况下，在布尔属性之后直接键入一个句点 (.) 将产生以下输出：

```
<input type="checkbox" checked="checked" /> 
```

如果您希望 Emmet 输出不带参数的属性名称，例如

```
<input type="checkbox" checked /> 
```

您需要将以下键值对添加到 Emmet 用户设置中的“html”对象（Mac：“Sublime Text”>“首选项”>“包设置”>“Emmet”>“设置 - 用户”）

```
"compact_bool": true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T09:41:33.023

不，Emmet 目前不支持布尔属性。这将需要额外的努力和语法升级来明确指定缩写的布尔属性。您可以为此创建一个问题：[https ://github.com/emmetio/emmet/issues](https://github.com/emmetio/emmet/issues)

# c# - 编辑器 Unity3D，从对象而不是整个对象传递值

> ID：14630731
> 
> 赞同：1
> 
> 时间：2013-01-31T16:39:34.823
> 
> 标签：c#, unity3d

这更像是一个想法，而不是一个问题，但我想知道一些事情。考虑一个地图类和一个机器人类。现在我想从地图中获取一些值以与机器人一起使用，例如 tileSize 但我不需要对象的其余部分。是否可以在编辑器中传递对象的值而不必传递整个对象？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:53:30.433

您可以做两件我能想到的事情，这取决于您是否要拥有多个地图对象。

您可以保留地图对象的静态列表或静态字段，然后有一个静态变量从对象中提取信息

```
 class Map{
    static Map map;
    public static Map Mapvariable {get{return map.variable;}}

     void Start(){
           map = this;
     }
 } 
```

那么你所要做的就是得到它

```
 Map.Mapvariable 
```

列表的相同概念只有一个名称或 ID，可用于识别女巫地图

# sql - 如何将 AND 条件的结果与 .NET 中的另一个条件相结合

> ID：14630734
> 
> 赞同：0
> 
> 时间：2013-01-31T16:39:45.210
> 
> 标签：sql, sql-server, tsql

我一直在写这个查询。我有这些表：

**美食：美食**
ID
美食名称美食
类型

**菜肴：**
DishID
DishName
CuisineID

**设施：**
FacilityID
FacilityName

**RestaurantDish:** RestaurantDishID RestaurantID DishID

**餐厅：** RestaurantID Name City Location PhoneNo

我必须根据用户选择的设施或菜肴或菜肴来显示餐厅。一旦我有一个餐厅列表，我必须通过每个用户选择进一步细化相同的列表。我写了这个不起作用的程序：

```
 ALTER PROCEDURE [dbo].[spGetFilterData]
@searchText NVARCHAR(MAX),
@DishIDs NVARCHAR(200) ,
@FacilitDs NVARCHAR(200) ,
@CuisineIDs NVARCHAR(200)
 AS 
BEGIN

    SET NOCOUNT ON;

    DECLARE @sql NVARCHAR(MAX)
    SET @sql = '';

    SET @sql = 'SELECT  RestaurantID ,
            Name ,
            City ,
            Location ,
            Country ,
            PhoneNo1 ,
            PhoneNo2 ,
            PhoneNo3 ,
            FaxNumber ,
            Timings ,
            HappyHour ,
            Menu ,
            Buffet ,
            Rating ,
            DateCreated ,
            Datemodified ,
            DateDeleted
    FROM    dbo.Restaurants AS r
    WHERE   ( RestaurantID IN (
              SELECT    rd.RestaurantID
              FROM      dbo.RestaurantDish AS rd
                        INNER JOIN dbo.Dishes1 AS d ON d.DishID = rd.DishID
              WHERE     ( d.DishName LIKE ''%' + @searchText + '%'''

    IF @DishIDs <> '' 
        BEGIN
            SET @sql =@sql + '   AND d.DishID IN ( ' + @DishIDs + ' )'

        END 
    SET @sql =@sql + ') ) )'       
    SET @sql =@sql + ' AND ( RestaurantID IN (
                 SELECT rf.RestaurantID
                 FROM   dbo.RestaurantFacility AS rf
                        INNER JOIN dbo.Facilities1 AS f ON f.FacilityID = rf.FacilityID
                 WHERE  ( f.FacilityName LIKE ''%' + @searchText + '%'''
    IF @FacilitDs <> '' 
        BEGIN
            SET @sql =@sql + ' AND f.FacilityID IN ( ' + @FacilitDs + ' )'
        END
    SET @sql =@sql + ') ) )'  
    SET @sql =@sql + '  OR ( RestaurantID IN (
                 SELECT RestaurantID
                 FROM   dbo.RestaurantDish
                 WHERE  ( DishID IN (
                          SELECT    dbo.RestaurantDish.DishID
                          FROM      dbo.Cuisine1
                          WHERE     ( CuisineName LIKE ''%' + @searchText
        + '%'')'
    IF @CuisineIDs <> '' 
        BEGIN
            SET @sql = @sql +' AND CuisineID IN ( ' + @CuisineIDs + ' )'
        END
    SET @sql =@sql + ') ) ))'                         
    SET @sql =@sql + '  OR ( Name LIKE ''%' + @searchText + '%'')
            OR ( City LIKE ''%' + @searchText + '%'')
            OR ( Country LIKE ''%' + @searchText + '%'')
            OR ( Buffet LIKE ''%' + @searchText + '%'')
            OR ( Location LIKE ''%' + @searchText + '%'')'
    EXECUTE sp_executesql @sql;     
END 
```

我不知道还能做什么..这是我的课：

```
 public class DBAccess
       {
        public DBAccess()
       {
    //
    // TODO: Add constructor logic here
    //
        }
private SqlConnection GetConnection()
{
    SqlConnection con = null;
    try
    {
        string strCon = ConfigurationManager.ConnectionStrings["food4uConnectionString"].ConnectionString;
        con = new SqlConnection(strCon);
        con.Open();

    }
    catch (Exception ex)
    {
        con.Close();
        throw;
    }
    return con;
}

public List<Restaurants> GetAllRestaurents(string searchText, string dishIDs, string facilityIDs, string cuisineIDS)
{
    List<Restaurants> restaurants = null;
    try
    {
        SqlCommand cmd = new SqlCommand("spGetFilterData", GetConnection());
        cmd.CommandType = System.Data.CommandType.StoredProcedure;

        cmd.Parameters.AddWithValue("searchText", searchText);
        cmd.Parameters.AddWithValue("DishIDs", dishIDs);
        cmd.Parameters.AddWithValue("FacilitDs", facilityIDs);
        cmd.Parameters.AddWithValue("CuisineIDs", cuisineIDS);

        SqlDataReader dreader = cmd.ExecuteReader();
        restaurants = new List<Restaurants>();
        while (dreader.Read())
        {
            restaurants.Add(new Restaurants()
            {
                RestaurantID = (int)dreader["RestaurantID"],
                Name = (string)dreader["Name"],
                City = (string)dreader["City"],
                Country = (string)dreader["Country"],
                Location = (string)dreader["Location"],
                PhoneNo1 = (string)dreader["PhoneNo1"],
                PhoneNo2 = (string)dreader["PhoneNo2"],
                PhoneNo3 = (string)dreader["PhoneNo3"],
                Menu = (string)dreader["Menu"],
                HappyHour = (string)dreader["HappyHour"],
                Buffet = (string)dreader["Buffet"],
                Rating = (string)dreader["Rating"],
                FaxNo = (string)dreader["FaxNumber"],
                Timings = (DateTime)dreader["Timings"],
                DateCreated = (DateTime)dreader["DateCreated"],
                DateDeleted = (DateTime)dreader["DateDeleted"],
                Datemodified = (DateTime)dreader["DateModified"]
            });
        }
    }
    catch (Exception ex)
    {
        throw;
    }

    return restaurants;
}

public List<Facilities1> GetFacilities(int restaurentID, string facilityID)
{
    List<Facilities1> facilities = null;
    try
    {
        SqlCommand cmd = new SqlCommand("spGetFacilities", GetConnection());
        cmd.CommandType = System.Data.CommandType.StoredProcedure;
        cmd.Parameters.AddWithValue("RestaurantID", restaurentID);
        cmd.Parameters.AddWithValue("FacilityID", facilityID);
        SqlDataReader dreader = cmd.ExecuteReader();
        facilities = new List<Facilities1>();
        while (dreader.Read())
        {
            facilities.Add(new Facilities1()
            {
                FacilityID = (int)dreader["FacilityID"],
                FacilityName = (string)dreader["FacilityName"]
            });
        }
    }
    catch (Exception ex)
    {
        throw;
    }

    return facilities;
}

public List<Dishes1> GetDishes(int restaurentID, string dishID)
{
    List<Dishes1> dishes = null;
    try
    {
        SqlCommand cmd = new SqlCommand("spGetDishes", GetConnection());
        cmd.CommandType = System.Data.CommandType.StoredProcedure;
        cmd.Parameters.AddWithValue("RestaurantID", restaurentID);
        cmd.Parameters.AddWithValue("DishID", dishID);
        SqlDataReader dreader = cmd.ExecuteReader();
        dishes = new List<Dishes1>();
        while (dreader.Read())
        {
            dishes.Add(new Dishes1()
            {
                DishID = (int)dreader["DishID"],
                DishName = (string)dreader["DishName"],
                Price = (int)dreader["Price"]
            });
        }
    }
    catch (Exception ex)
    {
        throw;
    }

    return dishes;
}

public List<Cuisine> GetCuisines(int restaurentID, string cousineID)
{
    List<Cuisine> cuisines = null;
    try
    {
        SqlCommand cmd = new SqlCommand("spGetCuisines", GetConnection());
        cmd.CommandType = System.Data.CommandType.StoredProcedure;
        cmd.Parameters.AddWithValue("RestaurantID", restaurentID);
        cmd.Parameters.AddWithValue("CuisineID", cousineID);
        SqlDataReader dreader = cmd.ExecuteReader();
        cuisines = new List<Cuisine>();
        while (dreader.Read())
        {
            cuisines.Add(new Cuisine()
            {
                CuisineID = (int)dreader["CuisineID"],
                CuisineName = (string)dreader["CuisineName"]
            });
        }
    }
    catch (Exception ex)
    {
        throw;
    }

    return cuisines;
}

public List<Dishes1> GetAllDishes()
{
    List<Dishes1> dishes = null;
    try
    {
        SqlCommand cmd = new SqlCommand("Select DishID, DishName From Dishes1", GetConnection());
        cmd.CommandType = System.Data.CommandType.Text;
        SqlDataReader dreader = cmd.ExecuteReader();
        dishes = new List<Dishes1>();
        while (dreader.Read())
        {
            dishes.Add(new Dishes1()
            {
                DishID = (int)dreader["DishID"],
                DishName = (string)dreader["DishName"]
            });
        }
    }
    catch (Exception ex)
    {
        throw;
    }

    return dishes;
}

public List<Cuisine> GetAllCuisine()
{
    List<Cuisine> cuisines = null;
    try
    {
        SqlCommand cmd = new SqlCommand("Select CuisineID,  CuisineName From Cuisine1", GetConnection());
        cmd.CommandType = System.Data.CommandType.Text;
        SqlDataReader dreader = cmd.ExecuteReader();
        cuisines = new List<Cuisine>();
        while (dreader.Read())
        {
            cuisines.Add(new Cuisine()
            {
                CuisineID = (int)dreader["CuisineID"],
                CuisineName = (string)dreader["CuisineName"]
            });
        }
    }
    catch (Exception ex)
    {
        throw;
    }

    return cuisines;
}

public List<Facilities1> GetAllFacilities()
{
    List<Facilities1> facilities = null;
    try
    {
        SqlCommand cmd = new SqlCommand("Select FacilityID, FacilityName from Facilities1", GetConnection());
        cmd.CommandType = System.Data.CommandType.Text;
        SqlDataReader dreader = cmd.ExecuteReader();
        facilities = new List<Facilities1>();
        while (dreader.Read())
        {
            facilities.Add(new Facilities1()
            {
                FacilityID = (int)dreader["FacilityID"],
                FacilityName = (string)dreader["FacilityName"]
            });
        }
    }
    catch (Exception ex)
    {
        throw;
    }

    return facilities;
} 
```

} ///// 这里是另一个类：

```
 public partial class Restaurant : System.Web.UI.Page
       {
public string facility = null;
public string cuis = null;
public string dish = null;
public string location = null;

protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        BindListView();
        BindDishesAsCheckBoxes();
    }
}

private void BindListView()
{
    string searchText = this.txtSearch.Text;
    string facilityIDs = hfFacilityID.Value == "" ? "" : hfFacilityID.Value.Remove(hfFacilityID.Value.Length - 1);
    string dishIDs = hfDishID.Value == "" ? "" : hfDishID.Value.Remove(hfDishID.Value.Length - 1);
    string cuisineIDs = hfCuisineID.Value == "" ? "" : hfCuisineID.Value.Remove(hfCuisineID.Value.Length - 1);

    try
    {
        DBAccess objDB = new DBAccess();
        listView.DataSource = objDB.GetAllRestaurents(searchText, dishIDs, facilityIDs, cuisineIDs);
        listView.DataBind();
    }
    catch (Exception ex)
    {

    }
}

private void BindDishesAsCheckBoxes()
{
    try
    {
        DBAccess objdb = new DBAccess();

        //dishes
        chkDishes.DataSource = objdb.GetAllDishes();
        chkDishes.DataBind();

        //cuisines
        chkCuisine.DataSource = objdb.GetAllCuisine();
        chkCuisine.DataBind();

        //facilities
        chkFacilities.DataSource = objdb.GetAllFacilities();
        chkFacilities.DataBind();
    }
    catch (Exception ex)
    {

    }
}

#region itemdatabound

protected void ContactsListView_ItemDataBound(object sender, ListViewItemEventArgs e)
{

    string facilityIDs = hfFacilityID.Value == "" ? "" : hfFacilityID.Value.Remove(hfFacilityID.Value.Length - 1);
    string dishIDs = hfDishID.Value == "" ? "" : hfDishID.Value.Remove(hfDishID.Value.Length - 1);
    string cuisineIDs = hfCuisineID.Value == "" ? "" : hfCuisineID.Value.Remove(hfCuisineID.Value.Length - 1);
    try
    {
        if (e.Item.ItemType == ListViewItemType.DataItem)
        {
            Label lbl1 = (Label)e.Item.FindControl("lblRestaurentID");
            DBAccess objdb = new DBAccess();

            //bind  facility
            Repeater rpFacility = (Repeater)e.Item.FindControl("rptFacility");
            rpFacility.DataSource = objdb.GetFacilities(Convert.ToInt32(lbl1.Text), facilityIDs);
            rpFacility.DataBind();

            //bind  dishes
            Repeater rpDish = (Repeater)e.Item.FindControl("rptDish");
            rpDish.DataSource = objdb.GetDishes(Convert.ToInt32(lbl1.Text), dishIDs);
            rpDish.DataBind();

            //bind  dishes
            Repeater rptCuisine = (Repeater)e.Item.FindControl("rptCuisine");
            rptCuisine.DataSource = objdb.GetCuisines(Convert.ToInt32(lbl1.Text), cuisineIDs);
            rptCuisine.DataBind();
        }
    }
    catch (Exception ex)
    {
        //dvError.Visible = true;
        //lblErrorMessage.Text = ex.Message;
    }
}

#endregion

protected void chkDishes_SelectedIndexChanged(object sender, EventArgs e)
{
    foreach (ListItem item in chkDishes.Items)
    {
        if (item.Selected)
        {
            string id = item.Value;
            hfDishID.Value += id + ",";
            BindListView();
        }
    }
}

protected void chkCuisine_SelectedIndexChanged(object sender, EventArgs e)
{
    foreach (ListItem item in chkCuisine.Items)
    {
        if (item.Selected)
        {
            string id = item.Value;
            hfCuisineID.Value += id + ",";
            BindListView();
        }
    }
}

protected void chkFacilities_SelectedIndexChanged(object sender, EventArgs e)
{
    foreach (ListItem item in chkFacilities.Items)
    {
        if (item.Selected)
        {
            string id = item.Value;
            hfFacilityID.Value += id + ",";
            BindListView();
        }
    }
}

protected void btnSeach_Click(object sender, EventArgs e)
{
    BindListView();
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:00:17.843

您正在编写动态 SQL，这取决于用户正确输入字符串。我认为爆炸可能是由于字符串创建中的错误而发生的。

要调试我会改变这一行：

```
 Execute sp_executesql @sql 
```

至

```
 print @sql 
```

这将为您提供表达式的原始文本。您可以复制并粘贴它，看看发生了什么。请记住，动态 sql 会很快变得非常混乱，因为您正在将操作转置到您正在从字符串构建的引擎中。

您必须确保您的用户传递我认为的合法变量

```
' ''valA'', ''valB'', ''ValC'' ' 
```

因为在传入本身是 varchar 字段的 varchar 字段数组时，您需要用双引号标记引号。这会带来一个问题，因为您必须确保传入的字段本身是合法的。有些人想出了不同的方法来处理这个问题，除了调试代码的方法之外，我还可以提供一些建议：

老实说，如果您有 SQL Server 2008 或更高版本，我会考虑使用“表类型”来声明可以是表类型的自定义类型。用您要查找的数组填充该表并将其传入。您可以构建在 2008 年之后采用表类型的表函数。函数恕我直言，可能并不总是像 procs 那样执行，但它们非常具有可读性并且可以单独作为对象运行链接到这使得它们非常适合遵循封装和可用性规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T17:05:56.323

我假设您动态构建 的原因`@sql`是您希望提供一个逗号分隔的 ID 列表作为菜肴、菜肴和设施的标准。

然而，这使得查询不可读。所以不要这样做。

根据您的使用情况，为这些条件中的每[一个使用表值参数](http://www.sommarskog.se/arrays-in-sql-2008.html)或为您拆分字符串[的拆分函数。](http://www.sommarskog.se/arrays-in-sql-2005.html)

一个简单但可读的拆分函数：

```
ALTER FUNCTION [dbo].[fnStringSplit] (@list ntext)
         RETURNS @table TABLE (token varchar(4000) collate SQL_Latin1_General_CP1_CI_AS) 
AS
BEGIN
      DECLARE @pos       int,
              @textpos   int,
              @chunklen  smallint,
              @chunk     nvarchar(4000),
              @leftover  nvarchar(4000),
              @token     nvarchar(4000),
              @delimiter nchar(1)

      SET @delimiter = N','
      SET @textpos = 1
      SET @leftover = ''
      WHILE @textpos <= datalength(@list) / 2
      BEGIN
         SET @chunklen = 4000 - len(@leftover)
         SET @chunk = @leftover + substring(@list, @textpos, @chunklen)
         SET @textpos = @textpos + @chunklen

         SET @pos = charindex(@delimiter, @chunk)
         WHILE @pos > 0
         BEGIN
            SET @token = left(@chunk, @pos - 1)
            INSERT @table (token) VALUES(@token)
            SET @chunk = substring(@chunk, @pos + 1, len(@chunk))
            SET @pos = charindex(@delimiter, @chunk)
         END

         SET @leftover = @chunk
      END

      INSERT @table(token) VALUES (@leftover)
      RETURN
END 
```

一旦你重写了查询，更正它应该是微不足道的。

# php - 可以在一个 mysql 查询中更新合并两个数组的表内容吗？

> ID：14630741
> 
> 赞同：0
> 
> 时间：2013-01-31T16:40:05.493
> 
> 标签：php, mysql, sql

假设我们有一个 id 数组，例如：(1,6,3,8,0) 由用户提交，其中一些可以在或不在表中。一个示例表可以是：

```
id  content
2   ----
3   ----
8   ----
0   ---- 
```

如您所见，3、8 和 0 在输入数组和表中，因此它们必须留在表上，1 在输入数组上但不在表上，因此必须添加，最后 2 在表上但输入数组上没有，因此必须将其删除。

我可以使用 php 解决这个问题，但我想知道我是否可以只使用 mysql 查询来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:45:32.763

遍历你的数组做一个选择计数检查它是否存在，如果它不存在即：count<0 然后做一个更新或替换这将处理更新或插入方面的事情。又好又简单

对于删除，如果不在数组中，请从 tbl 中删除，其中 id NOT IN(array)

希望如果不让我知道，我可以在有机会的时候给你举个例子，这是有道理的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:45:34.090

听起来您想要做的是带有 ON DUPLICATE KEY UPDATE 的 INSERT，或者可能是 INSERT IGNORE（取决于您是否要更改表上已存在于表中的数组中的项目的任何值）

# c++ - 使用 auto 具有带有 boost::random 的分布函数

> ID：14630746
> 
> 赞同：0
> 
> 时间：2013-01-31T16:40:11.730
> 
> 标签：c++, boost, random, functional-programming

我正在尝试创建一个元组，在其中我将有一个函数，该函数接受一个生成器并返回一个双精度值。

我仍然很难实现它。

到目前为止，我正在尝试使这样的线路有效：

```
 auto g = boost::random::uniform_real_distribution<>().operator()<boost::random::mt19937>; 
```

理想情况下使用它

```
#include <boost/random.hpp>

main()
{
    //I want to see all boost distribution as std::function<double(boost::random::mt19937)>
    auto g = boost::random::uniform_real_distribution<>().operator()<boost::random::mt19937>;
    boost::random::mt19937 f(0);
    double x = g(f);
} 
```

我遗漏了一些东西（肯定是 operator() 是模板化的事实），但我不明白为什么它不能在自动上编译。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:54:18.513

您的表达式首先创建一个临时 ( `boost::random::uniform_real_distribution<>()`)，然后使用该`.`符号。编译器将其解释为尝试访问成员或在该临时对象上**调用函数**（该函数`operator ()`在您的情况下）。但是，函数调用缺少参数和括号，这在语法上是非法的。这就是它无法编译的原因。

无论如何，如果我正确理解你想要做什么，你基本上想要一个封装`operator ()`另一个对象的函子。但是，我不明白你为什么需要一个。如果您首先有一个仿函数，例如`boost::random::uniform_real_distribution<>`，那么拥有另一个只包装它的仿函数`operator ()`是毫无意义的。

为什么你不能这样做？

```
boost::random::uniform_real_distribution<> g;    
boost::random::mt19937 f(0);
double x = g(f); 
```

# c# - 服务绑定被忽略

> ID：14630754
> 
> 赞同：0
> 
> 时间：2013-01-31T16:40:30.537
> 
> 标签：c#, wcf

好的，所以我有

```
<system.serviceModel>
    <bindings>
      <wsDualHttpBinding>
        <binding name="ExternalMonitoringBinding" 
                 clientBaseAddress="http://localhost:50000/"
                 closeTimeout="00:00:30">
          <security mode ="None"/>
          <reliableSession ordered="false"/>
        </binding>

      </wsDualHttpBinding>
    </bindings>
    <services>
      <service name="Loop.Nextmove.ExternalMonitoring.NextmoveMonitorService">
        <endpoint address="" binding="wsDualHttpBinding" bindingConfiguration="ExternalMonitoringBinding"
          contract="Loop.Nextmove.ExternalMonitoring.INextmoveCommunicatorMonitorService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8732/Design_Time_Addresses/NextmoveComunicatorHelpdesk/Service1/" />
          </baseAddresses>
        </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, 
          set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="True"/>

          <!-- To receive exception details in faults for debugging purposes, 
          set the value below to true.  Set to false before deployment 
          to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>` 
```

每当我发现该服务时，客户端都会得到以下信息：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <system.serviceModel>
        <bindings>
            <wsDualHttpBinding>
                <binding name="WSDualHttpBinding_INextmoveCommunicatorMonitorService"
                    closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00"
                    sendTimeout="00:01:00" bypassProxyOnLocal="false" transactionFlow="false"
                    hostNameComparisonMode="StrongWildcard" maxBufferPoolSize="524288"
                    maxReceivedMessageSize="65536" messageEncoding="Text" textEncoding="utf-8"
                    useDefaultWebProxy="true">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                    <reliableSession ordered="true" inactivityTimeout="00:10:00" />
                    <security mode="None">
                        <message clientCredentialType="Windows" negotiateServiceCredential="true" />
                    </security>
                </binding>
            </wsDualHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://localhost:8732/Design_Time_Addresses/NextmoveComunicatorHelpdesk/Service1/"
                binding="wsDualHttpBinding" bindingConfiguration="WSDualHttpBinding_INextmoveCommunicatorMonitorService"
                contract="NextmoveMonitoring.INextmoveCommunicatorMonitorService"
                name="WSDualHttpBinding_INextmoveCommunicatorMonitorService">
                <identity>
                    <dns value="localhost" />
                </identity>
            </endpoint>
        </client>
    </system.serviceModel>
</configuration>` 
```

如您所见，它似乎完全忽略了命名绑定及其值`clientBaseAddress`和`closeTimeout`值。但是，它显然做*对了*，因为安全模式被正确设置为无。

我在这里做错了什么？

# cucumber - 如何在 capabara 中按索引选择选项

> ID：14630755
> 
> 赞同：2
> 
> 时间：2013-01-31T16:40:32.483
> 
> 标签：cucumber, capybara

我想在下面的树中使用索引选择第二个选项。

```
<select id="buy_buy_options" name="buy[buy_options]" required="required">
<option value="" selected="selected">one</option>
<option value="16190937"> one</option>
<option value="16190939">Two</option>
</select> 
```

我不想仅按索引使用值或文本。我该怎么做？我正在使用水豚和黄瓜

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:58:09.537

您可以使用 CSS 选择器：

```
find('#buy_buy_options > option:nth-child(2)').click 
```

或 XPath：

```
find(:xpath, "//select[@id='buy_buy_options']/option[2]").click 
```

# php - 在 Codeigniter 中管理动态表单并更新数据库？

> ID：14630758
> 
> 赞同：0
> 
> 时间：2013-01-31T16:40:43.783
> 
> 标签：php, database, forms, codeigniter, dynamic

我有一个包含许多表的数据库，`dbtable`.

我正在使用 php 创建一个表单，并使用`<table>`.

表中的每个`<tr>`对应于 a 中的一行`dbtable`。

所以，a 中的行`dbtable`越多，tr-tags 就越多……你明白了。

我的问题是：

我应该如何命名输入标签才能使用 POST 变量相应地更新数据库？

目前，我将它们命名`1_name, 2_name, 3_name`为一个 dbtable 数据`1_1_valueA, 1_1_valueB, 1_2_valueA, 1_2_valueB`，然后为属于 1_name、2_name 等的数据命名。

但我觉得这不是一个好方法..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:48:11.790

像这样命名它们：

```
item[0][db_row_id]
item[0][value_a]
item[0][value_b]

item[1][db_row_id]
item[1][value_a]
item[1][value_b] 
```

其中数字 0 和 1 等只是分配为 POST 数组中的索引

您将能够检索所有项目`$_POST['item']`

或在 CI`$this->input->post('item')`

它看起来像这样：

```
array(
 array('db_row_id'=>val,'value_a'=>val,'value_b'=>val),
 array('db_row_id'=>val,'value_a'=>val,'value_b'=>val)
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T04:48:53.863

```
<input name="reords[0]['Name']" />
<input name="reords[0]['Age']" />
<input name="reords[0]['City']" />

<input name="reords[1]['Name']" />
<input name="reords[1]['Age']" />
<input name="reords[1]['City']" /> 
```

您可以通过以下方式访问服务器中的数据

```
$this->input->post('reords'); 
```

它是一个这样的数组

```
array(array('Name'=>'post val','Age'=>'post val','City'=>'post val'),
      array('Name'=>'post val','Age'=>'post val','City'=>'post val')
  ) 
```

您可以使用 codegniter`upadte_batch`将这些记录添加到 db

[http://ellislab.com/codeigniter/user-guide/database/active_record.html](http://ellislab.com/codeigniter/user-guide/database/active_record.html)

# winapi - 在Win32中，如何改变STATIC文本的颜色？

> ID：14630760
> 
> 赞同：2
> 
> 时间：2013-01-31T16:40:57.177
> 
> 标签：winapi

我在一个黑色的窗口上有一些静态文本，我想在运行时使用颜色选择器对话框更改它。我已经成功获取了颜色，现在我只需要更改文字！我已阅读该`WM_CTLCOLORSTATIC`消息是要处理的消息，尽管这似乎仅适用于最初将控件绘制到屏幕上时。可以`WM_PAINT`用吗？

到目前为止设置颜色的代码是（`WM_CTLCOLORSTATIC`以防万一）：

```
if ((HWND)lParam == GetDlgItem(hWnd, uLabelId)
{
    SetBkMode((HDC)wParam, TRANSPARENT);
    SetTextColor((HDC)wParam, crLabelTextColour);
    return (BOOL)CreateSolidBrush(GetSysColor(COLOR_MENU));
} 
```

在处理这个问题时，我可能完全搞错了，所以任何帮助都将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:46:05.023

你在正确的轨道上`WM_CTLCOLORSTATIC`。如果要更改颜色，则使控件无效（可能使用[`RedrawWindow`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162911%28v=vs.85%29.aspx)）。这将导致它被重新粉刷。重新绘制后，`WM_CTLCOLORSTATIC`将再次调用您的处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:46:21.453

几点建议：

*   您是否知道接收的是父对话框`WM_CTLCOLORSTATIC`，而不是控件本身？

*   看起来很奇怪——`return (BOOL)...`这段代码存在于哪个函数中？你应该从你的窗口过程中返回一个 LRESULT。

*   您每次都在泄漏刷子-您应该维护一个刷子并每次都返回该刷子。Windows 不会清理画笔。

# php - PDO：用rowCount确定数据库中的表数？

> ID：14630763
> 
> 赞同：1
> 
> 时间：2013-01-31T16:41:05.167
> 
> 标签：php, mysql, pdo, rowcount

我正在使用安装一些表的 CMS，然后验证安装正确的所有内容，尝试计算数据库中的表数。（注意目标是计算表本身而不是表中的行）

使用的查询是“SHOW TABLES”，结果保存到“$result”。像这样：

```
$link->query("SHOW TABLES") 
```

然后再往下看代码有一个像这样的 $result 计数：

```
if ($result->rowCount() > 0) {
    $r = $result->fetchAll(PDO::FETCH_ASSOC);
}else{
    $r = false;
    return $r;
} 
```

当我测试结果时，我得到 0 返回。（数据库中有 14 个表） rowCount 是使用 SHOW TABLES 时应用的正确方法吗？从我读到的 rowCount 只计算受影响的行。由于 SHOW TABLES 不会影响任何东西，它不会计算任何东西。

我的假设是正确的还是这里发生了其他事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:46:17.833

尝试

```
$count = $link->query('show tables')->fetch(PDO::FETCH_NUM); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:53:41.530

information_schema 的另一种方式：

```
$sql = "
SELECT COUNT( * ) AS 'Tables'
FROM information_schema.TABLES
WHERE table_schema = 'YOUR_DB_NAME'
GROUP BY table_schema
";

$count = $link->query($sql)->fetchColumn(); 
```

另一种方法`SHOW TABLES`是：

```
$count = count($link->query("SHOW TABLES")->fetchAll()); 
```

# html - 选择选项替代

> ID：14630764
> 
> 赞同：0
> 
> 时间：2013-01-31T16:41:09.467
> 
> 标签：html, select, option

在抱歉我的英语不好之前。因此，我描述了我的问题，非常简短。

我单击“Gold”上的第一个选择列表，列表 3“Legierung”（999er、999er、999er ......）

**我在“ Silber** ”上单击第一个选择列表，列表3“Legierung”成为**其他词**（333er，666er .....）

**所以第三个列表取决于第一个列表的选择。**

有谁知道我该怎么做？

谢谢你。

[http://jsfiddle.net/HvmyK/](http://jsfiddle.net/HvmyK/)

```
<div class=" goldrechner">

        <div id="calculator">
            <form name=" goldrechner-form" class=" goldrechner-form">
            <input name="pt" value="1650" id="pt" type="hidden">
            <input name="pc" value="100" id="pc" type="hidden">
            <input name="ex" value="1.0048" id="ex" type="hidden">
            <div class=" goldrechner-header">
                <h2>Goldrechner</h2>
            </div>

            <ul>
                <li>
                <label class="desc" for="gr_em">
                    <span>W&auml;hlen Sie Ihr Edelmetall aus</span>
                                <div>
            <select id="gr_em" name="gr_em" tabindex="1">

<option selected="selected" value="gold">Gold</option>
<option value="silber">Silber</option>
<option value="platin">Platin</option>
<option value="palladium">Palladium</option>

    </select>

            </div>

            <li>

            <label class="desc" for="gc-unit" >
            <span>Gewichtseinheit</span>

            <div>
            <select id="gc-unit" name="gc-unit" tabindex="2">
<option selected="selected" value="gramm">Gramm</option>

    </select>

         </div>

            <li class="colf">
            <label class="desc" for="gr_gewicht" >
            <span>Gewicht</span>
            <div>
            <input id="gr_gewicht" name="gr_gewicht" class="small" tabindex="3" onkeyup="" type="text">

            <li class="colr">
            <label class="desc" for="gc-purity">
            <span>Legierung</span>
                            <div>
            <select id="gc-purity" name="gc-purity" tabindex="4">

<option selected="selected" value=".75">999er</option>
<option value=".917*.725">999er</option>
<option value=".725*.8">999er</option>
<option value=".725*.75">999er</option>
<option value=".725*.585">999er</option>
<option value=".725*.417">999er</option>
<option value=".65*.375">999er</option>
<option value=".65*.333">999er</option>
                    </select>
            </div>

            <li class="worthresult">
                <div class="result">
                    <span class="num">0.00 Euro</span>
                </div>
            </li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:15:14.270

这是使用 jQuery 的解决方案：

它当前所做的只是根据第一个选择元素中选择的选项替换第三个选择元素中每个选项的文本，但您可能还希望更改每个选项的值或 ID 以便能够识别每个选项分别。

工作小提琴：http: [//jsfiddle.net/HvmyK/2/](http://jsfiddle.net/HvmyK/2/)

```
$(document).ready(function(){
//Monitor first select element for change in selected option
$('select#gr_em').on('change', function(){
    console.log('changed');
    //Change 3rd select text if gold option selection
    if($('option:selected', this).val() === 'gold'){
        $('select#gc-purity option:eq(0)').text('Gold - New Option 1');
        $('select#gc-purity option:eq(1)').text('Gold - New Option 2');
        $('select#gc-purity option:eq(2)').text('Gold - New Option 3');
        $('select#gc-purity option:eq(3)').text('Gold - New Option 4');
        $('select#gc-purity option:eq(4)').text('Gold - New Option 5');
        $('select#gc-purity option:eq(5)').text('Gold - New Option 6');
        $('select#gc-purity option:eq(6)').text('Gold - New Option 7');
    }
    //Change 3rd select text if silber option selection
    else if($('option:selected', this).val() === 'silber'){
        $('select#gc-purity option:eq(0)').text('Silber - New Option 1');
        $('select#gc-purity option:eq(1)').text('Silber - New Option 2');
        $('select#gc-purity option:eq(2)').text('Silber - New Option 3');
        $('select#gc-purity option:eq(3)').text('Silber - New Option 4');
        $('select#gc-purity option:eq(4)').text('Silber - New Option 5');
        $('select#gc-purity option:eq(5)').text('Silber - New Option 6');
        $('select#gc-purity option:eq(6)').text('Silber - New Option 7');          
    }
    //Change 3rd select text if platin option selection
    else if($('option:selected', this).val() === 'platin'){
        $('select#gc-purity option:eq(0)').text('Platin - New Option 1');
        $('select#gc-purity option:eq(1)').text('Platin - New Option 2');
        $('select#gc-purity option:eq(2)').text('Platin - New Option 3');
        $('select#gc-purity option:eq(3)').text('Platin - New Option 4');
        $('select#gc-purity option:eq(4)').text('Platin - New Option 5');
        $('select#gc-purity option:eq(5)').text('Platin - New Option 6');
        $('select#gc-purity option:eq(6)').text('Platin - New Option 7');           
    }
    //Change 3rd select text if palladium option selection 
    else if($('option:selected', this).val() === 'palladium'){
        $('select#gc-purity option:eq(0)').text('Palladium - New Option 1');
        $('select#gc-purity option:eq(1)').text('Palladium - New Option 2');
        $('select#gc-purity option:eq(2)').text('Palladium - New Option 3');
        $('select#gc-purity option:eq(3)').text('Palladium - New Option 4');
        $('select#gc-purity option:eq(4)').text('Palladium - New Option 5');
        $('select#gc-purity option:eq(5)').text('Palladium - New Option 6');
        $('select#gc-purity option:eq(6)').text('Palladium - New Option 7');        
    }
});
}); 
```

# windows-phone-8 - Windows Phone 8 上的后退按钮

> ID：14630765
> 
> 赞同：7
> 
> 时间：2013-01-31T16:41:14.280
> 
> 标签：windows-phone-8

我无法让后退硬件按钮执行我希望它为 Windows Phone 8 执行的操作。该应用程序严格来说只是 web 视图，所以现在当单击后退（硬件）按钮时，它会关闭应用程序。我该如何解决这个问题，以便它转到上一个网页或返回到索引或那些行上的东西？

谢谢

这是我目前在 MainPage.xaml.cs 文件中的内容

```
namespace AvoidDiabetes
{
public partial class MainPage : PhoneApplicationPage
{
    // Url of Home page
    private string MainUri = "/Html/index.html";
    private Stack<Uri> _history = new Stack<Uri>();
    private Uri _current = null;

    // Constructor
    public MainPage()
    {
        InitializeComponent();
    }

    private void Browser_Loaded(object sender, RoutedEventArgs e)
    {
        // Add your URL here
        Browser.Navigate(new Uri(MainUri, UriKind.Relative));
        Browser.IsScriptEnabled = true;
    }

    // Navigates back in the web browser's navigation stack, not the applications.
    private void BackApplicationBar_Click(object sender, EventArgs e)
    {
        Browser.GoBack();
    }

    // Navigates forward in the web browser's navigation stack, not the applications.
    private void ForwardApplicationBar_Click(object sender, EventArgs e)
    {
        Browser.GoForward();
    }

    // Navigates to the initial "home" page.
    private void HomeMenuItem_Click(object sender, EventArgs e)
    {
        Browser.Navigate(new Uri(MainUri, UriKind.Relative));

    }

    // Handle navigation failures.
    private void Browser_NavigationFailed(object sender, System.Windows.Navigation.NavigationFailedEventArgs e)
    {
        MessageBox.Show("Navigation to this page failed, check your internet connection");
    }

    protected override void OnBackKeyPress(CancelEventArgs e)
    {
        base.OnBackKeyPress(e);

        if (_history.Count == 0)
        {
            // No history, allow the back button
            // Or do whatever you need to do, like navigate the application page
            return;
        }
        // Otherwise, if this isn't the first navigation, push the current
        else
        {
            Browser.GoBack();
        }

    }

    private async void WebBrowser_Navigated(object sender, NavigationEventArgs e)
    {
        // If we navigated back, pop the last entry
        if (_history.Count > 0 && _history.Peek() == e.Uri)
        {
            _history.Pop();
        }
        // Otherwise, if this isn't the first navigation, push the current
        else if (_current != null)
        {
            _history.Push(_current);
        }

        // The current page is now the one we've navigated to
        _current = e.Uri;
    }

} 
```

}

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-11T22:18:41.110

您需要在应用程序的页面中覆盖[OnBackKeyPress并处理将](http://msdn.microsoft.com/en-US/library/windowsphone/develop/microsoft.phone.controls.phoneapplicationpage.onbackkeypress(v=vs.105).aspx)[WebBrowser](http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.phone.controls.webbrowser(v=vs.105).aspx)控件导航回上一页。

假设您使用的是 C#，大致可以这样做（将 WebBrowser_Navigated 连接到您的 WebBrowser 的 Navigated 事件）：

```
private Stack<Uri> _history = new Stack<Uri>();
private Uri _current = null;

protected override void OnBackKeyPress(CancelEventArgs e)
{
    base.OnBackKeyPress(e);

    if (_history.Count == 0)
    {
        // No history, allow the back button
        // Or do whatever you need to do, like navigate the application page
        return;
    }

    // Cancel the back button press
    e.Cancel = true;

    // Navigate to the last page
    Browser.Navigate(_history.Peek());
}

private async void WebBrowser_Navigated(object sender, NavigationEventArgs e)
{
    // If we navigated back, pop the last entry
    if (_history.Count > 0 && _history.Peek() == e.Uri)
    {
        _history.Pop();
    }
    // Otherwise, if this isn't the first navigation, push the current
    else if (_current != null)
    {
        _history.Push(_current);
    }

    // The current page is now the one we've navigated to
    _current = e.Uri;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-10T13:50:07.377

这对我有用，您可以检查 browser.CanGoBack() 是否为真，否则返回

```
 protected override void OnBackKeyPress(CancelEventArgs e) {
        base.OnBackKeyPress(e);

        if (browser.CanGoBack)
        {
            e.Cancel = true;
            browser.GoBack();
        }
        else {
            return;
        }
    } 
```

# macos - 显示使用 sed 更改的文件的文件名，如 grep 显示的内容

> ID：14630768
> 
> 赞同：-1
> 
> 时间：2013-01-31T16:41:17.307
> 
> 标签：macos, sed, terminal, grep, find

我正在使用 Mac OSX 终端并使用 find 然后对文件执行 sed。我如何让它列出已更改的文件？

这就是我正在使用的：

```
find . -name '*.js' -exec sed -i '' 's/_persistenceURL = "prod"/_persistenceURL = "qa"/g' {} + 
```

我喜欢它如何输出匹配的文件列表......我可以从 sed 中得到这个吗？

```
find . -name "*.js" -exec grep -lr "_persistenceURL = \"prod\""  {} \; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:08:33.327

这是一种快速而肮脏的方法，方法是`-exec`在 find 语句中添加第二个操作，该操作在 sed 处理文件名之前回显文件名：

```
find . -name '*.js' -exec echo "{}" \; -exec sed -i '' 's/_persistenceURL = "prod"/_persistenceURL = "qa"/g' {} + 
```

注意：`+`最后的 可能会干扰一点，所以如果不是绝对必要，我会用`\;`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:57:17.083

`sed`不提供返回值的机制，也无权访问文件名。但你可以这样做：

```
find . -name '*.js' -exec sh -c \
   'sed "s/_persistenceURL = \"prod\"/_persistenceURL = \"qa\"/g" $0 > $0.$$; \
   if ! cmp $0.$$ $0; then echo $0; mv $0.$$ $0; else rm $0.$$; fi' {} \; 
```

将命令放在脚本中并执行脚本可能会更干净。请注意，这使用内部 shell 的 pid 作为临时文件的后缀。小心，因为这可能会覆盖文件。将命令放在脚本中并添加一些类似的检查。

# c# - 异步任务的顺序处理

> ID：14630770
> 
> 赞同：33
> 
> 时间：2013-01-31T16:41:17.937
> 
> 标签：c#, .net, .net-4.0, task-parallel-library

假设以下同步代码：

```
try
{
    Foo();
    Bar();
    Fubar();
    Console.WriteLine("All done");
}
catch(Exception e) // For illustration purposes only. Catch specific exceptions!
{
    Console.WriteLine(e);
} 
```

现在假设所有这些方法都有一个 Async 对应物，并且出于某种原因我必须使用它们，所以简单地将整个东西包装在一个新任务中不是一种选择。
我将如何实现相同的行为？
我所说的“相同”是：

1.  如果抛出异常，则执行异常处理程序。
2.  如果抛出异常，则停止执行以下方法。

我唯一能想到的是***可怕***的：

```
var fooTask = FooAsync();
fooTask.ContinueWith(t => HandleError(t.Exception),
                     TaskContinuationOptions.OnlyOnFaulted);
fooTask.ContinueWith(
    t =>
    {
        var barTask = BarAsync();
        barTask.ContinueWith(t => HandleError(t.Exception),
                             TaskContinuationOptions.OnlyOnFaulted);
        barTask.ContinueWith(
            t =>
            {
                var fubarTask = FubarAsync();
                fubarTask.ContinueWith(t => HandleError(t.Exception),
                                       TaskContinuationOptions.OnlyOnFaulted);
                fubarTask.ContinueWith(
                    t => Console.WriteLine("All done"),
                    TaskContinuationOptions.OnlyOnRanToCompletion);
            }, 
            TaskContinuationOptions.OnlyOnRanToCompletion);
    }, 
    TaskContinuationOptions.OnlyOnRanToCompletion); 
```

请注意：

*   我需要一个适用于 .NET 4 的解决方案，所以这`async/await`是不可能的。但是，如果它可以使用，请`async/await`随时展示如何。
*   我不需要使用 TPL。如果 TPL 不可能，另一种方法也可以，也许使用 Reactive Extensions？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-31T16:51:05.403

以下是它的工作方式`async`：

```
try
{
    await FooAsync();
    await BarAsync();
    await FubarAsync();
    Console.WriteLine("All done");
}
catch(Exception e) // For illustration purposes only. Catch specific exceptions!
{
    Console.WriteLine(e);
} 
```

如果您安装了（预发布）[Microsoft.Bcl.Async 包](http://nuget.org/packages/Microsoft.Bcl.Async)，这将适用于 .NET 4.0 。

* * *

由于您被困在 VS2010 上，您可以使用[Stephen Toub 的`Then`](http://blogs.msdn.com/b/pfxteam/archive/2010/11/21/10094564.aspx)变体：

```
public static Task Then(this Task first, Func<Task> next)
{
  var tcs = new TaskCompletionSource<object>();
  first.ContinueWith(_ =>
  {
    if (first.IsFaulted) tcs.TrySetException(first.Exception.InnerExceptions);
    else if (first.IsCanceled) tcs.TrySetCanceled();
    else
    {
      try
      {
        next().ContinueWith(t =>
        {
          if (t.IsFaulted) tcs.TrySetException(t.Exception.InnerExceptions);
          else if (t.IsCanceled) tcs.TrySetCanceled();
          else tcs.TrySetResult(null);
        }, TaskContinuationOptions.ExecuteSynchronously);
      }
      catch (Exception exc) { tcs.TrySetException(exc); }
    }
  }, TaskContinuationOptions.ExecuteSynchronously);
  return tcs.Task; 
} 
```

您可以这样使用它：

```
var task = FooAsync().Then(() => BarAsync()).Then(() => FubarAsync());
task.ContinueWith(t =>
{
  if (t.IsFaulted || t.IsCanceled)
  {
    var e = t.Exception.InnerException;
    // exception handling
  }
  else
  {
    Console.WriteLine("All done");
  }
}, TaskContinuationOptions.ExcecuteSynchronously); 
```

* * *

使用 Rx，它看起来像这样（假设您没有`async`已经公开的方法`IObservable<Unit>`）：

```
FooAsync().ToObservable()
    .SelectMany(_ => BarAsync().ToObservable())
    .SelectMany(_ => FubarAsync().ToObservable())
    .Subscribe(_ => { Console.WriteLine("All done"); },
        e => { Console.WriteLine(e); }); 
```

我认为。无论如何，我不是 Rx 大师。:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-31T17:38:41.813

只是为了完整起见，这就是我将如何实现 Chris Sinclair 建议的辅助方法：

```
public void RunSequential(Action onComplete, Action<Exception> errorHandler,
                          params Func<Task>[] actions)
{
    RunSequential(onComplete, errorHandler,
                  actions.AsEnumerable().GetEnumerator());
}

public void RunSequential(Action onComplete, Action<Exception> errorHandler,
                          IEnumerator<Func<Task>> actions)
{
    if(!actions.MoveNext())
    {
        onComplete();
        return;
    }

    var task = actions.Current();
    task.ContinueWith(t => errorHandler(t.Exception),
                      TaskContinuationOptions.OnlyOnFaulted);
    task.ContinueWith(t => RunSequential(onComplete, errorHandler, actions),
                      TaskContinuationOptions.OnlyOnRanToCompletion);
} 
```

这确保了每个后续任务仅在前一个任务成功完成时才被请求。
它假定`Func<Task>`返回一个已经在运行的任务。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-31T18:26:41.927

你在这里所拥有的本质上是一个`ForEachAsync`. 您希望按顺序运行每个异步项目，但需要一些错误处理支持。这是一种这样的实现：

```
public static Task ForEachAsync(IEnumerable<Func<Task>> tasks)
{
    var tcs = new TaskCompletionSource<bool>();

    Task currentTask = Task.FromResult(false);

    foreach (Func<Task> function in tasks)
    {
        currentTask.ContinueWith(t => tcs.TrySetException(t.Exception.InnerExceptions)
            , TaskContinuationOptions.OnlyOnFaulted);
        currentTask.ContinueWith(t => tcs.TrySetCanceled()
                , TaskContinuationOptions.OnlyOnCanceled);
        Task<Task> continuation = currentTask.ContinueWith(t => function()
            , TaskContinuationOptions.OnlyOnRanToCompletion);
        currentTask = continuation.Unwrap();
    }

    currentTask.ContinueWith(t => tcs.TrySetException(t.Exception.InnerExceptions)
            , TaskContinuationOptions.OnlyOnFaulted);
    currentTask.ContinueWith(t => tcs.TrySetCanceled()
            , TaskContinuationOptions.OnlyOnCanceled);
    currentTask.ContinueWith(t => tcs.TrySetResult(true)
            , TaskContinuationOptions.OnlyOnRanToCompletion);

    return tcs.Task;
} 
```

我还添加了对取消任务的支持，只是为了更笼统，因为它需要做的事情很少。

它将每个任务添加为前一个任务的延续，并且始终确保任何异常都会导致最终任务的异常被设置。

这是一个示例用法：

```
public static Task FooAsync()
{
    Console.WriteLine("Started Foo");
    return Task.Delay(1000)
        .ContinueWith(t => Console.WriteLine("Finished Foo"));
}

public static Task BarAsync()
{
    return Task.Factory.StartNew(() => { throw new Exception(); });
}

private static void Main(string[] args)
{
    List<Func<Task>> list = new List<Func<Task>>();

    list.Add(() => FooAsync());
    list.Add(() => FooAsync());
    list.Add(() => FooAsync());
    list.Add(() => FooAsync());
    list.Add(() => BarAsync());

    Task task = ForEachAsync(list);

    task.ContinueWith(t => Console.WriteLine(t.Exception.ToString())
        , TaskContinuationOptions.OnlyOnFaulted);
    task.ContinueWith(t => Console.WriteLine("Done!")
        , TaskContinuationOptions.OnlyOnRanToCompletion);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-31T17:30:31.170

您应该能够创建一个方法来组合两个任务，并且只有在第一个成功时才启动第二个。

```
public static Task Then(this Task parent, Task next)
{
    TaskCompletionSource<object> tcs = new TaskCompletionSource<object>();
    parent.ContinueWith(pt =>
    {
        if (pt.IsFaulted)
        {
            tcs.SetException(pt.Exception.InnerException);
        }
        else
        {
            next.ContinueWith(nt =>
            {
                if (nt.IsFaulted)
                {
                    tcs.SetException(nt.Exception.InnerException);
                }
                else { tcs.SetResult(null); }
            });
            next.Start();
        }
    });
    return tcs.Task;
} 
```

然后，您可以将任务链接在一起：

```
Task outer = FooAsync()
    .Then(BarAsync())
    .Then(FubarAsync());

outer.ContinueWith(t => {
    if(t.IsFaulted) {
        //handle exception
    }
}); 
```

如果您的任务立即开始，您可以将它们包装在一个`Func`：

```
public static Task Then(this Task parent, Func<Task> nextFunc)
{
    TaskCompletionSource<object> tcs = new TaskCompletionSource<object>();
    parent.ContinueWith(pt =>
    {
        if (pt.IsFaulted)
        {
            tcs.SetException(pt.Exception.InnerException);
        }
        else
        {
            Task next = nextFunc();
            next.ContinueWith(nt =>
            {
                if (nt.IsFaulted)
                {
                    tcs.SetException(nt.Exception.InnerException);
                }
                else { tcs.SetResult(null); }
            });
        }
    });
    return tcs.Task;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-31T17:06:44.607

现在，我并没有真正使用过多的 TPL，所以这只是在黑暗中刺伤。鉴于@Servy 提到的内容，也许这不会完全异步运行。但我想我会发布它，如果它*偏离*了标记，你可以否决我，或者我可以删除它（或者我们可以修复需要修复的内容）

```
public void RunAsync(Action onComplete, Action<Exception> errorHandler, params Action[] actions)
{
    if (actions.Length == 0)
    {
        //what to do when no actions/tasks provided?
        onComplete();
        return;
    }

    List<Task> tasks = new List<Task>(actions.Length);
    foreach(var action in actions)
    {
        Task task = new Task(action);
        task.ContinueWith(t => errorHandler(t.Exception), TaskContinuationOptions.OnlyOnFaulted);
        tasks.Add(task);
    }

    //last task calls onComplete
    tasks[actions.Length - 1].ContinueWith(t => onComplete(), TaskContinuationOptions.OnlyOnRanToCompletion);

    //wire all tasks to execute the next one, except of course, the last task
    for (int i = 0; i <= actions.Length - 2; i++)
    {
        var nextTask = tasks[i + 1];
        tasks[i].ContinueWith(t => nextTask.Start(), TaskContinuationOptions.OnlyOnRanToCompletion);
    }

    tasks[0].Start();
} 
```

它的用法如下：

```
RunAsync(() => Console.WriteLine("All done"),
            ex => Console.WriteLine(ex),
            Foo,
            Bar,
            Fubar); 
```

想法？否决票？:)

（虽然我绝对更喜欢 async/await）

编辑：根据您的评论`Func<Task>`，这将是一个正确的实施吗？

```
public void RunAsync(Action onComplete, Action<Exception> errorHandler, params Func<Task>[] actions)
{
    if (actions.Length == 0)
    {
        //what to do when no actions/tasks provided?
        onComplete();
        return;
    }

    List<Task> tasks = new List<Task>(actions.Length);
    foreach (var action in actions)
    {
        Func<Task> nextActionFunc = action;
        Task task = new Task(() =>
        {
            var nextTask = nextActionFunc();
            nextTask.ContinueWith(t => errorHandler(t.Exception), TaskContinuationOptions.OnlyOnFaulted);
            nextTask.Start();
        });
        tasks.Add(task);
    }

    //last task calls onComplete
    tasks[actions.Length - 1].ContinueWith(t => onComplete(), TaskContinuationOptions.OnlyOnRanToCompletion);

    //wire all tasks to execute the next one, except of course, the last task
    for (int i = 0; i <= actions.Length - 2; i++)
    {
        var nextTask = tasks[i + 1];
        tasks[i].ContinueWith(t => nextTask.Start(), TaskContinuationOptions.OnlyOnRanToCompletion);
    }

    tasks[0].Start();
} 
```

# java - Jasper Report 不断在 Excel 文件中多次打印同一份报告

> ID：14630773
> 
> 赞同：0
> 
> 时间：2013-01-31T16:41:28.977
> 
> 标签：java, excel, jasper-reports

我的 Jasper Report 运行查询并完美地获取数据。数据显示在表格组件中并导出到 Excel 文件。

我的问题是，包含数据的表格组件被打印了多次（大约 20 次）。我不知道为什么会这样。

我对 Jasper Reports 比较陌生（我已经学习了一周），所以我很可能会遗漏一些东西。

以下是jrxml文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="projectbycustomerreport" pageWidth="752" pageHeight="572" orientation="Landscape" whenNoDataType="AllSectionsNoDetail" columnWidth="752" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="476a09b7-7823-4320-aaa0-3721aee471cc">
<property name="ireport.zoom" value="1.0"/>
<property name="ireport.x" value="0"/>
<property name="ireport.y" value="94"/>
<subDataset name="TableDataset" uuid="09d8857b-956c-490e-b34d-72860983bdf9">
    <parameter name="DATE_FROM" class="java.lang.String" isForPrompting="false"/>
    <parameter name="DATE_TO" class="java.lang.String" isForPrompting="false"/>
    <parameter name="MAIN_CUST_NUM" class="java.lang.String" isForPrompting="false"/>
    <parameter name="MAIN_PROJ_NUM" class="java.lang.Integer" isForPrompting="false"/>
    <queryString>
        <![CDATA[SELECT TSDATE, TSCONO, TSCSNO, TSDEPT, TSPRNO, TSPHAS, TSMSNO, TSTASK, ITEM, TSSRNO, TSPSAN, TSWONO, TSSIRN, TSTSKH, TSBILH, TSNBHC, TSNBHI, TSTRFH, TSOTHH, TSTRVT, TSMILE, TSCCNM FROM WeeklyTimesheetTable WHERE((TSDATE BETWEEN CONVERT(date,$P{DATE_FROM}) AND CONVERT(date,$P{DATE_TO})) AND (TSCSNO=$P{MAIN_CUST_NUM}) AND (TSPRNO=$P{MAIN_PROJ_NUM}))]]>
    </queryString>
    <field name="TSDATE" class="java.lang.String"/>
    <field name="TSCONO" class="java.lang.Integer"/>
    <field name="TSCSNO" class="java.lang.String"/>
    <field name="TSDEPT" class="java.lang.String"/>
    <field name="TSPRNO" class="java.lang.Integer"/>
    <field name="TSPHAS" class="java.lang.Integer"/>
    <field name="TSMSNO" class="java.lang.Double"/>
    <field name="TSTASK" class="java.lang.Double"/>
    <field name="ITEM" class="java.lang.String"/>
    <field name="TSSRNO" class="java.lang.String"/>
    <field name="TSPSAN" class="java.lang.String"/>
    <field name="TSWONO" class="java.lang.String"/>
    <field name="TSSIRN" class="java.lang.String"/>
    <field name="TSTSKH" class="java.lang.Double"/>
    <field name="TSBILH" class="java.lang.Double"/>
    <field name="TSNBHC" class="java.lang.Double"/>
    <field name="TSNBHI" class="java.lang.Double"/>
    <field name="TSTRFH" class="java.lang.Double"/>
    <field name="TSOTHH" class="java.lang.Double"/>
    <field name="TSTRVT" class="java.lang.Double"/>
    <field name="TSMILE" class="java.lang.Double"/>
    <field name="TSCCNM" class="java.lang.String"/>
    <sortField name="TSCONO"/>
    <sortField name="TSDATE"/>
</subDataset>
<parameter name="CUST_ID" class="java.lang.String" isForPrompting="false"/>
<parameter name="PROJ_ID" class="java.lang.String" isForPrompting="false"/>
<parameter name="DATE_FROM" class="java.lang.String" isForPrompting="false"/>
<parameter name="DATE_TO" class="java.lang.String" isForPrompting="false"/>
<parameter name="DATE_GEN" class="java.lang.String" isForPrompting="false"/>
<parameter name="TIME_GEN" class="java.lang.String" isForPrompting="false"/>
<parameter name="MAIN_PROJ_NUM" class="java.lang.Integer" isForPrompting="false"/>
<parameter name="MAIN_CUST_NUM" class="java.lang.String" isForPrompting="false"/>
<queryString>
    <![CDATA[SELECT TSDATE, TSCONO, TSCSNO, TSDEPT, TSPRNO, TSPHAS, TSMSNO, TSTASK, ITEM, TSSRNO, TSPSAN, TSWONO, TSSIRN, TSTSKH, TSBILH, TSNBHC, TSNBHI, TSTRFH, TSOTHH, TSTRVT, TSMILE, TSCCNM FROM WeeklyTimesheetTable WHERE((TSDATE BETWEEN CONVERT(date,$P{DATE_FROM}) AND CONVERT(date,$P{DATE_TO})) AND (TSCSNO=$P{MAIN_CUST_NUM}) AND (TSPRNO=$P{MAIN_PROJ_NUM}))]]>
</queryString>
<field name="TSDATE" class="java.lang.String"/>
<field name="TSCONO" class="java.lang.Integer"/>
<field name="TSCSNO" class="java.lang.String"/>
<field name="TSDEPT" class="java.lang.String"/>
<field name="TSPRNO" class="java.lang.Integer"/>
<field name="TSPHAS" class="java.lang.Integer"/>
<field name="TSMSNO" class="java.lang.Double"/>
<field name="TSTASK" class="java.lang.Double"/>
<field name="ITEM" class="java.lang.String"/>
<field name="TSSRNO" class="java.lang.String"/>
<field name="TSPSAN" class="java.lang.String"/>
<field name="TSWONO" class="java.lang.String"/>
<field name="TSSIRN" class="java.lang.String"/>
<field name="TSTSKH" class="java.lang.Double"/>
<field name="TSBILH" class="java.lang.Double"/>
<field name="TSNBHC" class="java.lang.Double"/>
<field name="TSNBHI" class="java.lang.Double"/>
<field name="TSTRFH" class="java.lang.Double"/>
<field name="TSOTHH" class="java.lang.Double"/>
<field name="TSTRVT" class="java.lang.Double"/>
<field name="TSMILE" class="java.lang.Double"/>
<field name="TSCCNM" class="java.lang.String"/>
<background>
    <band splitType="Stretch"/>
</background>
<title>
    <band height="191" splitType="Stretch">
        <frame>
            <reportElement uuid="a64247fb-c0f0-4ed8-9d4b-d086199fdee5" stretchType="RelativeToBandHeight" mode="Opaque" x="0" y="4" width="752" height="32" forecolor="#000000" backcolor="#3399FF"/>
            <box>
                <topPen lineWidth="1.0" lineStyle="Solid"/>
                <leftPen lineWidth="1.0" lineStyle="Solid"/>
                <bottomPen lineWidth="1.0" lineStyle="Solid"/>
                <rightPen lineWidth="1.0" lineStyle="Solid"/>
            </box>
            <staticText>
                <reportElement uuid="70fc51ae-580a-4a3d-961e-db5a2f8f6991" mode="Transparent" x="0" y="0" width="752" height="32" forecolor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial" size="24" isBold="true"/>
                </textElement>
                <text><![CDATA[Project By Customer Report]]></text>
            </staticText>
        </frame>
        <frame>
            <reportElement uuid="79506db1-e406-4f92-9014-775900b6bba8" mode="Opaque" x="0" y="36" width="752" height="140" backcolor="#CCCCCC"/>
            <box>
                <topPen lineWidth="1.0" lineStyle="Solid"/>
                <leftPen lineWidth="1.0" lineStyle="Solid"/>
                <bottomPen lineWidth="1.0" lineStyle="Solid"/>
                <rightPen lineWidth="1.0" lineStyle="Solid"/>
            </box>
            <staticText>
                <reportElement uuid="6e97c9f7-360a-4476-bdc0-2f68f2c4aa17" x="0" y="5" width="150" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Customer ID & Name:]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="43f905dc-3c9d-42f3-96fd-089b46678c8d" x="0" y="32" width="150" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Project ID & Name:]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="0f6002cb-b314-44c3-8d3b-979512fd0bac" x="0" y="60" width="150" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Period:]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="5699709c-40df-44d4-9c27-df1f48de225b" x="0" y="88" width="150" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Date Generated:]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="c53d2360-f096-41b2-990e-27beb8608b4b" x="0" y="116" width="150" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Time Generated:]]></text>
            </staticText>
            <textField>
                <reportElement uuid="02cf4c1b-53e4-46e9-80bd-9513012ad35e" x="150" y="5" width="602" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{CUST_ID}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="ad104c49-6300-4897-b2bc-7147bdab5bca" x="150" y="32" width="602" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{PROJ_ID}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="c56252dc-3713-4d49-99a8-df6a3ea056a0" x="150" y="88" width="100" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{DATE_GEN}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="cdf7af05-739a-4086-8d38-9fb3e0f45b35" x="150" y="116" width="226" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{TIME_GEN}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="94b1054e-ff88-4b6b-ac53-5e9caa4ed0a3" x="150" y="60" width="100" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{DATE_FROM}]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement uuid="238f5e67-19f3-40c4-a9c2-b2ec1bbcbd32" x="250" y="60" width="26" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[to]]></text>
            </staticText>
            <textField>
                <reportElement uuid="c119a6d7-b873-4d2e-bdbf-4482454b67d6" x="276" y="60" width="100" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{DATE_TO}]]></textFieldExpression>
            </textField>
        </frame>
    </band>
</title>
<detail>
    <band height="572" splitType="Stretch">
        <componentElement>
            <reportElement uuid="0f51d841-bb5b-4775-9b87-03ba695a6971" key="table 2" style="mainTable" x="0" y="0" width="752" height="572"/>
            <jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" whenNoDataType="AllSectionsNoDetail">
                <datasetRun subDataset="TableDataset" uuid="7d17fcfc-0541-4e5e-9a72-86649e38cd06">
                    <datasetParameter name="DATE_FROM">
                        <datasetParameterExpression><![CDATA[$P{DATE_FROM}]]></datasetParameterExpression>
                    </datasetParameter>
                    <datasetParameter name="DATE_TO">
                        <datasetParameterExpression><![CDATA[$P{DATE_TO}]]></datasetParameterExpression>
                    </datasetParameter>
                    <datasetParameter name="MAIN_CUST_NUM">
                        <datasetParameterExpression><![CDATA[$P{MAIN_CUST_NUM}]]></datasetParameterExpression>
                    </datasetParameter>
                    <datasetParameter name="MAIN_PROJ_NUM">
                        <datasetParameterExpression><![CDATA[$P{MAIN_PROJ_NUM}]]></datasetParameterExpression>
                    </datasetParameter>
                    <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
                </datasetRun>
                <jr:column width="90" uuid="d375f5a3-db9e-450d-8ac2-e1a9a6fc18fc">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="4cd206f2-6591-41a5-969c-9466034aac24" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSDATE]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="47c0d3dd-aac2-44ff-a3e5-426cd092fd54" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSDATE}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="587ce56a-9008-43be-b850-dc5397b81c3a">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="73460bc8-c487-4712-8a50-99f624a6bab5" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSCONO]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="ce6aaaad-562e-4e8f-9841-d51759e57035" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSCONO}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="83d4280b-05a0-425e-a49c-f7eccc1880bf">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="834e3ec6-bdb8-46f5-99e5-9953a615f382" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSCSNO]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="584eadf1-ab41-44b6-9453-1c2fe27f329c" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSCSNO}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="076aa9f0-5519-4c17-a0d0-43263458e17f">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="2cbbc5b0-a585-4ee2-8f48-a7c336ca090e" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSDEPT]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="fdf84ff5-50b9-4ec8-b849-0bf4de80a7a7" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSDEPT}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="bc1af644-0380-4abe-bc32-8e130d24ffdf">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="3c0ebe11-a46a-421c-b312-99022544ca2a" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSPRNO]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="6e028901-0e32-4467-9387-79eefb3d54fc" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSPRNO}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="6ba32984-eeba-4b3c-815d-1c041a04bb08">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="7d6f0145-27c8-4f23-9e05-8a2c3714dfc7" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSPHAS]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="757f479d-f624-403f-94b2-a1a7f5deff21" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSPHAS}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="91e6bf63-edaf-4795-8e86-74a1b0c36e82">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="9687b2b4-4c0d-4771-96e5-906481ec8bae" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSMSNO]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="1efbda7d-3eb4-4f9e-9e01-04932ce2c518" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSMSNO}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="a5280cec-20f6-4f6b-978e-e6b9c8791e9a">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="3d4e6cac-734d-4944-9723-f5ecdd9cff8e" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSTASK]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="10c3896f-7c7a-443f-ae9a-fb6834d930a6" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSTASK}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="2780dc1e-fec7-4366-b97d-2bed6556b8ab">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="955b38e6-caf2-4952-9601-97fd88f61a9d" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[ITEM]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="e97694ca-dae7-40df-9b53-8aeeb138e546" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{ITEM}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="02111dc5-db46-4f99-a7c6-b26723cc1847">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="2615591e-7a96-47cf-9ca0-be9a563bf1b4" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSSRNO]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="694bcb7f-f283-4b62-a6ff-649fe4ab72c2" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSSRNO}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="52fc695f-50db-4bea-aef7-ad2cd7c9f108">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="eacf6552-ac9e-4450-9f15-7a237c6cfec8" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSPSAN]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="3a61da59-d709-4776-b805-e3b261f76786" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSPSAN}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="af9ce744-f683-4a3e-a75a-0ce9e58ab288">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="09e9bafe-84b1-4837-9fff-e028570c2aba" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSWONO]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="6cde712a-24db-4099-b602-7f05b87f38ad" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSWONO}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="a2c49ac5-3f2a-4bd3-a4d8-30efd4163beb">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="5d992a75-c66e-49ce-9f2a-09769ac751c1" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSSIRN]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="2dd04d7f-6477-45f7-b013-568d3ad0db26" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSSIRN}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="3484cb89-dd95-49eb-8c85-afc7567ed5bc">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="7bdbb4e4-8fb8-4706-9fc2-5f5b85aac79e" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSTSKH]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="09ec98f7-b2e4-438a-9a8d-7dd51db70cba" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSTSKH}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="ad93e1c3-e4ac-4367-a31e-440eddf776cd">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="3446f9bd-a05b-4574-a9a8-0f59ebdfed4e" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSBILH]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="cbcab416-75b2-4706-bfb1-d34ff6323b18" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSBILH}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="1b4fdc9d-5c59-4443-a7c8-6e5edd51ad75">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="d57feffc-245b-4bc7-85e4-38e8396c837e" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSNBHC]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="89731118-1073-48e3-a321-76a316c28b55" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSNBHC}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="93186b6f-adb3-4861-a503-4e782bf837b2">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="bbefa769-4e52-4f96-bb54-c4d019651d8b" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSNBHI]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="a257d745-f999-4826-b210-b60b7a871343" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSNBHI}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="89f3dea3-c95e-4099-bf3c-b1998a04b08c">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="4c405fd9-1210-40fd-9ca4-c298f81d842b" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSTRFH]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="bf152421-b30e-46c0-aec5-59330e8c39d6" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSTRFH}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="f1584ffe-d3a0-4716-9fd8-8304fb4e612d">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="ee774f5c-e8b1-4c41-8df3-912b68f88970" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSOTHH]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="5324f7a9-8001-4537-b239-a3763aeda84e" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSOTHH}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="e66738ed-9531-446b-a628-412161414eda">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="37b96194-8dde-4a13-a2c9-1ed2a78c8f51" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSTRVT]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="a4b7814a-ae7b-4b7b-adca-eac9bbe9abec" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSTRVT}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="58ce548b-0fc0-4ca7-901f-4aa76fd24a6e">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="9e7d4717-6a96-44cc-940a-7821b306713a" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSMILE]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="e4124f5e-8538-4243-8a35-204e515d02e9" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSMILE}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="7e7203e2-0707-4c7a-9e8e-f3a568387a20">
                    <jr:columnHeader style="table_CH" height="30">
                        <staticText>
                            <reportElement uuid="082ae041-bbd5-42c3-bedd-2efd715bbe54" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSCCNM]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell style="table_TD" height="20">
                        <textField>
                            <reportElement uuid="a4e5d07e-c19c-4760-a0fd-415830172292" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSCCNM}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
            </jr:table>
        </componentElement>
    </band>
</detail>
</jasperReport> 
```

以下是我用来练习的测试Java程序的代码：

```
public class JasperReporter {

private Connection sqlConnection;
private JasperReport report;
private JasperPrint printer;
private JRXlsExporter exporter;

public JasperReporter() {
    com.microsoft.sqlserver.jdbc.SQLServerDataSource ds = new com.microsoft.sqlserver.jdbc.SQLServerDataSource();
    ds.setDatabaseName("TimesheetControlSystem");
    ds.setServerName("192.168.0.88");
    ds.setPortNumber(1433);
    ds.setPassword("*****");
    ds.setUser("tester");
    try {
        if ((this.sqlConnection = ds.getConnection()) == null) {
            javax.swing.JOptionPane.showMessageDialog(null, "Login Failed.", "Connection Status", javax.swing.JOptionPane.ERROR_MESSAGE);
        }
    } catch (SQLServerException ex) {
        Logger.getLogger(JasperReporter.class.getName()).log(Level.SEVERE, null, ex);
    }
}

public void createReport() {
    try {
        this.report = JasperCompileManager.compileReport("F:\\Local Documents\\Programming Projects\\Java\\Testing Projects\\JasperReporter\\projectbycustomerreport.jrxml");
        HashMap param = new HashMap();
        param.put("PROJ_ID", "9000: Internal");
        param.put("CUST_ID", "9055097252: Test");

        param.put("DATE_FROM", "2013-01-01");
        param.put("DATE_TO", "2013-01-28");

        param.put("DATE_GEN", "2013-01-30");
        param.put("TIME_GEN", "1:28 PM");

        param.put("MAIN_CUST_NUM", "1036066254");
        param.put("MAIN_PROJ_NUM", new Integer(9000));

        this.printer = JasperFillManager.fillReport(report, param, this.sqlConnection);

        this.exporter = new JRXlsExporter();
        this.exporter.setParameter(JRXlsExporterParameter.JASPER_PRINT, this.printer);
        this.exporter.setParameter(JRXlsExporterParameter.OUTPUT_FILE, new File("F:\\Local Documents\\Programming Projects\\Java\\Testing Projects\\JasperReporter\\jasperxls.xls"));
        this.exporter.setParameter(JRXlsExporterParameter.IS_DETECT_CELL_TYPE, Boolean.TRUE);
        this.exporter.setParameter(JRXlsExporterParameter.IS_WHITE_PAGE_BACKGROUND, Boolean.FALSE);
        this.exporter.setParameter(JRXlsExporterParameter.IS_REMOVE_EMPTY_SPACE_BETWEEN_ROWS, Boolean.TRUE);
        this.exporter.exportReport();
    } catch (JRException ex) {
        Logger.getLogger(JasperReporter.class.getName()).log(Level.SEVERE, null, ex);
    }
}

public static void main(String[] args) {
    jasperreporter.JasperReporter jr = new jasperreporter.JasperReporter();
    jr.createReport();
}
} 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:48:28.640

You added the table component in the detail band, whereby you also have a main report query. The detail band gets rendered as often as there are rows in the result set for the main report query. Move the table in the summary band of the report, then it will be only rendered once.

```
<summary>
    <band height="138">
        <componentElement>
            <reportElement uuid="0f51d841-bb5b-4775-9b87-03ba695a6971" key="table 2" x="0" y="0" width="752" height="138"/>
            <jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" whenNoDataType="AllSectionsNoDetail">
                <datasetRun subDataset="TableDataset" uuid="7d17fcfc-0541-4e5e-9a72-86649e38cd06">
                    <datasetParameter name="DATE_FROM">
                        <datasetParameterExpression><![CDATA[$P{DATE_FROM}]]></datasetParameterExpression>
                    </datasetParameter>
                    <datasetParameter name="DATE_TO">
                        <datasetParameterExpression><![CDATA[$P{DATE_TO}]]></datasetParameterExpression>
                    </datasetParameter>
                    <datasetParameter name="MAIN_CUST_NUM">
                        <datasetParameterExpression><![CDATA[$P{MAIN_CUST_NUM}]]></datasetParameterExpression>
                    </datasetParameter>
                    <datasetParameter name="MAIN_PROJ_NUM">
                        <datasetParameterExpression><![CDATA[$P{MAIN_PROJ_NUM}]]></datasetParameterExpression>
                    </datasetParameter>
                    <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
                </datasetRun>
                <jr:column width="90" uuid="d375f5a3-db9e-450d-8ac2-e1a9a6fc18fc">
                    <jr:columnHeader height="30" rowSpan="1">
                        <staticText>
                            <reportElement uuid="4cd206f2-6591-41a5-969c-9466034aac24" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSDATE]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell height="20" rowSpan="1">
                        <textField>
                            <reportElement uuid="47c0d3dd-aac2-44ff-a3e5-426cd092fd54" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSDATE}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
                <jr:column width="90" uuid="587ce56a-9008-43be-b850-dc5397b81c3a">
                    <jr:columnHeader height="30" rowSpan="1">
                        <staticText>
                            <reportElement uuid="73460bc8-c487-4712-8a50-99f624a6bab5" x="0" y="0" width="90" height="30"/>
                            <textElement/>
                            <text><![CDATA[TSCONO]]></text>
                        </staticText>
                    </jr:columnHeader>
                    <jr:detailCell height="20" rowSpan="1">
                        <textField>
                            <reportElement uuid="ce6aaaad-562e-4e8f-9841-d51759e57035" x="0" y="0" width="90" height="20"/>
                            <textElement/>
                            <textFieldExpression><![CDATA[$F{TSCONO}]]></textFieldExpression>
                        </textField>
                    </jr:detailCell>
                </jr:column>
            </jr:table>
        </componentElement>
    </band>
</summary> 
```

# html - css div inheriting child's reverse margin

> ID：14630783
> 
> 赞同：0
> 
> 时间：2013-01-31T16:42:05.197
> 
> 标签：html, css

I know there's another question like this but I tried it and the answer didn't work.

I have a `p` with a `div` and I want to be able to use a reverse (negative) margin on the `p`. At the moment it's not effecting the `p` but the containing `div`.

Here's the code :

```
.reset {
    margin-left:4px;
    margin-top: 4px;
    height:50px;
    width:50px;
    background:#FFF;
}
.reset p {
    margin-top:-4px;
    font-size: 38px;
    font-family: sans-serif;
    text-align: center;
} 
```

Thanks in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:00:41.403

I am not sure of your whole solution, but setting the `div` to `relative`, and the `<p>` to `absolute` should get you in the right direction. Here is a [fiddle](http://jsfiddle.net/bfelda/xrdnQ/) to play with.

```
 .reset {
        margin-left:4px;
        margin-top: 4px;
        height:50px;
        width:50px;
        background:Silver;
        position: relative;

    }
    .reset p {
        position:absolute;
        margin-top:-4px;
        font-size: 38px;
        font-family: sans-serif;
        text-align: center;
    } 
```

[UPDATE]

A comment in another answer(now deleted) mentions that negative margins are not valid css. To work with this, change the `.reset p` to:

```
.reset p {
    position:absolute;
    top: -4px; //or whatever you want
    left: 0px;  //or whatever you want
    font-size: 38px;
    font-family: sans-serif;
    text-align: center;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T17:14:05.700

It doesn't work because your `p` is the **first** element of your `div`. As a result, the margin-top of *both* your `p` and `div` are somewhat *merged*.

For example, if you put `margin-top: 20px` on both your `p` *and* your `div`, it will only result in a 20px top margin, not 40px.

The easiest way is to use `position: relative;`:

```
p { position: relative; top: -4px; } 
```

This way, the `p` is still in the usual flow, but you move it 4px up.

# json - 初学者解析 JSON 数据？

> ID：14630786
> 
> 赞同：-2
> 
> 时间：2013-01-31T16:42:09.833
> 
> 标签：json

> **可能重复：**
> [iPhone/iOS JSON 解析教程](https://stackoverflow.com/questions/5813077/iphone-ios-json-parsing-tutorial)

我不知道如何从网站解析 JSON 数据。

```
 {
"weather": {
  "curren_weather": [
    {
      "humidity": "54",
      "pressure": "1011",
      "temp": "50",
      "temp_unit": "f",
      "weather_code": "1",
      "weather_text": "Partly cloudy",
      "wind": [
        {
          "dir": "W",
          "speed": "9",
          "wind_unit": "kph"
        }
      ]
    }
  ], 
```

我想要做的就是将“temp”和“weather_text”变量存储为 NSStrings 以用于标签或我的应用程序中的任何内容......

实际的请求 url 类似于：[http ://www.myweather2.com/developer/forecast.ashx?uac=(access-key)&output=json&query=(latitude,longitude)&temp_unit=f](http://www.myweather2.com/developer/forecast.ashx?uac=(access-key)&output=json&query=(latitude,longitude)&temp_unit=f)

关于如何完成这个的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:49:02.340

I hope that's not the whole thing-- there should be a couple of extra `}`s at the end, or it isn't valid JSON.

Parse JSON using `NSJSONSerialization`'s `JSONObjectWithData:options:error:` method. For the JSON above, it will give you an `NSDictionary`. You can then look up values using `NSDictionary` methods or key-value coding. If you fix the JSON and parse it this way, you'd use a key path like `weather.curren_weather.temp` (is it really `curren_weather` and not **`current_weather`**?) to get the temperature.

# javascript - mp3 的嵌入对象不播放

> ID：14630790
> 
> 赞同：0
> 
> 时间：2013-01-31T16:42:23.183
> 
> 标签：javascript, html, internet-explorer, internet-explorer-8

最近我不得不为 IE8 的 Web 应用程序替换声音通知模块。它是用 Flash 完成的，并且带来了很多问题。

重现这些声音的新方法是通过`embed`标签，如下所示：

```
<embed id='player-msg' hidden='true' autoplay='true' 
       src='../../App_Themes/Operator/sounds/ding.mp3' type='audio/mp3'/> 
```

然后我们尝试这样玩：

```
document.getElementById('player-msg').play(); 
```

它不起作用。或者至少不是在所有计算机中，这已经够糟糕的了。

当我使用自动播放附加嵌入时，它总是有效：

```
var embed = $("<embed id='player-msg' hidden='true' autoplay='true'
    src='../../App_Themes/Operator/sounds/ding.mp3' type='audio/mp3'/>");
$("body").append(embed); 
```

我究竟做错了什么？非常感谢！

# asp.net-mvc - 将日期发布到 Web API 的正确方法？

> ID：14630794
> 
> 赞同：2
> 
> 时间：2013-01-31T16:42:35.810
> 
> 标签：asp.net-mvc, json, parsing, datetime, asp.net-web-api

我正在从 Web API 读取数据并填充表单。当我将其提交回 Web API 时，我收到此错误：

> {"Message":"发生错误。","ExceptionMessage":"类型 'MvcApplication1.Models.ProductSale' 上的属性 'StartDate' 无效。标记为 [Required] 的值类型的属性也必须用 [DataMember] 标记(IsRequired=true)] 被识别为必需。考虑使用 [DataContract] 和属性使用 [DataMember(IsRequired=true)] 来分配声明类型。","ExceptionType":"System.InvalidOperationException","StackTrace": " 在 System.Web.Http.Validation.Validators.ErrorModelValidator.Validate（ModelMetadata 元数据，对象容器）\r\n 在 System.Web.Http.Validation.DefaultBodyModelValidator.ShallowValidate（ModelMetadata 元数据，ValidationContext 验证上下文，对象容器）\r \n
> 在 System.Web.Http.Validation.DefaultBodyModelValidator.ValidateProperties(ModelMetadata metadata, ValidationContext validationContext)\r\n at System.Web.Http.Validation.DefaultBodyModelValidator.ValidateNodeAndChildren(ModelMetadata metadata, ValidationContext validationContext, Object container)\r\n
> at System.Web.Http.ModelBinding.FormatterParameterBinding.<>c_ *DisplayClass1.b* _0（对象模型）\r\n 在 System.Threading.Tasks.TaskHelpersExtensions.<>c_ *DisplayClass49.b* _48()\r\n 在 System。 Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancelToken)"} 1

我的日期以“2013-01-31T16:27:18.503”的形式出现在 Web API 中，并以“2013-01-31T05:00:00.000Z”的形式发回。我可以在发送到 Web API 之前拦截有效负载，并且可以使用[http://momentjs.com](http://momentjs.com)之类的东西来解析它，但我该怎么办？这让我发疯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:36:23.087

`2013-01-31T16:27:18.503`是根据[XML 规范](http://www.w3.org/TR/xmlschema-2/#dateTime)的 XML 日期。

`2013-01-31T05:00:00.000Z`似乎是[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)日期。

在某个地方，这似乎出错了。不知道你的格式化程序，你在日期做什么以及它如何变化是不可能的。

日期格式取决于您的格式化程序。如果您使用 JSON 格式化程序，这可能会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T17:13:48.757

错误信息有答案。您发布的数据没有任何问题。只需将 DataMember(IsRequired=true) 属性放在 ProductSales 的 StartDate 属性上即可使验证满意。

# c++ - c ++模板从接口多重继承

> ID：14630798
> 
> 赞同：0
> 
> 时间：2013-01-31T16:43:02.517
> 
> 标签：c++, templates, virtual-inheritance

所以我有这个问题。

基本上我有一个模板界面：

```
template <typename T, typename U>
class                    Iinterface
{
 public:
 virtual ~Iinterface()
 // A pure methode for the example that gives me the problem
 virtual std::vector<T>        myMethod(T, U) = 0;
}; 
```

暂时没问题。所以我声明了一个将从这个接口继承的类。

```
class                  firstclass : public Iinterface<std::string, int>
{
  // content doesnt matter. The problem is in second class inheritance.
  // here I just put the class so we can see how I inherited in 1st class.
}; 
```

现在是 cpp 文件中的 myMethod 声明。

```
template <>
std::vector<std::string>        firstClass::iInterface<std::string, int>::myMethod(std::string a, int b)
 {
      // methods code
 } 
```

到目前为止，我没有任何问题。在我的第二个类中，我声明了 myMethod 函数，并且类型 T 与返回值相同，它给了我一个编译错误。

```
class                           secondClass : public IInterface<std::vector<std::string>, int>
{
  // class content
}; 
```

目前它可以编译，但是当我像这样声明 myMethod 时：

```
template <>
std::vector<std::string>                     secondClass::Iinterface<std::vector<std::string> a, int n>
{
  // methodes code
} 
```

在这里，我在 std::vector 返回值和方法参数中得到一个错误。我相信这是一个模板冲突，但我真的不知道如何解决这个问题。

第一个错误：

```
28 :template-id ‘_out<>’ for ‘std::vector<std::basic_string<char> > Iio<std::vector<std::basic_string<char> >, int>::_out(std::vector<std::basic_string<char> >, int)’ does not match any template declaration 
```

第二个错误：

```
28 note: saw 1 ‘template<>’, need 2 for specializing a member function template 
```

我仍在学习如何用 C++ 编写代码并快速学习，但有时我会遇到困难并需要一些帮助。我试图这样做的方式是错误的吗？我需要声明第三个类型名来解决这个冲突吗？（我在想它只会产生另一个冲突，因为这两个 typenmaes 是同一类型）。

我知道我正在尝试做的可能不是最好的方法，但我仍在学习。

如果您需要更多详细信息，请不要犹豫，我尝试使示例代码尽可能简单地解释我的问题。

所有的帮助都将非常重要。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T17:21:07.603

似乎第二类函数重载的返回值应该是：

```
std::vector<std::vector<std::string> > 
```

您使用的是什么编译器，gcc 在模板规范中给出了错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T18:08:34.590

我认为作为一般规则，最好将模板化代码保存在 .h 文件中（代码必须在所有翻译单元中都可用，因此如果将其放入 .cpp 文件中，则不要编译它们而是包含它们）。除了代码中的拼写错误（iInterface vs IInterface vs Iinterface 等），您在第二类中的方法应该返回`std::vector<std::vector<std::string> >`. 这是因为您的返回类型是`std::vector<T>`并且您的 T 是`std::vector<std::string>`。下面的代码（代表 interface.h）在 mac os x 上使用 clang++ v 3.3 编译得很好。

```
#include <string>
#include <vector>

template <typename T, typename U>
class Iinterface
{
public:
    virtual ~Iinterface();
    // A pure methode for the example that gives me the problem
    virtual std::vector<T> myMethod(T, U) = 0;
};

class firstclass : public Iinterface<std::string, int>
{
    // content doesnt matter. The problem is in second class inheritance.
    // here I just put the class so we can see how I inherited in 1st class.

    std::vector<std::string> myMethod(std::string a, int b)
    {
        // methods code
        // don't forget to return...
    }

};

class secondClass : public Iinterface<std::vector<std::string>, int>
{
    // class content
    std::vector<std::vector<std::string> > myMethod(std::vector<std::string> a, int n)
    {
        // methodes code
        // don't forget to return...
    }

}; 
```

# php - 如何为bundle创建自己的数据库连接

> ID：14630802
> 
> 赞同：0
> 
> 时间：2013-01-31T16:43:11.483
> 
> 标签：php, symfony, doctrine-orm, entitymanager

长时间的谷歌搜索我仍在寻找理想的解决方案，如何为捆绑包创建第二个数据库连接。我的系统由许多捆绑包组成，但对于其中一个捆绑包，我不仅需要连接到原始数据库，还需要连接到另一个（因此一次连接 2 个）。

我在我的包的 boot() 方法中尝试了这种方式：

```
$connectionFactory = $this->get('doctrine.dbal.connection_factory');
$connection = $connectionFactory->createConnection(array(
    'driver' => 'pdo_mysql',
    'user' => 'my_user',
    'password' => 'my_pass',
    'host' => '',
    'dbname' => 'my_dbname',
));
$this->container->set('doctrine.dbal.new_connection', $connection);
$em = $this->get('doctrine')->getEntityManager('new'); 
```

但它抛出了一个错误： **名为“new”的 Doctrine EntityManager 不存在。**

如果我尝试向我的 config.yml 添加第二个连接并调用它

```
$this->get('doctrine')->getEntityManager('second_connection') 
```

它抛出同样的错误。

**编辑：** 错误已消除。这是由于在教义.dbal.connections 中“映射”参数的错误设置引起的。

现在我想创建到由 bundle 处理的数据库的连接。而 app/config/config.yml 或其他配置不知道这个连接。简单地说，当用户打开新包的页面处理自己的连接和实体管理器时，它将自动创建新连接，您可以访问 2 个或更多数据库。因为首先是来自 app/config/config.yml 的原始文件，其次是捆绑连接。

我尝试在 doctrin.dbal 中的 app/config/config.yml 和在教义.orm 中的实体管理器中预定义 2 个数据库连接。这很好用，但正如我上面写的那样，这对我来说很不方便。

Exixts 另一个明智的解决方案，如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:16:51.713

您可以在 app/config/parameters.ini 文件中配置它，例如[http://symfony.com/doc/2.0/cookbook/doctrine/multiple_entity_managers.html](http://symfony.com/doc/2.0/cookbook/doctrine/multiple_entity_managers.html)

# java - 如何在 JSP 中检索标签的值？

> ID：14630806
> 
> 赞同：1
> 
> 时间：2013-01-31T16:43:24.250
> 
> 标签：java, jsp, label

我有一种情况，我被要求将文本字段更改为标签。我的负责人希望确保用户不会将文本字段与用户可以输入数据并想要标签的字段混淆。我做了必要的改变。但是当我尝试从表单中检索标签的值时，httpservletRequest 请求方法会为该字段返回一个空值。我通过使用具有标签中使用的相同变量并且有效的隐藏文本字段得到了解决方法。

我想知道：有没有办法将标签数据传递给request.getparameter，如果没有，为什么不呢？我怀疑由于它是一个标签，它不会传递任何东西，但想知道为什么不传递。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:49:08.387

You can't get the label values in the `HttpServletRequest` as only form variables are sent by the browser.

Browser can send the values for text fields, hidden fields, etc., but I don't think it going to send the label values(text) with the request.

But I don't understand why would you want to retrieve the label's value in the servlet?

One thing you can do is to have a hidden field for each label and keep a value in it.

But I don't think that's going to be useful.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T17:02:15.893

而不是`<label>`您可以使用`<input type="text" readonly="true" value="foo"/>` Then 您可以为只读输入创建 CSS 样式。

```
.input[readonly] {
  /* styles remove text boxes and format as a label */
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T18:28:16.507

我觉得有趣的隐藏字段的另一种替代方法是使用标签而不是标签，通过这样做，您可以检索 div 标签中的文本值。

# php - 如何在 Google 翻译 API 中增加翻译内容的大小

> ID：14630809
> 
> 赞同：-2
> 
> 时间：2013-01-31T16:43:34.807
> 
> 标签：php, google-translate

我正在使用谷歌翻译 API。

```
function curl($url,$params = array(),$is_coockie_set = false)
{

if(!$is_coockie_set){
/* STEP 1\. let’s create a cookie file */
$ckfile = tempnam ("/tmp", "CURLCOOKIE");

/* STEP 2\. visit the homepage to set the cookie properly */
$ch = curl_init ($url);
curl_setopt ($ch, CURLOPT_COOKIEJAR, $ckfile);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, true);
$output = curl_exec ($ch);
}

$str = ''; $str_arr= array();
foreach($params as $key => $value)
{
$str_arr[] = urlencode($key)."=".urlencode($value);
}
if(!empty($str_arr))
$str = '?'.implode('&',$str_arr);

/* STEP 3\. visit cookiepage.php */

$Url = $url.$str;

$ch = curl_init ($Url);
curl_setopt ($ch, CURLOPT_COOKIEFILE, $ckfile);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, true);

$output = curl_exec ($ch);
return $output;
} 
```

在此 Google API 中，仅翻译了 500 个字符。

```
function Translate($word,$conversion)
{
$word = urlencode($word);
$url = 'http://translate.google.com/translate_a/t?client=t&text='.$word.'&hl=en&sl=en&tl=fr&ie=UTF-8&oe=UTF-8&multires=1&otf=1&ssel=3&tsel=3&sc=1';
} 
```

这是用于翻译内容的功能。我要翻译 500 多个字符。请给我建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T02:12:27.433

见于：[如何在 Google 翻译 API 中增加翻译内容的大小](https://stackoverflow.com/questions/14630809/how-to-increase-translating-content-size-in-google-translator-api)

> > 有免费配额吗？不可以，Google Translate API 仅作为付费服务提供。有关详细信息，请参阅定价和支持。但是，我们确实提供了 Google 网站翻译小工具，它可以免费翻译您的网站。

# jquery - 使用字符串作为上下文的 jQuery 选择器

> ID：14630811
> 
> 赞同：0
> 
> 时间：2013-01-31T16:43:39.103
> 
> 标签：jquery

从[jQuery docs](http://api.jquery.com/jQuery/#jQuery1)中，我可以看到我应该能够使用选择器传递上下文，以将选择器限制为仅在该上下文中匹配。

对于某些字符串上下文，这可以正常工作：

```
>>> jQuery('a', '<div><a id="foo"/><a id="bar"/></div>')
[a#foo, a#bar] 
```

对于其他人来说，不是那么多：

```
>>> jQuery('a', '<html><body><a id="foo"/><a id="bar"/></body></html>')
[] 
```

如果我有一个完整的 HTML 文档作为字符串，并且我想使用 jQuery 从中提取元素，我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:44:45.650

根据 jQuery 文档，选择器上下文可以是“一个 DOM 元素、文档或 jQuery 对象”。

尝试这个。

`jQuery('<html><body><a id="foo"/><a id="bar"/></body></html>').find('a')`

或者

`jQuery('a', jQuery('<html><body><a id="foo"/><a id="bar"/></body></html>'))`

# ios - IOS异步下载

> ID：14630813
> 
> 赞同：1
> 
> 时间：2013-01-31T16:43:48.010
> 
> 标签：ios, asynchronous

我的 iOS 应用程序使用异步下载从 Internet 读取数据。所以我有事件：开始，完成，错误。

问题是关于用户体验的。当数据正在下载时，用户看到活动指示器并且我阻止了所有 UI

问题是阻止 UI 是否是一种好习惯？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:58:22.683

我正在开发一个具有类似用例的应用程序：当我们连接到给定系统时，有一个描述它的 XML 文件，我们必须下载（这是异步完成的）。在下载该 XML 之前，用户无法对所述系统执行任何操作，用户也无法执行任何其他操作（除了打开另一个系统，但这是同样的问题）。在这种情况下，应用程序中会显示一个阻塞微调器。

但是，在某些情况下 XML 不会更新，我们可以检查时间戳。如果我们不需要更新它，我们不需要，并且用户看不到阻塞微调器。

执行此操作的另一个应用程序是 Sonos - 他们在搜索无线网络（使用他们的一个系统）时有一个阻塞微调器，因为没有该连接他们无法做任何事情。

请注意，在这两个示例中，用户仍然可以离开应用程序，只是不能*在*应用程序中执行操作。

基本上这最终是：不要阻止用户，除非他们在请求完成之前什么都不做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:56:43.570

如果您正在异步下载数据，那么几乎没有理由阻止 UI，因为您遇到了解除阻止它的麻烦。

如果有一个特定的功能你必须阻止，因为它需要数据继续。但其他一切都应该像往常一样免费和响应。

# php - 在 cakePHP 2.x 中使用虚拟字段

> ID：14630819
> 
> 赞同：7
> 
> 时间：2013-01-31T16:44:02.347
> 
> 标签：php, mysql, cakephp-2.3

我已经阅读了文档并努力了解该怎么做。另外，我已经阅读了有关 stackoverflow 的问题，但我尝试过的没有任何帮助。

我有一个下拉列表，我想列出公司的所有员工。该列表应显示如下：

```
Name Surname (Job Title) 
```

在我的模型中，我有这段代码：

```
public $virtualFields = array(
    'fullname' => 'CONCAT(HrEmployee.name, " ", HrEmployee.surname, " (", HrEmployee.jobTitle, ")")'
); 
```

在我的控制器中，我有这个：

```
$hrEmployees = $this->User->HrEmployee->find('fullname',
    array(
        'fields' => array('HrEmployee.name','HrEmployee.surname','HrEmployee.jobTitle'),
        'order' => array('HrEmployee.name'=>'ASC','HrEmployee.surname'=>'ASC')
)); 
```

但我得到这个错误：

```
Error: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS `User__fullname` FROM `intraweb_db`.`users` AS `User` WHERE `User`.`hr_emp' at line 1 
```

我必须改变什么？我可以看到它正在构建查询，但它正在改变它非常糟糕......

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T18:00:35.183

酷所以我修好了。部分感谢 Brandon 为我指明了正确的方向。

由于虚拟字段的限制，我不得不做解决方法。

因此，在我的 HrEmployee 模型中，我这样做了：

```
public $virtualFields = array(
    'fullname' => 'CONCAT(HrEmployee.name, " ", HrEmployee.surname, " (", HrEmployee.jobTitle, ")")'
); 
```

在我的用户模型中，我将其更改为：

```
class User extends AppModel {
public function __construct($id = false, $table = null, $ds = null) {
    parent::__construct($id, $table, $ds);
    $this->virtualFields['fullname'] = $this->HrEmployee->virtualFields['fullname'];
} 
```

最后，在我的 UsersController 中，我只是稍微修改了一下：

```
$hrEmployees = $this->User->HrEmployee->find('list',
    array(
        'fields' => array("id","fullname"),
        'order' => array('HrEmployee.name ASC','HrEmployee.surname ASC')
)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T16:49:46.393

蛋糕文档的底部指定了一些虚拟字段的限制。

virtualFields 的实现有一些限制。首先，您不能在关联模型上将 virtualFields 用于条件、顺序或字段数组。这样做通常会导致 SQL 错误，因为字段不会被 ORM 替换。这是因为很难估计可能找到相关模型的深度。

[http://book.cakephp.org/2.0/en/models/virtual-fields.html#limitations-of-virtualfields](http://book.cakephp.org/2.0/en/models/virtual-fields.html#limitations-of-virtualfields)

# linq - 如何使用 LINQ 执行 SELECT DISTINCT

> ID：14630825
> 
> 赞同：1
> 
> 时间：2013-01-31T16:44:33.920
> 
> 标签：linq, select, distinct

如何使用 LINQ 执行此 SQL 查询：`Select Distinct(ColumnB) From TableX`？

我试图做这样的事情但不起作用：

```
var years = _uow.TimeTable.AsQueryable();
years.Select(c => new { c.Year }).GroupBy(c => c.Year);
return years.ToList(); 
```

谢谢你！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:45:38.703

使用[`Distinct`](http://msdn.microsoft.com/en-us/library/bb348456.aspx)() LINQ 方法：

```
return years.Select(c => c.Year).Distinct().ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:46:34.180

见下文。选择和分组后。

```
 return years.Distinct().ToList(); 
```

# ios - “无法检查应用程序包”Xcode

> ID：14630828
> 
> 赞同：10
> 
> 时间：2013-01-31T16:44:45.180
> 
> 标签：ios, xcode

出于某种原因，我在 xcode（第三方 SDK）中导入了一些文件，即使应用程序构建成功，我也会收到此错误：Xcode 错误消息：“无法检查应用程序包”。这是什么意思？该应用程序不能在真实设备上运行，但可以在模拟器 IOS 上运行...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2018-08-14T12:57:13.830

我在使用 Google 登录 SDK 时遇到了这个问题。下面是修复。

1.  BuildPhases -> Embedded Frameworks -> 启用“仅在安装时复制”

[![在此处输入图像描述](../Images/ce0007b46c3d8326a8d5574c2df73da4.png)](https://i.stack.imgur.com/qHb51.png) 我只是发布这个，因为这可能会对某人有所帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-05T13:17:19.060

当我替换 xcode 上的“资源”文件夹时，错误地选择了以下选项。

```
Create folder references for any added folders 
```

但正确的选择应该是，

```
Create groups for any added folders 
```

照顾上述选项是节省时间广告解决上述问题的重要一点。（这是出现此错误的可能性之一）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T17:07:42.113

听起来第三方文件可能包含未经您签名的编译代码。如果是这样，您可以使用[iReSign](https://github.com/maciekish/iReSign)使用您自己的证书为他们签名。您还可以使用命令行：

```
codesign -f -s "iPhone Developer: Aaron Brager (XXXXXXXXXX)" nameOfAppToSign.app 
```

用您自己的身份替换示例身份（您可以[`man codesign`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/codesign.1.html)阅读有关此命令的更多信息）。

您可以通过不包括已编译的代码来规避这一点。可能没有必要 - 您是否包含框架运行不需要的示例应用程序？

如果这个答案没有帮助，提供框架的名称并显示您包含的文件会很有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-10T13:56:28.420

在做了很多愚蠢的事情后，我解决了这个问题，只是做了一个 Product->Clean

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-11-24T08:59:31.003

我遇到了同样的错误。我通过从“嵌入式二进制文件”列表中删除第三方库并添加到“链接的框架和库”中来解决它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-04-25T02:48:23.833

就我而言，我正在使用 Cordova 和 Firebase。从中删除所有 Google 框架`Embed frameworks`（但将它们保留在 下`Linked Binary With Libraries`）解决问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-08-19T22:21:30.850

我在我之前删除的桥接头中导入了一个框架，Xcode 没有给我任何错误，我猜是因为我不再调用该框架了？

脚步：

*   删除未使用/不存在的桥接头框架
*   cmd+shift+k
*   退出 Xcode
*   找到您项目的构建文件夹并丢弃中间件和产品文件夹的内容
*   打开你的项目并运行

这可能有点矫枉过正，但现在可以了。我希望这有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-04T01:07:56.070

我得到了同样的错误。这是在我向我的项目中添加了一个新的空文本文件（以保留一些注释）并将其命名为 Resources 之后。将其重命名为 Resourcesx 解决了该问题，但直到进行清理。我反复证明文件名“资源”是导致错误的充分条件。

这是 [Xcode 错误消息中某人的相同经历：“无法检查应用程序包”](https://stackoverflow.com/questions/13659409/xcode-error-message-could-not-inspect-application-package)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-08-29T17:40:39.207

检查您是否将静态库嵌入到应用程序包中。一些第三方将他们的静态库 SDK 打包成一个动态框架。Xcode 不支持哪个（还没有？）。在这种情况下，您可能会被愚弄并将它们放在“嵌入式​​二进制文件”列表中。静态库不应该在列表中。

要检查它是否是静态库，请使用`file`实用程序。

```
file /path/to/binary/in/Example1.framework/Example1 
```

如果它说它是`ar archive`一个静态库和`dynamically linked shared library`动态库。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-20T15:07:03.817

对我来说，我在我的 podspec 文件中错误地指定了我的资源。在捆绑包中，它包括`.storyboard`和`.storyboardc`文件以及`.xib`和`.nibs`文件等，我将资源更改为仅包含特定的文件扩展名类型，与通用文件相对应`/**/*`

```
s.resource_bundles = {
  s.name => [s.name + '/Assets/**/*.{xib,storyboard,strings,json,otf}']
}
s.resources = [s.name + '/Assets/*.{xcassets}'] 
```

这似乎为我解决了错误

# apache-flex - 全局设置禁用组件的 alpha（MX 和 Spark）

> ID：14630830
> 
> 赞同：1
> 
> 时间：2013-01-31T16:44:56.747
> 
> 标签：apache-flex, flex4, alpha, flex-mx, flex-spark

我希望我的应用程序`UIComponent`在舞台上显示每个残疾人，并在其上显示一定数量的 alpha。

我相信默认值是 0.5，这使得某些字段非常不可读。将其减少到 .3 应该可以解决我的问题。

*   对于`Spark`组件，我知道我可以创建自定义皮肤并编辑`alpha.disabled`. 但我不想仅仅为了 alpha 样式属性而对 30 多个组件执行此操作

*   设置`disabledOverlayAlpha`仅适用于容器，我需要一些实际适用于显示层次结构最低级别的组件的东西。如果我没记错的话，这仅适用于`mx`组件。

为了使所有人`UIComponents`在禁用它们时显示相同数量的 alpha，实用的方法是什么？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:46:23.063

不是最漂亮的解决方案，但它是我能想到的唯一可以满足您对*任何*UIComponent 的要求：

*   在舞台上收听 Event.ADDED，这样您就可以捕捉到添加到 displayList 的每个组件。
*   开始监听事件的“enabledChanged” `target`（这是刚刚添加的组件）。`enabled`UIComponent 在其属性更改时调度“enabledChanged” 。
*   设置`alpha`触发此事件的组件的。
*   当组件从舞台上移除时，不要忘记清理那些事件监听器，否则你会遇到严重的性能问题。
*   对于 Spark 组件，您可能必须以某种方式覆盖皮肤的默认禁用 alpha 值。这可能需要监听皮肤的 StateChangeEvent.CURRENT_STATE_CHANGE。

呸！我希望我忽略了一个更简单的选择。否则我可能只是去创建所有的 Spark 皮肤，也许为禁用的 alpha 值添加一个额外的样式，以便您将来可以全局设置它。

# api - RESTful API，放置授权密钥的位置

> ID：14630832
> 
> 赞同：3
> 
> 时间：2013-01-31T16:45:00.003
> 
> 标签：api, security, rest, authentication, api-key

我正在 Laravel 框架上构建一个用于便携式设备的 api。我已经阅读了大量关于如何正确保护数据和传输的文章。

这些是我为确保安全而采取的措施：

1.  将数据发送到`https`域`TLS`
2.  每个设备的唯一 API 密钥
3.  不时再生的独特图币。
4.  takeen 用于加密数据，使用`hmac-sha1`

所以我得到了2个问题：

*   我应该在像这样的标头中发送 API 密钥集`X-Authorization`吗？或者将其添加到加密数据中的所有 POST/GET/PUT/DELETE 中`hmac-sha1`？
*   上面提到的两种方法有什么大的区别吗？

我主要基于本教程：[http](http://www.thebuzzmedia.com/designing-a-secure-rest-api-without-oauth-authentication/) ://www.thebuzzmedia.com/designing-a-secure-rest-api-without-oauth-authentication/以及与 SO 问题相关的其他问题

PS如果有什么你认为我可以改进的地方，请告诉我！

# typescript - 如何打开和关闭 TypeScript .min.js 文件生成？

> ID：14630833
> 
> 赞同：0
> 
> 时间：2013-01-31T16:45:02.637
> 
> 标签：typescript, minify

使用 TypeScript Visual Studio 插件，通常保存 .ts 文件会导致在其下方生成 2 个新文件：file.js 和 file.min.js。

有没有办法配置它，以便您可以关闭缩小 js 的生成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-27T10:23:31.600

在最新版本的 Web Essentials 中，TypeScript 支持已被删除（参见：http: [//vswebessentials.com/features/typescript](http://vswebessentials.com/features/typescript)）。我注意到，当我现在添加一个 TypeScript 文件时，我不再获得缩小版本。

这样做的主要原因（根据上面的文章）是 TypeScript 扩展本身将包含许多功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T17:56:18.110

您可以使用 web essential 2012 ；它提出了这种能力

# wpf - 是否可以在包含本地化字符串的 WPF ResourceDictionary (.resx) 中设置多个值（每种语言一个）？

> ID：14630835
> 
> 赞同：1
> 
> 时间：2013-01-31T16:45:06.963
> 
> 标签：wpf, localization, internationalization, resourcedictionary

在阅读了 CodeProject 中非常好的[WPF 全球化教程](http://www.codeproject.com/Articles/31837/Creating-an-Internationalized-Wizard-in-WPF)之后，我计划在我自己的项目中应用相同的技术。

本教程展示了如何为某些默认语言创建`Strings.resx`包含命名字符串，并建议复制整个`.resx`文件，在文件名中添加一些本地化代码，并将字符串翻译成目标语言。

这样，`Strings.resx`将包含一个名为`name_entry_label`value的寄存器`Write your name`，并且同名的寄存器 in`Strings.pt-BR.resx`将具有 value `Escreva seu nome`，依此类推，适用于任何其他语言。

我发现的问题是：如果您在其中一个资源文件中添加一个寄存器，其他的不会更新。他们要求手动控制条目，这是愚蠢的、重复的和容易出错的。

在我看来，最合乎逻辑的方法是拥有一个表资源字典，其中每个名称将包含每列一个值，并且每一列将对应于给定的语言。另一种方式是每个 resx 文件都是“主”文件的视图，这将使视图保持同步。不过，我不知道是否有可能获得这些行为。

非常感谢您对如何获得所描述的行为（不同语言资源之间的记录始终同步）的任何帮助，感谢您的阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T18:45:32.980

您可以执行以下操作之一：

获取一个像 TortoiseMerge 之类的合并工具（TortoiseSVN 附带），将每种语言的 resx 文件与主文件（例如中性语言的 resx 文件）进行比较，并使用该工具在本地化文件中创建缺失的条目。然后您可以在 VS resx 编辑器中编辑本地化文件以添加正确的翻译。

或者：如果 TortoiseMerge 不能完成这项工作，请编写一个小程序，使用 XPath 在主 resx 中查找资源元素，将它们映射到不同语言文件中的对应项，然后复制缺少的那些。这样，您甚至可以清空文本，以便让您稍后需要编辑的条目突出显示。由于 resx 文件的命名约定非常严格，您可以将其作为批处理程序并将其作为外部工具添加到 VS 的工具菜单中。

或者：创建一个主 XML 文件，其中包含每个条目的元素和每种语言的子元素，以便将原始术语及其翻译组合在一起。然后，使用 XSLT 为每种语言创建 resx 文件。

或者：在数据库中创建一个包含键、语言和翻译列的表，并使用 SQL 为本地化语言中缺少的键创建空条目，然后从表中生成 resx 文件。您甚至可以直接使用这样的表格进行本地化，而根本不使用 resx 文件。

无论如何，我强烈建议不要使用每种语言一列的设计：我们已经在我们的一个应用程序中这样做了，当我们想要添加更多语言时，它会回来并咬我们。我可能会选择带有同步 resx 条目的批处理程序的选项，这对我来说似乎是编程工作和易用性之间的最佳折衷方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T17:46:15.253

我遵循了相同的教程，但遇到了同样的问题……如果您查看解决方案资源管理器，打开 Strings.resx 的节点，您会发现一个名为 Strings.Designer.cs 的自动生成类。

这只是一个静态类，有几个简单的方法可以在您请求公共 name_entry_label 时选择从哪里获取正确的字符串。

我的想法：我将当前语言保存为设置，因此它适用于我的所有应用程序。我可以使用所有翻译的字符串创建我的自定义静态类，并让这些字符串在检索正确的字符串之前检查设置中的文化。就像是：

```
public static string WriteYourName_Label
{ 
    get
        {
          switch(currentLanguage) //currentLanguage should be the definition in the Settings (a string for me), a private field in the static class that gets the culture and returns something useful

             case en-US: return "Write your name";
             case es-ES: return "Escriba su nombre";
             default: return "Escreva seu nome"; //portuguese by default
         }
} 
```

优点：您将所有不同的语言都放在一个文件中，并且每个翻译都在另一个文件中（而不是在单独的文件中）。

问题：你失去了漂亮的“表格”编辑器，它只是代码。如果您添加一种新语言，则必须为所有字符串创建一个新案例（这不是什么大问题，因为无论如何您都必须创建一个新的资源字典）。

我还没有实现它，所以我不能谈论性能（它是一个包含所有内容的静态类，应该会更好），但我没有找到其他好的解决方案（与将所有东西放在一个地方相比并不那么简单）。乍一看，“手动”完成这一切似乎是一场噩梦，但拥有几个不相关的表的替代方案对我来说更加可怕。

我真的希望有人发布一个比我好得多的答案，我会很高兴的。祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T23:49:47.717

只是为了提高知名度，我将在此处发布 hbarck 的链接：

[CodePlex 的 resx 管理器工具](http://resxmanager.codeplex.com)

这是一个非常轻量级和直接的应用程序，可以使用项目的 resx 文件创建 XML，并将它们放入一个漂亮的 Excel 文件中，每种语言都放在一个列中，并为每个子项目的文件提供一个工作表。

警告：在 Excel 中打开文件时，对“仍然打开”对话框说“是”。保存时对“转换”说“不”？对话框（保持 Excel XML 2003 格式，否则您将很难将翻译返回到您的项目中）。

有关说明，请参阅 CodePlex 上的文档。如果您有任何问题，请不要来找我，我只是发布链接：-P

希望这对其他人也有帮助！

# java - 如何从动作类设置itext pdf文件名

> ID：14630836
> 
> 赞同：0
> 
> 时间：2013-01-31T16:45:09.110
> 
> 标签：java, struts2, struts, itext

我正在使用 struts2 并使用 itext 生成 Pdf 文件。但我的 PDF 文件名是静态的。我在 struts.xml 中设置了文件名（代码如下）。

```
 <action name="form12PdfReport" class="plantHR.Form12PdfReport" method="form12PdfReport">
        <interceptor-ref name="myStack" />
         <result name="success" type="stream">
            <param name="contentType">application/pdf</param>
            <param name="inputName">inputStream</param>
            <param name="contentDisposition">filename="form12PdfReport.pdf"</param>
            <param name="bufferSize">1024</param>
        </result>
     </action> 
```

我可以从动作类动态设置 filename="anyFilename" 吗？

提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:58:23.793

当然。

在您的类中，使用其 getter 定义一个私有属性：

```
private String pdfFileName;

public String getPdfFileName(){
   return pdfFileName;
} 
```

然后设置在`execute()`方法中；

而不是

```
<param name="contentDisposition">filename="form12PdfReport.pdf"</param> 
```

写

```
<param name="contentDisposition">filename="${pdfFileName}.pdf"</param> 
```

# opengl - 地形纹理

> ID：14630838
> 
> 赞同：0
> 
> 时间：2013-01-31T16:45:11.203
> 
> 标签：opengl, textures, texture-mapping, texturing

有没有办法以渐变方式混合 2 个纹理？前任。第一个纹理从顶部开始并到达底部，第二个纹理从底部开始并到达顶部。我想让它们像渐变一样不透明，以创建平滑的连接。可能吗？

也许还有其他方法可以创建这样的纹理？问题是我的地形中的高度差异看起来不太好 - 在一个正方形区域中，一个三角形的纹理与另一个不同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:56:21.090

对于每个地形纹理，在地形顶点中存储一个额外的*混合量。*这个混合量只是一个`float`到 范围内的值`0`，`1`其中`0`表示零不透明度，`1`表示纹理完全不透明。

在像素着色器中，您可以使用此数量在基础纹理的采样像素和混合像素之间进行插值。

在这张图片中，您可以看到一个 3*3 的地形，上面有地面纹理和草纹理。数字代表每个顶点的混合量：

![具有混合纹理的地形](../Images/cf76a892ec2b4f5b235c8568acf8005b.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T16:51:13.770

使用着色器。您可以使用两个 sampler2D 纹理，也可以使用一个 sampler2DArray 纹理。GLSL 内置了线性 ( `mix`) 和 Hermite ( `smoothstep`) 插值函数。

# autohotkey - AutoHotKey Mouse down 继续按下一个键，直到鼠标向上

> ID：14630842
> 
> 赞同：-3
> 
> 时间：2013-01-31T16:45:17.820
> 
> 标签：autohotkey, mousedown

我正在尝试制作一个脚本，使我能够继续按下某个键，例如“1”，当我按住鼠标左键超过 0.5 秒时，它将继续直到我释放鼠标左键。

希望有人可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:11:02.393

你可以试试这样的。我使用鼠标中键进行测试。

我注释掉了特定于应用程序的行。

```
SetTitleMatchMode, 2 ; Put at the top of your script.

MButton:: ; Start this script when the Middle Mouse Button is pressed
;ifWinActive, Your Application Name ; Place the application name as in the windows title.
;{
    KeyWait, MButton, T0.5 ; Wait for MButton to be released within 0.5 sec
    if  (ErrorLevel) ; Not released within 0.5 sec.
    {
        Send, {1 Down} ; Press 1 down, will not autorepeat unless placed in a while loop
        KeyWait, MButton ; Wait for Mbutton to be released
        Send, {1 Up} ; Once MButton is released, undo the press 1 down
    }
    else ; If MButton was released within 0.5 sec.
    {
        Click ; press click
    }
;}
;else
;{
;   Click ; perform normal click behaviour when outside of the target application
;}
Return 
```

# jsf - jsf 从 GET 请求中获取键/值参数

> ID：14630845
> 
> 赞同：1
> 
> 时间：2013-01-31T16:45:28.197
> 
> 标签：jsf, javabeans, meta-tags, validation, query-parameters

在我的网络应用程序中，我无法使用单个验证器获取查询参数的键值。

我的网页：

```
 <f:metadata>
        <f:viewParam name="version" value="#{myBean.version}" 
            validator="#{myBean.inputValidator}" />
        <f:viewParam name="mobilemodel" value="#{myBean.mobileModel}" 
            validator="#{myBean.inputValidator}" />
        <f:event listener="#{myBean.preRenderViewEventHandler}"
            type="preRenderView" />
    </f:metadata> 
```

我验证组件的功能：

```
public void inputValidator(FacesContext context, UIComponent component, Object value) throws ValidatorException {
        LOG.debug("Component: " + component);
        LOG.debug("Value: " + value);
    } 
```

我**在**_`UIComponent`

一个很好的解决方案是为每个查询参数设置一个 Validator 函数。有没有办法理解参数的名称？

下一个问题：是否可以跳过所有验证器并将值设置为 myBean？我试过了，但没有设置值`myBean.mobileModel`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T18:39:51.967

可以通过 获取所有组件属性[`UIComponent#getAttributes()`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIComponent.html#getAttributes%28%29)。

所以，应该这样做：

```
String name = (String) component.getAttributes().get("name");
// ... 
```

# x86 - 机器码如何存储在 EXE 文件中？

> ID：14630852
> 
> 赞同：9
> 
> 时间：2013-01-31T16:45:44.227
> 
> 标签：x86, portable-executable, machine-code, instruction-set, opcode

我的问题如下：

1.  Portable Executable 格式（在 Windows/Unix 上）一般与 x86/x64 指令集有何关系？
2.  PE 格式是否存储处理器支持的确切操作码集，还是操作系统转换为匹配 CPU 的更通用格式？
3.  EXE 文件如何指示所需的指令集扩展（如 3DNOW! 或 SSE/MMX？）
4.  操作码在 Windows、Mac 和 unix 等所有平台上是否通用？
5.  英特尔和 AMD 等英特尔 i386 兼容 CPU 芯片使用通用指令集。但我确信 ARM 驱动的 CPU 使用不同的操作码。这些*是非常*不同还是概念相似？寄存器、int/float/double、SIMD 等？

在 .NET、Java 或 Flash 等较新的平台上，指令集是基于堆栈的操作码，JIT 在运行时将其转换为本机格式。习惯了这种格式，我想知道“旧的”本机 EXE 格式是如何执行和格式化的。例如，“寄存器”通常在较新的平台操作码中不可用，因为 JIT 将堆栈命令转换为它认为必要的 16/32 可用 CPU 寄存器。但是在本机格式中，您需要按索引引用寄存器，并确定哪些寄存器可以重用以及多久重用一次。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-12T12:17:04.123

### ARM 操作码与 x86 操作码有很大不同吗？

是的，他们是。您应该假设不同处理器系列的所有指令集完全不同且不兼容。指令集首先定义一种编码，它指定以下一个或多个：

*   指令操作码；
*   寻址方式；
*   操作数大小；
*   地址大小；
*   操作数本身。

编码进一步取决于它可以寻址多少寄存器，是否必须向后兼容，是否必须快速解码，以及指令的复杂程度。

关于复杂性：ARM 指令集要求使用专门的加载/存储指令将所有操作数从内存加载到寄存器并从寄存器存储到内存，而 x86 指令可以将单个内存地址编码为其操作数之一，因此没有单独的加载/存储指令。

然后是指令集本身：不同的处理器会有专门的指令来处理特定的情况。即使两个处理器系列对同一事物（例如一条`add`指令）具有相同的指令，它们的编码也非常不同，并且语义可能略有不同。

如您所见，由于任何 CPU 设计人员都可以决定所有这些因素，这使得不同处理器系列的指令集架构完全不同且不兼容。

### 寄存器、int/float/double 和 SIMD 在不同架构上的概念是否非常不同？

不，它们非常相似。每个现代架构都有寄存器并且可以处理整数，并且大多数可以处理某种大小的 IEEE 754 兼容浮点指令。例如，x86 体系结构具有 80 位浮点值，这些值被截断以适合您知道的 32 位或 64 位浮点值。SIMD 指令背后的想法在所有支持它的架构上也是相同的，但许多不支持它，并且大多数对它们有不同的要求或限制。

### 操作码在 Windows、Mac 和 Unix 等所有平台上是否通用？

给定三个 Intel x86 系统，一个运行 Windows，一个运行 Mac OS X，一个运行 Unix/Linux，那么*是*的，操作码完全相同，因为它们运行在同一个处理器上。但是，每个操作系统都不同。内存分配、图形、设备驱动程序接口和线程等许多方面都需要操作系统特定的代码。因此，您通常无法在 Linux 上运行为 Windows 编译的可执行文件。

### PE 格式是否存储处理器支持的确切操作码集，还是操作系统转换为匹配 CPU 的更通用格式？

不，PE 格式不存储操作码集。如前所述，不同处理器系列的指令集架构差异太大，无法实现这一点。PE 文件通常存储一个特定处理器系列和操作系统系列的机器代码，并且只能在此类处理器和操作系统上运行。

但是有一个例外：.NET 程序集也是 PE 文件，但它们包含不特定于任何处理器或操作系统的通用指令。这样的 PE 文件*可以*在其他系统上“运行”，但不能直接运行。例如， Linux 上的*mono*可以运行这样的 .NET 程序集。

### EXE 文件如何指示所需的指令集扩展（如 3DNOW! 或 SSE/MMX？）

虽然可执行文件可以指示为其构建的指令集（[请参阅 Chris Dodd 的回答](https://stackoverflow.com/a/14631431/146622)），但我不相信可执行文件可以指示所需的扩展。但是，可执行代码在运行时可以检测到此类扩展。例如，x86 指令集有一条`CPUID`指令返回该特定 CPU 支持的所有扩展和功能。可执行文件只会测试它并在处理器不满足要求时中止。

### .NET 与本机代码

您似乎对 .NET 程序集及其指令集（称为 CIL（通用中间语言））有所了解。每条 CIL 指令都遵循特定的编码，并将评估堆栈用于其操作数。CIL 指令集保持非常通用和高级。当它运行（在 Windows 上由`mscoree.dll`，在 Linux 上由`mono`）并调用方法时，即时 (JIT) 编译器将获取该方法的 CIL 指令并将它们编译为机器代码。根据操作系统和处理器系列，编译器必须决定使用哪些机器指令以及如何对其进行编码。编译后的结果存储在内存中的某处。下次调用该方法时，代码会直接跳转到已编译的机器代码，并且可以像本机可执行文件一样高效地执行。

### ARM 指令是如何编码的？

我从未使用过 ARM，但通过快速浏览文档，我可以告诉您以下内容。一条 ARM 指令的长度始终为 32 位。有许多特殊的编码（例如，用于分支和协处理器指令），但 ARM 指令的一般格式是这样的：

```
31 28 27 26 25 21 20 16
+---+---+---+---+---+---+---+---+---+---+---+---+- --+---+---+---+--
| 条件 | 0 | 0 |R/I| 操作码 | 小号 | 操作数 1 | ...
+---+---+---+---+---+---+---+---+---+---+---+---+- --+---+---+---+--

                   12 0
  --+---+---+---+---+---+---+---+---+---+---+---+--- +---+---+---+---+
... | 目的地 | 操作数 2 |
  --+---+---+---+---+---+---+---+---+---+---+---+--- +---+---+---+---+

```

这些字段的含义如下：

*   **条件**：当为真时，导致指令被执行的条件。这会查看零、进位、负数和溢出标志。设置为 1110 时，始终执行该指令。
*   **R/I** : 当为 0 时，*操作数 2*为寄存器。为1 时，*操作数 2*为常数值。
*   **操作码**：指令的操作码。
*   **S** : 当为 1 时，根据指令的结果设置零、进位、负数和溢出标志。
*   **Operand1**：用作第一个操作数的寄存器的索引。
*   **Destination**：用作目标操作数的寄存器的索引。
*   **操作数 2**：第二个操作数。当*R/I*为 0 时，寄存器的索引。当*R/I*为 1 时，无符号 8 位常数值。除了其中任何一个之外，操作数 2 中的一些位指示该值是否被移位/循环。

有关更多详细信息，您应该阅读您想了解的特定 ARM 版本的文档。我在这个例子中使用了这个[ARM7TDMI-S 数据表，第 4 章](http://www.ic.unicamp.br/~ranido/mc404/arm/arm-instructionset.pdf)。

请注意，每条 ARM 指令，无论多么简单，都需要 4 个字节进行编码。*由于可能的开销，现代 ARM 处理器允许您使用称为Thumb*的替代 16 位指令集。它不能表达 32 位指令集所能表达的所有东西，但它也只有一半大。

另一方面，x86-64 指令具有可变长度编码，并使用各种修饰符来调整单个指令的行为。如果您想将 ARM 指令与 x86 和 x86-64 指令的编码方式进行比较，您应该阅读我在 OSDev.org 上撰写的[x86-64 指令编码](http://wiki.osdev.org/X86-64_Instruction_Encoding)文章。

* * *

您最初的问题非常广泛。如果你想知道更多，你应该做一些研究，并用你想知道的具体事情创建一个新问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-31T17:15:55.130

PE 文件格式（以及非 Windows 机器上的 ELF/COFF 文件格式）定义了一个出现在文件开头的标题，在这个标题中，有一个“机器”代码。在 PE 文件中，“机器”代码为 2 个字节，规范为各种机器定义了一堆常量：

```
0x1d3   Matsushita AM33
0x8664  AMD x64
0x1c0   ARM little endian   
0x1c4   ARMv7 (or higher) Thumb mode only
0xebc   EFI byte code   
0x14c   Intel 386 or later processors and compatible processors 
0x200   Intel Itanium processor family  
0x9041  Mitsubishi M32R little endian   
0x266   MIPS16  
0x366   MIPS with FPU
0x466   MIPS16 with FPU 
0x1f0   Power PC little endian  
0x1f1   Power PC with floating point support    
0x166   MIPS little endian  
0x1a2   Hitachi SH3 
0x1a3   Hitachi SH3 DSP 
0x1a6   Hitachi SH4 
0x1a8   Hitachi SH5     
0x1c2   ARM or Thumb (“interworking”)   
0x169   MIPS little endian WCE v2 
```

然后，在 PE（或 ELF）文件中有一个或多个包含（二进制）机器代码的“代码”部分。该代码被加载到内存中并由 CPU 直接执行。操作系统或动态链接器/加载器（执行实际加载）知道它在哪台机器上运行，因此它会在尝试加载和执行代码之前检查标头中的“机器”代码以确保它匹配。如果不匹配，可执行文件将被拒绝，因为它无法运行。

# python - 如何从普通的 python 程序中打开一个 pypy 进程？

> ID：14630859
> 
> 赞同：0
> 
> 时间：2013-01-31T16:46:01.840
> 
> 标签：python, subprocess, pypy

我使用 python 运行了一段简单的代码，我想在 pypy 中打开另一个程序（因为这要快得多）。

我还希望能够将字典传递到 pypy 程序中。

我可以使用...打开文件

```
subprocess.Popen(['c:\pypy-2.0-beta1\pypy.exe', os.path.expanduser('Main.py')]) 
```

但我不知道如何传入字典或如何在 pypy 程序中打开特定函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T22:50:58.067

我建议您查看 execnet ( [http://pypi.python.org/pypi/execnet](http://pypi.python.org/pypi/execnet) )，这是一个非常酷的库来做这种事情。

# jquery - SPServices.SPGetCurrentUser 在 https 环境中导致安全警告

> ID：14630862
> 
> 赞同：2
> 
> 时间：2013-01-31T16:46:10.517
> 
> 标签：jquery, sharepoint, spservices

我正在使用 SPServices.SPGetCurrentUser 来获取当前登录的用户，然后确定他们所在的组，最后根据该确定禁用一个字段。它有效，但有一个大问题。这是一个仅限 SP 2010 Foundation Intranet 的环境，它是安全的 (SSL)。因此，访问我们网站的唯一方法是通过`https://internalurl`.

我以前从未遇到过这个问题，使用 SPServices，但是使用此代码，我收到了 IE 安全警告：“您只想查看安全传送的网页内容吗？”

通过一次注释掉一行，我确定 SPServices.SPGetCurrentUser 行是导致警告的原因。我想这与它如何/在哪里寻找这些信息有关？

我的问题是，有没有办法绕过这个警告？以下是我目前发现的解决方案，其中没有一个真正适用于我的场景： 1\. 将站点添加到 IE 受信任站点，或者调整浏览器安全设置。（我们有 3000 多个用户，不想走这条路） 2\. 自定义编码解决方案。（不是一个选项，我们只是无代码。JQuery 和 SPServices 是我们所能做到的） 3\. 不要使用 SSL。（不是一种选择。我们是一家金融机构，甚至像这样的内部 URL 也只能通过 SSL 访问。）

这是代码：

```
<script language="javascript" type="text/javascript" src="/CodeLibrary/jquery.SPServices-0.7.1a.min.js"></script>
<script language="javascript" type="text/javascript">
$(document).ready(function() {
  $().SPServices({  
      operation: "GetGroupCollectionFromUser",  
      userLoginName: $().SPServices.SPGetCurrentUser(),  
      async: false,  
      completefunc: function(xData, Status) { 
        //if current user is not a member of this group...       
        if($(xData.responseXML).find("Group[Name='Change Control - Admins']").length != 1)  
        {  
           //...disable the following fields
           $("textarea[Title='Requirements']").attr("disabled", "disabled");  
        }  
      }  
    });  
});
</script> 
```

有任何想法吗？SPServices.SPGetCurrentUser 等的替代品？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:47:24.790

我能够自己解决这个问题。这就是我所做的...

SPServices.SPGetCurrentUser 引用 /_layouts/ 文件夹中的文件。在 SPServices 代码中，该引用是相对的。无论出于何种原因，SharePoint 都不会自动使用 https 来查找它。它只是使用http ...至少据我所知。所以我所做的是复制 jquery.SPServices-0.7.2.min.js 文件，将其重命名为 jquery.SPServices-0.7.2.min.ssl.js，然后更新所有对 /_layouts/ 文件夹的引用（只有一对），到完整的 https URL。这解决了问题。不再弹出安全警告，代码按预期工作。

希望这对某人有用！

# c++ - 实时更改qt应用程序的qlineedit中的文本

> ID：14630863
> 
> 赞同：1
> 
> 时间：2013-01-31T16:46:11.767
> 
> 标签：c++, qt

我想创建一个 qt 应用程序，其中每 10 秒调用一次函数来更改 qlineedit 中的文本。我是qt编程的新手。请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T18:36:07.443

您想使用[QTimer](http://qt-project.org/doc/qt-4.8/qtimer.html)并将其连接到执行更新的插槽。

这个类会做（注意，我直接在 StackOverflow 中输入了这个，所以可能有编译错误）：

```
class TextUpdater : public QObject {
    public:
        TextUpdater(QLineEdit* lineEdit);
    public slots:
        void updateText();
};

TextUpdater::TextUpdater(QLineEdit* edit)
:QObject(lineEdit), lineEdit(edit)
 // make the line edit the parent so we'll get destroyed
 // when the line edit is destroyed
{
    QTimer* timer = new QTimer(this);
    timer->setSingleShot(false);
    timer->setInterval(10 * 1000); // 10 seconds
    connect(timer, SIGNAL(timeout()), this, SLOT(updateText()));
}

void TextUpdater::updateText()
{
    // Set the text to whatever you want. This is just to show it updating
    lineEdit->setText(QTime::currentTime().toString());
} 
```

您将需要对其进行修改以执行您需要的任何操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:52:15.693

看看[QTimer](http://doc.qt.digia.com/qt/qtimer.html)类。//或者告诉我们更多关于你不知道怎么做的事情。

# python - PyPlot：尝试在子图中生成共享图例，但图例在嵌入循环时无法正确显示。（PDF 后端）

> ID：14630864
> 
> 赞同：1
> 
> 时间：2013-01-31T16:46:12.607
> 
> 标签：python, matplotlib, backend, pie-chart, pdfpages

我刚开始使用 Matplotlib，从 Matlab 切换。我在 Windows 7 上通过 python(x,y) 运行 Spyder。

我写了一个小脚本，它的工作是

*   打开几个包含表格数据的 Excel 电子表格
*   对于每张工作表，生成多个饼图 - 每个饼图汇总 Excel 中的一行数据
*   `PdfPages`使用后端在输出文档中的自己的页面上绘制每组饼图。

由于所有饼图共享相同的图例，我想在每张纸上只显示一个“共享”图例。我找到的解决方案如下所示：[matplotlib - Legend in separate subplot](https://stackoverflow.com/questions/11140311/matplotlib-legend-in-separate-subplot) 将每个饼图放在它自己的`subplot`中，然后在另一个窗格中生成一个“虚拟”饼图，生成一个图例，然后使用`set_visible(False)`.

第一次循环迭代（即第一个 Excel 电子表格和第一页饼图）很好。然而，随后的循环产生了带有文本标签的图例，但*没有*彩色框。示例显示在以下 Imgur 链接中（抱歉，由于我是 Stackoverflow 的新手，所以我还不能发布图像）。[http://i.imgur.com/0ssak1O.png](https://i.imgur.com/0ssak1O.png)

该问题似乎影响了`PdfPages`后端生成的输出，但*不*影响默认的图形后端（`TkAgg`？不确定 Spyder 默认使用哪一个）。`PDFfile.savefig()`您可以通过注释掉和取消注释在下面的精简脚本中看到这一点`plt.show()`。

因此，总而言之，这个问题似乎源于`.set_visible()`跨循环“记住”的方法......但它影响`PdfPages`后端，而不是图形后端。我完全困惑，但希望这篇文章对其他人有意义。任何帮助表示赞赏:-)

```
import xlrd, numpy as np, matplotlib.pyplot as plt
from matplotlib.backends.backend_pdf import PdfPages

PDFfile = PdfPages('output.pdf')

for i in range(4):

        pieData = [
                   [1, 2, 3, 4],
                   [5, 6, 7, 8],
                   [9, 0, 1, 2]]

        pieSliceLabels = ['A', 'B', 'C', 'D']
        pieLabels = ['1', '2', '3']

        # now, generate some pie plots

        plt.figure(0, figsize=(6,2))

        numPies = len(pieLabels)  

        for thisPie in range(numPies):
                ax = plt.subplot(1,4,1+thisPie)
                plt.title(pieLabels[thisPie])                
                fracs = pieData[thisPie]
                plt.pie(fracs)

        # Since all three pie plots share the same data labels, I'd rather just
        # generate a single legend that they all share.
        # The method I used comes from here:
        # https://stackoverflow.com/questions/11140311/matplotlib-legend-in-separate-subplot

        # First, generate a "dummy pie" containing same data as last pie.
        plt.subplot(1,4,4)
        DummyPie = plt.pie(fracs)

        # next, generate a big ol' legend
        plt.legend(pieSliceLabels, loc='center',prop={'size':'small'})

        # finally, hide the pie.
        for Pieces in DummyPie:
                for LittlePiece in Pieces:
                    LittlePiece.set_visible(False)

        # NOW, HERE'S WHERE IT GETS WEIRD...

        # Leave the following line uncommented:
        PDFfile.savefig()
        # ... and a PDF is generated where the legend colors are shown
        # properly on the first page, but not thereafter!

        # On the other hand.... comment out "PDF.savefig()" above, and
        # uncomment the following line:
        # plt.show()
        # ...and the figures will be generated onscreen, WITHOUT the legend
        # problem!!

PDFfile.close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T13:01:52.457

奇怪的是它只显示在`PdfPages`后端，但这是因为你在没有清除它的情况下重复使用同一个图形对象。

最好每次都制作一个新人物。如果您要在 pdf 中包含大量页面，那么只使用一个图形可能更有意义，但每次都清除它（例如`plt.clf()`或`fig.clf()`）。

试着打电话：

```
plt.figure(figsize=(6,2)) 
```

代替：

```
plt.figure(0, figsize=(6,2)) 
```

此外，如果您不希望饼图看起来“被压扁”，请务必将子图的纵横比设置为 1 (`ax.axis('equal')`或`plt.axis('equal')`.

* * *

编辑：这是使用 matplotlib 的 OO 接口的示例。它使其中一些更容易跟踪，imo：

```
import matplotlib.pyplot as plt
from matplotlib.backends.backend_pdf import PdfPages

pie_data = [[1, 2, 3, 4],
            [5, 6, 7, 8],
            [9, 0, 1, 2]]
pie_slice_labels = ['A', 'B', 'C', 'D']
pie_labels = ['1', '2', '3']

PDFfile = PdfPages('output.pdf')

for i in range(4):
    fig, axes = plt.subplots(ncols=len(pie_labels) + 1, figsize=(6,2))

    for ax, data, label in zip(axes, pie_data, pie_labels):
        wedges, labels = ax.pie(data)
        ax.set(title=label, aspect=1)

    # Instead of creating a dummy pie, just use the artists from the last one.
    axes[-1].legend(wedges, pie_slice_labels, loc='center', fontsize='small')
    axes[-1].axis('off')
    # Alternately, you could do something like this to place the legend. If you
    # use this, you should remove the +1 from ncols above. 
    # fig.legend(wedges, pie_slice_labels, loc='center right', fontsize='small')
    # fig.subplots_adjust(right=0.8) # Make room for the legend.

    PDFfile.savefig()

PDFfile.close() 
```

# asp.net-mvc - 如何避免使用 NULL 值进行更新

> ID：14630868
> 
> 赞同：0
> 
> 时间：2013-01-31T16:46:19.907
> 
> 标签：asp.net-mvc, entity-framework, razor, model

全部。MVC 或多或少是新手，所以不确定如何处理这个问题。

我有从数据库表（大约 100 列）生成的数据模型。申请表分为 6-7 个视图。第一个视图创建一条新记录并将其插入数据库。其余视图假设从表单中收集信息并更新创建的记录。

```
 [HttpPost]
    public ActionResult GeneralInfo(ADP.Models.ADPRegistration _registration)
    {
        try
        {

            ADP.Models.IS_WEBEntities _test = new IS_WEBEntities();
            _test.ADPRegistrations.Attach(_registration);
            _test.ObjectStateManager.ChangeObjectState(_registration, System.Data.EntityState.Modified);
            _test.SaveChanges();

            return View("ReferralMethod",_registration);

        }

        catch(Exception er)
        {
            return View();
        }
    } 
```

这是更新我的表的通用代码，它在所有视图中都是相似的。将模型传回视图的原因是为了跨视图保留 ID。

我遇到的问题是，我的实体 _registration 包含所有表字段，因此当发布视图时，仅更新视图中的字段，之前的列正在获取 NULL，因为它们在我的视图中不存在猜测。我似乎也无法枚举数据库优先模型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:42:40.587

您是正确的，当 MVC 在 POSTback 中重构您的模型时，任何不在表单中的字段在您的模型中都将为 NULL。

您的选择是包括隐藏在视图中的字段：

```
@Html.HiddenFor(model => model.SomeValue) 
```

或在发布后更新模型，但在将其传递给您的验证和存储库层之前：

```
ModelState.SetModelValue("Name", new ValueProviderResult("Some string",string.Empty,new CultureInfo("en-US"))); 
```

# c++ - 将应用程序对象传递到较低级别的类

> ID：14630870
> 
> 赞同：0
> 
> 时间：2013-01-31T16:46:22.207
> 
> 标签：c++

我不太确定如何搜索这个问题。

我正在使用以下场景进行嵌入式系统设计。

*   我有一个主要的应用程序类，它需要创建一堆硬件接口，如键盘、显示器、通信端口等……一大堆东西

*   现在我可以在主应用程序中使用所有这些对象，这很棒

*   应用程序类包含一些子类，它可以进入并保留一段时间。一个例子是一个菜单类，它进入并在该类中运行，直到菜单关闭

*   我需要菜单类还与在应用程序级别创建的许多硬件对象进行交互

*   不使用全局变量的最佳方法是什么？这个问题有好的解决方案吗？

我可以将每个对象传递给菜单类，但我不想创建一个有 20 个参数的构造函数。我目前的解决方案是将所有对象放入一个结构中并将该结构传递给子类构造函数。这样他们也可以访问。

这种方法让我感到困扰的部分是我必须在我不喜欢的应用程序之外定义结构。有些东西一直告诉我这不是最好的解决方案。

接受任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:02:25.970

据推测，只有一个键盘 - 因此只有一个“键盘接口对象”，对吧？与显示类似 [好吧，可能有两个显示，但仍然]。

所以我的建议是有一个注册和一个保存注册接口的“容器”，如下所示：

```
class KeyPad
{
 public:
    int getKeyPressed();
};

class Display
{
  public:
     OutputText(std::string msg);
};

... bunch of other stuff ... 

class HardwareRegistry
{
   priviate:
      Keypad  *keypad;
      Display *display;

      static HardwareRegistry *myself; 

   public:
      Keypad*  GetKeypad() { return keypad; }
      Display* GetDisplay() { return display; }
      void RegisterKeypad(Keypad *akeypad) { keypad = akeypad; }
      void RegisterDisplay(Display *adisplay) { display = adisplay; } 

      static HardwareRegistry* GetHwRegistry() 
      { 
         if (!myself) myself = new HardwareRegistry; 
         ASSERT(myself);  // If we don't have a pointer now, panic!
         return myself; 
      }
 }; 
```

然后，您只需要一个[单例模式](http://en.wikipedia.org/wiki/Singleton_pattern)来提供您的 HardwareRegistry，并在您在硬件初始化期间创建设备时注册设备。

当然，如果您支持不同类型的键盘、显示器等，那么您将使用“接口基类”来实现它们，例如，注册表返回 KeypadBase 类型。

# c# - 像这样使用`using`可以吗？

> ID：14630873
> 
> 赞同：6
> 
> 时间：2013-01-31T16:46:25.227
> 
> 标签：c#

> **可能重复：**
> [在 C# 中嵌套 using 语句](https://stackoverflow.com/questions/1329739/nested-using-statements-in-c-sharp)

我非常喜欢`using`C# 中的声明。我发现这个：

```
using (var foo = new ObjectWhichMustBeDisposed())
{
    other code
} 
```

...比这更具可读性：

```
var foo = new ObjectiWhichMustBeDisposed();

try
{
    other code
}
finally
{
    foo.Dispose();
} 
```

它不仅更具可读性，还可以防止在语句之后（即在它被释放之后）意外使用`foo`变量，而在第二个示例中，可以在它被释放之后使用。`using``foo`

但是，一个问题`using`是，如果要创建大量一次性对象，它往往会导致非常嵌套的代码。例如：

```
using (var foo = new ObjectWhichMustBeDisposed())
{
    using (var bar = new ObjectWhichMustBeDisposed())
    {
        other code
    }
} 
```

如果两个对象属于同一类型，则可以将它们组合成一个`using`语句，如下所示：

```
using (var foo = new ObjectWhichMustBeDisposed(),
           bar = new ObjectWhichMustBeDisposed())
{
    other code
} 
```

但是，如果对象不是同一类型，那么这将不起作用。

我的问题是是否可以达到这样的类似目的：

```
using (var foo = new ObjectWhichMustBeDisposed())
using (var bar = new OtherObjectWhichMustBeDisposed())
{
    other code
} 
```

在这种情况下，第一次使用后没有大括号（因此不需要缩进代码）。这编译，我*假设*这就像一个`if`没有大括号的语句一样工作 - 即它将使用下一个语句（`using`在这种情况下是第二个）作为它的“主体”。

谁能确认这是否正确？（[使用语句的描述](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)没有帮助）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T16:48:41.617

是的，您提出的代码

```
using (var foo = new ObjectWhichMustBeDisposed())
using (var bar = new OtherObjectWhichMustBeDisposed())
{
    other code
} 
```

既可以，也很常见。

您不需要在每次*using*之后使用额外的 { } （除了包含*其他代码*的那个，如果*其他代码*不止一个语句），因为每个 using 后面都有一个语句。

```
using (var foo = new ObjectWhichMustBeDisposed())
using (var bar = new OtherObjectWhichMustBeDisposed())
using (var baz = new OtherObjectWhichMustBeDisposed())
using (var quux = new OtherObjectWhichMustBeDisposed())
{
    other code
} 
```

也可以。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T17:07:10.113

查看`using`C# 标准中的语句定义：

> 12.3.3.17 Using 语句
> 对于以下形式的 using 语句 stmt：
> using (resource-acquisition) *embedded-statement*

*嵌入语句*是来自以下的任何内容（参见第 A2.5 项）：

> *嵌入式语句*：
> 块
> 空语句
> 表达式语句
> 选择语句
> 迭代语句
> 跳转语句
> 尝试语句
> 检查语句
> 未检查语句
> 锁定语句
> 使用语句
> 屈服语句

`using`因此，从 C# 标准的角度来看，（块或其他 using 语句）的两种用法是绝对等价的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T16:48:49.563

是的，这是正确的。

```
using (var foo = new ObjectWhichMustBeDisposed())
using (var bar = new OtherObjectWhichMustBeDisposed())
{
    other code
} 
```

所以剩下的就看你了。如果你喜欢这种编码方式，那就去吧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T16:53:56.710

是的，这是正确的；但是，这对您来说可能不是很好的编码风格。

对此进行了长时间的讨论：[为什么省略花括号被认为是一种不好的做法？](https://stackoverflow.com/questions/359732/why-is-it-considered-a-bad-practice-to-omit-curly-braces)在帖子中，OP 特别提到了 using 语句。它可能值得一读。

# python - ndb 和一致性：为什么在没有父级的查询中发生这种行为

> ID：14630886
> 
> 赞同：4
> 
> 时间：2013-01-31T16:47:22.280
> 
> 标签：python, google-app-engine, app-engine-ndb

我正在使用 Python 和 ndb 做一些工作，但不明白为什么。我将发布案例和上面的代码：

# 模型.py

```
class Reference(ndb.Model):
  kind = ndb.StringProperty(required=True)
  created_at = ndb.DateTimeProperty(auto_now_add=True)
  some_id = ndb.StringProperty(indexed=True)
  data = ndb.JsonProperty(default={}) 
```

**这些测试在交互式控制台和 dev_appserver.py 的 --high_replication 选项中运行：**

# 测试 1

```
from models import Reference
from google.appengine.ext import ndb
import random

some_id = str(random.randint(1, 100000000000000))
key_id = str(random.randint(1, 100000000000000))

Reference(id=key_id, some_id=some_id, kind='user').put()
print Reference.query(Reference.some_id == some_id, Reference.kind == 'user').get()

# output:
# >> None 
```

为什么 ？？？？？现在，让我们在打印之前添加一个 sleep(1)：

## 测试 2

```
from models import Reference
from google.appengine.ext import ndb
import random
from time import sleep

some_id = str(random.randint(1, 100000000000000))
key_id = str(random.randint(1, 100000000000000))

Reference(id=key_id, some_id=some_id, kind='user').put()
sleep(1)
print Reference.query(Reference.some_id == some_id, Reference.kind == 'user').get()

# output:
# >> Reference(key=Key('Reference', '99579233467078'), createdAt=datetime.datetime(2013, 1, 31, 16, 24, 46, 383100), data={}, kind=u'user', some_id=u'25000975872388') 
```

K，假设它正在模拟将文档传播到所有 Google 表格的时间，我永远不会在我的代码中休眠。现在，让我们移除睡眠并添加一个父母！

# 测试 3

```
from models import Reference
from google.appengine.ext import ndb
import random
from time import sleep

some_id = str(random.randint(1, 100000000000000))
key_id = str(random.randint(1, 100000000000000))

Reference(id='father', kind='father').put()

Reference(parent=ndb.Key(Reference, 'father'), id=key_id, some_id_id=some_id, kind='user').put()
print Reference.query(Reference.some_id == some_id, Reference.kind == 'user', ancestor=ndb.Key(Reference, 'father')).get()

# output:
# >> Reference(key=Key('Reference', '46174672092602'), createdAt=datetime.datetime(2013, 1, 31, 16, 24, 46, 383100), data={}, kind=u'user', some_id=u'55143106000841') 
```

现在这很混乱！只需设置一个父母并给我强大的一致性！为什么 ？如果需要提供强一致性，为什么在默认情况下将所有文档插入数据存储区时不让所有文档具有相同的父级？也许我做错了，有办法做得更好。请有人指导我！

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T19:20:27.473

祖先查询在同一个实体组中运行（因此在物理上接近）并且是高度一致的。

在测试 1 中，HRD 可能看不到 put()，因为由于它的分布式特性，它最终是一致的。

在测试 2 中，HRD 有足够的时间变得一致，因此您可以在查询中看到实体。

在测试 3 中，您将它放在同一个实体组中，因此它具有很强的一致性。

**问**：为什么不将所有东西都放在同一个实体组中？
**答**：GAE 无法分发海量数据集，除非有一堆实体组（然后他们可以将它们推送到大量不同的服务器）。实体组应该与您需要的一样大，而不是更大（G 有时使用将用户“消息”放在用户对象下的示例）。此外，由于写入实体组的成员会锁定整个组，因此您面临写入速度限制（如果我记得的话，例如 1 写入/秒，Alfred 对此进行了讨论）。

**问**：我的 get() 没有得到对象，不应该吗？
**A** : 不，只有按键获取是强一致的，你做了一个 query().get() ，它实际上只是 LIMIT 1 的简写。

# html - 从 textarea 中删除 Html 标签

> ID：14630887
> 
> 赞同：1
> 
> 时间：2013-01-31T16:47:29.500
> 
> 标签：html, tags, textarea

有没有办法删除或不允许将 Html 标签放在 textarea 中？

我有一个表单，可以发送带有文本区域的电子邮件，用户可以在其中发表评论。

但是我遇到了一些垃圾邮件发送者，他们将 html 代码放在 textarea 中，当发送邮件时，这些代码会显示为 html 形式。

我怎么能说服呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:48:16.220

1.  采用[`strip_tags()`](http://www.php.net/manual/en/function.strip-tags.php)
2.  使用[HTML Purifier](http://htmlpurifier.org/)（推荐）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:52:52.660

听起来您正在接受应该是文本的输入，但将其视为 HTML（通过将其注入到 HTML 文档中，未更改）。

传递数据[`htmlspecialchars`](http://php.net/htmlspecialchars)以创建输入文本的 HTML 表示（在将其添加到 HTML 文档之前）。

# javascript - 获取除破折号之外的所有内容 - javascript 中的正则表达式

> ID：14630891
> 
> 赞同：2
> 
> 时间：2013-01-31T16:47:47.930
> 
> 标签：javascript, regex

我正在尝试构建我的正则表达式，但我失败了。我试图在单破折号或双破折号之后得到所有东西（你可以[在这里](http://gskinner.com/RegExr/?33k4e)试试）：

```
var regEx = /(?<=[-{1,2}])[^-]\S*/g; 
```

它工作得很好，但即使我们也有 3 个以上的破折号，它也会选择。我尝试过类似`/(?<=^[-{1,2}])[^-]\S*/g`and`/(?<=\b[-{1,2}])[^-]\S*/g`的方法，但它完全崩溃了。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:01:15.480

可惜`javascript` **不**支持`lookbehind`

* * *

您可以将此正则表达式与`multiline`选项一起使用

```
^-{1,2}(?!-)(\S*) 
```

在此之后，您可以使用**第 1 组**访问所需的匹配项。

# javascript - convert a timestamp to UTC (or GMT) time?

> ID：14630894
> 
> 赞同：0
> 
> 时间：2013-01-31T16:47:54.117
> 
> 标签：javascript, mysql

I retrieved a datetime value from a mysql datebase (a 'datetime' column value), and after retrieving it via an ajax call, when I created the Date object, it considered the datetime to be in EST time. But in the DB its stored in GMT time. How can I get javascript to consider the value as GMT time?

Here's my code:

```
timestamp = new Date(data[i].startTime);
alert(timestamp.getTime()); 
```

The alert shows the same exact time, but considers it in local time (EST). IE: If data[i].startTime reads as `"2012-11-27 09:05:18"`, then the alert reports `1354025118.` This number of milliseconds though refers to `2012-11-27 09:05:18 GMT-0500` (or `2012-11-27 14:05:18`)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:52:39.970

> 如何让 javascript 将该值视为 GMT 时间？

要使[`Date`构造函数](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)不使用本地（当前用户）时区，请使用带有时区信息的日期时间字符串，例如`"2012-11-27 09:05:18 GMT"`. 然而，很难找到一种可以被每个浏览器可靠解析的格式——[`Date.parse`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/parse)算法是依赖于实现的。更好的是，使用 unix 时间戳，即自[unix epoch](http://en.wikipedia.org/wiki/Unix_time)以来的毫秒数，或者使用正则表达式将字符串分解为各个部分，然后将它们输入[`Date.UTC`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/UTC).

# ruby-on-rails - Paperclip: Product with multiple Attachments

> ID：14630900
> 
> 赞同：0
> 
> 时间：2013-01-31T16:48:17.233
> 
> 标签：ruby-on-rails, amazon-s3, paperclip

I have a Product model that looks like this:

```
class Product < ActiveRecord::Base
  attr_accessible   :name_en, :ean
  has_many   :images, :dependent => :destroy
end 
```

and an Images model that looks like this

```
class Images < ActiveRecord::Base
  attr_accessible :image, :product_id, :source
  has_attached_file :image, :styles => { :medium => "150x150>" },
                                        :storage => :s3,
                                        :s3_credentials => "#{Rails.root}/config/s3.yml",
                                        :bucket => "test",
                                        :path => "/products/:ean/:style.:extension";
  belongs_to :product
end 
```

What is the easiest way to save images from an url to s3 and can I use the :ean value from the Product model for the s3 path?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:24:53.570

使用活动记录回调..... before_save :push_to_s3 或 after_save :push_to_s3

然后您只需定义推送到 s3 功能

# design-patterns - What is LMAX Disruptor Design Pattern?

> ID：14630901
> 
> 赞同：5
> 
> 时间：2013-01-31T16:48:18.027
> 
> 标签：design-patterns, disruptor-pattern

Can anyone tell me what is Disruptor design pattern with simple example ? I will want to know basics of this design pattern.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T16:50:29.640

一个简单的谷歌给了我很多信息，包括Martin Fowler 的[介绍](http://martinfowler.com/articles/lmax.html)

> 在粗略的层面上，您可以将 Disruptor 视为队列的多播图，其中生产者将对象放在其上，这些对象通过单独的下游队列发送给所有消费者以供并行消费。当你往里面看时，你会发现这个队列网络实际上是一个单一的数据结构——一个环形缓冲区。每个生产者和消费者都有一个序列计数器来指示它当前正在处理缓冲区中的哪个槽。每个生产者/消费者写入自己的序列计数器，但可以读取其他的序列计数器。这样，生产者可以读取消费者的计数器，以确保它想要写入的插槽是可用的，而计数器上没有任何锁。类似地，消费者可以通过观察计数器来确保它只在另一个消费者使用完消息后才处理消息。

[GitHub 项目](http://lmax-exchange.github.com/disruptor/)包含Java 代码 + 文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-10T06:55:31.550

我花了几天时间阅读它，并且刚刚开始在架构上掌握它，并掌握这种设计模式出现的原因。

有关如何实现的简单代码示例，请尝试[https://github.com/trevorbernard/disruptor-examples](https://github.com/trevorbernard/disruptor-examples)

要获得包括白皮书链接、源代码和 UML 图的良好描述，您可以尝试从 [http://martinfowler.com/articles/lmax.html开始](http://martinfowler.com/articles/lmax.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-24T00:09:55.637

从[这篇文章](http://www.coralblocks.com/index.php/2014/06/getting-started-with-coralqueue/)：

> 破坏者模式是一个批处理队列，由一个循环数组（即环形缓冲区）支持，其中填充了预先分配的传输对象，它使用*内存屏障*通过序列同步生产者和消费者。

幸运的是，您无需了解破坏者模式的内在细节即可使用它。如果您发现通过代码更容易理解，下面是[CoralQueue的](http://www.coralblocks.com/index.php/category/coralqueue/)*Hello World*，这是一个用于实现中断模式的线程间通信的超低延迟队列。

```
package com.coralblocks.coralqueue.sample.queue;

import com.coralblocks.coralqueue.AtomicQueue;
import com.coralblocks.coralqueue.Queue;
import com.coralblocks.coralqueue.util.Builder;

public class Basics {

    public static void main(String[] args) {

        final Queue<StringBuilder> queue = new AtomicQueue<StringBuilder>(1024, new Builder<StringBuilder>() {
            @Override
            public StringBuilder newInstance() {
                return new StringBuilder(1024);
            }
        });

        Thread producer = new Thread(new Runnable() {

            private final StringBuilder getStringBuilder() {
                StringBuilder sb;
                while((sb = queue.nextToDispatch()) == null) {
                    // queue can be full if the size of the queue
                    // is small and/or the consumer is too slow

                    // busy spin (you can also use a wait strategy instead)
                }
                return sb;
            }

            @Override
            public void run() {

                StringBuilder sb;

                while(true) { // the main loop of the thread

                    // (...) do whatever you have to do here...

                    // and whenever you want to send a message to
                    // the other thread you can just do:
                    sb = getStringBuilder();
                    sb.setLength(0);
                    sb.append("Hello!");
                    queue.flush();

                    // you can also send in batches to increase throughput:
                    sb = getStringBuilder();
                    sb.setLength(0);
                    sb.append("Hi!");

                    sb = getStringBuilder();
                    sb.setLength(0);
                    sb.append("Hi again!");

                    queue.flush(); // dispatch the two messages above...
                }
            }
        }, "Producer");

        Thread consumer = new Thread(new Runnable() {

            @Override
            public void run() {

                while (true) { // the main loop of the thread

                    // (...) do whatever you have to do here...

                    // and whenever you want to check if the producer
                    // has sent a message you just do:

                    long avail;
                    while((avail = queue.availableToPoll()) == 0) {
                        // queue can be empty!
                        // busy spin (you can also use a wait strategy instead)
                    }

                    for(int i = 0; i < avail; i++) {
                        StringBuilder sb = queue.poll();
                        // (...) do whatever you want to do with the data
                        // just don't call toString() to create garbage...
                        // copy byte-by-byte instead...
                    }
                    queue.donePolling();
                }
            }
        }, "Consumer");

        consumer.start();
        producer.start();
    }
} 
```

# python - Python拆分字符串以查找特定内容

> ID：14630905
> 
> 赞同：0
> 
> 时间：2013-01-31T16:48:27.860
> 
> 标签：python, string, split

我正在尝试在 python 中拆分字符串以提取特定部分。我能够在符号之前获得字符串的一部分，`<`但我如何获得之后的位？例如`emailaddress`部分？

```
 >>> s = 'texttexttextblahblah <emailaddress>'
 >>> s = s[:s.find('<')]
 >>> print s 
```

上面的代码给出了输出`texttexttextblahblah `

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T16:51:26.887

```
s = s[s.find('<')+1:-1] 
```

或者

```
s = s.split('<')[1][:-1] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:55:52.710

对于这种情况，cha0site 和 ig0774 的答案非常简单，但它可能会帮助您在不那么简单的时候学习[正则表达式。](http://docs.python.org/2/library/re.html)

```
import re
fullString = 'texttexttextblahblah <emailaddress>'
m = re.match(r'(\S+) <(\S+)>', fullString)
part1 = m.group(1)
part2 = m.group(2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:55:00.077

在这种情况下，使用正则表达式可能更明确一点并不是一个坏主意：

```
import re
match = re.search("""
    (?<=<)  # Make sure the match starts after a <
    [^<>]*  # Match any number of characters except angle brackets""", 
    subject, re.VERBOSE)
if match:
    result = match.group() 
```

# windows - 用于处理文件名的 Windows 批处理脚本

> ID：14630907
> 
> 赞同：0
> 
> 时间：2013-01-31T16:48:28.610
> 
> 标签：windows, batch-file

我想创建简单的批处理脚本来使用 robocopy 将我的文件夹从我的用户配置文件复制到 NAS。我已经编写了脚本，但它不起作用。我有两个文件，一个是脚本，第二个是文本文件，我将在其中放置要复制到 NAS 的文件夹路径。scipt 将使用这个文本文件。以下是代码片段，批处理文件：

```
@echo off

for /f "tokens=*" %%v in (dir.txt) do (
echo:%%v
robocopy %%v h:\ 
) 
```

文本文件 (dir.txt)

```
"%userprofile%\desktop"
"%userprofile%\downloads"
"%userprofile%\My Documents"
"%userprofile%\Documents"
"%userprofile%\Favorites" 
```

批处理脚本无法处理来自变量的文件名。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:00:31.407

正如 CharlesB 建议的那样，我会在 PowerShell 中编写这样的脚本。它比批处理脚本更容易使用。

我认为这个脚本会做你想做的事：

```
cat dirs.txt | ForEach {
    $dirPath = $_ -replace  "%userprofile%", $env:userprofile
    Write-Host $dirPath
    robocopy $dirPath h:\
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:42:13.827

如果这个答案很幼稚，请原谅我，但是您可以更改源文件吗？如果只是这样：

```
\desktop
\downloads
\My Documents
\Documents
\Favorites 
```

你可以使用这个批处理文件：

```
@echo off

for /f "tokens=*" %%v in (dir.txt) do (
echo:"%userprofile%%%v"
robocopy "%userprofile%%%v" h:\ 
) 
```

如果由于某种原因执行命令的用户配置文件不起作用，则可以制作一个批处理程序，该程序会生成初始输入文件，并已拼写出正确的路径。

# extjs - 有几个标签时如何专注于第一个标签

> ID：14630908
> 
> 赞同：3
> 
> 时间：2013-01-31T16:48:34.347
> 
> 标签：extjs, extjs4

```
 var tabs = Ext.widget('tabpanel', {
        renderTo: 'tabs',
        resizeTabs: true,
        enableTabScroll: true,
        width: 600,
        height: 250,
        defaults: {
            autoScroll: true,
            bodyPadding: 10
        },
        items: [{
            title: 'Tab 1003',
            iconCls: 'tabs',
            //ref:'http://www.yahoo.com',
            //hrefTarget:'_self',
            html: '<div style="width:100%; height:100%; background-color:#cccccc;"><iframe src="http://www.w3schools.com" frameborder=0  style="width:100%; height:100%;"></iframe></div>',
            closable: true,
            focusOnToFront  : true
        }],......................... 
```

当有几个标签时，如何专注于第一个标签？我使用focusOnToFront，但它看起来不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:06:50.577

看到你已经在变量中定义了你的 tabpanel `tabs`，如果你想让你的第一个选项卡可见，最简单的方法是：

```
tabs.setActiveTab(0); 
```

如文档中所述[。](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.tab.Panel-method-setActiveTab)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-29T07:10:19.107

添加`activeTab`属性：

```
var tabs = Ext.widget('tabpanel', {  
    activeTab: 0,
    ... 
```

# maven - Deploying with Maven Tomcat plugin failes

> ID：14630910
> 
> 赞同：1
> 
> 时间：2013-01-31T16:48:36.083
> 
> 标签：maven, tomcat

I'm trying to deploy application using tomcat7-maven-plugin with this configuration

```
<plugin>
    <groupId>org.apache.tomcat.maven</groupId>
    <artifactId>tomcat7-maven-plugin</artifactId>
    <version>2.0</version>
    <configuration>
        <url>http://127.0.0.1:8080/manager/text</url>
        <server>TomcatServer</server>
        <path>/Ohta</path>
        <username>tomcat</username>
        <port>8080</port>
        <password>s3cret</password>
    </configuration>
</plugin> 
```

I get the folowing error

```
[ERROR] Failed to execute goal org.codehaus.mojo:tomcat-maven-plugin:1.1:deploy (default-cli) on project ohta: Cannot invoke Tomcat manager: Connection refused: connect -> [Help 1] 
```

As I understand maven tries to use org.codehaus.mojo:tomcat-maven-plugin instead of specified and can't find configuration, but why it is so?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-13T19:33:24.683

这个链接包含一个关于[Maven Tomcat 插件](http://tomcat-configure.blogspot.it/2014/04/tomcat-maven-plugin-tutorial.html)的好教程。使用插件查看从原型创建到部署的整个过程可能很有用。

# android - 我该如何解决这个错误并转换类型？

> ID：14630914
> 
> 赞同：1
> 
> 时间：2013-01-31T16:48:46.000
> 
> 标签：android, compiler-errors, fragment

我是android编程的初学者。我想用片段编写一个程序，我阅读了本教程（[http://www.mysamplecode.com/2012/08/android-fragment-example.html](http://www.mysamplecode.com/2012/08/android-fragment-example.html)）并编写了它，但是当我运行程序时，程序有编译器错误！错误与 add() 和 replace() 函数有关。

我在下面写了 AndroidFragmentActivity 类，请阅读并帮助我。

AndoridFragmentActivity.java：

```
package com.appfragmentarray;

import android.app.Activity;
import android.os.Bundle;
import android.support.v4.app.FragmentTransaction;
import android.support.v4.app.FragmentActivity;
 import android.util.Log;

import com.appfragmentarray.ListFragment.OnURLSelectedListener;

public class AndroidFragmentActivity extends Activity implements OnURLSelectedListener{
     boolean detailPage = false;

 @Override
 public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  Log.v("AndroidFragmentActivity", "onCreate()");
  Log.v("AndroidFragmentsavedInstanceState", savedInstanceState == null ? "true" : "false");

  setContentView(R.layout.activity_main);

  if(savedInstanceState == null) {
   android.app.FragmentTransaction ft = getFragmentManager().beginTransaction();
   ListFragment listFragment = new ListFragment();
   ft.add(R.id.displayList, listFragment, "List_Fragment");
   ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
   ft.commit();
  }

  if(findViewById(R.id.displayDetail) != null){
   detailPage = true;
   getFragmentManager().popBackStack();

   DetailFragment detailFragment = (DetailFragment) getFragmentManager().findFragmentById(R.id.displayDetail);
   if(detailFragment == null){
    android.app.FragmentTransaction ft = getFragmentManager().beginTransaction();
    detailFragment = new DetailFragment();
    ft.replace(R.id.displayDetail, detailFragment, "Detail_Fragment1");
    ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
    ft.commit();
   }
  }

 }

 public void onURLSelected(String URL) {
  Log.v("AndroidFragmentActivity",URL);

  if(detailPage){
   DetailFragment detailFragment = (DetailFragment)
   getFragmentManager().findFragmentById(R.id.displayDetail);
   detailFragment.updateURLContent(URL);
  }
  else{
   DetailFragment detailFragment = new DetailFragment();
   detailFragment.setURLContent(URL);
   android.app.FragmentTransaction ft = getFragmentManager().beginTransaction();
   ft.replace(R.id.displayList, detailFragment, "Detail_Fragment2");
   ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
   ft.addToBackStack(null);
   ft.commit();
  }
 }

  } 
```

错误是：

> 无法从 Fragment 转换为 DetailFragment
> 
> FragmentTransaction 类型中的方法 add(int, Fragment, String) 不适用于参数 (int, ListFragment, String)
> 
> FragmentTransaction 类型中的方法 replace(int, Fragment, String) 不适用于参数 (int, DetailFragment, String)

我该如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T16:56:38.767

您可能混淆了[兼容性 Fragment](http://developer.android.com/reference/android/support/v4/app/package-summary.html)和正常的 3.0+ [Fragment](http://developer.android.com/reference/android/app/Fragment.html)类。

如果要使用兼容包：

使`AndroidFragmentActivity`扩展`FragmentActivity`

改变

```
android.app.FragmentTransaction ft = getFragmentManager().beginTransaction(); 
```

到

```
FragmentTransaction ft = getSupportFragmentManager().beginTransaction(); 
```

并确保所有调用`getFragmentManager()`都是`getSupportFragmentManager()`

确保您的 Fragments 扩展自`android.support.v4.app.Fragment`而不是`android.app.Fragment`

**或者**

如果你想使用普通的 Fragment，去掉所有的`support.v4`导入，并确保你的 Fragments 可以使用`android.app.Fragment`，这是 non-comptability Fragment。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T17:00:21.820

看起来您正在将支持库 (v4) 片段与本机片段混合。确保您的所有片段和相关组件都使用 v4。例如，您的活动应该是扩展`FragmentActivity`而不是`Activity`. 确保您`ListFragment`也`DetailFragment`使用 v4 而不是原生 Fragments。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-20T18:30:47.473

我们应该确定我们使用的是兼容性还是普通片段，无论是 android.support.v4.app.* 还是 android.app.*

我正在使用`android.support.v4.app.*` 和

```
FragmentManager fragmentManager = getSupportFragmentManager();
FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction(); 
```

它对我很有效..

# javascript - Javascript not being called onclick

> ID：14630916
> 
> 赞同：-1
> 
> 时间：2013-01-31T16:48:49.587
> 
> 标签：javascript, google-maps, google-maps-api-3

i am new in Javasricpt and i am developing an application using Google Maps API. I'm trying to call a javascript function from onclick event but is not being called. Please if anyone see any errors or something i am missing let me know, I will appreciated. Below is my code.

This is javascript code:

```
 <script>
var directionsDisplay;
var directionsService = new google.maps.DirectionsService();
var map;
var Center=new google.maps.LatLng(18.210885,-67.140884);

function initialize() {
  directionsDisplay = new google.maps.DirectionsRenderer();
  var properties = {
    center:Center,
    zoom:18,
    mapTypeId:google.maps.MapTypeId.SATELLITE
  };
  map=new google.maps.Map(document.getElementById("map"), properties);
  directionsDisplay.setMap(map);
  }
function makeRoute() {
    var start = new google.maps.LatLng(18.210885,-67.140884);
    var end =new google.maps.LatLng(18.2098150,-67.1418260);
    var request = {
      origin:start,
      destination:end,
      travelMode: google.maps.TravelMode.WALKING
      };

    directionsService.route(request, function(result, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      directionsDisplay.setDirections(result);
    } else { alert("couldn't get directions:"+status); }
    });
}

</script> 
```

This is my form:

```
 <form method="post" action="">
          <table border="0px" style="border-radius:5px; border-color: #888888; background-color: #FFFFFF; box-shadow: 5px 5px 5px #888888;"><tr>
          <td><b>Get directions:</b></font><br/></td>
          </tr><tr><td align="right">Building:</td><td>
            <select name="building">
              <option value="#" default >Select</option>
              <option value="monzon">Monzon</option>
            </select></td></tr><tr>
          <td align="right">Room:</td>
          <td><input type="text" name="room" placeholder="eg. 208B / CH 116" ></td>
          </tr><tr><td></td>
          <td align="right" ><input id="submit" type="submit" value="submit" onclick="makeRoute()"></td></tr></table>
        </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:04:42.147

[工作示例](http://www.geocodezip.com/v3_simpleMap_directionsForm.asp)

您需要在此处返回 false：

```
<td align="right" ><input id="submit" type="submit" value="submit" onclick="makeRoute(); return false;"></td></tr></table> 
```

防止页面重新加载并显示空地图。

# c++ - 通过引用遍历节点的惯用方式

> ID：14630917
> 
> 赞同：3
> 
> 时间：2013-01-31T16:48:52.780
> 
> 标签：c++, yaml-cpp

从一个字符串开始，该字符串表示我要从中检索数据的节点的路径，例如“abc”。目前，我用来横穿节点层次结构以到达该节点的代码看起来像这样（可能无法编译，但你明白了）：

```
string keyPath("a.b.c");
vector<string> keyPieces(split(keyPath, "."));

const YAML::Node *currNode = &rootNode;
for_each(begin(keyPieces), end(keyPieces), [&](const string &key)
{
    // for simplicity, ignore indexing on a possible scalar node
    // and using a string index on a sequence node
    if ((*currNode)[key])
    {
        currNode = &((*currNode)[key]);
    }
});

// assuming a valid path, currNode should be pointing at the node
// described in the path (i.e. currNode is pointing at the "c" node) 
```

上面的代码似乎可以正常工作，但我想知道是否有更好的方法来进行节点横向分配。使用直接节点分配 ( `currNode = currNode[key]`)，而不是 () 的指针/地址`currNode = &((*currNode)[key])`，似乎最终会在节点之间创建引用，而不是从一个节点遍历到下一个节点。

是否有“更清洁”或更惯用的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T18:45:30.617

现在没有办法做到这一点（这是一个我没有想到的用例），但这是个好主意。我提交了一个错误（[http://code.google.com/p/yaml-cpp/issues/detail?id=189](http://code.google.com/p/yaml-cpp/issues/detail?id=189)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-12T03:07:01.593

我在做类似的事情，发现这个功能是前一段时间添加的，称为`Node::reset()`

所以，

```
string keyPath("a.b.c");
vector<string> keyPieces(split(keyPath, "."));

YAML::Node currNode = rootNode;
for_each(begin(keyPieces), end(keyPieces), [&](const string &key)
{
    if (currNode[key])
    {
        currNode.reset(currNode[key]);
    }
}); 
```

应该按预期工作。

# logging - How do I get the name of the Data Flow Task component that triggered the OnTaskFailed Event?

> ID：14630918
> 
> 赞同：1
> 
> 时间：2013-01-31T16:48:53.003
> 
> 标签：logging, event-handling, ssis, error-logging, dataflowtask

I have a project to implement custom logging in our SSIS packages. I have a Data Flow task that moves data from several tables in one database to the corresponding tables in another database. If the move of Table A from database A to database B fails, then in the OnTaskFailed event I would like to log the name of the Data Flow component to a text file because that name contains the name of the table that failed. I have tried using `System::SourceName` and `System::TaskName`, but they just give me the name of the Control Flow Task (SourceName) and the name of the Script Task itself in the event handler (TaskName).

Is there a way to get the Data Flow Component name?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:30:35.050

执行此操作的唯一方法是将 DFT GUID 绑定到数据库/记录集中的名称，然后在任务失败/成功后进行查找。这并不优雅，但却是唯一的方法。请注意，如果您的对象在包上发生更改，您将不得不在数据库端重新创建关联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T16:31:29.150

看来您有一个 DFT，其中有多个源和相应的目标。

将每个表放在自己的 DFT 中，或者更好地放在自己的 Child 包中怎么样？然后，您可以为每个任务设置一个错误事件处理程序，或者甚至更好地使用一个通用错误处理程序子包。

# iphone - ios How to use a webproxy to load uiwebview

> ID：14630921
> 
> 赞同：0
> 
> 时间：2013-01-31T16:49:00.397
> 
> 标签：iphone, ios, xcode, ipad, uiwebview

Any of you knows how can I load a uiwebview using proxys inside of the app?

```
NSURL *site =[NSURL URLWithString:@"http://mydomain.com/"];
    NSURLRequest *request =[NSURLRequest requestWithURL:site];
    [_webLoad loadRequest:request]; 
```

I'll really appreciate your help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:28:45.577

我喜欢用这个：

[https://github.com/pokeb/ProxyingUIWebView](https://github.com/pokeb/ProxyingUIWebView)

实施起来非常简单，使用起来也很快。看一看。

# c# - How do I check if a service method's parameter type is an output type given the parameter's ParameterInfo?

> ID：14630924
> 
> 赞同：0
> 
> 时间：2013-01-31T16:49:07.470
> 
> 标签：c#, .net, wcf, types, parameters

Given a certain [ParameterInfo](http://msdn.microsoft.com/en-us/library/system.reflection.parameterinfo%28v=vs.110%29.aspx) from the parameter of a service method, I would like to check if this parameter is an output type. Would it be enough to check if its `ParameterType` contains an `&` sign at the end? I've noticed objects like `System.String` become `System.String&` when they are output types, or, is there a better way to check for this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:41:06.053

参数信息 p = ...;

bool isOutParam = (p.Attributes & System.Reflection.ParameterAttributes.Out) == System.Reflection.ParameterAttributes.Out;

# php - 剑道网格。如何在 Grid 的单元格中显示 dataTextField 而不是 dataValueField？

> ID：14630929
> 
> 赞同：0
> 
> 时间：2013-01-31T16:49:17.343
> 
> 标签：php, kendo-ui, kendo-grid

我想为我的 ForigenKey 列显示文本而不是数值。有很多通过比较 ID 来检索 TextMember 的示例，但在我的情况下它们不起作用。我刚开始使用剑道ui，所以不太了解

这是代码：

```
$(document).ready(function () {

 dataSource1 = new kendo.data.DataSource({

        transport: {
              read:  {
               url: "Data/AttendanceCode/GridSelect.php",
                dataType: "json",

                            },

                update: {
                   url: "Data/AttendanceCode/GridUpdate.php",
        dataType: "json",
                        type:"GET"
            },

                  destroy: {
                     url: "Data/AttendanceCode/GridDelete.php",
                      dataType: "json",
          type:"POST"
                            },

                    create: {
                      url: "Data/AttendanceCode/GridInsert.php",
                        dataType: "json",
              type:"POST"
                            },

                        },

                  schema: {
         data: "data",

                       model: {
                          id: "AttendenceID",

                           fields: {
                              AttendenceID : { editable: false, nullable: true },
                              TeacherID: { field: "TeacherID", defaultValue: "EIIT0002" },
                                }
                            }
                        },

                    });

$("#grid").kendoGrid({
           dataSource: dataSource1,

    pageSize: 10,
            pageable: {
                refresh: true,
                pageSizes: true
                    },
                    editable:{ mode : "popup" },
                    height: 400,
        filterable: true,
                    columnMenu: true,
        sortable: true, 
                    reorderable: true,
                    resizable: true,
                    toolbar: ["create"],

                    columns: [
                       { field:"AttendenceID", title: "Attendence ID", width:"130px" },

                       { field: "TeacherID", title:"Teacher", width: "100px" , editor: TeacherDropDownEditor, template: "#=getTeacherName(TeacherID)#" },

                   { command: ["edit", "destroy"], title: "Action", width: "210px" }],

                });

            }); 
```

教师下拉数据源

```
teacher = new kendo.data.DataSource({

       transport: {
         read: {
    url : "Data/Teacher.php",
    dataType: "json" }
               },

    schema: {
    data : "Teacher"
         }

    }); 
```

//教师编辑

```
 function TeacherDropDownEditor(container, options) {
   $('<input data-bind="value:' + options.field + '"/>')
.appendTo(container)
     .kendoDropDownList({         
     dataTextField: "TeacherName",
dataValueField: "Service_NO",
 dataSource: teacher
     });
} 
```

我发现并尝试获取教师姓名的不同方法

1 -

```
 function getTeacherName(value) {

          var text = "";
     $.each(teacher, function () {
           if (this.Service_NO == value) {
            text = this.Name;
             return false;
           }
        });
     return text;
                      } 
```

2 -

```
function getTeacherName(teacherID) {

 for (var idx = 0, length = teacher.length; idx < length; idx++) 
   {
    if (teacher[idx].Service_NO === teacherID) 
       {t = teacher[idx].Name;} 
    }                   
return t; 
    } 
```

3 -

```
function getTeacherName(teacherID) {
      $.each(teacher, function(key, val) {
        if(val.Service_NO == tID){
           t = val.Name;
            }
             });
           return t;
            } 
```

似乎 dataSource（老师）没有任何价值。PHP 代码运行良好。如果您知道我的代码有什么问题，请提供帮助。

谢谢 ！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:53:14.157

你是对的，`teacher`DataSource 没有任何数据，因为你正在定义如何获取数据（这就是你对 DataSource 所做的）但你没有阅读它。

添加：

```
teacher.read(); 
```

用于手动强制读取数据。

**注意：**当您拥有一个 Grid、ListView... 时，这会*神奇地*发生，因为这些小部件会为您执行此操作，但这次，为了显示您的网格，您需要提前阅读它，因为它是从 JavaScript 函数调用的（ KendoUI 网格代码除了名称之外对函数中的内容一无所知`getTeacherName`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-04T18:21:13.197

你应该配置你的领域：

```
{ field: "nu_status", title: 'Status', values: [ { text: "Active", value: 1 }, { text: "Inactive", value: 0 }]}, 
```

# java - 将图像添加到 JFrame

> ID：14630930
> 
> 赞同：1
> 
> 时间：2013-01-31T16:49:20.607
> 
> 标签：java, image, swing, jframe, jlabel

我想向 JFrame 添加一个图像，该`add( )`方法正在生成一个错误，上面写着“找不到符号：方法 add(JLabel)”......我该如何解决这个问题？

** 我还没有`ImageLoading( )`从 main 方法中调用该方法。

```
import javax.swing.*;

public class NetworkingGame {

NetworkingGame(){
    JFrame jfrm = new JFrame("Angry Painters");
    jfrm.setSize(800, 480);
    jfrm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    jfrm.setVisible(true);

}

public void ImageLoading(){
    ImageIcon i = new ImageIcon("angry-painters.jpg");
    JLabel jl = new JLabel(i);
    add(jl); //The error is in this line
}

public static void main(String[] args) throws Exception{
    SwingUtilities.invokeLater(new Runnable(){

        @Override
        public void run(){
            new NetworkingGame();
        }
    });

   }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T16:53:11.080

的可见性`JFrame jfrm`受 的构造函数的限制`NetworkingGame`。所以`add`方法中不存在`NetworkingGame`。使您`JFrame`成为`NetworkingGame`.

```
public class NetworkingGame {
    private JFrame jfrm;

    NetworkingGame(){
        jfrm = new JFrame("Angry Painters");

    ...

        JLabel jl = new JLabel(i);
        jfrm.add(jl); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T16:52:46.357

也许你应该写

```
jfrm.add(jl); 
```

并`jfrm`成为会员。

在你的情况下，你真的打电话给`this.add()`不存在的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T16:53:27.803

您正在调用该`add`方法，就好像它是您的类中的一个实例方法`NetworkingGame` 并且您的类没有任何方法，因此您收到编译器错误，因为编译器在您的类中找不到任何此类名称的方法`NetworkingGame`，所以而是将其添加到 Jframe。

```
NetworkingGame(){
    JFrame jfrm = new JFrame("Angry Painters");
    jfrm.setSize(800, 480);
    jfrm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    jfrm.setVisible(true);
    ImageIcon i = new ImageIcon("angry-painters.jpg");
    JLabel jl = new JLabel(i);
    jfrm.add(jl);
} 
```

# performance - Tools for UI Testing with integrated service

> ID：14630931
> 
> 赞同：1
> 
> 时间：2013-01-31T16:49:25.453
> 
> 标签：performance, jquery-ui, user-interface

What are the tools available for UI independent and integrated testing with Services & UI Performance testing ?

*   Browser specific Tools
*   Performance Specific Tools

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:53:27.353

那里有很多测试框架。你可能想看看这些：

1.  [QUnit](http://qunitjs.com/) - JavaScript 单元测试框架。
2.  [Selenium](http://seleniumhq.org/download/) - 非常适合跨浏览器交互测试

# windows - Windows 命令行 FTP 部署网站

> ID：14630932
> 
> 赞同：1
> 
> 时间：2013-01-31T16:49:29.097
> 
> 标签：windows, command-line, ftp, cmd, powershell-2.0

尝试在我的 CI 服务器上设置构建后脚本，以通过 FTP 将更改推送到我们的 Web 服务器。如何在尽可能少的行中使用 Windows FTP 将文件文件夹推送到我的网络服务器？例如部署文件夹是：

```
c:\deployment\*.* 
```

我如何递归地推送所有文件以在 Web 服务器上替换？

我愿意使用 cmd 或 powershell - 仅限 MS Windows

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T19:27:33.790

Windows 的内置命令行 FTP 客户端没有内置递归。最简单的方法是使用不同的 FTP 客户端。 [NcFTP](http://www.ncftp.com/download/)将满足您的需求。请参阅[ncftpput 的手册页](http://www.ncftpd.com/ncftp/doc/ncftpput.html)。语法基本上如下：

```
cd c:\deployment
ncftpput -u user -p pass -R ftp.ftpserver.com /path/on/ftp/server .\* 
```

或者，如果您的 Web 服务器也运行 ssh 服务，那就`rsync`更好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-21T09:38:09.723

[Fsync 很好](http://www.eternitysoftware.com)，我用了很久。它只允许推送已更改的内容。当然是递归。也排除文件。跟踪客户端（更快）发生了什么变化......最大的唯一缺点：没有 SFTP./ProductList/Fsync.html

# windows - 如何使用 Puppet for windows .lnk 编写模块

> ID：14630933
> 
> 赞同：0
> 
> 时间：2013-01-31T16:49:30.900
> 
> 标签：windows, scripting, module, shortcut, puppet

我正在使用 puppet 管理 Windows 主机，并且想知道如何编辑 .lnk 快捷方式文件中的目标字段以指向新目标，或者实际从绑定的另一个管理器开始。

我知道快捷方式文件在哪里我只是不确定如何使用模块编辑 .lnk 快捷方式属性中的目标字段。如果有人可以提供帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T22:23:14.470

以下文档涉及在 Windows 中管理 .lnk 快捷方式：

[http://docs.puppetlabs.com/pe/2.5/quick_writing.html](http://docs.puppetlabs.com/pe/2.5/quick_writing.html)

# linux - 在bash中将字符串拆分为数组

> ID：14630940
> 
> 赞同：8
> 
> 时间：2013-01-31T16:49:44.870
> 
> 标签：linux, bash, shell, unix

我正在寻找一种方法来将 bash 中的字符串拆分为分隔符字符串，并将这些部分放在一个数组中。

简单案例：

```
#!/bin/bash
b="aaaaa/bbbbb/ddd/ffffff"
echo "simple string: $b"

IFS='/' b_split=($b)
echo ;
echo "split"
for i in ${b_split[@]}
do
    echo "------ new part ------"
    echo "$i"
done 
```

给出输出

```
simple string: aaaaa/bbbbb/ddd/ffffff

split
------ new part ------
aaaaa
------ new part ------
bbbbb
------ new part ------
ddd
------ new part ------
ffffff 
```

更复杂的情况：

```
#!/bin/bash
c=$(echo "AA=A"; echo "B=BB"; echo "======="; echo "C==CC"; echo "DD=D"; echo "======="; echo "EEE"; echo "FF";)
echo "more complex string"
echo "$c";
echo ;
echo "split";

IFS='=======' c_split=($c) ;#    <----    LINE TO BE CHANGED 

for i in ${c_split[@]}
do
    echo "------ new part ------"
    echo "$i"
done 
```

给出输出：

```
more complex string
AA=A
B=BB
=======
C==CC
DD=D
=======
EEE
FF

split
------ new part ------
AA
------ new part ------
A
B
------ new part ------
BB

------ new part ------

------ new part ------

------ new part ------

------ new part ------

------ new part ------

------ new part ------

------ new part ------

C
------ new part ------

------ new part ------
CC
DD
------ new part ------
D

------ new part ------

------ new part ------

------ new part ------

------ new part ------

------ new part ------

------ new part ------

------ new part ------

EEE
FF 
```

我希望第二个输出像

```
------ new part ------
AA=A
B=BB
------ new part ------
C==CC
DD=D
------ new part ------
EEE
FF 
```

即在一个**字符序列上****分割**字符串，而不是一个。我怎样才能做到这一点？

 **我正在寻找一个只会在第二个脚本中修改这一行的答案：

```
IFS='=======' c_split=($c) ;#    <----    LINE TO BE CHANGED 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-09T15:18:16.293

### `IFS`消歧

`IFS`表示*输入字段分隔符*，如*`list of characters that could be used as separators`*。

默认情况下，这设置为 ``\t\n`，这意味着任何数量（大于零）的*空格*、*制表* **和/或** *换行符*都可以是**1** *`separator`*。`

 `所以字符串：

```
 "    blah  foo=bar 
 baz  " 
```

前导和尾随*分隔符*将被忽略，此字符串将仅包含 3 个部分`blah`：`foo=bar`和`baz`。

`IFS`如果您知道字符串中未使用有效的字段分隔符，则可以使用拆分字符串。

```
OIFS="$IFS"
IFS='§'
c=$'AA=A\nB=BB\n=======\nC==CC\nDD=D\n=======\nEEE\nFF'
c_split=(${c//=======/§})
IFS="$OIFS"
printf -- "------ new part ------\n%s\n" "${c_split[@]}"

------ new part ------
AA=A
B=BB

------ new part ------

C==CC
DD=D

------ new part ------

EEE
FF 
```

但这仅在字符串不包含`§`.

您可以使用另一个字符，例如，`IFS=$'\026';c_split=(${c//=======/$'\026'})`但无论如何这可能涉及更多错误。

您可以浏览字符映射以查找不在您的字符串中的字符：

```
myIfs=""
for i in {1..255};do
    printf -v char "$(printf "\\\%03o" $i)"
        [ "$c" == "${c#*$char}" ] && myIfs="$char" && break
  done
if ! [ "$myIFS" ] ;then
    echo no split char found, could not do the job, sorry.
    exit 1
  fi 
```

但我觉得这个解决方案有点矫枉过正。

### 分割空间（或不修改 IFS）

在[bash](/questions/tagged/bash "显示标记为“bash”的问题")下，我们可以使用这个 bashism：

```
b="aaaaa/bbbbb/ddd/ffffff"
b_split=(${b//// }) 
```

实际上，此语法`${varname//`将启动翻译（由 分隔） ，在将其分配给数组**之前**，用空格`/`替换所有出现的。`/``**`b_split`**`

 `**当然，这仍然`IFS`在空格上使用和拆分数组。

这不是最好的方法，但可以用于特定情况。

您甚至可以在拆分之前删除不需要的空格：

```
b='12 34 / 1 3 5 7 / ab'
b1=${b// }
b_split=(${b1//// })
printf "<%s>, " "${b_split[@]}" ;echo
<12>, <34>, <1>, <3>, <5>, <7>, <ab>, 
```

或者交换它们...

```
b1=${b// /§}
b_split=(${b1//// })
printf "<%s>, " "${b_split[@]//§/ }" ;echo
<12 34 >, < 1 3 5 7 >, < ab>, 
```

### 分割线*`strings`*：

所以你*不必*使用`IFS`你的意思，但[bash](/questions/tagged/bash "显示标记为“bash”的问题")确实有很好的功能：

```
#!/bin/bash

c=$'AA=A\nB=BB\n=======\nC==CC\nDD=D\n=======\nEEE\nFF'
echo "more complex string"
echo "$c";
echo ;
echo "split";

mySep='======='
while [ "$c" != "${c#*$mySep}" ];do
    echo "------ new part ------"
    echo "${c%%$mySep*}"
    c="${c#*$mySep}"
  done
echo "------ last part ------"
echo "$c" 
```

让我们看看：

```
more complex string
AA=A
B=BB
=======
C==CC
DD=D
=======
EEE
FF

split
------ new part ------
AA=A
B=BB

------ new part ------

C==CC
DD=D

------ last part ------

EEE
FF 
```

注意：前导和尾随换行符不会被删除。如果需要，您可以：

```
mySep=$'\n=======\n' 
```

而不是简单地`=======`.

或者您可以重写拆分循环以明确地将其保留：

```
mySep=$'======='
while [ "$c" != "${c#*$mySep}" ];do
    echo "------ new part ------"
    part="${c%%$mySep*}"
    part="${part##$'\n'}"
    echo "${part%%$'\n'}"
    c="${c#*$mySep}"
  done
echo "------ last part ------"
c=${c##$'\n'}
echo "${c%%$'\n'}" 
```

无论如何，这符合SO问题所要求的（：和他的样本:)

```
------ new part ------
AA=A
B=BB
------ new part ------
C==CC
DD=D
------ last part ------
EEE
FF 
```

### 最后创建一个*`array`*

```
#!/bin/bash
c=$'AA=A\nB=BB\n=======\nC==CC\nDD=D\n=======\nEEE\nFF'
echo "more complex string"
echo "$c";
echo ;
echo "split";

mySep=$'======='
export -a c_split
while [ "$c" != "${c#*$mySep}" ];do
    part="${c%%$mySep*}"
    part="${part##$'\n'}"
    c_split+=("${part%%$'\n'}")
    c="${c#*$mySep}"
  done
c=${c##$'\n'}
c_split+=("${c%%$'\n'}")

for i in "${c_split[@]}"
do
    echo "------ new part ------"
    echo "$i"
done 
```

做得很好：

```
more complex string
AA=A
B=BB
=======
C==CC
DD=D
=======
EEE
FF

split
------ new part ------
AA=A
B=BB
------ new part ------
C==CC
DD=D
------ new part ------
EEE
FF 
```

### 一些解释：

*   `export -a var`定义`var`为数组并在孩子中共享
*   `${variablename%string*}`，`${variablename%%string*}`导致*变量*名的左侧部分，最多但没有*字符串*。一个`%`意味着*最后一次出现的字符串*和*所有*`%%`的出现。返回完整的*变量*名是未找到*字符串。*
****   `${variablename#*string}`，以相反的方式执行相同的操作：从但不返回*string的**变量*名的最后一部分。一个意味着*第一次出现*，两个人*全部出现*。*`#`*`##`*****

 ***请注意，字符`*`是一个*小丑*，意思是任意数量的任意字符。

该命令`echo "${c%%$'\n'}"`将回显变量**c**但在字符串末尾没有任何数量的换行符。

因此，如果*变量*包含`Hello WorldZorGluBHello youZorGluBI'm happy`，

```
variable="Hello WorldZorGluBHello youZorGluBI'm happy"

$ echo ${variable#*ZorGluB}
Hello youZorGlubI'm happy

$ echo ${variable##*ZorGluB}
I'm happy

$ echo ${variable%ZorGluB*}
Hello WorldZorGluBHello you

$ echo ${variable%%ZorGluB*}
Hello World

$ echo ${variable%%ZorGluB}
Hello WorldZorGluBHello youZorGluBI'm happy

$ echo ${variable%happy}
Hello WorldZorGluBHello youZorGluBI'm

$ echo ${variable##* }
happy 
```

所有这些都在手册页中进行了解释：

```
$ man -Len -Pless\ +/##word bash

$ man -Len -Pless\ +/%%word bash

$ man -Len -Pless\ +/^\\\ *export\\\ .*word bash 
```

### 一步一步，分裂循环：

分隔符：

```
mySep=$'=======' 
```

声明`c_split`为一个*数组*（并且可以与孩子共享）

```
export -a c_split 
```

虽然变量**c**确实包含至少一次出现`mySep`

```
while [ "$c" != "${c#*$mySep}" ];do 
```

从字符串的第一个到结尾截断**c**`mySep`并分配给`part`.

```
 part="${c%%$mySep*}" 
```

删除前导换行符

```
 part="${part##$'\n'}" 
```

删除尾随换行符并将结果作为新数组元素添加到`c_split`.

```
 c_split+=("${part%%$'\n'}") 
```

移除剩余的字符串时重新评估**c**`mySep`

```
 c="${c#*$mySep}" 
```

完毕 ;-）

```
done 
```

删除前导换行符

```
c=${c##$'\n'} 
```

删除尾随换行符并将结果作为新数组元素添加到`c_split`.

```
c_split+=("${c%%$'\n'}") 
```

### 进入一个函数：

```
ssplit() {
    local string="$1" array=${2:-ssplited_array} delim="${3:- }" pos=0
    while [ "$string" != "${string#*$delim}" ];do
        printf -v $array[pos++] "%s" "${string%%$delim*}"
        string="${string#*$delim}"
      done
    printf -v $array[pos] "%s" "$string"
} 
```

用法：

```
ssplit "<quoted string>" [array name] [delimiter string] 
```

其中*数组名称*`$splitted_array`默认为，*分隔符*为一个空格。

你可以使用：

```
c=$'AA=A\nB=BB\n=======\nC==CC\nDD=D\n=======\nEEE\nFF'
ssplit "$c" c_split $'\n=======\n'
printf -- "--- part ----\n%s\n" "${c_split[@]}"
--- part ----
AA=A
B=BB
--- part ----
C==CC
DD=D
--- part ----
EEE
FF 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T17:01:23.147

用 awk 做：

```
 awk -vRS='\n=*\n'  '{print "----- new part -----";print}' <<< $c 
```

输出：

```
kent$  awk -vRS='\n=*\n'  '{print "----- new part -----";print}' <<< $c
----- new part -----
AA=A
B=BB
----- new part -----
C==CC
DD=D
----- new part -----
EEE
FF 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T18:31:32.830

Added some in the example text because of this comment:

> This breaks if you replace AA=A with AA =A or with AA=\nA – that other guy

**EDIT:** I added a suggestion that isn't sensitive for some delimiter in the text. However this isn't using a "one line split" that OP was asking for, but this is how I should have done it **if** I would do it in bash, and want the result in an array.

script.sh (NEW):

```
#!/bin/bash

text=$(
  echo "AA=A"; echo "AA =A"; echo "AA=\nA"; echo "B=BB"; echo "=======";
  echo "C==CC"; echo "DD=D"; echo "======="; echo "EEE"; echo "FF";
)
echo "more complex string"
echo "$text"
echo "split now"

c_split[0]=""
current=""
del=""
ind=0

# newline
newl=$'\n'

# Save IFS (not necessary when run as sub shell)
saveIFS="$IFS"
IFS="$newl"
for row in $text; do

  if [[ $row =~ ^=+$ ]]; then
    c_split[$ind]="$current"
    ((ind++))
    current=""
    # Avoid preceding newline
    del=""
    continue
  fi

  current+="$del$row"
  del="$newl"
done

# Restore IFS
IFS="$saveIFS"

# If there is a last poor part of the text
if [[ -n $current ]]; then
  c_split[$ind]="$current"
fi

# The result is an array
for i in "${c_split[@]}"
do
    echo "---- new part ----"
    echo "$i"
done 
```

script.sh (OLD, with "one line split"):
(I stool the idea with awk **from @Kent** and adjusted it a bit)

```
#!/bin/bash

c=$(
  echo "AA=A"; echo "AA =A"; echo "AA=\nA"; echo "B=BB"; echo "=======";
  echo "C==CC"; echo "DD=D"; echo "======="; echo "EEE"; echo "FF";
)
echo "more complex string"
echo "$c"
echo "split now"

# Now, this will be almost absolute secure,
# perhaps except a direct hit by lightning.
del=""
for ch in $'\1' $'\2' $'\3' $'\4' $'\5' $'\6' $'\7'; do
  if [ -z "`echo "$c" | grep "$ch"`" ]; then
    del="$ch"
    break
  fi
done

if [ -z "$del" ]; then
  echo "Sorry, all this testing but no delmiter to use..."
  exit 1
fi

IFS="$del" c_split=($(echo "$c" | awk -vRS="\n=+\n" -vORS="$del" '1'))

for i in ${c_split[@]}
do
  echo "---- new part ----"
  echo "$i"
done 
```

Output:

```
[244an]$ bash --version
GNU bash, version 4.2.24(1)-release (x86_64-pc-linux-gnu)

[244an]$ ./script.sh
more complex string
AA=A
AA =A
AA=\nA
B=BB
=======
C==CC
DD=D
=======
EEE
FF
split now
---- new part ----
AA=A
AA =A
AA=\nA
B=BB
---- new part ----
C==CC
DD=D
---- new part ----
EEE
FF 
```

I'm **not** using `-e` for `echo`, to get `AA=\\nA` to not do a newline

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-04T10:20:01.753

以下脚本在 bash 中测试：

```
kent@7pLaptop:/tmp/test$ bash --version
GNU bash, version 4.2.42(2)-release (i686-pc-linux-gnu) 
```

脚本：（命名`t.sh`）

```
#!/bin/bash

c=$(echo "AA=A"; echo "B=BB"; echo "======="; echo "C==CC"; echo "DD=D"; echo "======="; echo "EEE"; echo "FF";)
echo "more complex string"
echo "$c"
echo "split now"

c_split=($(echo "$c"|awk -vRS="\n=*\n"  '{gsub(/\n/,"\\n");printf $0" "}'))

for i in ${c_split[@]}
do
    echo "---- new part ----"
    echo -e "$i" 
done 
```

输出：

```
kent@7pLaptop:/tmp/test$ ./t.sh 
more complex string
AA=A
B=BB
=======
C==CC
DD=D
=======
EEE
FF
split now
---- new part ----
AA=A
B=BB
---- new part ----
C==CC
DD=D
---- new part ----
EEE
FF 
```

**请注意**该 for 循环中的 echo 语句，如果您删除该选项`-e`，您将看到：

```
---- new part ----
AA=A\nB=BB
---- new part ----
C==CC\nDD=D
---- new part ----
EEE\nFF\n 
```

取`-e`不取看你的要求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-06T00:05:01.347

当数据包含文字反斜杠序列、空格和其他内容时，这是一种不会出错的方法：

```
c=$(echo "AA=A"; echo "B=BB"; echo "======="; echo "C==CC"; echo "DD=D"; echo "======="; echo "EEE"; echo "FF";)
echo "more complex string"
echo "$c";
echo ;
echo "split";

c_split=()
while IFS= read -r -d '' part
do
  c_split+=( "$part" )
done < <(printf "%s" "$c" | sed -e 's/=======/\x00/g')
c_split+=( "$part" )

for i in "${c_split[@]}"
do
    echo "------ new part ------"
    echo "$i"
done 
```

请注意，字符串实际上是按要求在“=======”上拆分的，因此换行符成为数据的一部分（当“echo”添加自己的时会导致额外的空白行）。*****``**

# jakarta-ee - java.lang.reflect.MalformedParameterizedTypeException

> ID：14630943
> 
> 赞同：2
> 
> 时间：2013-01-31T16:49:49.803
> 
> 标签：jakarta-ee, jboss, seam

Maven3

Richfaces3.3

EJB3

接缝2

休眠

JSF1.2

JBoss6

我检查了scanning-deployers-jboss-beans.xml 并且有一个部分：

"

java.lang.reflect.MalformedParameterizedTypeException

"

你有什么想法吗？谢谢

```
17:52:49,128 INFO  [TomcatDeployment] deploy, ctxPath=/ 
17:52:49,222 WARN  [InterceptorInfoRepository] EJBTHREE-1852: InterceptorInfoRepository is deprecated
17:52:49,628 WARN  [InterceptorInfoRepository] EJBTHREE-1852: InterceptorInfoRepository is deprecated
17:52:49,643 WARN  [InterceptorInfoRepository] EJBTHREE-1852: InterceptorInfoRepository is deprecated
17:52:50,486 ERROR [AbstractKernelController] Error installing to Real: name=vfs:///D:/dev/jboss-6.1.0.Final/server/default/deploy/openmind-ear.ear state=PreReal mode=Manual requiredState=Real: org.jboss.deployers.spi.DeploymentException: Error deploying openmind-ejb.jar: Exception while processing container metadata for EJB: ReportExcelRequestListBean in unit: openmind-ejb.jar
    at org.jboss.ejb3.deployers.Ejb3Deployer.deploy(Ejb3Deployer.java:194) [:6.1.0.Final]
    at org.jboss.ejb3.deployers.Ejb3Deployer.deploy(Ejb3Deployer.java:60) [:6.1.0.Final]
    at org.jboss.deployers.vfs.spi.deployer.AbstractSimpleVFSRealDeployer.deploy(AbstractSimpleVFSRealDeployer.java:56) [:2.2.2.GA]
    at org.jboss.deployers.spi.deployer.helpers.AbstractSimpleRealDeployer.internalDeploy(AbstractSimpleRealDeployer.java:63) [:2.2.2.GA]
    at org.jboss.deployers.spi.deployer.helpers.AbstractRealDeployer.deploy(AbstractRealDeployer.java:55) [:2.2.2.GA]
    at org.jboss.deployers.plugins.deployers.DeployerWrapper.deploy(DeployerWrapper.java:179) [:2.2.2.GA]
    at org.jboss.deployers.plugins.deployers.DeployersImpl.doDeploy(DeployersImpl.java:1832) [:2.2.2.GA]
    at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1550) [:2.2.2.GA]
    at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1603) [:2.2.2.GA]
    at org.jboss.deployers.plugins.deployers.DeployersImpl.install(DeployersImpl.java:1491) [:2.2.2.GA]
    at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:379) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:2044) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:1083) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.executeOrIncrementStateDirectly(AbstractController.java:1322) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1246) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1139) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:939) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:654) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.deployers.plugins.deployers.DeployersImpl.change(DeployersImpl.java:1983) [:2.2.2.GA]
    at org.jboss.deployers.plugins.deployers.DeployersImpl.process(DeployersImpl.java:1076) [:2.2.2.GA]
    at org.jboss.deployers.plugins.main.MainDeployerImpl.process(MainDeployerImpl.java:679) [:2.2.2.GA]
    at org.jboss.system.server.profileservice.deployers.MainDeployerPlugin.process(MainDeployerPlugin.java:106) [:6.1.0.Final]
    at org.jboss.profileservice.dependency.ProfileControllerContext$DelegateDeployer.process(ProfileControllerContext.java:143) [:0.2.2]
    at org.jboss.profileservice.dependency.ProfileDeployAction.deploy(ProfileDeployAction.java:151) [:0.2.2]
    at org.jboss.profileservice.dependency.ProfileDeployAction.installActionInternal(ProfileDeployAction.java:94) [:0.2.2]
    at org.jboss.kernel.plugins.dependency.InstallsAwareAction.installAction(InstallsAwareAction.java:54) [jboss-kernel.jar:2.2.0.SP2]
    at org.jboss.kernel.plugins.dependency.InstallsAwareAction.installAction(InstallsAwareAction.java:42) [jboss-kernel.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.action.SimpleControllerContextAction.simpleInstallAction(SimpleControllerContextAction.java:62) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.action.AccessControllerContextAction.install(AccessControllerContextAction.java:71) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractControllerContextActions.install(AbstractControllerContextActions.java:51) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:379) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:2044) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:1083) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.executeOrIncrementStateDirectly(AbstractController.java:1322) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1246) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1139) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:939) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:654) [jboss-dependency.jar:2.2.0.SP2]
    at org.jboss.profileservice.dependency.ProfileActivationWrapper$BasicProfileActivation.start(ProfileActivationWrapper.java:190) [:0.2.2]
    at org.jboss.profileservice.dependency.ProfileActivationWrapper.start(ProfileActivationWrapper.java:87) [:0.2.2]
    at org.jboss.profileservice.dependency.ProfileActivationService.activateProfile(ProfileActivationService.java:215) [:0.2.2]
    at org.jboss.profileservice.dependency.ProfileActivationService.activate(ProfileActivationService.java:159) [:0.2.2]
    at org.jboss.profileservice.bootstrap.AbstractProfileServiceBootstrap.activate(AbstractProfileServiceBootstrap.java:112) [:0.2.2]
    at org.jboss.profileservice.resolver.BasicResolverFactory$ProfileResolverFacade.deploy(BasicResolverFactory.java:87) [:0.2.2]
    at org.jboss.profileservice.bootstrap.AbstractProfileServiceBootstrap.start(AbstractProfileServiceBootstrap.java:91) [:0.2.2]
    at org.jboss.system.server.profileservice.bootstrap.BasicProfileServiceBootstrap.start(BasicProfileServiceBootstrap.java:132) [:6.1.0.Final]
    at org.jboss.system.server.profileservice.bootstrap.BasicProfileServiceBootstrap.start(BasicProfileServiceBootstrap.java:56) [:6.1.0.Final]
    at org.jboss.bootstrap.impl.base.server.AbstractServer.startBootstraps(AbstractServer.java:827) [jboss-bootstrap-impl-base.jar:2.1.0-alpha-6]
    at org.jboss.bootstrap.impl.base.server.AbstractServer$StartServerTask.run(AbstractServer.java:417) [jboss-bootstrap-impl-base.jar:2.1.0-alpha-6]
    at java.lang.Thread.run(Thread.java:619) [:1.6.0_18]
Caused by: java.lang.Exception: Exception while processing container metadata for EJB: ReportExcelRequestListBean in unit: openmind-ejb.jar
    at org.jboss.ejb3.Ejb3Deployment.create(Ejb3Deployment.java:561) [:1.7.21]
    at org.jboss.ejb3.deployers.Ejb3Deployer.deploy(Ejb3Deployer.java:177) [:6.1.0.Final]
    ... 49 more
Caused by: java.lang.reflect.MalformedParameterizedTypeException
    at sun.reflect.generics.reflectiveObjects.ParameterizedTypeImpl.validateConstructorArguments(ParameterizedTypeImpl.java:42) [:1.6.0_18]
    at sun.reflect.generics.reflectiveObjects.ParameterizedTypeImpl.<init>(ParameterizedTypeImpl.java:35) [:1.6.0_18]
    at sun.reflect.generics.reflectiveObjects.ParameterizedTypeImpl.make(ParameterizedTypeImpl.java:77) [:1.6.0_18]
    at sun.reflect.generics.factory.CoreReflectionFactory.makeParameterizedType(CoreReflectionFactory.java:86) [:1.6.0_18]
    at sun.reflect.generics.visitor.Reifier.visitClassTypeSignature(Reifier.java:122) [:1.6.0_18]
    at sun.reflect.generics.tree.ClassTypeSignature.accept(ClassTypeSignature.java:31) [:1.6.0_18]
    at sun.reflect.generics.repository.FieldRepository.getGenericType(FieldRepository.java:67) [:1.6.0_18]
    at java.lang.reflect.Field.getGenericType(Field.java:223) [:1.6.0_18]
    at java.lang.reflect.Field.toGenericString(Field.java:301) [:1.6.0_18]
    at org.jboss.injection.InjectionUtil.processFieldAnnotations(InjectionUtil.java:157) [:1.7.21]
    at org.jboss.injection.InjectionUtil.processAnnotations(InjectionUtil.java:197) [:1.7.21]
    at org.jboss.ejb3.EJBContainer.processMetadata(EJBContainer.java:781) [:1.7.21]
    at org.jboss.ejb3.Ejb3Deployment.processEJBContainerMetadata(Ejb3Deployment.java:471) [:1.7.21]
    at org.jboss.ejb3.Ejb3Deployment.create(Ejb3Deployment.java:553) [:1.7.21]
    ... 50 more

17:52:50,612 INFO  [HornetQServerImpl] trying to deploy queue jms.queue.ExpiryQueue
17:52:50,628 INFO  [HornetQServerImpl] trying to deploy queue jms.queue.SendMailQueue
17:52:50,628 INFO  [HornetQServerImpl] trying to deploy queue jms.queue.DLQ
17:52:50,659 INFO  [HornetQServerImpl] trying to deploy queue jms.queue.GenerateAndCheckOfferQueue
17:52:50,690 INFO  [service] Removing bootstrap log handlers
17:52:50,768 ERROR [ProfileServiceBootstrap] Failed to load profile:: org.jboss.deployers.client.spi.IncompleteDeploymentException: Summary of incomplete deployments (SEE PREVIOUS ERRORS FOR DETAILS):

DEPLOYMENTS IN ERROR:
  Deployment "vfs:///D:/dev/jboss-6.1.0.Final/server/default/deploy/openmind-ear.ear" is in error due to the following reason(s): java.lang.reflect.MalformedParameterizedTypeException

    at org.jboss.deployers.plugins.deployers.DeployersImpl.checkComplete(DeployersImpl.java:1228) [:2.2.2.GA]
    at org.jboss.deployers.plugins.main.MainDeployerImpl.checkComplete(MainDeployerImpl.java:905) [:2.2.2.GA]
    at org.jboss.system.server.profileservice.deployers.MainDeployerPlugin.checkComplete(MainDeployerPlugin.java:87) [:6.1.0.Final]
    at org.jboss.profileservice.deployment.ProfileDeployerPluginRegistry.checkAllComplete(ProfileDeployerPluginRegistry.java:107) [:0.2.2]
    at org.jboss.system.server.profileservice.bootstrap.BasicProfileServiceBootstrap.start(BasicProfileServiceBootstrap.java:135) [:6.1.0.Final]
    at org.jboss.system.server.profileservice.bootstrap.BasicProfileServiceBootstrap.start(BasicProfileServiceBootstrap.java:56) [:6.1.0.Final]
    at org.jboss.bootstrap.impl.base.server.AbstractServer.startBootstraps(AbstractServer.java:827) [jboss-bootstrap-impl-base.jar:2.1.0-alpha-6]
    at org.jboss.bootstrap.impl.base.server.AbstractServer$StartServerTask.run(AbstractServer.java:417) [jboss-bootstrap-impl-base.jar:2.1.0-alpha-6]
    at java.lang.Thread.run(Thread.java:619) [:1.6.0_18]

17:52:50,784 INFO  [org.apache.coyote.http11.Http11Protocol] Starting Coyote HTTP/1.1 on http-localhost%2F127.0.0.1-8080
17:52:50,800 INFO  [org.apache.coyote.ajp.AjpProtocol] Starting Coyote AJP/1.3 on ajp-localhost%2F127.0.0.1-8009 
```

报告Excel请求列表：

```
package de.openmind.weblogic.request;

import java.util.Collection;

import javax.ejb.EJB;
import javax.ejb.Remove;
import javax.ejb.Stateful;
import javax.faces.model.DataModel;
import javax.faces.model.ListDataModel;

import org.jboss.seam.ScopeType;
import org.jboss.seam.annotations.Destroy;
import org.jboss.seam.annotations.In;
import org.jboss.seam.annotations.Logger;
import org.jboss.seam.annotations.Name;
import org.jboss.seam.annotations.Scope;
import org.jboss.seam.log.Log;

import de.openmind.dao.request.ViewRequestDao;
import de.openmind.model.request.ViewRequest;
import de.openmind.utils.noentities.CountRequest;
import de.openmind.weblogic.status.OfferStatusList;
import de.openmind.weblogic.status.RequestStatusList;

@Stateful
@Name("reportExcelRequestList")
@Scope(ScopeType.EVENT)
public class ReportExcelRequestListBean implements ReportExcelRequestList {

    @Logger
    private Log log;

    @In(create = true)
    private RequestStatusList requestStatusList;

    @In(create = true)
    private OfferStatusList offerStatusList;

    @In(create = true)
    private FilterRequest filterRequest;

    @EJB
    private ViewRequestDao viewRequestDao;

    private DataModel<ViewRequest> normalisedRequestList = null;

    @Override
    public void setNormalisedRequestList(DataModel<ViewRequest> normalisedRequestList) {
        this.normalisedRequestList = normalisedRequestList;
    }

    @Override
    public DataModel<ViewRequest> getNormalisedRequestList() {
        log.debug("getNormalisedRequestList: starting...");
        if(normalisedRequestList == null) {
            normalisedRequestList = new ListDataModel<ViewRequest>();
            Collection<ViewRequest> requestList = viewRequestDao.findList(filterRequest.getSearchFilter(), requestStatusList.getStatusEnum(), offerStatusList.getOfferStatusList(), getCount().intValue(), 0);
            normalisedRequestList.setWrappedData(requestList);
            log.debug("getNormalisedRequestList: Set the data into normalisedRequestList.");
        }
        return normalisedRequestList;
    }

    @Override
    public Long getCount() {
        CountRequest countAllRequest = viewRequestDao.getListSize(
            filterRequest.getSearchFilter(), requestStatusList.getStatusEnum(), offerStatusList.getOfferStatusList());

        log.debug(String.format("getCount: size of count=%s", countAllRequest.getCountAllRequest()));
        return countAllRequest.getCountAllRequest();
    }

    @Override
    @Destroy
    @Remove
    public void destroy() {
        log.debug("destroy bean classname=" + this.getClass().getName());
    }
} 
```

# c++ - 我无法显示数组中包含的不同类型的变量

> ID：14630945
> 
> 赞同：0
> 
> 时间：2013-01-31T16:49:59.547
> 
> 标签：c++

我必须为大学做一个计划。

我在问题的陈述中已经声明了 3 个类。一级：

```
class piesa_a{
    protected:        
        int id;
        char *tip;
        int pret;
}; 
```

二等：

```
class piesa_b:public piesa_a
{    
    private:
        float lungime;
        bool bw;
}; 
```

第三类：

```
class piesa_c:public piesa_a
{    
    private:
        int nr;
        piesa_b *buf;
}; 
```

在main中，我需要创建一个数组来存储piesa_a、piesa_b、piesa_c等项目。然后我必须按价格对项目进行排序。

**到目前为止我有这个代码：http:** [//pastebin.com/nx2FGSfe](http://pastebin.com/nx2FGSfe)

该程序不完整，因为它没有显示数组中的每个项目。

我被困在这里。但是，如果您在数组之外显示数组的元素，它就可以工作。

**简短：**我在第 143 行有一个错误，我想解决它。

```
main.cpp:143:18: error: request for member ‘afisare’ in ‘*(v + ((unsigned int)(((unsigned int)i) * 4u)))’, which is of non-class type ‘piesa_a*’ 
```

代码在这里：

```
#include <cstdlib>
#include<iostream>
#include<string.h>
using namespace std;

class piesa_a{     
    protected:       
        int id;
        char *tip;
        int pret;

    public:
        piesa_a()
        {
            id = 0;
            tip = new char[1];
            pret = 0;
        }

        piesa_a(int aidi, char *typ, int pretz)
        {     
            id = aidi;
            tip = new char[strlen(typ)+1];
            strcpy(tip,typ);
            pret = pretz;     
        }

        piesa_a&operator =(piesa_a alta)
        {
            id = alta.id;
            tip = new char[strlen(alta.tip)+1];
            strcpy(tip,alta.tip);
            pret = alta.pret;

            return *this;
        }

        virtual void afisare()
        {
            cout<<"\n Piesa A: "<<id<<" "<<tip<<" "<<pret;
        }     
};

class piesa_b:public piesa_a
{

private:
    float lungime;
    bool bw;
public:
    piesa_b():piesa_a(){lungime = 0;bw = 0;}
    piesa_b(float lg,bool bl, int aid, char *tipi, int pretzz):piesa_a(aid,tipi,pretzz)
    {
        lungime = lg;
        bw = bl;
    }
    piesa_b&operator =(piesa_b &c)
    {
        id = c.id;
        tip = new char[strlen(c.tip)+1];
        strcpy(tip,c.tip);
        pret = c.pret;
        lungime = c.lungime;
        bw = c.bw;

        return *this;
    }

    void afisare()
    {
        piesa_a::afisare();
        cout<<"impreuna cu piesa B: "<<lungime<<" "<<bw<<"\n";
    }

};

class piesa_c:public piesa_a
{     
    private:
        int nr;
        piesa_b *buf;
    public:
        piesa_c():piesa_a(){nr=0; buf = new piesa_b[nr];}
        piesa_c(int n, piesa_b *bu,int aid, char *tipi, int pretzz):piesa_a(aid,tipi,pretzz)
        {
            nr = n;
            buf = new piesa_b[nr];
            for(int i=0;i<nr;i++)
                buf[i]= bu[i];
        }

        piesa_c&operator =(piesa_c &alta)
        {       
            id = alta.id;
            tip = new char[strlen(alta.tip)+1];
            strcpy(tip,alta.tip);
            pret = alta.pret;
            nr = alta.nr;
            for(int i=0;i<alta.nr;i++)
                buf[i] = alta.buf[i];           
        }

        void afisare()
        {                       
            for(int i=0;i<nr;i++)
                buf[i].afisare();           
        }       
};

int main(int argc, char** argv) {       
    piesa_b *H;
    H = new piesa_b[2];

    piesa_a A(4,"TIPA",120);
    piesa_b B(100,1,3,"TIPA",120);
    H[0]=B;
    H[1]=B;
    piesa_c C(2, H,14,"TIPC",20);

    piesa_a** v = new piesa_a*[3];

    v[0] = &A;
    v[1] = &B;
    v[2] = &C;

    for(int i=0;i<3;i++)
        v[i].afisare();

    return 0;
} 
```

怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:05:06.893

在 C++（和当前的 C）中，强制转换几乎总是表明程序员不知道如何使用应该使用的语言。如果您需要 3 种数据类型的数组，最简洁的解决方案是基于 3 种类型的类的对象数组。如果您想以不同方式显示每个项目，则需要重载`<<`运算符，因此您只需遍历数组并继续`<<`每个项目。按价格排序意味着该类包含一个价格字段，并且您使用标准模板库中的排序，传递一个仅比较价格的比较操作。

# python - 如何在 Python 2.5 上获取相对文件路径？

> ID：14630949
> 
> 赞同：1
> 
> 时间：2013-01-31T16:50:13.323
> 
> 标签：python, python-2.5

我使用 python 2.6 编写脚本，但由于要求限制，我必须将脚本降级到 python 2.5，如何使用 python 2.5 获取相对路径？

我之前使用的是：

```
os.path.relpath(path[, start]) 
```

但由于这是 2.6 的新功能，我不能再使用它了。

谢谢并恭祝安康！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:59:42.113

尝试[Python 中的相对路径，](https://stackoverflow.com/questions/918154/relative-paths-in-python)它应该为您提供有价值的信息。

```
>>> import sys
>>> import os.path
>>> sys.path[0]
'C:\\Python25\\Lib\\idlelib'
>>> os.path.relpath(sys.path[0], "path_to_libs") # if you have python 2.6
>>> os.path.join(sys.path[0], "path_to_libs")
'C:\\Python25\\Lib\\idlelib\\path_to_libs' 
```

编辑：发现更多[http://www.saltycrane.com/blog/2010/03/ospathrelpath-source-code-python-25/](http://www.saltycrane.com/blog/2010/03/ospathrelpath-source-code-python-25/) 这是詹姆斯加德纳的重新实现：

```
from posixpath import curdir, sep, pardir, join

def relpath(path, start=curdir):
    """Return a relative version of a path"""
    if not path:
        raise ValueError("no path specified")
    start_list = posixpath.abspath(start).split(sep)
    path_list = posixpath.abspath(path).split(sep)
    # Work out how much of the filepath is shared by start and path.
    i = len(posixpath.commonprefix([start_list, path_list]))
    rel_list = [pardir] * (len(start_list)-i) + path_list[i:]
    if not rel_list:
        return curdir
    return join(*rel_list) 
```

# cuda - Cuda 索引图 3D Block、2D Grid

> ID：14630951
> 
> 赞同：2
> 
> 时间：2013-01-31T16:50:17.277
> 
> 标签：cuda

我是cuda的新手；我有一个带有 3 个通道（颜色）的 2D 图像（宽度、高度）。我想要的是午餐像这样具有**3D 块**和**2D 网格的内核**

```
kernel_2D_3D<<<dim3(1,m,n), dim3(3,TILEy,TILEz)>>>(float *in, float *out) 
```

我用*x*表示颜色，用*y*表示宽度，用*z*表示高度。我的问题是：如何计算图像的行和列：

1.  无符号整数行 = ?
2.  无符号整数 Col = ?

我用这个函数来计算全局唯一索引

```
__device__ int getGlobalIdx_2D_3D()
{
    int blockId = blockIdx.x+ blockIdx.y * gridDim.x; 

    int Idx = blockId * (blockDim.x * blockDim.y * blockDim.z)
                 + (threadIdx.z * (blockDim.x * blockDim.y))
                 + (threadIdx.y * blockDim.x)
                 + threadIdx.x;

    return Idx;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:48:30.433

如果您使用 y 表示宽度，使用 z 表示高度，那么图像的行和列将在内核中像这样计算：

```
unsigned int row = blockIdx.z * blockDim.z + threadIdx.z;
unsigned int col = blockIdx.y * blockDim.y + threadIdx.y; 
```

当前频道将等于`threadIdx.x`。

# c - C 程序指针使系统调用崩溃

> ID：14630959
> 
> 赞同：0
> 
> 时间：2013-01-31T16:50:48.107
> 
> 标签：c, pointers, system

```
// Struct for Country Data
typedef struct
{
    char name[50];          // Country name
    char code[3];           // Country code
    int population;         // Country Population
    double lifeExp;         // Country Life expectancy  

}   CountryData;

// Struct for Dir File
typedef struct
{
    char code[3];
    int offSet;

}   DirData;

// Function Declarations
void fillCountryStructs(CountryData ** dataPtr, int nLines, int fd);
void fillDirectoryStructs(CountryData **dataPtr, DirData **director, int nLines,int fd2);
void sortStructs(DirData **director, int nLines);
int verifyString(char *s1, char *s2);

// Main Function
// - This function starts the program, get the number of lines as a 
//   parameter, fills the structs and writes the data to the Country
//   File and the Directory file.
int main(int argc, char *argv[])        // Always remember to pass an argument while executing
{
    // Some variables
    int nLines;             // The number of lines
    char *pEnd;             // For String functions
    FILE *Fin,*Fout;        // File pointers
    int fd; 
    int fd2;
    nLines = strtod(argv[1], &pEnd); 
    CountryData **countryDataPtr;   // Array of structs
    CountryData **tempStruct;
    DirData **director;

    // Allocate memory for the struct pointers
    countryDataPtr = calloc(nLines, sizeof(CountryData*));
    director = calloc(nLines, sizeof(DirData*));

    // File Stream for "AllCountries.dat"
    if((fd = open("AllCountries.dat", O_RDWR)) ==-1)
        err_sys("File not found...\n");
    // File Stream for "RandomStruct.bin"
    if ((fd2 = open("RandomStruct.bin", O_RDWR)) == -1) 
        err_sys("Failed to open binary\n");

    // Filling the Country stucts
    fillCountryStructs(countryDataPtr, nLines, fd);
    close (fd);
    //fclose(Fin);                                      // Closing the file "AllCountries.dat"
    // Writing Binary File
    write(fd2, (countryDataPtr[0]->name[0]), sizeof(CountryData));
    close (fd2);
    //fclose(Fout);
    printf("RandomStruct.bin written Sucessfully\n");

    // Filling the Directory File
    // File Stream for "RandomStructDir.dir"
    if ((fd2 = open("RandomStructDir.dir",O_RDWR|O_TRUNC)) != -1) 
        err_sys("Failed to open binary\n");

    fillDirectoryStructs(countryDataPtr, director, nLines, fd2);
    sortStructs(director, nLines);                                  // Sorting the structs

    // Write the number of lines in the FIRST LINE
    // of the Directory File
    write(fd2, nLines, sizeof(nLines));
    // Writing Directory File after the number of lines was written
    write(fd2,(director[0]->code[0]), sizeof(DirData));
    close (fd2);
    //fclose(Fout);
    printf("RandomStructDir.dir written Sucessfully\n\n");

    exit(0);
}

// Filling the Country structs
// - This function extracts the data from the file using strtok 
//   and fills all the structs with their corresponding values.
void fillCountryStructs(CountryData **dataPtr, int nLines, int fd)
{
    int curLine = 0;        // Current line
    int index = 0;          // The index
    char buf[BUFSIZE];      // The Buffer with the size of BUFSIZE
    char *tok;              // Token
    char *pEnd;             // For the String functions
        char ch = 'a'; // The temp character
    int temPop;
    double temLifeExp;  
    int num=0;

    for(curLine = 0; curLine < nLines; curLine++)
    {
       // Reading each line
    dataPtr[curLine] = (CountryData *)calloc(1, sizeof(CountryData));
    index = 0;
    do
    {
    read(fd, &ch, 1);
    buf[index++] = ch;
    }
    while(ch != '\n');

        // Strtoking...
        tok = strtok(buf, ",\n");

        index = 1;
        while(tok != NULL)
        {
            tok = strtok(NULL, ",\n");

            // Get the Country Code
            if(index == 1)
            {
                strcpy(dataPtr[curLine]->code, tok);        // Copying code to the struct
            }
            // Get the Country Name
            if(index == 2)
            {
                strcpy(dataPtr[curLine]->name, tok);        // Copying name to the struct
            }
            // Get the Country Population
            if(index == 7)
            {
                temPop = (int)strtol(tok, &pEnd, 10);
                dataPtr[curLine]->population = temPop;      // Copying population to the struct
            }
            // Get the Country Life expectancy
            if(index == 8)
            {
             num=countchar(tok);
          printf ("The number of characters entered is %d\n", num);
          printf ("The character entered is %s\n",tok);
                temLifeExp = strtod(tok, &pEnd);
                dataPtr[curLine]->lifeExp = temLifeExp;     // Copying life expectancy to the struct
            }
            index++;
        }
    }
}

int countchar (char list[])
{
        int i, count = 0;
        for (i = 0; list[i] != '\0'; i++)
        count++;
        return (count);
}

// Filling the Directory Structs
// - This function fills the directory with the offset
void fillDirectoryStructs(CountryData **dataPtr, DirData **director, int nLines, int fd2)
{

    int i = 0;
    for(i = 0; i < nLines; i++)
    {
        strcpy(director[i]->code, dataPtr[i]->code);      //It crashes in this Line
        director[i]->offSet = sizeof(CountryData) * (i);        
    }   
}

// Sorting the Dir Structs
// - This function sorts the Directory Structs.
void sortStructs(DirData **director, int nLines)
{

    int maxNumber;
    int i;
    DirData **temp;
    temp = calloc(1, sizeof(DirData));

    // Sorting the array of pointers!
    for(maxNumber = nLines - 1; maxNumber > 0; maxNumber--)
    {
        for(i = 0; i < maxNumber; i++)
        {
            if((verifyString(director[i]->code, director[i+1]->code)) == 1)
            {
                temp[0] = director[i];
                director[i] = director[i+1];
                director[i+1] = temp[0];
            }           
        }           
    }
}

// Veryfying the strings
// - This function compares two strings and return a specific value
//   accordingly.
int verifyString(char *s1, char *s2)
{
    int i;
    if(strcmp(s1,s2) == 0)
        return(0);          // They are equal

    for(i = 0; s1[i] != 0; i++)
    {
        if(s1[i] > s2[i])
            return(1);              // s1 is greater
        else if(s1[i] < s2[i])
            return(2);              // s2 is greater
    }

    return (2); // s2 is greater
} 
```

所以我得到分段错误，我不知道为什么？也许是关于指针的东西。我在第一行指定了该方法崩溃的位置（void fillDirectoryStructs）。

当我编译时，我得到：

```
Country.c：在“主要”功能中：
Country.c:68: 警告：传递“写”的参数 2 使指针从整数而不进行强制转换
Country.c:84: 警告：传递“写”的参数 2 使指针从整数而不进行强制转换
Country.c:86: 警告：传递“写”的参数 2 使指针从整数不进行强制转换
Country.c:232:2：警告：文件末尾没有换行符

```

我对指针不太了解，但我必须使用系统调用，所以我不能使用任何`FILE *`函数（`fwrite()`等），这就是我使用普通`write()`和`read()`.

当我运行它时，当它到达我刚刚指定的那一点时，我会遇到分段错误。

出于测试目的，我正在尝试打印此

```
printf("test: %s\n", countryDataPtr[0]->code[0]); 
```

而不是写，它在那里崩溃，为什么？我究竟做错了什么？那不应该在我的结构中获得第一个国家的代码吗？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T16:55:16.897

好吧，您需要倾听您的编译器并认真对待它的警告。

这个：

```
write(fd2, nLines, sizeof(nLines)); 
```

是错误的，并会解释警告。该变量`nLines`具有 type `int`，但如果您查看 [documentation for `write()`] 您可以看到第二个参数具有 type `void *`。

因此它将您的整数值解释为指针，并开始读取您无权读取的内存。

你需要：

```
write(fd2, &nLines, sizeof nLines); 
```

请注意，这`sizeof`不是一个函数，它仅在参数是类型名称时才需要括号（因为它需要对所讨论的类型进行强制转换表达式，并且强制转换被写为括在括号中的类型名称）。

此外，您需要为 I/O 可能失败的现实做好准备。该`write()`函数有一个返回值，您应该检查它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T17:01:24.270

除了 unwind 指出的严重问题之外，您的代码还有许多其他问题。

这个：

```
CountryData **countryDataPtr;   // Array of structs 
```

不是一个。*_* *一旦分配，它可能是一个指向 structs*`Array of structs`的指针数组。

 *这个：

```
write(fd2, (countryDataPtr[0]->name[0]), sizeof(CountryData)); 
```

不写一个实例（*更不用说*`CountryData`它们的整个数组）。它采用第一个元素名称的第一个字符的整数值，并将其视为指针，就像您对`nLines`.

如果你想写第一个元素，它看起来像这样：

```
write(fd2, countryDataPtr[0], sizeof(CountryData)); 
```

如果你想编写所有元素，你要么需要一个循环，要么需要一个可以一次性编写的连续结构数组。*

# sql - 按距离对结果列表进行排序

> ID：14630960
> 
> 赞同：2
> 
> 时间：2013-01-31T16:50:51.840
> 
> 标签：sql, asp-classic, distance, latitude-longitude

我创建了一个网站，用于在本地销售商品，如果免费供所有人使用。但是我现在遇到了一个小问题！现在，来自更远地方的人们正在加入我希望他们能够按距离搜索和点亮所有项目和/或查看他们所在区域的所有项目。

我一直在收集每个人的邮政编码并将它们转换为东向和北向坐标而不是纬度经度。

动态创建新记录集的最佳方法是计算距离然后按距离排序，还是有更好的方法可以在站点上使用更少的资源？

***这是答案***

```
strSQL = "SELECT *, ( 3959 * acos( cos( radians( " & strMyLat & 
    ") ) * cos( radians(Latitude) ) * cos( radians(Longitude) - radians(" & strMyLng & 
    ") ) + sin( radians( " & strMyLat & 
    ") ) * sin( radians(Latitude) ) ) ) AS distance FROM TABLE WHERE HAVING distance < 3;" '## 3 Miles 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:51:39.977

要回答您的问题：

去年我做了几乎同样的事情，但纬度/经度。并实时计算距离。距离是使用海峡数学计算的，因此速度很快，并且使用的资源不多。
不熟悉东向和北向坐标，因此在您的数据库或其他坐标系中首先将它们永久转换为纬度/经度可能会更快，也可能不会更快。

现在，如果您决定让查询尽可能快地进行，并且您正在处理一个非常小的邮政编码列表，您可以创建一个查找表，其中已经计算了任意 2 个邮政编码之间的距离。
但是，您的列表越大，这就越笨拙。例如，根据维基百科，英国大约有 1,700,000 个邮政编码，所以这样的表格需要它的平方或 2,890,000,000,000 条记录。

祝你好运！

Ps 以下是查找 2 个东/北坐标之间距离的公式：

```
d = squareroot(square(E1-E2)+square(N1-N2))/1000 
```

1000 假设您的坐标以米为单位，而您想要以公里为单位的答案。否则，请相应调整此数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-04T12:16:32.987

派对有点晚了，但是英国东/北只是覆盖在该国上的 1 公里乘 1 公里的网格，因此获得两点之间距离的数学只是毕达哥拉斯定理，您想要从其他两侧获得斜边。

以下伪代码显示了数学：

```
DeltaX = X1-X2 --the length of side 1
DeltaY = Y1-Y2 --the length of side 2
Hypotenuse = SQRT(DeltaX^2 + DeltaY^2) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-31T19:40:12.683

东和北不是要走的路。

您必须首先将坐标（无论它们是 Easting、Northing 等）转换为纬度、经度十进制度 WGS84。
这是全世界都使用的坐标系，现在你可以开始计算了：

然后简单地计算两个 lat,lon 对之间的距离，例如使用 hasrsine-Distance 公式（参见 Google 或 Wiki）。

# javascript - 输出特定的id

> ID：14630962
> 
> 赞同：0
> 
> 时间：2013-01-31T16:50:54.253
> 
> 标签：javascript, jquery, html-table

我需要创建一个函数，只要用户点击它，它就只输出任何图像的 id。（Javascript 或 jQuery 没关系）

```
<table>
  <tr>
    <td id="1"><img src="image1.gif"></td>  
    <td id="2"><img src="image1.gif"</td>
    <td id="3"><img src="image1.gif"</td>           
  </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:57:15.407

向表中添加一个类：

```
<table class="tblImages">
  <tr>
    <td id="1"><img src="image1.gif"></td>  
    <td id="2"><img src="image1.gif"</td>
    <td id="3"><img src="image1.gif"</td>           
  </tr>
</table> 
```

然后委托绑定：

```
$('.tblImages').on('click', 'td', function(e){ 
    var id = this.id; // here you go
}); 
```

演示：http: [//jsfiddle.net/Uz2pW/](http://jsfiddle.net/Uz2pW/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T16:52:55.573

尝试这个：

```
$("td img").on("click", function() {
    var id = $(this).closest("td").attr("id");
    // do as you want with id
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:53:35.427

您的图像都没有 id，但您可以获得表格单元格的 id：

```
$('image').click(function(){
    var parentID = $(this).closest('td').id;
    console.log(parentID);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T16:53:52.317

尝试这个

```
$('td').on('click', function(){
   alert($(this).attr('id'));
}); 
```

***[现场演示](http://jsfiddle.net/V9Hbu/)***

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T17:10:16.313

如果您正在寻找打印包装图像的数据单元 id，那么一种选择是为每个图像附加一个 id，这将使您能够从 javascript 检索其父节点。它看起来像这样：

```
<html>
<head>
<script>
function say_id(some_id) {
    alert(document.getElementById(some_id).parentNode.id);
}
</script>
</head>
<body>
<table>
<tr>
    <td id="1"><img id="img-1" src="Tulips.jpg" onclick="say_id(this.id)"/></td>  
    <td id="2"><img id="img-2" src="Tulips.jpg" onclick="say_id(this.id)"/></td>
    <td id="3"><img id="img-3" src="Tulips.jpg" onclick="say_id(this.id)"/></td>           
</tr>
</table>

</body>
</html> 
```

# java - com.sun.jdi.InvocationException 在 ognlRuntime 中发生调用方法错误

> ID：14630964
> 
> 赞同：0
> 
> 时间：2013-01-31T16:50:57.277
> 
> 标签：java, eclipse, struts2

当我在 Eclipse 中调试并且在 ognlRuntime 中时，出现“com.sun.jdi.InvocationException 发生调用方法”错误。当我将值从 jsp 传递到操作类时发生错误。

这是jsp中用于传递值的代码

```
<s:textfield name="partReplace.part.number" cssStyle="width:50px;" value ="%{partReplace.part.number}"/></td> 
```

当我在该文本字段中输入 vlue 时，它​​没有在动作类中设置。我调试并在 ognlRuntime 中发现“com.sun.jdi.InvocationException 发生调用方法”错误并且它没有取值..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:58:33.643

您的问题似乎与[此问题](https://stackoverflow.com/questions/4123628/com-sun-jdi-invocationexception-occurred-invoking-method)相同；

如果是这样，那么罪魁祸首应该是`toString()`Eclipse 调试器调用的类方法的错误覆盖。

更正您的自定义 toString() 方法，或阻止他抛出异常（内部很大`try-catch`）或将其完全删除，然后重试。

PS：这是谷歌搜索你的例外的第一个结果......而且也是如此：|

# highcharts - 使用 API 打开/关闭系列和绘图波段

> ID：14630969
> 
> 赞同：1
> 
> 时间：2013-01-31T16:51:06.450
> 
> 标签：highcharts

我有一个带有自定义图例的图表，即它根本不是 Highcharts 的一部分，它完全是我自己的代码，该图表禁用了 Highcharts 图例。

是否可以使用 API 在 Highcharts 图表中打开/关闭系列数据和绘图带？

我找到了一个触发图例项目的单击事件来执行此操作的示例，但这显然依赖于存在的图例，所以这对我没有用：http: [//birdchan.com/home/2013/01/23 /触发-a-click-event-on-a-legend-item-in-highchart/](http://birdchan.com/home/2013/01/23/trigger-a-click-event-on-a-legend-item-in-highchart/)

我还尝试将系列数据 .visible 属性设置为 false，然后重绘图表，虽然它设置了 visible 属性就好了，但它不会重绘图表，所以没有任何变化：

```
var chart = new Highcharts.Chart(myoptions);

$("#custom_legend_link").click(function (e) {
    chart.series[0].visible = !chart.series[0].visible;
    chart.redraw();
} 
```

这是一个使用基本行演示的 jsFiddle，显示了我的问题：

[http://jsfiddle.net/gfyans/zsaV4/](http://jsfiddle.net/gfyans/zsaV4/)

谢谢，格雷格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T18:06:53.567

要切换系列，请使用[Series.setVisible()](http://api.highcharts.com/highcharts#Series.setVisible%28%29)。当不带参数调用时，它会切换。

Plot band 有点不同，因为它们没有 hide()、show() 或 setVisible 等方法。要切换绘图带，您需要通过 Axis.removePlotBand() 将其删除，并通过[Axis.addPlotBand()](http://api.highcharts.com/highcharts#Axis.removePlotBand%28%29)[添加](http://api.highcharts.com/highcharts#Axis.addPlotBand%28%29)具有相同选项的新带。

# java - 由 onClickListener 引起的强制关闭

> ID：14630970
> 
> 赞同：0
> 
> 时间：2013-01-31T16:51:09.257
> 
> 标签：java, android, android-intent, android-activity, onclicklistener

我只做了一个`activity`打开另一个`activity`。在我设置 onClickListener 之前，一切正常。现在我的应用程序在启动时关闭。如果没有这两行，应用程序将正确启动：

```
BUeasycounter.setOnClickListener(this);
BUrps.setOnClickListener(this); 
```

这是我的完整来源：

```
package com.dano.learning;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class Menu extends Activity implements View.OnClickListener{

    Button BUeasycounter;
    Button BUrps;
    @Override
    protected void onCreate(Bundle MyBundle) {
        super.onCreate(MyBundle);
        setContentView(R.layout.activity_main);
        initializeVars();
// next 2 lines cause the problem
        BUeasycounter.setOnClickListener(this);
        BUrps.setOnClickListener(this);
    }
    public void initializeVars(){
        Button BUeasycounter= (Button) findViewById(R.id.BUeasycounter);
        Button BUrps = (Button) findViewById(R.id.BUrps);
    }

    public void onClick(View v) {
        switch (v.getId()){
            case R.id.BUeasycounter:
                Intent openEasyCounter = new Intent("com.dano.learning.EASYCOUNTER");
                startActivity(openEasyCounter);
                break;
            case R.id.BUrps:
                Intent openRPS = new Intent("com.dano.learning.EASYCOUNTER");
                startActivity(openRPS);
                break;
        };

    }
} 
```

也许我只是输入了错误的东西，但我在我的源代码中找不到超过两天的错误。感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T16:52:29.903

没有异常堆栈，但根据代码，我看到一个问题是：

```
 Button BUeasycounter;
    Button BUrps; 
```

两者都指向当你这样做时`null`可能会抛出的`NullPointerException`

```
 BUeasycounter.setOnClickListener(this);
    BUrps.setOnClickListener(this); 
```

删除`initializeVars`方法中的新变量。

例子：

```
public void initializeVars(){
          BUeasycounter= (Button) findViewById(R.id.BUeasycounter);
          BUrps = (Button) findViewById(R.id.BUrps);
    } 
```

注意：Java 命名约定建议使用小写字母作为变量名的首字母。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:54:20.653

在 swich case 后删除 smi-colon ：

```
 public void onClick(View v) {
        // TODO Auto-generated method stub
        switch (v.getId()){
            case R.id.BUeasycounter:
                Intent openEasyCounter = new Intent("com.dano.learning.EASYCOUNTER");
                startActivity(openEasyCounter);
                break;
            case R.id.BUrps:
                Intent openRPS = new Intent("com.dano.learning.EASYCOUNTER");
                startActivity(openRPS);
                break;
        } //>>>> from here remove semi-colon 
```

并将`initializeVars`方法更改为：

```
 public void initializeVars(){
          BUeasycounter= (Button) findViewById(R.id.BUeasycounter);
          BUrps = (Button) findViewById(R.id.BUrps);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T16:59:49.157

```
public void initializeVars(){
    Button BUeasycounter= (Button) findViewById(R.id.BUeasycounter);
    Button BUrps = (Button) findViewById(R.id.BUrps);
} 
```

您在此方法中定义了两个按钮，但它们是范围位于此块之间的局部变量。您不能从这里访问外部。您已经初始化了局部变量，但实例按钮变量仍然为空。要从 NPE 获得解决方案，您应该写为

```
public void initializeVars(){
    BUeasycounter= (Button) findViewById(R.id.BUeasycounter);
    BUrps = (Button) findViewById(R.id.BUrps);
} 
```

从上面的方法中，它将实例变量中的引用分配给它的范围，直到这个类存在。最后从 switch 块的末尾删除分号。

# php - php 脚本来执行 bash 脚本并在网页上显示结果。

> ID：14630977
> 
> 赞同：0
> 
> 时间：2013-01-31T16:51:32.097
> 
> 标签：php, linux, bash

我正在尝试创建一个非常简单的页面，该页面将在日志文件中查找电子邮件地址

我编写了一个接受单个参数（电子邮件地址）的 bash 脚本（带有复杂的 awk 和 sed 查询），它将显示如下输出。

```
DATE                    email                      phone 
31/1/2013               test@example.com           1800-000-000 
```

我怎样才能创建一个只需要一个电子邮件地址和一个搜索按钮的网页，它只会在后端执行 bash 脚本并将输出显示到屏幕上？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T16:53:55.023

```
 exec ("/path/to/script", $output); 
```

这会将结果输出到 $output 变量中。

然后您可以创建页面。

```
<html>
<body>
<form action="index.php">
<input type="text" name="address" />
<input type="submit" value="Post!" />
</form>
</body>
</html> 
```

在 index.php 中你可以放这样的代码：

```
<?php
     if ($_POST && $_POST['address']) {
          exec ("/path/to/script " . escapeshellarg($_POST['address']), $output); 
          echo $output;
     } 
```

# url - Backbone.js 用 fetch 和 data 填充集合——如何传递重复的键？

> ID：14630978
> 
> 赞同：2
> 
> 时间：2013-01-31T16:51:32.470
> 
> 标签：url, backbone.js, encoding, query-string, flask

我的应用程序中有一个端点，它根据给定的查询字符串返回数据。查询字符串可以（并且经常必须）包含重复的键，例如`/api/entities/related?filter1=val1&filter1=val2&filter2=val3`识别两个类型的过滤器`filter1`。Flask 很好地处理了这个问题，例如在做 时`request.args.to_dict`，我会得到`{'filter1': ['val1', 'val2'], 'filter2': 'val3'}`.

我的问题是如何在从端点获取集合时使用 Backbone 实现相同的功能。目前我可能有

```
this.fetch({data: {'filter1': 'val1', 'filter1': 'val2', 'filter2': 'val3'}}); 
```

由于重复键将在 javascript 对象中相互覆盖，因此我的`filter1`值最终将是`val2`. 然而，当做

```
this.fetch({data: {'filter1': ['val1', 'val2'], 'filter2': 'val3'}}); 
```

url 最终是`/api/entities/related?filter1%5B%5D=val1&filter1%5B%5D=val2`，它至少确实使用了两个相同的键，但显然不起作用。

这是一个编码问题还是我应该以不同的方式处理它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T17:35:40.593

`Array`您可以使用 an作为值传递具有重复键的查询字符串。

```
this.fetch({ data: $.param({ filter1: ['value1','value2']}) }); 
```

或者，您始终可以使用查询字符串参数设置这样的 URL。

```
var MyModel = Backbone.Model.extend({
  "url": function() {
      return '/' + encodeURI('?filter1=' + val1 + '&filter1=' + val2);
  }
}); 
```

如果您必须一直更改参数，您可以执行类似的操作并直接使用它：

```
this.model.destroy({
    url: '/' + encodeURI('?filter1=' + val1 + '&filter1=' + val2)              
}); 
```

如果您有多个具体参数（意味着值更改但键是静态的）每次获取都会更改（即：搜索），您可以查看[Gist](https://gist.github.com/4600195)上的分页实现，无论它可能对您的情况有用。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T10:26:34.100

感谢大家的意见。

显然，您传递的数据不一定是对象——我发现在我的案例中最简单的方法是将字符串 ( `'filter1=val1&filter2=val2'`) 传递给 fetch() 并且效果很好。

# javascript - 升序和降序排序技术

> ID：14630979
> 
> 赞同：0
> 
> 时间：2013-01-31T16:51:33.660
> 
> 标签：javascript, jquery

在下面的 html 代码中，我有一个姓名和年龄，单击姓名和年龄时，列表项应该从升序到降序或从降序到升序进行排序。

这应该在不使用任何插件的情况下实现请帮助我如何实现这一点。我真的很需要。

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>test</title>

  <style type="text/css">
  body{
    width:100%;
    margin:0px;padding:0px;
    font-size:14px;font-family:Arial;
  }
    #content{
        width:100%;
        border:1px solid red;
        height:auto;
    }
    #sorting_div{
        width:300px;
        border:1px solid black;
        height:30px;
    }
    #name{
        display:inline-block;
        width:200px;
    }
    #sorting_list{
        width:300px;
        border:1px solid green;
        height:100px;
    }
</style>

</head>
<body>
<div id="content">
<div id="sorting_div">
    <span id="name">Name</span>
    <span id="Age">Age</span>
</div>
    <div id="sorting_list">
        <ul>
            <li><label>Jenifer</label> <span>24</span></li>
            <li><label>Kate</label> <span>18</span></li>
            <li><label>David</label> <span>25</span></li>
            <li><label>Mark</label> <span>25</span></li>

        </ul>

    </div>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:02:55.630

请尝试以下示例代码以获取 li 元素中的普通文本

```
var mylist = $('#sorting_list ul');
var listitems = mylist.children('li').get();
mylist.empty();
listitems.sort(function(a, b) {
   return $(a).text().toUpperCase().localeCompare($(b).text().toUpperCase());
})
$.each(listitems, function(idx, itm) { mylist.append(itm); }); 
```

# ruby-on-rails - Ruby 1.9.3 编码

> ID：14630981
> 
> 赞同：0
> 
> 时间：2013-01-31T16:51:35.900
> 
> 标签：ruby-on-rails, ruby, encoding, actionview

我使用 ruby​​ 1.8.7 和 rails 3.2.11 一年多了，我使用它开发了我的应用程序，当我将我的 ruby​​ 版本升级到 1.9.3 时，这些问题出现了

```
incompatible character encodings: UTF-8 and ASCII-8BIT on my application.js file 
```

我尝试了很多解决方案，但都失败了，任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:55:44.707

在 Ruby 1.8 中，字符串没有被编码。在 1.9.3 中，您需要说明您的字符串使用的字符集编码。默认值为 ASCII，这是一个问题，因为您不能将不同编码的字符串添加在一起。

有关更多信息，请查看此处：

[http://blog.grayproductions.net/articles/ruby_19s_string](http://blog.grayproductions.net/articles/ruby_19s_string)

要修复它，请确保您的字符串和文件都使用 UTF 8（或任何您想要的）编码，并且您的数据库具有正确的类型。

# android - VideoView 不从 URL 播放视频

> ID：14630982
> 
> 赞同：0
> 
> 时间：2013-01-31T16:51:41.280
> 
> 标签：android, android-videoview

我已经尝试了所有关于 VideoView 的发现，但我仍然只得到一个空白的黑色容器，控制台或设备上没有任何错误消息。

我用 SGS3 和 Xperia U 试过了，都没有用。

以下是活动的 oncreate 函数的代码：

```
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_about);
        // Show the Up button in the action bar.
//      getActionBar().setDisplayHomeAsUpEnabled(true);

        String videoPath = "http://daily3gp.com/vids/747.3gp";
        String videoPath2 = "http://www.law.duke.edu/cspd/contest/finalists/viewentry.php?file=docandyou";
        VideoView aboutVideoView = (VideoView) findViewById(R.id.aboutVideoView);

        aboutVideoView.setVideoURI(Uri.parse(videoPath2));
        aboutVideoView.setMediaController(new MediaController(this));
        aboutVideoView.setVisibility(1);
        aboutVideoView.bringToFront();
        aboutVideoView.requestFocus();
        aboutVideoView.start(); 
    } 
```

我尝试评论/取消评论不同的行，尝试了两个视频源，但我无法播放。我希望有人会发现这段代码有什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T17:11:01.390

您的代码运行良好。

只需检查清单文件中的 Internet 权限即可。

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

# sql - 如何使用 SQL Server 2008 执行多个 CASE WHEN 条件？

> ID：14630984
> 
> 赞同：209
> 
> 时间：2013-01-31T16:51:44.313
> 
> 标签：sql, sql-server-2008

我要做的是对同一列使用多个 CASE WHEN 条件。

这是我的查询代码：

```
 SELECT   Url='',
            p.ArtNo,
            p.[Description],
            p.Specification,
            CASE 
            WHEN 1 = 1 or 1 = 1 
               THEN 1 
               ELSE 0 
            END as Qty,
            p.NetPrice,
            [Status] = 0
      FROM  Product p (NOLOCK) 
```

但是，我想要做的是对同一列“数量”使用不止一个 WHEN。

如以下代码所示：

```
IF
// CODE
ELSE IF
// CODE
ELSE IF
// CODE
ELSE
// CODE 
```

* * *

## 回答 #1

> 赞同：480
> 
> 时间：2013-01-31T16:58:32.533

[case 表达式](https://docs.microsoft.com/en-in/sql/t-sql/language-elements/case-transact-sql)有两种格式。您可以`CASE`使用许多`WHEN`as；

```
CASE  WHEN Col1 = 1 OR Col3 = 1  THEN 1 
      WHEN Col1 = 2 THEN 2
      ...
      ELSE 0 END as Qty 
```

*或者*一个简单的`CASE`表达式

```
CASE Col1 WHEN 1 THEN 11 WHEN 2 THEN 21 ELSE 13 END 
```

*或* `CASE` *在* `CASE`as 内；

```
CASE  WHEN Col1 < 2 THEN  
                    CASE Col2 WHEN 'X' THEN 10 ELSE 11 END
      WHEN Col1 = 2 THEN 2
      ...
      ELSE 0 END as Qty 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-31T16:57:39.833

就用这个吧，当他们是类的时候你必须使用更多。

```
SELECT   Url='',
         p.ArtNo,
         p.[Description],
         p.Specification,
         CASE 
         WHEN 1 = 1 or 1 = 1 
            THEN 1 
         WHEN 2 = 2
             THEN 2
         WHEN 3 = 3
              THEN 3
          ELSE 0 
        END as Qty,
        p.NetPrice,
        [Status] = 0
  FROM  Product p (NOLOCK) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-03-23T12:25:09.327

当有多个条件时，您可以使用下面的案例示例。

```
SELECT
  id,stud_name,
  CASE
    WHEN marks <= 40 THEN 'Bad'
    WHEN (marks >= 40 AND
      marks <= 100) THEN 'good'
    ELSE 'best'
  END AS Grade
FROM Result 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-09-22T01:15:03.807

这可能是对单个语句执行不同测试的有效方法

```
select
case colour_txt 
  when 'red' then 5 
  when 'green' then 4 
  when 'orange' then 3
else 0 
end as Pass_Flag 
```

这仅适用于平等比较！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-01-10T23:46:44.080

像这样，两个条件，两列

```
SELECT ITEMSREQ.ITEM AS ITEM,
       ITEMSREQ.CANTIDAD AS CANTIDAD,
       (CASE  WHEN ITEMSREQ.ITEMAPROBADO=1 THEN 'APROBADO'
              WHEN ITEMSREQ.ITEMAPROBADO=0 THEN 'NO APROBADO'
        END) AS ITEMS,
        (CASE 
              WHEN ITEMSREQ.ITEMAPROBADO = 0 
              THEN CASE WHEN REQUISICIONES.RECIBIDA IS NULL  THEN 'ITEM NO APROBADO PARA ENTREGA' END
              WHEN ITEMSREQ.ITEMAPROBADO = 1 
              THEN CASE WHEN REQUISICIONES.RECIBIDA IS NULL THEN 'ITEM AUN NO RECIBIDO' 
                        WHEN REQUISICIONES.RECIBIDA=1 THEN 'RECIBIDO' 
                        WHEN REQUISICIONES.RECIBIDA=0 THEN 'NO RECIBIDO' 
                       END
              END)
              AS RECIBIDA
 FROM ITEMSREQ
      INNER JOIN REQUISICIONES ON
      ITEMSREQ.CNSREQ = REQUISICIONES.CNSREQ 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-03-17T13:36:04.190

```
case 
    when a.REASONID in ('02','03','04','05','06') then
        case b.CALSOC 
            when '1' then 'yes' 
            when '2' then 'no' 
            else 'no' 
        end
    else 'no' 
end 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-31T16:57:40.210

```
 case when first_condition
      then first_condition_result_true
    else
      case when second_condition 
        then second_condition_result_true
      else
          second_condition_result_false                              
      end
    end
  end as qty 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-01-11T00:28:00.897

只是您需要多个`When`案例才能表现得像`if.. Elseif else..`

```
 Case when 1=1       //if
   Then
    When 1=1              //else if
     Then.... 
    When .....              //else if
    Then 
    Else                      //else
   ....... 
     End 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-09T14:37:07.470

我有一个类似的，但它正在处理日期。查询显示上个月的所有项目，在 1 月之前无条件运行良好。为了使其正常工作，需要添加年和月变量

```
declare @yr int
declare @mth int

set @yr=(select case when month(getdate())=1 then YEAR(getdate())-1 else YEAR(getdate())end)
set @mth=(select case when month(getdate())=1 then month(getdate())+11 else month(getdate())end) 
```

现在我只是将变量添加到条件中：...

```
(year(CreationTime)=@yr and MONTH(creationtime)=@mth) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-21T11:27:35.827

结合所有条件

```
select  a.* from tbl_Company a

where  a.Company_ID NOT IN (1,2)  

AND (   
        (0 = 
            CASE WHEN (@Fromdate = '' or @Todate='')
                THEN 0 
                ELSE 1  
            END
        )      -- if 0=0 true , if 0=1 fails (filter only when the fromdate and todate is present)
                OR
        (a.Created_Date between @Fromdate and @Todate )                 
    ) 
```

# php - 会话值正在消失

> ID：14630986
> 
> 赞同：0
> 
> 时间：2013-01-31T16:51:45.740
> 
> 标签：php, session, redirect

我有一个表单，可以将一些数据发布到处理这些数据的脚本中。在处理之后，用户被重定向到他的主页。在这个主页上，我调用了一个为我清除一些会话值的函数：

```
function clearSessionValues(){
        file_put_contents('evil.txt', chr(10) . date('Y-m-d h:i:s', time()), FILE_APPEND);
        $sessionValues = $_SESSION;
        foreach($sessionValues as $key=>$value){
            if($key != 'angemeldet' && $key != 'username' && $key != 'usergroup'){
                unset($_SESSION[$key]);
            }
        }

    } 
```

有趣的是，我处理表单的脚本缺少`$_SESSION`数组中的一些值。如果我注释掉主页上的函数调用或此函数中的命令，一切正常。这是什么原因？

我试图重命名该函数。我还尝试记录函数调用并调用该函数。似乎处理还没有完成，但重定向发生了。如此之快，以至于值在被访问之前就被清除了。我将所需的值存储在脚本的开头...

我能做些什么呢？

# mysql - 不使用光标的“命令不同步”

> ID：14630995
> 
> 赞同：1
> 
> 时间：2013-01-31T16:52:26.973
> 
> 标签：mysql, django

我们的 Django 应用程序在 Apache 中收到这些“命令不同步；您现在无法运行此命令”错误。我对此的所有研究都表明这是一个未关闭的游标连接导致这个（[以前在这里](https://stackoverflow.com/questions/11583083/python-commands-out-of-sync-you-cant-run-this-command-now)）或者应用程序同时运行多个查询。

我们没有在基本 django 包之外的任何地方使用游标连接，我怀疑这些功能正在被使用。Django 应该处理任何同时查询的问题。我已经应用[了这个 Django 补丁](https://code.djangoproject.com/attachment/ticket/17956/explicit_cursor_closing.patch)，它应该明确关闭任何打开的连接，但没有这样的运气。

这与多线程有关吗？或者只是 Django 中的一般错误？

# openerp - OpenERP 7：如何在销售订单行中添加图像？

> ID：14630998
> 
> 赞同：0
> 
> 时间：2013-01-31T16:52:30.443
> 
> 标签：openerp

如何在 OpenERP 7 的 sale.order.line 中添加小图像？使订单或报价单中的每个产品都具有小形象。我是 OpenERP 和 Python 的新手，现在尝试了几天......

![在此处输入图像描述](../Images/b1cd25cc5e449a2ccc45093e3b5e3da0.png)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T11:32:33.077

据我所知，没有办法在树视图中显示图像。所以在你破解树视图并使其图像支持之前是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T18:52:14.827

如果您从第 541 行的产品模块中查看 product.py 并且（以下）您可以看到图像集并存储在您的产品中。这样，您必须在 sale.order.line 中定义一个字段，该字段与 froduct 的图像字段相关。我不知道在树视图中是否有效，但在表单视图和看板视图中效果很好。谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T16:28:38.030

我找到了办法。我在这里描述了它：http: [//help.openerp.com/question/483/openerp-7-how-can-i-add-images-in-saleoderline/](http://help.openerp.com/question/483/openerp-7-how-can-i-add-images-in-saleoderline/)