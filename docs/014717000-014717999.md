# StackOverflow 问答 14717000-14717999

# arduino - 被不同的 ADK 库弄糊涂了

> ID：14717003
> 
> 赞同：2
> 
> 时间：2013-02-05T21:13:25.533
> 
> 标签：arduino, adk

我正在尝试设置 Arduino IDE v 1.0.1 以与 Ardunio mega ADK 一起使用，我设置了所有内容，但问题是周围有很多 adk 库，特别是有 **adk_release_20120606**可以从 android 开发者网站 [http://developer.android下载.com/tools/adk/adk.html](http://developer.android.com/tools/adk/adk.html) 并且有**ArduinoADK-beta-001**可以从 ardunio labs [http://labs.arduino.cc/ADK/AccessoryMode](http://labs.arduino.cc/ADK/AccessoryMode)下载。

根据labs.ardunio.cc **ArduinoADK-beta-001**是较新的版本。

> 如果您安装了以下任何 Arduino 库，则需要将其删除： AndroidAccessory USB_Host_Shield（版本 1.x 和 2.x） 新的 UsbHost 库不能与旧的 AndroidAccessory 库或任何版本的 USB_Host_Shield 库共存.

但问题是网络上所有现有的草图都使用旧的草图，例如**ArduinoADK-beta-001**中不存在 **poweron()**方法，而是应该使用**begin()**。

 ****另一件事是旧库中的 read() 方法，它可以接受 3 个参数，但在较新的库中，它没有参数。

我已经在两个库中打开了**AndroidAccessory.h**，我发现在 **ArduinoADK-beta-00**中包含旧版本中的所有方法，但它们被设置为私有，因此无法使用，这是头文件中的内容：

```
#ifndef __AndroidAccessory_h__
#define __AndroidAccessory_h__

#include "UsbHost.h"
#include "Arduino.h"
#include "Stream.h"

#define DATA_BUFFER_SIZE 64

class AndroidAccessory : public Stream {
private:
const char *manufacturer;
const char *model;
const char *description;
const char *version;
const char *uri;
const char *serial;

MAX3421E max;
UsbHost usb;
bool connected;
uint8_t in;
uint8_t out;

EP_RECORD epRecord[8];

// TODO: Reuse `descBuff` after connection and/or stream descriptor?
uint8_t descBuff[256];

byte dataBuff[DATA_BUFFER_SIZE];
unsigned int numBytesInDataBuff;
unsigned int nextByteInDataBuffOffset;

bool isAccessoryDevice(USB_DEVICE_DESCRIPTOR *desc)
{
    return desc->idVendor == 0x18d1 &&
        (desc->idProduct == 0x2D00 || desc->idProduct == 0x2D01);
}

int getProtocol(byte addr);
void sendString(byte addr, int index, const char *str);
bool switchDevice(byte addr);
bool findEndpoints(byte addr, EP_RECORD *inEp, EP_RECORD *outEp);
bool configureAndroid(void);

bool dataBufferIsEmpty();
void refillDataBuffer();

// Private because it bypasses the data buffer.
int read(void *buff, int len, unsigned int nakLimit = USB_NAK_NOWAIT);

void powerOn(void);

public:
AndroidAccessory(const char* manufacturer,
                 const char* model,
                 const char* description = "An Arduino-based Android accessory",
                 const char* version = "1.0",6
                 const char* uri = "http://labs.arduino.cc/ADK/Index",
                 const char* serial = "00000000");

boolean begin(void);

void refresh(void);

bool isConnected(void);
virtual size_t write(uint8_t *buff, size_t len);

virtual int available(void);
virtual int peek(void);
virtual int read(void);

virtual void flush();
virtual size_t write(uint8_t);

using Print::write; // pull in write(str) and write(buf, size) from Print
};

#endif /* __AndroidAccessory_h__ */ 
```

因此我们可以看到该`poweron()`方法仍然存在，但它是私有的，并且`read()`在私有部分中声明了两次，如下所示：

```
 int read(void *buff, int len, unsigned int nakLimit = USB_NAK_NOWAIT); 
```

另一个在公共部分是这样的

```
 virtual int read(void); 
```

那么问题来了，我该如何使用该`read()`功能？以及从安卓设备接收到的数据应该存储在哪里？****

# actionscript-3 - AS3 将影片剪辑光栅化为 Sprite 以进行打印

> ID：14717005
> 
> 赞同：1
> 
> 时间：2013-02-05T21:13:33.447
> 
> 标签：actionscript-3, printing

我目前在打印多页文档时遇到了令人沮丧的问题。本质上，我在舞台上有一个影片剪辑 (printArea)，其中包含几个元素，包括使用加载器组件加载的图像、数据网格组件和其他一些分类元素。

该影片剪辑充当单个页面的模板；您调整选项，然后单击“添加页面”并再次更改第二页，依此类推。我遇到的问题是将页面添加到稍后使用 addPage() 循环的数组。据我了解，最好将精灵或影片剪辑传递给 addPage。我觉得复制影片剪辑，然后用数据、大小和定位设置重新初始化所有组件完全是矫枉过正。我无法传递影片剪辑本身，因为我需要从一个实例建模的多个页面。有没有办法简单地将影片剪辑栅格化以将其传递给 addPage()？这是我目前找到的唯一解决方案，但打印输出的质量很差：

```
//So let's say I want to add the movie clip's current state to the array :

multiPages.push(duplicateMC(printArea));
function duplicateMC(mc)
{
    var tempImg:BitmapData = new BitmapData(mc.width,mc.height);
    tempImg.draw(mc);
    var fullImg = new Bitmap(tempImg);
    var newImg = DisplayConverter.bitmapToSprite(fullImg,true);
    multiPages.push(newImg);
}

//DisplayConverter function in a seperate file (Snagged this online somewhere) :

public static function bitmapToSprite(bitmap:Bitmap, smoothing:Boolean = false):Sprite
{
    var sprite:Sprite = new Sprite();
    sprite.addChild( new Bitmap(bitmap.bitmapData.clone(), "auto", smoothing));
    return sprite;
} 
```

在此先感谢，这对我来说一整天都是一个巨大的痛苦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:59:00.343

不要过度复杂化。
您没有缩放，所以不要打开捕捉或平滑，因为这会扭曲图像并降低质量。
将“图像/BMD”存储在您的阵列中，以便在打印时参考它。存储更多然后 BMD 是浪费内存。

```
function doMyPrinting( ):void{
  for each( var item:BitmapData in multiPages){
    var page:Sprite = new Sprite();
    page.addChild(new Bitmap(item));
    printJob.addPage(page);
  }
}

multiPages.push(duplicateMC(printArea));
function duplicateMC(mc):void
{
    var tempImg:BitmapData = new BitmapData(mc.width,mc.height);
    tempImg.draw(mc);
    multiPages.push(tempImg);
} 
```

# android - NFC 提供什么样的带宽？

> ID：14717007
> 
> 赞同：5
> 
> 时间：2013-02-05T21:13:40.453
> 
> 标签：android, nfc

我正在考虑使用 Android 和 NFC 启动一些项目。NFC 提供什么样的带宽？这是假设我有一个合适的 NFC 读取器/写入器连接到 Arduino 或类似设备，并且正在与与之接触的 Android 设备进行通信。很多人建议启动与 NFC 的通信，然后通过蓝牙进行实际的数据传输，但出于好奇，我想知道可用于严格 NFC 通信的带宽。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T21:36:12.157

空中接口支持的数据速率是一回事。在移除协议开销、等待 eeprom 写入以及所有其他需要时间的东西之后，您看到的数据速率是完全不同的。

长话短说，从标签读取或进行点对点传输时的实际数据速率峰值约为 2.5 KB/秒。

并且取决于特定的标签或对等技术，它可能会*比*这慢得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:30:45.173

NFC 支持 106/212/424 kbit/s。显然也有 848 kbit/s 卡，但它们不符合标准。

话虽如此，您在现实世界中获得的速度取决于您使用的设备/卡。实际上并不是那么快。

使用蓝牙进行实际传输的另一个原因是接近度。蓝牙的范围比 NFC 好得多。简单地说，NFC 的范围很可怜。对于仅限 NFC 的传输，您必须确保设备在整个过程中都*非常靠近（最好不要移动）。*对于 NFC 切换到蓝牙，您只需轻按它们半秒左右，然后它们是否在房间内移动都没有关系。

现在，如果您只是谈论在这里和那里发送几公斤，那不是问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T21:32:02.763

来自[维基百科](http://en.wikipedia.org/wiki/Near_field_communication)

> 支持的数据速率：106、212 或 424 kbit/s（比特率 848 kbit/s 不符合标准 ISO/IEC 18092）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T21:32:10.453

我认为这取决于芯片组和标签组合。它可以是 106 kb/s、212 kb/s 或 424 kb/s。我不确定如何通过 Android API 确定传输速度，甚至不知道 Android 支持的速度。

除了低带宽限制外，您还应避免非平凡的 nfc 传输，因为设备物理分离时连接中断。

[http://www.radio-electronics.com/info/wireless/nfc/near-field-communications-tags-types.php](http://www.radio-electronics.com/info/wireless/nfc/near-field-communications-tags-types.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-17T20:06:56.713

支持 106、212 或 424 kbit/s。但在现实中，根据现实生活经验，它确实比这要低得多。

# c++ - mkdir 变量类型 C++

> ID：14717017
> 
> 赞同：1
> 
> 时间：2013-02-05T21:14:15.967
> 
> 标签：c++

这是我试图用 C++ 创建的程序的一部分。
自从开始使用 C++ 以来，我就遇到了不同变量类型的问题。我相信函数 mkdir 需要`const char`，但我不确定如何将正确的变量从输入转换为我需要的。

所需的所有变量和包含都在程序中。这是我唯一的问题。

对于我的问题，我可能不是最具体的，但我是 C++ 新手，任何帮助将不胜感激，谢谢！

```
int createaccount(const char acc_name)
{
     int status = mkdir("/home/person/Desktop/Accounts/" + acc_name, S_IRWXU);
     return 0;
} 
```

```
std::string new_acc_name;
cin >> new_acc_name;
new_acc_namechar = str.new_acc_namechar_str();
createaccount(new_acc_namechar);` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:18:04.900

如果您使用 C++，请学习使用`std::string`. 它是一个内置的字符串类型，可以`const char*`通过调用转换为 a `c_str()`。通常你会`std::string`一直存储和传递对象，除非你需要与需要`const char*`. 到时候打电话`c_str()`。例如：

```
int createaccount(const std::string& acc_name)
{
     std::string path = "/home/person/Desktop/Accounts/" + acc_name;
     int status = mkdir(path.c_str(), S_IRWXU);
     return 0;
} 
```

在猜测你的代码试图做什么之后：

```
std::string new_acc_name;
cin >> new_acc_name;
createaccount(new_acc_namechar); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:22:01.573

`mkdir()`是一个声明为（根据`man 2 mkdir`）的 libc 函数：

```
int mkdir(const char *pathname, mode_t mode); 
```

事实上，它需要 a`const char*`作为路径名。在 C++ 中，您经常处理`std::string`而不是低级别`char*`的 C。您可以将两者都用作“字符串”，但它们不可互换。std::string 支持很好的东西，比如用操作符连接字符串`+`等等。

在您的示例中，您`+`用于连接“字符串”，但您的字符串实际上是 char 数组，因此您不能像那样简单地连接它们。

一个简单的解决方案是：

```
int createaccount(const std::string&filename) {
   std::string path="/home/person/Desktop/Accounts/";
   std::string fullname=path+filename;
   int status = mkdir(fullname.c_str(), S_IRWXU); 
   return 0;
} 
```

它使用 std::string 进行连接，并使用 std::string 的`c_str()`成员函数将 C++ 字符串转换为 C 的`const char*`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T21:20:51.143

```
int createaccount(const char acc_name)
{
     int status = mkdir("/home/person/Desktop/Accounts/" + acc_name, S_IRWXU);
     return 0;
} 
```

在此函数中，您不能只连接 a`const char*`和`char`using`+`运算符。相反，您应该使用`int status = mkdir (string(string("/home/person/Desktop/Accounts/")+acc_name).c_str(), S_IRWXU);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T21:19:19.080

我认为您想要的是以下内容：

```
int createaccount(const char acc_name) {
    std::string combinedPath = "/home/person/Desktop/Accounts" + acc_name;
    int status = mkdir(combinedPath.c_str(), S_IRWXU);
    return status;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T21:19:34.900

`"/home/person/Desktop/Accounts/" + acc_name`这是将 acc_name（单个字符）添加到字符串字面量的地址`"/home/person/Desktop/Accounts/"`。你想做这样的事情。

```
int createaccount(const char acc_name)
{
  std::string dir = "/home/person/Desktop/Accounts/";
  dir += acc_name;
  int status = mkdir(dir.c_str(), S_IRWXU);
  return 0;
} 
```

# php - 如何使用 php 在文件上设置 mime 类型？

> ID：14717018
> 
> 赞同：8
> 
> 时间：2013-02-05T21:14:19.923
> 
> 标签：php, mime-types, fwrite

我正在为一个类编写单元测试，需要生成一些具有不同 mime 类型的文件。

我知道在向远程用户（ala）发送文件时如何设置 mime-type `header()`，但是`fwrite()`在本地服务器上使用时如何设置呢？

对于以这种方法生成的文件，mime 类型是直接从文件扩展名派生的吗？

我在 Ubuntu 12.04 上使用 PHP 5.3.x

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-05T21:16:50.080

文件没有 mime 类型。它们由文件扩展名标识。mime 类型通常由`/etc/mime.types`. mime 类型所做的只是告诉客户端使用什么程序来打开文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T21:17:50.067

mime-type 通常只适用于 Web 浏览器和电子邮件客户端，不适用于您的物理文件。只需创建具有正确扩展名的文件，Ubuntu 文件管理器就会相应地解释它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T21:25:19.890

mime 类型属于您的服务器或浏览器执行的 HTTP 请求。如果您正在运行 Apache，您可以在 .htaccess 文件中为您的媒体文件设置默认的 mime 类型。然后，您可以尝试使用 CURL 或 fsockopen 模拟请求返回您的文件，如果 mime 类型正确，请查看标头...以防万一您想在单元测试中确保 mime 类型正常工作。

# python - 如何获取实例化类的变量名？

> ID：14717019
> 
> 赞同：0
> 
> 时间：2013-02-05T21:14:26.250
> 
> 标签：python, class, object

> **可能重复：**
> [在类 __init__() 中获取实例名称](https://stackoverflow.com/questions/1690400/getting-an-instance-name-inside-class-init)

我正在尝试解决这个**小**问题：

```
class Test(object):
    def __init__(self):
        print "hello: %s" % i_dont_know

b = Test()
c = Test() 
```

我想得到的结果是：

```
hello: b
hello: c 
```

**只是**变量名。

我知道 id(self) 返回参考代码，是否可以获得参考名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:23:34.993

不，你不能。除了 BrenBarn 的例子之外，还有另一个无法克服的原因。构造函数在赋值发生*之前*完全执行。

看字节码：

```
>>> class Test(object): pass
... 
>>> def make_instances():
...     a = Test()
...     b = Test()
... 
>>> import dis
>>> dis.dis(make_instances)
  2           0 LOAD_GLOBAL              0 (Test)
              3 CALL_FUNCTION            0
              6 STORE_FAST               0 (a)

  3           9 LOAD_GLOBAL              0 (Test)
             12 CALL_FUNCTION            0
             15 STORE_FAST               1 (b)
             18 LOAD_CONST               0 (None)
             21 RETURN_VALUE 
```

`CALL_FUNCTION`字节码是执行的`__init__`。`STORE_FAST`将对象绑定到标识符。Python 不提供与绑定交互的任何方式，因此没有可以使用的“特殊方法”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:24:44.400

最好做类似的事情

```
class Test:
    def __init__(name):
        self.name = name

    def __str__():
        return name

a = Test("a")

print a    
>>> a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T21:18:06.217

不，你不能。如果我这样做怎么办：

```
Test() 
```

或这个：

```
someList[3] = Test() 
```

或这个：

```
someList.append(Test()) 
```

# php - 从哪里获得以及如何使用 zend_pdf 独立

> ID：14717024
> 
> 赞同：7
> 
> 时间：2013-02-05T21:14:44.540
> 
> 标签：php, zend-pdf

在过去的两天里，我一直在寻找有关如何将 zend_pdf 独立使用的答案。我在 google 上找到的所有内容都是指我在任何地方都找不到的 pdf.php。

我在这里找到了 zend_pdf ( [https://github.com/zendframework/ZendPdf](https://github.com/zendframework/ZendPdf) )

我不想在服务器上安装整个框架，也不想让人们告诉我使用 fpdf 或 tcpdf 或其他任何东西。zend_pdf 似乎是完美的解决方案。我只是想知道如何使用它 asstandalon。

有明确的指示吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-06T03:47:08.710

首先，值得注意的是`ZendPdf`，您所指的版本是最初包含在 ZF2 中但在 2011 年某个时候从框架中删除的版本。作为旁注，我与 Matthew Weier O'Phinney 交谈过（ZF2 项目负责人）在 ZendCon 2012 上谈到了这一点，他说如果有人想伸出手来维护这个类，我们可以把它重新放到 ZF2 框架中。

我们在这里讨论的 ZF2 版本虽然在语义上与 ZF1 版本相同，但在语法上有所不同，因为 ZF2 开发人员在决定将其从主项目中分离出来之前进行了对命名空间的转换和一些其他重构. 大多数（甚至可能全部？）`ZendPdf`示例都`Zend_Pdf`来自 ZF1，除非您处理自动加载和其他语法差异，否则它们将不适用于此版本。

直到今天我才使用这个独立版本，发现它不会渲染生成的 PDF 文档，除非您包含一个来自 ZF2 框架的源代码文件夹。为了使下面的示例代码运行，您需要获取 ZF2 框架的副本并将该`Zend/Memory`文件夹复制到您从 Github`library`下载时创建的文件夹中。`ZendPdf`

完成后，下面的独立 PHP 代码将允许您用于`ZendPdf`创建 PDF 文件：

```
<?php
function simpleBootLoader( $stack )
{
    require_once './library/' . 
                 str_replace( '\\', DIRECTORY_SEPARATOR, $stack ) .
                 '.php';
}

spl_autoload_register( 'simpleBootLoader' );

use ZendPdf\PdfDocument;
use ZendPdf\Page;
use ZendPdf\Font;

$pdf = new PdfDocument();

$pdf->pages[0] = new Page( Page::SIZE_A4 );
$pdf->pages[0]->setFont( Font::fontWithName( Font::FONT_HELVETICA ), 24 );
$pdf->pages[0]->drawText( 'Hello world!', 240, 400 );

$pdf->save( 'example.pdf' ); 
```

无论如何，这都不是生产就绪的代码。对于初学者，您需要一个更强大的自动加载器。

无论如何，我希望这能解决您眼前的问题和/或让您走上正轨。祝你好运！

# visual-studio-2012 - 如何对 Visual Studio 键盘映射进行故障排除

> ID：14717028
> 
> 赞同：1
> 
> 时间：2013-02-05T21:15:06.243
> 
> 标签：visual-studio-2012

这是 Visual Studio 2012 的一个明显烦恼（对我来说）。我已经将它安装在 3 台不同的机器上，我一直遇到这个问题。SHIFT+ALT+F10（显示智能标签）会工作一段时间，但在我重新启动VS之前它会停止工作。

有其他人遇到过这个问题并解决了吗？或者有谁知道如何解决它？

# bash - 从最接近特定时间修改的子目录中获取所有文件

> ID：14717031
> 
> 赞同：1
> 
> 时间：2013-02-05T21:15:16.080
> 
> 标签：bash

我有一个学生提交的项目目录：

```
+ submissions
|
+-+ Student_Name_1
|
+-+ Student_Name_2
|
+-+ Student_Name_3
|
... 
```

每个子目录可能包含一个或多个 tar/zip/tgz/tar.gz/etc。文件。有些目录可能是空的，因为学生根本没有提交。

项目提交截止日期是在特定的设定时间。什么是最有效的方法（最好是在 BASH 脚本中，以保持简单）仅获取在提交截止日期之前创建的最新文件的副本并将其复制到另一个目录，文件名是：
`Student_Name_#--original_file_name.tar/zip`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:11:12.230

也许：如果我已经理解找到最接近截止日期的提交的要求。

```
set -e
touchfile=touchfile
deadline=02010930 #CHANGEME
touch -t $deadline $touchfile
files=`find submissions  -type f  | while read filename ; do
    if [[ $filename -ot $touchfile ]] ; then
        echo $filename
    fi
done`

[[ -n "$files" ]] && {
    thefile=`ls -t $files | head -1`

    [[ -n "$thefile"  ]] && {
        # REMOVE echo when happy :D
        echo cp $thefile $(basename $(dirname $thefile))-$(basename $thefile)
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:55:46.547

这样的事情应该这样做：

```
DESTINATION="../final"
for D in `find . -type d`
do
    LASTFILE=`cd ${D};ls -art1 *.{zip,tar} | tail -1`
    #note that the last arg of each call is the number one, not the letter 'L'
    cp ${D}/${LASTFILE} ${DESTINATION}/${D}-${LASTFILE}
done 
```

# javascript - 强制提交未填写必填字段的表单？

> ID：14717034
> 
> 赞同：1
> 
> 时间：2013-02-05T21:15:26.823
> 
> 标签：javascript, html

这个问题的标题也可能是：“使用 javascript 设置必填字段？”

```
<form class="theform" action="#" method="post" name="theform">
    <label for="tname">Team Name:</label>
    <input type="text" placeholder="Bears" required /><br>
    <label for="captain">Captain:</label>
    <input type="text" placeholder="Captain's Name" required /><br>
    <button type="submit" value="Submit" onclick="toggleReq()" >Submit</button>
</form> 
```

这是我的表格的高度简化版本。我知道这可能看起来很奇怪，但我希望表单实际提交时“船长”字段为空并设置为`required`.

我在想这可能——只是可能——通过在`required`单击提交按钮时让 javascript 删除属性来实现——因此`onclick="toggleReq()"`.

* * *

既然每个人都想知道为什么这会有用，我将解释一下：这个概念是前一段时间引入的，垃圾邮件发送者可以通过包含一个额外的表单字段来阻止垃圾邮件发送者，用户被指示将其留空。（理想情况下，该字段将被隐藏；真实用户不需要知道它的存在。）很明显哪些评论来自垃圾邮件机器人，因为垃圾邮件机器人会自动填充虚拟字段。

我正在寻求解决的这种方法有几个弱点。垃圾邮件机器人可能会忽略非必填字段。但是，简单地使虚拟字段成为必填项会阻止真实用户提交表单。因此，捕捉机器人的最佳选择是保留输入字段`required`，但忽略所需的标签。忽略在技术上是不可能的，但关闭`required`属性是可行的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:19:59.650

如果你 id 船长的姓名字段，这很容易。假设 id 为“captain”：

```
function toggleReg(){
   $("#captain").removeAttr('required');
} 
```

或非 jQuery 版本：

```
function toggleReq() {
   document.getElementById("captain").removeAttribute("required");
} 
```

当然，如果你想要一个真正的“切换”，你需要先读取当前状态。

# asp.net-mvc - 错误：内容控件必须是内容页或引用母版页的嵌套母版页中的顶级控件

> ID：14717049
> 
> 赞同：0
> 
> 时间：2013-02-05T21:16:10.697
> 
> 标签：asp.net-mvc

我有一个使用 .aspx 视图的 MVC 网站。我正在使用这种方法找到视图：

```
public override ViewEngineResult FindView(ControllerContext controllerContext, string viewName, string masterName, bool useCache)
    {
        string skinName =
            this.GetSkinName(controllerContext);

        string controllerName =
            controllerContext.RouteData.GetRequiredString("controller");

        string viewPath = 
            this.GetPathFromGeneralName(this.ViewLocationFormats, viewName, controllerName, skinName);

        string masterPath = 
            this.GetPathFromGeneralName(this.MasterLocationFormats, viewName, controllerName, skinName);

        if (string.IsNullOrEmpty(viewPath))
        {
            IEnumerable<string> searchedLocations =
                this.ViewLocationFormats.Union(this.MasterLocationFormats);
            return new ViewEngineResult(searchedLocations);
        }

        return new ViewEngineResult(this.CreateView(controllerContext, viewPath, masterPath), this);
    } 
```

我有一个从母版页继承的视图。在它里面有一个到动作控制器的超链接，但它的视图没有连接到母版页（我不希望它是）。当它尝试显示第二个操作的视图（通过单击超链接）时，我收到上面的错误消息。我有其他指向其他内容页面的链接，这些链接工作正常，但我无法链接到独立的 .aspx 页面（不是从母版页继承的）。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T15:54:12.643

我最终遵循了创建空白母版页的建议。这个链接有更多解释： [http ://forums.asp.net/p/1880732/5294074.aspx/1?Re+Error+Content+controls+have+to+be+top+level+controls+in+a+内容+页+或+a+嵌套+母版+页+那个+参考+a+母版+页](http://forums.asp.net/p/1880732/5294074.aspx/1?Re+Error+Content+controls+have+to+be+top+level+controls+in+a+content+page+or+a+nested+master+page+that+references+a+master+page)

# asp.net-mvc - Connectionstring 仅适用于 global.asax

> ID：14717054
> 
> 赞同：0
> 
> 时间：2013-02-05T21:16:24.720
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first, connection-string, entity-framework-migrations

我有一个在 VS2012 中首先使用 EF 5 代码的 MVC 4 应用程序。我在另一台笔记本电脑上创建了这个应用程序，我也激活了迁移但再次禁用它（通过删除迁移文件夹并删除 de DB 中的表）。现在我将整个解决方案复制到我的第二台笔记本电脑上，但我无法再运行该应用程序了。

尝试访问数据库时总是出现异常。

> 提供者没有返回 providermanifesttoken 字符串

有一个内部例外

> {“建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。未找到或无法访问服务器。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供程序：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）“}

我使用以下连接字符串

```
<connectionStrings>
    <add name="DefaultConnection" providerName="System.Data.SqlClient" connectionString="Data Source=(localdb)\v11.0; Integrated Security=True; MultipleActiveResultSets=True" />
  </connectionStrings> 
```

当我把它放在我的 global.asax 中时，它确实有效。

```
Database.DefaultConnectionFactory = new SqlConnectionFactory(@"Data Source=(localdb)\v11.0; Integrated Security=True; MultipleActiveResultSets=True"); 
```

所以简而言之，在我创建项目的笔记本电脑上，一切都适用于 web.config 中的连接字符串，但在我的另一台电脑上，它只适用于 de global.asax

有人有解决这个烦人问题的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T19:21:02.473

我终于找到了解决问题的方法。好像我错过了配置中的某些内容。我仍然不明白为什么它可以在我的另一台机器上运行，但对于有同样问题的你们，请尝试以下操作。

我的配置中有以下内容。

```
 <entityFramework>
<defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework" /> 
```

[在我在stackoverflow](https://stackoverflow.com/questions/9582193/entity-framework-connection-string-not-from-config)上找到这篇文章后，我用这个片段替换了它

```
<entityFramework>
<defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework">
  <parameters>
    <parameter value="Data Source=(localdb)\v11.0; Integrated Security=True; MultipleActiveResultSets=True" />
  </parameters>
</defaultConnectionFactory> 
```

# javascript - contenteditable 换行

> ID：14717056
> 
> 赞同：1
> 
> 时间：2013-02-05T21:16:29.260
> 
> 标签：javascript, jquery, html, wysiwyg, contenteditable

一段时间以来，我一直在使用 contenteditable 开发内容编辑器。我对进展感到非常满意，并且即将完成正在使用该编辑器的项目。

Trident/Gecko/Chrome 都以不同的方式处理 contenteditable 中的换行符。我需要一个跨浏览器的解决方案来解决这个问题。在 Chrome 中，如果我给出一个初始标签，例如`p`，编辑器将创建新行作为`p`标签，但是这不会在 Firefox 中延续。

从项目符号列表返回时，此行为往往会中断，因为它不是创建新的 p 标签，而是恢复为使用 div 换行。

我已经在网上搜索以尝试找到解决方案，但到目前为止一无所获。我知道这当然是可能的，因为 CKEditor 等其他编辑器可以让您选择换行行为。

不幸的是，我有一组特定的要求，不允许我使用**任何**外部编辑器。这件事必须定制。

所以我的问题是，有谁知道如何控制 contenteditable 中的跨浏览器换行行为？使用 jQuery 很好，但是希望尽可能保持精简。非常感谢我能在这方面获得的所有帮助 - 项目完成后，您将获得明显的荣誉！

# css - 移动设备中的 z-index 不起作用

> ID：14717058
> 
> 赞同：0
> 
> 时间：2013-02-05T21:16:30.613
> 
> 标签：css, jquery-mobile

是否有一种特定的方式为移动设备格式化 z-index？它甚至有效吗？

www.backwards.ca/resume

这就是我正在做的事情。在移动设备中，正文（.info-win）应该在标题（.name-win）下向上滚动，但它不起作用

这是代码：

```
body{
background:#EEE;
margin-top:0;
margin-left:0;
}

.container{
position:relative;
top:0;
left:0;
width:100%;
height:100%;
padding-left:0;
background:#EEE;
}

.name-win{
position:fixed;
top:0;
left:0;
height:25%;
width:100%;
z-index:10000px;
padding-left:5%;
background:#EEE;
-moz-box-shadow:-2px 0px 2px 3px rgba(200, 200, 200, 0.8);
-webkit-box-shadow:-2px 0px 2px 3px rgba(200, 200, 200, 0.8);
-o-box-shadow:-2px 0px 2px 3px rgba(200, 200, 200, 0.8);
box-shadow:-2px 0px 2px 3px rgba(200, 200, 200, 0.8);
}

.scroll{
background:none;
}

.info-win{
position:relative;
margin-top:25%;
background:#FFFFFF;
height:100%;
width:100%;
z-index:-1000px;
min-height:500px;
overflow:hidden;
padding-bottom:20px;
}

.name-win h1{
font-family: 'Archivo Narrow', sans-serif;
font-weight:700;
max-width:200px;
}

#pic{
float:left;
}

#pic img{
width:60%;
border:6px solid #fff;
}

.res_cont{
width:100%;
}

.contact h3{
margin-bottom:0px;
font-family: 'Archivo Narrow', sans-serif;
font-weight:700;
}

.contact p{
margin-top:0px;
font-family: 'Archivo Narrow', sans-serif;
font-weight:300;
}

.label{
height:33px;
width:420px;
padding-left:10px;
margin-bottom:10px;
}

.label h2{
font-family: 'Archivo Narrow', sans-serif;
color:#fff;
text-shadow:1px 1px #555;
}

.res_cont p{
font-family: 'Archivo Narrow', sans-serif;
color:#555;
margin-left:25px;
}

.res_cont span{
font-style:italic;
color:#999;
}

#objective_label{
background-color:#4F8AFF;
}

#rs_label{
background-color:#CC0000;
}

#about_label{
background-color:#00CC66;
}

#education_label{
background-color:#FF6633;
}

#links_label{
background:#E4B434
}

#links_ul li{
font-family: 'Archivo Narrow', sans-serif;
color:#666;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:20:28.530

z-index 应该是一个数值，就像`z-index: 2;`你使用单位**px**一样。去掉它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:20:44.883

末尾附加“px”的 z-index 值将不起作用。只需将这些值更改为整数。尝试删除 px 看看是否有帮助。

```
z-index: 1 
```

代替

```
z-index: 1px 
```

# javascript - 如何在 ember-data 模型上进行通用发现后劫持承诺解决方案？

> ID：14717063
> 
> 赞同：3
> 
> 时间：2013-02-05T21:16:38.283
> 
> 标签：javascript, ember.js, ember-data, promise

我需要手动检查从基本查找返回的 ember-data 模型（此模型未绑定到模板，而是我需要动态应用一些逻辑）

到目前为止，我已经尝试了以下（没有运气）

```
App.Foo.find().then(function(model) {
  console.log("here with the ember-data payload");
  console.log(model.get('length'));
}, function(error) {
  console.log("broken");
}); 
```

成功块确实会触发，但它似乎总是返回 0 结果，但是当我在 chrome 中查看网络选项卡时，它显示了一个有效的 json 有效负载，该有效负载在我正在使用的这个承诺挂钩之外工作。

是否可以使用 ember-data rev 11 劫持承诺解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T10:03:28.380

模型的`App.Foo.find()`返回列表，即 a `DS.AdapterPopulatedRecordArray`，它*不是*数组，因此没有*长度*属性。但它有一个*内容*属性，即模型数组。因此，在您的示例中，您应该使用`console.log(model.content.length);`它来使其工作：

```
App.Foo.find().then(function(result) {
  console.log("here with the ember-data payload");
  console.log(result.content.length);
  console.log(result.objectAt(0));
}, function(error) {
  console.log("broken");
}); 
```

请注意，您不能在 上使用`[]`运算符`DS.AdapterPopulatedRecordArray`，因为它不是数组。请参阅[DS 上的 Ember 指南](http://emberjs.com/guides/models/the-rest-adapter/)。您应该`objectAt`改用：`result.objectAt(0);`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T10:27:46.937

`App.Model.find().then(function(notes) {console.log(notes.content.length)})` 为我返回 5，这是我的应用程序的正确返回值。

我认为您的语法是正确的，尽管您的服务器返回的数据可能存在问题？也许无论出于何种原因，它都没有序列化为实际记录。可能值得仔细检查。

# solr - 具有一个索引的多个词频向量

> ID：14717067
> 
> 赞同：0
> 
> 时间：2013-02-05T21:16:41.707
> 
> 标签：solr, lucene, elasticsearch

我有一个包含许多不同文档类型的应用程序。每种类型都有自己的语料库，我不希望它们相互影响。

例如，如果一种类型包含多次出现的术语 X，那么我不希望这会降低 X 在其他类型中的 IDF 分数。

我知道这可以使用多个索引来实现，但我有很多类型，其中一些包含少量文档。因此，每种类型的索引都会对性能产生不良影响。

有什么方法可以让每种类型都有一个唯一的术语向量和一个索引？

我还没有选择任何搜索引擎实现，所以我会感谢 Elasticsearch 和/或 Solr 的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T03:57:40.980

您始终可以通过减少或消除其影响来调整 IDF。

您可以从[自定义相似性](http://wiki.apache.org/solr/SolrPlugins#Similarity)类开始。
这将允许您修改 IDF 计算。

检查[lucene DefaultSimilarity](http://svn.apache.org/repos/asf/lucene/dev/trunk/lucene/src/java/org/apache/lucene/search/similarities/DefaultSimilarity.java)类以供参考，这是实际的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T10:31:58.440

在 Elasticsearch 中，您需要将每种类型放在单独的索引中，以避免一种类型的术语向量影响另一种类型的术语向量。

默认情况下，Elasticsearch 为每个新索引分配 5 个主分片（其中每个分片是一个 Lucene 实例）。对于较小的类型，您可以只使用一个主分片创建索引：

```
curl -XPUT 'http://127.0.0.1:9200/user/?pretty=1'  -d '
{
   "settings" : {
      "number_of_shards" : 1
   }
}
' 
```

## 更新

关于你关于性能的问题。搜索在每个涉及的分片上并行进行，因此性能实际上取决于您拥有多少硬件以及您的分片有多大（当然还有您的查询有多复杂）。

如果不测试您的用例和数据，很难准确估计多个索引对性能的影响。也就是说，ES 是为分布式搜索而构建的，并且在这种情况下表现得非常好。

## 更新 2

`name`同一索引中不同类型的字段将包含该字段中所有类型的术语，从而污染您的术语频率。

但是，您可能会尝试的一种方法是仅在不同类型中使用不同的字段名称，例如，而不是使用字段`name`for `user`and `product`，使用`user_name`and `product_name`。然后，术语频率将与该类型中的该字段相关。文档频率显然会考虑所有文档，但看到这是一个全局效应，它不应该有所作为。

# c++ - QT点击事件内的第一次机会异常访问冲突写入位置

> ID：14717070
> 
> 赞同：0
> 
> 时间：2013-02-05T21:16:53.020
> 
> 标签：c++, qt, exception

我有同一个应用程序的 2 个版本，在使用图形 UI 和 QT 的版本中，我有一个运行时错误：

```
first-chance exception  access violation writing location 
```

指

```
this->secondi_totali = someint; 
```

在模型方法中启动。我的模型类是：

```
class Model {

public:

friend class Controller; //dico che controller può accedere alle cose private
//friend class cronometro_qt;

/*costruttore*/
Model();

void set(int,int,int);
int get_secondi();
int get_minuti();
int get_ore();
void tick();

private:
int secondi_totali;
int secondi_trascorsi;

int secondi;
int minuti;
int ore;

}; 
```

导致异常的方法是这样的：

```
void crono::Model::set(int ore, int minuti, int secondi) {
this->secondi_totali =  ore * 3600 + 60 * minuti + secondi;
this->secondi_trascorsi = 0;
 } 
```

并在堆栈中从此方法调用：

```
void crono::Controller::set(int ore, int minuti, int secondi) {

this->modello->set(ore, minuti, secondi);

} 
```

this->modello 显然是一个指向 Controller 项内的 Model 对象的指针。

正如我之前所说，我已经完成了我的程序的 2 个版本。

首先，控制器的 set() 方法被一个空类视图的简单方法调用。

在第二个版本中，控制器的 set() 方法由

```
void crono::cronometro_qt::on_pushButton_clicked() { /* ... */ } 
```

方法。

显然，在这两个版本中，空视图或 cronometro_qt （ QMainWindow 的子类）都有一个指向控制器的指针，以便像这样调用 set() 方法：

```
this->controller->set(ore,minuti, secondi); 
```

那么为什么 QT 版本会抛出这个异常呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T10:18:08.493

在初始化变量之前进入应用程序的事件循环 (a.exec())。exec() 在应用程序退出之前不会返回。将初始化移到 a.exec() 上方。

# git - 将 Git 存储库放入 Git 存储库中的目录

> ID：14717074
> 
> 赞同：3
> 
> 时间：2013-02-05T21:16:59.683
> 
> 标签：git, github, symlink

我在 github 中找到了一个存储库，该存储库已进入其他 gits 存储库的目录（作为符号链接）。

但我不知道如何制作这种“符号链接”。

[Kivutar/twinsisters/tree/master/libs](https://github.com/Kivutar/twinsisters/tree/master/libs)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T21:19:09.837

它们被称为**子模块**。请参阅[Git Book 中的这一章](http://git-scm.com/book/en/Git-Tools-Submodules)或`man git-submodule`了解有关它们的更多信息。

# matlab - 从计算中提取术语

> ID：14717084
> 
> 赞同：0
> 
> 时间：2013-02-05T21:17:34.283
> 
> 标签：matlab, complex-numbers, expansion

如果你有一个字符串（来自计算..），比如`a1E¹+a2E²+a3E³`哪里`E^i=exp(i*k*τ)`有办法只提取术语 for `E^i`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T02:43:25.367

假设您的字符串被调用`s`，它看起来像这样：

```
s = 'a1 * exp(k*t) + a2 * exp(2*k*t) + a3 * exp( 3 * k * t ) + ...'; 
```

（我不得不推断一下......你的问题相当不完整）。

您可以使用表达式匹配来查找您所追求的组件。首先请注意，`+`符号仅出现在术语之间；我们可以使用该`strtok`函数在这些点上拆分它。a1 是数字还是变量都没有关系 - 只要它不是包含“+”号的表达式。如果确实如此...见下文。如果你需要第 n 个术语，你会说

```
remain = s;
for ii=1:n
  [tok remain] = strtok( remain, '+'); % split on the '+' sign, return text after in remain
end 
```

在这个循环结束时，`tok`包含表达式的第 n 部分，即

```
an * exp( n * k * t ) 
```

`exp`现在，您通过搜索该字符串在之前的部分拆分它：

```
sf = strfind( tok, 'exp' ); % returns the starting index of the string 'exp'
myFactor = tok(1:(sf(1)-1));   % returns the bit before 'exp' 
```

这应该是你的答案......如果我理解你的问题。如果我不明白你的问题，这完全是胡言乱语。

免责声明：没有方便的 matlab 来运行/测试代码；潜在的错误/偏移/反转的参数等。应该很容易修复。

附录：如果`an`术语包含`+`符号，则必须将字符串拆分为“exp”而不是`+`符号-该`strfind`函数实际上将返回一个匹配数组，因此

```
sf = strfind( mystring, 'exp' ); 
```

将返回所有“exp”子字符串的起点数组。你也许可以从那里得到它——但正如我上面所说，如果没有关于你的字符串格式的更多细节，很难给出一个通用的解决方案......

# iphone - 如何获得枚举计数

> ID：14717095
> 
> 赞同：15
> 
> 时间：2013-02-05T21:18:13.940
> 
> 标签：iphone, ipad

如何获得枚举计数

我有一个枚举

```
typedef enum{

DEL_TIME_VALUE    = -1,
DEL_TIMESEC_VALUE = 100,
DEL_TIMEMIN_VALUE = 200,
DEL_TIMEHOUR_VALUE = 300,
DEL_DAY_VALUE      = 1000,
DEL_COUNT_VALUE    = 1000,
....
.....
.....
DEL_END             =90002
}WORKINGTIME; 
```

我如何获得枚举计数。

我在下面尝试循环！

```
for(int i=DEL_TIME_VALUE; i<=DEL_END; i++) {

} 
```

估计不是什么好东西！

谁能告诉我如何获得枚举计数！在枚举中声明。

提前致谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-02-05T21:22:29.783

你不能。

有一种技术可以让您获得枚举计数。看起来像

```
typedef enum {
    value_one,
    value_two,
    value_three,
    ...
    enum_count
} my_enum; 
```

现在该值`enum_count`是枚举中值的计数。但是，此技术仅在枚举都带有其*隐含*值时才有效，其中`value_one`is `0`，`value_two`is`1`等。因此，枚举中的最后一个值始终具有枚举值计数的值。在您的情况下，您的枚举常量具有非单调递增的*显式*值。无法从这种类型的枚举中获取计数。即使在理论上你可以得出一个计数，这也无济于事，因为你无法得出给定枚举常数的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T21:22:13.193

an 的值`enum`是编译时常量，不可用于代码中的自省。

相反，您可以查看`enum`使用 Objective-C 实现自定义类（类似于 Java 类型安全枚举[http://docs.oracle.com/javase/1.5.0/docs/guide/language/enums.html](http://docs.oracle.com/javase/1.5.0/docs/guide/language/enums.html)）。

# php - $_COOKIE 安全

> ID：14717096
> 
> 赞同：0
> 
> 时间：2013-02-05T21:18:19.877
> 
> 标签：php, setcookie

所以我刚刚在我正在处理的开发项目上创建登录脚本时发现了一个很大的“不可以”。

在为 user_ID 和加密密码设置 cookie 时，我注意到通过 Google Chrome（或 Mozilla Firefox）上的简单扩展，我能够将用户 ID cookie 编辑为另一个用户的用户 ID，并访问该站点就像我是他们一样。

是否有人对我需要采取的路线有任何指示，以免发生这种情况？如果需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:23:22.160

如果您不费心在服务器上验证它，为什么要存储加密密码？如果用户发送的用户 ID 但密码不匹配，则不应允许他们访问该站点。

在任何情况下，您都应该使用`$_SESSION`变量来保存登录详细信息等信息。这样，用户只能看到会话 ID。虽然理论上可以猜测其他人的会话 ID（或窃取它 - 会话劫持），但您可以添加额外的层，例如要求用户代理和 IP 地址保持不变 - 这取决于需要多少安全性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:24:37.270

如果您需要让人们登录的时间长于浏览器会话，您应该将用户数据等内容存储在数据库中，然后创建一个与数据库行 ID 匹配的 cookie。仅供参考，不要使用自动递增的 ID

# ruby-on-rails - rails 代码在控制台而不是在控制器中工作

> ID：14717097
> 
> 赞同：0
> 
> 时间：2013-02-05T21:18:24.957
> 
> 标签：ruby-on-rails, rails-activerecord

我一直在寻找几天，但就是找不到发生了什么。我的代码在 Rails 控制台中测试时运行良好，但在控制器中它拒绝创建数据库条目。

我使用的模型是：

```
class Project < ActiveRecord::Base
  attr_accessible :name, :user_id

  belongs_to :user
  has_many :active_data_sets
  has_many :data_sets, :through => :active_data_sets  
end

class DataSet < ActiveRecord::Base
  attr_accessible :name, :project_id, :filename, :tempfilename

  has_many :active_data_sets
  has_many :projects, :through => :active_data_sets
end

class ActiveDataSet < ActiveRecord::Base
  attr_accessible :active, :data_set_id, :project_id

  belongs_to :project
  belongs_to :dataset  
end 
```

我在我的视图中使用了 form_tag，因为在稍后阶段我想上传一个文件，这不是模型的一部分。我发现 form_tag 在那一点上不起作用。表单的调用网址是：

```
http://localhost:3000/data_sets/new?project_id=1 
```

和观点：

```
<h1>DataSets#new</h1>
<p>Find me in app/views/data_sets/new.html.erb</p>
<%= form_tag import_data_sets_path do %>
    <%= hidden_field_tag 'project_id', params[:project_id] %>
    <p>
        dataset name:
        <%= text_field_tag :name %>
    </p>
    <p>
        <%= submit_tag "Create Dataset" %>
    </p>

<% end %> 
```

在控制器的创建方法中，我有以下代码

```
 def create
    @dataset = DataSet.new
    @dataset.active_data_sets.build(:project_id => params[:project_id].to_i)
    @dataset.name = params[:name]
    @dataset.save
  end 
```

这不会导致在数据库中创建条目当我在 rails 控制台中输入以下代码时，我最终会在数据库中输入正确的条目：

```
dataset = DataSet.new
dataset.active_data_sets.build(:project_id => 1)
dataset.name = 'name'
dataset.save 
```

我认为 hidden_​​field_tag 将所有数据作为字符串返回，这就是我添加 .to_i 的原因，但这似乎也没有奏效。

希望有人看到我没有看到的问题。

谢谢阅读。

# github - 如何重命名根存储库文件夹？

> ID：14717101
> 
> 赞同：2
> 
> 时间：2013-02-05T21:18:51.537
> 
> 标签：github

我需要重命名根存储库文件夹，例如：我应该使用“git mv”吗`github.com/Org/projectX`？`github.com/Org/projectY`或者这只能通过克隆和创建一个新的来完成`projectY`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T21:20:44.877

Github 提供了在“设置”下重命名存储库的选项。在 github 上重命名项目后，您可以再次克隆它。

# node.js - 在 Jade/Node 中使用“包含”时出现重复导航

> ID：14717102
> 
> 赞同：0
> 
> 时间：2013-02-05T21:18:54.417
> 
> 标签：node.js, pug

我有一个我想保留的单页网站，但我还需要将各个部分视为独立页面。我将 Jade 与 Node 一起使用，一切正常，直到我开始包含文件/块。

*base.jade*

```
!!! 5
  head
  body
    .nav
      // menu
    block content 
```

*索引.jade*

```
extends layout/base

block content
  p
   | This is the index page.
  include about 
```

*关于.jade*

```
extends layout/base

block content
  p
   | This is the about page. 
```

我要做的是使用索引页面来显示我的所有页面，然后让各个页面扩展`base.jade`文件。发生的事情是我打开了多个导航栏，`index.jade`因为我要扩展`base.jade`两次。我有点卡住了，觉得我在这里错过了一些简单的东西。

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:18:41.723

您包含的文件应该只有内容部分，例如

about-content.jade

```
p
   | This is the something about the site. 
```

然后 index.jade 是

```
extends layout/base

block content
  p
   | This is the index page.
  include about-content 
```

还有关于.jade

```
extends layout/base

block content
  p
   | This is the about page.
  include about-content 
```

# mysql - Heroku Node.js 应用程序无法启动

> ID：14717103
> 
> 赞同：0
> 
> 时间：2013-02-05T21:18:55.080
> 
> 标签：mysql, node.js, heroku, express, amazon-rds

我一直在开发我的第一个 Node.js 应用程序（实际上，为了好玩和练习，我将一些旧代码移到 Node 上）并且正在尝试将它托管在 Heroku 上。

我已经能够获得应用程序，因为它使用工头在本地流畅地运行，但是每当我将应用程序部署到 Heroku 时，它就会启动，但无法提供查询。我做了一些研究，找不到任何具体的东西，*但在我看来，Heroku 没有正确安装几个模块*？

MySQL 数据库托管在 Amazon RDS 中，我已经按照并重新检查了步骤、访问权限和安全异常，似乎没有问题。

我正在使用在我的 package.json 中定义的以下模块：

```
{
 "name": "AppName",
 "version": "0.0.1",
 "dependencies": {
   "express": "2.5.x",
   "jade": "0.28.1",
   "stylus": "0.32.0",
   "mysql": "2.0.0-alpha7",
   "string": "1.2.*",
   "sanitizer": "0.0.*",
   "validator": "0.4.8"
 },
 "engines": {
 "node": "0.8.*",
 "npm": "1.*.*"
 }
} 
```

在我的应用文件顶部调用：

```
var express = require('express');
var crypto = require('crypto');
var S = require('string');
var mysql = require('mysql');
var sanitizer = require('sanitizer');
var check = require('validator').check,
sanitize = require('validator').sanitize; 
```

错误信息如下：

```
TypeError: Cannot call method 'query' of undefined
at pool.getConnection.app.get.connection.query.res.render.global_title (/app/web.js:40:14)
at callbacks (/app/node_modules/express/lib/router/index.js:272:11)
at param (/app/node_modules/express/lib/router/index.js:246:11)
at pass (/app/node_modules/express/lib/router/index.js:253:5)
at Router._dispatch (/app/node_modules/express/lib/router/index.js:280:5)
at Object.middleware [as handle] (/app/node_modules/express/lib/router/index.js:45:10)
at next (/app/node_modules/express/node_modules/connect/lib/http.js:204:15)
at Object.stylus (/app/node_modules/stylus/lib/middleware.js:181:7)
at next (/app/node_modules/express/node_modules/connect/lib/http.js:204:15)
at Object.methodOverride [as handle]     (/app/node_modules/express/node_modules/connect/lib/middleware/methodOverride.js:35:5) 
```

以及失败的代码段：

```
pool.getConnection(function(err, connection) {

app.get('/', function(req, res){

    connection.query('QUERY_HERE', function(err, rows, fields) {
      if (err) throw console.log(err);

      res.render('index', {
        global_title: S(site_title).stripTags().s,
        title: S(rows[0].title).stripTags().s,
        bodytext: sanitize(sanitizer.sanitize(rows[0].content)).xss()
      });

      connection.end();

    });
});
//end connection
}); 
```

这是 Heroku 在浏览器或日志中给我的唯一错误，构建它似乎没有任何问题。

我在这里有点不知所措，所以希望有人能准确指出我在哪里是个白痴，并在我求助于 Heroku 之前让我滚滚！

提前致谢。

**更新：**

使用 Pascal Belloncle 建议的代码更改来捕获日志中的错误会在浏览器中产生应用程序错误，并在日志中显示以下内容：

```
 connection.query(QUERY, function(err, row
 at Handshake.Sequence.end (/app/node_modules/mysql/lib/protocol/sequences/Sequence.js:66:24)
 at Protocol.handleNetworkError (/app/node_modules/mysql/lib/protocol/Protocol.js:230:14)
 at Socket.EventEmitter.emit (events.js:126:20)
 at Socket._destroy.self.errorEmitted (net.js:328:14)
 TypeError: Cannot call method 'query' of undefined
 at process.startup.processNextTick.process._tickCallback (node.js:244:9)
 at Handshake.Pool.getConnection [as _callback] (/app/node_modules/mysql/lib/Pool.js:35:9)
 at Connection._handleNetworkError (/app/node_modules/mysql/lib/Connection.js:145:18)
 at /app/web.js:40:15 
```

似乎仍然在同一点崩溃，没有有用的错误。

**更新 2：**

一条错误信息！

```
2013-02-06T06:32:57+00:00 heroku[router]: at=error code=H13 desc="Connection closed without response" method=GET path=/ host=trash-media.herokuapp.com fwd=31.3.253.10 dyno=web.1 queue=0ms wait=0ms connect=4ms service=21033ms status=503 bytes=0 
```

[https://devcenter.heroku.com/articles/error-codes#h13-connection-closed-without-response](https://devcenter.heroku.com/articles/error-codes#h13-connection-closed-without-response)

**更新 3：**

在看到来自更新 2 的错误消息并对 RDS 中的安全设置进行了一些摆弄之后，这现在看起来与托管 Heroku 的位置（美国西部）和我的 RDS 数据库所在的位置（欧盟）之间的可用区差异有关-西方）。我已经在 Heroku 的支持下提出了这个问题，如果我得到一个答案，我会用一个答案来结束这个问题，并希望有一个可行的解决方案或解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:10:15.483

检查第一行 err 的值。如果连接未定义，很可能是因为您有错误。

另外，您应该在每个请求上获得一个新连接，然后返回到池中。

```
app.get('/', function(req, res){
  pool.getConnection(function(err, connection) {
    if (err) {
      console.error("getConnection", err);
    }
    // do stuff here
    connection.end(); // return connection to the pool
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:27:27.020

我正在结束这个问题，因为这个问题现在似乎与 AWS 中 Heroku 应用程序所在位置（美国）和 RDS 所在位置（欧洲）之间的可用区差异有关。

尽管按照 RDS 开发人员工具演练中的建议更改了区域，但 Heroku 仍然无法与我的 RDS 交互。

解决方法是更改​​ RDS 数据库的安全组策略以允许所有连接：

```
0.0.0.0/0 
```

或者将数据库移动到美国可用区。

不太理想。

我现在已经等待了四天，等待 Heroku 支持的回复以及任何其他建议，所以如果他们回来，我会将它们添加到这个答案中。

# c# - 不减慢任务循环，并知道何时返回结果

> ID：14717106
> 
> 赞同：2
> 
> 时间：2013-02-05T21:19:02.380
> 
> 标签：c#, task-parallel-library

```
Task<string> RunList(int client)
{
    return pages[client];
}

private async void Form1_DoubleClick(object sender, EventArgs e)
{
    for (int x = 0; x < listBox1.Items.Count; x++)
    {
        RunList(x);
    }
} 
```

这将通过任务循环，但是你怎么知道结果什么时候都在不影响循环速度的情况下呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T21:23:46.700

您可以`await`根据结果`WhenAll`来确保代码中的所有任务都已在该点完成。（重要的是不要在`WaitAll`这里使用，这会阻塞 UI 线程。）

```
private async void Form1_DoubleClick(object sender, EventArgs e)
{
    var tasks = new List<Task<string>>();
    for (int x = 0; x < listBox1.Items.Count; x++)
    {
        tasks.Add(RunList(x));
    }
    await Task.WhenAll(tasks);
} 
```

这里的基本思想是在调用它们之前简单地启动任务`await`。这是一个只有两个任务的简单示例：

```
await Task.Delay(1000);
await Task.Delay(1000); 
```

这将执行第一个任务，*然后*执行第二个任务。

```
var task1 =  Task.Delay(1000);
var task2 =  Task.Delay(1000);

await task1;
await task2; 
```

这将启动两个任务，然后在两个任务完成后继续，然后允许同时运行。

# jasper-reports - 如何控制 Jasper Reports 如何组合时间序列中单个值的数据？

> ID：14717109
> 
> 赞同：1
> 
> 时间：2013-02-05T21:19:10.237
> 
> 标签：jasper-reports, jfreechart

我有一个时间序列，我想：

a) 默认情况下，了解 Jasper Reports（或 JFreeChart）如何将我的数据合并为图表上的单个点

和

b) 能够改变组合的执行方式

例如，假设我每秒有一次数据样本，并且我的时间序列配置为“分钟”。这意味着对于图表上显示的每个值，我都有 60 条真实数据。我希望能够控制映射的完成方式（例如平均值、最大值等）。

我四处寻找有关如何查看默认值或修改绘图工作方式的文档，但我找不到任何东西。也许我的搜索词（图表、时间序列等）过于笼统。

# python - python将数据库结果与字符串进行比较

> ID：14717113
> 
> 赞同：0
> 
> 时间：2013-02-05T21:19:13.657
> 
> 标签：python, sql

我正在尝试将 MSSQL (pyodbc) 查询的输出与看似相似的字符串元组进行比较，python 一直告诉我它们不匹配。

```
def test_internship_direct_app_a_submit(self):

    address_result = SQLHelper.address_result("""
    select top 2 blah, blah, blah
            """ ) 
    print address_result[0]
    print type(address_result[0])
    print address_result[0] == ('1819 Harras Blvd', '', 'Atlantic City', 'NJ', '08401') 
```

* * *

控制台输出：(u'1819 Harras Blvd', u'', u'Atlantic City', 'NJ', u'08401')

输入“pyodbc.Row”

错误的

* * *

**问题：**如何操作数据库的输出，以便轻松地将其与元组中的字符串列表进行比较？提前致谢

哦，这是我用来获取数据的python代码：

```
def address_result(sql, param1):
cnxn = pyodbc.connect(connect_string)
cursor = cnxn.cursor()

params = (param1)
cursor.execute(sql ,params)
rows = cursor.fetchall()

addresses= []
for row in rows:
    addresses.append(row)

cursor.close()
cnxn.close()
return addresses 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:32:54.960

问题是从数据库返回的对象是 pyodbc.Row 类型而不是真正的元组。

将此添加到测试脚本的末尾并获得启发：

```
print tuple(address_result[0]) == ('1819 Harras Blvd', '', 'Atlantic City', 'NJ', '08401') 
```

# node.js - 同步 Jake Node.js 任务

> ID：14717119
> 
> 赞同：1
> 
> 时间：2013-02-05T21:19:21.383
> 
> 标签：node.js, asynchronous, jake

将两个模型添加到数据库后，有人可以帮我关闭数据库吗？我试过阅读

[http://howtonode.org/intro-to-jake](http://howtonode.org/intro-to-jake)

[Node.js 和 Jake - 如何在任务中同步调用系统命令？](https://stackoverflow.com/questions/6755819/node-js-and-jake-how-to-call-system-commands-synchronously-within-a-task)

以及 [https://github.com/mde/jake上的 github 自述文件](https://github.com/mde/jake)

但似乎仍然无法弄清楚。这是自述文件的摘录

*所有任务运行后的清理，jake 'complete' 事件 基本的 'jake' 对象是一个 EventEmitter，并在运行所有任务后触发一个 'complete' 事件。当任务启动一个保持节点事件循环运行的进程（例如，数据库连接）时，这有时很有用。如果您知道要在所有任务完成后停止正在运行的 Node 进程，您可以为“完成”事件设置一个侦听器，如下所示：*

```
jake.addListener('complete', function () {
  process.exit();
}); 
```

就像现在一样，它甚至在打开连接之前就关闭了连接。

```
// db connect
var db = require('./schema');

desc('Seed MongoDB with initial data');
task('seed', [], function () {

    //******* Populate the database
    var user1 = new db.userModel({ email: 'x@x.com', password: 'x', phone: x });
    user1.save(function(err) {
        if(err) {
            console.log(err);
        } else {
            console.log('user: '+user1.email +' saved');
        }
    });
    var user2 = new db.userModel({ email: 'x', password: 'x', phone: x });
    user2.save(function(err) {
        if(err) {
            console.log(err);
        } else {
            console.log('user: '+user2.email +' saved');
        }
    });

    db.mongoose.connection.close();
    console.log('Closed mongodb connection');
}); 
```

**编辑：** 我能够使用 parseq 模块中的并行流来完成我的目标。

```
par(
  function() {
    fs.readFile("file1", this);
  },
function() {
  fs.readFile("file2", this);
},
function done(err, results) {
  ...
}
); 
```

**Edit2：** 所以我真的很感谢所有的帮助。我还看到你是 parseq 的维护者 :)。谢谢！我仍在为最后一点苦苦挣扎，当函数 5 完成时，我的函数挂起并且没有调用 done()。我确定我错误地调用了“this”。有什么建议吗？

```
seq(
    function f1() {
        var user = new db.userModel({ email: 'x'
                        , password: 'x'
                        , phone: x });
        user.save(this);
    }, 
    function f2(err, value) {
        var user = new db.userModel({ email: 'x'
                        , password: 'x'
                        , phone: x });
        user.save(this);
    }, 
    function f3(err, value) {
        var merchant = new db.merchantModel({ name: 'x'
                        , logourl: 'x' });
        merchant.save(this);
    }, 
    function f4(err, value) {
        var merchant = new db.merchantModel({ name: 'x'
                        , logourl: 'x' });
        merchant.save(this);
    }, 
    function f5(err, value) {
        db.merchantModel.findOne({ name: 'x' }, function(err, merchant) {
            var coupon = new db.couponModel({ merchant_id: merchant.id
                            , name: 'x'
                            , imageurl: 'x'
                            , expiration: Date.UTC(2013,3,15) });
                            //, expiration: new Date(2013,3,15) }); //alternate date creation method
            coupon.save(this);
        });
    }, 
    function done(err) {
        if(err) {
            console.log(err);
        } else {
            console.log('successfully seeded db');
        }
        db.mongoose.connection.close();
        console.log('Closed mongodb connection');
    }
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:43:46.213

您需要`db.mongoose.connection.close`在两个保存功能完成后调用。最简单的方法是嵌套保存调用（但不是最漂亮的）。

```
var user1 = new db.userModel({ email: 'x@x.com', password: 'x', phone: x });
user1.save(function(err) {
    if(err) {
        console.log(err);
    } else {
        console.log('user: '+user1.email +' saved');
    }
    var user2 = new db.userModel({ email: 'x', password: 'x', phone: x });
    user2.save(function(err) {
        if(err) {
            console.log(err);
        } else {
            console.log('user: '+user2.email +' saved');
        }
        db.mongoose.connection.close();
        console.log('Closed mongodb connection');
    });
}); 
```

然后您应该开始研究流控制库以使您的代码更简单。

使用 parseq 做同样的事情：

```
var seq = require("parseq").seq;

seq(
  function f1() {
    var user1 = new db.userModel({ email: 'x@x.com', password: 'x', phone: x });
    user1.save(this);
  }, function f2(err, value) {
    var user2 = new db.userModel({ email: 'x', password: 'x', phone: x });
    user2.save(this);
  }, function done(err) {
    // check err here
    console.log('Closed mongodb connection');
  }
); 
```

有选择地忽略一些错误，下面是一个函数的样子：

```
function f1() {
    var self = this;
    var user1 = new db.userModel({ email: 'x@x.com', password: 'x', phone: x });
    user1.save(function(err) {
      if (err === SOMETHING_TO_IGNORE) {
        self(null);
      else {
        self(err);
      }
    });
  } 
```

# git - 列出 git merge commit 中所有修改过的文件——即使是快速转发的

> ID：14717120
> 
> 赞同：57
> 
> 时间：2013-02-05T21:19:23.160
> 
> 标签：git, merge, git-branch, git-merge

我在想是否有一种方法可以在我将一个分支合并到另一个分支时，所有更改的文件都列在我的提交消息中，而不仅仅是在两个分支中修改的文件。通过查看合并提交，这将使我更好地了解分支中的更改。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-02-05T21:23:42.983

我不知道如何在提交消息中做到这一点。但是在合并之后，这将给出受合并提交影响的所有文件的名称：

```
git log -m --name-only 
```

仅对于提交的文件名列表：

```
git log -m -1 --name-only --pretty="format:" <Merge SHA> 
```

由于合并有两个父级，因此存在一些空白，但可以轻松删除。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-05T21:28:55.043

您还可以使用该[`diff`](http://www.kernel.org/pub/software/scm/git/docs/git-diff.html)命令查看任意两次提交之间的差异。如果分支尚未合并，您可以指定分支名称并比较它们，否则您可能需要在它们重新合并之前找到它们分歧的位置*（[像这样](https://stackoverflow.com/questions/1527234/finding-a-branch-point-with-git)）以及最后一次提交。*

```
git diff --name-status <commit> <commit> 
```

> `-name-status`仅显示更改文件的名称和状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-10-22T11:59:40.117

假设你有你的合并提交的 SHA，那么 `git diff --name-only <SHA>^1 <SHA>`

# jira - 如何将 JIRA 子任务设为只读？

> ID：14717126
> 
> 赞同：1
> 
> 时间：2013-02-05T21:19:44.953
> 
> 标签：jira, jira-plugin

我想在父任务关闭时将子任务设为只读。子任务没有与之关联的典型工作流程 - 只是一个显示“不适用”的步骤。

我的想法是我会扩展 Closed 操作（无论是什么）并将 jira.issue.editable 属性设置为 false。这是否可能，如果可以，API 的哪些部分？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T08:00:32.060

一种简单的方法是攻击一个 post 函数来关闭父问题的转换，这会将子任务移动到锁定的转换。

要创建 post 函数，您可以使用[Script Runner](https://marketplace.atlassian.com/plugins/com.onresolve.jira.groovy.groovyrunner)或[Jira Scripting Suite](https://marketplace.atlassian.com/plugins/com.quisapps.jira.jss)。要为子任务添加锁定转换，请向其工作流添加新状态，并在工作流屏幕上将其设为只读，有关更多详细信息，请参阅[此答案](https://stackoverflow.com/questions/14616975/can-i-log-work-on-jira-issue-with-status-closed/14628044#https://stackoverflow.com/questions/14616975/can-i-log-work-on-jira-issue-with-status-closed/14628044#14628044)。

如果要在重新打开问题后恢复子任务状态，请在导致`close`父问题状态的后置脚本中，将其当前状态保存到子任务自定义字段中，然后再转换为锁定状态。然后根据自定义字段中保存的内容，将发布功能附加到父问题`re-open`转换，该功能会将子任务移回其原始状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T21:05:29.267

The answer turned out to be even simpler than I thought. I extended SimpleWorkflowAction which gets invoked when an issue is moved to closed. At that time, I set the Status of any children to closed. Voila, problem solved.

And yes, I asked on Atlassian as well!

# c# - 从foreach循环制作表格行？

> ID：14717129
> 
> 赞同：2
> 
> 时间：2013-02-05T21:20:00.227
> 
> 标签：c#, razor, asp.net-mvc-4

我已经坚持了一段时间了；我正在使用`ASP.NET` `MVC 4`and`C#`用于 Web 应用程序。我从我的控制器中读取了一个 Excel 文件，并且我有一个`List`发送回我的`view`. 这就是我正在使用的：

```
<table>
@foreach (var item in ViewBag.range)
{ 
    <tr>
    @for (int i = 0; i < 6; i++) 
    {
        <td>
            <input style="width:50px;" value=@item />
        </td>
    }
    </tr>
}
</table> 
```

基本上，我在`Excel`. 我正在尝试`Excel`在我的`view`. 但是我的有问题`for loop`，每个单元格执行 6 次。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:26:57.320

这样做是因为您在`for`循环中告诉它。也许你应该删除它。

```
<table>
 <tr>
  @foreach (var item in ViewBag.range)
  { 

    <td>
        <input style="width:50px;" value=@item />
    </td>

  }
 </tr>
</table> 
```

* * *

**编辑**

这会将内部的项目`range`放入每行有 6 列的行中。

```
@{
 int total = 0; 
}

<table>
  @foreach (var item in ViewBag.range)
  { 
    if( total % 6 == 0 ){
        @:<tr>
    }
    <td>
        <input style="width:50px;" value=@item />
    </td>
    if( total+1 % 7 == 0 ){
        @:</tr>
    }
    total++;
  }
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:30:35.067

由于我没有足够的关于范围的信息......我做了以下假设; 修改和使用它

```
 @{var counter=0}
    <table>
          <tr>
    @foreach (var item in ViewBag.range)
    { 
         counter++;
        <td>
            <input style="width:50px;" value=@item />
        </td>
         if(counter%6==0)
         {
           @:</tr>
            if(counter<ViewBag.range.Count)
            {
             @:<tr>
               }
         }

    }
    </table> 
```

# java - 在 Mule 中测试子流程

> ID：14717131
> 
> 赞同：6
> 
> 时间：2013-02-05T21:20:04.260
> 
> 标签：java, unit-testing, mule, functional-testing, flow

我已经开始为我的 Mule 项目编写测试用例。

我为我的主要流程编写了功能测试用例，如下所示。

```
public void testMainFlow_1() throws Exception{
     MuleClient client = muleContext.getClient();
            MuleMessage result = client.send(helloServiceAddress, fileAsString("SamplePayloads/input_Request.xml"), properties);
    assertNotNull("Null Result", result);           
    assertEquals(result.getPayloadAsString(), fileAsString("SampleResponses/sampleResponse.xml"));   

} 
```

但是我怎样才能测试我的子流程。他们没有任何终点。那么如何将有效负载传递给他们并对其进行测试。

下面给出的是我的流程配置。

```
<flow name="main_flow" >
    ....
    ....
    <flow-ref  name="subflow_1" />
    ....
    ....
    <flow-ref  name="subflow_2" />
    ....
    ....
</flow>

<sub-flow name="subflow_1">
    ....
    <some-transformer ... />
    <out-bound call to web-service />
    <some-transformer ... />
    ....
</sub-flow>

<sub-flow name="subflow_2">
    ....
    <some-transformer ... />
    <out-bound call to web-service />
    <some-transformer ... />
    ....
</sub-flow> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T22:33:13.190

使用`FunctionalTestCase`它应该很简单：

```
MessageProcessor subFlow = muleContext.getRegistry().lookupObject("subflow_1");
MuleEvent result = subFlow.process(getTestEvent("test_data")); 
```

但[它不起作用](http://www.mulesoft.org/jira/browse/MULE-6632)。

目前，IMO 的最佳方法是拥有一个测试配置，其中包含您要测试的子流程的流程包装器，并将此测试配置与您的主配置一起加载到`FunctionalTestCase`.

@genjosanzo 的方法也有效，但它基于将子流程与来自测试代码本身的预先存在的主流程相关联。我个人认为创建测试流程会更严格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-13T04:36:18.403

通过使用最新的 Mule 版本，我们可以使用以下脚本测试子流程：

```
SubflowInterceptingChainLifecycleWrapper subFlow = getSubFlow("subflowName");
subFlow.initialise();

MuleEvent event = subFlow.process(getTestEvent(""));
MuleMessage message = event.getMessage();

assertEquals(expect, message.getPayload()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T22:21:04.543

从测试用例调用子流非常简单，这是一个示例：

```
 @Test
    public void invokeSubFlow() throws Exception {
        MessageProcessor mp = (MessageProcessor) muleContext.getRegistry()
                .lookupObject("subflow_2");
        FlowConstruct parentFlow = muleContext.getRegistry().lookupFlowConstruct("main_flow");
        ((FlowConstructAware) mp).setFlowConstruct(muleContext.getRegistry()
                .lookupFlowConstruct("subflow_2"));
        Lifecycle lc = (Lifecycle) mp;
        lc.initialise();
        lc.start();
        MuleMessage muleMessage = new DefaultMuleMessage("test", muleContext);
        MuleEvent event = new DefaultMuleEvent(muleMessage,
                MessageExchangePattern.REQUEST_RESPONSE,
                new DefaultMuleSession(parentFlow,muleContext));

        mp.process(event);
    } 
```

# mysql - 如何在 MySQL 中合并多行？

> ID：14717134
> 
> 赞同：8
> 
> 时间：2013-02-05T21:20:15.680
> 
> 标签：mysql, sql

我在构建数据库时遇到了一些问题，我会问两个问题。

第一个问题：下表需要通过相同的ID合并

```
 ╔═════╦═══════╦═════╦═══════╗
 ║ id* ║ name  ║ age ║ grade ║
 ╠═════╬═══════╬═════╬═══════╣
 ║  0  ║ John  ║     ║       ║
 ║  0  ║       ║ 11  ║       ║
 ║  0  ║       ║     ║   6   ║
 ║  1  ║ Dave  ║     ║       ║
 ║  1  ║       ║ 12  ║       ║
 ║  1  ║       ║     ║   7   ║
 ╚═════╩═══════╩═════╩═══════╝ 
```

所以它应该是这样的；

```
 ╔═════╦═══════╦═════╦═══════╗
 ║ id* ║ name  ║ age ║ grade ║
 ╠═════╬═══════╬═════╬═══════╣
 ║  0  ║ John  ║ 11  ║   6   ║
 ║  0  ║ Dave  ║ 12  ║   7   ║
 ╚═════╩═══════╩═════╩═══════╝ 
```

注意：id* 不是 AUTO_INCREMENT

* * *

第二个问题：您可能认为以前的数据库结构很差。好消息是，我还没有创建数据库，我一直在寻找一种解决方案，可以在不删除旧信息的情况下将数据添加到现有行，但如果没有旧信​​息，它将创建一个新行。提前致谢。

## 第二个问题解释

处女桌

```
 ╔═════╦═══════╦═════╦═══════╗
 ║ id* ║ name  ║ age ║ grade ║
 ╠═════╬═══════╬═════╬═══════╣
 ║     ║       ║     ║       ║
 ╚═════╩═══════╩═════╩═══════╝ 
```

*一些 SQL 语句*

```
 ╔═════╦═══════╦═════╦═══════╗
 ║ id* ║ name  ║ age ║ grade ║
 ╠═════╬═══════╬═════╬═══════╣
 ║  0  ║ John  ║     ║       ║
 ╚═════╩═══════╩═════╩═══════╝ 
```

*相同的 SQL 语句具有不同的参数*

```
 ╔═════╦═══════╦═════╦═══════╗
 ║ id* ║ name  ║ age ║ grade ║
 ╠═════╬═══════╬═════╬═══════╣
 ║  0  ║ John  ║     ║       ║
 ║  1  ║ Dave  ║     ║       ║
 ╚═════╩═══════╩═════╩═══════╝ 
```

*另一个 SQL 语句*

```
 ╔═════╦═══════╦═════╦═══════╗
 ║ id* ║ name  ║ age ║ grade ║
 ╠═════╬═══════╬═════╬═══════╣
 ║  0  ║ John  ║     ║       ║
 ║  1  ║ Dave  ║ 12  ║       ║
 ╚═════╩═══════╩═════╩═══════╝ 
```

*另一个 SQL 语句*

```
 ╔═════╦═══════╦═════╦═══════╗
 ║ id* ║ name  ║ age ║ grade ║
 ╠═════╬═══════╬═════╬═══════╣
 ║  0  ║ John  ║     ║   6   ║
 ║  1  ║ Dave  ║ 12  ║       ║
 ╚═════╩═══════╩═════╩═══════╝ 
```

... 等等。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-05T21:22:31.547

您应该能够将聚合函数应用于所有列，然后`GROUP BY id`：

```
select id,
  max(name) name,
  max(age) age,
  max(grade) grade
from yourtable
group by id 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/f3b31/1)

就数据库结构而言，我看到的唯一问题是您正在为同一用户插入多条记录。您应该使用`UPDATE`语句来使用值而不是插入。

听起来您想[`REPLACE`](http://dev.mysql.com/doc/refman/5.0/en/replace.html)在 MySQL 中使用该函数（[这是一个教程](http://www.mysqltutorial.org/mysql-replace.aspx)）。

所以查询将与此类似：

```
REPLACE 
  INTO yourtable (`id`, `name`, `age`, `grade`) 
  VALUES (0, 'john', 11, null); 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/b0637/1)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T21:21:42.150

您可以按 分组`id`，并使用任何聚合函数来选择非空行。此示例使用`max`，但`min`也可以：

```
select  id
,       max(name) as name
,       max(age) as age
,       max(grade) as grade
from    YourTable
group by
        id 
```

# javascript - 三.js环境光意外效果

> ID：14717135
> 
> 赞同：5
> 
> 时间：2013-02-05T21:20:20.507
> 
> 标签：javascript, three.js, webgl

在下面的代码中，我渲染了一些立方体并使用 PointLight 和 AmbientLight 照亮它们。然而，当设置为 0xffffff 时，AmbientLight 会将两侧的颜色更改为白色，无论它们分配的颜色如何。奇怪的是，点光源按预期工作。

我怎样才能使环境光表现得像点光一样，因为它不应该洗掉面部颜色，而只是照亮它们？也就是说，将环境光设置为 0xffffff 相当于在对象周围拥有多个全强度的点光源。

```
$(function(){
    var camera, scene, renderer;
    var airplane;
    var fuselage;
    var tail;
    init();
    animate();

    function init() {
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera( 35, window.innerWidth / window.innerHeight, 0.1, 10000 );
        camera.position.z = 2;

        airplane = new THREE.Object3D();
        fuselage = newCube(
                {x: 1, y: 0.1, z: 0.1}, 
                {x: 0, y: 0, z: 0},
                [0xffff00, 0x808000, 0x0000ff, 0xff00000, 0xffffff, 0x808080],
                [0, 1, 2, 3, 4, 5]
        );
        airplane.add(fuselage);
        tail = newCube(
                {x: 0.15, y: 0.2, z: 0.05}, 
                {x: 0.5, y: 0.199, z: 0},
                [0xffff00, 0x808000, 0x0000ff, 0xff00000, 0xffffff, 0x808080],
                [0, 1, 2, 3, 4, 5]
        );
        airplane.add(tail);
        scene.add( airplane );

        var ambientLight = new THREE.AmbientLight(0xffffff);
        scene.add(ambientLight);        

        var pointLight = new THREE.PointLight(0x888888);
        pointLight.position.x = 100;
        pointLight.position.y = 100;
        pointLight.position.z = 100;
        scene.add(pointLight);      

        renderer = new THREE.WebGLRenderer();
        renderer.setClearColorHex(0x000000, 1);
        renderer.setSize( window.innerWidth, window.innerHeight );
        document.body.appendChild( renderer.domElement );
    }

    function animate() {
        requestAnimationFrame( animate );
        render();
    }
    function render() {
        airplane.rotation.x += 0.005;
        airplane.rotation.y += 0.01;
        renderer.render( scene, camera );
    }
});

function newCube(dims, pos, cols, colAss){
    var mesh;
    var geometry;
    var materials = [];
    geometry = new THREE.CubeGeometry( dims.x, dims.y, dims.z );
    for (var i in cols){
        materials[i] = new THREE.MeshLambertMaterial( { color: cols[i], overdraw: true } );
    }
    geometry.materials = materials;
    for (var i in colAss){
        geometry.faces[i].materialIndex = colAss[i];
    }
    mesh = new THREE.Mesh( geometry, new THREE.MeshFaceMaterial( materials ) );
    mesh.position = pos;
    return mesh;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T21:53:56.297

编辑 - three.js API 已更改；`material.ambient`已被弃用。

* * *

解决方案是将环境光的强度设置为合理的值。

```
var ambientLight = new THREE.AmbientLight( 0xffffff, 0.2 ); 
```

更新到three.js r.84

# jquery - 将 jquery ajax 功能重新分配给被操纵的元素

> ID：14717140
> 
> 赞同：0
> 
> 时间：2013-02-05T21:20:30.623
> 
> 标签：jquery, ajax

我在 JS 中有一个名为 AssignAJAXEvents() 的函数，其设置如下：

```
function AssignAJAXEvents(containerSelector)
{
    containerSelector = containerSelector || 'body';

    $("input[type='submit']",containerSelector).filter('.ajax').unbind('click').bind('click',function(){
        var container = $(this).closest('*.lc');

        $.ajax({
            beforeSend: function(){ $(loading).show(); },
            timeout: 60000, // 60 seconds
            error: function() { },
            type: "POST",
            dataType: "html",
            data: post_data,
            url: "/ajax.php?Ajax&Page=" + page + "&" + action_name + "=" + action_value,
            success: function(data) {
                $(loading).hide();

                container.hide().replaceWith(data).show();

                AssignAJAXEvents(container);
            }
        });

        return false;
    });
}

jQuery(document).ready(function() {
    AssignAJAXEvents();
}); 
```

当页面最初加载时，函数将事件加载到“body”，这是整个元素。当 ajax 调用完成时，我只想将此事件加载到受影响的容器中。否则它会浪费已经分配的资源事件和整个“body”匹配的元素都会受到影响。

如何将此事件仅分配给新填充的容器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:51:23.987

```
function AssignAJAXEvents(containerSelector)
{
    containerSelector = containerSelector || 'body';

    $("input[type='submit']",containerSelector).filter('.ajax').one('click',function(){
    var container = $(this).closest('*.lc');
     $.ajax({
        beforeSend: function(){ $(loading).show(); },
        timeout: 60000, // 60 seconds
        error: function() { },
        type: "POST",
        dataType: "html",
        data: post_data,
        url: "/ajax.php?Ajax&Page=" + page + "&" + action_name + "=" + action_value,
        success: function(data) {
            $(loading).hide();
            container.hide().replaceWith(data).show();
            AssignAJAXEvents(container);
        }
    });

    return false;
    });
} 
```

# php - 电子邮件的正则表达式：密码 (PHP)

> ID：14717142
> 
> 赞同：-1
> 
> 时间：2013-02-05T21:20:32.323
> 
> 标签：php, regex, email, passwords

*我对正则表达式并不太陌生，但我只是认为我在阅读和理解它们方面比自己编写它们要好得多。无法让这个工作。*

**电子邮件：密码**

基本上，它需要验证一个电子邮件地址和一个任意长度的密码，用冒号隔开，周围有或没有空格。

密码绝对可以包含任何字符，包括冒号。电子邮件不能包含冒号，但据我所知，它们确实不能包含冒号。

真的：

*   Em@il.com:密码
*   Em@il.com : p@55w:rd
*   Em@il.co.uk :p@$ 字
*   Em@il.com: 密码

错误的：

*   Nomail.com:密码
*   名称@ailcom：密码
*   无邮箱：密码
*   E:m@il.com:密码

谢谢！

* * *

非常感谢FJ！[在他的帮助以及我通常使用的Markus Sipilä](http://www.markussipila.info/pub/emailvalidator.php?action=validate)的电子邮件验证的帮助下，它变成了这样：

```
^[a-z0-9,!#\$%&'\*\+/=\?\^_`\{\|}~-]+(\.[a-z0-9,!#\$%&'\*\+/=\?\^_`\{\|}~-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*\.([a-z]{2,})[ ]?:.*$ 
```

当然，当将 FJ 的代码 ([ ]?:.*) 添加到任何电子邮件验证字符串的末尾时，请记住，您可能必须摆脱行尾弓箭手。向其中添加“可选”部分，这意味着它可以留空 (^$) 或 (|) 跟随字符串，使得：

```
(^$|^[a-z0-9,!#\$%&'\*\+/=\?\^_`\{\|}~-]+(\.[a-z0-9,!#\$%&'\*\+/=\?\^_`\{\|}~-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*\.([a-z]{2,})[ ]?:.*$) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:29:57.627

取[一个好的正则表达式来匹配 email](http://www.regular-expressions.info/email.html)，然后添加`[ ]?:.*`到它的末尾（方括号不是必需的，但可以更容易地看到那里有一个空格）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T10:03:28.833

如果您假设电子邮件地址不能包含冒号，那么它很简单：

```
$string = 'Em@il.com:p@55w:rd';

$colon = strpos($string, ':');
$email = substr($string, 0, $colon);
$passw = substr($string, $colon + 1);

if ( ! filter_var($email, FILTER_VALIDATE_EMAIL)) {
    die('Invalid email address');
}
if (strlen($passw) < 8) { // For example
    die('Invalid password');
} 
```

使用正则表达式验证电子邮件地址几乎是不可能的。大多数时候，用于验证电子邮件地址的最先进的正则表达式可以完成这项工作，但它们是无法被生物维护甚至理解的怪物。

# php - PHP不转发重定向

> ID：14717156
> 
> 赞同：0
> 
> 时间：2013-02-05T21:21:33.663
> 
> 标签：php

我在检测包含来自数据库的链接的 http:// 和非 http:// 并基于它们引用用户时遇到了一些问题，这是代码；

```
$url = $_GET['short'];

$route_url = mysql_result(mysql_query('SELECT original_url FROM ' . DB_TABLE . ' WHERE short_url = "' . mysql_real_escape_string($url) . '"'));

mysql_query('UPDATE ' . DB_TABLE . ' SET refferals = refferals + 1 WHERE short_url = "' . mysql_real_escape_string($url) . '"');

if(preg_match("/^[a-zA-Z]+[:\/\/]+[A-Za-z0-9\-_]+\\.+[A-Za-z0-9\.\/%&=\?\-_]+$/i", $route_url)) { 
header('HTTP/1.1 301 Moved Permanently');
header('Location: ' . $route_url);
} else {
$protocol = "http://";
header('HTTP/1.1 301 Moved Permanently');
header('Location: ' . $protocol.$route_url);
}
mysql_close();
exit; 
```

有人可以告诉我我做错了什么以及如何解决它，因此 http:// 和非 http:// (google.com) 都可以使用重定向

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:44:15.787

正如@Supericy 建议的那样，从初始 URL 提交中删除 http:// 我添加了以下内容

```
function http($url) {
   $disallowed = array('http://', 'https://');
   foreach($disallowed as $d) {
      if(strpos($url, $d) === 0) {
         return str_replace($d, '', $url);
      }
   }
   return $url;
} 
```

现在路由工作得很好

# node.js - Node.JS：删除不必要的 MongoDB 文件

> ID：14717159
> 
> 赞同：0
> 
> 时间：2013-02-05T21:21:36.270
> 
> 标签：node.js, mongodb

我已经编写了一个 Node.JS 应用程序，我将很快以 RPM（RedHat 包管理器）的形式发布它，其中包含所有内容（Node、CSS、JS、MongoDB、Node 模块等）。总应用程序权重压缩后约 60MB，其中约 50MB 来自 MongoDB。我想减少最终装运的尺寸。

现在，就我而言，我的 Node.JS 应用程序仅显式执行`mongod`. 查看`mongodb-linux-i686-2.2.2/bin`目录，我看到大约十几个可执行文件，其中大部分重 10.3MB（这有点奇怪，这么多重 10.3MB），例如`bsondump`, `mongodump`, `mongoexport`, `mongofiles`,`mongoimport`等。

哪些 MongoDB 可执行文件在我的“标准”（单个数据库，没有分片，没什么花哨的）Node.JS 应用程序中运行？我可以为最终装运移除哪个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:57:53.277

创建您自己的 MongoDB 服务器分发版可能是不合法的。请参阅[http://www.mongodb.org/about/licensing/](http://www.mongodb.org/about/licensing/)，我也会直接询问[http://www.10gen.com](http://www.10gen.com)以获得澄清。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:21:42.940

在那种情况下，只需要 mongod 。

# c++ - 通过 C/++ 使用网站按钮控件

> ID：14717160
> 
> 赞同：-1
> 
> 时间：2013-02-05T21:21:39.123
> 
> 标签：c++, windows, google-chrome, web

我使用 www.jango.com 作为 PC 音乐播放器，并希望通过我的智能手机远程控制它。我有一个用于控制 PC 的服务器程序和一个作为客户端的应用程序。例如，我想使用服务器程序在 chrome webbrowser 中运行的 jango.com 中按下播放/暂停或快进按钮。

一种简单的方法是在 chrome 窗口中的指定位置模拟 Windows 鼠标单击。但它的缺点是它只有在 jango 选项卡处于活动状态时才会起作用，并且如果站点更改其布局并且可能由于许多其他原因当然会失败。

所以我正在考虑生成一种与浏览器相同的http请求，如果一个人真正点击按钮。或者以某种方式访问​​ html 元素

请考虑一下，虽然我有 C/++ 背景，但我缺乏任何 web/JS 编程技能，并且会尽可能地保持这种方式。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T06:13:07.900

解决方案是使用能够触发相关按钮的音乐播放器网站的用户脚本。比 websockets 可以用来在用户脚本和 c++ 服务器程序之间进行通信。

# php - 邮件功能和“激活”一词

> ID：14717161
> 
> 赞同：0
> 
> 时间：2013-02-05T21:21:39.487
> 
> 标签：php, email

php 中的邮件功能仅在我在消息中添加单词“激活”并且如果我删除该单词时该功能不起作用

```
 $to         ="$email";
        $from       ="mina nasser <mark@yahoo.com>";
        $subject    ="Login Password Generated";
        $message="<br />New Login  Password <br />
        activate Your New Password for our site is:<u>$temp_pass</u><br />";
        $headers     ="from:{$from}\r\n";
        $headers   .= "MIME-Version: 1.0\n";
        $headers   .= "Content-type: text/html; charset=iso-8859-1\r\n";
        mail($to, $subject, $message, $headers); 
```

请有人帮助我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:24:21.763

```
 $message='<br />New Login  Password <br />
    activate Your New Password for our site is:<u>$temp_pass</u><br />'; 
```

它应该用双引号来解析`$temp_pass`为变量

```
 $message="<br />New Login  Password <br />
    activate Your New Password for our site is:<u>{$temp_pass}</u><br />"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:31:57.677

1.  “不起作用”不能充分描述您的问题。错误信息是什么？它以什么方式不起作用？
2.  检查`mail()`是返回真还是假。
3.  如果属实，请检查您的邮件日志。
4.  如果邮件日志中没有任何内容，请检查您的垃圾邮件文件夹。
5.  如果您不使用 MIME/多部分消息，则不要设置 MIME 标头。
6.  设置日期标题。

    ```
    $headers .= 'Date: ' . date(DATE_RFC2822); 
    ```

# asp.net - .NET Control.ID 属性不一致

> ID：14717163
> 
> 赞同：0
> 
> 时间：2013-02-05T21:21:43.087
> 
> 标签：asp.net, vb.net

请看下面的代码：

```
Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim c1 As New CheckBox
        c1.ID = "Test1/" 'line 7
        PlaceHolder1.Controls.Add(c1)
    End Sub

    Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
        For Each c As Control In Page.Controls
            For Each d As Control In c.Controls
                For Each f As Control In d.Controls
                    For Each g As Control In f.Controls
                        For Each h As Control In g.Controls
                            If TypeOf h Is CheckBox Then
                                Dim cbox As New CheckBox
                                cbox = CType(h, CheckBox)
                                MsgBox(cbox.Checked) 'Line 20
                            End If
                        Next
                    Next
                Next
            Next
        Next
    End Sub
End Class 
```

default.aspx 页面上有一个占位符，名为：PlaceHolder1。第 20 行的 MessageBox 正在打印 True。请查看以下网页中的引用：http: [//msdn.microsoft.com/en-us/library/system.web.ui.control.id.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.control.id.aspx)

> “只有字母数字字符和下划线字符 (_) 的组合是此属性的有效值。包含空格或其他无效字符将导致 ASP.NET 页面解析器错误。”

/ 不是字母数字字符，那么消息框怎么打印为真呢？如果将第 7 行更改为 : `c1.ID = "Test1:"`，那么这会像我预期的那样打印为 false （因为 : （冒号）不是字母数字）。没有一致性。我错过了一些东西。

# ember.js - 提交后清除 Ember.TextField

> ID：14717165
> 
> 赞同：1
> 
> 时间：2013-02-05T21:21:48.983
> 
> 标签：ember.js

我正在一个小型示例应用程序上学习 ember.js，但最后一块我无法开始工作。

我有一个“俏皮话”（推文）列表，并且有一个文本输入字段允许创建一个新字段。提交新推文后，我想清除文本输入，但无济于事。在这一点上，我基本上逐字复制了[todomvc 示例](https://github.com/addyosmani/todomvc/tree/gh-pages/architecture-examples/emberjs)并且它在那里工作（我什至使用相同的 ember.js 和 ember-data.js 版本只是为了排除这种可能性）。

这是模板：

```
<script type="text/x-handlebars" data-template-name="index">
    <h2>Latest Quips</h2>
    <div>
            {{view Ember.TextField id="new-quip" placeholder="Enter your Quip"
            valueBinding="newQuip" action="createQuip"}}
    </div> 
```

相应控制器中的操作：

```
App.IndexController = Ember.ArrayController.extend({
  createQuip: function() {
    App.Quip.createRecord({
      text: this.get('newQuip'),
      user: 'ree'
    });
    this.set('newQuip', ''); // this row should clear the view
    this.get('store').commit();
  }
}); 
```

为了完整起见，模型：

```
App.Quip = DS.Model.extend({
  text: DS.attr('string'),
  user: DS.attr('string')
});

App.Store = DS.Store.extend({
    revision: 11,
    adapter: 'App.QuipsAdapter'
});

App.Quip.FIXTURES = [
    { id: 1, user: 'ree', text: 'Which is the best JS MVC?' },
    { id: 2, user: 'baaz', text: '@ree Definitely Ember.js!' }
];

App.QuipsAdapter = DS.FixtureAdapter.extend({}); 
```

该应用程序[在这里运行](http://reebalazs.github.com/quipper/src/index.html)。

如果有人能指出我做错了什么，我会非常高兴。

谢谢，

巴林特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:23:00.610

这是一个与 jQuery 1.9.0 相关的错误 - 尝试 v1.8.x

Also, as I can recall, it's been fixed on master, so grabbing the latest Ember release may also solve your problem.

# html - 为什么内部 div 的高度取决于容器的宽度？

> ID：14717173
> 
> 赞同：1
> 
> 时间：2013-02-05T21:22:12.117
> 
> 标签：html, css, height, margin, percentage

我已经看很久了，我不知道这里发生了什么。谁能给我一个提示，为什么会这样？Firefox、Chrome、IE 都有相同的结果。

在此示例中，容器的**宽度**设置为**1000px**，内部 div 溢出容器：http: [//jsfiddle.net/S65Hv/](http://jsfiddle.net/S65Hv/)

在这个例子中我只将容器的**宽度更改为****300px**，结果是内部项目的高度在容器内，没有溢出：http: [//jsfiddle.net/5EwTG/](http://jsfiddle.net/5EwTG/)

代码：

```
<style>
    .container {
        position: absolute; 
        top: 10px; 
        left: 10px; 
        width: 1000px; 
        height: 300px; 
        border: 1px solid grey;
    }

    .item {
        width: 48%;
        height: 48%;
        float: left;
        position: relative;
        margin: 1%;
    }

    .innerItem {
        border: 1px solid red;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
    }        
</style>    

<div class="container">
    <div class="item">
        <div class="innerItem">
        </div>        
    </div>        
    <div class="item">
        <div class="innerItem">
        </div>           
    </div>
    <div class="item">
        <div class="innerItem">
        </div>           
    </div>
    <div class="item">
        <div class="innerItem">
        </div>           
    </div>    
</div> 
```

内部 div 的高度以百分比表示，总和为 100%，包括边距。

据我所知，300px 高度的 100% 始终相同，并且应该与宽度无关。

这种行为是设计使然吗？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:29:34.513

这就是百分比利润率应该如何运作的方式。百分比边距基于宽度的百分比。

[http://www.w3.org/TR/CSS2/box.html](http://www.w3.org/TR/CSS2/box.html)

> 百分比是根据生成框的包含块的宽度计算的。请注意，“margin-top”和“margin-bottom”也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T21:30:25.120

当您声明它时，它会根据父元素的*宽度*`margin: 1%`设置所有 4 个边距。因此，在这种情况下，宽度会影响您的身高。

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:27:00.370

绝对定位元素不再与其父元素处于相同的布局上下文中。他们不知道他们的父项在哪里或有多大。

因此，您不能使用百分比单位并期望它们的大小与父项相关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T21:33:27.167

1% 的边距似乎是根据宽度设置的。您可以使用 js 计算边距，然后设置它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T21:34:44.393

您的边距正在影响内箱的溢出。有很多方法可以解决这个问题，但您可以调整边距并固定内部`div`容器的高度和宽度。这是一个固定的例子：

[http://jsfiddle.net/S65Hv/21/](http://jsfiddle.net/S65Hv/21/)

正如@Aaron 所说，您可以使用 JS 来帮助解决这个问题。*

# ajax - 处理由 Chrome 扩展程序引起的 AJAX Origin 错误

> ID：14717176
> 
> 赞同：0
> 
> 时间：2013-02-05T21:22:18.753
> 
> 标签：ajax, google-chrome, jquery, google-chrome-extension

有没有办法处理来自 Chrome 扩展的 AJAX Origin 错误？

> 拒绝加载 chrome-extension://kldbdjcbjohfhddpicldkbifbkcdanid/data.json。资源必须列在 web_accessible_resources 清单键中，才能被扩展之外的页面加载。

我试过这个：

```
$.ajax({
    url: 'chrome-extension://kldbdjcbjohfhddpicldkbifbkcdanid/data.json',
    datatype: 'json',
    success: function(xhr) {
        alert('ok');
    },
   erro r: function(xhr, status, err) {
        alert('status: ' + xhr.status + ' - ' + err);
    }
}); 
```

但在变量中什么也没有。错误状态为“0”，错误消息为空。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-11T11:37:32.843

听起来您正在尝试根据错误从内容脚本加载此资源。

您必须在清单中通过[`web_accessible_resources`](http://developer.chrome.com/extensions/manifest/web_accessible_resources). 您的错误消息指出这是解决方案。

完成此操作后，您可以使用[`chrome.extension.getURL(resourcePath)`](http://developer.chrome.com/extensions/extension.html#method-getURL).

这是我的清单的摘录：

```
"web_accessible_resources" : [
    "*.html"
] 
```

这是我用来请求我的 HTML 模板文件的代码：

```
var url = chrome.extension.getURL("template.html");
$.get(url,function(data, textStatus, jqXHR){
    console.log("Got the template!");
    console.log(data);
},"html"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:39:21.480

您可以尝试使用 jsonp 格式。这通常会绕过跨域错误。

```
$.ajax({
    url: 'chrome-extension://kldbdjcbjohfhddpicldkbifbkcdanid/data.json',
    datatype: 'jsonp',
    success: function(xhr) {
        alert('ok');
    },
   erro r: function(xhr, status, err) {
        alert('status: ' + xhr.status + ' - ' + err);
    }
}); 
```

# c# - DoDragDrop 干扰 bindingsource

> ID：14717177
> 
> 赞同：1
> 
> 时间：2013-02-05T21:22:21.213
> 
> 标签：c#, winforms

好的，我有一个代表数据集的绑定源。该 bindingsource 绑定到一个列表框。这完全符合预期，因为它填充了指定列中的所有名称。不是问题。

我有第二个列表框，绑定到不同的 bindingsource1，它本身绑定到 bindingsource1，但使用表示与数据集中不同表的关系之一的数据成员。这样做的结果是，当我单击第一个列表中的一个项目时，第二个列表会显示所有相关的内容。

这里没有什么新东西，也没有什么复杂的东西，它是非常标准的东西，并且完全按照预期工作。

但是，我正在尝试在第一个列表框上实现拖放功能。我为 mousedown 添加了一个事件处理程序。在这里面，我打电话

`DoDragDrop(current, DragDropEffects.Copy | DragDropEffects.Move);`

其中 current 设置为来自 的当前对象`bindingsource1.Current.Row["Name"]`。

现在，这就是它变得奇怪的地方。即使列表框本身已正确更新（因为突出显示新选择的项目，索引和项目都按预期返回，新选择的项目/索引） bindingsource1.Current 尚未更新，实际上，第二个列表框仍然显示与先前选择的项目相关的数据。

使用箭头键上下移动会导致列表框突出显示按预期更改，并且 listbox2 中的数据也会按预期更新。

注释掉 DoDragDrop 行，一切似乎都按预期工作。

由此我只能推断 DoDragDrop 以某种方式阻止某些事件触发，但我不知道为什么/如果这是所需的行为/如何肮脏地解决它/如何正确地解决它......

帮帮我欧比旺克诺比，你是我唯一的希望……

编辑：我已经创建了问题的简化实现：dropbox.com/s/qxfsvr28ftojdax/BindingDragDrop.zip 注释掉顶部更改的dodragdrop和标签，放入dodragdrop，它甚至没有注册...... ——</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T21:14:10.657

复制代码的荣誉。您可以通过为标签的 TextChanged 事件添加事件处理程序并在其上设置断点并注释掉 DoDragDrop 来诊断此问题。当您更改列表选择时，它会第二次中断，请查看调用堆栈。您会看到更新绑定列表的是*MouseUp 事件。*

当您在 MouseDown 事件中调用 DoDragDrop 时，这是一个问题。ListBox 的 MouseUp 事件将不再被触发，通知被 D+D 逻辑吞噬并取消拖动。一种可能的解决方法是显式更新绑定，这样您就不必依赖它自动发生。这有效：

```
private void listBox1_MouseDown(object sender, MouseEventArgs e)
{
    bindingSource1.Position = listBox1.SelectedIndex;
    DoDragDrop(new object(), DragDropEffects.Move);
} 
```

顺便说一句，像这样的问题是我从不在 Winforms 中使用数据绑定的原因......

# javascript - AngularJS 宁静路由

> ID：14717183
> 
> 赞同：8
> 
> 时间：2013-02-05T21:22:41.533
> 
> 标签：javascript, ruby-on-rails, angularjs, rest, url-routing

我正在尝试使用 Restful/Ruby convension 来构建我的应用程序`/<resource>/[method]/[id]`。我以前在使用像 CodeIgniter 这样的服务器端 MVC 框架时是如何根据 URI 动态路由的：

前任。

```
www.foo.com/bar/baz/1 
```

然后应用程序将使用`baz`控制器/类中的方法`bar`并返回`views/bar/baz.php`（填充来自 的数据`bar->baz`）

我想在 Angular 中做同样的事情，但我不确定它是否支持这一点（如果支持，我不确定该怎么做）。目前我正在使用`$routeProvider`'s`when`方法来指定每种情况。[$location.path()](http://docs.angularjs.org/api/ng.$route#Example)看起来它可能有我需要的东西，但我认为我不能在`app.js`(within `config()`) 中使用它。

我想做的是这样的：

```
.config([
  '$routeProvider', function($routeProvider) {
    $routeProvider
    .when(//<resource> controller exists
      resource+'/'+method, {
        "templateURL": "views/" + resource + "/" + method + ".html",
        "controller":  resource
      }
    ).otherwise({ "redirectTo":"/error" });
  }
]); 
```

并且路由器会自动调用相应的方法。

**编辑**另外，为什么[$routeProvider](http://docs.angularjs.org/api/ng.$routeProvider#Methods)在我指定时会发疯`when('/foo/bar', {…})`？

**编辑 2** Per Lee 的建议，我正在考虑做这样的事情：

```
$routeProvider
  .when(
    '/:resource/:method/:id', {
      "templateUrl": function(routeParams){
        var path = 'views/'+routeParams.resource+'/';
        return ( typeof routeParams.method === 'undefined' ) ?
          path+'index.html' : path+routeParams.method+'.html';
      },
      "controller": RESOURCE
  })
  .otherwise({redirectTo: '/error'}); 
```

[我在$routeProvider](http://docs.angularjs.org/api/ng.$routeProvider#Methods)的文档中注意到以下内容：

![来自 Dash 的屏幕截图。 全文如下](../Images/b4a57da4b4ff82fd0e95309026dbd223.png)

> *templateUrl* – {string=|function()=} – 返回 ngView 应该使用的 html 模板路径的路径或函数。
> 
> 如果*templateUrl*是一个函数，它将使用以下参数调用：
> 
> • {Array.<Object>} -通过应用当前路由从当前[$location.path()](http://docs.angularjs.org/api/ng.$route#Example)中提取的路由参数

**编辑**：设置`templateUrl`为函数的选项是不稳定的[1.1.2](http://code.angularjs.org/1.1.2/angular.js)版本的一部分：[#1963](https://github.com/angular/angular.js/issues/1963)（但它从 2013-02-07 起不起作用）。

有一个关于在 AngularJS 的 Github 上添加此功能的讨论：[#1193](https://github.com/angular/angular.js/pull/1193) [#1524](https://github.com/angular/angular.js/pull/1524)，但我不知道它是否实际实现（在上面引用的 Dash 的文档中，它看起来已经实现了，并且网站上的文档还没更新）。

**编辑 3**为了澄清我想要发生的事情（根据李的要求），简单来说，我想去`www.foo.com/index.html#/people`

Angular 应该使用控制器`people`，自动调用它的`index`方法，并且应该提供服务

> **./views/people/index.html**
> ./views/people/map.html

另外，如果我去`www.foo.com/index.html#/people/map`

Angular 应该`people`再次使用控制器，但这次会自动调用它的`map`方法并提供*…map.html*（因为在 url 中指定了地图）

> ./views/people/index.html
> **./views/people/map.html**

然后，如果我去

> www.foo.com/index.html#/widgets

Angular应该服务

> **./views/widgets/index.html**
> ./views/widgets/details.html

路由器的代码应该非常通用——我不应该`.when()`为每个路由指定一个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T05:54:50.997

多想这件事。对于那些通用的 CRUD/REST 类型的操作，您可以只使用一个控制器。然后使用资源和视图参数加载模板。

*   创造
    *   #/foo/create/0
    *   这有它自己的表单模板“/views/foo/create.html”和 0 操作系统只是一个占位符。
    *   在提交时，您将调用控制器 ng-click="save()" 上的方法，该方法将在 POST "/rest/foo" 处发布到服务器。
*   读
    *   #/foo/view/1
    *   同样，模板“/views/foo/view.html”只是数据的视图
    *   您可以使用 GET "/rest/foo/1" 调用服务方法从服务器获取数据
*   更新 -#/foo/edit/1
    *   可以使用与创建相同的模板，或者如果您愿意，可以使用不同的“/views/foo/edit.html”。
    *   还使用 GET "/rest/foo/1" 提取数据
    *   使用 PUT "/rest/foo/1" 提交数据
*   删除
    *   #/foo/删除/1
    *   服务方法将调用 DELETE "/rest/foo/1"
    *   我认为您不需要为此使用哈希，但您可以使用哈希，因为控制器实际上可以进行验证或任何您想要确认删除的操作。也许有一个名为“/views/foo/delete.html”的视图询问您是否要删除记录。然后，您可以在某个按钮上使用 ng-click="delete(itemid)" 通过 ajax 删除该项目。

所有这些都可以使用单个控制器/服务并动态生成服务和查看 url 来完成。

任何自定义的东西都需要自定义控制器以及自定义路由和服务方法。我可能可以举一个例子，但今晚不行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-06T03:40:02.083

[这是 github 上的一个项目，它做的事情接近你的要求](https://github.com/leeahoward/so-restful-routing/tree/master/app)

编辑：我发现了一些我以前没有想到的有趣的事情。如果您在路由中省略控制器，它将使用模板中指定的控制器。因此，只要您用于给定控制器的所有模板都具有 ng-controller="resource" ，那么它将按预期为模板加载该控制器。当然，当前的路由实现没有可选参数，因此如果您有两个或三个参数，则需要指定单独的路由。最大的问题是它似乎调用了两次控制器方法。我猜这是因为同一个控制器有两个视图。但是，一个视图应该替换另一个视图，因此不应该有两个调用。这对我来说似乎是一个错误。[https://github.com/angular-ui/router/issues?page=1&state=open](https://github.com/angular-ui/router/issues?page=1&state=open)。github 上的示例现在使用以下方法，因此您可以根据需要浏览它。

```
var restrouteApp = angular.module('restrouteApp', [])
  .config(['$routeProvider', function($routeProvider) {
    $routeProvider
      .when('/:ctrl/:method', {
        templateUrl: function(rp){
          if(!rp.method) {rp.method = 'index';}
          console.log('route one'); 
          return 'views/'+rp.ctrl+'/'+rp.method+'.html';
        }
      })
      .when('/:ctrl/:method/:id', {
        templateUrl: function(rp){
          if(!rp.method) {rp.method = 'index';}
          console.log('route two'); 
          return 'views/'+rp.ctrl+'/'+rp.method+'.html';
        }
      })
      .otherwise({
        redirectTo: '/resource1/'
      });
  }]); 
```

和模板：

```
<div ng-controller="resource1">
  <h1> resource1/one.html </h1>
  <div>{{r1data.selected}}</div>
</div> 
```

现在在您的控制器中，您可以执行此操作以动态调用该方法。

```
restrouteApp.controller('resource1', function($scope,$routeParams,$log,Resource1Service) {

  $log.info('new resource1');

  $scope.controllername = $routeParams.ctrl;
  $scope.r1data= Resource1Service.shared;

  $scope.index = function(){
    Resource1Service.index().then(function(){
      //when the service returns
    });
  }

  $scope.one = function(){
    $scope.r1data.selected = $scope.r1data.resources[0];
  }
  $scope.two= function(){
    $scope.r1data.selected = $scope.r1data.resources[1];
  }

  //call the specified method of this controller 
  $scope[$routeParams.method]();
}); 
```

/编辑

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-28T13:46:33.160

为了符合现有的路由系统（如 Rails），现在可以在路由中定义方法的能力。我创建了一个超级简单的解决方案，它允许路由根据路由定义和视图中的指令调用方法。我认为 ui-router 不是传统的，对于这样一个“应该是”的核心功能来说太复杂了。

该项目名为 ngMethod，位于：[https](https://github.com/jzumbrun/ng-method) ://github.com/jzumbrun/ng-method 。

它的使用示例是：[https ://github.com/jzumbrun/chrome-apps-angularjs-bootstrap](https://github.com/jzumbrun/chrome-apps-angularjs-bootstrap)

因此，如果我有这样的路线：

```
$routeProvider.
        when('/contacts/new', {
            controller: 'ContactsController',
            method: 'new',
            templateUrl: $configProvider.template('contacts/form.html'),
        });

    $routeProvider.
        when('/contacts/:id/edit', {
            controller: 'ContactsController',
            method: 'edit',
            templateUrl: $configProvider.template('contacts/form.html'),
        }); 
```

我在联系人/表单模板中有 ng-method：

```
<div class="col-lg-12" ng-method>
    <form role="form">
... 
```

然后 ng 方法将在 ContactsController 中调用 $scope.edit() 或 $scope.new()。可以共享联系人/表单模板，并根据路由调用正确的方法来加载数据。这种风格现在更像“Angularjs”，加载代码很像对模块和控制器的角度调用。

实现这一点的完整指令不到 20 行代码：

```
app.directive('ngMethod', ['$route', function($route) {
    return {
        // Restrict it to be an attribute in this case
        restrict: 'A',
        // responsible for registering DOM listeners as well as updating the DOM
        link: function(scope, element, attrs) {

            // Call method without params. Use $routeParams
            if(angular.isFunction(scope[attrs.ngMethod])){
                scope[attrs.ngMethod]();
            // default to the route method if attrs.ngMethod is empty
            } else if(angular.isObject($route.current) 
                && angular.isString($route.current['method']) 
                && angular.isFunction(scope[$route.current['method']])){
                scope[$route.current['method']]();
            }
        }
    };
}]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-11T19:36:56.787

现在可以使用[`ui-router`](https://github.com/angular-ui/ui-router)0.2.8：

```
$stateProvider
    .state('base', {
        url: '/:resource/:collection/:id',
        controllerProvider: function( $stateParams )
        {   // assuming app.controller('FooCtrl',[…])
            return $stateParams.collection + 'Ctrl';
        },
        templateUrl: function( $stateParams )
        {
            return '/partials/' + $stateParams.collection + '.html';
        }
    }); 
```

但是为了利用[`$state.includes()`](https://github.com/angular-ui/ui-router/wiki/Quick-Reference#wiki-stateincludesstatename--params)导航菜单，这可能会更好：

```
$stateProvider
    .state('base.RESOURCE_NAME1', {
        url: '/:collection/:id',
        controllerProvider: function( $stateParams )
        {   // assuming the convention FooCtrl
            return $stateParams.collection + 'Ctrl';
        },
        templateUrl: function( $stateParams )
        {
            return '/partials/' + $stateParams.collection + '.html';
        }
    }).state('base.RESOURCE_NAME2', {
        url: '/:collection/:id',
        controllerProvider: function( $stateParams )
        {   // assuming the convention FooCtrl
            return $stateParams.collection + 'Ctrl';
        },
        templateUrl: function( $stateParams )
        {
            return '/partials/' + $stateParams.collection + '.html';
        }
    }); 
```

上面可以通过循环来简化，以`state`从资源数组构建 s （*$stateProvider基本上支持*[随时](https://github.com/angular-ui/ui-router/wiki/Nested-States-%26-Nested-Views#wiki-registering-states-order)添加状态）：

```
var resources = [ 'r1', 'r2', '…' ];

for ( var r = resources.length-1; r >=0; r-- )
{
    var name = resources[r];
    $stateProvider.state('base.'+name, {
        …
    });
} 
```

**警告**ui-router 并不真正支持可选状态参数（[计划用于 v0.4](https://github.com/angular-ui/ui-router/issues/108)）

# apache - 将客户端证书从 Apache 转发到 Tomcat

> ID：14717185
> 
> 赞同：5
> 
> 时间：2013-02-05T21:22:59.540
> 
> 标签：apache, tomcat, spring-security, x509

我正在尝试将 x509 客户端证书（我的浏览器上安装了测试证书）从 Apache Web 服务器 (SSL) 传递到 Tomcat 应用程序。我现在配置它的方式，应用程序的弹簧安全没有找到（因此没有转发）证书。

```
DEBUG: [http-8080-1]  org.springframework.security.web.authentication.preauth.x509.X509AuthenticationFilter - No client certificate found in request. 
```

Apache服务器`ssl.conf`文件是这样配置的（我省略了不相关的部分）：

```
LoadModule ssl_module modules/mod_ssl.so

Listen 443

AddType application/x-x509-ca-cert .crt
AddType application/x-pkcs7-crl    .crl

NameVirtualHost *:443

<VirtualHost *:443>

    ...

    SSLVerifyClient require
    SSLVerifyDepth 2

    ...

    # initialize the SSL headers to a blank value to avoid http header forgeries
    RequestHeader set SSL_CLIENT_CERT ""
    RequestHeader set SSL_CLIENT_VERIFY ""

    # add whatever SSL_* variables needed to pass to web application
    RequestHeader set SSL_CLIENT_CERT "%{SSL_CLIENT_CERT}s"
    RequestHeader set SSL_CLIENT_VERIFY "%{SSL_CLIENT_VERIFY}s"

    RequestHeader add X-Forwarded-Scheme https

    ProxyPass /testcert http://127.0.0.1:8080/testcert
    ProxyPassReverse /testcert http://127.0.0.1:8080/testcert

</VirtualHost> 
```

有什么方法可以在 Apache 中配置它，将整个证书转发到 Tomcat 服务器？我知道我可以使用`ajp`，但试图在没有这种方法的情况下完成它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T22:40:12.880

如果您将证书作为标头传递，tomcat 不会自动意识到它，因为连接只是 HTTP 而不是 HTTPS。您不必将证书作为请求属性获取，而是必须从标头中提取并自行解析。

您可以覆盖中的[`getPreAuthenticationCredentials`方法`X509AuthenticationFilter`](https://github.com/SpringSource/spring-security/blob/master/web/src/main/java/org/springframework/security/web/authentication/preauth/x509/X509AuthenticationFilter.java#L25)。[这里](https://github.com/SpringSource/spring-security/blob/master/web/src/test/java/org/springframework/security/web/authentication/preauth/x509/X509TestUtils.java#L133)有一些代码显示了如何解码证书。

## 豆配置

您删除`<x509 />`命名空间元素并将其替换为等效的 bean。参考手册中有一个附录，它解释了 XML 元素创建的 bean。您的配置应如下所示：

```
<http entry-point-ref="http403">
    <custom-filter position="PRE_AUTH_FILTER" ref="x509Filter" />
</http>

<bean id="http403" class="org.springframework.security.web.authentication.Http403ForbiddenEntryPoint" />

<bean id="x509Filter" class="YourExtendedX509AuthenticaitonFilter" /> 
```

# c++ - 关于以 null 结尾的字符串（困惑）

> ID：14717187
> 
> 赞同：1
> 
> 时间：2013-02-05T21:23:10.197
> 
> 标签：c++, c

下面的着色器被称为一个字符串和一个以 null 结尾的字符串。

着色器：

```
const GLchar* VertexShader =
{
    "#version 330\n"\

    "layout(location=0) in vec4 in_Position;\n"\
    "layout(location=1) in vec4 in_Color;\n"\
    "out vec4 ex_Color;\n"\

    "void main(void)\n"\
    "{\n"\
    "   gl_Position = in_Position;\n"\
    "   ex_Color = in_Color;\n"\
    "}\n"
}; 
```

我的问题是：

1.  每行末尾的斜线是什么意思？此外，为什么最后一行没有斜线？
2.  shader中有几个字符串，为什么说shader只有一个字符串？
3.  为什么说它是一个以空字符结尾的字符串？（因为没有'\0'）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T21:25:58.833

> 每行末尾的斜线是什么意思？此外，为什么最后一行没有斜线？

续行，表示当前行在下一行继续。

> shader中有几个字符串，为什么说shader只有一个字符串？

连续的字符串文字被折叠成一个。就这样`"ab" "c"`变成了`"abc"`。

> 为什么说它是一个以空字符结尾的字符串？（因为没有'\0'）

字符串文字以 null 结尾。`"ab"`实际上也是如此`{'a', 'b', '\0'}`。请注意，当字符串文字被折叠时，除了最后一个隐式空终止字符之外的所有字符都将被删除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T21:28:04.763

只要有一个反斜杠 ( `\`) 后跟一个新行，这些字符就会被删除，将两行拼接在一起。这发生在翻译阶段的早期，甚​​至在执行预处理指令之前。这为您提供了物理源行和逻辑源行之间的区别。从逻辑上讲，代码等价于以下内容：

```
const GLchar* VertexShader =
{
  "#version 330\n" "layout(location=0) in vec4 in_Position;\n" "layout(location=1) in vec4 in_Color;\n" "out vec4 ex_Color;\n"
  "void main(void)\n" "{\n" "   gl_Position = in_Position;\n" "   ex_Color = in_Color;\n" "}\n"
}; 
```

但是，这里完全不需要这种线拼接。

稍后在翻译阶段（在执行预处理指令之后），连接任何相邻的字符串文字标记。也就是说，它们被连接起来，就好像它们只是一个字符串文字一样。上述代码中的所有字符串文字都将被连接起来（即使新行将它们分开）。

字符串文字总是为您提供一个比字符串文字大一个字符的数组，`const char`因为它`\0`在末尾添加了一个字符。也就是说，字符串文字总是给你一个以空值结尾的字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T21:27:36.320

> 每行末尾的斜线是什么意思？此外，为什么最后一行没有斜线？

它是一个行继续，在这里是多余的。

> shader中有几个字符串，为什么说shader只有一个字符串？

*来自String Literals*的 C99 标准部分：

> 在翻译阶段 6 中，由任何**相邻字符序列和宽字符串文字标记指定的多字节字符序列连接成单个多字节字符序列。**如果任何标记是宽字符串文字标记，则生成的多字节字符序列将被视为宽字符串文字；否则，它被视为字符串文字。

发布代码中的字符串文字被连接成单个字符串文字。

> 为什么说它是一个以空字符结尾的字符串？（因为没有'\0'）

来自 C99 标准的同一部分：

> 在翻译阶段 7 中，将一个字节或零值代码附加到每个由一个或多个字符串文字产生的多字节字符序列

一个空字符被添加到每个字符串文字（在连接之后）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T21:25:51.620

斜线是续行符号。它只是意味着这些行被连接在一行中。为了可读性，它是这样写的。想象一下，你有

```
"layout(location=0) in vec4 in_Position;\n" "layout(location=1) in vec4 in_Color;\n" "out vec4 ex_Color;\n"\ 
```

只有一个字符串，因为字符串文字在一个接一个地写入时会自动连接：

```
"abc" "xyz" 
```

相当于字符串`"abcxyz"`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-05T21:26:05.090

1.  表示转义以下字符，在这种情况下看起来是换行符；我认为这在这里是不必要的/无关的。
2.  它只是一个字符串 - 调用 printf(VertexShader[0]) 来尝试。
3.  当您声明一个 C 字符串时，会自动附加一个 \0。你没有手动指定这个，事实上如果你这样做了，我相信你会得到两个 \0 。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-05T21:26:33.070

反斜杠吃掉紧随其后的行尾字符。

例子

```
 "hello" \
 " world" 
```

是相同的

```
"hello" " world" 
```

顺便说一句，这与

```
"hello world" 
```

# php - 用两个不同的mysql命令制作php函数

> ID：14717194
> 
> 赞同：0
> 
> 时间：2013-02-05T21:23:33.200
> 
> 标签：php, pdo

我想创建一个函数，这样我就不会重复自己了。这是我当前的代码

```
 <?php

$targetpage = "index.php";  
$limit = 20;
    $sql1 = $db->prepare("SELECT * FROM classified ORDER BY date DESC");
/*** fetch Number of results ***/
$total_pages =$sql1->rowCount();
    $stages = 3;
$page = ($_GET['page']);
if($page){
    $start = ($page - 1) * $limit; 
}else{
    $start = 0; 
    }
    $sql = $db->prepare("SELECT * FROM classified ORDER BY date DESC LIMIT $start, 
   $limit  ")or die(print_r($sql->errorInfo(), true));
$sql->execute();
$result = $sql->fetchAll();
//Include pagination
 require_once("pagination.php");
 // pagination
echo $paginate;
foreach($result as $row){
$id = htmlentities($row['id'], ENT_QUOTES);
$id_city = htmlentities($row['id_city'], ENT_QUOTES);
$title = htmlentities($row['title'], ENT_QUOTES ,'utf-8');
 $querya = $db->prepare("SELECT * FROM city WHERE id = :id_city");
/*** bind the paramaters ***/
$querya->bindParam(':id_city', $id_city, PDO::PARAM_INT);
/*** execute the prepared statement ***/
$querya->execute();
/*** fetch the results ***/
$resultya = $querya->fetchAll();
    foreach($resultya as $rowa)
{
 $city_name = htmlentities($rowa['city'], ENT_QUOTES, 'utf-8');
 }
} 
?> 
```

现在我有另一个使用相同代码的文件，除了它在从数据库中检索数据时有一个条件。所以而不是：

```
 $sql1 = $db->prepare("SELECT * FROM classified ORDER BY date DESC");
  $sql = $db->prepare("SELECT * FROM classified ORDER BY date DESC LIMIT $start, 
  $limit  ")or die(print_r($sql->errorInfo(), true)); 
```

另一个文件：

```
 $sql1 = $db->prepare("SELECT * FROM classified where type = '1' ORDER BY date DESC");
 $sql = $db->prepare("SELECT * FROM classified where type = '1' ORDER BY date DESC 
 LIMIT $start, $limit  ")or die(print_r($sql->errorInfo(), true)); 
```

不同之处在于 type = 1

是否可以将所有这些组合在一个功能中？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-05T22:40:26.203

我在代码中添加了一些注释，这有意义吗？见下文：

```
<?php
/*
    $db - PDO object 
    $limit - number of listings to show on the page
    $page - page to show
    $where - the additional where condition to pass in
*/
function getItems($db=null,$limit=20,$page='',$where='') {
    // check if $db exists before doing anything
    if ($db) {
        $sql1 = $db->prepare("SELECT * FROM classified ORDER BY date DESC");
        /*** fetch Number of results ***/
        $total_pages =$sql1->rowCount();
            $stages = 3;
        if($page){
            $start = ($page - 1) * $limit; 
        }else{
            $start = 0; 
            }
            $sql = $db->prepare("SELECT * FROM classified $where ORDER BY date DESC LIMIT $start, 
           $limit  ")or die(print_r($sql->errorInfo(), true));
        $sql->execute();
        $result = $sql->fetchAll();
    } else {
        // I return an empty array here so that if something should fail $result will still be populated with an array
        return array();
    }
}

$targetpage = "index.php";  

$result = getItems($db,20,$_GET['page'],'where type = "1"');

//Include pagination
 require_once("pagination.php");
 // pagination
echo $paginate;

foreach($result as $row){
    $id = htmlentities($row['id'], ENT_QUOTES);
    $id_city = htmlentities($row['id_city'], ENT_QUOTES);
    $title = htmlentities($row['title'], ENT_QUOTES ,'utf-8');
     $querya = $db->prepare("SELECT * FROM city WHERE id = :id_city");
    /*** bind the paramaters ***/
    $querya->bindParam(':id_city', $id_city, PDO::PARAM_INT);
    /*** execute the prepared statement ***/
    $querya->execute();
    /*** fetch the results ***/
    $resultya = $querya->fetchAll();
     foreach ($resultya as $rowa) {
        $city_name = htmlentities($rowa['city'], ENT_QUOTES, 'utf-8');
     }
} 
?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T21:29:07.770

是的。有一个文件，然后向它发送一个 POST 或 GET 来告诉页面是否 type==1。

例子

```
if ($_GET['t']==1){ $type = "WHERE type = '1'"; }else{ $type = ""; }

$sql1 = $db->prepare("SELECT * FROM classified " . $type . " ORDER BY date DESC");
$sql = $db->prepare("SELECT * FROM classified " . $type . " ORDER BY date DESC 
LIMIT $start, $limit  ")or die(print_r($sql->errorInfo(), true)); 
```

如果您使用 page.php?t=1 调用列出的页面，那么它将把 where 语句放在那里。如果你只是调用 page.php，它不会放任何东西。

# python - 将二进制数据从 python 2.7 获取到 C 模块的正确方法是什么

> ID：14717200
> 
> 赞同：1
> 
> 时间：2013-02-05T21:23:52.747
> 
> 标签：python, python-2.7, python-c-extension

我正在从 python 文件中读取二进制数据并尝试将该数据发送到 ac 模块。在python中，数据是这样读取的

```
file = open("data", "rb")
data = file.read() 
```

如果可能，我希望将数据作为指向缓冲区的指针和 c 中的长度。我正在使用 PyArg_ParseTuple 来获取 c 模块中的参数。我注意到在 python 3+ 中有二进制数据的 ay/y*/y# 格式说明符，但我需要在 python 2.7 中使用等效的方法。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:43:14.807

您应该调查[Buffer Api](http://docs.python.org/2/c-api/buffer.html)。

从文档：

> 对象可以使用这些函数以原始的、面向字节的格式公开其数据。对象的客户端可以使用缓冲区接口直接访问对象数据，无需先复制。
> 
> 支持缓冲区接口的两个对象示例是字符串和数组。字符串对象以缓冲区接口的面向字节的形式公开字符内容。数组也可以公开其内容，但需要注意的是，数组元素可能是多字节值。

例如（在 C++ 中）：

```
void* ExtractBuffer(PyObject* bufferInterfaceObject, Py_buffer& bufferStruct)
{
    if (PyObject_GetBuffer(bufferInterfaceObject, &bufferStruct, PyBUF_SIMPLE) == -1)
        return 0;

    return (void*)bufferStruct.buf;
} 
```

不要忘记在不再需要时释放 bufferStruct：

```
PyBuffer_Release(&bufferStruct); 
```

# sql - 如何将一个行项目复制到另一行

> ID：14717201
> 
> 赞同：-3
> 
> 时间：2013-02-05T21:23:57.387
> 
> 标签：sql, sql-server-2008

我有下表：

```
Student_ID  Description 
1       0x
2       0x1G800....
3       0x1F800.... 
```

Student_ID 1 有空值我如何使用 sql 查询将 student_ID 2 的值复制到 1 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:28:37.897

这就是你要找的全部吗？

```
Update Student
SET Description = (SELECT Description FROM Student WHERE Student_ID = 2)
WHERE Student_ID = 1 
```

或使用`JOIN`：

```
UPDATE S 
SET S.Description = S2.Description
FROM Student S JOIN
    Student S2 ON S2.Student_ID = 2
WHERE S.Student_Id = 1 
```

祝你好运。

# visual-studio-2010 - Visual Studio 2010下NVIDIA Tools Extension的使用

> ID：14717203
> 
> 赞同：2
> 
> 时间：2013-02-05T21:24:11.177
> 
> 标签：visual-studio-2010, cuda, profiling, gpgpu, nvidia

我正在尝试使用 NVIDIA 工具扩展来使用 Visual Profiler 对 CUDA 代码执行更准确的性能评估。我正在使用 Visual Studio 2010 来开发代码。

要为此功能设置 Visual Studio 2010，我添加了

```
Properties -> Linker -> General -> Additional Library Directories -> $(NVTOOLSEXT_PATH)\lib\$(Platform);

Properties -> Linker -> General -> Input -> Additional Dependencies -> nvToolsExt32_1.lib; 
```

但是，当我使用

```
#include <nvToolsExt> 
```

编译器说

```
Error   1   error C1083: Cannot open include file: 'nvToolsExt': No such file or directory 
```

环境变量`NVTOOLSEXT_PATH`设置为

```
NVTOOLSEXT_PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\nvToolsExt\ 
```

但我的系统上不存在该目录`C:\Program Files\NVIDIA GPU Computing Toolkit\nvToolsExt\`，因此我认为未安装 NVIDIA 工具扩展。

我有两个问题：

1) 上述为 NVIDIA 工具扩展功能设置 Visual Studio 2010 的过程是否正确？2）如何安装工具？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T01:09:17.640

在**Visual Studio 2.2 的 Nsight 用户指南 \ [NVIDIA 工具扩展库](http://http.developer.nvidia.com/NsightVisualStudio/2.2/Documentation/UserGuide/HTML/Content/NVTX_Library.htm)\ 第 5 节。将 NVTX 添加到项目**中具有以下说明：

> NVTX API 由 NVIDIA Nsight “主机”安装程序（默认）安装到以下位置：
> 
> 在 32 位系统上：C:\Program Files\NVIDIA GPU Computing Toolkit\nvToolsExt
> 
> 在 64 位系统上：C:\Program Files (x86)\NVIDIA GPU Computing Toolkit\nvToolsExt
> 
> 头文件和库文件本身（.lib、.dll）都位于此路径下。
> 
> 默认情况下，NVIDIA Nsight 安装程序将设置环境变量 NVTOOLSEXT_PATH 以指向与系统位匹配的上述位置。
> 
> 5.1 C++项目
> 
> 为了在 Visual Studio 中使用 NVTX 支持编译您的项目，请使用以下步骤相应地设置您的项目：
> 
> 1.  打开项目属性对话框。
> 2.  导航到配置 > 属性 > C/C++ > 常规。将以下路径添加到附加包含目录：$(NVTOOLSEXT_PATH)\include
> 3.  导航到配置属性 > 链接器 > 常规。将以下路径添加到附加库目录：$(NVTOOLSEXT_PATH)\lib\$(Platform)
> 4.  导航到配置 > 属性 > 链接器 > 输入。将 nvToolsExt32_1.lib 或 nvToolsExt64_1.lib（根据您的系统规范）添加到 Additional Dependencies。
> 
> 5.2 CUDA（.cu 文件）
> 
> 如果您使用 NVTX 注释 .cu 文件中的代码，还请确保设置了以下配置（这是上一节中讨论的步骤的补充）：
> 
> 1.  打开项目属性对话框。导航到配置属性 > CUDA C/C++ > 通用。> 将以下路径添加到
> 2.  其他包含目录：$(NVTOOLSEXT_PATH)\include

在问题中，您已跳过将 NVTX 添加到附加包含路径的步骤 5.1.2。如果没有更新的包含路径，编译器将无法找到 NvToolsExt.h。

第 5.3 节和第 5.4 节建议将 NVTX 库移动到您的源代码树中（与使用默认位置相比）并添加部署到步骤以将 DLL 复制到项目 bin 目录。

# java - 使用 Eclipse 的奇怪错误

> ID：14717208
> 
> 赞同：0
> 
> 时间：2013-02-05T21:24:24.930
> 
> 标签：java

我正在做一个家庭作业，其中一个球使用左、右、上和下按钮在屏幕上移动。此外，使用绿色和红色按钮更改球的颜色。出于某种原因，我的听众给了我错误“Btns.RightListener 无法解析为一种类型”。我不确定为什么。

任何帮助，将不胜感激。

这是我目前所拥有的......

主类：

```
import javax.swing.*;

@SuppressWarnings("serial")
public class Lab2Main extends JFrame {

        Lab2Main()
    {
        setTitle("Lab 2 - Move The Ball");
        Lab2 p = new Lab2();
        add(p);
    }

    public static void main (String[] args) { 

        Lab2 frame = new Lab2();
        frame.setTitle("Lab 2 - Move The Ball");
        frame.setSize(450, 500);
        frame.setLocationRelativeTo(null);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);

    }   

} 
```

类持有听众：

```
import javax.swing.*; 
import java.awt.*;

@SuppressWarnings("serial")
public class Lab2 extends JFrame { 

    Btns canvas = new Btns();
    JPanel panel = new JPanel();

    JButton jbtL = new JButton("Left");
    JButton jbtR = new JButton("Right");
    JButton jbtU = new JButton("Up");
    JButton jbtD = new JButton("Down");
    JButton jbtRd = new JButton("Red");
    JButton jbtG = new JButton("Green");

    Lab2()
        {
        setLayout(new BorderLayout());

        panel.add(jbtR);
        panel.add(jbtL);
        panel.add(jbtU);
        panel.add(jbtD);
        panel.add(jbtRd);
        panel.add(jbtG);

        this.add(canvas, BorderLayout.CENTER);
        this.add(panel, BorderLayout.SOUTH);

        jbtL.addActionListener(new Btns.LeftListener(canvas));
        jbtR.addActionListener(new Btns.RightListener(canvas));
        jbtU.addActionListener(new Btns.UpListener(canvas));
        jbtD.addActionListener(new Btns.DownListener(canvas));
        jbtRd.addActionListener(new Btns.RdColorChangeListener(canvas));
        jbtG.addActionListener(new Btns.GColorChangeListener(canvas));
        }
} 
```

拿着按钮的班级：

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JPanel;

@SuppressWarnings("serial")
public class  Btns extends JPanel
{
    int radius = 5;
    int x = -1;
    int y = -1;

        protected void paintComponent(Graphics g) {
            if (x < 0 || y < 0)
            {
                x = getWidth() / 2 -radius;
                y = getHeight() / 2 -radius;
            }
            super.paintComponent(g);
            g.setColor(Color.RED);
            g.fillOval(5,10,25,25);
    } 
    public void moveLeft()
    { 

             x -= 5; 
             this.repaint(); 
        } 

        public void moveRight()
        { 

            x += 5; 
            this.repaint(); 
        } 
        public void moveUp()
        { 

            y -= 5; 
            this.repaint(); 
        } 

        public void moveDown()
        { 
            y += 5; 
            this.repaint(); 
        } 

        public class LeftListener implements ActionListener
        { 
            private Btns canvas; 

            LeftListener(Btns canvas) 
            { 
              this.canvas = canvas; 
            } 

             public void actionPerformed(ActionEvent e)
            { 
             canvas.moveLeft(); 
            } 

        public class RightListener implements ActionListener
        { 
            private Btns canvas; 

            RightListener(Btns canvas) 
            { 
                this.canvas = canvas; 
            } 

            public void actionPerformed(ActionEvent e)
            { 
              canvas.moveRight(); 
            } 
        } 

         class UpListener implements ActionListener
         { 
            private Btns canvas; 

            UpListener(Btns canvas) 
            { 
                this.canvas = canvas; 
            } 

            public void actionPerformed(ActionEvent e)
            { 
                canvas.moveUp(); 
            } 
        } 

        class DownListener implements ActionListener
        { 
            private Btns canvas; 

            DownListener(Btns canvas) 
            { 
                this.canvas = canvas; 
            } 

            public void actionPerformed(ActionEvent e)
            { 
             canvas.moveDown(); 
            } 
        }

        class RdColorChangeListener implements ActionListener 
            { 
            private Btns canvas; 

            RdColorChangeListener(Btns canvas) { 
                this.canvas = canvas; 
            } 
            public void actionPerformed(ActionEvent e){ 
                canvas.setColor(Color.RED); 
                repaint();
            } 

        class GColorChangeListener implements ActionListener 
            { 
            private Btns canvas; 

            GColorChangeListener(Btns canvas) { 
                this.canvas = canvas; 
            } 
            public void actionPerformed(ActionEvent e){ 
                canvas.setColor(Color.GREEN); 
                repaint();
            } 
       }
    }
  }

        public void setColor(Color red) {
        // TODO Auto-generated method stub

        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:28:07.653

需要将类`Btns.RightListener`（实际上是 的所有内部类`Btns`）声明为`static`类，以便像您一样创建新实例。只需将`static`修饰符添加到每个类声明即可。否则，您将需要执行以下操作：

```
jbtL.addActionListener(canvas.new Btns.LeftListener(canvas)); 
```

哦，正如@antlersoft 指出的那样，您需要更正类嵌套。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T21:28:19.120

您在 Btns.LeftListener 上缺少一个结束 }，因此 Eclipse 认为 RightListener 位于 LeftListener 内部。

# java - 将 json 对象传递给 play-framework 动作

> ID：14717210
> 
> 赞同：2
> 
> 时间：2013-02-05T21:24:35.023
> 
> 标签：java, ajax, json, playframework, playframework-1.x

我目前正在使用 Play v1.2.3。我有一个端点，我想向该端点发送一个 json 对象，该对象将被反序列化为 Java 对象。所以，我有一些看起来像这样的东西：

```
public class UserController extends Controller {

  public static class FullName {
    public String first;
    public String last;
  }

  public static void putName( FullName name ) { ... }
}

##### routes
PUT /user/name    UserController.putName 
```

有了这个，我希望用给定的javascript调用端点：

```
$.ajax({
  type: "PUT",
  data: { first: "Michael", last: "Bailey" },
  url: "/user/name"
}); 
```

不幸的是，通过上述设置，play 似乎不想发送整个数据对象，而是尝试填充两个参数（第一个和最后一个）。有没有办法定义端点直接消费完整的身体，还是必须手动完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:43:10.137

Play 的 action 方法参数绑定机制不接受 JSON。您需要手动绑定它。在您的示例中，代码可能类似于：

```
public static void putName( String data ) { 
   FullName fname = new Gson().fromJSON(data, FullName.class);
   ...
} 
```

请注意，Gson 提供了 play!framework 分发，因此您可以自由使用它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T05:37:59.030

要将整个输入主体转换为 Model 类：

```
public static void create(JsonObject body) {
    CaseFolder caseFolder = new Gson().fromJson(body, CaseFolder.class);
    caseFolder.user = getConnectedUser();

    if(caseFolder.validateAndSave()) {
        renderJSON(
                new JSONSerializer()
                    .exclude("*.class")
                    .exclude("user")
                    .serialize(caseFolder));
    } else 
        error();
} 
```

此外，上面的代码采用生成的模型对象并将其序列化回 JSON 作为响应主体。

如果您只想访问 JSON 请求中的某些字段，可以使用：

```
public static void update(JsonObject body) {
    try {
        Long id = (long) body.get("id").getAsInt();
        CaseFolder cf  = CaseFolder.loadAndVerifyOwner(getConnectedUser(), id);
        cf.number = body.get("number").getAsString();
        cf.description = body.get("description").getAsString();
        if(cf.validateAndSave())
            ok();
        else
            error();
    }
    catch (NullIdException      e) {error();} 
    catch (NotFoundException    e) {notFound();} 
    catch (NotOwnerException    e) {forbidden();}
    catch (Exception            e) {e.printStackTrace(); error();}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T07:40:43.327

通过您的设置，play 期望名称为“name.first”和“name.last”的参数，而您发送的是“first”和“last”。试试这个 ajax 帖子

```
$.ajax({
  type: "PUT",
  data: { 
    name: {
      first: "Michael",
      last: "Bailey" 
    }
  },
  url: "/user/name"
}); 
```

# c# - 我应该如何在这样的解析 HTML 上应用 CSS 选择器？

> ID：14717213
> 
> 赞同：0
> 
> 时间：2013-02-05T21:24:37.190
> 
> 标签：c#, dom, css-selectors

我正在尝试在 HTML 源中应用 CSS 选择器，其中每个 DOM 元素都被解析如下：

```
Destination URL, Text, (DOM Path in format \TagName, ClassName, Id, ChildRank) 
```

例如：

```
\TagName=A&ClassName=&Id=&ChildRank=1
\TagName=LI&ClassName=&Id=&ChildRank=1
\TagName=UL&ClassName=&Id=&ChildRank=1
\TagName=DIV&ClassName=header-wrap&Id=&ChildRank=1
\TagName=DIV&ClassName=header-classified&Id=&ChildRank=1
\TagName=DIV&ClassName=header-container&Id=&ChildRank=3
\TagName=DIV&ClassName=main-container&Id=&ChildRank=1
\TagName=DIV&ClassName=ody-custom%20cobrand&Id=&ChildRank=2
\TagName=DIV&ClassName=ody-skin&Id=&ChildRank=10
\TagName=CENTER&ClassName=&Id=&ChildRank=2
\TagName=BODY&ClassName=&Id=&ChildRank=3
\TagName=HTML&ClassName=&Id=&ChildRank=0 
```

我想知道在 C# 中是否有一种简单的方法可以做到这一点，比如我是否有一个 CSS 选择器列表，并且我想看看是否有一个 CSS 选择器可以实际选择 DOM 元素中的 DOM 元素？

抱歉，这个问题似乎不清楚。

# r - 从字符转换为数字数据框

> ID：14717217
> 
> 赞同：14
> 
> 时间：2013-02-05T21:24:45.367
> 
> 标签：r, dataframe

我在 R 中有一个字符数据框，其中包含`NaN`s。我需要用 a 删除任何行，`NaN`然后将其转换为数字数据框。

如果我只是在数据框上执行 as.numeric，我会遇到以下情况

```
Error: (list) object cannot be coerced to type 'double'
 1:
 0: 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-05T21:34:51.500

正如@thijs van den bergh 指出的那样，

```
dat <- data.frame(x=c("NaN","2"),y=c("NaN","3"),stringsAsFactors=FALSE)

dat <- as.data.frame(sapply(dat, as.numeric)) #<- sapply is here

dat[complete.cases(dat), ]
#  x y
#2 2 3 
```

是*一种*方法来做到这一点。

您的错误来自尝试制作`data.frame`数字。我展示的`sapply`选项是使每个列向量变为数字。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-05T22:01:31.947

请注意，`data.frames`不是`numeric`or `character`，而是 a `list`，它可以是所有`numeric`列、所有`character`列或这些或其他类型的混合（例如：`Date`/ `logical`）。

```
dat <- data.frame(x=c("NaN","2"),y=c("NaN","3"),stringsAsFactors=FALSE)
is.list(dat)
# [1] TRUE 
```

示例数据只有两个字符列：

```
> str(dat)
'data.frame':   2 obs. of  2 variables:
 $ x: chr  "NaN" "2"
 $ y: chr  "NaN" "3 
```

...您可以添加一个数字列，如下所示：

```
> dat$num.example <- c(6.2,3.8)
> dat
    x   y num.example
1 NaN NaN         6.2
2   2   3         3.8
> str(dat)
'data.frame':   2 obs. of  3 variables:
 $ x          : chr  "NaN" "2"
 $ y          : chr  "NaN" "3"
 $ num.example: num  6.2 3.8 
```

因此，当您尝试执行`as.numeric`R 时会感到困惑，因为它想知道如何转换这个可能有多种类型的列表对象。`user1317221_G`的答案使用`?sapply`函数，该函数可用于将函数应用于对象的各个项目。您也可以使用`?lapply`非常相似的函数（在`*apply`此处阅读有关函数的更多信息 - [R 分组函数：sapply vs. lapply vs. apply. vs. tapply vs. by vs. aggregate](https://stackoverflow.com/questions/3505701/r-grouping-functions-sapply-vs-lapply-vs-apply-vs-tapply-vs-by-vs-aggrega)）

即 - 在这种情况下，您的每一列`data.frame`，您可以应用该`as.numeric`功能，如下所示：

```
data.frame(lapply(dat,as.numeric)) 
```

`lapply`调用包含在 a中`data.frame`以确保输出是 a`data.frame`而不是 a `list`。也就是说，运行：

```
lapply(dat,as.numeric) 
```

会给你：

```
> lapply(dat,as.numeric)
$x
[1] NaN   2

$y
[1] NaN   3

$num.example
[1] 6.2 3.8 
```

尽管：

```
data.frame(lapply(dat,as.numeric)) 
```

会给你：

```
>  data.frame(lapply(dat,as.numeric))
    x   y num.example
1 NaN NaN         6.2
2   2   3         3.8 
```

# excel - Excel：将一列与另一列进行比较。当有匹配时，复制相邻的单元格

> ID：14717221
> 
> 赞同：0
> 
> 时间：2013-02-05T21:24:57.737
> 
> 标签：excel, match, matching

所以我有大量的产品编号和描述。我对一些产品编号有一些新的描述。

我只想在大量列表中找到匹配的内容，然后将新描述复制到大列表的描述字段中。

我可以使用以下方法找到匹配项：

```
=IF(ISNA(VLOOKUP(A7,$C$2:$C$426,1,FALSE)),"FALSE", "File found in row " & MATCH(A7,$C$2:$C$426,0)) 
```

但除此之外，我被困住了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:27:20.297

创建第三列称为（比如说）合并列表。

```
|product no| existing description| new descriptions|consolidated list 
```

现在在合并列表列中，编写一个公式：

```
=IF(<check for match>, <if match found, then copy column 3 entry>, <else copy column 2 entry>) 
```

复制整个列中的公式。现在此列应该是更新的列。用此列替换现有列。

# c++ - 编译器模板实现会引入循环依赖吗？

> ID：14717225
> 
> 赞同：0
> 
> 时间：2013-02-05T21:25:25.223
> 
> 标签：c++, templates, generics, c++11, circular-dependency

我正在使用 C++ 开发 API，并尝试/真的/努力不使用 RTTI（运行时类型信息）来实现一些依赖注入功能。

我相信我可以做到这一点，但是通过使用模板——但这让我想知道：

当模板被“扩展”并由编译器实现时，它们是否实际上引入了循环依赖（编译时或运行时），当模板类在框架库中实现时，该类的客户端在上层图书馆？

谢谢你的帮助！

```
#include <string>

/************************************************************/
// Implemented in Framework.lib
namespace Framework 
{
    template<typename ShapeTemplateType>
    class Utility
    {           
        void Do()
        {
            ShapeTemplateType x;
            (void) x;
        }
    };
} // End namespace Framework 

/************************************************************/
// Implemented in Application.lib
namespace Application
{
    class StateObject
    {
        int i;
    };

    class Facade
    {
        Framework::Utility<StateObject> state;
    };
} // End Namespace Application

/********************************************************************/
// Implemented in Client
int main(int args, char* argv[])
{
    Application::Facade facade;

    //Derived d;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:30:43.273

模板的代码在实例化它的编译单元中生成。在您的示例中，生成的机器代码将位于`Application.lib`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:50:29.507

您的意思是循环模板依赖项，例如：

```
template<class T>
using A = B<T>;

template<class T>
using B = A<T>;

int main()
{
    A<int>;
} 
```

这在 A 的声明中失败，因为 B 不可用，如果你 fwd 声明它，它会抱怨它不完整。

我认为模板中不可能有循环依赖，因为对于要进行实例化的每个模板参数都必须有一个完整的类型。鉴于此，模板实例化链因此必须是非循环的。

# jquery - css 动画 onload jQuery 事件

> ID：14717226
> 
> 赞同：0
> 
> 时间：2013-02-05T21:25:31.847
> 
> 标签：jquery, css, animation, onload

`<div id="A"></div>`我的网站顶部有一个包含徽标和导航菜单。我在 div 中应用了一个类，当项目加载时会导致 CSS 向下滑动效果。自然，徽标的图像加载速度较慢，因为菜单只是呈现文本按钮。我希望图像先加载，然后再`<div id="A"></div>`向下滑动。

```
<script>
$(document).ready(function(){
  $('#A').load(function(){
    //I want the slide down effect to take place here.
  });
});
</script> 
```

我很感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:27:56.757

如果您正在使用一个类，则从 HTML 中删除该类并将其添加到您的 jQuery 中。

但是，由于您使用 jQuery 来查看图像是否已加载，因此您不妨使用 jQuery`.animate`函数，因为它可以在更多浏览器中以这种方式工作。

# asp.net-mvc - ASP.NET MVC Best Practice for jQuery updates

> ID：14717228
> 
> 赞同：6
> 
> 时间：2013-02-05T21:25:39.310
> 
> 标签：asp.net-mvc, asp.net-mvc-4

## History

I created a new ASP.NET MVC 4.0 project that was basic and didn't include jQuery or other scripts that the Intranet and Internet templates insert by default. I then went to add the scripts using NuGet and installed the latest version of all the jQuery and related files that are normally installed by the MVC Intranet and Internet templates.

When I tried running the application I started to receive errors. Apparently there are incompatibilities with the libraries/extensions that were written previous to jQuery 1.9\. It seemed like after fixing an issue I'd run into another. I finally gave up and copied the versions of the js files that would have installed. This resolved the issues I was able to use features such as remote validation.

## Questions

Since I'm new to ASP.MVC, I'd like to know what the Best Practice is related to jQuery updates. I assume I need to wait until all the libraries/extensions have caught up, but I would need to follow the status of each library/extension to determine when I could upgrade.

1.  Is it simply better to wait and just use the versions that are installed with the MVC templates and not upgrade? And when the next update for MVC comes out, then copy those libraries/extensions into the scripts folder that the updated templates use?
2.  I noticed that the MVC templates do not install the jQuery NuGet packages but install files to the Content and Script folders. Is this to prevent developers from upgrading and experiencing the issues I found with using newer version of the libraries/extensions?
3.  Does Microsoft time updates to jquery.unobtrusive-ajax.js and related libraries to updates to ASP.NET MVC? If so then it would seem to make sense to hold off updating dependencies until ASP.NET MVC is updated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:55:42.677

jQuery deprecated the `.live()` method in v1.9\. It can be replaced with `.on()`. This broke jquery.unobtrusive-ajax.js. I know from experience when cursing the update that I first pulled from NuGet.

There is an update to jquery.validate out there, also mentioned in [this thread](https://stackoverflow.com/questions/14659023/error-in-jquery-validate-js-in-mvc-4-project-with-jquery-1-9). But I have not validated it yet, jquery 1.9.1 is available as well.

For your questions...

1.  I think it is good practice to keep your packages upto date, but also research any deprecated functionality. Also using some source save like tools is a good idea. You could easily revert any breaking changes with one or two mouse clicks.

2.  Even though there is not a \packages folder added to you virgin project (intra or internet). If you open up the NuGet package manager UI, updates will still show up.

# html - HTML5 验证错误 a href (NFC)

> ID：14717230
> 
> 赞同：3
> 
> 时间：2013-02-05T21:25:50.557
> 
> 标签：html, validation, character, href

我屏蔽了以下 URL 中的所有特殊字符，但 w3c-validator 仍然抛出错误。我检查了所有 NFC 教程，但我不知道错误在哪里。任何想法 ？

**网址**

```
<a href="http://www.example.de/index.php&#63;cnid&#61;efcb9a458fb823ba877ef53b7162598f&#38;ldtype&#61;grid&#38;cl&#61;alist&#38;tpl&#61;&#38;fnc&#61;executefilter&#38;fname&#61;&#38;attrfilter&#91;3a5d1ca314a5205fa7b7b3baa5d2f94e&#93;&#91;2f143d22ce421269b5c7d01a160f6541&#93;&#61;2f143d22ce421269b5c7d01a160f6541">Asche</a> 
```

**w3c-错误**

```
Line 618, Column 441: Bad value http://www.example.de/index.php?cnid=efcb9a458fb823ba877ef53b7162598f&ldtype=grid&cl=alist&tpl=&fnc=executefilter&fname=&attrfilter[3a5d1ca314a5205fa7b7b3baa5d2f94e][2f143d22ce421269b5c7d01a160f6541]=2f143d22ce421269b5c7d01a160f6541 for attribute href on element a: Illegal character in query component.

…21269b5c7d01a160f6541&#93;&#61;2f143d22ce421269b5c7d01a160f6541">Asche</a></li> 
```

**IRI 引用的语法**

```
Any URL. For example: /hello, #canvas, or http://example.org/. Characters should be represented in NFC and spaces should be escaped as %20\. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:53:06.843

根据[STD 66](https://www.rfc-editor.org/rfc/rfc3986) （其中附录 A 包含语法摘要，显示括号是“gen- delims ”字符`[`，在查询部分中不允许使用这些字符，除非% 编码）。`]``%5B``%5D`

您应该已经发布了一个 HTML 文档，因为这是验证器的工作内容。以下测试文档（验证）包含您提到的正确编码的 URL：

```
<!doctype html>
<meta charset=utf-8>
<title></title>
<a href=
"http://www.example.de/index.php?cnid=efcb9a458fb823ba877ef53b7162598f&amp;ldtype=grid&amp;cl=alist&amp;tpl=&amp;fnc=executefilter&amp;fname=&amp;attrfilter%5B3a5d1ca314a5205fa7b7b3baa5d2f94e%5D%5B2f143d22ce421269b5c7d01a160f6541%5D=2f143d22ce421269b5c7d01a160f6541">foo</a> 
```

除此之外，URL 不起作用；它会导致“Multiple Choices”响应，这很奇怪（当服务器正在执行一些找不到可接受的替代方案的内容协商时，应该发出这样的消息，并且应该提供替代方案列表；但这里更多或少一个“未找到”的情况）。

# php - Magento 产品（按 sku）拉升销售、相关产品和交叉销售（VIA mage call？）

> ID：14717238
> 
> 赞同：0
> 
> 时间：2013-02-05T21:26:07.790
> 
> 标签：php, magento, magento-1.7

我是相当新的，只有大约一周的时间进入magento。我猜有一个 API，然后是一个名为 mage 的新 API？

因此，如果您转到管理页面并单击目录 -> 管理产品*，然后单击产品。在管理页面的左侧有三件事：

相关产品

追加销售

交叉销售

我想提取该信息（通过项目的 SKU。）并将其放入子站点（这将是相同的，只需将其推过去，以便它们在所有站点上都是相同的。）。

这有意义吗？我想要产品信息中的这三件事，然后将其填充到另一个站点上的相同 SKU 上（因为它们将具有相同的信息，并且 SKU 是所有内容的主键并且相同）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:39:38.703

要按 SKU 获取产品，您可以使用以下`loadByAttribute()`方法：

```
$_product = Mage::getModel('catalog/product')->loadByAttribute('sku', 'PRODUCTSKU'); 
```

拥有产品后，您可以从产品中获取相关项目。您可以获取相关产品的 ID：

```
$_relatedProducts = $_product->getRelatedItemIds(); 
```

这应该会为您返回一系列产品 ID，然后您可以循环并单独获取每个产品。

使用以下方法检索追加销售产品：

```
$_product->getUpSellProductCollection() 
```

至于交叉销售 - 我不完全确定，但我认为你可以使用

```
$_crossSells = $_product->getTypeInstance(true)->getAssociatedProducts($_product); 
```

# forms - 使用注册表单而不是 API 将 MailChimp 订阅者添加到组

> ID：14717248
> 
> 赞同：10
> 
> 时间：2013-02-05T21:26:33.357
> 
> 标签：forms, mailchimp

我知道您可以使用 API 做到这一点，但不确定常规注册表单。

有谁知道是否可以在 MailChimp 的高级注册表单中添加一些代码，以自动将它们添加到我列表中的特定组中？

我只收集电子邮件地址，我不希望订阅者必须手动选择组。如果他们使用该表格，我希望他们添加到该组。

我曾向 MailChimp 寻求帮助，但他们告诉我他们的客户支持不会编码，我应该聘请专家。

也许相关代码的一部分可能会有所帮助：

```
<form action="http://lalala.us2.list-manage1.com/subscribe/post" method="post">
<input type="hidden" name="u" value="345fc4974810ef65c8276c8">
<input type="hidden" name="id" value="25c4d1b28">
<table cellpadding="5" cellspacing="0" border="0" align="center">

<tr>
<td align="right" class="formLabel"><strong>Email Address</strong> <span class="asterisk">*</span>:</td>
<td align="left">
    <input type="email" autocapitalize="off" autocorrect="off" name="MERGE0" id="MERGE0" size="25" value="*|MERGE0|*">
<br><span class="error">*|HTML:EMAILERROR|*</span></td>
</tr> 
```

是否有一个隐藏的输入类型，我可以添加一个列表分组名称，将它们自动添加到一个组中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-08-29T09:07:32.997

这是一个老问题，但我自己在寻找答案时遇到了它，但在任何地方都找不到好的答案（包括这里的另一个答案，充其量是很差的）。当我在这方面找不到任何东西时，我可以通过一些实验来弄清楚。

它需要几个步骤。首先，添加您的组和您希望组包含的选项（如果需要，它只能是 1）。最初确保组未设置为隐藏。转到 MailChimp 中注册表单 > 常规表单下的主要默认注册表单。验证组选项是否可见，然后使用注册表单 URL 访问您托管的注册表单。现在，使用右键单击 > 查看源代码在浏览器中打开原始 HTML。您需要找到所需组/选项的 INPUT 元素。它可能看起来像这样：

```
<input type="checkbox" data-dojo-type="dijit/form/CheckBox" id="group_8" name="group[13257][8]" value="1"  class="av-checkbox"> 
```

name 参数是这里的关键。将整个输入元素复制并粘贴到您的自定义表单中。现在，使用内联 CSS 将其隐藏，并使用 HTML 对其进行硬编码以进行检查。您也可以删除多余的东西。自定义表单中的最终版本应如下所示：

```
<input type="checkbox" id="group_8" name="group[13257][8]" value="1" checked="checked" style="display:none"> 
```

这将确保它对用户不可见，但它会自动将它们添加到您从显示它的表单中获取的 name 参数定义的组中。

最后一步是返回并确保将该组设置为隐藏，以确保它不会无意中出现在其他表单上。

很简单！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-29T20:25:08.117

我所做的只是删除其他复选框（以及它们周围的无序列表和列表项标签）并将代表我想要的默认组的复选框更改为隐藏字段。从字面上看，只需 type="hidden" 而不是 type="checkbox" 就可以了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-03T15:12:43.183

您应该能够为特定组添加一个`input`带有集合名称的隐藏字段。`MERGE TAG`

[但是，对于此功能，使用MailChimp API](http://apidocs.mailchimp.com/api/1.3/)会更容易（即使您的问题表明您不希望这样做）。

# javascript - 这个 onclick 出了点问题

> ID：14717249
> 
> 赞同：-3
> 
> 时间：2013-02-05T21:26:36.057
> 
> 标签：javascript

```
<!DOCTYPE html>
<html>
<head>
<script>
function validateAlphaNumeric()
{
alert("function start");
var alphabets="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
var numbers="0123456789";
var flag=true;
var prod_id=document.getElementByID("productid").value;
alert(prod_id);
for(var i=0;i<prod_id.length;i++)
{
if(alphabets.indexOf(prod_id.charAt(i))==-1 || numbers.indexOf(prod_id.charAt(i)==-1)
{
alert("value must be alphanumeric");
break;
}
}

var prod_type=document.myform.producttype.value;
for(var i=0;i<prod_type.length;i++)
{
if(alphabets.indexOf(prod_type.charAt(i))==-1 || numbers.indexOf(prod_type.charAt(i)==-1)
{
alert("value must be alphanumeric");
break;
}
}
}
</script>
</head>
<body>

<form name="myform" action="http://localhost:8080/examples/Submit.HTML" method="POST">

<br><br>
Prodcut ID:<input type="text" name="productid" id="productid" size="25" ">
<br><br>
Product Type:<input type="text" name="producttype" id="producttype" size="25" ">
<br><br>
</div>

<input type="submit"  onclick="validateAlphaNumeric()" value="Submit">
</form>
</body>
</html> 
```

这是一个仅用于学习基础知识的测试页面。当我按下提交时，没有发生任何检查，它转到 Submit.html 页面。为什么？这里需要什么修改？

```
<input type="submit"  onclick="validateAlphaNumeric()" value="Submit"> 
```

当我按下这个按钮时究竟会发生什么？

```
var prod_id=document.getElementByID("productid").value;

  var prod_type=document.myform.producttype.value; 
```

两种机制都一样吗？

```
This is the Modified one.But still not working. Please help

<!DOCTYPE html>
<html>
<head>
<script>
function validateAlphaNumeric()
{

var alphabets="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
var numbers="0123456789";
var flag=true;
var prod_id=document.getElementByID("productid").value;

for(var i=0;i<prod_id.length;i++)
{
if(alphabets.indexOf(prod_id.charAt(i))==-1 && numbers.indexOf(prod_id.charAt(i)==-1))
{
alert("value must be alphanumeric");
return false;
}
}

var prod_type=document.myform.producttype.value;
for(var i=0;i<prod_type.length;i++)
{
if(alphabets.indexOf(prod_type.charAt(i))==-1 && numbers.indexOf(prod_type.charAt(i)==-1))
{
alert("value must be alphanumeric");
return false;
}
}
}
</script>
</head>
<body>

<form name="myform" action="http://localhost:8080/examples/Submit.HTML" method="POST">

<br><br>
Prodcut ID:<input type="text" name="productid" id="productid" size="25" ">
<br><br>
Product Type:<input type="text" name="producttype" id="producttype" size="25" ">
<br><br>
</div>

<input type="submit"  onclick="validateAlphaNumeric(); " value="Submit">
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:32:08.923

你去那里了，你忘记了 if 语句的右括号：

```
<!DOCTYPE html>
<html>
<head>
<script>
function validateAlphaNumeric()
{
alert("function start");
var alphabets="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
var numbers="0123456789";
var flag=true;
var prod_id=document.getElementByID("productid").value;
alert(prod_id);
for(var i=0;i<prod_id.length;i++)
{
if(alphabets.indexOf(prod_id.charAt(i))==-1 && numbers.indexOf(prod_id.charAt(i)==-1))
{
alert("value must be alphanumeric");
break;
}
}

var prod_type=document.myform.producttype.value;
for(var i=0;i<prod_type.length;i++)
{
if(alphabets.indexOf(prod_type.charAt(i))==-1 && numbers.indexOf(prod_type.charAt(i)==-1))
{
alert("value must be alphanumeric");
break;
}
}
}
</script>
</head>
<body>

<form name="myform" action="" method="POST">

<br><br>
Prodcut ID:<input type="text" name="productid" id="productid" size="25" ">
<br><br>
Product Type:<input type="text" name="producttype" id="producttype" size="25" ">
<br><br>
</div>

<input type="submit"  onclick="validateAlphaNumeric()" value="Submit">
</form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:28:59.343

如果你想没有去操作页面你必须把**return false;** 像这样在**onclick**结束时

```
onclick="validateAlphaNumeric();return false;" 
```

或者把**return false;** 在您调用的函数结束时**返回 false；**你说浏览器不提交

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:29:10.717

验证失败时尝试返回 false

# jquery - CSS悬停在元素之前

> ID：14717251
> 
> 赞同：3
> 
> 时间：2013-02-05T21:26:40.300
> 
> 标签：jquery, css, html, selector

我有一个 div 和一个 div:before。我想当鼠标经过（悬停） :before 元素时改变它的颜色。无论使用 css 还是 jQuery，有没有办法做到这一点？

我尝试了 div:before:hover 之类的东西，但什么也没发生

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T21:31:23.253

## 解决方案 1

（不解决问题）仅使用 css：

```
span:before {
    color: red;
    content: "hi";
}
span:hover:before {
    color: blue;
} 
```

html

```
<span>text</span> 
```

编辑：小提琴[http://jsfiddle.net/bwkM6/](http://jsfiddle.net/bwkM6/)

## 解决方案 2

在没有 :before 的情况下解决给定的问题

[http://jsfiddle.net/Z97uN/1/](http://jsfiddle.net/Z97uN/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T21:29:08.430

`:before`并且`:after`伪类不能具有其他伪类属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T22:51:32.757

显然，你不能像那样组合伪元素。但是，您可以使用 jQuery 将“ `:before`”元素注入 DOM，而不是使用 CSS。

```
$(function() {
    $('div.interesting').before('<div class="interesting-before"></div>');
}); 
```

然后在您的 CSS 中，您只需引用`.interesting-before`and`.interesting-before:hover`而不是`.interesting:before`and `.interesting:before:hover`。

有关示例，请参见[http://jsfiddle.net/Z97uN/2/ 。](http://jsfiddle.net/Z97uN/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T22:05:17.543

我看到了几个解决方案：

最简单 - 您将特定类分配给 div:before

```
//HTML
<div class="specificClass">A</div>
<div>B</div>
<style>
.specificClass:hover {color: red}
</style> 
```

但是，从您的问题来看，您似乎无法做到这一点。然后利用 jQuery：

方法#1

```
//JAVASCRIPT
$("div").prev().addClass("specificClass");

//in your CSS 
.specificClass:hover {color:red} 
```

方法#2

```
//JAVASCRIPT
$("div").delegate($("div").prev(),"mouseenter mouseleave",function(){
    $(this).toggleClass("specificClass");
}

//in your CSS 
.specificClass {color:red} 
```

请注意，您必须了解这仅在只有 2 个 div 时才有效。如果还有更多，除了最后一个之外，所有这些都将收到“.specificClass”。无论如何，如果“span:hover:before”有效，也会发生同样的情况。

如果您解释什么以及为什么要实现您所描述的，我们将能够提供更好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-10T18:00:23.917

正确的语法是

```
div:hover:before
{
//css here
} 
```

[jsfiddle](https://jsfiddle.net/vijays90/aL4536zs/)

# oracle - Websphere 7/数据源：ORA-01017：用户名/密码无效；

> ID：14717257
> 
> 赞同：0
> 
> 时间：2013-02-05T21:27:16.477
> 
> 标签：oracle, websphere

我在 WS 7 上设置多个数据源以进行 JNDI 访问。

单击其中一个数据源 -> `Connection Pool Properties`->`Connection Pool Custom Properties`后，我给出了两个属性：

```
Property1 Name: user
value: someuser

Property2 Name: password
value: somepassword 
```

保存配置并返回该数据源后，我点击了`Test connection`按钮，所以它给了我一个很好的例外：

```
java.sql.SQLException: ORA-01017: invalid username/password; logon denied DSRA0010E: SQL State = 72000, Error Code = 1,017 
```

我也确实从 JVM 日志中看到了该异常。即使重新启动服务器，问题仍然存在？

那怎么了？

## 更新 1

忘记提及我已将 JAAS 身份验证设置为无，但仍然出现异常..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:39:28.357

您可以尝试使用“J2C 身份验证别名”来定义您的用户名/密码对而不是自定义属性。您可能会在数据源定义屏幕的右侧看到 J2C 身份验证别名定义的链接。将用户名/密码对定义为身份验证别名后，应从别名列表中为数据源选择该别名。

作为参考，您可以在信息中心检查[使用管理控制台（第 10 项）配置数据源](http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=/com.ibm.websphere.express.doc/info/exp/ae/tdat_ccrtpds.html)。

# node.js - Node.JS + MongoDB 聚合框架平均值

> ID：14717258
> 
> 赞同：1
> 
> 时间：2013-02-05T21:27:27.560
> 
> 标签：node.js, mongodb, aggregation-framework

我一直在考虑将 Node 和 MongoDb 用于 Android 应用程序的评分系统，到目前为止，我已经很好地实现了 Create、Update 和 Delete，但是当我想从D B。这是我决定的数据结构：

```
[
  {
    "_id": "1",
    "ratings": [
      {
        "value": "5",
        "user": "CoolUser1"
      },
      {
        "value": "4",
        "user": "CoolUser2"
      }
    ]
  },
  {
    "_id": "2",
    "ratings": [
      {
        "value": "4",
        "user": "CoolUser3"
      },
      {
        "value": "2",
        "user": "CoolUser4"
      }
    ]
  }
] 
```

基本上我需要的是给定_id的评级平均值。

这是我用来了解我如何设置 mongoDB 连接的 Update 方法：

```
exports.updateRating = function(req, res) {
    var id = req.params.id;
    var rating = req.body;
    console.log('Updating a rating: ' + id);
    console.log(JSON.stringify(rating));
        ratings.update({'_id': id}, 
                        {$push: rating}, 
                        {upsert:true}, 
                        function(err, result) {
                            if (err) {
                                console.log('Error updating rating: ' + err);
                                res.send({'error':'An error has occurred'});
                            } else {
                                console.log('' + result + ' document(s) updated');
                                res.send(rating);
                            }
                        }
        );
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T22:13:13.453

存储`ratings.value`为字符串是否重要？

这将起作用，但前提是您`rating`在安全之前转换为数字

```
ratings.aggregate([
   { $match: { _id: id } },
   { $unwind: '$ratings' },
   { $group: { _id: null, avg: { $avg: '$ratings.value' } } }
], function(err, result) {
    console.log(result);
    db.close();
}); 
```

# ruby-on-rails - Rails has_many 关系根据外键查找名称

> ID：14717259
> 
> 赞同：0
> 
> 时间：2013-02-05T21:27:30.937
> 
> 标签：ruby-on-rails

我有两个模型：

```
class country < ActiveRecord::Base
  has_many :companies
end

class company < ActiveRecord::Base
  belongs_to :country
end 
```

在我的公司视图索引中，我可以通过显示以下内容来显示公司所属的国家：

```
<%= company.country_id %> 
```

这将向我显示与其关联的 ID 号，但我似乎无法解决如何将其解析回国家名称 country.name，我似乎尝试的所有操作都会崩溃，我认为我不会我以正确的方式解决问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:29:27.783

```
<%= company.country.try(:name) %> 
```

真的应该做你想做的。

按照建议的评论进行编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:03:02.633

我不建议使用#try。当你告诉 Rails 给你过滤后的集合时会好得多，这就是控制器的用途。

在这种情况下，你会有

```
 class CompaniesController < ApplicationController
      def index
        @companies = Company.where('country_id IS NOT NULL') #if using the relational db
        # or @companies = Company.all.select { |company| company.country.present? }
      end
    end 
```

在你看来

```
 <% @companies.each do |company| %>
      <%= company.country.name %>
    <% end %> 
```

**更新：**

更好的方法是在你的模型中为这些事情创建一个命名范围。

```
 class Company < ActiveRecord::Base
      #...
      scope :with_country, ->() { where('country_id IS NOT NULL') }  
    end 
```

现在您可以更改控制器操作

```
 def index
     @companies = Company.with_country
   end 
```

这将使您的代码更加一致和可读。

# html - 使用 HTML 链接重播 flash (swf)

> ID：14717263
> 
> 赞同：0
> 
> 时间：2013-02-05T21:27:51.897
> 
> 标签：html, flash

如果页面有 SWF 横幅，我们需要放一个 HTML 链接来重放 SWF，我们可以在 HTML DIV 中包含横幅，然后制作一些 jQuery 来重新加载 DIV，这样我们就可以从头获取 SWF。

尽管这是一种可行的方式，但我想知道是否有一种直接的方式可以从 HTML 链接重放 SWF 而无需 jQuery 的入侵。

非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:40:48.780

在 HTML/Javascript 中，您可以使用['ExternalInterface'](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html)调用 Flash 文件中的任何方法（函数） 。

查看[示例](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html#includeExamplesSummary)

# php - 首次尝试登录时无法识别会话

> ID：14717265
> 
> 赞同：0
> 
> 时间：2013-02-05T21:28:00.353
> 
> 标签：php, google-chrome, session, safari

**问题已解决**- 请参阅：[https ://stackoverflow.com/a/14719452/1174295](https://stackoverflow.com/a/14719452/1174295)

--

我在（至少）Google Chrome 和 Safari 中遇到了问题。

首次尝试登录时，不会重定向用户。会话已创建，但几乎就像未检测到一样，并将用户带回索引页面。在第二次尝试时，会发出正确的重定向并将用户带到正确的页面。

该脚本在 Firefox 中运行良好，我已经广泛检查以查看是否返回了正确的数据，确实如此。我已经搜索了，我已经搜索了，我已经搜索了，但不幸的是没有发现任何有用的东西。

**Access.php - 用户登录**

```
<?php
session_start();
ob_start();

include_once('db.class.php');
include_once('register.class.php');
include_once('login.class.php');

$db = null;
$reg = null;
$log = null;

$db = new Database();
$log = new Login($db, null, null, null, null, null, null);

if (isset($_SESSION['login'])) {    
    $log->redirectUser($_SESSION['login']);
}

include_once('includes/header.html');

?>

Some HTML...

<?php
    if (isset($_POST['logsub'])) {
        $db = new Database();
        $log = new Login($db, $_POST['email'], $_POST['pass']);

        $validation = &$log->validate();

        if(empty($validation)) {
            $log->redirectUser($_SESSION['login']);
        } else {
            echo "<div id='error'><div class='box-error'><p style='font-weight: bold'>The following errors occured...</p><ul>";

                for ($i = 0; $i < count($validation); $i++) {
                    echo "<li>" . $log->getErrorMessage($validation[$i]) . "</li>";
                }
            echo "</ul></div></div>";
        }
    }
?> 
```

**Login.class.php - 登录类**

```
// Validate the credentials given
public function validateLogin() {
    // Hash the plain text password
    $this->hashedPass = $this->hashPassword();

    try {
        $query = $this->dbcon->prepare("SELECT Login_ID, Login_Email, Login_Password FROM Login WHERE Login_Email = :email AND Login_Password = :pass");
        $query->bindParam(':email', $this->email, PDO::PARAM_STR);
        $query->bindParam(':pass', $this->hashedPass, PDO::PARAM_STR);
        $query->execute();

        $fetch = $query->fetch(PDO::FETCH_NUM);
        $this->loginid = $fetch[0];

        // If a match is found, create a session storing the login_id for the user
        if ($query->rowCount() == 1) {
            $_SESSION['login'] = $this->loginid;    
            session_write_close();
        } else {
            return LOG_ERR_NO_MATCH;
        }
    } catch (PDOException $e) {
        $this->dbcon->rollback();
        echo "Error: " . $e->getMessage();
    }
}

// Fetch the customer ID
private function getCustId() {
    try {
        $query = $this->dbcon->prepare("SELECT Customer.Cust_ID FROM Customer JOIN Login ON Customer.Login_ID = Login.Login_ID WHERE Customer.Login_ID = :loginid");
        $query->bindParam(':loginid', $this->loginid, PDO::PARAM_INT);
        $query->execute();

        $fetch = $query->fetch(PDO::FETCH_NUM);     
        return $fetch[0];
    } catch (PDOException $e) {
        $this->dbcon->rollback();
        echo "Error: " . $e->getMessage();
    }
}

// Check the registration progress - are they verified? paid?
// This function is used elsewhere hence the $sessionid argument
public function checkRegistration($sessionid) { 
    $this->loginid = $sessionid;
    $this->custid = $this->getCustId();

    try {
        $queryVer = $this->dbcon->prepare("SELECT Cust_ID FROM Customer_Verify_Email WHERE Cust_ID = :custid");
        $queryVer->bindParam(":custid", $this->custid, PDO::PARAM_INT);
        $queryVer->execute();

        $queryFee = $this->dbcon->prepare("SELECT Cust_ID FROM Initial_Fee_Payment WHERE Cust_ID = :custid");
        $queryFee->bindParam(":custid", $this->custid, PDO::PARAM_INT);
        $queryFee->execute();

        // If a record exists in the verify table, return the value 1\. This means the user has not yet verified their email.
        if ($queryVer->rowCount() == 1) {
            return 1;
        } else {
            // If a record does not exist in the payment table, no payment has been made. Return 2.
            if ($queryFee->rowCount() == 0) {
                return 2;
            // Otherwise, email is verified and the payment has been made.
            } else {
                return 0;
            }
        }

    } catch (PDOException $e) {
        $this->dbcon->rollback();
        echo "Error: " . $e->getMessage();
    }
}

// Redirect the user accordingly
public function redirectUser($sessionid) {
    $this->loginid = $sessionid;    
    $logNum = $this->checkRegistration($this->loginid);

    if ($logNum == 0) {
        header("Location: fbedder/details.php", true, 200);
        exit();
    } else if ($logNum == 1) {
        header("Location: fbedder/verification.php", true, 200);
        exit();
    } else if ($logNum == 2) {
        header("Location: fbedder/payment.php", true, 200);
        exit();
    }
} 
```

这是该站点的链接：fbedder/ -> 我已经使用凭据设置了一个测试帐户 -> 电子邮件：test@ / 密码：test123321

重申一下，问题仅存在于 Google Chrome 和 Safari（我的 iPhone 上的 Safari）中，并且纯粹存在于登录方面。在第一次尝试时，会话将被忽略（它被创建），而在第二次尝试时，用户将被重定向。

有任何想法吗？我尝试了多种可能...

--**编辑**--

我现在知道问题出在哪里了。

当调用重定向时，它会将用户发送到 details.php 页面。但是，此页面包含以下代码片段：

```
if (!isset($_SESSION['login'])) {
    header("Location: fbedder/index.php");
} 
```

显然，正在发生的事情是会话没有被检测/保存/“随便”，因此将用户发送回索引页面。有没有办法确保 $_SESSION 不会有效丢失。我在这里发帖之前已经阅读过这个，这就是我插入的原因`session_write_close()`，但这似乎并没有达到预期的效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T00:20:28.900

在诊断出问题在于 $_SESSION 变量实际上已丢失的事实之后，我阅读了有关该`session_write_close()`函数的信息并遇到了以下评论：

> 我的会话搞砸了，因为我同时有 2 个不同的会话 ID：
> 
> *   1 个用于 domain.com 的 PHPSESSID cookie
> *   1 个用于 www.domain.com 的 PHPSESSID cookie
> 
> 这修复了它：
> 
> //在每一页的开头...
> 
> session_set_cookie_params (1800,"/","domain.com"); session_start();

来源： http: [//pt2.php.net/manual/en/function.session-write-close.php#84925](http://pt2.php.net/manual/en/function.session-write-close.php#84925)

设置参数解决了这个问题。

# ruby - 从 Ruby 执行 PowerShell

> ID：14717270
> 
> 赞同：2
> 
> 时间：2013-02-05T21:28:15.553
> 
> 标签：ruby, shell, powershell, rake

这在 PS 命令提示符下运行良好：

```
Get-WmiObject Win32_Share -computer "Server" -filter "Name = 'ShareName'" 
```

当添加到 Ruby 中时，我可以让它执行（因为它不需要引号）：

```
powershell (Get-WmiObject Win32_Share -computer "Server") 
```

但不使用 filter 参数（需要引号）：

```
powershell (Get-WmiObject Win32_Share -computer "Server" **-filter "Name = 'ShareName'"**) 
```

错误的输出不显示双引号。我尝试了我所知道的一切来逃避它们，但没有任何效果。

尝试`(... -filter \"Name = 'ShareName'\")`
过`%x{}`而不是````
尝试过单引号

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:57:26.357

在 powershell 中，双引号字符串之间的值被解释，例如`$HelloWorld`包含字符串“Hello world”的对象。Powershell`$HelloWorld`的处理方式与它处理`"$helloWorld"`. 但是，如果您键入`'$HelloWorld'`它，它将按字面意思解释它并将对象名称 $HelloWorld 打印为字符串。

```
PS> $HelloWorld = "Hello World"
PS> $helloworld
Hello World
PS> "$helloworld"
Hello World
PS> '$helloworld'
$helloworld 
```

尝试这样的事情......

```
PS> "'$helloworld'"
'Hello World' 
```

# c# - 如何将char分配给字符串？

> ID：14717273
> 
> 赞同：0
> 
> 时间：2013-02-05T21:28:31.380
> 
> 标签：c#, string, char

我有一个`string` `Lat`单词，我想将它的最后一个字母存储在一个 new`string`中，但它给了我一个错误：`"cannot implicitly convert "char" to string"`

```
current =Lat[j]; 
```

My `current`is a `string`，当我尝试使用时`#.ToString`，它给了我另一个错误： `Cannot convert method group 'ToString' to non-delegate type 'string'. Did you intend to invoke the method?`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:29:43.523

最简单的方法是

```
current = Lat[j].ToString(); 
```

或者

```
current = Lat.Substring(Lat.Length - 1); 
```

但是通过它的索引器访问字符串有点奇怪 - 如果您发布更多代码，可能会有一种更简洁的方式来满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:40:10.797

如果您想要字符串中的最后一个字符，请使用`System.Linq`检索最后一个字母。

```
string newString = original.Last().ToString();
// original.Last() gives you a char
// .ToString function after changes it to a string. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:30:02.143

使用`#.ToString()`方法将其转换为字符串。

像这样：`current = Lat[j].ToString()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T21:32:08.400

任何一个 `current =Lat[j].ToString();`

或者将 current 声明为 char （不能从您的使用情况中看出这是一个好主意）

# ruby-on-rails - Active_scaffold 添加到列表关联表列

> ID：14717274
> 
> 赞同：1
> 
> 时间：2013-02-05T21:28:36.907
> 
> 标签：ruby-on-rails, activescaffold

```
class Agency < ActiveRecord::Base
  has_many :events

  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  attr_accessible :name, :email, :phone, :address, :city, :state, :zip,
                  :notes, :is_admin, :password, :password_confirmation, :remember_me
end

class Event < ActiveRecord::Base
  belongs_to :agency
  has_many :consumers
 end

class Consumer < ActiveRecord::Base
  belongs_to :event
end 
```

在消费者控制器中，我试图包含**代理的一些字段**

```
 active_scaffold :consumer do |conf|
    list.columns = [
      :agency, :event
    ]
 end 
```

有这样的关联机构 -> 事件 -> 消费者。代理和消费者之间没有关联，只是通过事件。

但这会导致错误。

如何包括列出任何字段形式的代理表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:53:40.400

根据[wiki](https://github.com/activescaffold/active_scaffold/wiki/Getting-Started)，我认为您想要的是：

```
active_scaffold :consumer do |conf|
  conf.columns = [:agency, :event]
end 
```

此外，确保消费者有一个代理协会或专栏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T08:43:39.437

解决方案非常简单，但很可能效率低下。

我在消费者模型中添加了一个方法：

```
class Consumer < ActiveRecord::Base
  ...

  def agency_name
    self.event.agency[:name]
  end
end 
```

然后我添加了一个虚拟列来列出：

```
list.columns = [
  :agency_name, :event, ... ] 
```

就这样。

# google-app-engine - 我可以每 65 分钟运行一次 cron 作业吗？无法解析错误

> ID：14717281
> 
> 赞同：1
> 
> 时间：2013-02-05T21:28:49.863
> 
> 标签：google-app-engine

我正在尝试每 65 分钟运行一次 cron 作业。在 GAE 上上传应用程序时出现以下错误。

在“将 aws-spending 部署到 Google”期间发生内部错误。每 65 分钟同步的计划无法解析。

如果这是不可能的，有没有办法在另一个完成后运行一个 cron 作业？

**我的 cron.xml：**

```
<?xml version="1.0" encoding="UTF-8"?> 
<cronentries> 
    <cron> 
        <url>/metricsposter</url> 
        <description>Servlet that posts billing metrics to Graphite</description>
        <schedule>every 65 minutes synchronized</schedule> 
    </cron> 
</cronentries> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T01:55:52.457

它无法解析你的 cron.yaml

您可能忘记了 : after schedule。

提示：如果您希望人们能够帮助您，请显示您的代码。没有人会努力破解您的机器来调试您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T02:08:06.993

这似乎是 GAE 部分的错误。刚刚测试过 - 您可以设置 60、80 或 90 分钟，但不能设置 65、70,75 或 85 分钟。

你应该报错。

# asp.net - Entity Framework 5 + EntityDataSource + ASP.NET + .NET 4.0 找不到 CLR 类型

> ID：14717289
> 
> 赞同：2
> 
> 时间：2013-02-05T21:29:10.077
> 
> 标签：asp.net, .net-4.0, entity-framework-5, entitydatasource

我使用 Entity Framework 5.0 创建了一个 ORM。我在我的 ASP.NET 应用程序中添加了对 ORM 的引用。我正在尝试使用 EntityDataSource 来填充 DropDownList。我可以毫无问题地配置 EntityDataSource。但是，我无法使用向导为 DropDownBox 的值和文本设置数据字段，如果单击“Refersh Schema”按钮（在数据源配置向导中），我收到以下错误，“Schema could not由于来自 EntityDataSource 的以下错误而被确定：找不到“的 CLR 类型”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-14T18:47:02.807

试试这个：将模型的代码生成策略更改为默认值。删除 .tt 文件。保存、清理和重建。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-05T01:18:33.143

我刚刚失去了 2 个小时，因为我没有正确遵循 Insane4Sure 的指示。更改代码生成策略（在模型图（.edmx 文件）的空白处单击鼠标右键，然后单击属性。代码生成策略是第一个选项 - 将其设置为“Legacy ObjectContext”。这是重要的部分 - 删除所有 . tt 文件位于解决方案资源管理器中的 .edmx 文件下。我虽然将它们全部删除但没有。当您清理和构建时，您将能够单击“刷新架构”按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-25T01:21:10.877

更改代码生成策略对我不起作用。但是，将以下内容添加到我的 Web 配置文件中：

```
<compilation debug="true" targetFramework="4.5">
  <assemblies>
    <add assembly="System.Security, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
    <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
    <add assembly="System.Data.Entity.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  </assemblies>
</compilation> 
```

# authentication - Symfony2 身份验证 - 从数据库中验证用户

> ID：14717292
> 
> 赞同：0
> 
> 时间：2013-02-05T21:29:18.900
> 
> 标签：authentication, symfony

Symfony2 安全文档非常复杂并且没有很好的文档记录。

我有一个关于如何从数据库验证用户的问题。关于如何使用数据库表中的简单用户名和密码进行身份验证，没有很好的例子。

我的问题是，为了进行身份验证，我应该 1）实现 UserProviderInterface 接口并调用函数 loadUserByUsername 2）如果用户找到返回用户对象 3）检查表单提交的密码和用户对象密码是否匹配

它是否正确？

请指教

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T22:48:31.650

虽然我同意这有点复杂，但您需要的所有内容都已记录在案，并且通过一些研究并不难找到，希望以下内容可以帮助您：

如果您想通过 Doctrine ORM、MongoDB/CouchDB ODM 或 Propel 存储用户，请查看[FOSUserBundle 。](https://github.com/FriendsOfSymfony/FOSUserBundle)

如果您想完全构建自己的用户提供程序，请遵循[本](http://symfony.com/doc/2.0/cookbook/security/custom_provider.html)指南。

# ruby-on-rails - ActionView 中的 Heroku 未定义方法错误

> ID：14717303
> 
> 赞同：1
> 
> 时间：2013-02-05T21:29:58.233
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku

Heroku 日志显示以下错误：

```
ActionView::Template::Error (undefined method `accepted_answer_id' for #<Question:0x000000052fd1e0>) 
```

作为背景，我有一个模型`Question`，它的`has_many`答案。 `Question`还有一栏`accepted_answer_id`。

未定义的方法错误引用了一行`_question.html.erb`，其中它用于自定义在不同的阴影背景中显示答案计数

```
 <% if question.answers.count > 0 %> 

    <% if question.accepted_answer_id %>
        <div class="pickedanswer">
          <h4><%= question.answers.count %></h4>
        </div>
    <% else %>
        <div class="numanswer">
          <h4><%= question.answers.count %></h4>
        </div>
    <% end %>

  <% else %>

      <div class="noanswer">
        <h4><%= question.answers.count%></h4>
      </div>

  <% end %> 
```

我认为错误可能是由于最初`question.accepted_answer_id`是`nil`.. 但考虑到我构建逻辑的方式，我不知道为什么它不能简单地遵循（因为它在开发中已经成功完成）。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T21:33:53.690

您的架构缺少该属性。如果您的代码在本地工作，那么您要么手动添加了该列，要么迁移不在您的版本控制中。

你可以看到迁移是这样运行的：

```
$ heroku run rake db:migrate:status --app app_name 
```

这将显示您的任何迁移是否尚未运行。您应该将它们与您的本地迁移相匹配。你可能错过了一个吗？

运行`db:push`将**破坏您的远程数据库**并用本地副本替换它，充其量。通常你应该`pgbackups:restore`用来做这种事情（[https://devcenter.heroku.com/articles/heroku-postgres-import-export](https://devcenter.heroku.com/articles/heroku-postgres-import-export)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-01T16:25:23.440

我多次遇到这个问题，这些是我采取的步骤：

1.  首先确保你已经迁移了heroku上的数据库：

    ```
    heroku run rake db:migrate 
    ```

2.  确保数据库实际上是在 heroku 上迁移的：

    ```
    heroku pg:psql -a app_name
    \d table_name 
    ```

3.  最后在heroku上重启应用：

    ```
    heroku restart 
    ```

# c# - MVC4 共享模板

> ID：14717305
> 
> 赞同：3
> 
> 时间：2013-02-05T21:30:07.013
> 
> 标签：c#, asp.net, razor, asp.net-mvc-4, asp.net-mvc-areas

我有几个 MVC4 项目，我想制作一组在这些项目中重用的显示/编辑器模板。我想创建一个包含这些模板的通用项目，并在其他项目中引用它。

所以我在我的公共项目中定义了视图，以及其他一些实用程序：

```
Common
- Models
  - CommonMetadataAttribute.cs
- Views
  - Shared
    - EditorTemplates
      - Decimal.cshtml
      - Object.cshtml
      - Password.cshtml
      - String.cshtml
      - Switch.cshtml
    - ViewTemplates
      - Object.cshtml
      - Switch.cshtml
    - Error.cstml 
```

在我的客户项目模型中，我有

```
using MobileWeb.Common

public class MyViewModel
{
    [UIHint("Switch")]
    [CommonMetadata(Theme = "foo")]
    public bool Enable { get; set; }
} 
```

在客户端项目视图中，我可以通过简单地调用来生成我的自定义编辑器：

```
@model MyViewModel
...
@Html.EditorFor(model => model.Enable) 
```

理想情况下，客户项目可以用他们自己的模板覆盖，如果没有定义项目特定的模板，它就会回退到通用模板。

我考虑过 MvcContrib 的便携式区域，但我不确定它是否会起作用，因为这不是一个真正的区域，我真的不知道如何设置它。在我走这条路之前，我想知道这样做的首选方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:33:06.113

就我个人而言，我一直将模板打包为[`custom NuGets`](http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package). 您将自定义模板放在 NuGet 中，当用户在其项目中安装此 NuGet 时，它们会自动添加到其应用程序的正确文件夹中。并且整个应用程序中的所有 EditorFor/DisplayFor 调用都会自动开始使用您的自定义模板而不是默认模板。

这样，您无需编写一些自定义 VirtualPathProviders（一旦您预编译应用程序就会中断）来检索嵌入在第三方程序集中的 Razor 视图等等......使用 NuGets 的另一个优点是用户在他的应用程序中有您的模板，如果他对您的工作不满意，可以轻松修改它们。如果他真的生你的气，他只需要卸载你的 NuGet 以将他的应用程序回滚到默认状态。

# iphone - 选择 info.plist 文件

> ID：14717307
> 
> 赞同：8
> 
> 时间：2013-02-05T21:30:14.497
> 
> 标签：iphone, ios, xcode, ipad, cocoa-touch

我已经本地化了我的 Info.plist 文件，因为我必须为不同语言的应用程序使用不同的名称。

既然我这样做了，项目窗口就会显示这个按钮：选择 info.plist 文件。

![在此处输入图像描述](../Images/d9f17ddba44d9a1c059e19aee91083e1.png)

如果我单击此按钮，则会弹出一个没有选择的窗口。最糟糕的是，该项目将无法编译，并给出错误**错误：无法从'/Users/user/Documents/myApp/Info.plist'读取数据：无法打开文件“Info.plist”，因为那里是没有这样的文件。**

事实上，该消息是正确的，因为 Xcode 将其从该位置删除，并将 Info.plist 的副本添加到每个本地化目录（en.lproj、PT.lproj 等）。

那么......我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:09:13.447

在与 Xcode 战斗后，唯一可行的解​​决方案是：[http ://useyourloaf.com/blog/2010/12/15/localize-iphone-application-name.html](http://useyourloaf.com/blog/2010/12/15/localize-iphone-application-name.html)

你不能像我一样本地化 Info.plist。您必须创建一个字符串文件并将其本地化。一些魔术将字符串文件链接到 info.plist。

# android - 谷歌地图支持 OpenGL ES 1.0x Android 设备

> ID：14717308
> 
> 赞同：1
> 
> 时间：2013-02-05T21:30:23.307
> 
> 标签：android, google-maps, opengl-es

我正在使用 Gingerbread 2.3.3（API 级别 10）在 Android 中进行开发。

我担心 OpenGL 支持。[当前的 Google Maps Android API v2 需要 OpenGL 2.0](https://developers.google.com/maps/documentation/android/start#requiring_opengl_es_version_2)，而且最初的 Droids（和其他“旧”设备）似乎本身并不支持 OpenGL 2.0。[尽管存在将 OpenGL 2.0 添加到原始 Droid 的 hack](http://forum.xda-developers.com/showthread.php?t=620598)。地图是一项基本的移动功能/服务，我不喜欢使用[已弃用的代码](https://developers.google.com/maps/documentation/android/v1/)。

除了使用[Static Maps API v2](https://developers.google.com/maps/documentation/staticmaps/)之外，我如何支持具有地图功能的旧 OpenGL ES 1.0x Android 设备？[支持 google map apis (v1 and v2) 的最佳方式是什么](https://stackoverflow.com/q/13998911/363829)，涉及到这一点，但我需要支持 OpenGL ES 1.0X 设备。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:09:16.900

我不确定这个解决方案是否适合您，但我刚刚更新了我们的应用程序，将 Maps v1 和 v2 并行集成到其中。

我能够将我们所有的映射功能隐藏在一个接口后面，并且有两个实现——一个用于 V1，一个用于 V2。我将根据用户是否拥有新地图来实例化适当的类。

我的活动必须像以前一样扩展 MapActivity，并且您必须使用独立的 MapView 而不是 MapFragment（并将生命周期调用委托给它）。

这是更多的工作，但如果你想安全，这是可能的。

# regex - REGEX 如果它位于字段的前两个位置，则将 0 替换为 o

> ID：14717310
> 
> 赞同：1
> 
> 时间：2013-02-05T21:30:25.037
> 
> 标签：regex, perl, unix

我遇到了一个我认为很容易的问题

我有一个`aaa a0a 0a0`需要更改为的字段`aaa aoa oa0`

我拥有的正则表达式正在更改`a0a`为`ooa``0a0``oo0`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T21:50:13.110

您不必将所有工作都放在一个正则表达式中。为了可读性，在两个不同的正则表达式中执行此操作。

```
s/^0/o/;       # Change 0 to o in first column
s/^(.)0/$1o/;  # Change 0 to o in second column 
```

还有什么比这更清楚的呢？

记住，你不是为今天的你编码，你是为明天的你和明天的其他人编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:07:01.227

您可以使用如下表达式：

```
s/\b0|(?<=\b\S)0/o/g; 
```

例子：

```
perl -E "$_='aaa a0a 0a0 000'; say; s/\b0|(?<=\b\S)0/o/g; say" 
```

输出：

```
aaa a0a 0a0 000
aaa aoa oa0 oo0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T21:44:13.200

以下代码使用子字符串作为左值。如果您想转向`00a`，请`ooa`添加`/g`到替换中。

```
#!/usr/bin/perl
use warnings;
use strict;

my @ar = qw/aaa a0a 0a0 00a/;
for my $field (@ar) {
    substr($field, 0, 2) =~ s/0/o/;  # Only applied to the substring!
    print "$field\n";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T21:50:28.677

我认为这应该可以，但我对我的正则表达式有点生疏，所以如果这不是你想要的，所有这些都应该工作（我相信有更多的方法可以实现这一点）

```
# replace all zeros providing they are followed by an aplhanumeric character
s/0(?=\w)/o/g; 

# same as the above except reverted, replace zeros if not followed by space
s/0(?!\s)/o/g; 

# replace 0 followed by word non-boundary
s/0\B/o/g; 
```

# php - 我正在尝试使用 simpleXML 查找属性

> ID：14717311
> 
> 赞同：0
> 
> 时间：2013-02-05T21:30:28.017
> 
> 标签：php, simplexml

我有一个 simpleXML 输出：

```
SimpleXMLElement Object
(
    [@attributes] => Array
    (
        [version] => 2
    )
    [currentTime] => 2013-02-05 21:26:09
    [result] => SimpleXMLElement Object
    (
        [rowset] => SimpleXMLElement Object
        (
            [@attributes] => Array
            (
                [name] => characters
                [key] => characterID
                [columns] => name,characterID,corporationName,corporationID
            )
            [row] => Array
            (
                [0] => SimpleXMLElement Object
                (
                    [@attributes] => Array
                    (
                        [name] => Wrytha Cy
                        [characterID] => 209668693
                        [corporationName] => Deep Core Mining Inc.
                        [corporationID] => 1000006
                    )
                )
                [1] => SimpleXMLElement Object
                (
                    [@attributes] => Array
                    (
                        [name] => Eve Mae
                        [characterID] => 624980803
                        [corporationName] => Viziam
                        [corporationID] => 1000066
                    )
                )
                [2] => SimpleXMLElement Object
                (
                    [@attributes] => Array
                    (
                        [name] => Wrytha
                        [characterID] => 709227913
                        [corporationName] => The Flying Tigers
                        [corporationID] => 669350666
                    )
                )
            )
        )
    )
    [cachedUntil] => 2013-02-05 21:35:04
) 
```

我想循环使用我的 php 循环并获取“name”和“characterID”。我正在尝试类似的东西：

```
 $simpleXML = simplexml_load_string($xml); 

    foreach ($simpleXML->result->rowset->row as $row) {
        print_r($row);
        $name = $row['@attributes']['name'];
        echo $name.'<br>';
    } 
```

但 $name 没有被设置。这将是一些简单的事情，只是在我第一次使用 simpleXML 时没有看到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T13:18:50.193

使用语法访问属性`$element['attribute_name']`，因此在您的情况下，您需要`$row['name']`.

重要的是要记住 SimpleXML 对象是一种魔法 -和`$element->child`语法重载了正常的 PHP 逻辑以使其有用。同样，将为您提供元素的完整文本内容，但它在实际 XML 中被分解。`$element_list[0]``$element['foo']``(string)$element`

因此，`print_r`输出不会为您提供对象的“真实”视图，因此应谨慎使用。我在这里[编写了几个替代调试函数，](https://github.com/IMSoP/simplexml_debug)它们可以更准确地了解对象的行为方式。

# javascript - 包括第三方页眉和页脚

> ID：14717313
> 
> 赞同：3
> 
> 时间：2013-02-05T21:30:30.840
> 
> 标签：javascript, html

我有一个小型网络应用程序。我的客户在他们的网站上使用它。为了让它看起来无缝（他们自己网站的一部分），他们将我的应用程序放在他们网站上的 iframe 中。这样我就不必担心页眉和页脚（品牌/样式等）。现在由于某种原因，规格发生了变化，现在应用程序将不在 iframe 中。这导致了我必须为每个客户保持一致的页眉和页脚品牌/样式的问题。我有很多客户，我不可能维护每个客户并始终保持更新。

因此，我正在尝试提出允许我从客户端继承页眉和页脚并在我的网站上使用它的解决方案。我正在考虑告诉客户维护页眉和页脚 html 文件（并根据他们的品牌维护它）。然后我将进行 AJAX 调用并在我的页面上调用他们的 HTML 内容。这样我就不用担心页眉和页脚了。

您可以建议我解决此问题的其他方法吗？有遇到这种情况的经验吗？你是怎么处理的？

我知道这不是一个特定的编程问题，但我认为这是获得答案的最佳地点。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T15:14:23.020

`iframe`您可以将`header`and`footer`放在您的 Web 应用程序中，而不是将您的 Web 应用程序放在an`frame`中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T15:08:01.727

由于您使用的是 PHP，我可能会建议您包含一个“模板”目录，您可以根据客户端配置文件应用模板。

通常，将客户端页眉和页脚 HTML 文件位置存储在数据库中，并查找要使用的模板。然后在您的 PHP 头文件中，包括以下内容：

```
define('CLIENT_HEADER', '**header string returned from your database**');
define('CLIENT_FOOTER', '**footer string returned from your database**');

define('DEFAULT_HEADER', '**default header location in template dir**');
define('DEFAULT_FOOTER', '**default footer location in template dir**');

if (isset(CLIENT_HEADER)){
  include(CLIENT_HEADER);
} else {
  include(DEFAULT_HEADER);
}
     ...
       the body of your webpage
     ...
if (isset(CLIENT_FOOTER)){
  include(CLIENT_FOOTER);
} else {
  include(DEFAULT_FOOTER);
} 
```

当然，您需要根据您的特定应用程序对其进行自定义，但是一旦加载到数据库中，这将自动加载正确的页眉/页脚。如果页眉或页脚文件不在 PHP 服务器上，它认为它不会起作用，除非你弄乱了 php.ini 文件（我不是那个级别的专家，也许其他人可以对此发表评论）。

我希望这会有所帮助！

# json - Scala 使用 JSON.parseFull 时如何报告解析错误

> ID：14717316
> 
> 赞同：1
> 
> 时间：2013-02-05T21:30:35.033
> 
> 标签：json, scala

当我的应用程序输入语法不正确的 JSON 时，我希望能够向用户报告错误，并提供一些有用的细节，以便定位问题区域。

所以在这个例子中 j 将是 None 因为 "File1" 之后的尾随逗号。有没有办法获取最后解析错误的详细信息？

```
 val badSyntax = """
{
  "menu1": {
    "id": "file1",
    "value": "File1",
  },
  "menu2": {
    "id": "file2",
    "value": "File2",
  }
}"""

    val j = JSON.parseFull(badSyntax) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:50:41.330

当您收到解析错误时，使用`JSON.lastNoSuccess`获取最后一个错误。它的类型`JSON.NoSuccess`是两个子类，`JSON.Error`并且`JSON.Failure`都包含一个`msg: String`详细说明错误的成员。请注意，`JSON.lastNoSuccess`它不是线程安全的（它只是一个全局变量）并且现在已被弃用（在 scala 2.11 中必然会消失）

**更新**：显然，我错认为它不是线程安全的：在 scala 2.10 之前它确实不是线程安全的，但现在`lastNoSuccess`由线程局部变量支持（因此在多线程上下文中使用是安全的） . 看到这个之后，您会认为只要您在与用于进行解析的线程（您调用的线程）**相同的线程中**`parseFull`解析失败后立即阅读，那么一切都会按预期工作. 不幸的是，在此[重构](https://github.com/scala/scala/commit/1a4faa92faaf495f75a6dd2c58376f6bb3fbf44c)期间，他们还更改了内部使用的方式`lastNoSuccess`（`Parsers.phrase`由`JSON.parseFull`.`lastNoSuccess``None``Parsers.phrase`. 这在解析器中一般来说没有问题，因为`lastNoSuccess`它被用作作为结果返回的临时值`Parsers.phrase`。 **这里的问题是我们不调用`Parsers.phrase`, but `JSON.parseFull`，这会丢弃任何错误信息**（参见[https://github.com/scala/scala/blob/v2.10.0/src/library/scala/util/parsing](https://github.com/scala/scala/blob/v2.10.0/src/library/scala/util/parsing/json/JSON.scala)的`case None => None`内部方法[/json/JSON.scala](https://github.com/scala/scala/blob/v2.10.0/src/library/scala/util/parsing/json/JSON.scala)）。在 scala 2.10 之前，可以按照我之前的建议通过直接读取来轻松规避删除任何错误信息的事实，但是现在这个值在.`JSON.parseRaw``JSON.parseFull``JSON.lastNoSuccess``Parsers.phrase``JSON`

**有什么解决办法吗？**是的。您可以做的是创建您自己的版本`JSON`，不会丢弃错误信息：

```
import util.parsing.json._

object MyJSON extends Parser {
  def parseRaw(input : String) : Either[NoSuccess, JSONType] = {
    phrase(root)(new lexical.Scanner(input)) match {
      case Success(result, _) => Right(result)
      case ns: NoSuccess => Left(ns)
    }
  }

  def parseFull(input: String): Either[NoSuccess, Any] = {
    parseRaw(input).right.map(resolveType)
  }

  def resolveType(input: Any): Any = input match {
    case JSONObject(data) => data.transform {
      case (k,v) => resolveType(v)
    }
    case JSONArray(data) => data.map(resolveType)
    case x => x
  }
} 
```

我只是更改`Option`为`Either`作为结果类型，这样我就可以将解析错误作为`Left`. REPL 中的一些测试：

```
scala> MyJSON.parseFull("[1,2,3]")
res11: Either[MyJSON.NoSuccess,Any] = Right(List(1.0, 2.0, 3.0))

scala> MyJSON.parseFull("[1,2,3")
res12: Either[MyJSON.NoSuccess,Any] =
Left([1.7] failure: end of input

[1,2,3
      ^) 
```

# mysql - ColdFusion 仅从数据库返回部分字符串

> ID：14717331
> 
> 赞同：4
> 
> 时间：2013-02-05T21:31:38.370
> 
> 标签：mysql, database, string, coldfusion

我正在为我们的 CMS 构建一个搜索功能，本质上只是创建一个 cfquery，在我们的数据库中查找给定的文本。当我向浏览器显示结果时，我希望在结果中出现一段文本，其中包含搜索到的文本以及围绕它的一两个句子。所以这将是诸如 blah blah blah #FORM.searchedstring# blah blah blah 之类的东西。关于如何仅显示字符串的特定部分的任何想法？

谢谢

这是我写的

```
<cfquery datasource="#MyDatasource#" name="getstory">
SELECT *
FROM Stories
WHERE MYSTORIES.TEXT
LIKE '%#FORM.searchstring#%'
OR MYSTORIES.PAGETITLE
LIKE '%#FORM.searchstring#%'
OR MYSTORIES.HEADLINE
LIKE '%#FORM.searchstring#%'
OR MYSTORIES.SUBTITLE
LIKE '%#FORM.searchstring#%'
ORDER BY MNLSECTIONID
</cfquery> 
```

正文中是一个返回所有条目的 cfloop 查询。我只想返回 MYSTORIES.TEXT 中的特定部分，中间有 #FORM.searchstring#。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T22:25:23.287

您可以使用一个`FindNoCase()`函数来查找您的文本中的位置`#form.searchingstring#`

就像是

```
<cfset locationoftext = findnocase(form.searchstring,getstory.story)>
<cfdump var="#Mid(getstory.story,locationoftext-40,40)#"><Br>
<cfdump var="#Mid(getstory.story,locationoftext,40)#"> 
```

不确定这是否正是您所追求的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:20:53.073

另一种选择，可能会产生更准确的搜索结果，是使用 CFINDEX 将您的数据放入搜索集合（Verity 的 Solr 取决于您正在运行的 CF 版本），然后使用 CFSEARCH 搜索集合。您可以设置索引以返回数据中搜索词的实例，甚至可以轻松添加代码以突出显示所述实例。

[http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d04.html](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d04.html)

[http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d02.htm](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d02.htm)

# powershell - 输出对象数组 - 全部排在一行

> ID：14717335
> 
> 赞同：0
> 
> 时间：2013-02-05T21:31:53.067
> 
> 标签：powershell, powershell-2.0

我正在尝试为数组中的每个元素列出对象的一个​​属性。很好，但它们都显示在一条线上。我读过使用 $OFS 来设置分隔字符，但这也不起作用：

```
$filearray =@()
foreach($file in $files)
{
    # There is more logic here to determine what files are included
    $filearray = $filearray + $file  
}
$OFS = "`r`n"
$filearray | Select Fullname 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:20:11.560

使用 $OFS 的方法是将其设置为 CRLF，就像您在双引号字符串中评估数组变量一样，例如“$filearray”。如果它仍然显示在一行上，请检查 $filearray 的类型，正如@mjolinor 在他对他的回答的评论中所建议的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:12:51.943

我会明确地强制转换 $filearray 以确保它不会在代码中的其他地方被重置：

```
[array]$filearray = @() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T05:58:45.113

尝试在这一行强制输入：

```
[object[]]$filearray = $filearray + $file 
```

或更好

```
[object[]]$filearray += $file 
```

如果您知道 rigth 类型（`[fileinfo[]]`也许？），您可以更准确地强制 rigth 类型数组

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T22:10:55.747

为什么不这样：

```
$filecollection | where-object  { #condition } | select FullName 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T21:47:13.623

我会尝试这样的事情：

```
Foreach($file in $FileCollection)
{
 #Logic
  if($file #meets condition)
  {
    $filearray = $filearray + $file.Property
  }

} 
```

如果您知道名称，这将使用属性值加载数组。

# ios - 克隆 UIImage 对象时 UIImage 文件过多

> ID：14717336
> 
> 赞同：0
> 
> 时间：2013-02-05T21:31:57.433
> 
> 标签：ios, uiimage, clone

我正在使用以下代码基于图像文件创建单个 UIImage：

```
UIImage *myImage = [[UIImage alloc] initWithContentsOfFile:myImagePath]; 
```

然后我循环并将这个 myImage 添加到许多包含 UIImage 属性的对象中。这导致我收到以下错误：

> 错误 = 24（打开的文件太多）

我的问题是，如何在不克隆文件引用的情况下克隆这个 UIImage 。这似乎正在发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:42:20.607

将此行放在循环之外。

```
UIImage *myImage = [[UIImage alloc] initWithContentsOfFile:myImagePath]; 
```

# c++ - C++ 如何解析这个返回类型？

> ID：14717337
> 
> 赞同：2
> 
> 时间：2013-02-05T21:31:58.023
> 
> 标签：c++, boost, namespaces, operator-overloading, return

我正在阅读[这篇关于并行编程](http://solarianprogrammer.com/2013/02/04/sorting-data-in-parallel-cpu-gpu/)的文章，我遇到了一个`return`我不太理解的声明。我已经阅读了有关[命名空间](http://msdn.microsoft.com/en-US/library/c3ay4x3d%28v=vs.80%29)和[Boost::Chrono::steady_clock](http://www.boost.org/doc/libs/1_47_0/doc/html/chrono/reference.html#chrono.reference.cpp0x.system_clocks_hpp.steady_clock)的信息，尽管我从未在实践中使用过它们，但我了解它们的用途。

这是`run_tests`函数中让我感到困惑的代码行：

```
return boost::chrono::duration <double, boost::milli> (end - start).count(); 
```

这里到底发生了什么？对象名称不应该放在前面`.count()`吗？`-`Chrono中的运算符是否有一些重载？

[完整的代码可以在这里找到](https://github.com/sol-prog/Sort_data_parallel/blob/master/parallel_sort_CPU.cpp)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T21:36:48.033

```
 boost::chrono::duration 
```

是类模板的名称。

```
 boost::chrono::duration <double, boost::milli> 
```

是一个类模板的实例化，也就是一个类。

```
 boost::chrono::duration <double, boost::milli> (end - start) 
```

创建该类型的临时对象，使用表达式的值进行初始化`end-start`。

```
 boost::chrono::duration <double, boost::milli> (end - start).count() 
```

调用`.count()`临时对象的方法。

```
return boost::chrono::duration <double, boost::milli> (end - start).count(); 
```

返回`.count()`方法的结果。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-05T21:34:56.037

This much:`boost::chrono::duration <double, boost::milli> (end - start)`是在构造一个对象，很像`int(x)`。

然后`.count()`在该（临时）对象上调用，并且从中返回的是返回的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T21:35:37.577

这里分为三个部分。第一部分是简单的`end - start`。我不熟悉 Boost，但我敢打赌`end`并`start`做超载`operator-()`以减去两次并产生一个`boost:chrono:duration<>`对象。

然后将该对象传递给 的构造函数`boost::chrono::duration<double, boost::milli>`。我猜想这用于将持续时间从减法提供的任何格式转换为在此模板中看到的格式，即`double`表示毫秒的精度持续时间。

最后，`.count()`在这个`boost::chrono::duration`对象上调用该方法，它可能将持续时间的值作为一个数字返回（我猜是一个`double`）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T21:35:33.770

实际上`duration`是一种数据类型，`(end - start)`计算为构造函数的参数。

然后`count()`在构造的对象上调用，它恰好返回 a `double`，这是 的第一个`typename`参数`duration`。( `duration <double, boost::milli>`)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-05T21:36:24.320

代码首先构造一个临时的*未命名*类型的对象`boost::chrono::duration<double, boost::milli>`，将任何`end - start`内容传递给该对象的构造函数。

`count()`然后它在这个新的、未命名的对象上调用该方法。

该方法返回的内容就是该函数返回的内容。

# javascript - XSS 异常仅在 FireFox 18 上引发

> ID：14717339
> 
> 赞同：1
> 
> 时间：2013-02-05T21:32:06.460
> 
> 标签：javascript, ajax, firefox, xss

我有一些在 Chrome、Safari、IE 和 Opera 上运行良好的代码。但是由于某种原因，仅在 FireFox 18 上我遇到了这个问题

错误：访问属性“文档”的权限被拒绝 [中断此错误]

window.opener.document.getElementById("creditsTotal").innerText = credits;

这是有问题的代码（请记住，只有 ff18 会引发此 XSS 错误）

```
chat_client.rtmp.update_chat_status = function(){
            //console.log("The overridden method has been called.");
            if (!this.chat.current_chat_user)
                return;

            this.log("Updating chat session.");
            $.ajax({
                url: "{% url parthenon_chat.rtmp.views.update_chat_session %}",
                type: 'POST',
                data: {
                    'session_id': this.chat.session_ids[this.chat.current_chat_user],
                    'csrfmiddlewaretoken': CSRF_TOKEN
                },
                success: function(credits) { 

                    //make sure that credits var is integer and non-negative
                    var intRegex = /^\d+$/;
                    if(intRegex.test(credits)) {
                        console.log("Credits remaining: " + credits);
                       window.opener.document.getElementById("creditsTotal").innerText = credits;
                    }

                }
            }); 
```

有什么想法吗？我没有尝试使用旧版本的 ff18 来查看是否会得到相同的 XSS 异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T17:22:08.547

您知道这在 Internet Explorer 中不起作用，它仅在 caniuse.com 上具有部分功能

看到这个：[http ://caniuse.com/#feat=x-doc-messaging](http://caniuse.com/#feat=x-doc-messaging)

你必须有一个后备，即

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T15:24:50.530

安全异常似乎是由聊天应用程序将端口从子页面切换到父页面引起的，即使这是在同一个域上。对此的解决方案是使用 html5 规范 10.4，并在子窗口和父窗口上重新编写我的 javascript。这是当前 WHATWG 关于解决此 XSS 异常的规范：http: [//www.whatwg.org/specs/web-apps/current-work/multipage/web-messaging.html#web-messaging](http://www.whatwg.org/specs/web-apps/current-work/multipage/web-messaging.html#web-messaging)

# sml - sml中的foldl操作

> ID：14717347
> 
> 赞同：1
> 
> 时间：2013-02-05T21:32:37.577
> 
> 标签：sml

如果有人可以在这里指导我，我将不胜感激，我真的很想了解我做错了什么以及为什么？

这是我的代码：

```
fun get_longest xs = foldl((fn (x ,y ) => if  String.size x >= String.size y then x
else y),[],xs) 
```

我的函数应该接受一个字符串列表并返回最长的字符串；如果列表为空，只需`return []`.

但我收到了这个错误：

```
Error: operator and operand don't agree [tycon mismatch]
  operator domain: 'Z * 'Y -> 'Y
  operand:         (string * string -> string) * int * 'X
  in expression:
  foldl ((fn (<pat>,<pat>) => if <exp> then <exp> else <exp>),0,xs)

uncaught exception Error
  raised at: ../compiler/TopLevel/interact/evalloop.sml:66.19-66.27
             ../compiler/TopLevel/interact/evalloop.sml:44.55
             ../compiler/TopLevel/interact/evalloop.sml:296.17-296.20 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T21:57:05.297

看一下[foldl](http://www.standardml.org/Basis/list.html)的签名：

```
val foldl : ('a * 'b -> 'b) -> 'b -> 'a list -> 'b 
```

您可以看到您的函数应该具有以下形式

```
fun get_longest xs = foldl foo acc xs 
```

其中`foo`是函数适用于元素和累加器，并且`acc`是初始累加器。

**提示：**

1.  由于`get_longest`返回 a `string`，所以累加器应该有 type `string`。你的工作是找出一个合适的字符串来填充。注意`[]`你想要的值在这里没有意义。
2.  `xs`是 a `string list`，你的`foo`函数应该有 type `string * string -> string`。现在您必须用`foo`适当的匿名函数替换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T21:55:52.940

`foldl`是一个柯里化函数，它的类型是`('a * 'b -> 'b) -> 'b -> 'a list -> 'b`. 因此它应该被称为`foldl f s xs`。你称它为`foldl (f, s, xs)`. 这是错误的，因为它`foldl`以元组作为参数调用并且`foldl`不期望元组。如果是这样，它的类型将是`('a * 'b -> 'b) * 'b * 'a list -> 'b`.

# box2d - Box2D - 收集硬币

> ID：14717351
> 
> 赞同：2
> 
> 时间：2013-02-05T21:32:54.337
> 
> 标签：box2d, game-physics, box2dweb

我对 Box2D 还很陌生，我正在尝试制作一个简单的游戏，其中角色跳跃并捡起硬币。当检测到联系人时，我能够创建一个联系人监听器并删除硬币。问题是字符和硬币相撞。我能够过滤掉他们的联系方式，但我无法确定角色是否击中硬币。我相信肯定有一些相对简单的方法可以做到这一点，因为几乎每场比赛都有收藏品，但我只是没有找到实现这一点的方法。

感谢您的回答。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T23:41:21.070

你是对的，有这样的方法。只需在硬币的 b2FixtureDef 中将 isSensor 设置为 true。它将禁用硬币与实体的相互作用，但接触将继续创建。

[您可以在此处](https://www.iforce2d.net/b2dtut/sensors)找到有关 Box2D 中传感器的更多信息。

# tooltip - 工具提示中的高图表总数

> ID：14717353
> 
> 赞同：5
> 
> 时间：2013-02-05T21:32:57.053
> 
> 标签：tooltip, highcharts

我正在使用此代码显示共享工具提示：

```
tooltip: {
    crosshairs: true,
    shared: true,
    headerFormat: 'KW {point.key}<table>',
    pointFormat: '<tr><td style=\"color: {series.color}\">{series.name}: <b></td><td>{point.y} USD</b></td></tr>',
    useHTML: true,
    footerFormat: '</table>',
    valueDecimals: 2
}, 
```

现在我喜欢将所有 point.y 值添加为该点的总值。但是我如何循环每个系列的 point.y 来计算总值？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-06T08:09:33.583

Excatly，见例子：http: [//jsfiddle.net/65bpvudh/7/](http://jsfiddle.net/65bpvudh/7/)

```
tooltip: {
    formatter: function() {
        var s = '<b>'+ this.x +'</b>',
            sum = 0;

        $.each(this.points, function(i, point) {
            s += '<br/>'+ point.series.name +': '+
                point.y +'m';
            sum += point.y;
        });

        s += '<br/>Sum: '+sum

        return s;
    },
    shared: true
}, 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-11-29T20:39:54.327

使用[`footerFormat`](http://api.highcharts.com/highcharts/tooltip.footerFormat)属性（从 2.2 版开始）`{point.total}`可以轻松显示总数，而无需重新定义完整的`formatter`函数：

```
tooltip: {
    footerFormat: 'Sum: <b>{point.total}</b>',
    shared: true,
}, 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-11-13T12:56:40.550

更简单，使用点的总属性：

```
tooltip: {
    formatter: function() {
        var s = '<b>'+ this.x +'</b>';
        $.each(this.points, function(i, point) {
            s += '<br/>'+ point.series.name +': '+ point.y;
        });
        s += '<br/>Total: '+ this.points[0].total
        return s;
    },
    shared: true
},
```

检查此[参考](http://api.highcharts.com/highcharts#Point.total)

# c - Xcode 4.6 (4H127)，clang 警告 ISO-8859-1 编码的 o-umlaut (0xF6) 的“字符串文字中的非法字符编码”

> ID：14717356
> 
> 赞同：4
> 
> 时间：2013-02-05T21:33:16.443
> 
> 标签：c, utf-8, ascii, clang, xcode4.6

此代码在 Xcode 的先前版本中编译。我更新了 Xcode，现在编译失败。我猜我的代码有问题。下面代码中的问号是根据 ISO-8859-1 (0xF6) 编码的 o-umlaut (ö) ——我们习惯称这个上位（或扩展）ASCII。我猜编译错误与为clang迁移到UTF-8输入编码有关？

```
$ xcrun -sdk macosx10.8 -run clang -v
Apple LLVM version 4.2 (clang-425.0.24) (based on LLVM 3.2svn)
Target: x86_64-apple-darwin12.2.0

$ cat test.c
#include <stdio.h>
int main( int argc, char** argv )
{
    fprintf( stderr, "?\n" );
    return 0;
}

$ xcrun -sdk macosx10.8 -run clang -o test test.c 
test.c:4:23: warning: illegal character encoding in string literal [-Winvalid-source-encoding]
    fprintf( stderr, "<F6>\n" );
                      ^~~~
1 warning generated. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-06T18:17:38.583

因此，最新 Xcode (4.6) 中的 clang 似乎接受 UTF-8 编码并抱怨高位（或扩展）ASCII，因为根据[ISO-8859-1](http://en.wikipedia.org/wiki/ISO_8859-1)的通用字符集 (UCS) 代码点的高位 ASCII混合到您的source 不会产生正确的 UTF-8 编码。我没有检查发行说明以验证新的 clang 是否需要 UTF-8，但我将源代码更改为具有正确的 UTF-8 编码的小 o-umlaut，并且它已编译。

0xF6 或 246 是小 o-umlaut 的 UCS 代码点。但是，要以 UTF-8 对其进行正确编码，您不能只将 0xF6 放在文件中的单个字节中。正确的 UTF-8 编码是两个字节：0xC3 0xB6。请参阅下面的详细信息。所以破解打开你最喜欢的十六进制编辑器，用两个字符替换一个 0xF6 字符：0xC3 0xB6。

这是一个很棒的十六进制编辑器：[Hex Fiend](http://ridiculousfish.com/hexfiend/)

那么，如果您的问题角色不是 o-umlaut 怎么办？我列出了一些常见字符的列表，但您可以按照以下步骤查找任何其他 UTF-8 编码来解决您的特定问题：

```
| Char | ISO-8859-1 |   UTF-8   |
| ---- | ---------- | --------- |
|  ©   |    0xA9    | 0xC2 0xA9 |
|  ®   |    0xAE    | 0xC2 0xAE |
|  Ä   |    0xC4    | 0xC3 0x84 |
|  Å   |    0xC5    | 0xC3 0x85 |
|  Æ   |    0xC6    | 0xC3 0x86 |
|  Ç   |    0xC7    | 0xC3 0x87 |
|  É   |    0xC9    | 0xC3 0x89 |
|  Ñ   |    0xD1    | 0xC3 0x91 |
|  Ö   |    0xD6    | 0xC3 0x96 |
|  Ü   |    0xDC    | 0xC3 0x9C |
|  ß   |    0xDF    | 0xC3 0x9F |
|  à   |    0xE0    | 0xC3 0xA0 |
|  á   |    0xE1    | 0xC3 0xA1 |
|  â   |    0xE2    | 0xC3 0xA2 |
|  ä   |    0xE4    | 0xC3 0xA4 |
|  å   |    0xE5    | 0xC3 0xA5 |
|  æ   |    0xE6    | 0xC3 0xA6 |
|  ç   |    0xE7    | 0xC3 0xA7 |
|  è   |    0xE8    | 0xC3 0xA8 |
|  é   |    0xE9    | 0xC3 0xA9 |
|  ê   |    0xEA    | 0xC3 0xAA |
|  ë   |    0xEB    | 0xC3 0xAB |
|  ì   |    0xEC    | 0xC3 0xAC |
|  í   |    0xED    | 0xC3 0xAD |
|  î   |    0xEE    | 0xC3 0xAE |
|  ï   |    0xEF    | 0xC3 0xAF |
|  ñ   |    0xF1    | 0xC3 0xB1 |
|  ò   |    0xF2    | 0xC3 0xB2 |
|  ó   |    0xF3    | 0xC3 0xB3 |
|  ô   |    0xF4    | 0xC3 0xB4 |
|  ö   |    0xF6    | 0xC3 0xB6 |
|  ù   |    0xF9    | 0xC3 0xB9 |
|  ú   |    0xFA    | 0xC3 0xBA |
|  û   |    0xFB    | 0xC3 0xBB |
|  ü   |    0xFC    | 0xC3 0xBC |
|  ÿ   |    0xFF    | 0xC3 0xBF | 
```

只有较低的 ASCII（7 位字符）可以编码为 UTF-8 中的单个字符。请参阅[http://en.wikipedia.org/wiki/UTF-8](http://en.wikipedia.org/wiki/UTF-8)。

长度为 8-11 位的代码点在 UTF-8 中编码为：

```
110xxxxx  10xxxxxx 
```

在这种情况下，0xF6 后面不是以最高两位分别设置为 1 和 0 开头的内容被错误编码。

此 UCS 代码点（246 或 0xF6）在 UTF-8 中的正确编码是 0xC3 0xB6，如下所示：

```
11000011  10110110 
```

因为编码 0xF6 意味着取低 6 位并将它们插入第二个字节，而将高 2 位添加到第一个字节中。例子：

```
0xF6
11110110
   11    <-SPLIT->  110110
     \                 \
110xxxxx           10xxxxxx 
```

由于 0xF6 只有 8 位，所以第一个字节中的前 3 个 x 可以设置为 0。所以你得到：

```
11000011  10110110 
```

或者：

```
0xC3 0xB6 
```

希望这可以帮助您正确编码使 clang 窒息的任何文件。我似乎遇到了开源这个问题。很多时候，冒犯的角色出现在评论（作者姓名）中，在这种情况下，您可以将其修改为您想要的任何内容。有时您没有修改源代码的奢侈，在这种情况下，您应该修复编码并将补丁发送给维护者。

# javascript - Phonegap 拍照并将图像（BLOB）插入数据库 SQLite

> ID：14717357
> 
> 赞同：1
> 
> 时间：2013-02-05T21:33:22.447
> 
> 标签：javascript, jquery, sqlite, cordova

大家好，我一直在做一个项目来拍照并使用 phonegap/jQuery/html5 将它们存储在数据库中。数据库条目需要存储一些地理位置信息和相机拍摄的图像的BLOB。这是我用来尝试执行此操作的当前方法，但它不适合我。BLOB 总是会破坏我的插入语句。如果我将 smallImage 设置为“1”而不是图像数据，它可以正常工作。有没有更好的方法来插入这个 blob？当我查看日志时，它看起来像是 smallImage 被切断了。

```
var cameraLat;
var cameraLong;
var cameraTimestamp;
var destinationType;
var cameraLocationID;

function onGeoSuccess(position) {
    cameraLat = position.coords.latitude;
    console.log(cameraLat);
    cameraLong = position.coords.longitude;
    console.log(cameraLong);
    cameraTimestamp = position.timestamp;
    console.log(cameraTimestamp);
}

function geoFail(position) {
    alert('code: '    + error.code    + '\n' +
            'message: ' + error.message + '\n');
}

function onPhotoDataSuccess(imageData) {                
   // Get image handle 
    navigator.geolocation.getCurrentPosition(onGeoSuccess, geoFail);
    var smallImage = imageData;
    var Latitude = cameraLat;
    var longitude = cameraLong;
    var timestamp = cameraTimestamp;
    var LID = cameraLocationID;
    console.log(Latitude); //working
    console.log(longitude); //working
    console.log(timestamp); //working
    console.log(smallImage); // This cuts out and breaks my insert. 
    var db = window.openDatabase("MobilePhotos", "1.0", "MobilePhotosData", 1000000);   
    db.transaction(function (tx) {tx.executeSql('INSERT INTO Photos(PhotoID, PictureFile, Longitude, Latitude, Timestamp ) VALUES( '+ timestamp+LID+' ,' + smallImage + '", ' +  longitude +', '+ Latitude +', "'+ timestamp +'")')})
}

function take_pic(LocationID) {
    cameraLocationID=LocationID;
    navigator.camera.getPicture(onPhotoDataSuccess, function(ex) {alert("Camera Error!");}, { quality : 50, destinationType: Camera.DestinationType.DATA_URL });
} 
```

这是我尝试输入 BLOB 时遇到的错误：

```
02-05 16:10:19.702: W/System.err(12028): 
android.database.sqlite.SQLiteException: 
no such column: undefined (code 1): , while compiling:
INSERT INTO OrderPhotos(PhotoID, PictureFile, Longitude, Latitude, Timestamp ) 
VALUES( 1904010821 , "/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDABsS..(3825 characters) 
```

但我没有看到其他领域。有什么东西会破坏双引号吗？还是这里发生了其他事情？

如果我为 smallImage 输入“1”，我的输出工作正常，我得到：

```
INSERT INTO OrderPhotos(PhotoID, PictureFile, Longitude, Latitude, Timestamp ) 
VALUES( 1904010821 , "1", 39.10, -84.50, 190401082) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T21:53:55.370

您是否尝试过使用运算符`?`：

```
db.transaction(function(tx) {
  tx.executeSql("INSERT INTO OrderPhotos(PhotoID, PictureFile, Longitude, 
                  Latitude, Timestamp ) VALUES
                 ( 1904010821 , ? , 39.10, -84.50, 190401082)", 
   [PictureFile],
   function(tx, res) {
      ....
  });
 }); 
```

运算符`?`，比使用字符串连接更好。

用你的例子：

```
 db.transaction(function (tx) 
{tx.executeSql('INSERT INTO Photos(PhotoID, PictureFile, Longitude, Latitude, Timestamp ) 
VALUES( ?,?,?,?,?)')},[photoid, small photo, longitud, latitude, timestamp])} 
```

每个`?`以相同的顺序与每个 var 对应。

# android - 运行 Facebook 登录/发布为单独的类

> ID：14717358
> 
> 赞同：0
> 
> 时间：2013-02-05T21:33:24.493
> 
> 标签：android, facebook

我遵循了：[https](https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/) ://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/ 我已经创建了一个单独的页面，如示例中所示，并且工作得很好。

我现在的问题是我想将登录按钮添加到我的主页，并将发布按钮添加到不同的页面。是否可以将其转换为可以从任何地方调用的单独类？

有没有人这样做并且可以指出我正确的方向。抱歉，如果之前有人问过这个问题。我对 Facebook SDK 很陌生

谢谢你的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:30:14.203

是的，如果您使用活动会话，您应该能够从任何活动中调用 Session.getActiveSession()，它应该返回正确的东西。因此，带有登录按钮的页面将创建活动会话，带有发布按钮的页面将获得活动会话，并调用 requestNewPublishPermission 并进行发布。

有2个悬而未决的问题：

1.  您需要确保带有登录按钮的页面在您的应用程序中出现在带有发布按钮的页面之前（至少是第一次，当用户最初登录时）。

2.  在您的应用程序的后续重启中（在用户已经登录之后），您可以使用 UiLifecycleHelper 为您管理、恢复和自动打开活动会话。

# c# - 检查用户是否在未经授权的页面上

> ID：14717365
> 
> 赞同：3
> 
> 时间：2013-02-05T21:34:02.027
> 
> 标签：c#, asp.net, web-config

我在 web.config 中有一些如下所示的行：

```
 <authentication mode="Forms">
      <forms loginUrl="~/Account/Login.aspx" timeout="2880" />
    </authentication>

  <location path="Error.aspx">
    <system.web>
      <authorization>
        <allow users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="Default.aspx">
    <system.web>
      <authorization>
        <allow users="*"/>
      </authorization>
    </system.web>
  </location> 
```

我自己控制登录方法。假设用户未登录并登陆 abc.aspx 页面。Abc.aspx 页面未经登录是无权查看的，如上面的 web.config 所示，只允许使用 default.aspx 和 error.aspx。如何动态检查我当前所在的页面是否被 web.config 允许？我可以对其进行硬编码，但我想看看这是否可行，这样我所要做的就是在每次我想将页面添加到异常列表时修改 web.config 而不是我的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:49:23.737

在 authentcation 标签之后将它添加到您的 webconfig 中。这将确保未经授权的用户不会访问任何页面，您添加的其他标签应允许匿名访问您指定的页面。

```
<authorization>
  <deny users="?"/>
</authorization> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:43:25.340

在每个页面上，您可以添加：

```
 protected void Page_Load(object sender, EventArgs e)
    {
            if (!Request.IsAuthenticated)
            {
                Response.Redirect("~/Account/Login.aspx");
            }

    } 
```

# java - 如何将java字符串转换为不同的语言

> ID：14717367
> 
> 赞同：1
> 
> 时间：2013-02-05T21:34:19.567
> 
> 标签：java, string, utf-8, localization

目前我正在将一些文本写入pdf。根据用户区域设置，必须更改语言（例如：西班牙语、中文、德语）。

是否有任何用于此转换的 API？和更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:47:05.863

您需要翻译的每个字符串都有一个默认键：

```
title=The StackOverflow
content=The StackOverflow is an interesting site. 
```

这将存储在 EN 语言环境的 text_EN.properties 中。

对于其他语言，您将拥有 text_.properties。示例 text_FR.properties：

```
title=Le StackOverflow
content=Le StackOverflow est un site interessant. 
```

（标题、内容和其他键应该是您的键，并且在所有属性文件中都应该相同，因为这是您访问它们的方式。）

当您将文本写入 pdf 时，您将根据所需的语言环境/语言从相关属性文件中获取每个值。

如果您不想自己做，可以使用不同的模板语言。`Thymeleaf`想到了，但我认为也有`Velocity`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:48:18.760

您可以使用[ResourceBundles](http://docs.oracle.com/javase/7/docs/api/java/util/ResourceBundle.html)。您可以通过 Google 找到许多教程，例如[这个](http://docs.oracle.com/javase/tutorial/i18n/resbundle/index.html)。

# internet-explorer - 站点在 IE 中的显示与 Chrome 和 Firefox 完全不同

> ID：14717370
> 
> 赞同：0
> 
> 时间：2013-02-05T21:34:47.187
> 
> 标签：internet-explorer, google-chrome, firefox

这是我的网站：[http ://www.playerspace.com](http://www.playerspace.com)

在firefox中打开它很好用chrome打开它在IE中很好打开它完全搞砸了。

有任何想法吗？我可以理解一些细微的差异，但这里到底发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:38:54.867

您使用的是什么版本的 Internet Explorer？您是否在脚本中使用任何 html 5，因为我认为 Internet Explorer 不支持此功能（到目前为止）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:39:21.967

[这是这个常见的 IE 问题IE6-7-8-9.FIX](http://code.google.com/p/ie7-js/)的非常好的解决方案，它帮助了我

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T07:02:45.020

出于某种奇怪的原因，当我从 application.cfm 切换到 application.cfc 时发生了这种情况

我不知道为什么，但回到 .cfm 解决了这个问题。

# java - 运行 Android 测试 setUp() 方法被多次调用

> ID：14717378
> 
> 赞同：6
> 
> 时间：2013-02-05T21:35:07.067
> 
> 标签：java, android, eclipse, junit4

我正在为我的 android 应用程序创建一个测试套件并拥有这个 setUp 方法

```
 private static final String TAG_NAME = "TESTING_SUITE";
        public TestingMusicDAO musicDAO;
        public List<Song> songs;
        public Instrumentation instr;
        MusicService musicService;
    @Override
    public void setUp() throws Exception {
        instr = this.getInstrumentation();
        Log.d(TAG_NAME, "Setting up testing songs");
        musicDAO = new TestingMusicDAO(instr.getContext());
        musicService = new MusicServiceImpl(musicDAO);
        musicDAO.getAllSongsFromFile();
        songs = musicDAO.getAllSongs();
        for(Song song : songs)
            Log.d( TAG_NAME, song.toString() );
     } 
```

然后让这些测试由 python 工具从文本文件中创建

```
public void test1() {
    List<Song> testPlaylist;
    String testArtist = ("The Beatles");
    String actualArtist = ("TheBeatles"); 
    testPlaylist = testingPlaySongsByKeyword(testArtist);
    if(testPlaylist.isEmpty()){
        fail("No Songs Were Found");
    } else {
        for( Song loopsongs : testPlaylist){
            if (!(loopsongs.getArtist().equals(actualArtist))){
                fail("Song Doesnt Contain the artist" + actualArtist + "... Contains ->" + loopsongs.getArtist());
            }
        }
   }
} 
```

每次其中一个被调用时，musicDAO 都会重新生成。如何停止调用 setup 方法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T21:37:24.680

你没有。JUnit 的设计就是这样`setUp()`，**每次测试**`tearDown()`都完成一次。如果您希望每个类都完成，请在构造函数中完成。只要确保你不改变类内的任何东西。每次测试执行一次的原因是确保所有测试都以相同的数据开始。

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-06T10:19:52.317

您可以使用[`@BeforeClass`](http://junit.sourceforge.net/javadoc/org/junit/BeforeClass.html)和[`@AfterClass`](http://junit.sourceforge.net/javadoc/org/junit/AfterClass.html)来自 JUnit 的注释。

```
@BeforeClass
public static void test_setUp_Once(){
  // Code which you want to be executed only once
  createDb();
}

@AfterClass
public static void test_tearDown_Once(){
  // Code which you want to be executed only once
  deleteDb();
} 
```

注意：您需要声明这些方法`static`才能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-18T16:08:51.630

我有同样的基本问题。我希望能够测试我的数据库的结构，所以我在setUp方法中创建它并在tearDown中删除它。执行完所有测试后，使用构造函数并不能解决我删除数据库的需要，因此我使用了一些可重入逻辑：

```
static int testsExecutedSoFar = 0;
static boolean isFirstRun = true;

@Override
protected void setUp() throws Exception {
    if(isFirstRun){
        createDb();
        isFirstRun = false;
    }       
}

@Override
protected void tearDown() throws Exception{
    testsExecutedSoFar++;
    if (testsExecutedSoFar == totalNumberOfTestCases())
        deleteDb();     
}

private int totalNumberOfTestCases() {
    return countTestCases()+1; //have to add one for testandroidtestcasesetupproperly added by AndroidTestCase
} 
```

这些字段必须是静态的，因为 JUnit 会为每次运行创建一个新的类实例。魔术 1 必须添加，因为 AndroidTestCase 将它自己的测试 (testandroidtestcasesetupproperly) 添加到测试套件，但它不计入 countTestCases() 返回的数字。

有点丑陋的一面，但它成功了。**

# oracle - Oracle 构建自动化？

> ID：14717381
> 
> 赞同：0
> 
> 时间：2013-02-05T21:35:26.710
> 
> 标签：oracle, svn, oracle10g, oracle-sqldeveloper

我创建了许多表、函数、视图和过程脚本来支持报告。由于环境复杂，迁移脚本（开发-->测试）可能是一件苦差事。

DBA 不允许开发人员使用主表空间（'VENDOR'），也不允许使用任何主模式（'UTIL'、'REPORTING'）。UTIL 模式用于函数和过程；REPORTING 用于表和视图。

因为开发服务器经常为了其他目的而重新调试，所以开发是在测试服务器上完成的，使用开发表空间 ('DEVL') 和每个开发人员的模式（例如，'CRAIG'）。

因此，表的脚本必须转换为：

```
DROP TABLE CRAIG.X_TABLE;
CREATE TABLE CRAIG.X_TABLE;
...
TABLESPACE "DEVL"; 
```

到：

```
DROP TABLE REPORTING.X_TABLE;
CREATE TABLE REPORTING.X_TABLE;
...
TABLESPACE "VENDOR"; 
```

视图的脚本必须更改为：

```
CREATE OR REPLACE VIEW CRAIG.X_VIEW
...
; 
```

到：

```
CREATE OR REPLACE VIEW REPORTING.X_VIEW
...
; 
```

必须将过程的脚本更改为：

```
CREATE OR REPLACE PROCEDURE CRAIG.X_PROCEDURE
...
INSERT INTO CRAIG.X_PROCEDURE
SELECT ...
-- reference a table in REPORTING schema
FROM   REPORTING.ANOTHER_TABLE
; 
```

到：

```
CREATE OR REPLACE PROCEDURE UTIL.X_PROCEDURE
...
INSERT INTO REPORTING.X_PROCEDURE
SELECT ...
FROM   REPORTING.ANOTHER_TABLE
; 
```

如您所见，表格和过程脚本需要最多的干预。

如果有所作为，我使用 SQL Developer、TextMate 和 Sublime Text 2 进行编码，并使用 Cornerstone 与我们组织的 Subversion (SVN) 存储库进行交互。

当我将逻辑从开发环境迁移到测试环境时，有没有办法简化（即自动化）我需要对每种类型的脚本进行的更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:42:26.377

我会以架构所有者的身份连接；不确定您是否暗示您以一个用户的身份连接并在不同的模式中构建对象？即根本不限定表名等。并为该用户提供合适的默认表空间。然后脚本也不需要指定。也许我错过了什么？

如果您真的想指定它们，您可以在脚本开头提示并[接受这些值并使用](http://docs.oracle.com/cd/E11882_01/server.112/e16604/ch_five.htm#sthref498)[替换变量](http://docs.oracle.com/cd/E11882_01/server.112/e16604/ch_five.htm#CACIFHGB)：

```
accept schma char prompt 'Enter schema: '
accept tbspc char prompt 'Enter tablespace: '

create table &&schma..my_table (...) tablespace &&tbspc; 
```

等等

如果场景数量有限，您可以根据数据库名称自动设置值，假设不同的环境在不同的实例中：

```
column q_schma new_value schma
column q_tbspc new_value tbspc

select case name when 'TEST_NAME' then 'CBUCH' else 'PROD_USER' end as q_schma,
    case name when 'TEST_NAME' then 'TBSP_DEV' else 'PROD_SCHEMA' end as q_tbspc
from v$database;

create table &&schma..my_table (...) tablespace &&tbspc; 
```

您还可以更改默认架构以避免前缀：

```
alter session set current_schema = &schma
create table my_table (...) tablespace &&tbspc; 
```

另一种方法可能是在签入代码中使用占位符，并通过`sed`或类似方式运行代码以放入实际值。

# c# - scintilla.NET 书签 API

> ID：14717383
> 
> 赞同：2
> 
> 时间：2013-02-05T21:35:36.367
> 
> 标签：c#, text, bookmarks, scintilla

您如何使用书签并浏览它们而不迷失在索引中？！

这是书签代码片段：

```
private void btnBM(object sender, EventArgs e)
    {
        Line currentLine = scintilla1.Lines.Current;
        if (scintilla1.Markers.GetMarkerMask(currentLine) == 0)
        {
            currentLine.AddMarker(0);
        }
        else
        {
            currentLine.DeleteMarker(0);
        }
    } 
```

我想清除上一个指标并在下一个书签上放置一个指标，同时向下滚动以关注我尝试的下一个：

```
 scintilla1.Indicators[2].Search(scintilla1.GetRange(),scintilla1.GetRange(scintilla1.CurrentPos)).ClearIndicator(2);
        Range R;
            R = scintilla1.Markers.FindPreviousMarker().Range;   <-- Causes crashes bcoz of index 
                  scintilla1.Indicators[2].Style = IndicatorStyle.Box;
                  scintilla1.Indicators[2].Color = Color.DarkGoldenrod;
                  R.SetIndicator(2); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:32:18.483

我是这样做的，代码如下：

```
 private void button20_Click_1(object sender, EventArgs e)
    {
        scintilla1.GetRange().ClearIndicator(2);
        scintilla1.Indicators[2].Style = IndicatorStyle.Box;
        scintilla1.Indicators[2].Color = Color.Cyan;
        try
        {
            Line next = scintilla1.Markers.FindNextMarker(); //replace with previous to get the previous on the control bookmark

            scintilla1.Caret.Position = next.EndPosition;
            next.Range.SetIndicator(2);
            scintilla1.Caret.Goto(next.EndPosition);
            scintilla1.Focus();        
        }
        catch (Exception ex)
        {
            MessageBox.Show("No more marks.. " + ex.Message);
        }
    } 
```

# oracle - 从 Grails 调用 Oracle 包

> ID：14717386
> 
> 赞同：1
> 
> 时间：2013-02-05T21:35:44.230
> 
> 标签：oracle, grails, stored-procedures, groovy

有没有办法在 Oracle 包中调用函数/过程？我可以像这样调用存储过程：

> sql.call '调用 myproc(param1,param2)'

当我尝试将相同的东西应用于一个包时：

> sql.call '调用 mypackage.myfunction(param1,param2)'

我遇到了错误：ORA-06576: not a valid function or procedure name

有什么帮助吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:10:57.787

试试这个语法：

```
sql.call '{call mypackage.myproc(?,?)}', [p1, p2] 
```

如果它是一个函数：

```
sql.call '{? = call mypackage. myfunction(?,?)}', [result, p1, p2] 
```

# firefox - mac os 上的 Firefox 书签

> ID：14717387
> 
> 赞同：1
> 
> 时间：2013-02-05T21:35:55.520
> 
> 标签：firefox, bookmarklet

我正在寻找`location`在 Mac 上更改 Firefox 书签的字段（以编程方式 -> 通过代码）。它们存储在哪里。我已经搜索过，但找不到位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:51:41.917

它们存储在配置文件文件夹内的 places.sqlite 数据库中。

# vim - Vim 短绑定 | 不工作

> ID：14717388
> 
> 赞同：1
> 
> 时间：2013-02-05T21:35:57.113
> 
> 标签：vim

尝试将水平最大化映射到更少的两次击键，但这些都不起作用：

```
nnoremap <leader>\ <c-w>| " Maximize horizontally

nnoremap <c-\\> <c-w>|  " Maximize horizontally 
```

同时这两个工作正常：

```
nnoremap <leader>- <c-w>_ " Maximize vertically
nnoremap <leader>= <c-w>= " Restore default size 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T21:47:52.290

条形字符`|`是 Vim 脚本中的命令分隔符。要在映射中使用它，请使用`<Bar>`：

```
nnoremap <Leader>\ <C-W><Bar> 
```

相关文档位于[`:h map_bar`](http://vimdoc.sourceforge.net/htmldoc/map.html#map_bar)。

# r - gsub 提取两个单词

> ID：14717389
> 
> 赞同：1
> 
> 时间：2013-02-05T21:35:57.893
> 
> 标签：r, gsub

我无法理解`gsub()`。如果文本是：

```
 text <- "Genus_species_1652_NL" 
```

我将如何提取得到

```
"Genus species" 
```

谢谢。这是一个有用的链接，但我无法对其进行排序 [http://biostat.mc.vanderbilt.edu/wiki/pub/Main/SvetlanaEdenRFiles/regExprTalk.pdf](http://biostat.mc.vanderbilt.edu/wiki/pub/Main/SvetlanaEdenRFiles/regExprTalk.pdf)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:45:21.120

你可以这样做：

```
> gsub('([A-z]+)_([A-z]+)_.*', '\\1 \\2', text)
[1] "Genus species" 
```

但正如评论中提到的，像 strsplit 这样的工具可能更有用。

# c# - NHibernate 只保存对象的一部分

> ID：14717390
> 
> 赞同：0
> 
> 时间：2013-02-05T21:36:11.617
> 
> 标签：c#, asp.net-mvc, nhibernate

应用程序组件：NHibernate 3.3 FluentNHibernate 1.3 我目前只使用 Automapping（也许这就是问题所在）。

我是 NHibernate 的新手，所以这可能是一个简单的问题。

这是基本结构（不是实际的类）。

```
class Family
{
   public virtual Guid ID { get; set; }
   public virtual IList<Person> Members { get; set; }
}
class Person
{
   public virtual Guid ID { get; set; }
   public virtual Family Family { get; set; }
   public virtual string Name { get; set; }
} 
```

我有一个人的“编辑”视图，它将 ID 作为参数。Action 然后按 ID 加载 Person 对象并呈现视图。

问题是当我更改某些内容并将其发回时，`Person`对象的`Family`成员为空，因此当它保存时，Person 不再有家庭:(

我尝试添加一个“FamilyID”属性，然后将其作为视图中的隐藏属性，但是 NHibernate 持续存在它存在问题（如果这是应该工作的方式，我可以发布错误）。

我可以在发回 Person 对象时加载它，然后复制一些信息，但这对我来说似乎是错误的......

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:45:47.610

> 我可以在发回 Person 对象时加载它，然后复制一些信息，但这对我来说似乎是错误的......

如果您的视图中的 Family 属性没有相应的输入字段，则这些值将永远不会发送回您的控制器。因此，在更新您的 Person 对象之前，您应该使用数据库中的 FamilyID（您将使用隐藏字段发送）检索它们。这才是正确的流程。

* * *

更新：

据说处理这种情况的最佳方法是使用视图模型（DUH）。因此，您将设计一个视图模型，该模型仅包含用户在视图中应该编辑的属性。然后，您将使视图强类型化到视图模型，并且您的 HttpPost 控制器操作将视图模型作为参数。在此操作中，您将加载需要从数据库更新的整个 Person 域，设置从视图模型修改的属性（使用诸如 之类的工具非常容易[`AutoMapper`](https://github.com/AutoMapper/AutoMapper)），然后将您的域模型持久化回数据库。只有作为视图一部分的属性才会从此 Person 域模型中修改。

# sql - SQL 查询：计算时间序列中的增量

> ID：14717393
> 
> 赞同：6
> 
> 时间：2013-02-05T21:36:17.580
> 
> 标签：sql, ms-access

对于一个发展援助项目，我正在帮助尼加拉瓜的一个小镇改善他们的供水网络管理。

大约有 150 户家庭，每个月都有一个人查表并根据用水量（本月读数减去上月读数）向家庭收费。今天一切都在纸上完成，我想将管理数字化以避免计算错误。

我有一个 MS 访问表 - 例如：

```
*HousholdID*  *Date*     *Meter*
0             1/1/2013   100
1             1/1/2013   130
0             1/2/2013   120
1             1/2/2013   140
... 
```

根据这些数据，我想创建一个查询来计算消耗的水（一个家庭两个月之间的米差）

```
*HouseholdID*  *Date*     *Consumption*
0              1/2/2013   20
1              1/2/2013   10
... 
```

请问，我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T22:01:06.340

即使缺少月份，此查询也会返回具有前一个日期的每个日期：

```
SELECT TabPrev.*, Tab.Meter as PrevMeter, TabPrev.Meter-Tab.Meter as Diff
FROM (
  SELECT
    Tab.HousholdID,
    Tab.Data,
    Max(Tab_1.Data) AS PrevData,
    Tab.Meter
  FROM
    Tab INNER JOIN Tab AS Tab_1 ON Tab.HousholdID = Tab_1.HousholdID
                                 AND Tab.Data > Tab_1.Data
  GROUP BY Tab.HousholdID, Tab.Data, Tab.Meter) As TabPrev
  INNER JOIN Tab
  ON TabPrev.HousholdID = Tab.HousholdID
     AND TabPrev.PrevData=Tab.Data 
```

结果如下：

```
HousholdID  Data        PrevData    Meter  PrevMeter  Diff
----------------------------------------------------------
0           01/02/2013  01/01/2013  120    100        20
1           01/02/2013  01/01/2012  140    130        10 
```

上面的查询将返回每个增量、每个家庭、每个月（或每个时间间隔）。如果您只对最后一个 delta 感兴趣，可以使用以下查询：

```
SELECT
  MaxTab.*,
  TabCurr.Meter as CurrMeter,
  TabPrev.Meter as PrevMeter,
  TabCurr.Meter-TabPrev.Meter as Diff
FROM ((
  SELECT
    Tab.HousholdID,
    Max(Tab.Data) AS CurrData,
    Max(Tab_1.Data) AS PrevData
  FROM
    Tab INNER JOIN Tab AS Tab_1
        ON Tab.HousholdID = Tab_1.HousholdID
           AND Tab.Data > Tab_1.Data
  GROUP BY Tab.HousholdID) As MaxTab
  INNER JOIN Tab TabPrev
  ON TabPrev.HousholdID = MaxTab.HousholdID
     AND TabPrev.Data=MaxTab.PrevData)
  INNER JOIN Tab TabCurr
  ON TabCurr.HousholdID = MaxTab.HousholdID
     AND TabCurr.Data=MaxTab.CurrData 
```

并且（取决于您所追求的）您只能过滤当前月份：

```
WHERE
  DateSerial(Year(CurrData), Month(CurrData), 1)=
  DateSerial(Year(DATE()), Month(DATE()), 1) 
```

这样，如果您错过了特定家庭的支票，它将不会显示。或者您可能有兴趣在表格中显示上个月（可能与当前月份不同）：

```
WHERE
  DateSerial(Year(CurrData), Month(CurrData), 1)=
  (SELECT MAX(DateSerial(Year(Data), Month(Data), 1))
  FROM Tab) 
```

（在这里我考虑到支票可能在不同的日子进行）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T21:55:28.493

我认为最好的方法是使用相关子查询来获取上一个日期并加入原始表。这可确保您获得之前的记录，即使滞后时间多于或少于 1 个月。

所以正确的查询看起来像：

```
select t.*, tprev.date, tprev.meter
from (select t.*,
             (select top 1 date from t t2 where t2.date < t.date order by date desc
             ) prevDate
      from t
     ) join
     t tprev
     on tprev.date = t.prevdate 
```

在您所描述的环境中，不要对抄表频率做出假设是非常重要的。尽管它们可能平均每月阅读一次，但总会有例外。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T21:48:03.903

使用以下数据进行测试：

```
HousholdID  Date        Meter
0           01/12/2012  100
1           01/12/2012  130
0           01/01/2013  120
1           01/01/2013  140
0           01/02/2013  120
1           01/02/2013  140 
```

以下查询：

```
SELECT a.housholdid, 
   a.date, 
   b.date, 
   a.meter, 
   b.meter, 
   a.meter - b.meter AS Consumption
FROM   (SELECT * 
    FROM   water 
    WHERE  Month([date]) = Month(Date()) 
           AND Year([date])=year(Date())) a 
   LEFT JOIN (SELECT *
              FROM water
              WHERE DateSerial(Year([date]),Month([date]),Day([date]))
               =DateSerial(Year(Date()),Month(Date())-1,Day([date])) ) b 
   ON a.housholdid = b.housholdid 
```

上面的查询选择本月的记录`Month([date]) = Month(Date())`并将它们与上个月的记录进行比较`([date]) = Month(Date()) - 1)`

**请不要使用日期作为字段名称。**

返回以下结果。

```
housholdid  a.date      b.date      a.meter b.meter Consumption
0           01/02/2013  01/01/2013  120     100     20
1           01/02/2013  01/01/2013  140     130     10 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T21:56:21.997

尝试

```
select  t.householdID
       , max(s.theDate) as billingMonth
       , max(s.meter)-max(t.meter) as waterUsed
from    myTbl t join (
    select  householdID, max(theDate) as theDate, max(meter) as meter
    from    myTbl 
    group by householdID ) s 
        on t.householdID = s.householdID and t.theDate <> s.theDate
group by t.householdID 
```

这适用于 SQL 不确定访问

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-23T22:03:43.137

您可以在某些 SQL 方言中使用 LAG() 函数。我发现这比连接更快、更容易阅读。

资料来源：[http ://blog.jooq.org/2015/05/12/use-this-neat-window-function-trick-to-calculate-time-differences-in-a-time-series/](http://blog.jooq.org/2015/05/12/use-this-neat-window-function-trick-to-calculate-time-differences-in-a-time-series/)

# ruby-on-rails - Rails 与 PostgreSQL 每次请求重新连接多次

> ID：14717394
> 
> 赞同：1
> 
> 时间：2013-02-05T21:36:23.120
> 
> 标签：ruby-on-rails, ruby, macos, postgresql, pg

我最近遇到了一个问题，Rails 正在断开与我的 PostgreSQL 的连接，导致每个请求多次重新连接，从而显着降低了请求速度。我目前正在使用以下环境在 Mac OS X 上本地运行所有内容：

*   Mac OS X 10.8（山狮）
*   战俘
*   NginX (ssl unwrapping - 相同的应用程序重新连接行为即使没有启用此功能)
*   PostgreSQL 9.2.2 通过 Homebrew
*   导轨 3.2.11

这是我的`database.yml`：（*数据库和用户名已编辑）*

```
development:
  adapter: postgresql
  encoding: unicode
  database: <database>
  pool: 5
  username: <user>
  password: 
```

`development.log`这是典型请求期间的输出：（*特定模型和渲染已编辑）*

```
Connecting to database specified by database.yml

Started GET "/" for 127.0.0.1 at 2013-02-05 12:25:38 -0800
Processing by HomeController#index as HTML
  ... <app performs model loads and render calls>
Completed 200 OK in 314ms (Views: 196.0ms | ActiveRecord: 60.9ms)
Connecting to database specified by database.yml
Connecting to database specified by database.yml 
```

我还在 Postgres 中启用了语句日志记录，以便更好地了解在给定请求期间数据库端到底发生了什么。这是来自的输出`postgresql-<date>.log`：（*特定于我的应用程序的查询已编辑）*

```
LOG:  connection received: host=[local]
LOG:  connection authorized: user=<user> database=<database>
LOG:  statement: set client_encoding to 'UTF8'
LOG:  statement: set client_encoding to 'unicode'
LOG:  statement: SHOW client_min_messages
LOG:  statement: SET client_min_messages TO 'panic'
LOG:  statement: SET standard_conforming_strings = on
LOG:  statement: SET client_min_messages TO 'notice'
LOG:  statement: SET time zone 'UTC'
LOG:  statement: SHOW TIME ZONE
LOG:  statement: SELECT 1
LOG:  statement: SELECT 1
    ... <app makes queries for request>
LOG:  disconnection: session time: 0:00:01.346 user=<user> database=<database> host=[local]
LOG:  connection received: host=[local]
LOG:  connection authorized: user=<user> database=<database>
LOG:  statement: set client_encoding to 'UTF8'
LOG:  statement: set client_encoding to 'unicode'
LOG:  statement: SHOW client_min_messages
LOG:  statement: SET client_min_messages TO 'panic'
LOG:  statement: SET standard_conforming_strings = on
LOG:  statement: SET client_min_messages TO 'notice'
LOG:  statement: SET time zone 'UTC'
LOG:  statement: SHOW TIME ZONE
LOG:  statement: SELECT 1
LOG:  connection received: host=[local]
LOG:  connection authorized: user=<user> database=<database>
LOG:  statement: set client_encoding to 'UTF8'
LOG:  statement: set client_encoding to 'unicode'
LOG:  statement: SHOW client_min_messages
LOG:  statement: SET client_min_messages TO 'panic'
LOG:  statement: SET standard_conforming_strings = on
LOG:  statement: SET client_min_messages TO 'notice'
LOG:  statement: SET time zone 'UTC'
LOG:  statement: SHOW TIME ZONE
LOG:  statement: SELECT 1
LOG:  statement: SELECT 1
LOG:  statement: SELECT 1
LOG:  disconnection: session time: 0:00:00.750 user=<user> database=<database> host=[local]
LOG:  disconnection: session time: 0:00:00.733 user=<user> database=<database> host=[local] 
```

我很高兴更新相关配置或命令调用的日志输出。另外，为什么所有的`SELECT 1`电话？他们的目的是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-05T09:11:42.873

答案是将 PostgreSQL 升级到更新的版本。我刚刚升级到原始问题中使用的`9.2.4`from`9.2.2`并且问题完全消失了，预期的性能特征返回到我的开发应用程序。

# backbone.js - 骨干关系：未捕获的类型错误：无法读取 null 的属性“id”

> ID：14717396
> 
> 赞同：1
> 
> 时间：2013-02-05T21:36:30.433
> 
> 标签：backbone.js, backbone-relational

我在尝试在我们的应用程序中实现**骨干关系时遇到问题。**

尝试获取 RelationalModel 后出现此错误： 未捕获的类型错误**：无法读取 null 的属性“id”**

## 这是模块

```
App.Models.Story = Backbone.RelationalModel.extend({
urlRoot: '/rest/v1/story/',
url:function(){
     if (this.isNew()) {
          return this.urlRoot;
    } else {
     return  this.urlRoot + this.id + "/";
    } 
},
idAttribute: 'id',
relations: [{
      type: Backbone.HasMany,
      key: 'pieces',
      createModels: true,
      relatedModel: 'App.Models.Piece',
      collectionType: 'App.Collections.Pieces',
      includeInJSON: false,
      reverseRelation: {
         key: 'story'
     }
  }],
     initialize: function(){
         this.get('pieces').url = _.bind(function(){
             return this.url() + "piece/"
         }, this);
        console.log("hello from story model");
    }
}); 
```

**这是集合**

```
 App.Collections.Stories = Backbone.Collection.extend({
 url:'/rest/v1/story/',
 model: App.Models.Story
}); 
```

我像这样从我的 API 中检索数据

```
get all stories    : GET /rest/v1/story/
get story no' 10   : GET /rest/v1/story/10/
get story pieces   : GET /rest/v1/story/10/piece/
get piece no' 612  : GET /rest/v1/piece/612/ 
```

现在当我尝试做

```
var story = App.Models.Story({id:10});
story.fetch() 
```

我收到此错误： **未捕获的类型错误：无法读取 null 的属性“id”**

对象本身通过响应的 Json 成功创建。

该错误使 RelationalModel 无法建立关系。

谢谢。

# ruby - 具有多个源文件的 Ruby 组织

> ID：14717397
> 
> 赞同：0
> 
> 时间：2013-02-05T21:36:35.803
> 
> 标签：ruby, yaml, organization

我正在尝试找出组织一堆 Ruby 脚本的最佳方法，以使下一个人更容易。一件关键的事情是，需要在所有脚本中使用多个常量变量。这些应该存放在哪里？我是否为这些常量保留一个单独的文件？我应该使用 YAML 吗？我从来不需要创建一个包含多个相互交互的 Ruby 源文件的项目，所以我不确定这里的最佳方法是什么。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:39:03.010

我喜欢为`config.yaml`我的所有常量使用一个文件。这使得设置和更改将在不同文件中使用的变量变得容易。然后你需要做的就是读入文件并设置变量。只要使用该文件的任何人都具有读取权限，您就可以将该文件保存在任何地方。您所要做的就是设置文件路径。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T01:11:38.977

我喜欢做一个 config.yml 或 settings.yml，但我也允许 config.yml 中定义的变量可以被 ENV 变量重载（在你的情况下可能有点过分）。

在配置加载/设置代码中设置一些默认值可能也是一个好主意。

就常用函数/方法而言... common.rb 是一个不错的名称，或者可能是 shared.rb。

# java - 使用 JLabel 持续更新 Java 中的分数，基于 JFrame 的游戏

> ID：14717399
> 
> 赞同：0
> 
> 时间：2013-02-05T21:36:42.830
> 
> 标签：java, swing, jlabel, runnable, pong

我正在用 Java 构建一个小“乒乓”游戏。

我正在尝试在顶部添加一个记分员，每次玩家用桨保存球时都会显示更新的分数（+1）。

我正在尝试使用 JLabel，但问题是我想不出一种方法来在每次击球时不断更新 JLabel。

有任何想法吗？

我的代码：

MainPanel 类（带有 Paddle、Ball 和 Label 的类）

```
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;

import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;

//import swing.graphics.BounceFrame;
//import swing.graphics.Circle;

public class MainPanel extends JPanel implements ActionListener, KeyListener, Runnable{

    public Paddle paddle;
    public Ball ball;

    public MainPanel(){
        ball = new Ball(50, 50, 10); //centerX, centerY, radius
        setSize(300, 300);
        paddle = new Paddle();
        JLabel scoreKeeper = new JLabel("Score" + ball.getScore());
        add(scoreKeeper);
        Thread thread = new Thread(this);
        thread.start();
    }

    public void paint(Graphics g) {
        super.paint(g);
        Graphics2D g2 = (Graphics2D)g;
        paddle.draw(g2);
        ball.draw(g2);
    }

    public void actionPerformed(ActionEvent e) {
        String direction = e.getActionCommand();

        switch(direction){
            case "left": Paddle.movePaddleLeft(); break;
            case "right": Paddle.movePaddleRight(); break;
        }
        this.repaint();
    }

    public void run() {
        try {
            while(true){
                    ball.move(getBounds());
                repaint();
                Thread.sleep(500/30);
            }
            }
        catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Override
    public void keyPressed(KeyEvent e) {
        if (e.getKeyCode() == 37){
            Paddle.movePaddleLeft();
        }
        if (e.getKeyCode() == 39){
            Paddle.movePaddleRight();
        }
    }

    @Override
    public void keyReleased(KeyEvent e) {

    }

    @Override
    public void keyTyped(KeyEvent e) {

    }
} 
```

还有我的 Ball 课：

导入 java.awt.Color；导入 java.awt.Graphics2D；导入 java.awt.geom.Ellipse2D；导入 java.awt.geom.Rectangle2D；导入 java.util.Random；

```
public class Ball {

    private Ellipse2D ball;
    private double radius;
    private double ballCircumference;
    private Color color;

    private double x;
    private double y;
    private double dx = 5;
    private double dy = 5;

    private int score = 0;
    public int getScore() {
        return score;
    }
    //Boundaries to determine if ball is hit by paddle
    private double criticalBoundaryX;
    private double criticalBoundaryY1; 
    private double criticalBoundaryY2;
    private double paddleHalfwayPoint;
    private boolean inGame = true;
    public void recalculateCriticals(){
        criticalBoundaryX = Paddle.getYPosition() - ballCircumference;
        criticalBoundaryY1 = Paddle.getXPosition()- ballCircumference; //Left boundary
        criticalBoundaryY2 = Paddle.getXPosition()+Paddle.getPaddleWidth()+ballCircumference; //Right Boundary
        paddleHalfwayPoint = (Paddle.getXPosition()+Paddle.getPaddleWidth())/2;
    }

    public Ball(int centerX, int centerY, int radius) {
        this.x = centerX - radius;
        this.y = centerY - radius;
        this.radius = radius;
        ballCircumference = 2*radius;
        Random randomRGB = new Random();
        color = new Color(randomRGB.nextInt(255), randomRGB.nextInt(255), randomRGB.nextInt(255));
        this.ball = new Ellipse2D.Double(x, y, 2*radius, 2*radius);
    }

    public void move(Rectangle2D bounds) {
        recalculateCriticals();
        x += dx;
        y += dy;
        if (x < bounds.getMinX()) {
            x = bounds.getMinX();
            dx = -dx;
        }
        if (x + 2*radius >= bounds.getMaxX()) {
            //System.out.println(bounds.getMaxX());
            x = bounds.getMaxX() - 2*radius;
            dx = -dx;
        }
        if (y < bounds.getMinY()) {
            y = bounds.getMinY();
            dy = -dy;
        }
        if (y > criticalBoundaryX){
             if (x < criticalBoundaryY1 || x > criticalBoundaryY2){
                 inGame = false;
             }
             if (!inGame && hittingEdge(x))
                 dx = -dx;
        }
        if (y > criticalBoundaryX && inGame){ //When it hits the paddle
            changeColor();
            score++;
            y = criticalBoundaryX;
            dy = -dy;
         }
        if (y > bounds.getMaxY()){
            System.out.println("Game Over");
            System.exit(0);
        }
        recalculateCriticals();
        ball.setFrame(x, y, 2*radius, 2*radius);
    }

    public boolean onPaddle(double x){
        return ((x > Paddle.getXPosition()) && (x < Paddle.getXPosition()+Paddle.getPaddleWidth()) && (y > Paddle.getYPosition()-10));
    }
    public boolean hittingEdge(double x){
        return ((x >= criticalBoundaryY1 && x < paddleHalfwayPoint)
                ||
                (x <= criticalBoundaryY1 && x > paddleHalfwayPoint)); //Return true if x is hitting the side edge of the paddle
    }
    public void changeColor(){
        Random randomColor = new Random();
        color = new Color(randomColor.nextInt(255), randomColor.nextInt(255), randomColor.nextInt(255));
    }

    public void draw(Graphics2D g2) {
        g2.setColor(color);
        g2.fill(ball);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:35:42.570

这样做的“Java 方式”是定义一个监听器接口，例如：

```
public interface BallListener {
  void paddleHit();
}
```

在 Ball 类中，您应该添加一个字段

`private List<BallListener> listeners;`

以及方法

```
public void addBallListener(BallListener l) { listeners.add(l); }
public void removeBallListener(BallListener l) { listeners.remove(l); }
```

当桨被击中时，你去：

```
for (BallListener l : listeners)
  l.paddleHit();
```

主类应该实现`BallListener`接口，并用球（`ball.addBallListener(this)`）注册自己。

这种方法还使您能够在需要时通知程序的其他部分发生在球上的不同事件（即，`BallListener`为您要发出信号的每个事件添加一个新方法）。

# ios - 具有点按对焦功能的 iOS 设备

> ID：14717401
> 
> 赞同：0
> 
> 时间：2013-02-05T21:36:48.193
> 
> 标签：ios, camera, hardware

我正在做一个需要点击以聚焦后置摄像头的项目。我想编译我的应用程序兼容的设备列表。网络上是否有一个列表显示所有支持点击对焦的 iOS 设备？到目前为止，这是我所知道的：

支持点击聚焦：

iPhone 5：是的

iPhone 4：是的

iPhone 3Gs：是的

iPod Touch 第 5 代：是

其他一切：否

我还缺少其他设备吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:41:40.340

> 我还缺少其他设备吗？

最近的 iPad 型号具有支持点击对焦的后置摄像头。4 月（或前后）推出的“新”iPad 拥有它，带有 Lightning 连接器的更新版本也是如此。我没有要检查的 iPad mini，但如果它没有相同的相机，我会感到惊讶。

**更新：根据**[规格](http://www.apple.com/ipad-mini/specs/)，iPad mini 确实支持点击对焦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T19:51:43.647

以下是具有自动对焦/点击对焦功能的设备的完整列表：

iPhone 3gs、4、4s、5 iPod touch 第 5 代 iPad 3 代及以后

# asp.net-mvc-4 - 在 MVC 4 中在哪里指定运行时 IOC

> ID：14717405
> 
> 赞同：1
> 
> 时间：2013-02-05T21:36:52.127
> 
> 标签：asp.net-mvc-4, inversion-of-control

我试图弄清楚如何使用 MVC4 中的 IOC 设置获取运行时参数设置。

我还没有选择 IOC 框架，很乐意接受建议。我宁愿避免 NInject，因为我听说它相当慢。

我需要在登录后指定我的 IOC。所以我想我需要创建一个 FilterAction 来处理这个问题。这是举办国际奥委会的最佳场所还是有更好的场所？

我已经看到很多在设计时执行规范的 IOC 示例，但我找不到任何通过 filterAction 或某种其他类型的登录后事件制作 IOC 容器的东西。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:42:15.863

理想情况下，您应该编写自定义`IDependencyResolver`您最喜欢的 DI 框架。ASP.NET MVC 将使用此解析器将依赖项注入到常见结构中，例如控制器。并且为了避免重新发明轮子，搜索已经有一个 MVC 扩展的 DI 框架来添加这个依赖解析器（可能 NuGet 包将带有后缀`.MVC`，例如`Unity.Mvc3`或`Ninject.Mvc3`，...）。然后在您的`Application_Start`.

# php - 基于多个复选框运行查询

> ID：14717406
> 
> 赞同：1
> 
> 时间：2013-02-05T21:36:53.877
> 
> 标签：php, mysql

我正在尝试基于多个复选框运行查询。这是表单上复选框的片段。

```
<td><strong>
        <input name="criteria[Buffet]" type="checkbox" id="Buffet" value="1"/>
        <label for="Buffet">Buffet</label>
        </strong></td>
      <td><strong>
        <input name="criteria[Breakfast]" type="checkbox" id="Breakfast" value="1"/>
        <label for="Breakfast">Breakfast</label>
        </strong></td>
      <td><strong>
        <input name="criteria[BYOB]" type="checkbox" id="BYOB" value="1" />
        <label for="BYOB">BYOB</label>
        </strong></td> 
```

这是结果页面上的 php 脚本....

```
<?php
require "congig.php";
if(isset($_POST['criteria']) && !empty($_POST['criteria'])){ 
    foreach($_POST['criteria'] as $key=>$value){ 
        if($value==1) $criteria[] = "'DetailName'='".mysql_escape_string($key)."'";
        } 
        $criteria = implode(' OR ', $criteria); 
        } 
        if(!$rs=mysql_query("SELECT tblLocations.CityID, tblRestaurants.RestName, tblLocations.Street,          
        tblLocations.Phone, tblLocations.Price, tblLocations.Rating, tblDetails.DetailName
        FROM (tblRestaurants INNER JOIN tblLocations ON tblRestaurants.RestID = tblLocations.RestID)            
        INNER JOIN (tblLocDet INNER JOIN tblDetails ON tblLocDet.DetailID = tblDetails.DetailID)
        ON tblLocations.LocationID = tblLocDet.LocID
        WHERE tblLocations.CityID='16'
        AND $criteria
        ORDER BY tblRestaurants.RestName ASC"))
        {
echo "Cannot parse query";
}
elseif(mysql_num_rows($rs) == 0) {
echo "No records found";
}
else {
echo "<table id=\"myTable\" table width=\"710\" class=\"beautifuldata\" align=\"Left\" cellspacing=\"0\">\n";
echo "<thead>\n<tr>";
echo "<th>PLACE</th>";
echo "<th>ADDRESS</th>";
echo "<th>PHONE</th>";
echo "<th>PRICE</th>";
echo "<th>RATING</th>";
echo "</tr>\n</thead>\n";
while($row = mysql_fetch_array($rs)) {
echo"<tr>
<td><strong><a href='$row[RestPage]'>$row[RestName]</a></strong></td>
<td>$row[Address]</td>
<td>$row[Phone]</td>
<td>$row[Price]</td>
<td>$row[Rating]</td>
</tr>\n";
}
echo "</table><br />\n";
}
?> 
```

关于为什么我没有得到任何结果的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:04:16.843

您的问题的核心似乎是您将列`DetailName`用单引号括起来：`"'DetailName'='"`当它应该是`"DetailName='"`

关于安全性，我想指出`mysql_escape_string()`您用来强制输入对 mysql 友好的功能是旧的并且充满了安全漏洞。相反，我建议使用更安全的实现：`mysql_real_escape_string()`. 下面的代码示例使用了更新、更安全的函数。

然而，与这些问题分开，我建议采用稍微不同的方法，从长远来看，这将更容易阅读并且更容易管理。

对于初学者，我建议在所有复选框上使用相同的名称，并使用 DetailName 作为值而不是键：

```
<td>
    <input name="criteria[]" type="checkbox" id="Buffet" value="Buffet" />
    <strong><label for="Buffet">Buffet</label></strong>
</td>
<td>
    <input name="criteria[]" type="checkbox" id="Breakfast" value="Breakfast" />
    <strong><label for="Breakfast">Breakfast</label></strong>
</td>
<td>
    <input name="criteria[]" type="checkbox" id="BYOB" value="BYOB" />
    <strong><label for="BYOB">BYOB</label></strong>
</td> 
```

接下来，使用您输入的值而不是键，我们现在可以生成我们的子句。非常有效：

```
// Runs mysql_real_escape_string() on every value encountered.
$clean_criteria = array_map('mysql_real_escape_string', $_REQUEST['criteria']);
// Convert the array into a string.
$criteria = implode("','", $clean_criteria); 
```

最后，在您的查询中，为了提高效率和可读性，我建议使用`IN`运算符而不是运算符：`OR`

```
SELECT
    tblLocations.CityID, tblRestaurants.RestName, tblLocations.Street, tblLocations.Phone, tblLocations.Price, tblLocations.Rating, tblDetails.DetailName
FROM
    (
        tblRestaurants
    INNER JOIN
        tblLocations ON tblRestaurants.RestID = tblLocations.RestID
    )            
INNER JOIN
    (
        tblLocDet
    INNER JOIN
        tblDetails ON tblLocDet.DetailID = tblDetails.DetailID
    ) ON tblLocations.LocationID = tblLocDet.LocID
WHERE tblLocations.CityID='16' AND tblDetails.DetailName IN ($criteria)
ORDER BY tblRestaurants.RestName ASC 
```

这是将我建议的修改与您的逻辑相结合的整个 PHP 方面：

```
<?php
require "congig.php";
if(!empty($_POST['criteria'])) { // empty() checks if the value is set before checking if it's empty.
    foreach($_POST['criteria'] as $key=>$value){ 
        // Runs mysql_real_escape_string() on every value encountered.
        $clean_criteria = array_map('mysql_real_escape_string', $_REQUEST['criteria']);
        // Convert the array into a string.
        $criteria = implode("','", $clean_criteria);
    }

    $rs = mysql_query("
        SELECT
            tblLocations.CityID, tblRestaurants.RestName, tblLocations.Street, tblLocations.Phone, tblLocations.Price, tblLocations.Rating, tblDetails.DetailName
        FROM
            (
                tblRestaurants
            INNER JOIN
                tblLocations ON tblRestaurants.RestID = tblLocations.RestID
            )            
        INNER JOIN
            (
                tblLocDet
            INNER JOIN
                tblDetails ON tblLocDet.DetailID = tblDetails.DetailID
            ) ON tblLocations.LocationID = tblLocDet.LocID
        WHERE tblLocations.CityID='16' AND tblDetails.DetailName IN ($criteria)
        ORDER BY tblRestaurants.RestName ASC
    ");
    if(!$rs) {
        echo "Cannot parse query";
    } else if(mysql_num_rows($rs) == 0) {
        echo "No records found";
    } else {
        echo "<table id=\"myTable\" table width=\"710\" class=\"beautifuldata\" align=\"Left\" cellspacing=\"0\">\n";
        echo "<thead>\n<tr>";
        echo "<th>PLACE</th>";
        echo "<th>ADDRESS</th>";
        echo "<th>PHONE</th>";
        echo "<th>PRICE</th>";
        echo "<th>RATING</th>";
        echo "</tr>\n</thead>\n";
        while($row = mysql_fetch_array($rs)) {
            echo"<tr>
            <td><strong><a href='$row[RestPage]'>$row[RestName]</a></strong></td>
            <td>$row[Address]</td>
            <td>$row[Phone]</td>
            <td>$row[Price]</td>
            <td>$row[Rating]</td>
            </tr>\n";
        }
        echo "</table><br />\n";
    }
} 
```

# android - Galaxy 选项卡无法连接到 ADB

> ID：14717408
> 
> 赞同：1
> 
> 时间：2013-02-05T21:37:01.277
> 
> 标签：android, ubuntu, adb, galaxy-tab

我在 Ubuntu 工作。我需要在这个操作系统上将三星 Galaxy Tab 连接到 ADB。我在本手册中做了所有事情：http: [//developer.android.com/tools/device.html](http://developer.android.com/tools/device.html)但 Galaxy 选项卡仍然没有连接到 ADB。当我执行“./adb devices”时，我得到一个名称如下的设备：“?????????”。可能是什么问题以及如何解决？

PS Ubuntu 和 ADB 工作正常。我可以将 HTC Wildfire 连接到 ADB，但三星 Galaxy Tab 仍然无法...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:07:13.587

不确定你是否这样做过：

以 root 身份打开以下文件：

```
/etc/udev/rules.d/51-android.rules 
```

然后，添加以下行：

```
SUBSYSTEM=="usb", ATTR{idVendor}=="04e8", MODE="0666", GROUP="plugdev" 
```

保存文件并退出。现在检查设备是否显示。

编辑：您可能需要重新启动您的电脑和设备。我不确定，但为了安全起见......

# mysql - 从 bat 文件中禁用 My SQL 外键约束 (FOREIGN_KEY_CHECKS)

> ID：14717410
> 
> 赞同：2
> 
> 时间：2013-02-05T21:37:07.283
> 
> 标签：mysql, batch-file

我需要从批处理文件中运行大约 100 个 .sql 文件，以便将数据加载到我们应用程序的查找表中。我需要在加载过程开始之前禁用约束，并在过程完成后再次启用它。

我目前的代码是

```
 for /r "%ScriptsPathLookup%" %%f in (*.sql) do ( 
mysql --host=%Server% --port=%PortNumber% --user=%UserName% --password=%UserPassword% --database=%DB% <%ConstrainPath%\Constrain-disable.sql<%%f)

Here Constrain-disable.sql -> SET FOREIGN_KEY_CHECKS = 0; 
```

但这不起作用。我相信如果我去输入'SET FOREIGN_KEY_CHECKS = 0;' 在所有 .sql 文件中，它将正确加载。这不是最好的方法，而且很难维护。任何人都可以提出更好的解决方案吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:25:34.143

您的示例代码有双重输入重定向`<`，这是行不通的。一种相对简单的方法，使用与您相同的循环机制，包括创建一个顶部带有*禁用代码的临时文件，然后将该文件与 MySQL 命令一起使用。*

```
set TempFile="%TEMP%\MyTempSql.sql"
for /r "%ScriptsPathLookup%" %%f in (*.sql) do (
  type %ConstrainPath%\Constrain-disable.sql >%TempFile%
  echo.>>%TempFile%
  type %%f >>%TempFile%
  mysql --host=%Server% --port=%PortNumber% --user=%UserName% --password=%UserPassword% --database=%DB% <%TempFile%
)
del %TempFile% 
```

# php - WordPress 联系表主题问题

> ID：14717413
> 
> 赞同：0
> 
> 时间：2013-02-05T21:37:16.177
> 
> 标签：php, wordpress, contact-form

我在上一个网站上遇到的问题之一是联系表 - 它使用静态主题方法.. 这很好 - 但问题是如果您使用 Gmail，那么它会将同一主题的电子邮件分组，而不是理想，特别是如果您期望这样会有很多流量。

在我使用的主题上有一个主题字段，但它似乎根本没有被使用。当我发送测试消息时，我收到：

电子邮件主题：.am - 来自联系表格的消息

网站：.am

姓名：亚历克斯

电子邮件：test@test.tld

主题：.am - 来自联系表的消息

消息：测试体。

因此，我在主题字段中输入的任何文本都被完全忽略，然后从电子邮件主题中提取静态文本并再次在正文中重复。

我已经在相应的页面中找到了代码（我认为？）。

## APOLLO13.PHP

```
if (empty($name))
$name_error = true;
if (empty($email) || !is_email($email))
$email_error = true;
if (empty($subject))
$subject_error = true;
if (empty($content))
$content_error = true;
if ($name_error == false && $email_error == false && $content_error == false &&     $subject_error == false) {
$subject = $site . __(' - message from contact form', TPL_SLUG);
$body = __('Site: ', TPL_SLUG) . $site . "\n\n"
. __('Name: ', TPL_SLUG) . $name . "\n\n"
. __('Email: ', TPL_SLUG) . $email . "\n\n"
. __('Subject: ', TPL_SLUG) . $subject . "\n\n"
. __('Message: ', TPL_SLUG) . $content;
$headers = "From: $name <$email>\r\n";
$headers .= "Reply-To: $email\r\n";
if (wp_mail($email_to, $subject, $body, $headers)) {
$title_msg = __('Success sending form', TPL_SLUG);
} else
$title_msg = __('Something wrong. Try again!', TPL_SLUG);
} else {
$title_msg = __('Error in form', TPL_SLUG);
if (!empty($name))
$name_tag = 'value="' . $name . '"';
if (!empty($email))
$email_tag = 'value="' . $email . '"';
if (!empty($subject))
$phone_tag = 'value="' . $subject . '" title="' . __('General question ...', TPL_SLUG) . '"';
if (!empty($content))
$content_tag = $content;
} 
```

我想要的是，本质上

电子邮件主题：$site | $subject-user-entered

姓名：

电子邮件：

信息：

我将如何修改代码来做到这一点？因为这：

```
$subject = $site . __(' - message from contact form', TPL_SLUG);
. __('Subject: ', TPL_SLUG) . $subject . "\n\n" 
```

似乎有点无意义。

## 编辑

如果有任何帮助，我已经找到了表单本身的代码：

```
<form action="http<?php echo $ssss ?>://<?php echo $_SERVER["SERVER_NAME"] . $_SERVER["REQUEST_URI"] ?>"
      method="post" id="contact-form-<?php echo $form_iter ?>" class="contact-form styled-form">
    <div class="submit_inputs">
        <div<?php echo ($name_error ? ' class="error"' : '') ?>>
            <input id="apollo13-contact-name" name="apollo13-contact-name" type="text" value=""/>
            <label for="apollo13-contact-name">
                <?php echo __('Name', TPL_SLUG) ?>
                <span> (<?php echo __('required', TPL_SLUG) ?>)</span>
            </label>
        </div>
        <div style="clear: both;"></div>
        <div<?php echo ($name_error ? ' class="error"' : '') ?>>
            <input id="apollo13-contact-email" name="apollo13-contact-email" type="text" value="" class="email"/>
            <label for="apollo13-contact-email">
                <?php echo __('Email', TPL_SLUG) ?>
                <span> (<?php echo __('required', TPL_SLUG) ?>)</span>
            </label>
        </div>
        <div style="clear: both;"></div>
        <div<?php echo ($name_error ? ' class="error"' : '') ?>>
            <input class="placeholder" id="apollo13-contact-subject" name="apollo13-contact-subject" type="text"
                   value=""/>
            <label for="apollo13-contact-subject">
                <?php echo __('Subject', TPL_SLUG) ?>
            </label>
        </div>
    </div>
    <div style="clear: both;"></div>
    <div<?php echo ($name_error ? ' class="error"' : '') ?>>
        <textarea id="apollo13-contact-content" name="apollo13-contact-content" rows="10" cols="40"></textarea>
    </div>
    <div>
        <input type="hidden" name="apollo13-contact-form" value="send"/>
        <input id="contact-submit" type="submit" value="<?php echo __('Submit form', TPL_SLUG) ?>"/>
    </div>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:53:19.090

我真的不能肯定地说，因为我不知道从哪里`$subject`得到它的原始价值，也不知道你的 html 表单是什么样的。

`$subject = $site . __(' - message from contact form', TPL_SLUG);`

可能会更改为

`$subject = $site . ' | ' . $subject;`

`$body`看起来像下面这样：

```
$body = __('Site: ', TPL_SLUG) . $site . "\n\n"
. __('Name: ', TPL_SLUG) . $name . "\n\n"
. __('Email: ', TPL_SLUG) . $email . "\n\n"
. __('Message: ', TPL_SLUG) . $content; 
```

# javascript - jqueryUI滑块分离手柄和填充栏

> ID：14717419
> 
> 赞同：0
> 
> 时间：2013-02-05T21:37:35.233
> 
> 标签：javascript, jquery-ui, jquery

是否有一种简单的方法可以为手柄下方的条和手柄本身设置单独的值。因此，在这个颜色选择器演示 [http://jqueryui.com/slider/#colorpicker](http://jqueryui.com/slider/#colorpicker) 中，第一个滑块的红色条与该滑块上的手柄的值不同吗？

这听起来可能违反直觉，但它会派上用场。我目前的情况是这样的：

我有一个控制电机的滑块。我希望用户使用手柄和红条请求一个位置，以显示电机在移动时的实际位置。所以用户请求一个位置，当电机向手柄移动时，红色条滞后。

ui-slider-range 可以做到这一点吗？希望这是有道理的，因为很难解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T14:53:45.990

现在从搜索结果中看到这个。有可能的。您需要复制和更改 j-query UI 脚本。滑块脚本末尾有一个部分用于设置范围（查找 var oRange = this.options.range）。它通常抓取句柄值，但您可以根据需要添加或减去。

# javascript - 在值上使用新日期

> ID：14717421
> 
> 赞同：4
> 
> 时间：2013-02-05T21:37:46.430
> 
> 标签：javascript

我正在尝试将 an 的值转换为`<input type="date" />`实际的 Javascript Date 对象。示例如下

```
new Date($('#myInput').val()); //where value of myInput is '2011-01-01' 
```

原来是

```
Fri Dec 31 2010 19:00:00 GMT-0500 (Eastern Standard Time) 
```

日期似乎从 UTC 转换为 EST（我认为）。有没有办法阻止这种转换？？？？

示例：[jsfiddle](http://jsfiddle.net/2t2m8/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:40:59.170

用于`Date.prototype.toUTCString`将特定于区域设置的日期转换为 UTC

```
(new Date($('#myInput').val())).toUTCString() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:41:27.970

试试这个：

```
ver date = new Date(document.getElementById('myinput').value);
date.setTime(date.getTime()+date.getTimezoneOffset()*60000); 
```

或者，使用`getUTC*()`函数。

# ruby-on-rails-3.2 - 更改列名

> ID：14717422
> 
> 赞同：0
> 
> 时间：2013-02-05T21:37:47.127
> 
> 标签：ruby-on-rails-3.2, rails-migrations

我只想将我表中的一列重命名`tenant_id`为`organization_id` 我看到这篇关于它的帖子[http://blog.techsoftsolutions.net/?p=340](http://blog.techsoftsolutions.net/?p=340) 但整个事情对于“重命名”来说似乎太多了，我想也许那是因为他的专栏是密码专栏，比较复杂。那么在最新的rails - 3.2中？- 这仍然是我们应该做的重命名列吗？我希望存在一个单行迁移命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:24:42.037

这比上一个链接工作的步骤更少：

[http://qatechnotes.blogspot.com/2011/07/renaming-database-column-using-rails.html](http://qatechnotes.blogspot.com/2011/07/renaming-database-column-using-rails.html)

# zend-studio - Zend Studio 9 弄乱了缩进

> ID：14717423
> 
> 赞同：0
> 
> 时间：2013-02-05T21:37:47.720
> 
> 标签：zend-studio

我正在将我的项目从 Zend Studio 5 移到 9。

Zend 9 毁了我的缩进。以前我的代码被格式化为有一个制表符是两个空格。现在 Zend 使用了四个空格，并且一些行比以前缩进了更多。

```
Before:
  $a=1;
  $b=1;
  $c=1;
  for ($i=0; $i<10; $i++)
  {
    echo "test";
  }

Now
  $a=1;
    $b=1;
    $c=1;
    for ($i=0; $i<10; $i++)
    {
        echo "test";
    } 
```

我尝试将选项卡策略设置为“空格”并将缩进大小设置为“2”。但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T01:44:19.110

我通过将 Displayed tab width 设置为“2”来修复它。

这是在页面上：常规 > 编辑器 > 文本编辑器

# html - 使用 Html 服务引用项目文件

> ID：14717426
> 
> 赞同：1
> 
> 时间：2013-02-05T21:38:09.437
> 
> 标签：html, google-apps-script, project, image

**我的问题：**我可以将文件上传到我的 Google Apps 脚本项目并在 html 文件中引用这些文件吗？

例如，假设我有一个如下所示的项目：

* * *

我的代码.gs

```
function doGet() {
  return HtmlService.createHtmlOutputFromFile('myPage');
} 
```

我的页面.html

```
<html>
  <body>
    Hello World! Look at my picture of a cat! <img src="cat.jpg" />
  </body>
</html> 
```

cat.jpg（我的项目中的一只猫的图像）

* * *

如何确保`<img src="cat.jpg" />`引用`cat.jpg`我在项目中的引用？我什至可以将图片上传到项目中吗？我知道我可以引用另一台服务器上的图像，但我希望包含这个项目。那可能吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T04:56:51.857

在 GDrive 中创建一个公用文件夹并获取该文件夹的 ID，并使用该文件夹 ID 构建一个如下所示的 URL。这将是该文件夹的路径

```
var url = 'https://googledrive.com/host/'+'MY_PUBLIC_FOLDER_ID' 
```

例如`https://googledrive.com/host/0B2MdbzABFW_ubl9pY2FqS0FMMDQ`

构建 URL 后，您可以使用绝对路径引用该 URL 中的所有数据

例如`pathToAnImage = url+'myImage.jpg'`

您可以查看此帖子以获取更多详细信息。

*   [http://googleappsdeveloper.blogspot.in/2012/11/announcing-google-drive-site-publishing.html](http://googleappsdeveloper.blogspot.in/2012/11/announcing-google-drive-site-publishing.html)

# ios - MVC 设计模式。View如何适应它？

> ID：14717427
> 
> 赞同：8
> 
> 时间：2013-02-05T21:38:12.447
> 
> 标签：ios, objective-c, model-view-controller, design-patterns, uiviewcontroller

我对模型-视图-控制器设计模式有疑问。我了解模型保存数据。我也了解控制器（View Controllers）实现应用程序的逻辑。例如，如果 UIPicker 轮选择第 4 行，则视图控制器可以向模型询问存储在模型数组中的第 4 个对象。我无法理解“视图”是否适合。我认为该笔尖/情节提要文件将被归类为“视图”。但是，每个视图都需要连接视图控制器以将所有出口连接到视图。我应该如何保持 View 和 View Controller 分开？我是否应该将所有插座连接到“视图类”，然后在我的视图控制器中引用我的“视图” 实现这些网点的逻辑时的类？也许我只需要一个 View 和 View Controller 处理不同任务的示例。因为否则额外的“视图”类似乎没有意义。MVC的View是指一个View Class吗？我如何或为什么要让这个 View Class 与我的 View Controller 类分开？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-05T23:27:14.393

视图的工作是显示数据和报告事件。

控制器的工作是协调视图和模型之间的通信。

数据的工作是存储数据并围绕该数据提供业务逻辑。

您询问：

> 我无法理解“视图”是否适合。

在您的示例中，`UIPickerView`是视图。

在 iOS/OSX 中，视图控制器只是 MVC 的控制器。碰巧视图控制器还包含一个空视图容器，您可以将所有其他视图添加到该容器中。但是在 iOS/OSX 中，MVC 还是有明显的分离。

`UIButton`像, `UIPickerView`,等所有类都`UITableView`代表视图。视图控制器的工作是为这些视图提供来自数据模型的数据以及响应来自这些视图的事件，让您有机会更新其他视图和数据模型。

你还说：

> 但是，每个视图都需要连接视图控制器以将所有出口连接到视图。我应该如何保持 View 和 View Controller 分开？

他们是分开的。如果添加一个`UITableView`，那是一个单独的视图。您将它连接到一个类，以便该类可以实现数据源和委托方法。该类是控制器类。这个控制器类通常是一个视图控制器，但它不是必须的。您可以编写独立于任何特定视图控制器（或通用控制器）的各种自定义视图类。但最终该视图类需要连接到 [视图] 控制器类，以便可以正确处理数据和事件。

您询问：

> 我如何或为什么要让这个 View Class 与我的 View Controller 类分开？

看`UITableViewController`。这是一个明显的分离示例，但它是在一个相当整洁的包中提供的。您实际上有一个单独的`UITableView`类，即视图。该视图负责呈现视图并收集用户交互。它是实际的表视图控制器，它向视图提供数据并处理来自视图的用户事件。

您可以将`UITableView`视图添加到任何视图。这是一个完全可重用的视图组件。连接到表视图的每个控制器都可以提供任何适当的数据并正确处理用户交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:58:35.870

好的，我会尝试整理一下。

该模式称为模型-视图-控制器，从而将模型、视图和控制器明确分离。正如您正确指出的那样， ViewController 将事物放在一起（来自 View 和 Controller :)，实际上 ViewController 打破了强大的 MVC 模式。好消息是：如果您使用 ViewController，则不必将视图和控制器分开（猜猜它为什么这样命名？）。

现在我解释了为什么设计是这样的：

当您将视图和控制器强烈分离时，您基本上可以获得良好设计的学分。然而，事实证明，他们两个并不像我们希望的那样分开。不同的 GUI 表示通常确实需要不同的视图实现以及控制将模型转发到 GUI 的控制器的适配，例如控制台上的纯文本显示与位图上的绘图。在第一种情况下，您的控制器会将一个字符串传递给要渲染的视图，在第二种情况下，它还需要设置一些坐标才能将文本渲染到正确的位置。因此，您的控制器将经常更改。

理想的情况是实现模型和控制器，并简单地为任何人在现实生活中看到的任何东西提供视图。然而，在现实生活中，控制器很可能会适应视图，同时不理会模型。因此，将视图和控制器组合到包含特定视图并知道如何使用它的 ViewController 的设计决策只是一种合理的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T22:18:28.820

其实你的理解是完全错误的。

MVC 设计模式背后的核心原则是[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)。您将模型层与表示层分开，并且（在表示层中）将视图与控制器分开。

每个pars都有不同的责任：

*   模型层包含所有的业务逻辑。这包括与存储、域逻辑和应用程序逻辑的交互。
*   view 负责 UI 逻辑。在 Web 的上下文中，这意味着该视图处理为用户创建响应
*   控制器是接受用户输入的部分，并在此基础上改变模型层和当前视图的状态。

* * *

人们倾向于长期存在对 MVC的很多**误解。**例如：

1.  有些人会坚持认为视图是愚蠢的模板。他们不是。

    MVC 设计模式中的视图是功能齐全的实例，处理可能使用也可能不使用多个模板来生成响应。

2.  没有“模型”。模型是一个层，由多个不同的类组组成，每个类都有特定的任务。与表示层没有“表示”对象的方式相同

3.  控制器不会将数据从模型层发送到视图。控制器只改变三元组其他部分的状态。视图实例本身从模型层请求他们需要的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T22:09:47.557

为了回答您的问题，让我们分解 MVC - 模型、视图、控制器。什么去哪里？

**模型**通常被认为是“做某事”层。这包含业务逻辑和数据逻辑。您的模型应该是 FAT，而不是 SKINNY，这意味着您的模型中应该有很多代码。

**Controller** ，我认为是“响应”层。这是您决定向用户返回什么的地方，无论是视图还是其他类型的响应，例如 JSON（在 RESTful 响应中特别有用）。您也可以使用模型，但您不应该在控制器本身中构建太多逻辑。你应该有一个 SKINNY 控制器。

**视图**主要是页面的标记——HTML 以及其他用于访问模型的标记——这取决于您使用的框架。我的经验是使用 MVC .NET，所以我会使用它。与 HTML 混合后，您将访问模型元素。视图中不应该有任何真正的逻辑，但您可以执行以下操作（使用 Razor 语法）

```
<div>@foreach person in Model.Users{
    <p>@person.FullName</p>
}
</div> 
```

因此，您可以看到 View 可以有一些“显示逻辑”（例如，遍历人员并获取 FullName），但这就是您真正应该拥有的一切。

这是一个快速幻灯片，解释了有关 MVC 的更多信息，包括为什么您对“模型保存数据，控制器保存逻辑”的初始解释实际上不正确：[http ://www.slideshare.net/damiansromek/thin-controllers-fat -models-proper-code-structure-for-mvc](http://www.slideshare.net/damiansromek/thin-controllers-fat-models-proper-code-structure-for-mvc)

MVC 设计模式不包括任何来自其他地方的称为“ViewController”的东西。

# scala - 修改 Scala AST 中的节点

> ID：14717428
> 
> 赞同：3
> 
> 时间：2013-02-05T21:38:16.230
> 
> 标签：scala, reflection, scala-2.10

我知道可以获取与 Scala 表达式对应的 Tree，也可以遍历生成的树。假设一个给定的树节点匹配某个标准，我需要什么方法调用才能修改它？即用其他树替换它？

```
object traverser extends Traverser {
    var applies = List[Apply]()

    override def traverse(tree: Tree): Unit = tree match {
        case someCriterion => modifyNodeSomehow // How to do this?
        // Otherwise...
        case app @ Apply(fun, args) =>
            applies = app :: applies
            super.traverse(fun)
            super.traverseTrees(args)
        case _ => super.traverse(tree)
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:21:00.393

在[另一个问题](https://stackoverflow.com/questions/14466124/how-to-replace-a-subtree-with-some-other-tree)中，有人建议我使用[Transformer](https://github.com/scalamacros/kepler/blob/18a906bb9a6c6b50d286ca76f219a5b351514ae4/src/reflect/scala/reflect/api/Trees.scala#L2897)做类似的事情。但是，AFAIK 无法就地修改树。

# tsql - 删除与分组依据

> ID：14717429
> 
> 赞同：2
> 
> 时间：2013-02-05T21:38:30.087
> 
> 标签：tsql, sql-server-2005

表如下

```
CREATE TABLE [dbo].[Poll](
    [PollID] [bigint] IDENTITY(1,1) NOT NULL,
    [LoginID] [bigint] NOT NULL,
    [FacilityID] [bigint] NOT NULL,
    [PolledAt] [datetime] NOT NULL,
) 
```

我必须每晚清空这张表......但根据`PolledAt`字段分组的`LoginID`字段保留最大行。这意味着用户（LoginID）有多行，到晚上结束时，用户在删除后应该只有一行。该行应该是`MAX(PolledAt)`值。

我可以得到我不想删除的记录：

```
SELECT
    LoginID,
    MAX(PolledAt) AS MaxPolledAt
FROM
    Poll
GROUP BY
    LoginID 
```

但后来我不知道如何形成我的删除，因为我没有显示作为 pollid 的主键。我需要获取上述选择的结果并删除除该选择返回的所有内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T21:42:23.883

您可以使用[公用表表达式](http://msdn.microsoft.com/en-us/library/ms175972%28v=sql.90%29.aspx)和[row_number()](http://msdn.microsoft.com/en-us/library/ms186734%28v=sql.90%29.aspx)函数来确定需要删除哪些行。

[SQL小提琴](http://sqlfiddle.com/#!3/465c9/1)

**MS SQL Server 2008 架构设置**：

```
CREATE TABLE [dbo].[Poll](
    [PollID] [bigint] IDENTITY(1,1) NOT NULL,
    [LoginID] [bigint] NOT NULL,
    [FacilityID] [bigint] NOT NULL,
    [PolledAt] [datetime] NOT NULL,
);

insert into Poll values(1, 1, getdate());
insert into Poll values(1, 1, getdate()+1);
insert into Poll values(1, 1, getdate()+2);
insert into Poll values(1, 1, getdate()+3);
insert into Poll values(2, 2, getdate()+4); 
```

**查询 1**：

```
with C as
(
  select row_number() over(partition by LoginID order by PolledAt desc) as rn
  from Poll
)
delete from C
where rn > 1; 
```

**[结果](http://sqlfiddle.com/#!3/465c9/1/0)**：

**查询 2**：

```
select *
from Poll; 
```

**[结果](http://sqlfiddle.com/#!3/465c9/1/1)**：

```
| POLLID | LOGINID | FACILITYID |                        POLLEDAT |
-------------------------------------------------------------------
|      4 |       1 |          1 | February, 08 2013 21:48:34+0000 |
|      5 |       2 |          2 | February, 09 2013 21:48:34+0000 | 
```

# ruby - 无法获得标签文本元素

> ID：14717431
> 
> 赞同：2
> 
> 时间：2013-02-05T21:38:39.437
> 
> 标签：ruby, selenium-webdriver

我确实有以下内容`HTML`：

```
<div id="filtersetedit_fieldNames" title="Please first select a list to filter!">
  <input value="5418630" name="NameID" type="checkbox"> John Das
  <input value="6360899" name="NameID" type="checkbox"> Ram Roy 
  <input value="9556609" name="NameID" type="checkbox"> Smith
  <input value="20156687" name="NameID" type="checkbox"> Paul
</div> 
```

现在我必须使用 selenium-webdriver 单击相应的复选框。但我试图将值提取为`John Das,Ram roy etc`. 这是因为只是为了让索引号点击复选框。但我的代码根本不起作用。

***`CODE`***

```
driver.find_elements(:id,"filtersetedit_fieldNames").each do |x|
  puts x.text
  #puts index
  break if x.text == "LocationAttributes:Currency Type"
  index = index + 1
end

driver.find_elements(:name, "candidateFieldIds")[index].click 
```

但是这些值被打印为一个字符串`"John Das Ram Roy Smith Paul"`，我很困惑如何找到正确的索引，以便我可以在我的`check box`命中代码中使用它。

我实际上正在寻找创建一个数组类型的东西说它应该像`["John Das","Ram Roy","Smith","Paul"]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:04:21.910

假设您的真正目标是根据文本设置复选框（即您实际上并不需要名称数组），您可以使用 xpath 选择器查找紧跟所需文本的复选框元素：

```
#The text of the checkbox you want to select
text_of_target_checkbox = 'Ram Roy'

#The div containing the checkboxes
checkbox_div = driver.find_element(:id => 'filtersetedit_fieldNames')

#Get the checkbox that has the specified text immediately after it
e = checkbox_div.find_element(:xpath => "./input            
    [following-sibling::text()
        [
            position() = 1 and 
            normalize-space(.)='#{text_of_target_checkbox}'
        ]
    ]")

#Click the checkbox
e.click 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T03:18:24.770

也许：

```
driver.find_elements(
  :xpath,
  "//div[contains(@id,'filtersetedit_fieldNames')]/input"
) do |x| 
```

应该：

```
driver.find_elements(
  :xpath,
  "//div[contains(@id,'filtersetedit_fieldNames')]/input"
).each do |x| 
```

# html - 使 div 的一部分透明

> ID：14717432
> 
> 赞同：33
> 
> 时间：2013-02-05T21:38:41.527
> 
> 标签：html, css

![示例图像](../Images/5237efebb2400e6e0ee4d919a9fca371.png)

我正在尝试在 HTML 中做这样的事情。它是一个页眉，位于页面的最顶部。棋盘区域必须是透明的。

如果不使用 15 个 div，我想不出一个好方法。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-05T21:45:30.730

# 未来的选择

理想的情况是使用没有图像的单个元素。

尽管浏览器支持有限，但在这种情况下，屏蔽和/或剪辑会很有帮助。自从我第一次写这个答案以来，规范（如下）似乎确实取得了进展，所以这令人鼓舞。

*   [http://www.w3.org/TR/css-masking/](http://www.w3.org/TR/css-masking/)
*   [http://www.html5rocks.com/en/tutorials/masking/adobe/](http://www.html5rocks.com/en/tutorials/masking/adobe/)

# 实用方法

现在，我会选择基于图像的解决方案。它不需要很复杂。

我建议避免使用光栅图形，因为高密度显示器变得越来越普遍（几乎所有平板电脑/智能手机和 4K PC 显示器）。为了实现这一点，SVG 将在大多数现代浏览器中工作，而 PNG 可以用作后备。

# 演示

*   这是一个使用 PNG 的演示：http: [//jsfiddle.net/MxspA/6/](http://jsfiddle.net/MxspA/6/)。
*   具有 IE7 支持的相同演示：http: [//jsfiddle.net/MxspA/9/](http://jsfiddle.net/MxspA/9/)（替换`:before`并`:after`使用额外元素）。

**IE8+版本的源码**

```
<div id="box">
    <div id="knockout"></div>
</div>

#box{ 
    position: relative; 
}

#knockout {
    background-image: url(http://i.stack.imgur.com/AXHM0.png);
    width: 105px;
    height: 180px;
    margin: 0 auto;    
}

#knockout:before{
    content: " ";
    position: absolute;
    left: -52px;
    width: 50%;
    height: 100px;
    background-color: #000;
}

#knockout:after{
    content: " ";
    position: absolute;
    right: -52px;
    width: 50%;
    height: 100px;
    background-color: #000;
} 
```

**图片**

这是一个透明的PNG，可以帮助您入门。具有基本 Adob​​e Illustrator 技能的人可以将其重新创建为 SVG 图像，提供上述高分辨率功能。SVG 可以很好地用作背景图像。

![在此处输入图像描述](../Images/a55161ac5c39cffb224ee2dc5a88dae7.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-05T21:46:24.987

可以使用 CSS-alpha 掩码：[https ://caniuse.com/#feat=css-masks](https://caniuse.com/#feat=css-masks)

**更新 1**

*   在上面创建一个`DIV`层
*   插入`CANVAS`- 元素。将黑色部分涂成黑色，其余部分应该是透明的。

**更新 2**

我很确定，如果不在旧版浏览器中使用带有 alpha 层的 PNG 图像，就无法创建此布局。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-05T22:18:16.637

编辑：在@yentups 再次发布小提琴的帮助下扩展了我的演示。

我玩了一点辐射渐变并想出了以下内容。你必须玩一点并习惯径向渐变的语法。现在对我来说已经晚了，我现在不会纠结这个了。祝你好运！

**演示：http:** [//jsfiddle.net/5VDLX/](http://jsfiddle.net/5VDLX/)

**HTML：**

```
<div class="container">
    <div class="shape"></div>
    <div class="circle"></div>
</div> 
```

**CSS：**

```
body{
    background: yellow;
}
.shape {
    width: 500px;
    height: 75px;
    background-color: transparent;
    background-image: -webkit-radial-gradient(50% 100%, circle, transparent 50px, black 0);
    background-image: radial-gradient(50% 100%, circle, transparent 50px, black 0);
}
.circle {
    width: 100px;
    height: 100px;
    background-color: transparent;
    border: 2px solid red; /* red for demonstration */
    border-radius: 50px;
    margin: -51px 0 0 199px; /* considering borders */
} 
```

*   浏览器支持 CSS3 渐变 [http://caniuse.com/#feat=css-gradients](http://caniuse.com/#feat=css-gradients)
*   浏览器支持 CSS3 背景图像选项[http://caniuse.com/#feat=background-img-opts](http://caniuse.com/#feat=background-img-opts)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-05T22:30:43.470

使用`kleinfreund`的代码：
这个[**DEMO**](http://jsfiddle.net/yentup/fyXby/)

完整的工作页面示例：[这里](http://jsfiddle.net/yentup/fyXby/3/show)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-01-31T07:26:10.207

```
**Demo Working Link** - https://codepen.io/iamabhishek/pen/ddoomE

**HTML**
<div class="main">
  <div></div>
</div>

**css**
div.main{
    width:50%;
    height:550px;
    background: url('https://images.unsplash.com/photo-1503135935062-b7d1f5a0690f?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=cf4d0c234ecaecd14f51a2343cc89b6c&dpr=1&auto=format&fit=crop&w=376&h=564&q=60&cs=tinysrgb') no-repeat;
    background-position:center;
    background-size:cover
}
div.main>div{
    width:100px;
    height:320px;
    background:transparent;
    background-attachment:fixed;
    border-top:25px solid orange;
    border-left:120px solid orange;
    border-bottom:25px solid orange;
    border-right:10px solid orange;
    margin-left:150px

} 
```

# php - 使用 facebook api 获取 facebook 提要

> ID：14717433
> 
> 赞同：0
> 
> 时间：2013-02-05T21:38:51.703
> 
> 标签：php, facebook

我想在我的网站上使用 facebook 页面提要，但我需要一个访问权限

```
public function newsFacebookAction() {
    require './application/libraries/facebook-php-sdk/src/facebook.php';

    $facebook = new Facebook( array('appId' => FACEBOOK_KEY, 'secret' => FACEBOOK_SECRET, ));

    // Get User ID
    $user = $facebook -> getUser();

    $args['var']['user'] = $user;

    if ($user) {
        $args['var']['url'] = $facebook -> getLogoutUrl();
        // Get the current access token
        $access_token = $facebook -> getAccessToken();
        //get feed
        $helper = new Helper();
        $args['var']['feed'] = $helper->get_web_page("https://graph.facebook.com/OfficielAssas.net/feed?access_token=".$access_token);
    } else {
        $args['var']['url'] = $facebook -> getLoginUrl();
    }
} 
```

get_web_page 就是这个函数

[http://nadeausoftware.com/articles/2007/06/php_tip_how_get_web_page_using_curl](http://nadeausoftware.com/articles/2007/06/php_tip_how_get_web_page_using_curl)

我有错误：

SSL证书问题，验证CA证书是否OK。详细信息：错误：14090086：SSL 例程：SSL3_GET_SERVER_CERTIFICATE：证书验证失败

bur，如果我直接去地址，这很好用

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:00:02.967

你把事情复杂化了。你已经有了 Facebook API。为什么不使用它？

```
public function newsFacebookAction() {
require './application/libraries/facebook-php-sdk/src/facebook.php';

$facebook = new Facebook( array('appId' => FACEBOOK_KEY, 'secret' => FACEBOOK_SECRET, ));
$result = $facebook->api('/OfficielAssas.net/feed', 'GET');
print_r($result); 
```

您可以在不验证用户身份的情况下查询页面的值（只要没有年龄或国家/地区限制）。

# c# - 我必须做什么才能使 EWL 快捷方式 URL 正常工作？

> ID：14717437
> 
> 赞同：1
> 
> 时间：2013-02-05T21:38:57.557
> 
> 标签：c#, asp.net, friendly-url, enterprise-web-library

我有这个代码：

```
protected override IEnumerable<ShortcutUrlResolver> GetShortcutUrlResolvers() {
    return new[]
        {
            new ShortcutUrlResolver( "someShortcut", ConnectionSecurity.SecureIfPossible, () => SmartRedirector.GetInfo( Pages.One.Two.GetInfo().GetUrl() ) ),
            new ShortcutUrlResolver( "", ConnectionSecurity.SecureIfPossible, () => Pages.Portals.GetInfo() )
        };
} 
```

如果我去`mysite/`，我最终会在 Portals 页面*（上面的第二个快捷方式）*。如果我去 mysite/someShortcut，我会得到一个错误：

```
this page is no longer available . 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T15:26:27.840

问题是我没有尝试导航到“mysite/someShortcut”，而是尝试导航到“mysite/someShortcut/”，并带有斜杠。斜线很重要。因此，从我的 URL 中删除斜杠使其工作。此外，我可以同时包含“someShortcut/”和“someShortcut”作为快捷方式 URL，然后其中任何一个都可以使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:16:25.477

您似乎正确定义了快捷方式 URL，我不相信您在访问快捷方式 URL 时会收到“您请求的页面不再可用”错误，因此看起来问题来自您的重定向遵循快捷方式 URL 后自行重新执行。

# windows-phone-7 - windows phone 7 bing 映射点之间的距离

> ID：14717439
> 
> 赞同：0
> 
> 时间：2013-02-05T21:38:58.323
> 
> 标签：windows-phone-7, distance, bing-maps, pushpin

不确定这是否已得到解答，但似乎无法在任何地方找到答案。

我目前有一个适用于 Windows Phone 7.1 的应用程序，其中必应地图作为我的页面的一部分。我可以通过单击按钮将 puspins 添加到我所在位置的地图。我的问题是，是否有可能获得两个图钉之间的距离？

我不想进入 bing 地图应用程序本身并计算路线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T14:08:15.813

我在我的应用程序中执行此操作的方式是为每个 PushPin 创建一个 GeoCoordinate，并使用一个 GeoCoordinate 的 GetDistanceTo 方法来确定它与另一个 GeoCoordinate（从另一个 PushPin 创建）的距离。像这样，确定从图钉 1 到图钉 2 的距离：

```
GeoCoordinate geo1 = new GeoCoordinate(pushpin1.Location.Latitude, pushpin.Location.Longitude);
GeoCoordinate geo2 = new GeoCoordinate(pushpin2.Location.Latitude, pushpin.Location.Longitude);
double distance = geo1.GetDistanceTo(geo2); 
```

# xml - 在 sql server 2008 R2 中使用 xquery 更新属性

> ID：14717445
> 
> 赞同：3
> 
> 时间：2013-02-05T21:39:29.037
> 
> 标签：xml, sql-server-2008, tsql, xquery-sql

我有一个表格，它定义了 XML 表单的布局。它`<Control ...>`内部的节点具有 Id (GUID) 和 DataType (char) 等属性...

此 XML 数据用于在运行时创建表单，当保存数据时，将其写入 XML 中称为元素`<Field ...>`的具有以下属性的元素：名称（与控制节点 ID 中的 GUID 匹配）和数据（保存之前的值）输入控制）。

我们有一个问题，当您 .ToString 一个 Date 对象时，它使用机器的日期格式设置。所以日期可以以任何可能的格式保存。我已更新代码以始终以`YYYY/MM/DD`格式保存日期，但现在我需要将数据库中的现有数据更新为`YYYY/MM/DD`. 由于我们无法知道日期的保存格式，因此我们假设它保存为`MM/DD/YYYY`.

所以现在我的问题是尝试更新 SQL Server 中的 XML。使用 xquery 和 CROSS APPLY .nodes( ) 东西，我可以编写一个查询来查找所有格式不正确的日期，但我不知道如何更新它们。

此 SQL 脚本将创建表变量并用一些测试数据填充它们，并具有将返回错误日期值的查询。注释掉的最后一部分是我如何尝试将它们更新为新`YYYY/MM/DD`格式，但是如果您取消注释，您会发现它不起作用。

有人有想法么？

PS 这只能在 SQL 脚本中完成。我知道在 .NET 中编写一个读取所有 xml 数据并更新属性然后将数据保存回数据库的函数非常容易，但在这种情况下这是不可能的，因为：原因。

```
DECLARE @Form AS Table
(
  FormID INT,
  FormDataXML XML
);

DECLARE @ScreenData AS Table
(
  ScreenDataID INT,
  FormID INT,
  ScreenDataXML XML 
);

DECLARE @ControlsToUpdate AS TABLE
(
  FormID INT,
  ControlID char(36),
  DataType CHAR(1)
);

INSERT INTO @Form
VALUES (1, '<Form><Control Id="00000000-0000-0000-0000-000000000000" DataType="D" /><Control Id="00000000-0000-0000-0000-000000000001" DataType="N" /></Form>');
INSERT INTO @Form
VALUES (2, '<Form><Control Id="00000000-0000-0000-0000-000000000002" DataType="D" /><Control Id="00000000-0000-0000-0000-000000000003" DataType="D" /></Form>');

INSERT INTO @ScreenData
VALUES (1, 1, '<ScreenData><Field Name="00000000-0000-0000-0000-000000000000" Data="01/31/2012" /><Field Name="00000000-0000-0000-0000-000000000001" Data="1234.56" /></ScreenData>');
INSERT INTO @ScreenData
VALUES (2, 1, '<ScreenData><Field Name="00000000-0000-0000-0000-000000000000" Data="02/28/2013" /><Field Name="00000000-0000-0000-0000-000000000001" Data="0" /></ScreenData>');
INSERT INTO @ScreenData
VALUES (3, 2, '<ScreenData><Field Name="00000000-0000-0000-0000-000000000002" Data="03/31/2013" /><Field Name="00000000-0000-0000-0000-000000000003" Data="04/30/2013" /></ScreenData>');
INSERT INTO @ScreenData
VALUES (4, 2, '<ScreenData><Field Name="00000000-0000-0000-0000-000000000002" Data="2013/05/31" /><Field Name="00000000-0000-0000-0000-000000000003" Data="2013/06/30" /></ScreenData>');
--Data treated as scheduled items
INSERT INTO @ScreenData
VALUES (5, 2, '<ScreenData><Item><Field Name="00000000-0000-0000-0000-000000000002" Data="01/01/2012" /><Field Name="00000000-0000-0000-0000-000000000003" Data="02/02/2012" /></Item><Item><Field Name="00000000-0000-0000-0000-000000000002" Data="03/03/2012" /><Field Name="00000000-0000-0000-0000-000000000003" Data="04/04/2012" /></Item></ScreenData>')

INSERT INTO @ControlsToUpdate
SELECT FormID,  
data.control.value('@Id', 'char(36)'),
data.control.value('@DataType', 'char(1)')
FROM @Form
CROSS APPLY FormDataXML.nodes('//Control') data(control)
WHERE data.control.value('@DataType', 'char(1)') = 'D';

--This will display the ScreenDataID, FormID, ControlID, and current Date value for dates that are in the old mm/dd/yyyy format
SELECT d.ScreenDataID, d.FormID, c.ControlID,
data.field.value('@Data', 'char(10)') as Date
FROM @ScreenData d
CROSS APPLY d.ScreenDataXML.nodes('//Field') as data(field)
INNER JOIN @ControlsToUpdate c ON c.ControlID = data.field.value('@Name', 'CHAR(36)') 
                              AND d.FormID = c.FormID
WHERE data.field.value('@Data', 'char(10)') 
LIKE '[01][0123456789]/[0123][0123456789]/[12][0123456789][0123456789][0123456789]';

--UPDATE d
--SET data.field.modify('replace value of (/@Data) with "' + 
--    SUBSTRING(data.field.value('@Data', 'char(10)'), 7, 4) + '/' + 
--    SUBSTRING(data.field.value('@Data', 'char(10)'), 1, 2) + '/' + 
--    SUBSTRING(data.field.value('@Data', 'char(10)'), 4, 2) + '"')
--FROM @ScreenData d
--CROSS APPLY d.ScreenDataXML.nodes('//Field') as data(field)
--INNER JOIN @ControlsToUpdate c ON c.Id = data.field.value('@Name', 'CHAR(36)') 
--                              AND d.FormID = c.FormID
--WHERE data.field.value('@Data', 'varchar(MAX)') 
--LIKE '[01][0123456789]/[0123][0123456789]/[12][0123456789][0123456789][0123456789]';

GO 
```

--Edit-- @ScreenData 中的 xml 也可以包含`<Item>`包含节点的`<Field>`节点。发生这种情况时，您将拥有多个`<Field>`具有相同 Name 属性值的节点。当屏幕具有项目列表视图时就是这种情况，您将拥有多个项目，每个项目都引用相同的控件但有自己的值。ScreenDataID 5 显示了这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:24:42.390

我不会告诉你你想要什么。我将向您展示如何将**所有**日期更改为，`yyyy-mm-dd`因为那是它们应该在 XML 中的样子。

到目前为止，您已经很好地解决了问题，所以如果您决定使用另一种日期格式，我认为根据您的需要更改下面的代码不会有任何问题。

您一次不能在 XML 中更新多个值，因此必须在需要更新的表单和字段的循环中完成更新。

`SET DATEFORMAT ymd;`对于从字符串到日期的转换要同时在两者上工作是必要`yyyy/mm/dd`的`mm/yy/dd`。

```
SET DATEFORMAT ymd;

DECLARE @FormID INT;
DECLARE @FieldID UNIQUEIDENTIFIER;
DECLARE @I INT;

DECLARE ControlsToUpdate CURSOR FORWARD_ONLY READ_ONLY FOR
SELECT F.FormID,
       T.N.value('@Id', 'uniqueidentifier') AS FieldID
FROM @Form AS F
CROSS APPLY F.FormDataXML.nodes('/Form/Control') AS T(N)
WHERE T.N.value('@DataType', 'char(1)') = 'D';

OPEN ControlsToUpdate;

FETCH NEXT FROM ControlsToUpdate 
INTO @FormID, @FieldID;

WHILE @@FETCH_STATUS = 0
BEGIN

  SELECT @I = MAX(S.ScreenDataXML.value('count(//Field[@Name = sql:variable("@FieldID")])', 'INT'))
  FROM @ScreenData AS S
  WHERE S.FormID = @FormID;

  WHILE @I > 0
  BEGIN
    UPDATE S
    SET ScreenDataXML.modify('replace value of 
                              ((//Field[@Name = sql:variable("@FieldID")]
                                 /@Data)[sql:variable("@I")])[1] 
                              with sql:column("T.D")')
    FROM @ScreenData AS S
    CROSS APPLY 
      (SELECT S.ScreenDataXML.value('((//Field[@Name = sql:variable("@FieldID")]
                                        /@Data)[sql:variable("@I")])[1]', 'DATE')) AS T(D)
    WHERE S.FormID = @FormID;

    SET @I -= 1;
  END

  FETCH NEXT FROM ControlsToUpdate
  INTO @FormID, @FieldID;
END

CLOSE ControlsToUpdate; 
```

# bing-maps - 检查位置是否在 Bing 地图上

> ID：14717450
> 
> 赞同：0
> 
> 时间：2013-02-05T21:39:37.037
> 
> 标签：bing-maps

我们想检查一个位置是否在可见的 Bing 地图上，但我们目前的努力告诉我们所有位置都在地图上。

初始化地图后，我们使用 Map 'getBounds' 方法返回当前地图的 LocationRect：

> var mapRect = MAP.getBounds();

然后我们使用地图中的值初始化一个位置矩形：

> var rect = new Microsoft.Maps.LocationRect(mapRect);

然后使用 LocationRect 方法“包含”进行检查：

> alert ("result:" + rect.contains(new Microsoft.Maps.Location(38.0, 5.0)));

我想这是因为我们用错误的值初始化矩形，我们将不胜感激一些关于我们做错了什么的线索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T00:02:09.983

我对文档的误解。LocationRect 应该被调用

> var rect = new Microsoft.Maps.LocationRect(mapRect.location, mapRect.height, mapRect.width);

# ember.js - ember.js - 当 itemcontroller 指定时，目标路由操作而不是控制器

> ID：14717451
> 
> 赞同：0
> 
> 时间：2013-02-05T21:39:37.300
> 
> 标签：ember.js

我正在使用这样的 itemController 迭代一个集合：

```
{{#each col itemController="colItem"}}
  <li>
    <a {{action doAction this}} href="#">{{name}}</a>
  </li>
{{/each}} 
```

我希望 doAction 去路线而不是 itemController。

我在这样的路线中定义了 doAction：

```
Radium.SomeRoute = Ember.Route.extend
  events:
    doAction: (status)-> 
```

如果我删除 itemController 那么它将被分派到路由。我可以以某种方式定位路线操作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T02:56:24.473

假设你的控制器是 Ember.Controller 的一个实例并且没有实现它自己的`doAction`，事件应该自动冒泡到路由。

这可能是一个 ember 错误，但当您通过帮助程序指定项目控制器时，事件似乎不会冒泡到路由器`{{#each}}`。

作为一种解决方法，您可以改为将 itemController 指定为父控制器的属性。

```
App.ItemsController = Ember.ArrayController.extend({
  itemController: "Item"
}); 
```

我创建了一个 jsbin 来演示此解决方法：http: [//jsbin.com/anesop/2/edit](http://jsbin.com/anesop/2/edit)

# java - Jackson 多态类型处理 - 属性被丢弃

> ID：14717456
> 
> 赞同：7
> 
> 时间：2013-02-05T21:39:54.933
> 
> 标签：java, json, jackson

我有这个 JSON 模型类，

```
public class Response {

    @JsonTypeInfo(use= JsonTypeInfo.Id.NAME, include=JsonTypeInfo.As.PROPERTY, property="category")
    @JsonSubTypes({
            @Type(value = Series.class, name = "Series"),
            @Type(value = Movies.class, name = "Movies")})
    public static abstract class Asset {
        public String category;
        public String id;
    }

    public static class Series extends Asset {
        public String seriesName;
        public int seasonNumber;
    }

    public static class Movies extends Asset {
        public String movieName;
    }

    public Asset[] assets;
} 
```

当我尝试反序列化以下 JSON 时，

```
{
    assets: [
        {
            "category": "Series",
            "id": "ID1",
            "seriesName": "SeriesName1",
            "seasonNumber": 1
        },
        {
            "category": "Movies",
            "id": "ID2",
            "movieName": "MovieName1"
        }
    ]
} 
```

我看到所有属性都已正确反序列化，但`category`属性除外，它们都`null`属于两种资产类型。

难道我做错了什么？或者这是预期的行为 - 用于推断子类型的属性在反序列化期间被丢弃？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-04-04T20:38:19.450

您需要设置可见=真：

```
@JsonTypeInfo(
    use= JsonTypeInfo.Id.NAME,
    include=JsonTypeInfo.As.PROPERTY,
    property="category",
    visible = true
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T22:01:36.093

是的，类别属性用于确定注释中声明的返回对象的类型。如果您仍然希望在反序列化对象中拥有该属性，您可以添加另一个属性以进行类型区分或编写没有类型元素的反序列化，如本文中的示例 6[所示](http://programmerbruce.blogspot.ro/2011/05/deserialize-json-with-jackson-into.html)。

# ios - UIDate 比较两个日期

> ID：14717459
> 
> 赞同：-1
> 
> 时间：2013-02-05T21:40:11.847
> 
> 标签：ios, objective-c, cocoa-touch

我以这种方式比较两个日期：

```
NSDateFormatter *df= [[NSDateFormatter alloc] init];
[df setDateFormat:@"  dd : MM : yyyy"];

NSDate *dt1 = [[NSDate alloc] init];
dt1=[df dateFromString:TheDate];

NSDate *Date=[NSDate date];
NSLog (@"DATE CURRENT: %@ DATE 2 %@", Date, dt1);

if ([Date compare:dt1] == NSOrderedDescending) {
    NSLog(@"Date is later than date2");

} else if ([Date compare:dt1] == NSOrderedAscending) {
    NSLog(@"Date is earlier than date2");
    [postsToBeDeleted addObject: textmessage];

} else {
    NSLog(@"dates are the same");
} 
```

NSLog 给了我：

```
DATE CURRENT: 2013-02-05 21:37:54 +0000 DATE 2 2012-01-04 23:00:00 +0000 
```

但是很明显，当前日期远远早于 dt1 日期，但我仍然得到 NSLog(@"Date is later than date2");。为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:44:52.353

因为`-compare:`NSDate 实例的工作方式。[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/doc/uid/20000188-compare_)说：

> 如果：
> 
> *   接收者和anotherDate完全相等，NSOrderedSame
> *   接收者在时间上晚于另一个日期，NSOrderedDescending
> *   接收者在时间上早于另一个日期，NSOrderedAscending。

在这种情况下，接收者是`Date`，并且`anotherDate`是您的`dt1`。`Date`是晚于时间比`dt1`，所以你得到`NSOrderedDescending`。（这实际上是您的日志语句所暗示的情况；我有点不确定混乱在哪里。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:49:06.460

请让我引用一些有趣的事情：

> 如果：
> 
> *   接收者和anotherDate完全相等，NSOrderedSame
> *   接收者在时间上晚于另一个日期，**NSOrderedDescending**
> *   接收者在时间上早于另一个日期，NSOrderedAscending。

# opencart - 无法使用 OpenCart 登录管理页面。

> ID：14717461
> 
> 赞同：2
> 
> 时间：2013-02-05T21:40:27.953
> 
> 标签：opencart

我刚刚第五次安装 OpenCart，但我总是卡在同一页面上..

安装时我没有收到任何错误，但是当我尝试登录管理页面时，我总是卡住。如果我尝试使用正确的用户名/密码，它不会显示任何错误。

这里有人有同样的问题吗？

请回答..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T22:18:55.170

您在文件中是否有任何有效的非 www 到 www 重写`.htaccess`？这是我看到发生这种情况的一个实例-管理员设置为使用`yourdomain.com/admin/`，但您的服务器设置为将所有非 www 重写为`www.yourdomain.com`

如果您打开您的`admin/config.php`- 找到`HTTP_SERVER`等的网址并将它们全部更改为`www.`如果它们还没有，反之亦然，如果它们确实有`www.`

然后保存并重新加载您的管理页面并尝试登录。希望它会工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-26T01:32:15.600

如果 php.ini 会话 cookie 标志设置为安全并且您尝试在没有 ssl 的情况下访问您的站点，那么这是您尝试登录时会遇到的奇怪行为或问题。

这是在 php.ini 文件中找到的服务器设置。

```
session.cookie_secure = 1 
```

将其设置为

```
session.cookie_secure = 0 
```

如果您的服务器上有 SSL 证书，那么启用安全实际上总是一个好主意。否则，如果不确定它被禁用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-03-04T17:51:04.507

这通常是由于会话而发生的。在磁电机中，如果您在一个文件夹中注释掉三行并删除一些会话文件，则重新启动服务器。问题解决了。我确定这里也是因为会话。我会解决问题并将其发布在这里。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-12-04T12:36:13.213

刚刚在这里找到了答案：

[https://github.com/opencart/opencart/issues/729](https://github.com/opencart/opencart/issues/729)

在我修改 /vqmod/vqcache/vq2-system_library_session.php （删除“session_start();”之后，我的问题显然解决了，但我无法登录管理面板，所以我回来把线路放回去，问题就解决了。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-03-12T14:14:22.090

可能您正在使用“db”选项来保存会话，但由于某种原因我还不知道它被窃听了。尝试在 'system\config' 中的 'catalog.php' 和 'config.php' 中将其更改为 'file'

`$_['session_engine'] = 'file';`

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2019-05-22T21:08:41.303

我刚刚将 php 版本从 7.4 更改为 7.1。导致会话与同一服务器上的其他网站崩溃。

# javascript - JavaScript - 替换字符串包含旧字符串，因此会替换自己

> ID：14717463
> 
> 赞同：0
> 
> 时间：2013-02-05T21:40:45.287
> 
> 标签：javascript, url, replace

在浏览器中使用此 javascript 时：

```
var url = window.location.toString();
window.location = url.replace(/.com/, '.com.nyud.net').replace(/.net/, '.net.nyud.net'); 
```

导致这种情况发生在以 .com 结尾的网站（以及包括其他 TLD 时）：

从

> 网站.com/123

到

> website.com.nyud.net.nyud.net/123

虽然它适用于以 .net 结尾的网站：

从

> 网站.net/abc

到

> 网站.net.nyud.net/abc

如何调整它以使其正常工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T21:45:47.937

发生这种情况是因为`.net`in`.com.nyud.net`被替换为`.com.nyud.net`.

要解决此问题，请使用一个正则表达式替换所有 TLD。

```
window.location = url.replace(/\.(com|net|org)(?=$|\/|\?)/, '.$1.nyud.net'); 
```

我稍微修改了正则表达式，以便它使用反向引用将 TLD 添加到替换字符串中。它还确保 the`.com`后跟字符串的结尾或 a `/`，因此它与 . 之类的内容不匹配`www.company.net`。

**更新**：固定以`website.com/123`正确替换 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:43:42.823

第一个替换替换`.com`为`.com.nyud.net`。第二次替换然后将新替换`.net`为`.net.nyud.net`。所以你最终得到`website.com.nyud.net.nyud.net`

翻转逻辑，使`.net`之前被替换`.com`。

改为使用 `url.replace(/.net/, '.net.nyud.net').replace(/.com/, '.com.nyud.net');` 。

**更新：** 逃脱`.`，因为它很特别。 `url.replace(/\.net/, '.net.nyud.net').replace(/\.com/, '.com.nyud.net');`

**更新：** 您可能只想在 urls: 末尾替换： `url.replace(/\.net$/, '.net.nyud.net').replace(/\.com$/, '.com.nyud.net');` 但这假定没有路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:46:20.853

您可能应该`$`在您的正则表达式中使用 来定义您要替换字符串的*结尾*而不是字符串的任何部分。

然后格式化*主机*而不是完整的 url 并在`/`之后添加任何内容。

像这样的东西：

```
var host = window.location.host; // website.com
var restOfUrl = window.location.pathname;

var newHost = host.replace(/\.com$/, '.com.nyud.net').replace(/\.net$/, '.net.nyud.net');
var url = newHost + restOfUrl; 
```

# xml - 如何为 DIxml 声明警告、错误和致命错误函数？

> ID：14717464
> 
> 赞同：0
> 
> 时间：2013-02-05T21:40:47.940
> 
> 标签：xml, delphi, sax, delphi-2009

我正在使用 DIxml 解析几个 XML 文件。到目前为止效果很好。昨天我得到了一个似乎是正确的 XML 文件，但 DIxml 无法解析。我还没有实现警告、错误和致命错误功能，因为它从第一天开始就完美运行 :-)

我今天尝试实现这些函数，但我从 Delphi 收到一个编译器错误，说我的声明与预期的声明不同。从我的角度来看，我做得对，但我相信编译器知道得更好。

我实现了 SAX2 示例中所示的structuredError 方法，但我的源代码从未命中此函数。我现在所有的希望都寄托在致命错误方法上。

以下是有关该功能的一些其他详细信息。

由于该库是封闭源代码，因此我无法访问 pas 文件中的正确声明。当我用鼠标聚焦警告方法时，我只看到 hoover/tooltip 信息。

第一：我如何初始化 SAX 阅读器（部分）

```
var
  f8      : Utf8String;
  User    : TImportData;
begin
  User := TImportData.Create;

  xmlInitParser; // Initialize the XML library.

  { Initialize the SAX2 handler. To start off with, we set all functions to
    nil. If we use a nil SAX parser like this, then we will have a parser that
    only checks that the document is well formed. }
  FillChar(FSaxHandler, SizeOf(FSaxHandler), 0);

  { By adding a few callbacks to the SAX handler, we can get the parser 
    to do just about anything. }
  FSaxHandler.startDocument   := SaxStartDocument;
  FSaxHandler.endDocument     := SaxEndDocument;
  FSaxHandler.characters      := SaxCharacters;
  FSaxHandler.Warning         := Warning;
  FSaxHandler.Error           := Error;
  FSaxHandler.fatalError      := fatalError;

end;

procedure SaxStartDocument(Ctx: Pointer);
var
  User: PImportData;
begin
  User                  := Ctx;

  //Do something with user...
end;

procedure Warning(Ctx: Pointer; Msg: PAnsiChar);
var
  User: PImportData;
begin
  User := Ctx;

  //Do something with user...
end;

procedure SaxCharacters(Ctx: Pointer; const Ch: xmlCharPtr; Len: Integer);
var
  s: Utf8String;
var
  User: PImportData;
begin
  User := Ctx;

  //Do something with user...
end; 
```

当用鼠标聚焦线`FSaxHandler.characters := Warning;`时，我在工具提示窗口中得到以下信息：

> DIXml.xmlSAXHandler 中的 Deklariert
> 
> ```
>  Parameters
>    Ctx 
>      System.Pointer 
>    Msg 
>      System.PAnsiChar 
> ```

聚焦线时，`FSaxHandler.characters := SaxCharacters;`我得到以下工具提示

> DIXml.xmlSAXHandler 中的字符事件 Deklariert
> 
> ```
>  Parameters
>  Ctx 
>   System.Pointer 
>  Ch 
>   System.PAnsiChar 
>  Len 
>   System.Integer 
> ```

当我按 CTRL + F9 编译源代码时，我收到以下错误消息：

> [DCC Fehler] UnitSAX2_XML_Reader.pas(247): E2009 Inkompatible Typen: 'Unterschiede in der Aufrufkonvention'
> 
> [DCC Fataler Fehler] importObjects.pas(8): F2063 Verwendete Unit 'UnitSAX2_XML_Reader.pas' kann nicht compiliert werden

这意味着翻译

> [DCC 错误] UnitSAX2_XML_Reader.pas(247)：E2009 不兼容的类型：“呼叫定义的差异”
> 
> [DCC 致命错误] importObjects.pas(8): F2063 used Unit 'UnitSAX2_XML_Reader.pas' 无法编译

# xpages - 验证组合框、单选按钮、常规按钮等？

> ID：14717466
> 
> 赞同：3
> 
> 时间：2013-02-05T21:40:56.223
> 
> 标签：xpages

我在表单上使用 ErrorMessage 控件来验证编辑框之类的内容。效果很好。当需要输入数据时，会弹出灰色的小警报类型框。

谁能给我举个例子，说明我如何对单选按钮、组合框等做同样的事情？甚至是一个常规按钮（比如我在表单上有一个添加文档按钮）。

我真的不在乎消息的实际显示方式。我只想让我的验证在所有组件的验证中保持一致。换句话说，我不想要一些服务器端和一些客户端验证。

有什么例子吗？我一直在使用我自己的 ext lib 对话框进行验证，效果很好，但我希望有一些更容易实现的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T07:55:30.447

我一直在使用[此 XSnippet 的扩展版本进行验证](http://openntf.org/XSnippets.nsf/snippet.xsp?id=ssjs-form-validation-that-triggers-errormessage-controls)。这使您可以在中央 SSJS 库中管理所有验证，然后在 Display Errors 控件中显示所有错误。

然后，在中央 SSJS 库中，您可以验证您的控件，包括单选按钮、组合框等，并结合您的验证（例如，当另一个控件具有特定值时检查一个控件的值）。

这是一个基于上述 XSnippet 的示例，用于验证当单选按钮组 (radioField) 的值为 1 时是否已填写某个字段 (FieldA)：

```
var radioVal = getComponent("radioField").value;
var control = getComponent("FieldA");
var val = control.getValue();
if (radioVal == "1" && isEmpty(val)){
  valid = false;
  postValidationError(control, "Please fill in ...");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T13:21:17.200

我希望 ErrorMessage 控件是指“显示错误”控件。对于“数据”内的所有属性中的组合框，您将找到“验证器”。在这里，您可以像添加编辑框一样添加验证。对于组合框，我通常使用`validateExpression`. 然后我使用“显示错误”控件来显示错误。

```
<xp:comboBox id="comboBox1">
    <xp:this.validators>
        <xp:validateExpression message="Please select value in combo box.">
            <xp:this.expression><![CDATA[#{javascript:!getComponent("comboBox1").getSubmittedValue().equalsIgnoreCase("Select")}]]></xp:this.expression>
        </xp:validateExpression>
    </xp:this.validators>
    <xp:selectItem itemLabel="Select" itemValue="Select"></xp:selectItem>
    <xp:selectItem itemLabel="1" itemValue="1"></xp:selectItem>
    <xp:selectItem itemLabel="2" itemValue="2"></xp:selectItem>
    <xp:selectItem itemLabel="3" itemValue="3"></xp:selectItem>
</xp:comboBox>
<xp:message id="message1" for="comboBox1"></xp:message> 
```

在上面的示例中，如果用户没有在组合框中选择任何项目，则错误消息将显示给用户。请注意，这是服务器端验证。我还没有尝试过其他控件，但它应该以类似的方式工作。

让我知道我是否正确理解了您的问题。

**2013 年 2 月 7 日更新：**请查看以下 Mikael Grevsten 的评论以获得更好的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-09T14:25:33.150

甚至最简单直接：如果您有“选择一个选项”之类的选项并设置空值“”，则可以使用**validateRequired**，仅此而已。例子：

如果组合框值为：

```
["-Select an option-|","Text1|Value1","Text2|Value2"] 
```

正如@Naveen 所说，您可以转到所有属性> 数据> 验证器> + > ValidateRequired > 设置您的**消息**，您就完成了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-26T20:27:47.730

能够通过使用@GetField 和组的名称来验证一组单选按钮。

在此示例中，组名称为 BankLoss：

```
// BankLoss
var radio1 = @GetField("BankLoss")
if (radio1 == null || radio1 == ""){
    valid = false;
    errors.push("Please indicate if there was a potential bank loss.");
} 
```

为我工作...

# bash - 复制（cp）符号链接指向的东西而不是符号链接本身

> ID：14717469
> 
> 赞同：7
> 
> 时间：2013-02-05T21:41:01.847
> 
> 标签：bash, unix

我知道目录 ~/foo 和 ~/bar 已经存在。

我知道“cp -R ~/foo ~/bar”会递归地将 ~/foo 目录复制到 ~/bar 目录中，这可能会导致 ~/bar/foo 被创建。

但是如果 foo 是一个目录的符号链接呢？我可以让 cp 命令复制符号链接指向的目录，而不是符号链接本身吗？

因为使用上面的命令，如果 foo 是一个符号链接，那么 ~/bar/foo 实际上只是一个符号链接。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T21:45:55.857

来自`man cp`：

```
 -L, --dereference
          always follow symbolic links in SOURCE 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-05T21:46:03.620

像这样使用 -L 选项：

```
cp -RL ~/foo ~/bar 
```

# javascript - Kendo UI Grid 未提取本地数据

> ID：14717470
> 
> 赞同：0
> 
> 时间：2013-02-05T21:41:04.477
> 
> 标签：javascript, jquery, kendo-ui

我似乎无法在下面的剑道网格中获取本地数据（var people）。如果没有 people 数组和 dataSource 属性，列数据可以很好地呈现。所以不确定错误在哪里。

```
<!doctype html>
<head>
<link href="styles/kendo.common.min.css" rel="stylesheet" type="text/css" />
<link href="styles/kendo.default.min.css" rel="stylesheet" type="text/css" />
<script src="js/jquery.min.js" type="text/javascript"></script>
<script src="js/kendo.web.min.js" type="text/javascript"></script>

</head>
<body>
<div id="grid">
</div>
<script>
$(function(){
    $("#grid").kendoGrid({

        var people = [{patientName: "John Doe", MRN: "464684778", account: "56765765224768", dateOfBirth: "01/06/2013", room: 403, bed: 22, admitDate: "01/15/2013" }];

                columns: [{title: "Patient Name"},
                    {title: "MRN"},
                    {title: "Account#"},
                    {title: "Date of Birth"}, 
                    {title: "Room"}, 
                    {title: "Bed"}, 
                    {title: "Admit Date"}],

                    dataSource: {
            data:people
        }                   
    });
});
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:45:47.113

有几件事我看到...

1.  people 数组在网格初始化代码中
2.  您没有在列中指定字段。

    ```
    $(function(){

       var people = [{patientName: "John Doe", MRN: "464684778", account: "56765765224768", dateOfBirth: "01/06/2013", room: 403, bed: 22, admitDate: "01/15/2013" }];

       $("#grid").kendoGrid({
         columns: [{field: "patientName", title: "Patient Name"},
                   {field: "MRN", title: "MRN"},
                   {field: "account", title: "Account#"},
                   {field: "dateOfBirth", title: "Date of Birth"}, 
                   {field: "room", title: "Room"},
                   {field: "bed", title: "Bed"},
                   {field: "admitDate", title: "Admit Date" }],
         dataSource: {
           data:people
         }                   
      });

    }); 
    ```

工作样本：http: [//jsbin.com/uxaqus/1](http://jsbin.com/uxaqus/1)

# sql - 接收与主键数组匹配的记录，其顺序与它们在数组中出现的顺序相同

> ID：14717471
> 
> 赞同：4
> 
> 时间：2013-02-05T21:41:10.967
> 
> 标签：sql, arrays, postgresql

我有主键的列表/数组，现在我需要执行 SQL 查询以从表中获取记录，其顺序与它们在数组中出现的顺序完全相同。例如：

```
| id |     text      |
| 1  | random data 1 |
| 2  | random data 2 |
| 3  | random data 3 |
| 4  | random data 4 | 
```

这个查询：

```
select * from sample where id in (2,4,1) 
```

应该返回行：

```
| 2  | random data 2 |
| 4  | random data 4 |
| 1  | random data 1 | 
```

在 PostgreSQL 9.3 中最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:00:02.013

单程：

```
SELECT t.id, t.text
FROM (
   SELECT *, row_number() OVER () AS rn
   FROM  (
      SELECT unnest('{2,4,1}'::int[]) AS id
      ) x
   ) y
JOIN   tbl t USING (id)
ORDER  BY rn 
```

[诀窍是使用窗口函数`row_number()`](http://www.postgresql.org/docs/current/interactive/functions-window.html)应用行号，您可以`ORDER BY`在`JOIN`. [在 dba.SE 上](https://dba.stackexchange.com/questions/27279/how-do-i-preserve-the-order-of-the-original-elements-in-an-unnested-array)
这个密切相关的问题下找到更多方法（一种更安全的方法）、详细解释和链接。

# excel - Sum() 跨动态张数

> ID：14717472
> 
> 赞同：3
> 
> 时间：2013-02-05T21:41:17.253
> 
> 标签：excel, excel-formula, excel-2010, vba

大家好，提前感谢您的帮助，

我有一个 Excel 表，它仅用于汇总多张表。最好也是最简单地说，公式类似于`=sum(Sheet1!A1,Sheet2!A1,Sheet3!A1,Sheet4!A1)`. 不过，有一些问题会使事情复杂化。首先，我不知道要汇总的表格的数量或顺序，也不知道它们的名字。这个公式将被复制到大约 150 个其他单元格中，因此我需要动态求和，而不是每次都将工作表物理添加到大约 150 个单元格中。（此外，工作表的配置和命名也不允许轻松拖动公式。）

所以首先，我认为我可以使用`indirect()`参考来编写它。我做了一个列来列出将添加到每个单元格中的所有工作表名称。不幸的是，`concatenate()`不能在数组上使用，所以我不得不求助于下面看到的 UDF：

```
Function CONCAT(Delimiter As Variant, ParamArray CellRanges() As Variant) As String
Dim Cell As Range, Area As Variant
If IsMissing(Delimiter) Then Delimiter = ""
For Each Area In CellRanges
If TypeName(Area) = "Range" Then
For Each Cell In Area
If Len(Cell.Value) Then CONCAT = CONCAT & Delimiter & Cell.Value
Next
Else
CONCAT = CONCAT & Delimiter & Area
End If
Next
CONCAT = Mid(CONCAT, Len(Delimiter) + 1)
End Function 
```

使用 UDF，我可以获得一个具有正确语法的大字符串，例如`=CONCAT("'!A"&(B1+1)&",'",Array_of_Sheets)&"'!A"&(B1+1)`. 将`CONCAT()`分隔符作为第一个参数，将数组作为第二个参数。然后我将“分隔符”附加到字符串的末尾，以输出诸如`Sheet1'!A1,'Sheet2'!A1`. 我认为在这一点上，一个简单的`=sum(indirect(STRING))`就足够了，但`=sum(indirect("Sheet1!A1,Sheet2!A1,Sheet3!A1,Sheet4!A1"))`由于`indirect()`似乎无法处理逗号，所以不起作用。

所以为了解决这个问题，我将 to 切换`=CONCAT()`为`=CONCAT("'!A"&(B1+1)&"+'",Array_of_Sheets)&"'!A"&(B1+1)`output `Sheet1'!A1+'Sheet2'!A1`。现在我写了另一个 UDF 来强制它评估如下所示：

```
Function EVAL(RefCell As String)
Application.Volatile
EVAL = Evaluate(RefCell)
End Function 
```

这行得通！太棒了，对吧？但是经过一些使用和测试，它似乎不太一致。当我们打开其他工作表时，它并不总是评估（我们将打开其他工作表）。我读到了`volatile`在 UDF 中使用的一些其他不一致之处，但我找不到它们。

所以对于我的理想，我想在没有任何 VBA 的情况下做到这一点，但我怀疑这是不可能的。我宁愿不依赖用户手动重新计算工作表（部分原因`volatile`）。最后，我只希望它以`sum()`一致的方式进行，因此如果用户打开文档并点击打印，用户不需要确认函数正在正确评估（检查#REF 错误或手动添加值以确保他们是正确的）。我希望找到使用该等`eval()`式的替代方法。

*编辑以下附加信息*

我曾尝试使用 3D 数组，但遇到了一些问题。假设工作簿有八张纸。在这八张纸中，只有两张可以输入到这张总纸中。有`setup`片材、`total`片材、`data entry`片材、`data analysis`片材。工作表`total`总计关闭工作`data analysis`表。通常，一张`data entry`纸与一张纸重合`data analysis`。`data entry`因此，用户可以制作表格和`data analysis`表格的副本。最合乎逻辑的工作表顺序将从工作表开始，然后是和工作表`setup`的每一对，以及`data entry``data analysis``total`床单。显然，此设置不适用于 3D 阵列。我们将不得不重新排序工作表并确保用户知道工作表的顺序实际上很重要（非典型配置）。`data analysis`在某些情况下，工作表中不会包含一张或两张工作`total`表。所以我们最终可能会得到一个工作表配置`setup \ data entry (1) \ data entry (2) \ START \ data anaylsis (1) \ data analysis (2) \ END \ totals \ data entry (3) \ data entry (4) \ data anaylsis (3) \ data analysis (4)`。我的感觉是 3D 阵列配置几乎会使添加*过于*动态。我宁愿有一个明确的列表，然后依赖于用户有信心移动工作表以获得正确的总数。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-05T21:49:15.387

好消息！你可以让你的生活变得更简单——通过使用 3D 公式：

如果您使用这个公式：`=SUM(Sheet1:Sheet3!$A$1:$B$2)`，A1:B2 中的所有单元格将被求和 - 从 Sheet1 到 Sheet3 的所有工作表！

通常，使用两个“帮助”表来处理打开/更改数量的工作表很有帮助：

1.  插入两个名为*START*和*END的工作表*
2.  将您的 3D 公式跨越这两张纸
3.  在这些工作表之间移动所有工作表或在这些工作表周围移动*START*和*END*工作表（当然，这也可以在步骤 1 中完成）
4.  隐藏两个帮助表

查看此[链接](http://office.microsoft.com/en-001/excel-help/create-a-3-d-reference-to-the-same-cell-range-on-multiple-worksheets-HP010102346.aspx)以获取更多说明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T00:00:03.000

这是另一种方法：

假设您的用户的数据输入表根据某种必须严格遵守的系统进行标记（例如“数据输入 1”、“数据输入 2”等），您可以使用`INDIRECT`- 构建一个汇总表，然后而是总计此表。

详细地说，您的“总计”表中有一个辅助表，看起来像这样：

```
   Col A Col B Col C Col D
1个C5 X7
2 工作表名称存在吗？价值 1 价值 2
3 数据输入 1 真 10 20
4 数据输入 2 FALSE 0 0
5 数据输入 3 真 20 30
6 ...
.
.
.
20 多个工作表名称比你永远得到的要确定！

```

*   在单元格 C1 和以下列中，您将写入要总计的单元格的地址。如果您有模板并希望保持引用动态（通常地址的静态性质是此处错误的来源），请使用`=ADDRESS(ROW(Template!C5);COLUMN(Template!C5))`获取动态地址。
*   在 B 列中，您将使用以下公式：`=NOT(ISERROR(INDIRECT(ADDRESS(1,1,,,A3))))`
*   在 C 列和以下列中，使用以下命令：`=IF(B3,INDIRECT("'"&A3&"'!"&C$1),0)`

现在您只需要合计列 C 等等。

# c++ - 在 Linux 上运行，在 Windows 7 上崩溃

> ID：14717473
> 
> 赞同：0
> 
> 时间：2013-02-05T21:41:22.267
> 
> 标签：c++, windows, crash, command-line-arguments

我编写了一个程序，它有一个应该从命令行参数复制字符串的类。

这是有问题的代码。

```
void FileHandler::SetFile(const char*& filename)
{
    for(unsigned tsr = 0; tsr < 200; tsr ++){
        if(filename[tsr] == 0x0){
            mFilename = new char[tsr];
            strcpy(mFilename, filename);
            mFilenameAllocated = true;
        }
    }
} 
```

我假设一个命令参数是 NULL 终止的，所以这个代码块会查找一个 NULL 字符来查找字符串的长度，然后再将它的 memcpy'ing 到一些新的内存空间中。

我忽略了什么？或者这段代码应该“正常工作”吗？

谢谢

编辑：

strcpy 有错吗？如果命令 arg 不是 NULL 终止的，它是否会沿着一段内存运行，直到导致访问冲突？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:45:35.007

您分配的字符串太短了一个字符。

想象一下输入是`"A"`. 然后您将找到`0x0`at 索引 1，并分配一个字符。`strcpy`然后将复制 A 和空终​​止符，你注定要失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:52:13.070

问题1：

找到 NULL 字符后，for 循环不会“中断”。这意味着有时它会表现出未定义的行为。（这在编码时间过长时会出现问题。）

问题2：

内存分配是 1 个字符短两个。

编辑：

贡献者已+1。

# php - 在 PHP 中解析一个文本文件，其中数据的格式发生了变化

> ID：14717479
> 
> 赞同：0
> 
> 时间：2013-02-05T21:41:56.120
> 
> 标签：php, parsing, text-files

我的数据看起来像这样。

```
123456  abc1 (aaa: [bbb]aaa)    http://exampleurl.org.uk

654321 cba2 (bbb: aa7)  http://urlexample.org.uk
... 
```

我想将每一行分成 3 个字符串，所以我可以将它们放入一个数组中。例如：

```
string 1 = 123456   

string 2 = abc1 (aaa: [bbb]aaa)

string 3 = http://exampleurl.org.uk 
```

我的问题是第二个字符串经常以许多不同的格式发生变化。第一个字符串总是相似的，最后一个字符串总是一个 url。

编辑：如果这有帮助，我注意到所有第二个字符串都以括号')'结尾。

我打算使用 explode() 但我不确定如何处理第二个字符串。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:51:23.540

虽然我可能只会使用正则表达式，但这也是一个选项：

```
function parse($str)
{
    $parts = explode(" ", $str);

    // first part of the exploded str
    $number = array_shift($parts);

    // last part of the exploded str
    $url = array_pop($parts);

    // all thats left is the middle str
    $between = trim(implode(" ", $parts), " ");

    return array($number, $between, $url);
}

$str = "123456  abc1 (aaa: [bbb]aaa)    http://exampleurl.org.uk";

print_r(parse($str)); 
```

输出：

```
array (size=3)
  0 => string '123456' (length=6)
  1 => string 'abc1 (aaa: [bbb]aaa)' (length=20)
  2 => string 'http://exampleurl.org.uk' (length=24) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:46:29.183

使用正则表达式：

```
$input = "123456  abc1 (aaa: [bbb]aaa)    http://exampleurl.org.uk";
preg_match("/([0-9]+)\s+(.+)\s+(http:\/\/.*)/i", $input, $matches); 
```

这会将结果存储到`$matches`L

```
Array
(
  [0] => 123456  abc1 (aaa: [bbb]aaa)    http://exampleurl.org.uk
  [1] => 123456
  [2] => abc1 (aaa: [bbb]aaa)   
  [3] => http://exampleurl.org.uk
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T21:47:01.543

您的格式实际上很简单：

```
Number - Space(s) - Random Stuff - Space(s) - URL 
```

所以你只需要一个像这样的正则表达式：

```
^(\d+)\s+(.*?)\s+(URL)$ 
```

`URL`您在 URL 匹配正则表达式中的偏好在哪里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T21:56:14.953

如果之间总是有空格或总是制表符`$string1`，你可以这样做：`$string2``$string3`

```
$line = '123456  abc1 (aaa: [bbb]aaa)    http://exampleurl.org.uk';
$string1 = substr($line, 0, ($pos = strpos($line, ' '))); // use "\t" instead of ' ' if tab is delimiter
$string2 = trim(substr($line, $pos, ($pos2 = strrpos($line, ' ')) - $pos));
$string3 = substr($line, $pos2 + 1); 
```

这将比正则表达式或爆炸和连接数组快得多

# cassandra - 将 tor 添加到 Thrift / Astyanax API

> ID：14717480
> 
> 赞同：2
> 
> 时间：2013-02-05T21:42:08.890
> 
> 标签：cassandra, thrift, astyanax

我试图在 Astyanax 的节俭之上添加 TOR，我想知道是否有人尝试过或遇到过任何类似的项目。广泛的谷歌搜索（甚至是 bing 搜索）让我无处可去。我盯着看 Astyanax 的源代码，试图找出客户端和 Cassandra 之间的实际连接发生在哪里，并最终出现在[这个类](https://github.com/Netflix/astyanax/blob/master/src/main/java/com/netflix/astyanax/connectionpool/impl/ConnectionPoolConfigurationImpl.java)中。据我所知，这只是一小部分，但我真正需要找到的是 API 是否使用 InputStream 和 OutputStream 对象来发送和接收数据，并希望使连接过载。

这个问题可能会因为过于本地化而被关闭，但我希望一些 Cassandra / astyanax 大师可以为我指明正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T01:33:48.170

您需要找到 Cassandra 在您的客户端计算机和服务器之间建立桥梁的位置。提供该连接方式的类（或类集合）可能会使用一个套接字，该套接字使用输入/输出流来发送和接收数据。

更新：从用于 Hector 和 Astyanax 的 Thrift API (libthrift) 中查看的关键类

*   `org.apache.thrift.transport.TSocket`- 创建用于连接 Cass 的套接字。
*   `org.apache.thrift.transport.TIOStreamTransport`- 处理输入/输出流以及添加到其中的数据（您发送/接收的内容）

您应该采取的下一步是转移套接字以通过 TOR 而不是 TCP/IP 连接到 Cassandra。

# oracle - oracle程序编译错误

> ID：14717489
> 
> 赞同：1
> 
> 时间：2013-02-05T21:42:45.727
> 
> 标签：oracle, oracle11g

数据库版本：Oracle 11.2.0.2

场景：尝试使用过程自动创建范围分区。下面是代码。它被创建没有任何错误。但是当我执行时，它会抛出一个错误。我认为传递给变量的值不正确。我尝试了各种 sql，但没有任何效果。有人可以帮我完成这个过程。

```
SQL> CREATE OR REPLACE PROCEDURE MONTHLY_PARTITION as
  2
  3    v_partition_name varchar2(30);
  4    v_limit TIMESTAMP with local time zone;

  5    6  begin
  7
  8    select to_char(trunc(add_months(sysdate,1),'MM'),'MonYYYY')
  9    into v_partition_name
 10    from dual;
 11
 12    SELECT TO_TIMESTAMP(TO_CHAR(ADD_MONTHS(current_timestamp, 2), 'YYYYMMDD HH24:MI:SS'), 'YYYY-MM-DD HH24:MI:SS')  into v_limit from dual;
 13
 14  execute immediate 'ALTER TABLE TEST ADD PARTITION ' || v_partition_name || ' VALUES LESS    THAN (TIMESTAMP ' || v_limit || ')';
 15
 16  end;
 17  /

Procedure created.

SQL> show errors
No errors.
SQL>
SQL> exec MONTHLY_PARTITION;
BEGIN MONTHLY_PARTITION; END;

*
ERROR at line 1:
ORA-14019: partition bound element must be one of: string, datetime or interval literal, number, or MAXVALUE
ORA-06512: at "MONTHLY_PARTITION", line 14
ORA-06512: at line 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:18:02.910

你所拥有的其实还可以。只是一些数据类型错误而已！

在将其拼接到 DDL 时，您必须将变量作为`varchar2`而不是。`timestamp`

IE：

```
SQL> create table TEST(dte timestamp)
  2  partition by range (dte)
  3  (PARTITION TODAY VALUES LESS THAN (TIMESTAMP'2012-02-01 00:00:00'));

Table created.

SQL> CREATE OR REPLACE PROCEDURE MONTHLY_PARTITION as
  2
  3   v_partition_name varchar2(30);
  4   v_limit varchar2(30);
  5
  6    begin
  7
  8   select to_char(trunc(add_months(sysdate,1),'MM'),'MonYYYY')
  9   into v_partition_name
 10   from dual;
 11
 12   SELECT TO_CHAR(ADD_MONTHS(current_timestamp, 2), 'YYYY-MM-DD HH24:MI:SS')  into v_limit from dual;
 13
 14  execute immediate 'ALTER TABLE TEST ADD PARTITION ' || v_partition_name || ' VALUES LESS THAN (TIMESTAMP''' || v_limit || ''')';
 15
 16  end;
 17  /

Procedure created.

SQL> exec monthly_partition

PL/SQL procedure successfully completed.

SQL> select partition_name from user_tab_partitions where table_name = 'TEST';

PARTITION_NAME
------------------------------
TODAY
MAR2013 
```

另请注意，您当前的表达式`ADD_MONTHS(current_timestamp, 2)`不会截断为月份。你也想这样做吗？即`trunc(ADD_MONTHS(current_timestamp, 2), 'mm')`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:53:37.560

将此分配给字符串变量：

```
 str := 'ALTER TABLE TEST ADD PARTITION ' || v_partition_name 
       || ' VALUES LESS THAN (TIMESTAMP ' || v_limit 
       || ')'; 
```

然后

```
dbms_output.PUT_LINE( str );
execute immediate str; 
```

查看输出 str 是否会按照您的预期从 sql plus 运行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:53:01.963

分区值必须是固定的，必须手动处理。指定分区值时不能有表达式。

# r - 在 R 中扭曲彩虹

> ID：14717490
> 
> 赞同：2
> 
> 时间：2013-02-05T21:42:46.077
> 
> 标签：r, plot

如何扭曲 R 中的默认彩虹。例如，看看这段代码和它产生的图像：

```
x = seq(0,50,by=0.005)
y = runif(length(x),2,5)
colors = rainbow(length(x))
plot(x,y,cex=0.2,pch=16,col=colors) 
```

![在此处输入图像描述](../Images/82e5cf9152e68240e5ab370e319a0b61.png)

我想改变它，这样就没有那么多绿色了。绿色应该和黄色、青色和蓝色一样多。我还想去除洋红色（最右边的“红色”颜色）。我怎么能这样做呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T22:33:40.630

如果您从调色板生成中明确跳过绿色，您将接近您想要的我的想法：

```
par(mfrow=c(2,1))
par(mar=c(2,1,3,1))

x = seq(0,50,by=0.005)
y = runif(length(x),2,5)
colors = rainbow(length(x))
plot(x,y,cex=0.2,pch=16,col=colors)
title(main="old")

crp.rg <- colorRampPalette(c("red","yellow","cyan","blue","red"))
colors = crp.rg(length(x))
plot(x,y,cex=0.2,pch=16,col=colors)
title(main="new") 
```

![在此处输入图像描述](../Images/a9c1110cc913590f8f09361b6d366318.png)

# 编辑

您还可以手动编辑每个颜色过渡以使它们具有不同的长度：

```
par(mfrow=c(2,1))
par(mar=c(2,1,3,1))

x = seq(0,50,by=0.005)
y = runif(length(x),2,5)
colors = rainbow(length(x))
plot(x,y,cex=0.2,pch=16,col=colors)
title(main="old")

crp.step1 <- colorRampPalette(c("red","yellow"))
crp.step2 <- colorRampPalette(c("yellow","green"))
crp.step3 <- colorRampPalette(c("green","cyan"))
crp.step4 <- colorRampPalette(c("cyan","blue"))
crp.step5 <- colorRampPalette(c("blue","red"))

colors <-   c(
           crp.step1(2666),
           crp.step2(1000),
           crp.step3(1000),
           crp.step4(2666),
           crp.step5(2667)
        )

plot(x,y,cex=0.2,pch=16,col=colors)
title(main="new") 
```

![在此处输入图像描述](../Images/66d9e58385ea1e068c99ebc3511a59d9.png)

# c++ - 一个类可以在其成员初始化列表中初始化其非立即基类吗？

> ID：14717495
> 
> 赞同：1
> 
> 时间：2013-02-05T21:43:11.553
> 
> 标签：c++, inheritance, constructor, initialization, derived-class

以下代码摘自[Apache C++ 标准库用户指南](http://stdcxx.apache.org/doc/stdlibug/39-3.html)

```
class DerivedOutputStream : public std::ostream {
  public:
    DerivedOutputStream():
      std::ios(0), std::ostream(&dsb) {}        //1
    // ...
  private:
    DerivedStreamBuf dsb;
    // ...
}; 
```

* * *

请注意，`std::ios`它不是 的直接基类`DerivedOutputStream`，但它出现在成员初始化列表中。

我认为这是不正确的，是吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:49:53.670

如果它是一个虚拟基类是正确的。虚拟基是从最派生的类初始化的。

# c++ - 进行位移和掩码的最高效/正确的方法是什么？

> ID：14717497
> 
> 赞同：1
> 
> 时间：2013-02-05T21:43:17.550
> 
> 标签：c++

我已经看到了两种不同的方法来组合位移和屏蔽，并且想知道它们是否等效，假设结果被用作布尔值，或者一个问题比另一个问题更少或性能更好。

他们俩：

`flags & (BIT_MASK << BIT_NUMBER)`

或者

`(flags >> BIT_NUMBER) & BIT_MASK`

前者似乎在某些平台上可能存在问题，具体取决于 的大小`flags`，即位移可能会将掩码推出临时变量的顶部。这是一个问题吗？升档和降档有性能差异吗？

将`BIT_MASK`和组合`BIT_NUMBER`成一个明确的掩码让我再次感到更好，但我正在使用我想尽量减少更改的遗留代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:05:26.360

`flags & (BIT_MASK << BIT_NUMBER)`可以在一位和指令中完成。

`(flags >> BIT_NUMBER) & BIT_MASK`需要两条指令，一个移位后跟一个位与。

（其实在PowerPC上，第二个版本也有专门的操作码`rlwinm`，但是Intel就没有这个运气了。）

当然，最大的区别是它们产生不同的结果值。如果您只检查零或非零，那么我更喜欢第一个版本，因为它是一条指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:01:21.447

如果`BIT_MASK`和`BIT_NUMBER`是常量，编译器可能会预先计算表达式并在将它们组合在一起时保存指令。这有利于第一种方法。

如果您想获得不止一位，您将希望将结果向右移动。这有利于第二种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:10:23.923

我建议您不要考虑编译器后端可能会做什么，如果您不使用优化，那么没关系，如果您使用优化，那么任何好的编译器都会在很少的指令中做正确的事情尽可能为您的编译目标。

考虑它在语言中的语义含义。例如，如果 flags 是 type`uint64_t`并且`BIT_NUMBER`大于 31，那么只有 2nd 形式可能会执行您想要的操作。原因是`(BIT_MASK << BIT_NUMBER)`它将被评估为`int`，可能是 32 位，并且由于`BIT_NUMBER`大于 31 将评估为零，因此整个事物在 AND 之后将产生零。另一方面，`(flags >> BIT_NUMBER)`将被评估为 64 位表达式（因为标志是 64 位），并且在执行 AND 之前将被正确移位。

有关 Clang 编译器的有趣讨论，请参阅[Clang: Defending C++ from Murphy's Million Monkeys](http://channel9.msdn.com/Events/GoingNative/GoingNative-2012/Clang-Defending-C-from-Murphy-s-Million-Monkeys)这将向您展示当今编译器可能对语义理解的深度，特别是查看`21:25`我在上面提到的 C++ 整数算术规则的细微差别的分钟. 这是演讲中使用的示例

```
static const long long DiskCacheSize = 8 << 30; // 8 Gigs

Clang gives:

% clang++ -std=c++11 -fsyntax-only overflow.cpp
overflow.cpp:1:42: warning: signed shift result (0x200000000) requires 35 
bits to represent, but 'int' only has 32 bits [-Wshift-overflow]
static const long long DiskCacheSize = 8 << 30; // 8 Gigs
                                       ~ ^  ~~ 
```

最近，我惊讶地发现 gcc 和 Java JIT 编译器足够聪明，可以理解一组移位、掩码和 OR 本质上是对 32 位量进行旋转，例如，将生成旋转指令，请参阅[按位旋转是否比当前 Intel CPU 上的移位慢？](https://stackoverflow.com/questions/12770667/are-bitwise-rotations-slower-than-shifts-on-current-intel-cpu). 这些天编译器非常好。

# jquery - ajax 发布并返回 html 以显示在 div 中

> ID：14717501
> 
> 赞同：3
> 
> 时间：2013-02-05T21:43:36.700
> 
> 标签：jquery, html, ajax, portal

jQuery v 1.9.0

当页面加载时，我触发了两个函数（get_month() 和 get_todays_events()），它们返回日历和今天的事件 html。

有时当我刷新页面时，它会显示两次今天的事件并且不显示日历（月），如下所示。

![在此处输入图像描述](../Images/baf27eac376b6abb2ec147d31fd0027f.png) **一半的时间它工作得很好，如下所示：**

![在此处输入图像描述](../Images/f5fbc662b21836509805399b684cf820.png)

firebug 控制台中没有错误。它作为一个独立的应用程序运行良好，但是当我将它合并到 Jasig 的 uPortal 中时，它就搞砸了。

然后我尝试剥离从 ajax 帖子发回的 html，我注意到 get_todays_events(); 可能是罪魁祸首，但我仍然不知道它可能是什么。

html 中是否有一些东西可能会出错，或者我应该在 get_month(); 之后延迟触发该函数吗？火灾？

```
$.noConflict();
jQuery(document).ready(function($) {

  function get_month()
  {
    var url_month = jQuery("#days_for_month_url").attr("href");

    var form_data = { ajax : '1' };

    jQuery.ajax({
      type: "POST",
      dataType: "html",
      url: url_month,
      crossDomain: true,
      data: form_data,
      success: function( default_month_msg ) {

        jQuery('#display-month').html(default_month_msg);

      } // end success

    }); // end ajax
    //return false;
  }

  function get_todays_events()
  {
    var url_todays_events = jQuery("#todays_events_url").attr("href");

    var form_data = { ajax : '1' };

    jQuery.ajax({
      type: "POST",
      dataType: "html",
      url: url_todays_events,
      crossDomain: true,
      data: form_data,
      success: function( default_month_msg ) {

        jQuery('#display_todays_events').html(default_month_msg);

      } // end success

    }); // end ajax
    //return false;
  }

  get_month();
  console.log("display calendar");

  get_todays_events();
  console.log("display today's events");

  jQuery(document).on('click', "a.view_events", function(e) {
    e.preventDefault();
    var date = jQuery(this).data('date');

    // change if URL changes
    var url_events = jQuery("#events_for_day_url").attr("href");

    var form_data = {
      year : jQuery(this).data('year'),
      month : jQuery(this).data('month'),
      day : jQuery(this).data('day'),
      date : jQuery(this).data('date'),
      ajax : '1'
    };

    jQuery.ajax({
      type: 'POST',
      dataType: 'html',
      url: url_events,
      data: form_data,
      success: function( msg ) {

        jQuery('#display-events').html(msg);
        jQuery('#display-event_detail').html('');
        jQuery('#display_todays_events').html('');

      } // end success

    }); // end ajax

    return false;

  }); // end on.click view-events

  jQuery(document).on('click', "a.view_event_details", function(e) {
    e.preventDefault();
    var url_event_detail = jQuery("#event_detail_url").attr("href");

    var form_data = {
      event_id : jQuery(this).data('event_id'),
      ajax : '1'
    };

    jQuery.ajax({
      type: 'POST',
      dataType: 'html',
      url: url_event_detail,
      data: form_data,
      success: function( msg ) {

        jQuery('#display-event_detail').html(msg);
        jQuery('#display-events').html('');
        jQuery('#display_todays_events').html('');

      } // end success

    }); // end ajax

    return false;

  }); // end on.click view_event_details

  jQuery(document).on('click', "a.month_link", function(e) {
    e.preventDefault();

    jQuery('#display-events').html('');

    var url_days_for_month = jQuery("#days_for_month_url").attr("href");

    var form_data = {
      month_url : jQuery(this).data('month_url'),
      ajax : '1'
    };

    jQuery.ajax({
      type: 'POST',
      dataType: 'html',
      url: url_days_for_month,
      data: form_data,
      success: function( msg ) {

        jQuery('#display-month').html(msg);
        jQuery('#display_todays_events').html('');

      } // end success

    }); // end ajax

    return false;

  }); // end on.click view-month

  jQuery(document).on('click', "a.view_subscriptions", function(e) {
    e.preventDefault();
    var url_subscription = jQuery("#subscriptions_url").attr("href");

    var form_data = {
      ajax : '1'
    };

    jQuery.ajax({
      type: 'POST',
      dataType: 'html',
      url: url_subscription,
      data: form_data,
      success: function( msg ) {

        jQuery('#display-subscriptions').html(msg);
        //jQuery('#display-subscriptions').toggle();

      } // end success

    }); // end ajax

    return false;

  }); // end on.click view-subscriptions

  jQuery(document).on('click', "#update_subscriptions", function(e) {
    e.preventDefault();
    var url_update_subscription = jQuery("#update_subscriptions_url").attr("href");

    var vals = []
    jQuery('input:checkbox[name="calendar[]"]').each(function() {
        if (this.checked) {
            vals.push(this.value);
        }
    });

    var form_data = {
      ajax : '1',
      calendar: vals,
    };

    jQuery.ajax({
      type: 'POST',
      dataType: 'html',
      url: url_update_subscription,
      data: form_data,
      success: function( msg ) {

        get_month();
        jQuery('#display-subscriptions-update').html(msg).fadeOut(6000);
        jQuery('#display-subscriptions').html('');
        jQuery('#display-events').html('');
        jQuery('#display_todays_events').html('');

      } // end success

    }); // end ajax

    return false;

  }); // end on.click view-subscriptions

}); // end document ready 
```

这是 get_todays_events() 函数成功返回的 html

```
<h3>Today's Events</h3>

  <p><a href="#" class="view_event_details" data-event_id="68">All About Heroin</a> - 12:30 pm</p>

  <p><a href="#" class="view_event_details" data-event_id="67">African Storyteller - Ekow King</a> - 12:30 pm</p>

  <p><a href="#" class="view_event_details" data-event_id="66">Men&rsquo;s Basketball vs. Columbia-Greene Community College</a> - 6:00 pm</p> 
```

更新：检查了 firebug 中的 net 选项卡并检查了 XHR，当在 uPortal 中使用时，它会触发两个 post 请求和两个 get 请求。两个 POST 请求都在重新调整 0 字节，但 GET 请求正在返回一些东西。我将它们更改为GETS，因为我并没有真正要求用户输入数据，而是单击一个已经包含数据的链接（即他们想要查看事件的日期），所以我将日期值附加到我的 URL正在传递给ajax get请求，然后每次都正确返回。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-04T11:40:38.000

尝试将 async=false 添加到 ajax 调用参数中（将此添加到所有 ajax 调用中）。

例如：

```
 jQuery.ajax({
  type: "POST",
  dataType: "html",
  url: url_todays_events,
  crossDomain: true,
  data: form_data,
  async:false,
  success: function( default_month_msg ) {

    jQuery('#display_todays_events').html(default_month_msg);

  } // end success

}); 
```

# java - 消息处理程序被下一条消息覆盖

> ID：14717502
> 
> 赞同：1
> 
> 时间：2013-02-05T21:43:36.867
> 
> 标签：java, android, handler

对编程并不陌生，但对 Java 和 Android 来说却相当陌生。应用程序是蓝牙 SPP 接收每秒一次的短数据包。有时，蓝牙会给我一部分信息，然后很快就给我剩余的信息。发生这种情况时，我的接收线程向我的解析器发送相同类型的消息，但内容不同。然而，解析器从第二条消息中接收到具有第一条消息的“长度”的“数据”。

这是我的代码，我想知道我应该做些什么来区分消息，或者我是否需要检查我的接收线程是否已处理消息并休眠几毫秒，然后再试一次。意见？对不起，我正在通过我看到的例子来学习，我相信有几种方法可以做我正在做的事情。

收件人：

```
protected void receive() {
    byte[] recvBuffer = new byte[128];
    while(inStream != null) {
        try {
            int bytesReceived = inStream.read(recvBuffer);
            System.out.println("BT-In: ");
            String outString = new String(recvBuffer, 0, bytesReceived);
            System.out.println(outString);
            processReceive.obtainMessage(NEW_DEVICE_DATA, bytesReceived, -1, recvBuffer)
                          .sendToTarget();
        }
        catch (IOException e){
            WarningBox("Warning", "Receive over Bluetooth did not work, check connection.");      
            break;
        }
    }
}; 
```

处理程序：

```
Handler processReceive = new Handler() {
@Override
    public void handleMessage(Message msg) {
        switch(msg.what) {
        default:
            break;
        case NEW_DEVICE_DATA:
            byte[] parseInfo = (byte[])msg.obj;
            String outString = new String(parseInfo, 0, msg.arg1);
            System.out.println("Parse-In: ");
            System.out.println(outString);
            //ParseReceivedData(parseInfo);
            break;
        }
    }
}; 
```

现在我没有解析数据，而是试图验证我是否通过蓝牙从远程设备获取了所有内容，并且我正在正确地将其发送到解析器，解析器最终将更新我的屏幕字段。

我的日志可能看起来像这样：

BT-In: ABCabc

解析：ABCabc

BT-输入：12

BT-In: 3456789

解析：34

解析：3456789

错误是我有两个彼此靠近的蓝牙接收，说整个字符串是“123456789”，但我把它分成两部分“12”和“3456789”，我把这两部分发送到我的解析器（主线程)，处理程序看到两条消息，但第一条消息在大小上被正确接受，但内容不正确。

# windows-phone-7 - 如何使用“POST”将文件（例如文本/xml）从 Windows Phone 上传到远程 php 服务器？

> ID：14717503
> 
> 赞同：0
> 
> 时间：2013-02-05T21:43:41.757
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone-8, windows-phone

[此](http://dl.dropbox.com/u/14021669/RestSharpFileUploadSample.zip)代码不起作用并返回“未找到”错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:20:44.690

[这个教程](http://www.dot4pro.com/posting-data-to-the-web-from-windows-phone-7.html)拯救了我的一天。希望也会为你做同样的事情。

# servicestack - ServiceStack.Text xml 序列化格式良好的输出

> ID：14717515
> 
> 赞同：2
> 
> 时间：2013-02-05T21:44:25.900
> 
> 标签：servicestack

ServiceStack.Text 是否可以缩进其 xml 输出，因此它不是一长行的 xml？我们想将输出写入一个易于阅读的文本文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-28T13:08:27.630

您是否使用任何类型的编码。因为默认情况下，序列化对象时不会发生任何缩进剥离。试试下面的代码。

你的 xml 类对象

```
 public class MyXMLClass
{
    [XmlElement]
    public string[] Property1 { get; set; }
    [XmlElement]
    public string[] Property2 { get; set; }
} 
```

序列化方法

```
static void TestXMLWithIndent()
    { 
        var x = new MyXMLClass()
        {
            Property1 = new string[] { "TestProp11", "TestProp12", "TestProp13" },
            Property2 = new string[] { "TestProp21", "TestProp22", "TestProp23" }
        };
        var filename = @"c:\temp\testxmlWithIndent.oxi";
        using (TextWriter textWriter = new StreamWriter(filename))
        {
            XmlSerializer serializer = new XmlSerializer(typeof(MyXMLClass));
            serializer.Serialize(textWriter, x);
            textWriter.Close();
        }
    } 
```

此代码产生正确的缩进。而下面的代码生成的 xml 文件没有您提到的缩进。请注意，当我使用 xmltextwriter 时，我必须使用编码。

```
 static void XmlWithNoIndent()
    {
        var x = new MyXMLClass()
        {
            Property1 = new string[] { "TestProp11", "TestProp12", "TestProp13" },
            Property2 = new string[] { "TestProp21", "TestProp22", "TestProp23" }
        };
        var filename = @"c:\temp\testxmlWithNoIndent.oxi"; 
        using (MemoryStream memoryStream = new MemoryStream())
        {
            using (var xmlTextWriter = new System.Xml.XmlTextWriter(memoryStream, Encoding.Unicode))
            {
                XmlSerializer xs = new XmlSerializer(typeof(MyXMLClass));
                xs.Serialize(xmlTextWriter, x);

                MemoryStream memoryBaseStream;
                memoryBaseStream = (MemoryStream)xmlTextWriter.BaseStream;
                UTF8Encoding encoding = new UTF8Encoding();
                File.WriteAllBytes(filename, memoryStream.ToArray());
                memoryBaseStream.Dispose();
                xmlTextWriter.Close();
                memoryStream.Close();
            }
        }
    } 
```

# php - PHP：停止类执行而不终止脚本（或包含）

> ID：14717519
> 
> 赞同：7
> 
> 时间：2013-02-05T21:44:31.863
> 
> 标签：php, class

在下面的类中，我需要 kill() 来结束类中发生的任何事情，并停止类中的所有进程，而不是脚本：

```
<?php
class email {
    //Expressions
    const exp_name      = "/^[A-Za-z .'-]+$/";
    const exp_email     = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
    const error         = "We are sorry, but there appears to be a problem with the form you submitted.<br/>";
    private $msg        = 'Thank you for subscribing';
    protected $status   = true;

    function __construct() {
        self::validate();
        echo '<br/>the CLASS continued</b><br/>';
    }

    private function validate() {
        //Empty fields
        foreach ($_REQUEST as $key => $value) {
            $val = str_replace( ' ', '', $value );
            if ( $val === '' ) {
                self::error( 'empty', $key );
                self::kill(); //If empty, this should end the loop and class
            } //if:empty
        } //foreach

        //Validate Name
        if( !preg_match(self::exp_name,$_POST['Name']) ) {
            self::error( 'name' );
            self::kill(); //kill

        //Validate e-Mail
        if( !preg_match(self::exp_email,$_POST['e-Mail']) ) {
            self::error( 'email' );
            self::kill(); //kill
        }
  }

    public function status() {
        return $this->status;
    }

    public function msg() {
        return $this->msg;
    }

    private function error( $type = null, $value = null ) {
        switch( $type ) {
            case 'empty':
            $this->msg = self::error . "<div class='error'><b>The following field is empty: </b>" . $value . "</div>";
            self::set( false );
            break;

            case 'name':
            $this->msg = self::error . "<div class='error'><b>The First Name you entered does not appear to be valid.</b></div>";
            self::set( false );
            break;

            case 'email':
            $this->msg = self::error . "<div class='error'><b>The e-Mail you entered does not appear to be valid.</b></div>";
            self::set( false );
            break;

            default:
            self::set( false );
            $this->msg = self::error;
        }
    return; //kill app
    }

    private function set( $boolean = false ) {
        $this->status = $boolean;
    }

    private function kill() {
        //die();
        //exit( $this );
        //exit();
        //return;
        //break;
    }
}

$email = new email();
echo $email->msg();
echo '<br/>';
echo '<br/>';
echo 'The script continued!!!';
?> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-05T23:46:54.637

正如上面在评论中回答的那样，尝试使用“try”和“catch”块。

更改“验证”方法

```
private function valdidate( $type = null, $value = null ) {
    // Anything that is going wrong:
    throw new Exception("Your error message");
} 
```

课外：

```
try {
      $mail = new email();
} catch (Exception $e) {
      echo $e->getMessage(); // Handle the message properly here.
} 
```

有关异常的更多信息，请参阅：

[http://php.net/manual/en/language.exceptions.php](http://php.net/manual/en/language.exceptions.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T16:08:11.923

而不是`self::kill();`简单地使用`return;`

如果您需要`kill`做其他事情，那么只需`return self::kill();`在需要调用它时使用并更改`kill`为：

```
private function kill() {
    doStuff();
    return;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T17:36:13.443

没有人阻止你只返回布尔`validate`方法，然后设置一个简单的 if/else 块来评估其结果。

```
private function validate() {
    //Empty fields
    foreach ($_REQUEST as $key => $value) {
        $val = str_replace( ' ', '', $value );
        if ( $val === '' ) {
            // You shouldn't call staticaly 
            // self::error( 'empty', $key );
            $this->error('empty', $key);
            // self::kill(); //If empty, this should end the loop and class
            return false;
        } //if:empty
    } //foreach

    //Validate Name
    if( !preg_match(self::exp_name,$_POST['Name']) ) {
        $this->error( 'name' );
        return false;
    }

    //Validate e-Mail
    if( !preg_match(self::exp_email,$_POST['e-Mail']) ) {
        $this->error( 'email' );
        return false;
    }

    return true;
} 
```

然后在构造函数中：

```
if ($this->validate()) {
    echo '<br/>the CLASS continued</b><br/>';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T17:28:51.057

您可以像这样以编程方式执行此操作：

```
class email {
    //Expressions
    public static $errorOccuredInCurrentRun = false;

    const exp_name = "/^[A-Za-z .'-]+$/";
    const exp_email = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
    const error = "We are sorry, but there appears to be a problem with the form you submitted.<br/>";

    private $msg = 'Thank you for subscribing';
    protected $status = true;

    public static function factory(){
        //du your validation
        self::$errorOccuredInCurrentRun = false;
        self::validate();
        if(!self::$errorOccuredInCurrentRun){
            return new Email();
        }else{
            return null;
        }
    }

    private function __construct() {
        echo '<br/>the CLASS continued</b><br/>';
    }

    private static function validate() {
        //Empty fields
        foreach ($_REQUEST as $key => $value) {
            if(self::$errorOccuredInCurrentRun){
                break;
            }
            $val = str_replace(' ', '', $value);
            if ($val === '') {
                self::error('empty', $key);
                self::kill(); //If empty, this should end the loop and class
            } //if:empty
        } //foreach
        //Validate Name
        if(self::$errorOccuredInCurrentRun){
            if (!preg_match(self::exp_name, $_POST['Name'])) {
                self::error('name');
                self::kill(); //kill
                //Validate e-Mail
                if(self::$errorOccuredInCurrentRun){
                    if (!preg_match(self::exp_email, $_POST['e-Mail'])) {
                        self::error('email');
                        self::kill(); //kill
                    }
                }
            }
        }
    }

    public function status() {
        return $this->status;
    }

    public function msg() {
        return $this->msg;
    }

    private function error($type = null, $value = null) {
        switch ($type) {
            case 'empty':
                $this->msg = self::error . "<div class='error'><b>The following field is empty: </b>" . $value . "</div>";
                self::set(false);
                break;

            case 'name':
                $this->msg = self::error . "<div class='error'><b>The First Name you entered does not appear to be valid.</b></div>";
                self::set(false);
                break;

            case 'email':
                $this->msg = self::error . "<div class='error'><b>The e-Mail you entered does not appear to be valid.</b></div>";
                self::set(false);
                break;

            default:
                self::set(false);
                $this->msg = self::error;
        }
        return; //kill app
    }

    private function set($boolean = false) {
        $this->status = $boolean;
    }

    private function kill() {
        self::$validationRunCompleted;
    }

} 
```

然后像这样使用它：

```
$email = email::factory();
if(is_null($email)){
    //something went wrong
}else{
    //validation was fine
} 
```

如果当前的“运行”没有任何错误，我只执行东西。并且只有在没有错误的情况下，您才能获得电子邮件对象本身，您可以继续并做您需要的事情

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T08:20:24.623

问题是课堂上没有“杀了我”的选项。PHP 使用[unset](http://www.php.net/manual/en/function.unset.php)方法来销毁一个不能从类中调用的变量。正如手册所述“自 PHP 5 以来，无法在对象方法中取消设置 $this。”，因此您无法杀死您的类。

话虽如此，那么您将如何处理它以确保在它不验证时不会发生任何事情？确保检查不应继续出错的类的每个方法中的状态。下面您会发现您的代码已更改以显示此过程。请务必阅读关于我为什么做某事的评论。

```
<?php
class email {
    //Expressions
    const exp_name      = "/^[A-Za-z .'-]+$/";
    const exp_email     = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
    const error         = "We are sorry, but there appears to be a problem with the form you submitted.<br/>";
    private $msg        = 'Thank you for subscribing';
    protected $status   = true;

    function __construct() {
        //first check if it validates.
        //if it doesnt, end the constructor so the "class continued" line won't show.
        if (!self::validate()) {
            return;
        }

        echo '<br/>the CLASS continued</b><br/>';
    }

    private function validate() {
        //have the validate method return true/false.
        //Now you can use the output of this method to stop the script if needed

        //Empty fields
        foreach ($_REQUEST as $key => $value) {
            $val = str_replace( ' ', '', $value );
            if ( $val === '' ) {
                self::error( 'empty', $key );
                return false; //just return false when it doesnt validate
            } //if:empty
        } //foreach

        //Validate Name
        if( !preg_match(self::exp_name,$_POST['Name']) ) {
            self::error( 'name' );
            return false; //just return false when it doesnt validate
        }

        //Validate e-Mail
        if( !preg_match(self::exp_email,$_POST['e-Mail']) ) {
            self::error( 'email' );
            return false; //just return false when it doesnt validate
        }

        //else return true
        return true;
    }

    public function status() {
        //always allow the script to return the status
        return $this->status;
    }

    public function msg() { 
        //always allow the script to return the error message
        return $this->msg;
    }

    //example function on how to make sure nothing happens on error
    public function send() {    
        //return false on error so the rest method is not executed
        if ($this->status!==true)
            return false;

        //else continue
        echo "I'm sending an email!";
        //mail(.....)
    }

    private function error( $type = null, $value = null ) {     
        //you set the status to false here, so you can use it to check if an error occured
        //since you always set it to false, remove it from the switch statement. 
        //This way there is less duplicate code and thus less chance for errors

        self::set( false );

        switch( $type ) {
            case 'empty':
                $this->msg = self::error . "<div class='error'><b>The following field is empty: </b>" . $value . "</div>";
                break;

            case 'name':
                $this->msg = self::error . "<div class='error'><b>The First Name you entered does not appear to be valid.</b></div>";
                break;

            case 'email':
                $this->msg = self::error . "<div class='error'><b>The e-Mail you entered does not appear to be valid.</b></div>";
                break;

            default:
                $this->msg = self::error;
        }

        return;
    }

    private function set( $boolean = false ) {
        //use a check to set the value to make sure its always a boolean
        //this way it will be false unless you actually set it to true.
        $this->status = ($boolean===true);
    }
}

$email = new email();

//now you can do a check for the message and only continue if there was no error
if ($email->status() !== false) {
    //Do whatever you want with the e-mail
    $email->send();
    echo 'An e-mail has been sent!';
} else {
    echo 'Something was wrong with the email ('.$email->msg().')';
}

//or another approach could be to directly send it and catch if there was an error
//make sure to check for false with === to be sure its realy a boolean. 
//If you would just check with == the method would also fail if the send() method would return 0 for instance
if ($email->send() === false) {
    echo 'Something was wrong with the email ('.$email->msg().')';
}

//but no matter what, the script will continue
echo '<br/>';
echo '<br/>';
echo 'And the script continued!!!';
?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T15:15:09.227

如果我理解正确，则`kill()`可以使用`return false`. 据我所知，return 会将您“抛出”到方法之外，并且执行不会受到任何影响。抱歉，如果我没有正确理解您的问题。

此致！

# vba - VBA 哈希字符串

> ID：14717526
> 
> 赞同：20
> 
> 时间：2013-02-05T21:44:59.933
> 
> 标签：vba, hash, excel-2003

如何使用 Excel VBA 获取长字符串的短哈希

**给出了什么**

*   输入字符串不超过 80 个字符
*   有效的输入字符是： [0..9] [A_Z] 。_ /
*   有效的输出字符为 [0..9] [A_Z] [a_z] *（可以使用小写和大写）*
*   输出哈希不应超过 ~12 个字符（越短越好）
*   根本不需要唯一，因为这会导致哈希过长

**到目前为止我做了什么**

我认为[这个 SO 答案](https://stackoverflow.com/a/7360012/935614)是一个好的开始，因为它会生成一个 4 位十六进制代码（CRC16）。

但是4位数太少了。在我对 400 个字符串的测试中，20% 的人在其他地方得到了重复。
产生碰撞的机会太高。

```
Sub tester()
    For i = 2 To 433
        Cells(i, 2) = CRC16(Cells(i, 1))
    Next i
End Sub

Function CRC16(txt As String)
Dim x As Long
Dim mask, i, j, nC, Crc As Integer
Dim c As String

Crc = &HFFFF

For nC = 1 To Len(txt)
    j = Val("&H" + Mid(txt, nC, 2))
    Crc = Crc Xor j
    For j = 1 To 8
        mask = 0
        If Crc / 2 <> Int(Crc / 2) Then mask = &HA001
        Crc = Int(Crc / 2) And &H7FFF: Crc = Crc Xor mask
    Next j
Next nC

CRC16 = Hex$(Crc)
End Function 
```

**如何重现**

您可以从 pastebin 复制这 400 个[测试字符串](http://pastebin.com/raw.php?i=wY3E9pTg)。
将它们粘贴到新 Excel 工作簿中的 A 列并执行上面的代码。

**问：**如何获得足够短（12 个字符）和足够长的字符串散列，以获取一小部分重复项。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-02-07T11:18:49.327

也许其他人会发现这很有用。

我收集了一些不同的函数来在 VBA 中生成一个简短的字符串散列。
我不相信代码，并且引用了所有来源。

![在此处输入图像描述](../Images/5c112aaf63804c7f8a9fe182edcb7771.png)

1.  [CRC16](https://stackoverflow.com/a/7360012/935614)
    *   功能：`=CRC16HASH(A1)`使用此[代码](https://gist.github.com/anonymous/d24a7a03f7f2a771c0f2)
    *   hash 是一个 4 个字符长的 HEX 字符串
    *   19 行代码
    *   4 位长哈希 = 6895 行中的 624 次冲突 = 9% 的冲突率
2.  [CRC16 数字](https://stackoverflow.com/a/7359753/935614)
    *   功能：`=CRC16NUMERIC(A1)`使用此[代码](https://gist.github.com/anonymous/52542c13034fe308ac2a)
    *   哈希是一个 5 位长的数字
    *   92 行代码
    *   5 位长哈希 = 6895 行中的 616 次冲突 = 8.9 % 冲突率
3.  [CRC16 两次](https://stackoverflow.com/a/14735118/935614)
    *   功能：`=CRC16TWICE(A1)`使用此[代码](https://gist.github.com/anonymous/c1206b3e17c6b01a7838)
    *   hash 是一个 8 个字符长的 HEX 字符串
    *   哈希可以扩展到 12/16/20 等字符，以进一步降低冲突率
    *   39 行代码
    *   8 位长哈希 = 6895 行中的 18 次冲突 = 0.23 % 冲突率
4.  [SHA1](https://stackoverflow.com/a/482150/935614)
    *   功能：`=SHA1TRUNC(A1)`使用此[代码](https://gist.github.com/anonymous/573a875dac68a4af560d)
    *   hash 是一个 40 个字符长的 HEX 字符串
    *   142 行代码
    *   可以截断
    *   4 位哈希 = 6895 行中的 726 次冲突 = 10.5 % 的冲突率
    *   5 位哈希 = 6895 行中的 51 次冲突 = 0.73 % 冲突率
    *   6 位哈希 = 6895 行中 0 次冲突 = 0 % 冲突率
5.  [SHA1 + Base64](https://stackoverflow.com/a/10068932/935614)
    *   功能：`=BASE64SHA1(A1)`使用此[代码](https://gist.github.com/anonymous/a773913ce303c713758d)
    *   hash 是一个 28 个字符长的 unicode 字符串（区分大小写 + 特殊字符）
    *   41 行代码
    *   需要 .NET，因为它使用库“Microsoft MSXML”
    *   可以截断
    *   4 位哈希 = 6895 行中的 36 次冲突 = 0.5 % 冲突率
    *   5 位哈希 = 6895 行中的 0 次冲突 = 0 % 冲突率

[这](http://ge.tt/9q1jfos2)是我的测试工作簿，其中包含所有示例函数和大量测试字符串。

随意添加自己的功能。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-02-06T17:25:41.983

将你的字符串分成三个较短的字符串（如果不能被三整除，最后一个将比其他两个长）。在每个上运行你的“短”算法，并连接结果。

我可以编写代码，但根据问题的质量，我认为您可以从这里获取它！

编辑：事实证明，这个建议是不够​​的。您的原始 CRC16 代码存在严重缺陷 - 即以下行：

```
j = Val("&H" + Mid(txt, nC, 2)) 
```

这仅处理可以解释为十六进制值的文本：小写和大写字母相同，字母表中 F 之后的任何内容都被忽略（据我所知）。任何好的东西都能出来是一个奇迹。如果您将该行替换为

```
j = asc(mid(txt, nC, 1)) 
```

事情变得更好了——每个 ASCII 码至少从生命开始就是它自己的价值。

将此更改与我之前提出的建议相结合，您将获得以下代码：

```
Function hash12(s As String)
' create a 12 character hash from string s

Dim l As Integer, l3 As Integer
Dim s1 As String, s2 As String, s3 As String

l = Len(s)
l3 = Int(l / 3)
s1 = Mid(s, 1, l3)      ' first part
s2 = Mid(s, l3 + 1, l3) ' middle part
s3 = Mid(s, 2 * l3 + 1) ' the rest of the string...

hash12 = hash4(s1) + hash4(s2) + hash4(s3)

End Function

Function hash4(txt)
' copied from the example
Dim x As Long
Dim mask, i, j, nC, crc As Integer
Dim c As String

crc = &HFFFF

For nC = 1 To Len(txt)
    j = Asc(Mid(txt, nC)) ' <<<<<<< new line of code - makes all the difference
    ' instead of j = Val("&H" + Mid(txt, nC, 2))
    crc = crc Xor j
    For j = 1 To 8
        mask = 0
        If crc / 2 <> Int(crc / 2) Then mask = &HA001
        crc = Int(crc / 2) And &H7FFF: crc = crc Xor mask
    Next j
Next nC

c = Hex$(crc)

' <<<<< new section: make sure returned string is always 4 characters long >>>>>
' pad to always have length 4:
While Len(c) < 4
  c = "0" & c
Wend

hash4 = c

End Function 
```

您可以将此代码放在您的电子表格中`=hash12("A2")`。为了好玩，您还可以使用“新的、改进的”hash4 算法，看看它们是如何比较的。我创建了一个数据透视表来计算冲突 -`hash12`算法没有，只有 3 个`hash4`. 我相信你可以弄清楚如何创建`hash8`, ... 。您的问题中的“不需要独一无二”表明您可能`hash4`只需要“改进”。

原则上，一个四字符的十六进制应该有 64k 的唯一值——所以两个随机字符串具有相同散列的机会是 64k 中的 1。当您有 400 个字符串时，有 400 x 399 / 2 个“可能的碰撞对”~ 80k 机会（假设您有高度随机的字符串）。因此，在样本数据集中观察三个碰撞并不是一个不合理的分数。随着字符串数量 N 的增加，发生冲突的概率为 N 的平方。使用 hash12 中额外的 32 位信息，您希望在 N > 20 M 左右时看到冲突（handwaving，in-my-头数学）。

很明显，你可以让 hash12 代码更紧凑一点——而且应该很容易看出如何将它扩展到任意长度。

哦，还有最后一件事。如果您启用了 RC 寻址，使用`=CRC16("string")`电子表格公式会产生难以跟踪的`#REF`错误......这就是我重命名它的原因`hash4`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-02-06T09:04:05.610

32 位哈希函数，用于具有低冲突级别的字符串：

```
Public Function StrHash(text As String) As Long
    Dim i As Long
    StrHash = &H65D5BAAA

    For i = 1 To Len(text)
        StrHash = ((StrHash + AscW(Mid$(text, i, 1))) Mod 69208103) * 31&
    Next
End Function 
```

或作为 64 位哈希函数：

```
Public Function StrHash64(text As String) As String
    Dim i&, h1&, h2&, c&
    h1 = &H65D5BAAA
    h2 = &H2454A5ED

    For i = 1 To Len(text)
        c = AscW(Mid$(text, i, 1))
        h1 = ((h1 + c) Mod 69208103) * 31&
        h2 = ((h2 + c) Mod 65009701) * 33&
    Next

    StrHash64 = Right("00000000" & Hex(h1), 8) & Right("00000000" & Hex(h2), 8)
End Function 
```

基于[FNV哈希算法](https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-13T14:49:54.487

虽然下面不是哈希函数，但我已将其用作生成数字 id 的快速方法，该方法在小列表中具有低冲突率（小到足以通过检查进行验证）。

**工作原理**：A 列保存第 2 行以后的字符串。在第 1 行中，A1 和 B1 在字符串中间保持任意开始和结束位置。该公式使用字符串的第一个字母和取自字符串中间的固定字母，并使用 LEN() 作为“扇形函数”来减少冲突的机会。

```
 =CODE(A2)*LEN(A2) + CODE(MID(A2,$A$1,$B$1))*LEN(MID(A2,$A$1,$B$1)) 
```

如果从具有固定宽度字段的数据库表中提取字符串，您可能需要修剪长度：

```
 =CODE(TRIM(C8))*LEN(TRIM(C8))
       +CODE(MID(TRIM(C8),$A$1,1))*LEN(MID(TRIM(C8),$A$1,$B$1)) 
```

# c++ - 如何在 C++ 中为 7zip 命令行输出创建准确的输出缓冲区？

> ID：14717527
> 
> 赞同：0
> 
> 时间：2013-02-05T21:45:04.287
> 
> 标签：c++, visual-c++, 7zip

我最初使用 GetFileSize()，然后发现这不是正确的方法。请给我一些建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:24:20.210

我假设您所说的“输出缓冲区”是一块内存，用于从 7z 文件解压缩中接收未压缩文件。不过，您对此并不清楚。

如果可以的话，我鼓励您尝试流式传输输出，而不是一次全部获取。这样你就不必知道尺寸是多少。标准的 7-Zip LZMA SDK 提供了一个与 zlib 兼容的 API，这使得流压缩或解压缩相对容易。

如果由于某种原因这是不可能的，您将不得不分两个阶段进行：我相信 7z 存档格式存储原始文件大小以及压缩大小，因此要求文件的目录条目问题应该返回原始大小，您可以将其分配为缓冲区。

如果您真的是从某个来源进行管道传输，那么您只是看到通过 7z 压缩或解压缩操作传递的字节流，则可能是没有可用的大小信息......您只需要解决这个问题. 但是，您确实说过您尝试过 GetFileSize() ，这表明存在某种文件，因此希望这不是您面临的问题。

HtH

露丝

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:32:40.990

当你启动一个进程时，你会得到一个输出流（假设你已经重定向了它的标准输出）。处理流的正确方法是逐块读取它，多次读取，直到到达流的末尾。示例代码在[MSDN 页面上](http://msdn.microsoft.com/en-us/library/ms682499%28VS.85%29.aspx)——查找函数 ReadFromPipe(void)。这是代码的副本：

```
void ReadFromPipe(void) 

// Read output from the child process's pipe for STDOUT
// and write to the parent process's pipe for STDOUT. 
// Stop when there is no more data. 
{ 
   DWORD dwRead, dwWritten; 
   CHAR chBuf[BUFSIZE]; 
   BOOL bSuccess = FALSE;
   HANDLE hParentStdOut = GetStdHandle(STD_OUTPUT_HANDLE);

   for (;;) 
   { 
      bSuccess = ReadFile( g_hChildStd_OUT_Rd, chBuf, BUFSIZE, &dwRead, NULL);
      if( ! bSuccess || dwRead == 0 ) break; 

      // ... -> do your processing here.
   } 
} 
```

如果确实需要将整个流聚合到一个缓冲区中，则可以使用动态分配的容器，例如 std::vector、std::string、std::list 等。

# c++ - 这段代码安全吗？投射一个 std::vector 到 std::vector

> ID：14717528
> 
> 赞同：2
> 
> 时间：2013-02-05T21:45:09.013
> 
> 标签：c++, inheritance, casting

基本上我有一个`class A`和一个`class B : public A`。

我想投一个`std::shared_ptr<std::vector<A*>`到一个`std::shared_ptr<std::vector<B*>`

问题是`std::vector<B>`不继承自`std::vector<A>`，`smart_ptr`也不是。所以我做了一个**可怕的演员**：

```
 std::shared_ptr<VectorA> vector_a = * ((std::shared_ptr<VectorA>*)&vector_b); 
```

代码在那里编译并运行，但它安全吗？ [http://liveworkspace.org/code/3dQTz1$0](http://liveworkspace.org/code/3dQTz1%240)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:51:35.543

这是一个可怕的解决方案。当您将一种类型的对象向量转换为另一种类型时，您可能会遇到各种不正确/未定义的行为。

您应该从一开始就使用 vector of`std::shared_ptr<A>`并用指向那里类型对象的指针初始化它们`B`。

如果不可能，您可以创建一个新的矢量持有`std::weak_ptr<A>`以避免两次管理这些对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T21:51:46.723

不要那样做。

考虑 (pointers to)`B`的向量不是(pointers to) 的向量`A`，或者更准确地说，不是 (pointers to) 向量的普遍有效替代`A`；因此，您不能执行这样的转换是有充分理由的。

虽然你在一个向量中拥有的`B`确实是一组对象，它们是（也是（的实例）`A`，请考虑以下算法：

```
void f(vector<A>& v)
{
    A a;
    v.push_back(a);
} 
```

现在假设您`f()`使用 的向量调用`B`。那将是尝试将一个类的实例添加`B`到一个应该只包含 type 元素的集合中`B`。

这里的解决方案是使只接受 a 的代码`vector<A>`足够灵活，也可以在`vector<B>`. 换句话说，您需要将其设为模板。例如，您的模板只能接受从`A`. 使用一些 SFINAE 技术和类型特征（例如`std::is_base_of`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T21:52:01.663

严格来说，取消引用操作应该成功。两个向量都是指针容器，因此将一个向量转换为另一个，虽然对于生产代码是不可接受的，但仍将使用相同的尺寸和对齐方式。

尽管 C++ 提供了丰富的抽象来避免这些恶作剧，但最好将派生对象的向量填充为指向基类的指针。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-05T21:55:51.747

您仍然可以转换元素：

```
A* a = vector_b->at (42); 
```

给你你想要的。

现在，如果您编写了`shared_ptr<vector<A*>>`作为参数的函数，那么您有多种解决方案可以让您摆脱这种情况：

*   使用`shared_ptr<A*[]>`而不是`shared_ptr<vector<A*>>`（它可以按您的意愿工作）
*   作为`A**`参数（并使用`vector_b->data ()`）：它不会将您与共享指针联系起来。
*   更好：将取消引用的迭代器作为 [smart] 指针`A`（回想一下`operator->`链）
*   使用`std::vector<std::shared_ptr<A>>`（浪费资源）

# sql - 如何在 Oracle 11G 中的字符串“请帮助我”中的“我”之后直接获取字符串

> ID：14717530
> 
> 赞同：0
> 
> 时间：2013-02-05T21:45:22.993
> 
> 标签：sql, oracle, oracle11g

我正在使用 Oracle 11G，需要帮助才能在字符串关键字之后直接获取字符串。在这种情况下，我有一个名为 STRING_HELP 的表，其中包含一个名为 STRING_NAME 的列，其中包含以下行：

STRING_NAME“请帮帮我”；'请你帮助我，我将不胜感激';

因此，我只想从这两行中获取字符串“请”和“我”，因为那是在两行中直接跟在“我”之后的内容。

我一直在尝试使用 REGEXP_SUBSTRING、REGEXP_REPLACE 进行实验，但我无法直接在单词 me 之后获取字符串。我想要两个不同的答案。如果我知道所有内容都是空格分隔的，如何直接在我之后获取字符串？我将不胜感激任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:00:04.587

您可以使用`SUBSTR`、`INSTR`和`COALESCE`，但可能有更好的解决方案：

```
SELECT  COALESCE( SUBSTR(str, 0, INSTR(str, ' ')) , str) newStr
FROM (
  SELECT LTrim(Substr(STRING_NAME,INSTR(STRING_NAME,'me')+LENGTH('me'))) str
  FROM STRING_HELP 
  ) t; 
```

[http://sqlfiddle.com/#!4/0cf12/3](http://sqlfiddle.com/#!4/0cf12/3)

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:11:46.103

你可以使用：

```
select regexp_replace(STRING_NAME, '^.*? me ','') from STRING_HELP 
```

# c++ - 分配指针？

> ID：14717537
> 
> 赞同：1
> 
> 时间：2013-02-05T21:45:42.417
> 
> 标签：c++

假设我有一个队列数据结构。

```
Queue() 
```

以下是否会造成任何内存泄漏：

```
Queue* test = new Queue();
Queue* test1 = test;
delete test1; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:46:13.727

不，但你会留下 2 个悬空指针 -`test`和`test1`. 在它们指向有意义的东西之前，您不能再使用它们。

# ios6 - AQGridView 单元格中的自定义动画会立即发生吗？

> ID：14717545
> 
> 赞同：0
> 
> 时间：2013-02-05T21:46:04.180
> 
> 标签：ios6, core-animation, aqgridview

所以，我正在使用 AQGridView。我们有自定义单元格，其中包含图像。现在我们希望图像在点击时反弹。我尝试对图像的框架进行操作，但这不起作用所以现在我尝试在主视图中创建一个 UIImageView 并为其提供路径动画，但最终发生的是视图只出现在左上角有问题的细胞的绳索。这是相关的代码。

```
-(void)bounce:(CoverGridCell*)v {
    UIView * w = [v.subviews objectAtIndex:0];
    UIImageView * u = [[UIImageView alloc] initWithImage:v.image];
    u.frame = [self.view convertRect:[[w.subviews objectAtIndex:0] frame] fromView:w];
    double __block y = u.frame.origin.y;
    double __block x = u.frame.origin.x;
    [self.view addSubview:u];
    CGMutablePathRef cgmp = CGPathCreateMutable();for (int j= 10; j > 0;j--) {
        CGAffineTransform t1 = CGAffineTransformMakeTranslation(0, - j*j);
        CGAffineTransform t2 = CGAffineTransformInvert(t1);
        CGPathMoveToPoint(cgmp,&t1, x, y - j * j);
        CGPathMoveToPoint(cgmp,&t2, x, y);
    }
    CGPathRef cgp = CGPathCreateCopy(cgmp);

    CGPathRelease(cgmp);

    CAKeyframeAnimation *anim = [CAKeyframeAnimation animationWithKeyPath: @"position"];
    anim.duration = 5.0;
    anim.delegate = self;
    anim.path = cgp;
    anim.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn];
    [u.layer addAnimation:anim forKey:@"DoesThisMatter"];
    [u.layer setPosition:CGPointMake(x,y)];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:00:13.940

这是一个线程问题，IIRC。单击单元格时发生的事情是冻结 'Pad 直到动画结束。

# php - 适用于 Visual Studio 的 PHP 工具，是否是真正的替代品？

> ID：14717546
> 
> 赞同：6
> 
> 时间：2013-02-05T21:46:05.040
> 
> 标签：php, php-ide

我是一名来回混合语言的长期开发人员。在过去的几年里，我主要使用 .NET 和 Visual Studio。每当我用 PHP 编写东西时，我都倾向于使用 NetBeans IDE（在我的 Mac 上），并且一直对一般功能、IntelliSense 和包含的 PHPDoc 功能感到满意。

我在那儿。我真的很喜欢 VS，但现在看来我要再次进行一些 php 编码了。

在构建类似企业的框架时，适用于 Visual Studio 的 PHP 工具是一个真正的选择吗？

如果不是，我应该继续使用 NetBeans 还是主要表明我是一个脾气暴躁的老屁，害怕一切新事物？

我已经阅读了一些关于 Jetbrains php ide 的意见，但喜好参差不齐，也有很多人似乎喜欢 zend，但我认为最好使用 zend 框架，这在我创建后有点问题我自己的框架。

如果 IDE 可以运行 PHP 5.3 并使用内置的网络服务器进行实时调试，那就太好了。或者在这方面我应该注意什么其他策略？

*   [适用于 Visual Studio 的 PHP 工具](http://visualstudiogallery.msdn.microsoft.com/6eb51f05-ef01-4513-ac83-4c5f50c95fb5)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-05-08T15:57:22.867

I use PHP Tools for Visual Studio and I really like it. Mainly because I am primarily an asp.net developer and I feel most comfortable in Visual Studio. It's great that it I can use TFS within Visual Studio to manage my php files. It's also nice that some of the generic CodeRush features work (such as dropping markers). I've found their support to be good. It costs money, but it's reasonable.

To get server side debugging working, follow the steps here: [http://xdebug.org/docs/install](http://xdebug.org/docs/install) .
In Visual Studio, you can get to the PHP tools options from the Tools menu. Tools-Options-PHP Tools.

One thing to be aware of is which php.ini file is being used: IIS uses this php.ini:
%ProgramFiles%\PHP\v5.3\php.ini
This php.ini gets used when you debug from Visual Studio:
%ProgramFiles%\IIS Express\PHP\v5.3\php.ini

I'll mention one more thing since it was a pain to figure out; I have to debug code in the WordPress functions.php file. To get debugging working on functions.php, I first start the VS debugger (by clicking Debug-Start Debugging) on a small test file like this:

```
<?php
   phpinfo() ;
?> 
```

With the debugger running, breakpoints will then be hit in functions.php. Be aware that debugging WordPress like this will only work in your default browser.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T22:04:27.070

将[VS PHP](http://www.jcxsoftware.com/jcx/vsphp/home)作为一种选择。我喜欢它，但它有点贵。

目前我正在使用JetBrains 的[PHP Storm](http://www.jetbrains.com/phpstorm/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:57:54.040

我在 Mac 上使用 AptanaStudio。它支持远程构建和源代码控制集成。它是我用过的最好的重量级 PHP IDE。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-03T01:41:09.100

我还没有决定我将使用什么工具。但是在这里阅读有关 PHP 工具的赞誉的人应该意识到，其中两条热情洋溢的评论来自销售该产品的公司的联合创始人——他没有提到这一点。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2022-01-31T20:49:21.437

我指出[PeachPie Visual Studio Extension](https://marketplace.visualstudio.com/items?itemName=iolevel.peachpie-vs)。

PeachPie 是 .NET 和 .NET Core 的 PHP 语言编译器。该扩展旨在简化在 Microsoft 的 Visual Studio IDE 中使用 PeachPie 编译器。

注意：此扩展是一个预览版，因为 PeachPie 仍在进行中。

# ios - iPad 应用程序在 iPad 3 上崩溃，在 iPad 2 上运行良好，内存不足警告

> ID：14717555
> 
> 赞同：0
> 
> 时间：2013-02-05T21:46:21.413
> 
> 标签：ios, crash

我有一个在 iPad 2 上运行良好的 iPad 应用程序，但是在尝试在 iPad 3 上部署时它崩溃了，并且我在 XCode 控制台窗口中收到此消息：收到内存警告。

这是硬件问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:48:48.687

您需要向我们提供有关崩溃的更多详细信息，内存警告只会在您的设备内存不足时发送。这不是崩溃的原因。

我会看看专门针对内存分配/泄漏的工具。

# javascript - Javascript - 数组循环的问题

> ID：14717558
> 
> 赞同：0
> 
> 时间：2013-02-05T21:46:25.020
> 
> 标签：javascript, arrays, loops, iframe

我有以下代码，当正常工作时应该在 iframe 中打开链接 1，等待 3 秒，然后在 iframe 中打开链接 2，等待 3 秒，等等。

目前它直接跳到数组中的最后一个值（最后一个链接）。

有 JS 高手吗？

```
 <html>
 <head></head>
 <body>

 <a href="http://www.google.com">Google</a><br />
 <a href="http://www.thinkgeek.com">ThinkGeek</a><br />
 <a href="http://www.themetapicture.com">The Meta Picture</a>

 <iframe src="http://www.google.com" id="myid" name="main" width="1024" height="768">
 </iframe>

 <script>
 function getLinksArray() {
     for (var i = 0; i < document.links.length; i++) {
         var linx = document.links[i].href;

         // create a closure for each loop iteration
         (function(linx) {
           setTimeout(function() {
             openLinks(linx);
           }, 3000);
         }(linx));

     }
 }

 function openLinks(link) {
 document.getElementById("myid").src = link;
 }

 window.onload = getLinksArray();
 </script>
 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:49:29.333

您可能希望`3000 * i`延迟，否则所有在 3000 毫秒（3 秒）后执行。并且由于它们是连续执行的，因此最后一个是引起注意的。

```
// ...
setTimeout(function(){
  // ...
}, 3000 * i);
// ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:56:45.420

您可能只想让迭代本身定时：

```
function loadLink(i) {
    document.getElementById("myid").src = document.links[i].href;
    if (i < document.links.length) {
        window.setTimeout(function() { loadLink(i+1) }, 3000);
    }
}

window.onload = loadLink(0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:08:37.517

我很确定这样的事情应该可以解决问题，而不会造成越来越长的延迟。虽然两者都没有进行性能测试，所以不能说哪个是最好的 - 只是想确保你知道另一种选择。

```
var linx = document.links;
(function loadLink(i) {          
    setTimeout(function () {   
        document.getElementById("myid").src = linx[i].href;
        if(linx[++i])
        {
            loadLink(i);
        }
    }, 3000)
})(0); 
```

# algorithm - 基数排序如何工作？

> ID：14717560
> 
> 赞同：40
> 
> 时间：2013-02-05T21:46:31.963
> 
> 标签：algorithm, sorting, radix-sort

我不知道为什么这对我来说很难缠住我的头。我浏览了 wiki 页面和伪代码（以及实际代码），试图了解基数排序算法是如何工作的（关于存储桶）。

我在这里寻找错误的东西吗？我应该研究桶排序吗？有人可以给我一个简化版的它是如何工作的吗？作为参考，这是一个*据称*执行基数排序的代码块：

```
// Sort 'size' number of integers starting at 'input' according to the 'digit'th digit
// For the parameter 'digit', 0 denotes the least significant digit and increases as significance does
void radixSort(int* input, int size, int digit)
{
    if (size == 0)
        return;

    int[10] buckets;    // assuming decimal numbers

    // Sort the array in place while keeping track of bucket starting indices.
    // If bucket[i] is meant to be empty (no numbers with i at the specified digit),
    // then let bucket[i+1] = bucket[i]

    for (int i = 0; i < 10; ++i)
    {
        radixSort(input + buckets[i], buckets[i+1] - buckets[i], digit+1);
    }
} 
```

我还研究了非递归解决方案：

```
void radixsort(int *a, int arraySize)
{
    int i, bucket[sortsize], maxVal = 0, digitPosition =1 ;
    for(i = 0; i < arraySize; i++) {
        if(a[i] > maxVal) maxVal = a[i];
    }

    int pass = 1; 
    while(maxVal/digitPosition > 0) {
        // reset counter 
        int digitCount[10] = {0};

        // count pos-th digits (keys) 
        for(i = 0; i < arraySize; i++)
            digitCount[a[i]/digitPosition%10]++;

        // accumulated count 
        for(i = 1; i < 10; i++)
            digitCount[i] += digitCount[i-1];

        // To keep the order, start from back side
        for(i = arraySize - 1; i >= 0; i--)
            bucket[--digitCount[a[i]/digitPosition%10]] = a[i];

        for(i = 0; i < arraySize; i++)
            a[i] = bucket[i];

        cout << "pass #" << pass++ << ": ";
        digitPosition *= 10;
    } 

} 
```

具体来说，这条线给我带来了麻烦。我试过用笔和纸走过它，但我仍然不知道这是在做什么：

```
 // To keep the order, start from back side
        for(i = arraySize - 1; i >= 0; i--)
            bucket[--digitCount[a[i]/digitPosition%10]] = a[i]; 
```

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2013-02-06T02:56:19.320

在数学中，基数表示基数，十进制以 10 为基数。想象一下，您有一些数字，其中一些数字超过一位，例如

```
5, 213, 55, 21, 2334, 31, 20, 430 
```

为简单起见，假设您想使用十进制基数 (=10) 进行排序。然后，您首先将数字按单位分开，然后再将它们放在一起；接下来，您将数字分开十位，然后再次将它们放在一起；然后数百个等等，直到所有数字都被排序。每次循环时，只需从左到右阅读列表。你也可以想象你正在将数字分成桶。这是一个使用的插图`5, 213, 55, 21, 2334, 31, 20, 430`

按单位分开：

*   零：20、430

*   个数：21、31

*   双打：

*   三分球：213

*   四人组：2334

*   五人：5、55

    重合：20、430、21、31、213、2334、5、55

要将它们重新组合在一起，首先读取`zeroes`存储桶，然后读取存储`ones`桶，然后以此类推，直到您读取`nines`存储桶。

以十位分隔：

*   零：05

*   个数：213

*   二：20、21

*   三分球：430、31、2334、

*   四人组：

*   五人组：55

    重合：5、213、20、21、430、31、2334、55

相隔数百：

*   零：005、020、021、031、055

*   那些：

*   双打：213

*   三分球：2334

*   四人组：430

*   五分之一：

    重合：5、20、21、31、55、213、2334、430

以千分隔：

*   零：0005、0020、0021、0031、0055、0213、0430

*   那些：

*   双打：2334

*   三分球：

*   四人组：

*   五分之一：

    重合：5、20、21、31、55、213、430、2334

你现在完成了。[我在Java](http://www.geekviewpoint.com/java/sorting/radixsort)和[python](http://www.geekviewpoint.com/python/sorting/radixsort)的 Geekviewpoint 上看到了一个很好的代码

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-13T10:04:39.860

这是快速排序的基本流程。

**对于第一遍：**我们使用计数排序根据最低有效位（1 位）对数组进行排序。请注意，435 低于 835，因为 435 在原始列表中出现在 835 之下。

**对于第二遍：**我们使用计数排序根据下一个数字（10 位）对数组进行排序。请注意，这里的 608 低于 704，因为 608 在上一个列表中出现在 704 之下，对于 (835, 435) 和 (751, 453) 也是如此。

**对于第三遍：**我们使用计数排序根据最高有效位（100 位）对数组进行排序。请注意，这里的 435 低于 453，因为 435 在上一个列表中出现在 453 以下，对于 (608, 690) 和 (704, 751) 也是如此。

[![](../Images/3b209fbd6c1e56191c4133aa59f39c18.png)](https://i.stack.imgur.com/nm9Xg.png)

更多细节[可以参考codingeek上的这篇博客，有清晰的认识](http://www.codingeek.com/algorithms/radix-sort-explanation-pseudocode-and-implementation/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T21:54:25.250

想想一副纸牌。你首先把它按花色分成四堆。然后你把这四堆放在一起，现在根据排名分成 13 堆。把它们放在一起，你现在就有了一个分类好的牌组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-30T13:58:51.083

可能是我的代码可以帮助你:)

这是python的基数排序代码：

```
import random,time

from random import randint

A=[random.randint(1,1212) for i in range(23)]

length = len(str(max(A)))

print(length) 

rang = 10

print(A)

start=time.time()

for i in range(length):

B = [[] for k in range(rang)]

for x in A:

    figure =x // (10**i) % 10

    B[figure].append(x)

A = []

for k in range(rang):

    A+=B[k]

end=time.time()

print(end-start)

print(A) 
```

# vim - Vimscript：如何获取当前文件类型作为变量

> ID：14717571
> 
> 赞同：22
> 
> 时间：2013-02-05T21:47:19.693
> 
> 标签：vim

我想将当前文件类型作为 vimscript 中的变量。

我正在制作一个获取当前文件类型并编辑相应文件类型的另一个文件的函数。

例如：

*   编辑“foo/bar.txt”，想打开“tmp/other.txt”
*   编辑“foo/bar.cpp”，想要打开“tmp/other.cpp”

等我知道`:set ft?`在 vim 中显示文件类型，但我不确定如何捕获它，然后使用它作为新文件字符串的一部分打开另一个文件。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-05T22:08:21.407

您可以通过在设置前加上 & 号来访问设置的值。要将文件类型分配给变量，以下是等效的：

```
let my_filetype = &filetype
let my_filetype = &ft 
```

因此，对于您的示例，假设当前缓冲区的文件类型已设置，您可以执行类似的操作

```
execute 'edit tmp/other.' . &filetype 
```

请注意，您需要`execute`表达式以便在连接字符串之前扩展变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-30T22:48:01.773

文件类型和文件后缀不一定是一回事。例如，如果您正在编辑 .txt 文件，让 zft = &ft 将 zft 设置为“文本”。let zfs = fnamemodify(bufname("%"), ":e") 将 zfs 设置为 "txt"。

# java - Spring 3 MVC - 浏览器认为我下载的是 .htm 文件

> ID：14717572
> 
> 赞同：0
> 
> 时间：2013-02-05T21:47:22.177
> 
> 标签：java, spring-mvc, download, spring-3

我在 Spring 3 框架 webapp 中实现了一个下载控制器，它应该被调用以在调用时启动一个打开/保存对话框。

它确实启动了打开/保存对话框并且保存工作正常。但是，当我单击“打开”时，它会在我的文件名后附加一个“.htm”并打开它全部错误。为什么？

控制器：

```
@RequestMapping("download/downloadFile")
    @ResponseBody
    public byte[] downloadFile(@RequestParam String fileID, HttpServletResponse response) {

        response.setContentType("application/octet-stream");
        File file = getFileByID(fileID);                       

        byte[] bytes = FileCopyUtils.copyToByteArray(file);

        response.setHeader("Content-Disposition", "attachment; filename=\"" + file.getName() + "\"");     
        response.setContentLength(bytes.length);

        return bytes;
    } 
```

当我看到响应标头时，我看到内容类型是 text/html，就像它忽略了我将其设置为 application/octet-stream！

```
Cache-Control   no-cache, no-store
Connection  close
Content-Disposition attachment; filename="test.txt"
Content-Length  22071
Content-Type    text/html
Date    Tue, 05 Feb 2013 21:12:20 GMT
Expires Thu, 01 Jan 1970 00:00:00 GMT
Pragma  no-cache
Server  Apache/2.2.10 (Linux/SUSE)
X-Powered-By    Servlet/2.5 JSP/2.1
X-UA-Compatible IE=8, chrome=1 
```

可能是因为我在 web.xml 中设置 Spring MVC 的方式？

```
<servlet-mapping>
    <servlet-name>springmvc</servlet-name>
    <url-pattern>*.html</url-pattern>
</servlet-mapping> 
```

一切都映射到以“.html”结尾的 URL 并且浏览器正在查看它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T12:48:34.760

您正在混合两种产生响应的方式。直接写入响应，并要求Spring将方法的返回值写入响应体。您应该坚持一个，因为您目前拥有它，框架正在覆盖响应内容类型。`produces`通常，您可以将响应的内容类型作为`@RequestMapping`注释的属性提及。但是，由于在这种情况下您还想编写内容处置标头，因此我建议使用自定义视图，而不是`@ResponseBody`注释。

在您的自定义视图类中，设置所需的标头，然后自己将字节流式传输到响应输出流。

希望这可以帮助。

# ios - 如何让按钮从下午 3 点到 9 点打开？

> ID：14717577
> 
> 赞同：0
> 
> 时间：2013-02-05T21:47:27.203
> 
> 标签：ios, objective-c, cocoa-touch

我想创建一个仅在此时处于活动状态的按钮，在剩余的时间里有另一个
我尝试使用 NSDate 的图像，但我不知道使用哪种方法来设置这个时间是否可行？
代码是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:52:48.470

不知道您的环境是什么很难说，但我希望您需要某种计时器来指示何时激活和停用按钮。

理想情况下，会在下午 3 点（顺便说一句，哪个 TZ？）然后在晚上 9 点向您的代码发送事件，但可能是每分钟一次的常规触发器，然后您可以检查实际的 ToD。

HtH，露丝

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:53:29.823

有可能的。

有一些方法可以解决这个问题首先，您可以使用 UILocalNotification 来设置触发日期。

其次，在另一个线程中，永久检查时间。当时间在下午 3 点到 9 点之间时，使用 NSNotificationCenter 调用 postNotification。

第三，自定义您的按钮，然后在自定义按钮中添加一个计时器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:55:57.053

您可以执行以下操作，1）当您启动应用程序时，请检查现在几点。
2）如果它在下午 3 点到晚上 9 点之间，使按钮处于活动状态，同时在适当的结束时间启动 NSTIMER
3）如果没有，将按钮图像设置为您的图像，使按钮处于非活动状态，启动 NSTIMER 以在下午 3 点触发
4 ) 当 nstimer 被触发时，更改图像并使其处于活动状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T16:02:58.070

当您要检查日期时，您需要选择一些事件。假设您设置了`NSTimer`1 分钟的间隔。然后定期：

1.  获取**当前日期**和时间表示：

    ```
    NSDate *now = [NSDate date]; 
    ```

2.  **使用以下**方式获取小时**`NSCalendar`：**

     **```
    NSDateComponents *components = [[NSCalendar currentCalendar] components:NSHourCalendarUnit
                                                                   fromDate:now];
    NSUInteger hour = components.hour; 
    ```** 
***   **比较和应用**可用性：

    ```
    BOOL available = (hour >= 3 && hour < 9);
    button.enabled = available; 
    ```** 

 **我想你需要做一些调整，因为 12/24 小时制。**

# recursion - 递推关系变化变量

> ID：14717581
> 
> 赞同：0
> 
> 时间：2013-02-05T21:47:57.750
> 
> 标签：recursion

我有一个找不到答案的问题：

```
f(n)=(2n*f(n-1))/(n-1)+(3n*f(n-2))/(n-2) 
```

domeone可以帮助我吗？

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:03:33.813

我试过这样的东西..

```
Let y = f(n)/n 
```

从中我得到方程`ny = (2*n - y(n-1))/( n- 1 + 3ny)`

这是 y 的二次方，最后用 f(n)/n 替换 y。

希望这是正确的。:-)

# c++ - 使用共享库引用全局指针的 Qt/C++ 单例静态方法

> ID：14717582
> 
> 赞同：1
> 
> 时间：2013-02-05T21:47:58.627
> 
> 标签：c++, qt, static, singleton, shared-libraries

我有一个 C++ 共享库 ( libtest-lib.so )，它通过嵌入式 Linux 平台上的 2 个 Qt 应用程序 - 应用程序 A 和应用程序 B 链接。我希望 App A 和 App B 都能够从 libtest-lib.so 引用单个共享指针。

Libtest-lib.so 很小 -

测试-lib_global.h：

```
#ifndef TESTLIB_GLOBAL_H
#define TESTLIB_GLOBAL_H

#include <QtCore/qglobal.h>

#if defined(TESTLIB_LIBRARY)
#  define TESTLIBSHARED_EXPORT Q_DECL_EXPORT
#else
#  define TESTLIBSHARED_EXPORT Q_DECL_IMPORT
#endif

#endif // TESTLIB_GLOBAL_H 
```

测试库.h：

```
#ifndef TESTLIB_H
#define TESTLIB_H

#include "test-lib_global.h"

class TESTLIBSHARED_EXPORT TestLib
{
public:
    TestLib();

    // Notice that it is a reference
    TESTLIBSHARED_EXPORT static int& GetSingleInt();

    // Create a global audio buffer
    TESTLIBSHARED_EXPORT static signed short* getGlobalAudioBuffer();

};

#endif // TESTLIB_H 
```

测试库.cpp：

```
#include "testlib.h"

int& TestLib::GetSingleInt()
{
    // keep the actual value as static to this function
    int min = 5;
    int max = 500;
    static int s_value(min + (rand() % (int)(max - min + 1)));

    // but return a reference so that everybody can use it
    return s_value;
}

// Create a global audio buffer
signed short* TestLib::getGlobalAudioBuffer() {

    // Create a static audio buffer
    static signed short* globalAudioBuffer = (signed short*)malloc( 1000 * sizeof(signed short) );

    return globalAudioBuffer;

}

TestLib::TestLib()
{
} 
```

App A 和 App B 主要执行以下操作：

```
int me = TestLib::GetSingleInt();
qDebug() << "SHARED INT IS: " << me;

signed short* audioBuffer = TestLib::getGlobalAudioBuffer();
qDebug() << "SHARED AUDIO BUFFER POINTER IS: " << &audioBuffer; 
```

当我部署 libtest-lib.so 然后构建和部署 App A 和 App B 时，我得到以下输出：

应用程序 A：

```
SHARED INT IS:  108 
SHARED AUDIO BUFFER POINTER IS:  0xbe844ac8 
```

应用 B：

```
SHARED INT IS:  108 
SHARED AUDIO BUFFER POINTER IS:  0xbeff0e64 
```

int是一样的，只是指针地址不同。我究竟做错了什么？如何从库函数返回相同的共享指针？

谢谢 -

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T21:55:20.460

这本身是不可能的。每个进程都有其独立的地址空间。共享库在运行时共享指令和数据，而不是内存。您将不得不使用[共享内存](http://en.wikipedia.org/wiki/Shared_memory)并相应地在进程之间进行同步。Qt 提供[QSharedMemory](http://qt-project.org/doc/qt-4.8/qsharedmemory.html)，它为原始共享内存块提供了一个独立于平台的 API，并带有一些基本的基于信号量的锁定/解锁机制用于同步。

或者，使用另一种 IPC 机制来流式传输音频数据，例如管道或套接字。这可能会使同步变得容易得多，具体取决于进程之间交互的复杂性。

# python - 使用 python 启动并行 ssh 渲染作业

> ID：14717587
> 
> 赞同：2
> 
> 时间：2013-02-05T21:48:20.660
> 
> 标签：python, ssh, blender

我正在用 Python 编写一个脚本来 ssh 到几台计算机（大约十台），并让它们开始从 Blender 渲染 3d 图像。它工作正常，除了下一台计算机的渲染在前一台计算机完成之前不会开始。有没有办法启动命令并让它们在自己的机器上同时运行？

我的代码是什么样的：

```
import os
path = /home/me
comp1 = ['sneffels','1','2'] #computer name, start frame, end frame
comp2 = ['bierstadt','3','4']
comp3 = ['diente','5','6']

os.system("ssh igp@" + str(comp1[0]) + " blender -b "+ str(path) +" -s " + str(comp1[1]) + " -e " + str(comp1[2]) + " -a")

os.system("ssh igp@" + str(comp2[0]) + " blender -b "+ str(path) +" -s " + str(comp2[1]) + " -e " + str(comp2[2]) + " -a")

os.system("ssh igp@" + str(comp3[0]) + " blender -b "+ str(path) +" -s " + str(comp3[1]) + " -e " + str(comp3[2]) + " -a") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:58:53.600

问题是`os.system`在程序完成之前不会返回，并且`ssh`在您给它的命令完成之前不会完成。

这是不使用的众多原因之一`os.system`——正如[文档](http://docs.python.org/2/library/os.html#os.system)明确指出的那样：

> subprocess 模块提供了更强大的工具来生成新进程并检索它们的结果；使用该模块优于使用此功能。请参阅子流程文档中的用子流程模块替换旧功能部分以获取一些有用的秘诀。

在`subprocess`中，您可以创建一堆子流程，然后在它们全部启动后将它们全部加入。例如：

```
p1 = subprocess.Popen("ssh igp@" + str(comp1[0]) + " blender -b "+ str(path) +" -s " + str(comp1[1]) + " -e " + str(comp1[2]) + " -a", shell=True)
p2 = subprocess.Popen("ssh igp@" + str(comp2[0]) + " blender -b "+ str(path) +" -s " + str(comp2[1]) + " -e " + str(comp2[2]) + " -a", shell=True)
p3 = subprocess.Popen("ssh igp@" + str(comp3[0]) + " blender -b "+ str(path) +" -s " + str(comp3[1]) + " -e " + str(comp3[2]) + " -a", shell=True)
p1.wait()
p2.wait()
p3.wait() 
```

这可能不是最好的方法。阅读子流程文档以了解为什么`shell=True`传递字符串通常不如传递`list`参数、管理子流程的其他方法等。但与此同时，这可能是您已有的最简单的更改。

另一种选择是不`ssh`首先使用命令，而是使用类似的东西[`paramiko`](http://www.lag.net/paramiko/)从 Python 中生成远程进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:21:32.297

只`+ " & "`在每个末尾添加有什么问题`os.system(...)`？

如果每个都有效，您似乎并不会太在意`blender`。

从外观上看，您可以在 shell 脚本中执行此操作。

你可以安装类似的东西`beanstalkd`，让你的 10 台服务器每台运行一个从共享队列中提取作业的工作程序。然后让您的作业调度员执行提及文件名、起始帧、结束帧的作业。

一个好处是，当消费者完成时，他们可以将他们的状态放回队列中。

否则，您将无法知道其中一个子流程是否失败等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:52:47.457

您可以尝试使用[threading](http://docs.python.org/2/library/threading.html)包。可以在 Salty Crane 博客上找到一个可能对您有所帮助的简单[示例](http://www.saltycrane.com/blog/2008/09/simplistic-python-thread-example/)。它应该允许您同时运行所有进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T21:59:10.717

您可能希望将您的电话[串接](http://docs.python.org/2/library/threading.html#thread-objects)起来。我准备了一个小例子，它只是呼应了一些东西（你可以把它改成 ssh）。我希望它足够清楚，所以你可以明白

```
#!/usr/bin/env python

import threading
import os
import random

ips = ["192.168.1.25", "192.168.1.26", "192.168.1.27"]

def run(ip, otherParameter):
    os.system("echo %s with other parameter %s" % (ip, otherParameter))

if __name__ == "__main__":
    for ip in ips:
        thread = threading.Thread(target=run, args=[ip, random.randint(0, 10)])
        thread.run() 
```

此外，您应该查看 subprocess 模块，而不是 os.system，[或者](http://docs.python.org/2/library/subprocess.html)更好的是，使用旨在运行 ssh 命令的东西，查看[paramiko](http://www.lag.net/paramiko/)模块。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T21:59:43.057

[subprocess.Popen](http://docs.python.org/2/library/subprocess.html)应该可以解决问题。

查看之前的答案： [如何从 Python 异步运行外部命令？](https://stackoverflow.com/questions/636561/how-can-i-run-an-external-command-asynchronously-from-python)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-03T10:45:52.037

我建议使用 pssh 之类的工具。
该工具使用多线程并且执行速度很快。[你可以在这里](http://www.tecmint.com/execute-commands-on-multiple-linux-servers-using-pssh/)
阅读更多关于它的信息。

# html - Internet Explorer 仅显示背景

> ID：14717590
> 
> 赞同：0
> 
> 时间：2013-02-05T21:48:27.533
> 
> 标签：html, css, internet-explorer

我正在开发我的应用程序，但遇到了问题。它适用于除 IE 之外的所有浏览器。

无论如何，这就是它的外观（编辑器视图） [http://i.imgur.com/axydt9n.jpg](http://i.imgur.com/axydt9n.jpg)

这就是它在浏览器模式下的样子（当我用 IE 手动打开它时）：http: [//i.imgur.com/GQx8zJE.jpg](http://i.imgur.com/GQx8zJE.jpg)

当没有分配背景图像时，它显示得很好。

这是我的“body”div 的 CSS 属性

```
body {
font: 80%/1.4 Verdana, Arial, Helvetica, sans-serif;
background: #4E5869;
margin: 0;
padding: 0;
background-position: 50% 50%;
background-attachment: scroll;
color: #000;
background-image: url(http://i.imgur.com/GQx8zJE.jpg);
} 
```

有人有什么建议吗？

这是完整的 HTML 源代码：

> [http://pastebin.com/Qvq83f9H](http://pastebin.com/Qvq83f9H)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:10:23.937

你的 JS 有问题 解决它

```
 <!--window.onload= function (){if( ! getCookie("ok") ) {   showInfo(document.getElementById('welcome').innerHTML); }} 
```

你不能用**< !--**你必须把js 代码注释掉**//**

```
 //window.onload= function (){if( ! getCookie("ok") ) { showInfo(document.getElementById('welcome').innerHTML); }} 
```

# c# - 为什么我的第二个 C# 淡入淡出条件不会改变图片框？

> ID：14717591
> 
> 赞同：1
> 
> 时间：2013-02-05T21:48:34.753
> 
> 标签：c#, winforms, graphics

我有 C# 淡出一个图片框，当我单击一个按钮时，淡出后同一个图片框将在下一张图像中淡出。目前，我在淡出和淡入条件下都放置了淡出代码。（我仍然需要为淡入重写代码。）一旦代码达到第二张图像的逻辑，代码就会循环，直到条件变为假并退出而不更改显示。如何更正我的代码以在第二张图像上获得相同的效果？另外，如果有人知道如何重写淡入淡出逻辑，请告诉我。

顶部定义的变量：

```
int alpha = 0;
    bool backButtonClick = false;
    bool breakCheck = false; 
```

按钮的逻辑片段：

```
 private void storyChooser_Click(object sender, EventArgs e)
        {

            switch (userChoice)
            {
                case Choice.Son:

                    transitions();

                     if (alpha == 0)
                    {
                        pictureBox1.Image = Properties.Resources.test;
                        timer1.Start();

                    }
                break;
            } 
```

计时器：

```
 private void timer1_Tick(object sender, EventArgs e)
        {
            if (backButtonClick == true)
            {
                timer1.Stop();
                alpha = 0;
                backButtonClick = false;
            }

            if (alpha++ < 40)
            {
                Image image = pictureBox1.Image;
                using (Graphics g = Graphics.FromImage(image))
                {
                    Pen pen = new Pen(Color.FromArgb(alpha, 255, 255, 255), image.Width);
                    g.DrawRectangle(pen, -1, -1, image.Width, image.Height);
                    g.Save();

                }
                pictureBox1.Image = image;
            }
            else
            {
                timer1.Stop();
            }

            if (alpha == 40 && breakCheck == false)
            {
                pictureBox1.Image = Properties.Resources.transitionTest;

                timer1.Start();

                while (alpha-- > 0)
                {
                    Image image = pictureBox1.Image;
                    using (Graphics g = Graphics.FromImage(image))
                    {
                        Pen pen = new Pen(Color.FromArgb(alpha, 255, 255, 255), image.Width);
                        g.DrawRectangle(pen, -1, -1, image.Width, image.Height);
                        g.Save();

                    }
                    pictureBox1.Image = image;
                    label1.Text = alpha.ToString();
                }
                breakCheck = true;
            }
            label1.Text = alpha.ToString();
        } 
```

我正在运行 while 循环，朝向计时器的底部，没有更新任何图形。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:01:16.027

我认为这可能是因为您在 while 循环中执行所有这些操作，在您更改它之前，ui 没有机会重新绘制自己。

您可能也想在计时器滴答声中做减法部分，而不是一次性完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:53:44.503

看起来您的第二个*淡入淡出*条件中有一个 while 循环。

这将使您的控制在您的下一个计时器滴答事件之前从一侧转移到另一侧。

不过，我不得不重新编写您的代码，以便更好地了解它。

`PictureBox`如果您使用`Graphic`直接写入屏幕，为什么要使用控件？

这是我对您的代码的可怕修改。我希望它不会冒犯。

我预先声明了所有变量，因此 VS 不会抱怨错误的定义。

我也没有`transitionTest`图像，所以我`Properties_Resources_transitionTest`为此定义了一个。

```
int MAX = 40;
int alpha;
bool backButtonClick;
bool breakCheck;
Label label1;
Image Properties_Resources_transitionTest;
Image image; 
```

初始化下面的东西并启动它。我不知道您的枚举类型是什么意思，也不知道`transition()`您调用的方法是什么。

```
private void storyChooser_Click(object sender, EventArgs e) {
  alpha = 0;
  backButtonClick = false;
  breakCheck = false;
  image = Properties_Resources_transitionTest;
  timer1.Start();
} 
```

对于`backButtonClick`and`breakCheck`值，我将它们放在表单的 click 事件处理程序中，如下所示：

```
private void backButton_Click(object sender, EventArgs e) {
  backButtonClick = !backButtonClick;
}

private void break_Click(object sender, EventArgs e) {
  breakCheck = true;
  // easier to just write
  // timer1.Stop();
} 
```

这个 Timer Tick 事件处理程序应该处理您正在尝试执行的操作。请注意，`while`循环也已被删除。

```
private void timer1_Tick(object sender, EventArgs e) {
  if (!breakCheck) {
    using (Pen p = new Pen(Color.FromArgb(alpha, 255, 255, 255), image.Width)) {
      using (Graphics g = Graphics.FromImage(image)) {
        g.DrawRectangle(p, 0, 0, image.Width, image.Height);
      }
    }
    if (backButtonClick) {
      alpha--;
      if (alpha == 0) {
        timer1.Stop();
      }
    } else {
      alpha++;
      if (alpha == MAX) {
        timer1.Stop();
      }
    }
  } else {
    timer1.Stop();
  }
  label1.Text = alpha.ToString();
} 
```

**更新：**评论中的每个问题：

如果`backButtonClick`为真，则`alpha`每次计时器滴答时该值将减少 1，并在`alpha`达到零时停止。

如果`backButtonClick`为假，`alpha`将增加直到达到`MAX`，然后停止计时器。

由于`alpha`控制了`Pen`颜色的不透明度，因此您的图像会出现淡入和淡出，具体取决于您`backButtonClick`设置的值。

我相信这就是你所追求的，但我可能是错的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:53:04.800

我假设你的意思是它跳过之后的部分：

```
 if (alpha == 40 && breakCheck == false) 
```

我认为这不会执行，因为您停止增加 alpha 值 39 因为这条线：

```
if (alpha++ < 40) 
```

如果将其更改为不太相等，则应执行：

```
if (alpha++ <= 40) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-05T22:03:36.373

为什么人们对winforms如此坚持？

看，您可以在 WPF 中使用 20 行 XAML 来执行此操作，并且完全**没有 C# 代码**：

```
<Window x:Class="WpfApplication4.Window4"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Window4" Height="300" Width="300">
    <Window.Resources>
        <Storyboard x:Key="FadeIn" TargetName="Red" Duration="00:00:05">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1"/>
        </Storyboard>
        <Storyboard x:Key="FadeOut" TargetName="Blue" Duration="00:00:05">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="1" To="0"/>
        </Storyboard>
    </Window.Resources>
    <DockPanel>
        <Button DockPanel.Dock="Top"  HorizontalAlignment="Center" Content="Fade">
            <Button.Triggers>
                <EventTrigger RoutedEvent="Button.Click">
                    <EventTrigger.Actions>
                        <BeginStoryboard Storyboard="{StaticResource FadeIn}"/>
                        <BeginStoryboard Storyboard="{StaticResource FadeOut}"/>
                    </EventTrigger.Actions>
                </EventTrigger>
            </Button.Triggers>
        </Button>
        <Grid Margin="30">
            <Grid Background="Red" Opacity="0" x:Name="Red"/>
            <Grid Background="Blue" x:Name="Blue"/>
        </Grid>
    </DockPanel>
</Window> 
```

代码背后：

```
using System.Windows;

namespace WpfApplication4
{
    public partial class Window4 : Window
    {
        public Window4()
        {
            InitializeComponent();
        }
    }
} 
```

只需将我的代码复制并粘贴到文件 -> 新项目 -> WPF 应用程序中，然后自己查看结果。

这些是具有纯色背景的网格。您可以将`<Grid/>`s替换为`<Image/>`s 或任何您想要的。

# javascript - parse.com Javascript：parseObject 解析方法

> ID：14717593
> 
> 赞同：0
> 
> 时间：2013-02-05T21:48:37.633
> 
> 标签：javascript, backbone.js, parse-platform

parseObject 中骨干模型 Parse 方法的等价物是什么？

我找不到它，我的解析方法没有被调用。

我需要解析从服务器获得的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T03:11:35.163

您应该尝试主干解析库：[https ://github.com/neebz/backbone-parse](https://github.com/neebz/backbone-parse)

# python - 如何使用 Python 测试 API 客户端？

> ID：14717595
> 
> 赞同：9
> 
> 时间：2013-02-05T21:48:53.957
> 
> 标签：python, unit-testing, mocking

我正在为一个流行的 API 开发一个客户端库。目前，我对所述客户端的所有单元测试都在对测试帐户进行实际的 API 调用。

这是一个例子：

```
def test_get_foo_settings(self):
    client = MyCustomClient(token, account)
    results = client.get_foo_settings()

    assert_is(type(results), list) 
```

我想停止对我的测试帐户进行实际的 API 调用。

我应该如何解决这个问题？我应该使用[Mock](http://pypi.python.org/pypi/mock)来模拟对客户端的调用和响应吗？

此外，我对使用此客户端库进行测试的理念感到困惑。我对测试实际的 API 不感兴趣，但是当涉及到不同的因素时，比如被调用的方法、可能的返回结果的排列等等 - 我不确定我应该测试什么和/或什么时候可以安全做出假设（例如模拟响应）。

在我的场景类型中如何使用 Mock 的任何方向和/或示例将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T22:04:59.433

我个人会先创建一个接口或函数调用，供您的库用于实际联系服务，然后在测试期间为此编写自定义模拟。

例如，如果服务使用 HTTP 并且您使用请求来联系服务：

```
class MyClient(…):
    def do_stuff(self):
         result = requests.get(self.service_url + "/stuff")
         return result.json() 
```

我会首先围绕请求编写一个小包装器：

```
class MyClient(…):
    def _do_get(self, suffix):
         return requests.get(self.service_url + "/" + suffix).json()

    def do_stuff(self):
         return self._do_get("stuff") 
```

然后，对于测试，我会模拟出相关的功能：

```
 class MyClientWithMocks(MyClient):
     def _do_get(self, suffix):
          self.request_log.append(suffix)
          return self.send_result 
```

并在这样的测试中使用它：

```
def test_stuff(self):
    client = MyClientWithMocks(send_result="bar")
    assert_equal(client.do_stuff(), "bar")
    assert_contains(client.request_log, "stuff") 
```

此外，编写测试可能是有利的，这样您就可以针对您的模拟*和*真实服务运行它们，这样如果事情开始失败，您可以快速找出是谁的错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-03T17:51:48.533

我正在使用 HTTmock，对此我很满意：[https ://github.com/patrys/httmock](https://github.com/patrys/httmock)

# jquery - jquery mobile 需要什么浏览器？我可以将它与phonegap一起使用吗？

> ID：14717599
> 
> 赞同：0
> 
> 时间：2013-02-05T21:49:09.360
> 
> 标签：jquery, jquery-mobile

我只熟悉桌面版 jquery，我也想将它用于移动 RIA。我去提供的演示站点（[http://jquerymobile.com/demos/1.2.0/](http://jquerymobile.com/demos/1.2.0/)）并尝试查看它。问题是我拥有的所有浏览器都不能很好地支持它（内置 Android 4、chrome mobile、delphin 浏览器 - 都是最新的）。当我探索这个演示时，我注意到：

*   在转换到下一个之前页面滚动到顶部
*   页面在转换到下一个之前闪烁
*   返回页面时页面在顶部打开，然后滚动（可见）到上一个位置，甚至根本不滚动
*   页面隐藏前列表视图折叠
*   不同的浏览器给出不同的页面大小（字体和控件）
*   输入在编辑期间不应用样式
*   在内容转换期间固定页脚抽动

我的问题是：jquery mobile 是否真的支持任何浏览器......或者我应该问，是否有任何浏览器真的支持 jquery mobile？

我花了一些时间来处理它。我想将它用于我的移动 RIA 应用程序。未来我计划将其转移到phonegap。但我还遇到了另一个问题：

*   使用碎片化的 GUI 看起来像是在平板电脑上工作，但它有相同的滚动问题，并且在这个演示中根本没有记录（这里我的意思是片段：http: [//developer.android.com/images/fundamentals/fragments.png](http://developer.android.com/images/fundamentals/fragments.png) )

所以我最后要问的问题是：jquery mobile 准备好将它用于移动 RIA 了吗？

我给了它一个机会，因为我现在正在使用 jqueru UI，它工作得很好。但我害怕陷入死胡同。

如果可以的话，请给我一些启发。

[编辑]

我在三星 GT-I9100、Android 4.0.4 上对其进行了测试（我假设我的用户也可以使用性能较低的手机）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:30:42.057

这里有很多信息：

[http://jquerymobile.com/demos/1.2.0/docs/about/platforms.html](http://jquerymobile.com/demos/1.2.0/docs/about/platforms.html)

是的，PhoneGap 是特别支持的。

您详述的大多数问题是移动设备及其浏览器的限制，而不是 jQuery Mobile。与原生应用程序相比，移动 Web 将始终提供权衡。一种为您提供广泛的分布，但具有公认的局限性。另一个为您提供出色的控制和 UI，但跨平台选项有限。

我正在用 jQM 构建一个相当大的应用程序。它针对企业类型的客户，对我们来说，分发和跨平台功能远远超出了限制。但这一切真的取决于你想破解什么坚果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:31:50.243

此处列出了对 jQuery Mobile 的浏览器支持：http: [//jquerymobile.com/gbs/](http://jquerymobile.com/gbs/)。它是一个分级的支持文档（A、B 和 C），每个等级意味着它具有不同的支持级别。请务必仔细阅读浏览器旁边的评论——它通常会列出用于测试它的手机的品牌和型号。例如，Android 4.0 浏览器指出升级后的设备可能会出现一些问题。

请注意，对于任何移动平台，您不仅支持浏览器，还支持操作系统版本和硬件本身。不幸的是，这会使移动开发变得棘手。

# git - 考虑实时更新的 Git 部署工作流程

> ID：14717602
> 
> 赞同：2
> 
> 时间：2013-02-05T21:49:24.070
> 
> 标签：git, deployment, hosting

## 我在寻找什么

我们正在寻找一个可以通过 Git 进行网络管理部署的 Git**主机**。我发现的大多数部署软件都使用 FTP，如果在实时服务器上进行了更新（我们的一些脚本偶尔会生成代码更改），如果存储库具有相同的修改文件（什么否则将是合并冲突）。我们已经尝试过 beanstalk、springloops 和 deployhq。

## 当前工作流程

我们目前有一个繁琐的部署过程，包括提交实时代码并将其推送到 Git 服务器，然后拉到开发人员机器，解决任何合并冲突，然后推送回 Git 服务器，然后拉到实时服务器。

* * *

有谁知道可以通过 Git 进行差异部署的服务，如果存在合并冲突，可能无法部署，并且只是警告差异？这也可能是 Git 托管服务本身。

## 更新

我制作了这张信息图来帮助展示我们当前的工作流程，以及我们希望如何拥有我们的工作流程：

[![工作流信息图](../Images/ae74a8ca38e0e20bc7ebb600d5e57631.png)](https://i.stack.imgur.com/idp3C.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:00:45.087

请参阅下面的答案，了解我们每天使用的基于 git 的部署策略。每次更新它都会部署到一个新目录，因此它永远不会在服务器上发生合并冲突。我*强烈*建议不要编辑已部署的代码，但要针对每个人自己的。

*   [如何在推送时自动结帐？](https://stackoverflow.com/questions/14667128/how-can-i-automagically-make-a-checkout-upon-push/14670278#14670278)

然而，这不是托管服务，它是自己做的。因此，它并不能完全回答您的问题，但值得注意。

# java - 为什么这段代码会抛出 ConcurrentModificationException？

> ID：14717606
> 
> 赞同：0
> 
> 时间：2013-02-05T21:49:30.737
> 
> 标签：java, iterator, set

编写一个方法 removeEvenLength ，它接受一组字符串作为参数，并从集合中删除所有偶数长度的字符串。

我的解决方案：

```
public static void removeEvenLength(Set<String> set) {
    for(String word : set) {
        if(word.length() % 2 == 0) {
            set.remove(word);
        }
    }
} 
```

输入： `[foo, buzz, bar, fork, bort, spoon, !, dude]`

输出：

```
ConcurrentModificationException on line 2:
java.util.ConcurrentModificationException
    at java.util.TreeMap$PrivateEntryIterator.nextEntry(TreeMap.java:1115)
    at java.util.TreeMap$KeyIterator.next(TreeMap.java:1169)
    at removeEvenLength (Line 2) 
```

所以我可以通过创建一个`Iterator`. 但是我想知道为什么上面的代码不起作用？

编辑：

迭代器也不起作用：

```
public static void removeEvenLength(Set<String> set) {
    Iterator<String> i = set.iterator();
    while(i.hasNext()) {
        String word = i.next();
        if(word.length() % 2 == 0) {
            set.remove(word);
        }
    }
} 
```

同样的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T21:54:32.663

在这个迭代`iterator`中，对象被隐式创建。当您拥有时，`iterator`您可以仅从迭代器更改集合。在这种情况下，您将直接删除对象，这就是引发此异常的原因。

创建迭代器，并使用迭代器删除对象：

```
iterator.remove(); // removes current element 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T21:56:38.660

要了解为什么`ConcurrentModificationException`会发生，您将了解[快速失败](http://en.wikipedia.org/wiki/Fail-fast)迭代的概念。如果一个线程正在迭代一个集合，并且它意识到该集合在迭代进行时正在被修改，那么迭代器将抛出一个异常，而不是“可能”在以后的代码中导致任何完整性问题。

当然，并不是所有的迭代器都遵循这种方法，并且使用 Java`Iterator`几乎总能确保迭代在修改时永远不会失败。

要使用迭代器删除元素，请使用此代码

```
Iterator<String> iter = list.iterator();
    while(iter.hasNext()) {
        String obj = iter.next();
        if(<removal_condition_here>) {
            iter.remove();
        }
    } 
```

# - QKeyEvent

> ID：14717609
> 
> 赞同：0
> 
> 时间：2013-02-05T21:49:42.093
> 
> 标签：

QKeyEvent 类是 Qt 框架的一部分，描述了一个按键事件。

# c++ - 如何在单独的函数中写入文件

> ID：14717616
> 
> 赞同：3
> 
> 时间：2013-02-05T21:50:03.610
> 
> 标签：c++, file-io

我试图让我的程序编写一个与主函数不同的函数，但我遇到了很多麻烦。这是我的程序的简化版本：

```
#include <iostream>
#include <fstream>
using namespace std;

void writeToFile(int x)
{
    outputFile << x << endl;
}

int main()
{
ofstream outputFile;
outputFile.open("program3data.txt");
for (int i = 0; i < 10; i++)
{
    writeToFile(i);
}
outputFile.close();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T21:54:57.903

您的`writeToFile`函数正在尝试使用`outputFile`位于不同范围内的变量。您可以将输出流传递给函数，这应该可以工作。

```
#include <iostream>
#include <fstream>
using namespace std;

void writeToFile(ofstream &outputFile, int x)
{
    outputFile << x << endl;
}

int main()
{
    ofstream outputFile;
    outputFile.open("program3data.txt");
    for (int i = 0; i < 10; i++)
    {
        writeToFile(outputFile, i);
    }
    outputFile.close();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:55:34.787

您需要让您的子功能知道`outputFile`. 如所写，该变量仅存在于“主”函数内部。您可以将函数签名更改为：

```
void writeToFile(int x, ofstream of) 
```

并称之为：

```
writeToFile(i, outputFile); 
```

这会将变量传递给子函数，以便它也可以在该范围内使用。

# javascript - 如何在javascript中获取鼠标相对于窗口视口的位置？

> ID：14717617
> 
> 赞同：35
> 
> 时间：2013-02-05T21:50:11.957
> 
> 标签：javascript, height, dom-events, viewport

`event.pageY`获取相对于整个文档高度的鼠标位置（`document.documentElement.offsetHeight`我假设）。

但是如何获得相对于当前视口的鼠标位置，即`document.documentElement.clientHeight`？

例如，如果浏览器窗口大小为 720 像素高度，我向下滚动 3 页并将鼠标保持在窗口中间，位置应为“360”，而不是 1800（720 x 3 - 720 / 2）。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-02-05T21:53:11.900

尝试使用`event.clientY`它应该始终返回正确的值，而不管滚动

[https://developer.mozilla.org/en-US/docs/DOM/event.clientY](https://developer.mozilla.org/en-US/docs/DOM/event.clientY)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-05T21:55:55.420

用于[`event.clientY`](https://developer.mozilla.org/en-US/docs/DOM/event.clientY)获取[鼠标](http://quirksmode.org/js/events_properties.html#position)相对于浏览器视口的位置（[兼容性表](http://quirksmode.org/dom/w3c_cssom.html#mousepos)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-07-06T21:39:40.100

我处于类似情况，我需要光标在视口中的坐标（因为我的页面是可滚动的）。

我在这里尝试了其他答案，一旦滚动屏幕，它们似乎就不起作用（它们适用于不可滚动的页面）。

[在阅读了https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent](https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent)的一些文档页面后， 我发现在使用可滚动页面时，如果您需要当前视口的 X 和 Y 坐标（即即使滚动），最好改为使用 `event.pageX`。

`var pageX = MouseEvent.pageX;`

[https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/pageX](https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/pageX)

# ios - 使用 CGContextShowTextAtPoint 显示文本会绘制奇怪的文本

> ID：14717623
> 
> 赞同：1
> 
> 时间：2013-02-05T21:50:25.927
> 
> 标签：ios, xcode, text, sdk, cgcontext

我只是想在 UIImage 中覆盖文本（使用 CGContext），但它没有显示我指定的文本。在这段代码中，我作为文本参数给出，`"Hello"`但它显示“eÉääc”。我不知道发生了什么我认为角色被取代了，但我不知道如何解决它。这是我的代码：

```
UIGraphicsBeginImageContextWithOptions(image.size, YES, 0);
CGContextRef c = UIGraphicsGetCurrentContext();
[image drawInRect:CGRectMake(0, 0, image.size.width, image.size.height)];
CGContextSetTextMatrix(c, CGAffineTransformMake(1.0, 0, 0, -1.0, 0, 0));
CGContextSelectFont(c, "ArialMT", 50, kCGEncodingFontSpecific);
CGContextSetRGBStrokeColor(c, 255, 0, 0, 1);
CGContextSetRGBFillColor(c, 255, 0, 0, 1);
CGContextSetCharacterSpacing(c, 2);
CGContextShowTextAtPoint(c,100,100, "Hello", 5);
UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

我正在使用西班牙语键盘（我不知道这是否重要），而 iPad（我正在测试应用程序的地方）是加泰罗尼亚语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T13:54:21.527

`CGContextShowTextAtPoint()`根据 的指定编码参数解释给定的文本`CGContextSelectFont`。您选择`kCGEncodingFontSpecific`了 ，这是字体内置编码（无论是什么）。

唯一的其他选择是`kCGEncodingMacRoman`：

```
CGContextSelectFont(c, "ArialMT", 50, kCGEncodingMacRoman); 
```

然后，只要您只使用 ASCII 字符集中的字符，您的文本就应该正确显示。

对于非 ASCII 字符，您必须将字符串转换为 MacRoman 编码，例如[https://stackoverflow.com/a/13743834/1187415](https://stackoverflow.com/a/13743834/1187415)示例。

请注意，`CGContextShowTextAtPoint` *它不能显示*一般的 Unicode 字符串，甚至会出现欧元 (€) 字符的问题。的 `drawAtPoint:withFont:`方法`NSString`没有这些限制。

# - QMenuBar

> ID：14717628
> 
> 赞同：0
> 
> 时间：2013-02-05T21:50:53.490
> 
> 标签：

QMenuBar 类是 Qt 框架的一部分，它提供了一个水平菜单栏。

# python - 获取没有可用请求对象的 Django 用户 ID

> ID：14717641
> 
> 赞同：2
> 
> 时间：2013-02-05T21:51:40.400
> 
> 标签：python, django

我扩展了 Django CursorDebugWrapper 执行例程，因此在服务器端我可以跟踪所有执行的 SQL。看起来像这样：

```
class PrintQueryWrapper(django.db.backends.util.CursorDebugWrapper):
    def execute(self, sql, params=()):
        try:
            return self.cursor.execute(sql, params)
        finally:
            # record sql and do other stuff

django.db.backends.util.CursorDebugWrapper = PrintQueryWrapper 
```

问题是我需要每个用户会话单独执行此操作，否则它将记录所有用户的所有 sql，而不知道来自哪里的内容。如果我可以从 execute() 访问用户 ID，我可以轻松跟踪每个用户的 SQL，但如果无法访问请求对象，我不知道如何做到这一点。

注意：我不能为上述代码申请信用。它起源于 Django 调试工具栏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T15:31:27.957

**您可以使用中间件：**

中间件.py：

```
import django.db.backends.util

class PrintQueryWrapper(django.db.backends.util.CursorDebugWrapper):
    user_id = None
    def execute(self, sql, params=()):
        try:
            return self.cursor.execute(sql, params)
        finally:
            print self.user_id, ": ", sql   

class PrintQueryMiddleware(object):
    def process_request(self, request): 
        PrintQueryWrapper.user_id = request.user.pk
        django.db.backends.util.CursorDebugWrapper = PrintQueryWrapper 
```

设置.py：

```
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'main.middleware.PrintQueryMiddleware',         # chnage path to your app
) 
```

# c# - 从 DataTable 中选择第二组 20 行

> ID：14717644
> 
> 赞同：11
> 
> 时间：2013-02-05T21:51:49.190
> 
> 标签：c#, select, datatable

我有一个数据表，我从 SQL 表中填充以下示例列

*   ID
*   类型
*   价值

我正在用某种类型的行填充 DataTable。我想从生成的 DataTable 中选择第 10 - 20 行：

```
Connect conn = new Connect();
SqlDataAdapter da = new SqlDataAdapter(SQL, conn.Connection());

//Creates data
DataTable d = new DataTable();
da.Fill(d);

DataRow[] result = d.Select(); 
```

在上面的代码中，我省略了主 SQL，目前我的 DataRow 数组没有选择。我找不到引用行号的方法。

所以例如我正在寻找类似的东西`Select("rownum > X && rownum < Y")`

我在这里搜索过，以及其他一些资源都无济于事。任何线索都会非常方便，或者只是简单的不可能。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-05T21:54:30.617

最好只从数据库中选择您需要的内容（通过使用`TOP`子句或类似的窗口函数`ROW_NUMBER`），而不是在内存中过滤它。

但是，您可以使用`Linq-To-DataSet`and `Enumerable.Skip`+ `Enumerable.Take`：

```
var rows = d.AsEnumerable()
    .Skip(9).Take(11);  // select rows 10-20 as desired (so you want 11 rows) 
```

如果你想要一个新`DataTable`的从过滤结果中使用`CopyToDataTable`，如果你想要一个`DataRow[]`使用`rows.ToArray()`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T21:56:41.927

我只会执行“take”和“skip”命令并保持简单：

```
 d.Select().Skip(10).Take(10);  // skips 10 rows, then selects ten after that. 
```

这将假设您有 Linq using set（使用 System.Linq）

# java - 如何使用 BufferedReader 将字符串添加到 ArrayList 中？

> ID：14717648
> 
> 赞同：0
> 
> 时间：2013-02-05T21:51:57.477
> 
> 标签：java

我想通过用户 System.in 将我的单词添加到我的 input_words 中，我尝试在网上查看并且我确实测试了很多方法，但它不起作用。任何人都可以帮忙吗？

在我的代码中，当我运行它时，它会要求我放入 String1、2、3...7，但我想将其放入 input_words。

谢谢...

这是我的代码。

```
public static void main(String[] args) {

    ArrayList<String> input_words = new ArrayList<String>();

    input_words.add("SCHOOLWORKTWO");
    input_words.add("BALCONY");
    input_words.add("INSIST"); 
    input_words.add("SALTPETER");
    input_words.add("BOLTON");
    input_words.add("KITSCHY");
    input_words.add("CLIENTELE");
    String s1 = getInput("Enter a String String 1: ");
    String s2 = getInput("Enter a String String 2: " );
    String s3 = getInput("Enter a String String 3: " );
    String s4 = getInput("Enter a String String 4: " );
    String s5 = getInput("Enter a String String 5: " );
    String s6 = getInput("Enter a String String 6: " );
    String s7 = getInput("Enter a String String 7: " );
    System.out.println(s1 + ", " + s2+", " + s3+", " + s4+", " + s5+", " + s6+", " + s7);       // Should use this string as input_words.add Array
    System.out.print(getTiles(input_words, DEFAULT_SPLITTER)); // Make sure to use DEFAULT_SPLITTER

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:53:35.487

使用类似的东西[`StringBuilder`](http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html)来构造所需的字符串，然后将其添加到您的列表中，例如

```
StringBuilder sb = new StringBuilder();

sb.append(s1);
sb.append(",");
sb.append(s2);
.
.
sb.append(",");
sb.append(s7);

input_words.add(sb.toString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:08:06.080

我无法准确理解您要查找的内容...但是如果您说要使用 System.in 编写信息，则需要使用扫描仪。

像这样的东西：

```
ArrayList<String> input_words = new ArrayList<String>();

Scanner input = new Scanner(System.in);

input_words.add( input.next() ); 
```

如果您总是希望每次输入特定数量的单词，您可以使用这样的 for 循环（示例是七个单词）：

```
ArrayList<String> input_words = new ArrayList<String>();

Scanner input = new Scanner(System.in);

for (int i=0 ; i<7 ; i++) {     
    input_words.add( input.next() );
} 
```

我可能误解了你的问题，但我不确定。

# python - Python Pygame Pong 游戏问题

> ID：14717653
> 
> 赞同：0
> 
> 时间：2013-02-05T21:52:18.050
> 
> 标签：python, pygame, pong

所以基本上我在这里尝试编写的是一个使用 Python 编程语言和 Pygame 模块的 Pong 游戏。
我的问题如下：

1.  游戏有时会卡在一个循环中，在这个循环中，人工智能桨坐在那里，而它却一遍又一遍地输了
2.  球有时会上下跳动？我不知道为什么...
3.  球只是来回走动？我不明白为什么它没有像我想要的那样沿着一条随机线走……
4.  而我最大的问题，似乎是当球击中顶部或底部时，它就消失了，游戏继续进行，就好像它还在弹跳一样。

**我的代码**

```
# Pong
import random, pygame, sys
from pygame.locals import *

FPS = 300
WINWID = 640
WINHEI = 480

BROWN = (102, 51, 0)
LIGHTBLUE = (0, 204, 204)
GREEN = (0, 153, 0)
PADDLECOLOR = (255, 255, 255)
BALLCOLOR = PADDLECOLOR
BACKGROUNDCOLOR = (0, 0, 0)

def main():
    global FPSCLOCK, DISPLAYSURF
    SPEED = 1
    DIFF = 1.0 # AI paddle speed handicap
    ball_speed = 1
    AISIGHT = WINWID/6
    FONT = "Times New Roman"
    pygame.init()
    DEFAULTFONT = pygame.font.SysFont(FONT, 16)
    BIGGERFONT = pygame.font.SysFont(FONT, 32)
    FPSCLOCK = pygame.time.Clock()
    DISPLAYSURF = pygame.display.set_mode((WINWID, WINHEI))
    DISPLAYSURF.fill(BACKGROUNDCOLOR)
    BACKGROUND = pygame.Rect(0, 0, WINWID, WINHEI)
    pygame.display.set_caption('Pong')
    paddleUP, paddleDOWN = False, False    
    ballpos = (WINWID/2, WINHEI/2)
    AIpoint, PLAYERpoint = 0, 0
    score = "Player:%2f || Computer:%2f" % (AIpoint, PLAYERpoint)
    paddle = WINHEI/2
    AIpaddle = paddle
    pygame.draw.rect(DISPLAYSURF, BACKGROUNDCOLOR, BACKGROUND)
    pygame.draw.line(DISPLAYSURF, PADDLECOLOR, (9, paddle-20), (9, paddle+20), 3)
    pygame.draw.line(DISPLAYSURF, PADDLECOLOR, (629, AIpaddle-20), (629, AIpaddle+20), 3)
    pygame.draw.circle(DISPLAYSURF, BALLCOLOR, ballpos, 5)
    slope, y_int = ballpath(None, ballpos[0], ballpos[1])
    while True:
        for event in pygame.event.get():
            direction = None
            if event.type == QUIT:
                terminate()
            elif event.type == KEYDOWN:
                if (event.key == K_UP or event.key == K_w):
                    paddleUP = True
                elif (event.key == K_DOWN or event.key == K_s):
                    paddleDOWN = True
            elif event.type == KEYUP:
                if (event.key == K_UP or event.key == K_w):
                    paddleUP = False
                elif (event.key == K_DOWN or event.key == K_s):
                    paddleDOWN = False
        # move player paddle
        if paddleUP and paddle >= 20:
            paddle-=SPEED
        elif paddleDOWN and paddle <= 460:
            paddle+=SPEED
        # move AI paddle
        if ballpos[0] > (AISIGHT):
            if AIpaddle-20 < ballpos[1] and AIpaddle <= 460:
                AIpaddle+=SPEED/DIFF
            elif AIpaddle+20 > ballpos[1] and AIpaddle >= 20:
                AIpaddle-=SPEED/DIFF
        # move ball
        x = ballpos[0] + ball_speed
        y = (slope*x) + y_int
        ballpos = (x, y)
        # if it hits a paddle
        if 9 < ballpos[0] < 11:
            if paddle-20 < ballpos[1] < paddle+20:
                slope, y_int = ballpath(None, ballpos[0], ballpos[1])
                ball_speed*=-1
        elif 629 < ballpos[0] < 631:
            if AIpaddle-20 < ballpos[1] < AIpaddle+20:
                slope, y_int = ballpath(None, ballpos[0], ballpos[1])
                ball_speed*=-1
        # if it hits the top or bottom
        if WINHEI-5 > ballpos[1] or ballpos[1] < 5:
            slope, y_int = ballpath(slope, ballpos[0], ballpos[1])
        # if paddle misses ball
        if ballpos[0] < 5:
            AIpoint+=1
            score = "Player:%2f || Computer:%2f" % (PLAYERpoint, AIpoint)
            ballpos = (WINWID/2, WINHEI/2)
            pygame.draw.rect(DISPLAYSURF, (0, 0, 0, 100), pygame.Rect(0, 0, 640, 480))
            DISPLAYSURF.blit(BIGGERFONT.render("Point: Computer", 1, PADDLECOLOR), (WINWID/3, WINHEI/3))
            paddle, AIpaddle = WINWID/2, WINWID/2
            for i in range(5):
                FPSCLOCK.tick(FPS)
        elif ballpos[0] > 635 and AIpaddle-20 < ballpos[1] < AIpaddle+20:
            PLAYERpoint+=1
            score = "Player:%2f || Computer:%2f" % (PLAYERpoint, AIpoint)
            ballpos = (WINWID/2, WINHEI/2)
            pygame.draw.rect(DISPLAYSURF, (0, 0, 0, 100), pygame.Rect(0, 0, 640, 480))
            DISPLAYSURF.blit(BIGGERFONT.render("Point: Player", 1, PADDLECOLOR), (WINWID/3, WINHEI/3))
            for i in range(5):
                FPSCLOCK.tick(FPS)

        pygame.draw.rect(DISPLAYSURF, BACKGROUNDCOLOR, BACKGROUND)
        pygame.draw.line(DISPLAYSURF, PADDLECOLOR, (9, paddle-20), (9, paddle+20), 3)
        pygame.draw.line(DISPLAYSURF, PADDLECOLOR, (629, AIpaddle-20), (629, AIpaddle+20), 3)
        pygame.draw.circle(DISPLAYSURF, BALLCOLOR, ballpos, 5)
        DISPLAYSURF.blit(DEFAULTFONT.render(score, 1, PADDLECOLOR), (WINWID/3, 20))
        pygame.display.update()
        FPSCLOCK.tick(FPS)

def ballpath(old_slope, ball_x, ball_y):
    if old_slope == None:
        slope = int(random.random() * 2)
    else:
        slope = old_slope * -1
    y_int = ball_y - (slope * ball_x)
    return slope, y_int

def terminate():
    pygame.quit()
    sys.exit()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:07:42.750

我清理了你的代码。它应该对如何使用这些类有所帮助。[http://pastebin.com/rZF3Gr0D](http://pastebin.com/rZF3Gr0D)

注意事项：

*   得分事件发生时打印
*   `keystate`使用vs “on events”进行划桨运动。它使这种输入更容易。
*   [Sprite 组可](http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Group)让您批量“绘制”或检查碰撞。
*   删除了全局关键字。游戏拥有大多数东西。
*   到处使用`Rect`函数和属性。比如`ball.rect.center = screen.get_rect().center`。
*   通过触发生成球的随机角度。
*   上限帧率。接下来，您将转向基于时间的运动。为了简单起见，我把它省略了。
*   `Color()`让你做很多事情，包括`Color("red")`, `Color("gray40")`, 等等...

# solr - Solr 等效于 ElasticSearch 映射类型

> ID：14717655
> 
> 赞同：1
> 
> 时间：2013-02-05T21:52:31.943
> 
> 标签：solr, elasticsearch

根据文档，ElasticSearch 具有映射类型：

> 映射类型是一种将索引中的文档划分为逻辑组的方法。将其视为数据库中的表。

Solr 中是否有类似的功能？

我看到有些人在文档中包含一个新字段，后来他们使用这个新字段将搜索限制为特定类型的文档，但据我了解，他们必须共享架构和（我相信）ElasticSearch映射类型没有。那么，有没有等价物？

或者，也许是一个更好的问题，

如果我有多种文档类型，并且我想将搜索限制为某种文档类型，那么哪一个应该提供更好的解决方案？

我希望这个问题有任何意义，因为我对他们俩都是新手。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T07:58:53.297

您可以配置多核 solr：

[http://wiki.apache.org/solr/CoreAdmin](http://wiki.apache.org/solr/CoreAdmin)

也许自 solr 4.0 以来发生了一些变化，现在更容易了，因为我已经切换到 elasticsearch，所以我没有看它。就我个人而言，我发现弹性搜索索引/类型系统比这要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T13:08:59.533

在 Solr 4+ 中。

如果您打算跨多种类型进行分[面](https://wiki.apache.org/solr/SolrFacetingOverview)或任何其他计算，而不是创建具有差异化字段的单个模式。然后，在您的业务/映射/客户端层上只定义您真正想要查看的字段。使用带有[“fl”字段的自定义](https://wiki.apache.org/solr/CommonQueryParameters#fl)[搜索处理程序](https://wiki.apache.org/solr/SearchHandler)仅返回与该对象相关的字段。当然，这意味着所有那些仅限单一类型的字段都不是强制性的。

如果您的文档类型完全不相交，您可以为每种类型创建一个核心/集合，每个类型都有自己的定义文件。您已经完全分离，但仍然只有一个 Solr 服务器需要维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-16T16:25:43.650

> 我看到有些人在文档中包含一个新字段，后来他们使用这个新字段将搜索限制为特定类型的文档，但据我了解，他们必须共享架构和（我相信）ElasticSearch映射类型没有。

您可以在 Solr 中完全做到这一点。添加一个字段并使用它进行过滤。

正确的是，ElasticSearch 中的映射类型不必共享相同的模式，但在 ElasticSearch 内部，所有映射类型只使用一个模式。如此技术性的差异。事实上，MappingType 被映射到一个内部模式字段。

# php - 获取帖子的附件网址 - WordPress

> ID：14717659
> 
> 赞同：1
> 
> 时间：2013-02-05T21:52:47.670
> 
> 标签：php, wordpress, attachment, custom-post-type

我正在尝试创建一个 PDF 列表（每月创建的时事通讯）。我创建了一个名为“时事通讯”的自定义帖子类型，并将其限制为仅支持“标题”。

然后，我使用高级自定义字段插件向此帖子类型添加文件上传按钮。因此，每个帖子都有一个标题和一个上传 pdf 的按钮。

然后我编写了以下函数来输出附件列表。

```
function list_newsletters(){

    $args = array( 'post_type' => 'newsletters' );
    $loop = new WP_Query( $args );
    while ( $loop->have_posts() ) : $loop->the_post();
        $permalink = get_permalink();
        $title = get_the_title();
        $id = get_the_ID();
        $attachment = wp_get_attachment_url($id);
        echo '<li><a href="'.$attachment.'">'.$title.'</li>';
    endwhile;

} 
```

但是 wp_get_attachment_url($id) 似乎不起作用。我认为这是因为我应该提供附件 ID 而不是帖子 ID。我在网上环顾四周，找不到明确的方法来找到特定帖子的附件 ID。

只是为了澄清每个帖子将只包含一个附件。

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:43:19.100

此示例取自[`get_posts()`](http://codex.wordpress.org/Template_Tags/get_posts#Show_attachments_for_the_current_post)Codex 页面

```
$attachments = get_posts(array( 
    'post_type' => 'attachment',
    'numberposts' => -1,
    'post_status' =>'any',
    'post_parent' => $post->ID
));

if ($attachments) {
    foreach ( $attachments as $attachment ) {
        echo apply_filters( 'the_title' , $attachment->post_title );
        the_attachment_link( $attachment->ID , false );
    }
} 
```

# vb.net - 构建/检查文件的哈希值

> ID：14717667
> 
> 赞同：3
> 
> 时间：2013-02-05T21:53:05.783
> 
> 标签：vb.net

我很难用这个。有人可以为我指出正确的方向来检查/构建上传文件的哈希码，或者告诉我下面的代码有什么问题吗？

```
getFileSHA256(softwareUpload.PostedFile) 'Line that calls the function includes a reference to an uploaded file

Private Function getFileSHA256(ByVal theFile As Web.HttpPostedFile) As String
    Dim SHA256CSP As New SHA256Managed()
    Dim byteHash() As Byte = SHA256CSP.ComputeHash(theFile.InputStream)
    Return ByteArrayToString(byteHash)
End Function

Private Function ByteArrayToString(ByVal arrInput() As Byte) As String
    Dim sb As New System.Text.StringBuilder(arrInput.Length * 2)
    For i As Integer = 0 To arrInput.Length - 1
        sb.Append(arrInput(i).ToString("X2"))
    Next
    Return sb.ToString().ToLower
End Function 
```

我应该补充一点，该函数有效，但返回与其他程序的 sha256 值不匹配。

**编辑**------

我在我的代码中使用了另外两个函数。SHA1 得到与 SHA256 相同的结果；结果与可信来源不匹配。

但是，MD5 按预期工作。

```
Private Function getFileSHA1(ByVal theFile As Web.HttpPostedFile) As String
    Dim SHA1CSP As New SHA1CryptoServiceProvider()
    Dim byteHash() As Byte = SHA1CSP.ComputeHash(theFile.InputStream)
    Return ByteArrayToString(byteHash)
End Function

Private Function getFileMd5(ByVal theFile As Web.HttpPostedFile) As String
    Dim Md5CSP As New System.Security.Cryptography.MD5CryptoServiceProvider
    Dim byteHash() As Byte = Md5CSP.ComputeHash(theFile.InputStream)
    Return ByteArrayToString(byteHash)
End Function 
```

一旦我知道它们按预期工作，我计划整合这些功能。

它们之间的唯一区别是 MD5 使用“MD5CryptoServiceProvider”并且它按预期工作。SHA1 也在使用“SHA1CryptoServiceProvider”，但它与受信任的来源不匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T01:16:39.557

我在这里做了一些测试，看来对于文本文件来说`SHA256Managed` **效果很好**。

我的代码如下，我使用了你的实现`ByteArrayToString`：

```
Sub Main()
  Dim s As New SHA256Managed
  Dim fileBytes() As Byte = IO.File.ReadAllBytes("s:\sha256.txt")
  Dim hash() As Byte = s.ComputeHash(fileBytes)

  Dim referenceHash As String = "18ffd9682c5535a2b2798ca51b13e9490df326f185a83fe6e059f8ff47d92105"
  Dim calculatedHash As String = ByteArrayToString(hash)
  MsgBox(calculatedHash = referenceHash) 'outputs True
End Sub

Private Function ByteArrayToString(ByVal arrInput() As Byte) As String
  Dim sb As New System.Text.StringBuilder(arrInput.Length * 2)
  For i As Integer = 0 To arrInput.Length - 1
    sb.Append(arrInput(i).ToString("X2"))
  Next
  Return sb.ToString().ToLower
End Function 
```

出于测试目的，我创建了一个名为`sha256.txt`under的文件`S:`，其内容如下：

```
my test file 
```

*（没有尾随空格或换行符）*

通过提供相同的数据，我[从这里](http://www.xorbin.com/tools/sha256-hash-calculator)获得了参考哈希值。

还要检查[这个](https://stackoverflow.com/questions/10559203/sha-256-hashes-different-between-c-sharp-and-javascript)和[这个](https://stackoverflow.com/questions/4680661/java-sha256-outputs-different-hash-to-php-sha256)- 你得到不匹配的事实可能与平台和/或你的可信来源的实现有关，或者需要额外的转换步骤。

# c# - 期望 JSON 的 Web 服务，发送多部分形式的数据

> ID：14717670
> 
> 赞同：0
> 
> 时间：2013-02-05T21:53:12.257
> 
> 标签：c#, javascript, ajax, web-services

我正在尝试以异步方式上传文件。我目前正在使用 jquery.form 插件并使用 ajaxSubmit 方法。后端包括获取此上传的文档并将其插入文档库。那部分没有问题。现在，当我尝试上传时，我收到 404 bad request 错误。Web 服务需要来自请求的 JSON。我注意到情况并非如此，因为在请求有效负载中我得到如下内容。

```
 Content-Disposition: form-data; name="file"; filename="Json45r11 (1).zip" 
```

这不是 JSON，所以我认为这就是我收到错误请求的原因。后端方法的Webservice定义是这样的：

```
 [OperationContract]
              [WebInvoke(Method = "POST", BodyStyle = WebMessageBodyStyle.WrappedRequest , ResponseFormat = WebMessageFormat.Json)]
              SuccessUpload uploadDoc(string id); 
```

前端提交如下所示：

```
 $('#form').ajaxSubmit({url: 'backend Method', type: 'post',data: JSON.stringify({id:1})}); 
```

这一切有解决方法吗？任何帮助表示赞赏，如果英语不好而不是母语，对不起。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:57:02.077

jQuery.form 插件`multipart/form-data`在上传经典 ASMX Web 服务无法理解的文件时使用编码请求。您可以使用通用 ASHX 处理程序 ( ) 替换您的 Web 服务，`IHttpHandler`这将允许您处理任何请求格式。或者如果你不想像处理程序那样低级，你可以使用一些新的框架，比如 ASP.NET MVC、ASP.NET WEB API、WCF、ServiceStack 等等。`multipart/form-data`编码请求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T22:07:16.093

由于 web 服务需要 JSON，因此在方法的声明中只需说明它接收 STREAM 类型的对象。

这应该工作：

```
 [OperationContract]
    SuccessUpload uploadDoc2(Stream data); 
```

# java - 在数据表中使用 apache 上传

> ID：14717675
> 
> 赞同：1
> 
> 时间：2013-02-05T21:53:21.430
> 
> 标签：java

我有一个简单的 jsf 页面，其中 ah:datatable 包含一个值列表。

对于每个值，我都必须导出文件或导入文件。

但是当我在 ah:column 中使用 t:inputFileUpload 时，命令按钮永远不会获取文件，始终为空。将 t:inputFileUpload 放在数据表之外是可行的，但在里面，我做不到。

有没有办法做到这一点？里面有另一个 h:column 和 at:inputFileUpload 吗？

这是代码：

```
<h:form id="strategiesForm" enctype="multipart/form-data" styleClass="jsfcrud_list_form">
<h:dataTable value="#{strategy.strategyItems}" var="item" border="0" cellpadding="2" 
                             cellspacing="0" rowClasses="jsfcrud_odd_row,jsfcrud_even_row" rules="all"
                             style="border:solid 1px">
                    <f:facet name="header">
                            <h:outputText escape="false" value="Importación"/>
                        </f:facet>
                        <h:panelGrid columns="1" border="0">
                        <h:outputText value="Actualizar formulario"/>
                        <t:inputFileUpload id="file" value="#{strategy.xmlFormFile}"/>
                        <h:commandButton value="Actualizar" action="#{strategy.importForm}">
                        </h:commandButton>
                        </h:panelGrid>
                    </h:column>
</h:dataTable>
        </h:form> 
```

上述代码中，strategy.xmlFormFile 是提交时始终为空的属性；如果我关闭表单并使用 t:inputFileUpload 编写另一个表单，它可以工作，但我必须区分用户想要将文件导入到哪些行。

# ios - 延迟为 0 的执行选择器？

> ID：14717691
> 
> 赞同：2
> 
> 时间：2013-02-05T21:54:24.453
> 
> 标签：ios, objective-c, dynamic-dispatch

> **可能重复：**
> [-performSelector:withObject:afterDelay: 如何工作？](https://stackoverflow.com/questions/1922517/how-does-performselectorwithobjectafterdelay-work)

我经常使用这段代码让 UI 在调用长时间运行的方法之前完成其业务：

```
[obj performSelector:@selector(go) withObject:nil afterDelay:0]; 
```

但**它有什么作用？**

我个人的解释一直`go`是在下一个运行循环中调用该方法，但那肯定是不对的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T22:06:14.763

延迟调用它`0`确实会在下一次通过 runloop 时调用此方法。

IIRC，它所做的是设置一个表示目标和动作的结构，并将 a 附加`CFRunLoopSource`到运行循环，当触发时，它将调用目标上的动作。然后它向 runloop 发出信号，告诉它它有一个准备好的源。这意味着下一次runloop处理它的源（即下一次通过runloop）时，它将执行你的延迟选择器。

# ruby-on-rails - 为什么有人会使用 gem 外国人？

> ID：14717698
> 
> 赞同：3
> 
> 时间：2013-02-05T21:54:46.053
> 
> 标签：ruby-on-rails, gem, foreign-keys, foreigner

这很可能是一个菜鸟问题，因为人们使用这种宝石并且很多人喜欢它，但我不明白目的。我正在查看一个项目，它已在此处多次使用，例如`t.references :foreign_key_table_name , :foreign_key => true`,`add_foreign_key :table :foreign_key_table_name, :options`和 create `t.foreign_key :foreign_key_table_name`。希望那些没有混淆，因为它们脱离了上下文。

但是我不明白这与内置的rails`t.references :foreign_key_table_name`或我只是添加的有什么不同`t.integer :foreign_key_table_name_id`？它是否只是通过明确这是一个“外键”来使其更具可读性？如果是这样的话，我可以添加评论而不是宝石......我看到的唯一优势是您可以将选项移动`:dependent`到迁移中而不是在模型中，但是谁在乎呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T22:53:22.287

一些数据库引擎支持合法的外键约束：如果有人试图保存 a`Child`为`parent_id`5，但没有5，那么如果存在链接和的外键约束`Parent`，数据库本身（不是 Rails）将拒绝记录。`id``children.parent_id``parents.id`

外键还可以指定删除父项时会发生什么：例如，在 MySQL 中，我们可以删除或使依赖记录无效，就像 Rails 对 所做的那样`:dependent`，甚至直接拒绝删除并抛出错误。

由于并非所有数据库引擎都提供此功能，Rails 提供了模拟它的功能`:dependent`，并且在软件级别拥有它非常好，这样依赖的子记录可以`destroy`在删除父记录时触发它们的回调。由于该功能独立于引擎，因此几乎独立于模式，Rails 不处理外键的创建/删除。这就是发挥作用的地方`foreigner`：如果您的引擎支持外键约束，并且您希望对数据完整性更加自信，`foreigner`则可以提供帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-13T09:38:35.163

在这里复活一个老问题，但是……</p>

在 rails 内部，让 rails 强制执行这种关系很好。

但是，如果您的项目发展到拥有也可以从其他语言访问这些表的代码，则不会有 Rails 强制执行关系的好处。这些外键约束被烘焙到 SQL 表本身中，因此可以保护非 Rails 代码。

如果您需要执行数据修复或以其他方式通过本机 SQL 操作数据，这也将保护您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-17T22:01:11.750

另一个原因是某些 SQL 文档工具会查看数据库上的外键，因此拥有生成它们的 gem 很酷。Rails 4 添加了在创建表的同一迁移中定义外键的能力：

```
t.references :something, foreign_key: true 
```

如果您使用该`references`类型，生成器将为您执行此操作。Rails 在像这样`something_id`使用时默认添加一个索引`foreign_key`

# html - 如何仅使用 html+css 为旧浏览器显示双语升级警告？

> ID：14717701
> 
> 赞同：0
> 
> 时间：2013-02-05T21:54:53.487
> 
> 标签：html, css, conditional, joomla2.5, multilingual

我在 Joomla 2.5 中有一个双语网站（英语+希腊语），我想显示警告以提示使用旧浏览器的访问者升级它们。但是，我想使用“if/else”来定位每种语言，这样我就可以用相应的语言显示一条消息，这意味着说英语的访客是英语，说希腊语的访客是希腊语。

我在显示该代码但几乎所有网站都使用 javascript 的双语网站上寻找此解决方案，这是我不希望的，因为我正在寻找减轻网站负担的方法。当然，谷歌搜索了它。我的想法是做这样的事情。原谅我的php代码，我知道的不多。

```
<!--[if lte IE 9]>
if <xhtml xml:lang="<?php echo $this->language; ?>" lang="<?php echo $this->language; ?>">
<p>My English text here</p>
else {
<p>My greek text here</p>}
<![endif]--> 
```

# java - Java 数组初始化

> ID：14717705
> 
> 赞同：-6
> 
> 时间：2013-02-05T21:55:09.337
> 
> 标签：java

当我们打印数组初始化的引用变量时会发生什么？

```
int[] it=new int[10];  
sop(it); 
```

结果是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:02:38.880

```
int[] it = new int[10];  
System.out.println(it); 
```

`it`是一个对象，因此您正在调用[`println(Object)`](http://docs.oracle.com/javase/7/docs/api/java/io/PrintStream.html#println%28java.lang.Object%29)( [`PrintStream`](http://docs.oracle.com/javase/7/docs/api/java/io/PrintStream.html)) `System.out`，它`toString()`在内部调用传递的对象。数组'`toString()`类似于[Object](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html)的[`toString()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#toString%28%29)：

```
getClass().getName() + "@" + Integer.toHexString(hashCode()); 
```

所以输出会是这样的：

```
[I@756a7c99 
```

其中`[`表示数组的深度，并`I`指`int`. `756a7c99`是[`hashCode()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#hashCode%28%29)作为十六进制数返回的值。

阅读[`Class.getName()`JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getName%28%29)。

* * *

要打印数组，请使用[`Arrays.toString()`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#toString%28int%5b%5d%29)，例如：

```
int[] it = new int[10];
System.out.println(Arrays.toString(it)); 
```

**输出：**

```
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:01:07.233

就像是`[I@30c221`

这是新数组的内存地址

```
 int[] it=new int[10];
    System.out.println(it); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:59:28.453

假设`sop`是`System.out.println`，它将向您显示该`toString`方法返回的 String 结果。在这种情况下，它将是类的名称+“@”+哈希码的十六进制。

# ruby-on-rails - Rails 从数据库中填充 SELECT 选项

> ID：14717707
> 
> 赞同：8
> 
> 时间：2013-02-05T21:55:24.250
> 
> 标签：ruby-on-rails, html-select

我觉得这是基本的，但在任何地方都找不到详细信息。

我有一个通过生成脚手架创建的基本应用程序。

已经内置了输入数据的表格。我在表单中有一个 SELECT（下拉）框。我希望能够从数据库中提取此选择框中的选项。理想情况下，最终用户将能够添加和编辑这些选项。

我不知道如何将表单中的 SELECT 字段链接到 OPTIONS 的存储位置。

就研究什么的术语而言，有人能指出我正确的方向吗？我来了一个空白。我觉得这一定是一件常见的事情。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-08-25T23:21:47.020

正如 ByScripts 的链接所包括的，这是对我有用的脚本（对于那些时间不是奢侈品的人）：

```
<%= collection_select(:lang_id, 0, Language.all, :id, :name) %> 
```

在哪里`Language`有一个名为“名称”的列和一个自动分配的列 ID 的表；`:lang_id`是元素的名称，`0`是页面加载时默认选择的索引。

# ios - 处理视图以编程方式调整高度、宽度和边距

> ID：14717709
> 
> 赞同：1
> 
> 时间：2013-02-05T21:55:30.687
> 
> 标签：ios, ios5, uiview, cgrect, cgrectmake

我正在尝试以编程方式设置视图。通过偏好，我更喜欢对视图进行编程而不是使用 Interface Builder，我觉得出于某种原因我有更好的控制......

我正在设置一个带有两个子视图和一个按钮的视图。当方向改变时，我想要实现的是相同的视图。最初我认为我需要计算屏幕尺寸然后计算一些分区来计算更改，但似乎我可以处理 UIViewAutoresizing***

我遇到的问题是上边距。这是我的子视图代码。

```
 // Create sub view for Logo
UIView *logoView =[[UIView alloc] initWithFrame:CGRectMake(0,0,320,280)];
[logoView setBackgroundColor:[UIColor blueColor]];
logoView.autoresizingMask = UIViewAutoresizingFlexibleWidth|UIViewAutoresizingFlexibleHeight;

// Create sub view
UIView *buttonView =[[UIView alloc] initWithFrame:CGRectMake(0, logoView.bounds.size.height, 320,200)];
[buttonView setBackgroundColor:[UIColor redColor]];
buttonView.autoresizingMask = UIViewAutoresizingFlexibleWidth|UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleTopMargin; 
```

这是一张纵向和横向的图片，您可以在其中看到问题，并带有“白色”空间。

![肖像](../Images/6a50135aa5d28c2032222398dcd86b6a.png)

![景观](../Images/88ec95a79faccfb077de3c68b6e4dee4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T20:31:42.317

您要么希望两个视图（红色和蓝色）在旋转后具有成比例的空间：

```
logoView.autoresizingMask = UIViewAutoresizingFlexibleWidth|UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleBottomMargin;
buttonView.autoresizingMask = UIViewAutoresizingFlexibleWidth|UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleTopMargin; 
```

或者您希望红色视图最终与开始时的大小相同，并调整蓝色视图以为其腾出空间：

```
logoView.autoresizingMask = UIViewAutoresizingFlexibleWidth|UIViewAutoresizingFlexibleHeight;
buttonView.autoresizingMask = UIViewAutoresizingFlexibleWidth|UIViewAutoresizingFlexibleTopMargin; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:00:02.277

使用自动布局。你不必处理任何这些问题......

# c3p0 - 配置 c3p0 以在用户名/密码无效的情况下抛出错误

> ID：14717710
> 
> 赞同：0
> 
> 时间：2013-02-05T21:55:33.440
> 
> 标签：c3p0

我想知道如果提供的登录信息不正确，是否有一种简单的方法可以防止 c3p0 连接池获取连接？我希望它在这种情况下抛出异常并忽略`acquireRetryAttempts`参数。
我问的原因是因为 RDMS 可能被配置为在几次不成功的尝试后阻止帐户，我想尽量减少它发生的机会。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:35:27.447

如果将acquireRetryAttempts 设置为1，如果连接获取失败，c3p0 将立即抛出异常，并且在新客户端尝试连接之前不会重试。如果您希望它在新客户到来时也不重试，请将配置参数 breakAfterAcquireFailure 设置为 true。

见 [http://www.mchange.com/projects/c3p0/#acquireRetryAttempts](http://www.mchange.com/projects/c3p0/#acquireRetryAttempts) [http://www.mchange.com/projects/c3p0/#breakAfterAcquireFailure](http://www.mchange.com/projects/c3p0/#breakAfterAcquireFailure)

（如果 acquireRetryAttempts 被命名为“numAcquireAttempts”会更清楚。叹息。）

祝你好运！

# c# - 单击时变成文本框的标签？

> ID：14717711
> 
> 赞同：0
> 
> 时间：2013-02-05T21:55:34.650
> 
> 标签：c#, asp.net

也许有一个 CSS 样式，但是，我希望我的 TextBox 看起来像一个标签。当它聚焦时，我希望它看起来像应用了任何 CSS 样式。我正在使用引导程序，所以这就是风格。

有没有办法做到这一点？

我有一个网格视图，我想允许用户在不使用编辑模式的情况下重命名。

谢谢

（编辑）

我的意思是一个可编辑的标签：见[http://dotnetspeaks.net/post/exm/EditableLabel.aspx](http://dotnetspeaks.net/post/exm/EditableLabel.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:00:54.600

这是一个疯狂的猜测（因为问题本身有点模糊）：

```
input {
    border: none;
    padding: 2px;
}
input:focus {
    border: 1px solid black;
} 
```

而且，[瞧！](http://jsfiddle.net/drVVf/)（以及[更传统](http://jsfiddle.net/drVVf/1/)的版本）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:07:07.300

您可以通过使其显示为标签并使其成为单击或聚焦的文本框来使用文本框。（只是一种方法，问题有点混乱。）

```
<script type="text/javascript">
function TextBox2Label()
{
    var control=document.getElementById("<%=TextBox1.ClientID %>");
    control.style.borderStyle="none";
    control.style.backgroundColor="Transparent";
    control.style.fontStyle.fontColor="Black";    
    control.readOnly=true;
}        
</script> 
```

# php - 如何在 MySQL 中保存密码的哈希值

> ID：14717723
> 
> 赞同：-4
> 
> 时间：2013-02-05T21:56:03.113
> 
> 标签：php, mysql

我的数据库中有下表，名为**db_pass**：

```
id | pass
=================
1  | dalmation123 
```

我知道我无法在数据库中以纯文本格式存储任何密码，我该如何设置哈希？这是我在下面使用的代码。对于如何更改我的表**db_pass**，我也将不胜感激。

```
if(isset($_POST['pmsubmit']))
{
  LoginSubmit('pm', 'pmname', 'pmpass');
}

if(isset($_POST['tssubmit']))
{
  LoginSubmit('ts', 'dept', 'tspass');
}

function LoginSubmit($pm_or_ts, $the_name_input, $the_pass_input)
{
  global $pdo;
  $posted_name = $_POST[$the_name_input];
  $posted_pass = $_POST[$the_pass_input];
  // check if password matches the one in the table
  $query = $pdo->prepare("SELECT * FROM db_pass WHERE pass = :pass");
  $query->execute(array(":pass" => $posted_pass));
  // if there is a match then we log in the user
  if ($query->rowCount() > 0)
  {
    // session stuff
    $_SESSION[$the_name] = $posted_name;
    // refresh page
    header( 'Location: ' . $pm_or_ts . '/index.php' ) ;
    exit;
  } 
  // if there is no match then we present the user with an error
  else
  {
    echo "error";
    exit;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:19:49.693

```
$query = $pdo->prepare("SELECT * FROM db_pass WHERE pass = :pass");
$query->execute(array(":pass" => crypt($posted_pass))); 
```

不要问我`crypt`实际使用的是哪种算法。手动输入完全是荒谬的 - 显然只是检查一个常量的值会改变所使用的算法`crypt()`是荒谬的......

人们说 bcrypt 也没关系。但是 bcrypt**不是**PHP 的核心函数。如果他们的意思是写你自己的，那么这是一个愚蠢的想法——因为你的实现无疑会有缺陷。如果他们的意思是一个图书馆，他们需要指出一个 - 通常推荐 PHPass，但我自己不知道推荐它。

大多数人仍在使用这并不奇怪`sha1`，是吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:15:38.167

这一切都归结为这一点。在将用户密码保存到数据库之前，您需要对用户密码进行操作。然后，您在检查该密码是否对用户名/密码组合有效之前对提交的密码执行相同的操作。

在大多数情况下，“操作”是散列或加密过程，例如 MD5 或 bcrypt

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-05T22:06:43.130

在 MySQL 中，您可以使用该`BINARY`类型来实际存储哈希值。MySQL 中的一个简单哈希表可能如下所示：

```
CREATE TABLE IF NOT EXISTS `hastable` (
  `hash` binary(20) NOT NULL,
  `value` blob NOT NULL,
  PRIMARY KEY (`hash`)
); 
```

例如，SHA1 哈希总是 160 位/20 字节长，可以存储这样的二进制列。使用 PHP，您可以获得如下哈希：`hash( 'sha1', $key, true );`

但这与存储密码无关……</p>

# hyperlink - 单击链接会更改浏览器栏中的 url，但实际上并未加载 URL（可能与 AnythingSlider 相关）

> ID：14717726
> 
> 赞同：1
> 
> 时间：2013-02-05T21:56:19.290
> 
> 标签：hyperlink, href, anythingslider

我正在使用任何滑块。我有一个指向某个页面和幻灯片的链接，如下所示：

```
<a href='http://sitename.com/pagename/#panel1-1'>Click Me</a> 
```

为清楚起见进行了更新：问题是当我创建这样的链接时，当链接不在带有幻灯片的页面上时，指向页面和幻灯片的直接链接有效，但在同一页面上时无效作为幻灯片。因为我的网站上到处都有这些链接，而且它是动态的，所以我需要一种能够简单地链接到幻灯片的方法，它可以在任何页面上工作——包括幻灯片所在的页面。

我找到了一个解决方案 - 我像以前一样链接到幻灯片，然后动态更新该链接上的操作，以便链接与滑块出现在同一页面上的页面。

** 我的解决方案（我用于我的网站的要点，根据您的目的进行编辑）：**

```
//Get anythingslider links, and dynamically update them so that they jump to the slider
    $("a").each(function(){

        var pathname = window.location.pathname.replace(/^https?:\/\/critter.co/,'');

        var link = this.href.replace(/^https?:\/\/critter.co/,'');

        if(link.indexOf("/settings/home") == 0 && pathname.indexOf("/settings/home") == 0){
            $(this).removeAttr("href");
            slidenum = parseInt(link.charAt(link.length-1));
            $(this).click(function(){
                $("ul#slider").anythingSlider(link.charAt(link.length-1));
            });
        }

        if(link.indexOf("/record/home") == 0 && pathname.indexOf("/record/home") == 0){
            $(this).removeAttr("href");
            slidenum = parseInt(link.charAt(link.length-1));
            $(this).click(function(){
                $("ul#slider").anythingSlider(link.charAt(link.length-1));
            });
        }

    }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T22:48:34.893

我不太确定我理解你，页面在右侧。但我认为您遇到的问题是链接本身只是更改 URL 而不是幻灯片，对吗？

首先，`pagename/`链接到另一个页面，所以应该可以工作。如果您想从同一页面控制滑块，则只需要该`#1-1`部分；好吧，如果页面上有多个滑块。

## 一个滑块（[演示](http://jsfiddle.net/Mottie/ycUB6/4085/)）

*   如果您只有一个滑块，则可以执行以下操作：

    ```
    <nav>
        Go to slide:
        <a href="#1">One</a> | <a href="#2">Two</a> | <a href="#3">Three</a> |
        <a href="#4">Four</a> | <a href="#5">Five</a>
    </nav> 
    ```

    并且此代码使滑块转到该特定幻灯片：

    ```
    $('nav a').click(function(){
        $('#slider').anythingSlider( $(this).attr('href').substring(1) );
    }); 
    ```

## 多个滑块（[演示](http://jsfiddle.net/Mottie/ycUB6/4086/)）

*   在这个 HTML 中，我在 href 属性中为滑块添加了一个索引 -`#1-1`表示滑块 1，面板 1。所以这里是一个用于多个滑块的导航示例（可以根据需要添加更多）：

    ```
    <nav>
        top slider: <a href="#1-1">One</a> | <a href="#1-2">Two</a> | <a href="#1-3">Three</a> |
        <a href="#1-4">Four</a> | <a href="#1-5">Five</a>
        <br>
        bottom slider: <a href="#2-1">One</a> | <a href="#2-2">Two</a> | <a href="#2-3">Three</a> |
        <a href="#2-4">Four</a> | <a href="#2-5">Five</a>
    </nav> 
    ```

    然后这段代码可以用来控制滑块：

    ```
    $('nav a').click(function(){
        var link = $(this).attr('href').match(/(\d+)-(\d+)/),
            slider = parseInt( link[1], 10 ) - 1; // eq needs zero based index
        $('.slider').eq( slider ).anythingSlider( link[2] );
    }); 
    ```

# android - 使用应用内计费从付费应用更新为免费应用

> ID：14717729
> 
> 赞同：1
> 
> 时间：2013-02-05T21:56:30.187
> 
> 标签：android, in-app-billing

我想发布我的一个付费应用程序的新版本，但现在可以免费使用 In App Billing v2 集成。

问题是，我可以使用测试帐户测试新版本吗？一般情况下，对于一个全新的应用，我会把APK作为草稿上传，然后从配置了测试账户的设备上测试购买，就可以了。但是在这种情况下，当我尝试测试应用程序时，会出现著名的“此版本的应用程序未配置市场计费”。这是否与当前在 Google Play 中发布的 APK 是 v1 没有 In App Billing 并且在我的设备中安装了带有 In App Billing 的 v2 相关的问题，尽管事实上我已经上传了带有 In App Billing 的 v2 作为草稿?

为了更清楚，我的情况是：

*   我目前在 Google Play 上发布了我的应用程序的 v1，这是一个付费应用程序。
*   我已将我的应用程序的新 v2 作为草稿上传到 Google Play，现在可以免费使用应用内计费集成。
*   我已经在我的设备中手动安装了我的应用程序的新 v2。
*   我无法测试该应用程序，因为出现“此版本的应用程序未配置市场计费”错误。

为什么？因为我已经发布了不包含 In App Billing 的应用 v1？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T03:27:05.383

好吧，您收到消息的主要原因是因为您刚刚上传了您的 apk

你可以查看安卓网站：[Testing In App Billing](http://developer.android.com/training/in-app-billing/test-iab-app.html)

在第 3 点，您可以看到：

> 确保您已将应用程序的签名 APK 上传到开发者控制台，并将一个或多个应用内产品与您的应用程序相关联。您无需在 Google Play 上发布应用程序即可对其进行测试。
> 
> 警告：上传 APK for Google Play 后可能需要 2-3 小时才能识别您更新的 APK 版本。如果您在上传的 APK 被 Google Play 识别之前尝试测试您的应用程序，您的应用程序将收到一条“已取消购买”响应以及错误消息“此版本的应用程序未启用应用内结算”。</p >

这是针对 V3 的，但我想识别新 apk 的部分仍然相同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T03:14:54.317

您必须确保草稿应用程序的版本和签名与您用于测试的版本和签名相同。您还需要等待几个小时才能使草稿生效。不确定付费->免费转换的支持程度如何，尽管它应该通过将价格设置为 0 来工作。

# c# - 处理创建大量子类型对象的最佳方法

> ID：14717732
> 
> 赞同：0
> 
> 时间：2013-02-05T21:56:34.637
> 
> 标签：c#, oop, creation, subtype

我有一个基本的 Message 类，以及大约 100 个不同的 Message 子类型类，它们代表可以处理的每种类型的消息。我目前正在考虑做的是使用一个巨大的 switch 语句来创建消息对象。例如：

```
switch (MsgType)
{
   case MessageType.ChatMsg:
      Msg = new MsgChat(Buf);
      break;
   case MessageType.ResultMsg:
      Msg = new MsgResult(Buf);
      break;
   ... // 98 more case statements
}
Msg.ProcessMsg(); // Use a polymorphic call to process the message. 
```

有一个更好的方法吗？如果是这样，您能否展示一个简单的代码示例。

**编辑**

所以，我试着这样做：

```
public class Test
{
   public Test()
   {
      IEnumerable<Type> myEnumerable = GetTypesWith<MyAttribute>(true);
   }

   IEnumerable<Type> GetTypesWith<TAttribute>(bool inherit)
      where TAttribute : System.Attribute
   {
      return from a in AppDomain.CurrentDomain.GetAssemblies()
             from t in a.GetTypes()
             where t.IsDefined(typeof(TAttribute), inherit)
             select t;
   }
} 
```

这似乎有效，因为 myEnumerable 现在包含所有 100 个消息子类型，以及基本消息类型。然而，虽然我不介意在程序开始时使用反射来加载类型，但使用它来实时访问正确的对象可能太慢了。所以，我想尝试使用委托。

@Mark Hildreth 下面评论中的示例：

“所以，你会有一个 > 的字典。然后，你的映射将是 mappings[MessageType.ChatMsg] = x => new MsgChat(x);”

有几种方法可以解释此代码。一种想法是删除所有 100 个子类，只使用一个具有 100 个委托方法的大型类。这是一个遥远的第二选择。另一个想法和我的第一选择是让上面的代码以某种方式创建一个消息子类对象。但是，我不太明白它会如何做到这一点。此外，最好将上述技术保留在我的 Test 类中，以获取所有类型或委托，而不必编写全部 100 个。你或其他人能解释一下如何做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:13:42.170

代替使用巨大的`switch`语句，您可以定义 a`Dictionary`以将每个`MessageType`值映射到其定义的`Message`派生类，并使用此映射数据创建一个实例。

**字典定义：**

```
Dictionary<int, Type> mappings = new Dictionary<int, Type>();
mappings.Add(MessageType.ChatMsg, typeof(MsgChat));
mappings.Add(MessageType.ResultMsg, typeof(MsgResult)); 
```

...

**字典消费：**

```
ConstructorInfo ctor = mappings[MessageType.ChatMsg].GetConstructor(new[] { typeof(Buf) });
Message message = (Message)ctor.Invoke(new object[] { Buf }); 
```

请注意，我没有编译此代码来验证是否正确。我只想向你展示这个想法。

**编辑**

有我的新答案来改进第一个。我正在考虑您编辑的问题，使用来自**@MikeSW**和 **@Mark Hildreth**的给定想法。

```
public class FactoryMethodDelegateAttribute : Attribute
{
    public FactoryMethodDelegateAttribute(Type type, string factoryMethodField, Message.MessageType typeId)
    {
        this.TypeId = typeId;
        var field = type.GetField(factoryMethodField);
        if (field != null)
        {
            this.FactoryMethod = (Func<byte[], Message>)field.GetValue(null);
        }
    }

    public Func<byte[], Message> FactoryMethod { get; private set; }
    public Message.MessageType TypeId { get; private set; }
}

public class Message
{
    public enum MessageType
    {
        ChatMsg,
    }
}

[FactoryMethodDelegate(typeof(ChatMsg), "FactoryMethodDelegate", Message.MessageType.ChatMsg)]
public class ChatMsg : Message
{
    public static readonly MessageType MessageTypeId = MessageType.ChatMsg;
    public static readonly Func<byte[], Message> FactoryMethodDelegate = buffer => new ChatMsg(buffer);
    public ChatMsg(byte[] buffer)
    {
        this.Buffer = buffer;
    }

    private byte[] Buffer { get; set; }
 }

public class TestClass
{
    private IEnumerable<Type> GetTypesWith<TAttribute>(bool inherit) where TAttribute : Attribute
    {
        return from a in AppDomain.CurrentDomain.GetAssemblies()
               from t in a.GetTypes()
               where t.IsDefined(typeof(TAttribute), inherit)
               select t;
    }

    [Test]
    public void Test()
    {
        var buffer = new byte[1];
        var mappings = new Dictionary<Message.MessageType, Func<byte[], Message>>();
        IEnumerable<Type> types = this.GetTypesWith<FactoryMethodDelegateAttribute>(true);
        foreach (var type in types)
        {
            var attribute =
                (FactoryMethodDelegateAttribute)
                type.GetCustomAttributes(typeof(FactoryMethodDelegateAttribute), true).First();

            mappings.Add(attribute.TypeId, attribute.FactoryMethod);
        }

        var message = mappings[Message.MessageType.ChatMsg](buffer);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T11:20:14.227

你走在正确的轨道上，使用字典是个好主意。如果反射太慢，你可以使用表达式，像这样（我假设你用 MessageTypeAttribute 装饰 Messages 类）。

```
public class Test
{
 public Test()
  {
     var dict=new Dictionary<MessageType,Func<Buffer,Mesage>>();
     var types=from a in AppDomain.CurrentDomain.GetAssemblies()
         from t in a.GetTypes()
         where t.IsDefined(MessageTypeAttribute, inherit)
         select t;
    foreach(var t in types) {
      var attr = t.GetCustomAttributes(typeof (MessageTypeAttribute), false).First();
       dict[attr.MessageType] = CreateFactory(t);
       }

      var msg=dict[MessageType.Chat](Buf);
  }

 Func<Buffer,Message> CreateFactory(Type t)
 {
      var arg = Expression.Parameter(typeof (Buffer));
        var newMsg = Expression.New(t.GetConstructor(new[] {typeof (Buffer)}),arg);
        return Expression.Lambda<Func<Buffer, Message>>(newMsg, arg).Compile();
}

} 
```

# java - 如果在 HotSpot JVM 中启用了偏向锁定，对象的哈希码存储在哪里？

> ID：14717736
> 
> 赞同：14
> 
> 时间：2013-02-05T21:56:42.970
> 
> 标签：java, jvm, locking, jvm-hotspot, biased-locking

据我所知，对象的哈希码通常存储在对象的标题字中，例如，在 HotSpot 中可能具有以下布局：

```
| 哈希码 | 年龄 | 0 | 01 |
```

根据[HotSpotInternals -](https://wikis.oracle.com/display/HotSpotInternals/Synchronization)启用了偏向锁定的同步，标题字布局如下所示：

```
| 0 |时代| 年龄 | 0 | 01 |
```

当启用偏向锁定时，如果需要，哈希码实际存储在哪里？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-28T16:56:20.083

我的理解是，要求（身份）哈希码可以防止偏向锁定——因为我们不能在标记字中同时存储哈希码和线程 ID。如果您询问互斥锁的哈希码，您将转移到无偏锁定模式。

来自[此博客](https://blogs.oracle.com/dave/entry/biased_locking_in_hotspot)的以下内容支持这一点：

> “最后，标记字中目前没有空间来支持标识`hashCode()`值以及偏向锁定编码所需的线程 ID。鉴于此，您可以通过调用来避免基于每个对象的偏向锁定`System.identityHashCode(o)`。如果对象已经有偏差，分配一个标识 hashCode 将导致撤销，否则，分配 a`hashCode()`将使对象没有资格进行后续的偏差锁定。当然，这个属性是我们当前实现的产物。

# java - ItemSetChangeEvent 获取事件值

> ID：14717737
> 
> 赞同：0
> 
> 时间：2013-02-05T21:56:44.750
> 
> 标签：java, vaadin

我有像这样实现的本地选择的语言环境：

```
NativeSelect selectLang = new NativeSelect();

        for (Locale locale : localeProvider.getSupportedLocales()) {
            selectLang.setItemCaption(locale, localeProvider.getLabel(locale));
            selectLang.addItem(locale);
        }
        selectLang.setValue(user.getLocale());
        selectLang.setNullSelectionAllowed(false);
        selectLang.addItemSetChangeListener(new ItemSetChangeListener() {

            private static final long serialVersionUID = 4797561043434404341L;

            @Override
            public void containerItemSetChange(ItemSetChangeEvent event) {
                // Locale loc = (Locale)event.getContainer().getValue();
                // UI.getCurrent().setLocale(loc);
            }
        }); 
```

我想使用 event.getContainer().getValue()，但是方法 getValue() 没有为 Container 类型定义。我怎样才能获得事件的价值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T12:32:28.760

[SelectExample.java (dev.vaadin.com)](http://dev.vaadin.com/svn/versions/6.1/src/com/vaadin/automatedtests/featurebrowser/SelectExample.java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T13:11:43.013

如果要在方法中获取 nativeSelect 的当前值，可以使用 selectLang.getValue() ：

selectLang.addListener(new ValueChangeListener() {

```
 @Override
        public void valueChange(ValueChangeEvent event) {
            selectLang.getValue();

        }
    }); 
```

当然，将“final”添加到您的组件中。

# internet-explorer-10 - IE10 上 indexeddb 的存储限制

> ID：14717739
> 
> 赞同：7
> 
> 时间：2013-02-05T21:56:57.603
> 
> 标签：internet-explorer-10, indexeddb, quota

我们正在构建一个网络应用程序，它将大量文件存储为带有 indexedDB 的 blob。如果用户最大限度地使用我们的应用程序，我们可以在 indexeddb 中存储多达 15GB 的文件。

我们遇到了 IE10 的问题，我强烈怀疑这是配额问题。

成功保存一些文件后，新的调用`store.put(data, key);`将永远不会结束。

基本上，该函数将被调用，但不会调用成功事件或错误事件。

如果我查看 IE 10 的 IndexedDB 文件夹，我会看到一些看起来像临时文件（每个 512 kB）的东西被无限期地创建和删除。

查看“缓存和数据库”参数窗口时，我看到我网站的数据库已达到**250 MB**。

进一步看，我发现这个博客条目[http://msdnrss.thecoderblogs.com/2012/12/using-html5javascript-in-windows-store-apps-data-access-and-storage-mechanism-ii/](http://msdnrss.thecoderblogs.com/2012/12/using-html5javascript-in-windows-store-apps-data-access-and-storage-mechanism-ii/)顺便说一句Windows 应用商店应用程序的存储限制为 250 MB。

我没有使用任何 Windows Store 机制，但我想我可能会成为同样任意限制的受害者。

所以，我的问题是：

*   有没有办法绕过这个限制？用户被要求允许超过 10 MB 的限制，但是当达到 250 MB 时，我没有看到用户弹出任何问题。

*   有没有其他方法可以使用 IE10 存储超过 250 MB 的数据。

谢谢，我会采取任何线索。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T06:42:45.980

恐怕你不能。提供存储限制并要求用户允许更多空间是浏览器供应商的责任。所以我认为第一个选项不适用。

我知道用户可以允许网站超过给定限制（互联网选项 > 常规 > 浏览历史 > 设置 > 缓存和数据库），但我不知道这是否会超过 250MB。这可能是您不能超过的硬编码限制。

此限制绑定到一个域，这意味着您无法通过创建多个数据库来解决它。唯一的解决方案是存储在多个域上，但在这种情况下，您不能交叉访问它们。此外，正如我看到的 250MB 限制将用于 indexeddb API 和 File API 组合

# java - Maven：从构建中排除测试

> ID：14717743
> 
> 赞同：7
> 
> 时间：2013-02-05T21:57:15.103
> 
> 标签：java, maven, build, jar, compilation

我在项目的 src/test/java 文件夹中有一些类用作测试。当我使用标准的 Maven 编译插件运行 Maven 时。这些项目被编译成 .class 文件，并包含在打包编译代码的 jar 中。

在运行 maven 和构建我的版本之前，我已经为自己创建了这些测试以在 eclipse 中运行。它们只是健全性测试，不应包含在构建中。我宁愿不把它们放在一个单独的项目中，因为对我来说，它们在这里很有意义。我如何告诉 maven 我不希望它编译/包含该目录中的文件？

我相信 maven 编译器插件正在生成 jar，如下所示：

```
<plugin>
 <artifactId>maven-compiler-plugin</artifactId>
 <configuration>
  <source>1.6</source>
  <target>1.6</target>
 </configuration>
</plugin> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T22:46:17.557

我从您[对此答案](https://stackoverflow.com/a/14718264/687514)的评论中了解到，“测试”不是单元测试，而只是您希望从最终工件中排除的普通类？因此，您最好的选择是使用带有[*maven-jar-plugin*](http://maven.apache.org/plugins/maven-jar-plugin/usage.html)`<exclude>`的标签，如下所示：[](http://maven.apache.org/plugins/maven-jar-plugin/usage.html)

 *```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-jar-plugin</artifactId>
    <version>2.4</version>
    <configuration>
        <excludes>
            <exclude>**/yoursortoftestpackage/YourSortOfTestClass*</exclude>
        </excludes>
    </configuration>
</plugin> 
```

希望有帮助！

干杯，

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-24T17:11:38.763

使用选项`-Dmaven.test.skip`将跳过测试的编译和执行。（ use`-DskipTests`只是跳过测试执行，测试仍然编译）

[参考链接](https://maven.apache.org/surefire/maven-surefire-plugin/test-mojo.html#skip)

`mvn clean install -Dmaven.test.skip`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T22:32:43.477

在 Maven 中构建时，junit 的注释 `@Ignore`将忽略该类。

编辑：

您可以配置[maven-surefire-plugin。](http://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html)

```
<project>
<build>
<project>
<build>
<plugins>
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>2.4.2</version>
    <configuration>
      <excludes>
        <exclude>**/TestCircle.java</exclude>
        <exclude>**/TestSquare.java</exclude>
      </excludes>
    </configuration>
  </plugin>
</plugins> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T09:49:10.663

将您的自定义测试文件放在`src/localtest/java`我认为的文件夹中，maven 不会知道它在那里。*

# java - 一遍又一遍地检查具有递增值的相同条件

> ID：14717745
> 
> 赞同：0
> 
> 时间：2013-02-05T21:57:17.227
> 
> 标签：java, integer, range, conditional-statements, increment

我目前正在用java创建一个非常基本的RPG游戏。我目前正在处理碰撞，这让我想到了碰撞检查和我的问题：

是否可以检查 'foo' 和 'foo' 的条件增加了很多次而不会造成这样的混乱

`if(!Level.getTile((x) / 16, (y-8) / 16).solid() && !Level.getTile((x+1) / 16, (y-8) / 16).solid() && !Level.getTile((x+2) / 16, (y-8) / 16).solid())`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:07:14.680

这完全取决于方法`Level.getTile`和`solid`. 根据它的工作方式，可能会有一个有效的实现

```
boolean Level.isAnyTileSolid(int y, int x, ....) 
```

即，一种采用一个 y 值和多个 x 值的方法。

# jira - 如何将 JIRA 编号字段设为只读？

> ID：14717748
> 
> 赞同：2
> 
> 时间：2013-02-05T21:57:27.840
> 
> 标签：jira, jira-plugin

如标题所述，我正在寻找一种智能、安全且有效的方法来将JIRA 中的**Number Field设置为****Read-Only**。以下是试图实现这一目标的方法、指南和插件的简短列表。

*   安装并部署了[行为插件](https://marketplace.atlassian.com/plugins/com.onresolve.jira.plugin.Behaviours)
    *   这导致整个 JIRA 的表单权限错误，将一些最基本和可编辑的字段设置为不可写。进一步调查显示，这是一个已知问题，不会很快得到解决。
*   [我对 JIRA 现有的字段行为](https://confluence.atlassian.com/display/JIRA/Specifying+Field+Behaviour)的选项进行了上下调整，它根本不提供将字段设置为只读的选项。
    *   隐藏不是一种选择，因为该字段需要可见（更多信息见下文）。
*   一个可能的选择是创建一个新的[屏幕方案](https://answers.atlassian.com/questions/113437/how-to-set-some-fields-as-read-only-after-submit-an-issue?page=1#113465)，该方案只是将该字段从编辑屏幕中排除。
    *   将新的屏幕方案与我们当前的项目相关联将是一场小灾难，因为许多其他项目都是依赖和共享的。因此，在这种情况下，将字段设置为只读或仅管理员可写将是一个更好的解决方案。

关于自定义字段：我在当前项目的工作流程中创建了一个发布功能，每次重新打开问题/任务/错误时，都会将自定义数字字段增加 1。从本质上讲，我正在跟踪重新开放的数量。这让我想到了*只读*要求的原因。开发人员不应该能够更改此字段的值，因为它会抛出统计信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T07:44:55.670

您可以使用 jquery 使字段只读，添加到字段描述：

```
<script type="text/javascript">
  AJS.$(document).ready(function() {
    AJS.$("#customfield_10000").attr("readonly", true);
  });
</script> 
```

更改`customfield_10000`为您的自定义字段 ID。您可以通过查看问题编辑页面源并检查它具有哪个 id 来找到此 id。

查看[此](https://stackoverflow.com/questions/14495618/how-to-hide-some-issue-link-types-in-the-issue-link-pop-up-window-for-jira-5-1-8)和[此](https://stackoverflow.com/questions/14316021/in-behaviors-plugin-0-5-3-for-jira-5-1-8-i-am-unable-to-make-reporter-field-as#answer-14334998)答案以及此以获取更多详细信息。

**[更新]**

**要同时禁用悬停编辑功能**，您可以将以下脚本添加到 jira 中`Announcement Banner`，这样它将在每个屏幕上运行：

```
<script type="text/javascript">
  AJS.$(document).ready(function() {
    AJS.$("#customfield_10000").attr("readonly", true);
    AJS.$("#customfield_10000").removeClass("editable-field inactive");
    AJS.$("#customfield_10000 .icon-edit-sml").remove();
  });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T01:46:48.053

停止内联编辑工作似乎更棘手。是什么阻止了 Behaviors 插件为您工作，您有已知问题的链接吗？您没有列出的一个选项是创建一个新的自定义字段类型，它扩展了熟悉的数字自定义字段类型，但在其速度模板中限制了谁可以编辑该字段。这种自定义记录在[https://developer.atlassian.com/display/JIRADEV/Creating+a+Custom+Field+in+JIRA](https://developer.atlassian.com/display/JIRADEV/Creating+a+Custom+Field+in+JIRA)以及 Practical JIRA Plugins (O'Reilly)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T01:51:18.227

在表单项中使用“禁用”关键字。例如代码： `<input type="text" name="foo" value="bar" disabled>`

# python - 在 Aptana 3 中调试 python

> ID：14717749
> 
> 赞同：1
> 
> 时间：2013-02-05T21:57:28.787
> 
> 标签：python, python-2.7, arcgis, aptana3

我在 aptana studio 3 中有一个 pydev 项目。

在下图中，您可以看到我的项目结构以及我的鼻子测试全部通过的事实。

![项目结构](../Images/a03c53b4d2867509d0c05f3c18fb92e4.png)

如果我单击一个`scheduled.py`包含断点的文件，然后单击`debug as`> `python run`，它将无法导入我的模块。

```
pydev debugger: starting
Traceback (most recent call last):
  File "C:\Users\mapserv\AppData\Local\Aptana Studio 3\plugins\org.python.pydev_2.7.0.2012110722\pysrc\pydevd.py", line 1397, in <module>
    debugger.run(setup['file'], None, None)
  File "C:\Users\mapserv\AppData\Local\Aptana Studio 3\plugins\org.python.pydev_2.7.0.2012110722\pysrc\pydevd.py", line 1090, in run
    pydev_imports.execfile(file, globals, locals) #execute the script
  File "C:\Users\mapserv\Desktop\Projects\Aptana\AutomatedCaching\agrc\caching\scheduled.py", line 1, in <module>
    from agrc.caching.commands import cache
ImportError: No module named agrc.caching.commands 
```

我注意到 aptana 有包/模块的概念。我的项目结构是否有问题导致这种情况？我的文件夹应该是包吗？我需要用我的解释器设置更多的东西吗？

![解释器设置](../Images/64ca0f054a344fddb99711bd590607fd.png)

**已编辑**

如果我尝试从命令行运行 schedule.py 它有同样的问题。鼻子如何运行我的测试并让一切都开心，但除此之外它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T05:58:23.110

那么答案是更新你的[PYTHONPATH](http://greeennotebook.com/2010/06/how-to-change-pythonpath-in-windows-and-ubuntu/)。在 Windows 上，将 AutomatedCaching 文件夹的路径放在automated_caching.pth 文件中。

例如：`C:\Projects\AutomatedCaching`

然后将文件移动到您的站点包文件夹中。对于 arcgis 用户，它将类似于

`C:\Python27\ArcGISx6410.1\Lib\site-packages`

或者

`C:\Python27\ArcGIS10.1\Lib\site-packages`

取决于您是否安装了服务器和桌面。我在想最后一次安装会赢得`PATH`战争吗？我安装了服务器然后桌面，它使用路径中的第二个没有 x64。

跑步

```
import sys
for i in sys.path: 
     print i 
```

应验证您的位置是否已添加。

现在，用于服务器和桌面的 arcgis 安装两个不同的 python 的事实`c:\python27`完全不同。

现在 aptana 显示我的包资源管理器，就像它是一个包一样 ![固定的](../Images/4dd1dae94e7e4f835005a30a29f4b8dd.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T21:56:14.990

您是否尝试将其放入“PyDev - PYTHONPATH”项目属性中？项目 -> 属性 -> PyDev - PYTHONPATH -> 源文件夹（选项卡） -> 添加源文件夹。

然后你就不必弄乱你的系统 PYTHONPATH。

它对我有用。

试图发布图像，但我想我没有足够的声望点。

# java - Google App Engine JPA 2.0 - java.lang.ClassNotFoundException: javax.persistence.spi.ProviderUtil

> ID：14717750
> 
> 赞同：2
> 
> 时间：2013-02-05T21:57:35.750
> 
> 标签：java, google-app-engine, jpa-2.0, maven-3, datanucleus

[我今天已经在互联网上搜索了几个小时](http://code.google.com/p/datanucleus-appengine/wiki/UpgradingToVersionTwo)，但无法解决这个问题。

我正在尝试将我的 Google App Engine 项目配置为使用 JPA 2.0 和最新的 Datanucleus 包。一切编译正常，但我不断收到运行时异常：

`Caused by: java.lang.ClassNotFoundException: javax.persistence.spi.ProviderUtil`

我包括了我的相关部分，这些部分`pom.xml`指的是所有持久性内容以及我的`persistence.xml`文件。

以下是我认为我的相关部分`pom.xml`：

```
<gae.version>1.7.4</gae.version>
<datanucleus.version>3.1.1</datanucleus.version>

<dependency>
    <groupId>javax.jdo</groupId>
    <artifactId>jdo-api</artifactId>
    <version>3.0.1</version>
</dependency>
<dependency>
    <groupId>org.apache.geronimo.specs</groupId>
    <artifactId>geronimo-jpa_2.0_spec</artifactId>
    <version>1.1</version>
</dependency>
<dependency>
    <groupId>com.google.appengine.orm</groupId>
    <artifactId>datanucleus-appengine</artifactId>
    <version>2.1.1</version>
</dependency>
<dependency>
    <groupId>org.datanucleus</groupId>
    <artifactId>datanucleus-core</artifactId>
    <version>${datanucleus.version}</version>
    <scope>runtime</scope>
</dependency>
<dependency>
    <groupId>org.datanucleus</groupId>
    <artifactId>datanucleus-api-jpa</artifactId>
    <version>${datanucleus.version}</version>
</dependency>
<dependency>
    <groupId>org.datanucleus</groupId>
    <artifactId>datanucleus-api-jdo</artifactId>
    <version>${datanucleus.version}</version>
</dependency>

<plugin>
    <groupId>org.datanucleus</groupId>
    <artifactId>maven-datanucleus-plugin</artifactId>
    <version>${datanucleus.version}</version>
    <configuration>
        <api>JPA</api>
        <verbose>true</verbose>
    </configuration>
    <executions>
        <execution>
            <phase>process-classes</phase>
            <goals>
                <goal>enhance</goal>
            </goals>
        </execution>
    </executions>
 </plugin> 
```

这是我的`persistence.xml`文件内容：*[我按照 Google App Engine 网站上的说明更新了提供程序](https://developers.google.com/appengine/docs/java/datastore/jpa/overview-dn2)*

```
<?xml version="1.0" encoding="UTF-8" ?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence
        http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd" version="1.0">

    <persistence-unit name="transactions-optional">
        <provider>org.datanucleus.api.jpa.PersistenceProviderImpl</provider>
        <properties>
            <property name="datanucleus.NontransactionalRead" value="true"/>
            <property name="datanucleus.NontransactionalWrite" value="true"/>
            <property name="datanucleus.ConnectionURL" value="appengine"/>
        </properties>
    </persistence-unit>
</persistence> 
```

这是我得到的堆栈跟踪：

```
Caused by: java.lang.ClassNotFoundException: javax.persistence.spi.ProviderUtil
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at com.google.appengine.tools.development.IsolatedAppClassLoader.loadClass(IsolatedAppClassLoader.java:213)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    ... 56 more 
```

**有人可以指出我缺少什么依赖的正确方向吗？**

**最新库所需的 Datanucleus、Google 和 JPA 依赖项的确切版本是什么？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T05:03:49.077

您说您使用的是 JPA 2.0，但是您将**geronimo-jpa_3.0_spec v1.1.1**放在了 CLASSPATH 中，这就是 JPA 1.0 API。根据[GAE JPA 插件](http://repo1.maven.org/maven2/com/google/appengine/orm/datanucleus-appengine/2.1.1/datanucleus-appengine-2.1.1.pom)POM，使用**geronimo-jpa_2.0_spec v1.1**会更有意义，因为它是 JPA 2.0 API。GAE JPA 插件和 DataNucleus 兼容性在[http://code.google.com/p/datanucleus-appengine/wiki/Compatibility中定义](http://code.google.com/p/datanucleus-appengine/wiki/Compatibility)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:21:34.207

使用[Google AppEngine DataNucleus 插件](http://mvnrepository.com/artifact/com.google.appengine.orm/datanucleus-appengine)：

```
<dependency>
    <groupId>com.google.appengine.orm</groupId>
    <artifactId>datanucleus-appengine</artifactId>
    <version>2.1.2</version>
</dependency> 
```

# java - HttpURLConnection 很慢

> ID：14717752
> 
> 赞同：2
> 
> 时间：2013-02-05T21:57:36.833
> 
> 标签：java, android

谁能发现为什么这需要大约 20 秒？我正在运行下面的代码将 JSON 请求发布到本地服务器 192.168.1.127。

> curl -H "内容类型：应用程序/json" -X POST http://192.168.1.127:8080/bed -d '{"command":{"value":3.012,"set":"target_pressure_voltage"}, "id":2002,"side":"left","role":"command"}'

在服务器运行的同一个盒子上卷曲是即时的，服务器不会抱怨。

来自 Android 浏览器的获取请求很快。我尝试了两台操作系统版本为 4.x 的 Android 设备。

据我所知，这个问题没有帮助： [Android HttpURLConnection 非常慢](https://stackoverflow.com/questions/12108166/android-httpurlconnection-very-slow)

**con.getInputStream()**大约需要 20 秒：

```
 String httpJson(String url, JSONObject job) {
    String ret = null;      
        HttpURLConnection con = httpJsonCon(url);
        if(con!=null)
            httpJsonCon(con, url,job);      
    return ret;

}

 HttpURLConnection mkCon(String url) {
    HttpURLConnection con = null;
    URL u = null;
    try {
        u = new URL(url);
        con = (HttpURLConnection) (u.openConnection());

        con.setRequestMethod("POST");
        con.setUseCaches(false);
        con.setRequestProperty("Content-Type", "application/json");
        con.setRequestProperty("Accept", "text/plain");
        con.setRequestProperty("Accept", "application/json");
        con.setDoOutput(true);
        con.setDoInput(true);
        con.connect();

    } catch (Exception e) {
        Log.w(TAG, " e= " + e);
        if(con!=null)
            con.disconnect();

        con = null;
    }

    return con;
}

String sendJson(HttpURLConnection con, JSONObject job) {
    String ret = null;
    if(con==null){
        return ret;
    }

    try {
        final String toWriteOut = job.toString();

        final Writer out = new OutputStreamWriter(new BufferedOutputStream(
                con.getOutputStream()), "UTF-8");
        out.write(toWriteOut);
        out.flush();
        //con.getInputStream() Takes ~20 sec:
        final BufferedReader in = new BufferedReader(new InputStreamReader(con.getInputStream()));  

    } catch (IOException e) {

        Log.d(TAG, " e= " + e);

        ret = null;
    } finally {
        if(con!=null)
            con.disconnect();
    }

    return ret;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T04:59:49.267

添加指定帖子内容长度的请求标头。

```
con.setRequestProperty("Content-Length", "" + json.length()); 
```

# c++ - 如何在 C++ lambda 中访问 QObject::sender？

> ID：14717755
> 
> 赞同：2
> 
> 时间：2013-02-05T21:57:48.603
> 
> 标签：c++, c++11, lambda, qt5

这是一个相当不寻常的问题——但仍然是一个问题。我有一个接受 lambda 作为参数的函数，然后将其传递给`QObject::connect`：

```
template<typename Functor>
void MyClass::doSomething(Functor f)
{
    connect(network_reply, &QNetworkReply::finished, f);
    //...
} 
```

的示例调用`MyClass::doSomething`可能如下所示：

```
doSomething([]()
{
    // how do I get access to the sender???
}); 
```

正如您从我的评论中可以看出的那样，无法访问`QObject::sender`以获取指向`QObject`发出信号的指针。因为发出信号的类不在创建 lambda 的范围内，所以无法在 lambda 内引用它。

我有什么选择？

* * *

**编辑：**我尝试使用 Andy 的建议 ( `std::bind`)，但我最终得到了一个几乎无法理解的模板错误：

[http://paste.ubuntu.com/1614425/](http://paste.ubuntu.com/1614425/)

摘抄：

```
decltype 无法解析重载函数的地址
```

...它指向`QObject::connect`呼叫。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T22:09:22.657

如果我正确理解了您的要求，您可以首先让您的 lambda 仿函数接受适当类型的参数（在此处通过引用传递，因此请注意生命周期问题）：

```
doSomething([](QNetworkReply* p)
{
    // Here you have the sender referenced by p
}); 
```

然后，您的`doSomething()`模板函数可以`std::bind()`用来确保将使用适当的对象作为其参数调用您的 lambda：

```
template<typename Functor>
void MyClass::doSomething(Functor f)
{
    connect(network_reply, &QNetworkReply::finished, bind(f, network_reply));
    //...
} 
```

# ios - 在iOS中将数组元素分组到存储桶中的最快方法是什么？

> ID：14717757
> 
> 赞同：1
> 
> 时间：2013-02-05T21:57:52.437
> 
> 标签：ios, c, arrays, histogram, accelerate-framework

所以我有一个包含 500,000 个元素的数组：

```
float* arrayToBucketize=(float*) malloc(sizeof(float)*500000); 
```

和一个代表桶的数组：

```
int buckets[5]={0,25,50,75,100}; 
```

通过第一个数组的最快方法是什么，查看每个浮点值，将其与“桶”数组进行比较，然后用最接近的桶值替换该浮点值。因此，如果浮点值为 11.25，它将被替换为 0。另一方面，90.10 将被替换为 100。

此外，我需要该范围之外的任何值（<0 和 >100）保持不变。

我知道我可以用 for 循环和 if 条件来做到这一点；但是在优化的坏习惯中，我试图找到一种更有效（更快）的方式来做到这一点。我希望 Accelerate 框架中有一个 C 函数或 iOS 函数可以做到这一点。或者可能是一系列 Accelerate 框架矩阵函数。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:34:43.897

对于存储桶范围内的每个值，除以存储桶值的最小公倍数。将结果四舍五入到最接近的整数，然后再次乘以最小公倍数。

使用示例编号：

```
11.25 / 25 = 0.45
0.45 -> 0
0 * 25 = 0

90.10 / 25 = 3.604
3.604 -> 4
4 * 25 = 100 
```

加速框架具有矢量化除法、舍入和乘法函数，因此它们应该运行得相当快。

# asp.net - 如何在单独的页面中打印 asp.net 用户控件？

> ID：14717759
> 
> 赞同：0
> 
> 时间：2013-02-05T21:58:09.863
> 
> 标签：asp.net, pdf, user-controls

我有大约 10 个用户控件（每个用户控件都有文本框，gridview）显示在需要使用cutepdf 打印的单个页面上。

问题是用户控件分成单独的页面（如文本框分成页面）。有没有办法将 asp.net 页面选择性地打印到单独的页面中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:19:20.973

CSS 属性`page-break-before`、`page-break-inside`和`page-break-after`控制从浏览器打印网页时出现分页符的位置。

假设 CutePDF 准确地表示了它们将被打印的页面，这些应该可以帮助您以您想要的方式实现分页并避免在中间控制中破坏页面。

（当然，如果某些东西，比如表格，对于一页来说太长，分页符是不可避免的。但是这些 CSS 属性至少可以让您对它们的发生方式进行一些控制。）

# c++ - 对象指针赋值的指针向量的一个元素

> ID：14717762
> 
> 赞同：1
> 
> 时间：2013-02-05T21:58:28.017
> 
> 标签：c++, object, pointers, vector, variable-assignment

我在将对象指针的指针向量的元素分配给对象指针时遇到问题。我在 Linux 上并使用 Eclipse IDE。如果你想看看我的问题：

```
void Parse::parseDatalogProgram(vector<Token*>* tokens)
{
    Token* currentToken = tokens[0];
...
} 
```

我收到一个语法错误，说“无法在初始化中将 'std::vector' 转换为 'Token*'”，尽管上面看起来不是这样 我该如何正确解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T22:00:32.840

`tokens`是一个指针，而不是一个`vector`本身。你可以做

```
tokens->operator[](0); 
```

或者

```
(*tokens)[0]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T22:02:45.410

```
Token* currentToken = (*tokens)[0]; 
```

确保令牌不为空。你为什么不传递参考呢？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T22:03:20.603

`tokens`是**指向 vector**的指针，而不是对象或引用。C ++方式将函数原型更改为：

```
void Parse::parseDatalogProgram(const vector<Token*>& tokens){...} 
```

如果这不可能，您可以在使用它之前简单地取消引用指针：`Token* currentToken = (*tokens)[0]`

# jquery - jQuery 隔离

> ID：14717764
> 
> 赞同：3
> 
> 时间：2013-02-05T21:58:33.820
> 
> 标签：jquery

我的公司有一个 Web 应用程序，其中有一个普通的 javascript，它以自己的方式使用 $ -“美元符号”，如图所示：

```
function $(e) {
    return document.getElementById(e);
} 
```

问题是当我将 jquery 嵌入页面时发生冲突。有没有一种方法可以隔离 jquery 示例：

$$(this) - 是调用 jquery 和 $(this) - 调用老员工

请帮帮我谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T22:01:40.173

只要确保你首先包含你的库，然后调用

```
$.noConflict();
var $$ = jQuery; 
```

这将恢复`$`到解析 jQuery 之前的状态并`$$`指向`jQuery` [http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

# regex - SSMS 替换约束中的唯一文本

> ID：14717769
> 
> 赞同：0
> 
> 时间：2013-02-05T21:58:49.990
> 
> 标签：regex, ssms, replace

祝大家有美好的一天！

我的问题很简单，但我无法做到。

我已经为数据库及其内容生成了一个脚本，现在我想将我在一个数据库中生成的内容与另一个数据库进行比较。

使用 winmerge，我遇到了困难，因为有以下项目：

```
 CONSTRAINT [PK__onepk__321403CF014925CB] PRIMARY KEY CLUSTERED 
```

其中一个脚本有 321403CF014925CB 而另一个有 321403CF07820F21。

我怎样才能替换所有这些文本，使它变成

```
 CONSTRAINT [PK__onepk__] PRIMARY KEY CLUSTERED 
```

当然，在这种情况下大约有一百个主键。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:03:12.100

试试这个正则表达式：

```
CONSTRAINT \[PK__onepk__([\w^\]]+)\] PRIMARY KEY CLUSTERED 
```

给定这个输入字符串：

```
CONSTRAINT [PK__onepk__321403CF014925CB] PRIMARY KEY CLUSTERED 
```

这部分表达式

```
([\w^\]]+) 
```

将匹配

```
321403CF014925CB 
```

# jquery - jQuery xml2json 插件在 IE 中不起作用

> ID：14717771
> 
> 赞同：0
> 
> 时间：2013-02-05T21:58:51.147
> 
> 标签：jquery, xml, json, internet-explorer

我正在使用 jQuery xml2json 插件（[http://www.fyneworks.com/jquery/xml-to-json/](http://www.fyneworks.com/jquery/xml-to-json/)）将 xml 解析为 json，但它在 IE 中无法正常工作。我想知道是否有人可以帮助我处理这个问题。

这是我要转换为 json 的 xml 示例：`<?xml version='1.0' encoding='iso-8859-1' standalone='no'?> <context> <object objid="228" author="johnDoe" creation-date="2012-10-24 22:55:09.0" last-updated="2012-10-24 22:55:09.0" type="objectType" name="ojectTest" availability="public" status="active"> <attribute-set> <attribute attid="399" name="Geo-Location" value=" 12.1234567_-32.1234567" time="2012-10-24 22:56:10.0"/> </attribute-set> <relation-set> </relation-set> </object></context>`

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:58:14.057

也许 IE 你的单引号有问题。尝试只使用双引号

```
<?xml version="1.0" encoding="iso-8859-1" ... 
```

# ruby-on-rails - 我有一个创建新用户的表格，但不工作

> ID：14717774
> 
> 赞同：0
> 
> 时间：2013-02-05T21:58:58.237
> 
> 标签：ruby-on-rails, forms, login

我创建用户的表单有问题...这是我的“新”代码

```
<%= form_for @user do |f| %>
  <% if @user.errors.any? %>
    <% for message in @user.errors.full_messages %>
    <div class="alert">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        <%= message %>
    </div>
    <% end %>
 <% end %>
  <div class="field">
    <%= f.label :username %>
    <%= f.text_field :username %>
  </div>
  <div class="field">
    <%= f.label :email %>
    <%= f.text_field :email %>
  </div>
  <div class="field">
    <%= f.label :password %>
    <%= f.password_field :password %>
  </div>
  <div class="field">
    <%= f.label :password_confirmation %>
    <%= f.password_field :password_confirmation %>
  </div>
  <div class="actions"><%= f.submit "Registrarse" %></div>
<% end %> 
```

并在控制器中“创建”

```
def create
   @user = User.new(params[user])
    if @user.save
      redirect_back_or_to root_url, :notice => "Usuario Registrado Satisfactoriamente!"
    else
      render :new, :notice => "No se ha podido registrar"
    end
end 
```

当我创建用户时，进入登录表单，并收到一条空消息，因为如果我有消息，我有一个“如果”，这会显示一个带有一些 css 的 div，所以我可以看到发生了错误，但是这是空的，我有什么问题？我什么也没看到……当然，用户没有被创建。！感谢您的帮助，我是红宝石的新手。对不起我的英语不好xd

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:06:58.510

问题是您最有可能引用`password_confirmation`通常是输入标签。您的数据库中很可能没有此字段，因为这将是一种可怕的做法。你在给你的密码加盐吗？

在 github 和 Railscasts 上查看[魔法。](https://github.com/NoamB/sorcery)它在涵盖身份验证方面做得很好。

此外，您需要`:user`在`params`=>中使用`User.new(params[:user])`

# sql-server - TSQL如何为PIVOT指定列列表范围？

> ID：14717784
> 
> 赞同：4
> 
> 时间：2013-02-05T22:00:00.123
> 
> 标签：sql-server, tsql, pivot

下面的 SELECT 语句来自我用来检索随后发送到 JSON 的数据的**存储过程：**

```
SELECT *
FROM (
    SELECT CAST(DateTimeUTC as SmallDateTime) as [DateTime], DataValue, VariableID
    FROM DataValues
    WHERE SiteID = @siteID and VariableID BETWEEN 9 and 10 and DateTimeUTC >= DATEADD (day, @pastDays, getdate())
     ) TableDate
PIVOT (SUM(DataValue) FOR VariableID IN ([9],[10])) PivotTable ORDER BY [DateTime] 
```

我想要完成的是修改过程以接受要旋转的列范围。在上面的示例中，我只检索两个变量的值。如果我想检索 VariableID 1 到 10 或 1 到 50 怎么办？必须有一种方法可以通过以下方式检索 1 到 10：

```
 VariableID IN ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10]) 
```

MSDN 上的[Using PIVOT and UNPIVOT](http://msdn.microsoft.com/en-us/library/ms177410%28SQL.105%29.aspx)没有提到指定范围的方法。

我意识到可以在存储过程中使用动态 SQL，但考虑到我自己的 SQL 知识以及必须长期维护这一点的人的知识，我不愿通过使用动态 SQL 来引入额外的复杂性。这里有一个概念上类似的问题，请参阅[TSQL Pivot Long List of Columns](https://stackoverflow.com/questions/11883957/tsql-pivot-long-list-of-columns)，并用动态 SQL 解决方案回答了这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T22:05:15.200

不幸的是，该`PIVOT`函数不具备生成列列表的能力，而无需使用动态 sql。

因此，您的 SQL 代码将与此类似：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(VariableID) 
                    from DataValues
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT [DateTime], ' + @cols + ' from 
             (
                SELECT CAST(DateTimeUTC as SmallDateTime) as [DateTime], 
                    DataValue, 
                    VariableID
                FROM DataValues
                WHERE SiteID = '+cast(@siteID as varchar(10))+'
                    -- and VariableID BETWEEN 9 and 10 -- remove the variableID filter
                    and DateTimeUTC >= DATEADD (day, +'cast(@pastDays as varchar(10))+', getdate())
            ) x
            pivot 
            (
                SUM(DataValue)
                for VariableID in (' + @cols + ')
            ) p '

execute(@query) 
```

关键是以下代码生成`variableIds`要成为列的列表：

```
select @cols = STUFF((SELECT distinct ',' + QUOTENAME(VariableID) 
                    from DataValues
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'') 
```

这将创建所有`distinct`变量 id 的列表。然后将此列表添加到要返回的 SQL 查询字符串中。

# python - 在 Python 中调用另一个进程的方法

> ID：14717789
> 
> 赞同：2
> 
> 时间：2013-02-05T22:00:05.447
> 
> 标签：python, multiprocessing, tornado

我的设置如下 - 我有一个基于 Tornado 的 HTTP 服务器，它几乎是“hello world”示例：

```
server = tornado.httpserver.HTTPServer(app)
server.bind(8888)
server.start(2)
tornado.ioloop.IOLoop.instance().start() 
```

现在在这个设置中，我还有另一个由根进程产生的进程（我们称之为控制进程）。因此，此控制进程是两个 Tornado 处理程序进程的同级进程。当然，我可以通过根进程创建的管道在处理程序进程和控制进程之间进行通信。然而，我对调用控制过程的方法并获得它的输出更感兴趣。

做这种事情的最佳方法是什么？如果我使用管道将请求从处理程序发送到控件并返回结果，我应该使用锁来实现进程安全吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:04:32.350

您不需要带管道的锁。管道是它自己的同步。或者，换一种说法，管道的两侧是独立的对象。

（当然，控制进程可能需要内部锁，例如，如果它从与主事件循环不同的线程处理管道并且需要与在主循环中运行的代码共享任何数据，但这与交互无关。过程安全。）

无论如何，如果您退后一步从更高的层次考虑这一点，那么您正在实现的是 RPC 机制的确切定义。如果您正在做的事情足够简单，那么以这种方式从头开始实现它很好，但如果不是，您可能希望添加另一个协议`control`并让 Tornado 与您现有的协议一起管理它。

# matrix - 矩阵的最大子数组

> ID：14717799
> 
> 赞同：1
> 
> 时间：2013-02-05T22:01:01.870
> 
> 标签：matrix, dynamic-programming, pseudocode

我目前正在阅读 Jon Bentley 的“Programming Pearls”，其中有一个我似乎无法回答的问题。这里是：

**在最大子数组问题中，给定一个 nxn 实数数组，我们必须找到包含在任何矩形子数组中的最大和。**

在本章中，它列出了一种求数组最大值的算法：
maxsofar = 0
maxendinghere = 0
for i = [0, n) // n) = n-1
/*ivariant: maxendinghere 和 maxsofar 对于 x[ 是准确的0…i-1] */
maxendinghere = mac(maxendinghere + x[i], 0)
maxsofar = mac(maxsofar, maxendinghere)

我正在考虑您是否可以按照 上面显示的算法 对所有行的
所有列说些什么

但我不确定这是否可行。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T01:33:53.180

首先，您必须了解一维数组版本：一维数组的最大连续和。

为了解决一维数组版本，算法很简单，你已经在上面给出了。

```
maxsofar = 0
maxendinghere = 0
for i = [0, n)
    maxendinghere = max(maxendinghere + x[i], 0)
    maxsofar = max(maxsofar, maxendinghere) 
```

这是 O(n)。然后我们可以扩展到 2d 版本。对于 2d 版本，您可以将其转换为 1d 版本并仍然使用上述算法，但是如何？只需将一列中的值相加，并将总和视为新的一维数组。例子：

矩阵为 2*2，如下所示：

```
1 2
3 4 
```

总结后，你可以得到

```
4 6 
```

知道了？您需要做的就是枚举所有可能的方法来计算从第 i 行到第 j 行的列总和。然后应用上述密钥算法。伪代码：

```
for i=0 to n
    for j=i to n
        create a new array which contains the column sum from the ith row to jth row
        apply the above O(n) algorithm to get the maximum 
```

总复杂度为 O(n^3)

# mysql - 如何通过元组的 2 个变量的除法结果对元组进行排序

> ID：14717801
> 
> 赞同：1
> 
> 时间：2013-02-05T22:01:05.613
> 
> 标签：mysql, select

如何通过元组的 2 个变量的除法结果对元组进行排序。

在 MySql 中，我想做上面的事情。

假设我有一张包含网站帖子的表格：

Id PostTitle Content Likes Deslikes ....etc

我想要一个选择查询，以按 Likes/Deslikes (division) 获取所有元组的顺序。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:10:06.290

试试这个

```
select * from your_table order by Likes ,Deslikes 
```

如果你的意思是分裂然后试试这个

```
select * from your_table order by Likes/Deslikes 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:45:32.860

尝试

```
ORDER BY Deslikes <> 0 DESC, Likes / Deslikes, Likes 
```

它将确保所有 Deslikes 为 0 的行排在最后。最后的 Likes 确保具有相等比率（包括 0 Deslikes）的行按 Likes 排序。或者，您也可以添加`, Deslikes DESC`以确保通过减少 Deslikes 的数量来列出具有 0 Likes 的行。

请参阅 SQLfiddle：[http ://www.sqlfiddle.com/#!2/1e6b3/4/0](http://www.sqlfiddle.com/#!2/1e6b3/4/0)

# jquery-ui - jQuery UI 按钮集在 IE8 中不起作用

> ID：14717807
> 
> 赞同：1
> 
> 时间：2013-02-05T22:01:16.787
> 
> 标签：jquery-ui, internet-explorer-8, jqueryi-ui-buttonset

我似乎无法弄清楚为什么我的 jQuery UI Buttonset 在 IE8 中无法正常工作。显然，在 IE 中，当单击按钮（标签）时，它不会触发相应输入的更改事件。这破坏了我的功能。我已经尝试过使用点击事件，但没有运气。任何帮助将非常感激。

这是我的页面： http: [//www.indsci.com/Calibration-Gas-Cross-Reference-Chart/](http://www.indsci.com/Calibration-Gas-Cross-Reference-Chart/)

```
$(document).ready(function(){   

    $('.loadbar').hide();
    $('.uxGasProducts').fadeIn(1000);

$( ".calgases .select-gases div.row1" ).buttonset();
$( ".calgases .select-gases div.row2" ).buttonset();

function refine_search_multi() {
    $('#table-2').show();
    if ($('.checkboxGas').is(':checked')){

    $('.CH4, .CL2, .ClO2, .CO, .CO2, .H2, .H2S, .HCl, .HCN, .LEL, .NO2, .NO, .NH3, .O2, .PH3, .PID, .SO2, .empty').hide();
    }  else {$('#table-1 tr, #table-2 tr').not('.keep').show(); $('.specific-title-cal-gas').hide();}

        var theclass = "";

        $('#table-1 tr, #table-2 tr').not('.keep').hide();

        var theclass = "";
        var thetitle = "";
        if ( $('input[value=Benzene]').is(':checked') ) {theclass += ".Benzene"; thetitle += ".Benzene"};
        if ( $('input[value=Hexane]').is(':checked') ) {theclass += ".Hexane"; thetitle += ".Hexane"};
        if ( $('input[value=Toluene]').is(':checked') ) {theclass += ".Toluene"; thetitle += ".Toluene"};
        if ( $('input[value=ZeroGradeAir]').is(':checked') ) {theclass += ".ZeroGradeAir"; thetitle += ".Zero Grade Air"};
        if ( $('input[value=Butadiene]').is(':checked') ) {theclass += ".Butadiene"; thetitle += ".Butadiene"};
        if ( $('input[value=Pentane]').is(':checked') ) {theclass += ".Pentane"; thetitle += ".Pentane"};
        if ( $('input[value=C4H8]').is(':checked') ) {theclass += ".C4H8"; thetitle += ".Isobutylene"};
        if ( $('input[value=C3H8]').is(':checked') ) {theclass += ".C3H8"; thetitle += ".Propane"};
        if ( $('input[value=CH4]').is(':checked') ) {theclass += ".CH4"; thetitle += ".Methane"};
        if ( $('input[value=CL2]').is(':checked') ) {theclass += ".CL2"; thetitle += ".Chlorine"};
        if ( $('input[value=CO]').is(':checked') ) {theclass += ".CO"; thetitle += ".Carbon Monoxide"};
        if ( $('input[value=CO2]').is(':checked') ) {theclass += ".CO2"; thetitle += ".Carbon Dioxide"};
        if ( $('input[value=H2]').is(':checked') ) {theclass += ".H2"; thetitle += ".Hydrogen"};
        if ( $('input[value=H2S]').is(':checked') ) {theclass += ".H2S"; thetitle += ".Hydrogen Sulfide"};
        if ( $('input[value=HCl]').is(':checked') ) {theclass += ".HCl"; thetitle += ".Hydrogen Chloride"};
        if ( $('input[value=HCN]').is(':checked') ) {theclass += ".HCN"; thetitle += ".Hydrogen Cyanide"};
        if ( $('input[value=LEL]').is(':checked') ) {theclass += ".LEL"; thetitle += ".Lower Explosive Limit"};
        if ( $('input[value=NH3]').is(':checked') ) {theclass += ".NH3"; thetitle += ".Ammonia"};
        if ( $('input[value=NO]').is(':checked') ) {theclass += ".NO"; thetitle += ".Nitric Oxide"};
        if ( $('input[value=N2]').is(':checked') ) {theclass += ".N2"; thetitle += ".Nitrogen"};
        if ( $('input[value=NO2]').is(':checked') ) {theclass += ".NO2"; thetitle += ".Nitrogen Dioxide"};
        if ( $('input[value=O2]').is(':checked') ) {theclass += ".O2"; thetitle += ".Oxygen"};
        if ( $('input[value=PH3]').is(':checked') ) {theclass += ".PH3"; thetitle += ".Phosphine"};
        if ( $('input[value=SO2]').is(':checked') ) {theclass += ".SO2"; thetitle += ".Sulfur Dioxide"}

        formatedClass = thetitle.replace(/\./g, ", and ");
        finalClass = formatedClass.replace(", and", "");

        $('.specific-title-cal-gas span').html(finalClass);
        $('.specific-title-cal-gas').show('slow');

        $(theclass).show();

var theTHeight = document.getElementById("getheight").offsetHeight; 
        if (theTHeight <= 110)
        {$('.empty').show();}
        else {$('.empty').hide();}

    var theHeight = document.getElementById("table-2").offsetHeight;            
        if (theHeight <= 60)
        {$('#table-2').hide();}
        else {$('#table-2').show();}

} 

$('.calgases input').change(function() {
    $('#table-2').show();
    if ($('.calgases .checkboxGas').is(':checked')){
            refine_search_multi();
    } else {
    $('#table-1 tr, #table-2 tr').not('.keep').show();
    $('.specific-title-cal-gas').hide();
    }

});  $('.clear-all').click(function() {

            $('.empty').hide();
            $('.specific-title-cal-gas').hide('slow');
            $('#table-1').show();
            $('#table-2').show();
            $('table tr').show();
            $('label').removeClass('ui-state-active');
            $('input:checkbox').attr('checked', false);
            $('input:radio').attr('checked', false);
            }); $('.row2 label').click(function() {
            $('.row1 label').removeClass('ui-state-active');
            $('input:checkbox').attr('checked', false);}); $('.row1 label').click(function() {
        $('.row2 label').removeClass('ui-state-active');
            $('input:radio').attr('checked', false);});}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T16:23:18.337

我已经解决了这个问题。问题不在于我的 JavaScript，而在于 CSS。我用 CSS 隐藏了输入元素，而不是将它们放置在页面之外。因为它们的包含元素是相对定位的，所以绝对位置不会将它们置于视野之外。

在 IE8 中，如果输入元素被隐藏，则不会触发更改事件。

# xml - 使用 XML::Simple 进行迭代

> ID：14717809
> 
> 赞同：0
> 
> 时间：2013-02-05T22:01:21.690
> 
> 标签：xml, perl

```
$VAR1 = {
          'link' => [
                    {
                      'rel' => 'alternate',
                      'href' => 'http://www.test.com'
                    },
                    {
                      'rel' => 'self',
                      'href' => 'http://www.test.com'
                    }
                  ],
          'xmlns' => 'http://www.w3.org/2005/Atom',
          'entry' => {
                     'number=0001096906-13-000126' => {
                                                                                     'link' => {
                                                                                               'rel' => 'alternate',
                                                                                               'href' => 'http://www.test.com/1',
                                                                                               'type' => 'text/html'
                                                                                             },
                                                                                     'summary' => {
                                                                                                  'content' => 'Green',
                                                                                                  'type' => 'html'
                                                                                                },
                                                                                     'title' => 'Green Diamond',
                                                                                     'updated' => '2013-02-05T15:34:15-05:00',
                                                                                     'category' => {
                                                                                                   'scheme' => 'http://www.test.com/',
                                                                                                 }
                                                                                   },
             'number=0001096906-13-000130' => {
                                                                                     'link' => {
                                                                                               'rel' => 'alternate',
                                                                                               'href' => 'http://www.test.com/2',
                                                                                               'type' => 'text/html'
                                                                                             },
                                                                                     'summary' => {
                                                                                                  'content' => 'Green',
                                                                                                  'type' => 'html'
                                                                                                },
                                                                                     'title' => 'Green Diamond',
                                                                                     'updated' => '2013-02-05T15:34:15-05:00',
                                                                                     'category' => {
                                                                                                   'scheme' => 'http://www.test.com/',
                                                                                                 }
                                                                                   },
          'updated' => '2013-02-05T15:38:23-05:00',
          'author' => {
                      'email' => 'webmaster@test.com',
                      'name' => 'Webmaster'
                    },
          'id' => 'http://www.test.com',
          'title' => 'Latest Colors - Tue, 05 Feb 2013 15:38:23 EST'
        }; 
```

到目前为止，在我的代码中我有....

```
#!/usr/bin/perl
# use module
use XML::Simple;
use Data::Dumper;

# create object
$xml = new XML::Simple;

# read XML file
$data = $xml->XMLin("sec_rss.xml");

# print output
#print Dumper($data);

foreach $e (@{$data->{entry}[0]}) {
      print $e->{link},"\n";
} 
```

但是我对如何遍历这里的每个条目以获取元素感到困惑。有人可以给我一个线索来帮助我滚动吗？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:24:04.543

首先，请在您的程序中使用`strict`和。`warnings`他们将帮助您追踪错误。

我不确定你在挣扎什么。我已经注释掉了 XML 数据结构的一部分，因为我认为解析它时出了点问题，或者你遗漏了一些东西。钥匙的最后一部分`entry`看起来好像缺少另一个钥匙。

然后，我演示了如何依次查看每个条目并访问其中的所有信息。

```
use warnings;
use strict;
use feature qw(say);
my $data = {
  'xmlns' => 'http://www.w3.org/2005/Atom',
  'link' => [
    {
      'rel' => 'alternate',
      'href' => 'http://www.test.com'
    },
    {
      'rel' => 'self',
      'href' => 'http://www.test.com'
    }
  ],
  'entry' => {
      'number=0001096906-13-000130' => {
      'link' => {
        'rel' => 'alternate',
        'href' => 'http://www.test.com/2',
        'type' => 'text/html'
      },
      'summary' => {
        'content' => 'Green',
        'type' => 'html'
      },
      'category' => {
        'scheme' => 'http://www.test.com/'
      },
      'updated' => '2013-02-05T15:34:15-05:00',
      'title' => 'Green Diamond'
    },
      'number=0001096906-13-000126' => {
      'link' => {
        'rel' => 'alternate',
        'href' => 'http://www.test.com/1',
        'type' => 'text/html'
      },
      'summary' => {
        'content' => 'Green',
        'type' => 'html'
      },
      'category' => {
        'scheme' => 'http://www.test.com/'
      },
      'updated' => '2013-02-05T15:34:15-05:00',
      'title' => 'Green Diamond'
    },
    #'title' => 'Latest Colors - Tue, 05 Feb 2013 15:38:23 EST',
    #'id' => 'http://www.test.com',
    #'author' => {
    #              'email' => 'webmaster@test.com',
    #              'name' => 'Webmaster'
    #            },
    #'updated' => '2013-02-05T15:38:23-05:00'
  }
};

foreach my $entry (keys %{ $data->{entry} }) {
  say "Key: ", $entry;
  say "Title: ", $data->{entry}->{$entry}->{title};
  say "Summary: ", $data->{entry}->{$entry}->{summary}->{content};
  say "Link: ", $data->{entry}->{$entry}->{link}->{href};
  say "Category: ", $data->{entry}->{$entry}->{category}->{scheme};
  say "Updated: ", $data->{entry}->{$entry}->{updated};
  print  "\n";
} 
```

# java - 什么时候使用私有构造函数有用？

> ID：14717813
> 
> 赞同：1
> 
> 时间：2013-02-05T22:01:31.243
> 
> 标签：java, constructor, private-methods

> **可能重复：**
> [在类中将构造函数设为私有有什么用？](https://stackoverflow.com/questions/2062560/what-is-the-use-of-making-constructor-private-in-a-class)

什么时候使用私有构造函数有用？受保护的呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T22:02:06.907

当您想防止对象的外部实例化时，它很有用，例如静态工厂类、单例等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:06:05.303

我可以想到一些用途`private`：

*   防止外部实例化（完全静态的类或单例）
*   有时需要默认构造函数来实例化您的类（例如[Hibernate](http://www.hibernate.org/)），但您可能不想将它们公开。
*   委托构造函数

最后一个完全人为的例子：

```
private MyClass(int a) {
    this.a = a}

public MyClass(int a, String B) {
    this(a);
    this.b = b;
}

public MyClass(int a, double c) {
    this(a);
    this.b = Double.toString(c);
} 
```

类似的推理`protected`，它只是将特权少数扩展到子类和包邻居。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T22:06:12.377

单例模式使用私有构造函数来控制对象的实例化。您可能遇到的另一个用例是当您希望在单元测试中使用特殊构造函数时（如果您在没有依赖注入框架的情况下运行单元测试），因此您不会将其公开，而是包保护并声明单元测试同一个包。

# django - Django Bootstrap Toolkit CSS 编辑

> ID：14717815
> 
> 赞同：2
> 
> 时间：2013-02-05T22:01:34.007
> 
> 标签：django

我正在使用 Django Bootstrap 工具包，我想知道 CSS 和 JS 文件存储在哪里，以便我可以编辑它们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T22:38:45.307

看一下[示例项目](https://github.com/dyve/django-bootstrap-toolkit/blob/master/demo_project/settings.py#L153)和[模板标签](https://github.com/dyve/django-bootstrap-toolkit/blob/master/bootstrap_toolkit/templatetags/bootstrap_toolkit.py)：

```
BOOTSTRAP_BASE_URL = 'http://twitter.github.com/bootstrap/assets/'
BOOTSTRAP_CSS_BASE_URL = BOOTSTRAP_BASE_URL + 'css/'
BOOTSTRAP_CSS_URL = BOOTSTRAP_CSS_BASE_URL + 'bootstrap.css'
BOOTSTRAP_JS_BASE_URL = BOOTSTRAP_BASE_URL + 'js/' 
```

因此，您可以定义自己的文件版本，但默认情况下`django-bootstrap-toolkit`直接从 Github 存储库嵌入文件。

但是，在大多数情况下，最好保留原始文件并覆盖您自己的样式表中的必要声明。检查[此答案](https://stackoverflow.com/a/8085921/630877)以了解如何执行此操作。

# jquery - 显示开启 徘徊

> ID：14717819
> 
> 赞同：0
> 
> 时间：2013-02-05T22:01:39.543
> 
> 标签：jquery, css, image, html, hover

我有这个代码：

```
<div class="bigroundlink" >
    <img class="cross" src="img.png" style="position:absolute; display:none;" />
</div> 
```

并希望在用户悬停 div 时显示该图像。我该怎么做 ？随意使用/添加（如果需要）id 到元素、JQuery 和 CSS。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T22:03:59.943

这？（纯CSS）

```
.bigroundlink img { visibility: hidden; }
.bigroundlink:hover img { visibility: visible; } 
```

并删除 img 标签上的嵌入样式

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T22:04:27.730

如果不显示 img，则需要为 DIV 设置宽度和高度。然后：

CSS：

```
.bigroundlink {
    width:100px;
    height:100px;
} 
```

jQuery：

```
$('.bigroundlink').hover(function(){
    $(this).children('.cross').show();
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T22:06:16.917

与 jquery 一起工作得很好！

```
 $(document).ready(function(){
    $(".bigroundlink").hover(function(){
        $(".bigroundlink .cross").show();
    });
 }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T22:09:34.617

所以，你需要

```
$(function() {
$(".bigroundlink").hover(
}); 
```

还有 impl [.fadeTo jquery 效果](http://api.jquery.com/fadeTo/)

# c++ - 在 Release 模式下只执行部分代码

> ID：14717821
> 
> 赞同：1
> 
> 时间：2013-02-05T22:01:53.120
> 
> 标签：c++, visual-studio-2010, debugging, c-preprocessor, visual-studio-debugging

我有一些`C++`我想调试的代码。通常情况下，我的错误仅出现在无法用微小数据集重现的某些条件下，并且在经历了我确信可以工作的多个功能后才会出现。

特别是，我首先需要将我的所有数据放在一个`std::set`非常慢`debug mode`（并且发布合理）的地方，即使使用`_ITERATOR_DEBUG_LEVEL 0`预处理器指令也是如此。因此，我在想可能有一种方法可以在发布时执行部分代码，而仅在调试模式下执行代码的相关错误部分。

我尝试做类似的事情：

```
#ifdef _DEBUG
#undef _DEBUG
#define MODIFIED_DEBUG
#define NDEBUG
#endif

// build my expensive datastructure etc. etc.

#ifdef MODIFIED_DEBUG
#undef MODIFIED_DEBUG
#undef NDEBUG
#define _DEBUG
#endif

// execute my buggy code 
```

但是，这仍然和`debug mode`. 我有任何（简单的）方法来获得`release mode`我的部分代码的唯一速度吗？特别是，因为缓慢主要是由于`STL`.

（我想我可以编译一个`.lib`在发布中构建数据结构并在调试模式下在我的代码中使用该库的库，但是仅仅调试一个程序就很痛苦！）。或者，有没有像`_ITERATOR_DEBUG_LEVEL 0`定义这样的技巧来加速`STL`调试模式？我正在使用`Visual Studio 2010`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:04:20.930

您可以在发布模式下构建并用

```
#pragma optimize("",off)
//...
#pragma optimize("",on) 
```

或者做老派 - 调试语句。

# php - 使用 PHP 访问位于另一台计算机上的数据库

> ID：14717825
> 
> 赞同：0
> 
> 时间：2013-02-05T22:02:02.290
> 
> 标签：php, local, schedule

我的客户有一个商业街商店的离线产品数据库，他们出于自己的目的经常更新该数据库。他们现在正在创建一个在线商店，他们希望使用该数据库中的产品信息。

由于他们当前的旧软件设置，将数据库迁移到托管服务器并放弃离线数据库不是一种选择。

所以我的问题是：我怎样才能从他们的离线数据库中获取信息到在线数据库？他们的本地服务器始终连接到互联网，因此是否可以在网站上创建一个脚本，以某种方式从他们的服务器获取数据并将其导入在线服务器？如果它每 24 小时运行一次，那将是完美的。但它甚至可能吗？如果是这样，我会怎么做？

我能想到的唯一其他选择是在每次更新后手动上传数据库，但这并不是一个真正可行的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:12:59.493

我使用 odbc 连接对 quickbooks 做了类似的事情。使用它我将数据同步到 MySQL。然而，这种同步只是一种方式。除非您在数据中有指示某些内容何时更改（更新日期）的键，否则您最终将同步大量额外数据。

使用 SQLYog，我设置了一个连接到 odbc 数据源的计划作业，并将自上次同步以来的更改推送到我用来生成报告的 mysql 数据库。如果您可以将数据复制到 MySQL 中，那么在您的在线商店中使用它应该很容易。

缺点是它不会是实时的。库存可能会成为问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:38:38.887

在一个理想的世界中，我会考虑创建一个可以在同一台服务器上运行或至少与您的离线数据库在同一网络上运行的 RESTful API。这个 RESTful API 将通过 http 作为 Web 服务器运行，并从离线数据库返回 JSON 甚至 XML 结构的数据。在互联网上运行的客户端将能够随时连接和获取他们需要的任何数据。像这样的 RESTful API 有很多优点。

首先它是安全的。您不必通过公开与离线数据库的连接来向公众公开攻击媒介。您唯一需要做的就是启用对您的 RESTful API 的公共访问。在您的 API 逻辑中，您甚至可能不包含写入数据库的功能，因此即使您的 API 的安全性在最坏的情况下受到损害，所有攻击者所能做的就是读取您的数据，而不是破坏它。

在这种情况下拥有一个宁静的 api 代表了良好的关注点分离。您的客户端代码不应该知道有关数据库的任何信息，也不应该知道脱机数据库使用的任何内部系统。当您的客户想要更新他们的离线系统甚至改变它时会发生什么？在这种情况下，您所要做的就是更新 restful api。连接到数据的客户端不再关心其他任何事情，只关心 api，因此更改数据库会很容易。

考虑 API 的另一个原因是并发性。我之前暗示过这一点，但是如果您需要让多个客户端访问离线数据库的数据，那么拥有一个 API 会很棒。在一个 Web 服务器设置中，您可以让 API 坐下来等待请求，没有理由不能让多个客户端同时连接到 api。HTTP 真的很擅长这个！

您谈到必须将旧数据放入新数据库中。使用 RESTful API 可以轻松完成这样的事情，因为您只需将 API 的端点映射到新数据库中的表并在需要时运行它。您甚至可以放弃新数据库并使用 API 作为后端。此解决方案需要一些缓存，但如果您觉得不需要它，它会减少数据库的重复。

所有这一切的缺点是通过脚本编写 API 更加复杂。所以在这种情况下，我相信马的课程。如果这个数据库是一个将在未来扩展的长期项目的支柱，那么 API 就是要走的路。如果它只是您项目的一小部分，那么也许您可以使用每 24 小时运行一次的脚本来摆动它，但是我之前已经这样做过，第二次我必须更改/编辑解决方案，事情开始变得有点“毛茸茸”。希望这会有所帮助并祝你好运。

# r - 如何计算一般类型的分配内存大小

> ID：14717826
> 
> 赞同：3
> 
> 时间：2013-02-05T22:02:02.233
> 
> 标签：r

我需要使用`read.table`从 csv（逗号分隔值）读取的一些数据库，并且我想知道如何计算每种类型变量的分配内存的大小。

怎么做 ？

编辑 - 换句话说：从`.csv`文件中读取的一般数据帧 R 分配了多少内存？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T22:03:41.487

您可以使用 获取分配给对象的内存量`object.size`。例如：

```
x = 1:1000
object.size(x)
# 4040 bytes 
```

[该脚本](http://heuristically.wordpress.com/2010/01/04/r-memory-usage-statistics-variable/)也可能会有所帮助——它可以让您查看或绘制所有当前对象使用的内存量。

在回答你为什么`object.size(4)`是 48 字节的问题时，原因是每个数字向量都有一些开销。（在`R`中，数字`4`不仅仅是其他语言中的整数 - 它是长度为 1 的数字向量）。但这不会影响性能，因为开销不会随着向量的大小而增加。如果你试试：

```
> object.size(1:100000) / 100000
4.0004 bytes 
```

这表明每个整数本身只需要 4 个字节（如您所料）。

因此，总结：

*   对于长度为 的数值向量，`n`通常以字节为单位的大小为`40 + 8 * floor(n / 2)`。但是，在我的 R 和 OS 版本上，有一个轻微的不连续性，它比您预期的快 168 字节（见下图）。除此之外，线性关系仍然成立，即使是长度为 10000000 的向量。

    ```
    plot(sapply(1:50, function(n) object.size(1:n))) 
    ```

![在此处输入图像描述](../Images/12488332ebb70ee0a8347f8d0094900c.png)

*   对于分类变量，您可以看到非常相似的线性趋势，尽管开销更大（见下文）。除了一些轻微的不连续性之外，这种关系非常接近`400 + 60 * n`。

    ```
    plot(sapply(1:100, function(n) object.size(factor(1:n)))) 
    ```

![在此处输入图像描述](../Images/3d72ebf648519a9ea37afde5cbc170e9.png)

# jquery - MoSync 更新 LocalFiles 而不提示

> ID：14717831
> 
> 赞同：1
> 
> 时间：2013-02-05T22:02:23.083
> 
> 标签：jquery, mobile-application, local-files, mosync

我有一个在 MoSync 中开发的移动应用程序。它使用 jQuery Mobile，而且非常漂亮。我的业务经理问（可能是一个典型的业务经理问题）：**我们如何在不提示用户的情况下更新应用程序？**

我不认为我们可以更新 CPP 基础文件，我当然不认为我们可以在不提示用户的情况下更改应用程序的权限。但是LocalFiles文件夹只包含HTML5和JS，这在手机上应该是完全可以更新的，不用提示用户。

但是怎么做？编译器是否将此 LocalFiles 文件夹编译为一些二进制文件，我们可以从手机下载并替换旧的相关文件？压缩 LocalFiles 文件夹中的所有文件，让应用程序下载并解压缩它们以替换移动设备上的文件？或者在编译级别上是否有一些我们不太了解的 LocalFiles 文件夹的复杂打包？

当然，跨平台的事情会变得更加复杂，但现在我想知道 Android 的答案。

一个不错的答案是指向示例应用程序的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-11T11:42:22.803

As far as i can see, Mosync doesn't currently support zip because of potential memory issues on platforms other than IOS/Android.

Mosync Reload has been currently released though, which does exactly what you want. It uses a custom build process to package your files into some custom type of archive, which it can extract on the device.

# objective-c - 如何为 AVMetadataFormatiTunesMetadata 创建 AVMutableMetadataItem

> ID：14717833
> 
> 赞同：2
> 
> 时间：2013-02-05T22:02:26.230
> 
> 标签：objective-c, cocoa, avfoundation, avmetadataitem

我正在尝试使用 AVMutableMetadataItem 更新文件的轨道号。除了 AVMetadataFormatiTunesMetadata 之外，我已经取得了一些成功。我似乎无法弄清楚我需要设置什么值才能使其正常工作。我试图创建一个 NSArray 的存档，如下所示

```
[NSKeyedArchiver archivedDataWithRootObject:[NSArray arrayWithObjects:
    [NSNumber numberWithUnsignedInt:13],
    [NSNumber numberWithUnsignedInt:32],
    nil]]; 
```

但我最终得到的 track 和 trackOf 数字很遥远。我到底应该传递什么作为 AVMutableMetadataItem 的值，键为 AVMetadataiTunesMetadataKeyTrackNumber？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T13:29:14.520

我花了很长时间才弄清楚这一点。感谢 Apple 的 Core Audio 文档，它完全没有说明如何处理它。或与此相关的任何其他键。在我理解之前，我必须检查一个带有曲目信息的 MP4 文件。

### 回答

您需要为它分配一个包含轨道信息的 NSData。

数据必须由四个 16 位大端值组成，而第二个是*轨道号*，第三个是*集合中的总轨道*。第一和第四应该是零。

所以基本上你需要这样做

```
int16_t trackNumber = 1; // track number
int16_t tracksInCollection = 12; // total number of tracks in collection
int16_t data[4] = { 0, trackNumber, tracksInCollection, 0 };

metadataItem.keySpace = AVMetadataKeySpaceiTunes;
metadataItem.key = AVMetadataiTunesMetadataKeyTrackNumber;
metadataItem.value = [NSData dataWithBytes:data length:sizeof(data)]; 
```

**注意：**同样的方法适用于**AVMetadataiTunesMetadataKeyDiscNumber**键。

### 关于字节序的注释

如果您不想担心字节顺序，可以从 Berkeley 套接字 API“借用”一个方法。或者它可能是一个宏。无论如何，它是这样工作的：

```
bigendianval = htons(val); 
```

或者

```
int16_t trackNumber = htons(myTrackNumberVariable); 
```

htons ( *Host to network short* ) 会将您的 16 位数字转换为大端 - 无论您自己系统的字节序如何。IP 网络也是大端的，因此 htons 在这里是可重用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-11T17:30:57.217

同样，对于磁盘号：

```
AVMutableMetadataItem *metaItem = [AVMutableMetadataItem metadataItem];
metaItem.key=@1684632427;

int16_t diskNumber = htons([dict[@"discNumber"]intValue]);
int16_t disksInCollection = htons([dict[@"discCount"]intValue]);
int16_t data[3] = {0, diskNumber, disksInCollection};
metaItem.value=[NSData dataWithBytes:data length:sizeof(data)];
metaItem.keySpace=AVMetadataKeySpaceiTunes; 
```

# ios - Xcode 4.6 更新后使用未声明的标识符“arc4random”

> ID：14717834
> 
> 赞同：1
> 
> 时间：2013-02-05T22:02:27.903
> 
> 标签：ios, objective-c, xcode

我刚刚运行了 Xcode 4.6 更新，现在我的项目无法编译。我不得不修复几个 C++ 错误，但我的一个 C++ 文件仍然得到这个`Use of undeclared identifier 'arc4random'`.

请注意，`arc4random()`在项目的其他地方工作得很好。（即使在其他 C++ 文件中！）

我尝试将其更改为`arc4random_uniform(1)`，但这没有帮助。

谢谢阅读。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:04:05.830

你需要`#include <stdlib.h>`。

# c# - winforms自动完成格式字符串

> ID：14717841
> 
> 赞同：0
> 
> 时间：2013-02-05T22:03:14.613
> 
> 标签：c#, winforms

```
cities = result.Results.Entities.Cast<Address>().ToList();
foreach (Address address in cities)
{
    int spaces = (30 - address.City.Length);
     string s1 = address.City.Trim();
    for (int i = 0; i <= spaces; i++)
    {
        s1 += " ";
    }
    s1 += address.PostalCode;
    customCollection.Add(s1);
} 
```

我想连接两个字符串，以便它们在文本框 autocompletecustomsource 的列中排列。

无论我做什么，我都无法让城市和邮政编码在列中对齐。

我想：

> ```
> New Bedlam    101010
> New York      102010 
> ```

我得到：

> ```
> New Bedlam      101010
> New York      102010 
> ```

尝试了一堆东西，string.format，padright，没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:08:05.573

这是 String builder 的更新代码 始终尝试使用 StringBuilder 进行字符串连接操作，您可以将字符串附加到它并执行其他操作这里是更多信息

```
 cities = result.Results.Entities.Cast<Address>().ToList();
                    foreach (Address address in cities)
                    {
                        int spaces = (30 - address.City.Length);
                         Stringbuilder s1 = new StringBuilder();
                         s1.append(address.City.Trim());
                        for (int i = 0; i <= spaces; i++)
                        {
                            s1.append(" ");
                        }
                        s1.append(address.PostalCode);
                        customCollection.Add(s1.ToString());
                    } 
```

[http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:39:16.567

只需`string.Format`与左对齐宽度说明符一起使用：

```
foreach (Address address in cities)
{
    string s1 = string.Format("{0,-30}{1}",address.City,address.PostalCode);
    customCollection.Add(s1);
} 
```

请注意，如果您的文本框使用可变宽度字体（如 Arial），则邮政编码不会对齐。使用固定宽度的字体，如 Consolas 或 Courier New 来正确对齐。

# c# - 从 SQLDataReader 创建访问表

> ID：14717844
> 
> 赞同：1
> 
> 时间：2013-02-05T22:03:30.833
> 
> 标签：c#, .net, sql-server, ms-access-2007, sqldatareader

我无法确定执行此操作的最佳方法。我们正在维护一个复杂的数据库，普通的业务分析师会遇到很多麻烦。另一位开发人员创建了几个存储过程作为报告，我们一直在为用户按需导出到 Excel 电子表格中。

客户要求将这些结果导出到访问数据库中。

如果这是 2 或 3 列，我只需创建一个“模板”accdb 文件并将存储过程的结果推送到其中。然而，这个查询现在带回了 100 多列，并且知道客户，它将在未来扩展。所以我试图从结果集中动态创建表......不管它是什么。

我/认为/这样做的正确方法是使用 a`SqlDataReader`但我**坚持如何获得正确的“SQL”-ish 字段类型**。我当前的代码如下所示：

```
static void CreateAccessTableFromReader(string tableName, SqlDataReader reader) {
  List<string> columns = new List<string>();
  string createTable = @"CREATE TABLE {0} ({1})";

  int fieldCount = reader.FieldCount;
  for (int i = 0; i < fieldCount; i++) {
    columns.Add(String.Format("[{0}] {1}({2})",
      //column name (this seems to be right)
      reader.GetName(i), 
      //column type __(this is wrong.. I want 'VARCHAR, INT, etc')__
      reader.GetProviderSpecificFieldType(i),
      //column size (e.g. the numeric part of VARCHAR(15))
      reader.???
    ));
    //right now I'm getting results from the above line like:
    //[ColumnName] System.Data.SqlTypes.SqlString
    //and I'm looking for something like:
    //[ColumnName] VARCHAR(15)
  }
  using (var cmd = conn_Access.CreateCommand()) {
    cmd.CommandType = CommandType.Text;
    cmd.CommandText = String.Format(createTable, tableName, String.Join(", ", columns));
    cmd.ExecuteNonQuery();
  }
} 
```

值得注意：

*   根据此链接，将存在的唯一类型应该是 MSSQL 和 Access 之间的完全匹配：http: [//msdn.microsoft.com/en-us/library/bb177899.aspx](http://msdn.microsoft.com/en-us/library/bb177899.aspx)

**编辑**：

这是我的“最终解决方案”。建议使用链接服务器的评论肯定会是一种更简单的方法，但是有一件事情阻止我做一开始我没有想到的事情，数据需要存在于 Access DB 中，因为用户可能会使用数据远离他们可以通过网络访问底层数据库的地方。因此，我一直在尝试这种方法，这就是我想出的：

请注意，我仍然愿意接受“更好的方法”的建议，但这解决了我目前的问题

```
static void CreateTableFromReader(string tableName, SqlDataReader reader) {
  List<string> columns = new List<string>();
  string createTable = @"CREATE TABLE {0} ({1})";

  var dt = reader.GetSchemaTable();
  foreach (DataRow dr in dt.Rows) {
    switch (dr["DataTypeName"].ToString().ToLower()) {
      case "varchar":
        columns.Add(String.Format("[{0}] {1}({2})",
          dr["ColumnName"],
          dr["DataTypeName"],
          dr["ColumnSize"]
        ));
        break;
      case "money": //i know this is redundant but being explicit helps clarity sometimes
      case "date":
      case "integer":
      default:
        columns.Add(String.Format("[{0}] {1}",
          dr["ColumnName"],
          dr["DataTypeName"]
        ));
        break;
    }
  }
  using (var cmd = conn_Access.CreateCommand()) {
    cmd.CommandType = CommandType.Text;
    cmd.CommandText = String.Format(createTable, tableName, String.Join(", ", columns));
    cmd.ExecuteNonQuery();
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:46:58.307

这是我的“最终解决方案”。建议使用链接服务器的评论肯定会是一种更简单的方法，但是有一件事情阻止我做一开始我没有想到的事情，数据需要存在于 Access DB 中，因为用户可能会使用数据远离他们可以通过网络访问底层数据库的地方。因此，我一直在尝试这种方法，这就是我想出的：

请注意，我仍然愿意接受“更好的方法”的建议，但这解决了我目前的问题

```
static void CreateTableFromReader(string tableName, SqlDataReader reader) {
  List<string> columns = new List<string>();
  string createTable = @"CREATE TABLE {0} ({1})";

  var dt = reader.GetSchemaTable();
  foreach (DataRow dr in dt.Rows) {
    switch (dr["DataTypeName"].ToString().ToLower()) {
      case "varchar":
        columns.Add(String.Format("[{0}] {1}({2})",
          dr["ColumnName"],
          dr["DataTypeName"],
          dr["ColumnSize"]
        ));
        break;
      case "money": //i know this is redundant but being explicit helps clarity sometimes
      case "date":
      case "integer":
      default:
        columns.Add(String.Format("[{0}] {1}",
          dr["ColumnName"],
          dr["DataTypeName"]
        ));
        break;
    }
  }
  using (var cmd = conn_Access.CreateCommand()) {
    cmd.CommandType = CommandType.Text;
    cmd.CommandText = String.Format(createTable, tableName, String.Join(", ", columns));
    cmd.ExecuteNonQuery();
  }
} 
```

# maven - 如何在没有 maven 的情况下从 maven 存储库中获取工件？

> ID：14717852
> 
> 赞同：1
> 
> 时间：2013-02-05T22:03:43.567
> 
> 标签：maven, maven-3

首先，我不是 Maven 用户。我需要这个库：[https](https://github.com/ansell/JenaSesame) ://github.com/ansell/JenaSesame但只有源代码可用。自述文件显示了以下信息：

```
Repository

http://openjena.org/repo-dev

Group:      org.openjena 
Artifact:   jena-sesame 
```

但是当我浏览到那个位置时，我得到一个 404。我怎样才能从那个存储库中获取那个工件？如果需要，我愿意安装 maven；我只需要编译好的库 jars。

我已经在[http://search.maven.org](http://search.maven.org)搜索了 maven 中央存储库，但它不存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T22:11:57.373

任何可公开访问的存储库都应该可以在浏览器中查看，因此您应该能够下载其中包含的任何 JAR 文件。您列出的 URL ~~openjena.org/repo-dev~~ [[1]]看起来更像是一个开发存储库。世界上有很多存储库是内部存储库，所以这看起来像是一个尚未为公众使用而设置的存储库。

看起来他们有二进制版本可供下载：http: [//www.apache.org/dist/jena/](http://www.apache.org/dist/jena/) 你有没有在那里寻找你想要的东西？

[[1]：现在是垃圾邮件域 - 请访问[https://jena.apache.org/](https://jena.apache.org/)。]

# clojure - 如何在 Lein-Ring uberwar 中包含属性

> ID：14717865
> 
> 赞同：1
> 
> 时间：2013-02-05T22:04:28.933
> 
> 标签：clojure, leiningen, ring

我们正在尝试使用该`lein ring uberwar`命令在 JBoss 上对 Leiningen 项目进行测试部署。在我尝试读取属性文件之前，我在这方面取得了巨大的成功。

我有一个将属性文件读入地图的函数：

```
(defn load-properties
  [file-name]
  (with-open [^java.io.Reader reader (io/reader file-name)]
    (let [properties (java.util.Properties.)]
      (.load properties reader)
      (into {} (for [[k v] properties] [(keyword k) (read-string v)]))))) 
```

我像这样使用它：

```
(def settings (load-properties "application.properties")) 
```

“application.properties”是我的项目目录中的文件名。一切都很好`lein run`，但是当我创建独立战争并将其 cp 到 JBoss 时，这是堆栈跟踪：

```
16:51:08,140 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/kente].[kente.core/application servlet]] (http-/127.0.0.1:8080-1) Allocate exception for ser
vlet kente.core/application servlet: java.io.FileNotFoundException: application.properties (The system cannot find the file specified)
        at java.io.FileInputStream.open(Native Method) [rt.jar:1.6.0_37]
        at java.io.FileInputStream.<init>(Unknown Source) [rt.jar:1.6.0_37]
        at clojure.java.io$fn__8326.invoke(io.clj:233) [clojure-1.4.0.jar:]
        at clojure.java.io$fn__8265$G__8230__8272.invoke(io.clj:73) [clojure-1.4.0.jar:]
        at clojure.java.io$fn__8338.invoke(io.clj:262) [clojure-1.4.0.jar:]
        at clojure.java.io$fn__8265$G__8230__8272.invoke(io.clj:73) [clojure-1.4.0.jar:]
        at clojure.java.io$fn__8300.invoke(io.clj:169) [clojure-1.4.0.jar:]
        at clojure.java.io$fn__8239$G__8234__8246.invoke(io.clj:73) [clojure-1.4.0.jar:]
        at clojure.java.io$reader.doInvoke(io.clj:106) [clojure-1.4.0.jar:]
        at clojure.lang.RestFn.invoke(RestFn.java:410) [clojure-1.4.0.jar:]
        at kente.utils$load_properties.invoke(utils.clj:7) [classes:]
        at clojure.lang.AFn.applyToHelper(AFn.java:161) [clojure-1.4.0.jar:]
        at clojure.lang.AFn.applyTo(AFn.java:151) [clojure-1.4.0.jar:]
        at clojure.lang.Compiler$InvokeExpr.eval(Compiler.java:3382) [clojure-1.4.0.jar:]
        at clojure.lang.Compiler$DefExpr.eval(Compiler.java:398) [clojure-1.4.0.jar:]
        at clojure.lang.Compiler.eval(Compiler.java:6516) [clojure-1.4.0.jar:]
        at clojure.lang.Compiler.load(Compiler.java:6952) [clojure-1.4.0.jar:]
        at clojure.lang.RT.loadResourceScript(RT.java:359) [clojure-1.4.0.jar:]
        at clojure.lang.RT.loadResourceScript(RT.java:350) [clojure-1.4.0.jar:]
        at clojure.lang.RT.load(RT.java:429) [clojure-1.4.0.jar:]
        at clojure.lang.RT.load(RT.java:400) [clojure-1.4.0.jar:]
        at clojure.core$load$fn__4890.invoke(core.clj:5415) [clojure-1.4.0.jar:]
        at clojure.core$load.doInvoke(core.clj:5414) [clojure-1.4.0.jar:]
        at clojure.lang.RestFn.invoke(RestFn.java:408) [clojure-1.4.0.jar:]
        at clojure.core$load_one.invoke(core.clj:5227) [clojure-1.4.0.jar:]
        at clojure.core$load_lib.doInvoke(core.clj:5264) [clojure-1.4.0.jar:]
        at clojure.lang.RestFn.applyTo(RestFn.java:142) [clojure-1.4.0.jar:]
        at clojure.core$apply.invoke(core.clj:603) [clojure-1.4.0.jar:]
        at clojure.core$load_libs.doInvoke(core.clj:5298) [clojure-1.4.0.jar:]
        at clojure.lang.RestFn.applyTo(RestFn.java:137) [clojure-1.4.0.jar:]
        at clojure.core$apply.invoke(core.clj:605) [clojure-1.4.0.jar:]
        at clojure.core$use.doInvoke(core.clj:5392) [clojure-1.4.0.jar:]
        at clojure.lang.RestFn.invoke(RestFn.java:421) [clojure-1.4.0.jar:]
        at kente.core$eval9$loading__4784__auto____10.invoke(core.clj:1)
        at kente.core$eval9.invoke(core.clj:1)
        at clojure.lang.Compiler.eval(Compiler.java:6511) [clojure-1.4.0.jar:]
        at clojure.lang.Compiler.eval(Compiler.java:6501) [clojure-1.4.0.jar:]
        at clojure.lang.Compiler.load(Compiler.java:6952) [clojure-1.4.0.jar:]
        at clojure.lang.RT.loadResourceScript(RT.java:359) [clojure-1.4.0.jar:]
        at clojure.lang.RT.loadResourceScript(RT.java:350) [clojure-1.4.0.jar:]
        at clojure.lang.RT.load(RT.java:429) [clojure-1.4.0.jar:]
        at clojure.lang.RT.load(RT.java:400) [clojure-1.4.0.jar:]
        at clojure.core$load$fn__4890.invoke(core.clj:5415) [clojure-1.4.0.jar:]
        at clojure.core$load.doInvoke(core.clj:5414) [clojure-1.4.0.jar:]
        at clojure.lang.RestFn.invoke(RestFn.java:408) [clojure-1.4.0.jar:]
        at clojure.core$load_one.invoke(core.clj:5227) [clojure-1.4.0.jar:]
        at clojure.core$load_lib.doInvoke(core.clj:5264) [clojure-1.4.0.jar:]
        at clojure.lang.RestFn.applyTo(RestFn.java:142) [clojure-1.4.0.jar:]
        at clojure.core$apply.invoke(core.clj:603) [clojure-1.4.0.jar:]
        at clojure.core$load_libs.doInvoke(core.clj:5298) [clojure-1.4.0.jar:]
        at clojure.lang.RestFn.applyTo(RestFn.java:137) [clojure-1.4.0.jar:]
        at clojure.core$apply.invoke(core.clj:603) [clojure-1.4.0.jar:]
        at clojure.core$require.doInvoke(core.clj:5381) [clojure-1.4.0.jar:]
        at clojure.lang.RestFn.invoke(RestFn.java:421) [clojure-1.4.0.jar:]
        at kente.servlet$eval3$loading__4784__auto____4.invoke(servlet.clj:1)
        at kente.servlet$eval3.invoke(servlet.clj:1)
        at clojure.lang.Compiler.eval(Compiler.java:6511) [clojure-1.4.0.jar:]
        at clojure.lang.Compiler.eval(Compiler.java:6501) [clojure-1.4.0.jar:]
        at clojure.lang.Compiler.eval(Compiler.java:6500) [clojure-1.4.0.jar:]
        at clojure.lang.Compiler.load(Compiler.java:6952) [clojure-1.4.0.jar:]
        at clojure.lang.RT.loadResourceScript(RT.java:359) [clojure-1.4.0.jar:]
        at clojure.lang.RT.loadResourceScript(RT.java:350) [clojure-1.4.0.jar:]
        at clojure.lang.RT.load(RT.java:429) [clojure-1.4.0.jar:]
        at clojure.lang.RT.load(RT.java:400) [clojure-1.4.0.jar:]
        at clojure.core$load$fn__4890.invoke(core.clj:5415) [clojure-1.4.0.jar:]
        at clojure.core$load.doInvoke(core.clj:5414) [clojure-1.4.0.jar:]
        at clojure.lang.RestFn.invoke(RestFn.java:408) [clojure-1.4.0.jar:]
        at clojure.lang.Var.invoke(Var.java:415) [clojure-1.4.0.jar:]
        at kente.servlet.<clinit>(Unknown Source) [classes:]
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [rt.jar:1.6.0_37]
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) [rt.jar:1.6.0_37]
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) [rt.jar:1.6.0_37]
        at java.lang.reflect.Constructor.newInstance(Unknown Source) [rt.jar:1.6.0_37]
        at org.jboss.msc.value.ConstructedValue.getValue(ConstructedValue.java:61)
        at org.jboss.as.naming.ValueManagedReferenceFactory.getReference(ValueManagedReferenceFactory.java:49)
        at org.jboss.as.ee.component.ManagedReferenceInterceptorFactory$ManagedReferenceInterceptor.processInvocation(ManagedReferenceInterceptorFactory.java:90) [jboss-as-ee-7.1.3
.Final-redhat-4.jar:7.1.3.Final-redhat-4]
        at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final-redhat-2.jar:1.1.1.Final-redhat-2]
        at org.jboss.invocation.WeavedInterceptor.processInvocation(WeavedInterceptor.java:53) [jboss-invocation-1.1.1.Final-redhat-2.jar:1.1.1.Final-redhat-2]
        at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final-redhat-2.jar:1.1.1.Final-redhat-2]
        at org.jboss.as.ee.component.TCCLInterceptor.processInvocation(TCCLInterceptor.java:45) [jboss-as-ee-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4]
        at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final-redhat-2.jar:1.1.1.Final-redhat-2]
        at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final-redhat-2.jar:1.1.1.Final-redhat-2]
        at org.jboss.as.ee.component.BasicComponent.constructComponentInstance(BasicComponent.java:161) [jboss-as-ee-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4]
        at org.jboss.as.ee.component.BasicComponent.createInstance(BasicComponent.java:85) [jboss-as-ee-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4]
        at org.jboss.as.web.deployment.component.WebComponentInstantiator$1.<init>(WebComponentInstantiator.java:57) [jboss-as-web-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4]
        at org.jboss.as.web.deployment.component.WebComponentInstantiator.getReference(WebComponentInstantiator.java:55) [jboss-as-web-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4
]
        at org.jboss.as.web.deployment.WebInjectionContainer.instantiate(WebInjectionContainer.java:102) [jboss-as-web-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4]
        at org.jboss.as.web.deployment.WebInjectionContainer.newInstance(WebInjectionContainer.java:81) [jboss-as-web-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4]
        at org.jboss.as.web.deployment.WebInjectionContainer.newInstance(WebInjectionContainer.java:75) [jboss-as-web-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4]
        at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1156) [jbossweb-7.0.17.Final-redhat-1.jar:]
        at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:952) [jbossweb-7.0.17.Final-redhat-1.jar:]
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:188) [jbossweb-7.0.17.Final-redhat-1.jar:]
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.17.Final-redhat-1.jar:]
        at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:169) [jboss-as-web-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4]
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.17.Final-redhat-1.jar:]
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.17.Final-redhat-1.jar:]
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.17.Final-redhat-1.jar:]
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:372) [jbossweb-7.0.17.Final-redhat-1.jar:]
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.17.Final-redhat-1.jar:]
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:679) [jbossweb-7.0.17.Final-redhat-1.jar:]
        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:931) [jbossweb-7.0.17.Final-redhat-1.jar:] 
```

我注意到你可以设置一个名为[:war-resources-path](https://github.com/weavejester/lein-ring#resources)的 defproject 键，所以我将我的属性文件放入 $PROJECT_ROOT/war-resources 目录（[该目录的默认值](https://github.com/weavejester/lein-ring#resources)），但我仍然没有任何运气。

有谁知道使用从属性文件中读取的最佳方法`lein ring uberwar`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:13:32.533

jar/war 中的条目不是文件。`clojure.java.io/resource`您应该使用而不是`clojure.java.io/file`或裸路径字符串来引用属性（以及战争中的任何其他类型的资源） 。这将适用于文件系统上的本地资源以及战争中的资源。

您可以将资源放在项目根目录中的资源目录中，或者放在由 :resource-paths 指定的其他目录中，然后它们在类路径中可用，并且在您使用 lein ring 构建时也将包含在战争中。

# linux - 在 Linux 中将文件拆分为不相等的块

> ID：14717872
> 
> 赞同：7
> 
> 时间：2013-02-05T22:05:02.330
> 
> 标签：linux, bash, unix

我希望将一个大文件（大约 17M 行字符串）拆分为多个文件，每个块中的行数不同。是否可以像这样将数组发送到**“ *split -l* ”**命令：

```
[
 1=>1000000,
 2=>1000537,
 ...
] 
```

以便将那么多行发送到每个块

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-05T23:13:20.917

使用复合命令：

```
{
  head -n 10000 > output1
  head -n   200 > output2
  head -n  1234 > output3
  cat > remainder
} < yourbigfile 
```

这也适用于循环：

```
{
  i=1
  for n in 10000 200 1234
  do
      head -n $n > output$i
      let i++
  done
  cat > remainder
} < yourbigfile 
```

这在 OS X 上不起作用，其中`head`读取和丢弃额外的输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:18:33.910

该`split`命令没有该功能，因此您必须使用不同的工具，或编写自己的工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T22:58:10.193

您可以`sed`通过获取另一个脚本来`sed`为您生成命令。

```
# split_gen.py
use strict;
my @limits = ( 100, 250, 340,999);
my $filename = "joker";

my $start = 1;
foreach my $end (@limits) {
    print qq{sed -n '$start,${end}p;${end}q' $filename > $filename.$start-$end\n};
    $start = $end + 1;
} 
```

运行从而`perl split_gen.py`给出：

```
sed -n '1,100p;100q' joker > joker.1-100
sed -n '101,250p;250q' joker > joker.101-250
sed -n '251,340p;340q' joker > joker.251-340
sed -n '341,999p;999q' joker > joker.341-999 
```

如果您对命令感到满意，那么您可以

```
perl split_gen.py | sh 
```

然后享受等待，因为大文件可能会很慢。

# xml - SimpleXMLElement（调用未定义的方法 SimpleXMLElement）

> ID：14717874
> 
> 赞同：0
> 
> 时间：2013-02-05T22:05:05.747
> 
> 标签：xml, simplexml, php

我正在测试对 XML 存档的访问，但没有成功。你能帮帮我吗？

第一个存档：

```
<?php

include 'traffic.php';

$xmlstr = utf8_encode(file_get_contents('traffic.xml'));

$client = new SimpleXMLElement($xmlstr);

$maplink_key_soap = 'ymUFb0RjwnO6N1zXGKpFauF1vwLPTLvrGLSvaBVybCBPTM9qGBu9QR==';

class City {
    var $name = 'São Paulo';
    var $state = 'SP';
}

class Address {
    var $street = 'Funchal';
    var $district = '129' ;
    var $houseNumber;
    var $zip;
    var $city;

    public function __construct() {
        $this->city = new City();
    }
}

class ResultRange {
    var $pageIndex = 1;
    var $recordsPerPage = 10;
}

//Classe AddressOptions
class ao{
    var $matchType = 0;
    var $searchType = 2;
    var $usePhonetic = true;
    var $resultRange;

    public function __construct() {
        $this->resultRange = new ResultRange();
    }

}

$address = new Address();
$city = new City();
$ao = new ao();
$resultRange = new ResultRange();

$result = $client->findAddress(array('token' => $maplink_key_soap, 'address' => $address, 'ao' => $ao));

echo '<pre style=”clear:both;”&gt;'; print_r($result); echo '</pre>';?> 
```

第二个存档：

```
 <?php 
$xmlstr = <<<XML
<?xml version="1.0" encoding="utf-8"?>
<wsdl:definitions xmlns = "http://services.maplink.com.br/webservices/v3/AddressFinder/AddressFinder.asmx?wsdl" xmlns:s="http://www.w3.org/2001/XMLSchema" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:mime="http://schemas.xmlsoap.org/wsdl/mime/" xmlns:tns="http://webservices.maplink2.com.br" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:tm="http://microsoft.com/wsdl/mime/textMatching/" xmlns:http="http://schemas.xmlsoap.org/wsdl/http/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" targetNamespace="http://webservices.maplink2.com.br" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">
  <wsdl:types>
    <s:schema elementFormDefault="qualified" targetNamespace="http://webservices.maplink2.com.br">
      <s:element name="findPOI">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="0" maxOccurs="1" name="name" type="s:string" />
            <s:element minOccurs="1" maxOccurs="1" name="city" type="tns:City" />
            <s:element minOccurs="1" maxOccurs="1" name="resultRange" type="tns:ResultRange" />
            <s:element minOccurs="0" maxOccurs="1" name="token" type="s:string" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:complexType name="City">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="1" name="name" type="s:string" />
          <s:element minOccurs="0" maxOccurs="1" name="state" type="s:string" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="ResultRange">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="pageIndex" type="s:int" />
          <s:element minOccurs="1" maxOccurs="1" name="recordsPerPage" type="s:int" />
        </s:sequence>
      </s:complexType>
      <s:element name="findPOIResponse">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="findPOIResult" type="tns:POIInfo" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:complexType name="POIInfo">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="recordCount" type="s:int" />
          <s:element minOccurs="1" maxOccurs="1" name="pageCount" type="s:int" />
          <s:element minOccurs="0" maxOccurs="1" name="poiLocations" type="tns:ArrayOfPOILocation" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="ArrayOfPOILocation">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="unbounded" name="POILocation" type="tns:POILocation" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="POILocation">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="1" name="name" type="s:string" />
          <s:element minOccurs="0" maxOccurs="1" name="district" type="s:string" />
          <s:element minOccurs="1" maxOccurs="1" name="carAccess" type="s:boolean" />
          <s:element minOccurs="0" maxOccurs="1" name="dataSource" type="s:string" />
          <s:element minOccurs="1" maxOccurs="1" name="city" type="tns:City" />
          <s:element minOccurs="1" maxOccurs="1" name="point" type="tns:Point" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="Point">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="x" type="s:double" />
          <s:element minOccurs="1" maxOccurs="1" name="y" type="s:double" />
        </s:sequence>
      </s:complexType>
      <s:element name="findAddress">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="address" type="tns:Address" />
            <s:element minOccurs="1" maxOccurs="1" name="ao" type="tns:AddressOptions" />
            <s:element minOccurs="0" maxOccurs="1" name="token" type="s:string" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:complexType name="Address">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="1" name="street" type="s:string" />
          <s:element minOccurs="0" maxOccurs="1" name="houseNumber" type="s:string" />
          <s:element minOccurs="0" maxOccurs="1" name="zip" type="s:string" />
          <s:element minOccurs="0" maxOccurs="1" name="district" type="s:string" />
          <s:element minOccurs="1" maxOccurs="1" name="city" type="tns:City" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="AddressOptions">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="matchType" type="s:int" />
          <s:element minOccurs="1" maxOccurs="1" name="usePhonetic" type="s:boolean" />
          <s:element minOccurs="1" maxOccurs="1" name="searchType" type="s:int" />
          <s:element minOccurs="1" maxOccurs="1" name="resultRange" type="tns:ResultRange" />
        </s:sequence>
      </s:complexType>
      <s:element name="findAddressResponse">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="findAddressResult" type="tns:AddressInfo" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:complexType name="AddressInfo">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="recordCount" type="s:int" />
          <s:element minOccurs="1" maxOccurs="1" name="pageCount" type="s:int" />
          <s:element minOccurs="0" maxOccurs="1" name="addressLocation" type="tns:ArrayOfAddressLocation" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="ArrayOfAddressLocation">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="unbounded" name="AddressLocation" type="tns:AddressLocation" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="AddressLocation">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="1" name="key" type="s:string" />
          <s:element minOccurs="1" maxOccurs="1" name="address" type="tns:Address" />
          <s:element minOccurs="0" maxOccurs="1" name="zipL" type="s:string" />
          <s:element minOccurs="0" maxOccurs="1" name="zipR" type="s:string" />
          <s:element minOccurs="1" maxOccurs="1" name="carAccess" type="s:boolean" />
          <s:element minOccurs="0" maxOccurs="1" name="dataSource" type="s:string" />
          <s:element minOccurs="1" maxOccurs="1" name="point" type="tns:Point" />
        </s:sequence>
      </s:complexType>
      <s:element name="getAddress">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="point" type="tns:Point" />
            <s:element minOccurs="0" maxOccurs="1" name="token" type="s:string" />
            <s:element minOccurs="1" maxOccurs="1" name="tolerance" type="s:double" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:element name="getAddressResponse">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="getAddressResult" type="tns:AddressLocation" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:element name="getXY">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="address" type="tns:Address" />
            <s:element minOccurs="0" maxOccurs="1" name="token" type="s:string" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:element name="getXYResponse">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="getXYResult" type="tns:Point" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:element name="getXYRadiusWithMap">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="address" type="tns:Address" />
            <s:element minOccurs="1" maxOccurs="1" name="mo" type="tns:MapOptions" />
            <s:element minOccurs="1" maxOccurs="1" name="radius" type="s:int" />
            <s:element minOccurs="0" maxOccurs="1" name="token" type="s:string" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:complexType name="MapOptions">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="scaleBar" type="s:boolean" />
          <s:element minOccurs="1" maxOccurs="1" name="mapSize" type="tns:MapSize" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="MapSize">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="width" type="s:int" />
          <s:element minOccurs="1" maxOccurs="1" name="height" type="s:int" />
        </s:sequence>
      </s:complexType>
      <s:element name="getXYRadiusWithMapResponse">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="getXYRadiusWithMapResult" type="tns:MapInfo" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:complexType name="MapInfo">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="1" name="url" type="s:string" />
          <s:element minOccurs="1" maxOccurs="1" name="extent" type="tns:Extent" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="Extent">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="XMin" type="s:double" />
          <s:element minOccurs="1" maxOccurs="1" name="YMin" type="s:double" />
          <s:element minOccurs="1" maxOccurs="1" name="XMax" type="s:double" />
          <s:element minOccurs="1" maxOccurs="1" name="YMax" type="s:double" />
        </s:sequence>
      </s:complexType>
      <s:element name="findCity">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="cidade" type="tns:City" />
            <s:element minOccurs="1" maxOccurs="1" name="ao" type="tns:AddressOptions" />
            <s:element minOccurs="0" maxOccurs="1" name="token" type="s:string" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:element name="findCityResponse">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="findCityResult" type="tns:CityLocationInfo" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:complexType name="CityLocationInfo">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="recordCount" type="s:int" />
          <s:element minOccurs="1" maxOccurs="1" name="pageCount" type="s:int" />
          <s:element minOccurs="0" maxOccurs="1" name="cityLocation" type="tns:ArrayOfCityLocation" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="ArrayOfCityLocation">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="unbounded" name="CityLocation" type="tns:CityLocation" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="CityLocation">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="city" type="tns:City" />
          <s:element minOccurs="1" maxOccurs="1" name="point" type="tns:Point" />
          <s:element minOccurs="1" maxOccurs="1" name="carAccess" type="s:boolean" />
          <s:element minOccurs="0" maxOccurs="1" name="zipRangeStart" type="s:string" />
          <s:element minOccurs="0" maxOccurs="1" name="zipRangeEnd" type="s:string" />
          <s:element minOccurs="1" maxOccurs="1" name="capital" type="s:boolean" />
        </s:sequence>
      </s:complexType>
      <s:element name="GetCrossStreetXY">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="cidade" type="tns:City" />
            <s:element minOccurs="0" maxOccurs="1" name="firstStreet" type="s:string" />
            <s:element minOccurs="0" maxOccurs="1" name="secondStreet" type="s:string" />
            <s:element minOccurs="0" maxOccurs="1" name="token" type="s:string" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:element name="GetCrossStreetXYResponse">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="0" maxOccurs="1" name="GetCrossStreetXYResult" type="tns:ArrayOfCrossStreetLocation" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:complexType name="ArrayOfCrossStreetLocation">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="unbounded" name="CrossStreetLocation" nillable="true" type="tns:CrossStreetLocation" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="CrossStreetLocation">
        <s:sequence>
          <s:element minOccurs="1" maxOccurs="1" name="city" type="tns:City" />
          <s:element minOccurs="1" maxOccurs="1" name="point" type="tns:Point" />
          <s:element minOccurs="0" maxOccurs="1" name="crossStreet" type="s:string" />
          <s:element minOccurs="0" maxOccurs="1" name="district" type="s:string" />
          <s:element minOccurs="0" maxOccurs="1" name="street" type="s:string" />
          <s:element minOccurs="0" maxOccurs="1" name="zip" type="s:string" />
        </s:sequence>
      </s:complexType>
      <s:element name="GetCrossStreetAddress">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="1" maxOccurs="1" name="point" type="tns:Point" />
            <s:element minOccurs="0" maxOccurs="1" name="token" type="s:string" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:element name="GetCrossStreetAddressResponse">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="0" maxOccurs="1" name="GetCrossStreetAddressResult" type="tns:ArrayOfAddressLocation" />
          </s:sequence>
        </s:complexType>
      </s:element>
    </s:schema>
  </wsdl:types>
  <wsdl:message name="findPOISoapIn">
    <wsdl:part name="parameters" element="tns:findPOI" />
  </wsdl:message>
  <wsdl:message name="findPOISoapOut">
    <wsdl:part name="parameters" element="tns:findPOIResponse" />
  </wsdl:message>
  <wsdl:message name="findAddressSoapIn">
    <wsdl:part name="parameters" element="tns:findAddress" />
  </wsdl:message>
  <wsdl:message name="findAddressSoapOut">
    <wsdl:part name="parameters" element="tns:findAddressResponse" />
  </wsdl:message>
  <wsdl:message name="getAddressSoapIn">
    <wsdl:part name="parameters" element="tns:getAddress" />
  </wsdl:message>
  <wsdl:message name="getAddressSoapOut">
    <wsdl:part name="parameters" element="tns:getAddressResponse" />
  </wsdl:message>
  <wsdl:message name="getXYSoapIn">
    <wsdl:part name="parameters" element="tns:getXY" />
  </wsdl:message>
  <wsdl:message name="getXYSoapOut">
    <wsdl:part name="parameters" element="tns:getXYResponse" />
  </wsdl:message>
  <wsdl:message name="getXYRadiusWithMapSoapIn">
    <wsdl:part name="parameters" element="tns:getXYRadiusWithMap" />
  </wsdl:message>
  <wsdl:message name="getXYRadiusWithMapSoapOut">
    <wsdl:part name="parameters" element="tns:getXYRadiusWithMapResponse" />
  </wsdl:message>
  <wsdl:message name="findCitySoapIn">
    <wsdl:part name="parameters" element="tns:findCity" />
  </wsdl:message>
  <wsdl:message name="findCitySoapOut">
    <wsdl:part name="parameters" element="tns:findCityResponse" />
  </wsdl:message>
  <wsdl:message name="GetCrossStreetXYSoapIn">
    <wsdl:part name="parameters" element="tns:GetCrossStreetXY" />
  </wsdl:message>
  <wsdl:message name="GetCrossStreetXYSoapOut">
    <wsdl:part name="parameters" element="tns:GetCrossStreetXYResponse" />
  </wsdl:message>
  <wsdl:message name="GetCrossStreetAddressSoapIn">
    <wsdl:part name="parameters" element="tns:GetCrossStreetAddress" />
  </wsdl:message>
  <wsdl:message name="GetCrossStreetAddressSoapOut">
    <wsdl:part name="parameters" element="tns:GetCrossStreetAddressResponse" />
  </wsdl:message>
  <wsdl:portType name="AddressFinderSoap">
    <wsdl:operation name="findPOI">
      <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">Devolve uma lista contendo POI candidatos.</wsdl:documentation>
      <wsdl:input message="tns:findPOISoapIn" />
      <wsdl:output message="tns:findPOISoapOut" />
    </wsdl:operation>
    <wsdl:operation name="findAddress">
      <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">Devolve uma lista contendo endereços candidatos.</wsdl:documentation>
      <wsdl:input message="tns:findAddressSoapIn" />
      <wsdl:output message="tns:findAddressSoapOut" />
    </wsdl:operation>
    <wsdl:operation name="getAddress">
      <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">Devolve o endereço do ponto informado.</wsdl:documentation>
      <wsdl:input message="tns:getAddressSoapIn" />
      <wsdl:output message="tns:getAddressSoapOut" />
    </wsdl:operation>
    <wsdl:operation name="getXY">
      <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">Devolve a coordenada do endereço informado.</wsdl:documentation>
      <wsdl:input message="tns:getXYSoapIn" />
      <wsdl:output message="tns:getXYSoapOut" />
    </wsdl:operation>
    <wsdl:operation name="getXYRadiusWithMap">
      <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">Devolve a a coordenada do ponto informado e a URL do mapa.</wsdl:documentation>
      <wsdl:input message="tns:getXYRadiusWithMapSoapIn" />
      <wsdl:output message="tns:getXYRadiusWithMapSoapOut" />
    </wsdl:operation>
    <wsdl:operation name="findCity">
      <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">Devolve uma lista contendo dados da cidade informada.</wsdl:documentation>
      <wsdl:input message="tns:findCitySoapIn" />
      <wsdl:output message="tns:findCitySoapOut" />
    </wsdl:operation>
    <wsdl:operation name="GetCrossStreetXY">
      <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">Devolve a coordenada de um cruzamento</wsdl:documentation>
      <wsdl:input message="tns:GetCrossStreetXYSoapIn" />
      <wsdl:output message="tns:GetCrossStreetXYSoapOut" />
    </wsdl:operation>
    <wsdl:operation name="GetCrossStreetAddress">
      <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">Devolve os cruzamentos de uma coordenada</wsdl:documentation>
      <wsdl:input message="tns:GetCrossStreetAddressSoapIn" />
      <wsdl:output message="tns:GetCrossStreetAddressSoapOut" />
    </wsdl:operation>
  </wsdl:portType>
  <wsdl:binding name="AddressFinderSoap" type="tns:AddressFinderSoap">
    <soap:binding transport="http://schemas.xmlsoap.org/soap/http" />
    <wsdl:operation name="findPOI">
      <soap:operation soapAction="http://webservices.maplink2.com.br/findPOI" style="document" />
      <wsdl:input>
        <soap:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="findAddress">
      <soap:operation soapAction="http://webservices.maplink2.com.br/findAddress" style="document" />
      <wsdl:input>
        <soap:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="getAddress">
      <soap:operation soapAction="http://webservices.maplink2.com.br/getAddress" style="document" />
      <wsdl:input>
        <soap:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="getXY">
      <soap:operation soapAction="http://webservices.maplink2.com.br/getXY" style="document" />
      <wsdl:input>
        <soap:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="getXYRadiusWithMap">
      <soap:operation soapAction="http://webservices.maplink2.com.br/getXYRadiusWithMap" style="document" />
      <wsdl:input>
        <soap:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="findCity">
      <soap:operation soapAction="http://webservices.maplink2.com.br/findCity" style="document" />
      <wsdl:input>
        <soap:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="GetCrossStreetXY">
      <soap:operation soapAction="http://webservices.maplink2.com.br/GetCrossStreetXY" style="document" />
      <wsdl:input>
        <soap:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="GetCrossStreetAddress">
      <soap:operation soapAction="http://webservices.maplink2.com.br/GetCrossStreetAddress" style="document" />
      <wsdl:input>
        <soap:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
  </wsdl:binding>
  <wsdl:binding name="AddressFinderSoap12" type="tns:AddressFinderSoap">
    <soap12:binding transport="http://schemas.xmlsoap.org/soap/http" />
    <wsdl:operation name="findPOI">
      <soap12:operation soapAction="http://webservices.maplink2.com.br/findPOI" style="document" />
      <wsdl:input>
        <soap12:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap12:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="findAddress">
      <soap12:operation soapAction="http://webservices.maplink2.com.br/findAddress" style="document" />
      <wsdl:input>
        <soap12:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap12:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="getAddress">
      <soap12:operation soapAction="http://webservices.maplink2.com.br/getAddress" style="document" />
      <wsdl:input>
        <soap12:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap12:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="getXY">
      <soap12:operation soapAction="http://webservices.maplink2.com.br/getXY" style="document" />
      <wsdl:input>
        <soap12:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap12:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="getXYRadiusWithMap">
      <soap12:operation soapAction="http://webservices.maplink2.com.br/getXYRadiusWithMap" style="document" />
      <wsdl:input>
        <soap12:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap12:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="findCity">
      <soap12:operation soapAction="http://webservices.maplink2.com.br/findCity" style="document" />
      <wsdl:input>
        <soap12:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap12:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="GetCrossStreetXY">
      <soap12:operation soapAction="http://webservices.maplink2.com.br/GetCrossStreetXY" style="document" />
      <wsdl:input>
        <soap12:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap12:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="GetCrossStreetAddress">
      <soap12:operation soapAction="http://webservices.maplink2.com.br/GetCrossStreetAddress" style="document" />
      <wsdl:input>
        <soap12:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap12:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
  </wsdl:binding>
  <wsdl:service name="AddressFinder">
    <wsdl:port name="AddressFinderSoap" binding="tns:AddressFinderSoap">
      <soap:address location="http://services.maplink.com.br/webservices/v3/AddressFinder/AddressFinder.asmx" />
    </wsdl:port>
    <wsdl:port name="AddressFinderSoap12" binding="tns:AddressFinderSoap12">
      <soap12:address location="http://services.maplink.com.br/webservices/v3/AddressFinder/AddressFinder.asmx" />
    </wsdl:port>
  </wsdl:service>
</wsdl:definitions>
XML;
?> 
```

当我运行 index.php 时，我收到此错误：

> 致命错误：在第 51 行的 C:\wamp\www\xml\index.php 中调用未定义的方法 SimpleXMLElement::findAddress()"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:29:58.783

你把事情严重混淆了。您的“第一个存档”（无论您的意思是什么）看起来像一个 SOAP 调用，但这些行不适合：

```
$xmlstr = utf8_encode(file_get_contents('traffic.xml'));

$client = new SimpleXMLElement($xmlstr); 
```

现在取决于您在这里尝试做什么，我看到两个选项：

**A)**如果`traffic.xml`是“第二个存档”中的 WSDL，则应将这些行替换为：

```
$client = new SoapClient('traffic.xml'); 
```

但是参数必须是 XML 文件的文件名，而不是像`$xmlstr`“第二个存档”那样的字符串 - 但如果您*必须将*WSDL 作为字符串提供，这里有一个解决方案：[https ://stackoverflow.com /a/8152694/664108](https://stackoverflow.com/a/8152694/664108)

**B)**如果它是实际的 XML 数据，则脚本的其余部分没有意义，因为它试图从 Web 服务获取数据。我需要有关 XML 以及您正在尝试做什么的更多信息，以便为您提供帮助。

# migration - flyway：每次迁移后运行的通用脚本

> ID：14717875
> 
> 赞同：6
> 
> 时间：2013-02-05T22:05:11.943
> 
> 标签：migration, flyway

我有一个通用的清理脚本，我想在每次迁移后运行它。有没有一种好方法可以在每次迁移后运行此脚本（每次进行迁移时都没有将脚本本身作为更改包含在内？）

[我看到在Flyway 的迁移前和迁移后脚本](https://stackoverflow.com/questions/7219584/pre-and-post-migration-scripts-for-flyway)之前已经问过这个问题，当时的答案是否定的，不是真的。

在过去的 1.5 年里，答案是否发生了变化？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-06-16T19:12:59.830

使用 flyway 3.0，情况发生了变化，现在可以使用回调脚本。在这种情况下，可以使用 afterMigration.sql 文件进行清理。

有关详细信息，请参阅[http://flywaydb.org/documentation/callbacks.html](http://flywaydb.org/documentation/callbacks.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:57:39.090

我查看了此处的建议以及[Flyway 的迁移前和迁移后脚本，](https://stackoverflow.com/questions/7219584/pre-and-post-migration-scripts-for-flyway)并想指出一个我看不出哪种解决方法（如果有）最适用的用例。用例是让 dba 在运行开发人员创建的迁移之前创建一个还原点。

现在，通过我们的手动（非 flyway）迁移过程，dba 在运行一组迁移之前创建一个还原点。如果没有还原点，迁移将运行良好。但是，如果他们没有正确的代码（比如缺少创建列），通常最好回滚到 oracle 还原点，以避免停机并让开发人员有时间进行修复。

我不认为要求开发人员包含执行该还原点的迁移是有意义的，因为：1\. 他们可能会忘记（它应该自动发生，无需开发人员干预） 2\. 根据模式的状态，可能会有不同开始迁移，所以如果包含还原点的那个没有运行，它可能是旧的，并且数据可能在此期间发生了变化。

进行还原点的单独迁移具有类似的缺点： 1\. 他们必须手动创建一个新迁移，该迁移本质上是具有不同版本号的旧迁移的副本来执行还原点。

对于具有大量现有数据的开发模式，在开发迁移时清理模式是不切实际的，因为它早于 flyway 并且可能需要大量时间从头开始重新创建。

对于开发，理想情况下的工作流程是这样的：1\. 创建还原点 2\. 开发迁移，使用 flyway 运行 3\. 如果迁移不能按要求工作，则回滚到还原点。

如果有一种方法可以全面自动化步骤#1，它将允许我们使用 flyway 并消除对 dba 的需要，除非出现问题并且需要回滚。可能有一种更“可行”的方法来解决问题，但我发现的解决方法似乎不适合我们现有的工作流程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T09:06:17.910

这没有改变。现在使用任何建议的解决方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-31T15:02:41.407

我们遇到了同样的问题。即，在每次迁移之前和之后总是调用一堆脚本。例如，删除和创建物化视图，授予表权限。这些脚本不会随着迁移而变化，但需要执行。

所以我采用了`org.flywaydb.core.internal.callback.SqlScriptFlywayCallback`回调类并将其调整为多个文件。

我试图留在哲学中`flyway`并使用以下模式。`am__`以或开头的文件`AM__`是迁移后脚本，以 或 开头的文件`bi__`是用于之前的信息，依此类推。我对脚本进行排序，以便它们以正确的顺序执行。

```
public class MultipleScriptPerCallback extends BaseFlywayCallback {
private static final Log LOG = LogFactory.getLog(SqlScriptFlywayCallback.class);
private static final String DELIMITER = "__";

private static final String BEFORE_CLEAN = "bc";
private static final String AFTER_CLEAN = "ac";
private static final String BEFORE_MIGRATE = "bm";
private static final String AFTER_MIGRATE = "am";
private static final String BEFORE_EACH_MIGRATE = "bem";
private static final String AFTER_EACH_MIGRATE = "aem";
private static final String BEFORE_VALIDATE = "bv";
private static final String AFTER_VALIDATE = "av";
private static final String BEFORE_BASELINE = "bb";
private static final String AFTER_BASELINE = "ab";
private static final String BEFORE_REPAIR = "br";
private static final String AFTER_REPAIR = "ar";
private static final String BEFORE_INFO = "bi";
private static final String AFTER_INFO = "ai";

private static final List<String> ALL_CALLBACKS = Arrays.asList(BEFORE_CLEAN, AFTER_CLEAN, BEFORE_MIGRATE, BEFORE_EACH_MIGRATE,
        AFTER_EACH_MIGRATE, AFTER_MIGRATE, BEFORE_VALIDATE, AFTER_VALIDATE, BEFORE_BASELINE, AFTER_BASELINE, BEFORE_REPAIR,
        AFTER_REPAIR, BEFORE_INFO, AFTER_INFO);

private Map<String, List<SqlScript>> scripts;

@Override
public void setFlywayConfiguration(FlywayConfiguration flywayConfiguration) {
    super.setFlywayConfiguration(flywayConfiguration);

    if (scripts == null) {
        scripts = registerScripts(flywayConfiguration);
    }
}

private Map<String, List<SqlScript>> registerScripts(FlywayConfiguration flywayConfiguration) {
    Map<String, List<SqlScript>> scripts = new HashMap<>();
    for (String callback : ALL_CALLBACKS) {
        scripts.put(callback, new ArrayList<SqlScript>());
    }

    LOG.debug(String.format("%s - Scanning for Multiple SQL callbacks ...", getClass().getSimpleName()));
    Locations locations = new Locations(flywayConfiguration.getLocations());
    Scanner scanner = new Scanner(flywayConfiguration.getClassLoader());
    String sqlMigrationSuffix = flywayConfiguration.getSqlMigrationSuffix();
    DbSupport dbSupport = dbSupport(flywayConfiguration);
    PlaceholderReplacer placeholderReplacer = createPlaceholderReplacer();
    String encoding = flywayConfiguration.getEncoding();

    for (Location location : locations.getLocations()) {
        Resource[] resources;
        try {
            resources = scanner.scanForResources(location, "", sqlMigrationSuffix);
        } catch (FlywayException e) {
            // Ignore missing locations
            continue;
        }
        for (Resource resource : resources) {
            String key = extractKeyFromFileName(resource);
            if (scripts.keySet().contains(key)) {
                LOG.debug(getClass().getSimpleName() + " - found script " + resource.getFilename() + " from location: " + location);
                List<SqlScript> sqlScripts = scripts.get(key);
                sqlScripts.add(new SqlScript(dbSupport, resource, placeholderReplacer, encoding));
            }
        }
    }

    LOG.info(getClass().getSimpleName() + " - scripts registered: " + prettyPrint(scripts));
    return scripts;
}

private String prettyPrint(Map<String, List<SqlScript>> scripts) {
    StringBuilder prettyPrint = new StringBuilder();
    boolean isFirst = true;
    for (String key : scripts.keySet()) {
        if (!isFirst) {
            prettyPrint.append("; ");
        }
        prettyPrint.append(key).append("=").append("[").append(prettyPrint(scripts.get(key))).append("]");
        isFirst = false;
    }
    return prettyPrint.toString();
}

private String prettyPrint(List<SqlScript> scripts) {
    StringBuilder prettyPrint = new StringBuilder();
    boolean isFirst = true;
    for (SqlScript script : scripts) {
        if (!isFirst) {
            prettyPrint.append(", ");
        }
        prettyPrint.append(script.getResource().getFilename());
        isFirst = false;
    }
    return prettyPrint.toString();
}

private String extractKeyFromFileName(Resource resource) {
    String filename = resource.getFilename();
    eturn filename.substring(0, (!filename.contains(DELIMITER)) ? 0 : filename.indexOf(DELIMITER)).toLowerCase();
}

private DbSupport dbSupport(FlywayConfiguration flywayConfiguration) {
    Connection connectionMetaDataTable = JdbcUtils.openConnection(flywayConfiguration.getDataSource());
    return DbSupportFactory.createDbSupport(connectionMetaDataTable, true);
}

/**
 * @return  A new, fully configured, PlaceholderReplacer.
 */
private PlaceholderReplacer createPlaceholderReplacer() {
    if (flywayConfiguration.isPlaceholderReplacement()) {
        return
            new PlaceholderReplacer(flywayConfiguration.getPlaceholders(), flywayConfiguration.getPlaceholderPrefix(),
                flywayConfiguration.getPlaceholderSuffix());
    }

    return PlaceholderReplacer.NO_PLACEHOLDERS;
}

@Override
public void beforeClean(Connection connection) {
    execute(BEFORE_CLEAN, connection);
}

@Override
public void afterClean(Connection connection) {
    execute(AFTER_CLEAN, connection);
}

@Override
public void beforeMigrate(Connection connection) {
    execute(BEFORE_MIGRATE, connection);
}

@Override
public void afterMigrate(Connection connection) {
    execute(AFTER_MIGRATE, connection);
}

@Override
public void beforeEachMigrate(Connection connection, MigrationInfo info) {
    execute(BEFORE_EACH_MIGRATE, connection);
}

@Override
public void afterEachMigrate(Connection connection, MigrationInfo info) {
    execute(AFTER_EACH_MIGRATE, connection);
}

@Override
public void beforeValidate(Connection connection) {
    execute(BEFORE_VALIDATE, connection);
}

@Override
public void afterValidate(Connection connection) {
    execute(AFTER_VALIDATE, connection);
}

@Override
public void beforeBaseline(Connection connection) {
    execute(BEFORE_BASELINE, connection);
}

@Override
public void afterBaseline(Connection connection) {
    execute(AFTER_BASELINE, connection);
}

@Override
public void beforeRepair(Connection connection) {
    execute(BEFORE_REPAIR, connection);
}

@Override
public void afterRepair(Connection connection) {
    execute(AFTER_REPAIR, connection);
}

@Override
public void beforeInfo(Connection connection) {
    execute(BEFORE_INFO, connection);
}

@Override
public void afterInfo(Connection connection) {
    execute(AFTER_INFO, connection);
}

private void execute(String key, Connection connection) {
    List<SqlScript> sqlScripts = scripts.get(key);
    LOG.debug(String.format("%s - sqlscript: %s for key: %s", getClass().getSimpleName(), sqlScripts, key));
    Collections.sort(sqlScripts, new SqlScriptLexicalComparator());
    for (SqlScript script : sqlScripts) {
        executeScript(key, connection, script);
    }
}

//Not private for testing
void executeScript(String key, Connection connection, SqlScript script) {
    LOG.info(String.format("%s - Executing SQL callback: %s : %s", getClass().getSimpleName(), key,
            script.getResource().getFilename()));
    script.execute(new JdbcTemplate(connection, 0));
}

//Not private for testing
static final class SqlScriptLexicalComparator implements Comparator<SqlScript> {
    @Override
    public int compare(SqlScript o1, SqlScript o2) {
        return Collator.getInstance().compare(o1.getResource().getFilename(), o2.getResource().getFilename());
    }
} 
```

}

# c# - Windows 上的字体名称是否只有英文？

> ID：14717877
> 
> 赞同：14
> 
> 时间：2013-02-05T22:05:15.603
> 
> 标签：c#, c++, windows, fonts, font-face

只是好奇，Windows 上的字体名称是否总是有英文面孔名称，或者它们是否可以根据用户选择的 UI 语言进行本地化？

也就是说，`Times New Roman`在中文安装Windows上也这么叫吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T22:10:56.670

如果字体创建者选择为特定语言环境发布元数据，则字体名称会被本地化，但所有字体都有一个系统已知的名称，通常是 PostScript 名称，以确保可以以合理的可靠性引用和检索相同的字体。

对于 OpenType 和 TrueType 字体，您可以在`name`OpenType 文件的记录中找到本地化名称。

[命名表（OpenType 规范 1.6）@Microsoft 排版](http://www.microsoft.com/typography/otspec/name.htm)
[字体名称表（TrueType 规范）@Apple](https://developer.apple.com/fonts/TTRefMan/RM06/Chap6name.html)

对于 PostScript Type 1 字体，您可以通过它们的 FontName 声明找到分配的名称。

[Adobe Type 1 字体格式 @ Adob​​e (PDF)](http://partners.adobe.com/public/developer/en/font/T1_SPEC.PDF)

更新：

我检查了 PostScript 名称是否可用于实例化字体，不幸的是它不起作用。但是，使用本地化名称（从 Mark Ransom 在他的评论中的链接中检索到）确实有效。此示例使用 C#。

```
using System.Drawing;

namespace FontNameCheckApplication
{
    class Program
    {
        [STAThread]
        static void Main(string[] args)
        {
            Font TimesNewRomanByPSName = new Font("TimesNewRomanPSMT", 16f);
            Console.WriteLine("TimesNewRomanPSMT = {0}", TimesNewRomanByPSName.Name);

            Font TimesNewRomanByName = new Font("Times New Roman", 16f);
            Console.WriteLine("Times New Roman = {0}", TimesNewRomanByName.Name);

            Font ArialByPSName = new Font("ArialMT", 16f);
            Console.WriteLine("ArialMT = {0}", ArialByPSName.Name);

            Font ArialByName = new Font("Arial", 16f);
            Console.WriteLine("Arial = {0}", ArialByName.Name);

            Font GulimByEnglishName = new Font("Gulim", 16f);
            Console.WriteLine("Gulim = {0}", GulimByEnglishName.Name);

            Font GulimByKoreanName = new Font("굴림", 16f);
            Console.WriteLine("굴림 = {0}", GulimByKoreanName.Name);

            Console.ReadKey();
        }
    }
} 
```

不幸的是，我们在字体替换上遇到了麻烦，因为“Microsoft Sans Serif”绝对不是 Times New Roman 或 Arial。这表明 PostScript 名称不能可靠地用于引用相同的字体。

这是输出：

```
TimesNewRomanPSMT = Microsoft Sans Serif
Times New Roman = Times New Roman
ArialMT = Microsoft Sans Serif
Arial = Arial
Gulim = Gulim
?? = Gulim 
```

更新#2：

这是 Win32 的示例。

需要注意的一件事`CreateFontIndirect()`是可以替换。在运行这个示例时，我从来没有得到一个空句柄，即使是 PostScript 名称也是如此。要查看我们是否可以获得未替换的匹配，我们应该使用`EnumFontFamiliesEx()`扫描可用的系统字体列表。我们得到与 C# 相同的结果，但没有替换。对于某些字体，结果可能取决于图形模式设置（参见`SetGraphicsMode()`/GM_ADVANCED）。

[LOGFONT 结构（Windows） @MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145037.aspx)
[CreateFontIndirect 函数（Windows）](http://msdn.microsoft.com/en-us/library/dd183500.aspx)
[@MSDN SetGraphicsMode 函数（Windows）@MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162977.aspx)
[EnumFontFamiliesEx 函数（Windows） @MSDN](http://msdn.microsoft.com/en-us/library/dd162620.aspx)
[EnumFontFamExProc 回调函数（Windows） @MSDN](http://msdn.microsoft.com/en-us/library/dd162618.aspx)

```
#include "stdafx.h"
#include <Windows.h>

void TestCreateFont(LPCTSTR lpczFontName, BYTE bCharSet)
{
  LOGFONT lf;
  lf.lfHeight = 0;
  lf.lfWidth = 0;
  lf.lfEscapement = 0;
  lf.lfOrientation = 0;
  lf.lfWeight = FW_DONTCARE;
  lf.lfItalic = FALSE;
  lf.lfUnderline = FALSE;
  lf.lfStrikeOut = FALSE;
  lf.lfCharSet = bCharSet;
  lf.lfOutPrecision = OUT_OUTLINE_PRECIS;
  lf.lfClipPrecision = CLIP_DEFAULT_PRECIS;
  lf.lfQuality = DEFAULT_QUALITY;
  lf.lfPitchAndFamily = DEFAULT_PITCH;  
  // NOTE: LF_FACESIZE = 32, WinGdi.h
  _tcsncpy_s(lf.lfFaceName, 32, lpczFontName, _tcsnlen(lpczFontName, 32));

  HFONT hf = ::CreateFontIndirect(&lf);

  // NOTE: LF_FACESIZE = 32, WinGdi.h
  _tprintf_s(_T("TestCreateFont:\r\n%.32s = %.32s, bCharSet=%d, HFONT=0x%8.8x\r\n\r\n"), lpczFontName, lf.lfFaceName, bCharSet, hf);

  ::DeleteObject(hf);
}

int CALLBACK MyEnumFontFamExProc(const LOGFONT *lpelfe, const TEXTMETRIC *lpntme, DWORD FontType, LPARAM lParam)
{
  _tprintf_s(_T("  Found: %.32s, bCharSet=%d\r\n"), lpelfe->lfFaceName, lpelfe->lfCharSet);

  return 1;
}

void TestEnumFontFamiliesEx(LPCTSTR lpczFontName, BYTE bCharSet)
{
  LOGFONT lf;
  lf.lfHeight = 0;
  lf.lfWidth = 0;
  lf.lfEscapement = 0;
  lf.lfOrientation = 0;
  lf.lfWeight = FW_DONTCARE;
  lf.lfItalic = FALSE;
  lf.lfUnderline = FALSE;
  lf.lfStrikeOut = FALSE;
  lf.lfCharSet = bCharSet;
  lf.lfOutPrecision = OUT_OUTLINE_PRECIS;
  lf.lfClipPrecision = CLIP_DEFAULT_PRECIS;
  lf.lfQuality = DEFAULT_QUALITY;
  lf.lfPitchAndFamily = DEFAULT_PITCH; // NOTE: DEFAULT_PITCH = 0, WinGdi.h
  // NOTE: LF_FACESIZE = 32, WinGdi.h
  _tcsncpy_s(lf.lfFaceName, 32, lpczFontName, _tcsnlen(lpczFontName, 32));

  _tprintf_s(_T("TestEnumFontFamiliesEx: %.32s, bCharSet=%d\r\n"), lpczFontName, bCharSet);

  HDC hdcAll = GetDC(NULL);

  ::EnumFontFamiliesEx(hdcAll, &lf, &MyEnumFontFamExProc, 0, 0);
}

int _tmain(int argc, _TCHAR* argv[])
{
  TestCreateFont(_T("TimesNewRomanPSMT"), DEFAULT_CHARSET);
  TestCreateFont(_T("Times New Roman"), DEFAULT_CHARSET);

  TestCreateFont(_T("ArialMT"), DEFAULT_CHARSET);
  TestCreateFont(_T("Arial"), DEFAULT_CHARSET);

  TestCreateFont(_T("Gulim"), DEFAULT_CHARSET);

  TestCreateFont(_T("굴림"), DEFAULT_CHARSET);

  TestEnumFontFamiliesEx(_T("TimesNewRomanPSMT"), DEFAULT_CHARSET);
  TestEnumFontFamiliesEx(_T("Times New Roman"), DEFAULT_CHARSET);

  TestEnumFontFamiliesEx(_T("ArialMT"), DEFAULT_CHARSET);
  TestEnumFontFamiliesEx(_T("Arial"), DEFAULT_CHARSET);

  TestEnumFontFamiliesEx(_T("Gulim"), DEFAULT_CHARSET);

  TestEnumFontFamiliesEx(_T("굴림"), DEFAULT_CHARSET);

  return 0;
} 
```

结果如下：

```
TestCreateFont:
TimesNewRomanPSMT = TimesNewRomanPSMT, bCharSet=1, HFONT=0xda0a117c

TestCreateFont:
Times New Roman = Times New Roman, bCharSet=1, HFONT=0xdb0a117c

TestCreateFont:
ArialMT = ArialMT, bCharSet=1, HFONT=0xdc0a117c

TestCreateFont:
Arial = Arial, bCharSet=1, HFONT=0xdd0a117c

TestCreateFont:
Gulim = Gulim, bCharSet=1, HFONT=0xde0a117c

TestCreateFont:
?? = ??, bCharSet=1, HFONT=0xdf0a117c

TestEnumFontFamiliesEx: TimesNewRomanPSMT, bCharSet=1
TestEnumFontFamiliesEx: Times New Roman, bCharSet=1
  Found: Times New Roman, bCharSet=0
  Found: Times New Roman, bCharSet=177
  Found: Times New Roman, bCharSet=178
  Found: Times New Roman, bCharSet=161
  Found: Times New Roman, bCharSet=162
  Found: Times New Roman, bCharSet=186
  Found: Times New Roman, bCharSet=238
  Found: Times New Roman, bCharSet=204
  Found: Times New Roman, bCharSet=163
  Found: Times New Roman, bCharSet=0
  Found: Times New Roman, bCharSet=177
  Found: Times New Roman, bCharSet=161
  Found: Times New Roman, bCharSet=162
  Found: Times New Roman, bCharSet=186
  Found: Times New Roman, bCharSet=238
  Found: Times New Roman, bCharSet=204
  Found: Times New Roman, bCharSet=163
  Found: Times New Roman, bCharSet=0
  Found: Times New Roman, bCharSet=177
  Found: Times New Roman, bCharSet=178
  Found: Times New Roman, bCharSet=161
  Found: Times New Roman, bCharSet=162
  Found: Times New Roman, bCharSet=186
  Found: Times New Roman, bCharSet=238
  Found: Times New Roman, bCharSet=204
  Found: Times New Roman, bCharSet=163
  Found: Times New Roman, bCharSet=0
  Found: Times New Roman, bCharSet=177
  Found: Times New Roman, bCharSet=161
  Found: Times New Roman, bCharSet=162
  Found: Times New Roman, bCharSet=186
  Found: Times New Roman, bCharSet=238
  Found: Times New Roman, bCharSet=204
  Found: Times New Roman, bCharSet=163
TestEnumFontFamiliesEx: ArialMT, bCharSet=1
TestEnumFontFamiliesEx: Arial, bCharSet=1
  Found: Arial, bCharSet=0
  Found: Arial, bCharSet=177
  Found: Arial, bCharSet=178
  Found: Arial, bCharSet=161
  Found: Arial, bCharSet=162
  Found: Arial, bCharSet=186
  Found: Arial, bCharSet=238
  Found: Arial, bCharSet=204
  Found: Arial, bCharSet=163
  Found: Arial, bCharSet=0
  Found: Arial, bCharSet=177
  Found: Arial, bCharSet=161
  Found: Arial, bCharSet=162
  Found: Arial, bCharSet=186
  Found: Arial, bCharSet=238
  Found: Arial, bCharSet=204
  Found: Arial, bCharSet=163
  Found: Arial, bCharSet=0
  Found: Arial, bCharSet=177
  Found: Arial, bCharSet=178
  Found: Arial, bCharSet=161
  Found: Arial, bCharSet=162
  Found: Arial, bCharSet=186
  Found: Arial, bCharSet=238
  Found: Arial, bCharSet=204
  Found: Arial, bCharSet=163
  Found: Arial, bCharSet=0
  Found: Arial, bCharSet=177
  Found: Arial, bCharSet=161
  Found: Arial, bCharSet=162
  Found: Arial, bCharSet=186
  Found: Arial, bCharSet=238
  Found: Arial, bCharSet=204
  Found: Arial, bCharSet=163
TestEnumFontFamiliesEx: Gulim, bCharSet=1
  Found: Gulim, bCharSet=0
  Found: Gulim, bCharSet=129
  Found: Gulim, bCharSet=161
  Found: Gulim, bCharSet=162
  Found: Gulim, bCharSet=186
  Found: Gulim, bCharSet=238
  Found: Gulim, bCharSet=204
TestEnumFontFamiliesEx: ??, bCharSet=1
  Found: Gulim, bCharSet=0
  Found: Gulim, bCharSet=129
  Found: Gulim, bCharSet=161
  Found: Gulim, bCharSet=162
  Found: Gulim, bCharSet=186
  Found: Gulim, bCharSet=238
  Found: Gulim, bCharSet=204 
```

这是 CharSet 值的片段`wingdi.h`。

```
#define ANSI_CHARSET            0
#define DEFAULT_CHARSET         1
#define SYMBOL_CHARSET          2
#define SHIFTJIS_CHARSET        128
#define HANGEUL_CHARSET         129
#define HANGUL_CHARSET          129
#define GB2312_CHARSET          134
#define CHINESEBIG5_CHARSET     136
#define OEM_CHARSET             255

#define JOHAB_CHARSET           130
#define HEBREW_CHARSET          177
#define ARABIC_CHARSET          178
#define GREEK_CHARSET           161
#define TURKISH_CHARSET         162
#define VIETNAMESE_CHARSET      163
#define THAI_CHARSET            222
#define EASTEUROPE_CHARSET      238
#define RUSSIAN_CHARSET         204

#define MAC_CHARSET             77
#define BALTIC_CHARSET          186 
```

# java - 如何在具有参数和自定义返回对象的方法上运行 junit 测试

> ID：14717880
> 
> 赞同：3
> 
> 时间：2013-02-05T22:05:19.540
> 
> 标签：java, unit-testing, junit, junit4

我对 Junit 和单元测试完全陌生，我想开始对我的代码进行单元测试。我想从如下所示的方法开始：

```
 public Store loadStore(Integer customerId,
                Integer storeId){
        //The logic of this method selects a store from a database based on the parameter criteria
    } 
```

从这篇文章[http://www.vogella.com/articles/JUnit/article.html](http://www.vogella.com/articles/JUnit/article.html)我读到可以做出以下断言：

*   失败（字符串） assertTrue（真）
*   assertTrue（[消息]，布尔条件）
*   assertsEquals（[字符串消息]，预期，实际）
*   assertsEquals（[字符串消息]，预期，实际，公差）
*   assertNull（[消息]，对象）
*   assertNotNull（[消息]，对象）
*   assertSame（[String]，预期，实际）
*   assertNotSame（[字符串]，预期，实际）

我对这个方法使用哪个断言感到困惑。我应该使用几个吗？我应该使用一个吗？应该用这种方法的单元测试来证明什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T02:29:39.480

```
/**
 * This is a small example to get you started.
 * This is an example of a test class to test your loadStore
 * It assumes this method is defined in a class called StoreManager.
 * It encapsulates all the tests that are required within the same test method for
 * expediency sake. You generally should restrict one core functionality per test.
 * but if writing functional test, you can groupd core functionality together.
 * 
 * Provide you default input data. Provide data that should pass as well
 * as data that should fail or error according to all the possible conditions you can think off.
 * 
 * it is fine to hardcode the data when when starting out but later you need to look
 * into defining test data in some sort of reusable way as well as easy to maintain as data changes.
 * 
 * it is good practice not to run test against DB databases.
 * 
 * 
 */

import static org.junit.Assert.*;
import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

import org.junit.After;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;
public class StoreManagerTest {

@BeforeClass
    public void before()
    {
    //in here do some pre-initilization for each test class if needed
    //database login if needed 
    //mock objects if needed etc
    }

@Before
public void beforeTest()
{
    //in here do some pre-initilization for each test if needed

}

@After
public void afterTest()
{
    //in here do some cleanup for each test if needed
}

@Test
public void testloadStore() {

        StoreManager storeManager = new StoreManager();
        Integer validCustomerId = new Integer(9876);
        Integer invalidCustomerId = new Integer(-10);

        Integer validStoreId = new Integer(2345);
        Integer invalidStoreId = new Integer(-345);

        String validCustomerName = new String("validname);

        String validStoreName = new String("validStoreName);

        //Test first with valid id.
        //expect to return a store. if store is undefined the assertTrue will fail.
        //if you get an error fail. need to invetigate why you are failing with valid store id and valid customer id.
        try{
            Store store = storeManager.loadStore(validCustomerId, validStoreId);
            assertNotNull(store);
            assertTrue(store.getStoreId().equals(validStoreId));
            assertTrue("customer id match : " , store.getCustomerId().equals(validCustomerId));
            //you can also check for other parameters that exist in store object
            assertSame("customer Name match :  ", store.getCustomerName(), validCustomerName);
            assertSame("Store Name match :  ", store.getStoreName(), validStoreName);
        }catch(Exception e){
            fail("testHashCode Failed! " + e.getMessage());
        }

        //Test  with valid id and invalid customerid
        //expect error or null store. if store is undefined the assertTrue will pass.
        //if you get an error fail perfectly valid to assume the test passed but you can write other test to test
        //whether the error condition is what was expected.
        try{
            Store store = storeManager.loadStore(invalidCustomerId, validStoreId);
            assertNull(store);
        }catch(Exception e){
            assertTrue("No Store matching :  "+invalidCustomerId, true);
        }

        //Test  with invalid  storeid and valid customerid
        //expect error or null store. if store is undefined the assertTrue will pass.
        //if you get an error fail perfectly valid to assume the test passed but you can write other test to test
        //whether the error condition is what was expected.
        try{
            Store store = storeManager.loadStore(validCustomerId, invalidStoreId);
            assertNull(store);
        }catch(Exception e){
            assertTrue(true);
        }

        //Test  with invalid  storeid and invalid customerid
        //expect error or null store. if store is undefined the assertTrue will pass.
        //if you get an error fail perfectly valid to assume the test passed but you can write other test to test
        //whether the error condition is what was expected.
        try{
            Store store = storeManager.loadStore(null, null);
            assertNull(store);
        }catch(Exception e){
            assertTrue(true);
        }

}

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:27:01.967

如果方法是访问数据库，您可以使用内存数据库而不是生产数据库。在@Before 和@Before 方法中，您可以初始化状态或清除状态。

如果难以围绕对象创建上下文，您可以使用 Mockito 或 Powermock 等框架来伪造上下文并仅测试部分（单元）。

我建议先阅读一些教程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T22:18:41.853

一般的想法可能是这样的：

```
Store store = loadStore(1, 1);
assertTrue("Test failed", store.somePropertyOrMethodOfYourStore==SomeValueYouExpect); 
```

虽然老实说你应该做一个教程，但这对于一般的单元测试来说是非常基本的东西。

# php - laravel 使用没有链接的查询生成器

> ID：14717883
> 
> 赞同：4
> 
> 时间：2013-02-05T22:05:33.070
> 
> 标签：php, laravel, laravel-4

我有一个有效的查询生成器：

```
 $article = Page::where('slug', '=', $slug)
                     ->where('hide', '=', $hidden)
                     ->first(); 
```

但是如果 hidden 等于 1，我只想添加第二个 where 语句。我尝试了下面的代码，它显示了我正在尝试做的事情的逻辑，但它不起作用。

```
$article = Page::where('slug', '=', $slug);
if ($hidden == 1) {
    $article->where('hide', '=', 1);
}
$article->first(); 
```

我正在使用 Laravel 4，但我认为问题仍然存在于 Laravel 3 中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T22:09:41.480

是的，Eloquent 和查询构建器有一点“陷阱”。试试下面的代码；）

```
$query = Page::where('slug', '=', $slug);

if ($hidden == 1) {
    $query = $query->where('hide', '=', 1);
}

$article = $query->first(); 
```

注意条件中 $query 的分配。这是因为第一个 where （静态调用）返回一个不同的对象到条件内的查询对象。我相信由于最近的一次提交，解决这个问题的一种方法是这样的：

```
$query = Page::where('slug', '=', $slug)->query(); 
```

这将返回查询对象，您可以正常执行您想要的操作（而不是重新分配 $query）。

希望有帮助。

# asp.net - 用于在 ASP.net 应用程序中进行 JSON 序列化的现代工具

> ID：14717887
> 
> 赞同：0
> 
> 时间：2013-02-05T22:05:46.650
> 
> 标签：asp.net, json

我目前正在学习如何在 ASP.net 中编程。我有兴趣从数据库中获取记录并将结果简单地序列化为 JSON 以传递给客户端。是否有任何现代工具可以帮助进行 JSON 序列化？理想情况下，Ruby on Rails 中的以下内容将是幻想：

`foo = Foo.find(1)`
`foo.to_json`# 将结果传送到浏览器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:09:03.520

Newtonsoft 的[Json.NET](http://json.codeplex.com/)是当今最流行的。您可以通过 NuGet 安装它。

请记住，如果您使用的是 Web API，则返回的对象会根据您项目中安装的格式化程序自动为您序列化。默认情况下，使用 XML 和 JSON，因此您只需返回您的模型类型，客户端将以 Json 格式接收它。

# version-control - 如何仅从 bzr 存储库获取文件？

> ID：14717888
> 
> 赞同：0
> 
> 时间：2013-02-05T22:05:52.157
> 
> 标签：version-control, bazaar

我的意思是，我不需要每个目录下的所有“.bzr”文件夹（我可能有数百个嵌套的“.bzr”文件夹）；我只想查看那些实际文件。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:12:40.580

只需删除文件夹，例如使用`find -type d -name .bzr -exec rm -rf {} +`

请注意，您将无法再在该副本中使用 bzr （即您无法提交内容等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:05:56.173

你确定你有数百个嵌套的“.bzr”文件夹吗？每个项目应该只有一个`.bzr`文件夹，就在项目的顶级目录中，`.bzr`子目录中没有其他文件夹。（你可能把它和 Subversion 混在一起了？）

似乎您可能想要获取所有项目文件而不需要任何`.bzr`文件夹或 Bazaar 文件。如果是这种情况，`cd`请到您的项目并运行以下任何命令：

```
bzr export /tmp/project-as-dir  # export files into a directory
bzr export /tmp/project.tar     # export files into a tar file
bzr export /tmp/project.tar.gz  # export files into a tar.gz file 
```

# c# - 在流畅的 nHibernate 中一对一模拟 Cascade.AllDeleteOrphan

> ID：14717890
> 
> 赞同：1
> 
> 时间：2013-02-05T22:05:56.523
> 
> 标签：c#, nhibernate, fluent-nhibernate, fluent-nhibernate-mapping

我有一个父表，它与子表具有*可选*的1:1 关系（父表可以在没有子表的情况下存在，反之亦然）。父表自动生成的主键用作子表的主/外键。

多亏了几个很好的参考资料（[这个问题](https://stackoverflow.com/questions/643656/fluent-nhibernate-hasone-withforeignkey-not-working)和[这个网站](http://brunoreis.com/tech/fluent-nhibernate-hasone-how-implement-one-to-one-relationship/)），我才能够绘制出一个有效的 1:1 关系。我可以创建一个有或没有孩子的父母，更新一个或两个，并删除父级联以删除孩子，正如预期的那样。

但是，我想以某种方式“模拟”我的映射结构`Cascade.AllDeleteOrphan()`中的映射选项，以便如果删除关系的子端，则在保存父对象时将删除子表中的相应行。照原样，如果我尝试手动删除孩子，我会收到一条错误消息，这是可以理解的。`HasMany``HasOne``'deleted object would be re-saved by cascade'`

有没有人找到一个很好的方法来做到这一点，同时仍然只使用`HasOne`映射？我想要做的仍然是 1:1 的关系，还是应该只使用一对多并依靠我的数据库约束和业务逻辑来防止多个孩子？

简化代码：

```
// Parent class
public partial class Parent
{
    public int pkParentID { get; set; }
    public Child child { get; set; }
    public Parent() { }
}

// Child class
public partial class Child
{
    public int pkParentID {get; set; }
    public Parent parent { get; set; }
    public Child() { }
    public Child(Parent parent) { this.parent = parent; }
}

// Parent mapping
public class ParentMap : ClassMap<Parent>
{
    public ParentMap()
    {
        Table(@"Parent");
        LazyLoad();
        Id(x => x.pkParentID)
          .Column("pkProjectID")
          .Not.Nullable()
          .GeneratedBy.Identity();
        HasOne<Child>(x => x.Child)
          .PropertyRef(r => r.Parent)
          .Cascade.All();
    }
}

// Child map
public class ChildMap :ClassMap<Child>
{
    public ChildMap()
    {
          Table(@"Child");
          LazyLoad();
          Id(x => x.pkParentID, "pkParentID") 
            .GeneratedBy.Foreign("Parent");
          HasOne<Parent>(x => x.Parent)
            .Constrained()
            .ForeignKey()
            .Cascade.None();
    }
}

// Ideally, the code snippet below would remove the row from the Child table
Parent parent = service.GetById(uniqueID);
if (parent.Child != null)
    parent.Child = null;
service.SaveOrUpdate(parent);

// Just in case, here's my repository code
public virtual void SaveOrUpdate(T entity)
{
    ISession _session = NHibernateSessionProvider.GetSession();
    if (!_session.Transaction.IsActive)
    {
        using (ITransaction transaction = _session.BeginTransaction())
        {
            try
            {
                _session.SaveOrUpdate(entity);
                transaction.Commit();
            }
            catch
            {
                transaction.Rollback();
            }
        }
    }
} 
```

编辑:: 我还尝试了以下代码片段，这就是给我“已删除的对象将被级联重新保存”错误消息的原因。

```
...
Parent parent = parentService.GetById(uniqueID);
if (parent.Child != null)
{
    childService.Remove(parent.Child);  // this gives the above error
    parent.Child = null;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:00:08.677

级联设置 all-delete-orphan 在 NHibernate 中没有实现，请参阅[NH-1262](https://nhibernate.jira.com/browse/NH-1262)。关于该问题的评论中有一个拉取请求，因此它可能会出现在未来的版本中。

现在你可以这样做：

```
Parent parent = service.GetById(uniqueID);
parent.Child = null;
service.Delete(parent.Child); // probably needs to occur in a different repository
// commit transaction or flush session, there's no need to call SaveOrUpdate 
```

# c++ - 将dll导入C++程序

> ID：14717900
> 
> 赞同：1
> 
> 时间：2013-02-05T22:06:18.083
> 
> 标签：c++, dll, c++-cli

我正在尝试将以下 VB 代码重写为 C++ 以导入和使用 DLL 文件：

```
 <DllImport("NfcReader.dll", EntryPoint:="CommOpen")> _
Public Function CommOpen(ByRef hCom As IntPtr, ByVal com_port As String) As Short
End Function 
```

我尝试使用以下代码：

```
#using <mscorlib.dll>
using namespace System::Runtime::InteropServices;

namespace sensor{ 
[DllImport("NfcReader.dll", EntryPoint = "CommOpen")]
short int CommOpen(intptr_t hCom, std::string com_port);
} 
```

但我不断收到错误 system.accessviolation 因为显然我的函数参数不能是字符串。
有人可以帮我解决这个问题吗？我不知道 DllImport() 是否是在这种情况下使用的正确函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T01:14:03.510

唯一将`DllImportAttribute`C 风格的 DLL 导入 CLI。

这意味着 NfcReader.dll 是一个标准的 C/++ dll，您应该能够使用它，但是通常在 C/++ 中使用 dll。我从未做过 C/++，但我认为`LoadLibrary()`这将是一个很好的起点。

# c#-4.0 - Ajax.OnBeginForm(... OnSuccess = "xxx") 总是在初始成功后触发

> ID：14717902
> 
> 赞同：1
> 
> 时间：2013-02-05T22:06:32.517
> 
> 标签：c#-4.0, asp.net-mvc-4, devexpress

我正在使用 VS2012 / C# / MVC 4。

我正在尝试在不刷新整个页面的情况下发布“联系我们”表单。一切都很好，如果我错过任何必填字段并且不会触发 OnSuccess，验证会在第一时间启动。在我成功发布表单（不缺少任何必填字段）后，即使验证失败（缺少必填字段），每个额外的帖子都会导致 OnSuccess 触发。红色感叹号显示正确，控制器“知道”它失败了，但 ajax OnSuccess 似乎不知道新的失败。

**ContactUsForm.cshtml（部分视图）：**

```
@model contactdemo.Models.ContactUsDetails

  <div id="formContainer">
    @using (Ajax.BeginForm("ContactUsForm", new AjaxOptions { UpdateTargetId = "formContainer", OnSuccess = "displaySuccess" }))
    {    
    <strong>Send To: </strong>
    <div>
        @Html.DevExpress().ComboBoxFor(model => model.ContactID,
            settings =>
            {
                settings.ShowModelErrors = true;
                settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
                settings.Name = "ContactID";
                settings.Properties.ValueField = "ContactID";
                settings.Properties.ValueType = typeof(int);
                settings.Properties.TextField = "ContactName";
                settings.ControlStyle.CssClass = "contactUsCombo";
        }).BindList(Session["Names"]).GetHtml()
    </div>
    <div>
        @Html.DevExpress().LabelFor(m => m.Subject).GetHtml()
        @Html.DevExpress().TextBoxFor(m => m.Subject, 
            settings =>
            {
                settings.ShowModelErrors = true;
                settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
                settings.ControlStyle.CssClass = "subjectText";
            }).GetHtml()
    </div>
    <div>
        @Html.DevExpress().LabelFor(m => m.Message).GetHtml()
        @Html.DevExpress().MemoFor(m => m.Message, 
            settings =>
            {
                settings.ShowModelErrors = true;
                settings.Height = 50;
                settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
                settings.ControlStyle.CssClass = "memoText";
            }).GetHtml()
    </div>
    <div>
        @Html.DevExpress().Button(
            settings =>
            {
                settings.Name = "btnSubmit";
                settings.Text = "Send Message";
                settings.UseSubmitBehavior = true;
                settings.ControlStyle.CssClass = "contactUsCombo";
            }).GetHtml()
    </div>       
} 
```

**HomeController.cs：**

```
namespace contactdemo.Controllers
{
[OutputCacheAttribute(VaryByParam = "*", Duration = 1, NoStore = true)]
public class HomeController : Controller
{
    <snip...>

    [HttpGet]
    [OutputCache(Duration = 60, VaryByParam = "*")]
    public ActionResult ContactUsForm()
    {
        return PartialView(new ContactUsDetails());
    }

    [HttpPost]
    public ActionResult ContactUsForm(ContactUsDetails data)
    {
        if (ModelState.IsValid)
        {
            return PartialView(new ContactUsDetails());
        }
        else
        {
            return PartialView(data);
        }
    }   
} 
```

**索引.cshtml：**

```
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>

<script type="text/javascript">
function displaySuccess(result) {
    alert("Sent Successfully");
}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:11:21.227

确保在`displaySuccess`回调中将不显眼的验证处理程序重新附加到 DOM 中新添加的内容：

```
function displaySuccess(result) {
    $('#formContainer form').removeData('validator');
    $('#formContainer form').removeData('unobtrusiveValidation');
    $.validator.unobtrusive.parse('#formContainer form');

    alert('Sent Successfully');
} 
```

您需要这样做的原因是因为您在 AJAX 回调之后使用新的部分刷新 DOM 的内容，并且不显眼的验证框架无法知道这些新元素，除非您告诉它。你也可以看看一个[`similar answer`](https://stackoverflow.com/a/5783020/29407).

# vim - 如何获得 ctags 以避免在行首索引空白？

> ID：14717904
> 
> 赞同：1
> 
> 时间：2013-02-05T22:06:37.310
> 
> 标签：vim, ctags, exuberant-ctags

在 Vim 中使用 exuberant ctags 时，我发现 ctags 会生成一个标签文件，该文件在每个标签定义的开头包含空格。结果，每当我跳转到一个标签时，它都会跳转到行首，而不是该行后面的标签位置。

有没有办法告诉 exuberant ctags 不要索引这个空白？

![在此处输入图像描述](../Images/fc1fc908c801ec7b082d789d59d7c518.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T03:45:26.970

我对我的标记文件执行后处理步骤以清理它们。例如，我们有一些 (C++) 命名空间，但它们出现在任何地方，并且它不是一个有用的搜索标签。

也许您可以直接翻阅文件并`\zs`在每行标签的第一个匹配项前面粘贴一个？`^`或者，您可以从搜索词中的标签中删除所有内容。（我从来没有试过这个。）

我的方法是在标记脚本中的 ctags 调用之后，我通过一系列`grep -vE`s 将文件传回。

祝你好运。

# ios - 有时收不到推送通知

> ID：14717906
> 
> 赞同：2
> 
> 时间：2013-02-05T22:06:50.980
> 
> 标签：ios, push-notification, sandbox

**我对iOS 推送通知**有这个奇怪的问题：

 **我将我的服务器配置为发送推送通知，但有时它们没有发送。

为了让它们重新在特定设备上工作，我必须关闭 Wi-Fi 并将其重新打开。之后收到消息。

我仍在尝试解决这个问题，但没有运气。

**更多信息：**

1.服务器在沙盒模式下工作。

2.开发证书正在使用中。

3.其他通知仍然有效，而我的则无效（Facebook、Whatsapp）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:14:52.097

在我的理论中，测试 APNS 服务器和真正的 APNS 服务器之间存在一些差异。

我不认为这是你的问题。

向 APNS 服务器发送消息后记录一些内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-22T09:55:37.230

尝试关闭沙箱并将其设置为 false。

检查您的证书.. 如果您有临时证书，通知将仅在您创建 IPA 并将其安装在您的设备上时起作用。或者，如果您从 Applestore 下载该应用程序。

另一个问题可能会导致您的问题是数据流量。如果您的手机在连接到 wifi 之前没有互联网，则设备在未连接到 wifi 之前不会收到推送通知。

希望能帮助到你。**

# ios - 按钮的 UIScrollView - TouchUpInside？

> ID：14717913
> 
> 赞同：3
> 
> 时间：2013-02-05T22:07:04.693
> 
> 标签：ios, objective-c, uiscrollview, uibutton, drag

我有一个 UIScrollView 填充了我以编程方式创建的按钮。分页已启用，每当用户快速滚动页面时，他们总是会意外单击他们无意点击的按钮...我应该使用 TouchUpInside 还是这就是我的问题的原因？

我注意到的一件事是，如果用户按下按钮然后滑动滚动视图不会移动，但如果他们非常快速地滑动滚动视图并在滚动到一半时松开，然后他们抓住按钮上的滚动视图然后按钮将变为“按下”是否有任何方法可以让按钮在滚动过程中被单击时不执行任何操作，或者解决方案比这更简单（即，只需将触摸事件更改为不同的侦听器）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:12:15.463

这成功了！

```
setExclusiveTouch:YES 
```

# java - 无法进行连续搜索

> ID：14717915
> 
> 赞同：1
> 
> 时间：2013-02-05T22:07:12.660
> 
> 标签：java, swing, for-loop, jtable, abstracttablemodel

```
 public boolean searchSummaryData(String textToFind) {
    int fromRow, fromCol;
    fromRow = summaryTable.getSelectedRow();
    fromCol = summaryTable.getSelectedColumn();

    if (fromRow < 0) {
        fromRow = 0; //set to start point, first row 
    }
    if (fromCol < 0) {
        fromCol = 0;
    } else {
        fromCol++;//incremental search - look through each columns, then switch to next row
        if (fromCol >= summaryTable.getColumnCount()) {
            fromCol = 0;
            fromRow++;
        }
    }
    for (int i = fromRow; i < summaryTableModel.getRowCount(); i++) {
        for (int j = fromCol; j < summaryTableModel.getColumnCount(); j++) {
            final Object valueAt = summaryTableModel.getValueAt(i, j); //point to object at i,j
            if (valueAt != null) {
                textToFind = textToFind.toLowerCase();
                if (valueAt.toString().toLowerCase().contains(textToFind)) {
                    //Map the index of the column/row in the table model at j/i to the index of the column/row in the view.
                    int convertRowIndexToView = summaryTable.convertRowIndexToView(i);
                    int convertColIndexToView = summaryTable.convertColumnIndexToView(j);
                    summaryTable.setRowSelectionInterval(i, i);
                    summaryTable.setColumnSelectionInterval(j, j);
                    //Return a rectangle for the cell that lies at the intersection of row and column.
                    Rectangle rectToScrollTo = summaryTable.getCellRect(convertRowIndexToView, convertColIndexToView, true);
                    tableSp.getViewport().scrollRectToVisible(rectToScrollTo);
                    return true;

                }
            }
        }
    }
    return false;
} 
```

我上面的搜索方法有问题。我这样做的方式，它只允许我搜索一个特定的匹配关键字一次。在同一个 GUIscreen 中，如果我进行第二次搜索，即使匹配了关键字，也找不到任何结果。我很确定最后搜索的索引被保留并且没有重置是问题，但我不确定在哪里以及如何更改它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:22:47.840

您正在将`fromRow`and `fromCol`vars 设置为选定的行和列。然后您将选择更改为找到第一个结果的位置。如果第二次搜索只在当前选择的左侧或上方找到了东西，它将找不到任何东西。

你为什么不一开始就设置`fromRow`and`fromCol`为 0, 0 呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:50:15.003

假设您有一个 10 行 5 列的表格。

有比赛：

*   2, 2
*   4, 1
*   9, 0

*   第一次你会发现 2, 2。

*   因此，下次您从第 2 行和第 3 列开始。您的算法将仅在第 3 列和第 4 列中查找值（4 是表的最后一列）。

你应该拥有的是：

*   首先从单元格 2、3 到单元格 2、4
*   然后使用你的循环从第 3 行和第 0 列开始并增加列 - >第 3 行不匹配
*   然后将行增加到 4 并将列重置为 0。当您将列增加到 1 时，您将找到第二个匹配项。
*   ETC...

我还没有测试过，但我认为在你的内部循环中，你应该像这样启动增量

```
int j = fromCol 
```

应该替换为

```
int j = (i == fromRow ? fromCol : 0); 
```

# lex - TeX 方程的词法分析器规则（正则表达式）

> ID：14717920
> 
> 赞同：0
> 
> 时间：2013-02-05T22:07:29.510
> 
> 标签：lex

在 TeX 中，方程定义在 之间`$...$`。*对于两个美元符号之间的任意数量的任意字符*的实例，我如何定义 lex 的词法分析器规则？

我试过了：

```
equation  \$[^\$]*\$ 
```

没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:47:47.290

如果您不希望将美元符号作为等式的一部分包含在内，您可以尝试使用[开始条件：](http://westes.github.io/flex/manual/Start-Conditions.html)

```
%x EQN
%%
\$ { BEGIN(EQN); } /* switch to EQN start condition upon seeing $ */
<EQN>{
    \$ { BEGIN(INITIAL); } /* return to initial state upon seeing another $ */
    [^\$]* { printf(yytext); } /* match everything that isn't a $ */
} 
```

或者，如果您在词法分析器中定义了其他状态，则`BEGIN(STATE)`可以使用`yy_push_state()`，而不是使用。`yy_pop_state()`

# ruby-on-rails - 我应该相信 Rails 可以正确地复数表格吗？

> ID：14717921
> 
> 赞同：1
> 
> 时间：2013-02-05T22:07:38.617
> 
> 标签：ruby-on-rails

**推**文到**推文**没什么大不了的。而且我认为**Country**会成为没有任何大惊小怪的**国家。**我什至将**仙人掌**变成**仙人掌**归功于他们（如果我错了，请纠正我）。

但是如果我有类**Barnabus**怎么办？我是否称它为餐桌 barnabuss、barnabi 或 barnabusses？**zxzzy**呢？非英语单词如何处理？是否有任何非混乱的选项可以覆盖资本化和多元化？

我是 Rails 的新手，修改后的表名让我有点反感。相关文档的链接表示赞赏。[这是我见过的唯一与此相关的文档，它对](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-pluralize)理解表名的奇怪异常没有帮助。

如果这已经涵盖，请原谅我，我得到的结果并不完全是我想要弄清楚的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T22:21:09.787

`String#pluralize`使用具有相当简单的英语通用规则的启发式方法作为基础，并添加一些已知的常见例外。

使用`ActiveSupport::Inflector`您可以自定义其行为。在 Rails 项目中，您可以在`config/initializers/inflections.rb`.

如果您想创建一个`Barnabus`具有相应`barnabi`表的模型，那么您所要做的就是取消注释一些 inflections.rb 内容并明确告诉 Rails 如何处理这个词。

```
ActiveSupport::Inflector.inflections do |inflect|
  inflect.irregular 'barnabus', 'barnabi'
end 
```

PS 感谢[Holger 只是](https://stackoverflow.com/users/421705/holger-just)为了编辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:22:21.180

在大多数情况下，您可以信任它，但如果您有一些可疑的模型名称和笨拙的复数名称，您始终可以在 Model.xml 中指定表名。例如

```
class SomeName < ActiveRecord::Base
  self.table_name = 'any_name'
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:28:09.240

如果您担心视图/错误消息中的复数化，那么在 Rails 无法将复杂的表名复数化的情况下，您可以向您的应用程序添加一些本地化，并告诉它您希望它在各种上下文中使用什么。请参阅[http://guides.rubyonrails.org/i18n.html#translations-for-active-record-models](http://guides.rubyonrails.org/i18n.html#translations-for-active-record-models)

这是一个实际的复数规则示例：

```
activerecord:
    models:
      barnabus:
        zero: Barnabi
        one: Barnabus
        few: Barnabi
        other: Barnabi 
```

# c# - 在 winform 中通过 rtmp 流播放 .flv

> ID：14717922
> 
> 赞同：1
> 
> 时间：2013-02-05T22:07:51.910
> 
> 标签：c#, winforms, stream, flv, rtmp

我想出用现有工具播放这种流的唯一方法是通过 rtmpdump 将它传输到 vlc 中。

它的命令行如下所示：

```
rtmpdump.exe -v -r rtmp://cp108475.live.edgefcs.net/live/ard_1_800@15782 --swfsize 927444 --swfhash 6c1be1765187eae0bc9af07d858fae59a0effd3c5b803d08db261ced2c5512bb -q | vlc.exe - 
```

我刚刚想出了如何使用[VlcDotNet 库在 winform 中从本地磁盘播放 .flv](http://vlcdotnet.codeplex.com/)

但现在我也在寻找一种在ac#winform中播放这种.flv **rtmp流的方法。**

# java - 如何通过java控制Windows上的通用键盘应用程序？

> ID：14717924
> 
> 赞同：1
> 
> 时间：2013-02-05T22:07:58.173
> 
> 标签：java, serial-port, rxtx

我正在尝试为用于相机控制的通用键盘开发应用程序。我能够通过 /dev/ttyACM0 伪终端设备在 Linux 上以某种基本方式与设备通信。但据我所知，这在 Windows 中不存在，当我检查 comm API 和 rxtx 库的示例时，我有点困惑。

我怎样才能像在 Linux 上那样简单地与这个设备通信？这是键盘的说明手册：http: [//www.videotec.com/dep/DCZ_1051.pdf](http://www.videotec.com/dep/DCZ_1051.pdf)

这是代码：

**Class1.java**

```
package customkeyboard;

import java.io.FileInputStream;
import org.apache.commons.codec.binary.Hex;

public class CustomKeyboard {

    public static void main(String[] args) {
        // TODO code application logic here
        FileInputStream in = null;
        try {
            in = new FileInputStream("/dev/ttyACM0");
            int c = 0;

            int streamCounter = 0;
            String command = "";
            CustomKeyboard2 key2 = new CustomKeyboard2();
            key2.main(null);
            while ((c = in.read()) != -1) {
                if (streamCounter < 6) {
                    //System.out.print( + " - ");
                    command += Integer.toHexString(c);
                    streamCounter++;
                    if (streamCounter == 6) {
                        streamCounter = 0;
                        System.out.println(command);
                        byte[] bytes = Hex.decodeHex(command.toCharArray());
                        String deastranza = new String ( bytes, "UTF-8");
                        System.out.println(deastranza);
                        command = "";
                }
            } else {
            }
        }
    } catch (Exception ex) {
        ex.printStackTrace();
    }
} 
```

}

**Class2.java**

```
package customkeyboard;

import java.io.FileOutputStream;
import org.apache.commons.codec.binary.Hex;

public class CustomKeyboard2 {
    public static void main(String[] args) {
        try {
            FileOutputStream out = null;
            out = new FileOutputStream("/dev/ttyACM0");
            String command = "[LedImmediate]";
            byte[] message = command.getBytes("UTF-8");
            out.write(message);

            command = "[Led+45]";
            message = command.getBytes();
            out.write(message);
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
} 
```

# angularjs - 如何使用 angularjs 动态填充 select2 数据

> ID：14717925
> 
> 赞同：3
> 
> 时间：2013-02-05T22:08:01.597
> 
> 标签：angularjs, jquery-select2

我的情况是我想使用 Select2 小部件的 createSearchChoice 功能。所以我发现我需要使用 html 输入元素而不是选择元素，所以我不能使用 ng-repeat 来填充 select2 小部件。我发现有一个“数据”选项，并且能够用静态数据填充 select2 小部件，但当我尝试动态填充它时却不行。

什么有效：

html: `<input class='select2' ui-select2='sel2props' type='hidden'>`

在控制器中：

```
$scope.sel2props = {
    createSearchChoice: ...

  data: [ 
    { id: 0, text: 'yabba' }
    etc
  ]
}; 
```

但是，如果我尝试将数据设置为一个变量，然后我可以将其设置为数据库提供给我的任何内容，则不会填充小部件。

```
data: $scope.data;

function to retrieve data {
    $scope.data = retrieved data;
} 
```

检索到的数据完全按照指定的方式。

如果我设置一个按钮来附加数据键，它将起作用：

```
$scope.appenddata = function () {
  $scope.data.push({id:1, text: 'anot'});
}; 
```

所以我认为这是一个时间问题，我尝试了 $digest 和 $apply 但它们在控制器中不起作用。我试图设置一个指令，实际上可以做简单的小部件，但不能做 select2，所以我希望不要走那条路，也就是说我走那条路淹死了。如果有人可以帮忙，那就太好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T00:35:49.117

解决方案很简单。只需将元素推送到 select2 数据数组上，而不是引用另一个数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-20T18:36:20.907

```
function (result) {
  $scope.lookupOptions.data.length = 0; // remove old items
  angular.extend($scope.lookupOptions.data, result.data); // add new items                  
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-05T22:45:03.023

我最近使用的一个技巧是使用 Select2 的`query`选项按需传递您的最新数据。

我整理了一个示例，包含在自定义指令中。看到这个[Plunk](http://plnkr.co/edit/q2ZJWedqGyCcDtIdvwWU?p=preview)。

# iphone - 检索应用的作者 - 越狱 iOS 6

> ID：14717927
> 
> 赞同：3
> 
> 时间：2013-02-05T22:08:09.047
> 
> 标签：iphone, objective-c, ios6, jailbreak

如何在越狱的 iOS 6.x 设备上检索应用的作者（或开发者或发布者等）？在 iOS 4.x 和 5.x`author`中，类中有一个成员`SBApplication`。但在 iOS 6.1 中，我现在`NSUnknownKeyException`在请求作者时得到一个。从在线 iOS 6 类转储中快速查看 SBApplication.h 并没有显示出任何有希望的东西（除了`signerIdentity`，但那是别的东西）。有没有什么简单的方法可以得到这个，而不需要挖掘任何`Info.plist`文件？

更新：这些`Info.plist`文件实际上也不包含此信息。`iTunesMetadata.plist`另一方面，该文件有，但系统/Cydia 应用程序没有此文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T21:52:19.277

我还没有越狱我的 iOS 6 设备或`class-dump`在所有的 iOS 6 框架上运行，所以我不能告诉你是否有另一个*私有 API*来做你以前能做的事情。

您关于检查应用程序文件夹的内容（例如`/var/mobile/Applications/*/*.app/`）和阅读 iTunesMetadata.plist 文件的建议听起来很合理。阅读每个应用程序的 Info.plist 也会为您提供`CFBundleIdentifier`，通常至少包含发布者的域名（例如`com.mycompany.MyAppName`）。

对于不是来自应用商店的应用（并且没有 iTunesMetadata.plist），您可以尝试另一种技术（除了阅读 Info.plist）：

Cydia 软件包由实用程序维护`dpkg`。您可以使用命令列出所有已安装的软件包`dpkg -l`。您可以使用以下命令调用此命令

```
system("dpkg -l >> /tmp/output.log 2>&1"); 
```

将输出通过管道传输到临时文件中，或使用`NSTask`. `NSTask`是 OS X API 的一部分，不在 iOS 公共 API 中。但是，如果您自己将 NSTask.h 标头添加到项目中，您当然可以将其用作非 App Store 应用程序中的私有 API，以编程方式运行命令并捕获输出。

在命令行，运行`dpkg -l`会给你：

```
ii  libhide                                        2.1                                            Library to hide icons. If you are a developer wanting to use this library, code samples included in /usr/lib
ii  libxml2-lib                                    2.6.32-3                                       represents the library for libxml2
ii  lsof                                           33-4                                           shows what files programs have open
ii  lzma                                           4.32.7-4                                       slower, but better, compression algorithm
ii  make                                           3.81-2                                         dependency-based build environments
ii  mobilesubstrate                                0.9.3999.1                                     powerful code insertion platform
ri  ncurses                                        5.7-12                                         feature-complete terminal library
ii  network-cmds                                   307.0.1-6                                      arp, ifconfig, netstat, route, traceroute 
```

因此，您的应用程序可以解析该输出，以从第二列读取包名称。

然后，您可以使用该`apt-cache show`命令从包的 DEBIAN/控制文件中获取信息，该文件将具有以下内容：

```
iPhone-3G:~ root# apt-cache show sqlite3
Package: sqlite3
Version: 3.5.9-12
Architecture: iphoneos-arm
Maintainer: Jay Freeman (saurik) <saurik at saurik dot com>
Installed-Size: 348
Pre-Depends: dpkg (>= 1.14.25-8)
Depends: sqlite3-lib
Replaces: sqlite3 (<= 3.5.9-11)
Filename: debs/sqlite3_3.5.9-12_iphoneos-arm.deb
Size: 71928
MD5sum: 6d47c112692ac00af61bd84e3847aa42
Section: Data_Storage
Priority: standard
Description: embedded database used by iPhoneOS
Name: SQLite 3.x
Tag: purpose::library, role::developer 
```

我知道这不仅仅是使用`author`from更多的工作`SBApplication`，但也许它已经足够好了？希望其他人会加入另一个答案......

# sorting - 在创建数据表之前在 xslt 中排序

> ID：14717928
> 
> 赞同：0
> 
> 时间：2013-02-05T22:08:09.000
> 
> 标签：sorting, xslt, xls

我正在尝试获取数据并将其放入表中并在输出到表之前对其进行排序，并且当我这样做时对第一列进行排序，而该列的其余部分根本没有排序。我正在尝试按 streetNuame 排序，并且仅适用于第一个表格列

```
<fo:table>
  <fo:table-column width="82mm"/>
  <fo:table-column width="82mm"/>
  <fo:table-column width="82mm"/>
  <fo:table-body>
    <xsl:for-each select="route/address[position() mod 3 = 1]">
      <xsl:sort select="streetName"/>
      <fo:table-row>
        <xsl:apply-templates select=". | following-sibling::*[3 > position()]"/>

        <xsl:variable name="vPos" select="position()"/>
        <xsl:variable name="vUnfilled"
        select=" 2 - count(following-sibling::*)"/>
        <xsl:if test="position() = last()">
          <xsl:for-each select="../*[not(position() > $vUnfilled)]">
            <fo:table-cell>
              <fo:block>
                <xsl:value-of select="' '"/>
              </fo:block>
            </fo:table-cell>
          </xsl:for-each>
        </xsl:if>
      </fo:table-row>
    </xsl:for-each>
  </fo:table-body>
</fo:table> 
```

下面的 XML：

```
 <route>
       <name>blah</name>

       <address>
          <fullStreet>blah</fullStreet>
          <streetNumber>blah</streetNumber>
          <streetName>blah</streetName>

       </address> 
```

# ubuntu - 在 Ubuntu 上安装 Sqlplus

> ID：14717936
> 
> 赞同：0
> 
> 时间：2013-02-05T22:08:34.790
> 
> 标签：ubuntu, sqlplus

我想在我的 Ubuntu 上安装 SQLPlus。我按照以下说明进行操作：

[http://gm.matias.ph/running-oracles-sql-plus-in-linux-ubuntu-2010-08-04](http://gm.matias.ph/running-oracles-sql-plus-in-linux-ubuntu-2010-08-04)

我下载了 .rpm 包并安装了外星人，但随后尝试解压 .rpm 文件（第 5 点），我得到了错误：

> “'oracle-instantclient11.2-basic-11.2.0.3.0-1.i386.rpm' 的解包在 /usr/share/perl5/Alien/Package/Rpm.pm 第 168 行失败。”

该怎么做才能解决？我是新手，请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-19T01:24:55.107

只需点击这个 - 在 CIFS (samba) 上的包上运行外星人。我认为那里有符号链接。我有 cpio 和 rpm2cpio，这两个命令在 RPM.pm 的管道中运行.....当然你不能在 CIFS 挂载的文件系统中创建符号链接！

我将文件复制到本地磁盘 & Bob 是你的叔叔。

/账单

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T12:54:30.697

使用 Alien，您需要安装一些帮助文件，然后将 .rpm 转换为 .deb 文件，然后使用 dpkg 安装。像这样：

安装 Alien 开发工具和帮助文件

```
xxx@ubuntuorg$ sudo apt-get install alien dpkg-dev debhelper build-essential 
```

然后你应该像这样将你的 .rpm 转换为 .deb 包

```
xxx@ubuntuorg$ sudo alien packagename.rpm 
```

然后，您将使用刚刚创建的 .deb 包执行类似的操作。

xxx@ubuntuorg$ sudo dpkg 包名.deb

最后，Alien 并不总是正确地转换包或执行安装。如果这也失败了，请发布您的 RPM.pm 文件，第 150 到 175 行。

# cqrs - 克服事件存储中不良/不一致数据的最佳方法是什么？

> ID：14717938
> 
> 赞同：2
> 
> 时间：2013-02-05T22:08:42.780
> 
> 标签：cqrs, event-sourcing

事件存储应该是仅添加的，您永远不会删除或编辑数据。

就我而言，我们没有禁止用户进行的一些中游更改，并且数据是“坏的”/不一致的......因为他们更改了我们在中游配置的谷歌文档的域名...

我可以从事件存储中重新配置，但该数据已损坏。

我是否应该创建某种突变器，当它从事件存储中提取数据时，修复它？

我需要一些想法在这里！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-10T17:52:38.200

如果我理解正确，那么当时的“坏”数据是正确的吗？

我建议您通过不接触事件来解决此问题，而是更新配置服务以处理损坏的域名。这可能是一个知道如何修复域名或 url 的组件：您发送资源并获得更正的版本作为回报。未知资源可以按原样返回。

# jpa-2.0 - 具有新关系的 JPA 2.0 实体更新在持久时失败，但在合并时成功

> ID：14717943
> 
> 赞同：0
> 
> 时间：2013-02-05T22:09:10.453
> 
> 标签：jpa-2.0, eclipselink

我定义了以下关系

实体 A 与实体 B 具有 @OneToMany，而实体 B 与实体 C 具有 @OneToOne。

在创建实体 A 时，我还创建了实体 B 并设置它们之间的关系。一切都按预期工作。

在另一个事务中， - 从数据库中获取实体 A，获取相应的实体 B，然后 - 创建实体 C。- 实体 C 设置在实体 B 上，以伪造两者之间的关系。如果我使用 EntityManager.persist(Entity B)，持久性管理器会尝试将 Entity B 再次插入 DB，从而导致对 Entity B 的 PK 的唯一约束违反。如果我使用 EntityManager.merge(Entity B)，一切都按预期工作.

在上述使用上下文中，为什么要持久化操作尝试创建副本，因为在这种情况下管理实体并且它应该能够轻松地进行更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T12:32:36.947

如果在非托管实例上调用 persist，JPA 要求提供者抛出异常。只能使用合并，因为很明显它从实例中获取数据并将其合并到托管副本中。如果 B 是托管的，persist 调用将被忽略，因此这意味着 B 是如何分离的，或者它是在与您调用 persist 不同的 entityManager 中读取的。

# php - MySQL 插入语句失败

> ID：14717944
> 
> 赞同：-3
> 
> 时间：2013-02-05T22:09:12.770
> 
> 标签：php, mysql, insert

```
 INSERT INTO 'subactivity' VALUES (NULL, '2013-02-05', 'On Deck', '100.100.100', NULL, NULL, NULL, 'Display On Deck list', NULL, NULL) 
```

上面的命令返回一条消息，提示我在通过 PHPmyAdmin 或在 Dreamweaver 之外的浏览器中运行时出现语法错误。有 10 个值和 10 个字段。即使我列出了字段名称，它也会失败。具有 NULL 内容的字段，允许在结构中使用 NULL，默认值为 NULL。值的内容与字段类型匹配。

第一个字段是一个关键的、自动递增的字段。第二个和第五个字段是日期字段。所有其他字段都是文本。

我不知道自己做错了什么，希望有人能提供帮助。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T22:11:41.547

表名```周围应该有反引号，而不是单引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:12:17.117

尝试这个

```
 INSERT INTO `subactivity` VALUES (NULL, '2013-02-05', 'On Deck', '100.100.100', NULL, NULL, NULL, 'Display On Deck list', NULL, NULL) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:25:31.437

你能摆脱单引号吗？并添加一个; 在你的陈述结束时。

# javascript - 谷歌地图，更改显示的邮政编码

> ID：14717947
> 
> 赞同：0
> 
> 时间：2013-02-05T22:09:14.353
> 
> 标签：javascript, jquery, google-maps

我想知道我是否可以编辑我的谷歌地图的邮政编码，因为谷歌地图的邮政编码错误。我检查了元素并想更改此行

```
<span jsattrs="dir:bidiDir($addrline, true);" jscontent="$addrline" jstcache="82" dir="ltr">Burlington, ON L7R 2G6</span> 
```

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:28:51.787

最好的方法是将错误通知 Google。他们非常擅长调查和跟进这些报告。

大约一年前计划旅行时，我注意到了一个问题。谷歌地图的路线在一段非常好的高速公路上绕了很长的路。地图页面上有一个链接可以通知他们问题。我使用了这个，他们在大约一个月后纠正了这个问题。对计划旅行没有立即帮助，但它确实纠正了错误，对其他人也是如此。

说了这么多，在 Javascript 中应该可以修改 Maps 加载到页面中的 DOM 元素。但是，它可能会导致一些意想不到的行为。

# magento - 使用 Magento 的 AheadWorks 博客扩展显示来自特定类别的帖子

> ID：14717948
> 
> 赞同：0
> 
> 时间：2013-02-05T22:09:14.820
> 
> 标签：magento, blogs, categories, posts

我正在使用 Magento 的 AheadWorks 博客扩展，并且我的博客页面运行良好。但我希望某些类别的最新帖子的摘录出现在我的主页上。到目前为止，我已经通过添加以下内容成功设置了所有内容：

```
<block type="blog/blog" name="blog.latest" template="aw_blog/blog-home.phtml" /> 
```

到“layout.xml”，添加：

```
<?php echo $this->getChildHtml('blog.latest') ?> 
```

到我主页的 phtml 文件，并通过创建“template/aw_blog/blog-home.phtml”。

问题是我不知道如何限制显示的类别。例如，您会在下面的“blog-home.phtml”文件中看到我试图将帖子限制为“新闻”类别。我从其他论坛尝试了很多解决方案，但无论我做什么，我都会看到每个类别的帖子。有谁知道我需要从我的代码中添加/删除什么来限制类别？

```
 <?php $posts = $this->getPosts("news"); ?>
<div id="messages_product_view">
    <?php Mage::app()->getLayout()->getMessagesBlock()->setMessages(Mage::getSingleton('customer/session')->getMessages(true)); ?> 
    <?php echo Mage::app()->getLayout()->getMessagesBlock()->getGroupedHtml(); ?> 
</div>

<?php $numberOfPosts = 1 ?>
<?php $renderedPosts = 0 ?>
<?php foreach ($posts as $post): ?>
    <div class="postWrapper">
        <div class="postTitle">
            <h2><a href="<?php echo $post->getAddress(); ?>" ><?php echo $post->getTitle(); ?></a></h2>
        </div>
        <div class="postContent"><?php echo $post->getPostContent(); ?></div>
        <?php echo $this->getBookmarkHtml($post) ?>
        <div class="tags"><?php echo $this->getTagsHtml($post) ?></div>
        <div class="postDetails">
            <?php if ($this->getCommentsEnabled()): ?>
                <?php echo $post->getCommentCount(); ?> <a href="<?php echo $post->getAddress(); ?>#commentBox" >Comments</a> | 
            <?php endif; ?>
            <?php $postCats = $post->getCats(); ?>
                                <?php echo "<h1>" . $postCats[2] . "</h1>"; ?>
            <?php if (!empty($postCats)): ?>
                <?php echo Mage::helper('blog')->__('Posted in'); ?>
                <?php foreach ($postCats as $data): ?>
                    <a href="<?php echo $data['url']; ?>"><?php echo $data['title']; ?></a> 
                <?php endforeach; ?> 
            <?php else: ?>
            <?php endif; ?></div>
            <?php $renderedPosts ++ ?>
            <?php if ($renderedPosts = $numberOfPosts) {
                break;
            }
            ?>
    </div>
<?php endforeach; ?>
<?php //$this->getPages(); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-10T05:35:11.320

以下是快速解决方案：转到 aw_blog 前端模板，默认可能是这个 app/design/frontend/base/default/template/aw_blog/menu.phtml 检查和替换：

```
if ($posts = $this->getRecent(): 
```

和

```
$currentBlogCat = Mage::getSingleton('blog/cat');

if ($posts = $this->getRecent($currentBlogCat['cat_id'])): 
```

现在打开 /app/code/community/AW/Blog/Block/Menu/Sidebar.php 检查以下功能：

```
public function getRecent() 
```

为其添加参数：

```
 public function getRecent($currentCat=false) 
```

另外，替换以下代码块

```
 $collection = clone self::$_collection;               
 if (array_key_exists('categories',$data = $this->getData();) && count(explode(',', $data['categories'])) == 1) { 
```

和

```
 $collection = clone self::$_collection;
 $data = $this->getData();
 if($currentCat>0)$data['categories']=$currentCat;
 # Category fix #
 if (array_key_exists('categories',$data ) && count(explode(',', $data['categories'])) == 1) { 
```

谢谢！

# c++ - qt 5 QMediaPlayer 错误：Gstreamer 无法播放

> ID：14717949
> 
> 赞同：1
> 
> 时间：2013-02-05T22:09:19.277
> 
> 标签：c++, qt, ubuntu-12.04, gstreamer, qt5

我刚刚安装了 QT 5 并试图运行播放视频的示例。代码片段如下所示：

```
QMediaPlayer *player = new QMediaPlayer;

player->setMedia( QUrl::fromLocalFile(fileUrl)  );

QVideoWidget *videoWidget = new QVideoWidget;
player->setVideoOutput(videoWidget);

videoWidget->show();
player->play(); 
```

它编译得很好，但是当我运行它时，我收到以下错误：

```
GStreamer; Unable to play - "file:sample.avi" 
```

我在 Ubuntu 12.04 上安装了所有额外的 gstreamer 包，以防 gstreamer 缺少编解码器。我试过几种不同的视频格式都无济于事。我可以使用 vlc 播放视频就好了。有谁知道为什么这不起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-19T11:55:49.030

它需要绝对路径。尝试

```
player->setMedia( QUrl::fromLocalFile(QFileInfo(fileUrl).absoluteFilePath())); 
```

# r - 如何将数据及其标签导出到单个excel表中-通过双for循环生成数据时

> ID：14717950
> 
> 赞同：-4
> 
> 时间：2013-02-05T22:09:21.957
> 
> 标签：r

在单次迭代的不同阶段通过双循环生成数据时，如何将数据及其标签、标题、关于数据的信息（关于数据的信息）导出到单个 Excel 表中。代码：

```
 k=3
 t=2
   o=seq(from=1, to=t, by=1)
    for(i in 1:t){
        v=((o[i])+1)
        print ("treatments")
        print (v)
        h=seq(from=0, to=o[i], by=1)
        q1=NULL
        q2=NULL
        x1=NULL
           for(j in 1:o[i]){
              q1=c((v-(4*h[j]+1)))
              q2=c(((4*h[j])+2))
              T=c(q1,q2)
              y=c(0)
              IB=c(y,cumsum(T)%%v)
              print("The Initial Block(s) is/are=")
              print(IB)
                   p=seq(from=0, to=v-1, by=1)
                   l=NULL
                     for(i in 1:k){
                     for(j in 1:v){
                     l=c(l,rep((IB[i]+p[j]+v)%% v))
                     }
                    }
              x= matrix(c(l),nrow=k,ncol=v,byrow = TRUE)
              x1=cbind(x1,x)
                }
         print ("Design Matrix is")
         print (x1)
       } 
```

在第一次迭代时，输出为：

```
 [1] "treatments"
        [1] 3
        [1] "The Initial Block(s) is/are="
        [1] 0 2 1
        [1] "Design Matrix is"
        [,1] [,2] [,3]
 [1,]    0    1    2
 [2,]    2    0    1
 [3,]    1    2    0 
```

在第 2 次迭代中，输出为

```
 [1] "treatments"
  [1] 5
  [1] "The Initial Block(s) is/are="
  [1] 0 4 1
  [1] "The Initial Block(s) is/are="
  [1] 0 0 1
  [1] "Design Matrix is"
       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
 [1,]    0    1    2    3    4    0    1    2    3     4
 [2,]    4    0    1    2    3    0    1    2    3     4
 [3,]    1    2    3    4    0    1    2    3    4     0 
```

等等 ...

请考虑

1.  输出可能按照文件的单个 excel 表上提到的顺序排列。

2.  矩阵可能是逐个单元格的——我已经尝试过，但它粘贴在单个单元格中。

3.  请问有什么不明白的。

4.  代码很长，所以请大家举个例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:16:53.960

郑重声明，这是一种可怕的、可怕的信息显示方式。

```
library(XLConnect)
wb <- loadWorkbook("~/Desktop/so/terrible_idea.xlsx",create = TRUE)
sht <- "Horrible Way To Display Data"
createSheet(wb,name = sht)

k=3
 t=2
   o=seq(from=1, to=t, by=1)
    for(i in 1:t){
        v=((o[i])+1)
        print ("treatments")
        appendWorksheet(wb,data.frame("treatments"),sheet = sht,header = FALSE)
        row_counter <- row_counter + 1
        print (v)
        appendWorksheet(wb,as.data.frame(v),sheet = sht,header = FALSE)
        h=seq(from=0, to=o[i], by=1)
        q1=NULL
        q2=NULL
        x1=NULL
           for(j in 1:o[i]){
              q1=c((v-(4*h[j]+1)))
              q2=c(((4*h[j])+2))
              T=c(q1,q2)
              y=c(0)
              IB=c(y,cumsum(T)%%v)
              print("The Initial Block(s) is/are=")
              appendWorksheet(wb,data.frame("The Initial Block(s) is/are="),sheet = sht,header = FALSE)
              print(IB)
              appendWorksheet(wb,as.data.frame(IB),sheet = sht,header = FALSE)
              row_counter <- row_counter + nrow(as.data.frame(IB))
                   p=seq(from=0, to=v-1, by=1)
                   l=NULL
                     for(i in 1:k){
                     for(j in 1:v){
                     l=c(l,rep((IB[i]+p[j]+v)%% v))
                     }
                    }
              x= matrix(c(l),nrow=k,ncol=v,byrow = TRUE)
              x1=cbind(x1,x)
                }
         print ("Design Matrix is")
         appendWorksheet(wb,data.frame("Design Matrix is"),sheet = sht,header = FALSE)
         print (x1)
         appendWorksheet(wb,as.data.frame(x1),sheet = sht,header = FALSE)
       }

saveWorkbook(wb) 
```

# git - 为什么 git 不能将“origin/master”识别为有效的对象名称？

> ID：14717957
> 
> 赞同：15
> 
> 时间：2013-02-05T22:10:02.407
> 
> 标签：git

```
~/www> git branch --track live origin/master
fatal: Not a valid object name: 'origin/master'.
~/www> git remote
origin
~/www> git branch
* master
  test_branch
  working_branch 
```

我还尝试使用以下命令创建跟踪分支：

```
git branch live
git branch --set-upstream live origin/master 
```

但我得到了同样的错误

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-06T05:05:23.260

```
$ git branch -r
  origin/1.x
  origin/1.x@60
  origin/1.x@63
  origin/HEAD -> origin/master
  origin/master

$ git branch --track live origin/blah
fatal: Not a valid object name: 'origin/blah'. 
```

正如建议的那样，您只能跟踪已添加的遥控器。也许像这样添加遥控器

```
$ git remote add upstream git://github.com/svnpenn/rtmpdump.git

$ git fetch upstream 
```

[例子](http://github.com/svnpenn/a/blob/9fd174d/scripts/git-merge.sh)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-12-18T13:38:59.803

您的输出`git remote`确认您已成功添加`origin`遥控器。

我预计问题是您尚未创建远程跟踪分支。如果你这样做`git branch -r`，它可能不会输出任何东西。所以`origin/master`不是一个有效的对象名称，因为该远程跟踪分支还不存在。

解决方案是`git fetch origin`创建远程跟踪分支。如果你这样做`git branch -r`，你会看到`origin/master`现在存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-18T11:38:43.700

我遇到了同样的问题。事实证明，我没有遥控器的写权限。因此错误。

确保您具有远程写入权限。没有一个是导致此特定错误的原因之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-07T08:51:44.930

在没有 master 分支的情况下尝试建立分支时，会出现此错误。考虑以下场景：

```
$ git init 
Initialized empty Git repository in /Users/amir/gitdemo/.git/ 
$ git branch feature-1 
fatal: Not a valid object name: 'master'. 
```

***在我们第一次提交之后创建了一个主分支。让我们提交一个文件并检查分支列表：***

```
$ touch test.txt
$ git add test.txt 
$ git commit -m "First commit" 
$ git branch 
* main 
```

**由于 master 已经创建，我们现在可以创建一个分支：**

```
$ git branch feature-1 
$ git checkout feature-1
Switched to branch 'feature-1' 
```

# jquery - 如何将div宽度设置为div的最大宽度

> ID：14717961
> 
> 赞同：0
> 
> 时间：2013-02-05T22:10:13.073
> 
> 标签：jquery, css

我有 div 元素，我正在设置它们的长度和宽度，如下所示：

```
<div id="alldivs" style="width:600px;">
    <div id="div1" class="mydiv" style="float: left; min-width:140px; max-width:185px;">
        test text
    </div>
    <div id="div2" class="mydiv" style="float: left; min-width:140px; max-width:185px;">
        test text 2
    </div>
</div> 
```

如何将每个 div 元素的宽度`#alldivs`设置为最大宽度？因此，在上面的示例中，宽度`#div2`将设置为宽度，`#div1`因为`#div2`包含更多文本，因此将具有更大的宽度。我想我可以使用 jQuery 来迭代 div 元素以找到最大宽度的元素，然后相应地设置每个 div 但也许有使用 CSS 的更清洁的方法，甚至 jQuery 使用更优雅的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:13:46.933

如果您只是将所有 div 放入 #divWrapper div 并将您的最小最大宽度应用于该 div 会怎样。这样他们都应该从上面继承。简单的。简单的。干净的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T03:49:51.500

CSS 开发人员并没有专注于此，但希望将来如果您向主流浏览器报告此问题，他们会这样做。目前，您只能`jQuery`按照您提到的方式执行此操作。我认为您不会找到任何更清洁的方法来做到这一点，所以坚持使用`jQuery`. 这就是我能说的。我以前遇到过这个问题，我找不到解决方案。所以我做了什么，而不是使用`jQuery`，我指定了`div`具有特定宽度的 's 并放弃使用`max-width`. 希望有帮助。

看看这个[问题](https://stackoverflow.com/questions/14721136/full-screen-background-html)，也许这会给你一些想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T04:08:09.650

如果您只想让两个内部 div 为 180px，那么在您的 CSS 中您将使用

```
#alldivs div{width:180px;} 
```

或者也许我读错了你的问题？

这是一个说明上述内容的jsFiddle，..

[http://jsfiddle.net/nabhW/](http://jsfiddle.net/nabhW/)

# sql - 带有日期参数的 SQL 查询 GroupBy

> ID：14717967
> 
> 赞同：0
> 
> 时间：2013-02-05T22:10:23.740
> 
> 标签：sql, group-by

假设我有一张桌子，TeamRatings，看起来像这样

```
|---Team----|--ValuationDate--|-Rating-|

|--Saints---|---10/15/2012----|---81.1-|  
|--Broncos--|---10/15/2012----|---91.1-|  
|--Ravens---|---10/16/2012----|--101.1-|  
|--Broncos--|---10/22/2012----|---82.1-|  
|--Ravens---|---10/22/2012----|---83.1-|  
|--Saints---|---10/29/2012----|---84.1-|  
|--Broncos--|---10/28/2012----|---85.1-|
|--Ravens---|---10/29/2012----|---86.1-| 
```

此外，假设球队的评分保持不变，直到他们玩新游戏（代表新记录）。例如，野马队在 2012 年 10 月 21 日的评分假定为 102.8

我想要一个带有日期参数的查询，它将为每支球队返回一条记录，代表该球队在指定日期之前的最新比赛。例如，

如果我输入 10/23/2012 作为我的日期参数，查询应该返回

```
|---Team---|-ValuationDate---|-Rating-|

|--Saints--|---10/15/2012----|---81.1-|  
|--Broncos-|---10/22/2012----|---82.1-|  
|--Ravens--|---10/22/2012----|---83.1-| 
```

任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:13:41.327

在 MS SQL Server 2005 或更高版本上，您可以使用带有`ROW_NUMBER`函数的 cte：

```
WITH x 
     AS (SELECT team, 
                valuationdate, 
                rating, 
                rn = Row_number() 
                       OVER( 
                         partition BY team 
                         ORDER BY valuationdate DESC) 
         FROM   teamratings 
         WHERE  valuationdate < @DateParam) 
SELECT team, 
       valuationdate, 
       rating 
FROM   x 
WHERE  rn = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:43:45.173

您可以使用更通用的查询，如下所示：

```
select Team, x.ValuationDate, Rating
from TeamRatings inner join
(
 select Team, max(ValuationDate) as ValuationDate
 from TeamRatings 
 where ValuationDate < @dateParameter
 group by Team
) x on TeamRatings.Team = x.Team and TeamRatings.ValuationDate = x.ValuationDate 
```

# canvas - 是否可以直接在画布上下文中绘制 KineticJS 形状？

> ID：14717973
> 
> 赞同：0
> 
> 时间：2013-02-05T22:10:57.277
> 
> 标签：canvas, html5-canvas, kineticjs

我正在使用 Jaws 框架编写一个小游戏。我想使用 KineticJS 在我的画布上下文中绘制一些形状。是否可以直接在上下文上绘制形状而无需先创建舞台和图层？就像是

```
var circle = new Kinetic.Circle({...params...);
circle.draw(myContext); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T02:13:21.347

I believe each KineticJS object has drawFunc as its property. If you can take that one out and apply to canvas directly, you won't need stage or layer,I guess.

Trying ...

Hmm .. no. drawFunc is using object dependent properties. i.e. this.getRadius().

However, you still can see how it is drawn by printing out the drawFunc

```
<script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.3.0-beta2.js"></script>
<script>
var circle = new Kinetic.Circle({
    x: 250,y: 250, radius: 70,
    fill: 'red',
    stroke: 'black',
    strokeWidth: 4
});

console.log(circle.drawFunc);
</script> 
```

Here is the output of that console.log command.

```
function (canvas) {
    var context = canvas.getContext();
    context.beginPath();
    context.arc(0, 0, this.getRadius(), 0, Math.PI * 2, true);
    context.closePath();
    canvas.fillStroke(this);
} 
```

# sql-server - Informatica：将图像数据类型下载到磁盘

> ID：14717978
> 
> 赞同：0
> 
> 时间：2013-02-05T22:11:25.093
> 
> 标签：sql-server, informatica

我在 sql server 中有一个包含两列的表

```
Filename char datatype
File image datatype 
```

要求是将所有数据下载到磁盘，是否可以使用 informatica，如果可以，如何？

例如，如果表中有两行：

```
sal_1.pdf, <<image data>>
sal_2.pdf, <<image data>> 
```

并且它需要被推送到磁盘`D:/file_dump`目录然后`D:/file_dump`应该有两个文件，名称`sal_1.pdf`和`sal2.pdf`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T06:54:12.763

您可以像这样使用`T-SQL`and `bcp`([链接 1](http://msdn.microsoft.com/en-us/library/ms162802.aspx)，[链接 2](http://msdn.microsoft.com/en-us/library/aa337544.aspx) )：

1）编写T-SQL脚本（使用SQL Server Management Studio）生成所有shell/bcp命令

```
SET NOCOUNT ON;
SELECT  'bcp "SELECT y.File FROM Schema.Table y WHERE y.IDColumn=' 
    + CONVERT(VARCHAR(11),x.IDColumn) 
    + ' queryout "D:\file_dump\' 
    + x.FileName 
    + '" -N -S SqlServerInstance -T -d "DatabaseName"'
FROM Table x 
```

按`Ctrl+T`（文本结果）

按`F5`（执行）

按`F6`（它激活`Results (text)`面板

按`Ctrl+A`（全选）

按`Ctrl+C`（复印）

2) 创建一个新的文本文件 ( `Win Key`++ `Notepad`) `Enter`, `Ctrl+V`(Paste), `Save As ...`->`dump_pdf.bat`

3) 执行`dump_pdf.bat`文件

# active-directory - LDAP 身份验证适用于 DN，但不适用于 AD 的 CN

> ID：14717979
> 
> 赞同：0
> 
> 时间：2013-02-05T22:11:29.697
> 
> 标签：active-directory, ldap

最近，我不得不与一个与 host1 和 host2 上的 2 个 AD 交互的应用程序进行交互。我发现连接到其中一台主机时 ldap 连接失败。错误如下所示：

> *连接到“LDAP://[host1]/RootDSE”失败。
> System.DirectoryServices.DirectoryServicesCOMException (0x8007052E)：
> 登录失败：未知用户名或密码错误。*

出于故障排除的目的，我安装了 Apache Directory 工具和不同的 CN/DN 组合，我的观察结果是：

1.  使用 CN（在本例中为`Administrator`）/[密码] 连接到 host1 时，在获取基本 DN 时出现以下错误：

    > *获取基本 DN 时出错
    > [LDAP：错误代码 49 - 80090308：LdapErr：DSID-0C0903A9，注释：AcceptSecurityContext 错误，数据 52e，v1db1*

2.  当使用管理员的可分辨名称和相同密码连接到 host1 时，我能够成功检索基本 DN

3.  当仅使用 CN（`Administrator`再次）/ 连接到 host2 时，我可以成功检索基本 DN 列表。

所以我的问题是，是否可以设置 AD 设置以允许仅使用 CN 而不是完整 DN 进行身份验证？

我对 AD 完全陌生，所以如果我可以在我的问题中提供一些东西，以使人们更好地浏览类似问题，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T09:32:17.100

什么是 host1 和 host2 - 它们是同一域的不同域控制器 (DC) 还是不同域的域控制器 (DC)？从您所解释的情况来看，如果是这种情况，它们似乎适用于不同的域，那么 host2 只是具有不同的管理员和不同的密码。

直接回答你的问题。当且仅当给定的 CN 是唯一的时，AD 才允许 CN 用于用户登录。因此，无需为此进行任何配置。

但是，还有许多其他方式可以登录 AD。您可以使用`sAMAccountName`或`userPrincipalName`用户的属性，这些包含用户的用户名。第一个包含来自 的用户名`DOMAIN\username`，其中`DOMAIN`是 AD 的 NetBIOS 域名（我不确定这是确切的术语，但我使用它是因为没有更好的名称）。第二个属性包含格式为 的用户名`username@example.com`，其中`example.com`通常是 AD 的 DNS 域名（尽管可以不同）。

因此，如果您正在搜索比 DN 更短的内容，请使用上述之一。

# matlab - 在 Matlab 中调用 CPLEX 时出错

> ID：14717980
> 
> 赞同：0
> 
> 时间：2013-02-05T22:11:29.897
> 
> 标签：matlab, cplex

我正在使用带有 win7（32 位）和 Matlab 2009a（32 位）的 cplex12.5（x86-32）学术版。我在 Matlab 中使用 cplexlp 函数尝试了一个简单的线性问题。出现以下错误：

```
Error using ==> cplexlp at 254
Invalid MEX-file 'C:\Program
Files\IBM\ILOG\CPLEX_Studio_Preview125\cplex\matlab\x86_win32\cplexlink125.mexw32': The specified module could not be found. 
```

有什么问题？有什么办法可以解决吗？

感谢您提供任何信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T03:00:49.290

此错误通常意味着依赖库丢失或不在路径中。您可以通过在dependency walker 中打开您的mex 文件来查找缺少的内容。谷歌的depends.exe 下载dependency walker。

# css - Firefox 18.0.1 (Mac) CSS 转换序列抖动

> ID：14717984
> 
> 赞同：1
> 
> 时间：2013-02-05T22:11:42.373
> 
> 标签：css, firefox, transition

在使用 transitionend 对 CSS 中的过渡进行排序时，我在 Firefox 18.0.1 中遇到了抖动/故障问题。我试图制作动画的对象会短暂地跳到结束位置，然后回到开始位置，然后继续进行补间。

这在 Firefox (Mac) 中经常发生，在 Safari 中间歇性地发生。它也可能发生在 Windows Firefox 中，但我没有检查过。关于可能导致这种情况的任何想法？

看看这里的演示（仅供参考，它是专门为 Firefox 编码的）：
[http ://umamie.com/csstransition/cssTweenDemo.html](http://umamie.com/csstransition/cssTweenDemo.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T18:54:57.887

我一直在遇到同样的问题，所以我在这里提交了一个错误：[https ://bugzilla.mozilla.org/show_bug.cgi?id=850320](https://bugzilla.mozilla.org/show_bug.cgi?id=850320)

同时，我发现在两个转换之间排队一个非常短的延迟（10 毫秒左右）修复了跳跃。如果您使用 jQuery Transit，只需在您认为将排队的任何 .transition({}) 之后添加 .delay(10)

# - QColorDialog

> ID：14717989
> 
> 赞同：0
> 
> 时间：2013-02-05T22:11:58.627
> 
> 标签：

QColorDialog 是 Qt Toolkit 中的一个类，它提供了一个用于指定颜色的对话框小部件。

# javascript - 在 KineticJS 中绘制弧线

> ID：14717990
> 
> 赞同：3
> 
> 时间：2013-02-05T22:12:05.593
> 
> 标签：javascript, html, kineticjs

我知道您可以使用 Kinetic.Wedge 绘制楔形：

```
 var compassArc = new Kinetic.Wedge({
    x: stage.getWidth() / 2,
    y: stage.getHeight() / 2,
    radius: 70,
    angleDeg: 60,
    fill: 'red',
    stroke: 'black',
    strokeWidth: 4,
    rotationDeg: -90
  }); 
```

这会在整个事物周围绘制一个带有黑色轮廓的“披萨片”。我只想要披萨的“外壳”，没有直线回到圆的中心。我怎样才能做到这一点？

将填充设置为`null`删除红色但留下轮廓。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T01:46:12.127

使用弧线创建自定义形状怎么样？

[http://www.html5canvastutorials.com/tutorials/html5-canvas-arcs/](http://www.html5canvastutorials.com/tutorials/html5-canvas-arcs/)

请记住，不要关闭路径，也不要填充笔画。如果是这样，你会得到你想要的。它是一个 KineticJS 对象，因此您可以随意拖动。

这是工作示例。

[http://jsfiddle.net/bighostkim/WzxxH/](http://jsfiddle.net/bighostkim/WzxxH/)

```
var arc = new Kinetic.Shape({
    drawFunc: function(canvas) {
        var context = canvas.getContext();
        var x = stage.getWidth() / 2;
        var y = stage.getHeight()/2;
        var radius = 70;
        var startAngle = 1 * Math.PI;
        var endAngle = 0 * Math.PI;
        var context = canvas.getContext('2d');
        context.beginPath();
        context.arc(x, y, radius, startAngle, endAngle, false);
        //context.closePath();
        canvas.stroke(this);
    },
    fill: '#00D2FF',
    stroke: 'black',
    strokeWidth: 4,
    draggable:true
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-03T19:51:47.483

allenhwkim 的答案有点过时并且有一些问题。例如，动力学破折号阵列将不起作用。所以这里是一个修订版：

```
var arc = new Kinetic.Shape({
        x: 100,
        y: 100,
        stroke: '#000',
        strokeWidth: 4,
        dash: [8, 4],
        drawFunc: function(context) {
            var radius = 50;
            var startAngle = 1 * Math.PI;
            var endAngle = 0 * Math.PI;
            context.beginPath();
            context.arc(0, 0, radius, startAngle, endAngle, false);
            context.fillStrokeShape(this);
        },
        draggable:true      
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-25T08:27:18.710

您可以使用[Kinetic.Arc](http://lavrton.github.io/KineticJS/api/Kinetic.Arc.html)类。使外半径等于内半径，你会得到你想要的。

```
this.arc = new Kinetic.Arc({
  innerRadius: 90,
  outerRadius: 90,
  stroke: 'red',
  strokeWidth: 2,
  angle: 60,
  rotationDeg: 210
}); 
```

# php - 在 URL 地址中使用项目名称而不是 ID

> ID：14717997
> 
> 赞同：-2
> 
> 时间：2013-02-05T22:12:20.407
> 
> 标签：php, mysql, url

我已经建立了一个从数据库中检索产品的 PHP-MYSQL 网站。这些项目由 URL 中的 id 获取，如下所示：`index.php?id=25`。

但是，我刚刚读到这不是 SEO 目的的最佳选择。

有什么简单的方法可以在 URL 中填充项目名称和类别而不是 id 号？或者我应该使用数据库中的 NAME 和 CATEGORY 字段来调用每个项目？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:53:32.073

当您`print`在链接中添加一些详细信息时（`index.php`无论如何您都不会使用）。

所以你的链接看起来像：`index.php?id=25&c=Airplanes&q=Fighter+Jet+Z672`

`index.php`将像以前一样通过`id`and 忽略`&c=`and起作用`&q=`。

为了更好地做到这一点，您将使用 .htaccess 文件将链接重写为以下内容：`mysite.com/Airplanes/25-Fighter-Jet-Z672`