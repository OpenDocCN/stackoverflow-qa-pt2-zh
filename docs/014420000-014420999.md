# StackOverflow 问答 14420000-14420999

# flash - 在 URL 中有空格字符的 Flash Builder HTTP 服务？

> ID：14420004
> 
> 赞同：1
> 
> 时间：2013-01-19T23:23:55.597
> 
> 标签：flash, url, builder, space, httpservice

我正在使用 Flash Builder 4.6，我正在尝试从魔兽世界 API (http://eu.battle.net/api/wow/guild/Lightning's Blade/Myst?fields=members) 获取 JSON。

浏览器中的这个 URL 完美地返回了预期的 JSON 行。

现在在 Flash Builder 中，当我尝试测试此 HTTP 服务时，我收到以下错误：“InvocationTargetException：无法连接到指定的 URL”

我的第一个想法是 URL 中的空格字符是这个问题的根源，所以我尝试在 Connect to Data/Service 向导中使用 %20 转义空格，但是一旦我保存新的 url，它就会回到正常空间。

添加使用带有空格字符的 URL 的 HTTP 服务的正确方法是什么？

# android - 如何在 Android 上将 8 位二进制图像数据加载到 OpenGL ES 2 纹理中

> ID：14420006
> 
> 赞同：2
> 
> 时间：2013-01-19T23:24:29.403
> 
> 标签：android, opengl-es, bitmap, monochrome

我想以二进制格式（无符号字节）从磁盘读取单色图像数据，并将其显示为 Android 中的 OpenGL ES 2 纹理。我目前正在使用 Eclipse 和 AVD 模拟器。

我可以使用 InputStream 从磁盘读取数据，然后将字节数据转换为 int 以允许我使用 createBitmap 方法。

我希望通过使用 ALPHA_8 作为位图格式来创建单色位图，但如果我这样做，纹理在渲染时会显示为纯黑色。如果我将位图格式更改为 RGB_565，我可以看到图像的某些部分，但当然颜色都是乱码，因为它是错误的数据格式。

我尝试向 texImage2D() 添加额外参数以尝试强制纹理格式和源数据类型，但如果我在 texImage2D 参数中使用任何 opengl 纹理格式代码，Eclipse 会显示错误。

我不知所措，谁能告诉我如何编辑它以将单色纹理导入 OpenGL ES？

```
 int w = 640;
    int h = 512;
    int nP = w * h; //no. of pixels

    //load the binary data
    byte[] byteArray = new byte[nP];
    try {
        InputStream fis = mContext.getResources()
                .openRawResource(R.raw.testimage); //testimage is a binary file of U8 image data
        fis.read(byteArray);
        fis.close();
    } catch(IOException e) {
            // Ignore.
    }

    System.out.println(byteArray[1]);

    //convert byte to int to work with createBitmap (is there a better way to do this?)
    int[] intArray = new int[nP];
    for (int i=0; i < nP; i++)
    {
        intArray[i] = byteArray[i];
    }

    //create bitmap from intArray and send to texture
    Bitmap img = Bitmap.createBitmap(intArray, w, h, Bitmap.Config.ALPHA_8);
    GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, 0, img, 0);
    img.recycle();
    //as the code is the image is black, if I change ALPHA_8 to RGB_565 then I see a corrupted image 
```

谢谢你的帮助，

卢克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T09:20:30.137

加载`Bitmap`到字节数组后，您也可以`glTexImage2D`直接与字节数组一起使用。这将是一些类似的东西；

```
byte data[bitmapLength] = your_byte_data;
ByteBuffer buffer = ByteBuffer.allocateDirect(bitmapLength);
buffer.put(data);
buffer.position(0);

GLES20.glTexImage2D(GLES20.GL_TEXTURE_2D, 0, GLES20.GL_LUMINANCE,
                    bitmapWidth, bitmapHeight, 0, GLES20.GL_LUMINANCE,
                    GLES20.GL_UNSIGNED_BYTE, buffer); 
```

这应该将每个字节值分配给 RGB，每个字节值相同，加上 alpha 设置为 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:30:29.500

根据[createBitmap 文档](http://developer.android.com/reference/android/graphics/Bitmap.html#createBitmap%28int%5B%5D,%20int,%20int,%20android.graphics.Bitmap.Config%29)，该 int 数组被解释为[Color](http://developer.android.com/reference/android/graphics/Color.html)数组，即“(alpha << 24) | (red << 16) | (green << 8) | blue”。因此，当您加载这些字节并填充您的 int 数组时，您当前将数据放在蓝色插槽而不是 alpha 插槽中。因此，您的 alpha 值都为零，我实际上希望这会产生清晰的纹理。我相信你想要

```
intArray[i] = byteArray[i] << 24; 
```

# python - 带有 CAS 的多部分表单的 Python 客户端

> ID：14420009
> 
> 赞同：1
> 
> 时间：2013-01-19T23:25:21.097
> 
> 标签：python, urllib2, cas, python-requests

我正在尝试编写一个 Python 脚本来将多部分表单发布到需要通过 CAS 进行身份验证的站点。

有两种方法都可以解决部分问题：

1.  Python [requests](http://docs.python-requests.org)库非常适合提交多部分表单。

2.  有caslib，有[登录](http://packages.python.org/caslib/caslib.html#caslib.login_to_cas_service)功能。它返回一个可能用于进一步请求的 OpenerDirector。

不幸的是，我无法弄清楚如何获得一个完整的解决方案来解决我目前所拥有的。经过几个小时的研究，只有一些想法；我对任何可行的解决方案持开放态度。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T08:40:04.617

我接受了 JF Sebastian 的回答，因为我认为它最接近我的要求，但实际上我最终通过使用[mechanize](http://wwwsearch.sourceforge.net/mechanize/)（用于网络浏览器自动化的 Python 库）让它工作。

```
import argparse
import mechanize
import re
import sys

# (SENSITIVE!) Authentication info
username = r'username'
password = r'password'

# Command line arguments
parser = argparse.ArgumentParser(description='Submit lab to CS 235 site (Winter 2013)')
parser.add_argument('lab_num', help='Lab submission number')
parser.add_argument('file_name', help='Submission file (zip)')
args = parser.parse_args()

# Go to login site
br = mechanize.Browser()
br.open('https://cas.byu.edu/cas/login?service=https%3a%2f%2fbeta.cs.byu.edu%2f~sub235%2fsubmit.php')

# Login and forward to submission site
br.form = br.forms().next()
br['username'] = username
br['password'] = password
br.submit()

# Submit
br.form = br.forms().next()
br['labnum'] = list(args.lab_num)
br.add_file(open(args.file_name), 'application/zip', args.file_name)
r = br.submit()

for s in re.findall('<h4>(.+?)</?h4>', r.read()):
    print s 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T04:09:23.510

您可以使用 caslib 为请求编写身份验证处理程序。然后你可以做类似的事情：

```
auth = CasAuthentication("url", "login", "password")
response = requests.get("http://example.com/cas_service", auth=auth) 
```

或者，如果您对网站提出大量请求：

```
s = requests.session()
s.auth = auth

s.post('http://casservice.com/endpoint', data={'key', 'value'}, files={'filename': '/path/to/file'}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T07:29:20.893

您可以[`poster`](http://pypi.python.org/pypi/poster/)用来准备多部分/表单数据。尝试将海报的开瓶器传递给 caslib 并使用 caslib 的开瓶器发出请求（未经测试）：

```
import urllib2

import caslib
import poster.encode
import poster.streaminghttp

opener = poster.streaminghttp.register_openers()
r, opener = caslib.login_to_cas_service(login_url, username, password,
                                        opener=opener)    
params = {'file': open("test.txt", "rb"), 'name': 'upload test'}
datagen, headers = poster.encode.multipart_encode(params)
response = opener.open(urllib2.Request(upload_url, datagen, headers))
print response.read() 
```

# c++ - 调用方法的#defines 的内部工作

> ID：14420010
> 
> 赞同：1
> 
> 时间：2013-01-19T23:25:26.080
> 
> 标签：c++, c-preprocessor

我知道 C++ 文件开头的定义是[预处理器指令](http://www.cplusplus.com/doc/tutorial/preprocessor/)，因此“预处理器在代码的实际编译开始之前执行，因此预处理器在语句 [1] 生成任何代码之前消化所有这些指令”。

现在，如果我有这个简单的例子怎么办：

```
#define PRINT(function) printFnctionName(#function)

void printFnctionName(string name)
{
    cout << name;
}

void test(){};
int main(int argc, char *argv[])
{
    PRINT(test);
} 
```

所以现在我的问题实际上是预编译器如何知道将传入什么函数？预编译/链接/编译是如何真正发生的？

另外，我使用define而不是常规函数的原因是因为我无法找到复制此功能的方法`#function来检索函数的名称

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T23:31:50.180

> 所以现在我的问题实际上是预编译器如何知道将传入什么函数？预编译/链接/编译是如何真正发生的？

预处理器什么都不知道。它只是用定义的值替换文本并将您传入的值字符串化。

所以编译器看到它：

```
void printFnctionName(string name)
{
    cout << name;
}

void test(){};
int main(int argc, char *argv[])
{
    printFnctionName("test");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T23:30:02.200

预处理器进行文本替换。在您的情况下，您的代码将转换为：

```
int main(int argc, char *argv[])
{
    printFnctionName("test");
} 
```

*在编译过程的其余部分开始之前*由预处理器执行。一些预处理器指令很简单，而另一些则复杂得多（例如，可变参数预处理器指令）。

当然，它要求您包含正确的头文件等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T23:45:36.447

对于这种特殊情况，答案有两个部分。一方面是 C 预处理器对正在调用的函数一无所知，它只是进行文本替换。

第二部分是“字符串化器”，`#function`实际上替换`test`为`PRINT`with的输入`"test"`。当然，它不一定是一个函数——仅仅因为它被称为 printfunction，你可以这样做：

```
 PRINT(a+b); 
```

你会得到代码：

```
 printFnctionName("a+b"); 
```

或者

```
 PRINT(a-*&1,78^%j) 
```

并得到：

```
 printFnctionName("a-*&1,78^%j"); 
```

[为什么`u`缺少 printFnctionName？]

如果您有类似的东西，字符串化运算符非常有用

```
#define ASSERT(x) do { if (!x) fail_assert(#x, __FILE__, __LINE__); } while(0)

void fail_assert(const char *expr, const char *file, int line)
{
     cerr << "Assertion (" << expr << ") failed at " << file << ":" << line << endl;
}

.... 

ASSERT(ptr != NULL); 
```

现在您会收到一条错误消息“断言失败 (ptr!= NULL) at myprog.cpp:112”，这可能非常有用。

# mysql - 获取信息以创建 ALTER TABLE ADD FOREIGN KEY

> ID：14420014
> 
> 赞同：0
> 
> 时间：2013-01-19T23:25:55.043
> 
> 标签：mysql, foreign-keys

如何获取信息以更新已经存在的外键..

在 phpmyadmin 中更新外键引用时，此查询将发送到服务器

```
ALTER TABLE `dimension` ADD FOREIGN KEY (`test_id`) REFERENCES `db`.`test`
(`id`) ON DELETE CASCADE ON UPDATE RESTRICT; 
```

但是如何获取状态`ON DELETE`以及`ON UPDATE`发送和更新更改表查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T23:27:42.557

你不能。您必须删除现有的外键约束并添加一个新约束。

但是，您可以从以下位置获取现有***`reference_option`***的[`INFORMATION_SCHEMA`](http://dev.mysql.com/doc/en/referential-constraints-table.html)：

```
SELECT CONSTRAINT_NAME, UNIQUE_CONSTRAINT_NAME, UPDATE_RULE, DELETE_RULE
FROM   INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
WHERE  CONSTRAINT_SCHEMA = DATABASE()
   AND UNIQUE_CONSTRAINT_SCHEMA = DATABASE()
   AND TABLE_NAME = 'dimension'
   AND REFERENCED_TABLE_NAME = 'test' 
```

或者来自[`SHOW CREATE TABLE`](http://dev.mysql.com/doc/en/show-create-table.html)：

```
SHOW CREATE TABLE dimension 
```

# html - 从 html5 到 html 兼容性的混淆？

> ID：14420015
> 
> 赞同：0
> 
> 时间：2013-01-19T23:26:13.740
> 
> 标签：html

这是我的网站

[http://www.albuquerqueautomotiveservice.com](http://www.albuquerqueautomotiveservice.com)

我想我把它设置为 html5

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

但我用html写的

并且诸如字体之类的东西不显示它只是显示为我的标签的文字，但它们对内容没有影响，如 & nbsp 也不起作用，正如您在我的主页按钮上看到的那样

有什么快速解决方法吗？喜欢不同的文档类型或类似的东西

idk 抱歉，这是我的第一个网站，我需要帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T23:27:48.117

要声明 HTML 5，文档类型应该是`<!DOCTYPE html>`

# r - S4类中的R公共方法

> ID：14420019
> 
> 赞同：2
> 
> 时间：2013-01-19T23:27:10.597
> 
> 标签：r, oop, class, methods, s4

我想继承一个 S4 类并向该子类添加一个特殊方法。该方法应该只适用于子类，它对我的​​应用程序中的任何其他类都没有意义。

```
 setClass("MySpecies", contains="Species", ##Species is an S4 class
         representation(x="numeric"))

setMethod("initialize", "MySpecies", function(.Object, x, ...){
  .Object@x <- x
  args <- list(...)
  for(i in seq_len(length(args))){
    attr(.Object, names(args)[i]) <- args[[i]]
  }
  .Object
})

##CalcMatrix <- function(.Object, y){
##  x <- .Object@x
##  matrix(x, x*2, y*3)
##}

setGeneric("CalcMatrix", function(object, y){standardGeneric("CalcMatrix")})
setMethod("CalcMatrix", "MySpecies",function(object, y){
  x <- object@x
  matrix(x, x*2, y*3)
}) 
```

随着`setGeneric`它的工作，但我真的必须定义一个通用函数，尽管它只会与这个对象一起使用吗？注释掉的部分有效，但是没有检查是否使用正确的参数调用函数。这样做的正确方法是什么？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T23:55:03.530

您想要使用方法分派，并且每个方法都需要与泛型相关联，所以是的，`setGeneric`是必需的。

还有一点不请自来的建议......使用正式的类系统（大概是因为定义明确的类有助于编写更复杂的程序）然后通过添加任意属性来颠覆结构有点奇怪；这些确实应该是您班级中额外的、定义明确的插槽。

让我们通过定义使您的示例可重现`Species`

```
setClass("Species", representation(y="numeric"))
setClass("MySpecies", contains="Species", ##Species is an S4 class
         representation(x="numeric")) 
```

S4 类的一个隐含要求是`new("MySpecies")`有效的；您的`initialize`方法未通过此测试（因为`x`没有默认值）。此外，通常的做法是期望初始化`MySpecies`调用`initialize`它包含的类的方法。可以写

```
setMethod("initialize", "MySpecies", function(.Object, ..., x=numeric()) {
    callNextMethod(.Object, x=x, ...)
}) 
```

请注意`callNextMethod`，以便正确初始化基类。使用`...`并将其传递给`callNextMethod`意味着可能在其中定义的插槽`Species`也将被正确初始化。此外，`x`需要在之后`...`，因为`initialize`被定义为采用代表包含类的未命名参数——`new("MySpecies", new("Species"))`即使它是一种构造参数的方式，您不直接使用也是如此。上面的`initialize`方法实际上除了默认的初始化方法之外没有做任何事情，所以实际上（通常是这种情况）根本不编写初始化方法是有意义的。

然后在最近的 R 中，`setClass`返回一个默认构造函数，所以

```
MySpecies <- setClass("MySpecies", contains="Species", ##Species is an S4 class
                      representation(x="numeric")) 
```

进而

```
> MySpecies(x=1:5, y=5:1)
An object of class "MySpecies"
Slot "x":
[1] 1 2 3 4 5

Slot "y":
[1] 5 4 3 2 1 
```

# java - 自己实现带有光线投射的 phong 照明

> ID：14420021
> 
> 赞同：0
> 
> 时间：2013-01-19T23:27:20.770
> 
> 标签：java, raytracing, phong

我正在尝试从头开始用 java 编写一个程序，该程序使用光线投射技术和 phong 照明渲染一个球体，但我有点迷茫。

我理解 phong 方程系数背后的概念，但我不明白如何获得向量值，以及这一切与光线投射有什么关系

所以假设我想在屏幕中间渲染球体，我有它的位置和半径，所以（cx，cy，r）。我现在究竟从哪里开始？我究竟如何得到向量值？我的想法如下（伪代码）

```
int cx = window width/2
int cy = window height/2
int r = 30;
for(i = 0 -> window height) {
    for(j = 0 -> window width) {
        if( (j-cx)^2 + (i-cy)^2 < r^2) {
            //point inside
            Color c = phong(arguments..)
            draw pixel j,i with color c
        }

    }
} 
```

但我不知道这是否正确，如果是，我如何获得向量值，对于初学者来说，Normal？

你能指出我正确的方式吗？我已经尝试了很多谷歌搜索，但没有成功，提前谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T19:36:30.183

用于计算法线的向量通常来自*真实*几何对象的镶嵌（近似）。所以你把球体分成三角形。那么每个三角形 (p1,p2,p3) 都有自己的法向量 ((p2-p1)×(p3-p1)。

phong 着色方法是一种*插值*，然后（理想情况下）模糊了线条，从而泄露了*您*正在绘制三角形而不是*真正*的球体的事实。不过，这对侧面的角落没有帮助。:(

对于镶嵌，一种方法是用[贝塞尔曲面片](http://en.wikipedia.org/wiki/B%C3%A9zier_surface)近似球体，然后可以将其细分为适当的小尺寸并简化为三角形。[我在这里的问题](https://stackoverflow.com/questions/14558814/how-do-bezier-patches-work-in-the-utah-teapot)探讨了做这项工作来画一个茶壶（主要是旋转表面，与球体不同）。

# php - 找不到“DirectoryIterator”类

> ID：14420022
> 
> 赞同：4
> 
> 时间：2013-01-19T23:27:31.757
> 
> 标签：php, symfony

我是simfony2的新手，很抱歉新手问题。

当我尝试使用某些类时，例如`DirectoryIterator`or`DOMDocument`我收到以下异常：

```
PHP Fatal error:  Class 'My\TestBundle\Command\DirectoryIterator' not found in /var/www/simfony2/src/My/TestBundle/Command/TestCommand.php on line 214 
```

如果尝试在 simfony2 环境之外运行相同的代码，它的代码运行良好，`phpinfo()`显示 `PHP Version => 5.3.10-1ubuntu3.4`并且包含路径是默认加上添加的 ZF2。

同样，我知道这可能是一些配置问题，因为它在我的包中搜索类而不是使用内置的 php 类，但我不知道如何解决这个问题。

编辑：这是我要执行的代码的副本：

```
protected function execute(InputInterface $input, OutputInterface $output) {
 $classes=get_declared_classes();
 print_r($classes);      
 $d= new DirectoryIterator("/");
} 
```

当我运行命令时，我可以看到类

```
...
[73] => DirectoryIterator
... 
```

但我不能使用它

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-19T23:39:19.857

这是[命名空间](http://php.net/manual/en/language.namespaces.rules.php)相关的！

与 symfony 本身无关。
您应该`\`在另一个命名空间内的全局类之前做广告

```
$class = new \DirectoryIterator; 
```

我建议你在继续使用 symfony 之前先阅读 php 手册！

# python - 如何将文本文件中的行（字符）输出为单行

> ID：14420023
> 
> 赞同：0
> 
> 时间：2013-01-19T23:27:34.837
> 
> 标签：python, text, printing

**我需要有关如何将 txt 文件中的多行连接成没有空格**的单行的帮助

 **文本文件由 8 行组成，每行 80 个字符，如图所示：

[![一只忙碌的猫](../Images/3f9dda4e4aa3ff3157835225a3f35bc3.png)](https://i.stack.imgur.com/dfoDU.jpg)
[（来源：[gulfup.com](http://im33.gulfup.com/HMGw2.jpg)）]

这是我使用的代码，但我的问题是我无法将所有行连接起来，它们之间没有空格：

```
inFile = open ("text.txt","r") # open the text file
line1 = inFile.readline() # read the first line from the text.txt file
line2 = inFile.readline() # read the second line from the text.txt file
line3 = inFile.readline()
line4 = inFile.readline()
line5 = inFile.readline()
line6 = inFile.readline()
line7 = inFile.readline()
line8 = inFile.readline()

print (line1.split("\n")[0], # split each line and print it --- My proplem in this code!
       line2.split("\n")[0],
       line3.split("\n")[0],
       line4.split("\n")[0],
       line5.split("\n")[0],
       line6.split("\n")[0],
       line7.split("\n")[0],
       line8.split("\n")[0]) 
```

[![一只忙碌的猫](../Images/bc376b577c063a84856b1393c5aa351d.png)](https://i.stack.imgur.com/XimDU.jpg)
[（来源：[gulfup.com](http://im33.gulfup.com/XfXJ1.jpg)）]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:30:35.110

只需将文件的行读入列表并使用`''.join()`：

```
with open ("text.txt","r") as inFile:
    lines = [l.strip() for l in inFile]
    print ''.join(lines) 
```

该`.strip()`调用删除了行首和行尾的所有空格，在本例中为换行符。

在语句中使用逗号`print`不仅仅是省略换行符，它还在参数之间打印一个空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T23:29:59.140

如果您的文件不是特别大，您可以将整个内容作为一个字符串打开。

`content = inFile.read()`

文本行由一个特殊字符分隔，`\n`.
如果您希望所有内容都在一行中，请删除该字符。

`oneLine = content.replace('\n', '')`

在这里，我用`\n`空字符串替换每个字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T23:30:51.843

```
infile = open("text.txt", "r")
lines = infile.readlines()
merged = ''.join(lines).replace("́\n", "") 
```

甚至更好

```
infile = open("text.txt", "r")
lines = infile.read()
text = lines.replace("\n", "") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T23:31:03.130

尝试：

```
lines = ''.join(open("text.txt").read().splitlines()) 
```

行将是由 text.txt 中的所有行组成的字符串，这些行相互连接，不带 '\n' 字符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T23:38:28.477

```
f = open("file", "r")
print "".join(f.read().split())    # Strips all white-spaces 
```**

# erlang - 参数编号的 Erlang 函数

> ID：14420033
> 
> 赞同：2
> 
> 时间：2013-01-19T23:28:15.157
> 
> 标签：erlang

嗨，我正在通过 Fred Hebert 的 Learn You Some Erlang 学习 Erlang。

而且我遇到了一个令我感到困惑的代码：

```
sword(1) -> throw(slice);
sword(2) -> erlang:error(cut_arm);
sword(3) -> exit(cut_leg);
sword(4) -> throw(punch);
sword(5) -> exit(cross_bridge).

talk() -> "blah blah".

black_knight(Attack) when is_function(Attack, 0) ->
    try Attack() of
        _ -> "None shall pass."
    catch
        throw:slice -> "It is but a scratch.";
        error:cut_arm -> "I've had worse.";
        exit:cut_leg -> "Come on you pansy!";
        _:_ -> "Just a flesh wound."
    end. 
```

所以这就是混乱。我不明白`sword(#)`功能。为什么有数字作为参数？该函数`is_function`实际上检查这些函数是否是 arity 0 并且显然所有`sword(#)`函数都是 arity 0。

与函数相比，将函数传递`sword(#)`给`black_knight`函数的方式也不同`talk`。

下面是这本书如何传递一个`sword`函数和`talk`函数。

```
exceptions:black_knight(fun exceptions:talk/0). 
```

对比

```
exceptions:black_knight(fun() -> exceptions:sword(1) end). 
```

我们`talk`只传递函数作为`sword(1)`函数，我们必须用匿名函数包装它。我不明白。

所以问题是：

1.  为什么传递这些`sword(#)`与`talk`函数不同。
2.  为什么`sword(#)`有一个数字作为参数？
3.  为什么`sword(#)`当它的 arity 看起来像 1 时有 0 arity（我将 number 参数作为参数计算）？

[我在的书的章节。](http://learnyousomeerlang.com/errors-and-exceptions#dealing-with-exceptions)

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:35:17.737

1.  如果您查看函数的保护语句`black_knight`，`is_function(Attack, 0)`则仅当传入的函数接受 0 个参数时，它才会匹配定义。由于talk带0个参数，所以可以直接传入。 `sword`接受一个参数，因此您需要将其包装在一个接受 0 个参数的匿名函数中，然后才能将其传入。
2.  每个子句定义中的数字是模式匹配的一个例子。如果您调用`sword`with`1`作为参数，您将执行子句中的代码`sword(1) ->`。如果您`2`作为参数传入，您将执行该子句`sword(2) ->`。有关更完整的描述，请参阅Learn You Some Erlang 中的[这一部分。](http://learnyousomeerlang.com/syntax-in-functions)
3.  `sword`确实有一个 1，所以你正确地计算了参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T01:37:50.907

该`sword`函数的目的是展示可以抛出的不同类型的错误。它接受一个参数，因此它可以有多个子句。Fred 可能选择整数是因为它们很短，但这并不重要。该`sword`函数的数量确实为 1。

该`black_knight/1`函数应该向您展示如何捕获 Erlang 中存在的不同错误类。它通过调用传递给它的**零**参数函数并为它可能抛出的不同错误提供不同的响应来做到这一点。

`sword/1`被传入`black_knight/1`使用匿名函数 **，因为** `black_knight/1`只接受零元的函数。创建的匿名函数

```
fun () -> sword(1) end 
```

是用一个参数调用的零元`sword/1`函数。

`talk/0`可以直接传递，因为它已经是一个零参数函数。

# android - 如何向下滚动网页

> ID：14420034
> 
> 赞同：8
> 
> 时间：2013-01-19T23:28:20.030
> 
> 标签：android, android-emulator, avd

我正在 Android 设备上测试我的新移动网站。

但在模拟器默认浏览器中，我无法向下、向右或向左滚动页面。没有滚动条，箭头键也不起作用。[这](http://i.stack.imgur.com/f8dhS.png)是我的模拟器窗口的屏幕截图（我在浏览器中打开了 stackoverflow）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-19T23:30:37.770

我把我的鼠标当作触摸。我左键单击模拟器底部的鼠标按钮并将鼠标拖到顶部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-18T12:08:43.523

我注意到您需要在屏幕边缘单击鼠标左键几秒钟才能激活滚动。激活后，您可以像触摸一样使用鼠标。

如果您无法找到滚动条，请返回并再次返回您的页面。页面加载时，滚动条将突出显示一小段时间。然后，您可以单击我在上面第一段中解释的位置。

# memory-management - CUDA 有效使用共享/本地内存？

> ID：14420045
> 
> 赞同：0
> 
> 时间：2013-01-19T23:29:34.897
> 
> 标签：memory-management, cuda, gpu-shared-memory, gpu-local-memory

当谈到 CUDA 中的共享/本地内存时，我仍然有点不确定。目前我有一个内核，在内核中每个线程分配一个列表对象。像这样的东西

```
__global__ void TestDynamicListPerThread()
{
    //Creates a dynamic list (Each thread gets its own list)
    DynamicList<int>  dlist(15);

    //Display some ouput information
    printf("Allocated a new DynamicList, size=%d, got pointer %p\n", dlist.GetSizeInBytes(),dlist.GetDataPtr());

    //Loops through and inserts multiples of four into the list
    for (int i = 0; i < 12; i++)
        dlist.InsertAtEnd(i*4);
} 
```

根据我目前的理解，每个线程都有自己的`dlist`存储在本地内存中，这是真的吗？如果是这种情况，在内核执行结束时是否有任何方法来获取每个`dlist`对象（来自另一个内核），或者我应该使用`__shared__`由第一个线程分配的动态列表数组？

我想我可能有点过于复杂了，但我从来不需要更改列表，我试图实现的执行是这样的

1.  创建列表（仅在 GPU 上完成）
2.  从每个列表生成输出（在 GPU 上由每个线程完成，只需要为该线程分配的列表中的信息。）
3.  修改/交换列表（仍然在 GPU 上完成）
4.  重复 2 和 3，直到在主机上满足某些中断条件

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:27:22.310

> 根据我目前的理解，每个线程都有自己的 dlist 存储在本地内存中，这是真的吗？

那是对的。局部变量是按线程创建的。它们将存储在寄存器或本地内存中，其中变量结束主要取决于编译器。

> 如果是这种情况，在内核执行结束时是否有任何方法来获取每个 dlist 对象（来自另一个内核），或者我应该使用`__shared__`由第一个线程分配的动态列表数组？

局部内存是线程私有的（一个例外：从计算能力 3.0 开始，有一些 intrawarp 指令可以促进线程间线程局部变量的交换），因此您需要将局部变量复制到一些全局内存变量，如果你需要在内核之外获取它的值。 `__shared__`每个线程块分配内存，并且只能在该线程块内访问，因此您需要再次将值复制到全局内存位置。

您可能需要的是一个全局列表数组，您将其作为参数传递给内核。

# wpf - LongListSelector 的 buffersize 属性已弃用

> ID：14420046
> 
> 赞同：0
> 
> 时间：2013-01-19T23:29:47.130
> 
> 标签：wpf, xaml, windows-phone-7.1, windows-phone-8, longlistselector

我想控制在 LongListSelector 中预加载了多少页，但我发现这个属性现在已被弃用。

有没有其他方法可以做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T14:33:55.080

是的，它确实。

你有数据=>加载数据=>渲染数据流。您可以优化操作、加载数据和渲染。

**加载数据中：**

1.  处理项目 X 上的 ItemRealized 事件：
2.  检查缓冲区中的项目是否比从缓冲区（X + N）加载它，而不是填充缓冲区。加载项目后，您应该扩展缓冲区。

当数据量小但项目数大时，它可以改善您的数据加载。您将最大值加载到缓冲区中并在大多数情况下平滑滚动，当用户停止滚动时在后台扩展缓冲区。

**渲染数据：**

没有直接的方法来强制呈现数据。但这里是黑客。LongListSelector 根据静态项目容器高度确定已加载项目的计数。例如，您可以设置项目容器高度以适合内容（设置 Heigth="Auto"）并通过放置大图像来动态扩展它。它强制 longlistselector 不仅渲染屏幕上的项目，还强制渲染所有应该在屏幕上的项目，因为它们具有 0 高度属性。

顺便说一句，数据渲染速度非常快，所以我认为您的情况是第一个。

# php - 数据库名称 PDO 问题

> ID：14420049
> 
> 赞同：1
> 
> 时间：2013-01-19T23:30:00.460
> 
> 标签：php, mysql, pdo, idiorm

[我在使用 SlimPHP 和Idiorm/Paris](http://j4mie.github.com/idiormandparis/)设置网站时遇到了一个奇怪的问题。

基本上所有生成的查询都不起作用，因为 MySQL 仍然需要数据库标识符。

例如：`SELECT * FROM table` 失败，但`SELECT * FROM dbname.table`有效。

```
ORM::configure('mysql:host=myhostname;dbname=mydbname;');
ORM::configure('username', $username);
ORM::configure('password', $password); 
```

我`dbname`使用内置字符串和手动多次正确设置连接。它连接 find 并且似乎正在使用该模式。

我真的不想在[Idiorm](http://j4mie.github.com/idiormandparis/)模块中强制“使用”，但如果这是唯一的答案，那就这样吧。

**笔记：**

1.  GoDaddy 托管（*我怀疑这是问题所在*） LAMP 堆栈
2.  `dbname`和`username`是一样的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T07:41:38.883

就像我怀疑的那样，这是一个糟糕的问题..显然他们默认了我以某种方式错过的非直接连接。

希望这可以防止将来别人的痛苦！

# heroku - Heroku buildpack 中 /bin/compile 的结果与 slug 有什么关系？

> ID：14420051
> 
> 赞同：0
> 
> 时间：2013-01-19T23:30:15.437
> 
> 标签：heroku, buildpack

有谁确切地知道 buildpack 的 bin/compile 阶段与 slug 和部署有何关系？编译阶段的整个 BUILD_DIR 是否在 /app 处得到 tgz 和解包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:12:04.120

是的，如[buildpack 文档](https://devcenter.heroku.com/articles/buildpack-api)中所述：

```
The application in BUILD_DIR along with all changes made by the compile script will be packaged into a slug. 
```

# css - 我的样式表中的图像

> ID：14420059
> 
> 赞同：0
> 
> 时间：2013-01-19T23:31:00.810
> 
> 标签：css, image, include, location

我正在尝试在位于此处的 css 文件中包含背景图像：

public_html/css/文件夹/style.css

并且图像位于

public_html/img/image.png

我尝试使用

```
background: url("../img/image.png"); 
```

我怎样才能得到那个图像？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T23:31:29.523

您必须在目录结构中执行 2 个步骤：

```
background: url("../../img/image.png"); 
```

# html - CSS3 过渡不起作用

> ID：14420061
> 
> 赞同：0
> 
> 时间：2013-01-19T23:31:14.783
> 
> 标签：html, css, transitions

我正在构建一个涉及 CSS 转换的页面，我注意到我无法让它们中的任何一个工作，所以为了检查实际转换本身的编码是否有错误，我粘贴了一个 W3S 的示例将片段插入我的页面并对其进行测试-仍然无法正常工作。

我正在使用 Chrome 来查看页面，但它不应该与浏览器有任何关系，因为 W3S 代码（显然）具有所有必要的变化：

W3S HTML：

```
<div class="test"></div> 
```

W3S CSS：

```
.test:hover {    width:100px;
                 height:100px;
                 background:red;
                 transition:width 2s;
                 -moz-transition:width 2s; /* Firefox 4 */
                 -webkit-transition:width 2s; /* Safari and Chrome */
                 -o-transition:width 2s; /* Opera */ } 
```

此外，当我将伪类 :hover 打开时，它会在浏览器中完全消失，而如果我将其关闭，显然它不会做任何事情，因为没有任何动作可以触发它。我不知道这是否相关？

我想知道我是否可能忘记在头脑中包含一些东西（我a.对网页设计还是很陌生，b.相当分散 - 不是一个好的组合！）

```
<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8" />
<title>...</title>
<link href="layout.css" rel="stylesheet" type="text/css" />
</head> 
```

谁能告诉我哪里出错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T23:35:43.787

过渡的定义不应该在decleration上`:hover`，它需要为元素定义，然后在`:hover`刚刚改变宽度，

例如：

```
.test {    width:100px;
           height:100px;
           background:red;
           transition:width 2s;
           -moz-transition:width 2s; /* Firefox 4 */
           -webkit-transition:width 2s; /* Safari and Chrome */
           -o-transition:width 2s; /* Opera */ 
       }
.test:hover {width: 200px;} 
```

你可以在这里看到这个例子：http: [//jsfiddle.net/zjaPA/](http://jsfiddle.net/zjaPA/)

# asp.net-mvc-4 - 创建一条包罗万象的路线

> ID：14420064
> 
> 赞同：2
> 
> 时间：2013-01-19T23:31:29.730
> 
> 标签：asp.net-mvc-4, routes

我在网上找到了几个示例（尤其是在 StackOverflow 上），用于在 ASP.NET MVC 中创建一个包罗万象的路由，但这在 MVC4 中似乎对我不起作用：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
    routes.IgnoreRoute("elfinder.connector");

    routes.MapRoute(
        name: "Default",
        url: "{controller}/{action}/{id}",
        defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
    );

    routes.MapRoute(
        name: "CatchAll",
        url: "{*url}",
        defaults: new { controller = "Home", action = "CatchAll" }
    );

} 
```

控制器动作定义为：

```
 public ActionResult CatchAll(string url)
    {
        // catch the URL and use it for something
    } 
```

这里的目标是拦截所有潜在的 404 错误，并根据 URL 响应 404 或其他内容。但是，我从来没有结束过这个`CatchAll`动作，我只是得到一个默认的 404 URL，比如：

*   ~/foo
*   ~/this/is/a/test/url

我在这里做错了吗？我想避免必须捕获错误`Application_Error`，如果是 404，请从那里重新转发。只是看起来有点乱。在我看来，处理这些请求的正确方法是将它们简单地路由到正确的操作，不是吗？

**更新：**虽然我的 URL 纯粹主义者希望避免使用`Response.Redirect`，但我目前正在尝试将以下内容作为请求的全局包罗万象：

```
protected void Application_Error()
{
    Exception exception = Server.GetLastError();
    HttpException httpException = exception as HttpException;

    if (httpException != null)
        if (httpException.GetHttpCode() == 404)
        {
            Server.ClearError();
            Response.Redirect(String.Format("~/Home/CatchAll/?url={0}", Request.Path));
        }
} 
```

但是，这仅在 URL 的结构与路由匹配时才有效。否则看起来 IIS 甚至没有将请求发送到应用程序，它只是直接返回 404。我几乎需要一个全局处理程序，其中任何未映射到操作的网站请求的 URL 都会被定向。

**更新：**看起来两件事的结合应该对我有用。首先，捕获 404 `Application_Error`（或者`Application_EndRequest`正如某些人所建议的，无论哪种方式都可以满足我的需要）涵盖了与路由结构匹配但未找到操作的任何内容。但是，仍然存在与路由结构不匹配的请求的情况。

由于各种原因，我不想为此调整 IIS。解决方案应包含在应用程序本身中。幸运的是，我可以保证最新的 .NET 和 IIS，这允许我使用`Web.config`设置来指导 IIS 如何处理错误。所以我目前正在尝试这个：

```
<httpErrors errorMode="Custom" defaultResponseMode="Redirect" defaultPath="/Home/CatchAll">
  <clear/>
</httpErrors> 
```

然而，这似乎并不完全正确。它*正在*影响 IIS，因为错误响应已更改，但它仍然是错误响应。这是：

> HTTP 错误 500.19 - 内部服务器错误
> 
> 无法访问请求的页面，因为该页面的相关配置数据无效。

所以看起来我走在正确的轨道上，我只是很难找到一个使用`httpErrors`in 的工作示例`Web.config`来发送所有 404（甚至所有错误，这对我的需求没有什么影响）到一个动作。

# html - 将视频文件从 torrent 加载到 html5 视频

> ID：14420066
> 
> 赞同：0
> 
> 时间：2013-01-19T23:31:39.970
> 
> 标签：html, html5-video, libtorrent

我可以使用带有视频的 torrent 文件并加载此视频吗？我有 3 个视频的洪流。我有一个简单的带有 video.js 的 html 页面。

*   视频 1：Wellcome.webb
*   视频 2：Introduction.webm
*   视频 3：我们玩什么.webm

所以...我可以从视频中的洪流加载第一个视频吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T07:24:43.967

你可以使用扭矩。它不是纯 javascript，但非常强大。

[http://torque.bittorrent.com/labs/](http://torque.bittorrent.com/labs/)

查看[http://onehash.com/](http://onehash.com/)以了解您想要做什么的示例。

对于纯 javascript 实现（我相信仅限于 chrome），请查看 jstorrent：

[https://github.com/kzahel/jstorrent](https://github.com/kzahel/jstorrent)

在这里部署：http: [//jstorrent.com/](http://jstorrent.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T23:53:55.187

您可以手动完成或尝试编写一些提取种子的服务器软件。如果您知道如何做到这一点，请尝试提前完成，而不是每次都在运行时完成。

# mobile - 手机版页面标题不同

> ID：14420069
> 
> 赞同：0
> 
> 时间：2013-01-19T23:32:14.363
> 
> 标签：mobile, web

我已经为我的网站开发了移动版本。移动版中的每个页面在原始版本中都有相同的标题。搜索引擎不会对具有相似标题和不同内容的页面的关键字进行排名。我怎么解决这个问题？我想在我的移动页面标题中添加“ - 移动版”短语。有用吗？请帮帮我...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:11:01.627

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=34648](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=34648)

这是移动站点地图上一些网站管理员信息的链接。谷歌可以区分移动网站和普通网站。保持页面标题相同不应该让你失望。在他们的网站管理员工具部分阅读更多内容。几乎所有的东西都记录得很清楚。

# asp.net-mvc-3 - 到达相关实体的属性

> ID：14420071
> 
> 赞同：3
> 
> 时间：2013-01-19T23:32:25.060
> 
> 标签：asp.net-mvc-3, entity-framework

我通过以下方式获得实体列表：

```
var riscregions = db.RiscEntranceDetails.OrderBy(r => r.RiscEntranceID).Include(r => r.RiscEntrance).Include(r => r.RiscRegion); 
```

但是，我需要达到更深入相关的实体属性，例如：

```
<td>@item.RiscEntrance.ID</td>
<td>@item.RiscEntrance.Personnel.Name</td>
<td>@item.RiscEntrance.EntranceDateTime</td>
<td>@item.RiscEntrance.ShiftWork.ShiftGroup.TextID</td> 
```

我怎样才能达到那些？非常感谢任何建议，包括 linq 或其他一些解决方法，例如扩展和帮助程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T23:51:35.193

你可以这样做：

```
var riscregions = db.RiscEntranceDetails
                .OrderBy(r => r.RiscEntranceID)
                .Include(r => r.RiscEntrance)
                .Include(r => r.RiscEntrance.Personnel)
                .Include(r => r.RiscEntrance.ShiftWork.ShiftGroup) 
```

仅当您需要选择集合的子项时，才需要`Select`在表达式中使用。`Include`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T23:40:45.893

[http://msdn.microsoft.com/en-us/data/jj574232.aspx](http://msdn.microsoft.com/en-us/data/jj574232.aspx)

请参阅急切地加载多个级别。您可以`.Select()`在您的`.Include()`lambda 中使用。

# c# - 我可以在图像源中使用 HTTP 安全吗？

> ID：14420074
> 
> 赞同：-1
> 
> 时间：2013-01-19T23:32:55.950
> 
> 标签：c#, windows-phone-8, windows-phone

我可以在 windows phone 8 图像源中使用 https 吗？

代码：

```
<Image Source="https://www.ppp.com/picture/th.jpg" Height="80" Width="80" /> 
```

如果我使用 http://，它将起作用。

* * *

**更新：**

是的，它现在可以工作了，因为我启用了提琴手 https 解密。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:14:45.527

是的，您可以，这是描述您可以在其中使用的内容的文档：

[http://msdn.microsoft.com/en-us/library/system.windows.controls.image.source(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.image.source(v=vs.95).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T23:42:27.713

应该没有什么不同。假设服务器正在使用 /supports `https`，因为 URL 是正确的，并且不需要任何身份验证，那么它应该可以正常工作。

* * *

正如评论者指出的那样，您是在问一个是非问题还是遇到麻烦？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T23:43:06.037

没有区别。您可以毫无问题地使用它！

> 允许跨域 URI，并允许指定方案，但不允许混合 URI 方案（例如从托管在 HTTP 服务的 HTML 页面上的 Silverlight 插件访问 HTTPS 图像）。

# git - GitHub v3 API：获取完整的提交列表以进行大型比较

> ID：14420076
> 
> 赞同：15
> 
> 时间：2013-01-19T23:33:00.680
> 
> 标签：git, github, github-api

我正在尝试使用 GitHub v3 API 来获取两个 SHA 之间的完整提交列表，使用[比较 API](http://developer.github.com/v3/repos/commits/#compare-two-commits) ( `/repos/:owner/:repo/compare/:base...:head`)，但它只返回前 250 个提交，我需要获取所有提交。

我找到[了 API 分页文档](http://developer.github.com/v3/#pagination)，但比较 API 似乎不支持`page`or`per_page`参数，无论是计数还是 SHA（**编辑**：`last_sha`参数也不起作用）。与提交 API 不同，比较 API 似乎不返回`Link`HTTP 标头。

有什么方法可以增加比较 API 的提交计数限制或获取第二页提交？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-09T07:34:28.890

尝试使用参数`sha`，例如：

`https://api.github.com/repos/junit-team/junit/commits?sha=XXX`，其中 XXX 是当前轮次查询中最后返回的提交的 SHA。然后重复这个过程，直到你到达结束的 SHA。

示例python代码：

```
startSHA = ''
endSHA = ''
while True:
    url = 'https://api.github.com/repos/junit-team/junit/commits?sha=' + startSHA
    r = requests.get(url)
    data = json.loads(r.text)
    for i in range(len(data)):
        commit = data[i]['sha']
        if commit == endSHA:
            #reach the ending SHA, stop here
        startSHA = commit 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-18T09:22:09.833

我再次尝试解决这个问题。我的笔记：

*   比较（或拉取请求提交）列表仅显示 250 个条目。对于拉取请求，您可以分页，但无论您做什么，最多只能获得 250 次提交。

*   提交列表 API 可以遍历整个提交链，分页一直到存储库的开头。

*   对于拉取请求，“基本”提交不一定在拉取请求“头”提交可访问的历史记录中。这是相同的比较，“base_commit”不一定是当前头部历史的一部分。

*   然而，“merge_base_commit”是历史的一部分，因此正确的方法是从“head”提交开始，并迭代提交列表查询，直到到达“merge_base_commit”。对于拉取请求，这意味着必须分别对拉取的“头”和“基”进行比较。

*   另一种方法是使用比较返回的“total_commits”，然后向后迭代直到达到所需的提交次数。这似乎可行，但是我不能 100% 确定这在所有带有合并等的极端情况下都是正确的。

因此，提交列表 API、分页和“merge_base_commit”解决了这个难题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-07T10:20:13.807

这相对容易。这是一个例子：

```
import requests
next_url = 'https://api.github.com/repos/pydanny/django-admin2/commits'
while next_url:
    response = requests.get(next_url)
    # DO something with response
    # ...
    # ...
    if 'next' in response.links:
        next_url = response.links['next']['url']
    else:
        next_url = '' 
```

更新：

takie 请记住，下一个 url 与初始 ex 不同：初始 url：

`https://api.github.com/repos/pydanny/django-admin2/commits`

下一个网址：

`https://api.github.com/repositories/10054295/commits?top=develop&last_sha=eb204104bd40d2eaaf983a5a556e38dc9134f74e`

所以这是全新的 url 结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T11:02:02.073

尝试使用`last_sha`参数。提交 API 似乎将其用于分页而不是`page`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-18T07:01:30.793

我对此有一个解决方案，但它并不美味。这相当于自己构建图表。一般的策略是递归地在 BASE 和 BRANCH 之间请求更多的比较对象，直到找到正确的提交数量。如果没有优化，这对于大型比较来说是非常站不住脚的。通过优化，我发现在比较中每 50 个唯一提交需要大约 1 个比较调用。

```
import Github
repo = Github(MY_PAT).get_repo(MY_REPO)

def compare(base_commit, branch_commit):
  comparison = repo.compare(base_commit, branch_commit)
  result = set()
  unexplored_commits = set()
  for commit in comparison.commits:
    result.add(commit.sha)
    unexplored_commits.add(commit.sha)
    for parent in commit.parents:
      # It's possible that we'll need to explore a commit's parents directly. E.g., if it's
      # a merge of a large (> 250 commits) recent branch with an older branch.
      unexplored_commits.add(parent.sha)
  while len(commits) < comparison.total_commits:
    commit_to_explore = unexplored_commits.pop()
    commits.update(compare(base_commit, commit_to_explore))
  return commits 
```

如果你真的想实现这个，我发现有用的优化都是围绕选择要探索的提交。例如：

*   选择提交以随机探索，而不是使用`.pop()`. 这避免了一类更坏的情况。我把它放在第一位主要是因为它很简单。
*   跟踪您已经拥有其完整祖先列表的提交，因此您知道不要不必要地探索这些提交。这是“自己构建图表”部分。
*   如果您`base_commit`在该范围内找到 的祖先，请将它们用作二等分点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-15T09:26:14.503

/commits?per_page=* 会给你所有的提交

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-09T08:02:27.433

这是使用 Octokit.NET ( [https://github.com/octokit/octokit.net](https://github.com/octokit/octokit.net) )编写的获取拉取请求的所有提交的示例

```
 var owner = "...";
       var repository = "...";
       var gitHubClient = new GitHubClient(
               new ProductHeaderValue("MyApp"),
               new InMemoryCredentialStore(new Credentials("GitHubToken")));
        var pullRequest = await gitHubClient.PullRequest.Get(owner, repository, pullRequestNumber);
        Console.WriteLine("Summarising Pull Request #{0} - {1}", pullRequest.Number, pullRequest.Title);
        var commits = new List<GitHubCommit>();
        var moreToGet = true;
        var headSha = pullRequest.Head.Sha;
        while (moreToGet)
        {
            var comparison =
                await
                gitHubClient.Repository.Commits.Compare(
                    owner,
                    repository,
                    pullRequest.Base.Sha,
                    headSha);

            // Because we're working backwards from the head towards the base, but the oldest commits are at the start of the list
            commits.InsertRange(0, comparison.Commits);
            moreToGet = comparison.Commits.Count == 250;
            if (moreToGet)
            {
                headSha = commits.First().Sha;
            }
        } 
```

如果找到具有基本 sha 的提交，我最初尝试将 moreToGet 设置为 true，但从未包含在提交列表中（不知道为什么）所以我只是假设如果比较命中是 250 的限制，可以获得更多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-28T16:19:59.160

截至 2021 年 3 月 22 日，GitHub 的 v3 REST API 支持分页 – [https://github.blog/changelog/2021-03-22-compare-rest-api-now-supports-pagination/](https://github.blog/changelog/2021-03-22-compare-rest-api-now-supports-pagination/)

您只需附加`?per_page=100&page=1`到您的`/compare/`URL。

例如：

*   前 10 次提交的第 1 页：[https ://api.github.com/repos/zigomir/cntdys/compare/324126600e37c2c8026d62218d69ea068fee70e4...87ad9134ee8e02abee351255e2161844cf69e36a?per_page=10&page=1](https://api.github.com/repos/zigomir/cntdys/compare/324126600e37c2c8026d62218d69ea068fee70e4...87ad9134ee8e02abee351255e2161844cf69e36a?per_page=10&page=1)
*   带有下 10 次提交的第 2 页： [https ://api.github.com/repos/zigomir/cntdys/compare/324126600e37c2c8026d62218d69ea068fee70e4...87ad9134ee8e02abee351255e2161844cf69e36a?per_page=10&page=2](https://api.github.com/repos/zigomir/cntdys/compare/324126600e37c2c8026d62218d69ea068fee70e4...87ad9134ee8e02abee351255e2161844cf69e36a?per_page=10&page=2)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-12-14T16:03:04.530

这是我使用 Octokit.Net 的解决方案

```
private async Task<IReadOnlyList<GitHubCommit>> GetCommits(string branch, string baseBranch)
{
    // compare branches and get all commits returned
    var result = await this.gitHub.Repository.Commit.Compare(this.repoSettings.Owner, this.repoSettings.Name, baseBranch, branch);
    var commits = result.Commits.ToList();

    // the commits property on the result only has the first 250 commits
    if (result.TotalCommits > 250)
    {
        var baseCommitId = result.MergeBaseCommit.Sha;
        var lastCommitLoadedId = commits.First().Sha;
        var allCommitsLoaded = false;
        var page = 1;

        while (!allCommitsLoaded)
        {
            var missingCommits = await this.gitHub.Repository.Commit.GetAll(this.repoSettings.Owner, this.repoSettings.Name, new CommitRequest
            {
                Sha = lastCommitLoadedId // start from the oldest commit returned by compare
            },
            new ApiOptions
            {
                PageCount = 1,
                PageSize = 100, // arbitrary page size - not sure what the limit is here so set it to a reasonably large number
                StartPage = page
            });

            foreach (var missingCommit in missingCommits)
            {
                if (missingCommit.Sha == lastCommitLoadedId)
                {
                    // this is the oldest commit in the compare result so we already have it
                    continue; 
                }

                if (missingCommit.Sha == baseCommitId)
                {
                    // we don't want to include this commit - its the most recent one on the base branch
                    // we've found all the commits now we can break out of both loops
                    allCommitsLoaded = true;
                    break;
                }

                commits.Add(missingCommit);
            }

            page++;
        }
    }

    return commits;
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-08-15T22:02:31.920

来自：[https ://developer.github.com/v3/repos/commits/#working-with-large-comparisons](https://developer.github.com/v3/repos/commits/#working-with-large-comparisons)

处理大型比较

响应将包括最多 250 个提交的比较。如果您正在处理更大的提交范围，则可以使用提交列表 API 枚举该范围内的所有提交。

对于与非常大的差异进行比较，您可能会收到错误响应，表明差异生成时间过长。您通常可以通过使用较小的提交范围来解决此错误

# c++ - 我是不是忘记了什么？（Windows 的双控制台缓冲区）

> ID：14420079
> 
> 赞同：3
> 
> 时间：2013-01-19T23:33:34.690
> 
> 标签：c++, winapi, console

我试图在 Windows 上使用`windows.h`.

在对 msdn 进行一些研究后，我想出了这个：

`

```
//Free current console
if ( FreeConsole() == 0 ) return GetLastError();
//Get clean console
if ( AllocConsole() == 0 ) return GetLastError();

HANDLE buffer1 = GetStdHandle( STD_OUTPUT_HANDLE );
HANDLE buffer2 = CreateConsoleScreenBuffer( GENERIC_WRITE,
                                            0,
                                            NULL,
                                            CONSOLE_TEXTMODE_BUFFER,
                                            NULL );
COORD begin;
begin.X = 0;
begin.Y = 0;

SetConsoleCursorPosition(buffer1, begin);

DWORD writen;

WriteConsole( buffer1,
              L"Milk\n",
              5,
              &writen,
              NULL );

WriteConsole( buffer2,
              L"Melk\n",
              5,
              &writen,
              NULL );

system("PAUSE");

SetConsoleActiveScreenBuffer( buffer2 );

WriteConsole( buffer2,
              L"Malk\n",
              5,
              &writen,
              NULL );

WriteConsole( buffer1,
              L"Mulk\n",
              5,
              &writen,
              NULL );

system("PAUSE");

SetConsoleActiveScreenBuffer( buffer1 );

system("PAUSE");
CloseHandle( buffer2 );
return 0; //End of main 
```

值得庆幸的是，这正在按预期工作。

首先屏幕输出只是：

```
Milk 
```

然后是：

```
Melk
Malk 
```

并完成：

```
Milk
Mulk 
```

我对此有几个问题：

1)开头的`FreeConsole()`and真的有必要吗？`AllocConsole()`

2）我也应该使用`CloseHandle()`缓冲区1吗？或者我什至不应该将它用于buffer2？

3) 任何你认为重要的要指出的地方。

PS：这是我的第一个问题，我希望我没有违反任何准则。

PS²：我只是`system("PAUSE")`因为这是一个测试而使用它，你不应该担心我在实际软件中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T01:17:11.433

如果有人感兴趣，请找出答案：

1）我发现这根本没有区别。但是，如果您从 cmd 执行程序，将确保弹出另一个控制台。

2)`CloseHandle()`应该只用于控制台屏幕缓冲区。标准输出是自动处理的。

# ruby - 测试不适用于 Sinatra 中的 MongoMapper

> ID：14420080
> 
> 赞同：0
> 
> 时间：2013-01-19T23:33:38.973
> 
> 标签：ruby, rspec, tdd, sinatra, mongomapper

我将 MongoMapper 与 Sinatra 连接起来，除了测试之外一切正常。我安装了带有机架测试和 Rspec 的自动测试。每当我运行自动测试时，它都会告诉我

```
/home/jason/ror/sbmongo/main.rb:11:in `<top (required)>': uninitialized constant 
MongoMapper (NameError) 
```

这是它在我的`main.rb`文件中引用的代码行。

```
MongoMapper.database = 'testdb' 
```

有什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T16:51:10.227

`require`在 Ruby 中调用事物的顺序确实有所不同，因为在库中声明的常量只有在需要库**后才**可见。

运行 RSpec 时，最好将通用设置代码放在一个地方 -`spec_helper.rb`文件 - 然后放在单独的规范中（例如，当 specing*时*`main.rb`）`require 'spec_helper`然后. 如果每个代码文件都需要按正确顺序所需的库，那么您的规范也将毫无问题地运行。如果不是，则表明s 的顺序不太正确。 *`require main.rb``require`*

# php - 找不到我的错误

> ID：14420081
> 
> 赞同：0
> 
> 时间：2013-01-19T23:33:58.967
> 
> 标签：php

我试图找到我的错误，但这段代码不起作用：

```
$marginprice = $retProd['price']['FormattedPrice'];
$marginten = '10';
if ($marginprice < $marginten) {$marginprice + '7';}
else {$marginprice + '12';}                 
update_post_meta($lastId, '_price', $marginprice); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T23:39:50.933

根据评论， + 不是有效的字符串运算符。

我假设你想添加数字，在这种情况下你不需要引用数字：

```
$marginprice = 10;
$marginprice += 7;
echo $marginprice; // will output 17 
```

如果要连接字符串（一个*接*一个地添加）：

```
$marginprice = 10; // it starts as a number
$marginprice .= '7'; // marginprice is now a string
echo $marginprice; // will output 107 
```

所以你的代码变成：

```
$marginprice = $retProd['price']['FormattedPrice'];
$marginten = 10;
if ($marginprice < $marginten) {$marginprice += 7;}
else {$marginprice += 12;}                 
update_post_meta($lastId, '_price', $marginprice); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T23:37:58.327

您需要为变量赋值。

```
 $marginprice = $marginprice + 7; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T23:40:08.647

不确定您所说的“不起作用”是什么意思，但是您应该将整数用于..well..integers，并且您没有正确增加marginprice：

```
$marginprice = $retProd['price']['FormattedPrice'];
$marginten = 10;
if ($marginprice < $marginten) {$marginprice += 7;}
else {$marginprice += 12;}                 
update_post_meta($lastId, '_price', $marginprice); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T23:45:27.153

如果要使用数字，则无需引用它们，否则它们将被解释为字符串。

```
$marginprice = $retProd['price']['FormattedPrice'];
$marginten = 10;

if ($marginprice < $marginten)
    $marginprice + 7;
else
    $marginprice + 12;

update_post_meta($lastId, '_price', $marginprice); 
```

# android - 向 Web 服务器 android 发送 POST 请求

> ID：14420082
> 
> 赞同：0
> 
> 时间：2013-01-19T23:34:00.320
> 
> 标签：android, android-asynctask, http-post

我正在开发一个使用 AsyncTask 的应用程序。我正在尝试连接到我的网站，检查用户登录详细信息，如果用户存在则返回 true，如果找不到则返回 false。根据响应，我将显示一条错误消息或为用户加载相关屏幕。

但是我想知道下面的代码是否应该放在我的登录按钮的 onClick 侦听器中或 AsyncTask 的 onPreExecute() 方法中？

我这样调用 asyncTask

```
public void onClick(View v) {
            //Call background task
            new HttpTask().execute(url);
        }
    }); 
```

我在哪里调用下面的代码有关系吗？理想情况下应该在 onPreExecute() 方法中吗？

```
HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost("http://www.mysite.com/checklogindetails.php");

try {
    // Add your data
    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
    nameValuePairs.add(new BasicNameValuePair("username", name));
    nameValuePairs.add(new BasicNameValuePair("password", pass));
    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

    // Execute HTTP Post Request
    HttpResponse response = httpclient.execute(httppost);

} catch (ClientProtocolException e) {
    // TODO Auto-generated catch block
} catch (IOException e) {
    // TODO Auto-generated catch block
} 
```

感谢您提供有关此人的任何信息。这不是问题，这对我来说更像是一个学习曲线，我很好奇我应该做什么。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T23:37:35.490

您的 HTTP 代码需要在`doInBackground()`方法中，否则它仍然在主 (UI) 线程中运行，并且可能会导致新 Android 版本出现异常（更不用说如果您的请求需要很长时间的锁定）。

这是一个示例（注意构造函数添加）我决定将对保留在`doInBackground()`. 由于您没有向我们提供所有代码，因此这可能无法立即工作。

```
public class LoginTask extends AsyncTask <String, Void, Boolean>{

  private String name = "", pass= "";
  public LoginTask (String name, String pass )
  {
    super();
    this.name = name;
    this.pass = pass;
  }
  @Override
  protected Boolean  doInBackground (String...url)
  { 
    boolean good = true;

    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost(url[0]);

    try {
      // Add your data
      List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
      nameValuePairs.add(new BasicNameValuePair("username", name));
      nameValuePairs.add(new BasicNameValuePair("password", pass));
      httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

      // Execute HTTP Post Request
      HttpResponse response = httpclient.execute(httppost);

    } catch (ClientProtocolException e) {
      good = false;
    } catch (IOException e) {
      good = false;
    }
    return good;
  }

  @Override
  protected void onPostExecute (Boolean result)
  {
    Toast.makeText(MainActivity.this, result ? "Logged in": "Problem", Toast.LENGTH_SHORT).show();
  }
} 
```

你会打电话给使用

```
public void onClick(View v) {
            //Call background task
            new HttpTask("myusername", "mypassword").execute(url);
        }
    }); 
```

# html - 如何将 Silverlight 5.1 设置为网站的要求？

> ID：14420083
> 
> 赞同：1
> 
> 时间：2013-01-19T23:34:11.503
> 
> 标签：html, silverlight, silverlight-oob, out-of-browser

当您开发 Silverlight 应用程序并希望嵌入 HTML 时，您可以执行以下操作：

```
<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="1345px" height="667px">
...
<param name="minRuntimeVersion" value="5.0.61118.0" />
<a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=5.0.61118.0" style="textdecoration:none">
<img src="http://go.microsoft.com/fwlink/?LinkId=161376" alt="Get Microsoft Silverlight" style="border-style:none"/> 
```

问题是存在阻止 OOB 应用程序自行更新的错误（来源： http: [//www.microsoft.com/getsilverlight/locale/en-us/html/Microsoft%20Silverlight%20Release%20History.htm#SL_5_1_10411](http://www.microsoft.com/getsilverlight/locale/en-us/html/Microsoft%20Silverlight%20Release%20History.htm#SL_5_1_10411)）

该错误已在 v5.1.x 中修复，但是，当我在 Visual Studio 中开发时，它总是为 5.0.x 设置网页，如上所示。

将值 minRuntimeVersio 更改为 5.1.x 并不是那么简单。我尝试了这一点，并使用参数 &v=5.1 修改了链接......，它不起作用，因为测试我什至可以“要求”5.2它甚至不存在，并且链接不显示无效请求。

知道如何确保用户拥有最新的插件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T15:18:28.220

这个对我有用。您不需要包含次要版本号，“5.1”就足够了。我无法检查 5.0，但如果我将其设置为“5.2”，则会出现“此页面需要更新版本的 Silverlight”对话框。链接中的版本号没有任何作用。链接到的页面总是下载最新版本（原因很明显）。

```
<param name="minRuntimeVersion" value="5.1"/> 
```

# android - 为 ViewPager 小部件动态配置视图？

> ID：14420085
> 
> 赞同：1
> 
> 时间：2013-01-19T23:35:22.300
> 
> 标签：android

首先让我说我对 android 开发非常陌生（虽然我对 java 的基础知识有很好的理解），并且我正在为我工​​作的校园出版物构建一个杂志阅读器应用程序。

我想使用 ViewPager 小部件显示每篇文章。我将构建一个 java 程序，使杂志编辑能够将 .txt 格式的文章以及与每个相关的图像一起发布到服务器上，并让 android 应用程序定期将这些文章下载到本地文件夹。

我对如何从文本文件构建每个 ViewPager 的视图有点困惑。不知何故，我的逻辑需要确定运行应用程序的屏幕大小，以便知道每个屏幕上可以容纳多少字。

这是对的，还是我从根本上误解了 ViewPager ？如果是这样，我如何构建程序以根据给定的 txt + 图像动态配置视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:57:01.237

据我了解，每个页面都会包含尽可能多的文章，当用户选择文章时，他们将能够看到整个内容。像这样的东西，但它填满了整个屏幕？

![脉冲](../Images/50f0d9867db09d3af27277f67c13e875.png)

如果是这种情况，您有两个选择：

1.  只需将文本视图椭圆化，使其以“...”结尾。可能是首选解决方案。
2.  调整 TextView 的大小以适合所有文本（[Auto Scale TextView Text to Fit within Bounds](https://stackoverflow.com/questions/5033012/auto-scale-textview-text-to-fit-within-bounds)）。

* * *

**编辑：** 这是对您问题的不同解释。

据我了解，您正在尝试使用诸如电子书阅读器之类的未定义页数的东西；Flipboard 的功能：

![翻板](../Images/2a1c0064f0a7d4b39fc4e1318c3142f1.png)

基本上，一旦所有文本填满整个区域，您就希望它继续到下一页。

如果您不需要本机性能，最简单的方法是只使用 a `WebView`，将文本分成几列，并且一次只能看到一列。

但是，当然可以计算出整个文本的高度，然后将其拆分；即[Android TextView中的分页](https://stackoverflow.com/questions/6224517/pagination-in-android-textview/6224666#6224666)

似乎已经提出并解决了类似的问题：[Spliting a TextView into multiple TextViews relative to screen height](https://stackoverflow.com/questions/6270579/splitting-a-textview-into-multiple-textviews-relative-to-screen-height)（参见接受的答案）。

# java - Java 独立到 Web

> ID：14420095
> 
> 赞同：-2
> 
> 时间：2013-01-19T23:36:37.090
> 
> 标签：java, jakarta-ee, deployment, web, desktop-application

假设我有一个独立的 java 应用程序。现在我想让多个客户端通过网络或 Web（HTTP 或 Web 服务）访问它。将独立应用程序转换为可远程访问的应用程序的最佳方法是什么？有没有推荐的简单框架？有什么最佳做法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:39:48.903

> [Java Web Start](https://stackoverflow.com/tags/java-web-start/info) (JWS) 是 Oracle Corporation 的技术，用于直接从网络或 Internet 链接启动富客户端（Swing、AWT、SWT）桌面应用程序。它为支持 Java 的平台提供“一键式”安装。
> 
> JWS 提供了许多吸引人的功能，包括但不限于启动屏幕、桌面集成、文件关联、自动更新（包括延迟下载和更新的编程控制）、按平台、体系结构或 Java 版本、配置划分本地和其他资源下载运行时环境（最低 J2SE 版本、运行时选项、RAM 等），使用扩展轻松管理公共资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T23:40:42.533

关于套接字的 Java 教程[All about sockets](http://docs.oracle.com/javase/tutorial/networking/sockets/index.html)可能会有所帮助。这是如果您希望您的 java 应用程序成为某种服务器的情况。本教程向您展示了如何使用 ServerSocket 连接到您的 Java 应用程序（在本教程中，他们还编写了一个连接到服务器的客户端）。当您对套接字有基本的了解时，这只是一小步，例如，开始处理 HTTP 请求（这方面的教程也很容易在 Web 上找到）。

# php - 提交 Ajax 后表单重新呈现

> ID：14420096
> 
> 赞同：0
> 
> 时间：2013-01-19T23:36:41.697
> 
> 标签：php

```
<html>
<head>
<script language="JavaScript" type="text/javascript">
function ajax_post(){
    // Create our XMLHttpRequest object
    var hr = new XMLHttpRequest();
    // Create some variables we need to send to our PHP file
    var url = "index2.php";
    var fn = document.getElementById("first_name").value;
    var ln = document.getElementById("last_name").value;
    var vars = "firstname="+fn+"&lastname="+ln;
    hr.open("POST", url, true);
    // Set content type header information for sending url encoded variables in the request
    hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    // Access the onreadystatechange event for the XMLHttpRequest object
    hr.onreadystatechange = function() {
        if(hr.readyState == 4 && hr.status == 200) {
            var return_data = hr.responseText;
            document.getElementById("status").innerHTML = return_data;
        }
    }
    // Send the data to PHP now... and wait for response to update the status div
    hr.send(vars); // Actually execute the request
    document.getElementById("status").innerHTML = "processing...";
}
</script>
</head>
<body>
<h2>Ajax Post to PHP and Get Return Data</h2>
Your First Name: <input id="first_name" name="first_name" type="text" /> 
<br /><br />
Your Last Name: <input id="last_name" name="last_name" type="text" />
<br /><br />
<input name="myBtn" type="submit" value="Submit Data" onClick="javascript:ajax_post();">
<br /><br />
<div id="status"></div>
</body>
</html>
<?php 
echo 'Thank you '. $_POST['firstname'] . ' ' . $_POST['lastname'] . ', says the PHP file';
?> 
```

上面的代码工作并提交数据并获取结果，以及再次呈现表单的结果。图片 --> [http://oi47.tinypic.com/1bt02.jpg](http://oi47.tinypic.com/1bt02.jpg)

如何解决？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:40:10.380

不要在您发送给 Ajax 请求的响应中包含该表单。

# model-view-controller - V可以访问MVC中的M吗？

> ID：14420098
> 
> 赞同：2
> 
> 时间：2013-01-19T23:37:07.113
> 
> 标签：model-view-controller

在使用自定义 MVC 框架时，我发现视图实际上可以访问模型中的数据。这有点令人惊讶，因为我一直认为 V 必须经过 C。就像

```
//this is completely made up but not far off
serverside foreach(var v in Model.GetSomeList()) {
    <div>@v.name</div>
} 
```

任何编程语言中的许多 MVC 框架是否允许视图访问模型中的任何内容？我什么时候选择应该通过控制器的内容以及可以从视图访问的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T23:49:33.890

This is common. If you look at the [Wikipedia page](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller) for MVC, this is what it says for the view:

> A view requests from the model the information that it needs to generate an output representation.

MVC is an architectural style, so some people change it as they see fit. From the design intentions of the architecture this particular question is certainly not frowned upon.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T23:50:18.073

Usually that "Model" is really like viewmodel, not the business layer Model object, although it could be the POCO version of the business object. Basically, the view is bound to some poco without any business logic.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T00:31:12.900

### 经典 MVC 中的信息流。

MVC 中的数据不应该从模型通过控制器传递到视图。那是违反原始概念的。

如果您阅读 MVC 设计模式的[原始定义](http://www.itu.dk/courses/VOP/E2005/VOP2005E/8_mvc_krasner_and_pope.pdf)，您会注意到视图旨在从模型请求数据。视图知道什么*时候*做，因为他们正在观察模型的变化。

### 现代诠释。

在最初的概念中，您应该为应用程序中的每个元素设置小的 MVC 三元组。在现代解释中（根据*Martin Fowler*），模型不再是任何单个对象或类。模型是一个层，其中包含几组对象。每个人都有不同的职责。

此外，随着 Web 的兴起，还有另一个问题。您不能将经典 MVC 用于网站。从理论上讲，现在您可以通过保持打开的套接字并在每次更改模型层中的某些内容时向浏览器推送通知来实现它。

但实际上，即使是拥有 100 个并发用户的站点也会开始出现问题。而且你不会使用 MVC 来制作一个博客。使用这种方法即使是较小的社交网络也是不可能的。

这不是与原始概念的唯一分歧。

### 受 MVC 启发的模式

目前，连同经典的 MVC（甚至不再那么经典了）。受 MVC 启发的模式主要有以下三种：

*   *模型2 MVC*

    这基本上是相同的经典 MVC 模式，但模型之后和视图之间没有观察者关系。这种[模式](http://www.javaworld.com/javaworld/jw-12-1999/jw-12-ssj-jspmvc.html)对我来说更面向网络。每次收到用户请求时，您都知道模型层会发生一些变化。因此，每个用户请求都会导致视图实例向模型层请求信息。

*   *MVP*

    这种模式，而是用演示者替换控制器。演示者从模型层请求数据并将其传递给当前视图。[您可以在此处](http://www.wildcrest.com/Potel/Portfolio/mvp.pdf)找到模式定义。它实际上要复杂得多，老实说，我并不完全理解它。

    在这种情况下，视图是被动的，不会从模型层请求任何数据。

*   *MVVM*

    这种模式更接近 MVP hen 和经典 MVC。在这种情况下，类似控制器的结构（实际上将是一个整体类）从模型层请求数据，然后以（被动）视图所期望的方式对其进行更改。

    这种模式主要针对开发人员没有完全控制视图或/和模型层的情况。例如，当您开发模型层为 SAP 的应用程序时。或者当您必须使用现有的前端基础架构时。

    > [仅供参考：在 ASP.NET MVC 中所谓的“MVVM”实际上是一个很好的 Model2 实现。他们所谓的“视图模型”实际上是视图实例，而“视图”只是视图使用的模板。]

# text - 用记事本++中的特定文本替换空行

> ID：14420099
> 
> 赞同：5
> 
> 时间：2013-01-19T23:37:14.683
> 
> 标签：text, replace, notepad++

例如我有一个文本

```
Line1

Line3

Line5

Line6 
```

我需要用特定的文本替换空白行，例如 CoolText 所以结果是

```
Line1
CoolText
Line3
CoolText
Line5
CoolText
Line6 
```

如何做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T00:19:43.823

您可以使用 NotePad++ 中的扩展替换功能。搜索双回车/换行对 ( `\r\n\r\n`)，并将它们替换为回车/换行对、替换文本和另一个 CR/LF 对 ( `\r\nCoolText\r\n`)。

在单击“全部替换”之前，这是设置了替换对话框的文本文件：

![替换图像前的 NPP](../Images/603b4d235e2cea7908c0128a5421af45.png)

以下是点击“全部替换”后的结果：

![在此处输入图像描述](../Images/dec25d991da0d9f4234e21d395e2f74e.png)

# r - 在 lm() 调用中更新数据

> ID：14420101
> 
> 赞同：3
> 
> 时间：2013-01-19T23:37:26.073
> 
> 标签：r, regression

lm 调用对象的数据部分是否有等效的更新？

例如，假设我有以下模型：

```
dd = data.frame(y=rnorm(100),x1=rnorm(100))
Model_all <- lm(formula = y ~ x1, data = dd) 
```

有没有一种方法可以对 lm 对象进行操作以产生等效的效果：

```
Model_1t50 <- lm(formula = y ~ x1, data = dd[1:50,]) 
```

我正在尝试从样本预测测试中构建一些 psudo，拥有一个 lm 对象并简单地滚动数据会非常方便。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T01:45:26.227

我相当肯定这`update`实际上是你想要的！

```
example(lm)
dat1 <- data.frame(group,weight)
lm1 <- lm(weight ~ group, data=dat1)
dat2 <- data.frame(group,weight=2*weight)
lm2 <- update(lm1,data=dat2)
coef(lm1)
##(Intercept)    groupTrt 
##      5.032      -0.371 
coef(lm2)
## (Intercept)    groupTrt 
##     10.064      -0.742 
```

如果您希望由此提高效率，您会感到失望——R 只是替换新参数并重新评估调用（参见 的代码`update.default`）。但它确实使代码更干净......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T23:52:51.250

biglm 对象可以更新以包含*更多*数据，但不能更少。因此，您可以按相反的顺序执行此操作，从较少的数据开始，然后添加更多。见[http://cran.r-project.org/web/packages/biglm/biglm.pdf](http://cran.r-project.org/web/packages/biglm/biglm.pdf)

但是，我怀疑您对为子总体估计的参数感兴趣（即，如果行 1:50 对应于`"a"`因子变量的水平`factrvar`。在这种情况下，您应该在公式中使用交互（`~factrvar*x1`）而不是子集到`data[1:50,]`。这种类型的交互将对 的每个级别给出不同的效果估计。这`factrvar`比单独估计每个参数更有效，并且将限制任何附加参数（即`x2`in每次都会收到一个单独的参数估计。`~factrvar*x1 + x2``factrvar``x2`

# javascript - 设置值时引导模式崩溃

> ID：14420105
> 
> 赞同：0
> 
> 时间：2013-01-19T23:37:50.590
> 
> 标签：javascript, html, twitter-bootstrap, web

在我的网站中，我正在尝试使用引导模式来询问两个值并获取其中的值。我有一个按钮，单击该按钮时，会计算两个值的中间值并设置我在模态体代码中声明的值。它设置值，然后模式消失并重新加载网页。你能告诉我我做错了什么吗？

在 HTML 中，模态体：

```
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="myModalLabel">Get Middle.</h3>
    </div>
    <div class="modal-body">
        <form class="form-inline">
        <div class="input-prepend">
            <span class="add-on">$</span>
            <input class="span2" id="lowSide" type="text">
        </div>
        to 
        <div class="input-prepend">
            <span class="add-on">$</span>
            <input class="span2" id="highSide" type="text">
        </div> 
        <button type="submit" class="btn" onClick="enteredRange(lowSide.value,highSide.value)">Enter</button>
        </form>
    <form class="form-inline"> <label>middle:</label> <input id="middle" type="text" /> </form>
    </div>
</div> 
```

设置它的javascript函数：

```
function enteredRange(x,y)
{
    var low=parseFloat(x);
    var high=parseFloat(y);
    var middle1=parseInt((low+high)/2);

    middle.value=middle1;
} 
```

我也做过

```
document.getElementById('middle').value=middle1; 
```

代替 middle.value=middle1 并得到相同的结果。

关于如何正确设置的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:11:48.977

您应该摆脱这些**`<form></form>`**元素，因为您不需要它们，它们会导致页面通过表单发布重定向。我还删除了一些不必要的关闭 div。我不知道您的其余代码是否需要它们。最后清理了你的标记。

```
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog"
aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
         <h3 id="myModalLabel">Get Middle.</h3>
    </div>
    <div class="modal-body">
        <div class="form-inline">
            <div class="input-prepend"> <span class="add-on">$</span>
                <input class="span2" id="lowSide" type="text" />
            </div>
            to
            <div class="input-prepend"> <span class="add-on">$</span>
                <input class="span2" id="highSide" type="text" />
            </div>
            <button class="btn" onClick="enteredRange(lowSide.value,highSide.value)">Enter</button>
        </div>
        <br />
        <div class="form-inline">
            <label>middle:</label>
            <input id="middle" type="text" />
        </div>
    </div>
</div>
<br />
<button id="btn">OPEN MODAL</button> 
```

这是**[jsFiddle 上的工作代码](http://jsfiddle.net/onury/rbpxR/)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T00:18:06.200

这里发生了两件事。

1.  单击提交按钮时，实际上是在提交表单。
2.  如果`method`为 a 指定no ，`form`则默认为`GET`。

这就是您看到错误的原因。

您需要阻止表单提交。你可以简单地使用`onsubmit`来做到这一点：

```
<form class="form-inline" onsubmit="return false;"> 
```

* * *

我不提倡内联 JavaScript，所以这里有一个更好的方法；向表单添加一个 ID 并附加一个阻止提交的点击处理程序：

### HTML：

```
<form class="form-inline" id="middle-calculator"> 
```

### JS：

```
document.getElementById('middle-calculator').addEventListener('submit',function (e) {
    e.preventDefault();
},false); 
```

`e`这是“事件”。

[工作示例（JSFiddle）](http://jsfiddle.net/jkUtu/1/)

* * *

另一件小事……从 Bootstrap 文档复制时要小心。始终对特殊字符使用 HTML 实体；关闭模式图标应该是`&times;`（或`&#215;`）。

# php - PHP Parse.com 查询错误

> ID：14420107
> 
> 赞同：1
> 
> 时间：2013-01-19T23:38:05.637
> 
> 标签：php, api, runtime-error, parse-platform

我不知道你们中有多少人熟悉 parse.com 平台，但我正在使用链接在他们网站上的第三方 php 库，我遇到了一些问题。

链接：[Parse.com PHP 库](https://github.com/apotropaic/parse.com-php-library)

我正在尝试查询我的数据库，但它不断返回`Notice: Trying to get property of non-object.`从我所看到的我的代码是正确的，但错误源于库中包含的文件之一。

到目前为止，这是我的代码：

```
function storeInParseDB ($message, $unit) {

    $parse = new parseQuery($class = 'PushNotifications');
    $parse->whereEqualTo('unit', $unit);
    $result = $parse->find();

    echo "RESULT: ";
    print_r($result);
} 
```

引发错误的代码：

```
private function checkResponse($response,$responseCode,$expectedCode){
        //TODO: Need to also check for response for a correct result from parse.com
        if($responseCode != $expectedCode){
            $error = json_decode($response);
            $this->throwError($error->error,$error->code);
        }
        else{
            //check for empty return
            if($response == '{}'){
                return true;
            }
            else{
                return json_decode($response);
            }
        }
    } 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T15:02:18.923

我在克隆[https://github.com/apotropaic/parse.com-php-library.git](https://github.com/apotropaic/parse.com-php-library.git)后运行以下代码- 创建了一个带有 appid、restkey 和 masterkey 的 parseConfig.php 文件，如自述文件中所述。

我在 Parse Data Browser 中创建了一个新类，其中包含一个字符串类型的“单元”列，并在其中添加了一行，unit = test。

```
<?php

include 'parse.com-php-library/parse.php';

function storeInParseDB ($message, $unit) {
        $parse = new parseQuery('PushNotifications');
        $parse->whereEqualTo('unit', $unit);
        $result = $parse->find();

        echo "RESULT: ";
        print_r($result);
}

storeInParseDB('hi', 'test'); 
```

如您所见，我得到了所需的输出，请确保您已正确设置 parseConfig.php 文件。

```
RESULT: stdClass Object
(
    [results] => Array
        (
            [0] => stdClass Object
                (
                    [unit] => test
                    [createdAt] => 2013-01-21T14:57:26.613Z
                    [updatedAt] => 2013-01-21T14:57:26.613Z
                    [objectId] => 0uiYuJcRYY
                )

        )

) 
```

# backbone.js - 从服务器端渲染页面时保持状态

> ID：14420108
> 
> 赞同：0
> 
> 时间：2013-01-19T23:38:07.557
> 
> 标签：backbone.js, pushstate, singlepage

我目前正在使用backbone.js 构建一个单页应用程序

为了保持所有应用程序页面可访问和可抓取，我确保服务器端在直接访问页面时也可以呈现页面。

问题如下：当 pushState 不可用时，它使用当前 URL 启动路由器（例如，如果我使用[http://example.com/example](http://example.com/example)访问 url，路由器将在该 url 之上构建哈希片段）

所以：

1.  有没有办法处理这个（除了重定向使用）
2.  如果您在 JS 后立即重定向（使用 pushState 功能检测），您仍然会遇到 url 没有哈希符号的问题。

一般会问，有没有更好的方法来设计这种应用程序？

**谢谢！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T15:15:12.523

如果 SEO 友好的浏览对您很重要，我认为不断发展的共识是 pushstate 或什么都不是（即降级 web 1.0 并同时放弃 hash-bang 路由）。

我不使用 Backbone.js 而只使用**PJAX**的原因之一是 pushstate 和 DOM 渲染时间非常好，您可以使用非常少的 JS 成为单页，而 hash-bang 路由一直很笨拙。

因此，一个选项是不一起使用 Backbone 的路由器，而让 PJAX（或 DJAX 或类似的东西）之类的东西做路由工作，让 Backbone 只做内页事件/渲染的东西（即验证表单、模式窗口等）。 .)。

# php - 重新排列存储在变量中的日期格式

> ID：14420111
> 
> 赞同：0
> 
> 时间：2013-01-19T23:38:39.320
> 
> 标签：php, mysql

我想重新构造存储在变量中的日期格式。我从存储为 YYYY-MM-DD HH:MM:SS 的 MySQL 数据库中检索日期/时间，并且我正在使用 PHP。

我想将日期显示为

2013 年 3 月 2 日星期四下午 2:30

这可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T23:39:29.463

请查看这些日期格式。
[http://php.net/manual/en/datetime.formats.date.php](http://php.net/manual/en/datetime.formats.date.php)

并使用这个 php 代码（我还没有放下正确的格式！）

```
$datetime = strtotime($mysqldatevalue);
$mysqldate = date("Y-m-d H:i:s", $datetime); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T23:50:35.100

```
$date = date("Y-m-d H:i:s", strtotime($dbdate)); 
```

You can also to this directly in your query:

```
DATE_FORMAT(datecolumn,'%Y-%m-%d %H:%i:%s') as date 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T23:59:38.097

即使你可以使用这个：因为你提到：

> ***我想将日期显示为 Thu 2nd Mar 2013 2:30pm 这可能吗？***

查询：语法：`'%a %D %b %Y %r'`

```
SELECT DATE_FORMAT('2013-03-02 14:30:00',
               '%A %D %b %Y %r');

 | DATE_FORMAT('2013-03-02 14:30:00',
               '%A %D %B %Y %R') |
-----------------------------------------------------------------------
|                                        Sat 2nd Mar 2013 02:30:00 PM | 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T23:40:48.570

是的，这是可能的。使用 strtotime() 将 SQL 日期更改为 unix 时间戳，然后将其作为第二个参数与适当的[格式字符串](http://us2.php.net/manual/en/function.date.php)一起提供给 date() 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T23:41:40.147

`date("d/m/Y H:i:s",strtotime($time_from_db))`将转换`2012-01-01 10:12:14`为`01/01/2012 10:12:14`，您可以将第一个参数替换为您所需要的，从[php 站点中的日期函数中的规范](http://php.net/manual/en/function.date.php)

# android - Fragment.onCreate() 和 Activity.onCreate() 的关系

> ID：14420116
> 
> 赞同：1
> 
> 时间：2013-01-19T23:39:46.340
> 
> 标签：android, android-fragments

亲爱的开发者，

Fragment 的 onCreate() 方法和 Activity 方法之间的关系对我来说还不是很清楚。我正在将一个片段附加到这样的活动中。

```
//happens in the Activity:
protected void onCreate(Bundle savedInstanceState) { 
    super.onCreate(savedInstanceState);
    FragmentManager fragMan = this.getSupportFragmentManager();
    Fragment dataModelFragment = fragMan.findFragmentByTag("data_model");
    if (dataModelFragment == null) {
        dataModelFragment = new DataModelFragment();
        fragMan.beginTransaction().add(dataModelFragment,"data_model").commit();
    }
    System.out.println("Executing Activity.onCreate()");
} 
```

我的 Fragment 的 onCreate() 有一个 Sysout.println() 用于测试目的，以查看它何时执行。让我感到奇怪的是：为什么 Activity 的 onCreate 会在调用 Fragment 的 onCreate() 之前先完成执行？发生的情况是，上面代码中显示的 Sysout.println 实际上在另一个 Sysout.println 之前执行，它位于我的 Fragment 的 onCreate() 中。我希望在通过片段事务将片段添加到活动之前执行片段的 onCreate()。这是它应该工作的方式吗？还是我在文档中读到的问题是 commit() 方法不会立即执行，而是仅将片段事务放在队列中？

我想要实现的是：

*   我使用 Fragment 的单例实例作为要在活动生命周期中保留的数据模型。
*   我想将此片段添加到活动中，然后让此片段执行其初始化（创建数据库连接并将数据加载到其数据成员中）
*   最后，片段中的这些数据应该与 Activity 视图中的 AdapterViews 一起使用。

所以这三个步骤：用数据初始化片段，将片段附加到活动，从片段的数据在活动中创建适配器。我的问题：这些事件应该以哪些方法发生以确保正确的执行顺序？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-06T20:17:39.030

来自 Android`FragmentTransaction.Commit()` [文档](https://developer.android.com/reference/android/app/FragmentTransaction.html#commit%28%29)：

> 安排此事务的提交。提交不会立即发生；它将被安排在主线程上的工作，以便在该线程下一次准备好时完成。

如果您希望立即处理您的事务，请`FragmentManager.ExecutePendingTransactions()`从您的 UI 线程调用。

# x86 - ELF64 比 ELF32 小吗？

> ID：14420127
> 
> 赞同：0
> 
> 时间：2013-01-19T23:41:12.970
> 
> 标签：x86, 64-bit, 32-bit, elf

我很确定 ELF64 比 ELF32 大，但我在论坛上与某人发生争执，他声称在将输出切换到 ELF64 后，他的程序小了 1/3。哪个更大？哦，他的程序在 NASM 中，所以没有任何优化或任何东西，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:21:43.867

我不知道你是否读过[这篇](http://www.tortall.net/projects/yasm/manual/html/objfmt-elf64.html)文章，但似乎 ELF64 使用 64 位寻址，而 ELF32 使用 32 位寻址......

# c# - 如何在具有多个间接级别的项目中使用单元测试

> ID：14420128
> 
> 赞同：10
> 
> 时间：2013-01-19T23:41:16.013
> 
> 标签：c#, unit-testing, mocking, tdd

我正在查看一个相当现代的项目，该项目非常强调单元测试。根据古老的格言“面向对象编程中的每个问题都可以通过引入新的间接层来解决”，这个项目正在运动多层间接。副作用是相当多的代码如下所示：

```
public bool IsOverdraft)
{
    balanceProvider.IsOverdraft();
} 
```

现在，由于强调单元测试和保持高代码覆盖率，每段代码都有针对它编写的单元测试。因此，这个小方法将存在三个单元测试。那些会检查：

1.  如果 balanceProvider.IsOverdraft() 返回 true 那么 IsOverdraft 应该返回 true
2.  如果 balanceProvider.IsOverdraft() 返回 false 那么 IsOverdraft 应该返回 false
3.  如果 balanceProvider 抛出异常，则 IsOverdraft 应该重新抛出相同的异常

更糟糕的是，使用的模拟框架 (NMock2) 接受方法名称作为字符串文字，如下所示：

```
NMock2.Expect.Once.On(mockBalanceProvider)
    .Method("IsOverdraft")
    .Will(NMock2.Return.Value(false)); 
```

这显然使“红色，绿色，重构”规则变为“红色，绿色，重构，在测试中重命名，在测试中重命名，在测试中重命名”。使用像 Moq 这样的不同模拟框架将有助于重构，但它需要对所有现有的单元测试进行扫描。

处理这种情况的理想方法是什么？

A) 保留较小级别的层，以便不再发生这些转发呼叫。

B) 不要测试那些转发方法，因为它们不包含业务逻辑。出于覆盖目的，它们都用 ExcludeFromCodeCoverage 属性标记。

C) 仅在调用正确的方法时进行测试，而不检查返回值、异常等。

D）收拾一下，继续写那些测试；）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T00:06:39.500

B 或 C。这就是这种一般要求的问题（*“每个方法都必须有单元测试，每一行代码都需要被覆盖”*） - 有时，它们提供的好处不值得付出代价。如果这是您想出的，我建议重新考虑这种方法。“*我们必须有 95% 的代码覆盖率”*可能在纸面上很有吸引力，但实际上它很快就会产生像你所遇到的问题。

此外，您正在测试的代码是我称之为**trivial code**的代码。对其进行 3 次测试很可能是矫枉过正。对于那一行代码，您将不得不维护 40 多个。除非您的软件是关键任务（这可能解释了高覆盖率要求），否则我会跳过这些测试。

Kent Beck 不久前在这个网站上提供了关于这个主题的（恕我直言）[最实用的建议之一，我在我的博客文章中对这些想法进行了一些扩展——](https://stackoverflow.com/a/153565/343266)[*你应该测试什么？*](http://jimmykeen.net/articles/14-oct-2012/what-should-you-test)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-20T00:44:55.770

老实说，我认为**我们应该只编写测试来以有用的方式记录我们的代码**。我们不应该仅仅为了代码覆盖而编写测试。（代码覆盖率只是一个很好的工具来找出它没有被覆盖，这样我们就可以确定我们是否确实忘记了重要的单元测试用例，或者我们是否真的在某个地方有一些死代码）。

如果我编写了一个测试，但测试最终只是**实现的“重复”**或更糟......如果**测试比实际实现更难理解**......那么真的**不应该存在这样的测试**。没有人有兴趣阅读这样的测试。**测试不应包含实现细节**。测试是关于**“**应该发生什么”而不是**“如何”**完成。由于您已用“TDD”标记了您的问题，因此我要补充一点，TDD 是一种设计实践。因此，如果我已经提前 100% 确定我将要实现的设计是什么，那么我就没有必要使用 TDD 和编写单元测试（**但在所有情况下，我都将始终进行涵盖该代码的高级验收测试**）。当设计的东西非常简单时，这种情况经常发生，就像你的例子一样。TDD 不是关于测试和代码覆盖，而是真正帮助我们设计代码和记录代码。使用设计工具或文档工具来设计/记录简单/显而易见的事情是没有意义的。

在您的示例中，通过直接阅读实现比测试更容易理解发生了什么。该测试在文档方面没有增加任何价值。所以我很乐意删除它。

最重要的是，**此类测试非常脆弱**，因为它们与实现**紧密耦合**。从长远来看，当您需要重构东西时，这是一场噩梦，因为任何时候您想要更改它们都会破坏的实现。

我建议做的是不编写此类测试，而是进行更高级别的组件测试或快速集成测试/验收测试，这些测试将在完全不了解内部工作的情况下运行这些层。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T00:20:13.523

我认为单元测试要记住的最重要的事情之一是，今天如何实现代码并不一定重要，而是当测试的代码（直接或间接）在未来被修改时会发生什么。

如果您今天忽略这些方法并且它们对您的应用程序的操作至关重要，那么有人决定在以后的某个时候实现一个新的 balanceProvider 或者决定重定向不再有意义，那么您很可能会遇到故障点。

因此，如果这是我的应用程序，我会首先将只进调用减少到最低限度（降低代码复杂性），然后引入一个不依赖字符串值作为方法名称的模拟框架。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T03:26:46.340

有几件事要添加到这里的讨论中。

**立即逐步切换到更好的模拟框架。** 大约 3 年前，我们从 RhinoMock 切换到 Moq。所有新测试都使用最小起订量，当我们更改测试类时，我们经常会切换它。但是没有太大变化或有大量测试用例的代码区域仍在使用 RhinoMock，这没关系。由于进行了切换，我们日常使用的代码要好得多。所有测试更改都可以以这种增量方式发生。

**您正在编写太多测试。**在 TDD 中要记住的重要一点是，您应该只编写代码来满足红色测试，并且您应该只编写一个测试来指定一些未编写的代码。所以在你的例子中，三个测试是多余的，因为最多需要两个来强制你编写所有的生产代码。 **异常测试不会让你写任何新代码，所以没必要写。** 我可能只会写这个测试：

```
[Test]
public void IsOverdraftDelegatesToBalanceProvider()
{
    var result = RandomBool();
    providerMock.Setup(p=>p.IsOverdraft()).Returns(result);
    Assert.That(myObject.IsOverDraft(), Is.EqualTo(result);
} 
```

**不要创建无用的间接层。** 大多数情况下，单元测试会告诉你是否需要间接。大多数间接需求可以通过依赖倒置原则来解决，或者“耦合到抽象，而不是具体化”。由于其他原因需要某些层（我将 WCF ServiceContract 实现设置为一个薄的传递层。我也没有测试该传递）。如果你看到一个无用的间接层，1）确保它真的没用，然后 2）删除它。随着时间的推移，代码混乱会带来巨大的成本。Resharper 使这变得非常简单和安全。

此外，对于有意义的委派或委派场景，您无法摆脱但需要测试，[这样](https://gist.github.com/4039017)的事情会使其变得容易得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T23:59:40.673

我会说 D) 把它收起来，继续编写这些测试；) 并尝试看看你是否可以用 MOQ 替换 NMock。

这似乎没有必要，即使它现在只是委托，但测试正在测试它是否使用正确的参数调用正确的方法，并且方法本身在返回值之前没有做任何时髦的事情。所以在测试中覆盖它们是个好主意。但是为了更容易使用 MOQ 或类似的框架，这将使重构变得更加容易。

# ember.js - 具有模拟远程响应 = false 的 FixtureAdapter 不呈现计算的属性

> ID：14420131
> 
> 赞同：0
> 
> 时间：2013-01-19T23:41:41.123
> 
> 标签：ember.js, ember-data

有没有人遇到同样的问题？

我的计算属性依赖于与 belongsTo 相关的对象。余烬：1.0.0-pre.2-291-g4785901 余烬数据：rev11

问题可以在这里复制... [http://jsfiddle.net/smadep/pVqte/13](http://jsfiddle.net/smadep/pVqte/13)

```
IceEmberApp.Store = DS.Store.extend({
    revision: 11,
    adapter: DS.FixtureAdapter.create({
        simulateRemoteResponse: false
    })
}); 
```

...

```
<div class="list" id="flatlist">
    {{#each substanceFindings tagName="ul"}}
        <li>{{substanceGroupName}} - {{substance.name}}: {{quantity}} <br />
            ... debug calcProp: {{substance.displayName}}</li > 
    {{/each}}
</div > 
```

在真假之间切换模拟远程响应并查看差异。

抱歉，当我保持 simRemResp 为真时，这个小提琴中还有更多内容，因为我有一个相关的问题。然后我没有从 Fixture 添加更深的嵌套对象的更新，因此计算的属性在这里也是错误的。

如果这不是问题，而是我的错误理解和编码风格，请接受我的道歉！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T12:06:49.083

显然，我的数据的固定装置没有正确加载/物化。

我更改了代码以将数据显式加载到存储中，例如

```
IceEmberApp.store.load(IceEmberApp.Substance,'1b9664a6-9a3b-40e1-92ff-f425b590b64b', {
  name: '3,4-methylenedioxymetamfetamine',
  abbreviation: 'MDMA',
  alternativeName: '',
  casNumber: '',
  substanceGroupId: '18d7c284-27a8-4c3e-b855-4de752699782',
  substanceGroupName: 'AMFETAMINE TYPE STIMULANTS',
  substanceGroupWeight: 1.00000
}); 
```

...然后计算的属性和嵌套关系都可用，加载良好。

请参阅我的分叉 jsfiddle 以获取**工作**示例... [http://jsfiddle.net/smadep/tYSRf/](http://jsfiddle.net/smadep/tYSRf/)

好吧，这不是为什么使用下面设置固定装置的答案

```
IceEmberApp.Substance.FIXTURES = [{
  id: '6ae3880f-7b7a-4db3-a28c-880cf9fac2cc',
  findings: ['8ca9600f-c574-4e6e-a976-47f0a9004d63', ''],
  name: 'test1 β',
  abbreviation: '',
  alternativeName: '',
  casNumber: '',
  substanceGroupId: 'b96e2edb-2bc6-441e-8379-8ad35e14eaf9',
  substanceGroupName: 'NPS Group 1',
  substanceGroupWeight: 1.00000
}, ...
] 
```

...**没有工作**，但我的问题解决了:-)

# jquery - 多个 .click 事件的更有效代码？

> ID：14420137
> 
> 赞同：-1
> 
> 时间：2013-01-19T23:43:18.763
> 
> 标签：jquery

而不是做

```
$("#IsOutdoors").click(function () {
    SendData();
});

$("#HasPatio").click(function () {
    SendData();
}); 
```

如果我想做多个 .click 事件，有没有更好的方法？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T23:45:16.587

只需在一个字符串中使用所有选择器，并用逗号分隔它们：

```
$("#IsOutdoors, #HasPatio").click(function () {
    SendData();
}); 
```

* * *

对于更简洁的版本，您可以将`SendData`函数本身传递给`click`：

```
$("#IsOutdoors, #HasPatio").click( SendData ); 
```

但请注意，这将改变`this`.`SendData`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T23:45:25.703

```
$("#IsOutdoors,#HasPatio").click(SendData); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T23:51:51.333

有很多方法：

*   **组合选择器**
    就像在 CSS 中所做的那样，使用逗号来定位多个选择器：
    `$("#IsOutdoors, #HasPatio").click(SendData);`
*   **添加到 jQuery 集合**
    您可以使用[`$.add()`](http://api.jquery.com/add/). 由于各个选择是内部快捷方式，`getElementById()`而不是使用 full`querySelectorAll()`或 Sizzle，因此这可能更有效。
    `$("#IsOutdoors").add("#HasPatio").click(SendData);`
*   **为元素添加一个公共类**
    这并不是一个真正的脚本解决方案，但如果元素在逻辑上相似，那么一个类可能是合适的。
    `$(".someClass").click(SendData);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-19T23:52:13.623

这取决于你所说的更好。你想要更少的代码但同样的结果吗？你可以做类似的事情

```
$("#IsOutdoors, #HasPatio").click(SendData); 
```

如果您希望减少单击处理程序的数量，例如，如果您有多个 DOM 元素都具有相同的单击处理程序，则可以改为将事件处理程序放在父元素上。然后，您可以列出应该将此事件委托给的元素的所有 ID，或者为它们提供一个通用类，例如`clickable`. 假设您的 HTML 如下所示：

```
<div id='someParent'>
  <div id='IsOutdoors' class='clickable'></div>
  <div id='HasPatio' class='clickable'></div>
</div> 
```

您可以将点击处理程序简化为

```
$("#someParent").on('click', '.clickable", SendData); 
```

或者如果您不想像我建议的那样添加课程

```
$("#someParent").on('click', '#IsOutdoors #HasPatio", SendData); 
```

# matlab - MATLAB - 我的 while 循环条件，用于从时间序列中提取特定数据

> ID：14420138
> 
> 赞同：0
> 
> 时间：2013-01-19T23:43:23.677
> 
> 标签：matlab, sorting, while-loop, timeserieschart

**背景**

我有 4 个数据集：一个是带有**时间**和**压力**的天气数据，另一个是具有相同的压力传感器数据集；**时间**和**压力**。本质上，两者都是时间序列。较长的时间序列是天气数据，这两个变量都有大约 64008 个数据点。压力传感器的较短时间序列是 51759。您可以说较短的时间序列是较长时间序列的子集，其中缺少一些数据点。无论如何，我想获得天气压力，但仅限于我的传感器所拥有的时间。

**动机**

所以基本上，我正在尝试实现一个**while 循环**，以便对于我的压力传感器的每个等效时间，无论是数据，我都会从天气数据中获取压力。我不需要从天气数据中记录时间，因为我可以使用压力传感器的时间序列。

**例子**

为了了解我在说什么，我做了一个示例脚本，它运行得很好。

```
x(:,1) = (1:50)';
x(:,2) = (51:100)';
y(:,1) = [1:12 20:25 40:45]';

i = 1;
j = 1;
while i < numel(y)+1
     if y(i) == x(j,1)
        a(i,1) = x(j,2);
        i = i + 1;
        j = j + 1;
     else 
        j = j + 1;    
    end
end

a
% check
size(y)
size(a) 
```

如您所见，我在 2 列中制作了一个带有长系列的 x 向量。然后我制作了向量 y 值的子集，其中包括 x 向量中包含的数据点。我运行我的脚本，a 的大小与 y 匹配，这意味着大小相同。我还看到矩阵本身具有相同的值。所以它有效。除非这是我遗漏了一些东西的简化版本。无论哪种方式，我的真实脚本都在下面。

```
% Pressure Data
west_time;
west_pressure;
% Weather Data
weather_data(:,1) = weather_time;
weather_data(:,2) = weather_pressure;
% Initialize vector
weather_pressure_sensor = zeros(numel(west_time));

% Obtaining the pressure from the weather data at a 
% particular point in time when it corresponds 
% with the time from my pressure sensor
i = 1;
j = 1;
while i < numel(west_time),
   if west_time(i) == weather_data(j,1)
       weather_pressure_sensor(i,:) = weather_data(j,2);
       i = i + 1;
       j = j + 1;
   else 
       i = i;
       j = j + 1;
   end  
end

% Weather Pressure
weather_pressure_final = weather_pressure_sensor(:,2); 
```

但是，当我转到我的数据集时，我遇到了错误代码：

```
Attempted to access weather_data(64009,1); index out of
bounds because size(weather_data)=[64008,2].

Error in data_timeset2 (line 69)
    if west_time(i) == weather_data(j,1) 
```

我想知道是否可以在我的代码方面获得一些帮助。我错过了什么还是我没有定义什么？这是我一直使用 while 循环的方式，所以我不知道为什么它现在决定让我失望。但无论如何，我确信这是一件非常琐碎和愚蠢的事情，但我无法为我的生活弄清楚。或者也许有人有另一种方式......？无论哪种方式，提前非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:02:20.883

如果您的数据集中的时间点是唯一的，那么有一种更好的方法可以做到这一点。

```
t1 = [...]; #% time series 1
t2 = [...]; #% time series 2; is a subset of t1
p1 = [...]; #% pressure series 1; same length as t1
p2 = [...]; #% pressure series 2; same length as t2

[t1, index] = sort(t1); #% make monotonic if it isn't already
p1 = p1(index); #% apply same sorting to pressures
[t2, index] = sort(t2); #% same for t2, p2
p2 = p2(index);

[Lia, Locb] = ismember(t2, t1); #% Lia contains indices of t2 that are in t1
                                #% Locb contains indices of t1 that are in t2
final_p = p1(Locb); #% get the values of p1 where t2 existed in t1 
```

# facebook - Facebook：计算分享帖子的唯一用户数

> ID：14420140
> 
> 赞同：0
> 
> 时间：2013-01-19T23:43:55.257
> 
> 标签：facebook, facebook-graph-api

是否可以远程获取在 facebook 粉丝页面上分享帖子的唯一用户数量？基本上我想在我的粉丝页面上发布状态更新。接下来，对于每次粉丝分享帖子时，我希望（分享帖子的用户数）在单独的网页上更新。我知道可以获得帖子的点赞数，但我如何获得分享帖子的 UNIQUE 用户的数量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:03:01.853

我相信您可以通过以下见解做到这一点：

```
/PAGE_ID/insights?metric=page_storytellers_by_story_type 
```

从我的页面上的外观来看，该`user post`值是唯一共享的数量。不过，文档对此并不十分清楚，所以 YMMV。

# iphone - 在 iPhone 中使用 NSURLRequest 下载文件的剩余时间

> ID：14420142
> 
> 赞同：1
> 
> 时间：2013-01-19T23:44:24.893
> 
> 标签：iphone, ios, objective-c, ipad, nsurlrequest

我正在我的应用程序中下载，我添加了文件下载大小和总大小等功能，但不知道如何管理完成此过程的剩余时间。谁能帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:04:40.333

您可以通过计算到目前为止的平均传输速率（接收的字节数/经过的时间）并将其应用于剩余的字节数来估计剩余时间。

在您`NSURLConnectionDelegate`的 实现中，`-connection:didReceiveResponse:`您需要记录传输开始的时间和响应的预期大小 ( `-[NSURLResponse expectedContentLength]`)。然后，当您通过接收数据块时，`-connection:didReceiveData:`您可以跟踪接收到的数据字节数。这将为您提供足够的信息来估计如上所述的剩余时间。

# java - Hibernate 数据类型/更新 pojo

> ID：14420144
> 
> 赞同：1
> 
> 时间：2013-01-19T23:45:07.133
> 
> 标签：java, hibernate

如何将此数据类型从更改`Date`为`DateTime`：

```
<property name="commentDate" type="date">
        <column name="CommentDate" length="10" not-null="true" />
    </property> 
```

# master-pages - 改变 NestedMasted Page 中的 innerText 以便更改的文本在整个会话期间保持不变

> ID：14420146
> 
> 赞同：0
> 
> 时间：2013-01-19T23:45:10.573
> 
> 标签：master-pages

我想更改位于我的 site.master 页面上的 div 的内部文本值，并且我希望更改的值在会话的其余部分保留。

我要提取的值是通过使用从 OAuth 获得的用户名：`User.Identity.Name;`

我只能在用户通过身份验证后访问此属性，根据身份验证后我的重定向，页面然后移动到 members_only 部分的嵌套母版页。我可以使用以下代码更改 div 的文本：

```
((HtmlGenericControl)Master.Master.FindControl("LoginButton")).InnerText = User.Identity.Name; 
```

但是一旦我重定向，文本就会变回 null。

我将它用于我的引导用户按钮，看起来像这样

```
 <div class="btn-group">
                        <a class="btn btn-primary" href="#"><i class="icon-user icon-white"></i>&nbsp;<div id="LoginButton" runat="server"></div></a><a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#"><span class="caret"></span></a><ul class="dropdown-menu">
                            <li><a href="~/Account/Manage.aspx"><i class="icon-pencil"></i>&nbsp;Manage</a></li>
                            <li class="divider"></li>
                            <li><a href="~/Account/Login.aspx"><i class="i"></i>Logout</a></li>
                        </ul>
                    </div> 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:13:15.600

您可以使用`LoginName`控件为您完成所有这些工作 - 只需将其放入您的 MasterPage。

# python - 使用 pyparsing 编写递归解析器

> ID：14420156
> 
> 赞同：5
> 
> 时间：2013-01-19T23:46:03.990
> 
> 标签：python, parsing, pyparsing

我试图`Forward()`从 pyparsing 中理解元素。假设我有这个简单的 BNF：

```
identifier  =
  "a..z,$,_"  <  "a..z,$,_,0..9"  >

package_name = 
  identifier 
  /  ( package_name  "." identifier ) 
```

我尝试解析一个简单的包，就像`java.lang.String`我得到`java`的结果一样，或者永远不会从递归中返回。我试过这样：

```
from pyparsing import alphas,alphanums, Word, Forward, ZeroOrMore, Group, Literal

identifier=Word(alphas+"$_",alphanums+"$_")
dot=Literal(".")

package_name = Forward()
definition = package_name+dot+identifier
package_name << Group(identifier+ZeroOrMore(definition))

package_name.parseString("java.lang.String") 
```

将打印 [['java']]

```
from pyparsing import alphas,alphanums, Word, Forward, ZeroOrMore, Group, Literal

identifier=Word(alphas+"$_",alphanums+"$_")
dot=Literal(".")

package_name = Forward()
definition = identifier^package_name+dot+identifier
package_name << definition

package_name.parseString("java.lang.String") 
```

将达到递归限制

这个占位符是如何`Forward`工作的？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-20T00:17:24.103

问题不在于`Forward`您的语法，而在于您的语法，它本质上要么限制得太早，要么以一种无法确定的方式递归，如 Pyparsing 之类的天真的递归下降解析器。

你有这个：

```
package_name = identifier | (package_name "." identifier ) 
```

如果从左到右匹配，这将始终匹配单个标识符，然后停止，而不尝试匹配下一个句点。如果您切换顺序以匹配`identifier`最后一个：

```
package_name = (package_name "." identifier) | identifier 
```

. . . 那么它将无限递归，因为为了判断是否`package_name`匹配，它要做的第一件事就是判断是否`package_name`匹配。这是一个[左递归](http://en.wikipedia.org/wiki/Left_recursion)语法，像 Pyparsing 这样的简单递归下降解析器无法处理。Pyparsing 不会提前查看匹配将如何影响后续匹配。它只是从左到右尝试匹配。

您可以`Forward`通过更改语法递归方式来获得一个简单的示例：

```
identifier  = pyp.Word(pyp.alphas+"$_", pyp.alphanums+"$_")
package_name = pyp.Forward()
package_name << ((identifier + '.' + package_name) | identifier)

>>> package_name.parseString("java.lang.String")
[u'java', u'.', u'lang', u'.', u'String'], {}) 
```

在这里，递归发生在右侧，而不是左侧，因此 Pyparsing 可以增量匹配它。

（您对 ZeroOrMore 的使用是一个红鲱鱼。如果您要使用这样的递归语法，则不想使用 ZeroOrMore，因为递归定义已经允许您的子表达式匹配多次。正如我所建议的不过，在我的评论中，在没有递归的情况下定义这种语法要简单得多。）

# mysql - 使用 MySQL 查询确定好友/请求的好友/非好友

> ID：14420159
> 
> 赞同：1
> 
> 时间：2013-01-19T23:46:23.330
> 
> 标签：mysql

我有这个 MySQL 表：

![在此处输入图像描述](../Images/3a8aa1d9b557866061954ae26563a95c.png)

假设我以用户 1 的身份登录，并且正在浏览用户 2 的个人资料。因为我们是共同的朋友（1 是 2 的朋友，2 是 1 的朋友），所以我需要回显“朋友”。

当我浏览用户 4 的个人资料时，我已经请求了他的好友，但他们还没有接受，我需要回显“好友请求”。

浏览任何其他用户时，我需要回显“添加朋友”。

我可以做 PHP 部分，我只是不知道如何做 MySQL 查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:47:08.193

```
SELECT COUNT(*) as `count`, `user` 
FROM `friends`
WHERE 
    (`user` = 1 AND `friend` = 16) OR 
    (`user` = 16 AND `friend` = 1) 
```

`count`什么时候

*   2 = 相互的（你和那个人是朋友）
*   1`user`是你——你要求那个人的友谊
*   1 并且`user`是那个人 - 那个人要求你建立友谊
*   0 = 你和那个人之间没有联系

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:23:35.753

你期待这样的事情吗？（仅用于 sql 部分，而不是 PHP :)）

[SQLFIDDLE 演示](http://www.sqlfiddle.com/#!2/31ccd/8)

```
SELECT DISTINCT a. user, 
                CASE 
                  WHEN a.user = b.friend 
                       AND a.friend = b.user THEN b.friend 
                  ELSE '' 
                end friends, 
                CASE 
                  WHEN a.user = b.friend 
                       AND a.friend <> b.user THEN a.friend 
                  ELSE '' 
                end friendreq, 
                CASE 
                  WHEN a.user <> b.friend 
                       AND a.friend <> b.user THEN a.friend 
                  ELSE '' 
                end addfriend 
FROM   demo a 
       LEFT JOIN demo b 
              ON a.id > b.id; 
```

```
| 用户 | 朋友 | 好友请求 | 添加好友 |
------------------------------------------
| 1 | | | |
| 2 | 2 | | |
| 1 | | | 16 |
| 1 | | 16 | |
| 16 | | | |
| 16 | | | 1 |
| 16 | 16 | | |
| 1 | | | 4 |
| 1 | | 4 | |
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T00:10:26.090

```
select (case 
    when subquery.a > 0 and subquery.b > 0 then 'friends'
    when subquery.a > 0 then 'friend requested'
    else 'add friend' end) as "friend_string"
from (
    select
        (select count(*) from relationships where user = '$my_user_id' and friend = '$opponent_user_id') as a,
        (select count(*) from relationships where user = '$opponent_user_id' and friend = '$my_user_id') as b
) subquery 
```

请`relationships`用您的表名替换，并用您的 $ 变量替换。

# java - 如何在java中声明文件路径

> ID：14420160
> 
> 赞同：-1
> 
> 时间：2013-01-19T23:46:45.207
> 
> 标签：java, android

我正在制作一个涉及内部数据库的 android 应用程序。我决定打开数据库文件而不是在应用程序中生成它。

这是代码：

```
private static String databasePath = "H:\Workspace\PetrocVLE\assets";
public SQLiteDatabase db = SQLiteDatabase.openDatabase(databasePath, null, 0); 
```

这是给出的错误：

```
Invalid escape sequence (valid ones are \b \t \n \f \r \" \' \\ ) 
```

我认为这可能意味着 databasePath 变量中有一些符号在字符串变量中是不允许的，但是我已经看到了在 java 中使用这些的其他字符串变量。

谁能告诉我我做错了什么？谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T23:48:24.577

`\`是 Java 中使用的特殊字符`Strings`，您需要对其进行转义，

```
private static String databasePath = "H:\\Workspace\\PetrocVLE\\assets"; 
```

但是，Android 上的文件路径通常采用这种格式

```
private static String databasePath = "/Workspace/PetrocVLE/assets"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T23:49:22.333

改为使用`/`，因为它独立于操作系统：

```
private static String databasePath = "H:/Workspace/PetrocVLE/assets"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T00:00:32.273

您可能还希望独立于驱动器，或者引用代表驱动器号的变量或尝试使用[相对路径](http://www.java2s.com/Tutorial/Java/0180__File/Absolutepathandrelativepath.htm)。

# html - 工作两列布局，高度调整以适应，固定宽度；这种设计对 SEO 友好吗？浏览器兼容性？

> ID：14420162
> 
> 赞同：-1
> 
> 时间：2013-01-19T23:46:48.370
> 
> 标签：html, css, internet-explorer, seo, two-column-layout

# 背景

我一直在寻找具有 960px 宽度和两列的布局：

*   主要内容：右对齐，宽度550px，从容器右边距插入；
*   侧边栏：左对齐，宽度为 250px，在顶部、左侧和底部边缘与容器齐平；

我一直在努力解决的问题是设置背景，使侧边栏背景占用 250px 宽度，100% 父级高度，并与父级左边缘齐平，让主要内容占用剩余宽度和 100% 高度父母。

我看过一些技术，但它们似乎相对不灵活，例如，虽然它很优雅，但 Faux Columns 似乎不太合适[http://www.alistapart.com/articles/fauxcolumns/](http://www.alistapart.com/articles/fauxcolumns/)。

考虑了一下，我决定尝试将内容的渲染与背景的渲染分开。具体来说，我将主要内容向右浮动，侧边栏向左浮动，然后 a`clear:both`以便容器将调整为两列中较大的一个。

接下来，虽然仍在容器内但在 之后`clear:both`，我有两个绝对定位的空 div，侧边栏的高度为 100%，宽度为 250px，`left:0`主要内容的宽度为 100%。我还调整了 z-index 以便侧边栏在前面。

还有其他必要的 CSS（例如容器包装器必须相对定位），但请参阅下面的源代码。

# 问题

这与我在带有 Safari 的 Mac 上所希望的完全一样，两个背景都根据最高的列展开，并且源代码中的标记是有效的。但是，我的两个主要担忧是：

1.  我不确定这将如何在其他浏览器中呈现，尤其是 IE
2.  我试图在设计时考虑到 SEO，但我对 SEO 不太了解，因为我还在学习，这对 SEO 有多友好？

## 其他来源

[如何使浮动 div 的高度达到其父级的 100%？](https://stackoverflow.com/questions/3049783/how-to-make-a-floated-div-100-height-of-its-parent)

[http://brentgrossman.com/348/not-so-fuax-columns/](http://brentgrossman.com/348/not-so-fuax-columns/)

（可能还有一些，抱歉不记得了！）

# 源代码

**注意**我使用了明亮的颜色和调整过的 div 来更好地说明正在发生的事情。

```
<!DOCTYPE html>
<html lang="en-US" >
<head>
<title>Test Page</title>
<meta charset="UTF-8"/>
<style>

#main {

}

#main-outer-wrapper {
    width: 960px;
    margin: 0 auto;
}

#main-inner-wrapper {
    background: red;
    /* This is the fallback background colour */
    position: relative;
    /* Must be relative for the background divs to have 100% height and to ensure z-index functions */
    z-index: -20;
    /* Ensure fallback background is below all other divs */
}

#main-content {
    /* This is where all the actual content will be */
    width: 550px;
    float: right;
    /* IMPORTANT float */
    background: orange;
    /* Background would actually be transparent, here it is for illustration */
    margin: 10px 80px 10px 10px;
    /* Keep content away from edges as part of design only*/
}

#left-primary-sidebar {
    /* This is for the actual sidebar content */
    float: left;
    /* IMPORANT float */
    background: green;
    /* Again, background colour is purely for illustration */
    width: 230px;
    margin: 10px;
    /* I have adjusted the margin for illustration only, in situ width is 250px and margin is 0 */
}

#main-content-background {
    /* This div has no content */
    background: blue;
    /* The intended right column background */

    /*  Position MUST be absolute so that the div can 
    *       have its height based on parent container, using
    *       top and bottom. Width can be specific but I have
    *       set it to 100% for maintainability */
    position: absolute;
    width: 100%;
    right: 0;
    top:0;
    bottom: 0;
    z-index:-10;
    /* As width is 100%, it is important that this is placed below the sidebar */
}

#left-primary-sidebar-background {
    /* As above regarding position */
    background: purple;
    position: absolute;
    width: 250px;
    left: 0;
    top:0;
    bottom: 0;
    z-index:-9;
    /* Div must be above right column */
}

.clear { 
    clear: both;
}

</style>
</head>

<body>
    <section id="main">
        <div id="main-outer-wrapper" class="wrapper outer-wrapper">
            <div id="main-inner-wrapper" class="wrapper inner-wrapper">
                <section id="main-content">
                    <div id="main-content-wrapper" class="wrapper">
                    Content
                    </div><!-- #main-content-wrapper -->
                </section><!-- #main-content -->
                <section id="left-primary-sidebar">
                    <div id="left-primary-sidebar-wrapper" class="sidebar">
                    Sidebar
                    </div><!-- #left-primary-sidebar-wrapper -->
                </section><!-- #left-primary-sidebar -->            <div id="main-content-background"></div>
                <div id="left-primary-sidebar-background"></div>
                <div class="clear"></div>
            </div><!-- #main-inner-wrapper -->
        </div><!-- #main-outer-wrapper -->
    </section><!-- #main -->
</body>
</html> 
```

感谢阅读，期待评论！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:41:05.193

至于它在 IE 中的外观，您可以使用[Abobe 的 BrowserLab 之](https://browserlab.adobe.com/)类的工具进行测试。

至于 SEO：设计对 SEO 的影响很小，除非您的设计导致页面加载缓慢，因为页面加载速度确实会产生影响。像谷歌这样的复杂搜索引擎使用文本在源代码中的位置来表示重要性的日子已经一去不复返了。如今，搜索引擎会分析您页面的实际文本内容，并将其与其他页面的文本内容进行比较。在 h1 标记中放置某些内容确实向搜索引擎表明该文本是标题，因此比页面上的其他文本稍微重要，但如果该文本实际上似乎与对文本其余部分的分析无关我认为他们抓住了这一点并丢弃了 h1 文本。

如果您的网站几乎没有竞争，那么您在网页上所做的事情会对您的排名产生巨大影响 - 但如果竞争程度中等，那么链接到您的网页的内容（以及链接的网页数量）给你的）占你页面排名分数的很大一部分，以至于你的页面结构绝对没有可衡量的影响。您页面的排名将取决于其内容与搜索词的相关性，并根据其他匹配页面内容的相对相关性进行加权。这纯粹是关于内容和权威。

所以我不会太担心您的页面结构将如何影响搜索引擎排名。只需确保页面快速加载，并且内容与您想要排名的搜索词尽可能相关。

# .net - Mono 是否支持 DirectSound？

> ID：14420163
> 
> 赞同：1
> 
> 时间：2013-01-19T23:46:51.463
> 
> 标签：.net, mono, directsound

我正在.NET2.0（我必须支持旧设备）中编写一个将使用 DirectSound 的应用程序。我可能需要将代码库移植到 Mono 以在某些 Linux 设备上运行。当我尝试这样做时，有没有人知道对 DirectSound 的引用可能会发生什么？

也许有一个我没有遇到过的符合 Mono 的场景。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:51:05.960

不，不支持 DirectSound。在 Linux/Mono 上，您通常会使用 GStreamer，例如[Banshee 。](http://git.gnome.org/browse/banshee/tree/src/Backends)

# c++ - 在 C++11 中序列化类型 ID？

> ID：14420164
> 
> 赞同：2
> 
> 时间：2013-01-19T23:47:03.537
> 
> 标签：c++, c++11

假设我有一些模板类：

```
template<class T>
class Foo
{
    void save(File& f);

    /* load */ Foo(const File& f);

    ...
} 
```

我有 Foo 的二进制文件格式。Foo::save 保存到文件中，Foo(File) 构造函数从文件中加载它。

当我保存它时，我想在标题中写入 T 的类型，然后当我加载它时，我想验证构造函数中使用的 T 是否与文件的相同。

我应该如何生成这种类型代码？

（例如，我可以对 typeid(T).name() 进行 SHA。但是这可以在程序调用之间改变。有更好的方法吗？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:00:06.020

没有真正的自动、便携的解决方案。我能想到的最好的办法是维护一个手动列表：

```
#include <type_traits>

template <typename T> struct persistent_type_id; // unimplemented primary!

template <> struct persistent_type_id<MyClass>
: std::integral_constant<uint32_t, 0x12345678> { };

template <> struct persistent_type_id<AnotherClass>
: std::integral_constant<uint32_t, 0x12345679> { };

// ... 
```

用法：

```
persistent_type_id<T>::value 
```

如果您未实现任何类型，您将立即收到编译器错误。

# javascript - iOS上的Phonegap / Cordova + MapKit：点击pin时执行javascript函数

> ID：14420166
> 
> 赞同：1
> 
> 时间：2013-01-19T23:47:11.083
> 
> 标签：javascript, cordova, mapkit, phonegap-plugins

我正在使用 Phonegap/Cordova 及其 MapKit 插件在 iOS 上构建基于 HTML/javascript 的应用程序。

我想在地图上单击图钉时执行 javascript 函数，最好不要让图钉显示其默认注释。（并且还传递了一些关于单击哪个引脚的数据，我猜它是 ID。）

只有在单击注释上的更多信息类型按钮后，pin tap 事件似乎没有任何回调类型功能（实际上并没有 pin tap 事件）。

任何人都知道此功能是否存在，或者我如何添加它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T18:42:39.627

我已经回答了我自己的问题——这就是我最终放入 MapKit.m 的内容：

```
//when a pin is selected, do something
- (void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view {
    NSString *annotationTapFunctionString = [NSString stringWithFormat:@"%s%@%s", "annotationTap('", [view.annotation title], "')"];
    [self.webView stringByEvaluatingJavaScriptFromString:annotationTapFunctionString];
} 
```

当一个 pin 被点击时，它会以 pin 的标题作为参数调用 annotationTap javascript 函数。

# android - Launching an Activity with an Intent

> ID：14420167
> 
> 赞同：1
> 
> 时间：2013-01-19T23:47:21.727
> 
> 标签：android, android-intent, android-activity

I have the following in my AndroidManifest:

```
<activity android:name="IntentChild"
          android:label="@string/app_name">
    <intent-filter>
        <action android:name="android.intent.action.EDIT" />
        <category android:name="android.intent.category.DEFAULT" />
        <data android:mimeType="vnd.intent.cursor.item/intent_example"
              android:host="example.intent"
              android:path="intent_example"
              android:scheme="content"
        />
    </intent-filter>
</activity> 
```

I launch the activity with

```
Uri uri = new Uri.Builder().scheme("content").authority("example.intent").appendPath("intent_example").build(); 
Intent intent = new Intent(Intent.ACTION_EDIT, uri); 
IntentExample.this.startActivity(intent); 
```

But I get:

```
E/AndroidRuntime( 865): android.content.ActivityNotFoundException: No Activity found to handle Intent { act=android.intent.action.EDIT dat=content:// 
example.intent/intent_example }
```

What am I doing wrong? Also, does `Uri.Builder.authority()` refer to the same thing as the `android:host` attribute of the `<data>` tag in my manifest?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T19:14:46.110

在@A--C 的评论提示下，我最终添加了一个调用来`Intent.setType()`设置所需的 MIME 类型：

```
Uri uri = new Uri.Builder().scheme("content").authority("example.intent").appendPath("intent_example").build(); 
Intent intent = new Intent(Intent.ACTION_EDIT, uri); 
intent.setType("vnd.intent.cursor.item/intent_example");
IntentExample.this.startActivity(intent); 
```

为简单起见，我还修剪了 my`<intent-filter>`以仅声明`android:mimeType`. 我猜想，但不完全确定，这并不像之前的变化那么重要。

```
<activity android:name="IntentChild"
          android:label="@string/app_name">
    <intent-filter>
        <action android:name="android.intent.action.EDIT" />
        <category android:name="android.intent.category.DEFAULT" />
        <data android:mimeType="vnd.intent.cursor.item/intent_example"/>
    </intent-filter>
</activity> 
```

# c - Confusion passing string as an argument to C function

> ID：14420170
> 
> 赞同：2
> 
> 时间：2013-01-19T23:47:31.923
> 
> 标签：c

```
void convert(char *str){
  int i = 0;
  while (str[i]){
    if (isupper(str[i])){
      tolower(str[i]);
    }
    else if (islower(str[i])){
      toupper(str[i]);
    }
    i++;
  }
  printf(str);
} 
```

In the function, I tried to reverse the case of each of the letters in a string. I called the function like this:

```
convert(input); 
```

Where input is a type of char *. I got a segmentation fault error. What's wrong here?

Thank you!

**UPDATE:** My input is taken from argv[1].

```
 char *input;
  if (argc !=2){/* argc should be 2 for correct execution */
    /* We print argv[0] assuming it is the program name */
    printf("Please provide the string for conversion \n");
    exit(-1);
  }
  input = argv[1]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T23:50:30.863

The reason this does not work is that you are dropping the results of `toupper` and `tolower`. You need to assign the results back to the string passed into your function:

```
if (isupper(str[i])){
    str[i] = tolower(str[i]);
} else if (islower(str[i])){
    str[i] = toupper(str[i]);
} 
```

Note that in order for this to work the `str` must be *modifiable*, meaning that a call `convert("Hello, World!")` would be undefined behavior.

```
char str[] = "Hello, World!";
convert(str);
printf("%s\n", str); 
```

# javascript - Need help pulling in object value as jQuery selector

> ID：14420172
> 
> 赞同：1
> 
> 时间：2013-01-19T23:48:01.880
> 
> 标签：javascript, jquery, oop

I'm pretty new to OOP concepts in general, and I'm trying to build this mini-application for a client. The idea is that it's supposed to have configurable options based on the Module number, etc. I've cut out some code to keep relevant stuff. I'm trying to make this as customizable as possible, in particular--allowing the coder to support multiple Lightbox-style popups by adding them to the options array below.

Everything has worked great until this--my issue is that I'm trying to bind each object in the `options.popups` array with jQuery, by feeding `selector` as a string in through the config, directly into a `$()` selector.

This works fine for binding `click()` to the opener, but the `selector` property just won't bind. Every time, I get this error: `TypeError: self.options.popups[i] is undefined.` If I directly insert the selector, e.g. `$(".helpPopup").show();`, it works fine. If I define it in a variable within the `click()` function directly above it, it works. e.g. `var s = ".helpPopup";`

Is there some obvious thing that I'm missing here? This is driving me nuts. Also, my code's design pattern is directly based off of this: [https://github.com/shichuan/javascript-patterns/blob/master/jquery-plugin-patterns/prototypal-inheritance.html](https://github.com/shichuan/javascript-patterns/blob/master/jquery-plugin-patterns/prototypal-inheritance.html)

Thanks!

```
var MODULE = {
    init: function(options, elem) {
        // Stuff here

        this.bindPopups();
    },

    options: {
        title: "Module title",
        pages: 1,
        currentPage: 1,
        windowOpener: ".popupVar",
        popups: [
            { 
                name: "help", 
                selector: ".helpPopup", 
                opener: ".button.open", 
                closer: ".button.close",
                type: 3
            }
        ]
    },

    bindPopups: function() {
        var self = this;

        for(i = 0; i < this.options.popups.length; i++) {
            // Open the popup
            $(self.options.popups[i].opener).click(function(e) {
                e.preventDefault();
                $(self.options.popups[i].selector).show();
            });

            // Close the popup
            $(self.options.popups[i].closer).click(function(e) {
                e.preventDefault();
                $(self.options.popups[i].selector).hide();
            });
        }
    }
};

// If browser doesn't support Object.create
if(typeof Object.create !== "function") {
    Object.create = function(o) {
        function F() {
            F.prototype = o;
            return new F();
        }
    };
}

// Create plugin
$.plugin = function(name, object) {
    $.fn[name] = function(options) {
        return this.each(function() {
            if(!$.data(this, name)) {
                $.data(this, name, Object.create(object).init(options, this));
            }
        });
    };
};

$.plugin("module", MODULE);

/* PAGE CODE */
<script>
    $(function() {
        $("body").module({
            title: "Module 1",
            pages: 12,
            popups: [
                { 
                    name: "help", 
                    selector: ".helpPopup", 
                    opener: ".button.open", 
                    closer: ".button.close",
                    type: 3
                },
                {
                    name: "info",
                    selector: ".infoPopup",
                    opener: ".button.info",
                    closer: ".button.close",
                    type: 1
                }
            ]
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:36:36.687

出于某种原因，您`i`的 click 函数内部正在递增。为了验证，`console.log(i);`在点击事件函数之前放置一个，在打开的点击函数内部放置一个。

~~我不知道它为什么这样做（我没有看到任何明显的错误），但一个快速的技巧是`var j = i;`在你打开`for`循环后立即放置，并`j`用作你的索引选择器。~~

编辑：上面的 hack 只适用于一次迭代。“`i`似乎”在此处递增，因为直到`for`循环关闭后才对其进行评估，此时`i`已递增（对于单击事件）。例如，您可以通过在函数`i`内部登录来验证这一点。`setTimeout`

要获得 的适当值`i`，您必须将 click 事件函数包装在匿名函数中，如下所示：

```
$(self.options.popups[i].opener).click(
    (function (i) { 
        return function(e) {
            e.preventDefault();
            $(self.options.popups[i].selector).show();
        }
    })(i)
); 
```

了解更多信息

# php - Tidy to xhtml with parameters such as allowFullScreen

> ID：14420173
> 
> 赞同：0
> 
> 时间：2013-01-19T23:48:15.470
> 
> 标签：php, tidy, htmltidy

I'm parsing simple oembed urls from youtube, and converting them to xhtml, however, some html gets tidy'd (I believe to be) incorrectly. Shouldn't the valid xhtml be allowFullScreen="true"????? If this is correct, is there some tidy module that will do that? I must I go the "purifier" route?

**input from youtube:**

```
<iframe allowfullscreen ... ></iframe> 
```

**final output after tidy'ing:**

```
<iframe allowfullscreen="" ...></iframe> 
```

**PHP Tidy:**

```
$tidy                   =  new \tidy();
$config             =  array(
    'show-body-only'   => true,
    'char-encoding'    => 'utf8'
);
$output = $tidy -> repairString($data['html'], $config, 'UTF8'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:59:25.580

我不知道任何定义`allowfullscreen`属性的 XHTML 规范，这可以解释为什么 tidy 不将其识别为布尔属性。

如果它是一个布尔属性，那么`true`它就不是一个有效的值。名称和值将是相同的字符串。

# php - 用php自动创建缓存文件

> ID：14420176
> 
> 赞同：2
> 
> 时间：2013-01-19T23:48:26.463
> 
> 标签：php, performance, caching

我一直在基于[此链接在我的网站上使用基本缓存系统](http://www.snipe.net/2009/03/quick-and-dirty-php-caching/)

到目前为止，它对我想做的任何事情都很有效。

```
$cachefile = 'cache/'. basename($_SERVER['QUERY_STRING']) . '.html';
$cachetime = 1440 * 60; 

if (file_exists($cachefile) && (time() - $cachetime < filemtime($cachefile))) {
  include($cachefile);
  echo "<!-- Cached ".date('jS F Y H:i', filemtime($cachefile))." -->";
  exit;
}

ob_start();

// My html/php code here

$fp = fopen($cachefile, 'w'); // open the cache file for writing
fwrite($fp, ob_get_contents()); // save the contents of output buffer to the file
fclose($fp); // close
ob_end_flush(); // Send to browser 
```

但是我有几页有更详细的 mysql 查询，我花了相当多的时间优化它，但是当我在 mysql 中查询它时，它仍然需要大约 10 秒才能运行，甚至在网站上运行更长时间。有时，当我收到以下消息时，它似乎超时了。

```
The proxy server received an invalid response from an upstream server.
The proxy server could not handle the requestGET http://www.example.com

Reason: Error reading from remote server 
```

这不是一个大问题，因为我使用上面的缓存系统，只有当天第一个点击它的人会延迟，其余时间用户会获得缓存页面，所以对他们来说实际上速度很快.

我想让自己不必成为每天第一个访问该页面并自动执行此过程的人，因此每天 17:00（在服务器上）将文件写入缓存。

我将如何最好地实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T00:00:12.157

我建议您使用[Php Speedy](http://aciddrop.com/php-speedy/)或者这可能会有所帮助：

```
<?php
function getUrl () {
    if (!isset($_SERVER['REQUEST_URI'])) {
    $url = $_SERVER['REQUEST_URI'];
    } else {
    $url = $_SERVER['SCRIPT_NAME'];
    $url .= (!empty($_SERVER['QUERY_STRING']))? '?' . $_SERVER[ 'QUERY_STRING' ] : '';

    }
    return $url;
}

//getUrl gets the queried page with query string
function cache ($buffer) { //page's content is $buffer
    $url = getUrl();
    $filename = md5($url) . '.cache';
    $data = time() . '¦' . $buffer;
    $filew = fopen("cache/" . $filename, 'w');
    fwrite($filew, $data);
    fclose($filew);
    return $buffer;
}

function display () {
    $url = getUrl();
    $filename = md5($url) . '.cache';
    if (!file_exists("/cache/" . $filename)) {
    return false;
    }
    $filer = fopen("cache/" . $filename, 'r');
    $data = fread($filer, filesize("cache/" . $filename));
    fclose($filer);
    $content = explode('¦', $data, 2);
    if (count($content)!= 2 OR !is_numeric($content['0'])) {
        return false;
    }
    if (time()-(100) > $content['0']) { // 100 is the cache time here!!!
        return false;
    }
        echo $content['1'];
        die();
}

// Display cache (if any)
display();  // if it is displayed, die function will end the program here.

// if no cache, callback cache
ob_start ('cache');
?> 
```

只需将此脚本包含在您需要缓存的任何位置并设置一个 cron 作业以自动运行它。

# javascript - javascript中的静态成员

> ID：14420178
> 
> 赞同：0
> 
> 时间：2013-01-19T23:49:00.707
> 
> 标签：javascript

我正在尝试在 javascript 中模拟静态成员。

考虑这段代码：

```
 // option A for static members:

     // constructor...
  function Person(name) {

      this.firstName=name;        
  }

  Person.count=0;              //  like a static member...
  var p=new Person("Dan");
  Person.count++;

  alert(Person.count);   // 1; 
```

现在这个：

```
 //  option B for static members:
          // constructor..
  function Person(name) {

      this.firstName=name;
      Person.prototype.count++;     

  }

  Person.prototype.count=0;        //  like a static member...
  var p=new Person("Dan");
  alert(Person.prototype.count);   // 1;

  //       ... 
```

所以，说这两者之间的主要区别是真的吗，在第二个例子中你可以从构造函数中引用静态成员（由于**原型**声明），而在第一个例子中你不能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:52:08.633

在这两个示例中，您都可以从构造函数中获取它。不同之处在于您是否可以通过您的对象之一到达它。

**选项 A：**

```
function Person (name) {
    this.firstName = name;
    Person.count++;
}

Person.count = 0;
var p = new Person("Dan")

console.log(Person.count) // 1
console.log(p.count) // undefined 
```

**选项 B：**

```
function Person (name) {
    this.firstName=name;
    Person.prototype.count++;     
}

Person.prototype.count = 0;
var p = new Person("Dan");

console.log(Person.prototype.count) // 1
console.log(p.count) // 1 
```

# java - 无法取消引用浮点数 - 使用 BigDecimal

> ID：14420182
> 
> 赞同：1
> 
> 时间：2013-01-19T23:49:37.677
> 
> 标签：java, floating-point, bigdecimal, dereference

我在尝试编写一个计算贷款利息并以某些小数位显示信息的程序时遇到错误。我需要将loanInterest 显示为3.546%，或者类似的小数点后3 位。我能够`totalInterest`正确显示，但我不知道这是否是因为它是我刚刚建立的新值。当我尝试如下所示运行我的程序时，出现“无法取消引用浮点数”错误。

```
public class SarahShelmidineModule2Project {

public static void main(String[] args) {
    //Being programing for Module 2 project

    // Welcome the user to the program
    System.out.println("Welcome to the Interest Calculator");
    System.out.println();  // print a blank line

    // create a Scanner object named sc
    Scanner sc = new Scanner(System.in);

    // perform interest calculations until choice isn't equal to "y" or "Y"
    String choice = "y";
    while (choice.equalsIgnoreCase("y"))
    {
        // get info from user on loan amount and interest rates and store data
        System.out.print("Enter loan amount:   ");
        double loanAmount = sc.nextDouble();
        System.out.print("Enter interest rate:   ");
        float loanInterest = sc.nextFloat();

        // calculate the interest and convert to BigDecimal and rounding for totalInterest

       BigDecimal decimalloanAmount = new BigDecimal (Double.toString(loanAmount));
       BigDecimal decimalloanInterest = new BigDecimal (Double.toString(loanInterest));
       BigDecimal totalInterest = decimalloanAmount.multiply(decimalloanInterest);
       totalInterest = totalInterest.setScale(2, RoundingMode.HALF_UP);

       loanInterest = loanInterest.setScale(3, RoundingMode.HALF_UP);

        System.out.println();  // print a blank line

        // display the loan amount, loan interest rate, and interest
        // also format results to percent and currency
        NumberFormat currency = NumberFormat.getCurrencyInstance();
        NumberFormat percent = NumberFormat.getPercentInstance();

        String message =    "Loan amount: " + currency.format(loanAmount) + "\n"
                +           "Interest rate:  " + percent.format(loanInterest) + "\n"
                +           "Intrest:    " + currency.format(totalInterest) + "\n";
        System.out.println(message);

        // inquire if user would like to continue with application
        System.out.print("Continue? (y/n): ");
        choice = sc.next();
        System.out.println(); 
```

以下是我运行此程序时遇到的错误：

欢迎使用利息计算器

输入贷款金额：10932

输入利率：.0934

```
Exception in thread "main" java.lang.RuntimeException: Uncompilable
source code - Erroneous sym type: <any>     at
 sarahshelmidinemodule2project.SarahShelmidineModule2Project.main(SarahShelmidineModule2Project.java:45) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:05:43.980

只是改变

`float loanInterest = sc.nextFloat();`

和

`BigDecimal loanInterest = new BigDecimal(sc.nextFloat());`

并且您将解决“float cannot be derefenced”，因为 float 是原始类型并且没有 method `setScale`。

关于打印正确的小数位数，请使用以下内容：

```
 String currencySymbol = Currency.getInstance(Locale.getDefault()).getSymbol();
    System.out.printf("%s%8.5f\n", currencySymbol, totalInterest); 
```

此代码将使用 5 位小数，但请确保您的 BigDecimal 比例至少为 5，否则您将得到不重要的零。

# javascript - Two functions I dont understand using the FileReader

> ID：14420197
> 
> 赞同：1
> 
> 时间：2013-01-19T23:51:20.680
> 
> 标签：javascript, html

I have problems understanding how `(function(theFile) { return function(e) {` works.

What does thefile do and if `e` is returned how can it be used as `e.target.result`?

Also what does the `})(f);` do and why is it outside of the function.

```
// Check for the various File API support.
if (window.File && window.FileReader && window.FileList && window.Blob) {
    // Great success! All the File APIs are supported.
} else {
    alert('The File APIs are not fully supported in this browser.');
}

function handleFileSelect(evt) {
    var files = evt.target.files; // FileList object

    // Loop through the FileList and render image files as thumbnails.
    for (var i = 0, f; f = files[i]; i++) {
        // Only process image files.
        if (!f.type.match('image.*')) {
            continue;
        }

        var reader = new FileReader();

        // Closure to capture the file information.
        reader.onload = (function (theFile) {
            return function (e) {
                // Render thumbnail.
                var span = document.createElement('span');

                span.innerHTML = ['<img class="thumb" src="', e.target.result,
                    '" title="', escape(theFile.name), '" id="', escape(theFile.name), '" onclick="_Element=this.id, RefreshElement()" /><br>'].join('');

                document.getElementById('list').insertBefore(span, null);
            };
        })(f);

        // Read in the image file as a data URL.
        reader.readAsDataURL(f);
    }
}

document.getElementById('files').addEventListener('change', handleFileSelect, false); 
```

# php - 如何在文本输入中显示变量

> ID：14420198
> 
> 赞同：0
> 
> 时间：2013-01-19T23:51:24.023
> 
> 标签：php, javascript, jquery

在`QandATable.php`我有一个下面的表格，其中包含一个文件输入和一个 iframe：

```
var $fileVideo = $("<form action='videoupload.php' method='post' enctype='multipart/form-data' target='upload_target_video' onsubmit='return videoClickHandler(this);' class='videouploadform' >" + 
"Video File: <input name='fileVideo' type='file' class='fileVideo' /></label>" +  
"<input type='submit' name='submitVideoBtn' class='sbtnvideo' value='Upload' /></label>" + 
 "<p class='listVideo' align='left'></p>" +
"<iframe class='upload_target_video' name='upload_target_video' src='/' style='width:0px;height:0px;border:0px;solid;#fff;'></iframe></form>"); 
```

现在下面我有一个 jquery 代码，当文件完成上传时触发。

```
 function stopVideoUpload(success, videofilename){

      var result = '';
      videocounter++;

      if (success == 1){
         result = '<span class="videomsg'+videocounter+'">The file was uploaded successfully</span>';
          $('.listVideo').eq(window.lastUploadVideoIndex).append('<div>' + htmlEncode(videofilename));
      }

      return true;   
} 
```

现在文件上传的结果和文件名由下面的代码确定。但我的问题是如何`$id`在文本输入中显示变量？

```
 <script language="javascript" type="text/javascript">
 window.top.stopVideoUpload(<?php echo $result; ?>,'<?php echo $id . $_FILES['fileVideo']['name'] ?>');
 </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:20:13.763

我可能误解了您的问题，但是如果您在输入字段上更改`type='text'`为`type='hidden'`，则 $id 变量将位于隐藏输入中。

# android - 在消息处理程序中使用 AlertDialog

> ID：14420202
> 
> 赞同：0
> 
> 时间：2013-01-19T23:51:46.607
> 
> 标签：android, xmpp, handler, android-alertdialog, asmack

我正在开发一个 Xmpp 聊天应用程序。

在我的 PacketListener 中，我正在尝试处理订阅请求，除了 AlertDialog 之外，这一切都像一个魅力。它没有出现，所以我无法得到用户的确认。

我试过了 ，

*   `Toast.makeText()`
*   更改 UI（文本视图）
*   `getApplicationContext()`代替`Display.this`

但它们都不起作用。

正如我所说，我没有收到任何错误，我也尝试调试，它似乎在代码方面工作。

这是我的代码，

```
//imports....
public class Display extends Activity {
  //....more codes

    private void addListener() {

        //subscribe request handler
        Roster roster = conn.getRoster();
        roster.setSubscriptionMode(Roster.SubscriptionMode.manual);
        PacketListener packetListener = new PacketListener() {

            @Override
            public void processPacket(Packet packet) {}
        };

        conn.addPacketListener(packetListener, new PacketFilter(){
        @Override
        public boolean accept(Packet packet) {
            // TODO Auto-generated method stub
            final Presence presence = (Presence)packet;
            subscriptonAnswer = false;
            if(packet instanceof Presence) {
                if(((Presence)packet).getType().equals(Presence.Type.subscribe))  {
                    new AlertDialog.Builder(Display.this)
                        .setIcon(android.R.drawable.ic_dialog_alert)
                        .setTitle("Subscription Message")
                        .setMessage(StringUtils.parseName(packet.getFrom())+ " wants to add you, do you accept?")
                        .setPositiveButton("Yes", new DialogInterface.OnClickListener()
                    {
                        @Override
                        public void onClick(DialogInterface dialog, int which) {
                             Presence reply = new Presence(Presence.Type.subscribed);
                             reply.setTo(presence.getFrom());
                             conn.sendPacket(reply);
                        }

                    })
                    .setNegativeButton("No", null)
                    .show();
                }
            }
            return true;
        }});

    }

//....more codes
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:34:57.293

这是我第二次遇到同样的问题，但第一次的结构不同，所以第一次我无法弄清楚。

但是@Robin[的评论](https://stackoverflow.com/questions/14420202/using-alertdialog-in-message-handler#comment20112554_14420202)让我摆脱了问题。

正如他所说，我必须在 UI 线程上才能使用 UI 小部件，为了解决这个问题，我使用了[Handler](http://developer.android.com/reference/android/os/Handler.html)

```
 private Handler handler = new Handler() {
      @Override
      public void handleMessage(Message msg) {
          //I'm free to manage UI Widgets here
      }
  };

  //......
  // I have to just sendmessage here
  if(packet instanceof Presence) {
      if(((Presence)packet).getType().equals(Presence.Type.subscribe))  {
          handler.sendEmptyMessage(0);
      }
  }
  //...... 
```

# ruby-on-rails - The action 'show' could not be found for UsersController when logging out | devise rails

> ID：14420204
> 
> 赞同：4
> 
> 时间：2013-01-19T23:52:07.780
> 
> 标签：ruby-on-rails, devise, routes

I've been struggling with something very silly here for some hours. No claptrap straight to the point. When I paste this into my posts#index page view file:

```
 <p><%= link_to "log out", destroy_user_session_path, :method => :delete %></p> 
```

and click on it inside the browser, the user successfully signs out. However...

When I do this somewhere else like after the user has signed in or after the user has signed up, then the user tries to log out from a page which we can call users#index. It then only gives me this error upon clicking the log out button.

```
Unknown action

The action 'show' could not be found for UsersController 
```

I've tried quite a lot of things, jquery and the jquer.uls or something are included in the application.js file,

These are my routes, and I think they're right.

```
Proxima::Application.routes.draw do
  devise_for :users
  resources :users
  resources :dashboard
  resources :posts
  authenticated :user do
  root :to => 'dashboard#index'
end
  resources :welcome
  devise_for :users
  resources :users
  resources :dashboard
  resources :posts
  root :to => 'welcome#index'
end 
```

This is silly, I can't understand what's going on here, I get that silly message time after time and still no stuff happens. Then I decide to actually write down the action "show" inside the UsersController, however... When I write redirect_to welcome_path it doesn't log out, I check that by actually accessing the root url again... Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-25T16:40:12.203

如果使用 jQuery，您**需要在视图**中调用“用于 jQuery 的非侵入式脚本适配器”。

```
<%= javascript_include_tag "jquery_ujs" %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T10:06:27.487

我建议您研究一下为什么您的`:method => :delete`链接仍然以`show`操作结束（响应 GET 的操作）。

在 link_to 中正确设置 javascript`:method => :delete`应该可以正常工作，然后转到`#destroy`设计会话控制器中的方法。

您还可以在此处登录/注销后尝试更改默认重定向路径：[https ://github.com/plataformatec/devise/wiki/How-To:-Change-the-redirect-path-after-destroying-a-会话即退出](https://github.com/plataformatec/devise/wiki/How-To:-Change-the-redirect-path-after-destroying-a-session-i.e.-signing-out)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-23T05:29:01.870

如果您误删了

> //= 需要 jquery_ujs

在你的`application.js`

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-01-20T00:03:19.520

所以错误是：

```
Unknown action

The action 'show' could not be found for UsersController 
```

所以我进入控制器并定义了**显示**动作。然后我查看了一些 Devise 文档并注意到我使用了这个助手：`sign_out :user`. 这是临时修复：

```
 def show
    sign_out :user
    redirect_to welcome_path
end 
```

但是，这只会将用户注销并重定向到welcome_path，但随后我又遇到了另一个错误：

```
Unknown action

The action 'show' could not be found for WelcomeController 
```

所以我也为 Welcome 控制器定义了**show动作：**

```
class WelcomeController < ApplicationController
  def show
    render :index
  end
end 
```

这将用户重定向回根页面。瞧！然后我点击页面上的登录名和按钮，最后看到我被要求登录到页面。我已成功注销并将用户重定向回欢迎索引 URL。万岁！:D

然而，现在奇怪的部分来了。我不明白为什么会这样。因此，当我放置此代码时，从根 URL 开始：

```
 <p><%= link_to "log out", destroy_user_session_path, :method => :delete %></p> 
```

然后在我登录后单击它，它成功注销，而无需任何额外的写入控制器或类似的东西。非常顺利，不需要任何工作，但是当用户尝试从其他页面而不是 ROOT URL 注销时，它不起作用，并且我在**UsersController**上面收到此错误。

我不明白为什么注销请求要求在**UsersController**中进行显示操作。当它是销毁用户会话的 GET 请求时。我的意思是为什么我必须`sign:out :user`在控制器内部指定 DEVISE 应该处理的事情。请解释这种行为。

# ruby-on-rails - getting templates from public directory on Heroku

> ID：14420207
> 
> 赞同：1
> 
> 时间：2013-01-19T23:52:24.450
> 
> 标签：ruby-on-rails, heroku

I have a backbone app inside a Rails app working on local host that's not working on Heroku. It's giving me the usual "Sorry but something went wrong" message, although the rest of the Rails app works fine on Heroku. It's just this page specific backbone stuff. The error's getting thrown when it's trying to render the main view.

```
Started GET "/employeedirectory" for 207.230.251.130 at 2013-01-19 23:34:21 +0000
2013-01-19T23:34:21+00:00 app[web.1]: Completed 500 Internal Server Error in 3ms 
```

The database is working and seeded on Heroku. Indeed, the error's getting thrown even before there's a query. I'm guessing it might be how the template system is set up. The index.html.erb page is essentially empty except for a few divs, into which the templates are inserted. The app uses this utility template loader (see code below) to load those templates. On local host, the templates referred to in `get('templates/...)` are taken from the Rails public folder but the util.js file itself is located in the /assets/javascripts directory, which then gets copied to the public folder after precompile. I pushed it to Heroku with the same structure it uses on Heroku, although after the assets:precompile things might get changed around, and I'm not sure if that `get('templates` can still retrieve those templates.

This is the public directory structure after `assets:precompile`. the templates are sitting next to the assets folder.

![enter image description here](../Images/68e7612fbb0472b86fee81af25e2d49e.png)

Utils.js file that loads the templates

```
window.templateLoader = {

    load: function(views, callback) {

        var deferreds = [];

        $.each(views, function(index, view) {
            if (window[view]) {
                deferreds.push($.get('templates/' + view + '.html', function(data) {
                    window[view].prototype.template = _.template(data);
                }, 'html'));
            } else {
                alert(view + " not found");
            }
        });

        $.when.apply(null, deferreds).done(callback);
    }

}; 
```

The template loader loads the templates before the Backbone app is initialized like this

```
templateLoader.load(["HomeView", "ContactView", "HeaderView", "EmployeeView", "EmployeeSummaryView", "EmployeeListItemView"],
    function () {
        app = new Router();
        Backbone.history.start();
    }); 
```

so, to summarize, where in the Rails directory if not the public/templates folder, should i put the templates that are retrieved by the get function in this code so that they can be retrieved on Heroku

```
 $.each(views, function(index, view) {
                if (window[view]) {
                    deferreds.push($.get('templates/' + view + '.html', function(data) {
                        window[view].prototype.template = _.template(data);
                    }, 'html'));
                } else {
                    alert(view + " not found");
                }
            }); 
```

If the templating isn't the problem, does anyone have any other ideas where I might look?

# c++ - 重载 *, +, -'向量的运算符 班级

> ID：14420209
> 
> 赞同：4
> 
> 时间：2013-01-19T23:52:48.710
> 
> 标签：c++, class, operator-overloading, stdvector

我正在编写一个 Line 类来创建数值方法，并且我希望这些运算符（*、+、-）使我的代码更具可读性和更易于理解。

```
 #include <vector>

        using namespace std;

        typedef vector<double> Vector;

        class Line : public Vector
        {
        public:
            Line();
            ~Line();

            Line operator+(Line);
            Line operator-(Line);
            Line operator*(double);
        };

        Line Line::operator*(double alfa)
        {
            Line temp;
            int n = size();
            temp.resize(n);
            for (int i = 0; i < n; i++)
            {
                temp.at(i) = this->at(i)*alfa;
            }
            return temp;
        }

        Line Line::operator+(Line line)
        {
            int n = size();
            Line temp;
            temp.resize(n);
            for (int i = 0; i < n; i++)
            {
                temp.at(i) = this->at(i) + line[i];
            }
            return temp;
        }

        Line Line::operator-(Line line)
        {
            int n = size();
            Line temp;
            temp.resize(n);
            for (int i = 0; i < n; i++)
            {
                temp.at(i) = this->at(i) - line[i];
            }
            return temp;
        }

        int main()
        {
            return 0;
        } 
```

是否可以从 Vector 类中重载此类运算符？我应该只制作函数（或方法）而不是运算符吗？还有其他建议吗？

ps1：我使用 Visual Studio 11 作为编译器。

ps2：我没有将项目启动为“win32项目”，它是控制台应用程序。

我收到以下错误：

```
Error   1   error LNK2019: unresolved external symbol "public: __thiscall Line::Line(void)" (??0Line@@QAE@XZ) referenced in function "public: class Line __thiscall Line::operator*(double)" (??DLine@@QAE?AV0@N@Z) C:\Users\Lucas\Documents\Visual Studio 11\Projects\test\test\test.obj   test

Error   2   error LNK2019: unresolved external symbol "public: __thiscall Line::~Line(void)" (??1Line@@QAE@XZ) referenced in function "public: class Line __thiscall Line::operator*(double)" (??DLine@@QAE?AV0@N@Z)    C:\Users\Lucas\Documents\Visual Studio 11\Projects\test\test\test.obj   test 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T00:00:55.540

您必须在全局范围内重载运算符：

```
vector<double> operator*(const vector<double>& v, double alfa)
{
    ...
}

vector<double> operator+(const vector<double>& v1, const vector<double>& v2)
{
    ...
}

vector<double> operator-(const vector<double>& v1, const vector<double>& v2)
{
    ...
} 
```

至于链接器错误，看起来您没有实现 Line 构造函数和析构函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T23:58:38.143

您永远不应该从不`std`用于继承的 -classes 继承。从没有虚拟析构函数的类继承是非常危险的。

我建议你使用聚合：让你的`Line`类包含一个`vector`类型的成员，例如命名`myVector_`，并以他们使用这个成员变量的方式实现所需的运算符。

`size()`所以你替换所有对等的调用`myVector.size()`：

```
Line Line::operator*(double alfa)
{
    Vector temp;
    int n = myVector_.size();
    temp.resize(n);
    for (int i = 0; i < n; i++)
    {
        temp.at(i) = myVector_.at(i)*alfa;
    }
    return temp;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T23:57:43.003

链接器错误告诉您您的代码缺少您声明的两个成员函数的定义 - 构造函数和析构函数：

```
Line::Line() {
    // Code of the constructor goes here
}

Line::~Line() {
    // Code of the destructor goes here
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T23:59:58.363

当然正确的做法是在行内有一个 Vector 对象，而不是从 Vector 中“继承”？通常从容器继承`std::`并不是一个很好的数据......我很确定“线”实际上不是一个向量，它是一个“有一个”向量。[“当你继承”的规则是“X 是一个 Y”，当“X 有一个 Y”时，你会创建一个复合对象——所以 X 里面有一个 Y。]

您需要声明构造函数和析构函数以消除链接错误。

我也将`const Line&`用作数学运算的输入，因为您永远不会更改输入。

# java - 0-1 多维背包

> ID：14420211
> 
> 赞同：4
> 
> 时间：2013-01-19T23:52:53.220
> 
> 标签：java, algorithm, multidimensional-array, knapsack-problem

因此，我正在尝试生成一种算法，该算法将找到 n 个项目（在我的情况下为 4）的最佳组合，这些项目只能放置在背包中一次（0-1）且具有最大重量。总结起来可能更有效，我想在我的背包中放置不超过四个独特的物品，以便它们的重量小于某个值 W，同时最大化它们的总价值。我的第一次尝试和假设是为多维背包问题设置 4 的体积限制，所有物品的体积都为 1。但我遇到了它不是 0-1 的问题（意思是在袋子里或不在袋子里）。然后我尝试制作一个多维的 0-1（有界）背包代码，但我无法添加体积限制以及 0-1 要求。如何编写 0-1 多维背包问题？或者我如何调整代码以仅保存所有项目卷为 1 的 V 卷？代码不必是Java，但这就是我到目前为止所拥有的。

背包：

```
package hu.pj.alg;

import hu.pj.obj.Item;
import java.util.*;

public class ZeroOneKnapsack {

    protected List<Item> itemList  = new ArrayList<Item>();
    protected int maxWeight        = 0;
    protected int solutionWeight   = 0;
    protected int profit           = 0;
    protected boolean calculated   = false;

    public ZeroOneKnapsack() {}

    public ZeroOneKnapsack(int _maxWeight) {
        setMaxWeight(_maxWeight);
    }

    public ZeroOneKnapsack(List<Item> _itemList) {
        setItemList(_itemList);
    }

    public ZeroOneKnapsack(List<Item> _itemList, int _maxWeight) {
        setItemList(_itemList);
        setMaxWeight(_maxWeight);
    }

    // calculte the solution of 0-1 knapsack problem with dynamic method:
    public List<Item> calcSolution() {
        int n = itemList.size();

        setInitialStateForCalculation();
        if (n > 0  &&  maxWeight > 0) {
            List< List<Integer> > c = new ArrayList< List<Integer> >();
            List<Integer> curr = new ArrayList<Integer>();

            c.add(curr);
            for (int j = 0; j <= maxWeight; j++)
                curr.add(0);
            for (int i = 1; i <= n; i++) {
                List<Integer> prev = curr;
                c.add(curr = new ArrayList<Integer>());
                for (int j = 0; j <= maxWeight; j++) {
                    if (j > 0) {
                        int wH = itemList.get(i-1).getWeight();
                        curr.add(
                            (wH > j)
                            ?
                            prev.get(j)
                            :
                            Math.max(
                                prev.get(j),
                                itemList.get(i-1).getValue() + prev.get(j-wH)
                            )
                        );
                    } else {
                        curr.add(0);
                    }
                } // for (j...)
            } // for (i...)
            profit = curr.get(maxWeight);

            for (int i = n, j = maxWeight; i > 0  &&  j >= 0; i--) {
                int tempI   = c.get(i).get(j);
                int tempI_1 = c.get(i-1).get(j);
                if (
                    (i == 0  &&  tempI > 0)
                    ||
                    (i > 0  &&  tempI != tempI_1)
                )
                {
                    Item iH = itemList.get(i-1);
                    int  wH = iH.getWeight();
                    iH.setInKnapsack(1);
                    j -= wH;
                    solutionWeight += wH;
                }
            } // for()
            calculated = true;
        } // if()
        return itemList;
    }

    // add an item to the item list
    public void add(String name, int weight, int value) {
        if (name.equals(""))
            name = "" + (itemList.size() + 1);
        itemList.add(new Item(name, weight, value));
        setInitialStateForCalculation();
    }

    // add an item to the item list
    public void add(int weight, int value) {
        add("", weight, value); // the name will be "itemList.size() + 1"!
    }

    // remove an item from the item list
    public void remove(String name) {
        for (Iterator<Item> it = itemList.iterator(); it.hasNext(); ) {
            if (name.equals(it.next().getName())) {
                it.remove();
            }
        }
        setInitialStateForCalculation();
    }

    // remove all items from the item list
    public void removeAllItems() {
        itemList.clear();
        setInitialStateForCalculation();
    }

    public int getProfit() {
        if (!calculated)
            calcSolution();
        return profit;
    }

    public int getSolutionWeight() {return solutionWeight;}
    public boolean isCalculated() {return calculated;}
    public int getMaxWeight() {return maxWeight;}

    public void setMaxWeight(int _maxWeight) {
        maxWeight = Math.max(_maxWeight, 0);
    }

    public void setItemList(List<Item> _itemList) {
        if (_itemList != null) {
            itemList = _itemList;
            for (Item item : _itemList) {
                item.checkMembers();
            }
        }
    }

    // set the member with name "inKnapsack" by all items:
    private void setInKnapsackByAll(int inKnapsack) {
        for (Item item : itemList)
            if (inKnapsack > 0)
                item.setInKnapsack(1);
            else
                item.setInKnapsack(0);
    }

    // set the data members of class in the state of starting the calculation:
    protected void setInitialStateForCalculation() {
        setInKnapsackByAll(0);
        calculated     = false;
        profit         = 0;
        solutionWeight = 0;
    }

} // class 
```

和项目：

```
package hu.pj.obj;

public class Item {

    protected String name    = "";
    protected int weight     = 0;
    protected int value      = 0;
    protected int bounding   = 1; // the maximal limit of item's pieces
    protected int inKnapsack = 0; // the pieces of item in solution

    public Item() {}

    public Item(Item item) {
        setName(item.name);
        setWeight(item.weight);
        setValue(item.value);
        setBounding(item.bounding);
    }

    public Item(int _weight, int _value) {
        setWeight(_weight);
        setValue(_value);
    }

    public Item(int _weight, int _value, int _bounding) {
        setWeight(_weight);
        setValue(_value);
        setBounding(_bounding);
    }

    public Item(String _name, int _weight, int _value) {
        setName(_name);
        setWeight(_weight);
        setValue(_value);
    }

    public Item(String _name, int _weight, int _value, int _bounding) {
        setName(_name);
        setWeight(_weight);
        setValue(_value);
        setBounding(_bounding);
    }

    public void setName(String _name) {name = _name;}
    public void setWeight(int _weight) {weight = Math.max(_weight, 0);}
    public void setValue(int _value) {value = Math.max(_value, 0);}

    public void setInKnapsack(int _inKnapsack) {
        inKnapsack = Math.min(getBounding(), Math.max(_inKnapsack, 0));
    }

    public void setBounding(int _bounding) {
        bounding = Math.max(_bounding, 0);
        if (bounding == 0)
            inKnapsack = 0;
    }

    public void checkMembers() {
        setWeight(weight);
        setValue(value);
        setBounding(bounding);
        setInKnapsack(inKnapsack);
    }

    public String getName() {return name;}
    public int getWeight() {return weight;}
    public int getValue() {return value;}
    public int getInKnapsack() {return inKnapsack;}
    public int getBounding() {return bounding;}

} // class 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T00:43:12.010

这是解决具有 2 个维度（大小和体积）的背包 0-1 问题的通用实现。我使用矩阵而不是列表列表，因为它更容易。这是整个类以及测试它的主要方法。
要添加维度，只需向矩阵添加新维度并添加内部循环以检查所有条件。

```
public class MultidimensionalKnapsack {

    /** The size of the knapsack */
    private static int size;
    /** The volume of the knapsack */
    private static int vol;

    private static class Item {
        public int value;
        public int size;
        public int volume;
        public Item(int v, int w, int vol) {
            value = v;
            size = w;
            volume = vol;
        }
    }

    // Knapsack 0/1 without repetition
    // Row: problem having only the first i items
    // Col: problem having a knapsack of size j
    // Third dimension: problem having a knapsack of volume h
    private static int[][][] dynNoRep;

    private static void noRep(Item[] items) {
        dynNoRep = new int[items.length + 1][size + 1][vol + 1];
        for(int j = 0; j <= size; j++) {
            dynNoRep[0][j][0] = 0;
        }
        for(int i = 0; i <= vol; i++) {
            dynNoRep[0][0][i] = 0;
        }
        for(int i = 0; i <= items.length; i++) {
            dynNoRep[i][0][0] = 0;
        }
        for(int i = 1; i <= items.length; i++)
            for(int j = 0; j <= size; j++) {
                for(int h = 0; h <= vol; h++) {
                    if(items[i - 1].size > j)
                        // If the item i is too big, I  can't put it and the solution is the same of the problem with i - 1 items
                        dynNoRep[i][j][h] = dynNoRep[i - 1][j][h];  
                else {
                    if(items[i - 1].volume > h)
                        // If the item i is too voluminous, I can't put it and the solution is the same of the problem with i - 1 items
                        dynNoRep[i][j][h] = dynNoRep[i - 1][j][h];
                    else {
                        // The item i could be useless and the solution is the same of the problem with i - 1 items, or it could be 
                        // useful and the solution is "(solution of knapsack of size j - item[i].size and volume h - item[i].volume) + item[i].value" 
                        dynNoRep[i][j][h] = Math.max(dynNoRep[i - 1][j][h], dynNoRep[i - 1][j - items[i - 1].size][h - items[i - 1].volume] + items[i - 1].value);
                    }
                }
            }
        }
    }

    public static void main(String[] args) {
        size = 15;
        vol = 12;
        Item[] items = {new Item(2, 4, 1), new Item(1, 5, 4), new Item(6, 3, 9), 
            new Item(3, 3, 19), new Item(7, 2, 7), new Item(1, 2, 6), new Item(2, 1, 2),
            new Item(10, 9, 12), new Item(9, 10, 2), new Item(24, 23, 11)};
        System.out.print("We have the following " + items.length + " items (value, size, volume): ");
        for(int i = 0; i < items.length; i++)
            System.out.print("(" + items[i].value + ", " + items[i].size + ", " + items[i].volume + ") ");
        System.out.println();
        System.out.println("And a knapsack of size " + size + " and volume " + vol);

        noRep(items);
        System.out.println();
        // Print the solution
        int j = size, h = vol, finalSize = 0, finalValue = 0, finalVolume = 0;
        System.out.print("Items picked (value, size, volume) for 0/1 problems without repetitions: ");
        for(int i = items.length; i > 0; i--) {
            if(dynNoRep[i][j][h] != dynNoRep[i - 1][j][h]) {
                System.out.print("(" + items[i - 1].value + ", " + items[i - 1].size + ", " + items[i - 1].volume + ") ");
                finalSize += items[i - 1].size;
                finalValue += items[i - 1].value;
                finalVolume += items[i - 1].volume;
                j -= items[i - 1].size;
                h -= items[i - 1].volume;
            }
        }
        System.out.println();
        System.out.println(" Final size: " + finalSize);
        System.out.println(" Final volume: " + finalVolume);
        System.out.println(" Final value: " + finalValue);
    } 
```

}

# php - jQuery - 使用 return false 后查询不会停止

> ID：14420214
> 
> 赞同：0
> 
> 时间：2013-01-19T23:54:11.783
> 
> 标签：php, jquery, html

我遇到了问题...当用户单击提交时-显示错误消息，但 jQuery 似乎并没有在 Return False 上停止；

请参见下面的代码：

```
 function validateSubmit(){
   // this will loop through each row in table
   // Make sure to include jquery.js
   $('tr').each( function() {
      // Find first input
      var input1 = $(this).find('input').eq(0);
      var qty1 = input1.val();
      // Find Second input
      var input2 = $(this).find('input').eq(1);
      var qty2 = input2.val();
      // Find third input
      var input3 = $(this).find('input').eq(2);
      var qty3 = input3.val();
      // Find select box
      var selectBx = $(this).find('select');
      var selectVal = selectBx.val();
        if(qty1 === '' && selectVal != 'Please Select...') {
            alert("You've chosen an option, but not entered a quantity to dispute, please check your inputs.");
            return false;           
        }
        if(qty1 != '' && selectVal === 'Please Select...') {
            alert("You've entered a quantity, but not chosen why, please check your reasons.");
            return false;           
        }
        if (qty1 > qty2) {
            alert("For one of your entries, the disputed quantity is larger than the shipped quantity.");
            return false;           
        }
   });   
} 
```

调用它的 HTML

```
<table>
                <thead>
                    <tr><th>Item ID</th><th>Description</th><th>Dispute Quantity</th><th>Shipped Quantity</th><th>Ordered Quantity</th><th>Reason</th></tr>
                </thead>
                <tbody>
                    <?php
                        $data = mysql_query("SELECT * FROM `artran09` WHERE `invno` = '$invoiceno'") or die(mysql_error());
                        echo "<center>";
                        $i = -1;        
                        echo "<form action=\"submitdispute.php?invno=".$invoiceno."&ordate=".$placed."\" method=\"POST\" onsubmit=\"return validateSubmit();\">";

                            while ($info = mysql_fetch_array($data)) {              
                                $i += 1;                                    
                                echo "<tr>"; 
                                echo "<td>".$info['item']."</td>"; 
                                echo "<td>".$info['descrip']."</td>";       

                                echo "<td><input type=\"text\" input name=".$i." onKeyPress=\"return numbersonly(this, event)\"  maxLength=\"3\"></td>"; 

                                echo "<td><input type=\"text\" value=".$info['qtyshp']." name = \"ship$i\" onKeyPress=\"return numbersonly(this, event)\" maxLength=\"3\" disabled=\"disabled\"></td>"; 

                                echo "<td><input type=\"text\" value=".$info['qtyord']." onKeyPress=\"return numbersonly(this, event)\" maxLength=\"3\" disabled=\"disabled\"></td>"; 

                                echo "<td><select name = \"reason$i\">";
                                echo "<option>Please Select...</option>";
                                echo "<option>Short/Not received</option>";
                                echo "<option>Damaged Goods</option>";
                                echo "<option>Product Not Ordered</option>";                    
                                echo "</select></td>";

                                echo "</tr>"; 
                            }

                    ?>
                </tbody>
            </table>
        </div>
    </div>
    <p><input type = "submit" value = "Dispute" name ="Submit">
    </form> 
```

有任何想法吗？？非常感谢帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:12:29.127

当前的返回将离开each()，而不是`validateSubmit()`（validateSubmit 目前不返回任何东西）

在 validateSubmit() 的开头定义一个变量，例如

```
var r=true;//default returnValue 
```

并将其放在 validateSubmit() 的末尾：

```
return r; 
```

现在，当您想离开 validateSubmit() 时，请在每个内部调用：

```
r=false;return; 
```

这将留下`each()`和`validateSubmit()`返回值`r`（现在将是什么`false`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T23:57:34.727

向您的代码添加[preventDefault调用。](http://api.jquery.com/event.preventDefault/)换行：

```
function validateSubmit(){ 
```

到以下

```
function validateSubmit(e){
    e.preventDefault();
    ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T00:07:15.850

确保您的按钮也使用 'return' 来返回返回值：

```
 <input type="submit" onClick="return validateSumbit();" /> 
```

此外，您应该从表单标签中删除 onsubmit 处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T00:19:16.080

您的`validateSubmit()`函数似乎没有返回值。只有`each()`方法的回调函数返回一个值，但您的实际提交处理程序没有。本质上，您的验证代码按预期运行，显示错误消息但不返回任何值以指示失败。

`validateSubmit()`您应该在`each()`方法可以修改和返回的范围内定义一个变量。

例如：

```
 function validateSubmit() {
     var form_is_valid = true;

     $('tr').each( function() {
         // Validation goes here
         if (something_is_invalid) {
             form_is_valid = false;
             return;
         }
     });

     return form_is_valid;
 } 
```

# symfony - FOS 用户包。如何在“记住我”登录时重定向？

> ID：14420216
> 
> 赞同：3
> 
> 时间：2013-01-19T23:54:20.870
> 
> 标签：symfony, fosuserbundle

我想根据某些条件在登录时重定向（包括“记住我”）。

我已经实现了[AuthenticationSuccessHandlerInterface](http://api.symfony.com/2.0/Symfony/Component/Security/Http/Authentication/AuthenticationSuccessHandlerInterface.html)服务。

这对于交互式登录非常有效，但不会在“记住我”登录时触发。

我还尝试了内核 security.interactive_login 事件，该事件在“记住我”时触发，但似乎无法从那里重定向。

我认为 FOSUserBundle SECURITY_IMPLICIT_LOGIN 事件可能会这样做，但不幸的是没有。它不会在“记住我”时触发。

还有其他选择吗？

谢谢

# c++ - 未解决的重载函数类型——C++中的数组下标重载

> ID：14420218
> 
> 赞同：3
> 
> 时间：2013-01-19T23:54:26.557
> 
> 标签：c++, operators

所以我有一个看起来有点像这样的向量类（为了清楚起见，大部分方法都被去掉了）：

```
class D3Vector {
  private:
    double _values[3];
  public:
    const double& operator[](const int index) const;
    double& operator[](const int index);
};

double& D3Vector::operator[](const int index) {
  assert(index >= 0 && index < 3);
  return _values[index];
}

const double& D3Vector::operator[](const int index) const {
  assert(index >= 0 && index < 3);
  return _values[index];
} 
```

在我的代码中，我将这个数组下标重载称为如下：

```
void func(D3Vector centre, double radius) {
  double limits[6];
  int i;
  for (i = 0; i < 3; i++) {
    // both these lines cause the error...
    limits[i] = centre[i] - radius;
    limits[i + 3] = centre[i] + radius;
  }
  ...
} 
```

但我在编译时收到此错误：

```
error: invalid types '<unresolved overloaded function type>[int]' for array subscript 
```

现在，我已经摆弄了重载函数的签名，添加和删除引用符号，添加和删除 const，但我真的只是在这里猜测。

为像这样的实数向量类编写数组下标运算符重载的明智方法是什么，它允许我们执行简单的操作，例如：

```
instance[i] = 5.7; 
```

和

```
new_value = instance[j] + 17.3; 
```

?

**编辑**：完整的类规范，根据要求：

```
class D3Vector {
  private:
    double _values[3];
  public:
    // constructors - no args inits to 0.0
    D3Vector();
    D3Vector(const double x, const double y, const double z);

    // binary + and -:
    D3Vector operator+(const D3Vector& right);
    D3Vector operator-(const D3Vector& right);

    // unary -, reverses sign of components:
    D3Vector operator-();

    // binary *, scales components.
    D3Vector operator*(const double scale);

    // the same, as self-assignment operations:
    D3Vector& operator+=(const D3Vector& right);
    D3Vector& operator-=(const D3Vector& right);
    D3Vector& operator*=(const double scale);

    // subscript operator, for member data access.
    const double& operator[](const int index) const;
    double& operator[](const int index);

    // dot product:
    double dot(D3Vector& right);

    // cross product:
    D3Vector cross(D3Vector& right);

    // shortcut to vector length:
    double mod();

    // faster way of getting length squared:
    double mod_squared();
}; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-20T09:50:56.623

`[]`正如评论者指出的那样，当您尝试使用括号而不是圆括号调用函数时，会弹出此错误`()`。这正是这里发生的事情，并不明显，因为我简化了代码示例。

在问题中，我发布并调用了示例函数`func`- 这实际上是继承类的构造函数（因此，我简化了而不是发布*所有代码。）*

基类包含我们需要知道的所有内容：

```
class D3Shape {
  protected:
    double l[6];
    virtual void initilise_limits() = 0;
  public:
    virtual bool contains(D3Vector point) = 0;
    vector<double> limits();
}; 
```

即我很困惑，存储我正在寻找`l`的私有成员变量，以及用于在容器中检索它们的函数。这很复杂，因为我（成功地）在同一行上使用了我真正的数组下标重载类，这让我感到困惑！文件上的编译器错误“列号”实际上指向*之后*的第一个字符，进一步搅浑水。`double[6]``limits()``std::vector<double>`*`=`*

 *非常感谢所有评论的人。*

# python - 通过发布表格从网站收集数据

> ID：14420221
> 
> 赞同：-2
> 
> 时间：2013-01-19T23:54:40.283
> 
> 标签：python, post, httpwebrequest, urllib

我正在尝试使用 python 从某些网页中收集一些数据（它们没有 API）。我以前从来没有这样做过。

我认为它的 ASP.NET（我对此知之甚少）或一些他们正在使用的带有表单助手的库，这使得仅通过使用 urllib 发送相同的 postdata 来“手动”重新创建请求变得非常复杂。他们期望有各种奇怪的对人类不友好的后期数据——天知道他们的意思（以及开发人员）。

但是，我尝试删除这些并仅保留基本数据，但这会破坏请求。例如，当我在分页中更改页面时，某种“hash-ish”字符串也会发生变化（没有简单的 page=x 查询字符串就足够了）。

因此，花费数小时试图弄清楚一切是如何运作的，我认为这里有一些图书馆可以帮助我。有了一个像浏览器这样的界面，我可以开始给它一个 url 并说出要填写的表格，转到哪些链接，它会自动处理 cookie、隐藏的输入等，然后给我 html 输出。

我希望你明白我在找什么。也许它不存在，但我觉得它会很有用，所以它应该存在。

解决此问题的其他方法也很有帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:35:44.470

你应该试试 Scrapy。

[Python 3 - 使用 Scrapy 抓取网页](http://www.youtube.com/watch?v=1EFnX1UkXVU "Python 3 - 使用 Scrapy 抓取网页")

[scrapy.org](http://scrapy.org)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T02:14:41.273

如果您需要类似浏览器的行为，请查看[Selenium WebDriver](http://seleniumhq.org/docs/03_webdriver.jsp)或[ghost.py 类似的项目。](http://jeanphix.me/Ghost.py/)

# redirect - 在 Go 中查询没有重定向的 URL

> ID：14420222
> 
> 赞同：10
> 
> 时间：2013-01-19T23:55:02.030
> 
> 标签：redirect, go

我正在为重定向脚本编写基准测试。

我希望我的程序查询重定向到 AppStore 的某些 URL。但我不想下载 AppStore 页面。我只想记录重定向 URL 或错误。

如何在没有第二次重定向查询的情况下告诉 Go 查询 URL？

* * *

**更新**

两个答案都是正确的，但是：

我尝试了两种解决方案。我正在做基准测试。我使用 10 - 500 个 go 例程运行 1 个或多个 go 进程。他们循环查询 URL。我的服务器也是用 go 写的。它每秒报告请求数。

*   第一个解决方案：`http.DefaultTransport.RoundTrip`- 工作缓慢，给出错误。前 4 秒工作正常。进行 300-500 次查询然后性能下降到每秒 80 次查询。

然后下降到每秒 0-5 次查询，并且 queryies 脚本开始出现错误，例如

```
dial tcp IP:80: A connection attempt failed because the connected 
party did not properly respond after a period of time, or established 
connection failed because connected host has failed to respond. 
```

我猜它重用已关闭的连接。

*   第二种解决方案：`CheckRedirect field`以恒定的性能工作。我不确定它是重复使用连接还是为每个请求打开一个新连接。我`client`为循环中的每个请求创建。这就是它在现实生活中的行为方式（每个请求都是一个新连接）。有没有办法确保在每次查询后关闭连接并且不重复使用？

这就是为什么我要标记第二个解决方案来回答我的问题。但是对于我的研究来说，每个查询都是一个新的连接是非常重要的。我如何确保使用第二种解决方案？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-20T00:46:52.680

您需要使用 http.Transport 而不是 http.Client。传输是较低级别的，不遵循重定向。

```
req, err := http.NewRequest("GET", "http://example.com/redirectToAppStore", nil)
// ...
resp, err := http.DefaultTransport.RoundTrip(req) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-20T17:01:53.577

为了完整起见，您*可以*使用`http.Client`而不遵循重定向。`http.Client`有一个[`CheckRedirect`字段](http://golang.org/pkg/net/http/#Client)，它是一个函数。在进行任何重定向之前调用它。

*如果*此函数返回错误，则`httpClient.Do(...)`不会遵循重定向（请参阅[Go 源代码中的函数](http://golang.org/src/pkg/net/http/client.go?s=708:1583#L203)），而是会返回错误（其具体类型为，其字段将是重定向到 URL，也就是 Location 标头值，[请参阅此代码](http://golang.org/src/pkg/net/http/client.go?s=708:1583#L276)）。*[`doFollowingRedirects()`](http://golang.org/src/pkg/net/http/client.go?s=708:1583#L203)`url.Error``URL`*

 *您可以查看我的[gocrawl 库](https://github.com/PuerkitoBio/gocrawl/blob/master/ext.go#L120)以获取此用法的具体示例。*

# c# - 为什么在 Parallel.ForEach 中每个线程多次调用 localInit Func

> ID：14420227
> 
> 赞同：8
> 
> 时间：2013-01-19T23:55:22.583
> 
> 标签：c#, .net, task-parallel-library, .net-4.5

我正在编写一些代码来处理大量数据，并且我认为让 Parallel.ForEach 为它创建的每个线程创建一个文件会很有用，因此输出不需要同步（至少由我同步）。

它看起来像这样：

```
Parallel.ForEach(vals,
    new ParallelOptions { MaxDegreeOfParallelism = 8 },
    ()=>GetWriter(), // returns a new BinaryWriter backed by a file with a guid name
    (item, state, writer)=>
    {
        if(something)
        {
            state.Break();
            return writer;
        }
        List<Result> results = new List<Result>();

        foreach(var subItem in item.SubItems)
            results.Add(ProcessItem(subItem));

        if(results.Count > 0)
        {
            foreach(var result in results)
                result.Write(writer);
        }
        return writer;
    },
    (writer)=>writer.Dispose()); 
```

我期望发生的是最多 8 个文件将被创建，并会在整个运行时持续存在。然后，当整个 ForEach 调用完成时，每个都将被处置。真正发生的是 localInit 似乎为每个项目调用一次，所以我最终得到了数百个文件。在处理的每个项目结束时，作者也会得到处置。

这表明发生了同样的事情：

```
var vals = Enumerable.Range(0, 10000000).ToArray();
        long sum = 0;
        Parallel.ForEach(vals,
            new ParallelOptions { MaxDegreeOfParallelism = 8 },
            () => { Console.WriteLine("init " + Thread.CurrentThread.ManagedThreadId); return 0L; },
            (i, state, common) =>
            {
                Thread.Sleep(10);
                return common + i;
            },
                (common) => Interlocked.Add(ref sum, common)); 
```

我懂了：

```
init 10
init 14
init 11
init 13
init 12
init 14
init 11
init 12
init 13
init 11
... // hundreds of lines over < 30 seconds
init 14
init 11
init 18
init 17
init 10
init 11
init 14
init 11
init 14
init 11
init 18 
```

注意：如果我省略 Thread.Sleep 调用，它有时似乎“正常”运行。对于它决定在我的电脑上使用的 4 个线程，localInit 只被调用一次。然而，并非每次。

这是函数的期望行为吗？导致它这样做的幕后发生了什么？最后，获得所需功能 ThreadLocal 的好方法是什么？

顺便说一下，这是在 .NET 4.5 上的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T09:30:34.280

`Parallel.ForEach`不像你想象的那样工作。重要的是要注意该方法是建立在`Task`类之上的，并且 和**之间****的关系不是 1:1`Task``Thread`**。例如，您可以有 10 个任务在 2 个托管线程上运行。

尝试在方法体中使用这一行而不是当前行：

```
Console.WriteLine("ThreadId {0} -- TaskId {1} ",
                  Thread.CurrentThread.ManagedThreadId, Task.CurrentId); 
```

您应该看到`ThreadId`将在许多不同的任务中重用，由它们的唯一 ID 显示。如果您离开或增加对 的调用，您会看到更多`Thread.Sleep`。

该`Parallel.ForEach`方法如何工作的（非常）基本思想是，它需要您的枚举创建一系列任务，这些任务将运行枚举的进程部分，完成方式很大程度上取决于输入。还有一些特殊的逻辑可以检查任务超过一定毫秒数而没有完成的情况。如果这种情况属实，那么可能会产生一项新任务来帮助减轻工作量。

如果您查看 中`localinit`函数的文档[`Parallel.ForEach`](http://msdn.microsoft.com/en-us/library/dd783538.aspx)，您会注意到它说的是它`returns the initial state of the local data for each _task_`，而不是每个*线程*。

您可能会问为什么会产生超过 8 个任务。该答案与上一个类似，可在[`ParallelOptions.MaxDegreeOfParallelism`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.paralleloptions.maxdegreeofparallelism.aspx).

> 从默认值更改仅限制将使用`MaxDegreeOfParallelism`多少**并发任务。**

此限制仅针对并发任务的数量，而不是对在整个处理过程中将创建的任务数量的硬限制。正如我上面提到的，有时会产生一个单独的任务，这会导致您的`localinit`函数被多次调用并将数百个文件写入磁盘。

写入磁盘肯定是一个有一点延迟的操作，尤其是在您使用同步 I/O 时。当磁盘操作发生时，它会阻塞整个线程；同样的情况发生在`Thread.Sleep`. 如果 a`Task`这样做，它将阻塞它当前正在运行的线程，并且没有其他任务可以在其上运行。通常在这些情况下，调度程序会产生一个新`Task`的来帮助弥补松弛。

> 最后，获得所需功能 ThreadLocal 的好方法是什么？

底线是线程局部变量没有意义，`Parallel.ForEach`因为您没有处理线程；你正在处理任务。本地线程可以在任务之间共享，因为许多任务可以同时使用同一个线程。此外，任务的本地线程可能会在执行过程中发生变化，因为调度程序可以抢占它的运行，然后在另一个线程上继续执行，该线程将具有不同的本地线程。

我不确定最好的方法，但是您可以依靠该`localinit`函数来传递您想要的任何资源，一次只允许一个资源在一个线程中使用。您可以使用 将`localfinally`其标记为不再使用，从而可供其他任务获取。这就是这些方法的设计目的；每个方法仅在每个生成的任务中调用一次（请参阅[`Parallel.ForEach`](http://msdn.microsoft.com/en-us/library/dd783538.aspx)MSDN 文档的备注部分）。

您也可以自己拆分工作，创建自己的线程集并运行您的工作。但是，在我看来，这不是一个好主意，因为`Parallel`课程已经为您完成了这项繁重的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T09:25:25.453

您所看到的是试图让您的工作尽快完成的实现。

为此，它尝试使用不同数量的任务来最大化吞吐量。它从线程池中获取一定数量的线程并运行您的工作一段时间。然后它尝试添加和删除线程以查看会发生什么。它会继续这样做，直到您完成所有工作。

该算法非常愚蠢，因为它不知道您的工作是使用大量 CPU 还是大量 IO，或者即使有很多同步并且线程相互阻塞。它所能做的就是添加和删除线程并测量每个工作单元完成的速度。

这意味着它在注入和退出线程时不断调用你的`localInit`和`localFinally`函数——这就是你所发现的。

不幸的是，没有简单的方法来控制这个算法。`Parallel.ForEach`是一种高级构造，它有意隐藏了大部分线程管理代码。

* * *

使用 a可能会有所帮助，但它依赖于线程池在请求新`ThreadLocal`线程时将重用相同线程的事实。`Parallel.ForEach`这不是保证 - 事实上，线程池不太可能在整个调用中使用 8 个线程。这意味着您将再次创建不必要的文件。

* * *

可以保证的一件事**是**在任何时候`Parallel.ForEach`都不会使用超过线程。`MaxDegreeOfParallelism`

您可以通过创建一个固定大小的文件“池”来利用这一点，这些文件可以由在特定时间运行的任何线程重复使用。您知道`MaxDegreeOfParallelism`一次只能运行线程，因此您可以在调用`ForEach`. 然后抓住你的一个`localInit`并在你的`localFinally`.

当然，您必须自己编写这个池，并且它必须是线程安全的，因为它将被并发调用。不过，一个简单的锁定策略应该足够好，因为与锁定的成本相比，线程不会很快注入和退出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T09:26:09.687

根据[MSDN](http://msdn.microsoft.com/en-us/library/dd992683.aspx)，该`localInit`方法为每个**任务**调用一次，而不是每个线程：

> localInit 委托对参与循环执行的每个任务调用一次，并返回每个任务的初始本地状态。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-20T08:04:44.603

localInit 在线程创建时调用。如果 body 需要很长时间，它必须创建另一个线程并挂起当前线程，如果它创建另一个线程，它会调用 localInit

同样，当 Parallel.ForEach 调用它时，它会创建与 MaxDegreeOfParallelism 值一样多的线程，例如：

```
var k = Enumerable.Range(0, 1);
Parallel.ForEach(k,new ParallelOptions(){MaxDegreeOfParallelism = 4}..... 
```

它在第一次调用时创建了 4 个线程

# python - 如何从列表创建二维表？

> ID：14420231
> 
> 赞同：1
> 
> 时间：2013-01-19T23:55:50.597
> 
> 标签：python, list

从表示表面上的点的元组列表开始。

```
list = [(48, 228), (96, 204), (120, 192), ... ] 
```

创建新列表的pythonic方法是什么，所以我们可以从原始列表中调用值，就好像它们分布在网格上一样？

像这样：

```
>>>print grid[0][0]
(48, 228)
>>>print grid[0][1]
(96, 204) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:01:42.080

我真的没有看到困难，也许一个简单的`grid=[list]`就足够了。

如果您想将其作为快速二维数组，请使用 numpy：

```
import numpy as np
grid = np.array(list).reshape(1,-1)
print grid[0,1] #prints (96, 204) 
```

如果您的数据变得更大或更高维度，请始终使用 numpy 数组，不要使用列表列表。

一句话：请不要调用你的变量`list`，它会隐藏内置方法`list`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:06:46.013

这是解决它的列表理解：

```
l = [(48, 228), (96, 204), (120, 192), ... ]
# 'width' is the width of your bidimensional table (grid)
bidimensional = [l[a*width:(a+1)*width] for a in xrange(len(l)/width)] 
```

解释：

```
[  # make a list of:
  l[a*width:(a+1)*width]
    # get the 'a'-th slice of length 'width' of the initial list
  for a in xrange(len(l)/width)  # for 'len(l)/width' slices
] 
```

测试：

```
>>> l = [(1, 11), (2, 22), (3, 33), (4, 44), (5, 55), (6, 66),(7, 77), (8, 88)]
>>> width = 2
>>> bidimensional = [l[a*width:(a+1)*width] for a in xrange(len(l)/width)]

>>> bidimensional
[[(1, 11), (2, 22)], [(3, 33), (4, 44)], [(5, 55), (6, 66)], [(7, 77), (8, 88)]]

>>> bidimensional[2][1]
(6, 66) 
```

# php - 在php中为通用api编写保存方法

> ID：14420233
> 
> 赞同：0
> 
> 时间：2013-01-19T23:56:33.343
> 
> 标签：php, oop, function, abstraction

我最近一直在玩一些非常通用的 OOP 概念并学习抽象我的代码。为此，我编写了一个通用汽车 api，将数据保存到数组中。

问题是我可以添加、列出、删除和查找数据，但是当涉及到编辑时......这很困难。

我写了一个 find 方法可以做到：

```
public function find($car){
    if(in_array($car, $this->_carArray)){
        return $this->_carArray[$car];
    }

    return false;
} 
```

所以现在我可以找到并返回汽车对象。这只是一个数组，例如：

```
array(
 'type' => 'gas',
 'make' => 'some-make'
 'model' => 'some-model',
 'year' => '2005'
); 
```

然后我可以使用我编写的自定义 __set() 方法来设置新类型或新模型，甚至添加 odometerReading。

问题是，当我完成所有这些操作时，我只剩下一个数组 - 如何使用 save 方法保存该数据？

我希望我提供了足够的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:40:41.063

从对象中抽象出来不是 OOP 概念。如果您想抽象持久性，那么存储库应该处理编组/解组，客户端代码应该处理对象

# php - 从文件中删除扩展名

> ID：14420234
> 
> 赞同：-1
> 
> 时间：2013-01-19T23:56:45.837
> 
> 标签：php

我有一个代码可以正常工作，除了 1 个问题。

您可以在此处[http://test.whatanswered.com/health/what-c​​an-a-first-aider-do.php](http://test.whatanswered.com/health/what-can-a-first-aider-do.php)看到显示死链接的“相关文章”右下方的结果。

以下是应显示的 HTML。

```
<p><a href="../health/name-of-the-page.php">Name of the page</a></p> 
```

我想像上面的“页面名称”一样去除破折号和 php，但它也会从 url 中去除破折号和 php。

代码是：

```
<?php 

if ($handle = opendir('health')) {
    $fileTab = array();
    while (false !== ($file = readdir($handle))) {
        if ($file != "." && $file != "..") {
            $fileTab[$file] = strtr(pathinfo($file, PATHINFO_FILENAME), '-', ' '); 
        }
    }
    closedir($handle);
    shuffle($fileTab);
    foreach(array_slice($fileTab, 0, 10) as $file => $health) {
        $thelist .= '<p><a href="../health/'.$file.'">'.$health.'</a></p>';
    }
}
?>
<?=$thelist?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:03:58.847

我已经稍微重构了您的代码 -`$fileTab`数组现在只存储文件名并将其转换为标题发生在显示点：

```
if ($handle = opendir('health')) {
    $fileTab = array();
    while (false !== ($file = readdir($handle))) {
        if ($file != "." && $file != "..") {
            $fileTab[] = $file;
        }
    }
    closedir($handle);
    shuffle($fileTab);

    foreach(array_slice($fileTab, 0, 10) as $file) {
        $title = str_replace('-', ' ', pathinfo($file, PATHINFO_FILENAME));
        $thelist .= '<p><a href="../health/'.$file.'">'.$title.'</a></p>';
    }
} 
```

# unicode - 带有 Gtk3 的 Python 没有正确设置 unicode

> ID：14420235
> 
> 赞同：0
> 
> 时间：2013-01-19T23:56:46.200
> 
> 标签：unicode, python-3.x, clipboard, gtk3

我有一些没有按预期工作的简单代码。首先，文档说`Gtk.Clipboard.get(Gdk.SELECTION_PRIMARY).set_text()`应该只能接受一个带有长度参数选项的参数，但它不起作用（见下文）。最后，粘贴 unicode`°`符号会在尝试从剪贴板中检索文本时中断设置文本（并且不会粘贴到其他程序中）。它给出了这个警告：

> Gdk-WARNING **：从 UTF8_STRING 转换选择时出错

```
>>> from gi.repository.Gtk import Clipboard
>>> from gi.repository.Gdk import SELECTION_PRIMARY
>>> d='\u00B0'
>>> print(d)
°
>>> cb=Clipboard
Clipboard
>>> cb=Clipboard.get(SELECTION_PRIMARY)
>>> cb.set_text(d) #this should work
Traceback (most recent call last):
  File "<ipython-input-6-b563adc3e800>", line 1, in <module>
    cb.set_text(d)
  File "/usr/lib/python3/dist-packages/gi/types.py", line 43, in function
    return info.invoke(*args, **kwargs)
TypeError: set_text() takes exactly 3 arguments (2 given)

>>> cb.set_text(d, len(d))
>>> cb.wait_for_text()

(.:13153): Gdk-WARNING **: Error converting selection from UTF8_STRING
'\\Uffffffff\\Uffffffff' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T18:03:22.433

从文档中`Gtk.Clipboard`

看起来该方法`set_text`需要第二个参数。第一个是文本，第二个是文本的长度。或者，如果您不想提供长度，可以使用 -1 让它自己计算长度。

> gtk.Clipboard.set_text
> 
> ```
> def set_text(text, len=-1) 
> ```
> 
> 文本：一个字符串。
> 
> len ：文本的长度，以字节为单位，或 -1，用于计算长度。

我已经在 Python 3 上对其进行了测试，它适用于`cb.set_text(d, -1)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-28T14:31:39.223

自 GTK 3.16 版以来，有一种更简单的方法来获取剪贴板。您可以使用 get_default() 方法获取它：

```
import gi
gi.require_version('Gtk', '3.0')
from gi.repository import Gtk, Gdk, GLib, Gio

display = Gdk.Display.get_default()
clipboard = Gtk.Clipboard.get_default(display)
clipboard.set_text(string, -1) 
```

对我来说，它也没有

```
clipboard.store() 
```

参考：[https ://lazka.github.io/pgi-docs/Gtk-3.0/classes/Clipboard.html#Gtk.Clipboard.get_default](https://lazka.github.io/pgi-docs/Gtk-3.0/classes/Clipboard.html#Gtk.Clipboard.get_default)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-07T09:52:38.753

在 Python 3.4 中。这仅对 GtkEntryBuffers 是必需的。如果 GtkTextBuffer 在`set_text`没有第二个参数的情况下工作。

example1 照常工作：

```
settinginfo = 'serveradres = ' + server + '\n poortnummer = ' + poort
GtkTextBuffer2.set_text(settinginfo) 
```

example2 需要额外的参数 len：

```
ErrorTextDate = 'choose earlier date'
GtkEntryBuffer1.set_text(ErrorTextDate, -1) 
```

# android - android resttemplate +httpclient header 编码问题

> ID：14420237
> 
> 赞同：1
> 
> 时间：2013-01-19T23:57:00.943
> 
> 标签：android, http, apache-commons-httpclient, resttemplate

Android 客户端，使用 Springs resttemplace 和 Apache 通用 HTTP 客户端发出请求。

我正在处理一个服务器，它有时会返回一个 401 错误，带有一个 http 标头字符串，“ERROR”包含一个用户信息字符串。该字符串取决于语言，因此它可能包含例如斯堪的纳维亚字符。

该字符串在我的 IOS 应用程序中看起来很好，当我在 Firefox RESTclient 插件中检查它时也是如此。

但是，在我的 Android 应用程序中，我一辈子都无法正确显示字符。如果有人能想到一种方法，我可以使数据正确显示，我将非常感激。

服务器发送内容类型 UTF-8，它是 httpservletresponse 上的常规 .setHeader() 设置我尝试检索的参数。

这是我在我的 Android 客户端中创建的 resttemplate（我尝试了大多数方法，如你所见）：

```
 HttpClient httpClient = new HttpClient();
    Credentials defaultcreds = new UsernamePasswordCredentials(msisdn, password);
    httpClient.getState().setCredentials(new AuthScope(AuthScope.ANY_HOST, AuthScope.ANY_PORT, AuthScope.ANY_REALM), defaultcreds);
    httpClient.getParams().setSoTimeout(prefs.getServerTimeout());
    httpClient.getParams().setConnectionManagerTimeout(3000);
    httpClient.getParams().setContentCharset("utf-8");
    httpClient.getParams().setCredentialCharset(prefs.getCredentialsEncoding());
    httpClient.getParams().setHttpElementCharset("utf-8");
    httpClient.getParams().setUriCharset("utf-8");
    CommonsClientHttpRequestFactory requestFactory = new CommonsClientHttpRequestFactory(httpClient);
    requestFactory.setReadTimeout(prefs.getServerTimeout());
    RestTemplate restTemplate = new RestTemplate(requestFactory);
    // Add message converters
    List<HttpMessageConverter<?>> mc = restTemplate.getMessageConverters();
    MappingJacksonHttpMessageConverter json = new MappingJacksonHttpMessageConverter();

    List<MediaType> supportedMediaTypes = new ArrayList<MediaType>();
    supportedMediaTypes.add(MediaType.APPLICATION_JSON);
    json.setSupportedMediaTypes(supportedMediaTypes);
    mc.add(json);
    restTemplate.setMessageConverters(mc);

    // Set our specific error handler
    restTemplate.setErrorHandler(new MyErrorHandler()); 
```

这是我的 http 响应，如果我在那里运行相同的请求，则从 Firefox 中的 restclient 复制：

```
Status Code: 401 Unauthorized
Content-Length: 954
Content-Type: text/html;charset=utf-8
Date: Sat, 19 Jan 2013 23:53:10 GMT
ERROR: För att <contents cut out but as you see Scandinavian char looks fine here >
Server: Apache-Coyote/1.1
WWW-Authenticate: Basic realm="rest" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T04:04:31.743

您的响应内容类型似乎是 text/html。您是否尝试在请求标头中设置 Content-Type 和字符集，如下所示？根据[此处的文档](http://www.w3.org/International/O-HTTP-charset.en.php)

*使用 HTTP 传输的文本类型的文档，例如 text/html、text/plain 等，可以在 HTTP 头中发送一个 charset 参数来指定文档的字符编码。*

```
LinkedMultiValueMap<String, String> headers = new LinkedMultiValueMap<String, String>();
headers.set("Content-Type", "text/html;charset=utf-8");
HttpEntity request = new HttpEntity(null, headers);
ResponseEntity<Person> response = template.exchange(url,
                HttpMethod.GET, request, Person.class); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T09:52:19.327

HTTP 标头使用 ASCII（或者，在旧规范中，Latin-1）。将其他编码放入标头可能会或可能不会起作用。

# knockout.js - 更新时如果绑定不起作用的淘汰赛原因

> ID：14420239
> 
> 赞同：0
> 
> 时间：2013-01-19T23:57:16.667
> 
> 标签：knockout.js, signalr

我整天都在解决一个让我发疯的问题。似乎在更新其值时不会重新评估淘汰赛“if”语句的内容。

我有一个像这样的viewModel：

```
var userViewModel = (function(){
    var context = ko.observable(),

    // SignalR hub
    hub = $.connection.user;

    hub.client.setContext = function(data){
        context(ko.mapping.fromJS(data));
    }

    return {
        context: context;
    };
})(); 
```

它使用 SignalR 更新客户端中的视图模型，该视图模型在启动时尚不存在。

我正在使用 ko if 绑定，因此在应用绑定时视图不会崩溃。视图如下所示：

```
<div class="js-user-template">
<!-- ko if: context -->
    <div data-bind="with: context">
        <span data-bind="text: firstName"></span>
        <span data-bind="text: lastName"></span>
    </div>
<!-- /ko -->
</div> 
```

将它们放在一起的结合酱：

```
$('.js-user-template').each(function(){
    ko.applyBindings(userViewModel, this);
}); 
```

当 SignalR 使用 setContext 异步更新客户端时，它不会在 DOM 中更新。奇怪的是，它确实在大约 10% 的时间内工作，这表明存在时间/线程问题。控制台中不会记录任何类型的警告。

谁能指出我正确的方向？任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T10:56:03.640

大佬，谢谢你的帮助！经过一夜好眠，你们告诉我这*应该可以*工作，我发现了问题。

我的装订酱实际上看起来更像这样：

```
myNS.bindUserTemplate = function(context){
  $('.js-user-template').each(function(){
      ko.applyBindings(userViewModel, this);
  });
}

myNS.DomUpdated(myNS.bindUserTemplate);. 
```

或者自己的小框架让我每次在 DOM 中更新某些内容时绑定到自定义事件。这样我可以解析它并查看它是否包含模板。我的问题是我忘记在更新元素的上下文中选择 .js-user-template 类。这导致模板被绑定 4 次，而不是 1....

很抱歉浪费您的时间，希望这个问题仍然可以帮助有同样问题的人。

# jquery - 那里有 Cloudinary + Django Upload 的完整示例吗？

> ID：14420240
> 
> 赞同：1
> 
> 时间：2013-01-19T23:57:27.130
> 
> 标签：jquery, django, cloudinary

Cloudinary + Django 文档对于像我这样的新手来说非常稀少，而且我一直遇到障碍。有没有人看过或知道一些我可以签出文件上传的示例代码？特别是关于声称基于现有 jQuery 插件的 jQuery 插件，但没有关于它如何不同的文档。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T07:39:38.327

[这篇博](http://cloudinary.com/blog/direct_image_uploads_from_the_browser_to_the_cloud_with_jquery)文中有一些 Django 代码片段，描述了如何使用 jQuery 插件从浏览器直接上传到 Cloudinary。无论如何，我们正在努力改进我们的文档并提供全面的示例项目。

**更新**

提供了完整的 Django 示例代码。包括服务器端上传以及从浏览器直接上传。

[https://github.com/cloudinary/cloudinary-django-sample](https://github.com/cloudinary/cloudinary-django-sample)

# ios - iOS 开发者计划续订

> ID：14420252
> 
> 赞同：1
> 
> 时间：2013-01-19T23:58:34.540
> 
> 标签：ios

我开发了一个 iPhone 应用程序，它已经在 iTunes 中可供下载。
Apple 还允许您访问开发人员会员区和许多其他工具。

有谁知道，如果我决定不续订会怎样？这是否会影响我现有的应用程序的下载或现有设备中的功能？有哪些后果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:06:03.433

来自[iOS 程序支持中心](https://developer.apple.com/support/ios/program-renewals.html)

> 如果我不续订 iOS 开发者计划会员资格会怎样？
> 
> 一旦您的会员资格到期，您的应用程序将不再在 App Store 上可用，并且您将失去提交新应用程序的能力。您将无法访问预发布软件、Apple 开发者论坛、开发者技术支持和证书实用程序。此外，您现有的 iOS 分发证书将被撤销和失效。最后，如果您作为公司注册该计划，您将失去管理开发团队的能力。
> 
> 但是，您将保留您作为注册 Apple 开发者的身份，并且可以访问免费的开发资源。

我认为这几乎说明了一切，我确信下载您的应用程序的用户仍然可以使用它们，但这些应用程序将不再在商店中提供。

# c++ - cpp / c++ 获取指针值或depointerize指针

> ID：14420257
> 
> 赞同：57
> 
> 时间：2013-01-19T23:59:15.083
> 
> 标签：c++, pointers

我想知道是否可以使指针不是指针..

问题是我有一个函数接受一个参数指针，以便我轻松获取该指针的值。这是一个简单的 int ，所以我想知道是否可以直接获取该值，而无需在我希望该值到达的任何地方发送指针。

我不希望函数将值作为 int 返回，因为它为 2 个指针赋值！

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2013-01-20T00:05:00.297

要获取指针的值，只需取消引用指针即可。

```
int *ptr;
int value;
*ptr = 9;

value = *ptr; 
```

值现在是 9。

我建议您阅读有关指针的更多信息，这是它们的基本功能。

# php - 分页问题

> ID：14420264
> 
> 赞同：2
> 
> 时间：2013-01-20T00:00:05.947
> 
> 标签：php, mysql, pdo, pagination

我正在制作一个简单的从数据库中选择并显示的应用程序，并正在构建分页以配合它。

这是我的代码：

```
<?php   
   $sqlcount = "SELECT * FROM user where user_id= ?";
   $qcount = $db->prepare($sqlcount);
   $qcount->execute(array($id));
   $qcount->setFetchMode(PDO::FETCH_BOTH);
   $total = $qcount->rowCount();

   // How many items to list per page
   $limit = 10;

   // How many pages will there be
   $pages = ceil($total / $limit);

   // What page are we currently on?
   $page = min($pages, filter_input(INPUT_GET, 'page', FILTER_VALIDATE_INT, array(
                            'options' => array(
                                'default'   => 1,
                                'min_range' => 1,
                            ),
   )));

   // Calculate the offset for the query
   $offset = ($page - 1)  * $limit;

   // Some information to display to the user
   $start = $offset + 1;
   $end = min(($offset + $limit), $total);

   // The "back" link
   $prevlink = ($page > 1) ? '<a href="?page=1" title="First page">&laquo;</a> <a href="?page=' . ($page - 1) . '" title="Previous page">&lsaquo;</a>' : '<span class="disabled">&laquo;</span> <span class="disabled">&lsaquo;</span>';

   // The "forward" link
   $nextlink = ($page < $pages) ? '<a href="?page=' . ($page + 1) . '" title="Next page">&rsaquo;</a> <a href="?page=' . $pages . '" title="Last page">&raquo;</a>' : '<span class="disabled">&rsaquo;</span> <span class="disabled">&raquo;</span>';

   // Display the paging information
   echo '<div id="paging"><p>', $prevlink, ' Page ', $page, ' of ', $pages, ' pages, displaying ', $start, '-', $end, ' of ', $total, ' results ', $nextlink, ' </p></div>';

   $stmt = $db->prepare("SELECT * FROM recipes WHERE user_id = :userid ORDER BY name LIMIT :limit OFFSET :offset");
   $stmt->bindParam(':userid', $id, PDO:: PARAM_INT);
   $stmt->bindParam(':limit', $limit, PDO:: PARAM_INT);
   $stmt->bindParam(':offset', $offset, PDO:: PARAM_INT);
   $stmt->execute();
   $rowcount = $stmt->rowCount();

   echo "<ul id='container'>";
   if(empty($rowcount)){echo"No recipes";}
   while($row = $stmt->fetch()){
    $recipeid = $row['id'];
    $public = $row['public'];

    //here i left out some stuff unimportant to the problem
   }
?> 
```

在我放入分页之前，我的结果已经显示出来了。现在，有了错误报告，没有错误，但它显示“没有食谱”和`« ‹ Page 0 of 0 pages, displaying -9-0 of 0 results › »`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T03:02:33.170

您正在尝试使用该`rowCount()`函数计算从查询返回的行数，女巫被用于从 INSERT、UPDATE、DELETE 查询中返回受影响的行。您需要创建一个计数查询。

试试这个例子：

```
$sqlcount = "SELECT COUNT(*) FROM user where user_id= ?";
$qcount = $db->prepare($sqlcount);
$qcount->execute(array($id));
$total = $qcount->fetchColumn(); 
```

# javascript - 谷歌地图矩形选择工具：如何在keydragzoom库中保持矩形显示

> ID：14420269
> 
> 赞同：0
> 
> 时间：2013-01-20T00:00:34.700
> 
> 标签：javascript, google-maps, google-maps-api-3, keydragzoom

使用 keydragzoom 库，您可以将鼠标拖动到地图上以进行矩形选择，请参见此示例：http: [//google-maps-utility-library-v3.googlecode.com/svn/tags/keydragzoom/2.0.9/examples /events.html](http://google-maps-utility-library-v3.googlecode.com/svn/tags/keydragzoom/2.0.9/examples/events.html)

我想要的是使用它作为选择工具，即选择特定的矩形，并保持矩形（选择）显示。但是在结束鼠标拖动后，矩形总是消失。有什么办法可以用这个库来实现这一点？

我尝试将`noZoom`选项设置为`true`，但没有帮助。我知道我可以绘制自己的矩形，但是在选择新矩形等时需要处理情况。所以我想在这个库中做。

# ruby-on-rails - Rails 3 模型关系

> ID：14420270
> 
> 赞同：0
> 
> 时间：2013-01-20T00:00:35.557
> 
> 标签：ruby-on-rails, relationship, rails-activerecord

我对如何关联我拥有的一些模型有点困惑。希望得到一些指示或想法！

假设我有 3 个模型，分别命名为“MinorTeam”、“MajorTeam”和“Game”。每场比赛参考两支球队；但是我如何指定它是主要团队还是次要团队？

```
has_one :team_1, :class_name => "MajorTeam"
# or 
has_one :team_1, :class_name => "MinorTeam" 
```

这两个团队模型有很大的不同，所以我不能简单地将主要/次要标志添加到团队模型中。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:09:24.770

多态关联应该起作用。您可能需要稍微调整一下才能使其正确，但是通过使用它们，团队课程不必相似，除了有游戏*。*

```
module Team
  extend ActiveSupport::Concern
  included do
    has_many :home_games, :class_name => "Game", :as => :team_1
    has_many :away_games, :class_name => "Game", :as => :team_2
  end
end

class MajorTeam < ActiveRecord::Base
  include Team
end

class MinorTeam < ActiveRecord::Base
  include Team
end

class Game < ActiveRecord::Base
  belongs_to :team_1, :polymorphic => true
  belongs_to :team_2, :polymorphic => true
end 
```

我假设你的意思是你`has_one`的意思是`belongs_to`，`has_one`这意味着每支球队只属于一场比赛，这似乎是不正确的。如果我错了，请告诉我。

# c# - 如何显示图片目录中的图像？

> ID：14420275
> 
> 赞同：3
> 
> 时间：2013-01-20T00:01:21.030
> 
> 标签：c#, windows-8, windows-runtime, async-await

我想在图片库中显示图片。我得到图片并绑定数据。

```
StorageFolder picturesFolder = KnownFolders.PicturesLibrary;
IReadOnlyList<StorageFile> myPictures = await picturesFolder.GetFilesAsync();
var mydata = from file in myPictures select new { Subtitle = "subtitle", Title = "title", Image = this.getImage(file.Path) };

this.DefaultViewModel["Items"] = mydata; 
```

这是设置 BitmapImage 的 getImage()。

```
private async Task<BitmapImage> getImage(string finename)
{
    StorageFolder picturesFolder = KnownFolders.PicturesLibrary;
    StorageFile file = await picturesFolder.GetFileAsync(fileName);
    var stream = await file.OpenReadAsync();

    var bitmap = new BitmapImage();
    bitmap.SetSource(stream);

    return bitmap;
 } 
```

但是图片不显示。我认为这是因为异步功能，但我不知道解决方案。你可以帮帮我吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:04:26.900

我不确定您如何使用设置为 的数据`DefaultViewModel`，但是是的，看起来该`async`方法是您的问题。

您需要做的是以某种方式`await`每次调用`getImage()`. 一种方法是`async`在你的`select`. 但要做到这一点，您需要使用方法语法。

当你这样做时，你将拥有`IEnumerable<Task<a>>`（`a`你的匿名类型在哪里），但你只需要`IEnumerable<a>`. 为此，请使用[`Task.WhenAll()`](http://msdn.microsoft.com/en-us/library/hh194766.aspx)（将返回`Task<a[]>`），然后使用`await`其结果：

```
var tasks = myPictures.Select(
    async file => new { Subtitle = "subtitle", Title = "title", Image = await getImage(file.Path) });
var data = await Task.WhenAll(tasks); 
```

这将一次执行所有`getImage()`s，这可能不是最有效的解决方案。如果您不希望这样，您将需要不同的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T05:27:12.717

svick 的解决方案似乎应该可行，但正如他/她所说 - 它可能不是最有效的解决方案。对于包含未知数量文件的文件夹，更好的解决方案是使用`FileInformationFactory.GetVirtualizedFilesVector()`. 最好使用转换器。

我用过的东西：

**获取虚拟化文件列表并绑定到 ListView**

```
private async void GetPicturesFromGalleryFolder()
{
    var queryOptions = new QueryOptions();
    queryOptions.FolderDepth = FolderDepth.Shallow;
    queryOptions.IndexerOption = IndexerOption.UseIndexerWhenAvailable;
    queryOptions.SortOrder.Clear();

    var sortEntry = new SortEntry {PropertyName = "System.DateModified", AscendingOrder = false};
    queryOptions.SortOrder.Add(sortEntry);
    queryOptions.FileTypeFilter.Add(".png");

    var fileQuery = KnownFolders.PicturesLibrary.CreateFileQueryWithOptions(queryOptions);
    var fileInformationFactory =
        new FileInformationFactory(
            fileQuery,
            ThumbnailMode.PicturesView,
            0,
            ThumbnailOptions.None,
            true);

    MyListView.ItemsSource = fileInformationFactory.GetVirtualizedFilesVector();
} 
```

**XAML**

```
<ListView.ItemTemplate>
    <DataTemplate>
        <Image
            Source="{Binding Converter={StaticResource converters:IStorageItemInformationToBitmapImageConverter}"/>
    </DataTemplate>
</ListView.ItemTemplate> 
```

**IStorageItemInformationToBitmapImageConverter**

```
public class IStorageItemInformationToBitmapImageConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, string language)
    {
        var fileInfo = value as FileInformation;

        if (fileInfo != null)
        {
            var bi = new BitmapImage();

            // The file is being opened asynchronously but we return the BitmapImage immediately.
            SetSourceAsync(bi, fileInfo);
            return bi;

        }

        return null;
    }

    private async void SetSourceAsync(BitmapImage bi, FileInformation fi)
    {
        try
        {
            using (var stream = await fi.OpenReadAsync())
            {
                await bi.SetSourceAsync(stream);
            }
        }
        catch
        {
            // ignore failure
        }
    }

    public object ConvertBack(object value, Type targetType, object parameter, string language)
    {
        return null;
    }
} 
```

# c# - 精心设计的查询命令和/或规范

> ID：14420276
> 
> 赞同：92
> 
> 时间：2013-01-20T00:01:22.847
> 
> 标签：c#, repository-pattern, command-pattern, specification-pattern

我一直在寻找一个很好的解决方案来解决典型存储库模式所带来的问题（不断增长的专用查询方法列表等。请参阅：[http ://ayende.com/blog/3955/repository-是新的单例](http://ayende.com/blog/3955/repository-is-the-new-singleton)）。

我真的很喜欢使用命令查询的想法，特别是通过使用规范模式。但是，我对规范的问题是它只涉及简单选择的标准（基本上是 where 子句），而不涉及查询的其他问题，例如连接、分组、子集选择或投影等。基本上，许多查询必须经过所有额外的循环才能获得正确的数据集。

（注意：我在命令模式中使用术语“命令”，也称为查询对象。我不是在谈论命令/查询分离中的命令，其中查询和命令（更新、删除、插入））

所以我正在寻找封装整个查询的替代方案，但仍然足够灵活，以至于您不只是将意大利面条存储库换成命令类的爆炸式增长。

例如，我使用过 Linqspecs，虽然我发现能够为选择标准分配有意义的名称有一些价值，但这还不够。也许我正在寻找一种结合多种方法的混合解决方案。

我正在寻找其他人可能已经开发的解决方案来解决这个问题，或者解决一个不同的问题，但仍然满足这些要求。在链接的文章中，Ayende 建议直接使用 nHibernate 上下文，但我觉得这在很大程度上使您的业务层复杂化，因为它现在还必须包含查询信息。

等待期结束后，我将为此提供赏金。因此，请让您的解决方案有价值，并提供良好的解释，我将选择最佳解决方案，并为亚军投票。

注意：我正在寻找基于 ORM 的东西。不必明确地是 EF 或 nHibernate，但这些是最常见的并且最适合。如果它可以很容易地适应其他 ORM，那将是一个奖励。Linq 兼容也不错。

更新：我真的很惊讶这里没有很多好的建议。似乎人们要么完全是 CQRS，要么完全属于 Repository 阵营。我的大多数应用程序都不够复杂，不足以保证 CQRS（大多数 CQRS 倡导者很容易说你不应该使用它）。

更新：这里似乎有点混乱。我不是在寻找新的数据访问技术，而是在业务和数据之间设计合理的接口。

理想情况下，我正在寻找的是查询对象、规范模式和存储库之间的某种交叉。正如我上面所说，规范模式只处理 where 子句方面，而不是查询的其他方面，例如连接、子选择等。存储库处理整个查询，但一段时间后就会失控. 查询对象也处理整个查询，但我不想简单地用大量查询对象替换存储库。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-01-25T09:07:27.227

**免责声明：**由于还没有任何好的答案，我决定从我不久前阅读的一篇很棒的博客文章中发布一部分，几乎逐字复制。[您可以在此处](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=92)找到完整的博客文章。所以这里是：

* * *

我们可以定义以下两个接口：

```
public interface IQuery<TResult>
{
}

public interface IQueryHandler<TQuery, TResult> where TQuery : IQuery<TResult>
{
    TResult Handle(TQuery query);
} 
```

指定一条消息，该消息使用泛型类型`IQuery<TResult>`返回的数据定义特定查询。`TResult`使用之前定义的接口，我们可以定义如下查询消息：

```
public class FindUsersBySearchTextQuery : IQuery<User[]>
{
    public string SearchText { get; set; }
    public bool IncludeInactiveUsers { get; set; }
} 
```

这个类定义了一个带有两个参数的查询操作，这将产生一个`User`对象数组。处理这个消息的类可以定义如下：

```
public class FindUsersBySearchTextQueryHandler
    : IQueryHandler<FindUsersBySearchTextQuery, User[]>
{
    private readonly NorthwindUnitOfWork db;

    public FindUsersBySearchTextQueryHandler(NorthwindUnitOfWork db)
    {
        this.db = db;
    }

    public User[] Handle(FindUsersBySearchTextQuery query)
    {
        return db.Users.Where(x => x.Name.Contains(query.SearchText)).ToArray();
    }
} 
```

我们现在可以让消费者依赖通用`IQueryHandler`接口：

```
public class UserController : Controller
{
    IQueryHandler<FindUsersBySearchTextQuery, User[]> findUsersBySearchTextHandler;

    public UserController(
        IQueryHandler<FindUsersBySearchTextQuery, User[]> findUsersBySearchTextHandler)
    {
        this.findUsersBySearchTextHandler = findUsersBySearchTextHandler;
    }

    public View SearchUsers(string searchString)
    {
        var query = new FindUsersBySearchTextQuery
        {
            SearchText = searchString,
            IncludeInactiveUsers = false
        };

        User[] users = this.findUsersBySearchTextHandler.Handle(query);    
        return View(users);
    }
} 
```

这个模型立即为我们提供了很大的灵活性，因为我们现在可以决定将什么注入`UserController`. 我们可以注入一个完全不同的实现，或者一个包装真实实现的实现，而无需更改`UserController`（以及该接口的所有其他消费者）。

在指定或注入我们的代码时，该`IQuery<TResult>`接口为我们提供了编译时支持。`IQueryHandlers`当我们将`FindUsersBySearchTextQuery`改为 return时`UserInfo[]`（通过实现`IQuery<UserInfo[]>`），`UserController`将无法编译，因为泛型类型约束 on`IQueryHandler<TQuery, TResult>`将无法映射`FindUsersBySearchTextQuery`到`User[]`.

然而，将`IQueryHandler`接口注入消费者，还有一些不太明显的问题需要解决。我们的消费者的依赖数量可能会变得太大，并且可能导致构造函数过度注入 - 当构造函数接受太多参数时。类执行的查询数量可能会经常变化，这需要不断更改构造函数参数的数量。

`IQueryHandlers`我们可以通过额外的抽象层来解决必须注入太多的问题。我们创建了一个位于消费者和查询处理程序之间的中介：

```
public interface IQueryProcessor
{
    TResult Process<TResult>(IQuery<TResult> query);
} 
```

这`IQueryProcessor`是一个具有一个通用方法的非通用接口。正如您在接口定义中看到的那样，`IQueryProcessor`取决于`IQuery<TResult>`接口。这使我们能够在依赖于`IQueryProcessor`. 让我们重写`UserController`以使用新的`IQueryProcessor`：

```
public class UserController : Controller
{
    private IQueryProcessor queryProcessor;

    public UserController(IQueryProcessor queryProcessor)
    {
        this.queryProcessor = queryProcessor;
    }

    public View SearchUsers(string searchString)
    {
        var query = new FindUsersBySearchTextQuery
        {
            SearchText = searchString,
            IncludeInactiveUsers = false
        };

        // Note how we omit the generic type argument,
        // but still have type safety.
        User[] users = this.queryProcessor.Process(query);

        return this.View(users);
    }
} 
```

现在`UserController`取决于`IQueryProcessor`可以处理我们所有查询的。的方法调用传入初始化查询对象`UserController`的方法。由于实现了接口，我们可以将它传递给泛型方法。由于 C# 类型推断，编译器能够确定泛型类型，这使我们不必显式声明类型。该方法的返回类型也是已知的。`SearchUsers``IQueryProcessor.Process``FindUsersBySearchTextQuery``IQuery<User[]>``Execute<TResult>(IQuery<TResult> query)``Process`

现在是`IQueryProcessor`找对了落实的责任`IQueryHandler`。这需要一些动态类型，并且可以选择使用依赖注入框架，并且只需几行代码即可完成：

```
sealed class QueryProcessor : IQueryProcessor
{
    private readonly Container container;

    public QueryProcessor(Container container)
    {
        this.container = container;
    }

    [DebuggerStepThrough]
    public TResult Process<TResult>(IQuery<TResult> query)
    {
        var handlerType = typeof(IQueryHandler<,>)
            .MakeGenericType(query.GetType(), typeof(TResult));

        dynamic handler = container.GetInstance(handlerType);

        return handler.Handle((dynamic)query);
    }
} 
```

该类根据提供的查询实例的类型`QueryProcessor`构造特定类型。`IQueryHandler<TQuery, TResult>`此类型用于要求提供的容器类获取该类型的实例。不幸的是，我们需要`Handle`使用反射调用该方法（在本例中使用 C# 4.0 动态关键字），因为此时无法强制转换处理程序实例，因为通用`TQuery`参数在编译时不可用。但是，除非`Handle`方法被重命名或获取其他参数，否则此调用将永远不会失败，如果您愿意，为此类编写单元测试非常容易。使用反射会略有下降，但没什么好担心的。

* * *

回答您的一个问题：

> 所以我正在寻找封装整个查询的替代方案，但仍然足够灵活，以至于您不只是将意大利面条存储库换成命令类的爆炸式增长。

使用这种设计的一个结果是系统中会有很多小类，但是有很多小/集中的类（具有清晰的名称）是一件好事。这种方法显然比在存储库中为同一方法使用不同参数的许多重载要好得多，因为您可以将它们分组到一个查询类中。因此，您获得的查询类仍然比存储库中的方法少得多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-20T08:40:42.990

我的处理方式实际上是简单化且与 ORM 无关。我对存储库的看法是：存储库的工作是为应用程序提供上下文所需的模型，因此应用程序只是向存储库询问它想要**什么**，但不告诉它**如何**获取它。

我为存储库方法提供了一个 Criteria（是的，DDD 样式），repo 将使用它来创建查询（或任何需要的 - 它可能是一个 web 服务请求）。恕我直言，联接和组是如何的细节，而不是什么和标准应该只是构建where子句的基础。

模型 = 应用程序需要的最终对象或数据结构。

```
public class MyCriteria
{
   public Guid Id {get;set;}
   public string Name {get;set;}
    //etc
 }

 public interface Repository
  {
       MyModel GetModel(Expression<Func<MyCriteria,bool>> criteria);
   } 
```

如果需要，您可能可以直接使用 ORM 标准（Nhibernate）。存储库实现应该知道如何将 Criteria 与底层存储或 DAO 一起使用。

我不知道您的域和模型要求，但如果最好的方法是应用程序自己构建查询，那就太奇怪了。模型变化如此之大，以至于您无法定义稳定的东西？

这个解决方案显然需要一些额外的代码，但它不会将其余的代码耦合到 ORM 或您用来访问存储的任何东西。存储库的作用是充当门面，IMO 很干净，“标准翻译”代码是可重用的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-28T19:43:19.807

我已经完成了这个，支持这个并撤消了这个。

主要问题是：无论你怎么做，增加的抽象都不会让你获得独立性。它会根据定义泄漏。从本质上讲，你发明了一个完整的层只是为了让你的代码看起来很可爱……但它不会减少维护、提高可读性或让你获得任何类型的模型不可知论。

有趣的是，您回答了自己的问题以回应 Olivier 的回答：“这实际上是在复制 Linq 的功能，而没有从 Linq 获得的所有好处”。

问问自己：怎么可能？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-20T02:12:52.313

您可以使用流畅的界面。基本思想是一个类的方法在执行了一些操作之后返回这个类的当前实例。这允许您链接方法调用。

通过创建适当的类层次结构，您可以创建可访问方法的逻辑流。

```
public class FinalQuery
{
    protected string _table;
    protected string[] _selectFields;
    protected string _where;
    protected string[] _groupBy;
    protected string _having;
    protected string[] _orderByDescending;
    protected string[] _orderBy;

    protected FinalQuery()
    {
    }

    public override string ToString()
    {
        var sb = new StringBuilder("SELECT ");
        AppendFields(sb, _selectFields);
        sb.AppendLine();

        sb.Append("FROM ");
        sb.Append("[").Append(_table).AppendLine("]");

        if (_where != null) {
            sb.Append("WHERE").AppendLine(_where);
        }

        if (_groupBy != null) {
            sb.Append("GROUP BY ");
            AppendFields(sb, _groupBy);
            sb.AppendLine();
        }

        if (_having != null) {
            sb.Append("HAVING").AppendLine(_having);
        }

        if (_orderBy != null) {
            sb.Append("ORDER BY ");
            AppendFields(sb, _orderBy);
            sb.AppendLine();
        } else if (_orderByDescending != null) {
            sb.Append("ORDER BY ");
            AppendFields(sb, _orderByDescending);
            sb.Append(" DESC").AppendLine();
        }

        return sb.ToString();
    }

    private static void AppendFields(StringBuilder sb, string[] fields)
    {
        foreach (string field in fields) {
            sb.Append(field).Append(", ");
        }
        sb.Length -= 2;
    }
}

public class GroupedQuery : FinalQuery
{
    protected GroupedQuery()
    {
    }

    public GroupedQuery Having(string condition)
    {
        if (_groupBy == null) {
            throw new InvalidOperationException("HAVING clause without GROUP BY clause");
        }
        if (_having == null) {
            _having = " (" + condition + ")";
        } else {
            _having += " AND (" + condition + ")";
        }
        return this;
    }

    public FinalQuery OrderBy(params string[] fields)
    {
        _orderBy = fields;
        return this;
    }

    public FinalQuery OrderByDescending(params string[] fields)
    {
        _orderByDescending = fields;
        return this;
    }
}

public class Query : GroupedQuery
{
    public Query(string table, params string[] selectFields)
    {
        _table = table;
        _selectFields = selectFields;
    }

    public Query Where(string condition)
    {
        if (_where == null) {
            _where = " (" + condition + ")";
        } else {
            _where += " AND (" + condition + ")";
        }
        return this;
    }

    public GroupedQuery GroupBy(params string[] fields)
    {
        _groupBy = fields;
        return this;
    }
} 
```

你会这样称呼它

```
string query = new Query("myTable", "name", "SUM(amount) AS total")
    .Where("name LIKE 'A%'")
    .GroupBy("name")
    .Having("COUNT(*) > 2")
    .OrderBy("name")
    .ToString(); 
```

您只能创建 的新实例`Query`。其他类有一个受保护的构造函数。层次结构的重点是“禁用”方法。例如，该`GroupBy`方法返回 a `GroupedQuery`，它是基类`Query`并且没有`Where`方法（ where 方法在 中声明`Query`）。因此无法调用`Where`after `GroupBy`。

然而它并不完美。使用此类层次结构，您可以连续隐藏成员，但不显示新成员。因此`Having`在之前调用它时会引发异常`GroupBy`。

请注意，可以`Where`多次调用。这会`AND`在现有条件中添加新条件。这使得从单个条件以编程方式构造过滤器变得更加容易。也是可能的`Having`。

接受字段列表的方法有一个参数`params string[] fields`。它允许您传递单个字段名称或字符串数​​组。

* * *

Fluent 接口非常灵活，不需要您创建大量具有不同参数组合的方法重载。我的示例适用于字符串，但是该方法可以扩展到其他类型。您还可以为特殊情况或接受自定义类型的方法声明预定义的方法。您还可以添加类似`ExecuteReader`or的方法`ExceuteScalar<T>`。这将允许您定义这样的查询

```
var reader = new Query<Employee>(new MonthlyReportFields{ IncludeSalary = true })
    .Where(new CurrentMonthCondition())
    .Where(new DivisionCondition{ DivisionType = DivisionType.Production})
    .OrderBy(new StandardMonthlyReportSorting())
    .ExecuteReader(); 
```

即使是这样构造的 SQL 命令也可以有命令参数，从而避免 SQL 注入问题，同时允许命令被数据库服务器缓存。这不是 O/R 映射器的替代品，但可以在您使用简单字符串连接创建命令的情况下提供帮助。

# android - Eclipse 不会启动 Android 模拟器，也不会安装应用程序

> ID：14420289
> 
> 赞同：1
> 
> 时间：2013-01-20T00:03:17.003
> 
> 标签：android, eclipse, android-emulator

我昨天从 Android 开发者网站下载了 64 位 SDK ADT 包。我还下载并安装了 64 位 Java SDK 6。我一直在尝试按照 Android 网站上的教程来构建 Hello World 应用程序。我可以在 Eclipse 中创建应用程序，也可以创建 AVD。但是，当我转到 Run as -> Android Application 时，什么也没有发生。我可以从 Eclipse 手动启动 Android 模拟器，但我仍然无法安装应用程序或执行任何操作。

没有错误，没有控制台输出，什么都没有。

如果我只是单击“运行”按钮，我会收到此错误：`Path for project must have only one segment`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T01:40:45.820

好的，我发现了问题。在“属性”>“运行/调试设置”下，我忘记设置项目名称。

![在此处输入图像描述](../Images/9f51f48e63aa013df4141f5ce0151c21.png)

# c++ - 如何在支持 C++11 的 Windows 上安装 64 位 Qt？

> ID：14420292
> 
> 赞同：13
> 
> 时间：2013-01-20T00:03:38.900
> 
> 标签：c++, visual-studio, qt, c++11, 64-bit

**简而言之：**

1.  我的 64 位 Qt 版本不支持 C++11。
2.  我使用 C++11 构建的 Qt 是 32 位的。
3.  使用在线安装程序的 Qt5 是 32 位的
4.  尽管我生命中的最后 3 天一直致力于此，但我无法从源代码构建 64 位 Qt5。

帮助！我的环境中一定有一些不兼容的东西，但它可能是什么？

* * *

因此，我需要在 Windows 上使用 C++11 开发 64 位 Qt 应用程序。我在[这里](https://stackoverflow.com/questions/11066068/how-to-program-c11-using-qt5)、[这里](https://stackoverflow.com/questions/12113400/compiling-qt-4-8-x-for-visual-studio-2012)、[这里](http://www.holoborodko.com/pavel/2011/02/01/how-to-compile-qt-4-7-with-visual-studio-2010/#comment-7546)、[这里](http://qt-project.org/wiki/Building_Qt_5_from_Git#b50aae10a392d80cb2253ce34e686ae3)和[这里](http://duganchen.ca/building-64-bit-qt-apps-on-windows/)找到了线程/指南，但它们都没有工作或适用，尽管我注意到其中的第二个让我构建了支持 C++11 的 Qt 4.8.3（但 32 位）。第三个看起来比它应该的更复杂，并且还涉及使用 VS 2010 进行构建，这似乎是问题的一部分，所以我没有尝试过。我还浪费了很多时间尝试使用不同的编译器构建以前的版本，比如 mingw 和 clang，所以我很确定 cl 是我需要使用的。

基本上，我已经到了可以在 QtCreator 2.6.1 中构建 Qt4.8.3 并执行 64 位应用程序的地步，但我无法获得完整的 C++11 支持。它只从 VS 10.0 中找到 cl，它只有非常有限的 C++11 支持。弄清楚如何让它使用 cl 从 VS 11.0 将是我的问题的一种解决方案。但是当我尝试

> QMAKE_CXX = C:/Program Files (x86)/Microsoft Visual Studio 11.0/VC/bin/cl

构建失败并出现`jom`错误 2，如果我选择构建选项，`nmake`我会收到类似的错误。

Qt 5 应该有完整的 C++11 支持。但是当我尝试从源代码自己构建它时，它失败了。其原因似乎是，尽管从 VS2012 x64 Cross Tools 命令提示符运行 configure/make，`-platform win32-2012`在配置步骤中指定，并`QMAKE_COMPILER_DEFINES += _MSC_VER=1700 WIN32`根据
[本指南](https://stackoverflow.com/questions/12113400/compiling-qt-4-8-x-for-visual-studio-2012)指定，在 win32-msvc2010 和 win32-msvc2012 mkspecs 中，它仍然构建使用 VS 2010 中的 cl，这会导致某种冲突。这是我的`configure`命令：

> 配置 -static -debug-and-release -confirm-license -opensource -nomake 测试 -nomake 示例 -opengl desktop -no-libjpeg -platform win32-msvc2012

这是我尝试构建时的链接器故障：

![这是我的构建失败的输出：](../Images/e9dbb582dffb752fd8328a6925f0dd2c.png)

在前 2 段的末尾，您可以看到 msvc-2010 被包含在内，并且在控制台输出（未显示）的前面有`-D_MSC_VER=1600`命令`moc`。

所以我很茫然，有人可以帮忙吗？

**编辑**：我说过我正在使用 Qt5 构建 64 位应用程序，实际上我能够在 Qt 4.8.3 的构建中构建 64 位应用程序（不支持 C++11）。如果我用 Qt5 尝试这个，我会得到这个错误：

> LNK1112：模块机器类型“X86”与目标机器类型“x64”冲突

所以这会导致在 64 位模式下编译 Qt5，而我似乎无法做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T07:27:23.407

最后通过返回并在 64 位模式下重建 4.8.3 得到了一个“足够好”的解决方案，这次确保它是在 C++11 支持下构建的。由于涉及 Qt5 的解决方案是理想的，我将把它打开一段时间，看看是否有人能弄清楚如何做到这一点。

重要的是，我注意到我在尝试构建 5.0 时使用**的相同提示**成功构建了 64 位、支持 C++11 的 4.8.3 。只是改变了目录。所以同样的环境，一切。而且我还下载了 Qt5 所需的所有额外先决条件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T15:10:51.460

您可以在此处找到支持 64 位的 Qt 5.0.1 SDK 预构建： [http ://releases.qt-project.org/digia/5.0.1/latest/](http://releases.qt-project.org/digia/5.0.1/latest/)

测试和工作:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-23T13:32:14.157

`https://download.qt.io/archive/qt/4.8/4.8.5/`我在VC++ 项目中找到了 Qt 4.8.5 windows 版本 qt-win-opensource-4.8.5-vs2008.exe 。

# android - 使用 int 变量有什么问题？使应用程序崩溃

> ID：14420294
> 
> 赞同：0
> 
> 时间：2013-01-20T00:04:15.017
> 
> 标签：android, eclipse

这是我的 MainActivity.java 我在某些行上使用 // 标记为未使用，发现以 int t = 开头的行是导致应用程序崩溃并强制关闭的问题。

```
package com.example.camera_test;

import android.os.Build;
import android.os.Bundle;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Intent;
import android.graphics.Bitmap;
import android.hardware.Camera;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;

public class MainActivity extends Activity {

    private static final int CAMERA_PIC_REQUEST = 1337; 
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button button = (Button) findViewById(R.id.button1);

        button.setOnClickListener(new OnClickListener()
        {
        @SuppressLint("NewApi") @Override
        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            Intent intent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE );

            startActivityForResult( intent, CAMERA_PIC_REQUEST );
        }
        });

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
    @SuppressLint("NewApi") protected void onActivityResult(int requestCode, int resultCode, Intent data) {  
        if (requestCode == CAMERA_PIC_REQUEST) {  
        // do something
            Bitmap thumbnail = (Bitmap) data.getExtras().get("data");
            int t = thumbnail.getByteCount();
            TextView age = (TextView) findViewById(R.id.textView1);
            age.setText(Integer.toString(t));
            ImageView image = (ImageView) findViewById(R.id.imageView1);
            image.setImageBitmap(thumbnail);
        }  
       }  
} 
```

我添加了一个按钮，当我点击它时，它会在我拍照后打开我设备上的相机，它会在一个小窗口上显示我拍摄的照片。它正在工作。

然后我添加了这 3 行：

```
int t = thumbnail.getByteCount();
TextView age = (TextView) findViewById(R.id.textView1);
age.setText(Integer.toString(t)); 
```

我还想在我的设备屏幕上显示图像的 ByteCount。

一旦我添加了这一行： int t = thumbnail.getByteCount(); 有一个错误，所以我做了自动修复，它添加了 @SuppressLint("NewApi")

然后我标记了 // 这 3 行，一旦我取消标记并使用了 int t = thumbnail.getByteCount(); 所以在我拍完照片后它崩溃了并告诉我它需要强制关闭。

为什么它会在这条线上崩溃？

这是文件activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:layout_marginRight="45dp"
        android:layout_marginTop="62dp"
        android:text="Activate The Camera" />
    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/ic_launcher" />
</RelativeLayout> 
```

1.  我不知道为什么它会与 int t 线一起崩溃。

2.  我在 int t 行上添加了一个断点，但是当我添加断点时它永远不会停在那里，也永远不会在我的应用程序的任何地方停止，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:09:26.463

getByteCount() 可从 API 级别 12 (android 3.1+) 获得。您确定您正在构建/运行此版本或更高版本吗？

另外请在功能中添加LogCat，更容易找到错误。

# twitter-bootstrap - 带有 CKEditor 的引导程序等于问题

> ID：14420300
> 
> 赞同：13
> 
> 时间：2013-01-20T00:05:39.243
> 
> 标签：twitter-bootstrap, ckeditor, z-index, field, instance

我正在尝试创建一个包含 CKEditor 实例的引导模式，但是有很多问题......

所以基本上这些字段没有启用，它们看起来不像，但我无法与它们交互。有人对这种奇怪的行为有解决方案吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-09-01T01:32:36.730

FWIW，我无法让[Peter 的解决方案](https://stackoverflow.com/a/16865664/185839)正常工作，但以下内容对我有用，并且仍然将 hack 保存在单独的文件中，因此您不必编辑任何 Bootstrap 源文件：

```
// bootstrap-ckeditor-modal-fix.js
// hack to fix ckeditor/bootstrap compatiability bug when ckeditor appears in a bootstrap modal dialog
//
// Include this AFTER both bootstrap and ckeditor are loaded.

$.fn.modal.Constructor.prototype.enforceFocus = function() {
  modal_this = this
  $(document).on('focusin.modal', function (e) {
    if (modal_this.$element[0] !== e.target && !modal_this.$element.has(e.target).length 
    && !$(e.target.parentNode).hasClass('cke_dialog_ui_input_select') 
    && !$(e.target.parentNode).hasClass('cke_dialog_ui_input_text')) {
      modal_this.$element.focus()
    }
  })
}; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-01-06T01:06:03.760

我刚刚`tabindex`从模态容器中删除了该属性，这似乎为我解决了这个问题。

这是**胖子**在这里建议的：[https ://github.com/twbs/bootstrap/issues/6996](https://github.com/twbs/bootstrap/issues/6996)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-09-27T07:59:41.730

如果上述所有解决方案都不适合您，请尝试以下操作：

```
 $('#myModal').on('shown.bs.modal', function() {
        $(document).off('focusin.modal');
    }); 
```

它立即对我有用。这是来源：[tobiv的答案 - github](https://github.com/limonte/sweetalert2/issues/374)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-31T20:42:42.643

我没有弄乱 Bootstrap 源，而是重新附加了焦点事件处理程序。

我查看了 Bootstrap 模态（未缩小）代码，以找到在 Modal.enforceFocus() 下定义事件处理程序的位置：

```
var that = this
$(document).on('focusin.modal', function (e) {
  if (that.$element[0] !== e.target && !that.$element.has(e.target).length) {
    that.$element.focus()
  }
}) 
```

然后我向 CKEditor 添加了一个方法来修改这个函数。你可以把它放在任何地方；也许在一个仅用于 CKEditor 覆盖的文件中。

```
CKEDITOR.bootstrapModalFix = function (modal, $) {
  modal.on('shown', function () {
    var that = $(this).data('modal');
    $(document)
      .off('focusin.modal')
      .on('focusin.modal', function (e) {
        // Add this line
        if( e.target.className && e.target.className.indexOf('cke_') == 0 ) return;

        // Original
        if (that.$element[0] !== e.target && !that.$element.has(e.target).length) {
          that.$element.focus()
        }
      });
  });
}; 
```

所以现在，如果我知道我要在 Bootstrap 模式中加载一个 CKEditor，我调用这个方法，假设 jQuery 是`$`：

```
CKEDITOR.bootstrapModalFix( $('#myModal'), $ ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T14:27:12.640

嘿，我遇到了这些问题。我发现这张票[https://github.com/twitter/bootstrap/issues/6996](https://github.com/twitter/bootstrap/issues/6996)似乎解决了我无法选择输入的问题。我将这张票的更改扩展到：

```
if (that.$element[0] !== e.target && !that.$element.has(e.target).length && !$(e.target.parentNode).hasClass('cke_dialog_ui_input_select') && !$(e.target.parentNode).hasClass('cke_dialog_ui_input_text')){ 
```

这允许选择和输入一样可用，尽管重复选择器有点笨拙，但它确实修复了错误。希望这对您有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-27T10:43:04.450

bootstrap modal 的 z-index 高于 ckeditor 面板的 z-index。因此，我发现的另一种解决方案是增加 ckeditor 的 z-index。将以下行添加到 ckeditor config.js

```
// app/assets/javascripts/ckeditor/config.js
config.baseFloatZIndex = 1E5; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-04-26T08:48:42.867

我在**React-Boostrap Modal**中使用 CKEditor 。我在 Wiris Mathtype 编辑器中遇到了焦点问题。我尝试了以下两种方法来解决我的问题。

当 Modal 组件加载时粘贴下面的脚本

```
document.getElementsByClassName('modal')[0].removeAttribute('tabindex') 
```

或者

将此属性添加到模态组件

```
enforceFocus={false} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-15T00:04:29.930

工作示例在这里：http: [//jsfiddle.net/pvkovalev/4PACy/](http://jsfiddle.net/pvkovalev/4PACy/)

```
 $.fn.modal.Constructor.prototype.enforceFocus = function () {
            modal_this = this
            $(document).on('focusin.modal', function (e) {
                if (modal_this.$element[0] !== e.target && !modal_this.$element.has(e.target).length
                // add whatever conditions you need here:
                &&
                !$(e.target.parentNode).hasClass('cke_dialog_ui_input_select') && !$(e.target.parentNode).hasClass('cke_dialog_ui_input_text')) {
                    modal_this.$element.focus()
                }
            })
        }; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-31T21:25:05.680

Bootstrap 将 focusin.modal 更改为 shown.bs.modal

```
 $.fn.modal.Constructor.prototype.enforceFocus = function() {
  modal_this = this
  $(document).on('shown.bs.modal', function (e) {
    if (modal_this.$element[0] !== e.target && !modal_this.$element.has(e.target).length 
    && !$(e.target.parentNode).hasClass('cke_dialog_ui_input_select') 
    && !$(e.target.parentNode).hasClass('cke_dialog_ui_input_text')) {
      modal_this.$element.focus()
    }
  })
}; 
```

这对我有用。

# php - DocumentFragment 中的返回元素失败，因为节点不再存在

> ID：14420302
> 
> 赞同：0
> 
> 时间：2013-01-20T00:05:51.483
> 
> 标签：php, garbage-collection, creation

这是一个突出显示我遇到的错误的测试用例。我认为在函数返回后节点正在被销毁/垃圾收集/某些东西 - 有没有更好的方法可以解决这个问题？

```
function render($doc) {

    $fragment = $doc -> createDocumentFragment();
    $fragment -> appendXML('<iframe foo="bar"/>');
    return $fragment -> childNodes -> item(0);
}

$doc = new \DOMDocument();
$element = render($doc);

// Exception: Couldn't fetch DOMElement. Node no longer exists
echo $element -> tagName; // fails -- because element no longer exists 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:12:49.657

由于您只创建一个元素，因此无需制作片段。只需创建元素并设置其属性。

```
function render($doc) {

    $element = $doc -> createElement('iframe');
    $element -> setAttribute('foo', 'bar');
    return element;
}

$doc = new DOMDocument();
$element = render($doc);

echo $element -> tagName; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T16:09:13.813

我找到了一种解决方法：只需调用 cloneNode() 并返回克隆：

`return $element->cloneNode();`

我同意这是一种奇怪的行为......我不明白 PHP 为什么会这样做，但至少有一种解决方法仍然允许您使用文档片段。对于更复杂的片段，您可能需要传递`true`给 cloneNode 以告诉它进行深层复制，我不确定。

# python - Django：带有附加字段的 CreateView？

> ID：14420306
> 
> 赞同：4
> 
> 时间：2013-01-20T00:06:25.197
> 
> 标签：python, django, forms, django-class-based-views

我正在尝试编写一个 Django CreateView (CBV)，它使用用户电子邮件而不是用户 ID，并根据电子邮件确定（或创建）用户。

我的模型不包含任何特殊内容：

```
class Project(models.Model):
    name = models.CharField(_('Title'), max_length=100,)
    user = models.ForeignKey(User, verbose_name=_('user'),)
    ... 
```

我的 forms.py 将额外的电子邮件字段添加到表单中：

```
class ProjectCreateForm(forms.ModelForm):
    email = forms.EmailField(required=True, )

    class Meta:
        model = Project
        fields = ('name', ...,) 
```

在我的views.py 中，我试图确定用户是否存在或应该被创建。在这两种情况下，用户 ID 都应保存为 Project 实例的一部分。

```
class ProjectCreateDetails(CreateView):
    form_class = ProjectCreateForm
    template_name = '...'
    success_url = reverse_lazy('login') 
    model = Project

    def form_valid(self, form):
        try:
            user = User.objects.get(email=form.email)
        except User.DoesNotExist:
            user = User.objects.create_user(form.email, form.email, ''.join([random.choice(string.digits + string.letters) for i in range(0, 10)]))
            user.save()
        form.instance.user = user
        return super(ProjectCreateDetails, self).form_valid(form) 
```

**但是我面临一个错误，即`'Solution' object has no attribute 'email'`.**

我是否需要切换到 FormView 而不是 CreateView？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T00:29:30.470

您收到错误`'Solution' object has no attribute 'email'`是因为`form.email`无效。验证数据永远不能作为表单或模型表单的属性。当表单（包括模型表单）有效时，成功验证的数据在[`form.cleaned_data`](https://docs.djangoproject.com/en/dev/topics/forms/#processing-the-data-from-a-form)字典中可用。

请注意，您不需要调用`user.save()`. 该`create_user`调用已将用户添加到数据库中。您也不必生成随机密码——如果`password`是`None`，那么[`create_user`](https://docs.djangoproject.com/en/dev/ref/contrib/auth/#django.contrib.auth.models.UserManager.create_user)将设​​置一个不可用的密码。

最后，确保您没有`user`在`ProjectCreateForm`. 你可能不知道，但你的代码说`fields = ('name', ...,)`所以我不能确定。

把它放在一起，你会得到以下（未经测试的）代码：

```
def form_valid(self, form):
    try:
        user = User.objects.get(email=form.cleaned_data['email'])
    except User.DoesNotExist:
        user = User.objects.create_user(form.cleaned_data['email'], form.cleaned_data['email']) 
    form.instance.user = user
    return super(ProjectCreateDetails, self).form_valid(form) 
```

# php - 加快 fsockopen

> ID：14420308
> 
> 赞同：1
> 
> 时间：2013-01-20T00:06:42.567
> 
> 标签：php, performance, sockets, irc, fsockopen

我有一个连接到 irc 服务器并在连接期间发送一些命令的套接字。

看起来像这样：

```
 $socket = @fsockopen(IRCIP, IRCPORT, $errno, $errstr, IMEOUT);
    stream_set_timeout($socket, TIMEOUT);
        fputs($socket, "SVSLIST\n"); 
```

但这需要一点时间（大多数情况下，0.5 秒，但有时最多 1.5 秒）更不用说 php 脚本和 irc 服务器都在同一台机器上工作。

所以我想问我怎样才能加快这个过程？我正在使用具有不同机制的readfile（在该irc服务器中构建一个httpd服务器作为模块并重定向readfile以进行查询）来做到这一点，它非常快..有没有办法提高速度？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:19:30.517

fsockopen() 的最后一个参数是超时时间，将其设置为较低的值可以使脚本更快地完成，如下所示：

```
$socket = @fsockopen(IRCIP, IRCPORT, $errno, $errstr, 0.1); 
```

另外......你必须知道这段代码：

```
$socket = fsockopen('www.mysite.com', 80); 
```

比：

```
$socket = fsockopen(gethostbyname('www.mysite.com'=, 80); 
```

最后一件事...如果您的脚本必须在 IRC 服务器的同一台机器上本地运行，只需使用 127.0.0.1 连接而不是机器公共 IP 地址。

# jmeter - 是否有支持 JSON 和 HTML 可视化的 Jmeter 侦听器？

> ID：14420310
> 
> 赞同：-1
> 
> 时间：2013-01-20T00:06:58.920
> 
> 标签：jmeter

Jmeter 监听器只能显示原始 html 响应结果。任何听众都可以像网络浏览器一样以图形方式显示？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T01:11:17.957

> Jmeter 监听器只能显示原始 html 响应结果。

你说的是哪一个？

* * *

对于[查看结果树](http://jmeter.apache.org/usermanual/component_reference.html#View_Results_Tree)侦听器，您可以选择显示响应的方式，请查看文档以获取详细信息：

```
There are several ways to view the response,
selectable by a drop-down box at the bottom of the left hand panel. 
    - HTML 
    - HTML (download resources) 
    - JSON 
    - Regexp Tester 
    - Text 
    - XML 
```

包括 HTML：

> HTML 视图尝试将响应呈现为 HTML。呈现的 HTML 可能与在任何 Web 浏览器中获得的视图相比很差；但是，它确实提供了有助于初始结果评估的快速近似值。没有下载图像等。如果选择了 HTML（下载嵌入式资源）选项，渲染器可以下载 HTML 引用的图像和样式表等。

![在此处输入图像描述](../Images/452e6cec0e2a286bb49538c7fc6ee289.png)

* * *

将响应保存[到文件](http://jmeter.apache.org/usermanual/component_reference.html#Save_Responses_to_a_file)也可能很有用，尽管它不呈现响应但允许将所有响应存储为本地单独的文件。

# android - 如何使用 NDK 定位多个架构？

> ID：14420312
> 
> 赞同：28
> 
> 时间：2013-01-20T00:07:18.317
> 
> 标签：android, android-ndk, java-native-interface, cpu-architecture

## 背景

我最近开始使用 NDK 开发一些代码，并且我想到了在使用 NDK 开发时可能出现的可移植性问题。

## 问题

由于 NDK 使用本机代码，因此需要按 CPU 架构进行编译。这是一个问题，因为无论设备具有什么 CPU，用户都需要运行应用程序。

## 到目前为止我找到的可能的解决方案

我注意到我可以修改文件“jni/Application.mk”并使用：

> APP_ABI := armeabi armeabi-v7a x86

但是，我不知道从这一步开始我应该做什么。应用程序是否会包含每个 CPU 架构的所有编译代码，并在运行时自动选择正确的代码？

另外，如果会有另一个未知的 CPU 架构怎么办？

如果我尝试在 Google TV 上运行该应用程序会发生什么，根据我的记忆，它根本不支持 NDK？

我发现的另一个解决方案是多 apk 支持。但是，我不确定我是否理解它。这是否意味着您每次都使用不同的配置创建相同的 APK？没有来自 ADT 的特殊自动化工具来帮助解决这个问题？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-20T08:55:21.657

如果您根本不设置`APP_ABI`，或者使用

```
APP_ABI := all 
```

在您的**Application.mk**中，然后**ndk-build**将为您的 NDK 版本支持的所有架构构建。迄今为止，最新的 r8d`armeabi armeabi-v7a x86`还将为`mips`. 当另一个架构发布时，您有望自动获得构建来支持它的 APK。

当您的应用程序安装在 Android 设备上时，系统会自动选择匹配的 ABI 版本并从 APK 安装正确的共享库。

这种方法的一个缺点是，如果原生库很大，您的“单体”APK 文件可能会变得很大。您可以使用多 APK 方法来减少用户下载量。[官网](http://developer.android.com/google/play/publishing/multiple-apks.html)建议：*只有当你的 APK 太大（大于 50MB）时，你才应该使用多个 APK 来支持不同的设备*配置。如果您选择此路线，则应仔细遵循版本代码准则。

不幸的是，关于 Google TV 上的 NDK 支持没有可靠的预言，但目前不可用似乎没有技术上的理由。如果它到达，您的**ndk-build**将自动处理它。

**更新** [这](https://stackoverflow.com/a/20029256/192373)是维护拆分APK的简单过程。顺便说一句，新的 Android TV 确实支持 NDK。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-14T10:06:27.770

对于最新版本（现在为 r9），您必须在“jni/Application.mk”中指定

```
APP_ABI := all 
```

或者

```
APP_ABI := armeabi armeabi-v7a x86 mips 
```

没有 ./ndk_build 只会构建“armeabi”

# ember.js - 使用 Jasmine 和 DS.FixtureAdapter 测试 Ember 数据

> ID：14420313
> 
> 赞同：1
> 
> 时间：2013-01-20T00:07:21.497
> 
> 标签：ember.js, jasmine, ember-data

我正在尝试使用 DS.FixtureAdapter 对 ember-data 进行 Jasmine 测试（使用当前主机）。我已经尝试了以下代码的数十种变体（尝试创建和不尝试创建应用程序命名空间）。我还进入了 ember-data 源尝试查看发生了什么，并引用了 ember-data 本身中的测试作为示例。

我还尝试了 Person.find(1) 的变体，使用 Ember.run 块和 Jasmine wait()'s。

无论我尝试什么，`store.find(Person, 'test')`都会返回一个结果，但尝试获取其中一个属性会导致 null （测试断言失败）。我没看到什么？谢谢你的帮助！

```
describe "a test", ->
  store = null
  Person = null

  beforeEach ->

    store = DS.Store.create
      revision: 11
      adapter: 'DS.FixtureAdapter'

    Person = DS.Model.extend
      firstName: DS.attr('string')
      lastName: DS.attr('string')
      age: DS.attr('number')

  it "works or does it", ->
    Person.FIXTURES = [{
      id: 'test'
      firstName: 'Kyle'
      lastName: 'Stevens'
      age: 30
      }]

    kyle = store.find(Person, 'test')
    expect(Em.get(kyle, 'firstName')).toEqual('Kyle') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T07:34:45.127

> 无论我尝试什么， store.find(Person, 'test') 都会返回一个结果，但尝试获取其中一个属性会导致 null （测试断言失败）。我没看到什么？谢谢你的帮助！

这是一个时间问题。当您调用`store.find()`它时，它会异步运行查询并返回模型承诺。这意味着当控制权返回到您的测试时，查询仍在运行（或计划运行），从而导致预期失败。

这就是我们喜欢 ember 的地方，这意味着您的应用程序可以将 kyle 视为数据存在，并相信当数据可用时，值将通过绑定自动更新。

当然，当它阻止你的测试通过时，所有这些魔法并不是那么好。以下是一些替代方法：

1) 注册`didLoad`回调

```
kyle = store.find(Person, 'test');
kyle.on('didLoad', function() {
  console.log('should = kyle: ', Em.get(kyle, 'firstName'));
}); 
```

2) 而不是`didLoad`可以使用更多的黑盒测试方法，只需在调用 find 后 100 毫秒内验证名称是否正确设置 - 当然这会导致脆弱的测试 Ember.run.later(this, function() { console.log ('should = kyle: ', Em.get(kyle, 'firstName')); console.log('should = kim: ', Em.get(App.kim, 'firstName')); }, 100);

我相信在 jasmine 测试中，您可以将设置代码包装在 runs() 方法中，并用于`waitsFor`验证该值是否已按预期设置：

```
 waitsFor(function() {
    return Em.get(kyle, 'firstName') == 'Kyle';
  }, "x to be set to 5", 100); 
```

请参阅此 JSBIN 以了解工作（非茉莉花）示例：http: [//jsbin.com/apurac/4/edit](http://jsbin.com/apurac/4/edit)

有关使用 jasmine 进行异步测试的提示，请参阅这篇文章：http: [//blog.caplin.com/2012/01/17/testing-asynchronous-javascript-with-jasmine/](http://blog.caplin.com/2012/01/17/testing-asynchronous-javascript-with-jasmine/)

此外，请务必`Ember.testing = true`为所有测试设置。有关详细信息，请参阅此 SO 帖子：[是否建议将 Ember.testing = true 设置为单元测试？](https://stackoverflow.com/questions/8785817/is-it-recommended-to-set-ember-testing-true-for-unit-tests/14327471#14327471)

# jquery - jQuery UI Accordion 打开时跳动

> ID：14420315
> 
> 赞同：4
> 
> 时间：2013-01-20T00:08:35.487
> 
> 标签：jquery, jquery-ui, user-interface, accordion

我的页面上有一个手风琴小部件，它在动画打开时扩展超过它应该停止的位置（在动画结束时捕捉回正确的大小），并在它开始动画关闭时捕捉到相同的扩展大小。在我的例子中，手风琴内容应该扩展到 150px，但我在 Chrome 的 Inspect Element 窗口中看到它的动画并看到它短暂地变成了 185px。

我看到其他人建议在将手风琴部分更改为`position: absolute`简单地进行计算时，当它进行大小计算时，填充和/或边距可能会欺骗 jQuery。

[http://jsfiddle.net/shadowycore/T5fnZ/1/](http://jsfiddle.net/shadowycore/T5fnZ/1/)

任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-30T13:50:19.870

我遇到了同样的问题，几个小时后，我终于设法通过添加以下 CSS 来解决它：

```
 .ui-accordion .ui-accordion-content{
      box-sizing:content-box;             
      -moz-box-sizing:content-box;
} 
```

我希望这有帮助

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-08-29T09:41:02.033

溢出：汽车是关键！！如果您检查 jquery 手风琴示例，您会注意到他们的手风琴没有跳转，我发现它归结为 .ui-accordion-content 类的 overflow:auto 样式。

因此，您需要做的就是将 overflow:auto 样式添加到内容类。

```
.ui-accordion .ui-accordion-content{
  overflow:auto;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-18T21:52:43.993

在手风琴内的my和标签上设置`margin:0`and ，跳动消失了。`padding:0``h3``ul`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-02T15:40:06.127

对我来说，它最终只是有人在 .ui-accordion-content 潜水中设置了一个令人毛骨悚然的最小高度......

```
.ui-accordion-content{ min-height: unset; } 
```

为我工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-20T01:41:21.603

它看起来像一种错误。在 jqueryui AIP 示例上也有同样的效果：

[http://api.jqueryui.com/accordion/#entry-examples](http://api.jqueryui.com/accordion/#entry-examples)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-19T20:02:52.520

一个简单的解决方法是将小部件包含在`<div>`标签中，然后将手风琴应用于该标签。否则，手风琴动作会尝试调整边距和填充，这会导致“跳跃”。

# mysql - 的意思 ”？” 在 mysql 查询中

> ID：14420316
> 
> 赞同：3
> 
> 时间：2013-01-20T00:08:45.410
> 
> 标签：mysql, sql

我见过一些（我的）sql查询是这样写的：

```
SELECT ? + 4; 
```

是什么意思`?`？我的猜测是它是某种参数，但是如何指定它的值呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T00:12:14.420

`?`[是准备好的语句语法中](http://dev.mysql.com/doc/refman/5.6/en/sql-syntax-prepared-statements.html)参数值的占位符。链接的文章给出了以下示例：

> ```
> mysql> PREPARE stmt1 FROM 'SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse';
> mysql> SET @a = 3;
> mysql> SET @b = 4;
> mysql> EXECUTE stmt1 USING @a, @b;
> +------------+
> | hypotenuse |
> +------------+
> |          5 |
> +------------+
> mysql> DEALLOCATE PREPARE stmt1; 
> ```

由于您还标记了[sql](/questions/tagged/sql "显示标记为“sql”的问题")，因此值得链接到[Prepared Statement Wikipedia 文章](http://en.wikipedia.org/wiki/Prepared_statement)，以便独立于 MySQL 进一步阅读。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T00:11:56.333

在 mysql 中，a是[准备好的语句](http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-prepared-statements.html)`?`中的占位符。在执行语句之前，它将被客户端绑定的任何值替换。

# c - 在 C 中创建 Mandelbrot 集图的问题

> ID：14420320
> 
> 赞同：0
> 
> 时间：2013-01-20T00:08:56.473
> 
> 标签：c, struct, printf, fractals, mandelbrot

我正在尝试用 C 代码创建一个 Mandelbrot 集；我的输出将是一个数据文件，一列实部和一列虚部要绘制在 Argand 或复平面上。我在标题中定义了所有复杂的数学内容，`complex.h`并且正在使用具有`complex`实`double R`部和`double I`虚部的结构。我正在尝试循环 dz 的谷值并更新 z iter=80 次，或者直到该点位于定义的半径之外。dz 是虚数，基本上在 [(dzrmin + i*dzimin), (dzrmax +i*dzimax)] 范围内。z 是当前复数，更新为 z^2 = dz + z。我有一个`csum()`对两个复数求和的函数和一个`csquare()`对一个复数求平方的函数。这是我的整个代码

```
 #include <stdio.h>
    #include <stdlib.h>
    #include <math.h>
    #include "complex.h"

    int main(void)
    {
        double dzrmin, dzrmax, dzimin, dzimax, dzr,dzi, r0,i0, maxrad; 
        int i,j,k,iter, Ndr,Ndi; 
        complex z, dz; 
        dzrmin = -2.1; 
        dzrmax = 0.6; 
        dzimin = -1.2; 
        dzimax = 1.2; 
        Ndr = 200 ; 
        Ndi = 180; 
        dzr = (dzrmax - dzrmin)/Ndr; 
        dzi = (dzimax - dzimin)/Ndi; 
        r0 = 0.0; 
        i0 = 0.0;
        z.R = r0; 
        z.I = i0; 
        dz.R = dzrmin; 
        dz.I = dzimin; 
        maxrad = 2.0; 
        iter = 80 ; 
        for(i = 0; i < Ndr; i++ )
        {
                    for(j = 0; j < Ndi; j++ )
                    {

                        for(k = 0; k< iter; k++ )
                        {
                    printf("%.6lf %.6lf\n", z.R, z.I ); 
                    z = csum( csquare( z ), dz ) ; 

                    if( cmag(z) > maxrad) k = iter ; 

                }

                dz.I += dzi ; 
            }
            dz.R += dzr; 
            z.R = r0; 
            z.I = i0; 
        }
        return 0; 
    } 
```

和我的头文件`complex.h`

```
#include <stdlib.h>
#include <math.h>
typedef struct complexnumber{ double R; double I ; } complex ;
double cmag( complex z)                                                                                                                                             
{
    return pow( z.R*z.R + z.I*z.I, 0.5 ) ; 
}

complex csquare( complex z )             //returns square of a complex
{
    complex product ; 
    product.R = z.R*z.R - z.I*z.I ; 
    product.I = 2*z.R*z.I ; 
    return product ; 

}

complex csum( complex z1, complex z2) // sums two complex numbers 
{
    complex sum ; 
    sum.R = z1.R + z2.R ; 
    sum.I = z1.I + z2.I; 
    return sum ; 
} 
```

我得到了一些实际值，它们很快变得非常大，并且位于半径 2 之外，然后是很多实部`-nan`和虚部`-nan`。关于我缺少什么的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:41:27.387

我不确定您期望什么结果，但也许这个检测输出将帮助您诊断问题：

```
i = 0
i = 0, j = 0
i = 0, j = 0, k = 0: 0.000000 0.000000
i = 0, j = 1
i = 0, j = 1, k = 0: -2.100000 -1.200000
i = 0, j = 2
i = 0, j = 2, k = 0: 0.870000 3.853333
i = 0, j = 3
i = 0, j = 3, k = 0: -16.191278 5.531467
i = 0, j = 4
i = 0, j = 4, k = 0: 229.460353 -180.283027
i = 0, j = 5
i = 0, j = 5, k = 0: 20147.983719 -82736.760384
i = 0, j = 6
i = 0, j = 6, k = 0: -6439430272.999375 -3333957803.416253
i = 0, j = 7
i = 0, j = 7, k = 0: 30350987605860679680.000000 42937577616442236928.000000
i = 0, j = 8
i = 0, j = 8, k = 0: -922453122916892839668491877362832506880.000000 2606395772124638489891541615388582215680.000000
i = 0, j = 9
i = 0, j = 9, k = 0: -5942379156970062175257857153425511563624711669037998408592102022831643293646848.000000 -4808555839107517668369914051798230293111512606121703008400866410836391727464448.000000
i = 0, j = 10
i = 0, j = 10, k = 0: 12189660787377226979177299907109395027773453611835899247334853368367297050334425366457359535808690377953524893091770076537471791519164311649924318416907272192.000000 57148523986878398200502132726020983696472380197135570914789139569106551459309671849901109020634047615447493780748138450365838320365732961897986301575347306496.000000
i = 0, j = 10, k = 1: nan inf
i = 0, j = 10, k = 2: nan nan 
```

请注意内部循环如何在第一次迭代中一直中断。我认为问题在于`dz`设置为*-2.1 - 1.2i*开始。但是，如果没有您要绘制的曼德布罗曲线的定义，我不知道应该发生什么。

这是由您的代码的这个单文件变体产生的，它使用了与 C99 标准冲突`Complex`的类型。`complex`复杂函数是静态的，因为当我编译时会关闭编译器警告：

```
$ gcc -O3 -g -std=c99 -Wall -Wextra -Wmissing-prototypes -Wstrict-prototypes cx.c -o cx 
```

资源：

```
#include <stdio.h>
#include <math.h>

typedef struct Complex{ double R; double I; } Complex;

static double cmag(Complex z)
{
    return pow(z.R*z.R + z.I*z.I, 0.5);
}

static Complex csquare(Complex z)             //returns square of a complex
{
    Complex product;
    product.R = z.R*z.R - z.I*z.I;
    product.I = 2*z.R*z.I;
    return product;
}

static Complex csum(Complex z1, Complex z2) // sums two complex numbers
{
    Complex sum;
    sum.R = z1.R + z2.R;
    sum.I = z1.I + z2.I;
    return sum;
}

int main(void)
{
    double dzrmin, dzrmax, dzimin, dzimax, dzr, dzi, r0, i0, maxrad;
    int i, j, k, iter, Ndr, Ndi;
    Complex z, dz;
    dzrmin = -2.1;
    dzrmax = 0.6;
    dzimin = -1.2;
    dzimax = 1.2;
    Ndr = 200;
    Ndi = 180;
    dzr = (dzrmax - dzrmin)/Ndr;
    dzi = (dzimax - dzimin)/Ndi;
    r0 = 0.0;
    i0 = 0.0;
    z.R = r0;
    z.I = i0;
    dz.R = dzrmin;
    dz.I = dzimin;
    maxrad = 2.0;
    iter = 80;
    for (i = 0; i < Ndr; i++)
    {
        printf("i = %d\n", i);
        for (j = 0; j < Ndi; j++)
        {
            printf("i = %d, j = %d\n", i, j);
            for (k = 0; k < iter; k++)
            {
                printf("i = %d, j = %d, k = %d: ", i, j, k);
                printf("%.6lf %.6lf\n", z.R, z.I);
                z = csum(csquare(z), dz);
                if (cmag(z) > maxrad)
                    break;
            }
            dz.I += dzi;
        }
        dz.R += dzr;
        z.R = r0;
        z.I = i0;
    }
    return 0;
} 
```

# ios - 将重叠的 UIViewController 放在前面

> ID：14420321
> 
> 赞同：1
> 
> 时间：2013-01-20T00:08:59.140
> 
> 标签：ios, uiviewcontroller, containment, uimodalpresentationstyle

我目前在我的 iPhone 应用程序中同时运行三个视图控制器。
我使用[滑动视图](https://github.com/edgecase/ECSlidingViewController/)。

这是我的形象：

![在此处输入图像描述](../Images/c663d01d28f3974ec988061536e1597c.png)

当我点击表格视图单元格时，我想打开一个新的视图控制器，如下所示：

![在此处输入图像描述](../Images/6da55c8ab9a5f6f434e3d7d31e3ebcbf.png)

（鸡蛋代表一个新的视图控制器。

但是你可以看到我的橙色视图控制器在前面。

我该如何改变？

我用来打开的代码`egg-viewcontroller`：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    UIViewController *boxView = [self.storyboard instantiateViewControllerWithIdentifier:@"BoxView"];
    boxView.modalPresentationStyle = UIModalPresentationFormSheet;
    boxView.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
    boxView.view.frame=CGRectMake(-50, 5, 300, 470);
    [self.view addSubview:boxView.view];
    //[self.view bringSubviewToFront:boxView];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T05:45:19.930

这应该很容易，您需要您的父视图控制器（即橙色控制器）来添加新视图控制器的子视图。您通常可以通过 `[self.parentViewController addSubview:boxView.view]`. 但由于您使用的是 ECSlidingViewController ，您可以这样做 `[self.slidingViewController.topViewController.view addSubview:boxView.view]`：

当然，您需要相应地调整新 ViewController 的框架。

# iphone - 如何在 UITableView 上延迟加载文本？

> ID：14420323
> 
> 赞同：1
> 
> 时间：2013-01-20T00:09:13.993
> 
> 标签：iphone, ios, xcode, cocoa-touch, uitableview

我有一个带有标准单元格的标准 UITableView（意味着没有修改）。每个单元格都需要从不同的 Web URL 提取文本：

```
cell.textLabel.text = [self getTitleFromURL:myURL]; 
```

当然，在主线程上调用 URL 不是你想做的。那么我该怎么做呢？我已经尝试过类似的东西（我从另一个 StackOverflow 帖子中得到）但它不起作用：

```
dispatch_async( dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

            NSString *title = [self getTitleFromURL:myURL];

            dispatch_async( dispatch_get_main_queue(), ^{

                cell.textLabel.text = title;

            });
        }); 
```

想法？我可能在这里遗漏了一些非常简单的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:24:50.607

将异步数据加载到表中时需要注意的一件事 - 当数据到达时，单元格可能已经滚动到屏幕外，更糟糕的是，可能已被重用于数据数组中的不同条目。

因此，在您返回主线程时，您需要检查信息是否仍然相关，并且不要假设将其发布到哪个单元格......

```
if ([[tableView indexPathsForVisibleRows] containsObject:indexPath]) {
      UITableViewCell * correctCell = [self.tableView cellForRowAtIndexPath:indexPath];
                correctCell.textLabel.text = title;
                [correctCell setNeedsLayout];
             } 
```

您可能还需要告诉单元格使用 setNeedsLayout 更新自身。

# jpa - JPA 2.0：@AttributeOverrides 和继承的属性不能很好地相互配合

> ID：14420327
> 
> 赞同：6
> 
> 时间：2013-01-20T00:09:37.483
> 
> 标签：jpa, jpa-2.0

我需要下一个问题的帮助，这似乎与这个问题非常[相似](https://stackoverflow.com/questions/9845575/nested-embeddable-attributeoverride-for-embeddable-within-embeddable)。但是，建议的解决方案不适用于我的情况。我有标记为@Embbedable 的RoadDistance 类和标记为@Embbedable 的RoadMetricLoader 类，它包含两个RoadDistante 类型的属性。还有类 RoadConnection，它是一个实体，包括 RoadmetricLoader 类型的属性。我没有成功为 RoadDistance 类覆盖 RoadMetricLoader 的属性 (@AttributeOverride)（我没有在 ROAD_CONNECTION 表中获得字段 ROAD_ESTIMATED_DISTANCE_VALUE、ROAD_ESTIMATED_DISTANCE_UNIT_ID、ROAD_REAL_DISTANCE_VALUE 和 ROAD_REAL_DISTANCE_UNIT_ID）

数据库是 MySQL 5.2.21，用于 JPA 2.0 的库是来自 EclipseLink 2.4.1 的库

我尝试了不同的选项，但它们都不起作用。我在代码中的注释块中显示了所有选项，您可以在下面看到。当未注释一个选项时，请保留其他选项。这些是我在每种情况下得到的结果：

**选项 1**：它不返回任何错误，但在 ROAD_CONNECTION 表中我只得到两个字段：VALUE 和 UNIT_ID。

**选项 2**：与选项 1 相同的结果。

**选项 3**：这是我的第一个赌注（请参阅[官方文档示例 2](http://docs.oracle.com/javaee/6/api/javax/persistence/AttributeOverride.html)，以及上面已经指出的链接），但我收到下一个错误

```
Local Exception Stack: 
Exception [EclipseLink-30005] (Eclipse Persistence Services - 2.4.1.v20121003-ad44345): org.eclipse.persistence.exceptions.PersistenceUnitLoadingException
Exception Description: An exception was thrown while searching for persistence archives with ClassLoader: sun.misc.Launcher$AppClassLoader@138d107f
Internal Exception: javax.persistence.PersistenceException: Exception [EclipseLink-28018] (Eclipse Persistence Services - 2.4.1.v20121003-ad44345): org.eclipse.persistence.exceptions.EntityManagerSetupException
Exception Description: Predeployment of PersistenceUnit [jamUnit] failed.
Internal Exception: Exception [EclipseLink-7309] (Eclipse Persistence Services - 2.4.1.v20121003-ad44345): org.eclipse.persistence.exceptions.ValidationException
Exception Description: The attribute named [estimatedRoadDistance.unit] from the embeddable class [class net.question.RoadMetricLoader] is not a valid mapping to use with an attribute override for the attribute [metricLoader] on class [class net.question.RoadConnection].
    at org.eclipse.persistence.exceptions.PersistenceUnitLoadingException.exceptionSearchingForPersistenceResources(PersistenceUnitLoadingException.java:127)
    at org.eclipse.persistence.jpa.PersistenceProvider.createEntityManagerFactory(PersistenceProvider.java:118)
    at javax.persistence.Persistence.createEntityManagerFactory(Unknown Source)
    at javax.persistence.Persistence.createEntityManagerFactory(Unknown Source)
    (...) 
```

**选项 4**：与选项 1 和 2 相同。

**选项 5**：

```
Local Exception Stack: 
Exception [EclipseLink-30005] (Eclipse Persistence Services - 2.4.1.v20121003-ad44345): org.eclipse.persistence.exceptions.PersistenceUnitLoadingException
Exception Description: An exception was thrown while searching for persistence archives with ClassLoader: sun.misc.Launcher$AppClassLoader@12360be0
Internal Exception: javax.persistence.PersistenceException: Exception [EclipseLink-28018] (Eclipse Persistence Services - 2.4.1.v20121003-ad44345): org.eclipse.persistence.exceptions.EntityManagerSetupException
Exception Description: Predeployment of PersistenceUnit [jamUnit] failed.
Internal Exception: Exception [EclipseLink-7309] (Eclipse Persistence Services - 2.4.1.v20121003-ad44345): org.eclipse.persistence.exceptions.ValidationException
Exception Description: The attribute named [unit] from the embeddable class [class net.question.RoadDistance] is not a valid mapping to use with an attribute override for the attribute [estimatedRoadDistance] on class [class net.question.RoadMetricLoader].
    at org.eclipse.persistence.exceptions.PersistenceUnitLoadingException.exceptionSearchingForPersistenceResources(PersistenceUnitLoadingException.java:127)
    at org.eclipse.persistence.jpa.PersistenceProvider.createEntityManagerFactory(PersistenceProvider.java:118)
    at javax.persistence.Persistence.createEntityManagerFactory(Unknown Source)
    at javax.persistence.Persistence.createEntityManagerFactory(Unknown Source)
    (...) 
```

* * *

```
@Entity
@Table(name="UNIT")
public class Unit {

    private Long id;
    private String name;
    private String measureSystemCode;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO, generator="UNIT_SEQ_GENERATOR")
    @SequenceGenerator(name="UNIT_SEQ_GENERATOR", sequenceName="UNIT_SEQ")
    @Column(name = "ID")
    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    @Column(name = "NAME", nullable = false)
    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @Column(name = "MEASURE_SYSTEM_CODE", nullable = false)
    public String getMeasureSystemCode() {
        return measureSystemCode;
    }

    public void setMeasureSystemCode(String measureSystemCode) {
        this.measureSystemCode = measureSystemCode;
    }

} 
```

* * *

```
@MappedSuperclass
public abstract class Metric<V extends Comparable<V>> {

    private V value;
    private Unit unit;

    @Column(name = "VALUE", nullable = false)
    public V getValue() {
        return value;
    }

    public void setValue(V value) {
        this.value = value;
    }

    @ManyToOne
    @JoinColumn(name = "UNIT_ID", nullable = false)
    public Unit getUnit() {
        return unit;
    }

    public void setUnit(Unit unit) {
        this.unit = unit;
    }

} 
```

* * *

```
@MappedSuperclass
public abstract class ScalarPhysicalMetric<M extends Number & Comparable<M>>
extends Metric<M> {

} 
```

* * *

```
@Embeddable
public final class RoadDistance extends ScalarPhysicalMetric<Double> {

} 
```

* * *

```
/*
// -##----------- OPTION 4 ---------->
@AttributeOverrides({
    @AttributeOverride(name = "estimatedRoadDistance.value", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_VALUE")),
    @AttributeOverride(name = "estimatedRoadDistance.unit", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_UNIT_ID")),
    @AttributeOverride(name = "realRoadDistance.value", column = @Column(name = "ROAD_REAL_DISTANCE_VALUE")),
    @AttributeOverride(name = "realRoadDistance.unit", column = @Column(name = "ROAD_REAL_DISTANCE_UNIT_ID"))
})
// <---------- OPTION 4 -----------##-
*/
@Embeddable
public final class RoadMetricLoader {

    private RoadDistance estimatedRoadDistance;
    private RoadDistance realRoadDistance;

    @Embedded
    /*
    // -##----------- OPTION 5 ---------->
    @AttributeOverrides({
        @AttributeOverride(name = "value", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_VALUE")),
        @AttributeOverride(name = "unit", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_UNIT_ID"))
    })
    // <---------- OPTION 5 -----------##-
    */
    public RoadDistance getEstimatedRoadDistance() {
        return estimatedRoadDistance;
    }

    public void setEstimatedRoadDistance(RoadDistance estimatedRoadDistance) {
        this.estimatedRoadDistance = estimatedRoadDistance;
    }

    @Embedded
    /*
    // -##----------- OPTION 5 ---------->
    @AttributeOverrides({
        @AttributeOverride(name = "value", column = @Column(name = "ROAD_REAL_DISTANCE_VALUE")),
        @AttributeOverride(name = "unit", column = @Column(name = "ROAD_REAL_DISTANCE_UNIT_ID"))
    })
    // <---------- OPTION 5 -----------##-
    */
    public RoadDistance getRealRoadDistance() {
        return realRoadDistance;
    }

    public void setRealRoadDistance(RoadDistance realRoadDistance) {
        this.realRoadDistance = realRoadDistance;
    }

} 
```

* * *

```
// -##----------- OPTION 1 ---------->
/*
@AttributeOverrides({
    @AttributeOverride(name = "estimatedRoadDistance.value", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_VALUE")),
    @AttributeOverride(name = "estimatedRoadDistance.unit", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_UNIT_ID")),
    @AttributeOverride(name = "realRoadDistance.value", column = @Column(name = "ROAD_REAL_DISTANCE_VALUE")),
    @AttributeOverride(name = "realRoadDistance.unit", column = @Column(name = "ROAD_REAL_DISTANCE_UNIT_ID"))
})
// <---------- OPTION 1 -----------##-
*/
/*
// -##----------- OPTION 2 ---------->
@AttributeOverrides({
    @AttributeOverride(name = "metricLoader.estimatedRoadDistance.value", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_VALUE")),
    @AttributeOverride(name = "metricLoader.estimatedRoadDistance.unit", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_UNIT_ID")),
    @AttributeOverride(name = "metricLoader.realRoadDistance.value", column = @Column(name = "ROAD_REAL_DISTANCE_VALUE")),
    @AttributeOverride(name = "metricLoader.realRoadDistance.unit", column = @Column(name = "ROAD_REAL_DISTANCE_UNIT_ID"))
})
// <---------- OPTION 2 -----------##-
*/
@Entity
@Table(name="ROAD_CONNECTION")
public class RoadConnection {

    private Long id;
    private String pointA;
    private String pointB;
    private RoadMetricLoader metricLoader;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO, generator="ROAD_CONNECTION_SEQ_GENERATOR")
    @SequenceGenerator(name="ROAD_CONNECTION_SEQ_GENERATOR", sequenceName="ROAD_CONNECTION_SEQ")
    @Column(name = "ID")
    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    @Column(name = "POINT_A", nullable = false)
    public String getPointA() {
        return pointA;
    }

    public void setPointA(String pointA) {
        this.pointA = pointA;
    }

    @Column(name = "POINT_B", nullable = false)
    public String getPointB() {
        return pointB;
    }

    public void setPointB(String pointB) {
        this.pointB = pointB;
    }

    /*
    // -##----------- OPTION 3 ---------->
    @AttributeOverrides({
        @AttributeOverride(name = "estimatedRoadDistance.value", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_VALUE")),
        @AttributeOverride(name = "estimatedRoadDistance.unit", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_UNIT_ID")),
        @AttributeOverride(name = "realRoadDistance.value", column = @Column(name = "ROAD_REAL_DISTANCE_VALUE")),
        @AttributeOverride(name = "realRoadDistance.unit", column = @Column(name = "ROAD_REAL_DISTANCE_UNIT_ID"))
    })
    // <---------- OPTION 3 -----------##-
    */
    @Embedded
    public RoadMetricLoader getMetricLoader() {
        return metricLoader;
    }

    public void setMetricLoader(RoadMetricLoader metricLoader) {
        this.metricLoader = metricLoader;
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T04:10:00.993

AttributeOverride 用于基本映射。您需要的是 AssociationOverride： [http ://docs.oracle.com/javaee/6/api/javax/persistence/AssociationOverride.html](http://docs.oracle.com/javaee/6/api/javax/persistence/AssociationOverride.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T13:11:10.200

正如@Chris 建议的，必须使用 AssociatedOverride。如果您按如下方式更改 RoadMetricLoader：

```
public final class RoadMetricLoader {

    private RoadDistance estimatedRoadDistance;
    private RoadDistance realRoadDistance;

    @Embedded
    @AttributeOverrides({
        @AttributeOverride(name = "value", column = @Column(name = "ROAD_ESTIMATED_DISTANCE_VALUE"))
    })
    @AssociationOverrides({  
        @AssociationOverride(name = "unit", joinColumns = @JoinColumn(name = "ROAD_ESTIMATED_DISTANCE_UNIT_ID"))
    })  
    public RoadDistance getEstimatedRoadDistance() {
        return estimatedRoadDistance;
    }

    public void setEstimatedRoadDistance(RoadDistance estimatedRoadDistance) {
        this.estimatedRoadDistance = estimatedRoadDistance;
    }

    @Embedded
    @AttributeOverrides({
        @AttributeOverride(name = "value", column = @Column(name = "ROAD_REAL_DISTANCE_VALUE"))
    })
    @AssociationOverrides({  
        @AssociationOverride(name = "unit", joinColumns = @JoinColumn(name = "ROAD_REAL_DISTANCE_UNIT_ID"))
    })  
    public RoadDistance getRealRoadDistance() {
        return realRoadDistance;
    }

    public void setRealRoadDistance(RoadDistance realRoadDistance) {
        this.realRoadDistance = realRoadDistance;
    } 
```

现在该表已在数据库中正确创建：

![在此处输入图像描述](../Images/70f95067c9c7e1dd4d5b93ca2411e423.png)

在这种情况下，您也可以去掉@AttributeOverrides 和@AssociationOverrides，因为每个元素只有一个元素。

# sitemap - 如何创建像谷歌地图这样的大型组织结构图？

> ID：14420329
> 
> 赞同：2
> 
> 时间：2013-01-20T00:09:43.770
> 
> 标签：sitemap, data-visualization, tiles, orgchart, mindmap

我不知道javascript（不幸的是），我想制作一个类似于思维导图的“组织结构图[”](http://www.mindomo.com/view?m=d810818269d541a6a9d58d43a383cce5)： ![Mindomo 组织结构图截图](../Images/a9da87bd93796a6e21fe025f9e6b71a6.png)

这个地图应该有类似于google maps的放大缩小功能，以及任意连接节点的能力。所以它更像是一个自由图，而不是一个序数树。Mindomo 做得很好，但它是商业化的和面向闪存的。

有人知道类似的解决方案吗？

我的研究指出这可能是一个 svg 草图，可能是离线生成的，或者可能是使用画布的东西。单击该节点应重定向到某个 Web 位置。

谷歌地图很好，因为它也隐藏了一些细节，所以应该在缩小投影中做这个图表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-10T16:50:23.257

几个重要的问题：你需要根据一些底层数据集实时生成吗？除了缩放之外，用户是否应该能够手动打开/关闭节点？

您可以使用一些免费工具手动生成它：

*   [头脑大师](http://www.mindmeister.com/)
*   [xmind](http://www.xmind.net/)
*   [自由的心灵](http://freemind.sourceforge.net/wiki/index.php/Main_Page)

虽然不是传统的，你可以考虑使用 Prezi 吗？

# node.js - 如何真正为网络应用做负载测试？

> ID：14420331
> 
> 赞同：1
> 
> 时间：2013-01-20T00:10:03.813
> 
> 标签：node.js, networking, testing, load

我想使用 node.js 编写网络服务器应用程序并运行它。要知道它的性能，我需要对其进行负载测试。我怎么做？

*   来自与应用程序相同的计算机？但是可能客户端与服务器应用程序竞争资源。
*   从另一台电脑？
*   使用一些让我能够进行负载测试的在线服务？

请提出方法。

# r - 有没有办法让 merge.xts 保持名称不变？

> ID：14420332
> 
> 赞同：4
> 
> 时间：2013-01-20T00:10:07.790
> 
> 标签：r, xts

我使用 R 的东西很少是性能敏感的，但对于一项缓慢的任务，我已经从使用数据帧切换到`xts`对象，其速度非常令人满意，大约为 10 倍。

但是，我遇到了一个怪癖，就是合并对象`merge.xts`时似乎坚持要检查列名。`xts`文档指出该函数扩展`merge.zoo`并`merge.zoo`确实遵守`check.names = FALSE`，但按照下面的代码不遵守`merge.xts`。

**问：是否可以强制`merge.xts`保持我的列名不变？不是，我可以在简单的对象`merge.zoo`上互换使用（哪个有效）吗？`xts`**

```
library(xts)
set.seed(54321)
xts1 <- xts(runif(5, 100, 200), order.by = seq(as.Date('2013-01-14'),
                                as.Date('2013-01-18'), by = "day"))
xts2 <- xts(runif(5, 1000, 2000), order.by = seq(as.Date('2013-01-14'),
                                  as.Date('2013-01-18'), by = "day"))
names(xts1) <- 'my value 1'
names(xts2) <- 'my value 2'
xts1
xts2
xts.new <- merge.xts(xts1, xts2)
xts.new # names have been changed: unwanted behaviour
xts.new <- merge.xts(xts1, xts2, check.names = FALSE)
xts.new # argument is ignored, instead column called 'check.names' is added
zoo.new <- merge.zoo(xts1, xts2, check.names = FALSE)
zoo.new # check.names argument is honoured, names remain unchanged (good!) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T04:11:15.967

是否不能强制`merge.xts`保持列名不变（没有底层 C 代码的补丁）。

在您的问题中，您`merge.zoo`在 xts 对象上使用了...所以我不确定您的问题是什么。如果您不喜欢这`zoo.new`是一个动物园对象，只需将其包装在`as.xts`.

# c++ - 有没有办法列出 #define 在 c/c++ 中定义的符号

> ID：14420333
> 
> 赞同：0
> 
> 时间：2013-01-20T00:10:09.423
> 
> 标签：c++, c, eclipse, compiler-errors, debug-symbols

我正在使用 eclipse 并在我的 c/c++ 代码中不断收到对 `__assert_func' 错误的未定义引用。

我想知道是否有办法告诉正在定义什么（#define *** *）。我可以手动浏览我的文件，但我正在处理很多文件，这需要一段时间。是否有编译器选项或工具可以为我列出这些？

谢谢，

山姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T00:12:17.117

这取决于编译器。如果您正在运行 GCC，您可以阅读此内容。

[GCC 转储预处理器定义](https://stackoverflow.com/questions/2224334/gcc-dump-preprocessor-defines)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T00:16:32.773

`#define`未定义的引用与s无关。这是一个链接器错误，您可能忘记链接到 .lib/.a 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T00:17:03.137

您通常可以从编译器生成预处理器输出 - 例如`g++ -E myprog.cpp > myprog.i`. 我认为`CL -E`在 Visual Studio 中做同样的事情，其他编译器往往有类似的选项。

听起来您缺少的功能确实是 a `ASSERT`or`assert`宏的一部分。

# mysql - 有条件的不起作用

> ID：14420336
> 
> 赞同：0
> 
> 时间：2013-01-20T00:10:54.790
> 
> 标签：mysql

已经花了一个小时搜索并尝试完成这项工作。开始讨厌mysql。我在这里做错了什么？

```
UPDATE product_reward pr
  LEFT JOIN product p ON (pr.product_id = p.product_id)
  LEFT JOIN product_special ps ON (pr.product_id = ps.product_id)

SELECT CASE ps.price  
  WHEN NULL
    THEN SET pr.points = ROUND(p.price * 1);
  ELSE 
    SET pr.points = ROUND(ps.price * 1);
END; 
```

我尝试使用 normal `IF ELSE`，但显然这只适用于程序内部。仅当特价为 时，我才尝试根据正常价格设置积分`NULL`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:17:44.357

试试这个或者看看[Mysql Update with if 语句](https://stackoverflow.com/questions/5546067/mysql-update-with-if-statement)

```
UPDATE product_reward pr
  LEFT JOIN product p ON (pr.product_id = p.product_id)
  LEFT JOIN product_special ps ON (pr.product_id = ps.product_id)

SET pr.points = ROUND(COALESCE(ps.price, p.price) * 1) 
```

# angularjs - 是否可以在没有 Web 服务器的情况下使用 ng-include？

> ID：14420337
> 
> 赞同：16
> 
> 时间：2013-01-20T00:11:23.683
> 
> 标签：angularjs

我正在运行一个仅包含一个文件的 AngularJS 应用程序

```
<div ng-include src="'sample.html'"></div> 
```

在 Web 服务器下运行时有效。但是，如果 Web 应用程序仅通过从文件资源管理器中双击（即不是从 Web 服务器）运行，则它不包含该文件

ng-include 是否在 Web 服务器之外工作？我检查了 Chrome 上的网络状态，它显示方法上的**选项**，状态上的**加载已取消**

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-20T01:13:10.780

一种解决方法是内联您的模板：

```
<script type="text/ng-template" id="sample.html">
  <div>This is my sample template</div>
</script> 
```

[小提琴](http://jsfiddle.net/mrajcok/pLPL4/)。

这会将您的模板放入 Angular 的模板缓存中。当处理 ng-include 指令时，Angular 首先检查缓存。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-01-20T10:46:52.430

问题是由于`file://`协议。当文件从`file://`. 这就是 AJAX 请求失败的原因。并`ng-include`使用它们下载文件。

您可以使用参数启动 Chrome`--allow-file-access-from-files`以禁用对`file://`.

如果文件在同一个文件夹中，FireFox 应该加载文件（查看[此](https://developer.mozilla.org/en-US/docs/Same-origin_policy_for_file%3a_URIs)以获取更多信息）。

但个人更喜欢启动最简单的 NodeJS 脚本来提供文件，这可以在[angular-seed](https://github.com/angular/angular-seed/blob/master/scripts/web-server.js)项目中找到。它只需要`node`二进制文件，给人一种普通网络服务器的感觉。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-02-04T21:26:38.387

我有一个类似的问题，我通过运行一个简单的 nodejs 服务器来提供静态文件 - [http-server](https://github.com/nodeapps/http-server)来解决它。确保您已安装[nodejs](http://nodejs.org/dist/v0.10.36/node-v0.10.36.pkg)，然后：

安装：

`$ sudo npm install http-server -g`

然后从您的项目目录中：

`$ http-server`

现在您可以从以下位置访问您的文件：

`localhost:8080/whatever-file-you-have-in-your-directory.html`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-20T10:36:34.950

你可以使用 Grunt 和[grunt-html 插件](https://github.com/karlgoldstein/grunt-html2js)来预编译你的模板和你的 Angular 代码。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2015-07-02T15:48:56.500

在您的 xampp 上使用**虚拟主机**是最好的解决方案，并提供自定义名称，例如 yourProject.dev

更新**httpd-vhosts**文件`C:\xampp\apache\conf\extra\httpd-vhosts`

```
<VirtualHost *:80>
        ServerName  yourProject.dev
        ServerAlias www.yourProject.dev  yourProject.com www.yourProject.com
        DocumentRoot "C:\Users\customFolder/yourProject"
        <Directory "C:\Users\customFolder/yourProject">
            DirectoryIndex index.html index.php
            ServerSignature Off
            Options Indexes FollowSymLinks IncludesNoExec
            AllowOverride All
            Allow from all
            Require all granted
      </Directory>
</VirtualHost> 
```

然后将您的主机文件更新为`127.0.0.1 yourProject.dev`

在 Windows 中：`c:\Windows\System32\Drivers\etc\hosts`

在 Mac 中：`/private/etc/hosts`

**别忘了让你的 xampp/wampp 休息一下**

# maven - 在集成测试期间使用不同的配置运行 Spring MVC webapp

> ID：14420339
> 
> 赞同：1
> 
> 时间：2013-01-20T00:11:45.903
> 
> 标签：maven, spring-mvc

我正在使用Maven 构建阶段`maven-jetty-plugin`运行我的 Spring MVC webapp `integration-test`，并在其上运行各种测试。此时，我希望能够切换出一些 Spring 配置，以便在集成测试期间可以指向不同的 bean 实现。这样我就可以更改要运行的数据库，而不是使用生产连接设置。

我应该考虑什么样的方法？我应该尝试对 servlet-context.xml 文件使用资源过滤吗？我应该有两个不同的配置文件吗？如何让它与 Jetty 插件很好地配合使用？

**编辑**：我正在考虑使用 Spring 的基于 Java 的`@Configuration`注释而不是 XML servlet-context 文件，并根据环境变量或类似变量切换我构造的 bean 类型，但这也感觉不对。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T11:45:08.027

我会建议使用spring profile+maven过滤：

1.  在 pom.xml 中定义一个可以通过命令行覆盖的属性：-Dspring.profile.active=development

    ```
     <properties>
                <spring.profile.active>test</spring.profile.active>
         </properties> 
    ```

2.  在 pom.xml 中添加资源过滤。确保您的 web.xml 在目录 src/main/resources 中。

    ```
     <resources>  
           <resource>  
             <directory>src/main/resources</directory>  
             <filtering>true</filtering>  
           </resource>  
     </resources> 
    ```

3.  激活web.xml中具体的spring profile，过滤后会替换${spring.profile.active}。

    ```
    <context-param>  
        <param-name>spring.profiles.active</param-name>  
        <param-value>${spring.profile.active}</param-value>  
    </context-param> 
    ```

4.  在 spring 配置文件中定义 bean

    ```
    <beans profile="production">  
         <jee:jndi-lookup id="dataSource" jndi-name="java:comp/env/jdbc/datasource"/>  
    </beans> 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T16:21:41.010

以前，我总是创建一个包含 jetty-maven-plugin 配置和集成测试配置的配置文件。

但是当我了解 spring-test-mvc 时，我转而使用它，因为你想在使用 jetty-maven-plugin 的集成测试中实现的一切都可以实现。另外，您可以模拟所需的服务（例如，不同应用程序中的身份验证）。

所以我建议切换到spring-test-mvc。恕我直言，jetty-maven-plugin 风格非常痛苦。

# asp.net-mvc - PhoneGap asp.net MVC 4 网络错误

> ID：14420344
> 
> 赞同：-1
> 
> 时间：2013-01-20T00:12:02.000
> 
> 标签：asp.net-mvc, cordova, runtime-error

我用 Visual Studio 发布我的 asp.net MVC 项目，然后将其压缩并上传（使用默认页面 index.html）到 build.phonegap.com 它构建项目没有错误。然后我下载 .apk 但是当存储到我的 android 移动设备时给出这个错误我该怎么办？

这是我发布的项目文件夹

[文件夹](https://d37wxxhohlp07s.cloudfront.net/s3_images/845437/Untitled_inline.png?1358558295)

这是错误：[错误](https://d37wxxhohlp07s.cloudfront.net/s3_images/845419/719389926_inline.jpg?1358555294)

这是我的 index.html 代码

```
<html>
<head>
<script language="javascript">
    window.location.href = "Home/Index"
</head>

<body>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T09:03:20.637

Phonegap 只需要 html。您不能上传 asp.net（或任何其他技术）项目并期望它能够工作。

我建议阅读文档，从这里开始：[https ://build.phonegap.com/docs/preparing-your-app](https://build.phonegap.com/docs/preparing-your-app)

# ios - 由于 UIDatePicker 导致的内存问题

> ID：14420345
> 
> 赞同：0
> 
> 时间：2013-01-20T00:12:02.870
> 
> 标签：ios, cocoa-touch, cocoa

```
- (void)viewDidAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    _datePicker = [[UIDatePicker alloc] init];
    _datePicker.datePickerMode = UIDatePickerModeDate;

    _datePicker.frame = CGRectMake(70, self.view.frame.size.height ,250,100);
    _datePicker.alpha = 0;
    [_datePicker addTarget:self action:@selector(saveDate:)  forControlEvents:UIControlEventEditingDidEnd];
    [self.view addSubview:_datePicker];
} 
```

我试图弄清楚我的“无限内存增长”在哪里，我在我的应用程序中使用了**ARC**。我的应用程序中有一些内存问题，我正试图一一解决。

在 2 个 viewController 之间移动时，我可以清楚地看到内存使用量大幅增加，主要原因是我在这里编写的代码。我做错了什么，我该如何释放它以及在哪里？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:55:49.123

viewDidAppear：每次视图出现时都会被调用（即使控制器已经被初始化）。因此，每次视图出现时，您都在分配一个新的 UIDatePicker 而不释放旧的。

如果您的 datePicker 被定义为带有“retain”的@property，那么我会使用

```
self.datePicker = [[[UIDatePicker alloc] init] autorelease]; 
```

通过使用 self.datePicker 您正在调用合成设置器，它将自动为您释放旧值。

或者，您可以将此初始化移动到 initWithNibName: 或 viewDidLoad: ，这样它只会被调用一次。

试试这个，看看它是否有助于你的记忆。

（我假设你没有使用 ARC，否则我所说的对你没有帮助）。

# jquery - 尝试将 1 添加到拆分字符串

> ID：14420347
> 
> 赞同：0
> 
> 时间：2013-01-20T00:12:06.207
> 
> 标签：jquery

如果时间小于 20:00，我正在尝试`ex: 2013-01-20 00:59:06`通过添加日期来修改检索到的日期。`+1`原因是，如果检索到的时间小于 20:00，则意味着它必须在 00:00 和 07:00 之间的某个位置——这意味着它是第二天。

这是我所做的：

```
var WhenDateUnformatted = $('#when').val().split('/');
var startTimeSPLIT = startTime.split(':');

if (WhenDateUnformatted[1] < 20) {
var WhenDateUnformatted[1] = WhenDateUnformatted[1] + 1;
}

var WhenDate = WhenDateUnformatted[2] + '-' + WhenDateUnformatted[0] + '-' + WhenDateUnformatted[1] + ' ' + startTime + ':00'; 
```

我收到的错误是：

> 语法错误：缺少；声明之前
> 
> var WhenDateUnformatted[1] = WhenDateUnformatted[1] + 1;

它不喜欢`[1]`

这是否意味着`WhenDateUnformatted[1]`如果我想对它做任何事情，我必须先转换为单个变量？

谢谢！:)

**编辑：**我犯了一个错误，第一部分应该是

```
if (startTimeSPLIT[0] < 20) { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:14:55.350

您正在重新声明WhenDateUnformatted。只需在 if 语句中为其分配一个值。

```
var WhenDateUnformatted = $('#when').val().split('/');
var startTimeSPLIT = startTime.split(':');

var parsedWhenDateUnformatted = parseInt(WhenDateUnformatted[1],10);
if (parsedWhenDateUnformatted < 20) {
    WhenDateUnformatted[1] = (parsedWhenDateUnformatted + 1).toString();
} 
```

为了响应您的评论并根据 Robrich 的输入进行更新，我更新了代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T00:15:30.800

WhenDateUnformatted[1] 是一个字符串，而不是一个数字。向它添加 1 会做一些奇怪的事情。试着`parseInt(WhenDateUnformatted[1],10)`先把它变成一个数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T00:16:44.567

您在循环中使用 var 关键字在该行中声明了一个局部变量WhenDateUnformatted

`var WhenDateUnformatted[1] = WhenDateUnformatted[1] + 1;`

这不可能是你想要做的......一旦在循环之外，你的价值将保持不变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-20T00:20:41.350

```
// This is bad
var arr = [] /* or whatever*/;
var arr[1] = arr[1] + 1;

// This is good
var arr = [] /* or whatever*/;
arr[1] = arr[1] + 1; /* Or simply: arr[1]++; */ 
```

**[掌握 Javascript 数组](http://www.hunlock.com/blogs/Mastering_Javascript_Arrays#quickIDX1)**

# java - SimpleDateFormat：具有正确模式的不可解析日期异常

> ID：14420357
> 
> 赞同：0
> 
> 时间：2013-01-20T00:13:14.277
> 
> 标签：java, date

我有简单的代码，它仍然抛出我`unparseable date exception`。我很困惑，模式似乎是正确的。

```
DateFormat dffrom = new SimpleDateFormat("EEE MMM dd HH:mm:ss zzz yyyy");
dffrom.parse("Sun Jan 20 00:50:24 CET 2013"); 
```

我也尝试了这些模式：

```
"EEE MMM dd HH:mm:ss z yyyy"
"EEE MMM dd HH:mm:ss z YYYY"
"EEE MMM dd HH:mm:ss zzz YYYY" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T00:21:50.860

您的默认设置`Locale`可能无法识别单词“Sun”和/或“Jan”。尝试`ENGLISH` `Locale`：

```
new SimpleDateFormat("EEE MMM dd HH:mm:ss zzz yyyy", Locale.ENGLISH); 
```

要查看您的默认值`Locale`，您可以使用：

```
System.out.println(Locale.getDefault()); 
```

请参阅：[语言环境](http://docs.oracle.com/javase/7/docs/api/java/util/Locale.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T00:21:58.000

这取决于您的语言环境。

```
DateFormat dffrom = new SimpleDateFormat("EEE MMM dd HH:mm:ss zzz yyyy", Locale.ENGLISH); 
```

将工作。

# java - Java：检查数字是否在特定范围内

> ID：14420363
> 
> 赞同：0
> 
> 时间：2013-01-20T00:14:17.990
> 
> 标签：java, numbers, range

我有一个包含五个值的整数数组，按升序排序，没有重复。我想检查数组中的五个值中的三个是否满足它们按顺序排列但并非全部都必须的要求。

如果以下一组数字中的三个在五个数字的数组中，则满足要求：

`(1, 2, 3, 4)` 或 `(5, 6, 7, 8)` 或 `(9, 10, 11, 12)` 等。

所以以下数组返回 true：

示例： `(1, 2, 3, 18, 40)` 或 `(2, 3, 4, 20, 34)` 或 `(1, 3, 4, 7, 12)` 或 `(9, 11, 12, 31, 51)`

虽然以下数组返回 false：

示例： `(3, 4, 5, 11, 29)` 或 `(15, 16, 17, 33, 42)` 等。

“规则”是五个数字的数组中的三个数字必须在各自的范围内，1、2、3、4或5、6、7、8等，但我不知道如何过去

有人可以帮我吗？

我将永远感激不尽！

**编辑（因为作为新用户，我不能这么快就自己的问题发布答案）：**

好的，我找到了部分答案：首先我检查三张卡是否具有相同的等级。

我检查卡 1 到 3 是否具有相同的等级。如果不是，我检查卡片 2 到 4 是否具有相同的等级。如果不是，我检查卡片 3 到 5 是否具有相同的等级。这是我的代码：

```
// check
if (tempArray[0] == (tempArray[1] - 1)) {
    System.out.println("1\. and 2\. card match");
    if (tempArray[1] == (tempArray[2] - 1)) {
        System.out.println("2\. and 3\. card match");
        // three cards of same rank, starting from the first
        if (...) {
            isThreeOfAKind = true;
        }
    }
} else {
    System.out.println("1\. and 2\. card DO NOT match");
    // toak could start from the second card
    if (tempArray[1] == (tempArray[2] - 1)) {
        System.out.println("2\. and 3\. card match");
        if (tempArray[2] == (tempArray[3] - 1)) {
            System.out.println("3\. and 4\. card match");
            // three cards of same rank, starting from the second
            if (...) {
                isThreeOfAKind = true;
            }
        }
    } else {
        // toak could start from the third card
        System.out.println("2\. and 3\. card DO NOT match");
        if (tempArray[2] == (tempArray[3] - 1)) {
            System.out.println("3\. and 4\. card match");
            if (tempArray[3] == (tempArray[4] - 1)) {
                System.out.println("4\. and 5\. card match");
                // three cards of same rank, starting from the third
                if (...) {
                    isThreeOfAKind = true;
                }
            }
        }
    }
} 
```

现在你注意到我省略了 if 子句。在那里我必须检查数字是否在范围内（1-4、5-8、9-12 等），但我不知道。！但是代码仍然有问题，因为例如 1、3、4 即使有效，也不会被识别为相同的等级

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:25:37.027

```
public boolean check3InARow(int[] array) {
  int currentResult = (array[0] - 1) / 4;
  int countCurrentResult = 1;
  for (int i=1; i < array.length; i++) {
    if (((array[i] - 1) / 4) == currentResult) {
      countCurrentResult++
      if (countCurrentResult == 3) return true;
    } else {
      currentResult = (array[i] - 1) / 4;
      countCurrentResult = 1
    }
  }
  return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T03:22:19.463

以下是我的解决方案 - 我认为这会有所帮助：

```
 public class CheckConsecutivity {

        public static boolean checkConsecutivity(int[] array) {
          final int NUMBER_OF_CONSECUTIVE_FOLLOWERS = 3; // this constant make the method general to check if any number have
                                                    // any number of consecutive followers; just change to the number you wish 4 or 10 e.g. 
          int count = 1;
          int currentPos = 0;
          for (int i = 1; i < array.length; i++) {
            if (array[currentPos] == array[i]-count) {
                System.out.println("Current Value = " + array[currentPos] + "; next value = "+array[i]  + "; count = " + count);
                count++;
                if ( count % (NUMBER_OF_CONSECUTIVE_FOLLOWERS + 1) == 0) {
                    System.out.println(NUMBER_OF_CONSECUTIVE_FOLLOWERS+" consecutive followers of "+array[currentPos]+" have been found :)");
                    return true;
                }
            } else {
                count = 1;
                i = currentPos++ + 1;
            }
          }
          System.out.println("consecutive numbers have not been found :(");
          return false;
        }

        public static void main(String[] args) {
          // TODO Auto-generated method stub
          int[] test = {7, 15, 10, 11, 12, 13, 1, 3, 4};
          int[] test1 = {4, 3, 2, 1};
          int[] test2 = {100, 101, 102, 17, 12, 1, 2, 5, 6, 7};

          System.out.println("\nTest evaluated to true++++++++++++++++++++++++++++++++:)"); 
          checkConsecutivity(test);

          System.out.println("\nTest1 evaluated to false------------------------------:("); 
          checkConsecutivity(test1);

          System.out.println("\nTest2 evaluated to false---------------------------------:(");  
          checkConsecutivity(test2);
        }

    } 
```

# java - 有没有办法在运行时确定 Java EE 版本？

> ID：14420365
> 
> 赞同：8
> 
> 时间：2013-01-20T00:14:38.037
> 
> 标签：java, jakarta-ee

是否有编程方式来确定可用的 java ee 环境版本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T00:34:06.640

没有标准的方法可以做到这一点。您可以做的最接近的方法是使用反射/ClassLoader 并检查在给定 Java EE 版本中引入的特定 API 类/方法。

在我的头顶上：

*   添加了 Java EE 6 / EJB 3.1`javax.ejb.Singleton`
*   添加了 Java EE 5 / EJB 3.0`javax.ejb.Stateless`
*   添加了 J2EE 1.4 / EJB 2.1`javax.ejb.TimerService`
*   添加了 J2EE 1.3 / EJB 2.0`javax.ejb.MessageDrivenBean`

在此之前是 J2EE 1.2 / EJB 1.1

不过，请注意，如果这是针对 Tomcat（根据标签判断），最好的方法是检查`System.getProperty("tomcat.version")`. 您应该能够暗示基于 Tomcat 版本的 servlet 版本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-20T01:04:16.167

我不知道是否有办法获取 Java EE 版本号，但您可以获取 Servlet API 版本号和 JSP 版本号：

*   `ServletContext`您可以从对象以独立于实现的方式获取 servlet api 版本。寻找`getMajorVersion()`和`getMinorVersion()`方法。

*   您可以通过以下方式获取 JSP 版本：

    `JspFactory.getDefaultFactory().getEngineInfo().getSpecificationVersion()`

毫无疑问，平台（即应用服务器）特定的方法可以找到或推断各种版本号。

* * *

值得注意的是，如果您考虑到应用服务器供应商可能会做什么，“Java EE 版本”是一个橡皮概念。例如，挑选他们支持的 Java EE 技术，以及可能挑选的版本。例如，Tomcat 不支持所有 Java EE - 缺少 EJB 支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-20T00:41:42.790

如果您使用的是 Tomcat，则可以使用类获取运行时的[Servlet API 版本。](http://en.wikipedia.org/wiki/Java_Servlet)[`org.apache.catalina.core.Constants`](http://tomcat.apache.org/tomcat-7.0-doc/api/index.html?org/apache/catalina/core/Constants.html)例如

```
if (Constants.MINOR_VERSION == 2 && Constants.MINOR_VERSION == 5) {
    // Servlet 2.5
} else if(Constants.MINOR_VERSION == 3 && Constants.MINOR_VERSION == 0) {
    // Servlet 3.0
} ... 
```

# javascript - javascript搜索数组以查找数组索引？

> ID：14420368
> 
> 赞同：0
> 
> 时间：2013-01-19T16:55:10.040
> 
> 标签：javascript

说我有：

```
a=[[1,2],[3,4],[5,6]] 
```

这是错的吗？

```
a.indexOf([1,2]) 
```

为什么是-1？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:08:47.990

因为`[1,2] == [1,2]`是`false`

javascript 对象的不同实例不存在相等性。

从[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comparison_Operators)上`==`：

> 如果两个操作数都是对象，那么当操作数引用内存中的同一个对象时，JavaScript 会比较相等的内部引用。

您可以构建自己的函数来查找数组中的数组，但在这种情况下，由于您必须检查内部数组的所有元素（或构建哈希码），这不会很快。你最好避免这种搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:10:55.293

你**不能**在 JAVASCRIPT 中比较数组！

当您检查相等条件时，JavaScript 数组本质上是从对象继承的，这些两个对象的内部引用是不同的，尽管所有元素都相同，但它们返回 -1

因此，当您调用 .indexOf 时，它将比较失败的数组，因此您得到 -1

您需要构建自己的函数来深入检查 Array 及其子数组是否相等，或者您可以使用一些库，如 _.js

# python-2.7 - 如何使用带有 I2C 的 Raspberry Pi 从 Arduino 读取数据

> ID：14420372
> 
> 赞同：10
> 
> 时间：2013-01-20T00:14:59.437
> 
> 标签：python-2.7, arduino, i2c

我正在尝试使用 python smbus 模块将数据从 Arduino UNO 读取到 Raspberry Pi。我能在 smbus 模块上找到的唯一文档是[这里](http://wiki.erazor-zone.de/wiki%3alinux%3apython%3asmbus%3adoc?do=show)。我不确定 cmd 在模块中的含义。我可以使用 write 将数据发送到 Arduino。我写了两个简单的程序，一个用于读取，一个用于写入

用来写的

```
import smbus
b = smbus.SMBus(0)
while (0==0):
    var = input("Value to Write:")
    b.write_byte_data(0x10,0x00,int(var)) 
```

供阅读的

```
import smbus
bus = smbus.SMBus(0)
var = bus.read_byte_data(0x10,0x00)
print(var) 
```

Arduino代码是

```
#include <SoftwareSerial.h>
#include <LiquidCrystal.h>
#include <Wire.h>
LiquidCrystal lcd(8,9,4,5,6,7);

int a = 7;

void setup() 
{ 
  Serial.begin(9600);
  lcd.begin(16,2);
  // define slave address (0x2A = 42)
  #define SLAVE_ADDRESS 0x10

  // initialize i2c as slave
  Wire.begin(SLAVE_ADDRESS);

  // define callbacks for i2c communication
  Wire.onReceive(receiveData);
  Wire.onRequest(sendData); 
}
void loop(){
}

// callback for received data
void receiveData(int byteCount) 
{
 Serial.println(byteCount);
  for (int i=0;i <= byteCount;i++){
  char c = Wire.read();
  Serial.println(c);
 }
}

// callback for sending data
void sendData()
{ 
  Wire.write(67);
  lcd.println("Send Data");
} 
```

当我运行读取程序时，它每次都返回“33”。Arduino 返回调用了 sendData 函数。

我正在使用[数据电平转换器](https://www.adafruit.com/products/757)，描述说它可能有点迟钝。

有没有人让这个工作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-26T01:23:18.063

我设法启动了 Arduino 和 Raspberry Pi 之间的通信。两者使用两个 5k 上拉电阻连接（参见此[页](http://playground.arduino.cc/Main/I2CBi-directionalLevelShifter)）。arduino 为每个请求在 i2c 总线上写入一个字节。在 Raspberry Pi 上，`hello`每秒打印一次。

Arduino代码：

```
#include <Wire.h>
#define SLAVE_ADDRESS 0x2A

void setup() {
    // initialize i2c as slave
    Wire.begin(SLAVE_ADDRESS);
    Wire.onRequest(sendData); 
}

void loop() {
}

char data[] = "hello";
int index = 0;

// callback for sending data
void sendData() { 
    Wire.write(data[index]);
    ++index;
    if (index >= 5) {
         index = 0;
    }
 } 
```

树莓派上的 Python 代码：

```
#!/usr/bin/python

import smbus
import time
bus = smbus.SMBus(1)
address = 0x2a

while True:
    data = ""
    for i in range(0, 5):
            data += chr(bus.read_byte(address));
    print data
    time.sleep(1); 
```

在我的 Raspberry Pi 上，i2c 总线为 1。使用命令`i2c-detect -y 0`或`i2c-detect -y 1`验证您的 Raspberry Pi 是否检测到您的 Arduino。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-23T18:41:23.843

我知道这是一篇旧帖子，但我也取得了一些类似的成功，这似乎是一个可以补充我成功的地方。

很长一段时间以来，我一直在尝试将高 RPM 的计算卸载到 ATTiny85。我想将 i2c 请求上的 RPM 发送到 Pi，而不是在 pi 上使用 GPIO 引脚中断和处理器时间。我今天终于做到了。这就是我想出的。希望它可以帮助某人。如果有人想批评我的代码，那就去吧！

AtTiny 85 ino 代码：1 Mhz 时钟速度

```
#include <TinyWire.h>

//            _____
//     RST  -|o AT |- VDD (1.8-5.5v)
//   A3/D3  -| Tiny|- D2
//   A2/D4  -|  85 |- D1     (PWM)  Can use analogWrite(pin_0_or_1, 255);
//     GND  -|_____|- D0 SDA (PWM)  on pwm pins. (8 bit resolution=0-255)

#define own_address 0x26    // I2C address - change this in arduino code if changed
#define LED_pin 4 
#define hallPin 3 //Melexis US5881 Hall Effect Sensor  (Put a 50K Ohm pull up resistor
                  //                                    between VDD and OUT pins
bool pulseState = false;
const int sample_rate_ms = 1000;

volatile uint32_t timeCheck = 0;  //uint32_t is same as "unsigned long"

volatile uint32_t pulse1 = 0;  //uint32_t is same as "unsigned long"
volatile uint32_t pulse2 = 0;  //uint32_t is same as "unsigned long"    

volatile uint8_t i2c_regs[2] = { 0, 0 };
volatile uint16_t RPM = 0; 
volatile int counter = 0;   //int is same as short

void setup() {
  pinMode(LED_pin, OUTPUT);      // If you want to enable an LED for status.
  pinMode(hallPin, INPUT);       
  digitalWrite(LED_pin, HIGH);   // Turn on the LED to indicate alive status
  delay(2000);                   // Leave it on for 2 seconds
  digitalWrite(LED_pin, LOW);    // Turn it off

  TinyWire.begin( own_address );
  TinyWire.onRequest( onI2CRequest );

  timeCheck = millis() + sample_rate_ms;   // Set a time in the future to calculate
  pulse1 = micros();                       // Take an initial time hack
  sei();     // Enable interrupts
}

void loop() {
  if (digitalRead(hallPin)!=pulseState){       // Look at the hall state
    pulseState = !pulseState;                  // If the pin isn't what it was before
    if (!pulseState){                          // Check if the pin was pulled low
      pulse1 = pulse2;                         // Start time was previous pulse
      pulse2 = micros();                       // End time is this pulse  
      ++counter;                               // Count pulses for determining 0 RPM
      delay(0.0016);                           // Wait for 1/600th of a second (to 
                                               //  prevent bounces) Should be good up 
                                               //  to about 20,000rpm. This may not be
    }                                          //  necessary but it works.
  }

  if(millis() > timeCheck){   // Every so often (once per second in my code)
                              // calculate RPM or lack thereof. 
        timeCheck = millis() + sample_rate_ms;
        if (counter < 2){     //  Less than 2 pulses, it's not rotating
          RPM = 0;
        }else{
          RPM = 60000000 / (pulse2 - pulse1);  // Revs per minute at 1000000 ticks per 
                                               // second using micros()
        }
        i2c_regs[0] = (RPM & 0xFF00) >>8;    // Prepare the two bytes to send
        i2c_regs[1] = (RPM & 0x00FF);        // and place them into an array
        counter = 0;                         // Reset the counter for the next loop
     }
  }
void onI2CRequest() {
  TinyWire.send(i2c_regs, sizeof(i2c_regs));   // Send the two bytes over i2c
} 
```

这是树莓派 Python 3 代码：

```
from smbus2 import SMBus, i2c_msg
# https://pypi.org/project/smbus2/
# To install on raspberry pi execute the following:
# pip install smbus2
# or 
# sudo python3 -m pip install smbus2
# or
# sudo python3 -m pip3 install smbus2

import time
from datetime import datetime, timedelta

def bytes_to_int(bytes):
    result = 0

    for b in bytes:
        result = result * 256 + int(b)

    return result

def int_to_bytes(value, length):
    # This routine is unused for now
    result = []

    for i in range(0, length):
        result.append(value >> (i * 8) & 0xff)

    result.reverse()

    return result

last_good_data_at = datetime.utcnow()
with SMBus(1) as bus:
    address=0x26
    while True:

        time.sleep(0.25)

        try:
            read = i2c_msg.read(address, 2)
            bus.i2c_rdwr(read)
            bytes = list(read)
        except:
            bytes = []

        if bytes:
            last_good_data_at = datetime.utcnow()
            rpm = bytes_to_int(bytes)

            print(f"                     " + "\r", end="")
            print(f"RPM: {rpm}   Bytes: {bytes}" + "\r", end="")

        elif datetime.utcnow() > last_good_data_at + timedelta(seconds=10):
            break
    print("No data received for 10 seconds.")
    print("Terminating program") 
```

# c# - 将十进制转换为二进制，但采用 8 位格式

> ID：14420373
> 
> 赞同：0
> 
> 时间：2013-01-20T00:15:01.827
> 
> 标签：c#

> **可能重复：**
> [如何用零填充二进制字符串？](https://stackoverflow.com/questions/7682628/how-to-pad-a-binary-string-with-zeros)

我能够将十进制数转换为二进制，但不能转换为 8 位格式。例如，如果我输入`5`的结果是`101`正确的，但是如何以 8 位格式显示结果，例如`00000101`？

```
string result = Convert.ToString(num, 2).PadLeft(8, '0'); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-20T00:31:00.650

最简单的方法是使用

```
string result = Convert.ToString(num, 2).PadLeft(8, '0'); 
```

# mysql - 使用单个查询将值插入多个表

> ID：14420376
> 
> 赞同：0
> 
> 时间：2013-01-20T00:15:23.727
> 
> 标签：mysql, insert

> **可能重复：**
> [MySQL 插入多个表？（数据库规范化？）](https://stackoverflow.com/questions/5178697/mysql-insert-into-multiple-tables-database-normalization)

我正在寻找使用 MySQL 的单个查询将值插入两个单独的表中。这可能吗？

我已经尝试过谷歌，但它并没有像我想要的那样提供任何东西。我有一个用户填写的表格，它需要将不同的字段值放在不同的表中，我认为使用一个查询而不是两个查询会更有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T00:55:04.597

虽然我看不出使用一个查询*真的*会更有效恕我直言，您至少有以下选项：

1.  使用存储过程
2.  使用 INSERT TRIGGER（例如在临时表上）
3.  假设您从技术上将 PHP 用于服务器端脚本，您可以使用[`multi_query()`](http://php.net/manual/en/mysqli.multi-query.php)，但这会带来很大的安全风险并且不会使插入成为原子操作。

# ruby-on-rails - 编辑购物车中的数量

> ID：14420377
> 
> 赞同：0
> 
> 时间：2013-01-20T00:15:26.050
> 
> 标签：ruby-on-rails, ruby

所以这是另一篇关于更新购物车数量的帖子！我能找到的任何一个似乎都已经过时了，所以如果这似乎是重复的，我深表歉意。

但是我正在关注 Agile Web Development with Rails 第 4 版一书，他们非常友好地将编辑数量作为“挑战”而不给出答案：D。现在，当我试图让它工作时，我遇到了麻烦。

在我的views/cart/show.html.erb中显示我有下表

```
<table>
    <tr>
        <th>Quantity</th>
        <th>Product Name</th>
        <th>Size</th>
        <th>Price</th>
    </tr>
<% @cart.line_items.each do |item| %>
    <tr>
        <td>
            <%= form_for 'item', :url => {:controller => 'line_items', :action => 'update', id: item} do |f| %>
                <div class="field">
                    <%= f.number_field :qty, :value => item.qty %>
                    <%= submit_tag "Update" %>
                </div>
            <% end %>
        </td>
        <td><%= item.product.name %></td>
        <td><%= item.size %></td>
        <td><%= number_to_currency(item.total_price) %></td>
    </tr>
<% end %>
    <tr>
        <td colspan="3">Total Price</td>
        <td><%= number_to_currency(@cart.total_price) %></td>
    </tr>
</table> 
```

然而，当我点击更新时，我得到

> 未知动作
> 
> 找不到 LineItemsController 的操作“29”

或者

> 未知动作
> 
> 找不到 LineItemsController 的操作“35”

即使我完全取出 id 字段。我可以处理控制器端的更新功能并使其正确更新 - 我想自己解决这个问题，但我无法弄清楚是什么可能会生成这些数字操作以及如何修复它。简而言之，是什么产生了这个错误，我该如何解决？这可能与我在购物车视图中有一个 line_item 表单有关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:47:30.170

你检查 29 和 35 是你的 id 还是别的什么？尝试检查您的数据库中的 LineItems ，以及您的控制器的外观？和

```
<%= form_for 'item', :url => {:controller => 'line_items', :action => 'update', id: item} do |f| %> 
```

您试图以 ajax 方式更新它还是？更新数量的时候，如果没记错的话应该是用ajax吧（书上要求是这样的吧？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T02:35:16.283

所以我让它工作了——我所做的是我像这样调整了表单标题

```
 <%= form_for :item, :url => line_items_update_path(id: item.id) do |f| %> 
```

我将以下行添加到我的 routes.rb

```
 get "line_items/update" 
```

并在我的 line_items_controller 中添加了一行

```
 def update
    @line_item = LineItem.find(params[:id])
    @line_item.qty = params[:item][:qty] #added this line here 
```

对于那些有问题的人！

# ruby-on-rails - 访问地理编码器结果

> ID：14420380
> 
> 赞同：0
> 
> 时间：2013-01-20T00:16:20.590
> 
> 标签：ruby-on-rails, ruby

我正在尝试地理编码器 gem 并希望访问视口结果。

Ruby 新手有更好的方法来访问结果。

```
result = Geocoder.search("New York, NY").map(&:geometry)
north_east_lat = result[0]["viewport"]["northeast"]["lat"]
north_east_lng = result[0]["viewport"]["northeast"]["lng"] 
```

虽然这确实有效，但它看起来又丑又脆

有什么建议可以让这个更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-11T03:52:03.280

您可以使用 Geocoder::Result 方法来访问该数据，例如：

结果[0].city 结果[0].latitud

查看所有方法，结果 [0].methods

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:50:30.847

看起来不像。[`geometry`](http://rdoc.info/gems/geocoder/Geocoder/Result/Google%3ageometry)仅在 Google Maps API 结果中定义，因为它是一个非常特定于 Google 的字段：它不仅包含坐标（地理编码器已经提取），还包含不属于地理编码器标准用途的`location_type`、`viewport`和。`bounds`案例：`location_type`与结果的精度有关，`viewport`专门关于 Google 如何“建议”我们在可视地图上显示此结果，并且`bounds`是整个城市/州/任何地方的边界框。虽然每个都与一个非常特定的用例相关，但大多数使用地理编码器的人不需要它们，因此开发人员不对它们负责，而是直接公开这些字段。所以，如果你想要一种干净的方式来访问这些字段，你'

如果您经常使用视口功能，则可能值得创建自己的`Viewport`类来表示这些数据，然后手动包装表达式（如`Viewport.from_geometry(result.geometry)`）或将您自己的`viewport`方法修补到`Geocoder::Result::Google`. 你的来电。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T02:11:54.483

据我所知，`geometry`数据只是一个简单的`Hash`. 如果您不喜欢通过 ["key"] 在多个级别访问值的方式，您可以将 Hash 转换为 OpenStruct。

```
require 'ostruct'

result = Geocoder.search("New York, NY").first
# singleton class http://www.devalot.com/articles/2008/09/ruby-singleton
class << result
  def ostructic_geometry
    ostructly_deep self.geometry
  end

  private
    def ostructly_deep(hash)
      root = OpenStruct.new

      # http://www.ruby-doc.org/stdlib-1.9.3/libdoc/ostruct/rdoc/OpenStruct.html#method-i-marshal_load
      # -- from the user comment at the bottom --
      # In the marchal_load() example, the Hash should have symbols as keys:
      # hash = { :time => Time.now, :title => 'Birthday Party' }
      load_data = hash.each_pair.inject({}) do |all, (key, value)|
        value = ostructly_deep(value) if value.is_a?(Hash)
        all[key.to_sym] = value # keys need to be symbols to load
        all
      end

      root.marshal_load load_data
      root
    end
end

now_you_can_call_value_from_member_geometry = result.ostructic_geometry
now_you_can_call_value_from_member_geometry.bounds.northeast.lat # => 40.9152414 
```

# c# - 编辑以复制 StripItem 不起作用

> ID：14420383
> 
> 赞同：0
> 
> 时间：2013-01-20T00:16:42.103
> 
> 标签：c#, optimization

这是设置动态`Edit`→的正确代码`Copy` `mnuStripItem`吗？

此代码用于复制用户突出显示的任何内容，并且可以正确输出。

```
private void copyToolStripMenuItem_Click(object sender, EventArgs e)
    {
        Form f = Form.ActiveForm;

        // Find the control that has focus
        Control focusedControl = f.ActiveControl;

        // See if focusedControl is of a type that can select text/data
        if (focusedControl is TextBox)
        {
            TextBox tb = focusedControl as TextBox;
            Clipboard.SetDataObject(tb.SelectedText);
        }
        else if (focusedControl is DataGridView)
        {
            DataGridView dgv = focusedControl  as DataGridView;
            Clipboard.SetDataObject(dgv.GetClipboardContent());
        }
        //else if (...more?...)
        //{
        //}

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:36:01.827

这是绝对正确的，但通常当我必须处理大量的检查语句时，我更喜欢使用 switch 语句。它更容易阅读，我认为在这种情况下它也会表现得更好（不需要使用“is”和“as”语句）：

```
Control focusedControl = f.ActiveControl;

switch (focusedControl.GetType())
{
    case typeof(TextBox):
        TextBox tb = (TextBox)focusedControl;
        Clipboard.SetDataObject(tb.SelectedText);
        break;

    // ...

    default:
        break;
} 
```

# php - 条件为零或更小 - 使用 if 0 但不确定或小于

> ID：14420386
> 
> 赞同：-2
> 
> 时间：2013-01-20T00:17:09.757
> 
> 标签：php, smarty

我有以下代码：

```
{if $product.amount == 0}
      <div class="ofs-label">{$lang.price}:</div>
{/if} 
```

如果金额等于 0，目前显示 HTML，但是，我如何修改它以便在等于 0 或更少时显示 HTML？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:19:27.273

您可能想查看 PHP 中的比较运算符。这是来自 php.net的一个[很好的资源](http://php.net/manual/en/language.operators.comparison.php)

出于您的目的，您可能希望这样做：

```
{if $product.amount <= 0}
<div class="ofs-label">{$lang.price}:</div>
{/if} 
```

如您所见，`TRUE`如果`$product.amount`小于或等于零，<= 运算符将返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:22:20.377

像 PHP，你可以使用

> <=

```
{if $product.amount <= 0}
  <div class="ofs-label">{$lang.price}:</div>
  {/if} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T00:25:07.480

```
if $product.amount <= 0 
```

这是逻辑运算符的快速片段。

```
== Equality
!= Inequality
<  Less Than
<= Less or Equal Than
>  Greater
=> Greater or Equal 
```

有关更多信息，请查看[此参考](http://php.net/manual/en/language.operators.comparison.php)。

# node.js - Azure NPM 问题：msnodesql 无法部署

> ID：14420387
> 
> 赞同：6
> 
> 时间：2013-01-20T00:17:18.507
> 
> 标签：node.js, azure, azure-sql-database

我正在尝试使用我的 azure 托管站点设置 msnodesql（以前称为 node-sqlserver），但遇到了一些问题。

本质上，我在 Azure 中部署失败。我相信这是因为 NPM 试图在服务器上安装 msnodesql 但会失败，因为它需要安装“node-gyp”、Python 和 C++ 2010（天蓝色端不存在）。这是我看到的错误消息

```
npm ERR! msnodesql@0.2.0 install: `node-gyp rebuild`
npm ERR! `cmd "/c" "node-gyp rebuild"` failed with 1
npm ERR! 
npm ERR! Failed at the msnodesql@0.2.0 install script.
npm ERR! This is most likely a problem with the msnodesql package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-gyp rebuild
npm ERR! You can get their info via:
npm ERR!     npm owner ls msnodesql
npm ERR! There is likely additional logging output above. 
```

我已经对这个错误进行了一段时间的修改，但似乎没有任何东西可以解决它。我得到的最佳答案是手动将 msnodesql 包含在 node_modules 中（由[http://geekswithblogs.net/shaunxu/archive/2012/11/16/install-npm-packages-automatically-for-node.js指定-on-windows-azure-web.aspx](http://geekswithblogs.net/shaunxu/archive/2012/11/16/install-npm-packages-automatically-for-node.js-on-windows-azure-web.aspx)）。我觉得这应该解决它，但可惜它没有。我还尝试针对本地 x86 节点编译它，并且只使用预构建的 x86 节点（由[http://geekswithblogs.net/shaunxu/archive/2012/09/18/node.js-adventure---when-node建议.js-meets-windows-azure.aspx](http://geekswithblogs.net/shaunxu/archive/2012/09/18/node.js-adventure---when-node.js-meets-windows-azure.aspx)）。

任何其他建议将不胜感激。

另外值得注意的是，它在我的本地环境中工作得很好，并且可以使用在 webmatrix 中运行但访问 Azure SQL DB 的 msnodesql 从我创建的 SQL Azure DB 中获取数据（一旦我将我的 IP 列入白名单）。

我最初在 Azure 中的数据库和网站位于不同区域时遇到问题，但我更正了这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T14:51:10.153

正如 Glenn Block 所提到的，问题源于 Azure 在部署时尝试构建本机模块。这可能有几个原因，也许你没有上传二进制文件，也许是错误的二进制文件，或者部署目录搞砸了。

Azure 服务器需要 Node .6 的 32 位驱动程序。

我必须做的是通过 FTP 进入我的 azure 服务器并删除 /site/wwwroot/ 中除 web.config 之外的所有内容。您可能只需删除 node_modules 就可以侥幸逃脱，但由于行为出乎意料，我想清除所有内容。

然后我进入本地机器上的 Node 项目目录，进入 node_module/msnodesql 目录并删除除 package.json 和 lib 目录之外的所有内容。在 lib 目录中，我为我的开发机器（64 位 .8）和天蓝色的二进制文件创建了单独的目录，分别称为 64 和 32。

然后我修改，sqlserver.native.js如下

```
try {
    module.exports = require('./32/sqlserver.node'); //Azure version
}
catch (e) {
    try {
        module.exports = require('./64/sqlserver.node'); //My local machine
    }
    catch (e) {
        try {
            module.exports = require('../build/Release/sqlserver.node');
        }
        catch (e) {
            console.error('Native sqlserver module not found. Did you remember to run node-gyp configure build?');
            throw e;
        }
    }
} 
```

这里要说明的重点是，我们尝试加载所有可用版本以适应我可能拥有的每种部署可能性，但优先考虑 Azure 服务器。在我的本地开发机器上，我们无法从 /32 加载节点，因为它的格式错误，我们退回到 /64。

我敢打赌，如果我为此付出一点努力，我可以轻松地将被删除的内容缩减到最低限度，但是在浪费了数小时解决这个问题之后，我已经受够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:35:07.667

失败的原因是它在部署时尝试构建本机模块。我们不支持在 Windows Azure 网站中*构建本机模块。*但是，您可以部署二进制文件，然后它会工作，但您不需要在 package.json 中包含它。按照这篇文章了解更多详细信息：http: [//blogs.msdn.com/b/sqlphp/archive/2012/06/08/introducing-the-microsoft-driver-for-node-js-for-sql-server.aspx](http://blogs.msdn.com/b/sqlphp/archive/2012/06/08/introducing-the-microsoft-driver-for-node-js-for-sql-server.aspx)

# c++ - 我应该如何响应 QTreeView 中正在更改的文本？

> ID：14420391
> 
> 赞同：0
> 
> 时间：2013-01-20T00:17:47.800
> 
> 标签：c++, qt, qt4, qtreeview

我有`QTreeView`一些`QStandardItem`s。这些项目是可编辑的，我想通过信号或事件过滤器对项目的文本进行更改时进行编程。我找不到任何能满足要求的东西。我试过`QStandardModel::itemChanged`了，但这会响应其他项目数据的变化，我看不到区分文本内容和用户数据变化的方法。解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:15:30.983

为了解决这个问题，我最终从 QStandardItem 派生了一个类并覆盖了 QStandardItem::setData ，如下所示：

```
void MyStandardItem::setData(const QVariant& value, int role)
{
    if (role == Qt::EditRole) {
        doStuff();
    }

    QStandardItem::setData(value, role);
} 
```

# r - 如何在 R 中编写排序集采样？

> ID：14420392
> 
> 赞同：1
> 
> 时间：2013-01-20T00:17:51.843
> 
> 标签：r

我正在尝试使用`R`. 有**2*n^2 个**项目，我想将它们随机分成两个大小相等的组，每组有**n^2 个**项目。然后我想使用这些组中的每一个的排序集采样来形成**n 个**RSS 块，每个 RSS 块中有**n 个**项目。

我正在尝试的内容如下所示：

```
n<-4
id<-1:(2*n^2)
s1<-sample(id,n^2)
s2<-id[-s1]

block<-rep(1:(2*n),each=n)
d<-data.frame(block) 
```

现在我想要一个名为**rss**的数据框中的列，它将显示在特定 RSS 块中选择了哪些 id。

我不擅长`R`。我正在尝试这个：

```
for(i in 1:n){
d$rss<-ifelse(d$block==i,sample(s1,n),0)
#s1<-s1[-which(s1==d$rss)]
}

for(i in 1:n){
d$rss<-ifelse(d$block==i,sample(s2,n),0)
#s2<-s2[-which(s2==d$rss)]
} 
```

我知道这是非常错误的！任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:34:01.077

你应该举一个你想要的输出的例子，但给它我最好的猜测：

```
d <- transform(d,rss = ifelse(d[,"block"]<=n, sample(s1), sample(s2))) 
```

或者，以更有条理的方式：

```
d <- transform(d,block.id = rep(1:n))
d <- transform(d,rss = ifelse(d[,"block"]<=n, sample(s1), sample(s2)))

library(reshape2)
d <- dcast(d,block ~ block.id, value = rss) 
```

# javascript - 如何在 .aspx 文件中调用此脚本？

> ID：14420394
> 
> 赞同：-1
> 
> 时间：2013-01-20T00:18:41.803
> 
> 标签：javascript, asp.net

我是 jquery 的初学者，如何在 .aspx 页面中调用此脚本？

```
 var text = '';

    $('p').bind('keypress', function(e) {

    e.preventDefault();
    $(this).text('');
    $(this).empty();

    text += String.fromCharCode(e.keyCode);
    var text2 = text.substr(0, text.length - 1);
    var lastChar = text.substr(text.length - 1);

    $(this).text(text2);

    $(this).append('<span class="char">' + lastChar + '</span>');
    $(this).append('<span class="cursor"></span>');

    }); 
```

感谢任何帮助，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:22:07.677

首先，将您的代码包装到一个函数中。使用以下方法之一编写对该函数的调用。

[RegisterClientScriptBlock](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerclientscriptblock.aspx)
[RegisterStartupScript](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerstartupscript.aspx)

# c - 进程间通信的普通管道

> ID：14420398
> 
> 赞同：0
> 
> 时间：2013-01-20T00:19:18.830
> 
> 标签：c, linux

我正在学习如何在linux中使用普通管道进行父子进程之间的通信。基本任务只是从父进程向子进程发送消息，然后子进程进行一些转换并将结果传递回父进程。我显示的结果是一些随机字符，如����。我已经考虑了很长时间，仍然无法弄清楚这个错误。谢谢你的帮助。

```
#include <sys/types.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>

#define READ_END 0
#define WRITE_END 1

void convert(char* str);

int main(int argc, char *argv[]){
  int pid; /* Process ID */
  int status;
  char *input;
  char *read_msg_c;
  char *read_msg_p;
  int pfd1[2], pfd2[2];
  if (argc !=2){/* argc should be 2 for correct execution */
    /* We print argv[0] assuming it is the program name */
    printf("Please provide the string for conversion \n");
    exit(-1);
  }
  input = argv[1];

  if(pipe(pfd1) < 0 || pipe(pfd2) < 0){
    printf("Failed to create a pipe between parent and child \n");
    exit(-1);
  }
  if((pid = fork()) < 0){ /* Fork the process */
     printf("Fork error \n");
     exit(-1);
  }
  else if(pid > 0){ /* Parent code */
    close(pfd1[READ_END]);
    close(pfd2[WRITE_END]);
    printf("Process ID of the parent is %d. \n", getpid()); /* Print parent's process ID */
    write(pfd1[WRITE_END],input,strlen(input)+1);
    close(pfd1[WRITE_END]);

    read(pfd2[READ_END],read_msg_p,strlen(input)+1);
    printf("%s\n",read_msg_p);
    close(pfd2[READ_END]);
  }
  else if(pid == 0){ /* Child code */
    close(pfd1[WRITE_END]);
    close(pfd2[READ_END]);

    printf("Process ID of the child is %d. \n", getpid()); /* Print child's process ID */
    read(pfd1[READ_END],read_msg_c, strlen(input)+1);
    printf("Child: Reversed the case of the received string. \n");
    write(pfd2[WRITE_END],read_msg_c,strlen(input)+1);
    close(pfd1[READ_END]);
    close(pfd2[WRITE_END]);
    exit(0); /* Child exits */
   }
}

void convert(char *str){
  int i = 0;
  while (str[i]){
    if (isupper(str[i])){
      str[i] = tolower(str[i]);
    }
    else if (islower(str[i])){
      str[i] = toupper(str[i]);
    }
    i++;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:37:24.223

您的主要错误是您的变量`read_msg_p`是`read_msg_c`未初始化的指针。

把它们做成数组：

```
char read_msg_p[1024];
char read_msg_c[1024]; 
```

你似乎失踪了`<stdio.h>`（但你真的不需要`<sys/types.h>`更多了）。你应该错误检查你的读写；为它们分配空间后，您的读取可能会使用不同的最大大小。等等。

我通过查看编译器警告发现了问题：

```
$ gcc -O3 -g -std=c99 -Wall -Wextra pipes-14420398.c -o pipes-14420398
pipes-14420398.c: In function ‘main’:
pipes-14420398.c:40:22: warning: ‘read_msg_p’ may be used uninitialized in this function [-Wuninitialized]
pipes-14420398.c:52:22: warning: ‘read_msg_c’ may be used uninitialized in this function [-Wuninitialized]
$ 
```

忽略行号；当这些是剩下的唯一警告时，我已经适度严重地破解了你的代码。但有问题的线路是`read()`电话。

* * *

示例输出来自被黑代码，工作正常。

```
$ ./pipes-14420398 string-to-convert
Process ID of the parent is 37327\. 
Process ID of the child is 37328\. 
Child read 18 bytes: <<string-to-convert>>
Parent read 18 bytes: <<string-to-convert>>
$ 
```

请注意，下面的代码读取 18 个字节（包括 null），但不打印 null（`nbytes-1`因为`printf()`.

```
#include <unistd.h>
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

#define READ_END 0
#define WRITE_END 1

int main(int argc, char *argv[])
{
  int pid; /* Process ID */
  char *input;
  char read_msg_c[1024];
  char read_msg_p[1024];
  int pfd1[2], pfd2[2];

  if (argc !=2){/* argc should be 2 for correct execution */
    /* We print argv[0] assuming it is the program name */
    fprintf(stderr, "Usage: %s string-to-convert\n", argv[0]);
    exit(-1);
  }
  input = argv[1];

  if(pipe(pfd1) < 0 || pipe(pfd2) < 0){
    printf("Failed to create a pipe between parent and child \n");
    exit(-1);
  }
  if((pid = fork()) < 0){ /* Fork the process */
     printf("Fork error \n");
     exit(-1);
  }
  else if(pid > 0){ /* Parent code */
    close(pfd1[READ_END]);
    close(pfd2[WRITE_END]);
    printf("Process ID of the parent is %d. \n", getpid()); /* Print parent's process ID */
    write(pfd1[WRITE_END], input, strlen(input)+1);
    close(pfd1[WRITE_END]);

    int nbytes = read(pfd2[READ_END], read_msg_p, sizeof(read_msg_p));
    if (nbytes <= 0)
        printf("Parent: read failed\n");
    else
        printf("Parent read %d bytes: <<%.*s>>\n", nbytes, nbytes-1, read_msg_p);
    close(pfd2[READ_END]);
  }
  else if(pid == 0){ /* Child code */
    close(pfd1[WRITE_END]);
    close(pfd2[READ_END]);

    printf("Process ID of the child is %d. \n", getpid()); /* Print child's process ID */
    int nbytes = read(pfd1[READ_END], read_msg_c, sizeof(read_msg_c));
    if (nbytes <= 0)
        printf("Child: read failed\n");
    else
    {
        printf("Child read %d bytes: <<%.*s>>\n", nbytes, nbytes-1, read_msg_c); 
        write(pfd2[WRITE_END], read_msg_c, nbytes);
    }
    close(pfd1[READ_END]);
    close(pfd2[WRITE_END]);
    exit(0); /* Child exits */
   }
} 
```

正如[WhozCraig](https://stackoverflow.com/users/1322972/whozcraig)所指出的，可以进行许多其他更改。但是，这可以使事情合理地干净地工作。你非常接近OK。

注意调试技术：

1.  以高警告级别编译并修复所有警告。
2.  在信息可用时打印信息（或在调试器中运行并在信息可用时观察信息）。

# c++ - Boost.Asio - 确保对方收到数据

> ID：14420404
> 
> 赞同：4
> 
> 时间：2013-01-20T00:20:01.813
> 
> 标签：c++, boost, boost-asio

我正在使用 boost::asio 并向客户端发送列表并在完成后关闭套接字。不知何故，客户*有时*会在收到所有内容之前收到文件结束错误。

我猜这与服务器在发送最后一个列表条目后立即关闭套接字有关。有没有一种简单的方法来解决这个 async_send 仅在数据成功发送后才调用处理程序？

还是我的文件结束错误来自其他原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T04:15:38.407

Boost.Asio 是基于 TCP 和 UDP 套接字的独立于操作系统的抽象层。它们不保证其他应用程序已接收并处理了数据。您需要在应用程序中包含此逻辑，您可能想研究[OSI 模型](http://en.wikipedia.org/wiki/OSI_model)。

如果您在`async_send()`返回后立即关闭套接字，这是不正确的。您应该仅在调用完成处理程序后关闭它。

# php - 处理访问令牌的 Facebook PHP SDK

> ID：14420410
> 
> 赞同：6
> 
> 时间：2013-01-20T00:20:44.777
> 
> 标签：php, facebook, sdk, access-token

我已经找到了很多不同的答案，但仍然对我应该如何处理 facebook**访问令牌**感到有些困惑。我遇到的主要问题之一是由于我的浏览器中存储了哪些信息。例如，我登录应用程序，令牌过期，除非我清除浏览器中的 cookie/应用程序设置，否则我无法再次登录。

我偶然发现了这个线程：[How to extend access token validation since offline_access deprecation](https://stackoverflow.com/questions/8982025/how-to-extend-access-token-validity-since-offline-access-deprecation)

这向我展示了如何通过 php 创建扩展访问令牌。

**我的问题是：**

**1.**我需要将访问令牌存储在任何地方吗？

**2.**访问令牌过期或失效怎么办？目前，当短期访问权限过期时，我的应用程序就会停止工作。

**3.**有什么方法可以处理它们以检查它们是否已过期？我正在使用 php sdk 并且基本上使用了标准 if( $user ) ... 像这样：

```
require 'sdk/src/facebook.php';

  $facebook = new Facebook(array(
  'appId'  => 'XXXXXXXXXXXXXXXXXXXXX',
  'secret' => 'XXXXXXXXXXXXXXXXXXXXX',
));

  $user = $facebook->getUser();

  if( $user ){
    try{
        $user_profile = $facebook->api('/me');
    } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
    }
  }

  if (!$user){

    $params = array(
    'scope' => 'email',
    );

    $loginUrl = $facebook->getLoginUrl( $params );
        echo '<script type="text/javascript"> 
                window.open("'. $loginUrl .'", "_self"); 
                </script>';
                exit;

 } 
     if( $user ){

    $access_token = $facebook->getExtendedAccessToken();     

     $get_user_json = "https://graph.facebook.com/me?access_token=" 
       . $access_token;

// Rest of my code here...
} 
```

*   我还应该做些什么来处理令牌？

. 我应该在页面之间传递访问令牌还是可以在每个页面的顶部再次调用它，如下所示：

```
$facebook = new Facebook(array(
  'appId'  => 'XXXXXXXXXXXX',
  'secret' => 'XXXXXXXXXXXX',
  'redirect_uri' => 'http://localhost:8000/',
));
     $token = $facebook->getExtendedAccessToken(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T08:29:13.170

让我们来看看你的问题：

> 我需要将访问令牌存储在任何地方吗？

这取决于您的应用程序。首先问问自己，当用户**不**在场（未登录到您的应用程序）时，您是否需要代表用户执行操作？
如果答案是**肯定**的，那么您需要扩展用户令牌，这可以使用 PHP-SDK 通过调用此方法来完成，同时您有一个有效的用户会话：`setExtendedAccessToken()`。

你也应该参考这个文档：[Extended Access Tokens](https://developers.facebook.com/docs/howtos/login/extending-tokens/)

> 当访问令牌过期或失效时会发生什么？...有没有办法我应该处理它们以检查它们是否已过期？

这就是代码中的*catch*子句派上用场的地方，而 facebook 示例仅*记录*`error_log($e);`您应该处理 的错误 ( )！

Facebook 已经有一个关于这个的教程：[How-To: Handle expired access tokens](https://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/)。

此外，您应该参考[错误表](https://developers.facebook.com/docs/reference/api/errors/)并相应地调整您的代码。

> 我还应该做些什么来处理令牌？

往上看。

> 我应该在页面之间传递访问令牌还是可以在每个页面的顶部再次调用它

您不需要执行任何操作，因为 PHP-SDK 将为您处理令牌；你有没有注意到你在打电话：`$user_profile = $facebook->api('/me');`没有附加用户`access_token`？

SDK 从其末尾添加它，因此您不必担心它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T21:23:55.080

我刚遇到同样的问题，但我在您的帮助下解决了它。我正在使用 php-sdk 连接到 Facebook API，所以我只是做了这个。

```
$facebook = new Facebook(array(
          'appId'  => 'API_ID', 
          'secret' => 'SECRET',
        ));

// Get User
$user = $facebook->getUser();

// Verifing if user is logged in.
if ($user) {
    try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me');
    } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
    }
}

// Verify if user is logged in, if it is... Save the new token.
if($user){

   // Request the access_token to the 
   $access_token = $facebook->getAccessToken()

   // Saving the new token at DB.
   $data = array('access_token' => $access_token);
   $this->db->where('userid',$user);            
   $this->db->update('facebook', $data);

} 
```

# algorithm - 用于排列的交叉运算符

> ID：14420411
> 
> 赞同：13
> 
> 时间：2013-01-20T00:20:49.193
> 
> 标签：algorithm, genetic-algorithm, crossover

我正在尝试解决我的排列中遗传算法中的交叉问题。假设我有两个 20 个整数的排列。我想交叉他们生两个孩子。父母内部有相同的整数，但顺序不同。

例子：

```
Parent1: 
 5 12 60 50 42 21 530 999 112 234 15 152 601 750 442 221 30 969 113 134
Parent2: 
 12 750 42 113 530 112 5 23415 60 152 601 999 442 221 50 30 969  134 21 
```

就这样吧——我怎样才能得到这两个孩子？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T01:42:54.173

您正在寻找的是[有序交叉](https://en.wikipedia.org/wiki/Crossover_%28genetic_algorithm%29#Crossover_for_ordered_lists)。[这里](https://medium.com/@becmjo/genetic-algorithms-and-the-travelling-salesman-problem-d10d1daf96a1)有关于旅行商问题的解释。

下面是一些实现部分映射交叉 (PMX) 变体的[Java 代码。](https://github.com/dwdyer/watchmaker/blob/master/framework/src/java/main/org/uncommons/watchmaker/framework/operators/ListOrderCrossover.java)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-20T09:31:28.700

交叉的选择取决于整数的顺序或绝对位置对适应度是否重要。在[HeuristicLab](http://dev.heuristiclab.com) (C#) 中，我们实现了文献中的几个流行的，包括：OrderCrossover（2 个变体）、OrderBasedCrossover、PartiallyMatchedCrossover、CyclicCrossover（2 个变体）、EdgeRecombinationCrossover (ERX)、MaximalPreservativeCrossover、PositionBasedCrossover 和 UniformLikeCrossover。它们的实现可以参考 HeuristicLab.Encodings.PermutationEncoding 插件中的科学资源一起找到。ERX 仅对 TSP 或类似 TSP 的问题有意义。CX 是基于位置的，PMX 部分是位置部分是基于顺序的，但更倾向于位置。OX 完全基于订单。

请注意，我们的实现假设具有从 0 到 N-1 的整数的连续编号排列。您必须首先将它们映射到此范围。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-20T00:16:27.100

根据我对遗传算子的研究和实现。许多类型的交叉运算符用于顺序编码（即不允许重复基因，如在[TSP](https://en.wikipedia.org/wiki/Travelling_salesman_problem)中）。总的来说，我喜欢认为有两个主要的家庭：

## ERX 系列

邻域列表用于存储双亲中每个节点的邻居。然后，仅使用列表生成孩子。众所周知，ERX更[尊重和等位基因传递](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.8.8416&rep=rep1&type=pdf)，这基本上意味着基因之间的联系不太可能被打破。

*类 ERX 算子的示例包括：*边缘重组 (ERX)、边缘 2、边缘 3、边缘 4 和广义分区交叉 (GPX)。

## 类似 OX 的分频器

选择了两个交叉点。然后，点之间的基因在两个父母之间交换。由于不允许重复，因此每个交叉都提出了一种避免/消除重复的技术。这些交叉运营商比 ERX 更具破坏性。

*类 OX 交叉的示例：*阶交叉 (OX)、最大防腐交叉 (MPX) 和部分映射交叉 (PMX)。

第一族（ERX）在普通遗传算法中表现更好。而第二类更适合混合遗传算法或模因算法（使用局部搜索）。[这篇论文](http://www.cs.colostate.edu/pubserv/pubs/Whitley-genitor-1994-landscape.ps.gz)详细解释了它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-16T16:58:21.310

在旅行销售代表问题 (TSP) 中，您希望订单访问城市列表，并且您希望每个城市仅访问一次。如果您直接在基因组中对城市进行编码，那么简单的交叉或突变通常会生成无效的行程。

我曾经想出一种解决这个问题的新方法：我没有直接在基因组中编码解决方案，而是编码了一个可以重新排序规范值列表的转换。

给定基因组 [1, 2, 4, 3, 2, 4, 1, 3]，您将从任意顺序的城市列表开始，比如按字母顺序：

1.  亚特兰大
2.  波士顿
3.  芝加哥
4.  丹佛

然后，您将从基因组中获取每对值并交换这些位置的城市。因此，对于上面的基因组，您将交换 1 和 2 中的那些，然后是 4 和 3 中的那些，然后是 2 和 4 中的那些，最后是 1 和 3 中的那些。您最终会得到：

1.  丹佛
2.  芝加哥
3.  波士顿
4.  亚特兰大

使用这种技术，您可以使用任何类型的交叉或变异操作，并且仍然始终获得有效的游览。如果基因组足够长，则可以探索整个解决方案空间。

我已经将它用于 TSP 和其他优化问题，并取得了很大的成功。

# xcode - 如何在 Xcode 中使用 Control 拖动

> ID：14420412
> 
> 赞同：7
> 
> 时间：2013-01-20T00:20:59.577
> 
> 标签：xcode

我刚刚开始进行 iOS 开发。我正在尝试向按钮添加操作，并且在苹果开发人员网站上提到“要控制拖动，请在从按钮拖动到助手编辑器窗格中的实现文件时按住 Control 键。” 但我无法做到这一点。什么是控制键？我怎样才能做到这一点？当我尝试添加控件拖动时，整个按钮都被拖动并且看不到任何控件拖动箭头。非常感谢您的时间。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-20T01:11:44.817

您可以使用鼠标右键单击并拖动（如果有的话），或者在使用鼠标左键（单个）单击并拖动时按住 Control 键。

通过“Control”键，他们指的是键盘上的 Control 键：

![在此处输入图像描述](../Images/4769af58ae38c882b2c4a9b351c025aa.png)

# python - 如何使用 PyAIML 设置聊天机器人的主人名称？

> ID：14420413
> 
> 赞同：1
> 
> 时间：2013-01-20T00:21:16.710
> 
> 标签：python, artificial-intelligence, chatbot, aiml

我在玩 PyAIML。我了解如何设置机器人的名称。但无法弄清楚如何设置创建者的名字，以便如果有人问“谁创造了你？” 然后它可以适当地回复。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T16:33:10.287

这与您设置和获取机器人名称的方式相同。只有变量名称与您的选择不同。

# html - 环绕 H3 标签的重复图像

> ID：14420414
> 
> 赞同：0
> 
> 时间：2013-01-20T00:21:42.203
> 
> 标签：html, css

我在一个网站上工作，我遇到了一个小难题......

我有一个 h3 标签，需要在两边重复背景..这有点难以解释，所以我做了这个图形......

![在此处输入图像描述](../Images/03ab54e39d76481436b93f55d1ccbefd.png)

基本上它的标题在它的两边都有重复的背景，但背景在标题开始的地方停止，然后继续……我玩过大量的 CSS，但没有运气……有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:50:08.920

`:before`和的例子`:after`

[http://jsfiddle.net/JTN2U/](http://jsfiddle.net/JTN2U/) - 品尝季节

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:29:11.547

我认为您可能需要在 h3 中添加另一个标签，如下所示：

```
<h3><span class="text">title goes here</span></h3> 
```

CSS：

```
h3 {
  background: url('img.jpg') repeat-x;
  padding: 0 20px; /* or however much of the image you want to show */
}

h3 .text {
  background: #fff; /* or whatever background color */
} 
```

**更新：** HTML：

```
<h3><span class="pre"></span><span class="text">title goes here</span><span class="post"></span></h3> 
```

CSS：

```
h3 span.pre,
h3 span.post {
  background: url('header-bg.jpg') repeat-x;
  display: block;
  width: 20px;
  float: left;
}

h3 span.text {
  float: left;
  display: block;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T00:48:05.530

添加repeat-x背景`h3`然后你可以在里面添加一个span标签。还有很多其他方法可以做到这一点。

[请参阅演示。](http://jsfiddle.net/7XcMJ/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T01:03:03.047

我不知道这是否是一个合适的解决方案，因为它不是一个标签......

```
<style type="text/css">
  div {background-image: url('navlolite.gif'); text-align: center;}
  label {background-color: #FFFFFF; padding-left: 24px; padding-right: 24px;}
</style>

<div>
  <label>My Headng Text</label>
</div> 
```

# javascript - 使用本地机器上的 Websocket 页面

> ID：14420422
> 
> 赞同：2
> 
> 时间：2013-01-20T00:23:10.570
> 
> 标签：javascript, websocket

我正在开发一个我想与 websocket 交互一起使用的应用程序。我使用了基于 node.js 和 socket.io 的服务器和简单的聊天页面作为我页面的起点。我正在修改并弄清楚服务器和 html 页面之间的交互。

编写基本聊天页面的人在 html 页面上使用内联 javascript 作为聊天的客户端，所以我将其分解为自己的 javascript 文件，没什么大不了的。

问题是我想使用本地机器上的 html 和关联的 javascript 文件来连接到我在 web 服务器上创建的 node.js 服务器。他的设置是访问 web-server 上的 html 页面，该页面与作为 web-socket 服务器的 server.js 文件位于同一文件夹中。

我试图弄清楚如何让客户端javascript文件在页面打开时开始做这件事（我猜需要一个加载事件），以及如何设置它来调用网络服务器javascript文件。

我要把他的代码贴在这里，不是我的，我只是用他的教程制作了chat.html和server.js。基本上是复制粘贴。

一如既往地非常感谢任何帮助或指导。

------------------chat.html--------------

```
<!doctype html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>WebSocket Chat</title>
        <script src="/socket.io/socket.io.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
        <script>
            var URL = window.location.protocol + "//" + window.location.host;
            console.log("Connecting to " + URL);
            var socket = io.connect(URL);
            // on connection to server, ask for user's name with an anonymous callback
            socket.on('connect', function() {
                // call the server-side function 'adduser' and send one parameter (value of prompt)
                socket.emit('adduser', prompt("What's your name?"));
            });
            // listener, whenever the server emits 'updatechat', this updates the chat body
            socket.on('updatechat', function(username, data) {
                $('#conversation').append('<b>' + username + ':</b> ' + data + '<br>');
            });
            // listener, whenever the server emits 'updateusers', this updates the username list
            socket.on('updateusers', function(data) {
                $('#users').empty();
                $.each(data, function(key, value) {
                    $('#users').append('<div>' + key + '</div>');
                });
            });
            // on load of page
            $(function() {
                // when the client clicks SEND
                $('#datasend').click(function() {
                    var message = $('#data').val();
                    $('#data').val('');
                    // tell server to execute 'sendchat' and send along one parameter
                    socket.emit('sendchat', message);
                });
                // when the client hits ENTER on their keyboard
                $('#data').keypress(function(e) {
                    if (e.which == 13) {
                        $(this).blur();
                        $('#datasend').focus().click();
                    }
                });
            });
        </script>

    </head>
    <body>
        <h1>WebSocket Chat</h1>
        <div style="float:left;width:100px;border-right:1px solid black;height:300px;padding:10px;overflow:scroll-y;">
            <b>USERS</b>
            <div id="users"></div>
        </div>
        <div style="float:left;width:300px;height:250px;overflow:scroll-y;padding:10px;">
            <div id="conversation"></div>
            <input id="data" style="width:200px;" />
            <input type="button" id="datasend" value="send" />
        </div>
    </body>
</html> 
```

----------server.js-------------- ---

```
var port = 5000;
var app = require('express')();
var server = require('http').createServer(app);
var io = require('socket.io').listen(server);

console.log("Listening on port " + port);
server.listen(port);

// routing
app.get('/', function (req, res) {
    res.sendfile(__dirname + '/chat.html');
});

// usernames which are currently connected to the chat
var usernames = {};

io.sockets.on('connection', function (socket) {

    // when the client emits 'sendchat', this listens and executes
    socket.on('sendchat', function (data) {
        // we tell the client to execute 'updatechat' with 2 parameter
        io.sockets.emit('updatechat', socket.username, data);
    });

    // when the client emits 'adduser', this listens and executes
    socket.on('adduser', function(username){
        // we store the username in the socket session for this client
        socket.username = username;
        // add the client's username to the global list
        usernames[username] = username;
        // echo to client they've connected
        socket.emit('updatechat', 'SERVER', 'you have connected');
        // echo globally (all clients) that a person has connected
        socket.broadcast.emit('updatechat', 'SERVER', username + ' has connected');
        // update the list of users in chat, client-side
        io.sockets.emit('updateusers', usernames);
    });

    // when the user disconnects.. perform this
    socket.on('disconnect', function(){
        // remove the username from global usernames list
        delete usernames[socket.username];
        // update list of users in chat, client-side
        io.sockets.emit('updateusers', usernames);
        // echo globally that this client has left
        socket.broadcast.emit('updatechat', 'SERVER', socket.username + ' has disconnected');
    });
}); 
```

# facebook - 将 Facebook 用户名放入 Flash

> ID：14420425
> 
> 赞同：0
> 
> 时间：2013-01-20T00:23:17.003
> 
> 标签：facebook, login, actionscript-2

我制作了一个带有 PHP 登录名的 Flash 游戏，该登录名与 MySQL 数据库连接。无论如何，我正在尝试制作一个您将在 Facebook 上访问的简单应用程序，它会自动从 Facebook 获取您的用户名和电子邮件，并通过一些 PHP 将其发布到 Flash 中。

我在其他一些游戏中看到了这一点，比如像 Habbo Hotel 这样的虚拟世界。

首先，这在使用 PHP 的 AS2 中是否可行？其次，我该怎么做？

谢谢您的帮助！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:12:47.307

您可以使用 Facebook 的 Actionscript SDK。我认为这仅适用于 AS3 而不是 AS2

[动作脚本 SDK](http://code.google.com/p/facebook-actionscript-api/)

# c# - 在运行时向 POCO 类添加属性

> ID：14420427
> 
> 赞同：8
> 
> 时间：2013-01-20T00:23:42.090
> 
> 标签：c#, properties, runtime, poco, ormlite-servicestack

我为我的项目选择了[ServiceStack OrmLite](https://github.com/ServiceStack/ServiceStack.OrmLite)，这是一个纯面向数据的应用程序。我愿意允许最终用户创建自己的以 XML 格式定义的对象类型，这些对象类型将用于在运行时使用[CodeDOM](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx)生成类。

我还将定义应用程序所需的一些“系统”对象（即`User`），但我无法预见最终用户将使用的所有属性，因此我正在寻找一种方法来允许扩展我在设计时创建的类。示例如下

```
public class User
{
    public Guid Uid { get; set; }
    public String Username { get; set; }
    public String Password { get; set; }
} 
```

最终用户想要一个`Email`和一个`Address`. 他应该能够将 2 个属性添加到上层类，整个类将是（OrmLite 仍然可以使用它，因为它允许覆盖：

```
public class User
{
    public Guid Uid { get; set; }
    public String Username { get; set; }
    public String Password { get; set; }
    public String Email{ get; set; }
    public String Address { get; set; }
} 
```

我知道这样做可能会导致系统崩溃（如果类已经实例化），所以我正在寻找避免这个问题并模仿我的需求的最佳方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T17:04:52.490

您在这里所做的似乎有两个部分。您需要动态创建类型以支持其他属性。您还需要确保您的 AppDomain 中永远不会出现重复类型，即`User`.

# 运行时类型生成

已经给出的各种建议处理了如何创建类型。在一个项目中，我们有类似的东西。我们创建了一个基类，它具有核心属性和一个存储“扩展”属性的字典。然后我们用来`Reflection.Emit`创建具有所需属性的派生类型。每个属性定义都简单地从基类中的字典读取或写入。由于`Reflection.Emit`需要编写低级 IL 代码，因此乍一看似乎很复杂。我们在另一个类库中编写了一些示例派生类并编译了它们。这些是我们在运行时实际需要实现的示例。然后我们使用 ildasm.exe 来查看编译器生成了哪些代码。这使得我们很容易弄清楚我们如何在运行时生成相同的代码。

# 避免命名空间冲突

您的第二个挑战是避免使用重复的类型名称。我们在每个生成的类型的名称中附加了一个 guid（删除了无效字符），以确保这种情况永远不会发生。很容易解决，虽然我不知道你是否可以用你的 ORM 来解决这个问题。

如果这是服务器代码，您还需要考虑在 .NET 中永远不会卸载程序集这一事实。因此，如果您在运行时反复生成新类型，您的流程将继续增长。客户端代码中也会发生同样的情况，但如果您不希望进程运行较长时间，这可能不是问题。

我说没有卸载程序集；但是，您可以卸载整个`AppDomain`. 因此，如果这是服务器代码，您可以让整个操作在其自己的 appdomain 中运行，然后将其拆除以确保卸载动态创建的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T00:08:20.237

查看`ExpandoObject`，它为执行此类操作提供了动态语言支持。您可以使用它在运行时向您的 POCO 添加其他属性。这是使用 .NET 的 DLR 功能的链接：http: [//msdn.microsoft.com/en-us/library/system.dynamic.expandoobject%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject%28v=vs.100%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T00:28:11.790

为什么不对所有属性使用键值对，或者至少是动态属性？

[http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx)

您可以按照您使用反射描述的方式进行操作，但它会影响性能，这种方式也允许删除属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:06:13.303

我目前正在从事的项目有类似的要求。我们有一个已经投入生产的系统，并且有一个客户请求添加字段。

我们通过简单地向我们的模型添加一个 CustomFields 属性来解决这个问题。

```
public class Model: IHasId<Guid>
{
    [PrimaryKey]
    [Index(Unique = true)]
    public Guid Id { get; set; }

    // Other Fields...

    /// <summary>  
    /// A store of extra fields not required by the data model.  
    /// </summary>  
    public Dictionary<string, object> CustomFields { get; set; }  
} 
```

我们已经使用它几个星期了，没有任何问题。

我们从中发现的另一个好处是，每一行都可以有自己的自定义字段，因此我们可以在每条记录的基础上处理它们，而不是对每条记录都要求它们。

# java - Java 创建临时文件

> ID：14420431
> 
> 赞同：4
> 
> 时间：2013-01-20T00:24:13.200
> 
> 标签：java

`TempFile`java中的最大名称长度是多少，`MaximumFilesize`取决于我们提到要创建的临时目录或其他基于java的机器？

什么时候调用该`deleteOnExit()`方法---但是这个方法有什么用，因为它在 JVM 关闭时被调用。但是在基于生产的服务器中将运行 24*7。所以文件将不断创建，这将是问题由于内存，我们在其中创建文件的服务器。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T02:34:25.847

要自动清理早于（修改）XX 秒的临时文件...

```
import java.io.File;
import java.io.IOException;
import java.util.HashSet;

public class FileAutoCleaner {
    final static FileAutoCleaner singleton = new FileAutoCleaner();
    final HashSet<File> bag = new HashSet<File>();

    public static FileAutoCleaner getInstance() {
        return singleton;
    }

    // This create the temp file and add to bag for checking
    public synchronized File createTempFile(String prefix, String suffix) throws IOException {
        File tmp = File.createTempFile(prefix, suffix);
        tmp.deleteOnExit();
        bag.add(tmp);
        return tmp;
    }

    // Periodically call this function to clean old files   
    public synchronized void cleanOldFiles(final int secondsOld) {
        long now = (System.currentTimeMillis() / 1000);
        for (File f : bag) {
            long expired = (f.lastModified() / 1000) + secondsOld;
            if (now >= expired) {
                System.out.println("Deleted file=" + f.getAbsolutePath());
                f.delete();
                bag.remove(f);
            }
        }
    }

    public static void main(String[] args) throws Exception {
        FileAutoCleaner fac = FileAutoCleaner.getInstance();
        System.out.println(System.currentTimeMillis() / 1000);
        fac.createTempFile("deleteme", "tmp");
        for (int i = 0; i < 5; i++) {
            System.out.println(System.currentTimeMillis() / 1000);
            // delete if older than 2 seconds
            fac.cleanOldFiles(2);
            Thread.sleep(1000);
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T00:28:10.753

> java中TempFile的最大名称长度是多少，MaximumFilesize取决于我们提到要创建的临时目录或其他基于java的机器？

```
 1775           static File generateFile(String prefix, String suffix, File dir) {
 1776               long n = random.nextLong();
 1777               if (n == Long.MIN_VALUE) {
 1778                   n = 0;      // corner case
 1779               } else {
 1780                   n = Math.abs(n);
 1781               }
 1782               return new File(dir, prefix + Long.toString(n) + suffix);
 1783           } 
```

所以文件名可以是任何`long`带有前缀后缀的随机文件名

> 何时调用 deleteOnExit() 方法 --- 但是这个方法有什么用，因为它在 JVM 关闭时被调用。但是在基于生产的服务器中，将运行 24*7

有一些文件需要为应用程序生命创建，

**例如**，当您启动 Eclipse 时，您将看到创建 .lock 文件以锁定工作空间，当您的 Eclipse 存在时，它将被删除

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T02:11:30.993

java 中的最大文件大小限制为 Long.MAX_VALUE 但是....这个和文件名长度受底层文件系统的限制....如[EXT4](http://en.wikipedia.org/wiki/EXT4) (Linux) 或[NTFS](http://en.wikipedia.org/wiki/NTFS) (Windows)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-29T11:39:49.923

String tmpDir = System.getProperty("java.io.tmpdir");
文件file=new File(tmpDir+"\"+fileName+".tmp");

# php - httppost Android，值未传递到数据库以创建用户

> ID：14420437
> 
> 赞同：0
> 
> 时间：2013-01-20T00:25:26.587
> 
> 标签：php, android, sql, http-post

我已经成功地使用 httppost 从 java Android 代码通过 php 到 mysql 创建了身份验证。但是，我在创建新用户时遇到问题。我检查了其他用户的多个帖子，我认为它看起来不错。另外，我创建了一个简单的 html 表单来测试新用户的 php 创建，这也有效。

任何想法将不胜感激。这是我的java代码和下面的PHP。谢谢！

```
 try {
            // create new array list
            nameValuePairs = new ArrayList<NameValuePair>();

            // place them in an array list
            nameValuePairs.add(new BasicNameValuePair("username", user));
            nameValuePairs.add(new BasicNameValuePair("password", pass));

            // add array list to http post
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            // assign executed form container to response
            response = httpclient.execute(httppost);

            // check status code,
            if (response.getStatusLine().getStatusCode() == 200) {
                // assign response entity to htpp entitiy
                entity = response.getEntity();

                // chekc if entity is not null
                if (entity != null) {

                    Log.i("RESPONSE",EntityUtils.toString(entity));

                    Intent intent = new Intent(CreateAccount.this,
                            MainActivity.class);
                    startActivity(intent);

                    // }

                    // display a taost saying login was a success
                    Toast.makeText(CreateAccount.this, user,
                            Toast.LENGTH_SHORT).show();
                    // }

                }
            }
        } catch (Exception e) {
            e.printStackTrace();
            // display toast when there is a connection error
            Toast.makeText(getBaseContext(), "ConnectionError",
                    Toast.LENGTH_SHORT).show();
        } 
```

PHP代码：

```
 //get form data

$user = mysql_real_escape_string($_POST['user']);

$pass = mysql_real_escape_string($_POST['pass']);

echo "INSERT INTO androidlogin (user, pass) VALUES ('$user','$pass')";

//insert data
$insert = mysql_query("INSERT INTO androidlogin (user, pass) VALUES  ('$user','$pass')");
if($insert){
$arr2 = array("user" => $user, "pass" => $pass);
echo json_encode($arr2);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:48:44.910

发布值时称为“用户名”和“密码”，而服务器检查“用户”和“密码”。您必须使用相同的密钥。

# java - 只需在 Java 中打开一个端口

> ID：14420439
> 
> 赞同：4
> 
> 时间：2013-01-20T00:25:44.530
> 
> 标签：java, sockets, networking, upnp

我正在编写一个程序，该程序需要两台机器通过 TCP 相互通信。

我对 java.net Socket 类和相关的东西有（非常）基本的了解。我担心路由器/防火墙会阻塞连接。我需要做的就是打开一个端口，以便使用 Java STL Socket 类。

一个朋友告诉我要考虑使用 upnp ，另一个关于 upnp 的 stackoverflow 问题建议使用[Cling](http://4thline.org/projects/cling/)。作为一个网络编程新手，Cling 对此似乎有点矫枉过正（而且我还不够先进，无法完全理解手册）。

如果我问错了问题，看错了地方等等，我很抱歉。我要做的就是连接两台机器来来回发送一些浮点数，而不必手动进入我的路由器并转发端口。

STL 中是否有任何东西可以自动执行此操作，或者任何简单的库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:39:44.033

首先第一件事：Java 中没有“STL”这样的东西。您可能指的是基本的 Java SDK。

其次，您要求“简单的方法”来执行一项操作，从网络的角度来看，这根本不是微不足道的。查看您的一个程序（程序 A）必须执行的最基本任务：表示其“目标”（程序 B）的网络位置。如果程序 B 在路由器后面，*您*对程序 B 的网络位置了解多少？没有。你只知道路由器的地址。

与防火墙相同。您担心防火墙会阻止您的连接吗？好吧，如果您的防火墙很好，那么您*希望*它们阻止除预先批准的连接之外的所有连接。

对于由 NAT 分隔的程序，执行所需操作的唯一明智方法是使用 UPnP。如果 Cling 太过分了，试试[weupnp 之](http://code.google.com/p/weupnp/)类的东西。

不过，没有免费的午餐。

如果程序 A 和程序 B 之间没有网络“屏蔽”设备（例如路由器），那么使用 Java SDK 进行的非常简单的 TCP/IP 编程应该可以正常工作。如果一路上*有网络设备，您将不得不通过配置设备或使用 UPnP 来应对它们。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:39:39.733

我会仔细看看以下教程：[http ://www.giantflyingsaucer.com/blog/?p=224](http://www.giantflyingsaucer.com/blog/?p=224)

这里的想法是一个名为的库`xsocket`创建在新信息到达时触发的事件。

# css - 固定大小的 div 匹配宽度

> ID：14420441
> 
> 赞同：0
> 
> 时间：2013-01-20T00:26:12.493
> 
> 标签：css, html, 3d

专家。

我正在为我的画廊制作旋转立方体效果，并且我已经在[他的主页](http://www.paulrhayes.com/experiments/cube-3d/touch.html)上查看了 Paul Hayes 实验立方体（要观看它，请使用 Google Chrome；否则它可能无法正常工作）。

目前的挑战是让它在移动设备上运行，自动适应页面宽度。否则，它太小了。立方体正面必须与浏览器匹配，这样您在转换过程中只能看到透视图。

我做了什么？

*   我尝试将外部 div 的宽度/高度设置为 100%
*   我尝试将所有 6 个边的偏移量更改为百分比。它部分工作，但 tranformZ 不适用于百分比数字
*   ...还有很多其他的东西；挣扎了好几个小时。我是如此接近，但无法解决如何使用 -webkit-perspective-origin 正确设置 .viewport 或 .cube 的转换点

然后我尝试从头开始构建它。我得到了我的立方体，将其缩放 100%，并且能够将其围绕自己的 y 轴翻转 180 度，并尝试将图像放在更远的位置（z 轴上的 -100%，但 translateZ 不能以 % 为单位工作我之前提到过）所以当我缩放浏览器时，它会四处移动。

所以，最大的问题是：是否有可能让整个立方体正面适合浏览器的整个宽度，这样它就可以缩放内容，不管它是什么？如果是，如何？

这是我正在使用的代码中最重要的部分：

```
img {
    min-width:100%; <-- tried width:100% as well. All images on the scene must be 100% in width and height
    min-height:100%;
}

.viewport {
-webkit-perspective: 800;
-webkit-perspective-origin: 50% 100px;
min-height: 100%;
min-width: 100%;
position:relative;
}

.cube {
position: relative;
margin: auto auto;
height: 300px; <- If I change this to percent, it looks very strange
width: 300px;
-webkit-transition: -webkit-transform 50ms linear;
-webkit-transform-style: preserve-3d;

}

.cube h2 {
color: #fff;
padding-top: 0;
margin-top: 0;
}

.cube a {
color: #fff;
}

.cube > div {
position: absolute;
height: 100%;
width: 100%;
}

.cube > div:first-child  {
-webkit-transform: rotateX(90deg) translateZ(150px); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T03:26:18.683

在你的页面头部试试这个

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
```

# php - 多个输入分成组

> ID：14420443
> 
> 赞同：2
> 
> 时间：2013-01-20T00:26:25.060
> 
> 标签：php, cakephp

所以我有这个表格来添加一个报告，我的报告有很多措施。我的问题是，我想将度量的显示“拆分”成组（度量属于一个组）。

我有这个：

```
//Controller/Report/add

$measures = $this->Report->Measure->find('list'); 
```

还有这个：

```
//View/Report/add.ctp

echo $this->Form->input('Measure', array('label' => false, 'multiple' => 'checkbox')); 
```

这输出：

```
<div class="input select">
    <input type="hidden" name="data[Measure][Measure]" value="" id="MeasureMeasure"/>
    <div class="checkbox">
        <input type="checkbox" name="data[Measure][Measure][]" value="1" id="MeasureMeasure1" />
        <label for="MeasureMeasure1">
            ...
        </label>
    </div>

      ....
</div> 
```

但是我需要类似的东西：

```
<h2>Measure Group 1</h2>
    <div class="input select">
        <input type="hidden" name="data[Measure][Measure]" value="" id="MeasureMeasure"/>
        <div class="checkbox">
            <input type="checkbox" name="data[Measure][Measure][]" value="1" id="MeasureMeasure1" />
            <label for="MeasureMeasure1">
                ...
            </label>
        </div>

          ....
    </div>
<h2>Measure Group 2</h2>
    <div class="input select">
        <input type="hidden" name="data[Measure][Measure]" value="" id="MeasureMeasure"/>
        <div class="checkbox">
            <input type="checkbox" name="data[Measure][Measure][]" value="1" id="MeasureMeasure1" />
            <label for="MeasureMeasure1">
                ...
            </label>
        </div>

          ....
    </div> 
```

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T10:50:22.837

在将请求数据设置为视图时，预填充字段以进行编辑需要一些额外的工作，但您可以执行以下操作：

```
echo $this->Form->input('Measure.Measure.group1', array('options'=>$options, 'label' => false, 'multiple' => 'checkbox'));
echo $this->Form->input('Measure.Measure.group2', array('options'=>$options, 'label' => false, 'multiple' => 'checkbox')); 
```

应该在你的控制器中给你一些像这样的东西：

```
pr($this->data['Measure']['Measure']['group1']);

array(
   [0] => someval,
   [1] => some other val
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T17:27:20.233

好的，所以我解决了它，基本上我做到了：

```
$this->loadModel('Measuregroup');
$this->Measuregroup->contain();
$measureGroups = $this->Measuregroup->find('all');
foreach ($measureGroups as $measureGroup) {
    $measures[$measureGroup['Measuregroup']['name']] = 
        $this->Report->Measure->find('list',
            array('conditions' => array(
                'Measure.measuregroup_id' => $measureGroup['Measuregroup']['id'])));
} 
```

在这个视图中：

```
echo $this->Form->input('Measure', array('label' => false, 'multiple' => 'checkbox')); 
```

# ruby-on-rails - Ruby on rails：memcached 读取值为 nil

> ID：14420446
> 
> 赞同：0
> 
> 时间：2013-01-20T00:27:03.783
> 
> 标签：ruby-on-rails, memcached

我继承了一个看起来像是在使用 memcached 的 Rails 项目。

我有一个控制器，在一种方法中，我将一个值存储在缓存中：

```
 Rails.cache.write("key", @var) 
```

在随后在同一个控制器中调用的另一种方法中，我将其读回：

```
@var = Rails.cache.read("key") 
```

并且变量为零。为什么缓存不起作用？我刚刚开始使用 ROR，所以很有可能它是非常基本的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T08:41:12.050

只需检查几件事：

1.  您是否在开发环境中启用了缓存？

    您没有说您使用的是哪个版本的 RoR，但是默认情况下`development`环境中未启用缓存。

    要启用它，请`config.action_controller.perform_caching = true`在`config/environments/development.rb`文件中设置。

2.  您是否启动了 memcached 服务器？

    如果没有，请从`memcached -vv`

如果当您尝试写入缓存时您的 memcached 服务器已关闭，则调用`Rails.cache.write`将返回`false`，随后的调用`Rails.cache.read`将因此返回`nil`。

# ruby-on-rails - Rails：跟踪回调

> ID：14420449
> 
> 赞同：0
> 
> 时间：2013-01-20T00:27:41.247
> 
> 标签：ruby-on-rails, callback

我有一个模型无法使用 update_attributes 正确更新，但会使用 update_column 进行更新。我假设这是因为回调正在干扰。不幸的是，它没有抛出任何错误，所以我无法弄清楚问题到底出在哪里。

有没有办法跟踪回调，以便我可以一个一个地检查它们，直到找到罪魁祸首？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T06:51:56.907

[API 文档](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html#label-Debugging+callbacks)展示了如何访问回调链。

这是您可以在控制台中使用的一些衬里，它们应该会给您这个想法：

```
# Print before_validate callbacks
Post._validate_callbacks.select { |cb| cb.kind.eql? :before }.each { |cb| puts cb.filter }

# Print after_update callbacks
Post._update_callbacks.select { |cb| cb.kind.eql? :after }.each { |cb| puts cb.filter } 
```

请记住，对模型的更新也会调用 save，因此最好将它们全部浏览一遍。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-20T01:16:35.193

检查您传递给该`update_attributes()`方法的参数是否可批量分配。

它们应该`:attr_accessible`在您的 rails 模型中定义，否则它们将在保存之前被删除。

```
class Widget < ActiveRecord::Base
  attr_accessible :name
end 
```

更多信息在这里[http://guides.rubyonrails.org/security.html](http://guides.rubyonrails.org/security.html)

# windows-phone - windows phone 模拟器无法创建虚拟机

> ID：14420454
> 
> 赞同：6
> 
> 时间：2013-01-20T00:28:13.220
> 
> 标签：windows-phone, hyper-v, ipv4, windows-phone-8-emulator

我刚刚将它安装在我的 Windows 8 上。它不是在 VM 上运行，而是在带有 bootcamp 的 macbook 上运行。当我尝试模拟我的应用程序时，我收到了第一个错误：

![在此处输入图像描述](../Images/7e02b450c0411d28122dc40bc33a36df.png)

但是然后我单击“重试”并授予权限，因此它可以正常运行。

但是，当 windows phone 窗口出现时，我得到一个“正在加载”屏幕，然后出现此错误：

![在此处输入图像描述](../Images/fc0978d104eb7395f39e1ce929edf4b4.png)

只是为了更好地标记帖子，我会写下错误：“创建交换机时发生了一些事情：Xde 找不到主机的 IPv4 地址”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T12:47:38.667

您必须在 BIOS 中启用虚拟化并转到控制面板->程序->打开或关闭 Windows 功能并选择 Hyper-V。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T15:38:21.490

我有这个问题。

1- 打开控制面板。

2- 然后程序。

3- 打开或关闭 Windows 功能。

4- 进一步选择 hyper-v。

5-重新启动计算机。

6- 重复前面的步骤，但将选择放在 hyper-v 上。

7-重新启动计算机。

欣赏^_^

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T13:00:45.587

不确定您是否找到了解决方案，但我也遇到了同样的情况。事实证明，较旧的 VPN 客户端可能与 Windows 8 存在兼容性问题。我通过卸载 VPN 客户端解决了这个问题（并确保启用了 Hyper-V）。

# iphone - 在上下文内存分配中渲染

> ID：14420456
> 
> 赞同：0
> 
> 时间：2013-01-20T00:28:16.787
> 
> 标签：iphone, ios, objective-c, uikit

我早些时候发布了[这个](https://stackoverflow.com/questions/14418063/core-data-memory-allocation)关于内存分配问题的问题，并且能够在一些帮助下解决它。我还有另一个问题，可以在下面的屏幕截图中看到。我尝试了一些我在网上看到的不同示例，这些示例有助于释放图像上下文，但似乎没有任何效果。任何帮助都会很棒。

顺便说一句，我在屏幕截图中错过了 [localPool drain]。这是下一行。

![在此处输入图像描述](../Images/b1740e57cf963d44264c57debfe89e49.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:25:09.760

如果我理解正确，您的问题是：

> 释放图像上下文，但似乎没有任何效果

调用`UIGraphicsGetCurrentContext()`并将其存储在`CGContextRef`变量中。在您的函数中使用此变量，而不是获取上下文的新调用。

然后，当您完成绘图时，调用`CGContextRelease()`.

# c# - 在字符串中查找分隔符并标记该位置

> ID：14420460
> 
> 赞同：1
> 
> 时间：2013-01-20T00:28:32.043
> 
> 标签：c#, delimiter

我试图弄清楚如何在用户输入的文本字符串中记录分隔符的位置。

因此，如果用户输入文本：

橙红绿黄？

```
 *  *    *     * 
```

我想在每个单词后面加上问号标记空格。（那些星星应该与分隔符对齐。）

我知道如何在字符串中搜索某个字符或一组字符，但不知道如何将其标记为在下一行接收星号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T00:32:38.877

```
string input = "orange red green yellow?";
List<int> indexes = Regex.Matches(input, @"[^\w]+").Cast<Match>()
                        .Select(m => m.Index)
                        .ToList(); 
```

或者如果你想用`*`

```
var output = Regex.Replace(input, @"[^\w]+","*"); 
```

**编辑**

```
var output = String.Join("",input.Select(c => char.IsLetter(c)?" ":"*")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:39:29.760

```
text = text.Replace(" ", "? "); 
```

# primefaces - 可编辑 p:dataTable 中的行更新后无法刷新表单或页面

> ID：14420462
> 
> 赞同：1
> 
> 时间：2013-01-20T00:28:49.453
> 
> 标签：primefaces, datatable

我对 dataTable 的 rowEdit 有一个奇怪的行为。当我修改表格的一行时，该行修改成功，但我无法刷新表单或页面，我尝试了解决方案

```
<p:ajax event="rowEdit" update="@form" listener="#{pecBean.onEdit}"/> 
```

结果：表格没有完全显示。然后我尝试了

```
<p:ajax event="rowEdit" update="@all" listener="#{pecBean.onEdit}"/> 
```

结果：页面在完整源代码下方未完全刷新。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:composite="http://java.sun.com/jsf/composite"
    xmlns:p="http://primefaces.org/ui"
    xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
    <title>(For validation only)</title>
    <link href="./css/styles.css" rel="stylesheet" type="text/css" />
</h:head>
<body class="bodyMain">

    <composite:interface />
    <composite:implementation>
        <h:form id="form" prependId="false">
            <h:panelGrid>
                <h:panelGrid id="recapActes">
                    <h:panelGrid>
                        <p:panel id="recapGlobale" header="Récap globale Prise en charge">
                            <h:panelGrid>
                                <h:panelGrid columns="4">
                                    <h:outputText styleClass="lib" value="Total PEC Base" />
                                    <h:outputText styleClass="valeur"
                                        value="#{pecBean.recapPec.totalRemboursementBase}">
                                    </h:outputText>
                                    <h:outputText styleClass="lib" value="Total PEC complémentaire" />
                                    <h:outputText styleClass="valeur"
                                        value="#{pecBean.recapPec.totalRemboursementComplementaire}">
                                    </h:outputText>
                                </h:panelGrid>
                            </h:panelGrid>
                        </p:panel>
                    </h:panelGrid>
                    <h:panelGrid>
                        <p:dataTable sortBy="#{am.acte.categorieActe.code}"
                            editable="true" rowKey="#{am.idActePec}"
                            value="#{pecBean.actesPec}" var="am">
                            <p:ajax event="rowEdit" update="@all"
                                listener="#{pecBean.onEdit}" />
                            <p:column>
                                <f:facet name="header">Code acte</f:facet>
                                #{am.acte.code}
                            </p:column>
                            <p:column styleClass="bla">
                                <f:facet name="header">Lib acte</f:facet>
                                #{am.acte.libelle}
                            </p:column>
                            <p:column>
                                <f:facet name="header">Coefficient</f:facet>
                                #{am.coefficientActe}
                            </p:column>
                            <p:column>
                                <f:facet name="header">Quantité souscrite</f:facet>
                                #{am.quantiteActeSouscrit}
                            </p:column>
                            <p:column>
                                <f:facet name="header">Quantité accordée</f:facet>
                                <p:cellEditor>
                                    <f:facet name="output">
                                        <h:outputText value="#{am.quantiteActeAccorde}" />
                                    </f:facet>
                                    <f:facet name="input">
                                        <h:inputText value="#{am.quantiteActeAccorde}" required="true" />
                                    </f:facet>
                                </p:cellEditor>
                            </p:column>
                            <p:column>
                                <f:facet name="header">Observation</f:facet>
                                <p:cellEditor>
                                    <f:facet name="output">
                                        <h:outputText value="#{am.observation}" />
                                    </f:facet>
                                    <f:facet name="input">
                                        <h:inputTextarea value="#{am.observation}" />
                                    </f:facet>
                                </p:cellEditor>
                            </p:column>
                            <p:column>
                                <f:facet name="header">Pec Base</f:facet>
                                <h:outputText value="#{am.rembBase}">
                                </h:outputText>
                            </p:column>
                            <p:column style="text-align:right">
                                <f:facet name="header">Pec Compl</f:facet>
                                <h:outputText
                                    value="#{am.rembComplementaire}">
                                </h:outputText>
                            </p:column>
                            <p:column>
                                <p:rowEditor />
                            </p:column>
                        </p:dataTable>
                    </h:panelGrid>
                </h:panelGrid>
            </h:panelGrid>
        </h:form>

    </composite:implementation>

</body>
</html> 
```

谢谢你的帮助。

# php - 不能将字符串偏移量用作数组

> ID：14420463
> 
> 赞同：0
> 
> 时间：2013-01-20T00:29:01.140
> 
> 标签：php, arrays, multidimensional-array, fatal-error

嘿伙计们，我有一个看起来像这样的数组

```
Array
(
        [0] => Array
                (
                        [Marque] => AUDI
                        [Famille] => A4 Avant N1
                )
        [1] => Array
                (
                        [Marque] => AUDI
                        [Famille] => A3
                )
        [2] => Array
                (
                        [Marque] => AUDI
                        [Famille] => A5
                )
        [3] => Array
                (
                        [Marque] => AUDI
                        [Famille] => A4
                )
) 
```

我需要一个看起来像这样的数组：

引用

```
Array
(
    [AUDI] => Array
    (
        [0] => A4 Avant N1
        [1] => A3
        [2] => A5
        [3] => A4
    )

) 
```

所以票价我得到了这个：

```
if (isset($_GET['debug'])){ $stri=array(); $i=0; foreach($csv_array as $car){
    if ( !in_array("$car[Marque]", $stri) ) {
    $stri[] = "$car[Marque]";
    }
    if ( !in_array("$car[Famille]", $stri) ) {
    $stri[$i][$car[Marque]][] = "$car[Famille]";
    }     $i++; }

echo "<pre>"; print_r($stri); echo "</pre>"; 
```

但这给了我

致命错误：不能将字符串偏移量用作数组

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:30:58.827

尝试在数组键周围加上引号：

```
if (isset($_GET['debug'])){ $stri=array(); $i=0; foreach($csv_array as $car){
    if ( !in_array("$car['Marque']", $stri) ) {
    $stri[] = "$car['Marque']";
    }
    if ( !in_array("$car['Famille']", $stri) ) {
    $stri[$i][$car['Marque']][] = "$car['Famille']";
    }     $i++; }

echo "<pre>"; print_r($stri); echo "</pre>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:31:34.503

您必须使用单引号正确提取值：

```
$car[Famille] => $car['Famille'] 
```

[编辑]现在我明白了......

```
$stri = Array();

foreach($csv_array as $car)
{
    if (!array_key_exists("$car['Marque']", $stri))
    {
        $stri["$car['Marque']"] = Array();
        $stri["$car['Marque']"][] = "$car['Famille']";
    else
        $stri["$car['Marque']"][] = "$car['Famille']";
}

var_dump($stri); 
```

# javascript - js忽略条件

> ID：14420464
> 
> 赞同：0
> 
> 时间：2013-01-20T00:29:05.910
> 
> 标签：javascript, conditional-statements

```
$(document).ready(function() {
if ((screen.width==240) )
{
 $('.verybig').hide();
}
else
{ 
  $('.verybig').show();
}
}); 
```

我希望屏幕为 240 像素的移动设备隐藏 ui 元素的“非常大”类。以上看起来像一个正确的条件吗？我找不到代码以完全不可预测的方式运行的任何模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:30:13.557

我认为您想使用*小于或等于*.

```
$(document).ready(function() {
    if (screen.width<=240) {
        $('.verybig').hide();
    } else { 
        $('.verybig').show();
    }
}); 
```

您可以将其重构为：

```
$(function() {
    $('.verybig').toggle(screen.width > 240);
}); 
```

# ajax - amazon S3 数据库选项并使用 EC2 作为 S3 的 REST api

> ID：14420466
> 
> 赞同：1
> 
> 时间：2013-01-20T00:29:23.587
> 
> 标签：ajax, amazon-web-services, amazon-s3, amazon-ec2, cross-domain

我在 S3 上托管我的网站。在我的本地主机上，我在使用 mySQL 作为数据库的 PHP Rest API 之上使用了主干JS。

所以我打开了一个 EC2 来托管我的 Rest API，但后来意识到这意味着跨域 AJAX。

如果我的 index.html 位于 S3 上，我如何将 EC2 用作 Rest API？

S3 的其他数据库选项是什么？

非常感谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T16:01:04.603

您的 JavaScript 正在 S3 提供的网页上执行，它必须从您在 EC2 上运行的服务器访问 REST API。除非网页和服务器在同一个域中（例如 example.com），否则这将是一个跨域请求，默认情况下被浏览器禁止。

解决方案 1：让您的 S3 页面和您的 EC2 服务器在同一个域中。S3 允许[静态网站托管](http://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteHosting.html)，使您的 S3 对象（网页）在您选择的地址可用。将它们和您的 EC2 服务器放在同一个域中的地址，它就可以工作。

解决方案 2：让您的 REST API 服务器允许跨域请求。由于您控制此 EC2 服务器，因此您可以对其进行修改以告诉 Web 浏览器允许来自其他域的页面向您的服务器发出此类请求。这涉及在您的响应中设置多个标头，并且通常要求您的服务器也正确响应 HTTP OPTIONS 请求。请参阅[CORS 规范](http://www.w3.org/TR/cors/)以开始使用。

您还询问其他数据库选项。如果您保留自己的 EC2 服务器来提供 REST API，它几乎可以使用您喜欢的任何类型的数据库，无论是在相同或其他 EC2 实例上运行，还是在 AWS RDB 或 AWS DynamoDB 等数据库即服务产品上运行。但是，如果您想直接从网页的 JavaScript 连接到数据库，则必须使用直接提供 HTTP API 并支持 CORS 的服务。RDB 根本不提供 HTTP API，而 DynamoDB 目前似乎不支持 CORS，因此它们都不起作用。

# php - 如何使用 PHP 冻结动画 gifs/转换为 jpg？

> ID：14420470
> 
> 赞同：0
> 
> 时间：2013-01-20T00:29:58.453
> 
> 标签：php, gif

我有一个带有一堆动画 gif 的页面，我想使用 PHP 在页面加载时冻结它们或将每个转换为 jpg/png。我遇到了这个[http://php.net/manual/en/function.imagecreatefromgif.php](http://php.net/manual/en/function.imagecreatefromgif.php)但我对 PHP 不太熟悉。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T06:53:51.583

这是将动画 gif 转换为 jpg 的代码。取自**[PHP 手册条目的此评论](http://php.net/manual/ru/function.imagecreatefromgif.php#59853)**

```
<?php

//This function gif2jpeg take three parameter as argument. two argument are optional
//first will take the gif file name. second for file name to save the converted file. third argument is an color array

//EXAMPLE:
$gifName = $_GET['gif_name']; //ABSOLUTE PATH OF THE IMAGE (according to its location)
$c['red']=255;
$c['green']=0;
$c['blue']=0;
echo gif2jpeg($gifName, '', $c);

function gif2jpeg($p_fl, $p_new_fl='', $bgcolor=false){
  list($wd, $ht, $tp, $at)=getimagesize($p_fl);
  $img_src=imagecreatefromgif($p_fl);
  $img_dst=imagecreatetruecolor($wd,$ht);
  $clr['red']=255;
  $clr['green']=255;
  $clr['blue']=255;
  if(is_array($bgcolor)) $clr=$bgcolor;
  $kek=imagecolorallocate($img_dst,
                  $clr['red'],$clr['green'],$clr['blue']);
  imagefill($img_dst,0,0,$kek);
  imagecopyresampled($img_dst, $img_src, 0, 0,
                  0, 0, $wd, $ht, $wd, $ht);
  $draw=true;
  if(strlen($p_new_fl)>0){
    if($hnd=fopen($p_new_fl,'w')){
      $draw=false;
      fclose($hnd);
    }
  }
  if(true==$draw){
    header("Content-type: image/jpeg");
    imagejpeg($img_dst);
  }else imagejpeg($img_dst, $p_new_fl);
  imagedestroy($img_dst);
  imagedestroy($img_src);
}

?> 
```

如何使用：

*   将上述代码添加到 php 文件“convertGifToJpeg.php”中
*   添加一个 <img 标签。<img src="http://apllicationdomainpath/convertGifToJpeg.php?gif_name=/images/animated_gif.gif" width="200" height="200" />
*   确保为 gif 图像和 php 文件提供了正确的名称/路径。

# ios - 核心绘图轴标签不使用我的数字格式化程序

> ID：14420471
> 
> 赞同：1
> 
> 时间：2013-01-20T00:30:09.530
> 
> 标签：ios, core-plot

我正在使用 CorePlot 并且我正在尝试使用我的数字格式化程序，但轴上的标签显然没有使用我的格式化程序。这是我正在使用的代码：

```
CPTXYGraph *xygraph = [[CPTXYGraph alloc] initWithFrame:fullFrame];
self.graph = xygraph;
self.graph.title = @"Plot of Statistical Data Points";
self.graph.titleDisplacement = CGPointMake(0, -10);

hostingView.hostedGraph = self.graph;

CPTAxisSet *axisSet = xygraph.axisSet;
for (CPTAxis *axis in axisSet.axes) {
    NSLog(@"setting axis (%@) label formatter=%@ -> %@", axis, axis.labelFormatter, self.formatter.completedValueFormatter);
    axis.labelFormatter = self.formatter.completedValueFormatter;
} 
```

我已经验证 self.formatter.completedValueFormatter 是一个很好的 NSNumberFormatter，但是轴上的标签没有使用我的格式化程序。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:26:29.057

我在 Plot Gallery 示例应用程序中测试了您的代码，并且更改标签格式化程序似乎在最新代码中正常工作。

# mysql - query_cache_type：启用还是禁用？

> ID：14420475
> 
> 赞同：11
> 
> 时间：2013-01-20T00:30:23.003
> 
> 标签：mysql, wordpress, percona

最近，我从标准 MySQL 迁移到`Percona`.，并使用[Percona Wizard](https://tools.percona.com/wizard)生成`my.cnf`.

但是，我可以看到，默认情况下，生成的设置`my.cnf`使用`query_cache_type = 0`. （查询缓存被禁用）。

我在服务器上运行的唯一东西是一个 Wordpress 博客。我的问题是：

1.  我可以启用查询缓存吗？
2.  有一些提供数据库缓存的 Wordpress 插件。结果是否类似于启用查询缓存？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-20T06:26:47.577

MySQL查询缓存是一种缓存机制，它将查询的文本（例如'SELECT * FROM users WHERE deleted = 0'）和查询的结果存储到内存中。请检查[此链接](http://www.cyberciti.biz/tips/enable-the-query-cache-in-mysql-to-improve-performance.html)以了解如何在您的服务器中启用 mysql 查询缓存。

另一方面，wordpress[数据库缓存插件通过在临时文件中缓存查询来减少对数据库的查询次数（检查缓存目录 wp-content/tmp/ 以获取缓存文件）。](http://wordpress.org/extend/plugins/db-cache-reloaded/faq/)

以上两段证明了Wordpress db cache和mysql query cache是​​不同的。

mysql 查询缓存仅当您的站点执行的 mysql 读取多于写入时才应启用。由于您的网站是 wordpress 网站，是的，您可以尝试启用 mysql 查询缓存。

希望我回答了你的 2 个问题。

# javascript - 如何_really_删除/清除/忘记javascript中的对象实例？

> ID：14420476
> 
> 赞同：2
> 
> 时间：2013-01-20T00:30:24.357
> 
> 标签：javascript, object

我想知道如何正确“清除”对象实例。使用下面的代码，即使在实例被父级“清除”后，内部 setInterval() 仍将继续运行。

```
// simple Class
var aClass = function(){
    return {
        init: function(){
            console.log("aClass init()")
            setInterval( this.tick, 1000 );
            // note: we're not storing the ref
        },
        tick: function(){
            console.log("aClass tick");
        }
    }
}

// instantiate the class
var inst = new aClass();
inst.init();

// try to forget the instance
function test(){
    console.log("test() 1 inst:", inst);

    inst = null;

    console.log("test() 2 inst:", inst);
}

// run for a while, then call test()
setTimeout( test, 4000 ); 
```

输出：

```
aClass init()
aClass tick
aClass tick
aClass tick
test() 1 inst: {.....}
test() 2 inst: null
aClass tick
aClass tick ... 
```

问题是“aClass tick”消息在 test() 之后继续打印。

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T00:37:30.263

您的实例被保存在内存中，因为您传递给的函数`setInterval`被保存在内存中并且具有对它的引用。该函数被浏览器的活动间隔计时器列表引用。

您需要记住间隔句柄：

```
this.intervalHandle = setInterval( this.tick, 1000 ); 
```

...然后稍后当您删除对 的引用时`inst`，您会想告诉它：

```
inst.cleanup();
inst = null; 
```

...并在`inst.cleanup`：

```
clearInterval(this.intervalHandle); 
```

这样，浏览器将删除它对您传递给的函数的引用`setInterval`，这意味着该函数将有资格进行垃圾收集（根据您的代码，没有其他对它的引用）。这意味着*它对*您的实例的引用已被释放，因此如果不存在对该实例的其他未完成引用，则它有资格进行垃圾回收。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T00:35:39.143

您应该使用`clearInterval()`而不是尝试删除引用。之前已经回答过这个问题 - 请参阅 [Stop setInterval call in JavaScript](https://stackoverflow.com/questions/109086/stop-setinterval-call-in-javascript)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T00:39:50.080

这是因为*浏览器本身*会跟踪使用`setInterval`和安排的所有功能`setTimeout`。（否则您必须自己将函数存储在某个地方，这在大多数情况下会很烦人。）并且您的函数引用了一个方法，因此该方法保持有效。但我怀疑物体的其余部分会被扔掉，尽管这有点难以证明。

如果您打算取消安排这样的功能，您需要明确地这样做：

```
this.interval = setInterval(function, 4000);

// and then later, in some `destroy()` method
clearInterval(this.interval); 
```

而且，顺便说一句，你应该很少需要从构造函数返回一个像这样的大哈希！改为使用原型：

```
var SomeClass = function() {
    // ...
};

SomeClass.prototype.method = function() {
    console.log('hello from', this);
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T03:03:00.680

我的猜测是您的 aClass 实例已经消失，因为无法访问它的任何属性，但是在 init 中，当用作 setinterval 的参数时，会复制刻度函数。

```
var tickfunction=null;
var aClass = function(){
    return {
        init: function(){
            console.log("aClass init()")
            tickfunction = this.tick;
        },
        tick: function(){
            console.log("aClass tick");
        }
    }
}

// instantiate the class
var inst = new aClass();
inst.init();

// try to forget the instance
console.log("test() 1 inst:", inst);
inst = null;
console.log("test() 2 inst:", inst);// its null isn't it?
console.log("the tickfunction:",tickfunction); 
```

为了说明函数被复制：

```
function toInterval(){
    console.log("orig");
}
setInterval(toInterval,1000);//prints orig every second
toInterval=function(){
    console.log("changed it");
}
toInterval();//prints changed it 
```

# node.js - 编译咖啡二进制文件

> ID：14420480
> 
> 赞同：3
> 
> 时间：2013-01-20T00:30:43.150
> 
> 标签：node.js, coffeescript, bin, shebang

如果我在 CoffeeScript 中编写我的整个项目，我该如何编写我的“二进制”文件？

```
#!/usr/bin/env coffee
# My program sits here 
```

然后，一旦编译，我就松开了 shebang：

```
// Generated by CoffeeScript 1.4.0
// My program sits here 
```

我希望它会变成这样的东西：

```
#!/usr/bin/env node
// My program sits here 
```

是否可以？还是我需要重新考虑我的工作方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T06:49:31.080

诀窍是不要在您的“二进制”文件上添加 .coffee 扩展名并且不要编译它。

我还建议您不要在二进制文件中放置任何重要的逻辑。相反，只需让二进制文件启动完整的源代码。

一般来说，我的每一个二进制文件都位于`/bin`我的项目根目录下的一个目录中，它只有这两行（比如我在 GitHub 上的 CoffeeDocTest 项目[）](https://github.com/lmaccherone/coffeedoctest/blob/master/bin/coffeedoctest)：

```
#!/usr/bin/env coffee
require(__dirname + '/../src/coffeedoctest') 
```

您还需要在其上运行`chmod 755 <filename>`以使其可执行。

[在此处](https://github.com/lmaccherone/coffeedoctest/blob/master/src/coffeedoctest.coffee)查看有关 main 如何`coffeedoctest.coffee`启动和处理命令行选项等的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T13:41:39.767

正如您推测的那样，您可能需要一个脚本来帮助您添加必要的 shebang 行。我通常会创建一个[Cakefile](http://coffeescript.org/#cake)任务来进行必要的编译并添加适当的第一行。

# z3 - Z3 SAT 求解器的 XOR 子句

> ID：14420486
> 
> 赞同：1
> 
> 时间：2013-01-20T00:31:56.113
> 
> 标签：z3, xor, conjunctive-normal-form

我正在使用 Z3 解决可满足性问题，包括数百个 XOR 子句，每个子句有 22 个输入。为了以 DIMACS 形式编码 XOR 子句，我使用了 Tseitin 编码。我的转换将 XOR 分解为更小的 CNF 子句，每个子句最多五个字面值。到目前为止，Z3 无法设计 SAT 解决方案。

我可以/应该做些什么来改进我的编码？

我看过高斯消元法，但这可能没有帮助，因为 XOR 表达式没有相同的输入变量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:09:09.473

Z3 有两个 SAT 求解器引擎，您可以使用策略框架启用更高效的引擎。例如，参见教程[Z3 - 策略](http://rise4fun.com/Z3/tutorial/strategies)

有一节说明了位向量公式的策略的使用：

```
 (declare-const x (_ BitVec 16))
 (declare-const y (_ BitVec 16))
 (assert (= (bvor x y) (_ bv13 16)))
 (assert (bvslt x y))
 (check-sat-using (then simplify solve-eqs bit-blast sat))
 (get-model) 
```

也就是说，使用 XOR 为基于 CDCL 的 SAT 求解器生成硬实例相对容易。例如：

```
Randal E. Bryant: A View from the Engine Room: Computational Support for Symbolic Model Checking. 25 Years of Model Checking 2008: 145-149 
```

Z3 更高效的 sat 求解器（由上面的示例调用）具有一些数据结构，用于检测和传播 xor（等价）。

# php - 检查一个值不在查询中的另一个表中

> ID：14420489
> 
> 赞同：0
> 
> 时间：2013-01-20T00:32:33.073
> 
> 标签：php, mysql, sql, select

我环顾四周，似乎找不到以下问题的答案：

我想要做的就是运行一个 SQL 选择语句，向用户显示提供发票编号（在本例中为唯一 ID）的内容未显示在同一数据库的另一个表中，目前代码如下：

```
$query = mysql_query("SELECT `ordate`, `invno` FROM `armast09` WHERE cshipno = '$username' AND `ordate` > DATE_SUB(CURDATE(), INTERVAL 4 DAY)") or die(header("location:index.php?e=4"));   
$numrows = mysql_num_rows($query);

$date = date('o-n-d');

include 'indexfiles/top.php';

    echo "The following deliveries are available for viewing / dispute:";
    echo "<br />";  
    echo "<br />";
    echo "<center>";
    echo "<table>"; 
        if($numrows != 0) {                 
            while ($info = mysql_fetch_array($query)) {
                echo "<tr>";                            
                    echo "<form action = \"deliverydispute.php?invno=".$info['invno']."\" method=\"POST\ onsubmit=\"return confirm('Are you sure you are ready to dispute? You can't go back after this.');\">";
                        echo "<td><b>Invoice Number: </b>".$info['invno']."</td>";
                        echo "<td><b>Order Date: </b>".$info['ordate']."</td>";                                 
                        echo "<td><a href = \"deliverydispute.php?invno=".$info['invno']."&&ordate=".$info['ordate']."\">Dispute</a></td>";
                    echo "</form>";                         
                echo "</tr>"; 
            }
        } else {
            echo ("<font color=\"red\" face=\"arial\" size=\"2\"><small>No orders are currently available for viewing.</small></font>");
        }
    echo "</table>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:37:08.217

您可以使用`NOT IN`谓词：

```
SELECT ordate, invno
FROM armast09
WHERE cshipno = '$username' 
  AND ordate > DATE_SUB(CURDATE(), INTERVAL 4 DAY) 
  AND invno NOT IN(SELECT invno FROM Anothertable WHERE invno IS NOT NULL); 
```

或者`LEFT JOIN`：

```
SELECT a.ordate, a.invno 
FROM armast09 a
LEFT JOIN anothertable a2 ON a.invno = a2.invno
WHERE a.cshipno = '$username' 
  AND a.ordate > DATE_SUB(CURDATE(), INTERVAL 4 DAY) 
  AND a.invno IS NULL; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:37:31.820

您可以使用以下方法轻松完成此操作：

```
SELECT X FROM TABLEA LEFT JOIN TABLEB ON TABLEA.ID = TABLEB.ID WHERE TABLEB.ID is null 
```

应该这样做！

# asp.net - 将 BackColor 设置为 DropDownList 中的项目绑定到 DetailsView 内的 ObjectDataSource

> ID：14420490
> 
> 赞同：0
> 
> 时间：2013-01-20T00:32:37.340
> 
> 标签：asp.net

如何在自定义绑定表达式中正确调用方法？由于下拉列表位于详细信息视图中，是否存在并发症？

asp.net 代码：

```
<asp:DropDownList ID="ddlExceptionEditStatus" runat="server"
      DataSourceID="odsExceptionsStatus"
      DataTextField="Name"
      DataValueField="StatusID"
      SelectedValue='<%# Bind("StatusID") %>' 
      BackColor="<%# SetBackColorProp(Container.DataItem) %>">
 </asp:DropDownList> 
```

后面的代码：

```
protected System.Drawing.Color SetBackColorProp(object o)
{
    System.Drawing.Color statusColor = System.Drawing.Color.White;
    string statusName = o as string;
    if (statusName != null)
    {
        statusColor = System.Drawing.ColorTranslator.FromHtml(FISBLL.StatusColors.GetColor(statusName));
        return statusColor;
    }
    else
    {
        return statusColor;
    }        
} 
```

不改变背景颜色。但不会抛出异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:20:07.433

所以，我犯了两个错误：

1) 我需要将 Container.DataItem 转换为我用于 ObjectDataSource 的类对象。投射后，下拉列表中每个项目的 BackColor 与投射的 Container.DataItem 的 StatusID 匹配。

2）不幸的是，这给了所有项目相同的颜色，因为我希望每个项目的颜色都反映附加到下拉列表的它们自己的值。这是因为下拉列表在其内部的 DetailsView 之外有一个 objectdatasource。因此，下拉列表的 selectedValue 项决定了所有其他项的颜色。

我决定接受 Tim 的建议，并为数据绑定事件中的每个项目绑定 BackColor 设置：

```
protected string GetColor(string name)
{
    return FISBLL.StatusColors.GetColor(name);
}

protected void ddlExceptionEditStatus_DataBound(object sender, EventArgs e)
{
    foreach (ListItem item in ((DropDownList)sender).Items)
    {
        item.Attributes.Add("style", "background-color:" + GetColor(item.Text));
    }

} 
```

并显示了正确的行为：

![在此处输入图像描述](../Images/4d453532331c5dafd5c2ab55e62d7503.png)

# php - 贝叶斯算法返回 0

> ID：14420494
> 
> 赞同：2
> 
> 时间：2013-01-20T00:32:57.900
> 
> 标签：php, mysql, bayesian

我试图通过 MySQL 和 PHP 在上周获得评分最高的照片。我发现贝叶斯公式可能是我需要的，但我一直在搞砸它无济于事。

以下代码不返回任何错误，它只返回一个“0”。为什么会这样，我一点也没有。

```
$bayesian_algo = "SELECT
            photo_id,
            (SELECT count(photo_id) FROM photo_ratings) / 
(SELECT count(DISTINCT photo_id) FROM photo_ratings) AS avg_num_votes,
            (SELECT avg(rating) FROM photo_ratings) AS avg_rating,
            count(photo_id) as this_num_votes,
            avg(rating) as this_rating
            FROM photo_ratings
            WHERE `date` > '$timeframe'
            GROUP BY photo_id";

$bayesian_info = $mysqli->query($bayesian_algo);

$all_bayesian_info = array();
while($row=$bayesian_info->fetch_assoc()) array_push($all_bayesian_info,$row);

list($photo_id,$avg_num_votes,$avg_rating,$this_num_votes,$this_rating) = $all_bayesian_info;
$photo_id = intval($photo_id);
$avg_num_votes = intval($avg_num_votes);
$avg_rating = intval($avg_rating);
$this_num_votes = intval($this_num_votes);
$this_rating = intval($this_rating);

$bayesian_result = (($avg_num_votes * $avg_rating) + ($this_num_votes * $this_rating)) / ($avg_num_votes + $this_num_votes);

echo $bayesian_result;  // 0?? 
```

我的数据库如下所示：

```
photo_id | user_id | rating | date 
```

所有字段都存储为 INT（我将日期存储为 UNIX 时间戳）。

我很累并且鲁莽地编码，通常如果有错误消息（或任何东西！），我至少可以走得更远，但如果我`var_dump($all_bayesian_info)`返回 0，我就无法获得数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T05:49:42.087

让我们在 mysql 查询本身中进行复杂的贝叶斯计算！

代码可以这样重写：

```
$bayesian_algo_result = "SELECT *, 
(((resultdata.avg_num_votes * resultdata.avg_rating) + (resultdata.this_num_votes * resultdata.this_rating)) / (resultdata.avg_num_votes + resultdata.this_num_votes)) AS bayesian_result
FROM 
(    
SELECT
    photo_id,
    (SELECT count(photo_id) FROM photo_ratings) / 
      (SELECT count(DISTINCT photo_id) FROM photo_ratings) AS avg_num_votes,
    (SELECT avg(rating) FROM photo_ratings) AS avg_rating,
    count(photo_id) as this_num_votes,
    avg(rating) as this_rating    
FROM photo_ratings
WHERE `date` > '$timeframe'
GROUP BY photo_id
) AS resultdata;
";

$bayesian_result_info = $mysqli->query($bayesian_algo_result);

//loop through the rows.
while($row = $bayesian_result_info->fetch_assoc()) {
    list(
        $photo_id,
        $avg_num_votes,
        $avg_rating,
        $this_num_votes,
        $this_rating, 
        $bayesian_result
    ) = $row;

    echo 'Balesian rating for photo' . $photo_id . ' is: ' . $bayesian_result;
} 
```

笔记：

*   这是一个有效的 sql fiddle：[http ://sqlfiddle.com/#!2/d4a71/1/0](http://sqlfiddle.com/#!2/d4a71/1/0)

*   我没有对您的公式进行任何逻辑更改。所以请确保你的公式是正确的。

*   如果/当 UNIX 时间戳变为 64 位数据类型时，则必须使用 MySQL“bigint”来存储它们（用于“日期”列）。

# python - 用 python re 查找并替换我的文件名中的字符

> ID：14420498
> 
> 赞同：1
> 
> 时间：2013-01-20T00:34:15.197
> 
> 标签：python, regex, replace

基本上我想将第一个`"."`更改`"_"` `Name.1001.ext`为`Name_1001.ext`：

我有这样的东西，但它正在返回原始名称：

```
print re.sub(r'\D+.\d+\.$',r'\D+_\d+\.$',fileName) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T00:35:38.290

`Regex`这个例子似乎有点过头了，你应该去`str.replace()`这里：

```
In [16]: strs="Name.1001.ext"

In [17]: strs.replace(".","_",1) # now only 1 occurrence of the 
                                 # substring is going to be replaced 
Out[17]: 'Name_1001.ext' 
```

> S.replace(old, new[, count]) -> 字符串
> 
> 返回字符串 S 的副本，其中所有出现的子字符串 old 都替换为 new。如果给定了可选参数 count，则仅替换第一个 count 出现。

# c++ - 如何自动设置和获取方法？

> ID：14420500
> 
> 赞同：1
> 
> 时间：2013-01-20T00:34:25.787
> 
> 标签：c++, templates

我接受 onathan Wakely 的评论作为答案。谢谢！以下为原帖。

[原帖] 对自动在类中设置和获取方法有一个想法，如下所示

```
template<class T>
class Has
{
public:
    template<class U>
    const U& get() const;

    template<>
    const T& get<T>() const
    {
        return m_t;
    }

    template<class U>
    void set(const U& t);

    template<>
    void set<T>(const T& t)
    {
        m_t = t;
    }

private:
    T m_t;
}; 
```

一个例子

```
class Door {};
class Window {};

class House
    : public Has<Door>
    , public Has<Window>
{};

House house;

// set
house.set(Door());
house.set(Window());

// get
const Door& door = house.get<Door>();
const Window& window = house.get<Window>(); 
```

如果组件的类型不同并且它们的类型名称是可读的，那么上面显示的代码就可以了。但是如果类型名称不可读，例如房子的面积有一个类型double，我想使用

```
house.get<Area>(); // or
house.get<AREA>(); // where the template argument can be a const integer 
```

以外

```
house.get<double>(); 
```

而如果有面积和体积这两个双重类型的分量，那么复数怎么处理呢？非常感谢！

有一种方法可以将双精度包装为新类型，例如

```
template<class T>
class Wrap
{
public:
    Wrap(const T& value = T())
        : m_value
    {}

    operator T()
    {
        return m_value;
    }

private:
    T m_value;
};

class Area
    : public Wrap<double>
{}; 
```

这样做，有没有性能影响？谢谢。

按照 jweyrich 的建议，添加以下代码

```
template<class Name, class T>
class With
{
public:
    template<class U>
    const U& get() const;

    template<>
    const T& get<Name>() const
    {
        return m_t;
    }

    template<class U>
    void set(const U& t);

    template<>
    void set<Name>(const T& t)
    {
        m_t = t;
    }

private:
    T m_t;
}; 
```

我认为这很完美。

一个例子

```
class Door {};
class Window {};

class Area {};    // Empty, just a name holder
class Volume {};  // Another a name holder

class House
    : public Has<Door>
    , public Has<Window>
    , public With<Area, double>
    , public With<Volume, double>
{};

House house;

// set
house.set(Door());
house.set(Window());
house.set<Area>(3000);
house.set<Volume>(30000);

// get
const Door& door = house.get<Door>();
const Window& window = house.get<Window>();
double area = house.get<Area>();
double volume = house.get<Volume>(); 
```

任何人都知道模板继承，是否有任何性能降低？在我看来，我认为没有。非常感谢！

# c++ - C++ 模板函数

> ID：14420501
> 
> 赞同：1
> 
> 时间：2013-01-20T00:34:30.040
> 
> 标签：c++, templates

为什么在这里调用模板而不是指针到字符数组的特化？

```
#include<iostream>
#include<cstring>

using namespace std;

// Compute the maximum of 5 T's
template <typename T> T maxn(T[], int n);
template <> char* maxn(char*[], int n);

int main() {
  int ints[4] = { 1, 2, 3, 4 };

  cout << "max of ints is " << maxn(ints, 4) << endl;

  const char* abcs[] = {"a", "bee", "c"};

  cout << "longest word of palindrome is " << maxn(abcs, 3) << endl;

  return 0;
}

// Compute the maximum of an array of T's
template <typename T> T maxn(T arr[], int n) {
  T max = arr[0];
  for (int i = 1; i < n; i++) {
    T t = arr[i];
    if (t > max) max = t;
  }
  return max;
}

// Compute the longest word
template <> char* maxn(char* ca[], int n) {
  char* longest = ca[0];
  int len = strlen(ca[0]);
  for (int i = 1; i < n; i++) {
    cout << ca[i] << endl;
    int l = strlen(ca[i]);
    if (l > len) {
      cout << "Found a longer one." << endl;
      longest = ca[i];
      len = l;
    }
  }
  return longest;
}

// Output:
// max of ints is 4
// longest word of palindrome is c 
```

似乎专业化中的类型信息更具体，因此 g++ 更喜欢它。

# php - 如何使用 BigCommerce API 使用核心 PHP 更新客户的 customer_group_id？

> ID：14420502
> 
> 赞同：2
> 
> 时间：2013-01-20T00:34:47.127
> 
> 标签：php, api, bigcommerce

我正在尝试为我的 BigCommerce 网站编写一个 PHP 脚本，该脚本每晚运行并根据某些标准将客户放入特定的客户组中。除了实际更新 customer_group_id 之外，我可以做我需要的所有其他事情*。*BigCommerce[文档](https://developer.bigcommerce.com/rest#customers)仅显示客户可用的 GET 方法。请帮忙。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-10-19T20:43:09.467

可以更新客户的客户组 ID。这已经存在了一年或更长时间。您可以 PUT 到客户资源，而*customer_group_id*是您想要更改的。

此处记录： [https](https://developer.bigcommerce.com/api/objects/v2/customer)

://developer.bigcommerce.com/api/objects/v2/customer 如果您使用的是 PHP API 库，则可以使用以下代码更新客户的客户组 ID：

```
$request_body = array("customer_group_id" => 10);
Bigcommerce:updateCustomer(50, $request_body); 
```

以上将更新 ID 为 50 的客户，使其具有新的客户组 ID 10。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T16:41:26.520

我目前在 Bigcommerce 工作。不幸的是，目前我们的 API 不支持更新客户组 ID 的功能。但是，我们鼓励您将此作为功能请求添加到我们的 Ideas 站点。[http://ideas.bigcommerce.com/](http://ideas.bigcommerce.com/)。

为了您的方便，我还提供了一个指向我们的开发门户的链接，其中包括完整的 API 文档以及操作方法/工具和一个新的 @Mashery 支持的 API 游乐场。[http://developer.bigcommerce.com/](http://developer.bigcommerce.com/)

# c++ - C++ Python将数据从向量转换为ndarray

> ID：14420503
> 
> 赞同：3
> 
> 时间：2013-01-20T00:34:56.507
> 
> 标签：c++, python, boost, numpy

我正在创建一个包含一些 python 的 C++ 项目。我用过`boost::python`，但现在我卡住了。我有一些数据存储在`std::vector`. 数据应该被发送到 python 进行一些计算。我使用的 Python NumPy 函数需要`ndarray`格式的数据，所以我需要一种转换它的方法。因为我想对 C++ 中的结果做更多​​的事情，所以我想将结果`ndarray`从`std::vector`.

我怎样才能转换`std::vector`成`ndarray`反之亦然？任何人都可以发布一些示例代码吗？我知道那里有一个库`boost.numpy`，但是还有其他方法吗，因为我无法构建这个库...

我可以`boost::python::numeric`用于工作吗？谁能提供示例代码？

不复制数据可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:29:45.553

也许您愿意使用[C Numpy API](http://docs.scipy.org/doc/numpy/user/c-info.how-to-extend.html)。

您应该查看 C/C++以在您的 c++ 代码中`PyArray_SimpleNewFromData`创建[全新的ndarray。](http://docs.scipy.org/doc/numpy/user/c-info.how-to-extend.html#PyArray_SimpleNewFromData)

[这篇文章](https://stackoverflow.com/questions/2924827/numpy-array-c-api)可能会有所帮助。

# php - PHP CI中的多行循环

> ID：14420508
> 
> 赞同：1
> 
> 时间：2013-01-20T00:35:27.740
> 
> 标签：php, codeigniter, loops, foreach

请帮助我在 PHP（我正在使用 CodeIgniter 框架）中查看类似于图 2 中显示的内容。
从数据库中我选择：

*   类别 1 -> 项目 1
*   第 1 类 - ？第 2 项
*   ……
*   第 2 类 - ？项目 1
*   类别 x -> 项目 x

一个项目可以有多个类别。

```
 <div>
          <ul>
             <li>
                <div class="programe-tv_link">
                    <p>Categ 1</p> 
                   <dd> <a href="">>> Item 1</a></dd>
                   <dd> <a href="">>> Item 2</a></dd>
                   <dd> <a href="">>> Item 3</a></dd>
                   <dd> <a href="">>> Item 4</a></dd>
                   <dd> <a href="">>> Item 5</a></dd>
                </div>
                <div class="programe-tv_link">
                    <p>Categ 2</p>
                   <dd> <a href="">>> Item 1</a></dd>
                   <dd> <a href="">>> Item 6</a></dd>
                   <dd> <a href="">>> Item 7</a></dd>
                   <dd> <a href="">>> Item 8</a></dd>
                   <dd> <a href="">>> Item 9</a></dd>
                   <dd> <a href="">>> Item 2</a></dd>
                </div>
            </li>
            <li>
                <div class="programe-tv_link">
                    <p>Categ 5</p> 
                   <dd> <a href="">>> Item 1</a></dd>
                   <dd> <a href="">>> Item 2</a></dd>
                   <dd> <a href="">>> Item 3</a></dd>
                </div>
                <div class="programe-tv_link">
                    <p>Categ 4</p>
                   <dd> <a href="">>> Item 1</a></dd>
                </div>
            </li>
          </ul>
    </div> 
```

我附上带有插图的图像。我制作了像图像 1 一样的视图，其中仅在一个`<li>`标签中选择了所有内容；我需要像 IMAGE 2 这样的东西。 ![在此处输入图像描述](../Images/68dab748d2b1026c56c7de2b0dbc9531.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T02:13:59.003

我认为获得像 image2 这样的视图的一个好方法是使用一些 CSS 并为所有类别框创建一个类，将宽度设置为 30% 并浮动以允许其中 3 个保持在同一行。

就像是 ：

```
.class_name {
    width : 31%;
    margin : 0 2% 0 0;
    float : left;
}

.class_name.wrapp {
    width : 33%;
    margin : 0;
} 
```

我正在从[Simpliste](http://cssr.ru/simpliste/)布局中复制它，这对我来说真的很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T15:26:36.380

我的最终解决方案是。

```
 <div id="programe-tv-slide" class="flexslider">
        <strong>Programe TV</strong>
        <div class="redLine"></div>

        <?php $cat_cnl = array(); 
              $list = array(); 
              $i=1;
                 foreach ($category_chaneels as $option) { 
                    $catname = $option['category_name'];
                    $chlname = $option['channel_name'];

                    $cat_cnl[$catname][$i] = $chlname;
                    $list[$i] = $catname;
              $i++;
                 }; 
        ?>
        <?php 
            $rows = array_chunk($cat_cnl, 4, TRUE);
            foreach ($rows as $row) {  //var_dump($rows);
        ?>

          <ul class="slides">    
            <?php
                echo ('<li>');
                foreach ($row as $category => $channels) {
                    echo '<div class="programe-tv_link">'; 
                    echo '<p>' . $category . '</p>'; 
                        foreach ($channels as $channel) {
                                echo '<dd><a href="">' . $channel . '</a></dd> '; 
                        };
                    echo '</div>'; 
                    };      
                echo ('</li>'); 
            ?>
          </ul>
          <?php }; ?>
    </div> 
```

# python - 如何移动 QLabel？

> ID：14420513
> 
> 赞同：2
> 
> 时间：2013-01-20T00:36:52.140
> 
> 标签：python, qt, qwidget, qlabel

我的班级使用 QWidget，我在那里有一些 QPushButtons，我想在每个按钮的顶部设置一个 QLabel，这些按钮是通过 move() 在窗口上设置的，但 QLabel 不想移动......我使用setMargin 但它从左到右移动它，但不是向上或向下移动。我的代码有一个例子：

```
 self.btn = QPushButton(QIcon(),"Show table", self)
    self.btn.move(360, 10)
    self.btn.resize(100, 20)
    self.btn.clicked.connect(self.doAction)

    self.label = QLabel("Here comes the boom")

    layout_LineEdit = QVBoxLayout()
    layout_LineEdit.addWidget(self.label)
    self.setLayout(layout_LineEdit) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T16:20:05.517

将 moveEvent 添加到您的类并将移动信号连接到您的插槽，您的插槽应该是一个函数，可以通过以下方式更改小部件的几何形状：

```
YourClass::moveEvent(QMoveEvent *ev)
{ 
    emit move(ev->pos());
    QLabel::moveEvent(ev);
} 
```

你的 SLOT 功能：

```
void move_label(QPoint *point)
{
    setGeomtry(0, 0, point->x, point->y);
} 
```

并将它们连接如下：

```
connect(label_widget, SIGNAL(move(QPoint)), this, move_label(QPoint)); 
```

# scheme - 开发测试提议的解决方案是否是解决方案的功能？

> ID：14420514
> 
> 赞同：1
> 
> 时间：2013-01-20T00:37:00.467
> 
> 标签：scheme, racket

例如，二次方程`x^2 + 2x + 1 = 0`是关于某个未知数的声明`x`。

因此，如果您替换`x = -1`，则该声明成立，因为它等于`0`。但是，如果您替换`x = 1`，则该声明将不正确，因为您会得到`4`。

现在我被告知要开发一个函数来测试一些问题是否实际上是一个解决方案。

下面我将从哪里开始？

```
10x – 6 = 7x + 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:04:03.957

这完全取决于所选的函数表示。如果您将它们作为 lambdas 传递，则测试“声明”是真还是假是微不足道的：

```
(define (test-claim f1 f2 x)
  (= (f1 x) (f2 x)))

For example:

; x^2 + 2x + 1 = 0, x = -1    
(test-claim (lambda (x) (+ (* x x) (* 2 x) 1))
            (lambda (x) 0)
            -1)

=> #t

; x^2 + 2x + 1 = 0, x = 1    
(test-claim (lambda (x) (+ (* x x) (* 2 x) 1))
            (lambda (x) 0)
            1)

=> #f

; 10x – 6 = 7x + 9, x = 5    
(test-claim (lambda (x) (- (* 10 x) 6))
            (lambda (x) (+ (* 7 x) 9))
            5)

=> #t

; 10x – 6 = 7x + 9, x = 10    
(test-claim (lambda (x) (- (* 10 x) 6))
            (lambda (x) (+ (* 7 x) 9))
            10)

=> #f 
```

# android - RelativeLayout - 调整 TextView 的位置

> ID：14420515
> 
> 赞同：0
> 
> 时间：2013-01-20T00:37:03.247
> 
> 标签：android, android-layout, android-activity

我正在玩来自[http://developer.android.com/training/basics/](http://developer.android.com/training/basics/)的教程。

第一个活动由 a`TextView`和 a组成`Button`。

`Button`发送到第二个活动。

第二个 Activity 由一个以`TextView`编程方式创建并显示来自第一个 Activity 的消息组成`TextView`。具有`View`相对布局。

我希望`TextView`跨越父级的宽度和内容的高度，并位于`View`. 我也想使文本居中。

```
---------
-  xxx  -
-       -
-       -
-       -
-       -
--------- 
```

文本在正确的位置。但是，如果我更改 的背景颜色`TextView`，并且所有“视图”都会获得颜色。这是预期的吗？

只是为了安全起见？

*   里面的`layout*`参数会调整。`TextView``View`
*   该`gravity`参数将调整`TextView`.

* * *

同样按照教程，我没有修改初始 XML，其中包括`TextView`以“Hello World”为中心的`View`. TextView 现在在哪里？

在 Eclipse IDE 中：

```
---------
-       -
-       -
- Hello -
-       -
-       -
--------- 
```

执行期间：

```
---------
-  xxx  -
-       -
-       -
-       -
-       -
--------- 
```

相关代码：

```
 Intent intent = getIntent();
    String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE);

    // Create the text view
    TextView textView = new TextView(this);
    textView.setId(1);
    textView.setTextSize(40);
    textView.setTextColor(Color.RED);
    textView.setBackgroundColor(Color.BLACK);
    textView.setText(message);

    RelativeLayout.LayoutParams lay = new RelativeLayout.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT);

    textView.setLayoutParams(lay);

    textView.setGravity(Gravity.CENTER_HORIZONTAL);

    // Set the text view as the activity layout
    setContentView(textView); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:51:07.417

> 我希望 TextView 跨越父级的宽度和内容的高度，并位于视图的顶部。我也想使文本居中。

设置 Textview 的属性：

*   layout_width = match_parent
*   layout_height = wrap_content
*   布局重力=顶部
*   重力 = center_horizo​​nal

> 只是为了安全起见？
> 
> 布局参数将调整视图内的 TextView。Gravity Parameter 将调整 TextView 内的文本。

布局参数会调整**父**视图里面的TextView，是的。重力参数正确。

以防万一你刚刚开始错过它，[这](http://developer.android.com/reference/android/widget/TextView.html)是 TextView 的参考。

> 另外：按照教程，我没有修改初始 xml，其中包括一个 TextView，其中“Hello World”以视图为中心。现在在哪里？

/res/layout/activity_main.xml 应该是我相信的。

（小提示：试着在一个地方只问一个问题，或者至少把你所有的问题都放在一个地方，这样你通常会得到更好的答案。）

# c++ - gcc 4.7 和递归 constexpr 函数

> ID：14420517
> 
> 赞同：4
> 
> 时间：2013-01-20T00:37:08.580
> 
> 标签：c++, recursion, c++11, constexpr, gcc4.7

我正在玩一点`constexpr`递归并尝试查看它是如何编译的，但我不明白在哪种情况下`gcc`选择在编译时或运行时计算递归。

我正在使用以下阶乘计算代码：

```
#include <iostream>

constexpr unsigned int factorial(unsigned int i)
{
  return i > 0 ? i*factorial(i-1) : 1;
}

int main(void)
{
  std::cout << factorial(X) << std::endl;
} 
```

我改变`x`了阶乘中的值。

*   在没有优化的情况下编译时，表达式不会在编译时计算。
*   使用`-O1`标志编译时，在编译时仍不计算表达式。
*   使用`-O2`，表达式在编译时计算 if `x < 9`。在此值之后，阶乘以循环的形式内联实现。更改`-fconstexpr-depth`标志的值不会改变任何事情。
*   使用`-O3`，表达式是在编译时计算的`if x < 7`。在这个值之后，阶乘通过 x86 xmm 扩展实现内联。
*   如果我将乘积更改为阶乘函数中的总和，我将获得最多`10000`或更多的编译时间计算，并且减少或增加 的值`-fconstexpr-depth`不会改变任何内容。

有谁知道 gcc 4.7 将递归函数实现为编译时或运行时的规则是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T04:31:36.283

`constexpr`仅在编译时需要时才保证在编译时进行评估。例如，这保证在编译时计算，因为`enum`值必须是常量：

```
enum { VALUE = factorial(X) };
cout << VALUE << endl; 
```

在编译时不需要它的任何情况下，它与将其声明为 具有相同的效果`inline`：它只是一个提示，编译器可以自由地做它想做的事情。

就像`inline`，现在大多数编译器都会完全忽略你的提示。出于性能原因，编译器希望即使您*没有*要求它也能够内联事物，并且有自己的算法来确定什么时候值得，什么时候不值得，那么为什么还要费心查看`inline`关键字呢?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T00:59:41.593

声明一个函数`constexpr`并不意味着它将在编译时进行评估。这意味着它可用于计算编译时所需的值。在任何其他情况下，它只是一个普通函数，它将在运行时评估，除非编译器确定在编译时评估它满足“as-if”规则，并且值得这样做。

换句话说，如果您没有`constexpr`声明阶乘函数，我希望您会发现完全相同的编译时/运行时执行模式。

# javascript - knockoutjs observablearray 使单个项目可观察

> ID：14420518
> 
> 赞同：0
> 
> 时间：2013-01-20T00:37:23.570
> 
> 标签：javascript, knockout.js

我在 Knockoutjs.com 上查看 @ 2'nd 教程“使用列表和集合”：[http ://learn.knockoutjs.com/#/?tutorial=collections](http://learn.knockoutjs.com/#/?tutorial=collections)

这是HTML：

## 您的座位预订 ()

```
<table>
<thead><tr>
    <th>Passenger name</th><th>Meal</th><th>Surcharge</th><th></th>
</tr></thead>
<!-- Todo: Generate table body -->
<tbody data-bind="foreach: seats">
    <tr>
        <td> <input data-bind="value: name()"/></td>
        <td> <select data-bind="options: $root.availableMeals, value: meal, optionsText: 'mealName'"></select></td>
        <td data-bind="text: formatterPrice"></td>
        <!--<td> <a href="#" data-bind="click: $root.removeSeat">Remove</a></td>-->
        <td> <button data-bind="click: $root.removeSeat">Remove</button></td>
    </tr>
</tbody>
</table>

<button data-bind="click: addSeat, enable: seats().length < 5">Reserve another seat</button>

<h3 data-bind="visible: totalSurcharge() > 0">
Total surcharge: $<span data-bind="text: totalSurcharge().toFixed(2)"></span>
</h3>

<span data-bind="text: seats()[0].name()" ></span> <br/>
<span data-bind="text: seats()[0].meal().mealName" /> 
```

这是视图模型：

```
// Class to represent a row in the seat reservations grid
function SeatReservation(name, initialMeal) {
var self = this;
self.name = ko.observable(name);
self.meal = ko.observable(initialMeal);
self.formatterPrice = ko.computed(function() {
    var price = self.meal().price;
    return price ? "$" + price.toFixed(2) : "None";
});
}

// Overall viewmodel for this screen, along with initial state
function ReservationsViewModel() {
var self = this;

// Non-editable catalog data - would come from the server
self.availableMeals = [
    { mealName: "Standard (sandwich)", price: 0 },
    { mealName: "Premium (lobster)", price: 34.958989 },
    { mealName: "Ultimate (whole zebra)", price: 290.00000 }
];    

// Editable data
self.seats = ko.observableArray([
    new SeatReservation("Steve", self.availableMeals[0]),
    new SeatReservation("Bert", self.availableMeals[1])
]);

self.addSeat = function() {
    self.seats.push(new SeatReservation("Steve", self.availableMeals[2]))
};

self.removeSeat = function(seat) {
    self.seats.remove(seat);
}

self.totalSurcharge = ko.computed(function() {
    var total = 0;

    for(var i = 0; i < self.seats().length; i++) {
        total += self.seats()[i].meal().price;
    }

    // alert(total);
    return total;
});    
}

ko.applyBindings(new ReservationsViewModel()); 
```

当我尝试更改文本框中的“名称”时，我的 observableArray（座位）似乎没有改变。如果我尝试更改第一行的文本框，我的 span @bottom 仍然显示“Steve”。

我已将 name() 设为与用餐相同的可观察性，如果我更改用餐（下拉菜单），我的 observableArray（座位）似乎工作。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T18:19:33.243

在

`<td> <input data-bind="value: name()"/></td>`

利用 `<td> <input data-bind="value: name"/></td>`

在`<span data-bind="text: seats()[0].name()" ></span> <br/>`你想要的时候`<span data-bind="text: seats()[0].name" ></span> <br/>`

# c# - 集成测试存储库类

> ID：14420534
> 
> 赞同：0
> 
> 时间：2013-01-20T00:40:56.670
> 
> 标签：c#, entity-framework, unit-testing

是否可以更改集成测试的数据库（实体框架），以便我可以在我的数据库中创建测试记录并在测试完成后丢弃所有内容？

现在我正在污染用于本地开发的数据库。

PS：我意识到这一定是非常基本的东西，但由于某种原因，我无法找到这方面的文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T00:51:04.610

实现此目的的一种方法是将每个测试包装在[TransactionScope](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)块中，明确地为每个测试或在 setup 方法中。如果未提交范围，则回滚更改。[这](http://ryangaraygay.com/unit-testing-data-access-with-net-transactionscope/)是一个例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T10:13:55.957

找到了我要找的东西。简单地更改数据库名称比我希望的要容易。您可以通过简单地使用名称构造 DbContext 来更改数据库名称。

```
new ApplicationContext("TestDatabase") 
```

ApplicationContext的实现：

```
public class ApplicationContext : DbContext, IDbContext
{
    public ApplicationContext()
    {
    }

    public ApplicationContext(string databaseName) : base(databaseName)
    {
    }
} 
```

运行我的测试，我创建了一个单独的数据库，可用于测试。

# java - ObjectOutputStream 不能正确保存超类的字段，除非它们是可序列化的，为什么没有错误或警告？

> ID：14420537
> 
> 赞同：0
> 
> 时间：2013-01-20T00:41:16.560
> 
> 标签：java, serialization

假设我有一个`ArrayList<B>` `array`来自某个类的对象`B`，它扩展了`A`。`B`有一个实例字段`bb`和`A`一个字段`aa`。我知道使用保存`array`到 .dat 文件`ObjectOutputStream`需要`B`（不仅仅是`ArrayList`！）实现`Serializable`。但是，我发现从文件中加载对象时（使用`ObjectInputStream`）：

```
 arrayLoaded = (ArrayList<B>)myObjIn.readObject(); 
```

加载的数组与原始数组不同：在特定情况下，`arrayLoaded.get(0).bb`具有与 in 相同的值`array`，但`arrayLoaded.get(0).aa`被“归零”。它有一个默认的初始化值，不管它在`array`保存到文件时的值。但是，这个问题可以通过让也`A`实现来解决`Serializable`。

困扰我的是这个错误是如此微妙：没有例外，没有警告（在 Eclipse 中），什么都没有。这是有原因的还是仅仅是Java开发人员的疏忽？`Serializable`每次我想使用对象 IO 流时，我是否只需要接受它并认真考虑层次结构中的哪些类实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:47:13.810

仅仅因为`B`implements `Serializable`，它不会追溯性地将不可序列化超类的字段包含在被序列化的内容中。（这是有道理的，特别是当您认为能够仅通过扩展和实现任何类的私有和包私有字段来序列化它`Serializable`会违反其封装。）

在中声明的字段的行为与在`A`中声明的字段相同。然而，有一个解决方法。从文档中：`transient``B`[`Serializable`](http://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html)

> 为了允许序列化不可序列化类的子类型，子类型可以负责保存和恢复超类型的公共、受保护和（如果可访问）包字段的状态。仅当它扩展的类具有可访问的无参数构造函数来初始化类的状态时，子类型才可以承担此责任。

因此，您将需要实现`writeObject`并处理`readObject`.`B``A.aa`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T03:22:32.663

> 困扰我的是这个错误是如此微妙：没有例外，没有警告（在 Eclipse 中），什么都没有。这是有原因的还是仅仅是Java开发人员的疏忽？

这是设计使然。（见@Paul Bellora 的回答）。替代方案是：

*   声明一个类 Serializable 是非法的，除非它的超类是 Serializable。这显然是行不通的。

*   如果应该或不能序列化，自动序列化中断的超类字段。（请注意，我们不能依赖`transient`这里，因为如果超类的设计者不打算将其序列化，他/她将不会标记这些字段。）

> 每次我想使用对象 IO 流时，我是否只需要接受它并认真考虑层次结构中的哪些类实现了 Serializable ？

基本上，是的。特别是，当您编写现有非可序列化类的可序列化子类时，您需要认真思考。

我想可以编写 FindBugs / PMD / etc 规则来将此特定用法标记为*潜在*问题。

# c# - 将查询语法中的 LINQ 转换为 lambda 语法

> ID：14420538
> 
> 赞同：1
> 
> 时间：2013-01-20T00:41:29.617
> 
> 标签：c#, .net, linq, lambda

这是我的 LINQ 查询，请帮助我将此 LINQ 查询更改为使用 Lambda 表达式进行查询：

```
var query = from d in db.customers
            from s in db.tbl_states
            where d.cust_state == s.state_id
            select new
            {
                d.cust_name,
                s.state_name
            }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:48:01.513

尝试这个：

```
var query =
    db.customers.Join (         
        db.tbl_states,        
        d => d.cust_state,       
        s => s.state_id,   
        (d, s) => new { d.cust_name, s.state_name }
    ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T00:48:14.360

这应该这样做：

```
var query = db.customers.Join(db.tbl_states, d => d.cust_state, s => s.state_id, (d, s) => new { d.cust_name, s.state_name }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-20T00:55:36.123

我想你`linq`的应该是这样的

```
var query = from d in db.customers
            join s in db.tbl_states on d.cust_state equals s.state_id
            select new
            {
                d.cust_name,
                s.state_name
            }; 
```

为了`Lambda`

```
var list = db.customers                     
.Join(db.tbl_states, 
      s => s.tbl_states, 
      d => d.state_id, 
      (s, d) => new                                                                                         
                 {
                     d.cust_name,
                     s.state_name
                 }); 
```

# syntax - Lua Metatables - 使用冒号语法调用函数

> ID：14420542
> 
> 赞同：0
> 
> 时间：2013-01-20T00:42:29.550
> 
> 标签：syntax, lua, self, colon, metatable

我有以下问题，有人可以帮助我吗？

```
comp = {}
comp.__index = function(obj,val)
  if val == "insert" then
    return rawget(obj,"gr")["insert"]
  end
  return rawget(obj, val)
end

comp.new = function() 
  local ret = {} 
  setmetatable(ret, comp) 
  ret.gr = display.newGroup()
  return ret
end
local pru = comp.new() 
```

`pru.gr:insert(display.newImage("wakatuBlue.png"))`-- 这行有效，但我不想使用`gr`属性访问插入方法，我想直接调用插入方法并且元表`__index`函数完成工作

`pru:insert(display.newImage("wakatuBlue.png"))`--这条线不起作用，我有一个`"bad argument #-2 to 'insert' (Proxy expected, got nil)"`错误，这是我想要使用的方式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T04:14:51.703

你想要这样的东西吗？

```
comp = {}
comp.__index = function(obj,val)
  if val == "insert" then
    return rawget(obj,"gr"):insert(val)
  end
  return rawget(obj, val)
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T02:16:04.843

__index 工作得很好；这是因为您的最后一次通话被解释为：

```
pru.insert(pru, display.newImage("wakatuBlue.png")) 
```

而你想要/需要它是：

```
pru.insert(pru.gr, display.newImage("wakatuBlue.png")) 
```

您要么需要这样称呼它，要么解释您要做什么。

# eclipse - xdebug 不与 Eclipse 调试器对话

> ID：14420545
> 
> 赞同：1
> 
> 时间：2013-01-20T00:42:44.407
> 
> 标签：eclipse, mamp, xdebug, eclipse-pdt

我试图让 Eclipse 与 xdebug 对话。从 xdebug 日志来看，似乎 xdebug 工作正常（即：它正在发送它`<init>`和`<response>`消息），但 Eclipse 没有向 xdebug 发送任何内容（即：no `feature_set`、`feature_get`等命令，如 Netbeans）。

* * *

这是我的设置：

*   Mac OS/X 10.7.5
*   Eclipse 4.2.1“朱诺”
    *   PHP 开发工具 (PDT) SDK 功能 3.1.1.201209101312
*   （网豆 7.1.2）
*   MAMP 2.1.1 运行：
    *   阿帕奇 2.2.22
    *   PHP 5.4.4
        *   正在运行的 PHP 可执行文件是`/Applications/MAMP/bin/php/php5.4.4/bin/php`
        *   正在使用的 PHP 配置文件是`/Applications/MAMP/bin/php/php5.4.4/conf/php.ini`
        *   xdebug 2.2.0

我的相关行`php.ini`是：

```
[xdebug]
zend_extension = "/Applications/MAMP/bin/php/php5.4.4/lib/php/extensions/no-debug-non-zts-20100525/xdebug.so"
xdebug.default_enable = on
xdebug.remote_enable = on
xdebug.remote_host = localhost
xdebug.remote_port = 9000
xdebug.remote_autostart = on
xdebug.remote_handler = "dbgp"
xdebug.remote_autostart = on
xdebug.remote_mode = "req"
xdebug.remote_connect_back = on
xdebug.remote_log = /tmp/xdebuglog.log 
```

* * *

我可以让 Netbeans 使用会话 ID 连接到端口 9000 上的 xdebug`netbeans-xdebug`没有问题。请注意，当我开始调试时，它会在我的 Web 浏览器中打开一个新窗口，`?XDEBUG_SESSION_START=netbeans-xdebug`并附加到我正在运行的 PHP 文件的 URL。

这是 Netbeans 尝试连接时 xdebug 日志的片段：

```
Log opened at 2013-01-18 18:42:52
I: Checking remote connect back address.
I: Remote address found, connecting to ::1:9000.
I: Connected to client. :-)
-> <init xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" fileuri="file:///Applications/MAMP/htdocs/projectname/index.php" language="PHP" protocol_version="1.0" appid="647" idekey="netbeans-xdebug"><engine version="2.2.0"><![CDATA[Xdebug]]></engine><author><![CDATA[Derick Rethans]]></author><url><![CDATA[http://xdebug.org]]></url><copyright><![CDATA[Copyright (c) 2002-2012 by Derick Rethans]]></copyright></init>

<- feature_set -i 0 -n show_hidden -v 1
-> <response xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" command="feature_set" transaction_id="0" feature="show_hidden" success="1"></response>

<- feature_set -i 1 -n max_depth -v 3
-> <response xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" command="feature_set" transaction_id="1" feature="max_depth" success="1"></response>

<- feature_set -i 2 -n max_children -v 30
-> <response xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" command="feature_set" transaction_id="2" feature="max_children" success="1"></response>

<- feature_get -i 3 -n max_data
-> <response xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" command="feature_get" transaction_id="3" feature_name="max_data" supported="1"><![CDATA[1024]]></response>

<- stdout -i 4 -c 1
-> <response xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" command="stdout" transaction_id="4" success="1"></response>

<- step_into -i 5
-> <response xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" command="step_into" transaction_id="5" status="break" reason="ok"><xdebug:message filename="file:///Applications/MAMP/htdocs/projectname/index.php" lineno="17"></xdebug:message></response>

<- stack_get -i 6
-> <response xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" command="stack_get" transaction_id="6"><stack where="{main}" level="0" type="file" filename="file:///Applications/MAMP/htdocs/projectname/index.php" lineno="17"></stack></response>

…

-> <response xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" command="feature_get" transaction_id="14" status="stopping" reason="ok"></response>

Log closed at 2013-01-18 18:47:21 
```

* * *

在 Eclipse 中……</p>

我在工作区中创建了一个新的 PHP 项目，使用默认的 PHP 设置，并为源文件和公共资源创建了单独的文件夹。我在 PHP 包含路径步骤中没有更改任何内容，但在 PHP 构建路径中，我单击`Link Source`并链接到我项目中`/Applications/MAMP/htdocs/projectname`的一个`projectname`文件夹。

然后我将 Eclipse 首选项设置如下：

*   在`General`->`Web Browser`中，我已将其设置为使用外部 Web 浏览器 (Firefox)。
*   在`PHP`-> `Debug`->`Installed Debuggers`中，我检查了 XDebug 是否在列表中，正在使用端口 9000，JIT 远程会话已关闭，并且我使用[这些说明来确保它使用 idekey`mparker17`](http://objitsu.com/content/eclipse-pdt-and-xdebug-working-together-last)。
*   在`PHP`->`Debug`中，我：
    *   将 PHP 调试器设置为“XDebug”
    *   将 PHP 服务器设置为正确的基本 URL ( `http://projectname.local`) 本地 Web 根 ( `/Applications/MAMP/htdocs/projectname`) 以及服务器和我的工作区之间的路径映射。
    *   将 PHP Executable 设置为正确的可执行路径 ( `/Applications/MAMP/bin/php/php5.4.4/bin/php`)，PHP ini 文件 ( `/Applications/MAMP/bin/php/php5.4.4/conf/php.ini`)，将 SAPI 类型设置为“CLI”，并将 PHP 调试器设置为“XDebug”。
    *   选中`Enable CLI Debug`复选框。
    *   选中`Break at first line`复选框。

在我的调试配置中，我添加了一个 PHP Web 应用程序并将其首选项设置如下：

*   在`Server`我设置上面创建的PHP服务器的选项卡中，正确设置文件，并正确设置URL。

这是 Eclipse 尝试连接时 xdebug 日志中的一个片段：

```
Log opened at 2013-01-18 17:33:48
I: Checking remote connect back address.
I: Remote address found, connecting to ::1:9000.
I: Connected to client. :-)
-> <init xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" fileuri="file:///Applications/MAMP/htdocs/projectname/index.php" language="PHP" protocol_version="1.0" appid="703" idekey="mparker17"><engine version="2.2.0"><![CDATA[Xdebug]]></engine><author><![CDATA[Derick Rethans]]></author><url><![CDATA[http://xdebug.org]]></url><copyright><![CDATA[Copyright (c) 2002-2012 by Derick Rethans]]></copyright></init>

-> <response xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" status="stopping" reason="ok"></response>

Log closed at 2013-01-18 17:33:49 
```

* * *

这似乎向我表明 Eclipse 没有与 xdebug 对话，但我很难理解*为什么*会发生这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T00:17:25.290

> JIT 远程会话已关闭

打开它。

# ajax - Symfony2 + AJAX：无法在控制器中获取数据

> ID：14420546
> 
> 赞同：1
> 
> 时间：2013-01-20T00:42:46.860
> 
> 标签：ajax, symfony, doctrine-orm

# 问题

我正在使用带有 AJAX 的 Symfony2 在我的“位置”表中插入一条新记录。我可以轻松地将我想要的数据从表单传递到处理该 AJAX 请求的控制器。我检查了 Firebug，所有 GET 值都符合我的要求。只是要清楚控制器不在位置控制器中，而是在调试控制器中，不知道这是否重要。（仅用于沙盒测试 atm）。

由于数据库中的关系，位置实体有一个地区列，需要一个地区实体对象。

现在的问题是，如果我省略了 $em->flush()，这段代码将返回成功响应。如果我添加 $em->flush() 来执行插入，我会在浏览器的控制台中收到 500 内部错误。

这是我的控制器的代码：

```
 $request = $this->container->get('request');
        if($request->isXmlHttpRequest()){

              $street = $request->query->get('street');
              $zip = $request->query->get('zip');
              $lat = $request->query->get('lat');
              $name = $request->query->get('name');
              $number = $request->query->get('number');

              // insert into object
              $entity  = new Location();
              $entity->setStreet($street);
              $entity->setZip($zip);
              $entity->setLat($lat);
              $entity->setName($name);
              $entity->setNumber($number);

              $em = $this->getDoctrine()->getManager();
              $district = new District();
              // get the district hard coded for testing
              $district = $em->getRepository("SnowFrontBundle:District")->find(7);
              $entity->setDistrict($district);
              //$entity->setDistrict(null);
              $em->persist($entity);
              $em->flush();
              //prepare the response, e.g.
              $response = array("code" => 100, "success" => true);
              return new Response(json_encode($response));
        } 
```

# 问题

$em->flush() 部分可能有什么问题？我怎样才能看到真正的错误是什么？（而不是 500 内部错误）。我也应该使用 createFormBuilder 吗？

# android - 在 Android 中以编程方式登录和下载

> ID：14420550
> 
> 赞同：1
> 
> 时间：2013-01-20T00:43:41.323
> 
> 标签：android

我想为需要 POST 登录的网页制作一个应用程序。之后，我将下载一个 HTML 页面并阅读其标签并执行一些任务以显示一些信息。

在开始之前，我想知道是否可以使用 POST 以某种方式以编程方式登录该页面并下载该页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:49:45.533

这是发送发布请求的一种方式：

```
HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost("http://www.example.com/login.php");
try
{
    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    nameValuePairs.add(new BasicNameValuePair("name", "value"));          
    Httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
    HttpResponse response = httpclient.execute(httppost);
    String result = EntityUtils.toString(response.getEntity());
}
catch(Exception e)
{
    e.printStackTrace();
} 
```

您可以发送您的信息以登录页面。！

# objective-c - 寻找 getchar() 程序

> ID：14420551
> 
> 赞同：-1
> 
> 时间：2013-01-20T00:43:52.650
> 
> 标签：objective-c, unicode, ios6, xcode4.5, core-text

这是我在堆栈上的第一篇文章...玩弄 iOS 并希望将文本输入镜像到类似于 K&R 1.5.1：

```
main()
{
    int c;
    c = getchar();
    while (c != EOF) {
        putchar(c);
        c = getchar();
    }
} 
```

FWIG 的内置交易是使用文本输入，但这给了我一个完整的字符串，我需要一次处理一个字符的输入（并且输入来自不同语言的输入）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:02:56.683

恐怕您必须使用 UIKit 路线。如果您想要更改的字符，`UITextFieldDelegate`请在控制器中实现委托并实现[`textField:shouldChangeCharactersInRange:replacementString:`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html)为每个更改的字符调用的方法。请注意，尽管它可能会在一系列字符上调用，即当用户删除一个范围或尝试粘贴某些内容时（您可以`NO`在这种情况下返回并且只接受输入末尾的单个字符更改，但这会破坏预期用户界面的行为，在您的情况下可能会或不会，这取决于您要实现的目标）

# javascript - jQuery 仅显示选中复选框的标签并隐藏未选中的复选框

> ID：14420554
> 
> 赞同：2
> 
> 时间：2013-01-20T00:45:01.010
> 
> 标签：javascript, jquery, html, forms, input

我有这个设置：

```
<style>.selectit{display:none;}</style>
<div id="foo">
<label class="selectit">
<input type="checkbox" name="one" id="one" checked>
One
</label>
<label class="selectit">
<input type="checkbox" name="two" id="two">
Two
</label>
<label class="selectit">
<input type="checkbox" name="three" id="three" checked>
Three
</label>
</div> 
```

我只想为选中的输入显示标签标签并为其他人隐藏标签。

类似于 show() 用于选中的输入标签和 hide() 用于未选中的标签。

工作代码示例：

```
<style>.selectit{display:none;}</style>
<div id="foo">
<label class="selectit" style="display:block">
<input type="checkbox" name="one" id="one" checked>
One
</label>
<label class="selectit">
<input type="checkbox" name="two" id="two">
Two
</label>
<label class="selectit" style="display:block">
<input type="checkbox" name="three" id="three" checked>
Three
</label>
</div> 
```

或者也许，创建一个新的 div 并只显示该 div 中选中标签的文本。

```
<style>.selectit{display:none;}</style>
<div id="foo">
<label class="selectit">
<input type="checkbox" name="one" id="one" checked>
One
</label>
<label class="selectit">
<input type="checkbox" name="two" id="two">
Two
</label>
<label class="selectit">
<input type="checkbox" name="three" id="three" checked>
Three
</label>
</div>
<div id="output">One - Three</div> 
```

这甚至可能吗？还是我需要通过附加一个搜索整个复选框的 div 来做到这一点？感谢您提供任何帮助，因为我已经用尽了所有选择，而且我没有想法。先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T00:50:41.387

您可以使用方法过滤选中的复选框`filter`。

```
$('#foo input[type=checkbox]').filter(function(){
      return this.checked;
}).prev('label').show(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T01:01:14.303

*免责声明*：此答案仅基于您的标题问题

* * *

为此，我会使用纯*CSS*。喜欢

```
label {
    display: none;
} 

input:checked + label {
    display: block;
} 
```

你只需要稍微调整一下你的标记。

示例：http: [//jsfiddle.net/ZpmGd/](http://jsfiddle.net/ZpmGd/)

# android - 当 Admob 不可用时，如何填充 Android 布局中的剩余空间？

> ID：14420556
> 
> 赞同：1
> 
> 时间：2013-01-20T00:45:27.440
> 
> 标签：android, android-layout, layout, admob

当 Admob 中没有广告可用时（例如，如果用户没有互联网连接）是否可以用其他视图填充剩余空间？也就是说，是否可以根据广告可用性动态调整 Android 布局？

我曾尝试使用 android:layout_weight，但似乎 Android 会考虑 Admob View 的空间，即使当时没有任何广告可用（我在模拟器中使用 ads:loadAdOnCreate="false" 来模拟这种情况）。

任何想法 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:58:00.453

当广告不可用时，将其视图的可见性设置为 GONE。这将使它消失并调整屏幕大小以占用它的空间。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-05-04T11:53:38.577

您可以检查 API [https://developers.google.com/android/reference/com/google/android/gms/ads/AdView](https://developers.google.com/android/reference/com/google/android/gms/ads/AdView)

我认为您可以让听众知道广告是否已加载或可见。检查它：[https ://developers.google.com/android/reference/com/google/android/gms/ads/AdListener#public-constructor-summary](https://developers.google.com/android/reference/com/google/android/gms/ads/AdListener#public-constructor-summary)

编辑：这是对最后一个答案的补充

> 谢谢！如何以编程方式检测 Admob 在 onCreate 方法中不可用？

# ruby-on-rails - 在 Rails 应用程序 Heroku 中发送邮件

> ID：14420557
> 
> 赞同：2
> 
> 时间：2013-01-20T00:45:29.763
> 
> 标签：ruby-on-rails, postgresql, heroku, devise, actionmailer

我的用户可以通过电子邮件邀请其他人加入他们正在从事的项目，但我不断收到以下错误 -

```
Net::SMTPAuthenticationError 
```

这是我为生产环境配置邮件设置的方式

```
 config.action_mailer.default_url_options = { :host => 'myapp.herokuapp.com' }

  #Sending email on the production side
  config.action_mailer.smtp_settings = {
    :enable_starttls_auto => true,
    :address => "smtp.gmail.com",
    :port => "587",
    :domain => "gmail.com",
    :authentication => :plain,
    :user_name => "example@gmail.com",
    :password => "password"
  } 
```

正如我所料，它使用 sqlite3 在我的本地环境中工作，但是当我推送到 heroku 时，它在运行 heroku 日志后抛出上述错误。我相信我的配置设置是正确的，显然 heroku 使用 postgresql，那么我在这里缺少什么？

感谢您的关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:46:41.607

我在这里找到了原因[如何使用 gmail smtp 服务发送确认电子邮件以在本地开发模式下使用 devise 进行注册？](https://stackoverflow.com/questions/10719192/how-to-send-confirmation-e-mails-using-gmail-smtp-service-for-registration-using)

Google 在新创建的帐户上检测到一些“可疑”活动，并阻止我发送电子邮件。验证帐户后，我能够使用上述配置和切换发送电子邮件`:domain => "heroku.com"`

# java - Android：从适配器和活动共享数据

> ID：14420559
> 
> 赞同：-1
> 
> 时间：2013-01-20T00:45:32.447
> 
> 标签：java, android, android-arrayadapter

我有一个主要活动，我为 arraylist 数据创建一个适配器。我使用带有 Jsoup 的单独线程从网站上阅读新闻。

在 onCreate() 我有

```
this.newsItemAdapter = new NewsItemAdapter(this, 
                       R.layout.newsitem_row,NewsItemAdapter.getAllNews()); 
parseThread.start();
this.newsItemAdapter.notifyDataSetChanged(); 
```

当我从适配器读取时，我得到空列表。这是因为线程还没有完成。关于我应该如何进行的任何想法？

我不能在我的线程内执行 notifyDataSetChanged，因为它不是适配器的所有者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:06:33.137

在其构造函数中将适配器传递给您的线程。然后你的线程可以调用 notifyDataSetChanged。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T01:15:09.313

您需要在单独的线程完成后通知，并在 UI 线程上调用 notifyDataSet，一种可能的方法是使用处理程序，

你可以在activity中定义一个handler，在handleMessage中调用notifyDataSet变化，比如

```
handler = new android.os.Handler() {
        @Override
        public void handleMessage(Message msg) {
            newsItemAdapter.notifyDataSetChanged();
        }
} 
```

在线程运行方法中，您需要向处理程序发送消息，

```
public void run() {
   // add this to the end
   Message msg = new Message()
   handler.sendMessage(msg);
} 
```

或者你可以使用 AsyncTask 而不是单独的线程，在任务的 doInBackground 方法中使用 jsoup，在 onPostExecute 中使用 notifyDataSet。

处理程序文档是[http://developer.android.com/reference/android/os/Handler.html](http://developer.android.com/reference/android/os/Handler.html)，AsyncTask 是[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)。

# java - Android USB 转 Java (PC)

> ID：14420560
> 
> 赞同：2
> 
> 时间：2013-01-20T00:45:42.373
> 
> 标签：java, android, usb

我在这里寻找一个简单的方向指针。我想尝试从一个 android 表通信到一个 java 程序。通过 USB 接口发送/接收数据。如果您知道任何或简单的想法，帮助将包括 API 参考（例如我应该为 android java 和标准 java 研究的库）或指向 tuts 的链接。提前致谢！我继续搜索。

******编辑** ***** 我还是迷路了。我不知道从哪里开始，所以我将重申我的问题，希望得到更多答案。我希望通过 USB 将 android 平板电脑连接到我的计算机，并能够将字符串数据发送/接收到自定义 java 应用程序。我必须使用usb，因为情况不允许蓝牙或wifi。例如，一个 java(PC) 应用程序将 x,y 坐标发送到 android 平板电脑，平板电脑绘制该坐标并且用户触摸屏幕，然后 android 平板电脑将 x,y 坐标发送到 java 应用程序到个人电脑。我可以用 arduino 做到这一点，所以 PC java 应用程序不是问题，只是 android java 应用程序。**

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:02:33.523

Android 开发人员指南中的“ [USB 主机和附件](http://developer.android.com/guide/topics/connectivity/usb/index.html)”指南是一个很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-24T01:06:35.290

如果数据量低，您可以使用 MTP 文件传输协议来回复制文件，该协议在几乎任何 Android 设备上都可用且易于使用。**

# java - 在相等规则之间切换

> ID：14420561
> 
> 赞同：1
> 
> 时间：2013-01-20T00:46:07.520
> 
> 标签：java, scala, equality

`equals`我有一个类和不同的等价规则（和的不同实现`hashCode`）。数据首先在一个进程中生成，在该进程中应用一个等价规则，然后将数据馈送到第二个进程，在该进程中应用另一个等价规则。特别是，我正在做很多`map`操作，`equals`并且`hashCode`被标准库隐式调用（我无法控制）。您认为实现这一目标的最佳方法是什么？我现在有两个解决方案：

1.  `equals`用不同的和定义两个子类`hashCode`。在过程1之后，通过启动另一个子类的对象来进行转换。
2.  在类中引入可变状态以指示应用哪个等价规则。

那么您认为哪一个更好，或者还有其他好的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T01:50:26.080

一个可能更优雅的解决方案是`Map`允许自定义散列和相等评估的自定义类。

```
trait MappingScheme[KEY_CLASS,VALUE_CLASS] implements Comparable[VALUE_CLASS] {
    def generateHash(key: KEY_CLASS): Int
    // Also imposes compare() definition from Comparator
}

class CustomSchemeMap[K,V](mappingScheme: MappingScheme[K,V]) implements Map[K,V] {
    // Implement Map methods; use mappingScheme to generate hashes and
    // perform equality checks
} 
```

在您的场景中，您将创建两个自定义`MappingScheme`s 并在您`CustomSchemeMap`的 s. 这种方法比您建议的解决方案性能更高（没有额外的实例创建，您不必改变您的对象），但它也更符合逻辑并且更容易遵循。

* * *

但是，实现 a`Map`可能是一项艰巨的任务。如果这似乎遥不可及，我会创建简单的适配器类来包裹您的对象并将它们输入到地图中。

```
class KeyableAdapter1(o: OriginalClass) {
    override def hashCode() = o.hashCode + 10 // e.g.
    override def equals(that: Object) = o.stuff == that.stuff // e.g., after cast
    def get(): OriginalClass = o // To get it back out, if you need to
}

class KeyableAdapter2(o: OriginalClass) {
    override def hashCode() = o.hashCode ^ 10
    override def equals(that: Object) = o.otherStuff = that.otherStuff
    def get(): OriginalClass = o
}

// Later
myMap.put(new KeyableAdapter1(o1), stuff)
myOtherMap.put(new KeyableAdapter2(o1), moreStuff) 
```

这类似于子类化方法，不同之处在于您可以通过 取回原始对象`get()`，并且更容易遵循（至少在我看来）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T07:13:33.887

> 用不同的equals和hashCode定义两个子类。在过程1之后，通过启动另一个子类的对象来进行转换。

这是正确的，但我认为这两个类在语义上没有区别。尽管它们代表相同，但它们只会在另一种情况下使用。

> 在类中引入可变状态以指示应用哪个等价规则。

永远不要这样做，这是坏的：

*   如果你在全局范围内更改状态，这是一个很大的魔法，这可能会导致很多问题，尤其是如果你在更多线程中使用这些类。你可以破坏一些现有的地图等等。
*   如果您在本地更改它，它就不那么神奇了，但是您几乎肯定会违反 equals 和 hashCode 合同中的对称性，即对于所有对象 o1 和 2o，都`o1.equals(o2)`暗示`o2.equals(o1)`. 您可以比较比较器（例如[1]），它至少会保持合同。虽然它守约，但它是丑陋的。

[1]

```
def equals(o: Object) = o match {
    case that: MyClass => 
        (that.comparator == this.comparator) && comparator.compare(this, that)
    case _ => false // for null values and other classes
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T18:54:49.837

最后我发现编写我自己的自定义`Map`是要走的路（至少在我的问题中）。在我研究了 scala 标准库一段时间后，我发现它非常容易。无论是否可变，其中的元素相等和 hashCode 方法`HashMap`都继承自`HashTable`并`HashTable.Utils`受到保护，这意味着任何子类都可以轻松覆盖它。所以以下是我最终的结果：

```
trait Equility[T] {
  def equal(t1: T, t2: T): Boolean
  def hash(t: T): Int
}

class MapWithEquility[K, V](e: Equility[K]) extends scala.collection.mutable.HashMap[K, V] {
  override def elemHashCode(key: K) = e.hash(key)
  override def elemEquals(key1: K, key2: K) = e.equal(key1, key2)
} 
```

我做了一个简单的测试，效果很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T09:34:19.517

这是对@cheeken 提出的第一个解决方案的改进。我强烈建议不要采用第二种，除非你正在做一个琐碎的项目。使用第二种方法，您不能强制您放入地图中的所有项目都使用相同的哈希计算它们的哈希，这可能会导致错误和意外的行为，这在运行时很难解释。

正确的方法是从 Scala 库中的 HashMap 中获取灵感：

```
@SerialVersionUID(2L)
class HashMap[A, +B] extends Map[A,B] with MapLike[A, B, HashMap[A, B]] with Serializable with CustomParallelizable[(A, B), ParHashMap[A, B]] {

  override def size: Int = 0

  override def empty = HashMap.empty[A, B]

  def iterator: Iterator[(A,B)] = Iterator.empty

  override def foreach[U](f: ((A, B)) =>  U): Unit = { }

  def get(key: A): Option[B] =
    get0(key, computeHash(key), 0)

  override def updated [B1 >: B] (key: A, value: B1): HashMap[A, B1] =
    updated0(key, computeHash(key), 0, value, null, null)

  override def + [B1 >: B] (kv: (A, B1)): HashMap[A, B1] =
    updated0(kv._1, computeHash(kv._1), 0, kv._2, kv, null)

  override def + [B1 >: B] (elem1: (A, B1), elem2: (A, B1), elems: (A, B1) *): HashMap[A, B1] =
    this + elem1 + elem2 ++ elems
    // TODO: optimize (might be able to use mutable updates)

  def - (key: A): HashMap[A, B] =
    removed0(key, computeHash(key), 0)

  protected def elemHashCode(key: A) = key.##

  protected final def improve(hcode: Int) = {
    var h: Int = hcode + ~(hcode << 9)
    h = h ^ (h >>> 14)
    h = h + (h << 4)
    h ^ (h >>> 10)
  }

  private[collection] def computeHash(key: A) = improve(elemHashCode(key))

  protected type Merger[B1] = ((A, B1), (A, B1)) => (A, B1)

  private[collection] def get0(key: A, hash: Int, level: Int): Option[B] = None

  private[collection] def updated0[B1 >: B](key: A, hash: Int, level: Int, value: B1, kv: (A, B1), merger: Merger[B1]): HashMap[A, B1] = 
    new HashMap.HashMap1(key, hash, value, kv)

  protected def removed0(key: A, hash: Int, level: Int): HashMap[A, B] = this

  protected def writeReplace(): AnyRef = new HashMap.SerializationProxy(this)

  def split: Seq[HashMap[A, B]] = Seq(this)

  def merge[B1 >: B](that: HashMap[A, B1], merger: Merger[B1] = null): HashMap[A, B1] = merge0(that, 0, merger)

  protected def merge0[B1 >: B](that: HashMap[A, B1], level: Int, merger: Merger[B1]): HashMap[A, B1] = that

  override def par = ParHashMap.fromTrie(this)

} 
```

如果你看，你可以只写下面的类：

```
class CustomHashMap[A,+B](val hashCalculator:HashCalculator[A]) extends HashMap[A,B] {
    //protected def elemHashCode(key: A) = key.## 
    override def elemHashCode(key: A) = hashCalculator(key)
} 
```

您必须确保所有公共方法的行为正确，包括 par （您需要实现使用特殊哈希器的并行哈希映射）和合并，以及不应该返回 `HashMap.empty[A,B]`但`CustomHashMap.empty[A,B]`

# matlab - MATLAB：如何在同一列中添加矩阵的所有前 n 行，并将结果保存到最后一行？

> ID：14420562
> 
> 赞同：0
> 
> 时间：2013-01-20T00:46:31.183
> 
> 标签：matlab

很难说出这个问题，但这是我正在寻找的一个例子：

```
1 2 3 4
2 1 1 1
2 2 3 1
0 0 0 0 
```

在第一列中，我将前三行的所有值相加并将其保存到第三行，依此类推，这样它就变成了：

```
1 2 3 4
2 1 1 1
2 2 3 1
5 5 7 6 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:53:39.947

我认为您可以使用`sum`：

```
octave:23> m = [1 2 3 4; 2 1 1 1; 2 2 3 1; 0 0 0 0]
m =

   1   2   3   4
   2   1   1   1
   2   2   3   1
   0   0   0   0

octave:24> m(length(m), :) = sum(m)
m =

   1   2   3   4
   2   1   1   1
   2   2   3   1
   5   5   7   6 
```

# apache - Apache mod 重写以直接从一台服务器到另一台服务器

> ID：14420566
> 
> 赞同：1
> 
> 时间：2013-01-20T00:47:09.297
> 
> 标签：apache, mod-rewrite

我必须运行 apache Web 服务器。一个在端口 80 上，另一个在端口 8077 上。

如果可能，我想尝试通过端口 80 版本重定向所有流量。

我最理想的是能够访问[http://translate.example.com](http://translate.example.com) 并将流量定向到[http://www.example.com:8077](http://www.example.com:8077)

我已经在主端口 80 服务器上进行了很多 mod_rewrite，但我不确定哪些服务器需要配置，或者两者是否都需要。

我想确保 translate.example.com/img （或任何其他子目录）实际上指向 8087/images 目录。

**更新**

我现在有以下内容：

```
RewriteCond %{HTTP_HOST} example[NC]
RewriteCond %{REQUEST_URI} ^/glot$ [NC]
RewriteRule    ^(.*)$  http://www.example.com:8077/$1  [P]
ProxyPassReverse / http://www.example.com/ 
```

我开始看到其他服务器的新页面，但我发现所有资源都没有找到，比如图像、css 等

查看源代码已安装产品中的所有资源都设置有前导斜杠

例如

```
/img/glotpress-logo.png 
```

所以我不确定如何加载资源。请注意，如果原始起点是 www.example.com/glot 而不是原始问题中的 glot.example.com，我很高兴

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:06:54.247

您可以将资源重新映射到另一台服务器，但将另一台服务器置于非默认端口上可能会阻止您的一些访问者查看它们，因为他们可能会被阻止（防火墙）访问该端口。如果您不担心端口被阻塞，您可以使用[mod_rewrite Remapping Resources。](http://httpd.apache.org/docs/2.4/rewrite/remapping.html)方法。

```
RewriteEngine On
RewriteRule ^/images/(.+) http://www.example.com:8077/images/$1 [R,L] 
```

如果您想确保每个人都能够查看外部资源，您需要使用代理，其中 apache 会将访问者连接透明地隧道连接到 example.com:8077。您可以在 apache 网站上阅读有关[代理的 mod_rewrite 的更多信息。](http://httpd.apache.org/docs/2.4/rewrite/proxy.html)

```
RewriteEngine  on
RewriteBase    /images/
RewriteRule    ^images/(.*)$  http://example.com:8077/images/$1  [P]
ProxyPassReverse /images/ http://example.com/images/ 
```

**更新**

您是否尝试过删除

```
RewriteCond %{HTTP_HOST} example[NC] 
```

这一行基本上告诉它只有在 HTTP_POST 是 example.com 时才会处理，如果它来自 www.example.com 这个规则不适用。我希望“example [NC]”是一个错字。

最后它可能看起来像

```
RewriteRule ^/glot/(.*)$ http://www.example.com:8077/glot/$1 [P] 
ProxyPassReverse /glot/ http://www.example.com:8077/glot/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T00:55:04.767

您需要在端口 80 服务器上进行配置，使其充当 8077 服务器的代理。

Apache 文档在这里：[http ://httpd.apache.org/docs/trunk/rewrite/proxy.html](http://httpd.apache.org/docs/trunk/rewrite/proxy.html)

# mysql - @rownum 未按预期递增（每组选择 n）

> ID：14420567
> 
> 赞同：0
> 
> 时间：2013-01-20T00:47:11.513
> 
> 标签：mysql, sql

我期望的是 tmp.rank在继续下一个之前`1-10`为每个增加，但是我得到的只是它保留在每条记录上，因此不限制每个.`userid``userid``1``10``userid`

任何想法我做错了什么，很可能是一些简单而明显的事情，或者更有可能以非预期的方式使用 SQL。

```
SELECT DISTINCT 
        tmp.title,
        tmp.content,
        tmp.postid,
        tmp.userid,
        tmp.screenname,
        tmp.email
FROM
(
    SELECT
        qp.title,
        qp.content,
        qp.postid,
        ut.userid,
        ut.screenname,
        ut.email,
        qp.created,
        @rownum := IF( @prev = ut.userid, @rownum+1, 1 ) AS rank,
        @prev := ut.userid 
    FROM
        user_table AS ut JOIN (SELECT @rownum := NULL, @prev := 0) AS r ,
        qa_posts AS qp,
        qa_categories AS qc,
        expatsblog_country AS cc
    WHERE
        LOWER(ut.country_of_expat) = LOWER(qc.title)
        AND ut.setting_notifications IN (3)
        AND ut.valid=1
        AND ut.confirm_email = 1
        AND qc.categoryid = qp.categoryid
        AND qp.type='Q'
        AND DATE(qp.created)>=DATE_SUB(NOW(), INTERVAL 24 HOUR)  
    ORDER BY ut.userid,qp.created ASC
) AS tmp
WHERE tmp.rank < 10 
ORDER BY tmp.userid, tmp.created ASC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:19:40.217

我将在这里猜测问题所在。

您正在组合两种类型的连接语法，这可能会导致您的问题。

您在表格之间同时使用 a`JOIN`和逗号。您`JOIN`在 the`user_table`和 user 变量之间使用 a ，然后在其余表之间使用逗号。

```
 FROM user_table AS ut JOIN (SELECT @rownum := NULL, @prev := 0) AS r ,
   qa_posts AS qp,
   qa_categories AS qc,
   expatsblog_country AS cc 
```

虽然您的`WHERE`子句包括大多数表要加入的列。看起来您没有表的连接条件`expatsblog_country`。当您连接表时，您应该使用一种类型的语法，而不是混合使用它们。

我会建议类似的东西。我没有看到`expatsblog_country`表的任何连接条件，所以我使用 a`CROSS JOIN`将这些表连接到其他表的子查询。如果您有一个列要连接`expatsblog_country`到任何其他列，则将该查询移动到子查询中：

```
SELECT DISTINCT tmp.title,
    tmp.content,
    tmp.postid,
    tmp.userid,
    tmp.screenname,
    tmp.email
FROM
(
  SELECT src.title,
    src.content,
    src.postid,
    src.userid,
    src.screenname,
    src.email,
    src.created,
    @rownum := IF( @prev = src.userid, @rownum+1, 1 ) AS rank,
    @prev := src.userid 
  FROM
  (
    select ut.userid,
      ut.screenname,
      ut.email,
      qp.title,
      qp.content,
      qp.postid,
      qp.created
    from user_table AS ut
    join qa_categories AS qc
      on LOWER(ut.country_of_expat) = LOWER(qc.title)
    join qa_posts AS qp
      on qc.categoryid = qp.categoryid
    where ut.setting_notifications IN (3)
      and ut.valid=1
      and ut.confirm_email = 1
      and qp.type='Q'
      and DATE(qp.created)>=DATE_SUB(NOW(), INTERVAL 24 HOUR)  
  ) src
  CROSS JOIN 
  (
    SELECT @rownum := 0, @prev := 0
  ) AS r
  CROSS JOIN expatsblog_country AS cc
  ORDER BY src.userid, src.created ASC
) AS tmp
WHERE tmp.rank < 10 
ORDER BY tmp.userid, tmp.created ASC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T02:24:10.043

我过去做过很多查询，尤其是回复这里有关 MySQL 和 @ 变量的帖子。我遇到的问题之一是应用于行时数据的返回顺序。

您的原始查询 DID 在最里面的查询中有一个 order by，但是我遇到过 @variable 分配没有真正尊重它的时候，并重置了计数器，因为它转到了其他一些（在这种情况下）用户，然后稍后，遇到第一个记录的更多记录并将计数器重置回一个，即使它后来发生。

接下来，您将 DISTINCT 应​​用到最后。我会尝试将 DISTINCT 拉到最里面，这样您就不会为某个键、同一用户获得 10 条记录，最终只返回 2 条记录。

也就是说，我会将查询调整为下面的内容。最里面的只是在你想要的列上抓取 DISTINCT，然后应用 @variable 分配。

```
SELECT DISTINCT 
      tmp.title,
      tmp.content,
      tmp.postid,
      tmp.userid,
      tmp.screenname,
      tmp.email,
      @rownum := IF( @prev = ut.userid, @rownum+1, 1 ) AS rank,
      @prev := ut.userid 
   FROM
      ( SELECT DISTINCT
              qp.title,
              qp.content,
              qp.postid,
              ut.userid,
              ut.screenname,
              ut.email
           FROM
              user_table AS ut
                 JOIN qa_categories AS qc
                    ON LOWER( ut.country_of_expat ) = LOWER( qc.title )
                    JOIN qa_posts AS qp
                       ON qc.categoryid = qp.categoryid
                      AND qp.type='Q'
                      AND DATE(qp.created)>=DATE_SUB(NOW(), INTERVAL 24 HOUR)
           WHERE
                  ut.setting_notifications = 3
              AND ut.valid = 1
              AND ut.confirm_email = 1
           ORDER BY 
              ut.userid,
              qp.created ASC ) AS tmp,
      ( SELECT @rownum := NULL, 
               @prev := 0) AS r
   HAVING
      tmp.rank < 10
   ORDER BY 
      tmp.userid 
```

我没有看到任何对“cc”的引用被加入任何地方，这会导致笛卡尔结果为 expatsblog_country 中的每个条目提供记录，所以我删除了它......如果需要，请在适用的地方放置并放置 JOIN 条件。

（删除 expatsblog_country AS cc）

此外，我没有使用 WHERE 子句，而是改为了 HAVING 子句，因此所有返回的记录都被考虑用于最终结果集。这将确保@rownum 在遇到 POSSIBLE 条目时会继续增加，但是会抛出所有大于 10 的条目。

最后，由于内部表已经由用户预订并创建日期，因此您不需要在外部表中显式重新排序...也许只是我拥有的 UserID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T09:30:27.967

尝试改变

```
 ( SELECT @rownum := NULL, 
           @prev := 0) AS r 
```

这样您就可以将 @rownum 初始化为 0，而将 @prev 初始化为 NULL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T21:23:45.713

弄清楚这是什么

1.  expats_country 不应该是查询的一部分

更重要的是：

1.  qp.created 周围的“DATE()”搞砸了，查询的实际“最后 24 小时”部分也搞砸了。删除了它，它很好。

# java - JavaFX 2.2 在坐标处获取节点（可视树命中测试）

> ID：14420569
> 
> 赞同：5
> 
> 时间：2013-01-20T00:47:30.017
> 
> 标签：java, javafx-2

如何获取鼠标/任意坐标下的控件列表（或第一个）？我知道 WPF 有 VisualTreeHelper.HitTest 并且它有一个回调，可用于过滤掉某个点的所有控件。JavaFX有类似的东西吗？（或者不同，我只关心给定点的第一个元素）我已经看到很多信息来获取节点的坐标，但没有关于如何通过坐标获取节点的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T05:35:33.487

**2021 年 12 月更新**

答案中提到的 impl_pickNode 函数已被删除并替换为备用选择功能。

javafx.scene.Scene 源代码中演示了类似的功能，其中有一个函数仅用于测试 JavaFX 系统：

```
/**
 * Note: The only user of this method is in unit test: PickAndContainTest.
 */
Node test_pick(double x, double y) {
    inMousePick = true;
    PickResult result = mouseHandler.pickNode(new PickRay(x, y, 1,
            Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY));
    inMousePick = false;
    if (result != null) {
        return result.getIntersectedNode();
    }
    return null;
} 
```

此功能仍然是 JavaFX 系统中的私有功能，它不作为受支持的公共 API 公开。所以 JavaFX 内部知道如何做到这一点，如果您愿意调查内部源代码并使用内部 API，打破模块化并损害向后兼容性，那么您可能会得到结果。

* * *

你可以使用`node.impl_pickNode(x,y)`.

该方法的文档（从[源](http://hg.openjdk.java.net/openjfx/2.2/master/rt/file/e71070b0e0c0/javafx-ui-common/src/javafx/scene/Node.java)`impl_pickNode`复制）。

```
/** 
 * Finds a top-most child node that contains the given coordinates.
 *
 * Returns the picked node, null if no such node was found.
 *
 * @deprecated This is an internal API that is not intended for use 
 *             and will be removed in the next version. 
 **/
public final Node impl_pickNode(double parentX, double parentY) 
```

仔细注意评论中的弃用警告，使用风险自负。

*更新*

JavaFX 问题跟踪器中有一个现有的功能请求：[FX 应该提供 Parent.pick() 例程](http://javafx-jira.kenai.com/browse/RT-20184)。此功能请求适用于将来不会弃用的公共采摘 API。请求的功能描述为：“例程可以返回单个节点或鼠标下方按 z 坐标排序的所有节点的列表”。该功能直到“Van Ness”版本才计划实施，这是最初 JDK8 版本之后的版本（即该功能最早要到 2013 年圣诞节才可用）。

# javascript - 如何获取自动 + javascript 输入字段

> ID：14420570
> 
> 赞同：0
> 
> 时间：2013-01-20T00:47:41.070
> 
> 标签：javascript

我正在尝试从字段中获取自动求和，问题是如果字段总数没有值，则脚本无法正常工作，并且如果再次有超过 7 个字段，则脚本无法正常工作。

这是javascript：

```
function getTotal()
{
    var value01 = document.getElementById('value01').value;
    var value02 = document.getElementById('value02').value;
    var value03 = document.getElementById('value03').value;
    var value04 = document.getElementById('value04').value;
    var value05 = document.getElementById('value05').value;
    var value06 = document.getElementById('value06').value;
    var value07 = document.getElementById('value07').value;

    // Add them together and display
    var sum = parseInt(value01) + parseInt(value02) + parseInt(value03) + parseInt(value04) + parseInt(value05) + parseInt(value06) + parseInt(value07);
    document.getElementById('sum_total').value = sum;
} 
```

输入：

```
<input type="text" id="value01" />
<input type="text" id="value02" />
<input type="text" id="value03" />
here is starting to be added with a button more input fields.
<input type="text" id="+" />
<input type="text" id="++" />
<input type="button" value="Add Them Together" onclick="getTotal();" /> 
```

我的问题是，我怎样才能在 var value01 02 03 等上获得自动 +。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:57:25.780

您的问题不是很清楚，因此我不太确定您想要做什么，因此请随时提供澄清以获得最佳帮助。关于这一点，根据您提供的内容，我有两点需要指出：

1）您的“+”号无效。根据[HTML 4 规范](http://www.w3.org/TR/html4/types.html#type-id)：

> ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")。

2) 我建议不要创建一个包含每个值的不同 var，而是创建一个可以在 for 循环中使用的函数，该函数将确定每个增量输入的总和。如果输入的数量增加，这更 DRY 并且有助于简化事情。

```
function getValues(id){
    return document.getElementById(id).value;
} 
```

下面的纯 JavaScript 解决方案从一个输入框开始，只需单击一个按钮即可添加其他输入，我相信这就是您正在寻找的。您可以相应地修改初始输入框的数量，但它应该给您一个想法。

Javascript：

```
var max = 1;

function getValues(id){
    var result = document.getElementById(id).value;
    return (result ? result : 0);
}

function addInput(){
    max++;
    var input = '<input type="text" id="value'+ max +'" />';
    document.getElementById("valuesContainer").innerHTML += input;
}

function getTotal(){
    var sum = 0;
    for(var i=1; i <= max; i++){
        sum = sum + parseFloat(getValues("value" + i));
    }
    document.getElementById("total").innerHTML = sum;
} 
```

HTML：

```
<div id="valuesContainer">
<input type="text" id="value1" />
</div>
<input type="button" value="Add Value" id="addMore" onclick="addInput();" />
<input type="button" value="Calculate Total" onclick="getTotal();" />
<div id="total"></div> 
```

演示：http: [//jsfiddle.net/Y4xgU/](http://jsfiddle.net/Y4xgU/)

# opencv - 检测点集OpenCV中的对齐点

> ID：14420575
> 
> 赞同：6
> 
> 时间：2013-01-20T00:48:24.127
> 
> 标签：opencv, curve-fitting, hough-transform

给定图像上的一组点，我想检测对齐点组，如图所示： ![图像上的线条](../Images/6fa96e94725bee3edb4958227bc6fe90.png)

我怎样才能做到这一点？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-26T02:41:41.783

这是[霍夫变换](http://en.wikipedia.org/wiki/Hough_transform)的一个很好的潜在应用。直线的霍夫空间是 (r, \theta)，其中 r 是从原点到直线上最近点的距离，\theta 是它的方向。

xy 空间中的每个点都成为霍夫空间中的正弦曲线，如 Wiki 文章所示。

所有正弦曲线相交的地方对应于一条穿过所有点的线。如果这些点不是完全共线的，则相交将是“模糊的”。

将线拟合到点的最简单算法是使矩形 (r, \theta) 累加器数组最初设置为零。然后将每个点的正弦曲线跟踪到这个离散的 (r, \theta) 空间中，将每个累加器元素递增一个固定量。通过寻找大型数组元素来找到预期的线拟合。元素坐标给出拟合的 (r, \theta)。

跟踪正弦曲线很简单。如果您在 \theta 轴上有 T 个累加器箱，则每个箱都对应于角度 k(\pi)/N，对于某些 0 <= k < T。因此，对于此范围内的 k，计算从原点到最近点的距离具有此方向的线通过该点。这提供了一个 r 值。如果 R 轴上有 R 个 bin，并且 Rmax 是 r 的最大值，则递增 bin (floor(r/rMax*R), k)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-25T12:24:38.100

作为开始，你可以试试这个：

1.  列出所有可以通过选择这些点中`n(n-1)/2`的任意两个来形成的线（一个代表`n`点）。

2.  对于其中任何两条线，检查它们是否对齐（即斜率差异在 10 度内）。

3.  对于每条对齐的线，您可以轻松检查其他点是否也对齐在这些线上。这些点将是您需要的对齐点。

# django - 如何正确管理 futere 部署的 django 依赖项

> ID：14420580
> 
> 赞同：1
> 
> 时间：2013-01-20T00:49:14.877
> 
> 标签：django, dependencies, setup-project

我在世界上开始使用python，但我来自PHP并且我习惯了composer来管理我的项目依赖项。

在 django 中，我正在使用 easy_install 安装我的项目依赖项。但我的问题是：如果我将运行我的项目的环境没有这些依赖项，那么有一些工具可以让我轻松处理依赖项

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T02:05:04.170

Best things is to use pip and virualenv

see here [http://www.saltycrane.com/blog/2009/05/notes-using-pip-and-virtualenv-django/](http://www.saltycrane.com/blog/2009/05/notes-using-pip-and-virtualenv-django/)

Then your all problems will be solved

# java - Commons-configuration 和 DefaultConfigurationBuilder 不会自动重新加载

> ID：14420581
> 
> 赞同：1
> 
> 时间：2013-01-20T00:49:16.183
> 
> 标签：java, configuration-files, reloading

我有一个 DefaultConfigurationBuilder（来自 commons-configuration v1.9）。这个对象（名为 config）由这个非常简单的文件初始化：

```
<?xml version="1.0" encoding="UTF-8" ?>

 <configuration>
<system/>
<properties fileName="webapp-commons.properties"  throwExceptionOnMissing="true">
    <reloadingStrategy refreshDelay="1000" config-class="org.apache.commons.configuration.reloading.FileChangedReloadingStrategy"/>
</properties> 
```

因此，对 webapp-commons.properties 文件的修改必须强制重新加载文件。但这并没有按预期工作。这是我的小测试：

```
 log.debug("Go pour modifier le fichier !");
    for (int i=0; i < 10 ; i++) {
        System.out.println("-- value : "+config.getString("clouderial.business.application.name"));
        Thread.sleep(3000);
    }
    log.debug("Vous auriez du modifier le fichier"); 
```

“clouderial.business.application.name”的值永远不会改变。

任何帮助将不胜感激。

JM。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T10:03:06.930

解决方案很简单：只需在配置文件中添加一个标题：

```
<header>
   <result forceReloadCheck="true"/>
</header> 
```

它有效。

完整的配置文件现在是：

```
<?xml version="1.0" encoding="UTF-8" ?>

<configuration>
    <header>
        <result forceReloadCheck="true"/>
    </header>
    <system/>
    <properties fileName="webapp-commons.properties"  throwExceptionOnMissing="true">
            <reloadingStrategy refreshDelay="1000" config-class="org.apache.commons.configuration.reloading.FileChangedReloadingStrategy"/>     
    </properties>
</configuration> 
```

# python - Python-PyQt 使用多个 listViews 连接到一个带有信号/插槽的函数

> ID：14420587
> 
> 赞同：0
> 
> 时间：2013-01-20T00:50:09.547
> 
> 标签：python, listview, pyqt, signals-slots

我试图让我的代码与多个 listViews 一起工作，而不仅仅是一个，但我遇到了问题。

一份清单的工作代码：

```
Class Ui_MainWindow(QtGui.QMainWindow):
    def itemDropped(self, links):
        item = QtGui.QListWidgetItem(url, self.listView)
    def setupUi(self, MainWindow):
        self.connect(self.listView, QtCore.SIGNAL("dropped"), self.itemDropped)  

Class TestListView(QtGui.QListWidget):
    def dropEvent(self, event):
        self.emit(QtCore.SIGNAL("dropped"), links) 
```

到目前为止，我使用多个列表：

```
Class Ui_MainWindow(QtGui.QMainWindow):
    def itemDropped(self, links, listName):
        item = QtGui.QListWidgetItem(url, listName)
    def setupUi(self, MainWindow):
        self.connect(self.listView, QtCore.SIGNAL("dropped"), self.itemDropped(self.listView))  

Class TestListView(QtGui.QListWidget):
    def dropEvent(self, event):
        self.emit(QtCore.SIGNAL("dropped"), links) 
```

所以我收到“self.itemDropped(self.listView)”的错误，在研究了这里和其他网站后，我想出了这个：

```
self.connect(self.listView, QtCore.SIGNAL("dropped"),(lambda : self.itemDropped(self.listView))) 
```

我以前从未使用过 lambda 函数，因为我对 python 还很陌生，但这确实解决了这个问题，当我打印 listName 时它会正确显示。现在的问题是链接没有从其他类正确发出，或者我没有正确接收它们。

所以我想pseduocode我需要这样的东西：

```
self.connect(self.listView, QtCore.SIGNAL("dropped"),(lambda : self.itemDropped(X, self.listView))) 
```

问题是我如何获得 X，即来自 TestListView 类的链接？当没有变量传递给函数时，我不太明白我是如何只用 1 个列表接收它们的。

感谢你们提供的任何帮助，我非常感谢。如果您想要更大的图片，这里的 Ps 代码可能看起来很熟悉[PyQT4：将文件拖放到 QListWidget](https://stackoverflow.com/questions/4151637/pyqt4-drag-and-drop-files-into-qlistwidget)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T08:04:22.427

你想要的是这个

```
self.connect(self.listView, QtCore.SIGNAL("dropped"),(lambda X: self.itemDropped(X, self.listView))) 
```

当您发出信号时，您将`links`变量传递到插槽中，该插槽曾经是`self.itemDropped`（其签名是`self.itemDropped (links)`）。

相反，您的 slot 现在是一个 lambda 函数，因此您需要通过以`lambda X:`. 然后，这`X`可用于 lambda 定义的其余部分。

当您的信号发出时，您的 lambda 函数被调用并`X`包含`links`.

一般来说： def foo(x): do_something(x) foo(3)

相当于 my_function = lambda x: do_something(x) my_function(3)

有道理？

EDIT: I should also point out (for any future applications you have) that there are some tricky points when using variables inside lambda functions (specifically the use of variables that are not specified in the definition of the lambda function, such as the use of `self.listView`). When the lambda function is called (when the signal is emitted), it will use whatever the current value of `self.listView` is, not the value it was when the function was defined. This becomes a problem when defining lambda functions inside a loop and trying to use a loop variable inside your lambda function. Some useful information can be found here (read the comments too) [http://eli.thegreenplace.net/2011/04/25/passing-extra-arguments-to-pyqt-slot/](http://eli.thegreenplace.net/2011/04/25/passing-extra-arguments-to-pyqt-slot/)

# python - 找不到任何满足 pypm==1.3.4 要求的下载

> ID：14420589
> 
> 赞同：2
> 
> 时间：2013-01-20T00:50:33.557
> 
> 标签：python, django, git, heroku, pip

推送到 heroku 时出错：“找不到任何满足 pypm==1.3.4 要求的下载”

正如[Django 中所建议的 - 未能将一些参考资料推送到 git@heroku.com](https://stackoverflow.com/questions/13222440/django-failed-to-push-some-refs-to-githeroku-com)，我做到了

```
"pip install --upgrade -r requirements.txt" 
```

Heroku 无法从需求文件安装 pypm 包。错误是：

> 下载/解压 pypm==1.3.4（来自 -r requirements.txt（第 11 行））
> 找不到任何满足 pypm==1.3.4 要求的下载（来自 -r requirements.txt（第 1 行））。
> pypm==1.3.4 根本找不到分布（来自 -r requirements.txt（第 11 行））

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T01:12:39.647

`pip install`从 PyPi 中提取包，此错误告诉您此版本`pypm`未在此处列出。查看[PyPi 列表以`pypm`](http://pypi.python.org/pypi/PyPM/)了解 PyPM 是 ActivePython 使用的包管理器，并且只能通过安装 ActivePython 获得。您应该从`requirements.txt`部署到 Heroku 中删除此要求。

# c# - 无法使用 EF、LINQ 将网站中的数据打印到列表视图中

> ID：14420592
> 
> 赞同：1
> 
> 时间：2013-01-20T00:50:43.540
> 
> 标签：c#, asp.net, .net, linq-to-entities, entity-framework-5

我有一个使用 EF 构建 DB 和 LINQ 来访问该数据的网站。我正在尝试将数据打印到列表视图中，但没有打印出来，我不知道为什么。

标记：

```
<asp:ListView ID="lvSearchResults" OnPagePropertiesChanged="lvSearchResults_PagePropertiesChanged" runat="server">
    <LayoutTemplate>
        <table style="width: 100%" border="1">
            <tr style="text-align:center;">
                <td>Item Name</td>
                <td>Release Region</td>
                <td style="width: 100px">Factory Sealed</td>
                <td style="width: 50px">Item Details</td>
                <td style="width: 50px">Edit Item</td>
            </tr>

            <tr id="itemPlaceHolder" runat="server" />
        </table>

        <asp:DataPager ID="dpSearchResults" PagedControlID="lvSearchResults" PageSize="10" runat="server">
            <Fields>
                <asp:NextPreviousPagerField ButtonType="Button" ShowNextPageButton="false" ShowFirstPageButton="true" ShowLastPageButton="false" ShowPreviousPageButton="true" />
                <asp:NumericPagerField ButtonCount="10" />
                <asp:NextPreviousPagerField ButtonType="Button" ShowNextPageButton="true" ShowFirstPageButton="false" ShowLastPageButton="true" ShowPreviousPageButton="false" />
            </Fields>
        </asp:DataPager>
    </LayoutTemplate>
    <ItemTemplate>
        <tr>
            <td>
                <%#:Item.Name%>
            </td>
            <td>
                <%#:Item.Region%>
            </td>
            <td style="text-align: center;">
                <%#:Item.Condition%>
            </td>
            <td>
                <asp:Button ID="btnSelect" Text="View Details" PostBackUrl="/Items/<%#:ItemName%>" runat="server" />
            </td>
            <td>
                <asp:Button ID="btnEdit" Text="Edit Item" PostBackUrl="/Edit/<%#:ItemName%>" runat="server" />
            </td>
        </tr>
    </ItemTemplate>
</asp:ListView> 
```

代码隐藏：

```
byte SelectedType = byte.Parse(ddlCategories.SelectedValue);

using (var db = new FullContext())
{
    var q = (from i in db.Items
             where i.TypeID == SelectedType || SelectedType == 0 //Get certain type or all types
             orderby i.Name
             select new
             {
                 i.ID,
                 i.Name,
                 i.Region,
                 i.Condition
             }).ToList();
    lvSearchResults.DataSource = q;
    lvSearchResults.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T14:49:18.697

解决方案是添加 Eval() 命令，因此工作代码是

```
 <td>
                                <%#:Eval("Name")%>
                            </td>

                            <td>
                                <%#:Eval("Region")%>
                            </td>

                            <td style="text-align: center;">
                                <%#:Eval("Condition")%>
                            </td> 
```

# apache - 使用 mod rewrite 重写 url 而无需重定向

> ID：14420597
> 
> 赞同：9
> 
> 时间：2013-01-20T00:51:12.270
> 
> 标签：apache, .htaccess, mod-rewrite

这个网址正在重写

```
http://domain.com/embed/slideshow-image-list.js 
```

对此

```
http://domain.com/code/embed/slideshow-image-list 
```

当前的htaccess代码

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www.domain.com$ [NC]
RewriteRule ^(.*)$ http://domain.com/$1 [R=301,L]
RewriteRule ^embed/([^\.]+)\.js$ http://domain.com/code/embed/$1 [L]
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

它目前已正确重写，但如果您访问 .js url，它会重定向到完整的 url。

我只是想在没有重定向的情况下映射它

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-20T02:40:46.257

不要在规则中提供域，只提供路径。使用完整的域，它将被重定向。

`RewriteRule ^embed/([^\.]+)\.js$ /code/embed/$1 [L]`

或者，如果生成的路径不是真实文件并且应该由 index.php 处理，则删除该路径`[L]`以便执行下一个规则：

`RewriteRule ^embed/([^\.]+)\.js$ /code/embed/$1`

请注意，[mod_rewrite 指南](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)说明了以下内容，这似乎表明完整的 URL 路径是可以的，但我相信它与 ServerName 进行比较，不一定是 ServerAlias（我对此不是 100% 确定，但我一直使用在进行非重定向重写时使用路径而不是完整的 URL）：

> 绝对网址
> 
> 如果指定了绝对 URL，mod_rewrite 会检查主机名是否与当前主机匹配。如果是这样，则方案和主机名将被删除，并且生成的路径将被视为 URL 路径。否则，将对给定 URL 执行外部重定向。要强制将外部重定向回当前主机，请参见下面的 [R] 标志。

# macos - 将 svnserve 添加到 Mac OSX Lion 防火墙

> ID：14420598
> 
> 赞同：2
> 
> 时间：2013-01-20T00:51:16.040
> 
> 标签：macos, firewall, svnserve

有人可以解释如何将 svnserve（或任何其他没有 UI 的应用程序）添加到 Mac OSX Lion 应用程序防火墙吗？UI 不允许您选择隐藏文件夹，例如 /usr/bin

# javascript - 如何根据 ID 以外的某些属性从集合中查找模型？

> ID：14420599
> 
> 赞同：48
> 
> 时间：2013-01-20T00:51:19.417
> 
> 标签：javascript, backbone.js, backbone.js-collections

我有一个有几个对象的模型：

```
//Model
Friend = Backbone.Model.extend({
    //Create a model to hold friend attribute
    name: null,
}); 

//objects
var f1 = new Friend({ name: "Lee" });
var f2 = new Friend({ name: "David"});
var f3 = new Friend({ name: "Lynn"}); 
```

而且，我会将这些朋友对象添加到集合中：

```
//Collection
Friends = Backbone.Collection.extend({
    model: Friend,
});

Friends.add(f1);
Friends.add(f2);
Friends.add(f3); 
```

现在我想根据朋友的名字得到一个模型。我知道我可以添加一个`ID`属性来实现这一点。但我认为应该有一些更简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-01-20T01:14:35.567

对于简单的基于属性的搜索，您可以使用[`Collection#where`](http://backbonejs.org/#Collection-where)：

> **在哪里** `collection.where(attributes)`
> 
> **返回集合中与传递的属性**匹配的所有模型的数组。对 的简单情况很有用`filter`。

因此，如果`friends`是您的`Friends`实例，则：

```
var lees = friends.where({ name: 'Lee' }); 
```

还有[`Collection#findWhere`](http://backbonejs.org/#Collection-findWhere)（如评论中所述，稍后添加）：

> **找哪里** `collection.findWhere(attributes)`
> 
> 就像*where*一样，只是直接返回集合中与传递的**属性**匹配的第一个模型。

所以如果你只追求一个，那么你可以说：

```
var lee = friends.findWhere({ name: 'Lee' }); 
```

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2013-01-20T00:54:29.633

骨干集合支持 underscorejs`find`方法，因此使用它应该可以工作。

```
things.find(function(model) { return model.get('name') === 'Lee'; }); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-05-14T16:05:16.347

最简单的方法是使用 Backbone 模型的“idAttribute”选项让 Backbone 知道您想使用“名称”作为模型 ID。

```
 Friend = Backbone.Model.extend({
      //Create a model to hold friend attribute
      name: null,
      idAttribute: 'name'
 }); 
```

现在您可以直接使用 Collection.get() 方法来检索使用他的名字的朋友。这样，Backbone 不会遍历集合中的所有 Friend 模型，而是可以直接根据其“名称”获取模型。

```
var lee = friends.get('Lee'); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-08-31T09:57:33.490

您可以调用`findWhere()`Backbone 集合，它将完全返回您正在寻找的模型。

例子：

```
var lee = friends.findWhere({ name: 'Lee' }); 
```

# jquery - 我可以将 UUID 用于 HTML 标记 ID 而不会出现任何问题吗？

> ID：14420601
> 
> 赞同：5
> 
> 时间：2013-01-20T00:51:34.400
> 
> 标签：jquery, html, performance, dom, uuid

我有可通过侧窗格上的索引访问的动态内容，当用户选择侧窗格元素时，我使用 id 作为一种机制来确定他们所指的数据，因此我可以动态生成适当的数据对于主窗格。

我只是使用附加一个数字的预格式化 id，其中数字是数组中的索引，从而为 html 标签创建唯一的 id。但是在某些情况下，我会与数字发生冲突，所以我一直认为使用 UUID 将是解决我的问题的一种方法。

但是我不知道将 UUID 用于 html 标签 ID 是否有任何问题。

根据我对有效字符和长度限制的了解，我相信直接快速的答案是它应该起作用。版本 4 使用字符[0-9、az 和 -](http://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_.28random.29)，它们是 HTML 标记 ID 的有效字符。此外，长度似乎不是[问题](https://stackoverflow.com/questions/1496096/is-there-a-limit-to-the-length-of-html-attributes/1496150#1496150)。

我主要关心的是是否存在限制 id 有效大小的浏览器问题？运行测试并创建一个值为 的单个 id `2d1b8447-e37a-43d8-9f7c-075eac7d9bcc`，甚至创建一个具有多个的测试都很好。但我无法测试将使用该应用程序的所有浏览器，并且随着时间的推移很难测试性能。我的内容非常动态，可以随着时间的推移删除和添加带有这些 id 的标签

我尝试搜索带有大标签 ID 的报告问题，但一无所获，但通过 Google 没有问题并不能证明没有任何问题。

那么...有没有人在 html 标签上使用 UIID 的 ids，如果是这样，我需要避免您遇到的任何问题吗？

我应该注意到，有证据表明 UUID 在[索引（InnoDB）](https://stackoverflow.com/a/5793399/1125784)方面存在性能问题，我担心的是 DOM 操作和使用带有 UUID 的 id 的 jQuery 可能会遇到类似的问题。

干杯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T01:18:51.333

可以使用`data-`属性完成同样的事情。

例子：

```
<a href="#" data-UUID="2d1b8447-e37a-43d8-9f7c-075eac7d9bcc" class="product_link">Some product</a> 
```

用 jQuery读取`data-`属性：

```
$('.product_link').click(function(){
     var UUID=$(this).data('UUID');
    /* do something with UUID*/
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-12-05T12:36:27.890

我使用 UUID 作为元素 ID，而 CSS 选择器对我来说会失败，因为似乎 ID 必须以字母而不是数字开头，以便能够对它们执行有效的基于 CSS id-selector 的查询。

```
document.querySelectorAll('#fd759ae2-c0ed-4de5-80fd-932c814a53c7 > div') # works
document.querySelectorAll('#81ea82f5-9a6f-4ae3-93e3-a5ef3579c554 > div') # fails 
```

# android - 如何获得恒定的 GPS 位置

> ID：14420602
> 
> 赞同：1
> 
> 时间：2013-01-20T00:51:48.573
> 
> 标签：android, android-location

我有以下代码：

```
LocationManager mlocManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
LocationListener mlocListener = new MyLocationListener();
mlocManager.requestLocationUpdates( LocationManager.GPS_PROVIDER, 0, 0, mlocListener); 
```

和`MyLocationListener`类：

```
public class MyLocationListener implements LocationListener{

        @Override
        public void onLocationChanged(Location loc){
        loc.getLatitude();
        loc.getLongitude();
        tv_GPSlat.setText("Latitude: " + loc.getLatitude());
        tv_GPSlon.setText("Longitude: " + loc.getLongitude());
        }

        @Override
        public void onProviderDisabled(String provider){
        Toast.makeText( getApplicationContext(),"GPS is not working", Toast.LENGTH_SHORT ).show();
        }

        @Override
        public void onProviderEnabled(String provider){
        Toast.makeText( getApplicationContext(),"GPS is working",Toast.LENGTH_SHORT).show();
        }

        @Override
        public void onStatusChanged(String provider, int status, Bundle extras){
        }
    } 
```

我想将当前的经度和纬度保存到我`TextView`的 s ( `tv_GPSlat`, `tv_GPSlon`) 但位置值不是恒定的（它们一直在变化）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:56:32.107

GPS 并不准确——即使你不动，它也会反弹一点。只需放置您获得的第一个位置，并忽略未来的更新，除非它们移动超过一定数量。这是最简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T02:56:55.217

您必须获得该位置，并且一旦获得它（即调用您的处理程序方法），您必须取消注册处理程序才能停止接收更新。`onLocationChanged()`只需在处理程序方法的末尾添加这一行`MyLocationListener`：

```
LocationManager mlocManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
mlocManager.removeUpdates(this); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T03:12:52.313

将数据成员添加到您的位置侦听器，并在其中保留以前的位置：

```
public class MyLocationListener implements LocationListener {

    public Location mSavedLocation;

    @Override
    public void onLocationChanged(Location loc) {
        // If we don't have saved location, or the distance between
        // the saved location and the new location is bigger than
        // 5 meters (~15ft) save the new location
        if ((mSavedLocation == null) ||
            (loc.distanceTo(mSavedLocation) > 5)) {
            mSavedLocation = loc;
        }
        // Update the screen with the current saved location
        tv_GPSlat.setText("Latitude: " + mSavedLocation.getLatitude());
        tv_GPSlon.setText("Longitude: " + mSavedLocation.getLongitude());
    }

    // ... no changes to the rest of the class
} 
```

现在您的其余代码也可以使用以下方法获取最新保存的位置：

```
mlocListener.mSavedLocation 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T04:16:09.670

我想知道为什么没有人提到这一点。可能是我错过了什么。您拨打的电话有 0,0。它应该有毫秒，距离米。这种方式位置更改仅在经过特定距离或超时后调用。我同时使用 GPS 和 NETWORK 提供程序，以不依赖于任何一个（有时 GPS 不可靠）。

```
 LocationManager lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    lm.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, God.KM20TIME,
            God.KM20DISTANCE, (LocationListener) updates);
    lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, God.KM20TIME,
            God.KM20DISTANCE, (LocationListener) updates); 
```

# c# - 发布应用程序时显示停机页面

> ID：14420603
> 
> 赞同：5
> 
> 时间：2013-01-20T00:51:56.320
> 
> 标签：c#, asp.net, asp.net-mvc, iis, deployment

将项目发布到服务器时，ASP.NET MVC 是否可以显示停机页面？现在，如果我在发布时点击该页面，我会收到错误消息：

```
Could not load type "App.MvcApplication" 
```

如果我们可以设置一个停机页面，让用户知道稍后再回来，而不是认为应用程序被破坏了，那就太棒了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T01:02:49.910

您可以将`app_offline.htm`页面添加到应用程序根目录，流量将被重定向到该页面，直到您将其删除或重命名。

**更多信息**

*   [Scott Gu 的 App_Offline.htm](http://weblogs.asp.net/scottgu/archive/2005/10/06/426755.aspx)
*   [App_Offline.htm 并解决“IE 友好错误”功能](http://weblogs.asp.net/scottgu/archive/2006/04/09/442332.aspx)
*   [app_offline.htm 会停止当前请求还是仅停止新请求？](https://stackoverflow.com/questions/179556/will-appoffline-htm-stop-current-requests-or-just-new-requests)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T06:45:40.483

在应用程序中执行此操作的另一种方法是让 IIS 为您解决这个问题。

[应用程序初始化模块](http://www.iis.net/downloads/microsoft/application-initialization)提供了此功能，还允许您运行预热脚本。

# c# - 使用 z-index 在另一个弹出控件之上设置一个弹出控件

> ID：14420610
> 
> 赞同：-1
> 
> 时间：2013-01-20T00:53:26.530
> 
> 标签：c#, ajaxcontroltoolkit, modalpopupextender

我正在尝试将我的错误弹出控件设置在另一个弹出控件之上。我知道 z-index 是解决方案，但没有任何效果。我已经尝试将它应用于任何/所有 div 和类。我究竟做错了什么？

**标记**

```
<!-- Error Modal Form -->
    <asp:HiddenField ID="hideForModal" runat="server" />
    <ajaxToolkit:ModalPopupExtender runat="server" ID="ErrorModal" BehaviorID="modalPopupExtenderError"
        TargetControlID="hideForModal" PopupDragHandleControlID="PanelErrorOuter" PopupControlID="PanelErrorOuter"
        OkControlID="btnOk" BackgroundCssClass="modalBackground" DropShadow="False" Drag="true" >
    </ajaxToolkit:ModalPopupExtender>
    <ajaxToolkit:RoundedCornersExtender ID="RoundedCornersExtender3" runat="server" TargetControlID="PanelErrorInner">
    </ajaxToolkit:RoundedCornersExtender>
    <asp:Panel ID="PanelErrorOuter" runat="server" BackColor="Transparent" Style="display:none; ">
        <asp:Panel ID="PanelErrorInner" runat="server" BackColor="White" Width="480" Height="300"   >
            <div id="ErrorInputContainer" style=" position:absolute; z-index:80000 !important;" >
                <div>
                    <b>Error Code:</b></div>
                <asp:Label ID="lblErrorCode" runat="server" Text="Error Code"></asp:Label>
                <div>
                    <b>Error Message:</b></div>
                <asp:Label ID="lblErrorMessage" runat="server" Text="Error Message"></asp:Label>
                <div>
                    <b>Ex message:</b></div>
                <asp:Label ID="lblExMessage" runat="server" Text="Ex Message"></asp:Label>
                <br />
                <asp:LinkButton ID="LinkButton1" runat="server" CssClass="close" OnClientClick="$find('modalPopupExtenderError').hide(); return false;" />
                <div id="Acknowledge">
                    <asp:Button ID="btnOk" runat="server" Text="Ok" CssClass="Button" />
                </div>
            </div>
            <br />
        </asp:Panel>
    </asp:Panel>
    <!-- End Error Modal Form --> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:08:49.357

Z-index 仅适用于定位元素。

您需要为 ErrorInputContainer 提供 position:absolute、position:relative 或 position:fixed 以使 z-index 起作用。

# 更新

如果您选择使用绝对定位，请记住“top:”和“left:”定位将相对于第一个非静态祖先。

默认情况下，所有元素都具有“静态”定位 - 因此，如果您希望弹出窗口相对于该元素定位，则必须在另一个元素的 css 中设置“位置：相对”。

## 例子

```
<!-- Relative to parent div -->
<div style="position:relative;">
   <div style="position:absolute; top:0px; left:0px;">
   </div>
</div>

<!-- Relative to document window -->
<div>
   <div style="position:absolute; top:0px; left:0px;">
   </div>
</div> 
```

# c++ - c++ 解决方案源文件在编译时如何处理？

> ID：14420611
> 
> 赞同：2
> 
> 时间：2013-01-20T00:53:27.030
> 
> 标签：c++, compilation, linker, extern, resource-files

这是主题代码：

**外部文件.cpp**

```
int i = 10; 
```

**主文件.cpp**

```
#include <iostream>

using namespace std;

extern int i;
int main(int param)
{
    cout << i << '\n';
    int i = 0;
    cout << i << '\n';
    cout << ::i << '\n';
} 
```

编译此程序时（使用 Visual Studio 2008），它工作正常，输出将是：

```
10
0
10 
```

这对我来说并不奇怪，这是范围的问题。

但是让我感到困惑的是：文件如何从另一个文件中`mainfile.cpp`获取值（在我们的例子中）？仅仅是因为它们位于同一个目录中吗？或相同的解决方案？`i``.cpp``externfile.cpp`

并且以更好的方式：在编译项目时如何“合并”源文件（如果我应该指定，使用 VS2008）？它们按什么“顺序”排列？它们的范围如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T00:58:46.590

“正常”VC++ 项目¹指示 VC++ 将每个源文件自己编译为“目标文件”（或目标模块），其中编译器为尚未解析的符号（如`external`变量或函数）留下“占位符”声明但未定义）。

然后，链接器将所有目标文件绑定在一起，链接器将它们绑定在一起以生成最终的可执行文件。在此段落中，“占位符”被替换为它们所指的代码/数据的实际地址，这些地址在各种目标文件中定义。如果未找到某些需要的定义，则会出现未定义的引用错误，如果多次找到某个符号，则会出现多重定义错误²。

有关经典链接模型的更多信息，请查看 Raymond Chen 的[这篇文章](http://blogs.msdn.com/b/oldnewthing/archive/2013/01/07/10382714.aspx)（如果您有兴趣，请查看[整个系列](http://blogs.msdn.com/b/oldnewthing/archive/tags/linker/)）。

* * *

1.  当然还有更多灵活性的空间，这里我只是描述VC++中的常见情况。
2.  这是 C++“一个定义规则”的结果；尽管如此，还是有一些例外，特别是`inline`函数和`template`实例化；在这些情况下，链接器只取它喜欢的任何东西（这应该不是问题，因为此类对象的多个定义*必须*相同）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T00:59:40.067

您的 IDE VS2008 将您的源文件传递给编译器。编译器将您的源文件构建为目标文件，然后将这些文件传递给链接器，链接器链接这些文件以及您的包含文件。

然后链接器将输出所有这些文件的二进制表示，无论是 dll、lib 还是 exe。

这是对所发生事情的一个非常基本的总结，还有更多的过程在进行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-20T01:04:37.913

如果您手动执行此操作，则运行 C 或 C++ 程序需要 4 个步骤

1 - 预处理，主要处理 C 宏、#define 等。

2 - 编译，文件被转换为带有外部符号表的目标代码，以便以后可以解决这些问题

3 - 链接，解决外部引用，如果找不到则报告任何错误

4 - 运行代码。

所有这些都由 IDE VS2008 自动完成。它使这些步骤根据需要进行，如果文件没有更改，则不会重新编译，如果不需要链接，则不会完成。在 .Net 中，制作程序集等需要更多步骤。

# php - 为 RESTful 实现秘密/公共 api 密钥

> ID：14420615
> 
> 赞同：2
> 
> 时间：2013-01-20T00:54:09.390
> 
> 标签：php, rest

（我使用 PHP）我希望用户能够通过我的 RESTful api 编辑他们的个人资料。每个用户都有唯一的 id（公钥的东西，对吗？），以及存储在数据库中的秘密 api 密钥，没有人可以访问这个密钥（“甚至”对用户自己没有。`sub-question:`我可以向用户显示他的密钥吗？ ? 我注意到 Facebook 会这样做，甚至在他们的 php-sdk 中使用它）。

所以我读了这个答案 - [https://stackoverflow.com/a/8567909/410065](https://stackoverflow.com/a/8567909/410065)，并决定了我想要实现的方式（不要认为还有其他方式（？））。

据我了解，我需要调用 update: `PUT http://api.domain.com/user/4/?sig=..result of hash_hmac..`，但我的问题是 - 在调用它之前，我如何知道`hash_hmac`（注册`sig`字段）的结果？当然，我应该进行两次调用`hash_hmac`- 首先是`sig`发送 html 表单，其次是验证用户。但是我在哪里第一次调用该函数？（它应该在表单提交和 RESTful 调用之间）。

# c# - 将 TimeSpan 格式化为看起来像时区偏移

> ID：14420618
> 
> 赞同：3
> 
> 时间：2013-01-20T00:54:57.560
> 
> 标签：c#, timezone, timespan

如何将`TimeSpan`对象格式化为时区偏移，如下所示：

```
+0700 
```

或者

```
-0600 
```

我正在使用[GetUtcOffset](http://msdn.microsoft.com/en-us/library/system.timezone.getutcoffset%28v=vs.90%29.aspx)来获取偏移量及其工作，但它返回一个 TimeSpan 对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T01:15:12.813

如果您使用的是 .Net 4.0 或更高版本，则可以`ToString`在时间跨度上使用带有`hh`and`mm`说明符的方法（但不确定它是否会显示 + 和 - 符号）：

```
TimeSpan span = new TimeSpan(7, 0, 0);
Console.WriteLine(span.ToString("hhmm")); 
```

如果没有，您可以将`Hours`and`Minutes`属性与一些条件格式一起格式化，以始终显示 + 和 - 符号：

```
TimeSpan span = new TimeSpan(7, 0, 0);
Console.WriteLine("{0:+00;-00}{1:00}", span.Hours, span.Minutes); 
```

TimeSpan 格式字符串的参考：http: [//msdn.microsoft.com/en-gb/library/ee372287.aspx](http://msdn.microsoft.com/en-gb/library/ee372287.aspx)

数字格式字符串及其条件格式的参考：http: [//msdn.microsoft.com/en-us/library/0c899ak8.aspx](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T01:01:03.210

尝试类似：

```
var timespan = new TimeSpan(-5,0,0); // EST
var offset = String.Format("{0}{1:00}{2:00}",(timespan.Hours >= 0 ? "+" : String.Empty),timespan.Hours,timespan.Minutes); 
```

当数字为非负数时，我添加 +（对于负数，应输出 - ）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T01:01:17.470

我认为你可以使用这个：

```
String.Format("{0:zzz}", ts); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-13T07:30:55.720

这段代码：

```
var timeSpan = new TimeSpan(2, 30, 0);
Console.WriteLine(new DateTimeOffset(2000, 1, 1, 1, 1, 1, timeSpan).ToString("zzz"));
Console.WriteLine(new DateTimeOffset(2000, 1, 1, 1, 1, 1, -timeSpan).ToString("zzz")); 
```

输出：

```
+02:30
-02:30 
```

# forms - 离开和返回 HTTPS 页面时如何保持更改的表单内容？（适用于 HTTP）

> ID：14420624
> 
> 赞同：23
> 
> 时间：2013-01-20T00:56:12.317
> 
> 标签：forms, browser, https, back

1.  在文本区域中输入/更改某些内容
2.  在提交表单之前，离开页面（例如通过点击浏览器的后退按钮）
3.  返回编辑页面（例如通过单击前进按钮）

预期结果：在 textarea 中输入的内容应该仍然存在

实际结果：

*   使用**HTTPS**：所有更改都消失了*（糟糕！）*
*   使用**HTTP**：更改仍然存在*（好！）*

为什么在使用 HTTPS 时会发生这种情况？我怎样才能防止这种情况？是浏览器还是网站负责？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2013-01-20T04:40:36.300

您可以考虑以下解决方案：

## 属性( **`autocomplete`**HTML5)

这似乎无关，因为告诉浏览器使用**基于早期用户输入**`autocomplete`的值完成字段，这些用户输入与表单一起“提交”。但在我的测试中，我看到了这一点；填写表格后未提交；当我按下前进（历史）按钮并再次回击时；如果我设置表单字段会自动填充，并且在设置为.**`autocomplete="on"``"off"`**

 **所以; （如果针对 HTML5 用户）您可以使用此属性来“缓存”您的表单数据。（适用于所有主流浏览器，Opera 除外）。

```
<form action="/update" method="post" autocomplete="on">
    Email:    <input type="text" id="email" /><br />
    Username: <input type="text" id="uname" /><br />
    Password: <input type="password" id="pwd" autocomplete="off"/><br />
    <input type="submit" />
</form> 
```

请注意，当其余表单控件打开时，您可以为特定字段（在本例中为密码）设置自动完成功能。

***MSDN 备注：***

*   *如果缺少 autocomplete 属性，如果元素没有父表单，或者表单的自动完成设置为“on”，则该字段将默认为“on”状态。*
*   *自动完成功能提供的信息不会暴露给对象模型，并且在用户选择其中一个建议作为文本字段的值之前对网页不可见。*

## 在本地保存未提交的表单数据：

您可以将输入数据存储在本地，在页面重定向之前或每个表单控件的焦点输出事件上：

### *饼干*

在这种情况下，旧 cookie 可以派上用场，但您应该考虑缺点：

1.  即使您可以以编程方式加密值；由于我们将在客户端工作，因此 cookie 对此并不真正安全。`Http-Only`标记的`Secure`cookie 在这里对我们没有帮助，因为这些选项用于在 cookie 被“发送”（安全）并且无法从 Javascript（仅限 http）访问时强制执行 SSL。
2.  浏览器有 cookie 大小限制。来自**MSDN**：*“大多数浏览器支持最多 4096 字节的 cookie。由于这个小限制，cookie 最好用于存储少量数据”。*因此，如果您不注意这个大小（当您编写 cookie 和/或通过`maxlength`属性限制控件的值时）；这可能是个问题。（在这种情况下，修剪值是最糟糕的事情）。
3.  浏览器对每个域可以设置的 cookie 数量也有限制。所以; 在 cookie 中存储表单数据时；而不是为每个表单字段值设置 cookie；您应该将它们合并到一个或几个 cookie 中；为您的网站不超过此限制。

不过，好的一面是它们受到所有浏览器的支持，如果您不打算通过 Cookies“缓存”敏感和过长的数据，那么您可以使用以下解决方案。如果不是这种情况；您最好采用下一个建议：`localStorage`。

```
// Below is just a demonstration and is not tested thoroughly for 
// production-ready web applications by any means.  
// But it should give you an idea.

/** 
 * Caches the user-input data from the targeted form, stores it in the cookies 
 * and fetches back to the form when requested or needed. 
 */
var formCache = (function () {
    var _form = null, 
        _formData = [],
        _strFormElements = "input[type='text'],"
                + "input[type='checkbox']," 
                + "input[type='radio']," 
                // + "input[type='password'],"  // leave password field out 
                + "input[type='hidden'],"
                // + "input[type='image'],"
                + "input[type='file'],"
                // more input types...
                + "input[type='email'],"
                + "input[type='tel'],"
                + "input[type='url'],"
                + "select,"
                + "textarea";

    function _warn() {
        console.log('formCache is not initialized.');
    }

    return {

        /**
         * Initializes the formCache with a target form (id). 
         * You can pass any container id for the formId parameter, formCache will 
         * still look for form elements inside the given container. If no form id 
         * is passed, it will target the first <form> element in the DOM. 
         */
        init: function (formId) {
            var f = (typeof formId === 'undefined' || formId === null || $.trim(formId) === '') 
                    ? $('form').first() 
                    : $('#' + formId);
            _form = f.length > 0 ? f : null;
            console.log(_form);
            return formCache; // make it chainable
        },

        /** 
         * Stores the form data in the cookies.
         */
        save: function () {
            if (_form === null) return _warn();

            _form
                .find(_strFormElements)
                .each(function() {
                    var f = $(this).attr('id') + ':' + formCache.getFieldValue($(this));
                    _formData.push(f);
                });
            docCookies.setItem('formData', _formData.join(), 31536e3); // 1 year expiration (persistent)
            console.log('Cached form data:', _formData);
            return formCache;
        },

        /** 
         * Fills out the form elements from the data previously stored in the cookies.
         */
        fetch: function () {
            if (_form === null) return _warn();

            if (!docCookies.hasItem('formData')) return;
            var fd = _formData.length < 1 ? docCookies.getItem('formData').split(',') : _formData;
            $.each(fd, function (i, item) {
                var s = item.split(':');
                var elem = $('#' + s[0]);
                formCache.setFieldValue(elem, s[1]);
            });
            return formCache;
        },

        /** 
         * Sets the value of the specified form field from previously stored data.
         */
        setFieldValue: function (elem, value) {
            if (_form === null) return _warn();

            if (elem.is('input:text') || elem.is('input:hidden') || elem.is('input:image') ||
                    elem.is('input:file') || elem.is('textarea')) {
                elem.val(value);
            } else if (elem.is('input:checkbox') || elem.is('input:radio')) {
                elem.prop('checked', value);
            } else if (elem.is('select')) {
                elem.prop('selectedIndex', value);
            }
            return formCache;
        },

        /**
         * Gets the previously stored value of the specified form field.
         */
        getFieldValue: function (elem) {
            if (_form === null) return _warn();

            if (elem.is('input:text') || elem.is('input:hidden') || elem.is('input:image') ||
                elem.is('input:file') || elem.is('textarea')) {
                    return elem.val();
                } else if (elem.is('input:checkbox') || elem.is('input:radio')) {
                    return elem.prop('checked');
                } else if (elem.is('select')) {
                    return elem.prop('selectedIndex');
                }
            else return null;
        },

        /**
         * Clears the cache and removes the previously stored form data from cookies.
         */
        clear: function () {
            _formData = [];
            docCookies.removeItem('formData');
            return formCache;
        },

        /**
         * Clears all the form fields. 
         * This is different from form.reset() which only re-sets the fields 
         * to their initial values.
         */
        clearForm: function () {
            _form
                .find(_strFormElements)
                .each(function() {
                    var elem = $(this);
                    if (elem.is('input:text') || elem.is('input:password') || elem.is('input:hidden') || 
                        elem.is('input:image') || elem.is('input:file') || elem.is('textarea')) {
                        elem.val('');
                    } else if (elem.is('input:checkbox') || elem.is('input:radio')) {
                        elem.prop('checked', false);
                    } else if (elem.is('select')) {
                        elem.prop('selectedIndex', -1);
                    }
                });
            return formCache;
        }
    };
})();

// Save form data right before we unload the form-page
$(window).on('beforeunload', function (event) {
    formCache.save();
    return false;
});

// Initialize and fetch form data (if exists) when we load the form-page back
$(document).on('ready', function (event) {
    formCache.init().fetch();
}); 
```

这是**[关于 jsFiddle 的工作演示](http://jsfiddle.net/onury/PJbye/)**。

***注意：来自****[developer.mozilla.org](http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#autofilling-form-controls:-the-autocomplete-attribute)**的“cookies reader/writer”脚本应该包含在上面的代码中。您还可以使用 Yahoo 的[YUI 2: Cookie Utility](http://developer.yahoo.com/yui/cookie/)，它有一个有用的[setSub()](http://developer.yahoo.com/yui/cookie/#subcookies)方法，用于在单个 cookie 中设置子 cookie，用于我之前提到的浏览器限制。*

### *本地存储*

您还可以使用更现代的技术，例如`localStorage`(HTML5)。它更安全，更快捷。所有主流浏览器都支持此功能，包括 IE 8+。（此外，iOS 和 Android 支持！）

```
if (typeof Storage !== 'undefined') { // We have local storage support
    localStorage.username = 'Onur'; // to save to local storage
    document.getElementById('uname').value = localStorage.username; // to fetch from local storage
} 
```

因此，就像在 cookie 示例中一样；

```
$(window).on('beforeunload', function (event) {
    saveFormToLocalStorage();
    return false;
});

$(document).on('ready', function (event) {
    fillFormFromLocalStorage()
}); 
```

### *会话存储*

这几乎以相同的方式工作。来自 W3C： sessionStorage 对象与 localStorage 对象相同，只是它只存储一个会话的数据。

## 通过静默 AJAX 帖子将表单数据保存到服务器/数据库：

这不是一种非常有效的方法，但您可能希望在其他方法不可行的情况下使用它。您可以在`beforeunload`事件上发布帖子并向用户提示消息。

```
$(window).on('beforeunload', function (event) {
    //check if at least one field is filled out.
    //make the AJAX post if filled out.
    return "You are leaving the page without submitting the form...";
}); 
```

## 在页面加载时从服务器检索以前保存的数据：

提醒你一下; 例如，如果用户正在填写“更新”表格；您始终可以从服务器获取以前保存的数据并自动填写表格（非敏感字段）。

## 结论

如果您真的需要这个并且值得麻烦；您应该考虑实现回退机制的跨浏览器解决方案；如：

*   如果您支持 HTML5 功能；使用**HTML5`autocomplete` 属性**。（您可以预先在 HTML 中嵌入该属性，或者在测试浏览器支持时通过 Javascript/jQuery 进行设置。）
*   ELSE 如果您支持该`Storage`对象；一起去 **`localStorage`**；
*   ELSE IF [cookies your current session stores] + [cookie size your form data needs] < 4096 bytes; 然后使用**`cookies`**.
*   否则，如果您有服务器端 Web 应用程序，请发出静默 AJAX 请求以 **将数据存储在 server 上**。
*   否则不要这样做。

***注意：****对于 HTML5 功能检测，请查看[此页面](http://diveintohtml5.info/detect.html)或[此页面](http://www.javascriptkit.com/javatutors/createelementcheck.shtml)，或者您可以使用[Modernizr](http://modernizr.com/)。*

**HTTPS 问题**：

原因是，使用**HTTPS**时所有表单更改都消失了；这是一个**[安全协议](http://jsfiddle.net/onury/PJbye/)**。表单主要用于用户输入，并且可以（可能）包含敏感数据。所以这种行为看起来很自然，也是意料之中的。我在上面提供的解决方案与在 HTTP 上的工作方式相同。所以这应该涵盖你所有的担忧。

## 进一步阅读：

*   [自动填充表单控件：自动完成属性](http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#autofilling-form-controls:-the-autocomplete-attribute)
*   [HTML5 表单自动完成属性](http://www.w3schools.com/html5/att_form_autocomplete.asp)
*   [DOM 存储](https://developer.mozilla.org/en-US/docs/DOM/Storage)
*   [HTML5 网络存储](http://www.w3schools.com/html/html5_webstorage.asp)
*   [Web 本地存储的未来](http://diveintohtml5.info/storage.html)
*   [饼干](http://www.quirksmode.org/js/cookies.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-23T11:32:02.467

这对我有用。

```
<select
  class="form-select custom-select page-number-select"
  (change)="onPageChange($event)"
  data-test="XXXX"
  [attr.aria-labelledby]="XXXX"
  [value]="pageNumber" <---- This fixed the problem
>
  <ng-container
    *ngFor="let pageNumber of totalPageCount"
  >
    <option value="{{ pageNumber }}" [attr.selected]="pageNumber == page ? '' : null" >
      {{ t('pageN', { pageNumber: pageNumber }) }}
    </option>
   </ng-container>
</select> 
```

**在value**属性中添加来自流的数据可确保始终显示正确的值。即使在浏览器的 popstate 事件（后退和前进按钮点击）**

# ios - 如何使用ios框架获取谷歌驱动器中所有文件的名称

> ID：14420629
> 
> 赞同：-1
> 
> 时间：2013-01-20T00:57:08.260
> 
> 标签：ios, google-drive-api

无法获取在 Google Drive 目录中指定数据后创建的所有文件名的列表：

```
query = [GTLQueryDrive queryForFilesList];
//query.q = @"mimeType = 'text/plain'";
//query.q = @"mimeType = 'image/png'";
query.q = @"modifiedDate > '20011-06-04T12:00:00'";
authController = [[GTMOAuth2ViewControllerTouch alloc] in itWithScope:kGTLAuthScopeDrive clientID:kClientID  clientSecret:kClientSecret keychainItemName:kKeychainItemName delegate:self 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T10:36:15.983

更改 DrEditFilesListViewController.m 方法 authButtonClicked 的范围

将此范围 kGTLAuthScopeDriveFile 替换为 kGTLAuthScopeDrive 如下

```
GTMOAuth2ViewControllerTouch *authViewController = [[GTMOAuth2ViewControllerTouch alloc] initWithScope:kGTLAuthScopeDriveFile
                                         clientID:kClientId
                                     clientSecret:kClientSecret
                                 keychainItemName:kKeychainItemName
                                         delegate:self
                                 finishedSelector:finishedSelector]; 
```

至

```
GTMOAuth2ViewControllerTouch *authViewController = [[GTMOAuth2ViewControllerTouch alloc] initWithScope:kGTLAuthScopeDrive
                                         clientID:kClientId
                                     clientSecret:kClientSecret
                                 keychainItemName:kKeychainItemName
                                         delegate:self
                                 finishedSelector:finishedSelector]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T04:37:11.807

检查您的日期：

```
query.q = @"modifiedDate > '20011-06-04T12:00:00'"; 
```

你想用`2011-06-04`吗？如果是这样，那么：

```
query.q = @"modifiedDate > '2011-06-04T12:00:00'"; 
```

# ruby - 为什么是 Ruby 第 5.7 章的辛酸指南。WishScanner 模块

> ID：14420631
> 
> 赞同：0
> 
> 时间：2013-01-20T00:57:30.940
> 
> 标签：ruby

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:16:13.150

> `wish.gsub( 'wish: ', '' )`在我看来，它似乎只是用一个空字符串替换了wish

确切地！它替换字符串`"wish: "`中的字符串，例如`"wish: A pony!"`with `""`。
即它变成“愿望：一匹小马！” 变成“小马！”。

# algorithm - 近似算法。如何找到获得> = x点的最短周期

> ID：14420632
> 
> 赞同：2
> 
> 时间：2013-01-20T00:57:37.120
> 
> 标签：algorithm, cycle, approximation

有一张带点的地图：

![带有多个节点的地图，每个节点旁边都有一个绿色和红色数字](../Images/f3bf43b828ee44c87f8bdbe2ba31f04c.png)

每个点旁边的绿色数字是该点的 ID，红色数字是该点的奖励。我必须找到在 #1 点开始和结束的最快周期，并且至少获得 x（在这种情况下为 15）加分。我可以多次使用城市；但是，我只会获得一次奖励积分。我必须使用近似算法来做到这一点，但我真的不知道从哪里开始。

输出将如下所示：

```
(1,3,5,2,1) (11.813 length) 
```

![与以前相同的地图，预期的输出路线以橙色突出显示](../Images/f2ad64d854c4d0102108bdd3e95fed42.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:11:07.633

这不是NP问题吗？如果是这样，如果不测试所有可能性，您将无法找到最快的，这将花费相当长的时间。

这个问题类似于[旅行推销员](http://en.wikipedia.org/wiki/Travelling_salesman_problem)，恕我直言。到目前为止，这个问题最著名的解决方案是[Ant Colony 解决方案](http://joel.inpointform.net/software-development/traveling-salesman-ant-colony-optimization-javascript-solution/)。此解决方案不能保证总是找到可能的最佳解决方案，但它会在可接受的时间内找到至少一个相当好的解决方案。

我认为可以通过以某种方式考虑奖励积分来修改 Ant Colony 解决方案以解决您的问题。可能不是您想听到的答案，而是我目前提供的最好的答案。

# visual-studio - Visual Studio：在同一解决方案中对 Web 项目进行单元测试

> ID：14420633
> 
> 赞同：6
> 
> 时间：2013-01-20T00:57:47.447
> 
> 标签：visual-studio, asp.net-web-api

我有一个包含 WebAPI 项目和 VS 测试项目的解决方案。

我的测试通过 Url 使用 RestSharp 调用 API，而不是实例化控制器本身并注入东西（上下文等）。

我的问题，有没有办法告诉测试项目在测试运行开始时通过 IIS Express 启动 Web 项目？目前我只运行两个 VS 实例，一个带有已启动调试的 web 投影，另一个运行测试包

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-06-16T00:52:27.483

如果您尝试同时调试测试和服务，请考虑这样做

1.  启动以在 Visual Studio 中调试 Web 服务。
2.  点击`Debug`-> `Detach All`。IIS Express 将继续运行。
3.  设置断点并开始调试您的单元测试。
4.  （如果您不需要调试 Web 服务，请跳过此步骤）单击`Debug`-> `Attach to Process`。查找`iisexpress.exe`并附加。

但是，您在已分离的 Web 服务上丢失了“编辑并继续”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T03:07:31.710

我不建议使用网络对 Web API 进行单元测试。你对测试中潜在的脆弱性敞开心扉，你最终测试的不仅仅是服务本身。

但如果你真的必须这样做，也许是为了测试你的客户端可以与 API 交换信息，那么我建议你考虑自托管服务：

[http://www.asp.net/web-api/overview/hosting-aspnet-web-api/self-host-a-web-api](http://www.asp.net/web-api/overview/hosting-aspnet-web-api/self-host-a-web-api)

自托管让您只需几行代码即可为 Web API 启动服务器，并且您可以让您的测试在正确的位置启动该服务器。在大多数情况下，这应该与将服务托管在 IIS Express 中的行为相同。但是有一些重要的区别。例如，您将无法使用您可能习惯的某些 System.Web 概念（如 HttpContext.Current）。

更新：

我写了一篇关于测试 Web API 服务的博客文章，可能会有所帮助 - [https://docs.microsoft.com/en-us/archive/blogs/youssefm/writing-tests-for-an-asp-net-web- api服务](https://docs.microsoft.com/en-us/archive/blogs/youssefm/writing-tests-for-an-asp-net-web-api-service)

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-31T11:14:20.793

在非调试版本中运行您的 Web 服务或站点，`CTRL-F5`使其独立于 Visual Studio 运行，您可以从 VS 内部自由运行测试

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-14T00:06:30.207

我知道这是一篇旧帖子，但我刚刚遇到了这个问题。如果/当有人读到这篇文章时，我可以提供更详细的回复。

简而言之..我创建了一个引用单元测试程序集的控制台应用程序，并通过反射和一个简单的菜单系统，您可以运行任何一个测试。

然后我将多个启动项目设置为 Web 项目和控制台项目。

然后我可以在同一个会话中按 F5 并调试单元测试和 Web 项目。无需附加到多个解决方案的过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-26T17:45:53.850

我知道这已经很晚了，但我使用了这个解决方案：

启动两个 Visual Studio 实例。在一个 VS 中开始调试 API，然后在另一个 VS 中调试测试。

# ruby-on-rails-3 - 未找到 Rails 测试 - 未定义的局部变量或方法“响应”

> ID：14420635
> 
> 赞同：3
> 
> 时间：2013-01-20T00:58:10.193
> 
> 标签：ruby-on-rails-3, syntax, rspec2, railstutorial.org

我正在尝试遵循 Michael Hartl 的[Rails 3 教程](http://ruby.railstutorial.org)，但遇到了一个在其他地方找不到解释的错误。在[第 9.2.1 节](http://ruby.railstutorial.org/chapters/updating-showing-and-deleting-users#sec-requiring_signed_in_users)下，我在尝试为尝试更新个人资料页面的未登录用户运行测试时遇到错误。

```
describe "submitting to the update action" do
  before { put user_path(user) }
  specify { response.should redirect_to(signin_path) }
end 
```

我得到的错误是“#（NameError）的未定义局部变量或方法'响应'”。这是对“bundle exec rspec spec/”的回应。当我注释掉违规行时，所有测试都会实例化并通过。我试过用“response.body”和“page”之类的东西替换“response”，但似乎都没有帮助。

我不确定问题出在哪里，因为随着我继续学习本教程，类似的块正在顺利通过。

这是完整的错误文本：

```
C:\Ruby193\bin\ruby.exe -e $stdout.sync=true;$stderr.sync=true;load($0=ARGV.shift) C:\Ruby193\bin\rake spec
Testing started at 7:39 PM ...
C:/Ruby193/bin/ruby.exe -S rspec ./spec/models/user_spec.rb ./spec/requests/authentication_pages_spec.rb ./spec/requests/static_pages_spec.rb ./spec/requests/user_pages_spec.rb
Rack::File headers parameter replaces cache_control after Rack 1.5.
C:/Users/Jeff/Documents/rails_projects/sample_app/spec/requests/authentication_pages_spec.rb:60:in `block (5 levels) in <top (required)>': undefined local variable or method `response' for #<Class:0x4894908> (NameError)
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:244:in `module_eval'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:244:in `subclass'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:230:in `describe'
    from C:/Users/Jeff/Documents/rails_projects/sample_app/spec/requests/authentication_pages_spec.rb:58:in `block (4 levels) in <top (required)>'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:244:in `module_eval'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:244:in `subclass'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:230:in `describe'
    from C:/Users/Jeff/Documents/rails_projects/sample_app/spec/requests/authentication_pages_spec.rb:51:in `block (3 levels) in <top (required)>'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:244:in `module_eval'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:244:in `subclass'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:230:in `describe'
    from C:/Users/Jeff/Documents/rails_projects/sample_app/spec/requests/authentication_pages_spec.rb:48:in `block (2 levels) in <top (required)>'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:244:in `module_eval'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:244:in `subclass'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:230:in `describe'
    from C:/Users/Jeff/Documents/rails_projects/sample_app/spec/requests/authentication_pages_spec.rb:46:in `block in <top (required)>'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:244:in `module_eval'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:244:in `subclass'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:230:in `describe'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/dsl.rb:18:in `describe'
    from C:/Users/Jeff/Documents/rails_projects/sample_app/spec/requests/authentication_pages_spec.rb:3:in `<top (required)>'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `block in load'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:236:in `load_dependency'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/configuration.rb:789:in `block in load_spec_files'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/configuration.rb:789:in `each'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/configuration.rb:789:in `load_spec_files'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:22:in `run'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'
rake aborted!
C:/Ruby193/bin/ruby.exe -S rspec ./spec/models/user_spec.rb ./spec/requests/authentication_pages_spec.rb ./spec/requests/static_pages_spec.rb ./spec/requests/user_pages_spec.rb failed
-e:1:in `load'
-e:1:in `<main>'
Tasks: TOP => spec
(See full trace by running task with --trace)

Process finished with exit code 1
Empty test suite. 
```

我很确定这不是某个地方的错字，但这是有问题的文件（authentication_pages_spec.rb）。（have_title() 是我在这里找到的一种修复错误的方法，因为显然 have_selector('title',...) 不再是有效的语法。）

```
require 'spec_helper'

describe "Authentication" do

  subject { page }

  describe "signin page" do
    before { visit signin_path }

    it {should have_selector('h1', text: 'Sign in') }
    it {should have_title('Sign in') }
  end

  describe "signin" do
    before { visit signin_path }

    describe "with invalid information" do
      before { click_button "Sign in" }

      it { should have_title('Sign in') }
      it { should have_selector('div.alert.alert-error', text: 'Invalid') }

      describe "after visiting another page" do
        before { click_link "Home" }
        it { should_not have_selector('div.alert.alert-error') }
      end
    end

    describe "with valid information" do
      let(:user) { FactoryGirl.create(:user) }
      before { sign_in user }

      it { should have_title(user.name) }
      it { should have_link('Profile', href: user_path(user)) }
      it { should have_link('Settings', href: edit_user_path(user)) }
      it { should have_link('Sign out', href: signout_path) }
      it { should_not have_link('Sign in', href: signin_path) }

      describe "followed by signout" do
        before { click_link "Sign out" }
        it { should have_link('Sign in') }
      end
    end
  end

  describe "authorization" do

    describe "for non-signed-in users" do
      let(:user) { FactoryGirl.create(:user) }

      describe "in the Users controller" do

        describe "visiting the edit page" do
          before { visit edit_user_path(user) }
          it { should have_title('Sign in') }
        end

        describe "submitting to the update action" do
          before { put user_path(user) }
          specify ( response.should redirect_to(signin_path) )
        end

        describe "as wrong user" do
          let(:user) { FactoryGirl.create(:user) }
          let(:wrong_user) { FactoryGirl.create(:user, email: "wrong@example.com") }
          before { sign_in user }

            describe "visiting Users#edit_page" do
              before { visit edit_user_path(wrong_user) }
              it { should_not have_title(full_title("Edit user")) }
            end

            describe "submitting a PUT request to the Users#update action" do
              before { put user_path(wrong_user) }
              specify { response.should redirect_to(root_path) }
            end
         end
      end
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T23:24:02.797

你运行的是什么版本的 Capybara？

```
$ bundle exec gem list | grep capybara 
```

如果您正在运行版本`>= 2.0`，您应该再次查看您的 Gemfile，并专门将版本标记为与教程 ( `1.1.2`) 相同。

**宝石文件**

```
group :test do
  gem 'capybara', '1.1.2'
end 
```

如果您*非常*想使用最新版本，则必须进行一些更改，如下 StackOverflow 问答中所述：

*   [Capybara 方法未定义](https://stackoverflow.com/q/14378668/567863)
*   [capybara：发布，将请求目录的名称更改为功能时获取方法不起作用](https://stackoverflow.com/q/14473810/567863)
*   [RSpec & Capybara 2.0 让我的 have_selector 测试出错](https://stackoverflow.com/q/13573525/567863)

### 更新

好的，你会踢自己，但是在克隆你的 repo 并得到同样的错误之后，你的问题很明显（语法突出显示是你的朋友）：

在您的[**spec/requests/authentication_pages_spec.rb**](https://github.com/Artiavis/sample_app/blob/master/spec/requests/authentication_pages_spec.rb#L77)[的第 77 行，您](https://github.com/Artiavis/sample_app/blob/master/spec/requests/authentication_pages_spec.rb#L77)**有：**

 **```
specify ( response.should redirect_to(signin_path) ) 
```

它应该是：

```
specify { response.should redirect_to(signin_path) } 
```

修复后，您的测试将通过。**

# php - Facebook 登录：检查每个页面的身份验证？

> ID：14420639
> 
> 赞同：0
> 
> 时间：2013-01-20T00:59:18.630
> 
> 标签：php, facebook, session

我正在遵循本指南：[https ://developers.facebook.com/docs/howtos/login/getting-started/](https://developers.facebook.com/docs/howtos/login/getting-started/)

关于登录，一切正常。我不明白的是我如何处理“会话”：

*   我猜 FB.getLoginStatus 是用来代替会话的？
*   每次用户在我的网站中输入新页面时，我都必须检查 FB.getLoginStatus 36。这是否意味着我必须为每个页面初始化 JavaScript SDK？每个页面都有 50 行代码，只是为了检查登录状态。

我正在使用 PHP、MySQL、JavaScript 和 HTML5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T07:22:46.223

> 我猜 FB.getLoginStatus 是用来代替会话的？

`FB.getLoginStatus`用于帮助您根据登录状态优化访问者体验，因此它不能替代“*会话*”。

> 每次用户在我的网站中输入新页面时，我都必须检查 FB.getLoginStatus。这是否意味着我必须为每个页面初始化 JavaScript SDK？每个页面都有 50 行代码，只是为了检查登录状态......

好吧，如果您想使用 SDK，则*必须*初始化 Javascript SDK。现在我看不出*代码行数有*什么问题，因为 Facebook 已经异步加载了 SDK，因此它不会阻塞你的页面资源。

对于您的第一点，您不必`FB.getLoginStatus`每次在页面加载时都调用，Facebook 已经在相关[文档](https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)中声明了这一点：

> 虽然您可以随时调用`FB.getLoginStatus`（例如，当用户尝试进行社交操作时），但大多数社交应用程序需要在页面加载后尽快了解用户的状态。在这种情况下，可以通过设置when you call`FB.getLoginStatus`来检查用户的状态，而不是显式调用。`status: true``FB.init`
> 
> 要接收此调用的响应，您必须订阅该 `auth.statusChange`事件。此事件传递的响应对象与显式调用返回的响应对象相同`FB.getLoginStatus` 。

* * *

现在您可能错过的一件事是[PHP-SDK](https://developers.facebook.com/docs/reference/php/)：

> Facebook SDK for PHP 可以与 Facebook SDK for Javascript 结合使用，在应用程序的客户端和服务器端提供无缝会话管理。

这将使您的生活更轻松，因为您会在（之前）加载页面时了解用户状态，从而相应地自定义用户体验，然后等待由 Javascript SDK 触发的任何状态更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T01:09:23.833

从 Facebook 开发人员区域来看，他们似乎有一节介绍如何在不调用 Javascript SDK 的情况下登录。

[https://developers.facebook.com/docs/howtos/login/client-side-without-js-sdk/](https://developers.facebook.com/docs/howtos/login/client-side-without-js-sdk/)

用户将拥有一个 API 访问令牌，可用于进一步的请求。

我希望这会有所帮助。

# wcf - 在 WCF 的返回值中包含异常信息

> ID：14420644
> 
> 赞同：0
> 
> 时间：2013-01-20T01:00:25.820
> 
> 标签：wcf, exception-handling, ierrorhandler

我正在`IErrorHandler`为一组 WCF 服务实现一个。我将 WCF 服务配置为通过配置文件使用自定义行为来使用此错误处理程序。

所有服务中的所有方法都返回一个从公共基类派生的值。

如果错误处理程序被调用，我想要做的是在返回值中包含有关错误的信息。

任何关于如何优雅地做到这一点的想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T19:13:41.237

您只需要手动创建符合您返回的 SOAP 数据的消息。您可以实现自己的正文编写器并将其用于该`Message.Create`功能。这是一个很好的示例，说明了如何完成您基本上需要的操作[WCF 中 webHttpBinding 的简单自定义错误处理程序](http://sadomovalex.blogspot.se/2011/04/simple-custom-error-handler-for.html)
但是，如果我是您，我会选择错误方法，当您只返回 void 或一些数据时，如果一切都成功，如果失败则返回错误消息。当然，如果没有严格要求在响应对象中返回操作状态，或者如果您不重构现有系统。

希望能帮助到你。

# ruby - 如何在 Rails 3.2 中使用“to_xs”？

> ID：14420651
> 
> 赞同：2
> 
> 时间：2013-01-20T01:01:21.800
> 
> 标签：ruby, gem, ruby-on-rails-3.2

我知道这是在`builder`宝石中。所以我把它放在我的 Gemfile 中。然后我`bundle install`。

在控制台中运行，我输入：

```
x = "akwf" 
```

然后：

```
x.to_xs 
```

并获得以下奖励：

```
NoMethodError: undefined method `to_xs' for "akwf":String 
```

当我尝试`require 'builder'`并`require 'builder/xchar'`遇到`false`.

为了执行这个基本功能，我缺少什么基本项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T01:09:13.680

首先，请注意 Rails`builder`已经包含，因此无需将其添加到`Gemfile`.

其次，请求时的错误返回值并不是很糟糕。这只是意味着该库已经被成功需要并且不需要重新需要。如果`require`在加载库时遇到问题，它会引发异常，而不是返回 false。

第三，`builder/xchar.rb`指定如果`String#encode`定义了，那么它会跳过旧`String#to_xs`定义，而是定义`Builder::XChar.encode(string)`，这似乎服务于相同的目的。尝试要求`builder/xchar`并尝试一下。

# c# - GridView 控件已正确分配数据，但不显示

> ID：14420657
> 
> 赞同：0
> 
> 时间：2013-01-20T01:02:45.107
> 
> 标签：c#, gridview

我在一个单独的类中有一个方法，它返回一个 GridView 但由于某种原因它不会显示数据。经过进一步调查，我发现 Gridview 已经分配了正确的数据但不显示它！如果我在主类中运行代码，它工作正常！请帮忙！

//黑胶类

```
public GridView SearchByAlbum(string AlbumName)
{
    VinylComm.CommandType = CommandType.StoredProcedure;
    VinylComm.CommandText = "AlbumVinylSearch";

    SqlParameter VinylAlbumName;
    VinylAlbumName = new SqlParameter();
    VinylAlbumName.ParameterName = "@AlbumName";
    VinylAlbumName.SqlDbType = SqlDbType.VarChar;
    VinylAlbumName.SqlValue = AlbumName;
    VinylAlbumName.Size = 50;
    VinylAlbumName.Direction = ParameterDirection.Input;

    VinylComm.Parameters.Add(VinylAlbumName);

    GridView gv;
    gv = new GridView();

    VinylConn.Open();
    gv.DataSource = VinylComm.ExecuteReader();
    gv.DataBind();
    VinylConn.Close();

    return gv;
} 
```

//主页

```
protected void Submit_Click(object sender, EventArgs e)
{
    Vinyl v;
    v = new Vinyl();
    switch (SearchOptions.SelectedIndex)
    {
        case 0:
            GridView1 = v.SearchByAlbum(SearchInput.Text);
            break;
        default:
            break;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T01:08:52.823

> Gridview 知道它有数据但不想显示它

淘气`GridView`。而不是创建动态`GridViews`并将引用分配给页面中已经存在的另一个 GridView，您应该简单地返回`DataSource`. 这甚至都行不通，如果您想在其他地方获得该数据，它也更可重用。

```
switch (SearchOptions.SelectedIndex)
{
    case 0:
        GridView1.DataSource = v.SearchByAlbum(SearchInput.Text);
        break;
    default:
        break;
}
GridView1.DataBind(); 
```

以及加载和返回数据的方法：

```
public IDataSource SearchByAlbum(string AlbumName)
{
    // ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T01:36:54.060

为了扩展先前的答案，我完全同意您应该将数据源从您的 Vinyl 类传递给您的 DataSource：

```
GridView1.DataSource = v.SearchByAlbum(SearchInput.Text); 
```

但是，我建议从您的 SearchByAlbum 过程中返回一个`List<yourObject>`或。`IEnumerable`我认为您的 DAL 和您的 UI 应该相互独立。这就是引入模型（或 DTO）可以帮助减轻未来变化带来的痛苦的地方。

像这样的东西：

```
public class yourobject {
   int id { get; set; }
   string anyotherprop { get; set; }
} 
```

然后在你的 Vinyl 类中（只是从上面复制，但有些可以合并——你应该使用 using 例如，但这是另一个主题）：

```
public List<yourobject> SearchByAlbum(string AlbumName)
{
    List<yourobject> yourobjects = new List<yourobject>();

    VinylComm.CommandType = CommandType.StoredProcedure;
    VinylComm.CommandText = "AlbumVinylSearch";

    SqlParameter VinylAlbumName;
    VinylAlbumName = new SqlParameter();
    VinylAlbumName.ParameterName = "@AlbumName";
    VinylAlbumName.SqlDbType = SqlDbType.VarChar;
    VinylAlbumName.SqlValue = AlbumName;
    VinylAlbumName.Size = 50;
    VinylAlbumName.Direction = ParameterDirection.Input;

    VinylComm.Parameters.Add(VinylAlbumName);

    VinylConn.Open();

    SqlDataReader reader = VinylComm.ExecuteReader();
    while (reader.Read())
    {
        yourobjects.Add(new yourobject() { 
           //Fill values
        });
    }
    VinylConn.Close();

    return yourobjects;
} 
```

此外，如果在其他 Gridview 程序（RowDataBound、RowCommand 等）中使用，我认为您会发现投射对象也更容易。

祝你好运。

# c# - 调用 Process.Start("mailto:...") 时出错

> ID：14420658
> 
> 赞同：1
> 
> 时间：2013-01-20T01:02:45.407
> 
> 标签：c#, email, exception-handling, mailto, process.start

你好我用这个代码发送一封电子邮件

```
Process.Start("mailto:" + Email + "?subject=Contact" + "&body=" + bodymesssage); 
```

在我的电脑中正常工作，但在服务器中在客户端抛出此错误：

> 未捕获的 Sys.WebForms.PageRequestManagerServerErrorException：Sys.WebForms.PageRequestManagerServerErrorException：没有足够的存储空间来完成此操作

这是缺少配置吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:25:16.673

改用这个：

```
public static void SendMessage(String server, String[] emails, String subject, String body)
{
    MailMessage message = new MailMessage(m_Sender, String.Join(",", emails), subject, body);

    SmtpClient client = new SmtpClient(smtpServer);
    client.Credentials = CredentialCache.DefaultNetworkCredentials;

    try { client.Send(message); }
    catch (Exception ex) { Console.WriteLine("ERROR!"); }
} 
```

# azure - wkhtmltopdf 在 Azure 网站上失败

> ID：14420661
> 
> 赞同：5
> 
> 时间：2013-01-20T01:03:00.333
> 
> 标签：azure, wkhtmltopdf, azure-web-app-service

我正在使用[https://github.com/codaxy/wkhtmltopdf](https://github.com/codaxy/wkhtmltopdf)包装器从我网站上的网页创建 pdf（我传入一个绝对 URL，例如[http://mywebsite.azurewebsites.net/PageToRender.aspx](http://mywebsite.azurewebsites.net/PageToRender.aspx)它在开发人员和另一个共享托管帐户上工作正常，但是当我部署到 Azure 网站时，它失败了，我得到的只是一个 ThreadAbortException。是否可以在 azure 上使用 wkhtmltopdf，如果可以，我做错了什么？

更新：这个简单的例子只使用 Process.Start 也不起作用。它只是在 Azure 上运行时挂起，但在其他服务器上运行良好。

```
string exePath = System.Web.HttpContext.Current.Server.MapPath("\\App_Data\\PdfGenerator\\wkhtmltopdf.exe");
string htmlPath = System.Web.HttpContext.Current.Server.MapPath("\\App_Data\\PdfGenerator\\Test.html");
string pdfPath = System.Web.HttpContext.Current.Server.MapPath("\\App_Data\\PdfGenerator\\Test.pdf");
StringBuilder error = new StringBuilder();
using (var process = new Process())
{
    using (Stream fs = new FileStream(pdfPath, FileMode.Create))
    {
        process.StartInfo.FileName = exePath;
        process.StartInfo.Arguments = string.Format("{0} -", htmlPath);
        process.StartInfo.RedirectStandardOutput = true;
        process.StartInfo.RedirectStandardError = true;
        process.StartInfo.UseShellExecute = false;
        process.Start();
        while (!process.HasExited)
        {
            process.StandardOutput.BaseStream.CopyTo(fs);
        }
        process.WaitForExit();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-22T04:47:12.147

查看这个关于类似问题的 SO question。这家伙似乎已经得到了它的工作。RotativaPDF 建立在 wkhtmltopdf 之上，因此建立了连接。我正在我们的 Azure 网站上亲自尝试 - 我将在不久的将来发布我的结果。

[用于 ASP.NET MVC3 的 Azure 和 Rotativa PDF 打印](https://stackoverflow.com/questions/10940431/azure-and-rotativa-pdf-print-for-asp-net-mvc3)

# javascript - 有没有办法构建一个包含来自包位置的单个文件的 Dojo 模块？

> ID：14420664
> 
> 赞同：6
> 
> 时间：2013-01-20T01:03:05.793
> 
> 标签：javascript, build, dojo

我有一个小型应用程序的以下构建配置文件：

```
var profile = (function(){

    var copyOnly = function(filename, mid){
        /* ..snip.. */
    };

    return {
        basePath: "../../src",
        releaseDir: "../dist",
        releaseName: "lib",
        action: "release",

        packages: [
        'dojo',
        'dijit',
        //'dojox',
        'amd',
        {
            name: 'lodash',
            location: 'lodash',
            trees: [
                [".", ".", /(\/\.)|(~$)|(vendor|test)/]
            ]
        },
        {
            name: 'd3',
            location: 'd3',
            main: 'd3.min',
            trees: [
                [".", ".", /(\/\.)|(~$)|(src|lib|test)/]
            ]
        },
        { name: 'app', location: 'app' }
    ],

        layers: {
            "dojo/dojo": {
                include: [ "dojo/dojo", "amd/d3","amd/gmaps",
                    "app/main", "app/run" ],
                customBase: true,
                boot: true
            }
        },

        resourceTags: {
            /* ..snip.. */
        }
    };
})(); 
```

问题是这样的：我只需要由 Dojo 构建系统处理的 lodash.min.js 文件。不幸的是，当您在配置文件中包含包定义时，构建系统会使用隐式值查看相关目录中的*所有文件。*`trees`您可以覆盖它（就像我在这里所做的那样）并添加一些忽略指令，但这很丑陋，并且会让您遗漏一些东西。我想做*的*是明确指出我有兴趣为我的构建过程处理哪些文件。

Dojo 允许您这样做吗？这方面的文档有点少，但如果你能帮我找到一个更清楚地解释这一点的资源，那就太好了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-25T12:11:35.840

至少从 1.9 开始，我相信这是可以做到的：

```
// ... snip ...
{
    name:'lodash',
    location:'lodash',
    trees:[],
    dirs:[],
    files:[
        ["lodash.min.js"]
    ]
}, 
```

这明确列出了文件，同时还压缩了隐式树和目录发现。

我在这里的信念是基于粗略的审查`util/build/discover.js`——但是当我阅读[文档](http://dojotoolkit.org/reference-guide/1.9/build/buildSystem.html#trees-dirs-and-files)文件时*，应该*只支持。

# actionscript-3 - 如何在 Flex 4 TextArea 组件中强制失效？

> ID：14420665
> 
> 赞同：1
> 
> 时间：2013-01-20T01:03:30.347
> 
> 标签：actionscript-3, apache-flex, flex4, flex4.6

我在移动应用程序中有一个 TextArea，我想对某个事件强制失效。到目前为止，我可以这样做：

```
myTextArea.width = myTextArea.width + 1; 
```

我知道它有效，因为文本区域正确更新。

我尝试使用以下方法“正确”地做到这一点：

```
testing.invalidateProperties();
testing.invalidateDisplayList();
testing.invalidateSize();
testing.validateNow();
parentGroup.invalidateProperties();
parentGroup.invalidateDisplayList();
parentGroup.invalidateSize();
parentGroup.validateNow(); 
```

以前的代码都不起作用。

TextArea 使用的是 StageTextAreaSkin。

**更新**
这似乎与设置宽度一样有效，但也是一种技巧，并且不与其余组件同步：

```
testing.skin.styleChanged("anything"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:43:17.113

我发现强制验证的唯一方法是调用 myTextArea.setStyle("anything_here") 或 myTextArea.skin.setStyle("anything_here")。注意，可能是皮肤的问题，是SDK的手机spark皮肤（不是我自己创作的）。更好的答案表示赞赏。

# php - 表中滚动条的 2 个问题

> ID：14420666
> 
> 赞同：1
> 
> 时间：2013-01-20T01:03:41.053
> 
> 标签：php, html, css

关于输出如下表的 2 个问题：

![在此处输入图像描述](../Images/894331b0eb50b583872d7bb97d31692f.png)

问题一：

表格高度为500px，但我不明白的是，它看起来像下面不属于表格的内容显示在表格中，因为滚动条向下移动，看起来像内容表格下方的行在表格中。所以我的问题是如何让滚动条仅在满足 500px 时才出现，而不是像现在这样立即显示？如何让内容（选择框、标题等）显示在表格下方，而不是像在屏幕截图中那样显示在表格中

问题2：

如何将滚动条夹在桌子的一侧？目前它被剪裁在最后一列的下方，这意味着它占用了最后一列的一些空间，因此表列不匹配。

下面是表格的html代码：

```
 <table id="tableqanda" align="center" cellpadding="0" cellspacing="0">
    <thead>
    <tr>
        <th width="30%" class="question">Question</th>
        <th width="8%" class="option">Option Type</th>
        <th width="6%" class="noofanswers">Number of Answers</th>
        <th width="8%" class="answer">Answer</th>
        <th width="6%" class="noofreplies">Number of Replies</th>
        <th width="6%" class="noofmarks">Number of Marks</th>
        <th width="12%" class="images">Images</th>
    </tr>
    </thead>
    </table>
    <div id="tableqanda_onthefly_container">
    <table id="tableqanda_onthefly" align="center" cellpadding="0" cellspacing="0">
    <tbody>
        <?php
          foreach ($arrQuestionContent as $key=>$question) {
        echo '<tr class="tableqandarow">'.PHP_EOL;
        echo '<td width="30%" class="question">'.htmlspecialchars($question).'</td>' . PHP_EOL;
        echo '<td width="8%" class="option">'.htmlspecialchars($arrOptionType[$key]).'</td>' . PHP_EOL;
        echo '<td width="6%" class="noofanswers">'.htmlspecialchars($arrNoofAnswers[$key]).'</td>' . PHP_EOL;
        echo '<td width="8%" class="answers">'.htmlspecialchars($arrAnswer[$key]).'</td>' . PHP_EOL;
        echo '<td width="6%" class="noofreplies">'.htmlspecialchars($arrReplyType[$key]).'</td>' . PHP_EOL; 
        echo '<td width="6%" class="noofmarks">'.htmlspecialchars($arrQuestionMarks[$key]).'</td>' . PHP_EOL; 
        echo '<td width="12%" class="images">'.htmlspecialchars($arrImageFile[$key]).'</td>' . PHP_EOL;
        echo '</tr>'.PHP_EOL;
        }
?>
    </tbody>
    </table>

    <h4>PARTICIPATING STUDENTS</h4>

    <p>
    <strong>Number of Participating Students:</strong> <?php echo $studentnum; ?>
    </p>

    <p>
    <strong>Current Participating Students:</strong>
    <br/>
    <tr>
    <td>
    <select name="students" id="studentslist" size="10">

    <?php
if($studentnum == 0){
    echo "<option disabled='disabled' class='red' value=''>No Students currently in this Assessment</option>"; 
}else{
    while ( $currentstudentstmt->fetch() ) {

    echo "<option disabled='disabled' value='$dbStudentId'>" . $dbStudentAlias . " - " . $dbStudentForename . " " . $dbStudentSurname . "</option>" . PHP_EOL;
}
    }
    ?>
    </select>
    </p> 
```

下面是CSS：

```
#tableqanda_onthefly_container
{
    width:100%;
    overflow-y: scroll;
    overflow-x: hidden;
    max-height:500px;
}

#tableqanda_onthefly
{
    width:100%;
    overflow:auto;
    clear:both;
}

#tableqanda, #tableqanda_onthefly{
    border:1px black solid;
    border-collapse:collapse;
    table-layout:fixed;
}       

#tableqanda{
    width:100%;
    margin-left:0;
    float:left;
}

#tableqanda td { 
    vertical-align: middle;
    border:1px black solid;
    border-collapse:collapse;
}

#tableqanda th{
    border:1px black solid;
    border-collapse:collapse;
    text-align:center;
} 
```

我希望我的表格保持为带有固定标题的滚动表格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:07:19.783

**更新**

对于问题 1，尝试将 overflow-y 属性设置为 auto。这样滚动条只会在表格高度超过 500px 时显示。

所以像：

`overflow-y:auto;`

代替

`overflow-y:scroll;`

**原帖：**

要回答您的第二个问题，您只需将表头添加为另一行：

```
<div id="tableqanda_onthefly_container">
<table id="tableqanda_onthefly" align="center" cellpadding="0" cellspacing="0">
<tr>
    <th width="30%" class="question">Question</th>
    <th width="8%" class="option">Option Type</th>
    <th width="6%" class="noofanswers">Number of Answers</th>
    <th width="8%" class="answer">Answer</th>
    <th width="6%" class="noofreplies">Number of Replies</th>
    <th width="6%" class="noofmarks">Number of Marks</th>
    <th width="12%" class="images">Images</th>
</tr>
    <?php
      foreach ($arrQuestionContent as $key=>$question) {
    echo '<tr class="tableqandarow">'.PHP_EOL;
    echo '<td width="30%" class="question">'.htmlspecialchars($question).'</td>' . PHP_EOL;
    echo '<td width="8%" class="option">'.htmlspecialchars($arrOptionType[$key]).'</td>' . PHP_EOL;
    echo '<td width="6%" class="noofanswers">'.htmlspecialchars($arrNoofAnswers[$key]).'</td>' . PHP_EOL;
    echo '<td width="8%" class="answers">'.htmlspecialchars($arrAnswer[$key]).'</td>' . PHP_EOL;
    echo '<td width="6%" class="noofreplies">'.htmlspecialchars($arrReplyType[$key]).'</td>' . PHP_EOL; 
    echo '<td width="6%" class="noofmarks">'.htmlspecialchars($arrQuestionMarks[$key]).'</td>' . PHP_EOL; 
    echo '<td width="12%" class="images">'.htmlspecialchars($arrImageFile[$key]).'</td>' . PHP_EOL;
    echo '</tr>'.PHP_EOL;
    }
    ?>
</table>
</div> 
```

这样滚动条应该放在最右边，而不是任何东西下面。它不是以前的原因是因为您有两个具有独立宽度的不同表格。

# jms - MQ JMS setClientReconnectOptions 没有按预期工作？

> ID：14420667
> 
> 赞同：3
> 
> 时间：2013-01-20T01:03:48.763
> 
> 标签：jms, ibm-mq, mq

我有一个简单的代码将 2 条消息放入队列中。
1）我用两台服务器设置了connectionNameList。
2）这两个服务器是独立的，但具有相同的队列管理器和定义相同名称的队列，例如“QMgr”和“TEST.IN”
3）我设置了setClientReconnectOptions（WMQConstants.WMQ_CLIENT_RECONNECT）；
  我希望当第一台服务器关闭时，它应该将消息发送到第二台服务器。

我做的测试：
a) 我发送第一条消息，sender.send(message); 有效。
b) 睡眠 30 秒。
在此期间，我关闭了第一台服务器
c) 然后睡眠完成，尝试发送第二条消息，但未能立即发送

此外，我尝试了更多，我为第二条消息尝试了{} catch{}，并且在 catch{} 中，我尝试了 sender.send(message)，它仍然失败。

知道为什么它与我的预期不同。我将非常感谢您的回复。

```
public static void main(String[] args) throws Exception
{
    MQQueueConnectionFactory cf = new MQQueueConnectionFactory();
    cf.setConnectionNameList("10.230.34.191(1418),10.230.34.169(1418)");

    cf.setQueueManager("QMgr");
    cf.setTransportType(WMQConstants.WMQ_CM_CLIENT);
    cf.setClientReconnectOptions(WMQConstants.WMQ_CLIENT_RECONNECT);
    cf.setClientReconnectTimeout(600);

    System.out.println("connect list " + cf.getConnectionNameList());

    MQQueueConnection connection = (MQQueueConnection) cf
            .createQueueConnection("mqm", "passwd");
    MQQueueSession session = (MQQueueSession) connection.createQueueSession(false,
            Session.AUTO_ACKNOWLEDGE);
    MQQueue queue = (MQQueue) session.createQueue("queue:///TEST.IN");
    MQQueueSender sender = (MQQueueSender) session.createSender(queue);

    long uniqueNumber = System.currentTimeMillis() % 1000;
    JMSTextMessage message = (JMSTextMessage) session.createTextMessage("SimplePTP "
            + uniqueNumber);

    // Start the connection
    connection.start();

    sender.send(message);
    System.out.println("Sent message:\\n" + message);

    System.out.println("sleep 30 seconds");
    Thread.sleep(30000);
    uniqueNumber = System.currentTimeMillis() % 1000;
    message = (JMSTextMessage) session.createTextMessage("SimplePTP " + uniqueNumber);
    sender.send(message);

    sender.close();
    session.close();
    connection.close();

    System.out.println("\\nSUCCESS\\n");
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T04:36:17.893

好吧，这是最简单的测试用例，应该可以工作。您是如何关闭第一个队列管理器的？你有没有`-r`选择。请记住，如果没有该选项，当队列管理器以命令`-r`结束时，客户端将不会重新连接。`endmqm`

```
endmqm -r <qm name> 
```

假设您使用`-r`了选项并且它仍然不起作用，那么我的建议是尝试以下方法：

设置异常侦听器以了解重新连接的情况。当连接断开并且重新连接尝试开始直到重新连接成功或失败时，将调用异常侦听器。异常侦听器示例代码将是这样的：

```
conn.setExceptionListener(new ExceptionListener() {

  public void onException(JMSException e) {
    System.out.print(e);
  }
}); 
```

# web-services - SoapUI中SOAP响应的解析和递归

> ID：14420676
> 
> 赞同：0
> 
> 时间：2013-01-20T01:05:09.037
> 
> 标签：web-services, soap, groovy, soapui

我有来自 SoapUI 中的 TestStep 的 SOAP 响应。我想解析响应中特定元素的每个值，并将其作为参数发送到对另一个 Web 服务的单独请求调用。

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<soapenv:Body>
    <searchResponse xmlns="urn:messages_2012_2.platform.webservices.technoplat.com">
        <platformCore:searchResult xmlns:platformCore="urn:core_2012_2.platform.webservices.technoplat.com">
            <platformCore:searchRowList>
                <platformCore:searchRow xsi:type="tranSales:TransactionSearchRow" xmlns:tranSales="urn:sales_2012_2.transactions.webservices.technoplat.com">
                    <tranSales:basic xmlns:platformCommon="urn:common_2012_2.platform.webservices.technoplat.com">
                        <platformCommon:tranId>
                            <platformCore:searchValue>17678</platformCore:searchValue>
                        </platformCommon:tranId>
                    </tranSales:basic>
                </platformCore:searchRow>
                <platformCore:searchRow xsi:type="tranSales:TransactionSearchRow" xmlns:tranSales="urn:sales_2012_2.transactions.webservices.technoplat.com">
                    <tranSales:basic xmlns:platformCommon="urn:common_2012_2.platform.webservices.technoplat.com">                    
                        <platformCommon:tranId>
                            <platformCore:searchValue>17705</platformCore:searchValue>
                        </platformCommon:tranId>                   
                    </tranSales:basic>
                </platformCore:searchRow>
                <platformCore:searchRow xsi:type="tranSales:TransactionSearchRow" xmlns:tranSales="urn:sales_2012_2.transactions.webservices.technoplat.com">
                    <tranSales:basic xmlns:platformCommon="urn:common_2012_2.platform.webservices.technoplat.com">
                        <platformCommon:tranId>
                            <platformCore:searchValue>17777</platformCore:searchValue>
                        </platformCommon:tranId>
                    </tranSales:basic>
                </platformCore:searchRow>          
            </platformCore:searchRowList>
        </platformCore:searchResult>
    </searchResponse>
</soapenv:Body> 
```

在上面的 SOAP 响应中，我想分别捕获值：17678、17705 和 17777，并将它们作为参数发送到另一个 SOAP Request TestStep。大多数人建议使用 groovy 脚本进行递归。

我的问题是： 1\. 从上面的 SOAP 响应中提取值并在 SoapUI 中迭代并创建单独的 SOAPRequest TestStep 的最佳方法是什么？2.假设每个值都是在 Groovy TestStep 中提取的，我如何将这些值提供给外部的“results.txt”类型的 csv（名称值对）文件。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T08:23:55.870

如果您使用的是soapUI Pro，最简单的方法是使用带有XML DataSource 的DataSource TestStep（参见[http://blog.smartbear.com/software-quality/bid/170520/How-to-Use-XML- DataSources-for-Response-Processing-in-soapUI](http://blog.smartbear.com/software-quality/bid/170520/How-to-Use-XML-DataSources-for-Response-Processing-in-soapUI)为例）。如果您使用的是免费版本，那么脚本是您的最佳选择！

祝你好运！

/奥莱

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T02:54:21.533

这是我以前使用的方式可能不是最好的。

1.  通过 XmlSluper 解析 XML。
    处理 XML 的方法有很多种（参见： http: [//groovy.codehaus.org/Processing+XML](http://groovy.codehaus.org/Processing+XML)）

2.  使用 XmlParser 和 CSVWriter (opencsv) 将 XML 转换为 CSV 我从这里看到了很好的例子：[http ://blog.ktronline.com/2011/12/creating-csv-file-from-xml-using-groovy.html](http://blog.ktronline.com/2011/12/creating-csv-file-from-xml-using-groovy.html)

# mysql - 我应该索引哈希吗？

> ID：14420678
> 
> 赞同：0
> 
> 时间：2013-01-20T01:05:29.103
> 
> 标签：mysql, database-design, indexing

在我的数据库中，我有一个哈希和大小字段。当我想搜索这个表时，我总是有一个大小和哈希值来比较。我应该索引哪一列？我认为哈希是一个 blob，所以即使我知道它们将是 X 位宽（我没有选择，但我想我会使用 SHA256），这个数据类型可能不是很好检查

我应该索引哈希列还是大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T01:18:58.030

散列可能不应该存储在 BLOB 列中——它的大小已知很小，您可能想要搜索它。将其存储在 BINARY 列中，或者甚至仅将其存储在十六进制格式的 VARCHAR 中，会更合适。

一旦你解决了这个问题，回答这个问题就很简单了：你会根据大小或散列对行进行排序或搜索吗？如果是其中任何一种情况，则应为该列编制索引。否则，没有必要。

# ms-access - 如何避免从 vb6 访问中的重复条目？

> ID：14420680
> 
> 赞同：0
> 
> 时间：2013-01-20T01:05:30.110
> 
> 标签：ms-access, vb6, primary-key, duplicate-removal

我正在使用 Vb6 和 Access 2007。我正在将记录添加到来自 vb6 的访问表名称“主题代码”。主题代码表的详细信息如下。

Subjectcode 表：标题（Degree,Branch,Year1,Year2,Semester,Subjectcode,Subjectname,Theory_Practical, Major_Allied_Elective）值（Bsc,computerscience,2001,2004,1,RACS1,Vb6 programming,Theory,Major）

注意：上表中的主键是 Degree,Branch,Year1,Year2,Semester,Subjectcode 我用来从 vb6 向访问表添加条目的代码如下：

```
 If degree = "" Or branch1 = "" Or year1 = "" Or year2 = "" Or semester = "" Or subcode.Text = "" Or subname.Text = "" Or theory.Text = "" Or major.Text = "" Then
    MsgBox "Fields can't be empty ! All are mandatory!"
    Else
    rs.Open "select * from subjectcode", con, 1, 3
    rs.AddNew
    rs!degree = degree
    rs!branch = branch1
    rs!year1 = year1
    rs!year2 = year2
    rs!semester = semester
    rs!Subjectcode = subcode.Text
    rs!Subjectname = subname.Text
    rs!Theory_Practical = theory.Text
    rs!Major_Allied_Elective = major.Text
    rs.Update
    MsgBox "Successfully Saved !", vbOKOnly + vbInformation, "info"
    rs.Close
    End If 
```

而vb6的那个添加形式的截图在这里：[http://tinypic.com/r/w7c7if/6](http://tinypic.com/r/w7c7if/6) 不存在相同条目时添加记录。如果记录已经存在，它应该说“记录已经存在”，我不知道该怎么做。请各位大神给个思路。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T04:40:58.357

编写一个 save 方法来保存您的记录，以及一个在保存数据之前查询数据库并检查现有记录的方法。

```
Public Sub SaveSubjectCode(ByVal vDegree As String, ByVal vBranch As String, ByVal vYear1 As Integer, ByVal vYear2 As Integer, ByVal vSemester As Integer, ByVal Subjectcode...)

    If (DoesRecordExist(vDegree, vBranch, vYear1, vYear2, vSemester, vSubjectcode) = True Then
        ' Warn the user
        MessageBox("I'm sorry Dave I can't do that. The record already exists.")
    Else
        ' Save the record
    End If

End Sub

Private Function DoesRecordExist(ByVal vDegree as String, ByVal vBranch As String, ByVal vYear1 As Integer, ByVal vYear2 As Long, ByVal vSemester As Integer, ByVal vSubjectcode As String) As Boolean

    RecordSet = query 'Query the database for the existing record
    If RecordSet.BOF And RecordSet.EOF Then
        DoesRecordExist = False
    Else
        DoesRecordExist = True
    End If

End Function 
```

此外，您希望避免选择每条记录的 Select * 查询，除非您真的需要它，因为它可能很慢，并且随着记录数量的增长而变慢。如果你想获取一个记录集来添加一条新记录，你可以包含一个不返回任何记录的 Where 子句`"select * from subjectcode WHERE 1 = 2, con, adOpenKeyset, adLockOptimistic`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T05:14:26.960

在表中创建字段时，您指定是否允许重复。然后有问题的添加或更新会引发异常。

SQL DML 如下所示：

```
ALTER TABLE tblCustomers
    ADD CONSTRAINT CustomerNames UNIQUE
    ([Last Name], [First Name]) 
```

还有其他强大的功能，例如检查约束：

```
ALTER TABLE tblInvoices
    ADD CONSTRAINT CheckAmount
    CHECK (Amount > 0) 
```

约束的一个优点是您的数据库的完整性不会被可能无法进行冗长的资格预审查询（或无法正确实现它们）的流氓应用程序作为人质。另一个是对聊天技术的性能改进以及当有多个更新程序时数据库可以在预限定查询和更新之间更改的事实。

# php - OOP 设计 - 性能与松散耦合

> ID：14420682
> 
> 赞同：1
> 
> 时间：2013-01-20T01:06:18.413
> 
> 标签：php, performance

我希望尽可能地改进我的 OOP 代码设计，但我被困在这个问题上。

例如，我想在社交网站中获取用户所有朋友的个人资料。所以我有桌子`Friendships`和`Profiles`. 我有课`Friends`和`Profile`.

让我们`Friends`成为处理用户友谊的类，并`Friends::getFriendsProfiles()`成为获取和返回所有用户朋友的个人资料的函数。

所以在我的函数`Friends::getFriendsProfiles()`中，我可以做一个

1.  表连接（例如`SELECT * FROM Friends LEFT JOIN Profiles ON Friends.user2 = Profile.userId WHERE Friends.user1 = :userid`），或

2.  `Profile`我可以只获取朋友的用户 ID，为每个朋友 ID创建一个对象，然后调用`$profile->getProfile($friendid)`运行查询 ( `SELECT * FROM Profiles WHERE userId = $friendid`) 来获取朋友的个人资料。然后返回所有好友`Profile`对象的集合。

**选项 1 缺点：**我的友谊班知道个人资料。当我需要更改配置文件的返回方式时（例如，我想为每个配置文件对象添加另一个属性），我需要在 2 个不同的地方进行更改。

**选项 2 缺点：**不是进行 1 次查询（我认为应该在 O(1) 中运行？），现在是 O(n)，其中 n 是用户朋友的数量。

但是选项 2 更加简洁和松散耦合。我应该采取哪个选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T02:09:03.720

我肯定会选择选项 1，并且只使用 1 个查询。该类`Friends`必须不太了解`Profiles`构造函数是否可以使用数组。您可以执行以下操作：

```
SELECT Profiles.*
FROM Friends
LEFT JOIN Profiles ON Friends.user2 = Profile.userId
WHERE Friends.user1 = :userid 
```

然后在循环中：

```
$profiles = array()
while ($data = mysqli_fetch_assoc($result)){
    $profiles[] = new Profile($data);
} 
```

一个可能更清洁的解决方案是将其作为`Profile`类的方法。

```
Profile::getFriendsProfiles() 
```

循环：

```
$profiles = array()
while ($data = mysqli_fetch_assoc($result)){
    $profiles[] = new self($data);
} 
```

的构造函数`Profile`可以是：

```
function __constructor(array $data = null)
{
    if (null !== $data) {
        // fill properties
        $this->id_profile = $data['id_profile']; // example
        ...
    }
} 
```

如果 SQL 代码在另一个对象中会更好`Table Data Gateway`。如果您真的不想改进您的 OOP，那么请阅读软件设计模式。您可以从 Martin Fowlers 的网站[开始](http://martinfowler.com/eaaCatalog/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T02:07:25.170

> 选项 1 缺点：我的友谊班知道个人资料。当我需要更改配置文件的返回方式时（例如，我想为每个配置文件对象添加另一个属性），我需要在 2 个不同的地方进行更改。

领域对象自然会有一些耦合。这只是您正在建模的系统的现实。这与其说是友谊和个人资料之间的耦合问题，不如说是业务层和数据层之间的紧密耦合问题。如果您有一个数据映射器、查找器类等并且使您的业务对象持久性无知，那么像这样的更改应该不会太重要。

如果您使用第二个选项，您会遇到[n+1 选择问题](https://stackoverflow.com/q/97197/1914530)。在这种情况下，当有更重要的领域可以考虑解耦时，我不会牺牲性能。

# iphone - 在 Safari 中打开 UIWebView URL

> ID：14420686
> 
> 赞同：1
> 
> 时间：2013-01-20T01:06:49.813
> 
> 标签：iphone, xcode, uiwebview

所以我在设置它时遇到了一些困难。我正在使用这个：[UIWebView open links in Safari](https://stackoverflow.com/questions/2899699/uiwebview-open-links-in-safari) for the code 但我似乎无法让它工作。

这是我的 .h 文件：

```
#import <UIKit/UIKit.h>

@interface SecondViewController : UIViewController
{

}

@property (strong, nonatomic) IBOutlet UIWebView *webView;

@end 
```

这是我的 .m 文件：

```
#import "SecondViewController.h"

@interface SecondViewController ()

@end

@implementation SecondViewController
@synthesize webView = _webView;

- (void)viewDidLoad
{
    [super viewDidLoad];

    [_webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http:m.youtube.com/user/haatfilms/uploads"]]];
    [_webView setBackgroundColor:[UIColor clearColor]];
    [_webView setOpaque:NO];
    _webView.scrollView.bounces = NO;
    _webView.scrollView.indicatorStyle = UIScrollViewIndicatorStyleWhite;
}

-(BOOL) webView:(UIWebView *)inWeb shouldStartLoadWithRequest:(NSURLRequest *)inRequest navigationType:(UIWebViewNavigationType)inType {
    if ( inType == UIWebViewNavigationTypeLinkClicked ) {
        [[UIApplication sharedApplication] openURL:[inRequest URL]];
        return NO;
    }

    return YES;
}

@end 
```

我想我已经连接了 UIWebView 委托：

![网络视图委托](../Images/b0b065ba2e8fc6d3ec60b692d112d209.png)

但是，当我单击一个链接时，它仍然会加载到 UIWebView 而不是 Safari 中。

任何人都可以阐明为什么它不起作用？太感谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:59:40.190

发现了问题。不要使用 IB 连接我的 webView 委托，只需执行以下操作：

```
[super viewDidLoad];

    webView.delegate = self; 
```

# android - 如何使用 broadcastReceiver onReceive() 将我的活动置于最前面？

> ID：14420689
> 
> 赞同：1
> 
> 时间：2013-01-20T01:06:57.130
> 
> 标签：android

所有这些都与我自己的应用程序有关。

我有两个案例。首先，我的活动是最重要的，一切正常。我的服务广播信息，我的活动更新它的 GUI。

我的问题是，如果我的活动还没有出现，我不知道如何把它带到最前面。理想情况下，它前面的所有活动都将关闭，并将这一活动带到最前面。我该怎么做呢？

```
broadcastReceiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            //what code do I put here to bring this activity to the front and close all other activities on top of it?
        }
    }; 
```

这是我在下面的帖子的帮助下解决问题的方法。

```
 Intent i = new Intent();
            i.setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP | Intent.FLAG_ACTIVITY_CLEAR_TOP);
            i.setClass(MyClass.this, MyClass.class);
            startActivity(i); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:57:30.543

First of all there isn't a direct command to bring an activity to front such as myActivity.bringToFront. Instead you will have to let android do it for you through the intents mechanism.

So if you want to bring an activity to front you will have to call startActivity and pass an intent with the correct flags. For example the flag [FLAG_ACTIVITY_CLEAR_TOP](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_CLEAR_TOP) will do your job. However there is a catch, you cannot set this flag if you use startActivity from within a broadcast receiver or a service. So in your case I think that you should use the flag [FLAG_ACTIVITY_NEW_TASK](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_TASK).

Here is an example:

```
Intent i = null;
i = new Intent(context, My_activity.class).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
context.startActivity(i); 
```

Hope this helps...

# ios - 在“BSViewController *”类型的对象上找不到属性“窗口”

> ID：14420693
> 
> 赞同：1
> 
> 时间：2013-01-20T01:07:18.050
> 
> 标签：ios, xcode

我正在尝试让 UIButton 显示图像并收到标题错误。

另外我想知道为什么`()`需要它，`BSViewController ()`因为它是由 XCode 创建的？

```
//
//  BSViewController.m

#import "BSViewController.h"

@interface BSViewController ()    // Why the "()"?
@end

@implementation BSViewController

- (IBAction) chooseImage:(id) sender{

    UIImageView* testCard = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"ipad 7D.JPG"]]; 
//Property 'window' not found on object of type 'BSViewController *'
    self.window.rootViewController = testCard;
    [self.window.rootViewController addSubview: testCard];
    testCard.center = self.window.rootViewController.center;

     NSLog(@"chooseImage");

}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end

//
//  BSViewController.h

#import <UIKit/UIKit.h>

@class BSViewController;
@interface BSViewController : UIViewController
<UIImagePickerControllerDelegate, UINavigationControllerDelegate>{
    IBOutlet UIButton* chooseImage;
}

- (IBAction) chooseImage:(id) sender;

@end 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-20T01:22:17.620

这一行：

```
 self.window.rootViewController = testCard; 
```

尝试将 imageView 对象指针分配给现有的 viewController 对象指针。你应该得到一个编译器警告。然后在下一行，您有效地尝试将其作为子视图添加到自身，这也可能会引发警告。

() 表示类的*类别扩展*。它是对您的公共接口的扩展，它允许您声明应为该类私有的实体。您应该将大部分界面放在这里，只需将需要公开的内容保留在 .h @interface 中。

您的 BSViewController 类没有调用属性，`window`因此您不能将其称为`self.window`. 但在正常情况下，您应该能够像这样获得对窗口的引用：

```
 UIWindow* window = [[UIApplication sharedApplication] keyWindow];
    [window.rootViewController.view addSubview: testCard]; 
```

但是，如果您只想将 testCard 放入您的 BSViewController 实例中，则不需要这样做。您只需要引用当前实例的视图：

```
 [self.view addSubview:testCard]; 
```

# php - 为什么我的菜单不是分层的？

> ID：14420696
> 
> 赞同：-2
> 
> 时间：2013-01-20T01:07:21.750
> 
> 标签：php, hierarchical

我想创建一个分层菜单。功能：

```
/*
* Table has 3 fields: `ID`, `PARENTID` and `NAME`
* `ID` is unique, `PARENTID` showing his parent node id.
* This function will go through it and build unordered list and call itself when needed to build subitems.
* $level argument used to define wich node's subitems to build. Default is 0 which is top level.
*/    
function showMenu($level = 0) {

$result = mysql_query("SELECT * FROM `menus` WHERE `submenu` = ".$level); 
echo "<ul>";
    while ($node = mysql_fetch_array($result)) { 
        echo "<li>".$node['name'];
        $hasChild = mysql_fetch_array(mysql_query("SELECT * FROM `menus` WHERE `submenu` = ".$node['id'])) != null;
        IF ($hasChild) {
            showMenu($node['id']);
        }
        echo "</li>";
    }
echo "</ul>";
} 
```

我在一个类似问题的stackoverflow上找到了。

我有一张桌子`menus`：

```
+----+----------------+---------+
| id | name           | submenu |
+----+----------------+---------+
|  1 | FIRST HEADER   |    NULL | 
|  2 | SECOND HEADER  |    NULL | 
|  3 | THIRD HEADER   |    NULL | 
|  4 | (fh) submenu 1 |       1 | 
|  5 | (fh) submenu 2 |       1 | 
|  6 | (fh) submenu 3 |       1 | 
|  7 | (sh) submenu 1 |       2 | 
|  8 | (sh) submenu 2 |       2 | 
|  9 | (th) submenu 1 |       3 | 
| 10 | item 1         |       4 | 
| 11 | item 2         |       4 | 
+----+----------------+---------+ 
```

我在脚本中使用了这个函数

```
showMenu(4); 
```

结果如下：

```
<ul><li>item 1</li><li>item 2</li></ul> 
```

如您所见，甚至没有关于层次结构的消息，只有源代码中的几个项目。我的代码可能有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:09:45.320

您只是专门要求子菜单编号`4`。

如果您只是`showMenu()`不带参数调用，它将显示整个菜单树。

# sql - 使用带有连接的占位符

> ID：14420698
> 
> 赞同：3
> 
> 时间：2013-01-20T01:07:29.597
> 
> 标签：sql, ruby-on-rails, ruby, join

我试图通过在连接上用我的参数替换来避免任何 SQL 注入漏洞。

```
Category.joins("LEFT OUTER JOIN incomes ON incomes.category_id = categories.id AND incomes.dept_id = ?", params[:Dept]) 
```

这会尝试执行带有问号的查询，而不是用它代替参数。这样做的正确方法是什么？

编辑：

查询需要返回：

```
SELECT categories.* 
FROM "categories" 
LEFT OUTER JOIN incomes 
ON incomes.category_id = categories.id AND incomes.dept_id = 86 
```

不是

```
SELECT categories.* 
FROM "categories" 
LEFT OUTER JOIN incomes 
ON incomes.category_id = categories.id 
WHERE incomes.dept_id = 86 
```

非常不同的结果！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T01:48:24.117

一种选择是使用[sanitize_sql_array](http://api.rubyonrails.org/classes/ActiveRecord/Sanitization/ClassMethods.html#method-i-sanitize_sql_array)方法。但是，它是一种受保护的方法，因此您可以在 Category 模型上执行以下操作：

```
class Category < ActiveRecord::Base
  def self.income_for_dept(dept)
    Category.joins(sanitize_sql_array(["LEFT OUTER JOIN incomes ON incomes.category_id = categories.id AND incomes.dept_id = ?", dept]))
  end
end 
```

然后你会这样称呼它：

```
Category.income_for_dept(params[:Dept]) 
```

如果需要，Ruby 提供了一些其他方法来获取该方法，而无需在 Category 中创建类方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-20T01:11:33.520

尝试

```
Category.joins(:incomes).where(:incomes => { :dept_id => params[:Dept] }) 
```

并查看[Rails 文档以了解连接表](http://guides.rubyonrails.org/active_record_querying.html#joining-tables)。

# matlab - 将 Matlab .mat 转换为 csv 并保留变量名

> ID：14420699
> 
> 赞同：4
> 
> 时间：2013-01-20T01:07:49.970
> 
> 标签：matlab, csv

我正在尝试将 .mat 文件转换为 csv，保留向量/变量名称。这是我正在处理的一个例子：

```
mymat =

       model_id: [2217x1 double]
    own_dummies: [2217x26 double]
             id: [2217x1 double]
        product: [2217x1 double]
          const: [2217x1 double]
            mpd: [2217x1 double]
            air: [2217x1 double]
            mpg: [2217x1 double]
          trend: [2217x1 double]
          space: [2217x1 double]
           hpwt: [2217x1 double]
        cdindex: [20x1 double]
           cdid: [2217x1 double]
         outshr: [2217x1 double]
         firmid: [2217x1 double]
          share: [2217x1 double]
          price: [2217x1 double] 
```

我试过使用`csvwrite('test.csv', mymat)`，但它给了我一个错误：

```
??? Undefined function or method 'real' for input arguments of type 'struct'.
Error in ==> dlmwrite at 192
                str = sprintf('%.*g%+.*gi',precn,real(m(i,j)),precn,imag(m(i,j)));\
Error in ==> csvwrite at 32
dlmwrite(filename, m, ',', r, c); 
```

我想问题是我用结构而不是矩阵来喂 csvwrite。我可以将结构变量转换为变量到矩阵，但是我会丢失变量名。

肯定有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T10:35:35.073

您将如何实际将结构映射到 csv？您不能将字段名的直接映射作为第一行的条目，因为矩阵具有不兼容的维度。所以这个例子你必须 1\. 为 own_dummies 引入几列 2\. 扩展 cdindex。

因此，您可以编写一个包装器以使矩阵本身兼容并将列自己写入文件中。沿着（未经测试的，概念的）线的东西

```
 function saveData(filename, data, type)

    % at first bring struct data to sensible format
    if strcmp(type)='my_mat_type'
        data.own_dummies2 = data.own_dummies[2,:]; % split into seperate columns
        %...
        data.own_dummies26 = data.own_dummies[26,:];
        data.own_dummies = data.own_dummies[1,:];
        data.cdindex = [data.cdindex -ones(1,2217-length(data.cdindex)]; % pad any missing values as -1
    end;

    FD = fopen(filename, 'w');

    %todo did it open?

    fields = fieldnames(data);
    nfields = length(fields);

    % create column name values
    columns = strcat(strcat(fields,',')); % creates string = col1,col2,...coln,
    columns = columns(1:length(columns)-1); %remove trailing comma

    CRNL = char([10 13]); % or so

    % print columns and newline
    fprintf(FD,strcat(columns,CRNL)); 

    dataout = cell2mat(struct2cell(data));

    % use your method to write the data to the file

    fclose(FD); 
```

自然，您也可以将各个字段拆分为单独的文件，其中字段名包含在文件名中，一般来说，这可能更简单。

# utf-8 - UTF-8 还是 windows-1252？

> ID：14420701
> 
> 赞同：-2
> 
> 时间：2013-01-20T01:07:59.580
> 
> 标签：utf-8, character-encoding

我在家里有 Windows XP - home ed，带有 SP3。无论如何，在大学里，他们有 Windows 7。所以，基本上当我保存我的文件并将它们带到这里时，事情就搞砸了。我正在写一个简短的简历。

我正在编写我的网站，所以我像往常一样使用标准字符集 utf-8。但是当我回到家并（在本地）验证我的网站时，我看到奇怪的字符出现了！三角形和里面的问号。所以，那我就像WTF？所以我决定上网看看哪个字符集更好。所以随机地，我掉到了 windows-1252 上。瞧，它奏效了！但是后来，我决定重新使用 charset utf-8 作为标准。我不想弄乱我的网站哈哈。

所以我基本上回到我的 html 文档中，只是注意到出现了非常奇怪的字符。所以我删除它们并用原来的撇号替换它们。最后，我检查了我的网站，并且撇号正确显示。

那么，到底是怎么回事？？？我应该继续使用 utf-8 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T04:38:42.600

听起来网页的内容实际上是由您使用的任何编辑器编码为 Windows-1252，但您正在手动编写一个`<meta>`标记为 UTF-8 的标签。这将解释您描述的行为。显式字符集声明必须与数据使用的实际编码相匹配。当您告诉编辑器保存文档时，请确保它以您期望的正确编码保存数据。一些编辑器确实支持多种编码，所以如果有多种编码可用，不要盲目地使用默认编码。

# c# - async/await - 出现错误“无法将类型 'void' 隐式转换为 'Windows.Foundation.IAsyncAction'”

> ID：14420709
> 
> 赞同：1
> 
> 时间：2013-01-20T01:09:16.693
> 
> 标签：c#, windows-8

我目前正在尝试了解 c#5 中的新关键字如何与示例一起使用。我想通过套接字连接发送消息并用监听器捕获答案。我真正卡住的地方是我不能等待一个方法，这里有一个例子：

```
 private async void SubmitMessage(string strMessage)
    {
        try
        {
            using (StreamSocket objSocket = new StreamSocket())
            {
                IAsyncAction objAction = await objSocket.ConnectAsync(new HostName(TargetHostname), TargetPortservice);
                objAction.Completed = delegate(IAsyncAction asyncAction, AsyncStatus asyncStatus)
                {
                    BindListener(objSocket.Information.LocalPort, objSocket, strMessage);
                };
            }
        }
        catch (Exception objException)
        {
            Debug.WriteLine(objException.Message);
            throw;
        }
    } 
```

有谁知道如何等待这个？如果我删除“等待”，则语法是正确的。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:30:05.023

当您使用 时`await`，您根本不必乱搞`IAsyncAction`，所以这样的事情应该可以工作：

```
private async Task SubmitMessage(string strMessage)
{
    try
    {
        using (StreamSocket objSocket = new StreamSocket())
        {
            await objSocket.ConnectAsync(new HostName(TargetHostname), TargetPortservice);
            BindListener(objSocket.Information.LocalPort, objSocket, strMessage);
        }
    }
    catch (Exception objException)
    {
        Debug.WriteLine(objException.Message);
        throw;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T01:18:05.330

对此不太了解，但这会吗？

```
IAsyncAction objAction = 
 objSocket.ConnectAsync(new HostName(TargetHostname), TargetPortservice);
await objAction;
//... 
```

# python - 如何使用 Jython 保存电子邮件图像附件

> ID：14420711
> 
> 赞同：1
> 
> 时间：2013-01-20T01:09:29.313
> 
> 标签：python, email, jython

我正在尝试使用 Jython 2.5.3 获取附加到电子邮件的图像。我收到了电子邮件（使用 Python imap 库的 Jython 版本）。我可以通过遍历部件来获取附件，使用 get_content_type() 找到正确的部件类型：

```
image, img_ext = None, None
for part in self.mail.get_payload():
    part_type, part_ext = part.get_content_type().split('/')
    part_type = part_type.lower().strip()
    part_ext = part_ext.lower().strip()
    if part_type == 'image':
        image =  part.get_payload(decode=True)
        img_ext = part_ext
 return image, img_ext 
```

'image' 作为一大块字节返回，在常规 Python 中，我会直接将其写入文件。但是，当我在 Jython 中尝试相同的操作时，出现以下错误：

```
TypeError: write(): 1st arg can't be coerced to java.nio.ByteBuffer[], java.nio.ByteBuffer 
```

让 Jython 将我的大数据块识别为字节数组的正确方法是什么？

PS：写代码使用tempfile.mkstmp()，默认写二进制...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:36:21.627

对于未来的读者，这就是我解决它的方法。在 tha 编写的代码中：

```
from org.python.core.util import StringUtil
from java.nio import ByteBuffer

tmp, filename = tempfile.mkstemp(suffix = "." + extension, text=True)
bytes = StringUtil().toBytes(attachment)
bb = ByteBuffer.wrap(bytes)
tmp.write(bb)
tmp.close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-11T21:02:47.520

这是我使用 gmail smtp 添加图像附件的代码

代码：

```
#!/usr/bin/env python
import smtplib
from email.MIMEMultipart import MIMEMultipart
from email.MIMEBase import MIMEBase
from email.MIMEText import MIMEText
from email.Utils import COMMASPACE, formatdate
from email import Encoders
import os

USERNAME = "___YOUR SMTP EMAIL HERE___"
PASSWORD = "__YOUR SMTP PASSWORD HERE___"

def sendMail(to, subject, text, files=[]):
    assert type(to)==list
    assert type(files)==list

    msg = MIMEMultipart()
    msg['From'] = USERNAME
    msg['To'] = COMMASPACE.join(to)
    msg['Date'] = formatdate(localtime=True)
    msg['Subject'] = subject

    msg.attach( MIMEText(text) )

    for file in files:
        part = MIMEBase('application', "octet-stream")
        part.set_payload( open(file,"rb").read() )
        Encoders.encode_base64(part)
        part.add_header('Content-Disposition', 'attachment; filename="%s"'
                       % os.path.basename(file))
        msg.attach(part)

    server = smtplib.SMTP('smtp.gmail.com:587')
    server.ehlo_or_helo_if_needed()
    server.starttls()
    server.ehlo_or_helo_if_needed()
    server.login(USERNAME,PASSWORD)
    server.sendmail(USERNAME, to, msg.as_string())
    server.quit()

sendMail( ["___EMAIL TO RECEIVE THE MESSAGE__"],
        "Alarm notification",
        "Someone has entered the room, picture attached",
        ["/home/pi/webcam.jpg"] ) 
```

# haskell - 具有阶乘的haskell分段错误

> ID：14420712
> 
> 赞同：6
> 
> 时间：2013-01-20T01:09:29.050
> 
> 标签：haskell, segmentation-fault

```
GHCi, version 7.4.2: http://www.haskell.org/ghc/  :? for help
Loading package ghc-prim ... linking ... done.
Loading package integer-gmp ... linking ... done.
Loading package base ... linking ... done.
Prelude> let fac 0 = 1
Prelude> let fac n = product [1..n]
Prelude> fac 100000
Segmentation fault: 11 
```

有谁知道为什么会这样？

`fac 10000`作品

在 OS X 10.8.2 上运行

嗯，所以从文件加载：

```
fac :: Integer -> Integer
fac 0 = 1
fac n = product [1..n] 
```

运行。

同样有趣的是，使用

`fac :: Int -> Int`

返回. `0`_ `fac 100000`我本来预计（就像 JohnL 一样）会出现错误。

[这个网站](http://c2.com/cgi/wiki?SegmentationFault)提到：

*   更具体地说，SegmentationFault 是一种类型不安全的语言拼写为 DoesNotUnderstand 的一种方式。在像 Haskell 这样的类型安全的静态类型语言中，您不应该看到段错误。

它与 IO monad 有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:26:52.563

从快速测试来看，这似乎是由`product`不严格的事实引起的，并且是由 thunk 链引起的故障。

在前奏中，`product`被定义为：

```
product = foldl (*) 1 
```

如果在 ghci 中，则改为将其定义为：

```
> :m + Data.List
> let product = foldl' (*) 1
> let fac n = product [1..n] 
```

然后它应该工作。我怀疑当你指定类型签名时，也许一些优化正在启动，否则不存在......但还没有深入研究它。

顺便说一句，你不需要这`let fac 0 = 1`条线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T01:15:45.927

通过给它一个类型签名

`fac :: Integer -> Integer`

它会起作用的。我不完全明白为什么。

# java - 如何使用 iText 仅将没有所有者密码的用户密码添加到 PDF

> ID：14420715
> 
> 赞同：2
> 
> 时间：2013-01-20T01:10:02.543
> 
> 标签：java, pdf, itext

如何仅将用户密码添加到 pdf 文件而不使用 iText 添加所有者密码？据我所知，似乎只能通过添加用户密码和所有者密码来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T07:42:00.580

加密现有的 PDF 是这样完成的：

```
public void encryptPdf(String src, String dest) throws IOException, DocumentException {
    PdfReader reader = new PdfReader(src);
    PdfStamper stamper = new PdfStamper(reader, new FileOutputStream(dest));
    stamper.setEncryption(USER, OWNER,
    PdfWriter.ALLOW_PRINTING, PdfWriter.ENCRYPTION_AES_128 | PdfWriter.DO_NOT_ENCRYPT_METADATA);
    stamper.close();
    reader.close();
} 
```

见[http://itextpdf.com/examples/iia.php?id=219](http://itextpdf.com/examples/iia.php?id=219)

如果 OWNER 是`null`，那么将生成一个随机的所有者密码（没有人知道的密码）。也许这就是您的客户的意思。正如 mkl 已经解释的那样，拥有一个带有 USER 密码但没有 OWNER 密码的 PDF 是没有意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T05:18:49.180

以下代码是您需要添加所有者密码的代码。

```
 JRPdfExporter exporter = new JRPdfExporter();       
  exporter.setParameter(JRExporterParameter.JASPER_PRINT, jasperprintobj);
  exporter.setParameter(JRExporterParameter.OUTPUT_FILE,new File(fileName));
  exporter.setParameter(JRPdfExporterParameter.IS_ENCRYPTED, Boolean.TRUE);
  exporter.setParameter(JRPdfExporterParameter.IS_128_BIT_KEY, Boolean.TRUE);
  //exporter.setParameter(JRPdfExporterParameter.USER_PASSWORD, "jasper");
  exporter.setParameter(JRPdfExporterParameter.OWNER_PASSWORD, "reports");
  exporter.setParameter(
    JRPdfExporterParameter.PERMISSIONS, 
    new Integer(PdfWriter.ALLOW_COPY | PdfWriter.ALLOW_PRINTING)
    );
  exporter.exportReport(); // finally export as pdf 
```

在生成 pdf 的 java 中使用此代码。

# css - 更改跨度内的 div 的字体颜色？

> ID：14420716
> 
> 赞同：-1
> 
> 时间：2013-01-20T01:10:08.037
> 
> 标签：css

我有一个 jquery 菜单，这是 css 样式

```
ul.sdt_menu li span span.sdt_link,
ul.sdt_menu li span span.sdt_descr,
ul.sdt_menu li div.sdt_box a{
    margin-left:15px;
    text-transform:uppercase;
    text-shadow:1px 1px 1px #000;
    font-family:"arial black"; 
```

sdt 链接是菜单框，但是当悬停框下拉两个 div 时，sdt 描述是一张放大的图片，但 sdt 框 a 是我要设置样式的最后一个框

因为它的黑色在那里的任何文本都不显示，这些 arial 黑色也不影响它

我怎样才能只设计这个盒子，因为当我尝试这个时它不起作用

```
 ul.sdt_menu li div.sdt_box a{
font-family:"arial black";
color: yellow; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T02:02:57.487

You can't put a block level element inside of an in-line element.

# gmail - 根据命令刷新 OfflineIMAP

> ID：14420717
> 
> 赞同：3
> 
> 时间：2013-01-20T01:10:14.130
> 
> 标签：gmail, imap, mutt

我需要帮助编写脚本来按需更新离线IMAP。

它需要中断已经运行的offlineIMAP 实例，运行offlineIMAP 同步，然后每五分钟进行一次正常的同步更新。（自动刷新 = 5）

一种情况是我正在运行 mutt 和 offlineIMAP。我可以听到我的手机收到邮件，但我无法通过 mutt 回复，直到 offlineIMAP 运行同步。

离线IMAP - [http://offlineimap.org/](http://offlineimap.org/)

# ruby - 如何使用 Nokogiri 进行通配符搜索？

> ID：14420719
> 
> 赞同：3
> 
> 时间：2013-01-20T01:10:37.513
> 
> 标签：ruby, nokogiri

我试图摆脱`data-`文档中的所有属性。如果我的文件看起来像

```
<div id="person" data-name="John Smith" data-age="32" data-location="UK">...</div> 
```

我想剥离数据以离开

```
<div id="person">...</div> 
```

我已经尝试了很多组合，并且至少可以得到类似`data-name`的东西

```
doc.xpath('//@data-name') 
```

但有时，会有更多的`data-?`属性，我想避免手动添加它们。[这个 SO 答案很接近](https://stackoverflow.com/questions/11593489/can-you-search-html-attributes-using-wildcards-with-ruby-nokogiri)，但是当我尝试时它没有为我返回任何东西

```
doc.xpath("//*[@*[contains(., 'data-')]]") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:05:17.867

选择名称以 开头的所有属性`data-`：

```
//@*[starts-with(name(), 'data-')] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T01:16:17.207

您找到的答案嵌套得太深，请尝试以下方式：

`doc.xpath('//*[contains(., "data-")]')`

# c++ - C++ 等价于 java.nio.channels.Selector

> ID：14420731
> 
> 赞同：2
> 
> 时间：2013-01-20T01:13:15.490
> 
> 标签：c++, sockets

C++ 是否有等效于[java.nio.channels.Selector](http://docs.oracle.com/javase/1.4.2/docs/api/java/nio/channels/Selector.html) **或**一些替代机制？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T01:22:26.603

您可以使用 C\C++ 中的[选择（Linux）。](http://linux.die.net/man/2/select)

同样在[Win32](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740141%28v=vs.85%29.aspx)

它们几乎相同，手册页有一个示例，更多内容可以在网上找到。

# php - 通过 PHP 迭代从另一个 Mysql 表中自动填充一个 Mysql 表

> ID：14420732
> 
> 赞同：0
> 
> 时间：2013-01-20T01:13:21.923
> 
> 标签：php, mysql, database, database-design

对此的解释可能看起来有点冗长和复杂，但请多多包涵。本质上，我想要做的是从我的数据库中的另一个 mysql 表（B）填充一个 mysql 表（A），但为了这样做，我需要复制表（A）中的值，以便有足够的条目来容纳对于表 B 中的值。

现在举一个更具体的例子

表格的外观

### course_details 表

```
course_details_id | course_id | 年号 | 教师编号
+--------+-----------+------------+------ ------+
        1 1 待设置 36
        2 2 待设置 54
        3 3 待设置 78
        4 4 待设置 23

```

### 年表

```
year_semester_id | 年份 | 学期
+-----------------+-----+----------+
         1 2012 1
         2 2012 2
         3 2012 3
         4 2012 4
         5 2013 1
         6 2013 2
         7 2013 3
         8 2013 4

```

我希望桌子看起来如何

```
course_details_id | course_id | 年号 | 教师编号
-------------------+------------+---------+-------- ----+
         1 1 1 36
         2 1 2 36
         3 1 3 36
         4 1 4 36
         5 1 5 36
         6 1 6 58
         7 1 7 36
         8 1 8 47
         9 2 1 54
        10 2 2 54
        11 2 3 54
        12 2 4 67
        13 2 5 67
        14 2 6 54
        15 2 7 54
        16 2 8 54

```

代码的外观

```
<?php
require_once('open_db.php');
get_dbhandle();

$query_year = "SELECT * FROM year"; 
$result_year = mysql_query($query_year) or die(mysql_error());
$num_year_rows = mysql_num_rows($result_year);
$num_year_rows = ($num_year_rows - 1);

$query_yearid = "SELECT year_semester_id FROM year"; 
$result_yearid = mysql_query($query_yearid) or die(mysql_error());

$result_ccheck = mysql_query("SELECT course_id FROM courses");
while($row = mysql_fetch_array($result_ccheck))
    {
      $course_id = $row['course_id'];

       for($i = $num_year_rows; $i >= 0; $i--)
       {
        $query_cdetails = "INSERT INTO course_details (course_id) VALUES ('$course_id')";
        $result_cdetails = mysql_query($query_cdetails);

           while($row = mysql_fetch_array($result_yearid))
           {
             $year_semester_id = $row['year_semester_id'];
             $query = "INSERT INTO course_details(year_semester_id) SELECT year_semester_id FROM year";
             $result = mysql_query($query);
            }

        }      
    }
?> 
```

它的作用与我想要它做的事情：按照当前的设置，它正确地在 course_details 表中创建每个 course_id 的副本，以匹配存在于 years 表中的 year_semester_id 的数量，这是完美的。问题在于在 course_details 表的每个对应表槽中插入 year_semester_id。

也就是说，保证当 course_id =1 , year_semester_id=1, course_id=1, year_semester_id =2,....course_id=1, year_semester_id=8, course_id=2, year_semester_id=1, course_id=2, year_semester_id= 2......course_id=2，yearsemester_id=8，course_id=3，year_semester_id=1 等等......这就是问题所在。

回顾一下代码的工作原理，它计算 years 表中 year_semester_id 的数量，然后将该数字减去 1，即 course_id 当前在 course_details 表中的次数，并将其复制为该数字。这个总数（重复）加上原始 course_id 应该是 year_semester_ids 的总量。我现在想为存在的每个 course_id 插入每个 year_semester_id 并循环遍历，直到每个 course_id 都被计算在内。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T02:38:33.327

[这就是我所说的](http://sqlfiddle.com/#!2/ebcc3/1)检查代码，如果你理解有困难，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T02:25:15.067

在我看来，您尝试做的事情可以通过利用关系表轻松完成，而不会使数据库膨胀。在这种情况下，如果我对您的理解正确，这里的最终结果是您希望`course_details`将空列设置为`year`表中的每一行的所有行的重复项。

确实如此，您可以使用 JOIN 语句选择该数据：

```
SELECT `a`.`course_id` , `b`.`year_semester_id` as `year_id` , `a`.`teacher_id` FROM `course_details` `a` INNER JOIN `year` `b` 
```

这应该在 MySQL 结果集中返回您想要的数据。如果您想将该数据插入表中，只需确保该表具有正确的列，并将该`course_Details_id`字段设置为自动递增并执行以下操作：

```
INSERT INTO `tablename` ( `course_id` , `year_semester_id` , `year_id` ) VALUES (
    SELECT `a`.`course_details_id` , `a`.`course_id` , `b`.`year_semester_id` as `year_id` , `a`.`teacher_id` FROM `course_details` `a` INNER JOIN `year` `b`
) 
```

这应该将您需要的所有数据插入到新的 MySQL 表中，而无需 PHP 脚本。

# javascript - 主干视图不显示模型中的值

> ID：14420734
> 
> 赞同：0
> 
> 时间：2013-01-20T01:13:58.470
> 
> 标签：javascript, backbone.js

我正在编写一个非常简单的主干模型/视图显示。基本上有一个名为 shortDescription 的 json 字段，它应该显示为 . 但是，无论我在视图中设置什么值，我的代码都不会显示为空。

这是代码，我在哪里做错了？

html代码：

```
<div id="itemDetailContainer"></div>
<script type="text/template" id="itemDetailTemplate">
    < h3 > <% shortDescription %> < /h3>
</script> 
```

Javascript：

```
ItemModel = Backbone.Model.extend({
    initialize: function () {}
});

ItemDetailView = Backbone.View.extend({
    initialize: function () {
        this.$el = $("#itemDetailContainer");
        this.template = _.template($("#itemDetailTemplate").html());
        _.bindAll(this, "render");
        this.render();
    },
    render: function () {
        this.$el.html(this.template(this.model.toJSON()));
        return this;
    }
});

var it = new ItemModel({"shortDescription": "short"});
var v = new ItemDetailView({model: it}); 
```

[http://jsfiddle.net/Cpn3g/886/](http://jsfiddle.net/Cpn3g/886/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:20:07.890

我弄清楚了这个问题。我应该使用 <%= %> 而不是 <% %>。

语法错误:(

# asp.net - 没有数据时不显示新行按钮

> ID：14420736
> 
> 赞同：1
> 
> 时间：2013-01-20T01:14:09.203
> 
> 标签：asp.net

Aspx，Entity，在我的 gridView 上我为一个新按钮做了一个页脚。它显示何时有项目，但不显示数据何时为空。gridView 的 ShowFooter = True。不知道为什么它不会在空时显示，我可能还缺少另一个属性吗？我知道一种解决方法可以在数据库中放置一个虚拟行，但认为应该有更好的方法从 0 开始。如果您还有任何问题，请提问。

```
<asp:TemplateField HeaderText="New" >
        <FooterTemplate >
         <asp:Button ID="btnNew" CssClass="DDButton" runat="server" Text="New" CommandName="New" OnClick="new_item" />
        </FooterTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:23:09.970

没有数据时不显示页脚模板，仅显示[`EmptyDataTemplate`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.emptydatatemplate.aspx).

```
<EmptyDataTemplate>
    <asp:Button ID="btnNew" runat="server" 
        Text="New" CommandName="New"
        CssClass="DDButton"
        OnClick="new_item" />
</EmptyDataTemplate> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T01:23:34.590

.Net 4.0`ShowHeaderWhenEmpty`在 GridView 上添加了该属性，但不幸的是没有`ShowFooterWhenEmpty`。但是仍然存在`EmptyDataTemplate`：

```
<asp:GridView runat="server" ID="myGridView">
    <EmptyDataTemplate>
        <asp:Button ID="btnNew" CssClass="DDButton" runat="server" Text="New" CommandName="New" OnClick="new_item" />
    </EmptyDataTemplate>
</asp:GridView> 
```

因为这不会发生，所以`GridViewRow`我认为您的`RowCommand`事件不会触发，但无论如何您似乎都在以单独的方法处理按钮的单击。

参考：http `GridView.EmptyDataTemplate`: [//msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.emptydatatemplate.aspx](http://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.emptydatatemplate.aspx)

# syntax - 如何在 Fortran 中对数组使用归约？

> ID：14420740
> 
> 赞同：2
> 
> 时间：2013-01-20T01:14:39.720
> 
> 标签：syntax, parallel-processing, fortran, openmp, reduction

我刚开始学习openMP，我有以下...

```
 do 100 k=1,lines

    !$OMP PARALLEL DO PRIVATE(dotprod) REDUCTION(+:co(k),si(k))
     do 110,i=1,ION_COUNT
      dotprod=(rx(k)*x(i)+ry(k)*y(i)...)
      co(k)=co(k)+COS(dotprod)
      si(k)=si(k)+SIN(dotprod)
     110 continue
    !$OMP END PARALLEL DO 
```

我已经发现（我认为）如果我想正确添加它们，我需要减少 co(k) 和 si(k)，但据我所知，你不能有一个像在减免条款内。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:30:16.893

如果我理解正确，使用临时变量会起作用：

```
do 100 k=1,lines

co_tmp = 0.0
si_tmp = 0.0
!$OMP PARALLEL DO PRIVATE(dotprod) REDUCTION(+:co_tmp,si_tmp)
 do 110,i=1,ION_COUNT
  dotprod=(rx(k)*x(i)+ry(k)*y(i)...)
  co_tmp=co_tmp+COS(dotprod)
  si_tmp=si_tmp+SIN(dotprod)
 110 continue
!$OMP END PARALLEL DO

co(k) = co_tmp
si(k) = si_tmp

100 continue 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T09:02:12.560

您也可以使用`associate`块 (F2003) 或`pointers`(F90) 来避免临时变量。在任何情况下，我都会使用`end do`，因为我看到您使用的是自由格式源，所以您有 F90。

```
do k=1,lines
  c => co(k)
  s => si(k)  !use associate in Fortran 2003 here

  !$OMP PARALLEL DO PRIVATE(dotprod) REDUCTION(+:c,s)
  do i=1,ION_COUNT
    dotprod = (rx(k)*x(i) + ry(k)*y(i) ...)
    c = c + COS(dotprod)
    s = s + SIN(dotprod)
  end do
  !$OMP END PARALLEL DO
end do 
```

还要考虑将线程的创建移出循环。

# javascript - 如何重写功能以一键单击执行重置和停止

> ID：14420746
> 
> 赞同：0
> 
> 时间：2013-01-20T01:15:39.673
> 
> 标签：javascript

我尝试了许多排列，但无法在一个有效的排列上发生......

这是一个学习/演示页面的简短脚本，它已准备好在您的本地主机上运行，​​任何人都想看到它行为不端。双击停止按钮使其工作，但似乎必须有一种方法来停止循环和重置，只需单击一下。

我只学了几个星期的 JavaScript，所以如果问题是我遗漏的简单问题，我不会感到惊讶。这是令人反感的代码:)

```

        我的循环

        // 在窗口加载时，最好有一些 .className  
        // 在需要它们的 DIV 元素上设置，因此它们会显示出来。
        var ScaryMonster = window.onload=function portofOrigin(){
        Div1ne.className = "AsBeforeBubba";
        Div2wo.className = "AsBeforeBubba";
        Div3hree.className = "AsBeforeBubba";
        Div4our.className = "AsBeforeBubba";
        Div5iver.className = "AsBeforeBubba";
        };
        // 然后继续定义 DIVS 将要的函数的 shwack
        // 通过 LOOP 代码的操作来操作。
        // 函数：ItemBar1
        功能项目栏1颜色（）{
        timeoutIDxDiv1 = window.setTimeout(Div1neDOsomethingDoggoneIt, 160);
        }
        函数 Div1neDOsomethingDoggoneIt(){
            div1ne.className = "springME";
        Div2wo.className = "defaultBORED";
        Div3hree.className = "defaultBORED";
        Div4our.className = "defaultBORED";
        Div5iver.className = "defaultBORED";
        }
        // 函数：ItemBar2
        功能项目栏2颜色（）{
        timeoutIDxDiv2 = window.setTimeout(Div2woDOsomethingDoggoneIt, 320);
        }
        函数 Div2woDOsomethingDoggoneIt(){
        Div1ne.className = "defaultBORED";
            div2wo.className = "springME";
        Div3hree.className = "defaultBORED";
        Div4our.className = "defaultBORED";
        Div5iver.className = "defaultBORED";
        }
        // 函数：ItemBar3
            // 这里 Timer Function 是为 Loop 集合的 Item #3 定义的
        功能项目栏3颜色（）{
            // 如果被调用，它会在 480/800 毫秒时触发    
        timeoutIDxDiv3 = window.setTimeout(Div3hreeDOsomethingDoggoneIt, 480);
        }
            // 这是包含代码的函数  
            // 如果调用了 Item #3，将运行。
        函数 Div3hreeDOsomethingDoggoneIt(){
            // .defaultBORED 是 *non~lit~up* 的外观状态  
            //循环运行时的div。   
        Div1ne.className = "defaultBORED";
        Div2wo.className = "defaultBORED";
            // 而 .springME 是 *active* 显示外观  
            // 在“动画循环*”期间的 div
            div3hree.className = "springME";
        Div4our.className = "defaultBORED";
        Div5iver.className = "defaultBORED";
        }
        // 函数：ItemBar4
        功能项目栏4颜色（）{
        timeoutIDxDiv4 = window.setTimeout(Div4ourDOsomethingDoggoneIt, 640);
        }
        函数 Div4ourDOsomethingDoggoneIt(){
        Div1ne.className = "defaultBORED";
        Div2wo.className = "defaultBORED";
        Div3hree.className = "defaultBORED";
            Div4our.className = "springME";
        Div5iver.className = "defaultBORED";
        }
        // 函数：ItemBar5
        功能项目栏5COLOUR（）{
        timeoutIDxDiv5 = window.setTimeout(Div5iveDOsomethingDoggoneIt, 800);
        }
        函数 Div5iveDOsomethingDoggoneIt(){
        Div1ne.className = "defaultBORED";
        Div2wo.className = "defaultBORED";
        Div3hree.className = "defaultBORED";
        Div4our.className = "defaultBORED";
            Div5iver.className = "springME";
        }

        /* ****************************************** */
        // 这是主定时器循环的 BEGIN POINT 创建 faux~animation
        函数 SetThemUP(){

        // 这个函数在你希望的任何地方创建一个 TIMESTAMP
        // 放置一个，通过调用函数。
        函数只是时间戳（）{
            var OkayFIRE = +新日期（）；
           返回 OkayFIRE；
        }

        // 无论出于何种原因，它都可以作为很多函数的持有者
        函数wellrelaxCODEworkWITHmeHere(){

        // 此 Function 集合中的第一项是 TimeStamp。  
        // 通过调用具有代码的函数获得。
        var newOkayFIRE = JustTIMEstamp();

        // 构建一个 friggin 所需的 4 个函数中的 1 个
。
        // 这是一个函数，在调用时会附加
        // 将 LB 作为目标 DIV 元素的子元素组装到 DOM。
        函数 SoWriteTimeStampToDivYello(){
            var myDiv1 = document.getElementById("Aaaiyeeah");
            var YellowTitleWrite = myDiv1.appendChild(document.createTextNode(newOkayFIRE));
            返回 YellowTitleWrite;
        }

        // 2 of 4\. 原文如此。它需要创建一个离散的 html 元素...  
        //上面提到的那个。
        函数 FancyShitForLBWIN1(){
            var compLbr="var inTheLinebreaks";
            var thirdcompOFintheLinebreaks = "=document.createElement('br');";
            var AssembledDocCreateLB=(compLbr+thirdcompOFintheLinebreaks);
            返回 AssembledDocCreateLB；
        }

        // 3 of 4\. 原文如此。令人惊讶的是，只能直接通过  
        // 在变量上插入换行符
        // 拼凑在一起以提供可回收的
构造...
        函数中间件（）{
            var myDiv33 = document.getElementById("Aaaiyeeah");
            var inTheLinebreaks7=document.createElement('br');
            myDiv33.appendChild(inTheLinebreaks7);
        }

        // 4 of 4 和资产的最终组件  
        // " 
reuseable" 只能部署在 DIV "Aaaiyeeah" 中
        // 但当然，需要多少次，所以至少它是有用的。
        函数 FancyShitForLBWIN2wo(){
            var theAppending1stPart="myDiv42.appendChild(";
            var varNameProper=("inTheLinebreaks");
            var fouthPart=");";
            var assembleAppenderHerself=(theAppending1stPart + varNameProper + fouthPart);
            返回 assembleAppender 自己；
        }

        // 哦，LookitThet，来了，被调用了。  
        // 所以，这是在包装函数内部，在 TIMER 循环内部。
        // 其效果是每次调用 LOOP 时，  
        // TIMESTAMP GO~Time 的记录被写入显示。
        SoWriteTimeStampToDivYello();
        FancyShitForLBWIN1();middleware();FancyShitForLBWIN2wo(); //越线

        // wellrelaxCODEworkWITHmeHere() 函数结束：
        }

        // 然后在这里一次性调用所有的 em：
        wellrelaxCODEworkWITHmeHere();

        // 这些是在 MainTimerLoop 外部定义的 5ive 函数的调用；步骤或组件，
        // 从中组装 LOOP。
        ItemBar1COLOUR();
        ItemBar2COLOUR();
        ItemBar3COLOUR();
        ItemBar4COLOUR();
        ItemBar5COLOUR();

        // 这里是对包含调用的函数的调用。
        // 通过设置数字，毫秒数  
        // 循环计时器的持续时间，已建立。
        // 所以
        // 为了有一个均匀的事件持续时间，事件有  
        // 被计时，他们自己，在他们的数量的比率
        // 以毫秒为单位的时间长度，循环将占用。
        开始烦恼 = window.setTimeout(SetThemUP,800);

        // SetThemUP() 结束 MAIN TIMER 循环 :: psuedo~animation
        }
        /* ********************** */
        /* ********************************* */

        // 这里开始 Gordon 建议的部分代码。
        // 虽然这是由 *Reset* 按钮调用以重置 div  
        // 到他们的 *Loop=OFF* 外观，并清除文本
        // 从一个接一个显示的 DIV 中，  
        // MAIN LOOP 的 PerLoop 迭代的 GoTime。
        功能毁灭怪物（）{
            停止（）;
            重置（）;
            FTWxAnotherReset(); // 这是一个笨拙的绝望~策略
                                    // 尝试删除不需要的 .class
                          // 这仍然适用，并重置所有  
                                // 5ive 到 NON~running 状态...外观。
        }

        // 这是 MainTimerLOOP 的 *** OFF SWITCH ***。
        函数停止（）{
            window.clearTimeout（开始烦恼）；
        }

        功能重置（）{
            var Aaaiyeeah = document.getElementById('Aaaiyeeah');
              而（Aaaiyeeah.firstChild）{
                Aaaiyeeah.removeChild(Aaaiyeeah.firstChild);
            }
            Div1ne.className = "AsBeforeBubba";
            Div2wo.className = "AsBeforeBubba";
            Div3hree.className = "AsBeforeBubba";
            Div4our.className = "AsBeforeBubba";
            Div5iver.className = "AsBeforeBubba";
        }

        函数 FTWxAnotherReset() {
            var Aaaiyeeah = document.getElementById('Aaaiyeeah');
              而（Aaaiyeeah.firstChild）{
                Aaaiyeeah.removeChild(Aaaiyeeah.firstChild);
            }
            Div1ne.className = "AsBeforeBubba";
            Div2wo.className = "AsBeforeBubba";
            Div3hree.className = "AsBeforeBubba";
            Div4our.className = "AsBeforeBubba";
            Div5iver.className = "AsBeforeBubba";
        }

        #标题鬼{
            位置：绝对；
            顶部：11px；
            左：295px；
            宽度：496px；
            高度：29px；
            背景颜色：#8ADFFB；
            字体大小：19px；
            字体粗细：粗体；
            字体样式：斜体；
            字体变体：小型大写字母；
            颜色：黑色;
            边框：3px 纯海军蓝；
            填充顶部：3px；
        }   
        #控制地点{
            位置：绝对；
            顶部：11px；
            左：19px；
            宽度：142px；
            高度：42px；
            背景颜色：#33EFEA；
            边框：2px 实心按钮面；
        }
        #ControlPlace 按钮{
            位置：绝对；
            顶部：6px；
            左：13px；
            宽度：112px；
            高度：29px；
            背景颜色：按钮面；
            font-family：bookman 旧式；
            字体大小：12px；
            字体粗细：粗体；
            颜色：海军蓝；
        }
                #ControlPlaceSTOPPA{
            位置：绝对；
            顶部：72px；
            左：19px；
            宽度：142px；
            高度：42px；
            背景颜色：#33EFEA；
            边框：2px 实心按钮面；
        }
        #ControlPlaceSTOPPA 按钮{
            位置：绝对；
            顶部：6px；
            左：13px；
            宽度：112px；
            高度：29px；
            背景颜色：按钮面；
            font-family：bookman 旧式；
            字体大小：12px；
            字体粗细：粗体；
            颜色：海军蓝；
        }
        #Aaaiyeeah{ /*显示每个循环Begin~Time的Unix TimeSTAMP*/
            位置：绝对；
            顶部：11px；
            左：819px；
            宽度：131px；
            高度：430px；
            背景颜色：#C79C96; /* Impious Colors = “失落的艺术” */
            颜色：#A48F04；/* 邪恶的颜色 = "GoldyGoldfish" */
            边框：2px纯黑色；
            溢出-y：滚动；
        }
        /* 主显示框 */
        #BeginLoopingLikeAMAdBastard{
        位置：绝对；
        顶部：137px；
        左：295px；
        宽度：492px；
        高度：298px；
        背景颜色：#333333;
        边框：5px 纯紫色；
        }
        /* 5 Divs 在主显示 */
        #Div1ne.defaultBORED{
            位置：绝对；
            顶部：12px；
            左：11px；
            宽度：112px；
            高度：29px；
        }
        #Div1ne.springME{
            位置：绝对；
            顶部：12px；
            左：11px；
            宽度：112px；
            高度：29px；
        }
        #Div2wo.defaultBORED{
            位置：绝对；
            顶部：61px；
            左：11px；
            宽度：112px；
            高度：29px；
        }
        #Div2wo.springME{
            位置：绝对；
            顶部：61px；
            左：11px；
            宽度：112px；
            高度：29px；
        }
        #Div3hree.defaultBORED{
            位置：绝对；
            顶部：110px；
            左：11px；
            宽度：112px；
            高度：29px；
        }
        #Div3hree.springME{
            位置：绝对；
            顶部：110px；
            左：11px；
            宽度：112px；
            高度：29px；
        }
        #Div4our.defaultBORED{
            位置：绝对；
            顶部：159px；
            左：11px；
            宽度：112px；
            高度：29px；
        }
        #Div4our.springME{
            位置：绝对；
            顶部：159px；
            左：11px；
            宽度：112px；
            高度：29px；
        }
        #Div5iver.defaultBORED{
            位置：绝对；
            顶部：208px；
            左：11px；
            宽度：112px；
            高度：29px；
        }
        #Div5iver.springME{
            位置：绝对；
            顶部：208px；
            左：11px；
            宽度：112px；
            高度：29px；
        }

        #Div1ne.AsBeforeBubba{
            位置：绝对；
            顶部：12px；
            左：11px；
            宽度：112px；
            高度：29px；
            背景颜色：#EEff78;
            边框：2px 实心#FC3B03;
        }
        #Div2wo.AsBeforeBubba{
            位置：绝对；
            顶部：61px；
            左：11px；
            宽度：112px；
            高度：29px；
            背景颜色：#EEff78;
            边框：2px 实心#FC3B03;
        }
        #Div3hree.AsBeforeBubba{
            位置：绝对；
            顶部：110px；
            左：11px；
            宽度：112px；
            高度：29px；
            背景颜色：#EEff78;
            边框：2px 实心#FC3B03;
        }
        #Div4our.AsBeforeBubba{
            位置：绝对；
            顶部：159px；
            左：11px；
            宽度：112px；
            高度：29px；
            背景颜色：#EEff78;
            边框：2px 实心#FC3B03;
        }
        #Div5iver.AsBeforeBubba{
            位置：绝对；
            顶部：208px；
            左：11px；
            宽度：112px；
            高度：29px；
            背景颜色：#EEff78;
            边框：2px 实心#FC3B03;
        }

        /* 定义一些 .classNames，用于控制一些 css 语句
         通过 JavaScript */
        #Div1ne.springME{
            背景颜色：森林绿；
            边框：4px 纯红色；
        }
        #Div2wo.springME{
            背景颜色：森林绿；
            边框：4px 纯红色；
        }
        #Div3hree.springME{
            背景颜色：森林绿；
            边框：4px 纯红色；
        }
        #Div4our.springME{
            背景颜色：森林绿；
            边框：4px 纯红色；
        }
        #Div5iver.springME{
            背景颜色：森林绿；
            边框：4px 纯红色；
        }

        #Div1ne.defaultBORED{
            背景颜色：#333333;
            边框：2px纯白色；
        }
        #Div2wo.defaultBORED{
            背景颜色：#333333;
            边框：2px纯白色；
        }
        #Div3hree.defaultBORED{
            背景颜色：#333333;
            边框：2px纯白色；
        }
        #Div4our.defaultBORED{
            背景颜色：#333333;
            边框：2px纯白色；
        }
        #Div5iver.defaultBORED{
            背景颜色：#333333;
            边框：2px纯白色；
        }

        开始！！！

        停止疯狂！

          这是 JavaScript。循环或至少假装到。

```

对于没有自己的堆栈但好奇的任何人，请参阅

哦……你是认真的吗？？？？

看看这是否有效......好吧，伙计们，你的功能有一个大洞。我只花了 45 分钟或一个小时手动格式化 450 行，然后想添加一个链接，然后得到臭名昭著和烦人的哎呀！ANTI~jsfiddle.net 胡说八道？普莱斯！SO 似乎远远高于该服务，服务于不同的目的......减轻或在内部合并类似的功能；只是不明白对它的偏见。我确实理解在 SO 的站点上拥有大量代码的愿望......但是当后端抱怨链接时，我可以很好地调整，不是吗？ *咆哮*

仍在解决问题...我不会接受必须单击两次，一次是停止动画/循环，一次是重置 5 个 div 的类名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:26:51.320

`setTimeout`在任何奇怪的比赛条件之外（由于

```
function DestroyTheMonster() {
    Stop();
}

function Takes2woToTaengo() {
    Stop();
    setTimeout("Reset()", 800); // this is the delay
}

function Stop() {
    window.clearTimeout(CommenceAnnoyance);
}

function Reset() {
    var div = document.getElementById('Aaaiyeeah');
      while (div.firstChild) {
        div.removeChild(div.firstChild);
    }
    Div1ne.className = "AsBeforeBubba";
    Div2wo.className = "AsBeforeBubba";
    Div3hree.className = "AsBeforeBubba";
    Div4our.className = "AsBeforeBubba";
    Div5iver.className = "AsBeforeBubba";
} 
```

# python-3.x - Gtk.Clipboard 的最小实现不起作用

> ID：14420748
> 
> 赞同：2
> 
> 时间：2013-01-20T01:15:48.800
> 
> 标签：python-3.x, clipboard, introspection, gtk3, pygobject

我试图让 Python3/GTK3 的剪贴板工作的最小实现。当且仅当我运行时它才会起作用`Gtk.main()`。我什至尝试过：

```
While Gtk.event_pending():
    Gtk.main_iteration() 
```

没有它的工作。

如果我使用它运行脚本，`Gtk.main()`它会按预期运行，允许我将文本粘贴到测试 GUI 编辑器中。此脚本将文本字符串`t`放入剪贴板。`Gtk.main()`当且仅当被调用时，字符串文本才会出现。如果它没有被调用，但是剪贴板缓冲区中的任何内容都将被清除，但为空。我真的很感激这方面的帮助。任何想法如何在不调用的情况下使其工作`Gtk.main()`？

```
#! /usr/bin/env python3
# -*- coding: utf-8 -*-

from gi.repository import Gtk
from gi.repository import Gdk
import signal

class Chars(Gtk.Window):
    def __init__(self):
        super().__init__()
        self.connect('destroy', Gtk.main_quit)
        self.show_all()
        self.cb = Gtk.Clipboard.get(Gdk.SELECTION_CLIPBOARD)
        t='Some text'
        self.cb.set_text(t, -1)
        while Gtk.events_pending():
            Gtk.main_iteration()

def main():
    chars = Chars()
    signal.signal(signal.SIGINT, signal.SIG_DFL)
    # Gtk.main() # works if this is uncommented

if __name__ == "__main__":
    main() 
```

问候，纳尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-22T16:29:49.850

您必须调用[`gtk_clipboard_store`](https://developer.gnome.org/gtk3/stable/gtk3-Clipboards.html#gtk-clipboard-store)以存储剪贴板内容以供其他程序使用。

剪贴板的工作方式是，当程序 B 想要剪贴板内容时，它必须从设置剪贴板数据的程序 A 中获取。程序 A 必须有一些回调才能将该剪贴板数据提供给程序 B。

这意味着当程序 A 结束时，程序 B 将无法调用程序 A 的回调。出于这个原因，Gtk 具有该`gtk_clipboard_store`功能。该函数确实将剪贴板“所有权”赋予程序 C，因此在程序 A 结束后，程序 A 设置的剪贴板数据仍然可用于程序 C 中的程序 B。

如果你使用`clipboard_set_data`函数族，Gtk 库会在 Gtk 主循环结束时处理这些问题。由于您不想启动 Gtk 主循环，因此您必须`gtk_clipboard_store`自己调用。

**TL;DR**最简单的剪贴板片段：

```
#!/usr/bin/python3
from gi.repository import Gtk, Gdk

clipboard = Gtk.Clipboard.get(Gdk.SELECTION_CLIPBOARD)
clipboard.set_text("Does a text of all texts contain itself?", -1)
clipboard.store() 
```

# c - execvp 导致内存问题

> ID：14420749
> 
> 赞同：1
> 
> 时间：2013-01-20T01:15:54.523
> 
> 标签：c, linux

在我的 C 程序中，我使用 execvp 命令来解析输入并运行它。我有这个：

```
char read_str[MAX_ALLOWED_BUFFER];
pid_t child_pid;
char *strs[100] = {NULL}; 

child_pid = fork();
if (child_pid == 0) {
    split(read_str, strs);
    execvp(strs[0], strs);
    printf("Failed\n");
}
else {
    waitpid(child_pid, NULL, 0);
    for (y = 0; y < 100; y++) free(strs[y]);
} 
```

和这个功能

```
void split(char *str, char **splitstr) {      
    char *p;      
    int i=0;      
    p = strtok(str," "); 
    while(p!= NULL) {        
        splitstr[i] = malloc(strlen(p) + 1);
        if (splitstr[i]) strcpy(splitstr[i], p);
        i++;
        p = strtok(NULL, " ");       
    } 
} 
```

第一个代码块处于 while 循环中并不断询问用户输入。无论如何，如果 execvp 返回，则发生错误并且打印失败，然后如果我再输入两个有效命令，则会出现内存损坏错误...

有谁看到我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T03:02:44.173

> 我在这里做错了什么

有几件事。

*   失败时`execvp`，孩子会转到 while 循环的开头，现在您拥有*孩子*和父母的阅读输入。你想要做的是`exit(1)`在打印之后`"Failed"`。
*   如果你这样做了，那么`strs`永远不会在父级中分配，也不需要是`free()`d。您可以将定义移动`strs`到 中`if (child_pid == 0) {`，而您永远不需要担心`free`任何事情。

这并不能解释您的内存损坏问题，如下所示：

*   失败`execvp`让孩子`C1`阅读输入。在其数组中`C1`有`malloc()`ed 条目。`strs`
*   现在`C1`得到输入，`fork()`s`C2`和`waitpid`s 。然后`C1`调用条目`free`，`strs`它们变得悬空（你应该`NULL`把它们拿出来）。
*   现在`C1`再次获取输入，`fork`s `C3`，`waitpid`s ，并再次调用*相同*`free`的条目，导致您观察到的双重和损坏。 *`strs``free`*

# php - PHP中的ISAAC密码

> ID：14420754
> 
> 赞同：-5
> 
> 时间：2013-01-20T01:16:36.617
> 
> 标签：php, encryption, random, stream-cipher

我需要在 PHP 中与使用[ISAAC 流密码](https://en.wikipedia.org/wiki/ISAAC_(cipher))的客户端进行通信。据我所知，PHP 可用的加密库都没有实现这个密码。如何在 PHP 应用程序中实现 ISAAC 密码？

（我找到了 ISAAC 的 Java 实现，并且几乎成功地将其移植到 PHP。唯一的问题是 PHP 中的无符号右移。我写了一个方法来做到这一点，但是当移位中的数字为消极的。）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-20T19:30:56.227

[ISAAC 密码](http://www.burtleburtle.net/bob/rand/isaacafa.html)相当简单，而且由于它是用 C 编写的，因此将其移植到 PHP 应该不会太难。唯一真正的复杂之处是 ISAAC 使用 32 位无符号整数进行环绕，而 PHP 的整数可能是 32 位或 64 位，并且在溢出时自动转换为浮点数。不过，这并不是什么大问题，因为我们可以通过在需要将中间值强制为 32 位的地方应用位掩码来轻松解决它。

无论如何，这是 ISAAC 参考代码到 PHP 的一个相当直接的端口：

> 截至 2017 年 9 月，此代码现在也[可以在 GitHub 上获得](https://github.com/vyznev/ISAAC-PHP)。

```
<?php
/*
------------------------------------------------------------------------------
ISAAC random number generator by Bob Jenkins.  PHP port by Ilmari Karonen.

Based on the randport.c and readable.c reference C implementations by Bob
Jenkins, with some inspiration taken from the Perl port by John L. Allen.

This code is released into the public domain.  Do whatever you want with it.

HISTORY:
 2013-01-20: Initial version.  (Typo in version date fixed on 2017-09-19.)
------------------------------------------------------------------------------
*/

class ISAAC {
    private $m, $a, $b, $c; // internal state
    public  $r;   // current chunk of results

    public function isaac()
    {
        $c = ++$this->c;     // c gets incremented once per 256 results
        $b = $this->b += $c; // then combined with b
        $a = $this->a;

        $m =& $this->m;
        $r = array();

        for ($i = 0; $i < 256; ++$i) {
            $x = $m[$i];
            switch ($i & 3) {
            case 0: $a ^= ($a << 13); break;
            case 1: $a ^= ($a >>  6) & 0x03ffffff; break;
            case 2: $a ^= ($a <<  2); break;
            case 3: $a ^= ($a >> 16) & 0x0000ffff; break;
            }
            $a += $m[$i ^ 128]; $a &= 0xffffffff;
            $m[$i] = $y = ($m[($x >>  2) & 255] + $a + $b) & 0xffffffff;
            $r[$i] = $b = ($m[($y >> 10) & 255] + $x) & 0xffffffff;
        }

        $this->a = $a;
        $this->b = $b;
        $this->c = $c;
        $this->r = $r;
    }

    public function rand()
    {
        if (empty($this->r)) $this->isaac();
        return array_pop($this->r);
    }

    private static function mix( &$a, &$b, &$c, &$d, &$e, &$f, &$g, &$h )
    {
        $a ^= ($b << 11);              $d += $a; $b += $c;
        $b ^= ($c >>  2) & 0x3fffffff; $e += $b; $c += $d;
        $c ^= ($d <<  8);              $f += $c; $d += $e;
        $d ^= ($e >> 16) & 0x0000ffff; $g += $d; $e += $f;
        $e ^= ($f << 10);              $h += $e; $f += $g;
        $f ^= ($g >>  4) & 0x0fffffff; $a += $f; $g += $h;
        $g ^= ($h <<  8);              $b += $g; $h += $a;
        $h ^= ($a >>  9) & 0x007fffff; $c += $h; $a += $b;
        // 64-bit PHP does something weird on integer overflow; avoid it
        $a &= 0xffffffff; $b &= 0xffffffff; $c &= 0xffffffff; $d &= 0xffffffff;
        $e &= 0xffffffff; $f &= 0xffffffff; $g &= 0xffffffff; $h &= 0xffffffff;
    }

    public function __construct ( $seed = null )
    {
        $this->a = $this->b = $this->c = 0;
        $this->m = array_fill(0, 256, 0);
        $m =& $this->m;

        $a = $b = $c = $d = $e = $f = $g = $h = 0x9e3779b9;  // golden ratio

        for ($i = 0; $i < 4; ++$i) {
            ISAAC::mix($a, $b, $c, $d, $e, $f, $g, $h);      // scramble it
        }

        if ( isset($seed) ) {
            if ( is_string($seed) ) {
                // emulate casting char* to int* on a little-endian CPU
                $seed = array_values(unpack("V256", pack("a1024", $seed)));
            }

            // initialize using the contents of $seed as the seed
            for ($i = 0; $i < 256; $i += 8) {
                $a += $seed[$i  ]; $b += $seed[$i+1];
                $c += $seed[$i+2]; $d += $seed[$i+3];
                $e += $seed[$i+4]; $f += $seed[$i+5];
                $g += $seed[$i+6]; $h += $seed[$i+7];
                ISAAC::mix($a, $b, $c, $d, $e, $f, $g, $h);
                $m[$i  ] = $a; $m[$i+1] = $b; $m[$i+2] = $c; $m[$i+3] = $d;
                $m[$i+4] = $e; $m[$i+5] = $f; $m[$i+6] = $g; $m[$i+7] = $h;
            }

            // do a second pass to make all of the seed affect all of $m
            for ($i = 0; $i < 256; $i += 8) {
                $a += $m[$i  ]; $b += $m[$i+1]; $c += $m[$i+2]; $d += $m[$i+3];
                $e += $m[$i+4]; $f += $m[$i+5]; $g += $m[$i+6]; $h += $m[$i+7];
                ISAAC::mix($a, $b, $c, $d, $e, $f, $g, $h);
                $m[$i  ] = $a; $m[$i+1] = $b; $m[$i+2] = $c; $m[$i+3] = $d;
                $m[$i+4] = $e; $m[$i+5] = $f; $m[$i+6] = $g; $m[$i+7] = $h;
            }
        }
        else {
            // fill in $m with messy stuff (does anyone really use this?)
            for ($i = 0; $i < 256; $i += 8) {
                ISAAC::mix($a, $b, $c, $d, $e, $f, $g, $h);
                $m[$i  ] = $a; $m[$i+1] = $b; $m[$i+2] = $c; $m[$i+3] = $d;
                $m[$i+4] = $e; $m[$i+5] = $f; $m[$i+6] = $g; $m[$i+7] = $h;
            }
        }

        // fill in the first set of results
        $this->isaac();
    }
} 
```

类`ISAAC`构造函数接受一个可选`$seed`参数，它应该是一个 256 元素的 32 位整数数组、一个最多 1024 字节的字符串（使用 ; 转换为数组`unpack()`）或`null`（默认值）。如果种子为 null 或省略，则使用较短的单遍初始化，对应于 C 参考实现中的调用`randinit()`with ；`flag == FALSE`否则，使用对应的两遍初始化`flag == TRUE`。

该类提供了一个`rand()`返回单个 32 位数字的方法，就像`rand()`在 Jenkins' 中定义的宏一样[`rand.h`](http://www.burtleburtle.net/bob/c/rand.h)。或者，我将核心`isaac()`方法及其内部结果缓冲区`$r`公开，以便那些更喜欢直接访问生成器的人可以调用`isaac()`自己并以这种方式获取输出。请注意，构造函数已经调用了`isaac()`一次，就像`randinit()`在参考实现中一样，因此您只需在用完前 256 个输出值后再次调用它。

* * *

这里有两个测试程序，第一个对应于包含在[rand.c](http://www.burtleburtle.net/bob/c/rand.c)中的测试代码：

```
<?php
require_once('isaac.php');

$seed = array_fill(0, 256, 0);
$isaac = new ISAAC ( $seed );

for ($i = 0; $i < 2; ++$i) {
    $isaac->isaac();  // XXX: the first output block is dropped!
    for ($j = 0; $j < 256; ++$j) {
        printf("%08x", $isaac->r[$j]);
        if (($j & 7) == 7) echo "\n";
    }
} 
```

以及来自[ISAAC 挑战](http://www.burtleburtle.net/bob/rand/isaacafa.html#challenge)的第二个 [randtest.c](http://www.burtleburtle.net/bob/c/randtest.c)：

```
<?php
require_once('isaac.php');

$seed = "This is <i>not</i> the right mytext.";
$isaac = new ISAAC ( $seed );

for ($j = 0; $j < 10 * 256; ++$j) {
    printf("%08x ", $isaac->rand());
    if (($j & 7) == 7) echo "\n";
} 
```

这些程序的输出应该分别匹配[randvect.txt](http://www.burtleburtle.net/bob/rand/randvect.txt)和[randseed.txt](http://www.burtleburtle.net/bob/rand/randseed.txt)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T11:22:38.750

AFAIK 在 PHP 中没有公开实现 ISAAC。它不是那么流行，因此您无法在 PHP 中找到它的现成实现。

你必须选择：

a) 阅读算法论文并尝试在 PHP 中实现它，并成为第一个这样做的人。

b) 使用一些代理，在 Java、Ruby 等中有一些公开的算法实现。您可以通过命令行等调用它们。

# unix - sort 和 uniq oneliner

> ID：14420758
> 
> 赞同：-1
> 
> 时间：2013-01-20T01:17:28.547
> 
> 标签：unix, awk, grep

在 unix 中给定文件名，是否有用于 sort 和 uniq 的 oneliner？我用谷歌搜索并找到了以下内容，但它没有排序，也不确定下面的命令在做什么..使用 awk 或任何其他 unix 工具有更好的方法吗？

```
cut -d, -f1 file | uniq | xargs -I{} grep -m 1 "{}" file 
```

在旁注中，是否有一个可以在 Windows 和 unix 中使用？这并不重要，只是检查..

```
C:\Users\Chola>sort -t "@" -k2,2 email-list.txt 
```

输入文本文件：-

```
436485
422636
429228
427041
433414
425810
422636
431526
428808 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T01:33:53.177

如果您的文件仅包含数字，则每行一个：

```
sort -n FILENAME | uniq 
```

或者

```
sort -u -n FILENAME 
```

（您可以添加`-u`到`sort`命令中，而不是在以下所有内容中通过管道`uniq`。）。

如果您只想提取文件的一列，然后对该列进行数字排序以删除重复项，您可以这样做：

```
cut -f7 FILENAME | sort -n | uniq 
```

`Cut`假定列之间有一个选项卡。如果您的文件是 CSV，您可以这样做：

```
cut -f7 -d, FILENAME | sort -n | uniq 
```

`,`但如果文件中的文本字段中有 （CSV 将用`"`'s 保护它），那将不起作用。

如果您想按列排序但只删除完全重复的行，那么您可以这样做：

```
sort -k7,7n FILENAME | uniq 
```

`sort`假定列由空格分隔。同样，如果你想用 分开`,`，你可以使用：

```
sort -k7,7n -t, FILENAME | uniq 
```

# random - 为什么编写一个真正的随机数生成器这么难？

> ID：14420763
> 
> 赞同：-2
> 
> 时间：2013-01-20T01:18:11.150
> 
> 标签：random, prng

我不明白为什么 PRNG 比真正的 RNG 更容易编程。一个典型的处理器不应该做一个简短的工作来产生一个真正的随机数吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T01:23:48.013

计算机是确定性机器，给定相同的输入，包括代码，它们将产生相同的结果。要获得真正的随机性，您需要从现实世界中引入一些随机的东西，例如时间或宇宙射线或其他您无法预测的东西。

# c# - 多个线程写入数组

> ID：14420764
> 
> 赞同：5
> 
> 时间：2013-01-20T01:18:42.867
> 
> 标签：c#, multithreading, thread-safety

所以它在 C# 中，基本上我将在一个数组中为每个线程存储一些数据。我需要锁定这个吗？例如：

```
int[] threads = new int[12]; 
```

每个线程将访问数组中的特定位置，例如，线程 1 将更新线程 [0]、线程 2 线程 [1] 等中的值。

想法是让控制台打印存储在数组中的值。

好吧，评论这么多。我想我会澄清我在做什么，希望我能学到更多。所以基本上它的要点是：

主线程启动12个独立线程，每个线程调用主线程中的一个函数从数据库中获取一堆记录。对该方法的访问被锁定，但它返回大约 100 条记录供线程自行处理。

当线程处理记录时，它会发出几个 Web 请求并插入到数据库中。一旦线程完成了它的一批记录的处理，它就会再次从主线程调用一个函数，并且该函数会启动一个新线程来代替最后一个正在完成的线程。

由于线程正在处理它们，我想在控制台中输出它们的进度。最初我锁定了每个控制台输出，因为如果同时调用相同的函数，每个输出的光标位置就会到处乱窜。所以我想我会有一个数组来存储每个值的计数，然后有一个函数把它全部打印出来。尽管我开始怀疑这是否真的与我目前所做的有什么不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T01:21:12.033

如果每个线程都在自己的索引处访问一个值，那么您应该没问题，因为您不必担心同时来自多个线程的访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T01:24:37.103

我相信如果每个线程只在数组的一个单独部分上工作，一切都会好起来的。如果您要共享数据（即在线程之间进行通信），那么您将需要某种内存屏障来避免内存模型问题。

我相信，如果您生成一堆线程，每个线程都填充自己的数组部分，然后等待所有这些线程完成使用`Thread.Join`，那么就屏障而言，这将足以保证您的安全。

[关于数组的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.array.aspx)说：

> 此类型的公共静态（在 Visual Basic 中为 Shared）成员是线程安全的。不保证任何实例成员都是线程安全的。
> 
> 此实现不为 Array 提供同步（线程安全）包装器；但是，基于 Array 的 .NET Framework 类使用 SyncRoot 属性提供它们自己的同步版本的集合。
> 
> 通过集合进行枚举本质上不是线程安全的过程。即使一个集合被同步，其他线程仍然可以修改该集合，这会导致枚举器抛出异常。为了保证枚举过程中的线程安全，您可以在整个枚举过程中锁定集合，也可以捕获其他线程更改导致的异常。

所以不，它们不是线程安全的。通常，当并发访问可能在内部失败时，集合被称为“非线程安全”，但由于每个线程将访问不同的位置，因此这里没有并发访问。

# iphone - 正在调试的应用程序未显示通知横幅？

> ID：14420766
> 
> 赞同：0
> 
> 时间：2013-01-20T01:18:52.707
> 
> 标签：iphone, ios, ipad, apple-push-notifications

有什么方法可以为正在 Xcode 上调试的应用程序显示通知横幅？

不为我工作。当我在 Xcode 上停止应用程序时，会显示通知横幅。如果正在调试应用程序，则不会显示通知横幅。

当我发送通知时，会触发**application:didReceiveRemoteNotification:**并在此方法的 userInfo 上收到通知，但通知横幅从未出现。

是的，我的设备配置为将此应用程序的通知显示为横幅。我已经双重证实了这一点。

有什么想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:39:59.857

仅当应用程序关闭/在后台时才会出现横幅。否则，`application:didReceiveRemoteNotification:`被调用。

# ios - Xcode 中的“主界面”实际上*做什么*？

> ID：14420768
> 
> 赞同：13
> 
> 时间：2013-01-20T01:19:04.780
> 
> 标签：ios, xcode, cocoa-touch

我正在将一些较旧的项目移至 Xcode 4.5，我对主界面项目下拉菜单的实际功能感到有些困惑。框架实际上对这个值做了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-20T01:21:08.387

如果您不使用 Storyboard，您可以在此处指定要在启动时加载的 Interface Builder 文件 (xib)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-10T15:38:23.050

如果您有一个基于故事板的项目，请注意。手动编辑 MAIN INTERFACE 字段是危险的。如果未找到情节提要，则认为您的意思是 NIB。将应用程序更改为基于 NIB 的项目。从下拉列表中选择故事板更安全。

```
BEFORE - i has a storyboard based project
UIMainStoryboardFile~ipad : Main_iPad
UIMainStoryboardFile      : Main_iPhone 
```

我将主接口字段中的名称错误地键入到 Main_iPhone1 我运行了该应用程序，它崩溃了，因为 Main_iPhone1.storyboard 不存在我将它改回 Main_iPhone 但即使经过大量清洁，项目也拒绝构建。

由于 plist 中的键也随着值而变化

```
AFTER
UIMainStoryboardFile : Main_iPad
NSMainNibFile          : Main_iPhone1  <<project changes to NIB based 
```

将 Main_iPhone1 改回 Main_iPhone 仅将其从 Main_iPhone1.xib 更改为 Main_iPhone.xib，它不存在并且还会崩溃。

# python - 为什么全球化布尔值不起作用但全球化字典

> ID：14420776
> 
> 赞同：4
> 
> 时间：2013-01-20T01:20:10.137
> 
> 标签：python, boolean, global-variables

这只是一个想知道为什么这不起作用的问题。我想出了一个更好的方法，但我不知道为什么以前它不起作用。

```
global mydict
mydict = {} 
```

这似乎工作正常，并使 mydict 字典全球化。我什至打印 mydict 并且它有效。但是，这样做：

```
global bool
bool = False 
```

似乎不起作用。如果尝试在我的代码中打印 bool，我会得到：

```
UnboundLocalError: local variable 'bool' referenced before assignment 
```

那么为什么它适用于字典而不是布尔值呢？

哦，另外，如果有人想知道我是如何找到更好的方法的，我初始化了一个类，并通过以下方式在类中使 bool 全局化： self.bool = False 哪个有效。我从这个问题中得到它：[使所有变量全局化](https://stackoverflow.com/questions/10775411/making-all-variables-global)

* * *

编辑：根据要求，我将发布必要的代码：

```
import chatbot
global mydict
mydict = {}
global haveamessage
haveamessage = False

class MyBot(chatbot.ChatBot):
    def __init__(self, username, password, site):
        chatbot.ChatBot.__init__(self,username,password,site)

    def on_message(self, c, e):
        print mydict
        print haveamessage

if __name__ == '__main__':
    bot = MyBot("MyUsername", "MyPassword", "MySite")
    bot.start() 
```

我会尝试解释这段代码。聊天机器人模块几乎是允许用户在 Wikia 上的 wiki 中创建机器人，Wikia 是一家允许创建任何人都可以编辑的 wiki 的公司。在 wiki 上有一个聊天扩展，用户可以在其中交谈。该脚本允许机器人加入聊天并执行命令。当有人在聊天中发布内容时，on_message() 会关闭。

所以这打印：

```
{}
Traceback (most recent call last):
  File "file.py", line 146, in <module>
    bot.start()
  File "/Library/Python/2.7/site-packages/chatbot.py", line 371, in start
    self.on_message(self.c, e)
  File "file.py", line 12, in on_message
    print haveamessage
UnboundLocalError: local variable 'haveamessage' referenced before assignment 
```

* * *

我想澄清一下，这不会对你们所有人产生错误的原因是因为您不在 Wikia 聊天中。on_message() 函数仅在有人在聊天中发布内容时运行。例如，我可能有：

```
def on_message(self, c, e):
    if e.text == 'hello': # e.text is what a user posts in the chat. e = event
        c.send('Hello!') # c.send simply sends back a message in the chat. c = connection 
```

因此，当有人在聊天 hello 中发帖时，Bot 会回复 Hello！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T01:42:00.477

您发布的代码不会产生您声称的错误。但是`global`，在函数之外使用关键字没有任何效果，因此它不会像您期望的那样工作也就不足为奇了。

我假设在您的真实代码中，您实际上是在尝试分配到`haveamessage`inside `on_message`。如果是这样，您需要`global`在该方法中声明。

基本上规则是：如果您尝试从函数中分配全局变量，则需要`global`在该函数中使用关键字。否则，您根本不需要`global`关键字。变量是否为布尔值没有区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T01:41:35.703

我相信您想要做的是定义全局变量，然后在您的函数中引用它们，以便您可以在本地使用它们：

```
import chatbot
mydict = {}
haveamessage = False

class MyBot(chatbot.ChatBot):
    def __init__(self, username, password, site):
        chatbot.ChatBot.__init__(self,username,password,site)

    def on_message(self, c, e):
        global mydict
        global haveamessage
        print mydict
        print haveamessage 
```

# macos - 安装高亮包时编译错误

> ID：14420784
> 
> 赞同：3
> 
> 时间：2013-01-20T01:21:41.820
> 
> 标签：macos, r

我在安装 highlight 时遇到问题（是的，我知道此软件包已从 CRAN 中删除 - 我尝试在[此处](http://cran.r-project.org/src/contrib/Archive/highlight/)安装最新版本）。我不确定问题是什么，但似乎 g++ 编译存在问题。

我得到的错误是

```
> install.packages("~/Downloads/highlight_0.3.2.tar.gz", repos = NULL, type = "source", lib="/Library/Frameworks/R.framework/Versions/2.15/Resources/library")
g++ -arch i386 -I/Library/Frameworks/R.framework/Resources/include -
...
i686-apple-darwin11-llvm-g++-4.2: No such file or directory
i686-apple-darwin11-llvm-g++-4.2: No such file or directory
i686-apple-darwin11-llvm-g++-4.2: No such file or directory
make: *** [highlight.so] Error 1
ERROR: compilation failed for package ‘highlight’ 
```

会话信息

```
> sessionInfo()

R version 2.15.2 Patched (2013-01-05 r61562)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8

attached base packages:
[1] tools     stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] parser_0.1      codetools_0.2-8 Rcpp_0.10.2 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T03:34:43.267

斯科特，我担心罗曼让他的一两个包裹有点腐烂。

我们仍然在 Rcpp* 系列中使用 highlight，所以当我最近在另一台机器上需要它时，我采用了仍然适合我的 SVN 版本——R-Forge 上的 highlight 存储库的 svn 修订版 355。您需要安装解析器并突出显示在 Linux 上适合我的构建。

Highlight 是孤立的，所以如果你想采用它......

# ios - 在后端服务中检索 facebook 数据

> ID：14420785
> 
> 赞同：0
> 
> 时间：2013-01-20T01:21:47.017
> 
> 标签：ios, facebook, authentication, service, backend

我目前正在开发一个应用程序（iOS 6），用户将使用他们的 Facebook 帐户登录。对此我有几个问题：

a) 由于应用程序要求用户访问某些数据的权限（例如：基本个人资料信息、朋友列表、访问墙上的帖子等），我假设基于其应用程序 ID 的应用程序将以某种方式进行身份验证以访问此信息只要用户不限制通过他们的 facebook 帐户访问。

b) 是否可以例如通过服务应用程序使用与移动应用程序相同的应用程序 ID 进行身份验证，从而能够从使用该应用程序进行身份验证的 facebook 用户那里收集数据？

我的问题的目的是，我想对使用 iphone 应用程序的用户进行一些分析，但我不希望该应用程序首先从 facebook 下载信息，然后将其传递给我的服务进行分析。

如果上述是可能的，任何人都可以指导我朝我需要做什么的方向前进吗？也许链接到描述此设置的教程，og 只需告诉我我正在寻找实现这一目标的正确 facebook 术语。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-08T00:35:13.737

有点晚了，您可能已经选择了一项服务。我一直在使用[Parse.com](https://www.parse.com/tutorials) （教程网站）。他们非常好。他们为许多平台提供 SDK 和示例代码，为其他平台提供 RESTful 服务。

他们最近被 FaceBook 收购，并且已经与 Facebook 的 SDK 建立了强大的链接。

# python - socket.recv(256) 怎么会返回 None？

> ID：14420787
> 
> 赞同：0
> 
> 时间：2013-01-20T01:22:03.203
> 
> 标签：python, sockets

拥有 2 个 python 程序，`host1.py`它们`host2.py` 同时运行并通过`socket`以下方式进行通信 -

`host1.py`拥有`reciveSock = socket(AF_INET,SOCK_DGRAM)`

并且`host2.py`有`sendSocket = socket(AF_INET,SOCK_DGRAM)`。

两个套接字都相互绑定。

在`host1.py`有 -

```
try:
    msgBacked = reciveSock.recv(256)
except:
    pass
if( msgBacked is None):
    print "isNone!" 
```

事实上，它打印出`isNone!`mean `msgBacked`is a `None` 。

所有发送的 from `host2.py`to`host1.py`都是一个类型`sendSocket.send("ACK")`，因此发送的字符串中有一个值传输到`host1.py`。

那么这怎么`msgBacked`可能`None`呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T01:33:18.493

很可能`receiveSock.recv`是[抛出超时异常](http://docs.python.org/2/library/socket.html#socket.socket.settimeout)，并且`msgBacked`之前设置为`None`. 尝试删除`try .. except`，看看会发生什么。

# jsf - jsf数据表为什么commandLink clientid在更新模型值阶段之前解析

> ID：14420788
> 
> 赞同：-1
> 
> 时间：2013-01-20T01:22:05.353
> 
> 标签：jsf, datatable, lifecycle

我有一个遍历列表的数据表，我们称之为 myList。我根据一些请求参数填充了这个 myList。在数据表里面有commandLinks。如果我在应用请求值阶段将一个虚拟条目放入 myList，我可以单击第一个 commandLink，它会正常工作（它在调用应用程序阶段执行，然后正确的条目在 myList 中）。如果我不这样做，或者我单击第二个或以后的 commandLink，则不会发生任何事情。所以我猜测命令按钮的clientId是在应用请求阶段解决的，即使它只在调用应用程序阶段使用，这会导致commandLinks损坏。

像这样的东西：

```
<h:selectManyCheckbox styleClass="hidden" 
                      value="#{cc.attrs.selectionList.selected}"
                      converter="#{cc.attrs.converter}" >
    <f:selectItems value="#{cc.attrs.selectionList.all}"
                   var="item" itemValue="#{item}" itemLabel="" />
</h:selectManyCheckbox>
<h:dataTable value="#{cc.attrs.selectionList.selectedTest}" var="item">
    <h:column>
        <h:commandLink value="deselect" action="#{cc.attrs.selectionList.deSelect(item)}">
            <f:ajax execute=":#{component.parent.parent.parent.clientId}"
                    render=":#{component.parent.parent.parent.clientId}" />
        </h:commandLink>
    </h:column>
</h:dataTable> 
```

和模型：

```
public List<E> getSelected()
{
    return myList;
}

public List<E> getSelectedTest()
{
    if(FacesContext.getCurrentInstance().getCurrentPhaseId().equals(PhaseId.RESTORE_VIEW) && getSelectedList().isEmpty())
    {
        return Collections.singletonList(myList.get(0));
    }
    else if(FacesContext.getCurrentInstance().getCurrentPhaseId().equals(PhaseId.APPLY_REQUEST_VALUES) && getSelectedList().isEmpty())
    {
        return Collections.nCopies(2, myList.get(0));
    }
    else if(FacesContext.getCurrentInstance().getCurrentPhaseId().equals(PhaseId.PROCESS_VALIDATIONS) && getSelectedList().isEmpty())
    {
        return Collections.nCopies(3, myList.get(0));
    }
    else if(FacesContext.getCurrentInstance().getCurrentPhaseId().equals(PhaseId.UPDATE_MODEL_VALUES) && getSelectedList().isEmpty())
    {
        return Collections.nCopies(4, myList.get(0));
    }

    return myList;
}

public void deSelect(E item)
{
    myList.remove(item);
} 
```

在此示例中，数据表的前两个 commandLink 有效。我的问题是为什么会出现这种行为，有没有办法不用虚拟条目填充 myList ？我不想使用任何（viewscoped）支持 bean 来存储数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:32:22.463

在应用请求值阶段，JSF 需要遍历模型以找到单击的命令链接。如果与显示带有命令链接的表的初始 HTTP 请求相比，在处理表单提交（回发）的 HTTP 请求期间模型更改不兼容，则 JSF 可能无法找到单击的命令链接，因此永远不要将所需的操作排队，或者表示“当前行”的对象与最终用户的意图不同。

如果您的 bean 是请求范围的，那么它应该以这样的方式编写，即它基于某些请求参数`selectedTest`在构造函数或方法中初始化。`@PostConstruct`至少，[您绝对不应该在 getters 中执行业务逻辑](https://stackoverflow.com/questions/2090033/why-jsf-calls-getters-multiple-times/2090062#2090062)。

您可以在命令链接中传递重建`selectedTest`as所需的参数。`<f:param>`

```
<h:commandLink ...>
    <f:param name="some" value="#{bean.some}" />
</h:commandLink> 
```

并准备模型如下：

```
@ManagedProperty
private String some;

@PostConstruct
public void init(){ 
    selectedTest = populateItBasedOn(some);
}

// Don't change standard getters/setters! 
```

### 也可以看看：

*   [未调用 commandButton/commandLink/ajax 操作/侦听器方法或未更新输入值](https://stackoverflow.com/questions/2118656/hcommandlink-hcommandbutton-is-not-being-invoked/2120183#2120183)- 第 4 点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T07:20:28.563

我设法通过将 selectManyCheckbox 本身绑定到我的 componentBindings HashMap 并将其用于 dataTable（在 selectManyCheckbox 上使用 immediate="true"）来解决问题：

```
<h:selectManyCheckbox immediate="true" styleClass="hidden" 
                      binding="#{componentBindings[cc.attrs.selectionList]}"
                      value="#{cc.attrs.selectionList.selected}"
                      converter="#{cc.attrs.converter}" >
    <f:selectItems value="#{cc.attrs.selectionList.all}" var="item"
                   itemValue="#{item}" itemLabel="" />
</h:selectManyCheckbox>

<h:dataTable value="#{componentBindings[cc.attrs.selectionList].value}" var="item">
    <h:column>
        <h:commandLink value="deselect" action="#{cc.attrs.selectionList.deSelect(item)}">
            <f:ajax execute=":#{component.parent.parent.parent.clientId}"
                    render=":#{component.parent.parent.parent.clientId}" />
        </h:commandLink>
    </h:column>
</h:dataTable> 
```

在 faces-config.xml 中：

```
<managed-bean>
    <description>Holder of all component bindings.</description>
    <managed-bean-name>componentBindings</managed-bean-name>
    <managed-bean-class>java.util.HashMap</managed-bean-class>
    <managed-bean-scope>request</managed-bean-scope>
</managed-bean> 
```

# google-visualization - 谷歌图表透明背景不起作用

> ID：14420795
> 
> 赞同：4
> 
> 时间：2013-01-20T01:23:33.017
> 
> 标签：google-visualization

我正在尝试使我用谷歌图表制作的一些图表的背景透明。它们在除 IE7 和 8 之外的所有应用中都能完美运行，我得到了白色背景。

我已经尝试了所有我能找到的颜色属性组合来改变它，但没有任何效果。

唯一需要尝试的是几个月前有人在这里为其他有同样问题的人提出的建议。他们的建议是...

对于透明背景，使用 chf=bg,s,FFFFFF00

但我不知道如何实现这个？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-23T06:37:39.200

> chf=bg,s,FFFFFF00

是旧[Google Image Charts](http://code.google.com/apis/ajax/playground/?type=visualization#image_chart)的代码。

这些代码仅适用于非 SVG 版本的图表。Google Image Charts 已被弃用（您可以从他们的[帮助页面](https://developers.google.com/chart/interactive/docs/gallery/genericimagechart)中看到），因此除非您想实现旧式图表，否则您将无法在新的、精美的交互式 SVG 图表上实现上述代码。

对于新的精美 SVG 图表，我很幸运

```
backgroundColor: "transparent" 
```

将其复制粘贴到 Google Playground 进行测试：

```
<!--
You are free to copy and use this sample in accordance with the terms of the
Apache license (http://www.apache.org/licenses/LICENSE-2.0.html)
--> 
```

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>
      Google Visualization API Sample
    </title>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load('visualization', '1', {packages: ['corechart']});
    </script>
    <script type="text/javascript">
      function drawVisualization() {
        // Create and populate the data table.
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Austria', 'Bulgaria', 'Denmark', 'Greece'],
          ['2003',  1336060,    400361,    1001582,   997974],
          ['2004',  1538156,    366849,    1119450,   941795],
          ['2005',  1576579,    440514,    993360,    930593],
          ['2006',  1600652,    434552,    1004163,   897127],
          ['2007',  1968113,    393032,    979198,    1080887],
          ['2008',  1901067,    517206,    916965,    1056036]
        ]);

        // Create and draw the visualization.
        new google.visualization.BarChart(document.getElementById('visualization')).
            draw(data,
                 {title:"Yearly Coffee Consumption by Country",
                  width:600, height:400,
                  vAxis: {title: "Year"},
                  hAxis: {title: "Cups"},
                  backgroundColor: "transparent"}
            );
      }

      google.setOnLoadCallback(drawVisualization);
    </script>
  </head>
  <body style="font-family: Arial;border: 0 none;" bgcolor="#E6E6FA">
    <div id="visualization" style="width: 600px; height: 400px;"></div>
  </body>
</html> 
```

这只是添加了两件事的标准条形图示例：

1.  bgcolor="#E6E6FA" 到 body 元素（将其设为蓝色，以便我们判断是否透明）
2.  backgroundColor="transparent" 到选项（使其透明）

这适用于火狐。我不知道它是否适用于IE7（无测试环境）。让我们知道它是否有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-04T01:38:39.507

在饼图所在的配置文件中进行适当的更改。我在 donate.php 下有这个图表作为示例：

从

```
$chartURL = 'http://chart.apis.google.com/chart?chf=bg,s,f9faf7&amp;cht=p&amp;chd=t:'.$percent.',-'.(100-$percent).'&amp;chs=200x200&amp;chco=639600&amp;chp=1.57'; 
```

至

```
$chartURL = 'http://chart.apis.google.com/chart?chf=bg,s,FFFFFF00&amp;cht=p&amp;chd=t:'.$percent.',-'.(100-$percent).'&amp;chs=200x200&amp;chco=639600&amp;chp=1.57'; 
```

当它是白色背景时，该代码让我有透明度！谢谢你。

# ruby-on-rails - 如何在 3 个模型之间设置这种关联？

> ID：14420801
> 
> 赞同：-1
> 
> 时间：2013-01-20T01:24:47.113
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有以下模型：`User`、`UserType`和`UserStatus`。

我为类型和状态记录的数据示例如下：

**类型**

*   买方
*   卖方

**地位**

*   买家意愿
*   买家犹豫
*   卖方意愿
*   卖家犹豫

`UserType has_and_belongs_to_many :user_statuses`反之亦然。

但是，当有人创建`User`记录时，他们应该只能分配`Buyer-Willing`并且`user.user_type = 'buyer'`相同的选项适用于其余选项。

所以基本上，他们选择了 Type = `Buyer`，然后他们看到了 2 个选项。

如何设置 和 之间`User`的这种关联`Status`？

我觉得它有一些`:through`关联，但我尝试`has_one :user_status, :through => :user_type`了我的`User`模型，但我得到了一个奇怪的错误。

想法？

**编辑 1**

另外，我如何才能找到它的类型，`user`而`user.type`不是`user.user_type`更改模型名称？当我在这个模型所属的代码中时，我更容易快速理解`user`。所以我不想重命名它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T05:36:52.977

如果我理解正确，听起来你想要这样的东西：

用户

```
belongs_to :type, class_name: "UserType"
belongs_to :status, class_name: "UserStatus", before_add: :validate_status

def validate_status
  return false unless type
  return false unless status.types.include?(type)
  true
end 
```

用户类型

```
has_many :users
has_and_belongs_to_many :user_statuses 
```

用户状态

```
has_many :users
has_and_belongs_to_many :user_types 
```

我认为如果您想取消交易，该`validate_status`函数可以返回`false`，但文档似乎只提到抛出异常。

说到文档，我认为我建议的所有内容都在这里：

[http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

我希望它有所帮助。

# javascript - 在 Coffeescript 中以编程方式调用“new”

> ID：14420802
> 
> 赞同：0
> 
> 时间：2013-01-20T01:24:51.117
> 
> 标签：javascript, coffeescript

> **可能重复：**
> [如何使用变量字符串定义类名来制作 JavaScript 对象？](https://stackoverflow.com/questions/1366127/instantiate-a-javascript-object-using-a-string-to-define-the-class-name)

我希望能够以`new`编程方式调用事物。例如，如果我有这两个类：

```
class Bird
   constructor: (@name) ->

class Snake
   constructor: (@name) -> 
```

我可以打电话`s = new Snake("Sam")`。现在，我想做的是

```
bird_class = "Bird"
b = new bird_class() 
```

并且能够从字符串构造一个鸟对象。这在 CoffeeScript 或 Javascript 中可行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:34:51.663

如果你将你的类保存在一个对象中，你总是可以：

```
var animals = {
  Snake: Snake,
  Bird: Bird
};

new animals["Snake"](); 
```

根据您的评论，像这样的一些模式可以让您即时注册课程。它是原始的，但可能会给你一个想法：

```
var zoo = {
  animals: {},

  add: function (animal) {
    this.animals[animal.name] = animal;
  },

  make: function(name) {
    if (this.animals[name]) {
      return new this.animals[name]();
    }
  }
};

function Snake() {};
zoo.add(Snake);
var snake = zoo.make('Snake'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T01:30:30.577

我不是 Coffeescripter，但在 JavaScript 中你可以这样做：

```
 function MyClass() { ... constructor ... };
 function MyOtherClass() { ... other constructor ... };

 var theConstructor = something ? MyClass : MyOtherClass;

 var obj = theConstructor(); 
```

您可以获取对构造函数的引用并将其视为一个值，随心所欲地处理它。

如果你想按*名字*来做，那有点棘手。缺少使用`eval()`（如果你愿意，你可以这样做，并且如果你可以确定它对你的项目没有风险），那么不可能在 JavaScript 中获得对符号的引用。但是，如果它是对对象属性的引用，它确实有效。

# c - 使用 pthread 从终端写入和读取

> ID：14420805
> 
> 赞同：1
> 
> 时间：2013-01-20T01:25:17.157
> 
> 标签：c, linux, pthreads, posix, ncurses

我想使用 pthreads 在 C 中创建一个多线程应用程序。我想让一些工作线程在后台做一些事情，但是每隔一段时间，他们就必须在终端上打印一些东西，所以我想他们必须这样做

*   “获取输出设备”（在本例中为标准输出）
*   写信给它
*   释放输出设备
*   冲洗并重复。

另外，我希望用户能够“回复”输出。为简单起见，我将假设在用户对线程的输出给出答案之前不会向终端写入任何新内容，以便仅在用户回复后写入新行等。我已阅读在等待终端上的用户输入时，ncurses 似乎是解决这个问题的方法。

但是，现在我读到 ncurses 不是线程安全的，我不确定如何继续。我想我可以用互斥锁包装所有与终端相关的东西，但在我这样做之前，我想知道是否有更聪明、可能更方便的方法来解决这个问题，也许是一个带有条件变量的解决方案？我在这里有点迷路，所以欢迎任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:33:30.340

为什么不只拥有一个工作是与终端交互的线程呢？

如果其他线程想要发送消息或从终端获得回复，它们可以创建反映该请求的结构，获取互斥体，并将该结构添加到链表中。终端线程将遍历链表，根据需要输出数据并根据需要获取回复。

您可以使用条件变量向终端线程发出信号，表明现在有需要输出的数据。链表中的结构可以包括一个响应条件变量，终端线程可以在它有回复时发出信号，如果有的话。

对于没有得到回复的输出，终端线程可以在输出其内容后删除该结构。对于得到回复的输出，终端线程可以向对输出感兴趣的线程发出信号，然后让该线程在复制输出后删除结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T00:19:52.130

您可以在终端上使用 fprintf。fprintf 负责处理并发问题，例如它会在写入输出设备之前在 stdout 上使用互斥锁。

# security - 如何保护对服务器具有 shell 访问权限的其他用户的数据库设置

> ID：14420807
> 
> 赞同：0
> 
> 时间：2013-01-20T01:25:45.873
> 
> 标签：security, mediawiki

我在网络服务器上将 mediawiki 安装到某个文件夹

```
drwxr-xr-x /server/web/mediawiki 
```

该目录包含一个文件 LocalSettings.php。最初，此文件包含纯文本形式的数据库设置（用户/密码）。

跟随指南

```
https://www.mediawiki.org/wiki/Manual:Securing_database_passwords 
```

***1***我尝试使用 chmod 读取保护 LocalSettings.php

```
-rwx------ LocalSettings.php 
```

尝试在网络浏览器中重新加载 mediawiki 页面时出错

```
failed to open stream: Permission denied in .../includes/WebStart.php 
```

所以我必须授予对 LocalSettings.php 的读取权限才能继续

```
 -rwx---r-- LocalSettings.php 
```

所以，由于某种原因，简单的方法对我不起作用。

**问题1**：如果您知道为什么简单的方法不起作用，请解释一下。

***2***比我遵循指南中描述的其他方式。我将所有数据库设置（用户/密码）从 LocalSettings.php 剪切到我放置在 Web 可访问文件夹之外的外部文件（DBpsw.php）中：

```
 drwxr-xr-x /home/mediawikiDBpsw/

    -rw-r--r-- /home/mediawikiDBpsw/DBpsw.php 
```

并将**/home/mediawikiDBpsw/DBpsw.php**包含到**/server/web/mediawiki/LocalSettings.php**

但正如您所见，其他人可以访问文件夹**/server/web/mediawiki**、**/home/mediawikiDBpsw/**和文件**/home/mediawikiDBpsw/DBpsw.php**、**/server/web/mediawiki/LocalSettings.php**（可读）。因此，任何“其他”有权访问服务器的人都可以 ssh 到文件夹**/server/web/mediawiki**读取文件**LocalSettings.php**，从那里学习路径**/home/mediawikiDBpsw/DBpsw.php**并读取数据库设置（用户/密码）来自**/home/mediawikiDBpsw/DBpsw.php**。

**问题 2**：如何保护数据库设置（用户/密码）免受有权访问服务器的“其他”用户的影响？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T11:18:42.923

带有数据库设置的文件**/home/mediawikiDBpsw/DBpsw.php**的组应更改为网络服务器的用户组（使用 chgrp）。

应该将文件的权限更改为（使用 chmod）

```
w-rw-r----- /home/mediawikiDBpsw/DBpsw.php 
```

现在，mediawiki 将运行，因为网络服务器的用户将有权访问数据库设置。仍然数据库设置将是安全的，因为其他人将无法读取**/home/mediawikiDBpsw/DBpsw.php**（除非他们与网络服务器的用户在同一组中，情况不应该如此）。

# sass - 我刚刚开始使用 susy grid 并试图找出响应部分

> ID：14420812
> 
> 赞同：2
> 
> 时间：2013-01-20T01:27:08.013
> 
> 标签：sass, compass-sass, susy-compass

苏西对我来说很陌生。我正在尝试为我的页面设置断点

这是站点文档上的演示代码

```
// at-breakpoint(<$media-layout> [, <$font-size>]) { <@content> }
@include at-breakpoint(30em 12) {
  .page { @include container; }
} 
```

我不明白的是 30em 和 12 代表什么，我想为页面如此宽时设置一个媒体查询，理想情况下是手机大小。我将如何使用 sussy 进行此操作？

更新

即使在阅读文档后，我也不太了解语法，我尝试过编写，但我得到了一个 sass 错误。我将如何使用 12col 网格在 30em 处书写？

```
@mixin at-breakpoint($media-layout: 30em 12, $base-font-size){
    #mastHead{background: red;}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T02:13:11.287

您的答案在来源：[https ://github.com/ericam/susy/blob/master/sass/susy/_media.scss#L23](https://github.com/ericam/susy/blob/master/sass/susy/_media.scss#L23)

```
// Nest a block of code inside a new media-query and layout context.
//
// $media-layout  : a list of values [$min $layout $max $ie] including...
//                : - one unitless number (columns in a layout)
//                : - two optional lengths (min and max-width media-query breakpoints).
//                : - one optional boolean or string to trigger fallback support for IE.
// $font-size     : [optional] The base font-size of your layout, if you are using ems.
//                : - defaults to $base-font-size
@mixin at-breakpoint(
  $media-layout,
  $font-size: $base-font-size
) {
    // stuff
} 
```

它也在文档中： [http ://susy.oddbird.net/guides/reference/#ref-media-layouts](http://susy.oddbird.net/guides/reference/#ref-media-layouts)

```
// $media-layout: <min-width> <layout> <max-width> <ie-fallback>;
// - You must supply either <min-width> or <layout>.
$media-layout: 12;          // Use 12-col layout at matching min-width.
$media-layout: 30em;        // At min 30em, use closest fitting layout.
$media-layout: 30em 12;     // At min 30em, use 12-col layout.
$media-layout: 12 60em;     // Use 12 cols up to max 60em.
$media-layout: 30em 60em;   // Between min 30em & max 60em, use closest layout.
$media-layout: 30em 12 60em;// Use 12 cols between min 30em & max 60em.
$media-layout: 60em 12 30em;// Same. Larger length will always be max-width.
$media-layout : 12 lt-ie9;  // Output is included under `.lt-ie9` class,
                            // for use with IE conditional comments
                            // on the <html> tag. 
```

# matlab - matlab for 循环挂起

> ID：14420814
> 
> 赞同：0
> 
> 时间：2013-01-20T01:27:12.517
> 
> 标签：matlab, for-loop, logic

我正在为 for 循环进行模拟和代码

例如

```
IntervalInterArrivalTime = [2 3 4 5] //user input 
CDF = [250 500 750 1000] // this is the probability but multiply 1000 to alculate the range
randInterArrival = [991 351 754 823] // this is pc random generated number so each time wwill be different 

lengthCDF = length(CDF); // length of the CDF which in this case is =4
period = 0; 
```

我想要做的 for 循环是程序将使用 CDF 和 IntervalArrivalTime 检查 randInterArrival 的范围。例如：

如果 randInterArrival >0 且 <= CDF(1) ，则 period 将为 IntervalInterArrivalTime(1)

否则，如果 randInterArrival > CDF(1) 和 <= CDF(2) ，则周期将为 IntervalInterArrival(2)

否则，如果 randInterArrival > CDF(2) 和 <= CDF(3) ，则周期将为 IntervalInterArrival(3)

否则，如果 randInterArrival > CDF(3) 和 <= CDF(4) ，则周期将为 IntervalInterArrival(4)

```
for i=1:lengthCDF
if randInterArrival(i)>0 && randInterArrival(i)< CDF(i)
 period=IntervalInterArrivalTime(i)
else if randInterArrival(i)> CDF(i) % how to continued to write the statement out so that i can loop through all the items in the CDF and check which IntervalInterArrival() it is

% i stop here and dunno how to continued to loop through the CDF and check
end
end 
```

希望大家能帮忙。提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T02:32:33.420

您*可以*按照您提议的方式执行此操作，分别检查每个条件。但是，当您增加要检查的元素/条件的数量时，这会变得非常笨拙。更好的方法是利用该`find`功能并*重新考虑您要执行的操作的逻辑：*

目标是什么？目标是确定`CDF`大于的最小值的索引`randInterArrival(i)`。执行以下操作：

```
index = find(CDF > randInterArrival(i), 1, 'first'); 
```

瞧！无需`if`声明。使用此索引获取周期：

```
period = IntervalInterArrivalTime(index); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T01:35:34.867

你需要`end`你的陈述：

```
for i=1:lengthCDF
if randInterArrival(i)>0 && randInterArrival(i)< CDF(i)
 period=IntervalInterArrivalTime(i)
else if randInterArrival(i)> CDF(i) && ?? // i hang here .. 
end
end 
```

# ios - Box2D / cocos2d 动画到一个带有旋转的点

> ID：14420816
> 
> 赞同：1
> 
> 时间：2013-01-20T01:27:23.887
> 
> 标签：ios, cocos2d-iphone, box2d

我对 Box2D 和 cocos2d 很陌生。我正在尝试做一些我认为很简单的事情，但结果却比我预期的要困难，而且我在任何地方都找不到有效的答案。

基本上，我想移动一个 b2body 并用动画将它旋转到某个点。

我可以通过以下方式将其调整到正确的位置和旋转：

```
targetBody->SetTransform(b2Vec2(10.0f,1.0f),10); 
```

但我不知道如何随着时间的推移在那里对其进行动画处理。我尝试在用于身体的精灵上使用 cocos2d 动画，但这没有任何作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:54:48.313

In general, you use Box2D to simulate the physical behavior of objects in relation to each other. The rules of mechanics implemented by Box2D dictate how your cocos2d `CCSprite`s move if you continuously update the translation and rotation of your sprites according to their corresponding Box2d `b2Body`. You will have some kind of repeatedly invoked `tick:` method in which you `step` your Box2d world along in time, and in which you update your sprite positions according to simulation results of Box2d.

This pattern corresponds to `b2Body`s of type `b2_dynamicBody`. Physical laws dictate the motion of the body in this case, and your sprites will follow these simulation results. This is why setting a conflicting position of a sprite by means of a `CCAction` or even directly will be undone almost instantaneously with the next `tick:`.

**Solution 1: kinematic body type**

However, there do exist other modes for a `b2Body`, and one of these is `b2_kinematicBody` in which the translation is no longer governed by the world but by the velocities or angular speeds you dictate through setters. So it would be one solution to work with body type `b2_kinematicBody` as in:

```
b2BodyDef bdef;
bdef.type = b2_kinematicBody; 
```

With this you would manipulate the velocity and angular speed of a `b2Body` explicitly. In this case, Box2d is still responsible for moving bodies around, but according the velocities you dictate, and without any force effects of collision or gravity applied to this particular body. Also with this strategy, your `CCSprite`s will follow `b2Body`s. Setting conflicting positions for your sprites directly or by applying a `CCAction` would not make sense for the same reason as described above.

**Solution 2: decouple sprites from Box2d**

An alternative way to animating sprites would be to fully decouple those sprites from Box2d. In this case, you would simply not have any `b2Body` that governs the position of the sprite you are going to animate. Now, in this case, only you will dictate the position and rotation of your `CCSprite`, i.e. directly either through its `position` property or by applying a `CCAction`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T03:22:27.100

有几种方法可以做到这一点。

您可以在每个时间步使用 SetTransform 来随着时间的推移逐渐更新身体的位置，实际上是自己执行动画。这种方法的缺点是身体是“传送”到新位置而不是移动，所以它没有动量，这意味着如果它在途中碰到任何东西，你可能会得到奇怪的结果。不过，如果您知道它不会撞到任何东西或不需要对碰撞做出反应，那就没问题了。

另一种方法是 SetLinearVelocity 和 SetAngularVelocity 给身体适当的运动。这将使碰撞的结果保持真实，并且您不需要在每个时间步保持更新任何内容。另一方面，您需要检测身体何时到达所需位置，然后将速度设置回零，否则它将继续移动。对于动态物体，您还需要以某种方式抵消重力，方法是将物体的重力比例设置为零，或者通过施加向上的力来平衡重力，或者在移动过程中将物体类型更改为运动学。

# java - 如何从java中的对象数组中检索特定对象

> ID：14420817
> 
> 赞同：0
> 
> 时间：2013-01-20T01:27:54.250
> 
> 标签：java, arrays, object, types

我有一个非常大的对象数组，其中不断添加对象，每个对象都是动态的，并且包含定义它的不同参数（getParam1（）等）。

我需要一种数据类型，它允许我直接指向数组中包含特定参数的对象，而无需在每次需要特定对象时对整个数组进行索引。

是否有任何数据类型在 java 中提供此功能，还是我必须创建自己的？在那种情况下，我该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:08:16.260

> 我有一个非常大的对象数组，其中不断添加对象，每个对象都是动态的，并且包含定义它的不同参数（getParam1（）等）。

An`array`是一个静态结构。如果您要不断向其中添加元素，您应该重新考虑使用动态集合，例如 a `List`、 a`Set`或 a `Map`。如果您没有修改数组的长度，而只是更新其上的不同对象，那么您就可以了。尽管如此，您仍然必须跟踪（索引、对象数量等）数组的当前状态，因为您需要知道将对象放在哪里。

> 我需要一种数据类型，它允许我直接指向数组中包含特定参数的对象，而不必在每次需要特定对象时对整个数组进行索引。

这将需要某种中间逻辑。如果您指向具有特定参数的对象，如果多个对象具有该参数，会发生什么情况？你必须定义哪一个是正确的。另一方面，如果您指向参数，您仍然需要知道相关对象。

我想说的是，而不是使用 an`array`您应该尝试使用 a `Map`with 条目，其中键是参数，值是 a `Set`，包含与该参数相关的不同对象。

`Map`如果您只将参数映射到一个对象，A就足够了，但我将介绍更复杂的情况，以防万一。

请注意，一个对象可以存在于多个`Set`s 中，因为需要两个参数才能将其映射两次才能找到它。

> 我查看了地图，但对于我的对象来说并不是很理想。

我不知道您当前的上下文以及您如何识别您的对象。如果您有 ID 或任何类型的唯一身份断言，您可以将`Map`of `Set`s 转换为 a`Map`或`Map`s，您可以在其中获取包含与某个函数关联的对象的 Map，然后通过该 ID 获取特定对象。

最后，如果还不够，您应该创建一个满足您需求的结构。不过，为了即时访问，你最好使用一个`Map`或一个非常好的`array`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T01:45:44.523

您可以为每个参数维护一个映射，并在参数更改时更新每个映射。如果您无法控制 mutating 或 mutable 类，那么除了线性搜索对象外，您无能为力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T02:14:32.847

使用 a`Map`而不是数组：

```
Map<String, MyObject> map = new HashMap<String, MyObject>();

MyObject o;
String someId = o.getId();  // use some identifying id for your objec

map.put(someid, o); // do this for all your objects 
```

然后当您需要检索一个时：

```
MyObject o = map.get(someId); 
```

如果您需要所有对象（可能，但不太可能）：

```
List<MyObject> objects = map.getValues(); 
```

# php - 为什么这个回调函数不起作用？

> ID：14420818
> 
> 赞同：0
> 
> 时间：2013-01-20T01:28:00.143
> 
> 标签：php, arrays, object, callback, comparison

我有以下代码：

```
public function compareObjects($object1, $object2){
    return $object1->id - $objects2->id
}

$diff = array_udiff($array1, $array2, 'compareObjects'); 
```

但它一直说比较方法不存在或者是无效的函数名....

我以为我做对了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T01:41:01.453

实例化对象的方法作为数组传递，该数组包含索引 0 处的对象和索引 1 处的方法名称。

```
// Functions
$diff = array_udiff($array1, $array2, 'compareObjects');

// Object methods 
$diff = array_udiff($array1, $array2, array($this, 'compareObjects'));
// -OR-
$diff = array_udiff($array1, $array2, array($my_obj, 'compareObjects'));

// Static class methods
$diff = array_udiff($array1, $array2, 'some_class::compareObjects'); // PHP 5.2.3+ 
```

**[PHP：回调](http://php.net/manual/en/language.types.callable.php)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T01:29:17.777

它正在寻找一个纯函数，而不是类方法。您需要使用`$this`, 就像对类方法的任何调用一样。

你需要这样做...

```
$diff = array_udiff($array1, $array2, array($this, 'compareObjects')); 
```

同样，如果您在课堂外使用它，则需要像这样使用它...

```
$objRandom = new Whatever;
// do some fancy PHP stuff, or not
$diff = array_udiff($array1, $array2, array($objRandom, 'compareObjects')); 
```

这几乎就是如何使用带有回调函数/方法的任何 PHP 函数。

# ios - 动画坐标更改到 MKMapView 上的注释

> ID：14420825
> 
> 赞同：1
> 
> 时间：2013-01-20T01:29:20.800
> 
> 标签：ios, mapkit

是否可以在 iOS 中对 MKMapView 上的注释坐标进行动画更改？API 中似乎没有任何迹象表明这是可能的，但是像 Uber 这样的应用程序在他们的地图中显示汽车位置时似乎会这样做。也许他们在短时间内多次调用 setCoordinate: 以呈现动画的外观？

# c++ - emplace_back 和继承

> ID：14420826
> 
> 赞同：6
> 
> 时间：2013-01-20T01:29:26.620
> 
> 标签：c++, inheritance, vector, c++11

我想知道您是否可以使用 emplace_back 将项目存储到向量中，emplace_back 是从向量期望的类派生的类型。

例如：

```
struct fruit
{
    std::string name;
    std::string color;
};

struct apple : fruit
{
    apple() : fruit("Apple", "Red") { }
}; 
```

别的地方：

```
std::vector<fruit> fruits; 
```

我想在向量中存储一个苹果类型的对象。这可能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-20T01:30:55.340

不可以。向量只存储固定类型的元素。你想要一个指向对象的指针：

```
#include <memory>
#include <vector>

typedef std::vector<std::unique_ptr<fruit>> fruit_vector;

fruit_vector fruits;
fruits.emplace_back(new apple);
fruits.emplace_back(new lemon);
fruits.emplace_back(new berry); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T01:33:00.500

`std::vector<fruit> fruits;` 它仅将水果存储在非派生类型的水果中，因为分配器仅为`sizeof(fruit)`每个元素分配。为了保持多态性，您需要将指针存储在水果中。

```
std::vector<std::unique_ptr<fruit>> fruits;
fruits.emplace_back(new apple); 
```

苹果是在免费存储上动态分配的，当元素从向量中删除时将被释放。

```
fruits.erase(fruits.begin()); 
```

# ssh - 取消 SSH 安全（或者，通过 HTTP 代理 Minecraft 数据包）

> ID：14420828
> 
> 赞同：-2
> 
> 时间：2013-01-20T01:29:43.707
> 
> 标签：ssh, minecraft, ports, openshift, tunneling

我在 OpenShift 上设置了 Minecraft 服务器，这是一个免费的 PaaS。OpenShift 需要内部应用程序（例如我的服务器）绑定到 15000 到 35530 范围内的端口或端口 8080。但是，它还需要外部客户端通过以下端口之一访问服务器：22、25、80、109、 110、143、220、443、465、587、993 或 995。

换句话说，内部暴露的端口没有一个暴露在外部；但是，有两种通信方式。一种是 SSH 端口隧道，我已经在我的计算机上设置了它。第二种是通过HTTP，内部通过8080发送时自动转发到80。SSH隧道的问题是需要通过OpenShift添加客户端的公钥，而客户端需要设置自己的私钥，这对我的大多数朋友来说太复杂了。

我想让连接过程更容易，所以我想到了两种可能的方法。第一个设置更简单，是通过不需要特定的公钥或私钥来“不安全”连接 SSH 连接。这是一个游戏服务器，所以安全性对我来说根本不是问题，但我认为这可能是不可能的，因为 SSH 是为安全而构建的。另一种更难的方法是将 Minecraft 数据包嵌入到 HTTP 数据包中，OpenShift 系统会自动转发这些数据包。也许这可以使用现有的 HHTP 代理系统？

如果有人可以帮助我解决这两种方式中的任何一种（或另一种方式，如果你能想到一个），我将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:56:31.820

Why not just create an ssh key pair specifically for this application and create a script that opens the tunnel using that specific key and then launches the program? You can also put restrictions on what any connection using that key is allowed to do (nothing).

```
#!/bin/sh
ssh -i ~/pathtoidfile -L 25565:localhost:yourport -f -N
# run minecraft to local server? 
```

This is just off the cuff - probably not exactly correct. Also, assumes a unix (Mac or Linux) system. For windows, you'd have to install an ssh client (mingw?) and use cmd syntax.

# opencv - OpenCV 立体匹配基本矩阵怪异值

> ID：14420836
> 
> 赞同：0
> 
> 时间：2013-01-20T01:32:34.890
> 
> 标签：opencv, matrix, stereoscopy

我有一个使用 OpenCV 和两个网络摄像头的立体声设置。我使用 BM 对应算法计算了基本矩阵和基本矩阵，intrinces extrinces 等。现在我想在另一张图像中找到左图像中一个像素的匹配点。为此，我定义了以下函数，该函数不完整，因为我的主要目标是计算真实世界的距离。

```
void StereoVision::findEpipolarLineForXY(int x, int y ,int lr)
{

if(calibrationDone)
{
    CvPoint3D32f p1={x,y,1};
    qDebug("%d,_,_,%d",p1.x,p1.y);

    CvMat pt1=cvMat(3,1,CV_64FC1,&p1);
    qDebug("-");
    CvMat e=_E;
    qDebug("pt1:");
    PrintMat(&pt1);
    qDebug("e:");
    PrintMat(&e);

    //CvMat * corLine;
    //CvMat* pt2=e*pt1;

    CvMat *pt2 = cvCreateMat( e.rows, pt1.cols, CV_64FC1);
    qDebug("pt2:");
    PrintMat(pt2);
    qDebug("--%d--->%d",pt2->rows,pt2->cols);

    cvMatMul( &e, &pt1, pt2 );

    qDebug("--%d--->%d",pt2->cols,pt2->data);
    //const CvMat* f=&_F;
    qDebug("---");
    //cvComputeCorrespondEpilines(&mat,lr,f,corLine);
    qDebug("----");
    //qDebug("%d,,,%d",corLine->height,corLine->rows);

    }

}

void StereoVision::PrintMat(CvMat *A)
{
int i, j;

for (i = 0; i < A->rows; i++)
{
    QDebug dbg(QtDebugMsg);
    dbg<<"\n";
    switch (CV_MAT_DEPTH(A->type))
    {
    case CV_32F:
    case CV_64F:
        for (j = 0; j < A->cols; j++)
            dbg <<"%8.3f "<< ((float)cvGetReal2D(A, i, j));
        break;
    case CV_8U:
    case CV_16U:
        for(j = 0; j < A->cols; j++)
            dbg <<"%6d"<<((int)cvGetReal2D(A, i, j));
        break;
    default:
        break;
    }
    dbg.~QDebug();
}
qDebug("");
} 
```

我想知道为什么基本矩阵是一个坏矩阵？所有输出如下：

350, *,* ,317

0, *,* ,1081466880

-

点1：

%8.3f 350

%8.3f 317

%8.3f 1

e:

%8.3f 0 %8.3f inf %8.3f 0

%8.3f 0 %8.3f 0 %8.3f 0

%8.3f 0 %8.3f 0 %8.3f 0

第二点：

%8.3f -inf

%8.3f -inf

%8.3f -inf

--3--->1

--1--->44201616

* * *

* * *

我也想知道我是否在正确的路径上找到真实世界坐标中像素的 3D 距离？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T02:25:54.177

您应该查找[Stereo Ranging](https://code.google.com/p/sentience/wiki/StereoRanging)。

如果您有视差像素值，即两帧中两点之间的水平像素距离，您可以找出该点的真实世界深度（相对于相机基线）。

```
focal_length_pixels = focal_length_mm * sensor_pixels_per_mm;
distance_mm = baseline_mm * focal_length_pixels / disparity_pixels; 
```

`disparity_pixels`- 两帧之间的水平像素距离（针对该点）。例如。如果左图中的点是`(100, 150)`并且第二张图中的点是`(125, 160)`，`disparity_pixel = 25`

您可以`focal_length_mm`从您的相机规格中获得。

```
focal_length_pixels = distance_mm * disparity_pixels / baseline_mm;
sensor_pixels_per_mm = focal_length_pixels / focal_length_mm; 
```

将物体`x mm`与相机的基线保持一定距离。并得到`disparity_pixels`如上图所示。你知道`baseline_mm`. 这会给你`focal_length_pixels`和`sensor_pixels_per_mm`。读[这个](https://code.google.com/p/sentience/wiki/SensorPixelDensity)。

# c# - 在字符串中搜索子字符串

> ID：14420837
> 
> 赞同：0
> 
> 时间：2013-01-20T01:32:44.930
> 
> 标签：c#

我真的是初学者，我已经知道了

```
string.indexOf(""); 
```

可以搜索整个单词，但是当我尝试搜索`e.g: ig out of pig, it doesn't work`.

我这里有一个类似的字符串（部分）：

```
<Special!>The moon is crashing to the Earth!</Special!> 
```

因为我的文件中有很多这些，我无法编辑所有这些并添加一个空格，例如：

```
< Special! > The moon is crashing to the Earth! </ Special! > 
```

我需要得到`sub-string`特别的！月球正在撞击地球！在不添加插件的情况下搜索单词的一部分的简单方法是`HTMLAgilityPack`什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:37:37.290

IndexOf 会起作用，您可能只是使用不当。

如果您的字符串在变量调用 mystring 中，您会说 mystring.IndexOf 然后传入您要查找的字符串。

```
string mystring = "somestring";
int position = mystring.IndexOf("st"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T01:46:22.330

请试试这个：

```
string s = "<Special!>The moon is crashing to the Earth!</Special!>";
int whereMyStringStarts = s.IndexOf("moon is crashing"); 
```

`IndexOf`也应该使用空格，但也许你有`new line`or`tab`字符，而不是空格？

有时区分大小写很重要。您可以通过名为 的附加参数来控制它`comparisonType`。例子：

```
 int whereMyStringStarts = s.IndexOf("Special", StringComparison.OrdinalIgnoreCase); 
```

更多信息`IndexOf`：[MSDN 上的 String.IndexOf 方法](http://msdn.microsoft.com/en-us/library/ms224425.aspx)

无论如何，我认为您可能需要正则表达式来创建更好的解析器。IndexOf 是非常原始的方法，您可能会陷入一大堆代码中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T01:50:38.963

```
 string page = "<Special!>The moon is crashing to the Earth!</Special!>";
        if (page.Contains("</Special!>"))
        {
            pos = page.IndexOf("<Special!>");
            propertyAddress = page.Substring(10, page.IndexOf("</Special!>")-11);
            //i used 10 because <special!> is 10 chars, i used 11 because </special!> is 11
        } 
```

这会给你“月亮正在撞击地球！”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T01:37:29.473

你如何使用它？你应该这样使用：

```
string test = "pig";
int result = test.IndexOf("ig");
// result = 1 
```

如果你想让它不区分大小写，请使用

```
string test = "PIG";
int result = test.IndexOf("ig", StringComparison.InvariantCultureIgnoreCase);
// result = 1 
```

*   [String.IndexOf 方法 - MSDN](http://msdn.microsoft.com/en-us/library/k8b1470s.aspx)

# php - jQuery 确认框

> ID：14420849
> 
> 赞同：1
> 
> 时间：2013-01-20T01:34:11.013
> 
> 标签：php, jquery

我有一个循环通过复选框输入，如果一切返回正常，它需要显示一个弹出框询问用户是否可以继续并提交他们的订单，如果不是那么它不需要做任何事情（处理之内）

我遇到了一些问题，不知道该怎么做，有什么想法吗？

这是我当前的代码

```
 function validateSubmit(){
        var r=true;

       $('tr').each( function() {
          // Find first input
          var input1 = $(this).find('input').eq(0);
          var qty1 = input1.val();
          // Find Second input
          var input2 = $(this).find('input').eq(1);
          var qty2 = input2.val();
          // Find third input
          var input3 = $(this).find('input').eq(2);
          var qty3 = input3.val();
          // Find select box
          var selectBx = $(this).find('select');
          var selectVal = selectBx.val();
            if(qty1 === '' && selectVal != 'Please Select...') {
                alert("You've chosen an option, but not entered a quantity to dispute, please check your inputs.");
                r=false;return false;           
            }
            if(qty1 != '' && selectVal === 'Please Select...') {
                alert("You've entered a quantity, but not chosen why, please check your reasons.");
                r=false;return false;       
            }
            if (qty1 > qty2) {
                alert("For one of your entries, the disputed quantity is larger than the shipped quantity.");
                r=false;return false;               
            }
       }); 
           if (r==true) {
            var a = confirm("Are you sure you want to confirm the dispute? You cannot edit this after it's been submitted?");
            if (a==true)
            {
                return true;        
            }
            else
            {
                return false;
            }
}

    }); 
```

HTML：

```
<table>
                <thead>
                    <tr><th>Item ID</th><th>Description</th><th>Dispute Quantity</th><th>Shipped Quantity</th><th>Ordered Quantity</th><th>Reason</th></tr>
                </thead>
                <tbody>
                    <?php
                        $data = mysql_query("SELECT * FROM `artran09` WHERE `invno` = '$invoiceno'") or die(mysql_error());
                        echo "<center>";
                        $i = -1;        
                        echo "<form action=\"submitdispute.php?invno=".$invoiceno."&ordate=".$placed."\" method=\"POST\" onsubmit=\"return validateSubmit();\">";

                            while ($info = mysql_fetch_array($data)) {              
                                $i += 1;                                    
                                echo "<tr>"; 
                                echo "<td>".$info['item']."</td>"; 
                                echo "<td>".$info['descrip']."</td>";       

                                echo "<td><input type=\"text\" input name=".$i." onKeyPress=\"return numbersonly(this, event)\"  maxLength=\"3\"></td>"; 

                                echo "<td><input type=\"text\" value=".$info['qtyshp']." name = \"ship$i\" onKeyPress=\"return numbersonly(this, event)\" maxLength=\"3\" disabled=\"disabled\"></td>"; 

                                echo "<td><input type=\"text\" value=".$info['qtyord']." onKeyPress=\"return numbersonly(this, event)\" maxLength=\"3\" disabled=\"disabled\"></td>"; 

                                echo "<td><select name = \"reason$i\">";
                                echo "<option>Please Select...</option>";
                                echo "<option>Short/Not received</option>";
                                echo "<option>Damaged Goods</option>";
                                echo "<option>Product Not Ordered</option>";                    
                                echo "</select></td>";

                                echo "</tr>"; 
                            }

                    ?>
                </tbody>
            </table>
        </div>
    </div>
    <p><input type = "submit" value = "Dispute" name ="Submit">
    </form> 
```

对于任何有兴趣的人-我已经解决了这个问题！感谢大家的耐心等待！这是修复：

```
 function validateSubmit(){
    var r=true;

   $('tr').each( function() {
      // Find first input
      var input1 = $(this).find('input').eq(0);
      var qty1 = input1.val();
      // Find Second input
      var input2 = $(this).find('input').eq(1);
      var qty2 = input2.val();
      // Find third input
      var input3 = $(this).find('input').eq(2);
      var qty3 = input3.val();
      // Find select box
      var selectBx = $(this).find('select');
      var selectVal = selectBx.val();
        if(qty1 === '' && selectVal != 'Please Select...') {
            alert("You've chosen an option, but not entered a quantity to dispute, please check your inputs.");
            r=false;return false;           
        }
        if(qty1 != '' && selectVal === 'Please Select...') {
            alert("You've entered a quantity, but not chosen why, please check your reasons.");
            r=false;return false;       
        }
        if (qty1 > qty2) {
            alert("For one of your entries, the disputed quantity is larger than the shipped quantity.");
            r=false;return false;           
        }
   }); 

    if (r=true) {
        var a = confirm("Are you sure you wish to dispute? You cannot dispute this order again once submitted.");
        return a;       
    }
} 
```

帮助万分感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:22:28.303

回答：

```
 function validateSubmit(){
    var r=true;

   $('tr').each( function() {
      // Find first input
      var input1 = $(this).find('input').eq(0);
      var qty1 = input1.val();
      // Find Second input
      var input2 = $(this).find('input').eq(1);
      var qty2 = input2.val();
      // Find third input
      var input3 = $(this).find('input').eq(2);
      var qty3 = input3.val();
      // Find select box
      var selectBx = $(this).find('select');
      var selectVal = selectBx.val();
        if(qty1 === '' && selectVal != 'Please Select...') {
            alert("You've chosen an option, but not entered a quantity to dispute, please check your inputs.");
            r=false;return false;           
        }
        if(qty1 != '' && selectVal === 'Please Select...') {
            alert("You've entered a quantity, but not chosen why, please check your reasons.");
            r=false;return false;       
        }
        if (qty1 > qty2) {
            alert("For one of your entries, the disputed quantity is larger than the shipped quantity.");
            r=false;return false;           
        }
   }); 

    if (r=true) {
        var a = confirm("Are you sure you wish to dispute? You cannot dispute this order again once submitted.");
        return a;       
    }
} 
```

# scheme - 检查球拍中的期望示例

> ID：14420857
> 
> 赞同：0
> 
> 时间：2013-01-20T01:35:59.443
> 
> 标签：scheme, racket

我是球拍的新手。

有人可以给我一个关于如何`check expect`在 Racket 中使用的简单示例，最好是数字吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:40:01.950

[文档](http://docs.racket-lang.org/test-engine/index.html#%28form._%28%28lib._test-engine%2Fracket-tests..rkt%29._check-expect%29%29)是你最好的朋友。

这真的很简单：第一个参数`check-expect`是要测试的表达式或过程，第二个参数是*预期*的结果（因此得名）。假设您选择了适当的语言（例如`Beginning Student`：）

```
(check-expect (+ 1 1) 2)
(check-expect (+ 1 1) 1) 
```

以上将产生如下输出：

```
Ran 2 tests.
1 of the 2 tests failed.

No signature violations.

Check failures:
    Actual value 2 differs from 1, the expected value.
at line 2, column 0 
```

# c# - 使用响应对象创建子页面弹出窗口会破坏父页面的格式

> ID：14420862
> 
> 赞同：1
> 
> 时间：2013-01-20T01:37:00.157
> 
> 标签：c#, javascript, response.write

我有一个网页，我从中生成一个带有响应对象的弹出窗口，以创建/下载 vcard。它按预期运行，但是我的父页面上的字体大小变得很大，并且只有在我刷新页面时才会恢复到原来的大小。我该如何解决？

我对 vcard 弹出窗口的调用：

```
 Response.Write(@"<script language = 'Javascript'>var" +
                        @" win=window.open('vCard.aspx',null,'width=50,height=50," +
                        @"top=100,left=100','true');</script>"); 
```

电子名片制作：

```
 public static void VCard(HttpResponse response)
    {
        response.Clear();
        response.Charset = "";
        response.ContentType = "text/x-vCard";
        System.IO.StringWriter stringWrite = new System.IO.StringWriter();
        System.Web.UI.HtmlTextWriter htmlWrite = new HtmlTextWriter(stringWrite);

            {
                response.AddHeader("content-disposition", "attachment; filename=" + usr.SamAccountName);

                stringWrite.WriteLine("BEGIN:VCARD");
                stringWrite.WriteLine("VERSION:2.1");
                //Name
                stringWrite.WriteLine("N:" + usr.LastName + ";" + usr.FirstName
                    );
               //removed other vcard lines....

                //vCard End
                stringWrite.WriteLine("END:VCARD");
                response.Write(stringWrite.ToString());
                response.End();
            }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:03:32.157

`Response.Write`在响应完全形成并发送回浏览器之前使用将导致字符串被写入流的前面。

实际上有一种特定的方法可以满足这种需求`ClientScriptManager.RegisterClientScriptBlock`：

```
ClientScript.RegisterClientScriptBlock(this.GetType(), "scriptKeyNameCanBeAnythingYouWant", "var
                    @" win=window.open('vCard.aspx',null,'width=50,height=50," +
                    @"top=100,left=100','true');", true); 
```

参考：http `ClientScriptManager.RegisterClientScriptBlock`: [//msdn.microsoft.com/en-us/library/bahh2fef.aspx](http://msdn.microsoft.com/en-us/library/bahh2fef.aspx)

# jquery - 用 jquery 创建 HTML 列表？

> ID：14420863
> 
> 赞同：-1
> 
> 时间：2013-01-20T01:37:03.390
> 
> 标签：jquery, html, json

我正在制作一个创建聊天室的网络应用程序。因此，假设我单击创建房间按钮并将其作为控制台中的输出：

```
{
    "statusCode": 200,
    "statusText": "QUEUE_OK",
    "data": {
        "roomStatus": "discussion",
        "queue": [
            {
                "id": "11",
                "user": "1",
                "room": "11",
                "inserted": "2013-01-19 23:58:16",
                "status": "1",
                "data": null,
                "first_name": "Danny",
                "last_name": "Sock"
            }
        ]
    }
} 
```

我将如何将每个队列条目转换为仅显示名字和姓氏的 HTML 列表？我以前从未使用过 jquery，所以我迷路了……谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:13:18.780

如果您有这样的 HTML 元素：

```
<ul id="list"></ul> 
```

您可能会执行以下操作：

```
var ul = $("#list");
$.each(json.data.queue, function (idx, elem) {
    ul.append("<li>" + elem.first_name + " " + elem.last_name + "</li>")
}) 
```

`json`问题中显示的结构在哪里，例如：

```
var json = {
    "statusCode": 200,
    "statusText": "QUEUE_OK",
    "data"      : {
        "roomStatus": "discussion",
        "queue"     : [
            {
                "id"        : "11",
                "user"      : "1",
                "room"      : "11",
                "inserted"  : "2013-01-19 23:58:16",
                "status"    : "1",
                "data"      : null,
                "first_name": "Danny",
                "last_name" : "Sock"
            },
            {
                "id"        : "12",
                "user"      : "1",
                "room"      : "11",
                "inserted"  : "2013-01-19 23:58:16",
                "status"    : "1",
                "data"      : null,
                "first_name": "John",
                "last_name" : "Smith"
            }
        ]
    }
}; 
```

# java - Java中的字符串数组对象

> ID：14420871
> 
> 赞同：7
> 
> 时间：2013-01-20T01:38:30.873
> 
> 标签：java, arrays, oop

我正在尝试在我的运动员班级、国家和姓名的两个数组上打印第一个元素。我还需要创建一个对象来模拟运动员的三次潜水尝试（最初设置为零）。我是 OOP 的新手，我不知道如何在我的主程序中执行此操作……就构造函数而言。这是我到目前为止所做的......

这是主要的：

```
import java.util.Random;
import java.util.List;

public class Assignment1 {
public static void main(String[] args) {
            Athlete art = new Athlete(name[0], country[0], performance[0]);   
    }
} 
```

我真的不知道该怎么办......

这是带有数组的类。

```
 import java.util.Random;
 import java.util.List;

 public class Athlete {

public String[] name = {"Art", "Dan", "Jen"};
public String[] country = {"Canada", "Germant", "USA"};
    //Here i would like to create something that would be representing 3 dive attemps  (that relate to dive and score. eventually.)

 Athlete(String[] name, String[] country, Performance[] performance) {
    this.name = name;
    this.country=country;
    this.performance=performance;

}

public Performance Perform(Dive dive){
    dive.getDiveName();
    return null;        
}

public String[] getName() {
    return name;
}

public void setName(String[] name) {
    this.name = name;
}

public String[] getCountry() {
    return country;
}

public void setCountry(String[] country) {
    this.country = country;
}

    } 
```

在此先感谢您的帮助和意见！顺便说一句，还有其他课程，只是不相关的atm ..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T01:56:14.523

**首先**，对于您的 Athlete 类，您可以删除您的`Getter and Setter`方法，因为您已经使用访问修饰符声明了实例变量`public`。您可以通过 访问变量`<ClassName>.<variableName>`。

但是，如果您真的想使用 that `Getter and Setter`，请将`public`修饰符更改为`private`。

**其次**，对于构造函数，您正在尝试执行一种简单的技术，称为`shadowing`. `Shadowing`是当您有一个方法具有与声明的变量同名的参数时。这是一个示例`shadowing`：
`----------Shadowing sample----------`
您有以下课程：

```
public String name;

public Person(String name){
    this.name = name; // This is Shadowing
} 
```

例如，在您的 main 方法中，您将类实例化`Person`如下：
`Person person = new Person("theolc");`

变量`name`将等于`"theolc"`。
`----------End of shadowing----------`

让我们回到您的问题，如果您只想使用当前代码打印第一个元素，您可以删除`Getter and Setter`. 删除您的参数`constructor`。

```
public class Athlete {

public String[] name = {"Art", "Dan", "Jen"};
public String[] country = {"Canada", "Germany", "USA"};

public Athlete() {

} 
```

在您的主要方法中，您可以这样做。

```
public static void main(String[] args) {
       Athlete art = new Athlete();   

       System.out.println(art.name[0]);
       System.out.println(art.country[0]);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-20T01:45:58.970

目前您无法访问名为*name*和*country*的数组，因为它们是*Athelete*类的成员变量。

根据您正在*尝试*执行的操作，这将不起作用。

这些数组属于您的主类。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-20T01:55:00.093

您在运动员课上的尝试似乎是在与一群运动员打交道，这是设计上的错误。

定义一个类来表示单个运动员，其字段表示运动员的属性：

```
public class Athlete {
    private final String name;
    private final String country;
    private List<Performance> performances = new ArrayList<Performance>();
    // other fields as required

    public Athlete (String name, String country) {
        this.name = name;
        this.country = country;
    }
    // getters omitted

    public List<Performance> getPerformances() {
        return performances;
    }

    public Performance perform(Dive dive) {
        // not sure what your intention is here, but something like this:
        Performance p = new Performance(dive, this);
        // add new performance to list
        performances.add(p);
        return p;
    }
} 
```

然后您的主要方法将像这样使用 ti：

```
public class Assignment1 {
    public static void main(String[] args) {
        String[] name = {"Art", "Dan", "Jen"};
        String[] country = {"Canada", "Germant", "USA"};
        Dive[] dive = new Dive[]{new Dive("somersault"), new Dive("foo"), new Dive("bar")};
        for (int i = 0; i < name.length; i++) {
            Athlete athlete = new Athlete(name[i], country[i]);
            Performance performance = athlete.perform(dive[i]);   
            // do something with athlete and/or performance
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-20T01:51:52.983

我认为你对你所做的事情有点搞砸了。运动员是一个对象，运动员有一个名字，我有一个他居住的城市。运动员可以潜水。

```
public class Athlete {

private String name;
private String city;

public Athlete (String name, String city){
this.name = name;
this.city = city;
}
--create method dive, (i am not sure what exactly i has to do)
public void dive (){} 
}

public class Main{
public static void main (String [] args){

String name = in.next(); //enter name from keyboad
String city = in.next(); //enter city form keybord

--create a new object athlete and pass paramenters name and city into the object
Athlete a = new Athlete (name, city);

}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-20T01:52:40.823

公共静态无效主要（字符串[]参数）{

```
 public String[] name = {"Art", "Dan", "Jen"};
        public String[] country = {"Canada", "Germant", "USA"};
        // initialize your performance array here too.

        //Your constructor takes arrays as an argument so you need to be sure to pass in the arrays and not just objects.
        Athlete art = new Athlete(name, country, performance);   

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-20T02:29:53.430

首先，数组毫无意义，让我们摆脱它们：它们所做的只是为模拟数据提供值。如何构建模拟对象一直存在争议，但很明显，创建假运动员的代码应该*在单元测试*中。我会为 Athlete 类使用 Joshua Bloch 的静态构建器，但是您现在只有两个属性，所以只需将它们传递给构造函数。看起来像这样：

```
class Athlete {

    private String name;
    private String country;

    private List<Dive> dives;

    public Athlete(String name, String country){
       this.name = name;
       this.country = country;
    }

    public String getName(){
        return this.name;
    }

    public String getCountry(){
        return this.country;
    }

    public String getDives(){
        return this.dives;
    }

    public void addDive(Dive dive){
        this.dives.add(dive);
    }
} 
```

然后是潜水课：

```
class Dive {

    private Athlete athlete;
    private Date date;
    private double score;

    public Dive(Athlete athlete, double score){
        this.athlete = athlete;
        this.score = score;
        this.date = new Date();
    }

    public Athlete getAthlete(){
        return this.athlete;
    }

    public Athlete getAthlete(){
        return this.athlete;
    }

    public Athlete getAthlete(){
        return this.athlete;
    }

} 
```

然后进行单元测试并构建类，并操作它们，确保它们正常工作。现在他们什么都不做，所以你所能做的就是断言他们保留了你放入其中的 Dives。例子：

```
@Test
public void testThatDivesRetainInformation(){
    Athlete art = new Athlete("Art", "Canada");
    Dive art1 = new Dive(art, 8.5);
    Dive art2 = new Dive(art, 8.0);
    Dive art3 = new Dive(art, 8.8);
    Dive art4 = new Dive(art, 9.2);

    assertThat(art.getDives().size(), is(5));
    } 
```

然后你可以完成并添加测试，比如确保你不能在没有运动员的情况下进行潜水等等。

您可以将运动员的构造转移到测试的设置方法中，以便您可以在任何地方使用它。大多数 IDE 都支持通过重构来做到这一点。

# html - 三栏内容优先

> ID：14420873
> 
> 赞同：1
> 
> 时间：2013-01-20T01:39:20.657
> 
> 标签：html, layout

这里重温一个老问题。如何开发一个三栏布局，其中主要内容在中间，两侧有侧边栏，但主要内容在 HTML 标记中？

```
<body>
  <section id="main">
    <h1>Main Section Title</h1>
    <img src="http://placehold.it/400x300" />
    <p>This is the main content most important to readers</p>
  </section>
  <aside id="highlights"><!-- left column -->
    <h2>Highlights</h2>
    news feed goes here...
  </aside><!-- end left column -->
  <aside id="participate"><!-- right column -->
    <h2>social Network</h2>
    social media links here...
    <h2>Events</h2>
    events listing here...
  </aside><!-- end right column -->
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:45:17.537

有几种解决方案：

1）编辑：删除

2）使用绝对定位，这不是很灵敏，但是你可以把东西放在你想要的地方，就像DreamWeaver以前做的那样

3）使用Javascript重新排列部分和旁白。将左侧移到第一个，但这可能不是您在窄屏幕上想要的

4) 他们在 AListApart 中的建议：[http ://www.alistapart.com/articles/holygrail/](http://www.alistapart.com/articles/holygrail/)

# javascript - 返回 Android 设备的模态窗口显示“网页不可用”

> ID：14420874
> 
> 赞同：1
> 
> 时间：2013-01-20T01:39:43.133
> 
> 标签：javascript, android, trigger.io

我在 trigger.io 中的模态窗口有问题。例如，如果我使用以下代码：

```
$('#oauth_login').click(function(event){
    event.preventDefault();

    forge.tabs.open('http://' + oAuth_path + '/', true, function (data) {
        forge.logging.log(data)

    });
}); 
```

'oAuth_path' 处的脚本在完成时通过执行以下命令将用户重定向到 'forge:///'

```
<?php
    header('LOCATION: forge:///');
?> 
```

在让我返回移动应用程序的 IOS 设备上；在 Android 设备上，我看到一个错误页面，上面写着“网页不可用”...“网页位于 content://io.trigger.forge”...“可能暂时关闭或”...

这是 Android 上 Trigger 的错误吗？我已经在三星 Note 1 和 Android 模拟器上进行了测试。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T11:40:52.660

只要在视图中点击特定模式，您还可以自动关闭模态视图。

```
var returnUrl = "https://mydomain.com/loginFinished";
var url = "https://mydomain.com/loginDialog?returnUrl=" + encodeURIComponent(returnUrl);

window.forge.tabs.openWithOptions({
  url: url,
  pattern: returnUrl+'*'
}, function(response) {
  // success
}, function() {
  // error
}); 
```

在您的身份验证过程中 (at `https://mydomain.com/loginDialog`)，您应该将用户重定向到`returnUrl`on 成功。这将自动关闭模态视图。

在一些较旧的 Android 设备上，我观察到该模式不会被击中，即使它应该被击中。我建议有一个简单的页面`https://mydomain.com/loginFinished`，上面写着*“身份验证完成。请关闭此选项卡”。*对此问题有一个后备。

您可以在 Trigger.io 文档中找到有关[模式视图中匹配模式的更多信息。](http://docs.trigger.io/en/latest/features/modal.html#match-pattern)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T09:03:45.097

您需要将用户重定向回特定页面，例如`forge:///index.html`.

# sql - 使父表中的行自动下降到子表

> ID：14420877
> 
> 赞同：0
> 
> 时间：2013-01-20T01:40:11.573
> 
> 标签：sql, database, parent, categories

我有 3 张桌子。一个表`EMPLOYEE`是父表，它包含公司的所有员工，然后我有子表，其中包含表中`EMP_ID`的 PK 和 FK`EMPLOYEE`以及其他特定信息。考虑到`EMPLOYEE`表中有`EMP_TYPE`员工的类型，是否可以通过将记录输入到 中`EMPLOYEE`，记录应该自动识别其类型并将自己复制到相关表中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T04:03:22.977

有两种方法可以做到这一点：

1.  使用插入数据库触发器。
2.  从前端或业务层做（我假设你有）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T01:42:56.397

您可以为此使用[触发器函数](http://en.wikipedia.org/wiki/Database_trigger)，该函数检查`EMP_TYPE`然后在相应的子表中插入数据。确保在将数据插入父表时触发这些触发器。

或者您寻找[对象关系](http://en.wikipedia.org/wiki/Object-relational_database)数据库。

对于 MySQL，它可能看起来像这样（不知道模型的真实结构，但它应该很容易适应您的具体情况）：

```
CREATE TRIGGER testref AFTER INSERT ON Employee
  FOR EACH ROW BEGIN
    IF NEW.EMP_TYPE = 'PROGRAMMER' THEN
      INSERT INTO Programmer (id, type, name, salary, start_date) values (NEW.EMP_ID, NEW.EMP_TYPE, NEW.NAME, NEW.SALARY, NEW.START_DATE);
    ELSE
      INSERT INTO Intern (id, type, name, salary) values (NEW.EMP_ID, NEW.EMP_TYPE, NEW.NAME, NEW.SALARY);
    END IF; 
```

结尾;

# ios - UIwebView 加载动画图像不响应 UITapGestureRecognizer

> ID：14420883
> 
> 赞同：1
> 
> 时间：2013-01-20T01:41:36.990
> 
> 标签：ios, objective-c, uiview, uiwebview

我`UIWebView`用作`UIView`从服务器加载动画图像（GIF）的子视图。

```
[webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:picLink]]]; 
```

我将 Tap 手势添加到我的`UIView`，但 webView 禁用了这个手势（`UIWebView frame`=`UIView Frame`和`[view sendSubViewToBack:webView]`.

如何解决？是否有另一种显示 GIF 图像的方法。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:08:57.260

您可以将同级 UIView 放在 UIWebView 之上，并将点击手势识别器添加到该同级。代码可能如下所示：

```
- (void)viewDidLoad {
    [super viewDidLoad];

    UIView *containerView = [[UIView alloc] initWithFrame:self.view.bounds];
    [self.view addSubview:containerView];

    UIWebView *webView = [[UIWebView alloc] initWithFrame:containerView.bounds];
    [containerView addSubview:webView];
    [webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://i.imgur.com/eezCO.gif"]]];

    UIView *frontView = [[UIView alloc] initWithFrame:containerView.bounds];
    [containerView addSubview:frontView];
    UITapGestureRecognizer *tapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapped:)];
    [frontView addGestureRecognizer:tapRecognizer];
}

- (void)tapped:(UITapGestureRecognizer *)tapRecognizer {
    NSLog(@"tapped");
} 
```

# unix - 替换 dos2unix 行尾

> ID：14420890
> 
> 赞同：-1
> 
> 时间：2013-01-20T01:43:20.600
> 
> 标签：unix, sed, awk, find

我正在使用以下代码替换 dos2unix 行尾。每次我执行代码时，它都会卡在命令提示符下。下面的命令有什么问题？

```
for i in `find . -type f \( -name "*.c" -o -name "*.h" \)`; do    sed -i 's/\r//' $i ; done 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T02:46:59.893

在 Ubuntu 中，`dos2unix`和`unix2dos`分别实现为`todos`和`frodos`。它们在包装中提供`tofrodos`。

我建议使用

```
find . -type f \( -name "*.c" -o -name "*.h" \) -print0 | xargs -0 frodos 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T02:25:52.777

我建议确认您的 find 命令和 for 循环正常工作。

您可以通过简单地使用 echo 语句来打印每个文件的名称来做到这一点。

根据您的平台（以及您拥有多少*.c*和*.h*文件），您可能需要使用*xargs*而不是直接操作 find 的输出。很难说，因为你还没有告诉我们你在哪个平台上。

此外，根据您的平台，不同版本的*sed*与*-i*选项的工作方式不同。

有时您**必须**指定用于备份文件的文件扩展名，有时您不必这样做。

以上所有都是我建议逐个测试您的命令的原因。

您应该阅读您尝试在您尝试使用它的系统上使用的每个命令的手册页。

关于命令的*sed*部分，您应该在单个文件上对其进行测试以确保其有效。

您可以使用以下 sed 命令来修复换行符：

`sed 's/^M$//' input.txt > output.txt`

您可以`^M`通过键入`CTRL``v` `CTRL``m`

正如我之前所说，该`-i`选项在不同平台上的工作方式不同。

如果你无法让它工作，你可以 sed 输出一个新文件，然后覆盖原始文件。

在您的 for 循环中执行此操作非常简单。

# repository - 克隆化石时出错：“尝试写入只读数据库”

> ID：14420891
> 
> 赞同：1
> 
> 时间：2013-01-20T01:43:24.203
> 
> 标签：repository, clone, fossil

这是我第一次尝试在我的个人服务器上托管化石存储库。当我尝试在 Windows 7 上克隆项目时，我收到一条奇怪的消息：

```
PS [folder]> fossil clone 'http://[hostName]/cgi-bin/repo/[repoName]' [repoName].fossil
                Bytes      Cards  Artifacts     Deltas
Sent:              53          1          0          0
Received:         218          1          0          0
Sent:              58          1          0          0
Error: Database error: attempt to write a readonly database
UPDATE event SET mtime=(SELECT m1 FROM time_fudge WHERE mid=objid) WHERE objid IN (SELECT mid FROM time_fudge);DROP TABLE time_fudge;
Received:         218          1          0          0
Total network traffic: 515 bytes sent, 858 bytes received
C:\Program Files (x86)\Fossil\fossil.exe: server returned an error - clone aborted 
```

错误信息是什么意思？我哪里做错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T02:16:18.073

好吧，我想我解决了写作问题。我已将每个化石文件的组权限更改为`www-data`，并允许该组读取和写入。

```
$ sudo chown :www-data *.fossil
$ sudo chmod g+w *.fossil 
```

这似乎解决了这个问题。

# function - 在函数内部使用结构

> ID：14420893
> 
> 赞同：0
> 
> 时间：2013-01-20T01:43:48.727
> 
> 标签：function, class, pointers, struct, linked-list

我有一个结构、文件和一个包含函数的类。我正在尝试在我的函数中创建结构的链接列表，但我不太明白如何去做！到目前为止，这是我为这部分代码所做的工作：

```
#include <iostream> 

using namespace std;

class myPrintSpool
{
public:
    void send(string);

private:
    int printSpoolSize;
    myPrintSpool *printSpoolHead;
    myPrintSpool* next;
};

struct file
{
    string fileName;
    int filePriority;
    file* next;
};

void myPrintSpool::send(string name)
{
    //Adds to linked list
    file file;

    myPrintSpool* file = new myPrintSpool;

    if(printSpoolHead == NULL)
    {
        printSpoolHead = file;
    }
    else
    {
        file->next = printSpoolHead;
        printSpoolHead = file;
    }

    printSpoolSize++;
} 
```

我在函数内发送一个字符串，以便当用户输入要发送的文件名时，它将结构的名称更改为该文件名，而结构文件更改为该输入名称。但是，我不确定该怎么做，因为我无法首先让上述部分正常工作。

提前感谢您，并感谢您抽出宝贵时间帮助我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T03:04:22.183

自从我做过任何 C++ 以来已经有一段时间了，所以这一切都来自回忆。在您提供的代码中，您没有实例化一个类。您正在为一个分配内存。如果您想为该内存分配一个新类：

```
myPrintSpool printSpool = new myPrintSpool();
myPrintSpool *file = &printSpool; 
```

我对您实际在做什么感到有些困惑。似乎 printSpoolHead 将始终等于当前的 myPrintSpool 对象，如果它不是第一个实例化的对象，它会指向自身。

由于您没有具体说明错误的位置，因此请执行一个简单的输出以验证该函数正在执行您认为应该（或正在）执行的操作。

编辑：实际上，我记得被 C++ 实例化抛弃了，所以它可能是：

```
myPrintSpool printSpool; 
```

# php - 通过 SimpleXMLElement 循环访问属性

> ID：14420895
> 
> 赞同：3
> 
> 时间：2013-01-20T01:44:32.550
> 
> 标签：php, xml, simplexml

我正在尝试使用 SimpleXML 检索的过程数据并且遇到了很大的困难。我在这里阅读了很多关于这个主题的主题，它们看起来都像我正在做的事情，但我的却没有工作。这是我所拥有的：

```
<ROOT>
    <ROWS COMP_ID="165462">
    <ROWS COMP_ID="165463">
</ROOT> 
```

我的代码：

```
$xml = simplexml_load_file('10.xml');
foreach( $xml->ROWS as $comp_row ) {
    $id = $comp_row->COMP_ID;
} 
```

当我在调试器中逐步执行此操作时，我可以看到 $id 没有设置为 COMP_ID 的字符串值，而是变成了一个包含 CLASSNAME 对象的 SimpleXMLElement 本身。我已经尝试了许多解决此属性的变体，但都没有奏效，包括 $comp_row->attributes()->COMP_ID 等。

我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T04:04:32.703

SimpleXML 是一个类似数组的对象。备忘单：

*   **无前缀子元素**作为数字索引或可遍历
    *   不包括带前缀的元素（**注意**，我的真正意思是带*前缀*的，而不是*空命名空间*！命名空间`SimpleXMLElement`的处理很奇怪，而且可以说是被破坏了。）
    *   第一个孩子：`$sxe[0]`
    *   `SimpleXMLElement`具有匹配元素子集的新元素： `$sxe->ROWS`，`$sxe->{'ROWS'}`
    *   迭代孩子：`foreach ($sxe as $e)`，`$sxe->children()`
    *   文字内容：`(string) $sxe`. `SimpleXMLElement`总是返回另一个`SimpleXMLElement`，所以如果你需要一个字符串*显式地转换它*！
*   **前缀子元素**：
    *   `$sxe->children('http://example.org')`返回一个新`SimpleXMLElement`的，其中包含匹配命名空间中的元素，*命名空间被剥离*，因此您可以像上一节一样使用它。
*   **空命名空间中的属性**作为键索引：
    *   具体属性：`$sxe['attribute-name']
    *   所有属性：`$sxe->attributes()`
    *   `$sxe->attributes()`返回一个特殊`SimpleXMLElement`的，将属性显示为子元素*和属性，因此以下**两者*都有效：
    **   `$sxe->attributes()->COMP_ID`*   `$a = $sxe->attributes(); $a['COMP_ID'];`*   属性值：强制转换为字符串`(string) $sxe['attr-name']`*
**   **其他命名空间中的属性**：
    *   所有属性：`$sxe->attributes('http://example.org')`
    *   具体属性：`$sxe_attrs = $sxe->attributes('http://example.org'); $sxe_attrs['attr-name-without-prefix']`*

 *你想要的是：

```
$xml = '<ROOT><ROWS COMP_ID="165462"/><ROWS COMP_ID="165463"/></ROOT>';

$sxe = simplexml_load_string($xml);

foreach($sxe->ROWS as $row) {
    $id = (string) $row['COMP_ID'];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T01:49:20.873

你不见了...

```
foreach( $xml->ROWS as $comp_row ) {
    foreach ($comp_row->attributes() as $attKey => $attValue) {
        // i.e., on first iteration: $attKey = 'COMP_ID', $attValue = '165462'
    }
} 
```

[PHP 手册：SimpleXMLElement::attributes](http://php.net/manual/en/simplexmlelement.attributes.php)*

# android - Vector 仅从 Member 获取最后一个值

> ID：14420896
> 
> 赞同：-1
> 
> 时间：2013-01-20T01:44:37.067
> 
> 标签：android, arrays, listview, vector

我正在尝试使用 Vector 从文本文件中添加文本视图，但我遇到了问题。在设置使用 Tokenizer 获取信息的数组时，我打印“mName”的值，它会从文本文件中获取所有值。但是当我将“mName”分配给 TextView 时，我只能从列表中获取最后一个名称..

这是代码：

数组和 TextFile 初始化 - ：

```
AssetManager assets = mContext.getAssets();

    try {
        br = new BufferedReader(new InputStreamReader(
                assets.open("country_list")));
        while ((sCurrentLine = br.readLine()) != null) {
            StringTokenizer tokenizer = new StringTokenizer(sCurrentLine,
                    ",");
            int count = 0;

            String[] stringArr = new String[3];

            while (tokenizer.hasMoreTokens()) {
                String tokenOrginizer = tokenizer.nextToken();
                stringArr[count] = tokenOrginizer;
                count++;
                mVector = new Vector<Country>();

            }

            Country country = new Country(stringArr[0],
                    Integer.parseInt(stringArr[1]),
                    Integer.parseInt(stringArr[2]));
            mVector.add(country);
            System.out.println(stringArr[0]);
            for (int i = 0; i < mVector.size(); i++) {
                System.out.println("Vector : " + mVector.get(i).getmName());  
                //here i see all the values when printing
            } 
```

GetView 方法 - ：

```
public int getCount() {
    // TODO Auto-generated method stub
    return mVector.size();
}

@Override
public Object getItem(int item) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public long getItemId(int itemId) {
    // TODO Auto-generated method stub
    return 0;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    TextView tv;
    if (convertView == null) {
        tv = new TextView(mContext);
    } else {
        tv = (TextView) convertView;
    }

    for (int i = 0; i < mVector.size(); i++) {
        tv.setText(mVector.get(i).getmName());
        // i have a feeling that this is where i do something wrong

    }

    return tv;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T08:05:04.220

`Vector`每次`getView`调用该方法时，您只看到 中的最后一项是正常的，您将文本设置在`for`循环中，迭代**所有**值`mVector`（并且您为 设置的最后一个文本`TextView`是 中的最后一个值`Vector`）。所以，而不是：

```
for (int i = 0; i < mVector.size(); i++) {
        tv.setText(mVector.get(i).getmName());
        // i have a feeling that this is where i do something wrong
        // your feeling is right, why the loop?!?  
} 
```

你会想要：

```
//...
if (convertView == null) {
    tv = new TextView(mContext);
} else {
    tv = (TextView) convertView;
} 
tv.setText(mVector.get(position).getmName());
return tv; 
```

另外，使用 an`ArrayList`而不是`Vector`.

# css - 如何从引导功能在 CSS 中创建新类

> ID：14420905
> 
> 赞同：0
> 
> 时间：2013-01-20T01:46:27.207
> 
> 标签：css, twitter-bootstrap, sass

我正在努力将 bootstrap css 从我的代码中移出。

我想构建可以从我的 .css（实际上是 .scss）文件中调用的各种类。

CSS 和我一直在走不同的路，但我现在只是在学习它。

我想在不同的 CSS 类中构建这样的东西：-

```
<div class="well span4"> 
```

CSS

```
.datainput {  
well; span4  #<<<<this is where I get lost.  
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:05:20.633

在 Sass 中，类是这样扩展的：

```
.datainput {
    @extend .well;
    @extend .span4;
} 
```

这将生成如下所示的输出：

```
.well, .datainput {
    // styles here
}

.span4, .datainput {
    // styles here
} 
```

如果你使用的是 LESS，这是 TB 的写法，它看起来像这样：

```
.datainput {
    .well;
    .span4;
} 
```

# c++ - 函数模板签名

> ID：14420908
> 
> 赞同：5
> 
> 时间：2013-01-20T01:46:45.787
> 
> 标签：c++, templates, language-lawyer

是什么决定了两个函数模板声明是声明同一个模板，还是同名的重载？

答案的开头在 3.5p9 中找到：

> 两个相同的名称（第 3 条）并且在不同的范围内声明应表示相同的变量、函数、类型、枚举器、模板或命名空间，如果
> 
> *   两个名称都有外部链接，否则两个名称都有内部链接并在同一个翻译单元中声明；和
>     
>     
> *   两个名称都指同一个命名空间的成员或同一个类的成员，而不是继承；和
>     
>     
> *   当两个名称都表示函数时，函数的参数类型列表（8.3.5）是相同的；和
>     
>     
> *   当两个名称都表示函数模板时，签名 (14.5.6.1) 是相同的。

非模板非成员函数的签名是（1.3.17）：

> **签名**
> 
> <function> 名称、参数类型列表 (8.3.5) 和封闭命名空间（如果有）
> 
> [*注意：*签名用作名称修改和链接的基础。——*尾注*]

8.3.5p5 节已经定义了两次提到的*参数类型列表。*该段落描述了如何根据声明的类型调整函数参数的实际类型，用指针替换数组和函数，以及丢弃顶级*cv-qualifiers*。然后，

> 转换后的参数类型的结果列表以及省略号或函数参数包的存在与否是函数的*参数类型列表*。

所以在非模板的情况下，*parameter-type-list*显然是类型的概念语义列表（可能还有一个花哨的结尾），而不是标记序列或句法构造。正如我们所料，以下是违反 ODR 的，因为两个定义都定义了相同的函数：

```
void f(int, int*) {}
void f(int p, decltype(p)*) {} 
```

在模板案例中，我们有 (1.3.18)：

> **签名**
> 
> <function template> 名称、参数类型列表 (8.3.5)、封闭命名空间（如果有）、返回类型和模板参数列表

现在考虑：

```
template<typename T> void g(int, int*, T, T*) {}               // #1
// template<typename T> void g(int p, decltype(p)*, T, T*) {}  // #2
template<typename T> void g(int, int*, T q, decltype(q)*) {}   // #3 
```

g++ -std=c++0x 版本 4.6.3 抱怨定义 #1 和 #2 定义了相同的函数，但接受 #1 和 #3 作为重载没有问题。（它还认为#3 比#1 更专业，没有办法调用#1，但这是一个切题问题。）#2 和#3 之间的主要区别在于`q`类型相关而`p`不是类型相关。所以我猜在`decltype(q)`模板实例化之前无法确定的含义？标准是否保证这种行为？

对于函数模板，必须允许*parameter-type-list*的含义包括尚未被实例化替换的模板参数，因此依赖名称等等。但这使得如果可能的话，要知道两个声明是否等价就变得很棘手。

14.5.6.1 第 5-6 段解决了类似的问题，它定义了*等效*表达式和*等效*函数模板声明（相同的标记序列，除了不同的声明可能对模板参数使用不同的标识符）、*功能等效*的表达式和*功能等效*的函数模板声明（实例化后相同），要求：

> 如果一个程序包含功能等价但不等价的函数模板声明，则该程序是非良构的；不需要诊断。

第 5 段中的一个示例演示了安全等效的函数模板：

```
template <int I, int J> void f(A<I+J>);  // #1
template <int K, int L> void f(A<K+L>);  // same as #1 
```

第 7 段中的一个例子表明违反了该规则：

```
// Ill-formed, no diagnostic required
template <int I> void f(A<I>, A<I+10>);
template <int I> void f(A<I>, A<I+1+2+3+4>); 
```

但这不适用于`g`上面的示例函数。 `T*`并且`decltype(q)*`在类型等价的一些类似定义下可能被认为在功能上是等价的，但第 14.5.6.1 节只说明了表达式的替换，而不是类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T17:03:41.117

该标准有一个安静的未明确定义的类型等价规则，主要基于限定名称的语法，但模板参数是参数列表中的位置和该列表的嵌套深度（即它是否是成员模板之一或封闭类模板）。

typedef 会记住特定的依赖类型。然而，14.4p2 的 decltype 类型是一个独特的类型，并不等同于 T。

# jquery - 当我使用 Internet 应用程序模板启动一个新的 MVC4 项目并使用 NuGet 获取 JQuery 1.9 时，在进行任何更改之前出现错误

> ID：14420909
> 
> 赞同：0
> 
> 时间：2013-01-20T01:46:47.597
> 
> 标签：jquery, asp.net-mvc-4

在 Chrome 或 Firefox 中没有问题，但在 IE9 中我收到“Microsoft JScript 运行时错误：对象不支持属性或方法‘live’”异常。有没有其他人遇到过这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:59:50.113

jQuery 1.9 removed methods previously marked as deprecated. [**live()**](http://api.jquery.com/live/) is one of them.

When using jQuery 1.9 it is recommended to use `jquery-migrate-1.0.0.js` along with it when upgrading.

The migrate file contains all of the deprecated methods and in addition writes deprecation notices to the console.

In your case off course you are starting a new project but it looks like you would benefit from using the migrate file too as it will let you know if you start using deprecated features.

Have a look at the release notes posted on the jQuery Blog for all the details and instructions:
[**jQuery 1.9 Final, jQuery 2.0 Beta, Migrate Final Released**](http://blog.jquery.com/2013/01/15/jquery-1-9-final-jquery-2-0-beta-migrate-final-released/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T01:48:14.270

`.live()`在 jQuery 中已被弃用了一段时间，并在 1.9 中被删除。

改为使用`.on()`适当的参数。弃用的替代品`$('foo').live('evt', func)`是`$(document).on('evt', 'foo', func)`

但是，与其`document`更好地使用更接近始终存在的元素的东西。

# jquery - 在 jQuery 中命名函数

> ID：14420913
> 
> 赞同：-4
> 
> 时间：2013-01-20T01:47:19.763
> 
> 标签：jquery, function

我想将这个 jQuery 函数命名为“showElements”。我怎样才能做到这一点？

```
$(function () {
    $("#sortable").sortable({
        revert: true
    });
    $("#draggable").draggable({
        connectToSortable: "#sortable",
        helper: "clone",
        revert: "invalid"
    });
    $("ul, li").disableSelection();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:49:14.023

首先，您必须包含[jQuery](http://en.wikipedia.org/wiki/JQuery)库，然后：

```
<script type="text/javascript">
    function showElements()
    {
        $("#sortable").sortable({
            revert: true
        });
        $("#draggable").draggable({
            connectToSortable: "#sortable",
            helper: "clone",
            revert: "invalid"
        });
        $("ul, li").disableSelection();
    }
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T01:50:53.347

在这种情况下，不需要将函数包装在 jQuery 全局 ($) 中。只需像这样创建函数：

```
function showElements() {
$("#sortable").sortable({
    revert: true
});
$("#draggable").draggable({
    connectToSortable: "#sortable",
    helper: "clone",
    revert: "invalid"
});
$("ul, li").disableSelection();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T01:49:28.017

就像是：

```
<script type="text/javascript">
    var showElements = function () {
        $("#sortable").sortable({
            revert: true
        });
        $("#draggable").draggable({
            connectToSortable: "#sortable",
            helper: "clone",
            revert: "invalid"
        });
        $("ul, li").disableSelection();
    };

    $(function(){
        showElements();
    });
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T01:51:49.183

作为一个 jQuery 插件：

```
(function ($,undefined) {
    $.showElements = function () {
        $("#sortable").sortable({
        revert: true
        });
        $("#draggable").draggable({
        connectToSortable: "#sortable",
        helper: "clone",
        revert: "invalid"
        });
        $("ul, li").disableSelection();
    };
}(jQuery)); 
```

像这样使用它：`$.showElements();`

作为一个常规功能：

```
var showElements = function () {
    $("#sortable").sortable({
    revert: true
    });
    $("#draggable").draggable({
    connectToSortable: "#sortable",
    helper: "clone",
    revert: "invalid"
    });
    $("ul, li").disableSelection();
}; 
```

像这样使用它：`showElements();` 脆弱：你正在污染全球范围

# html - rails3 辅助方法返回大小

> ID：14420915
> 
> 赞同：0
> 
> 时间：2013-01-20T01:47:35.350
> 
> 标签：html, ruby-on-rails, ruby, gravatar

我在 Rails3 应用程序的 User_helper 中有一个 gravatar 方法。代码如下：

```
module UsersHelper
  def gravatar_for(user, options = {:size => 50})
    gravatar_image_tag(user.email.downcase, :alt => user.name,
                                            :class => "gravatar",
                                            :gravatar => options)
  end
end 
```

目前，此方法将默认大小设置为 50 像素，但在整个应用程序的某些实现中会更改此大小。当 gravatar 的大小大于 30px 时，我希望 gravatar 成为“圆形”类（以及“gravatar”类）的一部分。我该怎么做？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T02:08:25.997

```
module UsersHelper
  def gravatar_for(user, options = {:size => 50})
    options[:size] > 30 ? @class = "gravatar round" : @class = "gravatar"
    gravatar_image_tag(user.email.downcase, :alt => user.name,
                                            :class => @class,
                                            :gravatar => options)
  end
end 
```

# c# - 如何删除列表框中的许多项目？

> ID：14420916
> 
> 赞同：-3
> 
> 时间：2013-01-20T01:47:38.100
> 
> 标签：c#, listbox

如何从列表框中删除？

同时删除多个索引

请注意，我使用汽车类型列表及其详细信息列表框中的对象具有汽车类型成本率

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:56:51.680

You have to use loop.

Something like this:

```
List<int> indexesToDelete = new List<int>();

// add items you want to remove to List like this:
indexesToDelete.Add(1);
indexesToDelete.Add(2);
indexesToDelete.Add(4);

// loop will execute code inside inside for all items added to list
foreach (int indexToDelete in indexesToDelete)
{
    listbox1.RemoveAt(indexToDelete);
} 
```

Edit: itemsToDelete renamed to indexesToDelete in code.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T01:53:03.217

**更新**：如果要删除所有选定的项目，如评论：

```
foreach (int i in listBox1.SelectedIndices)
    listBox1.Items.RemoveAt(i); 
```

如果您想删除所有项目，请使用`Clear`：

```
listBox1.Items.Clear(); 
```

如果要在特定索引处删除，请使用`RemoveAt`：

```
listBox1.Items.RemoveAt(0); 
```

或循环：

```
for(int i = 0; i < listBox1.Items.Count; i++)
    listBox1.Items.RemoveAt(); 
```

如果要删除特定项目，请使用`Remove`：

```
Car car = (Car) listBox1.Items[0];
listBox1.Items.Remove(car); 
```

# android - Android - 无法在服务类中设置变量

> ID：14420917
> 
> 赞同：-1
> 
> 时间：2013-01-20T01:47:41.870
> 
> 标签：android, service

我有一个名为 ForegroundService 的服务类，在 onstartCommand 中我需要设置一个变量：

```
@Override
   public int onStartCommand(Intent intent, int flags, int startId) {
     VariableManaging.isStop=false; //<==variable i need to set. Here i got an exceptioninInitializer error when my bootReceiver start service on startup. If service is start by button on activity got no error. 
   } 
```

变量管理类开始于：

```
static boolean isStop=true;
static ProgressDialog progressDialog=new ProgressDialog(Main.activity); //<== I noted that if i remove this all working well 
```

有办法设置该变量吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:59:48.183

Your code is correct but the method `onStartCommand()` will NOT be called unless you start this service like this:

```
startService(new Intent(getApplicationContext(), ForegroundService.class)); 
```

# php - 杀死fork进程

> ID：14420918
> 
> 赞同：1
> 
> 时间：2013-01-20T01:47:51.340
> 
> 标签：php, pcntl

我想写一个 php 脚本在后台运行。这需要pcntl_fork。我使用这个函数来分叉一个孩子：

```
function launchchild($programexe,$programvars) 
{ 
//foreach ($tasks as $key => $v){ 
switch ($pid = pcntl_fork()) { 
  case -1: 
     // @fail 
     die('Fork failed'); 
     break; 

  case 0: 
     // @child: Include() misbehaving code here 
     pcntl_exec($programexe,$programvars);
     break; 

  default: 
     // @parent 
     //pcntl_waitpid($pid, $status); 
     break; 
} 

//print "Done! :^)\\n\\n"; 
} 
```

我在一分钟内用下面这样的片段来称呼它：

```
$parameters = array('/Applications/XAMPP/xamppfiles/htdocs/ping/senario2/master/gather_checks.php', $serialize_triagger, $server_list[$server_choose]);
launchchild('/Applications/XAMPP/xamppfiles/bin/php',$parameters); // fork a child for parallel processing. 
```

所以，它只能优雅地工作几分钟。我用 'ps -ax | 检查了这个过程 grep php'。我看到有这么多的过程永远不会结束，直到代码给出 35 错误，这意味着我们没有更多的内存来运行它！这是 'ps -ax | 的结果 grep php'

```
ps -ax | grep php
12020 ttys001    0:00.07 /Applications/XAMPP/xamppfiles/bin/php /Applications/XAMPP/xamppfiles/htdocs/ping/senario2/master/main.php
12021 ttys001    0:00.00 (php-5.3.1)
12022 ttys001    0:00.00 (php-5.3.1)
12025 ttys001    0:00.00 (php-5.3.1)
12028 ttys001    0:00.00 (php-5.3.1)
12037 ttys001    0:00.00 (php-5.3.1)
12040 ttys001    0:00.00 (php-5.3.1)
12043 ttys001    0:00.00 (php-5.3.1) 
```

当我取消注释 //pcntl_waitpid($pid, $status); 它就像一个魅力，没有任何问题，永远。但我不希望父母等待孩子的工作。任何事情都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:17:23.183

PHP 的 PCNTL 函数，如`pcntl_fork`，不应该在 Web 服务器上使用，因为子进程最终不会被正确清理。（毫无疑问，您已经注意到了。）这些函数主要用于独立的 PHP 守护程序，以及在此处不适用的特殊情况。

改用更高级别的过程控制功能[`proc_open()`](http://php.net/proc_open)。如果您需要在后台运行进程，请通过带有`&`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T02:05:45.813

您正在启动另一个程序/脚本，因此您不需要任何分叉，只需使用`system()`和`screen`获取终端（idk if & works）

# ajax - 跨域请求返回 Uncaught SyntaxError: Unexpected token : error

> ID：14420920
> 
> 赞同：1
> 
> 时间：2013-01-20T01:48:12.030
> 
> 标签：ajax, json, jquery, cross-domain, jsonp

我正在尝试获取在远程服务器中创建的 JSON 对象并将其拉到页面上。我已经尝试了“数据类型”、“类型”、回调等的所有组合，但不断收到相同的“意外令牌：”错误。

这是我尝试过的代码：

```
$(function(){
    var url = "http://someurl.com/api/count?url=http://www.yyets.com";
    $.jsonp({
        url: url,
        corsSupport: true, // if URL above supports CORS (optional)
        jsonpSupport: true, // if URL above supports JSONP (optional)
        jsonp:'jsonp',
        dataType: 'jsonp',
        success: function(data, status){
            alert("success");
            console.log(data);
        },
        complete: function(data){
          alert('Completed.');
          console.log(data);
        },
        error: function(XHR, textStatus, errorThrown){
            alert("ERREUR: " + textStatus);
            alert("ERREUR: " + errorThrown);
        }
    });
}); 
```

在控制台上，意外的令牌错误指向 url：

> [未捕获的语法错误：意外令牌： http](http://someurl.com/api/count?url=http://www.yyets.com&_xx1358645456540=1) ://someurl.com/api/count?url= http://www.yyets.com&_xx1358645456540=1

我还做了一些错误处理：

```
error: function (jqXHR, textStatus, errorThrown) {
             if (window.console) console.log("Error... " + textStatus + "        " + errorThrown);

       } 
```

这次它抛出，

> Uncaught SyntaxError: Unexpected token : count:1
> Error... parsererror 错误: jQuery19005587419604416937_1358646210172 未被调用

你能帮忙吗！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:59:42.553

The page which called by javascript have to have that header

```
header('Access-Control-Allow-Origin: *'); 
```

# c - 在 C 中对齐输出值

> ID：14420924
> 
> 赞同：3
> 
> 时间：2013-01-20T01:48:19.593
> 
> 标签：c, printf, stdio

所以我正在开发一个需要格式化输出的程序。输出应该是对齐的，并且它使用小数字这样做：

![这有效](../Images/481c7662f7a29cd4b9954f1a84b3c9c5.png)

但是当我给出大数字时，它不再起作用：

![这不起作用](../Images/f77228ad438ead0ad1b9a1d6ea226a24.png)

我的代码确实是，但这是打印主要输出的部分：

```
/* The following code prints out the data */

    printf("\n\nStatistics: \n\n");
    printf("Descrip\t\tNumber:\t\tTotal:\t\tAverage:\n\n");
    printf("Normal\t\t%d\t\t%d\t\t%d\n\n",normal_counter,normal_total,normal_average);
    printf("Short\t\t%d\t\t%d\t\t%d\n\n",short_counter,short_total,short_average);
    printf("Long\t\t%d\t\t%d\t\t%d\n\n",long_counter,long_total,long_average);
    printf("Overall\t\t%d\t\t%d\t\t%d\n\n",overall_counter,overall_total,overall_average); 
```

如何让输出对齐？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T01:55:05.767

使用可用的 printf 格式化程序功能：

```
$ cat t.c
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    printf("%-12s%-12d%-12d\n", "a", 2989, 9283019);
    printf("%-12s%-12d%-12d\n", "helloworld", 0, 1828274198);
    exit(0);
}

$ gcc -Wall t.c
$ ./a.out 
a           2989        9283019     
helloworld  0           1828274198 
```

如您所见，它甚至可以使用字符串，因此您可以通过这种方式对齐字段。

# android - WebView 进度对话框不会关闭

> ID：14420930
> 
> 赞同：1
> 
> 时间：2013-01-20T01:49:26.493
> 
> 标签：android, android-webview, android-progressbar

当页面加载时，我会显示**Progress Dialog**，并在页面完成加载时将其关闭。之后，如果我向下滚动时加载图片，**进度对话框**将显示，但在图片加载后不会消失。我该如何解决这个问题？

这是我的代码，使用它，你就会明白我的意思。如果您能提供帮助，我将不胜感激。

```
import android.app.Activity;
import android.app.ProgressDialog;
import android.os.Bundle;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class MainActivity extends Activity {

    // Declaring
    WebView browser;
    ProgressDialog pd;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // Initializing
        browser = (WebView) findViewById(R.id.webView1);

        browser.getSettings().setJavaScriptEnabled(true);
        browser.getSettings().setLoadWithOverviewMode(true);
        browser.getSettings().setUseWideViewPort(true);
        browser.getSettings().setBuiltInZoomControls(true);

        // Loading
        browser.loadUrl("http://www.tumblr.com/tagged/cool%20pictures");

        // Progress Dialog
        pd = ProgressDialog.show(MainActivity.this, "",
                "Loading. Please wait...", true);

        browser.setWebViewClient(new WebViewClient() {
            public boolean shouldOverrideUrlLoading(WebView view, String url) {
                try {
                    view.loadUrl(url);
                } catch (Exception e) {
                    e.printStackTrace();

                }
                return true;
            }

            public void onLoadResource(WebView view, String url) {
                try {

                    if (pd.isShowing() == false) {
                        pd = ProgressDialog.show(MainActivity.this, "",
                                "Loading. Please wait...", true);
                    }           

                } catch (Exception e) {
                    e.printStackTrace();

                }
            }

            public void onPageFinished(WebView view, String url) {
                if (pd.isShowing()) {
                    pd.dismiss();

                }

            }

        });

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-01T16:10:11.043

经过3个小时的搜索，我找到了解决方案。我没有在**onLoadResource**方法中显示**ProgressDialog**，而是使用**了 onPageStarted**方法。所以我的代码看起来像这样。

 ****```
import android.graphics.Bitmap;

public void onPageStarted(WebView view, String url, Bitmap favicon) {

            if (pd.isShowing() == false) {
                pd = ProgressDialog.show(MainActivity.this, "",
                        "Loading. Please wait...", true);

            }
        } 
```****

# iphone - 当我的应用程序正在运行时，如何以编程方式获取实时屏幕截图？

> ID：14420933
> 
> 赞同：0
> 
> 时间：2013-01-20T01:50:05.457
> 
> 标签：iphone, ios, cocoa-touch, uiview

我只想分享 UIView vie 电子邮件、FB 或任何用户想要的屏幕截图！以下代码仅采用 UIView 的原件，没有输入文本，也没有更改图像

```
CGRect rect = [mainView bounds];
    UIGraphicsBeginImageContextWithOptions(rect.size,YES,0.0f);
    CGContextRef context = UIGraphicsGetCurrentContext();
    [mainView.layer renderInContext:context];
    UIImage *capturedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T07:31:11.233

您应该能够在[此答案](https://stackoverflow.com/questions/2200736/how-to-take-a-screenshot-programmatically)中使用其中一种解决方案，具体取决于它是否是视网膜设备。

# r - 文件错误（文件，“rt”）：complete.cases 程序中的“描述”参数无效

> ID：14420936
> 
> 赞同：36
> 
> 时间：2013-01-20T01:50:34.377
> 
> 标签：r

我正在编写一个 R 函数，它读取一个充满文件的目录并报告每个数据文件中完全观察到的案例的数量。该函数返回一个数据框，其中第一列是文件名，第二列是完整案例的数量。

如，

```
id nobs
1  108
2  345
...
etc 
```

这是我写的函数：

```
complete <- function(directory, id = 1:332) {

  for(i in 1:332) {
    path<-paste(directory,"/",id,".csv",sep="")
    mydata<-read.csv(path)
    #nobs<-nrow(na.omit(mydata))
    nobs<-sum(complete.cases(mydata))
    i<-i+1
  }

  completedata<-c(id,nobs)
} 
```

我执行功能：

```
complete("specdata",id=1:332) 
```

但我收到此错误：

```
Error in file(file, "rt") : invalid 'description' argument 
```

我还尝试了`traceback()`调试代码的函数，它给出了以下输出：

```
traceback()
# 4: file(file, "rt") at #6
# 3: read.table(file = file, header = header, sep = sep, quote = quote, 
#    dec = dec, fill = fill, comment.char = comment.char, ...) at #6
# 2: read.csv(path) at #6
# 1: complete("specdata", id = 1:332) 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-01-20T01:57:17.377

没有一个完全可重现的例子很难说，但我怀疑你的问题是这一行：

```
path<-paste(directory,"/",id,".csv",sep="") 
```

`id`这是一个向量，因此 path 成为字符串的向量，当您调用时，`read.csv`您会一次传递所有路径，而不仅仅是一个。尝试将上面的行更改为

```
path<-paste(directory,"/",id[i],".csv",sep="") 
```

看看这是否有效。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-20T02:12:05.607

您的文件路径似乎有问题。您将完整的向量 id =c(1:332) 传递给文件路径名。如果您的文件名为 1.csv、2.csv、3.csv 等。
您可以更改此行：

```
path<-paste(directory,"/",id,".csv",sep="") 
```

到

```
path<-paste(directory,"/",i,".csv",sep="") 
```

并省略或修改函数的 id 输入。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-12-06T22:56:17.827

除了使用 a`for`来读取数据，您可以尝试`sapply`. 例如

> `mydata <- sapply(path, read.csv)`.

由于`path`是一个向量，`sapply`将迭代该向量并应用于`read.csv`它。因此，将不需要`for`循环，并且您的代码将更加简洁。

从那里您将获得`matrix`每个文件及其各自的信息，您可以从中提取观察结果。

要查找观察结果，您可以执行`mydata[2,1][[1]]`. 请记住，行将是您的因素，而您的列将是您的文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-04-03T18:17:25.513

我正在解决确切的问题..目录“specdata”中的文件名以 001.csv 和 002.csv.... 099.csv 一直命名为文件 332.csv 但是，当您回忆 id= 1 然后您的文件名变为目录中不存在的 1.csv 。尝试使用此函数获取每个 id 文件的路径。

```
filepaths <- function (id){
    allfiles = list.files(getwd())
    file.path(getwd(), allfiles[id])
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-22T07:44:18.177

我在这句话中遇到了同样的问题：

```
Browse[2]> read.csv(list.files(".", "XCMS-annotated-diffreport--.*csv$"), row.names = 1)
Error in file(file, "rt") : invalid 'description' argument 
```

然后，我发现在同一路径中有两个不同的 csv 文件，如下所示：

```
Browse[2]> list.files(".", "XCMS-annotated-diffreport--.*csv$")
[1] "XCMS-annotated-diffreport--1-vs-2-Y.csv" "XCMS-annotated-diffreport--1-vs-2.csv" 
```

当我删除一个文件时，它又可以工作了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-04T02:57:46.067

我遇到了这个问题，因为我试图对数据框而不是向量运行 for 循环：

```
 ids <- th[th$nobs > threshold,]
  for(i in ids) { 
```

这就是变量“ids”的样子：

```
 id nobs
2     2 1041
154 154 1095
248 248 1005 
```

本来应该：

```
 ids <- th[th$nobs > threshold,]
  for(i in ids$id) { 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-20T21:08:54.353

将对象 id 更改为 i - 因为您在 for 循环中使用迭代对象 i ie path<-paste(directory,"/",id,".csv",sep="") 到 ie path<-paste(directory," /",i,".csv",sep="")

# opengl - 用CG代替GLSL可行吗？

> ID：14420938
> 
> 赞同：5
> 
> 时间：2013-01-20T01:50:43.037
> 
> 标签：opengl, glsl, shader, cg

[http://http.developer.nvidia.com/Cg/TessellationControlShader.html](http://http.developer.nvidia.com/Cg/TessellationControlShader.html)

我有一些关于CG的问题。

CG 支持什么 OpenGL 版本？他们在他们的网站上声明

> Opengl 功能要求
> 
> OpenGL 1.0

这对我来说似乎有点奇怪。对我来说，这意味着我至少需要 OpenGL 1.0 才能使用 CG 中的所有 OpenGL 功能。所以几乎所有新的 OpenGL 功能都不见了？

计算机着色器似乎也不见了

> GeometryShader、PixelShader、TessellationEvaluationShader、VertexShader、FragmentProgram、GeometryProgram、TessellationControlProgram、TessellationEvaluationProgram、VertexProgram

CG 现在是替代 GLSL 4.x 的可行替代方案吗？我可以在 CG 中编写所有可以在 GLSL 4.3 中编写的着色器吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-30T19:23:07.020

> CG 现在是替代 GLSL 4.x 的可行替代方案吗？我可以在 CG 中编写所有可以在 GLSL 4.3 中编写的着色器吗？

不会。虽然某些 OpenGL 4.x 功能（例如曲面细分）从 Cg 3.1 开始公开，但其他功能则没有。

Cg 3.1（及其 OpenGL 名称）中明显缺失的功能包括：

*   计算着色器
*   原子计数器
*   着色器可写存储块（着色器存储块）
*   着色器可写纹理（图像加载/存储）
*   运行时着色器功能选择（着色器子例程）

一般来说，Cg 往往落后于最新的 OpenGL 版本两三年。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-30T21:22:53.953

[Cg 已被 NVidia 淘汰，因此不会继续开发](https://developer.nvidia.com/cg-toolkit)：

> Cg Toolkit 是一个传统的 NVIDIA 工具包，不再处于积极开发或支持之下。Cg 3.1 是我们的最后一个版本，虽然我们继续向开发人员提供它，但我们不建议在新的开发项目中使用它，因为未来的硬件功能可能不受支持。

所以我认为最好的答案是不。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-20T02:24:59.677

我很确定*OpenGL-1.0*是一个错字。DirectX-11 是关于您使用*OpenGL-4.0*获得的功能级别。**现在看看小键盘上4**正下方是什么键。

事实上，没有一个 NVidia GPU 只支持低至 OpenGL-1.0 的 OpenGL 配置文件。OpenGL-1.0 可以追溯到 20 年前。

* * *

> CG 现在是替代 GLSL 4.x 的可行替代方案吗？

好吧，我个人看不出使用 Cg 的理由，除非你想用一组通用的着色器同时支持 OpenGL 和 DirectX。但是你为什么想要跨 API 兼容性呢？如果您的目标是可移植性，那么 OpenGL 显然胜过 DirectX。

恕我直言，继续使用 Cg 的主要原因是，如果您必须维护已经使用 Cg 的旧产品。请记住，在 OpenGL 拥有高级着色语言之前很久就引入了 Cg。

> 我可以在 CG 中编写所有可以在 GLSL 4.3 中编写的着色器吗？

是的。

# jquery - jQuery 从图像 src 属性中删除文本

> ID：14420939
> 
> 赞同：1
> 
> 时间：2013-01-20T01:50:45.407
> 
> 标签：jquery

使用 jQuery，我想在悬停时更改 src 属性。例如，我有以下 HTML：

```
<img src="convert.php?image=images/example.jpg" alt="#" /> 
```

悬停时，我想删除“convert.php？” 字符串，以便 HTML 为：

```
<img src="image=images/example.jpg" alt="#" /> 
```

一定要简单吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T01:53:35.173

回答了自己的问题。找到了这个片段。

```
$('.item img').each(function(e){
    var src = $(this).attr('src');
    $(this).hover(function(){
      $(this).attr('src', src.replace('convert.php?image=', ''));
    }, function(){
     $(this).attr('src', src);
    });
  }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T02:16:36.117

可以使用`attr(function(){}`

`mouseleave`以下也将恢复图像

```
$(".item img").hover(function () {
      var convert='convert.php?image=';
     $(this).attr('src',function(idx, attr){
          return attr.indexOf(convert) <0 ? convert+attr : attr.replace(convert,'');
     });
}); 
```

当只有一个函数作为参数传递给悬停时，它将同时运行`mouseenter`和`mouseleave`事件

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-20T01:56:40.010

```
 $("img").hover(
      function () {
        var src = $(this).attr('src');
        jQuery.data(this, 'old_source', src);
        srcNew = src.replace("convert.php?", "");
        $(this).attr('src', srcNew);
        $(this)., srcNew);
      },
      function () {
        var src = $(this).data('old_source');
        $(this).attr('src', src);
      }
    ); 
```

# module - Rebol 模块中的单词是如何绑定的？

> ID：14420942
> 
> 赞同：20
> 
> 时间：2013-01-20T01:51:08.917
> 
> 标签：module, namespaces, code-organization, rebol, rebol3

我知道该`module!`类型为受保护的命名空间提供了比函数更好的`object!`结构`'use`。模块中的单词是如何绑定的——我注意到一些与未绑定单词相关的错误：

```
REBOL [Type: 'module] set 'foo "Bar" 
```

此外，Rebol 是如何区分模块的本地词（`'foo`）和系统函数的词（`'set`）？

*小更新，不久之后：*

我看到有一个开关改变了绑定方法：

```
REBOL [Type: 'module Options: [isolate]] set 'foo "Bar" 
```

这有什么不同？默认情况下使用这种方法有什么问题？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-27T21:54:11.603

*好的，这会有点棘手。*

在 Rebol 3 中没有系统词之类的东西，只有词。一些单词已添加到运行时库`lib`中，并且`set`是其中一个单词，恰好有一个函数分配给它。模块从 导入单词`lib`，尽管“导入”的含义取决于模块选项。这可能比你预期的更棘手，所以让我解释一下。

## 常规模块

对于初学者，我将讨论导入对于“常规”模块的含义，即那些没有指定任何选项的模块。让我们从您的第一个模块开始：

```
REBOL [Type: 'module] set 'foo "Bar" 
```

首先，您在这里有一个错误的假设：这个词`foo`不是模块*的*本地词，它与`set`. 如果要定义`foo`为本地词，则必须使用与对象相同的方法，在顶层使用该词作为集合词，如下所示：

```
REBOL [Type: 'module] foo: "Bar" 
```

`foo`和之间的唯一区别是您`set`尚未导出或添加单词。当您在模块中引用未声明为本地单词的单词时，它必须从某个地方获取它们的值和/或绑定。对于常规模块，它将代码绑定到第一个，然后通过再次将代码绑定到模块的本地上下文来覆盖它。在本地上下文中定义的任何单词都将绑定到它。任何未在本地上下文中定义的单词都将保留其旧绑定，在本例中为. 这就是“导入”对于常规模块的含义。`foo``lib``lib``lib`

在您的第一个示例中，假设您自己没有这样做，则该词`foo`没有提前添加到运行时库中。这意味着 that`foo`没有绑定到`lib`，并且由于它没有被声明为本地单词，因此它也没有绑定到本地上下文。因此，结果，`foo`根本不受任何约束。在您的代码中这是一个错误，但在其他代码中可能不是。

## 隔离模块

有一个“隔离”选项可以改变模块导入内容的方式，使其成为“隔离”模块。让我们在这里使用您的第二个示例：

```
REBOL [Type: 'module Options: [isolate]] set 'foo "Bar" 
```

当创建一个独立的模块时，模块中的每个单词，即使是嵌套代码，都会被收集到模块的本地上下文中。在这种情况下，它意味着`set`和`foo`是本地词。这些单词的初始值被设置为它们在`lib`创建模块时所具有的任何值。也就是说，如果这些词是`lib`在所有定义的。如果单词在 中没有值`lib`，则它们最初在模块中也没有值。

重要的是要注意，这种价值观的导入是一次性的。在初始导入之后，在模块外对这些单词所做的任何更改都不会影响模块中的单词。这就是为什么我们说模块是“孤立的”。对于您的代码示例，这意味着有人可以更改`lib/set`并且不会影响您的代码。

但是您错过了另一种重要的模块类型......

## 脚本

在 Rebol 3 中，脚本是另一种模块。这是您作为脚本的代码：

```
REBOL [] set 'foo "Bar" 
```

或者，如果您愿意，因为脚本头在 Rebol 3 中是可选的：

```
set 'foo "Bar" 
```

脚本也从 导入它们的单词`lib`，并将它们导入到一个孤立的上下文中，但有一点不同：所有脚本共享*相同*的孤立上下文，称为“用户”上下文。这意味着当您更改脚本中某个单词的值时，*下一个*使用该单词的脚本将在启动时看到更改。因此，如果在运行上述脚本后，您尝试运行此脚本：

```
print foo 
```

然后它将打印“Bar”，而不是`foo`未定义，即使`foo`在`lib`. 如果您以交互方式使用 Rebol 3，在控制台中输入命令并获得结果，您可能会觉得有趣，您输入的每个命令行都是一个单独的脚本。因此，如果您的会话如下所示：

```
>> x: 1
== 1
>> print x
1 
```

`x: 1`和行是单独的`print x`脚本，第二个利用第一个对用户上下文所做的更改。

用户上下文实际上应该是任务本地的，但目前让我们忽略它。

## 为什么有区别？

这是我们回到“系统功能”的地方，而 Rebol 没有它们。该`set`功能与任何其他功能一样。它可能以不同的方式实现，但它仍然是分配给正常单词的正常值。一个应用程序必须管理*很多*这样的词，这就是我们有模块和运行时库的原因。

在一个应用程序中，会有一些东西需要改变，而其他一些东西*不需要*改变，哪些东西取决于应用程序。您将需要对您的东西进行分组，以使事情井井有条或进行访问控制。会有全局定义的东西和本地定义的东西，你会希望有一种有组织的方式来将全局的东西带到本地，反之亦然，并在不止一个东西想要定义东西时解决任何冲突同名。

在 Rebol 3 中，为了方便和访问控制，我们使用模块对内容进行分组。我们使用运行时库`lib`作为收集模块导出和解决冲突的地方，以便控制导入到本地的内容，如其他模块和用户上下文。如果您需要覆盖某些内容，您可以通过更改运行时库来完成此操作，并在必要时将您的更改传播到用户上下文。您甚至可以在运行时升级模块，并让新版本的模块覆盖旧版本导出的单词。

对于常规模块，当事情被覆盖或升级时，您的模块将受益于此类更改。假设这些变化是有益的，这可能是一件好事。常规模块与其他常规模块和脚本协作以创建一个共享环境来工作。

但是，有时您需要与这些类型的更改分开。也许您需要某个功能的特定版本并且不想升级。也许您的模块将被加载到一个不太值得信赖的环境中，并且您不希望您的代码被黑客入侵。也许你只是需要让事情变得更可预测。在这种情况下，您可能希望将您的模块与这些类型的外部更改隔离开来。

隔离的不利之处在于，如果您可能想要对运行时库进行更改，您将无法获得它们。如果您的模块可以以某种方式访问​​（例如通过名称导入），那么有人可能能够将这些更改传播给您，但如果您无法访问，那么您就不走运了。希望您已经考虑过监控`lib`您想要的更改，或者直接引用这些内容`lib`。

不过，我们错过了另一个重要的问题......

## 出口

管理运行时库和所有这些本地上下文的另一部分是导出。你必须以某种方式把你的东西拿出来。最重要的因素是您不会怀疑的：您的模块是否有名称。

Rebol 3 的模块名称是可选的。起初，这似乎只是一种简化模块编写的方法（在 Carl 的原始提案中，这正是原因）。然而，事实证明，当你有一个名字时，你可以做很多事情，而当你没有名字时，你就做不到，这仅仅是因为名字是什么：一种引用某物的方式。如果你没有名字，你就无法指代某物。

这似乎是一件微不足道的事情，但这里有一些名字可以让你做的事情：

*   您可以判断模块是否已加载。
*   您可以确保一个模块只加载一次。
*   您可以判断模块的旧版本是否较早，并可能对其进行升级。
*   您可以访问之前加载的模块。

当 Carl 决定将名称设为可选时，他给了我们一种情况，即可以创建您无法执行任何这些操作的模块。鉴于模块导出的目的是在运行时库中收集和组织，我们遇到了这样一种情况，即您可能会对无法轻易检测到的库产生影响，并且每次导入时都会重新加载模块。

因此，为了安全起见，我们决定完全删除运行时库，只将这些未命名模块中的单词直接导出到正在导入它们的本地（模块或用户）上下文中。这使得这些模块实际上是私有的，就好像它们归目标上下文所有。我们处理了一个可能很尴尬的情况，并将其作为一项功能。

正是这样一个特性，我们决定通过一个`private`选项明确地支持它。将此作为显式选项有助于我们处理没有名称导致的最后一个问题：使私有模块不必一遍又一遍地重新加载。如果你给一个模块一个名字，它的导出仍然可以是私有的，但它只需要一个它正在导出的副本。

但是，命名与否，私有与否，即 3 种导出类型。

## 常规命名模块

让我们来看看这个模块：

```
REBOL [type: module name: foo] export bar: 1 
```

导入它会将一个模块添加到加载的模块列表中，默认版本为 0.0.0，并将一个单词导出`bar`到运行时库。在这种情况下，“导出”意味着将一个单词添加`bar`到运行时库（如果它不存在），并将该单词设置为该单词执行完成后`lib/bar`的值（如果尚未设置）。`foo/bar``foo`

值得注意的是，这种自动导出只发生一次，当主体`foo`完成执行时。如果您在此之后进行更改`foo/bar`，则不会影响`lib/bar`. 如果您也想更改`lib/bar`，则必须手动进行。

还值得注意的是，如果在导入`lib/bar`之前已经存在`foo`，则不会添加另一个单词。如果`lib/bar`已经设置为一个值（不是未设置），导入`foo`不会覆盖现有值。先到先得。如果要覆盖 的现有值`lib/bar`，则必须手动进行。这就是我们`lib`用来管理覆盖的方式。

运行时库给我们的主要优势是我们可以在一个地方管理所有导出的单词，解决冲突和覆盖。但是，另一个优点是大多数模块和脚本实际上不必说明它们正在导入什么。只要在运行时库中提前正确填写了您需要的所有单词，您稍后加载的脚本或模块就可以了。这使得在您的启动代码中放置一堆导入语句和任何覆盖变得容易，从而设置了其余代码所需的一切。这是为了更容易组织和编写应用程序代码。

## 命名私有模块

在某些情况下，您不想将内容导出到主运行时库。里面的东西`lib`会被导入到所有东西中，所以你应该只将东西导出到`lib`你想要普遍可用的东西。有时你想制作只为需要它的上下文导出东西的模块。有时你有一些相关的模块，一个通用的工具和一个实用模块左右。如果是这种情况，您可能需要创建一个私有模块。

让我们来看看这个模块：

```
REBOL [type: module name: foo options: [private]] export bar: 1 
```

导入此模块不会影响`lib`. 相反，它的导出被收集到一个私有运行时库中，该运行时库对于正在导入此模块的模块或用户上下文以及目标正在导入的任何其他私有模块的本地运行时库，然后从那里导入到目标。私有运行时库用于相同的冲突解决`lib`。主运行时库`lib`优先于私有库，因此不要指望私有库覆盖全局事物。

这种东西对于制作实用模块、高级 API 或其他此类技巧很有用。如果您喜欢的话，它对于制作需要显式导入的强模块化代码也很有用。

值得注意的是，如果你的模块实际上没有导出任何东西，那么命名的私有模块和命名的公共模块之间没有区别，所以它基本上被视为公共的。重要的是它有一个名字。这让我们...

## 未命名的模块

如上所述，如果您的模块没有名称，那么它几乎必须被视为私有。不仅仅是私人的，因为您无法判断它是否已加载，因此您无法升级它甚至无法重新加载它。但如果这就是你想要的呢？

在某些情况下，您确实希望您的代码运行才能生效。在这些情况下，每次都重新运行代码是您想要做的。也许它是您正在运行的脚本，`do`但将其构建为模块以避免泄漏单词。也许你正在制作一个 mixin，一些实用函数，它们有一些需要初始化的本地状态。它可以是任何东西。

我经常让我的`%rebol.r`文件成为一个未命名的模块，因为我想更好地控制它导出的内容和方式。另外，因为它是为了效果而完成的，不需要重新加载或升级，所以给它起个名字是没有意义的。

不需要代码示例，您之前的代码示例将采用这种方式。

*我希望这能让您对 R3 的模块系统的设计有足够的了解。*

# php - preg_match_all 正确的语法

> ID：14420943
> 
> 赞同：0
> 
> 时间：2013-01-20T01:51:31.043
> 
> 标签：php

> **可能重复：**
> [正则表达式匹配打开的标签，XHTML 自包含标签除外](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)
> [如何使用 PHP 解析和处理 HTML/XML？](https://stackoverflow.com/questions/3577641/how-to-parse-and-process-html-xml-with-php)

我有一个当前代码行作为图像下载脚本的一部分，如下所示：

```
preg_match_all('|<img.*?src=[\'"](.*?)[\'"].*?>|i', $content, $matches); 
```

我需要将其更改为包括：

```
id="iwi" 
```

在 preg_match_all 命令中。img 始终采用以下格式：

我尝试了一些不同的变体，但遇到了错误，最后尝试了没有像下面这样的引号，但仍然没有，我的语法错了吗？

```
preg_match_all('|<img.*?id=iwi.*?src=[\'"](.*?)[\'"].*?>|i', $content, $matches); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T01:54:40.027

这是[The Pony He Comes](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)的第一个问题。你不知道它会是`<img id="iwi" src="image.png" />`，还是`<img src="image.png" id="iwi" />`。

相反，您应该使用解析器：

```
$dom = new DOMDocument();
$dom->loadHTML($content);
$img = $dom->getElementById("iwi");
$src = $img->getAttribute("src"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T02:51:40.437

如果您不顾所有反对意见而坚持使用 preg，这些方法也有效；

```
// [\'"]* is useful cos sometime can't find " or ', and * means 0 or 1 time search
preg_match_all('~<img.*?id=[\'"]*([^\s\'"]*).*?src=[\'"]*([^\s\'"]*).*?>~i', $content, $matches);
preg_match_all('~<img.*?id=[\'"]*(?P<id>[^\s\'"]*).*?src=[\'"]*(?P<src>[^\s\'"]*).*?>~i', $content, $matches);
print_r($matches); 
```

# iphone - NSDictionary id 键值

> ID：14420945
> 
> 赞同：-3
> 
> 时间：2013-01-20T01:51:48.467
> 
> 标签：iphone, ios, nsdictionary

`SBJson`我最近尝试将我的应用程序中的 Json 库从`NSJSONSerialization`.

当我做这份工作时，我发现有一些我无法摆脱的关键价值。

这是`NSDictionary`我得到的一个例子`NSJSONSerialization`：

```
 {

    id = 4028;

    "novel_author" = "XYZ";

    "novel_pub" = "ABC";

    "novel_title" = "DATE LIVE";

    updatedate = "2013-01-13 22:31:13";

    "vol_click" = 7563;

} 
```

原始 Json 数据字符串为：

```
{
   "id":"4028",
   "vol_click":"7563",
   "updatedate":"2013-01-13 22:31:13",
   "novel_author":"XYZ",
   "novel_pub":"ABC",
   "novel_title":"DATE LIVE"
} 
```

我无法获取键“id”的值。 `[NSDictionary objectForKey@"id"]`没用。

有没有人知道如何获得价值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:57:03.570

As you can tell by the output of what looks like `NSLog("%@", dict);`, the JSON deserialization process works fine.

The dictionary contains a key called "id", so `[dict objectForKey:@"id"]` should also work fine.

I can only conclude that this isn't the actual cause of the trouble you're having.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T02:18:46.277

这些中的任何一个都应该起作用：

```
 [yourDictName valueForKey:@"id"]
    [yourDictName objectForKey:@"id"] 
```

如果您可以使用 NSLog 看到该值来显示字典，那么它就在那里。除此之外，请确保您的对象没有被 nil'd 或释放或释放。

# drag-and-drop - 将img拖入矩形？

> ID：14420948
> 
> 赞同：0
> 
> 时间：2013-01-20T01:51:55.637
> 
> 标签：drag-and-drop, kineticjs

在 Kineticjs 中，我想将一个 img 拖入一个矩形。

我想知道是否有人可以告诉我该怎么做？我知道如何拖动形状或图像，但我想将 img 拖动到形状中。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T07:27:35.550

[http://jsfiddle.net/Ps3TU/5/](http://jsfiddle.net/Ps3TU/5/)是朝着您想做的事情迈出的一步。

```
 darthVaderImg.on('dragmove', function () {
      var userPos = stage.getUserPosition();
      if(rectShape.intersects(userPos)){
            rectShape.setFillPatternImage(this.getImage());
            this.hide();
            rectShape.setFillPatternOffset(this.getWidth(), 70);
      }
  }); 
```

但你真正想做的是这样的：http: [//jsfiddle.net/8Vdht/3/](http://jsfiddle.net/8Vdht/3/)

```
darthVaderImg.on('dragmove', function () {
 var userPos = stage.getUserPosition();
  if(rectShape.intersects(userPos)){
    this.setX(rectShape.getX());
    this.setY(rectShape.getY());
    this.setWidth(rectShape.getWidth());
    this.setHeight(rectShape.getHeight());
  }
  else {
    this.setWidth(savedWidth);
    this.setHeight(savedHeight);
    this.setImage(imageObj);
  }
  layer.draw();
}); 
```

问题是，您不能（还）只将图像（内部）放置在一个矩形中，然后再轻松地提取它。所以你需要使用一个技巧，调整图像的大小，让它看起来像在矩形中。这固定了图像的位置，您可以将其移动到矩形之外。

# java - 为什么 LineNumberReader 在 Java 中总是返回零？

> ID：14420958
> 
> 赞同：1
> 
> 时间：2013-01-20T01:53:51.543
> 
> 标签：java

我编写了以下代码来读取两个不同的文本文件。一个文本文件称为“用户名”文本文件，而另一个称为“密码”文本文件。我正在创建一个登录程序。为了使用户成功登录，用户名的行号必须与密码的行号匹配。然而，由于某种原因，我的两个文件的 LineNumberReader 都停留在零，这很奇怪，因为我放置了断言来避免这种情况，并且断言没有引发错误。我知道它们为零，因为我打印了每个读者。即使我故意输入错误的用户名密码匹配，它也会不断打印出“找到匹配”。任何人都可以解决这个问题吗？

```
 public boolean usernamePasswordCheck(String username, String password) throws         FileNotFoundException, IOException{
    BufferedReader br = new BufferedReader(new FileReader("src/BioStat/username.txt"));
    BufferedReader br2 = new BufferedReader(new FileReader("src/BioStat/password.txt"));
    String line;
    String line2;
    int userLine=0;
    int passwordLine=0;
    LineNumberReader lnr = new LineNumberReader(new FileReader("src/BioStat/username.txt"));
    LineNumberReader lnr2 = new LineNumberReader(new FileReader("src/BioStat/password.txt"));
    while((line=br.readLine())!=null){
        if(line.equals(username)){
            //username is found in username list. There is a match!
            //let's get it's line number
            userLine = lnr.getLineNumber();
        }else{
            //username was not found in list, so we should keep reading.
            line = br.readLine();
        }
    }
    System.out.println("Userline: "+userLine);
    br.close();
    while((line2 = br2.readLine())!=null){
        if(line2.equals(password)){
            //username is found in username list. There is a match!
            //let's get it's line number
            passwordLine = lnr2.getLineNumber();

        }else{
            //username was not found in list, so we should keep reading.
            line2 = br2.readLine();
        }
    }
    System.out.println("passwordLine: "+passwordLine);
    br2.close();
    assert(userLine!=0);
    assert(passwordLine!=0);
    if(userLine==passwordLine){
        System.out.println("Match Found");
        matchfound = true;
    }else{
        System.out.println("Username and Password don't match");
    }
    return matchfound;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:02:18.817

你没有推进你的`LineNumberReader`每一个循环。`while`循环负责推进您的`BufferedReader`.

实际上，您可以简化事情并且只使用`LineNumberReader`没有 BufferedReaders 的内容，因为它们的 readLine 会按照意愿为您提供文本`BufferedReader`。例如：

```
String line = null;
int userLine=0;
LineNumberReader lnr = new LineNumberReader(new FileReader("src/BioStat/username.txt"));
while((line=lnr.readLine())!=null){
    if(line.equals(username)){
        //username is found in username list. There is a match!
        //let's get it's line number
        userLine = lnr.getLineNumber();
        break;
    }
}
lnr.close(); 
```

`readLine`对on 的调用`LineNumberReader`前进到下一行（因此也会增加行号）。

# asp.net-mvc-3 - MVC Binding nested list

> ID：14420964
> 
> 赞同：0
> 
> 时间：2013-01-20T01:55:19.280
> 
> 标签：asp.net-mvc-3, model-binding

I have three entities Package, Feature and PackageFeature as follows:

Package:
PackageId (PK)
PackageTitle

Feature:
FeatureId (PK)
FeatureTitle

PackageFeature:
PackageFeatureId (PK)
PackageId (FK)
Feature (FK)
Quantity

I have an MVC view that is typed to "Package" and allows the user to edit the Quantity field on the PackageFeature entity resulting in the source code below, how do I pick this up in the controller? I've tried `[Bind(Include = "PackageFeature")]List<Package> package` and `List<PackageFeature> packageFeature` but when I view the former in the debugger I get the correct number of list items (4) but their PackageIds are all 0 and consequently they have a PackageFeature list of 0 items, the latter also produces a list of 4 items which is incorrect as there are 8 PackageFeatures - however the PackageIds are correct, everything else is set to 0/null.

```
<form action="/packages/features/" method="post">

<h3>Basic</h3>

<input data-val="true" data-val-number="..." data-val-required="..." name="[0].PackageId" type="hidden" value="2" />

<ul>
    <li>
        <span>No. of Categories (e.g. Plumber)</span>
        <input data-val="true" data-val-number="..." name="[0].PackageFeature[8].Quantity" type="text" value="1" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[0].PackageFeature[8].PackageFeatureId" type="hidden" value="9" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[0].PackageFeature[8].PackageId" type="hidden" value="2" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[0].PackageFeature[8].FeatureId" type="hidden" value="9" />
    </li>
    <li>
        <span>No. of Regions (e.g. Sydney City)</span>
        <input data-val="true" data-val-number="..." name="[0].PackageFeature[9].Quantity" type="text" value="1" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[0].PackageFeature[9].PackageFeatureId" type="hidden" value="10" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[0].PackageFeature[9].PackageId" type="hidden" value="2" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[0].PackageFeature[9].FeatureId" type="hidden" value="10" />
    </li>
</ul>

<h3>Bronze</h3>

<input data-val="true" data-val-number="..." data-val-required="..." name="[1].PackageId" type="hidden" value="3" />

<ul>
    <li>
        <span>No. of Categories (e.g. Plumber)</span>
        <input data-val="true" data-val-number="..." name="[1].PackageFeature[8].Quantity" type="text" value="2" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[1].PackageFeature[8].PackageFeatureId" type="hidden" value="19" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[1].PackageFeature[8].PackageId" type="hidden" value="3" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[1].PackageFeature[8].FeatureId" type="hidden" value="9" />
    </li>

    <li>
        <span>No. of Regions (e.g. Sydney City)</span>
        <input data-val="true" data-val-number="..." name="[1].PackageFeature[9].Quantity" type="text" value="4" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[1].PackageFeature[9].PackageFeatureId" type="hidden" value="20" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[1].PackageFeature[9].PackageId" type="hidden" value="3" />
        <input data-val="true" data-val-number="..." data-val-required="..." name="[1].PackageFeature[9].FeatureId" type="hidden" value="10" />
    </li>
</ul>

<!-- above repeated again for 2 more packages--> 
```

EDIT:

Code used to generate above:

Packages/Features.cshtml:

```
@model List<RenovateDTL.Package>

@{
    ViewBag.Title = "Package Features";
    Layout = "~/Views/Shared/_OneColumnLayout.cshtml";
}

<h2>Package Features</h2>

@using (Html.BeginForm())
{
    @Html.DisplayForModel()

    <button type="submit">Save Changes</button>
} 
```

Packages/DisplayTemplates/Package.cshtml:

```
@model RenovateDTL.Package

<h3>@Model.Title</h3>

@Html.HiddenFor(m => m.PackageId)

<ul>
    @Html.EditorFor(m => m.PackageFeature)
</ul> 
```

/Packages/EditorTemplates/PackageFeature.cshtml:

```
@model RenovateDTL.PackageFeature

@using RenovateDTL.Enum

@if (Model.FeatureId == (int)FeatureId.NumberOfCategoriesAllowed || Model.FeatureId == (int)FeatureId.NumberOfRegions)
{
    <li>
        <span>@Model.Feature.Title</span>
        @Html.TextBoxFor(m => m.Quantity)
        @Html.HiddenFor(m => m.PackageFeatureId)
        @Html.HiddenFor(m => m.PackageId)
        @Html.HiddenFor(m => m.FeatureId)
    </li>
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T03:36:25.530

我在 PackageFeature.cshtml 模板中解决了这个问题，但如果有人有的话，我更喜欢更精简的开箱即用解决方案。

```
@model RenovateDTL.PackageFeature

@{
    ViewContext.ViewData.TemplateInfo.HtmlFieldPrefix = "PackageFeature[" + Model.PackageFeatureId + "]";
}

@if (Model.FeatureId == (int)FeatureId.NumberOfCategoriesAllowed || Model.FeatureId == (int)FeatureId.NumberOfRegions)
{
    <li>
        <span>@Model.Feature.Title</span>
        <input type="hidden" name="PackageFeature.Index" value="@Model.PackageFeatureId" />
        @Html.TextBoxFor(m => m.Quantity)
        @Html.HiddenFor(m => m.PackageFeatureId)
        @Html.HiddenFor(m => m.PackageId)
        @Html.HiddenFor(m => m.FeatureId)
    </li>
} 
```

# c - 在 Erlang C NIF 中分配内存

> ID：14420970
> 
> 赞同：2
> 
> 时间：2013-01-20T01:56:49.653
> 
> 标签：c, erlang, alloc, erlang-nif

为什么要使用

```
void *enif_alloc_resource(ErlNifResourceType* type, unsigned size) 
```

与

```
void *enif_alloc(size_t size) 
```

尝试从 Erlang C NIF 分配内存时？

参考并没有详细说明原因。

[http://www.erlang.org/doc/man/erl_nif.html#enif_alloc](http://www.erlang.org/doc/man/erl_nif.html#enif_alloc)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T15:20:44.197

enif_alloc_resource 用于创建资源，这些资源在不再使用时由 vm 垃圾收集。enif_alloc 就像 malloc 一样工作，只是使用 Erlang VM 特定的实现而不是 OS 的 malloc。查看 ErlNifResourceType 的文档以及使用它的函数以获取更多详细信息。

# git - 我如何 git pull -f

> ID：14420977
> 
> 赞同：7
> 
> 时间：2013-01-20T01:58:17.123
> 
> 标签：git

哪里

```
git pull --force 
```

像在`rm -rf`然后`git clone`又从头开始？

最终结果应该是`git diff`什么都不返回。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-20T03:43:55.240

除了其他答案之外，我还将添加一个`git clean -fdx`以删除所有未跟踪的文件和目录，以避免在远程存储库中添加文件的潜在问题，但也存在于当前克隆中。

```
git clean -fdx
git fetch
git reset --hard origin/master 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-20T02:03:29.843

您用于`git fetch`从远程存储库中获取所有内容。然后您可以`git reset --hard origin/master`将当前分支重置为原点的主分支并重置您的工作目录。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-20T02:03:44.263

将您的工作目录重置为最新的拉取：

```
git reset --hard 
```

然后像往常一样拉

# ruby - 如何检查记录是否存在？

> ID：14420978
> 
> 赞同：0
> 
> 时间：2013-01-20T01:58:25.670
> 
> 标签：ruby, ruby-on-rails-3

我有一个约会模型，我想验证是否存在具有相同日期和时间的记录。

```
class Appointment < ActiveRecord::Base
  attr_accessible :adate, :atime, :doctor_id  
  validates :adate, :presence => true     
  belongs_to :doctor
  validates_date :adate, :after => lambda { Date.current }  

  validate :appointment_uniqueness

  def appointment_uniqueness
      # if date (:adate) and hour(:atime) exists then
      # date is not available
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:45:17.230

```
validates :adate, :uniqueness => { :scope => :atime } 
```

见： http: [//guides.rubyonrails.org/active_record_validations_callbacks.html#uniqueness](http://guides.rubyonrails.org/active_record_validations_callbacks.html#uniqueness)

# multithreading - node.js应用程序中单进程中的多线程socket.io

> ID：14420979
> 
> 赞同：3
> 
> 时间：2013-01-20T01:59:19.963
> 
> 标签：multithreading, node.js, socket.io

我一直在四处寻找，看看是否有其他人遇到过这个问题，但我有点预料到不会，这就是我发现的。

我现在面临的问题与我正在构建的应用程序的架构有关；node.js 中的游戏服务器。截至目前，服务器以单个“管理器”进程启动，该进程控制所有子进程。游戏的每个“区域”或“区域”都`cluster.fork()`使用单独的进程进行旋转，以便每个“区域”可以在服务器上拥有自己的线程，以优化服务器一次运行许多这些“区域”的能力.

我现在面临的困境是这样的。由于每个“区域”都在单个线程中运行，并且该线程已经每秒运行复杂的 3D 数学 X 次以保持“区域”同步，我不想打开 Socket.io（通信用于与游戏客户端交谈的库）在同一个线程中。我想我挂断的地方是在`cluster.on('message')`主进程中使用处理程序的性能以及使用`process.send({...})`.

我想看看是否有其他人有这方面的经验，或者从根本上知道整个集群模块是如何工作的，本质上是这样的：

调用是否更快：

```
var io = require('socket.io').listen( 1337 );
io.sockets.on('connection',...); //map all the functionality here in the "zone" thread 
```

或者做更多这样的事情：

```
var cluster = require('cluster');
var io = [];
//arbitrary number for the thread count, not important for theory testing
for( var i = 0; i < 4; ++i) {
    var process = cluster.fork({...});
    process.on('message',myRelayFunction);
    io.push( process );
} 
```

当然，假设`cluster.fork()`调用是通过管道传输到一个脚本中，该脚本除了打开一个 socket.io 连接并将来自各个客户端的消息中继到“区域”进程之外什么都不做。

我已经尝试对此进行性能测试，但我发现很难判断这是否更快，因为我很难通过连接使机器饱和以获取要测试的输出。

我想确保这是可扩展的，以便在较重的负载下，应用程序可以充分利用服务器上的多个 CPU 内核。所以这当然是说我应该将 socket.io 侦听器多线程化到多个线程中，但我担心的是，由于它们在技术上都通过管道返回到单线程进程中，这不会让我付出任何可能的多线程性能提升-穿线他们？我在这里的测试/基准测试部门有点空虚，我不知道这一切背后的理论如何运作得足够好，无法说出这里最好的基本方法是什么......所以我非常感谢任何反馈/输入任何人对此的看法；）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T18:31:32.860

我能够进行更多测试，并且似乎将 socket.io 侦听器放在单独的线程中仍然对性能非常有益，即使它们必须将数据输入/输出单个“区域”（管理器）进程。这样，服务器可以使用单独的 CPU 来处理 IO 处理而不是区域处理。

所以这里的答案是，是的，将侦听器/套接字多线程化到单独的线程中仍然是有益的，即使所有这些线程都在与单个线程进行通信。这当然会导致我遇到的另一个问题，即如何最好地优化 node.js 中多个子进程之间的通信因为这是这个过程中的下一个逻辑步骤/障碍，我将链接到下面的问题以防万一else 稍后会在这个问题上磕磕绊绊。

[node.js 集群中的子进程间通信选项](https://stackoverflow.com/questions/14429203/inter-child-process-communication-options-in-node-js-cluster)

# javascript - Perform action onclick outside of object

> ID：14420984
> 
> 赞同：2
> 
> 时间：2013-01-20T01:59:50.823
> 
> 标签：javascript, onclick, getelementsbyclassname

I'm attempting to create a javascript where when you click anywhere on the screen but on an object, it does a bit of code. (To close a dialogue box, remove nighttime mode, etc.)

```
//Imagine some CSS declaring that FPAGE takes up 100% of the screen.
<div id="FPAGE" onclick="return outClick();">
    <script>
        function outClick() {
            var o=document.getElementsByClassName('objects');
            //What now?
        }
    </script>
    <center>
        <object class="objects" width="500px" height="500px"></object>
        <br />
        <object class="objects" width="500px" height="500px"></object>
    </center>
</div> 
```

I'm really unsure what I should be doing. I have thought of some sudo code, but I don't know if this can be done in javascript.

```
var o=document.getElementsByClassName('objects');
//What now?
if (onclick!=o) {
    //insert code here
} 
```

**SOLUTION:** (Thanks to David)

```
<script>
document.onclick = function(e) {
    var o=document.getElementsByClassName('objects');
    if ( e.target.nodeName != 'o' ) {
        //Code here!
    }
};
</script>
<center>
    <object class="objects" width="500px" height="500px"></object>
    <br />
    <object class="objects" width="500px" height="500px"></object>
</center>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T03:53:08.063

为不想处理点击的对象添加事件处理程序会更干净，执行 event.stopPropgation （或者，如果您已经有对象的事件处理程序，只需向它们添加 event.stopPropagation ），然后添加整个页面的事件处理程序。

```
var objects=document.GetObjectsByClassName('objects');
for (var i=0, len=objects.length; i<len; i++) {
    objects[i].addEventListener("click",function(event){event.stopPropagation();});
}
document.addEventListener("click",...) 
```

随着您的应用程序的发展，这种方法将更加健壮，并且您添加了您不处理单击的其他项目 - 与在文档事件处理程序中构建一个怪物 IF 语句相比，您可以指定行为（抑制单击或不是）在单个元素级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T02:52:28.173

根据您的示例，您只需添加一个检查，通过检查事件的目标属性来查看实际单击了哪个元素。您实际上并不需要“对象”类，而是可以修改它以检查 tagName ，就像其他几个人在他们的答案中所做的那样。我添加的类名检查绝对不理想，因为即使您有一个较长的类名恰好包含“对象”一词，它也会通过。你可以使用像 jQuery 这样的库来让你的生活更轻松。

试试这个，把这个 html 放到一个文件中，然后在浏览器中加载它。

```
<html>
    <head>
        <script>
            function outClick(event) {
                    if(event.target.className.indexOf('objects') > -1) {
                    alert("is object");
                } else {
                    alert("not object");
                }
            }
        </script>
        <style>
            html,body,#FPAGE { height:100% }
        </style>
    </head>
    <body>
        <div id="FPAGE" onclick="outClick(event)">
            <center>
                <object class="objects" width="500px" height="500px">OBJECT</object>
                <br />
                <object class="objects" width="500px" height="500px">OBJECT2</object>
            </center>
        </div>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T02:32:03.677

所以你得到了你正在寻找的答案，太好了。

顺便一提;

`document.getElementsByClassName`返回“NodeList”或“HTMLCollection”（参考：[https](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByClassName) ://developer.mozilla.org/en-US/docs/DOM/document.getElementsByClassName ）。

因此，您需要`for-next`将事件附加到节点的方法。

```
// i.e
var els = document.getElementsByClassName('objects'), 
    el, i;
for (i = 0; i < els.length; i++) {
    el = els[i];
    el.onclick = function() {
    // ...
}

// or
while (el = els[i++]) {
    el.onclick = // ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T02:18:26.490

您可以在整个页面上添加一个单击事件，然后检查该单击的*目标*是否是对象（或者可能是该对象的后代）。像这样的东西：

```
document.onclick = function(e) {
    if ( e.target.nodeName != 'OBJECT' ) {
        // the click happened on a non-object (probably "outside")
    }
}; 
```

演示：http: [//jsbin.com/elikum/1](http://jsbin.com/elikum/1)

请记住，javascript 事件很难在旧版浏览器中规范化，因此根据目标受众，您可能会考虑使用 jQuery 之类的库来简化事件处理。

# ruby-on-rails - Rails tutorial Chapter 10.1.4: "User has already been taken"

> ID：14420985
> 
> 赞同：0
> 
> 时间：2013-01-20T02:00:03.723
> 
> 标签：ruby-on-rails, ruby, railstutorial.org

I am going through Michael Hartl's rails tutorial and getting spec validation errors in Chapter 10.1.4 even though I think I'm following the instructions.

I'm a Rails newbie but it looks like Factory Girl is trying to create a User that already exists, even though the following code is supposed to create a new micropost and assign it to an existing user:

FactoryGirl.create(:micropost, user: @user, created_at: 1.hour.ago)

Does anyone know how to fix the errors?

**Errors**

1) User micropost associations should have the right microposts in the right order Failure/Error: FactoryGirl.create(:micropost, user: @user, created_at: 1.hour.ago) ActiveRecord::RecordInvalid: Validation failed: User has already been taken # ./spec/models/user_spec.rb:159

2) User micropost associations should destroy associated microposts Failure/Error: FactoryGirl.create(:micropost, user: @user, created_at: 1.hour.ago) ActiveRecord::RecordInvalid: Validation failed: User has already been taken # ./spec/models/user_spec.rb:159

**user_spec.rb**

```
require 'spec_helper'

describe User do

    before do 
    @user = User.new(name: "Example User", email: "user@example.com", 
        password: "foobar", password_confirmation: "foobar") 
    end

    subject { @user }

    it { should respond_to(:name) }
    it { should respond_to(:email) }
    it { should respond_to(:password_digest) }
    it { should respond_to(:password) }
  it { should respond_to(:password_confirmation) }
  it { should respond_to(:remember_token) }
  it { should respond_to(:authenticate) }
  it { should respond_to(:admin) }
    it { should respond_to(:authenticate) }
    it { should respond_to(:microposts) }

    it { should be_valid }
    it { should_not be_admin }

  describe "when name is not present" do
    before { @user.name = " " }
    it { should_not be_valid }
  end

  describe "when email is not present" do
    before { @user.email = " " }
    it { should_not be_valid }
    end

    describe "when name is too long" do
    before { @user.name = "a" * 51 }
    it { should_not be_valid }
    end

    describe "when email format is invalid" do
    it "should be invalid" do
        addresses = %w[user@foo,com user_at_foo.org example.user@foo.
                         foo@bar_baz.com foo@bar+baz.com]
          addresses.each do |invalid_address|
            @user.email = invalid_address
            @user.should_not be_valid
        end      
      end
  end

  describe "when email is not downcase" do
    let(:uppercase_email) { "TEST@TEST.COM"}

    it "should be set to downcase" do
        @user.email = uppercase_email
        @user.save
        @user.email.should == uppercase_email.downcase
    end 
  end

    describe "when email format is valid" do
        it "should be valid" do
        addresses = %w[user@foo.COM A_US-ER@f.b.org frst.lst@foo.jp a+b@baz.cn]
      addresses.each do |valid_address|
          @user.email = valid_address
          @user.should be_valid
      end      
    end
  end

    describe "when email address is already taken" do
    before do
        user_with_same_email = @user.dup
        user_with_same_email.email.upcase!
        user_with_same_email.save
      end

      it { should_not be_valid }
    end

    describe "when password is not present" do
    before { @user.password = @user.password_confirmation = " " }
    it { should_not be_valid }
  end

    describe "when password doesn't match confirmation" do
    before { @user.password_confirmation = "mismatch" }
    it { should_not be_valid }
    end

    describe "when password confirmation is nil" do
    before { @user.password_confirmation = nil }
    it { should_not be_valid }
  end

    describe "return value of authenticate method" do
      before { @user.save }
        let(:found_user) { User.find_by_email(@user.email) }

    describe "with valid password" do
        it { should == found_user.authenticate(@user.password) }
    end

    describe "with invalid password" do
        let(:user_for_invalid_password) { found_user.authenticate("invalid") }

        it { should_not == user_for_invalid_password }
        specify { user_for_invalid_password.should be_false }
        end     
    end

    describe "with a password that's too short" do
    before { @user.password = @user.password_confirmation = "a" * 5 }
    it { should be_invalid }
    end

    describe "remember token" do
    before { @user.save }
    its(:remember_token) { should_not be_blank }
  end

    describe "with admin attribute set to 'true'" do
      before do
      @user.save!
        @user.toggle!(:admin)
      end

      it { should be_admin }
    end

    describe "confirm admin attribute is not accessible" do
        it "should not be accessible" do
            expect do
              @user.update_attributes(:admin => true)
      end.to raise_error(ActiveModel::MassAssignmentSecurity::Error)
    end  
  end 

  describe "micropost associations" do

    before { @user.save }
    let!(:older_micropost) do 
      FactoryGirl.create(:micropost, user: @user, created_at: 1.day.ago)
    end

    let!(:newer_micropost) do
      FactoryGirl.create(:micropost, user: @user, created_at: 1.hour.ago)
    end

    it "should have the right microposts in the right order" do
      @user.microposts.should == [newer_micropost, older_micropost]
    end

    it "should destroy associated microposts" do
      microposts = @user.microposts.dup
      @user.destroy
      microposts.should_not be_empty
      microposts.each do |micropost|
        Micropost.find_by_id(micropost.id).should be_nil
      end
    end
  end
end 
```

**factories.rb**

```
FactoryGirl.define do
  factory :user do
    # Rails::logger.info "hello"

    sequence(:name)  { |n| "Person #{n}" }
    sequence(:email) { |n| "person_#{n}@example.com" }   
    password "foobar"
    password_confirmation "foobar"

    factory :admin do
      admin true
    end
  end

  factory :micropost do
    content "Lorem ipsum"
    user
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T03:04:50.277

我遇到了与您在下面描述的相同的错误 #2。我发现通过重新启动`spork`并重新运行 rake`db:test:prepare`错误已解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T05:05:16.507

您没有使用 FactoryGirl 在那里创建用户对象。**在您的user_spec.rb**顶部附近，开始的分配给 @user`@user = User.new...`应该是这样的：

```
@user = FactoryGirl.create(:user) 
```

这样，将在每次测试之前创建一个具有唯一电子邮件地址的新对象。

# iphone - 拍摄快照并保存到相机胶卷时的 iOS 图像大小

> ID：14420988
> 
> 赞同：0
> 
> 时间：2013-01-20T02:01:23.990
> 
> 标签：iphone, ios

我截取了一张截图并将图像保存到相机胶卷中，并将此图像设置为锁定屏幕。
但是 iPhone 4 中的图像尺寸是 640*940。我怎样才能使它 640*960 没有任何失真？我猜状态栏有一些高度。

```
CGSize size = self.view.bounds.size;

[self.view.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

UIImageWriteToSavedPhotosAlbum(image, self, @selector(image:didFinishSavingWithError:contextInfo:), nil); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T04:50:49.800

设置图像大小的两种方法...

您可以为屏幕截图设置自己的框架：

```
CGRect rect = CGRectMake(0, 0, 640, 960);
UIView *view = [[UIView alloc]initWithFrame:rect];
    UIGraphicsBeginImageContext(view.frame.size); 
```

这将采用您想要的尺寸。请记住，如果您的屏幕尺寸为 320 x 480，您将获得 640 x 960 的返回图像，但将是实际屏幕截图范围之外的空白区域。

另一种方法是从对象（例如图像视图）中找到您想要的区域：

```
UIImageView *imageview;
UIGraphicsBeginImageContext(imageview.frame.size); 
```

同样，这将返回您想要的内容，但实际屏幕尺寸之外的任何内容都将被空白填充。

# android - NetBeans 7.2.1: Adding Dependency

> ID：14420995
> 
> 赞同：0
> 
> 时间：2013-01-20T02:03:04.570
> 
> 标签：android, maven, netbeans, dependencies

I'm running NetBeans 7.2.1. I successfully built com.slidingmenu.lib. I successfully built ABS. NetBeans won't let me add ABS as a dependency to com.slidingmenu.example because NetBeans doesn't recognize ABS as an Android library. Please help...I'll be your friend!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T05:19:52.453

这就是我所做的：

1.  将 \ActionBarSherlock-master\library 从我的 maven 项目工作区复制到我的 ant 项目工作区。
2.  将复制的目录从“库”重命名为“com.actionbarsherlock”。
3.  在新目录中打开 cmd 提示符（我正在运行 Win7）并运行“android update project -p”。（不要忘记最后的句号）。
4.  打开新创建的 build.xml 并将项目从“library”重命名为“com.actionbarsherlock”。
5.  将 com.actionbarsherlock 中的 android-support-v4.jar 替换为 com.slidingmenu.lib 中的那个（重点是运行/分析 com.slidingmenu.example 包）。
6.  从 com.actionbarsherlock 目录中删除 pom.xml（以便 NetBeans 7.2.1 将其识别为 Android 库）。

# html - min-height not working. Div disappears in certain browser sizes

> ID：14420997
> 
> 赞同：-3
> 
> 时间：2013-01-20T02:03:16.760
> 
> 标签：html, css

This is my first time posting and I am new to web development so please bear with me!

On parts of our site we have a white div with text content. I have positioned it so it's inline with other elements on the page. I have been trying to sort out a way that makes the div (#contacttextcontainer) more responsive so that the text is readable regardless of the browser window size. I tried overflow:auto which did contain the text within the div (adding scroll bars when needed) but there is also the issue that at certain browser sizes the div will completely collapse. I tried min-height (display:block, min-height: 100%... and I tried specific pxs as well). but none seem to work....am I missing something??`

I have been testing on Safari.

Any help would be greatly appreciated!! Thank You!!!!

The HTML:

```
 <div id="contacttextcontainer"> 
     <p></p>
     <p>test test test.</p>
     <p>test</p>
     <p>test test test test test</p>
     <p>STUDIO HOURS;</p>
     <p></p>
     <p>9-4:30 Mon-Fri and by appointment</p>
     <p></p>
     <p>CONTACT;</p>
     <p>555-555-5555</p>
     <p>test test test</p>
    </div> 
```

The CSS

```
 #contacttextcontainer {
font-size: 16px; 
text-align: center; 
font-family: courier;
position: absolute;
top:335px;
left:315px;
right: 260px;
bottom: 115px;
padding: 20px;
background-color: #FFFFFF;
overflow: auto;
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T13:40:34.157

好的，如果我们查看您的原始 html / css 我们得到这个：http: [//jsfiddle.net/svJUQ/](http://jsfiddle.net/svJUQ/)并通过删除底部位置我们得到这个：http: [//jsfiddle.net/svJUQ/2/](http://jsfiddle.net/svJUQ/2/) - 当有不是为 div 指定的底部位置或高度，它的高度设置为默认值 ( `height: auto;`)，并且 div 将扩展以适应其内容。`overflow: visible;`除非您想要滚动内容或隐藏内容，否则无需更改溢出的默认值。如果这不是您要找的，请告诉我。