# StackOverflow 问答 15121000-15121999

# .net - 任务运行失败

> ID：15121000
> 
> 赞同：0
> 
> 时间：2013-02-27T19:47:56.923
> 
> 标签：.net, task-parallel-library, tpl-dataflow

我编写了一个小实用程序来读取大型文本文件并搜索包含搜索词的行。我以此为契机学习 TPL 数据流。

该代码工作正常，除非搜索词靠近文件的最后。在这种情况下，*除非*其中有断点，否则`uiResult`不会调用操作块。

 *我的理解是数据发布到`uiResult`from `searcher`，*之后*变得完整（它`searcher`已经处理了最后一个数据块）。由于数据已经过帐，`uiResult`因此在处理完该数据之前，它不应该变得完整。

**问题**

为什么`uiResult`即使将数据发布到它也会变得完整（除非在 中设置断点`uiResult`）？

**代码**

这是相关代码，尽可能精简：

```
ActionBlock<LineInfo> uiResult = new ActionBlock<LineInfo>(li =>
    {
        // If match found near end of file, the following line only runs
        // if a breakpoint is set on it:
        if (results != null) results.Add(li);
    },
    new ExecutionDataflowBlockOptions()
    {
        MaxDegreeOfParallelism = 1,
        CancellationToken = cancelSource.Token,
        TaskScheduler = TaskScheduler.FromCurrentSynchronizationContext()
    });

BatchBlock<LineInfo> batcher = new BatchBlock<LineInfo>(5000); 

ActionBlock<LineInfo[]> searcher = new ActionBlock<LineInfo[]>(lines =>
    {
        foreach (LineInfo li in lines)
        {
            if (li.TextOfLine.Contains(searchTerm))
            {
                uiResult.Post(li);
            }
        }
    },
    new ExecutionDataflowBlockOptions()
    {
        MaxDegreeOfParallelism = 1,
        CancellationToken = cancelSource.Token
    });

batcher.LinkTo(searcher);

batcher.Completion.ContinueWith(t =>
{
    if (t.IsFaulted) ((IDataflowBlock)searcher).Fault(t.Exception);
    else searcher.Complete();

    if (t.IsFaulted) ((IDataflowBlock)uiResult).Fault(t.Exception);
    else uiResult.Complete();
});

Task.Run(() =>
    {
        using (FileStream fs = File.Open(filePath, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
        using (BufferedStream bs = new BufferedStream(fs))
        using (StreamReader sr = new StreamReader(bs))
        {
            string line;
            while ((line = sr.ReadLine()) != null && cancelSource.IsCancellationRequested == false)
            {
                batcher.Post(new LineInfo() { LineNumber = lineNumber, OffsetOfLine = offset, TextOfLine = line });
            }

            batcher.Complete();
            try
            {
                searcher.Completion.Wait();
                uiResult.Completion.Wait();
            }
            catch (AggregateException ae)
            {
                TaskCanceledException taskCancelled = ae.InnerException as TaskCanceledException;
                if (taskCancelled != null)
                {
                    // Swallow the Exception if is just a user cancellation
                    throw;
                }
            }
            finally
            {
                signalDone();
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:56:20.167

由于您处理完成的方式，您的代码是不确定的。一个可能的事件序列是这样的：

1.  处理整个文件`Task`并调用`Complete()`.`batcher`
2.  `batcher`处理最后一批，将其发送到`searcher`并完成。
3.  `Complete()`继续执行，它同时调用`searcher`和`uiResult`。
4.  既然`uiResult`没有工作要做，它就完成了。
5.  `searcher`处理最后一批，尝试将每个结果发送到`uiResult`. 但是`uiResult`已经完成了，所以它拒绝一切。这意味着`Post()`返回`false`，但您没有检查它。

所以问题是你试图向一个已经完成的块发送一些东西，这是行不通的。

`Complete()`解决方案是仅在块完成之前（即完成）之前调用块`Completion`。可能最简单的方法是使用[`PropagateCompletion`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.dataflow.dataflowlinkoptions.propagatecompletion)with `LinkTo()`。*

# android - 屏幕滑动检测代码问题

> ID：15121003
> 
> 赞同：1
> 
> 时间：2013-02-27T19:47:59.980
> 
> 标签：android

有人可以帮我写下面的代码。我正在使用此代码来检测屏幕上的手指滑动。

```
import android.app.Activity;
import android.content.Intent;
import android.util.Log;
import android.view.MotionEvent;
import android.view.View;

public class ActivitySwipeDetector implements View.OnTouchListener {  

 private Activity activity;
 static final int MIN_DISTANCE = 100;
 private float downX, downY, upX, upY;

 public ActivitySwipeDetector(final Activity activity) { 
  this.activity = activity;
 }

 public void onRightToLeftSwipe() {
}

 public void onLeftToRightSwipe(){
}

 public void onTopToBottomSwipe(){
}

 public void onBottomToTopSwipe(){
}

public boolean onTouch(View v, MotionEvent event) {
 switch(event.getAction()){
 case MotionEvent.ACTION_DOWN: {
Log.i("msg", "in MotionEvent.ACTION_DOWN "+event.getX());
downX = event.getX();
downY = event.getY();
 }
 case MotionEvent.ACTION_UP: {
Log.i("msg", "in MotionEvent.ACTION_UP "+event.getX());
upX = event.getX();
upY = event.getY();

 float deltaX = downX - upX;
 float deltaY = downY - upY;

 // swipe horizontal?
   if(Math.abs(deltaX) > MIN_DISTANCE){
  // left or right
  if(deltaX < 0) { this.onLeftToRightSwipe(); return true; }
  if(deltaX > 0) { this.onRightToLeftSwipe(); return true; }
 } else { Log.i("msg", "X-axis Swipe was only " + downX+"-"+upX + " long, need at least " +     
  MIN_DISTANCE); }

 // swipe vertical?
 if(Math.abs(deltaY) > MIN_DISTANCE){
  // top or down
  if(deltaY < 0) { this.onTopToBottomSwipe(); return true; }
  if(deltaY > 0) { this.onBottomToTopSwipe(); return true; }
 } else { Log.i("msg", "Y-axis Swipe was only " + downY+"-"+upY  + " long, need at least " + 
MIN_DISTANCE); }

 //     return true;
}
}
return false;
 }

 } 
```

这就是我在代码中使用此类的方式

```
 myTextView.setOnTouchListener(new ActivitySwipeDetector(this) {
        public void onRightToLeftSwipe() {
            //do some stuff;
        }
        public void onLeftToRightSwipe() {
            //do some stuff;
        }
        public void onTopToBottomSwipe() {
            //do some stuff;
        }
        public void onBottomToTopSwipe() {
            //do some stuff;
        }
    }); 
```

当我测试这段代码（直接在手机上，而不是在模拟器上）时，upX 和 downX 变量都返回相同的值。upY 和 downY 值也是如此。因此，方法 onLeftToRightSwipe() 等一开始就没有被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:51:47.037

在您的 switch 语句中，您需要`break;`在每个 case 的末尾添加 a。

```
switch(event.getAction()){

    case MotionEvent.ACTION_DOWN: {
        Log.i("msg", "in MotionEvent.ACTION_DOWN "+event.getX());
        downX = event.getX();
        downY = event.getY();
        break;
        }
    case... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T21:31:26.437

添加一行“return true;” 如果 MotionEvent.ACTION_DOWN 解决了​​问题。

# java - 根据生成的列循环遍历结果集

> ID：15121008
> 
> 赞同：0
> 
> 时间：2013-02-27T19:48:28.583
> 
> 标签：java, sql, database, resultset

我正在开发一个多线程项目，我需要在其中随机找到`columns`将在我的项目中使用的项目`SELECT sql`，然后我将执行该 SELECT sql 查询。

找到那些列后-

1.  我需要查看 id 是否在有效范围之间，如果它在有效范围之间，然后使用 columnsList 中的那些列循环结果集并将数据取回并存储在变量中。
2.  否则，如果 id 不在有效范围内，我需要检查我没有从结果集中取回任何数据。但不知何故，如果我取回数据并且标志为真以停止程序，然后退出程序。否则，如果我要取回数据但标志为假以停止程序，则计算其中发生了多少。

下面是我的代码-

```
private volatile int count;

@Override
public void run() {

.....

final String columnsList = getColumns(table.getColumns());
....
rs = preparedStatement.executeQuery();
....
if (Read.endValidRange < id && id < Read.startValidRange) {

    while (rs.next()) {
        for(String column: columnsList.split(",")) {
            System.out.println(column + ": " + rs.getString(column));
        }
    }
} else {
    if(rs.next() && Read.flagTerminate) {
        System.exit(1);
    } else {
        count++;
    }
}

....

}

/**
 * A simple method to get the column names in the order in which it was
 * inserted
 * 
 * @param columns
 * @return
 */
private String getColumns(final List<String> columns) {
    List<String> copy = new ArrayList<String>(columns);
    Collections.shuffle(copy);

    int rNumber = random.nextInt(columns.size());

    List<String> subList = copy.subList(0, rNumber);
    Collections.sort(subList, new Comparator<String>() {

        @Override
        public int compare(String o1, String o2) {
            return columns.indexOf(o1) < columns.indexOf(o2) ? -1 : 1;
        }
    });
    return StringUtils.join(subList, ",");
} 
```

**问题陈述-**

我无法理解我应该如何遍历结果集，因为每次我的 SELECT sql 中都会有不同的列，具体取决于生成的内容。除此之外，我怎样才能使它在 if else 循环中更干净。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:02:47.450

好的..您可以将随机生成的列保存在字符串数组中..然后在通过结果集迭代时使用该数组...如下： **更新**
您不应该在选择语句中包含这些列..相反，您应该选择所有select 语句中的列使用`*`...然后在 rs.next() 循环中获取该列的值...

```
rs = con.executeQuery("Select * from tablename");
while(rs.next())
{
   for (String col : columnsList )
   {
     System.out.print(rs.get(col));
   }
   System.out.print("\n");
} 
```

**更新1**
您需要将您在 run() 中编写的关键代码部分包装在同步块中，以避免出现竞争条件，如下所示：

```
private volatile int count;

@Override
public void run() {

.....
while (!Read.flagTerminate)
{
    synchronized(this)
    {
        if (!Read.flagTerminate)
        {
            String columnsList = getColumns(table.getColumns());
            ....
            rs = preparedStatement.executeQuery();
            ....
            if (Read.endValidRange < id && id < Read.startValidRange) 
            {
                while (rs.next()) 
                {
                    for(String column: columnsList.split(",")) 
                    {
                        System.out.println(column + ": " + rs.getString(column));
                    }
                }
            } 
            else 
            {
                while (rs.next())
                {
                    count++;
                }
            }
        }

    }
}
System.exit(0);//it implies that flag = true;

....

}

/**
 * A simple method to get the column names in the order in which it was
 * inserted
 * 
 * @param columns
 * @return
 */
private String getColumns(final List<String> columns) {
    List<String> copy = new ArrayList<String>(columns);
    Collections.shuffle(copy);

    int rNumber = random.nextInt(columns.size());

    List<String> subList = copy.subList(0, rNumber);
    Collections.sort(subList, new Comparator<String>() {

        @Override
        public int compare(String o1, String o2) {
            return columns.indexOf(o1) < columns.indexOf(o2) ? -1 : 1;
        }
    });
    return StringUtils.join(subList, ",");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:01:14.427

那这个呢：

```
if (Read.endValidRange < id && id < Read.startValidRange) {
    while (rs.next()) {
        for (String column : columnsList.split(",")) {
            System.out.println(column + ": " + rs.getString(column));
        }
    }
} else if (rs.next()) {
    if (Read.flagTerminate) {
        System.exit(1);
    } else {
        count++;
    }
} 
```

根据我对问题的理解，我还更新了 if-else 条件。

# javascript - Jquery Mobile：添加下一个和上一个按钮

> ID：15121019
> 
> 赞同：3
> 
> 时间：2013-02-27T19:48:47.843
> 
> 标签：javascript, jquery, html, css, jquery-mobile

我正在开发一个项目，该项目将在 html 页面上有数百个页面。

我非常担心在子页面`<a href=#ID" >`之间导航这个子页面。有没有一种方法可以在每个子页面中使用一个按钮，从而将我带到下一个子页面，而我不必将每个子页面 ID 写入每个“下一步”按钮？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T20:16:01.710

## 返回键 ：

jQuery Mobile 为每个页面上的后退按钮提供了开箱即用的解决方案。

```
<script>
    $(document).on('mobileinit', function () {
        $.mobile.ignoreContentEnabled = true;
    });
</script> 
```

这段代码必须放在 jQuery Mobile 初始化之前，像这样：

```
<head>
  <title>Share QR</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>     
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />   
  <script>
    $(document).on('mobileinit', function () {
        $.mobile.ignoreContentEnabled = true;
    });
  </script>    
  <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
</head> 
```

## 下一步按钮：

这个有点棘手，自动生成的下一步按钮只有在你有 1 个带有多页解决方案的 html 时才有效。这将为您提供在线下一页的信息，因此要创建下一个按钮，请使用以下代码：

```
$(document).on('pagebeforeshow', '[data-role="page"]', function(){       
    var nextpage = $(this).next('div[data-role="page"]');
    if (nextpage.length > 0) {    
        $.mobile.activePage.find('[data-role="header"]').append($('<a>').attr({'href':'#'+nextpage.attr('id'),'data-theme':'b'}).addClass('ui-btn-right').html('Next').button());
    }  
}); 
```

## 工作示例：

这是此解决方案的一个工作示例：http: [//jsfiddle.net/Gajotres/BnB7X/](http://jsfiddle.net/Gajotres/BnB7X/)

如果您有更多问题，请随时提问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-03T13:00:18.880

我是这样解决的：

```
$(document).ready(function() {

    $('.nextBtn').click(function() {
        $page = $(this).closest('div[data-role="page"]').next();
        $.mobile.changePage( $page, { transition: "slide", changeHash: false });
    });

    $('.prevBtn').click(function() {
        $page = $(this).closest('div[data-role="page"]').prev();
        $.mobile.changePage( $page, { transition: "slide", reverse: true, changeHash: false });
    });

}); 
```

然后将上一个/下一个按钮放置在您喜欢的位置，只需确保上一个按钮类 prevBtn 和下一个按钮类 nextBtn。

例如：

```
<a href="#" class="ui-btn prevBtn">Previous</a>
<a href="#" class="ui-btn nextBtn">Next</a> 
```

# javascript - 在 WinJS 中传递实例类

> ID：15121024
> 
> 赞同：0
> 
> 时间：2013-02-27T19:48:56.500
> 
> 标签：javascript, windows-store-apps, winjs

我正在尝试传递一个类实例，以便我可以保留它的成员变量。我有以下代码

```
var mainNamespace = WinJS.Namespace.define("MainNamespace", {        
    setupClass: WinJS.Class.define(
        function () { },
        {
            createSetup: function CreateSetup() {                
                var interactionInst = new mainNamespace.interaction();

                drawScreen.DrawScreen(interactionInst);
                var backgroundProc = new 
                        mainNamespace.createProc(interactionInst);                
        }
    ),
    interaction: WinJS.Class.define(
        function() {},
        {
            clickedPos: 0,
            handleTouch: function handleTouch(event) {
                this.clickedPos = event.x;
                console.log("New pos: " + this.clickedPos);
        }
    ),

    createProc: WinJS.Class.define(
        function (interaction) {
            setInterval(this.runProc, 1000, interaction);
    },
    {

        runProc: function runNewProc(interaction) {
            console.log(interaction.clickedPos);
        }        
       ... 
```

`drawScreen`命名空间如下：

```
WinJS.Namespace.define("drawScreen", {
    DrawScreen: WinJS.Class.define(
    function DrawScreen(interaction) {
        /// Do some screen set-up here

        canvas.addEventListener("MSPointerUp", interaction.handleTouch, false);
    }
)

}); 
```

我的问题是`interaction.clickedPos`永远不会改变。为什么它没有改变，我是否以正确的方式来处理 javascript 应用程序？

编辑：

我现在已经弄清楚为什么会发生这种情况，但不知道如何解决它。`interaction.handleTouch`触发时，指`this`的是`canvas`对象，而不是`interaction`对象 - 所以我无法访问它的成员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:31:53.363

问题出在以下行：

`canvas.addEventListener("MSPointerUp", interaction.handleTouch, false);`

在这里，您传递了对函数 handleTouch() 的引用，而与当前实例没有任何连接（交互）。您可以使用 .bind() 方法更改事件处理程序的上下文：

`canvas.addEventListener("MSPointerUp", interaction.handleTouch.bind(interaction), false);`

# javascript - 是否可以在按钮上使用 javascript 发送电子邮件？

> ID：15121036
> 
> 赞同：1
> 
> 时间：2013-02-27T19:49:39.340
> 
> 标签：javascript, jquery

有没有办法在单击按钮时将电子邮件发送到输入中的电子邮件地址？形式如：

```
<form action="/" method="post" name="form" target="_blank">
    <h3><span>Subscribe to Newsletter</span></h3>
    <p class="email_first">
        <label for="email">Your Email</label>
        <input id="EMAIL" class="email" type="email" name="EMAIL" value="Your Email Address:" size="30" />
    </p>
    <p class="submit"><button type="submit">Send</button></p>
</form> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:50:51.350

Javascript 是客户端，因此您不能直接调用任何类型的电子邮件发送服务。如果您使用 Ajax 并让它在 PHP/JSP 页面上调用，那么这是可能的，但使用纯 Javascript 是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:52:58.770

您不能直接使用 java 脚本发送电子邮件。但是，您可以从 Java 脚本打开默认邮件客户端（例如 Outlook）。

```
window.open('mailto:emailt@email.com'); 
```

或者你可以让你的服务器来做这项工作！

# c++ - 调用引用的析构函数？

> ID：15121037
> 
> 赞同：0
> 
> 时间：2013-02-27T19:49:42.377
> 
> 标签：c++

这是我的示例代码

```
 class king
{
public:
    king(int q)
        :queen(q)
    {
    }

    ~king()
    {
        cout << "king's destructor." << endl;
    }

    void operator= (const king &k)
    {
        cout << "king's copy constructor." << endl;
        queen = k.queen;
    }

private:
    int queen;
};

void refFunc0(king &k)
{
    king &kk = k;
}

void refFunc1(king &k)
{
    king kk = k;
}

void main()
{
    int qqq0 = 55;

    king kkk0(qqq0);
    refFunc0(kkk0);

    cout << qqq0 << endl;

    int qqq1 = 66;
    king kkk1(qqq1);
    refFunc1(kkk1);

    cout << qqq1 << endl;

    cin.get();
} 
```

任何人都可以帮助解释上面代码中发生的事情吗？我的意思是如果我将引用传递给函数，引用变量会调用析构函数然后破坏作为引用传递给函数的原始变量吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T19:52:13.380

引用不是对象，它们只是*引用*一个对象。绑定对对象的引用对对象的生命周期没有影响（如果引用是`const`并且对象是临时的，则可能会扩展它，但它肯定不会减少生命周期）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:51:37.293

这个功能：

```
void refFunc1(king &k)
{
    king kk = k;
} 
```

正在创建`king`的副本。在复制的对象上调用析构函数。`king`再一次，它在 main() 中的对象上又被调用了两次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T19:55:29.253

refFunc0 什么都不做。引用只是对象的另一个名称。refFunc1 将在 kk 中创建 king 的副本，然后在函数结束时销毁 kk。当 'main' 结束时， kkk0 和 kkk1 将被销毁。

# ruby - 如何在 RSpec 中存根外部 ruby gem 的方法？

> ID：15121038
> 
> 赞同：0
> 
> 时间：2013-02-27T19:49:43.450
> 
> 标签：ruby, rspec2

我正在尝试在多个操作系统中测试类方法的行为，而实际上不必在它们上运行代码。我正在使用[操作系统 Rubygem](https://rubygems.org/gems/os)

我想在 RSpec 中测试这个函数的 3 种情况：

```
 def get_os()
    if OS.linux?
      return "linux#{OS.bits}"
    elsif OS.mac?
      return "mac"
    elsif OS.doze?
      return "win"
  end 
```

我在[这里创建了一个快速测试项目](https://github.com/trinitronx/rspec-stubmock-test)

您可以使用以下命令运行它：

```
git clone git://github.com/trinitronx/rspec-stubmock-test.git
cd rspec-stubmock-test/
bundle install
rspec 
```

我尝试手动覆盖这些`OS.*?`方法，但它似乎不起作用。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:53:29.847

您应该能够像这样对方法进行存根：

```
describe "#get_os" do

  subject { TestMe.new.get_os }

  context "on a linux machine" do

    before do
      OS.stub(linux?: true, mac?: false, doze?: false, bits: 64)
    end

    it { should eq 'linux64' }
  end

  context "on a mac" do

    before do
      OS.stub(linux?: false, mac?: true, doze?: false, bits: 64)
    end

    it { should eq 'mac' }
  end

  # etc etc
end 
```

# javascript - 带有 Javascript 的 Wordpress 根 URL

> ID：15121041
> 
> 赞同：0
> 
> 时间：2013-02-27T19:49:53.033
> 
> 标签：javascript, wordpress, url, root

我在我的 Wordpress 网站上使用这个脚本：[JQuery Plugin: Random Image](http://www.robwalshonline.com/posts/jquery-plugin-random-image-on-page-load/)

我遇到的问题是我不知道在路径部分中放置什么样的代码，以便 Wordpress 能够从图像文件夹中获取图像。/images 是不够的，因为它只会给我 www.mydomain.com/images/image.jpg，显然这不是使用 Wordpress 时的整个 URL。

我试过这个：[js脚本文件中的wordpress路径url](https://stackoverflow.com/questions/5221630/wordpress-path-url-in-js-script-file)

但是我无法让它工作。每当我放置

```
var templateUrl = '<?= get_bloginfo("template_url"); ?>'; 
```

在我的文件中，我得到一个错误

```
%3C?=%20get_bloginfo(%22template_url%22);%20?%3E/images/image.jpg 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T03:41:55.093

你必须回应它。

```
<?php echo get_bloginfo("template_url"); ?> 
```

或者你可以使用

```
<?php bloginfo("template_url"); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T11:02:46.827

好的，我通过反复试验得到了它，我将在这里列出我做错的事情，以防其他人遇到同样的问题：

1.  我将**var templateUrl**代码放在单独的 javascript 标记中。后来我把它移到了**$(document).ready(function() {**

2.  我将**templateUrl**放在实际的 .js 文件中。我后来把它移到： **$('.shuffle').randomImage({path: templateUrl + /images/});**

最终结果如下所示：

```
<script type="text/javascript">
var templateUrl = '<?php bloginfo('template_directory'); ?>';
    $(document).ready(function() {
        $('.shuffle').randomImage({path: templateUrl + /images/});
    });
</script> 
```

该脚本现在可以完美运行！感谢大家的帮助！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-13T21:05:11.617

```
<script type="text/javascript">
var themeFolder = '<?php echo get_template_directory_uri(); ?>'; 
</script> 
```

# regex - 解释手册中的一段

> ID：15121044
> 
> 赞同：2
> 
> 时间：2013-02-27T19:50:15.663
> 
> 标签：regex, bioinformatics, fasta

我正在尝试运行一些生物信息学软件（TE Displayer），但它根本不起作用。我认为问题可能在于软件如何识别 FASTA 标头。从文档中可以看出。

> 标题行中的序列标识符采用“\w(1,10)\d(2,9)”的模式，意思是“单词字符 (1-10) 后跟数字 (2-9)”，所以尽量避免标题行中的非标识符短语（例如“Build04”）。例如标题行 ">OrganismX Accession AC000282, build0.4" 很好，但不是 ">OrganismX Contig WX000282, Build04" 。因此，“>Oryza sativa Chromosome11”也可以，因为“Chromosome11”将被识别为标识符。

有人可以解释“\w(1,10)\d(2,9)”的确切用法吗？我将其理解为总共最多 12 个字符的任何单词，但它必须以两位数结尾。所以我不明白 Build0.4 怎么好，而 Build04 不好。

干杯!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T19:58:41.913

单独的序列标识符应该与模式匹配，因此在 中`">OrganismX Accession AC000282, build0.4"`，它的 the`AC000282`必须与正则表达式匹配，而不是`Build0.4`。

`\w(1,10)\d(2,9)`表示匹配一到十个单词字符，即任何一个`a-z A-Z 0-9 _`，后跟二到九位数字。

因为`Build04`会被那个模式匹配并且它不是序列标识符，所以建议避免。 `build0.4`将不匹配该模式，因为它包含 a `.`，所以很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:08:01.757

扩展 MikeM 所说的内容-您正试图让您的脚本识别`AC000282`. 上面的正则表达式将识别该字符序列。序列标识符`\w(1,10)\d(2,9)`表示“查找 1 到 10 个单词字符，后跟 2 到 9 个数字字符。然后，正则表达式将识别`Build04`为有 5 个单词字符 (BUILD)，后跟 2 个数字字符 (04)，但它不会识别`Build0.4`为`.`内部`Build0.4`会告诉正则表达式它不会被使用。

# python - 是否存在重载阶跃函数？

> ID：15121048
> 
> 赞同：31
> 
> 时间：2013-02-27T19:50:37.823
> 
> 标签：python, matlab

Python 中是否有类似于 MATLAB 的[重载](http://en.wikipedia.org/wiki/Heaviside_step_function)[`heaviside`](http://www.mathworks.co.uk/help/symbolic/heaviside.html)函数？

我正在努力寻找一个。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-02-27T21:21:35.973

如果您使用的是 numpy 1.13.0 或更高版本，您可以使用`numpy.heaviside`：

```
In [61]: x
Out[61]: array([-2\. , -1.5, -1\. , -0.5,  0\. ,  0.5,  1\. ,  1.5,  2\. ])

In [62]: np.heaviside(x, 0.5)
Out[62]: array([ 0\. ,  0\. ,  0\. ,  0\. ,  0.5,  1\. ,  1\. ,  1\. ,  1\. ]) 
```

使用旧版本的 numpy，您可以将其实现为`0.5 * (numpy.sign(x) + 1)`

```
In [65]: 0.5 * (numpy.sign(x) + 1)
Out[65]: array([ 0\. ,  0\. ,  0\. ,  0\. ,  0.5,  1\. ,  1\. ,  1\. ,  1\. ]) 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-03-06T04:18:58.220

可能最简单的方法就是

```
def step(x):
    return 1 * (x > 0) 
```

这适用于单个数字和 numpy 数组，返回整数，并且对于 x = 0 为零。`step(0) => 0.5`在某些情况下，最后一个标准可能更可取。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-02-27T19:57:25.983

它是[sympy](http://docs.sympy.org/0.6.7/modules/functions.html#heaviside)的一部分，您可以使用它进行安装`pip install sympy`

从文档：

```
class sympy.functions.special.delta_functions.Heaviside

Heaviside Piecewise function. Heaviside function has the following properties: 

1) diff(Heaviside(x),x) = DiracDelta(x)    ( 0, if x<0 )
2) Heaviside(x) = < [*] 1/2 if x==0        ( 1, if x>0 ) 
```

你会像这样使用它：

```
In [1]: from sympy.functions.special.delta_functions import Heaviside

In [2]: Heaviside(1)
Out[2]: 1

In [3]: Heaviside(0)
Out[3]: 1/2

In [4]: Heaviside(-1)
Out[4]: 0 
```

你也可以自己写：

```
heaviside = lambda x: 0.5 if x == 0 else 0 if x < 0 else 1 
```

尽管如果您需要符号变量，这可能无法满足您的需求。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-06-08T18:44:41.213

从 numpy 1.13 开始，它是`numpy.heaviside`.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-02-27T19:57:22.957

我不确定它是否是开箱即用的，但你总是可以写一个：

```
def heaviside(x):
    if x == 0:
        return 0.5

    return 0 if x < 0 else 1 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-07T02:29:30.277

不确定是否是完成工作的最佳方式......但这是我破解的功能。

```
def u(t):
    unit_step = numpy.arange(t.shape[0])
    lcv = numpy.arange(t.shape[0])
        for place in lcv:
            if t[place] == 0:
               unit_step[place] = .5
            elif t[place] > 0:
               unit_step[place] = 1
            elif t[place] < 0:
    unit_step[place] = 0
    return unit_step 
```

![Pylab 和 NumPy 的 Ipython 绘图](../Images/26f5ea04a27fdee8f8009fa5318b493d.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-10-20T22:07:46.773

```
def heaviside(xx):
    return numpy.where(xx <= 0, 0.0, 1.0) + numpy.where(xx == 0.0, 0.5, 0.0) 
```

或者，如果`numpy.where`太慢：

```
def heaviside(xx):
    yy = numpy.ones_like(xx)
    yy[xx < 0.0] = 0.0
    yy[xx == 0.0] = 0.5
    return yy 
```

以下时间为 numpy 1.8.2；在 numpy 1.9.0 中进行了一些优化，所以你自己试试吧：

```
>>> import timeit
>>> import numpy
>>> array = numpy.arange(10) - 5
>>> def one():
...  return numpy.where(array <= 0, 0.0, 1.0) + numpy.where(array == 0.0, 0.5, 0.0)
... 
>>> def two():
...  yy = numpy.ones_like(array)
...  yy[array < 0] = 0.0
...  yy[array == 0] = 0.5
...  return yy
... 
>>> timeit.timeit(one, number=100000)
3.026144027709961
>>> timeit.timeit(two, number=100000)
1.5265140533447266
>>> numpy.__version__
'1.8.2' 
```

在不同的机器上，使用不同的 numpy：

```
>>> timeit.timeit(one, number=100000)
0.5119631290435791
>>> timeit.timeit(two, number=100000)
0.5458788871765137
>>> numpy.__version__
'1.11.1'
>>> def three():
...  return 0.5*(numpy.sign(array) + 1)
... 
>>> timeit.timeit(three, number=100000)
0.313539981842041 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-18T06:00:02.977

简单的解决方案：

```
import numpy as np
amplitudes = np.array([1*(x >= 0) for x in range(-5,6)]) 
```

# c - cvFindContours 没有产生我期望的输出

> ID：15121050
> 
> 赞同：0
> 
> 时间：2013-02-27T19:50:41.430
> 
> 标签：c, opencv, image-processing

我有一个简单的、人为的示例，它使用带有 OpenCV C API 的 cvFindContours 在二进制图像上查找连接的组件。（这是用 C 编写的更大软件的一部分，因此不能选择使用 C++ API。）

样本输入图像由两个填充的、在黑色背景上的白色方块组成，它们不重叠。我希望从中得到两个轮廓，代表构成每个正方形周长的连接组件。相反，我得到了四个组件。为什么？详情如下。

首先，我在“self”中设置输入图像的阈值，这是一个 CV_32FC1 图像，背景像素为 0.0，白色像素（两个正方形）的值为 1.0：

```
cvThreshold(self, self, 0.8, 1.0, CV_THRESH_BINARY); 
```

然后我使用 cvScale 将输入图像复制到相同大小的 CV_32SC1 图像：

```
CvMat * temp = cvCreateMat(height, width, CV_32SC1);
cvConvertScale(self, temp, 1, 0); 
```

然后我执行 cvFindContours 来获取连接的组件：

```
CvSeq * components = 0;
CvMemStorage * mem = cvCreateMemStorage(0);
cvFindContours(temp, mem, &components, sizeof(CvContour), CV_RETR_CCOMP, CV_CHAIN_APPROX_SIMPLE, cvPoint(0,0)); 
```

然后我执行以下操作以输出构成轮廓的点并将它们绘制到窗口。

```
for(; components != 0; components = components->h_next)
    {
        printf("===============NEW COMPONENT!============\n");
        if (components->v_next) printf("This has a child.\n");
        CvPoint * pt_array = (CvPoint *)malloc(components->total*sizeof(CvPoint));

        cvCvtSeqToArray(components, pt_array, CV_WHOLE_SEQ);
        for (int i = 0; i < components->total; i++)
        {
            printf("Point %i: %i, %i\n", i, pt_array[i].x, pt_array[i].y);
    }
    free(pt_array);
    outer_color = CV_RGB(rand()%255, rand()%255, rand()%255);
    cvDrawContours(dst, components, outer_color, inner_color, -3, 1, 8, cvPoint(0,0));
} 
```

我希望这会产生两个轮廓，代表我的二进制图像中两个白色方块的周长。相反，我得到了四个大致相互重叠的顶级轮廓。是什么赋予了？

四个轮廓中的点如下：

```
===============NEW COMPONENT!============
Point 0: 200, 150
Point 1: 200, 199
Point 2: 199, 200
Point 3: 150, 200
Point 4: 149, 199
Point 5: 149, 150
Point 6: 150, 149
Point 7: 199, 149
===============NEW COMPONENT!============
Point 0: 150, 150
Point 1: 150, 199
Point 2: 199, 199
Point 3: 199, 150
===============NEW COMPONENT!============
Point 0: 50, 10
Point 1: 50, 49
Point 2: 49, 50
Point 3: 10, 50
Point 4: 9, 49
Point 5: 9, 10
Point 6: 10, 9
Point 7: 49, 9
===============NEW COMPONENT!============
Point 0: 10, 10
Point 1: 10, 49
Point 2: 49, 49
Point 3: 49, 10 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:59:31.887

在黑暗中拍摄，但我知道轮廓方法标志控制结果集结构。也许尝试将 CV_RETR_CCOMP 标志与[此处](http://www.emgu.com/wiki/files/1.5.0.0/Help/html/95b2e17e-3891-d3e3-cbba-4a844b0cf874.htm)描述的标志之一交换。

该[链接](https://stackoverflow.com/questions/8461612/using-hierarchy-in-findcontours-in-opencv)解释了标志 CV_RETR_CCOMP 的工作原理。

不过，这很奇怪，我也不希望您得到结果。

# html - 浏览器显示我的 html 页面的缓存副本

> ID：15121057
> 
> 赞同：1
> 
> 时间：2013-02-27T19:50:55.090
> 
> 标签：html, tomcat

我编写了一个 HTML 页面并将其托管在 tomcat 服务器中（与其他 JSP 页面一起）。我在 HTML 页面中更改了一些内容，但似乎 tomcat 仍在提供旧的缓存 html。即使现在已经过了很多天。

我怎么能指示tomcat使用更新的修改过的html页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:53:33.653

您可以强制浏览器硬刷新您的网页，只需在此处使用 JavaScript

```
location.reload(true); //If false, browser will use the cached info 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:53:17.770

例如，我在某处读到将一些随机字符串放在样式表中

```
<link rel="stylesheet" href="style.css?randomstring" type="text/css" /> 
```

所以浏览器会再次加载css，但不知道会不会重新加载html内容，你可以试试。要生成随机字符串，您需要 PHP

# android - 如何通过 adb（或通过 Python 命令）获取 android 内核版本？

> ID：15121061
> 
> 赞同：9
> 
> 时间：2013-02-27T19:51:11.340
> 
> 标签：android, python, kernel, adb

我需要具有 Android 操作系统的设备的内核版本才能在 Python 脚本中使用。我怎样才能得到这个值？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-27T19:59:32.773

您可以使用以下命令：

```
adb shell cat /proc/version 
```

对于我的手机，我收到以下输出：

```
Linux version 2.6.35.7-g3cc95e3 (peter@boris) (gcc version 4.4.3 (GCC) ) #3 PREEMPT Thu Aug 18 14:34:17 EDT 2011 
```

# ios - 仅显示 ISO 8601 时间戳中的 12 小时时间格式

> ID：15121065
> 
> 赞同：4
> 
> 时间：2013-02-27T19:51:18.023
> 
> 标签：ios

所以我想在我的 iOS 应用程序的标签中显示从我们的服务器传递的时间，但我在试图弄清楚如何设置正确的 NSDateFormatter 时遇到了麻烦。因此，例如，我以这种格式从服务器获取此时间戳：2013-02-27T18:15:00-0800，我基本上想在标签中显示“10:15 AM”，但到目前为止我还没有运气。我在下面试过这个：

```
NSDateFormatter *timeFormatter = [[[NSDateFormatter alloc] init] autorelease];
            [timeFormatter setDateFormat:@"HH:mm a"];
            NSString *newTime = [timeFormatter stringFromDate:timeDate];
            NSLog(@"the new time is: %@", newTime); 
```

但输出显示我的时间为晚上 18:15。

我一直在环顾四周并在 NSDateFormatter 中尝试不同的组合，但我似乎找不到合适的组合，任何帮助将不胜感激，因为我知道这是我忽略的简单但我找不到的东西它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T19:56:55.343

HH 代表 24 小时。

hh satnds 12 小时。

相应地改变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T19:57:04.767

您正在使用 24 小时格式的 HH 设置时间格式，为了设置 12 小时格式，请使用以下代码，虽然不必写太多，正如代码行所说的那样。

```
[timeFormatter setDateFormat:@"hh:mm a"]; 
```

为了避免时区问题，请确保您也为格式化程序设置了时区

```
[timeFormatter setTimeZone:[NSTimeZone timeZoneWithName:@"CET"]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T19:55:12.410

你需要使用`hh`，而不是`HH`。前者为 12 小时，后者为 24 小时。

# smalltalk - 在 readSmtpResult 中执行 WAEmailMessage 时 GEMSTONE 挂起

> ID：15121068
> 
> 赞同：2
> 
> 时间：2013-02-27T19:51:27.420
> 
> 标签：smalltalk, seaside, gemstone

我已经在我的 MAC 上安装了 MACOSX Lion，最新版本的 Gemtools **(1.0 beta 87** ) 和最新版本的 glass workspace **(1.0 beta 8.7.4)**和最新版本的 GEMSTONE: **3.1.0.1。** 在这个我已经加载了海边使用：

```
MCPlatformSupport commitOnAlmostOutOfMemoryDuring: [    
    Gofer project load: 'Seaside30' version: '3.0.7.1'.    

    Gofer new
    squeaksource: 'MetacelloRepository';
    package: 'ConfigurationOfMetacello';
    load.
    (Smalltalk at: #ConfigurationOfMetacello) perform: #load.

    Gofer new
    squeaksource: 'MetacelloRepository';
    package: 'ConfigurationOfSeasideRest';
    load.

].
ConfigurationOfSeasideRest project stableVersion load: 'Tests' 
```

一切正常，但如果我尝试评估这件作品，系统会“挂起”：

```
(WAEmailMessage
     from: (WAEmailAddress address: 'xx@aa.com' username: 'fromman')
     to: (WAEmailAddress address: 'shyam1.sundaresan1@gmail.com' username: 'shyam')
     subject: 'Email Test')   
          body: 'This is a Test Email sent'; 
          send. 
```

通过调试，我看到它挂起的地方是在**SendMail >> send**

```
send
    | rc |
    ^self isEnabled
    ifFalse: [self saveToFile]
    ifTrue: [ self halt.
        rc := self openTcpConnection.
        rc
            ifTrue: 
                [   rc ifTrue: [rc := self readSmtpResult] "==> HANGS HERE ==>"
                rc ifTrue: [rc := self sendHelo].
                rc ifTrue: [rc := self readSmtpResult].
                rc ifTrue: [rc := self sendMailFrom].
                rc ifTrue: [rc := self readSmtpResult]. 
```

具体来说，它不会（永远）退出以下循环**whileFalse** in **readSmtpResult**：

```
readSmtpResult
| result firstChar |

    [self readWillNotBlockWithin: 5000]
        whileFalse: [GsFile stderr log: 'Waiting for server to write...']. 
```

使用 Telnet，该端口连接良好

```
shyam:opt shyam$ telnet mailhost 25
Trying ::1...
Connected to localhost.
Escape character is '^]'.
220 shyam.homenet.telecomitalia.it ESMTP Postfix 
```

我还检查了 smtpHost、smtpPort、ownDomainName 等......都是正确的。*还注意到/var/log/mail.log*中没有写任何内容

 *此外，**同一台机器上的 PHARO 1.4 引擎 + Seaside 上的同一段代码**工作正常，并且使用以下命令行，邮件通过 gmail 正确中继。

```
echo 'It works' | mailx -s 'Test message' shyam1.sundaresan1@gmail.com 
```

任何可以帮助我克服僵局的指标都将受到欢迎。

谢谢

夏姆。*

# java - 为什么我需要在通知观察者之前调用 setChanged？

> ID：15121071
> 
> 赞同：27
> 
> 时间：2013-02-27T19:51:41.580
> 
> 标签：java

我最近阅读了 Java 的[Observable](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Observable.html#setChanged%28%29)类。我不明白的是：在通知观察者（notifyObservers()）之前，我必须调用 setChanged()。notifyObservers 方法中有一个布尔值，需要我们调用 setChanged。布尔值的用途是什么，为什么我必须调用 setChanged()？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-27T19:56:43.363

在长时间的处理中，您可能会调用多次[setChanged()](http://docs.oracle.com/javase/7/docs/api/java/util/Observable.html#setChanged%28%29)但最后只调用一次[notifyObservers()](http://docs.oracle.com/javase/7/docs/api/java/util/Observable.html#notifyObservers%28%29)。如果在结束之前，由于内部原因您决定回滚，您可以选择调用[clearChanged()](http://docs.oracle.com/javase/7/docs/api/java/util/Observable.html#clearChanged%28%29)。在后一种情况下，[notifyObservers()](http://docs.oracle.com/javase/7/docs/api/java/util/Observable.html#notifyObservers%28%29)无效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-04-09T20:17:37.717

`setChanged()`

> 将此 Observable 对象标记为已更改；hasChanged 方法现在将返回 true。

```
notifyObservers() 
```

> 如果该对象发生了变化，如 hasChanged 方法所示，则通知其所有观察者，然后调用 clearChanged 方法以指示该对象不再更改。

基本上你`setChanged()`用来通知观察者超类发生了变化。然后你调用这个`notifyObservers()`方法来告诉观察者发生了什么变化。

那里的 setChanged() 因为它允许类在通过调用通知观察者之前撤消更改`clearChanged()`。如果您没有 setChanged() 标志，那么您实际上是在通知观察者并且没有检测到任何更改，因此他们不会响应“通知”。

请参阅我的代码以获取更多说明：

主要方法公共类 SpeedRunner {

```
public static void main(String[] args) {
    SpeedMonitor monitor = new SpeedMonitor();
    // Create a speedometer and register the monitor to it...
    SpedoMeter speedo = new SpedoMeter();
    speedo.addObserver(monitor);
    // Drive at different speeds...
    speedo.setCurrentSpeed(50);
    speedo.setCurrentSpeed(70);
    speedo.setCurrentSpeed(40);
    speedo.setCurrentSpeed(100);
    speedo.setCurrentSpeed(69);
} 
```

观察者（当有趣的事情发生时被通知的对象）：

```
//this is the observer since it is observing changes in the speedo.
public class SpeedMonitor implements Observer {
public static final int SPEED_TO_ALERT = 70;

public void update(Observable obs, Object obj) {
    SpedoMeter speedo = (SpedoMeter) obs;
    if (speedo.getCurrentSpeed() > SPEED_TO_ALERT) {
        System.out.println("** ALERT ** Driving too fast! (" + speedo.getCurrentSpeed() + ")");
    } else {
        System.out.println("... nice and steady ... (" + 
        speedo.getCurrentSpeed() + ")");
        }
    }
} 
```

主题（感兴趣的对象）

```
public class SpedoMeter extends Observable{
private int currentSpeed;

public SpedoMeter(){
    currentSpeed = 0;
}

public void setCurrentSpeed(int speed){
    currentSpeed = speed;

//        setChanged();
    notifyObservers();
}

        public int getCurrentSpeed() {
        return currentSpeed;
    }

} 
```

注释掉 setChanged() ，你会注意到观察者没有拾取任何东西，因此控制台是空的。

看这本教科书。学习设计模式真的很好。

> 贝维斯，托尼。Java 设计模式要点（Kindle 位置 1835）。能力第一限制。Kindle版。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-24T13:53:19.327

setchanged() 用作更改状态的指示或标志。如果为 true，则 notifyObservers() 可以运行并更新所有观察者。如果为 false，则在不调用 setchanged() 的情况下调用 notifyObservers()，并且不会通知观察者。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-21T12:48:17.827

可能的原因可能是 setChanged() 具有受保护的修饰符。同时，notifyObservers() 可以在任何地方调用，甚至可以由观察者调用。从那以后，observable 和observer 可以通过这种机制相互交互。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-29T03:46:12.087

```
public void notifyObservers(Object arg) {
    /*
     * a temporary array buffer, used as a snapshot of the state of
     * current Observers.
     */
    Observer[] arrLocal;

    synchronized (this) {
        /* We don't want the Observer doing callbacks into
         * arbitrary Observables while holding its own Monitor.
         * The code where we extract each Observable from
         * the ArrayList and store the state of the Observer
         * needs synchronization, but notifying observers
         * does not (should not).  The worst result of any
         * potential race-condition here is that:
         *
         * 1) a newly-added Observer will miss a
         *   notification in progress
         * 2) a recently unregistered Observer will be
         *   wrongly notified when it doesn't care
         */
        if (!hasChanged())
            return;

        arrLocal = observers.toArray(new Observer[observers.size()]);
        clearChanged();
    }

    for (int i = arrLocal.length-1; i>=0; i--)
        arrLocal[i].update(this, arg);
} 
```

评论是原因

# c++ - glTexImage*D 参数冗余？

> ID：15121072
> 
> 赞同：2
> 
> 时间：2013-02-27T19:51:42.863
> 
> 标签：c++, opengl

为什么 glTexImage1D、glTexImage2D 和 glTexImage3D 函数需要内部格式（即 GL_RGBA8、GL_R32UI 等）和像素格式？(GL_RGBA,GL_RED_INTEGER)

在我看来，像素格式可以很容易地从内部格式中解释出来。我问这个不仅仅是出于好奇，而是因为我确保我编写的 OpenGL 纹理对象和帧缓冲区对象包装器（从内部格式推断像素格式）能够正确提取所有内部格式的像素格式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T19:58:03.633

像素格式是您提供纹理数据的格式，内部格式是 OpenGL 在内部存储它的方式。OpenGL 将自动处理转换。

glTexImage2D的[手册页](http://www.opengl.org/sdk/docs/man/xhtml/glTexImage2D.xml)有一组很好的内部格式布局表，还解释了每种格式的转换方式。

例如，如果你有一个像素格式`GL_RG`和一个内部格式`GL_COMPRESSED_RGBA`，GL 会将整个蓝色通道填充为 0，将 alpha 通道填充为 1，然后进行自己的内部压缩。

> 每个元素都是红/绿双色。GL 将其转换为浮点数并通过附加 0 表示蓝色和 1 表示 alpha 将其组合成一个 RGBA 元素。然后将每个分量乘以有符号比例因子 GL_c_SCALE，添加到有符号偏差 GL_c_BIAS，并限制在 [0,1] 范围内。

# c# - 哪个过滤器在 LDAP 中搜索所有用户更快？

> ID：15121074
> 
> 赞同：1
> 
> 时间：2013-02-27T19:51:45.420
> 
> 标签：c#, active-directory, indexing, ldap

我有这个：

> (&(objectCategory=person)(objectClass=user))

和这个：

> (&(objectCategory=user)(samaccountname=*))

哪个会更快？我对 Active Directory 架构不太熟悉...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:58:36.627

这取决于服务器。如果`objectCategory`具有相等索引并且`objectClass`具有相等索引*并且* `samAccountName`具有`present`索引，则返回的条目数和每个条目的字节数（由请求的属性决定）将计入完成搜索的成本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T11:37:27.037

如前所述，就性能而言，有很多服务器条件可以影响结果。

还取决于您希望返回的条目类型。当您使用 Active Directory 时，您应该尝试以下方法之一：

所有用户：

```
(&(objectCategory=person)(objectClass=user)) 
```

或（我们通常认为这更快）

```
(sAMAccountType=805306368) 
```

所有联系人：

```
(objectClass=contact) 
```

所有用户和联系人：

```
(objectClass=user) 
```

-吉姆

# php - PHP/MySQL while 循环不解析

> ID：15121082
> 
> 赞同：0
> 
> 时间：2013-02-27T19:52:01.943
> 
> 标签：php, javascript, ajax

我修改了以下代码以进行连接，然后为以后的表单元素构建一个数组：

```
$usersitems = '';
$db_connection = mysql_connect($dbhost,$dbuser,$dbpassword);
if($db_connection && mysql_select_db($dbname,$db_connection)){
    $usersquery = 'SELECT DISTINCT tablea.uid, tableb.FirstName, tableb.LastName FROM tablea, tableb WHERE tablea.uid = tableb.EmpNo ORDER BY tablea.uid ASC';
    $users = mysql_query($usersquery,$db_connection);
    if($users){
        while ($user = mysql_fetch_array($users, MYSQL_NUM)) {
            $usersitems .= '<option value="'.$user[0].'">'.$user[0].'- '.$user[1].' '.$user[2].'</option>';  
        }
        mysql_free_result($users);
    }
    mysql_close($db_connection);
} 
```

我还更新了选项以包括 [1] 和 [2] 以显示原始选项中每个选项的名字和姓氏：

```
<option>'.$user[0].'</option> 
```

这成功地创建了这个：

`<select id="user_id"><option value="104">104- John Doe</option>`

在我的 javascript 中，我发现这行文本我认为用于使用表单中的选定内容：

```
uid = $("#user_id option:selected").text(); 
```

现在突然这不起作用？我假设这是因为原来的 '.$user[0].' 不是在选项中寻找 value="'.$user[0].'" 。我该如何修改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:55:55.903

将您的代码更改为：

```
uid = $("#user_id").val(); 
```

这将返回所选选项的值。

这也适用于您执行选项的旧方式。如果选项没有`value`属性，则默认使用文本。

# sql - SQL查询中的返回数字

> ID：15121084
> 
> 赞同：0
> 
> 时间：2013-02-27T19:52:07.097
> 
> 标签：sql, oracle, oracle11g

我有这个 Oracle SQL 查询，我用它来将组件计数到表中：

```
 select ct.name as component_type, count(1) as cnt from componentstats cs, componenttype ct
WHERE CS.COMPONENTTYPEID = CT.COMPONENTTYPEID AND CT.COMPONENTTYPEID IN (1000, 1300, 4000)
group by ct.name  order by ct.name; 
```

这是输出：

```
COMPONENT_TYPE                                                                                       CNT                    
---------------------------------------------------------------------------------------------------- ---------------------- 
DATACENTER                                                                                           1                      
ISP                                                                                                  1                      
NETWORK                                                                                              1 
```

我注意到，如果没有类型为 1300 的组件，我会得到两个值 1 和 1。我需要得到结果 1、0、1，因为数字的顺序必须严格。你能告诉我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:06:00.800

为此，您需要一个外部连接。这是您应该使用标准 ANSI 连接语法的一个很好的理由。

您还需要`count()`从外部联接的“外部”部分更改计数。这是使用编写的查询`left outer join`：

```
select ct.name as component_type, count(cs.componenttypeid) as cnt
from componenttype ct left outer join
     componentstats cs
     on CS.COMPONENTTYPEID = CT.COMPONENTTYPEID
where CT.COMPONENTTYPEID IN (1000, 1300, 4000)
group by ct.name
order by ct.name; 
```

# jquery - JQuery长动画——分节

> ID：15121085
> 
> 赞同：0
> 
> 时间：2013-02-27T19:52:07.190
> 
> 标签：jquery, animation

我有一个超过 15 页的 JQuery 动画点击。客户端希望它自动启动，如果保持不变，动画将一直播放。有没有办法按步骤或分段来做，比如播放这个部分，完成后播放下一个部分，依此类推，直到最后？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T21:04:33.183

您可以简单地使用回调：

```
$("something").animate({stuff}, duration, function(){
    // CALL NEXT STEP HERE, THIS EXECUTES WHEN ANIMATION COMPLETES
}); 
```

[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

# javascript - 何时使用 throw 或 log 错误？

> ID：15121086
> 
> 赞同：0
> 
> 时间：2013-02-27T19:52:08.143
> 
> 标签：javascript

我有一个像这样包装 console.log 的函数。

```
NS.log("error"); 
```

我用于错误记录。这是让应用程序开发人员知道出现问题的简单方法。它不会停止程序流程并在控制台中不显眼地显示。

但是，我在大学课程等中听说使用 try/throw/catch 是最佳实践，因为它使用了已经存在的错误控制系统。

但是，我不需要在 throw 语句之后将错误“冒泡”。我会像这样立即抓住它：

```
try {
    throw "error"
} catch (e) {
} 
```

与使用更正式的结构相比，简单地记录错误是否有任何缺点。

我的假设是 try/throw/catch 用于更复杂的结构。

但我想确定一下。

**笔记：**

*   requirejs 共使用 throw 4 次 | 不使用控制台或日志

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:02:33.500

如果它适用于您和您的合作伙伴，那么它适用；并且没有必要改变。

从技术上讲`try/throw/catch`是最佳实践，在大多数语言中，这就是您应该使用的。

然而，在 javascript 中，我可以告诉你它`try/throw/catch`的性能很差。javascript中的许多错误也是动态的。应该处理的是。但是其中很多*不会*破坏您的应用程序。

那么，你为什么要他们冒泡并惹恼你的用户呢？

**TL：DR**我并不反对使用`try/throw/catch`有时你*应该*使用它，正如@JohnSaunders 所说。但事实上，在 javascript 中，错误*通常不会*破坏任何东西，而且您*经常*使用`try/throw/catch`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:02:26.013

我很高兴您正在考虑您的选择并考虑整个过程。然而

1.  try 语句允许您测试代码块的错误。
2.  catch 语句允许您处理错误。
3.  throw 语句允许您创建自定义错误。

因此，在您的情况下，如果您有某种日志过程，请使用 try catch。例子

```
try {

} catch (e) {
   NS.log(err);
} 
```

[更多信息/来源](http://www.w3schools.com/js/js_errors.asp)

# plugins - 选择列表中的动态内容

> ID：15121087
> 
> 赞同：0
> 
> 时间：2013-02-27T19:52:10.987
> 
> 标签：plugins, dynamics-crm-2011

我将创建一个解决方案，其中表单将携带一个选择列表，该列表包含服务器上声明的所有实体的名称。该列表需要在每次使用时动态更新。

我之前部署的解决方案是在 iframe 中设置 Web 资源，从而完全控制它的动态设置。它有效并且运作良好。

现在，出于好奇，我想知道是否可以使用内置的*选项列表*组件来解决它。也许如果我使用了一个插件，该插件在显示配备*选择列表*的表单之前触发并更改为其声明的底层选项集的元数据......

想过这个吗？
替代建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:00:42.170

我相信应该可以在实体（不是对象，而是实体的实际元数据）的创建/更新/删除上触发插件，更新全局选项集列表。然后你可以让 CRM 为你填充它......

我不知道推荐，但它会被支持。

使用*InsertOptionValueRequest*添加新值。

这强制发布：

```
service.Execute( new PublishXmlRequest
{
  ParameterXml = String.Format(
    "<importexportxml><entities><entity>{0}</entity></entities></importexportxml>", 
    "EntitySetLogicalName")
}); 
```

# ruby - ruby on rails 中的“calendar_for”

> ID：15121091
> 
> 赞同：0
> 
> 时间：2013-02-27T19:52:31.173
> 
> 标签：ruby

嗨所以我试图显示一个里面有许多电影标题的日历，问题是我想从另一个模型中提取日期并且它不起作用。

**视图文件（电影）中的当前代码**

```
<%= calendar_for @films, :year => @date.year, :month => @date.month do |calendar| %>
<%= calendar.head('Sun','Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat') %>
<%= calendar.day(:day_method => :date_of_release) do |date, films| %>
<%= date.day %>
<ul>
<% for film in films %>
  <%= link_to h(film.title), film %>
  </br>
  <% end %>
  </ul>
<% end %> 
```

该代码似乎工作得很好，并根据它们的发布日期显示电影，这是电影模型的一个属性我想要做的是显示它屏幕上的日期，即从“显示”模型中提取日期。到目前为止我得到了..

```
<%= calendar_for @film.showings, :year => @date.year, :month => @date.month do |calendar|%>
<%= calendar.head('Sun','Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat') %>
<%= calendar.day(:day_method => :date) do |date, films| %>
<%= date.day %>
<ul>
  <% for showing in showings %>
  <%= link_to h(showing.film.title), film %>
  </br>
  <% end %>
  </ul>
<% end %> 
```

但不断收到错误“nil:NilClass 的未定义方法‘显示’”

这两个模型是相关的...film- has_many :showings &showing- belongs_to :film

电影控制器中的代码：

def whats_on @films = Film.all @date = params[:month] ？Date.strptime(params[:month]) : Date.today 结束

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:03:04.913

实例变量`@films`和`@date`在控制器中定义。所以你可以在 html 模板中使用它们。但是`@film`没有定义。默认情况下，它具有`nil`价值。你应该初始化它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-02T19:23:58.840

尝试这个：

```
<% for showing in @film.showings %> 
```

# python - 带时区的默认日期时间字符串格式

> ID：15121092
> 
> 赞同：8
> 
> 时间：2013-02-27T19:52:36.073
> 
> 标签：python, date, datetime

我将默认的 python 日期时间字符串格式与 JSON 网络服务一起使用。

然后，我试图将它与实际的日期时间进行比较。而且我也在使用时区`pytz.utc`。

这是我的字符串日期：

```
print date
2013-02-26 21:28:37.261134+01:00 
```

尝试将我的字符串转换为日期时间（使用 编辑时区`pytz`）：

```
if datetime.strptime(date, '%Y-%m-%d %H:%M:%S.%f+%Z') < datetime.now(pytz.utc): 
```

不幸的是，它不起作用。

```
ValueError: time data '2013-02-26 21:28:37.261134+01:00' does not match format '%Y-%m-%d %H:%M:%S.%f%Z' 
```

谁能告诉我`strptime`格式的正确语法，使用我的日期？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T20:11:22.447

基本上这是因为 datetime 模块不提前知道可用时区是什么。这有点蹩脚。

我建议使用[dateutil](http://labix.org/python-dateutil)。这是一个第三方包，但它会解析你的字符串。

```
>>> import dateutil.parser
>>> dateutil.parser.parse('2013-02-26 21:28:37.261134+01:00')                                                                                                                                                                                                                  
datetime.datetime(2013, 2, 26, 21, 28, 37, 261134, tzinfo=tzoffset(None, 3600)) 
```

# python - Django：在查询中添加“NULLS LAST”

> ID：15121093
> 
> 赞同：96
> 
> 时间：2013-02-27T19:52:43.747
> 
> 标签：python, sql, django

我想使用 Postgresql 的“NULLS LAST”选项对模型进行排序。怎么可能做到？

我尝试了类似的东西

`MyModel.objects.all().extra(order_by=('-price', 'NULLS LAST'))`

但我明白了

“无法将关键字 'NULLS LAST' 解析为字段”

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2017-03-14T23:44:43.717

```
from django.db.models import F  
MyModel.objects.all().order_by(F('price').desc(nulls_last=True)) 
```

此功能已添加到 Django 1.11。

[https://docs.djangoproject.com/en/dev/releases/1.11/](https://docs.djangoproject.com/en/dev/releases/1.11/)

> 在 Expression.asc() 和 desc() 中添加了 nulls_first 和 nulls_last 参数以控制 null 值的顺序。

Django 3.1 参考：[https ://docs.djangoproject.com/en/3.1/ref/models/expressions/#using-f-to-sort-null-values](https://docs.djangoproject.com/en/3.1/ref/models/expressions/#using-f-to-sort-null-values)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-02-28T00:26:11.523

我发现最接近的事情是分两步完成。首先对填充字段进行排序，然后对空值进行排序：

通过[这个](https://gist.github.com/jpadilla/4210782)要点（本身通过这些[django 日志](http://django-irc-logs.com/2012/dec/05/)）：

```
all_projects = Project.objects.select_related().filter(
    company=company).order_by('-date_due')

q = all_projects.extra(select={'date_due_null': 'date_due is null'})
q = q.extra(order_by=['date_due_null'])
print q.query 
```

注意：请注意有关 的[警告`extra()`，并且将来可能会弃用它](https://docs.djangoproject.com/en/3.1/ref/models/querysets/#extra)。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-06-13T00:38:23.200

如果您希望它在所有列上透明地完成，您可以重新定义 sql 生成。为此，您需要拥有自己的 Manager 来返回您的自定义 QuerySet 以返回您的自定义 Query 以使用自定义编译器。我的代码看起来像这样（Django 1.5）：

```
from django.db import models, connections

class NullsLastQuery(models.sql.query.Query):
    """
    Query that uses custom compiler,
    to utilize PostgreSQL feature of setting position of NULL records
    """
    def get_compiler(self, using=None, connection=None):
        if using is None and connection is None:
            raise ValueError("Need either using or connection")
        if using:
            connection = connections[using]

        # defining that class elsewhere results in import errors
        from django.db.models.sql.compiler import SQLCompiler
        class NullsLastSQLCompiler(SQLCompiler):
            def get_ordering(self):
                result, group_by = super(NullsLastSQLCompiler, self
                    ).get_ordering()
                if self.connection.vendor == 'postgresql' and result:
                    result = [line + " NULLS LAST" for line in result]
                return result, group_by

        return NullsLastSQLCompiler(self, connection, using)

class NullsLastQuerySet(models.query.QuerySet):
    def __init__(self, model=None, query=None, using=None):
        super(NullsLastQuerySet, self).__init__(model, query, using)
        self.query = query or NullsLastQuery(self.model)

class NullsLastManager(models.Manager):
    def get_query_set(self):
        return NullsLastQuerySet(self.model, using=self._db)

class YourModel(models.Model):
    objects = NullsLastManager() 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-03-23T21:05:05.873

当被问到这个问题时，这可能不可用，但从 Django 1.8 开始，我认为这是最好的解决方案：

```
from django.db.models import Coalesce, Value
MyModel.objects.all().annotate(price_null=
    Coalesce('price', Value(-100000000)).order_by('-price_null') 
```

`Coalesce`选择第一个非空值，因此您创建一个值`price_null`来订购，它只是价格，但`null`替换为`-100000000`（或`+`？）。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-02-19T00:03:22.650

对于 Django 1.9（可能还有 1.8），您可以使用：

```
from django.db import connections, models
from django.db.models.sql.compiler import SQLCompiler

class NullsLastSQLCompiler(SQLCompiler):
    def get_order_by(self):
        result = super().get_order_by()
        if result and self.connection.vendor == 'postgresql':
            return [(expr, (sql + ' NULLS LAST', params, is_ref))
                    for (expr, (sql, params, is_ref)) in result]
        return result

class NullsLastQuery(models.sql.query.Query):
    """Use a custom compiler to inject 'NULLS LAST' (for PostgreSQL)."""

    def get_compiler(self, using=None, connection=None):
        if using is None and connection is None:
            raise ValueError("Need either using or connection")
        if using:
            connection = connections[using]
        return NullsLastSQLCompiler(self, connection, using)

class NullsLastQuerySet(models.QuerySet):
    def __init__(self, model=None, query=None, using=None, hints=None):
        super().__init__(model, query, using, hints)
        self.query = query or NullsLastQuery(self.model) 
```

然后在您的模型上：

```
objects = NullsLastQuerySet.as_manager() 
```

这是基于 Tim 在[https://stackoverflow.com/a/17077587/15690](https://stackoverflow.com/a/17077587/15690)中的回答。

向 Django 添加对此支持的票已重新打开：[https](https://code.djangoproject.com/ticket/13312) ://code.djangoproject.com/ticket/13312 。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-04-16T17:45:03.140

[@kabucey 的答案](https://stackoverflow.com/questions/15121093/django-adding-nulls-last-to-query/42798609#42798609)最适合 Django >= 1.11，但如果您至少使用 Django 1.8、1.9 或 1.10，则可以使用自定义`Func`表达式来实现“NULLS Last”行为，如[https://www.isotoma中所述.com/blog/2015/11/23/sorting-querysets-with-nulls-in-django/](https://www.isotoma.com/blog/2015/11/23/sorting-querysets-with-nulls-in-django/)：

```
from django.db.models import Func

class IsNull(Func):
    template = '%(expressions)s IS NULL'

MyModel.objects.all().annotate(
    price_isnull=IsNull('price_isnull'),
    ).order_by(
        'price_isnull',
        '-price',
        ) 
```

第一个`order_by`参数按升序对列表进行排序`price_isnull`，从 开始强制将空价格项目放在列表末尾`True > False`。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-06-08T15:31:52.910

还有另一种方法可以使用 Django v1.11 样式向 Django < v1.11 添加托管空值功能：

```
from my_project.utils.django import F
MyModel.objects.all().order_by(F('price').desc(nulls_last=True))
# or
MyModel.objects.all().order_by(F('price').desc().nullslast()) 
```

缺点：

1.  轻松迁移到 Django 1.11
2.  我们不会深入到查询编译器内部

为此，我们需要覆盖 django.db.models.F 和 django.db.models.expressions.OrderBy 类：

```
from django.db.models import F as DjangoF
from django.db.models.expression import OrderBy as DjangoOrderBy

class OrderBy(DjangoOrderBy):
    def __init__(self, expression, descending=False, nulls_last=None):
        super(OrderBy, self).__init__(expression, descending)
        self.nulls_last = nulls_last
    ...

    def as_sql(self, compiler, connection, template=None, **extra_context):
        ...
        ordering_value = 'DESC' if self.descending else 'ASC'
        if self.nulls_last is not None:
            nulls_value = 'LAST' if self.nulls_last else 'FIRST'
            ordering_value += ' NULLS ' + nulls_value

        placeholders = {
            'expression': expression_sql,
            'ordering': ordering_value,
        }
        ...

    def nullslast(self):
        self.nulls_last = True

    def nullsfirst(self):
        self.nulls_last = False

class F(DjangoF):
    ...

    def asc(self, nulls_last=None):
        return OrderBy(self, nulls_last=nulls_last)

    def desc(self, nulls_last=None):
        return OrderBy(self, descending=True, nulls_last=nulls_last) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-01-16T05:30:23.500

我们想用 NULLS LAST 链接多个 order by 语句，一些 ASC，一些 DESC。order_by 似乎没有这种可能性，因为它有以下调用：

```
obj.query.clear_ordering(force_empty=False) 
```

因此，您可以通过附加 add_ordering 调用来执行以下操作：

```
qs = ATeamModel.objects.filter(whatever=1)
qs.query.add_ordering(F('date_updated').desc(nulls_last=True))
qs.query.add_ordering(F('date_created').desc(nulls_last=True))

qs... 
```

# angularjs - 如何在不重新加载页面的情况下第二次使用 $hhtp.get() 更新 AngularJS 控制器中的数据

> ID：15121094
> 
> 赞同：2
> 
> 时间：2013-02-27T19:52:46.167
> 
> 标签：angularjs, angularjs-scope

我的观点如下（为简洁起见）：

```
<ul class="nav nav-tabs nav-stacked">
    <li ng-repeat="i in range">
        <a id="list{{i}}" ng-click="ShowList(i)">
            List Item {{i}}
        </a>
    </li>
</ul>

<ng-switch on="listItemType">
    <div ng-switch-when="1">
        <form-a></form-a>
    </div>
    <div ng-switch-when="2">
        <form-b></form-b>
    </div>
    <div ng-switch-when="3">
        <form-c></form-c>
    </div>
</ng-switch> 
```

`<form-a>, <form-b>, <form-c>`是加载模板Url并拥有自己的控制器的角度指令。

上述视图的控制器是：

```
var listCount;
var listIds = [];
$http.get('/api/lists').
    success(function(data) {
        $scope.lists = data.lists;

        for (listCount = 1; listCount <= $scope.lists.length; listCount++) {
            listIds.push(listCount);
        }

        $scope.range = listIds;
    });
$scope.ShowList = function(listNumber) {
    $scope.listItemType = $scope.lists[listNumber - 1].listType;
}; 
```

可以看出，这个控制器使用 $http.get() 获取一些数据。
现在，用于`<form-a>`发布一些数据的控制器。这将更新上述控制器已获取的相同数据。换句话说，我需要`<li>`在视图开头的标签中添加一个新条目。

**但是，该页面的控制器已经完成了 $http.get() 请求。我如何要求它再次获取数据，以便更新第一个控制器中的列表信息？换句话说，在数据发生变化的情况下，第一个控制器中是否有一个事件处理程序可以用来再次 $http.get() 数据？**
由于页面没有刷新或重新加载，控制器，我上面的代码只调用 $http.get() 一次，如果同一页面中指令的控制器更新数据，第一个控制器没有办法更新其数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:54:31.463

您只需将该 $get 调用包装在一个函数中并再次调用它。

我们可能需要了解更多您的工作内容……但请考虑一下：

```
function ParentCtrl($scope, $http) {
   $scope.foo = [];

   $scope.loadFoo = function () {
       $http.get('/foo/data')
            .success(function(data) {
               $scope.foo = data;
            });
   };

   $scope.loadFoo();
}

function ChildCtrl($scope) {
   $scope.loadFoo(); //still here from Parent scope.
} 
```

但是同样，您*确实*没有提供足够的信息来回答您的问题，因为由于您使用的是指令，因此如果您隔离了范围，则必须将引用传递给您的 loadFoo() 方法：

```
app.directive('testDir', function (){
   return {
     restrict: 'E',
     scope: {
       'loadFoo': '&'
     },
     link: function(scope) {
       scope.loadFoo();
     }
   }
}); 
```

用作：

```
<test-dir load-foo="loadFoo()"></test-dir> 
```

# jquery - 当用户点击外部时隐藏 jQuery UI 菜单

> ID：15121098
> 
> 赞同：1
> 
> 时间：2013-02-27T19:53:00.460
> 
> 标签：jquery, user-interface, hide, contextmenu

我将 jQuery UI 菜单用作上下文菜单，因此当用户单击表格中的单元格时，它会显示相关选项。问题是，它并不是真的被设计成这样使用的，所以当用户在菜单外点击时它不会隐藏。

我尝试使用模糊方法：

```
$("#menu").menu({
    blur: function( event, ui ) {
        $("#menu").css('top', '-1000px');
        $("#menu").css('left', '-1000px');
    }
}); 
```

但由于某种原因，即使您滚动到菜单中的某个选项，菜单也会隐藏。

有一个简单的解决方案吗？

**编辑：** 要拉出我使用的菜单：

```
$("table.adminScheduleViewer tr td:nth-child(4), table.adminScheduleViewer tr td:nth-child(5), table.adminScheduleViewer tr td:nth-child(6), table.adminScheduleViewer tr td:nth-child(7), table.adminScheduleViewer tr td:nth-child(8), table.adminScheduleViewer tr td:nth-child(9), table.adminScheduleViewer tr td:nth-child(10)").click(function(event){
    $("#menu").css('top', event.pageY);
    $("#menu").css('left', event.pageX);
}); 
```

如果我尝试使用 $('body').click() 来隐藏它，那似乎总是首先被调用。你能改变 jQuery 处理点击的顺序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:23:23.817

怎么样：

```
 $('body').not($('#menu').find('*'))
             .bind('click',function(){
                $("#menu").css('top', '-1000px');
                $("#menu").css('left', '-1000px');
             }); 
```

让我们处理身体上的点击，如果点击不在菜单上的任何地方，请隐藏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T20:41:05.073

```
 $('body:not(#menu)').click(function(){
     $("#menu").css({ 'top' : '-1000px', 'left' : '-1000px' });
 }); 
```

我觉得这种方式更性感一点

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-10T18:28:19.623

当用户在菜单外单击时，我使用它来隐藏我的 jquery-ui 菜单。

```
$('body:not(#menu)')
.off('click')
.on( 'click', function() {
    $('body:not(#menu)')
    .off('click');
    $('#menu')
    .hide();
}); 
```

类似于上面的答案，但隐藏菜单元素而不是将它们移出视口。在调用一次以保留其他单击功能后，还会禁用单击句柄。

# sql - 多个左连接从每个返回单行，没有完成

> ID：15121101
> 
> 赞同：1
> 
> 时间：2013-02-27T19:53:01.320
> 
> 标签：sql, postgresql

这是建立另一个问题，

[左连接，只有右数的最后一行](https://stackoverflow.com/questions/2281551/tsql-left-join-and-only-last-row-from-right)

我尝试使用相同的策略组成第二个连接。我在我的 dev macbook pro 上运行 postgres 9.1.4。在此处查看此简化示例：

```
SELECT * FROM (
    SELECT 
      post.*,
      comment.*,
      edit.*,
      ROW_NUMBER() OVER (PARTITION BY post.id ORDER BY edit.date_applied DESC) AS rna,
      ROW_NUMBER() OVER (PARTITION BY post.id ORDER BY comment.date_posted DESC) AS rnb
    FROM 
      post
    LEFT JOIN edit
      ON     post.id = edit.post_id
    LEFT JOIN comment
      ON     post.id = comment.post_id
    ORDER BY
      post.id DESC
) AS q
WHERE rna = 1 AND rnb = 1; 
```

所以我想要做的是提取所有帖子，包括最新的编辑和最新的评论。在我的数据库中，大约有 6000 个帖子，每个帖子大约 100 条评论，每个帖子可能有 10 个编辑。

现在，如果我使用其中一个联接而不是两者都运行查询，则查询运行得非常快（不到一分钟，没有我想要的那么快）。但是，如果我按照上面介绍的方式运行查询，postgres 会浏览我 SSD 上剩余的 14 GB，并在大约 5 分钟后放弃。

谁能解释为什么会发生这种情况？我希望这是我对 PARTITION BY 子句缺乏了解。从 SELECT 子句中删除连接的表并在子查询和外部查询中添加 LIMIT 没有任何改变。

谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:59:29.780

问题可能是您在一个帖子 ID 中获得了笛卡尔积。例如，如果您有 100 条编辑和 100 条评论，那么由于加入，您最终将有 10,000 行。

解决方案是执行`row_number()`in 子查询：

```
SELECT post.*, comment.*, edit.*
FROM 
  post
LEFT JOIN (select e.*,
                  ROW_NUMBER() OVER (PARTITION BY post_id ORDER BY e.date_applied DESC) AS rna
           from edit e
           ) edit
  ON     post.id = edit.post_id and rna = 1
LEFT JOIN (select c.*,
                  ROW_NUMBER() OVER (PARTITION BY post_id ORDER BY c.date_posted DESC) AS rnb
           from comment c
          ) comment
  ON     post.id = comment.post_id and rnb = 1
ORDER BY
  post.id DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T21:00:32.983

另一种查询方式 Gordon Linoff 写道：

```
SELECT post.*, comment.*, edit.*
FROM 
  post
LEFT JOIN (SELECT DISTINCT ON (e.post_id) e.*                  
           FROM edit e
           ORDER BY e.post_id DESC, e.date_applied DESC
           ) edit
  ON     post.id = edit.post_id
LEFT JOIN (SELECT DISTINCT ON (c.post_id) c.*
           FROM comment c
           ORDER BY c.post_id DESC, c.date_posted DESC
          ) comment
  ON     post.id = comment.post_id
ORDER BY
  post.id DESC 
```

它可能（或可能不会）更快地处理您的数据。你必须测试它。

# ruby - 将整数数组映射到嵌套数组访问

> ID：15121102
> 
> 赞同：2
> 
> 时间：2013-02-27T19:53:07.783
> 
> 标签：ruby

有没有办法使用本身存储在数组中的索引来动态访问嵌套数组？

主数组/矩阵嵌套可以是可变的，例如 2、4、100。

例子：

```
my_array = [
  [[1,  2], [3,   4]],
  [[5,  6], [7,   8]],
  [[9, 10], [11, 12]]
]

my_array.access_using_array([0, 1, 1])
  => 4 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T19:59:06.027

```
[0, 1, 1].inject(my_array, :fetch)
# => 4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-06T03:22:42.237

Ruby 2.3.0 引入了一种在两者上[调用的新方法`dig`](http://ruby-doc.org/core/Hash.html#method-i-dig)`Hash`，`Array`从而解决了这个问题。

`nil`如果在任何级别的嵌套中缺少元素，它就会返回。

```
my_array.dig(0,1,1) 
```

# asp.net - 这种情况下的控制是什么？

> ID：15121112
> 
> 赞同：0
> 
> 时间：2013-02-27T19:53:34.997
> 
> 标签：asp.net

我有一个包含 2 个下拉菜单、2 个文本框和一个按钮的页面。用户将从下拉列表中选择项目，然后在文本框中键入数据。完成后，他们将单击一个按钮以从这些控件中获取信息并填充“订单容器”。他们将能够输入多个“订单”。

*   Gridview 控件会成为这个“订单容器”的路径吗？
*   Gridview 控件允许我插入多条记录吗？
*   Gridview 控件是否允许删除记录？

感谢您的帮助！麦克风

更新：这是我更新gridview的方式：

```
Protected Sub imgAddOrderItemClick(ByVal sender As Object, ByVal e As System.Web.UI.ImageClickEventArgs) Handles imgAddOrderItem.Click
    Dim qty As String 'Integer
    Dim type As String
    Dim product As String
    Dim price As Integer
    Dim count As Integer

    count = GridView1.Rows.Count
    type = ddlProductTypes.SelectedItem.ToString
    product = ddlProductFamilies.SelectedItem.ToString
    price = 11
    qty = TextBox10.Text

    ' Populate the datatable with your data (put this in appropriate loop)        
    dr = dt.NewRow        
    dr("Type") = type
    dr("Product") = product
    dr("Qty") = qty
    dr("Price") = price

    ' Add the row
    dt.Rows.Add(dr)

    dt.AcceptChanges()

    GridView1.DataSource = dt 'GetData()
    GridView1.DataBind()

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T20:39:03.077

GridView 很好！

你的 dt 来自哪里？

我认为问题在于，当您回发时，您的 dt 会被初始化，因此它是空的。这就是为什么您每次只能获得一个（新）记录。有两种排序方式，

(1)。您必须在会话中保留 dt（或数据源），并且您的代码很好。

(2)。如果 dt 不在会话中，则需要先循环遍历 gridview 行和列以填充已添加的数据（如果有），然后添加新订单并最终将其绑定到 gridview。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T20:40:27.013

Gridview 可以正常工作。您最有可能看到您的行被覆盖，因为您`dt`的代码中的数据表 ( ) 在每次请求时都会被重新实例化。您需要做的是将该表保存在内存中（例如，将其放在 Session 中），从那里抓取它，添加新行并重新绑定 GridView。像这样的东西：

```
Protected Sub imgAddOrderItemClick(ByVal sender As Object, ByVal e As System.Web.UI.ImageClickEventArgs) Handles imgAddOrderItem.Click
dt = Session("Data")

  If dt is Nothing Then
    ' Create your DT columns here
      Session.Add("Data",dt)
  End If

  'Add rows here and rebind
  dr = dt.NewRow        
  dr("Type") = type
  dr("Product") = product
  dr("Qty") = qty
  dr("Price") = price

  ' Add the row
  dt.Rows.Add(dr)

  dt.AcceptChanges()

  GridView1.DataSource = dt 'GetData()
  GridView1.DataBind()
End Sub 
```

# haskell - 在 Haskell 中使用 vigenere 密码对文本进行编码时遇到问题

> ID：15121113
> 
> 赞同：1
> 
> 时间：2013-02-27T19:53:35.053
> 
> 标签：haskell, encryption, vigenere

我正在从事一个编码项目，我们需要在 Haskell 中编写一个 vigenere cypher。我已经花了几个小时并没有取得什么进展，但我被困在一个特定的部分。到目前为止，这是我的代码：

```
--Program: VigCipher.hs
--Author: Mouse

import Data.Char
import Text.Printf

--Changes letters to their numerical value
let2int   :: Char -> Int
let2int c = ord c - ord 'a'

--Changes numerical values to letters
int2let   :: Int -> Char
int2let n = chr (ord 'a' + n)

--Shift letter by n mod 26 places
shift :: Int -> Char -> Char
shift n c | isLower c = int2let ((let2int c + n) `mod` 26)
      | otherwise = c

--Encoding function
encode         :: String -> String -> [Char]
encode key msg = [shift (26 - let2int (key !! a) | a <- as) (msg !! a) | x <- zip (cycle key)msg] 
```

我的问题出在 Encoding 函数中：我希望该函数在键和应该编码的消息的每个索引处检查和更改字符。我的印象是我所拥有的应该可以工作，但是当我运行它时，由于 | 在：（键！！a）| 一个 <- 作为）。我不知道如何解决这个问题，更不用说如何让程序像我想要的那样检查/更改每个索引处的字母了。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:01:00.027

语法是

```
[element | bindings, guards] 
```

你的语法错误是

*   有两个`|`迹象
*   第一个`|`发生在元素部分完成之前（计算括号）

所以试试

```
encode key msg = [shift (26 - let2int (key !! a)) (msg !! a)
                 | a <- as, x <- zip (cycle key) msg] 
```

您的下一个错误是因为您没有`as`在任何地方定义。（而且您似乎没有使用`x`.）

* * *

**编辑：**在评论中，您说您已将代码更改为

```
encode key msg = [shift (26 - let2int (x)) (msg) | x <- zipWith (fst() key msg)] 
```

你说你很困惑，你收到一条错误消息，表明你没有给出`zipWith`它需要的三个参数。

你给出了`zipWith`一个论点，它是`(fst() key msg)`。

我设想您将代码更改为类似于

```
encode key msg = zipWith f (cycle key) msg
  where f keyElem msgElem = shift (26 - let2int keyElem) msgElem 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T22:20:55.837

[启用并行列表](http://www.haskell.org/ghc/docs/latest/html/users_guide/syntax-extns.html#parallel-list-comprehensions)推导（通过粘贴`{-# LANGUAGE ParallelListComp #-}`在文件顶部，或通过输入`:set -XParallelListComp`GHCi），您可以编写：

```
encode key msg = [shift (26 - let2int k) m | k <- cycle key | m <- msg] 
```

这将被脱糖

```
encode key msg = [shift (26 - let2int k) m | (k,m) <- zip (cycle key) msg] 
```

这与

```
encode key msg = zipWith (\k m -> shift (26 - let2int k) m) (cycle key) msg 
```

即dave4420的解决方案。他的解决方案更加惯用，并且不依赖于 GHC 扩展 - 所以一定要使用那个！只是想我会展示一种很好且紧凑的编写方式。

# maps - 将相机转到特定的纬度/经度（Google Earth API）

> ID：15121115
> 
> 赞同：2
> 
> 时间：2013-02-27T19:53:45.193
> 
> 标签：maps, google-earth, google-earth-plugin, cartography

这具体是一个 Google Earth API 问题，但任何可以适应它的通用地理解决方案也可以。

我正在使用 Google Earth API 在地球上的某处动态放置地标。像所有地标一样，它具有固定的纬度和经度。在这种情况下，高度基本上始终为0。放置地标后，用户可能会在其他地方飞行相机，并且可能看不到地标。

我想做的是有一个按钮，它可以让你在*不改变相机位置的情况下*自动看向原始地标的方向。

在 Google Earth API 中，用户的视口由 Camera 对象表示，该对象具有纬度和经度以及*航向*（从左到右轴）和*倾斜*（上下轴）。

所以问题可以简化为：如果你在地球上有一个固定点 (lat1, lng1, alt1)，你如何计算在 (lat1, lng2, alt2) 处的相机的航向和倾斜，使其面向那个位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T22:12:06.190

查看此链接上的“轴承”部分[http://www.movable-type.co.uk/scripts/latlong.html](http://www.movable-type.co.uk/scripts/latlong.html)

这是他建议用于计算方位（或航向）的javascript。

```
var y = Math.sin(lng1-lng2) * Math.cos(lat2);
var x = Math.cos(lat1)*Math.sin(lat2) - Math.sin(lat1)*Math.cos(lat2)*Math.cos(lng1-lng2);
var brng = Math.atan2(y, x).toDeg(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T01:34:33.880

这是将任意高度的当前相机转向任意高度的另一个纬度/经度点的完整的最终实现。它不是非常漂亮（获得 lats 和 lngs 两次，因为一次我使用的是弧度，另一次我没有）但它可以工作，并导致 Google 地球相机面对您希望它面对的任何东西：

```
//calculate heading/bearing
var lat1 = parseFloat(camera.getLatitude())* Math.PI / 180;
var lng1 = parseFloat(camera.getLongitude())* Math.PI / 180;
var lat2 = parseFloat(target_lat)* Math.PI / 180;
var lng2 = parseFloat(target_lng)* Math.PI / 180;

var dLon = lng2-lng1;
var y = Math.sin(dLon) * Math.cos(lat2);
var x = Math.cos(lat1)*Math.sin(lat2) - Math.sin(lat1)*Math.cos(lat2)*Math.cos(dLon);
var brng = Math.atan2(y, x).toDeg();

//calculate tilt
lat1 = parseFloat(camera.getLatitude());
lng1 = parseFloat(camera.getLongitude());
lat2 = parseFloat(target_lat);
lng2 = parseFloat(target_lng);
var camera_alt = camera.getAltitude();
var target_alt = your_target_altitude; //meters!

//this uses the distVincenty function and geo.js library here: http://www.movable-type.co.uk/scripts/latlong.html
var distance = parseFloat(distVincenty(Geo.parseDMS(lat1),Geo.parseDMS(lng1),Geo.parseDMS(lat2),Geo.parseDMS(lng2)));
var height_diff = (camera_alt-target_alt);

if(height_diff<0) { //target is above camera, invert equation
    height_diff = (target_alt-camera_alt);
    var tilt = Math.atan(height_diff/distance).toDeg()+90; //the +90 is because of the way Google Earth calculates tilt in such circumstances
} else {
    var tilt = Math.atan(distance/height_diff).toDeg();
}

camera.setTilt(tilt);
camera.setHeading(brng); 
```

# android - Android登录认证失败

> ID：15121116
> 
> 赞同：0
> 
> 时间：2013-02-27T19:53:47.500
> 
> 标签：android

我正在创建一个带有注册和警报登录模块的应用程序。那工作正常。在大约 10 或 15 个用户注册后，我尝试登录时收到一条消息，例如用户身份验证失败，并且在 eclipse 中收到一些错误日志。此外，在“test.db”的同一文件夹中创建了一个新文件“test.db-journal”，但我只创建了 test.db 文件。

我正在使用以下代码创建表：

```
 MySQL = "create table users(id INTEGER primary key autoincrement, users TEXT not null);";
  myDb.execSQL(MySQL); 
```

我不知道为什么会这样。请您告诉我原因或解决方案。提前致谢..：）

# javascript - 更改类名不会更改 CSS

> ID：15121127
> 
> 赞同：0
> 
> 时间：2013-02-27T19:54:32.343
> 
> 标签：javascript, css, transitions

我有一个简单的乒乓球游戏[http://shodor.org/~amalani/Pong%203.1/](http://shodor.org/~amalani/Pong%203.1/)，当您按 P 或单击设置按钮时，我试图通过更改类名使设置 div 淡入。类名更改，但 CSS 没有更新。代码是

```
<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">
<link href='main.css' type='text/css' rel='stylesheet'>
<meta name="viewport" content="width=device-width"/>
<script src='game.js' type='text/javascript'></script>
<title>Pong Game</title>
</head>
<body onMouseMove='mouse()' onTouchStart='mouse()' onLoad='ball()' onkeydown="move(event); this.select()" >
<div id='wrap' onKeyDown='move();'>
    <canvas id='level' width=600px height = 25px ></canvas><br>
    <div id='canvasWrap'>
        <div id='options'>
            <a href='#' class='links'><span id='pause' class='options'      onClick='pause()'>Settings</span></a>
            <span id='restart' class='options'>&nbsp&nbsp&nbsp&nbsp&nbspRestart</span>
            <br><br><div id='settings' class='visible'>
                <span><b>Controls:</b></span><br>
                <span>adsfasdfasdfasdf</span>
            </div>
        </div><br>
        <canvas id='canvas' width=600px height=400px >If you can see this, please enable Javascript or switch to a newer browser</canvas>
    </div>
    <span id='score'></span>
    <button type='button' onClick='show()'>Show change</button><br>
    <span id='myspan'></span>
    <script type='text/javascript' src='global.js'></script>

</div>
<script>

</script>
 </body>
 </html> 
```

相关的javascript是

```
var settings = document.getElementById('settings');

function pause() {
    //Toggle pause
    if (time && !lost) {
        time = false;
        settings.className = 'seen';
    } else if (!lost) {
        time = true;
        document.getElementById('settings').style.display = 'none';
    }
    ball();
} 
```

CSS是

```
@CHARSET"UTF-8";
canvas {
    border:1px solid black;
    position:relative;
    top:0px;
}
#wrap {
    width:100%;
    height:100%;
}
body {
    width:100%;
    height:100%;
}
#canvaswrap {
    width:600px;
    height:600px;
    margin:10px;
    padding:10px;
}
#options {
    background-color:black;
    color:lightgrey;
    position:relative;
    width:600px;
    top:20px;
    text-align:center;
    z-index:1;
}
.options:hover {
    color:white;
}
#settings {
    display:none;
    position:absolute;
    width:599px;
    height:400px;
    background-color:lightgrey;
    color:white;
    opacity:0;
}
#settings>a:link {
    color:white;
    text-decoration:none;
}
.links {
    color:lightgrey;
    text-decoration:none;
}
.seen {
    display:block;
    opacity: 1;
    color:pink;
    -webkit-transition: opacity 1s;
    -moz-transition: opacity 1s;
    -o-transition: opacity 1s;
    -ms-transition: opacity 1s;
    transition: opacity 1s;
} 
```

本质上，类肯定会发生变化，但 CSS 不会。如果您认为这是原因，我可以发布我的 Javascript 的其余部分

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:05:10.783

特异性太高，`#settings`试试：

```
#settings.seen {
    display:block;
    opacity: 1;
    color:pink;
    -webkit-transition: opacity 1s;
    -moz-transition: opacity 1s;
    -o-transition: opacity 1s;
    -ms-transition: opacity 1s;
    transition: opacity 1s;
} 
```

# jquery - Bootstrap 流体布局和全高 div

> ID：15121130
> 
> 赞同：0
> 
> 时间：2013-02-27T19:54:42.460
> 
> 标签：jquery, css, twitter-bootstrap, fluid-layout

我目前正在使用 Twitter 的 Bootstrap 并试图得到一些具体的东西，但无法让它工作......

我想要一个带有导航栏、侧边栏、内容和页脚的流畅布局。我也想在内容中有一个全高的 div。

HTML

```
<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container-fluid">
            <a class="brand" href="#">Navbar</a>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="span3">
            <div class="well sidebar-nav">
                <ul class="nav nav-list">
                    <li class="nav-header">Sidebar</li>
                </ul>
            </div><!--/.well -->
        </div><!--/span-->

        <div class="span9">
            <div class="hero-unit">
                <h1>Hero Unit</h1>
            </div>

            <div class="row-fluid">
                <div class="span12">
                    <div id="fullHeight" style="background-color: red">
                        <p>Full height here</p>
                    </div>
                </div><!--/span-->
            </div><!--/row-->
        </div><!--/span-->
    </div><!--/row-->

    <hr>

    <footer>
        <p>&copy; Company 2013</p>
    </footer>

</div><!--/.fluid-container--> 
```

CSS

```
body {
        padding-top: 60px;
        padding-bottom: 40px;
    }
    .sidebar-nav {
        padding: 9px 0;
    }

    @media (max-width: 980px) {
        /* Enable use of floated navbar text */
        .navbar-text.pull-right {
            float: none;
            padding-left: 5px;
            padding-right: 5px;
        }
    } 
```

这是 jsfiddle 向您展示我拥有/想要的东西：http: [//jsfiddle.net/2nuvP/](http://jsfiddle.net/2nuvP/)

有人可以帮我完成这项工作吗？

提示：我不确定这是否仅适用于 CSS，我接受 JS/jQuery 解决方案；）此外，如果您的解决方案需要一些 HTML 修改，这没什么大不了的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T06:30:35.287

这是主要使用 jQuery 来解决您的问题的方法。

[http://jsfiddle.net/uyEuN/4/](http://jsfiddle.net/uyEuN/4/)

**JavaScript**

```
function resolveFullHeight() {
    $("#fullHeight").css("height", "auto");

    var h_window = $(window).height(),
        h_document = $(document).height(),
        fullHeight_top = $("#fullHeight").position().top,
        est_footerHeight = 112;

    var h_fullHeight = (-1 * (est_footerHeight + (fullHeight_top - h_document)));

    $("#fullHeight").height(h_fullHeight);
}

resolveFullHeight();

$(window).resize(function () {
    resolveFullHeight();
}); 
```

除了在导航栏下方添加这个 div 之外，我大部分时间都没有处理**HTML 。**

```
<div class="spacer-fluid-60"></div> 
```

**CSS**包含设置 div 高度的新规则，`.spacer-fluid-60`我还删除了元素的`padding-top`规则。`body`调查 jsfiddle 以获取完整的详细信息。

在 HTML 中，我添加了许多重复的填充段落，并将其中的大部分注释掉了。根据需要取消注释它们，以处理`#fullHeight`元素中内容高度的变化，看看它是否仍然按照您的预期行事。到目前为止，我所做的最小测试表明这将起作用。

注意：添加一些[限制](http://remysharp.com/2010/07/21/throttling-function-calls/)以减少滚动时调用函数的次数。

# sql - 如何为 SQL Server 过程调用另一个表中作为 PK 值的 FK 值

> ID：15121132
> 
> 赞同：1
> 
> 时间：2013-02-27T19:54:44.670
> 
> 标签：sql, sql-server, stored-procedures

我有 2 个程序：`usp_inserterpartner`和`usp_insertlocation`.

`usp_insertpartner``TradingPartnerPK`每次调用时插入一行调用。

`usp_insertlocation`插入一行`LocationPK`作为 PK 和`TradingPartnerFK`作为 FK。

`usp_insertlocation @TradingPartnerFK = the TradingPartnerPK`在这种情况下我该如何执行？

我当前的代码如下：

```
 CREATE PROCEDURE usp_insertLocation

    @LocationPK int,
    @TradingPartnerFK int,
    @Account varchar (255),
    @Region varchar (255)

    AS
    BEGIN
    SELECT @TradingPartnerFK = Trading_Partner.
    INSERT INTO Location (LocationPK,TradingPartnerFK,Account,Region)
    VALUES (@LocationPK,@TradingPartnerFK,@Account,@Region)

    END

exec usp_insertLocation 1, @TradingPartnerFK = ??????????, 'Nike', 'Americas' 
```

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:01:50.573

`SCOPE_IDENTITY()`将返回为当前范围内的最后一条语句创建的最新标识。

更多信息在这里：http: [//msdn.microsoft.com/fr-fr/library/ms190315 (v=sql.100).aspx](http://msdn.microsoft.com/fr-fr/library/ms190315(v=sql.100).aspx)

* * *

您将能够使用它的方式实际上取决于您如何进行插入。

**如果您在第一个 StoredProcedure 中并`SCOPE_IDENTITY()`按照我之前所说的那样使用：**

由于您不能在`exec`命令中使用函数，因此您必须执行以下操作：

```
declare @fkid int 
set @fkid = SCOPE_IDENTITY()
exec usp_insertLocation 1, @TradingPartnerFK = @fkid, 'Nike', 'Americas' 
```

**如果从外部进程调用第二个程序，例如：**

```
exec usp_insertpartner [...]
exec usp_insertlocation [...] 
```

您将不得不使用`@@identity`，因为您超出了初始范围。

所以你的电话看起来像这样：

```
exec usp_insertLocation 1, @TradingPartnerFK = @@identity, 'Nike', 'Americas' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:44:50.657

使用`scope_identity()`with`identity columns`作为主键示例：

[SQL小提琴](http://sqlfiddle.com/#!3/ce6a4/3)

**MS SQL Server 2008 架构设置**：

```
create table TradingPartner (
  PartnerPK int not null identity(1,1) primary key,
  SomePartnerData varchar(100)

  )

create table Location(
  LocationPK int not null identity(1,1) primary key,
  TradingPartnerFK int not null,
  SomeLocationData varchar(100),
  foreign key (TradingPartnerFK) references TradingPartner (PartnerPK)
  )

go

create procedure usp_insert_partner
  @SomePartnerData varchar(100)
as
begin
  declare @PartnerPK int
  insert TradingPartner (SomePartnerData) values (@SomePartnerData)
  set @PartnerPK = scope_identity()
  return @PartnerPK
end

go

create procedure usp_insert_location
  @TradingPartnerPK int,
  @SomeLocationData varchar(100)
as
begin
  declare @LocationPK int
  insert Location (TradingPartnerFK, SomeLocationData) 
    values (@TradingPartnerPK, @SomeLocationData)
  set @LocationPK = scope_identity()
  return @LocationPK
end 
```

**查询 1**：

```
declare @PartnerPK int

exec @PartnerPK = usp_insert_partner 'Some Partner 1'

exec usp_insert_location @PartnerPK, 'Some Location 1'

exec @PartnerPK = usp_insert_partner 'Some Partner 2'

exec usp_insert_location @PartnerPK, 'Some Location 2'

select *
from Location l
  join TradingPartner p on l.TradingPartnerFK = p.PartnerPK 
```

**[结果](http://sqlfiddle.com/#!3/ce6a4/3/0)**：

```
| LOCATIONPK | TRADINGPARTNERFK | SOMELOCATIONDATA | PARTNERPK | SOMEPARTNERDATA |
----------------------------------------------------------------------------------
|          5 |                4 |  Some Location 1 |         4 |  Some Partner 1 |
|          6 |                5 |  Some Location 2 |         5 |  Some Partner 2 | 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:46:10.747

如果您在单独的 SP 中执行此操作，您的 usp_inserterpartner 应在执行插入语句或使用输出参数保存此值后返回 Scope_Identity() 值（合作伙伴的 PK）。

然后，当您执行位置 sp 时，PK 值可用作 usp_inserterpartner 的返回值或它的输出参数之一。

# java - 包 Javax.portlet 不存在

> ID：15121133
> 
> 赞同：1
> 
> 时间：2013-02-27T19:54:45.577
> 
> 标签：java, grails, groovy, liferay, portlet

=（使用 CentOS 发行版）=

我正在尝试使用 Grails 开发一个 portlet（使用 liferay-exploded、portlet 和 portlets-liferay 插件）。

我正在关注[http://grails.org/plugin/portlets](http://grails.org/plugin/portlets)上的教程，但是当我去生成 portlet 视图时，会显示以下错误：

```
[localhost test]$ grails generate-portlet-views com.test.first
| Compiling 129 source files.
| Error Compilation error: startup failed:
Compile error during compilation with javac.
/home/portaldev1/.grails/2.2.0/projects/test/plugins/portlets-0.9.2/src/java/org/codehaus/grails/portlets/GrailsDispatcherPortlet.java:5: package javax.portlet does not exist
import javax.portlet.*;
^
/home/portaldev1/.grails/2.2.0/projects/test/plugins/portlets-0.9.2/src/java/org/codehaus/grails/portlets/GrailsDispatcherPortlet.java:10: cannot access javax.portlet.GenericPortlet
class file for javax.portlet.GenericPortlet not found

(These problems continue 68 more times)

Note: Some input files use or override a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
Note: Some input files use unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
70 errors

1 error
[localhost test]$ 
```

我提到了 google/stack overflow/groovy forums/liferay forums，我找到的唯一答案是将 portlet-api-2.0.jar 添加到 CLASSPATH 环境变量中。

我已经尝试将此行添加到我的 .bash_profile 中：“CLASSPATH=/home/portletjar/”并且这些错误仍然存​​在。

我没有使用 eclipse 或任何其他 ide。

请帮我解决这个问题！我还尝试通过手动定义 .jar 所在的类路径（使用 javac -cp）来编译使用 javax.portlet 的 java 代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:24:27.177

将portlet-api-2.0 jar 添加到/lib 目录似乎已经解决了这个问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T12:54:02.553

您是如何准确安装插件的？使用 grails install-plugin xxx 吗？

检查是否在插件会话中的 conf/BuildConfig.groovy 中声明了依赖项。它应该是一些类似的行：

*   编译“：portlets-liferay：0.4”

希望它可以帮助干杯

# ios - 如何仅从 plist 文件中加载选定的数据

> ID：15121137
> 
> 赞同：0
> 
> 时间：2013-02-27T19:55:00.573
> 
> 标签：ios, objective-c, plist

我有一个以 Root 为数组的 plist，然后这个数组中的每个项目都是一个带有对象的字典：名称（字符串）和姓氏（字符串）。我想显示我文件中的所有名称。目前我正在使用这段代码：

```
 NSArray *myData = [[NSArray alloc] initWithContentsOfFile:mypath];
   NSMutableArray *names = [[NSMutableArray alloc] init];
   for (int i=0; i < myData.count; i++) {
       [names addObject:[[myData objectAtIndex:i] objectForKey:@"name"]];
   } 
```

有什么方法可以将键 @"name" 的值直接从 plist 文件加载到 NSMutableArray *names？如果我只需要 @"name" 值，我只是不想将 plist 文件的全部内容加载到内存中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T21:10:57.193

不。加载一个 plist 是一个全有或全无的事情。除非您的 plist*很大*，否则我不会担心。如果是这样，那么您可能需要考虑将其拆分为多个文件，而不是编写自己的 plist 反序列化器（因为我向您保证 CoreFoundation 的 plist 解析器会比您的更快）。

# windows-phone-7 - 如何在 WP8 中获取 LongListSelector 的 VerticalOffset

> ID：15121139
> 
> 赞同：6
> 
> 时间：2013-02-27T19:55:07.880
> 
> 标签：windows-phone-7, windows-phone-8, longlistselector

在 WP7 中，LongListSelector 有一个底层 ScrollViewer，我可以从中恢复列表的垂直偏移量。但是在 Windows Phone 8 中，没有底层的 ScrollViewer 也没有任何类似的类可以为我提供该 VerticalOffset 属性。

我一直在寻找，没有找到任何东西。我可以用一个给出列表中第一个可见元素的函数来解决，但我也没有找到任何东西。ItemRealized 事件对此没有用，因为它没有给出显示在视口顶部的确切项目。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-28T08:40:53.900

这将为您提供 LLS 中的第一个可见项目。

```
private Dictionary<object, ContentPresenter> items;

private object GetFirstVisibleItem(LongListSelector lls)
{
    var offset = FindViewport(lls).Viewport.Top;
    return items.Where(x => Canvas.GetTop(x.Value) + x.Value.ActualHeight > offset)
        .OrderBy(x => Canvas.GetTop(x.Value)).First().Key;
}

private void LLS_ItemRealized(object sender, ItemRealizationEventArgs e)
{
    if (e.ItemKind == LongListSelectorItemKind.Item)
    {
        object o = e.Container.DataContext;
        items[o] = e.Container;
    }
}

private void LLS_ItemUnrealized(object sender, ItemRealizationEventArgs e)
{
    if (e.ItemKind == LongListSelectorItemKind.Item)
    {
        object o = e.Container.DataContext;
        items.Remove(o);
    }
}

private static ViewportControl FindViewport(DependencyObject parent)
{
    var childCount = VisualTreeHelper.GetChildrenCount(parent);
    for (var i = 0; i < childCount; i++)
    {
        var elt = VisualTreeHelper.GetChild(parent, i);
        if (elt is ViewportControl) return (ViewportControl)elt;
        var result = FindViewport(elt);
        if (result != null) return result;
    }
    return null;
} 
```

# php - 还有哪些其他基于网络的技术可以执行程序？

> ID：15121140
> 
> 赞同：0
> 
> 时间：2013-02-27T19:55:07.527
> 
> 标签：php, javascript, html, web-applications, asp-classic

例如，在 php 中`shell_exec()`，您可以使用它在本地服务器上运行程序。但是还有哪些其他基于网络的技术可以做到这一点以及如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:00:06.737

ASP：

```
set wshell = CreateObject("WScript.Shell") 
wshell.run "c:\file.bat" 
set wshell = nothing 
```

Python：

```
from subprocess import call
call(["ls", "-l"]) 
```

珀尔：

```
system("command arg1 arg2 arg3"); 
```

红宝石：

```
system("ls") 
```

JSP/Servlet：

```
ProcessBuilder pb = 
   new ProcessBuilder("/bin/sh", "-c", "myfolder/myscript.sh > /myfolder/logs/myscript.log");
pb.start(); 
```

PHP：

```
shell_exec ( 'command' ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T19:57:35.890

您可以使用 cron 作业、具有任何受支持语言的 CGI 脚本，当然还有可以配置您的 Web 服务器执行的任何 Web 语言（包括 Python、Ruby、Lisp、Java）。也就是说，直接执行应用程序通常是不可取的。它可能导致高服务器负载和安全漏洞。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:02:36.427

对于 Javascript：

客户端，在 Windows 上可以使用 ActiveX 来完成：[如何在 Javascript 中执行 shell 命令](https://stackoverflow.com/questions/1880198/how-to-execute-shell-command-in-java-script)。但它要求您允许未签名的 ActiveX 控件，这会带来一个重大的安全问题。

还有服务器端 Javascript，称为[node.js](http://nodejs.org/)。关于如何使用它来执行系统命令，请参阅 SO 问题[node.js 同步执行系统命令。](https://stackoverflow.com/questions/4443597/node-js-execute-system-command-synchronously)

# thumbnails - 为什么共享链接包含不在我的 og:image(s) 中的缩略图选项？

> ID：15121142
> 
> 赞同：0
> 
> 时间：2013-02-27T19:55:12.057
> 
> 标签：thumbnails, facebook-opengraph

当您尝试[在 Woot.com 上](http://www.woot.com/offers/cuisinart-14-pc-non-stick-cookware-set-5)[共享](http://www.facebook.com/sharer/sharer.php?u=http://www.woot.com/offers/cuisinart-5-5-qt-cast-iron-casserole-1&src=sp)其中一个页面时，它会为缩略图提供三个选项。第一个是 og:image 指定的，但其他两个似乎是从页面导航区域中包含的缩略图中随机选择的。

[调试器](http://developers.facebook.com/tools/debug/og/object?q=http://www.woot.com/offers/cuisinart-14-pc-non-stick-cookware-set-5)似乎没有帮助，它只显示 og:image 指定的那个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T02:11:19.860

我相信 Facebook 分享脚本总是试图向用户展示可供选择的多个图像。首先它将在标题中查找 og:image 标签，然后转到页面内容并选择符合其共享标准的图像（即图像必须至少为 50 像素 x 50 像素，最大纵横比为 3:1 , 以及 PNG、JPEG 或 GIF 格式）。

因此，如果您想手动选择显示哪三个图像，只需在标题中添加两个额外的 og:image 标签。再次在该页面上运行调试器，这应该会为您提供所需的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T17:56:09.367

检查您网站的来源，您现在似乎有两个 og:image 标签，但您网站上的 facebook 共享器仍然只显示一个缩略图。

```
<meta property="og:image" content="http://d3gqasl9vmjfd8.cloudfront.net/3f0c6be3-29b1-4241-bd13-af61613f6dee.jpg" />
<meta property="og:image" content="http://d3gqasl9vmjfd8.cloudfront.net/4ccb33cb-13b7-457c-a425-2ed7a305a758.jpg" /> 
```

如果您想要绝对控制，并且您似乎可以修改源，那么我建议您只修改您的 facebook 共享者的链接。在页面上，我目前将其视为：

```
http://www.facebook.com/sharer.php?u=http://www.woot.com/offers/cuisinart-14-pc-non-stick-cookware-set-5&src=sp 
```

您可以将所需图像的来源直接添加到共享者 url 中，如下所示：

```
http://www.facebook.com/sharer.php?s=100&p[url]=http://www.woot.com/offers/cuisinart-14-pc-non-stick-cookware-set-5&p[images][0]=http://goo.gl/ehi4d 
```

同样，这为您提供了直接控制，但您必须修改您的小共享小部件代码而不是您的标题代码......祝您好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T12:45:59.680

根据[http://developers.facebook.com/docs/opengraphprotocol/](http://developers.facebook.com/docs/opengraphprotocol/)

> og:image - 应在图中表示您的对象的图像 URL。图像必须至少为 50 像素 x 50 像素，但至少 200 像素 x 200 像素是首选，并且建议使用 1500 像素 x 1500 像素以获得最佳用户体验。图像的最大纵横比为 3:1。我们支持 PNG、JPEG 和 GIF 格式。您可以包含多个 og:image 标签以将多个图像与您的页面相关联。（注意：图像大小不得超过 5MB。）

关于您的问题，这表明您可以将多个图像设置为 Open Graph 图像。如果您只希望将您的特定图像作为选项提供，那么我建议提供三个图像，每个图像都有自己的“og：image”

目前您有：

> 元属性="og:image" 内容="http://d3gqasl9vmjfd8.cloudfront.net/750d2708-65b0-42d6-bf1e-a4e0f8f2b79c.jpg" />

您可以替换为：

> > 元属性="og:image" 内容="http://d3gqasl9vmjfd8.cloudfront.net/750d2708-65b0-42d6-bf1e-a4e0f8f2b79c.jpg.jpg" />
> > 
> > 元属性="og:image" 内容="http://d3gqasl9vmjfd8.cloudfront.net/sameimagenewname.jpg" />
> > 
> > 元属性="og:image" 内容="http://d3gqasl9vmjfd8.cloudfront.net/sameimagenewname2.jpg" />

这将解决使用不受欢迎的图像的问题。

# java - 数据库实现在 JDBC 连接中设置的事务隔离级别的各种方式

> ID：15121144
> 
> 赞同：0
> 
> 时间：2013-02-27T19:55:18.617
> 
> 标签：java, transactions, acid, transaction-isolation

我们可以在 JDBC 连接上设置事务隔离级别，以控制对并发事务之间公共记录的读/写访问的可见性级别。数据库实现这一点的一种方法是在记录/表上放置不同类型的锁。

但是数据库还有其他方式实现这些事务级别吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:11:07.283

我不想太深入研究可以在很多关于数据库管理系统设计的非常好的书籍中阅读的理论内容。

在遵循悲观获取和释放锁的方法的数据库中，所有四个隔离级别都是使用锁来实现的。有许多乐观方法（例如，FOCC - 前向乐观并发控制以及 BOCC - 后向...）可以跟踪 DML 语句已读取或写入的数据以及事务是否即将提交它根据所有其他事务检查这些读取和写入集。如果这些集合不相交，则可以写入和提交事务。如果事务的读集与另一个（已提交）事务的写集冲突，数据库系统必须回滚该事务。这可以在不使用锁的情况下完成。这些乐观的方法已经过充分研究，并且可以在没有很大性能损失的*情况下应用*碰撞或多或少是异常的，而且数量很少。

# ios - 面试 - 将 c++ 库与 iOS 应用程序集成

> ID：15121150
> 
> 赞同：0
> 
> 时间：2013-02-27T19:55:35.853
> 
> 标签：ios, c, xcode, integration

大约一个月前我被问到这个问题。这不完全是我的工作，但我很好奇。他们基本上有一些 C 语言的音乐库，并想让它们可用于 ios 代码。

如果我有一些 .c 或 .cpp 文件。如何在 ios 项目中使用它们。同样，这可能会令人困惑，因为我没有给您任何上下文。但任何有用的链接或帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:58:36.740

只需将它们添加到项目中，您无需做任何特别的事情。XCode（和clang）将从扩展中知道它们是什么语言并适当地编译它们。

您*可能*需要告诉 xcode 链接到`libstdc++`，但就是这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T19:57:46.583

iOS 基于 Objective-C，它是 C 的超集。出于所有意图和目的，在 Objective-C 下编译 C 时，事情应该“正常工作”。您在 C 中学到的所有结构、函数指针以及所有其他内容仍然有效，并且应该在 Objective-C 下编译。

事实上，一些 iOS 框架部分（CF 等）是用 C 编写的。

[Objective C 2.0 是 C 的适当超集吗？](https://stackoverflow.com/questions/2963832/is-objective-c-2-0-a-proper-superset-of-c)

然而，C++ 是另一回事:)

# magento - 通过代码手动将出生日期添加到客户帐户详细信息？

> ID：15121153
> 
> 赞同：2
> 
> 时间：2013-02-27T19:55:48.853
> 
> 标签：magento, magento-1.7

我在查询字符串中有一个生日，例如：

```
?birthdate=1991-01-01 
```

我的代码如下：

```
$customer->setWebsiteId(Mage::app()->getWebsite()->getId());
$customer->loadByEmail($email);
if (!$customer->getId()) {
    $customer->setEmail($email);
    $customer->setFirstname($name);
    $customer->setLastname($lastname);
    $customer->setPassword($password);
    $customer->setGender(
    Mage::getResourceModel('customer/customer')
        ->getAttribute('gender')
        ->getSource()
        ->getOptionId($gender)
    );
} 
```

就像我想要的一样：

```
$customer->setBirthday($date); 
```

任何解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T23:10:22.783

生日字段实际上被称为`dob`。尝试：

```
$customer->setDob('1991-01-01'); 
```

或添加以下日期代码：

```
list($y, $m, $d) = explode('-', $birthday);

$date=date('m/j/Y', strtotime("$y-$m-$d"));

$customer->setDob($date); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-15T16:30:59.480

谢谢马特。我修改了您的解决方案（因为我也遇到了 01-01-1970 日期的问题）。也许有人可以使用它：

```
 // $birthday format m/d/y -> convert to m-d-Y
        $datetime = DateTime::createFromFormat('m/d/y', $birthday);
        $customer->setDob($datetime->format('m-d-Y'));
        $customer->save(); 
```

# asp.net - 如何在数据表的 .select 方法中使用“搜索案例表达式”？(ASP/ADO.net)

> ID：15121154
> 
> 赞同：0
> 
> 时间：2013-02-27T19:55:51.623
> 
> 标签：asp.net, tsql, select, ado.net, case

有人可以告诉我如何在数据表的[select 方法中使用](http://msdn.microsoft.com/en-us/library/det4aw50%28v=vs.100%29.aspx)[**Searched** CASE 表达式](http://msdn.microsoft.com/en-us/library/ms181765%28v=sql.105%29.aspx)吗？我不断收到错误：

> 语法错误：“WHEN”运算符后缺少操作数

这就是我正在尝试的，它不适用于上面的错误。

```
DataRow[] unMappedRows = matches.Select("(CASE WHEN TRUE THEN 1 END) = 1"); 
```

我正在使用 SQL Server 2008 R2 和 .NET Framework 4。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:20:03.773

好吧..您尝试的 Searched CASE 表达式不是过滤器...

[http://msdn.microsoft.com/en-us/library/det4aw50%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/det4aw50%28v=vs.100%29.aspx)

据此，连同您提供的链接，您正在尝试这样的事情（在 t-sql 伪代码中）

```
select *
from  table
where (case when true then 1 end) = 1 
```

这是不允许的。

希望能帮助到你

# asp.net - gridview 在标题中显示数字而不是列 asp.net c#

> ID：15121157
> 
> 赞同：1
> 
> 时间：2013-02-27T19:56:06.040
> 
> 标签：asp.net, gridview

我有以下代码在gridview列中显示为行：

代码背后：

```
protected void Page_Load(object sender, EventArgs e)
{
    gvOrdersProcessed.DataSource = FlipDataTable(BindOrdersProcessed());
    gvOrdersProcessed.DataBind();
}

public DataTable BindOrdersProcessed()
{
    SqlConnection Conn = new SqlConnection(ConfigurationManager.ConnectionStrings["WO_StatusConnectionString"].ToString());
    SqlCommand Cmd = new SqlCommand("sp_B2B_GetOrdersProcessed", Conn);
    Cmd.CommandType = CommandType.StoredProcedure;           

    SqlDataAdapter ada = new SqlDataAdapter(Cmd);
    DataTable dt = new DataTable();
    ada.Fill(dt);
    return dt;
}

public DataTable FlipDataTable(DataTable dt)
{
     DataTable table = new DataTable();

     //Get all the rows and change into columns
     for (int i = 0; i <= dt.Rows.Count; i++)            
         table.Columns.Add(Convert.ToString(i));            

     DataRow dr;

     //get all the columns and make it as rows
     for (int j = 0; j < dt.Columns.Count; j++)
     {
          dr = table.NewRow();
          dr[0] = dt.Columns[j].ToString();
          for (int k = 1; k <= dt.Rows.Count; k++)
              dr[k] = dt.Rows[k - 1][j];
          table.Rows.Add(dr);
     }

     return table;
} 
```

在我的html中：

```
<div id="GridOrdersProcessed">
        <asp:GridView ID="gvOrdersProcessed" runat="server">
        </asp:GridView>
    </div> 
```

现在当运行上面我有数字作为标题：

```
0                    1          2          3          4          5          6 
DateCreate           02/11/2013 02/19/2013 02/21/2013 02/25/2013 02/26/2013 02/27/2013 
OrdersPendingInvoice 0          0          0          0          0          0 
OrdersPendingPickUp  1          1          2          1          7          9 
```

为什么会这样？

另外，如何添加一个新列，其中包含如下总订单：

```
DateCreate           Total 02/11/2013 02/19/2013 02/21/2013 02/25/2013 02/26/2013 02/27/2013 
OrdersPendingInvoice 0     0          0          0          0          0          0 
OrdersPendingPickUp  21    1          1          2          1          7          9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:05:23.337

您将数字作为标题，因为您在此处创建了带有数字名称的 DataColumns：

```
public DataTable FlipDataTable(DataTable dt)
{
    DataTable table = new DataTable();
    //Get all the rows and change into columns
    for (int i = 0; i <= dt.Rows.Count; i++)
        table.Columns.Add(Convert.ToString(i)); 
```

你可能想要这样的东西：

```
for (int i = 0; i < dt.Rows.Count; i++) 
     table.Columns.Add(Convert.ToString(dt.Rows[i][0])); 
```

另请注意，我已更改`<=`为`i <`在循环中。

**编辑**：但我担心该方法没有做它应该做的（颠倒行和列的角色，也称为*枢轴*）。

您可以使用此扩展方法：

```
public static DataTable Pivot(this DataTable tbl)
{
    var tblPivot = new DataTable();
    tblPivot.Columns.Add(tbl.Columns[0].ColumnName);
    for (int i = 1; i < tbl.Rows.Count; i++)
    {
        tblPivot.Columns.Add(Convert.ToString(i));
    }
    for (int col = 0; col < tbl.Columns.Count; col++)
    {
        var r = tblPivot.NewRow();
        r[0] = tbl.Columns[col].ToString();
        for (int j = 1; j < tbl.Rows.Count; j++)
            r[j] = tbl.Rows[j][col];

        tblPivot.Rows.Add(r);
    }
    return tblPivot;
} 
```

**更新**也许这个 linq 查询有助于在透视表之前获取总列：

```
int OrdersPendingInvoiceTotal= tbl.AsEnumerable()
    .Sum(r => r.Field<int>("OrdersPendingInvoice"));
int OrdersPendingPickUpTotal= tbl.AsEnumerable()
    .Sum(r => r.Field<int>("OrdersPendingPickUp")); 
```

# php - 基本 PHP/HTML 第 1 行出现 Unexpected T_STRING 的真正原因是什么

> ID：15121161
> 
> 赞同：0
> 
> 时间：2013-02-27T19:56:23.813
> 
> 标签：php, html, wsod

我觉得在第 1 行用一个关于 WSOD 和一个神秘的 Unexpected T_String 的相同问题来加重你的负担有点欺诈，但我可能无法解决这个问题。我很新……这是我大约 5 年来第一次使用 PHP，那时它真的是我的第一次尝试，很高兴地工作。

我正在创建一个简单的网站，该网站将有一个“联系我们”表单......它会在 HTML div 主文件中询问如下：

```
<div id="wrap">
 <!.. various code that works just fine >
    <div id="main">
    <form action="mail.php" method="POST">
    <p>Name</p> <input type="text" name="name">
    <p>Email Address</p> <input type="text" name="email">
    <p>Message</p> <textarea name="message" rows="6" cols="25"> </textarea>
    <br />
    <input type="submit" value="Send"><input type="reset" value="Clear">   
    </form>

    </div> <!.. end of main>
<!.. some more code that also works fine>
</div> <!..end of wrap> 
```

在我写的名为 main.php 的文件中（嗯，从网站复制）：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
   <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
   <title>Contact Us PHP</title>
</head>
<body>

  <?php
  $name = $_POST['name'];
  $email = $_POST['email'];
  $message = $_POST['message'];
  $formcontent = "From: $name \n Message: $message";
  $recipient = "my.name@mybusiness.co.uk";
  $subject = "Contact Form";
  $mailheader = "From: $email \r\n";
  mail($recipient, $subject, $formcontent, $mailheader) or die("Error!");
  echo "Thank You for your message " . " - " .   
  "<a href='www.mybusinessname.co.uk/index.html'> Return Home </a>";
  ?>
  </body>
  </html> 
```

我已将此加载到我的托管服务器，当我按下提交按钮时，WSOD 出现并显示地址`http://www.mybusinessname.co.uk .... /main.php`

我花了几天时间阅读各种可能的解决方案，这些解决方案很快就让我失去了兴趣，但老实说，我认为我已经做了一些基本的解决方案，并且有一个非常简单的解决方案，比我聪明得多的人将能够很快识别出这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:58:14.103

第 1 行的单引号有什么用？

```
'<div id="wrap"> 
```

你是在呼应整个事情吗？如果是，请不要这样做，而是这样做

```
?>
<!--HTML Goes Here-->
<?php 
```

因为除了第 1 行的引用之外，我在代码中没有看到任何错误`'`。因为您共享了不完整或不相关的代码

通常，当有未转义的引号时会发生此错误

# javascript - 动态页面创建 - 使用 JavaScript 更改元素属性

> ID：15121167
> 
> 赞同：0
> 
> 时间：2013-02-27T19:56:43.563
> 
> 标签：javascript, html, forms, gsp

我是 JavaScript 新手。我有一个 Java 应用程序，它显示一个 jsp，它是一个简单的 Web 表单（实际上是一个 gsp，它基于 Groovy）。gsp 遍历一些Java 对象（形式'questions'）并根据POJO 的类型（例如'textfield' 或'radiogroup' 等）在页面上显示相关的HTML 元素。有一点像：

```
javaObjectsMap.foreach
    if(object.type == 'textfield')
        <input="text" id="object.id">
    if(object.type == 'radiogroup')
        <input="radio" id="object.id">
    ...etc etc. 
```

我遇到的问题是，如果该问题有错误，我想将任何文本框的边框颜色更改为红色。我可以很好地测试错误（使用 Grails`<g:if>`标记），并且可以使用以下内容*手动*更改元素的边框 - 但前提是我对元素的 ID 进行了硬编码：

```
document.getElementById(myElementId).style.borderColor="#FF0000" 
```

有没有办法`myElementId`在运行时找到？我希望这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T18:38:05.107

如果该字段有错误，则向输入字段添加一个类（例如“错误”）并为“错误”类提供 css 样式。

# php - While Loop，只显示 50 条记录或更多？

> ID：15121168
> 
> 赞同：0
> 
> 时间：2013-02-27T19:56:44.370
> 
> 标签：php, loops, while-loop

我在页面上有一个查询，然后它会回显一个 while 循环以显示所有记录。我想将其限制为 25，但也有一个动态的下一个/上一个按钮，这样我就可以跳过记录。我见过类似的东西，但我无法弄清楚或找到我看到的教程。我是 PHP 新手，所以任何帮助都会很棒。

```
<?PHP
$result = mysql_query("SELECT id, firstname, surname FROM members WHERE createdby = '" . $_SESSION['myusername'] ."'");
if (!$result) {
    echo 'Could not run query: ' . mysql_error();
    exit;
}
while($row = mysql_fetch_row($result))
{
$id=$row[0];
echo ("<a href=profile.php?id=$id>".$row[1]." ".$row[2]."</a>");
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:09:35.017

正确的解决方案是限制查询。你可以这样做（注意最后的“LIMIT 50”）：

```
$result = mysql_query("SELECT id, firstname, surname FROM members WHERE createdby = '" . $_SESSION['myusername'] ."' LIMIT 50"); 
```

您还可以通过计数来打破 PHP 中的 while 循环：

```
$count = 0;
while($row = mysql_fetch_row($result)){
  $id=$row[0];
  echo ("<a href=profile.php?id=$id>".$row[1]." ".$row[2]."</a>");
  $count++;
  if ($count >= 50){
    break;
  }
} 
```

同样，正确的解决方案是限制查询。原因是，如果查询匹配数据库中的一百万行，那么 PHP 不会将超过 50 个结果加载到内存中，从而节省资源。

第二种解决方案会将所有结果加载到内存中，然后循环遍历它们时，它将在 50 之后停止循环（但仍然会加载所有匹配的结果，但只会使用 50，之后所有结果都将是再次取消设置）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:02:06.430

您应该通过修改 sql 查询来做到这一点。

```
$offset = (int)$_GET['offset'];
$result = mysql_query("SELECT id, firstname, surname FROM members WHERE createdby = '" . $_SESSION['myusername'] ."' limit $offset, 25"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:12:43.270

我只有丑陋的解决方案......但是：第一个是将结果存储到会话变量（数组形式）中，放置一个条件（如果（！isset（会话））执行查询），将下一个和上一个按钮转换为两个具有当前页面视图值的隐藏输入附近的表单（或者它可以是总的可视化帖子，例如 25 50 75...）。当您单击上一个/下一个按钮时，页面将被重新加载并打印 session[varname][currentindex] 等等...否则您可以执行 jquery Ajax 调用，该调用将返回一个包含所有记录的数组和以这种方式管理它 JavaScript/jquery，您无需刷新页面。
**编辑**
SQL 限制更好，但是您需要一个会话来存储可视化项目的一部分（25 50 75）和两个按钮表单，这样您将检查下一个/上一个，并在会话和设置后添加或减去 25新的 MySQL 限制（从会话到会话+25）

# c# - 使用 .NET 开发工具包提取自特定日期以来在 QuickBooks 中修改的所有客户

> ID：15121174
> 
> 赞同：1
> 
> 时间：2013-02-27T19:56:57.653
> 
> 标签：c#, quickbooks, intuit-partner-platform

IDS 正确地接受 StartCreatedTMS/EndCreatedTMS 的查询以检索仅在 QuickBooks 中修改的对象 - 而不是数据服务。

IPP .NET 开发工具包似乎只公开 CDCAsOf 属性。我是否遗漏了什么和/或有没有办法通过 .NET 开发工具包通过 StartCreatedTMS 查询 QB 桌面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:38:26.010

```
Intuit.Ipp.Data.Qbd.CustomerQuery customerQuery = new Intuit.Ipp.Data.Qbd.CustomerQuery();
customerQuery.ItemsElementName = new ItemsChoiceType4[] { ItemsChoiceType4.StartCreatedTMS, ItemsChoiceType4.EndCreatedTMS };
customerQuery.Items = new object[] { new DateTime(2012, 01, 01), new DateTime(2013, 01, 01) };
List<Intuit.Ipp.Data.Qbd.Customer> customersList = customerQuery.ExecuteQuery<Intuit.Ipp.Data.Qbd.Customer>(context).ToList(); 
```

# photoshop - 在 Photoshop 中将提取的头发另存为 GIF 时出现白色划痕

> ID：15121178
> 
> 赞同：0
> 
> 时间：2013-02-27T19:57:07.533
> 
> 标签：photoshop, extraction

我需要你的帮助来解决一个让我陷入困境的问题。我为姐姐创建了一个网站（我的第一个网站），一切都可以上传了。但我已经被 Photoshop 的问题耽搁了一段时间。我一直在尝试提取几个头发模型，以便将它们放在透明背景上并使用 JavaScript 旋转器将它们显示在她的主页上。

我使用套索工具选择主要部分，然后使用 CS6 中的优化边缘工具提取头发。只要我在 PS 中使用它，一切看起来都很好。在深色或透明背景中，我看不到任何白色划痕的迹象。但是，一旦我将图像保存为具有透明度的 gif 或 PNG，就会出现划痕。

这就是我所说的： ![在此处输入图像描述](../Images/ea4905b15dcc4664644e95c0b34a032c.png)

有人可以在透明背景上为我提取这两张图片，然后告诉我他们做了什么，以便我可以自己完成其余的工作吗？这些是我真正遇到的困难。

这些文件是 Tiff 格式，我可以使用 gif 或 PNG。

[头发模型 2](http://www.2shared.com/photo/qoARehUW/HM2.html)

[头发模型 3](http://www.2shared.com/photo/FdwJagSF/hm3.html)

谁帮助我摆脱困境，谁将得到我最衷心的感谢，以及我能送你的所有善业。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T20:23:03.877

您只是没有在 PS 中正确剪切背景。出现白色“划痕”是因为您没有在 PS 中正确擦除背景。请记住：[GIF 和 PNG-8（无论如何在 PS 中）不支持 alpha 透明度](https://stackoverflow.com/questions/2336522/png-vs-gif-vs-jpeg-when-best-to-use)。

这是您的一个文件，其中一个文件**很快就被**剪掉了，带有 GIF 格式的透明背景：

![在此处输入图像描述](../Images/9ee5a65fc17a4e8a599f566325285ed7.png)

没有“划痕”，明白吗？恐怕你只需要变得更好，在 Photoshop 中将其删除即可。

要么，要么以透明的PNG-24格式保存图像。[然后使用PNGQuant](http://pngquant.org/)将该 PNG-24 文件转换为 PNG-8 。（这可能是最快和最简单的解决方案，现在我想到了。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T17:37:09.830

使用钢笔工具获得最精确的选择。转到 Window --> Paths 以加载路径调色板。单击调色板底部的白色矩形图标以创建新路径。单击工具栏中的钢笔工具。使用钢笔工具在要选择的头发周围放置小点（选择点）。如果您犯了错误，您可以稍后使用直接选择工具（白色箭头）返回并移动每个单独的点。选择所有内容后，单击路径选择工具（工具栏上文本工具下方的黑色箭头），然后单击图像中的路径。现在右键单击图像并从出现的弹出菜单中选择“进行选择”。将羽化设置为 0。现在将该选择复制到新图层。

然后听从上面罗伯特·伍兹的建议，在下面创建一个新图层，并用颜色填充它，这样你就可以看到你的全部选择。如果您看到要隐藏的部分，请在选择头发层时通过单击图层调色板底部左侧的第三个图标（它看起来像一个内部带有白色圆圈的灰色矩形）来创建图层蒙版。蒙版可让您隐藏稍后的部分内容。带有蒙版的图层上的图层调色板中将出现一个白色框。确保在使用蒙版时选择了白框（上面有边框）。您可以单击图像的小照片来编辑图像或单击白色框来编辑蒙版。选择蒙版后，工具栏底部的两种颜色应为黑色和白色。黑色隐藏图像的部分，白色显示它们。因此，如果您单击铅笔工具并在黑色蒙版上绘制，您将隐藏您绘制的图层部分。如果你然后用铅笔回顾它们并将它们涂成白色，你会发现这些部分。因此，您可以使用铅笔或画笔工具在要隐藏的头发之间的空间上绘制黑色标记。如果你搞砸了，就穿白色的回去。您也可以将透明度设置为小于 100%，但我猜在这种情况下您希望使用 100%。

完成此操作后，在路径窗口中创建一个新路径。当您需要返回头发路径时，只需在路径窗口中单击该路径并使用箭头再次选择它。

# css - Bootstrap Internet Explorer 显示本地和远程

> ID：15121180
> 
> 赞同：1
> 
> 时间：2013-02-27T19:57:10.297
> 
> 标签：css, twitter-bootstrap

我正在使用 Bootstrap CSS 框架。我注意到最奇怪的事情。

当我使用 IE8 查看我制作的网站 ( [http://www.foddersystems.com/fodder-feed/alfalfa.html](http://www.foddersystems.com/fodder-feed/alfalfa.html) ) 时，本地版本和服务器版本看起来不同。起初我以为我的 CSS 文件或 HTML 代码有一些不同。但是，我下载了所有服务器文件并在本地查看它们，它不是代码。有没有人遇到过这个？我知道 IE 不喜欢某些 JS 在本地运行，所以这就是我遇到的问题吗？

![截屏](../Images/d90e9de82cf62f605e739aedf98296a0.png)

请参阅屏幕截图以了解差异：

1.  右上角的导航栏菜单，一个版本有纯色
2.  面包屑链接搞砸了
3.  滑块后有一个额外的休息时间。

同样，本地和远程代码完全相同。我了解 IE8 CSS 支持不是很好。但它应该看起来一样，对吧？除了面包屑问题，我什么都能忍受。我真的需要修复它。我已经根据关于内联块错误的提示以及另一个 StackOverflow 问题调整了原始面包屑 IE。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T07:36:09.613

btn-sucess 的背景颜色设置为

```
.btn-success{background-color:#6C7E54;} This is wat appears in IE8 
```

您可以将其设置为：

```
.btn-success{background-color:#5BB75B;} this will make it look same in all browser,as in ff it appears greenish . 
```

面包屑在 ie8 上对我来说看起来不错，因为您的屏幕截图不可见，所以无法分辨它在本地的外观。

轮播和标签之间的空间问题是由于您设置的小边距和中断标签无法弥补您试图完成的任务

```
.carousel {
margin-bottom: 5px;/*set to higher in order to get more spacing between tabs and carousel*/
position: relative;
} 
```

# vim - 带有类似 vim 的命令的终端仿真器或 shell

> ID：15121181
> 
> 赞同：13
> 
> 时间：2013-02-27T19:57:12.600
> 
> 标签：vim, terminal, terminal-emulator

在过去的几个月里，我有点像 vim 一样疯狂，使用像 Vimium 这样的插件来控制 chrome。我目前使用 iTerm2，但我想知道是否有任何终端仿真器或 shell 使用 vim 命令或者可以配置为具有类似 vim 的命令。

我最感兴趣的是从缓冲区中选择文本（可视模式），将其拉出，然后将其粘贴到下面命令行的某个位置。能够使用 and 向上和向下滚动缓冲区`j`并`k`使用插入模式编辑命令（目前必须使用箭头键）会很好

有这么美的东西吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T20:28:17.867

# 通过vim编辑和执行命令

1.  打开 vim，`:r !history`（或其他），复制内容并通过`:!<type your shell command here>`. `:silent !<blah blah>`如果 vim 之后应该停止用消息骚扰你，请使用最后一个命令。

2.  如果你坚持常规的 emacs 设置（如果你没有像我描述的那样在任何一个 shell 中改变模式，你实际上可以使用 ctrl+a、ctrl+e 等等！），你可以尝试编写你的命令并编辑它在 vim 中通过`CTRL``X``CTRL``E`.
    然而，这取决于通过 EDITOR / VISUAL 环境变量设置的编辑器，它告诉 linux 系统通常应该使用哪个编辑器！

    **如果您有使用 +clipboard 或 +xterm_clipboard 标志编译的 vim，您可以在此处粘贴内容！**
    `:wq`并且您将返回到提示您所做的编辑。

# shell 中的本机绑定

**重击**：`set -o vi`

**zsh**：`bindkey -v`

`ESC`使用或切换到正常模式`CTRL``[`，您可以使用 vim ( `e` `w` `b` `h` `j` `k` `l`...) 中的移动或使用 . 打开具有当前内容的 vim `v`。

贝壳会尽力模仿这种行为。遗憾的是，无论您是否插入，您都没有视觉指示器，除了您键入时输入会发生变化。

要永久拥有本机绑定，请将命令添加到`~/.bashrc`或`~/.zshrc`中，具体取决于您使用的 shell。如果你只是想测试一下，直接在shell上输入这个，只是不要忘记新设置不会这样。
如果您安装了 shell（无论是通过 git 的 bash 还是通过 cygwin），这也适用于 Windows。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T20:32:09.160

sjas 很接近，但缺少关键组件：

`set -o vi`给你 vim 绑定

then press `v` to edit your current line in vim

the mouse is almost always more efficient for selecting text, vim or no vim, so us the mouse for that.

# c++ - 如何将参数传递给 qnetworkrequest get 方法？

> ID：15121187
> 
> 赞同：0
> 
> 时间：2013-02-27T19:57:23.887
> 
> 标签：c++, qt

我想将参数传递给`qnetworkrequest`GET 方法

对于 POST 方法，我做

```
m_network = new QNetworkAccessManager(this);
QNetworkRequest request;
request.setUrl(url);
QByteArray postData;
postData.append("username=...");
postData.append("password=...");
m_network->post(request,postData); 
```

如何将参数传递给 GET 方法？

这是：

```
 request.setRawHeader("ticket",".." ); 
```

正确的方法是什么？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-28T07:21:52.680

我不这么认为，但我没有找到合适的东西..

我正在尝试将java代码转换为java中的c++代码是

```
final GetMethod get = new GetMethod(uri);        
get.setQueryString(new NameValuePair[]{ new NameValuePair("alpha", string_alpha) });
client.executeMethod(get); 
```

# java - 在多线程环境中初始化 EntityManagerFactory

> ID：15121189
> 
> 赞同：0
> 
> 时间：2013-02-27T19:57:26.047
> 
> 标签：java, multithreading, jpa, concurrency, jpa-2.0

我通过与数据库的多个连接来持久化实体。处理持久化的类实现了可运行接口，我在 run() 方法中创建了 EntityManagers。看完[这篇](https://stackoverflow.com/q/5966797/906048)，我想知道是在类构造函数中初始化EntityManagerFactory还是在静态初始化块中更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T07:02:09.967

我假设您在 Java SE 中使用 JPA，而不是 Java EE。此外，我假设您有一个处理实体持久化的类 - 当您要求*类构造函数*或*静态初始化*时，您的意思是这个类。此外，我假设您的所有多个连接都针对同一个数据库......并且我假设您不重用您的实例：既不是您的`EntityManager`实例，也不是您的可运行类实例。

如果假设是正确的，那么我宁愿`EntityManagerFactory`在您的可运行类的静态初始化中或在作为单例实现的第二个类中初始化。

如果您`EntityManagerFactory`在可运行类的类构造函数中创建，则每个实例（即每个线程）都有一个工厂。这是可能的，但没有必要，因为`EntityManagerFactory`多个逻辑相同的`EntityManager`实例只需要一个。

另一个问题是在哪里创建`EntityManager`自身：在类构造函数中（允许您在初始化线程的早期捕获错误）或在`run`- 方法中。就我个人而言，我更喜欢`run`- 方法，因为它允许您`EntityManager`在同一方法中使用`try/finally`)创建和关闭

警告：请注意，您没有跨多个线程的事务。

# java - 扫描仪在运行模式下不读取文本文件

> ID：15121192
> 
> 赞同：1
> 
> 时间：2013-02-27T19:57:31.180
> 
> 标签：java

我试图解决这个问题，但没有取得多大成功。希望得到一些帮助。
从我的 Java 程序内部，我正在调用一个外部可执行文件，它在完成后会创建一个文本 (ASCII) 文件。我在用

```
Process p = Runtime.getRuntime().exec("....exe");` 
```

接下来，我要求它在切换之前完成

```
int exitValue = p.waitFor(); 
```

并确保退出值为 0。

在那之后，我正在创建一个 Scanner 对象来读取新创建的文件：

```
File outputFile = new File(outputFileName);
Scanner scan = new Scanner(outputFile); 
```

该文件与可执行文件位于同一文件夹中，但无论如何我都将完整路径传递给它。
当我检查我是否可以读取文件 ( `outputFile.canRead()`) 时，答案是正确的。
当我检查文件的长度时，它返回给我一些 > 0 的数字，即 440827。
但是，当我尝试调用`scan.hasNextLine()`or时`scan.hasNext()`，答案是否定的。
一个有趣的事实是，当我在 NetBeans 调试模式下运行它时，一切正常。所以，我的猜测是我处于某种竞争状态，即使我正在采取预防措施不中断进程的线程。我试图`Thread.sleep()`在调用之前插入语句`nextLine()`，但没有结果。
请问有什么建议吗？

这是代码的简化版本......根据要求，这里有更详细的处理（分布在 4 个类之间） - 我为几个级别的重定向道歉：

```
public class A
{
    private void runEngine()
    {
        try
        {
        // Skip irrelevant stuff - model is an object of class B:            
            model.runEngineIfNeeded(keepInputFiles);
            outputFileTextArea.setText(
                model.processOutput(keepInputFiles, keepOutputFiles));
        //...
        }
        catch (Throwable ex)
        {
            LOGGER.log(Level.SEVERE, null, ex);
        }
    }

public class B    
{
    public void runEngineIfNeeded(boolean keepInputFiles)
        throws IOException, InterruptedException
    {
        // exit under some condition, otherwise:
        boolean enginOK = false;

        while(!enginOK)             
             enginOK = createEnginFile(keepInputFiles);
    }
    public boolean createEnginFile(boolean keepFile)
    {
        String engineDir = "C:/data";     
        final String[] cmdArray = {"cmd", "/C", B.EXE_FILENAME};
        // output is a 2-dimensional array of strings
       output = Exec.getSTDERRandSTDOUT(cmdArray, engineDir);

       if (output[1].isEmpty())
            return true; //no exception occur

      // do some data manipulation and...
      return false;
    }

    public String processOutput(boolean keepLoopinInput, boolean keepLoopinOutputs)
                throws IOException, InterruptedException
   {
       String enginOutput = null;

       while (enginOutput == null)
       {
            enginOutput = c.processEnginOutput();  // c is an obj of class C

        if (enginOutput == null)
            createLoopinFile(keepEngineInput);
    }

    return enginOutput;
   }
}

public class Exec
{
    public static String[] getSTDERRandSTDOUT(String[] cmd, String directory)
        throws IOException, InterruptedException {
        String[] output = new String[2]; // 2 string array for output
        ProcessBuilder processBuilder = new ProcessBuilder(cmd);

        if (directory != null) {
            processBuilder.directory(new File(directory));
        }

        Process process = processBuilder.start();
        ExecStreamRedirect stdout = new ExecStreamRedirect(process.getInputStream(), 
                                                           OutputType.STDOUT);

       stdout.start();

       ExecStreamRedirect stderr = new ExecStreamRedirect(process.getErrorStream(),
                                                          OutputType.STDERR);

       stderr.start();
       int waitFor = process.waitFor();

       output[0] = stdout.getSTDOUT().toString();
       output[1] = stderr.getSTDERR().toString();
       return output;
    }
}

class C
{
    public String processEnginOutput(float actKtDLS, boolean keepOutputs)
                throws FileNotFoundException, InterruptedException,
                       IOException
    { // Read file into Output text area:
        File analysisOutputFile    = new File(outputFileNamePath);
        Scanner scan               = null;
        String scanLine            = "";
        StringBuilder enginOutput = new StringBuilder(
                                        (int) analysisOutputFile.length());
        boolean outputFileOK = false;

        // Must be careful here, possibility for endless loop:
        stop: for (int i = 2000; i < 4000 && !outputFileOK; i+= 100)
        {
            int j = 0; // start counting lines

            try
            {
                if (GenericUtils.waitIfFileIsNotReady(analysisOutputFile, j))
                 // does not exist & readable
                    continue; // go to next iteration

                scan = new Scanner(analysisOutputFile);

                for (; !outputFileOK; j++)
               {
                    scanLine = scan.nextLine();
                    enginOutput.append(scanLine).append("\n\n");

               // .. more logic here;
               }

               // .. more logic here;

               scan.close();

               return enginOutput.toString();
            } // end of try
            catch (NoSuchElementException ex)
            { //EOF reached
                 processEngineDelay(
             "output file is not completly written. Last line read: "
                                 + j + ".  " + scanLine +
                                  ". Wait " + i + " msecs.",
                                   scan,
                                   i);
            }  // continue [stop] with the next loop iteration...
        } // repeat up to 20 times if needed       
    }

    private static void processEngineDelay(String msg, Scanner scan, int i)
                throws InterruptedException
   {
        // to perform error processing
        LOGGER.warning(msg);
        scan.close(); // close scan
        scan = null;
        Thread.sleep(i);
   }
} 
```

我想就是这样......我很抱歉 - 代码很复杂，这就是我最初只提供简化版本的原因。希望我列出了所有相关部分

# datagridview - 如何正确填充 VB.net datagridview 组合框

> ID：15121196
> 
> 赞同：0
> 
> 时间：2013-02-27T19:57:36.677
> 
> 标签：datagridview, combobox

我`datagridview`在 vb.Net 2008 中创建了一个带有组合框的控件。在下面的代码中，我检索多行数据并配置我`datagrid`以正确显示数据。`datagrid`对于返回的所有行，我可以毫无问题地填充每一行的组合框。

当我在检索特定记录的数据时尝试自动选择值时，所有组合框都错误地填充了相同的值。

在下面的代码中，“填充网格组合”代码表示我如何将值加载到组合框中。“填充特定记录”代码是我认为我遇到问题的地方。为什么所有记录的组合框都返回相同的值？我知道我的循环是正确的，因为非组合框已正确填充。

```
'Populate the Grid Combo
            conCombo.Open(sConnectionString)

        'Populate the Referral Reason combo box
        sSQL = "SELECT Referral_Reason_Id, Referral_Reason FROM Referral_Reason WHERE DELETED = FALSE ORDER BY SortOrder"

        cmdCombo = New ADODB.Command
        cmdCombo.ActiveConnection = conCombo
        cmdCombo.CommandText = sSQL
        rsCombo = cmdCombo.Execute

        i = 0
        Do While i < dgPPV.RowCount
            Do While Not rsCombo.EOF
                Dim dgvcc As DataGridViewComboBoxCell
                dgvcc = dgPPV.Rows(i).Cells(3)
                dgvcc.Items.Add(New MyListItem(rsCombo.Fields(1).Value, rsCombo.Fields(0).Value))
                rsCombo.MoveNext()
            Loop
            rsCombo.MoveFirst()
            i = i + 1
        Loop

        If rsCombo.State Then rsCombo.Close()
        If conCombo.State Then conCombo.Close()
        If cmdCombo.State Then cmdCombo.ActiveConnection = Nothing

'Populate specific record
        Sub GetPPVGridData()

        Dim i As Integer

        CloseConnectionString()
        con.Open(sConnectionString)

        sSQL = "SELECT Policy.PolicyDescription, Referral_Reason.Referral_Reason, ERS_Outcome.Outcome_Description, Audit_Outcome.Comment "
        sSQL = sSQL & "FROM ((Audit_Outcome INNER JOIN Referral_Reason ON Audit_Outcome.Referral_Reason_Id = Referral_Reason.Referral_Reason_Id) INNER JOIN Policy ON Audit_Outcome.Policy_Id = Policy.Policy_ID) INNER JOIN ERS_Outcome ON Audit_Outcome.Outcome_Id = ERS_Outcome.Outcome_Id "
        sSQL = sSQL & "WHERE Audit_Outcome.Referral_Id = " & lblReferralId.Text

        cmd = New ADODB.Command
        cmd.ActiveConnection = con
        cmd.CommandText = sSQL
        rs = cmd.Execute

        Do While Not rs.EOF
            For i = 0 To dgPPV.RowCount - 1
                If dgPPV.Rows(i).Cells("dgPPVDescription").Value = rs.Fields(0).Value Then
                    dgPPV.Rows(i).Cells("dgCheckPPV").Value = True
                    dgPPV.Rows(i).Cells("dgPPVDescription").Value = rs.Fields(0).Value
                    dgPPV.Rows(i).Cells("dgPPVReferralReason").Value = rs.Fields(1).Value
                    dgPPV.Rows(i).Cells("dgPPVOutcome").Value = rs.Fields(2).Value
                    dgPPV.Rows(i).Cells("dgPPVComment").Value = rs.Fields(3).Value
                End If
            Next
            rs.MoveNext()
        Loop
        CloseConnectionString()

    End Sub 
```

任何意见是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T12:43:23.310

我弄清楚了情况。我改变了将值读入组合框的方式。我从使用我熟悉的（记录集）切换到数据阅读器。更容易和更少的代码。

```
 oConn.Open()
    oCmdSelect.CommandText = "SELECT Referral_Reason_Id, Referral_Reason FROM Referral_Reason WHERE DELETED = FALSE ORDER BY SortOrder"
    oCmdSelect.Connection = oConn
    oReader = oCmdSelect.ExecuteReader

    While oReader.Read
        dgPPVReferralReason.ValueMember = oReader.Item(0)
        dgPPVReferralReason.DisplayMember = oReader.Item(1).ToString
        dgPPVReferralReason.Items.Add(oReader.Item(1).ToString)
    End While

    oConn.Close()
    If oConn.State Then oConn.Close() 
```

# xml - 删除一个元素，但将内容保留在 xmlstarlet 的父元素中

> ID：15121198
> 
> 赞同：0
> 
> 时间：2013-02-27T19:57:47.873
> 
> 标签：xml, xmlstarlet

我正在使用 xmlstarlet 并希望转换这种类型的元素：

```
<entry>
<para>Text</para>
</entry>
<entry>
<para>
<emphasis role=bold>text</emphasis>
</para> 
```

到：

```
<entry>Text</entry>
<entry><emphasis role=bold>text</emphasis></entry> 
```

这在 xmlstarlet 中可能吗？

任何帮助是极大的赞赏！

谢谢，

拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T01:43:31.237

```
xmlstarlet ed -u //para/.. -x 'para/node()' para.xml 
```

这意味着：`para`用`para`. 需要版本 1.4.0+

# javascript - Rails 2.1 上的集成测试

> ID：15121201
> 
> 赞同：0
> 
> 时间：2013-02-27T19:58:16.017
> 
> 标签：javascript, ruby-on-rails, ruby, integration, integration-testing

在我的工作中，我们目前使用的是 Rails 2.1，我们需要做更多的集成测试。我们的问题是与我们的 rails 版本一起使用的 Cucumber 版本没有测试页面上的 javascript，因为我们没有 Rack/Capybara。我们停止使用 Selenium，因为它非常慢。

我正在研究 EnvyJS，我不知道是否有解决方案。

有没有用 javascript 测试我们的网页的解决方案？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-27T20:13:56.020

如果这个应用程序暴露在互联网上，那么您需要立即升级到 Rails 2.3。[http://weblog.rubyonrails.org/2013/1/8/Rails-3-2-11-3-1-10-3-0-19-and-2-3-15-have-](http://weblog.rubyonrails.org/2013/1/8/Rails-3-2-11-3-1-10-3-0-19-and-2-3-15-have-been-released/)上的安全漏洞[been-released/](http://weblog.rubyonrails.org/2013/1/8/Rails-3-2-11-3-1-10-3-0-19-and-2-3-15-have-been-released/)是这样的，任何运行未打补丁的 Rails 版本的应用程序的服务器*都将*通过自动脚本小子漏洞自动获得 ruby​​ 进程拥有的所有权限。这只是时间问题。

除此之外，一旦您脱离了维护版本的最佳位置，并且您开始花费越来越多的时间为已经修复的问题推出自己的解决方案，Rails 开发通常会变得非常痛苦。这可能不是您要寻找的答案，但我怀疑任何人都会有更好的答案，因为我们所有的努力都在更新版本。对于版本的长期稳定性，Ruby 和 Rails 尤其是最糟糕的语言选择之一。

# excel - Excel中的值范围求和

> ID：15121206
> 
> 赞同：0
> 
> 时间：2013-02-27T19:58:28.070
> 
> 标签：excel, excel-formula

假设我有一个这样的表：

```
 A    B

1    12   4.5
2    22   1.7
3    44   3.4
4    17   2.2
5    11   1.9
6    23   2.7 
```

在给定一定范围的 A 的情况下，如何编写命令来总结 B 的值？例如，A 范围 11-20 的 B 值的总和将是 4.5 + 2.2 + 1.9 = 8.6 我只想对适合该 A 范围的 B 列的值求和。

我假设您需要一个语句来检查 A 的值是否适合该范围，然后将相应的行映射到 B 的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:05:40.357

如果您有 Excel 2007 或更高版本，请尝试 SUMIFS

`=SUMIFS(B:B,A:A,">=11",A:A,"<=20")`

看起来答案实际上是 8.6

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:17:37.417

以下公式应该可以完成这项工作。它假设数据范围是 A1:B6，11 in 是 B8，20 在 B9：

```
 =SUM((A1:A6>=B8)*(A1:A6<=B9)*(B1:B6)) 
```

作为数组公式，需要用`Control`- `Shift`-`Enter`组合键输入。

# ios - 如何在 iOS 中读取、写入和检查不区分大小写的文件名？

> ID：15121210
> 
> 赞同：6
> 
> 时间：2013-02-27T19:58:38.337
> 
> 标签：ios, objective-c, file-io, case-sensitive, case-insensitive

我知道 iOS 文件名区分大小写，而 OSX 文件名可以不区分大小写。Apple 的 iCloud 设计指南说：

“要使您的文档文件格式跨平台兼容，您必须以不区分大小写的方式读写文件。” （来自[http://developer.apple.com/library/ios/#documentation/General/Conceptual/iCloudDesignGuide/Chapters/DesigningForDocumentsIniCloud.html](http://developer.apple.com/library/ios/#documentation/General/Conceptual/iCloudDesignGuide/Chapters/DesigningForDocumentsIniCloud.html)）

我想让我的应用程序的文件管理在 iOS 中不区分大小写。处理读取和写入文件的正确方法是什么，以及`[NSFileManager fileExistsAtPath:]`在 iCloud 和本地文件系统中以不区分大小写的方式检查 iOS 中的文件是否存在（使用）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T21:02:44.467

没有特定的东西会使 iOS 不区分大小写。就是这样。他们告诉你的是，你不能依赖大小写敏感（不要创建仅区分大小写的文件），并且你不应该草率​​地使用大小写（不要创建“自述文件”然后阅读“自述文件”）。

如果您在 iOS 上接受用户的任意文件名，然后计划将它们发送到 iCloud，那么您将需要查询 iCloud 上存在的所有文件并验证不存在不区分大小写的冲突（使用`[NSString caseInsensitiveCompare:]`）。不过，只要您专门使用 iCloud，这不应该出现很多。

# asp.net - 在数据集中丢失时区

> ID：15121213
> 
> 赞同：0
> 
> 时间：2013-02-27T19:59:04.537
> 
> 标签：asp.net, oracle11g

我有一个包含几个 TIMESTAMP WITH TIME ZONE 字段的数据库表。我从该表中选择记录并将它们放入数据集中。当我尝试访问日期/时间字段时，我似乎丢失了时区信息。我尝试在 adapter.Fill() 之前添加以下内容：

```
adapter.ReturnProviderSpecificTypes = true; 
```

但这会导致所有字段都使用 Oracle 数据类型，而不仅仅是日期/时间字段。例如，我不能再 Convert.ToInt32(dr["SomeIntField"]) 因为它现在是 OracleDecimal。有什么方法可以将时区信息从我的表中获取到数据集中，而不会弄乱所有其他字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:58:48.330

我将 ReturnProviderSpecificTypes 替换为以下内容：

```
adapter.SafeMapping.Add("*", typeof(string));
adapter.Fill(ds); 
```

这会将数据转换为字符串类型（只有选项是 sting 和 byte[]）。它似乎保留了我可以使用的时区格式：

```
dtzTime = new OracleTimeStampTZ(dr["MY_DBTable_Column_with_TZ"].ToString()); 
```

我用美国/东部、美国/太平洋等时区存储我的日期，所以以上返回：26-FEB-2013 14:49:46.169030000 US/MOUNTAIN

# c# - 在中继器控制器中选中复选框时如何获取隐藏字段值？

> ID：15121218
> 
> 赞同：0
> 
> 时间：2013-02-27T19:59:24.813
> 
> 标签：c#, asp.net

我有 asp.net 中继器控制器，我试图获取隐藏字段的值`CheckBox1_CheckedChanged`

```
<ul id="sortable">
    <asp:Repeater runat="server" ID="rep_sortable">
        <ItemTemplate>
            <li class="ui-state-default">
               <span class="ui-icon ui-icon-arrowthick-2-n-s"></span>
               <%# DataBinder.Eval(Container.DataItem, "Body") %> 
               <%# DataBinder.Eval(Container.DataItem, "Completed") %> 
               <asp:CheckBox ID="chb_com"  runat="server" AutoPostBack="True" Checked='<%# DataBinder.Eval(Container.DataItem, "Completed")  %>' oncheckedchanged="CheckBox1_CheckedChanged"/>
               <asp:HiddenField ID="hf_reminderID" runat="server" Value='<%# DataBinder.Eval(Container.DataItem, "ReminderID")  %>'/>
            </li>
        </ItemTemplate>
    </asp:Repeater>
</ul> 
```

C＃

```
protected void CheckBox1_CheckedChanged(object sender, EventArgs e)
{
   foreach()
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:10:24.540

您可以使用[NamingContainer](http://msdn.microsoft.com/en-us/library/system.web.ui.control.namingcontainer.aspx)来查找同级控件。

```
protected void CheckBox1_CheckedChanged(object sender, EventArgs e)
{
    var checkBox = (CheckBox) sender;
    var reminderHiddenField = (HiddenField)checkBox.NamingContainer
        .FindControl("hf_reminderID");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:13:03.997

此代码应该可以工作：

```
protected void CheckBox1_CheckedChanged(object sender, EventArgs e)
        {
            var checkBox = sender as CheckBox;
            var hiddenField = checkBox.Parent.FindControl("hf_reminderID") as HiddenField;
            var value = hiddenField.Value;
        } 
```

# imagemagick - Imagemagick 替换颜色但保持透明度

> ID：15121220
> 
> 赞同：7
> 
> 时间：2013-02-27T19:59:28.157
> 
> 标签：imagemagick

我想用另一种颜色替换 PNG 徽标中的所有黑色实例。我试过了：

```
convert source.png -fill #123456 -opaque black out.png 
```

但是标志有一些透明的黑色像素没有被转换。如何更改每个黑色像素，但保持每个像素的透明度？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2019-04-12T20:03:30.937

```
convert in.png xc:"#ff0000" -channel RGB -clut  out.png 
```

这将完成这项工作。如果 in.png 有 alpha 通道，in.png 中的 RGB 通道将被替换为红色 (#ff0000)，同时保持 alpha 通道不变。

这里会发生什么？in.png 是第一个输入图像。xc:"#ff0000" 是第二个输入图像（xc: 特殊文件被 ImageMagick 解释为一个全部用给定颜色填充的图像）。-clut 选项（“颜色查找表”）将第二个图像解释为查找表并将其应用于第一个图像中的值。由于第二张图像是单色的，因此在本例中，第一张中的每种颜色都映射为红色。最后一个文件名 (out.png) 被解释为输出文件。

为什么 -clut 不影响 alpha 通道？好吧，您可以使用 -channel 选项设置受影响的频道。它必须在 -clut 之前。RGB 是我们想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-16T14:43:18.533

你可以尝试这样的事情：

```
convert source.png -channel RGB -fuzz 99% -fill blue -opaque black dest.png 
```

但只有当您的徽标是单色的（如 iOS 图标 - 只有一种颜色和透明度）时，它才会起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-13T22:17:46.293

我意识到这是一个老问题，但我花了难以置信的时间，却没有找到答案。但最后我想通了。

**注意：**我的图像是全黑的，使其成为带有 alpha 的灰度。（即我所有的像素看起来像： R=0, G=0, B=0, A=X 。您的像素可以是其他任何东西，我认为您将能够调整我的答案。

```
convert in_file.png -alpha off -fuzz 100% -fill blue -opaque '#000000' -alpha on -format png32 out_file.png32 
```

**这里发生了什么事？**

1.  `alpha off`这意味着，如果图像没有 alpha 通道，则没有任何变化，如果您的图像确实有 alpha 通道，则后续操作将假装它不存在。
2.  不幸的是，当使用`.png`后缀保存图像时，imagemagick 将决定使用最有效的格式，索引。我不知道为什么，但它认为我的图像是 1 位可表示的：完全透明/完全不透明的颜色，并且我失去了 alpha 通道的所有更精细的细节。也许还有其他解决方案，但我的可靠方法是在文件名上使用“.png32”后缀。这意味着，图像必须以 8bit-8bit-8bit-8bit RGBA 格式保存。

**无论如何，如果您尝试调试，为什么您的图像管道不适用于透明度：**

*   用 gimp 打开图像

*   在窗口的顶部栏中，您应该会看到`...Indexed color...`或其他内容，例如`...RGB color...`. 如果您看到`Indexed color`，也许您的管道已经运行良好，只是它以错误的格式保存！

是的，这是一个双重错误......关于其中一个错误，您可能已经正确了几十次......猜猜我在经过数小时的无望谷歌搜索和尝试后发现这一点时在想什么......

*版本：ImageMagick 6.8.9-9 Q16 x86_64 2017-07-31 [http://www.imagemagick.org](http://www.imagemagick.org)*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-13T22:38:30.210

在 ImageMagick 中，如果您有透明度，请尝试

```
convert source.png -alpha off -fuzz XX% -fill "#123456" -opaque black -alpha on out.png 
```

其中 XX 是接近黑色的某个百分比，您可能希望包括在内。如果您只想更改纯黑色，则可以设置 XX=0。

请注意，上面的代码会将所有黑色像素更改为新颜色，包括透明度下的任何黑色。

如果您只想将完全不透明的黑色更改为新颜色，而不是透明度下的任何黑色，请在颜色中包含 alpha 值。所以试试

```
convert source.png  -fuzz XX% -fill "#123456FF" -opaque "graya(0)" -alpha on out.png 
```

如果使用 IM 7，则将 convert 更改为 magick。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-01-22T19:16:57.247

根据我的经验，以前的回复对我的看法有一个缺点：如果您的绘图有软边缘（由于 alpha 通道），您会丢失它们并且您的结果只有锐利的边缘。使用此命令可以保留软边缘：

```
magick in_file.png -fill "#6696DC" -colorize 100% out_file.png32 
```

正如 Zoltan 所提到的，我需要使用 png32 后缀来强制执行 png 32 位编码。然后，只需要在文件生成后重命名文件（删除 32），就可以获得具有正确扩展名的工作文件。

注意：我使用的是 ImageMagick 7.0.8-24 Q16 x64。

# python - 如何实现跳过列表

> ID：15121221
> 
> 赞同：0
> 
> 时间：2013-02-27T19:59:29.523
> 
> 标签：python, nodes, insertion, skip-lists

我想知道如何在 python 中实现一个跳过列表。

我已经制作了一个链接列表，但是在如何创建链接列表的不同级别以及在搜索或将节点插入列表时如何遍历列表的每个级别时遇到了麻烦。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-27T20:10:35.063

你可以阅读[John Shipman 写得很好的纯 Python 实现](http://infohost.nmt.edu/tcc/help/lang/python/examples/pyskip/web/index.html)，其中甚至包括关于他如何构建它的详细解释，从顶层设计到类的实现方式，包括讨论如何提供一个好的 Pythonic界面。

您还可以搜索[PyPI](https://pypi.python.org/pypi)，其中有多个附加实现。

或者您可以阅读[Wikipedia 条目](http://en.wikipedia.org/wiki/Skip_list)或[原始论文](ftp://ftp.cs.umd.edu/pub/skipLists/skiplists.pdf)，两者都有详细的解释和伪代码，您可以将其翻译成 Python。

您现有的问题太笼统了。但是如果在阅读了相关资料后，你有具体的问题（“Shipman 的这部分代码是做什么的”、“Pugh 论文中的这行伪代码是什么意思，我如何将其翻译成 Python”、“究竟是什么？是一个'切割清单'”等），那么你可以问SO。

# java - OO/带数字的泛型

> ID：15121230
> 
> 赞同：2
> 
> 时间：2013-02-27T19:59:46.403
> 
> 标签：java, oop

我有这种情况，但为什么 java 不尊重类层次结构？

```
import ...

public class GenericsTest {

    public static void main(String[] args) {
        List<Integer> myList = new ArrayList<Integer>();
        myList.add(1);
        myList.add(new Integer(2));
        new GenericsTest().doInsert(myList);
    }

    private void doInsert(List<? extends Number> myList) { // Number <- Integer
        myList.add(new Integer(1)); // This don't compiles
    }
} 
```

有人可以解释一下吗？谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:06:20.657

泛型中的通配符并不意味着“任何事情”，而是意味着“我不知道”。所以`List<? extends Number>`不是“一个可以容纳任何扩展数字的列表”。它是“扩展数字的东西的列表，但我不知道它们是什么”。所以向它添加一个 Integer 是非法的，因为你不知道 Integer 是否是扩展这个列表的数字的东西。任何扩展 Number 的列表只是`List<Number>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:09:03.197

想象一下，如果您提供的代码是合法的，那么下面的代码会发生什么：

```
List<Double> listDouble = new ArrayList<Double>();
doInsert(listDouble);

Double d = listDouble.get(0); //ClassCastException! 
```

编译器在最后一行添加了一个隐式转换。这种转换在运行时失败，这破坏了泛型的类型安全保证，因为编译器并没有使您免于破坏列表内容和数据类型假设。它应该只保存 Double 值，但在里面找到了一个整数。

您的选择：

```
doInsert(List<? extends Number> myList) 
```

允许迭代 Numbers，但不能添加到集合中。接受在 Number 的任何子类型上定义的列表。

```
doInsert(List<Number> myList) 
```

允许迭代和修改，但只接受完全定义为 List<Number> 的列表。

```
doInsert(List<? super Number> myList) 
```

允许迭代项目（作为对象），并允许添加任何类型的数字。仅接受其祖先数量的列表（在这种情况下它实际上无用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:10:38.023

这不起作用的原因是被引用列表的类型不必是整数。但是，以下将编译。

```
private void doInsert(List<Number> myList) { 
    myList.add(new Integer(1));
} 
```

随着：

```
private void doInsert(List<? extends Number> myList) { 
    ((List<Number>)myList).add(new Integer(1));
} 
```

我根据@Eyal Schneider 的评论附加了这个答案，以表明如果您正确设置，列出的第二种方式确实有效。尽管这很可能不是一件好事。

```
public class Test{  
    public void doInsert(List<? extends Number> myList) { 
        ((List<Number>)myList).add(new Integer(1));
        ((List<Number>)myList).add(new Short("2"));
        ((List<Number>)myList).add(new BigDecimal("3"));
        ...
    }  

    public static void main(String[] args){
        Test t=new Test();
        List<Number> list=new ArrayList<Number>();
        t.doInsert(list);
            for(Number number:list)
                System.out.println(number);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:15:45.157

考虑以下反例，假设它是可以接受的：

```
public class GenericsTest {
  public static void main(String[] args) {
    List<Integer> myList = new ArrayList<Integer>();
    myList.add(1);
    myList.add(new Integer(2));

    List<Integer> myDoubleList = new ArrayList<Double>();
    myList.add(1.0);
    myList.add(new Double(2));
    new GenericsTest().doInsert(myList); // Here you're trying to add an Integer into a List<Double>
  }

  private void doInsert(List<? extends Number> myList) { // Number <- Integer
    myList.add(new Integer(1)); // This don't compiles
  }

} 
```

# drupal - Drupal 7 - 在#link 表单类型条目中添加 HTML？

> ID：15121231
> 
> 赞同：3
> 
> 时间：2013-02-27T19:59:51.977
> 
> 标签：drupal, drupal-7, drupal-forms

我需要将 HTML 标记添加到`#title`Drupal 7`#type`链接表单元素的字段。输出应大致如下所示：

```
<a href="/saveprogress/nojs/123" id="saveprogress-link" class="ajax-processed">
  <span data-icon="&#61515;" aria-hidden="true" class="mymodule_symbol"></span>
  Save Progress
</a> 
```

由于我在做一些 ajax 表单，我不能只使用`#markup`和`l()`运行。这是一个没有跨度的示例：

```
function mymodule_save_progress_link($nid) {
  return array(
    '#type' => 'link',
    '#title' => t('Save Progress'),
    '#href' => 'saveprogress/nojs/' . $nid,
    '#id' => 'saveprogress-link',
    '#ajax' => array(
      'wrapper' => 'level-form',
      'method' => 'html',
    ),
  );
}

function mymodule_print_links($nid=NULL) {
  ctools_include('ajax');
  ctools_include('modal');
  ctools_modal_add_js();

  $build['saveprogress_link'] = mymodule_save_progress_link($nid);

  return '<div id="level-form">' . drupal_render($build) . '</div>';
} 
```

当我添加`<span>`到该`#title`字段时，它被转义而不被解释为 HTML。如何将此跨度（或其他标记）插入到`link`类型表单元素的 tile 字段中。这个表单元素在 Drupal 站点上没有很好的记录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T21:04:56.957

实际上有一种比自定义滚动主题更简单的方法 - 只需告诉`drupal_render()`将`'#title'`其视为 html。

```
function mymodule_save_progress_link($nid) {
  return array(
    '#type' => 'link',
    '#title' => '<span>unescaped HTML here</span> '.t('Save Progress'),
    '#href' => 'saveprogress/nojs/' . $nid,
    '#id' => 'saveprogress-link',
    '#ajax' => array(
      'wrapper' => 'level-form',
      'method' => 'html',
    ),
    '#options' => array(
      'html' => true,
    )
  );
} 
```

这对于将图像或其他元素添加到可点击区域非常方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:48:00.273

我确信有更好的方法，但这是使用自定义主题的一种工作方法。您需要在 hook_theme() 中注册自定义主题功能，然后禁用并重新启用您的模块以更新主题注册表。在您的自定义主题函数中，您可以重写输出 HTML，但您需要添加一个不同的类“use-ajax”。

```
/**
 * Implements hook_theme().
 */
function mymodule_theme() {
  return array (
    'mymodule_link' => array(
      'render element' => 'element',
    ),
  );
}

/**
* Returns HTML for a mymodule link
*
* @param $variables
*   An associative array containing:
*   - element: A render element containing the properties of the link.
*
* @ingroup themeable
*/
function theme_mymodule_link($variables) {
  return l(
    '<span data-icon="&#61515;" '.
      'aria-hidden="true" class="mymodule-symbol"></span> '.
      $variables['element']['#title'],
    $variables['element']['#href'],
    array(
     'html' => TRUE, 
     'attributes' => array(
       'class' => array('use-ajax'), 
       'title' => $variables['element']['#title']
     )
    )
  );
} 
```

最后，要求表单元素使用这个主题：

```
function mymodule_save_progress_link($nid) {
  return array(
    '#type' => 'link',
    '#title' => t('Save Progress'),
    '#href' => 'saveprogress/nojs/' . $nid,
    '#id' => 'saveprogress-link',
    '#ajax' => array(
      'wrapper' => 'level-form',
      'method' => 'html',
    ),
    '#theme' => 'mymodule_link',
  );
} 
```

# java - 通过在 ArrayList 中以逗号分隔来存储字符串

> ID：15121233
> 
> 赞同：1
> 
> 时间：2013-02-27T20:00:02.583
> 
> 标签：java, string, arraylist, split

我有一个`config.property`文件，其中有以下属性-

```
Table1.columns: ACCOUNT, ADVERTISING, INFO, BEHAVIOR, CHURN, SEGMENTATION, 
```

我正在尝试读取上面的属性文件，然后通过在 a中`columns`拆分来存储它们`comma``ArrayList`

所以我使用下面的方式。有没有更好的方法来做同样的事情？这里`arg`是`Table1`

```
ArrayList<String> columns = new ArrayList<String>();

Collections.addAll(columns, prop.getProperty(arg + ".columns").split(",")); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:07:32.580

看看[Arrays.asList](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#asList%28T...%29)：

```
List<String> columns = 
     Arrays.asList( prop.getProperty(arg + ".columns").split(",") ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:06:58.097

用这个：

```
prop.getProperty(arg + ".columns").split("\\s*,\\s*") 
```

# entity-framework - EF 查询优化

> ID：15121238
> 
> 赞同：1
> 
> 时间：2013-02-27T20:00:09.527
> 
> 标签：entity-framework, optimization, query-optimization

我正在研究一个小型 POC，主要是为了帮助我更好地理解 EF。有没有更有效的方法来实现以下？

```
private static bool IsUserGrantedPermission(DatabaseContext db, Permission permission, User user)
{
    var userRoles = db.Roles.Where(r => r.RolesUsers.Any(ru => ru.UserId == user.Id));
    var userPerms = db.Permissions.Where(p => p.RolesPermissions.Any(rp => userRoles.Any(ur => ur.Id == rp.RoleId)));
    //Console.WriteLine(userPerms.ToString());
    return userPerms.Any(up => up.Id == permission.Id);
} 
```

这是生成的 SQL：

```
exec sp_executesql N'SELECT 
CASE WHEN ( EXISTS (SELECT 
    1 AS [C1]
    FROM [dbo].[Permissions] AS [Extent1]
    WHERE ( EXISTS (SELECT 
        1 AS [C1]
        FROM ( SELECT 
            [Extent2].[RoleId] AS [RoleId]
            FROM [dbo].[RolesPermissions] AS [Extent2]
            WHERE [Extent1].[Id] = [Extent2].[PermissionId]
        )  AS [Project1]
        WHERE  EXISTS (SELECT 
            1 AS [C1]
            FROM [dbo].[Roles] AS [Extent3]
            WHERE ( EXISTS (SELECT 
                1 AS [C1]
                FROM [dbo].[RolesUsers] AS [Extent4]
                WHERE ([Extent3].[Id] = [Extent4].[RoleId]) AND ([Extent4].[UserId] = @p__linq__0)
            )) AND ([Extent3].[Id] = [Project1].[RoleId])
        )
    )) AND ([Extent1].[Id] = @p__linq__1)
)) THEN cast(1 as bit) WHEN ( NOT EXISTS (SELECT 
    1 AS [C1]
    FROM [dbo].[Permissions] AS [Extent5]
    WHERE ( EXISTS (SELECT 
        1 AS [C1]
        FROM ( SELECT 
            [Extent6].[RoleId] AS [RoleId]
            FROM [dbo].[RolesPermissions] AS [Extent6]
            WHERE [Extent5].[Id] = [Extent6].[PermissionId]
        )  AS [Project6]
        WHERE  EXISTS (SELECT 
            1 AS [C1]
            FROM [dbo].[Roles] AS [Extent7]
            WHERE ( EXISTS (SELECT 
                1 AS [C1]
                FROM [dbo].[RolesUsers] AS [Extent8]
                WHERE ([Extent7].[Id] = [Extent8].[RoleId]) AND ([Extent8].[UserId] = @p__linq__0)
            )) AND ([Extent7].[Id] = [Project6].[RoleId])
        )
    )) AND ([Extent5].[Id] = @p__linq__1)
)) THEN cast(0 as bit) END AS [C1]
FROM  ( SELECT 1 AS X ) AS [SingleRowTable1]',N'@p__linq__0 uniqueidentifier,@p__linq__1 uniqueidentifier',@p__linq__0='C0E7EB21-BB3D-424E-8EF0-48A6C9526410',@p__linq__1='A94F0203-B97B-46FF-824D-BBA9D482E674' 
```

为什么 EF 不生成 WHEN-THEN-ELSE 语句（其中 ELSE 语句返回 0 而不是生成 WHEN-THEN-THEN 语句集，其中第二个 THEN 实际上是第一个的副本，只是被否定了？因为 userPerms. Any(...) 调用返回布尔值，WHEN-THEN-ELSE 不是更有效的实现吗？在错误的情况下，不是（实际上）相同的语句运行两次吗？

再说一次，我是新手，所以也许我只需要以不同的方式建模，或者我需要以不同的方式编写查询。我只是想更好地了解幕后发生的事情。

这是重写的 OnModelCreating 函数。

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Entity<RoleUser>()
                .HasKey(ru => new { ru.RoleId, ru.UserId })
                .ToTable("RolesUsers");

            modelBuilder.Entity<User>()
                .HasMany(u => u.RolesUsers)
                .WithRequired()
                .HasForeignKey(ru => ru.UserId);

            modelBuilder.Entity<Role>()
                .HasMany(r => r.RolesUsers)
                .WithRequired()
                .HasForeignKey(ru => ru.RoleId);

            modelBuilder.Entity<RolePermission>()
                .HasKey(rp => new { rp.RoleId, rp.PermissionId })
                .ToTable("RolesPermissions");

            modelBuilder.Entity<Permission>()
                .HasMany(p => p.RolesPermissions)
                .WithRequired()
                .HasForeignKey(rp => rp.PermissionId);

            modelBuilder.Entity<Role>()
                .HasMany(r => r.RolesPermissions)
                .WithRequired()
                .HasForeignKey(rp => rp.RoleId);

            modelBuilder.Entity<User>()
                .HasKey(user => user.Id)
                .Property(user => user.Id)
                .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
            modelBuilder.Entity<User>()
                .Property(user => user.Name);

            modelBuilder.Entity<Role>()
                .HasKey(role => role.Id)
                .Property(role => role.Id)
                .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
            modelBuilder.Entity<Role>()
                .Property(role => role.Name);

            modelBuilder.Entity<Permission>()
                .HasKey(permission => permission.Id)
                .Property(permission => permission.Id)
                .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
            modelBuilder.Entity<Permission>()
                .Property(permission => permission.Name);

            base.OnModelCreating(modelBuilder);
        } 
```

如果您觉得更容易，该代码也位于此处：http: [//samplesecurityapp.codeplex.com/SourceControl/changeset/view/24664#385932](http://samplesecurityapp.codeplex.com/SourceControl/changeset/view/24664#385932)

*跟进以下问题：*

@[理查德认为]

以下是您对查询的建议更改的结果。

```
exec sp_executesql N'SELECT 
[Project1].[C1] AS [C1], 
[Project1].[Id] AS [Id], 
[Project1].[AuthenticationId] AS [AuthenticationId], 
[Project1].[Name] AS [Name], 
[Project1].[C2] AS [C2], 
[Project1].[RoleId] AS [RoleId], 
[Project1].[UserId] AS [UserId]
FROM ( SELECT 
    [Limit1].[Id] AS [Id], 
    [Limit1].[AuthenticationId] AS [AuthenticationId], 
    [Limit1].[Name] AS [Name], 
    1 AS [C1], 
    [Extent2].[RoleId] AS [RoleId], 
    [Extent2].[UserId] AS [UserId], 
    CASE WHEN ([Extent2].[RoleId] IS NULL) THEN CAST(NULL AS int) ELSE 1 END AS [C2]
    FROM   (SELECT TOP (2) [Extent1].[Id] AS [Id], [Extent1].[AuthenticationId] AS [AuthenticationId], [Extent1].[Name] AS [Name]
        FROM [dbo].[Users] AS [Extent1]
        WHERE [Extent1].[Id] = @p__linq__0 ) AS [Limit1]
    LEFT OUTER JOIN [dbo].[RolesUsers] AS [Extent2] ON [Limit1].[Id] = [Extent2].[UserId]
)  AS [Project1]
ORDER BY [Project1].[Id] ASC, [Project1].[C2] ASC',N'@p__linq__0 uniqueidentifier',@p__linq__0='C0E7EB21-BB3D-424E-8EF0-48A6C9526410' 
```

虽然，我确实看到了此查询生成的 WHEN-THEN-ELSE，但它返回了不需要的其他列。有没有办法让 EF 只返回一个位字段，指示给定用户是否具有给定权限？我写的查询确实只返回一个字段，但我相信在错误的情况下，它会运行相同的查询两次。

我很好奇我是否可以生成更像这样的东西。它是这两种方法的混合，因为它只返回一个位字段，指示用户是否具有权限，并且它使用连接而不是大量的 WHERE EXISTS 语句

```
DECLARE @UserId UNIQUEIDENTIFIER
DECLARE @PermissionId UNIQUEIDENTIFIER

SET @UserId = '151b517b-051f-4040-b6c6-036dd06d661d';
SET @PermissionId = '2A379840-F44D-4D09-AAD5-2B34EDF1EDC9';

SELECT
CASE
    WHEN (
        EXISTS(
            SELECT p.Id
            FROM Permissions p
            INNER JOIN RolesPermissions rp
                ON p.Id = rp.PermissionId
            INNER JOIN Roles r
                ON rp.RoleId = r.id
            INNER JOIN RolesUsers ru
                ON r.id = ru.RoleId
            WHERE ru.UserId = @UserId AND p.Id = @PermissionId
        )
    ) THEN cast(1 AS BIT)
    ELSE CAST(0 AS BIT)
END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:55:49.190

您应该能够使用：

```
return user.RolesUsers
   .SelectMany(ru => ru.Role.RolesPermissions)
   .Any(up => up.PermissionId == permission.Id); 
```

由于您的`RoleUser`和`RolePermission`类是简单的多对多容器，因此我倾向于删除它们并建立直接的多对多关系：

```
public class Role : Base
{
   public virtual ICollection<Permission> Permissions { get; set; }
   public virtual ICollection<User> Users { get; set; }
}

public class User : Base
{
   public virtual ICollection<Role> Roles { get; set; }
   public string AuthenticationId { get; set; }
}

public class Permission : Base
{
   public virtual ICollection<Role> Roles { get; set; }
} 
```

您甚至不需要任何映射代码；公约应该为您做正确的事情。

# java - 循环 jar 参考 - 它可以编译吗？

> ID：15121245
> 
> 赞同：3
> 
> 时间：2013-02-27T20:00:26.703
> 
> 标签：java, jar, compilation, circular-reference

我在 Java 中看到了一些关于“循环 jar 引用”的问题，但我什么也没看到。

我的问题是：如何构建两个 jar，其中每个 jar 都有对另一个 jar 中的类的方法调用？似乎每个 jar 项目中的某些类都需要从另一个 jar 导入类，因此需要在构建的类路径中引用另一个 jar——但另一个 jar 由于相同而无法编译需要。

我可以理解将所有类编译为一个大项目，然后将类打包到具有相互依赖关系的单独 jar 中，但是由于需要在类路径中包含另一个 jar，因此似乎不可能单独编译每个 jar 的类。

与我相关的是，我将代码开发成一个 jar 以供另一个项目使用。但是，现在我需要使用来自其他项目的一些 api 调用。我认为这样做的唯一方法是将一些常用和独立的 api 类分离到第三个项目/jar 中，原始两个项目都可以包含在它们的类路径中。

对此是否有另一种看法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:07:49.270

他们不需要在编译时将彼此作为 jar 引用。只要在开发时配置类路径以反映这一点，它们就可以是相互引用的两个独立项目。

因此，您可以有一个用例场景：

```
Api1.Class11 references (or imports) Api2.Class21 
```

和

```
Api2.Class22 references Api1.Class12 
```

这是合法的，因为虽然在项目级别是循环引用，但在类级别却不是这样（想象一下，如果两个项目合并为一个并且您有这种情况）。

一旦捆绑到 jars 中，客户端应用程序就有责任使用它们将两者都包含在类路径中，以便它们在运行时可以以这种方式相互看到。

就个人而言，我认为这种做法令人困惑，但可以做到。为了清楚起见，我自己不会使用循环引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:18:59.503

大多数常见的构建工具不能处理循环依赖，但是只要两个 jar 之一至少有一个起始二进制版本，手动增量构建就没有理由不能包含循环依赖。

由于构建工具无法处理此类依赖关系，因此在实践中很少遇到这种依赖关系，并且大多数 Java 开发人员认为它是糟糕的设计。

# r - 在 R 中使用 lmer 函数更改截距

> ID：15121246
> 
> 赞同：2
> 
> 时间：2013-02-27T20:00:27.187
> 
> 标签：r, intercept, lmer

我正在尝试使用 lmer 函数来研究 3 种不同条件（cond=0、1、2）和目标的存在（target=False 或 True）之间的反应时间 (RT) 是否存在交互影响患者（患者）。

我写了以下等式：

```
lmer(RT~cond*target+(1|Patient)) 
```

我的问题是这个函数的默认截距是 cond = 0 和 target = False，而我希望截距是 cond= 0 和 target=True （以便查看 cond0*target= 之间是否存在显着差异真和 cond1*target=True)。

我将衷心感谢您的帮助。

这是我的输出

```
stu3<-lmer(RT~cond*target+(1|Patient), 
   data=subset(ss, Groupe=="ugs" & primeable ==TRUE     & 
          Correct==TRUE & NoPrac==TRUE))

pvals.fnc(stu3)

$fixed
                  Estimate MCMCmean HPD95lower HPD95upper  pMCMC Pr(>|t|)
(Intercept)         0.5511   0.5513     0.5258     0.5807 0.0001   0.0000
cond1               0.0618   0.0619     0.0498     0.0741 0.0001   0.0000
cond2               0.0285   0.0285     0.0142     0.0438 0.0002   0.0001
targetFALSE         0.1389   0.1389     0.1239     0.1549 0.0001   0.0000
cond1:targetFALSE  -0.0752  -0.0751    -0.0943    -0.0545 0.0001   0.0000
cond2:targetFALSE  -0.0788  -0.0786    -0.0998    -0.0564 0.0001   0.0000

$random
    Groups        Name Std.Dev. MCMCmedian MCMCmean HPD95lower HPD95upper
1  Patient (Intercept)   0.0610     0.0583   0.0599     0.0425     0.0797
2 Residual               0.1674     0.1674   0.1674     0.1650     0.1699 
```

根据我的数据，选择的截距是`cond0:targetTRUE`，输出中的其他级别是`cond1:targetFALSE`和`cond2:targetFALSE`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T13:18:46.403

如果我理解正确，您的模型已经在进行您希望在内部进行的解释`target==TRUE`。如果我是正确的，您可以将示例中的模型术语翻译如下：

```
"(Intercept)"       -> target==TRUE, cond==0 (even if model matrix contains all conds)
"cond1"             -> target==TRUE, cond==1 on top of cond==0
"cond2"             -> target==TRUE, cond==2 on top of cond==0
"targetFALSE"       -> target==FALSE, cond==0 (even if model matrix contains all conds)
"cond1:targetFALSE" -> target==FALSE, cond==1 on top of cond==0
"cond2:targetFALSE" -> target==FALSE, cond==2 on top of cond==0 
```

`"(Intercept)"`那么，不是用`"cond1"`和检测到有趣的差异`"cond2"`吗？查看固定效应的模型矩阵结构`getME(stu3,'X')`可能会有所帮助。

以下是我为测试您的案例而构建的示例数据。请注意，我构建了三种不同的响应：一种没有任何效果，一种只有`target==TRUE`效果，另一种有效果，以及与 的不同级别的`target==TRUE`交互效果。在和中检测到人为引入的效果：`target==TRUE``cond``fit1``fit2`

```
set.seed(0)
struct <- expand.grid(target = c(FALSE,TRUE), cond = as.factor(0:2), patient = LETTERS[1:20])
attach(struct)
ranpatient <- rep(rnorm(20), each=6)
rerror <- rnorm(120)
# Just random noise
response0 <- ranpatient + rerror
# When target==TRUE we increment the response by 1 and add errors
response1 <- 1*target + ranpatient + rerror
# When target==TRUE we increment the response by  1,
# to which we also add an interaction effect condition {0,1,2} * target {0,1}
# notice that numeric transformation of cond {0,1,2} transforms to ranks {1,2,3}
response2 <- 1*target + target*(as.numeric(cond)-1) + ranpatient + rerror

dat <- data.frame(cond, target, patient, response0, response1, response2)   
detach(struct)

require(lme4)
fit0 <- lmer(response0 ~ cond*target + (1|patient), data=dat)
fit1 <- lmer(response1 ~ cond*target + (1|patient), data=dat)
fit2 <- lmer(response2 ~ cond*target + (1|patient), data=dat)

head(dat)
round(coef(summary(fit0)),2) # Notice low t values
round(coef(summary(fit1)),2) # High t value for targetTRUE
round(coef(summary(fit2)),2) # High t value for interaction cond0/1/2 with targetTRUE
# Notice how cond==1 adds 1, and cond==2 adds 2 in comparison to cond==0 when targetTRUE
# Notice also that coefficient "cond2:targetTRUE" is incremental to term "targetTRUE", not "cond1:targetTRUE"
head(getME(fit2,'X')) # Columns correspond to the fixed effect terms 
```

随着输出

```
> head(dat)
  cond target patient response0 response1 response2
1    0  FALSE       A  1.038686  1.038686  1.038686
2    0   TRUE       A  1.640350  2.640350  2.640350
3    1  FALSE       A  1.396291  1.396291  1.396291
4    1   TRUE       A  2.067144  3.067144  4.067144
5    2  FALSE       A  1.205848  1.205848  1.205848
6    2   TRUE       A  1.766562  2.766562  4.766562
> round(coef(summary(fit0)),2) # Notice low t values
                 Estimate Std. Error t value
(Intercept)         -0.13       0.31   -0.40
cond1                0.18       0.29    0.62
cond2                0.00       0.29    0.00
targetTRUE           0.00       0.29   -0.01
cond1:targetTRUE     0.13       0.41    0.32
cond2:targetTRUE     0.08       0.41    0.19
> round(coef(summary(fit1)),2) # High t value for targetTRUE
                 Estimate Std. Error t value
(Intercept)         -0.13       0.31   -0.40
cond1                0.18       0.29    0.62
cond2                0.00       0.29    0.00
targetTRUE           1.00       0.29    3.42
cond1:targetTRUE     0.13       0.41    0.32
cond2:targetTRUE     0.08       0.41    0.19
> round(coef(summary(fit2)),2) # High t value for interaction cond0/1/2 with targetTRUE
                 Estimate Std. Error t value
(Intercept)         -0.13       0.31   -0.40
cond1                0.18       0.29    0.62
cond2                0.00       0.29    0.00
targetTRUE           1.00       0.29    3.42
cond1:targetTRUE     1.13       0.41    2.75
cond2:targetTRUE     2.08       0.41    5.04
> # Notice how cond==1 adds 1, and cond==2 adds 2 in comparison to cond==0 when targetTRUE
> # Notice also that coefficient "cond2:targetTRUE" is incremental to term "targetTRUE", not "cond1:targetTRUE"
> head(getME(fit2,'X')) # Columns correspond to the fixed effect terms
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    1    0    0    0    0    0
[2,]    1    0    0    1    0    0
[3,]    1    1    0    0    0    0
[4,]    1    1    0    1    1    0
[5,]    1    0    1    0    0    0
[6,]    1    0    1    1    0    1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:18:31.090

看看标准的“因素管理”是否有效：

```
target=factor(target, levels=c("TRUE", "FALSE")
lmer(RT~cond*target+(1|Patient)) 
```

（我会使用短语“改变参考水平”而不是“改变截距”，但我想这实际上是相同的过程。我怀疑“改变参考水平”这个短语会让你在 MarkMail Rhelp 上获得很少的点击或搜索。）

# ruby-on-rails - gem install json 失败，重新定义了 struct timezone/timespec

> ID：15121247
> 
> 赞同：8
> 
> 时间：2013-02-27T20:00:28.977
> 
> 标签：ruby-on-rails, ruby, json, compiler-errors, gem

我在 Windows 上使用带有 DevKit 的 Ruby 1.9.3（Win 7 64 位上的所有 32 位）。现在我尝试安装 rails，但从 bundle 中得到一个错误。如果我尝试运行（什么包抱怨）

```
 gem install json 
```

我收到以下错误消息：

```
D:\RubyTest>gem install json
Temporarily enhancing PATH to include DevKit...
Building native extensions.  This could take a while...
ERROR:  Error installing json:
        ERROR: Failed to build gem native extension.

        D:/Ruby193/bin/ruby.exe extconf.rb
creating Makefile

make
generating generator-i386-mingw32.def
compiling generator.c
In file included from d:/Ruby193/include/ruby-1.9.1/ruby/ruby.h:1381:0,
                 from d:/Ruby193/include/ruby-1.9.1/ruby.h:32,
                 from ../fbuffer/fbuffer.h:5,
                 from generator.c:1:
d:/Ruby193/include/ruby-1.9.1/ruby/missing.h:41:8: error: redefinition of 'struc
t timespec'
In file included from d:\ruby193\mingw\bin\../lib/gcc/i686-w64-mingw32/4.7.2/../
../../../i686-w64-mingw32/include/process.h:12:0,
                 from d:/Ruby193/include/ruby-1.9.1/ruby/win32.h:62,
                 from d:/Ruby193/include/ruby-1.9.1/ruby/defines.h:223,
                 from d:/Ruby193/include/ruby-1.9.1/ruby/ruby.h:67,
                 from d:/Ruby193/include/ruby-1.9.1/ruby.h:32,
                 from ../fbuffer/fbuffer.h:5,
                 from generator.c:1:
d:\ruby193\mingw\bin\../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-ming
w32/include/sys/types.h:89:8: note: originally defined here
In file included from d:/Ruby193/include/ruby-1.9.1/ruby/ruby.h:1381:0,
                 from d:/Ruby193/include/ruby-1.9.1/ruby.h:32,
                 from ../fbuffer/fbuffer.h:5,
                 from generator.c:1:
d:/Ruby193/include/ruby-1.9.1/ruby/missing.h:48:8: error: redefinition of 'struc
t timezone'
In file included from d:/Ruby193/include/ruby-1.9.1/ruby/win32.h:63:0,
                 from d:/Ruby193/include/ruby-1.9.1/ruby/defines.h:223,
                 from d:/Ruby193/include/ruby-1.9.1/ruby/ruby.h:67,
                 from d:/Ruby193/include/ruby-1.9.1/ruby.h:32,
                 from ../fbuffer/fbuffer.h:5,
                 from generator.c:1:
d:\ruby193\mingw\bin\../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-ming
w32/include/time.h:260:8: note: originally defined here
make: *** [generator.o] Error 1

Gem files will remain installed in D:/Ruby193/lib/ruby/gems/1.9.1/gems/json-1.7.
7 for inspection.
Results logged to D:/Ruby193/lib/ruby/gems/1.9.1/gems/json-1.7.7/ext/json/ext/ge
nerator/gem_make.out 
```

任何的想法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-27T21:46:14.440

Ruby 1.9.3 是用 GCC 4.5.2 编译的，这是 RubyInstaller[下载页面](http://rubyinstaller.org/downloads)`DevKit-tdm-32-4.5.2-20111229-1559-sfx.exe`提供的DevKit

您下载了**仅**与 Ruby 2.0.0 版本兼容的较新的 DevKit，如 RubyInstaller 公告中所示。

澄清：

*   红宝石 1.8.7：`tdm-32-4.5.2`
*   红宝石 1.9.2：`tdm-32-4.5.2`
*   红宝石 1.9.3：`tdm-32-4.5.2`
*   Ruby 2.0.0：（`mingw64-32-4.7.2`以及 64 位 Ruby 的 64 位版本）

我已经向 RubyInstaller 下载页面添加了关于此的说明。

希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-06T21:57:17.133

您可以打开您的 ruby​​ 版本的*包含目录中的“win32.h”。*

然后注释掉声明“clock_gettime”“clock_getres”函数的行。

# assembly - 在asm中推动程序的偏移量？

> ID：15121249
> 
> 赞同：0
> 
> 时间：2013-02-27T20:00:35.067
> 
> 标签：assembly, x86, reverse-engineering, ida

我正在尝试从可执行文件中获取加密方法。我已经打开包装并开始使用 IDA Pro 进行分析。

我遇到了一个我无法以任何方式理解的代码。以下是 asm 代码块。

```
___:00A11B6F 008                 mov     eax, [ebp+DecryptedBytes]
___:00A11B72 008                 push    eax
___:00A11B73 00C                 push    100h
___:00A11B78 010                 push    offset CI_StrCmp
___:00A11B7D 014                 mov     ecx, [ebp+LengthValueOfBytes]
___:00A11B80 014                 push    ecx
___:00A11B81 018                 mov     edx, [ebp+Bytes]
___:00A11B84 018                 add     edx, 4
___:00A11B87 018                 push    edx
___:00A11B88 01C                 call    rijndaelDecrypt 
```

这个伪代码是：

```
*(_DWORD *)DecryptResult = rijndaelDecrypt(Bytes + 4, LengthValueOfBytes, (int)CI_StrCmp, 0x100u, DecryptedBytes); 
```

CI_StrCmp 是一个不区分大小写的字符串比较函数。rijndaelDecrypt 函数读取此参数的 16 个字节。我认为这是一个关键。

以下是 rijndaelDecrypt 函数。

```
void *__cdecl rijndaelDecrypt(int Bytes, unsigned int Length, int Key, unsigned int BitSize, int a5)
{
  void *DecryptedBytes; // ebx@1
  void *result; // eax@5
  unsigned int v7; // [sp+Ch] [bp-118h]@2
  unsigned int v8; // [sp+10h] [bp-114h]@2
  unsigned int v9; // [sp+14h] [bp-110h]@2
  unsigned int v10; // [sp+18h] [bp-10Ch]@2
  char v11; // [sp+1Ch] [bp-108h]@1

  DecryptedBytes = malloc_2(Length);
  memset(&v11, 0, 0x108u);
  if ( (signed int)BitSize >= 16 )
  {
    v7 = *(_DWORD *)Key;
    v8 = *(_DWORD *)(Key + 4);
    v9 = *(_DWORD *)(Key + 8);
    v10 = *(_DWORD *)(Key + 12);
  }
  else
  {
    v7 = 0x12121212u;
    v8 = 0x12121212u;
    v9 = 0x12121212u;
    v10 = 0x12121212u;
    memcpy(&v7, (const void *)Key, BitSize);
  }
  if ( rijndaelSetupDecrypt((int)&v7, 16, (int)&v11) == 1 )
  {
    sub_A125B0(Bytes, Length, DecryptedBytes, (int)&v11, a5);
    result = DecryptedBytes;
  }
  else
  {
    result = 0;
  }
  return result;
} 
```

我的问题是将一个程序的偏移量发送到另一个程序的含义是什么。对我来说完全是无稽之谈。

ps对不起我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:38:40.487

如果您的意思是“发送过程的偏移量”，则表示此语句`push offset CI_StrCmp`

它将 StrCmp 函数的地址传递给 Decrypt 例程，以便 Decrypt 可以调用它。

我猜 Decrypt 的函数原型是这样的......

```
DWORD rijndaelDecrypt (const void *pData, size_t SizeOfData, int CmpFuncAddress, int Value, DWORD *pDecryptCount); 
```

更正确的应该是这样的......

```
typedef int COMPARE_FUNCTION (const char *, const char *);
DWORD rijndaelDecrypt (const void *pData, size_t SizeOfData, COMPARE_FUNCTION *, int Value, DWORD *pDecryptCount); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:53:13.350

好的，我明白了......他们使用`CL_StrCmp`（1）的实际代码作为密钥（2）进行解密。代码受版权保护，因此为了在您自己的程序中解密数据，您必须包含他们的代码`CL_StrCmp`，因此您侵犯了他们的版权 - IE 违法。

(1) 函数的实际编译指令。

(2) 考虑公钥\私钥。

# clojure - 在clojure中计算向量中的唯一值

> ID：15121251
> 
> 赞同：3
> 
> 时间：2013-02-27T20:00:43.270
> 
> 标签：clojure

我想知道是否有人可以帮助我理解如何在 clojure 中执行以下代码：

```
int[] secondArray = new int[500];

for (int i = 0; i < firstArray.length; i++) 
{
  secondArray[firstArray[i]] += 1;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T20:41:21.267

您可能可以使用该[`frequencies`](http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/frequencies)功能：

```
user=> (frequencies [:foo :bar :baz :foo :foo])
{:foo 3, :bar 1, :baz 1} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T22:01:28.287

让我们通过一个相当直接的翻译，我们将输入向量视为一个序列，然后将其简化为所需的结果：

首先定义一些包含我们起始状态的不可变向量：

```
boo> (def firstVector (vec (take 30 (repeatedly #(rand-int 10)))))
#'boo/firstVector
boo> firstVector 
[9 0 4 5 0 7 3 9 0 0 6 6 5 5 9 4 0 1 3 6 4 9 5 8 8 3 4 6 7 6]
boo> (def secondVector (vec (take 10 (repeat 0))))
#'boo/secondVector
boo> secondVector
[0 0 0 0 0 0 0 0 0 0] 
```

然后我们想要一个表达式，它`inc`是第二个数组中的适当元素

```
boo> (assoc secondVector 4 (inc (secondVector 4)))
[0 0 0 0 1 0 0 0 0 0] 
```

然后我们希望将结果传递给 firstVector 中的第一个元素，然后将结果传递给 firstVector 中的第二个元素，依此类推。该`reduce`函数执行此操作：

```
boo> (reduce #(assoc %1 %2 (inc (%1 %2))) secondVector firstVector)
[5 1 0 3 4 4 5 2 2 4] 
```

在 reducer 函数中，%1（第一个参数）是当前的累加结果，%2（第二个参数）是输入序列（firstVector）的当前值。

# gwt - 将 gwt 生成的 jar 替换为较新的版本

> ID：15121253
> 
> 赞同：0
> 
> 时间：2013-02-27T20:00:54.463
> 
> 标签：gwt, patch, gxt

我开发了一个基于 GWT+GXT 的 Web 应用程序。最近我们遇到了一个我能够轻松解决的问题。

但是，当我从标签生成 jar 文件时，包括修复的 backport，即使我用新的 jar 替换旧的 jar，修复也没有效果。

另一方面，如果我生成整个 WAR，一切正常，但由于它的大小，我希望能够将补丁作为 jar 文件提供。

我错过了什么吗？

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T21:30:51.707

该`jar`文件仅包含 Java 源代码和已编译的 Java - 当您编译 GWT 时，它会生成 JavaScript。`war`除了所有其他内容之外，这就是文件包含的内容。为了正确更新您的应用程序，您需要更新已编译的 JavaScript。

正如您所注意到的，最简单的方法是替换整个war 文件。如果您想将更改保持在最低限度，您可以尝试仅替换已编译的 JS 目录和 jar 文件，但您需要小心获取正确的目录 - 以及所有内容。

# ruby-on-rails - YouTube API：从 Ruby 中删除视频 HTTP 请求不起作用

> ID：15121256
> 
> 赞同：1
> 
> 时间：2013-02-27T20:01:07.093
> 
> 标签：ruby-on-rails, youtube-api, net-http

我正在尝试从 Ruby on Rails 应用程序中删除 YouTube 上的视频。我正在按照[YouTube API 文档中的](https://developers.google.com/youtube/2.0/developers_guide_protocol_updating_and_deleting_videos#Deleting_a_video)这些说明进行操作：

```
DELETE /feeds/api/users/default/uploads/VIDEO_ID HTTP/1.1
Host: gdata.youtube.com
Content-Type: application/atom+xml
Authorization: Bearer ACCESS_TOKEN
GData-Version: 2
X-GData-Key: key=DEVELOPER_KEY 
```

我对 Ruby 的`Net::HTTP`课程不是很熟悉，但似乎无论我尝试什么，我都无法让请求正常工作。我已经仔细查看了有关从 YouTube 删除视频的许多其他 StackOverflow 问题，但我找不到解决这个特定问题的方法。我的代码如下，我已经替换了用户名、视频 ID、访问令牌和开发人员密钥。

```
url = URI.parse("https://gdata.youtube.com/feeds/api/users/[USER_NAME]/uploads/[VIDEO_ID]")
post_args = { 'Host' => 'gdata.youtube.com', 'GData-Version' => '2', 'Content-Type' => 'application/atom+xml', 'Authorization' => "Bearer [ACCESS_TOKEN]", 'X-GData-Key' => 'key=[DEVELOPER_KEY]' }
req = Net::HTTP::Delete.new(url.path)
req.set_form_data(post_args)

httpreq = Net::HTTP.new(url.host, url.port)
httpreq.use_ssl = true

resp = httpreq.start {|http| http.request(req) } 
```

检查响应，我收到来自 YouTube 的错误 400（错误请求）。响应只是说“您的客户发出了格式错误或非法的请求。这就是我们所知道的”。

我提出的要求有问题吗？我已经一次又一次地对照模板检查它，我看不出它有什么问题。我知道我的访问令牌和开发人员密钥正在工作，因为我可以提出其他请求，例如视频上传。

我打印了 HTTP 请求的调试输出，据我所知，它看起来不错：

```
<- "DELETE /feeds/api/users/[USER_NAME]/uploads/[VIDEO_ID] HTTP/1.1\r\nAccept: */*\r\nUser-Agent: Ruby\r\nContent-Type: application/x-www-form-urlencoded\r\nHost: gdata.youtube.com\r\nContent-Length: 275\r\n\r\n"
<- "Host=gdata.youtube.com&GData-Version=2&Content-Type=application%2Fatom%2Bxml&Authorization=Bearer+[ACCESS_TOKEN]&X-GData-Key=key%3D[DEVELOPER_KEY]" 
```

我唯一能看到的可能问题是，在请求的第一行中，“Content-Type”设置为“application/x-www-form-urlencoded”。同样，我不是 HTTP 请求方面的专家，我不确定第一行中设置的 Content-Type 与我明确设置为“application/atom+xml”的 Content-Type 之间有什么区别，后者出现在第二行请求的行。但是，经过一番挖掘，我发现该`set_form_data`方法会自动将内容类型设置为“application/x-www-form-urlencoded”，因此我尝试在代码中添加以下行：

```
req.content_type = 'application/atom+xml' 
```

就在这条线之后

```
req.set_form_data(post_args) 
```

当我这样做时，我确实在请求中看到了相应的变化：

```
<- "DELETE /feeds/api/users/[USER_ID]/uploads/[VIDEO_ID] HTTP/1.1\r\nAccept: */*\r\nUser-Agent: Ruby\r\nContent-Type: application/atom+xml\r\nHost: gdata.youtube.com\r\nContent-Length: 275\r\n\r\n"
<- "Host=gdata.youtube.com&GData-Version=2&Content-Type=application%2Fatom%2Bxml&Authorization=Bearer+[ACCESS_TOKEN]&X-GData-Key=key%3D[DEVELOPER_KEY]" 
```

但是，我仍然从 YouTube 得到完全相同的回复。错误 400，错误的请求。这到底是怎么回事？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:28:11.620

当然，问了我的问题10分钟后，我就找到了答案。我不理解 HTTP 标头字段和表单参数之间的区别，我对此并不感到难过，因为在 Ruby 文档`Net::HTTP`或 YouTube API 中的任何地方都没有解释它。我感到困惑的原因是因为上传视频，您可以提供所有值，如 Authorization 和 Content-Type 作为表单数据，所以我的问题中的上述方法工作正常。要删除视频，您必须提供这些值作为标题的一部分，而不是表单数据。至少，这是我现在的理解。

无论如何，万一有人遇到这个问题，这为我解决了它：

```
req = Net::HTTP::Delete.new(url.path)
req['GData-Version'] = '2'       # this syntax sets header fields & values
req['Authorization'] = "..."
req['X-GData-Key'] = "..."

req.content_type = 'application/atom+xml'

httpreq = Net::HTTP.new(url.host, url.port)
httpreq.use_ssl = true

resp = httpreq.start {|http| http.request(req) } 
```

另一种情况是，文档作者的一个解释性句子可以节省两个小时的浪费时间。如果我有一个镍...

# .net - StringBuilder ToString 注入 \n\r

> ID：15121259
> 
> 赞同：2
> 
> 时间：2013-02-27T20:01:14.363
> 
> 标签：.net, newline, stringbuilder

当我执行这个 .Net 代码时：

```
 var builder = new StringBuilder();
   builder.AppendLine("Line One");
   builder.AppendLine("Line Two");
   var result = builder.ToString(); 
```

result 的值字面意思是：

```
"Line One\r\nLine Two\r\n" 
```

为什么 .ToString() 将换行符转换为 "\r\n" 文本，有没有办法防止这种情况并让字符串实际上具有真实的（隐藏的）换行符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:07:16.670

在调试器中，它显示“转义字符”，即回车换行符标准 windows eol 字符串。如果您要将其打印出来以说明命令行或文件。您将获得一条实际的新线路。在 c# 中，所有转义字符都以 '\' 开头。所以 \r\n，\r 是回车，\n 是换行或换行。 [http://en.wikipedia.org/wiki/Newline](http://en.wikipedia.org/wiki/Newline)

还要在 c# 中正确编码

```
 StringBuilder builder = new StringBuilder();
   builder.AppendLine("Line One");
   builder.AppendLine("Line Two");
   String result = builder.ToString(); 
```

这也是写同一件事的另一种方式

```
String result = "Line One\r\nLine Two\r\n"; 
```

# javascript - 使用 AngularJS ngResponse 从 API 迭代 JSON 响应

> ID：15121261
> 
> 赞同：1
> 
> 时间：2013-02-27T20:01:20.760
> 
> 标签：javascript, json, api, angularjs

我正在使用 AngularJS 迈出第一步，调用一个 API，该 API 将返回一个带有我需要的数据的 JSON 对象。我调用 API 并获取响应并将其打印在 HTML 上，并根据需要进行迭代。

但是我还没有在实际的 Javascript 文件上找到一种方法，可以迭代让我们说，对项目进行分组和求和，或者将 JSON 的实际值打印到控制台。

**应用程序.js**

```
 angular.module('dashboard', ['ngResource']);
    function DashboardCtrl($scope, $resource) {
        $scope.dailyReports = $resource('http://myurl.com/app_dev.php/:action',
            {action:'dailyreports', appid:'@appid', begindate:'@begindate', enddate:'@enddate'});

    $scope.loadData = function() {
            $scope.dailyreportsResults = $scope.dailyReports.get({appid:$('#sel-apps').val(), begindate:$('#fecha-inicial').val(), enddate:$('#fecha-final').val()});
//it works!!!!
        };

$scope.iterate = function() {

            for (i=0; i < $scope.dailyreportsResults.data.length; i++){
                    $scope.periodUnits += $scope.dailyreportsResults.data[i].units;
                    console.log($scope.periodUnits);
                    //It doesnt work :(

            }
    }; 
```

**索引.html**

```
ng-repeat="data in dailyreportsResults.data"
   {{data.countryName}}
   {{data.units}} 
```

我究竟做错了什么？

多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T22:20:28.517

我不确定您的数据是什么样的，但也许您应该使用“for in”而不是递增数组。

```
$scope.iterate = function() {
  for (x in $scope.dailyreportsResults.data){
    $scope.periodUnits += $scope.dailyreportsResults.data[x].units;
    console.log($scope.periodUnits);
  }
}; 
```

另外，我认为您的 ng-repeat 应该附加到一个元素。

```
<div ng-repeat="data in dailyreportsResults.data">
   {{data.countryName}}
   {{data.units}}
</div> 
```

# ruby-on-rails - 使用 Rails/Devise 的附加认证视图集

> ID：15121263
> 
> 赞同：0
> 
> 时间：2013-02-27T20:01:32.683
> 
> 标签：ruby-on-rails, authentication, devise

我有一个使用 Devise（和 Omniauth）进行身份验证的 Ruby on Rails 应用程序。

我正在尝试与想要从我的应用程序嵌入页面的 iOS 应用程序（不受我控制）集成。这个应用程序需要我的页面具有特定的视觉外观，因此我想创建一组额外的身份验证视图。

在设计文档中挖掘之后，我收集到可能我需要在以下位置创建一个新`devise_scope`块`routes.rb`：

```
devise_scope :user do
    get    "iosapp/users/sign_in"  => "devise/sessions#iosapp_new"
    post   "iosapp/users/sign_in"  => "devise/sessions#iosapp_create"
    delete "iosapp/users/sign_out" => "devise/sessions#iosapp_destroy"
end 
```

我创建了一组与这些路由相对应的新视图：

```
app/views/devise/sessions/iosapp_new.html.rb
app/views/devise/sessions/iosapp_create.html.rb
app/views/devise/sessions/iosapp_destroy.html.rb 
```

但是在浏览器中加载**/iosapp/users/sign_in**会导致 Rails 错误：

```
undefined method `errors' for nil:NilClass 
```

该错误源于 devise_helper.rb 的第 9 行（[https://github.com/plataformatec/devise/blob/master/app/helpers/devise_helper.rb](https://github.com/plataformatec/devise/blob/master/app/helpers/devise_helper.rb)）：

```
module DeviseHelper
  # A simple way to show error messages for the current devise resource. If you need
  # to customize this method, you can either overwrite it in your application helpers or
  # copy the views to your application.
  #
  # This method is intended to stay simple and it is unlikely that we are going to change
  # it to add more behavior or options.
  def devise_error_messages!
    return "" if resource.errors.empty?

    messages = resource.errors.full_messages.map { |msg| content_tag(:li, msg) }.join
    ... 
```

我显然在这里做错了什么，但无法弄清楚为什么`resource`从我的“备用”视图调用时未定义。似乎我可能还需要创建其他控制器方法，但我在文档中找不到任何关于此的内容。

我偏离轨道了吗？或者有没有比这更好的方法来实现我的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:43:11.857

你的新观点需要`form_for resource`——你有吗？如果没有资源，它无法找到资源上的错误，因此 nil 上的错误。

# css - CSS Dropdown 删除文本换行

> ID：15121264
> 
> 赞同：0
> 
> 时间：2013-02-27T20:01:34.980
> 
> 标签：css, drop-down-menu

如何删除下拉列表中子元素的文本换行？

JSFiddle 与 CSS 在这里：http: [//jsfiddle.net/6Bqfn/4/](http://jsfiddle.net/6Bqfn/4/)

```
<ul>
 <li><a href="#">Home</a></li>
 <li><a href="#">Shop</a>
 <ul class="children">
    <li><a href="#">Longer Title</a></li>
    <li><a href="#">Short</a></li>
    <li><a href="#">Short</a></li>
 </ul>
 </li>
</ul> 
```

我无法让持有子元素的 ul 调整为最大子 li 的大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:06:18.147

您需要`white-space:nowrap;`在您的 css 中包含您不想包装的项目：

```
ul.children li {
    white-space:nowrap;
} 
```

这将强制所有项目显示在一行上，并且由于所有宽度都设置为自动，它会相应地扩展。我也更新了你的 jsFiddle。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:04:53.827

你可以尝试嵌入一个不间断的空间......

```
<a href="#">Longer&nbsp;Title</a> 
```

# django - Django REST：在 URL 中支持嵌套集合的推荐方法是什么，例如 /users/5/snippets/

> ID：15121265
> 
> 赞同：3
> 
> 时间：2013-02-27T20:01:39.463
> 
> 标签：django, django-rest-framework

Django REST Framework[演示应用程序](http://restframework.herokuapp.com/)公开了两个集合，[/users/](http://restframework.herokuapp.com/users/)和[/snippets/](http://restframework.herokuapp.com/snippets/)。

在我的应用程序中，我希望能够嵌套这些集合，例如为用户 5 加载片段，我会请求[/users/5/snippets/](http://restframework.herokuapp.com/users/5/snippets/)

在 Django REST Framework 中可以进行这种配置吗？我将如何进行设置？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T21:02:02.243

```
url(r'^/sessions/(?P<session_pk>\d+)/speakers/$', views.SpeakerBySessionList.as_view()),

class SpeakerBySessionList(generics.ListCreateAPIView):
    model = Speaker
    serializer_class = serializers.SpeakerSerializer

    def get_queryset(self):
        session_pk = self.kwargs.get('session_pk', None)
        if session_pk is not None:
            return Speaker.objects.filter(session__pk=session_pk)
        return []

class Session(models.Model):
    name = models.CharField(max_length=150)

class Speaker(models.Model):
    name = models.CharField(max_length=100)
    session = models.ForeignKey(Session, related_name='speakers') 
```

如果您想查看更复杂的 django / ember 示例，请务必查看我的 github 项目

[https://github.com/toranb/complex-ember-data-example](https://github.com/toranb/complex-ember-data-example)

# python - 无效的块标签：'keywords_for_order'，预期为'endblock'

> ID：15121266
> 
> 赞同：2
> 
> 时间：2013-02-27T20:01:42.117
> 
> 标签：python, django, mezzanine

抱歉，我在这里束手无策。我有这个代码在本地工作，但是由于某种原因，当我尝试运行这个标签时，我在服务器上遇到了一个错误，我不知道为什么。这是模板代码：

```
{% load blog_tags keyword_tags i18n future %}

{% block blog_keywords %}
{% keywords_for_order blog.blogpost as tags %}
{% if tags %}
<h3>{% trans "Tags" %}</h3>
<ul class="unstyled tags">
{% for tag in tags %}
<li>
    <a href="{% url "blog_post_list_tag" tag.slug %}"
        class="tag-weight-1">{{ tag }}</a>
    ({{ tag.item_count }})
</li>
{% endfor %}
</ul>
{% endif %}
{% endblock %} 
```

这是keyword_tags.py文件：

```
from django.contrib.contenttypes.models import ContentType
from django.db.models import Model, Count

from mezzanine import template
from mezzanine.conf import settings
from mezzanine.generic.fields import KeywordsField
from mezzanine.generic.models import AssignedKeyword, Keyword

register = template.Library()

@register.as_tag
def keywords_for(*args):
    """
    Return a list of ``Keyword`` objects for the given model instance
    or a model class. In the case of a model class, retrieve all
    keywords for all instances of the model and apply a ``weight``
    attribute that can be used to create a tag cloud.
    """

    # Handle a model instance.
    if isinstance(args[0], Model):
        obj = args[0]
        if hasattr(obj, "get_content_model"):
            obj = obj.get_content_model() or obj
        # There can only be one ``KeywordsField``, find it.
        for field in obj._meta.many_to_many:
            if isinstance(field, KeywordsField):
                break
        else:
            return []
        keywords_manager = getattr(obj, field.name)
        return [a.keyword for a in keywords_manager.select_related("keyword")]

    # Handle a model class.
    try:
        app_label, model = args[0].split(".", 1)
    except ValueError:
        return []

    content_type = ContentType.objects.get(app_label=app_label, model=model)
    assigned = AssignedKeyword.objects.filter(content_type=content_type)
    keywords = Keyword.objects.filter(assignments__in=assigned)
    keywords = keywords.annotate(item_count=Count("assignments"))
    if not keywords:
        return []
    settings.use_editable()
    counts = [keyword.item_count for keyword in keywords]
    min_count, max_count = min(counts), max(counts)
    sizes = settings.TAG_CLOUD_SIZES
    step = (max_count - min_count) / (sizes - 1)
    if step == 0:
        steps = [sizes / 2]
    else:
        steps = range(min_count, max_count, step)[:sizes]
    for keyword in keywords:
        c = keyword.item_count
        diff = min([(abs(s - c), (s - c)) for s in steps])[1]
        keyword.weight = steps.index(c + diff) + 1
    return keywords

@register.as_tag
def keywords_for_order(*args):

    # Handle a model instance.
    if isinstance(args[0], Model):
        obj = args[0]
        if hasattr(obj, "get_content_model"):
            obj = obj.get_content_model() or obj
        # There can only be one ``KeywordsField``, find it.
        for field in obj._meta.many_to_many:
            if isinstance(field, KeywordsField):
                break
        else:
            return []
        keywords_manager = getattr(obj, field.name)
        return [a.keyword for a in keywords_manager.select_related("keyword")]

    # Handle a model class.
    try:
        app_label, model = args[0].split(".", 1)
    except ValueError:
        return []

    content_type = ContentType.objects.get(app_label=app_label, model=model)
    assigned = AssignedKeyword.objects.filter(content_type=content_type)
    keywords = Keyword.objects.filter(assignments__in=assigned)
    keywords = keywords.annotate(item_count=Count("assignments")).order_by('-item_count')[:2]
    if not keywords:
        return []

    return keywords 
```

这是我得到的错误：

```
Error during template rendering

In template /home/USERNAME/webapps/lion_dev/lion/roar/templates/blog/includes/tagcloud_panel.html, error at line 4
Invalid block tag: 'keywords_for_order', expected 'endblock'

1   {% load blog_tags keyword_tags i18n future %}
2   
3   {% block blog_keywords %}
4   {% keywords_for_order blog.blogpost as tags %}
5   {% if tags %}
6   <h3>{% trans "Tags" %}</h3>
7   <ul class="unstyled tags">
8   {% for tag in tags %}
9   <li>
10      <a href="{% url "blog_post_list_tag" tag.slug %}"
11          class="tag-weight-1">{{ tag }}</a>
12      ({{ tag.item_count }})
13  </li>
14  {% endfor %} 
```

所以是的，我不知道为什么没有看到这个模板标签文件。它也有一个**init** .py 文件，所以不是那样的。最好的，感谢您的帮助，

杰克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:08:31.457

您是直接在 Mezzanine 中编辑 keyword_tags.py 文件吗？

您不应该这样做 - 因此，如果您做了正确的事情并以某种方式将其复制到您的项目或应用程序中，则很有可能正在加载夹层版本，而不是您的版本。试着给它一个不同的名字，这样它们就不会发生冲突。

# ruby-on-rails - 如何重定向以创建另一个控制器的操作

> ID：15121269
> 
> 赞同：1
> 
> 时间：2013-02-27T20:01:54.300
> 
> 标签：ruby-on-rails, redirect, omniauth

我知道我无法在 HTML 重定向上发布，但我的情况要求我在验证用户身份后重定向以创建操作。我想知道如何绕过这个限制：

特别是，我希望允许用户在不使用 Omniauth 登录的情况下填写帖子。我使用 AJAX 调用将帖子保存到 session[:post] 。然后，用户可以使用omniauth 登录并保留帖子。

我有一个带有创建操作的 PostsController 来处理初始 ajax 调用，并在验证用户后处理 html 请求：

```
 def create    
    @post = Post.new(params[:post])   
    respond_to do |format|    
      format.html{
        if @post.save
          redirect_to @post, notice: 'Post was successfully created.'
        else
          render action: "new"
        end
      }
      format.json {
        if session[:post] = @post
          render json: @post, status: :created, location: @post
        else
          render json: @post.errors, status: :unprocessable_entity
        end
      }
    end
  end
end 
```

然后，在处理来自 Facebook 的回调的控制器中，我有：

```
class ServicesController < ApplicationController
  def create
    ... authentication logic here ...
    sign_in(:user, service.user)
    redirect_to :controller => "posts", :action =>"create"
  end
  method_alias: :facebook, :create 
```

但是，这不起作用，因为我无法重定向到“创建”操作。我怎样才能完成这项任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:53:08.463

您可以在 Post 模型上创建一个方法并从 PostsController 和 ServicesController 调用它来保存帖子（尽管在这种情况下它非常简单：新建，然后保存，因此您在 DRY 方面一无所获，可能是一些封装好处） . 或者创建一个包含所有逻辑的 create_post 方法的通用 mixin。然后将其包含在 SessionsController 和 PostsController 中，并从“create”中调用它。

在混合模块中：

```
def create_post(allow_json=false)
  @post = Post.new(params[:post])   
  respond_to do |format|    
    format.html {
      if @post.save
        redirect_to @post, notice: 'Post was successfully created.'
      else
        render "posts/new"
      end
    }
    if allow_json
      ... your post-saving & json-processing logic ...
    end
  end
end 
```

在 PostsController 中：

```
def create
  create_post(true)
end 
```

在 SessionsController 中：

```
def create
  ... authentication logic here ...
  sign_in(:user, service.user)
  create_post(false)
end 
```

我没有编译和尝试，所以我只希望它有效。总的来说，我必须说基本上是错误的，所以我会寻找其他架构解决方案来达到相同的结果，但作为一种快速而简单的方法，它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T21:28:54.627

我发现了一个避免此问题的技巧：我让#create 处理 AJAX 调用并写入会话，然后在用户通过身份验证后创建另一个操作以将其持久保存到我的数据库中：

```
class PostsController < ApplicationController

  def create  
    @post = Post.new(params[:post])    
    respond_to do |format|
      format.json {
        if session[:post] = @post
          render json: @post, status: :created, location: @post
        else
          render json: @post.errors, status: :unprocessable_entity
        end
      }
    end
  end

  def persist
    @post = session[:post]
    if @post.save
       session.delete :post
       redirect_to @post, notice: 'Post was successfully created.'
     else
       render action: "new"
     end
  end 
```

然后在我的 routes.rb 中，我有：

```
 resources :posts do
    collection do
      get 'persist'
    end
  end 
```

最后，在我的 ServicesController 中：

```
sign_in(:user, service.user) 
redirect_to persist_posts_path 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:45:33.310

在您发布的代码中，您从未阅读过会话的内容。我认为如果您使用以下代码更改代码，它可以工作：

更改初始化`@post`：

```
@post = Post.new(params[:post]) || session[:post]  # Find object in session if not 
```

并在之后添加`post.save`：

```
session.delete :post   # clean session after successful creation 
```

新的完整方法：

```
 def create    
    @post = Post.new(params[:post]) || session[:post]  # Find object in session if not in params  
    respond_to do |format|    
      format.html{
        if @post.save
          redirect_to @post, notice: 'Post was successfully created.'
          session.delete :post   # clean session after successful creation
        else
          render action: "new"
        end
      }
      format.json {
        if session[:post] = @post
          render json: @post, status: :created, location: @post
        else
          render json: @post.errors, status: :unprocessable_entity
        end
      }
    end
  end
end 
```

# azure - MVC WebAPI 主动认证

> ID：15121270
> 
> 赞同：1
> 
> 时间：2013-02-27T20:01:55.723
> 
> 标签：azure, asp.net-web-api, wif

我正在编写多个客户端应用程序（iPhone/android/windows 手机），它们将调用 Azure ACS 安全的 mvc webapi 控制器（对不起，首字母缩略词汤）。

使用 WIF（嗯，.net 4.5）保护 webapi 很简单，我可以被动登录而不会出现问题。

我还创建了一个 POC iPhone 应用程序，该应用程序使用 Web 浏览器让用户针对 azure AD IP 进行身份验证，然后使用[此处](http://www.stevesaxon.me/posts/2011/window-external-notify-in-ios-uiwebview/)的指南我可以获得一个 javascript 令牌。

现在我想下一步是在 Web 控制器上使用[JSON Web Token Handler](https://nuget.org/packages/Microsoft.IdentityModel.Tokens.JWT)，我应该能够很好地提取数据。

但是，我可以将令牌存储多长时间？我应该尝试使用 webapi 端点，如果它被拒绝，让用户重新进行身份验证，还是无论如何设置令牌使其永不过期，或者几个月后过期？

谢谢

罗斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T07:54:52.107

AFAIK，ACS 将 JWT 令牌的生命周期限制为 24 小时（这不是 JWT 约束 - 它是 ACS 约束）；之后你必须更新它。长时间存储安全令牌通常不是一个好主意，因为用户可能被停用或她的声明可能已更改。通过查看安全令牌的“exp”成员，您可以知道令牌何时过期。您将从 ACS 收到的安全令牌是 BASE64 编码的。如果有 2 到 3 个由点分隔的部分。如果您解码令牌，则令牌的第二部分将为您提供“exp”成员。Microsoft 在 [https://github.com/WindowsAzure-Toolkits/wa-toolkit-ios](https://github.com/WindowsAzure-Toolkits/wa-toolkit-ios)提供了适用于 ios 的工具包。（也存在用于 android 等的工具包）。

# javascript - 使用 javascript、html5 和 css3 创建瓷砖导航的 3d 旋转鼠标跟踪墙

> ID：15121273
> 
> 赞同：-2
> 
> 时间：2013-02-27T20:02:19.413
> 
> 标签：javascript, jquery, css, html, 3d

我一直在搜索，但我在网上找不到任何东西，但我有兴趣创建（或使用已经可用的东西，希望因为我时间紧迫）类似于这个网站： [http://www。雪铁龙.hr/citroen/#/雪铁龙/](http://www.citroen.hr/citroen/#/citroen/)

它也类似于 Safari Top Sites 视图，但增加了鼠标跟踪和 3d 旋转。

有谁知道用 javascript/html/css 创建的类似东西，或者可以指出我正确的方向？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-16T03:36:28.793

带有 HTML 元素、CSS 3D 转换的基本版本（因此[*它仅适用于支持 3D 转换和嵌套 3D 转换元素的浏览器 - 这意味着没有 Opera 和 IE*](http://caniuse.com/#feat=transforms3d)）和一点用于鼠标跟踪的 JavaScript：

# [*演示*](http://codepen.io/thebabydino/pen/LpcqD)

**HTML**：

```
<ul class='tiles'>
  <li class='tile'></li>
  <!-- more tiles; I used 16 for the demo and put them on an icosagon -->
</ul>
<div class='slider'></div> 
```

相关**CSS**：

```
.tiles {
  position: absolute;
  top: 50%; left: 50%;
  padding: 0;
  width: 0; height: 0;
  list-style: none;
  transform-style: preserve-3d;
  transform: rotateY(-162deg);
}    
.tile {
  position: absolute;
  left: 50%;
  margin: 0.5em -10em;
  width: 20em; height: 20em;
  backface-visibility: hidden;
  opacity: 0.5;
  /* inradius of an icosagon */
  cursor: pointer;
  transition: 0.5s;
}
.tile:hover { opacity: 1; }
.tile:nth-child(odd) { bottom: 100%; }
.tile:nth-child(2), .tile:nth-child(1) {
  transform: rotateY(18deg) translateZ(-66.29439em);
}
/* and so on... in general, something of the form: 
.tile:nth-child(2*i), .tile:nth-child(2*i-1) {
  transform: rotateY(1*18deg) translateZ(-66.29439em);
}
where 18deg = outer angle of the icosagon 
66.29439em = 1.05*20em*(1 + sqrt(5) + sqrt(5 + 2*sqrt(5)))/2 
           = 1.05 * inradius of icosagon
see http://mathworld.wolfram.com/Icosagon.html */
.tile:nth-child(1) {
  background: url(image1.jpg);
  background-size: cover;
}
/* and so on, set backgrounds for each */
.slider {
  position: absolute;
  bottom: 5%; left: 10%;
  height: 0.25em; width: 80%;
  opacity: 0.5;
  background: grey 
    linear-gradient(90deg, crimson 100%, transparent 100%) no-repeat;
  background-size: 5% 100%;
} 
```

**JavaScript**：

```
(function(){
  var b = document.body;

  b.addEventListener('mousemove', function(e) {
    var w = b.clientWidth, x = e.clientX, 
        perc = x/w, 
        full_angle = -162, 
        to_angle = full_angle + (100 - perc)*full_angle, 
        txt = 'rotateY(' + to_angle + 'deg)', 
        prefixes = ['Webkit', 'Moz', /*'ms', 'O', */''], 
        len = prefixes.length, 
        property = 'Transform',
        a = document.querySelector('.tiles'), 
        s = document.querySelector('.slider');
    for(var i = 0; i < len; i++) {
      if(prefixes[i] == '')
        property = property.toLowerCase();
      a.style[prefixes[i] + property] = txt;
    }
    s.style.backgroundPosition = (perc*100 - .5) + '% 50%';
  }, false);
}()); 
```

# css - CSS对齐元素

> ID：15121279
> 
> 赞同：0
> 
> 时间：2013-02-27T20:02:44.953
> 
> 标签：css

我讨厌 CSS，因为总是很难预测它会渲染成什么。大家能帮我解决这个问题吗...

我需要下拉菜单中元素的右侧在箭头下方对齐。首先我想如果我这样做`position:absolute`，然后只是移动`left`到像素数，它会起作用，但如果用户名改变它会再次破坏一切

这是为您提供方便的小提琴

[http://jsfiddle.net/Mwd2A/1/](http://jsfiddle.net/Mwd2A/1/)

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:16:26.093

如果我理解正确，您希望在悬停箭头时，该子菜单与箭头右对齐。

如果是这样：
将 css 属性添加到 .userSubmenu

```
position: relative; 
```

添加css属性到.userSubmenu ul

```
position: absolute;
right: 0; 
```

JSFiddle：http: [//jsfiddle.net/Mwd2A/5/](http://jsfiddle.net/Mwd2A/5/)

# android - 在安卓应用程序中登录 Facebook

> ID：15121288
> 
> 赞同：2
> 
> 时间：2013-02-27T20:03:17.663
> 
> 标签：android, facebook

我已将我的应用程序与 Facebook 集成，我已按照 Facebook 教程[链接](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/)进行操作。我的应用程序在模拟器中运行良好，但在我的真实设备中运行良好。所以，我发现问题发生是因为在我的应用程序中我已经登录了 fb。
当会话打开时，我收到此消息：FbLogin 想访问您的公开个人资料和朋友列表。在我按下确定后，不要返回任何图形对象，所以没有设置文本..有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-24T02:49:17.743

我建议在测试您自己的应用程序之前/期间在您的设备上退出 Facebook。

打开会话时不返回图形对象。会话准备好后，您需要使用请求 API 进行另一个调用。

# r - 如何在r中设置插入图像的颜色

> ID：15121290
> 
> 赞同：4
> 
> 时间：2013-02-27T20:03:23.557
> 
> 标签：r, graphics

有没有办法将图像插入到 R 的绘图中并在我这样做时设置它的颜色？我想为给定的数据集插入一个轮廓，并将其设置为与我为绘制相应数据点选择的颜色相匹配。我对如何管理图形没有深入的了解——在一般的计算机系统和 R 中——这可能会为这个问题的答案提供信息。

下面的代码将插入图像，但我想不出改变颜色的方法。

```
require(jpeg)
thiscolor <- "red"
plot(x=c(1, 4), y=c(1, 2), main="test plot", col=thiscolor)
thispic <- readJPEG(<insert path for any image here>)
rasterImage(thispic, 
        xleft=3, xright=3.5, 
        ytop=2, ybottom=1.8,
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:54:00.667

我不明白你在这里所说的剪影是什么意思。但对我来说，光栅是颜色矩阵。所以你可以改变它的颜色。这里有一个演示。我正在使用，`grid.raster`来自`grid`包装。但它与`rasterImage`

这里有一个例子：

```
library(png)
library(grid)
img <- readPNG(system.file("img", "Rlogo.png", package="png"))
## convert it to a raster, interpolate =F to select only sample of pixels of img
img.r <- as.raster(img,interpolate=F)
## Change all the white to a blanck
img.r[img.r == "#00000000"] <- 'red'
plot.new()
grid.raster(img.r) 
```

![在此处输入图像描述](../Images/d1fef076f106d3d38c14eaf415773472.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-05T14:50:14.350

太感谢了！

因为我使用的是 R 颜色名称，所以我不得不进行一些（不优雅的）颜色转换。但你的代码正是我需要的！谢谢！

```
 #convert image to raster 
 thispic.r <- as.raster(thispic)
 #get the hex color
 rgbratios <- col2rgb(thiscolor)/255
 thiscolorhex <- rgb(red=rgbratios[1], 
                         green=rgbratios[2], 
                         blue=rgbratios[3])
 #convert the non-white part of the image to the hex color
 thispic.r[thispic.r!="#FFFFFF"] <- thiscolorhex
 #plot it
 grid.raster(thispic.r, x=xval, y=yval, just="center") 
```

# ios - 使用具有不同服务器端点地址的 AFOAuth1Client

> ID：15121292
> 
> 赞同：-1
> 
> 时间：2013-02-27T20:03:34.050
> 
> 标签：ios, oauth

我正在尝试对具有 3 个不同服务器端点的 API 进行身份验证：

*   [请求令牌 URL](http://api.XXX.com/oauth/request_token)

*   [授权网址](http://www.XXX.com/oauth/authorize)

*   [访问令牌 URL](http://api.XXX.com/oauth/access_token)

当 AFOAuth1Client 需要使用 baseURL 进行初始化时，就会出现此问题。我试过@""、nil 和@"http://"，这些都在AFOAuth1Client 初始化中触发崩溃。

我的问题是：如何创建一个 baseURL 为 nil 的 AFOAuth1Client 实例，或者如何更改参数`authorizeUsingOAuthWithRequestTokenPath`以允许我使用正确的路径？（授权 URL 有 www. 而请求 URL 和访问 URL 没有 www.）。

```
 AFOAuth1Client *client = [[AFOAuth1Client alloc] initWithBaseURL:[NSURL URLWithString:@""]key:kConsumerKey secret:kConsumerSecret];
   [client authorizeUsingOAuthWithRequestTokenPath:@"http://api.XXX.com/oauth/request_token" userAuthorizationPath:@"http://www.XXX.com/oauth/authorize" callbackURL:nil accessTokenPath:@"http://api.XXX.com/oauth/access_token" accessMethod:@"Identity"   
       success:^(AFOAuth1Token *accessToken) {
           NSLog(@"successful login");
     } failure:^(NSError *error) {
           NSLog(@"could not login error %@", error);
     }]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:43:46.703

第一步是编辑 AFHTTPClient 接口文件。

将@property baseUrl 更改为：

```
@property (readwrite, nonatomic, retain) NSURL *baseURL; 
```

这允许我们根据输入的当前地址使 baseURL 动态化。在我的情况下，AuthorizeURL/请求令牌/访问令牌。

接下来，我更新了 AFOAuth1Client 类并通过使用正确的 baseURL 更新以下方法手动更改了 baseURL：

```
 (void)authorizeUsingOAuthWithRequestTokenPath:(NSString *)requestTokenPath
                      userAuthorizationPath:(NSString *)userAuthorizationPath
                                callbackURL:(NSURL *)callbackURL
                            accessTokenPath:(NSString *)accessTokenPath
                               accessMethod:(NSString *)accessMethod
                                    success:(void (^)(AFOAuth1Token *accessToken))success 
                                    failure:(void (^)(NSError *error))failure 
```

...

```
 //set baseURL
    self.baseURL = [NSURL URLWithString:@"http://www.XXX.com/"];
    [[UIApplication sharedApplication] openURL:[[self requestWithMethod:@"GET" path:userAuthorizationPath parameters:parameters] URL]];

    //reset it back
    self.baseURL = [NSURL URLWithString:@"http://api.XXX.com/"]; 
```

# javascript - Knockout自定义点击绑定，返回true防止点击劫持？

> ID：15121296
> 
> 赞同：0
> 
> 时间：2013-02-27T20:03:53.500
> 
> 标签：javascript, data-binding, knockout.js

所以我们都知道`return true`手动将允许对具有绑定的元素进行默认单击操作`click`，但是如果我有如下自定义绑定怎么办：

```
ko.bindingHandlers.action = {
    init: function(element, valueAccessor, allBindingsAccessor, context) {
        var options = valueAccessor();
        var params = options.slice(1);

        //wrap it in function, with parameter binding
        var newValueAccessor = function() {
            return function() {
                options[0].apply(context, params);
            };
        };

        ko.bindingHandlers.click.init(element, newValueAccessor, allBindingsAccessor, context);
    }
}; 
```

从绑定中获取 N 个参数：

```
action: [handle, 'open', $index()] 
```

如何允许点击通过？`return true`在这种情况下in`handle`不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:08:41.063

您的实际点击处理程序在此处定义：

```
 return function() {
            options[0].apply(context, params);
        }; 
```

只需更改它，使其返回提供的子处理程序的值：

```
 return function() {
            return options[0].apply(context, params);
        }; 
```

# asp.net-mvc - 模型返回空值

> ID：15121299
> 
> 赞同：1
> 
> 时间：2013-02-27T20:04:11.240
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

这是我的模型代码

```
public class ManufacturerModel
{
    public int ProductTYpeId { get; set; }
    public int Id { get; set; }
    public string Name { get; set; }
    public List<SelectListItem> manf { get; set; }
    public Manufacturer manufacturer { get; set; }
} 
```

这是我在cshtml文件中的代码

```
@using (Html.BeginForm("addmanufacturer", "Admin", FormMethod.Post, new { id = "formPageID" }))
{
    <div class="row">
        <label>Select Existing Manufacturer<span style="color: Red">*</span>:</label>
        <div class="formRight">
            @Html.DropDownList("Id", Model.manf)
        </div>
    </div>
    <div class="row">
        <label>Manufacturer Name<span style="color: Red">*</span>:</label>
        <div class="formRight">
            @Html.TextBoxFor(m => m.manufacturer.name)
            @Html.ValidationMessageFor(m => m.manufacturer.name)
        </div>
    </div>
} 
```

我正在发布此表格，当我试图从制造商那里获取价值时，即 - ManufacturerModel 制造商 = new ManufacturerModel(); 使用模型对象，所有值都为空。

在文本框中如果我用 m => m.Name 替换它，那么我可以获得正确的 Name 值。任何人都可以提出问题所在

我正在使用 manf 绑定下拉菜单。如果我发回表单并且如果它返回，则值变为空白，我需要重新填写该值..

```
 public ActionResult addmanufacturer(string id)
    {
        if (id == null)
            id = "0";

        ManufacturerModel manufacturer = new ManufacturerModel();
        manufacturer.ProductTYpeId = Convert.ToInt32(id);
        manufacturer.manf = GetManf();
        manufacturer.Id = -1;

        return View(manufacturer);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-13T21:47:14.370

我认为问题将是因为：

```
@using (Html.BeginForm("Action", "Controller", FormMethod, HTML ATTRIBUTES )) { } 
```

你可能想要这个重载：

```
@using (Html.BeginForm("Action", "Controller", Route Values, FormMethod, html attributes )) { } 
```

重要的是说他你想要路由值而不是 html 属性，所以试试这个

```
@using (Html.BeginForm("addmanufacturer", "Admin", new { id = "formPageID" }, FormMethod.Post, null )) { } 
```

希望能帮助到你。

M。

# java - Java 泛型 - 转换泛型类时出错

> ID：15121305
> 
> 赞同：0
> 
> 时间：2013-02-27T20:04:27.943
> 
> 标签：java, generics, reflection

我正在尝试实现一个泛型类。界面如下：

```
public interface InterfaceClass <E extends Object, T extends APIWrapper<E>> 
```

该接口的摘要如下：

```
public abstract class MyABS <E,T extends APIWrapper<E>>
   implements InterfaceClass<E,T>
{
   private Class<T> wrapperClass;
   private Class<E> entityClass;

   public RestEndpointImpl(){
       ParameterizedType genericSuperclass =
          (ParameterizedType) getClass().getGenericInterfaces()[0];
       this.entityClass =
          (Class<E>) genericSuperclass.getActualTypeArguments()[0];
       this.wrapperClass =
          (Class<T>) genericSuperclass.getActualTypeArguments()[1];
}
... 
```

那么我的实现是：

```
public class MyImpl extends MyABS<Sport,SportWrapper> 
```

当我尝试实例化 bean 时，出现以下错误

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.windy.rest.endpoint.MyImpl' defined in file [/Users/ddelizia/Documents/My-Projects/windy/repository/blc-ddelizia/rest/target/ddelizia/WEB-INF/classes/com/ddelizia/rest/endpoint/MyImpl.class]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [com.ddelizia.rest.endpoint.MyImpl]: Constructor threw exception; nested exception is java.lang.ClassCastException: java.lang.Class cannot be cast to java.lang.reflect.ParameterizedType
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:997)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:943)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
[artifact:mvn]  at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
[artifact:mvn]  at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:605)
[artifact:mvn]  at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:925)
[artifact:mvn]  at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:472)
[artifact:mvn]  at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
[artifact:mvn]  at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
[artifact:mvn]  at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
[artifact:mvn]  at org.eclipse.jetty.server.handler.ContextHandler.callContextInitialized(ContextHandler.java:766)
[artifact:mvn]  at org.eclipse.jetty.servlet.ServletContextHandler.callContextInitialized(ServletContextHandler.java:406)
[artifact:mvn]  at org.eclipse.jetty.server.handler.ContextHandler.startContext(ContextHandler.java:758)
[artifact:mvn]  at org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:242)
[artifact:mvn]  at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1233)
[artifact:mvn]  at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:701)
[artifact:mvn]  at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:475)
[artifact:mvn]  at org.mortbay.jetty.plugin.JettyWebAppContext.doStart(JettyWebAppContext.java:256)
[artifact:mvn]  at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
[artifact:mvn]  at org.eclipse.jetty.server.handler.HandlerCollection.doStart(HandlerCollection.java:224)
[artifact:mvn]  at org.eclipse.jetty.server.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:167)
[artifact:mvn]  at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
[artifact:mvn]  at org.eclipse.jetty.server.handler.HandlerCollection.doStart(HandlerCollection.java:224)
[artifact:mvn]  at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
[artifact:mvn]  at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:90)
[artifact:mvn]  at org.eclipse.jetty.server.Server.doStart(Server.java:272)
[artifact:mvn]  at org.mortbay.jetty.plugin.JettyServer.doStart(JettyServer.java:65)
[artifact:mvn]  at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
[artifact:mvn]  at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:511)
[artifact:mvn]  at org.mortbay.jetty.plugin.AbstractJettyMojo.execute(AbstractJettyMojo.java:364)
[artifact:mvn]  at org.mortbay.jetty.plugin.JettyRunMojo.execute(JettyRunMojo.java:516)
[artifact:mvn]  at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
[artifact:mvn]  at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
[artifact:mvn]  at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
[artifact:mvn]  at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
[artifact:mvn]  at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
[artifact:mvn]  at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
[artifact:mvn]  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[artifact:mvn]  at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
[artifact:mvn]  at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
[artifact:mvn]  at java.lang.reflect.Method.invoke(Method.java:597)
[artifact:mvn]  at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
[artifact:mvn]  at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
[artifact:mvn]  at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
[artifact:mvn]  at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
[artifact:mvn]  at org.codehaus.classworlds.Launcher.main(Launcher.java:47)
[artifact:mvn] Caused by: 
[artifact:mvn] org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [com.ddelizia.rest.endpoint.MyImpl]: Constructor threw exception; nested exception is java.lang.ClassCastException: java.lang.Class cannot be cast to java.lang.reflect.ParameterizedType
[artifact:mvn]  at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:162)
[artifact:mvn]  at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:87)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:990)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:943)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
[artifact:mvn]  at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
[artifact:mvn]  at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
[artifact:mvn]  at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:605)
[artifact:mvn]  at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:925)
[artifact:mvn]  at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:472)
[artifact:mvn]  at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
[artifact:mvn]  at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
[artifact:mvn]  at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
[artifact:mvn]  at org.eclipse.jetty.server.handler.ContextHandler.callContextInitialized(ContextHandler.java:766)
[artifact:mvn]  at org.eclipse.jetty.servlet.ServletContextHandler.callContextInitialized(ServletContextHandler.java:406)
[artifact:mvn]  at org.eclipse.jetty.server.handler.ContextHandler.startContext(ContextHandler.java:758)
[artifact:mvn]  at org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:242)
[artifact:mvn]  at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1233)
[artifact:mvn]  at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:701)
[artifact:mvn]  at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:475)
[artifact:mvn]  at org.mortbay.jetty.plugin.JettyWebAppContext.doStart(JettyWebAppContext.java:256)
[artifact:mvn]  at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
[artifact:mvn]  at org.eclipse.jetty.server.handler.HandlerCollection.doStart(HandlerCollection.java:224)
[artifact:mvn]  at org.eclipse.jetty.server.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:167)
[artifact:mvn]  at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
[artifact:mvn]  at org.eclipse.jetty.server.handler.HandlerCollection.doStart(HandlerCollection.java:224)
[artifact:mvn]  at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
[artifact:mvn]  at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:90)
[artifact:mvn]  at org.eclipse.jetty.server.Server.doStart(Server.java:272)
[artifact:mvn]  at org.mortbay.jetty.plugin.JettyServer.doStart(JettyServer.java:65)
[artifact:mvn]  at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
[artifact:mvn]  at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:511)
[artifact:mvn]  at org.mortbay.jetty.plugin.AbstractJettyMojo.execute(AbstractJettyMojo.java:364)
[artifact:mvn]  at org.mortbay.jetty.plugin.JettyRunMojo.execute(JettyRunMojo.java:516)
[artifact:mvn]  at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
[artifact:mvn]  at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
[artifact:mvn]  at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
[artifact:mvn]  at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
[artifact:mvn]  at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
[artifact:mvn]  at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
[artifact:mvn]  at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
[artifact:mvn]  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[artifact:mvn]  at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
[artifact:mvn]  at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
[artifact:mvn]  at java.lang.reflect.Method.invoke(Method.java:597)
[artifact:mvn]  at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
[artifact:mvn]  at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
[artifact:mvn]  at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
[artifact:mvn]  at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
[artifact:mvn]  at org.codehaus.classworlds.Launcher.main(Launcher.java:47)
[artifact:mvn] Caused by: 
[artifact:mvn] java.lang.ClassCastException: java.lang.Class cannot be cast to java.lang.reflect.ParameterizedType 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T20:09:20.233

乍一看，您似乎想调用[`getGenericSuperclass()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getGenericSuperclass%28%29)而不是`getGenericInterfaces()`：

```
ParameterizedType genericSuperclass =
   (ParameterizedType) getClass().getGenericSuperclass(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:10:49.500

这很简单。你投错了班级。请看这里： [http ://docs.oracle.com/javase/6/docs/api/java/lang/reflect/ParameterizedType.html](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/ParameterizedType.html)

参数化类型不是类。

# inversion-of-control - Tapestry IoC 构造函数和注入

> ID：15121308
> 
> 赞同：0
> 
> 时间：2013-02-27T20:04:36.790
> 
> 标签：inversion-of-control, tapestry

我有以下课程：

```
public class MyClass {
    @Inject
    private MyAnotherClass myAnotherClass;

    public MyClass() {
        //Perform operations on myAnotherClass.
    }
} 
```

我需要在构造函数中做一些需要`myAnotherClass`. 不幸`myAnotherClass`的是，在构造函数中的代码运行后注入，这意味着我正在对`null`...执行操作

我当然可以直接在构造函数中以经典方式 () 实例化它`MyAnotherClass myAnotherClass = new MyAnotherClass()`，但我认为在这种情况下这样做是不正确的。

你会建议什么解决方案来解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T22:38:10.863

最佳选择：

```
public class MyClass {
  private final MyAnotherClass myAnotherClass;

  public MyClass(MyAnotherClass other) {
    this.myAnotherClass = other;
    // And so forth
  }
} 
```

然后 T5-IoC 将使用构造函数注入，因此无需自己“新建” `MyClass`。有关详细信息，请参阅[定义 Tapestry IOC 服务](http://tapestry.apache.org/defining-tapestry-ioc-services.html#DefiningTapestryIOCServices-InjectingDependenciesforAutobuiltServices)。

或者：

```
public class MyClass {
  @Inject
  private MyAnotherClass myAnotherClass;

  @PostInjection
  public void setupUsingOther() {
    // Called last, after fields are injected
  }
} 
```

# r - 在 R 中构建一个包

> ID：15121312
> 
> 赞同：3
> 
> 时间：2013-02-27T20:04:53.183
> 
> 标签：r, package, alias

我正在尝试构建一个包，它工作正常，但运行时我收到一个警告`R CMD check my.package`，即

```
* checking Rd metadata ... WARNING
Rd files with duplicated alias 'show,whitetest-method':
'show-methods.Rd' 'whitetest-class.Rd' 
```

我的包只包含一个函数，它保存在文件中`name.R`。但是，在这个`name.R`文件中，我首先需要创建一个新类（称为`whitetest`），然后`show`为它定义方法。这很简单，看起来像这样：

```
# Create the new class whitetest
setClass("whitetest", representation("list"))

# Specify the appearance of the output
setMethod("show", "whitetest", function(object) {
text1 <- "White's Test for Heteroskedasticity:"
cat(paste("\n", text1, "\n", sep = ""))
row <- paste(rep("=", nchar(text1)), collapse = "")
cat(row, "\n")
cat("\n")
cat(" No Cross Terms\n")
cat("\n")
cat(" H0: Homoskedasticity\n")
cat(" H1: Heteroskedasticity\n")
cat("\n")
cat(" Test Statistic:\n")
cat("", sprintf("%.4f", object$statistic), "\n")
cat("\n")
cat(" Degrees of Freedom:\n")
cat("", object$degrees, "\n")
cat("\n")
cat(" P-value:\n")
cat("", sprintf("%.4f", object$p.value), "\n")
}) 
```

`package.skeleton()`然后我在这个`name.R`文件上运行命令。在我`man`的文件夹中，文件`show-methods.Rd`是`whitetest-class.Rd`导致问题的文件。该`show-methods`文件的第一行是：

```
\name{show-methods}
\docType{methods}
\alias{show-methods}
\alias{show,whitetest-method} 
```

文件的`whitetest-class`第一行是：

```
\name{whitetest-class}
\Rdversion{1.1}
\docType{class}
\alias{whitetest-class}
\alias{show,whitetest-method} 
```

我知道这些事情是导致警告的原因，但是我到底该如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T21:09:39.637

好的，我找到了解决方案。该行`\alias{show,whitetest-method}`同时位于`show-methods.Rd`和`whitetest-class.Rd`中。错过这是一件愚蠢的事情，我打算删除这个线程，但我想我会留下它，以防其他人犯同样的错误。

# javascript - Jquery 复杂的鼠标悬停效果

> ID：15121316
> 
> 赞同：-6
> 
> 时间：2013-02-27T20:04:59.050
> 
> 标签：javascript, jquery, jsfiddle

有人可以告诉我如何使用 jquery/javascript 轻松实现此效果吗？[http://goo.gl/xaC5C](http://goo.gl/xaC5C) “数字创意是我们的快乐之地” 我需要响应的效果（根据浏览器宽度增加/减小大小） 市场上有没有我可以购买或下载的脚本？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:10:04.843

您正在查看的动画都是通过画布操作实现的。[链接到画布 API。](http://www.w3schools.com/html/html5_canvas.asp)

# php - 不使用多种返回类型的 OOP 表单验证

> ID：15121318
> 
> 赞同：1
> 
> 时间：2013-02-27T20:05:11.753
> 
> 标签：php, forms, oop, validation

我有一个用户可以登录的程序。我有一个`User`类，当他们登录时，他们的所有属性（权限、用户名、真实姓名等）都保存为类属性。但是，由于所有数据都需要验证，因此我很难考虑让用户**更新自己的信息的最佳方法。**

目前，当用户尝试更新他们自己的信息时，例如他们的电子邮件地址，我会：

```
// Set new email
$try = $user->setEmail($_POST['new_email']);
if ($try !== true) {
    $errors[] = $try;
}
...
if (isset($errors) {
    // Tell user what went wrong
} else {
    $user->saveValuesToDB();
} 
```

它工作正常，但对我来说似乎相当难看，因为`User->setEmail()`需要具有混合返回类型，因为电子邮件可能因多种原因而无效（未找到域、无效格式、提供的空字符串、已被其他用户使用等）并且需要将确切原因传回给用户，但据我所知，通常不鼓励混合回报。

我想到的另一种方法是只更新所有属性而不执行任何类型的验证，然后`User->commitAllChanges()`在最后执行所有验证，这将从所有 setter 方法中取出多个返回并减少它仅提交方法，但我真的不喜欢这个，因为我觉得实际设置的任何属性都应该是有效的，它仍然没有完全摆脱问题。

我可以使用哪些其他方法来允许用户设置对象属性并验证它们，将任何错误发送回用户？还是我现在做的很好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:15:06.220

使用`try-catch`构造。

```
// somewhere in your project
class UserValidationException extends \Exception {}

// In your form handler, controller, or whatever you have
try {
    $user->setName($_POST['new_email']);
    $user->setEmail($_POST['new_name']);
    // etc.
}
catch (UserValidationException $e)
{
    // tell user what went wrong using $e->getMessage();
}

// In your User class
class User
{
    // ...
    public function setName($newName)
    {
        if (strlen($newName) < 2)
            throw new UserValidationException('User name is too short');
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:12:40.627

> 我想到的另一种方法是只更新所有属性而不执行任何类型的验证，然后在最后执行 User->commitAllChanges() 这将执行所有验证，这将从所有setter 方法并将其简化为仅提交方法

这通常是一个好方法。您还可以将整个过程分解为更小的部分，使其更加通用。

例如，模型可能有一个`validate`返回单个布尔值的方法（一切正常，还是有一个或多个错误？），以及一个`getValidationErrors`返回包含您关心的所有信息的数组的方法（可能需要多维）。它可以有一个`commit`自动调用的方法，`validate`并且只有在完全没有错误的情况下才会保留更改。

> 但我也真的不喜欢这样，因为我觉得实际设置的任何属性都应该是有效的，但它仍然没有完全解决问题。

“不会被设置”的属性比人们最初想象的更麻烦**。**主要问题是，如果要设置属性对象（通过返回一些错误代码，或者更好的是，通过抛出异常），那么*您必须使用“保护性”代码来包装对它的所有访问*。这变得非常乏味非常快。

在实践中，通过一个辅助方法一次性为所有属性大量赋值，然后查看结果是什么（例如，通过调用上述`validate`方法）要方便得多。

另外，不要忘记，在实践中，您希望在数据输入字段旁边显示验证错误，并且这些字段已连接到预填充模型属性的值。因此，一方面属性需要有效，另一方面它们需要与用户输入的内容完全匹配（否则用户会想杀了你）。因此，最好放宽“必须始终有效”的约束以支持实用程序——尽管现在到处都有 AJAX 表单和客户端验证，但这变得不那么相关了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:09:21.310

一种方法是保留您的解决方案（setEmail 函数）并使其更加面向对象。在 setAction 中，您可以设置错误列表

```
$this->errors[] = 'Domain invaild'; 
```

然后制作 1 或 2 个函数以从类中获取错误

```
public function hasErrors() {return false == empty($this->errors);}
public function getErrors() {return $this->errors;} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T20:12:26.513

您当前的方法没有问题，但是您可以做的是使用异常。

它可能看起来像：

```
try
{
    $user->setEmail($_POST['new_email']);
}
catch (Exception $e)
{
    $errors[] = $e->getMessage();
} 
```

您的 setEmail 方法将类似于：

```
setEmail($email)
{
    if ($tooShort) // validate length
        throw new Exception("Email is too short"); // perhaps have custom exceptions
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-23T20:38:32.707

我对此使用了某种 MVC.NET 方法。基本上抛出异常的坏处是性能，为什么你只想抓住一个？如果电子邮件和密码都无效，请同时让他们知道，而不是“电子邮件不正确”-修复电子邮件-重新发布-“哦，密码也不正确，可能会早点告诉你，但嘿，你只会让我赚钱”

> 编辑：
> 也不应该因为验证返回错误而引发异常，我们希望得到无效数据，无论它是否是故意的（黑客）。但是让我们看看它是如何以大规模形式处理的，看看处理变得多么缓慢。验证错误应该被存储并显示给用户，它应该只导致我们的程序输入条件而不是异常。应该为编码错误保留异常，例如我们需要的资源不存在，有人删除了我们需要正确执行代码的库文件或框架，等等。

```
 <?php

    class ChangePasswordModel
    {

        protected $OldPassword;

        protected $NewPassword;

        protected $ConfirmPassword;

        protected $ValidationMessages;

        protected $DisplayNames;

        public function __construct()
        {
            $this->DisplayNames = array(
                "OldPassword"       => "Old password",
                "NewPassword"       => "New password",
                "ConfirmPassword"   => "Confirm new password",
            );
        }

        public function LoadPost()
        {
            if ( !isset( $_POST["OldPassword"] ) || !isset( $_POST["NewPassword"] ) || !isset( $_POST["ConfirmPassword"] ) )
                return;

            $this->OldPassword      = trim( $_POST["OldPassword"] );
            $this->NewPassword      = trim( $_POST["NewPassword"] );
            $this->ConfirmPassword  = trim( $_POST["ConfirmPassword"] );

            if ( strlen( $this->OldPassword ) < 1 )
                $this->ValidationMessages["OldPassword"] = "Old password is not set";
            if ( strlen( $this->NewPassword ) < 6 )
                $this->ValidationMessages["NewPassword"] = "Password must be at least 5 characters.";
            if ( $this->NewPassword != $this->ConfirmPassword )
                $this->ValidationMessages["ConfirmPassword"] = "Passwords do not match.";
        }

        public function ValidationMessageFor( $name )
        {
            if ( !isset( $this->ValidationMessages[$name] ) )
                return "";

            return $this->ValidationMessages[$name];
        }

        public function DisplayNameFor( $name )
        {
            // Throw exception if not set
            return $this->DisplayNames[$name];
        }

    }

    $Model = new ChangePasswordModel();
    $Model->LoadPost();

    ?>
    <form action="" method="post">
        <div>
            <?= $Model->DisplayNameFor( "OldPassword" ) ?>
        </div>
        <div>
            <input type="password" name="OldPassword" />
            <span><?= $Model->ValidationMessageFor( "OldPassword" ) ?></span>
        </div>

        <div>
            <?= $Model->DisplayNameFor( "NewPassword" ) ?>
        </div>
        <div>
            <input type="password" name="NewPassword" />
            <span><?= $Model->ValidationMessageFor( "NewPassword" ) ?></span>
        </div>

        <div>
            <?= $Model->DisplayNameFor( "ConfirmPassword" ) ?>
        </div>
        <div>
            <input type="password" name="ConfirmPassword" />
            <span><?= $Model->ValidationMessageFor( "ConfirmPassword" ) ?></span>
        </div>

        <p>
            <input type="submit" value="Change Password" />
        </p>
    </form> 
```

# git - VCS 中有没有办法让子分支只同步来自父级的几个特定文件夹/文件？

> ID：15121319
> 
> 赞同：1
> 
> 时间：2013-02-27T20:05:12.433
> 
> 标签：git, svn, version-control, mercurial

假设我有一个项目的存储库，其中包含一堆文件夹和文件，我们可以称它为 master。

*   /3rdParty 罐子
*   /罗盘
*   /js
*   /部署
*   /js
*   /Python
*   构建.xml

当我部署到生产服务器时，我只想将最新的部署和 python 文件夹推送到服务器。以前我使用的是 svn1.7，我刚刚创建了一个部署存储库，当部署发生时，我只需将最新的文件夹放入并提交到部署存储库并从服务器进行更新。

我认为更好的方法是从只有两个文件夹的 master 创建一个部署分支。当需要部署时，只需要完成来自 master 的同步。有没有办法通过在 git 或其他 vcs 中分支来做到这一点？请记住，我对 git 还是很陌生，而且我只在空闲时间使用它大约几个星期。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:00:49.187

我建议只在服务器上部署您的主分支。如果只创建这两个文件夹对您很重要，您可以通过稀疏检出来实现。在此处查看我的答案：[如何仅克隆 Git 存储库的子目录？](https://stackoverflow.com/questions/600079/is-there-any-way-to-clone-a-git-repositorys-sub-directory-only/13738951#13738951)

# android - 横向菜单应用程序不运行

> ID：15121323
> 
> 赞同：0
> 
> 时间：2013-02-27T20:05:27.117
> 
> 标签：android, android-layout

我正在尝试构建一个 ActionBar 菜单应用程序，但是当我在模拟器中启动它时，会显示以下消息：

不幸的是，玛帕已经停止了。

这是代码：

主要活动：

```
import android.os.Bundle;
import android.app.Activity;
import android.app.Fragment;
import android.app.FragmentTransaction;
import android.view.Menu;

public class Mapapp extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_mapapp);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.menuopc, menu);
    return true;
} 
```

}

menuopc.xml

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
    <item
        android:id="@+id/mapa"
        android:title="@string/t1"
        android:orderInCategory="1"
        android:showAsAction="always|ifRoom" />

    <item
        android:id="@+id/lista"
        android:title="@string/t2"
        android:orderInCategory="2"
        android:showAsAction="always|ifRoom" />

</menu> 
```

activity_mapapp.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
tools:context=".Mapapp" >

</RelativeLayout> 
```

知道有什么问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-14T12:26:27.740

你不能使用 ifRoom 并且总是在同一个项目中。如果操作栏中没有足够的空间来显示操作项，设备将不知道如何操作。

*ifRoom* - 仅当有空间时才将此项目放置在操作栏中。

*always* - 始终将此项目放在操作栏中。除非该项目始终出现在操作栏中很重要，否则请避免使用此选项。将多个项目设置为始终显示为操作项可能会导致它们与操作栏中的其他 UI 重叠。

参考：http: [//developer.android.com/guide/topics/resources/menu-resource.html](http://developer.android.com/guide/topics/resources/menu-resource.html)

# javascript - iframe 和父窗口之间的通信？

> ID：15121328
> 
> 赞同：0
> 
> 时间：2013-02-27T20:05:48.147
> 
> 标签：javascript, jquery, html, iframe

在一篇 Sencha 对 facebook 声称 html5 速度慢的文章提出异议的文章中，他们建议有一种方法可以创建一个框架，该框架允许 iframe 和父窗口之间的无缝通信。这将如何实现？不寻找代码示例，只是想法。谢谢

> 所以 Fastbook 应用是第一个使用全新的“沙盒容器”的应用程序，它以编程方式分离复杂的视图并将它们呈现到自己的 iframe 中，从而对 DOM 树进行分区。这个特殊的容器不需要在应用程序级别进行任何额外的处理，因此它对开发人员来说是无缝的（即，添加到这个容器的任何组件都将自动被沙箱化）。**但这确实是有代价的：事件、定位、样式和 JavaScript 代码必须在父窗口和子沙箱之间进行代理**. 这很复杂，因此如果没有健壮且架构合理的框架，就很难实现。沙盒允许布局被隔离，因此保持主 DOM 树尽可能轻。为了平衡原力，必须明智地使用沙盒容器

.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:27:38.683

像[http://easyxdm.net/wp/](http://easyxdm.net/wp/)这样的东西通过使用 PostMessageTransport 来处理它

# sql - 数据如何从 SQL 服务器传递到 Joomla

> ID：15121330
> 
> 赞同：-1
> 
> 时间：2013-02-27T20:05:53.547
> 
> 标签：sql, joomla

我们出售软件程序的订阅，数据存储在 SQL 服务器中。我想获取用户的到期日期，然后将其显示在 joomla 上。我们的服务器人员说他使用 REST。谁能帮我理解这些数据是如何从 SQL 表传递到 joomla 上的文本的？他还提到它必须通过 SSL，但我不确定这与什么有关。

我是一个完全的新手，在学习这些材料时不知道从哪里开始。任何了解更多信息的资源将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:35:16.557

我不会为您提供资源，只需查询 google 或 youtube 即可。那里有这么多，很难为你指出正确的地方。

从您所说的看来，您的软件信息运行在与 joomla 不同的服务器上。

您可以通过直接连接到数据库或通过创建专用软件来处理您在“软件信息”服务器上的请求来解决这个问题。

**直接连接** 通常禁用对数据库服务器的远程访问，这是一个很好的安全措施。但是，您可以使用 mysql 远程表和受限帐户，并直接从 Joomla 模块或组件访问远程数据库。这个解决方案非常糟糕，因为它依赖于远程数据库的结构。

**编写软件** 在这里，您的 Joomla 扩展程序将查询您必须放置在数据库服务器上的新软件。从您所写的内容来看，连接应该是安全的（https / ssl）。

您如何实现它（使用 REST、使用 GET 传递参数等）实际上并不重要，但可能有公司标准，并且 REST 很好且易于理解。

所以你必须从你的 joomla 扩展中 http 获取：

（休息）

```
https://info-db-server-ip/license/130 
```

（得到）

```
https://info-db-server-ip/license/index.php?userid=130 
```

并且脚本通常会返回一个包含许可证详细信息的 json 编码响应。

# java - 如何将 JPanel 放在另一个 JPanel 上？

> ID：15121331
> 
> 赞同：4
> 
> 时间：2013-02-27T20:05:54.607
> 
> 标签：java, swing, jpanel

我是 Java 新手（和一般编程），我正在尝试制作我的第一个程序。我现在在同一个问题上停留了大约 5 个小时，所以我决定寻求帮助。

基本上我正在尝试制作一个在板上有大约 20 个位置的程序（2d 游戏）。每个位置都是蓝色（玩家1拥有）、红色（玩家2拥有）或黑色（不属于任何人）。

我要解决这个问题的方法主要是我已经放置了一个调用设置游戏的方法，然后是一个玩游戏的方法。我正在开发设置游戏，基本上它所做的只是创建一个类对象`Background`（扩展`JPanel`和覆盖`paintComponent()`）和 20 个类对象`Position`（扩展 JPanel 和覆盖`paintComponent()`）。

到目前为止，我一直坚持将这些 Position 对象放在 Background 对象之上。

当我做：

```
Background background= new Background();
frame.getContentPane().add(background);
Position position1= new Position;
frame.getContentPane().add(position1);
frame.setVisible(true); 
```

它只显示一个圆圈，没有我希望的背景，如果我先添加位置然后添加背景，我只有背景而没有圆圈。

无论如何，我是 Java 新手，但我仍然无法找到解决方法，但是我尝试寻找解决方案，并且我找到了许多不同的解决方案来解决这个问题（例如首先将位置添加到背景，以及然后将背景添加到框架等），但我无法让它们中的任何一个工作。

我知道我将它们都添加到框架的方式（很可能）是完全错误的，但我是这样写的，所以你会（希望）确保我写的内容确实向你展示了我的代码这些类中的一些在屏幕上绘制了一些东西。

**PS：**我没有在这里复制我的代码，因为大多数变量和方法名称都不是英文的，所以很难阅读，但如果你仍然认为它需要，我会添加它。另外我很抱歉我可能很愚蠢的问题，但我在这里有点碰壁，我不知道还有什么可以尝试的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:13:08.853

> 基本上我正在尝试制作一个在板上有大约 20 个位置的程序（2d 游戏）。每个位置都是蓝色（玩家1拥有）、红色（玩家2拥有）或黑色（不属于任何人）。

1.  [默认情况下在 Swing 中绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/index.html)永远不会返回`PreferredSize`，需要[覆盖 getPreferedSize()](https://stackoverflow.com/a/9258934/714968)

2.  [JPanel](http://docs.oracle.com/javase/tutorial/uiswing/components/panel.html)已`FlowLayout`在 API 中实现，此[LayoutManager 仅接受 PreferredSize](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)来自添加到此容器的[JComponents](http://docs.oracle.com/javase/tutorial/uiswing/components/index.html)

3.  上午更改后发布[SSCCE](http://sscce.org/)，简短，可运行，可编译

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:41:53.590

```
Background background= new Background();
frame.getContentPane().add(background);
Position position1= new Position;
frame.getContentPane().add(position1); 
```

JFrame 默认使用 BorderLayout。此外，默认情况下，当您将组件添加到使用 BorderLayout 的容器时，组件将添加到 CENTER。CENTER 中只能添加一个组件，因此您的位置组件将替换背景组件。

您想将位置添加到背景，然后将背景添加到框架。就像是：

```
Background background= new Background();
Position position1= new Position;
background.add(position1);
frame.add(background); 
```

注意：向框架添加组件时无需使用 getContentPane()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:56:19.367

听起来您想使用一个 JFrame 并将 JPanel 附加到它。这就是我个人的做法。

声明你的 JFrame 和 JPanels

```
JFrame frame1 = new JFrame( "App Name");
JPanel panel1 = new JPanel(); 
JPanel panel2 = new JPanel(); 
JPanel panel3 = new JPanel(); 
JPanel panel4 = new JPanel(); 
```

设置背景（我正在使用颜色，但你明白了）

```
panel1.setBackground(Color.orange);
panel2.setBackground(Color.orange);
panel3.setBackground(Color.orange);
panel4.setBackground(Color.orange); 
```

为 JFrame 设置布局（我正在使用 BoxLayout，不确定哪个最适合您）您可以在此处找到最适合您的布局和一些示例代码[。](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)也只需设置默认关闭操作。

```
frame1.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );
frame1.setLayout( new BoxLayout( frame1.getContentPane(), BoxLayout.Y_AXIS ) ); 
```

然后只需附加您的 JPanel

```
frame1.add( panel1);
frame1.add( panel2);
frame1.add( panel3);
frame1.add( panel4);
frame1.pack();
frame1.setVisible( true ); 
```

这将允许您使用您创建的 JPanel，然后通过其他方法更改颜色。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:12:29.193

根面板应该是一个 JFrame，下面有一个 Container 类。当您调用 someRoot.window.container = yourJPanel 时，它将 JPanel 作为 JFrame 的主要组件视图加载。注意，一个 JFrame 只能容纳一个 JPanel，但其他 JPanel 可以容纳其他 JPanel。正如您将初始 JPanel 添加到 JFRam 一样，JPanel 自己的容器可以是另一个 JPanel。希望这可以帮助。

像这样：

```
JPanel temp = new JPAnel();
frame.getContentPane().add(temp);
temp.getContentPane().add(new JPanel()); 
```

在这些添加之后，有一个命令在欺骗我，但您调用 JFrame 以使其实时刷新。我认为它是这样的：

```
frame.validate();  //thanks @SMT 
```

或者其他的东西，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T20:12:55.500

尝试使用类似的东西

```
jPanelExampleName.validate();
jPanelExampleName.repaint(); 
```

添加您的 JPanel 后。

# c - 有条件地设置一个变量，如果它是 NULL

> ID：15121336
> 
> 赞同：2
> 
> 时间：2013-02-27T20:06:19.910
> 
> 标签：c, variable-assignment, conditional-operator

单步执行时`sqlite3_stmt`，我想检查返回值`NULL`而不是存储它并检查存储的值。

这就是我现在正在做的事情：

```
char *email = (char *)sqlite3_column_text(statement, 10);
if (email == NULL) email = ""; 
```

这是我想做*的*，减去双重调用`column`：

```
char *email = ((char *)sqlite3_column_text(statement, 10)) ? (char *)sqlite3_column_text(statement, 10) : ""; 
```

有什么方法可以更简洁地表达第二个表达式吗？我必须重复做很多这些，所以我正在寻找简洁。

我知道这是控制流的问题，而不是 SQLite API 本身的问题，但是你有它。我想不出一个好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T20:15:09.667

C的[GNU 扩展](http://gcc.gnu.org/onlinedocs/gcc-3.1/gcc/Conditionals.html#Conditionals)允许三元条件运算符评估其条件是否为真并且第一个分支中没有任何内容：

```
char *email = (char *)sqlite3_column_text(statement, 10);
email = email ? : ""; 
```

或者，更确切地说，你说你在找什么

```
char * email = (char *)sqlite3_column_text(statement, 10) ? : ""; 
```

这在使用 Clang 编译时也有效。

另一种可能性是：

```
char *email = (char *)sqlite3_column_text(statement, 10);
email = (NULL == email) ? email : ""; 
```

但我认为我建议您选择第一个选项。如果您经常这样做，请制作一个代码片段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:23:05.230

这行得通吗？

```
char *email;
// Reviewed by "R." to verify sequence point correctness.
email = (email = (char *)sqlite3_column_text(statement, 10))? email : ""; 
```

# bash - 递归使用 scp 但不包括某些文件夹

> ID：15121337
> 
> 赞同：86
> 
> 时间：2013-02-27T20:06:20.097
> 
> 标签：bash, scp

假设有一些具有这些结构的文件夹

```
/bench1/1cpu/p_0/image/
/bench1/1cpu/p_0/fl_1/
/bench1/1cpu/p_0/fl_1/
/bench1/1cpu/p_0/fl_1/
/bench1/1cpu/p_0/fl_1/
/bench1/1cpu/p_1/image/
/bench1/1cpu/p_1/fl_1/
/bench1/1cpu/p_1/fl_1/
/bench1/1cpu/p_1/fl_1/
/bench1/1cpu/p_1/fl_1/
/bench1/2cpu/p_0/image/
/bench1/2cpu/p_0/fl_1/
/bench1/2cpu/p_0/fl_1/
/bench1/2cpu/p_0/fl_1/
/bench1/2cpu/p_0/fl_1/
/bench1/2cpu/p_1/image/
/bench1/2cpu/p_1/fl_1/
/bench1/2cpu/p_1/fl_1/
/bench1/2cpu/p_1/fl_1/
/bench1/2cpu/p_1/fl_1/
.... 
```

我想要做的是`scp`以下文件夹

```
/bench1/1cpu/p_0/image/
/bench1/1cpu/p_1/image/
/bench1/2cpu/p_0/image/
/bench1/2cpu/p_1/image/ 
```

如您所见，我想递归使用`scp`但不包括所有名为“fl_X”的文件夹。似乎 scp 没有这样的选择。

**UPDATE** scp 没有这样的功能。相反，我使用以下命令

```
 rsync -av --exclude 'fl_*' user@server:/my/dir 
```

但它不起作用。它只传输文件夹列表！！就像是`ls -R`

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-02-27T23:34:15.473

虽然`scp`通过该选项支持递归目录复制`-r`，但它不支持文件过滤。有几种方法可以完成您的任务，但我可能会依赖`find`, `xargs`, `tar`, 而`ssh`不是`scp`.

```
find . -type d -wholename '*bench*/image' \
| xargs tar cf - \
| ssh user@remote tar xf - -C /my/dir 
```

可以使`rsync`解决方案起作用，但是您缺少一些论据。`rsync`还需要`r`switch 递归到子目录。此外，如果您想要与 相同的安全性`scp`，则需要在`ssh`. 就像是：

```
rsync -avr -e "ssh -l user" --exclude 'fl_*' ./bench* remote:/my/dir 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-05-02T11:22:49.787

您可以指定`GLOBIGNORE`和使用模式`*`

```
GLOBIGNORE='ignore1:ignore2' scp -r source/* remoteurl:remoteDir 
```

您可能希望拥有可以通过 using 组合或覆盖的一般规则`export GLOBIGNORE`，但对于临时使用，只需上述方法即可。该`:`字符用作多个值的分隔符。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-04-28T14:16:21.617

假设最简单的选项（在远程主机上安装 rsync）不可行，您可以使用**sshfs**在本地挂载远程，并从挂载目录执行**rsync 。**这样您就可以使用 rsync 提供的所有选项，例如`--exclude`.

这样的事情应该做：

```
sshfs user@server: sshfsdir
rsync --recursive --exclude=whatever sshfsdir/path/on/server /where/to/store 
```

请注意，rsync 的有效性（仅传输更改，而不是所有内容）不适用于此处。这是因为要使其正常工作，rsync 必须读取每个文件的内容以查看发生了什么变化。但是，由于 rsync 仅在一台主机上运行，​​因此必须将整个文件传输到那里（通过 sshfs）。但是，不应传输排除的文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-08-17T04:04:22.773

如果您使用 pem 文件进行身份验证，您可以使用以下命令（这将排除带有扩展名的文件）：

```
rsync -Lavz -e "ssh -i <full-path-to-pem> -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null" --exclude "*.something" --progress <path inside local host> <user>@<host>:<path inside remote host> 
```

-L 表示跟随链接（复制文件而不是链接）。使用 pem 文件的完整路径而不是相对路径。

不推荐使用 sshfs，因为它运行缓慢。此外，上面介绍的 find 和 scp 的组合也是一个坏主意，因为它会为每个文件打开一个 ssh 会话，这太昂贵了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-11T16:02:38.740

您可以使用扩展通配符，如下例所示：

```
#Enable extglob
shopt -s extglob

cp -rv !(./excludeme/*.jpg) /var/destination 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-16T13:14:48.717

这对我来说很好，因为目录结构对我来说并不重要。

```
scp -r USER@HOSTNAME:~/bench1/?cpu/p_?/image/ . 
```

假设`/bench1`在当前用户的主目录中。此外，将 USER 和 HOSTNAME 更改为实际值。

# android - TextView 中的多个彩色标签

> ID：15121341
> 
> 赞同：1
> 
> 时间：2013-02-27T20:06:34.763
> 
> 标签：android

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:15:52.997

您可以尝试使用双引号：

```
<a href="#"><font color="#f00">text</font></a> 
```

[除此之外，您将`ForegroundColorSpan`](http://developer.android.com/reference/android/text/style/ForegroundColorSpan.html)需要手动操作自己。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T11:46:45.660

你试试`<font color="#f00"><a href="#">text</a></font>`？

# html - 如何居中 a 内的元素 容器？

> ID：15121343
> 
> 赞同：52
> 
> 时间：2013-02-27T20:06:50.570
> 
> 标签：html, css, text, centering

我希望我的`<p>`元素位于容器的中心`<div>`，就像完全居中一样 - 顶部、底部、左侧和右侧边距平均分割空间。

我怎样才能做到这一点？

```
div {
  width: 300px;
  height: 100px;
}
p {
  position: absolute;
  top: auto;
}
```

```
<div>
  <p>I want this paragraph to be at the center, but it's not.</p>
</div>
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-02-27T20:12:45.497

你不需要绝对定位使用

```
p {
 text-align: center;
line-height: 100px;

} 
```

并随意调整...

**如果文本超过宽度并且超过一行**

在这种情况下，您可以做的调整是将 display 属性包含在您的规则中，如下所示；

*（我添加了背景以便更好地查看示例）*

```
div
{
  width:300px;
  height:100px;  
  display: table; 
  background:#ccddcc;  
}

p {
  text-align:center; 
  vertical-align: middle;
  display: table-cell;   
} 
```

[在这个JBin](http://jsbin.com/amirot/1/edit)中玩它

![在此处输入图像描述](../Images/3eb7f5d4f3014c0c752ab173ad832c1b.png)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-02-27T20:19:53.413

要获得左/右居中，然后`text-align: center`应用于`div`和`margin: auto`。`p`

对于垂直定位，您应该确保您了解这样做的不同方式，这是一个常见的问题：[Vertical alignment of elements in a div](https://stackoverflow.com/questions/79461/vertical-alignment-of-elements-in-a-div)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-09-15T17:04:07.053

♣您应该执行以下步骤：

1.  应该**定位****母元素**（对于EXP，您可以给它位置：相对；）
***   **子元素**应该定位为“绝对**”**并且值应该设置如下：top:0;buttom:0;right:0;left:0; （垂直居中）*   对于**子元素**，您应该设置“**边距：自动**”（垂直居中）*   **孩子和母亲元素**应该有**“高度”和“宽度”**值*   对于**母元素**=>**文本对齐：中心**（水平居中）**

 **♣♣这只是这 5 个步骤的总结：

```
.mother_Element {
    position : relative;
    height : 20%;
    width : 5%;
    text-align : center
    }
.child_Element {
    height : 1.2 em;
    width : 5%;
    margin : auto;
    position : absolute;
    top:0;
    bottom:0;
    left:0;
    right:0;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:27:26.760

您只需添加`text-align: center`到您的`<div>`

在您的情况下，还要删除您添加到`<p>`.

在这里查看演示：http: [//jsfiddle.net/76uGE/3/](http://jsfiddle.net/76uGE/3/)

祝你好运

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T20:45:54.437

**居中和居中的内容？**

这样做：

```
<table style="width:100%">
    <tr>
        <td valign="middle" align="center">Table once ruled centering</td>
    </tr>
</table> 
```

我[在这里摆弄它](http://jsfiddle.net/MLxNV/)

**哈，让我猜猜..你想要DIV ..**

只需让您的第一个外部 DIV 表现得像一个表格单元格，然后使用垂直对齐：中间设置它的样式；

```
<div>
    <p>I want this paragraph to be at the center, but I can't.</p>
</div>

div {
    width:500px;
    height:100px;
    background-color:aqua;
    text-align:center;
    /*  there it is */
    display:table-cell;
    vertical-align:middle;
} 
```

[jsfiddle.net/9Mk64/](http://jsfiddle.net/9Mk64/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-05T19:53:20.980

在 p 元素上，添加 3 条样式规则。

```
.myCenteredPElement{
    margin-left:  auto;
    margin-right: auto;
    text-align: center;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-12T15:06:54.273

此解决方案适用于除 IE 之外的所有主要浏览器。所以记住这一点。

在这个例子中，我基本上使用 UI 元素的定位、水平和垂直变换来使其居中。

```
 .container {
            /* set the the position to relative */
            position: relative;
            width: 30rem;
            height: 20rem;
            background-color: #2196F3;
        }

        .paragh {
            /* set the the position to absolute */
            position: absolute;
            /* set the the position of the helper container into the middle of its space */
            top: 50%;
            left: 50%;
            font-size: 30px;
            /* make sure padding and margin do not disturb the calculation of the center point */
            padding: 0;
            margin: 0;
            /* using centers for the transform */
            transform-origin: center center;
            /* calling calc() function for the calculation to move left and up the element from the center point */
            transform: translateX(calc((100% / 2) * (-1))) translateY(calc((100% / 2) * (-1)));
        }
```

```
<div class="container">
    <p class="paragh">Text</p>
</div>
```

我希望这会有所帮助。**

# php - 控件元素的名称不是 COM“InternetExplorer.Application”对象

> ID：15121347
> 
> 赞同：2
> 
> 时间：2013-02-27T20:07:02.113
> 
> 标签：php, javascript, html, com

我有一个示例页面 (http:// *** *.com/def.php") 代码是：

```
<form action="abc.php" method="POST" name="f_action">
<input type="text" name="id">
<input type="password" name="pwd">
<input type="submit" value="OK" name="action">
</form> 
```

我使用 php 和 COM “InternetExplorer.Application” 对象来填写并提交表单：

```
$Browser = new COM('InternetExplorer.Application');
$Browserhandle = $Browser->HWND;
$Browser->Visible = true;
$f1_url = "http://**.com/def.php";
$Browser->Navigate($f1_url);
sleep(5);
$Browser->Document->f_action->id->focus();
$Browser->Document->f_action->id->value = $p_user_name;
$Browser->Document->f_action->pwd->focus();
$Browser->Document->f_action->pwd->value = $p_user_pwd;
$Browser->Document->f_action->action->focus();
$Browser->Document->f_action->action->click(); 
```

它可以通过名称属性工作且易于使用！但是，如果我将示例页面代码的一部分更改为：

```
<form action="abc.php" method="POST"> 
```

将“name='f_action'”更改为“ **NO name attribute** ”，如何使用COM“InternetExplorer.Application”对象和php填写并提交表单？

谢谢你，对我糟糕的英语感到抱歉。

# apache - 重写 URL 以匹配 Locationmatch

> ID：15121348
> 
> 赞同：3
> 
> 时间：2013-02-27T20:07:03.840
> 
> 标签：apache, rewrite

我需要一些帮助来重写。

有两个规则需要应用： 1\. 基于 HTTP_USER_AGENT 的 RewriteCond 2\. 添加 URL 的路径以匹配 LocationMatch

我现在已经坏了：

```
RewriteCond %{HTTP_USER_AGENT} ^git
RewriteRule ^(.*)$ /git/$1 [L] 
```

删除 RewriteRule 并立即查询路径可以正常工作，但使用此规则运行会导致 apache“无法找到文件”。

匹配是 LocationMatch `<LocationMatch "/git/">`，所以我不确定 RewriteRule 是否可以指向它？

完整配置：

```
<VirtualHost *:80>
DocumentRoot /home/subgit/repos

    <Directory /home/subgit/repos>
        Options       None
        AllowOverride none
        Order         allow,deny
        Allow         from all
    </Directory>

CustomLog /home/subgit/logs/access_log combined
SuexecUserGroup subgit subgit

RewriteEngine On
RewriteCond %{HTTP_USER_AGENT} ^git
RewriteRule ^(.*)$ /git/$1 [L]

RewriteCond %{QUERY_STRING} service=git-receive-pack [OR,NC]
RewriteCond %{REQUEST_URI} ^/git/.*/git-receive-pack$ [NC]
RewriteRule .* - [E=AUTHREQUIRED:yes]

ScriptAlias /git/ /home/subgit/bin/gitolite-suexec-wrapper.sh/

 <LocationMatch "/git/">
    Order Allow,Deny
    Deny from env=AUTHREQUIRED
    Allow from all
    Satisfy Any
    AuthType Basic
    AuthName "subgit"
    AuthBasicProvider file
    AuthUserFile /home/subgit/etc/subgit
    Require valid-user
  </LocationMatch>
</VirtualHost> 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T15:10:06.283

解决方案是使用 [PT] 而不是 [L]。

# css - 当宽度未知时，将图像水平居中并将其垂直放置在 div 内的底部

> ID：15121350
> 
> 赞同：3
> 
> 时间：2013-02-27T20:07:07.363
> 
> 标签：css, position, css-position, alignment

我有一个基于百分比的数字。在那个盒子里，我有一个透明背景的图像。我需要将其水平居中，并将其固定在容器的底部，同时让顶部脱离容器（见图）。

我可以使用绝对定位将其固定在底部并从顶部跳出，但我无法使其居中。当我不知道图像的宽度并且容器的宽度是灵活的时，有没有办法做到这一点？display:table 有可能吗？

![例子](../Images/a525d33bd27a3621f01aeb9282f59bd8.png) 我的代码：

```
<figure class="feature">
<a href="#">
    <img src="image" /> 
    <p class="title-bar">Caption</p>
</a>
</figure>

.figure { position: relative; width: 50%; }
.figure img { position: absolute; bottom: 0; } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T21:34:29.993

你可以用纯 CSS 做到这一点，但你需要两个额外的 div 来保存和定位元素。

这是CSS：

```
.featureHolder {
  position: relative;
  /* height can be anything */
  height: 200px;
}
.feature { 
  margin: 0;
  overflow: visible;
  /* width can be anything */ 
  width: 60%;  
  height: 100px;
  background: #cccccc; 
  position: absolute;
    bottom: 0;
}
.imageHolder { 
  text-align: center;
  width: 100%;
  position: absolute;
    bottom: 0;
}
img {
  margin-bottom: -5px;
} 
```

这是HTML：

```
<div class="featureHolder">
  <figure class="feature">
    <div class="imageHolder">
        <a href="#">
            <img src="img" /> 
        </a>
    </div>
    <a href="#" class="title-bar">Caption</a>
  </figure>
</div> 
```

标题也可以放置在与图像相同的标签内，但在这个例子中它被分开了，所以我不必弄乱它。

这是[JSFiddle](http://jsfiddle.net/deborah/LbHX5/)中的演示- 给 .feature 任何宽度，img 仍应居中。（顺便说一句，您的 CSS 不正确 - 它应该是 'figure' 或 '.feature'，但不能是 '.figure'，因为 figure 是一个类名为 'feature' 的元素。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T15:19:50.833

请检查这个小提琴，有两种变体可以使图像居中

[http://jsfiddle.net/GSKFD/](http://jsfiddle.net/GSKFD/)

标记是一样的

```
<figure>
<a href="">
    <img src="http://placekitten.com/200/300" alt="" />
</a>
</figure> 
```

两种方法的一般风格

```
img{
        vertical-align: bottom;
    } 
```

第一个变体

```
figure{
position: relative;
width: 50%;
height: 300px;
background: #cad;
}
figure a{
    position: absolute;
    bottom: 0;
    left: 50%;
}
figure img{
    position: relative;
    left: -50%;
} 
```

而第二个

```
figure{
    position: relative;
    width: 50%;    
    height: 300px;
    background: #cad;
}
figure a{
    position: absolute;
    width: 100%;
    left: 0;
    bottom: 0;
    text-align: center;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T20:54:46.950

基本上你需要做一个 left: 50% 然后 margin-left: - 无论图像的宽度是什么。这会将它定位在您的相对 div 中。我的示例假设您不知道图像的宽度。

[http://jsfiddle.net/rVRT4/2/](http://jsfiddle.net/rVRT4/2/) [http://jsfiddle.net/rVRT4/2/embedded/result/](http://jsfiddle.net/rVRT4/2/embedded/result/)

```
$(document).ready(function(){
   var width = $(".figure img").width(); 
   $(".figure img").css("margin-left", -(width/2));     
});

.figure { position: relative; width: 50%; height: 500px;}
.figure img { position: absolute; bottom: 0; left:50%;}

<div class="figure">
<a href="#">
    <img src="http://i.stack.imgur.com/4TtEY.jpg" /> 
    <p class="title-bar">Caption</p>
</a>
</div> 
```

# javascript - 在 ExtJS 网格列标题中使用 ListFilter 进行远程过滤

> ID：15121355
> 
> 赞同：12
> 
> 时间：2013-02-27T20:07:18.763
> 
> 标签：javascript, plugins, extjs, filter, grid

我正在使用 ListFilter 插件来过滤 Grid 面板上的结果。列定义是。

```
{
    header: 'Provider',
    filter: {
        type: 'list',
        store: Ext.getStore('MyApp.store.Provider'),
        dataIndex: 'provider_id',
        labelField: 'name'
    }
} 
```

`MyApp.store.Provider`被创建为

```
 Ext.create('Ext.data.Store', {
        storeId: 'MyApp.store.Provider',
        autoDestroy: true,
        autoLoad: {start: 0, limit: 50},
        autoSync: true,
        model: 'MyApp.model.Provider',
        pageSize: 50,
        proxy: {
            type: 'ajax',
            api: {
                create:  'proxy/provider/create',
                read:    'proxy/provider/read',
                update:  'proxy/provider/update',
                destroy: 'proxy/provider/destroy'
            },
            reader: {
                type: 'json',
                root: 'data',
                successProperty: 'success',
                messageProperty: 'message',
                totalProperty: 'total'
            },
            writer: {
                allowSingle: false,
                type: 'json',
                writeAllFields: false,
                root: 'data'
            }
        }
    }); 
```

最后模型`MyApp.model.Provider`定义为

```
Ext.define('MyApp.model.Provider', {
    extend: 'Ext.data.Model',
    fields: [
        { name: 'provider_id', type: 'int'},
        'name',
        { name: 'create_time', type: 'date', dateFormat: appDateFormat },
        { name: 'status', type: 'int'}
    ],
    idProperty: 'provider_id',
    displayProperty: 'name' // A custom property used for dynamically use the property to display
}) 
```

现在此代码不会在过滤器菜单中显示任何子菜单。它只是显示加载。看图片。

![显示加载](../Images/75fa07362f469bda247e8a5c93ac1033.png "悬停在过滤器菜单上显示“正在加载”，它就卡在那里。")

## 更新

我已经使用以下过滤器配置解决了它。这实际上是手动填充`options`配置。所以`store`这里使用 no。

```
{
  type: 'list',
  labelField: 'name',
  options: (function () {
    var opts = [];
    fS.load(function (records, operation, success) {
      for (var i = 0; i < records.length; i++) {
        var ar = {
          id: records[i].get('provider_id'),
          name: records[i].get('name')
        };

        opts.push(ar);
      }
    });
    return opts;
  })(),
  single: true
} 
```

似乎“id”是硬编码的。`id: records[i].get('provider_id'),`看起来不太好。虽然它有效。

但我仍在寻找一种正确的方法来做到这一点。

**注意：**可以在 上找到预期的行为`ExtJS 4.1.1`。看到这个[jsfiddle](http://jsfiddle.net/L8su2/427/)。我已经复制了它。但这同样的事情不起作用`ExtJS 4.0.7`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T07:06:07.330

我自己没有尝试过，但是您需要*使用*默认`idField` **[设置](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.ux.grid.menu.ListMenu-cfg-idField)**为. 所以我想这会起作用：*`id`*

 *```
{
    header: 'Provider',
    filter: {
        type: 'list',
        idField: 'provider_id',
        store: Ext.getStore('MyApp.store.Provider'),
        dataIndex: 'provider_id',
        labelField: 'name'
    }
} 
```

* * *

**更新**

好的，我查看了源代码，现在可以告诉您，这就是答案。因此，在 4.2 发布之前，您必须使用您的 workarround，或者您可以对您的应用进行以下更改以`Ext.ux.grid.menu.ListMenu`使其运行：

添加`idField`具有默认值的 。

在构造函数中查找此行

```
case 'object': options.push([value.id, value[this.labelField]]); break;
// some more lines
fields: ['id', this.labelField], 
```

并将其替换为

```
case 'object': options.push([value[me.idField], value[me.labelField]]); break;
// some more lines
fields: [me.idField, me.labelField], 
```

并在 onLoad 函数中寻找

```
itemValue = records[i].get('id'); 
```

并将其替换为

```
itemValue = records[i].get(me.idField); 
```

差不多就是这样。*

# algorithm - 图中 k 度的 LocalBridge

> ID：15121358
> 
> 赞同：6
> 
> 时间：2013-02-27T20:07:34.213
> 
> 标签：algorithm, data-structures, graph-theory

在 Graph 中找到 localbridge(k) 的最佳算法是什么？度数为 k 的局部桥是一条边，其移除会将其两个端点之间的最短距离扩大到至少 k。

维基百科：[http ://en.wikipedia.org/wiki/Bridge_(interpersonal)#Local_bridge](http://en.wikipedia.org/wiki/Bridge_(interpersonal)#Local_bridge)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-21T16:01:48.193

运行全最短路径成本算法，例如**Floyd-Warshall 算法**，但在距离使用元组`(d1,d2)`而不是典型实数的地方`d`：

*   `d1`是最短路径的长度
*   `d2`是***第二***最短路径的长度

对 Floyd-Warshall 算法的这种修改应该很简单。

当您完成运行所有最短路径成本算法时，`localbridge(k)`边是那些边`e = {u, v}`，使得和`(1,d2)`之间的距离满足。`u``v``d2 >= k`

# email - 国际字符（例如变音字符）在电子邮件地址的本地部分是否有效？

> ID：15121359
> 
> 赞同：21
> 
> 时间：2013-02-27T20:07:43.393
> 
> 标签：email, email-validation, email-address, rfc5322

德语变音符号 (ä, ö, ü) 和 sz 字符 (ß) 在电子邮件地址的本地部分是否有效？

例如采取这个电子邮件地址：`björn.nußbaum@trouble.org`

RFC 5322 非常清楚地表明，元音变音（和其他国际字符）是不允许的。如果我看一下第[3.4.1](https://www.rfc-editor.org/rfc/rfc5322#section-3.4.1)章，关于本地部分有以下内容： `local-part = dot-atom / quoted-string / obs-local-part` 那是什么意思`dot-atom`？它在第[3.2.3](https://www.rfc-editor.org/rfc/rfc5322#section-3.2.3)章中有描述：嗯，长话短说：`Printable US-ASCII characters not including specials`

因此，在整个 RFC 5322 中，我看不到任何有关国际字符的内容。还是 RFC 5322 已经过时了？（[RFC 822](https://www.rfc-editor.org/rfc/rfc822) -> [RFC 2822](https://www.rfc-editor.org/rfc/rfc2822) -> [RFC 5322](https://www.rfc-editor.org/rfc/rfc5322)）

**更新：** 对我来说重要的一点是：**目前的标准是什么？是否允许使用国际字符？** RFC 5322 被标记为草案标准。所以我认为这是最新的来源，不是吗？

Efran 提到，[RFC 5336](https://www.rfc-editor.org/rfc/rfc5336)允许使用国际字符。但是 RFC 5336 被标记为实验性的，所以这对我来说并不有趣。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-01T06:45:33.957

**是**的，只要负责电子邮件地址的邮件交换器支持 RFC 5336 中讨论的[UTF8SMTP 扩展](https://www.rfc-editor.org/rfc/rfc5336#section-3.2)，它们就是有效字符。请注意，只有一小部分邮件交换器支持国际化电子邮件地址。

例如，我们用于 Microsoft .NET的[电子邮件验证组件和我们的](http://cobisi.com/email-validation/.net-component)[REST 电子邮件验证服务](http://verifalia.com/)都允许在电子邮件地址的本地部分使用 UTF8 字符，但如果其相关的邮件交换器不支持上述扩展名，则会将其标记为无效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-17T09:21:54.773

[https://www.rfc-editor.org/rfc/rfc5322#section-3.4.1](https://www.rfc-editor.org/rfc/rfc5322#section-3.4.1)是您最新的标准跟踪参考。通常不建议使用需要引用的字符，因为那里存在大量不符合标准的 MTA。从长远来看，这样的电子邮件势必会丢失。

作为一个友好的建议，这个表格也非常有用（*来自 Jochen Topf，标题为“电子邮件地址的本地部分中的字符”*）：[https ://www.jochentopf.com/email/chars.html](https://www.jochentopf.com/email/chars.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-26T18:03:00.723

看起来 rfc6531 取代了 5336，它是“提议的标准” [https://www.rfc-editor.org/rfc/rfc6531](https://www.rfc-editor.org/rfc/rfc6531)

# c++ - 在 C++ 中为多继承复合类创建设计的指南

> ID：15121365
> 
> 赞同：0
> 
> 时间：2013-02-27T20:07:52.543
> 
> 标签：c++, templates, multiple-inheritance, composition, ambiguity

我打算将此问题作为与我在以下链接中找到的问题相关的更笼统的问题：

[在 C++ 中解决涉及多继承和复合类的设计](https://stackoverflow.com/questions/15075233/solving-design-involving-multiple-inheritance-and-composite-classes-in-c)

我正在使用与 Galaxies 相关的数据集。每个星系的数据将包含有关星系的太阳系、每个太阳系行星和每个行星卫星的信息。

**复合要求：**

仅凭这一点，我想我需要使用复合类设计，在其中为银河系、太阳系、行星和卫星创建一个类。除了这些容器变量的适当成员 getter 和 setter 函数之外，galaxy 类将包含成员容器变量，这些变量包含指向太阳系、行星和卫星的指针。太阳系将有一个类似设计的成员容器变量，其中包含指向包含的行星和卫星的指针，以及 getter 和 setter，等等。

**多重继承要求：**

我为这些类中的每一个使用的输入数据类型不是恒定的。有时我有类型 1 的数据，有时可能是类型 2 的数据。我为任何给定项目所拥有的不同类型的数据可能会随着时间的推移而改变。为了避免拥有一个异常增长的星系类，它为每个项目以及所有旧的（并且可能在当前项目中未使用的）可用的数据类型获取新的成员变量和函数，我想打破星系，solarSystem ，行星和月球类上升为相关的类，每个类专门处理一组数据。

因此，如果我考虑我可用的两个可能的数据集，data1 和 data2，我可以选择为每个数据集创建每个类的特定版本。

我喜欢这种方法，因为如果我有一个需要结合 data1 和 data2 的新项目，我可以为从之前的两种相关类型继承的星系、太阳能系统、行星和月球类创建新类。类似于以下内容。

```
class GalaxyOneTwo: public GalaxyOne, public GalaxyTwo { /* . . .  */ };
class SolarSystemOneTwo: public SolarSystemTwo, public SolarSystemOne{ /* . . . */};
class PlanetOneTwo: public PlanetTwo, public PlanetOne{ /* . . . */ };
class MoonOneTwo: public MoonTwo, public MoonOne{ /* . . . .*/}; 
```

这使我可以访问处理 data1 和 data2 的所有变量和方法，然后我可以进一步定义变量和方法来处理由 data1 和 data2 组合产生的新属性。

**问题：**

这些设计思想、复合需求和多重继承需求中的每一个对我来说都非常有效。但是，我真的很想同时使用两者。两者都使用的困难在于 GalaxyOne 中那些可以访问 SolarSystemOne 指针的容器变量对 GalaxyOneTwo 没有用处，因为 SolarSystemOne 中的指针类型不能访问 SolarSystemOneTwo 的成员函数。

**可能的解决方案：**

*模板*基类- 创建一个模板基类 PrimitiveGalaxy、PrimitiveSolarSystem、PrimitivePlanet、PrimitiveMoon，其中包含所有容器变量以及所有其他类继承的相关 getter 和 setter。这是我在上面发布的链接中使用的方法，可以在那里找到它的问题。

*虚拟基*类- 有人提议我创建一个基类，其中包含所有类型的星系、太阳系、行星和卫星的所有共享功能。这将包括指向相关指针的容器变量以及它们的 getter 和 setter。通过这样做，指针可以用来指向每种类型的基类，只要基类型包含所有必要的后来定义的函数的虚函数，那么我就可以避免将指针转换为更复杂的类型。

我对这种方法的担忧是，它不仅需要为派生类中的每个新函数在基类中编写虚函数，而且并非每个派生类都会在基类中定义每个虚函数。

到目前为止，上述可能的解决方案是我目前唯一理解得足以发布的解决方案。

我想要一个解决方案，它允许灵活的代码，不需要复杂的语法，也不需要每一个不断增长和难以管理的非常大的类定义系列。我的项目经常包含新类型的数据，因此我希望能够轻松地为这些新数据创建新的解析器，并能够使用 Galaxy、SolarSystem、Planet 和 Moon 类轻松地将数据包含到我的各种项目中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:30:42.290

我能够通过使用抽象基类来解决我的问题。抽象基类包含我所有的容器变量以及适当的 getter 和 setter 变量。此外，抽象基类为将在任何派生类中使用的所有方法定义了抽象方法。这些方法被预处理器指令包围，如果还包含定义所述函数的适当头文件，则仅包含那些虚拟函数，这会阻止进一步的抽象类。

```
class Galaxy{
    protected:
       std::vector<SolarSystem*> solarSystems;
    public:
       void addSolarSystem(SolarSystem*);
#ifdef GALAXYONE
virtual void aGalaxyOneMethod()=0;
#endif

#ifdef GALAXYTWO
virtual void aGalaxyTwoMethod()=0;
#endif

#ifdef GALAXYONETWO
virtual void aGalaxyOneTwoMethod()=0;
#endif

enter code here

}; 
```

GalaxyOne.h

```
#define GALAXYONE
class GalaxyOne{
    protected:
        /*Private Variables for GalaxyOne*/
    public:
        void aGalaxyOneMethod(); //No longer abstract
}; 
```

GalaxyTwo.h

```
#define GALAXYTWO
class GalaxyTWO{
    protected:
        /*Private Variables for GalaxyTwo*/
    public:
        void aGalaxyTwoMethod(); //No longer abstract
}; 
```

GalaxyOneTwo.h

```
#define GALAXYONE
#define GALAXYTWO
#define GALAXYONETWO
class GalaxyOneTwo: virtual public GalaxyOne, virtual public GalaxyTwo{
    protected:
        /*Private Variables for GalaxyOneTwo*/
    public:
        void aGalaxyOneTwoMethod(); //No longer abstract
}; 
```

该方案允许创建 GalaxyOneTwo 类型的对象并将其存储在 Galaxy 的指针中，并且仍然可以访问适当的函数。SolarSystems、Planets 和 Moons 使用了类似的策略

# jquery - ajax表单上传加载新页面

> ID：15121370
> 
> 赞同：0
> 
> 时间：2013-02-27T20:08:03.173
> 
> 标签：jquery, ajax, forms, codeigniter, file-upload

昨天我有一个类似的问题 - cud 无法解决问题

我正在上传一个带有文件和其他输入的表单，一切正常。但问题是它正在加载一个新页面，即

```
www.mywebsite.com/controller/function. 
```

这是我的代码

```
<html>
<head>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script> 
<script src="http://malsup.github.com/jquery.form.js"></script> 

<script type="text/javascript">
    $(document).ready(function() {
        var options = { 
            clearForm: true,
            resetForm: true
        };
        // bind 'myForm' and provide a simple callback function 
        $('#myForm').ajaxForm(function() { 
            //alert("Thank you for your comment!"); 

        }); 
        $('#myForm').ajaxForm(options);

    }); 
</script> 

</head>

<body>
<form id="myForm" name="myForm" action="/main/comment" method="post"         enctype="multipart/form-data"> 
    <input type="text" name="name" />
    <br /> 
    <textarea name="comment"></textarea> 
    <br />
    <input type="file" value="Share a Pic" name="file" id="file" />
    <br />
    <input type="submit" value="Submit Comment" /> 
</form>
</body> 
```

我从我的操作中删除了“main/comment”，并在 var 选项部分添加了 url：-

```
var options = { 
            url: "<?php echo site_url().'/main/comment' ?>",
            clearForm: true,
            resetForm: true
        }; 
```

但即使这样似乎也不起作用。请帮忙谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:21:29.127

[如果您按照此处](http://malsup.com/jquery/form/#ajaxForm "here")显示的示例进行操作

我认为你需要这样做：

```
function successFunction(){
    alert('Thank you');
}
$(document).ready(function() {
        var options = { 
            clearForm: true,
            resetForm: true,
            success: successFunction
        };
        $('#myForm').ajaxForm(options);
}); 
```

# php - PHP 标头和 Access-Control_Allow_Origin 错误

> ID：15121371
> 
> 赞同：0
> 
> 时间：2013-02-27T20:08:10.280
> 
> 标签：php, javascript, header, cross-domain

我有两个域，leobee.com 和 txtease.com。我想将 leobee.com 中的 xml 脚本加载到 txtease.com 上的 php 页面中。通过研究 stackoverflow 站点，我能够获得创建以下脚本的信息，但是，我没有看到如何解决此问题。

我已将 php 标头添加到请求脚本中，但出现“Access-Control-Allow-Origin 不允许来源”错误。

你能看看我的剧本，让我知道我哪里出错了吗？测试脚本位于： [http ://txtease.com/crossdomain/scripts/example.html](http://txtease.com/crossdomain/scripts/example.html)

在 chrome/ 或 firebug 控制台中使用： createCORSRequest('GET', ' [http://www.leobee.com/crossdomain/data/data.xml](http://www.leobee.com/crossdomain/data/data.xml) ');

PHP 脚本：

```
 <?php
echo "PHP Running";

header('Access-Control-Allow-Origin: http://www.leobee.com');

?>
<script>
var xhr = new window.XMLHttpRequest();
var string;

function createCORSRequest(method, url) {

  if ("withCredentials" in xhr) {
    // Check if the XMLHttpRequest object has a "withCredentials" property.
    // "withCredentials" only exists on XMLHTTPRequest2 objects.
    xhr.open(method, url, true);
    xhr.send(null);
    string ="with Credentials";
    xhr.onerror = function() {console.log('There was an error!')};
    xhr.onreadystatechange = callbackFunction(string);

  } else if (typeof XDomainRequest != "undefined") {

    xhr = new XDomainRequest();
    xhr.open(method, url);
    xhr.send(null);
    string ="x domain request";
    xhr.onreadystatechange = callbackFunction(string);

  } else if(!"withCredentials" in xhr){

     xhr.open(method, url, true);
     xhr.send(null);
     string ="with no Credentials";
     xhr.onreadystatechange = callbackFunction(string);

  }else {

    // Otherwise, CORS is not supported by the browser.
    alert("cross domain not supported");
    xhr = null;

  }

  return xhr;
}

function callbackFunction(string){

    console.log("Responding function: "+string);
      if (xhr.readyState == 4){
          var responseText = xhr.responseXML;
          console.log("xml string is: "+responseText);

        if (xhr.responseXML ===null){
                responseText=xhr.responseText;
                console.log("html string is: "+responseText);   

        }
      }
    }

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:20:02.107

您正在向具有源`http://www.leobee.com`权限的页面授予从 读取数据的权限`http://txtease.com/scriptExample.php`，但您需要相反。

读取数据的权限必须来自数据来自的*站点*。站点不能授予自己从任意站点读取数据的权限。

* * *

也会`echo "PHP Running";`输出内容。`header`输出内容后不能调用。

# android - 将字符串从对话框片段返回到活动

> ID：15121373
> 
> 赞同：23
> 
> 时间：2013-02-27T20:08:12.213
> 
> 标签：android, dialog

我已经阅读了很多关于这个的帖子，但我找不到任何适用于这个案例的帖子。

我有一个时间选择器对话框，我已将整数值放在一个字符串中，我需要将此字符串恢复为主要活动。

然后，此字符串值将用于设置按钮的文本。

如果有人可以帮助我，将不胜感激。

谢谢

**对话片段**

```
public class TimePickerFragment extends DialogFragment implements TimePickerDialog.OnTimeSetListener {
    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        // Use the current time as the default values for the picker
        final Calendar c = Calendar.getInstance();
        int hour = c.get(Calendar.HOUR_OF_DAY);
        int minute = c.get(Calendar.MINUTE);

        // Create a new instance of TimePickerDialog and return it
        return new TimePickerDialog(getActivity(), this, hour, minute, DateFormat.is24HourFormat(getActivity()));
    }

    public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
        // Do something with the time chosen by the user
        String Time =Integer.toString(hourOfDay) + " : " + Integer.toString(minute);
    }
} 
```

**代码**

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_second);

        Button btn = (Button) findViewById(R.id.start_time_button);
        Button.setText(Time);

    } 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-02-27T20:16:35.943

首选方法是使用回调从`Fragment`. 另外，这是 Android 在[与 Activity 通信时提出的推荐方法](http://developer.android.com/guide/components/fragments.html#CommunicatingWithActivity)

对于您的示例，在您的 中`DialogFragment`，添加一个接口并注册它。

```
public static interface OnCompleteListener {
    public abstract void onComplete(String time);
}

private OnCompleteListener mListener;

// make sure the Activity implemented it
@Override
public void onAttach(Activity activity) {
    super.onAttach(activity); 
    try {
        this.mListener = (OnCompleteListener)activity;
    }
    catch (final ClassCastException e) {
        throw new ClassCastException(activity.toString() + " must implement OnCompleteListener");
    }
} 
```

现在在你的实现这个*接口*`Activity`

```
public class MyActivity extends Activity implements MyDialogFragment.OnCompleteListener {
    //...

    public void onComplete(String time) {
        // After the dialog fragment completes, it calls this callback.
        // use the string here
    }
} 
```

现在在您的 中，当用户单击 OK 按钮时，通过您的回调`DialogFragment`将该值发送回。`Activity`

```
public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
    String time = Integer.toString(hourOfDay) + " : " + Integer.toString(minute);
    this.mListener.onComplete(time);
} 
```

# python - 在 pandas DataFrame 上调用 dropna() 后是否应该更新多索引级别？

> ID：15121377
> 
> 赞同：3
> 
> 时间：2013-02-27T20:08:24.530
> 
> 标签：python, pandas, multi-index

在多索引数据帧上调用 dropna 后，索引中的级别元数据似乎没有更新。这是一个错误吗？

```
In [1]: import pandas

In [2]: print pandas.__version__
0.10.1

In [3]: df_multi = pandas.DataFrame(index=[[1, 2],['a', 'b',]], 
                                    data=[[float('nan'), 5], [6, 7]])

In [4]: print df_multi
      0  1
1 a NaN  5
2 b   6  7

In [5]: df_multi = df_multi.dropna(axis=0, how='any')

In [6]: print df_multi
     0  1
2 b  6  7

In [7]: print df_multi.index
MultiIndex
[(2, b)]

In [8]: print df_multi.index.levels
[Int64Index([1, 2], dtype=int64), Index([a, b], dtype=object)] 
```

请注意，MultiIndex 只有 (2, b)，但它报告 1 和 'a' 在 index.levels 中。

我的解决方法是使用“干净”的多索引重新索引，如下所示：

```
In [10]: c_clean = pandas.MultiIndex.from_tuples(df_multi.index)

In [11]: df_multi = df_multi.reindex(c_clean)

In [12]: print df_multi
     0  1
2 b  6  7

In [13]: print df_multi.index.levels
[Int64Index([2], dtype=int64), Index([b], dtype=object)] 
```

编辑：

在使用 .ix 进行切片期间也会出现此问题，并且可能还会出现其他索引操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T02:32:01.483

这是此处存档的已知情况 [https://github.com/pydata/pandas/issues/2655](https://github.com/pydata/pandas/issues/2655)

人们目前正在考虑如何应对。

我的解决方法是使用`index.get_level_values(level)`，因为 a`dropna(how='all')`可能只删除一些轴但不是全部，但我可能需要多索引的一个级别的所有剩余值。

出于某种原因，返回`index.get_level_values(level)`是正确的，而`index.levels`尚未更新（由于速度原因可能成本太高？）。

# zend-framework2 - 如何路由到多个模块？

> ID：15121378
> 
> 赞同：1
> 
> 时间：2013-02-27T20:08:26.910
> 
> 标签：zend-framework2

[我从https://github.com/zendframework/ZendSkeletonApplication](https://github.com/zendframework/ZendSkeletonApplication)下载了 Skeleton ，它工作正常。一切对我来说都很清楚。

但是当我添加另一个模块时会发生什么？我从骨架中复制模块，更改名称，然后将新模块添加到 application.config.php：

```
return array(
    'modules' => array(
        'Application',
        'Api',
    ),
[...] 
```

并更改 module.config.php 中的路由：

```
return array(
    'router' => array(
        'routes' => array(
            'api' => array(
                'type'    => 'Literal',
                'options' => array(
                    'route'    => 'api/',
                    'defaults' => array(
                        '__NAMESPACE__' => 'Api\Controller',
                        'controller'    => 'Api',
                        'action'        => 'api',
                    ),
                ),
                'may_terminate' => true,
                'child_routes' => array(
                    'default' => array(
                        'type'    => 'Segment',
                        'options' => array(
                            'route'    => '/api[/:action]]',
                            'constraints' => array(
                                'controller' => '[a-zA-Z][a-zA-Z0-9_-]*',
                                'action'     => '[a-zA-Z][a-zA-Z0-9_-]*',
                            ),
                            'defaults' => array(
                            ),
                        ),
                    ),
                ),
            ),
        ),
    ),
    'service_manager' => array(
        'factories' => array(
            'translator' => 'Zend\I18n\Translator\TranslatorServiceFactory',
        ),
    ),
    'translator' => array(
        'locale' => 'en_US',
        'translation_file_patterns' => array(
            array(
                'type'     => 'gettext',
                'base_dir' => __DIR__ . '/../language',
                'pattern'  => '%s.mo',
            ),
        ),
    ),
    'controllers' => array(
        'invokables' => array(
            'Application\Controller\Index' => 'Application\Controller\IndexController',
            'Application\Controller\Auth' => 'Application\Controller\AuthController'
        ),
    ),
    'view_manager' => array(
        'display_not_found_reason' => true,
        'display_exceptions'       => true,
        'doctype'                  => 'HTML5',
        'not_found_template'       => 'error/404',
        'exception_template'       => 'error/index',
        'template_map' => array(
            'layout/layout'           => __DIR__ . '/../view/layout/layout.phtml',
            'application/index/index' => __DIR__ . '/../view/application/index/index.phtml',
            'error/404'               => __DIR__ . '/../view/error/404.phtml',
            'error/index'             => __DIR__ . '/../view/error/index.phtml',
        ),
        'template_path_stack' => array(
            __DIR__ . '/../view',
        ),
    ),
); 
```

但现在我看到了来自 api 的布局，甚至是来自骨架的位置。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:40:12.453

您的所有`module.config.php`文件将合并在一起形成一个大型配置数组。

究竟会发生什么，取决于您在`module.config.php` `routes`数组中使用的名称。

如果您重用已经给出的相同名称（例如，如果`api`您的`Application`模块中已经调用了一个路由），则旧条目将被[覆盖](https://stackoverflow.com/questions/14643102/extending-zfcusers-usercontroller/14665970#14665970)。

哪个路由将用于重定向到正确的控制器、动作和参数也取决于匹配。将按顺序检查定义的所有路由（在所有模块上）。将执行与您当前 URL 匹配的第一个。

在您的情况下，似乎没有任何歧义，因为您将所有内容重命名为`api`（路由名称 + 路由前缀），因此它可以正常工作。当然，您可能还想在其他模块中定义完全不同的较短路由，然后您必须确保它们不会获取应该由后续模块匹配的 URL。

# javascript - Eclipse-Javascript - 原型函数的奇怪行为？

> ID：15121379
> 
> 赞同：0
> 
> 时间：2013-02-27T20:08:31.417
> 
> 标签：javascript, eclipse, prototype

我正在为 JavaScript Web 开发人员使用 Eclipse IDE，操作系统是 Linux Ubuntu。

我创建一个类，然后向原型添加一个函数。

如果在该函数中我访问一个属性并为其分配一个值，Eclipse 会将该函数视为大纲中的一个类。函数 f 被视为 A 的一个方法，但也被视为一个新类。

![函数 f 被视为一个类](../Images/788ccdaeb54ff6471101c1f1245debeb.png)

当我在那个函数中分配时会发生这种情况

```
this.B = 'ccc'; 
```

如果我在构造函数中放入 B 的设置器 (set_B()) 并从函数 f 调用此设置器，而不是直接为 B 分配新值，Eclipse 不会将 f 视为一个类。

![函数 f 不被视为一个类](../Images/4ae575864f3921061b055fff34270f88.png)

如果我以这种方式分配值，一切也都很好：

```
this.B += 1 
```

但是由于使用 '=' 而不是 '+=' 来分配值，因此该函数被视为一个类。

这是正常的还是这是一个错误？

# wordpress - 通过 Beanstalk 部署 Git 会影响 WordPress 上传目录权限吗？

> ID：15121383
> 
> 赞同：0
> 
> 时间：2013-02-27T20:08:35.840
> 
> 标签：wordpress, git, upload, permissions, amazon-elastic-beanstalk

我在本地工作流程中有一个 WP 站点——> git (beanstalk)——> 开发服务器。

部署时一切似乎都运行良好，但我注意到我无法通过 WP 上传图像，这似乎是目录权限问题。

我得到的错误是：“上传的文件无法移动到 /path/blah/blah...

这是因为 FTP 用户不“拥有”这些目录/文件（因为它们不是通过开发服务器的 WP 站点/FTP 帐户创建的？

如果您有任何出色的解决方法或见解，请告诉我。我难住了。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T10:26:41.640

这是因为 Beanstalk 使用 ftp 上传您的文件，这意味着所有者成为 FTP 用户。如果 Wordpress 然后想要访问这些文件，它不是所有者，所以它不能删除/更改它们。`chown apache <filename>`如果您想再次成为 apache (wordpress) 所有者，您可以在 SSH 上使用。但是现在 Beanstalk 出于同样的原因无法覆盖文件。

要走的路是使用 .gitignore 文件来忽略上传和缓存等文件夹。您不需要它们在本地进行开发，如果需要，只需使用 ftp 获取它们一次。

我自己使用[这个](https://gist.github.com/jdbartlett/444295)并添加了一些内容。起初它可能看起来很奇怪，但当一切正常时它就会摇摆不定。:)

# ckeditor - 将富文本和图像从一个文档复制到另一个文档的 MIME

> ID：15121385
> 
> 赞同：7
> 
> 时间：2013-02-27T20:08:46.927
> 
> 标签：ckeditor, xpages, mime

我有一个将富文本内容从一个文档复制到另一个文档中的 MIME 的解决方案。请参阅[http://per.lausten.dk/blog/2012/12/xpages-dynamically-updating-rich-text-content-in-a-ckeditor.html](http://per.lausten.dk/blog/2012/12/xpages-dynamically-updating-rich-text-content-in-a-ckeditor.html)。我在应用程序中使用它作为用户在新文档中插入内容模板并使内容即时显示在 CKEditor 中的一种方式。

问题是内联图像不包含在复制中 - 只是对图像临时存储的引用。这意味着图像仅对当前会话中的当前用户可见。所以不是很有用。

如何包含图像？

**2013 年 10 月 4 日更新：** 我仍在寻找解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-11T22:32:56.100

我终于搞定了。它要简单得多，甚至不涉及 MIME。诀窍是修改工作 HTML 中的图像标签以包含 base64 编码的图像，以便 src 标签可以使用这种格式（此处以 gif 为例）：

```
src="data:image/gif;base64,<base64 encoded image>" 
```

我已经有了从富文本字段中获取 HTML 所需的代码（请参阅我的问题中已经提到的[博客文章）。](http://per.lausten.dk/blog/2012/12/xpages-dynamically-updating-rich-text-content-in-a-ckeditor.html)所以我需要的只是用正确的 src 格式替换图像 src 标签，包括 base64 编码的图像。

以下代码获取 HTML 并遍历每个包含的图像并修改 src 标记：

```
String html = this.document.getValue(fieldName).toString();
if (null != html) {
    final List<FileRowData> fileRowDataList = document.getEmbeddedImagesList(fieldName);
    if (null != fileRowDataList) {
        final Matcher matcher = imgRegExp.matcher(html);
        while (matcher.find()) {
            String src = matcher.group();
            final String srcToken = "src=\"";
            final int x = src.indexOf(srcToken);
            final int y = src.indexOf("\"", x + srcToken.length());
            final String srcText = src.substring(x + srcToken.length(), y);
            for (FileRowData fileRowData : fileRowDataList) {
                final String srcImage = fileRowData.getHref();
                final String cidImage = ((AttachmentValueHolder) fileRowData).getCID();
                final String typeImage = ((AttachmentValueHolder) fileRowData).getType();
                final String persistentName = ((AttachmentValueHolder) fileRowData).getPersistentName();

                // Add base 64 image inline (src="data:image/gif;base64,<name>")
                if (srcText.endsWith(srcImage)) {
                    final String newSrc = src.replace(srcText, "data:" + typeImage + ";base64," + getBase64(persistentName));
                    html = html.replace(src, newSrc);
                }
            }
        }
    }
} 
```

下面是 base64 编码图像的 getBase64() 方法：

```
private String getBase64(final String fileName) {
    String returnText = "";
    try {
        BASE64Encoder base64Enc = new BASE64Encoder();
        ByteArrayOutputStream output = new ByteArrayOutputStream();
        base64Enc.encode(this.getEmbeddedImageStream(fileName), output);
        returnText = output.toString();
    } catch (NotesException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    return returnText;
} 
```

一些代码来自[Tony McGuckin 的 emailBean](http://openntf.org/XSnippets.nsf/snippet.xsp?id=emailbean-send-dominodocument-html-emails-cw-embedded-images-attachments-custom-headerfooter)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:22:14.107

您能否通过 DominoDocument.AttachmentValueHolder 获得内联图像的句柄，请参阅[http://public.dhe.ibm.com/software/dw/lotus/Domino-Designer/JavaDocs/XPagesExtAPI/8.5.2/com/ibm/ xsp/model/domino/wrapped/DominoDocument.AttachmentValueHolder.html](http://public.dhe.ibm.com/software/dw/lotus/Domino-Designer/JavaDocs/XPagesExtAPI/8.5.2/com/ibm/xsp/model/domino/wrapped/DominoDocument.AttachmentValueHolder.html)

我在笔记文档中写了关于附件的博客，请参阅[http://www.domino-weblog.nl/weblogs/Domino_Blog.nsf/dx/xpages-tip-get-easily-access-to-your-attachments-in-java.htm](http://www.domino-weblog.nl/weblogs/Domino_Blog.nsf/dx/xpages-tip-get-easily-access-to-your-attachments-in-java.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-08T14:07:37.673

可怕的 hack（您需要整理身份验证和服务器名称）

SSJS（从视图中获取源代码）

```
var unid = curRow.getUniversalID();
var body = getComponent("body1");
var magic = new demo.HTMLMagic();
magic.doMagic(database, unid, body); 
```

爪哇

```
package demo;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.List;
import org.apache.http.HttpHost;
import org.apache.http.HttpResponse;
import org.apache.http.HttpVersion;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.conn.ClientConnectionManager;
import org.apache.http.conn.scheme.PlainSocketFactory;
import org.apache.http.conn.scheme.Scheme;
import org.apache.http.conn.scheme.SchemeRegistry;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.impl.conn.tsccm.ThreadSafeClientConnManager;
import org.apache.http.params.BasicHttpParams;
import org.apache.http.params.HttpParams;
import org.apache.http.params.HttpProtocolParams;

import net.htmlparser.jericho.Attribute;
import net.htmlparser.jericho.Attributes;
import net.htmlparser.jericho.HTMLElementName;
import net.htmlparser.jericho.OutputDocument;
import net.htmlparser.jericho.Source;
import net.htmlparser.jericho.StartTag;
import lotus.domino.Database;
import lotus.domino.NotesException;

import com.ibm.misc.BASE64Encoder;
import com.ibm.xsp.component.xp.XspInputRichText;
import com.ibm.xsp.http.IMimeMultipart;
import com.ibm.xsp.model.domino.wrapped.DominoRichTextItem;

public class HTMLMagic {

private HttpClient          httpClient  = null;
private HttpHost            httpHost    = null;
//TODO: that needs to be resolved smarter
private static final String HOSTNAME    = "localhost";

public void doMagic(final Database database, final String unid, final XspInputRichText body) throws NotesException,
        ClientProtocolException, IOException {
    final String docURL = "http://" + HOSTNAME + "/__" + database.getReplicaID() + ".nsf/0/" + unid + "/Body?OpenField";
    final String fixedHTML = this.fixHTML(docURL);
    IMimeMultipart result = DominoRichTextItem.convertToMime("-- copied text--<br />" + fixedHTML);
    body.setValue(result);
}

private String fixHTML(final String rawHTMLstring) throws ClientProtocolException, IOException {
    HttpHost target = this.getHttpHost();
    HttpClient client = this.getHttpClient();
    HttpGet get = new HttpGet(rawHTMLstring);
    HttpResponse response = client.execute(target, get);
    InputStream data = response.getEntity().getContent();
    Source rawHTML = new Source(data);
    OutputDocument outputDocument = new OutputDocument(rawHTML);
    StringBuilder sb = new StringBuilder();
    String tagName = HTMLElementName.IMG;
    String attName = "src";
    List<StartTag> links = rawHTML.getAllStartTags(tagName);

    for (StartTag onelink : links) {
        String href = onelink.getAttributeValue(attName);
        if (href != null) {
            String replace = this.urltoData(href);
            if (replace != null) {
                sb.setLength(0);
                sb.append("<");
                sb.append(tagName);
                sb.append(" ");
                sb.append(attName);
                sb.append("=\"");
                sb.append(replace);
                sb.append("\"");
                Attributes atts = onelink.getAttributes();
                if (!atts.isEmpty()) {
                    for (int i = 0; i < atts.size(); i++) {
                        Attribute att = atts.get(i);
                        if (!att.getName().equals(attName)) {
                            sb.append(" ");
                            sb.append(att.getName());
                            sb.append("=\"");
                            sb.append(att.getValue());
                            sb.append("\" ");
                        }
                    }
                }
                sb.append(">");
                outputDocument.replace(onelink, sb.toString());
            }
        }
    }
    return outputDocument.toString();
}

private HttpClient getHttpClient() {

    if (this.httpClient == null) {

        // general setup
        SchemeRegistry supportedSchemes = new SchemeRegistry();

        // Register the "http" protocol scheme, it is required
        // by the default operator to look up socket factories.
        supportedSchemes.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));

        // prepare parameters
        HttpParams params = new BasicHttpParams();
        HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
        HttpProtocolParams.setContentCharset(params, "UTF-8");
        HttpProtocolParams.setUseExpectContinue(params, true);

        ClientConnectionManager connMgr = new ThreadSafeClientConnManager(params, supportedSchemes);
        this.httpClient = new DefaultHttpClient(connMgr, params);
    }
    return this.httpClient;
}

private HttpHost getHttpHost() {
    if (this.httpHost == null) {

        this.httpHost = new HttpHost(HOSTNAME, 80, "http");
    }
    return this.httpHost;
}

private String urltoData(final String href) throws ClientProtocolException, IOException {
    StringBuilder sb = new StringBuilder();
    sb.append("data:image/");
    sb.append(href.substring(href.lastIndexOf("FieldElemFormat=") + 1));
    sb.append(";base64,");

    // Here go the Image data
    HttpHost target = this.getHttpHost();
    HttpClient client = this.getHttpClient();
    HttpGet get = new HttpGet(href);
    HttpResponse response = client.execute(target, get);
    InputStream data = response.getEntity().getContent();

    BASE64Encoder encoder = new BASE64Encoder();
    OutputStream output = new ByteArrayOutputStream();
    encoder.encode(data, output);
    sb.append(output.toString());
    output.close();

    return sb.toString();
}

} 
```

如果这对你有用，我会很好奇。Notes 客户端无法显示内联 HTML 图像

# linux - 汇编写入标准输出

> ID：15121387
> 
> 赞同：1
> 
> 时间：2013-02-27T20:09:00.407
> 
> 标签：linux, assembly, x86

我正在尝试使用以下方法将 4 个字节写入屏幕：

```
nasm -f elf -g ****.asm 
```

什么都没有发生。

这是相关的代码段：

```
mov     eax, 4             ; ow print error mesg
mov     ebx, 1
mov     ecx, DWORD [para]
mov     edx, 4
int     080h 
```

这是我的那部分代码的调试运行。没有打印任何内容，我正在向您展示`$ecx`via gdb 的内容。

```
253             mov     eax, 4             ; ow print error mesg
(gdb)
254             mov     ebx, 1
(gdb)
255             mov     ecx, DWORD [para]
(gdb)
256             mov     edx, 4
(gdb)
257             int     080h
(gdb) p /t $ecx
$1 = 1100001010101001000010110000010
(gdb) step 
```

不知道我做错了什么。从这里和其他网站上以前的帖子中，我看不出与接受的方法有差异。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T21:22:41.137

para 的正常值是多少？

我有一个旧代码，我不只使用 DWORD

```
mov     ecx, [para] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T21:26:37.780

`ecx`想要打印文本的地址。除非`para`是“指针”（保存文本的地址），否则`mov ecx, para`可能是正确的。严格来说，`ebx`可能想要 2 (stderr)，但我怀疑这是否是你的问题。给我们看`para`！

# php - PHP 防止同时执行函数（通过 PHP 限制）

> ID：15121389
> 
> 赞同：2
> 
> 时间：2013-02-27T20:09:04.930
> 
> 标签：php, multithreading, concurrency, call, throttling

我有一个通过 CURL 向 www.server.com 发送 HTTP 请求的函数

我的任务是确保 www.server.com 每 2 秒收到不超过一个请求。

可能的解决方案：

创建一个函数`checktime()`，将当前调用时间存储在数据库中，并在每次下一次调用时检查数据库，并使系统暂停 2 秒：

```
$oldTime = $this->getTimeFromDatabase();
if ($oldTime < (time() - 2) ) { // if its been 2 seconds
  $this->setNewTimeInDatabase(); 
  return true;
} else {
  sleep(2);
  return false;
} 
```

**问题/问题：**

可以说，对 www.server.com 的最后一次请求是在 1361951000 上。然后其他 10 个用户尝试在 1361951001 上进行请求（1 秒后）。`checktime()`函数将被调用。

因为它只有 1 秒，所以该函数将返回 false。所有 10 个用户将等待 2 秒。是不是意味着1361951003上会同时发送10个请求？并且是否有可能由于 $this->setNewTimeInDatabase() 中未接来电，数据库中最后一次请求的时间不会改变`checktime()`？

谢谢！

**更新：**

我刚刚被告知使用循环可能会解决问题：

```
for($i=0;$i<300;$i++)
{
   $oldTime = $this->getTimeFromDatabase();
   if ($oldTime < (time() - 2) ) { // if its been 2 seconds
   $this->setNewTimeInDatabase(); 
   return true;
   } else {
    sleep(2);
    return false;
   }
} 
```

但我真的没有看到其中的逻辑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:34:36.070

我相信你需要一些[信号量](http://en.wikipedia.org/wiki/Semaphore_%28programming%29)的实现。只要您可以保证只有一个线程可以写入数据库然后发出请求，数据库就可以工作。

例如，您可以对数据库使用更新请求，然后检查更新的行（以检查更新是否实际发生）。如果更新成功，您可以假设您获得了互斥锁，然后发出请求（假设时间合适）。像这样的东西：

```
$oldTime = $this->getTimeFromDatabase();
if ($oldTime < (time() - 2) && $this->getLock()) { // if its been 2 seconds
  $this->setNewTimeInDatabase(); 
  $this->releaseLock();
  return true;
} else {
  sleep(2);
  return false;
}  

function getLock()
{
    return $mysqli->query('UPDATE locktable set locked = 1 WHERE locked = 0');
}

function releaseLock()
{
     $mysqli->query('UPDATE locktable set locked = 0');
} 
```

我不确定 mysql 的功能，但我相信可以大致了解一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:26:27.700

小心使用数据库。例如 MySQL 并不总是 100% 与它的会话同步，因此依赖它来锁定是不安全的。

您可以通过方法[flock](http://php.net/manual/de/function.flock.php)使用文件锁，您可以在其中保存访问时间。然后您可以确保锁定文件，因此不会有两个或更多进程同时访问它。

它可能会是这样的：

```
$filepath = "lockfile_for_source";
touch($filepath);
$fp = fopen("lockfile_for_resource", "r") or die("Could not open file.");

while(true){
  while(!flock($fp, LOCK_EX)){
    sleep(0.25); //wait to get file-lock.
  }

  $time = file_get_contents($filepath);
  $diff = time() - $time;
  if ($diff >= 2){
    break;
  }else{
    flock($fp, LOCK_UN);
  }
}

//Following code would never be executed simultaneously by two scripts.
//You should access and use your resource here.

fwrite($fp, time());
fflush($fp);
flock($fp, LOCK_UN); //remove lock on file.
fclose($fp); 
```

请注意，我没有测试过代码。

# sql - sql 查询更新 INNER JOINED 表

> ID：15121397
> 
> 赞同：2
> 
> 时间：2013-02-27T20:09:42.560
> 
> 标签：sql

我在我的 2 个表中使用 INNER JOIN，即 GuestInfo 和 Reservation

```
select  RoomNo, DateStart, DateEnd, GuestFName, GuestMName, GuestLName
from GuestInfo inner join Reservation
on GuestInfo.GuestID = Reservation.GuestID 
```

现在，我想更新那个 INNER JOINED TABLE

```
update (select  RoomNo, DateStart, DateEnd, GuestFName, GuestMName, GuestLName
from GuestInfo inner join Reservation
on GuestInfo.GuestID = Reservation.GuestID) set EndDate = '1/20/2014'
where GuestFName = 'JAKE' 
```

但这个查询是错误的。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T20:14:20.427

根据您的数据库，您应该能够使用与此类似的东西。

SQL 服务器：

```
update r
set r.DateEnd = '2014-01-20' 
from Reservation r
inner join GuestInfo g
    on g.GuestID = r.GuestID 
where g.GuestFName = 'JAKE' 
```

MySQL：

```
update Reservation r
inner join GuestInfo g
    on g.GuestID = r.GuestID 
set r.DateEnd = '2014-01-20' 
where g.GuestFName = 'JAKE' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:16:09.173

以下语法应适用于任何数据库：

```
update reservation
    set enddate = '1/20/2014'
    where guestid in (select guestId from guestinfo where guestfname = 'Jake') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:17:35.000

如果我理解正确，您可以使用：

```
update reservation 
set EndDate = '1/20/2014'
where GuestID in (select GuestID
     from GuestInfo inner join Reservation
     on GuestInfo.GuestID = Reservation.GuestID 
     and GuestFName = 'JAKE') 
```

# javascript - Concat JS不工作

> ID：15121398
> 
> 赞同：8
> 
> 时间：2013-02-27T20:09:47.800
> 
> 标签：javascript, string, concat

```
var myjson = '{"name": "cluster","children": [';

for (var i = 0; i < unique.length; i++)
{
    var uniquepart = '{"' + unique[i] + '"';
    myjson.concat(uniquepart); 
    var sizepart = ', "size:"';
    myjson.concat(sizepart);
    var countpart = count[i] + '';
    myjson.concat(countpart);
    if (i == unique.length) {
        myjson.concat(" },");
    }
    else {
        myjson.concat(" }");
    }
} 

var ending = "]}";
myjson.concat(ending);

console.log(myjson); 
```

有谁知道为什么这个字符串不能正确连接，我仍然得到原始值？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-27T20:13:20.113

该`concat()`方法用于连接两个或多个字符串。

**定义和用法**
此方法不会更改现有字符串，而是返回一个包含连接字符串文本的新字符串。
参考：[http ://www.w3schools.com/jsref/jsref_concat_string.asp](http://www.w3schools.com/jsref/jsref_concat_string.asp)

例如：

```
myjson = myjson.concat(uniquepart); 
```

或者

```
myjson += uniquepart; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-27T20:12:02.003

javascript 字符串是不可变的，因此`concat`只能返回一个新值，而不能更改初始值。如果要附加到作为变量的字符串，只需使用

```
myjson += "some addition"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:11:18.303

字符串是不可变的。

`.concat()`返回一个您忽略的**新**字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T20:11:34.437

[`string.concat()`](http://www.w3schools.com/jsref/jsref_concat_string.asp)不修改原始字符串，而是返回一个新字符串。

为了修改它，您需要执行：

```
string = string.concat('fragment'); 
```

# java - JVM 同步的 finally 块

> ID：15121402
> 
> 赞同：7
> 
> 时间：2013-02-27T20:10:08.420
> 
> 标签：java, multithreading, jvm, synchronized, try-finally

查看[Java 虚拟机规范](http://docs.oracle.com/javase/specs/jvms/se7/html/index.html)和编译代码告诉我们如何在 java 中实现[“同步”](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html#jvms-2.11.10)块。以下代码：

```
public void testSync()
{
    Object obj = getSomeObject();
    synchronized (obj) { doSomething(); }
} 
```

...大致相当于这个伪代码：

```
public void testSync()
{
    Object obj = getSomeObject();
    Object __temp = obj;
    monitorenter __temp;
    try { doSomething(); }
    finally { monitorexit __temp; }
} 
```

...除了一个例外。

出于某种原因，异常表显示了两个 finally 处理程序。例如：

```
 Exception table:
     from    to  target type
        12    20    23   any
        23    25    23   any 
```

第一个处理程序是我期望的，但第二个处理程序实际上是用于第一个处理程序的 finally 块，如果它捕获到异常，它会执行相同的处理程序。您可以通过以下方式将其可视化：

```
try { doSomething(); }
finally { beginTry: try { monitorexit __temp; } finally { goto beginTry; } } 
```

有人知道这是为什么吗？如果它只是 finally 块，则表中的第二个条目将不存在。此外，如果 finally 块已经抛出异常，我看不出有任何可能的原因要再次执行它。

谢谢，布兰登

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:26:03.923

如果在反复尝试释放监视器失败和继续不释放监视器之间进行选择，两种选择都会导致死锁；只是如果您在不释放的情况下继续进行，那么直到下一次尝试获取监视器时才会发生死锁，并且该问题可能与最初的失败相去甚远。同样尝试释放监视器可能最终会奏效，而让监视器未释放是一定的灾难。所以你最好重试。

# php - 使用 PHP AJAX jQuery 表单在文本文件中查找完全匹配

> ID：15121403
> 
> 赞同：2
> 
> 时间：2013-02-27T20:10:08.303
> 
> 标签：php, jquery, ajax, forms

我有一个 .txt 文件，我想在其中找到与表单中输入的单个电子邮件完全匹配的内容。

我使用的当前指令（见下文）适用于标准形式。但是当我将它与 AJAX 调用和 jQuery 结合使用时，它会通过查找第一次出现来确认它的存在。

例如：

如果该人输入“bobby@”，则表示未找到，很好。

如果有人输入他们的完整电子邮件地址并且它存在于文件中，它会显示“找到”，非常好。

现在，如果有人只输入“bobby”，它会说“找到”，不好。

我在下面使用了以下三个示例，结果相同。

```
if ( !preg_match("/\b{$email}\b/i", $emails )) {

echo "Sorry, not found";

} 
```

和...

```
if ( !preg_match( "/(?:^|\W){$email}(?:\W|$)/", $emails )) {

echo "Sorry, not found";

} 
```

和...

```
if ( !preg_match('/^'.$email.'$/', $emails )) {

echo "Sorry, not found";

} 
```

我的 AJAX

```
$.ajax({  
type: "POST",  
url: "email_if_exist.php",  
data: "email="+ usr,
success: function(msg){ 
```

我的文本文件

```
Bobby Brown bobby@somewhere.com
Guy Slim guy@somewhere.com
Slim Jim slim@somewhere.com 
```

我曾想过使用 jQuery 函数只接受完整的电子邮件地址，但没有成功，部分原因是我不知道将它放在脚本中的哪个位置。

我花了很多时间寻找解决方案，现在我正在寻求一些帮助。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:16:11.730

因为您的文本文件中包含“bobby”，所以您建议的任何正则表达式都将始终找到“bobby”。我建议在运行正则表达式之前检查 @ 符号的存在，因为任何有效的电子邮件都将始终包含 @。尝试这样的事情：

```
if (strpos($email,'@')) {
    if ( !preg_match("/\b{$email}\b/i", $emails )) {
        echo "Sorry, not found";
    }
} 
```

**编辑：** 4年后看这个......我会让正则表达式匹配到行尾，使用`m`修饰符指定多行以便`$`匹配换行符或EOF。PHP 行将是：

```
if ( !preg_match("/\b{$email}$/im", $emails )) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-18T18:22:00.093

如果您只是检查用户是否存在，这应该可以：

```
$users = trim(preg_replace('/\s\s+/', ' ', $users));
$userArray = explode(' ', $users);
$exists = in_array($email, $userArray); 
```

在哪里`$users`引用示例文件并`$email`引用查询的电子邮件。

这会将所有换行符（和双空格）替换为空格，然后按空格拆分为一个数组，然后，如果该电子邮件存在于该数组中，则该用户存在。

希望我有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-21T10:53:55.530

如果您的文本文件中的每一行都以电子邮件结尾，

因此您可以通过“电子邮件+结束行”进行正则表达式测试和匹配

像那样：

```
if( preg_match("/.+{$email}[\n|\r\n|\r]/", $textFileEmails) ) 
{
     /// code
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-18T13:15:33.733

如果您的文件被格式化为您的示例`first_name, last_name, email@address.tdl` ，那么在加载搜索时很容易将其分解。

`preg_match`如果建议您`preg`使用它来验证电子邮件地址，我不知道您为什么要使用它。您最好使用`indexOf`php ( `strpos`) 中的方法来搜索文件，但以下方法适用于您的固定文件格式。

**面向对象的文件阅读器和搜索器**

```
class Search{
    private $users = array();
    public function __construct($password_file){
        $file = file_get_contents($password_file);
        $lines = explode("\n", $file);
        $users = array();
        foreach($lines as $line){
            $users = expode(" ", $line);
        }
        foreach($users as $user){
            $this->users[] = array("first_name" => $user[0], "last_name" => $user[1], "email" => $user[2])
        }
    }

    public function searchByEmail($email){
        foreach($this->users as $key => $user){
            if($user['email'] == $email){
                    // return user array
                    return $user;
                    // or you could return user id
                    //return $key;
            }
        }
        return false;
    }
} 
```

然后使用

```
$search = new Search($passwdFile);
$user = $search->searchByEmail($_POST['email']);
echo ($user)? "found":"Sorry, not found"; 
```

**用于`preg_match`验证电子邮件然后检查**

如果你想使用 preg 和你自己的文件搜索系统。

```
function validateEmail($email) {
    $v = "/[a-zA-Z0-9_-.+]+@[a-zA-Z0-9-]+.[a-zA-Z]+/";

    return (bool)preg_match($v, $email);
} 
```

然后像

```
if(validateEmail($_POST['email'])){
    echo (strpos($_POST['email'], $emails) !== false)? "found":"Sorry, not found";
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-21T23:39:54.193

该代码将首先使用 php 核心函数**验证**电子邮件是否正确，然后**检查**是否**出现**。

```
$email = 'bobby@somewhere.com';
$found = false;
//PHP has a built-in function to validate an email 
if(filter_var($email, FILTER_VALIDATE_EMAIL)){
    //Grab lines from the file
    $lines = file('myfile.txt', FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);
    foreach ($lines as $line) {
        //Grab words from the line
        $words = explode(" ", $line);
        //If email found within the words set the flag as true.
        if(in_array($email, $words)) {
            $found = true;
            //If the aim is only to find the email, we can break out here.
            break;
        }
    }
}
if(false === $found) {
    echo 'Not found!';
} else {
    echo 'Found you!';
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-21T07:42:43.573

'/^'.$email.'$/' 非常接近。由于您希望仅当完整的电子邮件地址在文件中时检查为“真”，所以您应该在模式中包含电子邮件的“限制”： 之前的空格和之后的 end_of_the_line 如果：

```
'/ '.$email.'$/' 
```

（是的，我刚刚将 ^ -start of line- 更改为空格）

# python - 线程或进程

> ID：15121405
> 
> 赞同：0
> 
> 时间：2013-02-27T20:10:09.983
> 
> 标签：python, python-3.x

我基本上在写端口扫描器（不是真的，但它很接近）。一台一台地 ping 机器很慢，所以我肯定需要某种并行处理。瓶颈绝对是网络 I/O，所以我认为线程就足够了（存在 python 的 GIL），它们更容易使用。但是，使用流程会带来显着的性能提升（15%+）吗？

可悲的是，我没有时间尝试这两种方法并根据一些测量或其他东西选择更好的方法：/

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:17:55.477

如果您没有时间等待性能测试，您可能只想猜测。所以：

`multiprocessing`在这里可能没有真正的优势`threading`。

每个任务的开销有一个缺点`multiprocessing`。您可以通过调整批量大小来解决这个问题，但使用`threading`，您不必这样做。

所以，我会使用线程。

但是，我会使用`concurrent.futures.ThreadPoolExecutor`，所以当您稍后有时间时，您可以尝试单行更改`ProcessPoolExecutor`并比较性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:18:16.157

我想我会把它作为一个潜在的答案发布。
我用过，比如 Gevent，但另一个库也可以。

这取自 Gevent 的网站

```
import gevent
from gevent import socket
urls = ['www.google.com', 'www.example.com', 'www.python.org']
jobs = [gevent.spawn(socket.gethostbyname, url) for url in urls]
gevent.joinall(jobs, timeout=2)
[job.value for job in jobs] 
```

> ['74.125.79.106', '208.77.188.166', '82.94.164.162']

这将为您提供一种并发方法，而无需线程/进程的开销 =)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:16:54.313

一般来说，您希望[多处理](http://docs.python.org/2/library/multiprocessing.html)模块在处理中利用额外的 CPU 内核。由于每个进程都有自己的 GIL，因此它们可以进行 CPU 密集型调用，而无需考虑任何特定调用是否会在其持续时间内锁定 GIL。

从编程的角度来看，主要的缺点是共享内存要少得多。实际上，您只能使用共享对象（例如`multiprocessing.Array`或）发送数据`multiprocessing.Value`。而且由于共享的内存太少，每次创建另一个实例时，您的内存占用量就会增加一倍。

线程可能是一个可行的选择，但如果您想要最大效率，您应该使用异步方法。有许多用于异步网络 I/O 的框架，尽管最著名的可能是[Twisted](http://twistedmatrix.com/trac/)。

# java - android中的主机名可能不是空错误

> ID：15121407
> 
> 赞同：1
> 
> 时间：2013-02-27T20:10:21.090
> 
> 标签：java, android, http-post

我在我的 Android 应用程序中收到错误“主机名可能不是空错误”。

这是我的代码：

```
DefaultHttpClient httpclient = new DefaultHttpClient();
HttpPost httpost = new HttpPost("http://sub_domain.domain.com/service/api");
httpost.setHeader("Accept", "application/json");
httpost.setHeader("Content-type", "application/json");
ResponseHandler responseHandler = new BasicResponseHandler();
    try {
        httpclient.execute(httpost, responseHandler);
    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

我使用了一个子域，所以我不能在我的 url 中输入“www”，因为它是另一个子域。我的清单文件中有 Internet 权限。

有什么建议么？谢谢！

编辑：使用 GET 方法无法访问此 url。

在我的子域中没有“_”，没关系。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-30T13:55:40.857

看这个链接。Apache 不支持下划线

[https://issues.apache.org/jira/browse/HTTPCLIENT-911](https://issues.apache.org/jira/browse/HTTPCLIENT-911)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-23T13:07:50.497

当我的网络连接在我的应用程序运行过程中关闭时，我遇到了类似的错误。我使用了异步任务并且当异步任务没有找到链接时，/它给出了类似的窗口泄漏结果。

# ruby - 在 Rails 中，Ldap gem 未抛出与服务器异常的连接

> ID：15121413
> 
> 赞同：2
> 
> 时间：2013-02-27T20:10:44.083
> 
> 标签：ruby, ruby-on-rails-3, ldap, opends

尝试从 Rails 中的模块建立连接，但没有连接到服务器。我已经在 Rails 之外测试了相同的代码，它工作正常。

```
require 'rubygems'
require 'net-ldap'

module Foo
  module Bar
    class User

    attr_reader :ldap_connection

    def initialize
      @ldap = Net::LDAP.new(:host => "<ip-number>", :port => 389)
      @treebase = "ou=People, dc=foo, dc=bar"
      username = "cn=Manager"
      password = "password"
      @ldap.auth username, password

      begin
        if @ldap.bind
          @ldap_connection = true
        else
          @ldap_connection = false
        end
        rescue Net::LDAP::LdapError
          @ldap_connection = false
        end
      end 
    end
  end
end 
```

得到`Net::LDAP::LdapError: no connection to server`异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T11:24:37.747

我找到了解决 Rails 中自动加载问题的解决方案/解决方法。添加了一个新的初始化程序以确保 lib/ 下的所有 Ruby 文件都需要：

添加`config/initializers/require_files_in_lib.rb`了此代码

```
Dir[Rails.root + 'lib/**/*.rb'].each do |file|
    require file
end 
```

阅读有关解决方法的更多信息：[Rails 3 library not loading until require](https://stackoverflow.com/questions/4235782/rails-3-library-not-loading-until-require)

# gdb - gdb ：查找每个跳转到一个地址

> ID：15121416
> 
> 赞同：1
> 
> 时间：2013-02-27T20:10:52.007
> 
> 标签：gdb, memory-address, disassembly

我正在尝试使用 gdb 理解一个小型二进制文件，但有些东西我找不到实现的方法：如何找到指向指定地址的跳转列表？我在反汇编代码中有一小部分指令，我想知道它在哪里被调用。一开始是想在.text中搜索对应的指令，但是由于跳转的种类很多，而且地址可以是相对的，所以这行不通。

有没有办法做到这一点？

或者，如果我在这个地址上放一个断点，有没有办法知道上一条指令的地址（在这种情况下是跳转）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T08:41:53.127

如果这是从其他地方调用的某个*子例程*，那么它在被调用时必须遵守某些 ABI。根据所使用的 CPU，返回地址（以及因此调用它的位置）将存储在某处（在堆栈或某些寄存器中）。如果将原始代码替换为检查此代码的代码，则可以创建返回地址列表。或者更简单，如您所建议的，如果您使用 gdb 并在该例程处放置一个断点，您可以通过使用 bt 命令从调用它的位置查看。

如果是实际跳转（相对于“跳转到子程序”）将您带到那里（我怀疑，如果它是从很多地方调用的，除非它是一种 longjmp/setjmp），那么您可能无法确定在哪里这是从那里调用的，除非您使用的 CPU 允许您以某种方式跟踪执行。

# twitter-bootstrap - 有没有办法防止响应式引导程序占用太多宽度？

> ID：15121417
> 
> 赞同：0
> 
> 时间：2013-02-27T20:10:55.443
> 
> 标签：twitter-bootstrap, responsive-design

我想使用引导程序的响应功能，但不适用于> 1200px 的布局。

在宽度 > 1200px 的设备上，它应该与设备尺寸一样。

这是否可以调整元视口或添加一些 css 以使最大设备宽度为 1200px ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T04:36:33.980

**自定义 Bootstrap**
最好的方法是根据您的需要下载自定义版本。下面的页面将带您自定义页面，您可以在响应部分取消选择大型桌面

[http://twitter.github.com/bootstrap/customize.html](http://twitter.github.com/bootstrap/customize.html)

它将减少手动编写查询和从 css 中删除块的所有麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T21:19:33.090

对于大于 1200 像素的视点会发生什么都在您的 CSS 中定义。

有什么可以阻止您编辑 CSS 文件并删除整个块

```
@media (min-width: 1200px) {  
.......
} 
```

或将其更改为永远不会发生的事情

```
@media (min-width: 12000px) {
....
} 
```

**更新**

您是否考虑过使用默认的 Bootstrap 网格（具有非流动行）？[在http://twitter.github.com/bootstrap/examples/hero.html](http://twitter.github.com/bootstrap/examples/hero.html)有一个例子

如果您从响应式 CSS 中删除超过 1200 个媒体请求，则该行为非常相似。

以下是非响应式 CSS 的一些 CDN 资源：

[http://twitter.github.com/bootstrap/assets/css/bootstrap.css](http://twitter.github.com/bootstrap/assets/css/bootstrap.css) (v2.3)

和
[http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap.min.css](http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap.min.css) (v2.2)

祝你好运！

# ruby-on-rails - devise.en.yml 不工作

> ID：15121419
> 
> 赞同：1
> 
> 时间：2013-02-27T20:10:58.983
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

对于那些熟悉 Devise 及其功能的人，您应该对 config/locales 目录中的 Devise.en.yml 文件有一些工作知识。该文件本质上在登录时会创建错误消息，即：如果您输入的密码错误，您应该会看到类似“invalid: 'Invalid email or password.”这样的错误消息。

在我的情况下，它不起作用，如果我输入错误的用户名/密码，什么也不会发生，它只是不会让您登录，但没有闪烁消息。

我的 devise.en.yml 文件内容都是绿色的，我不确定这是否应该是这样的，但我有一种预感，代码可能有问题？但这可能是也可能不是真正的原因。

不确定要包含哪些控制器或内容，因此一旦您提出要求，我将使用它们更新 OP。

### 这是我的应用程序的 devise.en.yml 文件：

```
 en:
  errors:
  messages:
  not_found: "not found"
  already_confirmed: "was already confirmed"
  not_locked: "was not locked"

  devise:
    failure:
      unauthenticated: 'You need to sign in or sign up before continuing.'
      unconfirmed: 'You have to confirm your account before continuing.'
      locked: 'Your account is locked.'
      invalid: 'Invalid email or password.'
      invalid_token: 'Invalid authentication token.'
      timeout: 'Your session expired, please sign in again to continue.'
      inactive: 'Your account was not activated yet.'
    sessions:
      signed_in: 'Signed in successfully.'
      signed_out: 'Signed out successfully.'
    passwords:
      send_instructions: 'You will receive an email with instructions about how to reset your password in a few minutes.'
      updated: 'Your password was changed successfully. You are now signed in.'
    confirmations:
      send_instructions: 'You will receive an email with instructions about how to confirm your account in a few minutes.'
      confirmed: 'Your account was successfully confirmed. You are now signed in.'
    registrations:
      signed_up: 'You have signed up successfully.'
      updated: 'You updated your account successfully.'
      destroyed: 'Bye! Your account was successfully cancelled. We hope to see you again soon.'
    unlocks:
      send_instructions: 'You will receive an email with instructions about how to unlock your account in a few minutes.'
      unlocked: 'Your account was successfully unlocked. You are now signed in.'
    mailer:
      confirmation_instructions: 'Confirmation instructions'
      reset_password_instructions: 'Reset password instructions'
      unlock_instructions: 'Unlock Instructions' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:40:52.170

我猜你必须将此代码添加到`app/views/layouts/application.html.erb`：

```
 <% if notice %>
    <p class="notice"><%= notice %></p>
  <% end %>

  <% if alert %>
    <p class="alert"><%= alert %></p>
  <% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T21:07:41.937

不确定这是否是真正的问题，但作为一个想法。

Yaml 使用标识来确定范围。不确定当您在此处复制粘贴时它是否损坏，但如果没有，您的问题可能是您的 devise.en.yml 文件应该如下所示：

```
en:
  errors: 
    messages:
      not_found: "not found"
      ...
  devise:
    failure:
       ... 
```

而不是它现在在你的问题中的样子。此外，请检查您是否使用空格，而不是制表符进行标识。

# jquery - jquery draggable 留下工件

> ID：15121420
> 
> 赞同：1
> 
> 时间：2013-02-27T20:11:00.263
> 
> 标签：jquery, draggable

我有一个可拖动的窗格，当我拖动时会留下工件。这只发生在 iPad 上（不在桌面浏览器上）。

窗格使用垂直拖动手柄从右向左拖动。请参阅屏幕截图链接。 [https://www.dropbox.com/s/weim027bdxg3zva/artifacts.PNG](https://www.dropbox.com/s/weim027bdxg3zva/artifacts.PNG)

我将其隔离为窗格包含一个带有大量文本的 div 的事实。当文本设置为 display:none 并重新加载页面时，工件会消失。这个场景在有或没有 CSS 阴影的情况下都是一致的。

这是移动设备上的某种内存问题吗？我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T20:52:51.570

这个技巧似乎可以帮助我解决 iPad 上的 slideUp 问题。尝试将以下内容添加到 CSS 中的违规元素。

```
-webkit-transform: translate3d(0,0,0) 
```

我从这篇文章中得到了这个：[jQuery slideUp flashing on iOS](https://stackoverflow.com/questions/14899609/jquery-slideup-flashing-on-ios)

# php - Magento & Hubspot - 在成功页面上提交表格

> ID：15121427
> 
> 赞同：0
> 
> 时间：2013-02-27T20:11:33.440
> 
> 标签：php, magento, curl

我正在尝试在 Magento 的成功页面上向 Hubspot 提交表单。我已经确认变量 $str_post 包含所有需要的信息。不幸的是，我无法确定为什么 $response 是空的。似乎没有建立 CURL 连接，但我似乎无法确定原因。除了加载页面之外，我还需要做些什么来触发 CURL 连接吗？

请注意，我已从 URL 中删除了 GUI/Form ID。

```
<?php
//Process a new form submission in HubSpot in order to create a new Contact.

$hubspotutk = $_COOKIE['hubspotutk'];  //grab the cookie from the visitors browser.
$ip_addr = $_SERVER['REMOTE_ADDR'];  //IP address too.
$hs_context = array(
        'hutk' => $hubspotutk,
        'ipAddress' => $ip_addr,
        'pageUrl' => 'https://www.myfoodstorage.com/onestepcheckout/',
        'pageTitle' => 'MyFoodStorage.com Cart Checkout'
    );
$hs_context_json = json_encode($hs_context);

//Need to populate these varilables with values from the form.
$str_post = "firstname=" . urlencode($firstname)
        . "&lastname=" . urlencode($lastname)
        . "&email=" . urlencode($email)
        . "&phone=" . urlencode($telephone)
        . "&address=" . urlencode($street)
        . "&city=" . urlencode($city)
        . "&state=" . urlencode($region)
        . "&country=" . urlencode($country)
        . "&hs_context=" . urlencode($hs_context_json);  //Leave this one be :)

 //replace the values in this URL with your portal ID and your form GUID
$endpoint = 'https://forms.hubspot.com/uploads/form/v2/GUI-ID/FORM-ID';

$ch = @curl_init();
@curl_setopt($ch, CURLOPT_POST, true);
@curl_setopt($ch, CURLOPT_POSTFIELDS, $str_post);
@curl_setopt($ch, CURLOPT_URL, $endpoint);
@curl_setopt($ch, CURLOPT_HTTPHEADER, array('application/x-www-form-urlencoded'));
@curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$response = @curl_exec($ch);  //Log the response from HubSpot as needed.
@curl_close($ch);
echo $response;

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T21:46:01.100

成功提交到 Forms API 将返回 204（无内容）响应，因此响应正文中不会有任何内容。您可以使用 curl_getinfo 获取状态码。

```
$response = @curl_exec($ch);  //Log the response from HubSpot as needed.
echo @curl_getinfo($ch, CURLINFO_HTTP_CODE);
@curl_close($ch);
echo $response; 
```

# c# - c#中需要延迟函数

> ID：15121430
> 
> 赞同：1
> 
> 时间：2013-02-27T20:11:37.117
> 
> 标签：c#

我在*使用* **Thread.sleep(seconds)**时遇到问题，它会暂停我在睡眠状态下的所有执行。但是我尝试了另一种解决方案，**也使用 for loop**，但是我期望它不起作用。

单击登录按钮时：

1.  行动报告="关于进展";
2.  再过 2 秒，它将“尝试连接到数据库”
3.  然后打开数据库后会像“数据库连接成功”

这是代码：

```
private void Loginbtn_MouseDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
{
   if(userText.Text!=String.Empty && passText.Password!=String.Empty){
   ProgressForm.Visibility = System.Windows.Visibility.Visible;
   LoginForm.Visibility = System.Windows.Visibility.Hidden;
   delay(2);
   actionReport.Text = "Try to Connecting the database";
   String ConnectionString = "server=127.0.0.1;uid=root;pwd='';database=smsdb;";
   MySqlConnection con = new MySqlConnection(ConnectionString);

   try {
      con.Open();
      delay(2);
      actionReport.Text = "Database Connected Sucessfully";
       } 

   catch(MySqlException sqle){
      actionReport.Text = sqle.Message; 
  }
} 
    else {
   MessageBox.Show("Please enter the user name and password to verify","Notification",MessageBoxButton.OK,MessageBoxImage.Information);
     }
 }

private void delay(int seconds) 
{
for(long i=0;i<seconds*3600; i++){
//empty
} 
```

请有人帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:14:16.647

`await`（在 C# 5.0 中引入）`Task.Delay`使这变得非常简单：

```
public async void Loginbtn_MouseDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
{
    actionReport.Text = "Trying to Connecting to the database";
    await Task.Delay(2);
    actionReport.Text = "Connected";
} 
```

对于 C# 4.0 解决方案，它有点混乱，但不是很多：

```
public async void Loginbtn_MouseDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
{
    actionReport.Text = "Trying to Connecting to the database";
    Task.Delay(2).ContinueWith(_ =>
        {
            actionReport.Text = "Connected";
        }, CancellationToken.None
        , TaskContinuationOptions.None
        , TaskScheduler.FromCurrentSynchronizationContext());
} 
```

这里的关键点是，您绝不会阻塞 UI 线程，您只是让 UI 线程继续处理事件两秒钟，然后再给它做点什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T06:08:26.780

我找到了这样的答案

```
delay("Try to Connecting the database"); 
```

像这样延迟。

```
public void delay(string message) {
    var frame = new DispatcherFrame();
    new Thread((ThreadStart)(() =>
    {
        Thread.Sleep(TimeSpan.FromSeconds(2));
        frame.Continue = false;
    })).Start();
Dispatcher.PushFrame(frame);
        actionReport.Text=message;
    } 
```

谢谢朋友！回复我。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-27T20:15:02.623

您首先需要查找并了解在后台线程上执行处理。主要规则是；

1.  你永远不应该阻止用户界面
2.  不要尝试从后台线程与 UI 线程对话
3.  如果你调用 Thread.Sleep，它可能是错误的

您的问题为您提供了学习新架构模式的机会。这些看起来像不错的候选人；

[http://www.codeproject.com/Articles/99143/BackgroundWorker-Class-Sample-for-Beginners](http://www.codeproject.com/Articles/99143/BackgroundWorker-Class-Sample-for-Beginners)

[http://www.codeproject.com/Articles/26148/Beginners-Guide-to-Threading-in-NET-Part-1-of-n](http://www.codeproject.com/Articles/26148/Beginners-Guide-to-Threading-in-NET-Part-1-of-n)

# file - 为什么 drjava 不允许我创建 jar 文件？

> ID：15121431
> 
> 赞同：0
> 
> 时间：2013-02-27T20:11:50.507
> 
> 标签：file, jar, applet, japplet, drjava

我正在制作一个 JApplet，需要制作一个 JAR 文件以连接到带有 applet 标记的 .htm 文件。我能想到的简单解决方案是使用 drjava 中的工具，上面写着“从项目创建 Jar 文件......”但是，由于某种原因它没有突出显示，所以我不能这样做。我真正想要的是（a）解释为什么 drjava 不能将我的类转换为 jar 文件，（b）允许我创建这个 jar 文件的替代方法，或者理想情况下（c）两者。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:16:02.220

我不使用[Drjava](http://drjava.sourceforge.net/)，但您可以通过以下方式从命令行创建 JAR 文件，而无需任何 IDE 特定的复杂性。

只需转到您的项目所在的文件夹/目录。假设您的类文件位于该`bin`文件夹中。然后你可以使用

```
jar cvf myapplet.jar -C bin . 
```

然后 JAR 就可以部署了。

# .net - 程序集可以包含 exe 吗？

> ID：15121435
> 
> 赞同：1
> 
> 时间：2013-02-27T20:12:25.690
> 
> 标签：.net

程序集可以包含 exe 吗？

我有一个程序可以生成 exe，但也使用我创建的 .dll。是多文件程序集吗？

编辑：

那么我读到的关于 .NET 中的多文件汇编的内容是什么？那些可以包含 .exe 和 .dll 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T20:13:29.317

不，如果您有一个 .exe 文件和一个 .dll，那么它们是两个独立的程序集。

如果您只想拥有一个文件，可以尝试使用 ILMerge（[直接下载](http://www.microsoft.com/en-gb/download/details.aspx?id=17630)、[NuGet](https://nuget.org/packages/ilmerge)）将两者结合起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T21:50:40.200

[这篇 SO 帖子](https://stackoverflow.com/questions/12253356/steps-to-create-singlefile-and-multifile-assembly)`single-file assembly`描述了 a和 a之间的区别`multi-file assembly`。这是该帖子中的一个片段，用于回答您更新的问题：

**问题：**

`What is this I read about multi-file assemblies in .NET?`

**回答：**

> 使用命令行编译器，您可以将程序集拆分为多个部分 - 其中单个程序集的清单包含查找属于程序集的信息所需的信息，但存储在单独的文件中。例如，您可以在其自己的文件中保留一个大型资源的资源图像（即：.bmp），这样就不必为了打开程序集而加载它。Visual Studio 不支持创建多文件程序集，但它们看起来像 DLL 或 EXE，加上零个或多个 netmodule 文件，加上零个或多个资源文件（可以是任何东西）。主 DLL 或 EXE 包含指定其他文件所在位置的清单。构建它所需的步骤在如何：构建多文件程序集中有详细说明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:15:34.987

按照 Jon Skeet 的建议使用 ILMerge：

```
ilmerge.exe /target:winexe /out:bothassemblies.exe assembly1.exe assembly2.dll 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:14:43.233

您可以使用工具 ILMerge 将程序集和 exe 文件合并为一个可执行文件。

看看[这个](http://www.microsoft.com/en-us/download/details.aspx?id=17630)

# c++ - 导出两个命名空间中的重复函数 (C++)

> ID：15121444
> 
> 赞同：0
> 
> 时间：2013-02-27T20:12:51.170
> 
> 标签：c++, function, namespaces, export, duplicates

我有这两个命名空间，每个都包含一个同名的函数，比如

```
namespace group1 {
    void add(int arg) {
    }
}

namespace group2 {
    void add(bool arg) {
    }
} 
```

我在带有声明的标题中指定了这一点

```
#ifdef __cplusplus 
    extern "C" {
#endif
    // My namespaces and functions prototypes here
#ifdef __cplusplus 
    }
#endif 
```

我正在尝试使用 GCC 将它们导出到 DLL 中。我收到有关它们之间冲突的警告，因为它们具有相同的名称，然后在链接时出错。我认为该名称也基于参数在目标文件中被破坏。我不知道链接器是否也关心命名空间。我怎样才能使这项工作？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:16:51.650

你不能直接这样做。当您使用 时`extern "C"`，您声明函数被导出为好像它们是 C 函数，而不是 C++。

这意味着（除其他外）

1.  命名空间被删除，并且不被视为名称的一部分
2.  没有因参数而修改名称

您可以做的最好的事情是创建重定向的外部“C”函数。

```
#ifdef __cplusplus 
    extern "C" {
#endif
    void group1_add(int arg);
    void group2_add(bool arg);
#ifdef __cplusplus 
    }
#endif 
```

然后包装函数的实现将使用其中一个`group1::add()`或`group2::add()`酌情使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:18:17.690

如果这些是 C++ 函数，则必须删除`extern "C"`括号：

```
#ifdef __cplusplus 
    extern "C" {
#endif

#ifdef __cplusplus 
    }
#endif 
```

`extern "C"`告诉编译器“不要修改这个名字”——但是（正如你所说）你想要修改。

# ruby-on-rails-3.2 - 如何在简单的表单集合选择中显示适当的字段？

> ID：15121451
> 
> 赞同：0
> 
> 时间：2013-02-27T20:13:06.643
> 
> 标签：ruby-on-rails-3.2, simple-form

在具有引导程序和简单表单的 Rails 3.2 应用程序中，我有以下视图：

```
<%= simple_form_for(@invoice) do |f| %>
   <%= f.input :user_id, :collection => @users %>
   ...
<% end %> 
```

下拉菜单不显示用户名，而是显示如下记录：

```
#<User:0X007...> 
```

我还没有找到任何可以显示用户名的简单表单语法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:48:43.553

我可能会`#map`用来获取某个用户属性。

```
<%= simple_form_for(@invoice) do |f| %>
   <%= f.input :user_id, :collection => @users.map(&:name) %>
   ...
<% end %> 
```

# c - 字符串文字/转义

> ID：15121452
> 
> 赞同：1
> 
> 时间：2013-02-27T20:13:07.273
> 
> 标签：c, string, escaping

我想知道是否有某种字符串前缀，以便 cstring 按原样获取，而无需我转义所有字符。我不是百分百确定。我记得一些关于在字符串前面加上**@**符号 ( `char str[] = @"some\text\here";`) 的内容，您不需要转义任何字符，例如 \、\n 等。我正在使用 curl 和 urls，不得不逃避每一个反斜杠是很痛苦的。

任何人都可以对此有所了解，还是我被困住了以反斜杠为前缀的每个字符的转义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:15:32.843

不，在 C 中只有两种类型的“字符串”，用双引号括起来的字符串字面量和用单引号括起来的字符字面量。

在这两种情况下，您都必须使用反斜杠转义具有特殊含义的字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:15:22.063

在 C 中，没有这样的东西。你被困在逃避一切，或者你可以把你的 URL 放在一个文件中并读入它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:18:52.673

此功能在 C 中不可用。您似乎阅读了 C# 的[逐字字符串文字](http://msdn.microsoft.com/en-us/library/aa691090%28v=vs.71%29.aspx)

如果您必须转义 - C 中的转义字符，您需要使用**反斜杠**（ \ ）转义

# c# - 为什么可以直接引用这个类及其成员？

> ID：15121457
> 
> 赞同：0
> 
> 时间：2013-02-27T20:13:19.893
> 
> 标签：c#, object, properties, static, instantiation

我遇到了这段代码：

```
pc = new PendingCommands(pause, wait);
PendingCommands.ProcessCommands = true; 
```

我想知道两件事：

> 1) 编码员的意思是写：pc.ProcessCommands = true？
> 
> 2）为什么甚至允许第二行？PendingCommands 未标记为静态...

如果我右键单击“pc”并选择“Go to Definition”或“Go To Declaration”，它会将我带到这里（在同一个类/文件中）：

```
public static PendingCommands pc = null; 
```

如果我右键单击“PendingCommands”（从任一位置）并选择“Go to Definition”或“Go To Declaration”，它会将我带到这里（在一个单独的类/文件中）：

```
public class PendingCommands : IDisposable 
```

“ProcessCommands”成员在“PendingCommands”类中以这种方式定义：

```
public volatile static bool ProcessCommands = true; 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:15:27.163

看这个：

```
public volatile static bool ProcessCommands = true; 
```

注意`ProcessCommands`是静态的。这意味着它与类型 ( `PendingCommands`) 相关，而不是类型的实例。

这几乎肯定不是一个好的设计（公共字段很少，静态可变字段很少，易失字段很少），但它解释了为什么可以编写`PendingCommands.ProcessCommands = true;`

很难知道它是否真的*是*静态的——不幸的是，它只是一个错误，还是在没有更多信息的情况下以这种方式设计的。（我会担心仅仅在那个领域的基础上使用这个类，但是......）

请注意，您提到“`PendingCommands`未标记为静态” - 它不是需要静态的*类。*静态类只是一个只有静态成员的类，不能被实例化（或用作变量类型等）。重要的是*您正在访问的成员*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:16:23.223

您可以`static`通过类名访问任何类的字段，即使类本身不是`static`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:16:36.810

> 1）这是一个错误吗？编码员的意思是写：`pc.ProcessCommands = true`？

可能 - 如果没有关于`PendingCommands`.

> 2）为什么甚至允许第二行？PendingCommands 未标记为静态...

类`PendingCommands`可能未标记为`static`，但`ProcessCommands`属性是。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T20:16:46.490

`ProcessCommands`是可访问的，因为它是`static`. 删除`static`关键字，它只能在与类的实例相关的情况下访问。即`pc`。

`PendingCommands.ProcessCommands = true``PendingCommands`除非打算用作单例，否则可能是一个错误。也就是说，该类只有一个实例，因此静态方法`ProcessCommands`将处理其唯一实例的所有“命令”。

# entity-framework - 实体框架代码优先：同一张表的一对多和多对多关系

> ID：15121460
> 
> 赞同：10
> 
> 时间：2013-02-27T20:13:21.973
> 
> 标签：entity-framework, ef-code-first, code-first, entity-framework-migrations

我的项目中有一个用户模型和一个事件模型。Event 有一个创建者（User）和一个参与者（Users），因此 Event 与 User 具有一对多的关系，并且与同一张表也具有多对多的关系。

我首先有这样的一对多关系：

```
Public class Event
{
      ...
      public int CreatedById { get; set; }
      public virtual User CreatedBy { get; set; }
      ...
} 
```

然后，当我添加多对多关系时，迁移不会生成多对多关系：

```
Public class User
{
      ...
      public virtual ICollection<Event> Events { get; set; }
      ...
}

Public class Event
{
      ...
      public int CreatedById { get; set; }
      public virtual User CreatedBy { get; set; }
      public virtual ICollection<User> Users { get; set; }
      ...
} 
```

如果我删除了一对多关系，那么迁移会成功生成多对多关系。

有没有办法只用数据注释来做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-27T20:20:00.990

EF 不知道`User.Events`必须映射到哪里。它可能是`Event.CreatedBy`，也可能是`Event.Users`。两者都会产生一个有效的模型。`[InverseProperty]`您必须通过应用属性给 EF 一点提示您想要什么：

```
public class User
{
    ...
    [InverseProperty("Users")]
    public virtual ICollection<Event> Events { get; set; }
    ...
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-16T06:14:47.153

使用 Code First Approach，我总是建议使用 fluent API 而不是使用 DataAnnotations，它会自动使用一些转换。

这样，您将知道您所做的确切配置。

如果我是你，这就是我会使用的：

```
public class EventMap : EntityTypeConfiguration<Event>
{
    public EventMap()
    {
        this.HasRequired(m => m.CreatedBy) // envent must have a creator
            .WithMany() // a user can have 0,1 or more events created by him
            .HasForeignKey(m => m.CreatedById) // specify property to be used as FK
            .WillCascadeOnDelete(true); // delete all events created by user if that specific user is deleted

        this.HasMany(m=>m.Users) // an event can have 0,1 or more participants
            .WithMany(m=>m.Events) // a user can be a participant in 0,1 or more events                
            .Map(m => m.MapLeftKey("EventId").MapRightKey("UserId")); // this will generate intermediate table to hold participant information - dbo.EventUser with EventId & UserId
            // Cascade Delete is always true for Many to Many mapping. however, it doesn't delete entry in other table, it deletes entry in Joined Table only.
    }
} 
```

# c++ - 实现外部合并排序

> ID：15121463
> 
> 赞同：0
> 
> 时间：2013-02-27T20:13:30.053
> 
> 标签：c++, sorting, file-io, merge

我知道[外部合并排序](http://en.wikipedia.org/wiki/External_sorting)及其工作原理。但目前我在实施它时遇到了困难。我已经编写了对数组进行排序和合并的代码，但是在从文件中读取数据和将数据写入文件时遇到了问题，我想在 C++ 中实现以下方法：

```
1\. int * read(int s, int e) : This method should read from file all the number 
starting from 's' till 'e' and return the array
2\. write(int a[], int s, int e) : This method should write to file the input 
array by replacing the numbers from s to e. 
```

例如。

```
Given file has the following numbers:

1
2
3
4
5
6

read(0, 2) should return [1,2,3]
write([4,5,6], 0, 2) should update the file to :
4
5
6
4
5
6 
```

如何实现这两种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:25:24.283

您应该做的第一件事是停止使用原始指针。

`std::vector<int>`将同样有效，而且更不容易出错。

其次，文件格式很重要。我将假设一个包含 32 位有符号整数的二进制文件。

读写的签名现在是：

```
std::vector<int> read( std::ifstream const& f, int offset );
void write( std::ofstream& f, int offset, std::vector<int> const& data ); 
```

`ifstream`和`ofstream`have seek 方法——特别是`ifstream`has`seekg`和`ofstream`has `seekp`。

`ifstream.read( char* , length )``length`从当前获取位置的文件中读取字节（由 设置，由`seekg`高级`read`）。如果您不关心文件的内存布局，您可以`.data()`从获取`std::vector<int>`，将其重新解释为 a `char*`，然后继续`read( reinterpret_cast<char*>(vec.data()), sizeof(int)*vec.size() )`读取缓冲区。

`ofstream`有一个类似的`write`方法，其工作方式大致相同。

虽然将数据原始地写入磁盘并返回是危险的，但在大多数（每个？）实现中，在同一个执行会话（甚至可能在会话之间）写入和读取数据是安全的。如果数据要在会话之间持久存在，或者它是代码的输出/输入，请多加注意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:23:31.067

没有 C++ 标准函数可以跳转到文件中的行。因此，您必须逐行读取文件（例如，使用 getline。http://www.cplusplus.com/reference/string/string/getline/ [）](http://www.cplusplus.com/reference/string/string/getline/)。

据我记得，外部合并排序（旧的，专为带有几个磁带驱动器的计算机而设计）在与单独的文件一起使用时，不需要像您这样的界面 - 您可以按顺序工作。

# safari - Safari中的边框半径切割/图像重叠

> ID：15121465
> 
> 赞同：0
> 
> 时间：2013-02-27T20:13:37.443
> 
> 标签：safari, css

我查看了其他一些问题和答案，但仍然无法在 Safari (v 5.1.7) 中使用。

这是我的代码 - [jsfiddle](http://jsfiddle.net/allanlud/agJZz/)

```
.services   {
    width: 218px;
    float: left;
    margin-right: 29px;
}
.services img   {
    border: solid 8px #ccc;
    -webkit-border-radius: 50%;
    -moz-border-radius: 50%;
    border-radius: 50%;
}
.services a img:hover   {
    border: solid 8px #333;
    -o-transition: all 1s ease 0s;
    -ms-transition: all 1s ease 0s;
    -moz-transition: all 1s ease 0s;
    -webkit-transition: all 1s ease 0s;
    transition: all 1s ease 0s;
} 
```

图像是正方形的 218px x 218px，所以我猜这与它有关，但我希望它是这样的，所以它在不支持边框半径的旧浏览器中看起来足够好。

这可能很简单，但我仍然坚持这一点。

谢谢。铝。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T09:47:09.177

来自站点点的回答：

嗯，棘手。如果你把边框放在上面，它会起作用：

代码：

```
.services   {
    width: 218px;
    float: left;
    margin-right: 29px;
}

.services img   {
    vertical-align: top;
}

.services img, .services a   {
    border-radius: 50%;
}

.services a {
    border: 8px solid #ccc;
    display: inline-block;
}

.services a:hover   {
    border: 8px solid #333;
    -o-transition: all 1s ease 0s;
    -ms-transition: all 1s ease 0s;
    -moz-transition: all 1s ease 0s;
    -webkit-transition: all 1s ease 0s;
    transition: all 1s ease 0s;
} 
```

您现在可以只使用border-radius，而无需使用供应商前缀，因为所有浏览器现在都将支持它。

# android - 不幸的是应用程序已停止？

> ID：15121467
> 
> 赞同：0
> 
> 时间：2013-02-27T20:13:43.107
> 
> 标签：android

我已经经历了很多例子，但仍然找不到解决方案。我是 android 开发的新手，所以我在线学习基本教程。我遵循了谷歌地图 v2 android 教程

mainActivity.java

```
 package com.example.midlandtest;

 import android.app.Activity;
 import android.os.Bundle;
 import android.view.Menu;
 import com.google.android.gms.maps.CameraUpdateFactory;
 import com.google.android.gms.maps.GoogleMap;
 import com.google.android.gms.maps.MapFragment;
 import com.google.android.gms.maps.model.BitmapDescriptorFactory;
 import com.google.android.gms.maps.model.LatLng;
 import com.google.android.gms.maps.model.Marker;
 import com.google.android.gms.maps.model.MarkerOptions;

 public class MainActivity extends Activity {
 static final LatLng HAMBURG = new LatLng(53.558, 9.927);
 static final LatLng KIEL = new LatLng(53.551, 9.993);
 private GoogleMap map;

 @Override
 protected void onCreate(Bundle savedInstanceState) {
 super.onCreate(savedInstanceState);
 setContentView(R.layout.main);
 map = ((MapFragment) getFragmentManager().findFragmentById(R.id.map))
    .getMap();
 Marker hamburg = map.addMarker(new MarkerOptions().position(HAMBURG)
    .title("Hamburg"));
 Marker kiel = map.addMarker(new MarkerOptions()
    .position(KIEL)
    .title("kiel")
    .snippet("Kiel is cool")
    .icon(BitmapDescriptorFactory
        .fromResource(R.drawable.ic_launcher)));

  // Move the camera instantly to hamburg with a zoom of 15.
  map.moveCamera(CameraUpdateFactory.newLatLngZoom(HAMBURG, 15));

  // Zoom in, animating the camera.
map.animateCamera(CameraUpdateFactory.zoomTo(10), 2000, null);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
 getMenuInflater().inflate(R.menu.main, menu);
 return true;
}

} 
```

主要的.xml

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<fragment
    android:id="@+id/map"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    class="com.google.android.gms.maps.MapFragment" />

 </RelativeLayout> 
```

显现

```
 <?xml version="1.0" encoding="utf-8"?>
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.midlandtest"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="15"
    android:targetSdkVersion="17" />

<permission
    android:name="midlandtest.permission.MAPS_RECEIVE"
    android:protectionLevel="signature" />

<uses-feature
    android:glEsVersion="0x00020000"
    android:required="true" />

   <uses-permission android:name="midlandtest.permission.MAPS_RECEIVE" />
   <uses-permission android:name="android.permission.INTERNET" />
   <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
   <uses-permission     android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
   <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
   <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="midlandtest.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="removed my api key for privacy reasons" />
   </application>

  </manifest> 
```

这是我的 logcat 日志。请帮忙。

```
02-27 20:11:26.448: D/AndroidRuntime(5858): Shutting down VM
02-27 20:11:26.458: W/dalvikvm(5858): threadid=1: thread exiting with uncaught exception (group=0x40a2a1f8)
02-27 20:11:26.458: E/AndroidRuntime(5858): FATAL EXCEPTION: main
02-27 20:11:26.458: E/AndroidRuntime(5858): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.midlandtest/midlandtest.MainActivity}: java.lang.ClassNotFoundException: midlandtest.MainActivity
02-27 20:11:26.458: E/AndroidRuntime(5858):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1880)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at android.os.Looper.loop(Looper.java:137)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at android.app.ActivityThread.main(ActivityThread.java:4424)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at java.lang.reflect.Method.invokeNative(Native Method)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at java.lang.reflect.Method.invoke(Method.java:511)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at dalvik.system.NativeStart.main(Native Method)
02-27 20:11:26.458: E/AndroidRuntime(5858): Caused by: java.lang.ClassNotFoundException: midlandtest.MainActivity
02-27 20:11:26.458: E/AndroidRuntime(5858):     at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
02-27 20:11:26.458: E/AndroidRuntime(5858):     at    android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1871)
02-27 20:11:26.458: E/AndroidRuntime(5858):     ... 11 more
02-27 20:11:26.778: I/dalvikvm(5858): threadid=3: reacting to signal 3
02-27 20:11:26.778: I/dalvikvm(5858): Wrote stack traces to '/data/anr/traces.txt'
02-27 20:11:26.998: I/dalvikvm(5858): threadid=3: reacting to signal 3
02-27 20:11:26.998: I/dalvikvm(5858): Wrote stack traces to '/data/anr/traces.txt' 
```

我使用运行 4.0.4 的 android 平板电脑来测试应用程序。我已将应用程序目标设置为 google api 4.0.3，因为有人告诉我在不同的教程中使用它。请帮助大家，这让我发疯

更新的 LOGCAT 日志！！

```
02-27 20:44:28.847: W/dalvikvm(6614): VFY: unable to resolve static field 876 (MapAttrs) in Lcom/google/android/gms/R$styleable;
02-27 20:44:28.847: D/dalvikvm(6614): VFY: replacing opcode 0x62 at 0x000e
02-27 20:44:28.847: D/AndroidRuntime(6614): Shutting down VM
02-27 20:44:28.857: W/dalvikvm(6614): threadid=1: thread exiting with uncaught exception (group=0x40a2a1f8)
02-27 20:44:28.857: E/AndroidRuntime(6614): FATAL EXCEPTION: main
02-27 20:44:28.857: E/AndroidRuntime(6614): java.lang.NoClassDefFoundError: com.google.android.gms.R$styleable
02-27 20:44:28.857: E/AndroidRuntime(6614):     at com.google.android.gms.maps.GoogleMapOptions.createFromAttributes(Unknown Source)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at com.google.android.gms.maps.MapFragment.onInflate(Unknown Source)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.app.Activity.onCreateView(Activity.java:4269)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:673)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:739)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:251)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.app.Activity.setContentView(Activity.java:1862)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at com.example.midlandtest.MainActivity.onCreate(MainActivity.java:23)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.app.Activity.performCreate(Activity.java:4492)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.os.Looper.loop(Looper.java:137)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at android.app.ActivityThread.main(ActivityThread.java:4424)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at java.lang.reflect.Method.invokeNative(Native Method)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at java.lang.reflect.Method.invoke(Method.java:511)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
02-27 20:44:28.857: E/AndroidRuntime(6614):     at dalvik.system.NativeStart.main(Native Method)
02-27 20:44:29.177: I/dalvikvm(6614): threadid=3: reacting to signal 3
02-27 20:44:29.177: I/dalvikvm(6614): Wrote stack traces to '/data/anr/traces.txt'
02-27 20:44:30.477: I/dalvikvm(6614): threadid=3: reacting to signal 3
02-27 20:44:30.487: I/dalvikvm(6614): Wrote stack traces to '/data/anr/traces.txt'
02-27 20:44:30.507: I/Process(6614): Sending signal. PID: 6614 SIG: 9
02-27 20:46:09.467: W/dalvikvm(6657): VFY: unable to resolve static field 876 (MapAttrs) in Lcom/google/android/gms/R$styleable;
02-27 20:46:09.467: D/dalvikvm(6657): VFY: replacing opcode 0x62 at 0x000e
02-27 20:46:09.477: D/AndroidRuntime(6657): Shutting down VM
02-27 20:46:09.477: W/dalvikvm(6657): threadid=1: thread exiting with uncaught exception (group=0x40a2a1f8)
 02-27 20:46:09.487: E/AndroidRuntime(6657): FATAL EXCEPTION: main
 02-27 20:46:09.487: E/AndroidRuntime(6657): java.lang.NoClassDefFoundError: com.google.android.gms.R$styleable
02-27 20:46:09.487: E/AndroidRuntime(6657):     at com.google.android.gms.maps.GoogleMapOptions.createFromAttributes(Unknown Source)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at com.google.android.gms.maps.MapFragment.onInflate(Unknown Source)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.app.Activity.onCreateView(Activity.java:4269)
 02-27 20:46:09.487: E/AndroidRuntime(6657):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:673)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:739)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:251)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.app.Activity.setContentView(Activity.java:1862)
 02-27 20:46:09.487: E/AndroidRuntime(6657):    at com.example.midlandtest.MainActivity.onCreate(MainActivity.java:23)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.app.Activity.performCreate(Activity.java:4492)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.os.Looper.loop(Looper.java:137)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at android.app.ActivityThread.main(ActivityThread.java:4424)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at java.lang.reflect.Method.invokeNative(Native Method)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at java.lang.reflect.Method.invoke(Method.java:511)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at    com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
02-27 20:46:09.487: E/AndroidRuntime(6657):     at dalvik.system.NativeStart.main(Native Method)
02-27 20:46:09.787: I/dalvikvm(6657): threadid=3: reacting to signal 3
02-27 20:46:09.807: I/dalvikvm(6657): Wrote stack traces to '/data/anr/traces.txt'
02-27 20:46:10.107: I/dalvikvm(6657): threadid=3: reacting to signal 3
02-27 20:46:10.107: I/dalvikvm(6657): Wrote stack traces to '/data/anr/traces.txt' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:15:24.003

改变：

```
<activity
    android:name="midlandtest.MainActivity"
    android:label="@string/app_name" > 
```

至

```
<activity
    android:name="com.example.midlandtest.MainActivity"
    android:label="@string/app_name" > 
```

您当前的代码告诉 Android`MainActivity`在名为`midlandtest`. 但是，您的包名为`com.example.midlandtest`. 这会导致`ClassNotFoundException`您遇到异常。

# python - 如何检查我是否在 Python 的 shell（有终端）中运行？

> ID：15121468
> 
> 赞同：2
> 
> 时间：2013-02-27T20:13:45.577
> 
> 标签：python, python-2.6

我有一个通常用完 cron 的 Python 脚本。有时，我想自己在（Unix）外壳中运行它，如果是这样，让它将其输出写入终端而不是写入日志文件。

确定脚本是否用完 cron 或在交互式 shell（我的意思是 bash、ksh 等，而不是 python shell）中的 pythonic 方法是什么？

我可以检查 TERM 环境变量是否存在？这是有道理的，但似乎看似简单......

os.isatty 可以以某种方式使用吗？

如果它有所作为，我正在使用 Python 2.6。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:15:07.257

您可以检查您的标准输出是否连接到终端：

```
import sys
sys.stdout.isatty() 
```

您可以使用 来做到这一点`os.isatty`，但这需要一个文件描述符，这不太简单：

```
import os
os.isatty(sys.stdout.fileno()) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:22:14.937

如果您真的需要检查这一点，Pavel Anossov 的答案就是这样做的方法，它与您最初的猜测几乎相同。

但是你真的需要检查这个吗？为什么不直接编写一个写入`stdout`和/或的 Python 脚本`stderr`，而您的`cron`工作可以重定向到日志文件？

或者，更好的是，使用该`logging`模块并让它写入`syslog`或任何其他合适的东西，如果有的话也写入终端？

# java - SSL 与运行时证书 Java

> ID：15121471
> 
> 赞同：0
> 
> 时间：2013-02-27T20:13:52.610
> 
> 标签：java, ssl, runtime

我有一个 java 项目，其中每个安装都有一个服务器和一个客户端。连接应牢固。服务器部分是跨平台的（包括 Android），所以使用 Keytool 或 openssl 生成密钥不是一个选项。

由于会有很多服务器，我不能只生成一个证书并包含它，因为这样每台服务器都会有相同的证书（当然，是自签名的）。

因此，理想情况下，我希望在服务器第一次启动时使用纯 java 在运行时生成证书，因为我不能使用任何外部工具。

请提供一个实际实施的例子。也欢迎替代方法或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T21:10:08.457

这个问题阅读评论也没有多大意义。
即使您在第一次安装时即时生成了一个密钥库（这可能是通过 Bouncy Castle 实现的），您也需要将其存储在文件系统中以便下次重新启动。
如果客户端要对服务器进行身份验证，他们将需要接收与信任库中的证书相同的证书（而不是根据您的 OP 在每次重新启动时新生成的证书），这在您的情况下是困难的部分，因为您是不使用知名颁发者的证书，并且必须*手动*将受信任的证书导入客户端的信任库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T21:02:12.230

这是你想要的东西。

```
//Build a blank keystore with a password
KeyStore ks = KeyStore.getInstance(KeyStore.getDefaultType());
char[] password = "some password".toCharArray();
ks.load(null, password);

//Sample key storage
javax.crypto.SecretKey mySecretKey;
KeyStore.SecretKeyEntry skEntry =
    new KeyStore.SecretKeyEntry(mySecretKey);
ks.setEntry("secretKeyAlias", skEntry, 
    new KeyStore.PasswordProtection(password));

//Update the keystore file
fos = new java.io.FileOutputStream("keystorefilename");
ks.store(fos, password); 
```

但是，您需要使用 BouncyCastle 创建证书并导入它。有[一个可用的教程](http://www.bouncycastle.org/wiki/display/JA1/BC+Version+2+APIs)。

# c++ - 如何找到键大于 val 的地图的第一个元素

> ID：15121477
> 
> 赞同：0
> 
> 时间：2013-02-27T20:14:20.720
> 
> 标签：c++, map, stl, stl-algorithm, upperbound

我有一个`map<double,T>`（比如说`T==string`），我想找到地图的第一个元素，使得键大于给定的数字。我查看`<algorithm>`并找到了[upper_bound](http://www.cplusplus.com/reference/algorithm/upper_bound/)和[lower_bound](http://www.cplusplus.com/reference/algorithm/lower_bound/)。

奇怪的是，我可以使用`lower_bound`但不是上面的第一个`upper_bound`，我做错了什么？

```
#include <iostream>
#include <map>
#include <algorithm>
#include <string>
using namespace std;

bool lte (pair<double,string> x, const double y) {
  return (x.first-y)<.001;
}
bool gte (pair<double,string> x, const double y) {
  return (x.first-y)>.001;
}
int main()
{
    map<double,string> myMap;
    myMap[10.01] = "A";
    myMap[14.62] = "B";
    myMap[16.33] = "C";
    myMap[45.23] = "D";
    myMap[0.23] = "E";

    map<double,string>::iterator it;
    for(it = myMap.begin(); it != myMap.end() ; it++){
        cout << it->first << " => " << it->second << endl;
    }

    map<double,string>::iterator firstAbove_1;
    firstAbove_1 = lower_bound(myMap.begin(), myMap.end(), 15., lte); //
    cout << "first greater that 15 is " << firstAbove_1->second << '\n';

    //map<double,string>::iterator firstAbove_2;
    //firstAbove_2 = upper_bound (myMap.begin(), myMap.end(), 15., gte); //         ^
    //cout << "first greater that 15 is " << firstAbove_2->second << '\n';

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:28:24.620

您使用的比较函数应该严格小于，而不是小于或等于。否则该算法可能会失败。

为了效率起见，您应该使用地图中内置的[成员函数`upper_bound`](http://en.cppreference.com/w/cpp/container/map/upper_bound)`algorithm`，而不是.

如果您需要考虑由于浮点不匹配而导致的未命中，请在之后进行。

```
map<double,string>::iterator it;
it = myMap.upper_bound(15.0);
if (it != myMap.begin())
{
    map<double,string>::iterator it2 = it;
    --it2;
    if (it2->first > 15.0 - 0.001)
        it = it2;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:20:51.893

`gte`应该是

```
bool gte (const double y, pair<double,string> x) {
    return (y-x.first)<.001;
} 
```

因为您需要切换参数。这为您提供了您想要的结果，但并不理想，因为比较函数不是对称的。阅读此代码的任何人都需要非常注意比较的哪一侧发生了什么，以了解您在做什么。

`lower_bound`如果您使用成员函数和`upper_bound`来自您的程序，您的程序将更具可读性`std::map`，而不是基于范围的`std::lower_bound`和`std::upper_bound`：

```
firstAbove_1 = myMap.lower_bound(15.0);
firstAbove_2 = myMap.upper_bound(15.0); 
```

以下是运行结果：

```
0.23 => E
10.01 => A
14.62 => B
16.33 => C
45.23 => D
first greater than 15 is C
first greater than 15 is C 
```

[这是ideone的演示。](http://ideone.com/UZT328)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T20:28:10.327

**重要提示：**此答案解释**了您收到编译错误的原因**。但是，如果可用，您应该始终更喜欢算法的成员函数版本而不是自由函数版本，因为它们提供了更好的复杂性保证。

因此，使用`std::map::upper_bound()`和`std::map::lower_bound`。这就是说，下面解释了为什么会出现编译时错误。

* * *

`sdt::lower_bound`和的参数的顺序`std::upper_bound`是**交换**的。请参阅 C++11 标准的第 25.4.3.1-2 段：

25.4.3.1`lower_bound [lower.bound]`

```
 template<class ForwardIterator, class T, class Compare>
 ForwardIterator  lower_bound(
     ForwardIterator first, 
     ForwardIterator last, 
     const T& value, 
     Compare comp
     ); 
```

> 1*要求*：[first,last) 的元素 e 应根据表达式**e < value 或 comp(e, value) 进行分区。**
> 
> 2*返回*： [first,last] 范围内的最远迭代器 i 使得对于 [first,i) 范围内的任何迭代器 j，以下相应条件成立：***j < value 或 comp(*j, value) != false** .
> 
> [...]

25.4.3.2`upper_bound [upper.bound]`

```
template<class ForwardIterator, class T>
ForwardIterator upper_bound(
    ForwardIterator first, 
    ForwardIterator last,
    const T& value);
    Compare comp
    ); 
```

> 1*要求*：[first,last) 的元素 e 应根据表达式**!(value < e) 或 !comp(value, e) 进行分区。**
> 
> 2*返回*： [first,last] 范围内的最远迭代器 i，使得对于 [first,i) 范围内的任何迭代器 j，以下相应条件成立：**!(value < *j) 或 comp(value, *j)** == 假的。
> 
> [...]

您应该相应地修改比较器功能：

```
bool lte (pair<double, string> x, const double y) {
  ...
}

bool gte (const double y, pair<double,string> x) {
  ...
} 
```

此外，`value_type`an`std::map<A, B>`的 不是`std::pair<A, B>`，而是`std::pair<A const, B>`。为避免无用的转换和复制，我建议使用以下签名：

```
bool lte (pair<double const,string> const& x, double const y) {
//                    ^^^^^         ^^^^^^
  ...
}

bool gte (double const y, pair<double const, string> const& x) {
//                                    ^^^^^  ^^^^^^
  ...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T20:34:16.317

你的功能 gte 是错误的。它一定要是

```
bool gte (const double y, pair<double,string> x) {
  return (x.first-y)>.001;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-27T20:38:51.847

首先它更好用`map::lower_bound`，`map::upper_bound`因为它们可以在`O(log n) operations`. 不仅`O(log n) comparsions`。

无论如何，我会使用`lower/upper_bound`没有谓词但使用值 (15\. + .001)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-27T20:46:11.200

```
/usr/lib/gcc/i686-pc-cygwin/3.4.4/include/c++/bits/stl_algo.h: In function `_ForwardIterator std::upper_bound(_ForwardIterator, _ForwardIterator, const _Tp&, _Compare) [with _ForwardIterator = std::_Rb_tree_iterator<std::pair<const double, std::string> >, _Tp = double, _Compare = bool (*)(std::pair<double, std::string>, double)]':
a.cpp:32:   instantiated from here
/usr/lib/gcc/i686-pc-cygwin/3.4.4/include/c++/bits/stl_algo.h:2784: error: conversion from `const double' to non-scalar type `std::pair<double, std::string>' requested 
```

在解决问题时，stl 是一团糟的毛茸茸的怪物。

您的问题源于比较器通常比较相同类型的两个元素，但在这里您尝试使用它来比较 a`pair<double,string>`和 a `double`。由于 c++ 中模板的奇妙神奇的晦涩难懂，编译器不会将您的比较器使用两种不同类型的事实视为问题。

lower_bound 的实现总是将 map 元素作为第一个参数传入，并将比较值作为正确的参数传入，因此您可以摆脱奇怪类型的比较器。但是 upper_bound 交换了参数顺序，所以你得到这个类型错误。它试图在一对应该去的地方放一个双打。

此外，您将错误类型的比较器传递给`upper_bound`. 通常，您应该将相同的“<”比较器传递给这两个函数。

就像其他人说的，使用`map::upper_bound(keytype&)`是一个更好的主意。

# ruby-on-rails-3 - 弃用警告：您正在尝试在 Rails 3.2.8 中创建属性“信息”

> ID：15121478
> 
> 赞同：3
> 
> 时间：2013-02-27T20:14:35.853
> 
> 标签：ruby-on-rails-3, prawn

我正在尝试通过 Prawn 将 pdf 生成添加到我的 Rails 3 应用程序中。我正在关注 Railscast，一切都很顺利，直到我尝试将一个实例变量从我的控制器传递给我创建的单独类。

控制器动作如下所示：

```
def show #shows some material
@material = Material.find(params[:id])
respond_to do |format|
  format.html
  format.pdf do
    pdf = MaterialPdf.new(@material)
    send_data pdf.render, filename: "material_#{@material.id}.pdf", 
                          type: "application/pdf",
                          disposition: "inline"
  end
end 
```

结尾

material_pdf.rb 文件如下所示：

```
class MaterialPdf < Prawn::Document
  def initialize(material)
    super
    @material = material
    text "Placeholder text"
  end
end 
```

我从日志中得到的错误信息很奇怪：

```
Material Load (0.1ms)  SELECT "materials".* FROM "materials" WHERE "materials"."id" = ? ORDER BY materials.created_at DESC LIMIT 1  [["id", "27"]]
DEPRECATION WARNING: You're trying to create an attribute `info'. Writing arbitrary attributes on a model is deprecated. Please just use `attr_writer` etc. (called from initialize at .../app/pdfs/material_pdf.rb:3) 
```

这很奇怪，因为查询看起来很好，而且我没有尝试创建属性“信息”。我不明白。帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T22:05:25.333

试图创建该属性的是对虾：

[http://prawn.majesticseaacreature.com/docs/0.11.1/Prawn/Document.html](http://prawn.majesticseacreature.com/docs/0.11.1/Prawn/Document.html)

我认为更好地解释它：

[创建属性“货币”的弃用警告](https://stackoverflow.com/questions/10596073/deprecation-warning-for-creating-attribute-currency)

无论如何，我认为你实际上是在错误地调用超级。Document.new 采用一个选项散列：

```
def initialize(options={},&block) 
```

所以你需要将它而不是材料实例传递给超类：

```
class MaterialPdf < Prawn::Document
  def initialize(material, prawn_opts = {})
    super(prawn_opts)
    @material = material
    text "Placeholder text"
  end
end 
```

# iframe - 从浏览器在 IFrame 中来回前进

> ID：15121494
> 
> 赞同：1
> 
> 时间：2013-02-27T20:15:23.933
> 
> 标签：iframe, back, forward

我有一个加载搜索结果的 iframe。在浏览器上按下后退/前进按钮以在 iframe 上工作时，我需要有人。现在，如果您按下按钮，它会在 iframe 中出现一些错误“此网页需要您之前输入的数据才能正确显示等。”并且看起来很讨厌。也许有人有更好的想法来解决这个问题. 我只需要在 iframe 加载结果时启用此功能。

# java - 将变量值转换为单个字符串并退出

> ID：15121497
> 
> 赞同：-1
> 
> 时间：2013-02-27T20:15:31.260
> 
> 标签：java, string

有时我想将多个变量转换为字符串以通过消息或方法发送。

例如，如果我有这些变量：

```
int addressNum = 223;
String stName = "Main St";
String city = "Chicago"; 
```

我如何将其转换为单个字符串`"223; Main St; Chicago"`并返回变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:17:39.687

我会使用某种分隔符`(, :)`

```
String fullAddress+=addressNum+":"+stName+":"+city; 
```

稍后，根据使用的分隔符拆分 fullAddress。

```
String[] arr = fullAddress.split(":");
int addressNumber = Integer.parseInt(arr[0]);
String streetName = arr[1];
String cityName = arr[2]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:21:41.850

```
String oneLine = addressNum + "; " + stName + "; " + city; - make it in sinle line

// split it to variables below
String[] arr = oneLine.split(";");
addressNum = Integer.parseString(arr[0].trim());
stName = arr[1].trim();
city = arr[2].trim(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:18:55.317

替代 String，编写一个保存数据的包装类：

```
public class SomeWrapper
{
    int addressNum;
    String stName;
    String city;

    // constructors, setters and getters
} 
```

然后像这样使用它：

```
SomeWrapper w = new SomeWrapper(223, "Main St", "Chicago"); 
```

并像这样提取它：

```
int addressNum = w.getAddressNumber();
String stName = w.getStreetName();
String city = w.getCity(); 
```

并且您可以简单地将其传递给以下方法：

```
public static void doSomething(SomeWrapper w)
{
    int addressNum = w.getAddressNumber();
    // ...
}

// ...

public static void main(String[] args)
{
    SomeWrapper w = ...;
    doSomething(w);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:19:48.773

您选择的编码必须是可逆的（双射）。

*   字符串可以被引用
*   可以使用字段名称：`adress="value"`
*   隔板要选好；即它没有出现在“正常”值中......
*   ...

使用像[JSon](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDQQFjAA&url=http://code.google.com/p/google-gson/&ei=ymouUZn1JMaXhQeAqICYBg&usg=AFQjCNGGFFMez8-PfFoEQP93a7eHFY8ssA&sig2=i7kFTzhZ-HF3Puapflfd9w&bvm=bv.42965579,d.ZG4)或[ByteBuffer](http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html)这样的标准可能是更好的做法。

# javascript - 使网页适合屏幕

> ID：15121499
> 
> 赞同：0
> 
> 时间：2013-02-27T20:15:34.000
> 
> 标签：javascript, jquery, css

有没有一种标准方法可以让我的页面在没有任何滚动条的情况下占据整个屏幕？它会根据我使用的显示器而变化，因此我想对其进行标准化。我唯一的想法是让所有元素都使用百分比样式，但我希望会有类似的属性`screen.height`。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:17:48.453

很多很多方式......我个人最喜欢的是一个巨大的包装器，你可以使用以下 CSS 将所有内容放入其中：

```
#WrapAll {
    position:absolute;
    top:0;
    left:0;
    right:0;
    bottom:0;
    overflow:hidden;
} 
```

这一直有效到 IE7（我认为在那之前，但未经测试），并保证在任何基于标准的浏览器上呈现相同的内容。

如果您需要滚动内容，您可以为里面的项目设置溢出值。它在窗口内滚动，而不滚动整个窗口。

如果您不想这样做`position:absolute;`（有些人对此感到不舒服），您可以通过以下方式完成类似的事情：

```
#WrapAll {
    width:100%;
    height:100%;
    overflow:hidden;
} 
```

这可能看起来更短，但由于浏览器呈现边距、边框等的方式，它也不太有保证。不过，在大多数情况下，这两种方式都可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:19:10.770

如果我是你，我会使用 css，但 jQuery 确实让你得到这些值......

```
$(window).width();   // returns width of browser viewport
$(document).width(); // returns width of HTML document 
```

[关于宽度的 jQuery 文档](http://api.jquery.com/width/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:27:55.553

CSS 可能最适合这个。

```
<html>
<head>
<style>
html, body {
  height: 100%;
}
.fixedOverlay {
  position:absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  overflow:hidden;
}

</head>
<body>
<div class="fixedOverlay">
 hello world
</div>
</body>
</html> 
```

# c# - MVC 4 - Html.Partial() 在 DIV 中显示 System.Namespace 文本（出现在页面上的 html 中）

> ID：15121506
> 
> 赞同：2
> 
> 时间：2013-02-27T20:15:51.817
> 
> 标签：c#, asp.net-mvc, razor, asp.net-mvc-4, partial-views

在我的 MVC 4 项目中，我在我的`_Layout.chshtml`页面中呈现了一个局部视图。它在下拉菜单中：

```
<div class="dropdown-menu" id="dropdown-login>
    @Html.Partial("~/Views/Account/_LoginPartial.cshtml")
</div> 
```

当我运行我的应用程序并单击下拉菜单时，会发生这种情况：

![在此处输入图像描述](../Images/a86a64722705c0aa972ff72ca0f57939.png)

我有其他局部渲染，这种事情不会发生。有人知道为什么会这样吗？

**局部视图**

```
 @model LetLord.Models.LoginModel

@(Html.BeginForm("Login", "Account", FormMethod.Post))
{
@Html.AntiForgeryToken()
@Html.ValidationSummary(true)

@Html.LabelFor(m => m.UserName)
@Html.TextBoxFor(m => m.UserName)
@Html.ValidationMessageFor(m => m.UserName)

@Html.LabelFor(m => m.Password)
@Html.PasswordFor(m => m.Password)
@Html.ValidationMessageFor(m => m.Password)

@*@Html.CheckBoxFor(m => m.RememberMe)
@Html.LabelFor(m => m.RememberMe, new { @class = "checkbox" })*@

<input type="submit" value="Log in" class="btn btn-primary btn-block" />
<p>
 @Html.ActionLink("Register", "Register", "Account", routeValues: null,
 htmlAttributes: new { id = "registerLink" }) if you don't have an account. </p>

}

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:24:42.500

您的部分视图有轻微的语法错误：

改变`@(Html.BeginForm`为`@using(Html.BeginForm`

# php - 在 Javascript/Jquery 中解码 PHP 序列化值

> ID：15121509
> 
> 赞同：0
> 
> 时间：2013-02-27T20:15:56.163
> 
> 标签：php, javascript, serialization, decode, encode

只是一个快速的问题。是否有内置函数来解码 Javascript 或 jQuery 中的 PHP 序列化值？A 有一个 PHP 序列化数组存储在数据库中，并通过 AJAX 发送到页面。

最好我需要在 Javascript 中解码这个数组，是否有这个函数或者 PHP 序列化函数是否使用它自己的格式，这将涉及 reg 表达式和这样的解码？如果是这样，我猜我会在发送之前将其在 PHP 中更改为 JSON。

感谢您提前提供任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:17:54.257

您应该在 PHP 中将其转换为 JSON。

# c# - 更新同一类型的多个项目

> ID：15121515
> 
> 赞同：2
> 
> 时间：2013-02-27T20:16:05.273
> 
> 标签：c#, .net, asp.net-mvc, razor, asp.net-mvc-4

我正在使用 MVC 4，我想摆脱编辑页面，只需在索引页面上同时对多个项目进行我想要的更改。

这是 CSHTML：

```
@model IEnumerable<HelpDesk.Models.ViewPerm>

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>

@using (Html.BeginForm())
{
@Html.ValidationSummary(true)

<fieldset>
    <legend>ViewPerm</legend>
    <table style="border: 5px solid white;">
        <tr>
            <th style="border: 5px solid white;">
                @Html.DisplayNameFor(model => model.Roles.Role)
            </th>
            <th style="border: 5px solid white;">
                @Html.DisplayNameFor(model => model.Views.Page)
            </th>
            <th style="border: 5px solid white;">
                @Html.DisplayNameFor(model => model.Perm)
            </th>
            <th></th>
        </tr>
        @foreach (var item in Model)
        {
            <tr>
                <td style="border: 5px solid white;">
                    @Html.DisplayFor(modelItem => item.Roles.Role)
                </td>
                <td style="border: 5px solid white;">
                    @Html.DisplayFor(modelItem => item.Views.Folder)
                    @Html.DisplayFor(modelItem => item.Views.Page)
                </td>
                <td style="border: 5px solid white;">
                    @Html.EditorFor(modelItem => item.Perm)
                </td>
                <td>                        
                    @Html.ActionLink("Delete", "Delete", new { id = item.VPermID })
                </td>
            </tr>
        }
    </table>
    <input type="submit" value="Save" />
</fieldset>
}

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

和 C#：

```
 public ActionResult Index()
    {
        var viewperm = db.ViewPerm.Include(v => v.Roles).Include(v => v.Views);
        return View(viewperm.ToList());
    }

    [HttpPost]
    public ActionResult Index(ViewPerm viewperm)
    {
        if (ModelState.IsValid)
        {
            db.Entry(viewperm).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(viewperm);
    } 
```

当我点击保存按钮时，它显示“存储更新、插入或删除语句影响了意外数量的行 (0)。自加载实体以来，实体可能已被修改或删除。刷新 ObjectStateManager 条目。”

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:23:05.887

第一个问题：您的视图处理**多个** `ViewPerm`，但您的发布操作只需要**一个**。

更改您的 post 方法以处理多个：

```
[HttpPost]
public ActionResult Index(IEnumerable<ViewPerm> viewperms)
{
    if (ModelState.IsValid)
    {
        foreach (ViewPerm viewperm in viewperms)
        {
            db.Entry(viewperm).State = EntityState.Modified;
        }

        db.SaveChanges();
    }

    return View(viewperms);
} 
```

您的第二个问题是您正在使用 a`foreach`来遍历视图中模型中的项目。这些字段需要正确索引，以便模型绑定器可以完成它的工作（它适用于数组）。将您的视图更改为：

```
@for (int i = 0; i < Model.Count(); i++)
{
    <tr>
        <td style="border: 5px solid white;">
            @Html.DisplayFor(m => m[i].Roles.Role)
        </td>
        <td style="border: 5px solid white;">
            @Html.DisplayFor(m => m[i].Views.Folder)
            @Html.DisplayFor(m => m[i].Views.Page)
        </td>
        <td style="border: 5px solid white;">
            @Html.EditorFor(m => m[i].Perm)
        </td>
        <td>                        
            @Html.ActionLink("Delete", "Delete", new { id = Model[i].VPermID })
        </td>
    </tr>
} 
```

# python - 区分 celery、kombu、PyAMQP 和 RabbitMQ/ironMQ

> ID：15121519
> 
> 赞同：8
> 
> 时间：2013-02-27T20:16:14.150
> 
> 标签：python, heroku, rabbitmq, celery, kombu

我想将图像上传到 S3 服务器，但在上传之前我想生成 3 种不同大小的缩略图，并且我希望它在请求/响应周期之外完成，因此我使用的是 celery。我已经阅读了文档，这是我所理解的。如果我错了，请纠正我。

1.  Celery 可帮助您在请求响应周期之外管理任务队列。
2.  然后有一个叫做胡萝卜/kombu 的东西——它是一个 django 中间件，用于打包通过 celery 创建的任务。
3.  然后是促进胡萝卜与代理通信的第三层 PyAMQP。例如。RabbitMQ、AmazonSQS、ironMQ 等。
4.  经纪人位于不同的服务器上，为您做事。

现在我的理解是 - 如果多个用户同时上传图片，celery 将排队调整大小，并且调整大小实际上会发生在 ironMQ 服务器上，因为它在 heroku 上提供了一个很酷的插件。

现在的疑惑：

1.  但是在调整图像大小后，ironMQ会将其推送到S3服务器，还是会在该过程完成后通知..我不清楚。

2.  芹菜和昆布/胡萝卜有什么区别，你能生动地解释一下吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-27T23:37:29.517

IronMQ 不会为您处理您的任务；它只是作为 Celery 的后端来跟踪需要执行的工作。

所以，这就是发生的事情。假设你有两台服务器，你的 web 服务器和你的 Celery 服务器。您的 Web 服务器负责处理请求，您的 Celery 服务器创建缩略图并将其上传到 S3。下面是一个典型的请求：

1.  您的用户将图像上传到您的网络服务器。
2.  您将该图像存储在某个地方-我建议您将其放在 S3 上，个人，但您也可以将其存储在例如[IronCache](http://iron.io/cache)中，base64 编码。关键是把它放在你的 Celery 服务器可以访问的地方。
3.  你在 Celery 上排队工作，将图像的位置传递给你的 Celery 服务器。
4.  您的 Celery 服务器会下载图像、生成缩略图并将其上传到 S3。然后它将 S3 URL 存储在作业结果中。
5.  您的 Web 服务器会等到作业完成，然后才能访问结果。或者，您可以让 Celery 服务器将结果存储在数据库本身中。关键是 Celery 服务器完成了繁重的工作（生成缩略图）并且在执行时不会阻止请求循环。

我写了一个在 Heroku 上使用 IronMQ 的例子。你可以在这里看到它：http: [//iron-celery-demo.herokuapp.com](http://iron-celery-demo.herokuapp.com)。您可以[在 Github 上](https://github.com/iron-io/heroku-iron-celery-demo)查看示例的源代码并[阅读教程](https://github.com/iron-io/heroku-iron-celery-demo/blob/master/tutorial.md)，其中非常详尽地逐步解释了如何在 Heroku 上部署 Celery。

要清除 AMQP 的东西：

*   IronMQ 是 Iron.io 开发的基于云的消息队列服务。
*   AMQP 是一个开放的消息传递规范
*   RabbitMQ 是 AMQP 规范最流行的实现（据我所知）。
*   PyAMQP 是一个 Python 库，它允许 Python 客户端与 AMQP 的任何实现进行通信，包括 RabbitMQ

IronMQ 和 RabbitMQ/AMQP 之间的最大区别之一是 IronMQ 是托管和管理的，因此您不必自己托管服务器并担心正常运行时间。该规范在差异化方面提供了更多信息，并且存在潜在的差异，但 Celery 将其中的大部分抽象出来。因为您使用的是 Celery，所以您可能会注意到的唯一区别是 IronMQ 是托管的，因此您不必站起来管理自己的服务器。

**全面披露**：我受雇于 IronMQ 背后的公司 Iron.io。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T08:41:42.020

“IronMQ 和 RabbitMQ/AMQP 之间的最大区别之一是 IronMQ 是托管和管理的，因此您不必自己托管服务器并担心正常运行时间。”

Currently there are at least two hosted managed RabbitMQ-as-a-service options: Bigwig and CloudAMQP. Celery should work well with both.

# javascript - html5画布精灵表随机行/列

> ID：15121523
> 
> 赞同：0
> 
> 时间：2013-02-27T20:16:24.260
> 
> 标签：javascript, html, canvas, sprite-sheet

目前代码从精灵表中的一行图像中选择并从屏幕的左到右显示它，我想做的是选择随机图像，就像它所做的一样，但是从不同的行中选择，例如我有 3 行，其中 1 行 3 个不同颜色的小行星 32 x 32，第 2 行 3 个不同颜色的 64 x 64，最后一行 3 个不同颜色的 128 x 128。我将如何随机显示不同的大小和颜色

这是当前代码，任何帮助都会很棒。

```
function Enemy() {
this.srcX = 0;
this.srcY = 528;
this.width = 32;
this.height = 33;
this.previousSpeed = 0;
this.speed = 2;
this.acceleration = 0.005;
this.imageNumber = Math.floor(Math.random()*3);
this.drawX = Math.floor(Math.random() * 1000) + gameWidth;
this.drawY = Math.floor(Math.random() * gameHeight);
this.collisionPointX = this.drawX + this.width;
this.collisionPointY = this.drawY + this.height;    
}

Enemy.prototype.draw = function () {
this.drawX -= this.speed;
ctxEnemy.drawImage(imgSprite,this.srcX+this.imageNumber*this.width,this.srcY,this.width,this.height,this.drawX,this.drawY,this.width,this.height);
this.checkEscaped();
};

Enemy.prototype.assignValues = function() {

}

Enemy.prototype.checkEscaped = function () {
if (this.drawX + this.width <= 0) {
    this.recycleEnemy();
}
};

Enemy.prototype.recycleEnemy = function () {
this.drawX = Math.floor(Math.random() * 1000) + gameWidth;
this.drawY = Math.floor(Math.random() * gameHeight);
};

function clearCtxEnemy() {
ctxEnemy.clearRect(0, 0, gameWidth, gameHeight);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:53:26.073

您可以使用一个对象来存储您所有的小行星。然后用一个随机数作为密钥，得到一个随机的小行星。

```
var min = 1;
var max = 9;
var key = Math.floor(Math.random() * max ) + min;

var asteroids = {
    1 :{
        'width' : 64,
        'height' : 64,
        'colour' : 'blue'
    },
    2 : {
        'width' : 64,
        'height' : 64,
        'colour' : 'red'
    },

    //repeat until the last one....

    9 : {
        'width' : 128,
        'height' : 128,
        'colour' : 'green'
    }
};

console.log( asteroids[key]['colour'] );
console.log( asteroids[key]['width'] );
console.log( asteroids[key]['height'] ); 
```

# mysql - MySQL AND 语句失败

> ID：15121532
> 
> 赞同：0
> 
> 时间：2013-02-27T20:16:45.570
> 
> 标签：mysql, pdo, clause

我有一个失败的查询 它似乎是失败的 AND 语句。

```
if(isset($_POST['sea']) && $_POST['sm'] !==''){
$sm = trim($_POST['sm']);
$sql = "SELECT * FROM `memorials` WHERE `fname` LIKE '$sm%' OR `lname` LIKE '$sm%' OR    `comments` LIKE '$sm%' AND `status` = '2' ";
$q = $conn->prepare($sql);
$q->execute(); 
```

我已添加\删除 `backticks`，'status = '2' 失败。

以下语句在 phpmyadmin 中有效

```
SELECT * FROM `memorials` WHERE `fname` LIKE 'test%' AND status = '2' 
```

此语句在 phpmyadmin 中失败

```
SELECT * FROM `memorials` WHERE `fname` LIKE 'test%' OR `lname` LIKE 'test%' AND status = '2' 
```

此查询搜索注释 AND 子句有效，但忽略 fname 和 lname

```
$sql = "SELECT * FROM memorials WHERE `fname`  OR  `lname`  OR `comments`  LIKE '$sm%'  AND status = '2'    "; 
```

有没有人建议这是（我）失败的地方

谢谢

加里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:20:23.600

运算符优先级在这里很重要。您需要添加一些括号：

```
SELECT * 
FROM   `memorials` 
WHERE  ( `fname` LIKE '$sm%' 
          OR `lname` LIKE '$sm%' 
          OR `comments` LIKE '$sm%' ) 
       AND `status` = '2' 
```

[文档](http://dev.mysql.com/doc/refman/5.0/en/operator-precedence.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:19:36.410

您需要在适当的部分周围加上括号。也许是这样的：

```
SELECT * 
FROM `memorials` 
WHERE (`fname` LIKE 'test%' OR `lname` LIKE 'test%') AND status = '2' 
```

# javascript - array.splice() 函数说明

> ID：15121535
> 
> 赞同：0
> 
> 时间：2013-02-27T20:16:54.400
> 
> 标签：javascript, jquery

我对 jQuery 很陌生，我不确定这个拼接函数是做什么的。

它是否检查 profilingArray 中是否存在“My_adress”然后将其删除？还是将其添加到位置 1？

```
profilingArray.splice(jQuery.inArray('My_adress',profilingArray),1); 
```

很Ty

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:18:33.150

您使用的不是 jQuery 函数，而是[标准的 javascript splice 函数](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/splice)。

`splice`是一个方便的函数，用于添加或删除数组中的项目。

在这里，您只是从in`1`的位置删除一个 ( ) 项目。所以你要从数组中删除。`'My_adress'``profilingArray``'My_adress'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:18:41.387

它获取`index`中元素的`array`，然后从`1`该 开始删除元素`index`，这意味着它删除了该元素。[斯普利特解释道。](http://www.w3schools.com/jsref/jsref_splice.asp)

# php - 亚马逊 MWS 库存 (PHP)

> ID：15121537
> 
> 赞同：1
> 
> 时间：2013-02-27T20:16:55.063
> 
> 标签：php, amazon-web-services, amazon

我的亚马逊 MWS 库存 (ListInventorySupplySample.php) 有问题。

我用暂存器测试我的帐户数据，它工作正常。

我喜欢下面的代码特定 SKU 的库存。

```
 $skus = new FBAInventoryServiceMWS_Model_SellerSkuList();

     $skus->setmember("SKU");

     $request = new FBAInventoryServiceMWS_Model_ListInventorySupplyRequest();

     $request->setSellerId(SELLER_ID);

     $request->setSellerSkus($skus);

     invokeListInventorySupply($service, $request); 
```

输出：

```
 ListInventorySupplyResponse ListInventorySupplyResult InventorySupplyList member SellerSKU string FNSKU string ASIN string Condition string TotalSupplyQuantity 100 InStockSupplyQuantity 100 EarliestAvailability TimepointType string DateTime 2008-09-29T01:49:45 SupplyDetail member Quantity 100 SupplyType string EarliestAvailableToPick TimepointType string DateTime 2014-09-18T23:18:33 LatestAvailableToPick TimepointType string DateTime 2006-08-19T17:27:14+00:00 NextToken string ResponseMetadata RequestId string 
```

谁能帮我解决这个问题？

提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-20T18:29:50.147

看起来您与生产没有联系。

你正在用吗

```
$service = new MarketplaceWebService_Mock() 
```

请使用并注释掉 Mock 服务对象。

```
$service = new MarketplaceWebService_Client(
     AWS_ACCESS_KEY_ID, 
     AWS_SECRET_ACCESS_KEY, 
     $config,
     APPLICATION_NAME,
     APPLICATION_VERSION); 
```

另一个解释你的问题的帖子。

[亚马逊 MWS 读取库存 Php](https://stackoverflow.com/questions/11401212/amazon-mws-read-inventory-stock-php)

谢谢。

# vba - 如何通过检查两个条件来获取特定对象的计数

> ID：15121542
> 
> 赞同：0
> 
> 时间：2013-02-27T20:17:20.930
> 
> 标签：vba, excel

我必须为以下场景编写一个宏：

我有一本有一张纸的excel书。工作表包含带有测试用例和测试状态的模块名称。我必须用特定模块的测试状态来计算测试用例，比如“Mod1”。

```
Module    Test Case ID    Status
Mod1            123         Pass
Mod2            124         Fail
Mod1            125         Fail
Mod1            126         Blocked
Mod5            127         Pass
Mod1            128         NA 
```

我写的代码如下：

```
Sub testnw()

Dim k, l, ps, fl, bl, na As Integer

Dim frng As Range

ps = 0
fl = 0
bl = 0
na = 0
frng = Worksheets(1).Range("A1")

k = 1
l = 1
       While (frng.Cells(k, l).Value <> "")

        If frng.Cells(k, l).Value = "Mod1" Then
            If frng.Cells(k, l + 2).Value = "Pass" Then
            ps = ps + 1
            ElseIf frnng.Cells(k, l + 2).Value = "Fail" Then
            fl = fl + 1
            ElseIf frng.Cells(k, l + 2).Value = "Blocked" Then
            bl = bl + 1
            Else
            na = na + 1
            End If
        End If
    Wend
MsgBox (ps)
MsgBox (fl)
MsgBox (bl)
MsgBox (na)
End Sub 
```

在运行上述代码时，我收到一条错误消息，即“未设置对象变量或块变量”。

谁能告诉我我错在哪里并给我正确的代码？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:30:36.103

错误在这一行：

```
frng = Worksheets(1).Range("A1") 
```

当您使用对象（不是简单的变量）时，您需要一个`SET`命令：

```
set frng = Worksheets(1).Range("A1") 
```

**有关LET**和**SET**的更多信息，请参阅[此问题](https://stackoverflow.com/questions/11089040/difference-in-type-between-using-and-not-using-set-vba)

 ***** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T22:07:34.350

正如彼得阿尔伯特建议的那样，你真的应该`Pivot Table`为此使用 a 。重新创建轮子没有任何意义，除非您在 VBA 中有非常特殊的需求。

如果您对数据透视表中的外观感到好奇，以下是创建数据透视表的方法：

`1.`突出显示数据范围（模块、测试用例 ID、测试状态）

`2.`转到**Insert -> Pivot Table**，然后单击 OK

![在此处输入图像描述](../Images/59a312471c364728fd04a947d78e6179.png)

`3.`在右下角`PivotTable Field List`，拖动：

*   `Module`到**行标签**，
*   `Test Case ID`**价值观**_
***   `Status`到**列标签****

 **![在此处输入图像描述](../Images/1d27635a1e827af78d66582f45e64ab3.png)

生成的表格如下所示：

![在此处输入图像描述](../Images/be5519ceecf9b9d6fe219646b9b8f7db.png)

如果这不是您正在寻找的*确切*`PivotTable Field List`视图，您可以使用这些值（例如 switch`Status`和`Test Case ID`），直到找到适合您需要的视图。******

# .net - 对象反序列化xml就好了，但不是json

> ID：15121543
> 
> 赞同：1
> 
> 时间：2013-02-27T20:17:29.640
> 
> 标签：.net, serialization, asp.net-mvc-4, asp.net-web-api

我发现这是一个非常奇怪的问题。当我向我的 web api 服务发送一个 xml 请求时，每个反序列化都很好。但是，当我发送一个 json 请求时，这个 ONE 属性将不会反序列化。以下是对象：

```
[Serializable]
[DataContract(Namespace = "")]
public class TransactionData
{
    // bunch of other properties that are unaffected ...

    private GeotagInfo _geotag;

    [DataMember(IsRequired = false, Name = "GeotagInfo", Order = 7)]
    public GeotagInfo GeotagInfo
    {
        get { return _geotag ?? new GeotagInfo(); }
        set { _geotag = value; }
    }
}

[DataContract(Namespace = "")]
public class GeotagInfo
{

    [DataMember(IsRequired = false, Name = "Longitude", Order = 1, EmitDefaultValue = false)]
    public string Longitude { get; set; }

    [DataMember(IsRequired = false, Name = "Latitude", Order = 2, EmitDefaultValue = false)]
    public string Latitude { get; set; }

    [Image(Nullable = true)]
    [DataMember(IsRequired = false, Name = "MapImage", Order = 3, EmitDefaultValue = false)]
    public string MapImage { get; set; }

    [XmlIgnore]
    public int TransactionId { get; set; }
} 
```

当使用 xml 请求在控制器的入口点中断时。地理标记属性在那里并且完全填充。当我对 json 请求执行相同操作时，geotag 属性被实例化，但其所有值均为空。此父对象中的其他所有内容都很好。

这是 json 请求中的属性：

```
"GeotagInfo": {
  "Longitude": "-yy.yyyy",
  "Latitude": "xx.xxxx",
  "MapImage": "base64 string"
} 
```

注意属性 getter`get { return _geotag ?? new GeotagInfo(); }`

xml请求对此没有问题。但是，如果我删除它并制作它，`get { return _geotag; }`那么问题就会消失。不幸的是，这会导致服务更深层次的其他问题。

这里发生了什么？它如何与 xml 而不是 json 一起正常工作（除非我删除了默认的 getter）。我知道 MVC4 使用 json.net，所以这可能与它有关。

注意：正如其他线程中所建议的，我尝试从类中删除可序列化的属性。没变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T04:19:53.050

显然，Json.net 序列化程序的操作顺序肯定存在差异。我想知道它是否正在尝试进行某种惰性反序列化以提高性能。无论如何，我写了一个错误，它揭示了序列化程序的差异：

```
get { return _geotag ?? new GeotagInfo(); } 
```

这永远不会设置私有字段。它应该是：

```
get { return _geotag ?? (_geotag = new GeotagInfo()); } 
```

所以我的假设是私有字段从未被设置，这让我觉得它被设置为固有的延迟加载反序列化。所以现在我们已经完成了反序列化过程，对私有字段执行的检查将始终返回 null，因此默认返回一个空对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:20:55.987

一种解决方法是创建两个属性，一个用于序列化，另一个用于进一步使用：

```
[Serializable]
[DataContract(Namespace = "")]
public class TransactionData
{
    // bunch of other properties that are unaffected ...

    private GeotagInfo _geotag;

    [DataMember(IsRequired = false, Name = "GeotagInfo", Order = 7)]
    public DataMember_GeotagInfo GeotagInfo
    {
        get;
        set;
    }

    public GeotagInfo GeotagInfo
    {
        get { return DataMember_GeotagInfo ?? new GeotagInfo(); }
        set { DataMember_GeotagInfo = value; }
    }
} 
```

# database - node.js 实时数据集群

> ID：15121546
> 
> 赞同：1
> 
> 时间：2013-02-27T20:17:39.150
> 
> 标签：database, node.js, cluster-computing

我正在使用数据库，并且可以从数据库中加载每个请求的数据，但它可能太慢了。所以我的想法是将数据保存在服务器上（就像服务器*通常*那样）。这个想法只使用*一台*服务器就很有效。现在，当第二台服务器进入太空时，这种情况的处理变得更加复杂。请记住，服务器可能在物理上是分开的。

在不使用数据库的情况下确保两个或多个 node.js 服务器上的所有数据相同的最佳实践是什么？

我的第一个想法是每个服务器实例都有一个*超级对象管理器。**这个对象管理器将为我创建/加载的每个*对象（例如数据库中的*用户*）接收一个唯一的 ID（对于所有服务器，存储在数据库中）。假设用户的对象具有 id 3h34ds。现在，当我更新我的用户对象时，对象管理器会处理更改并向所有其他服务器广播消息，包括对象 ID（这是全局唯一的）和元数据（例如 JSON）。

这可靠吗？这可以实现吗？我不这么认为，因为每次更改某些内容时我都会通知对象管理器。事实上，这会破坏代码流，例如

```
user.name = "Test";
objectManager.notify(user); // this is unlovely 
```

有没有更好的方法？

# c# - 禁用第二个 USB 键盘

> ID：15121550
> 
> 赞同：4
> 
> 时间：2013-02-27T20:17:49.767
> 
> 标签：c#, windows-7, keyboard, windows-xp, usb

我有一个环境，其中两 (2) 个键盘和两 (2) 个鼠标连接到可能运行 XP 或 Win7 的 PC。目的是允许共同用户交互以在桌面上进行培训。有时我需要一种方法来禁用所有用户交互的第二个 kb/鼠标。我猜这可以在设备 HID 级别或 USB 级别完成，但需要一些可以集成到系统托盘应用程序中的 C#/VB 代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:26:31.363

我在窗口挂钩中看不到任何可以告诉您输入源并在该级别阻止它的内容。

您可以通过 Windows 完全禁用硬件的路线：以[编程方式启用/禁用硬件设备](https://stackoverflow.com/questions/3498042/programmatically-enabling-disabling-hardware-device)

# stored-procedures - Spring集成+oracle store过程

> ID：15121555
> 
> 赞同：1
> 
> 时间：2013-02-27T20:18:02.123
> 
> 标签：stored-procedures, oracle11g, spring-integration

我正在尝试将 spring-integration 存储过程咖啡示例从 PostgreSQL 复制到 Oracle。没有成功。这是原始代码的链接 [https://github.com/SpringSource/spring-integration-samples/tree/master/intermediate/stored-procedures-postgresql](https://github.com/SpringSource/spring-integration-samples/tree/master/intermediate/stored-procedures-postgresql)

我决定从获取所有咖啡的过程开始，因此我删除了项目中对 getCoffee 名称的所有引用。

这是我的存储过程的代码：

```
create or replace 
PROCEDURE find_all_coffee_beverages AS
begin
    for x in (SELECT id, coffee_name, 
                coffee_description
                FROM coffee_beverages
               ORDER BY ID) loop
        dbms_output.put_line
            (x.coffee_description);
    end loop;
end; 
```

这是我的春天背景：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:int="http://www.springframework.org/schema/integration"
    xmlns:int-jdbc="http://www.springframework.org/schema/integration/jdbc"
    xsi:schemaLocation="http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration.xsd
        http://www.springframework.org/schema/integration/jdbc http://www.springframework.org/schema/integration/jdbc/spring-integration-jdbc.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="dataSource" class="oracle.jdbc.pool.OracleDataSource"
        destroy-method="close">
        <property name="connectionCachingEnabled" value="true" />
        <property name="URL" value="jdbc:oracle:thin:@//localhost:1521/XE" />
        <property name="password" value="admin" />
        <property name="user" value="admin" />
        <property name="connectionCacheProperties">
            <props merge="default">
                <prop key="MinLimit">3</prop>
                <prop key="MaxLimit">20</prop>
            </props>
        </property>
    </bean>

    <int:channel id="findAllProcedureRequestChannel" />

    <int:gateway id="gateway" default-request-timeout="4000"
        default-reply-timeout="4000"
        service-interface="org.springframework.integration.service.CoffeeService">
        <int:method name="findAllCoffeeBeverages" request-channel="findAllProcedureRequestChannel" />
    </int:gateway>

    <int-jdbc:stored-proc-outbound-gateway
        id="outbound-gateway-storedproc-find-all" data-source="dataSource"
        ignore-column-meta-data="true" request-channel="findAllProcedureRequestChannel"
        expect-single-result="true" stored-procedure-name="FIND_ALL_COFFEE_BEVERAGES">
        <int-jdbc:returning-resultset name="ref"
            row-mapper="org.springframework.integration.support.CoffeBeverageMapper" />
    </int-jdbc:stored-proc-outbound-gateway>

    <bean id="transactionManager"
        class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="dataSource" />
    </bean>

    <int:poller default="true" fixed-rate="5000">
        <int:transactional />
    </int:poller>

</beans> 
```

所以我编译它并像这样使用 maven 运行它： mvn clean package exec:java -e 它编译完美，但是当它尝试运行时，我得到了下一个异常：

```
 --- exec-maven-plugin:1.2:java (default-cli) @ oracle-stored-procedures ---
org.springframework.jdbc.BadSqlGrammarException: CallableStatementCallback; bad SQL grammar [{call FIND_ALL_COFFEE_BEVERAGES(?)}]; nested exception is java.sql.SQLException: ORA-06550: line 1, column 7:
PLS-00306: wrong number or types of arguments in call to 'FIND_ALL_COFFEE_BEVERAGES'
ORA-06550: line 1, column 7:
PL/SQL: Statement ignored

    at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:233)
    at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:72)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:1030)
    at org.springframework.jdbc.core.JdbcTemplate.call(JdbcTemplate.java:1064)
    at org.springframework.jdbc.core.simple.AbstractJdbcCall.executeCallInternal(AbstractJdbcCall.java:388)14:01:56.804 WARN  [org.springframework.integration.Main.main()][org.springframework.integration.gateway.GatewayProxyFactoryBean$MethodInvocationGateway] failure occurred in gateway sendAndReceive
org.springframework.integration.MessageHandlingException: error occurred in message handler [org.springframework.integration.jdbc.StoredProcOutboundGateway#0]
    at org.springframework.integration.handler.AbstractMessageHandler.handleMessage(AbstractMessageHandler.java:79)
    at org.springframework.integration.dispatcher.UnicastingDispatcher.doDispatch(UnicastingDispatcher.java:115)
    at org.springframework.integration.dispatcher.UnicastingDispatcher.dispatch(UnicastingDispatcher.java:102)
    at org.springframework.integration.channel.AbstractSubscribableChannel.doSend(AbstractSubscribableChannel.java:77)
    at org.springframework.integration.channel.AbstractMessageChannel.send(AbstractMessageChannel.java:157)
    at org.springframework.integration.core.MessagingTemplate.doSend(MessagingTemplate.java:288)
    at org.springframework.integration.core.MessagingTemplate.doSendAndReceive(MessagingTemplate.java:318)
    at org.springframework.integration.core.MessagingTemplate.sendAndReceive(MessagingTemplate.java:239)
    at org.springframework.integration.core.MessagingTemplate.convertSendAndReceive(MessagingTemplate.java:274)
    at org.springframework.integration.gateway.MessagingGatewaySupport.doSendAndReceive(MessagingGatewaySupport.java:224)
    at org.springframework.integration.gateway.MessagingGatewaySupport.sendAndReceive(MessagingGatewaySupport.java:203)
    at org.springframework.integration.gateway.GatewayProxyFactoryBean.invokeGatewayMethod(GatewayProxyFactoryBean.java:306)
    at org.springframework.integration.gateway.GatewayProxyFactoryBean.doInvoke(GatewayProxyFactoryBean.java:269)
    at org.springframework.integration.gateway.GatewayProxyFactoryBean.invoke(GatewayProxyFactoryBean.java:260)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy16.findAllCoffeeBeverages(Unknown Source)
    at org.springframework.integration.Main.main(Main.java:67)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:291)
    at java.lang.Thread.run(Thread.java:662) 
```

有谁知道为什么我会得到那个例外？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T16:55:51.267

有关解决方案，请参阅 Spring Integration Forum 的帖子：

[http://forum.springsource.org/showthread.php?135237-Spring-integration-oracle-store-procedures](http://forum.springsource.org/showthread.php?135237-Spring-integration-oracle-store-procedures)

# html - div height 100% 不工作 - 我想全高显示背景颜色

> ID：15121561
> 
> 赞同：0
> 
> 时间：2013-02-27T20:18:22.473
> 
> 标签：html, colors, background, height

我已经搜索没有成功...

我无法让 DIV 背景颜色跨越内容的高度

这是网站，我输入“测试”这个词只是为了看一眼颜色：

[http://learn.rupertport.com/?port_plan=grain-on-the-move](http://learn.rupertport.com/?port_plan=grain-on-the-move)

任何帮助将不胜感激。

谢谢 - 尼基

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:03:49.703

您的问题是 DIV 有一个没有定义高度的父元素。

```
<div id="content" class="clearfix">
  <div id="PA-thumb">
    <div class="clearpathumb">testing</div>
  </div>
</div> 
```

因此，您需要给元素“PA-thumb”或元素“内容”一个定义的高度，以便让“测试”DIV 能够填充它。我下载了网页，如果我给其他元素之一指定高度，我就能让它填充到 100%。

# image - 使用 FancyBox 打开嵌入的图像，而不是在新窗口中

> ID：15121569
> 
> 赞同：0
> 
> 时间：2013-02-27T20:18:54.613
> 
> 标签：image, fancybox, embed

我的 /js/global.js 文件中的这部分代码会在单击时激活每个图像以在新窗口中打开。是否可以更改此代码以在 FancyBox 中打开每个代码？我已经为我正在运行的 Vanilla 论坛下载了一个 FancyBox 插件，它目前仅针对您单击帖子本身后嵌入在帖子中的图像。在主页上，单击图像会打开一个新窗口。

```
// Shrink large images to fit into message space, and pop into new window when clicked.
// This needs to happen in onload because otherwise the image sizes are not yet known.
    jQuery(window).load(function() {
       var props = ['Width', 'Height'], prop;
       while (prop = props.pop()) {
          (function (natural, prop) {
             jQuery.fn[natural] = (natural in new Image()) ? 
             function () {
                return this[0][natural];
             } : 
             function () {
                var 
                   node = this[0],
                   img,
                   value;
                if (node.tagName.toLowerCase() === 'img') {
                   img = new Image();
                   img.src = node.src,
                   value = img[prop];
                }
                return value;
             };
          }('natural' + prop, prop.toLowerCase()));
       }
       jQuery('div.Message img').each(function(i,img) {
          var img = jQuery(img);
          var container = img.closest('div.Message');
          if (img.naturalWidth() > container.width() && container.width() > 0) {
             img.wrap('<a href="'+$(img).attr('src')+'"></a>');
          }
       });
       // Let the world know we're done here
       jQuery(window).trigger('ImagesResized');
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:53:11.713

将特定*类*添加到包装的图像中，修改此行

```
img.wrap('<a href="'+$(img).attr('src')+'"></a>'); 
```

...进入这个：

```
img.wrap('<a class="fancybox" href="'+$(img).attr('src')+'"></a>'); 
```

`.fancybox`然后在自定义脚本中将fancybox绑定到该选择器（“ ”），例如：

```
$(".fancybox").fancybox(); 
```

这假设您已正确加载了 fancybox js 和 css 文件。

# c# - WebDav 命名空间架构

> ID：15121573
> 
> 赞同：2
> 
> 时间：2013-02-27T20:18:58.423
> 
> 标签：c#, webdav

任何人都可以为 DAV 提供任何 xml 架构：(WebDav) 命名空间来验证请求吗？

目标是在处理请求之前检查请求。我尝试使用 ggl 搜索任何内容，但我找不到任何 xsd :(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-02-04T14:13:12.123

我意识到这已经晚了 6 年，但以防其他人有这个问题......

```
<?xml version="1.0" encoding="UTF-8"?>
<schema xmlns="http://www.w3.org/2001/XMLSchema" targetNamespace="DAV:" xmlns:dav="DAV:" elementFormDefault="qualified">
  <element name="propfind">
    <complexType>
      <choice>
        <sequence>
          <element name="allprop" />
          <element name="include" type="dav:include" minOccurs="0" />
        </sequence>
        <element name="propname" />
        <element name="prop" type="dav:prop" />
      </choice>
    </complexType>
  </element>

  <element name="multistatus">
    <complexType>
      <sequence maxOccurs="1">
        <element ref="dav:response" minOccurs="0" maxOccurs="unbounded" />
        <element name="responsedescription" type="string" minOccurs="0" />
      </sequence>
    </complexType>
  </element>

  <element name="response">
    <complexType>
      <sequence>
        <element name="href" type="anyURI" />
        <choice>
          <sequence>
            <element name="href" type="anyURI" minOccurs="0" maxOccurs="unbounded" />
            <element name="status" type="string" />
          </sequence>
          <element name="propstat" type="dav:propstat" maxOccurs="unbounded" />
        </choice>
        <element ref="dav:error" minOccurs="0" />
        <element name="responsedescription" type="string" minOccurs="0" />
      </sequence>
    </complexType>
  </element>

  <element name="propertyupdate">
    <complexType>
      <choice minOccurs="0" maxOccurs="unbounded">
        <element name="remove" type="dav:prop-remove" />
        <element name="set" type="dav:prop-set" />
      </choice>
    </complexType>
  </element>

  <element name="lockinfo">
    <complexType>
      <sequence>
        <element name="lockscope" type="dav:lockscope" />
        <element name="locktype" type="dav:locktype" />
        <element name="owner" minOccurs="0" type="dav:owner" />
      </sequence>
    </complexType>
  </element>

  <element name="prop" type="dav:prop" />

  <element name="supportedlock">
    <complexType>
      <sequence>
        <element name="lockentry" minOccurs="0" maxOccurs="unbounded">
          <complexType>
            <sequence>
              <element name="lockscope" type="dav:lockscope" />
              <element name="locktype" type="dav:locktype" />
            </sequence>
          </complexType>
        </element>
      </sequence>
    </complexType>
  </element>

  <complexType name="owner" mixed="true">
    <sequence>
      <any namespace="##other" minOccurs="0" maxOccurs="unbounded" />
    </sequence>
    <anyAttribute />
  </complexType>

  <complexType name="lockscope">
    <choice>
      <element name="shared" />
      <element name="exclusive" />
    </choice>
  </complexType>

  <complexType name="locktype">
    <choice>
      <element name="write" />
    </choice>
  </complexType>

  <complexType name="prop-remove">
    <sequence>
      <element name="prop" type="dav:prop" />
    </sequence>
  </complexType>

  <complexType name="prop-set">
    <sequence>
      <element name="prop" type="dav:prop" />
    </sequence>
  </complexType>

  <complexType name="prop">
    <sequence>
      <any namespace="##any" minOccurs="0" maxOccurs="unbounded" />
    </sequence>
  </complexType>

  <complexType name="activelock">
    <sequence>
      <element name="lockscope" type="dav:lockscope" />
      <element name="locktype" type="dav:locktype" />
      <element name="depth">
        <simpleType>
          <restriction base="string">
            <enumeration value="0" />
            <enumeration value="1" />
            <enumeration value="infinity" />
          </restriction>
        </simpleType>
      </element>
      <element name="owner" type="dav:owner" minOccurs="0" />
      <element name="timeout" type="dav:timeout" />
      <element name="locktoken" type="dav:locktoken" minOccurs="0" />
      <element name="lockroot" type="dav:lockroot" />
    </sequence>
  </complexType>

  <simpleType name="timeout">
    <restriction base="string">
      <pattern value="(Infinite)|(Second-\d+)" />
    </restriction>
  </simpleType>

  <complexType name="lockentry">
    <sequence>
      <element name="lockscope" type="dav:lockscope" />
      <element name="locktype" type="dav:locktype" />
    </sequence>
  </complexType>

  <complexType name="lockroot">
    <sequence>
      <element name="href" type="anyURI" />
    </sequence>
  </complexType>

  <complexType name="locktoken">
    <sequence>
      <element name="href" type="anyURI" />
    </sequence>
  </complexType>

  <complexType name="include">
    <sequence>
      <any namespace="##any" minOccurs="0" maxOccurs="unbounded" />
    </sequence>
  </complexType>

  <element name="error">
    <complexType>
      <choice maxOccurs="unbounded">
        <element name="lock-token-matches-request-uri" />
        <element name="lock-token-submitted">
          <complexType>
            <sequence>
              <element name="href" type="anyURI" maxOccurs="unbounded" />
            </sequence>
          </complexType>
        </element>
        <element name="no-conflicting-lock">
          <complexType>
            <sequence>
              <element name="href" type="anyURI" minOccurs="0" maxOccurs="unbounded" />
            </sequence>
          </complexType>
        </element>
        <element name="no-external-entities" />
        <element name="preserved-live-properties" />
        <element name="propfind-finite-depth" />
        <element name="cannot-modify-protected-property" />
        <any namespace="##other" />
      </choice>
    </complexType>
  </element>

  <complexType name="propstat">
    <sequence>
      <element name="prop" type="dav:prop" />
      <element name="status" type="string" />
      <element ref="dav:error" minOccurs="0" />
      <element name="responsedescription" type="string" minOccurs="0" />
      <element name="location" type="dav:location" minOccurs="0" />
    </sequence>
  </complexType>

  <complexType name="location">
    <sequence>
      <element name="href" type="anyURI" />
    </sequence>
  </complexType>
</schema> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T22:00:10.937

1）您可以从规范中提取DTD，并使用JING进行转换。

2）话虽这么说：不要。您可能会创建对于完全有效的请求失败的代码（考虑排序和可扩展性规则）。

# php - 将html保存在数据库中而不进行清理然后像stackoverflow一样在代码标签中显示它是否安全？

> ID：15121575
> 
> 赞同：2
> 
> 时间：2013-02-27T20:19:04.583
> 
> 标签：php, mysql, html, security

我将 html 存储在数据库中，但数据库但服务器以 403 禁止错误响应...并且我将 html 存储为代码而不是用于实际渲染...例如，这个问题已成功发布，在我的服务器上它会给出 403 错误...

```
<!DOCTYPE HTML>
<html>
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.3.3-beta.js"></script>
    <script>
      var angularVelocity = 6;
      var angularVelocities = [];
      var lastRotations = 0;
      var controlled = false;
      var numWedges = 25;
      var angularFriction = 0.2;
      var target, activeWedge, stage, layer, wheel, pointer;

      function getAverageAngularVelocity() {
        var total = 0;
        var len = angularVelocities.length;

        if(len === 0) {
          return 0;
        }

        for(var n = 0; n < len; n++) {
          total += angularVelocities[n];
        }

        return total / len;
      }
      function purifyColor(color) {
        var randIndex = Math.round(Math.random() * 3);
        color[randIndex] = 0;
        return color;
      }
      function getRandomColor() {
        var r = 100 + Math.round(Math.random() * 55);
        var g = 100 + Math.round(Math.random() * 55);
        var b = 100 + Math.round(Math.random() * 55);
        var color = [r, g, b];
        color = purifyColor(color);
        color = purifyColor(color);

        return color;
      }
      function bind() {
        wheel.on('mousedown', function(evt) {
          angularVelocity = 0;
          controlled = true;
          target = evt.shape;
        });
        // add listeners to container
        document.body.addEventListener('mouseup', function() {
          controlled = false;
          angularVelocity = getAverageAngularVelocity() * 5;

          if(angularVelocity > 20) {
            angularVelocity = 20;
          }
          else if(angularVelocity < -20) {
            angularVelocity = -20;
          }

          angularVelocities = [];
        }, false);

        document.body.addEventListener('mousemove', function(evt) {
          var mousePos = stage.getMousePosition();
          if(controlled && mousePos && target) {
            var x = mousePos.x - wheel.getX();
            var y = mousePos.y - wheel.getY();
            var atan = Math.atan(y / x);
            var rotation = x >= 0 ? atan : atan + Math.PI;
            var targetGroup = target.getParent();

            wheel.setRotation(rotation - targetGroup.startRotation - (target.getAngle() / 2));
          }
        }, false);
      }
      function getRandomReward() {
        var mainDigit = Math.round(Math.random() * 9);
        return mainDigit + '\n0\n0';
      }
      function addWedge(n) {
        var s = getRandomColor();
        var reward = getRandomReward();
        var r = s[0];
        var g = s[1];
        var b = s[2];
        var angle = 2 * Math.PI / numWedges;

        var endColor = 'rgb(' + r + ',' + g + ',' + b + ')';
        r += 100;
        g += 100;
        b += 100;

        var startColor = 'rgb(' + r + ',' + g + ',' + b + ')';

        var wedge = new Kinetic.Group({
          rotation: 2 * n * Math.PI / numWedges,
        });

        var wedgeBackground = new Kinetic.Wedge({
          radius: 400,
          angle: angle,
          fillRadialGradientStartPoint: 0,
          fillRadialGradientStartRadius: 0,
          fillRadialGradientEndPoint: 0,
          fillRadialGradientEndRadius: 400,
          fillRadialGradientColorStops: [0, startColor, 1, endColor],
          fill: '#64e9f8',
          fillPriority: 'radial-gradient',
          stroke: '#ccc',
          strokeWidth: 2
        });

        wedge.add(wedgeBackground);

        var text = new Kinetic.Text({
          text: reward,
          fontFamily: 'Calibri',
          fontSize: 50,
          fill: 'white',
          align: 'center',
          stroke: 'yellow',
          strokeWidth: 1

        });

        // cache text as an image to improve performance
        text.toImage({
          width: text.getWidth(),
          height: text.getHeight(),
          callback: function(img) {
            var cachedText = new Kinetic.Image({
              image: img,
              listening: false,
              rotation: (Math.PI + angle) / 2,
              x: 380,
              y: 30
            });

            wedge.add(cachedText);
            layer.draw();
          }
        });

        wedge.startRotation = wedge.getRotation();

        wheel.add(wedge);
      }
      function animate(frame) {
        // handle wheel spin
        var angularVelocityChange = angularVelocity * frame.timeDiff * (1 - angularFriction) / 1000;
        angularVelocity -= angularVelocityChange;

        if(controlled) {
          if(angularVelocities.length > 10) {
            angularVelocities.shift();
          }

          angularVelocities.push((wheel.getRotation() - lastRotation) * 1000 / frame.timeDiff);
        }
        else {
          wheel.rotate(frame.timeDiff * angularVelocity / 1000);
        }
        lastRotation = wheel.getRotation();

        // activate / deactivate wedges based on point intersection
        var intersection = stage.getIntersection({
          x: stage.getWidth() / 2,
          y: 100
        });

        if(intersection) {
          var shape = intersection.shape;

          if(shape && (!activeWedge || (shape._id !== activeWedge._id))) {
            pointer.setY(20);
            pointer.transitionTo({
              y: 30,
              easing: 'elastic-ease-out',
              duration: 0.3
            });

            if(activeWedge) {
              activeWedge.setFillPriority('radial-gradient');
            }
            shape.setFillPriority('fill');
            activeWedge = shape;
          }
        }
      }
      function init() {
        stage = new Kinetic.Stage({
          container: 'container',
          width: 578,
          height: 200
        });
        layer = new Kinetic.Layer();
        wheel = new Kinetic.Group({
          x: stage.getWidth() / 2,
          y: 410
        });

        for(var n = 0; n < numWedges; n++) {
          addWedge(n);
        }
        pointer = new Kinetic.Wedge({
          fillRadialGradientStartPoint: 0,
          fillRadialGradientStartRadius: 0,
          fillRadialGradientEndPoint: 0,
          fillRadialGradientEndRadius: 30,
          fillRadialGradientColorStops: [0, 'white', 1, 'red'],
          stroke: 'white',
          strokeWidth: 2,
          lineJoin: 'round',
          angleDeg: 30,
          radius: 30,
          x: stage.getWidth() / 2,
          y: 30,
          rotationDeg: -105,
          shadowColor: 'black',
          shadowOffset: 3,
          shadowBlur: 2,
          shadowOpacity: 0.5
        });

        // add components to the stage
        layer.add(wheel);
        layer.add(pointer);
        stage.add(layer);

        // bind events
        bind();

        var anim = new Kinetic.Animation(animate, layer);

        // wait one second and then spin the wheel
        setTimeout(function() {
          anim.start();
        }, 1000);
      }
      init();

    </script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-27T20:22:54.127

不，这样做是不安全的。假设您像这样输出html：

```
<code>
    user_submitted_html
</code 
```

并且用户提交

```
</code>
    <script>
        do_something_malicious();
    </script>
<code> 
```

把它放在一起会给你

```
<code>
</code>
    <script>
        do_something_malicious();
    </script>
<code>
</code> 
```

所以用户的脚本不再在代码块中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T20:20:58.577

您应该在将数据放入数据库之前对其进行序列化，然后在将其取出时对其进行反序列化。[http://php.net/manual/en/function.serialize.php](http://php.net/manual/en/function.serialize.php)

编辑：抱歉回答得太快了......正如[sys.stderr](https://stackoverflow.com/questions/15121575/is-it-safe-to-save-html-in-database-without-sanitizing-and-then-display-it-in-co#15121651)所说，您必须在序列化/显示数据之前对其进行清理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T20:28:59.297

只要您转义输入中的所有 html 字符，它就是安全的。如果使用 php，您希望通过内置函数[htmlspecialchars()](http://php.net/manual/en/function.htmlspecialchars.php)运行内容。这将阻止 Web 浏览器呈现 html，而是显示原始代码。

# vb.net - 我需要知道如何避免 vb 2010 中的 System.Data.DataRowview

> ID：15121576
> 
> 赞同：0
> 
> 时间：2013-02-27T20:19:06.793
> 
> 标签：vb.net, vb.net-2010, filewriter, databound-controls

我的代码有问题；并希望能得到一些帮助，让她做我想做的事，而不会出现烦人的错误。读取数据绑定列表框字符串，找到用户选择的字符串并将所述字符串写入文件。

```
 Private Sub btnContinue_Click(sender As System.Object, e
    As System.EventArgs) Handles btnContinue.Click
    '  1st file and mySQL Update to testing table
    If txtLocation.Text.ToString <> "" And txtUnitTested.Text.ToString <> "" Then 
        Dim filewriter As New System.IO.StreamWriter(
               "C:\Users\OER\Documents\Visual Studio 2010\Projects\frmTest1_0.txt")
        Dim curItem = lstCustomer.SelectedItem
        Dim now As DateTime = DateTime.Now
        With filewriter
            .WriteLine(vbCrLf + (now.ToString("F"))) ' Write the DateTime to the file
        End With

        For Each objDataRowView As DataRowView In lstCustomer.SelectedItems
            Dim item As String
            For Each item As DataRowView In Me.lstCustomer.Items.Item("customer")
                item = String.Parse(lstCustomer.SelectedValue)
                WriteLine(curItem(item))
            Next item
        Next '  THIS IS THE FOR LOOP I AM HAVING ISSUES WITH!!!!!!!

        With filewriter
            .WriteLine(vbCrLf + txtLocation.Text + vbCrLf + txtUnitTested.Text)
        End With
        filewriter.Close()
        frmTest1.Show()
    Else
        MsgBox("Please Type the Location and Unit Tested!!!", vbCritical)
        txtLocation.Clear()
        txtUnitTested.Clear()
        txtLocation.Focus()
    End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T21:09:05.363

这些循环：

```
For Each objDataRowView As DataRowView In lstCustomer.SelectedItems
     Dim item As String
     For Each item As DataRowView In Me.lstCustomer.Items.Item("customer")
         item = String.Parse(lstCustomer.SelectedValue)
             WriteLine(curItem(item))
     Next item
Next 
```

会给你带来一些问题。您已经声明了一个与另一个变量同名的循环变量。然后你给它赋值。

另外，我不太清楚这两个循环的目的是什么。我对您在这部分代码中要完成的工作感到有些困惑。我将从重命名这一行中的变量开始：

```
Dim item as String 
```

我将以此为例：

```
Dim result as string 
```

做别的东西，然后你不能在循环中更改 item 的值（因为那是循环变量）。这将导致错误。

将循环内的代码更改为：

```
result = String.Parse(lstCustomer.SelectedValue) 
```

很可能这仍然无法让您到达您想要去的地方，但这是一个好的开始。除非您的 lstCustomer 中的每个项目都包含多个要迭代的项目，否则我认为您可能只需要第一个外部循环。

如果你的循环是这样开始的：

```
For Each objDataRowView As DataRowView In lstCustomer.SelectedItems 
```

然后我想你会想要：

```
objDataRowView.Item("customer") 
```

作为输出。我认为这将是您表中客户字段的值。

您基本上是在说这一行有一个名为 customer.... 的列。我想要那个值。

# jquery - 在新窗口中打开外部链接并跟踪出站点击事件

> ID：15121582
> 
> 赞同：0
> 
> 时间：2013-02-27T20:19:25.967
> 
> 标签：jquery, google-analytics

我正在使用下面的代码来跟踪谷歌分析中的出站链接（在这个网站的某个地方找到它）。我有两个问题：

1.  有时，输出的 e.currentTarget.host 部分会显示我自己的域 - 而不是显示单击导致的域。知道为什么我的域名偶尔会出现吗？
2.  是否可以修改此代码以执行以下操作（1）强制链接在新窗口中打开和（2）跟踪出站点击事件，如图所示。

    ```
    $(function() {
    $("a").on('click',function(e){
        var url = $(this).attr("href");
        if (e.currentTarget.host != window.location.host) {
            _gat._getTrackerByName()._trackEvent("Outbound Links", e.currentTarget.host, url, 0);
            if (e.metaKey || e.ctrlKey) {
                var newtab = true;
            }
            if (!newtab) {
                e.preventDefault();
                setTimeout('document.location = "' + url + '"', 100);
            }
        }
    }); 
    ```

    });

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T22:02:09.590

1.  代码将链接中的域与窗口域进行比较：`e.currentTarget.host != window.location.host`-- 如果您的域有 www 前缀（如`www.domain.com`）但有一些链接没有它（如`domain.com/link.html`），它们将被视为外部链接。
2.  原始代码在设置 document.location 之前使用延迟来为 _trackEvent 的跟踪请求留出时间。由于您希望所有站外链接都在新窗口中打开，因此可以消除延迟。

无论任何 www 或子域前缀如何，以下代码都应该工作：

```
jQuery(function($) {
  $('a[href^="http://"],a[href^="https://"]')
    .not('[href*="mydomain.com"]')
    .click(function(e) {
      var url = this.href;
      _gat._getTrackerByName()._trackEvent("Outbound Links", e.currentTarget.host, url, 0);
      e.preventDefault();
      window.open(url);
    })
}); 
```

*   `$('a[href^="http://"],a[href^="https://"]')``http://`-- 选择以或开头的链接`https://`。这应该包括所有出站链接。
*   `.not('[href*="mydomain.com"]')`- 丢弃任何包含 的链接`mydomain.com`，以防万一有任何以`http://`...开头的内部链接
*   `e.preventDefault();`-- 防止链接被正常关注。

此外，如果您使用当前的异步 Google Analytics 代码，您可以将 _trackEvent 调用缩短为

```
_gaq.push(['_trackEvent', 'Booking', "Outbound Links", e.currentTarget.host, url, 0]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:35:22.760

1.  通过使用您编写的代码`<a>`，您网站的所有元素都会受到影响。这显然应该包括一些指向您自己网站的链接，除非您的网站没有菜单，我相信这显然是有的。
2.  加载页面后，也许您可​​以使用 jQuery 为`target="_blank"`所有链接添加属性。

# jquery - fancybox.js，缺少精灵，Rails 的异常照片行为

> ID：15121583
> 
> 赞同：2
> 
> 时间：2013-02-27T20:19:32.447
> 
> 标签：jquery, css, ruby-on-rails-3, fancybox

如果有人熟悉[Fancybox](http://fancybox.net)，也许您可​​以帮助我解决我遇到的几个问题：

首先，当我单击图像时，背景中的图像会消失。如果我继续单击图像，最终所有图像都会消失。

我遇到的另一个问题是上一个，下一个，精灵没有出现或工作。

它应该看起来像这样，但它不是：

![在此处输入图像描述](../Images/70301f80ace8d7ca118afe6a6bcf4ee6.png)

这是我的一些代码：

列出 show.html.erb：

```
<div class="span4">

<% @listing.images.each_with_index do |image, index| %>
          <%if index == 0 %>

              <%= image_tag image.file, :class => "thumbnail"%>

          <%elsif index == 1%>
            <ul class="thumbnails small">               
              <li class="span4">
                <%= image_tag image.file, :class => "thumbnail"%>
              </li>                                 

          <%elsif index ==2%> 
              <li class="span4">
                <%= image_tag image.file, :class => "thumbnail"%>
              </li> 
          <%elsif index ==3%> 
              <li class="span4">
                <%= image_tag image.file, :class => "thumbnail"%>
              </li>
          <%else%> 
          </ul>          
          <%end%>        

        <% end %> 
      </div> 
```

jquery.fancybox.css.scss

```
#fancybox-loading, .fancybox-close, .fancybox-prev span, .fancybox-next span {
    background-image: url('fancybox_sprite.png');
} 
```

Listing.js.cofee

```
$ ->
  $("#myTab a:first").tab "show"
  $("#myTab a").click (e) ->
    e.preventDefault()
    $(this).tab "show"

$(document).ready ->
  $(".thumbnail").fancybox
    openEffect: "none"
    closeEffect: "none"

  $(".carousel").carousel interval: false 
```

我正在使用的 fancybox javascript 文件 css 文件[在 jsfiddle 上](http://jsfiddle.net/beamon/u96xZ/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T21:05:34.887

问题是您通过 将fancybox 绑定到`<img />`标签，`class="thumbnail"`因此它们被视为***内联***内容（`display:none;`当关闭fancybox 时，内联内容已设置为返回到文档流中的位置）

您要做的是将图像包装在锚`<a>`标记中并将其设置`class="thumbnail"`为该锚，因此不要使用此（呈现的html）

```
<img class="thumbnail" src="images/01.jpg" alt="" /> 
```

...你应该有这个：

```
<a class="thumbnail" href="images/01.jpg" rel="gallery"><img src="thumbs/01.jpg" alt="" /></a> 
```

关于`prev`,`next`和`close`图标，请确保该`fancybox_sprite.png`文件与 fancybox css 文件位于同一目录中

# json - 如何通过node.js中的JSONStream模块解析一个大的、换行符分隔的JSON文件？

> ID：15121584
> 
> 赞同：26
> 
> 时间：2013-02-27T20:19:33.930
> 
> 标签：json, node.js, jsonlines

我有一个大的 json 文件，它是换行符分隔的 JSON，其中多个标准 JSON 对象由额外的换行符分隔，例如

```
{'name':'1','age':5}
{'name':'2','age':3}
{'name':'3','age':6} 
```

我现在在 node.js 中使用 JSONStream 来解析一个大的 json 文件，我使用 JSONStream 的原因是因为它是基于流的。

但是，示例中的两种解析语法都无法帮助我解析这个 json 文件，每行中都有单独的 JSON

```
var parser = JSONStream.parse(**['rows', true]**);
var parser = JSONStream.parse([**/./**]); 
```

有人可以帮我吗

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-28T00:57:08.333

**警告**：由于编写了此答案，因此 JSONStream 库的作者[删除了发出根事件功能](https://github.com/dominictarr/JSONStream/commit/97d973ac59d0e58748cec98ea87aae36e057d368)，显然是为了修复内存泄漏。这个库的未来用户，如果你需要发出根功能，你可以使用 0.xx 版本。

**以下是未经修改的原始答案**：

从[自述文件](https://github.com/dominictarr/JSONStream#jsonstreamparsepath)：

> ## JSONStream.parse(路径)
> 
> `path`应该是属性名称、正则表达式、布尔值和/或函数的数组。任何与路径匹配的对象都将作为`'data'`.
> 
> `'root'`收到所有数据后会发出一个事件。该`'root'`事件传递根对象和匹配对象的计数。

在您的情况下，由于您想要取回 JSON 对象而不是特定属性，因此您将使用该`'root'`事件并且不需要指定路径。

您的代码可能如下所示：

```
var fs = require('fs'),
    JSONStream = require('JSONStream');

var stream = fs.createReadStream('data.json', {encoding: 'utf8'}),
    parser = JSONStream.parse();

stream.pipe(parser);

parser.on('root', function (obj) {
  console.log(obj); // whatever you will do with each JSON object
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-12-11T10:36:07.250

JSONstream 旨在解析单个巨大的 JSON 对象，而不是很多 JSON 对象。您想在换行符处拆分流，然后将它们解析为 JSON。

NPM 包[split](https://www.npmjs.com/package/split)声称可以进行这种拆分，甚至具有为您[解析 JSON 行](https://www.npmjs.com/package/split#ndj---newline-delimited-json)的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-04T08:40:10.763

如果您的文件不够大，这是一个简单但不高效的解决方案：

```
const fs = require('fs');

let rawdata = fs.readFileSync('fileName.json');

let convertedData = String(rawdata)
    .replace(/\n/gi, ',')
    .slice(0, -1);

let JsonData= JSON.parse(`[${convertedData}]`); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-15T18:45:33.840

我创建了一个`@jsonlines/core`将 jsonlines 解析为对象流的包。

您可以尝试以下代码：

```
npm install @jsonlines/core 
```

```
const fs = require("fs");
const { parse } = require("@jsonlines/core");

// create a duplex stream which parse input as lines of json
const parseStream = parse();

// read from the file and pipe into the parseStream
fs.createReadStream(yourLargeJsonLinesFilePath).pipe(parseStream);

// consume the parsed objects by listening to data event
parseStream.on("data", (value) => {
  console.log(value);
}); 
```

请注意，这`parseStream`是一个标准节点双工流。所以你也可以使用`for await ... of`或其他方式来消费它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-21T18:31:52.753

当文件足够小以适合内存时，这是另一种解决方案。它一次性读取整个文件，通过在换行符处拆分它（删除末尾的空白行）将其转换为数组，然后解析每一行。

```
import fs from "fs";

const parsed = fs
  .readFileSync(`data.jsonl`, `utf8`)
  .split(`\n`)
  .slice(0, -1)
  .map(JSON.parse) 
```

# c - 使用结构与 c 程序联系管理器

> ID：15121586
> 
> 赞同：0
> 
> 时间：2013-02-27T20:19:41.917
> 
> 标签：c, visual-studio-2012, system, structure, contact

```
 struct contact
       {
       char name[20],email[20];
       int hpnum;
       }add;
   int option;

       int main (void)
       {
    system("cls");
    printf("==========Welcome to Jeffery's Contact System Management==========\n");
    printf("\t\t\tContact System Main Menu\n");
    printf("[1] Create a New Contact\n");
    printf("[2] Modified Existing Contact\n");
    printf("[3] Delete Existing Contact\n");
    printf("[4] Search Existing Contact\n");
    printf("[5] Exit\n");
    printf("Please enter one of your option.\n");
    scanf("%d",option);

    switch(option)
    {
        //add new contact
        case 1:
        printf("Contact Name: ");
        scanf("%s",&add.name);
        printf("\nHandphone Number: ");
        scanf("%d",&add.hpnum);
        printf("\nE-mail: ");
        scanf("%s",add.email);
        break;
    }

getch();
    } 
```

这个编码有什么问题？我可以运行它，但一旦选择否。1、有错误。如果我的编码错误，请通知我。我还是个初学者，希望大家能帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:32:28.630

您忘记在*选项*变量`ampersand &`之前添加。

 *```
 scanf("%d",option); 
```

应该

```
 scanf("%d",&option); 
```

option 是一个 int，所以这里需要`&`在 scanf 中。

**第二：**＆符号需要在*add.name之前删除*

```
 scanf("%s",&add.name) 
```

应该

```
 scanf("%s",add.name) 
```

*add.name*是我们不需要的字符`&`数组`%s`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:23:00.393

`fflush(stdout);`在这两个语句之间添加一个：

```
 printf("Contact Name: ");
    scanf("%s",&add.name); 
```

与您的其他`printf`不以`\n`字符结尾的语句相同。

并且对于信息`s`转换说明符需要一个指针，`char`所以不要使用`&`运算符而只需调用`scanf("%s", add.name)`.*

# ruby-on-rails-3 - Rails 3从部分导出csv？

> ID：15121588
> 
> 赞同：0
> 
> 时间：2013-02-27T20:19:47.703
> 
> 标签：ruby-on-rails-3

我在这个主题上关注了 RBate 的[Railscast](http://railscasts.com/episodes/362-exporting-csv-and-excel)，但我有一个 caviat。

该视图以定义表变量的表单开始。单击提交后，表单将返回到同一视图并重新呈现部分（这只是 HTML 表）。这不是 AJAX，都是表单参数。

RBates 使用单个变量并在其上调用 .to_csv。我有一个复杂的表，其中包含由参数定义的许多变量，因此不知道如何在整个 HTML 表上调用 .to_csv 。

我需要能够只导出部分结果。

提前感谢您的想法。

&&&&&&&& 应要求，示例代码：&&&&&&&&

所以，完整的代码可能比有用更令人困惑，但这里有一个精简的版本：

**stats/reporter.html.erb：**（stat_reporter_path 匹配此 URI）

```
<%= form_tag( :stat_reporter, method: :post ) do %>
    form is in here
    <%= submit_tag "Get my report" %>
<% end %>

<div>
    <%= render 'stat_select' %>
</div> 
```

**统计/_stat_select：**

```
<table>
  <thead>
    <tr>...column heads...</tr>
  </thead>
  <tbody>
    <% @counties.each do |c| %>
      <td><%= c.name %></td>
        <% c.programs.each do |p| %>
          <td><%= p.name %></td>
            <% p.events.each do |e| %>
              <td><%= e.name %></td>
...and so on...
</table> 
```

这是一个屏幕截图![截屏](../Images/d34460277f8b2071d42e51637b49cdca.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-02T03:48:08.033

回顾这篇文章，我会：

1.  创建指向新视图的链接并将所有变量传递到 URL 中。
2.  该视图将使用所有变量来创建可用于创建 to_csv 方法的 HTML 输出
3.  创建 csv 文件后，控制器将呈现原始视图。

# c# - 使用呼叫计数器创建功能

> ID：15121593
> 
> 赞同：-1
> 
> 时间：2013-02-27T20:19:53.397
> 
> 标签：c#, .net

问题很简单：如何使调用代码尽可能简单？我的代码有点愚蠢，但我看不到。

```
using System;

namespace ConsoleApplication48
{
class FunctionWithCounter<T, TResult>
{
    private readonly Func<T, TResult> function;
    public int Calls { get; private set; }

    private FunctionWithCounter(Func<T, TResult> function)
    {
        Calls = 0;
        this.function = function;
    }

    public static implicit operator FunctionWithCounter<T, TResult>(Func<T, TResult> func)
    {
        return new FunctionWithCounter<T, TResult>(func);
    }

    public TResult this[T arg]
    {
        get
        {
            Calls++;
            return function(arg);
        }
    }
}

class Program
{
    static void Main()
    {
        FunctionWithCounter<double, double> func = (Func<double, double>)(x => x*x);
        for (int i = 0; i < 5; i++)
        {
            double d = func[i];
        }
        Console.WriteLine(func.Calls);
        Console.ReadKey();
    }
}
} 
```

所以我使用索引器来调用这样的 func[x] 而不是 func(x)，并且有一些困难（不能像 void 方法那样调用）。但我认为这是最简单的。有什么优惠吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:50:39.540

对于 1 额外行的价格，我会将其恢复到至少正常的函数语法。还要摆脱隐式构造函数，它并不能真正为您节省任何东西，没有它，语法看起来更简单。

```
class FunctionWithCounter<T, TResult>
{
    public readonly Func<T, TResult> Function;
    public int Calls { get; private set; }

    public FunctionWithCounter(Func<T, TResult> function)
    {
        Calls = 0;
        Function = x =>
            {
                Calls++;
                return function(x);
            };
    }        
}

internal class Program
{
    private static void Main(string[] args)
    {
        var callCounter = new FunctionWithCounter<double,double>(x => x * x);
        var func = callCounter.Function;

        for (int i = 0; i < 5; i++)
        {
            double d = func(i);
        }
        Console.WriteLine(callCounter.Calls);
        Console.ReadKey();
    }
} 
```

# c++ - Freetype 缓存子系统教程

> ID：15121595
> 
> 赞同：3
> 
> 时间：2013-02-27T20:20:00.650
> 
> 标签：c++, opengl, graphics, freetype, text-rendering

我正在尝试在我的项目中使用[FreeType 2.4.11来使用 openGL 呈现文本。](http://www.freetype.org/)

虽然我初始化库，面对并将charmap设置为unicode只有一次。在每次绘制的字符循环中使用 FT_Load_Char 和 glTexImage2D 会使文本渲染减慢到不可接受的水平。

我需要一些适当的示例来说明如何在[FreeType CacheSubSystem](http://www.freetype.org/freetype2/docs/reference/ft2-cache_subsystem.html)中缓存字形以避免渲染延迟

unicode库、面、charmap的一次初始化如下

```
 if(m_FontLibrary == NULL)
        {
            if(!FT_Init_FreeType(&m_FontLibrary)) 
            {   
                if(!FT_New_Face(m_FontLibrary, "C:\\Windows\\winsxs\\amd64_microsoft-windows-f..etype-timesnewroman_31bf3856ad364e35_6.1.7601.17514_none_3b958c66aff6cdb7\\times.ttf", 0, &m_FontFace)) 
                {
                    FT_Set_Pixel_Sizes(m_FontFace, 0, 48);             
                    if(!FT_Load_Char(m_FontFace, 'X', FT_LOAD_RENDER)) 
                    {   
                        m_FontGlyph = m_FontFace->glyph;  

                        if(!FT_Select_Charmap(m_FontFace, FT_ENCODING_UNICODE))
                        {
                            loaded = true;
                        }
                    }
                }
            }
        } 
```

在屏幕刷新率上，rendermodel 函数调用 DrawText 函数，该函数循环遍历字符并加载字形并构造 Image 进行渲染。

```
const char *text = "Tetrode\0";
        const char *p; 
        for(p = text; *p; p++) 
        {  
            // Load a single glyph into the glyph slot of a face object, according to its character code.
            if(FT_Load_Char(m_FontFace, *p, FT_LOAD_RENDER))
                continue;

            // specify a two-dimensional texture image
            glTexImage2D(
                GL_TEXTURE_2D,                      // Target texture
                0,                                  // Base image level,  Level n is the nth mipmap reduction image
                GL_ALPHA,                           // Internal format
                m_FontGlyph->bitmap.width,          // Width of texture image
                m_FontGlyph->bitmap.rows,           // height of texture image
                0,                                  // Border, This value must be 0.
                GL_ALPHA,                           // Format of the pixel data.
                GL_UNSIGNED_BYTE,                   // Data type of the pixel data
                m_FontGlyph->bitmap.buffer          // Pointer to the image data in memory.
                );

            float x2 = x + m_FontGlyph->bitmap_left * sx;
            float y2 = -y - m_FontGlyph->bitmap_top * sy;
            float w = m_FontGlyph->bitmap.width * sx;
            float h = m_FontGlyph->bitmap.rows * sy;

            GLfloat box[4][4] = {
                {x2,     -y2    , 0, 0},
                {x2 + w, -y2    , 1, 0},
                {x2,     -y2 - h, 0, 1},
                {x2 + w, -y2 - h, 1, 1},
            };

            glBufferData(GL_ARRAY_BUFFER, sizeof box, box, GL_DYNAMIC_DRAW);
            glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);

            x += (m_FontGlyph->advance.x >> 6) * sx;
            y += (m_FontGlyph->advance.y >> 6) * sy;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:53:26.263

我已经使用 FreeType 完成了一个项目，其中我使用了缓存机制来加速绘图。不幸的是，我没有依赖内置缓存，而是自己制作。实际上，我所做的只是使用 std::map 并将字符与位图相关联。如果字符在地图中，则使用它的缓存版本，否则将其添加到缓存中，然后使用缓存版本。

# apache - 如何创建自定义 Apache 503 错误页面

> ID：15121599
> 
> 赞同：9
> 
> 时间：2013-02-27T20:20:08.467
> 
> 标签：apache, http-status-code-503

我创建了一个 HTML 文档，它将显示服务器尚未准备好，然后重定向到另一个页面。我希望这是 503 错误页面。

我需要在 Apache 中编辑什么文件才能让这个自定义 HTML 成为我的新 503 错误页面？我已经尝试按照多个网站上的说明进行操作，但它仍然指向原始的 Apache 网站。

这是我在“httpd-vhosts.conf”文件中的代码。

```
<VirtualHost *:80>
ServerAdmin blah@blah.com
ServerName blah.blah.com
ServerAlias blah blah.blah.local
ErrorLog "logs/blah-error.log"
CustomLog "logs/blah-access.log" common
ErrorDocument 503 "D:/Program Files/Apache Software Foundation/Tomcat 6.0/webapps/blah/error.html"
LogLevel warn
RewriteEngine On
JkMount /* worker5
DocumentRoot "D:/Program Files/Apache Software Foundation/Tomcat 6.0/webapps/blah"
<Directory "D:/Program Files/Apache Software Foundation/Tomcat 6.0/webapps/blah">
            Options All
            AllowOverride All
            Order allow,deny
            Allow from all
    </Directory>
</VirtualHost> 
```

在“httpd.conf”文件中，它包含“httpd-vhosts.conf”文件，所以我不知道为什么它不起作用。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-20T06:01:10.037

`ErrorDocument`接受绝对 URL 路径而不是文件路径。所以应该是：

```
ErrorDocument 503 /blah/error.html 
```

假设您的文档根目录下是一个`/blah/error.html`文件。

# email - 我的 Drupal 电子邮件设置在哪里？

> ID：15121600
> 
> 赞同：6
> 
> 时间：2013-02-27T20:20:12.943
> 
> 标签：email, drupal, dashboard

真丢人。:(

我忘记了在哪里配置了 Drupal 站点中使用的电子邮件帐户。我想我在安装 Drupal 时设置了电子邮件，这可能吗？Drupal 是否关心注册电子邮件地址和接收邮件？

我将这个地址的所有邮件转发到我的私人电子邮件地址，但我真的不知道我在哪里注册了 drupal 地址以及我在哪里告诉 Drupal 将邮件转发到我的私人地址。

在 Drupal 仪表板中，我找不到电子邮件帐户的设置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T20:25:22.443

Drupal 6 站点电子邮件存储在“站点配置”->“站点信息”（管理员/设置/站点信息）。

Drupal 7 存储在“配置”->“站点信息”（admin/config/system/site-information）。

Drupal 不处理接收电子邮件或转发电子邮件。此设置设置大多数通用站点电子邮件（新帐户、忘记密码等）的发件人地址。您必须已通过您的邮件托管服务提供商配置了转发。

# c# - 什么是 paypal api 的 txn_id 以及为什么要检查它以及如何检查？

> ID：15121604
> 
> 赞同：3
> 
> 时间：2013-02-27T20:20:20.890
> 
> 标签：c#, asp.net, paypal

我目前正在使用贝宝的 api 来检查使用 IPN 检查的付款。在 paypal 检查付款是否已验证的方法中，有一条评论说：

//检查 txn_id 是否之前没有被处理过

但我不明白 ths txn_id 是什么，它做了什么，为什么我需要检查它以及如何检查它。

提前致谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T20:38:22.267

这是由 PayPal 生成的唯一交易 ID。

您将其与您的订单相关联，然后贝宝将其与该订单的结果一起报告给您。

您使用它来**防止欺诈**，例如您所做的事情，当您确认您的订单正常时，您读取该号码并搜索您的数据库以查看这是否与其他订单相关联。如果您再次找到它，则意味着潜​​在的欺诈正在进行中，有些是向您购买东西，比如说 5 欧元的物品，几个月后，尝试向您订购 100 欧元的物品，有些是如何重播给您的使用旧的验证状态 id -**尝试重用旧的完整事务**。但是因为那个状态 ID 是独一无二的，所以你抓住了他。

要使用它，请将该 ID 与您订单的唯一 ID 连接，并保留该连接以供检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-21T17:59:25.643

`txn_id`是原始交易的 PayPal 分配的唯一标识符。

该事务的所有后续 IPN 消息都将使用它，`txn_id`以便您可以将它们绑定到原始消息。确保将其与适用订单的数据一起保存。

`Completed`IPN 消息是您必须处理的唯一消息，因为它是确认付款已完成*的消息。*否则，你为什么需要担心 IPN？带有该消息的 POST 变量将有足够的客户详细信息供您用于生成发票和交货单/标签。

您可以选择处理其他 IPN 消息，但这取决于您要编程的程度。基本上，您的大部分销售将通过仅处理`Completed`消息来顺利处理。任何其他消息都将与您将收到的正常电子邮件并行，并且您可能必须手动追踪其他任何内容，例如退款或争议。

为什么他们要求您检查它以前没有被处理过，*不是*为了欺诈，而只是为了确保您不会`Completed`再次处理 IPN 消息，因为最多可能会在一天后向您发送五个，因为IPN 流程弹性的一部分。

例如，如果您在收到 IPN 消息时发出商品，如果您收到另一条相同的`Completed`IPN 消息，您不想再次发出。`Completed``txn_id`

基本上，当您收到一条`Completed`IPN 消息时，您需要使用 that 检查您的订单`txn_id`，如果找到，并且如果订单已标记为已付款并已处理，那么您可以忽略该消息，否则，将其处理为订单*的*付款，并按照您通常在付款时执行的操作。

Refunds 等会有自己的`txn_id`，但它们的 IPN 消息将包括`parent_txn_id`，其中包含`txn_id`原始交易的退款。

请注意，PayPal 希望您检查其他返回值的正确性，这些值用于欺诈。有些是：

1.  `receiver_email`字段与您用于访问 PayPal 帐户的主要电子邮件地址相匹配。它不一定与付款按钮一起使用。
2.  确保消息中返回的项目成本和其他详细信息对于项目是正确的。这可以防止客户给自己打折。

# ios - getEnhancedMicrophone() 在 IOS 的空中移动设备上不起作用（减少回声）

> ID：15121605
> 
> 赞同：3
> 
> 时间：2013-02-27T20:20:23.290
> 
> 标签：ios, mobile, video, air, chat

我在 iOS 上的 flex 移动应用程序有问题。它是一个带有 red5 服务器的视频聊天应用程序。

视频效果很好，但声音有很大的回声！我尝试使用`getEnhancedMicrophone()`，但没有帮助。

如何在 IOS 上消除或抑制回声？

我在 Flash Builder 4.6 和 Air 3.5 上工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-24T22:07:14.893

没有已知的解决方案。

Adobe 多年来一直承诺修复，但该解决方案需要访问来自 Google 的非开源 Android 源代码。我在使用 Adob​​e Air 的 Android 上使用 videoChat 应用程序时遇到了同样的问题。我尝试了解决方法：

1.  切换`mic.setLoopback(false/true)`计时器以中断音频
2.  尝试检测来自 NetStream 的声音并将本地设备麦克风增益设置为 0 问题是我无法检测到是否有人在通过 NetStream 通话。
3.  使用 NetStreamInfo 音频属性`audioBytesPerSecond`，但当有人通过 NetStream 交谈时，这些属性不会跳转。
4.  如果用户在移动端戴耳机，问题就解决了，但这是不可接受的。

# django - 使用 Tastypie 将 POST 转换为 PUT

> ID：15121611
> 
> 赞同：1
> 
> 时间：2013-02-27T20:20:42.023
> 
> 标签：django, tastypie

全面披露：交叉发布到 Tastypie Google Group

我有一种情况，我对发送到我的 api 的内容的控制有限。本质上，我需要能够接受来自的 POST 数据的两个 Web 服务。两者都使用带有 urlencoded 数据的普通 POST 操作（本质上是基本表单提交）。

用“卷曲”术语思考它就像：

```
curl --data "id=1&foo=2" http://path/to/api 
```

我的问题是我无法使用 POST 更新记录。所以我需要调整模型资源（我相信），这样如果指定了 ID，则 POST 充当 PUT 而不是 POST。

# api.py

```
class urlencodeSerializer(Serializer):
    formats = ['json', 'jsonp', 'xml', 'yaml', 'html', 'plist', 'urlencoded']
    content_types = {
        'json': 'application/json',
        'jsonp': 'text/javascript',
        'xml': 'application/xml',
        'yaml': 'text/yaml',
        'html': 'text/html',
        'plist': 'application/x-plist',
        'urlencoded': 'application/x-www-form-urlencoded',
        }
    # cheating
    def to_urlencoded(self,content): 
        pass
    # this comes from an old patch on github, it was never implemented
    def from_urlencoded(self, data,options=None):
        """ handles basic formencoded url posts """
        qs = dict((k, v if len(v)>1 else v[0] )
            for k, v in urlparse.parse_qs(data).iteritems())
        return qs

class FooResource(ModelResource):
    class Meta:
        queryset = Foo.objects.all() # "id" = models.AutoField(primary_key=True)
        resource_name = 'foo'
        authorization = Authorization() # only temporary, I know.
        serializer = urlencodeSerializer() 
```

# 网址.py

```
foo_resource = FooResource

...
url(r'^api/',include(foo_resource.urls)),
) 
```

在 Freenode 上的#tastypie 中，Ghost[] 建议我通过在模型资源中创建一个函数来覆盖 post_list()，但是，我还没有成功使用它。

```
def post_list(self, request, **kwargs):
    if request.POST.get('id'): 
        return self.put_detail(request,**kwargs) 
    else: 
        return super(YourResource, self).post_list(request,**kwargs) 
```

不幸的是，这种方法对我不起作用。我希望更大的社区可以为这个问题提供一些指导或解决方案。

注意：我无法覆盖来自客户端的标头（根据：[http](http://django-tastypie.readthedocs.org/en/latest/resources.html#using-put-delete-patch-in-unsupported-places) ://django-tastypie.readthedocs.org/en/latest/resources.html#using-put-delete-patch-in-unsupported-places ）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T10:46:36.830

```
from tastypie.validation import Validation

class MyValidation(Validation):

    def is_valid(self, bundle, request=None):
        errors = {}
        #if this dict is empty validation passes. 

        my_foo = foo.objects.filter(id=1)
        if not len(my_foo) == 0: #if object exists      
            foo[0].foo = 'bar'    #so existing object updated
            errors['status'] = 'object updated'  #this will be returned in the api response

        return errors 

    #so errors is empty if object does not exist and validation passes. Otherwise object
    #updated and response notifies you of this

class FooResource(ModelResource):
    class Meta:
        queryset = Foo.objects.all() # "id" = models.AutoField(primary_key=True)
        validation = MyValidation() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:13:35.787

我在创建用户时遇到了类似的问题，我无法检查记录是否已经存在。我最终创建了一个自定义验证方法，该方法验证用户是否不存在，在这种情况下，post 可以正常工作。如果用户确实存在，我会从验证方法更新记录。api 仍然返回 400 响应，但记录已更新。感觉有点hacky但是...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T09:02:44.630

在 Cathal 的建议下，我能够利用验证功能来更新我需要的记录。虽然这不会返回有效代码......但它可以工作。

```
from tastypie.validation import Validation
import string # wrapping in int() doesn't work

class Validator(Validation): 
    def __init__(self,**kwargs):
        pass

    def is_valid(self,bundle,request=None):
        if string.atoi(bundle.data['id']) in Foo.objects.values_list('id',flat=True):
                # ... update code here
        else:
            return {} 
```

确保`validation = Validator()`在`ModelResource`元数据中指定。

# javascript - 为什么缩小的 jQuery 有换行符？

> ID：15121614
> 
> 赞同：2
> 
> 时间：2013-02-27T20:20:50.913
> 
> 标签：javascript, jquery, minify

[我在我的网站上包含了jQuery 1.9.1](http://code.jquery.com/jquery-1.9.1.min.js)的缩小版本，并注意到 javascript 代码有 2 个换行符。换行是否有原因？我认为缩小器应该删除这些。如果我删除它们，它看起来仍然有效，但我不确定这样做是否有任何风险。

# javascript - 如何让 1 个“oninput”字段产生多个“output”字段？

> ID：15121622
> 
> 赞同：0
> 
> 时间：2013-02-27T20:21:05.347
> 
> 标签：javascript, html, output

我的意思是，我希望有人能够在输入框中输入一个数字，并让它产生一个范围。因此，如果他们输入数字`2`，它会显示输出`2*300-2*400 (600-800)`。

我一直在使用

```
 <form oninput="x.value=parseInt(a.value)*parseInt(300)">

 <input type="text" name="a" value="">

 <output name="x" for="a b"></output> 
```

但是，这只会产生`variable*300`. 如何在第一个输出框之后直接获得第二个输出框`variable*400`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:24:26.500

```
<form oninput="x.value=parseInt(a.value)*parseInt(300);y.value=parseInt(a.value)*parseInt(400);">

<input type="text" name="a" value="">

<output name="x" for="a b"></output>
<output name="y" for="a b"></output> 
```

# entity-framework - Visual Studio 2012 组解决方案需要每个开发人员单独的连接字符串

> ID：15121624
> 
> 赞同：1
> 
> 时间：2013-02-27T20:21:18.037
> 
> 标签：entity-framework, visual-studio-2012, ef-code-first

我们有一个项目目前正在由 5 名开发人员开发，并且随时可能获得更多。开发商位于美国的不同地方。我们的后端是基于 SQL Server 数据库的 Code First Entity Framework。

一些开发人员拥有 SQL Server Express，而一些开发人员拥有成熟的 SQL Server。我们需要一种方法让每个人都在使用解决方案，但每个开发人员都需要有自己的数据连接字符串，以便他们可以连接到各自的实例。我们不能使用 localhost，因为 express 版本具有 SQLEXPRESS 的命名实例。

当我们从 Git 中获取代码时，我们可以只更改连接字符串，但是每次我们同步时，我们都会遇到要合并的冲突，这样会很痛苦。

有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:36:18.680

一个非常简单的解决方案是让每个人都使用 SQL Server Express 或 SQL Server Developer Edition。您可以并排安装两个，所以这应该不是问题。特别是因为 SQL Express 是免费的...

另一种选择是[使用预定义的名称在每个客户端上定义 SQL Server 连接别名](http://blogs.msdn.com/b/sql_protocols/archive/2007/01/07/connection-alias.aspx)。然后将别名添加到您的`.config`. 这样，SQL 客户端将解析到正确的数据库，您可以在`.config`.

第三种解决方案是在本地工作区[添加`configsource="connectionstrings.config"`并创建这些文件，但不要将它们签入](http://www.mojoportal.com/using-separate-files-for-config-sections.aspx). 您可以添加一个`connectionstrings.template.config`并签入以提供一个起点。这些文件不需要成为解决方案的一部分。

第四个选项是将连接字符串存储在`.Settings`文件中，将其设置为用户并使用标准配置 API 将连接字符串存储在用户配置文件的应用程序设置文件夹中。您需要将连接字符串传递给 Context 类的构造函数。

# r - 将 .BY 与查找表一起使用 - 意外结果

> ID：15121631
> 
> 赞同：4
> 
> 时间：2013-02-27T20:21:47.957
> 
> 标签：r, data.table

我想`dt`根据查找表创建一个变量`k`。根据我如何提取感兴趣的变量，我得到了一些意想不到的结果`k`。

```
dt <- data.table(x=c(1:10))
setkey(dt, x)

k <- data.table(x=c(1:5,10), b=c(letters[1:5], "d"))
setkey(k, x)

dt[,b:=k[.BY, list(b)],by=x]

dt  #unexpected results
#      x  b
#  1:  1  1
#  2:  2  2
#  3:  3  3
#  4:  4  4
#  5:  5  5
#  6:  6  6
#  7:  7  7
#  8:  8  8
#  9:  9  9
# 10: 10 10

dt <- data.table(x=c(1:10))
setkey(x, x)

dt[,b:=k[.BY]$b,by=x]

dt  #expected results
#      x  b
#  1:  1  a
#  2:  2  b
#  3:  3  c
#  4:  4  d
#  5:  5  e
#  6:  6 NA
#  7:  7 NA
#  8:  8 NA
#  9:  9 NA
# 10: 10  d 
```

谁能解释为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:26:07.420

您根本不必在`by=.`这里使用。

# 第一个解决方案：

设置适当的键并使用 X[Y] 语法`data.table`：

```
require(data.table)
dt <- data.table(x=c(1:10))
setkey(dt, "x")
k <- data.table(x=c(1:5,10), b=c(letters[1:5], "d"))
setkey(k, "x")

k[dt]

#      x  b
#  1:  1  a
#  2:  2  b
#  3:  3  c
#  4:  4  d
#  5:  5  e
#  6:  6 NA
#  7:  7 NA
#  8:  8 NA
#  9:  9 NA
# 10: 10  d 
```

OP 说这会创建一个新的 data.table ，这对他来说是不可取的。

# 第二种解决方案

同样，没有`by`：

```
dt <- data.table(x=c(1:10))
setkey(dt, "x")
k <- data.table(x=c(1:5,10), b=c(letters[1:5], "d"))
setkey(k, "x")

# solution
dt[k, b := i.b] 
```

这不会创建新的`data.table`并提供您期望的解决方案。

# 解释为什么会发生意外结果：

**对于**您执行的第一种情况，`dt[,b:=k[.BY, list(b)],by=x]`. 在这里，`k[.BY, list(b)]`它本身返回一个`data.table`. 例如：

```
k[list(x=1), list(b)]

#    x b
# 1: 1 a 
```

所以，基本上，如果你愿意：

```
k[list(x=dt$x), list(b)] 
```

这也将为您提供所需的解决方案。要回答为什么你会得到你得到的东西`b := k[.BY, list(b)]`，因为 RHS 返回 a`data.table`并且你正在为它分配一个变量，它需要第一个元素并丢弃其余元素。例如，这样做：

```
dt[, c := dt[1], by=x] 
# you'll get the whole column to be 1 
```

**对于第二种情况**，要了解它的工作原理，您必须了解访问`data.table`as`k[6]`和之间的细微差别`k[list(6)]`，例如：

在第一种情况下`k[6]`，您正在访问 的第 6 个元素`k`，即`10 d`。但在第二种情况下，你要求一个`J, join`. 因此，它搜索 x = 6 （键列）并且由于没有任何 in `k`，它返回`6 NA`。在您的情况下，由于您使用`k[.BY]`which 返回一个列表，因此它是一个`J`获取正确值的操作。

我希望这有帮助。

# android - 将类绑定到Android中的视图/视图组？

> ID：15121633
> 
> 赞同：0
> 
> 时间：2013-02-27T20:21:56.680
> 
> 标签：android, viewgroup

在 Android 中，我有一个包含 2 个属性的类。我已经从中创建了许多对象并将它们放入 ArrayList，然后使用 ArrayAdapter 将 List 绑定到 TableView，如您所见。列表更改后，视图将更新。

问题是，如何将我的属性与表格行中的这两个 TextView 绑定（Android 中所谓的 ViewGroup）......？我试图将列表中的数据放入 2 个字符串数组：日期和值，但这很奇怪......

![](../Images/a3c61bd17d0b3ad87d423920a54c79f3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:50:14.177

在`getView()`您的适配器的方法中，使用[setTag()](http://developer.android.com/reference/android/view/View.html#setTag%28int,%20java.lang.Object%29)，传入您要附加的对象。然后，例如，您可以`onListItemClick()`通过调用`Log logItem = (Log) view.getTag()`.

# youtube-api - YouTube API：“仅限官方内容？”

> ID：15121635
> 
> 赞同：0
> 
> 时间：2013-02-27T20:22:06.993
> 
> 标签：youtube-api

使用 YouTube api 查询和检索视频时，有没有办法将结果限制为仅官方内容？我想检索某些艺术家的新音乐视频，但我想确保我只接收真实视频而不是 UGC 内容。这可以实现吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:42:02.660

没有搜索参数可确保您只取回“真实”的音乐视频。（而且“真实”视频和用户生成的内容之间的界限并不总是很清楚。）

# wso2 - WSO2 Identity Server 4.1.0：用户存储以只读模式运行。无法写入用户存储

> ID：15121636
> 
> 赞同：1
> 
> 时间：2013-02-27T20:22:09.777
> 
> 标签：wso2, readonly, wso2is

启动 WSO2 Identity Server 4.1.0 时出现以下错误：

```
[2013-02-27 17:00:33,192] ERROR {org.wso2.carbon.identity.mgt.IdentityMgtEventListener} -  Error while init identity listener
org.wso2.carbon.user.core.UserStoreException: User store is operating in read only mode. Cannot write into the user store.
at org.wso2.carbon.user.core.ldap.ReadOnlyLDAPUserStoreManager.doSetUserClaimValue(ReadOnlyLDAPUserStoreManager.java:1293)
at org.wso2.carbon.user.core.common.AbstractUserStoreManager.setUserClaimValue(AbstractUserStoreManager.java:823)
at org.wso2.carbon.identity.mgt.IdentityMgtEventListener.<init>(IdentityMgtEventListener.java:68)
at org.wso2.carbon.identity.mgt.internal.IdentityMgtServiceComponent.activate(IdentityMgtServiceComponent.java:89)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
... 
```

这意味着 WSO2 正在尝试写入 ldap，但我已将其配置为只读：

```
<UserStoreManager class="org.wso2.carbon.user.core.ldap.ReadOnlyLDAPUserStoreManager">
    <Property name="ReadOnly">true</Property>
    <Property name="MaxUserNameListLength">100</Property>
    <Property name="ConnectionURL">ldaps://xxxx:636</Property>
    <Property name="ConnectionName">uid=xxx,ou=xx,dc=xx,dc=xx,dc=x</Property>
    <Property name="ConnectionPassword">xxxxxx</Property>
    <Property name="passwordHashMethod">SHA</Property>
    <Property name="UserSearchBase">ou=xx,dc=x,dc=xx,dc=xx</Property>
    <Property name="UserNameListFilter">(objectClass=person)</Property>
    <Property name="UserNameAttribute">uid</Property>
    <Property name="ReadLDAPGroups">true</Property>
    <Property name="GroupSearchBase">ou=xx,dc=xx,dc=xx,dc=xx</Property>
    <Property name="GroupNameListFilter">(objectClass=posixGroup)</Property>
    <Property name="GroupNameAttribute">cn</Property>
    <Property name="MembershipAttribute">memberUid</Property>
    <Property name="UserRolesCacheEnabled">true</Property>
    <Property name="ReplaceEscapeCharactersAtUserLogin">true</Property>
    <Property name="maxFailedLoginAttempt">0</Property> 
</UserStoreManager> 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T01:48:05.090

您的只读用户存储应包含“admin”用户，该用户在 user-mgt.xml 顶部的领域配置部分中指定。

```
<AdminUser>
    <UserName>admin</UserName>
    <Password>admin</Password>
</AdminUser> 
```

由于找不到，WSO2 IS 正在尝试编写它。

# visual-studio-2010 - 如何将附加信息添加到测试结果详细信息

> ID：15121637
> 
> 赞同：0
> 
> 时间：2013-02-27T20:22:12.983
> 
> 标签：visual-studio-2010, unit-testing, vs-unit-testing-framework

我目前正在运行的 VS2010 中有一些基本的单元测试。我希望能够向“测试结果详细信息”屏幕添加一些附加信息（当单元测试完成时，在“测试结果”屏幕中右键单击它，然后选择“测试结果详细信息”）。目前它只列出了常见结果和一些标准信息。

![常见结果](../Images/955f97da30e92014acb2b1d42d2841c3.png)

有没有办法在测试结果中包含一些附加值？比如PreCleanup、初始化、Test、Post Cleanup等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:29:07.740

显然，写入的任何内容`System.Diagnostics.Debug.WriteLine`都将显示在调试跟踪窗格中。

![在此处输入图像描述](../Images/885b1788cd750794e532a0ac677e4411.png)

# web-services - 哪些（标准）协议提供对流的零碎访问？

> ID：15121640
> 
> 赞同：1
> 
> 时间：2013-02-27T20:22:15.377
> 
> 标签：web-services, rest, web-applications, streaming, protocols

我有一个应用程序，我需要以零碎的方式远程访问大文件。我会知道起始偏移量，但是 - 从该位置开始读取文件的某些前缀后，我将建立另一个新的偏移量，并且希望从这个新位置读取下一个 - 至关重要的是 - 已经遭受了最小的可能延迟。

我考虑过使用 HTTP - 发布一个详细说明开始传输的偏移量的请求 - 但我不想指定传输大小（大小太小会导致吞吐量低；大小太大会导致不可接受的延迟。）或断开打开的连接 - 因为这会在重新连接时产生延迟损失。

我考虑过使用 TCP/UDP 和套接字“自己动手”——但感觉好像这种方法涉及重新发明轮子。UDP 可能承诺最低延迟，但我无法用可靠性换取低延迟。

我非常有兴趣指出任何关于协议的标准（提案、RFC 等）来处理这种数据访问模式。也许已经在云存储的背景下开发了一种好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T16:31:43.600

我相信您想要的是 FTP 协议的变体（RFC 959：[https](https://www.rfc-editor.org/rfc/rfc959) ://www.rfc-editor.org/rfc/rfc959 ）。我认为没有任何既定的协议标准可以准确地说明您想要做什么，但是 FTP 非常接近。它使用两个连接，一个“控制连接”和一个“数据连接”。控制连接处理从客户端到服务器的命令传递并返回状态消息，数据连接单独用于传输数据。听起来这是您需要设置的系统。

您想要做的不同的主要事情是能够从文件中的任意偏移量中寻找和传输数据，这可以通过自定义命令轻松完成。根据您的设置，您可能能够获取 FTP 客户端和服务器的现有开源实现，并且只需添加您的自定义命令。

# java - 不可变/多态 POJO <-> JSON 序列化与 Jackson

> ID：15121643
> 
> 赞同：12
> 
> 时间：2013-02-27T20:22:28.247
> 
> 标签：java, json, inheritance, jackson, immutability

我正在尝试使用 Jackson 2.1.4 将不可变的 POJO 序列化到 JSON 和从 JSON 序列化，而无需编写自定义序列化程序并使用尽可能少的注释。我还想避免为了满足 Jackson 库而不得不添加不必要的 getter 或默认构造函数。

我现在陷入了例外：

JsonMappingException：没有找到适合类型 [简单类型，类 Circle] 的构造函数：无法从 JSON 对象实例化（需要添加/启用类型信息？）

编码：

```
public abstract class Shape {}

public class Circle extends Shape {
  public final int radius; // Immutable - no getter needed

  public Circle(int radius) {
    this.radius = radius;
  }
}

public class Rectangle extends Shape {
  public final int w; // Immutable - no getter needed
  public final int h; // Immutable - no getter needed

  public Rectangle(int w, int h) {
    this.w = w;
    this.h = h;
  }
} 
```

测试代码：

```
ObjectMapper mapper = new ObjectMapper();
mapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY); // Adds type info

Shape circle = new Circle(10);
Shape rectangle = new Rectangle(20, 30);

String jsonCircle = mapper.writeValueAsString(circle);
String jsonRectangle = mapper.writeValueAsString(rectangle);

System.out.println(jsonCircle); // {"@class":"Circle","radius":123}
System.out.println(jsonRectangle); // {"@class":"Rectangle","w":20,"h":30}

// Throws:
//  JsonMappingException: No suitable constructor found.
//  Can not instantiate from JSON object (need to add/enable type information?)
Shape newCircle = mapper.readValue(jsonCircle, Shape.class);
Shape newRectangle = mapper.readValue(jsonRectangle, Shape.class);

System.out.println("newCircle = " + newCircle);
System.out.println("newRectangle = " + newRectangle); 
```

非常感谢任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-27T20:38:13.117

您可以（根据 API）使用 @JsonCreator 注释构造函数并使用[@JsonProperty](http://fasterxml.github.com/jackson-annotations/javadoc/2.1.0/com/fasterxml/jackson/annotation/JsonProperty.html)[注释](http://fasterxml.github.com/jackson-annotations/javadoc/2.1.0/com/fasterxml/jackson/annotation/JsonCreator.html)参数。

```
public class Circle extends Shape {
    public final int radius; // Immutable - no getter needed

    @JsonCreator
    public Circle(@JsonProperty("radius") int radius) {
        this.radius = radius;
    }
}

public class Rectangle extends Shape {
    public final int w; // Immutable - no getter needed
    public final int h; // Immutable - no getter needed

    @JsonCreator        
    public Rectangle(@JsonProperty("w") int w, @JsonProperty("h") int h) {
        this.w = w;
        this.h = h;
    }
} 
```

编辑：也许您必须使用[@JsonSubTypes](http://fasterxml.github.com/jackson-annotations/javadoc/2.1.0/com/fasterxml/jackson/annotation/JsonSubTypes.html)注释 Shape 类，以便可以确定 Shape 的具体子类。

```
@JsonSubTypes({@JsonSubTypes.Type(Circle.class), @JsonSubTypes.Type(Rectangle.class)})
public abstract class Shape {} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T21:42:47.460

看看[Genson](http://code.google.com/p/genson/wiki/GettingStarted)库，它的一些关键特性正在解决您的确切问题：多态性、不需要注释和最重要的不可变 pojo。在您的示例中，所有内容都可以使用 0 个注释或大量配置。

```
Genson genson = new Genson.Builder().setWithClassMetadata(true)
                            .setWithDebugInfoPropertyNameResolver(true)
                            .create();

String jsonCircle = genson.serialize(circle);
String jsonRectangle = genson.serialize(rectangle);

System.out.println(jsonCircle); // {"@class":"your.package.Circle","radius":123}
System.out.println(jsonRectangle); // {"@class":"your.package.Rectangle","w":20,"h":30}

// Throws nothing :)
Shape newCircle = genson.deserialize(jsonCircle, Shape.class);
Shape newRectangle = genson.deserialize(jsonRectangle, Shape.class); 
```

Genson 还使您能够使用别名（使用类名代替）。

```
new Genson.Builder().addAlias("shape", Shape.class)
                .addAlias("circle", Circle.class)
                .create(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:29:52.040

Rectangle 有两个参数，[FAQ](http://wiki.fasterxml.com/JacksonFAQ#Data_Binding.2C_reading_.28de-serialization.29)说：

> **反序列化简单类型**
> 
> 如果我想将简单的 JSON 值（字符串、整数/十进制数）反序列化为默认支持以外的类型，是否需要编写自定义反序列化器？
> 
> 不必要。如果要反序列化的类具有以下之一：
> 
> *   具有匹配类型（String、int/double）的单参数构造函数，或
> *   名称为“valueOf()”且参数类型匹配的单参数静态方法
> 
> Jackson 将使用这种方法，将匹配的 JSON 值作为参数传入。

恐怕您必须编写自己的[反序列化器，如杰克逊文档中所示](http://wiki.fasterxml.com/JacksonHowToCustomDeserializers)：

```
ObjectMapper mapper = new ObjectMapper();
SimpleModule testModule =
   new SimpleModule("MyModule", new Version(1, 0, 0, null))
      .addDeserializer( MyType.class, new MyTypeDeserializer());
mapper.registerModule( testModule ); 
```

# machine-learning - LIBLINEAR 的训练输出

> ID：15121645
> 
> 赞同：1
> 
> 时间：2013-02-27T20:22:42.577
> 
> 标签：machine-learning, svm, libsvm

我正在尝试 libSVM 包，使用 RBF 和线性分类，我遵循（我认为）他们的 README 文件中的所有建议。

我有一个大文件要训练（70K），所以我尝试使用 liblinear 而不是 RBF。

唯一的问题是在训练阶段后我无法获得模型，我的命令行如下所示：

```
./train -c 4 -v 5 -s 6 TrainingSet.scal TrainingSet.scal.Model 
```

训练完成后，我得到了准确度估计，但是当我查看 *.model 文件以将其用于我的测试集时，我根本找不到它。

您认为这是包中的错误还是我在这里遗漏了什么？

谢谢

辐射

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T23:16:38.823

选项 -v 5 表示您正在对训练集进行 5 倍评估。如果启用此选项，则 liblinear 使用 5 倍评估估计错误并且不输出模型。

如果要输出模型，则不要使用 -v 5。在这种情况下，Tt 不会输出训练错误。但是您可以使用 liblinear-predict 来估计测试集上的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:52:44.600

我通常直接在代码上使用该库，但我认为在您的情况下没有执行培训，因为您使用的是我认为未定义的选项 -s 6。

这是用法：

` -s svm_type : 设置 SVM 的类型（默认 0）

```
0 -- C-SVC      (multi-class classification)
1 -- nu-SVC     (multi-class classification)
2 -- one-class SVM  
3 -- epsilon-SVR    (regression)
4 -- nu-SVR     (regression) 
```

` 您还省略了内核类型

```
-t kernel_type : set type of kernel function (default 2)
0 -- linear: u'*v
1 -- polynomial: (gamma*u'*v + coef0)^degree
2 -- radial basis function: exp(-gamma*|u-v|^2)
3 -- sigmoid: tanh(gamma*u'*v + coef0)
4 -- precomputed kernel (kernel values in training_set_file) 
```

希望这会成功。

# java - 在 Java 中获取 Windows 充电状态

> ID：15121646
> 
> 赞同：2
> 
> 时间：2013-02-27T20:22:45.687
> 
> 标签：java, windows, jna, battery

我想知道天气是否我的 Windows 笔记本电脑正在充电。我希望它进行检查，如果正在充电，则返回 1 或 true，否则返回 0 或 false。我正在按照[如何在 Windows 系统中获得剩余电池寿命中的说明进行操作？](https://stackoverflow.com/questions/3434719/how-to-get-the-remaining-battery-life-in-a-windows-system), 但我无法弄清楚如何解析答案并获取充电状态。有人有建议吗？

编辑：我希望能够输入类似 boolean battery = getBattery(); 并让它返回 true 或 false

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:27:42.723

您可以使用`getBatteryFlagString()`参考[来源](https://stackoverflow.com/a/3434962/1613867)中的方法。或者直接使用`BatteryFlag`and 判断是否等于`8`，详见`getBatteryFlagString`。

就像是：

```
Kernel32.SYSTEM_POWER_STATUS batteryStatus = new Kernel32.SYSTEM_POWER_STATUS();
Kernel32.INSTANCE.GetSystemPowerStatus(batteryStatus);

boolean battery = batteryStatus.BatteryFlag==8; 
```

# algorithm - 如何在 O(n) 时间内找到向量中的最大间隙？

> ID：15121647
> 
> 赞同：5
> 
> 时间：2013-02-27T20:22:47.323
> 
> 标签：algorithm

您将获得高速公路上同一车道上各种汽车的位置，作为向量的双倍，没有特定的顺序。如何在 O(n) 时间内找到相邻汽车之间的最大差距？

似乎一个简单的解决方案是先排序然后检查，但这当然不是线性的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T20:27:35.300

将向量分成 n+1 个大小相等的桶。对于每个这样的桶，存储最大值和最小值，所有其他值都可以丢弃。由于鸽巢原理，这些部分中至少有一个是空的，因此任一部分中的非最小值/非最大值对结果没有影响。

然后，遍历桶，计算到下一个和前一个非空桶的距离，取最大值；这是最终的结果。

一个 n=5 且值为 5,2,20,17,3 的示例。最小值为 2，最大值为 20 => 存储桶大小为 (20-2)/5 = 4。

```
Bucket:   2    6    10    14     18     20
Min/Max:   2-5   -    -     17,17  20,20 
```

差异：2-5、5-17、17-20。最大值为 5-17。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-15T12:54:40.317

我的ipc解决方案的Python实现：

```
def maximum_gap(l):
    n = len(l)
    if n < 2:
        return 0
    (x_min, x_max) = (min(l), max(l))
    if x_min == x_max:
        return 0
    buckets = [None] * (n + 1)
    bucket_size = float(x_max - x_min) / n
    for x in l:
        k = int((x - x_min) / bucket_size)
        if buckets[k] is None:
            buckets[k] = (x, x)
        else:
            buckets[k] = (min(x, buckets[k][0]), max(x, buckets[k][1]))
    result = 0
    for i in range(n):
        if buckets[i + 1] is None:
            buckets[i + 1] = buckets[i]
        else:
            result = max(result, buckets[i + 1][0] - buckets[i][1])
    return result

assert maximum_gap([]) == 0
assert maximum_gap([42]) == 0
assert maximum_gap([1, 1, 1, 1]) == 0
assert maximum_gap([1, 2, 3, 4, 6, 8]) == 2
assert maximum_gap([5, 2, 20, 17, 3]) == 12 
```

如果为空，我使用`tuple`for 存储桶的元素。`None`在最后一部分中，我通过将任何剩余的空桶分配给前一个来抢先消除任何剩余的空桶（这是可行的，因为第一个保证是非空的）。

请注意所有元素都相等的特殊情况。

# java - android setText 与 getString 使用变量名

> ID：15121648
> 
> 赞同：1
> 
> 时间：2013-02-27T20:22:48.197
> 
> 标签：java, android, mobile, gettext, settext

所以，在网上搜索我发现了很多我不需要的例子......

这是我的情况：

想象一下，你有一个资源，它是一个名为songs 的数组，每个歌曲名都有很多。所以，想象一下你有200个歌曲名显示在一个列表视图上。

当您单击一首歌曲时，该应用程序会加载另一个带有该歌曲歌词的活动...但是您是如何做到的？

我是这样做的。我将歌曲的名称传递给这个新活动，加载了歌词所在的资源......

但是，当我必须用歌词设置文本时，我遇到了一个问题......我应该用 200 个案例进行切换吗？这听起来很疯狂，所以，我所做的是，我在歌词中使用了相同的歌曲名称..所以它应该像这样加载：

```
TextView txtProduct = (TextView) findViewById(R.id.product_label);

    Intent i = getIntent();
    // getting attached intent data
    String[] musicas = getResources().getStringArray(R.array.botafogo_songs);
    // this here is where it brings the name of the music to the activity
    String product = i.getStringExtra("product");
    // displaying selected product name
    if (Arrays.asList(musicas).contains(product)) {
            //just formating so they have the same name.
        String productSplit = product.split("- ")[1];
        productSplit.replace(" ", "");
        txtProduct.setText(getString(R.string.AbreAlas)); 
    }else{
        txtProduct.setText("não contem");
    } 
```

好的，AbreAlas 是我的资源的名称..它加载得很好..但是，我不能这样离开它......它应该是一个变量名......比如：`R.string.+productSplit` 或类似的东西..

我无处可寻。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:28:07.980

您可以使用`getIdentifier()`：

```
int resourceName = getResources().getIdentifier(productSplit, "string", getPackageName()); 
```

接着：

```
txtProduct.setText(getString(resourceName)); 
```

不要忘记将其包装在 try and catch 中。

# c# - ASP.NET Web 应用程序的 SQL 性能不佳

> ID：15121650
> 
> 赞同：0
> 
> 时间：2013-02-27T20:22:53.403
> 
> 标签：c#, sql, sql-server, visual-studio-2010

我有一个 ASP.NET Web 应用程序（使用 Microsoft VS 2010 用 C# 编写。）由于它安装在 SQL Server 上，因此我得到了以下性能统计报告：

![在此处输入图像描述](../Images/e67fb889837f2e2ed9e3faf291922624.png)

![在此处输入图像描述](../Images/c455400b075645022bc69269adf1a3d5.png)

![在此处输入图像描述](../Images/f665e857c762a685ed4fba688915e8c6.png)

我不能把所有涉及的源代码都放在这里——发布太多了。所以我想知道，我可以从哪里开始解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T20:24:49.320

[SQL 服务器探查器](http://msdn.microsoft.com/en-us/library/ms181091.aspx)。您可以找出执行时间最长的查询（或存储过程）并从那里开始。

另一个需要查看的地方是查看从应用程序创建了什么样的查询（即它是使用 LINQ to SQL，是使用参数化查询还是存储过程，或者它们是否创建动态查询字符串）。

**更新：**如果您使用的是 SQL Server 的 Express 版本，应注意[SQL Server 2012 Express 的 SP1](http://www.microsoft.com/en-us/download/details.aspx?id=35579)附带包含 Profiler 的 SQL Management Studio Express。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T20:50:52.583

即使我有工具作为快速入门的方式，我通常也会使用下面的查询。这些工具对于分析查询和许多其他任务仍然很有用，但要快速了解服务器过载的原因，它非常有用。

查看要索引的列的有用查询：

```
SELECT TOP 10
[Total Cost] = ROUND(avg_total_user_cost * avg_user_impact * (user_seeks + user_scans),0)
, avg_user_impact
, TableName = statement
, [EqualityUsage] = equality_columns
, [InequalityUsage] = inequality_columns
, [Include Cloumns] = included_columns
FROM sys.dm_db_missing_index_groups g
INNER JOIN sys.dm_db_missing_index_group_stats s
ON s.group_handle = g.index_group_handle
INNER JOIN sys.dm_db_missing_index_details d
ON d.index_handle = g.index_handle
ORDER BY [Total Cost] DESC; 
```

查找昂贵查询的有用查询：

```
SELECT TOP 10 SUBSTRING(qt.TEXT, (qs.statement_start_offset/2)+1,
((CASE qs.statement_end_offset
WHEN -1 THEN DATALENGTH(qt.TEXT)
ELSE qs.statement_end_offset
END - qs.statement_start_offset)/2)+1),
qs.execution_count,
qs.total_logical_reads, qs.last_logical_reads,
qs.total_logical_writes, qs.last_logical_writes,
qs.total_worker_time,
qs.last_worker_time,
qs.total_elapsed_time/1000000 total_elapsed_time_in_S,
qs.last_elapsed_time/1000000 last_elapsed_time_in_S,
qs.last_execution_time,
qp.query_plan
FROM sys.dm_exec_query_stats qs
CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) qt
CROSS APPLY sys.dm_exec_query_plan(qs.plan_handle) qp
ORDER BY qs.total_logical_reads DESC -- logical reads
-- ORDER BY qs.total_logical_writes DESC -- logical writes
-- ORDER BY qs.total_worker_time DESC -- CPU time 
```

请注意，以注释开头的行`--`是注释，因此请注意上述查询的最后三行，您可以通过 CPU 时间、逻辑读取或逻辑写入进行选择。

请注意，您通常询问过性能，但是您的屏幕截图都与锁有关。基于此，我会尝试找到您在应用程序中制作这些锁的位置。也许可以减少锁定/交易的持续时间？

参考：

*   [SQL Server：发现隐藏数据以优化应用程序性能](http://msdn.microsoft.com/en-us/magazine/cc135978.aspx)
*   [SQL SERVER – 使用 DMV 查找最昂贵的查询](http://blog.sqlauthority.com/2010/05/14/sql-server-find-most-expensive-queries-using-dmv/)

# svg - Opera 中的 SVG 文本质量不佳

> ID：15121653
> 
> 赞同：2
> 
> 时间：2013-02-27T20:23:03.453
> 
> 标签：svg, opera

我正在尝试渲染包含一些文本的 SVG 文档。Chrome/FF/Safari 中的一切都很好：

![在此处输入图像描述](../Images/912e15969ab50a8ce95decbc58df329a.png)

但是在 Opera (v12.14, Mac OS X) 字体看起来很丑：

![在此处输入图像描述](../Images/b197def30caf50ac1fd2f72dbf75c2bf.png)

这是正常的还是我做错了什么？是否可以提高渲染质量？这是代码：

```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" 
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="400" height="200" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <text x="10" y="30" font-family="Arial" font-size="12" font-weight="bold">123 xyz XYZ</text>
    <text x="10" y="50" font-family="Arial" font-size="12" font-weight="bold" fill="#666">123 xyz XYZ</text>
    <text x="10" y="70" font-family="Arial" font-size="12" font-weight="normal" fill="#444">123 xyz XYZ</text>
    <text x="10" y="88" font-family="Arial" font-size="10" font-weight="normal" fill="#444">123 xyz XYZ</text>
</svg> 
```

我试过了：

*   使用嵌入字体`@font-face`；
*   使用 Arial 以外的字体；
*   设置`text-rendering="optimizeLegibility"`。

这些都没有帮助。

## 编辑

解决方案是使用`text-rendering="geometricPrecision"`（参见 Erik Dahlström 的回答）：

![在此处输入图像描述](../Images/c78722cc1ab03dc13ff00aba633e97ba.png)

结果仍然比其他浏览器差，但目前看来，它是 Opera for Mac OS 中所能获得的最好结果。

我还尝试将内容双向翻译 0.5 像素。它会稍微改变输出，但总体上不会提高质量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T14:39:08.797

看起来像 Mac 上 SVG 内的文本禁用了亚像素文本渲染。

一种解决方法是指定`text-rendering="geometricPrecision"`. 这使得 Opera 使用字形轮廓进行渲染，而不是将文本渲染推迟到平台。但是，请注意，这通常往往会稍微降低性能。另请注意，`geometricPrecision`在 Opera 中使用并不会启用亚像素文本渲染，但文本通常看起来会有些不同（通常会根据像素网格对齐方式有轻微的模糊）。

# wix - 除非提升，否则 WiX 卸载无法停止应用程序

> ID：15121658
> 
> 赞同：2
> 
> 时间：2013-02-27T20:23:21.087
> 
> 标签：wix, windows-installer

我已经使用 WiX 创建了一个安装程序，如果用户在我的应用程序仍处于打开状态时尝试卸载它，他们应该会看到一个对话框，让他们可以选择让卸载程序自动关闭应用程序或让它继续运行，但会重新启动必需的。

似乎在启用用户帐户控制的情况下，我需要通过在提升的命令提示符下使用 msiexec 运行包来提升，然后才会发生这种情况。如果用户没有被提升，卸载程序将运行，他们单击“删除”图标（提示提升），但安装程序会简单地说：

```
"The setup must update files or services that cannot be updated while the system is running. If you choose to continue, a reboot will be required to complete the setup." 
```

我希望他们可以选择关闭应用程序，即使只是卸载而无需先手动提升

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T15:13:25.013

我最好的猜测是您的 MSI 没有[FilesInUse](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368592%28v=vs.85%29.aspx)对话框，也没有[MsiRMFilesInUse](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370379%28v=vs.85%29.aspx)对话框。这些是 Windows 安装程序在检测到正在使用的文件时将填充信息的“众所周知的”对话框。[如果您使用其中一种标准 UI](http://wix.sourceforge.net/manual-wix2/WixUI_dialog_library.htm)，WiX 工具集应该会自动为您提供这些对话框。或者，您可以创建自己的对话框。

# mysql - MySQL忽略非主键上的重复项

> ID：15121659
> 
> 赞同：0
> 
> 时间：2013-02-27T20:23:21.737
> 
> 标签：mysql, stored-procedures, insert, duplicates

我有一个由这个 SQL 语句创建的表：

```
CREATE TABLE employees (
    id  INTEGER  NOT NULL AUTO_INCREMENT,
    name   VARCHAR(20),
    PRIMARY KEY (id)
); 
```

我想使用类似的东西插入表格

```
INSERT IGNORE INTO employees (name) values ('foo'); 
```

但是如果表中已经有一个名为**“foo”**的人，那么该语句什么也不做。是否有一条语句忽略除主键或定义为唯一的字段以外的字段上的重复项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:28:39.960

```
INSERT INTO employees (name)
SELECT "foo" name FROM (select count(*) c
                        from employees
                        where name = "foo"
                        having c = 0) x; 
```

你应该有一个`name`效率指数。我不确定您为什么不想将其设为唯一索引。

[小提琴](http://www.sqlfiddle.com/#!2/7849b/1)

# c# - 为什么我不能使用以下 IEnumerable ?

> ID：15121665
> 
> 赞同：5
> 
> 时间：2013-02-27T20:23:57.967
> 
> 标签：c#, .net, idisposable

我收到以下错误：

```
Error   25  The type or namespace name 'IEnumerable' could not be found (are you missing a using directive or an assembly reference?)   C:\Development\Leverage\Leverage\Reports\SurveyLevel.aspx.cs    39  17  Leverage 
```

因为这条线：

```
 private IEnumerable<string> GetDateParameters() 
```

我该如何处理？我试图在该行中添加：

> ```
> using System.IDisposable 
> ```

在顶部，但这并不能解决它。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-27T20:34:48.950

正如其他人所说，你失踪了`using System.Collections.Generic;`。

但这给了你一条鱼；我们应该教你自己钓鱼。

自己解决这个问题的方法是：

在您最喜欢的搜索引擎中输入类型的名称，然后查看返回的内容：

> IEnumerable(T) 接口**(System.Collections.Generic)**
> 
> [http://msdn.microsoft.com/en-us/library/9eekhta0](http://msdn.microsoft.com/en-us/library/9eekhta0)
> 
> 公开枚举器，它支持对指定类型的集合进行简单迭代。

看到我在那里用粗体突出显示的部分了吗？那就是您缺少的名称空间。

如果您仍然收到错误，那么您可能缺少参考；您可以通过单击链接并阅读文档页面来找出您未能引用的 DLL；它会告诉你要引用哪个 DLL。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-27T20:24:51.770

您缺少`using System.Collections.Generic;`代码文件顶部的语句。

`IEnumerable<T>`无法直接找到泛型类型。

您*可以*改为声明全名：

```
private System.Collections.Generic.IEnumerable<string> GetDateParameters() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T20:25:15.920

`IEnumerable`在`System.Collections`

`IEnumerable<T>`在`System.Collections.Generic`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T20:25:35.250

您只需要在[`System.Collections.Generic`](http://msdn.microsoft.com/en-us/library/system.collections.generic%28v=vs.80%29.aspx)代码的顶部添加名称空间。

[`IEnumerable<T>`](http://msdn.microsoft.com/en-US/library/9eekhta0%28v=vs.80%29.aspx)属于*mscorlib.dll*程序集中的这个命名空间。

你可以像这样使用它；

```
private System.Collections.Generic.IEnumerable<string> GetDateParameters() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-23T15:02:41.180

上面的答案很好。就我而言，即使遵循上述答案，它也没有解决问题。仍然不断出现红色波浪。

问题是项目的框架。它默认设置为 .NET Framework 4.0.3，更改为 .NET Framework 4.0.0 也会有所帮助。

![在此处输入图像描述](../Images/bda026de4ed99a84ba9a2b6c387d00e9.png)

更改后保存您的项目属性，构建它应该可以正常工作。

希望这可以帮助。

# c# - 多个控制器之间的共享方法 C# MVC4

> ID：15121666
> 
> 赞同：20
> 
> 时间：2013-02-27T20:24:00.757
> 
> 标签：c#, asp.net-mvc-4

我有在六个控制器中调用的相同方法。现在我在每个控制器之间复制和粘贴。所有控制器都在同一个命名空间中。该方法根据传递的 id 返回一个布尔值。例如：

```
public bool CheckSubmission(int id =0)
{
    Get Records from DB with criteria
    If Record available return true
    else return false
} 
```

我已经离开 C++ C# 一段时间了，一次找不到如何编写这些。我知道在 Rails 中我可以将共享函数放在 ApplicationController 中。我在 SO 上看到了几个关于此的问题，但不是一个明确的例子，它们更像是在 OOP 上阅读的内容。当我回到这个问题时，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-02-27T20:27:46.497

创建一个`ControllerBase`继承自 的类，`Controller`将此方法放入其中。

让您的控制器从您的基本控制器继承 - 他们将使用此实现。

```
public class ControllerBase : Controller
{
  public bool CheckSubmission(int id = 0)
  {
    Get Records from DB with criteria
    If Record available return true
    else return false
  }
}

public class SomethingController : ControllerBase
{
    // Can use CheckSubmission in here
} 
```

# symfony - Doctrine Paginator Iteration 是一个包含 1 个对象的数组

> ID：15121670
> 
> 赞同：1
> 
> 时间：2013-02-27T20:24:11.467
> 
> 标签：symfony, doctrine-orm, doctrine, pagination, dql

我正在尝试使用学说 Paginate 类来获取一些任务。

```
$qb = $this->getEntityManager()
            ->createQueryBuilder()
            ->select('DISTINCT task, priority, company, invoice')
            ->addSelect('priority.id as priority_id')
            ->from('TekniqSD4Bundle:task', 'task')
            ->leftJoin('task.slips', 'slips')
            ->leftJoin('task.comments', 'comments')
            ->leftJoin('task.files', 'files')
            ->leftJoin('task.steps', 'steps')
            ->leftJoin('task.status', 'status')
            ->join('task.invoice', 'invoice')
            ->join('task.priority', 'priority')
            ->join('invoice.company', 'company');

$query = $qb->getQuery()
            ->setMaxResults(2)  
            ->setFirstResult($offset);
$paginator = new Paginator($query, true);
foreach($paginator as $task){
    var_dump($task); //this spits out an array containing 1 task
} 
```

我的问题是，为什么 $task 是一个数组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:39:59.497

DQL 中的选定`priority.id`项导致了此问题，因为 ORM 必须将其作为标量结果检索。访问`$task[0]`应该为您提供[fetch-joined](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/dql-doctrine-query-language.html#joins) `task`对象，同时`$task['priority_id']`为您提供表示`priority.id`.

# python - 每次将某些内容写入文件时，Python 都会将计数器增加 1

> ID：15121671
> 
> 赞同：2
> 
> 时间：2013-02-27T20:24:26.147
> 
> 标签：python, scripting

我想要做的是每次写入文件“TCPStreamPayload”时，我想要一个计数器，每次将信息附加到文件时都会增加。

例如我有：

```
payloadRecon = open('TCPStreamPayload.txt','a')

segmentCount = 0

--my script here-- 
```

然后在底部

```
if payloadRecon.write:
    segmentCount +=1
payloadRecon.write('####TCP PAYLOAD STREAM RECONSTRUCTION. Segment ' + str(segmentCount) + '######' '\n\n\n\n'). 
```

基本上，每次我使用我的脚本写入这个文件时，我都希望段号增加 1。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T20:27:06.013

您确实应该编写一个包装类并使用它而不是普通的`file`：

```
class CountingWrapper(object):
    def __init__(self, *args, **kwargs):
        self.segment_count = 0
        self.f = open(*args, **kwargs)
    def write(self, *args, **kwargs):
        self.segment_count += 1
        return self.f.write(*args, **kwargs)

payloadRecon = CountingWrapper('TCPStreamPayload.txt', 'a')
payloadRecon.write('dsfsd')
assert payloadRecon.count == 1 
```

或者，如果你只是想包装三行代码，这样你就不必重复自己，你可以写一个包装函数：

```
segmentCount = 0
def payload_write(f, *args, **kwargs):
    global segmentCount
    segmentCount += 1
    return f.write(*args, **kwargs) 
```

现在，您只需要这一行来计数和编写：

```
payload_write(payloadRecon, '####TCP PAYLOAD STREAM RECONSTRUCTION. Segment ' + str(segmentCount) + '######' '\n\n\n\n')
assert segmentCount == 1 
```

如果您需要包装多个方法，则该类更加灵活。但是您显然需要委托您关心的任何其他方法。当然，您可以通过`__getattr__`. 或者你可以使用继承。（但请记住，在 3.x 中，该类不是`file`，而是包中的类之一，无论如何`io`您都不应该创建任何一个`file`或由构造函数创建，而是由，所以您仍然需要编写一个要替换的包装器工厂函数。好消息是，这意味着您不需要处理，只需.)`io.whatever``open``open``__new__``__init__`

在 3.x 中，您甚至可以对实例进行猴子补丁（但这在 2.x 中不起作用，它`file.write`是只读的）：

```
payloadRecon = open('TCPStreamPayload.txt', 'a')
segmentCount = 0
write_original = payloadRecon.write
def write_and_count(self, *args, **kwargs):
    global segmentCount
    segmentCount += 1
    write_original(self, *args, **kwargs)
payloadRecon.write = write_and_count 
```

但实际上，保持明确可能是这里的方法。

# r - 按 (x,y) 对数据进行分类并汇总

> ID：15121673
> 
> 赞同：7
> 
> 时间：2013-02-27T20:24:28.517
> 
> 标签：r, dataframe, plyr, binning, summarization

这些是我拥有的一个大文件的前 10 行：（请注意，这 10 行中只有一个用户，但我有数千个用户）

```
dput(testd)
structure(list(user = c(0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L
), otime = structure(c(10L, 9L, 8L, 7L, 6L, 5L, 4L, 3L, 2L, 1L
), .Label = c("2010-10-12T19:56:49Z", "2010-10-13T03:57:23Z", 
"2010-10-13T16:41:35Z", "2010-10-13T20:05:43Z", "2010-10-13T23:31:51Z", 
"2010-10-14T00:21:47Z", "2010-10-14T18:25:51Z", "2010-10-16T03:48:54Z", 
"2010-10-16T06:02:04Z", "2010-10-17T01:48:53Z"), class = "factor"), 
    lat = c(39.747652, 39.891383, 39.891077, 39.750469, 39.752713, 
      39.752508, 39.7513, 39.758974, 39.827022, 39.749934),
    long = c(-104.99251, -105.070814, -105.068532, -104.999073, 
      -104.996337, -104.996637, -105.000121, -105.010853,
      -105.143191, -105.000017),
    locid = structure(c(5L, 4L, 9L, 6L, 1L, 2L, 8L, 3L, 10L, 7L),
      .Label = c("2ef143e12038c870038df53e0478cefc", 
      "424eb3dd143292f9e013efa00486c907", "6f5b96170b7744af3c7577fa35ed0b8f", 
      "7a0f88982aa015062b95e3b4843f9ca2", "88c46bf20db295831bd2d1718ad7e6f5", 
      "9848afcc62e500a01cf6fbf24b797732f8963683", "b3d356765cc8a4aa7ac5cd18caafd393", 
      "d268093afe06bd7d37d91c4d436e0c40d217b20a", "dd7cd3d264c2d063832db506fba8bf79", 
      "f6f52a75fd80e27e3770cd3a87054f27"), class = "factor"),
    dnt = structure(c(10L, 9L, 8L, 7L, 6L, 5L, 4L, 3L, 2L, 1L),
      .Label = c("2010-10-12 19:56:49", 
      "2010-10-13 03:57:23", "2010-10-13 16:41:35", "2010-10-13 20:05:43", 
      "2010-10-13 23:31:51", "2010-10-14 00:21:47", "2010-10-14 18:25:51", 
      "2010-10-16 03:48:54", "2010-10-16 06:02:04", "2010-10-17 01:48:53"
    ), class = "factor"),
    x = c(-11674.6344476781, -11683.3414552141, 
      -11683.0877083915, -11675.3642199817, -11675.0599906624, 
      -11675.0933491404, -11675.4807522648, -11676.6740962175, 
      -11691.3894104198, -11675.4691879924),
    y = c(4419.73724843345, 4435.719406435, 4435.68538078744,
      4420.05048454181, 4420.3000059572, 4420.27721099723,
      4420.14288752585, 4420.99619739292, 4428.56278976123, 
      4419.99099525605),
    cellx = structure(c(1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L),
      .Label = c("[-11682,-11672)", "[-11692,-11682)"
    ), class = "factor"),
    celly = structure(c(1L, 2L, 2L, 1L, 
      1L, 1L, 1L, 1L, 1L, 1L), .Label = c("[4419,4429)", "[4429,4439)"
    ), class = "factor"),
    cellxy = structure(c(1L, 3L, 3L, 1L, 
      1L, 1L, 1L, 1L, 2L, 1L), .Label = c("[-11682,-11672)[4419,4429)", 
      "[-11692,-11682)[4419,4429)", "[-11692,-11682)[4429,4439)"
    ), class = "factor")), .Names = c("user", "otime", "lat", 
"long", "locid", "dnt", "x", "y", "cellx", "celly", "cellxy"), class = "data.frame", row.names = c(NA, 
-10L)) 
```

关于数据是什么的一些解释，以简化理解。x 和 y 是 lat 和 long 坐标的变换。我已使用`cut`. 我想获得每个用户访问次数最多的 bin，所以我使用`ddply`. 如下：

```
cells = ddply(testd, .(user, cellxy), summarise, length(cellxy)) 
```

获得：

```
dput(cells)
structure(list(user = c(0, 0, 0), cellxy = structure(1:3, .Label = c("[-11682,-11672)[4419,4429)", 
"[-11692,-11682)[4419,4429)", "[-11692,-11682)[4429,4439)"), class = "factor"), 
    count = c(7L, 1L, 2L)), .Names = c("user", "cellxy", "count"
), row.names = c(NA, -3L), class = "data.frame") 
```

现在我想做的是从第一个数据集中计算每个用户访问量最大的 bin 的平均 x,y 值，这些值是从先前的计算中获得的。我不知道如何有效地做到这一点，鉴于我的数据集非常大，我希望能得到一些指导。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T20:40:36.387

这是两阶段的方法。首先，修改你的原始代码`cells`- 为每个组合计算平均值`cellxy`和值。`user``x``y`

```
 cells = ddply(testd, .(user, cellxy), summarise,
       cellcount=length(cellxy),meanx=mean(x),meany=mean(y))
 cells
  user                     cellxy cellcount     meanx    meany
1    0 [-11682,-11672)[4419,4429)         7 -11675.40 4420.214
2    0 [-11692,-11682)[4419,4429)         1 -11691.39 4428.563
3    0 [-11692,-11682)[4429,4439)         2 -11683.21 4435.702 
```

然后使用其他调用来`ddply()`为每个用户`cellxy`设置最高的子集`cellcount`。

```
cells2 = ddply(cells,.(user),subset,cellcount==max(cellcount))
cells2
  user                     cellxy cellcount    meanx    meany
1    0 [-11682,-11672)[4419,4429)         7 -11675.4 4420.214 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T22:19:55.667

由于您的数据集很大，您可能需要考虑使用 data.table，它不仅速度极快，而且还会使数据整理变得更容易。

### 转换为数据表很简单：

```
 library (data.table)
    DT <- data.table(testd, by="user") 
```

### 然后确定用户访问量最大的只是一行

```
 # Determining which is the most visited, by user 
    DT[, "MostVisited" := {counts <- table(cellxy); names(counts)[which(counts==max(counts))]}, by=user] 
```

* * *

我不确定您想计算相对于 的平均 x, y 的具体程度`MostVisited`，但我相信这也可以相对简单地使用`data.table`.

```
 ## But perhaps something like this
    DT[, c("AvgX", "AvgY") := list(mean(x), mean(y)), by=list(user, MostVisited)] 
```

# c# - 带有 Request.form 迭代的 Jquery 动态文本框

> ID：15121674
> 
> 赞同：0
> 
> 时间：2013-02-27T20:24:36.763
> 
> 标签：c#, jquery, asp.net

我在我的应用程序中使用 Jquery 添加多个文本框，然后在我想要的文件后面的代码中，我可以通过 Request.form [name] 访问这些值。我想迭代这些文本框并读取用户输入的任何文本的值，因此我可以将其存储在数据库中。知道如何将这些文本框的值保存在数据库中，我正在使用 asp.net 2.0

```
$(document).ready(function () {

  var counter = 2;

  $("#addButton").click(function () {

   if (counter > 10) {
     alert("Only 10 textboxes allow");
     return false;
   }

   var newTextBoxDiv = $(document.createElement('div')).attr("id", 'TextBoxDiv' + counter);

   newTextBoxDiv.html('<table><tr><td><input type="text" name="textbox' + counter +
                          '" id="textbox' + counter + '" value="" ></td><td><input type="text" name="textbox' + counter +
                          '" id="textbox' + counter + '" value="" ></td><td><input type="text" name="textbox' + counter +
                          '" id="textbox' + counter + '" value="" ></td></tr></table>');

   newTextBoxDiv.appendTo("#TextBoxesGroup");
   return false;

   counter++;
  });
 }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:52:24.927

```
 foreach (string key in Request.Form.AllKeys) 
        {
            if (key.StartsWith("textbox")) 
            {
                string value = Request.Form[key];
                //Do some stuff...
            }
        } 
```

# mysql - 连接到 mysql 时 JBoss 服务器异常

> ID：15121680
> 
> 赞同：0
> 
> 时间：2013-02-27T20:24:54.573
> 
> 标签：mysql, eclipse, jpa, jboss, ejb

我最近用 jboss 和 eclipse 尝试了 JPA 程序。为了连接到 MySQL，我在 JBoss 安装目录路径中放入了所需的 mySQL-connector JAR，并在 jboss 的standalone.xml 中添加了配置，如果我从 eclipse 启动 jboss，它启动正常并显示我也配置了连接。但是，如果我添加我的 ejb 程序并启动服务器，它会给我以下错误，当我搜索解决这个问题时，每个论坛都给了我不同的解决方案，但似乎没有解决我的问题。

错误

> > 17:34:17,195 错误 [org.jboss.msc.service.fail]（MSC 服务线程 1-5）MSC00001：无法启动服务 jboss.deployment.unit。“FirstEJBProject.jar”。安装：org.jboss.msc服务 jboss.deployment.unit."FirstEJBProject.jar".INSTALL 中的 .service.StartException：无法在 org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java 处处理部署“FirstEJBProject.jar”的阶段安装:119) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final] at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc- 1.0.2.GA.jar:1.0.2.GA] 在 org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0\. 2.GA] 在 java.util.concurrent。ThreadPoolExecutor.runWorker(Unknown Source) [rt.jar:1.7.0_13] at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) [rt.jar:1.7.0_13] at java.lang.Thread.run(未知来源）[rt.jar:1.7.0_13] 原因：java.lang.IllegalArgumentException：org.jboss.msc.service.ServiceName.of(ServiceName.java:85) [jboss] 处的 java 不允许空名称段-msc-1.0.2.GA.jar:1.0.2.GA] 在 org.jboss.msc.service.ServiceName.append(ServiceName.java:112) [jboss-msc-1.0.2.GA.jar:1.0 .2.GA] 在 org.jboss.as.naming.deployment.ContextNames.buildServiceName(ContextNames.java:178) 在 org.jboss.as.naming.deployment.ContextNames$BindInfo.(ContextNames.java:190) 在 org .jboss.as.naming.deployment.ContextNames$BindInfo.(ContextNames.java:181) 在 org.jboss.as.naming。deployment.ContextNames.bindInfoFor(ContextNames.java:124) at org.jboss.as.naming.deployment.ContextNames.bindInfoForEnvEntry(ContextNames.java:165) at org.jboss.as.jpa.processor.PersistenceUnitDeploymentProcessor.deployPersistenceUnit(PersistenceUnitDeploymentProcessor. java:319) 在 org.jboss.as.jpa.processor.PersistenceUnitDeploymentProcessor.handleJarDeployment(PersistenceUnitDeploymentProcessor.java:145) 在 org.jboss.addPuService(PersistenceUnitDeploymentProcessor.java:258) .as.jpa.processor.PersistenceUnitDeploymentProcessor.deploy(PersistenceUnitDeploymentProcessor.java:120) 在 org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.1.Final .jar:7.1.1。决赛] ... 5更多
> 
> 17:34:17,430 INFO [org.jboss.as.server]（DeploymentScanner-threads - 2）JBAS015870：部署“FirstEJBProject.jar”的部署已回滚，并显示失败消息 {“JBAS014671：失败的服务”=> {“jboss .deployment.unit.\"FirstEJBProject.jar\".INSTALL" => "org.jboss.msc.service.StartException in service jboss.deployment.unit.\"FirstEJBProject.jar\".INSTALL: 无法处理阶段安装部署 \"FirstEJBProject.jar\""},"JBAS014771: 缺少/不可用依赖项的服务" => ["jboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic.Validatorjboss.naming.context.java. comp.FirstEJBProject.FirstEJBProject.StudentLogicMissing[jboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic。Validatorjboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic]","jboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic.ValidatorFactoryjboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogicMissing [jboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic.ValidatorFactoryjboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic]"]} 17:34:17,430 信息 [org.jboss.as.server .deployment]（MSC 服务线程 1-2）JBAS015877：在 13 毫秒内停止部署 FirstEJBProject.jar 17:34:17,445 INFO [org.jboss.as.controller]（DeploymentScanner-threads - 2）JBAS014774：服务状态报告 JBAS014775：新缺少/不满足的依赖项：服务 jboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject。StudentLogic（缺少）依赖项：[服务 jboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic.ValidatorFactory，服务 jboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic.Validator] JBAS014777：服务失败启动：service jboss.deployment.unit."FirstEJBProject.jar".INSTALL: org.jboss.msc.service.StartException in service jboss.deployment.unit."FirstEJBProject.jar".INSTALL: 无法处理部署的阶段安装“FirstEJBProject.jar”deployment.unit."FirstEJBProject.jar".INSTALL: org.jboss.msc.service.StartException in service jboss.deployment.unit."FirstEJBProject.jar".INSTALL: 无法处理部署“FirstEJBProject.jar”的阶段安装deployment.unit."FirstEJBProject.jar".INSTALL: org.jboss.msc.service.StartException in service jboss.deployment.unit."FirstEJBProject.jar".INSTALL: 无法处理部署“FirstEJBProject.jar”的阶段安装
> 
> 17:34:17,461 错误 [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) {"JBAS014653: 复合操作失败并已回滚。失败的步骤：" => {"操作步骤- 2" => {"JBAS014671: 失败的服务" => {"jboss.deployment.unit.\"FirstEJBProject.jar\".INSTALL" => "org.jboss.msc.service.StartException in service jboss.deployment.unit .\"FirstEJBProject.jar\".INSTALL: 无法处理部署的阶段安装\"FirstEJBProject.jar\""},"JBAS014771: 缺少/不可用依赖项的服务" => ["jboss.naming.context.java. comp.FirstEJBProject.FirstEJBProject.StudentLogic.Validatorjboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogicMissing[jboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic.Validatorjboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic]","jboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic.ValidatorFactoryjboss.naming.context.java .comp.FirstEJBProject.FirstEJBProject.StudentLogicMissing[jboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic.ValidatorFactoryjboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic]"]}}}FirstEJBProject.FirstEJBProject.StudentLogic.ValidatorFactoryjboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic]"]}}}FirstEJBProject.FirstEJBProject.StudentLogic.ValidatorFactoryjboss.naming.context.java.comp.FirstEJBProject.FirstEJBProject.StudentLogic]"]}}}

持久性.xml

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
version="1.0">
<!-- MySQL DataSource -->
<persistence-unit name="STUD">
    <jta-data-source>java:/</jta-data-source>
    <properties>
        <property name="showSql" value="true" />
        <property name="hibernate.dialect" value="org.hibernate.dialect.MySQLDialect" />
    </properties>
</persistence-unit> 
```

独立的.xml

```
<datasource jndi-name="java:/mydb" pool-name="my_pool" enabled="true" jta="true" use-java-context="true" use-ccm="true">
                <connection-url>jdbc:mysql://localhost:3306/myschema</connection-url>
                <driver>mysql</driver>
                <security>
                    <user-name>root</user-name>
                    <password>password</password>
                </security>
                <statement>
                    <prepared-statement-cache-size>
                        100
                    </prepared-statement-cache-size>
                    <share-prepared-statements/>
                </statement>
            </datasource>
            <drivers>
                <driver name="h2" module="com.h2database.h2">
                    <xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>
                </driver>
                 <driver name="mysql" module="com.mysql"/>
            </drivers>
        </datasources> 
```

我在这里错过了什么吗？

我曾尝试使用 mySQL-ds.xml，如果我使用它，它会给出不同的错误，因为数据源无法解析。如果我也知道解决方案会很有帮助，因为我会打包我的程序并进行部署，我不需要再次在 JBoss 中进行 SQL 连接。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T14:42:23.170

问题是`<jta-data-source>java:/</jta-data-source>`我需要填写与我提供的相同的名称，`<datasource jndi-name="java:/mydb"`所以最后自己修复了它，谢谢大家的帮助。

固定的持久性 XML 代码

```
 <persistence xmlns="http://java.sun.com/xml/ns/persistence"
version="1.0">
<!-- MySQL DataSource -->
<persistence-unit name="STUD">
    <jta-data-source>java:/mydb</jta-data-source>
    <properties>
        <property name="showSql" value="true" />
        <property name="hibernate.dialect" value="org.hibernate.dialect.MySQLDialect" />
    </properties>
</persistence-unit> 
```

希望这会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T05:01:45.003

您将需要定义`<driver>mysql</driver`. 这通常通过定义一个模块来完成。您可以在[这里找到所有相关信息](http://bnlconsulting.com/index.php/blog/item/88-jboss-71-adding-mysql-datasource) [http://bnlconsulting.com/index.php/blog/item/88-jboss-71-adding-mysql-datasource](http://bnlconsulting.com/index.php/blog/item/88-jboss-71-adding-mysql-datasource)

# javascript - d3 似乎假设我知道 csv 的列名？

> ID：15121690
> 
> 赞同：7
> 
> 时间：2013-02-27T20:25:18.303
> 
> 标签：javascript, csv, d3.js, graphing

我有生成的 csv 文件，我正在尝试将它们加载到 d3 中以绘制它们。列名是基于数据的，所以我基本上无法提前知道它们。通过测试，如果我知道列的名称，我可以加载这些数据并很好地绘制它......但我不知道我的用例。

我如何在 d3 中处理这个问题？我似乎无法在网上或文档中找到任何可以帮助/参考的内容。当我从 d3.csv 登录到控制台数据 [0] 时，我可以看到有两列以及为它们读取的值，但我不知道如何在不知道的情况下任意引用数据的第 1 列或第 2 列列名提前。一般来说，我想避免这种情况，知道我的时间戳在第 1 列，我的数据在第 2 列，如果这有意义的话。

编辑，我的答案使用 d3.entries 来帮助了解未知列的名称，然后继续访问具有该索引的所有对象：

```
d3.csv("export.csv", function(error, data) {
    var mappedArray = d3.entries(data[0]);
    var valueKey = mappedArray[1].key;
    data.forEach(function(d) {
        ...
        d.value = d[valueKey];
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:34:47.410

您可以使用该[`d3.entries()`函数](https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_entries)将关联数组转换为另一个数组，该数组包含一个关联数组，每个键值对都带有`key`和键。`value`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-29T20:45:38.273

您可以使用 D3 v3[`values()`方法](https://github.com/d3/d3-3.x-api-reference/blob/master/Arrays.md#associative-arrays)获取键（列名），如下所示：

```
const [dataValues] = d3.values(data)
const keys = Object.keys(dataValues)
console.log(keys); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-11T07:06:29.677

我很高兴你明白了，@cdietschrun。

D3 的第 4 版允许您更简单地执行此操作。它引入了一个*列*属性，它创建了一个列标题数组（即数据集的“键”）。

因此，不要使用您的代码：

```
var mappedArray = d3.entries(data[0]),
    valueKey = mappedArray[1].key; 
```

... 您可以使用：

```
var valueKey = data.columns; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-11-05T23:58:18.617

我使用 d3.entries() 如下：

```
for(i=0;i<data.length;i++)
{
    var temp = d3.entries(data[i]);
    for(j=0;j<temp.length;j++)
    if(temp[j].key == selectedx)
    myarray.push(temp[j].value);
} 
```

希望这可以帮助 ：）

# sql - 需要帮助将 SQL Server 查询转换为 SQL Server Compact Edition

> ID：15121695
> 
> 赞同：0
> 
> 时间：2013-02-27T20:25:42.957
> 
> 标签：sql, sql-server, sql-server-ce

我对我的 SQL Server 运行了这个查询：

```
SELECT SongUID, ArtistAlias, TitleAlias, Quality 
FROM 
    (SELECT 
        ROW_NUMBER() OVER(PARTITION BY ArtistAlias, TitleAlias 
                          ORDER BY Quality Desc) AS rn, * 
     FROM KaraokeLibrary) dt
WHERE rn = 1 
```

但我无法让它在 SQL Server CE 4 下运行（`ROW_NUMBER()`不支持`OVER...PARTITION`也不支持）。

我已经能够通过以下查询在 SQL Server CE 中“关闭”：

```
SELECT SongUID, ArtistAlias, TitleAlias, Quality 
FROM KaraokeLibrary A
WHERE Quality >= 0 AND Quality IN (SELECT MAX(Quality) 
                                 FROM KaraokeLibrary B 
                                 WHERE B.ArtistAlias = A.ArtistAlias 
                                   AND B.TitleAlias = A.TitleAlias)
ORDER BY ArtistAlias, TitleAlias 
```

但这仍然列出了重复的艺术家/标题 - 不能有这个。

任何 SQL Server CE 专家都对我有一些查询魔法吗？

更新：为了进一步解释——我所追求的最终结果是给出如下所示的数据：

```
SongUID  ArtistAlias  TitleAlias  Quality
    10,    'Artist1',    'Title1',    3
    11,    'Artist1',    'Title1',    2
    12,    'Artist1',    'Title1',    1
    13,    'Artist2',    'Title1',    3
    14,    'Artist2',    'Title1',    2
    15,    'Artist2',    'Title1',    1
    16,    'Artist2',    'Title2',    2
    18,    'Artist2',    'Title2',    1
    19,    'Artist2',    'Title2',    3
    20,    'Artist2',    'Title2',    3
    21,    'Artist2',    'Title2',    1 
```

我想让这个返回：

```
10, 'Artist1', 'Title1', 3
13, 'Artist2', 'Title1', 3
20, 'Artist2', 'Title2', 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:32:27.027

你也可以这样写查询：

```
SELECT  SongUID, ArtistAlias, TitleAlias, Quality
From KaraokeLibrary kl
where quality > 0 and
      songuid = (select top ( 1 ) songuid
                 from Karokelibrary kl2
                 WHERE kl.ArtistAlias=kl2.ArtistAlias AND kl.TitleAlias=kl2.TitleAlias
                 order by quality desc
                ) 
```

（注意：您不需要“顶部（1）”中的空格。这是我上传解决方案的唯一方法。）

旧版本的 SQL CE 可能不支持`top`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:55:48.897

您是否尝试过仅使用子查询：

```
select k1.SongUID,
  k1.ArtistAlias, 
  k1.TitleAlias,
  k1.quality
from KaraokeLibrary k1
inner join 
(
  select max(quality) maxQuality,
    ArtistAlias, TitleAlias
  from KaraokeLibrary
  where  Quality >= 0
  group by ArtistAlias, TitleAlias
) k2
  on k1.ArtistAlias = k2.ArtistAlias
  and k1.TitleAlias = k2.TitleAlias
  and k1.quality = k2.maxQuality
where  k1.Quality >= 0 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/452082/4)

如果您有多个版本的`songuid`，那么您可以使用聚合：

```
select max(k1.SongUID),
  k1.ArtistAlias, 
  k1.TitleAlias,
  k1.quality
from KaraokeLibrary k1
inner join 
(
  select max(quality) maxQuality,
    ArtistAlias, TitleAlias
  from KaraokeLibrary
  where  Quality >= 0
  group by ArtistAlias, TitleAlias
) k2
  on k1.ArtistAlias = k2.ArtistAlias
  and k1.TitleAlias = k2.TitleAlias
  and k1.quality = k2.maxQuality
where  k1.Quality >= 0
group by k1.ArtistAlias, 
  k1.TitleAlias,
  k1.quality 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/2d465/2)

# sencha-touch-2 - 构建 Sencha Touch 2.1 项目

> ID：15121696
> 
> 赞同：0
> 
> 时间：2013-02-27T20:25:49.523
> 
> 标签：sencha-touch-2, sencha-cmd

我已经为自己构建了一个小型 Sencha Touch 2 应用程序，所以现在我正在尝试将其缩小/缩小

我的应用看起来像

```
/touch
/app.js
/resources
/ux
/app
/app.json
/index.html
/build.xml 
```

所以我试图让它更高效、更快地加载，所以我加载了 Sencha Cmd 并运行

```
sencha compile --classpath=app,touch/src,ux include -all 
```

所以它看起来像编译它，没有给出任何错误，它给出了一些警告，但这些都可以。所以它结束了，什么都没有改变。目录与以前完全相同。

我将如何正确使用它来使我的应用程序更小并更快地加载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T21:26:21.690

命令

```
sencha app build package 
```

或者

```
sencha app build production 
```

将缩小/打包您的应用程序。所有的 javascript 都将包含在一个 app.js 文件中，并且 javascript+css 将被缩小。可以在此处找到有关这些命令的更多信息：[http ://docs.sencha.com/touch/2-1/#!/guide/command_app](http://docs.sencha.com/touch/2-1/#!/guide/command_app)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-01T20:21:35.123

有关详细信息，另请参阅 cmd 工具文档： [http ://docs.sencha.com/cmd/3.1.2/#!/guide/command_app_touch-section-deploying-your-application](http://docs.sencha.com/cmd/3.1.2/#!/guide/command_app_touch-section-deploying-your-application)

> 部署您的应用程序仅仅意味着编辑源代码并刷新浏览器。所有源文件都是按需动态加载的。不涉及构建过程。在部署方面，Sencha Cmd 提供以下四种构建环境选项：
> 
> 测试 - 用于生产前的 QA。所有 JavaScript 和 CSS 源文件都捆绑在一起，但没有缩小，这使得调试更容易。
> 
> 包 - 创建一个独立的、可再分发的生产构建，该构建通常从本地文件系统运行，无需 Web 服务器。
> 
> 生产 - 创建通常托管在 Web 服务器上并为多个客户端（设备）提供服务的生产构建。该构建使用 HTML 5 应用程序缓存支持离线，并且能够执行无线更新。
> 
> native - 首先生成一个包构建，然后将其打包为一个原生应用程序，准备部署到原生平台。

# java - -classpath 选项中的 Javac 与 Java

> ID：15121697
> 
> 赞同：12
> 
> 时间：2013-02-27T20:25:52.950
> 
> 标签：java, classpath, javac

从和从调用`-classpath`选项有什么区别`javac``java`

例如：

```
javac -classpath MyJar.jar GetJar.java
java -classpath MyJar.jar:. GetJar 
```

它的工作原理以及：

```
javac -classpath MyJar.jar GetJar.java
java GetJar 
```

所以基本上与第一个-classpath相关的地方`javac`需要在那里，另一方面在java命令行中它可能是可选的。为什么？你知道在什么情况下它是强制性的。更一般地说，被`-classpath`调用的效果是什么，被调用的`javac`效果是什么。`-classpath``java`

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T20:28:46.240

一种是用于编译的类路径。另一个是用于运行的类路径。他们不必***是***同一件事。编译过程所需的类集是每个正在编译的类所引用的所有类。而您的运行时 JAR 可能正在调用具有空 main 方法且没有依赖项的独立类。

请记住，在运行时类依赖关系是动态解析的，也就是只在需要时加载一个类（这是一个概括，*总是*加载引导和系统类）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T21:00:15.967

本文档包含您的问题的答案

[http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/javac.html](http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/javac.html)

每次使用`-classpath`都是一项非常耗时的工作。相反，使用环境变量（如果您正在处理诸如 Java Mail 之类的包）

类路径用于编译。`Javac`是 Java 编译器，它将您的代码转换为字节码。

当涉及到`java`它时，它用于运行您的 Java 源文件/jar。

# .net - 添加自定义 xmlns 后 Xaml 智能感知不起作用

> ID：15121698
> 
> 赞同：5
> 
> 时间：2013-02-27T20:25:56.780
> 
> 标签：.net, xaml, c#-4.0, visual-studio-2012, intellisense

我被以下情况困住了。我有 WPF 网络。VS2012+Resharper 中的 4.0 项目，带有一些 xaml 视图和用户控件。项目编译和工作得很好，但是没有 XAML 智能感知（或任何其他关于这是 xaml 文件的通知 - 例如，悬停在声明的控制上后没有工具提示）。当我在这个项目中声明的命名空间包含 xmlns 值时，这种智能感知总是会中断。例如：

`xmlns:conventers="clr-namespace:MyProject.Helpers.Conventers"`

将打破所有智能感知。删除此行 - 将使其再次工作。

它仅适用于同一项目中的命名空间——当我引用外部 dll 并从中使用命名空间时——没有问题。

有谁知道我是否遗漏了一些明显的东西？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-28T09:33:12.510

好的，我想通了...这很容易，但令人恼火的错误。添加`;assembly=`xmlns 后，智能感知再次开始工作。以防其他人将来需要它

`xmlns:conventers="clr-namespace:MyProject.Helpers.Conventers;assembly="`

工作得很好。

# java - 无法编译个人客户类，构造函数有问题？

> ID：15121706
> 
> 赞同：0
> 
> 时间：2013-02-27T20:26:20.740
> 
> 标签：java, class, constructor

这是一个添加/删除不同类型客户的简单程序。

我知道这可能很简单，但我已经有一段时间了。

不断收到错误，

```
constructor Customer in class Customer cannot be applied to the given types; required; java.lang. String, Address, char found:no arguments reason: actual and formal argument lists differ in length 
```

我猜这与客户构造函数有关，但不知道。

```
public class Address
{
    private String street,town;

    /**
     * Constructor for Address
     * 
     * @param street    The street
     * @param town      The town
     */
    public Address (String street, String town)
    {
        this.street = street;
        this.town = town;
    }

    /**
     * @return   The street
     */
    public String getStreet()
    {
        return street;
    }

    /**
     * @return   The town
     */
    public String getTown()
    {
        return town;
    }

    /**
     * Change the street part of the address
     * 
     * @param street    The new street
     */
    public void setStreet(String street)
    {
        this.street = street;
    }

    /**
     * Change the town part of the address
     * 
     * @param street    The new town
     */
    public void setTown(String town)
    {
        this.town = town;
    }

    public String toString()
    {
        return street + "\n" + town;
    }
} 
```

```
public class Name
{
    private String fName, lName;

    /** 
     * Constructor for Name
     * 
     * @param fName     The first name
     * @param lName     The last name
     */
    public Name(String fName, String lName)
    {
        this.fName = fName;
        this.lName = lName;
    }  

    /** 
     * @return  The first name
     */
    public String getFName()
    {
        return fName;
    }

    /** 
     * @return  The last name
     */
    public String getLName()
    {
        return lName;
    }

    /**
     * Amend the first name
     * 
     * @param fName The new first name
     */
    public void setFName(String fName)
    {
        this.fName = fName;
    }

     /**
     * Amend the last name
     * 
     * @param lName The new last name
     */
    public void setLName(String lName)
    {
        this.lName = lName;
    }

    public String toString()
    {
        return fName + " " + lName;
    }

} 
```

```
public class Customer
{
    // instance variables - replace the example below with your own
    private String accountNumber;
    private Address address;
    private int balance;
    private char customerType;

    /**
     * Constructor for objects of class Customer
     */
    public Customer(String accountNumber, Address address, char customerType)
    {
        // initialise instance variables
        this.accountNumber= accountNumber;
        this.address= address;
        balance = 0;
        this.customerType=customerType;
    }

    /** 
     * Adds money to the ammount in the account
     */
    public void credit(int amt)
    {
        balance= balance + amt;
    }

    /**
     * removes money from the ammount in the account
     */
    public void debit(int amt)
    {
        balance= balance - amt;
    }

    /**
     * Returns the account number of the customer
     */
    public String getAccountNumber()
    {
        return accountNumber;
    }

    /**
     * returns the address of the customer
     */
    public Address getAddress()
    {
        return address;
    }

    /**
     * returns the balance of the customer
     */
    public int getBalance()
    {
        return balance;
    }

    /**
     * Returns the type of customer Bussiness or Personal
     */
    public char getCustomerType()
    {
        return customerType;
    }

    public void setAddress(Address address)
    {
       this.address=address;
    }

    public String toString()
    {
        String output ="Account Number: " + accountNumber + "Customer Type: " + customerType  + "balance: " + getBalance() + "Address: " + super.toString();
        return output;
    }
} 
```

```
public class PersonalCustomer extends Customer
{
    // instance variables
    private Name name;

    public PersonalCustomer(String accountNumber, Address address, Name name)
    {
        // initialise instance variables
        this.accountNumber= accountNumber;
        this.address=address;
        this.name= Name;
    }

    public Name getName()
    {
        return + "Address: " + super.toString();
    }

    public void print()
    {
        System.out.println(toString());
    }

    public String toString()
    {
        String output = getFName() + getLName() + "\n" + "Account Number: " + accountNumber + "\n" 
                                + "Customer Type: " + customerType + "\n" + "Address: " + super.toString() + "\n"  
                                            + "balance: " + getBalance();
        return output; 
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:29:55.503

错误消息说您正在调用：

```
new Customer(); 
```

但客户需要字符串、地址和字符，例如：

```
new Customer("Bob", new Address("Cool Street","Awesome Town"), 'a'); 
```

这似乎有点奇怪，但原因是如果您不这样做，您的子类会隐式调用父构造函数。

```
public PersonalCustomer(String accountNumber, Address address, Name name)
{
    // super(); //calls the parent constructor with no arguments without you seeing
    this.accountNumber= accountNumber;
    this.address=address;
    this.name= Name;
} 
```

您需要做的就是将 PersonalCustomer 构造函数更改为

```
public PersonalCustomer(String accountNumber, Address address, Name name)
{
    super(accountNumber, address, 'p'); //or whatever customer type they are supposed to get
    this.name= Name;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:33:48.690

如果您不定义构造函数，则有一个隐式的无参数构造函数。

但是，当你定义一个带参数的构造函数时，隐式的 no-rags 构造函数就会消失。

在定义使用默认构造函数的新构造函数之前，您必须有一些代码，即`new Customer()`. **您必须定义一个无参数构造函数来解决您的问题**

这个小宝石吸引了许多新的 Java 程序员。

# c# - 通过 ToConstant 解析时处理对象，但通过 ToMethod 解析时不处理

> ID：15121708
> 
> 赞同：1
> 
> 时间：2013-02-27T20:26:25.727
> 
> 标签：c#, ninject

假设我有一个名为 _kernel 的 Ninject 内核，一个给定的对象（作为参数接收），比如 myClass，类型为 IMyClass:IDisposable; 我注意到当我通过 ToMethod 将 IMyClass 绑定到 myClass 时，如下所示：

```
Bind<IMyClass>().ToMethod(x => myClass); 
```

然后，每当我处理 _kernel 时，`myClass.Dispose()`都不会被调用。

但是，如果我改为通过 ToConstant 将 IMyClass 绑定到 myClass，如下所示：

```
Bind<IMyClass>().ToConstant(myClass); 
```

then`myClass.Dispose()`将在处理 _kernel 时调用。

你们能给我解释一下这种行为吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T22:38:02.057

的标准作用域`ToConstant`是*单例*作用域，而 of`ToMethod`是*瞬态*作用域。瞬态范围对象的生命周期不由 Ninject 管理，因此实例不是`Dispose`d。

# python - 如何让 python 程序运行而不是在记事本中打开？

> ID：15121714
> 
> 赞同：5
> 
> 时间：2013-02-27T20:26:44.067
> 
> 标签：python, notepad

我在打开 .py 文件时遇到了一些问题。我有一个调用这个.py 文件的程序（即路径名/example.py 文件.txt），但它没有运行python 程序，而是在记事本中打开它。我如何让它运行？

程序本身接收一个文件，并创建一个更具可读性的输出。

编辑：操作系统是 Windows 7。调用 python 的文件是 .bat 文件。

编辑2：看起来我出于某种原因不得不重新安装python......但看起来它终于可以工作了。为什么一开始就没有想到重新安装...然后我不得不更改文件扩展名的打开方式。多谢你们

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-07-12T20:00:38.880

这是因为您很可能已将记事本设置为打开 .py 文件的默认程序。转到 Windows 中的默认程序应用程序。选择按扩展名选择应用程序。在这里搜索 .py 文件。将选项从记事本更改为 python。这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-24T15:38:49.040

好的。
1）我尝试将其关闭并再次打开。2）我卸载并重新安装了python

仍然没有喜悦。接着！

在 Windows 资源管理器中有一个打开方式选项，如果您单击文件名或在命令行中输入文件名，则该选项设置 Windows 指向的默认程序。如果它不是 python，请从记事本或其他任何东西中更改它。将其更改为python。然后突然。没问题-o。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:30:42.217

您需要从命令行运行它。 [http://docs.python.org/2/faq/windows.html#how-do-i-run-a-python-program-under-windows](http://docs.python.org/2/faq/windows.html#how-do-i-run-a-python-program-under-windows)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:30:38.863

你想像这样运行程序吗？

```
 /dirdir/MyPythonScript.py 
```

请尝试以下操作

```
 python /dirdir/MyPythonScript.py 
```

# java - Java 非常不寻常的类路径问题

> ID：15121715
> 
> 赞同：2
> 
> 时间：2013-02-27T20:26:53.247
> 
> 标签：java, jar, classpath

我正在尝试使用以下代码运行具有本机库和内容的应用程序：

```
ProcessBuilder pb = new ProcessBuilder("javaw",
    "-classpath", 
    binDir + "polyrd.jar;" + binDir + "lwjgl.jar;" + binDir + "lwjgl_util.jar;",
    "-Djava.library.path=" + nativesDir,
    "monster860.polyrd.Polyrd"); 
```

我尝试在命令行中执行等效操作，将其更改为 -cp，仅使用`bindir`而不是`binDir + "polyrd.jar;" + binDir + "lwjgl.jar;" + binDir + "lwjgl_util.jar;"`，并在 java 和 javaw 之间切换，但无论我做什么，它都给了我：

```
java.lang.NoClassDefFoundError: monster860/polyrd/Polyrd
Caused by: java.lang.ClassNotFoundException: monster860.polyrd.Polyrd
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source) 
```

任何人都可以帮忙吗？

我的操作系统是 Windows Vista。是的，这些文件确实存在。

这是我得到`binDir`和的方法`nativesDir`：

```
public ProcessRunnable(File nativesDir, File binDir) {
        try {
            this.nativesDir = nativesDir.getCanonicalPath() + File.separator;
            this.binDir = binDir.getCanonicalPath() + File.separator;
        } catch (IOException e) {
        // TODO Auto-generated catch block
            e.printStackTrace();
        }
} 
```

编辑：嗯，当然，它与此完全无关，但下载器只下载文件的前 2 KB。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:35:28.440

从 Java 6 开始，“为了特别方便，包含基本名称的类路径元素`*`被认为等同于指定目录中所有文件的列表，扩展名为`.jar`或`.JAR`”。有关详细信息，请参阅[`java`](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html)命令行选项。

附录：此示例开始[`JFreeChart`](https://stackoverflow.com/tags/jfreechart/info)使用提到的通配符功能。

```
import java.io.BufferedReader;
import java.io.InputStreamReader;

/** @see https://stackoverflow.com/a/15121864/230513 */
public class PBTest {

    private static final String baseDir = "/opt/jfreechart/";
    public static void main(String[] args) {
        ProcessBuilder pb = new ProcessBuilder("java", "-cp",
            baseDir + "lib/*:" + baseDir + "jfreechart-1.0.14-demo.jar",
            "demo.SuperDemo");
        pb.redirectErrorStream(true);
        try {
            Process p = pb.start();
            String s;
            // read from the process's combined stdout & stderr
            BufferedReader stdout = new BufferedReader(
                new InputStreamReader(p.getInputStream()));
            while ((s = stdout.readLine()) != null) {
                System.out.println(s);
            }
            System.out.println("Exit value: " + p.waitFor());
            p.getInputStream().close();
            p.getOutputStream().close();
            p.getErrorStream().close();
        } catch (Exception ex) {
            ex.printStackTrace(System.err);
        }
    }
} 
```

附录：这是 Windows 的更改，需要`;`作为路径分隔符。

```
private static final String baseDir = "C:/Users/Public/JFreeChart/";
public static void main(String[] args) {
    ProcessBuilder pb = new ProcessBuilder("java", "-cp",
        baseDir + "lib/*;" + baseDir + "jfreechart-1.0.14-demo.jar",
        "demo.SuperDemo"); 
```

# python - 使用 sys.argv [1] 时的“列表索引超出范围”

> ID：15121717
> 
> 赞同：11
> 
> 时间：2013-02-27T20:27:03.687
> 
> 标签：python, python-3.x, command-line-arguments

我正在编写一个简单的 Python 客户端和服务器，它可以在我的代码中传递服务器地址正常工作，但是，我希望用户能够输入服务器地址并在其不正确时抛出错误。当我有下面的代码时，我从终端“列表索引超出范围”收到一条错误消息。

```
server = (sys.argv[1])
serverAdd = (server, '65652') # server address and port number 
```

任何人都可以帮我解决这个问题。

当我在 python 中运行我的客户端程序时，我希望能够输入一个地址来连接并将其存储在服务器中。我通过键入 programname.py 直接从命令行运行程序。服务器已经在运行侦听传入连接。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-27T20:44:31.723

使用这个 Python：

```
import sys

print(sys.argv) 
```

并使用以下命令调用：

```
>python q15121717.py 127.0.0.1 
```

我得到这个输出：

```
['q15121717.py', '127.0.0.1'] 
```

我认为您没有将参数传递给您的 Python 脚本

现在您可以稍微更改您的代码以从命令行获取服务器或在没有传递服务器时提示服务器。在这种情况下，您会看到如下内容：

```
if len(sys.argv) > 1:
    print(sys.argv[1])
else:
    print(input("Enter address:")) 
```

# sql-server - 实体框架不会用复合主键解析 PK-FK 关系？

> ID：15121721
> 
> 赞同：3
> 
> 时间：2013-02-27T20:27:29.403
> 
> 标签：sql-server, entity-framework, foreign-key-relationship, ado.net-entity-data-model, composite-primary-key

我正在尝试在现有 SQL Server 基础结构上设置 EDM，但遇到了问题。

EDM 不会将*PK* -FK 关系解析为复合外键。

我的数据库表结构看起来像这样（更改名称以保护无辜者）：

*   我有一个 PERSONS 表，其中包含一个名为 PerID (PK) 的 INT 列
*   我有一个 OFFICE 表，其中包含一个名为 OffID (PK) 的 INT 列
*   我使用一个名为 OFFICEPERSONS 的表将这些表绑定在一起，在 PERSONS 和 OFFICE 之间创建了多对多的关系。此表有两个 INT 列 PerID 和 OffID，它们共同构成一个复合主键。
*   我有一个名为 OFFICELOCATION 的表，其中包含两个 INT 列，LocID 和 OffID。这两列包含一个复合主键。此外，OffID 也是 OFFICE 表的 FK。
*   最后，我有一个名为 OFFICEPERSONSLOCATION 的表。此表具有三个 INT 列：PerID、OffID 和 LocID。所有三列都包含一个复合主键。LocID 和 OffID 提供与 OFFICELOCATION 的 FK 关系，OffID 和 PerID 提供与 OFFICEPERSONS 的 FK 关系。

跟我到现在？希望我还没有失去你。当一切都说完了，我的结构看起来像这样： ![数据库结构图](../Images/89f129fef0ee71b7100ebd229398aefc.png)

这种结构在 SQL Server 中效果很好。在电火花？没那么多。它不允许我构建 OFFICEPERSONSLOCATION 和 OFFICEPERSONS 之间的关系。我收到以下错误：

> 错误 6037：存储模型中省略了外键约束“FK_OFFICEPERSONSLOCATION_OFFICEPERSONS”。表“Model.Store.OFFICEPERSONSLOCATION”的“OffID”列是参与多个关系的外键。一对一的实体模型将不会验证，因为数据不一致是可能的。

嗯？数据不一致？！？如何？

如何让我的实体框架识别这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-13T21:23:30.943

我同意这是实体框架的问题，而且问题很愚蠢。即使您将 UPDATE CASCADE 设置为“无操作”，也不会造成不一致，但不，它声称您可以以某种方式。

无论如何，在这种情况下，如果您愿意使用*代理*键而不是*复合*键，则可以解决这个问题，因为更改 ID 引用的唯一位置是在主表中。

在这种情况下，OffID 可能是“不一致的”，但是通过在 OFFICEPERSONS 和 OFFICELOCATIONS 表中使用 ID（因此在 OFFICEPERSONSLOCATION 中引用），您必须在其主表中管理 OffId。

# c# - 通过突出显示以编程方式选择 wpf 数据网格行

> ID：15121723
> 
> 赞同：3
> 
> 时间：2013-02-27T20:27:40.107
> 
> 标签：c#, wpf, xaml, datagrid

我在 WPF 中创建了一个带有几行的数据网格。我在我的 wpf 网格上创建了​​四个按钮，以便在行之间导航：[<<] -- [<] -- [>] -- [>>]

我使用 SelectedItem 函数来设置行。我的问题是突出显示似乎很糟糕（缓慢）出现（这有点难以解释）。

当我使用键盘箭头（向上和向下）在行之间移动时，突出显示是快速而直接的。在我的按钮后面使用我的代码，突出显示有点慢和奇怪。

**这是我的代码**

```
 private void Button_Click_Goto_Premier(object sender, RoutedEventArgs e)
    {
        myDataGridEvtCode.SelectedItem = myDataGridEvtCode.Items[0];
        myDataGridEvtCode.Focus();
    }

    private void Button_Click_Goto_Precedent(object sender, RoutedEventArgs e)
    {
        if (myDataGridEvtCode.SelectedIndex > 0)
        {
            myDataGridEvtCode.SelectedItem = myDataGridEvtCode.Items[myDataGridEvtCode.SelectedIndex - 1];
            myDataGridEvtCode.Focus();
        }
    }

    private void Button_Click_Goto_Suivant(object sender, RoutedEventArgs e)
    {
        if (myDataGridEvtCode.SelectedIndex < myDataGridEvtCode.Items.Count - 1)
        {
            myDataGridEvtCode.SelectedItem = myDataGridEvtCode.Items[myDataGridEvtCode.SelectedIndex + 1];
            myDataGridEvtCode.Focus();
        }
    }

    private void Button_Click_Goto_Dernier(object sender, RoutedEventArgs e)
    {
        myDataGridEvtCode.SelectedItem = myDataGridEvtCode.Items[myDataGridEvtCode.Items.Count-1];
        myDataGridEvtCode.Focus();
    } 
```

有人对此有一些想法吗？

非常感谢我的朋友:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T21:11:24.133

我假设，您使用`System.Windows.Control.DataGrid`. 我没有尝试你的代码。这是一些代码，我只是将它们放在一个示例 WPF 应用程序中。通过按下按钮进行选择与使用鼠标/键盘手动选择行一样流畅。

## XAML

```
<Window x:Class="WpfApplication3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
        Title="MainWindow" Height="350" Width="525">
    <StackPanel>
        <DataGrid x:Name="MyGrid" Height="200"/>
        <Button Content="Previous" Click="Previous"/>
        <Button Content="Next" Click="Next"/>
    </StackPanel>
</Window> 
```

## 背后的代码

```
namespace WpfApplication3
{
    public class Person
    {
        public Person(string firstName, string lastName)
        {
            FirstName = firstName;
            LastName = lastName;
        }

        public string FirstName { get; set; }
        public string LastName { get; set; }
    }

    public partial class MainWindow
    {
        public MainWindow()
        {
            InitializeComponent();

            var persons = new List<Person>
                {
                    new Person("Steve", "Jobs"),
                    new Person("Bill", "Gates"),
                    new Person("Dan", "Brown"),
                    new Person("Barack", "Obama")
                };

            MyGrid.ItemsSource = persons;
        }

        private void Next(object sender, RoutedEventArgs e)
        {
            MyGrid.Focus();

            int nextIndex = MyGrid.SelectedIndex + 1;
            if (nextIndex > MyGrid.Items.Count - 1) return;
            MyGrid.SelectedIndex = nextIndex;
        }

        private void Previous(object sender, RoutedEventArgs e)
        {
            MyGrid.Focus();

            int previousIndex = MyGrid.SelectedIndex - 1;
            if (previousIndex < 0) return;
            MyGrid.SelectedIndex = previousIndex;
        }
    }
} 
```

使用指标可能是线索。虽然我还没有寻找证据。

# jquery - jQuery UI 可调整大小对齐大小

> ID：15121727
> 
> 赞同：2
> 
> 时间：2013-02-27T20:27:45.263
> 
> 标签：jquery, jquery-ui, resizable

我有一个可调整大小的左侧导航。默认宽度为 200，我希望调整器对齐到该宽度。目前我有这个运行良好的 if 子句，但我不知道如何以编程方式捕捉到该宽度。

```
resize: function (event, ui) {
    if(Math.abs(200 - ui.size.width) <= 20){
        // snap to 200 width
    }
} 
```

如果有人可以在这里帮助我会很棒:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T20:35:57.303

好的，让它工作。只需将元素的宽度设置为 200。它的容差为 15px，因此如果元素在 185 和 215px 之间，它将对齐到 200px。

```
$("#left").resizable({
minWidth: 60,
handles: "e",
resize: function (event, ui) {
    if(Math.abs(200 - ui.size.width) <= 15){
        $("#left").css("width", 200);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:34:37.920

在那里： http: [//jqueryui.com/resizable/#max-min](http://jqueryui.com/resizable/#max-min)你可以使用这个：

```
$(function() {
    $( "#left" ).resizable({
      maxWidth: 200,
      minWidth: 20
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:34:51.237

怎么样`$(ui).width(200);`？请注意，我不知道`ui`您的代码中有什么，因此您可能需要调整`jQuery`选择器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-05T20:11:19.510

我会检查一个范围内的宽度，以便从任一侧发生“捕捉”。

```
resize: function (event, ui) {
    if(ui.size.width >= 180 && ui.size.width <= 220){
        // snap to 200 width
    }
} 
```

# wpf - DataGridRow 的背景属性错误

> ID：15121729
> 
> 赞同：0
> 
> 时间：2013-02-27T20:27:49.250
> 
> 标签：wpf, xaml, datagrid, triggers, styles

我有一个 WPF 应用程序，它使用一个`DataGrid`控件并被警车中的警察使用。我使用合并字典来实现日夜“模式”，当您在两者之间切换程序时，调色板会发生变化。该应用程序从我公司制造的特殊传感器收集数据并将其显示给官员。

有`DataGrid`问题的行为很奇怪。程序第一次启动时，它最初是空的。收集数据时，会将行添加到`DataGrid`. 当您启动程序时，它最初处于日间模式。问题是第一行的背景没有更改为控件的夜间模式颜色。它保持白色，这是日间模式颜色。如果您在白天模式和夜间模式之间来回切换，它会保持白色。

这与添加到该行`DataGrid`之后的任何行不同，后者具有正确的颜色并在颜色之间正确地来回切换。

这是我在 App.xaml 中为`DataGridRow`该类定义的样式：

```
<Application x:Class="MyApplication.App"
     . . .>

    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/MyApplication;component/DayTime.xaml" />

                <ResourceDictionary>
                    . . .
                    <Style TargetType="{x:Type DataGridRow}">
                    <Setter Property="BorderBrush"     Value="{DynamicResource DataBorder}" />
                    <Setter Property="Background"      Value="{DynamicResource DataBackground}" />
                    <Setter Property="Foreground"      Value="{DynamicResource DataForeground}" />
                <Style.Triggers>
                    <Trigger Property="IsFocused" Value="True">
                        <Setter Property="Background"  Value="{DynamicResource DataBackground}" />
                        <Setter Property="BorderBrush" Value="{DynamicResource DataBorderFocused}" />
                        <Setter Property="Foreground"  Value="{DynamicResource DataForeground}" />
                    </Trigger>
                    <Trigger Property="IsKeyboardFocused" Value="True">
                        <Setter Property="Background"  Value="{DynamicResource DataBackground}" />
                        <Setter Property="BorderBrush" Value="{DynamicResource DataBorderFocused}" />
                        <Setter Property="Foreground"  Value="{DynamicResource DataForeground}" />
                    </Trigger>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background"  Value="{DynamicResource DataBackgroundSelected}" />
                        <Setter Property="BorderBrush" Value="{DynamicResource DataBorderSelected}" />
                        <Setter Property="Foreground"  Value="{DynamicResource DataForegroundSelected}" />
                    </Trigger>
                </Style.Triggers>
            </Style>
            . . .
                </ResourceDictionary>
            </ResourceDictionary>
        </ResourceDictionary>
    </Application.Resources>
</Application> 
```

当我在程序上运行 Snoop 并深入到有`DataGridRow`问题的地方时，该`Background`属性的值为白色 (#FFFFFFFF)，并且它的值源设置为“DefaultStyle”。不过，这似乎不是我定义的风格，因为当我切换到白天模式并返回白色时，它并没有改变。我认为这是微软定义的默认样式，根本没有使用我的样式。但仅在插入的第一行上，`DataGrid`如果它最初是空的。

对于后续行，Value Source 列显示为“ParentTemplate”。这一定是我的风格，因为当您切换夜间模式时，背景颜色会正确更改。

我该如何解决这个问题，以使每一行都`DataGrid`正确？

编辑：

为了完整起见，这里是`DataGrid`控件使用的样式，以防万一。

```
<Style TargetType="{x:Type DataGrid}">
    <Setter Property="Background"                    Value="{DynamicResource DataBackground}" />
    <Setter Property="Foreground"                    Value="{DynamicResource TextForeground}" />
    <Setter Property="BorderBrush"                   Value="{DynamicResource DataBorder}" />
    <Setter Property="BorderThickness"               Value="1" />
    <Setter Property="RowDetailsVisibilityMode"      Value="VisibleWhenSelected" />
    <Setter Property="ScrollViewer.CanContentScroll" Value="true" />
    <Setter Property="ScrollViewer.PanningMode"      Value="Both" />
    <Setter Property="Stylus.IsFlicksEnabled"        Value="False" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type DataGrid}">
                <Border BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        Background="{TemplateBinding Background}"
                        Padding="{TemplateBinding Padding}"
                        SnapsToDevicePixels="True">
                    <ScrollViewer x:Name="DG_ScrollViewer" Focusable="false">
                        <ScrollViewer.Template>
                            <ControlTemplate TargetType="{x:Type ScrollViewer}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Button Command="{x:Static DataGrid.SelectAllCommand}"
                                            Focusable="false"
                                            Style="{DynamicResource {ComponentResourceKey ResourceId=DataGridSelectAllButtonStyle, TypeInTargetAssembly={x:Type DataGrid}}}"
                                            Visibility="{Binding HeadersVisibility, ConverterParameter={x:Static DataGridHeadersVisibility.All}, Converter={x:Static DataGrid.HeadersVisibilityConverter}, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"
                                            Width="{Binding CellsPanelHorizontalOffset, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                                    <DataGridColumnHeadersPresenter Grid.Column="1"
                                                                    x:Name="PART_ColumnHeadersPresenter"
                                                                    Visibility="{Binding HeadersVisibility, ConverterParameter={x:Static DataGridHeadersVisibility.Column}, Converter={x:Static DataGrid.HeadersVisibilityConverter}, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                                    <ScrollContentPresenter x:Name="PART_ScrollContentPresenter"
                                                            CanContentScroll="{TemplateBinding CanContentScroll}"
                                                            Grid.ColumnSpan="2"
                                                            Grid.Row="1" />
                                    <ScrollBar x:Name="PART_VerticalScrollBar"
                                               Grid.Column="2"
                                               Maximum="{TemplateBinding ScrollableHeight}"
                                               Orientation="Vertical"
                                               Grid.Row="1"
                                               Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                               Value="{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                               ViewportSize="{TemplateBinding ViewportHeight}"
                                               MinWidth="45" Width="50" />
                                    <Grid Grid.Column="1"
                                          Grid.Row="2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="{Binding NonFrozenColumnsViewportHorizontalOffset, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <ScrollBar x:Name="PART_HorizontalScrollBar"
                                                   Grid.Column="1"
                                                   Maximum="{TemplateBinding ScrollableWidth}"
                                                   Orientation="Horizontal"
                                                   Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                                   Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                   ViewportSize="{TemplateBinding ViewportWidth}" />
                                    </Grid>
                                </Grid>
                            </ControlTemplate>
                        </ScrollViewer.Template>
                        <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    </ScrollViewer>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
    <Style.Triggers>
        <Trigger Property="IsGrouping" Value="true">
            <Setter Property="ScrollViewer.CanContentScroll" Value="false" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

编辑：

作为经验，我将此成员变量添加到存在问题的窗口的代码隐藏中：

```
private static Style dataGridRowStyle = null; 
```

然后我将此代码添加到我的窗口的构造函数中：

```
if ( dataGridRowStyle == null ) {
    dataGridRowStyle = FindResource( typeof( DataGridRow ) ) as Style;
    MyGrid.RowStyle = dataGridRowStyle;
} 
```

通过这样做，我看到添加到的每一行都`DataGrid`具有原始的默认样式。当我将上述代码移至`Loaded`事件处理程序时，也发生了这种情况。

接下来，我删除了上面的代码，并`Style`在 app.xaml 文件中的定义中添加了一个 x:Key 属性。然后我将此属性添加到`DataGrid`控件的定义中：

```
RowStyle={DynamicResource MyDataGridRowStyle} 
```

现在每一行都有我的风格。这很好，但我认为`TargetType`仅使用属性声明我的样式就足以让它应用于所有行。为什么没有呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T03:58:22.833

经过多次头疼、心痛和网络搜索，我终于弄清楚了我的程序中发生了什么。

我的程序使用合并字典来实现日夜模式。事实证明，合并字典是问题的原因，如[本教程](http://wpftutorial.net/MergedDictionaryPerformance.html)中所述。

修复方法是在根字典中放置一个默认样式。实际上，我的代码在标签内的资源字典中包含所有模板。我将它们提升了一个级别，现在 WPF 在第一行和每一行都找到了我的默认模板。

# django - 在 Django 的自定义 404/500 页面中使用静态文件

> ID：15121731
> 
> 赞同：8
> 
> 时间：2013-02-27T20:27:56.057
> 
> 标签：django, django-templates, http-status-code-404, django-staticfiles

我想在我`404/500`制作的自定义页面上使用一些自定义 CSS 和图像。不过，Django 并未`STATIC_URL`在这些页面中包含该变量。

实现这一目标的最佳方法是什么？我还尝试制作自定义`404/500`视图并渲染任意 HTML 文件，但效果并不理想。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-27T20:37:34.913

这是我的做法：

```
# urls or settings
handler500 = 'mysite.views.server_error'

# views
from django.shortcuts import render

def server_error(request):
    # one of the things ‘render’ does is add ‘STATIC_URL’ to
    # the context, making it available from within the template.
    response = render(request, '500.html')
    response.status_code = 500
    return response 
```

值得一提的是 Django 默认不这样做的原因：

> “默认的 500 视图不向 500.html 模板传递任何变量，并使用空的 Context 进行渲染，以减少出现其他错误的机会。”</p>
> 
> -- [Adrian Holovaty，Django 文档](https://docs.djangoproject.com/en/dev/ref/views/#the-500-server-error-view)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-06T14:00:14.063

我遇到了同样的问题，并找到了一个不需要自定义模板或处理程序的解决方案。从 Django 1.4 开始，您可以使用标签 get_media_prefix 和 get_static_prefix 在 MEDIA_URL 和 STATIC_URL 不在上下文中时访问它们。

在我的特殊情况下（Django 1.5），我想访问我的页面 500.html 中的一些静态图像。我刚刚在模板的开头添加了

```
{% load static %} 
```

然后获取带有这些标签的媒体和静态网址

```
<img src="{% get_media_prefix %}logo.png">
<img src="{% get_static_prefix %}img/error_pages/error.png" style="height:235px;"> 
```

你可以在这里找到官方文档：[https ://docs.djangoproject.com/en/1.5/ref/templates/builtins/#get-static-prefix](https://docs.djangoproject.com/en/1.5/ref/templates/builtins/#get-static-prefix)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-27T20:32:46.630

我相信您只需要覆盖默认的 404/500 错误处理。这应该让你开始：

[http://docs.djangoproject.com/en/dev/topics/http/views/#customizing-error-views](http://docs.djangoproject.com/en/dev/topics/http/views/#customizing-error-views)

# playframework-2.0 - 从视图表单向应用程序方法传递参数

> ID：15121732
> 
> 赞同：0
> 
> 时间：2013-02-27T20:27:57.640
> 
> 标签：playframework-2.0

我之前填充了 Web 表单来创建模型对象，但我想要做的是从视图将争论传递给应用程序方法。在我看来：

```
<form>
      <input type="text" id="arg"></br>
      <input type="submit" onsubmit="@routes.Application.search(@arg)" value="Submit">
</form> 
```

但这似乎不正确。是否有其他方法可以使用 scala 帮助程序自己处理 HTML 输入。方法*search*将字符串作为参数并包含在路由表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:34:46.830

您的输入**需要**有一个名称，然后您就可以毫无问题地从请求中绑定它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T06:00:51.387

删除 arg 之前的“@”。你不需要它，方法调用中的第一个“@”足以启动一个 Scala 代码剪断。

```
<form>
      <input type="text" mame="arg" id="arg"></br>
      <input type="submit" onsubmit="@routes.Application.search(arg)" value="Submit">
</form> 
```

# redirect - web.config 通过 ip 重定向

> ID：15121733
> 
> 赞同：1
> 
> 时间：2013-02-27T20:27:59.697
> 
> 标签：redirect, web-config, ip, security, ip-address

为了网站安全，我想使用 web.config 将单个 IP 地址或几个 IP 地址重定向到不同的域。我是新手。我知道如何限制访问或阻止某些 IP，但有没有简单的重定向方法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:31:34.463

要重定向某些 IP 地址，您需要使用适用于 IIS 7的[URL 重定向规则引擎](http://www.iis.net/downloads/microsoft/url-rewrite)

查看此链接以获取有关如何通过 IP 地址重定向的说明： [https ://webmasters.stackexchange.com/questions/31509/web-config-to-redirect-except-some-given-ips](https://webmasters.stackexchange.com/questions/31509/web-config-to-redirect-except-some-given-ips)

```
<rewrite>
  <rules>
    <rule name="Imported Rule 1" stopProcessing="true">
      <match url="(.*)$" ignoreCase="false" />
      <conditions>
        <add input="{REMOTE_HOST}" pattern="^123\.123\.123\.123" ignoreCase="false" negate="true" />
      </conditions>
      <action type="Redirect" redirectType="Found" url="/coming-soon.html" />
    </rule>
  </rules>
</rewrite> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-18T13:03:46.170

无法回复 Victor 的评论，所以我将把我编辑的代码放在这里而不是建议更改。

```
<rewrite>
  <rules>
    <rule name="Imported Rule 1" stopProcessing="true">
      <match url="(.*)$" ignoreCase="false" />
      <conditions>
        <add input="{REMOTE_HOST}" pattern="^123\.123\.123\.123" ignoreCase="false" negate="true" />
      </conditions>
      <action type="Redirect" redirectType="Found" url="http://www.domain-to-redirect-to/coming-soon.html" />
    </rule>
  </rules>
</rewrite> 
```

这里的变化是它重定向到询问者想要的新域，而不是同一个域上的页面。

请注意，如果您想重定向到同一个域上的coming-soon.html，您将需要更改匹配规则，否则您将进入重定向循环。

因此：

```
<rewrite>
  <rules>
    <rule name="Imported Rule 1" stopProcessing="true">
      <match url="(.*)coming-soon.html$" ignoreCase="false" negate="true" />
      <conditions>
        <add input="{REMOTE_HOST}" pattern="^123\.123\.123\.123" ignoreCase="false" negate="true" />
      </conditions>
      <action type="Redirect" redirectType="Found" url="/coming-soon.html" />
    </rule>
  </rules>
</rewrite> 
```

# iphone - _loadViewFromNibNamed 被调用，即使没有与 UIViewController 关联的 nib

> ID：15121735
> 
> 赞同：0
> 
> 时间：2013-02-27T20:28:06.963
> 
> 标签：iphone, ios, xcode, crash

我有一个 UIViewController 子类，我正在实例化它并尝试像这样推送到 navigationController：

```
MenuVC *menuVC = [[MenuVC alloc] init];
[self.navigationController pushViewController:menuVC animated:YES]; 
```

我没有与此类关联的 nib 文件，因此只需做一个简单`..alloc] init]`的而不是`initWithNib:bundle:`.

我仍然在`pushViewController`通话中遇到崩溃，并且跟踪说明了这一点

```
reason: '-[UIViewController _loadViewFromNibNamed:bundle:] loaded the "MenuVC" nib but the view outlet was not set.' 
```

我不明白为什么会发生这种情况。我有其他视图控制器可以使用相同的方法正常加载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T21:45:02.357

我想我在 Apple 的文档中找到了答案：

> 如果 nibName 属性返回非 nil 值，则视图控制器具有关联的 nib 文件，如果视图控制器是从情节提要中实例化的，如果您使用 initWithNibName:bundle: 方法显式为其分配了一个 nib 文件，或者如果 iOS在应用程序包中找到一个 nib 文件，其名称基于视图控制器的类名。

因此，这意味着操作系统实际上会在找到 nib 时尝试加载它。我的包中确实有一个与 VC 同名的笔尖，但没有关联它的`File Owner`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:35:44.570

真正的问题是 Viewcontroller 有一个默认的视图，并且不知何故 IB 到类 view->view 的连接丢失了，因此出现了错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:29:00.840

这可能不是“答案”，但已解决。我刚刚删除了整个文件并添加了一个具有不同名称的新文件，并且它有效。

# ruby-on-rails-3 - Rails 中关联的空对象模式

> ID：15121737
> 
> 赞同：5
> 
> 时间：2013-02-27T20:28:08.920
> 
> 标签：ruby-on-rails-3, null-object-pattern

尽管在这里查看了一些关于 Rails 中空对象的答案，但我似乎无法让它们工作。

```
class User < ActiveRecord::Base
  has_one :profile
  accepts_nested_attributes_for :profile

  def profile
    self.profile || NullProfile #I have also tried
    @profile || NullProfile #but it didn't work either
  end
end

class NullProfile
  def display #this method exists on the real Profile class
    ""
  end
end

class UsersController < ApplicationController
  def create
    User.new(params)
  end
end 
```

我的问题是，在创建用户时，我为配置文件传递了正确的嵌套属性（profile_attributes），最终我的新用户得到了一个 NullProfile。

我猜这意味着我的自定义配置文件方法在创建和返回 NullProfile 时被调用。如何正确执行此 NullObject 以便仅在读取时发生，而不是在对象的初始创建时发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T18:57:25.783

我正在经历，如果它不存在，我想要一个干净的新对象（如果你这样做，那么`object.display`没有错误可能`object.try(:display)`会更好）这也是我发现的：

1：别名/alias_method_chain

```
def profile_with_no_nill
  profile_without_no_nill || NullProfile
end
alias_method_chain :profile, :no_nill 
```

但是由于 alias_method_chain 已被弃用，如果您处于边缘，您将不得不自己手动完成模式......[这里的答案](https://stackoverflow.com/questions/3689736/rails-3-alias-method-chain-still-used)似乎提供了更好，更优雅的解决方案

2（答案的简化/实用版本）：

```
class User < ActiveRecord::Base
  has_one :profile
  accepts_nested_attributes_for :profile

  module ProfileNullObject
    def profile
      super || NullProfile
    end
  end
  include ProfileNullObject
end 
```

**注意：**您执行此操作的顺序（在链接的答案中解释）

* * *

根据您的尝试：

当你做了

```
def profile
  @profile || NullProfile
end 
```

它不会像预期的那样运行，因为关联是延迟加载的（除非你`:include`在搜索中告诉它），所以@profile 为零，这就是为什么你总是得到 NullProfile

```
def profile
  self.profile || NullProfile
end 
```

它会失败，因为该方法正在调用自己，所以它有点像递归方法，你得到`SystemStackError: stack level too deep`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-21T10:39:48.183

我找到了一个比在接受的答案中包含私有模块更简单的选项。

您可以覆盖 reader 方法并使用`association`from 的方法获取关联的对象`ActiveRecord`。

```
class User < ApplicationRecord
  has_one :profile

  def profile
    association(:profile).load_target || NullProfile
  end
end # class User 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-28T16:36:54.670

而不是使用 alias_method_chain，使用这个：

```
def profile
  self[:profile] || NullProfile.new
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-03T02:55:22.773

根据 Rails[文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#module-ActiveRecord::Associations::ClassMethods-label-Overriding+generated+methods)，关联方法被加载到模块中，因此覆盖它们是安全的。

所以，像...

```
def profile
  super || NullProfile.new
end 
```

应该为你工作。

# lotus-notes - “文本字段不支持关系运算符”

> ID：15121742
> 
> 赞同：1
> 
> 时间：2013-02-27T20:28:20.407
> 
> 标签：lotus-notes, lotus

我在执行 db.FTSearch（FIELD 示例字段 >= 2013 年 2 月 25 日）时收到错误消息：“文本字段中不支持关系运算符”。这里的字段名称是“examplefield”，字段类型是日期时间

任何人都可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:07:25.327

正如西蒙链接到的问题中所述，数据库中的 UNK 表将确定在进行全文搜索时用于字段的数据类型。您在任何特定表单上为该字段设置的数据类型无关紧要 - UNK 表中的字段由文档上的实际数据定义，并且不会自动重新计算自身。因此，您首先要确保它所在的每个文档中的“examplefield”都具有日期时间的数据类型。但是，您还需要重新构建 UNK 表。有两种方法 - 我知道 - 可以做到这一点：

1.  删除数据库上的全文索引，压缩数据库，然后重新创建索引。
2.  创建数据库的新副本并将现有数据库替换为副本。

此外，您可以使用免费软件 NotesPeek 工具检查 UNK 表中字段的数据类型 - 您可以从这里下载： [http ://www-01.ibm.com/support/docview.wss?uid=swg24005686](http://www-01.ibm.com/support/docview.wss?uid=swg24005686)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T03:12:53.640

一般来说，我不会使用 FTSearch。我将创建一个隐藏视图，其中第一列按示例字段排序为格式为 yyyy-mm-dd 的文本。然后，你可以使用这个：

```
set o_doc = o_hidden_view.GetDocumentByKey("2013-03-25") 
while not o_doc is nothing
    'Do something

    set o_doc = o_view.GetnextDocument(o_doc)
Wend 
```

在我看来，它有更好的时间响应，代价是把负载放在服务器上。与往常一样，这取决于您要处理的数据类型。

# nservicebus - 没有本地队列的 SendOnly 模式

> ID：15121745
> 
> 赞同：1
> 
> 时间：2013-02-27T20:28:27.957
> 
> 标签：nservicebus

在 NServiceBus 中，您可以创建一个 SendOnly 总线，这意味着它所要做的就是将消息发送到另一个服务。在我看来，这根本不需要发送服务的本地队列，但是我无法配置它。

```
var bus = Configure.With()
    .DefiningCommandsAs(t => typeof(MyNamespace.Messaging.Markers.ICommand).IsAssignableFrom(t))
    .DefaultBuilder()
    .XmlSerializer()
    .MsmqTransport()
    .UnicastBus()
    .SendOnly(); 
```

给出以下例外：

> 无法生成端点名称，请使用 Configure.DefineEndpointName(...) 指定您自己的约定

虽然我可以通过添加一个`.DefineEndpointName`似乎很糟糕的形式来为这个服务创建一个队列来解决这个问题，因为它实际上永远不会被使用。

*有没有办法避免需要为只发送总线创建本地队列，如果没有，为什么在这种模式下需要这个本地队列？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T06:36:42.823

所有端点都需要一个名称，无论它们是否仅发送。这与队列的创建无关（是的队列名称==端点名称）。添加定义端点名称，您将看到不会创建任何队列。另请注意，发送的消息将不包含对地址的回复，因为这没有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:59:29.337

我相信这是提供消息的来源。发送队列是 MSMQ 的固有部分。它允许确认消息，支持 NServiceBus bus.Reply 功能。

在这种情况下似乎没有必要，但如果我们认为 SendOnly 试图引导开发人员使用特定的消息传递样式。考虑到支持多种消息传递方式的 MSMQ，我认为这不是一个问题。

# python - 尝试编写代码以在单词列表中搜索至少有两个双字母的单词

> ID：15121748
> 
> 赞同：-3
> 
> 时间：2013-02-27T20:28:42.907
> 
> 标签：python, list

```
def three_doubles(s):
      for i in range(0, len(s)-5);
        if s[i] = s[i+1] and s[i+2] == s[i+3] and s[i+4] == s[i+5]:
          return True
       return False 
```

尝试修改此代码以搜索具有至少两个连续双字母的单词

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-27T20:53:12.227

我不明白你问的是什么。

```
l=['asd','aabb','ccddee']
for w in l:
    if len(w)>1:
        if len(w)==(2*len(set(w))):
            print w 
```

# android - 预加载 ViewPager 页面 - 因为滞后

> ID：15121749
> 
> 赞同：2
> 
> 时间：2013-02-27T20:28:44.657
> 
> 标签：android, performance, android-viewpager, fragment, swipe

这是否可以为 ViewPager 预加载片段，以便用户滑动到下一页时没有延迟？我一直在尝试两种适配器，但是从 Fragmentstatepageradapter（我正在使用片段生成 N 个页面）切换到 fragmentpageadapter 是没有用的。我有很多位图要加载到我的页面中。设置 viewpager 屏幕外页面没有帮助。有没有办法预加载它们并在背景中膨胀？我知道这是一个愚蠢的问题，但我对性能有点绝望。基本上在我的应用程序中，当用户滚动到下一页时，页面之间会有一种滞后，这很烦人......请帮助或指出正确的方向。我的目标是 Gingerbread，所以我需要使用 Android Support 提供的功能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T20:51:52.767

> 这是否可以为 ViewPager 预加载片段，以便用户滑动到下一页时没有延迟？

当然。让您的适配器预加载片段。*您*负责返回片段`getItem()`- 无论这些片段是否“预加载”都是*您的*工作。

话虽如此，您的问题很可能不是片段本身，而是片段正在做的事情。例如，您“有很多位图要加载到我的页面中”，并且如果您正在做与主应用程序线程上的那些相关的工作（例如，使用`BitmapFactory`），那么您就会造成自己的延迟。

因此，一个有才华的程序员不会急于“预加载”东西，而是会使用 Traceview 之类的工具*具体找出导致延迟的原因。*然后，也只有到那时，一个有才华的程序员才会开始着手修复。

# visual-studio-2010 - C++/CLI - 再次出现错误 C2664

> ID：15121751
> 
> 赞同：0
> 
> 时间：2013-02-27T20:28:56.927
> 
> 标签：visual-studio-2010, list, visual-c++, c++-cli, c2664

我正在处理以下问题。正式地说，我使用的是 VS2010 Ultimate，我尝试编写一个 Windows 窗体应用程序，但我得到了指定的错误：

```
 1>f:\baza danych\baza\baza\Form5.h(475): error C2664: 'Bazadanych::Dodaj1' : cannot           convert parameter 1 from 'Car' to 'Car'
1>          Cannot copy construct class 'Car' due to ambiguous copy constructors or no available copy constructor 
```

这里是 Car.h 我有这个类的声明

```
 public ref class Car
{
public:
    String^ category;
    String^ model;
    String^ rocznik;
    String^ cena;

    Car(){};
    Car(String^ ,String^ ,String^ );
    void edytuj(String^ ,String^ ,String^ );
    String^ getmodel(){return this->model;};
    String^ getrocznik(){return this->rocznik;};
    String^ getcena(){return this->cena;};
    virtual String^ getcat()
    {
        this->category="To rent";
        return this->category;
    };`
} 
```

定义：

```
 Car::Car(String^ model1,String^ rocznik1,String^ cena1)
    {
       this->model=model1;
       this->rocznik=rocznik1;
       this->cena=cena1;
    };

    void Car::edytuj(String^ model1,String^ rocznik1,String^ cena1)
    {
       this->model=model1;
       this->rocznik=rocznik1;
       this->cena=cena1;
    }; 
```

错误提到的方法的类声明是：

```
public ref class Bazadanych
{
public:
cliext::list<Car^> Bazatorent;
cliext::list<Rented^> Bazarented;
cliext::list<Unavaible^> Bazaunavaible;
cliext::list<Car^>::iterator it1;
cliext::list<Rented^>::iterator it2;
cliext::list<Unavaible^>::iterator it3;

Bazadanych()
{
    it1=Bazatorent.begin();
    it2=Bazarented.begin();
    it3=Bazaunavaible.begin();
};
bool Empty();
void Dodaj1(Car);
void Dodaj2(Rented);
void Dodaj3(Unavaible);
void Usun1(Car);
void Usun2(Rented);
void Usun3(Unavaible);
void Czysc();
}; 
```

和定义：

```
void Bazadanych::Dodaj1(Car Element)
{
this->Bazatorent.push_back(Element);
}; 
```

我在单独的 .h 和 .cpp 文件中有定义和声明。对于其他方法“Dodaj”和“Usun”我有完全相同的问题。如果它可以帮助类 Car 是类 Rented 和 Unavaible 的基类。我是 C++/CLI 的新手，所以如果有人能帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:44:57.360

考虑到它是托管类，我发现错误消息很奇怪。但是您可以通过将方法的签名更改为：

```
void Bazadanych::Dodaj1(Car^ Element) // notice the "^" 
```

其他类似方法也一样。

我猜如果没有帽子 (^)，编译器会将变量视为常规 C++ 类，因此需要一个复制构造函数，即使托管类甚至没有复制构造函数（您可以编写它们，但它们' 永远不会像常规 C++ 类那样被隐式调用）。

编辑：关于您评论中的错误：而不是像这样实例化类：

```
Car car; 
```

像这样做：

```
Car^ car = gcnew Car(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:36:40.420

它说明了它的含义：您没有`Car`. 它可能看起来像这样：

```
Car::Car(const Car& c) { 
    /* your code here*/ 
}; 
```

[这里](http://en.wikipedia.org/wiki/Copy_constructor)和[这里](http://www.cplusplus.com/articles/y8hv0pDG/)的一些背景。

# sql-server - TransactionScope/USEROPTIONS 隔离差异

> ID：15121754
> 
> 赞同：1
> 
> 时间：2013-02-27T20:29:11.247
> 
> 标签：sql-server, vb.net, transactions

如果 SQL Server 中使用的隔离级别与 System.Transactions.TransactionScope 中的隔离级别存在差异，会发生什么情况。

例如，请考虑这种情况：TransactionScope.IsolationLevel 返回 READ COMMITTED 并且 DBCC USEROPTIONS（在 SQL Studio 管理器中执行）返回 READ UNCOMMITTED。

我已经对此进行了测试，似乎 USEROPTIONS 中的设置代表其他 VB.NET 客户端能够执行 SELECT 语句（选择“脏”数据），而 VB.NET 事务范围正在进行中，如果事务范围隔离级别为 READ COMMITTED 并且 USEROPTIONS 隔离级别未提交。

我在 MSDN 中找不到任何可以证实这一点的参考资料。任何人都可以确认这是行为或指向我的 MSDN 参考吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:59:41.577

我在这里找到了答案：http: [//blog.sqlauthority.com/2010/05/24/sql-server-check-the-isolation-level-with-dbcc-useroptions](http://blog.sqlauthority.com/2010/05/24/sql-server-check-the-isolation-level-with-dbcc-useroptions)。

useroptions 命令返回当前会话的设置，即 SQL Studio 管理器会话。vb.net sqltransaction 在具有不同隔离级别的不同会话中运行。

# c# - 从 TextBox 类派生一个类

> ID：15121755
> 
> 赞同：1
> 
> 时间：2013-02-27T20:29:12.027
> 
> 标签：c#, asp.net

我试图从 TextBox 类派生一个名为 NumBox 的自定义类，并为这个类创建一个 setter 和 getter，但是当我运行我的程序时，我得到一个运行时异常“FormatException 未被用户代码处理”。在我看来，这与 this.Text 不是整数有关，但我的程序的输入是一个 int。错误发生在以下行： `return Convert.ToInt16(this.Text);`

谢谢你的帮助！

请在下面找到我的代码：default.aspx

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <glm:numbox ID="NumBox1" runat="server" Style="position: relative" />
        <asp:Button ID="Button_SquareIt" runat="server" Style="position: relative" 
            Text="Square It" onclick="Button_SquareIt_Click" />
    </div>
    </form>
</body>
</html> 
```

网络配置

```
<?xml version="1.0"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->
<configuration>
    <system.web>
        <compilation debug="true" targetFramework="4.0"/>
        <pages>
            <controls>
                <add tagPrefix="glm" namespace="GLM"/>
            </controls>
        </pages>
    </system.web>
</configuration> 
```

App_Code/NumBox.cs

```
using System;
using System.Data;
using System.Configuration;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using System.Collections.Generic;
using System.Linq;
using System.Web;

/// <summary>
/// Summary description for Class1
/// </summary>
/// 
namespace GLM
{
    public class NumBox : TextBox
    {
        public NumBox()
        {
            //
            // TODO: Add constructor logic here
            //
        }
        public int Num
        {
            set
            {
                this.Text = value.ToString();
            }
            get
            {
                return Convert.ToInt16(this.Text);
            }
        }
    }
} 
```

默认.aspx.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page
{
    GLM.NumBox n = new GLM.NumBox();
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void Button_SquareIt_Click(object sender, EventArgs e)
    {
       n.Num = n.Num *  n.Num;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:42:23.920

好的，我已经对此进行了更详细的研究，并找到了问题的原因。

您创建一个新的 NumBox 实例，然后对其执行操作。您不是指在页面上创建的实例。

如果您没有关联的 Designer.cs 文件，那么这应该可以工作：

```
public partial class _Default : System.Web.UI.Page
{
    GLM.NumBox NumBox1;
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void Button_SquareIt_Click(object sender, EventArgs e)
    {
       NumBox1.Num = NumBox1.Num *  NumBox1.Num;
    }
} 
```

如果您确实有关联的 Designer.cs 文件，则删除 NumBox1 的声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:34:16.800

尝试以下操作：

```
 public int Num {
        set {
            this.Text = value.ToString();
        }
        get {
            return Int16.Parse(this.Text);
        }
    } 
```

我建议使用该`TryParse`方法来确保您只尝试解析实际数字。请注意，如果您的`Text`property `IsNullOrEmpty`、 Parse 和 TryParse 将引发异常。您应该测试一个空值，如果为空，则返回 a`0`或让您的属性返回`Nullable<int>`。

此外，您*应该*解析为您返回的类型。`int`解析时您的属性返回`Int16`。

# azure - Azure 模拟器缓存

> ID：15121757
> 
> 赞同：1
> 
> 时间：2013-02-27T20:29:22.010
> 
> 标签：azure, azure-compute-emulator

使用 azure 模拟器在本地运行 Web 角色时遇到问题。它无限期挂起，我看到的唯一错误是在**Application Server-Applications/Operational**事件日志中。我检查了所有 DLL 和 SDK 的版本。

有时我会看到 ErrorCode ERRCA0009 :SubStatus ES0001 或请求超时。

Windows 8 上的 Azure SDK 1.8.1 VS2012。

```
Handling an exception. Exception details: System.NullReferenceException: 
Object reference not set to an instance of an object.
at Microsoft.Windows.Azure.DevFabric.DevFabricManagement.GetTenantDetails
(String tenantName)
at SyncInvokeGetTenantDetails(Object , Object[] , Object[] )
at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke
(Object instance, Object[] inputs, Object[]& outputs)
at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc& rpc)
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5
(MessageRpc& rpc)
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31
(MessageRpc& rpc)
at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet) 
```

# mongodb - 使用 MongoDB $pull 删除数组中的文档

> ID：15121758
> 
> 赞同：23
> 
> 时间：2013-02-27T20:29:22.493
> 
> 标签：mongodb, pull

我在 MongoDB 中有一个集合，如下所示：

```
{
    "_id" : "5327010328645530500",
    "members" : [
        {
            "participationCoeff" : 1,
            "tweetID" : "5327010328645530500"
        },
        {
            "participationCoeff" : 1,
            "tweetID" : "2820402625046999289"
        },
        {
            "participationCoeff" : 0.6666666666666666,
            "tweetID" : "6122060484520699114"
        },
        {
            "participationCoeff" : 1,
            "tweetID" : "4656669980325872747"
        }
    ]
}
{
    "_id" : "2646953848367646922",
    "members" : [
        {
            "participationCoeff" : 1,
            "tweetID" : "2646953848367646922"
        },
        {
            "participationCoeff" : 0.75,
            "tweetID" : "7750833069621794130"
        },
        {
            "participationCoeff" : 0.5,
            "tweetID" : "6271782334664128453"
        }
    ]
} 
```

基本上，集合有集群，其中一个集群有一个`_id`字段和一个`members`字段。成员字段是一个文档数组，具有以下格式。

```
{
            "participationCoeff" : 1,
            "tweetID" : "5327010328645530500"
        } 
```

现在，有时，我必须通过匹配 tweetID 来删除集群文档的 members 属性中的这些子文档。

但是，我无法找到实现此效果的查询。基本上，一个 tweetID 将参与许多集群，因此将出现在各个集群的“成员”属性的多个子文档中。我想提供一个批量 $pull 操作，我可以在其中删除与特定 tweetID 匹配的所有集群（即它们的成员属性）中的所有子文档。

一些帮助和直觉将非常有帮助。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-27T20:44:24.837

这正是`$pull`操作员所做的，因此在 shell 中您可以使用`update`类似：

```
db.clusters.update({}, 
    {$pull: {members: {tweetID: '5327010328645530500'}}}, 
    {multi: true}) 
```

设置`multi`选项以便更新每个文档，而不仅仅是第一个文档。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-09-13T08:01:05.230

这将在单个查询中删除`multiple tweets`，只需将数组传递给`$in`：-

```
db.clusters.update({}, 
{$pull: {members: {$in: [ {tweetID: '5327010328645530500'},{"tweetID" : "2820402625046999289"} ] } } }, 
{multi: true}); 
```

上述方法在猫鼬中不起作用，所以对于猫鼬来说：-

```
 db.clusters.update({}, 
{$pull: {members:[ {tweetID: '5327010328645530500'},{"tweetID" : "2820402625046999289"} ]  } }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-06-14T12:14:09.473

与此同时，更新方法已被弃用。因此，一种可能的最新解决方案是使用 updateMany 方法。

```
db.clusters.updateMany({}, 
    {$pull: {members: {tweetID: '5327010328645530500'}}}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-22T21:07:30.393

> 注意：用于`"mongoose": "^5.12.13"`.

至于今天 2021 年 6 月 22 日，您可以使用`$in`mongodb`$pull`运算符从文档数组中删除项目：

**父文件：**

```
{
    "name": "June Grocery",
    "description": "Remember to pick Ephraim's favorit milk",
    "createdDate": "2021-06-09T20:17:29.029Z",
    "_id": "60c5f64f0041190ad312b419",
    "items": [],
    "budget": 1500,
    "owner": "60a97ea7c4d629866c1d99d1",
} 
```

**Items 数组中的文档：**

```
{
    "category": "Fruits",
    "bought": false,
    "id": "60ada26be8bdbf195887acc1",
    "name": "Kiwi",
    "price": 0,
    "quantity": 1
},
{
    "category": "Toiletry",
    "bought": false,
    "id": "60b92dd67ae0934c8dfce126",
    "name": "Toilet Paper",
    "price": 0,
    "quantity": 1
},
{
    "category": "Toiletry",
    "bought": false,
    "id": "60b92fe97ae0934c8dfce127",
    "name": "Toothpaste",
    "price": 0,
    "quantity": 1
},
{
    "category": "Toiletry",
    "bought": false,
    "id": "60b92ffb7ae0934c8dfce128",
    "name": "Mouthwash",
    "price": 0,
    "quantity": 1
},
{
    "category": "Toiletry",
    "bought": false,
    "id": "60b931fa7ae0934c8dfce12d",
    "name": "Body Soap",
    "price": 0,
    "quantity": 1
},
{
    "category": "Fruit",
    "bought": false,
    "id": "60b9300c7ae0934c8dfce129",
    "name": "Banana",
    "price": 0,
    "quantity": 1
},
{
    "category": "Vegetable",
    "bought": false,
    "id": "60b930347ae0934c8dfce12a",
    "name": "Sombe",
    "price": 0,
    "quantity": 1
}, 
```

**询问 ：**

```
MyModel.updateMany(
    { _id: yourDocumentId },
    { $pull: { items: { id: { $in: itemIds } } } },
    { multi: true }
); 
```

**注意**：ItemIds 是一个数组`ObjectId`。见下文 ：

```
[
  '60ada26be8bdbf195887acc1',
  '60b930347ae0934c8dfce12a',
  '60b9300c7ae0934c8dfce129'
] 
```

# powershell - Powershell - 根据数组中的选定对象导出为 CSV

> ID：15121759
> 
> 赞同：1
> 
> 时间：2013-02-27T20:29:29.533
> 
> 标签：powershell

对不起这个奇怪的标题，我不知道如何表达这个问题。我对 Powershell 比较陌生，我正在编写一个程序。基本上，我有一个数组，用户在其中选择了设置或希望从存储在“$settings_array”中的 GWMI 查询中“选择”。我想将结果输出到 CSV。当我尝试运行它时，只有第一个 Select 语句会输出到 CSV。输出到文本框工作正常。我知道这与它在每次迭代时如何存储在数组中有关。$resultList 被初始化为一个数组 ($resultList = @())。表单和其他功能有数百行代码，但这里是相关代码。谢谢您的帮助！如果我需要发布更多代码，请告诉我。

```
$colItems = GWMI Win32_NetworkAdapterConfiguration -computername $PCname -namespace "root\CimV2" -filter "IpEnabled = TRUE"
ForEach ($objItem in $colItems)
{ 
    ForEach ($objItem2 in $settings_array)
    {
        $resultList += $objItem  | Select $objItem2
        $richTextBox1.Appendtext("$objItem2" + ": " + $objItem.$objItem2 + "`r`n")
        $richtextbox1.ScrollToCaret()
    }
}
$resultList | export-csv "$ScriptDir\Exports\$Outputfile" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:49:29.560

CSV 由行和列组成。您导出的数组中的每个对象都获得一行，每个对象获得每个属性的列值。您每次都使用一个属性向结果列表添加一个新记录/对象（每个对象只有一个属性）。您只得到第一个的原因是您的记录包含不同的属性名称。为了解决这个“非静态属性名”问题，powershell 将第一个对象的属性作为 csv 文件的模板。由于 object2、object3 等不包含相同的属性，因此它们将为空白。但是，当您击中与第一个对象具有相同属性的另一个对象时，该值也将包括在内。前任。您将获得所有网络适配器的 Name 属性，但其余部分为空白值。

您的样本缺少信息，例如。是如何`$settings_array`建造的。如果它是一个普通的字符串数组，例如：

```
$settings_array = "Name", "DisplayName", "Test" 
```

或者

```
$settings_array = @("Name", "DisplayName", "Test") 
```

然后你可以将整个数组传递给`select`.

```
$colItems = GWMI Win32_NetworkAdapterConfiguration -computername $PCname  -namespace "root\CimV2" -filter "IpEnabled = TRUE"
ForEach ($objItem in $colItems)
{ 
    #Write to screen
    ForEach ($objItem2 in $settings_array)
    {
        $richTextBox1.Appendtext("$objItem2" + ": " + $objItem.$objItem2 + "`r`n")
        $richtextbox1.ScrollToCaret()
    }
}
#Save to CSV
$colItems | Select-Object -Property $settings_array | export-csv "$ScriptDir\Exports\$Outputfile" 
```

注意最后一行。现在，foreach 循环仅用于您的文本框内容，而最后一行按应有的方式格式化 CSV。

**编辑**试试这个来获得你的设置：

```
Function GetSettings { 
    $out = @()
    Foreach ($objItem in $chklstGetMIPRet.CheckedItems) {
        $out += $objItem.ToString()
    } 
    $out
}
$settings_array = GetSettings 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-08T09:49:06.850

只是一个简单的提示：您可以使用 export-clixml 以 XML 格式导出，无论列数是多少，它们都会添加到文件中。

# ajax - 一个简单的 web 应用程序背后的基本框架，在哪里使用什么

> ID：15121762
> 
> 赞同：1
> 
> 时间：2013-02-27T20:29:32.777
> 
> 标签：ajax, web-applications, animation

好的，所以我有 html、css、javascript 的基本技能。

我仍处于学习阶段，但在创建 Web 应用程序方面需要一些帮助。我可以找出所有的代码，所以这很好，我只需要一些关于在哪里使用什么的指针。

所以基本上我有一个带有几个简单按钮的网页，当点击它们时，它们会向服务器发送一条消息，服务器将使用 php 脚本为每个点击的按钮进行计数。

1) - 最好将这些信息保存在 JSON 文件中吗？

然后从那里，会有另一个网页，其 div 标签在页面上伸展 100%，其中有一个元素将根据服务器上保存的计数在页面上移动。

2) - 我应该用什么来动画它移动？我会使用javascript吗？还是css3什么的？

前端将需要不断更新服务器持有的计数。

3) - AJAX 方法最好使用 javascript 吗？

任何建议都会非常感谢。

最后一件事。使用 Javascript 动画，如果我想动画 div 水平移动，最好的方法是通过动画边距大小来做到这一点？还是我被困在黑暗的日子里..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:37:55.020

1：我会将其存储在数据库中，如果将其存储在文件中，请确保以安全的方式处理写入（多次写入同一个文件）

2：您可以使用 javascript 为 html 元素的 css 属性设置动画（最好是宽度）

3：Ajax 可以工作，但您需要不断轮询服务器以获取更改，或者使用 longpoling [http://en.wikipedia.org/wiki/Push_technology#Long_polling](http://en.wikipedia.org/wiki/Push_technology#Long_polling)

如果您只支持现代浏览器并且您的托管公司允许，另一种选择是使用 websockets

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:34:14.783

1.  如果您尝试保存信息服务器端（您似乎是），我建议使用数据库（例如 MySQL）。

2.  如果您的动画依赖于服务器的值，我会使用 javascript 对其进行动画处理。请注意，您必须轮询服务器才能实际获取此信息（比如说，每秒）。获取信息后，只需使用新信息更新要设置动画的 div。我不太明白你希望你的显示器是什么样子，所以我不能在这里给你更具体的东西。

3.  是的。我建议使用 jQuery 来处理您的 AJAX 调用，因为它更容易处理跨浏览器的怪异问题。

To your update: One option could definately be to adjust the (left) margin size, but you could also use the relative position. It will basically push the element however many pixels in whatever position from where it would typically be displayed. So if your box is by default right along the left border, you could relatively position it 100px to the right. You can read more about position [here](http://css-tricks.com/absolute-relative-fixed-positioining-how-do-they-differ/).

# android - 在cordova插件中获取上下文

> ID：15121767
> 
> 赞同：4
> 
> 时间：2013-02-27T20:29:58.583
> 
> 标签：android, cordova, google-cloud-messaging

嗨，我正在使用[这个](https://github.com/marknutter/GCM-Cordova)用于 android 的 GCM 通知插件并且工作得几乎完美，我遇到的唯一问题是当用户强制关闭我的应用程序或设备关闭时通知服务停止工作。

我查看了插件代码问题并意识到以下功能导致了问题。

```
 public static void sendJavascript( JSONObject _json )
      {
        String _d =  "javascript:"+gECB+"(" + _json.toString() + ")";
            Log.v(ME + ":sendJavascript", _d);

            if (gECB != null ) {
              gwebView.sendJavascript( _d );
            }
} 
```

当设备关闭再打开或应用程序被强制关闭时，gwebView 引用会丢失。如果我尝试使用 gwebView.sendJavascript( _d ) 方法，我会得到一个空指针异常。

查看插件代码，我注意到在注册设备时引用了 gwebView，正如以下代码所示：

```
public static Plugin gwebView;
  private static String gECB;
  private static String gSenderID;

  @SuppressWarnings("deprecation")
@Override
  public PluginResult execute(String action, JSONArray data, String callbackId)
  {

    PluginResult result = null;

    Log.v(ME + ":execute", "action=" + action);

    if (REGISTER.equals(action)) {

      Log.v(ME + ":execute", "data=" + data.toString());

      try {

        JSONObject jo= new JSONObject(data.toString().substring(1, data.toString().length()-1));

        gwebView = this;

..............................More code here...................... 
```

通知是在后台收到的，但我不能调用任何 javascript 方法，因为 gwebView 什么都没有。

我的方法是每当 gwebView 有一个空指针时在状态栏上显示一个通用通知，但我只是不知道如何获取应用程序或 cordova 上下文以使用此功能。

任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T04:40:33.837

我在谷歌论坛发现这是插件的一个错误，所以我决定使用 Pushwhoosh 通知服务。

# android - Activity 转换上的 Android Ghost 布局

> ID：15121769
> 
> 赞同：2
> 
> 时间：2013-02-27T20:30:03.153
> 
> 标签：android, android-activity, transition

我今天注意到一些奇怪的事情，我不确定描述它的最佳方式。

我有两个活动（A 和 B）。我在 A 上并开始为 B 制定新的意图。我将挂起的转换覆盖为缓慢向上滑动。这部分很好。

当 B 向上滑动时，我注意到我仍然可以点击 B 按钮所在的屏幕**并**使用它们的动作。（例如，有一个关闭按钮可以关闭 B。当我点击它的目标区域时，它会关闭 B，即使它还没有完全上升）。

我目前的解决方案是禁用所有按钮，直到动画完成。这工作正常，但是我很想知道是否有更好（更标准）的解决方案。如果有人可以解释（并证实我的怀疑），那将是一个很好的加分！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-26T20:25:38.563

这是预期的行为。Android 只是简单地为过渡设置动画，而不是实际将视图从一个物理位置移动到另一个物理位置。

# match - 如何计算两组数据的匹配数

> ID：15121771
> 
> 赞同：0
> 
> 时间：2013-02-27T20:30:08.353
> 
> 标签：match, outer-join

我正在使用 Microsoft SQL Server。我有两个表，t1 和 t2，每个表都包含以下一组变量：PatientID、AdmissionDate、DiagnosisCode。请注意，住院期间的多个诊断显示为多行。每个表显示不同的患者列表。这些表很大，因此解决方案必须高效（400,000 行）。我想计算表 1 中的患者与表 2 中的患者的相似度。相似度定义为两个患者共享的诊断数量除以以下总和：

.8*（表 1 中与表 2 中患者不匹配的患者的诊断数量）+ .2*（表 2 中与表 1 中患者不匹配的患者的诊断数量）+（数量两名患者共享的诊断）

任何有关如何组织此问题的建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:49:37.633

这是我解决这个问题的尝试，我希望其他人能找到更有效的方法：

```
select #t1.id1, #t1.adm1, #t1.dx1, #t2.id2, #t2.adm2, #t2.dx2, iif(#t1.dx1=#t2.dx2,1,0) as shared Into #t3 From #t1 cross join #t2
Select id1, adm1, dx1, id2, adm2, sum(shared) as In1In2, iif(sum(shared)=0,1,0) as In1Not2 into #t4 from #t3 group by id1, adm1, dx1, id2, adm2 
Select id1, adm1, dx1, id2, adm2, sum(In1Not2) as nIn1Not2, into #t5 from #t4 group by id1, adm1, id2, adm2 
Select id1, adm1, dx2, id2, adm2, iif(sum(shared)=0,1,0) as In2Not1 into #t6 from #t3 group by id1, adm1, dx2, id2, adm2 
Select id1, adm1, id2, adm2, sum(In2Not1) as nIn2Not1 into #t7 from #t6 group by id1, adm1, id2, adm2 
```

在下一步中，计算的值被合并到一个公用表中。此尝试的问题在于，在 100,000 条记录的 t1 和 400,000 条记录的 t2 上运行它需要 2 多个小时。

# xml - 如何将 XSL 嵌入 XML

> ID：15121773
> 
> 赞同：2
> 
> 时间：2013-02-27T20:30:12.523
> 
> 标签：xml, xslt

我正在寻找一种将 XSL 嵌入 XML 的解决方案，因此只有 1 个 XML 文件发送到浏览器。我在这里尝试了 Dimitre Novatchev 提出的解决方案：[Embed xsl into an XML file](https://stackoverflow.com/questions/360628/embed-xsl-into-an-xml-file/15121012#15121012)

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> <xsl:output omit-xml-declaration="yes"/>    <xsl:variable name="vEmbDoc">
    <doc>
        <head></head>
        <body>
            <para id="foo">Hello I am foo</para>
        </body>
    </doc>
</xsl:variable>
<xsl:template match="para">
  <h1><xsl:value-of select="."/></h1>
</xsl:template>
<xsl:template match="xsl:template"/></xsl:stylesheet> 
```

问题是，使用这个解决方案我找不到在头部包含样式元素的方法。似乎在建议的解决方案中，head 和 body 标签没有任何效果，因为浏览器会在解析期间自动添加它们，即使没有包含这些标签，该解决方案也能正常工作。

所以问题是：如何在上述解决方案的头部包含样式元素，如下所示：

```
<head><style>body {font-size:10pt;padding:20pt} </style></head> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T05:38:13.120

**此 XML 文档**：

```
<?xml-stylesheet type="text/xsl" href="myEmbedded.xml"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 exclude-result-prefixes="xsl">
 <xsl:output omit-xml-declaration="yes"/>
    <xsl:variable name="vEmbDoc">
        <doc>
            <head>
              <style>body {font-size:10pt;padding:20pt}</style>
              </head>
            <body>
                <para id="foo">Hello I am foo</para>
            </body>
        </doc>
    </xsl:variable>
    <xsl:template match="para">
      <h1><xsl:value-of select="."/></h1>
    </xsl:template>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="doc">
  <html>
   <xsl:apply-templates/>
  </html>
 </xsl:template>

    <xsl:template match="xsl:template"/>

    <xsl:template match="xsl:*">
      <xsl:apply-templates/>
    </xsl:template>
</xsl:stylesheet> 
```

**包含一个 XSLT 样式表。起始 PI 指示浏览器在其自身上应用此样式表**。

**如此指定的转换会产生想要的结果**：

```
 <html>

   <head xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

              <style>body {font-size:10pt;padding:20pt}</style>
              </head>

   <body xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

      <h1>Hello I am foo</h1>

   </body>

</html> 
```

# android - 没有自己的 api 密钥的 Android 用户如何查看 Google 地图

> ID：15121778
> 
> 赞同：1
> 
> 时间：2013-02-27T20:30:38.647
> 
> 标签：android, google-maps, testing, api-key

我正在一个团队尝试制作一个使用 Google 地图的 Android 应用程序。我们每个人都注册了自己的地图 api 密钥（调试，版本 1）。几乎任何时候个人在 Eclipse 中工作，我们都必须将我们的 api 密钥重新粘贴到 xml 文件中，否则我们只会得到灰色网格。

我们一直在处理这个问题，但我们需要能够与没有地图 api 的用户一起测试它。

解决方案是什么？我进行了搜索，但没有看到我能理解的解决方案。我是 Android 新手，所以请像我智障一样跟我说话。

有些人发布的答案都是针对网络应用程序的。我没有要在 Android 中编辑的 CSS 文件。此外，如果您指向一个页面并且上面有 4-6 个不同的“解决方案”，我不知道您指的是哪个。同样正如我提到的，我们使用的是版本 1。由于与此问题无关的原因，我们无法切换。谢谢你。

# excel - 使用 VBA 显示单元格的评论，其中评论是活跃的彭博公式

> ID：15121781
> 
> 赞同：0
> 
> 时间：2013-02-27T20:30:44.193
> 
> 标签：excel, vba, bloomberg

我正在尝试在 excel 中创建一个“评论”，它将显示突出显示的任何单元格的 Bloomberg BDP 信息。例如，假设 active.cell = IBM 并且我“悬停”在 IBM 上。我希望弹出一个评论框，显示相关的市场数据。

```
$bid = "=BDP(active.cell &" US EQUITY","BID_ALL_SESSION")"
$bidsize = "=BDP(active.cell &" US EQUITY","BID_SIZE_ALL_SESSIONS_RT")"
$ask = "=BDP(active.cell &" US EQUITY","ASK_ALL_SESSION")"
$asksize = "=BDP(active.cell &" US EQUITY","ASK_SIZE_ALL_SESSIONS_RT")"
$last = "=BDP(active.cell &" US EQUITY","LAST_ALL_SESSIONS")"
$lastsize = "=BDP(active.cell &" US EQUITY","TRADE_SIZE_ALL_SESSION_RT")" 
```

在 'blah' 我想要 ($bidsize $bid $ask $asksize $last $lastsize)

我开始偷看，在下面发现了一些东西，但不知道如何实现。有任何想法吗？

```
Sub add-comments()

Dim rcell As Range

For Each rcell In Range("B2:B48")

If rcell.Value <> "" Then
rcell.AddComment

rcell.Comment.Text 'blah'
End If
Next
End Sub 
```

感谢观看

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-20T16:40:54.143

单元格注释框中的注释是字符串和静态的。它不能以与公式相同的方式工作，因此它不能“活”。据我所知，如果你想实现你的想法，你可以在这个工作表中添加一个 namerange 控件。它具有选择事件，因此当用户选择一个单元格时，您可以根据单元格中的公式添加注释。

# php - 多个控制器/模型的案例？

> ID：15121784
> 
> 赞同：2
> 
> 时间：2013-02-27T20:31:22.290
> 
> 标签：php, model-view-controller

我正在构建一个监控应用程序。我有几个类别，每个类别都有几个监视器。监视器的一个示例是 CPU 使用情况图。

我的问题是关于建筑的。我正在尝试实施 MVC 以使项目的未来扩展变得简单，但我陷入了两难境地。要么我

1.  每个监视器有一个单独的控制器和模型，或者
2.  有一个`MonitorController`对象和一个`MonitorModel`对象，每个监视器有一个方法

#1 的缺点是

*   我将不得不单独定义每条路线
*   我将为每条路由实例化不同的控制器，每个路由基本上只有一个任务要执行：调用模型的`getData()`方法。从本质上讲，到目前为止，我已经能够`/{category}/{monitor}`为所有显示器使用一条路由，而且简单性很好。

#2的缺点是

*   不灵活
*   该`MonitorModel`对象将变得巨大且无法维护，因为每个图表的`getData()`方法可能非常复杂，跨越数十条线。

这里的正确方法是什么？

（顺便说一句，我正在使用 PHP。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:34:22.237

模型的第一条规则是使它们尽可能简单。将这几十行逻辑放到另一个项目中，并在你的 mvc 项目中引用它。将您的 MVC 应用程序视为您的 UI，所有“业务逻辑”都应保存在一个项目中，该项目完全不知道它最终将如何显示。

这样做会很清楚，您可能应该有一个`Monitors`带有`Data`方法的控制器，该方法需要一些说明符来显示哪个监视器并为该监视器生成一个视图。那将是最直接的 MVC 方式。

现在处理多种不同类型的显示器！一套`DisplayTemplates`显示每种不同类型的句柄是要走的路。你的观点`Data`基本上变成了`@Html.DisplayFor(x => x)`. [关于使用的强制性 msdn 链接`DisplayTemplates`。](http://msdn.microsoft.com/en-us/library/ee308450%28v=vs.98%29.aspx)

请注意，始终将简单的 DTO 传递给您的视图。越简单越好，从长远来看，这将使您的生活更轻松。

现在，您将拥有一个干净利落的应用程序，当事情发生变化时，不同的部分不会互相践踏太多。

# android - 当活动在前台时如何保持屏幕开启？

> ID：15121791
> 
> 赞同：0
> 
> 时间：2013-02-27T20:31:44.540
> 
> 标签：android

当我的活动在前台时，我需要保持屏幕打开。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:33:23.400

您可能想使用:`keepScreenOn`和`setKeepScreenOn()`.

请看这个[链接](http://commonsware.com/blog/2013/01/22/letting-device-sleep-intelligently.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:33:29.753

获取[唤醒锁](http://developer.android.com/reference/android/os/PowerManager.WakeLock.html)或添加`android:keepScreenOn="true"`到该活动中使用的任何视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:33:59.907

只需在 onCreate() 方法中添加这一行：

```
getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:34:15.757

确保其内容具有已将其`keepScreenOn`字段/属性设置为的视图`true`。

# javascript - 使用计时器插件的 jQuery 幻灯片 - 如何更改幻灯片？

> ID：15121795
> 
> 赞同：0
> 
> 时间：2013-02-27T20:32:04.293
> 
> 标签：javascript, jquery, jquery-plugins

我正在制作一个 jQuery 滑块（如此陈词滥调），当您单击控件中的一个项目符号时，我在更改幻灯片时遇到了问题。除此之外，它功能齐全。我找到了 jQuery 计时器插件，并用我正在使用的 'setInterval()' 函数将其换掉。

所以，问题，当您单击控件中的项目符号时，我似乎无法弄清楚如何让幻灯片发生变化...我尝试将单击的项目符号值（幻灯片＃）传递给计时器函数，但没有t 工作（我这样做的方式）。我不太了解方法或 jQuery 插件格式，所以这对我来说很困难。

**我的服务器** 上的链接***（工作）***： http: [//www.horsepowerfreaks.com/plugins/responsiveSlider/demo.html](http://www.horsepowerfreaks.com/plugins/responsiveSlider/demo.html)

这是**jsFiddle** *（由于某种原因无法正常工作......）*：http: [//jsfiddle.net/derekfoulk/yUqKJ/](http://jsfiddle.net/derekfoulk/yUqKJ/)

***文件：***

**滑块插件**（问题所在） [http://www.horsepowerfreaks.com/plugins/responsiveSlider/rSlider.jquery.js](http://www.horsepowerfreaks.com/plugins/responsiveSlider/rSlider.jquery.js)

**样式表** [http://www.horsepowerfreaks.com/plugins/responsiveSlider/style.css](http://www.horsepowerfreaks.com/plugins/responsiveSlider/style.css)

**插件文档/演示：** [https ://github.com/jchavannes/jquery-timer](https://github.com/jchavannes/jquery-timer) [http://jchavannes.com/jquery-timer/demo](http://jchavannes.com/jquery-timer/demo)

**我尝试的一部分：**

```
/* Bullets - Here is my problem. This is not working the way I need it to.
Basically, when the user clicks a bullet, the slider should make the referenced
slide active and then reset the timer */

else if (action === "bullet"){
    // If user clicks on active bullet
    if ($(this).hasClass("active")){
        // Play/Pause (timer)
        Slider.toggleGallery();
    }
    else {
        /* Change slide (by referencing the 'data-slide' attribute of the bullet,
        then find the slide using that same value for its 'data-slide' attribute
        and make it the active slide and reset the timer */
        imageId = $(this).attr("data-slide");
        $(".active",$controls).removeClass("active");
        $(this).addClass("active");
        Slider.changeSlide(imageId);
    }
} 
```

***...进一步向下文件...***

```
Slider = new (function() {
    var $galleryImages,
    $timeRemaining,
    incrementTime = options.pause,

    /* I am pretty sure this function needs to be fed the slide number that was selected
    when the user clicks a bullet. If it is the first run through, then the value of
    'imageId' should be '-1'. I would rather have the imageId value be set to '1'
    initially, but the configuration below is what worked for me... If I set the imageId
    to '0', numSlides to '$galleryImages.length' and the imageId inside the if statement
    to 0, then I get slide 2 for imageId 1, slide 3 for imageId 2, slide 4 for imageId 3,
    and slide 1 for imageId 4? If there is a way to have the active image (imageId)
    iterate '1,2,3,4' instead of '0,1,2,3' that would be awesome. */

    imageId = -1, // Which image is being shown
    updateTimer = function() {
        $galleryImages.eq(imageId).stop(true,true).removeClass("active");
        imageId++;
        console.log(imageId);
        var numSlides = $galleryImages.length - 1;
        if (imageId >= numSlides) {
            imageId = -1;
        }
        $galleryImages.eq(imageId).stop(true,false).addClass("active");
    },

    init = function() {
        $galleryImages = $(".slider").find('li');
        Slider.Timer = $.timer(updateTimer, incrementTime, true).once();
    };
    this.toggleGallery = function() {
        if (this.Timer.isActive) {
            this.Timer.pause();
            var remaining = this.Timer.remaining / 1000;
        }
        else {
            this.Timer.play();
        }
    };
    $(init);
}); 
```

# php - MySQL 查询。如何先提取特定条目，然后显示其余条目？

> ID：15121797
> 
> 赞同：0
> 
> 时间：2013-02-27T20:32:04.510
> 
> 标签：php, mysql

我正在提取整张表的数据。里面的东西真的不重要。

```
SELECT entry_id, title 
FROM tablename 
WHERE this = 'that' 
    AND something = 'foobar' 
ORDER BY title ASC 
```

如您所见，我在 asc 中按标题排序，这正是我所需要的。但是，我想显示的第一个条目不是以 A 或 0 开头，实际上我不知道条目标题是什么，我动态地计算出来。

所以我的问题是我怎样才能先取出那 1 个条目，而不是显示其余的结果而不必运行 2 个 mysql 查询。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:33:59.177

您可以使用 a`case`先放 1 个项目

```
SELECT entry_id, title 
FROM tablename 
WHERE this = 'that' AND something = 'foobar' 
ORDER BY case when title = 'some_title' 
              then 1
              else 2 
         end, title ASC 
```

# macros - Clojure - 宏中的 let 不起作用

> ID：15121799
> 
> 赞同：4
> 
> 时间：2013-02-27T20:32:13.340
> 
> 标签：macros, clojure, let

我创建了一个宏，它创建了一个`dispatcher`带有 3 个关联函数的命名`get-dispatcher`，`set-dispatcher`并`call-dispatcher`与调度程序一起工作（他们得到一个调度函数，添加一个或调用一个）。一切正常！但是，现在我想自动创建相关的函数名称，因此我将宏的所有这些内部结构放入`let`定义该简单构造函数的 a 中。请注意，在下面的代码中，只有`get-`函数的名称是使用该自动化构造的。`set-`and one的`call-`名称创建仍然具有手动气味。

```
(defmacro create-dispatcher [name]
  ;creates a set of dispatching functions tagged

  `(do
    ;define dispatcher
    (def ~(symbol name) ~(atom {}))

    (let
      [name-w-prefix (fn [x] (~(symbol (str x "-" name))))]
        ; -- define getter
        (defn (name-w-prefix "get")
          "get-dispatcher [tag]: get a dispatcher fn by tag"
          (~'[] (println "no tag is provided for '" ~(str name) "' dispatcher"))
          (~'[tag]
            (do
              (println "dispatcher '" ~(str name) "' called with '" ~'tag "' tag")
              ; return the tagged dispatcher
              ( (keyword ~'tag) @~(symbol name) )))

        )
        ; -- define caller
        (defn ~(symbol (str "call-" name))
          "get-dispatcher [tag & args]: call a dispatcher fn by tag and apply to the args"
          ~'[tag & args]
          (apply (~(symbol (str "get-" name)) ~'tag) ~'args)
          )
        ; -- define setter
        (defn ~(symbol (str "set-" name))
          ~'[tag fn]
          "add-dispatcher [tag fn]: add a dispatcher fn associated with the tag"
          (swap! ~(symbol name) assoc (keyword ~'tag) ~'fn)
          )
     )

    ; -- report
    (println "created dispatcher set for '" ~(str name) "' ok!")
    )) 
```

但是，有一个问题。语句绑定`name-w-prefix`中的会导致错误。`let`我该如何解决？

（也欢迎任何关于改进的建议，因为我是新手，这几乎是我在 Clojure 中写的第一件事）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T21:06:29.020

宏中的所有符号都在当前命名空间中解析，并期望评估为 var。您可以引用该`name-w-prefix`符号，但这可能会与宏扩展期间传入宏的符号发生冲突。因此，Clojure 提供了一种特殊的语法，用于以语法引用形式生成符号——只需`#`在符号末尾附加 a，Clojure 就会将其视为带引号的自动生成符号。因此，在这种情况下，将出现的替换为`name-w-prefix`with`name-w-prefix#`就可以了。

退一步看看你的总体目标是什么，我认为你应该将`name-w-prefix`定义移到语法引号*之外*，然后使用 syntax-escape 来调用它。否则，你会得到更多的错误，因为`defn`需要一个符号，所以一旦扩展宏必须生成一个`defn`具有符号作为其第二项的表单。类似于以下内容：

```
(defmacro create-dispatcher [name]
  (let [name-w-prefix #(symbol (str % "-" name))]
    `(do
       (def ~(symbol name) (atom {}))
       (defn ~(name-w-prefix "get")
         ([] (println "no tag provided"))
         ([tag#] (println "called with tag" tag#)))))) 
```

请注意，我已根据我上面所说的内容更改`~'[tag]`为`[tag#]`in 。`defn`

# php - js计数器不显示在php中

> ID：15121806
> 
> 赞同：0
> 
> 时间：2013-02-27T20:32:32.763
> 
> 标签：php, javascript, counter

我不明白为什么我没有看到 div 中显示的每个数字。

我的代码...

```
<head>
    <script>
        function countit(i)
        {
            document.getElementById('counter').innerHTML = i;
        }
    </script>
</head>
<body>

<div id="counter"></div>

<script>countit(1)</script>
<?php sleep(1); ?>
<script>countit(2)</script>
<?php sleep(1); ?>
<script>countit(3)</script>

</body> 
```

我有一个 php 脚本，它处理数据库中的多条记录，我想显示正在处理的当前记录的计数器。我认为JS是做到这一点的方法。我看到了与上面推荐的代码非常相似的东西。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:35:23.357

PHP 缓冲输出并且在它完成运行之前不发送页面。睡眠不会在脚本元素的执行之间运行。

改写你的逻辑以使用[JavaScript`setInterval`](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)。

或者，在 PHP 脚本中[禁用或避免输出缓冲](https://stackoverflow.com/questions/8882383/how-to-disable-output-buffering-in-php)，但请注意，这可能会影响浏览器缓存页面的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:36:26.877

问题是您的 php 代码在您的服务器上执行，而您需要在客户端 (JavaScript) 上执行代码才能使其工作：

```
<script>
  var idx = 1;
  var doCount= function(){
      if(idx >= 3) return;
      countit(idx);
      setTimeout(doCount,1000);         
  };
  doCount();

</script> 
```

删除以下内容：

```
<?php sleep(1); ?>
<script>countit(2)</script>
<?php sleep(1); ?>
<script>countit(3)</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:37:02.733

PHP是服务器端语言，而Javascript是客户端语言。我猜你只是`3`在你的`counter`div中看到。原因是 PHP`sleep(1)`在页面渲染之前就已经发生了。您需要`setInterval`在 Javascript 中使用 a 来完成您正在尝试做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:46:17.867

您的代码等待 2 秒，浏览器收到：

```
<head>
    <script>
        function countit(i)
        {
            document.getElementById('counter').innerHTML = i;
        }
    </script>
</head>
<body>

<div id="counter"></div>

<script>countit(1)</script>

<script>countit(2)</script>

<script>countit(3)</script>

</body> 
```

这可能不是你想要的。让我们尝试这样的事情：

```
<script>
    var i = 1;
    function counter()
    {
       if (i < 4)
       {
         countit(i);
         i++;
         window.setTimeout(counter,1000);
       }
    }

    counter();
</script> 
```

# jira - Jira jql 查询以搜索状态在某个日期后更改为特定状态的工单

> ID：15121807
> 
> 赞同：22
> 
> 时间：2013-02-27T20:32:33.360
> 
> 标签：jira, jql

我需要过滤在特定日期之后进入 RTT 状态的票证。这些票现在将得到解决，但我需要查看所有在某个日期之后进入该状态的人，无论其当前状态如何。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-02-28T06:03:50.733

例如，查找其状态从更改`Open`为`Closed`after的所有问题`2012/12/31`：

```
status CHANGED FROM "Open" TO "Closed" AFTER "2012/12/31" 
```

[您可以在Atlasian 的高级搜索页面](https://confluence.atlassian.com/display/JIRA/Advanced+Searching#AdvancedSearching-CHANGED)上找到有关`CHANGED`搜索键的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-02T17:32:00.977

type = "Bug" AND status was in ("Resolved")

# f# - 记录 F# 代码

> ID：15121814
> 
> 赞同：26
> 
> 时间：2013-02-27T20:33:12.640
> 
> 标签：f#, xml-documentation

在具有单个构造函数的 C# 类中，我可以添加类摘要 XML 文档和构造函数 XML 文档：

```
///<summary>
///This class will solve all your problems
///</summary>
public class Awesome
{
    /// <summary>
    /// Initializes a new instance of the <see cref="Awesome"/> class.
    /// </summary>
    /// <param name="sauce">The secret sauce.</param>       
    public Awesome(string sauce)
    {
        //...implementation elided for security purposes
    }
} 
```

如何对等效的 F# 类执行相同操作以使生成的文档相同？

```
type Awesome(sauce: string) = 
    //...implementation elided for security purposes 
```

澄清：我知道标准 XML 文档标签可以在 F# 中使用。我的问题是如何将它们添加到上面的代码片段中，以便记录类型和构造函数。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-28T02:12:19.253

我查看了[开源 F# 编译器的源代码](https://github.com/fsharp/fsharp)，我认为 Dr_Asik 是正确的 - 无法使用 XML 注释记录隐式构造函数。代表 AST 中的隐式构造函数的节点（参见`ImplicitCtor`此处`ast.fs` [）](https://github.com/fsharp/fsharp/blob/master/src/fsharp/ast.fs#L1272)不包括用于检索 XML 文档的字段（表示为`PreXmlDoc`类型）。

您仍然可以记录所有公共 API - 您必须使用 Dr_Asik 提到的方法*并将*隐式构造函数标记为`private`. 我同意这有点难看，但我认为它比不使用隐式构造函数更方便：

```
type MyType private(a:int, u:unit) =
  /// <summary>Creates MyType</summary>
  /// <param name="a">Parameter A</param>
  new(a:int) = MyType(a, ()) 
```

我在隐式构造函数中添加了一个虚拟参数`u`，以便可以从公共构造函数中调用它。无论如何，我认为这应该被视为一个语言错误，所以我建议将此报告给`fsbugs`at `microsoft`dot `com`。

顺便说一句，我认为 XML 文档主要用作 IntelliSense 的数据源（尽管它仍然需要构造函数的文档），并且我创建了一些替代 F# 工具，让您可以通过编写 F# 脚本文件来创建教程和文档使用 Markdown 进行特殊评论（有[一篇关于它的博客文章](http://tomasp.net/blog/fsharp-literate-programming.aspx)） - 所以您可以认为这是对标准 XML 工具的有用补充。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-27T20:37:33.180

与您在 C# 中所做的方式完全相同：http: [//msdn.microsoft.com/en-us/library/dd233217.aspx](http://msdn.microsoft.com/en-us/library/dd233217.aspx)

如果您不添加任何标签，F# 会假定它是“摘要”：

```
/// This is the documentation
type MyType() = .... 
```

... 相当于

```
/// <summary>This is the documentation</summary>
type MyType() = ... 
```

如果要记录构造函数，则必须显式声明它。AFAIK 没有办法记录主构造函数。

```
/// [Type summary goes here]
type MyType(a : int) =
    let m_a = a
    /// [Parameterless constructor documentation here]
    new() = MyType(0) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-28T14:55:19.727

无法在 F# 源文件 (.fs) 中使用 XML 注释记录隐式构造函数。一种解决方法是显式声明构造函数（参见 Asik 博士的回答）。另一种是将您的 XML 注释放入 F# 签名文件 (.fsi)。

文件.fs：

```
module File

type Awesome(sauce: string) =
    member x.Sauce = sauce 
```

文件.fsi

```
module File

type Awesome =
  class
    /// Implicit constructor summary for the Awesome type
    new : sauce:string -> Awesome
    member Sauce : string
  end 
```

此程序集的 XML 文档现在将包含正确的摘要：

```
<member name="M:File.Awesome.#ctor(System.String)">
<summary>
 Implicit constructor summary for the Awesome type
</summary>
</member> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-08-05T14:20:14.003

这确实是一个烦人的问题。我最终使用的另一个解决方案是不依赖主构造函数：

```
/// Documentation type.
type Awesome =
    val sauce : string
    /// <summary>Documentation constructor.</summary>
    /// <param name="sauce">Sauce. Lots of it.</param>
    new (sauce) = { sauce = sauce } 
```

更详细，但不需要额外的文件或私有构造函数......

# design-patterns - Façade 是否利用了开闭原则？

> ID：15121816
> 
> 赞同：2
> 
> 时间：2013-02-27T20:33:18.783
> 
> 标签：design-patterns, solid-principles, facade, open-closed-principle

开闭原则的[维基百科页面](http://en.wikipedia.org/wiki/Open/closed_principle)（截至今天 2013-02-27）说它是通过继承实现的。

> *开放/封闭原则这个名称有两种使用方式。两种方式都使用继承来解决明显的困境，但目标、技术和结果是不同的。*

“两种方式”是指 Meyer 的实现继承和更常见的多态扩展。

无论如何，我的问题是关于*不*使用继承的[外观](http://en.wikipedia.org/wiki/Facade_pattern)模式。既然它以简化接口的形式定义了一个对更复杂的子系统（或库）的抽象，难道这也不能被看作是开闭原则吗？进一步来说：

 *> 子系统（或库）是*开放的*，可扩展至使用 Façade 的客户端，其接口*对修改是封闭的*。

还是我只是在扩展信息隐藏的界限（这非常接近 OCP，特别是如果您将其视为[Protected Variations](http://martinfowler.com/ieeeSoftware/protectedVariation.pdf)）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-14T04:13:22.457

不，Facade 模式解决了与 OCP 不同的问题。Facade 只是一个类，它是一些其他类的前面。Facade 将它的客户与它所面对的类的变化隔离开来，但这不是 OCP。OCP 是关于单个类如何响应需求变化而变化的。没有任何关于 Facade 的设置来引导这些更改。如果客户对立面的要求发生变化，立面也会发生变化。如果 Facade 面向的任何类以 Facade 关心的方式发生变化，Facade 也会如此。

可以想象一个按照 OCP 设置的 Facade 版本——也许是一个 Facade，其与客户端的接口是一个接口或抽象类，它对修改是封闭的，但可以扩展以适应新的需求——事实上我已经总是以这种方式实现 Facade，但这不是 Facade 的经典描述的一部分。*

# dynamics-crm-2011 - 添加连接帐户时更改要在 CRM 2011 中搜索的默认实体

> ID：15121819
> 
> 赞同：2
> 
> 时间：2013-02-27T20:33:21.000
> 
> 标签：dynamics-crm-2011

在 CRM 2011 中，在 Account 下，可以添加 Connection。单击添加连接后，您可以浏览/搜索默认为“联系人”的名称。有没有办法默认将“联系人”切换为“帐户”而无需切换选择框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T22:53:30.277

显然只是这样做：

```
document.getElementById("record2id").setAttribute("defaulttype", "1"); 
```

但是我做了一些搜索，这不适用于连接对话框，请检查此[替代方法](http://social.microsoft.com/Forums/en/crmdevelopment/thread/2da0a8bd-36e3-4b4c-a172-d2651f3826ce)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T16:08:10.483

这不适用于连接。

对于连接，查找的对象类型代码在 Microsoft Dynamics CRM\CRMWeb_static\entities\connection.js 的 Mscrm.Connection.preSelectObjectType 函数中设置。

有一条线像

```
$v_2.set_defaultType($v_3); 
```

设置对象类型的位置。$v_3 根据所选角色设置。

所以你需要把它改成

```
$v_2.set_defaultType(Mscrm.EntityTypeCode.Account.toString()); 
```

但是您将丢失基于角色的查找配置，因此您可能需要对其进行修改。此外，它不受支持，您需要在安装更改 connection.js 的新汇总时考虑更新行为（即从更新的系统手动复制较新的 connection.js 文件，然后再次自定义它们）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-30T00:59:04.537

这里有两种方法。两者都有效，但第一个将类型记录 Icon 添加到 loockup 字段，即使它是空的。第二个没有这样做，但风险更大，因为它取决于内部方法名称。

第一种方法：

```
if (IsNull(Xrm.Page.getAttribute('record2id').getValue())) {$("#record2id")[0].DataValue = [{ "type": scrm.EntityTypeCode.SystemUser.toString() }];} 
```

* * *

第二种方法

```
document.original_preSelectObjectType = Mscrm.Connection.preSelectObjectType;
Mscrm.Connection.preSelectObjectType = function (roleLookup, peerRoleLookup) {
   if (IsNull(roleLookup.DataValue) && IsNull(peerRoleLookup.DataValue) && !window.event.srcElement.DataValue) {
       var $v_0 = window.event.srcElement;
       $v_0.defaulttype = Mscrm.EntityTypeCode.SystemUser.toString();
       $v_0.DefaultViewId = "";
       $v_0.Lookup(true, false, null, false);
   }
   else { 
       document.original_preSelectObjectType(roleLookup, peerRoleLookup); }} 
```

* * *

# powershell - powershell分配是懒惰的吗？

> ID：15121825
> 
> 赞同：1
> 
> 时间：2013-02-27T20:33:49.970
> 
> 标签：powershell

我有以下代码

```
$a = ls
....
$a | ? { ... } 
```

`$a`第一行执行时会赋值吗？还是在命中之前不会执行`$a | ? { ... }`？

为什么下面的代码不返回 true？

```
$b = @(1,2);
$c = $b;
$b -eq $c 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:42:42.953

第一个问题：

`$a`在执行第一行时分配

尝试：

```
$a = ls

$a.gettype(); # now $a is an array of [fileinfo] and/or [directoryinfo] 
```

第二个问题：

[在这里](https://stackoverflow.com/questions/9598173/comparing-array-variables-in-powershell)阅读

并注意：

```
$b.Equals($c) 
```

返回`true`

# entity-framework - 实体框架使用默认表值生成数据库架构 (SQL)

> ID：15121839
> 
> 赞同：0
> 
> 时间：2013-02-27T20:34:19.620
> 
> 标签：entity-framework, sql-server-2005, entity-framework-5, ef-model-first

我正在使用 EF 5 和 SQL Server 2005，Model First（有点）。

顺便说一下，我的意思是我通常在 SQL Server 设计器中构建我的架构，但将架构导入 EF，这样我就有了一个可视化视图。经常有往返。

但是，我注意到，当我尝试基于 EF 模型生成 DB 模式时，它会跳过我作为默认值分配给我的 Guid ID 的所有 NEWID() 默认值，但它不会跳过身份字段int 类型。

我发现这篇文章解释了这个原因： [Entity Framework 4 and Default Values](https://stackoverflow.com/questions/3586466/entity-framework-4-and-default-values)

但是，它没有回答我的问题：如何让 Entity Framework 为我的 uniqueidentifier 类型生成默认值为 NEWID() 的 SQL DDL 数据库模式？

笔记：

我不关心如何从 POCO 实体等中设置它们（有很多帖子对此进行了描述）——我关心的是正确生成 SQL DDL，这样我就可以为数据库播种而不必担心这些值会丢失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-05T18:58:22.297

使用实体框架迁移，您可以使用[GUID 列生成器](http://msdn.microsoft.com/en-us/library/system.data.entity.migrations.builders.columnbuilder.guid.aspx)及其`DefaultValueSql`参数。该参数的值可以是字符串`"NEWID()"`。这应该注意正确的 DDL 生成。

接下来，您应该将这些属性声明为使用属性或流式模型构建器生成的数据库，以便 EF 忽略在您的 POCO 中设置的值（对于新对象将为 null）。

# mysql - sql 脚本适用于 MySQL，但不适用于 google bigquery

> ID：15121841
> 
> 赞同：0
> 
> 时间：2013-02-27T20:34:26.383
> 
> 标签：mysql, sql, google-bigquery

我有在 MySQL 中可以正常工作的 sql 脚本，但是我无法在 google bigquery 中工作。通读 bq 文档后，我做了一些调整（例如，每个 select 语句不超过一个 join），但脚本仍然失败。任何帮助表示赞赏。如果您知道 bq sql 与其他 sql 方面的任何好的资源，那也将不胜感激。谢谢。

```
SELECT 
T1.action_date AS action_date,
T1.ad_campaign_category AS ad_campaign_category,
T1.campaign_id AS campaign_id,
T2.total_sends AS total_sends, 
count(*) AS clicks_per_category
FROM ( 
    SELECT action_date, campaign_id, ad_campaign_category
    FROM projectX.email_action
    WHERE action_date > '2009-04-01' AND action_date < '2011-05-01') T1,

    (
    SELECT action_date, campaign_id, ad_campaign_category, count(*) AS total_sends
    FROM projectX.email_action
    WHERE action_type = 'send' AND action_date > '2009-04-01' AND action_date < '2011-05-01'
    GROUP BY action_date, campaign_id) T2

WHERE T1.action_date = T2.action_date 
    AND T1.campaign_id = T2.campaign_id
GROUP BY action_date, campaign_id, ad_campaign_category 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T22:44:43.843

JOIN 必须是显式的——也就是说，而不是使用`SELECT ... FROM (...) t1, (...) t2 WHERE t1.x = t2.y`您应该使用表单`SELECT ... FROM (...) t1 JOIN (...) t2 ON t1.x = t2.y` 对于您的示例，这看起来像：

```
SELECT 
T1.action_date AS action_date,
T1.ad_campaign_category AS ad_campaign_category,
T1.campaign_id AS campaign_id,
T2.total_sends AS total_sends, 
count(*) AS clicks_per_category
FROM ( 
    SELECT action_date, campaign_id, ad_campaign_category
    FROM projectX.email_action
    WHERE action_date > '2009-04-01' AND action_date < '2011-05-01') T1
JOIN (
    SELECT action_date, campaign_id, ad_campaign_category, count(*) AS total_sends
    FROM projectX.email_action
    WHERE action_type = 'send' AND action_date > '2009-04-01' AND action_date < '2011-05-01'
    GROUP BY action_date, campaign_id) T2
ON T1.action_date = T2.action_date 
AND T1.campaign_id = T2.campaign_id
GROUP BY action_date, campaign_id, ad_campaign_category 
```

请注意，如果您收到一个表太大的错误，请尝试使用`JOIN EACH`而不是`JOIN`.

# c++ - boost::unordered_map 键类哈希和相等方法

> ID：15121842
> 
> 赞同：0
> 
> 时间：2013-02-27T20:34:32.277
> 
> 标签：c++, boost, hash, map, unordered-map

是否可以不为哈希生成和密钥比较声明另一个对象，而是在密钥类中为此功能创建成员函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:41:36.297

如评论中所述，您可以轻松地`operator==`为您的班级定义一个。您还可以编写一个自由函数，该函数`hash_value`采用您的类的参数，并且应该自动使用它。

# django - Django代码更改时是否需要重新启动uWSGI？

> ID：15121844
> 
> 赞同：12
> 
> 时间：2013-02-27T20:34:36.067
> 
> 标签：django, nginx, uwsgi

我正在开发一个在 nginx 和 uWSGI 下运行的 Django webapp。当我部署新的 Django 代码（例如 settings.py）时，我需要重新启动 uWSGI 吗？如果是这样，为什么？

背景：我有一个场景，我更新了 settings.py 和其他一些代码并部署了它。在我重新启动 uWSGI 之前，我没有看到 webapp 行为的变化。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-27T23:13:38.363

是的，您需要重新启动 uWSGI 进程。

Python 将编译后的代码保存在内存中，因此在进程重新启动之前不会被重新读取。django 开发服务器 ( `manage.py runserver`) 主动监视文件的更改，但默认情况下其他服务器不会发生这种情况。如果你想在 uWSGI 中启用自动重新加载，[touch-reload](http://uwsgi-docs.readthedocs.org/en/latest/Options.html#touch-reload)和[py-auto-reload](http://uwsgi-docs.readthedocs.org/en/latest/Options.html#py-auto-reload) uWSGI 参数可能会有所帮助。

# android - 从 ImageView 中删除图像并加载新图像

> ID：15121846
> 
> 赞同：0
> 
> 时间：2013-02-27T20:34:39.020
> 
> 标签：android, imageview

我在从中删除图像时遇到问题`ImageView`。我想要的图像被加载`ImageView`，然后相机拍摄新图像，现在应该加载图像以`ImageView`替换前一个图像。我努力了

1.  `invalidate();`
2.  `setImageBitmap(null);`
3.  `setImageResource(0);`

所有这 3 种方法都不起作用。有人能帮我吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-28T06:08:41.973

使用它在 ImageView 中设置图像

```
image.setImageResource(R.drawable.image); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-28T06:15:59.723

*   如果你想通过 Drawable Image 设置图像，你可以像这样使用

    ```
    your_image_view.setImageDrawable(context.getResources().getDrawable(your_drawable_Image_id)); 
    ```

*   如果你想通过 BitMapDrawable 设置图像

    ```
    your_image_view.setBackgroundDrawable(your_drawable_bitmap); 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-21T12:18:49.563

```
edit_countflag.setBackgroundColor(0);
edit_countflag.setImageResource(R.drawable.flag_id); 
```

# html - HTML 注释后

> ID：15121849
> 
> 赞同：5
> 
> 时间：2013-02-27T20:34:47.397
> 
> 标签：html, comments

这对于大多数现代浏览器来说是安全的还是会变成一个巨大的可憎？

例如：

```
<html>
<head>
<title>Please work</title>
</head>
<body>
My Awesome Body
</body>
</html>
<!-- Generated in 1.337 seconds --> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T20:40:04.207

我的猜测是，只要您将`DOCTYPE`声明保留在页面的最顶部，将评论放在您想要的任何地方都不会有任何问题。
虽然，最好总是尝试不同的浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:38:18.820

尝试使用[HTML 验证器检查它](http://validator.w3.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-18T04:49:59.437

要么用验证器检查它，要么通过所有可用的网络浏览器亲自运行你的代码，这总是最好的方法！

但是，只要避免将代码放在`"<!DOCTYPE>"`行上，就可以了

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:38:46.610

它会起作用，但我不确定它是否是有效的 html。你可以运行一个没有`<html>`标签的 html 代码，浏览器仍然会接受它。但它不是一个好习惯。尝试保持您的 html 代码有效

# mysql - 您如何为联接指定特定列？

> ID：15121852
> 
> 赞同：1
> 
> 时间：2013-02-27T20:34:51.127
> 
> 标签：mysql, sql

我正在尝试使用来自不同表中的列的数据更新表中的列。我的代码是：

```
UPDATE extlinks
INNER JOIN sp_board using (title)
SET extlinks.board_id = sp_board.id 
```

我的问题如下：两个表都非常大（数百万行），我想如果我只合并必要的列，我可能能够加快更新速度。如何指定联接只应包含上述代码中的列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:37:07.377

这是由 RDBMS 如何实现[关系代数](http://en.wikipedia.org/wiki/Relational_algebra)来处理的。

简而言之，服务器只会“实现”所需的数量。这里没有问题，并且在 SQL 中说“仅在连接中包含 X 列”是没有意义的——这些列可以被认为不包括在内*，除非*以后需要它们（常见的情况是发送结果的 SELECT给客户）。在这种情况下，`sp_board.id`实际上只需要该列。

但是，请注意 Rocket Hazmat 的评论 - 它围绕记录（而不是列）的物化 - 因为它提出了一个非常有趣的问题。我不知道答案是什么。

# msbuild - 如何发布包含 .net 安装程序和自动更新功能的 clickonce 安装程序？

> ID：15121855
> 
> 赞同：7
> 
> 时间：2013-02-27T20:35:00.463
> 
> 标签：msbuild, clickonce, teamcity-7.0

我将 TeamCity 用于持续集成服务器，并使用 ClickOnce 安装程序部署我的应用程序。我可以让安装程序运行并部署我的应用程序，但如果计算机尚未安装 .net 4.5 的安装程序，或者如何在 ClickOnce 部署中启用自动更新检查功能，我无法弄清楚如何包含它。我目前正在使用下面的 MSBuild 文件来构建我的安装程序

```
<Project DefaultTargets="DoPublish" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/>
  <PropertyGroup>
    <Version>$(BUILD_NUMBER)</Version>
    <Install>true</Install>
    <InstallFrom>Unc</InstallFrom>
    <UpdateEnabled>true</UpdateEnabled>
    <UpdateMode>Background</UpdateMode>
    <ClickOnceBuildDirectory>$(MSBuildProjectDirectory)\MyProject\bin\$(Configuration)\app.publish</ClickOnceBuildDirectory>
    <ClickOnceInstallDirectory>$(MSBuildProjectDirectory)\Publish</ClickOnceInstallDirectory>
    <ClickOnceFinalLocation>$(env_PublishUrl)</ClickOnceFinalLocation>
  </PropertyGroup>
  <Target Name="DoPublish">
    <RemoveDir Directories="$(ClickOnceInstallDirectory)" ContinueOnError="true" />
    <MSBuild Projects="MyProject.sln" Targets="Clean;Build" Properties="ApplicationVersion=$(Version);Configuration=$(Configuration)"/>
    <MSBuild Projects="MyProject\MyProject.csproj" Targets="Publish" Properties="ApplicationVersion=$(Version);Configuration=$(Configuration);InstallUrl=$(ClickOnceFinalLocation)" />
    <MakeDir Directories="$(ClickOnceInstallDirectory)"/>    
    <Exec Command="xcopy /E $(ClickOnceBuildDirectory) $(ClickOnceInstallDirectory)" />    
  </Target>  
</Project> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T13:39:59.313

您可以使用引导程序来处理先决条件，例如检查 .NET Framework。查看[应用程序部署先决条件](http://msdn.microsoft.com/en-us/library/h4k032e1%28v=vs.100%29.aspx)MSDN 文章，尤其是有关使用 ClickOnce 和 MSBuild 引导的部分。

还有 2 篇 MSDN 文章详细介绍[了如何安装 ClickOnce 先决条件](http://msdn.microsoft.com/en-us/library/8st7th1x%28v=vs.100%29.aspx)和[创建引导程序包](http://msdn.microsoft.com/en-us/library/ms165429%28v=vs.100%29.aspx)。

至于自动更新，您是否希望将自动更新功能定位在应用程序本身之外，即在安装程序中还是在应用程序中？有[几种方法可以在您的应用程序中允许 ClickOnce 更新](http://msdn.microsoft.com/en-us/library/s22azw1e%28v=vs.100%29.aspx)，包括[通过 ClickOnce 部署 API 自动更新](http://msdn.microsoft.com/en-us/library/ms404263%28v=vs.100%29.aspx)。

可以在[现有的 Stackoverflow 文章](https://stackoverflow.com/a/1336416/461382)中找到使用 ClickOnce Bootstrapper 包的简要说明。虽然您在这里没有使用 WiX，但您也可以查看[这个 WiX 线程](http://www.mentby.com/jason-ding/install-net-framework-4.html)，这很有用，因为您会看到一些在此过程中不起作用的步骤。这些示例显示了使用[GenerateBootstrapper MSBuild 任务](http://msdn.microsoft.com/en-us/library/ms164294%28v=vs.100%29.aspx)为 ClickOnce 安装程序创建引导程序。请注意，在上述链接的示例中，GenerateBootstrapper 任务中的“路径”设置为 Windows SDK 位置下的子文件夹。只要该位置具有必要的先决条件包，就可以将其更改为另一个位置。

下面是一个示例，其中将 .NET 4.5 Framework 设置为安装的先决条件。.NET 4.5 先决条件的父目录结构由 $(MyPathToPrerequisitePackages) 属性指定。

以下示例中的**BootstrapperFile**项指定了 .NET 4.5 Framework 必备包。值“.NETFramework,Version=v4.5”来自 Bootstrapper\Packages\DotNetFX45 文件夹中的 product.xml 文件，并允许**GenerateBootstrapper**任务正确识别 .NET 4.5 必备程序/引导程序包。“ProductName”值只是对包的友好描述。

```
<PropertyGroup>
  <MyPathToPrerequisitePackages>C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\Bootstrapper</MyPathToPrerequisitePackages>
</PropertyGroup>
<ItemGroup>
  <BootstrapperFile Include=".NETFramework,Version=v4.5">
    <ProductName>.NET Framework 4.5</ProductName>
  </BootstrapperFile>
</ItemGroup>
<GenerateBootstrapper 
  ApplicationFile="$(MyAppAssembly).application"
  ApplicationUrl="$(MyClickOnceAppUrl)"
  ApplicationName="$(MyClickOnceAppName)"
  BootstrapperItems="@(BootstrapperFile)"
  Culture="en"
  FallbackCulture="en-US"
  CopyComponents="true"
  Validate="false"
  Path="$(MyPathToPrerequisitePackages)"
  SupportUrl="$(MyAppSupportUrl)"
  OutputPath="$(MyDesiredOutputPath)\" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-21T07:28:27.640

[刚刚在“ https://stackoverflow.com/a/39610060/1345870](https://stackoverflow.com/a/39610060/1345870) ”上发布了回复：

我自己只是为此苦苦挣扎-我选择将引导程序文件提交到源代码控制。可以覆盖引导程序的路径，只需提供`/p:GenerateBootstrapperSdkPath=.build\Bootstrapper`

然后无需修改注册表 - 并且构建现在是独立的。

唯一的“问题”是我必须手动将引导程序文件复制到源代码管理中。就我而言（VStudio2015），这意味着从`C:\Program Files (x86)\Microsoft Visual Studio 14.0\SDK\Bootstrapper`

# css - 在 CSS 中声明类内部类

> ID：15121856
> 
> 赞同：0
> 
> 时间：2013-02-27T20:35:01.140
> 
> 标签：css

虽然我在网上找到了一些例子，但它并没有解决我的问题。希望可以有人帮帮我。我有两个 css 文件。一是重置所有样式属性。有代码（片段）

```
html, body, body div, span, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, abbr, address, cite, code, del, dfn, em, img, ins, kbd, q, samp, small, strong, sub, sup, var, b, i, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, figure, footer, header, hgroup, menu, nav, section, time, mark, audio, video {
 margin: 0;
 padding: 0;
 border: 0;
 outline: 0;
 font-size: 100%;
 vertical-align: baseline;
 background: transparent;
} 
```

由于规则，我无法修改 reset.css。我只在 style.css 上工作。我做了什么来使 HeaderStyle 工作。我创建了一个新类并且它有效。

```
tr.dgrdHeaderfntsize13e td
{
   font-size: 1.4em; /* 1.3em 11px */
   font-weight: bold;
  background-color: #F2F7FA;
  padding: 5px;
  text-transform: none;
  vertical-align: middle; 
  text-align: left;

} 
```

我的问题是如何为单元格上的字体大小创建类。我试过了`td.fntsize13e`，还是`tr td.fntsize13e`不行。有我的 .aspx 页面

```
<asp:DataGrid ID="dgrdLawyers" Runat="server" DataKeyField="GlobalID" GridLines="Both"     
    AutoGenerateColumns="false"    CssClass="dgrdInnerBorders noOuterBorder talgnC"  
      CellPadding="5" >
   <PagerStyle Mode="NumericPages" Position="Top" HorizontalAlign="Right" />
      <%--<HeaderStyle CssClass="dgrdHeader  talgnL fntsize13e"></HeaderStyle>--%>
           <HeaderStyle CssClass="dgrdHeaderfntsize13e"></HeaderStyle> 
         <ItemStyle CssClass="dgrdItem talgnL fntsize13e"></ItemStyle> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:43:47.220

验证您呈现的 html 是否正确，并且没有设置内联样式，例如..

```
<td style="font-size:20px;">asdf</td> 
```

并且在你的 CSS 中你可以使用 !important 来强制一个属性值

```
td.fntsize13e {
  font-size: 10px !important;
} 
```

这应该有效并且会强制字体大小，但我会尽量避免这种情况。找出真正设置字体大小的位置并在那里修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:48:49.533

确保你的 CSS 范围。尝试

```
#dgrdLawyers . . . 
```

如果您有像@teewuane 建议的内联样式，请使用 !important 作为最后的手段。

# python - 使用 Python 的多处理模块的同步问题

> ID：15121859
> 
> 赞同：2
> 
> 时间：2013-02-27T20:35:16.503
> 
> 标签：python, synchronization, locking, multiprocessing

[当我从 Python 的多处理模块页面](http://docs.python.org/2/library/multiprocessing.html)运行以下代码时：

```
from multiprocessing import Process, Lock

def f(l, i):
    l.acquire()
    print 'hello world', i
    l.release()

if __name__ == '__main__':
    lock = Lock()

    for num in range(10):
        Process(target=f, args=(lock, num)).start() 
```

有时我会得到无序的输出，例如：

```
hello world 0
hello world 1
hello world 2
hello world 4
hello world 3
hello world 6
hello world 5
hello world 7
hello world 8
hello world 9 
```

请注意，4 在 3 之前打印，6 在 5 之前打印。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:38:27.600

因为整点`multiprocessing`是*并行性*。您的进程彼此同时运行，因此它们实际上可能以任何顺序开始和结束。

锁定获取仅确保它们不会同时尝试`print` *-*但该锁定可能由各种进程以任何随机顺序获取。它更有*可能*被您创建的第一个进程获取，因为该进程将更快地完成初始化，因此很可能是第一个请求锁的进程。但是不能保证顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:40:34.670

这取决于操作系统如何安排哪个先运行，而您的锁只能防止其中一个以上同时运行。

# java - 通过 Toolkit 制作的图像返回 -1 作为宽度、高度

> ID：15121863
> 
> 赞同：2
> 
> 时间：2013-02-27T20:35:25.960
> 
> 标签：java, toolkit

```
java.awt.Toolkit kit = Toolkit.getDefaultToolkit();
try {
   java.awt.Image img,ig;
   img = kit.getImage("/home/aditya/Pictures/tile.png");
   ig =
      javax.imageio.ImageIO.read(
         new java.io.File("/home/aditya/Pictures/tile.png"));
}
int w  = img.getWidth(null);
int wp = ig .getWidth(null);
int h  = img.getHeight(null);
int hp = ig .getHeight(null);
System.out.println(wp+" "+hp+" "+w+" "+h); 
```

总是给出这个输出

```
59 64 -1 -1 
```

即通过工具包创建的图像的宽度、高度总是返回-1。

任何想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:56:08.227

使用 awt 加载图像是异步的。

[看看这个教程](http://underpop.online.fr/j/java/help/java-loading-images.html.gz)。

```
class test extends Component
{
    test()
    {
        /* Get the toolkit from this Component */
        Toolkit t = getToolkit();
        /* Begin a retrieval of a remote image */
        Image   i = t.getImage( "https://cdn.southampton.ac.uk/assets/imported/transforms/site/depth/Action_BackgroundImage/E8813999F2F94220B91699A33F794636/201117_syndicut_southamptonUni_Homepage_banner.png_SIA_JPG_fit_to_width_FULL.jpg");
        /* Create a new MediaTracker linked to this Component */
        MediaTracker m = new MediaTracker( this );
        /* Add the loading image to the MediaTracker,
           with an ID of 1 */
        m.addImage( i, 1 );
        /* Explicitly wait for the image to load */
        try
        {
            m.waitForAll();
        }
        /* Catch the exception */
        catch( InterruptedException e )
        {
            System.out.println("Loading of the image was interrupted" );
        }

        /* Check the status */
        if( m.status() & MediaTracker.LOADING )
            System.out.println("Still Loading - oops, we should never be here!");
        if( m.status() & MediaTracker.ABORTED )
            System.out.println("Loading of image aborted");
        if( m.status() & MediaTracker.ERRORED )
            System.out.println("Image was errored");
        if( m.status() & MediaTracker.COMPLETE )
            System.out.println("Image load complete!");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-09T12:39:04.927

您可以使用 ImageObserver，而不是为 getWidth 使用 null。

```
ImageObserver a = new ImageObserver(){
                      imageUpdate​(Image img, int infoflags, int x, int y, int width, int height){
        System.out.println("After loading: " + x + ", " + y + ", " +width + ", " + height);
    }
} 
```

然后当你得到宽度时，你会在第一次调用时得到-1，但是当它改变时会通知观察者。“如果宽度未知，则此方法返回-1，稍后通知指定的 ImageObserver 对象”

# ruby - 如何从 MongoMapper Plucky::Query 对象获取原始 Mongo 数据结果？

> ID：15121865
> 
> 赞同：1
> 
> 时间：2013-02-27T20:35:32.717
> 
> 标签：ruby, mongodb, mongomapper, mongodb-query

假设我们有一个名为“images”的 MongoDB 集合，以及一个具有相应“Image”模型的 MongoMapper 驱动的应用程序。如果我们使用此模型设置 MongoMapper 查询，我们会看到它是 type`Plucky::Query`并返回 type 的结果`Image`：

```
>> Image.where(:file_type => 'image/jpeg').class
=> Plucky::Query

>> Image.where(:file_type => 'image/jpeg').first.class
=> Image 
```

我们可以直接在 Mongo 适配器上运行相应的查询，主要绕过 MongoMapper，通过访问`MongoMapper.connection`. 如果我们这样做，查询是 type`Mongo::Cursor`并返回 type 的原始数据结果`BSON::OrderedHash`：

```
>> MongoMapper.connection.db(dbname).collection('images').find({ :file_type => 'image/jpeg' }).class
=> Mongo::Cursor

>> MongoMapper.connection.db(dbname).collection('images').find({ :file_type => 'image/jpeg' }).first.class
=> BSON::OrderedHash 
```

问题是，有没有办法将`Plucky::Query`上面的类似内容转换为（或从中检索）一个基本的非扩展`Mongo::Cursor`对象？

起初我以为我找到了一个解决方案`find_each`，它实际上需要 a`Plucky::Query`并返回 a `Mongo::Cursor`：

```
>> Image.where(:file_type => 'image/jpeg').find_each.class
=> Mongo::Cursor 
```

但事实证明，这`Mongo::Cursor`以某种方式扩展或与上述不同，因为它仍然返回`Image`对象而不是`BSON::OrderHash`对象：

```
>> Image.where(:file_type => 'image/jpeg').find_each.first.class
=> Image 
```

更新：我不能像在第二种情况下那样完全绕过 MongoMapper 查询魔术，因为我需要访问 MongoMapper 的功能（特别是命名范围）来构建查询，所以我最终得到的是`Plucky::Query`. 但是我希望结果是纯数据对象，而不是模型，因为我需要的只是数据，我不想要模型实例化的开销。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T21:05:52.870

MongoMapper 通过在 plucky 查询上设置一个“transformer”lambda 来实现转换。您可以在[MongoMapper 源代码](https://github.com/jnunemaker/mongomapper/blob/master/lib/mongo_mapper/plugins/querying.rb)中看到这一点：

```
def query(options={})
    query = Plucky::Query.new(collection, :transformer => transformer)
    ...
end

...

def transformer
    @transformer ||= lambda { |doc| load(doc) }
end 
```

因此，在每次 mongo 文档检索之后，它`Plucky::Query`都会运行加载模型的转换。查看[Plucky 源代码](https://github.com/jnunemaker/plucky/blob/master/lib/plucky/query.rb)，我们看到有一个简单的 setter 方法`[]`可以用来禁用它。所以这是解决方案：

```
plucky_query = Image.where(:file_type => 'image/jpeg')

plucky_query.first.class
# => Image

plucky_query[:transformer] = nil
plucky_query.first.class
# => BSON::OrderedHash 
```

如果你不介意猴子补丁，你可以像这样封装：

```
module Plucky
    class Query
        def raw_data
            self[:transformer] = nil
            self
        end
    end
end 
```

然后你可以简单地写：

```
Image.where(:file_type => 'image/jpeg').raw_data.first.class
# => BSON::OrderedHash 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T21:10:11.113

如果你掉到驱动，变压器`nil`默认是：

```
1.9.3p194 :003 > Image.collection.find({ :file_type => 'image/jpeg' }, { :limit => 1 }).first.class
 => BSON::OrderedHash 
```

# java - SQL 准备语句如何通过多个可能的菜单选择进行选择？

> ID：15121869
> 
> 赞同：8
> 
> 时间：2013-02-27T20:36:00.493
> 
> 标签：java, sql, jdbc

所以我有 4 个菜单选择（产品、位置、课程类型和类别），所有这些都可以为空（使用 JSF 编程，但这应该与这个问题无关，因为它是一个 SQL 问题）。

菜单选择将向托管 bean 发送用户选择的变量，并使用准备好的语句使用用户选择的菜单中的信息（如果有的话）搜索数据库表。

如果用户将菜单项保留为空，它应该搜索所有内容。

如果用户留下 1 或 2 或 3 个带有信息的菜单项，而另一个为空，则应进行相应的搜索。

我的问题是如何在没有附加到每个相应 sql 语句的 bean 中的一堆 if/then 语句的情况下执行此操作？

或者有没有更好的 sql 语句我可以做到这一切？

我在 Java 中使用准备好的语句。

我试过这个：

```
if (product != null && location != null && courseType != null && category != null) {
            pstmt = conn.prepareStatement("select * FROM Courses WHERE "
                    + "product = ? "
                    + "and location = ? "
                    + "and courseType = ? "
                    + "and category = ?");

            pstmt.setString(1, product);
            pstmt.setString(2, location);
            pstmt.setString(3, courseType);
            pstmt.setString(4, category);
        } else if (product == null && location != null && courseType != null && category != null) {
            pstmt = conn.prepareStatement("select * FROM Courses WHERE "
                    + "location = ? "
                    + "and courseType = ? "
                    + "and category = ?");

            pstmt.setString(1, location);
            pstmt.setString(2, courseType);
            pstmt.setString(3, category);
        } 
```

等等，但是对于每种情况下 1 为空而不是其他情况，我必须这样做 16 次？必须有更聪明的方法（要么使用 1 条 sql 语句，要么只使用几个 java if/then 语句？）

更新感谢 Luiggi Mendoza！我的代码是这样工作的：

```
pstmt = conn.prepareStatement("select * FROM Courses WHERE " 
         + "(product = ? or ? is null) " 
         + "and (location = ? or ? is null) " 
         + "and (courseType = ? or ? is null)" 
         + "and (category = ? or ? is null)"); 

         pstmt.setString(1, product);
         pstmt.setString(2, product);
         pstmt.setString(3, location);
         pstmt.setString(4, location);
         pstmt.setString(5, courseType);
         pstmt.setString(6, courseType);
         pstmt.setString(7, category);
         pstmt.setString(8, category);

        rset = pstmt.executeQuery(); 
```

更新是的，我不得不使用 = "" 而不是 is null 用于不同的mysql数据库（可能是不同的版本或其他东西）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T20:44:29.297

我假设您对`NULL`所选值有一个默认值（因为我不知道使用 的另一种方法`PreparedStatement`）作为`'0'`（仅作为示例）。

知道了这一点，我倾向于使用这种 SQL：

```
SELECT *
FROM Courses
WHERE
    (product = ? or ? = '0')
    and (location = ?  or ? = '0')
    and (courseType = ? or ? = '0')
    and (category = ? or ? = '0') 
```

使用这种方法，您可以利用`IF`使用情况并让数据库处理工作。唯一的坏点是你应该将每个变量设置两次（这辈子没有什么是免费的 =\ ）。

* * *

编辑：我已经根据您的要求进行了测试。首先是SQL表和内容：

```
create table pruebaMultiSelect
(id int primary key auto_increment,
nombre varchar(50),
tipo varchar(10),
categoria varchar(10));

insert into pruebaMultiSelect values
(null, 'Luiggi', 'A', 'X');

insert into pruebaMultiSelect values
(null, 'Thomas', 'A', 'Y');

insert into pruebaMultiSelect values
(null, 'Jose', 'B', 'X');

insert into pruebaMultiSelect values
(null, 'Trina', 'B', 'Y'); 
```

现在，相关的 Java 代码：

```
public class DBTest {

    public void testPreparedStatement(String p1, String p2) throws SQLException {
        Connection con = null;
        PreparedStatement pstmt = null;
        ResultSet rs = null;
        try {
            con = getConnection();
            pstmt = con.prepareStatement("SELECT * FROM pruebaMultiSelect WHERE (tipo = ? OR ? = 'EMPTY') "
                    + "AND (categoria = ? OR ? = 'EMPTY')");
            pstmt.setString(1, p1);
            pstmt.setString(2, p1);
            pstmt.setString(3, p2);
            pstmt.setString(4, p2);
            rs = pstmt.executeQuery();
            while (rs.next()) {
                System.out.printf("%5d %15s\n", rs.getInt(1), rs.getString(2));
            }
        } catch(ClassNotFoundException e) {
            e.printStackTrace();
        } finally {
            rs.close();
            pstmt.close();
            con.close();
        }
    }

    public Connection getConnection() throws SQLException, ClassNotFoundException {
        Class.forName("com.mysql.jdbc.Driver");
        return DriverManager.getConnection("jdbc:mysql://localhost:3306/luiggi_test", "user", "password");
    }

    public static void main(String[] args) throws SQLException {
        //this will return all the data
        String p1 = "EMPTY";
        String p2 = "EMPTY";
        new DBTest().testPreparedStatement(p1, p2);
    }
} 
```

使用 MySQL 5.1.18 测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:41:30.610

我倾向于使用这样的辅助方法构建动态查询：

```
StringBuilder query = new StringBuidler();
query.append("SELECT foo, bar FROM baz");
query.append(buildProductClause(product));
query.append(buildLocationClause(location));
query.append(buildCourseTypeClause(courseType));
// etc... 
```

如果您仍想使用准备好的语句，您可以使用成员字段来构建参数数组。

# c++ - IntelliSense：函数调用中的参数太少

> ID：15121872
> 
> 赞同：0
> 
> 时间：2013-02-27T20:36:09.797
> 
> 标签：c++

我正在为一个类编写一个程序，该程序需要销售金额并计算一美元的变化。每个面额都列出了硬币的数量作为输出。由于参数太少的错误，我无法运行它？

我不确定 VB 在这里寻找什么。任何帮助，将不胜感激。

程序代码：

```
#include <iostream>
#include <string>
#include <sstream>
#include <iomanip>
#include <cmath>

using namespace std;

// Determines how many of each coin to dispense.
void Dispenser(int, int *, int *, int *, int *);                                    

int main(void)
{
    // Change the console's background color.
    system ("color F0");

        // Declares the variables.
        double amount_paid = 1.00, amount_due;                                                             
        int amount_left, dollar_qty, quarter_qty, dime_qty, nickel_qty, penny_qty; 

    // Get user input.
    cout << "\n";
    cout << "Enter the money amount paid: $";
        cin >> amount_due;
    cin.ignore();

    // Perform calculations.
    amount_paid = amount_paid * 100 + 0.5;
        amount_due = amount_due * 100;

        amount_left = amount_paid - amount_due;
        dollar_qty = amount_left / 100;

        Dispenser (amount_left + quarter_qty + dime_qty + nickel_qty + penny_qty);

        "\n";

        // Display output.
        cout << "\nAmount of the purchase: " << fixed << setprecision(2) << showpoint        << amount_due;
        cout << "\nChange from $1.00: " << fixed << setprecision(2) << showpoint <<      amount_left;
        cout << "\n" << fixed << setprecision(2) << showpoint << dollar_qty << "      dollars";
        cout << "\n" << fixed << setprecision(2) << showpoint << quarter_qty <<       "quarters";
        cout << "\n" << fixed << setprecision(2) << showpoint << dime_qty << "dimes";
        cout << "\n" << fixed << setprecision(2) << showpoint << nickel_qty <<      "nickles";
        cout << "\n" << fixed << setprecision(2) << showpoint << penny_qty <<      "pennies";

    system("pause");
        return 0;   
}

void Dispenser(int amt_left, int *quarters, int *dimes, int *nickels, int *pennies)
{
    int    total_change, total_quarters, total_dimes, total_nickels, total_pennies;

    // Determine change amount by quantity.

    total_change = amt_left % 100;
    total_quarters = total_change / 25;
    total_change = total_change % 25;
    total_dimes = total_change / 10;
    total_change = total_change % 10;
    total_nickels = total_change / 5;
    total_change = total_change % 5;
    total_pennies = total_change;

    *quarters = total_quarters;
    *dimes = total_dimes;
    *nickels = total_nickels;
    *pennies = total_pennies;
} 
```

错误在“）”的这一行

```
Dispenser (amount_left + quarter_qty + dime_qty + nickel_qty + penny_qty); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T20:38:15.093

```
Dispenser (amount_left + quarter_qty + dime_qty + nickel_qty + penny_qty); 
```

应该

```
Dispenser (amount_left, quarter_qty, dime_qty, nickel_qty, penny_qty); 
```

您的版本实际上只是将所有值相加的一个大参数，而我提供的带有逗号的那个意味着它是 5 个单独的参数被发送到函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:38:05.003

您使用了“+”而不是“，”？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T20:40:11.220

```
Dispenser (amount_left + quarter_qty + dime_qty + nickel_qty + penny_qty); 
```

应该

```
Dispenser (amount_left, &quarter_qty, &dime_qty, &nickel_qty, &penny_qty); 
```

# verilog - verilog：如何添加参数

> ID：15121873
> 
> 赞同：3
> 
> 时间：2013-02-27T20:36:16.550
> 
> 标签：verilog, xilinx

我想要参数化模块。它有以下定义：

```
module example (...);
    parameter A = 2;
    parameter B = 2;
    parameter C = A + B;

endmodule 
```

但是，当我打印出参数值时，我得到 A = 2、B = 2 和 C = 1...任何想法为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T20:49:04.090

找到了解决方案 - 使用 localparam。

```
module example (...);
  parameter A = 2;
  parameter B = 2;
  localparam C = A + B;

endmodule 
```

# c#-4.0 - 如何在 ASP.Net MVC 中使用 PdfSharp 显示 PDF？

> ID：15121876
> 
> 赞同：8
> 
> 时间：2013-02-27T20:36:29.407
> 
> 标签：c#-4.0, asp.net-mvc-4, pdfsharp

我们正在制作一个 ASP.Net MVC 应用程序，该应用程序需要能够生成 PDF 并将其显示到屏幕上或将其保存在便于用户访问的位置。我们正在使用 PdfSharp 生成文档。完成后，我们如何让用户保存文档或在阅读器中打开它？我特别困惑，因为 PDF 是在服务器端生成的，但我们希望它显示在客户端。

* * *

这是创建我们迄今为止编写的报告的 MVC 控制器：

```
public class ReportController : ApiController
{
    private static readonly string filename = "report.pdf";

    [HttpGet]
    public void GenerateReport()
    {
        ReportPdfInput input = new ReportPdfInput()
        {
            //Empty for now
        };

        var manager = new ReportPdfManagerFactory().GetReportPdfManager();
        var documentRenderer = manager.GenerateReport(input);
        documentRenderer.PdfDocument.Save(filename); //Returns a PdfDocumentRenderer
        Process.Start(filename);
    }
} 
```

当它运行时，我得到一个`UnauthorizedAccessException`说`documentRenderer.PdfDocument.Save(filename);`，`Access to the path 'C:\Program Files (x86)\Common Files\Microsoft Shared\DevServer\10.0\report.pdf' is denied.`我也不确定`Process.Start(filename);`执行该行时会发生什么。

这是中的代码`manager.GenerateReport(input)`：

```
public class ReportPdfManager : IReportPdfManager
{
    public PdfDocumentRenderer GenerateReport(ReportPdfInput input)
    {
        var document = CreateDocument(input);
        var renderer = new PdfDocumentRenderer(true, PdfSharp.Pdf.PdfFontEmbedding.Always);
        renderer.Document = document;
        renderer.RenderDocument();

        return renderer;
    }

    private Document CreateDocument(ReportPdfInput input)
    {
        //Put content into the document
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-28T20:34:11.477

使用 Yarx 的建议和 PDFsharp Team 的教程，这是我们最终得到的代码：

控制器：

```
[HttpGet]
public ActionResult GenerateReport(ReportPdfInput input)
{
    using (MemoryStream stream = new MemoryStream())
    {
        var manager = new ReportPdfManagerFactory().GetReportPdfManager();
        var document = manager.GenerateReport(input);
        document.Save(stream, false);
        return File(stream.ToArray(), "application/pdf");
    }
} 
```

报告PDF管理器：

```
public PdfDocument GenerateReport(ReportPdfInput input)
{
    var document = CreateDocument(input);
    var renderer = new PdfDocumentRenderer(true,
        PdfSharp.Pdf.PdfFontEmbedding.Always);
    renderer.Document = document;
    renderer.RenderDocument();

    return renderer.PdfDocument;
}

private Document CreateDocument(ReportPdfInput input)
{
    //Creates a Document and puts content into it
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-27T22:02:35.990

我不熟悉 PDF 锐化，但 MVC 主要是通过内置功能完成的。您需要将您的 pdf 文档表示为字节数组。然后，您只需使用 MVC 的 File 方法将其返回给浏览器并让它处理下载。他们的班级有什么方法可以做到这一点吗？

```
public class PdfDocumentController : Controller
{
    public ActionResult GenerateReport(ReportPdfInput input)
    {
        //Get document as byte[]
        byte[] documentData;

        return File(documentData, "application/pdf");
    }

} 
```

# c# - 无效的猫异常

> ID：15121877
> 
> 赞同：0
> 
> 时间：2013-02-27T20:36:33.210
> 
> 标签：c#

在向数据库输入数据后，我试图从数据库中“获取”ID 字段 (PK)。获得 ID 后，我想将其输入到另一个表中（出于关系目的）。但是，我的尝试没有成功。

这就是我目前正在做的事情：

```
int CompanyID;  

SqlConnection con = new SqlConnection("Data Source=******;Initial Catalog= ********");
SqlCommand cmd = con.CreateCommand();

con.Open();

cmd.CommandText = "insert into [Company Information] (Expo_Year, Partnership, Company_Name_Pub, Address_Pub, City_Pub, State_Pub, Zip_Pub, Phone_Pub, Fax_Pub, Email_Pub, Contact_Pub, Company_Name_Ex, Address_Ex, City_Ex, State_Ex, Zip_Ex, Phone_Ex, Fax_Ex, Email_Ex, Contact_Ex) VALUES (@Year, @Partnership,@PubCompanyName,@PubAddress,@PubCity,@PubState,@PubZip,@PubPhone,@PubFax,@PubEmail,@PubContact,@ExCompanyName,@ExAddress,@ExCity,@ExState,@ExZip,@ExPhone,@ExFax,@ExEmail,@ExContact) SELECT SCOPE_IDENTITY();";

SqlParameter param = new SqlParameter();
param.ParameterName = "@PubCompanyName";
param.Value = CompanyNmTxt.Text;

cmd.Parameters.Add("@Year", System.Data.SqlDbType.VarChar, 50).Value = Year.Text;
cmd.Parameters.Add("@Partnership", System.Data.SqlDbType.VarChar, 50).Value = DropDownList1.Text;
cmd.Parameters.Add("@PubCompanyName", System.Data.SqlDbType.VarChar,50).Value = CompanyNmTxt.Text;
cmd.Parameters.Add("@PubAddress", System.Data.SqlDbType.VarChar,50).Value = CompanyAddTxt.Text;
cmd.Parameters.Add("@PubCity", System.Data.SqlDbType.VarChar,50).Value = CompanyCtyTxt.Text;
cmd.Parameters.Add("@PubState", System.Data.SqlDbType.Char,2).Value = StateDD.Text;
cmd.Parameters.Add("@PubZip", System.Data.SqlDbType.Int,8).Value = CompanyZipTxt.Text;
cmd.Parameters.Add("@PubPhone", System.Data.SqlDbType.VarChar,50).Value = CompanyPhoneTxt.Text;
cmd.Parameters.Add("@PubFax", System.Data.SqlDbType.VarChar,50).Value = CompanyFaxTxt.Text;
cmd.Parameters.Add("@PubEmail", System.Data.SqlDbType.VarChar,50).Value = CompanyEmailTxt.Text;
cmd.Parameters.Add("@PubContact", System.Data.SqlDbType.VarChar,50).Value = CompanyContactTxt.Text;

cmd.Parameters.Add("@ExCompanyName", System.Data.SqlDbType.VarChar, 50).Value = ExCompanyNmTxt0.Text;
cmd.Parameters.Add("@ExAddress", System.Data.SqlDbType.VarChar, 50).Value = ExCompanyAddTxt0.Text;
cmd.Parameters.Add("@ExCity", System.Data.SqlDbType.VarChar, 50).Value = ExCompanyCtyTxt0.Text;
cmd.Parameters.Add("@ExState", System.Data.SqlDbType.Char, 2).Value = ExStateDD.Text;
cmd.Parameters.Add("@ExZip", System.Data.SqlDbType.Int, 8).Value = ExCompanyZipTxt0.Text;
cmd.Parameters.Add("@ExPhone", System.Data.SqlDbType.VarChar, 50).Value = ExCompanyPhoneTxt0.Text;
cmd.Parameters.Add("@ExFax", System.Data.SqlDbType.VarChar, 50).Value = ExCompanyFaxTxt0.Text;
cmd.Parameters.Add("@ExEmail", System.Data.SqlDbType.VarChar, 50).Value = ExCompanyEmailTxt0.Text;
cmd.Parameters.Add("@ExContact", System.Data.SqlDbType.VarChar, 50).Value = ExCompanyContactTxt0.Text;

CompanyID = (int)cmd.ExecuteScalar(); 
con.Close(); 
```

我得到错误：

> 用户代码未处理 InvalidCastException；指定的演员表无效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:43:10.660

对我来说很明显的事情是您将邮政编码存储为整数。它们确实应该是字符串（因为前导零是有效的）。这条线可能是罪魁祸首：

```
cmd.Parameters.Add("@PubZip", System.Data.SqlDbType.Int,8).Value = CompanyZipTxt.Text; 
```

您可能想尝试以下方式：

```
int companyZip;
Int32.TryParse(CompanyZipTxt.Text, out companyZip);

cmd.Parameters.Add("@PubZip", System.Data.SqlDbType.Int, 8).Value = companyZip; 
```

您还有其他几行具有类似问题的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:55:46.313

从[ExecuteScalar 的文档中](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)：

> 返回值 类型：System.Object 结果集中第一行的第一列，如果结果集为空，则为空引用（在 Visual Basic 中为 Nothing）。返回最多 2033 个字符。

表格的第一列是什么？（大概是您的 CompanyId 列。）它是 uniqueId 吗？那将转换为 Guid，而不是 int。

# c++ - 用 VS2010 构建的可执行文件不是有效的 win32 应用程序；bindump 说它是一个 DLL

> ID：15121878
> 
> 赞同：0
> 
> 时间：2013-02-27T20:36:33.793
> 
> 标签：c++, visual-studio-2010, dll, exe, fftw

我一直在制作一个涉及 FFT 的 C++ 程序，在我决定使用 FFTW 之前它运行良好。从 .def 文件创建库并将它们链接到我的项目后，它构建成功。但是，当我尝试运行该应用程序时，它告诉我它不是一个有效的 win32 应用程序。在生成的文件上运行 dumpbin 会产生：

（见编辑）

关于问题可能是什么的任何想法？我希望它重新构建为可执行文件。

编辑：完整的垃圾箱：

```
PE signature found

File Type: DLL

FILE HEADER VALUES
             14C machine (x86)
               7 number of sections
        512E72CE time date stamp Wed Feb 27 14:55:42 2013
               0 file pointer to symbol table
               0 number of symbols
              E0 size of optional header
            2102 characteristics
                   Executable
                   32 bit word machine
                   DLL

OPTIONAL HEADER VALUES
             10B magic # (PE32)
           10.00 linker version
           1C000 size of code
           3A000 size of initialized data
               0 size of uninitialized data
           1229D entry point (1001229D) @ILT+4760(__DllMainCRTStartup@12)
            1000 base of code
            1000 base of data
        10000000 image base (10000000 to 10069FFF)
            1000 section alignment
             200 file alignment
            5.01 operating system version
            0.00 image version
            5.01 subsystem version
               0 Win32 version
           6A000 size of image
             400 size of headers
           59987 checksum
               3 subsystem (Windows CUI)
             140 DLL characteristics
                   Dynamic base
                   NX compatible
          100000 size of stack reserve
            1000 size of stack commit
          100000 size of heap reserve
            1000 size of heap commit
               0 loader flags
              10 number of directories
           30370 [   19818] RVA [size] of Export Directory
           4B000 [      A0] RVA [size] of Import Directory
           66000 [     1B4] RVA [size] of Resource Directory
               0 [       0] RVA [size] of Exception Directory
               0 [       0] RVA [size] of Certificates Directory
           67000 [    1EC0] RVA [size] of Base Relocation Directory
           2D620 [      1C] RVA [size] of Debug Directory
               0 [       0] RVA [size] of Architecture Directory
               0 [       0] RVA [size] of Global Pointer Directory
               0 [       0] RVA [size] of Thread Storage Directory
               0 [       0] RVA [size] of Load Configuration Directory
               0 [       0] RVA [size] of Bound Import Directory
           4E68C [    35EC] RVA [size] of Import Address Table Directory
               0 [       0] RVA [size] of Delay Import Directory
               0 [       0] RVA [size] of COM Descriptor Directory
               0 [       0] RVA [size] of Reserved Directory

SECTION HEADER #1
.textbss name
   10000 virtual size
    1000 virtual address (10001000 to 10010FFF)
       0 size of raw data
       0 file pointer to raw data
       0 file pointer to relocation table
       0 file pointer to line numbers
       0 number of relocations
       0 number of line numbers
E00000A0 flags
         Code
         Uninitialized Data
         Execute Read Write

SECTION HEADER #2
   .text name
   1BE65 virtual size
   11000 virtual address (10011000 to 1002CE64)
   1C000 size of raw data
     400 file pointer to raw data (00000400 to 0001C3FF)
       0 file pointer to relocation table
       0 file pointer to line numbers
       0 number of relocations
       0 number of line numbers
60000020 flags
         Code
         Execute Read

SECTION HEADER #3
  .rdata name
   1CB88 virtual size
   2D000 virtual address (1002D000 to 10049B87)
   1CC00 size of raw data
   1C400 file pointer to raw data (0001C400 to 00038FFF)
       0 file pointer to relocation table
       0 file pointer to line numbers
       0 number of relocations
       0 number of line numbers
40000040 flags
         Initialized Data
         Read Only

  Debug Directories

        Time Type       Size      RVA  Pointer
    -------- ------ -------- -------- --------
    512E72CE cv           7F 0002EA90    1DE90    Format: RSDS, {CC4D0BC3-853A-4
E8D-97A2-304A29035F04}, 4, C:\......

SECTION HEADER #4
   .data name
     7AC virtual size
   4A000 virtual address (1004A000 to 1004A7AB)
     400 size of raw data
   39000 file pointer to raw data (00039000 to 000393FF)
       0 file pointer to relocation table
       0 file pointer to line numbers
       0 number of relocations
       0 number of line numbers
C0000040 flags
         Initialized Data
         Read Write

SECTION HEADER #5
  .idata name
   1A611 virtual size
   4B000 virtual address (1004B000 to 10065610)
   1A800 size of raw data
   39400 file pointer to raw data (00039400 to 00053BFF)
       0 file pointer to relocation table
       0 file pointer to line numbers
       0 number of relocations
       0 number of line numbers
C0000040 flags
         Initialized Data
         Read Write

SECTION HEADER #6
   .rsrc name
     1B4 virtual size
   66000 virtual address (10066000 to 100661B3)
     200 size of raw data
   53C00 file pointer to raw data (00053C00 to 00053DFF)
       0 file pointer to relocation table
       0 file pointer to line numbers
       0 number of relocations
       0 number of line numbers
40000040 flags
         Initialized Data
         Read Only

SECTION HEADER #7
  .reloc name
    2593 virtual size
   67000 virtual address (10067000 to 10069592)
    2600 size of raw data
   53E00 file pointer to raw data (00053E00 to 000563FF)
       0 file pointer to relocation table
       0 file pointer to line numbers
       0 number of relocations
       0 number of line numbers
42000040 flags
         Initialized Data
         Discardable
         Read Only

  Summary

        1000 .data
       1B000 .idata
       1D000 .rdata
        3000 .reloc
        1000 .rsrc
       1C000 .text
       10000 .textbss 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-03T15:29:58.983

> 想通了，如果其他人有类似的问题：
> 
> 我正在链接`.exp`文件以及`.lib`文件；仅链接`.lib`文件并将`.dll`文件放在目录中即可解决问题。

# c# - 为解密查找加密

> ID：15121879
> 
> 赞同：0
> 
> 时间：2013-02-27T20:36:34.337
> 
> 标签：c#, encryption

我有遗留的 C# 代码，在代码中有一个加密的密码，解密它并使用它。我现在必须更改实际的源值，即`base64`字符串需要更改。

解密代码：

```
 var des = new TripleDESCryptoServiceProvider();
        var md5Hash = new MD5CryptoServiceProvider();

        des.Key = md5Hash.ComputeHash(Encoding.Unicode.GetBytes(...key...));
        des.Mode = CipherMode.ECB;

        var desDecrypt = des.CreateDecryptor();
        var buffer = Convert.FromBase64String(...value...);
        var result = Encoding.Unicode.GetString(desDecrypt.TransformFinalBlock(buffer, 0, buffer.Length));
        return result; 
```

我正在尝试对更改的值进行临时重新加密，如下所示：

```
 var des = new TripleDESCryptoServiceProvider();
        var md5Hash = new MD5CryptoServiceProvider();

        des.Key = md5Hash.ComputeHash(Encoding.Unicode.GetBytes(...key...));
        des.Mode = CipherMode.ECB;

        var desEncrypt = des.CreateEncryptor();
        var s = "...new value...";
        var b = Encoding.Unicode.GetBytes(s);
        desEncrypt.TransformFinalBlock(b, 0, b.Length);
        var x = Convert.ToBase64String(b); 
```

这给了我一个很好的`base64`价值来替换我的旧常量。但是，当代码尝试解密这个新值时，我得到一个

> System.Security.Cryptography.CryptographicException：要解密的数据长度无效。

源值的长度相同。base64 值的长度相同。我知道这不是经营铁路的方法。我只是希望我错过了一些明显、简单和/或愚蠢的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T21:13:43.483

看起来您实际上并没有使用 3DES 加密的输出：

```
var b = Encoding.Unicode.GetBytes(s);
// This returns the encrypted data, but you're not storing it anywhere
desEncrypt.TransformFinalBlock(b, 0, b.Length);
// b is still the original input, not the encrypted data
var x = Convert.ToBase64String(b); 
```

试试这个：

```
var b = Encoding.Unicode.GetBytes(s);
// Store encrypted data in "e"
var e = desEncrypt.TransformFinalBlock(b, 0, b.Length);
// Convert the encrypted data to base64
var x = Convert.ToBase64String(e); 
```

# c++ - QT5在每个源文件名中附加项目名称，编译错误

> ID：15121881
> 
> 赞同：2
> 
> 时间：2013-02-27T20:36:38.393
> 
> 标签：c++, qt, compiler-errors, qt5

我想开始使用 QT。我用 QT 创建器下载了 QT5 MINGW 编译器，我正在尝试构建名为***affine***的预附加示例，问题是我认为 QT5 将项目名称与每个源文件一起嵌入，因此给出了找不到文件的错误。相似的东西

```
 :-1: error: ..affinemain.cpp: No such file or directory 
```

而文件名只是

```
 main.cpp 
```

我不知道如何解决它。我在互联网上搜索了很多，但找不到任何有用的东西。我什至尝试从命令提示符编译，但我不熟悉命令提示符编译，因为我是 QT 新手，以前我完全使用 Visual Studio 中的 IDE 和 java 的 Eclipse 开发，所以我不知道 make 文件和编译器命令行参数。有人可以帮我解决这个问题吗，你能告诉我为什么编译器将项目名称与源文件名附加在一起吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T09:18:17.733

我遇到了同样的问题，我的解决方案可能会对您有所帮助。

我现在正在使用 Qt5.0.1，并且有两个发行版可以在 Windows 上使用它：Qt5.0.1-mingw 和 Qt5.0.1-msvc2010。我不得不使用 mingw，但我的设置存在一个问题，即路径中的“/”被忽略了。

所以根据Qt Creator，编译器被调用来处理文件mainwindow.cpp，这个文件被传递给它

```
g++ /*truncated*/ ..\qt-example\mainwindow.cpp 
```

以下是完整的编译器输入：

```
g++ -c -pipe -fno-keep-inline-dllexport -g -frtti -Wall -Wextra -fexceptions -mthreads -DUNICODE -DQT_QML_DEBUG -DQT_DECLARATIVE_DEBUG -DQT_WIDGETS_LIB -DQT_GUI_LIB -DQT_CORE_LIB -DQT_OPENGL_ES_2 -DQT_OPENGL_ES_2_ANGLE -DQT_NEEDS_QMAIN -I..\qt-example -I"..\..\..\..\..\..\Qt\Qt5.0.1\5.0.1\mingw47_32\include" -I"..\..\..\..\..\..\Qt\Qt5.0.1\5.0.1\mingw47_32\include\QtWidgets" -I"..\..\..\..\..\..\Qt\Qt5.0.1\5.0.1\mingw47_32\include\QtGui" -I"..\..\..\..\..\..\Qt\Qt5.0.1\5.0.1\mingw47_32\include\QtCore" -I"debug" -I"." -I"." -I"..\..\..\..\..\..\Qt\Qt5.0.1\5.0.1\mingw47_32\mkspecs\win32-g++" -o debug\mainwindow.o ..\qt-example\mainwindow.cpp 
```

并产生了错误。

```
g++.exe: error: ..qt-examplemainwindow.cpp: No such file or directory
g++.exe: fatal error: no input files
compilation terminated. 
```

因此，我们可以看到“\”被编译器忽略，文件名与目录名合并。

该问题的解决方案是使用的工具 - [MinGW](http://www.mingw.org/)（GCC 和 Binutils 的极简端口）。还有[MSYS](http://www.mingw.org/wiki/MSYS) - 一组 GNU 实用程序，例如 bash、make、gawk 和 grep，允许构建依赖于传统 UNIX 工具的应用程序和程序。在我们的例子中 - g++。

MSYS 没有随 Qt5.0.1-mingw 一起提供，g++ 也没有使用它，但是在 PATH 环境变量中提供 MSYS 会破坏系统。

MSYS[用于](http://msysgit.github.com/)我已安装的 git scm，因此我的路径包含与 git 捆绑的 MSYS 的链接。所以我的 PATH 环境变量中有下一条路径。

```
C:\Program Files (x86)\git\bin;C:\Program Files (x86)\git\cmd 
```

我还没有找到 Qt Creator 或 g++ 是如何使用 MSYS 的，也没有找到它的链接位置，但是当我从 PATH 中删除了下一个路径时：

```
C:\Program Files (x86)\git\bin; 
```

并重新启动 Qt Creator - g++ 成功编译了我的文件，它工作正常。为什么/如何影响不应使用与 git 一起安装的 MSYS utils 的 Qt Creator/g++ 的问题仍然存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-21T23:23:32.853

我不能评论。

重要：在尝试作者的提示之前删除发布和调试文件夹（编译版）中的所有文件...

# php - 获得数年数月数的最有效方法

> ID：15121884
> 
> 赞同：3
> 
> 时间：2013-02-27T20:36:42.623
> 
> 标签：php, monthcalendar

从指定日期到现在，按年份分组的月份数组的最有效方法是什么。

例如 getMonths("August 2012") 将输出

```
array(
    array("Year"=>"2013", "months" = array(
         "February", "January")
    ),
    array("Year"=>"2012", "months" = array(
         "December", "November","October", "September", "August")
    )
) 
```

到目前为止，我有：

```
$start = strtotime('2012-08-01');
$end = time();
$month = $start;
$months[] = date('F', $start);
while($month <= $end) {
  $month = strtotime("+1 month", $month);
  $months[] = date('F', $month);
} 
```

这是输出正确的月份，但没有将它们分组为年份。谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T20:43:47.147

你可以试试

```
function getMonths($month,$count = 1) {
    $now = new DateTime();
    $start = DateTime::createFromFormat("F Y", $month);
    $list = array();
    $interval = new DateInterval(sprintf("P%dM",$count));
    while ( $start <= $now ) {
        $list[$start->format("Y")][] = $start->format("F");
        $start->add($interval);
    }
    return $list;
}

print_r(getMonths("August 2012")); 
```

输出

```
Array
(
    [2012] => Array
        (
            [0] => August
            [1] => September
            [2] => October
            [3] => November
            [4] => December
        )

    [2013] => Array
        (
            [0] => January
            [1] => February
        )

) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-16T11:49:32.893

由于此处发布的答案对我不起作用（确定还尝试了在线沙箱），我编写了一个适用于大多数 PHP 版本的方法：

```
function getMonths($monat, $year) {
        $list = array();
        for(;$monat <= 12;$monat++) {
            if($year == date("Y") && $monat == date("m")) {     // exit on current month+year
                break;
            }
            if(!isset($list[ $year ])) {
                $list[ $year ] = array();
            }
            $list[ $year ][ str_pad($monat, 2, '0', STR_PAD_LEFT) ] = date("F", strtotime('01.' . $monat . '.' . $year));

            if($monat == 12) {
                $monat = 0;
                $year++;
            }
        }
        return $list;
    } 
```

# actionscript-3 - AS3 Key Down 事件监听器不起作用？

> ID：15121888
> 
> 赞同：0
> 
> 时间：2013-02-27T20:36:52.397
> 
> 标签：actionscript-3

我是使用 AS3 进行 OOP 编程的新手，我正在尝试创建一个侦听器，该侦听器会在按下按键时做出响应。

当我只是在时间线中输入它时它工作得很好，但是现在当它在它自己的包上时它根本没有响应，我做错了什么？

```
package{
    import flash.events.KeyboardEvent;
    import flash.display.Sprite;

    public class PlayerController extends Sprite{
        public function PlayerController(){
            addEventListener(KeyboardEvent.KEY_DOWN,onButDown);
        }
        function onButDown(event:KeyboardEvent):void{
            trace("Key Down");
        }
    }

} 
```

在主要课程中，我有这个：

```
var pc:PlayerController = new PlayerController(); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:56:25.363

您的问题可能是 PlayerController 的实例尚未获得焦点（并且永远不会，因为它看起来不像您将其添加到显示列表中）。如果一个对象没有焦点，它就不能接收键盘事件。

一种解决方案是在构造函数中传递对的引用`stage`，然后将事件侦听器添加到其中：

```
package
{
    import flash.events.KeyboardEvent;
    import flash.display.Sprite;

    public class PlayerController extends Sprite{
        public function PlayerController($stageRef:Stage){
            $stageRef.addEventListener(KeyboardEvent.KEY_DOWN,onButDown);
        }
        function onButDown(event:KeyboardEvent):void{
            trace("Key Down");
        }
    }

} 
```

然后，在您的主应用程序中：

```
var pc:PlayerController = new PlayerController(stage); 
```

编辑添加：这是假设`stage`不是`null`. `PlayerController`在以这种方式实例化之前，您需要确保这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:54:54.707

通常，您应该将所有事件侦听器及其调用的函数放在主类中。就这些。

# angularjs - AngularJS $scope 值没有更新

> ID：15121894
> 
> 赞同：0
> 
> 时间：2013-02-27T20:37:18.080
> 
> 标签：angularjs, angularjs-scope

我有一个用户可以登录的应用程序。登录后，视图分为 2 - 信息栏和主要部分。主要部分通过 ng-view 更新。未登录时，使用 ng-show 将信息栏从视图中隐藏，然后在登录后显示。目前，未登录时它会根据需要隐藏，但登录时不会显示。如果您查看下面的控制器，我希望成功登录`loginStatus.loggedIn`时等于用户名，因此真实，应该调用 ng-show。还是我弄错了？

代码简介：

**索引.html**

```
<body ng-controller="LoginStatus_control" ng-cloak>
    <div ng-show="loginStatus.loggedIn" class="infobar">
        You are logged in as {{username}}
        <button type="button" ng-click="logoutUser()">Logout</button>
    </div>

    <div class="main">
        <div ng-view></div>
    </div>
</body> 
```

**应用程序.js**

```
userApp.config(['$routeProvider', '$locationProvider', function($routeProvider, $locationProvider) {
    $routeProvider.
        when('/angular-app/app/', {templateUrl: 'partials/login_part.html'}).
        when('/angular-app/app/overview', {templateUrl: 'partials/overview_part.html', controller: 'Admin_control'}).
        when('/angular-app/app/users', {templateUrl: 'partials/users_part.html', controller: 'Users_control'}).
        otherwise({redirectTo: '/angular-app/app/'});
    $locationProvider.html5Mode(true);
}]);

userApp.factory('OAuth', ['$http', '$location', function($http, $location) {
return {
    login: function(rememberCheck, username) {
        if( rememberCheck === true ) {
            localStorage.loggedin = username;
        } else {
            sessionStorage.loggedin = username;
        }
        $location.path('/angular-app/app/overview');
    },

    logout: function() {
        localStorage.loggedin = null;
        sessionStorage.loggedin = null;
        $location.path('/angular-app/app/');
    },

    isLoggedIn: function() {
        if( (sessionStorage.loggedin !== 'null') || (localStorage.loggedin !== 'null') ) {
            if( sessionStorage.loggedin ) {
                return sessionStorage.loggedin;
            }
            else {
                return localStorage.loggedin;
            }
        } else {
            return false;
        }
    }
};
}]); 
```

**控制器.js**

```
userApp.controller( 'LoginStatus_control', function( $scope, $rootScope, $route, OAuth ) {
var user = OAuth.isLoggedIn();

$scope.loginStatus = {
    loggedIn: user
}
console.log($scope.loginStatus.loggedIn);
}); 
```

*编辑*

[这是Plunker](http://plnkr.co/edit/LFHLfbOFfEFDijaq5lnc)

# jquery - jqgrid 我可以标记行吗？

> ID：15121895
> 
> 赞同：0
> 
> 时间：2013-02-27T20:37:26.253
> 
> 标签：jquery, jqgrid, label, row, names

jqgrid 能够使用属性 colNames 标记列。我需要有一个项目的列标签和行标签。有没有办法用标签或标题替换行号？

我查看了 jqgrid 文档选项，但没有看到行名或有关行标题、标签等的任何内容。

# powershell - 格式化powershell的输出

> ID：15121896
> 
> 赞同：0
> 
> 时间：2013-02-27T20:37:26.283
> 
> 标签：powershell

我有这个脚本（如下），我需要格式化输出，以便它附加一个单词 + 日期。你能帮我吗？

```
Get-WmiObject -Class Win32_PerfFormattedData_W3SVC_WebService -ComputerName SERVERNAME | Where {$_.Name -eq "WEBURL"} | % {$_. CurrentConnections} 
```

我希望输出与此类似并附加，以免数据被覆盖。

（脚本输出）+“连接的用户”+日期/时间

**注意**我正在使用，`Export-Csv c:\scripts\log.txt -encoding "unicode" -force`但这并没有给出预期的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:33:13.207

尝试这个：

```
Get-WmiObject -Class Win32_PerfFormattedData_W3SVC_WebService -ComputerName SERVERNAME | 
    Where {$_.Name -eq "WEBURL"} | 
    Foreach {"$($_.CurrentConnections) connected users $(Get-Date)"} 
```

# ios - 覆盖 UIImage imageNamed - 我有什么选择？

> ID：15121901
> 
> 赞同：1
> 
> 时间：2013-02-27T20:37:43.523
> 
> 标签：ios, objective-c, uiimage, objective-c-category, imagenamed

基本上我的代码大量使用`[UIImage imageNamed]`默认情况下从应用程序包中获取图像。

现在，我希望从 Documents（或库或其他）深处的目录返回图像，而不是从主包返回。由于 imageNamed 调用的实例太多，我正在考虑为此目的扩展（读取替换） UIImage ImageNamed 实现。

我已经经历了[这个](https://stackoverflow.com/questions/12613673/how-to-override-a-method-in-frameworks-class-runtime)，但不能完全弥补我应该做什么，什么是最好的：

1.  制作一个 UIImage 的类别
2.  创建 UIImage 的子类
3.  方法混搭

我也不知道我是否需要处理@2x 图像。我当前的捆绑包包括其中的一堆，我想我的实现也必须处理它。但不确定如何。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T21:00:31.443

最干净、最优雅和最容易维护的长期解决方案是在 UIImage 上使用一个类别。在 UIImage 上定义一个自定义方法，然后使用 Find & Replace 将所有 imageNamed 调用替换为新方法。

不要使用 swizzling（它会引入奇怪的、未记录的错误）并且很难维护或调试。*（另外，如果你调配，它会在你*想使用 imageNamed 的默认实现的地方中断）。

无需为您尝试做的事情继承 UIImage 子类，因为您不需要实例方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T07:32:20.517

如果从文档目录中检索图像是唯一的问题，请尝试：

```
[UIimage imageWithContentsOfFile:yourFilePath]; 
```

//您可以使用这些方法来检索文件路径

```
- (NSString *) rootPath{
    return [NSSearchPathForDirectoriesInDomains(NSDocumentationDirectory, NSUserDomainMask, YES) lastObject];
}

- (NSString *) pathFoResourse : (NSString *) resourseName ofType: (NSString *)type{
    NSString *path = [[self rootPath] stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.%@", resourseName, type]];
    if (![[NSFileManager defaultManager] fileExistsAtPath:path]) {
        path = [[NSBundle mainBundle] pathForResource:resourseName ofType:type];
    }
    NSLog(@"**path:%@**", path);
    return path;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T21:04:49.473

最好和最简单的方法是使用类别。它使代码可读。子类在工作中可能会让你感到困惑 这个[问题](https://stackoverflow.com/questions/5339276/what-are-the-dangers-of-method-swizzling-in-objective-c)将向你解释为什么不使用 Method Swizzling

# algorithm - 解决平铺/拼图游戏的算法

> ID：15121903
> 
> 赞同：4
> 
> 时间：2013-02-27T20:37:46.573
> 
> 标签：algorithm, logic

我一直在考虑解决小谜题的算法。我在互联网和 stackoverflow 上发现了不同的算法，但它们在某些方面不能满足我的需求：

*   我的拼图只有一种颜色，上面没有图像/图案/...
*   零件的每个边缘都可以是 8 个选项之一，类似于图片上的它们（例如，您可以将零件描述为 ABCD、cdab、cBBb、ADcb）；没有更复杂的结构或类似的东西
*   我要解决的谜题不是很大，没有比 8x8 更大的谜题
*   角/egde 块没有特定的边缘，结果将不是一个干净的矩形
*   不是我所有的谜题都是可以解决的
*   零件可以旋转但不能转动
*   每个拼图部分都是独一无二的

[拼图零件示例](http://i.stack.imgur.com/kE5Cg.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T21:05:06.773

所以我的出发点只是蛮力 - 将第 0 块放在 (0,0) 位置，然后开始尝试 (0,1) 中的任何剩余部分，直到适合，然后移动到 (0,2)等。在任何步骤，如果没有适合该空间的棋子，请取出以前适合的棋子并尝试找到适合该正方形的新棋子。

我无法证明这一点，但我怀疑填充片段以使您更有可能评估具有 2 个约束的片段（即，而不是做更大的正方形，2x2、3x3、4x4，移出）将更快终止而不仅仅是做行。

它让我想起了那些 3x3 拼图，在这些拼图中你有方形的块，上面有动物的头和尾巴。一种优化是计算配对之间的不匹配 - 如果您拥有的`A`比您拥有的多得多，`a`那么您就会知道它`A`往往位于拼图的边缘，但是在 8x8 拼图中，您的边缘要少得多内部比率，因此差异不太可能有用，我也不知道将其集成到算法中。

（编辑）再想一想，我认为如果不存在解决方案，计数会让你早早出局。NxN 网格具有`2*N*(N-1)`必须满足的内部匹配。如果`min(A,a) + min(B,b) + min(C,c) + min(D,d) < 2*N*(N-1)`您知道不存在解决方案。

（编辑2）有abs（），我打算有min（）。哎呀。

# python - Python列表是单链表还是双链表？

> ID：15121905
> 
> 赞同：7
> 
> 时间：2013-02-27T20:37:58.063
> 
> 标签：python, list, complexity-theory, singly-linked-list, doubly-linked-list

我想知道使用 append() 构建的 Python v2.7 列表的复杂性顺序是什么？Python列表是双向链接的，因此它是恒定的复杂性，还是单链接的，因此是线性复杂性？如果它是单链接的，我如何在线性时间内从迭代中建立一个列表，该列表按从头到尾的顺序提供列表的值？

例如：

```
def holes_between(intervals):
  # Compute the holes between the intervals, for example:
  #     given the table: ([ 8,  9] [14, 18] [19, 20] [23, 32] [34, 49])
  #   compute the holes: ([10, 13] [21, 22] [33, 33])
  prec = intervals[0][1] + 1 # Bootstrap the iteration
  holes = []
  for low, high in intervals[1:]:
    if prec <= low - 1:
      holes.append((prec, low - 1))
    prec = high + 1
  return holes 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-27T20:39:48.540

python的时间复杂度`list.append()`是O(1)。请参阅Python Wiki 上的[时间复杂度列表。](http://wiki.python.org/moin/TimeComplexity)

在内部，python 列表是指针向量：

```
typedef struct {
    PyObject_VAR_HEAD
    /* Vector of pointers to list elements.  list[0] is ob_item[0], etc. */
    PyObject **ob_item;

    /* ob_item contains space for 'allocated' elements.  The number
     * currently in use is ob_size.
     * Invariants:
     *     0 <= ob_size <= allocated
     *     len(list) == ob_size
     *     ob_item == NULL implies ob_size == allocated == 0
     * list.sort() temporarily sets allocated to -1 to detect mutations.
     *
     * Items must normally not be NULL, except during construction when
     * the list is not yet visible outside the function that builds it.
     */
    Py_ssize_t allocated;
} PyListObject; 
```

向量根据`ob_item`需要通过过度分配调整大小，以提供附加的摊销 O(1) 成本：

```
/* This over-allocates proportional to the list size, making room
 * for additional growth.  The over-allocation is mild, but is
 * enough to give linear-time amortized behavior over a long
 * sequence of appends() in the presence of a poorly-performing
 * system realloc().
 * The growth pattern is:  0, 4, 8, 16, 25, 35, 46, 58, 72, 88, ...
 */
new_allocated = (newsize >> 3) + (newsize < 9 ? 3 : 6); 
```

这使得 Python 列出了[动态数组](http://en.wikipedia.org/wiki/Dynamic_array)。

# python - 从每一行中删除特定文本

> ID：15121914
> 
> 赞同：0
> 
> 时间：2013-02-27T20:38:24.013
> 
> 标签：python

我有一个这种格式的 txt 文件：

```
something text1 pm,bla1,bla1
something text2 pm,bla2,bla2
something text3 am,bla3,bla3
something text4 pm,bla4,bla4 
```

在我想保存的新文件中：

```
bla1,bla1
bla2,bla2
bla3,bla3
bla4,bla4 
```

我有这个，例如每行的前 10 个字符。我可以改变这个或任何其他想法吗？

```
with open('example1.txt', 'r') as input_handle:
    with open('example2.txt', 'w') as output_handle:
        for line in input_handle:
            output_handle.write(line[:10] + '\n') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:43:12.917

这就是该[`csv`](http://docs.python.org/2/library/csv.html)模块的用途。

```
import csv
reader = csv.reader(open('file.csv'))

for row in reader: print(row[1]) 
```

然后，您可以使用 shell 将文件的输出重定向到新文件，或者您可以执行以下操作而不是最后一行：

```
for row in reader:
    with open('out.csv','w+') as f:
        f.write(row[1]+'\n') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:46:07.073

如果格式是固定的：

```
with open('example1.txt', 'r') as input_handle:
    with open('example2.txt', 'w') as output_handle:
        for line in input_handle:
            if line:  # and maybe some other format check
                od = line.split(',', 1)
                output_handle.write(od[1] + "\n") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:50:05.900

这就是我的写法。

**蟒蛇 2.7**

```
import csv
with open('example1.txt', 'rb') as f_in, open('example2.txt', 'wb') as f_out:
    writer = csv.writer(f_out)
    for row in csv.reader(f_in):
        writer.write(row[-2:]) # keeps the last two columns 
```

**Python 3.x**（注意参数的差异`open`）

```
import csv
with open('example1.txt', 'r', newline='') as f_in:
    with open('example2.txt', 'w', newline='') as f_out:
        writer = csv.writer(f_out)
        for row in csv.reader(f_in):
           writer.write(row[-2:]) # keeps the last two columns 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T20:51:05.587

要从文件中删除第一个以“，”分隔的列：

```
first, sep, rest = line.partition(",")
if rest: # don't write lines with less than 2 columns
   output_handle.write(rest) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T20:46:03.890

尝试：

```
output_handle.write(line.split(",", 1)[1]) 
```

从[文档](http://docs.python.org/library/stdtypes.html#str.split)：

> `str.split([`*sep* `[,` *maxsplit*`]])`
> 
> 返回字符串中单词的列表，使用*sep*作为分隔符字符串。如果给定了*maxsplit*，则最多完成*maxsplit*拆分（因此，列表将最多`maxsplit+1`包含元素）。

# mysql - MySQL，行到列比较

> ID：15121917
> 
> 赞同：0
> 
> 时间：2013-02-27T20:38:27.733
> 
> 标签：mysql

我有两张桌子；第一个是基于国家区域和货物重量的定价。

```
country zone    0.5         1             1.5
a               $5.00        $6.00     $7.00 
b               $8.00        $9.00     $10.00 
c               $11.00   $12.00       $13.00 
d               $14.00   $15.00       $16.00 
```

所以在这个表中国家区域显示了货物来自哪些国家，0.5、1 和 1.5 是货物重量

第二个表有国家区域和货物的重量

```
country zone        Weight
a                   0.75 
b                   1.20 
c                   1.00 
d                   1.50 
```

所以我想要完成的是将第二个表中的国家区域和权重与第一个表中的国家区域和权重进行比较，并获得定价。我认为我的挑战在于，在第一个表中，权重列是数字，我不确定如何定义列以及如何将行与权重列进行比较。如果这令人困惑，这就是我想要完成的

```
country zone        Weight   Price
a                   0.75     $5.00 
b                   1.20     $9.00 
c                   1.00     $12.00 
d                   1.50     $16.00 
```

一些如何根据国家区域和重量加入这两个表，并得到价格。我不想使用 if 或 select case，因为权重可以达到 300，所以我最终可能不仅仅是 3 列，而是 500 或 600 列。

我非常感谢您的意见，如果我的问题令人困惑，我对此表示歉意。

谢谢

# spring - Spring OAuth2 Provider Client Authentication 401 not authorized error using CloudFoundry as client

> ID：15121922
> 
> 赞同：0
> 
> 时间：2013-02-27T20:38:49.160
> 
> 标签：spring, oauth-2.0, cloud-foundry

这个问题主要是针对 CloudFoundry 开发人员的。是否发生了一些变化，导致使用 spring social 的客户端应用程序无法使用基本客户端身份验证与托管 oauth2 提供程序的核心应用程序进行通信？当我在 tomcat 服务器上运行客户端应用程序时，一切正常。大约 2 周前，它还在一个 Cloudfoundry 微实例上工作。现在，我在核心应用程序的“../oath/token”处调用服务时收到 401 未经授权的错误。看看我指的是什么，我的应用程序是[http://www.metroseattlegamers.com](http://www.metroseattlegamers.com) 如果您单击顶部的“游戏”链接，它会将您带到一个单独的应用程序。[如果您使用http://gamerepository.metroseattlegamers.com](http://gamerepository.metroseattlegamers.com)上的应用程序登录，“使用 Metroseattlegamers 帐户登录”按钮使用自定义 spring 社交代码与我位于[http://www.metroseattlegamers.com](http://www.metroseattlegamers.com)的 spring oauth2 提供程序代码进行通信。这一切都很好，因为它在不同机器上的两个单独的 tomcat 服务器上运行。但是，我使用 cloudfoundry 微实例测试并编写了所有内容来运行客户端应用程序。正如我所说，它大约在一周或两周前开始工作。现在，当我在 cloudfoundry 实例上运行客户端时出现 401 错误。当我在不同的机器上运行两个独立的 tomcat 服务器时，一切仍然很好。与其包含一堆代码，我只是好奇在过去一两周内，cloudfoundry 微实例的工作方式是否发生了任何变化，这可能导致了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T09:01:33.377

据我所知没有。您是否可以在官方支持页面提交工单：http: [//support.cloudfoundry.com](http://support.cloudfoundry.com)。在那里，您可以获得私人代理来协助并可能分享您的应用程序的实施以进一步调试。您需要使用您在 www.cloudfoundry.com 上注册的帐户登录。

# android - 是否可以以不区分大小写的方式匹配意图过滤器的 pathPattern？

> ID：15121925
> 
> 赞同：3
> 
> 时间：2013-02-27T20:38:56.157
> 
> 标签：android, android-intent

我们有一个可以打开某些类型文件的 android 应用程序。我已经在 AndroidManifest.xml 文件中为每个这样声明了一个意图过滤器（示例扩展名：ext）：

```
 <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />

            <data android:scheme="file" android:host="*" android:mimeType="*/*" android:pathPattern=".*\\.ext"/>

        </intent-filter> 
```

打开诸如 之类的文件时一切都很好`myFile.ext`，但是如果文件被命名为`myFile.EXT`或`myFile.ExT`等，则意图过滤器似乎无法拾取它。除了枚举意图过滤器中所有可能的大写排列之外，还有没有办法指定不区分大小写的匹配？

[此处](http://developer.android.com/guide/topics/manifest/data-element.html)的文档提到数据元素的其他属性区分大小写，但没有提及 pathPattern。我尝试将不区分大小写的正则表达式的 java 指令添加到模式中，这会导致`"(?i).*\\.ext"`多重或 OR'ing 在一起，`".*\\.ext|.*\\.EXT"`但这似乎也不起作用。

我将不胜感激任何帮助或建议。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:49:59.273

`android:pathPattern`不是一个完整的正则表达式。这是一个“[简单的 glob](http://developer.android.com/reference/android/os/PatternMatcher.html#PATTERN_SIMPLE_GLOB) ”，它只支持正则表达式的一小部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-03T01:39:02.357

我遇到了同样的问题，我达到的最佳解决方案是两次重复相同的数据属性，但`pathPatthern`覆盖所有情况略有不同。

在你的情况下：

```
<data android:scheme="file" android:host="*" android:mimeType="*/*" android:pathPattern=".*\\.ext"/>
<data android:scheme="file" android:host="*" android:mimeType="*/*" android:pathPattern=".*\\.Ext"/>
<data android:scheme="file" android:host="*" android:mimeType="*/*" android:pathPattern=".*\\.eXt"/>
<data android:scheme="file" android:host="*" android:mimeType="*/*" android:pathPattern=".*\\.exT"/>
<data android:scheme="file" android:host="*" android:mimeType="*/*" android:pathPattern=".*\\.EXt"/>
<data android:scheme="file" android:host="*" android:mimeType="*/*" android:pathPattern=".*\\.eXT"/>
<data android:scheme="file" android:host="*" android:mimeType="*/*" android:pathPattern=".*\\.ExT"/>
<data android:scheme="file" android:host="*" android:mimeType="*/*" android:pathPattern=".*\\.EXT"/> 
```

# ios - 再次调用 ViewDidLoad 方法

> ID：15121926
> 
> 赞同：3
> 
> 时间：2013-02-27T20:39:01.080
> 
> 标签：ios, xcode, viewdidload

我有两个视图控制器。首先我做了一些事情，然后我可以通过单击一个按钮（与故事板中的另一个 ViewController 连接的按钮）来推动第二个 View Controller。在那里我可以做一些设置等等。我用“完成”按钮回到第一个视图控制器。但是随后再次调用 ViewDidLoad 方法，所有“东西”（文本字段中的文本，...）都消失了。

我希望你们能理解我的问题。

为什么？我怎样才能禁用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T21:06:03.883

你如何从第二个视图控制器返回到第一个视图控制器？我认为你的问题是当用户点击“完成”时你正在重新实例化第一个视图控制器。

相反，您应该使用“popViewControllerAnimated”或“dismissViewControllerAnimated”返回到第一个视图控制器。

例如：（这两个之一应该工作）：

```
[self.navigationController popViewControllerAnimated:YES];
[self dismissViewControllerAnimated:YES completion:nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T21:18:00.480

可能`firstViewController`因为收到内存警告而被卸载。所以当它再次打开时，它会调用`ViewDidLoad`

# java - 如何将 pom.xml 转换为 build.xml

> ID：15121928
> 
> 赞同：-2
> 
> 时间：2013-02-27T20:39:09.137
> 
> 标签：java, maven, ant

我是这个地区的新蜜蜂。

在 pom.xml 中有一个部分，如下所示，我需要在 ant buid.xml 中进行更改。

我该怎么做？我可以从教程中获得任何帮助，或者任何人都可以解释什么

```
<dependency>
    <groupId>com.ask.core</groupId>
    <artifactId>wzlogging</artifactId>
    <version>1.5</version>
    <exclusions>
        <exclusion>
            <groupId>javax</groupId>
            <artifactId>javaee-api</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.glassfish.extras</groupId>
            <artifactId>glassfish-embedded-all</artifactId>
        </exclusion>
    </exclusions>
</dependency> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:52:52.463

理论上可以生成一个 ANT 构建文件（使用 XSLT？），但需要了解每个插件实现的逻辑。在实践中，只有简单的 Maven 构建是可行的候选者。

ANT 和 Maven 是非常不同的构建技术。在 ANT 中，您将所有构建逻辑显式写入“build.xml”文件。另一方面，Maven 包含了它的大部分功能。“pom.xml”不包含任何逻辑，而是用于记录有关项目的元信息（例如依赖项列表）。

来自 ANT 世界，这可能非常令人困惑，尤其是当您想要自定义构建时。在 Maven 中，这是通过声明插件来完成的，插件了解标准构建生命周期并能够将自己插入到构建的正确部分。

这个冗长的解释的目的是要理解，仅仅通过查看 POM 文件是不可能知道你的插件在做什么的。

@Perception 推荐常春藤。以下答案是相关的（从 ANT 转换为 Maven）：

*   [将 Ant Web 应用程序项目转换为 Maven 项目](https://stackoverflow.com/questions/15083245/converting-ant-web-application-project-to-maven-project/15098916#15098916)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:53:14.487

Maven 和 ant 是非常不同的工具。

Ant 主要是一个构建工具，这意味着它知道如何编译和打包源代码并运行测试，但没有管理项目依赖项的能力。Ant 使用 build.xml 文件来定义在哪里可以找到源代码以及构建项目要采取的步骤。

Maven 不仅仅是一个构建工具，它还是一个项目管理工具。它允许您在 pom.xml 项目定义中定义依赖关系，以及构建、测试和分发应用程序。它还允许子项目、父项目，并且存在许多用于许多其他功能的插件。Maven 会自动下载依赖关系并管理项目之间的这些依赖关系。

简单地说，不可能只将 Maven POM 项目转换为 Ant 构建。

有一些替代方案允许在 ant 构建中使用二进制 maven 依赖项。例如，看看[Ivy 依赖管理器](http://ant.apache.org/ivy/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-07T18:12:35.007

Maven 有一个有用的 Ant 插件，可以轻松地从 Maven pom.xml 生成 Ant 构建文件。使用这个 maven 目标：mvn ant:ant。

在 Eclipse 中：Simple 为 Maven 构建生成另一个运行配置。将其命名为“Antfile 生成”。在“目标”字段中输入 ant:ant。将这些更改应用于您的新运行配置。键入 run 开始构建。在控制台日志中，您会收到一条消息

[INFO] 将 PROJECTNAME 的 Ant 项目写入 .

# c# - 使用 await 方法的 foreach

> ID：15121931
> 
> 赞同：0
> 
> 时间：2013-02-27T20:39:33.950
> 
> 标签：c#, async-await

此代码检查与套接字连接的 2 个客户端，其中一个首先按下按钮，连接和接收工作正常，但如果我单击 deelnemersTimer 和客户端字典中第二个客户端的按钮，它什么也不做，它会一直等到我点击字典中的第一个。我很确定这是错误的 foreach 中的等待，但是我需要更改什么才能使其正常工作？

clients 是一个包含客户端名称及其套接字的字典。deelnemersTimers 是一个字典，其中包含客户端名称和他们单击按钮的时间。deelnemer 也是荷兰语的参与者。

```
foreach (Deelnemer deelnemer in deelnemers)
{
    deelnemersTimer[deelnemer.DeelnemerVoornaam + " " + deelnemer.DeelnemerNaam] = await CheckButtons(clients[deelnemer.DeelnemerVoornaam + " " + deelnemer.DeelnemerNaam]);
}
deelnemersTimer.Values.Min();
var eerste = deelnemersTimer.Where(p => p.Value == deelnemersTimer.Values.Min()).Select(p => p.Key).FirstOrDefault(); 
```

```
private async Task<long> CheckButtons(StreamSocket socket)
{
    DataReader reader = new DataReader(socket.InputStream);

    var actualStringLength = await reader.LoadAsync(1);
    long time = stopwatch.ElapsedMilliseconds;

    return time;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:06:29.887

代码完全按照您的要求执行：对于每个连接，（异步）等待按钮单击该连接。

如果你想监听一个按钮同时点击*所有*连接，你可以这样做：

```
var buttonTasks = deelnemers.Select(deelnemer => CheckButtons(clients[deelnemer.DeelnemerVoornaam + " " + deelnemer.DeelnemerNaam]));
var buttonsClicked = await Task.WhenAll(buttonTasks); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:29:18.243

您可以通过创建另一个可以设置的方法`deelnemersTimer`，`eerste`然后在没有`await`ing 的情况下调用该方法（至少不是立即）来做到这一点：

```
private Task ProcessButton(Deelnemer deelnemer)
{
   string id = deelnemer.DeelnemerVoornaam + " " + deelnemer.DeelnemerNaam;
   deelnemersTimer[id] = await CheckButtons(clients[id]);

   // is this the first one?
   if (eerste == null)
       eerste = id;
}

…

var tasks = deelnemers.Select(ProcessButton);
await Task.WhenAll(tasks); 
```

（这假设两者`deelnemersTimer`都是`eerste`字段。）

这样，您可以同时开始处理每个按钮，并在它们完成时设置结果。

# php - 等号后从 URL 获取最后一个单词

> ID：15121932
> 
> 赞同：1
> 
> 时间：2013-02-27T20:39:35.217
> 
> 标签：php

我找不到这个问题的解决方案。我有这个 URL `http://examplesite.com/?skill-type=new` ，我想得到 = 符号后的最后一个词，只使用 PHP。“技能类型”始终保持不变提前谢谢:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:41:54.873

这个片段应该做：

```
$url = 'http://examplesite.com/?skill-type=new';
$skillType = explode('&', parse_url($url, PHP_URL_QUERY))['skill-type']; 
```

检查[parse_url](http://php.net/parse_url)以获取更多详细信息。

如果您的意思是请求进入该特定 url，只需使用`$_REQUEST['skill-type']`检索该值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:46:45.897

考虑到您已经在变量中有 URL，假设

```
$url = 'http://examplesite.com/?skill-type=new; 
```

一种可能的方法（当然还有其他方法）是：

```
$urlArray = explode('=',$url);
$last = $urlArray[sizeof($urlArray)-1]; 
```

注意：仅适用于您不知道 URL 是如何来的，如果您知道，请考虑使用 $_GET

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:41:46.420

使用 PHP $_GET 全局变量

```
$skill_type = $_GET['skill-type']; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T20:41:57.177

PHP 会自动`GET`为你解析变量。要访问`skill-type`变量的值，您只需要使用`$_GET['skill-type']`. 例如：

```
echo $_GET['skill-type']; 
```

将显示

```
new 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T20:43:59.813

通过 $_SERVER 变量生成您的 url，然后像这样拆分它

```
$url = "http://examplesite.com/?skill-type=new";
$array = explode("=", $url);
$last_word = $array[1]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T20:45:54.250

使用 substr (url, posstr (url,'=')+1) 或者如果这是正在加载的页面 $_GET ['skill-type']

# java - 数组的奇怪输出

> ID：15121934
> 
> 赞同：0
> 
> 时间：2013-02-27T20:39:52.873
> 
> 标签：java, arrays

我遇到了一个似乎很有趣的错误......

对于我的一个课程，我需要编写一个程序来模拟旧的“x 名学生每隔 x 间隔沿着走廊关闭储物柜”场景。然而，一个有趣的转折是，这个问题要求学生和储物柜的数量相等，最多 100 个。所以我决定使用一个数组，用户在其中输入一个数字 - 然后用于设置数组大小， for-loop 条件等等等等……你明白了吧？

无论如何，我的代码可以编译，但是在运行时它会输出如下内容：

```
[I@36ae2282 
```

有人（在另一个线程/问题/无论你怎么称呼它）说这是数组在系统内存中的物理位置，并且要从数组中获取实际数字，`.getNums()`需要该方法。我的问题是：`.getNums()`Java 中似乎不存在该方法（也许它是另一种语言的一部分？），那么下一个最佳替代方案或解决方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T20:41:50.290

您正在打印出 int 数组，这是传统数组的 .toString() 表示。您可能希望改用[`Arrays.toString()`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#toString%28int%5b%5d%29)外观更好的输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:48:20.043

要打印数组的内容，请遍历数组中的每个元素：

```
int[] array = new int[10];

for(int s : array) System.out.println(s);
// or
for(int i = 0; i < array.length; i++) System.out.println(array[i]); 
```

或使用[`Arrays.toString()`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#toString%28int%5b%5d%29)：

```
int[] array = new int[10];
System.out.println(Arrays.toString(array)); 
```

这将打印如下内容：

```
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
```

* * *

> 无论如何，我的代码可以编译，但是在运行时它会输出如下内容：
> 
> ```
> [I@36ae2282 
> ```

我假设您正在尝试像这样打印数组：

```
int[] array = new int[10];
System.out.println(array); 
```

`array`是一个对象，因此您正在调用[`println(Object)`](http://docs.oracle.com/javase/7/docs/api/java/io/PrintStream.html#println%28java.lang.Object%29)( [`PrintStream`](http://docs.oracle.com/javase/7/docs/api/java/io/PrintStream.html)) `System.out`，它`toString()`在内部调用传递的对象。该数组`toString()`类似于[Object](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html)的[`toString()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#toString%28%29)：

```
getClass().getName() + "@" + Integer.toHexString(hashCode()); 
```

所以输出会是这样的：

```
[I@756a7c99 
```

其中`[`表示数组的深度，并`I`指`int`. `756a7c99`是[`hashCode()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#hashCode%28%29)作为十六进制数返回的值。

另请阅读[`Class.getName()`JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getName%28%29)。

# c - scanf 使用制表符和换行符缓冲

> ID：15121941
> 
> 赞同：1
> 
> 时间：2013-02-27T20:40:32.313
> 
> 标签：c

我对 scanf 在处理空格时的行为感到困惑。

这是我正在使用的代码：

```
int main()
{
  int val;
  int c;

  scanf("%d\t", &val);

  c = getchar();

  if(c == EOF)
    printf("eof");
  else if(c == '\t')
    printf("tab");
  else if(c == '\n')
    printf("newline");
} 
```

这是我要传递的输入：

```
1234<tab><newline> 
```

我希望这会打印“换行符”，因为 scanf 只是在寻找标签，并且默认情况下 scanf 在缓冲区中留下空白。相反，它打印“eof”。`%d\t`似乎正在吞噬换行符。

我是否缺少有关 scanf 工作原理的信息？

请注意，如果我将其更改为以下内容，它会正确打印“换行符”：

```
int main()
{
  int val;
  int c;

  scanf("%d", &val);

  getchar(); /* note this extra getchar */

  c = getchar();

  if(c == EOF)
    printf("eof");
  else if(c == '\t')
    printf("tab");
  else if(c == '\n')
    printf("newline");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:43:58.557

*模式 ( `\t`) 中的*任意*数量的空白与输入 ( ) 中的*任意*`\t\n`数量的空白匹配。*

 *从手册页：

```
White space (such as blanks, tabs, or newlines) in the format string match any amount of white space, including none, in the input. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:48:33.493

您遇到了一个更臭名昭著的为什么[`*scanf`不应该使用](https://stackoverflow.com/questions/9134208/input-by-using-gets-function/9134440#9134440)的原因：令人困惑的空白处理。您的`'\t'`不只是匹配单个选项卡，它匹配*任意数量的任何类型的空格*，包括换行符！

做这种事情的最好方法，假设你有[`getline`](http://linux.die.net/man/3/getline)，看起来像这样：

```
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    char *line = 0;
    char *p;
    long val;

    (void) getline(&line, 0, stdin);

    val = strtol(line, &p, 10);
    if (*p == '\0')
        puts("eof (no tab)");
    else {
        if (*p != '\t')
            printf("no tab, %c instead\n", *p);
        p++;
        if (*p == '\0')
            puts("eof");
        else if (*p == '\t')
            puts("tab");
        else if (*p == '\n')
            puts("newline");
    }

    free(line);
    return 0;
} 
```

如果你没有`getline`，[`fgets`](http://linux.die.net/man/3/getline)通常就足够了。（警告：不要`fgets`与`gets`. 混淆`gets`是危险的，永远不应该使用，但`fgets`如果你希望你的程序在面对超长的输入行时保持健壮，这只会带来不便。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T20:45:21.673

“我对 scanf 在处理空格时的行为感到困惑。” 是一个普遍的主张！

如果格式字符串中有任何空格，它将消耗所有空格，因此“\t”匹配任何空格字符串。*

# c# - 具有自引用和嵌套菜单的 TreeMenu

> ID：15121945
> 
> 赞同：1
> 
> 时间：2013-02-27T20:40:35.500
> 
> 标签：c#, fluent-nhibernate, fluent-nhibernate-mapping

我需要**使用**.`NHibernate`

这是我想出的：

```
public class CategoryMap : ClassMap<Category>
{
    public CategoryMap()
    {
        Id(x => x.Id);
        Map(x => x.AppId);
        Map(x => x.Title);
        Map(x => x.MaxDepth).Default("3");
        Map(x => x.IsActive);
        References(x => x.Parent).LazyLoad().Column("ParentId");

        HasMany(x => x.ChildrenNodes)
            .LazyLoad()
            .KeyColumn("ParentId")
            .Cascade.All();

        Table("Category");
    }
}

public class Category : Node
{
    public virtual string AppId { get; set; }
    public override string Title { get; set; }
    public override int MaxDepth { get; set; }
    public virtual Category Parent { get; set; }
    public virtual IList<Category> ChildrenNodes { get; set; }
    public virtual bool IsActive { get; set; }
}

public abstract class Node
{
    public virtual long Id { get; set; }
    public abstract string Title { get; set; }
    public abstract int MaxDepth { get; set; }
} 
```

这是我的测试代码：

```
[Test]
    public void CreateTableInDb()
    {

        using (var db = new FileDatabase(DbFileLocation, true))
        {
            var categoryMenu = new Category
            {
                AppId = "1",
                MaxDepth = 3,
                IsActive = true,
                Title = "Services"
            };

            db.Create(categoryMenu);

            categoryMenu.ChildrenNodes = new List<Category>
            {
                new Category
                {
                    Title = "SubService-Level1",
                    Parent = categoryMenu,
                }
            };

            db.Update(categoryMenu);
        }
    } 
```

当我查看它正在创建的表格时，我只有一行，有空`ParentId`列。

我该如何解决它以及我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T12:40:52.197

*   首先你会错过`.Inverse()`hasman。就目前而言，它将保存并更新 parentId 两次
*   所有集合都应该是只读的。NHibernate 将用您丢弃的跟踪和延迟加载集合替换它们。将代码更改为

    ```
    public class Category : Node
    {
        public Category()
        {
            // best practice so that nobody has to null check the collection
            ChildrenNodes = new List<Category>();
        }
        public virtual IList<Category> ChildrenNodes { get; private set; }

        public void Add(Category subcategory)
        {
            subcategory.Parent = this;
            ChildrenNodes.Add(subcategory);
        }
    }

    // in testcode
    categoryMenu.Add(new Category { Title = "SubService-Level1" }); 
    ```

# c++ - Netbeans 中的 QtApplication：“未连接到 D-Bus 服务器”

> ID：15121946
> 
> 赞同：1
> 
> 时间：2013-02-27T20:40:39.630
> 
> 标签：c++, qt, netbeans

我在 QtCreator 中创建了简单的 QtGui 应用程序。有用。然后我在 Netbeans 中创建了 QtApplication，并将 Creator 中生成的文件（mainwindow.h、cpp、ui_mainwindow.h）添加到新的 Netbeans 项目中。它编译、链接、构建。当我尝试运行可执行文件时，会出现该窗口，但也有此消息：

> root@comp:~/NetBeansProjects/QtApplication_3/dist/Debug/GNU-Linux-x86# ./QtApplication_3 Qt at-spi：获取可访问性 dbus 地址时出错：“未连接到 D-Bus 服务器”未找到可访问性 DBus。回退到会话总线。无法连接到 DBus。无法连接到 dbus。
> 
> （进程：10309）：GConf-WARNING **：客户端无法连接到 D-BUS 守护进程：没有收到回复。可能的原因包括：远程应用程序未发送回复、消息总线安全策略阻止回复、回复超时或网络连接中断。
> 
> ** (QtApplication_3:10309)：警告**：无法创建 Ubuntu 菜单代理：连接已关闭 root@ubuntuamd:~/NetBeansProjects/QtApplication_3/dist/Debug/GNU-Linux-x86#

这与网络连接有什么关系？这只是窗口。我的方法可以复制在 Creator 中生成的代码吗？也许那我还需要做一些额外的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:55:35.817

[在这里](http://ubuntuforums.org/showthread.php?t=1862995)我找到了一些关于这些错误的提示

# c# - utilSetResponseBody FiddlerCore 不做任何事情

> ID：15121947
> 
> 赞同：0
> 
> 时间：2013-02-27T20:40:39.740
> 
> 标签：c#, .net, fiddlercore

```
oSession.utilDecodeResponse();
            body = oSession.GetResponseBodyAsString();

            if (body.Contains("<body>"))
            {
                oSession.utilSetResponseBody(body.Replace("<body>", "<body><script src='a.js' type='text/javascript'/>")); 
```

这是在我的内部运行的确切代码

```
private void FiddlerApplication_BeforeResponse(Session oSession)
    { 
```

事件。
我可以使用调试器访问它，一切都很好，但是在 Internet Explorer 中，当我选择“查看源代码”时，什么都没有改变。
有谁知道我做错了什么？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T21:51:01.270

请看一下这个链接 [Fiddler's Streaming Mode](https://www.fiddler2.com/fiddler/help/streaming.asp)

所以你需要添加

```
FiddlerApplication.BeforeRequest += delegate(Fiddler.Session oSession)
{
    oSession.bBufferResponse = true;                
}; 
```

也请尝试使用

```
FiddlerApplication.BeforeResponse += delegate(Fiddler.Session oSession)
{
    oSession.utilDecodeResponse();
    String oBody = System.Text.Encoding.UTF8.GetString(oSession.responseBodyBytes);
    oBody = oBody.Replace("<body>", "<body><script src='a.js' type='text/javascript'/>");
    oSession.utilSetResponseBody(oBody);
}; 
```

问题是`body = oSession.GetResponseBodyAsString();`为我返回一个空字符串。希望这可以帮助。

# c++ - cin.get() 在循环中

> ID：15121948
> 
> 赞同：6
> 
> 时间：2013-02-27T20:40:42.407
> 
> 标签：c++, cin

我试图从标准输入中读取。第一行是我将阅读的行数。我接下来阅读的行将再次打印。这是代码：

```
#include <iostream>

using namespace std;

int main()
{
    int n;
    cin >> n;
    for (unsigned int i = 0; i < n; ++i)
    {
        char a[10];
        cin.get (a, 10);
        cout << "String: " << a << endl;
    }
    return 0;
} 
```

当我运行它并给出行数时，程序退出。我还没有弄清楚发生了什么，所以我决定在这里问一下。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T20:53:11.033

混合格式化和未格式化的输入充满了问题。在您的特定情况下，这一行：

```
std::cin >> n; 
```

消耗您输入的数字，但将 留`'\n'`在输入流中。

随后，这一行：

```
cin.get (a, 10); 
```

不消耗任何数据（因为输入流仍然指向`'\n'`）。出于同样的原因，下一次调用也不消耗任何数据，依此类推。

那么问题就变成了，“我如何消费`'\n'`？” 有几种方法：

您可以读取一个字符并将其丢弃：

```
cin.get(); 
```

无论长度如何，您都可以阅读一整行：

```
std::getline(std::cin, some_string_variable); 
```

您可以忽略当前行的其余部分：

```
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n'); 
```

作为一些相关的建议，我永远不会使用`std::istream::get(char*, streamsize)`. 我总是更喜欢：`std::getline(std::istream&, std::string&)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:53:18.920

添加`cin.get()`before`cin.get(a, 10)`将解决您的问题，因为它将读取输入流中剩余的 endline。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T20:51:12.453

我认为在使用 cin 时了解这一点很重要：[http ://www.cplusplus.com/forum/articles/6046/](http://www.cplusplus.com/forum/articles/6046/)

# javascript - 在本地范围内初始化 JavaScript 变量

> ID：15121950
> 
> 赞同：0
> 
> 时间：2013-02-27T20:40:47.297
> 
> 标签：javascript, scope

我正在研究 Javascript 中的变量作用域，并且遇到了变量声明和变量初始化之间的区别。通过与我认识的开发人员交谈，我的理解是，`var`在变量声明之前编写会将变量分配给本地范围，而`var`在声明变量之前不编写会将变量分配给全局范围。这是真的？

如果在声明变量之前写 var 确实将变量分配给本地范围，那么是否需要`var`稍后在初始化变量时将其保持在本地范围内？例如：

```
var someVariable;
// Do some things with JavaScript
someVariable = 'Some Value' 
```

既然我`someVariable`在局部作用域中用声明了`var`，然后又`someVariable`在没有使用的情况下进行了初始化`var`，那么 JavaScript 是否认为我只是在局部作用域中初始化了一个变量，或者我在局部作用域中声明了一个变量，然后在全局中声明*并*初始化了另一个变量范围？

稍后，当我想再次更改的值`someVariable`时，是否需要在变量表达式之前编写 var，或者 JavaScript 会知道我正在更改已声明的局部变量的值？从技术上讲，JavaScript 如何知道我何时更改已声明的局部变量的值，以及何时声明和初始化全局变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:45:53.373

```
var something = "Initial value." 
```

这意味着：“在本地范围内创建一个变量并给它一个初始值”。本地范围是指您在其中使用此语句的函数。

```
something = "New value." 
```

这意味着：“在最近的范围内找到变量'某物'，并为其分配一个新值”。如果您使用第二个语句而不使用第一个语句，该语句将`something`在逐渐更大的范围内查找任何定义（包含您的函数的函数，如果它存在，包含该函数的函数等，直到它到达全局范围）。如果它找到一些东西，它将分配给一个已经存在的变量。如果它什么也没找到，它将创建一个具有该名称的全局变量。

如果您`var`首先使用，您只需确保此搜索始终在本地范围内停止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:42:53.790

这些是相同的：

```
var x;
// ...
x = 1; 
```

...和...

```
var x = 1; 
```

两者都在本地范围内定义一个变量并为其赋值。如果您想稍后*在同一范围内*更改变量的值，您可以简单地按名称引用它：

```
x = 2; 
```

但是，如果您在不同的范围内，除非变量首先在全局范围内声明，否则您将无法访问它（它“超出范围”）。尝试这样做将在全局范围内定义一个具有该名称的变量。

```
function a(){
    var x = 1;
}

function b(){
    x = 2;  // 'x' in a is out of scope, doing this declares a new 'x' in global scope
}

a();
b(); 
```

在声明它的同一范围内引用变量时，您不需要在它前面加上前缀`var`，尽管您可以：

```
var x = 1;
// ...
var x = 2; 
```

...没有必要这样做。虽然它将 2 分配给“x”，但它在逻辑上没有任何效果，因为 var 已经在本地范围内。但是，如果`x`已在全球范围内声明：

```
var x = 1;

function a(){
    var x = 2;
    console.log(x);
}

a();
console.log(x); 
```

这将首先打印“2”，然后打印“1”。通过在函数中引用`x`前面的 with `var`，它将局部范围应用于变量。一旦函数完成，变量的原始范围就会恢复（或者重新范围丢失，如果你想这样看的话）。感谢@zzzzBov 指出这一点。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T20:46:05.530

> 我的理解是，在变量声明之前写 var 会将变量分配给本地范围，而在声明变量之前不写 var 会将变量分配给全局范围。这是真的？

不是完全。

```
function foo() {
    var a = 1;
    function bar() {
        a = 2; // Still in the scope of foo, not a global
    }
} 
```

> 既然我在本地范围内用var声明了someVariable，然后又在不使用var的情况下初始化了someVariable，那么JavaScript是否认为我只是在本地范围内初始化了一个变量，或者我在本地范围内声明了一个变量，然后又声明并初始化了另一个全局范围内的变量？

该示例中只有一个`someVariable`。

> 以后想再修改someVariable的值时，是不是需要在变量表达式前写var

`var`作用域为整个函数的变量，无论它出现在函数中的什么位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T21:16:47.553

如果使用 定义变量，则可以不反复`var`使用关键字来引用同一个变量。`var`这些引用相同的变量：

```
var someVariable;
//...code...
someVariable = 'rawr'; 
```

如果`var`每次更改变量时都使用关键字，则不会获得单独的变量。最新的声明只会覆盖最旧的声明。所以`var`除了初始化之外，使用关键字没有任何意义。要更改 的值`someVariable`，您可以像上面的示例一样对变量名进行赋值。

基本上，`var`如果该范围内没有同名的变量， using 将创建一个新变量。

现在以这段代码为例：

```
var someVariable = 'initialized';

function test1(){
  //this someVariable will be a new variable since we have the var keyword and its in a different scope
  var someVariable = 'test1';
  console.log(someVariable);
}

function test2(){
  //because there is no var keyword this refers to the someVariable in the parent scope
  someVariable = 'test2';
  console.log(someVariable);
}

console.log(someVariable); //initialized

test1(); //test1
console.log(someVariable); //initialized

test2(); //test2
console.log(someVariable); //test2 
```

通过此示例，您可以看到根据您希望代码执行的操作，您可能会遇到问题。如果您想表现`test2`得像`test1`而忘记使用`var`关键字，那么当您期望是时，您会感到困惑`someVariable`，`initialized`而实际上却是`test2`。

但是您也可以故意不使用`var`关键字，因为您想`test2`更新父变量。因此，`var`正确使用关键字很重要。

`var`初始化变量时不使用将在全局范围内创建变量。这不是好的做法。如果您想要全局范围内的变量，请手动将它们放在那里。即`window.someVariable = 'initialize';`这样任何其他看到您的代码的人都知道您故意将其设为全局变量。

# javascript - 使用 JQuery 和 HTML5 范围输入进行图像旋转

> ID：15121952
> 
> 赞同：1
> 
> 时间：2013-02-27T20:40:54.860
> 
> 标签：javascript, jquery, html, jquery-plugins, rotation

HTML5*范围输入*和旋转插件*jqueryrotate* [https://code.google.com/p/jqueryrotate/wiki/Examples](https://code.google.com/p/jqueryrotate/wiki/Examples)

问题是我希望在更改范围元素的值后立即旋转图像，我必须更改

元素，但由于某些奇怪的原因，它不适用于旋转值

我的代码：

```
 <script type="text/javascript">
    $(function() {
    $("#rotationrange").change(function  () {
        var rotationrange = $("#rotationrange").val();
        parseInt(rotationrange,10);
        var angle = rotationrange;
        $(".rotatebox").rotate(angle);
        $("p").text(angle);
       })
    });
  </script> 
```

HTML

```
 <img src="assets/imgs/temp.jpg" height="480" width="640" class="rotatebox" />
   <input type="range" name="points" min="-20" max="20" id="rotationrange">
   <p>here</p> degrees 
```

输出是

元素改变但旋转从未发生

有什么建议么 ？？也许其他插件会起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:48:02.110

你需要结合

```
parseInt(rotationrange,10);
var angle = rotationrange; 
```

进入

```
var angle = parseInt(rotationrange, 10); 
```

[http://jsfiddle.net/mblase75/Vzpng/](http://jsfiddle.net/mblase75/Vzpng/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:51:04.810

问题出在你的`parseInt`线路上。

```
parseInt(rotationrange,10); 
```

`parseInt`不改变括号内变量的值；它输出一个新值作为其返回值。因此，您上面的行会将值解析为整数，但随后会立即丢弃结果。

您需要做的是使用该输出，可能会将其写回`rotationrange`变量，如下所示：

```
rotationrange = parseInt(rotationrange,10); 
```

希望有帮助。

# activiti - 如何纠正 Activiti 中的“不实现 org.activiti.engine.delegate.JavaDelegate”错误

> ID：15121953
> 
> 赞同：1
> 
> 时间：2013-02-27T20:40:57.353
> 
> 标签：activiti

我从 Activiti 开始，我正在尝试创建一个服务任务。我创建了一个 netbeans java 库项目并编写了以下类：

```
package com.processos.reuniao;

import org.activiti.engine.delegate.DelegateExecution;
import org.activiti.engine.delegate.JavaDelegate;

public class ListUsers implements JavaDelegate {

    @Override
    public void execute(DelegateExecution execution) throws Exception {
        String group = (String) execution.getVariable("group");
        System.out.println(group);
    }

} 
```

然后我构建了库并将 jar 复制到 /lib 的 tomcat lib 文件夹中，我也有 activiti 库。

在我的 BPMN 中，我有这个服务任务：

```
<serviceTask id="servicetask1" name="List Users" activiti:class="com.processos.reuniao.ListUsers"></serviceTask> 
```

当 Activiti 尝试运行此服务任务时，它返回给我这个异常：

```
Fev 27, 2013 5:31:32 PM com.vaadin.Application terminalError
SEVERE: Terminal error:
com.vaadin.event.ListenerMethod$MethodException
Cause: com.vaadin.event.ListenerMethod$MethodException
Cause: org.activiti.engine.ActivitiException: com.processos.reuniao.ListUsers doesn't implement org.activiti.engine.delegate.JavaDelegate nor org.activiti.engine.impl.pvm.delegate.ActivityBehavior 
```

如该类所示，它实现了 JavaDelegate。我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T21:06:54.590

尝试将 jar 添加到`webapps/your-appplication/WEB-INF/lib`目录中，或者`webapps/activiti-explorer/WEB-INF/lib`如果您使用`activiti-explorer` 测试流程定义的最佳方法是使用 activiti-explorer 来测试工作流。你可以在 activiti 发行版中找到 activiti-explorer.war 文件。
[Activiti 用户指南 - 使用 Activiti explorer 部署](http://activiti.org/userguide/index.html#deploymentWithExplorer)

# actionscript - 如何使movieClip的alpha部分不可点击（actionscript starling）？

> ID：15121957
> 
> 赞同：0
> 
> 时间：2013-02-27T20:41:13.047
> 
> 标签：actionscript, air, flash-builder, flashdevelop

我正在使用 Starling。我不知道如何使位图的 alpha 部分不可点击 - 比如说我在中心有一只兔子，周围有 alpha。

首先我嵌入位图：

```
[Embed(source="assets/stuff.xml", mimeType="application/octet-stream")]public static const Axml:Class;
[Embed(source="assets/stuff.png")]public static const Apng:Class; 
```

然后创建位图图集（spritesheet）：

```
var tx1:Texture = Texture.fromBitmap(new Apng());
var xm1:XML = XML(new Axml());
var atlas:TextureAtlas = new TextureAtlas(tx1, xm1); 
```

我制作了一个 MovieClip 并像这样向它添加位图：

```
var movie:MovieClip = new MovieClip(atlas.getTextures("rabbit_run_"), 18);
addChild(movie);
movie.play();

starling.core.Starling.juggler.add(movie); 
```

但是当我点击它时，即使在 alpha 部分，movieClip 也会变成“点击”。我只需要**兔子本身**是可点击的，而不是在它周围！

如何使 alpha 不可点击？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T06:31:49.587

1：您不能使图像在一个区域可点击而在另一区域不可点击。但是您可以在鼠标下获得像素的颜色并忽略透明像素上的 ckicks

```
import flash.events.MouseEvent;
import flash.display.BitmapData;

var rabbitBitmap:BitmapData = new BitmapData(rabbit.width, rabbit.height, true, 0xFFFFFFFF);
rabbitBitmap.draw(rabbit);

addEventListener(MouseEvent.MOUSE_MOVE, mmh)
rabbit.addEventListener(MouseEvent.CLICK, mch)
rabbit.buttonMode = true;

function mmh(e:MouseEvent):void {
  rabbit.useHandCursor = getAlpha() != 255;
}

function mch(e:MouseEvent):void {
  if (getAlpha() != 255) {
    // ... do someth
  }
}

function getAlpha ():int {
  var rgba:uint = rabbitBitmap.getPixel32(rabbit.mouseX, rabbit.mouseY);
  return rgba & 0xff;
} 
```

2：为你的兔子使用矢量图形 :)

# hibernate - 咨询中的休眠好奇错误

> ID：15121958
> 
> 赞同：0
> 
> 时间：2013-02-27T20:41:16.930
> 
> 标签：hibernate, getter, illegalargumentexception, createquery

我在hibernate中进行了第一次尝试，我得到了这个问题。

当我做这个咨询我得到正确的结果

```
List result = session.createQuery("select t from Tarea t where t.subtipo = 1").list(); 
```

但是如果我使用一个参数会给我一个错误

```
List result = session.createQuery("select t from Tarea t where t.subtipo = :subtipo").
            setParameter("subtipo", 1).list(); 
```

错误是：

```
ERROR org.hibernate.property.BasicPropertyAccessor - IllegalArgumentException in class: com.hibernate.gip.modelo.SubTipo, getter method of property: id_subtipo
[ERROR] IllegalArgumentException occurred calling getter of com.hibernate.gip.modelo.SubTipo.id_subtipo
java.lang.reflect.InvocationTargetException 
```

也许我忘记了像newbe这样的东西......任何人都可以解决它吗？提前致谢！

正在编辑...

SubTipo.java

```
public class SubTipo {

// Atributos
private int id_subtipo;
private String nombre;
private Tipo tipo;

private Set<Incidencia> incidencias = new HashSet<Incidencia>();
private Set<Tarea> tareas = new HashSet<Tarea>();

// Constructores
public SubTipo() {}

public SubTipo(int id, String nom, Tipo tip, Set<Tarea> tar, Set<Incidencia> inc) {
    this.id_subtipo = id;
    this.nombre = nom;
    this.tipo = tip;
    this.incidencias = inc;
    this.tareas = tar;
}

// Getters & Setters
public int getId_subtipo() {
    return id_subtipo;
}

public void setId_subtipo(int id_subtipo) {
    this.id_subtipo = id_subtipo;
}

public String getNombre() {
    return nombre;
}

public void setNombre(String nombre) {
    this.nombre = nombre;
}

public Tipo getTipo() {
    return tipo;
}

public void setTipo(Tipo tipo) {
    this.tipo = tipo;
}

public Set<Incidencia> getIncidencias() {
    return incidencias;
}

public void setIncidencias(Set<Incidencia> incidencias) {
    this.incidencias = incidencias;
}

public Set<Tarea> getTareas() {
    return tareas;
}

public void setTareas(Set<Tarea> tareas) {
    this.tareas = tareas;
}

} 
```

SubTipo 映射文件

```
<hibernate-mapping package="com.hibernate.gip.modelo">

<class name="SubTipo" table="SUBTIPO">

    <id name="id_subtipo" type="int">
        <column name="ID_SUBTIPO" />
        <generator class="assigned" />
    </id>

    <property name="nombre" type="java.lang.String">
        <column name="NOMBRE" />
    </property>

    <many-to-one name="tipo" class="com.hibernate.gip.modelo.Tipo">
        <column name="TIPO" not-null="true" />
    </many-to-one>

    <set name="incidencias" table="INCIDENCIA">
        <key>
            <column name="SUBTIPO" />
        </key>
        <one-to-many class="com.hibernate.gip.modelo.Incidencia" />
    </set>

    <set name="tareas" table="TAREA">
        <key>
            <column name="SUBTIPO" />
        </key>
        <one-to-many class="com.hibernate.gip.modelo.Tarea" />
    </set>

</class>

</hibernate-mapping> 
```

它必要的其他类？谢谢

重新编辑

Tarea.java

```
public class Tarea {

// Atributos
private String id_tarea;
private String nombre;
private int t_limite;

private Tarea precedente;
private SubTipo subtipo;

private Set<iTarea> iTareas = new HashSet<iTarea>();

// Constructores
public Tarea() {}

public Tarea(String id, String nom, int lim, Tarea pre, SubTipo sub, Set<iTarea> iTa) {
    this.id_tarea = id;
    this.nombre = nom;
    this.t_limite = lim;
    this.precedente = pre;
    this.subtipo = sub;
    this.iTareas = iTa;
}

// Getters & Setters
public String getId_tarea() {
    return id_tarea;
}

public void setId_tarea(String id_tarea) {
    this.id_tarea = id_tarea;
}

public String getNombre() {
    return nombre;
}

public void setNombre(String nombre) {
    this.nombre = nombre;
}

public int getT_limite() {
    return t_limite;
}

public void setT_limite(int t_limite) {
    this.t_limite = t_limite;
}

public Tarea getPrecedente() {
    return precedente;
}

public void setPrecedente(Tarea precedente) {
    this.precedente = precedente;
}

public SubTipo getSubtipo() {
    return subtipo;
}

public void setSubtipo(SubTipo subtipo) {
    this.subtipo = subtipo;
}

public Set<iTarea> getiTareas() {
    return iTareas;
}

public void setiTareas(Set<iTarea> iTareas) {
    this.iTareas = iTareas;
}   

} 
```

面积映射

```
<hibernate-mapping package="com.hibernate.gip.modelo">

<class name="Tarea" table="TAREA">

    <id name="id_tarea" type="java.lang.String">
        <column name="ID_TAREA" />
        <generator class="assigned" />
    </id>

    <property name="nombre" type="java.lang.String">
        <column name="NOMBRE" />
    </property>

    <property name="t_limite" type="int">
        <column name="T_LIMITE" />
    </property>

    <many-to-one name="precedente" class="com.hibernate.gip.modelo.Tarea" unique="true"> </many-to-one>

    <many-to-one name="subtipo" class="com.hibernate.gip.modelo.SubTipo">
        <column name="SUBTIPO" not-null="true"/>
    </many-to-one>

    <set name="iTareas" table="ITAREA">
        <key>
            <column name="TAREA" />
        </key>
        <one-to-many class="com.hibernate.gip.modelo.iTarea" />
    </set>

</class>

</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T22:00:18.673

当你在 hql 工作时，不要忘记你是在处理对象，而不是在行上。

您在查询中传递的参数是 id 而不是对象。你可以试试 ：

```
List result = session.createQuery("select t from Tarea t where t.subtipo.id_subtipo = :subtipoId").setParameter("subtipoId", 1).list(); 
```

`subtipo`如果您将持久化的实例而不是 id传递给它，您尝试的查询可能会起作用。

# ruby-on-rails - 用于替代 Cucumber 的集成测试工具

> ID：15121964
> 
> 赞同：2
> 
> 时间：2013-02-27T20:41:34.293
> 
> 标签：ruby-on-rails, cucumber, integration-testing

现在我正在使用黄瓜，但我觉得它有点冗长。我不会向没有 Ruby 知识的人展示黄瓜期货。所以现在我认为没有必要在人类可读的文本和步骤定义中复制集成测试。它让我做无用的工作。

我正在寻找比黄瓜更令人讨厌的东西。类似于 rspec 集成，但功能不亚于黄瓜功能。

您能否为我的目的推荐一些用于集成测试的工具？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T13:08:47.153

试试[菠菜](http://codegram.github.com/spinach/):)！我觉得这正是你要找的东西！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T12:49:44.937

[RSpec 功能规范](https://www.relishapp.com/rspec/rspec-rails/docs/feature-specs/feature-spec)与 Cucumber 集成测试非常相似。这需要[Capybara 宝石](https://github.com/jnicklas/capybara)。

将您的测试移回 RSpec 使它们更像代码，并且您删除了需要解析 gherkin 的额外步骤。如果您真的不需要与非技术人员共享规格，这是一个很好的方法。

Thoughbot 有一篇文章说明了一种有趣的基于参与者的功能规范方法：[使用 RSpec 集成测试和 Capybara 进行端到端测试](http://robots.thoughtbot.com/post/33771089985/rspec-integration-tests-with-capybara)。

即将出版的[Rails 4 in Action](http://www.manning.com/bigg2/)一书详细描述了如何进行功能规范。如果你想看一看，本书中引用的代码有一个[GitHub 存储库（示例应用程序是一个项目跟踪系统）。](https://github.com/rails3book/ticketee-v2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-19T11:21:31.113

为了完整起见，您还应该考虑[turnip](https://github.com/jnicklas/turnip)，尽管它看起来与菠菜非常相似；我选择萝卜的决定因素是菠菜中似乎没有占位符，我很难理解。

# android - 识别 /proc/*/maps 中代码部分的好方法

> ID：15121970
> 
> 赞同：4
> 
> 时间：2013-02-27T20:41:44.403
> 
> 标签：android, linux, android-ndk

我正在尝试查找我的原生 Android 库**代码**在进程地址空间中占用的地址范围。我正在阅读和解析`/proc/self/maps`。图书馆有两个部分。一个是代码，另一个是数据，我猜。我需要把它们区分开来。但是，它们之间的差异是间接的。在 Android 2.3.3 上测试。

代码部分的权限是 r-xp，数据是 rwxp - 两者都是可执行的。我对基于可写性的决定感到不安——如果在相同风格的 Android 上，有一个只读数据部分怎么办？

另一个区别是映射部分相对于文件的偏移量 - 代码部分的偏移量为 0。同样，如果链接器的某些迭代将数据放在代码之前怎么办？

这些工具，如 GDB 和 Android 的 stack walker，可以毫无问题地告诉我代码地址属于哪个模块，以及它在库中的偏移量是多少。只是在说'。

编辑：在 Android 4.0 上，这些部分是不同的：有 r-xp、r--p、rw-p。所以这让我很容易识别出可执行部分失败 - 但是早期的 Android 呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:23:34.560

找到了解决方法。幸运的是，这些是**我的**库，所以我可以通过一个返回自己地址的函数来获得代码块中确定的地址。然后我将它与部分边界匹配。

```
void *TestAddress()
{
    return TestAddress; //That's within the code block, that's for sure.
} 
```

这不适用于第三方库，因为导入函数的函数地址将对应于导入 thunk，而不是真实函数的主体。

# android - 打开资产或原始文件作为文件

> ID：15121975
> 
> 赞同：0
> 
> 时间：2013-02-27T20:41:51.757
> 
> 标签：android, file

有没有办法打开资产或原始资源`File`？我有需要打开文件的方法，`File`但是因为我想将我的文件存储在资产或原始文件夹中，所以我无法访问它们。

我尝试使用`file:///android_asset/filename.xml`但收到 FileNotFound 异常打开它。

```
File file = new File("....");
x.load(file); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:45:02.403

> 有没有办法将资产或原始资源打开为 File ？

不，对不起。它们不作为文件存在。你只能得到一个`InputStream`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T00:45:03.067

如果你愿意先压缩文件，你可以这样做：

```
File dir = getFilesDir();
IoUtils.extractZipResource(getResources().openRawResource(R.raw.texfilezip), dir, true);
File textFile = new File(dir, "textfile.txt"); 
```

# c++ - 函数省略结构

> ID：15121978
> 
> 赞同：1
> 
> 时间：2013-02-27T20:41:56.497
> 
> 标签：c++

函数可能没有一些结构信息吗？像这样 `int f(int x,int y=1)`并调用 f(2) 很好，但是`int f(int x,struct my_struct &y)` 考虑到它是那里的参考，正确的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:48:44.583

由于它是非`const`引用，因此您不能将其绑定到作为临时对象的默认值。您*可以*将它绑定到一些非临时对象，如下所示：

```
my_struct obj;
int f(int x, my_struct& y = obj) {
  // ...
} 
```

但这意味着每次调用`f`没有第二个参数都可以访问相同的`obj`. 他们每个人都可以修改它，然后下一个将收到`obj`具有不同状态的一个。这不是很典型的默认值。您希望它每次都具有相同的默认值。

`const`如果可以不传递对象，为什么您的函数会通过非引用获取对象？`const`当您希望调用者传递一个对象供您修改时，您将采用非引用。

`y`将您的参数作为`const`参考可能更有意义。`const`当您希望调用者将一个对象传递给您以供您观察并且您不想复制它时，您需要一个参考。然后你*可以*将它绑定到一个临时对象，如下所示：

```
int f(int x, const my_struct& y = my_struct(1, 2, "some args")) {
  // ...
} 
```

# grails - Grails：理解 groovy DomainClass.properties

> ID：15121981
> 
> 赞同：3
> 
> 时间：2013-02-27T20:42:05.860
> 
> 标签：grails, properties, groovy, associations, grails-domain-class

我很难找到有关 grails 功能的信息：

```
DomainClass.properties = params 
```

在我的特殊情况下，我有这些课程：

```
class parameterType = {
String name
String desc
static hasMany = [codes : parameterCode]
...
}

class parameterCode = {
String code
String desc
static belongsTo = [parameterType : parameterType]
} 
```

我的 parameterType/edit.gsp 有 name、desc 和一个带有 parameterCodes 列表的 html 表

起初，我在“更新”操作上有一些脚手架控制器的变体。那（我知道它错了，但它是初学者代码）它首先删除了所有参数代码，然后重新关联它们（或重新创建它们）。

使用 Ajax，我以这种格式发送数据：

```
id=1234&name=paramName&desc=paramDesc&codes[0].code=code1&codes[0].desc=codeDesc1&codes[1].code=code2&codes[1].desc=codeDesc2 
```

在控制器中我有这个：

```
def parameterTypeInstance = ParameterType.get(params.id)
def toDelete = parameterTypeInstance.parameterCodes

parameterTypeInstance.parameterCodes = []
toDelete.each{it.delete(flush: true)}

//And this "magic" line reassociated all the properties in parameterType And Created his parameterCodes in the data base:
parameterTypeInstance.properties = params 
```

老实说，我不知道它是如何工作的，我只是想知道是否有一种方法可以做同样的事情，而不必事先删除相关的参数代码。

干杯

# **更新：**

我刚刚在这些链接中找到了我想要的东西：
[http :](http://www.2paths.com/2009/10/01/one-to-many-relationships-in-grails-forms/) [//www.2paths.com/2009/10/01/one-to-many-relationships-in-grails-forms/ http://omarello.com/ 2010/08/grails-one-to-many-dynamic-forms/](http://omarello.com/2010/08/grails-one-to-many-dynamic-forms/)

但我有另一个错误。

这些讨论关于 LazyList 和 decorate()，所以我只是在我的 ParameterType 类中添加了下一行：

```
def List getExpandableCodeList() {
    return LazyList.decorate(codes,FactoryUtils.instantiateFactory(ParameterCode.class))
} 
```

但是当我在我的控制器更新中这样做时：

```
parameterTypeInstance.properties = params 
```

我收到此错误：

groovy.lang.MissingMethodException：没有方法签名：静态 org.apache.commons.collections.list.LazyList.decorate() 适用于参数类型：(org.hibernate.collection.PersistentSet, org.apache.commons.collections. functors.InstantiateFactory) 值：[[cE - EE, cA - AA, cC - CC, cD - DD], org.apache.commons.collections.functors.InstantiateFactory@dd768d]

控制器以这种方式接收数据：

expandableCodeList[0].desc: AA expandableCodeList
[3].code: cE
expandableCodeList[3].id: 35073 expandableCodeList
[1].id: 35076 expandableCodeList[0].code
: cA expandableCodeList
[2].code: cD expandableCodeList
[ 1].desc：CC
可扩展代码列表[0].id：35080
可扩展代码列表[3].desc：EE
可扩展代码列表[2].id：35075

关于我做错了什么的任何提示？我应该以其他格式发送数据吗？

任何帮助将非常感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T11:05:18.293

如果我没有出错 .properties 是 groovy 添加到 java.lang.Object 的方法，请查看此[javaodc](http://groovy.codehaus.org/groovy-jdk/java/lang/Object.html#getProperties%28%29)

有很多方法可以做你想做的事。请查看有关[数据绑定](http://www.grails.org/doc/latest/guide/theWebLayer.html#dataBinding)的 grails 文档。

例如你可以做

```
bindData(parameterTypeInstance, params, [exclude: parameterTypeInstance.parameterCodes]) 
```

[在此处](http://www.grails.org/doc/latest/ref/Controllers/bindData.html)查看有关 bindData 的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T16:07:40.930

好的，我将其设置为答案：

[http://www.2paths.com/2009/10/01/one-to-many-relationships-in-grails-forms/](http://www.2paths.com/2009/10/01/one-to-many-relationships-in-grails-forms/)

最后，我正在寻找lazylist 和 decorate() 方法。可悲的是，它需要将子集合作为一个列表，它为我解决了许多其他问题。但是，如果有人需要以“简单”的方式与父对象及其子对象创建视图，这是一个很好的解决方案。

# excel - 针对“重大功能丧失”错误关闭 Excel 兼容性检查器

> ID：15121982
> 
> 赞同：2
> 
> 时间：2013-02-27T20:42:07.910
> 
> 标签：excel, excel-2010, vba

我发现，虽然可以通过代码以编程方式禁用 Excel 的“兼容性检查器”（通过`ActiveWorkbook.CheckCompatibility = False`在`SaveAs`调用之前或通过捕获`ActiveWorkbook.BeforeSave`事件全局使用），但如果“显着丢失功能”检测到。快速测试方法：

*   创建一个新的 Excel 2010 工作簿。
*   选择 A1:A2 并选择条件格式（没关系）。
*   选择 A2:A3 并选择不同的条件格式。A2 应应用两种不同的条件格式。
*   打开 VBA 编辑器，并将以下代码添加到 Workbook 模块：

    ```
    Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
        ActiveWorkbook.CheckCompatibility = False
    End Sub 
    ```

*   在代码中放置断点。

*   返回电子表格，选择文件 > 另存为。代码将立即跳转到断点。如果您单步执行代码，则可以验证`CheckCompatibility`“立即”窗格中的设置。
*   代码完成后，选择 Excel 97-2003 文件类型并单击“保存”。
*   **兼容性检查器仍然出现。**

我怀疑这是因为该错误不是“次要兼容性问题”（参见[http://msdn.microsoft.com/en-us/library/office/gg132972(v=office.14).aspx](http://msdn.microsoft.com/en-us/library/office/gg132972(v=office.14).aspx)），但没有我似乎确实抑制了这个错误，甚至没有创建一个注册表项来禁用它。任何人都知道如何在“显着”不兼容的情况下抑制检查器？

ETA：在不涉及很多不必要的细节的情况下，我正在尝试自动化一个过程，其中打开许多供应商模板，填充数据，根据大量（并且总是略有不同）的质量控制规则集进行处理，以及保存为 .xls 文件（根据供应商的要求）。因为在无人值守的系统上每两小时会在几十个不同的模板工作簿上发生这种情况，所以我不能简单地取消选中每个工作簿的兼容性要求。我的意思是，我想我可以，但那将成为我的全职工作。我需要能够在运行时关闭任何工作簿的兼容性检查，这是第一次，无需人工干预。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-29T06:50:28.027

尝试 Application.DisplayAlerts = False 作为解决方法。

再见

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T20:00:47.100

创建了一个功能不完全但至少满足我个人需要的解决方法；也许它会成为其他人的起点。请注意，这并不适用于所有情况下的兼容性检查器，只是在自定义格式重叠的情况下。

简而言之，这将遍历所有活动单元格，并且对于包含条件格式的任何单元格，评估是否应应用自定义格式（以正确的顺序），然​​后手动应用它。最后，所有自定义格式都被删除。这会使工作簿保持格式，但消除了强制显示兼容性检查器的原因。YMMV。

```
Sub FlattenFormats()
    Dim wb As Workbook
    Set wb = ActiveWorkbook
    Dim asheet As Worksheet
    Set asheet = wb.ActiveSheet

    Dim cellvalue_regex As New RegExp
    cellvalue_regex.Pattern = "^""(.*)""$"

    Dim c As Range
    Dim conds As Collection

    For Each c In asheet.UsedRange.SpecialCells(xlCellTypeAllFormatConditions)
        If c.FormatConditions.Count > 0 Then
            Set conds = New Collection
            Dim fc As FormatCondition
            Set fc = Nothing
            For Each fc In c.FormatConditions
                conds.Add fc
            Next fc
            c.FormatConditions.Delete

            Sort conds

            Set fc = Nothing
            For Each fc In conds
                Select Case fc.Type
                    Case XlFormatConditionType.xlCellValue
                        Dim theMatches As MatchCollection
                        Set theMatches = cellvalue_regex.Execute(fc.Formula1)
                        Dim match1 As Match
                        Set match1 = theMatches.Item(0)
                        Dim checkFor As String
                        checkFor = match1.SubMatches(0)
                        If c.Value2 = checkFor Then
                            c.Interior.Color = fc.Interior.Color
                            If fc.StopIfTrue Then
                                Exit For
                            End If
                        End If
                    Case XlFormatConditionType.xlExpression
                        If Evaluate(fc.Formula1) Then
                            c.Interior.Color = fc.Interior.Color
                            If fc.StopIfTrue Then
                                Exit For
                            End If
                        End If
                End Select
            Next fc
        End If
    Next c

    ActiveSheet.Cells.FormatConditions.Delete
End Sub

Private Sub Sort(ByRef c As Collection)
    Dim i As Integer, j As Integer
    Dim temp As FormatCondition
    Dim i_item As FormatCondition, j_item As FormatCondition

    For i = 1 To c.Count - 1
        Set i_item = c(i)

        For j = i + 1 To c.Count
            Set j_item = c(j)

            If i_item.Priority > j_item.Priority Then
                Set temp = c(j)
                c.Remove j
                c.Add temp, temp.Priority, i
            End If
        Next j
    Next i
End Sub 
```

# c# - 如何从 Windows 中文件属性对话框的详细信息选项卡中获取信息？

> ID：15121983
> 
> 赞同：0
> 
> 时间：2013-02-27T20:42:08.053
> 
> 标签：c#, pinvoke

如果您在 Windows 资源管理器中右键单击文件并选择属性，则会弹出一个包含大量信息的对话框。如何使用 C# 访问这些信息？

具体来说，我正在寻找详细信息选项卡上的信息。我主要处理图像，所以“拍摄日期”很重要。我也会处理其他文件，所以如果有办法获取与文件关联的任何元数据，那就太好了。

我见过一些地方提到使用 Shell32.dll 来获取这些信息，但是当我尝试引用这个库时出现错误。有没有其他方法可以做到这一点，也许是通过 P/Invoke？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:45:37.290

您是否尝试过 FileSystemInfo 类？

[http://msdn.microsoft.com/en-us/library/system.io.filesysteminfo.aspx](http://msdn.microsoft.com/en-us/library/system.io.filesysteminfo.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:47:50.790

您可以`File`为此目的使用类方法：

```
File.GetCreationTime(filename)
File.GetLastWriteTime(filename)
File.GetLastAccessTime(filename)
//and many more in the intellisense 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T21:55:58.190

在搞砸了一点之后，这里有一个非常有限的例子来说明如何获取图像元数据。

```
var image = System.Drawing.Image.FromFile(@"C:\your\image\here");

        foreach (var a in image.PropertyItems)
        {
            dynamic value;

            switch (a.Type)
                {
                case 2:
                    value = Encoding.ASCII.GetString(a.Value);
                    break;
                case 3:
                    value = BitConverter.ToInt16(a.Value, 0);
                    break;
                case 4:
                    value = BitConverter.ToInt32(a.Value, 0);
                    break;
                default:
                    value = "NaN";
                    break;
                }

            Console.WriteLine("Type: {0} \r\n Value: {1}", a.Type, value);
        } 
```

[您可以在Microsoft 的网站](http://msdn.microsoft.com/en-us/library/xddt0dz7.aspx)上找到更多信息并搜索图像元数据规范以完全自己编写一个。

始终可以选择使用已经处理此问题的第三方库，但我自己在图像领域没有做太多工作。

# php - 在浏览器版本上重定向

> ID：15121986
> 
> 赞同：0
> 
> 时间：2013-02-27T20:42:23.860
> 
> 标签：php, javascript, html

```
<!--[if IE 7]>
  <script type="text/javascript">
    window.location = "BrowserErrorPage.php";
  </script>
<![endif]--> 
```

我已经设法找出它的 IE7 是否然后重定向到某个页面。如果 IE 浏览器版本低于 IE 版本 8，我想要重定向到错误页面怎么办。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:43:55.620

```
<!--[if lt IE 8]>
  <script type="text/javascript">
    window.location = "BrowserErrorPage.php";
  </script>
<![endif]--> 
```

欲了解更多信息：[有条件的评论](http://www.quirksmode.org/css/condcom.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:43:57.910

```
<!--[if lt IE 8]>
  <script type="text/javascript">
    window.location = "BrowserErrorPage.php";
  </script>
<![endif]--> 
```

有条件的评论是一个糟糕的主意，但这里是它的工作原理。

# sql-server - 滚动时保持报告标题可见

> ID：15121989
> 
> 赞同：14
> 
> 时间：2013-02-27T20:42:29.940
> 
> 标签：sql-server, reporting-services, sql-server-2008-r2

我经常检查以下选项，希望在`RS`Web 门户上呈现报告时实现它 - 但它永远不会工作......

![在此处输入图像描述](../Images/04e786bfbd8bac893c40bdf4ca823b67.png)

报告通常有一些`Row Groups`- 这是否会影响此选项是否有效？

或者这是一个错误`Reporting Services`？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-28T02:34:51.840

我发现它通常不像宣传的那样工作，你必须找到“高级模式”按钮（这是最糟糕的 UI 的有力候选者），然后摆弄几个属性。

这里可能是最好的参考：

[http://blogs.msdn.com/b/robertbruckner/archive/2008/10/13/repeat-header-and-visible-fixed-header-table.aspx](http://blogs.msdn.com/b/robertbruckner/archive/2008/10/13/repeat-header-and-visible-fixed-header-table.aspx)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-06-06T11:02:57.780

**步骤 1)**在 Tablix 属性中，选中以下复选框：

*   在每一页上重复标题行。
*   滚动时保持标题可见。

确保未**选中****列标题**复选框。

 *** * *

**步骤 2）**在左侧的组窗格（**行组**）中，第一行是**静态**（*在高级模式下*）。

*   将其：“ **ReapetOnNewPage** ”属性设置为**TRUE**
*   将其：“ **FixedData** ”属性设置为**TRUE**
*   将其：“ **KeepWithGroup** ”属性设置为**AFTER**

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-04T22:58:08.130

我认为让人们对这些设置感到困惑的是，如果您使用了“表格”样式的 tablix ，则设置所指的“行标题”和“列标题”是*不可见的。*这些仅在使用“矩阵”样式的 tablix 时可见。

因此，我经常看到人们试图为表格设置它并想知道为什么它不起作用。根据 Mike Honey 的回答中提到的 MSDN 博客文章，如果您使用过表格，那么您必须摆弄高级设置才能使其正常工作。

我的建议是从矩阵开始，并确保要保持可见的行或列标题位于矩阵行/列组区域（双虚线的上方和左侧）。您可以删除不打算使用的任何行或列组。当您设置“保持可见”设置时，它们应该会按预期工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-16T13:38:37.730

我在 Visual Studio 中找不到这个属性，所以我检查了 XML 源。

1.  在解决方案资源管理器中，右键单击您的报告并查看代码。
2.  在 xml 代码中找到：

```
 <TablixRowHierarchy>
        <TablixMembers>
            <TablixMember>
                <TablixHeader>
```

3.  `<TablixMember>`把这段代码放在下面：

```
<FixedData>true</FixedData>
```

现在保存代码，您将看到标题行被冻结。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-01T09:41:12.397

请注意：我们可以冻结 Tablix 的标题。

解决方法：

1.  我们需要将标题单元格的固定数据属性更改为 true（静态）
2.  取消选中“在滚动时保持行或列标题可见”复选框**

# google-chrome-extension - chrome扩展是否可以检测它是否在下拉列表中？

> ID：15121990
> 
> 赞同：0
> 
> 时间：2013-02-27T20:42:34.063
> 
> 标签：google-chrome-extension

我想将同一个 HTML 文件用于多种用途 - 浏览器 iframe 中的登录面板，以及下拉列表中的登录面板。

有没有一种程序化的方式来知道我是否在下拉列表中而不是其他任何地方？

我查看了 window 对象，但找不到任何独特的东西表明我在下拉列表中。

我不希望对下拉列表使用自定义 URL（查询参数或类似的东西）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T03:34:55.793

如果您的意思是来自 a`Page Action`或 a的弹出窗口，`Browser Action`那么您可以获取`chrome.windows`对象并读取`type`属性。

```
chrome.windows.getCurrent(function(window){
  //window.type is an enumerated string ["normal", "popup", "panel", "app"]
}); 
```

# objective-c - objective-c 语法 - 为什么使用 methodNameVariable:(type) variable anotherVariable:(type) anotherVariable

> ID：15121992
> 
> 赞同：0
> 
> 时间：2013-02-27T20:42:43.667
> 
> 标签：objective-c, syntax

我知道的大多数语言都使用以下语法：

```
function name (var1,var2,var3) {
    //do stuff with variables
} 
```

然而，Objective-C 使结构更加复杂

```
- (function type) functionName:(type)var1 var2:(type) var2  var3:(type) var3{
} 
```

为什么根本不

```
- (function type) functionName:(type) var1 (type) var2 (type) var3{
} 
```

是否有可能进行以下操作，这有什么意义？

```
- (function type) functionName:(type)var1 randomName:(type) var2  anotherName:(type) var3{
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T20:54:25.837

**省略冒号之前的部分是完全合法的 Objective-C。**如果 API 设计者想要，他们可以这样写：

```
- (void)removeObserver:(NSObject *)observer :(NSString *)keyPath :(void *)context 
```

代替

```
- (void)removeObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath context:(void *)context 
```

现在尝试阅读该代码

```
[self removeObserver:self :@"something" :@"somethingElse"]; 
```

与

```
[self removeObserver:self forKeyPath:@"something" context:@"somethingElse"]; 
```

什么更具可读性？

顺便说一句，有一些 OS X API 方法的方法名称和参数没有交错。一个例子是 CAMediaTimingFunction：

```
+ (id)functionWithControlPoints:(float)c1x :(float)c1y :(float)c2x :(float)c2y 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T20:49:51.523

Objective-C 方法被设计为自我记录，它们借鉴了 Smalltalk 的丰富传统。[您可以查看有关此Stackoverflow 答案](https://stackoverflow.com/a/683290/454165)的详细说明

通过自我记录，这意味着方法声明本身为您提供了方法主要功能是什么以及接收到的参数的目的的信息。

所以，要回答你的最后一个问题，是的，你可以使用这样的方法声明，这确实是 Objective-C 的优点之一，你可以描述接收到的参数。

以此为例：

```
- (BOOL)saveFile:(NSString *path, NSString *fileName); 
```

在 Objective C 上，您可以解释为自己记录这样的方法：

```
- (BOOL)saveFileInPath:(NSString *)path withName:(NSString *)name; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T20:51:26.093

Objective-C 语法的目的是为了清晰。因此，当您阅读一行代码时，您就会确切地知道发生了什么。

例如：

```
[myData writeToFile:@"/tmp/log.txt" atomically:NO append:YES]; 
```

与

```
myData.writeToFile("/tmp/log.txt", false, true); 
```

在我看来，第一行代码更清晰。只需阅读方法调用，您就可以准确地知道每个参数的作用。

# python - 如何识别 AttributeError: 'module' 指的是哪个包？

> ID：15121998
> 
> 赞同：2
> 
> 时间：2013-02-27T20:43:14.010
> 
> 标签：python, pyramid

我正在尝试将我正在编写的 Python 金字塔应用程序从一台服务器移动到另一台服务器。我从源代码管理中检查了代码并运行 a`python setup.py develop`来准备环境，但是当我尝试运行时，`pserve development.ini`我得到以下回溯：

```
2013-02-27 20:38:20,269 INFO  [pyramid_scss][MainThread] adding asset path /home/pgrace/repos/Asterisk-WebApps/Cedar-Root/opt/cedar/cedar/assets/scss
Traceback (most recent call last):
  File "/home/pgrace/venvs/pyramid/bin/pserve", line 8, in <module>
    load_entry_point('pyramid==1.4', 'console_scripts', 'pserve')()
  File "/home/pgrace/venvs/pyramid/lib/python2.6/site-packages/pyramid/scripts/pserve.py", line 50, in main
    return command.run()
  File "/home/pgrace/venvs/pyramid/lib/python2.6/site-packages/pyramid/scripts/pserve.py", line 304, in run
    global_conf=vars)
  File "/home/pgrace/venvs/pyramid/lib/python2.6/site-packages/pyramid/scripts/pserve.py", line 328, in loadapp
    return loadapp(app_spec, name=name, relative_to=relative_to, **kw)
  File "/home/pgrace/venvs/pyramid/lib/python2.6/site-packages/paste/deploy/loadwsgi.py", line 247, in loadapp
    return loadobj(APP, uri, name=name, **kw)
  File "/home/pgrace/venvs/pyramid/lib/python2.6/site-packages/paste/deploy/loadwsgi.py", line 272, in loadobj
    return context.create()
  File "/home/pgrace/venvs/pyramid/lib/python2.6/site-packages/paste/deploy/loadwsgi.py", line 710, in create
    return self.object_type.invoke(self)
  File "/home/pgrace/venvs/pyramid/lib/python2.6/site-packages/paste/deploy/loadwsgi.py", line 146, in invoke
    return fix_call(context.object, context.global_conf, **context.local_conf)
  File "/home/pgrace/venvs/pyramid/lib/python2.6/site-packages/paste/deploy/util.py", line 56, in fix_call
    val = callable(*args, **kw)
  File "/home/pgrace/repos/Asterisk-WebApps/Cedar-Root/opt/cedar/cedar/__init__.py", line 18, in main
    config.include("pyramid_scss")
  File "/home/pgrace/venvs/pyramid/lib/python2.6/site-packages/pyramid/config/__init__.py", line 773, in include
    c(configurator)
  File "/home/pgrace/venvs/pyramid/lib/python2.6/site-packages/pyramid_scss/__init__.py", line 88, in includeme
    scss.LOAD_PATHS = ','.join([scss.LOAD_PATHS, ','.join(load_paths)])
AttributeError: 'module' object has no attribute 'LOAD_PATHS' 
```

现在，我可以说问题出在 pyramid_scss，但据我所知，它引用的代码很好，就好像`module`该类不包含 LOAD_PATHS 指令一样。我试图弄清楚它指的是哪个模块，以便我可以追踪我是否缺少依赖项或其他东西。有谁知道我将如何确定`module`参考指向的位置，以便我可以检查该代码？

编辑：错误出现在`includeme`定义中，每当一个特定于金字塔的包被实例化时，它就会自动包含在我读过的内容中？也许？无论如何，它说 scss.LOAD_PATHS 不存在，是的，但是在任何一个`pyramid_scss`或`pyScss`包中都没有 scss 类，这让我想知道是否还有其他一些正在后期绑定的类。

```
def includeme(config):
    load_paths, static_path = _get_import_paths(config.registry.settings)
    scss.LOAD_PATHS = ','.join([scss.LOAD_PATHS, ','.join(load_paths)])
    scss.STATIC_ROOT = static_path
    config.add_renderer('scss', renderer_factory) 
```

pyScss 中的`Scss`类确实包含一个 LOAD_PATHS 指令，但我看不到对象 scss 绑定到 Scss 类定义的位置。我想知道`def includeme`上面是否缺少一些可能是答案的一部分，但随后它引出了一个问题——这在另一台机器上工作正常，为什么现在中断？还有一些东西我只是没有接受。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:56:40.010

通过检查`scss`包的代码，看起来`LOAD_PATHS`全局变量可能已从`__init__.py`移至`config.py`.

因此，如果您想尝试修复`pyramid_scss`应用程序，可以将第 88 行更改`pyramid_scss/__init__.py`为：

```
scss.config.LOAD_PATHS = ','.join([scss.config.LOAD_PATHS, ','.join(load_paths)]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T20:48:05.623

最后一行告诉您*哪个*模块受到影响：

```
 scss.LOAD_PATHS = ','.join([scss.LOAD_PATHS, ','.join(load_paths)])
AttributeError: 'module' object has no attribute 'LOAD_PATHS' 
```

所以`scss`模块没有`LOAD_PATHS`属性。

# deployment - SSIS 包部署

> ID：15121999
> 
> 赞同：0
> 
> 时间：2013-02-27T20:43:14.717
> 
> 标签：deployment, ssis-2008

我们正在使用当前设置遇到部署噩梦：

```
1 - DEV makes changes to SSIS 
2 - All the packages that change have to be uploaded again to MSDB
3 - once the deployment is done we use dtexe /SQL switch 
```

我们本质上想要的是删除第 2 步并将 dtsx 作为文件部署，而不是将其上传到 MSDB，这样任何时候需要投入生产的 DEV 更改都只是文件推送。

为此，我们可以使用 dtexec /F 开关

我的问题是，有没有办法仍然使用 /SQL 开关并让它使用文件系统以便部署是透明的，或者有其他方法可以实现这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T15:22:09.390

我们最终使用了以下解决方案：

```
Use dtsx packages as files rather then uploading to MSDB.
Use the /F switch inside /COM (Command file) 
```