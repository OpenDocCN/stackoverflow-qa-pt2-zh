# StackOverflow 问答 15178000-15178999

# ruby-on-rails-3 - 如何在 Rails 3 中为嵌套资源配置路由

> ID：15178000
> 
> 赞同：0
> 
> 时间：2013-03-02T18:40:14.070
> 
> 标签：ruby-on-rails-3, routes, installation

在我的应用程序中，一个用户有很多帖子，一个帖子有很多评论。我应该如何配置路由？我已经这样配置它：

```
resources :users do 
  resources :post do 
    resources :comments 
  end 
end 
```

有些文章说不推荐这样做，因为它会令人困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T13:55:12.893

是的，不推荐。但允许在铁轨中

你应该使用这样的东西

```
resources :users do
  resources :posts
end

resources : posts do
  resources :comments
end 
```

由于深度嵌套会产生问题，例如 rails 中的长路径名和 urls 中的长 url。

# c++ - 调整窗口大小导致右边框附近出现拖尾

> ID：15178002
> 
> 赞同：2
> 
> 时间：2013-03-02T18:40:23.390
> 
> 标签：c++, windows, api, winapi

我在 Visual Studio 2010 中创建了一个标准的 win32 Windows 应用程序。我所做的唯一补充是 WM_PAINT 处理程序中的 TextOut 调用，它在位置 0、0 处显示字母表（宽度重复 4 次）。

我的问题是，当我调整窗口大小并向右扩展时，右侧边框出现一些绘图错误。在调整大小/绘图过程中会显示黑色块，就好像右手边被拉伸一样。结果是当我调整大小时出现奇怪的黑色“拖尾”效果。它只发生在调整大小期间；一旦我释放鼠标，窗口看起来是正确的。

我尝试过对内存 DC 进行双缓冲，但效果相同。我没有使用任何 Windows 主题代码。

我可以删除效果的唯一方法是处理 WM_NCPAINT（并返回 0）——但是，当然，这意味着没有绘制边框，这不是一个可接受的解决方案！我提到它以防它对任何有想法的人有所帮助。

## 感谢您的任何想法或帮助！

@Arx – 抱歉，我没有说清楚。当我说边框涂抹时，我指的是显示文本的右侧边缘，而不是边框​​本身。

如果我只是在 WM_PAINT 处理程序中添加 TextOut 调用，就会发生这种情况。处理 WM_ERASEBKGRND 和设置窗口类背景画笔没有区别。

@David – 抱歉。在新项目向导创建的标准 VS 2008 Win32 应用程序中只添加一行后，我看到了效果——所以我没有看到发布 200 多行代码只有一行感兴趣的意义 :)

我将此行添加到 WM_PAINT 处理程序：

```
TextOut (hdc, 0, 0, L"ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZ", 104); 
```

这是添加了双缓冲的完整代码版本。随着窗口的展开，右侧（窗口边缘）的文本仍然会出现拖尾现象。

```
// win32_smearing_at_border.cpp : Defines the entry point for the application.
//

#include "stdafx.h"
#include "win32_smearing_at_border.h"

#define MAX_LOADSTRING 100

// Global Variables:
HINSTANCE hInst;                                // current instance
TCHAR szTitle[MAX_LOADSTRING];                  // The title bar text
TCHAR szWindowClass[MAX_LOADSTRING];            // the main window class name

// Forward declarations of functions included in this code module:
ATOM                MyRegisterClass(HINSTANCE hInstance);
BOOL                InitInstance(HINSTANCE, int);
LRESULT CALLBACK    WndProc(HWND, UINT, WPARAM, LPARAM);
INT_PTR CALLBACK    About(HWND, UINT, WPARAM, LPARAM);

int APIENTRY _tWinMain(HINSTANCE hInstance,
                     HINSTANCE hPrevInstance,
                     LPTSTR    lpCmdLine,
                     int       nCmdShow)
{
    UNREFERENCED_PARAMETER(hPrevInstance);
    UNREFERENCED_PARAMETER(lpCmdLine);

    // TODO: Place code here.
    MSG msg;
    HACCEL hAccelTable;

    // Initialize global strings
    LoadString(hInstance, IDS_APP_TITLE, szTitle, MAX_LOADSTRING);
    LoadString(hInstance, IDC_WIN32_SMEARING_AT_BORDER, szWindowClass, MAX_LOADSTRING);
    MyRegisterClass(hInstance);

    // Perform application initialization:
    if (!InitInstance (hInstance, nCmdShow))
    {
        return FALSE;
    }

    hAccelTable = LoadAccelerators(hInstance, MAKEINTRESOURCE(IDC_WIN32_SMEARING_AT_BORDER));

    // Main message loop:
    while (GetMessage(&msg, NULL, 0, 0))
    {
        if (!TranslateAccelerator(msg.hwnd, hAccelTable, &msg))
        {
            TranslateMessage(&msg);
            DispatchMessage(&msg);
        }
    }

    return (int) msg.wParam;
}

//
//  FUNCTION: MyRegisterClass()
//
//  PURPOSE: Registers the window class.
//
//  COMMENTS:
//
//    This function and its usage are only necessary if you want this code
//    to be compatible with Win32 systems prior to the 'RegisterClassEx'
//    function that was added to Windows 95\. It is important to call this function
//    so that the application will get 'well formed' small icons associated
//    with it.
//
ATOM MyRegisterClass(HINSTANCE hInstance)
{
    WNDCLASSEX wcex;

    wcex.cbSize = sizeof(WNDCLASSEX);

    wcex.style                  = CS_HREDRAW | CS_VREDRAW;
    wcex.lpfnWndProc        = WndProc;
    wcex.cbClsExtra         = 0;
    wcex.cbWndExtra         = 0;
    wcex.hInstance          = hInstance;
    wcex.hIcon                  = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_WIN32_SMEARING_AT_BORDER));
    wcex.hCursor                = LoadCursor(NULL, IDC_ARROW);
    wcex.hbrBackground  = 0; //(HBRUSH)(COLOR_WINDOW+1);
    wcex.lpszMenuName       = MAKEINTRESOURCE(IDC_WIN32_SMEARING_AT_BORDER);
    wcex.lpszClassName  = szWindowClass;
    wcex.hIconSm                = LoadIcon(wcex.hInstance, MAKEINTRESOURCE(IDI_SMALL));

    return RegisterClassEx(&wcex);
}

//
//   FUNCTION: InitInstance(HINSTANCE, int)
//
//   PURPOSE: Saves instance handle and creates main window
//
//   COMMENTS:
//
//        In this function, we save the instance handle in a global variable and
//        create and display the main program window.
//
BOOL InitInstance(HINSTANCE hInstance, int nCmdShow)
{
   HWND hWnd;

   hInst = hInstance; // Store instance handle in our global variable

   hWnd = CreateWindow(szWindowClass, szTitle, WS_OVERLAPPEDWINDOW,
      CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, NULL, NULL, hInstance, NULL);

   if (!hWnd)
   {
      return FALSE;
   }

   ShowWindow(hWnd, nCmdShow);
   UpdateWindow(hWnd);

   return TRUE;
}

//
//  FUNCTION: WndProc(HWND, UINT, WPARAM, LPARAM)
//
//  PURPOSE:  Processes messages for the main window.
//
//  WM_COMMAND  - process the application menu
//  WM_PAINT    - Paint the main window
//  WM_DESTROY  - post a quit message and return
//
//
LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    int wmId, wmEvent;
    PAINTSTRUCT ps;
    HDC hdc;

  static HDC memory_dc;
  static HBITMAP memory_bmp;
  static HBITMAP oldbmp;

    switch (message)
    {
    case WM_COMMAND:
        wmId    = LOWORD(wParam);
        wmEvent = HIWORD(wParam);
        // Parse the menu selections:
        switch (wmId)
        {
        case IDM_ABOUT:
            DialogBox(hInst, MAKEINTRESOURCE(IDD_ABOUTBOX), hWnd, About);
            break;
        case IDM_EXIT:
            DestroyWindow(hWnd);
            break;
        default:
            return DefWindowProc(hWnd, message, wParam, lParam);
        }
        break;

    case WM_ERASEBKGND:
    return 1;

    case WM_CREATE:
        // Create memory DC
    {
    HDC dc     = GetDC (hWnd);
        memory_dc  = CreateCompatibleDC (dc);
        memory_bmp = CreateCompatibleBitmap (dc, 2560, 1440); // arbitary values for testing, set to my current monitor size.
        oldbmp     = (HBITMAP)SelectObject(memory_dc, memory_bmp);
    TextOut (memory_dc, 0, 0, L"ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZ",104);
      ReleaseDC (hWnd, dc);
    }

    case WM_PAINT:
        hdc = BeginPaint(hWnd, &ps);
        BitBlt(hdc, ps.rcPaint.left, ps.rcPaint.top, ps.rcPaint.right-ps.rcPaint.left, ps.rcPaint.bottom-ps.rcPaint.top, memory_dc, ps.rcPaint.left, ps.rcPaint.top, SRCCOPY);
        EndPaint(hWnd, &ps);
        break;

    case WM_DESTROY:
        // Clean up memory DC
        SelectObject (memory_dc,oldbmp);
        DeleteObject (memory_bmp);
        DeleteDC     (memory_dc);

        PostQuitMessage(0);
        break;

    default:
        return DefWindowProc(hWnd, message, wParam, lParam);
    }
    return 0;
}

// Message handler for about box.
INT_PTR CALLBACK About(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)
{
    UNREFERENCED_PARAMETER(lParam);
    switch (message)
    {
    case WM_INITDIALOG:
        return (INT_PTR)TRUE;

    case WM_COMMAND:
        if (LOWORD(wParam) == IDOK || LOWORD(wParam) == IDCANCEL)
        {
            EndDialog(hDlg, LOWORD(wParam));
            return (INT_PTR)TRUE;
        }
        break;
    }
    return (INT_PTR)FALSE;
} 
```

* * *

嗨，Arx

非常感谢您试用代码 - 我很感激。很高兴知道它对你有用。

但是……我正在经历一些非常奇怪的结果。在 Windows 7 x64 机器上运行时出现“模糊”问题。但是，在 Windows 7 虚拟机中尝试（在同一台机器上使用 VMWare），它可以完美运行。

所以在同一台机器上，它本身就模糊了，但实际上它没有。我什至尝试了 Windows 8 虚拟机，它再次运行良好。

我发现如果我选择一个非航空主题，一切正常（尽管没有航空它看起来不太好）。然而在它工作的其他机器上，他们确实选择了 Aero 主题。我真的不明白。

所以这不是一个真正的解决方案。我不想让我的潜在客户关闭 Aero。

我尝试调用许多 Dwm* 函数，试图找出工作机器和非工作机器之间的区别，但找不到任何东西。

如果我插入此代码：

```
DWMNCRENDERINGPOLICY policy = DWMNCRP_DISABLED;
DwmSetWindowAttribute(hWnd, 
                      DWMWA_NCRENDERING_POLICY, 
                      (void*)&policy, 
                      sizeof(DWMNCRENDERINGPOLICY)); 
```

就在创建主窗口之后，一切都会再次正常运行（尽管再一次，没有 Aero 边框看起来不太好）。

所以我真的不知道如何前进。任何想法都感激不尽！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-10-26T08:56:32.950

我想我可以提供一些关于涂抹/模糊的来源以及您在 Windows 8/10 Aero 中看到更多（或不同）的原因的更多见解。

您的代码具有以下事实：

```
wcex.style = CS_HREDRAW | CS_VREDRAW; 
```

这就是您在 Win7 上没有看到拖尾/模糊的原因。这会导致 Windows 用纯色填充尚未由 WM_PAINT 绘制的窗口的新暴露区域，这并不完美但不会让人分心。

但在 Windows 8/10 Aero 下，情况有所不同。应用程序不会直接绘制到屏幕上，而是绘制到屏幕外缓冲区，然后由邪恶的 DWM.exe 窗口管理器合成。事实证明，DWM 实际上`BitBlt`在`BitBlt`受`CS_HREDRAW | CS_VREDRAW`.

DWM blit 行为更加疯狂，因为它们不仅复制客户区，而且实际上复制了旧客户区边缘的像素以创建新客户区。

不幸的是，让 DWM 不做它的 blit 比仅仅传递一些额外的标志要困难得多。

我没有 100% 的解决方案，但请参阅此问答，了解一种计时技巧，可用于大大降低 DWM 与您的窗口客户区混淆的频率，这将减少拖尾/模糊：

[如何在调整窗口大小时平滑难看的抖动/闪烁/跳跃，尤其是拖动左/上边框（Win 7-10；bg、bitblt 和 DWM）？](https://stackoverflow.com/questions/53000291/how-to-smooth-ugly-jitter-flicker-jumping-when-resizing-windows-especially-drag)

享受！

# c# - asp.net + Viewstate 和逗号分隔的字符串

> ID：15178003
> 
> 赞同：1
> 
> 时间：2013-03-02T18:40:29.730
> 
> 标签：c#, asp.net, viewstate

我已经阅读了很多关于页面如何因过度使用 Viewstate 而陷入困境的文章，我不确定是否使用逗号分隔的字符串（可能是 3-4 个单词）并将其拆分为数组

```
string s = 'john,23,usa';
string[] values = s.Split(','); 
```

检索会有所帮助，因为我看到我的许多同事正在这样做，大概是为了提高页面加载性能。任何人都可以建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T20:04:42.683

实际上，在某些情况下它确实会有所不同，但它看起来很棘手并且通常是无关紧要的。
请参阅以下案例：

这些示例`ViewState`以字节为单位显示大小，这意味着没有任何内容的页面会产生 68 字节`ViewState`。其他所有内容都是手动加载到`ViewState`.

将字符串值 0..9999 放在`ViewState`.

```
string x = string.Empty;

for (int i = 0; i < 10000; i++)
{
    if (i != 0) x += ",";

    x += i;
}

//x = "0,1,2,3,4,5,6,7,8...9999"
ViewState["x"] = x;

//Result = 65268 bytes 
```

并带有一个数组：

```
string[] x = new string[10000];

for (int i = 0; i < 10000; i++)
{
    x[i] = i.ToString();
}

ViewState["x"] = x;

//Result = also 65268 bytes 
```

`ViewState`当在可覆盖方法上返回时，上述两种情况都会导致 65260 字节`SaveViewState`。`ViewState`比将其加载到对象上少 8 个字节。

但是，在其他一些情况下：

```
//104 bytes
ViewState["x"] = "1,2,3,4,5,6,7,8,9,10" 

// 108 bytes
ViewState["x"] = new string[] { "1", "2", "3" , "4", "5", "6", "7", "8", "9", "10"} 
```

如果您覆盖页面`SaveViewState`方法：

```
protected override object SaveViewState()
{
    //100 bytes
    return new string[] { "1", "2", "3", "4", "5", "6", "7", "8", "9", "10" };

    //100 bytes
    return "1,2,3,4,5,6,7,8,9,10";
} 
```

由于`ViewState`是加密的，`Base64 encoded,`在某些情况下，它可能只是对两个不同对象进行字符串编码的问题，这些对象会为页面生成两个不同的输出。

# objective-c - 带有随机文本/值或标签的 UIButton

> ID：15178005
> 
> 赞同：2
> 
> 时间：2013-03-02T18:40:40.993
> 
> 标签：objective-c, uibutton, arc4random

我在历史板上创建了 10 个 UIButton，好吗？
我想添加不重复这些数字的随机数，即在加载视图时穿插的从 0 到 9 的数字。

我试图在谷歌和这里找到一种使用我现有按钮（10 UIButton）的方法，并将它们应用于随机值​​。找到的大多数方法 ( `arc4random() % 10`)，重复数字。

*   [这是一个](https://stackoverflow.com/questions/9271890/xcode-add-multiple-buttons-programmatically-with-specific-names-and-animate)
*   [这是另一个](https://stackoverflow.com/questions/10596414/put-random-uibuttons-title-of-nsmutablearray-to-uibuttons-of-nsmutablearray)
*   [这是另一个](https://stackoverflow.com/questions/14684131/random-order-of-buttons)

所有结果发现动态创建按钮。有人经历过吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T23:07:26.520

创建一个数字数组。然后对数组中的元素执行一组随机交换。您现在拥有以随机顺序排列的唯一编号。

```
- (NSArray *)generateRandomNumbers:(NSUInteger)count {
    NSMutableArray *res = [NSMutableArray arrayWithCapacity:count];
    // Populate with the numbers 1 .. count (never use a tag of 0)
    for (NSUInteger i = 1; i <= count; i++) {
        [res addObject:@(i)];
    }

    // Shuffle the values - the greater the number of shuffles, the more randomized
    for (NSUInteger i = 0; i < count * 20; i++) {
        NSUInteger x = arc4random_uniform(count);
        NSUInteger y = arc4random_uniform(count);
        [res exchangeObjectAtIndex:x withObjectAtIndex:y];
    }

    return res;
}

// Apply the tags to the buttons. This assumes you have 10 separate ivars for the 10 buttons
NSArray *randomNumbers = [self generateRandomNumbers:10];
button1.tag = [randomNumbers[0] integerValue];
button2.tag = [randomNumbers[1] integerValue];
...
button10.tag = [randomNumbers[9] integerValue]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:29:51.710

@meth 有正确的想法。如果您想确保数字不重复，请尝试以下操作：（注意：顶部将生成最高数字。确保此 => 数量，否则这将永远循环；）

```
- (NSArray*) makeNumbers: (NSInteger) amount withTopBound: (int) top
{ 
     NSMutableArray* temp = [[NSMutableArray alloc] initWithCapacity: amount];

     for (int i = 0; i < amount; i++)
     {
        // make random number
        NSNumber* randomNum; 

        // flag to check duplicates
        BOOL duplicate;

        // check if randomNum is already in your array
        do
        {
            duplicate = NO;
            randomNum = [NSNumber numberWithInt: arc4random() % top];

            for (NSNumber* currentNum in temp)
            {
                if ([randomNum isEqualToNumber: currentNum])
                {
                    // now we'll try to make a new number on the next pass
                    duplicate = YES;
                }
            }
        } while (duplicate)

        [temp addObject: randomNum];
    }

    return temp;
} 
```

# excel - EXCEL 从一个文档复制并连接到另一个文档

> ID：15178007
> 
> 赞同：0
> 
> 时间：2013-03-02T18:40:58.320
> 
> 标签：excel, excel-formula, formula, vba

我无法弄清楚如何将 exel 表重新格式化为 4 个不同的表。截至目前，我必须记录一份文件，一份有数据，一份需要重新格式化其他人的数据。

这是背景：

1.  第一个文档在一年中的每个 (12) 月有 48 行*（4 组）*
2.  相应的列来自 2012-1950 年
3.  *ex.-->*第一行是 1 月，降水值是 2012 年，然后是 2011 年、2010 年等。
4.  *ex.-->*第二行是 JANUARY，maxTemp 值是同一年
5.  第三行与 minTemp 和第四 avgTemp 相同；然后这4个重复12次
6.  我需要为一种数据类型复制并连接所有月份
7.  （以相反的顺序，因此数据是从 1950 年 1 月到 2012 年 1 月）
8.  并将其粘贴到 4 个 excel 文档中的 1 个的新行中（每种数据类型一个）
9.  所以最后一行将包含*ex precipitation* Jan1950, Feb1950, March1950 ... Nov2012, Dec2012
10.  这样，从 1950 年 1 月到 2012 年 12 月，一行将有 12（月）*62（年）按顺序排列
11.  基本上会有 4 个 excel 文档，每个文档都有一个非常长的行

* * *

这是我的想法

（除非有更好的方法）我想知道是否有一个宏（或公式）可以：

1.  *对应于 Jan1950-Jan2012 的 Precip*以相反的顺序（即 Z3-C3）取行的一部分
**   复制它并将其与...连接起来*   另一行的相同部分以相反的顺序（即 Z7-C7）*对应于 Feb1950-Feb2012 的 Precip**   另一行倒序（即 Z12-C12）*对应于 Mar1950-Mar2012 的 Precip**   重复所有 12 个月*   将它们粘贴到沉淀excel文档中*   这需要对所有四种数据类型进行（即 Z4-C4 是 minTemp Jan 1950-2012；Z8-C8 Feb；等等）*

 **再次产生一行，其中包含从 1950 年 1 月到 2012 年 12 月仅针对该数据类型的数据*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:45:56.960

**更新**

我已经测试了下面的 VBA 方法，但由于列限制，它（对我来说）失败了，所以除非你有 64 位版本（或者可能是 2003 年以后的版本）的 excel，否则你将无法使用列来做到这一点。我已经修改了 VBA 版本以使用行而不是列，它工作正常。

我在这里做了两个版本的演示：[https ://dl.dropbox.com/u/14854735/ptdata.xls](https://dl.dropbox.com/u/14854735/ptdata.xls)

**VBA 方法（简单/快速）**

以下内容未经测试。创建工作簿的副本以进行处理，打开代码编辑器并将以下内容粘贴到新的代码模块（不是工作簿或工作表代码部分）。

```
Const ROW_HEADER = 1 ' No Row Header - Set to 0
Const COL_HEADER = 1 ' No Column Header - Set to 0

Sub FormatDocument()
' This sub assumes the following
' Your source worksheet has column headers (row 1)
' Your source worksheet has row headers (column 1)
' So your data is bound by the range $B$2:$BL$49
' See above constants if this is not the case
' Your source sheet must be the active sheet when you run this sub (unless you edit below)
Dim Source As Worksheet
Dim Destination As Worksheet

Dim Pass As Integer
Dim CYear As Integer
Dim CMonth As Integer
Dim Column As Integer

Set Source = Thisworkbook.ActiveSheet ' If possible change this to the name of the source sheet

For Pass = 1 To 4
    Set Destination = ThisWorkbook.Worksheets.Add
    Column = 1
    For CYear = (63 + ROW_HEADER) To (1 + ROW_HEADER) Step -1
        For CMonth = 0 To 11
            Destination.Cells(Column, 1).Value = Source.Cells(COL_HEADER + Pass + (CMonth * 4), CYear).Value
            ' NOTE: I've switched the row and column
            ' It will now use many rows and a single column
            ' Destination.Cells(1, Column).Value = Source.Cells(COL_HEADER + Pass + (CMonth * 4), CYear).Value
            Column = Column + 1
        Next
    Next CYear
Next Pass

End Sub 
```

**公式法**

以下公式应粘贴到您的目标工作表中并复制到所有必需的单元格中（在修改它以采用所需的值类型之后）。这本质上是将二维数组（您的数据）映射到一维数组上。

```
=INDIRECT(ADDRESS(((((COLUMN()-1)-(12*INT((COLUMN()-1)/12))))*4)+2,64-INT(COLUMN()/12),1,TRUE,"SourceSheet")) 
```

我已经更新了公式，它现在应该可以按预期工作，但是仍然受到列数的限制（Jan1950-Apr1971 是我可以输入的）

此代码还应考虑列和行标题，如果您不需要它们，则`+1+n`变为`+0+n`和`64-INT(COLUMN()/12)+1`变为`64-INT(COLUMN()/12)+0` 。对未来问题的提示：如果您尝试自己制定解决方案（实际代码或公式，而不仅仅是大纲），您应该将其包含在您的问题中。所以我们可以看到你自己尝试了:)*

# c - 我如何读取文本文件字母并保存到 C 中的数组中

> ID：15178009
> 
> 赞同：0
> 
> 时间：2013-03-02T18:41:16.890
> 
> 标签：c

当 i cout holder(is char) 值时，显示一个歧义字母。如何读取字母并保存到数组然后打印它们？

```
while (holder=fgetc(fileA) != EOF) {
    cout << holder;
    lenA++;
    temp = (char*) realloc(seqA,lenA*sizeof(char));
    if (temp != NULL) {
        seqA = temp;
        seqA[lenA-1] = holder;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:42:31.187

对于初学者，您需要一些括号，否则您将继续存储 and 的结果之间的`fgetc`比较`EOF`：

```
while((holder=fgetc(fileA)) != EOF)
      ^                   ^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:23:51.027

`fgetc`返回一个`int`，而不是一个`char`。这是因为`EOF`大于 char 可以存储的值（以避免与 中的值冲突`char`）。因此，您很可能会越过文件末尾并读取随机数据。

将持有人更改为`int`并`(char)holder`在打印并将其存储在数组中时使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:04:01.443

我再次建议您首先通过查找到最后并确定文件大小来检测文件的大小，一次分配内存并通过一次调用 fread 一次读取整个文件。

看我对你[上一个问题的回答](https://stackoverflow.com/questions/15173870/number-of-letters-in-a-text-file/15174713#15174713%20previous%20question)

# symfony - 将 sf2.0 升级到 sf2.2 后出现路由问题

> ID：15178010
> 
> 赞同：2
> 
> 时间：2013-03-02T18:41:23.543
> 
> 标签：symfony, twig, symfony-2.2

我升级了我的 SF 版本（2.0.18 到 2.2），但在树枝模板上渲染路由时遇到问题。

错误信息 ：

> 在“OlrLoanBundle:Default:index.html.twig”中呈现模板（“未找到“GET Security:login”的路由”）时引发异常。

我的布局：

```
<body>
            <div id="main" class="container">
              <div class="row-fluid">
                  <div class="span4">
                      <img src="{{ asset('img/logo.jpg') }}"/>
                  </div>
                  <div class="span8">
                    {% render "FOSUserBundle:Security:login" %}
                    <img src="{{ asset('img/pub.jpg') }}"/>
                  </div>
              </div>        
                {% block content %}{% endblock %}
            </div>
            <div id="footer" class="left a-left">
                {% block footer %}
                {% endblock %}
                {% block javascripts %}
                        <script type="text/javascript" src="http://code.jquery.com/jquery.js"></script>
                        <script type="text/javascript" src="{{ asset('js/bootstrap.min.js') }}"></script>
                {% endblock %}
            </div>
     </body> 
```

我在模板上遇到了同样的问题：

```
 {% extends '::base.html.twig' %}
    {% block content %}
     <div class="row-fluid">
       <div class="span7">

        {% render "OlrLoanBundle:Demande:index" %}
        {% render "OlrLoanBundle:Demande:tribu" %}
        {% render "OlrLoanBundle:Objet:index" %}
     </div>
      </div>
    <div class="span5">
    <img src="{{ asset('img/pub-carre.jpg') }}"/>
    {% render "OlrLoanBundle:Tribu:index" %}

    </div>
  </div>
 {% endblock %} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:54:23.067

是的，我也发生过。然而，这是官方博客中所述的理想行为：

> 从 Symfony 2.0.20/2.1.5 开始，Twig 渲染标签现在采用绝对 url 而不是控制器逻辑路径。这修复了官方博客上报告的一个重要安全问题 ( [CVE-2012-6431 )。](http://symfony.com/blog/security-release-symfony-2-0-20-and-2-1-5-released)如果您的应用程序使用旧版本的 Symfony 或仍然使用以前的渲染标签语法，您应该尽快升级。

祝你好运修复代码;）

# meteor - 在 Meteor 中，如何在另一个 js 文件服务器端包含一个 js 文件？

> ID：15178015
> 
> 赞同：0
> 
> 时间：2013-03-02T18:41:51.177
> 
> 标签：meteor

在 Meteor 中有一种方法可以在另一个 js 文件中包含一个 js 文件。

具体来说，服务器端，最重要的是在启动时。

我遇到的用例是复杂的 Meteor.startups，我需要将相当多的数据加载到 mongodb 到各种集合中。

为了拥有不同的测试脚本，我必须拥有多个文件，每个文件都包含重复数据。

那么，是否有一个 boostrap.js 文件调用 Meteor.startup 然后能够加载不同的文件以加载测试数据？

或者这可以通过某种对象以不同的方式完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:52:10.833

根据设计，Meteor 将自动包含整个项目中的所有 javascript 文件（公用文件夹中的除外），但仅将它们隔离在服务器和客户端之间。

您可以在单独的文件中创建对象，并随时使用函数或对象，它们应该在启动时都可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T19:11:27.420

尝试使用我为 Meteor 制作的模块加载器。它与 AMD 非常相似：[https ://github.com/matb33/meteor-smd](https://github.com/matb33/meteor-smd)

# nosql - hbase 行键设计

> ID：15178017
> 
> 赞同：0
> 
> 时间：2013-03-02T18:42:03.677
> 
> 标签：nosql, hbase

由于数据增加，我正在从 mysql 迁移到 hbase。

我正在设计高效访问模式的行键。

我想实现3个目标。

1.  获取电子邮件地址的所有结果
2.  获取电子邮件地址 + item_type 的所有结果
3.  获取特定电子邮件地址 + item_id 的所有结果

我有4个属性可供选择

1.  用户电子邮件
2.  反向时间戳
3.  物品种类
4.  item_id

我的 rowkey 应该是什么样子才能有效地获取行？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T04:59:42.773

假设您的主要访问是通过电子邮件，您可以将主表键作为电子邮件 + 反向时间 + item_id（假设 item_id 为您提供唯一性）

您可以有一个附加的“索引”表，其中 email+item_type+reverse time+item_id 和 email+item_id 作为映射到第一个表的键（因此通过这些检索是一个两步过程）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T23:42:17.590

就连接的行键而言，也许您已经朝着正确的方向前进：无论如何，您的帖子都会想到以下内容：

分区键可能由您的反向时间戳加上最常查询的自然键组成 - 会是电子邮件吗？让我们假设：然后选择根据两者中的哪一个（反向时间戳与电子邮件）制作前缀，以提供最平衡/非偏斜的数据分布。这使您的区域服务器更快乐。

根据记录的更好平衡分布进行选择：反向时间戳加上最常查询的自然键，例如 reversetimestamp-email 或 email-reversetimestamp

这样，您将避免在您的区域服务器上出现热点。.

为了在附加的（二级）索引上获得良好的性能，这还没有“融入”hbase：他们有一个设计文档（在 wiki 中的 SecondaryIndexing 下查看）。

但是您可以通过以下几种方式构建自己的：

a) 使用协处理器将 item_type 编写为 rowkey，以将 tabole 与包含原始 (user_email-reverse timestamp (或反之亦然) 事实表 rowke 的列分开

b）如果磁盘空间没有问题和/或行很小，请继续并在第二个（对于 item-id 情况下为第三个）表中复制整行。

# c++ - 自定义容器的自定义迭代器

> ID：15178022
> 
> 赞同：2
> 
> 时间：2013-03-02T18:42:22.553
> 
> 标签：c++, iterator, boost-iterators

我正在设计一个网格容器，表示为一维数组（模板化）。我在这里发布了代码的摘录，实际上还有更多内容。它在机器人应用程序中用作滚动占用网格，其中每个单元代表世界的一小块区域。

我经常对该网格执行的一项操作是遍历所有单元格并检索它们的世界坐标：

```
for( unsigned r=0; r<mygrid.rows_; ++r ) {
  for( unsigned c=0; c<mygrid.cols_; ++c ) {
    cell = mygrid.getRC(r,c);
    mygrid.rcToXY(r,c,&x,&y);
  }
} 
```

我想要一个迭代器来存储所有这些：单元格、它的 rc 坐标和它的 xy 坐标。

```
for( Grid<CellType>::const_iterator it=mygrid.begin(); it!=mygrid.end(); ++it ) {
  cell = *it;
  printf("%d %d %f %f\n", it.r(), it.c(), it.x(), it.y());
} 
```

在网上大量的答案和教程之后，我想出了以下实现，它有效。但是对我来说似乎有点笨拙，出于学术考虑，我想让它看起来更好。STL兼容性也很好。

```
template <class G, typename C>
class base_iterator
{
private:
  G* grid_;
  C* cell_;
  unsigned r_, c_;  // local
  double  x_, y_;

// this should be private with access for friends (Grid) only
// but I can't make it work
public:
  base_iterator(G* grid, unsigned r, unsigned c) : grid_(grid), r_(r), c_(c)
  {
    cell_ = ( r<grid->rows_ && c<grid->cols_ ) ? &grid_->getRC(r,c) : 0;
    grid_->rcToXY(r,c,&x_,&y_);
  }

public:
  base_iterator() : grid_(0) { }

  // used to cast an iterator to a const_iterator
  template <class G2, typename C2>
  base_iterator(const base_iterator<G2,C2>& other)
  {
    grid_ = other.grid();
    cell_ = & other.cell();
    r_ = other.r();
    c_ = other.c();
    x_ = other.x();
    y_ = other.y();
  }

  // this should be private with access for friends only
  G* grid() const { return grid_; }

  C& cell() { return *cell_; }
  const C& cell() const { return *cell_; }
  unsigned r() const { return r_; }
  unsigned c() const { return c_; }
  double  x() const { return x_; }
  double  y() const { return y_; }

  C* operator->() { return cell_; }
  const C* operator->() const { return cell_; }

  C& operator*() { return *cell_; }
  const C& operator*() const { return *cell_; }

  //prefix
  base_iterator & operator++()
  {
    // my iteration logic here which needs access to grid
    // in order to find the number of rows, etc.
    return *this;
  }

  //postfix
  base_iterator operator++(int)
  {
    base_iterator it(*this);   // make a copy for result
     ++(*this);              // Now use the prefix version to do the work
     return it;          // return the copy (the old) value.
  }

  template <class G2, typename C2>
  bool operator==(const base_iterator<G2,C2> & other) const
  {
    return cell_ == &other.cell();
  }

  template <class G2, typename C2>
  bool operator!=(const base_iterator<G2,C2>& other) const
  { return cell_!=other.cell(); }
}; 
```

然后在我的网格类中：

```
 typedef base_iterator<Grid<T>,T> iterator;
  typedef base_iterator<Grid<T> const, T const> const_iterator;

  iterator begin() { return iterator(this,0,0); }
  iterator end() { return iterator(this,rows_,cols_); }

  const_iterator begin() const { return const_iterator(this,0,0); }
  const_iterator end() const { return const_iterator(this,rows_,cols_); } 
```

同样，这可行，但我觉得它有点笨拙（参见迭代器代码中的注释），我想知道如何改进它。我看到很多关于使用 boost 迭代器外观或适配器的帖子，但我不知道如何使其适应我的情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T19:08:48.177

好吧，我找到了一个我非常满意的解决方案。这是完整的清单以供参考。有一些棘手的部分花了我一些时间，特别是为了能够在类声明之外进行实现。我还没有设法使类 base_iterator 成为网格的非嵌套类，根据我在这里和那里读到的内容，我认为这是不可能的。

```
#include <cstdio>
#include <cassert>
#include <stdexcept>
#include <algorithm>

template <class T>
class Grid
{
public:
  // these should be private, with public getters...
  double resolution_;
  unsigned rows_, cols_;
  int map_r0_, map_c0_; // grid coordinates of origin of map

private:
  T* cell_;

public:
  Grid(double resolution, unsigned rows, unsigned cols);
  ~Grid() { delete[] cell_; }

  T & getRC(unsigned r, unsigned c);
  const T & getRC(unsigned r, unsigned c) const;
  void rcToXY(unsigned r, unsigned c, double* x, double* y) const;

public:
  template <class GridType, class CellType>
  class base_iterator : std::iterator<std::forward_iterator_tag, CellType>
  {
  private:
    friend class Grid;
    GridType* grid_;
    CellType* cell_;
    unsigned r_, c_;  // local
    double  x_, y_;

    base_iterator(GridType* grid, unsigned r, unsigned c);

  public:
    base_iterator() : grid_(0) { }

    template <class G2, class C2>
    base_iterator(const base_iterator<G2,C2>& other);

    CellType& cell() { return *cell_; }
    const CellType& cell() const { return *cell_; }
    unsigned r() const { return r_; }
    unsigned c() const { return c_; }
    double  x() const { return x_; }
    double  y() const { return y_; }

    CellType* operator->() { return cell_; }
    const CellType* operator->() const { return cell_; }

    CellType& operator*() { return *cell_; }
    const CellType& operator*() const { return *cell_; }

    //prefix
    base_iterator & operator++();

    //postfix
    base_iterator operator++(int);

    template <class G2, class C2>
    bool operator==(const base_iterator<G2,C2> & other) const
    { return cell_ == other.cell_; }

    template <class G2, class C2>
    bool operator!=(const base_iterator<G2,C2>& other) const
    { return cell_ != other.cell_; }
  };

  typedef base_iterator<Grid<T>,T> iterator;
  typedef base_iterator<Grid<T> const, T const> const_iterator;

  iterator begin() { return iterator(this,0,0); }
  iterator end() { return iterator(this,rows_,0); }

  const_iterator begin() const { return const_iterator(this,0,0); }
  const_iterator end() const { return const_iterator(this,rows_,0); }
};

template <class T>
Grid<T>::Grid(double resolution, unsigned rows, unsigned cols)
  : resolution_(resolution), rows_(rows), cols_(cols), map_r0_(0), map_c0_(0)
{
  cell_ = new T[rows_*cols_];
}

template <class T>
T & Grid<T>::getRC(unsigned r, unsigned c)
{
  if (r >= rows_ || c >= cols_)
    throw std::runtime_error("Out of bounds");
  return cell_[r * cols_ + c];
}

template <class T>
const T & Grid<T>::getRC(unsigned r, unsigned c) const
{
  if (r >= rows_ || c >= cols_)
    throw std::runtime_error("Out of bounds");
  return cell_[r * cols_ + c];
}

template <class T>
void Grid<T>::rcToXY(unsigned r, unsigned c, double* x, double* y) const
{
  *x = (map_c0_ + c + 0.5) * resolution_;
  *y = (map_r0_ + r + 0.5) * resolution_;
}

template <class T>
template <class GridType, class CellType>
Grid<T>::base_iterator<GridType,CellType>::base_iterator(GridType* grid, unsigned r, unsigned c)
: grid_(grid), r_(r), c_(c)
{
  if( r<grid->rows_ && c<grid->cols_ ) {
    cell_ = &grid_->getRC(r,c);
    grid_->rcToXY(r,c,&x_,&y_);
  }
  else
    cell_ = &grid_->getRC(grid->rows_-1,grid->cols_-1) + 1;
}

// beautiful triple template declaration !
template <class T>
template <class GridType, class CellType>
template <class G2, class C2>
Grid<T>::base_iterator<GridType,CellType>::base_iterator(const Grid<T>::base_iterator<G2,C2>& other)
{
  grid_ = other.grid_;
  cell_ = other.cell_;
  r_ = other.r();
  c_ = other.c();
  x_ = other.x();
  y_ = other.y();
}

template <class T>
template <class GridType, class CellType>
Grid<T>::base_iterator<GridType,CellType> & Grid<T>::base_iterator<GridType,CellType>::operator++()
{
  assert( grid_!=0 );

  if( c_==grid_->cols_-1 )
  {
    c_ = 0;
    x_ = (grid_->map_c0_ + 0.5) * grid_->resolution_;
    ++r_;
    y_ += grid_->resolution_;
  }
  else
  {
    ++c_;
    x_ += grid_->resolution_;
  }
  ++cell_;

  return *this;
}

template <class T>
template <class GridType, class CellType>
Grid<T>::base_iterator<GridType,CellType> Grid<T>::base_iterator<GridType,CellType>::operator++(int)
{
  base_iterator it(*this);   // make a copy for result
   ++(*this);              // Now use the prefix version to do the work
   return it;          // return the copy (the old) value.
}

void print(unsigned i)
{
  printf("%d ", i);
}

int main()
{
  Grid<unsigned> mygrid(.1,2,3);
  unsigned ctr=0;
  for( Grid<unsigned>::iterator it=mygrid.begin(); it!=mygrid.end(); ++it )
    *it = ctr++;

  ctr = 0;
  printf("All elements: r, c, x, y, value\n");
  for( Grid<unsigned>::const_iterator it=mygrid.begin(); it!=mygrid.end(); ++it ) {
    assert( *it == ctr++ );
    printf("%d %d %f %f %d\n", it.r(), it.c(), it.x(), it.y(), *it);
  }

  printf("All elements values: ");
  std::for_each(mygrid.begin(), mygrid.end(), print);
  printf("\n");

  return 0;
} 
```

# php - 在 PHP exec 命令中使用时密码存储在哪里？

> ID：15178026
> 
> 赞同：0
> 
> 时间：2013-03-02T18:42:39.103
> 
> 标签：php, linux, security

我的 php 网页在服务器上运行一个命令：

```
exec("encrypt -pPassw0rd infile outfile; rm infile"); 
```

服务器是linux。

刚刚跑了一个：

```
grep -R "Passw0rd" / 
```

这足以检查密码是否未存储在任何地方吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T11:02:00.670

这里的重点是，来自用户的输入，无论上下文如何，都不应该被信任！

为了对抗这些类型的攻击，PHP 提供了两个函数，escapeshellarg() 和 escapeshellcmd()。

escapeshellarg() 函数旨在删除或以其他方式消除从用户输入接收到的任何潜在有害字符，以用作系统命令（在我们的示例中为 zip 命令）的参数。该函数的语法如下：

escapeshellcmd() 与其对应的类似，只是它只会转义对底层操作系统具有特殊含义的字符。与 escapeshellarg() 不同，escapeshellcmd() 不会处理包含空格的输入。

如果用户输入将用作系统调用的参数列表的一部分，则 escapeshellarg() 函数始终是更好的选择。

希望有帮助。

法比奥@fcerullo

# c++ - C ++不会接受对象字符串中的@符号？似乎是地址问题？

> ID：15178028
> 
> 赞同：0
> 
> 时间：2013-03-02T18:42:54.287
> 
> 标签：c++, string, oop, vector

我很迷茫。在将数据保存和加载到二进制文件时，我遇到了以下代码的问题。我有一段非常相似/精确的代码可用于不同的对象。我认为这与电子邮件地址和其中的 @ 符号有关。以下是重要的功能。

```
/* This is my save to file function */
FILE *file=fopen("patronsave","wb");
fwrite(&buffer,sizeof(buffer),1,file);
for(int i=0;i<3;i++){
Patron_Class *ppointer = new Patron_Class();
cout << "\n" << endl;
ppointer->save(file);
}
fclose(file); 
```

这是我用来将对象保存到文件的功能。

这是我用来加载文件的代码：

```
vector<Patron_Class*> Patron_Entries;
FILE *file=fopen("patronsave","rb");
fread(&buffer,sizeof(buffer),1,file);
printf("Buffer: %d\n",buffer);
for(int i=0;i<buffer;i++){
    Patron_Class *pointer2 =new Patron_Class(file);
    Patron_Entries.push_back(pointer2);
    Patron_Entries[i] -> print();
    system("pause");
    }
fclose(file); 
```

如果我运行保存功能，然后立即运行加载功能，它可以工作，但如果我只运行加载功能，它会在尝试加载电子邮件时崩溃。这是我的类和目标代码：

```
class Patron_Class{
public:
long patron_id;
string F_name;
string L_name;
long phone_num;
string email;
string street_address;
string city;
string state;
int zip_code;
Patron_Class(){
    cout << "Please enter a new ID" << endl;
    cin >> patron_id;
    cin.ignore(1000, '\n');
    system("cls");
    cout << "Please enter a First name" << endl;
    cin >> F_name;
    cin.ignore(1000, '\n');
    system("cls");
    cout << "Please enter a last name" << endl;
    cin >> L_name;
    cin.ignore(1000, '\n');
    system("cls");
    cout << "Please enter a phone number" << endl;
    cin >> phone_num;
    cin.ignore(1000, '\n');
    system("cls");
    cout << "Please enter a email" << endl;
    cin >> email;
    cin.ignore(1000, '\n');
    system("cls");
    cout << "Please enter a street address" << endl;
    cin >> street_address;
    cin.ignore(1000, '\n');
    system("cls");
    cout << "Please enter a city" << endl;
    cin >> city;
    cin.ignore(1000, '\n');
    system("cls");
    cout << "Please enter a State via it's initials" << endl;
    cin >> state;
    cin.ignore(1000, '\n');
    system("cls");
    cout << "Please enter a zip code" << endl;
    cin >> zip_code;
    cin.ignore(1000, '\n');
    system("cls");
    cout << "You have created a new patron named:   " << F_name << " " << L_name << endl;
}
Patron_Class(FILE *inputfile){
    fread(&patron_id, sizeof(patron_id),1,inputfile);
    fread(&F_name, sizeof(F_name),1,inputfile);
    fread(&L_name, sizeof(L_name),1,inputfile);
    fread(&phone_num, sizeof(phone_num),1,inputfile);
    fread(&email, sizeof(email),1,inputfile);
    fread(&street_address, sizeof(street_address),1,inputfile);
    fread(&city, sizeof(city),1,inputfile);
    fread(&state, sizeof(state),1,inputfile);
    fread(&zip_code, sizeof(zip_code),1,inputfile);
}

void print(){

    cout << patron_id << "    " << F_name << "    " << L_name << "    " << phone_num << "    " << email << "    " << street_address << "    " << city << "    " << state << "    " << zip_code << "\n" << endl;
}

void save(FILE *inputFile){
    fwrite(&patron_id, sizeof(patron_id),1,inputFile);
    fwrite(&F_name, sizeof(F_name),1,inputFile);
    fwrite(&L_name, sizeof(L_name),1,inputFile);
    fwrite(&phone_num, sizeof(phone_num),1,inputFile);
    fwrite(&email, sizeof(email),1,inputFile);
    fwrite(&street_address, sizeof(street_address),1,inputFile);
    fwrite(&city, sizeof(city),1,inputFile);
    fwrite(&state, sizeof(state),1,inputFile);
    fwrite(&zip_code, sizeof(zip_code),1,inputFile);
}

}; 
```

有谁知道它为什么会崩溃？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:26:30.010

这显然是错误的：

```
string F_name;

...
fread(&F_name, sizeof(F_name),1,inputfile);

...
fwrite(&F_name, sizeof(F_name),1,inputFile); 
```

[这同样适用于你的所有其他字符串`PatronClass`- 我在这个例子中使用第一个]

这个类`std::string`看起来像这样（为了说明的目的，确切的实现涉及几个层、一些模板和其他东西，所以为了下面的解释，这被简化了）：

```
class string
{
   char *str;
   int len;

 public: 
   ... 
 }; 
```

因此，当您`fread`从文件中执行并 fwrite 到文件时，您正在从/向文件读取/写入`char *str;`and`int len;`成员。

假设我们从头开始你的程序，文件中没有数据，我们使用`Patron_Class()`构造函数。所以我们读入一个 id，然后`F_name`从控制台读入。假设我们进入`Charles`. 所以不知何故，`string`该类将分配 8 字节的内存，地址为 0x600018。所以`string::str == 0x600018`-`len = 8`在堆中的位置 6000018 是字母`C h a r l e s \0`[ 空格只是为了说明它们位于不同的内存位置]。现在我们将它保存到一个文件中。所以文件包含`00600018 00000008`. `PatronClass(file)`现在我们使用构造函数停止程序并重新启动它。堆完全是空的。我们加载文件数据，所以`string::str = 0x600018`和`len = 8`，但位置 0x600018 不包含`C h a r l e s \0`, 但无论堆初始化时通常使用的堆是什么[很可能是 0]。所以难怪你的名字没有出现。

现在，您的实际程序的确切行为可能与我上面描述的不同，但它不会正常工作。不可能，永远，永远。无论您的姓名、电子邮件地址或代码中的任何其他字符串中有或没有什么字符。它可能出现工作的唯一原因是数据在大多数情况下仍然存在于堆中，并且它似乎正在工作，因为在您的情况下它不会被其他东西覆盖。

# ruby-on-rails - Rails 迁移表

> ID：15178032
> 
> 赞同：0
> 
> 时间：2013-03-02T18:43:19.873
> 
> 标签：ruby-on-rails

据我所知，您在 db/migrations 中指定了模型字段数据类型。这对我来说是新的，因为在 Django 中，您可以直接在 Model 类中指定模型字段数据类型。我这样想对吗？这是rails中的常见做法还是我只是在使用解决方法？

另外，如何在这个 db/migrations 文件中指定表关系。例如，如果我有一个名为 A 类的模型。

我有另一个名为 B 类的模型，我希望与 A 类建立一对多的关系。我只是这样做

```
class ClassA < ActiveRecord::Migration
  def change
    create_table :projects do |t|
      t.classB :name
    end
  end
end 
```

如何验证我的迁移文件和模型文件没有任何语法错误。据我所知，我只是运行 rake db:migrate，但是如果我不希望在文件中指定我的字段数据类型时替换我的迁移文件怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T18:57:56.307

好的，总而言之，您似乎有三个问题：

> 1.：据我所知，您在 db/migrations 中指定了模型字段数据类型。[...] 我的想法正确吗？这是rails中的常见做法还是我只是在使用解决方法？

是的，你是对的。字段数据类型不会显示在模型内部，只会在您的迁移中显示。

顺便说一句：我很少发现自己手动编写迁移文件。如果你使用 rails 命令，它会自动生成迁移文件。例如，如果您使用

`rails g model User first_name:string last_name:string`

这将创建一个名为 User 的模型，以及一个将创建一个包含 fields `id`、`first_name`、`last_name`和 timestamp 字段的 users 表的迁移。如果您想稍后添加或删除列，有一个绝妙的技巧；赶紧跑

`rails g migration add_fields_to_users field_name:field_type`

或者

`rails g migration remove_fields_from_users field_name`.

替换`field_name`,`field_type`和`users`你认为合适的。此命令将为您创建迁移以添加或删除字段，因此您不必手动编写这些。

> 2.：另外，你如何在这个 db/migrations 文件中指定表关系。

你没有。Rails 通过 has_many、belongs_to、has_and_belongs_to 等关联方法为您处理此问题。请查看[此 rails guide to active record associations](http://guides.rubyonrails.org/association_basics.html)。您需要在数据库端做的一件事是为一对多关系添加 foreign_id 列或为多对多关系创建连接表。例如，如果您有一个用户表和一个图片表，并且每张图片都属于一个用户，那么在您的用户模型中您将编写`has_many :pictures`，在您的图片模型中您将编写`belongs_to :user`，并且在您的图片表中您需要一个`user_id`名为整数类型。

> 3.：如何验证我的迁移文件和模型文件没有任何语法错误。

你也没有。你只需运行`rake db:migrate`，如果出现故障，它会告诉你在哪里以及为什么。如果你的模型有语法错误，它会告诉你什么时候启动你的服务器，或者什么时候运行你的测试，或者至少什么时候你在某个地方使用它（例如，当你调用一个模型的方法时）。如果您的意思是如何验证模型的数据，这完全是另一个问题 - 请参阅[本指南活动记录验证和回调](http://guides.rubyonrails.org/active_record_validations_callbacks.html)，其中详细解释了检查存在性、唯一性、长度等的验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T18:59:30.853

你问了几个问题，我们来一一解答：

> 据我所知，您在 db/migrations 中指定了模型字段数据类型。这对我来说是新的，因为在 Django 中，您可以直接在 Model 类中指定模型字段数据类型。我这样想对吗？这是rails中的常见做法还是我只是在使用解决方法？

迁移用于更改数据库。迁移示例：

```
class CreateProducts < ActiveRecord::Migration
  def change
    create_table :products do |t|
      t.string :name
      t.text :description
    end
  end
end 
```

运行此程序时，您将创建一个带有名为 name 的字符串字段的表 products。所以，是的，您在迁移中指定模型字段数据类型。

> 另外，如何在这个 db/migrations 文件中指定表关系。例如，如果我有一个名为 A 类的模型。

您需要在模型中指定您的关系（或关联）。读[这个](http://guides.rubyonrails.org/association_basics.html)，因为它解释得很好。但是要考虑到，在迁移中，您必须以某种方式创建关联，因为您可能需要为多对多关联创建连接表，或者为 has_many 关联创建引用另一个表的列。

> 如何验证我的迁移文件和模型文件没有任何语法错误。据我所知，我只是运行 rake db:migrate，但是如果我不希望在文件中指定我的字段数据类型时替换我的迁移文件怎么办？

我不确定你在这个问题中的意思。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T18:52:10.807

当您创建一个新模型时，rails 会创建您的 shema 迁移文件和您的模型。在迁移文件中，您指定列。可以在这里添加一些代码，但你应该尽可能少做。对于向上和向下，您可以在此处添加/删除列，添加数据库索引等。

在您的模型中，您定义您的关系`belongs_to`，`has_many`等，以及您`scopes`的表和模型的方法。您的模型继承了您的表格列，因此您可以直接访问它们。

我不知道Django，这是rails中的常见做法。

您可以在此处查看关系和其他好的信息：[http ://www.tutorialspoint.com/ruby-on-rails/rails-models.htm](http://www.tutorialspoint.com/ruby-on-rails/rails-models.htm)

# ruby-on-rails - Rails 3.2 f.file_field 导致路由错误

> ID：15178033
> 
> 赞同：3
> 
> 时间：2013-03-02T18:43:21.400
> 
> 标签：ruby-on-rails, forms, ruby-on-rails-3.2, passenger, rails-routing

在轨道 3.2.12 和 3.2.11 上测试。在另一个 rails 3.2.11 项目中，我没有这个问题`f.file_field`，但在目前的项目中，我有并且找不到这种奇怪行为的原因，所以这是我的问题。

我对更新操作有一个奇怪的问题。以下是代码的相关部分：

路线：

```
get "signup" => "users#new", :as => "signup"
get "profile" => "users#profile", :as => "profile"
resources :users do
  member do
    get :activate
  end
end 
```

控制器：

```
def update
  @user = User.find(params[:id])
  if @user.update_attributes(params[:user])
    redirect_to user_path(@user), :notice => t('users_controller.update.updated')
  else
    render :edit
  end
end 
```

以haml形式（简化但具有相同的行为）：

```
= form_for @user do |f|
  .field
    = f.label :first_name 
    %br
    = f.text_field :first_name, :size => 40
  .actions
    = f.submit 
```

因此，在我按下更新后，一切都按预期工作，并且正在更新用户的属性。但是，当我添加这样的文件字段时：

```
= form_for @user do |f|
  .field
    = f.label :first_name 
    %br
    = f.text_field :first_name, :size => 40
  .field
    = f.label :avatar
    %br
    = f.file_field :avatar
  .actions
    = f.submit 
```

然后我按更新然后我得到路由错误：

```
No route matches [PUT] "/1" 
```

我不明白为什么它试图`/1`用方法到达路径`PUT`。在显示路由错误的页面上，我可以`/users/1`在浏览器的地址栏中看到。

这是为表单生成的 html：

```
 <form accept-charset="UTF-8" action="/users/1" class="edit_user" enctype="multipart/form-data" id="edit_user_1" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="_method" type="hidden" value="put" /><input name="authenticity_token" type="hidden" value="che8VLfDxDAoenma+TXwsA+0IQ7+/jbCIK+Q2xwr8uc=" /></div>
    <div class='field'>
      <label for="user_first_name">First name</label>
      <br>
      <input id="user_first_name" name="user[first_name]" size="40" type="text" value="Anton" />
    </div>
    <div class='field'>
      <label for="user_avatar">Avatar</label>
      <br>
      <input id="user_avatar" name="user[avatar]" type="file" />
    </div>
    <div class='actions'>
      <input name="commit" type="submit" value="Update User" />
    </div>
  </form> 
```

所以，最有趣的事情来了。当我将表格更改为此：

```
= form_for @user do |f|
  .field
    = f.label :first_name 
    %br
    = f.text_field :first_name, :size => 40
  .field
    = f.label :avatar
    %br
    %input{:id => "user_avatar", :name => "user[avatar]", :type => "file"}
  .actions
    = f.submit 
```

然后生成的 html 与前一种情况相同（我能看到的唯一区别是文件字段属性使用单引号而不是双引号）：

```
 <form accept-charset="UTF-8" action="/users/1" class="edit_user" id="edit_user_1" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="_method" type="hidden" value="put" /><input name="authenticity_token" type="hidden" value="che8VLfDxDAoenma+TXwsA+0IQ7+/jbCIK+Q2xwr8uc=" /></div>
    <div class='field'>
      <label for="user_first_name">First name</label>
      <br>
      <input id="user_first_name" name="user[first_name]" size="40" type="text" value="Anton" />
    </div>
    <div class='field'>
      <label for="user_avatar">Avatar</label>
      <br>
      <input id='user_avatar' name='user[avatar]' type='file'>
    </div>
    <div class='actions'>
      <input name="commit" type="submit" value="Update User" />
    </div>
  </form> 
```

但提交此表单后，没有路由错误，一切正常。

**更新**

实际上它并没有按应有的方式工作。我只是查看了`params`哈希并看到存在`:avatar`密钥，但我错过了在后一种情况下，html 中的表单打开标记中没有`enctype="multipart/form-data"`属性，因此不会上传文件。添加`enctype=multipart/form-data`属性会导致路由错误再次发生。

我发现在提交多部分表单后`put ":id" => "users#update"`尝试添加路由时`redirect_to user_path(@user)`（确保此路由没有路由错误`PUT`），然后还有路由错误`No route matches [GET] "/users/users/1"`。

这里是完整的`routes.rb`：

```
Myapp::Application.routes.draw do

  match "oauth/callback" => "oauths#callback"
  match "oauth/callback/:provider" => "oauths#callback"
  match "oauth/:provider" => "oauths#oauth", :as => :auth_at_provider

  resources :countries
  resources :categories
  resources :images
  resources :collections
  resources :items

  put ":id" => "users#update"
  get "signup" => "users#new", :as => "signup"
  get "profile" => "users#profile", :as => "profile"
  resources :users do
    member do
      get :activate
    end
  end

  get "signout" => "sessions#destroy", :as => "signout"
  get "signin" => "sessions#new", :as => "signin"
  resources :sessions

  get "site/index"

  root :to => "site#index"

end 
```

和耙路线

```
 oauth_callback        /oauth/callback(.:format)           oauths#callback
                        /oauth/callback/:provider(.:format) oauths#callback
auth_at_provider        /oauth/:provider(.:format)          oauths#oauth
       countries GET    /countries(.:format)                countries#index
                 POST   /countries(.:format)                countries#create
     new_country GET    /countries/new(.:format)            countries#new
    edit_country GET    /countries/:id/edit(.:format)       countries#edit
         country GET    /countries/:id(.:format)            countries#show
                 PUT    /countries/:id(.:format)            countries#update
                 DELETE /countries/:id(.:format)            countries#destroy
      categories GET    /categories(.:format)               categories#index
                 POST   /categories(.:format)               categories#create
    new_category GET    /categories/new(.:format)           categories#new
   edit_category GET    /categories/:id/edit(.:format)      categories#edit
        category GET    /categories/:id(.:format)           categories#show
                 PUT    /categories/:id(.:format)           categories#update
                 DELETE /categories/:id(.:format)           categories#destroy
          images GET    /images(.:format)                   images#index
                 POST   /images(.:format)                   images#create
       new_image GET    /images/new(.:format)               images#new
      edit_image GET    /images/:id/edit(.:format)          images#edit
           image GET    /images/:id(.:format)               images#show
                 PUT    /images/:id(.:format)               images#update
                 DELETE /images/:id(.:format)               images#destroy
     collections GET    /collections(.:format)              collections#index
                 POST   /collections(.:format)              collections#create
  new_collection GET    /collections/new(.:format)          collections#new
 edit_collection GET    /collections/:id/edit(.:format)     collections#edit
      collection GET    /collections/:id(.:format)          collections#show
                 PUT    /collections/:id(.:format)          collections#update
                 DELETE /collections/:id(.:format)          collections#destroy
           items GET    /items(.:format)                    items#index
                 POST   /items(.:format)                    items#create
        new_item GET    /items/new(.:format)                items#new
       edit_item GET    /items/:id/edit(.:format)           items#edit
            item GET    /items/:id(.:format)                items#show
                 PUT    /items/:id(.:format)                items#update
                 DELETE /items/:id(.:format)                items#destroy
                 PUT    /:id(.:format)                      users#update
          signup GET    /signup(.:format)                   users#new
         profile GET    /profile(.:format)                  users#profile
   activate_user GET    /users/:id/activate(.:format)       users#activate
           users GET    /users(.:format)                    users#index
                 POST   /users(.:format)                    users#create
        new_user GET    /users/new(.:format)                users#new
       edit_user GET    /users/:id/edit(.:format)           users#edit
            user GET    /users/:id(.:format)                users#show
                 PUT    /users/:id(.:format)                users#update
                 DELETE /users/:id(.:format)                users#destroy
         signout GET    /signout(.:format)                  sessions#destroy
          signin GET    /signin(.:format)                   sessions#new
        sessions GET    /sessions(.:format)                 sessions#index
                 POST   /sessions(.:format)                 sessions#create
     new_session GET    /sessions/new(.:format)             sessions#new
    edit_session GET    /sessions/:id/edit(.:format)        sessions#edit
         session GET    /sessions/:id(.:format)             sessions#show
                 PUT    /sessions/:id(.:format)             sessions#update
                 DELETE /sessions/:id(.:format)             sessions#destroy
      site_index GET    /site/index(.:format)               site#index
            root        / 
```

有人知道吗？

**更新2**

揭示问题是使用多部分表单帮助找到有关相同问题的这篇文章 -[发布/放置请求（乘客标题）的路由错误，](https://stackoverflow.com/questions/14116180/routing-error-when-uploading-file)但不幸的是没有解决方案......

**更新3**

我发现了一些有趣的东西。有一个方法`/path_to_gemset_here/gem/journey-1.0.4/lib/journey/router.rb`：

```
def find_routes env
  req = request_class.new env

  routes = filter_routes(req.path_info) + custom_routes.find_all { |r|
    r.path.match(req.path_info)
  }

  routes.sort_by(&:precedence).find_all { |r|
    r.constraints.all? { |k,v| v === req.send(k) } &&
      r.verb === req.request_method
  }.reject { |r| req.ip && !(r.ip === req.ip) }.map { |r|
    match_data  = r.path.match(req.path_info)
    match_names = match_data.names.map { |n| n.to_sym }
    match_values = match_data.captures.map { |v| v && Utils.unescape_uri(v) }
    info = Hash[match_names.zip(match_values).find_all { |_,y| y }]

    [match_data, r.defaults.merge(info), r]
  }
end 
```

我检查`env`了非多部分和多部分请求并发现了这一点：

非多部分：

```
"REQUEST_URI"=>"/users/1",
"SCRIPT_NAME"=>"",
"PATH_INFO"=>"/users/1" 
```

多部分：

```
"REQUEST_URI"=>"/users/1",
"SCRIPT_NAME"=>"/users",
"PATH_INFO"=>"/1",
"SCRIPT_FILENAME"=>"/path_to_project_folder_here/public/users", - there is no such variable in a non-multipart request 
```

所以这就是问题所在。正如我在方法的定义中看到的：

```
match_data  = r.path.match(req.path_info) 
```

`PATH_INFO`用于查找处理请求的路由，但在后一种情况下，由于分为`REQUEST_URI`两部分，因此完全错误。不幸的是，我今天没有时间完成我的调查，希望我明天能够完成。

如果有人有足够的好奇心比我更快地找到问题的根源 - 欢迎您:)

**UPDATE4（已编辑）**

因此，这是调查的继续。

方法：`parse_native_request` 在文件中：`/path_to_gemset_here/gems/passenger-3.0.17/lib/phusion_passenger/abstract_request_handler.rb`

`headers_data`此调用后的变量：

```
headers_data = channel.read_scalar(buffer, MAX_HEADER_SIZE) 
```

包含：

```
"SERVER_SOFTWARE\x00Apache/2.2.22 (Ubuntu)\x00
SERVER_PROTOCOL\x00HTTP/1.1\x00
SERVER_NAME\x00myapp.loc\x00
SERVER_ADMIN\x00[no address given]\x00
SERVER_ADDR\x00127.0.0.1\x00
SERVER_PORT\x0080\x00
REMOTE_ADDR\x00127.0.0.1\x00
REMOTE_PORT\x0033199\x00
REQUEST_METHOD\x00POST\x00
QUERY_STRING\x00\x00
CONTENT_TYPE\x00multipart/form-data; boundary=----WebKitFormBoundary8HlzQxocoOROMfRV\x00
DOCUMENT_ROOT\x00/path_to_project_folder_here/public\x00
REQUEST_URI\x00/users/1\x00
SCRIPT_NAME\x00\x00
PATH_INFO\x00/users/1\x00
HTTP_HOST\x00myapp.loc\x00
HTTP_CONNECTION\x00keep-alive\x00
HTTP_CONTENT_LENGTH\x00748\x00
HTTP_CACHE_CONTROL\x00max-age=0\x00
HTTP_ACCEPT\x00text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\x00
HTTP_ORIGIN\x00http://myapp.loc\x00
HTTP_USER_AGENT\x00Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.97 Safari/537.22\x00
HTTP_CONTENT_TYPE\x00multipart/form-data; boundary=----WebKitFormBoundary8HlzQxocoOROMfRV\x00
HTTP_REFERER\x00http://myapp.loc/profile\x00
HTTP_ACCEPT_ENCODING\x00gzip,deflate,sdch\x00
HTTP_ACCEPT_LANGUAGE\x00en-US,en;q=0.8\x00
HTTP_ACCEPT_CHARSET\x00ISO-8859-1,utf-8;q=0.7,*;q=0.3\x00
HTTP_COOKIE\x00_myapp_session=BAh7CEkiDHVzZXJfaWQGOgZFRmkGSSIPc2Vzc2lvbl9pZAY7AEZJIiVhMjU2ZjU5N2VmMTE0YTJiOGEwNGJiYzUyYjM2NDg0OQY7AFRJIhBfY3NyZl90b2tlbgY7AEZJIjFjaGU4VkxmRHhEQW9lbm1hK1RYd3NBKzBJUTcrL2piQ0lLK1EyeHdyOHVjPQY7AEY%3D--a6e5daff1334c083e54b2bcafba43b32e546af9c\x00
UNIQUE_ID\x00UTXfEX8AAQEAACWVEMoAAAAB\x00
GATEWAY_INTERFACE\x00CGI/1.1\x00

>>>> here seems to start a kind of redirect <<<<

SERVER_PROTOCOL\x00HTTP/1.1\x00
REQUEST_METHOD\x00POST\x00
QUERY_STRING\x00\x00
REQUEST_URI\x00/users/1\x00
SCRIPT_NAME\x00/users\x00
PATH_INFO\x00/1\x00
PATH_TRANSLATED\x00/path_to_project_folder_here/public/1\x00
HTTP_HOST\x00myapp.loc\x00
HTTP_CONNECTION\x00keep-alive\x00
CONTENT_LENGTH\x00748\x00HTTP_CACHE_CONTROL\x00max-age=0\x00
HTTP_ACCEPT\x00text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\x00
HTTP_ORIGIN\x00http://myapp.loc\x00
HTTP_USER_AGENT\x00Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.97 Safari/537.22\x00CONTENT_TYPE\x00multipart/form-data; boundary=----WebKitFormBoundary8HlzQxocoOROMfRV\x00
HTTP_REFERER\x00http://myapp.loc/profile\x00
HTTP_ACCEPT_ENCODING\x00gzip,deflate,sdch\x00
HTTP_ACCEPT_LANGUAGE\x00en-US,en;q=0.8\x00
HTTP_ACCEPT_CHARSET\x00ISO-8859-1,utf-8;q=0.7,*;q=0.3\x00
HTTP_COOKIE\x00_myapp_session=BAh7CEkiDHVzZXJfaWQGOgZFRmkGSSIPc2Vzc2lvbl9pZAY7AEZJIiVhMjU2ZjU5N2VmMTE0YTJiOGEwNGJiYzUyYjM2NDg0OQY7AFRJIhBfY3NyZl90b2tlbgY7AEZJIjFjaGU4VkxmRHhEQW9lbm1hK1RYd3NBKzBJUTcrL2piQ0lLK1EyeHdyOHVjPQY7AEY%3D--a6e5daff1334c083e54b2bcafba43b32e546af9c\x00
PATH\x00/usr/local/bin:/usr/bin:/bin\x00
SERVER_SIGNATURE\x00<address>Apache/2.2.22 (Ubuntu) Server at myapp.loc Port 80</address>\n\x00
SERVER_SOFTWARE\x00Apache/2.2.22 (Ubuntu)\x00
SERVER_NAME\x00myapp.loc\x00
SERVER_ADDR\x00127.0.0.1\x00
SERVER_PORT\x0080\x00
REMOTE_ADDR\x00127.0.0.1\x00
DOCUMENT_ROOT\x00/path_to_project_folder_here/public\x00
SERVER_ADMIN\x00[no address given]\x00
SCRIPT_FILENAME\x00/path_to_project_folder_here/public/users\x00
REMOTE_PORT\x0033199\x00
PATH_TRANSLATED\x00/bin/runAV\x00
REDIRECT_STATUS\x00302\x00
PASSENGER_CONNECT_PASSWORD\x00EElt7wIBLlliWGCYJJoezPvecsB2brraBWdiIbD4nul\x00_\x00_\x00" 
```

之后是这个调用：

```
headers = split_by_null_into_hash(headers_data) 
```

并`headers`包含：

```
{"SERVER_SOFTWARE"=>"Apache/2.2.22 (Ubuntu)", 
"SERVER_PROTOCOL"=>"HTTP/1.1", 
"SERVER_NAME"=>"myapp.loc", 
"SERVER_ADMIN"=>"[no address given]", 
"SERVER_ADDR"=>"127.0.0.1", 
"SERVER_PORT"=>"80", 
"REMOTE_ADDR"=>"127.0.0.1", 
"REMOTE_PORT"=>"33243", 
"REQUEST_METHOD"=>"POST", 
"QUERY_STRING"=>"", 
"CONTENT_TYPE"=>"multipart/form-data; boundary=----WebKitFormBoundary8HlzQxocoOROMfRV", 
"DOCUMENT_ROOT"=>"/path_to_project_folder_here/public", 
"REQUEST_URI"=>"/users/1", 
"SCRIPT_NAME"=>"/users", 
"PATH_INFO"=>"/1", 
"HTTP_HOST"=>"myapp.loc", 
"HTTP_CONNECTION"=>"keep-alive", 
"HTTP_CONTENT_LENGTH"=>"748", 
"HTTP_CACHE_CONTROL"=>"max-age=0", 
"HTTP_ACCEPT"=>"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8", 
"HTTP_ORIGIN"=>"http://myapp.loc", 
"HTTP_USER_AGENT"=>"Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.97 Safari/537.22", 
"HTTP_CONTENT_TYPE"=>"multipart/form-data; boundary=----WebKitFormBoundary8HlzQxocoOROMfRV", 
"HTTP_REFERER"=>"http://myapp.loc/profile", 
"HTTP_ACCEPT_ENCODING"=>"gzip,deflate,sdch", 
"HTTP_ACCEPT_LANGUAGE"=>"en-US,en;q=0.8", 
"HTTP_ACCEPT_CHARSET"=>"ISO-8859-1,utf-8;q=0.7,*;q=0.3", 
"HTTP_COOKIE"=>"_myapp_session=BAh7CEkiDHVzZXJfaWQGOgZFRmkGSSIPc2Vzc2lvbl9pZAY7AEZJIiVhMjU2ZjU5N2VmMTE0YTJiOGEwNGJiYzUyYjM2NDg0OQY7AFRJIhBfY3NyZl90b2tlbgY7AEZJIjFjaGU4VkxmRHhEQW9lbm1hK1RYd3NBKzBJUTcrL2piQ0lLK1EyeHdyOHVjPQY7AEY%3D--a6e5daff1334c083e54b2bcafba43b32e546af9c", 
"UNIQUE_ID"=>"UTXjXn8AAQEAACceEdgAAAAA", 
"GATEWAY_INTERFACE"=>"CGI/1.1", 
"PATH_TRANSLATED"=>"/bin/runAV", 
"CONTENT_LENGTH"=>"748", 
"PATH"=>"/usr/local/bin:/usr/bin:/bin", 
"SERVER_SIGNATURE"=>"<address>Apache/2.2.22 (Ubuntu) Server at myapp.loc Port 80</address>\n", 
"SCRIPT_FILENAME"=>"/path_to_project_folder_here/public/users", 
"REDIRECT_STATUS"=>"302", 
"PASSENGER_CONNECT_PASSWORD"=>"GgEqWssAcbBETWnFI7xzBfWRGibgB34OhfFSUVyOhPn", "_"=>"_"} 
```

所以问题显然在于将标头打包到哈希中的方式 - `PATH_INFO`（以及其他标头）有两个值，后一个（不正确）重写第一个（实际上问题在于为什么这些正在发送标头，但我不知道如何处理）。打包成哈希是在`split_by_null_into_hash(headers_data)`方法中发生的。现在要去那里。

文件：`/path_to_gemset_here/gems/passenger-3.0.17/lib/phusion_passenger/utils.rb`

模块`Utils`包含以下代码：

```
if defined?(PhusionPassenger::NativeSupport)
# Split the given string into an hash. Keys and values are obtained by splitting the
  # string using the null character as the delimitor.
  def split_by_null_into_hash(data)
    return PhusionPassenger::NativeSupport.split_by_null_into_hash(data)
  end
else
  NULL = "\0".freeze

  def split_by_null_into_hash(data)
    args = data.split(NULL, -1)
    args.pop
    return Hash[*args]
  end
end 
```

在我的情况下`if`，条件的 -part 正在执行，所以现在问题出在

```
PhusionPassenger::NativeSupport.split_by_null_into_hash(data) 
```

这似乎需要我们提交：`/path_to_gemset_here/gems/passenger-3.0.17/ext/ruby/passenger_native_support.c`

待续...

**更新5**

实际上我决定不处理那个`C`文件调试地狱，因为我相信这个文件是在乘客安装期间编译的，为了调试它，我需要一次又一次地重新安装和重新安装乘客。所以我决定改用`else`条件的 - 部分，因为它似乎达到了完全相同的目标，但显然比预编译的 - 代码慢一些`C`。但就我而言，这并不重要。`/path_to_project_folder_here/lib`因此，我通过使用以下代码将文件包含到文件夹中来覆盖方法的定义：

```
module PhusionPassenger
  module Utils

    protected

    NULL = "\0".freeze

    def split_by_null_into_hash(data)
      args = data.split(NULL, -1)
      args.pop
      return Hash[*args]
    end

  end
end 
```

我不能改变`Hash[*args]`行为（更准确地说我可以通过覆盖`::[]`方法，但我不想确定）所以我会稍微改变一下代码：

```
module PhusionPassenger
  module Utils

    protected

    NULL = "\0".freeze

    def split_by_null_into_hash(data)
      args = data.split(NULL, -1)
      args.pop
      headers_hash = Hash.new
      args.each_slice(2).to_a.each do |pair|
        headers_hash[pair.first] = pair.last unless headers_hash.keys.include? pair.first
      end
      return headers_hash
    end

  end
end 
```

还有宾果游戏！现在它起作用了。

但是，我不确定这样做是否会破坏任何其他功能，因此我无法建议任何人使用这种方法。在遇到与此修改相关的任何问题之前，我将一直使用它。如果是这种情况，那么我将尝试找到另一种解决问题的方法。

主要问题仍然是为什么要发送这些错误的标头。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T13:12:39.223

使用以下代码`passenger_extension.rb`在文件夹中创建：`lib`

**乘客 3**

```
module PhusionPassenger
  module Utils

    protected

    NULL = "\0".freeze

    def split_by_null_into_hash(data)
      args = data.split(NULL, -1)
      args.pop
      headers_hash = Hash.new
      args.each_slice(2).to_a.each do |pair|
        headers_hash[pair.first] = pair.last unless headers_hash.keys.include? pair.first
      end
      return headers_hash
    end

  end
end 
```

**乘客 5**

```
module PhusionPassenger
  module Utils

    # Utility functions that can potentially be accelerated by native_support functions.
    module NativeSupportUtils
      extend self

      NULL = "\0".freeze

      class ProcessTimes < Struct.new(:utime, :stime)
      end

      def split_by_null_into_hash(data)
        args = data.split(NULL, -1)
        args.pop
        headers_hash = Hash.new
        args.each_slice(2).to_a.each do |pair|
          headers_hash[pair.first] = pair.last unless headers_hash.keys.include? pair.first
        end
        return headers_hash
      end

      def process_times
        times = Process.times
        return ProcessTimes.new((times.utime * 1_000_000).to_i,
          (times.stime * 1_000_000).to_i)
      end
    end

  end # module Utils
end # module PhusionPassenger 
```

然后在 'config/application.rb' 中执行：

```
class Application < Rails::Application
  ...
  config.autoload_paths += %W(#{config.root}/lib)
  require 'passenger_extension'
end 
```

然后重新启动网络服务器。

注意：我不确定这不会破坏任何其他功能，因此使用它需要您自担风险，如果您发现这种方法有任何危害，请告诉我。

# android - 如何将 android Path 对象保存为 SVG 文件？

> ID：15178035
> 
> 赞同：3
> 
> 时间：2013-03-02T18:43:41.513
> 
> 标签：android, svg

我一直在谷歌上搜索很长时间才能找到将 Path 类的实例保存为 SVG 文件的解决方案（在标签中。我所有的搜索都让我看到了类似“svg-android”之类的东西，它的作用正好相反。他们解析 svg 文件。但是我想要实现的是从 Path 对象创建 svg 文件。如果有人能指出我正确的方向，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-13T15:39:16.313

我（还）没有任何代码/库，但你问了方向，所以这就是我想为我自己的项目做的事情，让我知道你的想法。

生成带有路径的 SVG 文档非常简单，例如：

```
<html><body>
<svg width="640" height="480" xmlns="http://www.w3.org/2000/svg">
  <g>
     <path class="SamplePath" d="M100,200 C100,100 250,100 250,200
                                   S400,300 400,200" />
  </g>
</svg>
</body></html> 
```

规格：[http ://www.w3.org/TR/SVG/paths.html](http://www.w3.org/TR/SVG/paths.html)

因此，当您绘制路径时，或者稍后使用[PathMeasure](http://developer.android.com/reference/android/graphics/PathMeasure.html)类时，只需构建元素的`'d'`字符串属性即可。`<path>`

我还没有测试过，但这是一个方向:)

**更新：** 我现在可以确认这种方法对我有用（至少对于基本用法）。

# eclipse - 使用 JNI、Android NDK 和 Vuforia 的 Eclipse #ifdef 错误

> ID：15178036
> 
> 赞同：0
> 
> 时间：2013-03-02T18:44:03.750
> 
> 标签：eclipse, android-ndk, java-native-interface, eclipse-cdt, vuforia

使用 Vuforia 的 ImageTargets 示例应用程序，我尝试通过在 jni/Android.mk 中将 USE_OPENGL_ES_1_1 设置为 true 并取消注释并更改 AndroidManifest.xml () 中的相应行来使用 OpenGL ES 1.1。在转换项目以使其具有 C++ 透视图并关联 ndk-build 和正确的包含目录后，我可以在我的 Android 设备上成功运行该应用程序。

然而，问题是，一旦我打开 jni/ImageTargets.cpp，我会从 Eclipse 中得到几个错误，这些错误都来自 OpenGL ES 2.0 代码将执行的地方，第一个是：

> 说明资源路径位置类型符号“vertexHandle”无法解析 ImageTargets.cpp /ImageTargets/jni 第 402 行语义错误

果然，vertexHandle 定义在 ImageTargets.cpp 顶部的“#ifdef USE_OPENGL_ES_2_0”块内。因为没有定义USE_OPENGL_ES_2_0（根据Android.mk），所以代码应该可以编译成功，果然，ndk-build没有报任何问题。所以似乎只有 Eclipse 报告了问题，当我运行项目时，Eclipse 说，“您的项目包含错误，请在运行您的应用程序之前修复它们。” 因此，我不能再运行我的应用程序了。从某种意义上说，这有点奇怪，直到我打开 ImageTargets.cpp 并且 Eclipse “发现”了错误之前，这种情况才发生。

到目前为止，我发现的最好的解决方法是删除或注释掉那些行（这不应该引起问题，因为不应该定义 USE_OPENGL_ES_2_0）......有没有更好的方法来处理这个问题？我是否错过了 Eclipse 中应该解决此问题的设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T05:21:21.570

我找到了解决方案：转到项目属性-> C/C++ 构建-> 发现选项-> 选中“自动发现路径和符号”

# c# - 在gridview单元格中绘制一条垂直线

> ID：15178038
> 
> 赞同：1
> 
> 时间：2013-03-02T18:44:33.140
> 
> 标签：c#, gridview

我想在不使用“|”的情况下将网格视图中给定单元格的值划分为三个 但是垂直线是gridview中列的长度。

```
for (int i = 0; i < subjectCount; i++)
{
    TableCell totals = new TableHeaderCell();
    totals.ColumnSpan = grid.Columns.Count - 1;
    totals.BackColor = System.Drawing.SystemColors.ControlDark;// System.Drawing.Color.FromArgb(#c0c0c0);
    totals.ForeColor = System.Drawing.Color.White;
    totals.Font.Size = FontUnit.Medium;
    totals.Font.Bold = true;

    //totals.Text = "40|60%|100%"; would love to display and image in between them like 40-vertical image-60-vertical image-100

    totals.Text = "40 | 60 | 100";

    row.Cells.Add(totals);

    t.Rows.AddAt(1, row);
} 
```

# unit-testing - 用基于单元测试的生成代码编写的程序

> ID：15178060
> 
> 赞同：9
> 
> 时间：2013-03-02T18:46:45.057
> 
> 标签：unit-testing, tdd, code-generation

在进行测试驱动开发时，我思考是否可以完全通过基于测试生成的代码来开发假设的程序。即是否有能力拥有一个专门创建代码以通过测试的生成器。编程语言的未来只是编写测试吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T18:57:28.920

我认为这将是一个艰难的过程，因为至少对于此类技术的最初几代来说，开发人员会非常怀疑生成代码的正确性。因此，人工审查也必须参与。

作为我的意思的一个简单说明，假设你为一个函数编写了 10 个测试，样本输入和预期输出涵盖了你能想到的每个场景。一个程序可以简单地生成通过所有这些测试的代码，只需要一个基本的 switch 语句（你的十个输入与它们的预期输出匹配）。这段代码显然是不*正确*的，但需要人类才能看到。

这只是一个简单的例子。不难想象更复杂的程序可能不会生成 switch 语句，但仍会产生实际上不正确的解决方案，并且可能以更微妙的方式出错。因此，我的建议是，任何沿着这些思路的技术都会遭到深层次的怀疑，至少在开始时是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-26T21:09:02.707

如果代码可以完全生成，那么生成器的基础必须是准确描述代码的规范。这个生成器就像一个编译器，将一种语言交叉编译成另一种语言。

测试不是这样的语言。他们只断言代码功能的特定方面是有效的并且没有改变。通过这样做，他们构建了代码，使其不会中断，即使在重构时也是如此。

但是我如何比较这两种发展方式呢？

1）如果生成器工作正常，那么规范总是被转换成正确的代码。我假设这段代码是经过设计测试的，不需要额外的测试。生成器比生成的代码更好的 TDD。

2) 在我看来，无论您是否有导致生成代码的规范或表示为确保代码有效的测试的规范，都相当等价。

3）您可以结合两种开发方式。使用经过测试的生成器从规范生成程序框架，然后使用 TDD 丰富生成的代码。注意：然后您将在一个项目中运行两个不同的开发周期。这意味着，您必须确保在规范更改时始终可以重新生成生成的代码，并且您的附加代码仍然正确地适合生成的代码。

只是一个小例子：想象一个可以从 UML 类图生成代码的工具。这可以通过您可以使用 TDD 开发方法的方式来完成，但类的结构是在 UML 中定义的，您不需要再次测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T19:00:19.253

虽然将来有可能，但可以使用简单的测试来生成代码：

```
assertEquals(someclass.get_value(), true) 
```

但是我猜想从黑盒集成测试中获得正确的输出是一个 NP 完全问题：

```
assertEquals(someclass.do_something(1), file_content(/some/file))

assertEquals(someclass.do_something(2), file_content(/some/file))
assertEquals(someclass.do_something(2), file_content(/some/file2))

assertEquals(someclass.do_something(3), file_content(/some/file2)) 
```

这是否意味着生成的代码将始终写入/some/file？这是否意味着生成的代码应该始终写入/some/file2？两者都可能是真的。如果它只需要做最小的设置来让测试通过怎么办？在不了解上下文并编写非常精确和有界的测试的情况下，任何代码都无法（此时）弄清楚测试作者的意图。

# java - 向图中添加一个顶点

> ID：15178064
> 
> 赞同：-1
> 
> 时间：2013-03-02T18:47:15.613
> 
> 标签：java, graph

我想从文件中读取数据并从中构造一个图表。我做了一切，所有的顶点都是正常创建的，但是当我将它们添加到图中时，它们的相邻列表（这是地图，其键值为相邻顶点的编号，值是它们的距离）变为空。谁能告诉我的代码有什么问题？

```
public class Vertex {
private int number;
private LinkedHashMap<Integer, Integer> adjacent;

public Vertex(int num) {
    this.number = num;
    this.adjacent = new LinkedHashMap<Integer, Integer>();
} 
```

}

```
public class Graph {
private ArrayList<Vertex> vertices;
private int verticesSize = 201;

public Graph() {
    Vertex initialVertex = new Vertex(0);
    this.vertices = new ArrayList<Vertex>();
    for(int i = 0; i < verticesSize; i++) {
        vertices.add(i, initialVertex);
    }

} 
```

}

```
public class Test {

public static void printGraph(Graph graph) {
    for(int i = 0; i < graph.getVerticesSize(); i++)
            System.out.println(graph.getVertices().get(i));
}

public static void main(String[] args) throws IOException {
    FileInputStream fStream = new FileInputStream("C:/Lusine/Programming/Java/dijkstraData.txt");
    // Use DataInputStream to read binary NOT text.
    BufferedReader bReader = new BufferedReader(new InputStreamReader(fStream));

    Graph graph = new Graph();
    String[] maps;

    String line;
    LinkedHashMap<Integer, Integer> currentMap = new LinkedHashMap<Integer, Integer>();

    while( (line = bReader.readLine()) != null) {
         maps = line.split("\t");
         int firstDigit = Integer.parseInt(maps[0]);

          Vertex v = new Vertex(firstDigit);

          for(int i = 1; i < maps.length; i++) {
             String[] vertexDistance = maps[i].split(",");
             int vertex = Integer.parseInt(vertexDistance[0]);
             int distance = Integer.parseInt(vertexDistance[1]);
             currentMap.put(vertex, distance);
          }

            v.setAdjacent(currentMap);
            graph.getVertices().set(firstDigit, v);
            System.out.println("\n" + firstDigit +"-th vertex is\n" + v);
            currentMap.clear();

    }
    printGraph(graph);
} 
```

当我打印 v 时，没关系，但是当我打印图形时，所有相邻列表都是空的。有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:53:38.570

你的循环归结为

```
LinkedHashMap<Integer, Integer> currentMap = new LinkedHashMap<Integer, Integer>();

while ( ... ) {
     Vertex v = new Vertex(...);
     v.setAdjacent(currentMap);
     currentMap.clear();
} 
```

因此，您在每个顶点中存储相同的相邻顶点映射，并在每次迭代结束时清除此映射。很明显，所有顶点在循环结束时共享相同的空地图。

您应该在每次迭代时创建一个新的 LinkedHashMap：

```
while ( ... ) {
    LinkedHashMap<Integer, Integer> currentMap = new LinkedHashMap<Integer, Integer>();
    Vertex v = new Vertex(...);
    v.setAdjacent(currentMap);
} 
```

你不应该清除它，因为清除它，嗯……清除它。

# jquery - jQuery appendTo 只在第一次工作，然后替换

> ID：15178068
> 
> 赞同：0
> 
> 时间：2013-03-02T18:47:31.580
> 
> 标签：jquery, jquery-clone

我正在尝试使用 jQuery 在表单末尾附加一个克隆的 div。以下是它的工作原理：

```
 var student_number = 1;
    var orig_student = $("#student-1").clone();

    $("#add-student-link").click(function() {
         ++student_number;
         orig_student.appendTo('form.reg').attr('id', 'student-' + (student_number)).addClass("additional-student");
    }); 
```

这第一次效果很好，我得到一个看起来像这样的 div：

```
<div id="student-2" class="additional-student"></div> 
```

但在那之后，该 div 被另一个 id 为“student-3”的 div 替换。student-3 应该是一个新的 div，而不是替换 student-2。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:53:57.263

您只是在移动克隆而不是复制（请参阅问题下方留下的评论）。

```
$("#add-student-link").click(function() {
     ++student_number;
     $("#student-1").clone().attr('id', 'student-' + (student_number)).addClass("additional-student").appendTo('form.reg');
}); 
```

如果您要克隆以保持干净的副本（据我所知，可能是元素中的输入字段）然后克隆克隆。

```
var orig_student = $("#student-1").clone().attr('id','');
$("#add-student-link").click(function() {
     ++student_number;
     orig_student.clone().attr('id', 'student-' + (student_number)).addClass("additional-student").appendTo('form.reg');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:01:03.847

当您第一次单击时，它会起作用，因为它使用了克隆的 div。

通过第二次单击，变量`orig_student`仍然引用相同的 div，您将再次附加它并更改类。

要使其工作，您需要创建另一个克隆以附加到函数中。因为这就是点击时要执行的操作。

```
var student_number = 1;
var orig_student = $("#student-1"); // No need to clone it here

$("#add-student-link").click(function() {
     ++student_number;
     // Create a new clone of your original div and append it
     // Like this we clone it only when really needed
     orig_student.clone().appendTo('form.reg').attr('id', 'student-' + (student_number)).addClass("additional-student");
}); 
```

# deployment - 在不删除用户数据的情况下更新 Web 角色应用程序 (Azure)

> ID：15178069
> 
> 赞同：2
> 
> 时间：2013-03-02T18:47:34.130
> 
> 标签：deployment, azure, asp.net-mvc-4

我在 Azure 上有一个带有 2 个应用程序和 1 个虚拟目录的 Web 角色。1 应用程序是一个后端，管理员可以在其中上传文件，这些文件存储在虚拟目录中（两个应用程序都可以访问该目录）。

每次我将新版本部署到 Azure 时，虚拟目录中所有上传的内容都会被删除——这是我不想要的！

**那么如何在不删除所有用户生成的文件的情况下发布新版本呢？**

我已经设法使用 WebDeploy 更新了应用程序。但这仅适用于“主”应用程序，而不是第二个应用程序（配置为虚拟应用程序）。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T18:49:30.080

你不能。Web 角色在部署时重新创建。它也可能发生在硬件故障上，如果实例发生故障，Azure 会重新部署您的系统。重新部署一个干净的虚拟机，然后将您的应用程序部署到它。您永远不应该存储要保留在 Web 角色中的数据。您需要使用 blob 存储等来存储要保留的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T07:37:50.633

虚拟目录存储在每次升级时重新创建的“应用程序”分区上 - 有关更多信息，请参阅[此](http://blogs.msdn.com/b/kwill/archive/2012/10/05/windows-azure-disk-partition-preservation.aspx)内容。因此，虚拟目录文件夹不是存储您希望在升级期间保留的内容的正确位置。顺便说一句，“应用程序”分区只有 1 GB 的空间，其中一些空间用于存储您的应用程序二进制代码，因此您有时可能会发现自己处于“磁盘已满”的情况。

If you want to store some data which you don't mind sacrificing on rare occasions - like cached results - you may use "local resources" disk for that which will survive in-place upgrades and reboots. However it is not guaranteed to be preserved if your VM crashes - for such level of preservation you have to use persistent storage like blob storage for example.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T19:18:13.553

由于您正在谈论虚拟目录并使用 Web 部署来更新通常的 Azure 包部署机制之外的应用程序，听起来您的体系结构/应用程序可能更适合持久 VM 角色而不是 Web 角色。这些目前仅在 Azure 上提供预览版。

[http://www.windowsazure.com/en-us/home/scenarios/virtual-machines/](http://www.windowsazure.com/en-us/home/scenarios/virtual-machines/)

它们让您拥有可在回收利用中存活的持久存储。存储实际上由 blob 存储支持，但它看起来像 PVM 中的普通磁盘。

# c++ - （成员）函数指针的向量的向量

> ID：15178070
> 
> 赞同：0
> 
> 时间：2013-03-02T18:47:51.467
> 
> 标签：c++

我正在为我当前的实验项目构建一个简单的侦听器/回调机制。而且我坚持实现一个容器结构，它似乎应该是指针向量的向量。我选择这种方式是因为我希望根向量简单地具有事件类型的 KEY 假设是一个枚举（int），然后在这个键上我想存储指向该事件类型的可用方法的指针向量。在逻辑表示中，例如：

```
[EVENT_TYPE_QUIT]
                 [ptr1]
                 [ptr2]
                 [ptr3]
                 [ptr4]
                 [....]
[EVENT_TYPE_HELLO]
                 [....]
                 [....]

typedef enum {
   EVENT_TYPE_QUIT,
   EVENT_TYPE_HELLO,
   ...
} EventType; 
```

所以简化的实现看起来像这样（它实际上是一个模板，但想象一下 T 是您可以映射事件的任何用户类型）。

```
class EventMapper {
    ...

    typedef void (T::*functionPtr)(); // simple pointer to T member function with no args.

    std::vector< std::vector<functionPtr> > eventCallbacks;

    void mapEvent(const EventType type, functionPtr callback) {

        // here i need to map type to callback
        // each type can have multiple callbacks
        // T can have only distinct event types as "key"

        // this i tried but doesn't work

        eventCallbacks[type].push_back(callback);

    }

    ...
} 
```

预期的实现类似于：

```
EventMapper<SupaDupaClass> mapper;
mapper.mapEvent(EVENT_TYPE_HELLO, &SupaDupaClass::didYouSayHello); 
```

ETC ...

我真的想使用矢量而不是地图来更轻松地分配唯一键吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:37:20.900

You can use a `std::map` to map the event_type to the vector of callbacks. And consider using `std::function` instead of function pointers for flexibility.

One possible implementation is:

```
#include <vector>
#include <map>
#include <functional>
#include <iostream>

enum class event_type
{
    event_one,
    event_two
};

void func1() { std::cout << "func1" << std::endl; }
class my_listener { public: void func() { std::cout << "my_listener::func" << std::endl; } };

int main()
{
    std::map<event_type, std::vector<std::function<void ()>>> m;

    my_listener lst;
    m[event_type::event_one].push_back(std::bind(&my_listener::func, lst));
    m[event_type::event_one].push_back(&func1);

    // invoke callbacks (may be used in the code that raises events)
    for(auto& kv : m)
    {
        for(auto& f : kv.second) {
            f();
        }
    }

    return 0;
} 
```

**EDIT:** You might consider using [Boost.Signals2](http://www.boost.org/doc/libs/1_53_0/doc/html/signals2.html) library.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:23:35.443

如果我正确阅读了您的代码，则您正在访问一个未初始化的条目。

您应该首先使用空向量初始化 eventCallbacks，例如

eventCallbacks.assign(10,std::vector())

# database - 如何使用表控件更新数据库中的记录？

> ID：15178071
> 
> 赞同：0
> 
> 时间：2013-03-02T18:48:08.650
> 
> 标签：database, controls, abap

我创建了输入数据时使用的表格控件。数据将从表控件流向内部表，然后流向数据库。为了将数据读入内部表，将使用子程序。目前我正忙于构建表格控制逻辑。TC中最初显示8行，第1行填满后，用户回车，TC里面的数据就没有了。我尝试调试默认 SAP 程序来检查它们的逻辑，但命名约定让我很困惑。另一个问题是空白行。假设用户在第 4 行输入值（保持第 3 行为空白），该行应在用户单击输入后自动向上移动。

上述问题的任何解决方案？或者我可以参考的任何有用的链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T13:12:10.983

假设表控件的内部表被声明为全局变量，请确保在 PBO 时将此内部表中存储的数据填充到表控件中。

请提供一些编码以了解您到底在做什么。

# wpf - 移动 WPF 形状

> ID：15178076
> 
> 赞同：0
> 
> 时间：2013-03-02T18:49:00.473
> 
> 标签：wpf, move, shape

我无法弄清楚如何在运行时移动 WPF 形状。具体来说，我想移动一个椭圆。

这是我当前的代码：

```
private void Tick(object sender, EventArgs e)
    {
        Point ballLocation = ball.TransformToAncestor(Application.Current.MainWindow).Transform(new Point(0, 0));
        //MessageBox.Show(ballLocation.ToString());
        Canvas.SetLeft(ball, ballLocation.X + 5);

        InvalidateVisual();
    } 
```

每次计时器滴答（1 秒），球应该在 x 方向移动 5 个像素，对吗？如果这是错误的，如何获取 Ellipse 的当前位置以及如何将其设置为新位置。也许 InvalidateVisual 有问题？我相信这基本上会重新绘制控件。如果这是错误的，我如何重新绘制椭圆以显示其位置的变化。我也试过ball.InvalidateVisual()，它没有用。

这就是我创建和启动计时器的方式：

```
var timer = new DispatcherTimer {IsEnabled = true};
        timer.Tick += Tick;
        timer.Interval = new TimeSpan(0, 0, 1);
        timer.Start(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:01:30.343

如果`Canvas.Left`使用某个值初始化，则在 XAML 中

```
<Ellipse Name="ball" Canvas.Left="0" ... /> 
```

或在代码中

```
Canvas.SetLeft(ball, 0); 
```

以下作品：

```
void Tick(object sender, EventArgs e)
{
    Canvas.SetLeft(ball, Canvas.GetLeft(ball) + 5);
} 
```

初始化是必要的，因为默认值为`Double.NaN`.

* * *

但是，您可以考虑为`Canvas.Left`属性设置动画以获得平滑的移动。从这里开始阅读：[动画概述](http://msdn.microsoft.com/en-us/library/ms752312.aspx)

# r - ggplot中对数刻度的漂亮轴标签

> ID：15178081
> 
> 赞同：15
> 
> 时间：2013-03-02T18:49:26.850
> 
> 标签：r, ggplot2

当我尝试以下任一方法时，轴比例为 1e+03、1e+06、1e+09 - 是否可以在不借助手动标签的情况下获得漂亮的上标 10^3、10^6、10^9？我似乎记得过去自动得到这个。

```
qplot(1:10, 10^(1:10))+scale_y_log10()
qplot(1:10, 10^(1:10), log='y') 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-03-02T18:55:44.263

您可以使用`trans_breaks()`and `trans_format()`from library`scales`来获得所需的轴值格式。

```
library(scales)
qplot(1:10, 10^(1:10)) +
     scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
              labels = trans_format("log10", math_format(10^.x))) 
```

![在此处输入图像描述](../Images/df14744f71b268570fc9ca1bbd669865.png)

# map - 创建全局地图变量

> ID：15178088
> 
> 赞同：32
> 
> 时间：2013-03-02T18:50:05.713
> 
> 标签：map, global-variables, go

我需要一些关于在 Go 中创建全局地图变量的帮助。我所做的如下：

```
package ...
import(
...
)
...
type ir_table struct{
    symbol      string
    value       string
}
var ir_MAP map[int]ir_table 
```

由于我没有初始化地图，因此我收到了一个 nil 指针取消引用错误。我必须怎么做才能全局使用这个变量？或者，如果这不是正确的方法，请指导我。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-03-02T19:12:20.063

您需要使用空地图对其进行初始化：

```
var ir_MAP = map[int]ir_table{} 
```

或者，正如“系统”所建议的那样：

```
var ir_MAP = make(map[int]ir_table) 
```

问题是地图的零值是 nil，您不能将项目添加到 nil 地图。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2020-09-16T11:33:52.387

您可以像这样直接初始化地图：

```
var Romans = map[byte]int{
    'I': 1,
    'V': 5,
    'X': 10,
    'L': 50,
    'C': 100,
    'D': 500,
    'M': 1000,
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-03-02T19:38:26.427

你几乎是对的。你只是还没有初始化你的地图。

[这是The Playground](http://play.golang.org/p/4tL1Yff2LK)中的工作代码。

```
package main

import "fmt"

type ir_table struct{
    symbol      string
    value       string
}
// define global map; initialize as empty with the trailing {}
var ir_MAP = map[int]ir_table{}

func main() {
    ir_MAP[1] = ir_table{symbol:"x", value:"y"}
    TestGlobal()
}

func TestGlobal() {
    fmt.Printf("1 -> %v\n", ir_MAP[1])
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-12-20T14:29:37.610

老话题，但没有提到最优雅的解决方案。这在无法在主函数中赋值的模块中非常有用。init 只执行一次，因此每次必须初始化映射时它都会节省一些 CPU 周期。

[https://play.golang.org/p/XgC-SrV3Wig](https://play.golang.org/p/XgC-SrV3Wig)

```
package main

import (
    "fmt"
)

var (
    globalMap = make(map[string]string)
)

func init() {
    globalMap["foo"] = "bar"
    globalMap["good"] = "stuff"
}

func main() {
    fmt.Printf("globalMap:%#+v", globalMap)
} 
```

# mysql - MySQL中栈的实现

> ID：15178090
> 
> 赞同：1
> 
> 时间：2013-03-02T18:50:20.767
> 
> 标签：mysql, sql, database, data-structures

我有一个在 MySQL 中实现堆栈的抽象想法。尝试了很多谷歌工作，但无法得出任何合乎逻辑的结论。

Stack 必须是一个表的集合，其栈顶指向一个特定的表。我们的数据库中可能有各种这样的堆栈。例如，如果表中的字段已满，则堆栈长度可能会增加。同样，堆栈长度可能会以相反的方式减少！

能否请您给我一个实施思路！首先真的有可能吗？希望我的问题很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:59:36.963

我的想法。

具有自动递增 id 和 blob 列的单个表，用于存储序列化对象。

推入堆栈将插入新的最高 id。

从堆栈中弹出将获得具有最高 id 的行并删除。

这当然是一种简单的方法。您必须尊重堆栈推送的来源，因此您只能获取允许的堆栈对象。但这取决于用例。

# cocos2d-iphone - Cocos2d - 视网膜图像不显示

> ID：15178100
> 
> 赞同：4
> 
> 时间：2013-03-02T18:51:05.403
> 
> 标签：cocos2d-iphone, retina-display, ccsprite

只是试图测试视网膜显示。我这样设置导演：

```
CCDirectorIOS* director = (CCDirectorIOS*)[CCDirector sharedDirector];
    director.wantsFullScreenLayout = NO;
    director.projection = kCCDirectorProjection2D;
    director.animationInterval = 1.0 / 60.0;
    director.displayStats = YES;
    [director enableRetinaDisplay:YES]; 
```

我在 Photoshop 中创建了两个版本的文件 - outline-hd.png 和 outline.png。我将高清版本涂成红色，这样我就可以判断它是否正在显示。

显示代码：

```
CCSprite *border = [CCSprite spriteWithFile:@"outline.png"];
[self addChild:border]; 
```

然而，在我的 iPhone5 上显示的是非高清图像。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T01:43:27.703

我在自己的项目中尝试解决完全相同的问题时遇到了这个问题。不得不在 cocos2d 源中四处挖掘才能弄清楚。问题是，除非设置了导演的**观点**`enableRetinaDisplay:YES`，否则导演的方法不起作用。所以，它需要在 glView 设置好之后调用，并且你已经调用了 director：**`setView`**

 **```
CCGLView *glView = [CCGLView viewWithFrame:aFrame
                                   pixelFormat:kEAGLColorFormatRGBA8
                                   depthFormat:0
                            preserveBackbuffer:NO
                                    sharegroup:nil
                                 multiSampling:NO
                               numberOfSamples:0];

[[CCDirector sharedDirector] setView:glView];
NSLog(@"glView is set, enable retina...");
[[CCDirector sharedDirector] enableRetinaDisplay:YES]; 
```

这应该可以为您解决问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:42:33.470

可能你忘记了：

```
CCFileUtils *sharedFileUtils = [CCFileUtils sharedFileUtils];
[sharedFileUtils setEnableFallbackSuffixes:NO];         
[sharedFileUtils setiPhoneRetinaDisplaySuffix:@"-hd"]; 
```**

# python - 在 python 中读取 protobuf。提取数据

> ID：15178105
> 
> 赞同：1
> 
> 时间：2013-03-02T18:51:24.847
> 
> 标签：python, protocol-buffers

我正在尝试使用来自 spinn3r 的数据。数据作为 protobuf 返回。在 python 中，当我打印 protobuf 对象时，我得到了这个：

```
print data
source {
  link {
    href: ""
    resource: ""
  }
  canonical_link {
    href: "http://twitter.com/_PattiShaw/statuses/28167079857225728"
    resource: ""
  }
  title: ""
  hashcode: ""
  lang {
    code: "en"
    probability: -1.0
  }
  generator: ""
  description: ""
  last_posted: ""
  last_published: ""
  date_found: ""
  publisher_type: "MICROBLOG"
}
feed {
  link {
    href: ""
    resource: ""
  }
  canonical_link {
    href: ""
    resource: ""
  }
  title: ""
  hashcode: ""
  lang {
    code: "en"
    probability: -1.0
  }
  generator: ""
  description: ""
  last_posted: ""
  last_published: ""
  date_found: ""
  etag: ""
  channel_link {
    href: ""
    resource: ""
  }
}
feed_entry {
  link {
    href: "http://twitter.com/_PattiShaw/statuses/28167079857225728"
    resource: "http://twitter.com/_PattiShaw/statuses/28167079857225728"
  }
  canonical_link {
    href: "http://twitter.com/_PattiShaw/statuses/28167079857225728"
    resource: "http://twitter.com/_PattiShaw/statuses/28167079857225728"
  }
  title: "The value of a man resides in what he gives and not in what he is capable of receiving. ~ Albert Einstein"
  hashcode: "8WhKLK9Lyng"
  lang {
    code: "en"
    probability: -1.0
  }
  author {
    name: "_PattiShaw (Patti Shaw)"
    email: ""
    link {
      href: "http://twitter.com/_PattiShaw"
    }
  }
  spam_probability: 0.0
  last_published: "2011-01-20T19:08:49Z"
  date_found: "2011-01-20T19:08:49Z"
  identifier: 1295550574016007548
  content {
    mime_type: "text/html"
    data: "x\332M\214\301\r\2000\014\304V\271\t`\201\n\211\007\033\260@B\003\215TR\324\226\362cv\020/\276\266\3459\010\032\305S\220V\020v2d)\352\245@\rW\240\212\267\330\264\275\300\361@\346]\317\003,\325\277\327\202\205\016\342\370m\262,\242Mm\353pc\214,\271bR+U\324\036\200\236&\363"
    encoding: "zlib"
  }
}
permalink_entry {
  link {
    href: "http://twitter.com/_PattiShaw/statuses/28167079857225728"
    resource: "http://twitter.com/_PattiShaw/statuses/28167079857225728"
  }
  canonical_link {
    href: "http://twitter.com/_PattiShaw/statuses/28167079857225728"
    resource: "http://twitter.com/_PattiShaw/statuses/28167079857225728"
  }
  title: "The value of a man resides in what he gives and not in what he is capable of receiving. ~ Albert Einstein"
  hashcode: "8WhKLK9Lyng"
  lang {
    code: "en"
    probability: -1.0
  }
  author {
    name: "_PattiShaw (Patti Shaw)"
    email: ""
    link {
      href: "http://twitter.com/_PattiShaw"
    }
  }
  spam_probability: 0.0
  last_published: "2011-01-20T19:08:49Z"
  date_found: "2011-01-20T19:09:34Z"
  identifier: 1295550574016007548
  content {
    mime_type: "text/html"
    data: ""
  }
  content_extract {
    mime_type: "text/html"
    data: ""
  }
  generator: ""
} 
```

我想从“feed_entry”对象中提取“作者姓名”。我试过这个：

```
print data.feed_entry.author.name 
```

我得到错误：

```
AttributeError: 'RepeatedCompositeFieldContainer' object has no attribute 'name' 
```

我尝试只打印作者对象以查看会发生什么。这就是我得到的：

```
print u.feed_entry.author
[<spinn3rApi_pb2.Author object at 0x362e6d0>] 
```

如何提取此作者姓名？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T19:02:03.307

它看起来像`u.feed_entry.author`一个列表。注意方括号：

```
[<spinn3rApi_pb2.Author object at 0x362e6d0>] 
```

这应该可以解决您的问题（假设您至少有一位作者）：

```
print data.feed_entry.author[0].name 
```

# c++ - C++：std::map 抛出 out_of_range 异常

> ID：15178106
> 
> 赞同：0
> 
> 时间：2013-03-02T18:51:27.647
> 
> 标签：c++, oop, exception, map, std

我有一个如下所示的代码

```
template <typename KeyType, typename ValueType>
KeyType IDSystem<KeyType,ValueType>::registerParameter(const ValueType& value)
{
    KeyType key = __IDCounter++;
    _Map[key] = value; //crashes here
    return key;
} 
```

_Map 在哪里

```
std::map<KeyType, ValueType> _Map; 
```

该程序曾经在指示的地方崩溃，然后我将该行替换为

```
_Map.at(key) = value; //out_of_range thrown here 
```

现在程序在同一行抛出一个 std::out_of_range 异常......

KeyType 是标准库中的 int64_t，而 ValueType 是指向某个类（如 MyClass*）的指针。

令人惊讶的部分是我之前使用了 std::map ......并且没有出现任何问题。

我是否错误地使用了 std::map ？请指教。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T18:58:31.437

您可能想要使用[`find`](http://en.cppreference.com/w/cpp/container/map/find)而不是`[]`运算符，因为如果您尝试访问不存在的键，它会返回一个过去的迭代器。

关于您的代码，请花时间发布[SSCCE](http://sscce.org/)，因为我在上面的几行代码中看不到任何错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T20:21:48.973

问题不在地图上。指向此类的指针未正确初始化，这导致了问题。

感谢您的所有努力，并对误导性问题感到抱歉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T19:26:17.740

编写的代码（除了可能不会伤害任何东西的下划线名称）很好，所以问题很可能在其他地方。特别是，如果空闲存储已损坏（通过删除未更新的指针，或通过运行已分配块的末尾），则症状几乎会出现在使用空闲存储的任何地方。`map::operator[]`当你给它一个不在地图中的键时使用免费存储，所以我怀疑这就是问题所在：其他东西已经炸毁了堆。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-02T19:32:17.587

例外是阅读鲱鱼，`out_of_range`与您原来的崩溃问题不同。

问题是当你这样做时：

```
_Map[key] = value; 
```

所以你正在做一个任务。
这表明您有一个错误的赋值运算符（或者您在赋值运算符中所做的某事遇到了其他一些错误的代码）。

由于我们不知道是什么`ValueType`，因此我们无法诊断超出这一点的问题。我可以建议您检查您是否正在实施`rule of 3(5) correctly`.

如果您提供定义`ValueType`及其赋值运算符，我们可能会提供进一步的帮助。通常对于此类问题，最好将问题简化为生成问题并发布的最小可编译示例。

# php - 显示返回对象的值

> ID：15178111
> 
> 赞同：0
> 
> 时间：2013-03-02T18:52:12.940
> 
> 标签：php, arrays, object

我有一个变量对象，它存储下面的值。

```
Array
(
    [0] => stdClass Object
        (
            [term_id] => 1
            [name] => Uncategorized
            [slug] => uncategorized
            [term_group] => 0
            [term_taxonomy_id] => 1
            [taxonomy] => category
            [description] => 
            [parent] => 0
            [count] => 4
            [object_id] => 39
            [cat_ID] => 1
            [category_count] => 4
            [category_description] => 
            [cat_name] => Uncategorized
            [category_nicename] => uncategorized
            [category_parent] => 0
        )

) 
```

我现在想显示`slug`值列表中的 。我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T18:53:42.403

假设该对象存储在一个名为 的数组中`$array`：

```
echo $array[0]->slug 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:56:27.243

您可以使用 print_r($yourObject) 打印出整个对象以进行调试，或者如果您只想打印该值，这将起作用： echo($yourObject[0]->slug); .

如果有多个数组索引，那么：

```
foreach($yourObject as $object)
{
    echo $object->slug;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T18:58:43.247

Jonh给了你一个确切的答案……让我解释一下

```
$obj = your_array;//from where you are using var_dump() to see these values.. 
```

进而

```
echo $obj->slug 
```

您可以对转储中的其他术语使用相同的技术，例如

`echo $obj->name`

高温高压

# ios - iOS 读取文本文件中的某一行

> ID：15178112
> 
> 赞同：0
> 
> 时间：2013-03-02T18:52:17.077
> 
> 标签：ios, file, text-files

我有一个大型文本文件，其中存储了我的程序的数据。它基本上是一个 CSV 文件，由浮点数组成，每行一个。例子：

```
6.3580820e+03
6.3589883e+03
6.3592695e+03
6.3592695e+03
6.3635508e+03
6.3695820e+03 
```

我知道如何逐行读取文件，但是我仍然会得到一个包含内存中所有数据的数组。我更喜欢访问一个不同的行，例如 readFromLine:32 有没有办法在不加载或读取整个文件的情况下做到这一点？如果不是，我应该如何转换我的数据？SQLite？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:10:03.690

> 我更喜欢访问一个不同的行，例如 readFromLine:32 有没有办法在不加载或读取整个文件的情况下做到这一点？

您可以使用`NSInputStream`来读取文件，输入流将根据需要管理将文件的部分读取到内存中。

> 如果不是，我应该如何转换我的数据？SQLite？

至少对于您的应用程序而言，CSV 文件的问题在于，知道在哪里可以找到给定行的唯一方法是从开头读取文件并计算行数。如果您有一个索引告诉您每行或每第 10 行或第 100 行或其他任何内容的文件开头的偏移量，那么您可以在索引并从索引条目指示的偏移量开始读取您的数据文件。使用像 SQLite 这样的数据库格式将是另一个好策略。您还可以将大文件分解成更小的部分，这样仅加载文件的相关部分就不会占用太多资源。

# php - 使用 file_get_contents 发布登录 - 不是 curl

> ID：15178120
> 
> 赞同：0
> 
> 时间：2013-03-02T18:53:21.897
> 
> 标签：php, file-get-contents

一个站点需要登录三个变量：用户名、密码和令牌。此数据通过 POST 发送。

令牌也通过一个部分发送。

我拥有所有三个变量，我想通过 file_get_contents 登录。

如何发送该数据并且身份验证成功？

```
 function file_post_contents()
{

    $url = 'http://site.com/auth.php?' . session_name() . '=' . session_id();

    $login = 'jhon';
    $senha = 'doe';

    $token = '123456';  
    $_SESSION["token"] = $token;

    $postdata = http_build_query(
        array(
            'login' => $login,
            'senha' => $senha,
            'token' => $token, 
                            $_SESSION["token"] => $token
        )
    );

    $opts = array('http' =>
        array(
            'method'  => 'POST',
            'header'  => 'Content-type: application/x-www-form-urlencoded',
            'content' => $postdata
        )
    );

    if($login && $senha)
    {
        $opts['http']['header'] = ("Authorization: Basic " . base64_encode("$login:$senha"));
    }

    $context = stream_context_create($opts);
    return file_get_contents($url, false, $context);
} 
```

* * *

修改后的代码。这没用。

```
 function file_post_contents()
{

    $url = 'http://site.com/auth.php?' . session_name() . '=' . session_id();

    $login = 'jhon';
    $senha = 'doe';

    $token = '123456';  
    $_SESSION["token"] = $token;

    $postdata = http_build_query(
        array(
            'login' => $login,
            'senha' => $senha,
            'token' => $token
            //, $_SESSION["token"] => $token
        )
    );

    $opts = array('http' =>
        array(
            'method'  => 'POST',
            'header'  => 'Content-type: application/x-www-form-urlencoded'
             . "\r\n" . "Authorization: Basic " . base64_encode("$login:$senha"). "\r\n",
            'content' => $postdata
        )
    );

    $context = stream_context_create($opts);
    return file_get_contents($url, false, $context);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:32:13.987

您正在`$opts['http']['header']`使用基本身份验证进行覆盖。您没有将其添加到 Content-type 中，而是将 Content-type 替换为它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:27:08.160

您的标题可能设置错误，请尝试`\r\n`像这样添加

```
$opts = array('http' =>
        array(
            'method'  => 'POST',
            'header'  => "Content-type: application/x-www-form-urlencoded\r\n",
            'content' => $postdata
        )
    ); 
```

然后是代码

`$opts['http']['header'] = $opts['http']['header'] . "Authorization: Basic " . base64_encode("$login:$senha") . "\r\n";`

# opengl - 如何在OpenGL的对象空间坐标中获得近剪裁平面坐标

> ID：15178122
> 
> 赞同：0
> 
> 时间：2013-03-02T18:53:22.903
> 
> 标签：opengl, transformation, clipping, plane

我正在渲染一个有 8 个顶点的立方体。当我旋转或靠近立方体时，一些顶点可能会被近剪裁平面剪裁。但是，出于某种原因，在我的问题中，我需要找到立方体边缘与近剪裁平面的交点。我知道点数可能会有所不同。所以我想的是获得近剪裁平面（可能在眼睛空间 - 但如何？）并对矩阵进行一些逆计算以获得我的立方体对象空间中的坐标，然后我可以找到交叉点并解决我的问题。但这里的问题是：

1.  如何获得近剪裁平面每个角的坐标？（或平面方程系数）
2.  如何返回对象空间？

测试：

作为一个测试，看看我是否能正确获得坐标，我尝试了这个：我试图做的是获得 MVM（模型视图矩阵）和 PM（投影矩阵）的倒数。并试图想象具有 V1 = (-1,-1,-1,1), V2 = (1, -1, -1, 1), V3 = (1, 1, -1, 1) 的近剪裁平面, 和 V4 = (-1, 1, -1, 1) 坐标。所以我在想如果我对四个顶点中的每一个都这样做：

V1 = IMVM * ( IPM * V1 );

V2 = IMVM * ( IPM * V2 );

V3 = IMVM * ( IPM * V3 );

V4 = IMVM * ( IPM * V4 );

其中 IMVM 是模型视图矩阵的逆矩阵，IPM 是投影矩阵的逆矩阵。然后，当我使用当前加载的矩阵（我只是使用了逆矩阵）渲染这四个点时，我应该在屏幕前看到一个站立的窗台正方形，因为我的逆乘法应该被与 openGL 当前加载的矩阵的乘法相抵消. 但由于某种原因它不起作用，我尝试转置和正常。我注意成为专栏专业等。但它似乎不起作用，而不是得到一个静止的suqare（代表我的近剪裁平面）我得到一个不断移动和跳跃的飞机！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:33:38.117

好吧，看来我在这个论坛上的所有问题都将由我自己来回答！首先经过思考，我意识到我们不需要投影矩阵的逆。我们指定相机空间中的点并将它们带回对象空间，我们只需要模型视图矩阵的逆矩阵。

与会杀死您的错误一样，我的向量矩阵乘法计算中存在逻辑错误。当我用在线矩阵计算器仔细检查时，我意识到我的第一个元素是正确的，但其余元素是不正确的。那时我突然想到，我将结果存储在与我相乘的同一矩阵中，因此我只是改变了原始矩阵。所以我只是为结果添加了一个新矩阵，一切正常。基本上我指定了一个点，然后将它乘以模型视图矩阵的倒数，得到对象空间坐标中的点。

# multithreading - 线程释放链表（队列）中的内存期间的段错误

> ID：15178123
> 
> 赞同：0
> 
> 时间：2013-03-02T18:53:34.263
> 
> 标签：multithreading, segmentation-fault, free

我创建了一个线程。主要功能是创建一个元素并将其附加到队列的尾/尾。线程正在从 Head/Start 读取列表并在之后释放内存。

我有以下代码：

```
#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>
#include <unistd.h>

void *print_message_function( void *ptr );

typedef struct stCheckFree
{
    char name[30];
    int doneflag;
    struct stCheckFree *next;
}CheckFree;

CheckFree *gHead=NULL;
CheckFree *gTail=NULL;

int main()
{
    pthread_t thread1;
    char *message1 = "Thread 1";
    int iret1;
    unsigned long TestCount=1;

    CheckFree *pCurr=NULL;
    CheckFree *pTemp=NULL;

    iret1 = pthread_create( &thread1, NULL, print_message_function, (void*) message1);

    while(1)
    {
        pCurr=malloc(sizeof(CheckFree));
        memset(pCurr,0,sizeof(CheckFree));

        printf("Malloc\n");
        sprintf(pCurr->name,"Test-%ld",TestCount); TestCount++;
        pCurr->doneflag=0;
        pCurr->next=NULL;

        pTemp=gTail;
        gTail=pCurr;
        if(pTemp) pTemp->next=gTail;

        if(!gHead)
        {
            gHead=gTail;
        }

    }

    return 0;
}

void *print_message_function( void *ptr )
{
    CheckFree *pTrav;

    while(1)
    {
        pTrav=gHead;
        if(pTrav)
        {
            printf("[%s]\n",pTrav->name);
            pTrav->doneflag=1;

            gHead=gHead->next;
            free(pTrav);
        }
    }
} 
```

当我运行代码时，它给了我一个段错误。可能是什么问题？请帮忙！

谢谢。

PS-如果我删除 free()，它运行得非常好！！！

**-------------------------------------------------- ---------------------------------**
**--- 编辑 1---**
**--------- -------------------------------------------------- ----------------------**

我不确定这是否是解决方法，但我需要其他**stackoverflow**成员的更多输入。

```
void *print_message_function( void *ptr )
{
    CheckFree *pTrav;

    while(1)
    {
        pTrav=gHead;
        if(pTrav)
        {
            printf("[%s]\n",pTrav->name);
            pTrav->doneflag=1;

            gHead=gHead->next;

            if(!gHead) gTail=NULL;                /* NEW CODE */

            free(pTrav);
            sleep(0.7);
        }
    }
} 
```

请帮忙，因为这很重要！：） 再次感谢。

**-------------------------------------------------- ---------------------------------**
**--- 编辑 2---**
**--------- -------------------------------------------------- ----------------------**

代码更改：- if(!gHead) gTail=NULL; /* 新代码 */ 正在通过重新初始化 NULL 来破坏数据。

您只需执行以下代码更改即可看到它：

> ...
> pTemp=gTail;
> gTail=pCurr；
> if(pTemp) pTemp->next=gTail;
> if(!gTail)printf("数据丢失\n");
> 如果（！gHead）
> {
> ...

请帮我纠正这个问题...

**-------------------------------------------------- ---------------------------------**
**--- 编辑 3---**
**--------- -------------------------------------------------- ------------------------**
按照@wazy 的使用互斥锁的建议，我更新了代码如下：-

```
#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>
#include <unistd.h>

void * thread_function( void *ptr );

typedef struct stCheckFree
{
    char name[30];
    int doneflag;
    struct stCheckFree *next;
}CheckFree;

pthread_mutex_t lock;    // EDIT 3

CheckFree *gHead=NULL;
CheckFree *gTail=NULL;

int main()
{
    pthread_t thread1;
    char *message1 = "Thread 1";
    int  iret1;
    unsigned long TestCount=1;

    CheckFree *pCurr=NULL;
    CheckFree *pTemp=NULL;

    if (pthread_mutex_init(&lock, NULL) != 0)    // EDIT 3
    {
        printf("\n mutex init failed\n");
        return 1;
    }

    iret1 = pthread_create( &thread1, NULL,  thread_function, (void*) message1);

    while(1)
    {
        pCurr=malloc(sizeof(CheckFree));
        memset(pCurr,0,sizeof(CheckFree));

        sprintf(pCurr->name,"Test-%ld",TestCount); TestCount++;
        pCurr->doneflag=0;
        pCurr->next=NULL;

        pTemp=gTail;
        gTail=pCurr;
        if(pTemp) pTemp->next=gTail;

        //pthread_mutex_lock(&lock);    // EDIT 3(commented out)
        if(!gHead)
        {
            pthread_mutex_lock(&lock);    // EDIT 4
            gHead=gTail;
            pthread_mutex_unlock(&lock);    // EDIT 4
        }
        //pthread_mutex_unlock(&lock);    // EDIT 3(commented out)
    }

    pthread_join( thread1, NULL);
    printf("Thread 1 returns: %d\n",iret1);

    return 0;
}

void * thread_function( void *ptr )
{
    CheckFree *pTrav;

    while(1)
    {
        pTrav=gHead;
        if(pTrav)
        {
            //printf("[%s]\n",pTrav->name);
            pTrav->doneflag=1;

            gHead=gHead->next;
            if(!gHead) sleep(1);//gTail=NULL;
            free(pTrav);
        }
    }
} 
```

我在正确的轨道上吗？？？？？？谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:08:08.197

运行你的代码给了我来自 glibc 的双重免费或损坏（fasttop）。查看您的代码，我发现您在 thread1 和主线程中都使用了 gHead。这似乎是一个多线程同步问题。

# ms-access-2007 - MS Access 2007 报告 - 表格布局中的跨行和列

> ID：15178124
> 
> 赞同：0
> 
> 时间：2013-03-02T18:53:33.687
> 
> 标签：ms-access-2007, html-table

如何在表格布局中跨越行和列，如下所示：

```
---------------------
     |     Name     |
 ID  | --------------
     | First | Last |
--------------------- 
```

对不起这个新手问题

之前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T02:40:23.687

好的。这很简单。首先以表格格式创建您的报告，然后修改报告以将字段放在您想要的位置。您可以根据需要重新排列字段。所以你开始：

```
--------------------------
 ID | Name| First | Last |
-------------------------- 
```

然后只需将 First & Last 移到 Name 下，这样你就可以得到：

```
---------------------
     |     Name     |
 ID  | --------------
     | First | Last |
--------------------- 
```

如果您问是否有自动方式，那么没有。

# c++ - 无法以任何方式读取仿函数类

> ID：15178125
> 
> 赞同：2
> 
> 时间：2013-03-02T18:53:37.337
> 
> 标签：c++, dynamic-data, functor

好的，我正在实现一个动态二维矩阵类。作为一个基础，这是我到目前为止所拥有的：

```
template <typename Type>
class dyMatrix {
    private:
        Type *mat;

        int lines, columns;
        int length;

        void assimilate (const dyMatrix<Type>& that) {
            lines = that.lines;
            columns = that.columns;

            length = that.length;
        }

    public:
        dyMatrix (int height, int width)
            : lines(height), columns(width), mat(0)
        {
            length = lines * columns;
            mat = new Type[length];
        };

        // ---

        int getLines() {
            return lines;
        };

        int getColumns() {
            return columns;
        };

        int getLength() {
            return length;
        }

        // ---

        Type& operator() (int i, int j) {
            return mat[j * columns + i];
        };

        Type& operator() (int i) {
            return mat[i];
        };

        // ---

        dyMatrix (const dyMatrix<Type>& that) {
            this->assimilate(that);

            // ---

            mat = new Type[length];

            for (int i = 0; i < length; i++) {
                mat[i] = that.mat[i];
            }
        };

        dyMatrix& operator= (const dyMatrix<Type>& that) {
            Type *local_mat = new Type[that.length];

            for (int i = 0; i < that.length; i++) {
                local_mat[i] = that.mat[i];
            }

            // ---

            this->assimilate(that);

            delete[] mat;
            mat = local_mat;

            // ----

            return *this;
        };

        ~dyMatrix() {
            delete mat;
        };
}; 
```

我的问题是我在尝试读取输入时遇到了一些特定问题。例如，我有以下 main()：

```
int main() {
    int lanes, cols;
    cin >> lanes >> cols;

    dyMatrix<int> map(lanes, cols);

    /* CONTINUE READING */

    cout << endl;
    for (int i = 0; i < lanes; i++) {
        for (int j = 0; j < cols; j++) {
            cout << map(i, j) << ' ';
        }
        cout << endl;
    }
} 
```

如果我输入以下代码行，它是一个注释部分：

```
int aux;
for (int i = 0; i < lanes; i++) {
    for (int j = 0; j < cols; j++) {
        cin >> map(i, j);
    }
} 
```

或者：

```
int aux;
for (int i = 0; i < lanes; i++) {
    for (int j = 0; j < cols; j++) {
        cin >> aux;
        map(i, j) = aux;
    }
} 
```

甚至：

```
int aux;
for (int i = 0; i < lanes; i++) {
    for (int j = 0; j < cols; j++) {
        cin >> aux;
        map(i, j) = i + j; // !!!
    }
} 
```

......它不会工作。但是，出于某种原因，以下内容将：

```
int aux;
for (int i = 0; i < lanes; i++) {
    for (int j = 0; j < cols; j++) {
        // cin >> aux;
        map(i, j) = i + j; // Still the same thing as before, logically
    }
} 
```

我不明白。这里发生了什么？

* * *

编辑：对不起，忘了包括我的调试程序。

输入：

```
3 5
1 2 3 4 5
1 2 3 4 5 
```

第一行具有矩阵的维度。第二行和第三行是写入其中的值；但是，在第三行末尾按 Enter 后，程序崩溃了。

它甚至不适用于此输入：

```
3 5
1
2
3
4
5
1
2
3
4
5 
```

它在第二个 5 之后再次崩溃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:01:54.423

您的索引出现错误的方式：

```
 Type& operator() (int i, int j) {
        return mat[j * columns + i];
    }; 
```

这里，`i`显然是列，`j`是行。但是，在您的循环中，参数以相反的顺序出现：

```
for (int i = 0; i < lanes; i++) {
    for (int j = 0; j < cols; j++) {
        map(i, j) = ...; // row then column
    }
} 
```

此外，析构函数应该使用`delete[]`而不是`delete`.

# c++ - C ++：动态创建以for循环迭代器命名的数组

> ID：15178132
> 
> 赞同：0
> 
> 时间：2013-03-02T18:54:32.713
> 
> 标签：c++, arrays, variables, naming

嘿，所以我想创建`n`大小`x`（也关闭用户输入）的数组（基于用户输入）。我正在考虑这样做的方式是让 for 循环执行`n`迭代，并在循环内向用户询问`x`. 问题是我不确定如何使用变量命名数组`n`，我在想类似的东西：

```
cout << "Enter n: ";
cin >> n

for (i = 0; i < n; i++)
{
    cout << "Enter x: ";
    cin >> x;

    double*array+i;
    array+i = new double[x]
} 
```

总结一下我的问题是：您可以使用 C++ 中的变量创建/命名数组吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:05:09.480

不幸的是，你不能在 C++ 中做到这一点。尝试这样的事情......

```
std::cout << "Enter n: ";
std::cin >> n

std::vector<std::vector<double> > arrays(n);

for (std::size_t i = 0; i < n; i++)
{
    std::cout << "Enter x: ";
    std::cin >> x;

    arrays[i].reserve(x);
} 
```

`reserve`仅分配，但不构造`std::vector`;中的对象 如果您也想构建它们，请使用`resize`.

PS永远不要使用`using namespace std`；它使您的代码更难阅读和调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:18:18.327

由于您使用 C++ 进行编程，因此您应该使用 STL 容器（尤其是`std::vector`）而不是 C 样式的数组。

如果您需要使用在运行时创建的字符串来访问数组，那么您可以使用`std::map< std::string, std::vector<double> >`，虽然这是一个非常疯狂的想法：

```
typedef std::vector<double> MyVector;
std::map<std::string, MyVector> myVectors;

// create an array:
std::string arrayName;
arrayName = std::string("someArray");       // could be: std::cin >> arrayName;
myVectors[arrayName] = MyVector(10, 1.23);  // new vector of size 10

std::cout << myVectors["someArray"][4];     // prints 1.23 
```

我不确定您要达到的目标到底是什么，但很可能有更合适的解决方案。真的有必要通过它们的名字访问这些数组吗？我很确定这里的 common`std::vector< std::vector<double> >`就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T19:15:36.603

这里有 3 个解决方案：第一个最接近您的示例代码，第二个是为了能够正确检索范围内的数组元素而进行的改进，第三个是使用`vector`s 更好地为您服务的原因。

**解决方案1：**

看起来您希望您的数组具有可通过循环迭代器区分的名称。就像 Joe 说的那样，你可以有一个数组的数组，所以内部数组将被命名为 array[0]、array[1]、...、array[n - 1]。这将通过使用指向双精度指针的指针来实现。每个内部指针都将用于动态分配双精度数组。不要忘记删除动态分配的内存。

```
#include <iostream>
int main()
{
    unsigned int n;
    std::cout << "Enter number of arrays: ";
    std::cin >> n;
    double** array = new double*[n];

    for (int i = 0; i < n; ++i)
    {
        unsigned int size;
        std::cout << "Enter size of array " << i << ": ";
        std::cin >> size;
        array[i] = new double[size];
        for (int j = 0; j < size; ++j)
        {
            int element;
            std::cout << "Enter element " << j << " of array " << i << ": ";
            std::cin >> element;
            array[i][j] = element;
        }
    }

    for (int i = 0; i < n; ++i)
    {
        delete [] array[i];
    }
    delete[] array;
    return 0;
} 
```

**解决方案2：**

但是，使用上面的代码，您将无法访问每个内部数组的元素。除非您记住使用此创建的每个内部数组的大小，否则您可能会访问超出范围的内容。因此，对这段代码的更新将是添加另一个数组，我们称之为它`sizeOfInnerArrays`，其中每个元素`i`都跟踪内部数组的大小`array[i]`。这是更新：

```
 #include <iostream>
    int main()
    {
        unsigned int n;
        std::cout << "Enter number of arrays: ";
        std::cin >> n;
        double** array = new double*[n];
        unsigned int* sizeOfInnerArrays = new unsigned int[n];

        for (int i = 0; i < n; ++i)
        {
            std::cout << "Enter size of array " << i << ": ";
            std::cin >> sizeOfInnerArrays[i];
            array[i] = new double[sizeOfInnerArrays[i]];
            for (int j = 0; j < sizeOfInnerArrays[i]; ++j)
            {
                int element;
                std::cout << "Enter element " << j << " of array " << i << ": ";
                std::cin >> element;
                array[i][j] = element;
            }
        }

        //prints out each array as curly-brace enclosed sets of doubles
        for (int i = 0; i < n; ++i)
        {
            std::cout << "{";
            for (int j = 0; j < sizeOfInnerArrays[i] - 1; ++j)
            {
                std::cout << array[i][j] << ", ";
            }
            std::cout << array[i][sizeOfInnerArrays[i] - 1] << "}" << std::endl;
        }

        // free dynamically allocated memory
        for (int i = 0; i < n; ++i)
        {
            delete [] array[i];
        }
        delete[] array;
        delete[] sizeOfInnerArrays;

        return 0;
    } 
```

**解决方案3：**

然而，这太复杂了，所以你最好使用一个容器，就像`vector`Joe 建议的那样，它的数据成员会跟踪它的大小。

```
#include <iostream>
#include <vector>

int main()
{
    unsigned int n;
    std::cout << "Enter number of vectors: ";
    std::cin >> n;
    std::vector<std::vector<double> > myVec;
    // ^ space between closing angle brackets not needed
    //   if using C++11 conforming compiler

    for (int i = 0; i < n; ++i)
    {
        unsigned int size;
        std::cout << "Enter size of vector " << i << ": ";
        std::cin >> size;
        std::vector<double> temp;
        temp.reserve(size);
        for (int j = 0; j < size; ++j)
        {   
            double value;
            std::cout << "Enter next value of vector " << i << ": ";
            std::cin >> value;
            temp.push_back(value);
        }
        myVec.push_back(temp);
    }

    for (int i = 0; i < myVec.size(); ++i)
    {
        std::cout << "{";
        for (int j = 0; j < myVec.at(i).size() - 1; ++j)
        {
            std::cout << myVec.at(i).at(j) << ", ";
        }
        std::cout << myVec.at(i).back() << "}" << std::endl;
    }

    return 0;
} 
```

# xcode - 在 Xcode 中使用 OpenGL 的深度

> ID：15178136
> 
> 赞同：2
> 
> 时间：2013-03-02T18:55:01.877
> 
> 标签：xcode, opengl, depth

我的问题是我在 Xcode 中有一个项目，我必须使用[OpenGL](http://en.wikipedia.org/wiki/OpenGL)创建两个原子，其中一个在窗口的中心，另一个围绕第一个旋转。我的问题是似乎没有深度。旋转的原子从不落后于另一个。

我有这个代码：

```
#include <GLUT/glut.h>
#include <OpenGL/gl.h>
#include <OpenGL/glu.h>

const int W_WIDTH = 500;
const int W_HEIGHT = 500;
GLfloat Rot = 0;

void Display(void) {
    glEnable(GL_DEPTH_TEST);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glMatrixMode(GL_MODELVIEW); // Se activa la matriz del modelador
    glLoadIdentity(); //Se pone a "0" realmente al 1

    // Boramos la pantalla
    glOrtho(-500.0f, 500.0f, -500.0f, 500.0f, -500.0f, 500.0f);

    //glPushMatrix();
    glTranslatef(0.0f, 0.0f, -100.0f); // Se traslada todo al -100

    // Red Nucleus
    glColor3f(255, 0, 0);
    glutSolidSphere(12.0f, 20, 20); // Se dibuja una esfera

    glPushMatrix();
    // First Electron Orbit
    // Se hace un push copiamos la traslacion de -100 a la Pila
    // Save viewing transformation
    // Rotate by angle of revolution
    //Sumamos a la translacion -100 una rotacion = -100 + rotacion

    glRotatef(Rot, 0.0f, 1.0f, 0.0f);
    // Translate out from origin to orbit distance
    glTranslatef(90.0f, 0.0f, 0.0f); //Sumamos a la -100 + rotacion una nueva traslacion  = -100 + rotacion + 90
    glColor3f(0, 00, 100);
    glutSolidSphere(8.0f, 20, 20); // Draw the electron
    // Se recupera la matriz de la pila quie era -100
    /* Se dibujan los siguiente electrone.*/

    glPopMatrix();

    /*
        glPushMatrix();
        glColor3f(0, 00, 100);
        glRotatef(fAngulo, 0.0f, 1.0f, 0.0f);
        glTranslatef(-90.0f, 0.0f, 0.0f);
        glutSolidSphere(6.0f, 20, 20);
        fAngulo = fAngulo + 0.03;
        glPopMatrix();
    */

    glutSwapBuffers();// Se limpian los buffers
    glFlush();
}

void idle(void) {
    Rot += 0.01;
    if(Rot > 360.0f)
        Rot = 0.0f;
    glutPostRedisplay();
}

int main(int argc, char **argv) {

    glutInit(&argc, argv);
    //Inicializa la ventana en una determinada posicion
    glutInitDisplayMode (GLUT_RGBA | GLUT_DOUBLE); // Nombre de la ventana
    glutInitWindowPosition(0, 0);
    //Inicializa el tamano de la funcion
    glutInitWindowSize (W_WIDTH, W_HEIGHT); //Inicaliza el modeo de display, RGBA y Doble buffer

    glutCreateWindow("Ventana");

    glutDisplayFunc(Display);
    glutIdleFunc(idle);

    glutMainLoop();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:32:26.647

```
glutInitDisplayMode (GLUT_RGBA | GLUT_DOUBLE); 
```

您打算如何在没有深度缓冲区的情况下进行深度测试？拍在那辆火车[`GLUT_DEPTH`](http://www.opengl.org/documentation/specs/glut/spec3/node12.html)的后座上。`OR`

# gcc - “gcc -xW”有什么作用？

> ID：15178137
> 
> 赞同：0
> 
> 时间：2013-03-02T18:55:16.797
> 
> 标签：gcc, clang, icc

“-xW”标志的作用是什么？我看到这有时会在链接阶段提供给 gcc/icc。铿锵声打破了这一点，说：

```
clang: error: language not recognized: 'W' 
```

用法示例：[http ://www.spec.org/cpu2000/results/res2004q1/cpu2000-20040208-02830.cfg](http://www.spec.org/cpu2000/results/res2004q1/cpu2000-20040208-02830.cfg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:01:11.217

这只是一个 ICC 选项：

```
 -xW  --  Can  generate SSE2 and SSE instructions, and it can
     optimize for Intel(R) Pentium(R) 4 processors  and  Intel(R)
     Xeon(R)  processors  with SSE2\. This is the default on Linux
     systems using Intel(R) 64 architecture.  This option is  the
     same as specifying -march=pentium4. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:01:44.040

这是英特尔 C 编译器的一个选项，而不是 gcc - 请参见此处：

[http://www.rcac.purdue.edu/userinfo/resources/common/compile/compilers/intel/man/icc.txt](http://www.rcac.purdue.edu/userinfo/resources/common/compile/compilers/intel/man/icc.txt)

> -xW -- 可以生成 SSE2 和 SSE 指令，并且可以针对带有 SSE2 的 Intel(R) Pentium(R) 4 处理器和 Intel(R) Xeon(R) 处理器进行优化。这是使用 Intel(R) 64 架构的 Linux 系统的默认设置。此选项与指定 -march=pentium4 相同。

# java - libgdx 粒子编辑器多种用法

> ID：15178141
> 
> 赞同：2
> 
> 时间：2013-03-02T18:55:52.527
> 
> 标签：java, libgdx, effects

我是 LibGDX 的新手……我正在尝试将粒子效果附加到子弹对象上。我有播放器，它会发射多发子弹，我想在发射的子弹之后添加一些烟雾和火焰。

问题是我每次都没有得到相同的效果。最初第一个子弹效果看起来像我想要的，每个其他子弹后面都有一个较短的轨迹。就像没有要绘制的粒子一样。

如果可能的话，我想使用一个粒子发射器对象。不希望每个子弹对象都有多个实例。

在绘制每个项目符号后，我尝试使用 reset() 方法，但它看起来又不一样了。只有第一个很好，其他的看起来有点糟糕。

有没有办法做到这一点？

帮助！

这是代码片段：

在里面：

```
 bulletTexture = new Texture("data/bullet.png");
    bulletTexture.setFilter(TextureFilter.Linear, TextureFilter.Linear);

    // Load particles
    bulletFire = new ParticleEmitter();

    try {
        bulletFire.load(Gdx.files.internal("data/bullet_fire_5").reader(2048));
    } catch (IOException e) {
        e.printStackTrace();
    }

    // Load particle texture
    bulletFireTexture = new Texture("data/fire.png");
    bulletFireTexture.setFilter(TextureFilter.Linear, TextureFilter.Linear);

    // Attach particle sprite to particle emitter
    Sprite particleSprite = new Sprite(bulletFireTexture);
    bulletFire.setSprite(particleSprite);
    bulletFire.start(); 
```

在渲染方法中：

```
 // Draw bullets

    bulletIterator = bullets.iterator();

    while (bulletIterator.hasNext()) {

        bullet = bulletIterator.next();

        bulletFire.setPosition(bullet.getPosition().x + bullet.getWidth() / 2,
                bullet.getPosition().y + bullet.getHeight() / 2);
        setParticleRotation(bullet);

        batch.draw(bulletTexture, bullet.getPosition().x,
                bullet.getPosition().y, bullet.getWidth() / 2,
                bullet.getHeight() / 2, bullet.getWidth(),
                bullet.getHeight(), 1, 1, bullet.getRotation(), 0, 0,
                bulletTexture.getWidth(), bulletTexture.getHeight(), false,
                false);

        bulletFire.draw(batch, Gdx.graphics.getDeltaTime());

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-24T17:43:01.987

正如评论所述，问题在于您对多个项目符号使用单一效果。我怀疑它设置为非连续的，因此持续时间有限。随着时间的流逝，效果逐渐消失。

我建议为效果创建一个粒子效果池，并`obtain()`从/`free()`到池。为每个子弹附加一个效果。这允许您运行多个效果，同时限制垃圾收集（由于池化）以及避免`.p`为每个新效果加载文件。该池是使用每次`obtain()`调用时复制的模板创建的。请注意在调用 时对 PooledEffect 的强制转换`free()`。

```
import com.badlogic.gdx.graphics.g2d.ParticleEffect;
import com.badlogic.gdx.graphics.g2d.ParticleEffectPool;
import com.badlogic.gdx.graphics.g2d.ParticleEffectPool.PooledEffect;

...

ParticleEffect template = new ParticleEffect();
template.load(Gdx.files.internal("data/particle/bigexplosion.p"),
            ..texture..);
ParticleEffectPool bigExplosionPool = new ParticleEffectPool(template, 0, 20);

...

ParticleEffect particle = bigExplosionPool.obtain();

... // Use the effect, and once it is done running, clean it up

bigExplosionPool.free((PooledEffect) particle); 
```

相反，您可以跳过水池并使烟雾粒子效果循环（连续）。这可能不会让你得到你正在寻找的东西，并且可能被认为是一个杂物，但可能会在紧要关头起作用。

# php - 仅使用 .htaccess 禁用所有子子目录的 php

> ID：15178142
> 
> 赞同：0
> 
> 时间：2013-03-02T18:55:55.663
> 
> 标签：php, apache, .htaccess

我需要在子文件夹中禁用 php 脚本，而不是在根 index.php 中。

例如我的文件：

```
index.php
test.php
1/index.php
2/index.php
class/*.php
2/test.php
.../... .php 
```

我想禁用除根目录和类目录中的 index.php 之外的所有 php 文件。

我尝试索引根：

```
php_flag engine off

<Files index.php>
    php_flag engine on
</Files> 
```

但这会启用所有带有`index.php`.

现在我如何禁用所有子文件夹期望类和所有文件期望 index.php 在根目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:00:29.540

我不明白。如果只是为了禁用文件的 PHP 处理，为什么需要在目录中包含 PHP 文件。将文件重命名为 .txt 或其他名称并锁定目录权限，这样任何人都无法访问它。

# c - 在 C 中不浪费时间的进度条

> ID：15178145
> 
> 赞同：0
> 
> 时间：2013-03-02T18:56:23.697
> 
> 标签：c

我了解如何在 C 中制作进度条（只需打印完成了多少，然后在打印之前刷新屏幕）。但是为此，我浪费了时间（使用进度条解决问题比没有进度条需要更多时间）。进度条是指已经完成的百分比。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T18:01:12.180

如果它显着增加了您的运行时间，那么您可能过于频繁地写入标准输出。例如尝试类似的东西

```
for(i = 0; i < 1000000; i++)
    printf("\r%d",i); 
```

对比

```
for(i = 0; i < 1000000; i++); 
```

为了提高性能，您可以在经过这么多操作或经过一段时间后写入控制台。

# python - python中的线平滑算法？

> ID：15178146
> 
> 赞同：3
> 
> 时间：2013-03-02T18:56:23.963
> 
> 标签：python, algorithm, numpy, line, smoothing

我正在研究线路泛化，将应用于从大比例尺地图到小比例尺地图的广义路网地图。我正在使用两种操作和两种算法。它是在 python 编程语言中使用 shapefile 库完成的，它用于 2d 中的矢量数据。操作：选择和消除。对于选择，我使用的条件是，选择所有宽度超过 7 米的道路，它与道路的属性特征相连。与淘汰相同，像所有宽度小于 5 米的道路一样，被淘汰。到目前为止，这没有太大问题。

应用选择和消除操作后，我们将有形状文件，通过条件的道路。我正在使用两种算法，线条简化和线条平滑。为了简化线，我使用 Douglas-Peucker 的线简化算法。它正在获取矢量数据（坐标）并基于公差删除一些点。我使用 Python 编程语言来做这件事。获得简化的线条后，它需要进行一些编辑，例如线条平滑。在这里，我使用的是高斯算法，但是它返回了一些我不明白的错误，因为我是编程环境的新手

```
import numpy

 ### This is the Gaussian data smoothing function I wrote ###  

def smoothListGaussian(list1,degree):  

     window=degree*2-1  

     weight=numpy.array([1.0]*window)
     print weight

     weightGauss=[]  

     for i in range(window):  

         i=i-degree+1  

         frac=i/float(window)  

         gauss=1/(numpy.exp((4*(frac))**2))  

         weightGauss.append(gauss)  

     print weightGauss
     weight=numpy.array(weightGauss)*weight
     print weight
     print len(list1)-window

     smoothed=[0.0]*(len(list1)-window)
     print smoothed

     for i in range(len(smoothed)):  

         smoothed[i]=sum(numpy.array(list1[i:i+window])*weight)/sum(weight)  

     return smoothed

a=[[78.03881018900006, 30.315651467000066], [78.044901609000078, 30.31512798600005], [78.04927981700007, 30.312510579000048], [78.050041244000056, 30.301755415000059], [78.072646124000073, 30.281720353000082], [78.07902308000007, 30.273344651000059]]

smoothListGaussian(a,3) 
```

任何，想法，请。或者，如果python中有任何其他算法可以使用线条中每个点的坐标来平滑矢量数据中的线条

任何答案表示赞赏！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-02T22:20:10.563

您可以通过以下代码平滑路径：

```
from scipy.ndimage import gaussian_filter1d
import numpy as np
a=np.array([[78.03881018900006, 30.315651467000066],
 [78.044901609000078, 30.31512798600005], 
 [78.04927981700007, 30.312510579000048],
 [78.050041244000056, 30.301755415000059],
 [78.072646124000073, 30.281720353000082],
 [78.07902308000007, 30.273344651000059]])

x, y = a.T
t = np.linspace(0, 1, len(x))
t2 = np.linspace(0, 1, 100)

x2 = np.interp(t2, t, x)
y2 = np.interp(t2, t, y)
sigma = 10
x3 = gaussian_filter1d(x2, sigma)
y3 = gaussian_filter1d(y2, sigma)

x4 = np.interp(t, t2, x3)
y4 = np.interp(t, t2, y3)

plot(x, y, "o-", lw=2)
plot(x3, y3, "r", lw=2)
plot(x4, y4, "o", lw=2) 
```

结果如下：蓝点是原始数据，红色曲线是包含许多点的平滑曲线，如果要与原始数据相同的点数，可以从红色曲线中采样得到绿色点。

您可以设置`sigma`更改平滑度`gaussian_filter1d()`。

![在此处输入图像描述](../Images/be5997b707c85e42896eb0ba836f65ce.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:52:33.170

我猜你使用了[这里](http://www.swharden.com/blog/2008-11-17-linear-data-smoothing-in-python/)的代码。您应该注意到代码是针对单维数据点的，而不是针对多维数据点的。

我不太了解高斯平滑算法，但是在**简单**地浏览了您的代码之后，我相信以下是您正在尝试做的事情（我不确定它是否会给您想要的结果）。将代码的最后一部分替换为以下代码：

```
smoothed=[0.0,0.0]*(len(list1)-window)
print smoothed

for i in range(len(smoothed)):
    smoothing=[0.0,0.0]
    for e,w in zip(list1[i:i+window],weight):
        smoothing=smoothing+numpy.multiply(e,w)
    smoothed[i]=smoothing/sum(weight) 
```

# mysql - 使用 SQL 触发器设置日期时间列

> ID：15178147
> 
> 赞同：0
> 
> 时间：2013-03-02T18:56:24.047
> 
> 标签：mysql, triggers

我使用 MySQL 服务器（5.5.27 - 社区服务器）。我有一个具有此定义的表：

```
CREATE  TABLE IF NOT EXISTS tbl_messages (
  `msg_id` VARCHAR(50) NOT NULL ,
  `msg_text` VARCHAR(50) NULL ,
  PRIMARY KEY (`msg_id`); 
```

我编写了一个触发器，当我执行插入操作时，服务器将 msg_id 列设置为当前时间，包括微秒，格式为“yyyymmddhhnnssuuuuuu”。“u”代表微秒。

我创建了一个触发器：

```
create trigger tbl_messages_trigger
before insert on tbl_messages 
for each row

BEGIN
    SET NEW.msg_id = DATE_FORMAT(NOW(),'%Y%m%d%H%i%s%f'); 
END;$$ 
```

但是 msg_id 列只能得到这样的值：20130302144818* *000000* *，微秒为零。¿ 是否可以捕获微秒？

TIA,

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T03:58:11.607

从提供的代码中，我猜您正在尝试使用微秒来最小化为不同行获得相同 msg_id 的概率。

此外，`msg_id`是主键，它不应该呈现任何特定于对象的数据，而只是唯一的。有一个很好的链接：[http ://en.wikipedia.org/wiki/Surrogate_key](http://en.wikipedia.org/wiki/Surrogate_key)

在 MySql 中处理主键的最好方法是 AUTO_INCREMENT 列属性。如果您需要插入消息的时间，您可以为其提供列：

```
CREATE TABLE tbl_messages 
(
   `msg_id` bigint(20) NOT NULL AUTO_INCREMENT,
   `msg_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
   `msg_text` VARCHAR(50) NULL,
    PRIMARY KEY (`msg_id`)
); 
```

# mysql - MYSQL IFNull 正确使用

> ID：15178149
> 
> 赞同：0
> 
> 时间：2013-03-02T18:56:31.237
> 
> 标签：mysql, ifnull

这只是一个简单的问题，但是在为表进行更新过程时，例如说 Personinfo 是否可以接受

```
Update Person
 Set 
   FirstName = IFNULL(_FirstName, FirstName),
   LastName = IFNULL(_LastName, LastName)
  Where PID = _PID 
```

这对于对记录进行部分更新是可取的，还是无论如何都应该将所有信息发回？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:01:31.447

如果 exp1 不为空，IFNULL 将返回 exp2。

如果未设置您传递给存储过程的参数，我假设您想要返回一个固定的“名字”和“姓氏”字符串。我假设你也在谈论更新/选择和数据碎片化的速度。

您需要问自己，是否出于应用程序原因您想要 NULL 或固定字符串，而不是担心性能（除非您已经遇到与此相关的性能问题）。

确实，这会影响性能，但只有在您的行大小超过限制时才会开始导致问题 - 表的内部表示具有 65,535 字节的最大行大小。如果你不打算超过这个值，那么使用固定字符串和 NULL 之间的性能差异就不值得考虑了。

您还可以选择 CHAR 类型，因为它的长度始终相同，并且不会导致任何碎片。但是你应该存储一个空值而不是 NULL。

# ruby-on-rails - 出错 - 在雪豹上安装 RVM

> ID：15178155
> 
> 赞同：6
> 
> 时间：2013-03-02T18:57:27.313
> 
> 标签：ruby-on-rails, ruby, openssl, rvm, osx-snow-leopard

我正在尝试在我的 Snow Leopard 10.6.8 上安装 RVM，使用以下命令：

`\curl -L https://get.rvm.io | bash -s stable --ruby`

我得到这个错误：

```
Installing Ruby from source to: /Users/Villa/.rvm/rubies/ruby-2.0.0-p0, this may take a    while depending on your cpu(s)...
ruby-2.0.0-p0 - #downloading ruby-2.0.0-p0, this may take a while depending on your connection...
ruby-2.0.0-p0 - #extracted to /Users/Villa/.rvm/src/ruby-2.0.0-p0 (already extracted)
ruby-2.0.0-p0 - #configuring
ruby-2.0.0-p0 - #compiling
Error running 'make -j2', please read /Users/Villa/.rvm/log/ruby-2.0.0-p0/make.log
There has been an error while running make. Halting the installation. 
```

make.log 错误从这里开始：

```
In file included from openssl_missing.c:22:
openssl_missing.h:71: error: conflicting types for ‚ÄòHMAC_CTX_copy‚Äô
/Users/Villa/.rvm/usr/include/openssl/hmac.h:102: error: previous declaration of      ‚ÄòHMAC_CTX_copy‚Äô was here
openssl_missing.h:95: error: conflicting types for ‚ÄòEVP_CIPHER_CTX_copy‚Äô
/Users/Villa/.rvm/usr/include/openssl/evp.h:503: error: previous declaration of ‚ÄòEVP_CIPHER_CTX_copy‚Äô was here
openssl_missing.c:27: error: conflicting types for ‚ÄòHMAC_CTX_copy‚Äô
/Users/Villa/.rvm/usr/include/openssl/hmac.h:102: error: previous declaration of  ‚ÄòHMAC_CTX_copy‚Äô was here
openssl_missing.c:122: error: conflicting types for ‚ÄòEVP_CIPHER_CTX_copy‚Äô
/Users/Villa/.rvm/usr/include/openssl/evp.h:503: error: previous declaration of ‚ÄòEVP_CIPHER_CTX_copy‚Äô was here
make[2]: *** [openssl_missing.o] Error 1
make[1]: *** [ext/openssl/all] Error 2
make[1]: *** Waiting for unfinished jobs....
compiling psych_emitter.c
compiling psych_parser.c
compiling psych_to_ruby.c
compiling psych_yaml_tree.c
linking shared-object psych.bundle
installing default psych libraries
make: *** [build-ext] Error 2 
```

请告诉我您需要我提供的一切以获得解决方案

更新#1

我尝试安装它：

> rvm 重新安装 1.9.3 --with-openssl-dir=/usr/bin

我明白了

```
Error running '__rvm_rm_rf /Users/Villa/.rvm/src/ruby-1.9.3-p392',
please read /Users/Villa/.rvm/log/ruby-1.9.3-p392/remove.src.log
/Users/Villa/.rvm/rubies/ruby-1.9.3-p392 has already been removed.
Installing requirements for osx/10.6/i386, might require sudo password
Skipping `brew update` make sure your formulas are up to date.
-bash: /usr/local/etc/openssl/cert.pem: Permission denied
-bash: /usr/local/etc/openssl/cert.pem: Permission denied
Doing /usr/local/etc/openssl
cert.pem => 77ee3751.0
Installing Ruby from source to: /Users/Villa/.rvm/rubies/ruby-1.9.3-p392, this may take  a while depending on your cpu(s)...
ruby-1.9.3-p392 - #downloading ruby-1.9.3-p392, this may take a while depending on your   connection...
ruby-1.9.3-p392 - #extracted to /Users/Villa/.rvm/src/ruby-1.9.3-p392 (already  extracted)
ruby-1.9.3-p392 - #configuring...
Error running './configure --prefix=/Users/Villa/.rvm/rubies/ruby-1.9.3-p392 --with- openssl-dir=/usr/bin --with-opt-  dir=/usr/local/opt/libyaml:/usr/local/opt/readline:/usr/local/opt/libxml2:/usr/local/opt/lib    xslt:/usr/local/opt/libksba:/usr/local/opt/openssl:/usr/local/opt/sqlite --disable-  install-doc --without-tcl --without-tk --enable-shared',
please read /Users/Villa/.rvm/log/ruby-1.9.3-p392/configure.log
There has been an error while running configure. Halting the installation. 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T19:18:49.927

尝试使用`--with-openssl-dir=/path/to/openssl`您安装的 openssl 版本的位置进行安装。

更多你可以看看这个[https://rvm.io/packages/openssl/](https://rvm.io/packages/openssl/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T02:15:19.190

我让我使用在 MacRuby 网站上找到的以下代码：

```
$ sudo xcode-select -switch /Applications/Xcode.app/Contents/Developer/ 
```

如果您使用的 Xcode 版本高于 4.3，这将配置安装路径。

# postgresql - 在 Ubuntu 服务器上导入 PostgreSQL 数据库

> ID：15178160
> 
> 赞同：0
> 
> 时间：2013-03-02T18:57:56.370
> 
> 标签：postgresql, postgresql-9.1, triggers

所以我对 PostgreSQL 真的很陌生，在过去的 3 天里，我一直坚持这一点。我需要导入一个 PostgreSQL 数据库。该数据库位于一个文件夹中，并具有各种 .tab 文件。我有 PostgreSQL 9.1 版本。该数据库由我授予所有可能权限的用户 postgres 导入。我还授予了该语言所有可能的特权。

脚本运行的命令是：

```
 CREATE OR REPLACE FUNCTION unique_toplevel_corpus_name() RETURNS TRIGGER AS $$
DECLARE
        count INTEGER := 0;
BEGIN
        IF NEW.top_level = 'y' THEN
                PERFORM * FROM corpus WHERE corpus.name = NEW.name AND corpus.t$
                GET DIAGNOSTICS count = ROW_COUNT;
                IF count != 0 THEN
                        RAISE EXCEPTION 'conflicting top-level corpus found: %'$
                END IF;
        END IF;
        RETURN NEW;
END;
$$ language plpgsql; 
```

代码不是我的。它在我的本地机器（Ubuntu 12.04）上提供并运行良好，导入数据库没有任何问题，但仅在 Ubuntu 服务器（也是 12.04）上存在问题。

这是我不断得到的例外：

```
@valian:/opt/annis/annis-service-2.2.1/bin$ ./annis-admin.sh import /home/FilesForAnnis/Korpora/relANNIS/relANNIS/
19:38:45.755 CorpusAdministration INFO: Importing corpus from: /home/FilesForAnnis/Korpora/relANNIS/relANNIS/
19:38:45.758 SpringAnnisAdministrationDao INFO: creating staging area
19:38:45.788 SpringAnnisAdministrationDao INFO: bulk-loading data
19:38:46.236 SpringAnnisAdministrationDao INFO: computing top-level corpus
Exception in thread "main" org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [-- find the top-level corpus
ALTER TABLE _corpus ADD top_level boolean;
CREATE TRIGGER unique_toplevel_corpus_name BEFORE UPDATE ON _corpus FOR EACH ROW EXECUTE PROCEDURE unique_toplevel_corpus_name();
UPDATE _corpus SET top_level = 'n';
UPDATE _corpus SET top_level = 'y' WHERE pre = (SELECT min(pre) FROM _corpus);

-- add the toplevel corpus to the node table
CREATE INDEX tmp_corpus_toplevel ON _corpus (id) WHERE top_level = 'y';
ALTER TABLE _node ADD toplevel_corpus bigint;
UPDATE _node SET toplevel_corpus = _corpus.id FROM _corpus WHERE _corpus.top_level = 'y';
DROP INDEX tmp_corpus_toplevel;
]; nested exception is org.postgresql.util.PSQLException: ERROR: function unique_toplevel_corpus_name() does not exist
    at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:98)
    at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:72)
    at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:80)
    at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:80)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:406)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:427)
    at annis.administration.SpringAnnisAdministrationDao.executeSqlFromScript(SpringAnnisAdministrationDao.java:617)
    at annis.administration.SpringAnnisAdministrationDao.executeSqlFromScript(SpringAnnisAdministrationDao.java:608)
    at annis.administration.SpringAnnisAdministrationDao.computeTopLevelCorpus(SpringAnnisAdministrationDao.java:226)
    at annis.administration.CorpusAdministration.importCorpora(CorpusAdministration.java:85)
    at annis.administration.CorpusAdministration$$FastClassByCGLIB$$ce864c53.invoke(<generated>)
    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:191)
    at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:688)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:621)
    at annis.administration.CorpusAdministration$$EnhancerByCGLIB$$b6899e79.importCorpora(<generated>)
    at annis.administration.AnnisAdminRunner.doImport(AnnisAdminRunner.java:176)
    at annis.administration.AnnisAdminRunner.run(AnnisAdminRunner.java:74)
    at annis.administration.AnnisAdminRunner.main(AnnisAdminRunner.java:49)
Caused by: org.postgresql.util.PSQLException: ERROR: function unique_toplevel_corpus_name() does not exist
    at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2062)
    at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1795)
    at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
    at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:479)
    at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:353)
    at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:345)
    at org.springframework.jdbc.core.JdbcTemplate$1ExecuteStatementCallback.doInStatement(JdbcTemplate.java:420)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:395)
... 16 more 
```

我还更新了 jdbc posgtres 连接器。我的本地机器和服务器之间的唯一区别是我在本地机器上有 java 1.7 而不是 1.6，但我认为这不是问题。

我不知道我还能在那里尝试什么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T00:53:11.297

这不是 Ubuntu 的问题。这是您的数据库导入的问题。您的数据库导入错误表明您缺少触发器功能。

另外我知道代码不是你的。在某种程度上，您可以用部分唯一索引替换触发器，但是您的性能会好很多。

如果代码不是您的，您将需要跟进编写它的人，了解为什么该函数不存在，但是当您这样做时，您可能需要跟进他们用这个替换触发器：

```
 CREATE UNIQUE INDEX ON corpus(name) WHERE corpus.t; 
```

这将表现得更好，并且更容易维护。

# java - 使用字节码进行 Java 调试

> ID：15178165
> 
> 赞同：6
> 
> 时间：2013-03-02T18:58:44.837
> 
> 标签：java, debugging, bytecode

我想知道是否有任何支持混合模式调试的IDE或Eclipse插件。当我搜索术语混合模式时，发现很多参考调试 VM 语言以及本机代码。

但是我指的是一种类似于编译语言（例如 C）中可用的功能，其中用户可以同时看到 C 源代码行以及相应的汇编行，并且即使在汇编级别也能够介入。（如果我将功能称为混合模式而犯了命名错误，请原谅）

换句话说，我在调试 java 时正在寻找以下功能：

1.  程序执行过程中获取java源代码和相应字节码的能力
2.  能够查看 JVM PC 寄存器和操作数堆栈
3.  能够查看其他 JVM 特定数据结构（例如常量池）

这是为了了解 Java 源代码如何映射到字节码，以及在介入时如何影响各种 JVM 相关数据结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-27T11:41:54.053

我是一名 DSL 开发人员，并且多次遇到同样的问题。

我发现的唯一工具是[Dr. Garbage](http://www.drgarbage.com/bytecode-visualizer/)工具。

目前，它们似乎不是维护得最好的，但它们确实可以与适当的 eclipse 版本一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:17:17.850

您不需要调试器来了解 Java 代码如何映射到已编译的本机代码。您可以使用`-XX:+PrintCompilation`JVM 标志。[请参阅Stephen Colebourne 的博客文章](http://blog.joda.org/2011/08/printcompilation-jvm-flag.html)中的模式信息，以及 Kris Mok[对该文章的回复中的](https://gist.github.com/rednaxelafx/1165804#file_notes.md)更多详细信息。

您可能还会发现[HotSpot Internals Wiki](https://wikis.oracle.com/display/HotSpotInternals/Home)很有用。

# java - Kryonet 日志不再出现

> ID：15178170
> 
> 赞同：1
> 
> 时间：2013-03-02T18:59:06.290
> 
> 标签：java, android, eclipse, kryonet

在我的 Eclipse 安装上安装 android SDK 之前，我的网络项目总是会从 Log.info("STRING") 输出任何内容到屏幕上的输出。

由于我已经为 Eclipse 安装了 Android 插件，因此从 Log.info 生成的任何内容都不再出现在输出控制台上。

即使将例如 Server.java 导出到 jar，jar 文件也只会输出来自 System.out.... 的任何内容。使用 com.esotericsoftware.minlog.Log; 用于从 Kryonet 包进行日志记录的包。

# javascript - iMacros EVAL 没有给出正确的输出

> ID：15178173
> 
> 赞同：1
> 
> 时间：2013-03-02T18:59:28.017
> 
> 标签：javascript, macros, eval, substring, imacros

好的，所以我试图从网站上抓取一些信息来尝试解释像 11/22 [50%] 这样的值。我可以保证该值至少是子字符串大小所需的最小值。到目前为止，代码可以找到数据、提取数据并将其设置为 !VAR1。但是由于某种原因，我无法将 !VAR2 放入页面上的输入字段中。它正确切换，找到输入字段并输入“提取结果：”就是这样。

所以我的输入是 11/22 [50%]，我只想要 11。所以我将字符串从位置 1,2 拆分为 11。

根据 iMacros wiki，我的语法是正确的，宏运行，我只是没有得到预期的输出，我假设是因为我的 EVAL 行。有谁知道为什么？也将不胜感激。

```
VERSION BUILD=7601105 RECORDER=FX
TAB T=1
'Go to website
URL GOTO=http://xxxxxxxxxxxxxxxxxxxx

'Set tag to refer to next
TAG POS=1 TYPE=TD ATTR=TXT:Nerve:

'Get the relative position of something that cannot be tagged and extract the cell's info
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT

'Set VAR1 to Extracted info (For debugging)
SET !VAR1 {{!EXTRACT}}

'Issue must be here, this is trying to run javascript substring on the information harvested.
SET !VAR2 EVAL("var s=\"{{!EXTRACT}}\"; s=s.substring(1,2); s;")

"Extract to null value to be referenced later
SET !EXTRACT NULL

'Test VAR2 by going to another page and posting the info in a textbox.
URL GOTO=http://xxxxxxxxxxxxxxxxxxxx
TAG POS=1 TYPE=INPUT ATTR=NAME:search[id] CONTENT=Extraction<SP>results:{{!VAR2}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:06:02.070

尝试使用

```
SET !VAR2 EVAL("var s=\"{{!EXTRACT}}\"; s=s.split(\"/\")[0];s;") 
```

String.split() 函数将字符串拆分为一个数组，当它找到您作为参数提供的任何内容时，每个部分都会被分开，该参数可以是正则表达式或字符串。

数组中的第一个对象 ([0]) 将是找到第一个“/”之前的文本。

然后我`return s`，所以 eval(); 将返回正确的输出。

# algorithm - 如何在图中找到最长的路径？

> ID：15178178
> 
> 赞同：6
> 
> 时间：2013-03-02T19:00:05.183
> 
> 标签：algorithm, data-structures, graph, tree, depth-first-search

我们得到一个表格的邻接列表

```
U -> (U,V,C) -> (U,V,C) ...  
U2 -> ...  
U3 -> ...  
.  
.  
etc 
```

`(U,V,C)`表示从 U 到 V 有一条边，成本为 C。

给定的邻接表适用于具有 N 个节点的单个连接树，因此包含 N-1 条边。

给出了一组节点`F=F1,F2,F3...Fk`。

现在的问题是在 F 中的节点中找到最长路径的最佳方法是什么？是否可以在 O(N) 中完成？

F中每个节点的DFS是唯一的选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:10:16.817

我将您的问题理解为要求从集合 F 中找到一对节点，以便这两个节点之间的唯一路径尽可能长。路径是唯一的，因为您的图表是一棵树。

正如您提到的，对于 O(nk) 解决方案，其中 n 是图的大小，k 是集合 F 的大小，可以通过对 F 中的每个节点进行 DFS 来轻松解决这个问题。

但是，您可以通过分而治之的方法更快地解决它。从图中选择任何节点 R，并使用单个 DFS 将 Dist(R, a) 到每个其他节点 aa 的距离制成表格，同时将节点划分为子树 S1,...,Sm，其中 m 是来自 R 的边；也就是说，这些是挂在根 R 处的 m 棵树。现在，对于属于不同子树的任何 f 和 g，它认为它们之间的路径具有 Dist(R, f) + Dist(R, g) 边，所以可以在 O(k^2) 时间内搜索最长的此类路径。此外，您必须递归到子问题 S1,...,Sm 以涵盖最长路径位于其中一棵树内的情况。整体复杂度可能低于 O(nk)，但数学留给读者作为练习。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2016-04-21T05:02:00.303

如果我正确理解了您的问题，那么您正在尝试在生成树中找到最长的成本路径。

您可以在 2 次完整遍历中找到路径，即 O(2N) ~ O(N) 对于较大的 N 值。

你应该做下面的步骤。

1.  选择生成树中的任何节点。
2.  从节点运行任何算法（DFS 或 BFS），并从该节点找到最长的成本路径。

这不会是您从随机选择一个节点开始的最长成本路径。

3.  从步骤 2 中找到的最长成本路径的最后一个节点再运行一次 BFS 或 DFS。
4.  这次你得到的最长成本路径将是生成树中最长的成本路径。

您不必从每个节点运行 DFS。

# python - 仅在呈现块时显示 HTML

> ID：15178179
> 
> 赞同：0
> 
> 时间：2013-03-02T19:00:17.380
> 
> 标签：python, wsgi, mako

我目前正在用 Python 开发一个网页，并使用 Mako 作为模板引擎。以前我在 Joomla 框架中使用过 PHP。从那里开始，一种常见的模板技术是检查模块位置是否有要显示的模块，在这种情况下加载一些包装代码（例如 wrapping `div`），然后将模块插入其中。

对于 mako，模块的比较将是`<%block />`然后由继承文件插入的。但是，我想不出一种巧妙的方式来显示包装代码。

来自 Joomla 的示例：

```
<div>
    <jdoc:include type="modules" name="my_position" style="none" />
</div> 
```

该`jdoc`行等效于`<%block name="my_position" />`在这两种情况下，内容会根据实际页面被替换。现在我的问题是：如何在没有*内容*`div`的情况下优雅地显示包装？Mako 是否为此提供了一个我只是忽略的优雅解决方案？*`block`*

 *提前致谢。

编辑：我找到了某种解决方案，但它并不漂亮，所以我希望有人能想出一个更清洁的解决方案：

```
<%namespace name="layout" file="layout.mako" />
<%block name="my_position">
    <%def name="my_element()">
        ## Actual position content here
    </%def>
    ${layout.render_my_position(my_element)}
</%block> 
```

然后，在`layout.mako`：

```
<%block name="banner" />
...
<%def name="render_my_position(my_element)">
    <div>
        ${my_element()}
    </div>
</%def> 
```

该解决方案有效，复制粘贴的量相对较小，而包装 div 的更改很容易。但是，这仍远非最佳解决方案，因此也许有人有更好的主意*

# php - mySQL 列出配置文件和电影，在一个查询中使用复杂的连接，但三个表

> ID：15178181
> 
> 赞同：1
> 
> 时间：2013-03-02T19:00:23.197
> 
> 标签：php, mysql, subquery, left-join, inner-join

**概述：** 我想获取个人资料列表和他们喜欢的电影。所有输出都显示在一页上。我正在使用 mySQL 和 PHP，目前在 localhost 上运行。理想情况下，为了速度，我希望这在一个查询中。

mySQL中的数据库表概述如下：

```
profile_tbl:
> id
> username
> about me
> gender
> hobbies
> profile_pic
> last_login

movies_tbl:
> id
> movie_name
> genre
> length
> rating
> description

profile_movies_rel_tbl
> id
> movie_id
> profile_id 
```

**输出：**

我想显示 10 个个人资料和他们喜欢的所有电影的列表。我在想以下查询：

```
SELECT  profile_tbl.*, movies_tbl.* FROM profile_tbl
LEFT JOIN profile_movies_rel_tbl
ON profile_movies_rel_tbl.movie_id = movies_tbl.id
LEFT JOIN profile_tbl
ON profile_tbl.id= profile_movies_rel_tbl.profile_id LIMIT 10 
```

**我还有第二个问题**，我想列出所有选择电影的个人资料，该页面再次列出个人资料和电影。在这种情况下，我正在考虑使用上述查询并添加以下内容：

```
WHERE profile_movies_rel_tbl.movie_id = 4 
```

任何人需要更多信息，请发表评论。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:04:18.703

我认为您想在子查询中使用 LIMIT 来返回 10 个不同的配置文件：

```
SELECT  profile_tbl.*, movies_tbl.* 
FROM (
     SELECT DISTINCT Id FROM profile_tbl LIMIT 10
    ) LimitTable
    INNER JOIN profile_tbl ON profile_tbl.Id=LimitTable.Id
    LEFT JOIN profile_movies_rel_tbl
        ON profile_movies_rel_tbl.profile_id = profile_tbl.id
    LEFT JOIN movies_tbl
        ON profile_movies_rel_tbl.movie_id = movies_tbl.id 
```

这可能会返回超过 10 行，但它应该只包含 10 个配置文件。

如果您想返回 10 行，请考虑使用 GROUP_CONCAT 将您的电影组合成一列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:10:52.630

您可以为此简单地使用连接。并且使用 GROUP_CONCAT 将为您提供所有电影的列表，但以逗号分隔。您可以使用 php explode 函数进行爆炸，它会在数组中为您提供结果。比您可以使用循环该数组来显示电影名称

```
SELECT 
    pt.*,
    GROUP_CONCAT(movie_name) AS `Movies`
FROM profile_tbl AS pt
INNER JOIN profile_movies_rel_tbl AS pmrt ON pmrt.profile_id = pt.id
INNER JOIN movies_tbl AS mt ON mt.id = pmrt.movie_id
GROUP BY pt.id
    LIMIT 10
    ORDER BY pt.id DESC 
```

# sql - PostgreSQL - 如何返回最后的 X 值？

> ID：15178182
> 
> 赞同：0
> 
> 时间：2013-03-02T19:00:35.980
> 
> 标签：sql, postgresql

让我们假设数据库中有这些值：

**时间列**

```
2013-03-02 19:00:00
2013-03-02 20:00:00
2013-03-02 21:00:00
2013-03-02 22:00:00 
```

我需要从查询中获取包含行中的值的最后 3 条记录。

```
SELECT * FROM table WHERE time_column =< '2013-03-02 22:00:00' LIMIT 3 
```

此查询返回这些行（否`22:00:00`）：

```
2013-03-02 19:00:00
2013-03-02 20:00:00
2013-03-02 21:00:00 
```

但我需要得到这些：

```
2013-03-02 20:00:00
2013-03-02 21:00:00
2013-03-02 22:00:00 
```

但是怎么做呢？

谢谢

**编辑：**有一种方法可以在应用程序层上获取所需的行，但如果可以从 sql 中获取，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:02:21.113

```
SELECT * FROM table WHERE time_column =< '2013-03-02 22:00:00'
ORDER BY time_column DESC
LIMIT 3 
```

# c++ - 在 C++ 中查找控件的位置

> ID：15178184
> 
> 赞同：0
> 
> 时间：2013-03-02T19:00:58.207
> 
> 标签：c++, winapi, mfc

我需要找到控件的 x 和 y 坐标，但我不知道从哪里开始。我在互联网上找到的唯一解决方案使用 MFC，我想避免使用它。那么，有没有办法不使用 MFC 来查找控件的坐标呢？

使用 FindWindow 查找控件：

```
 RECT cr;
    HWND chWnd   =   FindWindow("SunAwtCanvas", NULL);
    GetWindowRect(chWnd, &cr);
    cw   =   cr.right;
    ch   =   cr.bottom;
    cx   =   cr.left;
    cy   =   cr.top;
    cout << chWnd << endl; 
```

当它应该具有控件的 hWnd 时，chWnd 为 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:58:41.470

您获取 HWND 的代码很糟糕。

引用自 MSDN：[FindWindow](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499%28v=vs.85%29.aspx)

> 检索其类名和窗口名与指定字符串匹配的顶级窗口的句柄。此函数不搜索子窗口。此函数不执行区分大小写的搜索。

请改用[FindWindowEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633500%28v=vs.85%29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:06:58.203

在控件的 hwnd 上使用 GetWindowRect（每个控件都有自己的 hwnd）： http: [//msdn.microsoft.com/en-gb/library/windows/desktop/ms633519](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms633519(v=vs.85).aspx) (v=vs.85).aspx 。这将为您提供左、右、上和下允许知道控件的边界，并计算出它的高度和宽度

# asp.net-mvc-4 - mvc4 jquery自动完成项目显示为星号而不是可读数据

> ID：15178186
> 
> 赞同：0
> 
> 时间：2013-03-02T19:01:10.263
> 
> 标签：asp.net-mvc-4, jquery-autocomplete

我的自动完成功能运行良好，可以在我输入字段时看到它正在返回*一些*数据——但文本框下方下拉列表中显示的数据只是星号或列表项项目符号的垂直列。（我真的不知道它们是什么。）

当我直接在浏览器中查询 Web 服务时，它会按预期返回一个 Json 数组，如下所示，例如 ?term=chi （为了便于阅读，我添加了一些换行符）

```
[
 {"Name":"Chihuahua"},
 {"Name":"Chinese Crested"},
 {"Name":"Chinese Shar-Pei"},
 {"Name":"Japanese Chin"},
 {"Name":"Schipperke"} 
```

]

我的 JavaScript 看起来像这样：

```
$(function() {
    $("#Breed").autocomplete({
        source: "@Url.Action("BreedList", "Patient")"
    });
}); 
```

就像我说的，我有问题的文本框（#Breed）的响应有点像自动完成框，但下拉数据很奇怪。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T13:37:26.030

尽管我确实遇到了 CSS 捆绑问题（不知何故，我从捆绑包中省略了 jquery ui css），但更大的问题是我的服务返回的 Json 需要每个项目的小写“值”属性。我在我的 Linq 查询中使用了列名。指出我正确方向的提示来自这里的答案：[jQueryUI autoComplete 返回空列表](https://stackoverflow.com/questions/12393449/jqueryui-autocomplete-returns-back-empty-list)

# php - OAuthException：必须使用活动访问令牌来查询有关当前用户的信息

> ID：15178188
> 
> 赞同：0
> 
> 时间：2013-03-02T19:01:25.617
> 
> 标签：php, facebook, exception, sdk

我有这个错误，但**并非总是**如此。（我使用 PHP SDK，最新版本）。如果我登录 facebook 并尝试注册并登录，那么应用程序会说没问题！此外，如果我没有登录 facebook，应用程序会将我重定向到登录 url，这里一切正常。

但**有时**应用程序会说这个异常：*OAuthException：必须使用活动访问令牌来查询有关当前用户的信息。*并且脚本使用循环重定向将用户重定向到 loginUrl（因为访问令牌无效并且用户始终需要 loginUrl）

在网络上，有人说 Facebook 创建了访问令牌的**副本**，然后 php sdk 的访问令牌不是*=* facebook。

为了修复，用户**必须**删除 cookie，*我该如何解决这个问题？*

**非常感谢您的回复**，如果代码需要回复，我会发布它，祝您有美好的一天！**:)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-16T20:36:32.043

尝试销毁 Facebook 会话，如果收到此错误，则将用户重定向到登录 URI，这样您将获得新的访问令牌。

注意：访问令牌会在很短的时间内过期，您可以获得一个长期存在的访问令牌。最新的 PHP SDK 包含一个名为：setExtendedAccessToken() 的公共函数

您可以调用此函数自动将 2-3 小时的生活访问令牌交换为 60 天的访问令牌

例如：

```
try {
      $user = $this->facebooknew->api('/me');
      $this->facebooknew->setExtendedAccessToken();
      $access_token = $this->facebooknew->getAccessToken();
}
catch(FacebookApiException $e){
      $this->facebooknew->destroySession();
      header('Location: ' . $this->facebooknew->getLoginUrl($params));
        //echo $e;
} 
```

# c - OpenGL删除线

> ID：15178194
> 
> 赞同：-3
> 
> 时间：2013-03-02T19:01:50.920
> 
> 标签：c, opengl

我想画线，然后单击该线并将其删除。如何使用鼠标找到我想要的线？一个可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:05:39.513

您的问题与您知道的 OpenGL 无关。您必须保留一系列行，以某种方式获取鼠标输入（取决于您使用的是什么），确定单击期间的鼠标位置是否在现有行内（有一些误差），以及然后从集合中删除它。

# jruby - 在 mri ruby 和 jruby 之间重用共享/捆绑？

> ID：15178197
> 
> 赞同：0
> 
> 时间：2013-03-02T19:02:03.667
> 
> 标签：jruby, bundler, jrubyonrails

我正在使用 capistrano 部署一个 rails 应用程序，它用于`bundle install --deployment`将 gems 放在共享/捆绑中。我已经在我的 gemfile 中放置了适当的`platform :ruby`和`platform :jruby`块，我的问题是如果我将 rvm 切换到 jruby，然后转到我的应用程序根目录并执行另一个`bundle install --deployment`，这会与那里的任何现有 gem 混淆并用 jruby 替换它们吗？我能否像往常一样切换回 mri 并运行应用程序？两个平台的 gem 都会在那里，然后像 nokogiri 这样的具有 java 版本的 gem 会覆盖 mri 版本吗？那时我可以随意切换 rvm 版本并通过 mri 或 jruby 运行应用程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T01:04:08.440

原来 mri gem 安装在 shared/bundle/ruby 中，而 jruby gem 安装在 /shared/bundle/jruby 中，所以切换到 jruby 是完全安全的，安装你的 gem，然后尝试一下

# jboss - Jboss 4.2.3 - 8 个 CPU 中的一个 CPU 负载高

> ID：15178198
> 
> 赞同：0
> 
> 时间：2013-03-02T19:02:06.050
> 
> 标签：jboss, ajp

我们在亚马逊 AWS 机器上运行 Jboss 4.2.3，有 8 个内核 (CPU) 在负载下，我们看到一个线程仅在一个 CPU 上承担大量负载，而另一个几乎空闲。（其他线程分布在所有 CPU 上）

我们看到它使用顶部。

我们正在使用一个 AJP 连接器，连接到一个 httpd 实例。

可能是 AJP 连接器螺纹吗？还是别的什么？某种线程管理器线程？

任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T04:46:19.987

您可能还应该发布操作系统和 JVM 信息。问题可能是您的 JVM 没有使用所有其他 CPU，因为它可能没有针对多核/cpu 架构进行优化。JBoss 4.x 绝对没有针对它进行优化，但 JBoss AS 7 旨在利用多核架构。

# sql-server - 如何为 SQL Server 中的列指定 RTL 方向？

> ID：15178199
> 
> 赞同：1
> 
> 时间：2013-03-02T19:02:16.510
> 
> 标签：sql-server

SQL Server 中有没有一种方法可以指定列的 RTL 方向？目前我有一个这样的查询：

```
SELECT        IDSource, IDAviculture, Fee , NumberOfReserve, TotalMoney , Name + '(' + Description + ')' AS Descrition, Date 
FROM            dbo.tblReserve
WHERE        (Sell = 1) 
```

数据是波斯语，因此从右到左。问题是除非它不是 rtl，否则它不会以正确的形式显示信息。例如，以下文本需要从右到左，以便 سلام 进入括号内：

> علی (سلام)

```
IDSource    IDAviculture   NumberOfReserve TotalMoney  Name + '(' + Description + ')' AS Descrition  Date 
12              5                1500         3000                   علی (توضیحات) 
13              4                 700         2500                   مینا(تست ) 
```

我希望像

```
IDSource    IDAviculture   NumberOfReserve TotalMoney  Name + '(' + Description + ')' AS Descrition  Date 
12              5                1500         3000                  علی (توضیحات) س 
13              4                 700         2500                  مینا (تست ) س 
```

请注意，Stack Overflow 的编辑器也不支持 RTL，所以基本上它不会正确显示文本。我必须添加一个额外的字母 (س) 才能正确显示。

基本上我上面写的可以翻译成英文：

```
Name + '(' + Description + ')'

Ali (Description) 
Mina (Test) 
```

因为是 LTR，所以在英语中它很好，但是当涉及到 RTL 内容时，它就变得丑陋了。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:17:15.037

你可以从左到右存储它，然后当你选择它时，使用反向功能，这将有效地从右到左显示它？

[反向 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms180040.aspx)

# scala - Scala 2.10 中的 Futures.awaitAll 替换

> ID：15178200
> 
> 赞同：7
> 
> 时间：2013-03-02T19:02:17.020
> 
> 标签：scala, concurrency, future, fork-join

我需要生成一组 Futures 并等待它们全部完成，要么失败，要么成功。

最近的 Scala 2.10 不包含类似的东西，或者我确实错过了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-02T19:19:07.397

用于`Future.sequence`将许多独立`Future`的 s 变成一个直到所有这些成分都完成后才会完成的一个。

# ios - 使用 Interface Builder 创建的 UILabel 框架的来源错误

> ID：15178206
> 
> 赞同：1
> 
> 时间：2013-03-02T19:03:23.273
> 
> 标签：ios

我很难理解当我在界面生成器中放置一个 UILabel 然后在我的代码中获取坐标时，如下所示：

```
self.myLabel.frame.origin.x 
```

我总是得到 0。为什么即使我已经将 UILabel 放在屏幕的中心？如何获得正确的坐标？

UILabel 被添加到 UIScrollView。UIScrollView 覆盖整个 iPhone 屏幕 320X480。UIScrollView 是通过界面生成器添加的。

```
NSLog(@"%f",self.scrollView.bounds.size.height); returns 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:05:22.433

原点始终相对于父视图，在您的情况下为`UIScrollView`. 一个`UIScrollView`作品的方式是它的内容可以有一个固定的来源，但随着内容大小和偏移量（滚动位置）的改变，它仍然会出现在不同的地方。

此外，您没有说明 的大小`UILabel`，因此其中的文本也可能居中，但视图本身要大得多。

此外，您没有说明您在代码中的哪个位置检查坐标；如果您过早检查它们，它们可能尚未设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:21:28.070

如果之前的答案都没有解决您的问题，

确保将接口构建器中的标签与其接口头文件中的 IBOutlet 连接起来，在您的情况下，标题应包含

```
@property (nonatomic,weak) IBOutlet UIlabel* myLabel; 
```

并使用此属性从接口连接器正确连接

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T21:09:54.830

您确定 self.myLabel 不为零，并且您已将其正确连接到您的代码吗？此外，您正在从 xib 文件加载视图，而不仅仅是在视图上使用 alloc/init...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T19:10:35.437

也许您在将标签添加到视图之前检查它。当您实际上可以在屏幕上看到标签并检查值时，请尝试在代码中的某处放置断点。

# android - 姜饼及以下中的操作栏保留菜单项

> ID：15178207
> 
> 赞同：1
> 
> 时间：2013-03-02T19:03:35.530
> 
> 标签：android, animation, android-actionbar, actionbarsherlock, android-viewpager

`ActionView`我在我的`Actionbar`（特别是）中使用一个奇怪的问题`ActionbarSherlock`。此问题仅发生在 SDK 3.0 以下的设备中（基本上，我正在测试 Gingerbread 设备）。

我的应用程序有一个`ViewPager`，我正在为我的一个菜单项设置动画，而一个`AsyncTask`正在运行。如果我在滑动之前触摸`ActionView`一切正常，如果我滑动到任何视图，然后返回第一个视图，这是唯一具有 的视图`ActionView`，然后触摸`ActionView`图标本身会加倍，如下所示：

![在此处输入图像描述](../Images/be99a44a444e2922ecde702ee5a18980.png)

我之前遇到过同样的问题，在我实现之前，`ViewPager`我通过停止和启动动画`onCreateOptionsMenu`并调用来修复它，`invalidateMenuOptions`这就是为什么我`ActivityCompat.invalidateOptionsMenu(this);`在`onResume`. `Activity`我希望通过调用它，菜单会自行刷新并修复重复，但事实并非如此。

**更新**使用`getSherlock().dispatchInvalidateOptionsMenu();`似乎，至少，让菜单刷新自己，但它导致`ActionView`发疯。

**浏览器：**

```
public class Main extends SherlockFragmentActivity
{
    private static List<Integer> mIds;
    private static SparseArray<Fragment> mPageReferenceMap = new SparseArray<Fragment>();

    @Override
    public void onCreate(final Bundle icicle)
    {    
        super.onCreate(icicle);

        setContentView(R.layout.main);

        mViewPager = (ViewPager)findViewById(R.id.viewpager);
        mMyFragmentPagerAdapter = new MyFragmentPagerAdapter(getSupportFragmentManager());
        mViewPager.setAdapter(mMyFragmentPagerAdapter);

        mViewPager.setOnPageChangeListener(new OnPageChangeListener() {

            @Override
            public void onPageSelected(int position) {
                GetListingFragment().StopAnimation(); //needed to add this because the ActionView was showing on the other views when swiping
            }

            @Override
            public void onPageScrolled(int position, float offset, int offsetPixel) {
            }

            @Override
            public void onPageScrollStateChanged(int state) {

            }
        });

        mIds = new ArrayList<Integer>();

        mIds.add(0);
        mIds.add(1);
        mIds.add(2);
    }

    @Override
    public void onResume()
    { 
        super.onResume();
        ActivityCompat.invalidateOptionsMenu(this);
    }

    private ListingFragment GetKeywordsFragment()
    {       
        ListingFragment lf = (ListingFragment)getSupportFragmentManager().findFragmentById(R.id.fragmentListing);

        if (lf == null)
        {
            final MyFragmentPagerAdapter fpa = (MyFragmentPagerAdapter)mViewPager.getAdapter();
            lf = (ListingFragment)fpa.getFragment(0);
        }

        return lf;
    }

    private static class MyFragmentPagerAdapter extends FragmentStatePagerAdapter  {  

        public MyFragmentPagerAdapter(FragmentManager fm) {  
             super(fm);  
        }  

        @Override  
        public Fragment getItem(int index) {
            if (index == 0)
            {
                final ListingFragment lf = ListingFragment.newInstance();
                mPageReferenceMap.put(index, lf);
                return lf;
            }
            else
            {
                final DetailFragment df = DetailFragment.newInstance(mIds.get(index));
                mPageReferenceMap.put(index, df);
                return df;
            }
        }  

        public Fragment getFragment(int key) {
            return mPageReferenceMap.get(key);
        }

        @Override
        public int getCount() {  
             return 3;
        }
   }  
} 
```

**分段：**

```
public class ListFragment extends SherlockListFragment
{
    private int mId;
    private MenuItem refreshItem;
    private AsyncTask<Void, String, Void> gi;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setHasOptionsMenu(true);
    }

    public static ListingFragment newInstance(int id) {

        ListingFragment lf = new ListingFragment();
        Bundle bundle = new Bundle();
        bundle.putInt("id", id);
        lf.setArguments(bundle);

        return lf;
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        if (getArguments() != null)
            mId = getArguments().getInt("id");

        return inflater.inflate(R.layout.listing, container, false);
    }

    private class GetItems extends AsyncTask<Void, String, Void> {

        @Override
        protected void onPreExecute() 
        {
          StartAnimation();
        }

        @Override
        protected Void doInBackground(Void... unused)
        {
            //background process to get items
        }

        protected void onPostExecute(final Void unused)
        {
            StopAnimation();
        }
    }

    @Override
    public void onCreateOptionsMenu(final Menu menu, final MenuInflater inflater) {
        inflater.inflate(R.menu.keyword_menu, menu);

        StopAnimation();

        refreshItem = menu.findItem(R.id.refresh);

         if (fi != null && fi.getStatus() == AsyncTask.Status.RUNNING)
            StartAnimation();

        super.onCreateOptionsMenu(menu, inflater);
    }

    private void StartAnimation() {

        if (refreshItem != null && refreshItem.getActionView() == null)
        {
           final LayoutInflater inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
           final ImageView ivRefresh = (ImageView)inflater.inflate(R.layout.refresh_view, null);

           final Animation rotation = AnimationUtils.loadAnimation(activity, R.anim.refresh);
           ivRefresh.startAnimation(rotation);

           refreshItem.setActionView(ivRefresh);
        }
    }

    public void StopAnimation()
    {
        if (refreshItem != null && refreshItem.getActionView() != null) 
        {
            refreshItem.getActionView().clearAnimation();           
            refreshItem.setActionView(null);
        }
    }

    @Override
    public boolean onOptionsItemSelected(final MenuItem item) 
    {
        if (item.getItemId() == R.id.getitems) {
            gi = new GetItems(getActivity(), null);

            return true;
        } else {
            return super.onOptionsItemSelected(item);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T15:43:14.493

看起来这是 ABS 中的一个已知错误：

[https://github.com/JakeWharton/ActionBarSherlock/issues/331](https://github.com/JakeWharton/ActionBarSherlock/issues/331)

# ios - 我想保存应用程序，因此当用户退出时，用户返回时 uitextfields 不会擦除为文本

> ID：15178208
> 
> 赞同：0
> 
> 时间：2013-03-02T19:03:50.037
> 
> 标签：ios, objective-c

我想保存应用程序，以便当用户退出时，用户返回时 uitextfields 不会擦除为文本。

当应用程序终止时，它会擦除​​ uitextfields 中的所有数据。

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:57:20.497

您应该将所有值保存到 NSUserDefaults 中，以针对代表相应 textFiled 的键。在 appDidFinishLaunching 方法中，您应该清除所有值。这样当用户从终止状态打开应用程序时，所有值都会被清除并显示空文本字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:07:50.320

有很多替代方案，使用序列化及其`read`/`write`方法。我想你应该看看这个链接：[http](http://cocoaheads.byu.edu/wiki/nscoding) ://cocoaheads.byu.edu/wiki/nscoding 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T19:21:11.347

如果您只需要文本而不是整个 uitextfield 对象，您可以将所有字段放在 NSDictionary 中并将它们写为 plist。这种策略有很多支持，它可能是最简单的。

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html)

# python - 使用 xml.etree.ElementTree 解析 XHTML

> ID：15178209
> 
> 赞同：1
> 
> 时间：2013-03-02T19:04:01.167
> 
> 标签：python, xml-parsing, elementtree

我想用`xml.etree.ElementTree`Python 3 解析一个 XHTML 文档。该文档包含`&nbsp;`实体，所以我不能使用默认的解析器设置。我想做类似的事情：

```
with urllib.request.urlopen(BASE_URL) as url:
        body = url.read()
        parser = ET.XMLParser()
        parser.parser.UseForeignDTD(True)
        parser.entity.update(entitydefs)
        etree = ET.ElementTree()
        root = etree.fromstring(body) 
```

但`fromstring`在`ElementTree`. 我怎样才能用`ElementTree`实例实现类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-02-24T01:18:58.663

好吧，我遇到了同样的问题。问题中的示例代码和选择的答案可能以前有效，但现在它不适用于我的 Python 3.3 和 Python 3.4 环境。

我终于让它工作了。引自此[问答](https://stackoverflow.com/questions/35591478/how-to-parse-html-with-entities-such-as-nbsp-using-builtin-library-elementtree)。

受[这篇文章的](http://forums.devshed.com/xml-programming-19/xml-parsing-error-undefined-entity-564981.html)启发，我们可以在传入的原始 HTML 内容之前添加一些 XML 定义，然后 ElementTree 就可以开箱即用了。

这适用于 Python 2.6、2.7、3.3、3.4。

```
import xml.etree.ElementTree as ET

html = '''<html>
    <div>Some reasonably well-formed HTML content.</div>
    <form action="login">
    <input name="foo" value="bar"/>
    <input name="username"/><input name="password"/>

    <div>It is not unusual to see &nbsp; in an HTML page.</div>

    </form></html>'''

magic = '''<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
            "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" [
            <!ENTITY nbsp ' '>
            ]>'''  # You can define more entities here, if needed

et = ET.fromstring(magic + html) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:07:22.120

输入解析器：

```
with urllib.request.urlopen(BASE_URL) as url:
    body = url.read()
    parser = ET.XMLParser()
    parser.parser.UseForeignDTD(True)
    parser.entity.update(entitydefs)
    parser.feed(body)
    root = parser.close()   # this returns you the tree 
```

# c# - WPF 布局问题

> ID：15178210
> 
> 赞同：1
> 
> 时间：2013-03-02T19:04:10.887
> 
> 标签：c#, wpf

我不知道我做错了什么我有一个 2 列和 3 行的网格。在左栏中，我有一个文本块和文本框以及一个列表框，这些都很好。

右栏变得有点复杂，我有一个 tabcontrol 开始。然后是我的 TabItem，在里面我有我的主网格，然后在里面我有 2 个网格。分别是 grdDetailsTop 和 grdDetailsBottom。

grdDetailsTop 有 3 列，其中左侧是带有边框的图像，中间应该是成员代码：'TextBox'，下面应该是家庭代码：'TextBox'，最后我想在下面放置 Balance：'TextBox'

我尝试的方法是，我在第一列中有 3 列的 grdDetailsTop Grid，我放置了一个 groupbox，在里面我有一个 stackpanel。

第二列是我遇到问题的地方，我放置了一个 Stackpanel，其方向为 Horizo​​ntal 和 grid.Column="1" 但我的文本块在没有我告诉他们的情况下进入第三列。抱歉解释不好，但代码已发布，希望您能提供帮助。另外我使用不同面板的原因是我可以在 grdDetailsTop 的每一列周围放置一个边框。

谢谢

```
 <Grid ShowGridLines="True">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="20*"></ColumnDefinition>
            <ColumnDefinition Width="70*"></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"></RowDefinition>
            <RowDefinition Height="5*"></RowDefinition>
            <RowDefinition Height="100*"></RowDefinition>
        </Grid.RowDefinitions>

            <TextBlock Text="Search Member" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="20"></TextBlock>
            <TextBlock Text="Member Details" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="20"></TextBlock>
            <TextBox Name="txtMEMSearch" Background="Orange" Grid.Column="0" Grid.Row="1"></TextBox>
            <ListBox Name="lstSearchMembers" Grid.Row="2"
                     BorderBrush="Black" DisplayMemberPath="Name"
                     ItemsSource="{Binding ElementName=bindingToObject,
                                           Path=Clients}" />

        <TabControl Name="mainTabControl" Grid.Column="1" Grid.Row="1" Grid.RowSpan="2" Margin="5">
            <TabItem Header="Member Details" Name="memDetailTab">
                <Grid Name="mainTabGrid">
                    <Grid Name="grdDetailsTop" Height="175" VerticalAlignment="Top">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150"></ColumnDefinition>
                            <ColumnDefinition Width="200"></ColumnDefinition>
                            <ColumnDefinition Width="*"></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <GroupBox Header="Picture">
                            <StackPanel>
                                <Image Height="125" Width="125"></Image>
                            </StackPanel>
                        </GroupBox>

*************PROBLEM AREA******************

                        <StackPanel Margin="5" MaxWidth="200" Orientation="Horizontal" Grid.Column="1">
                            <TextBlock
                                VerticalAlignment="Top"
                                Margin="5"
                                Height="25">Member Code:</TextBlock>
                            <TextBlock
                                VerticalAlignment="Top"
                                Margin="5"
                                Width="75"
                                Height="25"></TextBlock>

                            <TextBlock
                                Margin="5"
                                Height="25"
                                Width="100">Family Code:</TextBlock>

                            <TextBlock
                                Margin="5"
                                Width="75"
                                Height="25"></TextBlock>

                            <TextBlock
                                VerticalAlignment="Bottom"
                                Margin="5"
                                Height="25"
                                Width="100">Balance Due:</TextBlock>

                            <TextBlock
                                Margin="5"
                                VerticalAlignment="Bottom"
                                Width="75"
                                Height="25"></TextBlock>
                        </StackPanel>  

******************************************                                                   
                    </Grid>

                    <Grid Name="grdDetailsBottom">                   
                    </Grid>                  
                </Grid>
          </TabItem>
        </TabControl>         
    </Grid>
</Page> 
```

![截屏](../Images/12516fabf17e9cdf2802cf7c535c4185.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:35:56.923

您缺少`VerticalAlignment = "Top"`on that `TextBlock`，因此默认情况下`Stretch`，它将在可用垂直空间中居中显示文本。如果您设置该属性，您会看到它向上移动以与`TextBoxes`同一`StackPanel`.

它实际上并没有将它移动`TextBox`到下一列，而是定义了它所在列的固定宽度（在本例中，第 1 列的宽度为 200）。但是该列的内容（`StackPanel`宽度超过 200 个单位，因此它们推入下一个网格列。要保留第`TextBoxes`1 列中的所有内容，您要么需要加宽列以使其适合，缩小尺寸的`TextBoxes`或设置宽度`Auto`，以便它会自动调整其内容的大小。如果你看一下，你用`TextBlocks`2 和 3 占用了 175 个单位，剩下的 25 个单位只剩下 25 个单位`TextBlocks`。`StackPanel`只是不够空间。

```
<StackPanel Margin="5" MaxWidth="200" Orientation="Horizontal" Grid.Column="1">
  <TextBlock VerticalAlignment="Top" Margin="5" Height="25">Member Code:</TextBlock>
  <TextBlock VerticalAlignment="Top" Margin="5" Width="75" Height="25"></TextBlock>
  <TextBlock VerticalAlignment="Top" Margin="5" Height="25" Width="100">Family Code:</TextBlock>
  ... other text boxes ...
</StackPanel> 
```

这将解决垂直布局问题，但不能解决水平布局问题。这需要更改网格列的大小或内容的大小。

根据您在下面的评论，我相信您正在寻找在`WrapPanel`空间不足时自动将项目包装到下一行（水平或垂直）的东西。

```
<WrapPanel Margin="5" MaxWidth="200" Orientation="Horizontal" Grid.Column="1">
  <TextBlock VerticalAlignment="Top" Margin="5" Height="25">Member Code:</TextBlock>
  <TextBlock VerticalAlignment="Top" Margin="5" Width="75" Height="25"></TextBlock>
  <TextBlock VerticalAlignment="Top" Margin="5" Height="25" Width="100">Family Code:</TextBlock>
  ... other text boxes ...
</WrapPanel> 
```

这种布局当然看起来更好。但是 - 我不知道您的具体要求，但是`WrapPanel`我建议您使用`Grid`with`ColumnDefinitions`和`RowDefinitions`来组织这种布局中的项目，而不是使用具有固定边距和大小的 a。它`Grid`提供了更大程度的灵活性，并允许项目根据系统字体大小、用户调整视图大小以及其他不受您控制的因素自动调整大小。如果您设置固定的高度/宽度，您将失去这种灵活性。同样，我不知道你的要求，所以也许这对你来说是最好的解决方案，但在大多数情况下，我强烈推荐一个`Grid`。

# validation - 使用 hasMany 关系验证控制器中的表单字段

> ID：15178215
> 
> 赞同：0
> 
> 时间：2013-03-02T19:04:43.253
> 
> 标签：validation, cakephp

为了测试目的，我在验证控制器内的表单字段时遇到了一些问题。

我有我的模型`Experience`hasMany `ExperienceDetail`。`ExperienceDetail`属于To `Experience`。

`FormHelper`我使用其中包含以下内容创建了一个表单：

索引.ctp

```
<?php
echo $this->Form->create('Experience', array('action' => 'index'));
echo $this->Form->input('Experience.date', array(
        'label' => array(
            'text' => 'Datum'),
        'type' => 'date',
        'dateFormat' => 'DMY',
        'monthNames' => false,
        'minYear' => date('Y') - 10,
        'maxYear' => date('Y')
        )
    );      
echo $this->Form->input('Experience.test');
echo $this->Form->input('ExperienceDetail.vertrekstation');
echo $this->Form->end('Verstuur!');
?> 
```

提供了更多字段`ExperienceDetail`，但这些与此无关。

经验.php

```
<?php 
class Experience extends AppModel {
    public $name = 'Experience';

    public $hasMany = 'ExperienceDetail';

    public $validate = array(
        'vertrekstation' => array(
            'rule' => 'notEmpty',
            'message' => 'Voer een vertrekstation in',
            'required' => true
        ),
        'test' => array(
            'rule' => 'notEmpty',
            'message' => 'Test mag niet leeg zijn!'
        )
    );
}
?> 
```

ExperienceDetail.php

```
<?php
class ExperienceDetail extends AppModel {
    public $name = 'ExperienceDetail';

    public $belongsTo = 'Experience';

    public $validate = array(
        'vertrekstation' => array(
            'rule' => 'notEmpty',
            'message' => 'Voer een vertrekstation in'
        )
    );
}
?> 
```

ExperiencesController.php

```
<?php 
class ExperiencesController extends AppController { 
public $helpers = array('Html', 'Form', 'Session');

public function index() {
    // $this->layout = 'default_orig'; 
    $this->set('title_for_layout', 'De OV-Ervaringenmeter!');

    // LOAD Model Carrier 
    $this->loadModel('Carrier');
    $this->set('carrier', $this->Carrier->find('list', array('order' => array('Carrier.name' => 'asc'))));

    // Check if form is allready filled
    if($this->request->is('post')) {

        $this->Experience->set($this->request->data);
        $this->Session->setFlash('No if or else statement is called');

        if ($this->Experience->validates()) {
            $this->Session->setFlash('Validates!');
        }
    }       

}
}
?> 
```

问题是：当我发送表单并`test`留空时，它会提供我在模型中设置的验证错误。但是当我`vertrekstation`留空时，它不会为我提供任何属于输入字段的错误。

我做错了什么以及如何打印这些错误？

# r - R Linux Shell将多页xls批量转换为csv

> ID：15178218
> 
> 赞同：3
> 
> 时间：2013-03-02T19:04:50.630
> 
> 标签：r, bash, csv, xls

在 R 中，我有一个脚本获取多个 xls 文件的内容<[循环目录以获取 Excel 内容](https://stackoverflow.com/questions/15130048/loop-over-directory-to-get-excel-content)>。

所有文件大约 2 MB。该脚本需要几秒钟来处理 3 个文件，但现在在 Debian i7 系统上运行了 6 个小时，但对 120 个文件没有结果。

因此，更好的解决方案是 [希望] 使用 ssconvert 将所有 xls 文件转换为 csv，使用 bash 脚本<[目录中每个文件的 Linux Shell 脚本抓取文件名并执行程序](https://stackoverflow.com/questions/2297510/linux-shell-script-for-each-file-in-a-directory-grab-the-filename-and-execute-a)>：

```
for f in *.xls ; do xls2csv "$f" "${f%.xls}.csv" ; done 
```

这个脚本完成了这项工作，但是我的内容在第 nr 14 表中，而这个脚本生成的 csv 文件只返回第一张表[我用 'ssconvert' 替换了 'xls2csv']。

可以采用此脚本仅拾取工作簿中的第 14 表吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:54:41.283

如果您知道工作表名称，则可以执行以下操作：

```
for f in *.xls ; xls2csv -x "$f" -w sheetName -c "${f%.xls}.csv";done 
```

要查看所有 xls2csv 详细信息，请参见[此处](http://search.cpan.org/~ken/xls2csv-1.06/script/xls2csv)。

**编辑**

OP找到了正确的答案，所以我编辑我的添加它：

```
for f in *.xls ; do xls2csv -x "$f" -f -n 14 -c "${f%.xls}.csv" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:04:51.410

对于这项工作，我使用了一个名为 ssconverter.py 的 Python 脚本（您可以在[此处](http://www.linuxjournal.com/content/convert-spreadsheets-csv-files-python-and-pyuno-part-1v2)找到，向下滚动并下载两个附件，ssconverter.py 和 ooutils.py），我使用`system()`.

它可以提取工作簿中的特定工作表，不仅可以按名称，还可以按工作表编号，例如：

```
ssconverter.py infile.xls:2 outfile.csv 
```

提取第二张纸。

您需要安装 python 和 python-uno。

# c# - 抽象类和接口有什么区别？

> ID：15178219
> 
> 赞同：50
> 
> 时间：2013-03-02T19:04:53.943
> 
> 标签：c#, oop, interface, abstract-class

假设我们有两个方法`M1()`和`M2()`一个接口。一个抽象类也有同样的两个抽象方法。如果任何类实现了此接口或继承自抽象类，则必须实现其中的两个方法。

所以对我来说，似乎接口或抽象类在我的场景中表现相同。**那么，任何人都可以在这种特定情况下**强调这两者之间的区别，并建议在这里使用抽象类还是接口？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2013-03-02T19:11:16.013

抽象类和接口之间存在技术差异，抽象类可以包含方法、字段、构造函数等的实现，而接口仅包含方法和属性原型。一个类可以实现多个接口，但它只能继承一个类（抽象或其他）。

但是，在我看来，接口和抽象类之间最重要的区别是语义上的区别。

接口定义了某物*可以做什么*（它的行为方式），而抽象类定义了某物是什么。

举个例子`IEnumerable`，这背后的语义是任何实现的东西`IEnumerable`都是可枚举的，这并不意味着它是一个枚举，而是它可以表现得像一个（可以枚举）。

与洗衣机的例子相比，任何继承它的东西都是一种洗衣机。任何继承它的东西都是洗衣机、顶部装载机或侧装载机等。

相反，如果你有一个名为 的接口`ICanWash`，它可能包含一个名为 的方法`Wash`。您可以实现各种事物`ICanWash`，无论是 a `Person`，抽象洗衣机类等，实际实现并不重要，您只需要知道行为是它可以洗涤事物。

总而言之，类定义了某物是什么，接口定义了某物可以做什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T19:14:58.643

来自[MSDN](http://msdn.microsoft.com/en-us/library/vstudio/ms173156.aspx)：

> 例如，通过使用接口，您可以在一个类中包含来自多个来源的行为。该功能在 C# 中很重要， **因为该语言不支持类的多重继承**

因此，如果您希望任何类都可以继承该方法，请使用接口。

从同一个 MSDN 页面：

> 此外，如果要模拟结构的继承，则必须使用接口，因为它们实际上不能从另一个结构或类继承。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T19:09:33.283

接口允许一个类继承/实现多个接口，而在 C# 中，您只能从一个类继承。

基本上是多重继承。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-02T19:12:36.970

抽象类不仅包含抽象方法，它还可以包含其他具有实现的字段和方法。在 C# 中，您不能从多个类继承，但您可以实现多个接口。所以简短的回答是：尽可能使用接口而不是抽象类。在您的示例中，建议使用接口。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-02T19:13:11.317

关于接口和抽象类之间差异的两个快速思考：

1.  如果将来可能扩展，则需要抽象类，因为可以扩展抽象类，但是必须通过添加另一个接口 I2 来增强接口。
2.  单（实现）继承是指精心选择抽象类，以最贴切地反映真实的基本性质。接口可以很容易地添加到实现中，但是只有在还没有抽象类的情况下才能添加抽象类。

# ruby - 在 Mac 上将 html 文件转换为 pdf

> ID：15178220
> 
> 赞同：1
> 
> 时间：2013-03-02T19:04:54.053
> 
> 标签：ruby, macos, cocoa, pdf, applescript

我希望在没有任何第三方实用程序的情况下将 html 文件转换为 pdf。我对 cupsfilter 的输出不感兴趣，也不想编写浏览器脚本。此 AppleScript / Ruby 脚本使用 PDFKit 重新保存 pdf（以解决 InDesign 问题）。有没有办法修改它以接受 html 文件作为输入？也欢迎任何其他解决方案！

```
on pdf_resave(infile, outfile)
    set rb to "require 'osx/cocoa'
OSX.require_framework 'PDFKit'
include OSX

raise ArgumentError, %Q[Usage: $0 <input pdf> <output pdf>] unless ARGV.length == 2
infile, outfile = ARGV
url = NSURL.fileURLWithPath(infile)
pdf = PDFDocument.alloc.initWithURL(url)
pdf.writeToFile(outfile)"

    do shell script "/usr/bin/ruby -e " & rb's quoted form & " " & infile's quoted form & " " & outfile's quoted form
end pdf_resave 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:06:46.113

我建议使用 webkit HTML to pdf 库[https://github.com/antialize/wkhtmltopdf](https://github.com/antialize/wkhtmltopdf)。

您可以从 Ruby 中调用二进制文件。

安装它：

```
brew install wkhtmltopdf 
```

如果部署/依赖性问题是一个问题，您可以将其与 Ruby 脚本打包成一个包。您只需在安装脚本中添加一个检出和编译阶段（从而避免需要安装`brew`。） - 您也可以通过这种方式打包一个预制的二进制文件，只要您在目标平台上测试它（我会建议10.6以上，你是安全的）。

有关制作`.pkg`安装包的更多信息，请参阅此[简洁指南](http://www.osxgnu.org/info/osxpackages.html)。

不过，这一切都太过分了，因为至少据我所知`wkhtmltopdf`，除了给它提供一批 html 文件之外，至少在我看来，它会为您完成这项工作，在这种情况下，将其包装在一个 shell 脚本中，然后停止胡闹;)

# c# - 当前上下文中不存在名称错误

> ID：15178223
> 
> 赞同：0
> 
> 时间：2013-03-02T19:04:59.883
> 
> 标签：c#, .net, wpf, winforms

```
public partial class MainWindow: Window {
    public static ABClient client;

    public MainWindow() {
        InitializeComponent();
        client=new ABClient();
        client.Connect();
    }
}

class B {
    public B() {
        client.Connect();  // The name 'client' does not exist in the current context
    }
} 
```

如果客户端是公开的，为什么我会收到此编译错误？我需要一个可以从任何其他窗口或类访问的客户端。请帮助解决问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T19:09:55.330

你需要这样称呼它：

```
MainWindow.client.Connect(); 
```

# opengl - 来自高度贴图神器的法线贴图

> ID：15178225
> 
> 赞同：3
> 
> 时间：2013-03-02T19:05:09.857
> 
> 标签：opengl, webgl, shader, normals, heightmap

我正在从高度图的片段着色器上烘焙法线贴图。高度图看起来很棒并且看起来很平滑。然而，当我生成法线贴图时，我得到了非常奇怪的结果。

这是显示问题的两张渲染图像，一张包含所有照明计算，第二张将法线贴图图像应用于网格顶部。 ![标准地图](../Images/34fbe8e4136798a716bd1c3349c8b943.png)

![在此处输入图像描述](../Images/439a0f27c7e17a72ddfea7ce99a2c307.png)

我烘焙法线贴图的方法是在片段着色器上对相邻像素进行采样。

网格为 32x32，法线贴图和高度贴图为 64x64。这是对相邻像素进行采样的片段着色器代码：

```
float NORMAL_OFF = (1.0 / 64.0);
vec3 off = vec3(-NORMAL_OFF, 0, NORMAL_OFF);

// s11 = Current
float s11 = texture2D(uSampler, texturePos).x;

// s01 = Left
float s01 = texture2D(uSampler, vec2(texturePos.xy + off.xy)).x;

// s21 = Right
float s21 = texture2D(uSampler, vec2(texturePos.xy + off.zy)).x;

// s10 = Below
float s10 = texture2D(uSampler, vec2(texturePos.xy + off.yx)).x;

// s12 = Above
float s12 = texture2D(uSampler, vec2(texturePos.xy + off.yz)).x;

vec3 va = normalize( vec3(off.z, 0.0, s21 - s11) );
vec3 vb = normalize( vec3(0.0, off.z, s12 - s11) );

vec3 normal = normalize( cross(va, vb) ); 
```

texturePos 在顶点着色器上计算为 vertexPosition.x / 128（128，因为顶点之间的距离是 4 像素。所以 32 * 4 = 128）。

为什么我的结果如此奇怪？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T19:38:17.453

您的高度图的采样深度分辨率太低，导致这些艰难的步骤。可能您的高度图是 8 位的，最多为您提供 256 个高度级别。现在，如果您的高度图的平面分辨率高于 256，则横向分辨率不足以表示平滑的高度场。

解决方案：为您的高度图使用更高的采样分辨率。16 位是一种流行的选择。

虽然您的着色器和烘焙代码很好，但它们只是没有获得足够分辨率的输入数据。

# compilation - 未定义对“线程的类型信息”的引用

> ID：15178226
> 
> 赞同：1
> 
> 时间：2013-03-02T19:05:16.263
> 
> 标签：compilation, undefined, typeinfo

我写了这段代码，但编译器给我一个错误，不知道为什么：S所以我想知道你能帮助我：这是一个用于简单线程实现的抽象类：

```
#ifndef THREAD_H
#define THREAD_H

#include <pthread.h>

class Thread {
public:
    void start();
    inline pthread_t getThread() const{
        return _thread;
    }

private:
    pthread_t _thread;
    inline static void* callRun(void* pObject){
        ((Thread*)pObject)->run();
        return (void*)0;
    }

protected:
    virtual void* run();
};

#endif  /* THREAD_H */ 
```

源代码是：

```
#include "Thread.h"

void Thread::start(){
    pthread_attr_t attrib;
    pthread_attr_init(&attrib);
    pthread_attr_setdetachstate(&attrib, PTHREAD_CREATE_JOINABLE);
    pthread_create(&_thread, &attrib, callRun, (void*)this);
    pthread_attr_destroy(&attrib);
} 
```

并且类 PlayersManager 继承自 Thread

```
#ifndef PLAYERMANAGER_H
#define PLAYERMANAGER_H

#include "Thread.h"

class PlayersManager : public Thread {

private:
    void movePlayers();
    void checkPlayers();
    void* run();
};

#endif  /* PLAYERMANAGER_H */ 
```

但我得到下一个编译错误： build/Debug/GNU-Linux-x86/PlayersManager.o:(.rodata._ZTI14PlayersManager[_ZTI14PlayersManager]+0x8): undefined reference to `typeinfo for Thread'

知道发生了什么吗？谢谢。

# mysql - InnoDB：使用插入选择的自定义自动增量。会出现重复键错误吗？

> ID：15178227
> 
> 赞同：1
> 
> 时间：2013-03-02T19:05:16.950
> 
> 标签：mysql, innodb, percona, xtradb

我有一张像这样的桌子：`idx (PK) clmn_1`

两者都是INT。`idx`未定义为自动增量，但我正在尝试模拟它。要插入此表，我正在使用：

```
"INSERT INTO  my_tbl (idx, clmn_1)   \
 SELECT IFNULL(MAX(idx), 0) + 1, %s  \
 FROM my_tbl", val_clmn_1 
```

现在，这行得通。我的查询是关于原子性的。由于我读取然后插入到同一个表中，当多个插入同时发生时，可能会出现重复键错误吗？

而且，我怎样才能自己测试呢？

我正在使用 Percona XtraDB 服务器 5.5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:28:58.043

这不是一个好的解决方案，因为它在执行 SELECT 时会在 my_tbl 上创建一个共享锁。任意数量的线程可以同时拥有一个共享锁，但它会阻塞并发写锁。所以这会导致插入序列化，等待 SELECT 完成。

你可以观察这个锁。在一个会话中启动此查询：

```
INSERT INTO  my_tbl (idx, clmn_1) 
 SELECT IFNULL(MAX(idx), 0) + 1, 1234+SLEEP(60) 
 FROM my_tbl; 
```

然后转到另一个会话并运行 innotop 并查看锁定屏幕（按“L”键）。你会看到这样的输出：

```
___________________________________ InnoDB Locks ___________________________________
ID  Type    Waiting  Wait   Active  Mode  DB    Table   Index    Ins Intent  Special
61  TABLE         0  00:00   00:00  IS    test  my_tbl                    0         
61  RECORD        0  00:00   00:00  S     test  my_tbl  PRIMARY           0 
```

这就是为什么自动增量机制以它的方式工作的原因。无论事务隔离如何，插入线程都会*短暂*锁定表，只是为了增加 auto-inc 编号。这是非常快的。然后释放锁，允许其他线程立即继续。同时，第一个线程尝试完成其插入。

有关自动增量锁定的更多详细信息，请参阅[http://dev.mysql.com/doc/refman/5.5/en/innodb-auto-increment-handling.html](http://dev.mysql.com/doc/refman/5.5/en/innodb-auto-increment-handling.html)。

我不确定为什么要模拟自动增量行为，而不是将列定义为自动增量列。 [您可以将现有表更改为自动递增。](https://stackoverflow.com/questions/251479/make-an-id-in-a-mysql-table-auto-increment-after-the-fact)

* * *

回复您的评论：

即使 PK 被声明为自动增量，您仍然可以指定一个值。仅当您*未*在 INSERT 中指定 PK 列，或者您指定`NULL`or`DEFAULT`作为其值时，自动增量才会启动。

```
CREATE TABLE foo (id INT AUTO_INCREMENT PRIMARY KEY, c CHAR(1));
INSERT INTO foo (id, c) VALUES (123, 'x'); -- inserts value 123
INSERT INTO foo (id, c) VALUES (DEFAULT, 'y'); -- inserts value 124
INSERT INTO foo (id, c) VALUES (42, 'n'); -- inserts specified value 42
INSERT INTO foo (c) VALUES ('Z'); -- inserts value 125
REPLACE INTO foo (id, c) VALUES (125, 'z'); -- changes existing row with id=125 
```

* * *

回复您的评论：

```
START TRANSACTION; 
SELECT IFNULL(MAX(idx), 0)+1 FROM my_tbl FOR UPDATE; 
INSERT INTO my_tbl (idx, clmn_1) VALUES (new_idx_val, some_val); 
COMMIT; 
```

这实际上比您的第一个想法更糟糕，因为现在`SELECT...FOR UPDATE`创建的是 X 锁而不是 S 锁。

您真的不应该尝试重新发明 AUTO-INCREMENT 的行为，因为任何 SQL 解决方案都受 ACID 属性的限制。Auto-inc 必须在 ACID 之外工作。

如果您需要以原子方式更正现有行，请使用[REPLACE 或 INSERT...ON DUPLICATE KEY UPDATE](https://stackoverflow.com/questions/548541/insert-ignore-vs-insert-on-duplicate-key-update/548570#548570)。

# iphone - 使用 CAAnimation 检测正在动画的 uiview 子视图的触摸

> ID：15178228
> 
> 赞同：3
> 
> 时间：2013-03-02T19:05:23.990
> 
> 标签：iphone, ios, objective-c, cocoa-touch, caanimation

我正在尝试检测对动画视图的 UISubview 的触摸

这是我的检测代码：

```
//simple but not very elegant way of getting correct frame
CGRect keepFrame = self.fishContainer.layer.frame;
self.fishContainer.layer.frame = [[self.fishContainer.layer presentationLayer] frame];

//get touch location, taking presentation layer into account. (See above)
CGPoint p = [sender locationInView:self.fishContainer];
CALayer *layer =[self.fishContainer.layer presentationLayer];

//apply relevant transform
p = CGPointApplyAffineTransform(p,layer.affineTransform);
    EBLog(@"checking point %@",NSStringFromCGPoint(p));
UIView *vToRemove = nil;

//find topmost view containing touched point
for (UIView *v in self.parasites) {
    EBLog(@"-BOUND %@",NSStringFromCGRect(v.frame));

    if(CGRectContainsPoint(v.frame, p))
    {
        vToRemove = v;
    }
}
//OK, we have a view. Let's remove it.
if(vToRemove)
{
    EBLog(@"found one");
    [vToRemove removeFromSuperview];
    [self.parasites removeObject:vToRemove];
    if ([self.parasites count] == 0) {
        [self showWinnerScreen];
        [self stopGame];
    }
}

//restore view frame
self.fishContainer.layer.frame = keepFrame; 
```

只要我不`parasiteArea`为父视图设置动画，一切都会正常工作。

当我`parasiteArea`为父视图设置动画时（`CAAnimation`由视图的移动、视图的缩放和视图的旋转组成），触摸超出了预期子视图的范围。

**更新**

在大多数情况下，我设法通过使用`presentationLayer`属性和 `CGPointApplyAffineTransform`. 但是，在某些情况下它仍然不起作用。

我想我需要将触摸点转换为`CAAnimation`.

或类似的东西？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T08:06:06.240

我最终使用`UIView animateWithDuration`而不是`CAAninmation`. 就我的目的而言，有限的动画可能就足够了。

# ios - 发送 '__autoreleasing .....' 到不兼容类型的参数

> ID：15178240
> 
> 赞同：1
> 
> 时间：2013-03-02T19:06:51.630
> 
> 标签：ios, objective-c, cocoa-touch, automatic-ref-counting

我有一个障碍；

```
typedef void (^SIResponseHandler) (id obj, NSString *error); 
```

和一个方法：

```
+ (void)uploadPhoto:(UIImage *)photo
toPathForComponents:(NSArray *)components
  completionHandler:(SIResponseHandler)responseHandler; 
```

和另一个调用上述方法的方法：

```
+ (void)updateProfilePhoto:(UIImage *)photo handler:(SIResponseHandler *)handler {

    NSArray *components = @[@"users", sharedInstance.username, @"profile", @"photo", @"upload"];
    [SIRequest uploadPhoto:photo
       toPathForComponents:components
           progressHandler:nil
         completionHandler:handler];
} 
```

在最后一行，我得到这个错误：

```
Sending '__autoreleasing SIResponseHandler *' (aka 'void (^__autoreleasing *)(__strong id, NSString *__strong)') to parameter of incompatible type 'SIResponseHandler' (aka 'void (^)(__strong id, NSString *__strong)') 
```

我不知道这是什么意思。有人可以解释发生了什么吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T19:10:20.150

这似乎`SIResponseHandler`是一种块类型，因此不应`*`在参数列表中作为指针后缀，除非您确切知道自己在做什么。

# java - Java在文件输入中插入一个值

> ID：15178243
> 
> 赞同：0
> 
> 时间：2013-03-02T19:07:09.230
> 
> 标签：java, image, file, input, web

我有一些名为“Hoofdfoto.jpg”、“foto2.jpg”、“foto3.jpg”、“foto4.jpg”、“foto5.jpg”的图片

我想自动使用 java 将它们添加到具有此源代码的网站：http: [//pastebin.com/MPatCqk9](http://pastebin.com/MPatCqk9)

如果按 ctrl+F 并输入“Foto 2”，你会看到它是一个文件输入框，知道如何让 java 把它放在那里吗？

# r - 在两个因素的水平上操作

> ID：15178244
> 
> 赞同：1
> 
> 时间：2013-03-02T19:07:12.147
> 
> 标签：r, vectorization

我有一个看起来像这样的数据集，有很多类，每个类都有很多（5-10）个子类，每个子类都有一个与之关联的值：

```
> data.frame(class=rep(letters[1:4], each=4), subclass=c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8), value=1:16)
   class subclass value
1      a        1     1
2      a        1     2
3      a        2     3
4      a        2     4
5      b        3     5
6      b        3     6
7      b        4     7
8      b        4     8
9      c        5     9
10     c        5    10
11     c        6    11
12     c        6    12
13     d        7    13
14     d        7    14
15     d        8    15
16     d        8    16 
```

我想首先对每个类/子类的值求和，然后在所有子类中取每个类的中值。

即，中间步骤将对每个类的每个子类的值求和，看起来像这样（请注意，我不需要保留此中间步骤的数据）：

```
> data.frame(class=rep(letters[1:4], each=2), subclass=1:8, sum=c(3,7,11,15,19,23,27,31))
  class subclass   sum
1     a        1     3
2     a        2     7
3     b        3    11
4     b        4    15
5     c        5    19
6     c        6    23
7     d        7    27
8     d        8    31 
```

第二步将获取所有子类中每个类的中位数，如下所示：

```
> data.frame(class=letters[1:4], median=c(median(c(3,7)), median(c(11,15)), median(c(19,23)), median(c(27,31))))
  class median
1     a      5
2     b     13
3     c     21
4     d     29 
```

这是我需要保留的唯一数据。请注意，$class 和 $subclass 都将是因子变量，并且 value 将始终是一个非缺失的正整数。每个类都有不同数量的子类。

我确信我可以用一些讨厌的 for 循环来做到这一点，但我希望有一种更好的方法，它可以矢量化并且更容易维护。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:35:10.473

这是另一个使用示例`aggregate`

```
temp <- aggregate(df$value,list(class=df$class,subclass=df$subclass),sum)

aggregate(temp$x,list(class=temp$class),median) 
```

输出：

```
 class  x
  1     a    5
  2     b   13
  3     c   21
  4     d   29 
```

或者，如果您喜欢单线解决方案，您可以执行以下操作：

```
aggregate(value ~ class, median, data=aggregate(value ~ ., sum, data=df)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T19:22:10.130

您可以尝试第一步：

```
df_sums <- aggregate(value ~ class + subclass, sum, data=df) 
```

然后：

```
aggregate(value ~ class, median, data=df_sums) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-03T15:48:00.203

这是另外两个选择。

第一次`ave`在`within`语句中使用，我们`data.frame`在添加聚合数据后逐渐减少源。由于这将导致许多重复的行，我们可以安全地使用`unique`作为最后一步来获得您想要的输出。

```
unique(within(mydf, {
  Sum <- ave(value, class, subclass, FUN = sum)
  rm(subclass, value)
  Median <- ave(Sum, class, FUN = median)
  rm(Sum)
}))
#    class Median
# 1      a      5
# 5      b     13
# 9      c     21
# 13     d     29 
```

第二种选择是使用“data.table”包并“复合”您的陈述，如下所示。如果用户未指定`V1`名称，将自动创建的名称。`data.table`

```
library(data.table)
DT <- data.table(mydf)
DT[, sum(value), by = c("class", "subclass")][, median(V1), by = "class"]
#    class V1
# 1:     a  5
# 2:     b 13
# 3:     c 21
# 4:     d 29 
```

# c# - 如何将插入符号移动到文本框内文本的开头？

> ID：15178247
> 
> 赞同：0
> 
> 时间：2013-03-02T19:07:43.410
> 
> 标签：c#, .net

我尝试使用此代码，但它不起作用

```
private void textBox1_Enter(object sender, EventArgs e)
    {

            this.textBox1.Select(0, 0);

    } 
```

我希望每当用户单击文本框时，插入符号的位置将位于文本的开头，而不是在用户单击时的位置？

如何将插入符号移动到文本框内文本的开头？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:21:09.140

使用`MouseClick`事件：

```
private void textBox1_MouseClick(object sender, MouseEventArgs e)
{
    textBox1.Select(0, 0);
} 
```

请注意，如果您通过 Tab 输入 TextBox，这将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:36:39.363

您可以使用 SelectionStart 和 SelectionLenght 属性。例如，选择开始 = 0；选择长度 = 0;

您可以在 Enter 事件中使用这些代码。

# java - Lucene setPositionIncrement 不起作用

> ID：15178249
> 
> 赞同：1
> 
> 时间：2013-03-02T19:07:49.130
> 
> 标签：java, indexing, search-engine, lucene

我有具有“单词”和“词干”特征的文档。一个词可能有多个词干，所以我索引了操纵位置增量的“词干”特征。我这样做如下：

```
FieldType type = new FieldType();
type.setIndexed(true);
type.setStored(true);
type.setOmitNorms(true);
type.setTokenized(true);
type.setStoreTermVectorOffsets(true);
type.setStoreTermVectorPositions(true);
type.setStoreTermVectors(true);

String join_token = tok.nextToken(); // token is like "stem1 stem2 stem3"
TokenStream stream = new WhitespaceTokenizer(Version.LUCENE_41, new StringReader(join_token));
PositionIncrementAttribute attr = stream.addAttribute(PositionIncrementAttribute.class);
attr.setPositionIncrement(0);
stream.addAttribute(OffsetAttribute.class);
stream.addAttribute(CharTermAttribute.class);
feature = new Field(name,
                    join_token,
                    type);
feature.setTokenStream(stream);
doc.add(feature); 
```

您在代码中看到我用固定的 String 值初始化 Field 以便存储它，然后将令牌流传递给它（我在 stackoverflow 的某个地方找到了该解决方案）。我为每个带有词干的 join_token 执行这些确切的步骤。结果，我在 Luke 中查看我的单词的 TermVector，一个单词的多个词干出现在连续的（不同的！），而它们应该共享一个位置。出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:53:54.553

看起来你的问题是你实际上并没有初始化`TokenStream`，所以当你这样做时，`attr.setPositionIncrement(0);`它并没有为流中的每个令牌设置它。如果您想手动执行此操作，则必须遍历流中的每个令牌并`setPositionIncrement(0)`为每个令牌进行迭代。

但是，您可能需要考虑使用[PositionFilter](http://lucene.apache.org/core/4_1_0/analyzers-common/org/apache/lucene/analysis/position/PositionFilter.html)。当流被消耗时，它将为您处理将位置增量设置为 0。

这将如下所示：

```
String join_token = tok.nextToken(); // token is like "stem1 stem2 stem3"
TokenStream stream = new WhitespaceTokenizer(Version.LUCENE_41, new StringReader(join_token));
stream = new PositionFilter(stream, 0); // 0 also happens to be the default 
```

# php - 在 Concrete5 上安装自定义块时出错

> ID：15178251
> 
> 赞同：2
> 
> 时间：2013-03-02T19:07:50.553
> 
> 标签：php, concrete5

我编写了一个非常简单的自定义块，但是当我尝试安装它时，我收到以下错误：

致命错误：在第 22 行的 {REMOVED}/concrete/core/controllers/single_pages/dashboard/blocks/types.php 中调用未定义的方法 stdClass::isInternalBlockType()

我已经写了另一个很好并且安装完美，但是这个很痛苦！问题似乎出在 controller.php 上，因为当我删除它时它工作正常（只是安装时没有元数据，这不好！）

```
<?php 
defined('C5_EXECUTE') or die("Access Denied.");
class QuicklinksBlockController extends BlockController {

    protected $btTable = "btQuicklinks";
    protected $btInterfaceWidth = "600";
    protected $btInterfaceHeight = "400";

    public function getBlockTypeName() {
        return t('Quick Links Section');
    }

    public function getBlockTypeDescription() {
        return t('A quick links section block.');
    }

}
?> 
```

因此，如果我删除除了它安装的类行之外的所有内容，只是没有标题等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-25T21:20:54.323

我也拉了这个错误。就我而言，这是由于未遵循大写规则造成的。块目录中块的名称有“单词”，用下划线分隔，但这些必须是表名中的大写字母。换句话说，如果您在 blocks 目录中的块如下所示：

根/块/my_block

您的块表表名必须是：

btMyBlock

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T19:11:07.543

固定的！我忘记将 db.xml 文件更改为新的表名，因此出现错误。

# javascript - TypeScript 中的 HTML 元素是否有可用的类？

> ID：15178252
> 
> 赞同：0
> 
> 时间：2013-03-02T19:07:54.423
> 
> 标签：javascript, html, typescript

我想写一些只对 Checkbox 元素起作用的 TypeScript 函数。将函数声明为只有 Checkbox 参数会很有趣。否则，我有两个选择，(a) 调用代码选择它认为是 Checkbox 并通过它，或者它传递一个 ID，我必须选择 Checkox 并决定如果规则被破坏并且两个或多个元素具有该 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:02:28.773

`HTMLInputElement`lib.d.ts 中的接口定义了通用`<input>`标签（由 DOM 定义描述）；复选框将具有`type`“复选框”

# linux-kernel - 用户空间进程上的Linux内核模块信号被杀死

> ID：15178257
> 
> 赞同：5
> 
> 时间：2013-03-02T19:08:29.103
> 
> 标签：linux-kernel, hook, kill-process

我想知道当用户空间应用程序/进程被杀死时是否有一个可以在 Linux 内核模块中使用的钩子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-15T07:50:53.393

您可以首先在内核模块中注册通知程序链。

在内部`get_signal_to_deliver`（**kernel/signal.c**），任何*刚刚*（这是相对术语恕我直言）被杀死的进程都会设置其**PF_SIGNALED**标志。在这里，您可以使用其 tcomm 字段检查*当前进程的名称，如下所示：*

```
char tcomm[sizeof(current->comm)];
get_task_comm(tcomm, current); 
```

如果确实是有问题的过程，您可以触发通知链，这将唤醒您一直在该链上等待的模块。

# android - 平板电脑上类似 Google Now 的不对称网格

> ID：15178260
> 
> 赞同：1
> 
> 时间：2013-03-02T19:08:50.337
> 
> 标签：android, gridview, height, asymmetric, google-now

有谁知道如何实现高度不均匀的网格视图？

![在此处输入图像描述](../Images/76d46f7dd182b3bb28a24b9efe2733a5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T20:11:32.417

它可能是一个`StaggeredGridView`. [请参阅此问题](https://stackoverflow.com/questions/13436359/android-column-gridview-variable-width-like-googleplus-app)的答案。

[你可以在github.com/maurycyw/StaggeredGridView](https://github.com/maurycyw/StaggeredGridView)找到一个实现

# python - 导入优先级一致性？

> ID：15178264
> 
> 赞同：1
> 
> 时间：2013-03-02T19:09:15.220
> 
> 标签：python

我对导入模块时的优先级以及如何更改它感到困惑。

当前目录确实包含：

```
l10n/__init__.py
l10n/moneyfmt.py 
```

另一个带有额外包的目录（与当前目录不同）确实包含：

```
/opt/l10n/__init__.py
/opt/l10n/utils.py 
```

现在运行 python 交互式解释器：

```
>>> import sys
>>> sys.path
['', '/usr/lib/python27.zip', '/usr/lib/python2.7',
'/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk',
'/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload',
'/usr/lib/python2.7/site-packages', '/usr/lib/python2.7/site-packages/PIL',
'/usr/lib/python2.7/site-packages/gtk-2.0',
'/usr/lib/python2.7/site-packages/setuptools-0.6c11.egg-info']
>>> import l10n.utils
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named utils    # CORRECT, NOT IN PATH YET
>>> sys.path.insert(0, '/opt')
>>> sys.path
['/opt', '', '/usr/lib/python27.zip', '/usr/lib/python2.7',
 '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk',
 '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload',
 '/usr/lib/python2.7/site-packages',
 '/usr/lib/python2.7/site-packages/PIL',
 '/usr/lib/python2.7/site-packages/gtk-2.0',
'/usr/lib/python2.7/site-packages/setuptools-0.6c11.egg-info']
>>> import l10n.utils
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named utils    # WHY IT CAN NOT FIND THE MODULE? 
```

为什么在我将完整路径添加到 sys.path 中的搜索路径之后，它找不到带有 l10n.utils 模块的包？当前目录是否*总是*优先？可以改变吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:17:48.780

您有两个名为`l10n`. 第一次尝试时`import l10n.utils`，错误`l10n`就在路径上。我怀疑这个错误`l10n`会被 Python shell 缓存，并且在您`import l10n.utils`第二次尝试时会被咨询（无论您对 所做的更改如何`sys.path`）。

尝试重新启动 Python shell，首先进行更改`sys.path`，然后`import l10n.utils`立即执行。

# c# - Asana API C# 项目设计

> ID：15178267
> 
> 赞同：0
> 
> 时间：2013-03-02T19:09:30.240
> 
> 标签：c#, api

我正在用 C# 为[Asana](http://developer.asana.com/documentation/)设计一个 API 包装器，这是一个项目管理解决方案。在设计过程中，我遇到了一些障碍。我想知道设计 API 包装器的好方法是什么。

我正在集成的 Asana API 与 REST 配合使用。请求返回 JSON。

将有 6 个数据类（用户、任务、项目等），每个类都包含一堆字符串来保存从 REST 请求返回的数据。我对这些类的第一个想法是给它们每个工厂 Parse() 构造函数，这样我就可以轻松地传入 json 并获得一个数据对象作为回报。我意识到我无法将静态工厂方法提取到接口中。

我将有一个 REST 请求类来管理从 REST 服务器发送和接收数据。它总是会返回一个 JSON 字符串。

最后，我想要一个 AsanaAPI 类，它包含包装那些暴露在 REST 服务器上的方法（即 GetUser、GetAllUsers、GetTask）。每个方法要么返回一个特定的数据类，要么返回一个数据类数组。以下是两种情况：

```
 public User GetSingleUser(string userID = "me")
    {
        if(userID == "") throw new ArgumentException("UserID cannot be blank");

        string url = string.Format("{0}/{1}{2}", userUrl, userID, "?opt_fields=id,name,email,workspaces,workspaces.id,workspaces.name");
        JSONNode root = JSON.Parse(GetResponse(url))["data"];
        return User.Parse(root);
    }

    public List<User> GetAllUsers()
    {
        List<User> users = new List<User>();

        string url = string.Format("{0}{1}", userUrl, "?opt_fields=id,name,email,workspaces,workspaces.id,workspaces.name");
        JSONArray root = JSON.Parse(GetResponse(url))["data"].AsArray;
        foreach(JSONNode userRoot in root)
        {
            users.Add(User.Parse(userRoot));
        }

        return users;
    } 
```

每个方法都将具有相同的格式，但 User 类型将替换为 Project、Task 等。我想提取这两个方法中的逻辑，因为会有更多具有几乎完全相同格式的方法。

总之，我遇到的障碍是

1.  我无法从数据类中提取工厂构造方法。
2.  我无法从请求方法中提取解析逻辑

有什么我可以用泛型做的，还是有更好的方法来设计这个项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T01:20:13.460

所以我创建了一个 Parsable 接口，它只包含一个 Parse 方法。每种数据类型都实现 Parsable。我能够使用泛型类型提取解析逻辑。这不是最漂亮的解决方案，但它确实有效。

```
 public User GetSingleUser(string userID = "me")
    {
        if(userID == "") throw new ArgumentException("UserID cannot be blank");

        string url = "{baseUrl}/users/{userID}?{opt_fields}".FormatWith(
            new { baseUrl = BASE_URL, userID = userID, opt_fields = "opt_fields=id,name,email,workspaces,workspaces.id,workspaces.name" });

        return (User)ParseJson<User>(AsanaRequest.GetResponse(url));
    }

    public User[] GetAllUsers()
    {
        string url = "{baseUrl}/users?{opt_fields}".FormatWith(
            new { baseUrl = BASE_URL, opt_fields = "opt_fields=id,name,email,workspaces,workspaces.id,workspaces.name" });

        return (User[])ParseJsonArray<User>(AsanaRequest.GetResponse(url));
    }

    public T ParseJson<T>(string json) where T : Parsable, new()
    {
        JSONNode root = JSON.Parse(json)["data"];
        T ret = new T();
        ret.Parse(root);
        return ret;
    }

    public T[] ParseJsonArray<T>(string json) where T : Parsable, new()
    {
        JSONArray root = JSON.Parse(json)["data"].AsArray;
        T[] nodes = new T[root.Count];
        for(int i = 0; i < root.Count; i++)
        {
            T newParsable = new T();
            newParsable.Parse(root[i]);
            nodes[i] = newParsable;
        }

        return nodes;
    } 
```

# php - 摆脱 WHERE 子句中的函数

> ID：15178270
> 
> 赞同：1
> 
> 时间：2013-03-02T19:09:37.670
> 
> 标签：php, mysql, sql

我有一个名为的表`users`，其中包含列`firstname`和`lastname`.

我正在努力研究如何构造 WHERE 子句以返回匹配的名字、姓氏、名字加上空格和姓氏以及姓氏加上逗号和名字的结果。例如，“John”、“Doe”、“John Doe”和“Doe, John”。它也应该适用于部分补丁（即“John D”）。我正在考虑类似以下的内容（用搜索短语替换 ? ）。

```
SELECT * FROM people WHERE
firstname LIKE ?
OR CONCAT_WS(" ",firstname,lastname) LIKE ?
OR lastname LIKE ?
OR CONCAT_WS(", ",lastname,firstname) LIKE ? 
```

这种方法有一个小缺陷，因为搜索“John Doe”也会返回“John Enders”、“John Flaggens”和“John Goodmen”，所以我需要添加一些条件来在第一个和当两者都给出时，姓氏匹配。

这种方法还有一个很大的缺陷，因为我的 WHERE 子句中有一些函数可以防止使用索引并导致性能显着降低。

我可以只使用 SQL 有效地做到这一点，而无需在 WHERE 子句中使用函数，还是应该使用服务器代码（即 PHP）来解析给定的搜索短语中的空格和逗号并根据结果创建动态 SQL 查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:38:11.930

您问是否可以在 MySQL 中**有效地**执行此操作，考虑到您的架构设计而不使用[FULLTEXT](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)搜索，简单的答案是否定的，您无法有效地执行此操作。

[您可以使用LIKE/STRCMP](http://dev.mysql.com/doc/refman/5.0/en/string-comparison-functions.html)和/或[字符串函数](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)创建一些古怪的查询。如果您采用这种方法，最好编写一些应用程序逻辑来创建内联查询，而不是尝试编写一个可以处理所有事情的查询。无论哪种方式，它都不太可能真正有效

MySQL 5.6 能够在 INNODB中执行[FULLTEXT搜索。](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)如果您使用的是较低版本，则只能使用 MyISAM 表执行此操作——MyISAM 可能不是一个好主意的原因有很多。

另一种方法是查看真正的搜索解决方案，例如[Lucene](http://www.google.co.uk/url?sa=t&rct=j&q=lucene&source=web&cd=1&cad=rja&sqi=2&ved=0CC8QFjAA&url=http://lucene.apache.org/core/&ei=j1UyUY7TNrCo0AXh2YH4Bg&usg=AFQjCNFUWH4QNE3qjb53P9oILG1p3LwpdQ&bvm=bv.43148975,d.d2k)、[Sphinx](http://www.google.co.uk/url?sa=t&rct=j&q=sphinx%20&source=web&cd=3&cad=rja&ved=0CEAQFjAC&url=http://sphinxsearch.com/&ei=n1UyUeyWL6uR0QX8woDgDw&usg=AFQjCNGQGvt8zHAS8QC4ogh8IS4850XgJA&bvm=bv.43148975,d.d2k)或[Xapian](http://www.google.co.uk/url?sa=t&rct=j&q=xapian%20search&source=web&cd=1&cad=rja&ved=0CDAQFjAA&url=http://xapian.org/&ei=s1UyUa7bCIrN0QWjhYCgDQ&usg=AFQjCNGM5Sa2hXktsiZR_x-rXyQ8kbZytA&bvm=bv.43148975,d.d2k)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:06:19.267

您是否尝试过正则表达式[http://dev.mysql.com/doc/refman/5.1/en/regexp.html](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)

# javascript - javascript表单检查和加密密码

> ID：15178271
> 
> 赞同：3
> 
> 时间：2013-03-02T19:09:39.277
> 
> 标签：javascript

我有一个简单的表单，用户可以在其中更改密码，并且我正在使用一个`onsubmit`事件来检查通常可以正常工作的表单，除非我尝试使用已经在使用的密码来阻止他们。

密码存储在数据库中并被加密。我需要做的是将加密密码与尚未加密的新密码进行比较。我使用的加密是：

```
<%
Function encrypt(x1, x2)
    s = ""
    t = 0
    For i = 1 to len(x1)
        t = t + asc(mid(x1,i,1))
    Next
    For i = 1 to len(x2)
        y = (t + asc(mid(x2,i,1)) * asc(mid(x2,((i+1) mod len(x2)+1),1))) mod 255
        s = s & chr(y)
    Next
    For i = (len(x2) + 1) to 10
        If t>598.8 Then t = 598.8
        y = t^3*i mod 255
        s = s & chr(y)
    Next
    encrypt = s
End Function
%> 
```

我运行`encrypt(Username,Password)`它给了我一个像`¬{±ÝÆÝl`

`onsubmit`我正在使用的代码是

```
function checkData (){
    if (document.signup.password1.value != document.signup.password2.value) {
        alert("Your passwords do not match.")
        document.signup.password1.focus()
        return false
    }
    if (document.signup.password1.value == "") {
        alert("Please enter a password.")
        document.signup.password1.focus()
        return false
    }
} 
```

这一切都很好，我只是坚持最后一点，即旧密码检查。我尝试过各种各样的事情，比如

```
if (encrypt(document.signup.password1.value,emailaddress) == "value from database"){ 
    alert("The password chosen is already in use.")
    document.signup.password1.focus()
    return false
} 
```

我的主要问题是：我可以将 ASP 函数加密调用到我的 javascript 中`checkData`吗？当我开始认为这就是问题所在时，我想知道我是否在浪费时间并觉得没有办法做到这一点。我知道我可以将表格提交到下一页并在那里进行检查，但如果可以的话，我真的很想这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:19:28.040

您不能直接从 JavaScript 调用 ASP（或任何其他服务器端语言的）函数。话虽如此，有一种广泛使用的技术称为 AJAX，它允许您对服务器端应用程序执行*异步*JavaScript 请求。它们被称为异步，因为您不提交/重新加载整个页面，而是执行一段 JavaScript 调用服务器端功能并返回结果，从而让您无需重新加载即可更新页面。

在您的情况下，您希望实现一个 AJAX 请求，询问您是否已在使用用户输入的某个密码，并且服务器将简单地返回一个布尔值，您将在 JavaScript 端对其进行评估并更新您的相应的页面。

我很确定有大量关于如何在 ASP 中使用 AJAX 请求的教程和解释（我不熟悉），提供这样的解释肯定超出了这里可以提供的范围。请咨询谷歌 :)

# opengl - OpenGL颜色深度缓冲区

> ID：15178280
> 
> 赞同：0
> 
> 时间：2013-03-02T19:10:32.630
> 
> 标签：opengl

我有一个简单的研究项目，代表一些太空恒星的系统。我有一颗恒星和几颗行星，卫星围绕恒星旋转。我正在使用深度缓冲区，但行星总是在恒星前面，即使行星应该被恒星遮挡。问题原因可能是什么？

```
void drawPlanet(float orbitRadius, float planetRadius, float daysInYear, float hoursInDay){
    static float year = 0;
    static float days = 0;
    static float hours = 0;
    glPushMatrix();
    glRotatef(year, 0, 1, 0);
    glTranslatef(orbitRadius, 0 ,0);
    glRotatef(days, 1, 2, 0);
    glutWireSphere(planetRadius, 20, 16);
    drawLuna(0.3, 0.1, 30, 15);
    glPopMatrix();
    hours++;
    days = hours/hoursInDay;
    year=days/daysInYear;
}

void display(void){
    glClear(GL_COLOR_BUFFER_BIT);
    glLoadIdentity();
    gluLookAt(0,0,5, 0, 0, 0, 0 ,1, 0);

    glColor3f(1.0, 0.647059, 0.00);
    glutSolidSphere(0.5, 20, 16);

    glColor3b(197, 96, 63);
    drawPlanet(2, 0.2, 50, 12);
    drawPlanet(1, 0.15, 30, 15);

    glFlush();
}

int main(int argc, char** argv)
{
    ....
    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB | GLUT_DEPTH);
    glEnable(GL_DEPTH_TEST);
    ....

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:35:31.493

`glEnable(GL_DEPTH_TEST)`如果没有 OpenGL 上下文，您的调用无效。GLUT 仅在`glutCreateWindow`被调用后才创建 OpenGL 上下文。

作为一般规则，您不应`glEnable`在显示功能之外调用。您还必须清除深度缓冲区，因此请执行此操作

```
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); 
```

# android - 为什么我的 ViewGroup 剪辑在 Nexus 7 上不起作用？

> ID：15178282
> 
> 赞同：3
> 
> 时间：2013-03-02T19:10:38.060
> 
> 标签：android, android-layout, android-animation

我想我不清楚脏区的 Android 失效是如何工作的。我有一个自定义组件，用于表示一张扇形的卡片。卡片是旋转视图。可以通过向上或向下滑动来“丢弃”视图。

当视图未旋转时，清理（在滑动动作期间和之后）效果很好，但是当它们旋转时，它们似乎无法正确清理。（参见截图，最后 4 张卡片已上下滑动，但并未完全丢弃……这仅发生在我的 Nexus 7 上，而不是 Droid DNA 上。） ![连结截图](../Images/6eae1d262c648d04c25c20571569de11.png)

必须做些什么来确保这些区域得到妥善清理？感谢您考虑这个问题。

# php - 为 Apache MAMP 创建虚拟主机

> ID：15178283
> 
> 赞同：0
> 
> 时间：2013-03-02T19:10:40.413
> 
> 标签：php, apache, mamp, virtualhost

我正在尝试在我的 MAMP 设置上创建一个虚拟主机，以便我可以访问[http://api.localhost](http://api.localhost)以获取我正在尝试使用 Slim 构建的 PHP API。这是我附加到`httpd.conf`文件中的代码：

```
Name VirtualHost 127.0.0.1
<VirtualHost 127.0.0.1>
    DocumentRoot "/Applications/MAMP/htdocs/slim"
    ServerName api.localhost
</VirtualHost> 
```

当我重新启动服务器并尝试使用此新配置再次启动它时，它根本不会加载。我注释掉了新代码，它加载得很好。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T13:05:01.870

尝试使用这条线

```
<VirtualHost *:80> 
```

而不是你的

而且我认为您也可以删除第一行...

# image - 在matlab中将base64解码为RGB图像

> ID：15178284
> 
> 赞同：1
> 
> 时间：2013-03-02T19:10:40.850
> 
> 标签：image, matlab, encoding, base64, decode

我在 Matlab 环境中为一个项目工作，我必须解码从数据库服务器以 xml 接收的 RGB 图像，该图像以 base64 格式编码。我成功地将图像转换为base64并通过将其转换为xml将其发布到数据库。我使用[base64encode/decode](http://home.online.no/~pjacklam/matlab/software/util/datautil/)将图像编码为 base64，并附上了下面的程序。问题是当我使用 base64decode 函数并尝试从 base64 重新转换图像时。它根本行不通。

这是我将图像转换为 base64 并将其编码为 xml 的程序。

```
function image2xml(test_directory)
% Images in directory ---> byte array format in XML
% This function encodes all the images available in the test directory into
% byte array/base 64 format and saves them in xml with the following
% properties
%     Packs the image(byte array) and its name as timestamp to xml
% Uses functions from the following source
% http://www.mathworks.de/matlabcentral/fileexchange/12907-xmliotools
% Following functions from the above source are to be added to path,while
% running this function
%     xml_write.m
%     xml_read.m
%% ========================================================================

files=dir(test_directory)
% delete('test_image_xml\*.xml');
% If not database_mat is included in the function arguments

    for i = 1:size(files,1)
        k=0;
        if files(i).isdir()==0
            %extracts name with which it savesa as xml
            [~, name_to_save,~ ] = fileparts(files(i).name)
            filename = fullfile([test_directory,'\',files(i).name])
            fid = fopen(filename);
            raw_data = uint8(fread(fid));% read image file as a raw binary
            fclose(fid);
            %Definition of xml tags
            image_imagedetails = [];
            % name of the file is assumed to be the timestamp
            image_imagedetails.timestamp =name_to_save;
            %imagescan.imagebyte64.ATTRIBUTE.EncodingMIMEType = 'base64';
            image_imagedetails.imagebase64 = base64encode(raw_data);% perform base64 encoding of the binary data
            %saves all the xml files into the predefined directory
            mkdir('images_and_timestamp_xml');
            filename = ['images_and_timestamp_xml\' name_to_save,'.xml' ];
            post_data = xml_write(filename, image_imagedetails);

        end
    end 
```

最后，我使用以下内容将使用 base64 格式的图像创建的 xml 重新转换回图像，但不幸的是它不起作用，并抛出一些奇怪的字符，我无法将其转换回图像。我也不知道如何将字符串转换回图像。

```
filename = '...\IMAG0386.xml';
tree = xml_read(filename);
image = tree.imagebase64;
K = base64decode(tree.imagebase64)) %test image retrieval --> only the string 
```

我尝试了其他选项，例如在 matlab 中使用[Java 代码](https://github.com/benbai123/JSP_Servlet_Practice/blob/master/Practice/JAVA/Commons/src/test/ImageUtils.java)，但我不知道如何在 matlab 中使用代码。C#、Java 中有很多选项，但我不知道如何在 matlab 中使用它们。请在这方面帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T16:01:09.790

我在 Matlab R2012a 下运行了您的代码，它似乎按预期工作。

也许这里缺少的是从base64编码的二进制数据中获取图像文件的几行代码。您只需将二进制数据写入文件即可取回图像文件。

我只是引用了[`xmliotools`](http://www.mathworks.de/matlabcentral/fileexchange/12907-xmliotools)您在代码中使用的 Matlab FileExchange 提交的 HTML 帮助文件：

> 读取嵌入二进制数据的 XML 文件，编码为 Base64（使用 java 版本）

```
tree = xml_read('test.xml', Pref);         % read xml file
raw  = base64decode(tree.MyImage.CONTENT, '', 'java');   % convert xml image to raw binary
fid = fopen('MyFootball.jpg', 'wb');
fwrite(fid, raw, 'uint8');                 % dumb the raw binary to the hard disk
fclose(fid);
I = imread('MyFootball.jpg');              % read it as an image
imshow(I); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-24T09:08:32.983

### 简单的 Base64 处理

使用[Apache 库](https://commons.apache.org/proper/commons-codec/apidocs/org/apache/commons/codec/binary/Base64.html)

```
base64 = org.apache.commons.codec.binary.Base64 
```

然后你可以调用encode或decode。

```
base64.encode()
base64.decode() 
```

它需要 byte[]，所以你可以通过几种方式得到它。让我们对字符串进行编码，然后对其进行解码。

```
hello = 'Hello, world!';
encoded = char(base64.encode(unicode2native(hello))).';
result = native2unicode(base64.decode(uint8(output)).'); 
```

# cuda - cudaMemcpyDeviceToHost 中的错误结果

> ID：15178285
> 
> 赞同：1
> 
> 时间：2013-03-02T19:10:42.100
> 
> 标签：cuda

我的第一个 CUDA 程序有问题。在其中我尝试添加两个数组，但是当我打印结果时完全错误。

这是我的代码：

```
#include <stdio.h>

const int N=10;

__global__ void add(int *a, int *b, int *c) {
    int tid = threadIdx.x;
    c[tid] = a[tid] + b[tid];
}

int main(){

int a[N], b[N], c[N];
    int *dev_a, *dev_b, *dev_c;

    cudaMalloc( (void**)&dev_a, N * sizeof(int) );
    cudaMalloc( (void**)&dev_b, N * sizeof(int) );
    cudaMalloc( (void**)&dev_c, N * sizeof(int) );

    for (int i=0; i<N; i++) {
        a[i] = -i; b[i] = i * i;
    }
    cudaMemcpy ( dev_a, a, N * sizeof(int), cudaMemcpyHostToDevice );
    cudaMemcpy ( dev_b, b, N * sizeof(int), cudaMemcpyHostToDevice );

    add<<<1,N>>>(dev_a, dev_b, dev_c);

    cudaMemcpy(c, dev_c, N * sizeof(int),cudaMemcpyDeviceToHost );

    for (int i=0; i<N; i++) {
        printf("%d + %d = %d\n", a[i],b[i],c[i]);
    }

    cudaFree (dev_a); cudaFree (dev_b); cudaFree (dev_c);

    return 0;

} 
```

正如您将看到的，我尝试在 C 中添加 A 和 B，但是，我不知道为什么，它不起作用。

这是输出：

```
0 + 0 = 0
-1 + 1 = 0
-2 + 4 = 1139031032
-3 + 9 = 32737
-4 + 16 = 0
-5 + 25 = 0
-6 + 36 = 1203890432
-7 + 49 = 32767
-8 + 64 = 6299112
-9 + 81 = 0 
```

最后，我为我的英语道歉……在学习了 cuda 之后，我接下来要做的就是改进它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:26:28.800

你的机器有问题。请进行[错误检查](https://stackoverflow.com/questions/14038589/what-is-the-canonical-way-to-check-for-errors-using-the-cuda-runtime-api)，您将了解它是什么。

当我编译并运行您的确切代码时，我得到以下信息：

```
$ ./t81
0 + 0 = 0
-1 + 1 = 0
-2 + 4 = 2
-3 + 9 = 6
-4 + 16 = 12
-5 + 25 = 20
-6 + 36 = 30
-7 + 49 = 42
-8 + 64 = 56
-9 + 81 = 72
$ 
```

这是您使用错误检查修改的代码。如果你编译并运行它，我相信你会发现你的机器有问题：

```
#include <stdio.h>

#define cudaCheckErrors(msg) \
    do { \
        cudaError_t __err = cudaGetLastError(); \
        if (__err != cudaSuccess) { \
            fprintf(stderr, "Fatal error: %s (%s at %s:%d)\n", \
                msg, cudaGetErrorString(__err), \
                __FILE__, __LINE__); \
            fprintf(stderr, "*** FAILED - ABORTING\n"); \
            exit(1); \
        } \
    } while (0)

const int N=10;

__global__ void add(int *a, int *b, int *c) {
    int tid = threadIdx.x;
    c[tid] = a[tid] + b[tid];
}

int main(){

int a[N], b[N], c[N];
    int *dev_a, *dev_b, *dev_c;

    cudaMalloc( (void**)&dev_a, N * sizeof(int) );
    cudaMalloc( (void**)&dev_b, N * sizeof(int) );
    cudaMalloc( (void**)&dev_c, N * sizeof(int) );
    cudaCheckErrors("cudamalloc fail");

    for (int i=0; i<N; i++) {
        a[i] = -i; b[i] = i * i;
    }
    cudaMemcpy ( dev_a, a, N * sizeof(int), cudaMemcpyHostToDevice );
    cudaMemcpy ( dev_b, b, N * sizeof(int), cudaMemcpyHostToDevice );
    cudaCheckErrors("cuda memcpy fail");

    add<<<1,N>>>(dev_a, dev_b, dev_c);

    cudaMemcpy(c, dev_c, N * sizeof(int),cudaMemcpyDeviceToHost );
    cudaCheckErrors("cudamemcpy or cuda kernel fail");
    for (int i=0; i<N; i++) {
        printf("%d + %d = %d\n", a[i],b[i],c[i]);
    }

    cudaFree (dev_a); cudaFree (dev_b); cudaFree (dev_c);

    return 0;

} 
```

[这张海报](https://stackoverflow.com/questions/15177019/cuda-program-does-not-give-the-correct-output-when-using-a-cuda-compatible-gpu)做了同样的事情，发现他们的机器有问题。

# c# - 在c#中休眠/暂停一个函数

> ID：15178287
> 
> 赞同：1
> 
> 时间：2013-03-02T19:10:51.663
> 
> 标签：c#, windows-phone-7, windows-phone-8

我正在为 wp 7.x/8 制作一个应用程序。

有一个功能 -

```
public void draw()
{
    .............
    ImageBrush imgbrush = new ImageBrush();
    imgbrush.ImageSource = new BitmapImage(...);

    rect.Fill = imgbrush;  //rect is of type Rectangle that has been created 
                           //and added to the canvas
    ........
} 
```

和另一个功能

```
private void clicked(object sender, RoutedEventArgs e)
{
    draw();
    ........
    if (flag)
    {
          Thread.sleep(5000);
          draw();
    }
} 
```

但是当按钮被点击时，两个绘制操作的结果同时出现在屏幕上。

如何使第二次 draw() 操作的结果在延迟后出现？

或者是否有类似屏幕缓冲区的东西，直到缓冲区没有填满屏幕才会刷新？

在这种情况下，如何显式刷新或刷新屏幕或强制 Rectangle 的 .fill() 方法在屏幕上进行更改？

在这方面的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T14:01:40.130

正如 pantaloons 所说，由于您的所有操作都在同一个线程上（第一次绘制、睡眠和第二次绘制），因此 UI 本身永远没有机会更新。但是，有一个更好的实现（尽管它遵循与上述建议相同的原则）。

通过使用计时器，您可以让它等待另一个线程，允许 UI 在执行第二次绘制之前从第一次绘制更新​​，如下所示：

```
private void clicked(object sender, RoutedEventArgs e)
{
    draw();
    ........
    if (flag)
    {
        var timer = new DispatcherTimer { Interval = TimeSpan.FromSeconds(5) };

        timer.Tick += (sender, args) => { timer.Stop(); draw(); };

        timer.Start();
    }
} 
```

在此解决方案中，所有调用都由 DispatcherTimer 处理（它将自动回调 UI 线程）。此外，如果 draw 需要连续调用两次以上，计时器将继续计时直到停止，因此扩展以包含计数将非常简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T23:39:41.403

问题是您通过休眠阻塞了 UI 线程，因此在该函数返回之前永远不会抽取绘制消息，其中更改同步发生。一个 hacky 解决方案将类似于以下内容，但实际上您应该更改您的应用程序设计以使用 async/await 模式。

```
private void clicked(object sender, RoutedEventArgs e)
{
    draw();
    if (flag)
    {
        System.Threading.Tasks.Task.Run(() =>
        {
            System.Threading.Thread.Sleep(5000);
            Deployment.Current.Dispatcher.BeginInvoke(() =>
            {
                draw();
            });
        });
    }
} 
```

# ios - Air for iOS“设备错误：请检查设备上是否有足够的空间。”

> ID：15178289
> 
> 赞同：0
> 
> 时间：2013-03-02T19:10:59.383
> 
> 标签：ios, actionscript-3, air, ipa

所以我遇到了这个错误。一天一切正常，另一天我无法将 ipa 从 Flash Pro CS6 上传到我的 iPad。显然我已经检查了设备中有足够的空间。

iPhone 实用程序资源管理器报告错误“已添加、修改或删除已签名的资源”。尝试安装 ipa 文件时。iTunes 也不会安装该应用程序。

应用名称中没有奇怪的字符。

我已经从 Apple 的门户网站重新下载了配置文件，并检查了应用程序标识符、应用程序名称等是否存在问题。当出现问题时，Flash 会给出同样的错误消息。

我已经更改了版本号。

我从终端检查了 ipa 文件，但没有说任何有用的信息。

```
codesign -vv /path/to/file.ipa 
```

我已经重新启动了我的 ipad 并安装了最新的软件更新。

较旧的 ipa 文件可以从 iPhone 实用程序正常上传。

我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:20:09.550

这里同样的错误。我认为不正确的 App ID 会导致这种情况。通过重新选择配置文件来修复它。它将正确设置 App ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:10:59.383

问题是我在 ipa 中打包了一个文件，其中包含一个名为“Ñ.png”的无效字符。

这很奇怪，因为 Unix 支持文件和文件夹名称中的拉丁字符......无论如何重命名该文件会使一切恢复正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T16:04:18.677

我已经看到这个错误几次了，我总是需要一段时间，抱怨多个配置文件和证书，然后我才想起

它实际上来自用于生成 ipa 文件的 xml。

通常，当您有不同的 xml 用于开发和分发时（如果您在我的情况下使用 Push）

# sql - SQL 十进制类型 - 精度和比例差异

> ID：15178297
> 
> 赞同：0
> 
> 时间：2013-03-02T19:11:41.000
> 
> 标签：sql, sql-server

为了在这里回答另一个问题，我创建了以下数据结构和行：

```
create table [resource] (Name varchar(16),date datetime, project varchar(16),hours int)
INSERT INTO resource
values ('Andy Sandy', '2013-03-02', 'Enhancements',40)
INSERT INTO resource
values('Fred Jones', '2013-10-02', 'Enhancements',40) 
```

我已经执行了以下查询：

```
select 
case when sum(hours) > 0 Then
    CAST(SUM(hours) as DECIMAL(5,2))/40
else 0 end as [hours],
[DATE]
from resource group by date 
```

结果如下所示：

```
Hours           Date
1.000000    2013-03-02 00:00:00.000
1.750000    2013-10-02 00:00:00.000 
```

当我将小时数转换为小数时，我指定了 5 的精度和 2 的比例。我不明白为什么这个数字是这样的。如果我没有指定精度和比例，那么结果是一样的。为什么是这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:32:07.917

你在做`numeric(5,2)`/ 40。

从[精度、比例和长度](http://msdn.microsoft.com/en-us/library/ms190476%28v=SQL.90%29.aspx)

```
+-----------+------------------------------------+---------------------+
| Operation |          Result precision          |   Result scale *    |
+-----------+------------------------------------+---------------------+
| e1 / e2   | p1 - s1 + s2 + max(6, s1 + p2 + 1) | max(6, s1 + p2 + 1) |
+-----------+------------------------------------+---------------------+ 
```

将 40 视为`numeric(2,0)`保留精度和比例的最小可能十进制表示。

所以

```
p1=5
s1=2,
p2=2
s2=0 
```

然后将其插入 BOL 的公式中

```
Precision: 5 - 2 + 0 + max(6, 2 + 2 + 1) = 9
Scale: max(6, 2 + 2 + 1)                 = 6 
```

所以结果是`numeric(9,6)`。

您也可以从

```
;WITH cte(thing) AS
(
 SELECT CAST(1 as DECIMAL(5,2))/40
)
SELECT thing, 
       sql_variant_property(thing,'basetype') AS basetype,
       sql_variant_property(thing,'precision') AS precision, 
       sql_variant_property(thing,'scale') AS scale, 
       sql_variant_property(thing,'maxlength') AS maxlength
FROM cte 
```

退货

```
+----------+----------+-----------+-------+-----------+
|  thing   | basetype | precision | scale | maxlength |
+----------+----------+-----------+-------+-----------+
| 0.025000 | decimal  |         9 |     6 |         5 |
+----------+----------+-----------+-------+-----------+ 
```

（注：`decimal`和`numeric`是同义词）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T19:27:06.680

多么奇怪。如果您运行[sp_describe_first_result_set](http://msdn.microsoft.com/en-us/library/ff878602.aspx)

```
sp_describe_first_result_set N'
select 
case when sum(hours) > 0 Then
    CAST(SUM(hours) as DECIMAL(5,2))/40
else 0 end as [hours],
[DATE]
from resource group by date' 
```

您会看到要返回的小时数列被转换为十进制 (9,6)。

如果您将原始转换更改为 DECIMAL(10,6)，它将重新转换为 (14,10)。所以你认为它只是增加了 4 个级别的小数精度。不完全的！

将您的分频器从 40.0 更改为 400.0 - 现在它转换为 (15,11) - 它还根据分频器的精度增加了额外的精度级别。

将其更改为 40.0000（3 个额外的零） - 现在是 (20,15)。因此，有一个函数可以根据原始值和除数来确定精度。

小数点右边的每一个额外的精度级别都会为您的原始演员添加 (2,1)。左边的每个精度级别都会为您的原始演员添加 (1,1)。

要将小时列返回为小数（5,2），您只需要做

```
select 
case when sum(hours) > 0 Then
    CAST(SUM(hours) /40.0 as decimal(5,2))
else 0 end as [hours],
[DATE]
from resource group by date 
```

# c - 使用 %i 将八进制转换为十进制

> ID：15178298
> 
> 赞同：-3
> 
> 时间：2013-03-02T19:11:56.757
> 
> 标签：c

```
int main() { int i; scanf("%i",&i); printf("%d",i); } 
```

如果我取`i/p`为 -077 ，我按预期得到 -63，但如果`i/p`是 -078`o/p`则为 -7。

你能解释一下我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:13:09.050

> 但如果 i/p 为 -078，则 o/p 为 -7。你能解释一下吗？？？

转换在使用的基数中第一个不是有效数字的字符处停止。由于数字以 a 开头`'0'`，而不是直接跟在`'x'`or之后`'X'`，因此选择的基数是 8。`'8'`不是八进制数字。因此转换只消耗`"07"`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:13:52.440

那是因为 8 不是八进制表示法中的有效数字。使用 0-7。

# json - 如何在 CakePHP 中测试 JSON 数据视图的输出？

> ID：15178306
> 
> 赞同：0
> 
> 时间：2013-03-02T19:12:43.010
> 
> 标签：json, debugging, cakephp, dataview, requesthandler

所以我正在尝试创建一个 Android 移动应用程序，并且我使用 CakePHP 作为我的服务器端。我不需要任何 HTML 视图，我只会使用 JSON 对象进行响应。

我查看了[http://book.cakephp.org/2.0/en/core-libraries/components/request-handling.html#RequestHandlerComponent](http://book.cakephp.org/2.0/en/core-libraries/components/request-handling.html#RequestHandlerComponent)并创建了这个：

```
class LocationsController extends AppController
{
    public $helpers = array('Html', 'Form');
    public $components = array('RequestHandler');
    function index()
    {
        $locations = $this->Location->getNearest();
        $this->set(compact('locations'));
        $this->set('_serialize', array('locations'));
    }
} 
```

我已将此添加到我的`routes.php`：

```
Router::mapResources('locations');
Router::parseExtensions('json'); 
```

当我运行它时，除了默认的 CakePHP 布局样式外，什么都没有显示。如果我删除 index.ctp 视图文件，我会收到一个错误，即找不到视图文件。为什么它仍然需要视图文件？我认为使用序列化方法不需要视图。我尝试查看 Google Chrome 开发者控制台，但没有包含 JSON 对象的响应。然而，MySQL 的表现非常好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:27:36.363

放在`$this->render(false);`中间

```
public $components = array('RequestHandler'); 
```

和

```
function index() 
```

现在它不再需要 index.ctp 文件了。

有关更多信息，请参阅[此链接](http://www.sethcardoza.com/2009/07/disabling-layouts-and-views-in-cakephp/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-18T18:48:25.633

我只是使用 REST API 做了同样的事情，因为我想要 JSON 中的响应。我所做的是我使用了 Chrome 高级休息客户端。我使用适当的 GET 方法向我的本地主机服务器发出请求，并且它成功了。

像：`GET /users/view/103.json`

你会得到如下响应：

```
{"users":{"User":{"id":"103","username":"abc","password":"xyz",
 "email-id":"abc@xyz.com"}}} 
```

# java - jsp：安全选择菜单

> ID：15178308
> 
> 赞同：0
> 
> 时间：2013-03-02T19:12:59.570
> 
> 标签：java, jsp

我是使用 jsp、servlet、bean 等的新手。

也许是一个奇怪的问题，但是在 jsp 中制作选择菜单的最安全方法是什么，以确保您无法直接访问它。

此时我有一个登录系统，根据我从数据库中检索到的用户“种类”，我根据他们拥有的“权限”将它们发送到特定的 jsp。在此页面上，他们将选择他们可以做的可能性。

但如果我使用类似的东西：

```
<a href="next.jsp">next option</a> 
```

从外部访问这些下一页很容易（那时对登录系统没有多大用处）。

我可以使用从上一页检索到的 bean，我检查它是否为空（如果您直接访问此页面，则会如此）或类似的东西。

欢迎大家提出意见。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:19:35.750

您可以使用[Servlet 过滤器](http://docs.oracle.com/javaee/6/tutorial/doc/bnagb.html)来验证用户是否已登录系统并验证用户是否有权访问此页面。[StackOverflow Servlet-Filters wiki](https://stackoverflow.com/tags/servlet-filters/info)中所述的一个示例。贴出相关代码：

```
@Override
public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException {
    HttpServletRequest request = (HttpServletRequest) req;
    HttpServletResponse response = (HttpServletResponse) res;
    HttpSession session = request.getSession(false);

    //session.getAttribute("user") contains the user info in session
    if (session == null || session.getAttribute("user") == null) {
        // No logged-in user found, so redirect to login page.
        response.sendRedirect(request.getContextPath() + "/login");
    } else {
        // Logged-in user found, so just continue request.
        chain.doFilter(req, res); 
    }
} 
```

# android - 将“CallLog.Calls”存储到另一个表中

> ID：15178310
> 
> 赞同：2
> 
> 时间：2013-03-02T19:13:06.450
> 
> 标签：android, sqlite

我需要使用什么样的查询

“创建表 CallDB 为（从 CallLog.Calls 中选择 *）”

我想将整个通话记录存储到另一个表中以进行处理。因为我读过 taht calllog.calls 只有最后 500 条记录

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T16:07:25.233

**好的，我自己做了一个解决方案。不知道它是否最好但仍然**

## **任何人都有更简单/内存效率更高的解决方案？？？**

* * *

```
package database;
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.provider.CallLog;
import android.util.Log;
import android.widget.Toast;

public class CallDBDatasource 
{

Context context;

private SQLiteDatabase db;
private CallDBHelper dbHelper;

public CallDBDatasource(Context context) {
    // TODO Auto-generated constructor stub
    this.context = context;
    dbHelper = new CallDBHelper(context);
}

public void open() throws SQLException {
    db = dbHelper.getWritableDatabase();

    Log.d("CallDBDatasource", "insert check");

    Toast t = Toast.makeText(context, "try... "  , Toast.LENGTH_SHORT);
    t.show();

    Cursor callInitCheck = db.rawQuery("select count(*) from call", null);

    Toast t2a = Toast.makeText(context, "count rows " + callInitCheck.getCount() , Toast.LENGTH_SHORT);
    t2a.show();

    callInitCheck.moveToNext();
    if( Integer.parseInt( callInitCheck.getString(0)) == 0) // if no rows then do
    {
        // if empty then insert into call

        // select * from CallLog.Calls
        String[] allCol = {
                CallLog.Calls.CACHED_NAME , 
                CallLog.Calls.CACHED_NUMBER_LABEL ,
                CallLog.Calls.CACHED_NUMBER_TYPE ,
                CallLog.Calls.DATE , 
                CallLog.Calls.DURATION , 
                CallLog.Calls.TYPE , 
                CallLog.Calls.NUMBER
                };

                Cursor c = context.getContentResolver().query(CallLog.Calls.CONTENT_URI, allCol , null,null, null);

                if(c.moveToFirst())
                {
                    Toast t3 = Toast.makeText(context, "count " + c.getColumnCount() , Toast.LENGTH_LONG);
                    t3.show();

                    Log.d("CallDBDatasource", "inside cursor");

                    CallDB callDB = new CallDB();

                    int indexCACHED_NAME = c.getColumnIndex(CallLog.Calls.CACHED_NAME);
                    int indexCACHED_NUMBER_LABEL = c.getColumnIndex(CallLog.Calls.CACHED_NUMBER_LABEL);
                    int indexCACHED_NUMBER_TYPE = c.getColumnIndex(CallLog.Calls.CACHED_NUMBER_TYPE);
                    int indexDATE = c.getColumnIndex(CallLog.Calls.DATE);
                    int indexDURATION = c.getColumnIndex(CallLog.Calls.DURATION);
                    int indexNUMBER = c.getColumnIndex(CallLog.Calls.TYPE);
                    int indexTYPE = c.getColumnIndex(CallLog.Calls.NUMBER);

                    do
                    {
                        callDB.setCACHED_NAME(c.getString(indexCACHED_NAME));
                        callDB.setCACHED_NUMBER_LABEL(c.getString(indexCACHED_NUMBER_LABEL));
                        callDB.setCACHED_NUMBER_TYPE(c.getString(indexCACHED_NUMBER_TYPE));
                        callDB.setDATE(c.getString(indexDATE));
                        callDB.setDURATION(c.getString(indexDURATION));
                        callDB.setTYPE(c.getString(indexNUMBER));
                        callDB.setNUMBER(c.getString(indexTYPE));

                        insert(callDB);
                    }
                    while(c.moveToNext());
                    Toast t1 = Toast.makeText(context, "added " + c.getCount() , Toast.LENGTH_SHORT);
                    t1.show();
                    //close cursor
                    c.close();

                } // end if cursor

                Log.d("CallDBDatasource", "INITED :)");
    } // end if
    callInitCheck.close();

  } // end open()

public void close() {
    dbHelper.close();
    Log.d("CallDBDatasource", "close()");
} // end close()

public void insert(CallDB callDB) {

    ContentValues values = new ContentValues();

    values.put(CallDBHelper.CACHED_NAME, callDB.getCACHED_NAME());
    values.put(CallDBHelper.CACHED_NUMBER_LABEL, callDB.getCACHED_NUMBER_LABEL());
    values.put(CallDBHelper.CACHED_NUMBER_TYPE, callDB.getCACHED_NUMBER_TYPE());
    values.put(CallDBHelper.DATE, callDB.getDATE());
    values.put(CallDBHelper.DURATION, callDB.getDURATION());
    values.put(CallDBHelper.NUMBER, callDB.getNUMBER());
    values.put(CallDBHelper.TYPE, callDB.getTYPE());

    db.insert(CallDBHelper.DATABASE_TABLE, "" , values);
    Log.d("CallDBDatasource", "values inserted");

} // end insert

public void update(CallDB callDB) {

    ContentValues values = new ContentValues();

    values.put(CallDBHelper.CACHED_NAME, callDB.getCACHED_NAME());
    values.put(CallDBHelper.CACHED_NUMBER_LABEL, callDB.getCACHED_NUMBER_LABEL());
    values.put(CallDBHelper.CACHED_NUMBER_TYPE, callDB.getCACHED_NUMBER_TYPE());
    values.put(CallDBHelper.DATE, callDB.getDATE());
    values.put(CallDBHelper.DURATION, callDB.getDURATION());
    values.put(CallDBHelper.NUMBER, callDB.getNUMBER());
    values.put(CallDBHelper.TYPE, callDB.getTYPE());

    db.update(CallDBHelper.DATABASE_TABLE, values , null, null);

    Log.d("CallDBDatasource", "values updated");

} // end update

public long cIn() {
    long ret = 0L;

        Cursor c = db.rawQuery("select sum(DURATION) from call where TYPE = ?", new String[] { String.valueOf(CallLog.Calls.INCOMING_TYPE) });

        if(c.moveToNext())
        {
            try {
                Toast t = Toast.makeText(context, "" + c.getString(0) , Toast.LENGTH_SHORT);
                t.show();
                ret = Long.parseLong(c.getString(0));
            } catch (NumberFormatException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

        c.close();

    return ret;
} // end cIn()

public long cOut() {
    long ret = 0L;

        Cursor c = db.rawQuery("select sum(DURATION) from call where TYPE = ?", new String[] { String.valueOf(CallLog.Calls.OUTGOING_TYPE) });

        if(c.moveToNext())
        {
            try {
                Toast t = Toast.makeText(context, "" + c.getString(0) , Toast.LENGTH_SHORT);
                t.show();
                ret = Long.parseLong(c.getString(0));
            } catch (NumberFormatException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

        c.close();

    return ret;
} // end cOut()

public long cMiss() {
    long ret = 0L;

        Cursor c = db.rawQuery("select count(*) from call where TYPE = ?", new String[] { String.valueOf(CallLog.Calls.MISSED_TYPE) });

        if(c.moveToNext())
        {
            try {
                Toast t = Toast.makeText(context, "" + c.getString(0) , Toast.LENGTH_SHORT);
                t.show();
                ret = Long.parseLong(c.getString(0));
            } catch (NumberFormatException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

        c.close();

        return ret;
    } // end cMiss()

} // end class 
```

* * *

```
 package database;

public class CallDB {

private String ID = null ;
private String CACHED_NAME = null;
private String CACHED_NUMBER_LABEL = null ;
private String CACHED_NUMBER_TYPE = null ;
private String DATE = null ;
private String DURATION = null ;
private String NUMBER = null ;
private String TYPE = null ;

public String getID() {
    return ID;
}

public void setID(String iD) {
    ID = iD;
}

public String getCACHED_NAME() {
    return CACHED_NAME;
}

public void setCACHED_NAME(String cACHED_NAME) {
    CACHED_NAME = cACHED_NAME;
}

public String getCACHED_NUMBER_LABEL() {
    return CACHED_NUMBER_LABEL;
}

public void setCACHED_NUMBER_LABEL(String cACHED_NUMBER_LABEL) {
    CACHED_NUMBER_LABEL = cACHED_NUMBER_LABEL;
}

public String getCACHED_NUMBER_TYPE() {
    return CACHED_NUMBER_TYPE;
}

public void setCACHED_NUMBER_TYPE(String cACHED_NUMBER_TYPE) {
    CACHED_NUMBER_TYPE = cACHED_NUMBER_TYPE;
}

public String getDATE() {
    return DATE;
}

public void setDATE(String dATE) {
    DATE = dATE;
}

public String getDURATION() {
    return DURATION;
}

public void setDURATION(String dURATION) {
    DURATION = dURATION;
}

public String getNUMBER() {
    return NUMBER;
}

public void setNUMBER(String nUMBER) {
    NUMBER = nUMBER;
}

public String getTYPE() {
    return TYPE;
}

public void setTYPE(String tYPE) {
    TYPE = tYPE;
}

public CallDB() {
        // TODO Auto-generated constructor stub
    }

} 
```

* * *

```
 package database;

import android.content.Context;
import android.database.Cursor;
import android.database.DatabaseErrorHandler;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.database.sqlite.SQLiteDatabase.CursorFactory;
import android.provider.CallLog;
import android.util.Log;
import android.widget.Toast;

public class CallDBHelper extends SQLiteOpenHelper {

Context context;

public static final String DATABASE_NAME = "AndroidLoggerCall" ;
public static final String DATABASE_TABLE = "call" ;
public static final int DATABASE_VERSION = 1 ;

// rows
public static final String ID = "_id";
public static final String CACHED_NAME = "CACHED_NAME";
public static final String CACHED_NUMBER_LABEL = "CACHED_NUMBER_LABEL";
public static final String CACHED_NUMBER_TYPE = "CACHED_NUMBER_TYPE";
public static final String DATE = "DATE";
public static final String DURATION = "DURATION";
public static final String NUMBER = "NUMBER";
public static final String TYPE = "TYPE";
// end rows

// create table string
    public static final String CREATE_TABLE = "create table "
            + DATABASE_TABLE + "("
            + ID + " INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,"
            + CACHED_NAME + " text,"
            + CACHED_NUMBER_LABEL + " text,"
            + CACHED_NUMBER_TYPE + " text,"
            + DATE + " text,"
            + DURATION + " text,"
            + NUMBER + " text,"
            + TYPE + " text"
            + ");"  ;
// end create table

public CallDBHelper(Context context) {
    super(context, DATABASE_NAME , null, DATABASE_VERSION);
    this.context = context;
    // TODO Auto-generated constructor stub
}

@Override
public void onCreate(SQLiteDatabase db) {
    // TODO Auto-generated method stub
    Log.d("CallDBHelper", "onCreate");
    db.execSQL(CREATE_TABLE);
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // TODO Auto-generated method stub

}

} 
```

# objective-c - 将 JSON 对象存储到核心数据中

> ID：15178315
> 
> 赞同：1
> 
> 时间：2013-03-02T19:13:27.213
> 
> 标签：objective-c, xcode, json, core-data

我正在尝试将我的本地核心数据数据库与远程 JSON API 同步。我正在使用 RestKit 将 JSON 值映射到本地托管对象。这是一段代码：

```
- (IBAction)testButtonPressed:(id)sender {

NSManagedObjectModel *managedObjectModel = [NSManagedObjectModel mergedModelFromBundles:nil];
RKManagedObjectStore *managedObjectStore = [[RKManagedObjectStore alloc] initWithManagedObjectModel:managedObjectModel];
NSError *error = nil;
BOOL success = RKEnsureDirectoryExistsAtPath(RKApplicationDataDirectory(), &error);
if (! success) {
    RKLogError(@"Failed to create Application Data Directory at path '%@': %@", RKApplicationDataDirectory(), error);
}

// - - - - - - - - Change the path !
NSString *path = [RKApplicationDataDirectory() stringByAppendingPathComponent:@"AC.sqlite"];
NSPersistentStore *persistentStore = [managedObjectStore addSQLitePersistentStoreAtPath:path
                                                                 fromSeedDatabaseAtPath:nil
                                                                      withConfiguration:nil
                                                                                options:nil
                                                                                  error:&error];
if (! persistentStore) {
    RKLogError(@"Failed adding persistent store at path '%@': %@", path, error);
}
[managedObjectStore createManagedObjectContexts];

// - - - - - - - - Here we change keys and values
RKEntityMapping *placeMapping = [RKEntityMapping mappingForEntityForName:@"Place"
                                                    inManagedObjectStore:managedObjectStore];
[placeMapping addAttributeMappingsFromDictionary:@{
    @"place_id": @"place_id",
    @"place_title": @"place_title",
    @"site": @"site",
    @"address": @"address",
    @"phone": @"phone",
    @"urating": @"urating",
    @"worktime": @"worktime",
    @"lat": @"lat",
    @"lng": @"lng",
    @"about": @"about",
    @"discount": @"discount",
    @"subcategory_title": @"subcategory_title",
    @"subcategory_id": @"subcategory_id",
    @"category_title": @"category_title",
    @"image_url": @"image_url"}];

//RKEntityMapping *articleMapping = [RKEntityMapping mappingForEntityForName:@"Article" inManagedObjectStore:managedObjectStore];
//[articleMapping addAttributeMappingsFromArray:@[@"title", @"author", @"body"]];
//[articleMapping addPropertyMapping:[RKRelationshipMapping relationshipMappingFromKeyPath:@"categories" toKeyPath:@"categories" withMapping:categoryMapping]];

NSIndexSet *statusCodes = RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful); // Anything in 2xx
// here we need to change too
RKResponseDescriptor *responseDescriptor =
    [RKResponseDescriptor responseDescriptorWithMapping:placeMapping
                                            pathPattern:nil // @"/articles/:articleID"
                                                keyPath:@"data.place_list"
                                            statusCodes:statusCodes];

NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:@"http://allocentral.api.v1.ladybirdapps.com/place/?access_token=19f2a8d8f31d0649ea19d478e96f9f89b&category_id=1&limit=10"]];

RKManagedObjectRequestOperation *operation = [[RKManagedObjectRequestOperation alloc] initWithRequest:request
                                                                                  responseDescriptors:@[responseDescriptor]];

operation.managedObjectContext = managedObjectStore.mainQueueManagedObjectContext;
operation.managedObjectCache = managedObjectStore.managedObjectCache;

[operation setCompletionBlockWithSuccess:^(RKObjectRequestOperation *operation, RKMappingResult *result) {
    NSLog(@" successfull mapping ");
    [self refreshContent];

} failure:^(RKObjectRequestOperation *operation, NSError *error) {
    NSLog(@"Failed with error: %@", [error localizedDescription]);
}];

NSOperationQueue *operationQueue = [NSOperationQueue new];
[operationQueue addOperation:operation];
}

- (void) refreshContent {
//  perform fetch
NSError *error = nil;
if (![self.fetchedResultsController performFetch:&error]) {
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
}
//  reload data
[self.tableView reloadData];
} 
```

它运行完美，可以获取所有对象并将它们存储在核心数据中，但是如果在服务器上删除了某些对象，并且它们不在 JSON 响应中，它们就会留在 detebase 中。我怎样才能让restkit清除不在响应中的对象？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:18:46.393

每当您从服务器收到新的 JSON 响应时，您应该照常处理它，将新条目添加到您的核心数据对象中。

然后遍历您的 Core Data 对象，并检查它们是否包含在 JSON 中（使用对您的对象有意义的任何方法），如果没有，则删除它们。

或者，如果您通过 JSON 传递某种 ID，您可以在将对象添加到 Core Data 的同时将每个 ID 存储在 NSArray 中。然后对与数组中的 ID 不匹配的任何 Core Data 对象进行谓词搜索，然后将其删除。

哪个更好取决于您是否有更多新/现有项目或更多要删除的项目。

# mysql - Mysql 查询发出日期减去 7 天

> ID：15178319
> 
> 赞同：3
> 
> 时间：2013-03-02T19:13:43.343
> 
> 标签：mysql, sql, yii

这不断出现错误，我无法弄清楚为什么......

```
SELECT
  i.user_id
FROM (SELECT
    SUM(us.score) AS score_sum,
    us.user_id
      FROM user_scores us
      WHERE us.created >= DATE(DATE_SUB(NOW(),INTERVAL 7 DAY))
      GROUP BY us.user_id) AS i
ORDER BY i.score_sum
LIMIT 1 
```

带有消息的异常“CDbException”

> CDbCommand 未能执行 SQL 语句：CDbCommand 未能准备 SQL 语句：SQLSTATE[HY000]：一般错误：1 接近“7”：语法错误。

执行的 SQL 语句是：

```
SELECT
  i.user_id
FROM (SELECT
    SUM(us.score) AS score_sum,
    us.user_id
      FROM user_scores us
      WHERE us.created >= DATE(DATE_SUB(NOW(),INTERVAL 7 DAY))
      GROUP BY us.user_id) AS i
ORDER BY i.score_sum
LIMIT 1

<?php

class WinnerCommand extends CConsoleCommand
{
    public function actionSelect()
    {
        $sql = "SELECT i.user_id FROM
            (SELECT SUM(us.score) AS score_sum, us.user_id FROM user_scores us
            WHERE us.created >= DATE(DATE_SUB(NOW(),INTERVAL 7 DAY))
            GROUP BY us.user_id) AS i
            ORDER BY i.score_sum
            LIMIT 1";
        $user_id = Yii::app()->db->createCommand($sql)->queryScalar();
        echo $user_id;
        return $user_id;
    } 
```

}

?>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:32:59.453

我无法解释这个问题，但您可以消除表达式中的子查询。也许这会有所帮助：

```
 SELECT us.user_id
        FROM user_scores us
        WHERE us.created >= DATE(DATE_SUB(NOW(), INTERVAL 7 DAY))
        GROUP BY us.user_id)
        ORDER BY SUM(us.score)
        LIMIT 1 
```

# c# - JSON.NET 反序列化为带有 Type 参数的对象

> ID：15178323
> 
> 赞同：28
> 
> 时间：2013-03-02T19:14:07.240
> 
> 标签：c#, types, casting, json.net, deserialization

我有以下我无法解决的问题：

我有不同的类，它们都实现了一个名为`IProtocol`. 目前，它们被命名为`SimpleProtocol`, `ParallelProtocol`。我想保留这些对象，所以我使用了 JSON.NET，一切正常。除非我试图反序列化它们，否则当我知道它们应该是什么类型时它可以完美地工作，例如：

```
SimpleProtocol p = JsonConvert.DeserializeObject<SimpleProtocol>(myJsonData); 
```

但是，我现在处于想要加载 JSON 数据并获得`IProtocol`回复的情况，但可以理解的是，JSON 不允许这样做；例如，这样的事情**不起作用**：

```
IProtocol p1 = JsonConvert.DeserializeObject<IProtocol>(myJsonData); // does not work
IProtocol p2 = (IProtocol)JsonConvert.DeserializeObject(myJsonData); // also, does not work 
```

因此，查找[API](http://james.newtonking.com/projects/json/help/index.html?topic=html/Overload_Newtonsoft_Json_JsonConvert_DeserializeObject.htm)我发现了这个方法签名：

```
public static Object DeserializeObject(
    string value,
    Type type
) 
```

这看起来就像我需要的东西，所以尝试将类型保存在字符串中并检索它：

```
// test
Type protocolType = Type.GetType("MyApp.Protocols.SimpleProtocol");
IProtocol p1 = JsonConvert.DeserializeObject(myJsonData, protocolType); 
```

我收到一个错误，无法将 a`Newtonsoft.Json.Linq.JObject`转换为`IProtocol`. 这很奇怪，我不知道如何解决。

在泛型方法中传递Type对象是不可能的，所以我基本上卡在这里。有没有办法解决这个问题，最好不使用反射？在我看来，这是一个完全正常的用例。

我能做的，但对我来说似乎有点“脏”，是创建一个简单的包装类，其中包含一个 IProtocol 实例并序列化/反序列化？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-03-04T08:39:03.233

看来我最初使用这种方法的方法毕竟是正确的：

```
public static Object DeserializeObject(
    string value,
    Type type
) 
```

问题是我坚持使用我的对象类型，`MyProtocol.GetType().FullName`这导致了一个值来自

`Type protocolType = Type.GetType(PersistedTypeString);`

成为具有`null`值的类型。但是，通过使用`MyProtocol.GetType().AssemblyQualifiedName`一切正常（ps 这也包含在 Type.GetType() 的文档中）

这是我的代码示例：

```
Type ProtocolType = Type.GetType(MetaData["ProtocolType"]);
var Protocol = JsonConvert.DeserializeObject(Data["Protocol"], 
                                             ProtocolType, 
                                             JsonProtocolPersister.DefaultSettings);
return (IProtocol)Protocol; 
```

# ruby-on-rails - Rails：URL中的特定名称+ ID

> ID：15178324
> 
> 赞同：0
> 
> 时间：2013-03-02T19:14:32.043
> 
> 标签：ruby-on-rails, url

我的问题是我想要一个类似的网址，`/product/title-1`但我只得到`/product/1-title`！这是我在**product.rb 中的代码：**

```
def to_param
  "#{id}-#{title.parameterize}"
end 
```

**路线.rb：**

```
resources :products do
  resources :comments
end 
```

我必须改变什么才能得到它？

# asp.net - 将 ASP.NEt 站点部署到托管公司

> ID：15178325
> 
> 赞同：0
> 
> 时间：2013-03-02T19:14:35.850
> 
> 标签：asp.net

我已经使用visual studio web devloper 2010建立了一个网站。它在我机器上的本地主机上运行良好，但是当我将它部署到我的托管服务提供商（谁支持ASP.NET）时，我收到以下错误：

500内部服务器错误。您要查找的资源有问题，无法显示。

只是为了测试该站点是否已注册，我在服务器上放了一个简单的 hello world html，效果很好。我很确定我的问题将出在 web.config 上，并尝试了几种方法来尝试使用 httpErrors existingResponse="PassThrough" /> 获取有关错误的更多信息，并关闭显示友好的 html 错误，但这并没有有什么不同吗？我已经与托管站点记录了一个支持电话，但直到星期一才会得到答复！

直接加载到 Firefox 时出现新错误

XML 解析错误：格式不正确 位置：file:///C:/Users/Fiona/Documents/Visual%20Studio%202010/Projects/Wedding/Wedding/MenuSelector.aspx 第 1 行，第 2 列：<%@ PageTitle ="菜单选择器" MasterPageFile="~/Site.master" Language="C#" AutoEventWireup="true" CodeBehind="MenuSelector.aspx.cs" Inherits="Wedding.MenuSelector" %> -^

任何关于如何解决这个问题的建议都会很受欢迎，web.config 如下所示：（这只是一个学习练习，所以文件中没有敏感数据）

```
 <?xml version="1.0"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->
    <configuration>
    <configSections>
    <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions,  Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
        <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
        <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
          <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere"/>
          <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
          <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
          <section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
        </sectionGroup>
      </sectionGroup>
    </sectionGroup>
  </configSections>
  <connectionStrings>
    <add name="ApplicationServices" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient"/>
  </connectionStrings>
  <system.web>
    <compilation>
      <assemblies>
        <add assembly="System.Web.Extensions.Design, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
        <add assembly="System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
      </assemblies>
    </compilation>
    <authentication mode="Forms">
      <forms loginUrl="~/Default.aspx" timeout="2880"/>
    </authentication>
    <membership>
      <providers>
        <clear/>
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/"/>
      </providers>
      </membership>
      <profile>
      <providers>
        <clear/>
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/"/>
      </providers>
    </profile>
    <roleManager enabled="false">
      <providers>
        <clear/>
        <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/"/>
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/"/>
      </providers>
    </roleManager>
    <pages>
      <controls>
        <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      </controls>
    </pages>
    <httpHandlers>
      <remove verb="*" path="*.asmx"/>
      <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add verb="GET,HEAD" path="ScriptResource.axd" validate="false" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </httpHandlers>
    <httpModules>
      <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </httpModules>
  </system.web>
  <system.webServer>

      <httpErrors existingResponse="PassThrough" />

    <modules runAllManagedModulesForAllRequests="true">
      <remove name="ScriptModule"/>
      <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </modules>
    <validation validateIntegratedModeConfiguration="false"/>
    <handlers>
      <remove name="WebServiceHandlerFactory-Integrated"/>
      <remove name="ScriptHandlerFactory"/>
      <remove name="ScriptHandlerFactoryAppServices"/>
      <remove name="ScriptResource"/>
      <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add name="ScriptResource" verb="GET,HEAD" path="ScriptResource.axd" preCondition="integratedMode" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </handlers>
   </system.webServer>
   <system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    </system.webServer>
  <system.codedom>
    <compilers>
      <compiler language="c#;cs;csharp" extension=".cs" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" warningLevel="4">
        <providerOption name="CompilerVersion" value="v3.5"/>
        <providerOption name="WarnAsError" value="false"/>
      </compiler>
    </compilers>
      </system.codedom>
     <runtime>
    <assemblyBinding appliesTo="v2.0.50727" xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
        <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Extensions.Design"   publicKeyToken="31bf3856ad364e35"/>
        <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
      </dependentAssembly>
      </assemblyBinding>
      </runtime>
    </configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:18:47.030

要查看实际的错误消息，您可以执行以下操作：

```
<!-- web.config -->
<configuration>
    <system.web>
        <customErrors mode="Off"/>
    </system.web>
</configuration> 
```

另外，如果您使用 IE 查看页面，您还需要[禁用友好错误消息](http://technet.microsoft.com/en-us/library/cc778248%28v=ws.10%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:44:40.670

可能你在 IIS 中锁定了这个配置，如果你检查他也谈到了这个问题，[你](https://stackoverflow.com/questions/2345532/turn-iis7-http-error-handling-off)将无法在 webconfig 中更改它。

你应该删除

```
<httpErrors existingResponse="PassThrough" /> 
```

从你的网络配置

你应该包括

```
<customErrors mode="Off"/> 
```

在您的 webconfig 中查看真正发生的错误。

# opengl - opengl函数会导致主线程冻结吗？

> ID：15178326
> 
> 赞同：6
> 
> 时间：2013-03-02T19:14:56.727
> 
> 标签：opengl, rendering

那么当你调用opengl函数时，比如glDraw或者gLBufferData，是否会导致程序的线程停止并等待GL完成调用呢？

如果不是，那么 GL 如何处理调用诸如 glDraw 之类的重要函数，然后立即更改影响绘图调用的设置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T19:24:02.883

不，他们（大部分）没有。大多数 GL 函数在使用时被缓冲，稍后实际执行。这意味着您不能将 CPU 和 GPU 视为同时工作的两个处理器。通常，CPU 会执行一堆缓冲的 GL 函数，一旦它们被传递到 GPU，这个函数就会执行它们。这意味着您无法仅通过比较执行特定 GL 函数之前和之后的时间来可靠地控制执行特定 GL 函数所需的时间。

如果你想这样做，你需要首先运行一个 glFinish() 以便它实际上会等待所有以前缓冲的 GL 调用执行，然后你可以开始计数，执行你想要基准的调用，再次调用 glFinish 到确保这些调用也被执行，然后完成基准测试。

另一方面，我说“大部分”。这是因为读取函数实际上需要与 GPU 同步以显示真实结果，因此，在这种情况下，它们会等待并冻结主线程。

编辑：我认为解释本身回答了你第二个问的问题，但以防万一：所有调用都被缓冲的事实使得可以先完成平局，然后为连续调用更改设置

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:33:21.287

它严格取决于相关的 OpenGL 调用和 OpenGL 状态。当您进行 OpenGL 调用时，实现首先在内部将它们排队，然后与调用程序的执行异步执行它们。OpenGL 的一个重要概念是同步点。这些是工作队列中的操作，需要 OpenGL 调用阻塞，直到满足某些条件。

OpenGL 对象（纹理、缓冲区对象等）是纯粹抽象的，并且通过规范客户端程序中对象的句柄始终指向数据，该对象在调用 OpenGL 函数时引用该对象。所以以这个序列为例：

```
glBindTexture(GL_TEXTURE_2D, texID);

glTexImage2D(..., image_1);
draw_textured_quad();

glTexImage2D(..., image_2);
draw_textured_quad(); 
```

第一个`draw_textured_quad`可能会在绘制任何东西之前很久就返回。然而，通过调用，OpenGL 创建了一个对纹理当前保存的数据的内部引用。因此，当第二次调用 glTexImage2D 时，这可能发生在第一个四边形绘制之前，OpenGL 必须在内部创建一个辅助纹理对象，该对象将成为纹理`texID`并供`draw_textured_quad`. 如果`glTexSubImage2D`被调用，它甚至必须制作它的修改副本。

OpenGL 调用只会阻塞，如果调用的结果修改了客户端内存并且依赖于之前的 OpenGL 调用生成的数据。换句话说，当进行 OpenGL 调用时，OpenGL 实现会在内部生成一个依赖树来跟踪什么依赖什么。当一个同步点必须阻塞时，它至少会阻塞，直到满足所有依赖项。

# rest - 用于创建 POST 服务的 Bitbucket services api

> ID：15178328
> 
> 赞同：1
> 
> 时间：2013-03-02T19:15:07.270
> 
> 标签：rest, curl, bitbucket-api

有谁知道通过 BitBucket API 创建 POST 服务的参数？

目前缺少文档，并且有一个开放的票可以编写它。它遵循与 API 的其余部分相同的格式，希望有人能理解。

到目前为止，我可以创建的唯一参数是类型：

```
curl --user name:pw https://api.bitbucket.org/1.0/repositories/{account}/{repository}/services --data 'type={POST/Twitter/AgileZen/etc}' 
```

成功创建一个空的 POST 服务。

这是[文档的链接](https://confluence.atlassian.com/display/BITBUCKET/Using+the+Bitbucket+REST+APIs/#UsingtheBitbucketRESTAPIs-SupportedEndpointsandtheirResources)，以防万一。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T06:46:24.320

我们未能正确记录这一点有点劣质。无论如何，以下是添加发布到 google.com 的 POST 服务的方法：

```
$ curl -X POST https://username:passwd@bitbucket.org/api/1.0/repositories/evzijst/interruptingcow/services \
    -d type=POST -d URL=http://google.com
{
    "id": 507781,
    "service": {
        "fields": [
            {
                "name": "URL",
                "value": "http://google.com"
            }
        ],
        "type": "POST"
    }
} 
```

此端点的工作方式是您始终指定“类型”参数，该参数必须包含服务名称（如下拉菜单中所示），然后通过传递其他 post 参数来配置它。

每个服务都有自己的配置参数。您可以通过简单地在 repo 中添加服务并查看字段来找到答案。您的参数必须与可用字段匹配：

![配置参数](../Images/dce4c57d5d1c27421e59e3b12197d63a.png)

可以通过执行 PUT 来修改各个参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:45:01.503

这是记录在案的；当我修改所有内容时，我只是迷失了：

[https://confluence.atlassian.com/display/BITBUCKET/services+Resource](https://confluence.atlassian.com/display/BITBUCKET/services+Resource)

您也可以在我们的 REST 浏览器中对其进行测试：

[http://restbrowser.bitbucket.org/](http://restbrowser.bitbucket.org/)

# apache - redmine 和 mod_vhost_dbd

> ID：15178330
> 
> 赞同：0
> 
> 时间：2013-03-02T19:15:24.663
> 
> 标签：apache, redmine

我在使用 apache 中的 vhost_dbd_module 运行 redmine 时遇到问题。Redmine 安装在 /var/www/redmine/ 目录下。我的 apache 配置外观：

```
<虚拟主机 *:80>
    服务器名主机名
    DocumentRoot "/var/www/" # 这不起作用
    # DocumentRoot "/var/www/redmine/public" # 这适用于 REDMINE
    <目录/>
        选项 FollowSymLinks -MultiViews -Indexes
        允许覆盖所有
    </目录>
    DBDriver mysql
    DBDParams host=localhost,user=test,pass=test,dbname=test
    DBDocRoot "SELECT document_root FROM vhosts WHERE server_name = %s" HOSTNAME
</虚拟主机>

```

来自数据库的字段**document_root**返回 '/var/www/redmain/public' - 所以它应该可以工作。它适用于索引文件位于“/var/www/project/public”下的 php 项目。除了页面返回 404，因为在 /var/www/redmain/public 中没有索引文件。我要通用配置

有什么建议么？最好的问候，彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:41:16.247

`mod_vhost_dbd`作为 apache 模块的Passenger 与用于定义“动态”文档根（包括）的所有模块都不兼容。对于乘客，您必须在 Apache 配置中静态配置您的应用程序。

通常，您将很难使用任何 Ruby 应用程序服务器模拟您的 PHP 设置，因为它们希望启动一次并连续运行，这与 PHP“应用程序”不同，PHP“应用程序”充当脚本解析并为每个请求重新启动。您应该重新考虑持久应用程序服务器进程的设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T14:16:22.417

我用下面的内容创建了 .htaccess 并且它工作:)

```
RailsBaseURI /
乘客AppRoot /var/www/redmine

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T19:23:15.590

没有 index.html 是可以的 :) 检查你的`config/routes.rb`. 如果 rails 服务正在运行，那么您的 redmine rails 检查您的 routes.rb 并在那里提供默认页面（查看）。

# c# - 如何创建一个包含对象值的字符串？

> ID：15178345
> 
> 赞同：2
> 
> 时间：2013-03-02T19:16:58.290
> 
> 标签：c#, string, visual-studio-2010, visual-studio

这个问题真的不难理解。我一直想知道这一点，想知道如果可能的话，怎么可能做到。好吧，如果可能的话，这就是我想做的事情：

```
 int number = 50;
    string text = "The number is %number"; 
```

我在上面写了***%number***`string`的地方，我希望将 的值`number`插入到 中`string`，因为我通常会做这样的事情的方式是：

```
 int number = 50;
    string text = "The number is " + number.ToString(); 
```

是的，我整合`number`到`string`上面的方式是一种不错的方式，但我一直想知道，是否有可能做一些事情，比如我写的第一个例子，在哪里把 an 的值`object`放入 a `string`all 你会要做的就是写一些类型的`character`or `string`（用来引用的`object`），连同in的名字一起`object`变成a`string`来得到a的结果和in`string`的值`object`吗？或者有什么类似的事情你能做到吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T19:18:17.043

你会使用[`string.Format`](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)：

```
string text = string.Format("The number is {0}", number); 
```

请注意，所有对象都有一个`ToString`方法，这意味着所有对象都可以用作 的参数`string.Format`，但是默认响应`ToString`是返回类型的全名，这可能没有多大意义。

例如，这个：

```
public class Dummy
{
}

var d = new Dummy();
string text = string.Format("The dummy is {0}", d); 
```

将类似于以下值分配给`text`：

```
"The dummy is Your.Namespace.Dummy"; 
```

你有两个选择：

1.  覆盖[`ToString`](http://msdn.microsoft.com/en-us/library/system.object.tostring.aspx)并返回对你的新类型有意义的东西
2.  改为读取属性或其他内容，例如：

    ```
    string text = string.Format("The dummy is {0}", d.SomeProperty); 
    ```

另请注意，`string.Format`可以采用多个参数：

```
int a = 10;
int b = 20;
int c = a + b;
string text = string.Format("{0} + {1} = {2}", a, b, c); 
```

`string.Format`除了我在此处显示的内容之外，还有很多内容，因此请单击文档链接（此答案的第一行）以了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:19:28.863

*你可能需要检查* [`Sting.Format`](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)

```
string text = String.Format("The number1 is {0},number2 is {1}", number1, number2); 
```

还值得检查[有关](https://stackoverflow.com/questions/296978/when-is-it-better-to-use-string-format-vs-string-concatenation)***何时使用 String.Format 与字符串连接更好的***讨论？`

# aptana - 无法在 Aptana Studio 中添加 Python 解释器：SAXParseException：实体名称必须紧跟实体引用中的“&”。”

> ID：15178348
> 
> 赞同：1
> 
> 时间：2013-03-02T19:17:20.533
> 
> 标签：aptana, pydev

我的 PC 上安装了 Python 2.7。我安装了 Aptana Studio 3。我已经按照您可以想象的每个顺序卸载并重新安装了所有内容。我已经无数次重启了。我仍然无法让 Aptana 识别出我安装了 Python 2.7。

当我尝试自动配置时，我得到：

“有关详细信息，请参阅错误日志。org.xml.sax.SAXParseException：实体名称必须紧跟实体引用中的 '&'。”

当我尝试添加新的时，我浏览到：C:\Python27\python.exe 并收到此错误。

“有关详细信息，请参阅错误日志。org.xml.sax.SAXParseException：实体名称必须紧跟实体引用中的 '&'。”

我在 Win 7 64 位机器上运行所有这些。Apyana 和 Python 都是 64 位版本。

我让这一切都在另外两台机器上运行，没有问题。

感谢任何人都可以给我的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-24T20:55:22.337

我遇到了同样的问题，将 Aptana 重新安装到没有空格或特殊字符的路径中。

**产生错误的路径：**

C:/Users/Bruno & Lu/AppData/Local/Aptana Studio 3

**现在的工作方式：**

C:/阿普塔纳

# php - 取消设置 php 会话变量

> ID：15178352
> 
> 赞同：2
> 
> 时间：2013-03-02T19:17:43.393
> 
> 标签：php, ajax, session, post, unset

我通过 ajax 传递一个 id 以由 $_SESSION 删除。ajax 部分工作正常，php 在 POST 中接收 id，但不能取消设置变量。为什么？？？这是我的代码：

ajax部分：

```
 $(".delete").live('click', function(e){
    e.preventDefault();
    var id_to_remove = $(this).attr('id');
    //alert(id_to_remove);
    $.ajax({
        type: "POST",
        url: 'inc/functions/remove_item_from_cart.php',
        data: { id : id_to_remove },
        success: function(data) {
          $("#content").load('inc/functions/get_checkout_content.php');
            alert(data);
        }
    })

}); 
```

php接收部分：

```
session_start();
if(isset($_SESSION['cart']) && isset($_POST['id'])){
//echo var_dump($_SESSION['cart']);
$ncart=$_SESSION['cart'];
if (count($ncart)>0){
    unset($ncart[$_POST['id']]); // this is NOT working!!!
    $ncart=array_values($ncart);

    $_SESSION['cart']=$ncart;
    if(count($ncart)==0){
        unset($_SESSION['cart']);
        unset($_SESSION['cart_total']);
        echo "all_empty";
    } // this if part is the only working!
}
} 
```

任何有用的建议为什么我不能取消设置会话变量？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T14:53:17.557

我有自己的解决方案：

```
if (count($_SESSION['cart'])>0){

 foreach ($_SESSION['cart'] as $key => $subarray){ 
  if ($subarray['id'] == $_POST['id']){ 
  unset($_SESSION['cart'][$key]); 
 break; 
 } 
} 

$_SESSION['cart'] = array_values($_SESSION['cart']);

} else {
 if(count($_SESSION['cart'])==0){
  unset($_SESSION['cart']);
  unset($_SESSION['cart_total']);
  echo "all_empty";
 }  
} 
```

那是因为数组是这样的：

```
Array
(
    [0] => Array
        (
            [id] => 3
            [name] => Collier Ano petit
            [price] => 45
            [quant] => 1
            [ptotal] => 45
        )

) 
```

# c++ - Boost .ini 文件解析器 - 多个部分名称

> ID：15178354
> 
> 赞同：1
> 
> 时间：2013-03-02T19:17:57.297
> 
> 标签：c++, ini, boost-propertytree

我正在使用 boost::property_tree 来解析 ini 文件。

我希望能够执行以下操作：

数据.ini：

```
[electron]
position=0,0,0
velocity=0,0,0

[proton]
position=1,0,0
velocity=0,0,0

[proton]
position=-1,0,0
velocity=0,0,0 
```

当前程序运行，并给出了这个错误：`duplicate section name`显然是因为有两个`[proton]`部分。

有没有另一种方法来解析这样的文件？我应该使用 xml 文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:58:41.293

这是一个简单的阅读器，以备不时之需：

**XML 文件：**

```
<?xml version="1.0" encoding="utf-8"?>
<data>
  <electron>
    <position>0,0,0</position>
    <velocity>0,0,0</velocity>
  </electron>
  <proton>
    <position>1,0,0</position>
    <velocity>0,0,0</velocity>
  </proton>
  <proton>
    <position>-1,0,0</position>
    <velocity>0,0,0</velocity>
  </proton>
</data> 
```

**JSON 文件：**

```
{
    "electron": {
        "position": "0,0,0",
        "velocity": "0,0,0"
    },
    "proton": {
        "position": "1,0,0",
        "velocity": "0,0,0"
    },
    "proton": {
        "position": "-1,0,0",
        "velocity": "0,0,0"
    }
} 
```

读取 XML 和 JSON 质子节点：

```
#include <boost/property_tree/ptree.hpp>
#include <boost/property_tree/xml_parser.hpp>
#include <boost/property_tree/json_parser.hpp>
#include <algorithm>
#include <iostream>

int main()
{
    // XML
    {
        boost::property_tree::ptree pt;
        boost::property_tree::read_xml("prop_data.xml", pt);

        for(auto& el : pt.get_child("data.proton"))
        {
            std::cout << el.second.data() << std::endl;
        }
    }

    // JSON
    {
        boost::property_tree::ptree pt;
        boost::property_tree::read_json("prop_data.json", pt);

        for(auto& el : pt.get_child("proton"))
        {
            std::cout << el.second.data() << std::endl;
        }
    }

    return 0;
} 
```

**编辑：** 可以为 JSON 使用数组，例如：

```
...
"position": [-1, 0, 0],
... 
```

以及读取该数组值的代码：

```
 for(auto& el : pt.get_child("proton"))
    {
        std::cout << el.first << std::endl;
        for(auto& a : el.second) {
            std::cout << a.second.data() << std::endl;
        }

        std::cout << std::endl;
    } 
```

这`el.second`只是一个 ptree，您可以使用 for 循环遍历它。

# mysql - MySql Db 插入上的 SyntaxError

> ID：15178355
> 
> 赞同：0
> 
> 时间：2013-03-02T19:17:58.660
> 
> 标签：mysql, web2py

我目前正在开发一个允许用户进行自我评估的项目。目前，我将评估标准存储在 MySQL 表中，并遍历该表以生成 FORM 对象，将下拉列表附加到每一行。尽管这很容易创建表单，但当我将插入命令放入表单接受条件块时，我在第一个使用下划线的字段分配中遇到语法错误。这是表格的代码：

```
db.define_table('Evaluation', Field('EvaluationId', 'integer', 'id'), 
Field('PersonBeingEvaluated', db.Person, 'integer'), 
Field('PersonEvaluating', 'integer'), 
Field('EvalDate', 'datetime'), 
Field('1_1A', 'integer'), Field('1_1B', 'integer'), Field('1_2', 'integer'),
Field('1_3', 'integer'), Field('1_4', 'integer'), Field('1_5', 'integer'), 
Field('1_6', 'integer'), Field('2_1', 'integer'), Field('2_2A', 'integer'),
Field('2_2B', 'integer'), Field('2_3A', 'integer'), Field('2_3B', 'integer'), 
Field('2_4', 'integer'), Field('2_5', 'integer'), Field('3_1', 'integer'), 
Field('3_2', 'integer'), Field('3_3', 'integer'), Field('3_4', 'integer'), 
Field('3_5A', 'integer'), Field('3_5B', 'integer'), Field('3_6', 'integer'), 
Field('3_7', 'integer'), Field('3_8', 'integer'), Field('3_9A', 'integer'), 
Field('3_9B', 'integer'), Field('3_9C', 'integer'), Field('4_1', 'integer'), 
Field('4_2', 'integer'), Field('4_3A', 'integer'), Field('4_3B', 'integer'), 
Field('4_4', 'integer'), Field('BeliefsScore', 'integer'), 
Field('CharacterScore', 'integer'), primarykey=['EvaluationId']) 
```

我的方法的代码：

```
@auth.requires_login()
def Take_Eval(): 
    user = db(db.Person.auth_userUserId == auth.user.id).select().first().PersonId
    table = db(db.PageContent.ContentId > 0).select()

    accordion = DIV(_id="accordion")
    for row in table:
        accordion.append(H2(row['ContentDescription'], _style="padding-left: 10px;"))
        accordion.append(DIV(XML(row.ContentHTML), BR(), P(SELECT(OPTGROUP(OPTION('Does not Attempt', _value=0), 
        OPTION('Developing', _value=1), OPTION('Progressing', _value=2), OPTION('Established', _value=3), 
        OPTION('Advanced', _value=4), OPTION('Master', _value=5)), _id=row['QuestionNumber']), _style='text-align: center;')))

    form = FORM(accordion, BR(), P(INPUT(_type='submit', _value='Submit', _name='btnSubmit'), _style="text-align: center;"))

    if form.accepts(request, session):
        response.flash = 'Evaluation Saved Successfully on  ' + str(time.strftime("%Y-%m-%d %H:%M:%S", time.localtime()))
        db.Evaluation.insert(PersonBeingEvaluated=user, PersonEvaluating=0, EvalDate=datetime.now(), 
        1_1A = form.vars.1_1A, 1_1B = form.vars.1_1B, 1_2 = form.vars.1_2, 1_3 = form.vars.1_3, 
        1_4 = form.vars.1_4, 1_5 = form.vars.1_5, 1_6 = form.vars.1_6, 2_1 = form.vars.2_1, 
        2_2A = form.vars.2_2A, 2_2B = form.vars.2_2B, 2_3A = form.vars.2_3A, 2_3B = form.vars.2_3B, 
        2_4 = form.vars.2_4, 2_5 = form.vars.2_5, 3_1 = form.vars.3_1, 3_2 = form.vars.3_2, 
        3_3 = form.vars.3_3, 3_4 = form.vars.3_4, 3_5A = form.vars.3_5A, 3_5B = form.vars.3_5B, 
        3_6 = form.vars.3_6, 3_7 = form.vars.3_7, 3_8 = form.vars.3_8, 3_9A = form.vars.3_9A, 
        3_9B = form.vars.3_9B, 3_9C = form.vars.3_9C, 4_1 = form.vars.4_1, 4_2 = form.vars.4_2, 
        4_3A = form.vars.4_3A, 4_3B = form.vars.4_3B, 4_4 = form.vars.4_4, 
        BeliefsScore = form.vars.BeliefsScore, CharacterScore = form.vars.CharacterScore)

        redirect(URL('default', 'index'))
    elif form.errors:
            response.flash = 'Profile could not be submitted.  Please try again later. '   

    return locals() 
```

为了解决这个问题，我重构了表单，认为我的命名约定对于下拉列表可能是错误的。但是，我不相信情况会如此。我也尝试过使用类似的东西：

```
1_1A = form.vars.1_1A.value 
```

认为也许我正在分配下拉列表而不是其数值，但这也没有改变错误代码。这个问题的最佳解决方案是让代码正确编译，并让每个下拉列表在插入时向数据库提交一个整数。

谁能告诉我为什么我的插入方法的语法出错了？谢谢。

**编辑**：

这是 HTML 页面：

```
{{extend 'layout.html'}}
<script>
    $(function() {
        $("#accordion").accordion({ 
            header: "h2",
            autoHeight: false
         });

    });  
</script>

<h1>Evaluation Info</h1>
<br />
<div id="contentPane">
    {{=form}}
</div>

<br /> 
```

实际页面本身有几千行；但是，我还抓住了一个选择标签的标记：

```
<p style="text-align: center;"><select id="Q1_1A"><optgroup>
    <option value="0">Does not Attempt</option>
    <option value="1">Developing</option>
    <option value="2">Progressing</option>
    <option value="3">Established</option>
    <option value="4">Advanced</option>
    <option value="5">Master</option>
</optgroup></select></p> 
```

需要帮助请叫我。

# java - 多播服务器接收它发送的相同数据

> ID：15178356
> 
> 赞同：2
> 
> 时间：2013-03-02T19:18:00.137
> 
> 标签：java, networking, udp, multicast

我正在尝试允许连接到我的 UDP 服务器的客户端将数据包发送到服务器，我有一个服务器正在运行，因此可以将数据包发送到客户端，但是尝试通过客户端将数据包发送回服务器似乎会创建一些奇怪的错误。

如果我启动服务器，然后打开一个客户端，客户端将收到来自服务器的第一个数据包，然后客户端尝试将数据包发送到服务器，这是由服务器接收，但随后客户端抛出此错误

```
Exception in thread "main" java.lang.NumberFormatException: For input string: "testing"
    at sun.misc.FloatingDecimal.readJavaFormatString(Unknown Source)
    at java.lang.Double.parseDouble(Unknown Source)
    at Pong.PongUDPClient.main(PongUDPClient.java:71) 
```

代码中将指向第 71 行 服务器控制台只是打印出它应该发送给客户端的数据，

这是服务器的完整代码

```
package Pong;

import java.io.IOException;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.net.MulticastSocket;
import java.net.Socket;

//This is the actual server
public class PongUDPServerThread extends Thread {

//speed to send data
private long dataSpeed = 10;
private int port = 4447;
private int idPlayer = 0;
private PongModel model;
private PongView  view;
private PongPlayerThread players[] = new PongPlayerThread[2];
private MulticastSocket socket = null;
private InetAddress group;
private DatagramPacket packet = null;
private int ID = 1;

public PongUDPServerThread() throws IOException 
{
    super("PongUDPServerThread");
}

public String rtnInfo()
{
    String str;
    str = model.getBall().getX() + ":" +
          model.getBall().getY() + ":" +
          model.getBats()[0].getX() + ":" +
          model.getBats()[0].getY() + ":" +
          model.getBats()[1].getX() + ":" +
          model.getBats()[1].getY();
    return str;
}

public void setupPong() throws IOException 
{
    System.out.println("Pong");
    model = new PongModel();
    view  = new PongView();
            new PongController( model, view );

    model.addObserver( view );       // Add observer to the model

    //view.setVisible(true);           // Display Screen
    model.makeActiveObject();        // Start play
    //start server
    socket = new MulticastSocket(port);
    InetAddress group = InetAddress.getByName("230.0.0.1");
    socket.setReuseAddress(true);
    socket.joinGroup(group);
    //socket.setReuseAddress(true);
    //Inform server user
    System.out.println("Server is running");
}

public void run()
{
    //Server loop
    while(true)
    {

        //Receive the data
        try
        {
        byte[] receiveBuf = new byte[256];
        packet = new DatagramPacket(receiveBuf, receiveBuf.length);
        socket.receive(packet);

        String received = new String(packet.getData(), 0, packet.getLength());

        System.out.println(received);
        }
        catch (IOException e)
        {

        }

        try
        {
            byte[] buf = new byte[256];

            //Gather data
            buf = rtnInfo().getBytes();
            //System.out.println(buf.toString());

            //Send data
            packet = new DatagramPacket(buf, buf.length, InetAddress.getByName("230.0.0.1"), port);
            socket.send(packet);

            //Sleep the server
            try
            {
                sleep((long)dataSpeed);
            }
            catch (InterruptedException e)
            {

            }
        }
        catch (IOException e)
        {
            e.printStackTrace();
        }
    }

    //socket.close();

}

} 
```

这是客户端代码

```
package Pong;

import java.io.*;
import java.net.*;
import java.util.*;

public class PongUDPClient {

private static int port = 4447;

public static void main(String[] args) throws IOException
{

    //Setup pong rdy
    PongModel model = new PongModel();
    PongView  view  = new PongView();
                      new PongController( model, view );

    model.addObserver( view );       // Add observer to the model

    String pos;

    model.makeActiveObject();        // Start play
    //model.clientModel();

    MulticastSocket socket = new MulticastSocket(port);
    //socket.setReuseAddress(true);
    InetAddress address = InetAddress.getByName("230.0.0.1");
    //Join the UDP list port
    socket.setReuseAddress(true);
    socket.joinGroup(address);

    DatagramPacket packet;
    view.setVisible(true);           // Display Screen

    System.out.println("Connected");
    //Id is sent here.

    while(true)
    {

        //Send data to server
        try
        {
            byte[] receiveBuf = new byte[256];

            //Gather data
            receiveBuf = "testing".getBytes();
            //System.out.println(buf.toString());

            //Send data
            packet = new DatagramPacket(receiveBuf, receiveBuf.length, InetAddress.getByName("230.0.0.1"), port);
            socket.send(packet);

            //Sleep the server
        }
        catch (IOException e)
        {
            e.printStackTrace();
        }

        byte[] buf = new byte[256];
        packet = new DatagramPacket(buf, buf.length);
        socket.receive(packet);

        String  received = new String(packet.getData(), 0, packet.getLength());
        //System.out.println("Server data: " + received);

        String[] posValues = received.split(":");

        model.getBall().setX(Double.parseDouble(posValues[0])); // <-- Line 71
        model.getBall().setY(Double.parseDouble(posValues[1]));
        model.getBats()[0].setX(Double.parseDouble(posValues[2]));
        model.getBats()[0].setY(Double.parseDouble(posValues[3]));
        model.getBats()[1].setX(Double.parseDouble(posValues[4]));
        model.getBats()[1].setY(Double.parseDouble(posValues[5]));

        //Check for keyboard input

        if(PongController.moveUp == true && PongController.moveDown == false)
        {
            System.out.println("Up");
            PongController.moveUp = false;
        }
        else if(PongController.moveUp == false && PongController.moveDown == true)
        {
            System.out.println("Down");
            PongController.moveDown = false;
        }
        else
        {
            //serverOut.println("nothing");
        }

    }
}

} 
```

一直坚持这一点，似乎找不到任何关于如何使用多播将数据包从客户端发送到服务器的教程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-03T00:44:51.433

您正在经历多播环回。用 关闭它`MulticastSocket#setLoopbackMode(true)`，或者，如果该对等点只是发送到多播组，而不是接收，则根本不需要加入该组。

# sublimetext2 - 如何在 Sublime Text 2 和 3 中使用带键盘的侧边栏？

> ID：15178358
> 
> 赞同：159
> 
> 时间：2013-03-02T19:18:12.177
> 
> 标签：sublimetext2, keyboard-shortcuts, sublimetext3, sublimetext, text-editor

使用*Sublime Text 2*时，我们倾向于打开*侧​​栏*来浏览项目中的文件/文件夹。为此，我们可以使用热键*ctrl+k ctrl+b*（在 Windows 中）。

但是，一旦我们进入*侧栏*，我们就不**能将它与键盘一起使用**（例如箭头）。我们必须坚持使用我们自己的鼠标...

**请注意**：我安装了 SideBarEnhancements 插件，但没有找到任何可以解决我的问题的东西。

您可能知道的任何解决方案？

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2013-03-02T20:36:47.993

您可以键入`Ctrl`+ `0`( `Ctrl`+ `Zero`) 以专注于侧栏。

然后，您将能够使用箭头键在文件之间移动选择并打开选定的文件`Enter`，而无需触摸鼠标。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2014-02-19T14:04:24.150

另一个有用的快捷方式：`ctrl`+`k`与`ctrl`+一起`b`显示/隐藏侧边栏。确保你按正确的顺序`K`打`B`

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2015-06-03T16:39:36.810

我没有找到任何其他完整的答案，所以我从各种答案中收集信息并添加了一些我自己的。

*   `Ctrl`+ `K`, `Ctrl`+ `B`: 切换侧边栏
*   `Ctrl`+ `K`+ `B`：上述的缩写形式（确保您按正确`K`的`B`顺序点击）
*   `Ctrl`+ `0`：将焦点切换到侧边栏（如果打开）
*   `Up`/ `Down`: 导航文件列表
*   `Right`: 展开目录
*   `Left`：折叠目录/导航到父目录
*   `Enter`: 打开一个文件

@Santiago Agüero 您缺少的部分是侧边栏需要焦点，然后箭头键才能起作用（`Ctrl`+ `0`）。

据我所知，这些快捷键都可以在 Sublime 3 和 Sublime 2 中使用。

一个警告：这些假设您使用的是默认键绑定。`Preferences > Key Bindings - User`但是您可以通过从 中打开和复制行来轻松自定义键绑定，并根据需要`Preferences > Key Bindings - Default`更改`keys`值。例如，

```
{ "keys": ["ctrl+k", "ctrl+b"], "command": "toggle_side_bar" },
{ "keys": ["ctrl+0"], "command": "focus_side_bar" }, 
```

PS 要获得漂亮的键盘字形，请使用`<kbd>`HTML 标记。例如，`<kbd>Key</kbd>`将变成`Key`. （感谢[https://meta.stackexchange.com/questions/5527](https://meta.stackexchange.com/questions/5527)）:)

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2014-07-20T15:35:55.640

**概括**

`Ctrl + 0`将导航到您的侧边栏。默认情况下，您可以使用箭头键浏览文件夹。如果您更喜欢 'Vim' 类型的设置，您可以通过将键重新映射到典型的 Vim 设置 (hjkl) 来避免使用箭头键。

*   **h**将最小化/打开一个文件夹
*   **j**将向下导航（即向下箭头）
*   **k**将向上导航（即向上箭头）
*   **我**会打开一个文件夹
*   **输入**将打开文件

**键映射**

要进行设置，请打开`Preferences > Key Bindings - User`并添加以下内容：

```
{ "keys": ["h"], "command": "move", "args": {"by": "characters", "forward": false}, "context":
    [ {"key": "control", "operand": "sidebar_tree"} ] },
{ "keys": ["j"], "command": "move", "args": {"by": "lines", "forward": true}, "context":
    [ {"key": "control", "operand": "sidebar_tree"} ] },
{ "keys": ["k"], "command": "move", "args": {"by": "lines", "forward": false}, "context":
    [ {"key": "control", "operand": "sidebar_tree"} ] },
{ "keys": ["l"], "command": "move", "args": {"by": "characters", "forward": true}, "context":
    [ {"key": "control", "operand": "sidebar_tree"} ] } 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-07-12T11:09:19.733

Ctrl+p 对于不使用鼠标打开文件也非常有用。

如果您在 Sublime 中打开一个文件夹，该文件夹中的所有文件（以及包含的文件夹中的文件）将显示在您使用 Ctrl+p 获得的搜索中。

只需按 Ctrl+p 并开始输入部分文件名，您将获得匹配列表。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2015-09-18T11:07:43.077

对于**崇高文本 3**使用`Ctrl`+ `K`+`B`

按住`Ctrl`然后按住`K`然后按住`B`

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-12-19T21:36:31.973

对于 Windows 上的 Sublime Text 2（以及 Sublime Text 3），使用`Ctrl+0`焦点在侧栏上，使用`Ctrl+1`或`Esc`键焦点在编辑器上。如果它不起作用，请使用功能键行下的数字键行中存在的那些和键，而不是`0`键盘的数字小键盘中存在的那些和键。此图像可能会更好地展示：http://en.wikipedia.org/wiki/File: [Qwerty.svg](http://en.wikipedia.org/wiki/File:Qwerty.svg)`1``0``1`

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-12-17T14:02:36.020

在 Sublime Text2 中，按以下格式“Ctrl+k+b”按键，它将在 ubuntu 上运行。

它在我的机器上运行（v14.04 LTS）

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-06-11T17:50:16.860

我实际上有同样的问题，我必须触发`reveal in side bar`然后将焦点移动到侧边栏，以及如果文件的文件夹已经展开，焦点会移动到侧边栏的顶部，这一切让我写了一个新插件可在侧边栏中显示文件，然后将焦点移到那里，使使用键盘箭头导航侧边栏变得更加容易，试一试 =)

[https://github.com/miguelgraz/FocusFileOnSidebar](https://github.com/miguelgraz/FocusFileOnSidebar)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-10-29T06:29:21.970

另一种选择是使用 FileBrowser 包，它为您提供更多操作，并且可以根据您的需要进行修改。

[https://packagecontrol.io/packages/FileBrowser](https://packagecontrol.io/packages/FileBrowser)

[![在此处输入图像描述](../Images/38b0a057f4377a1f6f633df3d13ac8c7.png)](https://i.stack.imgur.com/6u6SZ.png)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-08-08T17:10:25.510

您必须在 Sublime Text 窗口中添加一个文件夹才能通过侧边栏导航。转到 File -> Open Folder... 并选择您希望能够导航的最高目录。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-05-05T15:30:57.473

`Ctrl + 0`将重点放在侧边栏上。
`Ctrl + 1`将专注于第一个窗口中的编辑器。
`Ctrl + 2`将专注于第二个窗口中的编辑器等
。Sandeep 发表了一篇关于改进键盘快捷键打开/关闭侧边栏的精彩帖子。
转到 Preference->Key Binding 并输入：

```
[
    { "keys": ["ctrl+\\"], "command": "toggle_side_bar" },
] 
```

保存它，然后按`"ctrl+\"`切换侧边栏。

在 Linux 中，新的键绑定保存在 ~/.config/sublime-text-3/Packages/User/'Default (Linux).sublime-keymap' 中。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-05-11T04:18:45.417

在 Preference->Key Binding 上输入此简码

```
[
    { "keys": ["ctrl+\\"], "command": "toggle_side_bar" },
] 
```

现在保存它按 `"ctrl+\\"`切换侧边栏

# ssl - 使用 Rapidssl heroku DNSimple rails 应用程序添加 Ssl

> ID：15178362
> 
> 赞同：1
> 
> 时间：2013-03-02T19:18:19.720
> 
> 标签：ssl, heroku, dnsimple

我正在关注[本教程](http://www.scottw.com/heroku-ssl-and-dnsimple)并阅读了[这些](https://stackoverflow.com/questions/6931041/heroku-ssl-error-key-doesnt-match-pem-certificate)问题，但仍然无法正确配置我购买的 ssl 证书。在上面引用的教程中从第 5 步运行命令并获得一个

```
!    App not found 
```

错误形式heroku。这是我在 heroku 中设置的域列表（顺便说一句，当我运行时也`heroku domains`遇到无资源错误......）。

```
mydomain.herokuapp.com
mydomian.com
secure.mydomain.com
www.mydomian.com 
```

我所有的 dnsimple 的 cnames 记录如下。

`mydomian.com`指着`proxy.herokuapp.com`

`www.mydomian.com`指着`proxy.herokuapp.com`

`secure.mydomain.com`指着`proxy.herokuapp.com`

我已经添加了 heroku ssl 插件，我在 heroku GUI 中的应用程序名称是`mydomain`，并且按照上面教程中的步骤 1-4 我相信我已经正确配置了 ssl 端。我不确定我在这里缺少什么来获得上述错误？

感谢您对此的关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:53:06.523

对于那些处于类似情况的人来说，这是问题所在 -

阅读这篇文章后，我用我给应用程序指定的新名称更新了我的 .git 文件。这就是为什么我收到`no resource found`上面的奇怪错误。

在此之后，我只是从这里[https://devcenter.heroku.com/articles/ssl-endpoint#upload-certificates](https://devcenter.heroku.com/articles/ssl-endpoint#upload-certificates)开始关注 heroku 文档，因此偏离了我上面引用的博客教程，并且一切似乎都配置正确。

如果你正在经历同样的过程`RapidSSL, heroku, DNSimple`。如果您有兴趣快速启动并运行它，我强烈建议您遵循上面引用的博客教程并阅读此处链接的 heroku 文档。

我希望这有助于为将来的人节省一些时间。

# flash - 将 SWFLoader 与 Flex 一起使用

> ID：15178363
> 
> 赞同：2
> 
> 时间：2013-03-02T19:18:25.290
> 
> 标签：flash, apache-flex, air, flashdevelop

我正在创建一个 Air 桌面应用程序。我使用 Flash Player 10、ActionScript 3.0 从 FLA 编译了一个 SWF 文件。

我现在正试图通过 FlashDevelop 使用 mxml 将 SWF 拉入我的桌面应用程序。

但是，每当我运行我的应用程序时，我的 mxml 都会正确运行，但 SWF 没有像我预期的那样被导入；我收到一个空白屏幕，尽管尺寸似乎是正确的。

这是我从 FlashDevelop 生成的默认值更改的 mxml 代码：

```
<?xml version="1.0"?> 
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"> 

    <mx:SWFLoader width="950" height="500" source="..\..\..\bin\Gameseed.swf" /> 

</mx:Application> 
```

原始代码（由 FlashDevelop 生成）：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/halo">

    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>

</s:Application> 
```

我在某处读到 SWFLoader 仅用于次要用户交互和动画；我的 SWF 只是一个带有按钮的背景图像，所以当我开始添加更多电影剪辑（例如多个屏幕）时，我不确定这是否会成为未来的问题......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:12:17.880

您可能遇到了**Sandbox Security Violation**，请使用**Flash Player 调试器**检查实际的错误代码和消息。一些常见的问题是：

*   正如@flextras 建议的那样，您的应用没有找到 SWF

*   您没有使用正确的**编译器参数**编译应用程序或 SWF 以进行本地文件访问或 AIR 沙盒设置。例如，检查Air file和[flex: loading local flash file](https://stackoverflow.com/questions/1856146/flex-loading-local-flash-file?rq=1)[上的安全沙箱违规以](http://forums.adobe.com/message/4987642)获取更多信息和一些可能的修复。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T19:21:22.903

我发现我的问题与我的 SWF 文件有关。我所拥有的是我的场景中有一个影片剪辑，其中包含多层进一步的影片剪辑，因为我认为我可以通过它们的实例名称访问它们。当我删除这种嵌套方法时，编译器似乎很高兴。就最佳实践而言，我应该为我的应用程序的每个“页面”设置一个单独的 SWF，还是在 flex 中构建整个应用程序？感谢@www.Flextras.com 和@danii！

# java - JMX HTML 适配器

> ID：15178364
> 
> 赞同：1
> 
> 时间：2013-03-02T19:18:26.500
> 
> 标签：java, jmx

我正在寻找一种简单直接的方法来向应用程序添加 JMX 功能，最好通过 http 公开。下面是简单的代码片段，我怀疑它应该在 8000 上运行 http 服务器。我应该能够通过`http://localhost:8000`. 但是页面无法打开。我找不到正确的文档它应该如何工作。

jmxtools-1.2.jar 包含在类路径中。Java 版本 - 1.6

```
import javax.management.MBeanServerFactory;
import javax.management.ObjectName;
import com.sun.jdmk.comm.HtmlAdaptorServer;

public class JmxHttpAdapter {
    public static void main(String[] args) {
        try {
            com.sun.jdmk.comm.HtmlAdaptorServer adapter = new HtmlAdaptorServer(8000);
            MBeanServerFactory.createMBeanServer().registerMBean(adapter, new ObjectName("Adaptor:name=html,port=8000"));
            adapter.start();
            Thread.sleep(100000);
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:17:36.783

不确定为什么该适配器不起作用，但您可以在[Java Dynamic Management Kit 5.1 Tools Reference Guide](http://docs.oracle.com/cd/E19698-01/816-7608/index.html)的第 2 章中找到文档。

MX4J 也有一个[HTTP 适配器](http://mx4j.sourceforge.net/docs/ch03s23.html)，它也有点旧，但您可能会发现它有更好的文档记录。

你应该看看[Jolokia](http://www.jolokia.org/)。它更现代，仍在积极发展中。它是一个基于 HTTP 的 REST 代理，具有多个安装选项，包括[WAR](http://www.jolokia.org/jolokia-agent-parent/jolokia-war/index.html)和[Java 代理](http://www.jolokia.org/jolokia-agent-parent/jolokia-jvm/index.html)。尽管您可以使用很多工具，但这并不能为您提供 UI。同一位开发人员正在为 Jolokia 开发一个名为[Aji](https://github.com/rhuss/aji)的 UI 项目，但我不确定现在处于什么状态。

以下是为 Aji 构建的 UI 的一些参考：

*   [Jolokia + Highcharts = 人类的 JMX](http://nurkiewicz.blogspot.com/2011/03/jolokia-highcharts-jmx-for-human-beings.html)
*   [JMX over HTTP 与 Jolokia 和 javascript](http://jmwikblom.blogspot.com/2012/10/jmx-over-http-with-jolokia-and.html)

# ios - 从 UITextField 中的第一个单词中删除前导空格

> ID：15178366
> 
> 赞同：1
> 
> 时间：2013-03-02T19:18:36.683
> 
> 标签：ios, objective-c, string, uitextfield, whitespace

我有一个表格视图，其中最后一行是 UITextField 并且用户应该输入名字和姓氏。

我想做的是删除或限制名字（第一个单词）之前的任何空格。接下来，我想允许用户使用空格。我怎样才能做到这一点？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:29:35.757

可能你应该实现一个方法来监听 UITextField 中的文本变化。使用

> [textField addTarget:self action:@selector(textFieldDidChange:) forControlEvents:UIControlEventEditingChanged];

因此，您应该知道每当用户在 UITextFiled 中输入一个字符时，您可以检查用户是否输入了空格，删除该空格并提示用户再次写入。

以下是在调用 textFieldDidChange: 时删除用户输入的最后一个字符的方法，并且您检查了用户是否输入了空格

```
if ( [myString length] > 0)
{
     myString = [myString substringToIndex:[string length] - 1];
} 
```

# linux-device-driver - linux设备驱动程序库不可用

> ID：15178372
> 
> 赞同：0
> 
> 时间：2013-03-02T19:19:04.533
> 
> 标签：linux-device-driver

嗨，我的 LInux 操作系统上的 /usr/src/kernels 文件夹中没有可用的 linux 设备驱动程序库。我可以添加或加载它吗，如果可以，如何操作。我需要它来开发设备驱动程序。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T11:03:39.880

您需要内核头文件来编译模块/驱动程序。

在 Fedora 上，您可以使用以下命令

```
yum install kernel-devel 
```

在 Ubuntu 上，您可以使用以下命令

```
sudo aptitude install linux-headers-`uname -r` 
```

或者您也可以从 kernel.org 获取整个内核源代码/头文件

# vector - 3d 矢量是否位于 4 面金字塔中？

> ID：15178374
> 
> 赞同：1
> 
> 时间：2013-03-02T19:19:26.580
> 
> 标签：vector, 3d, geometry

我有一个问题在谷歌或论坛上没有找到答案，因此决定在这里寻求帮助。

我是一位经验丰富的程序员，在各种平台上取得了许多成功，但直到现在我才使用/需要很多数学。

现在我需要知道如何构建一个接收 5 个点（4 面金字塔）数组和一个向量的函数。问题是这个 3d 矢量是否位于金字塔内部。

该函数最终将用（单声道）C# 编写，但如果您有其他语言的提示或代码，或者您可以帮助使用简单的数学，这也绝对可以。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-03T00:39:38.543

向量从不在任何东西内部。我猜你的意思是你有一个 3D 点，而不是 3D 矢量。

在这种情况下，一个简单的解决方案（适用于任何凸多面体）是在考虑金字塔的每个面时检查您的点是否在正确的半空间上。

具体来说，在金字塔的第一个面上取两个向量（例如，两条边）并形成第三个向量，其中包含该面上的一个点（例如，一个顶点）和要测试的点。使用混合积的符号（即，取两条边的叉积，得到一个与金字塔面正交的向量，并用点积检查该法线是否与第三个向量的方向相同），你可以确定你的观点在哪一边。

对所有面重复该过程可以得出结论。

# c# - 遍历实体框架中的一对多关系

> ID：15178379
> 
> 赞同：3
> 
> 时间：2013-03-02T19:19:43.830
> 
> 标签：c#, linq-to-sql, webforms, entity-framework-5, asp.net-4.5

我无法弄清楚如何在使用 EF 5 的 asp.net 站点中使用 LINQ-To-SQL 遍历一对多关系。我已经在类文件中建立了关系，但是当我尝试从父级到子级时在我的 where 子句中，我没有得到要过滤的子列的列表。谁能告诉我我的代码有什么问题，我是 EF 和 LINQ 的新手。

产品.cs：

```
 public class Product
{
    public int Id { get; set; }
    public string Name { get; set; }
    public virtual Category Category { get; set; }
} 
```

}

类别.cs：

```
 public class Category
{
    public int Id { get; set; }
    public string Name { get; set; }
    public virtual IList<Product> Products { get; set; }
} 
```

代码隐藏：

```
 using (var db = new Compleate())
        {
            rpBooks.DataSource = (from c in db.Categories
                                  where c.Products.Name == "Books"
                                  select new
                                  {
                                      c.Name
                                  }).ToList();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T18:30:17.260

您想要书籍类别中的所有产品吗？

```
from p in db.Products
where p.Category.Name == "Books"
select new
{
    p.Name
} 
```

或者您是否希望所有类别都包含称为书籍的产品？

```
from c in db.Categories
where c.Products.Contains( p => p.Name == "Books")
select new
{
    c.Name
} 
```

顺便说一句，如果您只选择名称，则可以跳过选择部分中的匿名类型...

```
select p.name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T18:14:05.940

好的，我必须将代码隐藏更新为：

```
 using (var db = new Compleate())
        {
           rpBooks.DataSource = (from c in db.Categories
                              join p in db.Products on c.ID equals p.id
                              where c.Products.Name == "Books"
                              select new
                              {
                                  c.Name
                              }).ToList();

        } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-02T19:26:05.207

应该`name = c.Name`不是遍历的问题，而是语法的问题，请在此处阅读[有关匿名类型的简短文章](http://msdn.microsoft.com/en-us/library/vstudio/bb397696.aspx)

# java - Eclipse 的环境变量

> ID：15178381
> 
> 赞同：0
> 
> 时间：2013-03-02T19:19:58.440
> 
> 标签：java, windows, eclipse

我为 JDK: 创建了一个路径环境变量`C:\Program Files (x86)\Java\jdk1.7.0_01\bin`，但是当我尝试打开 Eclipse 时出现错误：

`"Failed to load the JNI shared library "C:\Program Files (x86)\Java\jdk1.7.0_01\bin\..\jre\bin\client\jvm.dll"`.

我的 JDK 和 Eclipse 都是 64 位的。为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:35:51.763

这是一个常见的问题。

1.首先检查你的Eclipse是64位还是32位。

2.然后下载32位或64位JDK。

3.设置路径：

复制链接位置：

对于 64 位： `C:\Program Files\Java\jdk1.7.0_05\bin`

对于 32 位： `C:\Program Files (x86)\Java\jdk1.7.0_05\bin`

4.转到->系统属性->高级系统设置->环境变量->新建->变量名：PATH变量值：`C:\Program Files\Java\jdk1.7.0_05\bin`

变量值取决于 32 或 64 位系统。

5.重要32位Eclipse = 32位Java SDK 64位Eclipse = 64位Java SDK

如果这个问题仍然存在，请访问[eclipse.org](http://www.eclipse.org/forums/index.php/t/171274/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:34:16.497

确保一切都是 64 位版本

64 位操作系统

64 位 Java

64 位日食

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T19:28:58.887

请检查 eclipse.ini 中的 -vm 参数。它必须指向 java 可执行文件。请参阅[http://wiki.eclipse.org/Eclipse.ini](http://wiki.eclipse.org/Eclipse.ini)以获得更好的理解。

# oop - 为什么我们同步惰性单例而不是热切单例？

> ID：15178382
> 
> 赞同：3
> 
> 时间：2013-03-02T19:20:03.790
> 
> 标签：oop, synchronization, singleton, lazy-initialization

典型的懒惰单例：

```
public class Singleton {
    private static Singleton INSTANCE;

    private Singleton() {

    }

    public static synchronized Singleton getInstace() {
        if(INSTANCE == null)
            INSTANCE = new Singleton();

        return INSTANCE;
    }
} 
```

典型的热切单身人士：

```
public class Singleton {
    private static Singleton INSTANCE = new Singleton();

    public static Singleton getInstance() {
        return INSTANCE;
    }
} 
```

为什么我们不关心与热切单例的同步，而不得不担心与他们的懒表亲的同步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T11:56:33.973

Eager 实例化不需要**显式**同步来共享字段的引用，因为 JVM 已经作为类加载机制的一部分为我们处理了它。

更详细地说，在一个类可供任何线程使用之前，它会被加载、验证和初始化。编译器将静态字段分配重写到此初始化阶段，并通过 Java 内存模型的规则和底层硬件架构将确保访问该类的所有线程都将看到该版本的类。这意味着 JVM 将为我们处理任何硬件障碍等。

也就是说，我建议将急切初始化标记为final。这将使您的意图更加清晰，并且编译器将强制执行急切初始化永远不会改变。如果是这样，那么将再次需要并发控制。

```
private static **final** Singleton INSTANCE = new Singleton(); 
```

[仅供参考，如果您有兴趣， Java 虚拟机规范](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-5.html#jvms-5.5)的第 5.5 节会更详细地介绍这一点。规范中的几个选择片段是

```
*"Because the Java Virtual Machine is multithreaded, 
initialization of a class or interface requires careful 
synchronization"*

*"For each class or interface C, there is a unique initialization lock LC"*

*9&10) "Next, execute the class or interface initialization method of C"
"If the execution of the class or interface initialization 
method completes normally, then acquire LC, label the Class object for 
C as fully initialized, notify all waiting threads, release LC, and 
complete this procedure normally."* 
```

在规范的第 10 步中将设置静态字段，并使用锁 (LC) 来确保只有一个线程执行初始化并正确共享结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:22:58.063

因为当类第一次加载到内存（jit）时会初始化一个急切的单例，这只会发生一次。但是，如果两个客户端尝试同时从两个线程调用单例实例方法，则可能会创建两个单例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T19:26:49.427

因为在后一个示例中，单例的实例在`getInstance`被调用时总是存在的——这里没有什么要同步的。这与第一个示例相反，其中实例还没有必要初始化。在这种情况下，包含需要保护（例如通过同步）以防止同时访问的`getInstance`关键部分（及其主体）。`if`

# ios - ViewController 链接到不同项目的情节提要？

> ID：15178388
> 
> 赞同：0
> 
> 时间：2013-03-02T19:20:56.123
> 
> 标签：ios, xcode, ios5, ios6

我有一个 ViewController 类，它是旧 xcode 项目中 UIViewController 的子类。我想在新项目中使用相同的 ViewController 类，因此我将 .h 和 .m 文件复制到该项目的文件夹中。但是，当我查看 .h 文件时，IBOutlets 会自动链接到旧项目的情节提要。我在 .h 或 .m 文件中没有看到任何指向旧项目的情节提要文件的内容。为什么会这样？难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T04:19:44.723

连接（编辑器左侧的小圆圈）是由故事板或 xib 文件而不是由 .h 或 .m 文件建立的。

打破这种联系的最简单的解决方案是更改类名（NewViewController 或类似的东西）。如果这会产生太多问题，您可以更改所有连接的名称，这也会断开连接。

基本上，只要找到一种方法让编辑器左侧的圆圈为空而不是满。

# php - 如何过滤波斯语字符的输入？

> ID：15178393
> 
> 赞同：6
> 
> 时间：2013-03-02T19:21:20.367
> 
> 标签：php, regex

我只想为波斯语过滤输入，我认为正则表达式 with`filter_input()`是个好主意，但我不知道如何解决这个问题，我已经搜索但我没有找到像 \p{Arabic} 这样的波斯语或波斯语字符另一方面，它可以使用[Unicode](http://www.tamasoft.co.jp/en/general-info/unicode.html)，但我不知道它的正则表达式。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-04T14:14:47.180

这应该工作：

`preg_match("(^[\x{0600}-\x{06FF}]*$)", 'فارسی');`

您还可以将所有这些形式用于波斯语：

**波斯字母**

> 胡思乱想

```
/^([\x{0600}-\x{06EF}])+$/ 
```

**波斯数字**

> 123445677890

```
/^([\x{06F0}-\x{06F9}])+$/ 
```

**带空格和半空格的波斯文简单文本**

> پیش از طوفان نوح عاشقت می‌شدم</p>

```
/^([\x{0600}-\x{06FF}| |\x{200C}])+$/ 
```

*   [参考](http://php.net/manual/de/function.preg-match.php)

# objective-c - forwardInvocation: 如何被调用？

> ID：15178395
> 
> 赞同：5
> 
> 时间：2013-03-02T19:21:42.353
> 
> 标签：objective-c, nsobject, forwarding, objective-c-runtime, nsinvocation

只看 Objective-C 运行时库，当一个消息被发送到一个不响应它的对象时，运行时系统给了接收者另一个机会来处理这个消息。因此，接收者的`forward::`方法（如果已实现）将被调用。但是，查看[NSObject.mm](http://opensource.apple.com/source/objc4/objc4-532.2/runtime/NSObject.mm)，`NSObject`似乎没有实现`forward::`。

那么，如何调用`NSObject`'s`forwardInvocation:`方法，因为运行时系统在需要转发时唯一调用的是`forward::`？Foundation 是否使用`objc_setForwardHandler`( [runtime.h](http://opensource.apple.com/source/objc4/objc4-532.2/runtime/runtime.h) ) 设置一个新的处理程序，该处理程序在需要转发`forwardInvocation:`发送到对象的消息时调用？`NSObject`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-02T20:19:20.203

在过去的某个时间点，Objective-C 运行*时*`NSObject`中没有。当 Brad Cox 和 Tom Love 首次创建该语言时，他们添加了一个名为`Object`. 这已实现`[Object forward::]`，用于进行消息转发。

几年后，NextStep 出现并为该语言添加了自己的内容，创建了 OpenStep 框架（后来成为 Cocoa）。NextStep 摆脱了`Object`该类，并将其替换为`NSObject`. 所做的更改之一是将`forward::`方法替换为`forwardInvocation`. 该`Object`课程仍在源代码中进行（如您所见），但我很确定它在 iOS 或 64 位 OS X 应用程序中均不可用。

您正确地建议 that `objc_setForwardHandler`is used 表示`forwardInvocation`应该使用而不是`forward::`for all `NSObjects`。恐怕我不确定基金会何时调用它......我猜想在`NSObject`初始化时。我也没有大量关注底层的运行时实现，但希望这至少会*有所*帮助？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T14:52:22.277

这篇[SO 帖子](https://stackoverflow.com/questions/4574465/objective-c-respondstoselector-question)对您的问题有更详细的回答，即当消息发送到不响应的对象时会发生什么。

# ruby-on-rails-3 - 如何在 link_to Rails 3 中同时使用 :onclick 和 :confirm ？

> ID：15178398
> 
> 赞同：1
> 
> 时间：2013-03-02T19:21:54.873
> 
> 标签：ruby-on-rails-3, onclick, link-to, confirm

在用户确认后，我试图隐藏`div`点击。

我有这样的事情：

```
<%= link_to 'X', user, :method => :delete, :remote => true, :class => 'delete_link', :onclick => "jQuery('#user_#{user.id}').hide();" %> 
```

每当单击“x”时，我都会弹出确认消息，但不会执行 onclick 事件。
我想隐藏`div`用户`Yes`在弹出窗口中给出的任何时候。我如何在 Rails 3 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-12T21:48:24.330

您可以通过这种方式点击后立即隐藏。

```
$('.delete-item[data-remote]')
        .data('type', 'html')
        .on('ajax:before', function(event, data) {
            $(this).closest('.item').remove();
        }); 
```

如果您想等到响应返回，请将 'ajax:before' 替换为 'ajax:success'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:38:34.817

您可以使用其他方式，而不是 rails 3 方式。您可以通过拥有`destroy.js.erb`. 并写给你隐藏Jquery代码的div，`#user_#{user.id}').hide();`

希望对你有帮助 ：）

# java - 无法解析类 java.nio.file.FileSystems

> ID：15178402
> 
> 赞同：1
> 
> 时间：2013-03-02T19:22:30.037
> 
> 标签：java, grails, java-7

操作系统 x 10.7

[me@air]> /usr/libexec/java_home -v 1.7

```
/Library/Java/JavaVirtualMachines/jdk1.7.0_13.jdk/Contents/Home

export JAVA_HOME="/usr/libexec/java_home -v 1.7" 
```

[me@air]> 哪个java

```
/Library/Java/JavaVirtualMachines/jdk1.7.0_13.jdk/Contents/Home/bin/java 
```

我想在其中一项服务中使用 Java 1.7 NIO，我得到了以下信息：

```
grails> run-app 
...
| Error Compilation error: startup failed:
/path/to/Acquiring.groovy: 7: unable to resolve class java.nio.file.FileSystems
 @ line 7, column 1.
   import java.nio.file.FileSystems
   ^
/path/to/Acquiring.groovy: 8: unable to resolve class java.nio.file.Path
 @ line 8, column 1.
   import java.nio.file.Path
   ^
2 errors
| Error Error running script run-app : org.codehaus.groovy.grails.cli.ScriptExitException (Use --stacktrace to see the full trace) 
```

怎么回事！他妈的！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T16:01:16.007

我的猜测是，如果你运行 echo $JAVA_HOME，它会设置为旧版本的 Java。Maven（我认为是 Grails）等一些工具使用 JAVA_HOME 而不仅仅是路径。

# jquery - 无法读取未定义 SignalR Hub 的属性“chatHub”

> ID：15178408
> 
> 赞同：1
> 
> 时间：2013-03-02T19:23:03.227
> 
> 标签：jquery, asp.net-mvc, signalr, signalr-hub

我正在尝试学习信号器，这个错误是我建立的。

无法读取未定义的属性“chatHub”。

```
$(document).ready(function () {
        var chat = $.connection.chatHub;
        $.connection.hub.start();
 }); 
```

和集线器文件是：

```
namespace TestSignalR.Web.Hubs
{
public class ChatHub : Microsoft.AspNet.SignalR.Hub
{
    public void Send(string msg)
    {
        ChatData chat = new ChatData();
        chat.Msg = msg;
        chat.UserName = HttpContext.Current.User.Identity.Name;
        chat.Date = "♣ at " + DateTime.Now.ToString("hh:mm tt");
        Clients.All.broadCastMessage(chat);
    }
}
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-02T19:24:59.213

`<HEAD>`可能在您的文档中缺少这一行：

```
<script src="/signalr/hubs" type="text/javascript"></script> 
```

检查你也有

```
 <script src="/Scripts/jquery.signalR-1.0.0.js"></script> 
```

并使用 Fiddler 或 Chrome 开发人员工具检查两个文件是否正在加载，以及 /hubs 文件是否包含您期望它包含的集线器定义内容。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-03-28T22:00:18.027

由于 MVC 如何尝试提供帮助并呈现 jquery 包，我似乎总是遇到这个问题。然后，当您尝试在视图中添加信号器时，它将失败，因为您必须事先添加 jquery，但 jquery 会被 MVC 包再次加载。这会混淆看起来的东西并导致错误。您可能会在主布局页面中有此部分：

```
@Scripts.Render("~/bundles/jquery")
@RenderSection("scripts", required: false) 
```

因此，如果您将脚本添加到脚本部分，它应该会让信号器高兴并且工作正常。

```
@section scripts {
    <!--Reference the SignalR library. -->
    <script src="Scripts/jquery.signalR-2.0.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="signalr/hubs"></script>
    <!--Add script to update the page and send messages.--> 
    <script type="text/javascript">
        $(function () {
            // Declare a proxy to reference the hub. 
            var chat = $.connection.chatHub;
            // Create a function that the hub can call to broadcast messages.
            chat.client.broadcastMessage = function (name, message) {
                // Html encode display name and message. 
                var encodedName = $('<div />').text(name).html();
                var encodedMsg = $('<div />').text(message).html();
                // Add the message to the page. 
                $('#discussion').append('<li><strong>' + encodedName
                    + '</strong>:&nbsp;&nbsp;' + encodedMsg + '</li>');
            };
            // Get the user name and store it to prepend to messages.
            $('#displayname').val(prompt('Enter your name:', ''));
            // Set initial focus to message input box.  
            $('#message').focus();
            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#sendmessage').click(function () {
                    // Call the Send method on the hub. 
                    chat.server.send($('#displayname').val(), $('#message').val());
                    // Clear text box and reset focus for next comment. 
                    $('#message').val('').focus();
                });
            });
        });
    </script>
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-30T09:48:42.897

对于所有拥有正确 dll 但即使解决方案不起作用的人的解决方案是更改函数名称的大小写。

就像我的班级名称是 TestAHub

但改为testAHub。

您实际上需要打开这个 js "/signalr/hubs" 来检查名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-24T17:29:08.597

检查你有 app.MapSignalR(); 在您的 Startup.cs 文件上。[在http://www.asp.net/signalr/overview/releases/upgrading-signalr-1x-projects-to-20](http://www.asp.net/signalr/overview/releases/upgrading-signalr-1x-projects-to-20)上查看更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-20T13:45:12.853

尝试本教程后我面临同样的问题：[https ://docs.microsoft.com/en-us/aspnet/signalr/overview/getting-started/tutorial-getting-started-with-signalr](https://docs.microsoft.com/en-us/aspnet/signalr/overview/getting-started/tutorial-getting-started-with-signalr)

我认识到缺少一条指令：

> ```
> using System;
> using System.Threading.Tasks;
> using Microsoft.Owin;
> using Owin;
> 
> [assembly: OwinStartup(typeof(signalChat.Startup))]
> 
> namespace signalChat
> {
>     public class Startup
>     {
>         public void Configuration(IAppBuilder app)
>         {
>             app.MapSignalR(); // add this 
>         }
>     }
> } 
> ```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-02T16:17:10.060

我在使用 Firefox 时遇到了问题，在我的情况下，我使用的是 https，而在 dev 中它不存在，所以我收到了错误，因为 https 的异常没有注册。只需访问信号器服务器并添加它。

# java - 尝试将 JBoss 快速入门教程迁移到 mysql

> ID：15178411
> 
> 赞同：0
> 
> 时间：2013-03-02T19:23:25.770
> 
> 标签：java, mysql, jakarta-ee, jboss7.x

我一直在学习一些 JBoss 快速入门教程。目前，我正在尝试调整迎宾教程（可在此处找到 - [http://www.jboss.org/jdf/quickstarts/jboss-as-quickstart/greeter/](http://www.jboss.org/jdf/quickstarts/jboss-as-quickstart/greeter/)) 这样我就可以用 mysql 替换默认的 H2 数据库。我已经对standalone.xml 文件进行了必要的配置更改。我创建了一个模块并将连接器 jar 放在它旁边。我还更改了项目的 persistence.xml 文件。但是，当我运行该项目时，我遇到了许多错误。请有人查看下面的日志文件并尝试找出可能导致问题的原因。请注意，我已经从控制台粘贴了错误日志。在此之下，我包含了standalone.xml、persistence.xml 和greeter-quickstart-ds.xml 的粘贴。我在 GIT 上托管了代码 - [https://github.com/bosra/greeter](https://github.com/bosra/greeter)。提前致谢

```
JBAS014775:    New missing/unsatisfied dependencies:
      service jboss.jdbc-driver.mysql (missing) dependents: [service jboss.data-source.java:jboss/datasources/MySqlDS] 

23:59:49,141 ERROR [org.jboss.as] (Controller Boot Thread) JBAS015875: JBoss AS 7.1.0.Final "Thunder" started (with errors) in 2660ms - Started 135 of 209 services (2 services failed or missing dependencies, 70 services are passive or on-demand)

23:59:50,443 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implClass=org.jboss.shrinkwrap.resolver.impl.maven.MavenBuilderImpl' for service type 'org.jboss.shrinkwrap.resolver.api.maven.MavenDependencyResolver'
23:59:50,445 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.ConfigurableArchiveImpl' for service type 'org.jboss.shrinkwrap.spi.Configurable'
23:59:50,450 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.GenericArchiveImpl' for service type 'org.jboss.shrinkwrap.api.GenericArchive'
23:59:50,451 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'extension=.jar' for service type 'org.jboss.shrinkwrap.api.GenericArchive'
23:59:50,452 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'archiveFormat=UNKNOWN' for service type 'org.jboss.shrinkwrap.api.GenericArchive'
23:59:50,453 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.serialization.ZipSerializableViewImpl' for service type 'org.jboss.shrinkwrap.api.serialization.SerializableView'
23:59:50,455 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.spec.JavaArchiveImpl' for service type 'org.jboss.shrinkwrap.api.spec.JavaArchive'
23:59:50,456 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'extension=.jar' for service type 'org.jboss.shrinkwrap.api.spec.JavaArchive'
23:59:50,457 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'archiveFormat=ZIP' for service type 'org.jboss.shrinkwrap.api.spec.JavaArchive'
23:59:50,458 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.exporter.tar.TarExporterImpl' for service type 'org.jboss.shrinkwrap.api.exporter.TarExporter'
23:59:50,459 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'extension=.tar' for service type 'org.jboss.shrinkwrap.api.exporter.TarExporter'
23:59:50,460 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.importer.zip.ZipImporterImpl' for service type 'org.jboss.shrinkwrap.api.importer.ZipImporter'
23:59:50,461 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'extension=.jar' for service type 'org.jboss.shrinkwrap.api.importer.ZipImporter'
23:59:50,463 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.importer.tar.TarImporterImpl' for service type 'org.jboss.shrinkwrap.api.importer.TarImporter'
23:59:50,464 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'extension=.tar' for service type 'org.jboss.shrinkwrap.api.importer.TarImporter'
23:59:50,465 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.spec.WebArchiveImpl' for service type 'org.jboss.shrinkwrap.api.spec.WebArchive'
23:59:50,466 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'extension=.war' for service type 'org.jboss.shrinkwrap.api.spec.WebArchive'
23:59:50,474 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'archiveFormat=ZIP' for service type 'org.jboss.shrinkwrap.api.spec.WebArchive'
23:59:50,474 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.exporter.tar.TarGzExporterImpl' for service type 'org.jboss.shrinkwrap.api.exporter.TarGzExporter'
23:59:50,475 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'extension=.tar.gz' for service type 'org.jboss.shrinkwrap.api.exporter.TarGzExporter'
23:59:50,476 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.serialization.ZipSerializableViewImpl' for service type 'org.jboss.shrinkwrap.api.serialization.ZipSerializableView'
23:59:50,478 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.importer.ExplodedImporterImpl' for service type 'org.jboss.shrinkwrap.api.importer.ExplodedImporter'
23:59:50,479 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.spec.ResourceAdapterArchiveImpl' for service type 'org.jboss.shrinkwrap.api.spec.ResourceAdapterArchive'
23:59:50,480 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'extension=.rar' for service type 'org.jboss.shrinkwrap.api.spec.ResourceAdapterArchive'
23:59:50,480 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'archiveFormat=ZIP' for service type 'org.jboss.shrinkwrap.api.spec.ResourceAdapterArchive'
23:59:50,492 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.exporter.ExplodedExporterImpl' for service type 'org.jboss.shrinkwrap.api.exporter.ExplodedExporter'
23:59:50,493 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.spec.EnterpriseArchiveImpl' for service type 'org.jboss.shrinkwrap.api.spec.EnterpriseArchive'
23:59:50,494 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'extension=.ear' for service type 'org.jboss.shrinkwrap.api.spec.EnterpriseArchive'
23:59:50,495 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'archiveFormat=ZIP' for service type 'org.jboss.shrinkwrap.api.spec.EnterpriseArchive'
23:59:50,496 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.importer.tar.TarGzImporterImpl' for service type 'org.jboss.shrinkwrap.api.importer.TarGzImporter'
23:59:50,497 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'extension=.tar.gz' for service type 'org.jboss.shrinkwrap.api.importer.TarGzImporter'
23:59:50,502 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.exporter.zip.ZipExporterImpl' for service type 'org.jboss.shrinkwrap.api.exporter.ZipExporter'
23:59:50,553 INFO  [org.jboss.as.jpa] (MSC service thread 1-1) JBAS011401: Read persistence.xml for primary

23:59:50,774 INFO  [org.hibernate.annotations.common.Version] (MSC service thread 1-6) HCANN000001: Hibernate Commons Annotations {4.0.1.Final}
23:59:50,782 INFO  [org.hibernate.Version] (MSC service thread 1-6) HHH000412: Hibernate Core {4.0.1.Final}
23:59:50,790 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-6) HHH000206: hibernate.properties not found
23:59:50,799 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-6) HHH000021: Bytecode provider name : javassist
23:59:50,803 INFO  [org.jboss.weld.deployer] (MSC service thread 1-1) JBAS016005: Starting Services for CDI deployment: ticket-monster.war
23:59:50,866 INFO  [org.jboss.as.jpa] (MSC service thread 1-2) JBAS011402: Starting Persistence Unit Service 'ticket-monster.war#primary'
23:59:50,865 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-1) JBAS010400: Bound data source [jboss/datasources/ticket-monsterDS]
23:59:50,882 INFO  [org.hibernate.ejb.Ejb3Configuration] (MSC service thread 1-3) HHH000204: Processing PersistenceUnitInfo [
    name: primary
    ...]
23:59:50,882 INFO  [org.hibernate.ejb.Ejb3Configuration] (MSC service thread 1-2) HHH000204: Processing PersistenceUnitInfo [
    name: primary
    ...]
23:59:50,886 INFO  [org.hibernate.ejb.Ejb3Configuration] (MSC service thread 1-6) HHH000204: Processing PersistenceUnitInfo [
    name: loginDatabase
    ...]
23:59:51,146 INFO  [org.hibernate.service.jdbc.connections.internal.ConnectionProviderInitiator] (MSC service thread 1-2) HHH000130: Instantiating explicit connection provider: org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider
23:59:51,146 INFO  [org.hibernate.service.jdbc.connections.internal.ConnectionProviderInitiator] (MSC service thread 1-6) HHH000130: Instantiating explicit connection provider: org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider
23:59:51,147 INFO  [org.hibernate.service.jdbc.connections.internal.ConnectionProviderInitiator] (MSC service thread 1-3) HHH000130: Instantiating explicit connection provider: org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider
23:59:51,414 INFO  [javax.enterprise.resource.webcontainer.jsf.config] (MSC service thread 1-4) Initializing Mojarra 2.1.5 (SNAPSHOT 20111202) for context '/jboss-as-numberguess'
23:59:51,582 INFO  [org.hibernate.dialect.Dialect] (MSC service thread 1-6) HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
23:59:51,582 INFO  [org.hibernate.dialect.Dialect] (MSC service thread 1-2) HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
23:59:51,585 INFO  [org.hibernate.dialect.Dialect] (MSC service thread 1-3) HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
23:59:51,591 WARN  [org.hibernate.dialect.H2Dialect] (MSC service thread 1-2) HHH000431: Unable to determine H2 database version, certain features may not work
23:59:51,593 WARN  [org.hibernate.dialect.H2Dialect] (MSC service thread 1-3) HHH000431: Unable to determine H2 database version, certain features may not work
23:59:51,597 WARN  [org.hibernate.dialect.H2Dialect] (MSC service thread 1-6) HHH000431: Unable to determine H2 database version, certain features may not work
23:59:51,598 INFO  [org.hibernate.engine.jdbc.internal.LobCreatorBuilder] (MSC service thread 1-2) HHH000423: Disabling contextual LOB creation as JDBC driver reported JDBC version [3] less than 4
23:59:51,601 INFO  [org.hibernate.engine.jdbc.internal.LobCreatorBuilder] (MSC service thread 1-6) HHH000423: Disabling contextual LOB creation as JDBC driver reported JDBC version [3] less than 4
23:59:51,601 INFO  [org.hibernate.engine.jdbc.internal.LobCreatorBuilder] (MSC service thread 1-3) HHH000423: Disabling contextual LOB creation as JDBC driver reported JDBC version [3] less than 4
23:59:51,617 INFO  [org.hibernate.engine.transaction.internal.TransactionFactoryInitiator] (MSC service thread 1-2) HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jta.CMTTransactionFactory
23:59:51,617 INFO  [org.hibernate.engine.transaction.internal.TransactionFactoryInitiator] (MSC service thread 1-3) HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jta.CMTTransactionFactory
23:59:51,621 INFO  [org.hibernate.engine.transaction.internal.TransactionFactoryInitiator] (MSC service thread 1-6) HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jta.CMTTransactionFactory
23:59:51,630 INFO  [org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory] (MSC service thread 1-2) HHH000397: Using ASTQueryTranslatorFactory
23:59:51,633 INFO  [org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory] (MSC service thread 1-6) HHH000397: Using ASTQueryTranslatorFactory
23:59:51,633 INFO  [org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory] (MSC service thread 1-3) HHH000397: Using ASTQueryTranslatorFactory
23:59:51,706 INFO  [org.hibernate.validator.util.Version] (MSC service thread 1-2) Hibernate Validator 4.2.0.Final
23:59:51,739 INFO  [org.hibernate.validator.xml.ValidationXmlParser] (MSC service thread 1-2) META-INF/validation.xml found. Parsing XML based configuration.
23:59:52,575 INFO  [org.hibernate.validator.xml.ValidationXmlParser] (MSC service thread 1-2) Using org.hibernate.validator.HibernateValidator as validation provider.
23:59:52,576 INFO  [org.hibernate.validator.xml.ValidationXmlParser] (MSC service thread 1-2) Using org.hibernate.validator.messageinterpolation.ResourceBundleMessageInterpolator as message interpolator.
23:59:52,577 INFO  [org.hibernate.validator.xml.ValidationXmlParser] (MSC service thread 1-2) Using org.hibernate.validator.engine.resolver.DefaultTraversableResolver as traversable resolver.
23:59:52,578 INFO  [org.hibernate.validator.xml.ValidationXmlParser] (MSC service thread 1-2) Using org.hibernate.validator.engine.ConstraintValidatorFactoryImpl as constraint factory.
23:59:52,603 INFO  [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-3) HHH000227: Running hbm2ddl schema export
23:59:52,609 INFO  [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-6) HHH000227: Running hbm2ddl schema export
23:59:52,634 ERROR [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-3) HHH000389: Unsuccessful: drop sequence hibernate_sequence
23:59:52,636 INFO  [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-6) HHH000230: Schema export complete
23:59:52,638 ERROR [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-3) Sequence "HIBERNATE_SEQUENCE" not found; SQL statement:
drop sequence hibernate_sequence [90036-161]

23:59:52,697 ERROR [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-2) HHH000389: Unsuccessful: drop sequence hibernate_sequence
23:59:52,700 ERROR [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-2) Sequence "HIBERNATE_SEQUENCE" not found; SQL statement:
drop sequence hibernate_sequence [90036-161]

JBAS014775:    New missing/unsatisfied dependencies:
      service jboss.jdbc-driver.mysql-connector-java-5_1_18-bin_jar (missing) dependents: [service jboss.data-source.jboss/datasources/GreeterQuickstartDS] 

23:59:53,950 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back
23:59:53,951 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back
23:59:53,952 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back
23:59:53,953 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back
23:59:53,953 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back
23:59:53,954 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back
23:59:53,955 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back
23:59:53,956 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back
23:59:53,957 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) {"JBAS014653: Composite operation failed and was rolled back. Steps that failed:" => {"Operation step-2" => {"JBAS014771: Services with missing/unavailable dependencies" => ["jboss.data-source.jboss/datasources/GreeterQuickstartDSjboss.jdbc-driver.mysql-connector-java-5_1_18-bin_jarMissing[jboss.data-source.jboss/datasources/GreeterQuickstartDSjboss.jdbc-driver.mysql-connector-java-5_1_18-bin_jar]"]}}}
23:59:53,960 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back
23:59:53,961 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T07:12:10.687

最新的异常表明您的 MySQL jar 在 JBoss 的类路径上设置不正确。我会仔细检查您如何将 jar 安装为 JBoss 7 的模块。此链接可能会有所帮助：[https ://community.jboss.org/wiki/DataSourceConfigurationInAS7#Installing_a_JDBC_driver_as_a_module](https://community.jboss.org/wiki/DataSourceConfigurationInAS7#Installing_a_JDBC_driver_as_a_module)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:33:33.753

persistence.xml 中的这一行：

```
<jta-data-source>"java:jboss/datasources/mysql"</jta-data-source> 
```

删除双引号，使其成为：

```
<jta-data-source>java:jboss/datasources/mysql</jta-data-source> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T19:30:32.800

例外是

> 无法解析 XML（JBAS014676：无法解析配置）

In your file "greeter-quickstart-ds.xml", i see a`</datasources>` without a `<datasources>`. Please check if your XML is correct.

# javascript - 为什么单独定义 JS 原型函数比在字典中更快？

> ID：15178417
> 
> 赞同：10
> 
> 时间：2013-03-02T19:24:23.273
> 
> 标签：javascript, performance, prototype

这似乎是一个特别模糊的点，但是我正在尝试提高我在整个 Javascript 语言中的基础（更具体地说，它是最好和最有效的实践）。

[在http://jsperf.com/](http://jsperf.com/)中测试理论时，我得出了一些奇怪的结果：

假设我们有两个“相同”的原型，定义如下：

**对象1**

```
var Object1 = function() {}

Object1.prototype.defaults = {
    radius: 400,
    up: 1
}

Object1.prototype.centerOffset = function() {
    return this.defaults.radius*this.defaults.up;
} 
```

**对象2**

```
var Object2 = function() {}

Object2.prototype = {
    defaults: {
        radius: 400,
        up: 1
    },

    centerOffset: function() {
        return this.defaults.radius*this.defaults.up;
    }
} 
```

**在执行以下简单操作时，**Object1与****Object2**相比具有一致（如果边缘：~3%）的速度优势：**

 **```
var o = new Object1();
var offset = o.centerOffset(); 
```

&

```
var o = new Object2();
var offset = o.centerOffset(); 
```

您可以在[这里](http://jsperf.com/correct-way-to-declare-prototype-functions)自己运行测试。我在 OSX 10.6.8 上使用 Chrome 25。

我想知道的是：

*   这种性能差异的原因是什么？
*   这种性能是否表明了 javascript 中的一些最佳实践？

提前谢谢各位。

编辑：感谢您的回复 - 正如一些人所提到的，我的进一步测试似乎表明这个问题是浏览器（或者更确切地说，特定于 Javascript 编译器）。我还在 Safari、IE 10 和 Firefox 中进行了测试。IE 10 和 Firefox 都给出了非常接近的结果，没有什么不同。Safari 在 Object2 上执行操作的速度比在 Object1 上的稍快（平均约为 2%）。我想知道异常值（其他）是什么，因为这种情况下的性能差异似乎很大。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:07:55.507

当你声明一个函数时，它的原型属性会被一个包含默认构造函数的对象初始化。

使用 Object1，您正在向现有原型函数添加一个属性。使用 Object2，您正在用您自己的无构造函数替换现有原型。

两者并不相同。

为什么速度不一样？好吧，每次创建实例时，V8 都可以在 object2 原型中添加一个构造函数。

或者更有可能的是，预先存在的原型函数是用机器代码实现的，以使其更快，当您将自己的对象分配给 Object2.prototype 时，原型函数现在是纯 javascript，因此速度较慢。

细节并不那么重要，因为不同的解释器会以不同的方式处理这个问题，重要的是要意识到 Object1 和 Object2 并不完全相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:55:06.007

我认为这与您在 Object1 中附加原型并在 Object2 中覆盖它有关。为了验证，我做了第二个性能示例：http: [//jsperf.com/correct-way-to-declare-prototype-functions/2](http://jsperf.com/correct-way-to-declare-prototype-functions/2)

在分配函数之前，我已经添加了“Object1.prototype = {}”。现在 Object1 和 Object2 之间的性能大致相同（至少在 chrome 中）。**

# facebook - 使用 facebook ios 6 登录后进行 Segue

> ID：15178423
> 
> 赞同：0
> 
> 时间：2013-03-02T19:25:28.693
> 
> 标签：facebook, ios6, segue

我正在使用`Facebook SDK 3.1`，我的登录系统是好的，登录后我想去其他的`ViewController`。我同时连接了一个 segue 和标识符，但现在我不知道如何实现它。

在这里，在此之后：

```
if (appDelegate.session.isOpen) {
    [self.buttonLoginLogout setTitle:@"Log out" forState:UIControlStateNormal];        
    [self.textNoteOrLink setText:[NSString stringWithFormat:@"https://graph.facebook.com/me/friends?access_token=%@", appDelegate.session.accessTokenData.accessToken]];
} 
```

在我的 TableViewCell 示例中，我像这样使用它：

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"test"]) {
        NSIndexPath *selectedIndexPath = self.tableView.indexPathForSelectedRow;
        RestauranteDetalhesViewController *destViewController = segue.destinationViewController;
        destViewController.idRest =[bd.idrestauracao objectAtIndex:selectedIndexPath.row];
} 
```

但是在这里我没有索引路径可以提供给（id）发件人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T05:04:32.673

嘿 Fabio Cardoso 有两种类型的 Segue

1.  触发更少的 segue 和
2.  触发转场

在 trigger less segue 中，您只需直接从一个 ViewController 拖动到另一个。你没有提到你希望 Segue 完成哪个动作。为此，您需要像上面那样创建 segue 标识符。并在您的代码中调用以下行。

**[self performSegueWithIdentifier:@"YOUR_IDENTIFIER" sender:self];**

在第二种方式中，您直接 Ctrl+从一个按钮拖动到另一个 ViewController。所以不需要为此编写任何代码。当您单击该按钮时，它将执行 Push、Model 或自定义 segue 您在情节提要中选择的内容。

如果在 Source ViewController 中调用以下方法执行的 segue。在这里，您可以编写自己的代码来将值从第一个 ViewController 传递给另一个或任何其他东西。

**-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender**

如果您的 ViewController 中有多个 segue，则将使用标识符。您可以像这样使用标识符

**if ([segue.identifier isEqualToString:@"YOUR_IDENTIFIER"])**

注意：Segue 只是一种方式，所以如果您从第一个 ViewController 到另一个创建 segue，并且如果您想返回（在模型操作的情况下），您必须为第二个 ViewController 编写委托方法并单击按钮操作调用

```
 **FirstViewController.h**

@interface FirstViewController : UIViewController <SecondViewControllerDelegate>
{

}

- (IBAction) buttonTapped:(id)sender;

**FirstViewController.m**

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"YOUR_IDENTIFIER"])
    {
        SecondViewController *svc_obj = segue.destinationViewController;
        svc_obj.delegate = self;
    }
}

- (void) buttonTapped:(id)sender
{
    [self performSegueWithIdentifier:@"YOUR_IDENTIFIER" sender:self];
}

- (void) secondViewControllerDidCancel: (SecondViewController *) controller
{
    [controller dismissViewControllerAnimated:YES completion:nil];
}

**SecondViewController.h**

@class SecondViewController;

@protocol SecondViewControllerDelegate <NSObject>

- (void) secondViewControllerDidCancel: (SecondViewController *) controller;

@end

@interface SecondViewController : UIViewController
{

}
@property (nonatomic, weak) id <SecondViewControllerDelegate> delegate;

- (IBAction)cancelButtonTapped:(id)sender;

**SecondViewController.m**

- (IBAction)cancelButtonTapped:(id)sender
{
    [self.delegate secondViewControllerDidCancel:self];
}

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T15:49:57.130

我用这条简单的线解决了我的问题：

```
 [self performSegueWithIdentifier:@"begin" sender:self]; 
```

# android - 动态添加 Button end 到 GridView

> ID：15178429
> 
> 赞同：2
> 
> 时间：2013-03-02T19:26:16.907
> 
> 标签：android, android-button, android-gridview

努力实现

*   在具有`layout_height="wrap_parent"`&`layout_width="fill_parent"`以提供更好的 UIx 的 GridView 之后添加按钮。

约束：

*   将从 Facebook-Graph-Api 获取的 ImageView 添加到由 ImageView 组成的 GridView。

*   获取图像后，添加 GridView 的 Button atlast。

试过了

*   **1** . 在 AysncTask 的 onPostExecute() 将按钮的可见性设置为可见，这有助于我获取图像

*   **2** . 在 ScrollListener 将按钮的可见性设置为可见，如果它滚动到达 GridView 的末尾，即 GridView 中的*最后一个图像，它将运行*

*   但是 GridView 的末尾没有显示 Button。不知道为什么？？

我的 XML 布局::

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" 
android:id="@+id/rootview"
>
<Button
    android:id="@+id/fbconnect"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/connectfb" 
    android:layout_centerHorizontal="true"
    android:visibility="visible"
    />
<GridView 
    android:id="@+id/gridphoto"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:columnWidth="80dp"
    android:numColumns="auto_fit" 
    android:verticalSpacing="2dp"
    android:horizontalSpacing="2dp"
    android:stretchMode="columnWidth"
    />
<Button 
        android:id="@+id/loadmore"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"        
        android:layout_centerHorizontal="true"
        android:layout_below="@id/gridphoto"
        android:visibility="gone"
        android:text="@string/load_more"
    />
</RelativeLayout> 
```

代码 :: 通过 AysncTask 获取图像并在 onPostExecute 设置可见性以在 GridView 末尾添加 LoadMore 按钮。

```
 protected void onPostExecute(Void result) {
  loadMore.setVisibility(View.VISIBLE); // Load More Button
 } 
```

代码 :: 在 GridView 上实现 ScrollListener --> 检查它是否到达底部，然后更改加载更多按钮的可见性。

```
public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount, int totalItemCount) {
 if (gridView.getLastVisiblePosition() + 1 == increasingItem) // Checking if it reaches bottom of GridView or not. It prefectly runs. Checked via Logging into StackTrace.
  {
     loadMore.setVisibility(View.VISIBLE); // Load More Button
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-03T00:10:56.140

我用这段代码完成了它：

主要活动 ：

```
 public class MainActivity extends Activity implements OnScrollListener {

        ArrayAdapter<String> adapter;

        GridView gridphoto;
        Button loadMore;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            gridphoto = (GridView) findViewById(R.id.gridphoto);
            loadMore = (Button) findViewById(R.id.loadmore);
            gridphoto.setOnScrollListener(this);
            adapter= new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1);
            for (int i = 0; i < 80; i++) {
                adapter.add("dummy data " + i);

            }
            gridphoto.setAdapter(adapter);

        }

        @Override
        public void onScroll(AbsListView view, int firstVisibleItem,
                int visibleItemCount, int totalItemCount) {
            if (gridphoto.getLastVisiblePosition() + 1 == 80) {
                loadMore.setVisibility(View.VISIBLE); // Load More Button
            }
        }

        @Override
        public void onScrollStateChanged(AbsListView view, int scrollState) {
            // TODO Auto-generated method stub

        }
    } 
```

和activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >

        <GridView
            android:id="@+id/gridphoto"
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight="1"
            android:columnWidth="80dp"
            android:gravity="center"
            android:horizontalSpacing="2dp"
            android:numColumns="auto_fit"
            android:stretchMode="columnWidth"
            android:verticalSpacing="2dp" />

        <Button
            android:id="@+id/loadmore"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Load More"
            android:visibility="gone" />
    </LinearLayout>

</RelativeLayout> 
```

它按预期工作，希望它会有所帮助

# symfony - 来自 db 中的条目的标签表单

> ID：15178432
> 
> 赞同：0
> 
> 时间：2013-03-02T19:26:29.480
> 
> 标签：symfony, symfony-forms

我创建了一个嵌入式表单。如何使用数据库中的名称在 ItemType.php 中添加标签？

1.) 喜欢：

```
$builder->add('id', 'checkbox', array('label'=> $v->getName(),... 
```

2.) 顺便说一下，symfony2 为每个 ItemType.php 呈现一个数字 0,1,2。我怎样才能摆脱它？

我的行动：

```
$task = new UserFriends();

foreach ($fb_friends as $k => $v) {
     $name = $v->getName();
     $friend_id = $v->getFriendId();
     $id = $v->getId();
     $t = new Item();
     $t->name = $name;
     $t->friendId = $friend_id;
     $t->id = $id;
     $task->getId()->add($t);
}
$form = $this->createForm(new CreateRequest(), $task, array()); 
```

CreateRequest.php-form 的一部分：

```
$builder->add('id', 'collection', array('type' => new ItemType(), 
```

我的 ItemType.php 的一部分

```
public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('id', 'checkbox', array('label'=> 'Name', 'required' => false, 'mapped' => false));
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'Frontend\ChancesBundle\Entity\Item',
        ));
    }

    public function getName()
    {
        return 'item';
    } 
```

和我的 Item.php-Entity 的一部分

```
class Item
{
    public $id;

    public $friendId;

    public $name;

    public function getFriendId()
    {
        return $this->friendId;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:41:12.120

您可以将实体管理器传递给您的表单并从数据库中选择您想要的任何内容。

**在您的控制器中（或任何您调用表单的地方）：**

```
$em = $this->getDoctrine()->getManager();
$form = $this->createForm(new MyFormType($blabla), $blabla, array('em' => $em)); 
```

**在您的表单类型中：**

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $somethingFromDb = $options['em']->findByName('someName');
}

public function setDefaultOptions(OptionsResolverInterface $resolver)
{

    $resolver->setRequired(array(
        'em',
    ));

    $resolver->setAllowedTypes(array(
        'em' => 'Doctrine\Common\Persistence\ObjectManager',
    ));
} 
```

# c# - WCF 客户端和服务器

> ID：15178434
> 
> 赞同：7
> 
> 时间：2013-03-02T19:26:32.830
> 
> 标签：c#, wcf

我需要多个与 WCF 服务通信的客户端。WCF 服务还必须能够连接到任何一个客户端。

所以 - 听起来服务器和客户端都需要在每个服务器和客户端中都内置 WCF 服务器和客户端。

这是正确的还是有办法做到这一点？

我在看 NetPeerTcpBinding，但那已经过时了。公平地说，我也不确定这是否是一个有效的解决方案。

背景：

*   我计划在我们网络中的数百台机器上安装一个 Windows 服务，并内置一个[WCF](http://en.wikipedia.org/wiki/Windows_Communication_Foundation)服务和一个 WCF 客户端。
*   我将在具有 WCF 服务和内置客户端的服务器上安装一个 Windows 服务。
*   我将有一个[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)应用程序
*   我会有一个数据库

网络上的客户端将连接到服务器上运行的服务，以便在数据库中插入一些信息。

用户将使用 Windows Forms 应用程序连接到服务器上的 Windows 服务，该 Windows 服务将连接到工厂车间的相关客户端（以允许远程浏览文件和文件夹）。

因此，我相信地板上的机器和服务器都需要内置 WCF 客户端和服务。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-02T19:49:02.077

人们推荐的原因`wsHttpDualBinding`是因为它本身是一种安全且可互操作的绑定，旨在与允许服务和客户端发送和接收消息的双工服务合同一起使用。

提到的“双工”通信类型有几种变体。Half 和 Full 是最简单的。

*   半双工：像对讲机一样工作，一个人可以在任何给定时间讲话。
*   全双工：就像电话一样，任何人都可以在任何给定时间讲话。

每个都会带来一个好处和一个问题，它们还提供了根据您的需求更有效地建立这种沟通的方法。

* * *

我有点困惑，但我会尝试澄清一下。

您有各种可能在此处出现的方法，Windows Communication Foundation (WCF) 服务需要以下内容：

*   地址
*   捆绑
*   合同

这些本质上是 WCF 的“ABC”。那些的创作描绘了这样一幅画面：

![WCF 图](../Images/9c426d16289cf44faafa50851f868326.png)

如您所见，该服务将包含：

*   主持人
*   服务
*   客户

主机包含客户端将*使用*的服务，因此这些服务方法执行所需的任务。一个示例表示：

![端点](../Images/a7b378748443b3414f216c0164a24333.png)

如您所见，*Client-1*正在通过 Internet（HTTP、HTTPS 等）然后将访问主机，这将使服务执行这些任务。

现在*Client-n*正在本地使用服务，因此它以通过（TCP 等）进行通信作为示例。

最容易记住的方法：一项服务可以被许多客户端使用，但许多客户端需要这些方法来执行任务。[您可以使用面向服务的架构](https://en.wikipedia.org/wiki/Service-oriented_architecture)(SOA)创建非常复杂的模型。

> 所有 WCF 都是一种将您的应用程序连接到您可能无法访问的主机或集中位置的方法。

![客户端通过服务来托管，来访问数据库。](../Images/9dd90245159c6d9743448bcf1f6e9d43.png)

如上图所示，客户端通过**服务**与主机通信。其中执行一系列任务。WCF 将讨论一系列协议。希望这将有助于更好地理解 WCF 的结构。

有很多教程甚至帖子可以帮助您入门。一些优秀的书籍如*《WCF Step by Step》*。

* * *

本质上，您正在寻找异步全双工连接或同步全双工服务。如上所述，您的任务本质上是服务的重点。

问题是：*这如何最好地工作？*

它将归结为您的设计。您需要遵守一些限制和结构才能真正优化它以实现您的目标。

这些障碍可能是：

1.  服务器负载
2.  通讯路径
3.  安全
4.  多个客户端更改 UI / 相同数据
5.  等等。

该列表继续并继续。我真的会查找有关 WCF 的教程或几本书。这里有几个：

*   *[WCF 一步一步](https://rads.stackoverflow.com/amzn/click/com/B004FGMTT0)*

*   *[WCF 多层开发](https://rads.stackoverflow.com/amzn/click/com/B005EWOIJ8)*

*   *[WCF 服务开发](https://rads.stackoverflow.com/amzn/click/com/B005VQ8SA2)*

他们将帮助您使用服务结构来实现您期望的目标。

* * *

记住 WCF 最成功的“ABC”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-02T19:52:45.290

如果您希望您的服务与您的客户端通信，请使用 wsDualHttpBinding。

阅读*[WS Dual HTTP](http://msdn.microsoft.com/en-us/library/ms751522.aspx)*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-02T19:51:26.613

您可能想尝试使用[netTcpBinding](https://msdn.microsoft.com/en-us/library/ms731343%28v=vs.110%29.aspx)创建 WCF 服务。它将满足您的要求。您可以使用文章*[How to: Use netTcpBinding with Windows Authentication and Transport Security in WCF Calling from Windows Forms](http://msdn.microsoft.com/en-us/library/ff647180.aspx)*作为开始：

此外，您可以使用[WCF 示例包](http://go.microsoft.com/fwlink/?LinkId=150780)中包含的许多示例。

# javascript - JavaScript / jQuery - 从 2 个相同的下拉菜单中获取输入

> ID：15178435
> 
> 赞同：0
> 
> 时间：2013-03-02T19:26:32.733
> 
> 标签：javascript, jquery

我有 2 个下拉列表，它们都包含相同的列表`teams`，一个用作`home`团队，一个用作`away`团队。在第一个下拉列表起作用的那一刻，当从列表中选择 a 时，`team`它会输出到页面。但是当单击另一个下拉菜单时，什么也没有发生。例如，输出采用 id 和团队名称并将它们输出到文本框。`id``name`

这是每个下拉列表的示例和下面的相关代码，有人可以帮助我吗？

为主队列表生成的 HTML：

```
<select id="teamList" style="width: 160px;">
<option></option>
<option id="1362174068837" value="1362174068837" class="teamDropDown">Liverpool</option></select> 
```

为客队列表生成的 HTML：

```
<select id="teamList" style="width: 160px;">
<option></option>
<option id="1362174068837" value="1362174068837" class="teamDropDown">Liverpool</option>
</select> 
```

用于生成 HTML 的 JADE 模板（用于两个列表）：

```
div#teamDropDownDiv
    -if(teamsList.length > 0){
        select#teamList(style='width: 160px;')
            option
                -each team in teamsList
                    option.teamDropDown(id="#{team.key}",value="#{team.key}") #{team.name} 
```

页面的 JavaScript：

```
 Team.initTeamsDD = function(){
  $("#teamList").change(function(e){
    e.preventDefault();
    var teamId = $(this).val();

    $.get('/show/team/'+teamId, function(response){
      if(response.retStatus === 'success'){
        var teamData = response.teamData;
        $('#teamId').val(teamData.key);
        $('#teamName').val(teamData.name);
      } else if(response.retStatus === 'failure'){

      }
    });  
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:43:49.057

这两个`<select>`元素都具有相同的“id”值，即“teamList”。你永远不应该有两个具有相同“id”的元素。因此，on-change 事件处理程序只附加到其中一个。您应该将它们更改为“homeTeamList”和“awayTeamList”，然后使用：

```
Team.initTeamsDD = function(){
  $("#homeTeamList, #awayTeamList").change(function(e){
... 
```

# javascript - 用 Javascript/Jquery 替换内容

> ID：15178436
> 
> 赞同：0
> 
> 时间：2013-03-02T19:26:36.597
> 
> 标签：javascript, css

[http://jsfiddle.net/bUjx7/31](http://jsfiddle.net/bUjx7/31)

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>

<style type="text/css">
.fieldsgame1 {
    display:none;
}
.fieldsgame2 {
    display:none;
}
.fieldsgame3 {
    display:none;
}
</style>

<script type="text/javascript">
$(document).ready(function() {
    $('.tablereplace a').click(function () {
        $('.fieldsmatch').fadeOut(0);
        $('.fieldsgame1').fadeOut(0);
        $('.fieldsgame2').fadeOut(0);
        $('.fieldsgame3').fadeOut(0);
        var region = $(this).attr('data-region');
        $('#' + region).fadeIn(0);
    });
});
</script> 
```

把它放到我的 WordPress 标题中。CSS很好。HTML 很好。Javascript 不工作。帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:41:15.633

我不太确定什么“不起作用”（因为您展示的小提琴工作正常），但我确实设法清理了您的代码。它更[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)，`fadeOut`速度为 0 与`hide()`/相同`show()`，& [jQuery.data()](http://api.jquery.com/jQuery.data/)用于检索`data-region`.

**HTML**

```
<div class="tablereplace">
<a data-region="fieldsmatch" href="#">Match</a>
<a data-region="fieldsgame1" href="#">Game 1</a>
<a data-region="fieldsgame2" href="#">Game 2</a>
<a data-region="fieldsgame3" href="#">Game 3</a>
<div id="fieldsmatch" class="fieldsmatch">8-0</div>
<div id="fieldsgame1" class="fieldsgame">7-1</div>
<div id="fieldsgame2" class="fieldsgame">6-2</div>
<div id="fieldsgame3" class="fieldsgame">1-0</div>
</div> 
```

**CSS**

```
.fieldsgame {
    display:none;
} 
```

**JS**

```
$('.tablereplace a').click(function () {

    $('#fieldsmatch, .fieldsgame').hide();
    var region = $(this).data('region');
    $('#' + region).show();

}); 
```

[JSF](http://jsfiddle.net/bUjx7/33/)中。

**=== 更新 ===**

根据您的评论，我在实时页面上发现了以下*差异：*

```
<a href="#vsfield" data-region="fieldsmatch">Match</a>
<a href="#vsfield" data-region="fieldsgame1">Game 1</a>
<a href="#vsfield" data-region="fieldsgame2">Game 2</a>
<a href="#vsfield" data-region="fieldsgame3">Game 3</a>

<div class="tablereplace">
    <div class="fieldsmatch" id="fieldsmatch">8-0</div>
    <div class="fieldsgame" id="fieldsgame1">7-1</div>
    <div class="fieldsgame" id="fieldsgame2">6-2</div>
    <div class="fieldsgame" id="fieldsgame3">1-0</div>
</div> 
```

您指定`click`的功能基于`.tablereplace a`选择器。但是，在您的网站上，`a`在`.tablereplace`. 换句话说，您的 HTML 是错误的。

# list - 在 Haskell 中将列表一分为二的所有可能性

> ID：15178437
> 
> 赞同：2
> 
> 时间：2013-03-02T19:26:39.310
> 
> 标签：list, haskell, split

在Haskell中创建将一个（偶数）列表分成两个的所有可能性的最直接/有效的方法是什么？我玩弄了拆分列表的所有排列，但这会增加许多额外内容 - 每一半都包含相同元素的所有实例，只是顺序不同。例如，

```
[1,2,3,4] should produce something like:

[ [1,2],  [3,4] ]
[ [1,3],  [2,4] ]
[ [1,4],  [2,3] ] 
```

编辑：感谢您的评论——元素的顺序和结果的类型对我来说不如概念重要——一个组中所有两组的表达，其中元素顺序并不重要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:21:08.917

这是一个实现，紧跟定义。

第一个元素总是进入左组。之后，我们将下一个头元素添加到一个或另一个组中。如果其中一个组变得太大，就别无选择了，我们必须将其余的都添加到较短的组中。

```
divide :: [a] -> [([a], [a])]
divide []     = [([],[])]
divide (x:xs) = go ([x],[], xs, 1,length xs) []
  where
    go (a,b,   [],     i,j) zs = (a,b) : zs   -- i == lengh a - length b
    go (a,b, s@(x:xs), i,j) zs                -- j == length s
       | i    >= j = (a,b++s) : zs
       | (-i) >= j = (a++s,b) : zs
       | otherwise = go (x:a, b, xs, i+1, j-1) $ go (a, x:b, xs, i-1, j-1) zs 
```

这产生

```
*Main> divide [1,2,3,4]
[([2,1],[3,4]),([3,1],[2,4]),([1,4],[3,2])] 
```

具有偶数长度列表的限制是不必要的：

```
*Main> divide [1,2,3]
[([2,1],[3]),([3,1],[2]),([1],[3,2])] 
```

[（代码以“差异列表”样式重新编写以提高效率：）`go2 A zs == go1 A ++ zs`。]

*编辑：*这是如何工作的？想象自己坐在一堆石头前，把它一分为二。你把第一块石头放在一边，哪一块没关系（所以，左，说）。然后有一个选择，将每块下一块石头放在哪里——除非两堆中的一个相比之下变得太小，因此我们必须一次将所有剩余的石头放在那里。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-02T20:10:09.167

为了将非空列表（长度为偶数`n`）的所有分区分成大小相等的两个部分，我们可以为避免重复，假设第一个元素应位于第一部分中。然后剩下的就是寻找所有方法将列表的尾部拆分为 length 的一部分和 length`n/2 - 1`的一部分`n/2`。

```
-- not to be exported
splitLen :: Int -> Int -> [a] -> [([a],[a])]
splitLen 0 _ xs = [([],xs)]
splitLen _ _ [] = error "Oops"
splitLen k l ys@(x:xs)
    | k == l    = [(ys,[])]
    | otherwise = [(x:us,vs) | (us,vs) <- splitLen (k-1) (l-1) xs]
                  ++ [(us,x:vs) | (us,vs) <- splitLen k (l-1) xs] 
```

如果适当调用，会进行拆分。然后

```
partitions :: [a] -> [([a],[a])]
partitions [] = [([],[])]
partitions (x:xs)
    | even len  = error "Original list with odd length"
    | otherwise = [(x:us,vs) | (us,vs) <- splitLen half len xs]
      where
        len = length xs
        half = len `quot` 2 
```

生成所有分区，而无需冗余计算重复项。

[luqui](https://stackoverflow.com/users/33796/luqui)提出了一个很好的观点。我没有考虑到您希望使用重复元素拆分列表的可能性。有了这些，它变得有点复杂，但并不多。首先，我们将列表分组为相等的元素（此处为`Ord`约束完成，仅用于`Eq`，仍然可以在 中完成`O(length²)`）。然后这个想法是相似的，为了避免重复，我们假设前半部分包含第一组的元素多于第二组（或者，如果第一组中有偶数，则同样多，并且下一组具有类似的限制组等）。

```
repartitions :: Ord a => [a] -> [([a],[a])]
repartitions = map flatten2 . halves . prepare
  where
    flatten2 (u,v) = (flatten u, flatten v)

prepare :: Ord a => [a] -> [(a,Int)]
prepare = map (\xs -> (head xs, length xs)) . group . sort

halves :: [(a,Int)] -> [([(a,Int)],[(a,Int)])]
halves [] = [([],[])]
halves ((a,k):more)
    | odd total = error "Odd number of elements"
    | even k    = [((a,low):us,(a,low):vs) | (us,vs) <- halves more] ++ [normalise ((a,c):us,(a,k-c):vs) | c <- [low + 1 .. min half k], (us,vs) <- choose (half-c) remaining more]
    | otherwise = [normalise ((a,c):us,(a,k-c):vs) | c <- [low + 1 .. min half k], (us,vs) <- choose (half-c) remaining more]
      where
        remaining = sum $ map snd more
        total = k + remaining
        half = total `quot` 2
        low = k `quot` 2
        normalise (u,v) = (nz u, nz v)
        nz = filter ((/= 0) . snd)

choose :: Int -> Int -> [(a,Int)] -> [([(a,Int)],[(a,Int)])]
choose 0 _ xs = [([],xs)]
choose _ _ [] = error "Oops"
choose need have ((a,k):more) = [((a,c):us,(a,k-c):vs) | c <- [least .. most], (us,vs) <- choose (need-c) (have-k) more]
  where
    least = max 0 (need + k - have)
    most  = min need k

flatten :: [(a,Int)] -> [a]
flatten xs = xs >>= uncurry (flip replicate) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-02T20:21:46.887

Daniel Fischer 的回答是解决问题的好方法。我提供了一种更糟糕（效率更低）的方法，但（对我而言）更明显的是对应于问题描述。我会将列表的所有分区生成两个等长的子列表，然后根据您对等价的定义过滤掉等价的子列表。我通常解决问题的方法是这样开始——创建一个尽可能明显的解决方案，然后逐渐将其转变为更有效的解决方案（如有必要）。

```
import Data.List (sort, nubBy, permutations)

type Partition a = ([a],[a])

-- Your notion of equivalence (sort to ignore the order)
equiv :: (Ord a) => Partition a -> Partition a -> Bool
equiv p q = canon p == canon q
    where
    canon (xs,ys) = sort [sort xs, sort ys]

-- All ordered partitions
partitions :: [a] -> [Partition a]
partitions xs = map (splitAt l) (permutations xs)
    where
    l = length xs `div` 2

-- All partitions filtered out by the equivalence
equivPartitions :: (Ord a) => [a] -> [Partition a]
equivPartitions = nubBy equiv . partitions 
```

测试

```
>>> equivPartitions [1,2,3,4]
[([1,2],[3,4]),([3,2],[1,4]),([3,1],[2,4])] 
```

## 笔记

在使用 QuickCheck 测试了这个实现与 Daniel 的等效性之后，我发现了一个重要的区别。显然，我的需要一个`(Ord a)`约束，而他的不需要，这暗示了不同之处。特别是，如果你给他的`[0,0,0,0]`，你会得到一个包含三个副本的列表`([0,0],[0,0])`，而我的只会给一个副本。未指定哪些是正确的；在考虑将两个输出列表作为有序序列（通常认为是该类型）时，Daniel 很自然，当将它们视为集合或包时，我的很自然（这个问题似乎是如何对待它们的）。

## 分裂差异

`Ord`通过对*位置*而不是列表中的值进行操作，可以从需要的实现中获得不需要的实现。我想出了这个转变——我相信这个想法起源于 Benjamin Pierce 在他的双向编程工作中。

```
import Data.Traversable
import Control.Monad.Trans.State

data Labelled a = Labelled { label :: Integer, value :: a }

instance Eq (Labelled a) where
    a == b = compare a b == EQ
instance Ord (Labelled a) where
    compare a b = compare (label a) (label b)

labels :: (Traversable t) => t a -> t (Labelled a)
labels t = evalState (traverse trav t) 0
    where
    trav x = state (\i -> i `seq` (Labelled i x, i + 1))

onIndices :: (Traversable t, Functor u)
          => (forall a. Ord a => t a -> u a)
          -> forall b. t b -> u b
onIndices f = fmap value . f . labels 
```

使用`onIndices`on`equivPartitions`根本不会加速它，但它会允许它具有与 Daniel 相同的语义（直到`equiv`结果），没有约束，并且用我更天真和明显的表达方式 - 我只是认为这是摆脱约束的一种有趣方式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-29T01:57:53.077

我自己的通用版本，后来添加，灵感来自 Will 的回答：

```
import Data.Map (adjust, fromList, toList)
import Data.List (groupBy, sort)

divide xs n evenly = divide' xs (zip [0..] (replicate n [])) where
  evenPSize = div (length xs) n
  divide' []     result = [result]
  divide' (x:xs) result = do
    index <- indexes
    divide' xs (toList $ adjust (x :) index (fromList result)) where
      notEmptyBins = filter (not . null . snd) $ result
      partlyFullBins | evenly == "evenly" = map fst . filter ((<evenPSize) . length . snd) $ notEmptyBins
                     | otherwise          = map fst notEmptyBins
      indexes = partlyFullBins 
             ++ if any (null . snd) result
                   then map fst . take 1 . filter (null . snd) $ result
                   else if null partlyFullBins
                           then map fst. head . groupBy (\a b -> length (snd a) == length (snd b)) . sort $ result
                           else [] 
```

# qt - 来自 QRunnable 的 Qt 信号未收到/未连接

> ID：15178446
> 
> 赞同：3
> 
> 时间：2013-03-02T19:27:34.597
> 
> 标签：qt, signals, slot

我正在用 C++ 编写一个 Qt 应用程序。我有一个在 QThreadPool 中运行的 QRunnable，它向主线程发送一个信号。问题是，连接不起作用：主线程永远不会收到信号，即使我已经验证了确实调用了发出的代码。这是我的代码：

我的 QRunnable 课程：

```
class OfflineAnalysisThread : public QObject, public QRunnable
{
Q_OBJECT

public:
void run();
void sendMessage(QString &qmsg)
{
    emit threadMessageCallback(qmsg);
}

signals:
void threadMessageCallback(QString &string);
}; 
```

和调用类（主线程）：

```
class OfflineAnalysisMain : public QObject
{
Q_OBJECT

public:

    (...)

public slots:
void threadMsg(QString &string);
}; 
```

实例化新 QRunnables 并启动它们的代码：

```
void OfflineAnalysisMain::myFunction()
{
    OfflineAnalysisThread *newTask = new OfflineAnalysisThread();

    QObject::connect(newTask, SIGNAL(threadMessageCallback(QString &)), this, SLOT(threadMsg(QString &)));

    QThreadPool::globalInstance()->start(newTask);
} 
```

因此，从我的 QRunnable 的运行函数中，我调用 sendMessage，然后执行 QApplication::exec()。我在 OfflineAnalysisMain.cpp 中的 threadMsg 插槽实现上有一个断点，并且该函数从未被调用。

我究竟做错了什么？

更新：

我的 OfflineAnalysisThread::run() 函数的定义：

```
void OfflineAnalysisThread::run()
{
    std::string myMsg("This is my message");
    sendMessage(myMsg);

    QApplication::exec();
} 
```

我也尝试过不使用 QApplication::exec();，但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:04:09.820

`QApplication::exec()`从内部删除对的调用`run()`。理想情况下，这是从您的`main`函数中调用的。

为了让您的代码正常工作，我必须编写以下`main`函数：

```
#include <QApplication>
#include <QMetaType>

#include <offlineanalysismain.h>

int main(int argc, char* argv[])
{
   QApplication app(argc, argv);

   qRegisterMetaType<QString>("QString&");

   OfflineAnalysisMain* main = new OfflineAnalysisMain;
   main->myFunction();

   return app.exec();
} 
```

注意对 的调用`qRegisterMetaType`，它允许 Qt`QString`通过跨越线程边界的信号槽连接。

# java - Xuggler NoClassDefFoundError 使用 Netbeans

> ID：15178448
> 
> 赞同：0
> 
> 时间：2013-03-02T19:27:42.163
> 
> 标签：java, netbeans, media, xuggler

我在下面编写了以下代码：

```
import com.xuggle.xuggler.IContainer;

public class MediaPlayer {
    public static void main (String[] args) {
        IContainer container = IContainer.make();

        if(container.open("file:///homes/sa303/NetBeansProjects/MoviePlayer1/src/Trailer/IronMan3.mp4", 
                           IContainer.Type.READ, null) < 0) {
            throw new IllegalArgumentException("Could not open");
        }
    }
} 
```

我基于视频教程[http://www.youtube.com/watch?v=wdW6tUql154](http://www.youtube.com/watch?v=wdW6tUql154)

但是，我收到以下错误：

> 线程“主”java.lang.NoClassDefFoundError 中的异常：org/slf4j/LoggerFactory

我已将`xuggle-xuggler.jar`文件保存在类路径中，但仍未解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T12:44:01.403

原因 可能是依赖 jar 不可用或版本冲突。

以下罐子组合对我来说效果很好：

xuggle-xuggler-5.4.jar
slf4j-api-1.6.4.jar
logback-core-1.0.0.jar
logback-classic-1.0.0.jar

注意：使用“添加 jar/文件夹”选项将它们添加到库文件夹中。

# requirejs - 尽管加载了模板文件，但模板内容不可用

> ID：15178450
> 
> 赞同：1
> 
> 时间：2013-03-02T19:28:03.457
> 
> 标签：requirejs

我定义了这个主干视图：

```
define(["jquery", "backbone", "main", "text!templates/loginViewTemplate.html"], 
  function($, Backbone, loginViewTemplate) {
      var LoginView = Backbone.View.extend({

        render: function() {
              console.log(loginViewTemplate);             
              this.template = _.template(loginViewTemplate, {});              
              $(this.el).html(this.template);
              return this;   
        },

        // ...
     });
 }); 
```

但是 console.log 语句是“未定义的”，没有渲染。`loginViewTemplate.html`虽然我可以在控制台中看到对文件的请求。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:42:10.237

离开屏幕几分钟后，我发现依赖声明的顺序很重要。

使第一行看起来像这样解决了它：

```
define(["jquery", "backbone", "text!templates/loginViewTemplate.html", "main"],
  function($, Backbone, loginViewTemplate) { 
```

# c++ - 包含对对象的引用的 STL 向量的引用在 C++ 中会产生错误。为什么？

> ID：15178458
> 
> 赞同：3
> 
> 时间：2013-03-02T19:29:12.763
> 
> 标签：c++, visual-studio-2010, vector, stl, reference

为什么我不能引用包含对象引用的 std::vector？以下代码在 Visual C++ 2010 中生成编译错误：

```
void Map::Filter( Object::Type type, std::vector<Object&>& list )
{
  for ( register int y = 0; y < MAP_H; y++ )
    for ( register int x = 0; x < MAP_W; x++ ) {
      if ( under[y][x].GetType() == type )
        list.push_back(under[y][x]);
      if ( above[y][x].GetType() == type )
        list.push_back(above[y][x]);
    }
} 
```

总结编译错误：

```
c:\program files\microsoft visual studio 10.0\vc\include\xmemory(137): error C2528: 'pointer' : pointer to reference is illegal
c:\program files\microsoft visual studio 10.0\vc\include\vector(421) : see reference to class template instantiation 'std::allocator<_Ty>' being compiled 
```

我通过从“对象引用向量”切换到“对象指针向量”解决了这个问题。我只是不明白为什么我不能引用引用向量。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T19:56:47.427

标准容器使用分配器来分配内存以及构造和销毁元素。`X`分配器要求是为负责分配类型对象的分配器类指定的`T`。该类型`T`被指定为“任何非常量、非引用对象类型”（表 27）。因此，对引用对象的分配器没有任何要求。这意味着尝试创建引用类型的容器将直接导致未定义的行为。

表 27 可在 §17.6.3.5 分配器要求中找到：

![在此处输入图像描述](../Images/24195d56302a87e6d286fd64349dd993.png)

另一种方法是使用一个向量`std::reference_wrapper`和`push_back`你的元素：

```
list.push_back(std::ref(under[y][x])); 
```

另一种选择是使用原始指针，或者可能使用[World's Dumbest Smart Pointer](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3514.pdf)的实现。

另外，我建议不要调用你的向量`list`- 有一个`std::list`容器类型。它的清单是什么？`cats`? `people`? `bananas`?

# php - 在表单中使用 PHP 和 htmlentities 保留用户输入？

> ID：15178466
> 
> 赞同：2
> 
> 时间：2013-03-02T19:29:53.963
> 
> 标签：php, forms, html-entities

我试图在表单中保留用户输入，这工作正常，但如果没有输入并且我按下提交按钮，我会收到以下错误：

```
 Notice: Undefined variable: name in C:\xampp\htdocs\syncfolder\phpsols\contact_01.php on line 54 value=""> 
```

我使用的代码来自《PHP 解决方案》一书：

```
 <?php 
    $errors = array();
    $missing = array();
    //check if the form has been submitted
    if (isset($_POST['send'])){
    //email processing script
    $to = 'sampleemail1@gmail.com';
    $subject = 'Mailing script';
    //list of expected fields
    $expected = array('name', 'email','comments');
    //set required fields
    $required = array('name','email', 'comments');
    require('processmail.inc.php');
    }
    ?>
    <!DOCTYPE HTML>
    <html>
    <head>
    <meta charset=utf-8">
    <title>Japan Journey</title>
    <link href="styles/journey.css" rel="stylesheet" type="text/css" media="screen">
    </head>

    <body>
    <div id="header">
    <h1>Japan Journey</h1>
    </div>
    <div id="wrapper">

    <div id="maincontent">
        <h2>Contact Us </h2>

        <?php if ($missing || $errors) { ?>
    <p class="warning">Please fix the item(s) indicated.</p>
        <?php } ?>

      <p>Ut enim ad minim veniam, quis nostrud exercitation consectetur adipisicing elit. Velit esse cillum dolore ullamco laboris nisi in reprehenderit in voluptate. Mollit anim id est laborum. Sunt in culpa duis aute irure dolor excepteur sint occaecat.</p>
        <form id="feedback" method="post" action="">

            <p>
                <label for="name">Name:
                <?php if ($missing && in_array('name', $missing)) { ?>
                <span class="warning">Please enter your name</span>
                <?php } ?>
                </label>
                <input name="name" id="name" type="text" class="formbox"
                    <?php if ($missing || $errors) {
                    echo 'value="' . htmlentities($name, ENT_COMPAT, 'UTF-8') . '"';
                    } ?>>
            </p>

            <p>
                <label for="email">Email:
                <?php if ($missing && in_array('email', $missing)) { ?>
                <span class="warning">Please enter your email address</span>
                <?php } ?>
                </label>
                <input name="email" id="email" type="text" class="formbox"
                    <?php if ($missing || $errors) {
                    echo 'value="' . htmlentities($email, ENT_COMPAT, 'UTF-8') . '"';
                    } ?>>
            </p>

            <p>
                <label for="comments">Comments:
                <?php if ($missing && in_array('comments', $missing)) { ?>
                <span class="warning">Please enter your comments</span>
                <?php } ?>
                 </label>
                <textarea name="comments" id="comments" cols="60" rows="8">
                <?php
                    if ($missing || $errors) {
                    echo htmlentities($comments, ENT_COMPAT, 'UTF-8');
                    } ?>
                </textarea>
            </p>

            <p>
                <input name="send" id="send" type="submit" value="Send message">
            </p>
        </form>
    </div>

</div>
</body>
</html> 
```

并包含文件：

```
<?php
foreach ($_POST as $key => $value) {
// assign to temporary variable and strip whitespace if not an array
$temp = is_array($value) ? $value : trim($value);
// if empty and required, add to $missing array
if (empty($temp) && in_array($key, $required)) {
$missing[] = $key;
} elseif (in_array($key, $expected)) {
// otherwise, assign to a variable of the same name as $key
${$key} = $temp;
    }
  }

?> 
```

除 html-entities 外，所有脚本都可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:53:03.733

`else`在处理程序的末尾添加一条语句并设置`$variable = ("")`.

# android - PhoneGap Android 获取app版本码

> ID：15178468
> 
> 赞同：11
> 
> 时间：2013-03-02T19:29:56.387
> 
> 标签：android, cordova, version

我正在用 jQueryMobile 构建一个 phonegap android 应用程序。

我想构建一个功能，使用网络服务检查应用程序的版本代码，以便建议更新，如果应用程序已过时，提示到 google play 商店。

从我的搜索来看，PhoneGap 似乎没有找到*版本代码*的方法。

有没有办法做到这一点：

*   无需在 Java 类中编写任何内容？
*   每次推送新版本时无需手动存储更新的变量？

或者，如果在课堂上写作是必不可少的，我该如何从 PhoneGap 中调用它？

**编辑：我用一个可行的解决方案编辑了接受的答案！我希望每个人都能从中受益。**

**编辑（2）：这是带有说明的完整插件仓库，请随意分叉：）[https://github.com/gcatalfamo/Version](https://github.com/gcatalfamo/Version)**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T19:40:59.030

我知道您问过不写 Java 类，但是您需要以一种或另一种方式编写。你需要`PhoneGap Plugin`像安德烈所说的那样写。

创建自定义`PhoneGap plugin`：

在您的应用程序包中创建一个新类：

```
package com.phonegap.plugins; //your package name

import org.json.JSONArray;

import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.content.pm.PackageManager.NameNotFoundException;
import org.apache.cordova.api.Plugin;
import org.apache.cordova.api.PluginResult;
import org.apache.cordova.api.PluginResult.Status;

public class Version extends Plugin {

    public final String ACTION_GET_VERSION_NAME = "GetVersionName"; //not used in this version
    public final String ACTION_GET_VERSION_CODE = "GetVersionCode";

    @Override
    public PluginResult execute(String action, JSONArray args, String callbackId) {
        PluginResult result = new PluginResult(Status.INVALID_ACTION);
        PackageManager packageManager = this.cordova.getActivity().getPackageManager();
        if(action.equals(ACTION_GET_VERSION_CODE)) {
            try {
                PackageInfo packageInfo = packageManager.getPackageInfo(this.cordova.getContext().getPackageName(), 0);
                result = new PluginResult(Status.OK, packageInfo.versionCode);
            }
            catch (NameNotFoundException nnfe) {
                result = new PluginResult(Status.ERROR, nnfe.getMessage());
            }
        }

        return result;
    }
} 
```

在 plugins.xml 中，添加以下行：

```
<plugin name="Version" value="your.package.Version" /> 
```

在您的`deviceready`事件中添加以下代码：

```
var Version = function() {};
Version.prototype.getVersionCode = function(successCallback, failureCallback) {
    return cordova.exec(successCallback, failureCallback, 'Version', 'GetVersionCode', []);
};

if(!window.plugins) {
    window.plugins = {};
}
if (!window.plugins.version) {
    window.plugins.version = new Version();
} 
```

然后，您可以通过执行以下操作获取 versionCode 属性：

```
window.plugins.packageManager.getVersionCode(
    function(versionCode) {
        //do something with versionCode
    },
    function(errorMessage) {
        //do something with errorMessage
    }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-30T07:58:08.577

需要稍作改动.. 类应该扩展“**扩展 CordovaPlugin** ”

然后“ **this.cordova.getActivity().getPackageName()** ”将起作用。

在 plugins.xml 中，添加以下行：

但是对于 Cardova > 2.0 ，您需要在**xml 文件夹中添加****config.xml**

# php - 需要某种设置来在 php 中调用 linux 命令

> ID：15178470
> 
> 赞同：0
> 
> 时间：2013-03-02T19:30:16.767
> 
> 标签：php, linux, command

这里是我的名为 test.php 的测试文件的内容

```
<?php
echo exec('ls -al');
?> 
```

当我将它 ftp 到我的主机并通过调用 /test.php 运行它时，它很好地显示了我的目录的内容。但是当我将此文件放在我的个人服务器（ubuntu 12.04）上时，它不会显示任何内容。我测试了更多命令，它们在我的域上运行良好，但在我的个人服务器上却没有。所以，我认为这是某种设置，但我不知道。有人可以提示我设置什么，以便我可以从 php 调用 linux-commands 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:45:22.207

应该是文件权限问题。检查不工作的系统上的网络服务器错误日志。还要比较它在两个系统上运行的目录的文件权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:39:58.867

检查您的 php.ini 定义，必须是未正确设置的标志。

看看这里，它很好地解释了你需要什么。

[http://php.net/manual/en/function.system.php](http://php.net/manual/en/function.system.php)

# java - 通过另一台服务器向服务器发送请求，从最终服务器获取响应

> ID：15178472
> 
> 赞同：0
> 
> 时间：2013-03-02T19:30:25.000
> 
> 标签：java, tcp, proxy, serversocket, gateway

我正在构建一个由网关（服务器 A）和跟随者（服务器 B）组成的系统。当客户端向服务器A发送请求时，服务器A会将请求转发给服务器B。我希望服务器B直接将响应发送给客户端，而无需打扰服务器A。我基本上将服务器A用作网关。

你认为这是一个好的编程习惯吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:34:12.917

除了有关您的通信协议的问题之外，我还看到了一个基本问题：服务器 B 如何知道您的客户端。服务器 A 知道，因为它被它联系了。在查询响应方法中，客户端等待服务器 A 响应。服务器 A 知道客户端，因为它收到了来自客户端的请求。客户端知道等待来自 A 的响应，因为它首先联系了它。B 对客户端一无所知，只知道服务器 A。虽然理论上服务器 A 可以将有关客户端的信息发送给 B，但 B 现在必须能够连接到客户端才能发回信息。

更好的设计是让服务器 A 处理双向通信，并使用服务器 B 和任何其他服务器来处理工作。当您的系统太大以供单个服务器 A 处理时，您可以引入负载平衡器来将流量引导到多个服务器 A。

# php - PHP设置COOKIE，用JQUERY COOKIE插件改，不能用php编辑？

> ID：15178473
> 
> 赞同：1
> 
> 时间：2013-03-02T19:30:25.897
> 
> 标签：php, javascript, jquery, cookies, jquery-cookie

我正在使用一些简单的代码作为测试，因为我的页面无法正常工作，也许我错过了什么？！我有谷歌这个问题并在这里搜索但似乎没有人提到它！甚至在我读过的饼干上！

我有一个简单的 setcookie php 代码行：

```
<?php 
if($_COOKIE['PHP1'] !== 'php'){
$blah = setcookie('PHP1','php',time() + (1000 * 120),'/','',false,false);}
?> 
```

它在任何 html 之前的页面顶部，并将 cookie PHP1 设置为 php 就好了；

然后我在正文上有一些代码：

```
<?php 
if($blah){echo 'PHP1 has been set';}
else {
    echo 'cookie php1 = ' . $_COOKIE['PHP1'];}
?> 
```

告诉我是否设置了 cookie，或者如果设置了，值是什么。直截了当，工作正常...

（页面有 jquery 和 jquery 插件 :COOKIE:linked;）然后，我使用控制台检查 cookie 的值并使用 cookie 插件更改值，代码如下：

```
$.cookie('PHP1');
--"php"
$.cookie('PHP1','javascript', { expires: 7, path: '/' });
--"PHP1=javascript; expires=Sat, 09 Mar 2013 19:00:57 GMT; path=/"
$.cookie('PHP1');
--"javascript" 
```

一切都很好，所以我刷新页面，php告诉我，正如预期的那样设置了PHP1；然后再次刷新希望看到 php1 = php 但它只是一直说 PHP1 已设置！

如果我编辑 PHP 代码只是为了向我展示 PHP1 的值，它会告诉我 PHP1 的值是 javascript 吗？

我在这里做错了吗？还是只是在 javascript 被篡改后我无法使用 php 编辑 cookie？（我想这可能是安全性？）

cookie 本身不用于任何登录或安全功能，它仅用于可访问性 - 文本大小 - 色盲设置。我希望能够同时使用这两种情况，以防 javascript 因任何原因被/被禁用！

提前致谢

**编辑**

好的，我已经在 chrome 中查看了我的 localhost 的 cookie，并且有两个 PHP1 cookie：

```
Name:   PHP1
Content:    php
Domain: localhost
Path:   /
Send For:   Any kind of connection
Accessible to Script:   Yes
Created:    Saturday, 2 March 2013 19:01:21
Expires:    Monday, 4 March 2013 04:21:21

Name:   PHP1
Content:    javascript
Domain: localhost
Path:   /Cookie_test
Send For:   Any kind of connection
Accessible to Script:   Yes
Created:    Saturday, 2 March 2013 18:50:08
Expires:    When the browsing session ends 
```

我认为第二个 /Cookie_test 路径是 javascript 路径！所以如果这是问题所在，我怎样才能让javascript将路径写为“/”而不是dir？正如你从我的代码中看到的那样，我给它的路径是“/”？

实际上是因为我没有像在 php 中那样添加第 5 个选项吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:53:18.797

为了扩展@MIIB 的评论，PHP[`setcookie()`函数](http://php.net/setcookie)和`$_COOKIE`超全局不直接交互。

正如“常见陷阱”下的手册所述：

> 直到下次加载 cookie 应该可见的页面时，cookie 才会变得可见。

实际上，`$_COOKIE`在 PHP 脚本一开始就根据*从浏览器接收到*的 cookie 创建；`setcookie()`另一方面定义当脚本发送其输出时哪些 cookie 将被*发送到浏览器。*

您可能希望将您的`setcookie`调用包装在也覆盖的东西中`$_COOKIE`（或者，更好的是，拥有自己的对象`getCookie`和`setCookie`方法）。

**编辑：**作为这种直接写入的函数的一个非常简单的例子`$_COOKIE`：

```
function set_cookie_and_superglobal($cookie_name, $cookie_value)
{
    // For simplicity, this hard-codes the same parameters as the code in the question, and just generalises the name and value
    setcookie($cookie_name, $cookie_value, time() + (1000 * 120),'/','',false,false);
    $_COOKIE[$cookie_name] = $cookie_value;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T22:05:39.707

我的问题，正如[这里](https://stackoverflow.com/a/12092489/939730)所讨论的，是由于本地主机！如果我使用我的环回（127.0.0.1），它可以完美地工作，当我按照我所说的那样做的时候。我读到它与本地主机中没有“。”和一些浏览器（如 chrome）不喜欢它有关！！

部分问题是 jquery 会读取 php cookie，然后设置自己的第二个 cookie，其中包含我在问题中编辑的路径中的额外详细信息。然后 PHP 会按照它应该的方式读取这个但是当再次设置一个 cookie 时会“编辑”它的旧 cookie 但仍然从 Jquery cookie 中读取！！！

# javascript - 使用 iframe 本身缩放 iframe 内容？

> ID：15178476
> 
> 赞同：0
> 
> 时间：2013-03-02T19:30:38.410
> 
> 标签：javascript, html, iframe, zooming, scale

我有这个用于缩放内容的代码`iframe`

```
function SetZoom(){
var ZoomValue = 100;

try{
iframeDoc.body.style.zoom=ZoomValue+'%';
}catch(err){}
try{
iframe.body.style.OTransform = 'scale('+(ZoomValue/100)+')';
}catch(err){}

} 
```

现在我需要模仿 iframe 的缩放，例如

```
iframe.style.width=(??????/ZoomValue)+'px';
iframe.style.height=(??????/ZoomValue)+'px'; 
```

不知道应该用什么代替`???????`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:08:19.310

****编辑**** 这应该对您有更好的帮助，只需`initZoom()`在 iframe 添加到 DOM 后调用。

```
var origWidth, origHeight;

// Call this once on page load
function initZoom(){
  // If you know the iframe's size is in pixels
  origWidth = parseFloat(iframe.style.width);
  origHeight = parseFloat(iframe.style.width);
}

// Call every time you change the zoom level
function zoom(size){
  iframe.style.width = (origWidth * size) + 'px';
  iframe.style.height = (origHeight * size) + 'px';
} 
```

感谢您`Basic`的建议。

# javascript - HTTP 请求的默认超时时间是多少？

> ID：15178479
> 
> 赞同：2
> 
> 时间：2013-03-02T19:30:46.693
> 
> 标签：javascript, http, timeout

当我在浏览器中加载某些内容时，浏览器尝试建立连接的默认时间是多少？

这可以在 Javascript 或 HTML 中增加吗？

我需要的情况是没有服务器端循环的服务器端时间采样等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T19:32:53.650

无法从您的前端设置，因为它是服务器端配置。

# c - 如何正确长时间维护一个监听端口？

> ID：15178480
> 
> 赞同：12
> 
> 时间：2013-03-02T19:30:59.773
> 
> 标签：c, sockets, daemon

我用纯 C 语言编写了这个小型服务器应用程序，它侦听给定端口中的传入连接，非常简单。

它使用通常的套接字初始化过程，创建到端口的`socket()`then `bind()`，说它的 a `listen()`，并无限循环`select()`等待传入的连接到`accept()`。

一切都很好，就像一个魅力，除了如果我让这个东西运行几个月，监听端口会关闭，而应用程序服务器会一直运行而不知道它，因为我写它是为了相信监听套接字不会关闭，如果没有告诉。

所以问题是：为什么在我的应用程序不关心的情况下关闭端口，我能做些什么来防止它发生？

这是预期的行为吗？我应该检查某种异常还是在侦听套接字上进行“健康检查”以在必要时重新打开它？

代码：[https](https://gist.github.com/Havenard/e930be035a3bee75c018) ://gist.github.com/Havenard/e930be035a3bee75c018 （是的，我意识到我正在`0`用作错误提示，这是不好的做法和东西，但正如我在评论中解释的那样，它与问题无关，当我将套接字文件描述符设置为`0`它是为了停止循环并关闭应用程序）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T19:40:42.847

我将从清理它开始：

*   把它切割成更小的、可读的、可验证的、可测试的函数
*   链表的使用看起来很乱；它可以简化很多，也许通过引入一些通用函数。
*   用更易读的 ' ' 等价物替换所有愚蠢的 '\x20' 字符常量
*   避免像这里这样的显式魔法常数`if (n_case > 0) memcpy(nick, node->nick, (n_case > 32 ? 32 : n_case));`；sizeof 是你的朋友。
*   不要使用零作为未使用文件描述符的标记值；改用 -1。
*   对大小和索引使用无符号类型；负索引会破坏内存，折叠无符号类型会很快失败。（failfast 是你的朋友）

这只是几个小时的编辑。

我的猜测是，在清理/重构之后，你的“bug”会神奇地浮出水面。

*脚注：不，我不会为你做你的工作。不是为了100分，不是为了1000分。请收拾你自己的烂摊子。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T21:25:36.720

这个答案主要是对你打电话的地方的代码审查`close()`。

第 330 行：您关闭了套接字，但不要像在代码中的其他地方那样立即继续。这可能会导致奇怪的行为。

第 928 行：在大多数地方，您`0`在调用`close()`. 你不会在这个电话之后。

第 1193 行：与第 928 行相同的注释。

第 1195 行：与第 928 行相同的注释。

第 1218 行：与第 928 行相同的注释。

第 1234 行：与第 928 行相同的注释。

第 1236 行：与第 928 行相同的注释。

当我编译带有完整警告的代码时，我看到编译器注意到函数声明返回值的许多地方，但没有返回值。

```
x.c:582: warning: no return statement in function returning non-void
x.c:591: warning: no return statement in function returning non-void
x.c:598: warning: no return statement in function returning non-void
x.c:609: warning: no return statement in function returning non-void
x.c:620: warning: no return statement in function returning non-void
x.c:728: warning: no return statement in function returning non-void
x.c:779: warning: no return statement in function returning non-void 
```

如其他帖子所述，还有许多其他问题。

至于调试这个问题，如果我怀疑绑定套接字被提前关闭，我会`close()`用我自己的版本拦截调用，该版本断言正在关闭的描述符不应该与绑定套接字匹配。

然而，正如 wildplasser 所指出的，`select()`如果它被关闭，它将返回一个关于无效描述符的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T22:27:37.687

错误是您使用 0 作为无效的文件描述符。0 完全有效，通常是标准输入。然后在信号处理程序中将侦听器设置为 0。然后您使用 0 作为无 fd，并且在某些时候您在某个套接字上执行 close(0)，有一些分支执行 close(fd) 而不检查它是否为 0，并且有效地关闭了侦听器。阻止侦听器工作的另一个可能选项是溢出积压。

还有一个问题 - 对 fds 使用 unsigned int。系统调用在错误时返回 -1 ... 如果分配给 unsigned int struct identd_node -> unsigned int 句柄，则不会检测到该错误；结构线程节点->无符号整数skt_clnt，skt_serv；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T12:50:11.927

看起来您的代码需要有 2 个连续错误才能导致失败。

如果您从选择中收到错误，为什么不立即打印出原因呢？

在第 281 行， printf errno/perror 找出问题所在？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-13T17:32:57.563

尽管系统不应该像描述的那样运行，但它有时会这样做。对于服务器系统，您通常需要在外部（从脚本）或从代码中的特殊线程执行运行状况检查调用。

因此，如果您检测到连续几次尝试都无法连接到服务器（由于可能的过载情况而需要很少），您可以考虑套接字损坏并重新创建它或重新启动服务器。

# three.js - 在 three.js 中将 DataTexture 应用于以编程方式生成的网格

> ID：15178481
> 
> 赞同：0
> 
> 时间：2013-03-02T19:31:03.820
> 
> 标签：three.js

**实际问题：**

`faceVertexUvs[0]`除了在网格上设置材质之外，我还需要设置更多内容吗？我不知道如何摆脱`glDrawElements`错误。我尝试过使用不同的材料，例如`MeshPhongMaterial`和`MeshLambertMaterial`，但坦率地说，我不确定有什么区别。我也尝试过调用我`computeVertexNormals()`的`computeTangents()`底层几何图形。消防水带方法在这里不起作用..

**以前的描述**

我在运行时使用以三角形镶嵌平面开始的几何图形构建网格。我通过定期更新顶点的 z 坐标来使网格变形。这一切都很好，但是我在使用带有 DataTexture 的材质时遇到了问题。

我收到此错误：

```
glDrawElements: attempt to access out of range elements in attribute 0 
```

我认为此消息意味着它无法找到我的几何图形的 UV 层，但这并不是因为缺少尝试插入向量。这是我将面加载到我的几何中的代码，称为`model`

```
for (j=0; j<vh-1; j++) {
for (i=0; i<vw-1; i++) {

    var a = j*vw+i;
    var b = (j+1)*vw+i;
    var c = (j*vw+i+1);
    var d = (j+1)*vw+i+1;

    model.faces.push( new THREE.Face3(a,b,c) );
    model.faces.push( new THREE.Face3(c,b,d) );

    model.faceVertexUvs[0].push( [ new THREE.Vector2(0,0),
                   new THREE.Vector2(1,1),
                   new THREE.Vector2(1,0) ] );
    model.faceVertexUvs[0].push( [ new THREE.Vector2(0,0),
                   new THREE.Vector2(1,1),
                   new THREE.Vector2(1,0) ] );

}
} 
```

然后我将这个模型和一个材质一起添加到一个 faceMesh 中，然后将它添加到场景中：

```
var material = new THREE.MeshBasicMaterial();
var faceMesh = new THREE.Mesh(model, material); 
```

稍后在代码中我向此材质添加纹理，此时出现上述 gL 错误（在 Chrome javascript 控制台中）

```
material.map = new THREE.DataTexture(new Uint8Array(bytes, rgbByteIdx), 
                     inputW, inputH, THREE.RGBFormat);

material.needsUpdate = true; 
```

`faceUVs`除了`faceVertexUVs`在构建几何图形时，我还尝试过使用。也许我需要为此使用 MeshBasicMaterial 以外的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T03:21:22.677

经过多次反复试验，我想通了。

这里的问题是我最初设置我`MeshBasicMaterial`的没有纹理。在添加纹理并`needsUpdate`为此材质设置标志后，它继续抛出 gL 错误。

通过最初创建具有特定纹理的材质（使用`ImageUtils.generateDataTexture`），系统接受稍后添加的纹理，错误消失，并且我成功地在网格上绘制了我的图片。

```
var texture = THREE.ImageUtils.generateDataTexture(inputW, inputH, initColor );
var material = new THREE.MeshBasicMaterial( { map : texture });
var faceMesh = new THREE.Mesh(model, material); 
```

# php - Ko(mu)stache - 多维数组

> ID：15178482
> 
> 赞同：0
> 
> 时间：2013-03-02T19:31:10.510
> 
> 标签：php, kohana, mustache, kostache

我有一张这样的桌子：

```
<table>
<?php foreach($var as $val): ?>
<tr>
<?php foreach($val as $row): ?>
<td> ... </td>
<?php endforeach; ?>
</tr>
<?php endforeach; ?>
</table> 
```

我怎样才能用小胡子编码呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:51:08.587

假设您正在使用[KOstache](https://github.com/zombor/KOstache)模块，`Kostache::factory()`并在控制器中分配多维数组。然后使用[隐式迭代器](https://github.com/bobthecow/mustache.php/wiki/Mustache-Tags)遍历所有元素。

# mysql - 如何开发 3d 数据可视化图表？

> ID：15178483
> 
> 赞同：0
> 
> 时间：2013-03-02T19:31:11.660
> 
> 标签：mysql, facebook, web-services, design-patterns

我可以使用哪些服务来开发类似于 Facebook 的 3d 图表？

我希望能够使用 mysql 数据来用数据填充图表。

![脸书图](../Images/7baa0305f7888e1c2ba2e16fae103554.png)

[![关系图](../Images/d6b8bbed083883485cd64ce9568940f4.png)](https://i.stack.imgur.com/IPYyA.jpg)
[（来源：[searchenginestrategy.org](http://searchenginestrategy.org/wp-content/uploads/2010/08/social_graph.jpg)）]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:55:01.083

Arbor JS 是一款非常灵活且易于使用的出色工具：http: [//arborjs.org/](http://arborjs.org/)

# redirect - 我完全感到困惑......我如何将 www 和非 www 重定向到新域？

> ID：15178484
> 
> 赞同：1
> 
> 时间：2013-03-02T19:31:15.383
> 
> 标签：redirect, no-www, iirf

我最近成功移动了域，但我没有意识到该网站有两个版本：www 和非 www

我想将流量从我的非 www 网站重定向到我的新域...

这是 iirf.ini 文件目前的样子：

```
RewriteCond %{HTTP_HOST} ^www\.foo\.com/? [NC]
RedirectRule ^(.*)$ http://www.bar.com$1 [L,R=301] 
```

如何设置它以便它也重定向非 www 站点？

请帮忙，因为我很困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T10:50:53.297

尝试添加此规则：

```
RewriteCond %{HTTP_HOST} ^(bar|foo)\.com/? [NC]
RedirectRule ^(.*)$ http://www.bar.com$1 [L,R=301] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-09T02:54:37.910

您不能在一个语句中重定向两个版本。好吧，您可能“可以”，但这不是正确的方法。正确的做法是这样的：

1）将旧域从 www 重定向到非 www 版本（在属于**旧**域的 .htaccess 文件中执行此操作）

2) 将新域从 www 重定向到非 www 版本（在属于**新**域的 .htaccess 文件中执行此操作）

3) 将旧域的旧非 www 版本重定向到新域的新非 www 版本（在属于**旧**域的 .htaccess 文件中执行此操作）

* * *

所以这里是演习：

1）这会将旧域从 www 重定向到非 www：

```
RewriteCond %{HTTP_HOST} ^www.olddomain.com [nc]
RewriteRule (.*) http://olddomain.com/$1 [R=301,L] 
```

2）这会将新域从 www 重定向到非 www：

```
RewriteCond %{HTTP_HOST} ^www.newdomain.com [nc]
RewriteRule (.*) http://newdomain.com/$1 [R=301,L] 
```

3）这会将旧域重定向到新域（非 www 版本）：

```
RewriteCond %{HTTP_HOST} ^olddomain.com [NC]
RewriteRule ^(.*)$ http://newdomain.com/$1 [R=301,QSA,L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:12:04.253

网络级解决方案： 1\. 将您的外部 DNS 指向 www 域的相同公共 IP，以便两个域都指向相同的 IP。

例如。www.abc.com - 111.111.111.111 adb.com - 111.111.111.111

# node.js - 使用 telnet 的 Node.js 测试服务器 - 设置 Linemode

> ID：15178487
> 
> 赞同：0
> 
> 时间：2013-03-02T19:31:29.333
> 
> 标签：node.js, telnet

有人可以告诉我如何将 linemode 设置为 telnet 测试吗？我google了很多，但不幸的是我没有成功。我有这个超级简单的代码

```
var net = require('net');

var server = net.createServer(function(c) {
  console.log('socket opened');
  c.setEncoding('utf8');
  c.on('end', function() {
    console.log('connection/socket closed');
  });
  c.on('data', function(data) {
    console.log('Data:'+data);
    c.write('Answer:'+data);
    // c.end(); // close socket/conection
  });
});

server.listen(8124, function() { // start server (port 8124)
  console.log('server started');
}); 
```

但测试看起来像这样：

**客户：**

```
Microsoft Telnet> open localhost 8124
Answer:dAnswer:daAnswer:atAnswer:taAnswer:a 
```

**服务器：**

```
C:\Users\Laura\node server.js
server started
socket opened
Data:d
Data:a
Data:t
Data:a 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T09:18:41.217

你想得到如下的telnet输入

```
Answer: a
Answer: b
Answer: c 
```

那么你需要`\r is carriage return`用`line feed (\n)`. 所以你的代码应该像下面这样

```
var server = net.createServer(function(c) {
    console.log('socket opened');
    c.setEncoding('utf8');
    c.on('end', function() {
        console.log('connection/socket closed');
    });
    c.on('data', function(data) {
        console.log('Data:'+data);
        c.write('\r\nAnswer:');
        // c.end(); // close socket/conection
    });
}); 
```

# php - 我如何将数组传递给mysql语句

> ID：15178488
> 
> 赞同：0
> 
> 时间：2013-03-02T19:31:40.630
> 
> 标签：php, mysql, arrays

好的，所以我有一个问题，我需要将一组产品 ID 传递给下面的 sql 语句

```
$index = 0;
  $products = $cart->get_products();
  for ($i=0, $n=sizeof($products); $i<$n; $i++) {
   $prod = $products[$index]['id'];

 if (strpos($prod,"{")){
 $product = preg_split("^[{}]^",$prod);
 }else{
 $product = $prod;
 }
 }
$product_query = tep_db_query("select cb.products_id, SUM(cb.customers_basket_quantity),SUM(p.products_rate)  from " . TABLE_PRODUCTS . " p INNER JOIN " . TABLE_CUSTOMERS_BASKET . " cb ON p.products_id = cb.products_id   
WHERE cb.customers_id ='" . $customer_id ."'
AND p.products_id IN '".$product ."'
"); 
```

结果总是

```
1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''Array'' at line 3 
```

select cb.products_id, SUM(cb.customers_basket_quantity),SUM(p.products_rate) from products p INNER JOIN customers_basket cb ON p.products_id = cb.products_id WHERE cb.customers_id ='3' AND p.products_id IN 'Array'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:35:37.057

**（如果您自己制作（而不是 PDO 参数等），请非常小心您插入 SQL 的内容！）**

确保 $product 是一个数组：

```
$product = (array)$product; 
```

然后转义它的值：

```
$product = array_map('your_db_escape_function', $product); 
```

然后对其进行字符串化：

```
$product = "'" . implode("', '", $product) . "'"; 
```

然后将其添加到查询中：

```
"... p.products_id IN (" . $product . ")" 
```

在您的代码编辑后，我认为这就是您想要的：

```
$products = $cart->get_products();
$productIds = array_map(function($product) {
    return (int)$product['id'];
}, $products);
$productIds = implode(', ', $productIds);

$query = tep_db_query("
    select cb.products_id, SUM(cb.customers_basket_quantity),SUM(p.products_rate)
    from " . TABLE_PRODUCTS . " p
    INNER JOIN " . TABLE_CUSTOMERS_BASKET . " cb ON p.products_id = cb.products_id
    WHERE cb.customers_id ='" . $customer_id ."'
    AND p.products_id IN (" . $productIds . ")
"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:34:05.600

使它像这样`IN (1, 2, 3, 4, 5)`使用`implode(',', $product);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:50:33.293

好的，想通了！这是我需要的一个变量，所以它现在读取

```
$id = $this->rate($id);
   $qty = $cart->count_contents($id); 
```

在我的公式中返回正确的数量！

# python - Flask - 更改项目结构后无法获取 Facebook APP ID

> ID：15178489
> 
> 赞同：0
> 
> 时间：2013-03-02T19:31:45.210
> 
> 标签：python, facebook, flask

我正在 Flask 中创建一个 Facebook 应用程序。由于这是一个微框架，我从教程开始，并将所有内容放在 2 个文件中：app.py 和 conf.py（以及 /templates 之类的其他文件）。

在基本结构中（主要由 heroku 生成）是这样的：

```
/game
     game.py
     conf.py 
```

应用程序.py

```
FB_APP_ID = os.environ.get('FACEBOOK_APP_ID')
FB_APP_SECRET = os.environ.get('FACEBOOK_SECRET')

requests = requests.session()
app_url = 'https://graph.facebook.com/{0}'.format(FB_APP_ID)
FB_APP_NAME = json.loads(requests.get(app_url).content).get('name')
FB_APP_LOGO = json.loads(requests.get(app_url).content).get('logo_url')

app = Flask(__name__)
app.config.from_object(__name__)
app.config.from_object('conf.Config')

@app.route('/channel.html', methods=['GET', 'POST'])
def get_channel():
    return render_template('channel.html')

@app.route('/')
def index():
    return 'index'+str(FB_APP_ID)

if __name__ == '__main__':
    port = int(os.environ.get("PORT", 5000))
    print requests.headers
    if app.config.get('FB_APP_ID') and app.config.get('FB_APP_SECRET'):
        app.run(host='0.0.0.0', port=port)
    else:
        print 'Cannot start application without Facebook App Id and Secret set' 
```

配置文件

```
import os

class Config(object):
    DEBUG = True
    TESTING = False
    LOG_LEVEL = os.environ.get('LOG_LEVEL', 'DEBUG')
    FBAPI_APP_ID = os.environ.get('FACEBOOK_APP_ID')
    FBAPI_APP_SECRET = os.environ.get('FACEBOOK_SECRET')
    FBAPI_SCOPE = ['user_likes', 'user_photos', 'user_photo_video_tags'] 
```

我想让它成为完美的 MVC，所以我使用[了这个链接](http://flask.pocoo.org/docs/patterns/packages/)，问题就开始了。

```
/game
    conf.py
    runserver.py
    /game
        /templates
        /static
        __init__.py
        views.py
        models.py 
```

运行服务器.py

```
import os
from game import app

if __name__ == '__main__':
    port = int(os.environ.get("PORT", 5000))
   # print requests.headers
    if app.config.get('FB_APP_ID') and app.config.get('FB_APP_SECRET'):
        app.run(host='0.0.0.0', port=port)
    else:
        print 'Cannot start application without Facebook App Id and Secret set' 
```

__init__.py

```
from flask import Flask
import os,  requests, json

SCRIPTS='static/scripts/'

FB_APP_ID = os.environ.get('FACEBOOK_APP_ID')
FB_APP_SECRET = os.environ.get('FACEBOOK_SECRET')

requests = requests.session()
app_url = 'https://graph.facebook.com/{0}'.format(FB_APP_ID)
FB_APP_NAME = json.loads(requests.get(app_url).content).get('name')
FB_APP_LOGO = json.loads(requests.get(app_url).content).get('logo_url')

app = Flask(__name__)
app.config.from_object(__name__)
app.config.from_object('conf.Config')

import game.views
import game.models 
```

conf.py 保持不变，索引视图在视图中。

问题：在第一个结构（简单）中，os.environ 得到了所有的 FB_APP_ID 和 FB_APP_SECRET，我可以随心所欲地处理数据。

现在（在 MVC 中）它只是不获取变量，而我所拥有的是“无”。我试图把 __init__ == __main__ 放在任何我能做的地方，但没有任何效果。

conf.py 将所有数据放在开头（如 DEBUG=TRUE 或 LOG LEVEL）。这只是我没有得到的fb数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-26T03:01:04.947

您需要在您的环境中设置 FACEBOOK_APP_ID 和 FACEBOOK_SECRET

假设您的虚拟环境名为 venv

在项目根目录中创建一个名为 .venv 的文件（与 requirements.txt、Procfile、.gitignore 等相同的目录）

添加将其放入文件并保存：

```
FACEBOOK_APP_ID=1234...
FACEBOOK_SECRET=ABCD... 
```

您的 FACEBOOK_APP_ID 和 FACEBOOK_SECRET 可以通过转到 developers.facebook.com 上您的应用程序的基本设置找到

# android - 在android中移动棋子

> ID：15178492
> 
> 赞同：0
> 
> 时间：2013-03-02T19:31:55.460
> 
> 标签：android

我设计了一个使用表格布局的国际象棋用户界面。每个布局由 8 个按钮组成，因此总共有 64 个按钮。我对棋子使用 ASCII 值。现在我想通过单击源按钮和目标按钮将碎片从一个地方移动到另一个地方。

哪个事件更好用，怎么可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:37:10.823

You can use button onClick event. When you select source set some flag with respect to selected item. And when you select destination change the flag value to default something like -1.

# c - 如何防止类型转换过程中的数据丢失？

> ID：15178493
> 
> 赞同：0
> 
> 时间：2013-03-02T19:32:03.993
> 
> 标签：c

我试图使用 fread 从文件中读取比特流

```
fread(buff, buffSize, 1, fp); 
```

. `buff is the buffer to which i am reading` . `buffSize is the size of buffer`，以及`fp is the file pointer`我正在阅读的内容。将数据读取到缓冲区后，我尝试将缓冲区内容类型转换为另一个结构变量。结构的形式

```
typedef struct data
{
    char    id;
    short   value1;
    short   value2;
    ....
}data; 
```

我所做的是

```
data* var;
var = (data*)buff; 
```

然后我尝试访问结构内的变量，如果比特流是这样`00 b0 11 c1 00`的话， `var->id`应该是`0x00`. `var->value1`应该是而且`0xb011`应该`var->value2`是`0xc100`

但我得到的是

```
var->id = 0x00;
var->value1 = 0x11c1;
... 
```

为什么我没有达到预期的效果？当我将第一个参数类型更改为 short 时，值进入了`var->id was 0x00b0`. 有没有像最小访问大小这样的东西`2 Bytes`？如何解决这个问题？我只想读取第一个字节到`var->id`字段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:34:11.050

发生这种情况是因为之前有一个[填充字段](http://en.wikipedia.org/wiki/Data_structure_alignment)`value1`，用于对齐。如果您想摆脱它，请指示您的编译器“打包”该结构。每个编译器都有不同的语法。例如，`gcc`你会说：

```
struct  __attribute__ ((__packed__)) data {
    /* ... */
}; 
```

# mysql - INDEX 或 FULLTEXT 在 MySql 中存储 VARCHAR(1000)

> ID：15178496
> 
> 赞同：1
> 
> 时间：2013-03-02T19:32:13.480
> 
> 标签：mysql, indexing, varchar, full-text-indexing

**我的目的**：
我需要进行`SELECT WHERE string IN ('...')`查询，并且`string`是`VARCHAR (1000)`

**问题：**
我不知道我应该为它使用*FULLTEXT*索引还是只使用一个简单的*INDEX*

**问题：**
搜索将`UNION`在查询中使用两个相似的表进行多次搜索，其中包含两个`string`字段，所以我不知道*FULLTEXT*是否会使其更快。
*（我对 FULLTEXT 索引的想法是将它们与 MATCH AINST 查询一起使用）*

**结构：**
您可以`string`在我之前在[How to structure this DATABASE idea中提出的问题中看到我如何在不同表中构建多个字段](https://stackoverflow.com/questions/15177338/how-to-structure-this-database-idea-to-make-it-the-fastest-and-cleanest-as-possi)

**注意：**
这个问题是关于哪种类型的 INDEX 更适合这种情况。我只是将结构化问题联系起来，以便为读者提供更多关于我在做什么的参考。它不是重复的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:11:05.527

**1-N**

如果您的单词和短语很常见并且会在许多行之间重复，您应该考虑将它们分成 1-n 关系。这样，通过将数据与您的数据连接起来，搜索和查询数据会更加高效。这可能不符合您的要求——这完全取决于单词和短语的类型。

**全文**

索引 varchar 1000 是一个坏主意（我不喜欢做出假设，但这通常总是不好的）。如果您的数据集增长，这不仅会使用大量内存和索引空间，当它开始成为问题时，这将是一个难以解决的性能瓶颈。这就是[FULLTEXT](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)存在的原因，如果您使用 MySQL 5.6 或更高版本，您现在也可以在 INNODB 表上使用[FULLTEXT](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html) - 如果您使用的是旧版本，不幸的是，它只会在 MyISAM 中受支持，并且存储引擎有缺点（一些相当大的缺点，所以请在选择之前研究一下）。

**适当的搜索**

最好的解决方案是使用适当的搜索引擎，例如[Lucene](http://www.google.co.uk/url?sa=t&rct=j&q=lucene&source=web&cd=1&cad=rja&sqi=2&ved=0CC8QFjAA&url=http://lucene.apache.org/core/&ei=j1UyUY7TNrCo0AXh2YH4Bg&usg=AFQjCNFUWH4QNE3qjb53P9oILG1p3LwpdQ&bvm=bv.43148975,d.d2k)、[Sphinx](http://www.google.co.uk/url?sa=t&rct=j&q=sphinx%20&source=web&cd=3&cad=rja&ved=0CEAQFjAC&url=http://sphinxsearch.com/&ei=n1UyUeyWL6uR0QX8woDgDw&usg=AFQjCNGQGvt8zHAS8QC4ogh8IS4850XgJA&bvm=bv.43148975,d.d2k)或[Xapian](http://www.google.co.uk/url?sa=t&rct=j&q=xapian%20search&source=web&cd=1&cad=rja&ved=0CDAQFjAA&url=http://xapian.org/&ei=s1UyUa7bCIrN0QWjhYCgDQ&usg=AFQjCNGM5Sa2hXktsiZR_x-rXyQ8kbZytA&bvm=bv.43148975,d.d2k)

# scala - 使用 Scala 泛型：Class[T] 不带参数

> ID：15178499
> 
> 赞同：3
> 
> 时间：2013-03-02T19:32:16.207
> 
> 标签：scala, generics

我有一个 Java 应用程序，我想迁移到 Scala。所以我有这个内部类（原来的，你可以在这里找到：http: [//developer.android.com/reference/android/app/ActionBar.html#newTab(](http://developer.android.com/reference/android/app/ActionBar.html#newTab())`public static class TabListener ...` ) :)

```
class MyListener[T <: MySuperClass]
    (var myClass: Class[T], ...) 
    extends MyActionListener { ... } 
```

我的问题是，如何调用这个类。我试过这个：

```
myObject.setMyListener(
    new MyListener[MySubClassOfMySuperClass]
    (classOf(MySubClassOfMySuperClass), ...)); 
```

但是我的 IDE 中出现错误（classOf(MySubClassOfMySuperClass)）：

```
Class[T] does not take parameters 
```

所以，我有两个问题：

*   我的 Scala`class MyListener`定义是否正确，尤其是`Class[T]`因为我从 Java 代码中复制了它（请参阅 Android API 的超链接）？
*   我必须做什么才能`new MyListener`工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-02T19:38:58.547

Scala 总是使用方括号作为类型参数，所以你想要做的就是这样：

```
myObject.setMyListener(new MyListener[MySubClassOfMySuperClass]
                           (classOf[MySubClassOfMySuperClass],  ...)); 
```

顺便说一句，令人困惑的诊断是因为`classOf`产生 的实例的`java.lang.Class`，不是可以像函数或方法那样调用的值（“不接受参数”）。请记住，Scala 总是会尝试将类型参数推断为泛型`classOf`，奇怪的是，它在没有任何类型参数的情况下使用时会成功。它推断类型`Nothing`：

```
scala> classOf
res1: Class[Nothing] = null 
```

# r - 函数 `[<-` 将_replace_一个元素，但不附加一个_element_

> ID：15178507
> 
> 赞同：8
> 
> 时间：2013-03-02T19:32:40.347
> 
> 标签：r, variable-assignment

我在使用时注意到以下内容`'[<-'`。我成功地*替换*了元素，但没有将元素*附加*到向量。

例子：

```
VarX <- integer()
VarX[1] <- 11
`[<-`(VarX, 2, 22)
VarX
# [1] 11

# Expected the value of VarX to be:  
# [1] 11 22

# Also tried: 
`[<-`(VarX, i=2, value=22)
VarX 
# [1] 11 
```

但是，如果索引处已经有一个值，则该值会被替换。

```
VarX <- integer()
VarX[1] <- 11
VarX[2] <- 99
VarX
# [1] 11 99
`[<-`(VarX, 2, 22)
VarX
# [1] 11 22 
```

我只是语法错误，还是如预期的那样？任何进一步了解这里发生的事情将不胜感激。

*请注意，除了更好地理解语言之外，这里没有具体的目标。*

### 关于@Roland 和@Dason 评论的更新。

该行为似乎与最初分配对象值的方式有关。例如，当分配给`VarX`is的值`1:2`与[<-`c(1, 2)`的行为时，会给出不同的结果，如下所示：``(VarX, 2, 22)``

 `### 更改未保存到 VarX

```
rm(VarX)  # actually ran:     rm(list=ls(all=TRUE))
VarX <- 1:2
VarX
# [1] 1 2

`[<-`(VarX, 2, 22)
# [1]  1 22

VarX
# [1] 1 2 
```

### 更改已保存到 VarX

```
rm(VarX)  # actually ran:     rm(list=ls(all=TRUE))
VarX <- c(1, 2)
VarX[2] <- 2
VarX
# [1] 1 2

`[<-`(VarX, 2, 22)
# [1]  1 22

VarX
# [1]  1 22 
```

* * *

* * *

```
> sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-02T20:24:41.503

该函数`'[<-'`可能不会替换其第一个参数中的任何内容。在某些情况下，它会复制对象并对其进行修改。

请参阅语言定义的第 3.4.4 节：

```
x[3:5] <- 13:15

The result of this commands is as if the following had been executed

‘*tmp*‘ <- x
x <- "[<-"(‘*tmp*‘, 3:5, value=13:15)
rm(‘*tmp*‘) 
```

`x`如果必须修改的结构，这基本上就是将运行的内容。但是，根据 OP（和其他人，包括我自己）的实验，很明显该`"[<-"`函数可以就地修改元素。显然，如果要替换整个对象，则无法就地执行任何操作。

就地替换：

```
> x <- 1:2
> class(x)
[1] "integer"
> `[<-`(x, 2, 99L)
[1]  1 99
> x
[1]  1 99 
```

由于类型已更改（在`C`函数中`SubAssignTypeFix`）而替换整个对象：

```
> x <- 1:2
> class(x)
[1] "integer"
> x[2] <- 99
> class(x)
[1] "numeric" 
```

对象被替换的另一种情况是对被修改对象的引用不止一个：

```
x <- 1:2
y <- x
`[<-`(x, 2, 99L)
## [1]  1 99
x
## [1] 1 2 
```

在调试器下运行R，可以看出间接调用的赋值函数`x[2] <- 99`调用的是`C`函数`do_set`，而直接调用赋值函数时，不会调用这个函数。

`do_set`调用`defineVar`修改适当环境的函数。在就地替换的情况下，对象在环境中替换自身，这正是通过名称调用赋值函数导致对象被修改（未获取副本）的确切情况。

有趣的花絮（见这里：[R object identity](https://stackoverflow.com/questions/10912729/r-object-identity)）

```
#### R console:
x <- 1:2
.Internal(inspect(x))
## @26b27a8 13 INTSXP g0c1 [NAM(1)] (len=2, tl=0) 1,2
x[2] <- 99

#### gdb:
Breakpoint 7, do_set (call=0x2773640, op=0x169e668, args=0x2773870, rho=0x16c6b68) at eval.c:1732   
(gdb) p s
## $135 = (SEXP) 0x192bee0
c

#### R console:
.Internal(inspect(x))
## @192bee0 14 REALSXP g0c2 [NAM(1)] (len=2, tl=0) 1,99 
```

为了直接回答原始问题，当`[<-`放大向量时，会进行复制。从函数`EnlargeVector`中`subassign.c:113`：

```
PROTECT(newx = allocVector(TYPEOF(x), newlen));

/* Copy the elements into place. */
... 
```

这是 R 2.15.2，我从源代码构建，没有优化和调试信息。没有优化就很慢。`

# perl - 无法在我的机器上安装 Net::SSH::Expect perl 模块

> ID：15178509
> 
> 赞同：3
> 
> 时间：2013-03-02T19:32:47.337
> 
> 标签：perl, perl-module

当我尝试安装 Net::SSH::Expect perl 模块时，出现以下错误。

```
perl Makefile.PL
Warning: prerequisite Expect 1.14 not found.
Writing Makefile for Net::SSH::Expect
Writing MYMETA.yml 
```

我期望安装在我的 ubuntu 机器上。

```
expect version 5.45 
```

但是当尝试安装它时仍然会向我抛出这个警告。请指教。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-03T02:50:19.007

“期待 5.45 版？” 我相信最新版本是1.09。键入“期望”。'/usr/bin/expect' 程序与 Perl 的 Net::SSH::Expect 模块不同。当前版本不需要旧版本。但是，它确实要求您的系统上已经安装了 Expect（正确的）。在使用荷鲁斯的命令之前。首先这样做：

```
> sudo cpan Bundle::Expect 
```

如果一切顺利，然后运行命令：

```
> sudo cpan Net::SSH::Expect 
```

'Bundle::Expect' 可能需要交互（或存在一些问题），从而使 cpan 无法自动安装它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T20:05:50.103

它期待 perl 库期待，而不是期待。我会推荐：

```
> sudo cpan Net::SSH::Expect 
```

在命令行。我刚刚让它在 12.04 上正确安装。我的 apt-cache 搜索没有返回 libnet-ssh-expect-perl 的任何内容（所以在 12.04，最后一个 LTS 没有 Ubuntu 包），所以我认为 CPAN 是你最好的选择。

# java - resultset.next() 循环中的打印语句不打印

> ID：15178512
> 
> 赞同：3
> 
> 时间：2013-03-02T19:33:18.113
> 
> 标签：java, oracle, jdbc

我正在处理数据库分配，但遇到了问题。我们需要一次打印出 3 行，在每 3 行的倍数处停止并提示用户继续或中断。

这是将 Java JDBC 与 Oracle 数据库一起使用。

```
if (rset.next()){
    // At this point, there are reviews to show                                                                                                          
    int rinc = 0;
    String seenextreviews = "y";
    System.out.println("Rating - Text - Reviewer - RDate");
    while(rset.next()){
        // Iterate through the result set                                                                                                                
        System.out.println("Increment: " + rinc);
        if(rinc % 3 == 0) {
            // Displayed 3 reviews                                                                                                                       
            seenextreviews = "maybe";
            while(!seenextreviews.equals("y") && !seenextreviews.equals("n")){
                seenextreviews = console.readLine("See next reviews (y/n)? ");
                if (!seenextreviews.equals("y") && !seenextreviews.equals("n")){
                    System.out.println("Invalid input '" + seenextreviews + "'");
                }
            }
            if (seenextreviews.equals("n")) {
                System.out.println("Breaking...");
                break;
            } else {
                System.out.println("Continue...");
            }
        }
        System.out.println(rset.getInt("rating") + " - " + 
            rset.getString("text") + " - " + 
            rset.getString("reviewer") + " - " + 
            rset.getString("rdate"));
        rinc = rinc + 1;
    }
} 
```

对于给定的代码，'if (rset.next())' 中的所有 'System.out.println(values)' 只打印，`System.out.println("Invalid input '" + seenextreviews + "'");`而`System.out.println(rset.getInt("rating")...);`其他所有内容都不会打印。

但是，console.readLine("text") 在询问用户输入之前仍会打印文本。

为什么我的打印报表不打印？将查询更改为一次选择 3 行并调用多个查询的唯一替代方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:38:13.630

> 对于给定的代码，仅在 'if (rset.next())' 中的所有 'System.out.println(values)'

从[`ResultSet#next`](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html#next%28%29)

> 将光标从其当前位置向前移动一行。

因此，看起来您的查询返回单行并且您在`if (rset.next())`条件下读取它，当`while(rset.next())`您从第二行读取到末尾时，但是由于您没有要读取的第二行，因此`while-loop`结束.

可能的解决方案：使用标志打印标题：

```
int rinc = 0;
String seenextreviews = "y";
while(rset.next()) {
    //this serves as flag
    if (rinc == 0) {
        System.out.println("Rating - Text - Reviewer - RDate");
    }
    //rest of your code logic...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T14:00:34.340

你可以这样进行：

```
int rinc = 0;
boolean firstTime = true;
String seenextreviews = "y";

while (rs.next())
{
    if(firstTime)
    {
        System.out.println("Rating - Text - Reviewer - RDate");
        firstTime = false;
    }
    System.out.println(rset.getInt("rating") + " - " + 
            rset.getString("text") + " - " + 
            rset.getString("reviewer") + " - " + 
            rset.getString("rdate"));
    rinc += 1;

    if (rinc == 3)
    {
        boolean flag = false;
        while (true)
        {
            String seenextreviews = console.readLine("See next reviews (y/n)? ");
            if ("N".equalsIgnoreCase(seenextreviews.trim()))
            {
                flag = true;
                break;
            }
            else if ("Y".equalsIgnoreCase(seenextreviews.trim()))
            {
                rinc = 0;
                break;
            }
            else
            {
                System.out.println("Invalid input . Try again");
                continue;
            }
        }
        if (flag)
        {
            break;
        }
    }
} 
```

# c# - 有没有什么情况我在同一个应用程序中得到两个不同的单例？

> ID：15178514
> 
> 赞同：1
> 
> 时间：2013-03-02T19:33:20.330
> 
> 标签：c#, singleton

如果我考虑单例的基本实现，例如：

```
private static Foo instance;
private readonly static Object SyncRoot=new Object();

public static Foo Instance {
    get {
        if(instance!=null)
            return instance;

        lock(SyncRoot) {
            if(instance!=null) {
                return instance;
            }

            instance=new Foo();
            return instance;
        }
    }
} 
```

有没有什么情况我在同一个应用程序中得到两个不同的单例？（带有反射、执行和同步上下文、appdomain 类或任何其他类型的“魔法”的动态 dll 加载？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:36:19.923

是的，可以使用反射，您的代码仅适用于属性，反射可以创建`Foo`没有属性的实例。

```
ConstructorInfo ctor = typeof(Foo).GetConstructors
        (BindingFlags.Instance | BindingFlags.NonPublic)[0];

Foo foo = (Foo) ctor.Invoke(null); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T19:36:22.343

您必须定义“同一应用程序”的含义。如果一个“应用程序”可以跨越多个 AppDomain，那么可以——每个 AppDomain 将有效地拥有一个完全独立的`Foo`类。同样，如果您有使用反射将`instance`字段重置为 null 的受信任代码，您将很容易得到两个实例：

```
var field = typeof(Foo).GetField("instance",
                                 BindingFlags.Static | BindingFlags.NonPublic);

var foo1 = Foo.Instance;
field.SetValue(null, null);
var foo2 = Foo.Instance; 
```

`foo1`并且`foo2`都将是非空的，不同的引用。或者正如 gdoron 的回答所提到的，代码也可以通过反射调用（可能是私有的）构造函数。

在单个 AppDomain 中并且没有任何*故意*引起问题的事情，你应该没问题。

请注意，无论如何我都不推荐这种单例模式的实现。我通常只使用静态初始化程序来使生活变得更加简单。有关更多详细信息，请参阅我[关于单例实现的文章。](http://csharpindepth.com/Articles/General/Singleton.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T19:38:25.317

当然，如果您使用不同的 AppDomain，那么每个 AppDomain 将获得一个实例。我认为如果您处于多线程环境中，您使用的锁定机制也可能存在问题。而不是在 getter 使用中创建实例

```
private static Foo Instance = new Foo(); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-01-02T18:56:35.520

抗反射单例模式：

```
public sealed class Singleton
{
    public static Singleton Instance => _lazy.Value;
    private static Lazy<Singleton, Func<int>> _lazy { get; }

    static Singleton()
    {
        var i = 0;
        _lazy = new Lazy<Singleton, Func<int>>(() =>
        {
            i++;
            return new Singleton();
        }, ()=>i);
    }

    private Singleton()
    {
        if (_lazy.Metadata() == 0 || _lazy.IsValueCreated) 
            throw new Exception("Singleton creation exception");
    }

    public void Run()
    {
        Console.WriteLine("Singleton called");
    }
} 
```

然后尝试一下：

```
 static void Main(string[] args)
    {
        Singleton.Instance.Run();

        ((Singleton) Activator.CreateInstance(typeof(Singleton), true)).Run();
    } 
```

# c - 对来自 getline 的输入进行标记

> ID：15178522
> 
> 赞同：1
> 
> 时间：2013-03-02T19:34:10.123
> 
> 标签：c, string, token, tokenize, strtok

我正在尝试使用 getline() 从键盘获取输入，将其存储在字符串中，对其进行标记，然后打印标记。当我运行它时，我在最后一次迭代（处理来自输入的最后一个标记的迭代）上得到一个 Segmentation Fault 错误。

```
#define _POSIX_C_SOURCE 200809L
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>

////////////////////////
// Main Method        //
////////////////////////
void main() {
    system("clear");
    int ShInUse = 1; // Represents if shell is in use

    char curpath[1024];   // holds current path to print with prompt
    char *UserCommand = NULL;
    size_t combytes = 100;
    UserCommand = (char *) malloc(combytes);
    char *tok;

    // Main loop that shell uses //
    while (ShInUse == 1) {
        getcwd(curpath, sizeof(curpath)); // Store initial working dir
        printf("gash:%s>", curpath);   // print prompt

        getline(&UserCommand, &combytes, stdin);
        tok = strtok(UserCommand, " \n");   // Tokenize input
        if (tok == NULL ) {
            printf("Enter a command.\n");
        } else {
            // Exit command //
            if (strcmp(tok, "exit") == 0) {
                ShInUse = 0;
            } else {
                while (tok != NULL ) {
                    printf("You entered a command.\n");
                    printf("tok: %s\n", tok);
                    tok = strtok(NULL, " \n");
                }
            }
        }
    }
    free(UserCommand);
} 
```

关于可能导致这种情况的任何想法？目前，调试不是我的选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:04:23.063

我用这个测试了你的代码：

```
#define _POSIX_C_SOURCE 200809L
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main()
{
    char *UserCommand = NULL;
    size_t combytes = 100;
    UserCommand = (char *) malloc(combytes);
    char *tok;
    while(getline(&UserCommand, &combytes, stdin) != EOF)
    {
    tok = strtok(UserCommand, " \n");    // Tokenize input
    if (tok != NULL) {
        while(tok != NULL) {
        printf("%s\n", tok);
        tok = strtok(NULL, " \n");
        }
    }
    }
    return 0;
} 
```

它适用于我所做的所有测试 - 包括将源文件作为输入传递，编写很长的行等等。

所以我的结论是你的代码中可能有一些 ELSE 段错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:22:48.863

也不是答案，只是编程风格的另一种选择：

每当我有一个像你这样的标记循环时，我更喜欢这样构造它们：

```
for( tok = strtok( UserCommand, " \n" );
     tok != NULL;
     tok = strtok( NULL, " \n" ) )
{
   printf( "%s\n", tok );
} 
```

这使两个`strtok()`调用保持紧密，并且`NULL`只需要编写一次测试。你的方法很好，这只是另一种选择。祝你好运！

# javascript - 当div可见时如何获取事件

> ID：15178524
> 
> 赞同：0
> 
> 时间：2013-03-02T19:34:14.310
> 
> 标签：javascript, html, performance

我正在使用 js 渲染一个网站，并且想优化我的渲染周期。

当页面元素对用户可见时，有没有办法获取事件？

这种方式延迟渲染元素直到它们可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:50:24.810

```
 var viewportWidth = jQuery(window).width(),
 viewportHeight = jQuery(window).height(),
 documentScrollTop = jQuery(document).scrollTop(),
 documentScrollLeft = jQuery(document).scrollLeft(),
 minTop = documentScrollTop,
 maxTop = documentScrollTop + viewportHeight,
 minLeft = documentScrollLeft,
 maxLeft = documentScrollLeft + viewportWidth,
 $myElement = jQuery(element), // your element jquery object
 elementOffset = $myElement.offset();
 if (
 (elementOffset.top > minTop && elementOffset.top < maxTop) &&
 (elementOffset.left > minLeft &&elementOffset.left < maxLeft)
  ) {
  alert('element is visible');
  } else {
  alert('element is not visible');
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:56:40.493

谷歌`"viewport visible"`

或者

[如何判断 DOM 元素在当前视口中是否可见？](https://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport)

或者

[http://remysharp.com/2009/01/26/element-in-view-event-plugin/](http://remysharp.com/2009/01/26/element-in-view-event-plugin/)

或者

[http://www.appelsiini.net/projects/viewport](http://www.appelsiini.net/projects/viewport)

或者

[如何使用jquery检查元素是否在用户的视图中](https://stackoverflow.com/questions/8229291/how-to-check-if-an-element-is-in-the-view-of-the-user-with-jquery/15178736#15178736)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T22:14:04.033

由于您没有解释您是否正在使用任何特定的库/框架，或者是否有任何特定条件使元素可见，所以我会给您这个：

jQuery $(document).ready() 可以检测整个页面是否已加载。

另一方面，如果元素是 display:none 或 visibility:hidden，或两者兼有或其他，你可以使用 jQuery 是这样的： $('element').is(':visible') 作为条件并在 if 中触发任何内容陈述。

# android - 如何编写android客户端服务器应用程序？

> ID：15178532
> 
> 赞同：0
> 
> 时间：2013-03-02T19:35:00.550
> 
> 标签：android

我想编写一个与某些服务器一起使用的 android 应用程序，在该服务器中，应用程序将查询服务器，服务器将回复少量对象。

我已经使用以下方法测试了 Java servlet 的登录功能。

```
http://myhost:8080/androidapp/login?username='myusername'&password='mypassword' 
```

但这似乎不是进行此类交易的安全方式。任何方式用户都无法看到此信息，但我仍然想知道使用此方法是否安全。

当项目增长时，服务器会发送很多对象，而android应用程序也需要发送太多参数，所以我认为上面的方法是没用的。

请建议我一些方法，通过它我可以轻松完成工作，而无需使用 php 等其他技术，因为我已经在使用 JSF 和 android 客户端应用程序端，所以我很难在短时间内学习新事物。

我认为的其他选项是使用 RMI（远程方法调用），但我如何在 eclipse 中使用它或者它会被 Apache Tomcat 支持？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:49:49.677

我可以推荐在服务器端使用 RESTful WebApplication。您的 Android 应用程序可以很容易地与您的服务器交互，并且您的服务器（正如您所说的那样是一个 tomcat）可以通过使用 Jersey 框架作为 REST API 轻松成为一个 RESTful Web 服务器。例如，泽西岛的身份验证过程在[此处](https://stackoverflow.com/questions/2902427/user-authentication-on-a-jersey-rest-service)进行了描述。可以在[此处](http://www.vogella.com/articles/REST/article.html)找到构建 RESTful WebApp 的教程以及其他有用的教程。

但请注意，REST 是一种范式，在构建它之前必须完全理解它。

# python - Django Tastypie - 提供存储在数据库中的表情符号

> ID：15178533
> 
> 赞同：0
> 
> 时间：2013-03-02T19:35:02.863
> 
> 标签：python, django, emoji, tastypie

我正在为我的 api 使用*django*和*sweetpie*。数据库是*MySQL*。

经过几天的摆弄，我设法使用 utf8mb4 字符集将表情符号图标存储在数据库中。

当直接从控制台（在 Mac 上）查询 db 时，我看到表情符号很好，***但是***当从 api 中提取它们时（例如使用浏览器），json 显示问号。这让我相信问题不在于数据库，而在于 django/tastypie 数据库连接。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:22:32.900

解决方案在 DJango 设置中：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'OPTIONS': {'charset': 'utf8mb4'},
        (...) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T10:12:44.867

如果您将 JSON 转储保存到文本文件并使用 UTF8 文本编辑器打开它会怎样？表情符号会重新出现吗？

我怀疑，当在浏览器中显示 JSON 时，浏览器会退回到 Latin-1 编码，从而以问号结束。您的浏览器中可能有一个设置来设置编码。

检查来自您的服务器的“Content-Type”标头。它说`application/json; encoding=utf-8`吗？

# xpages - XPages Ext Lib Dialog Control 字段不可编辑，需要获取字段值的句柄，然后关闭对话框

> ID：15178537
> 
> 赞同：0
> 
> 时间：2013-03-02T19:35:32.287
> 
> 标签：xpages, xpages-extlib

我的 XPage 上有一个通过按钮打开的扩展库对话框控件：

```
XSP.openDialog("#{id:commentsDialog}"); 
```

在我的 XPage 上，我有一个名为 document1 的文档源。当我将这些字段（从 Data Palette 拖放）放在对话框控件上时，字段 (docID) 存在，但不可编辑——看起来为显示计算：

```
<xe:dialog id="commentsDialog" title="Comments" styleClass="dialogBoxComments">
    <xp:panel>
        <xp:table style="width:100%">
            <xp:tr>
                <xp:td>
                    <xp:label value="Enter your comments..." id="label2"></xp:label>
                </xp:td>
            </xp:tr>
            <xp:tr>
                <xp:td>
                    <xp:inputTextarea id="comments" style="width:100%;height:100px">
                    </xp:inputTextarea>
                </xp:td>
            </xp:tr>
            <xp:tr>
                <xp:td>
                    <xp:div style="text-align:right">
                        <xp:button value="Submit" id="submitButton">
                            <xp:eventHandler event="onclick" submit="true"
                                refreshMode="complete">
                                <xp:this.action><![CDATA[#{javascript:saveComments();}]]></xp:this.action>
                            </xp:eventHandler>
                        </xp:button>
                        <xp:button id="cancelButton" value="Cancel">
                            <xp:eventHandler event="onclick" submit="false">
                                <xp:this.script><![CDATA[XSP.closeDialog("#{id:commentsDialog}");]]></xp:this.script>
                            </xp:eventHandler>
                        </xp:button>
                    </xp:div>
                </xp:td>
            </xp:tr>
            <xp:tr>
                <xp:td>
                    <xp:inputText value="#{document1.docID}" rendered="false"
                        id="docID"></xp:inputText>
                </xp:td>
            </xp:tr>
        </xp:table>
    </xp:panel>
    <xp:br></xp:br>
</xe:dialog> 
```

我有一个输入文本区域，用户将在其中输入值，但我无法使用 SSJS 获取该值。我试过了：

```
 function getComponentValue(id){
      var field = getComponent(id);
      var value = field.getSubmittedValue();
      if( null == value ){
         // else not yet submitted
         value = field.getValue();
      }
      return value
    } 
```

要获取输入文本区域中的值，我不确定该怎么做，因为如果我绑定到 Data Palette 中的现有字段，它看起来不可编辑并且我无法输入任何值。

此外，我在调用一些 SSJS 的对话框控件上有一个提交按钮：

```
function saveComments() {
// Need to create a comments doc for the movie...
var db:NotesDatabase = session.getCurrentDatabase();
var doc:NotesDocument = currentDocument.getDocument();
var unid = getComponentValue("docID");
// Grab comments from dialog...
var comments = getComponentValue("comments");
// Create the comments doc...   
var docComm:NotesDocument = db.createDocument();
docComm.replaceItemValue("Form", "comment");    
var nowValue = @Text(@Now());
var currentUser = sessionScope.get("currentUser");
docComm.replaceItemValue("cm_Key", unid);
docComm.replaceItemValue("cm_By", currentUser);
docComm.replaceItemValue("cm_Date", nowValue);
docComm.replaceItemValue("cm_Key", unid);
docComm.save();
} 
```

我将如何从服务器端关闭对话框？

所以，三件事（感谢你的耐心）：

1.  如何使对话框控件上的字段可编辑
2.  如何从未绑定到文档1上的字段的输入文本区域中获取值
3.  如何从服务器端关闭对话框

谢谢！

* * *

编辑：我在此评论中进行了编辑，以便我可以正确显示图像...

1.  我使 docID 字段可见，它看起来是经过计算的，不可编辑。
2.  我添加了第二个文档数据源（commentDocument）并将字段的值设置为数据调色板值——字段不出现，认为它可能是不可编辑的。

这是图像 - 绿色框是注释字段（来自 commentsDocument 源的 cm_Comm）应该存在的位置，红色框是不可编辑的 docID 字段： ![对话框控件上不可编辑的字段](../Images/a6417a921a538cb4278de4daf77f0fcc.png)

现在是控件背后的代码：

```
<xe:dialog id="commentsDialog" title="Comments" styleClass="dialogBoxComments">
    <xp:panel>
        <xp:table style="width:100%">
            <xp:tr>
                <xp:td>
                    <xp:label value="Enter your comments..." id="label2"></xp:label>
                </xp:td>
            </xp:tr>
            <xp:tr>
                <xp:td>
                    <xp:inputTextarea id="comments" style="width:100%;height:100px"
                        value="#{commentDocument.cm_Comm}">
                    </xp:inputTextarea>
                </xp:td>
            </xp:tr>
            <xp:tr>
                <xp:td>
                    <xp:div style="text-align:right">
                        <xp:button value="Submit" id="submitButton">
                            <xp:eventHandler event="onclick" submit="true"
                                refreshMode="complete">
                                <xp:this.action><![CDATA[#{javascript:saveComments();getComponent("commentsDialog").hide();}]]></xp:this.action>
                            </xp:eventHandler>
                        </xp:button>
                        <xp:button id="cancelButton" value="Cancel">
                            <xp:eventHandler event="onclick" submit="false">
                                <xp:this.script><![CDATA[XSP.closeDialog("#{id:commentsDialog}");]]></xp:this.script>
                            </xp:eventHandler>
                        </xp:button>
                    </xp:div>
                </xp:td>
            </xp:tr>
            <xp:tr>
                <xp:td>
                    <xp:inputText value="#{document1.docID}" id="docID"></xp:inputText>
                </xp:td>
            </xp:tr>
        </xp:table>
    </xp:panel>
    <xp:br></xp:br>
</xe:dialog> 
```

请让我知道我在做什么不正确-感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T20:49:42.880

**如何使对话框控件上的字段可编辑**

1.  将 value 属性添加到您的 inputTextarea - 例如 viewScope 变量 ( `value="#{viewScope.myTextArea}"`)，以便 XPages (JSF) 有一个位置来存储您稍后要处理的文本区域中的内容。

2.  您的 inputText 字段设置为`rendered="false"`. 因此，首先要设置要呈现的控件（因此删除 render="false" 属性）。

**如何从未绑定到文档1上的字段的输入文本区域中获取值**

参见上面的答案 1。

**如何从服务器端关闭对话框**

使用`getComponent("commentsDialog").hide()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T00:42:33.630

使用“comment”变量创建第二个 DominoDocument 数据源。将其范围设置为“请求”。为 cm_Key、cm_By 和 cm_Date 创建隐藏的输入组件，为每个组件设置适当的 defaultValue；例如：

```
<xp:inputHidden value="#{comment.cm_By}" defaultValue="#{context.user.distinguishedName}" /> 
```

然后您可以将对话框字段绑定到该数据源：

```
<xp:inputTextarea id="comments" style="width:100%;height:100px" value="#{comment.cm_Comment"}> 
```

所以你的提交按钮可以变成一个“保存文档”的简单动作和一行的“执行脚本”：

```
<xp:eventHandler event="onclick" submit="true" refreshMode="complete">
    <xp:this.action>
        <xp:actionGroup>
            <xp:actionGroup>
                <xp:saveDocument var="comment" />
                <xp:executeScript>
                    <xp:this.script><![CDATA[#{javascript:getComponent("commentsDialog").hide();}]]></xp:this.script>
                </xp:executeScript>
            </xp:actionGroup>
        </xp:actionGroup>
    </xp:this.action>
</xp:eventHandler> 
```

如果评论数据源的范围是每个请求，那么每次都会创建一个新文档。您无需以编程方式创建文档...让数据源为您管理。

# asp.net - ASP.Net 应用程序错误 4005：身份验证代码无效

> ID：15178539
> 
> 赞同：0
> 
> 时间：2013-03-02T19:35:40.513
> 
> 标签：asp.net, forms, authentication

我们有一个 ASP.Net 3.5 应用程序，它已经运行了大约 5 年，没有出现任何问题。我们最近遇到一个问题：

我们已将用户和新 PC 移动到通过 VPN 连接到主站点的远程位置。用户从那里访问 Web 应用程序并正常登录，但是当尝试向服务器提交请求时，我们在 Web 服务器日志中收到错误：

> 事件代码：4005 事件消息：请求的表单身份验证失败。原因：提供的票证无效。

我们还将一台新电脑（运行 IE9）连接到同一位置，这台电脑工作正常。出现问题的 PC 使用的是 IE8，这是其他 PC 在主站点中使用的。

有人可以协助解决此问题吗？有没有`IE8`我可以检查的设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:46:17.637

> 您是否尝试在您的 web.config 文件中添加以下键`<appSettings>`。

```
<add key="aspnet:UseLegacyEncryption" value="true" />
<add key="aspnet:UseLegacyFormsAuthenticationTicketCompatibility" value="true" /> 
```

# xcode - 如何从 IOS 应用程序中的自定义包中加载故事板文件？

> ID：15178541
> 
> 赞同：2
> 
> 时间：2013-03-02T19:35:49.800
> 
> 标签：xcode, storyboard, bundle

我有一个我正在修改的 ios 应用程序，以便它可以作为静态库简单地插入到一系列其他应用程序中。但是，我还需要拥有所有相应的资源，因此我创建了一个自定义包来包含这些资源。该捆绑包包括所有选项卡栏图像、可本地化的字符串、默认图像，以及对于这个问题最重要的故事板文件。当我运行该应用程序时，它无法在自定义包中找到情节提要文件。

我的项目安排如下： 嗯...好吧，看来我不能发布图片，直到我的声誉得分增加，因为我是第一次来......我会尽力描述它。

静态库项目作为子项目拖入主项目。静态子项目包括 2 个目标，即生成 libOMPhotoGalleryLibrary.a 文件的库和创建 OMPhotoGalleryLibraryResources.bundle 文件的 libraryResources。资源构建阶段的 Copy Bundle Resources 部分包括（以及一堆图像和字符串文件）：

*   OMPhotoGalleryLibraryResources/(localization).lproj 中的 MainStoryboard_iPad.storyboard

*   OMPhotGalleryLibraryResources
    /(localization).lproj中的 MainStoryboard_iPhone.storyboard

然后，主项目在 Linked Frameworks and Libraries 部分中包含子项目的静态 .a 文件，并且自定义包包含在它的 Copy Bundle Resources 中。

当我运行项目时，我收到消息： **在捆绑包 NSBundle 中找不到名为“MainStoryboard_iPhone”的故事板**

好的，这并不完全出乎意料，因为我需要弄清楚如何让应用程序改为查看自定义包。

作为调试练习，我（暂时）将主项目中的引用直接添加到情节提要文件中，并且可以使一切正常工作。因此，我知道静态库工作正常，并且捆绑包已部署，图像和可本地化的字符串已部署并可访问。因此，在删除主项目中的临时引用后，运行时无法再找到情节提要文件。

我尝试将主项目的信息部分中的故事板文件名调整为以下各项均无济于事： OMPhotoGalleryLibraryResources.bundle/MainStoryboard_iPhone OMPhotoGalleryLibraryResources.bundle/en/MainStoryboard_iPhone OMPhotoGalleryLibraryResources.bundle/en.lproj/MainStoryboard_iPhone

我还在主项目的应用程序删除中尝试了几种编程方法，但也没有运气。所以，我不确定如何告诉应用程序在 OMPhotoGalleryLibraryResources.bundle 中查找情节提要文件。一旦故事板加载，我就可以成功地从这个包中读取所有其他文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T20:18:40.387

2013 年 3 月 3 日更新：解决了。我在正确的轨道上，但是我从原始项目中带来的文件位于本地化文件夹 en.lproj 中。但是，我没有将它们本地化到新的子项目中。当我将文件从 en.lproj 文件夹中提取到根资源文件夹中，然后将 INFO 引用更改为 OMPhotoGalleryLibraryResources.bundle/MainStoryboard 时，它起作用了。

# java - 为什么将 printf("%s") 用于传递给泛型方法的参数？

> ID：15178542
> 
> 赞同：7
> 
> 时间：2013-03-02T19:35:50.407
> 
> 标签：java, printf

```
package genericMethods;

public class OverloadedMethods {

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

        Integer[] integerArray = {1, 2, 3, 4, 5};
        Double[] doubleArray = {1.0, 2.0, 3.0, 4.0, 5.0};
        Character[] charArray = {'a', 'b', 'c', 'd'};

        System.out.println("A has: ");
        printArray(integerArray);
        System.out.println("B has: ");
        printArray(doubleArray);
        System.out.println("C has: ");
        printArray(charArray);
    }

    public static <T> void printArray(T[] array)
    {
        for(T element : array)
            System.out.printf("%s ", element);//why use %s instead of others? 

        System.out.println();
    }

} 
```

我的问题是方法 printArray() 不知道要打印出什么类型的数据，并且似乎 %d 会在运行时发生错误-但不是 %s 仅用于 String 吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-02T19:37:53.933

问题是您不知道“元素”将是什么类型。在您的示例中，它可以是整数、双精度或字符。在这种情况下，您不能使用 %d 或 %lf，因为它们不适用于不是 Integer（对于 %d）或 Double（对于 %lf）的类型。

%s 实际上对它们都有效，因为所有的 Object 类型都有一个 .toString()，所以它们都可以转换为字符串进行打印。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-02T19:37:30.867

的使用`%s` [将导致](http://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html#syntax)在[`toString()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#toString%28%29)对象上调用该方法，因此适用于任何类型`T`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-02T19:37:49.300

考虑到几乎所有东西都可以变成字符串，无论是通过`toString()`方法还是仅通过附加原始值。

当`%s`给出时，它将把任何东西`element`变成一个字符串。

# jquery - jQuery 将 div 包装器添加到指定元素

> ID：15178549
> 
> 赞同：3
> 
> 时间：2013-03-02T19:36:50.560
> 
> 标签：jquery, multiple-columns

我有一个 CMS 生成的 HTML 块。我想将一些 DIV 包装器添加到一组特定的元素中。

```
<ul id="gform_fields_1">
    <li id="field_1_8" class="gfield">
        <!-- content -->
    </li>
    <li id="field_1_9" class="gfield">
        <!-- content -->
    </li>
    <li id="field_1_10" class="gfield">
        <!-- content -->
    </li>
    <li id="field_1_11" class="gfield">
        <!-- content -->
    </li>
    <li id="field_1_12" class="gfield">
        <!-- content -->
    </li>
    <li id="field_1_13" class="gfield">
        <!-- content -->
    </li>
    <li id="field_1_14" class="gfield">
        <!-- content -->
    </li>
</ul> 
```

我想实现以下模式：

```
<ul id="gform_fields_1">
    <div class="wrap">
        <li id="field_1_8" class="gfield">
            <!-- content -->
        </li>
        <li id="field_1_9" class="gfield">
            <!-- content -->
        </li>
        <li id="field_1_10" class="gfield">
            <!-- content -->
        </li>
    </div>
    <div class="wrap">
        <li id="field_1_11" class="gfield">
            <!-- content -->
        </li>
    </div>
    <div class="wrap">
        <li id="field_1_12" class="gfield">
            <!-- content -->
        </li>
        <li id="field_1_13" class="gfield">
            <!-- content -->
        </li>
    </div>
</ul> 
```

包装用于一组特定的元素，例如我需要将#field_1_8、#field_1_19 和#field_1_10 包含在DIV 中，然后将#field_1_11 包含在DIV 中，然后是其余部分。重点是，我想指定 ID，而不是基于任何逻辑，可以这么说。

`.wrap()`似乎是要走的路，像这样工作：

```
$('LIST ALL IDs').wrap('<div class="new" />'); 
```

非常感谢任何提示。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T19:43:55.740

由于 jQuery 的选择器语法很像 CSS，您可以简单地列出您的元素，如下所示：

```
$('li#field_1_8, li#field_1_9, li#field_1_10').wrapAll('<div class="new" />') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:03:08.177

你可以使用[切片](http://docs.jquery.com/Traversing/slice)

```
$('li').slice(0, 3).wrapAll("<div class='wrap'></div>")
$('li').slice(3,4).wrap("<div class='wrap'></div>")
$('li').slice(4,7).wrapAll("<div class='wrap'></div>") 
```

jsfiddle：http: [//jsfiddle.net/NpxxR/](http://jsfiddle.net/NpxxR/)

# javascript - 从内容脚本触发 Chrome 扩展通知

> ID：15178550
> 
> 赞同：2
> 
> 时间：2013-03-02T19:37:06.920
> 
> 标签：javascript, google-chrome-extension

我目前正在尝试这样做，以便我的扩展程序在被调用时会显示通知。

单击该图标时，background.js 会在页面中执行一个脚本。这是我的 background.js 文件的样子：

```
chrome.browserAction.onClicked.addListener(function(tab) {
  chrome.tabs.executeScript(null,{file: "buy.js"});
  }
);

chrome.extension.onRequest.addListener(
  function (request, sender, sendResponse) {
    var notify = webkitNotifications.createNotification(
      'face.png',
      'Item Sniped!',
      'Item sniper sniped an item!'
    );
    notify.show();
  }
); 
```

是的，我确实在 manifest.json 中设置了所有权限。我的清单文件：

```
{
   "manifest_version": 2,
   "name": "Sniper",
   "version": "1.5",
   "description": "Sniper",
   "browser_action": {
     "default_icon": "face.png",
     "default_title": "Limited Sniper"
   },
   "background": { "scripts": ["background.js"] },
   "permissions": [
     "notifications",
     "tabs",
     "http://*/*"
   ]
} 
```

我知道我需要在我的 background.js 文件中有一个侦听器，但是甚至可以从 buy.js（执行的脚本）向 background.js 发送请求以发出通知吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T02:53:35.280

是的。内容脚本不能做某事。[看这里](https://developer.chrome.com/extensions/content_scripts.html)

所以你必须向 background.js 发送一个请求来发出通知。并且，如果您的通知有一个图标，请记住在 manifest.json 中注册它：

```
 "web_accessible_resources":["face.png"] 
```

> 但是，内容脚本有一些限制。他们不能： 使用 chrome.* API（chrome.extension 的部分除外） 使用由其扩展页面定义的变量或函数 使用由网页或其他内容脚本定义的变量或函数

# php - 如果表单为空，返回error0到index,php

> ID：15178561
> 
> 赞同：1
> 
> 时间：2013-03-02T19:37:59.730
> 
> 标签：php, forms, if-statement

这是我检查表单的多个输入的代码。

但是，当表单为空时，我无法让它显示错误。到目前为止，尝试从 index.php 进入这个页面会导致它再次返回到 index.php。

（我的猜测是，在表单中输入值之前，php 已经确定它们是空的，所以发回给我？）

如何先显示表单，然后让 php 检查是否未设置 POST，然后返回 index.php 并显示会话中的错误？

谢谢！

```
 <?php

    // session for POST success and error messages
    session_start();

    require_once "db.php";

    if ( isset($_POST['a']) && isset($_POST['b']) 
         && isset($_POST['c'])) {

        $a = mysql_real_escape_string($_POST['a']);
        $b = mysql_real_escape_string($_POST['b']);
        $c = mysql_real_escape_string($_POST['c']);

        if (preg_match('/\-*\d+\.*\d*/',$b) && preg_match('/\-*\d+\.*\d*/',$c) &&
            (-10 <= $b && 10 >= $b) && (-20 <= $c && 20 >= $c)) {

            [some code checking for different conditions...]

    } elseif (!isset($_POST['a']) | !isset($_POST['b']) | !isset($_POST['c'])) {

            $_SESSION['error'] = $_POST['error0'];
            header('Location: index.php') ;
            return;
    }

    ?>

<form method="post">
<p>A:
<input type="text" name="a"></p>
<p>B:
<input type="text" name="b"></p>
<p>C:
<input type="text" name="c"></p>

<!--Sending POST for success-->
<input type="hidden" name="success" value="Record Added">

<input type="hidden" name="error0" value="All values are required">

<p><input type="submit" value="Add New"/>

<a href="index.php">Cancel</a></p>
</form> 
```

已解决：摆脱 elseif 并在 if 中添加另一个条件

```
} elseif (strlen($a) == 0 | strlen($b) == 0 | strlen($c) == 0) { 

    $_SESSION['error'] = $_POST['error0'];
    header('Location: index.php') ;
    return;
{ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:40:06.247

|| 不只是一个

```
elseif (!isset($_POST['a']) || !isset($_POST['b']) || !isset($_POST['c'])) { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T19:41:39.863

您应该使用[逻辑或](http://php.net/manual/en/language.operators.logical.php)代替。所以：

```
elseif (!isset($_POST['a']) || !isset($_POST['b']) || !isset($_POST['c'])) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T19:43:47.560

帖子变量可能已设置但为空，因此请检查长度以及`isset`

`strlen(trim($_POST['a']))`

当然，假设您不想要空值。

```
if ( ( isset($_POST['a']) && strlen(trim($_POST['a'])) ) && ( isset($_POST['b'] && strlen(trim($_POST['b'])) ) ) 
```

# xaml - LongListMultiSelector 根据数量更改项目宽度

> ID：15178566
> 
> 赞同：0
> 
> 时间：2013-03-02T19:38:25.503
> 
> 标签：xaml, width, windows-phone-8

经过`LongListMultiSelector`一段时间的测试，我注意到如果它们的总高度不超过屏幕高度，它会使它的元素更宽一些，如果它们超过屏幕高度，它会更短一些。

以下是说明此行为的两张图片：

LongListMultiSelector 的高度超过了屏幕，并且 2 和屏幕边缘之间有一个空间。
![在此处输入图像描述](../Images/46b9b6b12c746c557aebf8d7c63c42e3.png)

LongListMultiSelector 的高度不超过屏幕，并且 2 和屏幕边缘之间没有空间。
![在此处输入图像描述](../Images/2ea2b7215a67b7b80bc59e555d15fc4b.png)

这是我的 XAML：

```
<toolkit:LongListMultiSelector ItemsSource="{Binding}">
    <toolkit:LongListMultiSelector.ItemTemplate>
        <DataTemplate>
            <Grid Margin="0,0,24,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock FontSize="30" Text="1" Grid.Column="0" />
                <TextBlock FontSize="30" Text="2" Grid.Column="1" />
            </Grid>
        </DataTemplate>
    </toolkit:LongListMultiSelector.ItemTemplate>
</toolkit:LongListMultiSelector> 
```

如何更改此行为以使项目的宽度始终相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T23:33:16.703

这是因为当内容大于屏幕高度时会添加滚动条。您可以通过在 LongListMultiSelector 的模板内修改底层 LongListSelector 的样式来移除滚动条。

```
<phone:PhoneApplicationPage.Resources>
    <Style x:Key="LongListSelectorStyle1" TargetType="phone:LongListSelector">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource PhoneForegroundBrush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="phone:LongListSelector">
                    <Grid Background="{TemplateBinding Background}" d:DesignWidth="480" d:DesignHeight="800">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="ScrollStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition GeneratedDuration="00:00:00.5"/>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Scrolling">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="VerticalScrollBar"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="NotScrolling"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <!-- We change the default template here so that the scrollbar appears ON TOP of the content -->
                        <Grid Margin="{TemplateBinding Padding}">
                            <ViewportControl x:Name="ViewportControl" VerticalAlignment="Top" HorizontalContentAlignment="Stretch"/>
                            <ScrollBar x:Name="VerticalScrollBar" Opacity="0" Margin="4,0,4,0" Orientation="Vertical" HorizontalAlignment="Right"/>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ControlTemplate x:Key="LongListMultiSelectorControlTemplate1" TargetType="toolkit:LongListMultiSelector">
        <phone:LongListSelector x:Name="InnerSelector"
            GridCellSize="{TemplateBinding GridCellSize}"
            GroupFooterTemplate="{TemplateBinding GroupFooterTemplate}"
            GroupHeaderTemplate="{TemplateBinding GroupHeaderTemplate}"
            HideEmptyGroups="{TemplateBinding HideEmptyGroups}"
            IsGroupingEnabled="{TemplateBinding IsGroupingEnabled}"
            ItemsSource="{TemplateBinding ItemsSource}"
            JumpListStyle="{TemplateBinding JumpListStyle}"
            ListFooter="{TemplateBinding ListFooter}"
            ListFooterTemplate="{TemplateBinding ListFooterTemplate}"
            ListHeader="{TemplateBinding ListHeader}"
            ListHeaderTemplate="{TemplateBinding ListHeaderTemplate}"
            Style="{StaticResource LongListSelectorStyle1}"
            >
            <phone:LongListSelector.ItemTemplate>
                <DataTemplate>
                    <toolkit:LongListMultiSelectorItem
                        x:Name="LLSItem"
                        HorizontalContentAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        Content="{Binding}"
                            />
                </DataTemplate>
            </phone:LongListSelector.ItemTemplate>
        </phone:LongListSelector>
    </ControlTemplate>
</phone:PhoneApplicationPage.Resources>

<Grid x:Name="LayoutRoot">
    <!-- The width of the items in this LLMS will not change -->
    <toolkit:LongListMultiSelector Template="{StaticResource LongListMultiSelectorControlTemplate1}"/>
</Grid> 
```

# php - 注册问题 php mysql

> ID：15178570
> 
> 赞同：0
> 
> 时间：2013-03-02T19:38:33.417
> 
> 标签：php, mysql, session, dreamweaver, registration

我正在使用 mysql 创建登录和注册表单，当他提交时我需要用户我在他的注册电子邮件中向他发送收件箱的激活码但是当我在注册表单中提交时我收到此错误：未定义的变量：INFO在第 87 行的 C:\wamp\www\new loginregi\register.php

这个错误：警告：邮件（）：无法在“localhost”端口 25 连接到邮件服务器，验证 php.ini 中的“SMTP”和“smtp_port”设置或在 C:\wamp\www\new 中使用 ini_set()第 87 行的 loginregi\register.php。

谁能帮我修复这些错误我需要在明天之前修复它非常重要

这是以下代码：

# 注册.php

```
<?php
    //allow sessions to be passed so we can see if the user is logged in
    ob_start();
    if(isset($_SESSION)){
       session_start();
    }

    //connect to the database so we can check, edit, or insert data to our users table
    $con = mysql_connect('localhost', 'root', '') or die(mysql_error());
    $db = mysql_select_db('loginTut', $con) or die(mysql_error());
    //include out functions file giving us access to the protect() function
    include "./functions.php";
    ?>
    <html>
        <head>
            <title>Login with Users Online Tutorial</title>
            <link rel="stylesheet" type="text/css" href="style.css" />
        </head>
        <body>
            <?php
            //Check to see if the form has been submitted
            if(isset($_POST['submit'])){
                //protect and then add the posted data to variables
                $username = protect($_POST['username']);
                $password = protect($_POST['password']);
                $passconf = protect($_POST['passconf']);
                $email = protect($_POST['email']);
                //check to see if any of the boxes were not filled in
                if(!$username || !$password || !$passconf || !$email){
                    //if any weren't display the error message
                    echo "<center>You need to fill in all of the required filds!</center>";
                }else{
                    //if all were filled in continue checking
                    //Check if the wanted username is more than 32 or less than 3 charcters long
                    if(strlen($username) > 32 || strlen($username) < 3){
                        //if it is display error message
                        echo "<center>Your <b>Username</b> must be between 3 and 32 characters long!</center>";
                    }else{
                        //if not continue checking
                        //select all the rows from out users table where the posted username matches the username stored
                        $res = mysql_query("SELECT * FROM `users` WHERE `username` = '".$username."'");
                        $num = mysql_num_rows($res);
                        //check if theres a match
                        if($num == 1){
                            //if yes the username is taken so display error message
                            echo  "<center>The <b>Username</b> you have chosen is already taken!</center>";
                        }else{
                            //otherwise continue checking
                            //check if the password is less than 5 or more than 32 characters long
                            if(strlen($password) < 5 || strlen($password) > 32){
                                //if it is display error message
                                echo "<center>Your <b>Password</b> must be between 5 and 32 characters long!</center>";
                            }else{
                                //else continue checking
                                //check if the password and confirm password match
                                if($password != $passconf){
                                    //if not display error message
                                    echo "<center>The <b>Password</b> you supplied did not math the confirmation password!</center>";
                                }else{
                                    //otherwise continue checking
                                    //Set the format we want to check out email address against
                                    $checkemail = "/^[a-z0-9]+([_\\.-][a-z0-9]+)*@([a-z0-9]+([\.-][a-z0-9]+)*)+\\.[a-z]{2,}$/i";
                                    //check if the formats match
                                    if(!preg_match($checkemail, $email)){
                                        //if not display error message
                                        echo "<center>The <b>E-mail</b> is not valid, must be name@server.tld!</center>";
                                    }else{
                                        //if they do, continue checking
                                        //select all rows from our users table where the emails match
                                        $res1 = mysql_query("SELECT * FROM `users` WHERE `email` = '".$email."'");
                                        $num1 = mysql_num_rows($res1);
                                        //if the number of matchs is 1
                                        if($num1 == 1){
                                            //the email address supplied is taken so display error message
                                            echo "<center>The <b>E-mail</b> address you supplied is already taken</center>";
                                        }else{
                                            //finally, otherwise register there account
                                            //time of register (unix)
                                            $registerTime = date('U');
                                            //make a code for our activation key
                                            $code = md5($username).$registerTime;
                                            //insert the row into the database
                                            $res2 = mysql_query("INSERT INTO `users` (`username`, `password`, `email`, `rtime`) VALUES('".$username."','".$password."','".$email."','".$registerTime."')");
                                            //send the email with an email containing the activation link to the supplied email address
                                            mail($email, $INFO['chatName'].' registration confirmation', "Thank you for registering to us ".$username.",\n\nHere is your activation link. If the link doesn't work copy and paste it into your browser address bar.\n\nhttp://www.yourwebsitehere.co.uk/activate.php?code=".$code, 'From: noreply@youwebsitehere.co.uk');
                                            //display the success message
                                            echo "<center>You have successfully registered, please visit you inbox to activate your account!</center>";
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            ?>
            <div id="border">
                <form action="register.php" method="post">
                    <table cellpadding="2" cellspacing="0" border="0">
                        <tr>
                            <td>Username: </td>
                            <td><input type="text" name="username" /></td>
                        </tr>
                        <tr>
                            <td>Password: </td>
                            <td><input type="password" name="password" /></td>
                        </tr>
                        <tr>
                            <td>Confirm Password: </td>
                            <td><input type="password" name="passconf" /></td>
                        </tr>
                        <tr>
                            <td>Email: </td>
                            <td><input type="text" name="email" size="25"/></td>
                        </tr>
                        <tr>
                            <td colspan="2" align="center"><input type="submit" name="submit" value="Register" /></td>
                        </tr>
                        <tr>
                            <td colspan="2" align="center"><a href="login.php">Login</a> | <a href="forgot.php">Forgot Pass</a></a></td>
                        </tr>
                    </table>
                </form>
            </div>
        </body>
    </html>
    <?php ob_end_flush(); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:42:07.827

对于第一个错误。我想也许你从某个地方复制了这段代码：

```
mail($email, $INFO['chatName'].' registration confirmation', "Thank you for registering to us ".$username.",\n\nHere is your activation link. If the link doesn't work copy and paste it into your browser address bar.\n\nhttp://www.yourwebsitehere.co.uk/activate.php?code=".$code, 'From: noreply@youwebsitehere.co.uk'); 
```

对于您的情况，请替换`$INFO['chatName']`为`$username`;

如您所见，在第一行中，有一个未定义的名为 $INFO['chatname'] 的变量。

对于第二个错误，您必须设置本地邮件服务器。如果您使用 Windows，我推荐以下链接：

[在 Windows 中从本地主机发送邮件](http://roshanbh.com.np/2007/12/sending-e-mail-from-localhost-in-php-in-windows-environment.html)

# r - 通过 read.table 将制表符分隔的 unicode 数据读入 R

> ID：15178573
> 
> 赞同：3
> 
> 时间：2013-03-02T19:38:43.403
> 
> 标签：r, unicode, read.table

我有几个文件从 Sql-Server 数据库导出为制表符分隔的 unicode 文本（数字数据和外文名称）。

如何将这些文件加载​​到 R 中？

每个文件的第一个位置都有一个特殊字符。我假设那是BOM。

如果没有任何选项（除了`header`and `sep`） ，即使使用正确的分隔符规范`read.table`，也将所有数据放在一列中。`\t`

打开连接并跳过前三个字节会导致`empty beginning of file`.

我已经尝试了所有可用的`fileEncoding`值：我得到了`line 1 didn't have 29 elements`或`more columns than column names`。

我真的被这个难住了。理想情况下，我希望在 R 中处理所有内容，但欢迎任何 awk/powershell 建议来修复这些文件。这只是BOM问题吗？我不能做的一件事是控制 Sql-Server 的导出（我不拥有 SSIS 包）。谢谢。

编辑

对于那些有兴趣使用 unicode 选项获取 SqlServer 导出的 csv 中的数据列的人：SqlServer 以 NUL 字符开始其 csv 导出。此链接讨论了如何实际“看到”这些特殊字符：

[Python CSV 错误：行包含 NULL 字节](https://stackoverflow.com/questions/4166070/python-csv-error-line-contains-null-byte)

编辑

这就是我为了获得 ASCII 并继续前进而拼凑起来的。不过，这不是我的问题的答案。

```
from os import listdir
from os.path import isfile, join
import unicodedata
import codecs

mypath = "C:\\Users\\Collapsed\\data"

filesOnly = [ f for f in listdir(mypath) if isfile(join(mypath,f)) ]

for f in filesOnly:
     print f
     fln = mypath + "\\" + f
     fl_in  = codecs.open( fln , 'Ur', 'utf-16')
     fl_out = open( mypath + "\\" + 'ascii_' + f , 'w' ) 
     for line in fl_in:
         fl_out.write( unicodedata.normalize('NFKD', line ).encode('ascii','ignore') )
     fl_in.close()
     fl_out.close() 
```

# .htaccess - 如果为空，如何使用 mod_rewrite 忽略第二个变量

> ID：15178575
> 
> 赞同：0
> 
> 时间：2013-03-02T19:38:56.967
> 
> 标签：.htaccess, mod-rewrite

我正在尝试在我的 HTACCESS 文件中设置 mod_write 以重写我的 URL 之一。我正在使用 $_GET 将标签名称和可选页码（用于分页）传递给名为 tags.php 的文件。

这是带有变量的文件名：**tags.php?t=textname&s=#**

（在上面的 URL 中，# 是页码。）

我正在尝试使用 mod_rewrite 将 URL 写入**domain.com/tags/textname/#/**，但如果用户登陆第一页，我也想允许**domain.com/tags/textname/**（不需要分页变量待通过）。

这是我的 mod_rewrite 代码：

```
RewriteCond %{REQUEST_URI} !tags\.php    [NC]
RewriteRule ^tags/(.*)/$ /tags.php?t=$1 [NC,L]
RewriteRule ^tags/(.*)/(.*)/$ /tags.php?t=$1&s=$2 [QSA,NC,L] 
```

当我访问**domain.com/tags/textname/**时，该代码运行良好。它失败的地方是当我尝试访问**domain.com/tags/textname/1/**时，因为 mod_rewrite 没有传递**tags.php?t=textname&s=1**，而是传递**tags.php?t=textname/1&s=**

有人看到我在第一次或第二次重写时做错了什么以防止第二条规则起作用吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:54:37.677

弄清楚了。通过将更具描述性的语句放在首位来翻转 RewriteRules。为其他遇到此问题的人更新。

```
RewriteCond %{REQUEST_URI} !tags\.php    [NC]
RewriteRule ^tags/(.*)/(.*)/$ /tags.php?t=$1&s=$2 [QSA,NC,L] 
RewriteRule ^tags/(.*)/$ /tags.php?t=$1 [NC,L] 
```

# jquery - 如何让这个 jQuery Counter 工作？

> ID：15178577
> 
> 赞同：0
> 
> 时间：2013-03-02T19:39:04.493
> 
> 标签：jquery

好的，所以我需要一个里程表样式的**jQuery 计数器**，并找到了 [这个整洁的] [http://nleach.com/post/16045448547/odometer-style-counter-using-jquery](http://nleach.com/post/16045448547/odometer-style-counter-using-jquery)。

我检查了 Fiddle，但无法让所有元素正常工作。下面是我到目前为止到达的地方。

```
 <html>
            <head>

              <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

            <style>
            .counter {
                display:block;
                float:left;
                font-size:2em;
                line-height:1.2em;
                -webkit-box-reflect: below -15px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(60%, transparent), to(rgba(255,255,255,0.3)));
            }

            .counter span.digit {
                background:#161616;
                background: #3F3F3F; /* Old browsers */
                background: linear-gradient(bottom, #0A0A0A 0%, #2B2B2B 50%, #3F3F3F 100%);
                background: -o-linear-gradient(bottom, #0A0A0A 0%, #2B2B2B 50%, #3F3F3F 100%);
                background: -moz-linear-gradient(bottom, #0A0A0A 0%, #2B2B2B 50%, #3F3F3F 100%);
                background: -webkit-linear-gradient(bottom, #0A0A0A 0%, #2B2B2B 50%, #3F3F3F 100%);
                background: -ms-linear-gradient(bottom, #0A0A0A 0%, #2B2B2B 50%, #3F3F3F 100%);
                background: -webkit-gradient(linear, left bottom, left top, color-stop(0, #0A0A0A), color-stop(0.5, #2B2B2B), color-stop(1, #3F3F3F));
                filter:  progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#FF0A0A0A', endColorstr='#FF3F3F3F'); /* IE6 & IE7 */
                -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#FF0A0A0A', endColorstr='#FF3F3F3F')"; /* IE8 */
                zoom:1;    -webkit-border-radius:0.1em;
                -moz-border-radius:0.1em;
                border-radius:0.1em;
                background-clip:border;
                color:#FFF;
                display:block;
                float:left;
                height:44px;
                margin:0 1px;
                overflow:hidden;
                padding:0;
                position:relative;
                text-align:center;
                width:30px;
            }

            .counter span.digit span {
                line-height:44px;
                position:relative;
                top:0;
            }

            .counter span.digit hr {
                border-color: transparent;
                -webkit-box-shadow: inset 0 2px 1px  rgba(0,0,0,0.5);
                -moz-box-shadow: inset 0 2px 1px  rgba(0,0,0,0.5);
                box-shadow: inset 0 2px 1px   rgba(0,0,0,0.5);
                height: 3px;
                margin: -2px 0 0 0;
                position: absolute;
                top: 50%;
                width: 100%;
                z-index: 1;
            }

            .counter span.separator {
                display:block;
                float:left;
                font-family:Georgia, serif;
                font-size:0.5em;
                position:relative;
                top:0.5em;
            }

            .counter span.separator hr {
                display:none;
            }
            </style>

            </head>
            <body onLoad:"initCounter()">
            <script language="Javscript">
            ;(function($){
                /*
                    Function: initCounter

                    Initializes the scrolling counter using the value currently displayed in the element.

                    Parameters:

                        $this - the counter container
                        e - jQuery Event object

                    See Also:

                        <animateDigit>
                */
                function initCounter($this, e){
                    $this.find('.digit').each(function(){
                        var $display = $(this);
                        var $digit = $display.find('span');

                        $digit.html([0,1,2,3,4,5,6,7,8,9,0].reverse().join('<br/>'))
                        $digit.css({
                            top: '-' + (parseInt($display.height()) * (10 - parseInt($digit.attr('title')))) + 'px'
                        });
                    });

                    animateDigit($this.find('.digit:last'), e);
                }

                /*
                    Function: animateDigit

                    Moves the digit indicated by $this one step. If the end of the counter has been reach, the subsequent digit(s) will also be rotated

                    Parameters:

                        $this - digit to be rotated
                        e - jQuery Event object
                */
                function animateDigit($this, e){
                    var $counter = $this.closest('.counter');
                    var $display = $this;
                    var $digit = $display.find('span');

                    // If we've reached the end of the counter, tick the previous digit
                    if(parseInt($digit.css('top')) == -1 * parseInt($display.height())){
                        animateDigit($display.prevAll('.digit:first'), e);
                    }

                    $digit.animate({
                        top: '+=' + $display.height() + 'px'
                    }, 500, function(){
                        // Repeat the animation on a semi-random interval
                        if($display.index('.counter .digit') == $counter.find('.digit').length - 1){
                            setTimeout(function(){
                                animateDigit($display, e);
                            }, Math.max(550, Math.random() * 10000));
                        }

                        // If we've reached the end of the counter, loop back to the top
                        if(parseInt($digit.css('top')) > -1 * parseInt($display.height())){
                            $digit.css({
                                top: '-' + (parseInt($display.height()) * 10) + 'px'
                            });
                        }
                    });
                }

                $(function(){
                    initCounter($('.counter'), $.Event('load'));
                });
            })(jQuery);

            </script>

            <span class="counter">
                <span class="digit">
                    <span title="3">3</span>
                    <hr />
                </span>
                <span class="separator">
                    <span title=",">,</span>
                    <hr />
                </span>
                <span class="digit">
                    <span title="2">2</span>
                    <hr />
                </span>
                <span class="digit">
                    <span title="4">4</span>
                    <hr />
                </span>
                <span class="digit">
                    <span title="4">4</span>
                    <hr />
                </span>
                <span class="separator">
                    <span title=",">,</span>
                    <hr />
                </span>
                <span class="digit">
                    <span title="4">4</span>
                    <hr />
                </span>
                <span class="digit">
                    <span title="1">1</span>
                    <hr />
                </span>
                <span class="digit">
                    <span title="8">8</span>
                    <hr />
                </span>
            </span>
            </body>
            </html> 
```

我在这里做错了什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:53:47.633

首先，您不需要正文中的 onload 函数。

```
<body onLoad:"initCounter()"> 
```

只是

```
<body> 
```

jQuery 将在这里处理加载事件：

```
$(function(){
  initCounter($('.counter'), $.Event('load'));
}); 
```

你的另一个问题只是一个错字。你有：

```
<script language="Javscript"> 
```

代替

```
<script language="javascript"> 
```

浏览器不知道“Javscript”（缺少 A）是什么。:)

# google-chrome-extension - 在 Chrome 扩展中填充链接列表时的 ng-href

> ID：15178579
> 
> 赞同：7
> 
> 时间：2013-03-02T19:39:13.570
> 
> 标签：google-chrome-extension, angularjs

我正在使用 Angular 开发 Chrome 扩展程序，并尝试使用它`ng-repeat`来创建链接列表。效果很好，除了我在填充链接`href`属性时遇到问题：

```
<ul>
    <li ng-repeat="item in menu" class="ng-scope">
        <a ng-href="#/new" href="unsafe:chrome-extension://ehklbggiaofbhgcghgnmejkpgommihdl/popup.html#/new">Add Link</a>
    </li>
    <li ng-repeat="item in menu" class="ng-scope">
        <a ng-href="#/bookmarks" href="unsafe:chrome-extension://ehklbggiaofbhgcghgnmejkpgommihdl/popup.html#/bookmarks">My Bookmarks</a>
    </li>
</ul> 
```

如何防止`unsafe:chrome-extension`东西被插入？注意：我已经`ng-csp`在我的应用程序的根目录上设置了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-07T08:01:00.900

我现在也面临同样的问题。没有找到任何解决方案。请查看此链接：[https](https://groups.google.com/forum/?fromgroups=#!topic/angular/YiP02I1wkNU) ://groups.google.com/forum/?fromgroups=#!topic/angular/YiP02I1wkNU 。

按照这个，检查[http://plnkr.co/edit/prTGFiheFI7GXNoDhoGT?p=preview上的 app.js](http://plnkr.co/edit/prTGFiheFI7GXNoDhoGT?p=preview)

代码如：

> `var app = angular.module('angularjs-starter', []);`
> 
> `app.config(function($compileProvider){ $compileProvider.urlSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|**chrome-extension**):/); });`

这个对我有用。

# streaming - 使用 Gstreamer 将 H.264 + AAC 流式传输到 RTMP 服务器

> ID：15178583
> 
> 赞同：1
> 
> 时间：2013-03-02T19:39:32.760
> 
> 标签：streaming, h.264, gstreamer, aac

我有一组文件：

*audio_X.aac:*

```
audio/mpeg, framed=(boolean)false, mpegversion=(int)2, stream-format=(string)adts, level=(string)2, profile=(string)lc, channels=(int)1, rate=(int)44100 
```

*video_X.h264:*

```
video/x-h264, stream-format=(string)byte-stream 
```

我的目标是将这些文件组合成适合在 Nginx 或 Flusonic 等闪存服务器上发布的 RTMP 流。

我的管道是（基于 GSTREAMER 0.10）：

```
appsrc_v -> h264parse -> flvmux -> rtmpsink  
appsrc_a -> aacparse -> faad ->faac  -> flvmux -> rtmpsink 
```

我有一个媒体流，但它只有视频部分。

你能告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T06:23:17.290

为此，您可以使用[gst-rtsp-server](http://gstreamer.freedesktop.org/modules/gst-rtsp-server.html)。它可以获取 2 个单独的流并将 RTSP 客户端作为服务器提供服务。

但它是RSTP，而不是RTMP！

`gst-rtsp-server`在这种情况下，您将不得不通过您的媒体服务器重新传输此 RSTP 。媒体服务器必须从`gst-rtsp-server`应用程序中提取数据。

# java - Axis2 存根生成问题

> ID：15178587
> 
> 赞同：0
> 
> 时间：2013-03-02T19:39:37.330
> 
> 标签：java, soap, wsdl, axis2, stubs

我使用 Apache axis2（用于 SOAP Web 服务的 Apache tomcat 6 服务器实例）从 WSDL 生成 Java 存根。生成的存根包含很多错误（100），其中一些是重复的方法，并且有一些不寻常的错误说 ARRAY.length 无法解析类型或类似的东西。由于这个错误，我无法编译存根。这是axis2的错误还是为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T10:26:26.027

为什么不能编译存根？这些存根是非常大的文件，很难理解。您无需担心警告，要编译文件，请始终在类路径中添加所有 axis2 库。那可行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-26T05:17:23.773

实际上问题出在 .net 应用程序生成的 WSDL 上。其中一些方法返回 .net 特定的数据类型。

# android - 解析 XML 时出错：格式不正确（无效令牌）strings.xml（Android SDK / Eclipse）

> ID：15178589
> 
> 赞同：0
> 
> 时间：2013-03-02T19:39:45.070
> 
> 标签：android, xml, eclipse, string

我有一个非常简单的 strings.xml 文件，但是我似乎仍然遇到错误（我不知道为什么！）

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
<string name="app_name">Linking Manager</string>
<string name="button1">Linking Manager</string>
</resources> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:52:54.310

在 Eclipse 中只需打开 string.xml 然后按`ctrl`+ `shift`+`F` 这将格式化您的源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:47:43.697

确保前后没有空格

```
<?xml version="1.0" encoding="utf-8"?> 
```

也是清洁项目。

如果一切都失败了，请删除 XML 文件并重新创建它并再次将其粘贴回来。当我使用它时，它不会给出任何错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-21T14:32:17.657

我有一个类似的问题，因为 R.java 对我很不利。修复后，由于此错误，我无法运行该程序。我进入底部标签“问题”，就在标签@Javadoc、声明、控制台、LogCat 和属性之前。我在那里看到了一些错误，我删除了它们。由于代码很好，它能够重新运行。

我很久以前就遇到过这个问题，因为我不知道如何解决它，所以我刚刚创建了一个全新的项目。希望这会帮助其他人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-08T16:10:08.347

我发生了这个错误，因为我在错误所在行的前面有一个小小的反引号。没有注意到打字，很难看到远离缩进线的地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-17T03:03:34.353

就我而言，我不小心将文件`Drawable`复制到.`res/values``res/drawable`

当然，`Drawable`文件从来都不是格式正确的 XML 文件……多么愚蠢。：秒

# actionscript - 使用（基于闪存的）游戏回放文件提取数据以创建“比赛统计”

> ID：15178590
> 
> 赞同：1
> 
> 时间：2013-03-02T19:39:52.473
> 
> 标签：actionscript, flash, game-development, rtmfp

我玩一个非常基本的多人 flash-applet 游戏@http [://www.haxball.com](http://www.haxball.com)（看看！）

Haxball 的比赛回放文件可以由用户在游戏中记录，并以“.hbr”文件的形式保存到磁盘。稍后可以通过直接在 haxball.com 界面中加载 .hbr 重播文件，或将 .hbr 文件公开上传到第三方服务（如“haxballtube.com”）来查看这些重播文件

**我的目标是推出第三方网络服务，允许用户上传 haxball 比赛回放文件 (.hbr)，然后对其进行分析 - 使用有意义的“比赛统计数据”（进球、投篮命中率、控球率等） .) 从上传的回放文件中提取、汇总并报告给用户。**

**可以在此处看到具有类似功能的 GREAT 示例：[http](http://www.playwithanton.ru/haxball/stat/)** *://www.playwithanton.ru/haxball/stat/（测试功能 - 您需要加载或链接到 haxball 游戏重播文件 (.hbr) 以进行分析并从中生成统计信息。我将在下面提供一个示例重播文件的链接 - 作为讨论的一部分）*

有人知道上面的例子是如何创建的吗？

我没有任何真正的编程经验——我希望一些乐于助人的人可以为我指明正确的方向，了解如何从这些 .hbr 文件中提取数据和有意义的统计数据，以及如何生成与上述类似的东西例子。我的主要目标是看到这个项目完成，并希望在此过程中学习一些编程。

感谢阅读 - 任何输入/方向都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-25T23:08:57.747

这是个好主意。反编译代码并从 hbr 中获取游戏结果会遇到很多问题，因为它可能不包含“Goal Scored”事件。它可能包含简单的事件：上、下、左、右。

我已经玩了一段时间[Bilu Ball](http://www.bilub.com)，这和 haxball 完全一样。唯一的区别是它将跟踪玩家玩家的所有游戏（拥有帐户，haxball 永远不会拥有的东西）并跟踪游戏玩家、得分、进球和其他内容。

所以我觉得还是等Bilu Ball实施联赛、球队和排行榜，而不是在haxball上浪费时间。

# android - 无法在 Mac 上安装 Android SDK 包

> ID：15178591
> 
> 赞同：2
> 
> 时间：2013-03-02T19:39:53.200
> 
> 标签：android, macos, android-emulator, osx-lion

我正在尝试将当前版本的 Android SDK 安装到运行 OSX 10.7.5 的 Mac 上。

将文件下载并解压缩到我的主目录（我有完整的写入权限）后，我打开`SDK > Tools`文件夹并运行*“android”*应用程序。这将打开 Android SDK 管理器窗口。如果我选中*“工具”*文件夹旁边的框以及从 3.0 到 4.1.2 的每个 Android API 版本旁边的框，然后单击*“安装 35 个软件包...”*按钮，我将转到*“选择要安装的软件包”安装”*窗口。

但是此窗口中的“安装”按钮被禁用，我在左侧窗格中看到的只是我不想安装的软件包（例如`Googletv License`和`Android SDK License`），它们旁边都有问号。我没有看到我想要安装的软件包列表（带有绿色复选标记）。

我究竟做错了什么？我尝试重新加载此 SO[帖子](https://stackoverflow.com/questions/14999058/sdk-manager-wont-install-new-packages-install-button-remains-unclickable)中提到的包，但工具下没有清除缓存的选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-01T12:33:05.680

我有同样的问题。选择 packages->Reload 刷新缓存。然后取消选择所有项目并手动选择android工具。按下安装那个包。然后会弹出许可证窗口，您可以接受许可证并安装更新的工具。完成后，关闭并重新打开 Android SDK Manager。重新启动后，它将再次选择所有需要更新的软件包，但是这一次，当您选择“安装 X 软件包...”时，它会将您带到许可证屏幕，您将能够接受所有许可证然后将启用“安装”按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-25T20:15:20.683

在“选择要安装的软件包”上，从左侧面板中选择软件包（说明应显示在您的右侧），然后“接受许可证”的单选按钮将起作用，安装按钮也应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-24T03:35:38.637

我在 OSX 10.10 和 Android Studio 1.2.2 中也遇到了这个问题。我可以通过转到 File > Invalidate Caches / Restart... 然后单击 invalidate and restart 按钮来解决。不确定重新启动或仅单独清除缓存是否有效。

之后我能够安装软件包。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-01-27T22:20:06.040

The above didn't work for me. I am on OSX Sierra on a MacBook Pro. I couldn't click the items in the window on the left. The way around it for me was simply using the cursor keys! That came to me after an hour of rebooting, re-downloading, re-loading packages. (First day using a Mac!)

But... It worked for me, hope it helps someone else!

# java - java类的java服务器上的根路径？

> ID：15178597
> 
> 赞同：0
> 
> 时间：2013-03-02T19:40:35.790
> 
> 标签：java, jakarta-ee, relative-path

我制作了一个 java 程序来查找我在 java 中的 web 项目的所有文件的哈希值，以便我可以找到可能（更改/添加/黑客）的文件。当我运行这个类 directory.java 时，我能够找到像这样的文件的哈希值

```
\web\WEB-INF  ----- checking...OK
                  ajax-loader.gif -hash--437179c0b495121af68bdd64f797e02b
.\web\ajax-loader.gif--437179c0b495121af68bdd64f797e02b--Fri Dec 07 11:26:35 IST 2012
                  display.jsp -hash--b45f8db4489e42ecf3853a0c3cfab7a8
.\web\display.jsp--b45f8db4489e42ecf3853a0c3cfab7a8--Wed Dec 05 09:22:12 IST 2012
                  index.jsp -hash--d76170f1f30914ecc32fa81a0d7aa728
.\web\index.jsp--d76170f1f30914ecc32fa81a0d7aa728--Tue Nov 20 18:06:59 IST 2012
                  jssdkouth2.html -hash--31044821b876692909fd261152d2d102
.\web\jssdkouth2.html--31044821b876692909fd261152d2d102--Mon Dec 31 12:15:55 IST 2012
                  like.jpg -hash--c0c82ea9bc245ed09d2dd6ed38db5bb0
.\web\like.jpg--c0c82ea9bc245ed09d2dd6ed38db5bb0--Tue Dec 04 14:33:07 IST 2012
                  META-INF
.\web\META-INF\context.xml  ----- checking...OK
                        context.xml -hash--27a8469aef212e73798e265993ced40a
.\web\META-INF\context.xml--27a8469aef212e73798e265993ced40a--Tue Nov 20 18:06:56 IST 2012
                  newhtml1.html -hash--7b8a39efa9be4ad7de50759ce2ab25af 
```

但是当我从 servlet 运行它时，我得到了像这样的文件的哈希值

```
 bootstrap.jar -hash--fea2494f41dd54fc0d693b01745c03d0
.\bootstrap.jar--fea2494f41dd54fc0d693b01745c03d0--Sun Nov 11 20:36:10 IST 2012
status for path=NEW
path found in db 
            catalina-tasks.xml -hash--3762f67ebfb0ac7e4c707a5b9f103f92
.\catalina-tasks.xml--3762f67ebfb0ac7e4c707a5b9f103f92--Thu Mar 10 15:44:44 IST 2011
status for path=NEW
path found in db 
            catalina.bat -hash--3fbace7fc74faf47844efb293c5d606b
.\catalina.bat--3fbace7fc74faf47844efb293c5d606b--Thu Mar 10 15:44:44 IST 2011 
```

我尝试如下传递起始路径，但均未成功

```
 String workingDir = System.getProperty("user.dir");
  String workingDir2="."; 
```

那么如何从java文件中找到服务器上的路径呢？我不想从 servlet 传递路径，因为我将对其进行修改以在午夜自动生成报告作为电子邮件结果。另外，安排该程序在每天午夜运行的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:12:04.027

这很常见，[我认为这个 wud 帮助](https://stackoverflow.com/questions/918396/how-to-get-the-path-of-servers-folder-inside-java-program-j2ee-jstl)

关于您的第二个要求，我认为[这](http://www.ibm.com/developerworks/java/library/j-schedule/index.html)说明了一切！

# c# - 使用 id 列表或数组的 Linq 查询

> ID：15178598
> 
> 赞同：6
> 
> 时间：2013-03-02T19:40:40.250
> 
> 标签：c#, linq, entity-framework

我无法弄清楚如何在 c# 中使用 linq 查询数据库以获取与 ID 列表或数组对应的所有对象并将它们放入列表中。例如：

我有一个项目表。我想构建一个方法来检索其 id 在 pass 数组或列表中的所有项目。我已经用谷歌搜索了它，但它总是假设我只想查询列表或数组，而不是查询使用列表或数组。

提前致谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-02T19:41:45.207

听起来你想要这样的东西：

```
var query = items.Where(item => validIds.Contains(item.Id)); 
```

请注意，如果这都是本地的（即进程内，LINQ to Objects）并且您可能有很多有效的 ID，您可能想要构造一个`HashSet<T>`.

或者你可以加入，当然：

```
var query = from id in validIds
            join item in items on id equals item.Id
            select item; 
```

（网络*上有*很多这样的例子，甚至在 Stack Overflow 上，但我可以理解这不是一个容易找到的例子，因为你使用的所有术语都很常见。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-16T10:04:24.843

像这样使用

```
 var subscriptionDetails = SubscriptionMasterBL.GetSubscriptionMasterDetails();
                tempUserList = lstSubscriberUsers.Where(a => subscriptionDetails.Any(b => b.SubscriptionUserId == a.Id 
                    && b.TokenId != Guid.Empty)).ToList(); 
```

# python - 会话在python中是什么意思？

> ID：15178604
> 
> 赞同：1
> 
> 时间：2013-03-02T19:41:22.590
> 
> 标签：python

我有以下代码，我需要知道是什么`self.session = self.connect()`意思？

```
import optparse
import pxssh

class Client:
  def __init__(self, host, user, password):
     self.host =host
     self.user =user
     self.password =password
     self.session =self.connect()

  def connect(self):
     try:
         s =pxssh.pxssh()
         s.login(self.host, self.user, self.password)
         return s
     except Exception, e:
         print e
         print '[-] Error Connecting' 
```

谢谢你的帮助 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:43:25.277

> “self.session =self.connect()”是什么意思

它调用对象的`connect()`方法，并将结果分配给对象的`session`数据成员。

如果您检查该`connect()`方法，您将看到它建立并返回一个`ssh`连接（或者`None`如果无法建立连接）。

# java - 返回/打印数组

> ID：15178607
> 
> 赞同：0
> 
> 时间：2013-03-02T19:41:37.983
> 
> 标签：java, arrays, return

我有返回数组的问题。

```
package iterators;

import java.util.*;
import java.io.*;

public class Nic {
    String[] abel() throws IOException {
        int i = 0;
        BufferedReader wczytaj = new BufferedReader(new FileReader("filmy.txt"));
        StringBuilder sb = new StringBuilder();
        String tekst = wczytaj.readLine();
        while (tekst != null) {
            sb.append(tekst);
            sb.append("\n");
            tekst = wczytaj.readLine();
        }
        String calosc = sb.toString();
        String film = calosc;
        String znak = ",";
        String[] tab;
        tab = film.split(znak);
        for (i = 0; i < tab.length; i++) {
            System.out.println("listusia: " + i + " " + tab[i]);
        }
        List<String> list = Arrays.asList(tab);
        Collections.reverse(list);
        tab = (String[]) list.toArray();
        for (i = 0; i < tab.length; i++) {
            System.out.println(tab[i]);
        }
        return tab;
    }
} 
```

我想返回一个数组，在这里打印：

```
for(i=0;i<tab.length;i++){
    System.out.println(tab[i]);
} 
```

但我有问题。无法返回 tab[i]，因为它给我一个错误“不兼容的类型”。我需要这个数组来进行其他操作。有人可以帮我吗？

这是我更改后的代码：

```
package iterators;
import java.util.*;
import java.io.*;
public class Nic{
        String abel() throws IOException{
            int i=0;
            BufferedReader wczytaj = new BufferedReader(new FileReader("filmy.txt"));
            StringBuilder sb=new StringBuilder();
            String tekst=wczytaj.readLine();
            while (tekst!=null) {
                sb.append(tekst);
                sb.append("\n");
                tekst=wczytaj.readLine();
            }
            String calosc=sb.toString();
            String film=calosc;
            String znak=",";
            String[]tab=new String[301];
            tab=film.split(znak);
            for(i=0;i<tab.length;i++){ 
                //System.out.println("listusia: "+i+" "+tab[i]);
            }
            List<String> list=Arrays.asList(tab);
            Collections.reverse(list);
            tab = (String[]) list.toArray();
            for(i=0;i<tab.length;i++){
                //System.out.println(tab[i]);
            }
            return tab[i];
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:43:36.897

[**List#toArray()**](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#toArray%28%29)返回一个`Object[]`数组。改用重载[**的List#toArray(T[])**](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#toArray%28T%5B%5D%29)。

```
tab = list.toArray(new String[list.size()]);
            for(i=0;i<tab.length;i++){
                System.out.println(tab[i]);
            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:56:02.580

您收到错误是因为您的方法`"Incompatible types"`的返回类型是并且您正在尝试返回( )。如果您想返回，则必须将方法的返回类型更改为而不是。`abel()``String[]``String``tab[i]``tab[i]``abel()``String``String[]`

如果要返回整个数组，请使用`String[]`返回类型。它应该工作。

```
import java.util.*;
import java.io.*;

public class Nick {
    String[] abel() throws IOException {
        int i = 0;
        BufferedReader wczytaj = new BufferedReader(new FileReader("filmy.txt"));
        StringBuilder sb = new StringBuilder();
        String tekst = wczytaj.readLine();
        while (tekst != null) {
            sb.append(tekst);
            sb.append("\n");
            tekst = wczytaj.readLine();
        }
        String calosc = sb.toString();
        String film = calosc;
        String znak = ",";
        String[] tab;
        tab = film.split(znak);
        for (i = 0; i < tab.length; i++) {
            System.out.println("listusia: " + i + " " + tab[i]);
        }
        List<String> list = Arrays.asList(tab);
        Collections.reverse(list);
        tab = (String[]) list.toArray();
        for (i = 0; i < tab.length; i++) {
            System.out.println(tab[i]);
        }
        return tab;

    }

    public static void main(String[] args) throws IOException {
        Nick nick = new Nick();
        nick.abel();
    }

} 
```

# drag-and-drop - Javafx拖拽获取源码

> ID：15178609
> 
> 赞同：1
> 
> 时间：2013-03-02T19:41:41.807
> 
> 标签：drag-and-drop, javafx

我有实现 javafx 拖放的代码，类似于[http://docs.oracle.com/javafx/2/drag_drop/HelloDragAndDrop.java.html](http://docs.oracle.com/javafx/2/drag_drop/HelloDragAndDrop.java.html) 我想测试用户是否将图像放在正确的区域我没有知道是否有一种方法可以获取源并获取目标，以便我可以检查源是否匹配正确的目标。我正在使用这个可视化界面： [https](https://dl.dropbox.com/u/6241504/3-2-2013%207-35-50%20PM.png) : //dl.dropbox.com/u/6241504/3-2-2013%207-35-50%20PM.png 在此先感谢...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T16:28:30.337

您也可以获得手势源和目标，因此您可以轻松检查您的源和目标是否相等，或者您是否可以接受。您需要转换为特定类型！

```
event.getGestureSource(); 
```

或者

```
event.getGestureTarget(); 
```

# xcode - 关闭视图控制器会弄乱 UIScrollView 的内容

> ID：15178612
> 
> 赞同：1
> 
> 时间：2013-03-02T19:41:46.020
> 
> 标签：xcode, uitableview, uiview, uiscrollview, scroll

我有FirstViewController，其中包含一个带有UIScrollView 的UIView，并且在UIScrollView 中有一个UITableView。UITableView 已禁用滚动，我只增加 UIScrollView 的 contentSize 才能看到完整的 UITableView。

```
___________________________________
|                                 |
|                                 |
|                                 |
-----------Various content---------
|                                 |
|                                 |
|                                 |
___________________________________
|                                 |
|                                 |
|                                 |
|                                 |
|           UITableView           |
|                                 |
|                                 |
|                                 |
|_________________________________| 
```

当我在我的 UIScrollView 中的某个点上，以便 contentOffset =/= 0 并且我按下 UITableView 中的一个单元格时，我会模态地呈现一个新的控制器（SecondViewController）。这工作正常。当我关闭 SecondViewController 时，FirstViewController 中的内容被搞砸了。

UITableView 最初设置为使其原点位于屏幕中间（垂直）。当我关闭 SecondViewController 时，UITableView 肯定它的来源位于屏幕中间，但 UITableView 上方的内容在 UIScrollVIew 中被向上推，其值为 contentOffset（在推入 SecondViewController 之前是什么）。

```
___________________________________
|                                 |
-----------Various content---------
|                                 |    
|                                 |
|                                 |
|                                 |    
|                                 |
___________________________________
|                                 |
|                                 |
|                                 |
|                                 |
|           UITableView           |
|                                 |
|                                 |
|                                 |
|_________________________________| 
```

编辑：我刚刚发现 UIScrollView 中的 _startOffsetY 已更改。而且我不知道这是否与它有关，但分页被禁用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-06T14:16:48.533

做这个 ：

```
-(void) viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    [scrollView setContentOffset:CGPointZero];

}

-(void) viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    [scrollView setContentSize:(CGSizeMake(320, scrollSubView.frame.size.height))];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T09:12:51.860

确保您使用的是 iOS5 模拟器或设备，因为在 iOS6 中不推荐使用解除模型 viewController。

要在所有 iOS 中工作，您必须像......

```
if ([self respondsToSelector:@selector(presentViewController:animated:completion:)])
{
    [self presentViewController:test animated:YES completion:nil];
}
else
{
     [self presentModalViewController:test animated:YES];
} 
```

并解雇喜欢

```
if ([self respondsToSelector:@selector(dismissViewControllerAnimated:completion:)])
{
    [self dismissViewControllerAnimated:animated completion:nil];
}
else
{
    [self dismissModalViewControllerAnimated:animated];
} 
```

希望你会喜欢这个............

# qt - Qt 中 qwtplot 上的悬停事件

> ID：15178617
> 
> 赞同：1
> 
> 时间：2013-03-02T19:42:27.003
> 
> 标签：qt, hover, qwt

我有一个带有几个 qwtplotcurves 的 qwtplot。我希望在悬停其中一条曲线时触发一个事件。我知道我必须为此使用 installeventfilter() ，但是我应该在什么对象上使用它？我不能在绘图曲线上使用它，因为这不是一个对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T17:50:21.590

请看一下`event_filter`Qwt附带的内容。您应该使用该类`CanvasPicker`（它不是 Qwt API 的一部分，但您会在示例中找到代码）。您可以使用在您的类中实例化它

```
 picker = new CanvasPicker(plot); // plot is a pointer to your instance of QwtPlot 
```

你会看到你引用的事件过滤器安装在`CanvasPicker`.

现在看一下 CanvasPicker::eventFilter(QObject *object, QEvent *e) 在`QwtPlot`. 在 switch 构造 fi change 中实现您的应用程序逻辑`case QEvent::MouseMove:`。

# javascript - 在绘制之前剪辑上下文可以帮助 HTML5 画布性能吗？

> ID：15178618
> 
> 赞同：4
> 
> 时间：2013-03-02T19:42:28.617
> 
> 标签：javascript, html, canvas, drawing

我正在研究 HTML5 游戏框架的工作原理，并且想知道它所做的特定优化。

该框架跟踪可能已更改的屏幕“脏”区域。如果实体与这样的区域重叠，则重新绘制它。然而，首先，上下文仅被裁剪到脏区。

这比简单地重绘整个图像更快吗？如果实体是通过一系列更复杂的画布命令呈现的呢？

*e：*再想一想之后，我意识到无论性能如何，剪辑在游戏框架的上下文中都是至关重要的，这是有原因的。不过，我仍然对此有点好奇，所以我将把这个问题留在原样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T18:22:25.030

好吧，一方面，您可以通过不渲染不与脏区相交的实体来节省时间。但是，另一方面，您会浪费时间，因为带有剪裁的画布操作速度较慢。

某些浏览器 (Chrome) 会跟踪您绘制的画布区域并仅更新屏幕的该部分。它还节省了一些时间。

因此，这样的事情是否有帮助取决于脏区有多大（如果脏区几乎与整个画布一样大，那么在不剪裁的情况下重绘所有内容会更快）以及您拥有多少对象（您拥有的时间越多，您的时间越多）可以保存）。我想大多数时候这是值得的。每帧重绘所有东西一定很慢。

# php - PHP更新表

> ID：15178620
> 
> 赞同：0
> 
> 时间：2013-03-02T19:42:50.523
> 
> 标签：php, mysql

我正在为基本的 PHP 学习目的创建一个虚拟应用程序，现在我的应用程序将用户登录到一个帐户，用户可以在该帐户中执行多项操作，例如搜索产品等。用户可以执行的功能之一是编辑帐户详细信息和此对我来说一切都出错了。没有显示任何错误，但是当我通过单击“编辑帐户”按钮提交查询时，一切都可以正常工作，但是当我检查数据库时，我发现没有任何改变...

我也知道代码的安全问题，但我想建立基本功能

userEditAccount.php：

```
<?php

session_start();

    include('connect_mysql.php');

        if(isset($_POST['Edit Account']))
        {

            $usernameNew = stripslashes(mysql_real_escape_string($_POST["username"]));
            $passwordNew = stripslashes(mysql_real_escape_string($_POST["password"]));
            $first_nameNew = stripslashes(mysql_real_escape_string($_POST["first_name"]));
            $last_nameNew = stripslashes(mysql_real_escape_string($_POST["last_name"]));
            $emailNew = stripslashes(mysql_real_escape_string($_POST["email"]));

            $dbusername = $_SESSION['username'];
            $editQuery = mysql_query("UPDATE users SET user_id='NULL' username='$usernameNew', password='$passwordNew', first_name='$first_nameNew', last_name='$last_nameNew' , email='$emailNew' WHERE username='$edit'");

            if(!$editQuery)
            {
                echo mysql_error($editQuery);
                die($editQuery);
            }
        }

?>

<html>
<head>

<title>Edit Account</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<link href="style.css" rel="stylesheet" type="text/css" />

</head>
<body>
<div id="wrapper">
<header><h1>E-Shop</h1></header>

    <article>
        <h1>Welcome</h1>
            <h1>Edit Account</h1>

<div id="login">
    <ul id="login">
    <form method="post" name="editAccount" action="userEditAccount.php"  >
        <fieldset>  
            <legend>Fill in the form</legend>
                <label>Select Username : <input type="text" name="username" /></label>
                <label>Password : <input type="password" name="password" /></label>
                <label>Enter First Name : <input type="text" name="first_name" /></label>
                <label>Enter Last Name : <input type="text" name="last_name" /></label>
                <label>Enter E-mail Address: <input type="text" name="email" /></label>
        </fieldset>
        <br />

                <input type="submit" value="Edit Account" class="button">

    </form>

</div>
    <form action="userhome.php" method="post">
    <div id="login">
        <ul id="login">
            <li>
                <input type="submit" value="back" onclick="index.php" class="button">   
            </li>
        </ul>
    </div>      
</article>

<aside>
</aside>

<div id="footer">Text</div>
</div>

</body>
</html> 
```

我还将包括 login.php：

```
<?php
session_start();

    require('connect_mysql.php');

     if($_SERVER['REQUEST_METHOD'] == 'POST')
     {

        $username = $_POST["username"];
        $password = $_POST["password"];
        $username = stripslashes($username);
        $password = stripslashes($password);
        $username = mysql_real_escape_string($username);
        $password = mysql_real_escape_string($password);

        $query = mysql_query("SELECT * FROM users WHERE Username='$username' AND Password='$password'");
        $numrow = mysql_num_rows($query);

    if($username && $password){

        $query = mysql_query("SELECT * FROM  users WHERE username='$username'");
        $numrow = mysql_num_rows($query);

    if($numrow !=0){

        while($row = mysql_fetch_assoc($query)){

            $dbusername = $row['username'];
            $dbpassword = $row['password'];         
        }

        if($username == $dbusername && $password == $dbpassword ){

            $_SESSION['username'] == $dbusername;
            header("Location: userhome.php");

        }
        else{
            echo "Incorect password";
        }

    }
    else{
        die("This user dosent exists");
    }
}
else{

    $reg = die("Please enter username and password");
}
}

?> 
```

在我自己的意见中，问题出在 SESSION 或查询中的某个地方，但我已经浏览了许多不同的资源，这不应该是一个问题....我可能遗漏了一些非常基本的东西或一些 LAME 错误：D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:46:23.470

很简单。您使用`if(isset($_POST['Edit Account']))`，但您的提交按钮没有名称： `<input type="submit" value="Edit Account" class="button">`

将输入更改为：

`<input type="submit" value="Edit Account" name="edit_account" class="button">`

并更改`if(isset($_POST['Edit Account']))`为`if(isset($_POST['edit_account']))`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:49:22.807

$编辑在哪里？

```
WHERE username='$edit' 
```

也许您必须使用会话的 $dbusername 更改它

然而：

- 不要使用 mysql 已弃用，使用 mysqli 或 pdo

- 您可以在一行中保护所有变量

```
foreach($_POST as $key => $var) $_POST[$key] = mysqli_real_escape_string($var); 
```

-在输入变量上添加验证控制，以及登录会话检查

# sql - 以编程方式生成 Class.vb 文件

> ID：15178621
> 
> 赞同：0
> 
> 时间：2013-03-02T19:43:00.350
> 
> 标签：sql, vb.net, class, builder

我想创建一个类构建器，它将从指定的数据库中获取表并构建我的 [className].vb 文件 - 只需按一下按钮！

例如：

```
Dim strBuilder As New StringBuilder

strBuilder.Append("Public class clsExample" & vbCrLf)

'Create variables
strBuilder.Append("Private _ID As String")
strBuilder.Append(vbCrLf)

'Create properties
strBuilder.Append("Public Property _ID() As Integer" & vbCrLf)
strBuilder.Append("Get" & vbCrLf)
strBuilder.Append("return _ID" & vbCrLf)
strBuilder.Append("end Get" & vbCrLf)
strBuilder.Append("Set(ByVal Value As Integer)" & vbCrLf)
strBuilder.Append("_ID = Value" & vbCrLf)
strBuilder.Append("End Set" & vbCrLf)
strBuilder.Append("End Property " & vbCrLf)
strBuilder.Append(vbCrLf)
strBuilder.Append(vbCrLf & "End Class")

Console.Write(strBuilder.ToString()) 
```

在使用前面的代码创建的 clsExample.vb 文件中获得此结果

```
Public Class clsExample
        Private _ID As String
        Public Property _ID() As Integer
            Get
                Return _ID
            End Get
            Set(ByVal Value As Integer)
                _ID = Value
            End Set
        End Property

    End Class 
```

我不确定如何告诉程序创建 [className].vb 文件并将我的 strBuilder 作为代码包含在文件中。希望这是有道理的...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:06:46.360

我不太了解您的方法 :) 但是如果您想要任何动态创建，您需要连接数据库并阅读所有必要的 shema 信息。

我曾经使用这个项目[http://sqldoc.codeplex.com/](http://sqldoc.codeplex.com/)从表中读取所有数据以从中创建一些代码。这对你来说可能是一个好的开始。这个项目创建了一个文档，但您甚至可以读取所有数据信息并用它做其他事情（例如，创建一个在文本文件中编写源代码的类 => 您的 class.vb）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:15:22.560

也许我错过了您在这里问的内容，但是您是否正在寻找这样的东西：

`IO.File.WriteAllText("className.vb", strBuilder.ToString())`

[http://msdn.microsoft.com/en-us/library/ms143375.aspx](http://msdn.microsoft.com/en-us/library/ms143375.aspx)

# angularjs - 模态输入后的AngularJS更新选择控件

> ID：15178622
> 
> 赞同：0
> 
> 时间：2013-03-02T19:43:04.830
> 
> 标签：angularjs

**这是我的表单的选择控件：**

```
<select ng-model="truckMfg.truckMfgs" ng-options="truckMfg.Name for truckMfg in truckMfgs">
   <option value="" selected>Select Truck Manufacturer ..</option>  
</select> 
```

**我有一个模式，允许用户添加尚未在表中的 Mfg。这是我的控制器：**

```
function TruckMfgCtrl($scope, $routeParams, $http, API, $location)  {

$scope.truckMfgs = API.GetTruckMfgs(); // <-- this works at initialization

$scope.save = function () {
    $http.post('/api/TruckMfgs/', $scope.truckMfg)  // data does get saved corectly
        .success(function () {
        })
        .error(function (data) {
            alert(data);
        });

    setTimeout(function () {
        $scope.truckMfgs = API.GetTruckMfgs(); // <-- this is not working
        $scope.$apply();
    }, 1000);
}; 
```

}

**我要完成的工作：**

用户添加新制造商并且模式关闭后，我希望将选择控件更新为新的制造商列表。addtl mfg 正在添加到表中，但它没有出现在选择控件中。刷新表单将显示新数据，但这当然不是我想要的。

有任何想法吗？

**马克·拉科克**

我感谢您的帮助。我试过了，但没有用：

```
$scope.save = function () {
    $http.post('/api/TruckMfgs/', $scope.truckMfg)
        .success(function () {
            $scope.truckMfgs.append($scope.truckMfg);
            console.log($scope.truckMfg);
        })
        .error(function (data) {
            alert(data);
        });
}; 
```

尊敬的，你能告诉我你推荐的代码吗？谢谢

**（PS：查看了你的个人资料，我也喝咖啡，把我的女儿带到了mawl，但不是在Nork）：）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:01:45.217

我认为不需要在 save() 中调用 GetTruckMfgs()，因为您已经拥有需要添加到 truckMfgs 列表中的数据。所以相反，让 save() 添加/追加`$scope.truckMfg`到`$scope.truckMfgs`. 这样您就可以避免再次访问服务器。

如果您想在更新选择列表之前确保数据已成功发布，您可以在 success() 回调中执行此操作。如果您希望您的 UI 更新得更快（即响应更快），您可以在保存函数中的 post() 调用之前（或之后）执行此操作，然后在错误回调中处理任何错误（例如，删除项目如果 post() 失败，则从选择列表中）。

# sql-server-2005 - SQL Server 2005 日期格式 [DD-Mon-YY hh:mm:ss]

> ID：15178625
> 
> 赞同：2
> 
> 时间：2013-03-02T19:43:29.863
> 
> 标签：sql-server-2005, datetime

我将日期时间存储在 SQL Server 2005 的表中，格式如下：

```
 2012-04-16 00:00:00.000 
```

我需要在查询结果中以 16-Apr-2012 00:00:00 格式获取日期。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T19:56:07.073

```
Select Convert(VarChar(20),[SomeDate],113) 
```

113，是 24 小时格式，包括毫秒，varchar(20) 将它们切断。

进一步参考我最喜欢的 MSDN 页面之一[T-SQL Convert DateTime To String](http://msdn.microsoft.com/en-us/library/ms187928.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:53:07.210

> 当您尝试读取日期时，只需将其转换为您需要的格式。

```
SELECT CONVERT(VARCHAR(20), GETDATE(), 113) 
```

> [SQL 日期格式列表。](http://www.sql-server-helper.com/tips/date-formats.aspx)

# sql - 如何以 DD/MM/YYYY 格式插入 DATE()

> ID：15178627
> 
> 赞同：0
> 
> 时间：2013-03-02T19:43:31.437
> 
> 标签：sql, sqlite

我正在使用以下`INSERT`命令，但格式为' ***yyyy-mm-dd*** '。我如何将其更改为显示为***dd/mm/yyyy***？

另外，我将如何显示周末（一周的最后一天）？每个星期的星期日，不管它是在哪一天运行的？

```
insert into resource values ('APPUSER', date(),'Admin','0') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:05:21.257

*这是你想要的？*

```
Insert into resource values ('APPUSER', strftime('%d-%m-%Y','now'), 'Admin','0') 
```

还要检查这个[Sqllite 日期格式函数](http://www.sqlite.org/lang_datefunc.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:47:16.270

```
irb(main):009:0> d = Date.today
=> #<Date: 2013-03-02 ((2456354j,0s,0n),+0s,2299161j)>
irb(main):010:0> d.strftime("%d/%m/%Y")
=> "02/03/2013" 
```

# javascript - 我想在asp.net C#的gridview中突出显示一个特定的单词

> ID：15178639
> 
> 赞同：1
> 
> 时间：2013-03-02T19:44:28.590
> 
> 标签：javascript, asp.net, gridview, highlight

我有一个显示很多文本的 GridView 我想在文本之间导航时突出显示一个特定的单词，我想总是突出显示它我的意思不是从搜索或其他东西之后，假设我在里面有以下文本gridview“我早上要一个苹果，晚上要一个苹果”我想在浏览文本时突出显示gridview中的“apple”一词，我尝试了一个java脚本，但什么也没发生！谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:19:31.773

为此，您需要将基本的 html 标签包裹在所需的单词周围。

所以改变你的字符串

`"I would have an apple in the morning.."`

至

`"I would have an <span style='background-color:Yellow;'>apple </span>in the morning..".`

一切都会开始工作。

现在你可以在任何地方进行。

1.  通过 javascript
2.  通过服务器端，即为此类字符串预处理您的数据源。即在代码中相应地修改您的数据源内容。

通过 javascript/jquery，您可以这样做：Gridview 以纯 html 格式呈现到表格中，因此您提供给 gridview 的任何 ID 都将是表格的 ID。使用jquery（或javascript）抓取它并处理innerHtml。

IE

```
 $(document).ready(function(){
      var text= $('#GridView_Equivalent_Id').html(); 
     //var text= $(#+'<%= GridView1.ClientID %>').html();
     text= text.replace('apple','<span style="background-color:Yellow" >apple</span>'); 
     $('#GridView_Equivalent_Id').html(text);
}); 
```

在服务器端，您可以执行此操作。

假设您有一个数据表，您将 GridView 绑定到该数据表，并且该数据表的第二列具有该字符串（句子），您要突出显示其中一个词。

做这个。

```
 DataTable dt = GetDatafromDb();
     foreach(DataRow row in dt.Rows)
     {
         row['columnContainingText'] = row['columnContainingText'].ToString().Replace("apple","<span style='background-color:yellow'>apple</span>");
     }
    GridView1.DataSource=dt;
    GridView1.DataBind(); 
```

# python - 在递归函数中使用 terminate() 终止 Python 进程

> ID：15178640
> 
> 赞同：-1
> 
> 时间：2013-03-02T19:44:32.847
> 
> 标签：python, recursion, multiprocessing

我有一个递归函数：

```
def generateCategory(url,level,id,lock)
    #url(string) , level (int), id (Value:shared memory), Lock (Semaphore)

    if level == 5:
        return              #The child process should terminate here right?

    #code here

    for i in range(5):
        Process(target=fn, args =('abc',level+1,id,lock)).start()

    return                  #Here, according to my understanding, the parent process should terminate leaving the child process as an orphan (since I didn't use join) 
```

如果我没记错的话，一些进程并没有终止。我怀疑可能会发生同样的情况，因为 for 循环后的返回不像我预期的那样工作。相反，它会等到所有子进程都完成。我查看了 terminate() 命令。但是，为了让它为我工作，我必须终止一个进程本身。

```
self.terminate() 
```

似乎给出了一个错误。

还有一个轻微的并发症。我在代码中使用值（共享内存）和锁（信号量）。我已经彻底检查了代码，并且可以确认在持有任何资源时没有线程终止。

在这方面的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:07:58.453

你需要跟踪你的`Processes`，也许

```
processes = [Process(target=fn, args=('abc',level+1,id,lock)) for i in range(5)] 
```

然后启动它们

```
[p.start() for p in processes] 
```

然后你可以随时让他们终止

```
[p.terminate() for p in processes] 
```

`processes`如果您需要在其他地方处理此终止，您可以从您的函数返回。

# r - 在 R 中使用优化

> ID：15178647
> 
> 赞同：1
> 
> 时间：2013-03-02T19:45:05.510
> 
> 标签：r

我正在尝试使用 R 中的 optim 函数来优化模型中的三个参数，但无法弄清楚如何让它搜索一系列值，就像使用“优化”函数一样。我尝试过使用 for 循环，这是我尝试中最成功的一次，但由于某种原因它似乎停止在 355 的值，理想情况下我想尝试比这更高的组合。除此之外，我还尝试编写多次调用 optim 的函数，尝试矢量化并尝试将列表值放入 optim 中的“par”参数中，但是所有这些尝试都产生了错误消息

```
"unable to evaluate at initial parameters". 
```

长短有没有人知道我如何使用 optim 函数来搜索参数值的范围，因为“优化”函数会？

任何帮助或指示将不胜感激！！！

我的代码看起来像：它是对应比例的三个最大似然函数，然后是使用 optim 的三个尝试！

```
rm(list=ls())

load('Dat.RData')

mean(dat)
var(dat)

loglike<-function(par,dat,scale)
{ ptp<-dat[1:length(dat)-1]
  ptp1<-dat[2:length(dat)]

  r<-par['r']
  k<-par['k']
  sigma<-par['sigma']

  if(scale=='log')
  {
    return(sum(dnorm(log(ptp1)-log(ptp)*exp(r-(ptp/k)),mean=0,sd=sigma,log=T)))
  }

  if (scale=='sqrt')
  {
    return(sum(dnorm(sqrt(ptp1)-sqrt(ptp)*exp(r-(ptp/k)),mean=0,sd=sigma,log=T)))
  }

  if (scale=='linear')
  {
    return(sum(dnorm(ptp1-ptp*exp(r-(ptp/k)),mean=0,sd=sigma,log=T)))
  }
}

sqrts<-c()
for(i in 1:4000){
  sqrts[i]<-optim(par=c(r=i,k=i,sigma=i),fn=loglike,dat=dat,scale='sqrt',method='Nelder-Mead',control=list(fnscale=-1))

}

logs<-c()
for(i in 1:4000){
  logs[i]<-optim(par=c(r=i,k=i,sigma=i),fn=loglike,dat=dat,scale='log',method='Nelder-Mead',control=list(fnscale=-1))

}

lins<-c()
for(i in 1:4000){
  lins[i]<-optim(par=c(r=i,k=i,sigma=i),fn=loglike,dat=dat,scale='linear',method='Nelder-Mead',control=list(fnscale=-1))

} 
```

非常感谢！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-02T23:43:17.150

该错误`unable to evaluate at initial parameters` 是由于您优化无法在某些时候评估您的功能。（这里有很多）。注意：

*   您使用`sqrt`，因此您的数据必须是正面的，否则您需要删除负面观察。`dat <- dat[dat>0]`
*   日志功能同样的问题，`dat <- dat[dat > 1]`
*   回收发生在这里，`log(ptp1)-log(ptp)`因为你用 n-1 的向量减去 n 的向量。我会替换`ppt1`为`c(1,ppt1)`
*   对于`linear`function ，它会发散，因为您使用给指数函数一个很大的 r （例如，参见 exp(365) ）。

我认为，R 很棒，因为您可以轻松地绘制数据并查看函数会发生什么。例如，在这里我`wireframe`用来绘制您的一个函数的 3 维表面。

```
dat <- seq(1,100)
ptp <- head(dat,-1)
ptp1 <- c(tail(dat,-2),1)

g <- expand.grid( k = seq(0.1,2,length.out=100),     ## k between [0.1,2]
                  sigma = seq(0.1,1,length.out=100), ## sigma [0.1,1]
                  r= c(0.1,0.5,0.8,1))               ## some r points forgrouping

z <- rep(0,nrow(g))
for(i in seq_along(z))
  z[i] <- sum(dnorm(log(ptp1)-log(ptp)*exp(g[i,'r']-(ptp/g[i,'k'])),
                 mean=0,
                 sd=g[i,'sigma'],
                 log=T))
g$z <- z
any(is.infinite(g$z))     ## you can test if you have infinite value       
FALSE

wireframe(z ~ k * sigma, data = g, groups = r,
          scales = list(arrows = FALSE),
          drape = TRUE, colorkey = TRUE) 
```

![在此处输入图像描述](../Images/3a456c5e149415a09d807339a74a17b5.png)

# python - Mayavi 中的多个地块

> ID：15178648
> 
> 赞同：4
> 
> 时间：2013-03-02T19:45:12.893
> 
> 标签：python, data-visualization, mayavi

MATLAB 有一个`hold`函数（如果我没记错的话，已经有一段时间了）在同一个“图形”/窗口上绘制几个东西。无论如何，在 Mayavi 中可以这样做吗？我想可视化计算的几个实现，并将它们全部放在同一个图表上。但是我无法通过阅读文档来弄清楚。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T08:43:27.507

如果您使用的是 mayavi 的 mlab 模块，它将默认保持。例子：

```
In [1]: from mayavi import mlab

In [2]: import numpy as np

In [3]: mlab.plot3d(np.random.rand(10), np.random.rand(10), np.random.rand(10))
Out[3]: <mayavi.modules.surface.Surface at 0x2a4eade0>

In [4]: mlab.plot3d(np.random.rand(10), np.random.rand(10), np.random.rand(10))
Out[4]: <mayavi.modules.surface.Surface at 0x28218ab0>

In [5]: mlab.plot3d(np.random.rand(10), np.random.rand(10), np.random.rand(10))
Out[5]: <mayavi.modules.surface.Surface at 0x2a51db40>

In [6]: mlab.plot3d(np.random.rand(10), np.random.rand(10), np.random.rand(10))
Out[6]: <mayavi.modules.surface.Surface at 0x2a840bd0> 
```

这三个地块将在同一个图中。

如果您创建一个新图形，新图形将添加到此新图形中。您还可以使用`figure`关键字参数直接将新图分配给给定图形。

# actionscript-3 - Flash - 将帧粘贴到某个位置

> ID：15178649
> 
> 赞同：0
> 
> 时间：2013-03-02T19:45:17.290
> 
> 标签：actionscript-3, flash

我有 101 层，我放入了一个我不想做的电影剪辑。我复制了所有 101 个图层并将它们粘贴到场景 1 中的另一个位置。我唯一的问题是，当我将图层粘贴到其中时，这些图层中的所有内容都位于 x-0 y-0，我希望它们位于 x- 350 y -550....我该怎么做？

在侧面，这些图层只是形状，因为我正在对它们进行手写效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T01:52:03.383

您正在寻找的是就地粘贴。它可以从编辑菜单中获得，或者我认为键盘快捷键是 Ctrl-Alt-Shift-V。

另一种方法是意识到您刚刚粘贴的所有内容仍将被选中，因此使用属性面板输入新的 X 和 Y 坐标。

# java - Eclipse：在你思考的时候运行测试

> ID：15178651
> 
> 赞同：3
> 
> 时间：2013-03-02T19:45:17.823
> 
> 标签：java, eclipse, eclipse-plugin, tdd

我读到了 Kent Benk的这条[推文](https://mobile.twitter.com/KentBeck/status/307271340891725825)：“不要等待。在你思考的时候运行测试。”

我正在寻找某种允许我在 Eclipse IDE 中执行此操作的插件。例如，如果我离开键盘或在浏览器中寻找文档，插件可以检测到我没有在 eclipse 上工作，并会自动启动我的测试。

有没有这样的工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:01:58.560

不完全是您所要求的，但每次相关文件更改时， [Infinitest都会运行测试。](http://infinitest.github.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:05:57.277

你可以试试[CT-Eclipse](http://ct-eclipse.tigris.org/)，一个 Eclipse 的持续测试插件。但同样只在文件被修改时运行，而不是基于用户空闲时间。

来自： [如何配置 Eclipse 以自动运行测试？](https://stackoverflow.com/questions/1247174/how-do-i-configure-eclipse-to-run-your-tests-automatically)

# java - 酒店使用数组

> ID：15178654
> 
> 赞同：0
> 
> 时间：2013-03-02T19:45:33.220
> 
> 标签：java, arrays

好的，基本上我正在创建一家提供以下选项的酒店

```
System.out.println("V: To View all rooms");
System.out.println("A: To Add customer to a room");
System.out.println("E: To Display empty rooms");
System.out.println("D: To Delete customer from a room");
System.out.println("F: Find room from customer name");
System.out.println("O: View rooms alphabetically by name"); 
```

*   现在，我可以进行查看、添加客户、显示空房间和删除”。
*   但是，我刚刚意识到我不能添加多个客户。该代码将简单地将具有相同名称的客户分配给所选的每个房间。

示例：如果我将名称 TOM 添加到房间 2，然后将 DENNIS 添加到房间 3。房间 2 和房间 3 表明它被丹尼斯占用。- 我知道为什么，因为 String 客户只能存储一个信息。

*我觉得我需要将客户更改为数组。*

**（请记住，我不想使用 ArrayList）。**

**SO：我的问题是，我该如何解决这个问题？因为我试图将 Customer 作为一个数组使用并且我破坏了整个编码（感谢本地历史还原！）**

代码：

```
package testroom;

import java.util.*;

public class TestRoom{

    public static void main(String[] args) {

        Scanner input = new Scanner(System.in);

        String Customer = null;
        int roomNum = 1;
        String Option;

        String[] hotel = new String[12];

        initialise(hotel); 

        while ( roomNum  < 11 )
        {

            System.out.println("Hotel Booking Options");
            System.out.println("V: To View all rooms");
            System.out.println("A: To Add customer to a room");
            System.out.println("E: To Display empty rooms");
            System.out.println("D: To Delete customer from a room");
            System.out.println("F: Find room from customer name");
            System.out.println("O: View rooms alphabetically by name");

            Option = input.next();

            if (Option.equals("V")){ //viewing all rooms
                view(hotel, Customer);  
            }

            if (Option.equals("A")){ // adding a customer to a room

                System.out.println("Enter room number(1-10)");
                roomNum =input.nextInt();
                System.out.println("Enter name for room " + roomNum + " : " ) ;
                Customer = input.next();
                hotel[roomNum] = Customer ;
                add(hotel, Customer);
                System.out.println(" ");

            }

            if (Option.equals("E")){ //view all empty rooms
                vacant(hotel, Customer); //links to private static void empty
            }

            if (Option.equals("D")){ //Deletes a customer from a room

                //Searches if room is occupied, if it is then it will delete customer from that room
                view(hotel, Customer);
                System.out.println("Enter the room which you want to delete a customer from: ");
                roomNum = input.nextInt();
                hotel[roomNum] = "empty";

                delete(hotel, Customer);
                System.out.println("");

            }

            if (Option.equals("F")){ //view all empty rooms
                find(hotel); //links to private static void empty
            }

        }
    }

    private static void initialise( String hotelRef[] )
    {
        for (int x = 1; x < 11; x++ )
            hotelRef[x] = "empty";
        System.out.println( "Welcome to The Plaza");
    }

    public static void view(String hotel[], String Customer){

        for (int x =1; x <11; x++)
        {
            int z=0;
            String Customername = Customer;
            hotel[z]= Customername;

            if (hotel[x].equals("empty"))
                System.out.println("room " + x + " is empty");
            else {
                System.out.println("room " + x + " is occupied by "+ hotel[z]);
            }
        }
    }

    private static void add(String hotel[], String Customer){
        for (int x =1; x <11; x++)
        {
            int z=0;
            String Customername = Customer;
            hotel[z]= Customername;
            if (hotel[x].equals("empty"))
                System.out.println("room " + x + " is empty");
            else {
                System.out.println("room " + x + " is occupied by "+ hotel[z]);
            }

        }
    }

    private static void vacant(String hotel[], String Customer){
        for (int x = 1; x < 11; x++ )
        {
            int z=0;
            String Customername = Customer;
            hotel[z]= Customername;
            if (hotel[x].equals("empty")) //if statement
                System.out.println("room " + x + " is empty"); 
        }

    }

    private static void delete(String hotel[], String Customer){ //link to this when pressed the D key
        //view (hotel);
        for (int x = 1; x < 11; x++ )
        {
            int z=0;
            String Customername = Customer;
            hotel[z]= Customername;
            if (hotel[x].equals("empty"))
            { 
                System.out.println("room " + x + " is empty");
            }
            else {
                System.out.println("room " + x + " occupied by " + hotel[x]);
            }
        }
    }

    private static void find(String hotel[]){

        Scanner input = new Scanner(System.in);   
        System.out.println("Enter customer name for room:" );
        String customersname;
        customersname = input.next();  //stores name they enter as customers name
        for (int x = 0; x < 10; x++ )
        {
            if (hotel[x].equals(customersname))
                System.out.println("room " + x + " is occupied                       by "+hotel[x]);

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:54:10.793

您的问题的原因是您没有为每个新条目实例化该类。我很抱歉，但这个问题有太多根本性的错误。您需要做的只是定义 Customer 类及其数据成员和数据访问函数，然后根据需要创建新对象并完全从另一个类填充/使用它们。

你可以尝试这样的事情：

```
import java.util.*;

class Customer
{
    private String name;
    private int room;

    public void setName(String name)
    {
        this.name=name;
    }

    public String getName()
    {
        return this.name;
    }

    public void setRoom(int room)
    {
        this.room=room;
    }

    public int getRoom()
    {
        return this.room;
    }
}

class Hotel
{
    public static void initialize(Customer RoomList[])
    {
        for(int i=0; i<RoomList.length; i++)
        {
            RoomList[i]=new Customer();
            RoomList[i].setName("EMPTY");
            RoomList[i].setRoom(i+1);
        }
    }

    public static void viewList(Customer RoomList[])
    {
        for(int i=0; i<RoomList.length; i++)
        {
            if(RoomList[i].getName()=="EMPTY")
                System.out.println("Room number "+RoomList[i].getRoom()+" is vacant.");
            else
                System.out.println("Room number "+RoomList[i].getRoom()+" is ocupied by "+RoomList[i].getName()+".");
        }
        System.out.println();
    }

    public static boolean addCustomer(Customer RoomList[], String name)
    {
        for(int i=0; i<RoomList.length; i++)
            if(RoomList[i].getName().equals("EMPTY"))
            {
                RoomList[i].setName(name);
                return true;
            }
        return false;
    }

    public static void showEmptyRooms(Customer RoomList[])
    {
        System.out.println("Available rooms are:");
        for(int i=0; i<RoomList.length; i++)
            if(RoomList[i].getName()=="EMPTY")
                System.out.println(RoomList[i].getRoom());
        System.out.println();
    }

    public static boolean deleteCustomer(Customer RoomList[], String name)
    {
        for(int i=0; i<RoomList.length; i++)
            if(RoomList[i].getName().equals(name))
            {
                RoomList[i].setName("EMPTY");
                System.out.println("Deletion successful.\n");
                return true;
            }
        return false;
    }

    public static int getIndex(Customer RoomList[], String name)
    {
        for(int i=0; i<RoomList.length; i++)
            if(RoomList[i].getName().equals(name))
                return i;
        return -1;
    }

    public static void main(String[] args)
    {
        Customer[] RoomList = new Customer[12];
        String name;
        initialize(RoomList);
        Scanner input = new Scanner(System.in);
        int option=0;

        do
        {
            System.out.println("        Hotel Booking Options");
            System.out.println("=====================================");
            System.out.println("1: To View all rooms");
            System.out.println("2: To Add customer to a room");
            System.out.println("3: To Display empty rooms");
            System.out.println("4: To Delete customer from a room");
            System.out.println("5: Find room from customer name");
            System.out.println("0: Exit");

            System.out.print("\nEnter your choice: ");
            option = input.nextInt();
            System.out.println();

            switch(option)
            {
                case 1:
                {
                    viewList(RoomList);
                    break;
                }
                case 2:
                {
                    System.out.print("Customer's name: ");
                    name=input.next();
                    System.out.println();
                    if(!addCustomer(RoomList, name))
                        System.out.println("No rooms available!");
                    break;
                }
                case 3:
                {
                    showEmptyRooms(RoomList);
                    break;
                }
                case 4:
                {
                    System.out.print("Customer's name: ");
                    name=input.next();
                    System.out.println();
                    deleteCustomer(RoomList, name);
                    break;
                }
                case 5:
                {
                    System.out.print("Customer's name: ");
                    name=input.next();
                    System.out.println();
                    System.out.println("Customer's room: "+RoomList[getIndex(RoomList, name)].getRoom()+"\n");
                    break;
                }
                case 0:
                {
                    System.out.println("\nThank you!\n");
                    break;
                }
                default:
                {
                    System.out.println("Invalid option!\n");
                    break;
                }
            }

        }while(option!=0);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-15T06:25:50.103

您的代码似乎有点不正确。查看添加客户代码。无论您在哪里添加客户，它也会添加到索引零。:)

```
 if (Option.equals("A")){ // adding a customer to a room
    System.out.println("Enter room number(1-10)");
    roomNum =input.nextInt();
    System.out.println("Enter name for room " + roomNum + " : " ) ;
    Customer = input.next();
    hotel[roomNum] = Customer ; // adds to the room number.
    add(hotel, Customer); // adds to the zero-th index.
    System.out.println(" ");
 }

private static void add(String hotel[], String Customer){
    for (int x =1; x <11; x++)
    {
        int z=0;
        String Customername = Customer;
        hotel[z]= Customername; // this line is the culprit.
        if (hotel[x].equals("empty"))
            System.out.println("room " + x + " is empty");
        else {
            System.out.println("room " + x + " is occupied by "+ hotel[z]);
        }

    }
} 
```

# security - 如何创建一种高效且安全的用户登录方式？

> ID：15178658
> 
> 赞同：0
> 
> 时间：2013-03-02T19:45:45.873
> 
> 标签：security, node.js, login, https, socket.io

**目前，我正在开发一个基于HTTPS** Node.js 服务器的基于 socket.io 的聊天。我已经成功完成了创建自签名证书以运行服务器的正确步骤。我想实现一个 CPU 和 RAM 高效的登录系统，最好不使用任何额外的 Node.js 模块。

目前，这就是我设置用户数据库的方式：

1.  在服务器启动时，服务器读取并字符串化包含用户数据的 JSON 文件，并将数组加载到内存中。数据库示例如下所示：`[{"user":"username", "pass":"password", "id":"23a45b"}]`
2.  当从登录表单向“/login.html”发送 HTTP POST 请求时，服务器会执行此 FOR 循环，其中`postdata`是 HTTP POST 并且`userdata`是用户数据库：

    ```
    for (var i = 0; i < userdata.length; i++) {
                if (postdata.user === userdata[i].user) {
                    if (userdata[i].pass === postdata.pass) {
                        res.writeHead({"Set-Cookie":"chat_user=" + userdata[i].user}, {"Set-Cookie":"chat_id=" + userdata[i].id});
                    }
                }
            }
    ```

3.  当用户想通过 socket.io 发送消息时，他们会连同他们的用户名和 ID 一起发送消息。另一个 FOR 循环将搜索用户数据库并交叉检查 ID 和用户名以确保它们匹配。*每次*发送消息时都会发生这种情况。

以下系统听起来是否高效且安全？我可以改进和改变什么？我担心的是，将*整个*用户数据库保存在内存中对于简单的服务器来说太多了，而且 CPU 可能会做更多有用的事情，然后每次发送消息时检查数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:28:00.430

我对您的代码的第一个担忧是它暗示密码以明文形式存储在您的 JSON 文件中。请不要这样做，这是一场等待发生的安全灾难。如果有人入侵了您的应用程序并获取了您的 JSON 文件，他们将拥有每个用户的登录名和密码，并且如果您还存储了用户的电子邮件地址（例如登录名），那么攻击者可以尝试破解用户的电子邮件帐户（因为很多人在任何地方都使用相同的密码）。

您应该以*摘要*形式存储密码，方法是在密码上应用 SHA-1 之类的加密哈希函数（添加盐！）。[在此处](https://stackoverflow.com/questions/1054022/best-way-to-store-password-in-database)或[此处](http://www.codinghorror.com/blog/2007/09/youre-probably-storing-passwords-incorrectly.html)阅读更多信息。

其次，要回答您关于效率的问题，为什么不使用真实的数据库而不是 JSON 文件呢？我了解您一开始可能有简单的需求，但从长远来看，您肯定会受益于拥有更强大的数据存储和检索方式。如果您需要添加新用户或删除用户，您的 JSON 文件会发生什么情况？您不需要停止服务器并重新加载数据吗？如果你真的想使用内存中的用户列表，你应该有一种更直接的方式来访问记录，而不是每次都循环整个集合。例如，您可以构建一个哈希表：

```
var usersHash = new Array();
for(var i = 0; i < userdata.length; i++) {
    usersHash[userdata[i].user] = i;
} 
```

这会在您的用户表上建立一个简单的索引，允许您直接访问记录，如下所示：

```
var user = userdata[usersHash[postdata.user]]; 
```

# asp.net-mvc-4 - 一次动态地将单个条目添加到 ICollection (MVC4 EF)

> ID：15178659
> 
> 赞同：0
> 
> 时间：2013-03-02T19:45:51.333
> 
> 标签：asp.net-mvc-4, model, persist, icollection

我很难解决这个问题：有没有办法将单个条目添加到 ICollection？一次一个，为每个添加的条目将数据持久化到数据库中？

**这是我的具体情况：**

我有一个测试模型：

```
public partial class Test
{
    public Test()
    {
        this.Students = new HashSet<Student>();
        this.Questions = new HashSet<Question>();
    }

    public int Id { get; set; }
    public string name { get; set; }
    public string description { get; set; }

    public virtual ICollection<Student> Students { get; set; }
    public virtual ICollection<Question> Questions { get; set; }
} 
```

测试包含一组问题。问题模型：

```
public partial class Question
{
    public Question()
    {
        this.Answers = new HashSet<Answer>();
    }

    public int Id { get; set; }
    public string query { get; set; }

    public virtual Test Test { get; set; }
    public virtual ICollection<Answer> Answers { get; set; }
} 
```

我的目标是让用户能够创建一个带有名称和描述的测试，然后动态地将问题添加到该测试中，直到他们满意为止。到目前为止，创建测试很容易，但是用问题加载测试对我来说是一个挑战。我曾设想过一种表单，可以将 Question 和 Test.Id 提交给控制器操作，控制器操作会将数据保存到数据库中。但我不明白如何将问题动态添加到测试的 ICollection 中。

有没有办法将单个条目添加到 ICollection？一次一个？

我做过的许多尝试之一

非常感谢您的帮助！

**回应levelnis：**我试过这个没有运气

```
 public void AddQuestionToTest(Test test, Question question)
    {
        question.Test = test;
        test.Questions.Add(question);
        Update(test);
        SaveChanges();
    } 
```

它不会向数据库添加任何问题。有任何想法吗？

**编辑：**我尝试过的唯一将问题输入数据库的代码是：

```
public void AddQuestionToTest(Test test, Question question)
{
    question.Test = test;
    Insert(question);
    SaveChanges();
} 
```

..但这会使数据库中的另一个测试具有相同的名称/描述，但新的 id 已增加。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:38:42.737

我可能在这里遗漏了一些东西，但这不起作用吗？

```
test.Questions.Add(new Question{ Id = 1, query = "set your question up here" }); 
```

然后，您需要通过 EF 更新和保存测试更改，以将其持久保存回数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T01:44:44.580

这似乎是一个简单的忽视，但这是我做错的事情：

我正在使用测试对象在数据库中创建一个新测试。然后我试图使用同一个对象来设置 Question.Test。当我将问题插入数据库时​​，这导致创建了一个新测试。

将新测试插入数据库后，我必须查询数据库以找到该测试，并将该测试分配给 Question.Test。

这似乎很奇怪，因为它与我坚持的测试相同，但我想在幕后发生了一些我不知道的事情。

感谢 levelins 的帮助。对此，我真的非常感激。

# iphone - iOS 设备上的核心日期获取请求

> ID：15178660
> 
> 赞同：0
> 
> 时间：2013-03-02T19:45:53.987
> 
> 标签：iphone, ios, database, xcode, core-data

我在 iOS 设备上从核心数据模型中获取对象时遇到问题。使用模拟器时，对象被成功获取，但是，在`NSMutableArray`我用来获取对象的设备上是空的。当我在其中获取对象时，`AppDelegate.m`它会正确返回对象，但是当我在视图控制器中获取它们时，会发生错误。我在互联网上搜索了很多，但找不到解决问题的方法。我在应用程序加载时获取对象，收到此错误意味着应用程序将永远无法工作。提前致谢。

PS：越狱的iPhone在测试时是否功能不正常？另请注意，我创建了另一个使用 Core Data 的应用程序并且它运行正常，我真的不知道这个有什么问题。

```
- (void)loadCategoriesFromDatabase{

categoriesInDatabase = [[NSMutableArray alloc] init];

NSFetchRequest *fetchRequest = [NSFetchRequest alloc];
NSEntityDescription *entityDescription = [NSEntityDescription entityForName:@"Category" inManagedObjectContext:managedObjectContext];

NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"display_order" ascending:YES];
NSArray *sortArray = [NSArray arrayWithObject:sortDescriptor];

[fetchRequest setSortDescriptors:sortArray];
[fetchRequest setEntity:entityDescription];

self.categoriesInDatabase = [[managedObjectContext executeFetchRequest:fetchRequest error:nil] mutableCopy]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T00:14:38.713

尝试将`NSError`指针传递给`executeFetchRequest`这样的

```
NSError* error = nil;
NSArray* categories = [managedObjectContext executeFetchRequest:fetchRequest
                                            error:&error];
if(error) {
    NSLog(@"%@", [error debugDescription]);
}
self.categoriesInDatabase = [categories mutableCopy]; 
```

并发布带有错误的日志。

# windows - WinRT 从视频中提取帧作为图像

> ID：15178661
> 
> 赞同：3
> 
> 时间：2013-03-02T19:45:59.433
> 
> 标签：windows, video, windows-runtime

我正在构建一个涉及一些视频处理的 Windows 8 应用程序。现在我坚持从 .mp4 视频剪辑中提取帧作为 BitmapImage。我一直在网上查看的两个示例是[here](http://software.intel.com/en-us/articles/windows-8-metro-style-app-development-using-winrt-from-c)和[here](http://social.msdn.microsoft.com/Forums/hi-IN/winappswithcsharp/thread/c7e716f7-9b1b-4562-912f-5fde0d97f9a3)，但是在尝试创建 BitmapDecoder 时出现异常。我已经粘贴了到目前为止的代码，但请注意，我不知道我在做什么。

```
 public async void Extract_Image_From_Video(StorageFile video_file)
    {

        // Create image
        BitmapImage image = new BitmapImage();

        // Open the video file as a stream
        IRandomAccessStream readStream = await video_file.OpenAsync(FileAccessMode.Read);

        // Breaks here 
        BitmapDecoder bmpDecoder = await BitmapDecoder.CreateAsync(readStream);

        BitmapFrame frame = await bmpDecoder.GetFrameAsync(0);

        BitmapTransform bmpTrans = new BitmapTransform();

        bmpTrans.InterpolationMode = BitmapInterpolationMode.Cubic;

        PixelDataProvider pixelDataProvider = await frame.GetPixelDataAsync(BitmapPixelFormat.Rgba8, BitmapAlphaMode.Ignore, bmpTrans, ExifOrientationMode.RespectExifOrientation, ColorManagementMode.ColorManageToSRgb);

        byte[] pixelData = pixelDataProvider.DetachPixelData();

        InMemoryRandomAccessStream ras = new InMemoryRandomAccessStream();

        BitmapEncoder enc = await BitmapEncoder.CreateAsync(BitmapEncoder.PngEncoderId, ras);
        // write the pixel data to our stream
        enc.SetPixelData(BitmapPixelFormat.Rgba8, BitmapAlphaMode.Ignore, 200, 200, bmpDecoder.DpiX, bmpDecoder.DpiY, pixelData);

        await enc.FlushAsync();

        // this is critical and below does not work without it!
        ras.Seek(0);

        // Set to the image
        image.SetSource(ras);

        // PreviewImage is an image control defined in the xaml
        PreviewImage.Source = gridImage;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-24T10:46:38.120

我为此创建了一个可供 ac# 应用程序使用的 c++ 项目。看看[这个](http://shivamcv.blogspot.in/)

# ios - [NSBundle allBundles] 中未出现单独的 CoreData 模型

> ID：15178664
> 
> 赞同：0
> 
> 时间：2013-03-02T19:46:25.277
> 
> 标签：ios, objective-c, core-data, restkit

我有一个完全重写以前版本的 iPhone 应用程序。但是当用户获得新版本时，会出现 Core Data 问题，因为某些实体名称相似。我根本不想使用旧的数据模型。

我查看了关于不合并数据模型的 SO 帖子，而是使用*initWithContentsOfUrl*。但是，所有示例都说首先获取*[NSBundle allBundles]*并遍历它以找到我想要的 DataModel。 [https://groups.google.com/d/msg/restkit/6_iu2mLOgTo/mjwz2fSmHG4J](https://groups.google.com/d/msg/restkit/6_iu2mLOgTo/mjwz2fSmHG4J)

[核心数据：错误，“无法将模型与名为 'foo' 的两个不同实体合并”](https://stackoverflow.com/questions/3205783/core-data-error-cant-merge-models-with-two-different-entities-named-foo)

```
// Look for our managed object model in all of the bundles. (From the app
  // it is in the main bundle but not for unit tests.)
  NSString *modelPath = nil;
  for (NSBundle* bundle in [NSBundle allBundles])
  {
    modelPath = [bundle pathForResource:@"MyDataModelFilename" ofType:@"momd"];
    if (modelPath)
      break;
  }
  NSAssert(modelPath != nil, @"Could not find managed object model.");
  NSManagedObjectModel* mom = [[NSManagedObjectModel alloc] 
                               initWithContentsOfURL:[NSURL fileURLWithPath:modelPath]];

  objectManager.objectStore = 
    [RKManagedObjectStore objectStoreWithStoreFilename:_databaseFilename 
                                 usingSeedDatabaseName:nil 
                                    managedObjectModel:mom 
                                              delegate:nil]; 
```

*但是，当我这样做时， allBundles*中只有一个对象，并且该 URL 是整个 .app 文件本身的 URL，而不是特定的“.xcdatamodeld”文件。

那么如何指向特定的“.xcdatamodeld”文件呢？我尝试对自己的 URLPath 进行硬编码，但分配的 MOM 始终为零 - 表明它在该 URL 处找不到模型。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-02T20:16:55.413

对于您的用户来说，这将是一个非常不愉快的体验。但是您可以使用与新模型不同的名称创建持久存储。

# javascript - 保存动态请求的数据客户端

> ID：15178665
> 
> 赞同：1
> 
> 时间：2013-03-02T19:46:25.267
> 
> 标签：javascript, ajax, html, save, client-side

我想从服务器`AJAX`请求`GET`一些数据。然后我想提示客户将此数据保存在他/她的计算机上，以便以后可以在浏览器会话之外访问它。这个保存功能是否可以通过 JavaScript 实现，或者我需要使用 Flash 库吗？我可以使用 URI 在本地执行此操作吗？我可以使用 HTML5 的本地存储吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:26:50.300

一旦数据在客户端，如果没有像 Flash 这样的插件，Javascript 就无法将其保存在本地。HTML5 有`download`解决这一切的属性，但支持很少^([2013-03-02])。

相反，您可以做的是在客户端构建数据，然后将数据保存在服务器上作为文件直接作为附件下载。您需要使用 HTTP 标头来`Content-Disposition`执行此操作。

这是 PHP 中的一个示例。

**演示：** [[[[![jsFiddle](../Images/827f57786617d886d70c0bce0ccca6b6.png)](http://jsfiddle.net/ThinkingStiff/hQYsN/)]]]

### 服务器：

```
<?php
header('Content-Type: text/plain');
header('Content-Disposition: attachment; filename=data');

echo $_POST['data'];?> 
```

### 客户：

```
<!-- language: lang-html -->

<form action="http://thinkingstiff.com/stackoverflow/download.php" method="POST">
    Data to save: <input name="data" type="text" />
    <button>download</button>
</form> 
```

# excel - Excel自定义十进制数字格式尾随点

> ID：15178668
> 
> 赞同：4
> 
> 时间：2013-03-02T19:46:31.033
> 
> 标签：excel, excel-2007, number-formatting

当我设置自定义数字格式`#0.####`时，它适用于整数`123`& `123.23`，但它不适用于十进制数`123.00`，因为它显示为`123.`

如何设置正确的数字格式以免`.`最后显示？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-03T00:03:40.003

我相信，在 Excel 2007 及更高版本中，您可以使用条件格式来执行此操作。`#0.####`使用您已经完成的自定义格式格式化单元格。如果单元格值没有小数部分，则添加自定义格式以使用常规格式。

在条件格式对话框中添加基于公式的格式。在“格式化此公式为真的值”框中输入：

```
=INT(A2)=A2 
```

在“设置单元格格式”对话框中，单击“数字”选项卡并选择`General`格式。

![在此处输入图像描述](../Images/34ed68f6eefff604af0608e2fa31c8ed.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:51:03.697

`#`是要显示的可选数字。`0`即使它为零，也会强制执行该数字。制作你的号码格式`#0.00##`。这将显示

*   123 为 123.00
*   123.00 为 123.00
*   123.000 为 123.00
*   123.001 为 123.001
*   123.001111 为 123.0011

# database - 用 DDBMS 理解“CAP”中的“P”

> ID：15178671
> 
> 赞同：3
> 
> 时间：2013-03-02T19:46:44.547
> 
> 标签：database, distributed-computing, database-partitioning, cap

在 CAP 定理中，“P”（分区）组件实质上表明系统运行良好，尽管存在物理网络分区。

我猜“C”（一致性）和“A”（可用性）在 DDBMS 上下文中对我来说非常有意义：为了保持一致性，所有客户端都必须拥有一致的数据视图，而不管它们所服务的 DB 节点如何。并且在可用性的情况下，所有客户端都必须能够从*某个*数据库节点获得响应以进行读/写（即，所有节点永远不会同时关闭）。

但出于某种原因，我对 CAP 的分区部分感到窒息，它的意义是什么，尤其是对于 DDBMS 而言。

使用分布式数据库，根据定义，您有多个（集群）节点。根据网络和系统架构、物理设备等，无论如何，在节点之间复制或通信（半连接等）时都会遇到性能问题。CAP 中的“P”也是一种提高 DDBMS 性能的方法。如果没有 P 保证，性能会受到阻碍吗？

此外，“P”与单个节点（非集群）数据库有何关系？我觉得在这种情况下它完全无关紧要。提前致谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-03T09:23:05.310

CAP 定理说，在分布式系统中，您不能在故障期间具有普遍的正确性、可用性和分区容错性。正确性意味着从任何节点读取的数据在任何其他节点都没有冲突的值。可用性意味着客户端可以使用所有健康的节点。分区容错意味着系统可以被分割成不能相互通信但仍能正常工作的子集。

假设你有 3 台机器。其中一个无法与其他人联系，或者换句话说，集群被分成 2 个分区。如果系统可以处理这种情况，那么它就是分区容错的。但是，您必须放弃完全正确性或完全可用性：

丢弃正确性：所有节点保持运行，但分离节点和剩余集群节点可能包含冲突数据，有时称为裂脑。

删除可用性：其中一个分区脱机。这可以保护数据完整性，因为任何成功的读取都不会在其他任何地方产生冲突的值。

从数据库系统的角度来看，这意味着您必须有不同的策略来处理故障。无法处理分区故障的数据库意味着如果任何节点出现故障，则行为未定义。在故障期间牺牲正确性的数据库将迫使应用程序在故障解决时处理一致性问题，但更多节点可以保持可用。放弃可用性的数据库将允许应用程序逻辑假定数据始终是一致的，但是在故障期间将无法访问一些其他健康的节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T23:10:15.380

我对 CAP 的理解是，您不能始终可靠地拥有所有三个理想的属性，并且必须选择您的优先级。我同意使用所使用的术语并不是最容易理解的，但是 Eric Brewer 本人的这篇文章很好地解释了它。[http://www.infoq.com/articles/cap-twelve-years-later-how-the-rules-have-changed](http://www.infoq.com/articles/cap-twelve-years-later-how-the-rules-have-changed)

要直接回答您的问题，如果您选择对数据进行分区，那么在某种程度上您将需要权衡一致性或可用性。如果您在 A 和 B 之间拆分数据，并且它们之间失去了连接，那么您要么阻止更新（-availibity），要么让它们独立更新（-consistency）

# variables - 使用带有 twig 过滤器的下划线变量

> ID：15178680
> 
> 赞同：0
> 
> 时间：2013-03-02T19:47:37.993
> 
> 标签：variables, backbone.js, filter, twig, underscore.js

如何在树枝过滤器中使用我的下划线变量，例如：

`{{ <%= tweet.created_at.date %> | translate_date }}`

错误抛出是：

`Unexpected token "operator" of value "<" in /Users/ .... .html.twig at line ...`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T09:41:45.800

认为你做不到，伙计；）你可以使用 moment.js 来“人性化”并翻译你的日期。（也是相对日期）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T13:24:44.843

从您的错误消息中，引发错误的是“<”字符，而不是下划线变量。有什么问题`{{ tweet.created_at.date | translate_date }}`？也许我错过了一些东西，“<%=”是什么意思？

# c# - C# wpf window this.Top在Win8上返回错误的位置？

> ID：15178682
> 
> 赞同：1
> 
> 时间：2013-03-02T19:47:49.080
> 
> 标签：c#, wpf, windows-8, screen-capture

我对此有点迷惑。我们有 ac#/WPF 屏幕捕获工具，它使用 Graphics.CopyFromScreen 抓取桌面的一部分。

它可以在几十种不同的机器上正常工作，包括 XP、Win7 和至少一个 Windows8 虚拟机。

我们遇到了一台装有 Win8 的 Acer ZS600，我们看到了一种我无法理解的奇怪效果。

当您捕获时，它会抓取正确大小但位置错误的图像。它向顶部和左侧偏移。不是固定数额。当捕获窗口位于屏幕 0,0 位置时很好，但是当您将捕获窗口从原点移开时，偏移量会增加。

我一直在查看代码，发现窗口位置（this.Top 和 this.Left）报告了错误的数字。

更奇怪的是，我们在 Acer Z5771 上进行了尝试，除了使用 Windows 7 外，它几乎与硬件设置相同。我们尝试更新 Zs600 图形驱动程序，但没有任何效果。

有没有人理解这一点，或建议修复或解决方法？

编辑：我整理了一个简单的应用程序，在问题机器上显示效果。在我的开发机器上它工作正常。在此处下载：[https ://s3-eu-west-1.amazonaws.com/kdownload/Tools/CaptureTool_app.zip](https://s3-eu-west-1.amazonaws.com/kdownload/Tools/CaptureTool_app.zip)

或下载编译版本：[https ://s3-eu-west-1.amazonaws.com/kdownload/Tools/capturetest.exe](https://s3-eu-west-1.amazonaws.com/kdownload/Tools/capturetest.exe)

编辑：这是问题系统上正在使用的捕获应用程序的两个屏幕截图。[https://s3-eu-west-1.amazonaws.com/kdownload/Tools/ProblemScreencap.png](https://s3-eu-west-1.amazonaws.com/kdownload/Tools/ProblemScreencap.png)（编辑 - 在那个屏幕截图中，我用宽度和高度切换了 x&y 的显示数字，现在已在上传的代码中修复，请忽略此)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T22:18:04.853

这可能是因为操作系统`Dpi`设置设置为 100% 以上。

您可以创建一个辅助方法来检查并根据当前操作系统 dpi 转换到正确的位置。

就像是。

```
public Point GetDpiSafeLocation(Point location)
{
    PresentationSource source = PresentationSource.FromVisual(Application.Current.MainWindow);
    if (source != null)
    {
        double dpiX = 96.0 * source.CompositionTarget.TransformToDevice.M11;
        double dpiY = 96.0 * source.CompositionTarget.TransformToDevice.M22;
        return new Point(location.X * 96.0 / dpiX, location.Y * 96.0 / dpiY);
    }
    return location;
} 
```

用法：

```
 var point = GetDpiSafeLocation(new Point(Left, Top)); 
```

# android - AndEngine Box2D 中的独特实体

> ID：15178684
> 
> 赞同：1
> 
> 时间：2013-03-02T19:47:56.693
> 
> 标签：android, box2d, andengine, sprite

我想创建一个用于精灵的独特物理体。这个精灵需要有两个部分，其中有一个碰撞表面和一个开放空间。

例子：

![精灵示例](../Images/51fe4ffb39f8067659401175a6f5f7b4.png)

在上面提供的示例中，精灵需要有一个物理 box2d 主体，其中两个绿色空间需要物理，而棕色中间需要是“空的”或没有物理属性。这是可能的还是我需要创建两个精灵？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T06:59:38.597

是的，有可能。您需要为每个绿色零件创建一个主体和两个夹具。

```
b2BodyDef myBodyDef;
myBodyDef.type = b2_dynamicBody;
b2Body* dynamicBody = m_world->CreateBody(&myBodyDef);

b2PolygonShape polygonShape;
b2FixtureDef myFixtureDef;
myFixtureDef.shape = &polygonShape;

// Left green rectangle
b2Vec2 vertices[4];
vertices[0].Set(0,  0);
vertices[1].Set(1,  0);
vertices[2].Set(1, 0.5);
vertices[3].Set(0,  0.5); 
polygonShape.Set(vertices, 4);
dynamicBody->CreateFixture(&myFixtureDef);

// Right green rectangle
b2Vec2 vertices[4];
vertices[0].Set(5,  0);
vertices[1].Set(6,  0);
vertices[2].Set(6, 0.5);
vertices[3].Set(5,  0.5); 
polygonShape.Set(vertices, 4);
dynamicBody->CreateFixture(&myFixtureDef); 
```

# html - MVC 4 - 根据所选下拉值的内容执行操作链接

> ID：15178685
> 
> 赞同：0
> 
> 时间：2013-03-02T19:48:26.513
> 
> 标签：html, asp.net-mvc-4

在我的一个观点中，我有一个下拉列表，如下所示：

```
<div id="CurrentExchange" style="position:absolute; right:150px; top:250px;">
    <h3>Select an Exchange</h3>
    <select>
        <option value="Bicycle" selected>Bicycle Exchange</option>
        <option value="Tennis">Tennis Exchange</option>
    </select>
</div> 
```

在同一视图的其他地方，我有一个操作链接，如下所示：

```
@Html.ActionLink("click here", "Index", "BicycleSellerListing") 
```

我想做什么，但不知道如何（我对 MVC 和 HTML 很陌生）是这样的，在伪代码中：

```
if CurrentExchange = "Bicycle"
    @Html.ActionLink("click here", "Index", "BicycleSellerListing")
else if CurrentExchange = "Tennis"
    @Html.ActionLink("click here", "Index", "TennisSellerListing")
else if ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:05:09.837

您可能需要使用一点 Javascript 来实现这一点。在您希望执行操作的链接上，您需要以下内容：

```
<a href="javascript:void(0);" onclick="NavigatePage();">click here</a> 
```

当然，有几种方法可以使用 Javascript 从“单击此处”按钮获取单击事件，但这是一个稍微不同的讨论。

从那里，在页面的某个地方，您将有一些 Javascript 将保存 NavigatePage 函数

```
<script type="text/javascript">
function NavigatePage() {
    var selectedValue = document.getElementById('CurrentExchange').value;
    if(selectedValue == "Bicycle")
        document.location = '@Url.Action("Index", "BicycleSellerListing")';
    else if(selectedValue == "Tennis")
        document.location = '@Url.Action("Index", "BicycleSellerListing")';
    else if // add as needed
}
</script> 
```

如果您愿意，您也可以对这些值进行硬编码，`document.location`而不是使用 UrlHelper。但它可能会给您将来使用 UrlHelper 留下的灵活性。

# jquery - 如何在 JQUERY SUCCESS 处理程序上引用数组 JSON/HTML 数据类型

> ID：15178688
> 
> 赞同：2
> 
> 时间：2013-03-02T19:48:51.503
> 
> 标签：jquery

我正在尝试通过 JQuery 更新多个项目，在跨标签的情况下。我确实设法使用 html dataType 更新了单个项目，但我一直无法找到引用项目数组的正确方法。

问题似乎出在下面的 setData 函数中。我试图将其作为普通数组引用，但这似乎不起作用。

这是jQuery：

```
<script>
$(document).ready(function () {
    $(".hook1").change(function () {
        pass_id = (this.value);
        var seltop = $(this).attr('id');
        var lastchar = seltop.slice(-1);
        $.ajax({
            type: "POST",
            url: "comp_data.php",
            dataType: "json",
            data: {
                passval: pass_id,
                pass2: lastchar
            },
            success: function setData(data) {
                $("#price" + lastchar).html(data[0].price);
                $("#matricule" + lastchar).html(data[1].matricule);
                $("#tag" + lastchar).html(data[2].tag);
                $("#ins_yr1" + lastchar).html(data[3].ins_yr1);
                $("#Totalacq" + lastchar).html(data[4].Totalacq);
            }

        });
    });
});
</script> 
```

这是 comp_data.php 文件的相关部分：

```
<?php
$version_id = $_REQUEST['passval'];
$i = $_REQUEST['pass2'];

mysql_query("CREATE OR REPLACE VIEW vcomp AS (SELECT......");

$return = array(
    "price" = > "",
    "matricule" = > "",
    "tag" = > "",
    "ins_yr1" = > "",
    "Totalacq" = > ""
);

$name = array_keys($return);
$ct = count($name);
$n = 0;
while ($n < $ct) {
    $key = $name[$n];
    $sql2 = mysql_query("SELECT *
    FROM vcomp
    ORDER BY segment_id,price
    ");
    while ($row = mysql_fetch_assoc($sql2)) {
        $return[$key] = $row[$key];
    }
    $n++;
}
$returnJSON = json_encode($return);
echo $returnJSON; 
```

$returnJSON 的最后一个回声给出

```
{"price":"1014000","matricule":"10000","tag":"6000","ins_yr1":"25350","Totalacq":"1055350"} 
```

这就是我想用 setData 函数输出的内容。
我很欣赏任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:59:55.557

我不了解 PHP，但根据我刚刚阅读的内容，您有一个“关联数组”。这[表示](http://php.net/manual/en/function.json-encode.php)关联数组被转换`json_encode()`为对象。所以你应该使用：

```
$("#price" + lastchar).html(data.price);
$("#matricule" + lastchar).html(data.matricule);
$("#tag" + lastchar).html(data.tag);
$("#ins_yr1" + lastchar).html(data.ins_yr1);
$("#Totalacq" + lastchar).html(data.Totalacq); 
```

# php - 发布表单后回显数据库变量

> ID：15178689
> 
> 赞同：0
> 
> 时间：2013-03-02T19:48:52.910
> 
> 标签：php, jquery

我在带有 jquery 选项卡的页面中使用表单，在所有选项卡上都有其他表单，所以我提交表单而不刷新页面，如下所示：

```
$(document).on("submit", "#advertentie_tab", function(event) {
/* stop form from submitting normally */    
    event.preventDefault();      
    $.ajax({
        type:"POST",
        url:"advertentie.php",
        cache: false,                   
        data: $("#advertentie_tab").serialize(),
        success:function(data){
            $("#innertab_advertentie").html(data);
        }       
    });
}); 
```

在我的表单中，我回显了数据库中的一些数据，但在发布后我丢失了这些数据。有没有办法在发布后保留数据而不设置大量隐藏输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:56:47.317

你说的问题有点尴尬。

您可以尝试将 postdata 数组写入该 advertentie.php 中的会话。但这很丑陋。

此外，请记住在从会话中检索此 postdata 后清理您的会话数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:53:18.313

我没有得到你真正的问题是什么，但我认为你总是可以用 jquery 获取你的表单数据，然后再将它们保存到变量中，因此你在 js 变量中丢失了数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T19:58:10.693

我一直在使用 ajaxForm 在不更改页面的情况下传递我的表单，我认为它可能会按照您想要的方式工作。

[http://malsup.com/jquery/form/](http://malsup.com/jquery/form/)

# php - 如何将查询字符串添加到寻呼机（codeigniter

> ID：15178691
> 
> 赞同：0
> 
> 时间：2013-03-02T19:49:05.980
> 
> 标签：php, codeigniter

例如，我有一个链接：

```
http://mysite.com/5 / 5 - is page number 
```

这一切都很好，但是如果我用分页激活了搜索过滤器怎么办：

```
http://mysite.com/5?filter=something 
```

所以问题是：如何将查询字符串添加到寻呼机链接，将寻呼机链接本身作为 uri 段，寻呼机链接是 uri 段而过滤器是查询字符串，这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T09:08:32.537

在 config.php 文件中有一段代码允许您启用查询字符串。它应该看起来像这样。

```
$config['allow_get_array']      = TRUE;
$config['enable_query_strings'] = FALSE;
$config['controller_trigger']   = 'c';
$config['function_trigger']     = 'm';
$config['directory_trigger']    = 'd'; // experimental not currently in use 
```

这些也适合你吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T10:13:52.057

我建议将搜索到的关键字添加到 a`cookie`或 a`session` 因为 codeigniter 分页使用 url 段，

using `http://mysite.com/5?filter=something`将破坏该段，因为 CI 会认为第二个参数将是限制，这将返回 false，因为您的第二个 uri 段是`5?filter=something`

我就是这样做的

```
public function search()
{
    //config pagination
    if($this->session->usedata('search_keyword') == false)//no search has been made
    {
        if($this->input->post('search_keyword'))
        {
            $data_to_query = $this->input->post('search_keyword');
            $this->session->set_userdata('search',$data_to_query);
            // query for database when search_keyword is entered
            $this->model->get($this->session->userdata('search')); // assuming this is your query model
        }else{
            // if session search_keyword is false then no 
            // search has been made do the normal query
        }
    }else{
        // if search_keyword session is true then a search has been made
        // use the data gathered on the session as a query parameter
    }
} 
```

# windows-phone-7 - 是否可以检索手机的颜色主题？

> ID：15178692
> 
> 赞同：1
> 
> 时间：2013-03-02T19:49:10.880
> 
> 标签：windows-phone-7, colors, resources, themes, appsettings

根据手机品牌，windows phone 用户可以选择更多或更少的二十种颜色。当他们这样做时，它会直接改变主要瓷砖的颜色。由于此设置必须存储在某个地方，我想知道我们是否可以访问它。

我想做的是一种将此首选项设置为我的应用程序资源的方法。这样，每当用户更改他的颜色主题时，下次他打开应用程序时，它将自动像他的手机一样着色。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:55:50.857

在后面的代码中：

```
PhoneApplicatonPage pap = new PhoneApplicationPage();
pap.Resources["PhoneForegroundColor"]).ToString(); 
```

在 XAML 中：

```
{StaticResource PhoneForegroundColor} 
```

# silverlight - Dynamics CRM 中 Silverlight 的替代方案

> ID：15178694
> 
> 赞同：2
> 
> 时间：2013-03-02T19:49:12.963
> 
> 标签：silverlight, dynamics-crm-2011

看起来微软正在逐步淘汰 silverlight ¹，有什么好的替代 silverlight 来构建功能丰富的 UI？我想可以滚动他自己的 HTML Web 资源和 javascript 并与 Xrm API 交互。

1：我在很多地方读到过，不会有 SilverLight 6，也没有未来的 SL 路线图。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T20:40:59.430

完全停止对 SilverLight 的支持还需要一段时间。但是，为了回答您的问题，我认为最合适的课程是开始关注自定义 Web 资源，以部署由 JavaScript 提供支持的 HTML5 组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T13:36:24.707

仔细选择您的选项。1\. Silverlight 支持不会很快结束，看看你正在构建的解决方案的路线图，还要考虑你是否会从头开始开发，或者你有可以重用的组件。

1.  Silverlight 正在下降，因为现在每个人都支持 HTML5/CSS3.0/JavaScript。这是您可用的最合乎逻辑的选择。

2.  在开发 HTML 5 组件时，请确保您以受支持的方式进行操作并注意代码中的跨浏览器兼容性，因为 Microsoft 正在发布 Dynamics CRM 的跨浏览器兼容版本，并且您不希望您的解决方案在发布后中断。

在线用户已经可以使用 iPad 支持。

# google-apps-script - 如何编辑 Google 演示文稿

> ID：15178695
> 
> 赞同：0
> 
> 时间：2013-03-02T19:49:20.817
> 
> 标签：google-apps-script

我一直想通过 ID 打开访问 Google 演示文稿的内容，但我没有成功，所以我想知道是否有人知道怎么做，请我非常感激，这是我的例子。

```
 var NombreDeUsuario = "MY_NAME";

//This ID is from a google presentation.
    var docid = DocsList.getFileById("1uF7xY9_QjSqFsILcq5IxGaJuzK6GlPLO-O4dWVG80cI").makeCopy().getId();

//here is where it says that it doesn´t found it
    var doc = DocumentApp.openById(docid).setName(NombreDeUsuario);
    var date = Utilities.formatDate(new Date(), "GMT", "yyyy-MM-dd");
    var rate = "Excelent";
    var body = doc.getActiveSection();

      body.replaceText("%DATE%", date);
      body.replaceText("%RATE%", rate);
      doc.saveAndClose(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:21:01.497

DocumentApp 仅用于打开 Google 文档。我认为没有办法使用 GAS 编辑演示文稿。[关于该主题有一个未解决的问题](https://code.google.com/p/google-apps-script-issues/issues/detail?id=1573)。

# javascript - Javascript 函数和默认参数，在 IE 和 Chrome 中不起作用

> ID：15178700
> 
> 赞同：108
> 
> 时间：2013-03-02T19:50:04.087
> 
> 标签：javascript, jquery

我创建了一个这样的函数：

```
function saveItem(andClose = false) {

} 
```

它在 Firefox 中运行良好

在 IE 中，它在控制台上给出了这个错误： `Expected ')'`

在 Chrome 中，它在控制台中给出了这个错误： `Uncaught SyntaxError: Unexpected token =`

两种浏览器都将错误的来源标记为函数创建行。

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2013-03-02T19:53:33.787

你不能这样做，但你可以这样做：

```
function saveItem(andClose) {
   if(andClose === undefined) {
      andClose = false;
   }
} 
```

这通常缩短为：

```
function setName(name) {
  name = name || 'Bob';
} 
```

***更新***

以上对于 ECMAScript <= 5 是正确的。ES6 提出了[Default parameters](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/default_parameters)。所以上面可以改为：

```
function setName(name = 'Bob') {} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-02T19:51:30.357

这不是有效的 ECMAScript 语法，但它是 Mozilla 添加到语言实现中的超集功能的有效语法。

默认参数分配语法*可能会*出现在 ECMAScript 6 中。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-03-02T19:55:30.353

Javascript 不允许使用“默认”说明符。

一种快速做你想做的事情的方法是改变：

```
function saveItem(andClose = false) {

} 
```

到以下：

```
function saveItem(andClose) {
    // this line will check if the argument is undefined, null, or false
    // if so set it to false, otherwise set it to it's original value
    var andClose = andClose || false;

    // now you can safely use andClose
    if (andClose) {
        // do something
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-27T14:18:30.090

您提供的代码不会在 Chrome < 版本 49 中运行： [https ://kangax.github.io/compat-table/es6/#test-default_function_parameters](https://kangax.github.io/compat-table/es6/#test-default_function_parameters)

您使用了有效的 ECMAScript 2015 语法：

*   [MDN：默认参数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters)。
*   [ES2015 规范：默认值参数初始化器](http://www.ecma-international.org/ecma-262/6.0/#sec-functiondeclarationinstantiation)

在我看来，使用 ES2015 功能的最佳方式是使用[Browserify](http://browserify.org/)或[WebPack](https://webpack.github.io/)捆绑资产，其中包含使用[Babel](https://babeljs.io)将 ES2015 反编译为 ES5 的步骤。这样你就不用担心那个 ES2015 浏览器兼容性图表了。第一次开始很痛苦，但值得。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-24T13:12:34.900

在您的情况下，您还有另一种选择来确保您的变量是布尔值：

```
function saveItem(andClose) {
  andClose = true == andClose;
  // ...
} 
```

默认值为`undefined`, 和`true == undefined`=> `false`，因此您的默认值为`false`:)

# c - 如何从 CodeWarrior 中的 C 文件调用汇编代码？

> ID：15178703
> 
> 赞同：1
> 
> 时间：2013-03-02T19:50:31.223
> 
> 标签：c, assembly, codewarrior, 68hc12

教授希望我们使用汇编代码编写程序的一部分，然后他希望我们从 C 程序中调用这段代码，然后在完成后跳回 C 程序。我似乎找不到任何关于此的文档。如果重要的话，我正在使用使用 68HC12 的 Dragon12 板。听起来他不希望我们使用内联 asm() 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:01:04.937

您可以像调用 C 中的任何普通函数一样调用汇编中定义的函数（只要您使用正确的调用约定），只需确保返回类型和参数匹配。例如，如果程序集如下所示：

```
my_func:
    ; assembly code here
    ; some more assembly code
    ; etc.
    xor ax, ax
    ret 
```

然后你可以从 C 中调用它，如下所示：

```
extern int my_func();

// ...
int zero = my_func(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-19T14:49:00.790

很久以前的问题，但答案可能仍然有帮助。

对于 Kinetis MCU 和 gcc，也许下面的代码片段可以说明一种可能性。（它是我的故障处理程序的一部分） 下面，“PE_ISR”中断使用内联汇编程序调用 FaultHandlerAsm 函数，该函数又是内联汇编程序。最后，它分支到一个 c 函数“faultHandlerC”，这里不包括。

```
void FaultHandlerAsm(void)
{
  __asm volatile (
    " movs r0,#4       \n"
    " movs r1, lr      \n"
    " tst r0, r1       \n"
    " beq _MSP         \n"
    " mrs r0, psp      \n"
    " b _HALT          \n"
  "_MSP:               \n"
    " mrs r0, msp      \n"
  "_HALT:              \n"
    " ldr r1,[r0,#20]  \n"
    " b FaultHandlerC  \n"
    //" bkpt #0          \n"
  );
}

PE_ISR(Cpu_INT_Hard_FaultInterrupt)
{
   __asm(    " b FaultHandlerAsm \n");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-08T02:24:16.217

CodeWarrior Development Studio 10.5 的帮助菜单文档描述了如何从 C/C++ 代码中调用纯汇编语言函数，如下所示：

程序集文件中定义的标签具有本地范围。要从其他文件（.c 文件）访问它们，应将它们标记为全局。例如，`.global _my_asm_func`。

为了说明，这里是一个示例代码片段：

```
.global _my_asm_func
.text

_my_asm_func:
    subq.l   #4,a7
    move.l   d1,(a7)
    add.l    (a7),d0
    addq.l   #4,a7
    rts 
```

在您的 C/C++ 代码中，首先声明函数的原型。例如，`int my_asm_func(int a, int b);`。然后像任何其他 C/C++ 函数一样调用该函数。例如，`my_asm_func(5, 2);`。

请注意，在汇编代码中，函数以下划线为前缀，但在 C/C++ 中则不然。我不确定这是否是必需的，或者只是约定。

参数被传递到顺序数据寄存器。在这种情况下，您会期望找到`5`in`D0`和`2`in `D1`。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-02T22:54:08.203

找出调用函数的正确方法的最简单方法就是用相同的参数在 C 中编写一个函数并返回，在内部做一些最小的工作（访问每个参数，填写结果值），然后编译到汇编程序。确定您感兴趣的每项操作是如何完成的，并且您已做好准备。

# python - 如何过滤对象以排除 id

> ID：15178705
> 
> 赞同：-1
> 
> 时间：2013-03-02T19:51:14.310
> 
> 标签：python, django

如何在查询中进行过滤，以便结果排除列表中的一个对象？当 id=1 模型 = AutoShow

看法：

```
class autoshow_index(ListView):
    context_object_name = "numcar"
    model = AutoShow

    def get_context_data(self, **kwargs):
        context = super(autoshow_index, self).get_context_data(**kwargs)
        context['bnrlarg'] = BannerLarge.objects.all()[:1]
        return context 
```

模板 ：

```
{% for autoshow in object_list %}    
    <h2><a href="/autoshow_page/{{autoshow.slug}}"> {{ autoshow.title }}</a></h2>
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:58:01.083

将其包含在您的`autoshow_index`课程中

```
def get_queryset(self):
    return AutoShow.objects.exclude(id=1) 
```

# ruby-on-rails - 如何解决：validates.rb:96:in `rescue in block in validates': Unknown validator (...)

> ID：15178713
> 
> 赞同：1
> 
> 时间：2013-03-02T19:51:52.800
> 
> 标签：ruby-on-rails, ruby, models, rails-models

我开始学习 Rails，但我无法继续前进，因为我在尝试运行时遇到错误：

```
bundle exec rspec spec/ 
```

我认为错误出现在我的“models/users.rb”文件中：

```
class User < ActiveRecord::Base
  attr_accessible :email, :name

  before_save { |user| user.email = email.downcase }

  validates :name, presence: true, length: { maximum: 50}
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence: true, format: {with: VALID_EMAIL_REGEX }, 
                                uniquiness: {  case_sensitive: false }
end 
```

在此之前，我做错了事：我应该在哪里输入

```
 uniquiness: { case_sensitive: false } 
```

我输入：

```
 uniquiness { case_sensitive: false } 
```

而且，在我看到这个错误之前，我对我的项目进行了一些更改（创建了迁移，运行本地服务器等）。我记得我执行了这些命令：

```
 bundle exec rake db:migrate
      bundle exec rake db:test:prepare
      bundle exec rspec /spec 
```

以下是我得到的错误：

> Rack::File headers 参数在 Rack 1.5 之后替换了 cache_control。/usr/lib/ruby/gems/1.9.1/gems/activemodel-3.2.12/lib/active_model/validations/validates.rb:96:in `rescue in block in validates'：未知验证器：'UniqunessValidator'（ArgumentError ) (...)

有人可以帮助我吗？谢谢大家:P

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T19:55:31.863

它的拼写`uniqueness`不是`uniquiness`。

# r - 如何循环使用变量中的重复值？

> ID：15178715
> 
> 赞同：0
> 
> 时间：2013-03-02T19:52:10.707
> 
> 标签：r, loops, for-loop, glm

我有一个名为的数据集`bjmd`，看起来像这样（简化）：

```
 rte   year   y  obs
22037 46001  1     0   1
22042 46001  2     4   3
22047 46001  3     5   3
22202 46002  1    11   1
22207 46002  2    14   1
22212 46002  3     6   1
22140 46003  1     5   6
22141 46003  2     2   6
22142 46003  3     6   6 
```

我想运行一个循环来`glm`对每个不同的`rte`（46001、46002、46003）进行分析。在每个`rte`中，有多个`year`s，它们都需要包含在`glm`分析中。从每条路线的`glm`测试中，我正在使用坡度并创建另一个表格，其中路线和坡度作为列。这就是我想要的样子：

```
rte    slope
46001   x
46002   y
46003   z 
```

这是我想出的for循环代码：

```
route<-with(bjmd,unique(rte))
slope<-with(bjmd,numeric(length(unique(rte))))
table<-data.frame(route,slope)
for (i in unique(as.factor(bjmd$rte))) {
  data<-subset(bjmd, rte=='i')
  slope[i] <- coef(summary(glm(y ~  year+obs,
                               family = poisson(link=log),data=data)))[2,1]
  table[i,2] <-paste(slope[i])
})
table 
```

这段代码有问题，因为我的斜率不断得到 0 值：

```
 route slope
1 46001     0
2 46002     0
3 46003     0 
```

有人可以帮忙指出我在哪里搞砸了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-06T15:48:39.760

不需要循环；只需`split`根据 . 将您的数据集分成组`rte`。然后用 为每个组拟合一个模型`lapply`。

```
lapply(split(bjmd, bjmd$rte), function(dat) glm(y ~ year + obs, data=dat)) 
```

您还可以使用交互项一次性对所有内容进行建模。预测值将相同，但残差偏差 df 以及因此的 P 值将不同。哪种方法更适合您的需求取决于您的项目。

```
glm(y ~ (year + obs) * factor(rte), data=bjmd) 
```

# android - 来自 ContactsContract 的电子邮件？

> ID：15178719
> 
> 赞同：-1
> 
> 时间：2013-03-02T19:52:42.040
> 
> 标签：android

我正在尝试从 det ContactsContract 获取电子邮件地址，就像我对 ID、NAME 和 NUMBER 所做的那样。但是为什么我不能以这种方式收到电子邮件？我怎么才能得到它？

```
int indexColumnId = cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone._ID);
int indexColumnName =  cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
int indexColumnNumber = cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.NUMBER);
int indexColumnAdress = cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.??????? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-20T18:07:35.703

如前所述，电子邮件地址位于另一个“包”中。您需要访问“ContactsContract.CommonDataKinds.Email”而不是“ContactsContract.CommonDataKinds.Phone”。

为此，您需要使用 ContactsContract.CommonDataKinds.Email.CONTENT_URI 作为 uri。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:54:58.397

ContactsContract.CommonDataKinds.Email.ADDRESS 是您需要的吗？

# debian - Debian 在 debian 挤压时不遵守 umask

> ID：15178725
> 
> 赞同：1
> 
> 时间：2013-03-02T19:53:02.767
> 
> 标签：debian, umask

我一直在这里阅读一堆关于 umask 和 debian 的服务器故障帖子，但我仍然不完全理解它发生了什么。

这是我的问题，告诉我我做错了什么：

我在我的机器上输入 umask：

```
aknapp@ftp2-atl:~$ umask
0002 
```

再次使用 -S：

```
aknapp@ftp2-atl:~$ umask -S
u=rwx,g=rwx,o=rx 
```

现在，如果我触摸一个文件，它对给定的 umask 没有正确的权限。怎么回事？

```
aknapp@ftp2-atl:~$ touch me
aknapp@ftp2-atl:~$ ls -l me
-rw-rw-r-- 1 aknapp aknapp 0 Mar  2 14:51 me 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:57:28.720

请参阅此处[http://www.cyberciti.biz/tips/understanding-linux-unix-umask-value-usage.html](http://www.cyberciti.biz/tips/understanding-linux-unix-umask-value-usage.html)。文件和目录的 Umask 计算方式不同

# c# - 通过 C# 设置 ItemPanelTemplate UniformGrid 的行

> ID：15178726
> 
> 赞同：0
> 
> 时间：2013-03-02T19:53:02.733
> 
> 标签：c#, wpf, dependency-properties, itemscontrol, uniformgrid

这是我所拥有的：

```
<ItemsControl x:Name="InfoGrid">
       <!-- ItemsPanelTemplate -->
       <ItemsControl.ItemsPanel>
               <ItemsPanelTemplate>
                     <UniformGrid Rows="4" Columns="5"                                                  Background="LightGray" />
               </ItemsPanelTemplate>
       </ItemsControl.ItemsPanel>
       <!-- ItemTemplate -->
       <ItemsControl.ItemTemplate>
              <DataTemplate>
                   <Border BorderBrush="Black" BorderThickness="{Binding Path=BorderThickness}">
                   <CheckBox Style="{StaticResource styleCustomCheckBox}" IsChecked="{Binding Path=IsChecked, Mode=TwoWay}"/>
                   </Border>
              </DataTemplate>
       </ItemsControl.ItemTemplate> 
```

InfoGrid 的 itemsource 在后面的代码中设置为一个名为 infoData 的集合，如何通过 C# 设置此 UniformGrid 的行/列（最好是 infoData 中不包含的变量）？

我尝试绑定和使用设置器，但这些值似乎没有得到应用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:08:47.683

您需要访问`ItemsPanel`后面的代码中的 ，以便在运行时设置列。有几个不同的选项，包括导航 VisualTree。 [该答案](https://stackoverflow.com/questions/7319952/how-to-get-listbox-itemspanel-in-code-behind)详细描述了选项和步骤。

# linux - QTableWidget 在删除多行时崩溃

> ID：15178730
> 
> 赞同：2
> 
> 时间：2013-03-02T19:53:08.867
> 
> 标签：linux, qt, qt4

我想从 QTableWidget 中删除多行（三列），这是我的代码：

```
void on_del_clicked()
{
    QList<QTableWidgetItem *> items = ui->tableWidget->selectedItems();
    for(int i = 0;i<items.length(); i=i+3)
    {
        int row = items[i]->row();
        if(row>=0)
        {
            ui->tableWidget->removeRow(row);
            ui->tableWidget->setCurrentIndex(ui->tableWidget->model()->index(row,0));
        }
    }
} 
```

如果我使用 Ctrl 选择多行，它工作正常，但如果我通过拖动鼠标选择多个条目，它会崩溃。仅当所选项目是 3 的倍数并且通过拖动鼠标选择行时才会崩溃。我使用 Qt 4.8.4，我的操作系统是 Ubuntu 12.10 64 位

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-03T19:47:06.960

血是对的：

> 也许是因为您在同一行中选择了多个项目，然后当您删除行并尝试访问该行中的下一个元素时。

因此，请改用此代码：

```
QList<QTableWidgetItem*> selected_rows = ui->tableWidget->selectedItems();
while( !selected_rows.isEmpty() )
{
    QTableWidgetItem *itm = selected_rows.at(0);
    ui->tableWidget->removeRow(itm->row());
    selected_rows = ui->tableWidget->selectedItems();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T18:45:32.740

只需在 debig 模式下运行，看看你的程序在哪里失败。例如，在您的循环之前，您可以检查是否`items`不是空列表，等等（您可以`qDebug() << list;`在循环之前进行）。

还有一个建议，最好使用`items.at(i)`insted of `items[i]`。

# java - 将一个数组值设置为另一个数组值

> ID：15178733
> 
> 赞同：0
> 
> 时间：2013-03-02T19:53:23.910
> 
> 标签：java, arrays

我有两个数组，我试图将数组值从一个复制到另一个，但不是全部。这是我拥有的代码。我收到一条错误消息`finalplace[y] = place[y];`。我有另一个名为 的数组`place`，它是更长的数组。我不想制作 place 数组的精确副本。我只想获取它们的位置小于的第一个数组值`count`。有任何想法吗？

```
int [] finalplace = new int [count];
for (int y = 0; y <= count; y = y + 1) {
    finalplace[y] = place[y];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:54:48.653

您的新数组的索引范围高达但不包括`count`. 所以你应该对你的`for`循环做同样的事情。

请注意，这[`System.arraycopy`](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#arraycopy%28java.lang.Object,%20int,%20java.lang.Object,%20int,%20int%29)将让您复制数组的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:57:02.847

使用实用程序类

```
java.util.Arrays 
```

有一堆复制方法。例如[copyOf](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#copyOf%28byte%5B%5D,%20int%29)或[copyOfRange](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#copyOfRange%28boolean%5B%5D,%20int,%20int%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T19:58:34.323

您可以尝试使用**[System.arraycopy()](http://www.javadb.com/how-to-copy-an-array)**

```
int[] a = new int[]{1,2,3,4,5};
int[] b = new int[5];

System.arraycopy( a, 0, b, 0, a.length ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T20:10:30.363

使用 Arrays.copyOf 方法而不是承担复制每个元素的负担。

# java - 使用正则表达式的名称过滤器 - Java

> ID：15178734
> 
> 赞同：1
> 
> 时间：2013-03-02T19:53:28.833
> 
> 标签：java, regex, filter

如果字符串包含字母（包括重音）、连字符、撇号和单个空格以外的字符，我将如何创建一个返回 false 的表达式？饶了我吧，“Влади́мир Пу́тин 和豊田章男呢？”。我意识到试图确定什么是名字什么不是名字是愚蠢的，但这仅用于教育目的。

另外，英文名称中还有其他常见的符号吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:11:56.367

你可以试试这个：

```
private static final Pattern namePattern =
    Pattern.compile("^[-' \\p{L}\\p{M}]+$");

public static boolean isValidName(String text) {
    return namePattern.matcher(text).matches()
        && text.indexOf("  ") < 0
        && !text.startsWith(" ") && !text.endsWith(" ");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:05:18.010

一个简单的谷歌搜索将为您提供带有过滤器的 java regex 表达式，如您所愿。但是，如果您的问题是要知道过滤器功能中应该包含哪些条件才能获得有效名称，那么这里有一个很好的讨论[，人们姓名的所有允许字符是什么？](https://stackoverflow.com/questions/421046/what-are-all-of-the-allowable-characters-for-peoples-names)

# python - Flask-SQLAlchemy - SQL 操作

> ID：15178737
> 
> 赞同：1
> 
> 时间：2013-03-02T19:53:38.840
> 
> 标签：python, sqlalchemy, flask, flask-sqlalchemy, flask-extensions

我将 Flask 与 Flask-SQLAlchemy 一起使用，对于 SQL 操作，我可以成功地将一条记录从

视图.py

```
from models import *
user= adduser('test')
db.session.add(user)
db.session.commit() 
```

模型.py

```
from flask_sqlalchemy import SQLAlchemy
from app import app
db = SQLAlchemy(app)

class adduser(db.Model):
__tablename__ = 'adduser'
id = db.Column('user_id', db.Integer, primary_key=True)
UserName = db.Column(db.String(16))

def __init__(self, UserName):
    self.UserName = UserName 
```

如何在单独的 Python 文件中执行相同的操作（假设我想在非 views.py 的文件中处理插入操作，例如 insertuser.py）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:19:53.933

将您的项目创建为带有`___init__.py`. 然后你只需要初始化“app”、“db”、变量一次就可以重复使用了。就像是：

```
myproject/
    __init__.py
    models.py
    views.py
    insertuser.py 
```

现在，在您的`__init__.py`文件中，放入初始化代码：

```
app = Flask(__name__)
db = SQLAlchemy(app) 
```

然后只需将这些导入到 insertuser.py 文件中：

```
from myproject import app, db
..insert code goes here... 
```

# html - 如何向从小屏幕设备访问网站的平板电脑用户显示滚动条？

> ID：15178744
> 
> 赞同：0
> 
> 时间：2013-03-02T19:54:23.303
> 
> 标签：html, css, scroll

我想在我的网站上做一个简单的事情，当有人在网站上浏览时，他们可以通过滚动来查看内容。

假设我有一个宽度为 100% 的滑块，那么他们可以通过滑块底部的滚动条看到图像的其他部分。左右内容相同。

有人知道应用这个的任何技巧吗？当我写宽度：100%；溢出：滚动当我从小屏幕尝试时，它没有向用户显示任何内容。

```
 <div class="slide-images">
                        <div class="slide-img">
                            <img src="assets/img/slide_plumb_01.png" alt="">
                        </div>
                        <div class="slide-img">
                            <img src="assets/img/slide_plumb_02.png" alt="">
                        </div>
                        <div class="slide-img">
                            <img src="assets/img/slide_plumb_03.png" alt="">
                        </div>
                    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:58:20.077

当您使用`width: 100%;`它时，它意味着它是`100%`视口，所以我想知道这对您来说是如何失败的，而不是`%`use `em`，如果您的页面超过视口的高度和宽度，默认情况下也可以使用滚动，除非您使用`overflow: hidden;`并且如果您想要不同屏幕和设备的样式使用 CSS3`@media queries`

句法

```
@media all and (max-width: 400px) and (min-width: 240px) { /* You can set the
                                                              resolutions here
                                                           */
  /* Styles goes here */
} 
```

这是一篇不错的文章，[可以开始](http://css-tricks.com/css-media-queries/)使用媒体查询

# c - TCP头端口号偶尔为0

> ID：15178746
> 
> 赞同：2
> 
> 时间：2013-03-02T19:54:24.730
> 
> 标签：c, tcp, header

我正在尝试编写一个简单的应用程序来输出 dst 和 src TCP 端口号。为了测试，我尝试应用 pcap 过滤器来仅嗅探进出端口 80 的数据包。但是，尽管一切看起来对我来说都是正确的，但我一直得到端口号 0。大约 10% 的时间我得到一个 5 位数的端口号。谁能给我任何提示我可能做错了什么？

```
#include<pcap.h>
#include<stdio.h>
#include<net/ethernet.h>
#include<netinet/ip.h>
#include<netinet/tcp.h>
#include<arpa/inet.h>

void handle_packet(u_char* args, const struct pcap_pkthdr* pkthdr, const u_char* p)
{
    struct iphdr* ip_hdr;
    struct tcphdr* tcp_hdr;

    ip_hdr = (struct iphdr*) (p+sizeof(struct ether_header));
    tcp_hdr = (struct tcphdr*) (ip_hdr+sizeof(struct iphdr));
    printf("src:%d\n", ntohs(tcp_hdr->source));
    printf("dst:%d\n", ntohs(tcp_hdr->dest));
}

int main(int argc, char** argv)
{
    pcap_t *handle;                /* Session handle */
    char *dev;                     /* The device to sniff on */
    char errbuf[PCAP_ERRBUF_SIZE]; /* Error string */
    struct bpf_program filter;     /* The compiled filter */
    char filter_app[] = "tcp port 80"; /* The filter expression */
    bpf_u_int32 mask;              /* Our netmask */
    bpf_u_int32 net;               /* Our IP */

    /* Define the device */
    dev = pcap_lookupdev(errbuf);

    /* Find the properties for the device */
    pcap_lookupnet(dev, &net, &mask, errbuf);

    /* Open the session in promiscuous mode */
    handle = pcap_open_live(dev, BUFSIZ, 0, 0, errbuf);

    /* Compile and apply the filter */
    pcap_compile(handle, &filter, filter_app, 0, net);
    pcap_setfilter(handle, &filter);

    pcap_loop(handle, 10, handle_packet, NULL);

    pcap_close(handle);
    return(0);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T20:15:52.593

这里有两个问题。一方面，请记住 C 中的指针算术是*scaled*。所以，当你说这样的话：

```
tcp_hdr = (struct tcphdr*) (ip_hdr+sizeof(struct iphdr)); 
```

实际上，您推进的字节数比您预期的要多得多（`sizeof(struct iphdr) * sizeof(struct iphdr)`准确地说）。为了实现你想要的，你可以说：

```
tcp_hdr = (struct tcphdr*) &ip_hdr[1]; 
```

但这也不起作用。IP 标头没有固定长度。相反，您应该检查标题的`ihl`字段，计算应该看起来更像这样：

```
tcp_hdr = (struct tcphdr*) ((char*)ip_hdr + 4*ip_hdr->ihl); /* ihl is the number of 32-bit words in the header */ 
```

警告：我不确定以太网帧以及它们的标头是否具有固定长度。您还需要验证这一点。

# windows-phone-8 - 适用于 Windows Phone 8 的任何图表

> ID：15178747
> 
> 赞同：6
> 
> 时间：2013-03-02T19:54:32.497
> 
> 标签：windows-phone-8

我需要为我的 Windows Phone 8 应用程序实现图表，我无法在 sdk 中找到图表控件，Windows Phone 8 中是否有免费的图表工具可用。-Mahens

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-20T08:10:02.700

以下库允许您在 Windows Phone 中轻松创建图表，而且它是免费的：

[https://github.com/ailon/amCharts-Quick-Charts](https://github.com/ailon/amCharts-Quick-Charts)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T17:04:27.140

我和你的情况类似；对 Windows Phone SDK 中没有这一功能感到惊讶。但是，我了解到它在 Silverlight v5.0 SDK 中可用：

如果您安装 Silverlight v5，则在类似于以下目录的目录中： **C:\Program Files\Microsoft SDKs\Silverlight\v5.0\Toolkit\dec11\Bin**

您应该能够找到可以添加到 WP7.1 / WP8 项目中的 dll： **System.Windows.Controls.DataVisualization.Toolkit.dll**

然后通过命名空间将一些有用的类从您引用的程序集中导入您的 XAML 标头

```
xmlns:visualizationToolkit="clr-namespace:System.Windows.Controls.DataVisualization;assembly=System.Windows.Controls.DataVisualization.Toolkit" 
xmlns:charting="clr-namespace:System.Windows.Controls.DataVisualization.Charting;assembly=System.Windows.Controls.DataVisualization.Toolkit" 
```

然后终于开始使用图表了！

```
<charting:Chart x:Name="MyChart" Title="My Chart">
</charting> 
```

# android - 在列表视图中显示图像而不是文本

> ID：15178748
> 
> 赞同：-1
> 
> 时间：2013-03-02T19:54:38.883
> 
> 标签：android, listview, youtube

大家好你们好。这是来自 youtube api 演示的代码。我只是想自定义列表视图，而不是显示要单击它的文本我想将其替换为列表视图中每个项目的特定图像（来自可绘制文件夹的图像）......为了澄清，出现“显示我的频道“......“我的播放列表1”......它应该出现一个图像

```
package com.examples.youtubeapidemo;

import com.google.android.youtube.player.YouTubeIntents;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListView;
import android.widget.TextView;

import com.examples.youtubeapidemo.adapter.DemoArrayAdapter;
import com.examples.youtubeapidemo.adapter.DemoListViewItem;

import java.util.ArrayList;
import java.util.List;

/**
* A sample activity which shows how to use the {@link YouTubeIntents} static methods     to create
* Intents that navigate the user to Activities within the main YouTube application.
*/
public final class IntentsDemoActivity extends Activity implements OnItemClickListener   {

 // This is the value of Intent.EXTRA_LOCAL_ONLY for API level 11 and above.
 private static final String EXTRA_LOCAL_ONLY = "android.intent.extra.LOCAL_ONLY";
 private static final String VIDEO_ID = "tKIISemrwJ8";
 private static final String PLAYLIST_ID = "PL75F25C99BA786497";
 private static final String PLAYLIST_ID2 = "PL75F25C99BA786497";
 private static final String USER_ID = "felipeneto";
 private static final int SELECT_VIDEO_REQUEST = 1000;

 private List<DemoListViewItem> intentItems;

 @Override
 public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.intents_demo);

intentItems = new ArrayList<DemoListViewItem>();
intentItems.add(new IntentItem("Show My Channel", IntentType.OPEN_USER));
intentItems.add(new IntentItem("My Playlist 1", IntentType.OPEN_PLAYLIST));
intentItems.add(new IntentItem("My Playlist 2", IntentType.OPEN_PLAYLIST2));
intentItems.add(new IntentItem("Featured", IntentType.PLAY_VIDEO));
intentItems.add(new IntentItem("Search", IntentType.OPEN_SEARCH));

ListView listView = (ListView) findViewById(R.id.intent_list);
DemoArrayAdapter adapter =
    new DemoArrayAdapter(this, R.layout.list_item, intentItems);
listView.setAdapter(adapter);
listView.setOnItemClickListener(this);

TextView youTubeVersionText = (TextView) findViewById(R.id.youtube_version_text);
String version = YouTubeIntents.getInstalledYouTubeVersionName(this);
if (version != null) {
  String text = String.format(getString(R.string.youtube_currently_installed), version);
  youTubeVersionText.setText(text);
} else {
  youTubeVersionText.setText(getString(R.string.youtube_not_installed));
}
 }

 public boolean isIntentTypeEnabled(IntentType type) {
  switch (type) {
  case PLAY_VIDEO:
    return YouTubeIntents.canResolvePlayVideoIntent(this);
  case OPEN_PLAYLIST:
    return YouTubeIntents.canResolveOpenPlaylistIntent(this);
  case OPEN_PLAYLIST2:
      return YouTubeIntents.canResolveOpenPlaylistIntent(this);
  case PLAY_PLAYLIST:
    return YouTubeIntents.canResolvePlayPlaylistIntent(this);
  case OPEN_SEARCH:
    return YouTubeIntents.canResolveSearchIntent(this);
  case OPEN_USER:
    return YouTubeIntents.canResolveUserIntent(this);

}

return false;
 }

  public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
  IntentItem clickedIntentItem = (IntentItem) intentItems.get(position);

Intent intent;
switch (clickedIntentItem.type) {
  case PLAY_VIDEO:
    intent = YouTubeIntents.createPlayVideoIntentWithOptions(this, VIDEO_ID, true, false);
    startActivity(intent);
    break;    
  case OPEN_PLAYLIST:
    intent = YouTubeIntents.createOpenPlaylistIntent(this, PLAYLIST_ID);
    startActivity(intent);
    break;
  case OPEN_PLAYLIST2:
      intent = YouTubeIntents.createOpenPlaylistIntent(this, PLAYLIST_ID2);
      startActivity(intent);
      break;
  case PLAY_PLAYLIST:
    intent = YouTubeIntents.createPlayPlaylistIntent(this, PLAYLIST_ID);
    startActivity(intent);
    break;
  case OPEN_SEARCH:
    intent = YouTubeIntents.createSearchIntent(this, USER_ID);
    startActivity(intent);
    break;
  case OPEN_USER:
    intent = YouTubeIntents.createUserIntent(this, USER_ID);
    startActivity(intent);
    break;

   }
   }

   @Override
 protected void onActivityResult(int requestCode, int resultCode, Intent returnedIntent) {
if (resultCode == RESULT_OK) {
  switch (requestCode) {
    case SELECT_VIDEO_REQUEST:
      Intent intent = YouTubeIntents.createUploadIntent(this, returnedIntent.getData());
      startActivity(intent);
      break;
  }
}
super.onActivityResult(requestCode, resultCode, returnedIntent);
   }

  private enum IntentType {
PLAY_VIDEO,
OPEN_PLAYLIST,
OPEN_PLAYLIST2,
PLAY_PLAYLIST,
OPEN_USER,
OPEN_SEARCH,

  }

  private final class IntentItem implements DemoListViewItem {

   public final String title;
    public final IntentType type;

   public IntentItem(String title, IntentType type) {
     this.title = title;
     this.type = type;
    }

    public String getTitle() {
    return title;
    }

   public boolean isEnabled() {
     return isIntentTypeEnabled(type);
   }

    public String getDisabledText() {
     return getString(R.string.intent_disabled);
    }

    }

   } 
```

我应该修改我的 DemoArrayAdapter.java。但是怎么办？？？？我是新手

```
 package com.examples.youtubeapidemo.adapter;

import android.content.Context;
import android.graphics.Color;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
 import android.widget.TextView;

import com.examples.youtubeapidemo.R;

import java.util.List;

/**
* A convenience class to make ListViews easier to use in the demo activities.
*/
public final class DemoArrayAdapter extends ArrayAdapter<DemoListViewItem> {

  private final LayoutInflater inflater;

  public DemoArrayAdapter(Context context, int textViewResourceId, List<DemoListViewItem> objects) {
    super(context, textViewResourceId, objects);
   inflater = (LayoutInflater)    context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
  }

  @Override
  public View getView(int position, View view, ViewGroup parent) {
   if (view == null) {
    view = inflater.inflate(R.layout.list_item, null);
    }

     TextView textView = (TextView) view.findViewById(R.id.list_item_text);
     textView.setText(getItem(position).getTitle());
     TextView disabledText = (TextView) view.findViewById(R.id.list_item_disabled_text);
    disabledText.setText(getItem(position).getDisabledText());

    if (isEnabled(position)) {
     disabledText.setVisibility(View.INVISIBLE);
     textView.setTextColor(Color.WHITE);
    } else {
     disabledText.setVisibility(View.VISIBLE);
     textView.setTextColor(Color.GRAY);
    }

    return view;
    }

   @Override
   public boolean areAllItemsEnabled() {
    // have to return true here otherwise disabled items won't show a divider in the list.
    return true;
   }

   @Override
  public boolean isEnabled(int position) {
   return getItem(position).isEnabled();
  }

   public boolean anyDisabled() {
    for (int i = 0; i < getCount(); i++) {
     if (!isEnabled(i)) {
       return true;
      }
   }
    return false;
  }

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:01:28.697

您应该覆盖 DemoArrayAdapter 中的 getView() 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:00:38.570

您可以更改一行的 R.layout.list_item 布局，在您需要的地方放置一个 imageview。要连续指定您需要的图像，您必须将其写入自定义 DemoArrayAdapter 的 getView() 函数中。

有关自定义列表视图的更多信息，这里有一个很好的教程： [http ://www.vogella.com/articles/AndroidListView/article.html](http://www.vogella.com/articles/AndroidListView/article.html)

# git - git 分支如何与 Heroku 一起工作？

> ID：15178751
> 
> 赞同：1
> 
> 时间：2013-03-02T19:54:50.307
> 
> 标签：git, heroku, branch

![----------](../Images/2c43a178c842633e0d4082485ab33516.png)

我为这个项目创建了两个本地 git 分支（主分支和旧分支）。我最近也向/从 Heroku 推/拉，我惊讶地发现两个与 Heroku 相关的分支（分支和主）。我还是 git 的新手……谁能根据上面的图片帮助我了解我的分支发生了什么？

我对名为“master”的本地分支感到满意，此时我可以消除所有其他分支。关于如何实现这一目标的任何提示？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:57:21.077

```
* branch     master    -> FETCH_HEAD 
```

此行表示您将本地 repo 的`master`分支与远程 repo`master`分支的更改同步。

您提到的 git branch 命令表示两个分支`master`和`old`. 并且您当前已经签出了在分支名称的开头`master`用 a 表示的分支。`*`

要删除名为的分支`old`，请使用以下命令：

```
git branch -D old 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:06:25.297

您可以使用它`git fetch`来更新您的远程分支。

之后用于`git branch -avv`查看存在哪些本地和远程分支。

检查`git config push.default`你的 git 是如何配置在`git push`. （取决于你的 git 版本，有不同的默认值。它可能默认推送*所有*本地分支。有关详细信息，请参阅 push.default `man git config`。）

您可以使用 删除本地分支`git branch -d old`。您可以使用 删除远程分支`git push --delete old; git fetch -p`。

# iphone - iPhone 应用程序从 Facebook 个人资料中检索照片

> ID：15178752
> 
> 赞同：1
> 
> 时间：2013-03-02T19:54:52.220
> 
> 标签：iphone, ios, facebook, web-services

我需要它从我的 Facebook 个人资料中提取照片。现在我正在研究我的应用程序的设计/架构。

我真正的问题是“从 Facebook 中提取个人资料图片的最佳方式是什么？”。让我们假设这个应用程序将被数百人或数千人使用。

让我自己的服务器从 Facebook 中提取图片然后我的服务器将更新发送到应用程序会更好吗？或者应用程序是否应该直接连接到 Facebook 以检索图片？

我真的不知道该怎么做。如果您是 iOS 专家并且知道如何执行此操作，请为我提供一些指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:05:37.100

这取决于您的应用程序的需求。

[使用facebook SDK](http://developers.facebook.com/ios/)直接从 facebook 拉取肯定更简单 - 除非您有特定要求，否则更简单总是更好。抵制过度建筑师的冲动。保持简单，直到您需要更多组件和系统。

例如，需要您拉取照片服务器端的一些要求是：

*   您希望您的应用程序的用户能够登录到您的应用程序并从您的网站查看他们的信息和图像。
*   您想对图像进行额外处理。
*   您希望您的应用程序中的用户能够向可能没有 facebook 帐户的其他人分发/共享/公开图像。
*   ETC...

但是再一次，如果您不需要服务器，那就不要。首先决定你想要的应用程序是什么，然后提出架构和子系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:03:45.523

最好和正确的方法是使用 facebookSDK [https://developers.facebook.com/ios/](https://developers.facebook.com/ios/)

有一个好主意并学习如何检查和阅读 SDK 附带的示例中的代码。

1.  设置一个 facebook 应用程序，确保告诉它是针对 ios 的，放置正确的包标识符并在权限中放置所有需要的选项

2.  用于登录和访问图片让 facebook 会话启动并运行

3.  提出请求

# numeric - 计算传播误差

> ID：15178764
> 
> 赞同：0
> 
> 时间：2013-03-02T19:56:10.347
> 
> 标签：numeric

当我对许多浮点数求和时，如何计算传播误差。例如，如果我求和 n 个浮点数，如何计算误差？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:59:32.143

一般来说，没有办法准确地确定误差（除了使用任意精度算术）。但是有一些技术可以显着减少错误，例如[*Kahan summation*](http://en.wikipedia.org/wiki/Kahan_summation_algorithm)。

# php - 处理 JSON 和 XML 数组

> ID：15178765
> 
> 赞同：0
> 
> 时间：2013-03-02T19:56:22.660
> 
> 标签：php, xml, arrays, json, api

基本上，我正在使用 2 个 API，我想在其中集成一个文件，其中一个 API 返回一个 JSON 数组。另一个返回 XML。

这是我想要做的想法

```
$arr = (array)file_get_contents(JSON API);
$arr2 = (array)simplexml_load_file("XML API");

$details['Details']['1'] = $arr['Details']['0'];
$details['Details']['2'] = $arr2['Details']['0'];

foreach($details['Details'] as $detail) {
 //do what i want with the array
} 
```

但是我怎样才能在这个 Array 中获取 JSON API？如果很难理解我在问什么，我很抱歉，但这是我能解释的最好的。

有没有办法将 JSON 转换为 XML 文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:57:29.113

您可以使用[`array_merge()`](http://us3.php.net/manual/en/function.array-merge.php)

```
 $details = array_merge($arr, $arr2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:09:23.050

有一种方法可以在[Link](https://stackoverflow.com/a/856887/1160115)处将 JSON 转换为 XML 文档。根据您的要求操作数据将对您有所帮助

# batch-file - 批量删除文件夹？

> ID：15178767
> 
> 赞同：0
> 
> 时间：2013-03-02T19:56:39.667
> 
> 标签：batch-file

我试图删除一个文件夹，所以我尝试了 'DEL "%Folder%"'。这留下了文件夹本身，并删除了文件夹中的所有文件。然后我输入 DEL /? 进入cmd提示符并阅读“如果指定了目录，则该目录中的所有文件都将被删除”。那么，我该怎么做才能删除文件夹本身呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:04:26.670

您可以尝试使用`RMDIR "%Folder%"`删除目录（`/s`如果需要，还可以使用子目录）。

[http://technet.microsoft.com/en-us/library/bb490990.aspx](http://technet.microsoft.com/en-us/library/bb490990.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T20:12:13.083

我建议使用 RD 或 RMDIR 命令。[这里](http://www.computerhope.com/rmdirhlp.htm)有更详细的使用说明。

句法：

> RMDIR [/S] [/Q] [驱动器:]路径
> 
> RD [/S] [/Q] [驱动器:]路径

# c# - 单例设计模式与静态类

> ID：15178769
> 
> 赞同：4
> 
> 时间：2013-03-02T19:56:41.033
> 
> 标签：c#, design-patterns

当单例设计模式优于静态类以及静态类优于单例设计模式时，会有哪些场景？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T20:25:53.223

这不是一个真正的非此即彼的场景。

单例是具有静态 getter 和私有构造函数的实例。它们不是静态类。

具有某些附加条件的单例是一种确保您只有一个类实例的方法。

所以第一个问题是。您是否需要一个实例，即这件事是否有状态，第二个问题是考虑到他们进行单元测试有多困难，您是否想要一个。

例如，看一下 Service Locator 模式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-02T20:50:15.023

通常单例优于静态类。

***单例与**静态类*相反：**

*   可以继承，也可以继承；
*   可以实现接口；
*   可以序列化；
*   可以传递给其他类；
*   可以处置。

如果您选择*静态类*，那么您选择**具体**，没有灵活性。但是，如果你使用*单例*，你必须记住让它的实例化是[线程安全](http://msdn.microsoft.com/en-us/library/ff650316.aspx)的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-02T20:00:20.807

如果您只使用类作为某些函数的容器，请使用静态类。但在大多数其他情况下，您最好使用单例设计模式，因为您可能希望重用该对象或实例化它作为一个非单例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-02T20:03:05.840

静态类是很难测试的专业。而且您不能将构造函数用于任何有用的事情。

在 MVC 助手等助手方法中，静态类是首选。

您可以[在这里](http://msdn.microsoft.com/en-us/library/79b3xss3%28v=vs.80%29.aspx)看到静态类的一些限制。它们只能有静态成员并且是密封的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-06T16:51:53.690

我从这个讨论中得到的最后一点： 1\. 一个对象有一些状态。状态表示对象属性的当前值。所以，如果你想有一个场景，你想要有一些可以改变的状态并且想要只有一个实例，那么使用 Singleton 类。例如，假设有一个日志文件要在某些操作成功或某些异常时更新。要更新此日志文件，我们必须对其进行锁定以避免任何不一致的数据，并且可以通过 Singleton 类来实现。2.当您不需要对象的状态并希望在应用程序启动时将您的类加载到内存中并保持在那里直到应用程序的生命周期 - 使用静态类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-02T20:12:17.547

您可以使用静态类为您提供不需要任何状态以及不需要实例化对象的简单方法。

使用单例意味着您只想将一个对象实例化一次，然后您可以传递它并更改其状态。使用单例，您还可以继承或实现接口。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-29T16:07:18.147

两者之间的主要区别在于单例可以实现接口，并且允许出于测试或运行时原因更改其行为。静态类是静态的，虽然它可以有状态，但要彻底改变它的行为是很困难的。

作为类的实例的单例可以实现接口，如果与期望该接口的方法一起使用，可以很容易地用不同的行为替换。

日志记录是两者的常见用法。

静态记录器不太可能记录到不同的介质（数据库、xlm 文件、文本文件、json、流、Web 服务），因为您要么必须为调用使用不同的 API，要么设置一些状态然后拥有所有这些方法中包含所有不同类型的持久性。

单例记录器可以实现 ILog，然后如果您需要从记录到数据库切换到记录到 Web 服务，您只需使用另一个类（可能是也可能不是单例）。

单例可用于缓慢地远离静态类。当你意识到你永远不会改变行为时，静态类可以替换单例。

两者都很难在自己身上进行测试。但是测试使用它们的其他类可能是个问题。特别是，一个静态类——在测试和生产时，在某些方面想要稍微不同的行为（比如日志记录，或者文件的源/目标是文件共享与共享点）并不是未知的。在这种情况下，让类成为单例可以更轻松地更改该行为。

# c# - 如何从表单中清除按钮控件

> ID：15178770
> 
> 赞同：0
> 
> 时间：2013-03-02T19:56:42.003
> 
> 标签：c#, winforms

我的表格是空白的，除了顶部的新游戏和退出菜单条。当表单加载时，它会填充一个按钮网格，其尺寸是从 App.config 文件中读取的。清除新游戏表单上所有按钮的最佳方法是什么？

```
this.Controls.Clear(); 
```

以上不起作用，因为它也删除了表单顶部的菜单条，它只让我从表单中调用它。我还有一个在程序的 Gameboard 类中运行的函数

```
 public void ClearButtons()
    {

        for (int q = 0; q < buttonArray.Length; q++)
        {
            buttonArray[q].Text = "";
            buttonArray[q].Enabled = true;
            buttonArray[q].BackColor = Color.LightGray;
        }
    } 
```

但是必须有更好的方法来做到这一点，如果我可以重新加载表单，它会用所需的按钮重新填充它，但我似乎无法弄清楚，尤其是从我的 Gameboard 类。谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:14:38.653

1）您可以使用以下代码代替清除所有按钮：

```
 public void ClearButtons()
  {
    for (int i = 0; i < this.Controls.Count; i++)
    {
       if (Controls[i] is Button)
       {
         Controls.RemoveAt(i);
         i--;
       }
    }
  } 
```

2) 如果您想从另一个类调用此代码，您必须将表单的实例传递给它，例如作为构造函数参数

3）创建`public void MyInits()`函数并从`Form1_Load`那里移动代码。然后只需调用它`Form1_Load`

4）编辑构造函数

```
public Gameboard(int numberofButtons, Form1 frm) 
```

然后通过`this`然后实例化它。比`frm.MyInits();`在构造函数中调用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:40:04.573

So this is my Gameboard constructor and Ill show you how the Form calls it to populate with buttons at the bottom.

```
public Gameboard(int numberofButtons) //Constructor method that is referencing the App.config for the dimensions value to make the board
    {
        if (numberofButtons <= 0) 
            throw new ArgumentOutOfRangeException("Invalid Grid"); //throws an exception for an invalid grid size if dimensions is equal to or less than zero

        buttonArray = new Button[numberofButtons]; //creating an array the size of numberofButtons which is the dimensions value from App.config
        Font font = new Font("Times New Roman", 36.0f); //creates an instance of the Font class
        int sqrtY = (int) Math.Sqrt(numberofButtons);
        int z = 0; //Counter for array

        //Create the buttons for the form
        //Adds the buttons to the form first with null values then changes the .Text to ""
        for (int x = 0; x < sqrtY; x++)
        {
            for (int y = 0; y < sqrtY; y++)
            {
                buttonArray[z] = new Button();
                buttonArray[z].Font = font;
                buttonArray[z].Size = new System.Drawing.Size(100, 100);
                buttonArray[z].Location = new System.Drawing.Point(100*y, 100*x);
                buttonArray[z].Click += new EventHandler(button_click);
                z++; 
            }
        }//At the end of this loop, buttonArray contains a number of buttons equal to Dimensions all of which have a .Text property of ""
    } 
```

So here is when the Form loads:

```
 private void Form1_Load(object sender, EventArgs e)
    {
        try
        {
            //Read the App.Config file to get the dimensions of the grid
            int dimensions = Convert.ToInt16(ConfigurationManager.AppSettings["dimensions"]);

            //Create the gameboard object with all the buttons needed
            Gameboard gb = new Gameboard(dimensions); //Calls the Gameboad constructor method

            //Add buttons to the form
            for (int x = 0; x < gb.buttonArray.Length; x++)
            {
                this.Controls.Add(gb.buttonArray[x]);
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.ToString());
        }
    } 
```

After I clear the buttons off the Form, what do I need to call to re-run the Form_Load so that it re-populates??

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:11:04.513

而不是使用 this.Controls.Clear

您可以通过 this.Controls 循环，并测试它是否是一个 Button，然后将其删除。

不过，更好的方法是创建一个容器、面板或类似的东西，并在其中创建您的按钮并使用

```
this.Controls.Remove(myPanel);
myPanel.Dispose(); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-08-08T11:10:52.877

```
int n = 0;
while (n < number)
{
    btnArray[n].Name = "" + (n + 1);
    tablePanel.Controls.Remove(btnArray[n]);
    n++;
} 
```

# .htaccess - index.php 处理的所有子域和 URL

> ID：15178788
> 
> 赞同：0
> 
> 时间：2013-03-02T19:58:10.367
> 
> 标签：.htaccess, rewrite

我正在尝试进行以下重写但没有成功。

无论输入什么 URL 或子域，都应始终由`index.php`.

可以说我去`example.domain.com`

URL 将保持不变，但内容来自 index.php

**URL 或子域是否实际存在并不重要。**

任何示例都相同：

```
other.domain.com/something 
```

应该对用户保持不变，但`index.php`应该显示什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:54:54.997

您可以在主域 ( ) 根目录的一个 .htaccess 文件中尝试此操作`site.com`：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_URI}  !index\.php    [NC]
RewriteRule .*              /index.php?    [L]

# If the above rule doesn't work as expected, use this rule instead:
# RewriteRule .*  http://site.com/index.php? [L] 
```

这应该适用于 public_html 文件夹中托管的通配符和插件子域。

规则集满足问题中的所有要求：

*   `"No matter what URL is entered or the sub-domain"` 将所有内容重定向到`http://site.com/index.php`

*   `"it should always be processed by index.php"`. 因此`index.php`必须存在于某个地方，并且对于这个答案，在`http://site.com`.

*   `"but index.php what is what should be showed"`. 相当混乱，但一个 OP 评论清楚地表明：将传入的 URL 保留在地址栏中。如果不是这种情况，请替换`[L]`为`[R=301,L]`

*   不要将任何内容传递给替换 URL 中的脚本 (index.php)，因为 OP 没有提及它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:07:17.587

您可以在 .htaccess 中使用以下行：

```
RewriteEngine on
RewriteRule ^([^/\.]+)/?$ index.php [L] 
```

# c# - 打开菜单栏时不会触发 MouseEnter 事件

> ID：15178792
> 
> 赞同：1
> 
> 时间：2013-03-02T19:58:23.313
> 
> 标签：c#, winforms, mouseenter, menustrip

我有一个包含多个项目的 menuStrip，以及表单其他部分的按钮。当鼠标进入按钮时，它会做一些事情（MouseEnter 事件）。我遇到的问题是，当打开菜单栏时，如果鼠标进入按钮，则不会触发 MouseEnter 事件。打开菜单栏时有什么方法可以触发吗？

要以图形方式查看这一点，这就是我正在做的事情：

![在此处输入图像描述](../Images/d59b0395c46f43d4ab7f7c26deb42950.png)

我有一个菜单条，每个父菜单项都有一个按钮。该按钮将在其上方，因此菜单条的唯一可见部分将是带有子项的容器。

现在，当鼠标进入按钮时，例如“系统”，它会在菜单项中执行单击。这就是容器出现的原因。但是一旦打开，如果我想打开其他父母的任何其他容器，我必须先点击才能失去焦点。然后，我想要实现的是无需单击即可执行此操作。

我想要的行为就像 menustrip 的行为。例如，如果系统打开，鼠标进入客户端，它会自动关闭系统并打开客户端。

![在此处输入图像描述](../Images/97ac70cc01ad6f63fcc2e7e7060d5920.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:14:14.550

让我们看看这是否是一个有效的答案：

```
#region IMessageFilter implementation
/// <summary> Redirect WM_MouseWheel messages to window under mouse.</summary>
    /// <remarks>Redirect WM_MouseWheel messages to window under mouse (rather than 
/// that with focus) with adjusted delta.
/// <see cref="http://www.flounder.com/virtual_screen_coordinates.htm"/>
/// Dont forget to add this to constructor:
///             Application.AddMessageFilter(this);
///</remarks>
    /// <param name="m">The Windows Message to filter and/or process.</param>
    /// <returns>Success (true) or failure (false) to OS.</returns>
    [System.Security.Permissions.PermissionSetAttribute(
        System.Security.Permissions.SecurityAction.Demand, Name="FullTrust")]
    bool IMessageFilter.PreFilterMessage(ref Message m) {
        // Determine window and control at these coordinates.
  //var pos   = WindowsMouseInput.GetPointLParam(m.LParam);
        var hWnd  = WindowFromPoint( WindowsMouseInput.GetPointLParam(m.LParam) );
        var ctl   = Control.FromHandle(hWnd);
  if (hWnd != IntPtr.Zero  &&  hWnd != m.HWnd  &&  ctl != null) {
    switch(m.Msg) {
      default:  return false;
      case (int)WM.MOUSEWHEEL:
        DebugTracing.Trace(TraceFlag.ScrollEvents, true," - {0}.WM.MouseWheel: {1}", 
                                                    Host.Name, ((WM)m.Msg).ToString()); 
        if (ctl is MapPanel) {
          var keyState    = WindowsMouseInput.GetKeyStateWParam(m.WParam);
          var mult            = keyState.HasFlag(MouseKeys.Control) ? 5 : 1;
          keyState            = keyState &= ~MouseKeys.Control;
          var wheelDelta    = WindowsMouseInput.WheelDelta(m.WParam);
          // forward delta of +/- 30 instead of +/- 120; 30/120 == 1/4
          var newWparam   = WindowsMouseInput.WParam((Int16)(mult*wheelDelta/4), keyState);
          SendMessage(hWnd, m.Msg, newWparam, m.LParam);
          return true;
        } else if (ctl is MapFormOverview) {
          var keyState    = WindowsMouseInput.GetKeyStateWParam(m.WParam);
          var wheelDelta    =  WindowsMouseInput.WheelDelta(m.WParam);
          // forward delta of +/- 54 instead of +/- 120
          // 54 = 3 * 18 (default point height in pixels?); 54/120 == 9/20
          var newWparam   = WindowsMouseInput.WParam((Int16)(wheelDelta*9/20), keyState);
          SendMessage(hWnd, m.Msg, newWparam, m.LParam);
          return true;
        }
        break;
    }
  }
  return false;
    }
#region Extern declarations
/// <summary>P/Invoke declaration for user32.dll.WindowFromPoint</summary>
    /// <remarks><see cref="http://msdn.microsoft.com/en-us/library/windows/desktop/ms633558(v=vs.85).aspx"/></remarks>
    /// <param name="pt">(Sign-extended) screen coordinates as a Point structure.</param>
    /// <returns>Window handle (hWnd).</returns>
    [DllImport("user32.dll")]
    private static extern IntPtr WindowFromPoint(Point pt);
    /// <summary>P/Invoke declaration for user32.dll.SendMessage</summary>
    /// <param name="hWnd">Window handle</param>
    /// <param name="msg">Windows message</param>
    /// <param name="wp">WParam</param>
    /// <param name="lp">LParam</param>
    /// <returns></returns>
    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    private static extern IntPtr SendMessage(IntPtr hWnd, int Msg, IntPtr wParam, IntPtr lParam);
#endregion
#endregion 
```

# objective-c - Admob 使用 Storyboard - UIView 可能不响应 viewDidLoad

> ID：15178794
> 
> 赞同：0
> 
> 时间：2013-03-02T19:58:37.213
> 
> 标签：objective-c

我已经搜索和更改代码 2 天了。我正在使用 xcode 4.5 和故事板。我让 admob 在我的主视图上工作，但我已经添加了 50 多个其他视图，并且收到了一些警告并且广告不会显示。

```
//  ViewMain2.h

#import <UIKit/UIKit.h>
#import "GADBannerView.h"

@class GADBannerView, GADRequest;
@interface ViewMain2 : UIView 
<GADBannerViewDelegate> {
    GADBannerView *adBanner_;
}

@property (nonatomic, retain) GADBannerView *adBanner;

- (GADRequest *)createRequest;
- (UIView *)view;

@end

//////////  ViewMain2.m

#import "ViewMain2.h"
#import "GADBannerView.h"
#import "GADRequest.h"

@implementation ViewMain2

@synthesize adBanner = adBanner_;

- (UIView *)view {
    return (UIView *)self.view;
}

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
    }
    return self;
}

#pragma mark init/dealloc

// Implement viewDidLoad to do additional setup after loading the view,
// typically from a nib.
- (void)viewDidLoad {
    [super viewDidLoad];

    // Initialize the banner at the bottom of the screen.
    CGPoint origin = CGPointMake(0.0,
                                 self.view.frame.size.height -
                                 CGSizeFromGADAdSize(kGADAdSizeBanner).height);

    // Use predefined GADAdSize constants to define the GADBannerView.
    self.adBanner = [[[GADBannerView alloc] initWithAdSize:kGADAdSizeBanner
                                                    origin:origin]
                     autorelease];

    // Note: Edit SampleConstants.h to provide a definition for kSampleAdUnitID
    // before compiling.
    self.adBanner.adUnitID = @"a1512d23a796691";
    self.adBanner.delegate = self;
    [self.adBanner setRootViewController:self];
    [self.view addSubview:self.adBanner];
    self.adBanner.center =
    CGPointMake(self.window.center.x, self.adBanner.center.y);
    [self.adBanner loadRequest:[self createRequest]];
}

- (void)dealloc {
    adBanner_.delegate = nil;
    [adBanner_ release];
    [super dealloc];
}

- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskPortrait;
}

#pragma mark GADRequest generation

// Here we're creating a simple GADRequest and whitelisting the application
// for test ads. You should request test ads during development to avoid
// generating invalid impressions and clicks.
- (GADRequest *)createRequest {
    GADRequest *request = [GADRequest request];

    // Make the request for a test ad. Put in an identifier for the simulator as
    // well as any devices you want to receive test ads.
    request.testDevices =
    [NSArray arrayWithObjects:
     // TODO: Add your device/simulator test identifiers here. They are
     // printed to the console when the app is launched.
     nil];
    return request;
}

#pragma mark GADBannerViewDelegate impl

// We've received an ad successfully.
- (void)adViewDidReceiveAd:(GADBannerView *)adView {
    NSLog(@"Received ad successfully");
}

- (void)adView:(GADBannerView *)view
didFailToReceiveAdWithError:(GADRequestError *)error {
    NSLog(@"Failed to receive ad with error: %@", [error localizedFailureReason]);
}

@end 
```

我在行 -> [super viewDidLoad] 上收到警告“UIView 可能无法响应 viewDidLoad”；

我还收到一条警告“不兼容的指针类型将 ViewMain2 发送到 UIViewController 类型的参数” -> [self.adBanner setRootViewController:self];

我已经尝试了很多教程和搜索，但是故事板中的所有视图都名为 UIView，我很挣扎。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:13:19.457

你声明你的类是一个子类`UIView`：

```
@interface ViewMain2 : UIView 
```

但是，您正试图将其用作`UIViewController`. 决定你想要哪一个 - 如果是视图控制器，则将超类更改为`UIViewController`，如果是视图，则不要尝试将其用作视图控制器。

# php - 正确使用工厂方法/模式和动态加载

> ID：15178795
> 
> 赞同：0
> 
> 时间：2013-03-02T19:58:38.807
> 
> 标签：php, oop, design-patterns

我创建了一个库来解析不同类型的数据。这就是图书馆的使用方式。

```
$parser = DataParser::factory($text);
$data = $parser->parse();
foreach($data as $name=>$datum)
    echo "name: $name\nData: ".$datum."\n"; 
```

这`$data`是一个实例`NamedDataCollection`。这是类定义

```
interface Parsable{
    // @returns NamedDataCollection
    function parse();
    // @returns bool. True if it can parse the data.
    function can_parse();
}

class AParser implements Parsable{
    public function parse(){
       $this->check_header();
       $this->check_content();
       $this->parse_content();
       ...
    }
    public function can_parse(){
       $this->check_header();
       $this->check_content();
       ...
    }
}

class BParser implements Parsable{
    public function parse(){
       ...
    }
    public function can_parse(){
       ...
    }
}

class ParserRegistry{
    // @param $dir path where all the parsers are stored
    public function __construct($dir){
    }
    // @returns all the available parsers by scanning files. 
    public function get(){
    }
}

class DataParser{
    public function factory($data){
       $instance = null;
       $pr= new ParserRegistry("/some/path");
       foreach($pr->get() as $pname){
           $rc = new ReflectionClass($pname);
           $instance = $rc->newInstance($data);
           if($instance->can_parse())
               return $instance;
       }
       throw new ParserException("No parser found", 1);
    }
} 
```

是正确的工厂方法使用吗？

困扰我的一件事是`can_parse`方法。**似乎创建了很多解析器实例只是为了测试它是否可以解析文本**。有没有更好的方法呢？我知道我可以使用静态方法。但是大多数解析器使用方法的某些部分`parse`（见`AParser`定义）。如果我将其设为静态，则无法使用这些方法。

注意：示例代码代表我遵循的模式。但是类名和场景只是示例。为示例提供现成的解决方案并不能解决我的实际问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T10:58:39.700

当您编写自己不想实例化（加载定义）所有解析器类只是为了找出要采用哪个解析器类时，您需要更改您的设计。

首先，我强烈建议你让你的解析器只做解析——而不是解析和感知数据。一件物品，一份工作。把事情简单化。

数据类型嗅探（说明使用哪个解析器）实际上是在工厂内进行的。对于工厂方法来说，这可能有点多。即使它需要决定实例化哪个具体的类名，也不意味着它需要为此封装整个逻辑。此外，这很可能会随着时间的推移而改变，因为您将随着时间的推移添加解析器。

因此下一个改进可能是有一个工厂方法对象而不是工厂方法。也就是说，您实例化工厂，它允许您随着时间的推移用新的工厂类型替换它。

你应该能够一步一步地做到这一点。

1.  从接口中删除`can_parse`方法。如果解析器想在内部使用它，请将其设为私有。但它不属于任何具体的接口（作为抽象强制执行）`Parser`。
2.  制作`DataParser`和实际`ParserFactory`对象。实例化它并将它传递到需要它的地方。`factory`将方法重命名为，`makeParser`以便更清楚地知道发生了什么。
3.  将该工厂对象转换为接口并将类重命名为实现该接口的具体名称。

`ParserFactory::makeParser`随着时间的推移，您现在可以根据需要重新实现该方法。如果需要，只需创建一个新的工厂对象。如果这种情况经常发生变化，您可能也希望将决定注入工厂，但我会推迟该步骤。您现在所做的可能只是最好的方法，我首先只会将其移出解析器。例如，针对潜在类列表进行测试，并捕获任何`ParseExceptions`表明解析器无法（成功）解析数据的信号。保持您的软件正常工作，只需将它们彼此分开一点即可。之后，您可以创建第二个以不同方式做事的工厂对象，您需要做的就是更改对象，应用程序的其余部分（阅读：所有现有解析器）可以保留并且因此不需要任何更改。

这应该会给您留下您需要进行试验的所有自由，这是决定如何实例化（制作）具体解析器的最佳方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T22:18:09.503

一般来说，它看起来是正确的。工厂根据输入生成对象。我不确定 can_parse()。我认为应该由工厂做出决定，而不是将其委托给特定对象。

看看这里[http://sourcemaking.com/design_patterns/factory_method](http://sourcemaking.com/design_patterns/factory_method)

# ruby - Git：无法运行 git 'rm -rf 。--缓存'

> ID：15178799
> 
> 赞同：2
> 
> 时间：2013-03-02T19:58:50.133
> 
> 标签：ruby, git, git-rm

我正在使用 Rubygems，它在 git 中缓存了很多文件。简单的解决方案就是运行`git rm -rf . --cached`，但是当我运行它时，会出现以下消息：

```
fatal: pathspec '' did not match any files 
```

即使我运行`git rm -rf ./\* --cached`，它仍然返回：

```
fatal: pathspec '*' did not match any files 
```

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T20:38:57.490

The correct syntax would be:

```
git rm -r -f --cached -- . 
```

(ie the path should be at the end)

But if `git status` mentions that no files have been added, then nothing 'cached' would be there to be removed.

> When `--cached` is given, the staged content has to match:
> 
> *   either the tip of the branch
> *   or the file on disk,
> 
> allowing the file to be removed from just the index.

# c - 顺序服务器：accept(2) 调用的行为

> ID：15178800
> 
> 赞同：0
> 
> 时间：2013-03-02T19:58:59.283
> 
> 标签：c, sockets, unix

我在非并发单进程实现中有一个带有 TCP 套接字的服务器。

```
int main(int argc, char** argv) {

    int sock_ds, acc_sock_ds, opt, client_addr_l;
    unsigned short port;
    struct sockaddr_in server_addr, client_addr;

    /*Parsing command line: port-number retrieving*/
    /*...*/

    printf("Port number retrieved (%d), server is starting ...\n", port);

    /*TCP Socket creation*/
    sock_ds = socket(AF_INET, SOCK_STREAM, 0); 
    if(sock_ds == -1){
        fprintf(stderr, "Socket creation error\n");
        exit(EXIT_FAILURE);
    }

    /*Server address binding*/
    memset(&server_addr, 0, sizeof(server_addr));
    server_addr.sin_family = AF_INET;
    server_addr.sin_port = htons(port);
    server_addr.sin_addr.s_addr = INADDR_ANY;
    //use setsockopt(2) with OS_REUSEADR ???
    if(bind(sock_ds, (struct sockaddr*)&server_addr, sizeof(server_addr)) == -1){
        fprintf(stderr, "Address binding error\n");
        exit(EXIT_FAILURE);
    }

    /*Server with passive socket*/
    if(listen(sock_ds, SOMAXCONN) == -1){
        fprintf(stderr, "Listen call error: %s\n", strerror(errno));
        exit(EXIT_FAILURE);
    }

    printf("Server is ready. Waiting for connections.\n");

        /*Busy-waiting server*/
while(1){

    memset(&client_addr, 0, sizeof(client_addr));
    acc_sock_ds = accept(sock_ds, &client_addr, &client_addr_l);
    /*Connect error management*/
    if(acc_sock_ds == -1){
         errsv = errno;
         if(errsv == 12 || errsv == 23 ){
            /*Fatal errors ENOMEM, ENFILE*/
            fprintf(stderr, "Fatal error on accept\n");
            exit(EXIT_FAILURE);
         }
         else if(errsv == 103 || errsv == 4 || errsv == 71 || errsv == 92 
                 || errsv == 112 || errsv == 113 || errsv == 95 || errsv == 101)
             /*ECONNABORTED, EINTR, EPROTO, ENOPROTOOPT, 
              * EHOSTDOWN, EHOSTUNREACH, EOPNOTSUPP, ENETUNREACH*/
             continue;
         else if(errsv == 100 || errsv == 64){
             /* ENETDOWN - ENONET */
             /*start timeout...*/
             continue;
         }
    }
  }
} 
```

在这个测试中，我预计服务器也会`accept(2)`在失败时继续进行调用。我知道有一些终端错误情况，例如`EBADF`. 我是否应该根据 的值提供不同的行为（过程终止）`errno`？对于哪些值，服务器必须停止，哪些可以继续等待？

代码已编辑。我从来没有通过errno进行错误处理。如果有错误或建议，请通知他们。我注意到这两个条件`ENETDOWN`-`ENONET`是由缺乏网络暗示的。对于这些情况，我是否应该期望超时以防止停滞？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:29:43.273

查看 MacOS X 上记录的错误代码`accept(2)`（并且对于大多数任何 POSIX 兼容系统都应该是一致的）：

*   `EBADF``socket`- 程序员错误 - 如果原始调用成功则不会发生
*   `ECONNABORTED`- 再试一次
*   `EFAULT``&client_addr`- 程序员错误 - 除非无效，否则不会发生
*   `EINTR`- 通话中断，重试
*   `EINVAL`- “套接字不愿意接受连接” - 我不确定这会如何发生。这*可能*是由于没有`listen(2)`首先调用（程序员错误），尽管显然在某些操作系统上它也可能是由`namelen`参数为负数引起的（也是程序员错误）
*   `EMFILE`- 程序员错误 - 您用完了每个进程的 FD，但除非您忘记关闭它们，否则不应该发生这种情况
*   `ENFILE`- 系统耗尽了 FD - 这可能是致命的
*   `ENOMEM`- 系统内存不足 - 这可能是致命的
*   `ENOTSOCK`- 程序员错误 - 除非你传递了一个不是套接字的 FD，否则不会发生
*   `EOPNOTSUPP`- 程序员错误 - 除非你传递一个不是`SOCK_STREAM`
*   `EWOULDBLOCK`- 程序员错误 - 你的套接字被配置为非阻塞

此外，Linux 系统似乎也可以生成`ENETDOWN`, `EPROTO`, `ENOPROTOOPT`, `EHOSTDOWN`, `ENONET`, `EHOSTUNREACH`, `EOPNOTSUPP`, 和`ENETUNREACH`. 这些是您应该循环的网络错误。

总之，您可能应该：

*   退出程序`ENFILE`或`ENOMEM`
*   `ECONNABORTED`在and上循环`EINTR`，上面的列表来自 Linux
*   `assert()`在您调试其他任何事情的过程中 - 这些运行时错误应该只因代码中的逻辑错误而发生，而不是因为与网络相关的事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T12:23:34.260

风格：

*   使用符号常量而不是将它们放在注释中
*   发生意外错误时至少报告错误号
*   也处理默认/意外情况

顺便说一句：下面的大多数符号常量似乎都不存在。

* * *

```
#include <errno.h>
#include <strings.h>

 /* Busy-waiting server */
while(1){

    memset(&client_addr, 0, sizeof(client_addr));
    acc_sock_ds = accept(sock_ds, &client_addr, &client_addr_l);
    /*Connect error management*/
    if(acc_sock_ds == -1){
        switch(errsv=errno) {
            /*Fatal errors ENOMEN, ENFILE, all others*/
        default :
        case ENOMEM :
        case ENFILE :
            fprintf(stderr, "Fatal error on accept %d(%s)\n"
                , errsv, strerror(errsv)
                );
            exit(EXIT_FAILURE);
            /* normal NON-ERROR error conditions */
        case ECONNABORTED :
        case EINTR :
        case EPROTO :
        case ENOPROTOOPT :
        case EHOSTDOWN :
        case EHOSTUNREACH :
        case EOPNOTSUPP :
        case ENETUNREACH :
             continue;
        case ENETDOWN :
        case ENONET :
             /*start timeout...*/
             continue;
         }
    }
  }
} 
```

# unit-testing - 测试使用模板的指令

> ID：15178804
> 
> 赞同：6
> 
> 时间：2013-03-02T19:59:39.053
> 
> 标签：unit-testing, web-applications, angularjs, angularjs-directive

如何对使用 templateUrl 加载模板的指令进行单元测试？

由于 $httpBackend 是一个模拟，它也不会加载模板。我希望能够使用类似的东西

```
$httpBackend.whenGET(/^\/views\//).passThrough(); 
```

让它真正得到模板，但我还没有弄清楚如何正确地做到这一点。

我想我对如何对指令进行单元测试有些困惑。免责声明：我没有测试经验，也没有使用 jasmine 或 testacular 的经验。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T20:19:50.230

IMO 测试依赖于模板（由 引用`templateUrl`）的指令的最简单方法是将这些模板放在`$templateCache`前面。通常这是由构建过程完成的。

更详细地说：每个模板标记都被转换为 JavaScript 代码并放入`$templateCache`. 此外，还会生成一个 AngularJS 模块（模块的名称是模板的路径）。

通过应用这种技术，我们只需要处理 JavaScript 文件，我们不需要模拟任何 HTTP 调用。缺点是您需要额外的构建步骤。

我相信最初这种技术是由 Vojta Jina 的优秀存储库推广的：[https ://github.com/vojtajina/ng-directive-testing 在](https://github.com/vojtajina/ng-directive-testing)[这里](https://github.com/vojtajina/ng-directive-testing/blob/master/grunt.js)你可以看到模板准备和实际测试引用带有模板预加载的模块[在这里](https://github.com/vojtajina/ng-directive-testing/blob/master/test/tabsSpec.js#L8).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-02T21:36:30.563

感谢 pkozlowski.opensource 引导我朝着正确的方向前进！

对于任何想知道我如何解决它的人：

1.  将[https://npmjs.org/package/grunt-angular-templates](https://npmjs.org/package/grunt-angular-templates)添加到您的项目中。
2.  添加一个 grunt build 任务，将所有模板编译成一个 js 文件。

这个 JS 文件现在将注册一个模块（名称可以在 gruntfile 中配置）。

在所有依赖于模板的测试中，您必须加载此模块。

示例测试：

```
'use strict';

describe('Component: comments', function() {
  beforeEach(module('studentportalenApp'), module('app.templates'));

  var element;

  it('should render an error message if type is not recognized', inject(function($rootScope, $compile) {
    element = angular.element('<comments></comments>');
    element = $compile(element)($rootScope);
    expect(element.html()).toBe('Comments directive type not recognized.');
  }));
}); 
```

请注意使用与 app.templates 模块中定义的完全相同的 url 获取视图。即/views/而不是views/，否则它将与模板缓存路径不匹配并且无论如何都会触发请求。

# python - python/pyside 在 qtreewidget 中使用自定义小部件

> ID：15178807
> 
> 赞同：1
> 
> 时间：2013-03-02T19:59:54.490
> 
> 标签：python, qt, pyside, qtreeview, qtreewidget

使用 Python3 和 pyside。我有一个 python 字典，我想使用 Qt 将其显示为树。我希望值是可编辑的，但不是键。我已经设法使用[setItemWidget](http://srinikom.github.com/pyside-docs/PySide/QtGui/QTreeWidget.html#PySide.QtGui.PySide.QtGui.QTreeWidget.setItemWidget)实现了这一点，如下例所示：

```
#!/usr/bin/python3
# -*- coding: utf-8 -*-

import sys
from PySide import QtGui

def data_to_tree(parent, data):
    if isinstance(data, dict):
        parent.setFirstColumnSpanned(True)
        for key,value in data.items():
            child = QtGui.QTreeWidgetItem(parent)
            child.setText(0, key)
            data_to_tree(child, value)
    elif isinstance(data, list):
        parent.setFirstColumnSpanned(True)
        for index,value in enumerate(data):
            child = QtGui.QTreeWidgetItem(parent)
            child.setText(0, str(index))
            data_to_tree(child, value)
    else:
        widget = QtGui.QLineEdit(parent.treeWidget())
        widget.setText(str(data))
        parent.treeWidget().setItemWidget(parent, 1, widget)

app = QtGui.QApplication(sys.argv)

wid = QtGui.QTreeWidget()
wid.setColumnCount(2)
wid.show()

data = {
    'foo':'bar',
    'bar': ['f', 'o', 'o'],
    'foobar':0,
}
data_to_tree(wid.invisibleRootItem(), data)

sys.exit(app.exec_()) 
```

这可行，但它违背了文档的建议（静态内容），并且无法事先创建小部件（例如在单独的线程中）然后将其添加到树中。有没有更好的方法来实现我想要的？文档中提到了 QTreeView，但我没有找到任何示例/教程让我了解它如何帮助我在列中使用我自己的小部件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:30:46.367

您可能需要考虑 2 个选项：

*   您可以创建自己的类，它是 a 的子类`QTreeWidget`。这很简单，因为您只需按原样使用您拥有的方法并将其放入类中。但这并没有真正改变很多，除了在您的自定义小部件上调用它时它看起来更“自然”。

*   另一种方法，也就是您在谈论文档时最可能引用的方法是模型/视图架构。

在这种情况下，您将不得不使用`QTreeView`并创建自己的`QTreeModel`. 在这里，视图完全不知道数据是什么，模型负责提供所有数据，并在视图准备好显示时通知视图。因此，您必须制作该对象并在数据准备好/更改时发出信号，以便更新视图。

有关如何实现类似功能的想法，您可以查看 PySide 提供的示例。很可能您已经安装了它们，请查看`site-packages/PySide/examples/itemviews/simpletreemodel`.

此外，请考虑查看[indexWidget](http://srinikom.github.com/pyside-docs/PySide/QtGui/QAbstractItemView.html#PySide.QtGui.PySide.QtGui.QAbstractItemView.indexWidget)方法，以便您可以`QEditLine`在需要的地方添加并调用父级作为默认值。

# php - 从PHP中的父类调用方法？

> ID：15178809
> 
> 赞同：-3
> 
> 时间：2013-03-02T19:59:56.353
> 
> 标签：php, class-visibility

我似乎想不出一种方法来调用一个名为`insertValue()`;的方法。

我的引导程序获取 url 并将其拆分为多个部分，因此 www.URL.com/register/register 变为

```
url[0]=register;  
url[1] = register;  
$controller = new url[0];  
$controller->loadModel();  
if islet($url[1])  
    $controller->{url[1]};  

class Controller { 
    public $model; 
    function __construct() { 
        $this->view = new View(); //(irrelevant) 
    } 
    public function loadModel($name) { 
        ... 
        $this->model = new $modelName; 
    }
} 
```

模型类如下

```
class Model { 
    public $database;
    function__construct() { 
        $this->database = new Database();
    } 
} 
```

所以数据库类如下

```
class Database { 
    insertValue(){ 
    ... 
    }
} 
```

现在，我有一个引导程序，它创建一个扩展控制器的寄存器类，如下所示：

```
class Register extends Controller {
    function__construct(){
        parent::__construct();
    }
    public static function register (){
        HERE IS WHERE I WANT TO CALL THE INSERT VALUE FUNCTION FROM DATABASE CLASS
    }
} 
```

引导程序还通过说它`Register->loadModel();`看起来像这样来创建我的模型类：

```
class registerModel extends Model {

    function __construct() {
        parent::__construct();
   } 
```

我根本不知道如何调用 insertValue 函数。我试过`$this->model->database->insertValue();`了，但没有用。

PS我注意到当我调用这个函数时，它下面的代码没有被调用，但没有给出错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:01:58.317

你试过`$this->model->database->insertValue()`吗？`loadModel()`在您的控制器构造内部调用之后。

# symfony - 使用 Twig 进行 Symfony 和 MySQL 查询

> ID：15178811
> 
> 赞同：0
> 
> 时间：2013-03-02T20:00:08.243
> 
> 标签：symfony, pdo, twig

我正在学习 Symfony；在我的网站[http://mynews.localhost](http://mynews.local)上有一个在 routing.yml 中工作的简单页面：

```
MyNewsHere:
pattern:  /mynews
defaults: { _controller: MyNewsBundle:NewsStory:index } 
```

这是控制器：

```
<?php

namespace MyNewsHere\MyNewsBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;

class MyNewsHereController extends Controller
{
    public function indexAction()
    {
        /*
         * The action's view can be rendered using render() method
         * or @Template annotation as demonstrated in DemoController.
         *
         */
        return $this->render('MyNewsBundle:MyNews:index.html.twig');
    }
} 
```

这是 index.html.twig：

```
 <link rel="stylesheet" type="text/css" href="{{ asset('bundles/MyNews/index.css') }}" media="all">

Hello World!

<h2>TEST</h2> 
```

但是，我想扩展 Hello World 示例并实际运行 PDO MySQL 查询，如[本网站](http://devzone.zend.com/1886/creating-web-page-templates-with-php-and-twig-part-1/)所示。我可以为一个简单的基于 Twig 的 PHP 站点做 PHP/PDO/MySQL 示例，而无需 Symfony；但是我怎样才能让它在我的 Symfony 网站上运行，就像上面的 MyNews 示例一样？我确实在 Google 上查找了“pdo mysql symfony”，但不太确定如何在 Symfony 的初学者级别上做到这一点……确实看过 Symfony 手册，但有点困惑。

任何意见，将不胜感激; 我是使用 Twig 的初学者，我认为使用 Symfony 会扩展它。

注意 给出的链接*仅适用*于我的本地主机上的站点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:33:07.433

首先，Twig 只是一个模板引擎。它只能做一些较少的逻辑编程事情，而不是繁重的部分，这应该在 PHP 中使用 Symfony2 之类的框架完成。

其次，看一下文档，尤其是[“The Book”](http://symfony.com/doc/current/book)。阅读第一篇、第二篇、第三篇……文章。一旦你阅读了“Databases & Doctrine”一文，你就会明白 Symfony 做什么以及 twig 做什么。那篇文章解释了如何在 Symfony 项目中使用数据库。

# linux - 我应该使用哪个 Linux 发行版进行编译

> ID：15178812
> 
> 赞同：0
> 
> 时间：2013-03-02T20:00:15.540
> 
> 标签：linux, compilation

最初，我在 Ubuntu 上编译了我的项目 (Qt)，在分发 deb 文件时，有人抱怨说我的应用程序无法执行，因为他们的操作系统使用 libc 2.14 甚至更低版本。因此，不同的 Linux 发行版带有不同的库版本。我应该使用哪个 Linux 发行版进行编译，以便我的应用程序可以在所有 Linux 发行版上运行。该问题主要是由一些稳定的 Linux 发行版使用的旧版 C 库引起的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:26:22.020

如果您尝试针对非常旧版本的 libc 编译二进制文件，它可能会在运行最新版本发行版的机器上失败，因为可能没有`compat-`支持`libc`非常旧版本的`libc`.

相反，如果您尝试使用非常新的版本，它会在旧机器上损坏。

所以在一个发行版上编译，`CentOS 6`或者`Ubuntu 10.04`对我来说似乎是一个合理的中间立场。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:10:11.423

您可以使用 Ubuntu，但也可以使用更早的版本（10.04 LTS）。通常不鼓励静态链接到 libc，但在运行早期版本的机器时，您可以使用旧的 libc 并添加 apt pinning 从以后的发行版中获取更新的包。

# c++ - 阶乘不适用于所有值

> ID：15178813
> 
> 赞同：0
> 
> 时间：2013-03-02T20:00:17.870
> 
> 标签：c++, function, factorial

大家好，我编辑了我的帖子，因为我的代码有另一个问题。昨天我的阶乘函数有问题，但由于您的回答，我设法解决了它，这是一个荒谬的错误。现在的问题是，对于某些高于 15 的值，最终结果（不是单个数字的阶乘）始终为 0 或 -1，因为较小的值可以正常工作。有人能告诉我这段代码有什么问题吗：

```
 #include <iostream>
    #include<time.h>

    using namespace std;

    int factorial(int a){
    if(a==1)
      return 1;
    else if(a==0)
      return 1;
    else 
      return factorial(a-1)*a;

    }

    int main(){
    std::cout.setf(std::ios_base::fixed, std::ios_base::floatfield);
    std::cout.precision(5);
    int n,k;
    int x,y,z,w,v; 

    cout<<"give n : ";
    cin>>n;

     cout<<"give k : ";
     cin>>k;

     clock_t t;

        t = clock();

      if(n>=k&&k>1){

       x=factorial(n-1);
       y=factorial(k-1);
       z=factorial(n-1-k);
       w=factorial(n-k);
       v=factorial(k);

         cout<<"Result is "<<(x/(v*z))+(x/(y*w))<<endl;
       }
       else if (n==0||n==k)
         cout<<"Result is  1"<<endl;
       else
         cout<<"Result is  0"<<endl;

       t = clock() - t;
       cout<<"It took "<<t<<" clicks  ("<<((float)t)/CLOCKS_PER_SEC<<" seconds )"<<endl;    

       return 0;
       } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-03T18:44:12.943

整数溢出。

如果`int`在您的系统上是 32 位，则它可以表示的最大值是`2147483647`. 13 阶乘是`6227020800`.

如果您使用 64 位整数类型`long long`，则最多可以使用 20 个阶乘。

浮点会给你更大的范围，但会损失精度。

如果你真的需要计算大的阶乘，你需要使用像[GMP](http://gmplib.org/)这样的多精度库，或者使用具有内置任意精度整数运算的语言（C 没有）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:03:39.830

以下可能会`factorial`使用零或负参数调用：

```
z=factorial(n-1-k);
w=factorial(n-k); 
```

您需要确保您的`factorial`函数可以处理此类参数而不会崩溃（我怀疑它不会）。

# extjs - 从嵌套创建的对象访问已定义类的函数

> ID：15178814
> 
> 赞同：1
> 
> 时间：2013-03-02T20:00:19.420
> 
> 标签：extjs, extjs4

我想从它创建的嵌套对象中访问类的函数，`Ext.create`我不能使用它，因为它引用了创建的对象。

```
Ext.define('FM.view.HistoryProperty',{
extend: 'Ext.grid.property.Grid',
alias: 'widget.historyProperty',
title: 'History',
closable: false,
header: true,
layout: {
    type: 'vbox',
    align: 'left'
},
sortableColumns: false,
customEditors: {
    Vehicle: Ext.create('Ext.form.ComboBox',{
        store: Ext.create('FM.store.Vehicles',{}),
        editable : false,
        queryMode: 'local',
        displayField: 'vehiclename',
        valueField: 'vehicleid',
        id: 'vehicle'
    }),
    getStartDateField: function() {
        if (!this.startDate) {
            this.startDate = Ext.create('Ext.form.DateField',{
                format: 'y-m-d G:i',
                value : this.yesterday(),
                listeners: {
                    expand: {
                        fn: function(field) {
                            field.setMaxValue(this.endDate.getValue());
                        },
                        scope: this
                    }
                }
            });
        }
        return this.startDate;
    } ,
    getEndDateField: function(){
        if(!this.endDate){
            this.endDate = Ext.create('Ext.form.DateField',{
                format: 'y-m-d G:i',
                selectOnFocus:true,
                value : this.today(),
                listeners: {
                    expand: {
                        fn: function(field){ field.setMinValue(this.startDate.getValue()); }
                    },
                    scope: this
                }
            });
        }
        return this.endDate;
    }
},
yesterday: function(){
    var yesterday = new Date();
    yesterday.setDate(yesterday.getDate()-1);
    yesterday.setHours(0,0,0);
    return yesterday;
},
today: function(){
    var today = new Date();
    today.setHours(23,59,59);
    return today;
},
source: {
    "Vehicle": 'Select Vehicle',
    "getStartDateField": this.yesterday,
    "getEndDateField": this.today
} 
```

});

我使用已定义类的名称来访问它的功能，但它不起作用`Ext.cmp('historyProperty')`。也不起作用！。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-03T14:02:48.157

像您正在做的那样在类原型上放置一个字段对象（或任何类型的非原始值）是一个非常糟糕的主意。您从类中实例化的每个`HistoryProperty`人都将共享相同的字段，这几乎肯定不是您想要的。

`HistoryProperty`为您的字段添加访问器方法并在第一次请求时创建它允许您调用在您的类中定义的昨天方法，并确保您将避免共享相同日期字段的两个实例可能发生的任何意外。

```
Ext.define('FM.view.HistoryProperty',{
    extend: 'Ext.grid.property.Grid',
    alias: 'widget.historyProperty',

    getStartDateField: function() {
        if (!this.startDate) {
            this.startDate = Ext.create('Ext.form.DateField',{
                format: 'y-m-d G:i',
                value : this.yesterday(),
                listeners: {
                    expand: {
                        fn: function(field) {
                            field.setMaxValue(this.endDate.getValue());
                        },
                        scope: this
                    }
                }
            });
        }
        return this.startDate;
    },

    yesterday: function(){
        var yesterday = new Date();
        yesterday.setDate(yesterday.getDate()-1);
        yesterday.setHours(0,0,0);
        return yesterday;
    }
}); 
```

使用您当前的代码，`HistoryProperty.yesterday`当您调用它时该方法不可用，因为尚未定义该类并且您已经尝试访问其原型上的方法。假设 endDate 字段是像 StartDate 一样创建的，您的扩展侦听器处理程序可能也不起作用。这些字段位于类的原型上，需要像这样访问。

```
function() {
    this.setMaxValue(FM.view.HistoryProperty.prototype.endDate.getValue());
} 
```

如果您坚持将字段直接放在原型上（不要这样做），则必须在定义类之前定义昨天的函数。例如。

```
(function() {
    var yesterday = function() {
        var date = new Date();
        date.setDate(date.getDate() - 1);
        date.setHours(0, 0, 0);
        return date;
    };

    Ext.define('FM.view.HistoryProperty',{
        extend: 'Ext.grid.property.Grid',
        alias: 'widget.historyProperty',
        StartDate: Ext.create('Ext.form.DateField',{
            format: 'y-m-d G:i',
            value : yesterday()
        })
    });
} ()); 
```

*编辑*

当您使用 定义类时`Ext.define`，`this`除非您实际上在类方法中，否则不会引用您的类原型。

```
Ext.define('Test', {
    doSomething: function() {
        // 'this' refers to the object this method was called on. An instantiation
        // of the Test class.
        this.x = 1; 
    }
    property1: 'a',
    // 'this' is the whatever scope Ext.define was called in (probably window), not Test.prototype.
    property2: this.property1, // property2 will not be 'a'
    objectProperty: {
        // 'this' is still window, not Test.prototype.
        property3: this.property1 // property3 will not be 'a' 
    }
}); 
```

在您的代码中，源对象文字指的是`this.yesterday`and `this.today`。在定义类的过程中，您无法访问`yesterday`或`today`此时，因为`this`仍然是`window`.

一个主要问题是您正在使用用于类实例化但在类定义时指定它们的配置。如果您查看 Ext 的 customEditors 文档（已弃用）、source、sourceConfig 等。您会看到它们正在将这些属性添加到传递给构造函数的配置对象中。

您真的不想在类原型上添加这些属性，因为它们是特定于实例的，并且跨多个网格共享您的编辑器字段会导致很多意外行为。

例如，如果开始和结束日期字段是全局的，则更改一个网格中的开始日期将影响共享这些字段的所有其他网格中的最小结束日期。

相反，重写 initComponent 方法并在那里添加配置属性。像这样的东西应该适合你：

```
Ext.define('FM.view.HistoryProperty', {
    extend: 'Ext.grid.property.Grid',
    alias: 'widget.historyProperty',
    title: 'History',
    closable: false,
    header: true,
    layout: {
        type: 'vbox',
        align: 'left'
    },
    sortableColumns: false,

    getStartDateField: function() {
        if (!this.startField) {
            this.startField = Ext.create('Ext.form.DateField',{
                format: 'y-m-d G:i',
                listeners: {
                    expand: {
                        fn: function(field) {
                            // get this instance of the grid's end date field
                            field.setMaxValue(this.getEndDateField().getValue());
                        },
                        // the scope is the grid component.
                        scope: this
                    }
                }
            });
        }
        return this.startField;
    },

    getEndDateField: function() {
        if (!this.endField) {
            this.endField = Ext.create('Ext.form.DateField',{
                format: 'y-m-d G:i',
                listeners: {
                    expand: {
                        fn: function(field) {
                            // get this instance of the grid's start date field
                            field.setMinValue(this.getStartDateField().getValue());
                        },
                        // the scope is the grid component.
                        scope: this
                    }
                }
            });
        }
        return this.endField;
    },

    getVehicleField: function() {
        return Ext.create('Ext.form.ComboBox',{
            store: Ext.create('FM.store.Vehicles',{}),
            editable : false,
            queryMode: 'local',
            displayField: 'vehiclename',
            valueField: 'vehicleid',
            id: 'vehicle'
        });
    },

    // Setup the source and sourceConfig properties in initComponent not on the
    // class prototype so that each instance of the grid has its own unique
    // setup.
    initComponent: function() {
        // 'this' is the grid component.
        Ext.apply(this, {
            source: {
                Vehicle: "select vehicle",
                startDate: this.yesterday(),
                endDate: this.today()
            },
            sourceConfig: {
                startDate: {
                    displayName: 'Start',
                    // we are in a method so 'this' is the instance of the grid
                    // and the getStartDateField is available to us here.
                    editor: this.getStartDateField()   
                },
                endDate: {
                    displayName: 'End',
                    editor: this.getEndDateField()
                },
                Vehicle: {
                    displayName: 'Vehicle',
                    editor: this.getVehicleField()
                }
            }
        });

        this.callParent(arguments);
    },

    yesterday: function() {
        var yesterday = new Date();
        yesterday.setDate(yesterday.getDate()-1);
        yesterday.setHours(0,0,0);
        return yesterday;
    },

    today: function() {
        var today = new Date();
        today.setHours(23,59,59);
        return today;
    }
}); 
```

# android - Nexus 7 HTML5 视频试图隐藏系统 UI 并反复失败

> ID：15178818
> 
> 赞同：0
> 
> 时间：2013-03-02T20:00:41.007
> 
> 标签：android, html, video, webview

我正在开发一个使用 webview 拉入网站的 android 应用程序。我已经成功获得了 HTML 5 视频，可以在页面和全屏中播放。这在我的 nexus 手机上完美运行。但是，在全屏横向模式下在 nexus 7 上进行测试时，视图似乎在隐藏视频控件时试图隐藏系统 UI 导航。它立即弹回，导致控件返回，然后重复该过程。

以下是日志中的内容：

```
03-02 00:45:45.641   488   501 I ActivityManager: Config changes=1480 {1.0 310mcc?mnc en_US ldltr sw600dp w961dp h528dp 213dpi lrg land finger -keyb/v/h -nav/h s.585}
03-02 00:45:48.841   488  1143 W InputMethodManagerService: Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@425e74a8 attribute=null, token = android.os.BinderProxy@416975b8
03-02 00:45:52.231   488  3300 W InputMethodManagerService: Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@41ea5b20 attribute=null, token = android.os.BinderProxy@416975b8
03-02 00:45:57.811   488  1164 W InputMethodManagerService: Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@41bec5b8 attribute=null, token = android.os.BinderProxy@416975b8 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T06:41:06.853

是的，我见过这种行为，而且更糟。Nexus 7 的 Chrome 中的 HTML5 尚未准备好迎接黄金时段。

解决方案：向谷歌投诉并等待。

# php - 使用 xml、php 和 jQuery 提供 rss 提要

> ID：15178820
> 
> 赞同：0
> 
> 时间：2013-03-02T20:01:18.077
> 
> 标签：php, jquery, rss, feed

我想要做的是创建一个 xml 提要，可以通过直接访问 url（带有一些请求参数）来访问它，然后将内容作为提要提供。我遇到的问题是满足我需求的确切方法。

我已经设置了一个 ajax 系统来从 Web 服务中提取数据，然后将其从 xml 解析为 json 并提取我需要的数据。将我需要的内容提取到提要中很简单，但我无法完全理解正确的方法来做到这一点。

我已经想出了如何使用 php 和 xml 直接从 url 提供页面，以便我打印出提供提要所需的 xml。我不知道如何/在哪里放置javascript。javascript只需要解析数据，所以我相信它需要插入到检索数据的php调用和php代码之间的某个地方回显出数据。在页面加载时发生的速度足够快，但我不知道这是否允许。

无论如何，如果我写的任何内容不清楚，我可以提供代码或更详细的信息。

# java - 方法 join(String[], char) 未定义类型

> ID：15178827
> 
> 赞同：0
> 
> 时间：2013-03-02T20:02:02.497
> 
> 标签：java, selenium

我是 Selenium 的新手。我得到了错误

> 方法 join(String[], char) 未定义类型

在 Eclipse 中使用 Selenium Server 时。我想知道`join`Selenium 中该命令的等价物是什么。或者我应该使用 jar 文件来处理这个错误？

* * *

我正在探索 Selenium RC，我将 JUnit 代码从 IDE 复制到 Eclipse 并尝试调试错误。我添加了几个 jar 文件并替换`VerifyTrue`为`assertTrue`类似的错误。但我不知道用什么替换`join`命令。这是代码片段：

```
for (int second = 0;; second++) {
    if (second >= 60) fail("timeout");
    try {
        if ("".equals(join(selenium.getAllFields(), ','))) break;
    } catch (Exception e) {
    }
    Thread.sleep(1000);
} 
```

感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T00:35:34.367

[Apache commons-lang 库](http://commons.apache.org/proper/commons-lang//)具有[`StringUtils.join()`](http://commons.apache.org/proper/commons-lang//javadocs/api-release/org/apache/commons/lang3/StringUtils.html#join%28java.lang.Object%5B%5D,%20char%29)完全符合您要求的方法。

# php - PHP foreach 循环显示每个列表项，而只显示列表名称一次

> ID：15178829
> 
> 赞同：0
> 
> 时间：2013-03-02T20:02:04.110
> 
> 标签：php, multidimensional-array, foreach

请比较下面的`CURRENT`和`DESIRED`结果，看看我想要做什么。

```
$arr=array(
array('list_name'=>'Food', 'list_item'=>'bread'),
array('list_name'=>'Food', 'list_item'=>'meat'),
array('list_name'=>'Drinks', 'list_item'=>'water'),
array('list_name'=>'Drinks', 'list_item'=>'milk')
);

foreach($arr as $row){   
  echo $row['list_name'].'<br>'; 
  echo $row['list_item'].'<br>';
  echo '<br>___<br>';
} 
```

当前结果

```
Food
bread

___
Food
meat

___
Drinks
water

___
Drinks
milk

___ 
```

期望的结果

```
Food
1.bread
2.meat
___

Drinks
1.water
2.milk
___ 
```

**更新**

更复杂但更普遍的例子：

```
$arr=array(
array('list_name'=>'Food', 'list_item1'=>'bread', 'list_item2' => 2001),
array('list_name'=>'Food', 'list_item1'=>'meat', 'list_item2' => 2002),
array('list_name'=>'Drinks', 'list_item1'=>'water', 'list_item2' => 2003),
array('list_name'=>'Drinks', 'list_item1'=>'milk', 'list_item2' => 2004)
); 
```

期望的结果

```
Food
1.bread, 2001
2.meat, 2002
___

Drinks
1.water, 2003
2.milk, 2004
___ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T20:08:19.137

您可以遍历数组并将项目数据添加到一个新数组（每个数组一个`list_name`）。

例如：

```
$new_array = array();

foreach ($arr as $row)
{
  $new_array[$row['list_name']][] = $row['list_item'];
}

foreach ($new_array as $name => $items)
{

  echo $name . '<br>'; 

  foreach ($items as $index => $item)
  {
    echo ($index + 1) . '. ' . $item . '<br>';
  }

  echo '___<br>';

} 
```

随着您的更新：

```
$new_array = array();

foreach ($arr as $row)
{

  $name = $row['list_name'];

  unset($row['list_name']);

  $new_array[$name][] = $row;

}

foreach ($new_array as $name => $items)
{

  echo $name . '<br>'; 

  foreach ($items as $index => $item)
  {
    echo ($index + 1) . '. ' . implode(', ', $item) . '<br>';
  }

  echo '___<br>';

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:17:18.407

一个常见的方法是在循环列表时将当前标题/部分存储到一个变量中。然后每次遇到新标题时，都会回显该标题，然后重新开始编号（或关闭 HTML`<ol>`标记等）。

```
$current_section = NULL;
foreach ( $arr as $row )
{
    if ( $current_section != $row['list_name'] )
    {
        // Begin new section
        echo $row['list_name'];
        // Remember current section
        $current_section != $row['list_name'];
    }

    // Output current item
    echo $row['list_item'];
} 
```

请注意，这种方法**仅**在您的列表排序后才有效，即所有“食物”项目都放在一起，然后是所有“饮料”等。

否则，您可以使用重新构造数组的替代方法，以便每个部分都有一个子数组，然后使用一对嵌套循环：

```
$new_array = array();
foreach ($arr as $row)
{
    $new_array[$row['list_name']][] = $row['list_item'];
}

foreach ( $new_array as $section_name => $items )
{
    echo $section_name;
    foreach ( $items as $row )
    {
        echo $row;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T20:39:25.600

```
$arr=array(
array('list_name'=>'Food', 'list_item'=>'bread'),
array('list_name'=>'Food', 'list_item'=>'meat'),
array('list_name'=>'Drinks', 'list_item'=>'water'),
array('list_name'=>'Drinks', 'list_item'=>'milk')
);

$names = array();

foreach ( $arr as $item){
    $name = $item['list_name'];
    if(!in_array($name, $names)){
        $names[] = $name;
        echo $name ."<BR>";
    }
    echo $item['list_item']."<BR>";
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-02T20:22:25.567

好的，我之前犯了一个错误，但我测试了它，它确实有效。

```
<?php
$food = array('bread', 'meat');
$drink = array('water', 'milk');

$object = array('food' => $food, 'drink' => $drink);

foreach($object as $row){   
  echo $row[0].'<br>'; 
  echo $row[1].'<br>';
  echo '<br>___<br>';
}
?> 
```

# ruby - ruby on rails 中的 calendar_for (table_builder)

> ID：15178832
> 
> 赞同：0
> 
> 时间：2013-03-02T20:02:35.073
> 
> 标签：ruby

嗨，我正在尝试使用 table_builder 显示在参与日期放映的电影列表，这是视图中的代码。

```
<%= calendar_for @showings, :year => @date.year, :month => @date.month do |calendar| %>
<%= calendar.head('Sun','Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat') %>
<%= calendar.day(:day_method => :date) do |date, showings| %>
<%= date.day %>
<ul>
<% for showing in showings %>
<%= link_to h(showing.film.title),showing%>
</br>
<% end %>
</ul>
<% end %>
<% end %> 
```

该代码有效，但是如果一部电影在同一天放映多次，那么电影标题也会在同一日期的日历上多次打印出来。我真正想要的是找出一部电影是否已经在某一天放映，如果是，那么只显示那部电影的标题一次。任何想法我可能会如何去做。

显示控制器中的代码

```
def whats_on
@showings = Showing.all
@date = params[:month] ? Date.strptime(params[:month]) : Date.today
end 
```

目前的关系

```
film - has_many :showings
showing - belongs_to :film 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:10:35.963

你可以这样做：

```
 <% showings.group_by{|s| s.film.title}.each do |title, shows %>
    <%= link_to h(title), some_path %>
    <% shows.each do |s| %>
      <%= link_to s.something,s%>
    <% end %>
    </br>
 <% end %>

 def whats_on
   @showings = Showing.all(:include => :film)
   @date = params[:month] ? Date.strptime(params[:month]) : Date.today
 end 
```

# entity-framework - 如何在这个复杂的设置中配置实体框架连接

> ID：15178833
> 
> 赞同：0
> 
> 时间：2013-03-02T20:02:54.770
> 
> 标签：entity-framework, asp.net-mvc-4, code-first

假设您有 1 个 Web 应用程序，并且为 50 个州中的每一个州运行相同的代码库。由于存储数据的合法性，每个州都必须拥有自己独立的数据库，即使它们除了名称和实际数据之外都相同。将应用程序保存在单个代码库中。您在 Web 服务器上有 50 个应用程序实例，每个实例的 web.config 中都有不同的连接字符串。

然后，您想首先将 EF 5 代码与 migraitons 一起使用。我希望 EF 5 使用 1 个指定的连接字符串。到现有的数据库。我不想为模型中的每个对象都有一个连接字符串。喜欢...

```
<add name="ProductsContext" connectionString=".....
<add name="UsersContext" connectionString=".....
<add name="LocationsContext" connectionString="..... 
```

我想要 1 个连接字符串，例如

```
<add name="DefaultConnection" connectionString="..... 
```

我该怎么做呢？

此外，如果我的模型中的每个对象都需要成为 dbcontext 的一部分，那么最好将它们放在单独的上下文中，如教程显示或可以/应该它们都在同一个上下文中，这将允许我只拥有一个“默认上下文”。你应该有多少上下文？

如果我让 EF 使用连接工厂并创建 3 个上下文，它会尝试创建 3 个数据库。

注意我不能以编程方式指定连接，因为应用程序的每个副本都连接到不同命名的数据库。

我真的很困惑 EF 想要我模型中的每个对象都有一个数据库。此外，如果他们有一种方法可以让 1 个代码库访问 50 个单独的数据库，并且知道在启动时要进入哪个数据库，而无需任何用户交互，那也很有帮助。当前，在需要更新网络服务器上的代码时，使用具有不同 web 配置文件的相同代码的单独托管实例是一个需要维护的婊子。

建议？解决方案？最佳实践？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:39:25.287

您定义的每个上下文类都会创建一个新模型，在绝大多数情况下，您只需要 1 个模型，因此每个应用程序只需要 1 个上下文类。此外，如果不同上下文中的实体之间存在导航属性，它们将无法按预期工作。这样，您只需要在每个 web.config 文件中使用 1 行来指定连接字符串。

查看本教程，了解如何创建具有多种实体类型的模型：http: [//msdn.microsoft.com/en-us/data/jj193542](http://msdn.microsoft.com/en-us/data/jj193542)

# javascript - JS/JQuery：将参数添加到参数数量未知的路径

> ID：15178836
> 
> 赞同：-1
> 
> 时间：2013-03-02T20:03:11.307
> 
> 标签：javascript, jquery, ajax

我有一个依赖于 AJAX 调用的 JS 脚本，该调用将参数添加到 html 请求中。我遇到了两个问题。

1.  我想不出一种简单的方法来获取包含参数的路径名。在直接 JS 中，`location.pathname`只返回当前路径，不带参数。使用 JQuery，`$(document).href`返回整个 URL，但包括我不想要的东西，如方案、域等。是否有一个很好、简单、简单的方法只返回包含参数的路径？
2.  一旦我有了路径，我还没有找到添加参数的好方法，因为路径可能已经包含零个或多个参数。幸运的是，我不需要更新已经存在的密钥，只需添加一个新密钥。我已经在 SO 上发现了一些类似的问题，例如：[Add a parameter to the URL with JavaScript](https://stackoverflow.com/questions/486896/adding-a-parameter-to-the-url-with-javascript)，但是有没有办法在不编写我自己的 URL 解析器或其他样板代码的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T06:38:23.987

我找到了自己问题的答案。

事实证明，它比我迄今为止发现的任何其他解决方案都容易得多。

在 JS 中，`location.search`返回 URI 的查询参数字符串。所以我可以简单地检查它是否存在，如果存在，则添加`&foo=bar`到 URI 的末尾，`?foo=bar`如果不存在。无需解析。

顺便说一句，这也回答了我的另一个问题：`location.pathname+location.search`返回包含查询参数的路径。

此解决方案不适用于所有情况，尽管它适用于我的情况。可能会出现的一些问题：如果要修改现有参数，则需要进行额外的解析。或者，如果您的参数包含诸如`?`or之类的字符`&`，则需要额外的转义。更完整的解决方案在这里：[http ://www.eggheadcafe.com/articles/20020107.asp](http://www.eggheadcafe.com/articles/20020107.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-18T08:17:04.237

获取仅包含参数的路径名的简单方法是首先使用 location.href 获取完整的 url，例如 var path= window.location.href，然后拆分此 url，例如 (var pathQyeryPramater = path.split("/")[3] )根据您的要求。此 pathQyeryPramater 将仅返回带有查询参数的整个路径，然后跟进上述答案。

# mysql - 在 XAMPP 中更新 MySQL

> ID：15178839
> 
> 赞同：1
> 
> 时间：2013-03-02T20:03:52.503
> 
> 标签：mysql, xampp, updates

XAMPP 目前随 MySQL 5.5.27 一起交付。

如何将此更新到更高版本？

（我至少需要 5.6.4，因为我需要 innoDB 的全文索引）

我尝试下载适用于 Windows 的当前版本 5.6.10 并将文件复制到 XAMPP 的 mysql 文件夹中。但是现在它说服务器无法启动。

# ios - 如何解析来自 ASIHTTPRequest 的多行响应并将数据加载到 UITableView？

> ID：15178844
> 
> 赞同：2
> 
> 时间：2013-03-02T20:04:24.690
> 
> 标签：ios, uitableview, asihttprequest

我正在尝试在我的 iOS 应用程序中构建一个简单的聊天模块。现在，应用程序可以发送消息，这些消息由 PHP 文件处理并保存到数据库中。

当尝试从数据库中检索要显示的消息时，服务器以以下格式返回最近 10 条消息的响应

`msgid|userid|timestamp|message`

请注意，这些值由 | 分隔。特点。

因此，来自我的服务器的示例响应如下

```
12|123|2013-03-02 09:15:16|Hey. How are you?
13|12|2013-03-02 09:17:31|Hey Matt. I'm good!
14|123|2013-03-02 09:18:02|That's great! 
```

我需要将此响应加载到 TableViewCells 中，但我不确定如何解析响应并在本地保存数据。

我是 iOS 开发的新手，非常感谢您的帮助。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:12:33.873

如果每条消息后都有换行符，您可以使用 NSString 方法：

```
- (NSArray *)componentsSeparatedByCharactersInSet:(NSCharacterSet *)separator 
```

所以：

```
NSArray *tableViewCellDataArray = [responseString componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]]; 
```

如果您的响应是 NSData 格式，您可以使用以下方法获取 NSString：

```
NSString *responseString = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding]; 
```

至于存储数据，您可以将其存储在 NSArray 属性中，或者如果您想要持久存储，请研究 Core Data 或 NSUserDefaults。

# prolog - 序言：使用 bagof

> ID：15178848
> 
> 赞同：0
> 
> 时间：2013-03-02T20:04:41.943
> 
> 标签：prolog

基本上我已经定义了一个谓词来从当前状态中查找所有“下一个可能的状态”，但是我必须使用内置的 bagof 谓词来统一所有这些状态的列表，但是当我在命令窗口中调用它时我得到错误'全局堆栈'，所以我尝试跟踪它，它只是不停地递归调用下一个状态，所以如果有无限数量的，它不可能得到所有这些解决方案的“包”解决方案！

我不认为将可能的当前状态列表“限制”为一定数量的元素是一种选择，那么在没有全局堆栈错误的情况下调用 bagof 有什么其他方法？

对不起，如果这没有多大意义！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T01:29:39.113

我敢打赌你在图中有循环。所以你要来回任意次数。

这就像询问从我家到当地商店的所有路线。在我去最后半个街区之前，我可以在我的街区走来走去任意次数。所以有一个无限的数字。

解决这个问题的方法是忘记 bagof。使用递归，但是当你下降时，保留一份你去过的地方的列表，不要回到他们那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T06:02:24.253

我认为您应该使用[call_with_depth_limit](http://www.swi-prolog.org/pldoc/doc_for?object=call_with_depth_limit/3) /3，但是如果不知道您的状态机的结构，很难详细说明任何提示。假设你有一个`state(Curr, Next)`with 递归，这应该是循环的罪魁祸首，那么你可以得到“下一个”的列表，比如

'下一个可能的状态'(Curr, ListNext) :- findall(Next, call_with_depth_limit(state(Curr, Next),2,_), ListNext)。

请注意，当您对量化变量使用不感兴趣时​​，使用 findall 比 bagof 更简单...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:31:05.120

搜索树的每个分支都需要在某个点终止，否则您确实会收到此错误。查看代码以了解无限循环的位置会很有用。可能您在某处创建了递归结构。例如 bagof 会在这里得到相同的结果： 如果你从 1 开始，它会找到 2、3、4、5、6... 直到无限，但你的堆栈会溢出！
`nextState(State1,State2):-
    State2 is State1+1.
nextState(State1,State3):-
    nextState(State1,State2),
    nextState(State2,State3).`

# javascript - 防止 JQuery 每次都为缓存的 HTML 请求检索脚本

> ID：15178851
> 
> 赞同：3
> 
> 时间：2013-03-02T20:04:51.480
> 
> 标签：javascript, jquery, ajax

我有一个头文件被加载并插入到我所有页面的顶部。此头文件使用以下 ajax 调用加载：

```
$.ajax({
        url: '/header.html',
        cache: true,
        dataType: 'html',
        success: function ( data ) {
            $( 'body').prepend( data );
        }
}); 
```

HTML 文件被缓存，因此当用户访问一个页面时，在导航到其他页面时，标题将在其他页面的顶部加载得更快。`<script>`问题是该 HTML 文件中有一个标签：

```
<script type="text/javascript" src="/header.js" defer="defer"></script> 
```

而且这个脚本没有被缓存。我检查了 Firebug 的网络活动选项卡，并在脚本的末尾使用唯一编号请求脚本：

```
GET http://localhost/header.js?_=1362254276028 
```

如何让 JQuery 像 HTML 页面一样从缓存中加载脚本，而不是每次加载页面时都获取它？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-03T04:37:30.397

默认情况下，所有 JavaScript 都会被缓存。另一个提示是使用 Google 托管的 jQuery 库，因为它会自动检测 HTTP/HTTPS，并且如果用户访问过引用 Google 链接的其他站点，则无需重新下载。

`<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>`

请注意已绝育的前端 (//)，这是它自动检测 HTTP/HTTPS 的方式。

# c# - 如何在 .Net 中通过 ZeroMQ 发送标记消息？

> ID：15178852
> 
> 赞同：0
> 
> 时间：2013-03-02T20:04:58.167
> 
> 标签：c#, .net, zeromq

因此，有了[官方包装器](https://github.com/zeromq/clrzmq)，我尝试创建一个简单的发布者，该发布者能够发布基于主题的消息（类似于[此处为 python 演示的发布者](https://gist.github.com/minrk/4667957)）：

```
using (var context = ZmqContext.Create())
using (var pub = context.CreateSocket(SocketType.PUB))
{
    pub.Bind(url);
    while (true)
    {
        pub.Send( // How to send "Message" string on topic "A.message"?
    }
} 
```

那么如何在主题/带有标签“ `A.message`”上发送“消息”字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T23:17:03.767

在 ZeroMQ 中，消息的主题只是消息的开始。在您的发布者中，尝试发送带有前缀的消息`A.message`。

# uwsgi - uwsgi master 和 Emperor 模式以及二进制升级

> ID：15178854
> 
> 赞同：0
> 
> 时间：2013-03-02T20:05:11.123
> 
> 标签：uwsgi

我已经对此进行了一段时间的研究，但未能找到任何明确的答案。

第一的。

**使用**--master 和 --emperor 选项运行 uwsgi 有什么好处？

我知道建议始终使用--master，但是我没有发现使用这两种方法比仅使用--emperor 有什么好处。

第二。

有没有办法像升级 nginx 的二进制文件一样**“即时”**升级 uwsgi 的二进制文件？

看来您必须完全停止和启动 uwsgi 进程才能获取新的二进制文件。在这种情况下，请求将停止处理。

如果之前已经讨论过这些，我深表歉意。如果有任何链接到以前的讨论，我会很感激他们看看。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T06:50:08.643

仅当您想要为 Emperor 提供高级日志记录或警报时，才需要与 Master 一起运行 Emperor。一般不需要。每次优雅地重新加载堆栈时，都会以二进制补丁结束：[https ://uwsgi-docs.readthedocs.org/en/latest/Management.html](https://uwsgi-docs.readthedocs.org/en/latest/Management.html)

# c++ - 使用视觉泄漏检测器

> ID：15178857
> 
> 赞同：1
> 
> 时间：2013-03-02T20:05:20.653
> 
> 标签：c++, visual-studio, qt, memory-leaks, visual-leak-detector

我有随机崩溃的 C++ 代码。在代码中我使用了一些 Qt 库。编译器是 MSVS 2010。根据一些可能是由于内存泄漏的建议，我开始使用 Visual Leak Detector 进行查找。我对 Visual Leak Detector 和内存泄漏检测非常陌生。

这是 main.cpp 中的代码：

```
int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    MainWindow w;
    w.show();
   return a.exec();
} 
```

并且`MainWindow`构造函数看起来像这样：

```
MainWindow::MainWindow(QWidget *parent) :
        QMainWindow(parent)
    ,   m_Inputdevice(QAudioDeviceInfo::defaultInputDevice())
    ,   m_audioInput(0)
    ,   m_input(0)
    ,   m_iVolume(0)
    ,   m_buffer(BufferSize, 0)
    ,   ui(new Ui::MainWindow)
{  // LINE 23
    ui->setupUi(this);
    initializeAudio(); // LINE 26
    udpSocket = new QUdpSocket(this); 
    udpSocket1 = new QUdpSocket(this);
    ...
    char* str = new char [30]; 
    VLDEnable();
    VLDReportLeaks(); 
} 
```

析构函数是：

```
MainWindow::~MainWindow()
{
  delete udpSocket;
  delete udpSocket1;
  delete m_audioInput;
  delete ui;
} 
```

根据一些建议，我刚刚安装它并得到以下结果：

```
WARNING: Visual Leak Detector detected memory leaks!
---------- Block 1 at 0x00CDED68: 12 bytes ----------
Call Stack:
c:\tmp\mainwindow.cpp (23): TestProgram.exe!MainWindow::MainWindow + 0x59 bytes
c:\tmp\main.cpp (7): TestProgram.exe!main + 0xA bytes
c:\myqt\4.8.2\src\winmain\qtmain_win.cpp (131): TestProgram.exe!WinMain + 0x12 bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (547): TestProgram.exe!__tmainCRTStartup + 0x2C bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (371): TestProgram.exe!WinMainCRTStartup
0x756233AA (File and line number not available): kernel32.dll!BaseThreadInitThunk + 0x12 bytes
0x77139EF2 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x63 bytes
0x77139EC5 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x36 bytes
Data:
C8 F9 CD 00    38 FD CD 00    28 3B 6E 02                    ....8... (;n.....

---------- Block 2 at 0x00CDF9C8: 20 bytes ----------
Call Stack:
c:\tmp\generatedfiles\ui_mainwindow.h (36): TestProgram.exe!Ui_MainWindow::setupUi + 0x7 bytes
c:\tmp\mainwindow.cpp (26): TestProgram.exe!MainWindow::MainWindow
c:\tmp\main.cpp (7): TestProgram.exe!main + 0xA bytes
c:\myqt\4.8.2\src\winmain\qtmain_win.cpp (131): TestProgram.exe!WinMain + 0x12 bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (547): TestProgram.exe!__tmainCRTStartup + 0x2C bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (371): TestProgram.exe!WinMainCRTStartup
0x756233AA (File and line number not available): kernel32.dll!BaseThreadInitThunk + 0x12 bytes
0x77139EF2 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x63 bytes
0x77139EC5 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x36 bytes
Data:
5C 90 DA 00    18 FA CD 00    38 90 DA 00    00 00 CD CD     \....... 8.......
CC FA CD 00                                                  ........ ........

---------- Block 3 at 0x00CDFD38: 20 bytes ----------
Call Stack:
c:\tmp\generatedfiles\ui_mainwindow.h (38): TestProgram.exe!Ui_MainWindow::setupUi + 0x7 bytes
c:\tmp\mainwindow.cpp (26): TestProgram.exe!MainWindow::MainWindow
c:\tmp\main.cpp (7): TestProgram.exe!main + 0xA bytes
c:\myqt\4.8.2\src\winmain\qtmain_win.cpp (131): TestProgram.exe!WinMain + 0x12 bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (547): TestProgram.exe!__tmainCRTStartup + 0x2C bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (371): TestProgram.exe!WinMainCRTStartup
0x756233AA (File and line number not available): kernel32.dll!BaseThreadInitThunk + 0x12 bytes
0x77139EF2 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x63 bytes
0x77139EC5 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x36 bytes
Data:
24 8F DA 00    88 FD CD 00    00 8F DA 00    00 00 CD CD     $....... ........
3C FE CD 00                                                  <....... ........

---------- Block 4 at 0x026E3B28: 20 bytes ----------
Call Stack:
c:\tmp\generatedfiles\ui_mainwindow.h (41): TestProgram.exe!Ui_MainWindow::setupUi + 0x7 bytes
c:\tmp\mainwindow.cpp (26): TestProgram.exe!MainWindow::MainWindow
c:\tmp\main.cpp (7): TestProgram.exe!main + 0xA bytes
c:\myqt\4.8.2\src\winmain\qtmain_win.cpp (131): TestProgram.exe!WinMain + 0x12 bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (547): TestProgram.exe!__tmainCRTStartup + 0x2C bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (371): TestProgram.exe!WinMainCRTStartup
0x756233AA (File and line number not available): kernel32.dll!BaseThreadInitThunk + 0x12 bytes
0x77139EF2 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x63 bytes
0x77139EC5 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x36 bytes
Data:
24 8F DA 00    78 3B 6E 02    00 8F DA 00    00 00 CD CD     $...x;n. ........
2C 3C 6E 02                                                  ,<n..... ........

---------- Block 6 at 0x026E4200: 8 bytes ----------
Call Stack:
c:\tmp\mainwindow.cpp (28): TestProgram.exe!MainWindow::MainWindow + 0x7 bytes
c:\tmp\main.cpp (7): TestProgram.exe!main + 0xA bytes
c:\myqt\4.8.2\src\winmain\qtmain_win.cpp (131): TestProgram.exe!WinMain + 0x12 bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (547): TestProgram.exe!__tmainCRTStartup + 0x2C bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (371): TestProgram.exe!WinMainCRTStartup
0x756233AA (File and line number not available): kernel32.dll!BaseThreadInitThunk + 0x12 bytes
0x77139EF2 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x63 bytes
0x77139EC5 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x36 bytes
Data:
34 8D DA 00    50 49 6E 02                                   4...PIn. ........

---------- Block 5 at 0x026E4C90: 12 bytes ----------
Call Stack:
c:\tmp\mainwindow.cpp (76): TestProgram.exe!MainWindow::createAudioInput + 0x7 bytes
c:\tmp\mainwindow.cpp (67): TestProgram.exe!MainWindow::initializeAudio
c:\tmp\mainwindow.cpp (28): TestProgram.exe!MainWindow::MainWindow
c:\tmp\main.cpp (7): TestProgram.exe!main + 0xA bytes
c:\myqt\4.8.2\src\winmain\qtmain_win.cpp (131): TestProgram.exe!WinMain + 0x12 bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (547): TestProgram.exe!__tmainCRTStartup + 0x2C bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (371): TestProgram.exe!WinMainCRTStartup
0x756233AA (File and line number not available): kernel32.dll!BaseThreadInitThunk + 0x12 bytes
0x77139EF2 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x63 bytes
0x77139EC5 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x36 bytes
Data:
74 91 DA 00    A0 4B 6E 02    78 50 6E 02                    t....Kn. xPn.....

---------- Block 7 at 0x026E54C8: 8 bytes ----------
Call Stack:
c:\tmp\mainwindow.cpp (29): TestProgram.exe!MainWindow::MainWindow + 0x7 bytes
c:\tmp\main.cpp (7): TestProgram.exe!main + 0xA bytes
c:\myqt\4.8.2\src\winmain\qtmain_win.cpp (131): TestProgram.exe!WinMain + 0x12 bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (547): TestProgram.exe!__tmainCRTStartup + 0x2C bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (371): TestProgram.exe!WinMainCRTStartup
0x756233AA (File and line number not available): kernel32.dll!BaseThreadInitThunk + 0x12 bytes
0x77139EF2 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x63 bytes
0x77139EC5 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x36 bytes
Data:
34 8D DA 00    10 55 6E 02                                   4....Un. ........

---------- Block 8 at 0x026E62D8: 30 bytes ----------
Call Stack:
c:\tmp\mainwindow.cpp (33): TestProgram.exe!MainWindow::MainWindow + 0x7 bytes
c:\tmp\main.cpp (7): TestProgram.exe!main + 0xA bytes
c:\myqt\4.8.2\src\winmain\qtmain_win.cpp (131): TestProgram.exe!WinMain + 0x12 bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (547): TestProgram.exe!__tmainCRTStartup + 0x2C bytes
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (371): TestProgram.exe!WinMainCRTStartup
0x756233AA (File and line number not available): kernel32.dll!BaseThreadInitThunk + 0x12 bytes
0x77139EF2 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x63 bytes
0x77139EC5 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x36 bytes
Data:
CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD           ........ ........ 
```

我感谢任何帮助，以根据这些结果找出内存泄漏的来源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T12:34:32.893

检查您的`main.cpp`文件代码 - 有一些错误。

有一个规则——每个人都`new`必须有它的`delete`。

在您的构造函数中，奇怪的变量`char* str = new char [30];`被声明、分配，但从未被释放。

什么是`m_buffer(BufferSize, 0)`和`m_Inputdevice(QAudioDeviceInfo::defaultInputDevice())`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T12:44:06.643

如果您设置了父对象，请不要显式删除您的 Qt 对象。

[QObjects 在对象树中组织自己](http://qt-project.org/doc/qt-4.8/objecttrees.html)。将 Qt 小部件等作为父级，将小部件的所有权转移给该父级。销毁后，父母将负责清理其孩子。在这些情况下，您`new` **不需要**匹配的`delete`. 事实上，如果你这样做，就会给你带来麻烦。

至少你不需要

```
delete udpSocket;
delete udpSocket1; 
```

根据您的其他代码，您甚至可能不需要

```
delete m_audioInput;
delete ui; 
```

# postgresql - Postgres约束确保存在许多列？

> ID：15178859
> 
> 赞同：37
> 
> 时间：2013-03-02T20:05:26.293
> 
> 标签：postgresql, constraints

有什么好方法可以向 PostgreSQL 添加约束以检查一个列（来自一组列）是否包含非空值？

*更新*：我可能想使用[Create Table](http://www.postgresql.org/docs/9.2/static/sql-altertable.html)和[Alter Table](http://www.postgresql.org/docs/9.2/static/sql-createtable.html)`check`中详述的表达式。

*更新*：我正在查看可用的[功能](http://www.postgresql.org/docs/9.2/static/functions.html)。

*更新*：仅作为背景，这是我目前使用的 Rails 验证逻辑：

```
validate :multi_column_validation
def multi_column_validation
  n = 0
  n += 1 if column_1
  n += 1 if column_2
  n += 1 if column_3
  unless 1 == n
    errors.add(:base, "Exactly one column from " +
      "column_1, column_2, column_3 must be present")
  end
end 
```

需要明确的是，我在这里寻找的是 PSQL，而不是 Ruby。我只是想展示我正在使用的逻辑，因为它比枚举所有“真值表”的可能性更紧凑。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2019-03-18T13:59:10.987

从 PostgreSQL 9.6 开始，您拥有接受任意数量的 VARIADIC 参数的`num_nonnulls`和`num_nulls` [比较函数。](https://www.postgresql.org/docs/10/functions-comparison.html#FUNCTIONS-COMPARISON-FUNC-TABLE)

例如，这将确保三列中的一列不为空。

```
ALTER TABLE your_table
ADD CONSTRAINT chk_only_one_is_not_null CHECK (num_nonnulls(col1, col2, col3) = 1); 
```

## 历史与参考

2016-09-29的[PostgreSQL 9.6.0 发行说明](https://www.postgresql.org/docs/release/9.6.0/)说：

> 添加可变参数函数`num_nulls()`并`num_nonnulls()`计算其参数为 null 或非 null 的数量 (Marko Tiikkaja)

[在 2015-08-12，Marko Tiikkaja](https://www.postgresql.org/message-id/55CB7FF1.70506%40joh.to)在[pgsql-hacker 邮件列表中](https://www.postgresql.org/list/pgsql-hackers/)提出了这个特性：

> 我想建议将 $SUBJECT 包含在 Postgres 9.6 中。我相信每个人都会在他们生活中的某个时刻发现它很有用，而且它不能用 CI 认为以外的任何语言正确实现这一事实说明了我们作为一个项目应该提供它的事实。
> 
> 一个快速而肮脏的概念证明（附补丁）：
> 
> ```
> =# select count_nulls(null::int, null::text, 17, 'bar');
>   count_nulls
> -------------
>             2
> (1 row) 
> ```
> 
> 它的自然栖息地将受到 CHECK 约束，例如：
> 
> ```
>  CHECK (count_nulls(a,b,c) IN (0, 3)) 
> ```

狂热的代码历史学家可以从那时起进行更多讨论。:)

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-03-02T20:35:44.677

**2021-09-17 更新**：截至今天，[gerardnll 提供了更好的答案（最好的 IMO）](https://stackoverflow.com/a/55223096/109618)：

> “从 PostgreSQL 9.6 开始，您拥有 num_nonnulls 和 num_nulls 比较函数，它们可以接受任意数量的 VARIADIC 参数。”

为了帮助人们找到最干净的解决方案，我建议您[支持 gerardnll 的答案](https://stackoverflow.com/a/55223096/109618)。

（仅供参考，我是提出原始问题的同一个人。）

* * *

### 这是我2013年的原始答案

这是一个优雅的两列解决方案，根据[“约束——一个或另一列不为空”PostgreSQL 留言板](http://www.postgresql.org/message-id/20060906142112.GA2657@yagni.com)：

```
ALTER TABLE my_table ADD CONSTRAINT my_constraint CHECK (
  (column_1 IS NULL) != (column_2 IS NULL)); 
```

（但上述方法不能推广到三列或更多列。）

如果您有三列或更多列，则可以使用[a_horse_with_no_name](https://stackoverflow.com/a/15178981/109618)说明的真值表方法。但是，我认为以下内容更易于维护，因为您不必输入逻辑组合：

```
ALTER TABLE my_table
ADD CONSTRAINT my_constraint CHECK (
  (CASE WHEN column_1 IS NULL THEN 0 ELSE 1 END) +
  (CASE WHEN column_2 IS NULL THEN 0 ELSE 1 END) +
  (CASE WHEN column_3 IS NULL THEN 0 ELSE 1 END) = 1; 
```

为了压缩它，创建一个自定义函数以便`CASE WHEN column_k IS NULL THEN 0 ELSE 1 END`删除样板文件会很有用，留下如下内容：

```
(non_null_count(column_1) +
non_null_count(column_2) +
non_null_count(column_3)) = 1 
```

这可能与 PSQL 允许的一样紧凑（？）。也就是说，如果可能的话，我更愿意使用这种语法：

```
non_null_count(column_1, column_2, column_3) = 1 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-03-02T22:23:51.193

我认为最干净和通用的解决方案是创建一个函数来计算某些参数的空值。为此，您可以使用[伪类型`anyarray`](http://www.postgresql.org/docs/9.2/static/extend-type-system.html#EXTEND-TYPES-POLYMORPHIC)和 SQL 函数，如下所示：

```
CREATE FUNCTION count_not_nulls(p_array anyarray)
RETURNS BIGINT AS
$$
    SELECT count(x) FROM unnest($1) AS x
$$ LANGUAGE SQL IMMUTABLE; 
```

使用该功能，您可以创建您的`CHECK CONSTRAINT`as：

```
ALTER TABLE your_table
ADD chk_only_one_is_not_null CHECK(count_not_nulls(array[col1, col2, col3]) = 1); 
```

这仅在列具有相同数据类型时才有效。如果不是这种情况，您可以将它们转换为例如文本（因为您只关心 null 情况）：

```
ALTER TABLE your_table
ADD chk_only_one_is_not_null CHECK(count_not_nulls(array[col1::text, col2::text, col3::text]) = 1); 
```

正如@muistooshort 所记得的那样，您可以使用[可变参数](http://www.postgresql.org/docs/current/interactive/xfunc-sql.html#XFUNC-SQL-VARIADIC-FUNCTIONS)创建函数，这样可以清楚地调用：

```
CREATE FUNCTION count_not_nulls(variadic p_array anyarray)
RETURNS BIGINT AS
$$
    SELECT count(x) FROM unnest($1) AS x
$$ LANGUAGE SQL IMMUTABLE;

ALTER TABLE your_table
ADD chk_only_one_is_not_null CHECK(count_not_nulls(col1, col2, col3) = 1); 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-03-02T22:23:49.933

正如[mu](https://stackoverflow.com/users/479863/mu-is-too-short)所暗示的那样：

```
alter table t
add constraint only_one_null check (
    (col1 is not null)::integer + (col2 is not null)::integer = 1
) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-02T20:16:25.730

有点笨拙，但应该可以解决问题：

```
create table foo
(
   col1 integer,
   col2 integer,
   col3 integer,
   constraint one_is_not_null check 
        (    (col1 is not null and col2 is null and col3 is null) 
          or (col1 is null and col2 is not null and col3 is null)
          or (col1 is null and col2 is null and col3 is not null)
        )
) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-06-06T17:09:26.487

这是使用[内置数组函数](https://www.postgresql.org/docs/10/static/functions-array.html)的解决方案：

```
ALTER TABLE your_table
ADD chk_only_one_is_not_null CHECK (array_length(array_remove(ARRAY[col1, col2, col3], NULL), 1) = 1); 
```

# ios - 非模态 UIImagePickerController，点击聚焦不起作用

> ID：15178860
> 
> 赞同：4
> 
> 时间：2013-03-02T20:05:30.647
> 
> 标签：ios, objective-c, ios6, uiimagepickercontroller

我在非模态设置中使用 UIImagePickerController，如下所示：

```
UIImagePickerController *_imagePickerVC = // init the VC with the main camera as the source
[_mainCameraPreviewContainer addSubview:_imagePickerVC.view];
[_mainCameraPreviewContainer bringSubviewToFront:_imagePickerVC.view]; 
```

这行得通，我可以拍照，但我无法点击预览区域以使相机聚焦在该点上。我尝试通过添加以下两条线中的一条或两条来解决此问题：

```
_imagePickerVC.showsCameraControls = NO;
_imagePickerVC.view.userInteractionEnabled = YES; 
```

但没有运气。当我让它显示相机控件时，我确实得到了闪光模式按钮和选择相机的按钮，但这些按钮也不能点击。是否可以在我的情况下让水龙头专注于工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T18:56:43.847

我重复了你的代码并点击聚焦和按钮工作。（iOS 5.1、6.1）。

```
- (IBAction)buttonTap:(id)sender {
    if (!_imagePickerVC)
    {
        _imagePickerVC = [UIImagePickerController new];
        _imagePickerVC.sourceType = UIImagePickerControllerSourceTypeCamera;
    }

    [self.view addSubview:_imagePickerVC.view];
    [self.view bringSubviewToFront:_imagePickerVC.view];
} 
```

确保`mainCameraPreviewContainer.userInteractionEnabled == YES`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T13:59:00.773

[http://jcuz.wordpress.com/2010/02/17/pickerfocus/](http://jcuz.wordpress.com/2010/02/17/pickerfocus/)你可以试试这个。

我建议你使用 AVfoundation 来实现。它更容易，更灵活。使用 AVFoundation [ios AVFoundation 点击​​聚焦](https://stackoverflow.com/questions/13095007/ios-avfoundation-tap-to-focus)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T05:28:22.467

试试这个，让我知道..

```
_imagePickerVC.view.userInteractionEnabled = YES;
UIPanGestureRecognizer *pgr = [[UITapGestureRecognizer alloc] 
                               initWithTarget:self action:@selector(handleTap:)];

[_imagePickerVC addGestureRecognizer:pgr];
[pgr release];

-(void)handleTap{
    AVCaptureDevice *device = [[self captureInput] device];

    NSError *error;

     if ([device isFocusModeSupported:AVCaptureFocusModeAutoFocus] &&
         [device isFocusPointOfInterestSupported])
     {
         if ([device lockForConfiguration:&error]) {
             [device setFocusPointOfInterest:point];

        CGPoint point = [touch locationInView:self.cameraView];
    point.x /= self.cameraView.frame.size.width;
    point.y /= self.cameraView.frame.size.height;
    [self focusAtPoint:point];

             [device unlockForConfiguration];
         } else {
             NSLog(@"Error: %@", error);
         }
     }
} 
```

# java - Java中的队列操作

> ID：15178866
> 
> 赞同：1
> 
> 时间：2013-03-02T20:05:56.597
> 
> 标签：java, oop, generics, queue

我有一个任务要做，涉及在队列上创建和执行操作......在指令中，他开始说这个......

```
Node Class: You will extend the following class for (some of) the questions below.
   public class Node<T>{
       protected      T  data;
       protected Node<T> next; 
   }
Implement the QUEUE (FIFO) abstract data type. For this, you will create a class called Queue that extends Node<T>. Your class should have the following methods:

public void enqueue(Node<T> item)
// Purpose: adds item to the queue
// Preconditions:  item should exists (not be null)
// Postconditions: item is added to the end of the queue
//                 the size of the queue is increased by 1 
```

...等等，还有几页要求等...

我想知道一些我不明白的事情......是什么`public class Node<T>`意思？（斜体部分）。

此外，除了入队方法之​​外，还有更多方法，所以我假设正确的设计需要我在此方法之外创建队列？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:56:12.133

`Node<T>`允许您使队列的所有节点具有相同的类型，并在编译时指定该类型。

例如，您可以有以下类型的节点：

*   整数
*   细绳
*   YourDefinedJobType

（但只有您指定的单一类型可以进入队列。）

通用表示法要求只有该类型的节点才能排队，这非常方便，因为如果您设置`Node<String>`并尝试添加 YourDefinedJobType 的节点，则会引发运行时错误。

其次，当您开始`Node<String>`工作时，您`Node<YourDefinedJobType>`无需任何额外的队列代码即可开始工作。

此外，您可以保证拥有正确类型的节点，并且不必强制转换它们。

Joshua Bloch 的书*Effective Java*中有一个示例章节，它处理泛型。它当然值得一读，它会回答你关于泛型的问题。

# php - 注意：未定义的偏移量：第 9633 行 /script.php 中的 3

> ID：15178870
> 
> 赞同：0
> 
> 时间：2013-03-02T20:06:21.243
> 
> 标签：php

以下代码正在生成这些消息：

> 注意：未定义的偏移量：第 9633 行 /script.php 中的 3
> 
> 注意：未定义的偏移量：第 9633 行 /script.php 中的 5
> 
> 注意：未定义的偏移量：第 9633 行 /script.php 中的 7
> 
> 注意：未定义的偏移量：第 9633 行 /script.php 中的 9
> 
> 注意：未定义的偏移量：第 9633 行 /script.php 中的 11
> 
> 注意：未定义的偏移量：第 9633 行 /script.php 中的 13
> 
> 注意：未定义的偏移量：第 9633 行 /script.php 中的 15
> 
> 注意：未定义的偏移量：第 9633 行 /script.php 中的 15

事实是该脚本适用于我，但这个“错误”让我担心......有人可以帮助我吗？

```
// fotos
$fotos = $row['guids_fotos'];
$fotos2 = explode('_',$fotos);
$imagenes = $fotos2[1].','.$fotos2[3].','.$fotos2[5].','.$fotos2[7].','.$fotos2[9].','.$fotos2[11].','.$fotos2[13].','.$fotos2[15]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:12:43.733

在你的 $fotos2 变量里面是一个数组；您应该有 1 个或 2 个单元格，这意味着您的变量 $foto 仅包含 1 个或 2 个“_”字符。我认为您的分隔符不是“_”，如果您可以向我们提供 var_dump($fotos) 的结果，它将很有用

# sql-server - 是否可以编写查询来查找没有 JOIN 且没有 ORDER BY 的最大记录？

> ID：15178871
> 
> 赞同：3
> 
> 时间：2013-03-02T20:06:21.927
> 
> 标签：sql-server, tsql

**更新 - 问题**

除了使用自联接之外，是否有**更紧凑的方法来编写从表中选择最大记录的查询？**

例如，可能具有以下架构的事件表：

```
 EventID | EventType | Timestamp | Description
-----------+-----------+-----------+--------------
   INT     | VARCHAR   | INT       | VARCHAR 
```

并且可能包含每种事件类型的多条记录。比方说：

```
 1     |    A      |  100000   | 'First Event'
     2     |    A      |  100005   | 'Second Event'
     3     |    B      |  100009   | 'Third Event'
     4     |    A      |  100009   | 'Fourth Event'
     5     |    B      |  100010   | 'Fifth Event'
     6     |    B      |  100030   | 'Sixth Event'
     7     |    A      |  100030   | ' ... '
     8     |    C      |  100030   | ' ... '
     9     |    C      |  100050   | ' ... ' 
```

假设我想知道每种类型的最新事件是什么——事件#6、#7 和#9。然后我必须编写一个如下所示的查询：

```
SELECT EventID
     , EventType
     , Timestamp
     , Description
  FROM EventsTable T
 INNER JOIN (SELECT EventType
                  , MAX(Timestamp) 
               FROM EventsTable TInner
              GROUP BY EventType) TSelf
         ON T.Timestamp = TSelf.Timestamp
         AND T.EventType = TSelf.EventType 
```

所以问题归结为：**是否有更紧凑的方式来表达相同的查询，理想情况下不必求助于 JOIN**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:28:15.010

尝试这个..

```
SELECT EventID, EventType, Timestamp, Description
FROM EventsTable
WHERE EventType = 'B' AND 
      Timestamp = (SELECT max(Timestamp) FROM EventsTable WHERE EventType = 'B'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:10:43.547

```
SELECT EventID, EventType, Timestamp, Description
FROM EventsTable T
WHERE T.EventType = 'B'
ORDER BY Timestamp
LIMIT 1 
```

应该可以解决问题（对于支持 LIMIT 的 DBMS）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:15:29.827

> 没有意识到您只需要返回一行。使用公用表表达式来实现所需的结果。简单而干净。

```
;WITH CTE
AS
(
    SELECT EventID, 
           EventType, 
           Timestamp,
           Description
    FROM EventsTable 
    WHERE EventType = 'B'
)

SELECT TOP 1 * FROM CTE 
ORDER BY TIMESTAMP DESC 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T20:48:34.080

如果你不想使用 order by 使用这个：

```
SELECT * FROM EventsTable WHERE EventType = 'B' AND
Timestamp = (SELECT Max(Timestamp) FROM EventsTable WHERE EventType = 'B'); 
```

如果订购是可以的：

mysql：

```
SELECT * FROM EventsTable WHERE EventType = 'B' ORDER BY Timestamp DESC LIMIT 1; 
```

Sql 服务器：

```
SELECT TOP 1 * FROM EventsTable WHERE EventType = 'B' ORDER BY Timestamp DESC 
```

请看[小提琴](http://sqlfiddle.com/#!2/4c161/16/0)。

# c# - XNA 全屏 -> 最小化 -> 返回 -> 崩溃

> ID：15178880
> 
> 赞同：0
> 
> 时间：2013-03-02T20:07:13.487
> 
> 标签：c#, xna, 2d, fullscreen, minimize

所以，我在 XNA 中制作 2D 游戏。我一直在窗口模式下开发它，但现在我尝试全屏。它适用于大多数部分，但关键部分失败了，那就是当我通过 Windows 键或 ALT-TAB 退出游戏（散焦）然后返回（这是它崩溃的地方）。

我只使用 SpriteBatches。

它在 Visual Studio 中没有返回任何调试信息，但那是因为图形部分发生了一些不好的事情。

这是 Main 构造函数（最初称为 Game1）

```
 public Main()
      {
        status = StatusIgre.GlavniMenu; 

        Content.RootDirectory = "Content";
        gameEndTimer = new Stopwatch();

        graphics = new GraphicsDeviceManager(this);

        graphics.PreferredBackBufferHeight = GraphicsAdapter.DefaultAdapter.CurrentDisplayMode.Height;
        graphics.PreferredBackBufferWidth = GraphicsAdapter.DefaultAdapter.CurrentDisplayMode.Width;
        graphics.IsFullScreen = true;

    }
    } 
```

我也试过这个：

```
protected override void Initialize()
    {
        //kamera oziroma viewport
        camera = new Camera(new Vector2(400,250), GraphicsDevice);

        previousState = Keyboard.GetState();

        graphics.GraphicsDevice.DeviceLost += new EventHandler<EventArgs>(GraphicsDevice_DeviceLost);

        base.Initialize();
    }

    void GraphicsDevice_DeviceLost(object sender, EventArgs e)
    {
        PresentationParameters parameters = new PresentationParameters();

        parameters.BackBufferHeight =       GraphicsAdapter.DefaultAdapter.CurrentDisplayMode.Height;
        parameters.BackBufferWidth  =  GraphicsAdapter.DefaultAdapter.CurrentDisplayMode.Width;

        GraphicsDevice.Reset(parameters);

    } 
```

还尝试了 GraphicsDevice_DeviceLost 中的“throw Exception()”，但它似乎没有显示任何异常。我猜它甚至没有调用这个函数。

已经在谷歌上搜索过这个，但是这方面的信息很差，主要是 3D（重置缓冲区等）。

那么，有什么建议吗？真心感谢！

# c++ - 使用 Flann opencv 进行层次聚类

> ID：15178882
> 
> 赞同：0
> 
> 时间：2013-03-02T20:07:26.623
> 
> 标签：c++, opencv

我有一个问题，我需要在未知数量的集群中聚类一组点。我使用 opencv 但没有关于`cv::flann::hierarchicalClustering`. 使用此功能的人可以帮助我吗？另一个问题是关于返回值应该是集群的数量，但我怎么能理解哪些是集群？我创建了一个`cv::Mat points`尺寸`n x 2`，其中 n 是点数。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:47:07.553

[这里](http://docs.opencv.org/modules/flann/doc/flann_clustering.html)有这个函数的文档。返回值确实是找到的簇数。我猜你然后使用 Mat& 中心找到 const Mat& features 参数中的每个特征向量属于哪个集群。

# c# - 网站引用了一个使用 NHibernate 与数据库对话的控制台应用程序

> ID：15178883
> 
> 赞同：2
> 
> 时间：2013-03-02T20:07:47.390
> 
> 标签：c#, nhibernate, web-applications

我编写了一个控制台应用程序，它基本上下载一个 XML 文件，对其进行操作并将数据放入数据库中。这个应用程序使用*NHibernate*和*MindScapes* NHibernate 设计器工具。当我将它作为一个独立的东西运行时，它工作得很好。

现在我想创建一个 MVC 网站，当在该网站上单击某个按钮时，我希望它触发控制台应用程序下载适当的 xml 文件并执行它的操作。

我收到一个错误：

> 找不到文件'C:\Dev\WagerWatcher\WagerWatcherWeb\bin\hibernate.cfg.xml'。":"C:\Dev\WagerWatcher\WagerWatcherWeb\bin\hibernate.cfg.xml

`WagerWatcherWeb`是网站，所以我认为它正在*WagerWatcherWeb*项目中查找实际位于“ `WagerWatcher`”项目中的文件。

是否像在某处更改 app.config 文件以重定向到实际文件一样简单？如果是这样，在哪里？我无法自救，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T04:43:35.437

只需将配置文件（在您的控制台应用程序中使用）放置（复制）到已部署*的 web-app*文件夹。阅读：[3.8。XML 配置文件](http://nhforge.org/doc/nh/en/index.html#configuration-xmlconfig)

> 另一种方法是在名为 hibernate.cfg.xml 的文件中指定完整配置。此文件可用作应用程序配置文件的部分`<nhibernate>`或`<hibernate-configuration>`部分的替换。

虽然 Web 应用程序是“运行时” *（只是调用控制台应用程序的 API）*，但它必须提供所有配置。即使对于引用的库...

# c# - 为什么这行代码不起作用？

> ID：15178885
> 
> 赞同：1
> 
> 时间：2013-03-02T20:07:53.160
> 
> 标签：c#, .net, datatable

有人可以告诉我为什么这行代码对我不起作用：

```
DataTable dt = new DataTable();
dt = (DataTable)this.dataGridView_Clients.DataSource; 
```

我想将 DataSource 对象显式转换为 DataTable 但它给了我这个异常：

> Volkswagen App.exe 中出现“System.InvalidCastException”类型的未处理异常
> 
> 附加信息：无法将“System.Windows.Forms.BindingSource”类型的对象转换为“System.Data.DataTable”类型

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T20:10:22.860

因为`DataGridView` `DataSource`是类型`BindingSource`而不是`DataTable`（在你的情况下）。你可以试试这个：

```
dt = (DataTable)((BindingSource)this.dataGridView_Clients.DataSource).DataSource; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:10:32.973

这不起作用，因为 your`Datasource`不是`DataTable`（也不是 a `DataTable`）的子类型。

# linux - 如果 dpkg 或 apt-get 将删除 Ubuntu 上的程序怎么办？

> ID：15178893
> 
> 赞同：-1
> 
> 时间：2013-03-02T20:08:40.310
> 
> 标签：linux, ubuntu, apt-get, dpkg

问题是我安装了一个`.deb`文件，当我尝试用 删除它时`dpkg -r ...`，`dpkg`声称已将其删除。不过，我可以输入“已删除”命令，它仍然有效。

我需要把它取下来，因为我意识到我需要的是一个包含它的更大的程序。当我尝试`make`在较大的程序上运行时，它会尝试将较小的程序与不同的选项一起使用（较大的程序似乎假设较小的程序的更新版本）。

无论如何，我无法摆脱它只是很奇怪。我已经重新安装并尝试使用清除选项，尝试`apt-get clean`，尝试重新启动机器等。

任何想法，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-07T05:54:52.160

尝试这个：

```
rm /var/lib/dpkg/info/program.*
dpkg --remove --force-remove-reinstreq program 
```

将“程序”替换为您要删除的程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:24:50.770

感谢H2CO3：“如果一切都失败了，也许手动删除可执行文件....可执行文件[是]在shell的搜索路径中，如果不存在则不会执行”

```
rm `which flop` 
```

flop 是程序的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:25:38.820

**警告!!!：只有当你知道这个包没有对文件系统做任何疯狂的事情时才这样做！**

下载但不要安装 debian 软件包。然后运行

```
$ touch clean_up.sh
$ chmod +X clean_up.sh
$ gedit clean_up.sh 
```

在文件中添加以下内容：

```
#!/bin/bash

all=$(dpkg -c steam*deb | awk '{print $6}')
for item in $all; do
  #echo "Checking $item"
  item=$(echo $item | sed 's/^\.//g')
  if [[ -d ${item} ]]; then
    #echo "-is a directory. Skipping"
    continue
  fi
  echo "Removing file ${item}"
  sudo rm -f ${item}
done 
```

之后，保存并退出 gedit 并运行：

```
./clean_up.sh 
```

这将删除它在您的系统上静态删除的所有文件。

# android - 如何在 Ruby 和 Android 应用程序之间加密和解密数据？

> ID：15178895
> 
> 赞同：1
> 
> 时间：2013-03-02T20:08:48.833
> 
> 标签：android, ruby-on-rails, cryptography, client-server

我一直在开发一个使用 Ruby on Rails 的 Web 服务器应用程序和一个使用 Android 的客户端应用程序。Web 服务器有一些通往客户端访问的路由，无需身份验证。我想创建一个令牌来验证请求是否来自客户端。我想像这样的解决方案：

1.  创建一个键，例如“stackoverflow;
2.  在客户端和服务器应用程序中共享此密钥；
3.  使用带有生成随机字符串函数 + 密钥的 AES 加密生成令牌；
4.  当客户端应用程序向服务器发送请求时，也发送生成的令牌；
5.  服务器使用共享密钥和 AES 加密验证令牌是否有效。

以下是我的疑问：

1.  这是在他们之间建立沟通的最佳方式吗？
2.  两个系统中是否有 gem/api crypt 和解密？

请不要犹豫，描述一个建议或例子来指导我=）

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:29:18.817

更安全和标准的方法是使用 SSL 客户端证书。

为您的应用程序的每个新版本颁发客户端证书，确保使用只有您自己的证书（即 CA 证书）对其进行签名，或者您的签名 CA 拥有私钥。

设置您的 Web 服务器以在允许连接之前要求客户端证书。设置 Web 服务器以根据您持有的 CA 证书验证证书。

这样就没有可以从您的应用程序中提取的“共享秘密”。如果有人提取并窃取了客户端证书，请使用新证书发布您的应用程序的更新版本，然后将旧证书添加到您 CA 的吊销列表中，或者只是告诉 Web 服务器阻止该特定证书。

无需编写 ruby​​、java 或 javascript 代码。

# algorithm - 从单链表的尾部（或尾部）返回第 k 个元素

> ID：15178901
> 
> 赞同：1
> 
> 时间：2013-03-02T20:09:36.727
> 
> 标签：algorithm, recursion, linked-list

【面试题】

编写一个函数，该函数将在一次传递中返回从整数单链表的尾部（或结尾）开始的第 5 个元素，然后针对该函数提供一组测试用例。

它类似于问题：[如何从单链表的末尾找到第 n 个元素？](https://stackoverflow.com/questions/2598348/how-to-find-nth-element-from-the-end-of-a-singly-linked-list)，但我有一个额外的要求，我们应该只遍历链表一次。

这是我的解决方案：

```
struct Lnode  
{
    int val;
    Lnode* next;
    Lnode(int val, Lnode* next=NULL) : val(val), next(next) {}
};

Lnode* kthFromTail(Lnode* start, int k)
{
   static int count =0;
   if(!start)
        return NULL;

   Lnode* end = kthFromTail(start->next, k);
   if(count==k) end = start;
   count++;
   return end;
} 
```

我只遍历链表一次并使用隐式递归堆栈。另一种方法是有两个指针：快速和慢速，快速的指针比慢速指针快 k 指针。哪个似乎更好？我认为具有两个指针的解决方案将在许多情况下变得复杂，例如：奇数长度列表、偶数长度列表、k > 列表长度等。这个采用递归的方法很干净，涵盖了所有这些情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T20:36:37.733

2 指针解决方案不符合您的要求，因为它遍历列表两次。

您的内存使用更多 - 确切地说是 O(n)。您正在创建一个与列表中的项目数相等的递归堆栈，这远非理想。

要从最后一项中找到第 k 个...

**更好的（单次遍历）解决方案 -[循环缓冲区](https://en.wikipedia.org/wiki/Circular_buffer)：**

使用 O(k) 额外内存。

有一个长度为 k 的数组。

对于每个元素，在数组的下一个位置插入（带环绕）。

最后，只需返回数组中下一个位置的项目。

**2指针解决方案：**

遍历列表两次，但仅使用 O(1) 额外内存。

在开头开始 p [1]和 p [2]。

将 p 增加[1] k 倍。

而 p [1]不在末尾
     增量 p [1]和 p [2]

p [2]指向最后一个元素的第 k 个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T04:34:02.437

```
'n' is user provided value. eg, 5 from last.

int gap=0 , len=0;
myNode *tempNode;

while (currNode is not NULL)
{
 currNode = currNode->next;
 gap = gap+1; 
 if(gap>=n)
   tempNode = currNode;
}
return tempNode; 
```

# performance - 分析多层分布式 Web 应用程序（服务器端）

> ID：15178903
> 
> 赞同：3
> 
> 时间：2013-03-02T20:10:03.517
> 
> 标签：performance, web-services, web-applications, profiling

我想从服务器 PoV中[分析一个复杂的 Web 应用程序。](http://en.wikipedia.org/wiki/Profiling_%28computer_programming%29)

根据上面的维基百科链接和 Stack Overflow`profiling`标签描述，分析（以其一种形式）意味着获取应用程序的 API/组件的列表（或图形表示），每个都包含调用次数和花费的时间它在运行时。

请注意，与传统的单一程序/单一语言不同，Web 服务器应用程序可能是：

*   分布在多台机器上
*   不同的组件可以用不同的语言编写
*   不同的组件可能在不同的操作系统之上运行，等等。

因此，传统的“仅使用分析器”答案并不容易适用于这个问题。

我***不是***在寻找：

*   粗略的性能统计数据，如各种*日志分析工具*（例如模拟）或
*   *客户端的每页*性能统计信息，例如 Google 的 Pagespeed 或 Yahoo! 等工具提供的统计信息 Y!Slow、瀑布图和浏览器组件加载时间）

相反，我正在寻找一个经典的分析器风格的报告：

*   通话次数
*   通话时长

通过功能/API/组件名称，在 Web 应用程序的*服务器端*。

归根结底，问题是：

> ***如何分析一个多层、多平台、分布式的 Web 应用程序？***

基于自由软件的解决方案是首选。

我已经在网上搜索了一段时间的解决方案，除了一些非常昂贵的商业产品外，找不到任何能满足我需求的东西。最后，我硬着头皮，思考了问题，写了自己的解决方案，想免费分享。

我正在发布自己的解决方案[，因为在 SO 上鼓励这种做法](https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/)

该解决方案远非完美，例如，它处于非常高的级别（单个 URL），可能不适用于所有用例。尽管如此，它极大地帮助了我试图了解我的网络应用程序将时间花在哪里。

本着开源和知识共享的精神，我欢迎其他人的任何其他方法和解决方案，尤其是优秀的方法和解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:10:03.517

考虑到传统分析器的工作原理，为这一挑战提出一个通用的免费软件解决方案应该是直截了当的。

让我们把问题分成两部分：

*   收集数据
*   呈现数据

# 收集数据

假设我们可以将 Web 应用程序分解为各个组成部分（API、函数）并测量完成每个部分所花费的时间。每个部分每天被调用数千次，因此我们可以在一整天左右的时间里在多个主机上收集这些数据。当一天结束时，我们将拥有一个相当大且相关的数据集。

***顿悟#1：***用' *URL* '替换' *function* ' ，我们现有的网络日志就是“它”。我们需要的数据已经存在：

 **   Web API 的每个部分都由请求 URL 定义（可能带有一些参数）
*   往返时间（通常以微秒为单位）出现在每一行我们有一天，（周，月）的行，这些数据很方便

因此，如果我们可以访问 Web 应用程序的所有分布式部分的标准 Web 日志，我们的问题的第一部分（收集数据）就解决了。

# 呈现数据

现在我们有了一个大数据集，但仍然没有真正的洞察力。我们如何获得洞察力？

***顿悟#2：***直接可视化我们的（多个）网络服务器日志。

一张图片值一千字。我们可以使用哪张图片？

我们需要将成千上万行或数百万行的多个 Web 服务器日志压缩成一个简短的摘要，这将讲述有关我们性能的大部分故事。换句话说：目标是直接从我们的网络日志中生成类似分析器的报告，甚至更好：图形分析器报告。

想象一下，我们可以映射：

*   一维的调用延迟
*   对另一个维度的调用次数，以及
*   颜色的函数标识（本质上是第三维）

一张这样的图片：下面是 API 延迟的堆积密度图表（函数名称是为了说明目的而编造的）。

# 图表：

![1000 字的故事：通过 API 对 Web 应用程序的堆叠延迟分布](../Images/eae8bd3d4bd0bd1b3024ffef54ba9cd0.png)

## 这个例子的一些观察

*   在我们的应用程序中，我们有一个代表 3 个完全不同的“世界”的三模态分布：
*   最快的响应以大约 300 微秒的延迟为中心。这些响应来自我们的清漆缓存
*   第二快，平均不到 0.01 秒，来自我们的中间层 Web 应用程序（Apache/Tomcat）提供的各种 API
*   最慢的响应，集中在 0.1 秒左右，有时需要几秒钟才能响应，涉及到我们的 SQL 数据库的往返。

我们可以看到应用程序上的缓存效果有多么显着（请注意，x 轴是 log10 刻度）

我们可以明确地看到哪些 API 往往是快的还是慢的，所以我们知道应该关注什么。

我们可以看到每天最常调用哪些 API。我们还可以看到其中一些很少被调用，甚至很难在图表上看到它们的颜色。

# 怎么做？

第一步是预处理并从日志中提取所需数据的子集。在这里，在多个日志上使用像 Unix ' *cut* ' 这样的简单实用程序可能就足够了。您可能还需要将多个相似的 URL 折叠成更短的字符串来描述功能/API，例如“注册”或“购买”。如果你有一个由负载均衡器生成的多主机统一日志视图，这个任务可能会更容易。我们只提取 API (URL) 的名称及其延迟，因此我们最终得到一个包含一对列的大文件，由 TAB 分隔

```
*API_Name   Latency_in_microSecs*

func_01    32734
func_01    32851
func_06    598452
...
func_11    232734 
```

现在我们在结果数据对上运行下面的 R 脚本来生成想要的图表（使用 Hadley Wickham 的精彩*ggplot2*库）。 *瞧！*

# 生成图表的代码

最后，这是从 API+Latency TSV 数据文件生成图表的代码：

```
#!/usr/bin/Rscript --vanilla
#
# Generate stacked chart of API latencies by API from a TSV data-set
#
# ariel faigon - Dec 2012
#
.libPaths(c('~/local/lib/R',
         '/usr/lib/R/library',
         '/usr/lib/R/site-library'
))

suppressPackageStartupMessages(library(ggplot2))
# grid lib needed for 'unit()':
suppressPackageStartupMessages(library(grid))

#
# Constants: width, height, resolution, font-colors and styles
# Adapt to taste
#
wh.ratio = 2
WIDTH = 8
HEIGHT = WIDTH / wh.ratio
DPI = 200
FONTSIZE = 11
MyGray = gray(0.5)

title.theme   = element_text(family="FreeSans", face="bold.italic",
                        size=FONTSIZE)
x.label.theme = element_text(family="FreeSans", face="bold.italic",
                        size=FONTSIZE-1, vjust=-0.1)
y.label.theme = element_text(family="FreeSans", face="bold.italic",
                       size=FONTSIZE-1, angle=90, vjust=0.2)
x.axis.theme  = element_text(family="FreeSans", face="bold",
                        size=FONTSIZE-1, colour=MyGray)
y.axis.theme  = element_text(family="FreeSans", face="bold",
                        size=FONTSIZE-1, colour=MyGray)

#
# Function generating well-spaced & well-labeled y-axis (count) breaks
#
yscale_breaks <- function(from.to) {
    from <- 0
    to <- from.to[2]
    # round to 10 ceiling
    to <- ceiling(to / 10.0) * 10
    # Count major breaks on 10^N boundaries, include the 0
    n.maj = 1 + ceiling(log(to) / log(10))
    # if major breaks are too few, add minor-breaks half-way between them
    n.breaks <- ifelse(n.maj < 5, max(5, n.maj*2+1), n.maj)
    breaks <- as.integer(seq(from, to, length.out=n.breaks))
    breaks
}

#
# -- main
#

# -- process the command line args:  [tsv_file [png_file]]
#    (use defaults if they aren't provided)
#
argv <- commandArgs(trailingOnly = TRUE)
if (is.null(argv) || (length(argv) < 1)) {
    argv <- c(Sys.glob('*api-lat.tsv')[1])
}
tsvfile <- argv[1]
stopifnot(! is.na(tsvfile))
pngfile <- ifelse(is.na(argv[2]), paste(tsvfile, '.png', sep=''), argv[2])

# -- Read the data from the TSV file into an internal data.frame d
d <- read.csv(tsvfile, sep='\t', head=F)

# -- Give each data column a human readable name
names(d) <- c('API', 'Latency')

#
# -- Convert microseconds Latency (our weblog resolution) to seconds
#
d <- transform(d, Latency=Latency/1e6)

#
# -- Trim the latency axis:
#       Drop the few 0.001% extreme-slowest outliers on the right
#       to prevent them from pushing the bulk of the data to the left
Max.Lat <- quantile(d$Latency, probs=0.99999)
d <- subset(d, Latency < Max.Lat)

#
# -- API factor pruning
#       Drop rows where the APIs is less than small % of total calls
#
Rare.APIs.pct <- 0.001
if (Rare.APIs.pct > 0.0) {
    d.N <- nrow(d)
    API.counts <- table(d$API)
    d <- transform(d, CallPct=100.0*API.counts[d$API]/d.N)
    d <- d[d$CallPct > Rare.APIs.pct, ]
    d.N.new <- nrow(d)
}

#
# -- Adjust legend item-height &font-size
#    to the number of distinct APIs we have
#
API.count <- nlevels(as.factor(d$API))
Legend.LineSize <- ifelse(API.count < 20, 1.0, 20.0/API.count)
Legend.FontSize <- max(6, as.integer(Legend.LineSize * (FONTSIZE - 1)))
legend.theme  = element_text(family="FreeSans", face="bold.italic",
                        size=Legend.FontSize,
                        colour=gray(0.3))

# -- set latency (X-axis) breaks and labels (s.b made more generic)
lat.breaks <- c(0.00001, 0.0001, 0.001, 0.01, 0.1, 1, 10)
lat.labels <- sprintf("%g", lat.breaks)
#
# -- Generate the chart using ggplot
#
p <- ggplot(data=d, aes(x=Latency, y=..count../1000.0, group=API, fill=API)) +
   geom_bar(binwidth=0.01) +
      scale_x_log10(breaks=lat.breaks, labels=lat.labels) +
      scale_y_continuous(breaks=yscale_breaks) +
      ggtitle('APIs Calls & Latency Distribution') +
      xlab('Latency in seconds - log(10) scale') +
      ylab('Call count (in 1000s)') +
      theme(
            plot.title=title.theme,
            axis.title.y=y.label.theme,
            axis.title.x=x.label.theme,
            axis.text.x=x.axis.theme,
            axis.text.y=y.axis.theme,
            legend.text=legend.theme,
            legend.key.height=unit(Legend.LineSize, "line")
      )

#
# -- Save the plot into the png file
#
ggsave(p, file=pngfile, width=WIDTH, height=HEIGHT, dpi=DPI) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-03T01:26:38.023

您对“过去”分析实践的讨论是正确的。它总是有一个小问题：

*   在非玩具软件中，它可能会找到一些东西，但找不到太多，[*原因有很多*](https://stackoverflow.com/a/1779343/23771)。

获得更高性能的机会是，如果你没有找到它们，软件不会崩溃，所以*你可以假装它们不存在*。也就是说，直到尝试了不同的方法并找到了它们。

在统计学中，这被称为 2 型错误——*假阴性*。机会就在那里，但你没有找到。这意味着，如果有人*确实*知道如何找到它，他们就会大获全胜。 [*这里可能比你想知道的更多。*](https://scicomp.stackexchange.com/a/2719/1262)

因此，如果您在 Web 应用程序中查看相同类型的内容 - 调用计数、时间测量，您不会比相同类型的非结果更好。

我不喜欢网络应用程序，但多年前我在基于协议的工厂自动化应用程序中进行了大量的性能调整。我使用了日志记录技术。我不会说这很容易，但它确实奏效了。我看到做类似事情的人在[这里，他们使用他们所谓的*瀑布图*](http://www.strangeloopnetworks.com/blog/how-to-use-a-waterfall-chart-to-interpret-web-performance-data/)。基本思想是，与其撒下一张大网并进行大量测量，不如通过单个事务逻辑线程进行跟踪，分析哪些地方发生了不必要的延迟。

所以如果结果是你所追求的，我会看不起这种思路。*

# javascript - 使用 Testacular、PhantomJS、Jasmine 的 Javascript 控制台输出

> ID：15178912
> 
> 赞同：2
> 
> 时间：2013-03-02T20:10:24.310
> 
> 标签：javascript, jasmine, phantomjs, karma-runner

有什么方法可以在无头运行 testacular（使用 PhantomJS 和 Jasmine）时通过 console.log() 或其他机制写入标准输出？我知道我可以启动 Firefox 或 Chrome 并查看那里的日志输出，但理想情况下，我希望在测试脚本中发出信息以进行调试或故障分析。

各种文档似乎表明要求“系统”将/可能提供这种能力，但 RequireJS 不能很好地与我正在尝试测试的其余代码配合使用（我从 RequireJS 内部抛出异常）。

# c# - 复杂的“包含”字符串比较

> ID：15178922
> 
> 赞同：17
> 
> 时间：2013-03-02T20:11:35.760
> 
> 标签：c#, string-comparison

我正在开发一个 C# 4.5 应用程序，我需要一个函数来返回 true 以进行以下比较：

> "bla LéOnAr d/o bla".ComplexContains("leonardo")

换句话说，我`string.Compare(str1, str2, CultureInfo.InvariantCulture, CompareOptions.IgnoreCase | CompareOptions.IgnoreSymbols | CompareOptions.IgnoreNonSpace)`还需要检查“包含！

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-03-02T20:14:34.477

您可以使用适当的`CompareInfo`then[`CompareInfo.IndexOf(string, string, CompareOptions)`](http://msdn.microsoft.com/en-us/library/b7zs7dcf.aspx)并对照 -1 检查结果。样本：

```
using System;
using System.Globalization;

class Program
{
    static void Main()
    {
        var compareInfo = CultureInfo.InvariantCulture.CompareInfo;
        var options = CompareOptions.IgnoreCase | 
            CompareOptions.IgnoreSymbols |
            CompareOptions.IgnoreNonSpace;

        var haystack = "bla Lé OnAr d/o bla";
        var needle = "leonardo";

        var index = compareInfo.IndexOf(haystack, needle, options);
        Console.WriteLine(index); // 4
    }
} 
```

或以方法形式：

```
private static bool ComplexContains(string source, string value)
{
    var index = CultureInfo.InvariantCulture.CompareInfo.IndexOf
        (source, value, CompareOptions.IgnoreCase | 
         CompareOptions.IgnoreSymbols | CompareOptions.IgnoreNonSpace);
    return index != -1;
} 
```

# visual-studio-2012 - 这个 -vsdoc 文件有什么问题？

> ID：15178926
> 
> 赞同：0
> 
> 时间：2013-03-02T20:12:09.283
> 
> 标签：visual-studio-2012, javascript-intellisense, vsdoc

我有一个脚本 retry.js，其中包含：

```
function retryAjax(load, count, config) {
} 
```

显然它有一个主体，但这没关系，因为无论我是否在脚本中有主体，都会出现这个问题。

为了记录这个函数返回的对象，我还有一个辅助的 -vsdoc.js 文件，retry-vsdoc.js：

```
function RetryAjaxDeferred() {
    /// <summary>Returned from retryAjax. A jQuery Ajax Deferred object extended to support failWillRetry()</summary>

    this.done = function (success) {
        /// <summary>A callback when the Ajax call succeeds.</summary>
        /// <param name="success" type="Function">Success callback</param>
    }

    this.fail = function (error) {
        /// <summary>A callback when the Ajax call fails permanently.</summary>
        /// <param name="error" type="Function">Fail callback</param>
    }

    this.failWillRetry = function (willRetry) {
        /// <summary>A callback when the Ajax call fails with retries pending.</summary>
        /// <param name="willRetry" type="Function">Fail callback</param>
    }
}; 
```

奇怪的是，如果我删除 -vsdoc.js 文件，Visual Studio 2012 中的 Intellisense 对 retry.js 工作正常（当然，我对它返回的内容没有真正的帮助）。如果我将 -vsdoc.js 保留在原位，则 Intellisense 不再可以使用 retryAjax 函数 - 它不会在键入参数时自动完成或显示 Intellisense 信息。然而，RetryAjaxDeferred 函数在 Intellisense 中确实变得活跃。

显然，-vsdoc.js 文件中的某些内容以某种方式破坏了 retry.js 的 Intellisense，而没有破坏到足以防止其自身内容消失的程度。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:48:49.803

找到它 - 在为 Visual Studio 添加额外的仅 Intellisense 类等时，您需要参考实际的源文件：

```
/// <reference path="~/ui/retry.js"/>
function RetryAjaxDeferred() {
    . . . 
```

现在，当我在其他脚本和页面中引用 retry.js 时，它及其 -vsdoc 文件的内容都是 Intellisense 结果的一部分。

# java - Maven GAE 原型不起作用

> ID：15178931
> 
> 赞同：3
> 
> 时间：2013-03-02T20:12:17.447
> 
> 标签：java, spring, google-app-engine, maven-3, maven-gae-plugin

我正在尝试将谷歌应用引擎用于带有 maven 的简单的基于弹簧的应用程序。我发现这种 web 应用程序有 maven 原型可用（没有 spring，但我可以自己添加）：Maven GAE。

所以我使用了以下命令：

```
mvn archetype:generate -DarchetypeGroupId=net.kindleit -DarchetypeArtifactId=gae-archetype-jsp -DgroupId=com.example -DartifactId=form -DarchetypeRepository=http://maven-gae-plugin.googlecode.com/svn/repository 
```

但是，当我尝试使用“mvn gae:run”时它不起作用，我不知道如何解决这个缺失的要求：

```
[INFO] BUILD FAILURE
    [INFO] ------------------------------------------------------------------------
    [INFO] Total time: 7.444s
    [INFO] Finished at: Sat Mar 02 21:04:22 CET 2013
    [INFO] Final Memory: 6M/15M
    [INFO] ------------------------------------------------------------------------
    [ERROR] Failed to execute goal net.kindleit:maven-gae-plugin:0.9.5:run (default-cli) on project form: Execution default-cli of goal net.kindleit:maven-gae-plugin:0.9.5:run failed: Plugin net.kindleit:maven-gae-plugin:0.9.5 or one of its dependencies could not be resolved: Failed to collect dependencies for net.kindleit:maven-gae-plugin:jar:0.9.5 (): Failed to read artifact descriptor for net.kindleit:gae-runtime:pom:1.7.5: Failure to find net.kindleit:maven-gae-parent:pom:0.9.6-SNAPSHOT in http://download.java.net/maven/2/ was cached in the local repository, resolution will not be reattempted until the update interval of maven2-repository.dev.java.net has elapsed or updates are forced -> [Help 1]
    org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal net.kindleit:maven-gae-plugin:0.9.5:run (default-cli) on project form: Execution default-cli of goal net.kindleit:maven-gae-plugin:0.9.5:run failed: Plugin net.kindleit:maven-gae-plugin:0.9.5 or one of its dependencies could not be resolved: Failed to collect dependencies for net.kindleit:maven-gae-plugin:jar:0.9.5 ()
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:225)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
    Caused by: org.apache.maven.plugin.PluginExecutionException: Execution default-cli of goal net.kindleit:maven-gae-plugin:0.9.5:run failed: Plugin net.kindleit:maven-gae-plugin:0.9.5 or one of its dependencies could not be resolved: Failed to collect dependencies for net.kindleit:maven-gae-plugin:jar:0.9.5 ()
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:82)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
        ... 19 more
    Caused by: org.apache.maven.plugin.PluginResolutionException: Plugin net.kindleit:maven-gae-plugin:0.9.5 or one of its dependencies could not be resolved: Failed to collect dependencies for net.kindleit:maven-gae-plugin:jar:0.9.5 ()
        at org.apache.maven.plugin.internal.DefaultPluginDependenciesResolver.resolve(DefaultPluginDependenciesResolver.java:211)
        at org.apache.maven.plugin.internal.DefaultMavenPluginManager.createPluginRealm(DefaultMavenPluginManager.java:353)
        at org.apache.maven.plugin.internal.DefaultMavenPluginManager.setupPluginRealm(DefaultMavenPluginManager.java:321)
        at org.apache.maven.plugin.DefaultBuildPluginManager.getPluginRealm(DefaultBuildPluginManager.java:175)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:78)
        ... 20 more
    Caused by: org.sonatype.aether.collection.DependencyCollectionException: Failed to collect dependencies for net.kindleit:maven-gae-plugin:jar:0.9.5 ()
        at org.sonatype.aether.impl.internal.DefaultDependencyCollector.collectDependencies(DefaultDependencyCollector.java:258)
        at org.sonatype.aether.impl.internal.DefaultRepositorySystem.collectDependencies(DefaultRepositorySystem.java:308)
        at org.apache.maven.plugin.internal.DefaultPluginDependenciesResolver.resolve(DefaultPluginDependenciesResolver.java:199)
        ... 24 more
    Caused by: org.sonatype.aether.resolution.ArtifactDescriptorException: Failed to read artifact descriptor for net.kindleit:gae-runtime:pom:1.7.5
        at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.loadPom(DefaultArtifactDescriptorReader.java:331)
        at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.readArtifactDescriptor(DefaultArtifactDescriptorReader.java:186)
        at org.sonatype.aether.impl.internal.DefaultDependencyCollector.process(DefaultDependencyCollector.java:412)
        at org.sonatype.aether.impl.internal.DefaultDependencyCollector.collectDependencies(DefaultDependencyCollector.java:240)
        ... 26 more
    Caused by: org.apache.maven.model.resolution.UnresolvableModelException: Failure to find net.kindleit:maven-gae-parent:pom:0.9.6-SNAPSHOT in http://download.java.net/maven/2/ was cached in the local repository, resolution will not be reattempted until the update interval of maven2-repository.dev.java.net has elapsed or updates are forced
        at org.apache.maven.repository.internal.DefaultModelResolver.resolveModel(DefaultModelResolver.java:126)
        at org.apache.maven.model.building.DefaultModelBuilder.readParentExternally(DefaultModelBuilder.java:813)
        at org.apache.maven.model.building.DefaultModelBuilder.readParent(DefaultModelBuilder.java:664)
        at org.apache.maven.model.building.DefaultModelBuilder.build(DefaultModelBuilder.java:310)
        at org.apache.maven.model.building.DefaultModelBuilder.build(DefaultModelBuilder.java:232)
        at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.loadPom(DefaultArtifactDescriptorReader.java:322)
        ... 29 more
    Caused by: org.sonatype.aether.resolution.ArtifactResolutionException: Failure to find net.kindleit:maven-gae-parent:pom:0.9.6-SNAPSHOT in http://download.java.net/maven/2/ was cached in the local repository, resolution will not be reattempted until the update interval of maven2-repository.dev.java.net has elapsed or updates are forced
        at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolve(DefaultArtifactResolver.java:538)
        at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolveArtifacts(DefaultArtifactResolver.java:216)
        at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolveArtifact(DefaultArtifactResolver.java:193)
        at org.apache.maven.repository.internal.DefaultModelResolver.resolveModel(DefaultModelResolver.java:122)
        ... 34 more
    Caused by: org.sonatype.aether.transfer.ArtifactNotFoundException: Failure to find net.kindleit:maven-gae-parent:pom:0.9.6-SNAPSHOT in http://download.java.net/maven/2/ was cached in the local repository, resolution will not be reattempted until the update interval of maven2-repository.dev.java.net has elapsed or updates are forced
        at org.sonatype.aether.impl.internal.DefaultUpdateCheckManager.newException(DefaultUpdateCheckManager.java:230)
        at org.sonatype.aether.impl.internal.DefaultUpdateCheckManager.checkArtifact(DefaultUpdateCheckManager.java:204)
        at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolve(DefaultArtifactResolver.java:427)
        ... 37 more 
```

可以补充一点，我尝试使用不同版本的 maven-gae-plugin 但没有成功....

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-03T05:08:30.793

[和这里](https://stackoverflow.com/questions/15094381/mvn-gae-plugin-suddenly-broken/15123921#15123921)一样。

你能试试这个吗？

```
<properties>
  <gae.version>1.7.5</gae.version>
  <gae-runtime.version>1.7.5.1</gae-runtime.version>
</properties>

<plugin>
  <groupId>net.kindleit</groupId>
  <artifactId>maven-gae-plugin</artifactId>
  <version>${maven.gae.plugin.version}</version>
  <configuration>
        <unpackVersion>${gae.version}</unpackVersion>
        <serverId>appengine.google.com</serverId>
        <appDir>${webappDirectory}</appDir>
    </configuration>
    <dependencies>
        <dependency>
            <groupId>net.kindleit</groupId>
            <artifactId>gae-runtime</artifactId>
            <version>${gae-runtime.version}</version>
            <type>pom</type>
        </dependency>
    </dependencies>
</plugin> 
```

# php - 从对象显示站点中的图像

> ID：15178933
> 
> 赞同：0
> 
> 时间：2013-03-02T20:12:23.100
> 
> 标签：php, php-gd

如果您知道如何开发我真正想做的事情，请告诉我。

我有一个代码可以创建这样的图像（类似于验证码）：

```
/* createImg.php */

class createImg{
public function __construct(){
    /*stuff here*/
}

public function showImg(){
    /*stuff here*/
    header("Content-type: image/png");
    imagepng($image);
    imagedestroy($image);
}
}
$img = new createImg();
$img->showImg(); 
```

我创建图像的方法如下：

```
/* index.php */
echo '<img src="createImg.php" />'; 
```

一切正常，但我想做的是以下事情，但我不知道如何实现它：

```
/* index.php */
$img = new createImg();
//and now something like this
echo '<img src="$img->showImg()" />'; 
```

我遇到的问题是，如果我使用这种方式，由于函数中的标题，我会在主屏幕中获得图像。有什么办法可以做我想做的事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:45:22.397

一般来说，您不能在 HTML 页面的中间输出原始图像数据，而这正是您的`echo`声明试图做的事情。

存在有限的机制，例如[data: URI scheme](http://en.wikipedia.org/wiki/Data_URI_scheme)，但它们有重要的限制需要注意，并且可能不适合大多数情况。

相反，您需要有某种方法为您的图像生成一个 URL，其中包含足够的信息来创建正确的图像。对于一个简单的情况，这可能只是类似`"/img.php?width=100&height=100&colour=red"`.

由于您将您的用例描述为“类似于 CAPTCHA”，因此这可能会更复杂，并且可能还需要进行混淆处理，而不仅仅是拼写 URL 中的内容。因此，您需要在服务器端存储一些东西；我可以想到几种方法：

1.  您可以将图像数据或生成它所需的输入写入 PHP 会话。会话的常见问题，例如锁定，适用。
2.  您可以将数据保存到数据库中，给它一个唯一的键；图像 URL 可能类似于`"/img.php?unique_id=42"`.
3.  您可以将生成的图像保存到磁盘，给它一个唯一的文件名。这显然需要某种“垃圾收集”机制，否则您的磁盘最终会被所有这些图像文件填满。

# asp.net - 在 DropDownList 中触发事件

> ID：15178935
> 
> 赞同：2
> 
> 时间：2013-03-02T20:12:31.873
> 
> 标签：asp.net, webforms

该`DropdownListDecks_SelectedIndexChanged`过程永远不会被调用。

```
<asp:DropDownList
        ID="DropDownListDecks"
        runat="server" 
        DataSourceID="EntityDataSourceDecks"
        DataTextField="DeckName"
        viewStateMode="Enabled" 
        DataValueField="DeckBackImageString" 
        CausesValidation="True" 
        onselectedindexchanged="DropDownListDecks_SelectedIndexChanged">
</asp:DropDownList> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T20:19:22.367

`autopostback=true`在 ASP DropDownList 控件中设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:22:12.353

如果您使用 mvc 框架，那么这不是创建下拉列表的方法。

但在您的情况下，只需将 autopostback 属性设置为 true。

自动回发=“真”

# java - ProcessBuilder 可以启动 jar 但不承认 jar 的参数

> ID：15178937
> 
> 赞同：2
> 
> 时间：2013-03-02T20:12:35.700
> 
> 标签：java, processbuilder

我正在尝试在正在运行的 java 程序中运行 jmol 的 jar。这就是我在命令行中运行它的方式，它运行良好。

```
$ java -jar Jmol.jar 1644_____.pdb -o -J "measure 3 4;measure 1 2" 
```

我正在使用 ProcessBuilder，它正确调用了 jar 文件和第一个参数，但没有正确调用其余参数。我错过了什么？

```
import java.io.IOException;

class test{
    public static void main(String [] ar) throws Exception{
        run();
    }

    public static void run() throws IOException, InterruptedException{
        String INPUTPDB = "1644_____.pdb";
        String args[] = {"java", "-jar", "Jmol.jar", INPUTPDB, "-o", "-J", "\"measure 3 4;measure1 2\""};
        ProcessBuilder pb = new ProcessBuilder(args);
        //Runtime.getRuntime().exec(args);
        Process p = pb.start();
        p.waitFor();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T20:53:12.580

据我了解，您传递给的每个参数都`ProcessBuilder`将作为单独的参数传递给进程。

这意味着当流程执行等效的 时`args[x]`，您的`\"measure 3 4;measure1 2\"`参数将看起来像`"measure 3 4;measure1 2"`流程（包括引号）。

除非命令需要引号，否则不需要引用参数

相反，尝试类似

```
String args[] = {"java", "-jar", "Jmol.jar", INPUTPDB, "-o", "-J", "measure 3 4;measure1 2"}; 
```

# security - 防止/避免核心转储？

> ID：15178941
> 
> 赞同：1
> 
> 时间：2013-03-02T20:13:09.693
> 
> 标签：security

核心转储是一个安全问题，但我没有看到任何关于如何处理它的文献。

我想，解决方案是使用“结构化异常处理”来捕获所有异常/信号并处理它们，或者如果它们是致命的，则抢先清空内存？

是否有一些设置可以影响禁用核心转储？

主要是在 Windows 桌面平台上，但我想知道是否还有 Linux 解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:24:01.890

在 Linux 上，我相信您可以使用以下内容：

```
ulimit -c 0 
```

参见例如[http://www.manpagez.com/man/1/ulimit/](http://www.manpagez.com/man/1/ulimit/)。

# android - android原生中的eval，如何去做

> ID：15178945
> 
> 赞同：0
> 
> 时间：2013-03-02T20:13:23.860
> 
> 标签：android, android-ndk

我们正在android中开发一个应用程序，但是似乎无法使用eval函数（没有eval函数）。我们需要为这个应用程序指定和调整算法（并设置不同的变量），但是如果没有 eval 函数，最好的方法是什么？我们不使用java。

# android - Android：将数据从数据库绑定到列表视图

> ID：15178956
> 
> 赞同：1
> 
> 时间：2013-03-02T20:14:16.833
> 
> 标签：android, database, listview

我正在尝试从我的 SQLite DB 中提取数据并将其显示在列表视图中，这是我目前所拥有的，但它只将第一条记录放在列表视图中。我认为“while (mCursor.moveToNext()){”位需要更改，但不确定如何更改。原始代码每次将每条记录放在一个新行的文本视图中。

```
 if (mCursor == null){
        mCursor.close();
        Log.w("cursor", "null cursor");
    }       

        mCursor.moveToFirst();
    String[] s = null;

    while (mCursor.moveToNext()){

        s = new String[] { foodNameColumn, proteinColumn, fatColumn, carbsColumn };

        mCursor.moveToNext();
    }

    SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, 
            R.layout.aa_four_column,
            mCursor, 
            s, 
            new int[] { R.id.txtCol1, R.id.txtCol2, R.id.txtCol3, R.id.txtCol4 }, 0);

    lvDB.setAdapter(adapter); 
```

**更新：**

我已经改变了它，所以只有这个代码在 onCreate 方法中，但同样的事情发生了，当数据库中有多个东西时显示一个项目。

```
 mCursor = dataBase.select("SELECT * FROM " + TABLE_NAME);

        SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, 
                    R.layout.aa_four_column,
                    mCursor, 
                    new String[] { foodNameColumn, proteinColumn, fatColumn, carbsColumn }, 
                    new int[] { R.id.txtCol1, R.id.txtCol2, R.id.txtCol3, R.id.txtCol4 }, 0);

        lvDB.setAdapter(adapter);

aa_column_four.xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/txtCol1"
        android:layout_width="181dp"
        android:layout_height="wrap_content"
        android:text="Column 1 text will end up here!" />

    <TextView
        android:id="@+id/txtCol2"
        android:layout_width="63dp"
        android:layout_height="wrap_content"
        android:text="Column 2 text will end up here!" />

    <TextView
        android:id="@+id/txtCol3"
        android:layout_width="96dp"
        android:layout_height="wrap_content"
        android:text="Column 3 text will end up here!" />

    <TextView
        android:id="@+id/txtCol4"
        android:layout_width="104dp"
        android:layout_height="wrap_content"
        android:text="Column 4 text will end up here!" />

</LinearLayout> 
```

**数据库管理器类**

```
 public class DataBaseManager extends SQLiteOpenHelper {

    //the MAIN package of your project
    private static String DB_PATH = "/data/data/com.example.activities/databases/";

    //the name of your database
    private static String DB_NAME = "DB_Nutrition";

    private static SQLiteDatabase mDataBase;

    private static DataBaseManager sInstance = null;
    // database version   
    private static final int DATABASE_VERSION = 1;

    /**
     * Constructor Takes and keeps a reference of the passed context in order to
     * access to the application assets and resources.
     */
    DataBaseManager() {
        super(ApplicationContextProvider.getContext(), DB_NAME, null, DATABASE_VERSION);

        try {
            createDataBase();
            openDataBase();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    /**
     * Singleton for DataBase
     *
     * @return singleton instance
     */
    public static DataBaseManager instance() {

        if (sInstance == null) {
            sInstance = new DataBaseManager();
        }
        return sInstance;
    }

    /**
     * Creates a empty database on the system and rewrites it with your own
     * database.
     *
     * @throws java.io.IOException io exception
     */
    private void createDataBase() throws IOException {

        boolean dbExist = checkDataBase();

        if (dbExist) {
            // do nothing - database already exist
        } else {

            // By calling this method an empty database will be created into
            // the default system path
            // of your application so we are gonna be able to overwrite that
            // database with our database.
            this.getReadableDatabase();

            try {

                copyDataBase();

            } catch (IOException e) {

                throw new Error("Error copying database");
            }
        }
    }

    /**
     * Check if the database already exist to avoid re-copying the file each
     * time you open the application.
     *
     * @return true if it exists, false if it doesn't
     */
    private boolean checkDataBase() {

        SQLiteDatabase checkDB = null;

        try {
            String myPath = DB_PATH + DB_NAME;
            checkDB = SQLiteDatabase.openDatabase(myPath, null,
                    SQLiteDatabase.OPEN_READONLY);

        } catch (SQLiteException e) {

            // database doesn't exist yet.

        }

        if (checkDB != null) {

            checkDB.close();

        }

        return checkDB != null;
    }

    /**
     * Copies your database from your local assets-folder to the just created
     * empty database in the system folder, from where it can be accessed and
     * handled. This is done by transfering bytestream.
     *
     * @throws java.io.IOException io exception
     */
    public void copyDataBase() throws IOException {

        // Open your local db as the input stream
        InputStream myInput = ApplicationContextProvider.getContext().getAssets().open(DB_NAME);

        // Path to the just created empty db
        String outFileName = DB_PATH + DB_NAME;

        // Open the empty db as the output stream
        OutputStream myOutput = new FileOutputStream(outFileName);

        // transfer bytes from the inputfile to the outputfile
        byte[] buffer = new byte[1024];
        int length;
        while ((length = myInput.read(buffer)) > 0) {
            myOutput.write(buffer, 0, length);
        }

        // Close the streams
        myOutput.flush();
        myOutput.close();
        myInput.close();

    }

    private void openDataBase() throws SQLException {

        // Open the database
        String myPath = DB_PATH + DB_NAME;
        mDataBase = SQLiteDatabase.openDatabase(myPath, null,
                SQLiteDatabase.OPEN_READWRITE);
    }

    /**
     * Select method
     *
     * @param query select query
     * @return - Cursor with the results
     * @throws android.database.SQLException sql exception
     */
    public Cursor select(String query) throws SQLException {
        return mDataBase.rawQuery(query, null);
    }

    /**
     * Insert method
     *
     * @param table  - name of the table
     * @param values values to insert
     * @throws android.database.SQLException sql exception
     */
    public void insert(String table, ContentValues values) throws SQLException {
        mDataBase.insert(table, null, values);
    }

    /**
     * Delete method
     *
     * @param table - table name
     * @param where WHERE clause, if pass null, all the rows will be deleted
     * @throws android.database.SQLException sql exception
     */
    public void delete(String table, String where) throws SQLException {

        mDataBase.delete(table, where, null);

    }

    /**
     * Update method
     *
     * @param table  - table name
     * @param values - values to update
     * @param where  - WHERE clause, if pass null, all rows will be updated
     */
    public void update(String table, ContentValues values, String where) {

        mDataBase.update(table, values, where, null);

    }

    /**
     * Let you make a raw query
     *
     * @param command - the sql comand you want to run
     */
    public void sqlCommand(String command) {
        mDataBase.execSQL(command);
    }

    @Override
    public synchronized void close() {

        if (mDataBase != null)
            mDataBase.close();

        super.close();

    }

    @Override
    public void onCreate(SQLiteDatabase db) {

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

    }

} 
```

**错误**

```
03-03 15:42:13.894: E/SQLiteLog(9809): (14) cannot open file at line 30176 of [00bb9c9ce4]
03-03 15:42:13.894: E/SQLiteLog(9809): (14) os_unix.c:30176: (2) open(/data/data/com.example.activities/databases/DB_Nutrition) - 
03-03 15:42:13.904: E/SQLiteDatabase(9809): Failed to open database '/data/data/com.example.activities/databases/DB_Nutrition'.
03-03 15:42:13.904: E/SQLiteDatabase(9809): android.database.sqlite.SQLiteCantOpenDatabaseException: unknown error (code 14): Could not open database
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.database.sqlite.SQLiteConnection.nativeOpen(Native Method)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.database.sqlite.SQLiteConnection.open(SQLiteConnection.java:209)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.database.sqlite.SQLiteConnection.open(SQLiteConnection.java:193)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.database.sqlite.SQLiteConnectionPool.openConnectionLocked(SQLiteConnectionPool.java:463)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.database.sqlite.SQLiteConnectionPool.open(SQLiteConnectionPool.java:185)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.database.sqlite.SQLiteConnectionPool.open(SQLiteConnectionPool.java:177)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.database.sqlite.SQLiteDatabase.openInner(SQLiteDatabase.java:804)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.database.sqlite.SQLiteDatabase.open(SQLiteDatabase.java:789)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:694)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:669)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at com.example.db_food.DataBaseManager.checkDataBase(DataBaseManager.java:228)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at com.example.db_food.DataBaseManager.createDataBase(DataBaseManager.java:193)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at com.example.db_food.DataBaseManager.<init>(DataBaseManager.java:163)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at com.example.db_food.DataBaseManager.instance(DataBaseManager.java:179)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at com.example.db_food.MyActivity.onCreate(MyActivity.java:63)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.app.Activity.performCreate(Activity.java:5104)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.os.Looper.loop(Looper.java:137)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at android.app.ActivityThread.main(ActivityThread.java:5041)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at java.lang.reflect.Method.invokeNative(Native Method)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at java.lang.reflect.Method.invoke(Method.java:511)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
03-03 15:42:13.904: E/SQLiteDatabase(9809):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:27:15.840

看起来您想在 ListView 中显示表中的数据，因此只需创建一个适配器：

```
SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, 
        R.layout.aa_four_column,
        mCursor, 
        new String[] { foodNameColumn, proteinColumn, fatColumn, carbsColumn }, 
        new int[] { R.id.txtCol1, R.id.txtCol2, R.id.txtCol3, R.id.txtCol4 }, 0);

lvDB.setAdapter(adapter); 
```

（单独使用此代码，您不需要使用下面的任何其他代码，但您应该阅读它以了解为什么您的大多数代码不会执行您想要执行的操作。）

* * *

你有一些逻辑错误。

1）如果一个对象是`null`你不能引用它的任何方法：

```
if (mCursor == null){
    /* mCursor.close(); This will throw an NullPointerException! */
    Log.w("cursor", "null cursor");
    return;
} 
```

2）通过调用`moveToFirst()` *并* `moveToNext()`在读取一行之前跳过第一条记录。此外，您在读取记录之间调用`moveToNext()`了两次，因此您只是每隔一个读取一次。试试这个：

```
while (mCursor.moveToNext()){
    // Do something
} 
```

3）现在要手动从光标中读取实际值，您必须使用类似`getString()`or的方法`getInt()`：

```
List<String> strings = new ArralyList<String>();
while (mCursor.moveToNext()){
    strings.add(mCursor.getString(mCursor.getColumnIndex(foodNameColumn)) + "  " + mCursor.getInt(mCursor.getColumnIndex(proteinColumn)));
} 
```

4）在原始循环中，您没有将任何数据添加到`s`. 您只是`s`一遍又一遍地用相同的值覆盖：

```
while (mCursor.moveToNext()){
    s = new String[] { foodNameColumn, proteinColumn, fatColumn, carbsColumn };
} 
```

这个循环执行一次还是一千次都没关系，`s`总是一样的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:39:41.820

It should be like this

```
s = new String[] { foodNameColumn, proteinColumn, fatColumn, carbsColumn };

SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, 
            R.layout.aa_four_column,
            mCursor, 
            s, 
            new int[] { R.id.txtCol1, R.id.txtCol2, R.id.txtCol3, R.id.txtCol4 }, 0); 
```

Even if your mCursor is null, it is still OK, just that no item is shown in your list.

# c# - 将 C++ 按位和 OpenSSL BigNumber 操作转换为 C#

> ID：15178957
> 
> 赞同：1
> 
> 时间：2013-03-02T20:14:17.297
> 
> 标签：c#, c++, openssl, bit-manipulation, biginteger

我正在尝试将使用按位运算的 C++ 函数移植到 C#，但遇到了问题。即当输入是`0x01123456`C# 时返回零，但[它应该是`12`](https://bitcoin.stackexchange.com/a/8046/1878)

*   BN_set_word 和其他 BN_* 函数在 OpenSSL 中。这些函数做了什么（详细）......是否有一个大整数的.NET等价物？

*   什么是 MPI 表示？（谷歌没用）

*   我应该担心[这里评论中提到](http://msdn.microsoft.com/en-US/library/xt18et0d%28v=vs.80%29.aspx)的班次计数中的掩蔽吗？

**C++ 原版**

[Git 源代码](https://github.com/bitcoin/bitcoin/blob/master/src/bignum.h)

```
 // The "compact" format is a representation of a whole
    // number N using an unsigned 32bit number similar to a
    // floating point format.
    // The most significant 8 bits are the unsigned exponent of base 256.
    // This exponent can be thought of as "number of bytes of N".
    // The lower 23 bits are the mantissa.
    // Bit number 24 (0x800000) represents the sign of N.
    // N = (-1^sign) * mantissa * 256^(exponent-3)
    //
    // Satoshi's original implementation used BN_bn2mpi() and BN_mpi2bn().
    // MPI uses the most significant bit of the first byte as sign.
    // Thus 0x1234560000 is compact (0x05123456)
    // and  0xc0de000000 is compact (0x0600c0de)
    // (0x05c0de00) would be -0x40de000000
    //
    // Bitcoin only uses this "compact" format for encoding difficulty
    // targets, which are unsigned 256bit quantities.  Thus, all the
    // complexities of the sign bit and using base 256 are probably an
    // implementation accident.
    //
    // This implementation directly uses shifts instead of going
    // through an intermediate MPI representation.
    CBigNum& SetCompact(unsigned int nCompact)
    {
        unsigned int nSize = nCompact >> 24;
        bool fNegative     =(nCompact & 0x00800000) != 0;
        unsigned int nWord = nCompact & 0x007fffff;
        if (nSize <= 3)
        {
            nWord >>= 8*(3-nSize);
            BN_set_word(this, nWord);
        }
        else
        {
            BN_set_word(this, nWord);
            BN_lshift(this, this, 8*(nSize-3));
        }
        BN_set_negative(this, fNegative);
        return *this;
    } 
```

**C# 尝试的端口**

```
 internal static System.Numerics.BigInteger SetCompact(uint numToCompact)
    {
        //
        //
        //  SetCompact
        // Extract the number from bits 0..23
        uint nWord = numToCompact & 0x007fffff;
        BigInteger ret = new BigInteger(nWord);

        // Add zeroes to the left according to bits 25..32
        var ttt =  ret.ToByteArray();
        uint size = numToCompact >> 24;
        uint amountToShift = 0;
        if (size <= 3)
        {
            amountToShift = 8 * (3 - size);
            ret = ret >> (int)amountToShift;
        }
        else
        {
            ret = ret << (int)amountToShift;
            amountToShift = 8 * (size - 3);
        }

        // Set the value negative if required per bit 24
        UInt32 isNegative = 0x00800000 & numToCompact;
        if (isNegative != 0)
            ret =BigInteger.Negate(ret);

        var test = ret.ToByteArray();
        Console.WriteLine();
        Console.WriteLine(ret.ToString("X"));
        return ret;

    } 
```

# sql - 使用存储在另一个表中的 id 和日期范围从一个表中获取数据

> ID：15178958
> 
> 赞同：0
> 
> 时间：2013-03-02T20:14:17.380
> 
> 标签：sql

我正在编写的应用程序是用于出租给客户的遥测单元，我正在尝试查询特定客户的记录数据，而表`customer_id_fk`中没有列`Log`。

我有以下表格：

客户表：

```
id | name | ... 
```

单位表：

```
id | name | ... 
```

出租表：

```
id | start_date | end_date | unit_id_fk | customer_id_fk 
```

日志表：

```
id | unit_id_fk | datetime | data1 | data2 
```

`customer_id_fk`列未包含在表中的原因`Log`是，RentOut 表中的错误很容易纠正，而无需更改`Log`表中的数据（尽管也许有更好的方法来做到这一点？）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:35:59.533

将客户包括在日志表中会更有效。但是，没有它，你可以通过一堆连接得到你想要的：

```
select l.*, c.*
from log l left outer join
     RentOut ro
     on l.unit_id_fk = ro.unit_id_rk and
        l.datetime between ro.start_date and ro.end_date left outer join
     Customer c
     on ro.customer_id = c.id
where c.<whatever> = <foobar> 
```

如果 RentOut 表中的日期确实是日期（没有时间），并且日志记录具有日期时间，那么您可能需要执行更多的日期运算才能使连接正常工作。例如，对于给定的日志记录，您可能需要说“开始”实际上是在中午之后，而“结束”实际上是在中午之前。

# wordpress - 根据地理位置在首次访问时重定向用户

> ID：15178964
> 
> 赞同：4
> 
> 时间：2013-03-02T20:14:39.913
> 
> 标签：wordpress, geolocation

我的项目有两个版本的网站——美国版和国际版。这不是本地化，语言相同，只是内容发生了变化。我为美国版本创建了子域，并在主域上保留了国际版本。

现在，我搜索了默认将美国用户重定向到美国网站的解决方案，并使用了地理重定向插件（[http://wordpress.org/extend/plugins/geographical-redirect/](http://wordpress.org/extend/plugins/geographical-redirect/)）。

现在的问题是，这个插件每次尝试打开国际版本时都会重定向来自美国的访问者。我需要做的是，用户第一次访问时应该被重定向到美国版本，然后通过我在美国网站上放置的引荐链接，应该允许访问者访问国际版本并浏览网站。但同样，如果用户试图直接打开网站，他应该被重定向到美国版本。

我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T12:39:11.553

你可以通过使用 cookie 来做到这一点。

美国用户第一次登录时，您[设置了一个 cookie](http://php.net/manual/en/function.setcookie.php)

然后，您对每个页面访问执行 IF 检查，以查看是否设置了所述 cookie（或某个值）

如果 cookie 不存在，它们将被重定向到美国站点，如果存在，则重定向到任何其他链接。

# php - 用户错误的 PHP MYSQL 访问被拒绝

> ID：15178968
> 
> 赞同：1
> 
> 时间：2013-03-02T20:15:13.210
> 
> 标签：php, mysql

我正在尝试从 mySql 中的特定行 ID 获取“内容”值，我在 PHP 中回显了结果，但我得到“用户'@'localhost'的访问被拒绝（使用密码：否）”。我尝试在 phpMyAdmin 中检查我的查询，我得到了我期望的确切结果。

这是我的代码：

```
$con = mysql_connect("localhost", "XXX", "XXX") or die (mysql_error());
$db = mysql_select_db("XXX", $con) or die (mysql_error());

function head($d) {
        $query = mysql_query("SELECT Content FROM list WHERE ID = '$d'") or die(mysql_error());
        $post = mysql_fetch_assoc($query);
        echo $post["Content"];
}

<h1> <?php head(1); ?> </h1> 
```

太感谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:18:30.890

您引用的错误消息听起来像您拨打电话时尚未连接数据库。如果不存在连接，`mysql_query()`将尝试使用默认值（通常为空）建立连接。

在进行任何查询之前，您应该检查您的程序流程并确保您实际连接到数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:17:27.657

问题在于

```
mysql_connect("localhost", "ncode_hana", "NOAM7778") 
```

检查 sqn 用户和 pass 是否正确，并且该用户有权访问您选择的数据库...

此外，切勿与任何人分享您的原始用户 ID 和密码。

也，正如佩卡告诉你需要这样的东西

```
<h1> <?php include('yourdatabaseconnectionfile.php'); ?> <?php head(1); ?> </h1> 
```

**或者**

```
 <?php
    $con = mysql_connect("localhost", "XXX", "XXX") or die (mysql_error());
    $db = mysql_select_db("XXX", $con) or die (mysql_error());

    <h1> <?php head(1); ?> </h1>

    function head($d) {

            $query = mysql_query("SELECT Content FROM list WHERE ID = '$d'") or die(mysql_error());
            $post = mysql_fetch_assoc($query);
            echo $post["Content"];
    } 
```

**一个更多选项** 在函数中添加连接字符串（虽然不推荐）

```
 function head($d) {
mysql_connect("localhost", "ncode_hana", "NOAM7778"); 
                $query = mysql_query("SELECT Content FROM list WHERE ID = '$d'") or die(mysql_error());
                $post = mysql_fetch_assoc($query);
                echo $post["Content"];
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:17:47.750

将您的前两行移至您的函数：

```
function head($d) {
$con = mysql_connect("localhost", "XXX", "XXX") or die (mysql_error());
$db = mysql_select_db("XXX", $con) or die (mysql_error());

        $query = mysql_query("SELECT Content FROM list WHERE ID = '$d'") or die(mysql_error());
        $post = mysql_fetch_assoc($query);
        echo $post["Content"];
}

<h1> <?php head(1); ?> </h1> 
```

# python - Django 表单 HTML5 验证模式

> ID：15178972
> 
> 赞同：1
> 
> 时间：2013-03-02T20:15:33.143
> 
> 标签：python, django, html, forms, validation

Dugen Chen 写了一篇很有帮助的文章，将 HTML5 验证中的“必需”属性添加到 Django 表单字段。 [http://duganchen.ca/elegantly-adding-html5-validation-attributes-to-django-form-fields/](http://duganchen.ca/elegantly-adding-html5-validation-attributes-to-django-form-fields/)

我还希望自动包含 HTML5 模式属性，这样如果这是我的表单：

```
class AccountEditForm(forms.Form):
  email = forms.EmailField()
  phone = forms.CharField(widget=forms.IntegerField) 
```

然后将创建以下html：

```
<input type="email" name="email" id="id_email" required pattern="-email regex-" />
<input type="text" name="phone" id="id_phone" required pattern="-integer regex-" /> 
```

杜根使用了这种方法：

```
compose = lambda f, g: lambda *args, \
          **kwargs: f(g(*args, **kwargs))

def html5_required(field):
  if field.required != False:
    field.widget.attrs['required'] = 'required'
  return field

CharField = compose(html5_required, CharField) 
```

这样一个表格仍然可以写成

```
class SampleForm(form):
  text_field = CharField() 
```

并且将适当添加“必需”属性

有人可以解释如何为模式属性做类似的事情。所有这些都可以用装饰器应用，这样这个烂摊子就可以放在其他地方吗？

理想情况下，是否有一组标准化的正则表达式模式来匹配每个 Django 表单字段，是否有人构建了一个小型库以轻松将其添加到 Django 中？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T23:17:50.890

这里有两个选择。您可以创建一个更新类中所有字段的 mixin，或者对标准库进行猴子补丁。

对于monkeypatch，您可以执行以下操作：

```
from django.forms import fields
fields.__dict__.update({
    name: compose(html5_required, field)
    for name, field in fields.__dict__.iteritems()
    if issubclass(field.__class__, fields.Field)
}) 
```

mixin 方法基本上会做同样的事情，但是通过迭代属性涉及一些元编程魔法，并在必要时重新定义它们。[此处概述了](http://www.ibm.com/developerworks/linux/library/l-pymeta/index.html)一般概念。

# ios - uitableviewcell 的图像正在拉伸

> ID：15178973
> 
> 赞同：1
> 
> 时间：2013-03-02T20:15:47.077
> 
> 标签：ios, objective-c, uitableview, uiimageview

下面是我如何初始化单元格的样式

```
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier {

    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        .................................................
        .................................................
        // Set size for imageView
        CGRect  frame               =   self.imageView.frame;
        frame.size.width            =   16;
        frame.size.height           =   16;
        self.imageView.frame        =   frame;
    }

    return self;
} 
```

但是，将图像设置为单元格的图像视图后，图像现在正在拉伸。原稿尺寸为 24x24。

![在此处输入图像描述](../Images/d3e8764fffa8006c4f5e50097459abde.png)

如何使图像看起来形状？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:24:16.053

尽量不要使用单元格的 imageView 属性，而是创建自己的 imageview 并添加它

```
UIImageView *myImageView = [[UIImageView alloc] initWithImage:neededImage];
myImageView.frame = CGRectMake(0,0,16,16);
[self addSubview:myImageView];
[myImageView release]; 
```

最初的问题是 imageView 属性是`If an image is set, it appears on the left side of the cell, before any label.`所以单元格拉伸它，因为它习惯于表现。

# java - 无法运行 Eclipse / Android SDK 项目 - 来源不明的错误

> ID：15178975
> 
> 赞同：0
> 
> 时间：2013-03-02T20:15:52.757
> 
> 标签：java, android, xml

所有文件对我来说都很好 - 有人有什么想法/建议吗？

提前致谢！

阿曼尼·斯旺

错误：

说明 资源路径 位置类型 内容不允许出现在结尾部分。strings.xml /Linking Manager/res/values line 7 Android XML Format Problem invalid resource directory name AndroidManifest.xml /Linking Manager/bin/res line 1 Android AAPT Problem error: Error parsing XML: not well-formed (invalid token) strings .xml /Linking Manager/res/values 第 7 行 Android AAPT 问题 生成最终存档时出错：java.io.FileNotFoundException: C:\Users\User\Desktop\Android Backups\3.1.2013 @1111pm\MyAndroidApp\bin\resources.ap_不存在 Linking Manager Unknown Android Packaging Problem

main.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?> 
```

main2.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout android:orientation="vertical" android:id="@+id/linearLayout1" android:layout_width="fill_parent" android:layout_height="fill_parent"
 xmlns:android="http://schemas.android.com/apk/res/android">
<TextView android:textAppearance="?android:textAppearanceLarge" android:id="@+id/textView1" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="User Settings:" />
<TextView android:textAppearance="?android:textAppearanceLarge" android:id="@+id/TextView01" android:layout_width="wrap_content"  android:layout_height="wrap_content" android:text="" />
<TextView android:textAppearance="?android:textAppearanceMedium" android:id="@+id/textView3" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Data Limit" />
<TextView android:textAppearance="?android:textAppearanceSmall" android:id="@+id/textView4" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="" />
<SeekBar android:id="@+id/seekBar1" android:layout_width="fill_parent" android:layout_height="wrap_content" />
<LinearLayout android:orientation="horizontal" android:layout_width="fill_parent" android:layout_height="wrap_content">
    <TextView android:gravity="left" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="10MB" android:layout_weight="1.0" />
    <TextView android:gravity="right" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Unlimited Data" android:layout_weight="1.0" />
</LinearLayout>
<TextView android:textAppearance="?android:textAppearanceSmall" android:id="@+id/TextView01" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="" />
<TextView android:textAppearance="?android:textAppearanceMedium" android:id="@+id/textView3" android:layout_width="wrap_content"  android:layout_height="wrap_content" android:text="Bandwidth Limit" />
<TextView android:textAppearance="?android:textAppearanceSmall" android:id="@+id/textView4" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="" />
<SeekBar android:id="@+id/seekBar1" android:layout_width="fill_parent" android:layout_height="wrap_content" />
<LinearLayout android:orientation="horizontal" android:layout_width="fill_parent" android:layout_height="wrap_content">
    <TextView android:gravity="left" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="10kbs" android:layout_weight="1.0" />
    <TextView android:gravity="right" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Unlimited Bandwidth" android:layout_weight="1.0" />
</LinearLayout>
<TextView android:textAppearance="?android:textAppearanceSmall" android:id="@+id/TextView01" android:layout_width="wrap_content" android:layout_height="wrap_content" />
<TextView android:textAppearance="?android:textAppearanceMedium" android:id="@+id/TextView02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="WiFi Time Limit" />
<TextView android:textAppearance="?android:textAppearanceSmall" android:id="@+id/TextView01" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="" />
<TimePicker android:id="@+id/timePicker1" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginLeft="50.0dip" android:layout_weight="1.0" />
<TextView android:textAppearance="?android:textAppearanceSmall" android:id="@+id/TextView01" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="" />
<EditText android:id="@+id/editText1" android:layout_width="fill_parent" android:layout_height="wrap_content" android:hint="Blocked Sites - [ex: www.xxx.com]" android:ems="10" />
</LinearLayout> 
```

AndroidManifest.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.mkyong.android"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="10" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".SplashScreen"
        android:theme="@android:style/Theme.Black.NoTitleBar" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name=".main2" >
    </activity>
    <activity android:name=".home" >
    </activity>
    <activity android:name=".App2Activity" >
    </activity>
    <activity
        android:name=".AppActivity"
        android:label="@string/app_name" >
    </activity>
</application>

</manifest> 
```

AppActivity.java（主要的 java 文件）

```
package com.mkyong.android;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.content.Intent;

public class AppActivity extends Activity {

final Context context = this;
private Button button;

public void onCreate(Bundle savedInstanceState) {

super.onCreate(savedInstanceState);
setContentView(R.layout.main);

button = (Button) findViewById(R.id.button1);

// add button listener
button.setOnClickListener(new OnClickListener() {

@Override
public void onClick(View arg0) {

    AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
        context);

    // set title
    alertDialogBuilder.setTitle("Settings Menu");

    // set dialog message
    alertDialogBuilder
        .setMessage("Link or Delete?")
        .setCancelable(false)
        .setPositiveButton("Link",new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog,int id) {
        //start new activity

        Intent intentApp2Activity = new Intent(AppActivity.this, App2Activity.class);
        startActivity(intentApp2Activity);

        // if this button is clicked, close
        // current activity
        AppActivity.this.finish();
    }
  })
        .setNegativeButton("Delete",new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog,int id) {
                // if this button is clicked, just close
                // the dialog box and do nothing
                dialog.cancel();
            }
        });

        // create alert dialog
        AlertDialog alertDialog = alertDialogBuilder.create();

        // show it
        alertDialog.show();
    }
});
}} 
```

App2Activity.java

```
package com.mkyong.android;

import android.app.Activity;
import android.os.Bundle;
import android.widget.Button;

public class App2Activity extends Activity {

Button button;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main2);
}

} 
```

字符串.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
<string name="app_name">Linking Manager</string>
<string name="button1">Button1</string>
<string name="button2">Button2</string>
<string name="button3">Button3</string>    
</resources> 
```

错误：（显示在此线程的顶部）

所有文件对我来说都很好 - 有人有什么想法/建议吗？

提前致谢！

*   阿曼尼·斯旺

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:57:27.103

试试这个。

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout android:orientation="vertical" xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLayout1" android:layout_width="fill_parent" android:layout_height="fill_parent">
<TextView android:textAppearance="?android:textAppearanceLarge" android:id="@+id/textView1" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="NFC Linking Manager" />
<Button android:id="@+id/button1" android:layout_width="fill_parent" android:layout_height="wrap_content" android:text="Linksys Router (Home)" android:onClick="onPopupBtClick" />
<Button android:id="@+id/Button2" android:layout_width="fill_parent" android:layout_height="wrap_content" android:text="Netgear Router (Office)" />
<Button android:id="@+id/Button3" android:layout_width="fill_parent" android:layout_height="wrap_content" android:text="Cisco Router (Office)" />
</LinearLayout> 
```

我在每个组件中编辑了您的布局，例如**android:id="@+id/Button3"**

对 main2.xml 做同样的事情

# python - 从多个列表生成随机条目的 Python 代码

> ID：15178976
> 
> 赞同：2
> 
> 时间：2013-03-02T20:16:03.027
> 
> 标签：python

我是 Python 新手，正在尝试编写一个代码，通过从列表 [characters] [traits] [themes] [locations] 和 [lines] 中选择一个随机条目来生成故事的核心元素。我写的代码如下。

我有两个问题：

1）目前代码将允许我在每个列表中创建新条目，但是当我关闭 Python 并重新启动程序时，我创建的条目消失了。我怎样才能使新条目永久存储在列表中？我需要某种数据库吗？

2) 6\. Storybox 的代码——我想让程序做的主要事情！- 不管用。关于如何让 Python 从每个列表中打印随机选择的条目的任何建议？

在此先感谢您的帮助。

```
#Storybox program
#Generates a random selection of my story ideas

characters = []
traits = []
locations = []
themes = []
lines = []

choice = None

while choice != "0":

    print(
     """

Storybox:

0 - Exit
1 - Add character
2 - Add trait
3 - Add location
4 - Add theme
5 - Add line
6 - Generate Story
7 - View all entries

"""
)

    choice = input("Choice: ")
    print()

#exit
    if choice == "0":
        print("Goodbye")

#add a character
    elif choice == "1":
        character = input("Enter character: ")
        characters.append(character)

#add a trait
    elif choice == "2":
        trait = input("Enter character trait: ")
        traits.append(trait)

#add a location
    elif choice == "3":
        location = input("Enter location: ")
        locations.append(location)

#add a theme
    elif choice == "4":
        theme = input("Enter theme: ")
        themes.append(theme)

#add good lines
    elif choice == "5":
        line = input("Enter good line: ")
        lines.append(line)

#Generate storybox
    elif choice == "6":
        print("Your storybox is....")
        storyboxcharacter = random.choice(characters)
        print(storyboxcharacter)
        storyboxtrait = random.choice(traits)
        print(storyboxtrait)
        storyboxtheme = random.choice(themes)
        print(storyboxtheme)
        storyboxlocation = random.choice(locations)
        print(storyboxlocation)
        storyboxline = random.choice(lines)
        print(storyboxline)

#Display all entries so far
    elif choice == "7":
        print("Characters:")
        for character in characters:
            print(character)

        print("Traits:")
        for trait in traits:
            print(trait)

        print("Themes:")
        for theme in themes:
            print(theme)

        print("Locations:")
        for location in locations:
            print(location)

        print("Good lines:")
        for line in lines:
            print(line)

input("\n\nPress the enter key to exit.") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:21:03.943

1) 是的，您需要以某种方式将数据存储在文本文件或数据库中。在这一点上，数据库将是矫枉过正，所以我推荐类似[json](http://docs.python.org/2/library/json)的东西。

2）*删除 randint 解决方案*- random.choice 肯定更好

# c# - 使用 out 参数调用存储过程

> ID：15178979
> 
> 赞同：4
> 
> 时间：2013-03-02T20:16:14.417
> 
> 标签：c#, mysql, entity-framework-5

我正在尝试调用具有一个输入参数和两个输出参数的存储过程。

作为一个脚本，我这样称呼它：

```
set @MaxPrice = 0.00;
set @MinPrice = 0.00;
set @BSku = '1011001403';
call GetSkuMinMaxPrice(@Sku,@MaxPrice, @MinPrice); 
```

我拿回我的价格

这是我用 ef5 调用它的原因：

```
decimal? minPrice;
decimal? maxPrice;

var skuParameter = new MySqlParameter("?SKU", productToUpload.Sku)
{
    Direction = ParameterDirection.Input
};
var maxPriceParameter = new MySqlParameter("?MaxPrice", SqlDbType.Decimal)
{
    Direction = ParameterDirection.Output
};
var minPriceParameter = new MySqlParameter("?MinPrice", SqlDbType.Decimal)
{
    Direction = ParameterDirection.Output
};
db.Database.ExecuteSqlCommand("call GetSkuMinMaxPrice(?SKU,?MaxPrice,?MinPrice)",
                               skuParameter, 
                               maxPriceParameter, 
                               minPriceParameter);

minPrice = minPriceParameter.Value as decimal?;
maxPrice = maxPriceParameter.Value as decimal?; 
```

对我来说，这看起来不错，但我从 MySQL 服务器收到此错误消息：`OUT or INOUT argument 2 for routine tng.GetSkuBaseMinMaxPrice is not a variable or NEW pseudo-variable in BEFORE trigger`.

[那么，除了不使用 Entity Framework 之外](https://stackoverflow.com/questions/10141637/asp-net-mvc-ef-calling-mysql-stored-procedure-with-out-parameters)，我还需要做什么才能完成这项工作？

到目前为止我的一些研究：

*   [除了 out 参数之外的所有内容的语法](http://www.codeproject.com/Tips/522619/Implementing-CRUD-operations-in-MySQL-using-Entity)
*   [MySQL中可能存在的错误](http://bugs.mysql.com/bug.php?id=25970)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:16:14.417

这似乎是 MySQL 处理 out 参数的结果。我的解决方法是更改​​存储过程以返回输出参数的选择查询，创建一个具有与存储过程选择结果的列名匹配的公共属性名称的 POCO。

**新的存储过程调用**

```
set @BSku = '1011001403';
call GetSkuPrices(@Sku); 
```

**我的 POCO：**

```
private class PriceOutput
{
    public decimal? MaxPrice { get; set; }
    public decimal? MinPrice { get; set; }
} 
```

**我的调用代码：**

```
decimal? minPrice = null;
decimal? maxPrice = null;

var skuParameter = new MySqlParameter("?SKU", productToUpload.Sku);
var basePrices = db.Database.SqlQuery<PriceOutput>("call GetSkuPrices(?SKU)",                                                       
                                                   skuParameter).FirstOrDefault();
if (basePrices != null)
{
    minPrice = basePrices.MinPrice;
    maxPrice = basePrices.MinPrice;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-09T14:11:49.383

`OUT`我相信 MySQL for EF 不支持这些参数，而不是尝试使用参数，而是返回您想要从`PROCEDURE`using`SELECT`语句返回的值。

这是因为每个未选择的 select 语句都`INTO`将作为过程的结果集返回。 [我在这里发现了这个。](https://dba.stackexchange.com/questions/8291/how-does-mysql-return-a-result-set-from-a-stored-procedure)

我想从我的存储过程中返回受影响的行数，所以我删除了我的输出参数并将它放在它的位置：

```
SELECT ROW_COUNT() AS Success; 
```

然后我创建了以下对象来捕获该值：

```
public class UsePasswordResult
{
    public int Success { get; set; }
} 
```

然后我使用以下方法获取值：

```
// Set values to desired parameter values
int quizId = 1;
string password = "mypassword";

UsePasswordResult result = this.Context.Database.SqlQuery<UsePasswordResult>("CALL UsePassword({0}, {1})", quizId, password).FirstOrDefault(); 
```

我希望这对某人有帮助！我正在使用 EF6，它可以工作。

# java - 如何将 InputStream.read() 转换为双精度？

> ID：15178982
> 
> 赞同：2
> 
> 时间：2013-03-02T20:16:27.557
> 
> 标签：java

有没有一种简单的方法可以将从流中读取的字节数组转换为双精度值？

```
InputStream input = serialPort.getInputStream();
while(true) {
  byte[] buffer = new byte[ 8 ];
  len = input.read( buffer );
} 
```

缓冲区 => 双倍？

你能形象地解释一下 InputStream.read(byte[] b) 的工作原理吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:19:43.957

[如果你经常做这样的操作，也许使用DataInputStream](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/DataInputStream.html)会更好，它提供了一组操作，比如 readDouble 等。

```
DataInputStream input = new DataInputStream(serialPort.getInputStream());
double d = input.readDouble(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T20:19:50.527

`InputStream.read(byte[] b)`将下一个字节读入`b`参数。

并且，您可以尝试使用[DataInputStream](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/DataInputStream.html)来读取 Double、Float、Integer 等。您可以使用以下方法实例化 DataInputStream：

```
DataInputStream input = new DataInputStream(YOUR_INPUT_STREAM); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:26:30.723

尝试使用 DataInputStream ( [javadoc](http://docs.oracle.com/javase/6/docs/api/java/io/DataInputStream.html) ) 包装您的 InputStream 对象并使用 readDouble 方法

# excel - 将日期转换为 12 小时类别的公式

> ID：15178985
> 
> 赞同：0
> 
> 时间：2013-03-02T20:17:12.767
> 
> 标签：excel, date, automation, formulas

我从数据库中获得了一些数据，这些数据以下列格式列出日期：

*   2013 年 3 月 2 日 0:09
*   2013 年 3 月 1 日 20:12
*   3/1/13 3:02
*   2013 年 3 月 1 日 0:45

我需要在我的电子表格中创建一个列并将它们放入 12 小时类别中，基本上将其变成这样：

*   2013 年 3 月 2 日 0:00
*   2013 年 3 月 1 日 12:00
*   2013 年 3 月 1 日 0:00
*   2013 年 3 月 1 日 0:00

如果在午夜和中午 12 点之间，我希望它说午夜，如果在中午 12 点和午夜之间，我希望它说中午 12 点。我有超过 3500 行数据跨越 2 周的日期，所以我正在寻找合适的 excel 公式来实现这一点。我一直在玩有条件的“如果”公式，但还没有做对。有人可以帮忙吗？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:23:43.090

Excel 在内部将日期和时间存储为数字，其中 1.0 等于 1d，0.5 = 12h。因此，您可以使用简单的舍入技巧：

```
=INT(A1*2)/2

```

# sql - asp.net ajax 手风琴菜单类别？

> ID：15178987
> 
> 赞同：0
> 
> 时间：2013-03-02T20:17:23.953
> 
> 标签：sql, ajax, asp.net-ajax, accordionpane

我有 2 个 sql 表，类别和帖子。我为每个类别选择前 5 条记录。但是当我在手风琴菜单上使用它时，它会显示每个帖子的类别名称（重复）。

这是我的代码：

```
 <asp:Accordion ID="accMenu" runat="server"  DataSourceID="ods_menu" RequireOpenedPane="false">
     <HeaderTemplate>
                     <h3><a href="#"><%# Eval("kategori_adi") %></a></h3>
                     </HeaderTemplate>   
                    <ContentTemplate>
                       <div>
                           <ul>
                                <li><asp:HyperLink ID="HyperLink1" runat="server"  Text='<%# Eval("post_etiket") %>'>'></asp:HyperLink></li>
                           </ul>
                            </div>
                    </ContentTemplate>

                  </asp:Accordion>
                  <asp:ObjectDataSource ID="ods_menu" runat="server" SelectMethod="MenuGetir" TypeName="yonet"></asp:ObjectDataSource> 
```

我的 SQL 命令是这样的（我想为每个类别选择前 5 个帖子）：

```
select top 25 p.post_id,p.post_etiket,k.kategori_id,k.kategori_adi
 from post p, kategori k 
where k.kategori_id= p.post_kategori_id order by post_date 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-18T19:37:15.233

也许帮助某人

```
 <HeaderTemplate>
                 <h3><a href="#"><%# Eval("kategori_adi") %></a></h3>
                 </HeaderTemplate>   
                <ContentTemplate>

                   <div>
                            <ul >
                            <asp:Repeater ID="rp_altmenu" runat="server" DataSourceID="ods_alt_menu">

                            <ItemTemplate>

                                <li><asp:HyperLink ID="HyperLink1" runat="server"  Text='<%# Eval("post_etiket") %>'></asp:HyperLink></li>
                           </ItemTemplate>
                           </asp:Repeater>

                            </ul>
                        </div>

                </ContentTemplate>

              </asp:Accordion>
            <asp:ObjectDataSource ID="ods_kategori" runat="server" SelectMethod="KategoriGetir" TypeName="yonet">

            </asp:ObjectDataSource>
            <asp:ObjectDataSource ID="ods_alt_menu" runat="server"   SelectMethod="AltMenuGetir" TypeName="yonet"></asp:ObjectDataSource>
                    </div> 
```

AltMenuGetir 的 SQL sp 代码

```
@kategori_id int

AS
select top 5 post_id,post_etiket
from post
where post_kategori_id= @kategori_id
order by post_tarihi 
```

KategoriGetir 的 SQL 代码

```
select * from kategori 
```

和代码隐藏：

```
 protected void accMenu_ItemDataBound(object sender,        AjaxControlToolkit.AccordionItemEventArgs e)

  {
     yonet.kategori_idy=Convert.ToInt32(DataBinder.Eval(e.AccordionItem.DataItem,        "kategori_id").ToString());

   } 
```

# jquery - 在弹出框上循环ajax的jQuery问题

> ID：15178991
> 
> 赞同：0
> 
> 时间：2013-03-02T20:17:47.173
> 
> 标签：jquery, ajax, forms

我有一个奇怪的问题，我希望你能帮助我找出我做错了什么。

我有一个名为“ **popup** ”的 div 和按钮“ **send_mail** ”。

当按下“ **send_mail** ”按钮时，“ **popup** ”会显示 ajax 邮件表单和“ **close** ”按钮。

当我填写并发送邮件表格时，邮件将发送到我的电子邮件地址。

当然，在这一部分，一切都完美无缺。到目前为止，一切都很好...

问题是当我打开“**弹出**”表单时，使用“**关闭**”按钮将其关闭，然后再次重新打开表单并发送邮件。发生的情况是我在邮箱中收到了两次相同的邮件。

显然，当我打开和关闭弹出表单 10 次并且在第 10 次发送电子邮件时，我的邮箱中收到了 10 封邮件......

我可以解决这个问题并只发送一封邮件的唯一方法是刷新整个页面。

那可能是什么？

这是js代码（对于混乱的形式我很抱歉）：

第一行是确定按下哪个按钮，因为主 html 页面中有多个按钮（取决于用户数量，每个用户都有一个“send_mail_X”按钮）。

```
$("#list_container").on('click', "[id^='send_mail']", function () {
    var val = $(this).attr("value");
    $.ajax({
        type: "POST",
        url: "include/list_class.php",
        data: val,
        success: function(data){

            $("#Popup").on('click', "#close", function () {
                disablePopup();
            });

            $("#Popup").on('submit', "#admin_mail", function () {

                var sendbutton = $(this).find('#sendmail');
                var action = "include/admin_contact.php";
                sendbutton.attr('disabled','disabled');

                $.post(action, {
                    email: $("#Popup").find('#email').val(),
                    title: $("#Popup").find('#title').val(),
                    message: $("#Popup").find('#message').val()
                },
                    function(data){
                        document.getElementById('admin-form_output').innerHTML = data;  
                        centerPopup();
                    }
                );

                return false;

            });

            var array = data.split('#');
            var mymail = array[0];
            var myaddress = array[1];
            var isdisabled = "";
            if(mymail == ""){
                mymail = "Nie można wyslać maila.<br>Brak ardesu email.";
                isdisabled = "disabled='disabled'";
            }
            if(myaddress == ""){
                myaddress = "Uzytkownik nie podał swojego adresu.<br>Zaznacz jego zamowienie na czerwono.";
            }

            $("#bgPopup").data("state",0); 
            loadPopup(); 

            $("#Popup").on('click', "#popupClose", function () {  
                disablePopup();  
                return false;
            }); 

            $("#Popup").html("<a href='#' id='popupClose'><img src='images/close.png'></img></a> <div class='large-notice'><div id='admin-form_output'></div><br /><h4>ADRES WYSYLKOWY:</h4>" + myaddress + "<br /><br /><br /><h4>KONTAKT MAIL:</h4><div id='admin-form'><div class='field' style='display: block;'><form name='admin_mail' id='admin_mail' method='post' action='include/admin_contact.php' ><input type='hidden' name='email' id='email' value='" + mymail + "'/> <input type='text' name='title' id='title' onFocus='if(this.value == \"Tytul wiadomosci\") { this.value = \"\"; }' onBlur='if(this.value == \"\") { this.value = \"Tytul wiadomosci\"; }' value='Tytul wiadomosci' /> <textarea name='message' cols='190' rows='6' id='message' onFocus='if(this.value == \"Wiadomosc\") { this.value = \"\"; }' onBlur='if(this.value == \"\") { this.value = \"Wiadomosc\"; }' value='Wiadomosc'>Wiadomosc</textarea><div class='button'> <br /><input type='submit' class='btn-image' id='sendmail' " + isdisabled + " value='Wyslij' /></div><div class='button'> <br /><input type='button' class='btn-image' id='close' value='Zamknij' /></div></form></div></div><br /><br /><br />" + mymail + "</div>");

            centerPopup();

        }   

    });                                                                 

    return false;
});

function loadPopup(){  
    //loads popup only if it is disabled  

    if($("#bgPopup").data("state")==0){  
        $("#bgPopup").css({  
            "opacity": "0.7"  
        });  
        $("#bgPopup").fadeIn("medium");  
        $("#Popup").fadeIn("medium");
        $("#bgPopup").data("state",1);  
    }  
}  

function disablePopup(){
    $("#Popup").empty();
    if ($("#bgPopup").data("state")==1){  
        $("#bgPopup").fadeOut("medium");  
        $("#Popup").fadeOut("medium");  
        $("#bgPopup").data("state",0);  
    }  
}  

function centerPopup(){ 

    var winw = $(window).width();  
    var winh = $(window).height();  
    var popw = $('#Popup').width();  
    var poph = $('#Popup').height();  
    $("#Popup").css({  
        "position" : "fixed",  
        "top" : winh/2-poph/2,  
        "left" : winw/2-popw/2  
    });  
    //IE6  
    $("#bgPopup").css({  
        "height": winh    
    });  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T06:52:43.547

将此功能放在关闭按钮的 onclick 事件中

```
function empty_div(){
    $("#yourmaindiv").html('');
} 
```

它将做的是清空包含表单及其元素的 div。

另一种可能的解决方案是在表单名称中使用随机数。因此，每次加载新表单时，它将具有唯一的 id 和 name 属性，您将只提交该表单而不是所有表单。我认为每次加载您的表单时，它们都有相同的名称，这就是导致问题的原因

```
<-form name='myForm2322343233' id='myform2322343233' method='post'    action='somwhere.php'-> 
```

所以每次它都有一个唯一的标识符

# c - 检查正确接收数据包的数量 - 套接字编程

> ID：15178994
> 
> 赞同：4
> 
> 时间：2013-03-02T20:17:56.853
> 
> 标签：c, linux, sockets, tcp, wireless

我正在使用套接字编程用 C 语言编写一个应用程序。我希望将数据从服务器节点发送到客户端节点。我使用套接字描述符上的读取和写入命令分别通过网络获取和发送数据。因为使用的底层协议是 TCP/IP，所以最后我收到了正确的数据。是否可以在客户端检查以正确接收数据，实际丢失并重新传输了多少数据包？我正在 Linux (debian) 环境中编写此应用程序。

任何帮助都非常感谢！

-拉胡尔库玛

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T20:42:07.690

`/proc/net/tcp`有一个字段`retrnsmt`，你只需要在这个列表中[找到你的套接字。](https://stackoverflow.com/questions/3319521/how-can-i-match-each-proc-net-tcp-entry-to-each-opened-socket)

另一种方法是使用[`TCP_INFO`sockopt](http://linuxgazette.net/136/pfeiffer.html)。的当前布局`struct tcp_info`可以在[linux/tcp.h](http://lxr.free-electrons.com/source/include/uapi/linux/tcp.h#L148)中找到。您要使用的字段可能是`tcpi_retrans`.

# android - MediaRecorder - 记录通话应用程序

> ID：15178996
> 
> 赞同：0
> 
> 时间：2013-03-02T20:18:09.040
> 
> 标签：android, audio-recording, mediarecorder

我正在尝试开发记录通话的应用程序。

当我录制输出声音时，声音听起来很有线 - 电子声音而不是其他人的声音。

这是我的代码：

```
public class MainActivity extends Activity implements OnClickListener {
private Boolean Recording;
private Button btn_REC;
private MediaRecorder mrec;
private File audiofile = null;
private static final String TAG = "SoundRecordingDemo";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);
    Recording = false;
    mrec = new MediaRecorder();
    btn_REC = (Button) findViewById(R.id.btn_record);
    btn_REC.setOnClickListener(this);
}

@Override
public void onClick(View v)
{
    if (!Recording)
    {
        try
        {
            startRecording();
            Recording = true;
        }
        catch (IOException e1)
        {
            e1.printStackTrace();
        }

        btn_REC.setText("RECORDING");
    }

    else
    {       
        stopRecording();
        btn_REC.setText("RECORD");
    }

}

protected void startRecording() throws IOException {
    mrec.setAudioSource(MediaRecorder.AudioSource.VOICE_DOWNLINK);
    mrec.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
    mrec.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
    if (audiofile == null) {
        File sampleDir = Environment.getExternalStorageDirectory();
        try {
            audiofile = File.createTempFile("ibm", ".3gp", sampleDir);
        } catch (IOException e) {
            Log.e(TAG, "sdcard access error");
            return;
        }
    }
    mrec.setOutputFile(audiofile.getAbsolutePath());
    mrec.prepare();
    mrec.start();
}

protected void stopRecording() {
    mrec.stop();
    mrec.release();
    processaudiofile();
}

protected void processaudiofile() {
    ContentValues values = new ContentValues(3);
    long current = System.currentTimeMillis();
    values.put(MediaStore.Audio.Media.TITLE, "audio" + audiofile.getName());
    values.put(MediaStore.Audio.Media.DATE_ADDED, (int) (current / 1000));
    values.put(MediaStore.Audio.Media.MIME_TYPE, "audio/3gpp");
    values.put(MediaStore.Audio.Media.DATA, audiofile.getAbsolutePath());
    ContentResolver contentResolver = getContentResolver();

    Uri base = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
    Uri newUri = contentResolver.insert(base, values);

    sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE, newUri));
} 
```

}

当我尝试将 AudioSource 更改为上行链路或语音呼叫时，它仍然相同。当我将其定义为 MIC 时，一切正常，但是当我拨打电话时，这种奇怪的声音仍然开始......

有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T07:56:08.670

使用 mRecorder.setAudioSource(MediaRecorder.AudioSource.VOICE_CALL);

但是由于通话录音不合法，所以很多设备不支持（MediaRecorder.AudioSource.VOICE_CALL/MediaRecorder.AudioSource.VOICE_DOWNLINK），将在某些设备上工作。

我已经在 LG 上对其进行了测试，并且工作正常，但不适用于 Nexus 设备。

因此，这些使用所有设备都允许的 MediaRecorder.AudioSource.MIC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:44:44.810

再次通话记录功能，或者更确切地说

```
 mrec.setAudioSource(MediaRecorder.AudioSource.VOICE_DOWNLINK); 
```

***是高度依赖设备的东西。***

有些设备不允许上行链路，有些设备阻止下行链路，有些设备不允许语音通话。然而，有些设备允许*各种音频源*。

> 例如：我使用允许上行链路和下行链路的 Moto 设备。但不能同时进行，即语音通话。所以要么我可以录制我的声音，要么可以录制发件人的声音。

您应该尝试在不同的手机上验证此行为

# google-maps - 街景有时不会出现在 Google 地图 v3 中

> ID：15178997
> 
> 赞同：1
> 
> 时间：2013-03-02T20:18:14.480
> 
> 标签：google-maps, google-maps-api-3, google-street-view

这是我的代码

```
panoramaOptions = {
enableCloseButton : true,
visible : false
};

myPano = new google.maps.StreetViewPanorama(document.getElementById("pano"), panoramaOptions);

var mapOptions = {
    center: currentCenter,
    zoom: defaultZoom,
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    overviewMapControl: true,
    streetViewControl: false,
    streetView : myPano
};
map = new google.maps.Map(document.getElementById("map"), mapOptions);  

map.setStreetView(myPano);

google.maps.event.addListener(map,"click", function(e) {
map.setCenter(e.latLng);
myPano.setPosition(e.latLng);

if (marker != null) {
        marker.setMap(null);
}

marker = new google.maps.Marker({
        icon: new google.maps.MarkerImage("http:///maps.gstatic.com/mapfiles/cb/man_arrow-0.png"),
        map: map,
        draggable: true,
        position: e.latLng
});

marker.setMap(map);
myPano.setVisible(true);
}); 
```

现在的问题是有时街景不会出现。如何解决这个问题？

# android - 将字符串写入或附加到文件中。获取只读文件系统错误

> ID：15178998
> 
> 赞同：0
> 
> 时间：2013-03-02T20:18:26.947
> 
> 标签：android, file-io, android-sdcard, readonly, ioexception

首先，我要感谢大家对我最后几个问题的帮助。我已经搜索并尽力找出我的最新问题，但即使在这里搜索后我也没有运气。我正在尝试检查“heapFile.csv”是否存在，如果不存在，则创建该文件，然后向其中写入一个字符串。如果是这样，那么我只想向它附加一个字符串。我想我会这样做，但我不断收到一个 IOException 以及它说文件系统是只读的。我确实将清单文件更改为包括访问 sdcard，甚至使用 android 来制作虚拟 sdcard，以防出现问题。

首先这里是主要活动java ...

```
package com.loch.meaptracker;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

import android.os.Bundle;
import android.os.Environment;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.DatePicker;
import android.widget.EditText;
import android.widget.SeekBar;
import android.widget.SeekBar.OnSeekBarChangeListener;
import android.widget.TimePicker;

public class MainActivity extends Activity implements OnSeekBarChangeListener {

private SeekBar happyBar, energyBar, anxietyBar, painBar;
private EditText noteField;
private DatePicker dPick;
private TimePicker tPick;
@SuppressWarnings("unused")
private Button enterButton;
private int happyValue = 4, energyValue = 4, anxietyValue = 4,
        painValue = 4;
private static final String TAG = "heapApp";
private String Mood = "Blah";
final Context context = this;

@Override
protected void onCreate(Bundle savedInstanceState) {
    try {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        // bars
        happyBar = (SeekBar) findViewById(R.id.happinessBarID);
        happyBar.setOnSeekBarChangeListener(this);
        energyBar = (SeekBar) findViewById(R.id.energyBarID);
        energyBar.setOnSeekBarChangeListener(this);
        anxietyBar = (SeekBar) findViewById(R.id.anxietyBarID);
        anxietyBar.setOnSeekBarChangeListener(this);
        painBar = (SeekBar) findViewById(R.id.painBarID);
        painBar.setOnSeekBarChangeListener(this);
        // end bars
        dPick = (DatePicker) findViewById(R.id.datePicker1);
        tPick = (TimePicker) findViewById(R.id.timePicker1);
        noteField = (EditText) findViewById(R.id.noteTextFieldID);
        enterButton = (Button) findViewById(R.id.enterButtonID);
    } catch (Exception onCreateException) {
        Log.e(TAG, "Exception received", onCreateException);
    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

// Bar listener methods
@Override
public void onProgressChanged(SeekBar arg0, int barValue, boolean hFromUser) {
    try {

        switch (arg0.getId()) {
        case R.id.happinessBarID:
            happyValue = barValue + 1;
            break;
        case R.id.energyBarID:
            energyValue = barValue + 1;
            break;
        case R.id.anxietyBarID:
            anxietyValue = barValue + 1;
            break;
        case R.id.painBarID:
            painValue = barValue + 1;
            break;
        }
        String debugBarValue = "Happy is " + happyValue + ", Energy is "
                + energyValue + ", Anxiety is " + anxietyValue
                + ", Pain is " + painValue + ".";
        System.out.println(debugBarValue);

    } catch (Exception BarValueException) {
        Log.e(TAG, "Exception received", BarValueException);
    }

}

@Override
public void onStartTrackingTouch(SeekBar happyBar) {
    // TODO Auto-generated method stub

}

@Override
public void onStopTrackingTouch(SeekBar happyBar) {
    // TODO Auto-generated method stub

}

// end Bar listener methods

// Enter Button listener Method

public void dialogPop(View v) {
    try {
        AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
                context);

        // set Title
        alertDialogBuilder.setTitle("title");

        // set dialog message
        alertDialogBuilder.setMessage("You entered: " + getMood())
                .setCancelable(false).setPositiveButton("Okay",
                // When Okay button clicked the write mood string to file
                        new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog,
                                    int id) {
                                try {
                                    // This is the string that should be
                                    // written to file
                                    String data = getMood();
                                    // This is the file that should be
                                    // written to
                                    File heapFile = new File(Environment.getExternalStorageDirectory(), "/heapFile.csv");

                                    // if file doesn't exists, then create
                                    // it
                                    if (!heapFile.exists()) {
                                        heapFile.createNewFile();
                                    }

                                    // true = append file
                                    FileWriter heapFileWritter = new FileWriter(
                                            heapFile.getName(), true);
                                    BufferedWriter heapBufferWritter = new BufferedWriter(
                                            heapFileWritter);
                                    heapBufferWritter.write(data);
                                    heapBufferWritter.close();

                                    System.out.println("Done");

                                } catch (IOException e) {
                                    e.printStackTrace();
                                }
                            }

                        })
                // If they press either the cancel button or the back button
                // on their device (Same thing) then close the dialog and
                // give the user a chance to change what they've entered
                .setNegativeButton("Cancel",
                        new DialogInterface.OnClickListener() {

                            @Override
                            public void onClick(DialogInterface dialog,
                                    int id) {
                                // TODO Auto-generated method stub
                                dialog.cancel();
                            }
                        });

        // create alert dialog
        AlertDialog alertDialog = alertDialogBuilder.create();

        // show it
        alertDialog.show();
    } catch (Exception buttonListenerException) {
        Log.e(TAG, "Exception received", buttonListenerException);
    }
    return;
}

public String getMood() {
    try {
        int month = dPick.getMonth();
        int day = dPick.getDayOfMonth();
        int year = dPick.getYear();
        int minute = tPick.getCurrentMinute();
        String moodAntePost = "AM";
        boolean hourType = tPick.is24HourView();
        int moodHour = tPick.getCurrentHour();
        if (hourType == false && moodHour > 12) {
            moodHour = (moodHour - 12);
            moodAntePost = "PM";
        } else if (hourType == false && moodHour <= 0) {
            moodHour = 12;
        } else {
        }
        String noteText = noteField.getText().toString();
        Mood = "Happiness," + happyValue + ",Energy," + energyValue
                + ",Anxiety," + anxietyValue + ",Pain," + painValue
                + ",Date," + month + "/" + day + "/" + year + ",Time,"
                + moodHour + ":" + minute + "," + moodAntePost + ",Note,"
                + noteText;
        System.out.println(Mood);
    } catch (Exception getMoodException) {
        Log.e(TAG, "Exception received", getMoodException);
    }

    return Mood;
}

} 
```

和清单...

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.loch.meaptracker"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.loch.meaptracker.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:26:58.367

我认为问题出在这一行：

```
FileWriter heapFileWritter = new FileWriter(
                                            heapFile.getName(), true); 
```

*试试这个：*

```
 FileWriter heapFileWritter = new FileWriter(
                                                heapFile, true); 
```

**解释：**

heapFile.getName() 指的是您的文件名，所以可以说 heapFile.txt。所以当你要求 FileWriter 写入这个文件时。它不知道您指的是哪个文件。所以它尝试创建文件。可是等等！它将在哪里创建文件，因为它只有文件名，而不是完整路径。

所以即使我确定它会在哪里创建文件，我的猜测是 Root（我不确定）。这是只读的，因此是错误的。

> ```
> public FileWriter(String fileName,
>           boolean append)
>            throws IOException 
> ```
> 
> IOException - 如果命名文件存在但为目录而非常规文件、不存在但无法创建或因任何其他原因无法打开