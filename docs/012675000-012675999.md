# StackOverflow 问答 12675000-12675999

# wcf - WCF - 没有端点监听

> ID：12675000
> 
> 赞同：1
> 
> 时间：2012-10-01T14:14:06.703
> 
> 标签：wcf, endpoint, endpoint-address

我的一个 WCF 服务有一个以大文件作为参数的操作合同。因此，当客户端尝试发送此信息时，我遇到了一个异常，当我查看服务器跟踪时，这就是我所看到的：

> MESSAGE：已超出传入邮件的最大邮件大小配额 (65536)。要增加配额，请在适当的绑定元素上使用 MaxReceivedMessageSize 属性。

我为我的 WCF 服务使用了默认的简化配置，因此添加了一个新的服务定义，如下所示：

```
<system.serviceModel>
<services>
  <service name="MyNamespace.MyService">
    <endpoint address="MyService.svc"
      binding="basicHttpBinding" bindingConfiguration="basicHttp"
      contract="MyNamespace.IMyService" />
  </service>
</services>
<bindings>
  <basicHttpBinding>
    <binding name="basicHttp" allowCookies="true"
             maxReceivedMessageSize="10485760"
             maxBufferSize="10485760"
             maxBufferPoolSize="10485760">
      <readerQuotas maxDepth="32"
           maxArrayLength="10485760"
           maxStringContentLength="10485760"/>
    </binding>
  </basicHttpBinding>
</bindings>
<behaviors>
  ...
</behaviors>
<protocolMapping>
    ...
</protocolMapping> 
```

我使用服务的方式是，我有一个函数在我的帮助类中返回一个通道，我使用该通道来调用操作：

```
public static T CreateChannel<T>() where T : IBaseService
{
    System.ServiceModel.BasicHttpBinding binding= new System.ServiceModel.BasicHttpBinding();

    binding.TransferMode = TransferMode.Streamed;
    binding.Security = new BasicHttpSecurity() { Mode = BasicHttpSecurityMode.None };
    binding.MaxReceivedMessageSize = 10485760;
    binding.MaxBufferSize = 10485760;

    System.ServiceModel.ChannelFactory<T> cf2 = new ChannelFactory<T>(binding, 
             new System.ServiceModel.EndpointAddress(MyEndpointAddress)); //I checked this part, the address is correct.
    T Channel= cf2.CreateChannel();
    return Channel;
} 
```

接着，

```
var businessObject = WcfHelper.CreateChannel<IMyService>();
var operationResult = await businessObject.MyOperationAsync(...); 
```

尽管我的其他服务运行正常，但我在配置中定义的服务明确返回*“没有端点监听...”*的异常，我正在使用 IISExpress 在 VS2012 上开发。可能是什么问题，有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:35:37.863

我认为传输模式不匹配。在客户端，您正在使用流式传输，而在服务器端，它不在配置中。此外，您指定了 10MB，这并没有那么高。

请访问[此](http://msdn.microsoft.com/en-us/library/ms733742.aspx)以获取有关流媒体的更多信息。

**编辑 ：**

如果您在 IIS 下托管，请同时检查（默认为 4Mb）：

```
<system.web>    
    <httpRuntime maxRequestLength="4096 " />
</system.web> 
```

# windows - 如何在 windows 2000 中获取客户端名称和对象状态

> ID：12675003
> 
> 赞同：0
> 
> 时间：2012-10-01T14:14:18.183
> 
> 标签：windows, active-directory, windows-2000

正如我们所知，在 Windows 2003 中通过 WMI_NTdomain.clientsitename 获取客户端站点名称很容易，通过 WMI_NTdomain.status 获取对象状态，但该类在 Windows 2000 中不存在。那么您能告诉我如何通过脚本或命令获取这些值线？我的旧系统在 Windows 2000 上仍然运行良好，我现在不想更改它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T21:20:04.460

使用 reg.exe、vbscript 或您最喜欢的脚本/编程语言获取 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\Netlogon\Parameters\DynamicSiteName。

编辑：我承认我已经有一段时间没有看过 W2k 了。此 VB 脚本是否输出有用信息：

```
option explicit

dim adSys
Set adSys = CreateObject("ADSystemInfo")

WScript.Echo "SiteName=" & adSys.SiteName
'WScript.Echo "Computername DN=" & adSys.ComputerName
'WScript.Echo "Username DN=" & adSys.UserName
'WScript.Echo "DomainDNSName (Comp)=" & adSys.DomainDNSName
'WScript.Echo "DomainShortName (Comp)=" & adSys.DomainShortName
'WScript.Echo "ForestDNSName (Comp)=" & adSys.ForestDNSName 
```

您还可以使用[WMI ScriptOmatic](http://www.microsoft.com/en-us/download/details.aspx?id=12028)来搜索相关类。

# authentication - 跨平台 ServiceStack 身份验证

> ID：12675009
> 
> 赞同：8
> 
> 时间：2012-10-01T14:14:25.457
> 
> 标签：authentication, servicestack

构建以下身份验证解决方案的最佳方法是什么？

我有一个独立的（未与 MVC 集成）ServiceStack REST 服务层。该服务是我所有数据的入口点。没有数据存储在客户端上。

我有多个客户端（ASP.Net MVC 4 站点、MonoTouch 应用程序、MonoDroid 应用程序、Silverlight 应用程序、MonoMac 应用程序等）。

我想在服务级别提供身份验证（Facebook、Twitter 等），包括将用户存储在 MongoDBAuthRepository 中，但允许客户端提供登录 UI（我想要这个吗？）。例如，对于 MVC 站点，我想将远程 ServiceStack 身份验证服务（包括 Facebook、Twitter）与 MVC 的身份验证系统集成。看起来实际的身份验证应该发生在服务端，但客户端需要保留身份验证响应。

我已经阅读了 wiki，查看了 SocialBootstrap，并阅读了论坛，但我仍然对它应该如何以分布式方式工作感到困惑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T19:35:16.300

对于 Twitter + Facebook 等 OAuth 选项，您的身份验证应该在浏览器中进行，因为它们每个都需要来自其受人尊敬的身份验证提供商的重定向，以从每个用户那里获取可信验证。一些移动应用程序通过为 Twitter + FB Auth 嵌入浏览器小部件来实现这一点。

一旦用户在同一个认证会话中通过 Twitter + Facebook 和 Credentials 认证，[ServiceStack 的 AuthProviders 会](https://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization)自动将所有 Auth 信息合并到同一个帐户中。因此，稍后您将能够使用 1 个身份验证提供程序登录，但可以访问所有 3 个可用的信息[。SocialBootstrapApi](https://github.com/ServiceStack/SocialBootstrapApi)项目提供了一个示例。

# twitter-bootstrap - Twitter Bootstrap 下拉菜单在悬停时处于活动状态并使其下拉父级可点击（链接）

> ID：12675010
> 
> 赞同：1
> 
> 时间：2012-10-01T14:14:25.363
> 
> 标签：twitter-bootstrap, navbar

> **可能重复：**
> [允许点击 twitter bootstrap 下拉切换链接？](https://stackoverflow.com/questions/12630188/allow-click-on-twitter-bootstrap-dropdown-toggle-link)

好吧，伙计们，我对引导导航栏有点困惑。我更改了：悬停上的下拉菜单，就像这个小提琴[http://jsfiddle.net/ekjxu/](http://jsfiddle.net/ekjxu/)一样，工作正常。但我想知道的是，如何制作下拉菜单的一级菜单？

1.  第一个菜单（下拉菜单：悬停和可点击链接）
    *   第一个子菜单
    *   第二个子菜单
2.  第三菜单
3.  第四菜单

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:47:42.630

如果可以在另一个窗口中打开它，应该这样做：

[在其他选项卡上](http://jsfiddle.net/ekjxu/438/)

否则这会在同一个选项卡中打开它

[相同的选项卡](http://jsfiddle.net/ekjxu/442/)

# android - 在android中使用相机api打开相机

> ID：12675012
> 
> 赞同：1
> 
> 时间：2012-10-01T14:14:34.743
> 
> 标签：android, android-camera

我想在不使用意图的情况下在 android 中打开相机。我想在打开相机之前设置相机的参数。（例如，我想在启动相机之前将相机视图的默认方向设置为“LandScape”）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:39:20.320

看看这里。[您可以使用表面视图http://developer.android.com/guide/topics/media/camera.html](http://developer.android.com/guide/topics/media/camera.html)创建您自己的相机应用程序

# php - 来自mysql的php复选框

> ID：12675020
> 
> 赞同：0
> 
> 时间：2012-10-01T14:15:18.933
> 
> 标签：php, html, mysql, database, checkbox

我已经设法使用带有复选框的 php 从 mysql 数据库中提取记录。我正在努力使选定的记录（带有复选框）出现在新页面上。到目前为止，这是我的代码：

```
<?php 
include('connect.php');
$query = 'SELECT * FROM grades'; 

if ($r = mysql_query($query)) {  
    print "<form> 
    <table>"; 
    while ($row = mysql_fetch_array($r)) { 
        print  
            "<tr> 
            <td>{$row['InstitutionName']}</td> 
            <td>{$row['InstitutionAddress']}</td> 
            <td>{$row['SubjectArea']}</td> 
            <td><input type='checkbox' name='check[$row{['GradeID']}] value='check' /></td> 
            </tr>"; 
    } 
    print "</table> 
    </form>"; 

    $checkbox[] = isset($_POST['checkbox']) ? true : false;
} else {  
    print '<p style="color: blue">Error!</p>'; 
}  
?> 

<html>
<form action="check2.php" method="POST">
<input type='submit' name='Submit' value='Submit'>
</html> 
```

在我希望显示所选记录的页面上，我有：

```
<?php
if(isset($checkbox)) 
{ 
    foreach($checkbox as $value) 
    { 
        echo $value."<br>"; //it will print the value of your checkbox that you checked 
    } 
} 
?> 
```

任何援助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:22:34.397

更好的方法是将复选框命名为 check[]。然后每个复选框值应该是 ID（而不是检查）。

然后在您的结果页面上，只需遍历 check[] 的每个实例并打印出该值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:25:24.697

```
check[$row{['GradeID']}] 
```

对我来说似乎不正确，应该是：

```
check[{$row['GradeID']}] 
```

注意移动的左大括号到 $ 之前

对不起，如果这是错误的，很长时间没有使用 PHP，但它对我来说很突出

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:41:15.300

这是表单打印功能中的几个错误。您必须将操作放在第一个表单上，而不是第二个表单上，您还必须更改打印复选框的方式。尝试以这种方式打印表单：

```
<?php 
    include('connect.php');
    $query = 'SELECT * FROM grades'; 

    if ($r = mysql_query($query)) {  
        print "

            <form action=\"check2.php\" method=\"POST\">

            <table>"; 

        while ($row = mysql_fetch_array($r)) { 
            print  
                "<tr> 
                     <td>{$row['InstitutionName']}</td> 
                     <td>{$row['InstitutionAddress']}</td> 
                     <td>{$row['SubjectArea']}</td> 
                     <td><input type='checkbox' name='check[".$row['GradeID']."]         value='".$row['GradeID']."' /></td>
                 </tr>"; 
        }

        print "</table>
               <input type='submit' name='Submit' value='Submit'>
               </form>"; 

        $checkbox[] = isset($_POST['checkbox']) ? true : false;
    } else {  
        print '<p style="color: blue">Error!</p>'; 
    }  
?> 
```

并打印读取 _REQUEST 数组的复选框：

```
<?php   
    if(isset($_REQUEST["check"])) 
    { 
        foreach($_REQUEST["check"] as $key=>$value) 
        { 
            echo $key."<br>"; //it will print the value of your checkbox that you checked 
        } 
    } 
?> 
```

这应该有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T14:17:46.033

把checked="checked" 就像你把value="check" 放在一起：

```
<td><input type='checkbox' name='check[$row{['GradeID']}] value='check' checked="checked" /></td> 
```

**编辑：**

大概是我误会了你。你期望看到什么？

首先，您应该使表单执行 POST 请求而不是 GET（默认）：

```
print "<form method='POST' action='THE_FILE_YOU_PRINT_RESULTS.php'>" 
```

然后在“THE_FILE_YOU_PRINT_RESULTS.php”`print_r($_POST);`中查看你得到了什么以及如何显示它。

# asp.net - TimeSpan 的正则表达式，格式为“hh.mm”

> ID：12675023
> 
> 赞同：0
> 
> 时间：2012-10-01T14:15:30.573
> 
> 标签：asp.net, regex, timespan

我想创建 RegularExpressionValidator 来验证**TextBox**格式**hh.mm**。

这个表达式有效：

```
^([0-9]|0[0-9]|1[0-9]|2[0-3]).[0-5][0-9]$ 
```

但是如果我`5454`在 TextBox 中插入它也会通过，但它不应该。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T14:16:37.467

`.`是正则表达式中匹配**任何**字符的元字符。如果你只想匹配一个句号，那么你需要转义它：

```
^([0-9]|0[0-9]|1[0-9]|2[0-3])\.[0-5][0-9]$ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T14:17:37.687

你忘了逃跑`.`

尝试

```
^([0-9]|0[0-9]|1[0-9]|2[0-3])\.[0-5][0-9]$ 
```

# ios - 我可以将 UIView 分组到另一个 UIView 中吗？

> ID：12675026
> 
> 赞同：2
> 
> 时间：2012-10-01T14:15:35.567
> 
> 标签：ios, uiview

我有一个关于 iOS 视图层次结构的问题（感谢您的回答）。

上下文：我使用切换视图（2 段）来隐藏或显示几个`UIView`s ( `UILabel`s, `UISlider`s)。

`UIView`将这些s 包装在`UIView`包装器中以对 s 进行分组是一个好习惯`setHidden:YES/NO`吗？

例如我第一次有：

```
[label1 setHidden:YES]
[label2 setHidden:YES]
[label3 setHidden:YES]
[label4 setHidden:YES]
[picker1 setHidden:YES] 
```

我通过将标签和选择器放在一个唯一的`UIView`（在界面生成器中）来转换它，我连接了这个`UIView`

```
@property (retain, nonatomic) IBOutlet UIView *multipleViewsContainer; 
```

然后我做一个独特的：

```
[multipleViewsContainer setHidden:YES] 
```

我只是想知道我是否可以像这样使用 UIView，或者是否还有其他方法可以隐藏/显示视图组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:16:40.337

是的。`setHidden`您可以将多个 UIView 嵌入到另一个 UIView 中，然后通过“ ”调用隐藏或显示整个内容。

# java - 我的班级是线程安全的吗？如果不是为什么？

> ID：12675029
> 
> 赞同：6
> 
> 时间：2012-10-01T14:15:47.593
> 
> 标签：java

我的班级是线程安全的吗？如果不是为什么？

```
class Foo {
 boolean b = false;

 void doSomething() throws Exception {
    while (b) Thread.sleep();
 }

 void setB(boolean b) {
     this.b = b;
 }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-01T14:19:34.860

代码不是线程安全的，因为正在运行的线程可能会在代码编译之前看到更改（稍后可能是随机点）并且您不再看到更改。

顺便说一句：这使得测试变得非常困难。例如，如果您睡 1 秒钟，您可能会在将近三个小时内看不到这种行为。

即它可能会或可能不会起作用，你不能说它已经起作用了，它会继续起作用。

* * *

因为JIT 不能也不会`b`优化`volatile`

```
while (b) Thread.sleep(N); 
```

成为

```
boolean b = this.b;
if (b) while (true) Thread.sleep(N); 
```

所以`b`不是每次都读取的值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-01T14:17:04.143

它不是。`setB()`更新实例变量`b`值但不是`synchronized`。

多个线程可能会尝试`setB()`在同一时间点执行方法可能会导致无法预测的结果。

您需要`synchronize`方法（或）使用`synchronize`锁定`this`对象的块。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-01T14:20:41.200

看看[AtomicBoolean](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/atomic/AtomicBoolean.html)。这意味着任何时候只有一个线程可以访问它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-01T15:10:44.640

> 但是，它与线程安全有什么关系呢？有点困惑。

它可以追溯到“线程安全”的定义。维基百科是这样说的：

> *“线程安全是适用于多线程程序上下文的计算机编程概念。如果一段代码在多个线程同时执行期间正确运行，则它是线程安全的。”*

这里的关键是*功能正确*。如果您查看 Peter Lawrey 解释的场景，您会发现 JIT 编译可能导致代码不会注意到值何时`b`从`true`to更改`false`，而是永远循环。这显然是不正确的行为。而且由于这仅在有两个线程时才会出现，因此这是一个线程安全问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-01T14:19:01.677

这里有一个有争议的概念是可见性，在 Concurrent Java 中讨论过。如果 doSomething() 在不同的线程上运行，JVM 不保证在 setB 中执行的操作将适用于 doSomething 看到的 b 版本。所以你可以调用 setB 并且 doSomething 不能保证永远终止。

# wordpress - 如何将带有动态 URL 的整个 wordpress 文件夹重定向到单个页面

> ID：12675030
> 
> 赞同：2
> 
> 时间：2012-10-01T14:15:49.747
> 
> 标签：wordpress, .htaccess, redirect, dynamic

我有旧的 wordpress 博客，位于 mywebsite.com/wordpress 下

现在我已经移动了这个博客，但我想将整个 wordpress 文件夹重定向到单个类别页面 mywebsite.com/category/test

问题是我不知道如何重定向动态页面（一次全部），例如
wordpress/?p=1
wordpress/?p=2
wordrpess/?page_id=1362

和别的。

我不需要页面到页面重定向，只需要从 wordpress 文件夹到单个类别页面的整个重定向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:30:15.967

我看到您使用了 .htaccess 标记，因此假设您可以访问 .htaccess 文件。

在您网站根目录的 .htaccess 中试试这个：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^mywebsite\.com$
RewriteRule ^facts/(.*)$ http://mywebsite.com/category/test/ [R=permanent,L] 
```

让我们知道这是否有效！

编辑：添加一个？到目标规则的末尾以去除查询字符串信息：

```
RewriteRule ^facts/(.*)$ http://mywebsite.com/category/test/? [R=permanent,L] 
```

本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:19:02.377

我很确定dashboard-->settings-->general（也许？）下有一个选项可以让你指定你的登陆页面！这应该将您的网站重定向到该类别页面....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T12:59:43.837

在`.htacess`文件中重定向页面

```
Redirect /themes_name/your_file.php /themes_name/your_file.php 
```

首先是您的旧博客文件路径和第二个新博客文件路径

# perl - 使用 Perl，如何删除 HTML 文档中特定标签的内容？

> ID：12675034
> 
> 赞同：1
> 
> 时间：2012-10-01T14:16:12.413
> 
> 标签：perl, html-parsing

我是 Perl 的新手。我必须在多行中查找和替换。

```
$content =~ s/<picture[^>]*>(.*?)<\/picture>//gis; 
```

我试过这些代码。我的文件中的所有标签都被替换了。任何人帮助我，我的错误是什么？

我的标签是，

```
<picture width='960' height='705' baseline='360'>
    <pict-header>
    </pict-header>
</picture> 
```

现在替换为

```
<picture></picture> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T14:28:56.573

根据我认为你想做的事情，这里是你需要改变的。您的表达式匹配任何`<picture>`标签直到第一个`</picture>`标签，无论它是否实际上关闭了您匹配的第一个标签。

假设嵌套`<picture>`标签是非法的，您需要做的就是`<picture></picture>`在替换的替换部分添加，例如：

```
$content =~ s/<picture[^>]*>(.*?)<\/picture>/<picture><\/picture>/gis; 
```

提示：在处理带有斜线的表达式时，请执行以下操作，这样您就不需要转义斜线：

```
$content =~ s@<picture[^>]*>(.*?)</picture>@<picture></picture>@gis; 
```

这仍然不完美！例如，这个：

```
<picture stuff="adfgerth"><picture stuff="235wefw45"><somejunk /></picture></picture> 
```

将替换为：

`<picture></picture></picture>`

但是现在您已经到了一个正则表达式不够用的地步，您可能需要一个 XML 解析器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-02T15:37:17.937

使用 HTML 解析器解析 HTML 可以省去很多麻烦：

```
#!/usr/bin/env perl

use strict; use warnings;
use HTML::TokeParser::Simple;

die "Need filename\n" unless @ARGV == 1;
my ($filename) = @ARGV;

my $parser = HTML::TokeParser::Simple->new(file => $filename);

while (my $token = $parser->get_token) {
    if ($token->is_start_tag('picture')) {
        $parser->get_tag('/picture');
        print "<picture></picture>";
    }
    else {
        print $token->as_is;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-02T17:38:40.060

Sinan 的回答有效，但更好的解决方案可能是使用 DOM 解析器，例如[`Mojo::DOM`](http://p3rl.org/Mojo%3a%3aDOM)（它是[Mojolicious](http://mojolicio.us)框架的一部分）。然后你可以做一些非常简单的操作，比如

```
#!/usr/bin/env perl

use strict;
use warnings;

use Mojo::DOM;

my $content = <<'END';
<picture width='960' height='705' baseline='360'>
    <pict-header>
    </pict-header>
</picture>
END

my $dom = Mojo::DOM->new($content);

$dom->at('picture')->replace('<picture></picture>')->root;

print $dom; 
```

# javascript - 获取文本框值以在同一页面中创建链接

> ID：12675035
> 
> 赞同：1
> 
> 时间：2012-10-01T14:16:18.030
> 
> 标签：javascript, ajax

我想创建一个具有以下`href`属性的链接：

```
app\process?val=12000 
```

但是`val`参数的值（在这种情况下`12000`）必须来自页面上文本框的值。

我知道我可以`$(#textbox).value()`用来获取值，但是当值发生变化时我需要更改链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:23:07.627

```
<a id="link">this is a link </a>

$('#textbox').change(function(){
    $('#link').attr('href', 'app\process?val=' + this.value);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:21:14.537

这是您可以尝试的**[示例。](http://jsfiddle.net/yWTfE/2/)**

HTML：

```
<input type="text" id="text"></input>
<button type="button" id="button">Get Link</button>
<br/>
<a href="#">Test Link</a> 
```

jQuery：

```
$("#button").on("click", function(){
    param = $("#text").val();
    alert("www.example.com\apps?val=" + param);
    $("a").attr("href", "www.example.com\apps?val=" + param);
});​ 
```

在你有的 OP 中`$(#textbox).value()`，但这有一些问题。首先，选择器需要用引号括起来`$("#textbox")`，例如 textbox 是元素的 ID。此外，`.value()`它不是 jQuery 中的函数，实际上是`.val()`

# jquery - 自定义 jQuery 交互式 SVG 地图插件

> ID：12675038
> 
> 赞同：1
> 
> 时间：2012-10-01T14:16:21.947
> 
> 标签：jquery

背景 - 我正在为一小群酒店开发一个网站。他们当前的站点有一个图像地图，上面有指向每个位置的标记。问题是图标太大，并且正在建造太多的新酒店，继续这样做是不切实际的。没有房间。

我的解决方案 - 我在 Codecanyon.com 上找到了 jQuery Interactive SVG Map Plugin，它运行得非常好。我可以确定位置、添加标记，而且地图有很多功能，几乎是完美的解决方案。[http://codecanyon.net/item/jquery-interactive-svg-map-plugin/1694201](http://codecanyon.net/item/jquery-interactive-svg-map-plugin/1694201)

问题 - 虽然地图已经做了这么多，但它并没有完成我需要的一切。这是我要完成的工作的简短列表：

1.  单击状态会在视图框中居中显示状态并放大到最大值。

听起来很容易，对吧？该插件有一个“setViewBox”方法，用于设置默认视图框，如果我调用它 onClick 我可以让它做我想做的事，放大并居中状态。然而，这是正在发生的事情：

1.  像这样跳到更近的视图框不会自动缩放标记，这是消除站点当前面临的混乱问题所必需的。此外，它不会影响地图的“缩放”级别。假设我可以从 1-5 放大。我单击一个状态，看起来好像我跳到了缩放 5，但是当我开始缩放时，它从 1 开始，因此我可以比我预期的更远地放大而不是缩小。我希望我没有混淆。
2.  平移也有类似的情况。如果我像我所做的那样更改视图框以获得所需的结果，单击并按住平移突然使地图偏离位置，就好像光标认为我单击了其他地方一样。

我很想给你一些代码示例，但我不知道从哪里开始。我无法复制/粘贴插件，而且我的代码很少。

我要问的是，是否有人对这个插件有经验，并且可以提供一些关于在不放弃缩放、平移和缩放标记的情况下操作视图框的建议。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T13:06:04.843

这是另一个 jQuery 交互式 SVG 世界地图： http: [//bit.ly/QtBrrr](http://bit.ly/QtBrrr)它是纯 HTML5，带有可自定义的弹出窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T14:58:47.690

你可以试试[jVectorMap](http://jvectormap.com/)。这是一个类似的解决方案，但它是完全免费的。API 包含该`setFocus`方法，该方法允许将视口设置到某些区域而不会出现问题。

# javascript - JSZip 和变量范围

> ID：12675039
> 
> 赞同：0
> 
> 时间：2012-10-01T14:16:24.307
> 
> 标签：javascript, scope

我是编程新手。我正在尝试使用 JSZip 压缩 HTML5 文件系统中的一些文件，我发现 JSZip 和其他类型的对象之间存在以下差异。谁能给我解释一下？

```
<script src="jszip.js" type="text/javascript"></script>
<script>
function a(){
    var x=new JSZip();
    console.log(x) //Strange, it shows a JSZip object with folder abc
    b();

    function b(){
        x.folder("abc");
        console.log(x) //also shows a JSZip object with folder abc
    }
}
a();

function c(){
    var y=new Array();
    console.log(y) //shows []
    d();

    function d(){
        y[0]="abc";
        console.log(y); //shows ["abc"]
    }
}

c();
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T06:43:34.050

正如 Alex K. 所评论的，这是[Webkit 检查器的一个特性](https://stackoverflow.com/questions/8249136/why-does-javascript-object-show-different-values-in-console-in-chrome-firefox/8249333#8249333)。

如果将`console.log`行更改为`console.log(JSON.stringify(x));`，则将在该点评估对象，显示该对象包含您期望的属性。

# django - 为什么我们需要 uwsgi 来在 nGINX 上托管 Django

> ID：12675040
> 
> 赞同：5
> 
> 时间：2012-10-01T14:16:33.417
> 
> 标签：django, nginx, wsgi, uwsgi

让我们来看看：

Django 与 WSGI 兼容。WSGI 是 Web 服务器网关接口

现在，Nginx 是一个服务器。所以我们应该能够与 Django 进行通信。那么为什么我们需要 uWSGI 呢？

都说uWSGI是说wsgi协议的服务器。

那么什么是uwsgi协议。它与 WSGI（协议/规范）有何不同

再说一遍，为什么我们会找到 Django + uWSGI + Nginx 的组合？

我不能在 nginx 和 django 之间说 WSGI 吗？Coz WSGI 本身意味着成为 WebServer (nginx) 和 Web Applications (django) 之间的规范

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:21:17.470

WSGI 专门是一个 Python 接口，而 Nginx 是一个通用的网络服务器。因此，您至少需要在 Nginx 和 Django 之间进行一些东西，将标准的 http 请求转换为 WSGI 请求。

uWSGI 只是几个流行的 WSGI 服务器之一。其他包括 gunicorn 和 mod_wsgi（一个 Apache 模块，它也需要安装 Apache）。uWSGI 恰好是我的首选，而 nginx 现在对其协议具有原生支持，因此使用它不会出错。

# javascript - 使用 ember 的 containerView 类，如何将命名视图推送到 childView 数组中？

> ID：12675043
> 
> 赞同：2
> 
> 时间：2012-10-01T14:16:38.347
> 
> 标签：javascript, ember.js

该文档提供了一个示例：

```
aContainer = Ember.ContainerView.create({
    childViews: ['aView', 'bView', 'cView'],
     aView: Ember.View.create(),
     bView: Ember.View.create(),
     cView: Ember.View.create()
}); 
```

这真的很简洁，但是如果我想编写一个在调用时添加视图的函数，我如何命名我创建的每个视图？例如：

```
aContainer = Ember.ContainerView.create({
     childViews: [],

     newView: function( input ){
         var newView = BaseView.create({ field: input });
         this.get('childViews').pushObject( newView );
     }
}); 
```

这似乎将匿名视图推送到容器中。关于如何命名它的任何想法？

例如，有一个片段说：

```
newView: function( input ){
    var name = 'view_' + this.get('childViews').get('length') + 1
    var newView = BaseView.create({ field: input, meta: name  })
    this.get('childViews').pushObject( newView );
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:12:59.787

我认为没有添加命名视图的元属性。但是您始终可以自己分配它们。

```
 newView: function( input ){
     var name = 'view_' + this.get('childViews.length') + 1
     var newView = BaseView.create({ field: input });
     this.get('childViews').pushObject( newView );
     this.set(name, newView);
 } 
```

# xaml - 本地化 x:String

> ID：12675050
> 
> 赞同：4
> 
> 时间：2012-10-01T14:16:52.880
> 
> 标签：xaml, localization, windows-8

我在 MSDN 上看到过这样的问题，但没有得到解答。所以我可以使用 x:Uid 和 *.resw 文件中的特定键格式本地化我的所有控件。但是如何本地化 x:String？例如这个：

```
<x:String x:Key="AppName">My App</x:String> 
```

我知道一些解决方法。但是有什么好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T10:09:16.250

现在看来是不可能了。应该`x:String`只用于不应该被本地化的字符串（例如应用程序名称）。否则，`TextBlock`首选使用或其他一些文本控件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:22:23.550

[这里](http://timheuer.com/blog/archive/2012/04/26/localize-windows-8-application.aspx)有一篇关于这样做的 msdn 帖子。它的本质是这样的：

```
<TextBlock x:Uid="MyTextBlock" FontSize="24.667" Text="Design Placeholder" /> 
```

> 注意`x:Uid`这里的值。这现在映射回您的 RESW 文件中的键。任何具有该起始键的东西都会将属性合并到其中。因此，我们可以在 RESW 中使用键名 MyTextBlock.Text 为“Text”创建一个键，其值为“Hello World”，运行时将为您进行替换。

脚步：

1.  创建一个`x:Uid`定义了属性的文本块。
2.  为您的语言创建一个以您的本地化命名的 RESW 文件
3.  将字符串添加到 RESW 以替换文本块中的属性

# php - 如何使用 Google Maps API v3 在地图上显示多个城市

> ID：12675056
> 
> 赞同：0
> 
> 时间：2012-10-01T14:17:01.713
> 
> 标签：php, json, google-maps-api-3

我有一个 php 中的城市列表，例如：

```
$cities = array(0=>"Absecon,NJ",1=>"Alamogordo,NJ",2=>"Atlantic city,NJ....); 
```

我必须在地图上显示我所有的城市，如果我没有纬度和经度，可以吗？

我以这种方式初始化地图：

```
<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map_canvas { height: 100% }
    </style>
    <script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js?key=MY_API_KEY&sensor=true">
    </script>
    <script type="text/javascript">
      function initialize() {
        var countries = '<?php echo json_enconde($cities);?>';
        var mapOptions = {
          center: new google.maps.LatLng(-34.397, 150.644),
          zoom: 2,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"),mapOptions);
      }
    </script>
  </head>
  <body onload="initialize()">
    <div id="map_canvas" style="width:100%; height:100%"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:25:17.500

对我来说，那些看起来不像“国家”，你的例子似乎是美国的城市或城镇（正如你在标题中指出的那样）。

[地理编码 Web 服务](https://developers.google.com/maps/documentation/geocoding/)将返回地名的地理坐标，但受配额和速率限制。

通常的建议是离线对您的地点进行地理编码，存储结果坐标并使用这些坐标显示地图。

[这](https://developers.google.com/maps/articles/geocodestrat)是有关地理编码策略的文档中的一篇文章。

# php - 有时我的页面无法访问 PHP 会话变量

> ID：12675062
> 
> 赞同：0
> 
> 时间：2012-10-01T07:18:38.490
> 
> 标签：php, session

我正在开发电子商务 Web 应用程序，它拥有用户和权限。所以根据他们的许可，

例如：我正在存储变量`$chk = 'write'`或`$chk = 'read'`在会话中，我的情况是

```
if ($chk == 'write')
{
   // some function here to modify the page & its content
   // If true, then display SAVE button to save all changes made.
} 
```

但是，有时我的页面无法访问这个变量，它的值`$chk`是未知的，因此它不显示 SAVE 按钮。但是，它会在刷新页面或稍后访问后显示按钮。谁能帮我解决这个问题..提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:21:54.780

PHP 中的会话变量需要存储在`$_SESSION`魔法变量中，以将它们保存在多个页面中。为了确保一个页面可以访问会话，您还需要`session_start()`在每个页面上调用。

在这种情况下，更改`$chk`为`$_SESSION['chk']`并`session_start()`在每个页面的顶部添加可能会奏效。

# java - 使 Web 应用程序使用 UTF-8

> ID：12675070
> 
> 赞同：2
> 
> 时间：2012-10-01T14:17:42.507
> 
> 标签：java, tomcat, web-applications, utf-8, tomcat7

我们在使用 Tomcat 7 的生产服务器上，无论出于何种原因，管理员都不会`CATALINA_OPTS="-Dfile.encoding=UTF-8"`为我们设置解决方法。

这意味着现在在部署 WAR 文件时，Tomcat 返回乱码而不是对应的 Unicode。

我们也将其包含在我们的`web.xml`中，但无济于事：

```
<filter>
    <filter-name>encoder</filter-name>
    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
    <init-param>
        <param-name>encoding</param-name>
        <param-value>UTF-8</param-value>
    </init-param>
    <init-param>
        <param-name>forceEncoding</param-name>
        <param-value>true</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>encoder</filter-name>
    <url-pattern>*</url-pattern>
</filter-mapping> 
```

我们如何在不派人闯入服务器机房并修改配置的情况下进行管理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:32:34.893

首先，重要的是要了解确切的*作用*`-Dfile.encoding=UTF-8`。这是特定于 Sun/Oracle JVM 的设置（因此不一定适用于所有其他 JVM！），它基本上指示 JVM`.class`使用给定编码而不是平台默认编码读取 Java 文件。因此，设置它只会解决任何可能的[Mojibake](http://en.wikipedia.org/wiki/Mojibake)问题，这些问题是由于在 Java 类/变量名中使用“特殊字符”或在 Java 类中使用硬编码`String`值引起的（是的，你没看错：只有 Java 类，而不是其他文件，因此肯定不是属性文件或 JSF XHTML 文件等）。

老实说，我很难想象这是解决您具体问题的正确方法。为什么会在 Java 类中直接使用特殊字符？类/变量名称应为全英文，本地化文本应放在资源包文件中。每个自尊的 Java 开发人员都遵守这个约定。

鉴于这一事实，并假设您根本没有在 Java 类中使用特殊字符，因此我相信您的具体问题是由其他原因引起的。问题症状描述得不够具体（它到底在哪一步失败？您期望和得到哪些字符？等等）以查看具体问题的可能根本原因。我至少可以看出你的 Spring 过滤器的 URL 模式是完全错误的。它必须映射到`/*`

```
<filter-mapping>
    <filter-name>encoder</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

*（顺便说一句，您不一定*需要*Spring，只需[一个自定义`Filter`](https://stackoverflow.com/questions/9634230/typing-chinese-with-primefaces-peditor-component/9839362#9839362)，只有 2 或 3 行`doFilter()`实现就足够了）*

### 也可以看看：

*   [Unicode - 如何让字符正确？](http://balusc.blogspot.com/2009/05/unicode-how-to-get-characters-right.html)

# graph - 与动态规划有关的困惑

> ID：12675074
> 
> 赞同：0
> 
> 时间：2012-10-01T14:18:09.810
> 
> 标签：graph

我正在浏览与动态编程相关的这个页面。我对给定的复杂性感到非常困惑

![在此处输入图像描述](../Images/bd06eaca7d4300cb90f246951c358dcd.png)

在第三种情况下，复杂度为 $O(n^2)$。我不确定它是怎么变成这样的。任何人都可以请详细说明。这里的复杂性是如何计算的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:50:44.307

如果 i 和 j 的范围都在 1 到 n 之间，我可以通过考虑将 i 固定在 1 而 j 从 1 到 n 的范围来查看 n^2 个子问题。然后对 i 1-n 的所有值执行相同的操作。但是图片和集合符号似乎暗示 j > i （一个连续的、唯一的集合），所以我认为这让它有点混乱。我在想象 i=2, j=1... 可以是 x2, x3 （将 j 解释为我们想要从 2 开始的 x 的数量？）或 x2, x1 （将 j 解释为索引）...。

# gradle - 如何在 Gradle 构建中干净地分离测试任务的两个实例

> ID：12675080
> 
> 赞同：2
> 
> 时间：2012-10-01T14:18:34.900
> 
> 标签：gradle

从[这个问题](https://stackoverflow.com/questions/12638514/why-do-my-gradle-tests-run-repeatedly/12674403#12674403)开始。

如果我有一个包含两个`Test`任务实例的构建，那么完全分离这两个任务以使其输出不重叠的最佳（最干净、最少代码、最健壮）的方法是什么？

我已经尝试设置它们的`testResultsDir`和`testReportsDir`属性，但这似乎没有按预期工作。（也就是说，输出被写入单独的目录，但两个任务仍然在每次运行时重新运行各自的测试。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-08T15:14:39.613

**从 gradle 1.8 开始更新当前情况：**自 gradle 1.3 起，dty 的答案中的 testReportDir 和 reportsDir 属性已被弃用。测试结果现在在“test-results”目录中自动分离，并为 HTML 报告设置不同的目标目录，调用

```
tasks.withType(Test) {
    reports.html.destination = file("${reporting.baseDir}/${name}")
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T09:30:39.087

再一次，Rene 为我指明了正确的方向。谢谢你，雷内。

事实证明，这种方法确实有效，但我一定是做错了什么。

`Test`作为参考，在定义了所有任务后，我在构建中添加了以下内容：

```
tasks.withType(Test) {
    testReportDir = new File("${reportsDir}/${testReportDirName}/${name}")
    testResultsDir = new File("${buildDir}/${testResultsDirName}/${name}")
} 
```

通过将任务名称作为其目录层次结构的一部分，这将导致`Test`任务的所有实例彼此隔离。

但是，我仍然觉得这有点邪恶，并且必须有一种更清洁的方法来实现这一点，我还没有找到！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-26T14:43:55.617

Ingo Kegel 的回答没有解决结果目录，只有报告目录。这意味着可以构建特定测试类型的测试报告，其中包含比该类型更多的测试结果。这也可以通过设置结果目录来解决。

```
tasks.withType(Test) {
    reports.html.destination = file("${reporting.baseDir}/${name}")
    reports.junitXml.destination = file("${testResultsDir}/${name}")
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-05T04:14:25.830

只是一个更新。该`reports.html.destination`方式已弃用。

这是“新”方式（Gradle > 4.x）：

```
tasks.withType(Test) {
  reports.html.setDestination file("${reporting.baseDir}/${name}")
} 
```

# lua - 如何访问或调用外部库内函数内的全局函数？

> ID：12675081
> 
> 赞同：0
> 
> 时间：2012-10-01T14:18:35.333
> 
> 标签：lua, coronasdk, moai

好吧，我有一个像这样的类作为例子：

```
 --An External Library --UI.lua
    UI = {}
   function UI: new()
    local Group = display.newGroup;

    local inventory_frames = display.newImage("inventorybox.png") ;
    Group :insert( inventory_frames) ;

    function inventory_framesDown()

      local tr_down = transition.to(inventory_frames,{time = 150,alpha = 0, x=0 ,y =8})

    end 

    return Group
    end
    return UI 
```

现在从我的实际scene.lua（使用故事板API）来自corona。

1.local ui= require"UI.lua" 之后在我的创建场景函数（）中（我没有把它放在组场景中的原因是因为我想让它手动消失）

```
local UI2 = UI:new() 
```

然后在我的退出场景函数中。我想从 UI:new() 中调用函数 inventory_framesDown()。

```
function scene:exitScene(e)

invent = UI:new() inventory_framesDown() --this dose not work

storyboard.purgeScene("scene2");
storyboard.removeAll()

end 
```

那么如何从外部库调用全局函数内部的全局函数呢？提前致谢：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:57:17.327

基本上 ;

```
--An External Library --UI.lua

  UI = {}
    function UI:new()
    local Group = display.newGroup;

    local inventory_frames = display.newImage("inventorybox.png") ;
    Group :insert( inventory_frames) ;

    function Group: inventory_framesDown() -- I rewrite the code like this.

      local tr_down = transition.to(inventory_frames,{time = 150,alpha = 0, x=0 ,y =8})

    end 

return Group
end
return UI 
```

然后在需要库之后在我的 Scene.lua 中。在创建场景函数（）中，我写 local UI2 = UI:new() 与以前相同，然后：

```
function scene:exitScene(e)

UI2.inventory_framesDown()  --This Works

storyboard.purgeScene("scene2");
storyboard.removeAll()

end 
```

我仍然有点困惑为什么要这样做？因为有这么多创建类和对象的方法。如果你有更好的解决方案，我很想知道再次感谢。

# redis - Pub/Sub 和 Redis 集群

> ID：12675082
> 
> 赞同：6
> 
> 时间：2012-10-01T14:18:41.943
> 
> 标签：redis

在这个[链接](http://redis.io/topics/cluster-spec)上，它说“当前的实现将简单地将所有发布消息广播到所有其他节点”，并补充说它会在未来得到改进。

**对于当前的实现：**如果丢失消息不重要；现在将 redis 用于发布/订阅是否有意义？看起来一个实例更好地停止广播流量。因为旁边写；读取也应该传播到其他节点！（这样客户就不会被通知两次。）

我错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T15:00:51.453

不，我认为你没有漏掉任何一点。Redis Cluster 是一项正在进行的工作，其中包括规范。关于 pub/sub 的部分相当简单，可能需要改进。

在 Salvatore 的提议中，客户端订阅了单个实例（不是所有实例），因此当将发布广播到所有实例时，客户端只会收到一次通知。如果 Redis 实例关闭，则由客户端在集群的一个幸存节点（任何其他节点）上进行订阅。

另一种可能性是选择集群的一个节点作为唯一的发布/订阅节点，以便客户端只能在该节点上发布和订阅。但是以这种方式支持发布/订阅服务的高可用性将更加困难。

# vim - 如何在脚本中使用 vim 命令？

> ID：12675084
> 
> 赞同：1
> 
> 时间：2012-10-01T14:18:43.730
> 
> 标签：vim

我想删除文本文件的第二行。使用`vim`或`ex`任何类型的文本编辑器表单脚本。我想出了这些命令，但对我不起作用。

```
#!/bin/sh

iconv -f Utf-16le -t utf-8  ~/Desktop/upload.csv -o ~/Desktop/finalutf.csv

vim ':2d|wq' ~/Desktop/finalutf.csv 

ex -sc '%s/\r//e|x' ~/Desktop/finalutf.csv 
```

该脚本`.sh`是可执行的。第一行代码有效，第三行也有效，但第二行不行。我试图查看用于删除特定行的 vim 命令的文档，并在终端上进行了尝试，并且它有效（`:2d`）尝试在脚本中使用它似乎令人困惑。我是 Ubuntu 以及 vim 和脚本的新手，尝试学习似乎已经够难了，在它的文档中，对于学习 vim 的初学者来说，解释了很多复杂的命令。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T14:25:27.650

`sed`这就是为之而生的东西。

```
sed -i 2d ~/Desktop/finalutf.csv 
```

但是，如果您必须使用 vim，您可以这样做

```
vim -c "2d|wq" ~/Desktop/finalutf.csv 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-01T14:25:40.653

这对我有用：

```
vim -c "2d|wq" infile 
```

# google-visualization - 如何居中对齐基于 svg 的 Google 图表（因为它们有位置：绝对）

> ID：12675085
> 
> 赞同：1
> 
> 时间：2012-10-01T14:18:45.553
> 
> 标签：google-visualization

有人知道如何将新的（即基于 svg 的）谷歌图表居中对齐吗？

[当我在我的网页上](http://preferans.de/OK408547485023)检查图表元素时（请向下滚动到该页面上带有多个 Google 图表的 jQuery 选项卡），我看到图表本身被赋予了一个`absolute`位置：

```
<div style="position: absolute; left: 0px; top: 0px; width: 100%; height: 100%; ">
<svg width="800" height="500" style="overflow: hidden; "> 
```

我不确定谷歌为什么这样做，但它破坏了我的布局（除了图表对我很有效）：

![在此处输入图像描述](../Images/94fa675b04c7c18d1acf74fc4e36d8dc.png)

我的 CSS 代码：

```
 h1,h2,h3,p,div,form { 
    text-align: center; 
} 
```

我也尝试在那里添加：

```
 margin-left: auto; 
    margin-right: auto; 
```

我的 JavaScript 代码：

```
var money_data;
var money_chart;
var money_options = {
        width: 800,
        height: 500,
        legend: {position: 'top'},
        areaOpacity: 1.0,
        vAxis: {format: '# $'},
        hAxis: {title: 'Номер недели', titleTextStyle: {color: 'blue'}, slantedText: true, viewWindow: {min: 39, max: 52}},
        colors: ['CCFFCC', '66CC66', 'FF9999'],
        animation: {duration: 1000, easing: 'out'}
};

function initMoney() {
        $.ajax({
                url: '/money-json.php',
                data: { id: 'OK408547485023' },
                dataType: 'json'
        }).done(function(jsonData) {
                money_data = new google.visualization.DataTable(jsonData);
                money_chart = new google.visualization.SteppedAreaChart(document.getElementById('money_chart'));
                google.visualization.events.addListener(money_chart, 'ready', function() {
                        $('#money_slider').slider('enable');
                });
                drawMoney();
        });
}

function drawMoney() {
        money_chart.draw(money_data, money_options);
} 
```

如果这里没有基于 CSS 的解决方案，我是否可以使用 JavaScript 将 SVG 移动到与启用后者相同的位置（请参阅上面的代码）`x`？`money_slider`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:30:13.607

您可以将 money_chart DIV 的大小设置为图形的大小（我猜是 800px ）并像这样使用自动边距。

```
#money_chart{
    margin-left: auto;
    margin-right: auto;
    width: 800px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-23T06:52:28.670

您需要将图表侧设为另一个 div 这是我的代码，它适用于我

```
.chart_outside{
        position:relative;
        display: inline;
        border: 2px solid #FFF;
        width: 500px;
        height: 460px;
        background: #000;
        margin: 5px 5px 5px 5px;
        }

.chart_inside{
        position:absolute;
        right:0px
        ;top:0px;
        } 
```

![在此处输入图像描述](../Images/11972591e67b80235fa0ea291edad5d4.png)

# php - 从父表单中删除验证组

> ID：12675090
> 
> 赞同：1
> 
> 时间：2012-10-01T14:19:03.210
> 
> 标签：php, symfony, symfony-2.1

我将 FOSUserBundle 与自定义注册表单一起使用，该注册表单扩展了捆绑包提供的注册表单。我想覆盖验证，所以它不检查用户名（我生成它）。我已经读过这可以通过使用验证组来实现。

这些是我的表格的相关部分：

```
public function buildForm(FormBuilderInterface $builder, array $options)
{

    parent::buildForm($builder, $options);

    ...

    $builder->remove('username');

    ...

}

public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver->setDefaults(array(
        'data_class' => 'Ysu\Bundle\SiteBundle\Entity\User',
        'validation_groups' => array('my-registration-group'),
        'cascade_validation' => true
    ));
}

... 
```

但是，用户名仍会使用捆绑包提供的验证文件进行验证。我发现`$options`(array) 包含一个数组`validation_groups`，该数组又包含“注册”组，所以这就是该字段仍然有效的原因。但是，我不知道如何删除它。如果我`$options`在将其传递给它之前取消设置它`parent::buildForm`仍将包含该`Registration`组。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T16:04:08.983

原来你可以在 config.yml 中为 FOSUserBundle 的表单配置验证组：

```
fos_user:
    ....
    registration:
        form:
            validation_groups:  [default, registration_mod]
            .... 
```

# python - 尝试发布新的软件包版本时，如何解决来自 pypi 的 500 响应？

> ID：12675091
> 
> 赞同：4
> 
> 时间：2012-10-01T14:19:02.867
> 
> 标签：python, pypi

我正在尝试向 pypi 发布新版本的软件包。这是使用 python 2.7，我目前的目标是使用 pythons 2.6/2.7。

相关软件包的当前版本是 0.0.2-1。（这`-1`是我在某处读到的构建标签约定；我正在将这种做法更改为使用`b`for `beta`，这更相关。）

基本上，如果我有`version`（在`setup()`调用中）和构建标签（来自`setup.cfg`）的组合，它是 pypi 上已经存在的当前版本以外的任何内容，则`register`和`upload`命令都会失败：

```
ethan@walrus:~/source/python-mandrel$ python setup.py register
running register
running egg_info
writing requirements to mandrel.egg-info/requires.txt
writing mandrel.egg-info/PKG-INFO
writing top-level names to mandrel.egg-info/top_level.txt
writing dependency_links to mandrel.egg-info/dependency_links.txt
writing entry points to mandrel.egg-info/entry_points.txt
reading manifest file 'mandrel.egg-info/SOURCES.txt'
writing manifest file 'mandrel.egg-info/SOURCES.txt'
running check
Registering mandrel to http://pypi.python.org/pypi
Server response (500): There's been a problem with your request 
```

那是 . 的版本`0.0.3`和构建标签`b`。

但是如果我应用这个补丁：

```
--- a/setup.cfg
+++ b/setup.cfg
@@ -1,3 +1,3 @@
 [egg_info]
-tag_build = b
+tag_build = -1

diff --git a/setup.py b/setup.py
index 14761cf..beb8278 100644
--- a/setup.py
+++ b/setup.py
@@ -3,7 +3,7 @@ import os

 setup(
     name = "mandrel",
-    version = "0.0.3",
+    version = "0.0.2",
     author = "Ethan Rowe",
     author_email = "ethan@the-rowes.com",
     description = ("Provides bootstrapping for sane configuration management"), 
```

然后`register`调用（可能是`upload`）将成功：

```
ethan@walrus:~/source/python-mandrel$ python setup.py register
running register
...
running check
Registering mandrel to http://pypi.python.org/pypi
Server response (200): OK 
```

如果我将构建标签更改为`-2`，比如说，`register`调用将再次失败。这表明失败与 pypi 尚不知道的任何总版本字符串有关。

不幸的是，当服务器以 500 代码响应`--show-response`时，使用时的选项是无用的；'命令仅报告服务器遇到错误的事实，没有任何有用的信息可继续。`upload``distutils``upload`

关于我可以做些什么来解决问题的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T23:59:03.943

我也有 500 错误，他们的诊断问题在这里：[https](https://sourceforge.net/tracker/index.php?func=detail&aid=3573564&group_id=66150&atid=513503) ://sourceforge.net/tracker/index.php?func=detail&aid=3573564&group_id=66150&atid=513503 。

我使用 pdb 对其进行了调试。显然，show-response 选项并没有真正以有用的方式实现。`distutils/command/register.py`我在我的 Python dist 中的第 291 行放置了一个“import pdb；pdb.set_trace()”，在我的版本中，它位于方法内部`post_to_server()`。我在那里执行“打印 req.data”，然后通过它“下一步”，以查看安装在异常捕获中的响应。

# c++ - 如何通过 IO 时序测量找到 L1 缓存线大小的大小？

> ID：12675092
> 
> 赞同：38
> 
> 时间：2012-10-01T14:19:09.187
> 
> 标签：c++, c, performance, caching, cpu-architecture

作为一项学校作业，我需要找到一种方法来获取 L1 数据缓存行大小，而无需读取配置文件或使用 api 调用。应该使用内存访问读/写时序来分析和获取此信息。那么我该怎么做呢？

在对分配的另一部分进行的不完整尝试中，为了找到缓存的级别和大小，我有：

```
for (i = 0; i < steps; i++) {
    arr[(i * 4) & lengthMod]++;
} 
```

我在想也许我只需要改变第 2 行，`(i * 4)`部分？所以一旦我超过缓存行大小，我可能需要更换它，这需要一些时间？但就这么简单吗？所需的块可能已经在内存中的某个地方？或者，我仍然可以指望这样一个事实，即如果我有足够大的`steps`，它仍然会非常准确地工作？

**更新**

**[继承人在 GitHub 上的尝试](https://github.com/jiewmeng/cs3210-assign1/blob/master/cache-l1-line.cpp)** ......下面的主要部分

```
// repeatedly access/modify data, varying the STRIDE
for (int s = 4; s <= MAX_STRIDE/sizeof(int); s*=2) {
    start = wall_clock_time();
    for (unsigned int k = 0; k < REPS; k++) {
        data[(k * s) & lengthMod]++;
    }
    end = wall_clock_time();
    timeTaken = ((float)(end - start))/1000000000;
    printf("%d, %1.2f \n", s * sizeof(int), timeTaken);
} 
```

问题是时间之间似乎没有太大差异。供参考。因为它用于 L1 缓存。我有 SIZE = 32 K（数组大小）

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-01T14:54:11.937

分配一个 BIG`char`数组（确保它太大而无法放入 L1*或*L2 缓存）。用随机数据填充它。

`n`开始以字节为单位遍历数组。对检索到的字节做一些事情，比如对它们求和。

基准测试并计算您可以使用不同的值处理多少字节/秒`n`，从 1 开始计数到 ​​1000 左右。确保您的基准测试打印出计算的总和，因此编译器不可能优化基准测试代码。

当`n`== 您的缓存行大小时，*每次访问*都需要将新行读入 L1 缓存。因此，基准测试结果在这一点上应该会变得非常缓慢。

如果数组足够大，当你到达末尾时，数组开头的数据已经再次超出缓存，这就是你想要的。因此，在您增加`n`并重新开始之后，结果不会受到缓存中已经存在所需数据的影响。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-11T20:00:58.663

看看[Calibrator](http://homepages.cwi.nl/~manegold/Calibrator/)，所有作品都受版权保护，但[源代码](http://homepages.cwi.nl/~manegold/Calibrator/src/calibrator.c)是免费提供的。从它的[文档](http://homepages.cwi.nl/~manegold/Calibrator/doc/calibrator.pdf)想法来计算缓存行大小听起来比这里已经说过的更有教育意义。

> > 我们的校准工具背后的想法是有一个微基准，其性能仅取决于发生的缓存未命中的频率。我们的校准器是一个简单的 C 程序，主要是一个执行一百万次内存读取的小循环。通过改变步幅（即两个后续内存访问之间的偏移量）和内存区域的大小，我们强制改变缓存未命中率。
> > 
> > 原则上，缓存未命中的发生由数组大小决定。一旦数据加载到缓存中，适合 L1 缓存的数组大小不会产生任何缓存未命中。类似地，超过 L1 缓存大小但仍适合 L2 的数组将导致 L1 未命中但不会导致 L2 未命中。最后，大于 L2 的数组会导致 L1 和 L2 未命中。
> > 
> > 缓存未命中的频率取决于访问步幅和缓存行大小。步长等于或大于缓存行大小时，每次迭代都会发生缓存未命中。步幅小于缓存行大小时，缓存未命中仅每 n 次迭代（平均）发生一次，其中 n 是缓存行大小/步幅的比率。
> > 
> > 因此，我们可以通过比较没有未命中的执行时间与每次迭代恰好有一个未命中的执行时间来计算缓存未命中的延迟。**这种方法只有在内存访问是纯顺序执行的情况下才有效，也就是说，我们必须确保两个或更多的加载指令和内存访问和纯 CPU 工作都不能重叠。我们使用一个简单的指针追踪机制来实现这一点：我们访问的内存区域被初始化，这样每次加载都返回下一次迭代中后续加载的地址。因此，超标量 CPU 无法从其通过推测执行隐藏内存访问延迟的能力中受益。**
> > 
> > 为了测量缓存特性，我们多次运行实验，改变步幅和数组大小。我们确保步幅至少在 4 字节和最大预期缓存行大小的两倍之间变化，并且数组大小从最小预期缓存大小的一半变化到至少最大预期缓存大小的十倍。

我必须注释掉`#include "math.h"`它才能编译它，之后它正确地找到了我的笔记本电脑的缓存值。我也无法查看生成的 postscript 文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-11T11:40:10.293

您可以`CPUID`在汇编程序中使用该功能，虽然不可移植，但它会给您想要的。

> 对于 Intel 微处理器，可以通过调用 cpuid 函数 0x1 后将 bh 乘以 8 来计算高速缓存行大小。
> 
> 对于 AMD 微处理器，调用 cpuid 函数 0x80000005 后，数据缓存线大小在 cl 中，指令缓存线大小在 dl 中。

我从这里的[这篇文章中](http://softpixel.com/%7Ecwright/programming/simd/cpuid.php)得到了这个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-07T17:30:31.007

我认为您应该编写程序，它将以随机顺序而不是直接遍历数组，因为现代进程执行硬件预取。例如，制作 int 数组，其中值将是下一个单元格的编号。1 年前我做过类似的程序[http://pastebin.com/9mFScs9Z](http://pastebin.com/9mFScs9Z) 对不起我的英语，我不是母语人士。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-01T15:04:22.943

看看 memtest86 是如何实现的。他们以某种方式测量和分析数据传输率。速率变化点对应于 L1、L2 的大小和可能的 L3 缓存大小。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-02T09:32:55.303

如果你被困在泥泞中无法脱身，请看[这里](http://www.agner.org/optimize/)。

有手册和代码解释了如何做你所要求的。代码质量也很高。查看“子程序库”。

代码和手册基于 X86 处理器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-01T14:25:58.633

我认为对使用一些内存的操作进行计时应该足够了。然后逐步增加操作使用的内存（例如操作数）。当操作性能严重下降时，您已经找到了极限。

我会只读取一堆字节而不打印它们（打印会影响性能，以至于会成为瓶颈）。读取时，时间应该与读取的字节量成正比，直到数据不再适合 L1，然后您将获得性能打击。

您还应该在程序开始时和开始计算时间之前分配一次内存。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-05-12T14:27:24.563

只是一个注释。

缓存行大小在少数 ARM Cortex 系列上是可变的，并且可以在执行期间更改，而无需通知当前程序。

# .net - ID 比较与参考比较

> ID：12675096
> 
> 赞同：1
> 
> 时间：2012-10-01T14:19:40.480
> 
> 标签：.net, performance, reference, comparison

我有一些实体框架对象，它们也由它们自己的 ID 标识。

我更喜欢使用可能更可靠的参考比较，尤其是对于尚未在数据库中的对象。

*Int32 ID 比较*和*ByRef 对象比较*在性能方面有哪些差距？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:22:06.083

比较参考和比较的性能`int`大致相同。比较`ID`需要对堆栈进行额外的属性访问调用。但是，两者之间的性能差异可以忽略不计。

但是，这不应该是您如何确定平等的决定因素。平等应根据对象所代表的内容来确定。如果对象是由它的`ID`属性定义的，那么`ID`应该使用该属性来确定相等性。如果对象是由其值的组合定义的，那么您应该通过比较它的每个组件值来确定相等性。

为了更好地理解我在说什么，以下面的类为例：

```
 public class Lady { 
      public Lady(int id, string name, bool isMarried){
          this.ID = id;
          this.Name = name;
      }
      public int ID { get; private set; }
      public string Name { get; set; }

      public override int Equals(object other){  /* What goes here? */ }
      public override int GetHashCode(){  /* What goes here? */ }
 } 
```

想象一下，您的应用程序使用如下`Lady`类：

```
 void Main(){
      var JaneSmith = new Lady(id:12,name:"Jane Smith");
      var JaneSmithJones = new Lady(id:12,name:"Jane Smith-Jones");
 } 
```

在这种情况下，这两个对象实际上可能指的是同一个人。也许`JaneSmith`是在简结婚并改名之前创建和缓存的。但是，现在她的名字已经改变了，现在值和引用比较都将失败。但是，如果我们使用 ID 相等，那么这没关系，因为我们会知道它们应该指的是同一个人（和同一数据源）。`Lady`然后，我们可以通过放弃两个实例并从数据库重新加载来确定哪个实例当前是`Lady`正确`ID == 12`的。相比之下，如果我们使用引用相等或值相等，我们最终会保存两个对象，可能会覆盖错误的数据。此外，即使两个实例中的数据相同，并且我们只有两个实例，因为我们不小心加载了`JaneSmith`从数据库中两次，引用相等性检查将返回 false。这似乎不太正确，`new Lady(12,"Jane").Equals(new Lady(12,"Jane"))`应该返回 false。它还使缓存几乎不可能，因为*您永远无法确定记录是否已被缓存*。

一般来说，使用引用相等来比较持久对象是一个坏主意。然而，`ID`平等也不总是合适的。价值平等也不是。两种情况都有，你必须决定什么最能代表你正在处理的数据。有关这方面的更多信息，[本文](http://www.codecovered.net/2011/04/entities-vs-value-objects.html)提供了“实体”和“值对象”之间差异的一个非常基本的概念（来自领域驱动设计方法的概念）。

# jquery - ASP.Net 4.5 Twitter 引导和客户端验证

> ID：12675097
> 
> 赞同：5
> 
> 时间：2012-10-01T14:19:41.497
> 
> 标签：jquery, asp.net, twitter-bootstrap, client-side-validation

我在 Web 表单解决方案中使用新的 ASP.Net 4.5 进行了相当简单的设置。我已经使用 Twitter Bootstrap 将近一年了，真的很享受它为我节省的时间和它带来的一致性。他们的一些 javascript 方法也非常有用。但是，我在合并一些似乎需要在 4.5 中完成的“新方式”时遇到问题。这是我的母版页：

```
<body>
    <form id="frmMain" runat="server">
        <asp:ScriptManager ID="smManager" runat="server">
            <Scripts>
                <asp:ScriptReference Name="jquery" />
                <asp:ScriptReference Name="bootstrap" />
            </Scripts>
        </asp:ScriptManager>
... 
```

这是一个测试页面的内容：

```
<asp:Content ID="Content2" ContentPlaceHolderID="cphMain" runat="server">
    <asp:TextBox ID="txtTest" runat="server"></asp:TextBox>
    <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ErrorMessage="Problem" ControlToValidate="txtTest" CssClass="error" SetFocusOnError="True" ToolTip="Problem">*</asp:RequiredFieldValidator>
    <asp:Button ID="btnTest" runat="server" Text="Check" CausesValidation="true" OnClick="btnTest_Click" /><br />
    <asp:TextBox ID="txtAnother" runat="server"></asp:TextBox>
    <asp:Button ID="btnOk" runat="server" CausesValidation="false" Text="No Check" />
</asp:Content> 
```

这是我的 Global.asax.cs 文件，用于显示上面提到的 ScriptReferences：

```
protected void Application_Start(object sender, EventArgs e) {
    GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings.ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore;

    ScriptManager.ScriptResourceMapping.AddDefinition(
        "jquery",
        new ScriptResourceDefinition {
            Path = "~/Scripts/jquery-1.8.2.min.js",
            DebugPath = "~/Scripts/jquery-1.8.2.js",
            CdnPath = "http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.2.min.js",
            CdnDebugPath = "http://ajax.microsoft.com/ajax/jQuery/jquery-1.8.2.js",
            LoadSuccessExpression = "window.jQuery"
        }
    ); // Load jQuery

    ValidationSettings.UnobtrusiveValidationMode = UnobtrusiveValidationMode.WebForms;

    ScriptManager.ScriptResourceMapping.AddDefinition(
        "bootstrap",
        new ScriptResourceDefinition {
            Path = "~/Scripts/bootstrap.min.js",
            DebugPath = "~/Scripts/bootstrap.js"
        }
    ); // Load Bootstrap 
```

客户端检查第一个文本框没有触发。如果我单击“检查”按钮，它会进行往返，并且代码隐藏的 Page.IsValid == false。这很好，但我不想在页面无效时发回。

我创建了另一个测试页，它没有使用我的母版页，但其中包含相同的代码，如下所示：

```
<form id="form1" runat="server">
    <div>
        <asp:TextBox ID="txtTest" runat="server"></asp:TextBox>
        <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ErrorMessage="Problem" ControlToValidate="txtTest" CssClass="error" SetFocusOnError="True" ToolTip="Problem">*</asp:RequiredFieldValidator>
        <asp:Button ID="btnTest" runat="server" Text="Check" OnClick="btnTest_Click" /><br />
        <asp:TextBox ID="txtAnother" runat="server"></asp:TextBox>
        <asp:Button ID="btnOk" runat="server" CausesValidation="false" OnClick="btnOk_Click" Text="No Check" />
    </div>
</form> 
```

此页面会抛出客户端，因此会按我的意愿停止发帖。

在我看来，bootstrap.js 可能正在拖拽或中断标准的 js 验证。有什么建议我仍然可以使用引导程序吗？我需要 bootstrap.js 文件，因为它处理下拉菜单。我至少可以将 jQuery 的 UI 用于模态框，但这对下拉菜单没有帮助。

我想使用新技术，但我们总是有这些学习曲线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T13:27:37.463

您可以在这里选择您真正需要的插件：http: [//twitter.github.com/bootstrap/customize.html#plugins](http://twitter.github.com/bootstrap/customize.html#plugins) 我认为 bootstrap.js 包含多合一的组合解决方案。所以你可以尝试只使用你需要的东西，看看它是否有帮助

# android - 从 Android 共享到 Google+

> ID：12675105
> 
> 赞同：1
> 
> 时间：2012-10-01T14:20:03.863
> 
> 标签：android, google-plus

Google+ 是否支持从 Android 应用共享？我想知道，因为我已经在我的应用程序上为 twitter 和 facebook 实现了这个，并且想为 Google+ 做同样的事情。我确实读到他们现在有一个 API，但它仅用于开发和测试，并且无法发布应用程序。它是否正确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T14:46:04.667

*   Google+ Android API 可以在这里找到：[https ://developers.google.com/+/mobile/android/](https://developers.google.com/+/mobile/android/)

*   在 Google+ 上分享的代码片段在该页面下方[https://developers.google.com/+/mobile/android/#share_on_google](https://developers.google.com/+/mobile/android/#share_on_google)：

例如，在您的 XML 中：

```
<Button
  android:id="@+id/share_button"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:text="Share on Google+" /> 
```

在您的活动中：

```
Button shareButton = (Button) findViewById(R.id.share_button);
shareButton.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
      // Launch the Google+ share dialog with attribution to your app.
      Intent shareIntent = ShareCompat.IntentBuilder.from(ExampleActivity.this)
          .setType("text/plain")
          .setText("Welcome to the Google+ platform. https://developers.google.com/+")
          .getIntent()
          .setPackage("com.google.android.apps.plus");

      startActivity(shareIntent);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:43:18.343

看看[Julia Ferraiol](https://plus.google.com/u/0/+JuliaFerraioli) [i](http://PrettyAndSmart.wow?WhatACatch)在[Google Plus 开发者博客](http://googleplusplatform.blogspot.com/)上的这篇文章：

[将丰富的内容从您的 Android 应用程序共享到 Google+ 等](http://googleplusplatform.blogspot.com/2012/05/sharing-rich-content-from-your-android.html)

# css - CSS 正确显示菜单

> ID：12675107
> 
> 赞同：1
> 
> 时间：2012-10-01T14:20:14.523
> 
> 标签：css

我有一个类别表，它维护无限级别的子类别。它看起来像下面[快照](https://i.stack.imgur.com/StrRf.png)中显示的那样。

![在此处输入图像描述](../Images/e6116e5badb19d120fb4e52f66afb896.png)

在上表中，第三列显示父名称。当鼠标按钮悬停在父名称上时，会显示一个菜单，以不同颜色显示类别的树结构。

当菜单弹出时，它被它下面的父名称重叠（我无法用语言正确表达，请看上图）。应该使用什么 CSS 或其他东西才能正确显示菜单？

父名显示`<ul><li></li></ul>`如下

```
<ul>
    <li>
        <div style='width:53px;cursor:hand;text-align:left; background-color:white; border:none; color:black; font-size:small;'>

         <?php echo htmlspecialchars($name, ENT_QUOTES, 'UTF-8');?>

        </div>                            
   </li>
</ul> 
```

* * *

如果需要显示整个菜单的 CSS，如下所示。

```
.jqueryslidemenu{font:bold 9px Tahoma, Verdana, sans-serif;color:#fff;width: 100%;text-align:left;z-index:99999}
.jqueryslidemenu ul{margin: 0;padding: 0px;list-style-type: none;z-index:99999}
.jqueryslidemenu ul li{position: relative;display: inline;float: left;z-index:99999}
.jqueryslidemenu ul li a{font:bold 12px Tahoma, Verdana, sans-serif;display: block;background:#000;color: #fff;padding: 3px 3px;text-decoration: none;z-index:99999}
* html .jqueryslidemenu ul li a{display: inline-block;z-index:99999}
.jqueryslidemenu ul li a:link, .jqueryslidemenu ul li a:visited{color: #fff;text-decoration: none;z-index:99999}

.jqueryslidemenu ul li a:hover{background:#000;text-decoration:none;color: #03C;z-index:99999}
.jqueryslidemenu ul li ul{position: absolute;left: 0;display: block;visibility: hidden;z-index:99999}
.jqueryslidemenu ul li ul li{display: list-item;float: none;z-index:99999}
.jqueryslidemenu ul li ul li ul{top:0;z-index:99999}
.jqueryslidemenu ul li ul li a{font:bold 9px Tahoma, Verdana, Geneva, sans-serif;width: 140px;margin: 0;padding: 6px;border-top-width: 0;border-bottom: 1px solid gray;z-index:99999}
.jqueryslidemenuz ul li ul li a:hover{color:#fff; background:#000;z-index:99999}
.downarrowclass{position: absolute;top: 8px;right: 7px;display:none;z-index:99999}
.rightarrowclass{position: absolute;top: 6px;right: 5px;z-index:99999} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:27:34.243

看起来像一个 z-index 问题。

可能是因为你的css中的这一行：

```
.jqueryslidemenu ul li a 
```

是否有一个 99999 的 z-index 使父链接文本显示在级联弹出菜单上方？将它的 z-index 降低到 1，看看是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:28:39.360

看起来 z-index 设置为 99999，这意味着它强制该项目位于最顶部。为该特定元素 (ul li) 赋予 auto 或 1 的 z-index。为此，为该列赋予一个特定的类，如下所示。

html:

```
<li class="behind"></li> 
```

CSS：

```
li.behind{
    z-index: auto;
} 
```

# iphone - 调用 subtreebordercolor 时对象的潜在泄漏

> ID：12675112
> 
> 赞同：-1
> 
> 时间：2012-10-01T14:20:22.917
> 
> 标签：iphone, objective-c

我收到这两种方法的内存泄漏警告。第二个调用第一个，显然它的内存泄漏。有任何想法吗？

```
static UIColor *subtreeBorderColor(void) 
{
    return [UIColor colorWithRed:0.0f green:0.5f blue:0.0f alpha:1.0f];
}

- (void) updateSubtreeBorder 
{
    CALayer *layer = [self layer];
    if (layer) {

        // If the enclosing TreeGraph has its "showsSubtreeFrames" debug feature enabled, 
        // configure the backing layer to draw its border programmatically.  This is much more efficient
        // than allocating a backing store for each SubtreeView's backing layer, only to stroke a simple
        // rectangle into that backing store.

        PSBaseTreeGraphView *treeGraph = [self enclosingTreeGraph];
        if ([treeGraph showsSubtreeFrames]) {
            [layer setBorderWidth:subtreeBorderWidth()];
            [layer setBorderColor:[subtreeBorderColor() CGColor]];

        } else {
            [layer setBorderWidth:0.0];
        }

    }
}

//3: Potential leak of an object
//6: Calling 'subtreeBorderColor'
//1: Entered call from 'updateSubtreeBorder'
//13: Method returns an Objective-C object with a +0 retain count
//12: Reference count incremented. The object now has a +1 retain count
//6: Returning from 'subtreeBorderColor'
//13: Object leaked: allocated object is not referenced later in this execution path and has a retain count of +1 
```

**更新 2：我刚刚完全更改了代码并删除了临时文件并清理了解决方案，这就是我所看到的 - 它正在寻找甚至没有代码的错误**

![在此处输入图像描述](../Images/76a180c12572e8865dc9d342caeaa584.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:24:10.030

简单的。您不需要`- retain`在函数中调用 to。这**正是**自动释放模式的发明目的。由于您没有使用 alloc-init 创建 UIColor 对象，因此您不拥有它。无需进一步使内存管理过于复杂。:)

编辑：（以防止未来的反对票）既然您编辑了您的问题和代码，使其不再错误地返回一个保留的对象，之前的语句不再有效。是的，Xcode 在“甚至没有代码”的地方显示了关于内存泄漏的通知，这很奇怪。是的，也许是编译器错误。尽管如此，一个临时的（在我看来，完全有效的）解决方法是简单地使用定义而不是函数。如果你写这个，让我们看看 Xcode 会说什么：

```
#define SUBTREE_BORDER_COLOR [UIColor colorWithRed:0.0f green:0.5f blue:0.0f alpha:1.0f] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:23:59.757

如果您想按原样使用“保留”，您还需要“释放”`UIColor`您从“ `subtreeBorderColor`”方法返回的“”对象。

如果这是我的代码，我不会`retain`在一开始就对那个自动释放的对象执行“”。或者比这更好，只需在启用 ARC 的情况下执行我的代码。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-01T14:30:07.017

以前的两个答案都是正确的

但是，如果出于任何原因您需要保留方法返回的对象，请遵循规则并以“new”（或 alloc、retain 或 copy）开头重命名您的方法，这样每个人（以及您）都会知道返回的对象被保留，因此调用代码知道它有责任稍后在需要时释放它......

# vim - 打开时 VIM 和 taglist 坚持文件

> ID：12675119
> 
> 赞同：0
> 
> 时间：2012-10-01T14:21:02.493
> 
> 标签：vim, taglist

我已经`taglist`工作得很好。当我按下绑定时，`toggle`它会集中在主文件中。但是如何在打开时强制将焦点保留在文件中？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:39:23.607

根据插件的文档 ( `:help taglist-using`)，此行为由配置变量确定：

```
:let g:Tlist_GainFocus_On_ToggleOpen = 1 
```

# android - android：媒体记录器：启动失败：-38

> ID：12675120
> 
> 赞同：4
> 
> 时间：2012-10-01T14:21:06.563
> 
> 标签：android, state, voice, recorder

简介：如何检查语音录制是否已经在其他应用程序的后台运行。

详细信息：如果录音已经在本机应用程序的后台运行：录音机。现在，我已将语音录制作为我的应用程序中的一项功能。

问题：当我尝试同时在我的应用程序中录制时，它给出了错误：

```
 : E/MediaRecorder: start failed: -38
  : E/MyApp: [1162][com.sec.MyApp.multimedia.RecordMyVoice]java.lang.IllegalStateException
  : E/MyApp:    at android.media.MediaRecorder.start(Native Method)
  : E/MyApp:    at com.sec.MyApp.multimedia.RecordMyVoice.doInBackground(RecordMyVoice.java:100) 
```

RecordMyVoice.java 中第 100 行的代码：

```
 mRecorder = new MediaRecorder();
    mRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    mRecorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
    mRecorder.setOutputFile(mFileName);
    mRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
    mRecorder.prepare();
    mRecorder.start(); //code at 100th line 
```

但问题是因为录音已经在后台运行。因此，如果它在其他应用程序中运行，有什么方法可以停止录音。

任何输入都会有很大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-01T11:04:50.613

我有同样的错误-38，我发现有另一个后台服务通过（AudioRecord）使用麦克风，当禁用后台服务时，它起作用了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-20T02:28:06.160

检查您的文件路径，该目录必须存在。

# sql-server - 在 SSRS 报告中获取 YTD 数据，并按年/月过滤列组

> ID：12675124
> 
> 赞同：1
> 
> 时间：2012-10-01T14:21:18.860
> 
> 标签：sql-server, reporting-services

我有一个 Reporting Services 报告，其中显示了一堆 KPI 分数。每个 KPI 在报告中都有自己的行，对于每一行，我们显示过去 3 年的 SUM 或 AVG（取决于 KPI 类型）得分，然后是当年每月的 SUM、AVG 或（理想情况下）总 YTD 数字：

```
KPI                     2009 2010 2011  Jan Feb Mar Apr May etc.
Bagels Eaten (Total)    100   90    70  10  20  9   13  14
Sandwiches (Cumm. YTD)  90    75    86  13  23  46  65  76 
```

我看到的问题是*RunningValue*函数似乎跨行工作，而不是在过滤的列组和构成 Jan、Feb、Mar 列的当前行内（每月数据，按年和月分组，过滤今年）。所以输出与上面不同，而是基于行中所有值的相当随机的数字（我确信它不是随机的，它看起来就是这样）。

列组称为“MonthNum”，单元格值的表达式根据源数据中的“AggregationType”值决定应用哪个聚合：

```
=Switch(Fields!AggregationType.Value="SUM", Sum(Fields!ScoreValue.Value), 
       Fields!AggregationType.Value="AVG", Avg(Fields!ScoreValue.Value), 
       Fields!AggregationType.Value="YTD", 
       RunningValue(Fields!ScoreValue.Value,Sum,"MonthNum")) 
```

非常感谢任何帮助

**更新：** 这是正在使用的数据集的几行示例（每月得分，每 kpi）（格式有点棘手！）。聚合类型为“YTD”的项目将应用累积 YTD 表达式，其他所有内容均为当月的 SUM：

```
KpiID   Title   KPIOwner    ScoreValue  YearNum MonthNum    ReportingGroupTitle ScoreType   DisplayOrder    DisplayPrecision    UnitOfMeasure   AggregationType
5   Donuts Served   Donut Manager   35  2007    1   Catering Services   Actual  10020   0   Number  YTD
5   Donuts Served   Donut Manager   42  2007    2   Catering Services   Actual  10020   0   Number  YTD
5   Donuts Served   Donut Manager   86  2007    3   Catering Services   Actual  10020   0   Number  YTD
5   Donuts Served   Donut Manager   14  2007    4   Catering Services   Actual  10020   0   Number  YTD
6   Donuts Cooked   Donut Manager   45  2007    1   Catering Services   Actual  10020   0   Number  SUM
6   Donuts Cooked   Donut Manager   48  2007    2   Catering Services   Actual  10020   0   Number  SUM
6   Donuts Cooked   Donut Manager   93  2007    3   Catering Services   Actual  10020   0   Number  SUM
6   Donuts Cooked   Donut Manager   32  2007    4   Catering Services   Actual  10020   0   Number  SUM
6   Donuts Cooked   Donut Manager   18  2007    5   Catering Services   Actual  10020   0   Number  SUM 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T17:49:15.183

根据我从您的问题中了解到的情况，我会这样做：

假设当聚合类型 YTD 返回累积总计时，直到（包括）MonthNum。

创建一个矩阵，其中包含两个在 KpiID 上的组和一个在 AggregationType 上的子组，以及两个列组（相邻），一个在年份上，一个在月份上（在年份组上，创建一个过滤器，以便您不包括当前年和月组排除年份不是当前年份的值）。

然后，您可以对年份和月份组使用以下表达式（最后一个将为您提供每年最后一个月的 YTD 值）

```
=Switch(Fields!AggregationType.Value="SUM", Sum(Fields!ScoreValue.Value), 
       Fields!AggregationType.Value="AVG", Avg(Fields!ScoreValue.Value), 
       Fields!AggregationType.Value="YTD", Last(Fields!ScoreValue.Value)) 
```

# css - CSS渐变和渐变上方的背景图像

> ID：12675125
> 
> 赞同：1
> 
> 时间：2012-10-01T14:21:23.970
> 
> 标签：css, background-image, gradient

我的问题是：如何让我的 2 个背景图像出现在 CSS 渐变上方的左右两侧。我正在使用 JA Elastica 模板（修改默认 CSS）在 Joomla 网站上工作。

在我当前的CSS中，如果我将“背景：url（'images'）”放在渐变上方，那么它会显示图像而不是渐变，如果我将它放在渐变下方，它会显示渐变而不是图像。

我目前使用的代码是这样的：

```
body#bd {
background-image: linear-gradient(bottom, rgb(142,210,46) 2%, rgb(171,252,74) 51%, rgb(206,255,104) 76%);
background-image: -o-linear-gradient(bottom, rgb(142,210,46) 2%, rgb(171,252,74) 51%, rgb(206,255,104) 76%);
background-image: -moz-linear-gradient(bottom, rgb(142,210,46) 2%, rgb(171,252,74) 51%, rgb(206,255,104) 76%);
background-image: -webkit-linear-gradient(bottom, rgb(142,210,46) 2%, rgb(171,252,74) 51%, rgb(206,255,104) 76%);
background-image: -ms-linear-gradient(bottom, rgb(142,210,46) 2%, rgb(171,252,74) 51%, rgb(206,255,104) 76%);
background-image: -webkit-gradient(
linear,
left bottom,
left top,
color-stop(0.02, rgb(142,210,46)),
color-stop(0.51, rgb(171,252,74)),
color-stop(0.76, rgb(206,255,104)));
background:
url('https://dl.dropbox.com/u/6512758/onebeat.ro/right.png') no-repeat top right,
url('https://dl.dropbox.com/u/6512758/onebeat.ro/left.png') no-repeat top left;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:42:35.107

一切都需要在同一个背景图像属性上，否则前一个背景语句将被下一个替换。例如：

```
background-image: url('https://dl.dropbox.com/u/6512758/onebeat.ro/right.png') no-repeat top right, linear-gradient(bottom, rgb(142,210,46) 2%, rgb(171,252,74) 51%, rgb(206,255,104) 76%); 
```

在这里查看更多示例： [如何在同一元素上组合背景图像和 CSS3 渐变？](https://stackoverflow.com/questions/2504071/is-it-possible-to-combine-a-background-image-and-css3-gradients)

# ruby-on-rails - 不使用块回滚事务

> ID：12675128
> 
> 赞同：4
> 
> 时间：2012-10-01T14:21:32.163
> 
> 标签：ruby-on-rails, activerecord

> **注意：**这是[*优化 Rspec 测试以避免重复复杂设置过程的后续问题*](https://stackoverflow.com/q/12646871/1157054)

出于此问题范围之外的原因（请参阅上面的注释），我希望能够启动 Rails 数据库事务，然后在不同范围内回滚该事务。例如：

```
def before_callback
  start_transaction # Start the transaction
  # Create/Update some records
end

def after_callback
  rollback_transaction # Rollback changes from before_callback and do_stuff
end

def do_stuff
  before_callback
  # Do some stuff
  after_callback
end

do_stuff 
```

我意识到这是一个人为的示例，可以通过`transaction do .. end`一些重构轻松解决，但在上下文中，请记住`do_stuff`我真的不想弄乱的外部插件的一部分。有没有办法做类似于我刚刚在 Rails 中描述的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T20:43:09.737

对于粗略的快速和肮脏的解决方案，您可以直接在数据库连接上执行所需的 SQL 命令：

```
def start_transaction
  ActiveRecord::Base.connection.execute("BEGIN")
end

def rollback_transaction
  ActiveRecord::Base.connection.execute("ROLLBACK")
end 
```

此外，查看`transaction`方法的来源可能会给您一些关于如何以更精致的方式处理此问题的想法。

（您可以在`ActiveRecord::ConnectionAdapters::DatabaseStatements`中找到它`lib/active_record/connection_adapters/abstract/database_statements.rb`）

# symfony - 实体字段出错 - Symfony2

> ID：12675130
> 
> 赞同：0
> 
> 时间：2012-10-01T14:21:45.223
> 
> 标签：symfony

这是我的文件：

```
<?php

namespace EM\ExpensesBundle\Entity;

use Symfony\Component\Form\FormBuilder;
use Symfony\Component\Form\AbstractType;

class ChooseCatType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder->add('name', 'entity', array(
            'class' => 'EMMyFriendsBundle:Category',
            'property' => 'name',
            'empty_value' => 'All items',
            'required' => false,
            'query_builder' => function ($repository)
                { return $repository->createQueryBuilder('cat')
                                    ->select('cat')
                                    ->orderBy('cat.name', 'ASC');
                }, ));
    }

    public function getName()
    {
        return 'choose_category';
    }
} 
```

在这里，我创建了表单：

```
namespace EM\ExpensesBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use EM\ExpensesBundle\Entity\Category;
use EM\ExpensesBundle\Entity\ChooseCatType;

class HomeController extends Controller
{
    public function indexAction()
    {
        //Categories
        $cat = new Category();
        $dd_form = $this->createForm(new ChooseCatType(), $cat);
        return $this->render('EMExpensesBundle:Home:index.html.twig', array(
            'dd_form' => $dd_form->createView()));
    }
} 
```

和模板：

```
{% extends "::base.html.twig" %}

{% block title %}
    Expenses
{% endblock %}

{% block body %}

    <div class="content">

<p> Choose category: </p>

            <form class="cat" action="" method="post" {{ form_enctype(dd_form) }}> 
                {{ form_widget(dd_form.name) }}
                {{ form_rest(dd_form) }}
                <input type="submit" value="Show items" />
            </form>

            <a href=""> Manage Categories </a>

        </div>

{% endblock %} 
```

但我收到一个错误：

```
Fatal error: Declaration of EM\ExpensesBundle\Entity\ChooseCatType::buildForm() 
must be compatible with that 
of Symfony\Component\Form\FormTypeInterface::buildForm()     
in C:\xampp\htdocs\Expenses\src\EM\ExpensesBundle\Entity\ChooseCatType.php 
on line 9 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:25:08.987

`FormBuilderInterface`在您的方法签名中使用：

```
public function buildForm(FormBuilderInterface $builder, array $options) 
```

# facebook - 缺少从 xd_arbiter.php 到 all.js 的 XDM 调用会导致在 Firefox 中登录失败

> ID：12675131
> 
> 赞同：2
> 
> 时间：2012-10-01T14:21:46.100
> 
> 标签：facebook, firefox, facebook-javascript-sdk, facebook-login

我正在开发一个基于 drupal 的网站，用户可以使用 Facebook 登录我的网站。

登录在 IE8、IE9 和最新的 Chrome 和 Safari 中可以正常工作，但在最新的 Firefox 中却不行。

FB.Init() 被配置为使用cookies，并且当在chrome 中登录Facebook 时，一个名为：fbsr_ 的cookie 被正确设置并且一切都按预期工作。它由 Facebook SDK (all.js) 设置，当用户登录时，它反过来在 postMessage 事件中接收数据。

我已经对 all.js 进行了 de-minified 来调试它。在 chrome 和 IE9 中引发了三个 postMessage 事件。在 Firefox 中，不会引发任何 XDM postMessage 事件。

我尝试了不同的 Facebook 帐户、不同的计算机，但由于无法准确确定 postMessage 事件是/应该从哪里引发，所以我一直在调试。

我还注意到 xd_arbiter.php 根本没有在 Firefox 中加载（使用 firebug 的“net”选项卡），而它在 Chrome 中加载了两次。但是，Fb js api 的初始化似乎正确地将 xd_arbiter.php 作为 src 的 iframe 注入到 DOM 中。

firebug 控制台中没有 js 错误。

有什么建议么？

# symfony - 如何使用 Twig 遍历自引用的对象列表并输出嵌套列表

> ID：12675141
> 
> 赞同：1
> 
> 时间：2012-10-01T14:22:24.927
> 
> 标签：symfony, doctrine-orm, twig

> **可能重复：**
> [Symfony2 Twig 无限子深度](https://stackoverflow.com/questions/12583177/symfony2-twig-unlimited-child-depth)

我想遍历 Twig 中的对象列表。该列表具有某种自引用的多对一关系，如下所示：

*   项目 1
*   第 2 项
    *   项目 2 1
    *   项目 2 2
        *   项目 2 2 1
*   第 3 项
    *   项目 3 1
*   第 4 项

因此实体内的定义如下所示：

```
/**
 * @ORM\OneToMany(targetEntity="Item", mappedBy="parent")
 */
private $children;

/**
 * @ORM\ManyToOne(targetEntity="Item", inversedBy="children")
 * @ORM\JoinColumn(name="parent_id", referencedColumnName="id")
 */
private $parent; 
```

我知道想从树枝中创建一个列表，例如：

```
<ul>
    <li>Item 1</li>
    <li>
        Item 2
        <ul>
            <li>Item 2 1</li>
            <li>
                Item 2 2
                <ul>
                    <li>Item 2 2 1</li>
                </ul>
            </li>
        </ul>
    </li>
    <li>
        Item 3
        <ul>
            <li>Item 3 1</li>
        </ul>
    </li>
    <li>Item 4</li>
</ul> 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:22:24.927

在 Twig 中有几种方法可以做到这一点。一个非常简单的方法是使用递归调用的宏。这个宏可以放在与实际输出相同的文件中，并通过以下方式引用：`{{ _self.macroname(parameters) }}`

详细解释见评论：

```
<!-- send two variables to the macro: the list of objects and the current level (default/root is null) -->
{% macro recursiveList(objects, parent) %}

    <!-- store, whether there's an element located within the current level -->
    {% set _hit = false %}

    <!-- loop through the items -->
    {% for _item in objects %}

        <!-- get the current parent id if applicable -->
        {% set _value = ( null != _item.parent and null != _item.parent.id ? _item.parent.id : null ) %}

        <!-- compare current level to current parent id -->
        {% if (parent == _value) %}

            <!-- if we have at least one element open the 'ul'-tag and store that we already had a hit -->
            {% if not _hit %}
                <ul class="tab">
                {% set _hit = true %}
            {% endif %}

            <!-- print out element -->
            <li>
                {{ _item.title }}

                <!-- call the macro with the new id as root/parent -->
                {{ _self.recursiveList(objects, _item.id) }}
            </li>
        {% endif %}

    {% endfor %}

    <!-- if there was at least one hit, close the 'ul'-tag properly -->
    {% if _hit %}
        </ul>
    {% endif %}

{% endmacro %} 
```

唯一要做的就是从模板中调用宏一次：

```
{{ _self.recursiveList(objects) }} 
```

希望，也有人觉得这很有用。

# ruby - 扫描(/\p{graph}+/) 和日期

> ID：12675146
> 
> 赞同：0
> 
> 时间：2012-10-01T14:22:45.190
> 
> 标签：ruby, regex

当我使用`scan(/\p{graph}+/)`它时：

```
"ich gehe nach Köln am 12.09.2012".scan(/\p{graph}+/)
=> ["ich", "gehe", "nach", "Köln", "am", "12.09.2012"] 
```

但是如果出现像“ `Köln.am`”这样的输入错误，那么输出是错误的：

```
"ich gehe nach Köln.am 12.09.2012".scan(/\p{graph}+/)
=> ["ich", "gehe", "nach", "Köln.am", "12.09.2012"] 
```

当我使用`scan(/\p{alnum}+/)`时，日期不正确：

```
"ich gehe nach Köln.am 12.09.2012".scan(/\p{alnum}+/)
=> ["ich", "gehe", "nach", "Köln", "am", "12", "09", "2012"] 
```

有谁知道另一种解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:45:59.800

对于这个简单的情况，您可以使用交替进行检查，并匹配一系列字母或一系列带点的数字。

```
"ich gehe nach Koeln.am 12.09.2012".scan(/\p{alpha}+|[\d+.]+/) 
```

输出：

```
["ich", "gehe", "nach", "Koeln", ".", "am", "12.09.2012"] 
```

或者，如果您不想匹配单点

```
"ich gehe nach Koeln.am 12.09.2012".scan(/\p{alpha}+|\d+(?:\.\d+)*/) 
```

输出：

```
["ich", "gehe", "nach", "Koeln", "am", "12.09.2012"] 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-01T14:28:02.030

我不确定你想要什么结果，所以我的回答可能不正确。

```
"ich gehe nach Köln am 12.09.2012".split /\s/
 => ["ich", "gehe", "nach", "Köln", "am", "12.09.2012"] 
```

编辑：

请注意，连续的几个空格会破坏结果。

```
"ich gehe nach Köln        am 12.09.2012".split /\s/
 => ["ich", "gehe", "nach", "Köln", "", "", "", "", "", "", "", "am", "12.09.2012"] 
```

# r - 我们如何制作 xkcd 风格的图表？

> ID：12675147
> 
> 赞同：734
> 
> 时间：2012-10-01T14:22:51.340
> 
> 标签：r, ggplot2, plot

显然，人们已经想出了如何[在 Mathematica](https://mathematica.stackexchange.com/questions/11350/xkcd-style-graphs)和[LaTeX中制作](https://tex.stackexchange.com/questions/74878/create-xkcd-style-diagram-in-tex)[xkcd](http://xkcd.com/)样式的图表。我们可以在 R 中做到这一点吗？ggplot2-ers？geom_xkcd 和/或 theme_xkcd？

我猜在基本图形中，par(xkcd=TRUE)？我该怎么做？

![xkcd#1064](../Images/ba79106feacb848434fd19cfa37acc38.png "仅供参考：在未来 30 年的某个时候，我将把一头狼释放到一个随机选择的前院。 现在你的恐惧是合理的，你不需要再感到尴尬了。 问题解决了！")

作为 ggplot2 中的第一个 stab（以及下面更优雅地显示），将 jitter 参数添加到线条中可以获得很棒的手绘外观。所以 -

```
ggplot(mapping=aes(x=seq(1,10,.1), y=seq(1,10,.1))) + 
  geom_line(position="jitter", color="red", size=2) + theme_bw() 
```

这是一个很好的例子——但轴和字体看起来更棘手。不过，字体似乎已解决（如下）。处理轴的唯一方法是将它们空白并手动绘制它们吗？有没有更优雅的解决方案？特别是在ggplot2中，新主题系统中的element_line是否可以修改为接受类似jitter的参数？

* * *

## 回答 #1

> 赞同：448
> 
> 时间：2013-05-16T20:49:51.410

您可能需要考虑以下软件包：

[包 xkcd](http://xkcd.r-forge.r-project.org/)：以 XKCD 样式绘制 ggplot2 图形。

```
library(xkcd)
vignette("xkcd-intro") 
```

一些示例（散点图、条形图）：

*   散点图：

![散点图](../Images/afc0e3d5cc1b8cf9c2854b5fa7cb8517.png)

*   条形图：

![条形图](../Images/17c17b32bb42717603117a9663c814b4.png)

* * *

## 回答 #2

> 赞同：227
> 
> 时间：2012-10-01T22:11:44.577

沿着与其他一些答案相同的思路思考，我已经“取消绘制”图表，并添加了 x 轴标签位置的灵活性（这在 xkcd 中似乎很常见）和任意标签上图表。

请注意，我在加载 Humor Sans 字体并将其手动下载到工作目录时遇到了一些问题。

![在此处输入图像描述](../Images/07ec4ec47c6df473c2106f3632bd5ade.png)

而且代码...

```
library(ggplot2)
library(extrafont)

### Already have read in fonts (see previous answer on how to do this)
loadfonts()

### Set up the trial dataset 
data <- NULL
data$x <- seq(1, 10, 0.1)
data$y1 <- sin(data$x)
data$y2 <- cos(data$x)
data$xaxis <- -1.5

data <- as.data.frame(data)

### XKCD theme
theme_xkcd <- theme(
    panel.background = element_rect(fill="white"), 
    axis.ticks = element_line(colour=NA),
    panel.grid = element_line(colour="white"),
    axis.text.y = element_text(colour=NA), 
    axis.text.x = element_text(colour="black"),
    text = element_text(size=16, family="Humor Sans")
    )

 ### Plot the chart
 p <- ggplot(data=data, aes(x=x, y=y1))+
      geom_line(aes(y=y2), position="jitter")+
      geom_line(colour="white", size=3, position="jitter")+
      geom_line(colour="red", size=1, position="jitter")+
      geom_text(family="Humor Sans", x=6, y=-1.2, label="A SIN AND COS CURVE")+
      geom_line(aes(y=xaxis), position = position_jitter(h = 0.005), colour="black")+
      scale_x_continuous(breaks=c(2, 5, 6, 9), 
      labels = c("YARD", "STEPS", "DOOR", "INSIDE"))+labs(x="", y="")+
      theme_xkcd

ggsave("xkcd_ggplot.jpg", plot=p, width=8, height=5) 
```

* * *

## 回答 #3

> 赞同：197
> 
> 时间：2012-10-01T20:47:50.497

基本画线功能：

```
xkcd_line <- function(x, y, color) {
  len <- length(x);
  rg <- par("usr");
  yjitter <- (rg[4] - rg[3]) / 1000;
  xjitter <- (rg[2] - rg[1]) / 1000;
  x_mod <- x + rnorm(len) * xjitter;
  y_mod <- y + rnorm(len) * yjitter;
  lines(x_mod, y_mod, col='white', lwd=10);
  lines(x_mod, y_mod, col=color, lwd=5);
} 
```

基本轴：

```
xkcd_axis <- function() {
  rg <- par("usr");
  yaxis <- 1:100 / 100 * (rg[4] - rg[3]) + rg[3];
  xaxis <- 1:100 / 100 * (rg[2] - rg[1]) + rg[1];
  xkcd_line(1:100 * 0 + rg[1] + (rg[2]-rg[1])/100, yaxis,'black')
  xkcd_line(xaxis, 1:100 * 0 + rg[3] + (rg[4]-rg[3])/100, 'black')
} 
```

和示例代码：

```
data <- data.frame(x=1:100)
data$one <- exp(-((data$x - 50)/10)^2)
data$two <- sin(data$x/10)
plot.new()
plot.window(
    c(min(data$x),max(data$x)),
    c(min(c(data$one,data$two)),max(c(data$one,data$two))))
xkcd_axis()
xkcd_line(data$x, data$one, 'red')
xkcd_line(data$x, data$two, 'blue') 
```

产生：

![示例图表](../Images/10276e7a691a084d0afad5f09291a5cc.png)

* * *

## 回答 #4

> 赞同：143
> 
> 时间：2012-10-01T20:09:37.610

这是基于来自 xkcd 论坛和`extrafont`包的链接的字体尝试：

如上所述[，xkcd 网站上有一个关于字体的论坛讨论](http://forums.xkcd.com/viewtopic.php?f=2&t=59581)：我抓住了我能找到的第一个，可能还有其他（更好的？）选项（@jebyrnes 在上面的评论中发布了可能字体的另一个来源——TTF 文件在[这里](http://simonsoftware.se/other/xkcd.ttf)；有人报告了该来源的 404 错误，您也可以尝试[此处](https://github.com/ekmett/arcade/blob/master/static/fonts/xkcd.ttf)或[此处](http://antiyawn.com/uploads/Humor-Sans.ttf)，将这些 URL 适当地替换为`xkcdFontURL`下面；您可能需要更加努力地检索 Github 发布的链接）

```
 xkcdFontURL <- "http://simonsoftware.se/other/xkcd.ttf"
   download.file(xkcdFontURL,dest="xkcd.ttf",mode="wb") 
```

（这是为了快速使用，一次性使用：对于常规使用，您应该将它放在一些标准的系统字体目录中。）

```
 library(extrafont) 
```

关于字体最有用的信息[在 extrafont github 网站上](https://github.com/wch/extrafont)——取自那里

```
font_import(".")   ## because we downloaded to working directory
loadfonts() 
```

从 github 站点或多或少地逐字获取示例：

```
library(ggplot2)
p <- ggplot(mtcars, aes(x=wt, y=mpg)) + geom_point() +
  ggtitle("Fuel Efficiency of 32 Cars") +
  xlab("Weight (x1000 lb)") + ylab("Miles per Gallon") +
  theme(text=element_text(size=16, family="xkcd"))

ggsave("xkcd_ggplot.pdf", plot=p,  width=4, height=4)
## needed for Windows:
##   Sys.setenv(R_GSCMD = "C:/Program Files/gs/gs9.05/bin/gswin32c.exe")
embed_fonts("xkcd_ggplot.pdf") 
```

![在此处输入图像描述](../Images/94629c6a63d40af67551219e4db241da.png)

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2014-12-24T07:24:10.330

我只使用 RStudio 设计了一个 xkcd 主题分析日历。这是条形图 xkcd 样式的示例

*   使用的字体 = HumorSans.ttf [上面给出的链接]
*   使用的软件包 [xkcd]

生成此图 ![“工作中的危险”的条形图代理](../Images/9125829779cdf10587dce927bf97bfe8.png)

这是使用的代码

```
#using packages xkcd, ggplot 
library(xkcd)
library(ggplot2)
font_import(pattern="[H/h]umor")
loadfonts()

### Set up the trial dataset 
d1 <- data.frame('type'=c('DROWNING','RADIATION','TOILET',"ELECTRICAL",'NOISE','PANTRY','YOUR    FALLING ON OBJECTS','OBJECTS FALLING ON YOU','BOSS','FIRE','TRAVEL TO WORK'),'score'=c(2,2,3,6,6,6,11,14,21,26,30))

# we will keep adding layers on plot p. first the bar plot
p <- NULL
p <- ggplot() + xkcdrect(aes(xmin = type-0.1,xmax= type+0.1,ymin=0,ymax =score),
                     d1,fill= "#D55E00", colour= "#D55E00")  +
     geom_text(data=d1,aes(x=type,y=score+2.5,label=score,ymax=0),family="Humor Sans") +   coord_flip()

#hand drawn axes
d1long <- NULL
d1long <- rbind(c(0,-2),d1,c(12,32))
d1long$xaxis <- -1
d1long$yaxis <- 11.75

# drawing jagged axes
p <- p + geom_line(data=d1long,aes(x=type,y=jitter(xaxis)),size=1)
p <- p + geom_line(data=d1long,aes(x=yaxis,y=score), size=1) 

# draw axis ticks and labels
p <- p +  scale_x_continuous(breaks=seq(1,11,by=1),labels = data$Type) +
     scale_y_continuous(breaks=NULL)

#writing stuff on the graph
t1 <- "GOOGLE RESULTS"
p <- p + annotate('text',family="Humor Sans", x=12.5, y=12, label=t1, size=6) 

# XKCD theme
p <- p + theme(panel.background = element_rect(fill="white"),
           panel.grid = element_line(colour="white"),axis.text.x = element_blank(), 
           axis.text.y = element_text(colour="black"),text = element_text(size=18, family="Humor   Sans") ,panel.grid.major = element_blank(),panel.grid.minor = element_blank(),panel.border = element_blank(),axis.title.y = element_blank(),axis.title.x = element_blank(),axis.ticks = element_blank())

print(p) 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-10-01T14:41:11.243

这是一个非常非常粗略的开始，仅涵盖（部分）线条的手绘外观和感觉。自动化这需要一些工作，但在响应函数中添加一些 AR(1) 噪声可能会使它看起来有点手绘

```
set.seed(551)
x <- seq(0, 1, length.out = 1000)
y <- sin(x)

imperfect <- arima.sim(n = length(y), model = list(ar = c(.9999)))
imperfect <- scale(imperfect)
z <- y + imperfect*.005
plot(x, z, type = "l", col = "blue", lwd = 2) 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2012-10-01T20:01:19.630

这是我对`ggplot2`使用上面的一些代码的看法：

```
ggplot()+geom_line(aes(x=seq(0,1,length.out=1000),y=sin(x)),position=position_jitter(width=0.02),lwd=1.5,col="white")+
  geom_line(aes(x=seq(0,1,length.out=1000),y=sin(x)),position=position_jitter(width=0.004),lwd=1.4,col="red")+
  geom_line(aes(x=seq(0,1,length.out=1000),y=cos(x)),position=position_jitter(width=0.02),lwd=1.5,col="white")+
  geom_line(aes(x=seq(0,1,length.out=1000),y=cos(x)),position=position_jitter(width=0.004),lwd=1.4,col="blue")+
  theme_bw()+theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) 
```

不确定如何替换轴，但可以使用与`jitter`. 然后就是从 XKCD 导入字体并用`geom_text`.

# joomla - joomla愿望清单和垃圾清单整合

> ID：12675148
> 
> 赞同：0
> 
> 时间：2012-10-01T14:22:53.557
> 
> 标签：joomla

我是 Joomla 的新手。我正在使用 Joomla 1.5 和 Virtuemart。现在我想在 Joomla 1.5 中集成愿望清单和垃圾清单。我应该得到任何免费的模块或组件吗？如果是这样，请参考我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:28:20.977

Stackoverflow 并不是扩展推荐的真正地方。通过 5 秒的搜索，我发现了这一点：

[http://extensions.joomla.org/extensions/extension-specific/virtuemart-extensions/virtuemart-related-products/8149](http://extensions.joomla.org/extensions/extension-specific/virtuemart-extensions/virtuemart-related-products/8149)

然而它不是免费的。

在这里你可以看到价格表，最便宜的是 39 欧元。

[http://www.vmwishlist.com/slice/buy-it/](http://www.vmwishlist.com/slice/buy-it/)

# c++ - 如何将数据文件加载到自动 Excel 工作表文档？

> ID：12675150
> 
> 赞同：0
> 
> 时间：2012-10-01T14:22:59.187
> 
> 标签：c++, excel, automation, activex

我有一个 MFC/C++ 项目，它使用 ActiveX 文档（自动化）方法打开 Excel 表嵌入对象。不幸的是，Excel.Sheet obj API 没有从预先准备好的 htm/cvs 文件中加载数据的方法。所以，我无法加载准备好的数据。唯一能够从文件加载数据的对象是“工作簿”（方法 Open(...)），但它总是创建一个新的工作表对象，并且不使用现有的工作表对象。所有使用嵌入式 Excel.Sheet 文档的示例都提供“手动”填充表格单元格，没有人展示如何打开其中的现有文件。

那么，如何将 html/cvs 数据文件加载到自动 Excel 工作表文档中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T13:05:34.093

您可以使用 OleObjects 将任何文件（任何类型）嵌入 Excel 工作表。这是附加文件的示例代码：

```
BOOL InsertFileToWorksheet(Exl_Worksheet &ws, LPCTSTR lpFilePath, LPCTSTR ObjName)

{ 
    RemoveOldOleObj(ws,ObjName);

    VARIANT vFileName;
    str_to_vt(vFileName,(char*)lpFilePath);
    ExlOLEObjects ole_objects;

    BOOL bRes(TRUE);
    try{
        ole_objects = ws.OLEObjects( vOptional );

        COleVariant left(10l),top(10l),width(1l),height(1l);
        Exl_OLEObject objSrc = ole_objects.Add(vOptional,vFileName,vOptional,vOptional,vOptional,vOptional,vOptional,
                        vOptional,vOptional,vOptional,vOptional);
        objSrc.SetName(ObjName);
    }catch(...){
        bRes = FALSE;
    }

    VariantClear(&vFileName);
    return bRes;
}

void RemoveOldOleObj(Exl_Worksheet &ws, LPCTSTR ObjName )
{
    ExlOLEObjects ole_objects;
    try{
        ole_objects = ws.OLEObjects( vOptional );
    }catch(...){
        return;
    }

    VARIANT vObjName;
    str_to_vt(vObjName,(char*)ObjName);
    Exl_OLEObject obj;

    try{
        obj = ole_objects.Item(vObjName);
        obj.Delete();
    }catch(...){
    }
    VariantClear(&vObjName);

} 
```

您可以[在本文](http://strongcpp.blogspot.com/2013/04/excel-how-to-insert-user-file-into.html)中找到完整的源代码 (c++) 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T09:24:49.937

事实证明，没有办法创建由文件格式初始化的 ActiveX Excel Sheet Document 与 xls/xlsx 不一致。首先需要将html格式转换成xls/xlsx，然后通过标准的OLE API（OleCreateFromFile）打开。[我在链接](https://stackoverflow.com/questions/12742784/export-html-files-with-images-to-excel-single-xls-file)中描述的转换。

# objective-c - Objective-C 方法语法

> ID：12675152
> 
> 赞同：6
> 
> 时间：2012-10-01T14:23:06.190
> 
> 标签：objective-c, syntax, methods, arguments

当编译以下方法定义（使用 Apple LLVM 4.1）时，我感到很惊讶：

```
- (void) testMethod:someArgument {

} 
```

`someArgument`请注意缺少的类型。**Objective-C 中关于指定方法参数类型的规则是什么？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T14:27:58.073

默认参数类型是`id`. 即使这样也会编译：

```
- testMethod:someArgument {
} 
```

这是一个以 an`id`作为参数的方法，应该返回一个`id`.

实际上，甚至不需要方法名称：

```
- :someArgument {
} 
```

这可以称为：

```
[self :someObject]; 
```

当然，所有这些都是非常糟糕的做法，**您应该始终指定类型（和名称）。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:28:52.797

方法参数中的“类型”用于编译器的类型检查和运行时消息传递。

它在你的原型中被调用的方式，它相当于一个“ `(id)`”。

[您可以在 Apple 的Programming with Objective C 文档](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/DefiningClasses/DefiningClasses.html)的“方法可以采用参数”部分找到更多信息。[我还在“The Objective-C Programming Language”文档](http://developer.apple.com/library/ios/documentation/cocoa/conceptual/objectivec/Chapters/ocObjectsClasses.html#//apple_ref/doc/uid/TP30001163-CH11-SW5)的“Object Messaging”部分看到了一些非常有用的信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-01T14:32:55.720

语言规范指出：

> 如果没有显式声明返回或参数类型，则假定它是方法和消息的默认类型 - 一个 id。

[http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/objectivec/chapters/ocDefiningClasses.html](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/objectivec/chapters/ocDefiningClasses.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-01T14:45:52.797

*Objective-C 编程语言* [告诉我们](http://developer.apple.com/library/ios/documentation/cocoa/conceptual/objectivec/Chapters/ocObjectsClasses.html#//apple_ref/doc/uid/TP30001163-CH11-SW3)：

> 对于 Objective-C 的面向对象构造，例如方法返回值，id 替换 int 作为默认数据类型。（对于严格的 C 构造，例如函数返回值，int 仍然是默认类型。）

# javascript - 根据变量动态更改图像 URL

> ID：12675156
> 
> 赞同：2
> 
> 时间：2012-10-01T14:23:15.187
> 
> 标签：javascript, jquery

我目前正在我正在处理的项目中显示一个圆形图。我想通过更改显示的图像 URL 来更新圆图，有 100 个唯一图像，每个图像代表图表上的一个百分点。URL 以 img/circleGraph/circleG-12.png 的方式设置，数字（在本例中为 12）是图表显示的完成百分比。在 JavaScript /jQuery 中，如何根据从数据库返回的百分比更改动态显示的 URL？

这是我正在开发的 .Net MVC 应用程序，因此完成百分比以小数形式在 Razor 变量中返回给我。我知道我必须将此变量乘以 100 才能转换为整数，然后将其设置为 URL 的一部分，但不确定如何处理它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:25:25.133

```
$("img").attr("src", "/img/circleGraph/circleG-" + Math.Round(number*100) + fileExtension); 
```

`number`您从数据库返回的数字在哪里，并且`fileExtension`是图像文件的文件扩展名（.jpg、.png 等...） - 感谢@Shmiddty 的提醒！

# ios - 当变换属性不是身份变换时如何调整视图大小

> ID：12675157
> 
> 赞同：2
> 
> 时间：2012-10-01T14:23:21.200
> 
> 标签：ios, uiview, resize, rotation, cgaffinetransform

我有一个要求，我需要实现重新调整大小、旋转和移动视图的功能。我已经实现了所有三个功能，但过去一周我一直在努力解决一个问题，我无法解决它。

如果我在应用 CGAffineTransformRotate 后尝试通过拖动视图的右上角来调整视图的大小，则视图的框架会进入不可预测的状态。后来我搜索了这个问题我才知道

**如果变换属性不是恒等变换，则该属性的值是未定义的，因此应该被忽略。**

我看到一个应用程序实现了我完全希望实现的相同功能。在该应用程序中，我们可以在旋转后调整视图大小。

应用 CGAffineTransformRotate 后如何通过拖动视图的右上角来调整视图的大小

我在 iOS 应用程序开发方面没有太多经验，过去一周我一直在努力解决这个问题，如果有人解决了我的问题，我将不胜感激。

**我的示例代码**

[http://dl.dropbox.com/u/82675151/sampleImgMv2.zip](http://dl.dropbox.com/u/82675151/sampleImgMv2.zip)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T16:14:35.697

[文档](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instp/UIView/frame)清楚地说：

**如果变换属性不是恒等变换，则此属性的值未定义，因此应被忽略。

如果 transform 属性包含非恒等变换，则 frame 属性的值未定义且不应修改。在这种情况下，您可以使用 center 属性重新定位视图并使用 bounds 属性调整大小。**

因此，只需更改 touchesMoved 中的以下行：

```
 testVw.frame = CGRectMake(testVw.frame.origin.x, testVw.frame.origin.y,touchPoint.x + deltaWidth, touchPoint.y + deltaWidth); 
```

至：

```
 testVw.bounds = CGRectMake(testVw.bounds.origin.x, testVw.bounds.origin.y,touchPoint.x + deltaWidth, touchPoint.y + deltaWidth); 
```

你的代码会很好地工作。

另外，添加一些边框条件。

# multithreading - 我什么时候应该使用 async/await，什么时候不应该使用？

> ID：12675158
> 
> 赞同：12
> 
> 时间：2012-10-01T14:23:22.260
> 
> 标签：multithreading, asynchronous, async-await, c#-5.0

我是否应该从现在开始使用 async/await (c# 5) 每次我不需要立即获得方法的结果 (Task<>) 或者我必须触发一次性方法 (void)？

当我在 C# 4 中使用 Task 类并将工作推送到 Backgroud 线程时，我是否应该在所有情况下都使用它？

我应该只在使用异步 .Net Framework 方法的情况下使用它吗？

使困惑。

我基本上是在寻找一个简单的解释，在哪些情况下我应该使用 await/async，何时不使用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-01T14:32:45.000

`async`/当你有*异步操作*`await`时可以使用。许多操作自然是异步的（例如 I/O）；我推荐所有这些。其他操作自然是同步的（例如计算）；我建议对这些使用同步方法。*`async`*

 *如果需要异步运行同步代码，可以使用`Task.Run`with进行后台工作。`async`我在我的博客上解释了为什么这[比`BackgroundWorker`异步委托](http://nitoprograms.blogspot.com/2010/08/various-implementations-of-asynchronous.html)更好。

您还可以使用`async`其他形式的异步处理来替换，例如`IAsyncResult`样式。

您**应该**`async`在有异步操作的任何情况下使用。*

# android - 位图重复+圆角

> ID：12675161
> 
> 赞同：7
> 
> 时间：2012-10-01T14:23:38.890
> 
> 标签：android, background, bitmap, rounded-corners, repeat

我正在尝试创建具有圆角和背景的矩形作为重复的位图。我正在这样写，但是在角落里得到位图。

有人可以帮忙吗？

背景.xml

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">

<item>
    <shape>
        <stroke
            android:width="1dp"
            android:color="#FFFFFF" />

        <corners android:radius="50dp" />
    </shape>
</item>
<item>
    <bitmap
        android:src="@drawable/carbon_4"
        android:tileMode="repeat" />
</item>

</layer-list> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T18:43:45.097

我发现Romain Guy 的[这篇文章](http://www.curious-creature.org/2012/12/11/android-recipe-1-image-with-rounded-corners/)是在平铺位图上圆角的一种更简单的方法。这是简短的答案：

```
class CurvedAndTiled extends Drawable {

    private final float mCornerRadius;
    private final RectF mRect = new RectF();
    private final BitmapShader mBitmapShader;
    private final Paint mTilePaint;        

    CurvedAndTiled(
            Bitmap bitmap, 
            float cornerRadius) {
        mCornerRadius = cornerRadius;

        mBitmapShader = new BitmapShader(bitmap,
                Shader.TileMode.REPEAT, Shader.TileMode.REPEAT);

        mTilePaint = new Paint();
        mTilePaint.setAntiAlias(true);
        mTilePaint.setShader(mBitmapShader);             
    }

    @Override
    protected void onBoundsChange(Rect bounds) {
        super.onBoundsChange(bounds);
        mRect.set(0, 0, bounds.width(), bounds.height());
    }

    @Override
    public void draw(Canvas canvas) {
        canvas.drawRoundRect(mRect, mCornerRadius, mCornerRadius, mTilePaint);           
    }

    @Override
    public int getOpacity() {
        return PixelFormat.TRANSLUCENT;
    }

    @Override
    public void setAlpha(int alpha) {
        mTilePaint.setAlpha(alpha);
    }

    @Override
    public void setColorFilter(ColorFilter cf) {
        mTilePaint.setColorFilter(cf);
    }       
} 
```

您只需将视图的背景可绘制对象设置为这些人之一，您就可以开始了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T00:35:40.600

据我了解目标：有一个平铺的背景图像，带有一些弯曲的角落。 ![平铺和弯曲](../Images/3cd5a0381c44a5f144572d0c543dfab6.png)

它不是像素完美，但它尽可能接近。

首先，这是我用来绘制该按钮的一些布局

## the_button.xml

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/wrapper_main"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:background="@drawable/bg_curved_tiled"
    android:padding="20dp" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="Some Text" />

</FrameLayout> 
```

这就是使用它作为它的背景

## bg_curved_tiled.xml

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

    <item android:id="@id/layer_needs_rounding">
        <bitmap
            android:src="@drawable/patch"
            android:tileMode="repeat" />
    </item>    
    <item>
        <shape
            android:shape="rectangle"
            android:useLevel="false" >
            <stroke
                android:width="3dp"
                android:color="#666666" />

            <solid android:color="@null" />

            <corners
                android:bottomLeftRadius="@dimen/radius_corner_default"
                android:bottomRightRadius="@dimen/radius_corner_default"
                android:radius="@dimen/radius_corner_default"
                android:topLeftRadius="@dimen/radius_corner_default"
                android:topRightRadius="@dimen/radius_corner_default" />
        </shape>
    </item>

</layer-list> 
```

此时，您有一个看起来像这样的图像

![在此处输入图像描述](../Images/aa9b8364a0702fd914c054bb68fec652.png)

如您所见，平铺位图在角落处伸出覆盖在其顶部的弯曲形状。

所以现在你需要一个圆角位图的函数......我在stackoverflow的其他地方得到了这个

```
 public static Bitmap createRoundedCornerBitmap(Context context,
         Bitmap input, float roundPx, boolean squareTL, boolean squareTR,
         boolean squareBR, boolean squareBL) {
      if (input == null) {
         return null;
      }

      final int w = input.getWidth(), h = input.getHeight();
      Bitmap output = Bitmap.createBitmap(w, h, Config.ARGB_8888);
      Canvas canvas = new Canvas(output);

      final int color = 0xff424242;
      final Paint paint = new Paint();
      final Rect rect = new Rect(0, 0, w, h);
      final RectF rectF = new RectF(rect);                   

      paint.setAntiAlias(true);
      canvas.drawARGB(0, 0, 0, 0);
      paint.setColor(color);
      canvas.drawRoundRect(rectF, roundPx, roundPx, paint);

      // draw rectangles over the corners we want to be square
      if (squareTL) {
         canvas.drawRect(0, 0, w / 2, h / 2, paint);
      }
      if (squareTR) {
         canvas.drawRect(w / 2, 0, w, h / 2, paint);
      }
      if (squareBL) {
         canvas.drawRect(0, h / 2, w / 2, h, paint);
      }
      if (squareBR) {
         canvas.drawRect(w / 2, h / 2, w, h, paint);
      }

      paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.SRC_IN));
      canvas.drawBitmap(input, 0, 0, paint);

      return output;
   } 
```

差不多好了！我讨厌这部分——我还没有找到更好的方法来获取其中包含实际平铺位图的位图对象。例如，BitmapDrawable.getBitmap 只是为您提供单独的补丁位图，而不是平铺的重复补丁画布......真糟糕。因此，相反，我正在获取视图的绘图缓存。您需要首先确保视图已完全初始化（已计算出高度和宽度并适当地平铺），`post`然后到视图并在那里进行处理。

```
private void shaveOffCorners(final ViewGroup view) {          
      view.post(new Runnable() {

         @Override
         public void run() {
            // make all child views invisible before scraping the drawing cache
            SparseIntArray viewStates = new SparseIntArray();
            for(int index = 0; index < view.getChildCount(); ++index) {
               View child = view.getChildAt(index);
               viewStates.put(index, child.getVisibility());
               child.setVisibility(View.INVISIBLE);
            }

            view.buildDrawingCache();
            // this is the exact bitmap that is currently rendered to screen.  hence, we wanted to 
            // hide all the children so that they don't permanently become part of the background
            final Bitmap rounded = view.getDrawingCache();

            // restore actual visibility states after getting the drawing cache
            for(int index = 0; index < view.getChildCount(); ++index) {
               View child = view.getChildAt(index);
               child.setVisibility(viewStates.get(index));
            }

            view.setBackgroundDrawable(new BitmapDrawable(
                  getResources(), 
                  MyImageUtil.createRoundedCornerBitmap(
                        view.getContext(), 
                        rounded, 
                        getResources().getDimensionPixelSize(R.dimen.radius_corner_default), 
                        false, true, true, false)));
         }
      });
   } 
```

我就是这样做的，希望有帮助！

如果有人知道一种不那么可怕的方法来实现这一点，请分享。此外，如果有人知道除了抓取绘图缓存之外如何获取平铺位图，那也会很有帮助 - 整个隐藏和恢复子视图有点笨拙。

# sql - 未显示所有左表值的左连接

> ID：12675162
> 
> 赞同：12
> 
> 时间：2012-10-01T14:23:45.233
> 
> 标签：sql, join, left-join

LEFT JOIN 应该显示左表上的所有行，但是在运行以下查询时，我只获得计数为 1 或更多的位置值。请有人给我一些关于我可能出错的地方的指导：

```
SELECT places.placeId,
       placeName,
       COUNT(orderId) AS orderCount
FROM   places
       LEFT JOIN orders
         ON places.placeId = orders.placeId
WHERE  places.companyId = 1
       AND stateId = 1
       AND orderstateId = 1
       AND orderName NOT LIKE 'Delivery%'
GROUP  BY places.placeId,
          places.placeName
ORDER  BY orderCount DESC,
          placeName ASC 
```

提前致谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-01T14:41:01.673

您的`WHERE`条件将`OUTER JOIN`back 转换为`INNER JOIN`.

不匹配的行将包含`NULL`所有`orders`列并被`WHERE`子句消除。尝试这个。

```
SELECT places.placeId,
       placeName,
       COUNT(orderId) AS orderCount
FROM   places
       LEFT JOIN orders
         ON places.placeId = orders.placeId
       AND orders.stateId = 1
       AND orders.orderstateId = 1
       AND orders.orderName NOT LIKE 'Delivery%'
WHERE  places.companyId = 1
GROUP  BY places.placeId,
          places.placeName
ORDER  BY orderCount DESC,
          placeName ASC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:35:04.667

即使使用 a `LEFT JOIN`，所有行也必须满足`WHERE`子句中的条件。在这种情况下，该`WHERE`子句具有与 相关的要求`orders`，因此您不会返回任何`orders`与 不匹配的行`places`。

一个简单的解决方法是允许空值满足您的`WHERE`子句：

`orderstateId = 1`

更改为

`(orderstateId is NULL or orderstateId = 1)`

对于其他变量也是如此。

这可能会满足您的要求，但您必须检查是否`orders`可以包含表中具有空值的行并弄乱您的结果。以另一种方式重新设计查询可能会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T14:28:15.407

如果这些列`stateID`、`orderstateID`和`OrderName`来自`ORDERS`表，那么您将遇到问题。如您所见，如果表`places.placeID`上不存在`orders`，则以下列为`nulls`表`orders`。这就是为什么某些记录不会显示的原因，因为您在`orders`桌子上提供的条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T14:27:35.133

你在说`orderstateId = 1`。我想这绑定到`orders.orderstateId = 1`. `orderstateId`当左连接没有匹配时发生的空值，此条件失败。

将其更改为`orders.orderstateId = 1 OR orders.orderstateId IS NULL`

# r - 类排列之间唯一

> ID：12675163
> 
> 赞同：3
> 
> 时间：2012-10-01T14:23:46.720
> 
> 标签：r, permutation

假设我们有 2 个类（A 和 B），每个类有 2 个样本，如下所示：

```
A A B B
1 2 3 4 
```

我想生成所有可能的**唯一**排列，其中新类组是旧类的混合，以计算新的统计数据。在这种情况下，我们会得到：

```
A A B B
1 3 2 4
1 4 2 3 
```

任何其他排列，在 A 类和 B 类之间进行 t 检验（或 ANOVA 等）时，将给出与原始排序相同的结果，我不想要它。有没有一种简单的方法可以做到这一点`R`？

我可以想象生成原始索引向量的**所有**`split`排列，对每个排列的样本类执行 s，然后检查样本类的组合是否已经存在，如果不更新排列列表，然后转到下一个排列，等等等等。我只是想检查是否有某种方法可以使用`permute`包或`R`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:38:15.440

找到了答案。这个`partitions`包有一些很好的工具来处理这些集合或**分区的排列**

对于上面的示例，我们在两个分区中有 2 个项目，一个简单的做法是：

```
library(partitions)
listParts(c(2,2)) 
```

这返回

```
listParts(c(2,2))
[[1]]
[1] (1,4)(2,3)

[[2]]
[1] (1,2)(3,4)

[[3]]
[1] (1,3)(2,4) 
```

# c - 转弯方向

> ID：12675164
> 
> 赞同：0
> 
> 时间：2012-10-01T14:23:47.393
> 
> 标签：c, math, arduino

我怎样才能找出你必须转向哪个方向才能以最短的方式到达新的设定点？

我有一段控制步进电机的 Arduino 代码。使用编码器，我可以将步进电机的位置设为 0..2048。

现在我有一个设定点 200，我移动到 200，这应该是顺时针的。现在我在 200，我想去点 2000，这应该逆时针发生，因为这是最短的方式。

我怎样才能有效地计算我应该转向哪条路？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T14:33:05.227

尝试这个：

```
delta = (setpoint << 5) - (current_position << 5);
delta = delta >> 5; 
```

这假设所有变量都是 16 位有符号的。您的步进器的计数在 2048 处“翻转”，这与处理器的数学翻转方式相似但不同。通过左移五位，您可以将步进翻转与 CPU 翻转对齐，一切正常。通过将结果移回，您可以获得移动步进器所需的计数 - 以有符号值表示，因此正数是一种方式，负数是另一种方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:35:55.537

从新设定值中减去旧设定值。

如果该差值的绝对值大于 1024，则添加或减去 2048 的倍数，使得结果的绝对值不大于 1024。

完成此操作后，如果上述计算的结果为正，那么您将沿顺时针方向移动该量。如果结果为负，则逆时针移动该数量的绝对值。

# php - 向我的 MySQL 表添加排名值

> ID：12675166
> 
> 赞同：4
> 
> 时间：2012-10-01T14:23:53.040
> 
> 标签：php, mysql, sql, rank

我有一张不会改变的固定桌子。我有超过 80,000 行。

```
CREATE TABLE `word_list_master` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `word` varchar(64) NOT NULL,
  `created` int(11) NOT NULL,
  `frequency` int(11) NOT NULL,
  `number_of_files` int(11) NOT NULL,
  `combined_frequency` bigint(24) NOT NULL,
  PRIMARY KEY (`id`)
) 
```

我想创建一个第 7 列“排名”，它将确定由 combine_frequency 列排序的行的排名。我这样做是为了减少数据库运行时的开销。

我可以通过 MySQL 语句执行此操作，还是必须在 PHP 中编写一堆 SELECT/INSERT 语句（例如）？到目前为止，我一直在用 PHP 完成大部分工作，但在表上执行操作最多需要 24 小时。

我正在查看 RANK 函数，但由于我的 MySQL 能力仅在容量上是公平的，我遇到了问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:58:16.123

通常我不会认为“不要这样做”是对此类问题的有效答案，但您不会通过添加新列来帮助您的情况。您已经*有*一个用于对数据进行排序的数字列。为此目的添加第二个数字列不仅过分杀戮，而且是糟糕的设计。

如果对仅包含 80,000 行（不是很多）的表执行*任何*操作需要“长达 24 小时”，那么您需要为用于搜索/排序/连接的列[添加索引。](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:26:23.443

这是`rank`向表中添加字段的方式：

```
 SET @rownum = 0; 

 SELECT *,  (@rownum := @rownum + 1) AS rank
 FROM word_list_master
 ORDER BY combined_frequency DESC; 
```

**更新：**如果要针对该排名字段编写查询，则必须使用前一个表作为派生表，如下所示：

```
SET @rownum = 0; 
SELECT *
FROM
(
   SELECT *,  (@rownum := @rownum + 1) AS rank
   FROM word_list_master
   ORDER BY combined_frequency DESC;
) t
WHERE rank = 5 
```

如果您想像这样分页查询：

```
SET @rownum = 0; 
SELECT *
FROM
(
   SELECT *,  (@rownum := @rownum + 1) AS rank
   FROM word_list_master
   ORDER BY combined_frequency DESC;
) t
WHERE rank BETWEEN ((@PageNum - 1) * @PageSize + 1)
AND (@PageNum * @PageSize) 
```

**更新：**

请注意，已经有一种内置的方式来执行此操作，而不是这个糟糕的查询[`[LIMIT {[offset,] row_count }]`](http://dev.mysql.com/doc/refman/5.0/en/select.html)，它是执行此操作的标准 mysql 方式。如果您只想从查询中获得有限的结果集，请不要使用以前的方式。

# objective-c - 检测 WiFi 网络是否需要身份验证

> ID：12675167
> 
> 赞同：3
> 
> 时间：2012-10-01T14:23:56.870
> 
> 标签：objective-c, ios, wifi

我正在编写一个使用 HTTP Web 服务来获取其数据的 iOS 应用程序。如果用户连接到需要用户使用某种 Web 表单登录的 WiFi 网络（想想星巴克或机场的 Wi-Fi），那么我的应用程序将失败并出现错误 500。

我注意到 Safari 可以检测到这一点并为用户启动身份验证页面。有没有我可以使用的标准来提供这种体验，或者至少向用户显示一条消息，要求他们打开 safari 并登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:48:42.677

基本方法是：尝试在某个地方下载一个您知道永远不会移动并且您已经知道其内容的文件。将下载的内容与应下载的内容进行比较，您就会知道您是否在强制热点上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:47:02.420

您可以尝试使用此版本的[可达性](https://github.com/tonymillion/Reachability)...

它具有以下有趣的方法可以帮助您入门：

```
// WWAN may be available, but not active until a connection has been established.
// WiFi may require a connection for VPN on Demand.
-(BOOL)isConnectionRequired; // Identical DDG variant.
-(BOOL)connectionRequired; // Apple's routine.
// Dynamic, on demand connection?
-(BOOL)isConnectionOnDemand;
// Is user intervention required?
-(BOOL)isInterventionRequired; 
```

# macos - Spotify + AppleScript：将当前曲目添加到播放列表

> ID：12675168
> 
> 赞同：6
> 
> 时间：2012-10-01T14:23:56.660
> 
> 标签：macos, applescript, spotify

我找到了一些如何通过 AppleScript 控制 Spotify 的脚本。但它们只包括播放/暂停、下一个、上一个、停止等内容。我在 Spotify 上搜索 AppleScript 的一些参考资料，但没有找到。

是否可以使用 AppleScript 将 Spotify 中的当前播放曲目添加到特定播放列表，然后为该脚本分配系统范围的快捷方式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-06-29T16:00:37.907

如果您有 Internet 连接，这实际上是可能的。

尽管[Spotify AppleScript API](https://developer.spotify.com/applescript-api/)本身不支持将歌曲添加到播放列表，但您可以从您的脚本中调用他们的[Web API](https://developer.spotify.com/web-api/)（支持此功能）。

它看起来像这样：

```
do shell script "curl -i -X POST 'https://api.spotify.com/v1/users/{USER_NAME}/playlists/" & playlist_id & "/tracks?uris=" & track_id & "' -H 'Authorization: Bearer " & oauth_id & "' -H 'Accept: application/json'" 
```

在哪里

1.  `playlist_id`是您的播放列表（无论是公开的还是私有的）的 URL 中的 ID，格式为`https://open.spotify.com/user/{USER_NAME}/playlist/playlist_id`
2.  `track_id`是歌曲的 Spotify URI（例如，您可以使用 AppleScript API:`set track_id to id of the current track`获取）
3.  `oauth_id`是您在注册和授权应用程序时从 OAuth 获得的授权密钥（这是一个棘手的问题）；如果您希望能够将其与私人播放列表一起使用，请记住在授权时请求私人播放列表修改范围

至于通用快捷方式，我在 Automator 中创建了一个系统范围的[服务](http://computers.tutsplus.com/tutorials/introduction-to-automator-services--cms-20782)，它简单地运行我的 AppleScript 并将其分配给[System Preferences](https://support.apple.com/kb/PH18418?locale=en_US)中的快捷方式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-01T19:52:41.930

1) 每个可编写脚本的应用程序都有固有的文档记录。在 AppleScript Editor 中，从 File 菜单中选择 Open Dictionary... 并选择应用程序。

2) 不，您不能使用 Spotify 的脚本界面修改播放列表。

# ms-access - 生成包含多个表/查询的 MS Access 报告

> ID：12675169
> 
> 赞同：0
> 
> 时间：2012-10-01T14:23:56.707
> 
> 标签：ms-access, report

我使用 Access 2007 从部门内的多个单位导入统计数据 (Excel)。尽管它们共享相似的字段，但每个单元都有自己的表，因为它们还具有需要跟踪的单元特定数据/字段。

表：UnitA -（字段：日期、汽车、船、标签、枪支、失踪人员等）

表：UnitB -（字段：日期，汽车，船，标签，枪支，板凳权证等）

表：UnitC -（字段：日期、汽车、船、标签、枪支、指纹等）

我需要创建一个查询 START DATE 和 END DATE 的摘要报告，然后生成一个报告，该报告将显示：

每个记录中每个单独字段的总和，即 Sum([Fingerprints]) 每个记录中每个共享字段的总和，即 Sum([UnitA!Cars]) + Sum([UnitB!Cars]) 等。

我可以毫无问题地为每个单独的单元创建报告。

当我创建三个单元报告并尝试使用子报告时，我的问题就开始了。Access 将提示我输入新的开始日期和结束日期。

有没有人有更好的解决方案？我是否应该创建一个“提示”表单，其中包含可以从每个查询中访问的开始日期和结束日期字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:31:13.537

更好 - 将共享单位数据导入单位表，然后将统计数据导入明细表：

```
CREATE TABLE Unit (
    UnitID CONSTRAINT PK_unit PRIMARY KEY,
    UnitNo VarChar,
    OtherUnitInfo )

CREATE TABLE DetailCategory (
    CategoryID CONSTRAINT PK_DetailCategory PRIMARY KEY,
    Category Varchar ) -- example rows: 'Guns' 'Missing Persons' etc

CREATE TABLE Unit_DetailCategory (
    UnitID FOREIGN KEY (UnitID) REFERENCES Unit (UnitID),
    CategoryID FOREIGN KEY (CategoryID REFERENCES DetailCategory (CategoryID),
    Qty Long ) 
```

然后，您可以使用 TRANSFORM/PIVOT，类似这样，来获取您的总和值：

```
TRANSFORM Sum(Unit_DetailCategory.Qty) AS SumOfQty
SELECT 'Sum of Unit Values' AS FunctionName
FROM DetailCategory 
RIGHT JOIN (Unit INNER JOIN Unit_DetailCategory 
    ON Unit.UnitID = Unit_DetailCategory.UnitID) 
    ON DetailCategory.CategoryID = Unit_DetailCategory.CategoryID
GROUP BY 'Sum of Unit Values'
PIVOT DetailCategory.Category 
```

注意 - 我的语法在 CREATE 语句中可能存在缺陷，您可能必须使用 TRANSFORM/PIVOT 才能准确获得所需的内容。但这适用于我的机器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:41:44.163

您可以使用联合创建单个查询

```
SELECT Date, Cars, Boats, Tags, Guns,
   [Missing Persons], Null AS [Bench Warrants], Null AS Fingerprints FROM UnitA
UNION ALL
SELECT Date, Cars, Boats, Tags, Guns,
   Null,              [Bench Warrants],         Null                 FROM UnitB
UNION ALL
SELECTG Date, Cars, Boats, Tags, Guns,
   Null,              Null,                     Fingerprints         FROM UnitC 
```

每个 SELECT 中的字段数必须相同。第一个 SELECT 的字段名称将用于结果。

* * *

但是，我建议另一种数据库设计。将所有常用字段放在一个公共表中，并将特定于单位的字段放在您以 1 对 1 关系连接的其他表中

```
CREATE TABLE Unit (
    UnitID  CONSTRAINT PK_unit PRIMARY KEY,
    Date datetime,
    Cars long,
    Boats long,
    Tags long,
    Guns long
)

CREATE TABLE UnitA (
    UnitID  CONSTRAINT PK_unitA PRIMARY KEY,
    [Missing Persons] Long
)
ALTER TABLE UnitA
   ADD CONSTRAINT FK_unitA_unit
   FOREIGN KEY (UnitID) REFERENCES Unit (UnitID)

CREATE TABLE UnitB (
    UnitID  CONSTRAINT PK_unitB PRIMARY KEY,
    [Bench Warrants] Long
)
ALTER TABLE UnitB
   ADD CONSTRAINT FK_unitB_unit
   FOREIGN KEY (UnitID) REFERENCES Unit (UnitID)

CREATE TABLE UnitC (
    UnitID  CONSTRAINT PK_unitC PRIMARY KEY,
    Fingerprints Long
)
ALTER TABLE UnitC
   ADD CONSTRAINT FK_unitC_unit
   FOREIGN KEY (UnitID) REFERENCES Unit (UnitID) 
```

现在您可以使用左连接创建查询。

* * *

一个更简单的设计是只创建一个表，并允许空字段

```
CREATE TABLE Unit (
    UnitID  CONSTRAINT PK_unit PRIMARY KEY,
    Date datetime,
    Cars long,
    Boats long,
    Tags long,
    Guns long,
    [Missing Persons] Long,
    [Bench Warrants] Long,
    Fingerprints Long
) 
```

无需直接导入 excel 表，只需链接 excel 表，然后使用自定义追加查询将其内容附加到公用表。

# jenkins - 从 Cloudbees 中的 jenkins 部署到 cloudfoundry

> ID：12675171
> 
> 赞同：1
> 
> 时间：2012-10-01T14:24:01.267
> 
> 标签：jenkins, cloud-foundry, cloudbees

是否可以将 grails 应用程序从托管在 Cloudbees 中的 jenkins 构建部署到 cloudfoundry？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T14:58:56.443

CloudFoundry 有适用于 Maven 和 Grails 的插件，所以我看不出你为什么不能这样做。查看[http://blog.springsource.com/2011/04/12/one-step-deployment-with-grails-and-cloud-foundry/](http://blog.springsource.com/2011/04/12/one-step-deployment-with-grails-and-cloud-foundry/)了解更多详情。我假设您可以将`grails`命令作为 Jenkins 构建的一部分运行。

# entity-framework - LINQ to Entity：如何添加一个方法来选择表达式 LINQ，它不会被转移到 SQL。并将使用查询结果

> ID：12675178
> 
> 赞同：0
> 
> 时间：2012-10-01T14:24:22.043
> 
> 标签：entity-framework, linq-to-entities, mapping

我正在迈出学习 LINQ to Entity 的第一步，我使用的是 Entity Framework 5。

我必须编写一个 LINQ 表达式，因为结构数据库不允许像 lambda 那样容易编写。

无需赘述，我有以下查询。

```
 var query = from t1 in context.Table1 
                from t2 in context.Table2
                where t1.ExternalId = t2.Id &&
                      t1.Field1= "some value" &&
                      t2.Field1 < SOME_NUMBER
                select new MyCustomViewModel{
                      field1 = t1.field1,
                      field2 = t2.field1,
                      fieldBySpecificType = MyCustomMapper.Map<SomeType>(t1.field3),
                } 
```

正如您在模型的形成中所看到的，称为映射器，它从字符串表示反序列化某些类的重要性。LINQ 并告诉我它无法在 SQL 表达式中翻译此方法。如您所见，我的模型包含来自多个表的字段，因此我无法收集它。

我试图找到一个解决方案，能够说 LINQ 不需要这种方法来转换为 SQL。对属性进行排序的东西。但我所有的努力都没有成功。也许有什么是我的问题的架构解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:30:07.727

据我所知，您首先获取基本查询并对`ToList()`结果进行操作，然后您可以应用无法转换为 SQL 的方法。

# javascript - Wicket：当用户按下“取消”时，捕捉确认对话框的 JavaScript 事件

> ID：12675181
> 
> 赞同：0
> 
> 时间：2012-10-01T14:24:58.170
> 
> 标签：javascript, ajax, wicket

我们有一个 AjaxButton，例如：

```
add(new AjaxButton("ajax-cancel-button", form) {
    private static final long serialVersionUID = 839803820502260006L;

    @Override
    protected void updateAjaxAttributes(AjaxRequestAttributes attributes) {
        super.updateAjaxAttributes(attributes);
        attributes.getAjaxCallListeners().add(new ConfirmCallListener(833L));
    }

    @Override
    protected void onSubmit(AjaxRequestTarget target, Form<?> form) {
        // repaint the feedback panel so that it is hidden
        target.add(feedback);

        // DO ACTION
    }
}); 
```

ConfirmCallListener 看起来像这样：

```
public class ConfirmCallListener extends AjaxCallListener {
    private static final long serialVersionUID = 7355235720213137963L;

    public ConfirmCallListener(long id) {
        onPrecondition("if (!confirm('Do you want this')) {" 
                + js + "; return false;}");
    }
} 
```

我现在想要的是当用户在“确认”对话框中按下“取消”（NOT Ok）时捕获 JavaScript 事件。当用户按下“确定”时，我可以捕捉到事件。但我也想对“取消”事件做出反应（因为当用户按下取消时，一些加载栏应该消失）。

如何捕捉确认框的取消事件？

谢谢！塞巴斯蒂安

# objective-c - XCode 4.5：xcodeindex 命令行工具

> ID：12675182
> 
> 赞同：1
> 
> 时间：2012-10-01T14:25:00.917
> 
> 标签：objective-c, ios, xcode, xcode4

显然，在早期的 XCode 版本中有一个名为 xcodeindex 的工具可以从命令行索引项目。但是，即使我在首选项中安装了命令行工具，似乎也没有。

**我只是没有找到它吗？有没有其他方法可以强制索引项目？**

（问题是，如果我从例如 SVN 下载一个项目并尝试对其进行 xcodebuild 而不先在 XCode 中打开它，它将失败并显示一条消息，例如项目中不存在指定的方案。如果我在先 XCode，让它索引一点，xcodebuild 不会失败。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T20:01:26.983

解决方案：不需要对项目进行索引。通过进入 XCode 中的“管理方案”菜单并选中特定方案旁边的“**共享”复选框，问题将得到解决。**

# c# - C# 返回字符串.Empty; 并返回 String.Empty；

> ID：12675183
> 
> 赞同：6
> 
> 时间：2012-10-01T14:25:03.523
> 
> 标签：c#

> **可能重复：**
> [在 C# 中，我应该使用 string.Empty 还是 String.Empty 还是“”？](https://stackoverflow.com/questions/263191/in-c-should-i-use-string-empty-or-string-empty-or)

有什么区别：

```
return string.Empty;
return String.Empty;
return ""; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-01T14:28:12.747

由于`string`是 的语言*别名*，`String`因此第一个和第二个表达式之间绝对没有区别。

从 .NET 2 开始，`""`返回与 完全相同的对象`String.Empty`，使所有三个语句在它们返回的值方面彼此完全等效。即使在 2 之前的 .NET 中，也不会因为实习而创建多个对象。

第一个和第二个片段将生成与第三个片段不同的 IL 代码，但它们都将返回相同的对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-01T14:28:56.200

归根结底，没有区别。

`string`是一个别名`System.String`（意味着它实际上是同一件事），当您键入“string”时，编译器在编译时将其更改为“System.String”。

现在， System.String.Empty 定义为：

```
public static readonly string Empty = ""; 
```

所以这只是一种方便的方式来明确表示你想使用一个空字符串，而不是`""`可能是一个错字。

# c++ - 遇到值时中断

> ID：12675185
> 
> 赞同：0
> 
> 时间：2012-10-01T14:25:09.160
> 
> 标签：c++, visual-studio-2010, debugging, breakpoints

好的，我在这里冒险，因为我不确定这个功能是否存在，但如果它不存在，它可能应该。这是我所知道的：

在代码的某处，读入了一大块数据。我试图找到那部分代码。（我们在这里谈论的是一个巨大的代码库 - 近 300 个项目中的数万个文件。甚至无法开始猜测代码行 - 每个文件 2000-3000 个并不少见，所以这是真正的针/干草堆领域。）我知道这个数据包含一个特定的可识别字符串。我希望能够在将**任何**内存块设置为该字符串时设置断点。

我不知道的是：

我不知道该字符串存储在何处，甚至不知道该字符串是否存储在任何地方，因此我无法在内存地址或变量上设置断点。我所知道的是，至少在很短的一段时间内（可能不超过一个函数的范围，或者甚至只是 for 循环的一次迭代），这个值存在*于某个地方*。字符串本身可能会被代码忽略，只存储随附的数据，但字符串必须在某个时间点存在于内存中。

我显然无法设置常规断点，因为如果我知道在哪里放置断点，我已经拥有了我需要的东西，并且没有必要采取这种措施。我什至不知道这段代码出现在哪个项目中，更不用说那个文件中的什么文件或什么函数了——这就是我想要弄清楚的。

这只是一厢情愿吗？还是有一些简单的方法来做这种事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T13:06:31.467

使用 Microsoft 的 Process Monitor（原为 SysInternals）来监控文件 I/O。如果您正确配置了符号（您的和 Microsoft 的），那么 Process Monitor 将显示与每个文件 I/O 操作关联的堆栈跟踪。

# java - JSF 中的 CDI 全局事件处理 (javax.enterprise.event)

> ID：12675186
> 
> 赞同：1
> 
> 时间：2012-10-01T14:25:09.950
> 
> 标签：java, events, jsf-2, cdi

我想基于`javax.enterprise.event.Event`接口实现事件处理程序。目前它运行良好，但仅限于单个会话。我的环境是*JBoss-7.1.1.Final*和*JSF2*。我可以在这个简化（工作）示例中演示这个问题：

在`@Named`Bean 中，我定义了一个`Event<MyEjb>`并且可以触发事件。

```
@Inject private Event<MyEJB> ejbChanged;

public void test()
{
  ejbChanged.fire(new MyEjb());
} 
```

`@Named @SessionScoped`这在Bean中被识别，我可以轻松地处理它

```
public void
       onChanged(@Observes(notifyObserver = Reception.IF_EXISTS) final MyEjb ejb)
{
  logger.info("onChanged "+ejb.toString());
} 
```

但不幸的是，仅在属于当前用户会话`onChanged`的 Bean 中调用。`@SessionScoped`但我也想访问属于其他用户会话的 Bean。这个 CDI 事件处理可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T14:54:02.807

[Markus Dahm 在此处](http://blog.akquinet.de/2012/02/28/extending-cdi-observer-pattern-to-support-global-events/)的博客条目中描述的解决方案

他将事件发送到 Web 应用程序的所有活动会话的解决方案包括扩展现有的 CDI 观察者模式以支持全局事件。

以下是相关代码：

首先，我们需要一个 GlobalevHttpSessionController 来注册和处理所有 HTTP 会话并将所有事件委托给会话：

```
@ApplicationScoped
public class GlobalevHttpSessionController {
  public static final String 
    EVENT_ATTRIBUTE_NAME = "HttpSessionControllerEvent";

  private final List _httpSessions = new ArrayList();

  public List getHttpSessions() {
    return new ArrayList(_httpSessions);
  }

  public void addSession(final HttpSession httpSession) {
    _httpSessions.add(httpSession);
  }

  public void removeSession(final HttpSession httpSession) {
    _httpSessions.remove(httpSession);
  }

  public void fireEvent(final GlobalEvent eventObject) {
    for (final HttpSession session : _httpSessions) {
      fireEvent(session, eventObject);
    }
  }

  private void fireEvent(final HttpSession session, final GlobalEvent eventObject) {
    try {
      final List globalEvents = getGlobalEvents(session);

      globalEvents.add(eventObject);
    } catch (final Exception e) {
      throw new IllegalStateException("fireEvent", e);
    }
  }

  private synchronized List getGlobalEvents(final HttpSession session) {
    List globalEvents = (List) session.getAttribute(EVENT_ATTRIBUTE_NAME);

    if (globalEvents == null) {
      globalEvents = new ArrayList();
      session.setAttribute(EVENT_ATTRIBUTE_NAME, globalEvents);
    }

    return globalEvents;
  }
} 
```

其中 GlobalEvent 只是所有全局事件的简单可序列化超类：

```
public abstract class GlobalEvent implements Serializable {
  private static final long serialVersionUID = 1L;
} 
```

接下来，我们需要一个 HTTP 侦听器来添加和删除活动的客户端会话：

```
@WebListener
public class GlobalevHttpSessionListener implements HttpSessionListener {
  @Inject
  private GlobalevHttpSessionController _httpSessionController;

  public void sessionCreated(final HttpSessionEvent se) {
    _httpSessionController.addSession(se.getSession());
  }

  public void sessionDestroyed(final HttpSessionEvent se) {
    _httpSessionController.removeSession(se.getSession());
  }
} 
```

为了将事件分派给客户端，他选择使用 JSF PhaseListener 查找传入事件。其他解决方案，例如使用过滤器，也是可能的。侦听器查找全局事件并使用 CDI bean 管理器将它们分派到本地会话。管理器实例是通过 JNDI 查找获得的（根据规范，bean 管理器必须由 java:comp/BeanManager 下的容器绑定）。不幸的是，我们不能在这里使用 CDI 注入，因为阶段监听器不是由 CDI 实例化，而是由 Java Server Faces (JSF) 框架实例化的。然而，该框架确实提供了我们通过 FacesContext 对象访问 HTTP 会话所需的所有信息

```
public class GlobalevEventPhaseListener implements PhaseListener {
  public void beforePhase(final PhaseEvent event) {
    final FacesContext facesContext = event.getFacesContext();
    final HttpSession httpSession =   
        JSFUtil.getHttpSession(facesContext);

    if (httpSession != null) {
      final List globalEvents = getGlobalEvents(httpSession);

      if (!globalEvents.isEmpty()) {
        fireEvents(globalEvents);
      }
    }
  }

  private void fireEvents(final List globalEvents) {
    final BeanManager beanManager = lookBeanManager();

    if (beanManager != null) {
      try {
        for (final GlobalEvent devaGlobalEvent : globalEvents) {
          beanManager.fireEvent(devaGlobalEvent);
        }
      } catch (final Exception e) {
        throw new IllegalStateException("fireEvents", e);
      }
    }
  }

  @Override
  public PhaseId getPhaseId() {
    return PhaseId.RENDER_RESPONSE; // RESTORE_VIEW;
  }

  private BeanManager lookBeanManager() {
    try {
      final Object obj = 
        new InitialContext().lookup("java:comp/BeanManager");

      return (BeanManager) obj;
    } catch (final Exception e) {
           throw new 
            IllegalStateException("Lookup bean manager", e);
    }

    return null;
  }

  private synchronized List getGlobalEvents(final HttpSession httpSession) {
    final List events = (List) httpSession.getAttribute(
        GlobalevHttpSessionController.EVENT_ATTRIBUTE_NAME);
    final List result = new ArrayList();

    if (events != null) {
      result.addAll(events);
      events.clear();
    }

    return result;
  }
} 
```

最后，我们需要在 faces-config.xml 中注册我们的监听器：

```
<lifecycle>
  <phase-listener>
de.akquinet.jbosscc.globalev.listener.GlobalevEventPhaseListener
  </phase-listener>
</lifecycle> 
```

代码也可以在[github 上找到](https://github.com/mdahm/jbosscc-globalev)

感谢马库斯！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T13:23:15.017

我曾经想过这个，但后来，这种方法的可扩展性如何？如果您有数千个活动会话怎么办？事件的回调方法必须非常轻量级，因为对于您触发的每个事件，您在每个上下文中都有数千个方法调用。

您并不总是需要通知所有活动会话，您可以扩展此机制并让某些会话订阅特定事件，以便方法调用的数量在您的控制之下。

您应该做什么取决于您的要求，如果数据更新非常频繁，您最好让会话 bean 轮询应用程序范围的 bean 以进行更改，这样，会话 bean 仅在来自的实际请求时刷新其数据用户。这将只更新当前正在使用数据的那些 bean。

同样，也许有人可以帮助我解决这个问题，但我觉得这不会导致可扩展的设计，如果有一天你决定使用负载平衡并且你有一个服务器集群并且你需要将一个事件传播到所有活动会话在所有服务器等中。我觉得规范没有实现这一点是有正当理由的。您应该将服务器的工作量最小化到用户需要的程度，考虑您可以使用属于离开计算机去喝杯咖啡的用户的事件更新多少会话 bean，等等。

# jquery - jQuery Datapicker 缩放...图标大小不会改变

> ID：12675188
> 
> 赞同：0
> 
> 时间：2012-10-01T14:25:14.247
> 
> 标签：jquery, jquery-ui, scaling, datapicker

我已经使用 更改了 jQuery Datapicker 的大小`font-size`，但是我的 jQuery-UI 图标（上一个/下一个）仍然是它们的原始大小（尽管当我看到它们时，div 的大小真的很大）。如何使图标适合数据选择器的新大小？

![在此处输入图像描述](../Images/a1c6561024db81de7cc3cf550ec059ac.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:30:28.793

下一个和上一个图标是作为 sprite 一部分显示的背景图像：

```
.ui-icon, .ui-state-focus .ui-icon 
{
    background-image: url(images/ui-icons_ef8c08_256x240.png);
} 
```

您需要获得更大的精灵集或创建自己的下一个/上一个图标并覆盖 ui-icon 的背景属性。

# events - Icefaces 3.0 中不需要的按键提交

> ID：12675200
> 
> 赞同：2
> 
> 时间：2012-10-01T14:25:44.583
> 
> 标签：events, icefaces, onkeyup

我使用 Icefaces 3.0，但我遇到了一个烦人的问题。Icefaces 的 ice:inputText 组件总是（即使没有`partialSubmit`设置为 true）在输出上注册一个 onkeyup Javascript 事件处理程序，如下所示：

```
onkeyup="iceSubmit(form,this,event);" 
```

没关系，它不会打扰我。但是，如果我使用验证器，事情可能会出错。
如果我在另一个 ice:inputtext 上有一个验证器，每次我输入一个非英语或特殊字符（如 $）时，icefaces 都会提交该值，并且在整个表单上进行验证。即 icefaces 在视图上生成一个完整的提交。
更有趣的是：如果我只输入英文字符，什么也不会发生。没有完全提交，甚至没有部分提交，这是预期的行为。

我的问题是：如何禁用此行为？当然，我可以将`onkeyup="return false;"`我的 XHTML 添加到每个输入组件中，但这对我来说似乎有点矫枉过正。
谢谢！

# winforms - 尝试使标签透明时需要运行时错误 424 对象

> ID：12675202
> 
> 赞同：0
> 
> 时间：2012-10-01T14:25:51.777
> 
> 标签：winforms, vb6, runtime-error

我正在使用 VB 6.0，并且试图使标签的背景色透明。这可能看起来像一个愚蠢的问题，但我已经仔细研究了这个问题并尝试了很多方法，但没有一个奏效。

我有以下代码

```
 Private Sub Form_Load()
   Label1.BackColor = System.Drawing.Color.Transparent
   End Sub 
```

但是当我运行项目时，它给了我错误“需要运行时错误 424 对象”

由于没有人找到答案，但这些额外信息可能会帮助您找出问题所在

当我用

```
 Label1.BackColor = Color.Transparent 
```

我在“颜色”上收到一个错误，说“编译错误：无效的限定符”我认为程序由于某种原因无法识别“颜色”！请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T16:36:23.167

没有**颜色**库。那是你错误的根源。尝试将 BackStyle 设置为透明。

```
Label1.BackStyle = vbTransparent '0 
```

# matlab - 一次在matlab中处理多个数据

> ID：12675209
> 
> 赞同：2
> 
> 时间：2012-10-01T14:26:23.287
> 
> 标签：matlab, loops

我已将一组 50 个文件加载到 matlab 工作区中。（从`data1`到`data50`）。每一个的大小是`721*176`。我只想提取每个数据的前 144 行并将其存储在另一个中。

例如：

```
newData1 = data1(1:144,:); 
```

我的问题是：如何使用循环一次处理所有数据来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:45:32.737

这取决于您如何存储数据。

在您的情况下，最好的方法是 3D 数组：

首先，分配数组（正如@HighPerformanceMark 正确指出的那样）：

```
data = zeroes(721,176,50); 
```

然后，用值填充它：

```
data(:,:,1)  =  read('firstFile.bmp');
data(:,:,2)  =  read('secondFile.bmp');
...

data(:,:,50) = ... 
```

在这种情况下，只需使用以下选择：

```
data(1:144,:,:) 
```

* * *

存储数据的另一种可能的方式是元胞数组。它很有用，因为 3D 数组无法处理不同大小的矩阵。

```
 data{1} = read('firstFile.bmp');
 data{2} = read('secondFile.bmp');
 ... 
```

在这种情况下，使用`cellfun`：

```
 selection = cellfun(@(x) {x(1:144,:)}, data); 
```

* * *

如果您仍然坚持将数据存储在单独的变量中而不是数组中，则可以使用`eval`. 这是最不推荐的方式。

```
 for i=1:50
    eval(' selection{i} = data%d',i)
 end 
```

# iis - 如何在 IIS 上设置经典 ASP？

> ID：12675212
> 
> 赞同：0
> 
> 时间：2012-10-01T14:26:40.883
> 
> 标签：iis, deployment, asp-classic

我必须为它创建站点并使用经典的 ASP。实际上我是 ASP 的初学者。

起初我想知道是否可以在 IIS 上托管 ASP 并与 WCF 通信，因为 WCF 将我的数据库保存在实体框架上？

其次，我在 Windows 期货帮助下安装了 IIS Express.msi 和 IIS 管理器。我有一些页面 .asp 的文件夹，我在 VS2010 中打开了这个文件夹，比如 WebSite.What Else？

我应该怎么做这个文件夹已经在 IIS 上启动，我可以使用这个页面？感谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T18:49:05.743

首先，您需要检查这些文件是否正常运行。它可以像输入“localhost/YourFolderName/Filename.asp”行一样运行（必须有一个文件夹）。该文件夹必须授予用户完全访问权限。

所以右键单击该文件夹。转到属性/安全选项卡/单击编辑。授予管理员或您登录的用户的完全访问权限。

# php - 处理 Fetching JSON files to decode 中的错误

> ID：12675213
> 
> 赞同：0
> 
> 时间：2012-10-01T14:26:47.163
> 
> 标签：php, json, httprequest

我目前有 PHP5.2。我最终想使用[`json_decode`](http://us3.php.net/manual/en/function.json-decode.php), 来解析通过 HTTP 请求获得的 JSON 文件的内容。

`json_decode`要求 JSON 在字符串中并作为参数传递，所以我通过[`file_get_contents`](http://us3.php.net/manual/en/function.file-get-contents.php).

把它想象成：

`$JSON = file_get_contents($URL);`

where`$JSON`是文件内容的存储字符串，`$URL`是通过 HTTP 请求获取文件的目标 URL。关于`file_get_contents`PHP手册状态：

> 该函数返回读取的数据或失败时返回 FALSE。

就失败而言，我假设这`FALSE`会在超时（无法到达服务器`$URL`）、a `404`（到达服务器，但文件不存在于`$URL`）、a `503`（到达服务器，但太忙而无法正确响应）时返回，或`500`（内部服务器错误，通常不应该发生）。

无论如何，在上面我最关心的错误中，我`503`遇到的服务器偶尔会在 HTTP 请求上抛出这个错误。发生这种情况时，我想再试一次。

所以我想出了这个：

```
$JSON = null; //Initially set to null as we have not fetched it

for($attempt = 0; $attempt < 3; $attempt++) //Try 3 times to fetch it
    if($JSON = file_get_contents($URL)) break; //If we fetch it, stop trying to

//Kill the script if we couldn't fetch it within 3 tries
if($JSON == null) die("Could not get JSON file"); 
```

这种工作，但我不认为它很可靠。我正在阅读有关上下文的更多信息，但我没有完全了解如何在 PHP 中使用它们。有什么方法可以更好地处理这类事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:41:14.317

PHP 创建一个在调用 URL[`$http_response_header`](http://www.php.net/manual/en/reserved.variables.httpresponseheader.php)后`file_get_contents()`调用的变量，您应该可以使用它来满足您的需求。

```
function read_json_data($url, $attempts = 0) {

    $json = file_get_contents($url);

    if (!$json && isset($http_response_header) && strstr($http_response_header[0], '503') && $attempts++ <= 2) {

        return read_json_data($url, $attempts);

    }

    if (!$json) {

        throw new Exception("Maximum attempts or not a 503 status code.");

    }

    return json_decode($json);

} 
```

用法：

```
$json = read_json_data($url); 
```

击中 503 时最多可运行 3 次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:03:39.557

我想说一个更好的方法是在重试之前实际考虑 HTTP 状态代码。

`503`重试仅在您得到 a但不是 - 例如 - a 的特定情况下才有意义`404`。

* * *

与现有答案类似，我还要说这`$http_response_header`是获取状态代码的好地方，从中可以很容易地捕获。

您还可以创建上下文以指定其他选项，`file_get_contents`例如，您也可以返回与`false`不同状态代码不同的返回值（例如 404）。

```
$context = stream_context_create(['http' => ['ignore_errors' => 1]]);

$data = file_get_contents($url, null, $context);

$code = null;

$http_response_header 
    && sscanf($http_response_header[0], 'HTTP/%*d.%*d %d', $code)
; 
```

除了您可能想要检查返回的 mime 类型的状态代码之外，您还可以从响应标头中获取它，解析完整数组的函数已在[相关的 question/answer](https://stackoverflow.com/a/7566440/367456)中进行了概述。

# visual-studio-2010 - 在 Visual Studio 2010 Express 中为网站创建设置

> ID：12675214
> 
> 赞同：0
> 
> 时间：2012-10-01T14:26:47.640
> 
> 标签：visual-studio-2010, web, installation

我在 Visual Studio 2010 Express 中创建了一个网站。
现在我想为它创建一个安装文件（.exe 或 .msi），以便它可以安装在本地 IIS 服务器上。我不打算在网上发布这个网站，即在互联网上。我只想在连接到局域网的本地机器上使用它。
这是我的第一个网站，我不知道在 Visual Studio 中创建设置过程。

```
 if( Can I able to create a setup file of a website? )
 { 
    How?  
 }  
 else  
 {
    if(Should I have to convert it into a web application?  )
    {
        What are the steps to create setup of web application so as 
        to run it on local computers? 
    }  
 } 
```

抱歉表示不好，但我不知道如何用语言表达我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:57:35.987

几个月前我这样做了，我发现这篇文章非常有用：[Programmatically create a web site in IIS using C# and set port number](https://stackoverflow.com/questions/1286831/programatically-create-a-web-site-in-iis-using-c-sharp-and-set-port-number)。它将向您展示如何使用 C# 代码创建 IIS 7 记录。

您可以使用此信息创建 .exe 的一种方法是创建一个单独的应用程序，该应用程序将创建 IIS 7 记录并将文件从您的网站目录源复制到您的新位置。

您还在问题中提到了一个 Web 应用程序 - 部署这种类型的网站非常容易，您可以在此处找到此方法的[部署说明。](http://msdn.microsoft.com/en-us/library/dd483479%28v=vs.100%29.aspx)

我觉得这可以通过几种不同的方式来完成，您可能会发现您需要使用一些 google 技能来找到最合适的方式。

# c# - 插入未排序的 SQL 表字段

> ID：12675218
> 
> 赞同：-3
> 
> 时间：2012-10-01T14:27:02.403
> 
> 标签：c#, sql, insert

我有这个 SQL 表：

> 员工（ID、姓名、地址、电话）

我想在不遵守指示顺序的情况下执行 SQL 查询，如下所示：

```
Insert Into Employee (Tel, name, Id, Address) 
Values (555621, "Jihen", 10236, "21 Cranberry street") 
```

我可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:28:09.943

是的，这是允许的。`INSERT`与表中的列顺序相比，查询中的顺序并不重要。

但是，您**必须**确保查询中列名的顺序与查询中提供的值的顺序相匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:28:13.963

是的-只要您在语句的两个部分中明确指定顺序（如您所示）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:28:12.757

是的，你可以......你试过了吗？

# jquery - 避免 jquery ajax 删除 #

> ID：12675219
> 
> 赞同：0
> 
> 时间：2012-10-01T14:27:04.133
> 
> 标签：jquery, ajax, url

jquery ajax 函数删除 URL 中的锚点。东西.html#anchor

如果我们将 # 作为脚本的参数怎么办？

我可以阻止 jquery 删除锚点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T14:28:17.763

你不能，因为锚不是请求的一部分。锚点在客户端（由浏览器）解释。如果要发送锚点，则必须将其保存到数据结构中，然后以这种方式发送到服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:28:42.777

不，因为后面的部分`#`（称为片段）永远不会发送到 Web 服务器；它不是 HTTP 请求的一部分。它只能从客户端脚本访问。

使用 jQuery、AJAX 或者只是将 URL 粘贴到浏览器的导航栏中并点击`ENTER`;都没关系。这种行为在所有情况下都是相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:30:38.577

你不能留着`#`。您可以将其连接起来：

```
data.url + "#" + data.anchor 
```

...或类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T14:28:31.817

哈希标签在技术上不是 url 的一部分，因为它表示页面上的锚点并且不会发送到网络服务器。如果您需要将其作为随 AJAX 请求发送的表单数据的一部分传递给服务器，您可以使用`location.hash`

```
var urlWithHash = location.href + location.hash; 
```

# jquery - getJSON 请求返回未定义

> ID：12675221
> 
> 赞同：2
> 
> 时间：2012-10-01T14:27:05.053
> 
> 标签：jquery, json, asynchronous

我昨天发布了一个主题，其中一个家伙发表了评论：[如何将 $_GET 路径与 file_exists 一起使用并保持安全？](https://stackoverflow.com/questions/12655685/how-to-use-get-path-with-file-exists-and-keep-it-safe#comment17072634_12655685)说明由于 JSON 是异步的，我会返回“未定义”。他是对的，我一直试图弄清楚为什么，但我觉得完全超出了我的理解范围。我想知道是否有人可以解释正在发生的事情，以便我可以弄清楚如何使用 Deferreds 来解决这个问题，或者是否有其他解决方案。

任何帮助表示赞赏，干杯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:33:42.497

执行`$.getJSON()`函数时，会在该函数结束之前继续执行，因为该函数是异步的。

考虑这段代码：

```
$.getJSON("/ajax/fileExists.php",{ path: path }, function (data){
    alert("THERE");
});
alert("HEY"); 
```

这将首先提醒“嘿”，然后是“那里”。发生这种情况是因为一旦 Javascript 到达`$.getJSON()`，它就会开始执行该请求，但在继续执行其余代码之前不会等待它完成执行。

所以它继续并执行`alert("HEY");`。然后，稍后，当您的`$.getJSON`请求完成时，您的回调函数将执行并执行`alert("THERE");`。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:31:41.103

你的代码是

```
function fileExists(path){
    $.getJSON("/ajax/fileExists.php",{ path: path },
    function (data){
        return data.path;
    });
} 
```

这里的问题是内部函数是一个回调，`return`内部会在Ajax请求之后执行。这时候外层函数`fileExists`已经完成了。它只是开始请求，而不是等待它结束。

要解决此问题，您可以进行回调

```
function fileExists(path, callback){
    $.getJSON("/ajax/fileExists.php",{ path: path },
    function (data){
        callback(data.path);
    });
} 
```

像这样使用它

```
fileExists('/a/path', function(path){ console.log(path) } ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:32:05.860

AJAX 像您所说的那样异步工作：浏览器不会“锁定”并等到它完成直到移动到下一行（就像您的任何其他正常代码一样）。

基本上通过拥有一个 AJAX 函数，然后简单地`if() else()`等待测试它的结果，它们总是会返回 undefined ，因为它们会立即启动。他们不会等到 AJAX 实际完成。

因此，为什么在这种情况下需要使用回调函数/延迟对象！（因为您正在尝试使用从 AJAX 返回的结果）

# java - Comet 在每个请求中都有新的处理程序

> ID：12675230
> 
> 赞同：0
> 
> 时间：2012-10-01T14:27:53.980
> 
> 标签：java, comet, long-polling

我开始尝试 Comet 在服务器端使用 JMS 创建通知系统。
我需要一个 Web 服务向通知 CometHandler 的 servlet 发送异步消息。

我开始使用 Glassfish 的计数器示例（http://docs.oracle.com/cd/E18930_01/html/821-2418/ggrgt.html#ggrgr），但它似乎创建了很多处理程序。

问题（我认为）是彗星处理程序是在每个请求中创建的

```
protected void doGet(HttpServletRequest req, HttpServletResponse res)
            throws ServletException, IOException {

    CounterHandler handler = new CounterHandler();
    handler.attach(res); //here the response of this request is attached to handler

    CometEngine engine = CometEngine.getEngine();
    CometContext context = engine.getCometContext(contextPath);

    context.addCometHandler(handler);
} 
```

然后在 CometHandler onEvent 中，处理程序将响应发送给客户端，然后自行恢复

```
public void onEvent(CometEvent event) throws IOException {
    if (CometEvent.NOTIFY == event.getType()) {
        response.getWriter().write("something") //response is the attached one
        // commented out the resume if it is Http Streaming
        event.getCometContext().resumeCometHandler(this);
    }
} 
```

在 HTML 页面中，我使用 JQuery 来做一个这样的 longPoll

```
function poll() {
    var url = pollUrl;
    $.getJSON(
        url,
        function(data) {
            updateAnswer(data);//do things with data
            poll();
        }
    );
} 
```

因此，每个 getJSON，都会创建一个新的 CometHandler，而之前的一个会被“遗忘”。
问题是：有更好的方法来做到这一点吗？
如果我使用的下一个是另一个不同的，为什么我需要恢复处理程序？
谢谢你的帮助！

-- 编辑 --

我尝试将 cometHandler 放在 HttpSession 属性中，但问题仍然存在，因为我需要使用 addCometHandler(handler) 因为正如 javadoc 所说：

```
Add a CometHandler which will starts the process of suspending the underlying response.     
The underlying HttpServletResponse will not get committed until   
CometContext.resumeCometHandler(CometHandler) is invoked, unless the 
CometContext.setExpirationDelay(long) expires. 
```

我使用 resumeCometHandler(this) 看到了另一件事

```
Resume the Comet request and remove it from the active CometHandler list. Once resumed,    
a CometHandler must never manipulate the HttpServletRequest or HttpServletResponse as 
those object will be recycled and may be re-used to serve another request. If you cache  
them for later reuse by another thread there is a possibility to introduce corrupted  
responses next time a request is made. 
```

所以我不知道是否有办法不为每个请求创建一个新的 CometHandler。我放置了一个计数器并在 onInitialize 处理程序方法中增加它，我在 onTerminate 处理程序方法中减少它，它在每个请求中增加。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T12:01:30.257

最后似乎没有问题。
虽然每个请求都会创建一个处理程序，但它会从列表中删除，并在调用垃圾收集器时被清除。
为了尝试它，我强制执行 gc，并且每个不在挂起列表中的 CometHandler 都已完成。
我尝试强制执行大量新请求，并在实例化大量彗星处理程序时调用垃圾收集器，因此我仍然不太喜欢这种方法。
欢迎每一个新想法。
问候

# jquery - 自动将链接标题附加到 div 标签内

> ID：12675243
> 
> 赞同：3
> 
> 时间：2012-10-01T14:28:16.740
> 
> 标签：jquery, tooltip

我想使用 jquery 创建一个 css 工具提示。我的html代码是

```
<a class="tooltip" href="#" title="My ttitle">Link1</a> 
```

它应该像悬停一样

```
<a class="tooltip" href="#" title="My ttitle"><div class="classic">My title</div>Link1</a> 
```

如何使用 jQuery 执行此操作？

```
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">
$(document).ready(function(){
    //prepend span tag
    var title = $("this").attr("title");
    $(".tooltip").prepend("<div class='classic'>".$(this).attr("title")."</div>");  

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:32:50.950

在用于连接字符串的 JavaScript 中，您应该使用;`+`而不是`.`

```
$(".tooltip").prepend("<div class='classic'>" + $(this).attr("title") + "</div>"); 
```

另请注意，您不应该`this`用引号将对象包装起来，并且`this`在您的代码中引用`document`对象而不是您的 span 元素。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-02T07:31:10.710

我的最终工作输出是

```
<html>
        <title>ToolTips Example</title>
        <style type="text/css">
        .tooltip {
            border-bottom: 1px dotted #000000; color: #000000; outline: none;
            text-decoration: none;
            position: relative;
        }
        .tooltip div {
            margin-left: -999em;
            position: absolute;
        }
        .tooltip:hover div {
            border-radius: 5px 5px; -moz-border-radius: 5px; -webkit-border-radius: 5px; 
            box-shadow: 5px 5px 5px rgba(0, 0, 0, 0.1); -webkit-box-shadow: 5px 5px rgba(0, 0, 0, 0.1); -moz-box-shadow: 5px 5px rgba(0, 0, 0, 0.1);
            font-family: Calibri, Tahoma, Geneva, sans-serif;
            position: absolute; left: 1em; top: 2em; z-index: 99;
            margin-left: 0; width: 250px;
        }
        .tooltip:hover img {
            border: 0; margin: -10px 0 0 -55px;
            float: left; position: absolute;
        }
        .tooltip:hover em {
            font-family: Candara, Tahoma, Geneva, sans-serif; font-size: 1.2em; font-weight: bold;
            display: block; padding: 0.2em 0 0.6em 0;
        }
        .classic { padding: 0.8em 1em; }
        .custom { padding: 0.5em 0.8em 0.8em 2em; }
        * html a:hover { background: transparent; }
        .classic {background: #FFFFAA; border: 1px solid #FFAD33; }
        .critical { background: #FFCCAA; border: 1px solid #FF3334; }
        .help { background: #9FDAEE; border: 1px solid #2BB0D7; }
        .info { background: #9FDAEE; border: 1px solid #2BB0D7; }
        .warning { background: #FFFFAA; border: 1px solid #FFAD33; }
        </style>

<!-- jQuery -->
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">
 $(document).ready(function(){
        $(".tooltip").each(function(){
            $(this).prepend("<div class='classic'>" + $(this).attr("title") + "</div>");
        });
    });
</script>        
</head>

<body>
<a class="tooltip" href="#" title="Hello">Classic</a>
<br />
<a class="tooltip" href="#" title="Second Example">Second Example</a>
</body></html> 
```

# directory - 使用 7z @listfile 功能在不同文件夹中压缩同名文件

> ID：12675246
> 
> 赞同：14
> 
> 时间：2012-10-01T14:28:26.733
> 
> 标签：directory, compression, duplicates, 7zip

我想使用 7zip 的 @listfile 功能创建一个包含名称相同但位于不同文件夹中的文件的 7zip 文件。尽管我已经使用 7zip CLI 很长时间了，但我只是找不到完成此操作的语法。

我的文件树看起来像这样（注意 somefile1.html 和 somefile2.html 各出现两次）。

```
|   somefile2.html
+---dir1
|       somefile1.html
|       somefile2.html
|       
+---dir2
|       somefile3.html
|       somefile4.html
|       
\---dir3
        somefile1.html
        somefile5.html 
```

使用@listfile 工作正常，但我不知道如何在生成的 7zip 中保留目录树。

我尝试了以下语法：

7z a -ir@files.txt my_compressed_file.7z

然后，鉴于 7zip 的 Windows CHM 帮助文件中的语法解释，我也尝试包含根文件夹（称为“文件”）：

7z a -ir@files.txt my_compressed_file.7z .\files

在这两种情况下我都会遇到相同的错误：

```
Error
Duplicate filename:
somefile1.html
somefile2.html 
```

有没有人想出这个并愿意解释一下？

我知道如何在不同的文件夹中压缩具有相同名称的文件，否则（当文件夹结构保留在 7zip 中时，没问题）。但是这一次我需要的几个文件遍布各处......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-06T00:59:41.330

我在使用列表文件时遇到了同样的错误（文件名重复）。我的列表文件如下所示：

```
D:\SomeDir\SomeFile.txt
D:\SomeOtherDir\SomeFile.txt 
```

我通过从 D:\ 启动 7-zip 并编辑我的列表文件以使用相对路径而不是绝对路径来解决问题：

```
SomeDir\SomeFile.txt
SomeOtherDir\SomeFile.txt 
```

生成的存档保留了原始目录结构，看起来完全符合我的预期。

注意：我使用的是 7-Zip 4.65，如果文件位于不同的驱动器或具有不同的根目录，则此解决方案将不起作用。

我运行的 PowerShell 命令行是：

```
& 'C:\Program Files\7-Zip\7z.exe' a -scsWIN logs.7z `@recentlogs.txt 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-01-10T06:33:33.000

以下用于 windows 的命令，使用 shell 和 7za（7zip 的命令行版本）可能适用于其他平台；但这为我解决了问题：

1) 使用如下命令列出您要归档的所有文件，包括完整路径；假设您的命令提示符位于 C:\ 目录中，并且您想要列出 C: 驱动器上所有子目录中的所有 *.xmp 文件，以便在下一步中归档：

```
DIR /B /S *.xmp > XMPsToArchiveList.txt 
```

2) 使用 XMPsToArchiveList.txt 作为 7za 的列表文件，带有 -spf 开关，指示 7za “使用完全限定的文件路径：”

```
7za a -spf -ir@XMPsToArchiveList.txt allCdriveXMPs.7z 
```

如果一切顺利，您应该会收到令人愉快的消息：“一切正常”，并会看到一个名为 .7z 的新存档。

在我的测试中，生成的 .7z 存档包含反映所有 .xmp 文件的完整路径的文件夹和子文件夹，根文件夹的标题为“C:”。

笔记：

A）在 Windows 上，要调整 list 命令以包含给定名称的这么多目录中的所有内容（在这么多不同的地方），您可以使用例如：

```
DIR /S /B *_aCertainFolderNameDuplicatedAllOverTheDrive* > foldersToArchive.txt 
```

B) 2011-09-16 添加了 -spf 开关；回复：[http ://www.7-zip.org/history.txt](http://www.7-zip.org/history.txt)

此外，我尝试使用通配符来生成您所描述的列表，但没有任何运气将所有名为 somefile*.txt 的文件放入列表中（例如archiveTheseFiles.txt）。也许我打错了？看起来很简单。您需要在提示符下四处寻找适合您的方法。

最后，我不知道 -spf 开关是否可用于 7z（相对于 7za）。7za 可在那边，在“附加”下载：[http ://www.7-zip.org/download.html](http://www.7-zip.org/download.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-09T14:22:13.833

我真正的目录结构是：

```
+---Release
|   |   Lib.dll
|   \--- x64
|           Lib.dll
|       
+---Definition_files
|       data_files
|       
+---x64
|       Lib.dll // Copy of the previous file (only to preserve "x64" directory")
\---Documentation
        documentation_files.... 
```

我使用了列表文件：

```
 .\Release\Lib.dll // used ".\" to remove "Release" directory
 Definition_files\data_files
 Documentation\documentation_files
 x64\Lib.dll 
```

命令行：

```
7z.exe a -mx=9 -mpass=5 -r .\Packgakes\release.zip .@Lib.lst 
```

这导致了重复性错误。没有“-r”就没有错误。

如果确实没有两个文件具有相同的目标路径*（在文件路径中使用“.”删除输出中的路径），*请尝试检查命令行以进行递归扫描和文件列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-20T23:31:46.200

由于 7z 有问题，如果您坚持使用 7z 压缩，请尝试先使用 tar 创建一个 .tar 压缩包，然后再创建一个 .tar.7z 压缩包。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-04T16:50:36.550

从 7-zip 9.38 beta 开始，您可以选择路径模式：相对、完整、绝对。

# android - 视图没有删除

> ID：12675254
> 
> 赞同：0
> 
> 时间：2012-10-01T14:28:42.870
> 
> 标签：android, android-layout

我已经问过问题（http://stackoverflow.com/questions/12663443/add-delete-option-with-dynamically-generated-edittext）。我成功地实现了答案，但是这段代码的问题是 textEdit、微调器和删除按钮一起没有从视图中删除。它发生了，但我必须单击三个按钮才能发生这种情况.. 请通过我的代码。

```
 btnAddNew.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

            LinearLayout rAlign = (LinearLayout)findViewById(R.id.lId);
            final EditText newPass = new EditText(getApplicationContext());
            allEds.add(newPass);
            newPass.setHint("Name of Label");
            newPass.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
            //newPass.setWidth(318);
            newPass.setTextColor(Color.parseColor("#333333"));
            newPass.setId(MY_BUTTON);
             System.out.println(MY_BUTTON);  
            //newPass.setOnClickListener(this);
            rAlign.addView(newPass);

            addSpinner();//Code to add spinner              
            Button btnRemoveOld = new Button(getApplicationContext());
            btnRemoveOld.setId(MY_BUTTON); // arbitrary number
            rAlign.addView(btnRemoveOld);
            btnRemoveOld.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    int idf =MY_BUTTON -1;
                    LinearLayout rAlign = (LinearLayout)findViewById(R.id.lId);
                    rAlign.removeView(findViewById(idf));
                  allEds.remove(newPass);

                }
            }); 
           MY_BUTTON ++;
        } 
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:52:22.003

如果您使用 MY_BUTTON 为每个 View 分配一个 ID

```
newPass.setId(MY_BUTTON); 
MY_BUTTON++;
spinner.setId(MY_BUTTON);
MY_BUTTON++;
btnRemoveOld.setId(MY_BUTTON);
MY_BUTTON++; 
```

您可以在 btnRemoveOld 的 onClickListner 中执行此操作以删除所有三个对象

```
btnRemoveOld.setOnClickListener(new OnClickListener() {
              public void onClick(View v) {
                  //gets the ID of the btnRemoveOld;
                  int idf =v.getId();
                  LinearLayout rAlign = (LinearLayout)findViewById(R.id.lId);
                  //will return the newPass button
                  rAlign.removeView(findViewById(idf-2));
                  //will return the spinner
                  rAlign.removeView(findViewById(idf-1));
                  //will remove the btnRemoveOld
                  rAlign.removeView(v);
                    }
          }); 
```

通过执行 v.getId()，您将获得 btnRemoveOld 的 id 值，并且您可以从代码中确保微调器是 id-1 并且 newPass 按钮是 id-2。

# jquery - jQuery函数不停止执行

> ID：12675255
> 
> 赞同：0
> 
> 时间：2012-10-01T14:28:46.947
> 
> 标签：jquery, function, return

我正在尝试在将访问者信息添加到 mysql 数据库之前验证表单。jQuery 脚本如下：

```
var phone = $("input#phone").val();
    if (phone == "") {
  $("label#phone_error").show();
  $("input#phone").focus();
  return false;
}

//Captcha validation
var security_code = $("input#security_code").val();
$.ajaxSetup({cache: false})
$.get('getsession.php', {requested: 'seccode'}, function (data) {
var session = data;

if (security_code !== session) {
    $("label#security_code_error").show();
    $("input#security_code").focus();
    alert ('NO MATCH: '+security_code+' '+session);
    return false; // <= FUNCTION SHOULD EXIT HERE
} else {
    alert ('MATCH!!!: '+security_code+' '+session);
}
});     

    var dataString = 'name='+ name + '&email=' + email + '&phone=' + phone;
    //alert (dataString);return false;

    $.ajax({
  type: "POST",
  url: "bin/process.php",
  data: dataString,
  success: function() {
    $('#contact_form').html("<div id='message'></div>");
    $('#message').html("<h2>Contact Form Submitted!</h2>")
    .append("<p>We will be in touch soon.</p>")
    .hide()
    .fadeIn(1500, function() {
      $('#message').append("<img id='checkmark' src='images/check.png' />");
    });
  }
 });
return false;
});
}); 
```

如果缺少名称，则表单会显示错误并关注要完成的字段。问题是验证码验证。如果匹配，则成功处理表单并将潜在客户添加到数据库，但是，如果在文本字段中输入的安全代码与生成的代码不匹配，则会显示错误，但表单信息仍会添加到数据库. 看起来“return false; // <= FUNCTION SHOULD EXIT HERE”无法识别。关于我的代码有什么问题的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:41:16.887

试试这个

> var phone = $("input#phone").val(); if (phone == "") { $("label#phone_error").show(); $("input#phone").focus(); 返回假；}
> 
> ```
> //Captcha validation
> var security_code = $("input#security_code").val();
> $.ajaxSetup({cache: false})
> $.get('getsession.php', { requested: 'seccode' }, function(data) {
>     var session = data;
> 
>     if (security_code !== session) {
>         $("label#security_code_error").show();
>         $("input#security_code").focus();
>         alert('NO MATCH: ' + security_code + ' ' + session);
>     } else {
>         alert('MATCH!!!: ' + security_code + ' ' + session);
>         var dataString = 'name='+ name + '&email=' + email + '&phone=' + phone;
>         $.ajax({
>             type: "POST",
>             url: "bin/process.php",
>             data: dataString,
>             success: function() {
>                 $('#contact_form').html("<div id='message'></div>");
>                 $('#message').html("<h2>Contact Form Submitted!</h2>")
>                     .append("<p>We will be in touch soon.</p>")
>                     .hide()
>                     .fadeIn(1500, function() {
>                         $('#message').append("<img id='checkmark' src='images/check.png' />");
>                     });
>             }
>         });
>     }
> }); 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:34:19.400

`return false`您希望结束执行的是 AJAX 请求的回调函数。AJAX 中的第一个 A 代表异步，因此在请求返回成功响应之前不会执行该函数。

但是，由于它*是*异步的，因此发出 AJAX 请求的其余函数仍将执行，因此提交单独的 AJAX POST 请求以提交表单数据，与第一次 AJAX 调用完全无关。

您需要做的是将代码的以下部分移动到检查验证码的 AJAX 请求的回调函数中，并且只有在验证成功时才执行它。

```
var dataString = 'name=' + name + '&email=' + email + '&phone=' + phone;
//alert (dataString);return false;
$.ajax({
    type: "POST",
    url: "bin/process.php",
    data: dataString,
    success: function() {
        $('#contact_form').html("<div id='message'></div>");
        $('#message').html("<h2>Contact Form Submitted!</h2>").append("<p>We will be in touch soon.</p>").hide().fadeIn(1500, function() {
            $('#message').append("<img id='checkmark' src='images/check.png' />");
        });
    }
}); 
```

整个代码如下所示：

```
var phone = $("input#phone").val();
if (phone == "") {
    $("label#phone_error").show();
    $("input#phone").focus();
    return false;
}

//Captcha validation
var security_code = $("input#security_code").val();
$.ajaxSetup({
    cache: false
})
$.get('getsession.php', {
    requested: 'seccode'
}, function(data) {
    var session = data;

    if (security_code !== session) {
        $("label#security_code_error").show();
        $("input#security_code").focus();
        alert('NO MATCH: ' + security_code + ' ' + session);
        return false; // <= FUNCTION SHOULD EXIT HERE
    } else {
        alert('MATCH!!!: ' + security_code + ' ' + session);
        // successful, so let's submit the details
        var dataString = 'name=' + name + '&email=' + email + '&phone=' + phone;
        $.ajax({
            type: "POST",
            url: "bin/process.php",
            data: dataString,
            success: function() {
                $('#contact_form').html("<div id='message'></div>");
                $('#message').html("<h2>Contact Form Submitted!</h2>").append("<p>We will be in touch soon.</p>").hide().fadeIn(1500, function() {
                    $('#message').append("<img id='checkmark' src='images/check.png' />");
                });
            }
        });
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:35:54.223

您不能`return`在函数外部使用。

# ajax - 为什么我的 grails 复选框 onclick 远程函数 ajax 调用显示更新错误？

> ID：12675261
> 
> 赞同：0
> 
> 时间：2012-10-01T14:29:00.770
> 
> 标签：ajax, grails, html, checkbox, updatepanel

嗨，我有一个名为 taskReminder 的页面，它呈现两个模板：1 个用于任务，1 个用于提醒。该任务有复选框，当勾选时，它应该重新填充/更新任务列表。一切正常，但我似乎无法理解为什么任务框架会更新并在其中显示整个页面。总结：整个页面有一个任务框架，其中还显示了整个页面。（就像 inception 一样！）我重新设计了 html，重新评估了我的远程功能，我还尝试在提醒框架内放置一个差异复选框 - 当勾选，它会更新任务框架内的提醒列表，其中包含整个页面，而不是他自己的框架列表。

首次加载时，未单击复选框 - 显示正常 ![在第一次加载](../Images/ea606e4988acb4b68bf982f715554d36.png)

当复选框被勾选并且任务框架向下滚动时，请注意提醒框架也在那里或整个页面

![](../Images/a2459ba06224843b969fd70d5abbd794.png)

为什么会这样？我的代码：对于任务提醒持有人

```
 <%@ page import="com.irondata.icmgrails.constants.*" %>

<html>
  <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="layout" content="main" />
        <style type="text/css">
            body {background-color:#EEF2F7;}
        </style>
        <script type="text/javascript" language="javascript" src="${resource(dir:'js',file:'icmutilities.js')}"></script>
    </head>
   <body role="main">
   <g:form>
        <g:hiddenField name="caseId" value="${cmCaseInstance?.id}" /> 

        <div class="body" role="article">
            <h1>Tasks and Reminders</h1>
            <br />
            <br />
            <div id="tasks">
                    <div class="summary">
                        <div class="summaryHeader">
                            <div class="summaryHeaderLeft">Tasks</div>
                            <div class="summaryHeaderCenter">&nbsp;</div>
                            <div class="summaryHeaderRight">&nbsp;</div>
                        </div>

                         <div class="gadgetShort">
                            <div>
                                <g:checkBox name='test' onclick="${remoteFunction(action:'workCategory', params:'\'completed=\'+ this.checked + \'&caseId=\' + caseId.value', update:[success:'divTasks', failure:'divTasks']) }" value="${false}"/>
                            </div>
                            <div id="divTasks">
                                <g:render template="taskList" model="['taskInstanceList': taskInstanceList, 'taskInstanceTotal': taskInstanceTotal, 'cmCaseInstance':cmCaseInstance]"/>
                            </div>   
                         </div>
                    </div>
            </div>
            <div id="reminders">
                    <div class="summary">
                        <div class="summaryHeader">
                            <div class="summaryHeaderLeft">Reminders</div>
                            <div class="summaryHeaderCenter">&nbsp;</div>
                            <div class="summaryHeaderRight">&nbsp;</div>
                        </div>

                         <div class="gadgetShort">
                            <div>
                                <span class="gadgetName">Reminder List</span><span class="gadgetNumber">${taskInstanceTotal}</span>
                            </div>
                            <div id="divReminders">
                                <g:render template="reminderList" model="['reminderList': reminders, 'reminderListTotal': reminderCount]"/>
                            </div>   
                         </div>
                    </div>
            </div>
        </div>
   </g:form>

   </body>
</html> 
```

任务列表和提醒列表完全一样，所以我没有放提醒列表的代码。

```
<span class="gadgetName">Task List</span><span class="gadgetNumber">${taskInstanceTotal}</span>

            <table cellspacing="0" cellpadding="0" id="tasksTableGrails" class="icmSortableTable" summary="Tasks" >
                <thead>
                    <tr>

                        <g:sortableColumn scope="col" property="activityDescrip" title="${message(code: 'taskByCase.description.label', default: 'Description')}" params="${flash}" />

                    </tr>
                </thead>                                              
                <g:each in="${taskInstanceList}" status="i" var="taskInstance">
                    <tr class="${(i % 2) == 0 ? '' : 'altRowColor'}">

                        <td>${fieldValue(bean: taskInstance, field: "activityTypeIdActivityType.activityDescrip")}</td>

                </g:each>          
            </table> 
```

这是我背后的代码：

```
def workCategory = {

        def isCompletedTaskIncluded

        flash.employeeId = params.employeeId
        flash.caseId = params.caseId

        def cmCaseInstance = CmCase.get(params.caseId as Long)
        def employee = employeeService.getUserEmployee(session.currentUser.id)

        def criteria = Task.createCriteria()
        def query = {

            eq ("cmCaseIdCmCase", cmCaseInstance)
            or {
                eq ("fromEmplIdEmployee", Employee.get(employee.id))
                eq ("toEmplIdEmployee", Employee.get(employee.id))
            }
            if(params.completed=="false")
                isNull("actCompDate")

        }

        def taskInstanceList = criteria.list(query)

        def reminders = Reminder.createCriteria().list() {
            createAlias("cmCaseIdCmCase", "cmCase")
            isNull("cmCase.closedDate")
            eq('employeeIdEmployee', employee)
            eq("cmCaseIdCmCase", cmCaseInstance)

        }

        def taskCount = taskInstanceList.size()
        def reminderCount = reminders.size()
        render(view: "taskReminder", model: [taskInstanceList: taskInstanceList, taskInstanceTotal:  taskCount, reminderList: reminders, reminderListTotal: reminderCount, cmCaseInstance:cmCaseInstance])

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T17:37:25.890

编辑您的控制器：

```
render(view: "taskReminder", model: [taskInstanceList: taskInstanceList, taskInstanceTotal:  taskCount, reminderList: reminders, reminderListTotal: reminderCount, cmCaseInstance:cmCaseInstance]) 
```

to（修复模板路径和任务模板的名称）：

```
if(request.xhr){
   render(template: '/***templatePath***/task.gsp', model: [taskInstanceList: taskInstanceList, taskInstanceTotal:  taskCount, reminderList: reminders, reminderListTotal: reminderCount, cmCaseInstance:cmCaseInstance])
   return
}

render(view: "taskReminder", model: [taskInstanceList: taskInstanceList, taskInstanceTotal:  taskCount, reminderList: reminders, reminderListTotal: reminderCount, cmCaseInstance:cmCaseInstance]) 
```

# sql - 为什么锁定在Testdatabase而不是在Devdatabase

> ID：12675266
> 
> 赞同：2
> 
> 时间：2012-10-01T14:29:19.153
> 
> 标签：sql, sql-server-2008, locking

我刚刚设置了我们用于开发的数据库的测试克隆。但是，当我针对这个新数据库运行我们的应用程序时，它会创建一个锁并最终超时等待永远。

造成我的问题的 SQL：

```
-- In one connection it runs this
set transaction isolation level read committed
begin tran
INSERT INTO [Test].[dbo].[Status] ([TransactionID], [Status]) VALUES (6122481, 1) 
```

然后在提交该事务之前，另一个连接尝试运行：

```
set transaction isolation level read committed
begin tran
SELECT * FROM [Test].[dbo].[Status] with(rowlock) WHERE [Test].[dbo].[Status].[TransactionID] = 6122482 
```

但是，第二个事务永远不会运行，因为它会永远等待第一个事务完成，直到应用程序超时。

1.  SQL Server 2008
2.  我对实际的 SQL 没有太多控制，我们使用 LLBLGen (ORM)
3.  它在我们的开发和生产数据库上运行良好。
4.  测试数据库是通过恢复 dev 数据库的新备份创建的
5.  我认为主要区别在于表中的行数（测试中<100，而开发者> 100000）

我的猜测是，当表中有很多行时，SQL 服务器会做不同的事情。问题是如果这是问题所在，如何在不向其中添加大量数据的情况下修复测试数据库，或者我应该怎么做？

该表有一些索引，还有一个关于 TransactionID 的事务表的 FK：

```
CREATE NONCLUSTERED INDEX [idx1] ON [dbo].[Status] 
(   [TransactionID] ASC,
    [Status] ASC
) INCLUDE ( [Created]) 

CREATE NONCLUSTERED INDEX [idx2] ON [dbo].[Status] 
(   [Status] ASC,
    [Created] ASC
) INCLUDE ( [TransactionID]) 

ALTER TABLE [dbo].[Status] ADD  CONSTRAINT [PK_Statuses] PRIMARY KEY CLUSTERED 
(   [StatusID] ASC
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T12:00:44.030

我在表中做了 1000 次插入（与问题中的插入相同），问题就消失了。不是一个完美的解决方案，但显然可以解决问题。

# spring - MyBatis 3 + Spring 3：选择返回空值

> ID：12675270
> 
> 赞同：1
> 
> 时间：2012-10-01T14:29:28.910
> 
> 标签：spring, mybatis

我基于 MyBatis 示例构建了一个项目（我还检查了[JPetStore 6 应用程序](http://www.mybatis.org/spring/sample.html)）。

问题是我的 getTrains() 方法总是返回空对象。这是源文件和配置文件：

TrainMapper.java

```
package org.example.mybatis.spring.persistence;

import java.util.List;
import org.example.mybatis.spring.domain.Train;

public interface TrainMapper {

    Train getTrain(int id);
    List<Train> getTrains();
    void insertTrain(Train train);
} 
```

火车服务.java

```
package org.example.mybatis.spring.service;

import java.util.List;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.example.mybatis.spring.domain.Train;
import org.example.mybatis.spring.persistence.TrainMapper;

@Service("trainService")

public class TrainService {

@Autowired
private TrainMapper trainMapper;

public void setTrainMapper(TrainMapper trainMapper) {
    this.trainMapper = trainMapper;
}

public Train getTrain(int id) {
    return this.trainMapper.getTrain(id);
}

public List<Train> getTrains() {
    return this.trainMapper.getTrains();
}

@Transactional
public void insertTrain(Train train) {
    this.trainMapper.insertTrain(train);
} 
```

}

火车映射器.xml

```
 <?xml version="1.0" encoding="UTF-8" ?>
    <!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

    <mapper namespace="org.example.mybatis.spring.persistence.TrainMapper">
      <cache />
      <select id="getTrain" resultType="Train" parameterType="int">
        SELECT
          train_type
        FROM trains
        WHERE trains.train_id = #{id}
      </select>
      <select id="getTrains" resultType="org.example.mybatis.spring.domain.Train" parameterType="int">
        SELECT
          train_type
        FROM trains
      </select>
      <insert id="insertTrain" parameterType="Train">
        INSERT INTO trains (train_type)
        VALUES (#{type})
      </insert>
    </mapper> 
```

应用程序上下文.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:jdbc="http://www.springframework.org/schema/jdbc"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="
         http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
         http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
         http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.1.xsd
         http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd">

  <context:property-placeholder location="classpath:mysql.jdbc.properties" />

  <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName" value="${jdbc.driverClassName}" />
    <property name="url" value="${jdbc.url}" />
    <property name="username" value="${jdbc.username}" />
    <property name="password" value="${jdbc.password}" />
  </bean>

  <bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
    <property name="dataSource" ref="dataSource" />
  </bean>

  <context:component-scan base-package="org.example.mybatis.spring" />

  <tx:annotation-driven />

  <bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="typeAliasesPackage" value="org.example.mybatis.spring.domain" />
    <!--property name="configLocation" value="classpath:mybatis-config.xml"/-->
    <!--property name="mapperLocations" value="classpath:org/example/mybatis/spring/persistence/*.xml" /-->
  </bean>

  <bean class="org.mybatis.spring.mapper.MapperScannerConfigurer">
    <property name="basePackage" value="org.example.mybatis.spring.persistence" />
  </bean>
</beans> 
```

Train.java 是一个简单的Java bean。

项目POM：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" 
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.example</groupId>
  <artifactId>mybatis-spring-example</artifactId>
  <name>MyBatis-Spring Example</name>
  <version>0.0.1-SNAPSHOT</version>
  <packaging>jar</packaging>
  <description>Example of the MyBatis-Spring integration (within a Maven project)</description>

  <properties>
    <maven.compiler.plugin.version>2.5.1</maven.compiler.plugin.version>
    <log4j.version>1.2.17</log4j.version>
    <junit.version>4.10</junit.version>
    <mysql.connector.version>5.1.20</mysql.connector.version>
    <spring.version>3.1.2.RELEASE</spring.version>
    <mybatis.version>3.1.1</mybatis.version>
    <mybatis.spring.version>1.1.1</mybatis.spring.version>
    <hsqldb.version>2.2.8</hsqldb.version>
    <dbcp.version>1.4</dbcp.version>
    <cglib.version>2.2.2</cglib.version>
    <nexus.ip>x.y.w.z</nexus.ip>
    <nexus.port>xxxx</nexus.port>
    <nexus.public.group.url>http://${nexus.ip}:${nexus.port}/nexus/content/groups/public</nexus.public.group.url>
    <nexus.releases.url>http://${nexus.ip}:${nexus.port}/nexus/content/repositories/releases</nexus.releases.url>
    <nexus.snapshots.url>http://${nexus.ip}:${nexus.port}/nexus/content/repositories/snapshots</nexus.snapshots.url>
  </properties>

  <repositories>
    <repository>
      <id>nexus-internal-repo</id>
      <name>Sonatype Nexus Internal Repository</name>
      <url>${nexus.public.group.url}</url>
      <releases>
        <enabled>true</enabled>
        <updatePolicy>never</updatePolicy>
        <checksumPolicy>fail</checksumPolicy>
      </releases>
      <snapshots>
        <enabled>true</enabled>
        <updatePolicy>never</updatePolicy>
        <checksumPolicy>warn</checksumPolicy>
      </snapshots>
    </repository>
  </repositories>

  <dependencies>
<dependency>
  <groupId>org.mybatis</groupId>
  <artifactId>mybatis</artifactId>
  <version>${mybatis.version}</version>
</dependency>

<dependency>
  <groupId>org.mybatis</groupId>
  <artifactId>mybatis-spring</artifactId>
  <version>${mybatis.spring.version}</version>
</dependency>

<dependency>
  <groupId>log4j</groupId>
  <artifactId>log4j</artifactId>
  <version>${log4j.version}</version>
</dependency>

<dependency>
  <groupId>mysql</groupId>
  <artifactId>mysql-connector-java</artifactId>
  <version>${mysql.connector.version}</version>
</dependency>

<dependency>
  <groupId>commons-dbcp</groupId>
  <artifactId>commons-dbcp</artifactId>
  <version>${dbcp.version}</version>
</dependency>

<dependency>
  <groupId>cglib</groupId>
  <artifactId>cglib</artifactId>
  <version>${cglib.version}</version>
</dependency> 
```

我作为独立运行应用程序：

```
package org.example.mybatis.spring;

import java.util.List;
import org.example.mybatis.spring.domain.Train;
import org.example.mybatis.spring.service.TrainService;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

    public class SelectTrainExample {

        public static void main(String[] args) {
            ApplicationContext context = new ClassPathXmlApplicationContext(
                    "applicationContext.xml");
            TrainService trainBean = (TrainService) context.getBean("trainService");

            List<Train> trains = trainBean.getTrains();
            System.out.println(trains.toString());

            Train train = trainBean.getTrain(1);
            System.out.println(train.toString());

            Train t = new Train();
            t.setType("Interregionale");
            trainBean.insertTrain(t);
        }
    } 
```

数据库中的插入工作正常，而我无法从“火车”表中检索数据。这是日志输出：

> 2012-10-01 15:25:03,400 调试 [org.mybatis.spring.SqlSessionUtils] - 2012-10-01 15:25:03,413 调试 [org.mybatis.spring.SqlSessionUtils] - 2012-10-01 15:25 :03,463 调试 [org.apache.ibatis.cache.decorators.LoggingCache] - 2012-10-01 15:25:03,473 调试 [org.springframework.jdbc.datasource.DataSourceUtils] - 2012-10-01 15:25:03,474调试 [org.mybatis.spring.transaction.SpringManagedTransaction] - 2012-10-01 15:25:03,479 调试 [org.example.mybatis.spring.persistence.TrainMapper.getTrains] - 2012-10-01 15:25:03,497调试 [org.example.mybatis.spring.persistence.TrainMapper.getTrains] - <==> 准备：从火车中选择 train_type > 2012-10-01 15:25:03,578 调试 [org.example.mybatis.spring.persistence. TrainMapper.getTrains] - <==> 参数：> 2012-10-01 15:25:03,660 DEBUG [org.mybatis.spring.SqlSessionUtils] - 2012-10-01 15:25:03,661 调试 [org.springframework.jdbc.datasource.DataSourceUtils] - [null，null，null，null，null] 2012-10-01 15:25:03,664 调试 [org .springframework.beans.factory.support.DefaultListableBeanFactory] ​​- 2012-10-01 15:25:03,668 调试 [org.springframework.jdbc.datasource.DataSourceTransactionManager] - 2012-10-01 15:25:03,669 调试 [org.springframework .jdbc.datasource.DataSourceTransactionManager] - 2012-10-01 15:25:03,673 调试 [org.springframework.jdbc.datasource.DataSourceTransactionManager] - 2012-10-01 15:25:03,674 调试 [org.mybatis.spring.SqlSessionUtils ] - 2012-10-01 15:25:03,674 调试 [org.mybatis.spring.SqlSessionUtils] - 2012-10-01 15:25:03,679 调试 [org.mybatis.spring.transaction.SpringManagedTransaction] - 2012-10- 01 15:25:03,679 调试 [org.example.mybatis.spring.persistence.TrainMapper.insertTrain] - 2012-10-01 15:25:03,679 调试 [org.example.mybatis.spring.persistence.TrainMapper.insertTrain] - <==> 准备：插入火车（train_type）值 (?) > 2012-10-01 15:25:03,680 调试 [org.example.mybatis.spring.persistence.TrainMapper.insertTrain] - <==> 参数：Interregionale(String)> 2012-10-01 15： 25:03,681 调试 [org.mybatis.spring.SqlSessionUtils] - 2012-10-01 15:25:03,681 调试 [org.springframework.jdbc.datasource.DataSourceTransactionManager] - 2012-10-01 15:25:03,683 调试 [org .springframework.jdbc.datasource.DataSourceTransactionManager] - 2012-10-01 15:25:03,727 调试 [org.mybatis.spring.SqlSessionUtils] - 2012-10-01 15:25:03,727 调试 [org.mybatis.spring.SqlSessionUtils ] - 2012-10-01 15:25:03,728 调试 [org.springframework.jdbc.datasource.DataSourceTransactionManager] - 2012-10-01 15:25:03,728 调试 [org.springframework.jdbc.datasource.DataSourceUtils] -

请注意，我使用 JDBC 运行了相同的示例，并且运行良好。

库和环境：Spring 3.1.2 MyBatis 3.1.1 MyBatis-Spring 1.1.1 MySQL 5.5

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T09:54:22.893

你还没有发布你的“火车”java bean。但是在插入语句中，您使用#{type}，我认为您的 bean 属性名称是“id”和“type”。但在数据库表中，字段名称是“id”和“train_type”。Mybatis 不知道如何将表字段映射到 java bean 属性。在 Mapper.xml 中，您没有添加结果映射。有两种方法：

1.  在 mapper.xml 中添加 resultMap 元素，告诉 mybiatis 如何将数据库表字段名称映射到 java bean 属性名称。
2.  在选择语句中使用“as”这样

    选择 train_type 作为类型 FROM 火车

# c++ - 为什么将 std::endl 与 ostringstream 一起使用会影响输出速度？

> ID：12675273
> 
> 赞同：9
> 
> 时间：2012-10-01T14:29:39.813
> 
> 标签：c++, performance, flush, stringstream, ostream

我正在计时将文本打印到标准输出的各种方式之间的差异。我正在测试`cout`,`printf`和`ostringstream`同时使用`\n`and `std::endl`。我希望`std::endl`对. 我认为 using只会将 a 写入流，它仍然只会被刷新一次。这里发生了什么？这是我的所有代码：`cout``ostringstream``std::endl``\n`

```
// cout.cpp
#include <iostream>

using namespace std;

int main() {
  for (int i = 0; i < 10000000; i++) {
    cout << "Hello World!\n";
  }
  return 0;
}

// printf.cpp
#include <stdio.h>

int main() {
  for (int i = 0; i < 10000000; i++) {
    printf("Hello World!\n");
  }
  return 0;
}

// stream.cpp
#include <iostream>
#include <sstream>

using namespace std;

int main () {
  ostringstream ss;
  for (int i = 0; i < 10000000; i++) {
    ss << "stream" << endl;
  }
  cout << ss.str();
}

// streamn.cpp
#include <iostream>
#include <sstream>

using namespace std;

int main () {
  ostringstream ss;
  for (int i = 0; i < 10000000; i++) {
    ss << "stream\n";
  }
  cout << ss.str();
} 
```

这是我的 Makefile

```
SHELL:=/bin/bash

all: cout.cpp printf.cpp
    g++ cout.cpp -o cout.out
    g++ printf.cpp -o printf.out
    g++ stream.cpp -o stream.out
    g++ streamn.cpp -o streamn.out
time:
    time ./cout.out > output.txt
    time ./printf.out > output.txt
    time ./stream.out > output.txt
    time ./streamn.out > output.txt 
```

这是我跑步时得到`make`的结果`make time`

```
time ./cout.out > output.txt

real    0m1.771s
user    0m0.616s
sys 0m0.148s
time ./printf.out > output.txt

real    0m2.411s
user    0m0.392s
sys 0m0.172s
time ./stream.out > output.txt

real    0m2.048s
user    0m0.632s
sys 0m0.220s
time ./streamn.out > output.txt

real    0m1.742s
user    0m0.404s
sys 0m0.200s 
```

这些结果是一致的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-01T14:31:35.120

`std::endl`触发流的刷新，这会大大减慢打印速度。请参阅[http://en.cppreference.com/w/cpp/io/manip/endl](http://en.cppreference.com/w/cpp/io/manip/endl)

通常建议不要使用`std::endl`，除非您真的想要刷新流。如果这对您真的很重要，取决于您的用例。

关于为什么`flush`即使对 ostringstream （不应该发生刷新）也有性能影响：似乎至少需要一个实现来构造哨兵对象。那些需要检查`good`和`tie`的`ostream`。调用`pubsync`应该能够被优化出来。这是基于我对 libcpp 和 libstdc++ 的阅读。

在阅读更多内容之后，有趣的问题似乎是这样的：`basic_ostringstream::flush`构造哨兵对象真的需要实现吗？如果不是，这对我来说似乎是一个“实施质量”问题。但我实际上认为它需要，因为即使是一个`basic_stringbug`可以改变它的`badbit`集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T17:27:40.717

流上的每个输出操作都有多个步骤：

*   它检查流是否处于良好状态。
*   它检查是否需要刷新其他一些流。
*   生成字符序列。
*   它检查是否有足够的空间用于书写字符。
*   使用`endl`在流缓冲区上调用一个额外的虚函数。

我个人认为，与其他操作相比，额外的虚函数调用实际上影响相对较小。您还可以通过分析此输出来验证此猜测：

```
out << "stream" << '\n'; 
```

... 甚至

```
out << "stream" << out.widen('\n'); 
```

也就是说，流实现可以应用许多改进来减少检查。当然，这是否完成将取决于实施。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:34:59.777

使用`std::endl`相当于写

```
stream << "\n";
stream.flush(); 
```

`std::endl`除非你真的想触发刷新，和/或不关心输出性能，否则不要使用。

此外，不要担心不同平台上的不同行尾，您的实现将转换`"\n"`为适合您平台的行尾。

# iphone - 在 prepareForSegue 方法中将自定义 UITableViewCell 的属性传递给目标视图

> ID：12675274
> 
> 赞同：1
> 
> 时间：2012-10-01T14:29:40.197
> 
> 标签：iphone, objective-c, uitableview, storyboard, segue

我正在使用 StoryBoard 开发 Iphone 应用程序。

我在 UINavidationView 中有一个 UITableView。我在自定义单元格中加载数据。然后当用户单击单元格时，我转到另一个视图（ResultView）。

我在情节提要中设置了视图和转场。

我的目标是从 prepareForSegue 方法向 ResultView 传递数据。

为此，我创建了一个实现 UITableViewCell 的自定义单元格。然后我添加了一个 NSDate 类型的属性，名为：creationDate。我需要将所选单元格的创建日期传递给 ResultView。我有以下 ate = readingCell.creationDate;

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if([segue.identifier isEqualToString:@"resultViewSegue"])
    {
        //Get a reference to the destination
        ResultsViewController * destinationView = segue.destinationViewController;

        //I try to get the selected cell in order to pass it's property
        historyCellClass * selectedCell = (historyCellClass*) sender;

        //pass the creation date to the destination view (it has its own creation date property)
        [destinationView setCreationDate:selectedCell.creationDate];
    }
} 
```

但是，结果视图的创建日期始终为空。

看起来我没有获得所选单元格的引用以读取其属性。

如何将单元格的日期传递给下一个视图？

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:25:04.803

我处理这个问题的方法是手动触发 segue 和表示选择状态的 ivar。

确保被触发的 segue 从一个视图控制器转到下一个（而不是从一个 tableView 单元格）。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    self.selectedModel = [self.myModel objectAtIndex:indexPath:row];
    [self performSegueWithIdentifier:@"resultsViewSegue"]; 
```

selectedModel 是新的 ivar，其类型与支持表数据源的数组中的单个元素相同。就像在 cellForRowAtIndexPath: 中一样，使用索引路径查找它。

现在在 prepareForSegue:..

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if([segue.identifier isEqualToString:@"resultViewSegue"])
    {
        //Get a reference to the destination
        ResultsViewController * destinationView = segue.destinationViewController;

        //pass the creation date to the destination view (it has its own creation date property)
        [destinationView setCreationDate:self.selectedModel.creationDate];

        // selectedModel.creation date might not be right... use whatever way you get to creationDate
        // from the indexPath in cellForRowAtIndex path, that's the code you want above.
    }
} 
```

在表格视图选择和 segue 开始之间保存什么状态有几个选择。您可以保存选定的索引路径，或者我建议的模型元素，或者只是您打算传递的模型的方面（例如，您的 creationDate ）。保存状态的唯一坏主意是表格单元格本身。

# javascript - 在 jquery 中编写一个全局动画队列

> ID：12675275
> 
> 赞同：3
> 
> 时间：2012-10-01T14:29:49.120
> 
> 标签：javascript, jquery, animation, queue

使用 jQuery 向单个 dom 元素添加一系列动画非常容易。jQuery 很好地为我排好队，我基本上不需要做任何事情。

然而，在多个元素上制作一系列动画（例如，pictureDiv 淡出，然后人口统计Div 淡入）要困难得多。我写了一个插件类型的东西来使它更容易，如下所示：

```
var something.createAnimationQueue = function () {

    // jQuery queues up animations on each dom element (/ jquery object)
    // We want to queue up animations over different dom elements so 
    // use a jquery object on a blank element
    var animationQueue = $({});

    return {
        add: function (animationFunctionContext, animationFunction) {
            var args = $.makeArray(arguments).slice(2);
            animationQueue.queue(function (next) {
                $.when(animationFunction.apply(animationFunctionContext, args)).done(next)
            })
        }
    }
} 
```

哪个是这样使用的

```
 var animationQueue = something.createAnimationQueue();

        animationQueue.add(pictureDiv, pictureDiv.fadeOut, 'slow');
        animationQueue.add(demographicsDiv, demographicsDiv.fadeIn, 'slow'); 
```

我的问题是：

1）我错过了什么吗？有没有一种我不知道的更简单的方法来做到这一点。

2）如果没有，有没有办法避免将pictureDiv和pictureDiv.fadeOut传递给animationQueuer？（我试过了，想不出一个）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T14:37:42.820

由于您正在使用 .apply 和 reassigning `this`，您可以简单地使用

```
var animationQueue = something.createAnimationQueue();

animationQueue.add(pictureDiv, $.fn.fadeOut, 'slow');
animationQueue.add(demographicsDiv, $.fn.fadeIn, 'slow'); 
```

如果你真的想要，你可以把它变成一个字符串：

```
var something.createAnimationQueue = function () {

    // jQuery queues up animations on each dom element (/ jquery object)
    // We want to queue up animations over different dom elements so 
    // use a jquery object on a blank element
    var animationQueue = $({});

    return {
        add: function (animationFunctionContext, method) { // <----
            var args = $.makeArray(arguments).slice(2);
            animationQueue.queue(function (next) {
                $.when($.fn[method].apply(animationFunctionContext, args)).done(next) // <----
            })
        }
    }
}

var animationQueue = something.createAnimationQueue();

animationQueue.add(pictureDiv, 'fadeOut', 'slow'); // <----
animationQueue.add(demographicsDiv, 'fadeIn', 'slow'); // <---- 
```

但是请注意，现在它不能仅用于动画。您可以将它与任何返回 promise 对象的 jQuery 方法一起使用，例如 .ajax、.post、.get、.getJSON 等，如果您像最初使用它一样使用它。

# javascript - 用 Knockout.js 继承

> ID：12675276
> 
> 赞同：2
> 
> 时间：2012-10-01T14:29:50.930
> 
> 标签：javascript, inheritance, knockout.js

我有一些这样的代码：

```
var A = function(a,b,c) {
  var self = this;
  self.a = ko.observable(a);
  ... 

  self.function1 = ko.computed(function () {
      dothing(a);
      ...
  } 

  self.function2 = ko.computed(function () {
      dothing(b);
      ...
  }
}

var B = function(a,b,c,d) {
    var self = this;
  self.a = ko.observable(a);
  ... 

  self.function1 = ko.computed(function () {
      dothing(a);
      ...
  } 

  self.function2 = ko.computed(function () {
      dothing(b);
      ...
  }
} 
```

如何将函数 1 和函数 2 “提取”为 A 和 B 可以共享的函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T14:47:42.557

这正是原型适合的地方：

```
function AB()
{};//empty object
AB.prototype.function1 = function()
{
    var self = this;//doesn't have access to self, but `this` will point to either A or B
    //do stuff
};
var A = function()
{
    var self = this;//constructor
}
var B = function()
{
    var self = this;//constructor
}
A.prototype = new AB;
A.prototype.constructor = A;
B.prototype = new AB;
B.prototype.constructor = B;
//marginally shorter:
A.prototype = B.prototype = new AB;
A.prototype.constructor = A;
B.prototype.constructor = B;
//instances:
var foo = new A();
var bar = new B();
console.log(foo.function1 === bar.function1);//logs true 
```

*话虽如此，就个人而言，我更喜欢定期*定义我的构造函数：

```
function A()
{
    var self = this;
}
foo = new A();
console.log(Object.getPrototypeOf(foo).constructor.name);//logs A 
```

而您的代码将匿名函数分配给变量，这意味着构造函数没有名称：

```
foo = new A();
console.log(Object.getPrototypeOf(foo).constructor.name);//logs '' 
```

这没什么大不了的，但只是让你知道*......*

* * *

从全局（或任何其他）范围引用方法：

```
var virtualNewFunction = new A();//create object
virtualNewFunction = virtualNewFunction.function1;//virtualNewFunction now references function1
virtualNewFunction(); 
```

闭包仍然可以访问（暴露），但要*非常*小心`this`：

```
A = function()
{
    var self = this;
    this.function1 = function()
    {
        console.log(this);
        console.log(self);
    };
}
foo = new A();
foo.function1();//logs A twice
foo = foo.function1
foo();//logs this -> window! self => A 
```

另一种可能性是*“借用”*一个函数：

```
A = function()
{
    var self = this;
    this.function1 = function()
    {
        console.log(this);
        console.log(self);
    };
}
B = function()
{//no method
    var self = this;
}
foo = new A();
bar = new B();
foo.function1.apply(bar,[]);//call as though function1 was method of B 
```

同样，要小心：在这种情况下，`this`日志`B`，但`self`仍然引用`A`！您可以建立某些*“安全网”*：

```
 this.function1 = function()
    {
        self = this !== window && this !== self ? this : self;//redefine self to current caller object, unless it's window 
        console.log(this);
        console.log(self);
    }; 
```

但老实说，您可能会很好地[阅读 this 运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)以掌握所有这些引用技巧。一旦你掌握了基础知识*，*这并不难。还要检查[call](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)和[apply](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)方法以获取有关如何*“共享/借用”*方法的更多详细信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:36:43.477

您可以通过将其拉出该对象来更改函数的范围。

```
var function1 = function() {

}

var function2 = function() {

}

var A = function(a,b,c) {
  var self = this;
  self.a = ko.observable(a);
  ... 

  self.function1 = ko.computed(function1)

  self.function2 = ko.computed(function2)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-04T19:56:37.503

您可以尝试使用 underscore.js 扩展功能来进行继承。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-05T22:15:31.537

```
 var AB=function(){
    self=this;
    self.function1=function(){
                   //----something------
                  }
    self.function1=function(){
                   //----something------
                  }

   }

     var A=function(){
     var self=this;
     AB.apply(self,arguments);
     } 

    var B=function(){
     var self=this;
     AB.apply(self,arguments);
        } 
```

# ruby-on-rails - Rails i18n 特定的错误验证格式

> ID：12675279
> 
> 赞同：13
> 
> 时间：2012-10-01T14:30:00.613
> 
> 标签：ruby-on-rails, ruby, validation, activerecord, internationalization

因此，您可以使用以下内容更改 en.yml 中的错误消息：

```
en:
  activerecord:
    errors:
      models:
        foo:
          attributes:
            amount:
              greater_than_or_equal_to: "Custom GTOE error message." 
```

但是，这将说明以下内容：

```
Amount Custom GTOE error message. 
```

我知道我可以通过以下方式全局删除它：

```
en:
  activerecord:
    errors:
      format: "%{message}" 
```

但是我可以`%{attribute}`只删除这个验证吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-09-15T14:01:11.953

我不确定你是否可以从 en.yml 中删除它，但你可以制作一个我认为会有你想要的签名的自定义：

```
def discount_cannot_be_greater_than_total_value
    if attribute > total_value
      errors.add(:base, "can't be greater than total value")
    end
end 
```

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-10-01T14:46:32.357

```
 validates :amount, :numericality => { :greater_than_or_equal_to => YOUR_VALUE, :message => YOUR_ERROR_MESSAGE } 
```

# html - 如何显示来自第三方网站的图片？

> ID：12675287
> 
> 赞同：1
> 
> 时间：2012-10-01T14:30:12.233
> 
> 标签：html, image, protection

请看[这个例子](http://jsfiddle.net/and7ey/YKVnx/)——第一张图片没有显示，而不是第二张图片显示的是其他图片。但如果我直接在浏览器中打开 URL，我会看到正确的海报。如何在我的网站上使用这些图片？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:34:10.557

第一个不是图片，只是图片的路径。

**[Lorempixel](http://lorempixel.com/)**做一些类似的事情，你使用图像，但过了一段时间它就会过期并且不可用。

第二个是图片，因为扩展名`.jpg`。

因此，您可以在您的网站中使用第二个。

# ios - 调用 numberOfRowsInSection 时忘记了 TableView 初始化程序中设置的变量

> ID：12675288
> 
> 赞同：-2
> 
> 时间：2012-10-01T14:30:22.340
> 
> 标签：ios, cocoa-touch

我正在使用带有 ARC 的 Xcode 4.5 创建一个 UITableViewController 类，我想用一个 NSDictionary 对其进行初始化。在其初始化程序中，创建的 [resourcesAsDictionary 计数] 返回了一些正确的值，但稍后当我在主视图中按下按钮时，表格是根据 NSDictionary 的条目数构建的，我用 NSDictionary 初始化了类始终为空并且 [resourcesAsDictionary count] 返回 0。我认为这与 ARC 有关吗？如果我将其关闭，我可以保留该变量吗？但是必须有一种方法可以使用 ARC 来获得这个？）相关代码：

编辑：我已经根据收到的帮助更改了代码。
编辑2：因为我能够缩小问题的范围，这有点令人困惑，而且阅读量很大，我创建了一个新主题：[ViewController 类在创建视图时创建新实例，但它应该使用现有的一个](https://stackoverflow.com/questions/12683486)
编辑 3：问题在已经链接的线程中解决了，这个也是。

视图控制器.h：

```
#import <UIKit/UIKit.h>
#import <Foundation/NSJSONSerialization.h>
#import <Foundation/NSXMLParser.h>
#import "ResourcesTableViewController.h"

@interface ViewController : UIViewController <UITextFieldDelegate, UITableViewDelegate, UITableViewDataSource> {
// Note: this <UITableViewDelegate, UITableViewDataSource> is NOT related to the TableViewController. My ViewController has another TableView.
NSDictionary *parsedResponseAsDictionary;
ResourcesTableViewController *resourceTableViewController;
...
}
... 
```

ViewController.m 中的某处：

```
#import "ViewController.h"

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    parsedResponseAsDictionary = [[NSDictionary alloc] init];
}
...
-   (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)_bodyData {
    parsedResponseAsDictionary = [NSJSONSerialization JSONObjectWithData:bodyData options:NSJSONWritingPrettyPrinted error:&err];
    ... // putting found keys as entries in an array foundResources
    if ([foundResources count] > 0) {
        resourceTableViewController = [[ResourcesTableViewController alloc] initWithStyle:UITableViewStylePlain];
        [resourceTableViewController setResourcesAsDictionary:parsedResponseAsDictionary];
        NSLog(@"Delivered %i entries.",[[resourceTableViewController resourcesAsDictionary] count]);
        // TableView can be built: enable "Show Resources" button
        [_showResourcesButton setAlpha:1];
        [_showResourcesButton setEnabled:YES];
    }
}
...
// Output:
// REST Analyzer[1259:c07] Delivered 8 entries.
// REST Analyzer[1259:c07] viewWillAppear: (null)
// REST Analyzer[1259:c07] Now: 0 entries. 
```

资源表视图控制器.h：

```
#import <UIKit/UIKit.h>

@interface ResourcesTableViewController : UITableViewController {
}

@property (nonatomic, strong) NSDictionary *resourcesAsDictionary;

@end 
```

资源表视图控制器.m：

```
#import "ResourcesTableViewController.h"

@implementation ResourcesTableViewController

// - (id)initWithDictionary:(NSDictionary*)dic {
//    if (self = [super init])
//        resourcesAsDictionary = [[NSDictionary alloc] initWithDictionary:dic];
//    NSLog(@"resource table created with %i entries.",[resourcesAsDictionary count]);
//    return self;
// }

- (void)viewWillAppear:(BOOL)animated {
    NSLog(@"viewWillAppear: %@", self.resourcesAsDictionary);
    // (null) is returned here.
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    NSLog(@"Now: %i entries.",[self.resourcesAsDictionary count]);
    return [self.resourcesAsDictionary count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";
    // UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue2
                                      reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.text = @"Cell";
    cell.detailTextLabel.text = @"Description";

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:41:38.990

我会以几种方式改变它......

删除 resourcesAsDictionary 的 iVar 并将其设置为属性。

```
@property (nonatomic, strong) NSDictionary *resourcesAsDictionary; 
```

然后，我将通过删除您的 init 方法并改用此属性来更改初始化。

在推送到此控制器的 viewController 中（即您调用 initWithDictionary 的位置）...

而不是 initWithDictionary 有...

```
ResourcesTableViewController *tvc = [[ResourcesTableViewController alloc] initWithStyle:<whicheverstyleyouneed>]; 
```

然后设置属性...

```
tvc.resourcesAsDictionary = mySourceDictionary; 
```

然后推TVC...

```
[self.navigationController pushViewController:tic animated:YES]; 
```

...或者但是您将其推送到屏幕上。

最后，您需要将 numberOfRows... 代码更改为...

```
return [self.resourcesAsDictionary count]; 
```

这将是我的方法，这意味着您不必重写 UITableViewController 类的初始化。

通过拥有强大的属性，您可以确保它在拥有对象的生命周期内一直存在。通过不覆盖 init，您可以确保您不会错过任何在 initWithStyle 中调用的代码...

如果这不起作用，那么我只能认为您首先创建字典的方式有问题。

在 - (void)viewWillAppear... 函数中告诉我...的输出

```
NSLog(@"%@", self.resourcesAsDictionary); 
```

# html - 如何重新格式化 HTML 以在关闭标签后添加换行符？

> ID：12675291
> 
> 赞同：0
> 
> 时间：2012-10-01T14:30:26.900
> 
> 标签：html, format, sublimetext2

我有一个 html 文件，所有文件都集中在一起......例如：

```
<tr><td class="stat_WS">6</td><td class="stat_BS">6</td><td class="stat_St">3/4</td><td     class="stat_To">3</td><td class="stat_Wo">2</td><td class="stat_In">6</td><td class="stat_At">3/4</td><td class="stat_Ld">9</td><td class="stat_Save">5+/2(i)</td></tr></tbody></table><div class="wargear">Wargear</div><table class="options"><tr class="opt_dePGL"><td class="name">Phantasm Grenade Launcher</td><td class="cost">0</td></tr> 
```

我想自动运行它并在每个结束标记后换行。帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T14:37:06.560

如果您真的需要在 Sublime 中执行此操作，请点击`Ctrl+H`并替换：`(</[a-z]+>)`with `$1\n`。（确保检查“正则表达式”）

对于完整的重新格式化，网上有很多格式化程序，比如这个：[http ://www.freeformatter.com/html-formatter.html](http://www.freeformatter.com/html-formatter.html)

# php - PHP异步页面请求代码

> ID：12675293
> 
> 赞同：0
> 
> 时间：2012-10-01T14:30:30.217
> 
> 标签：php, email, asynchronous

我搜索了一种解决方案来发出异步页面请求，并找到了这些代码行。（实际上我编辑了一点）

```
function do_the_thing()
{
   $parts = parse_url("mail_sender.php");
   $fp = fsockopen($parts['host'], isset($parts['port']) ? $parts['port'] : 80, 
                   $errno, $errstr, 30);
   $out = "POST " . $parts['path'] . " HTTP/1.1\r\n";
   $out.= "Host: " . $parts['host'] . "\r\n";
   $out.= "Content-Type: application/x-www-form-urlencoded\r\n";
   $out.= "Connection: Close\r\n\r\n";
   fwrite($fp, $out);
   fclose($fp);
} 
```

所以我有一个`mail_sender.php`自动发送电子邮件，但是通过这个异步调用，它什么都不发送。我在这里错过了什么吗？我正在另一个页面中调用函数，因此页面加载继续进行，而无需等待邮件发送过程。唯一的问题是，我似乎无法请求页面或请求页面但没有完成这项工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:38:05.870

只看你函数的前两行，你就有一个问题：

`parse_url("mail_sender.php")`为您提供一个包含一个元素的数组（[参见示例](http://codepad.org/iXXgm5nT)）：

```
array(1) {
  ["path"]=>
  string(15) "mail_sender.php"
} 
```

所以你在`fsockopen`没有第一个 - 必需 - 参数的情况下调用。

# javascript - ajax完成后cookie删除功能停止工作

> ID：12675299
> 
> 赞同：1
> 
> 时间：2012-10-01T14:31:02.903
> 
> 标签：javascript, jquery, ajax, cookies

当页面加载时，会通过 PHP 在任何其他内容或标题之前使用以下代码创建一个 cookie：

```
$steam_login_verify = SteamSignIn::validate();
if(isset($_COOKIE['userid']))
{
     //work with cookie value to get data;
     $steam_login_verify = $_COOKIE['userid'];

     $id = new SteamId($steam_login_verify);

     $name = $id->getNickname(); 
     $baseUrl = $id->getBaseUrl();
     $medAvatar = $id->getMediumAvatarUrl();
} else if(!empty($steam_login_verify))
{
     //create the cookie and store the user id as the value
     $exDate = time()+60*60*24*365;
     setcookie('userid', $steam_login_verify, $exDate,'/');

     $id = new SteamId($steam_login_verify);
     $name = $id->getNickname(); 
     $baseUrl = $id->getBaseUrl();
     $medAvatar = $id->getMediumAvatarUrl();
} 
```

然后我使用[James Auldridge 的](http://code.google.com/p/cookies/)jQuery cookie 插件来管理 cookie。

一旦用户通过 Stream 登录，他们的 Steam64Id 将在 cookie 中存储一年，以防止他们每次访问他们的页面时都必须登录（假设他们会定期访问它）。

然后，我在 ajax 调用中使用 Steam64Id 来获取所有用户的朋友，并使用他们的姓名填充选择元素。

页面上有一个“退出”按钮，单击该按钮将删除 cookie 并刷新页面，导致用户不得不再次通过 Steam 登录。这就是我遇到问题的地方。

只要 ajax 调用正在运行（并且需要一段时间才能运行约 57 秒），注销按钮就可以正常工作。一旦该调用完成并填充了 select 元素，注销按钮将失败并在控制台中显示错误：

```
Uncaught TypeError: Cannot call method 'del' of undefined 
```

这个错误引用的代码是删除cookie并刷新页面的函数：

```
$('#logout').click(function() {
     $.cookies.del('userid');
     window.location.reload();
}); 
```

我不明白这个错误，或者它为什么被抛出。这里的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:53:03.910

我必须查看更多客户端代码和 AJAX 响应才能确定，但​​我怀疑 AJAX 响应包含一个重新加载 jQuery 的 SCRIPT 标记，导致所有加载的插件（`$.cookies`包括参考）被删除。

请记住，这`$.cookies`是一个别名，`jaaulde.utils.cookies`因此您的故障排除部分可以改用它，然后查看它是否有效。

# c++ - 当它表示线程 ID 时，为什么是 HANDLE 类型的 CRITICAL_SECTION 的 OwningThread 成员？

> ID：12675301
> 
> 赞同：7
> 
> 时间：2012-10-01T14:31:19.790
> 
> 标签：c++, windows, winapi, critical-section

我正在尝试为 CRITICAL_SECTION 解锁代码添加一些调试检查，并尝试了以下操作：

```
...
  if (m_pCritSect) {
    ASSERT(m_pCritSect->OwningThread == GetCurrentThreadId());
    LeaveCriticalSection(m_pCritSect);
  }
} 
```

通过调试 CRITICAL_SECTIONS（使用 VS 2005，主要在 WindowsXP 上），我“知道” （中定义的结构的`OwningThread`成员）的值是持有锁的线程的**ID的值。**`RTL_CRITICAL_SECTION``winnt.h`

 **但是，线程 ID 由`DWORD`(typedef for `unsigned long`) 值表示，而此变量的类型`HANDLE`(typedef for `void*`) 需要~~a`reinterpret_cast`才能~~使用`HandleToULong`宏 from`basetsd.h`以使上述代码正常工作。

甚至[MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/hardware/ff541979%28v=vs.85%29.aspx)状态：

> 当第一个线程调用 EnterCriticalSection 例程时，(...) OwningThread 成为调用者的线程 ID。

那么到底为什么这被定义为一个`HANDLE`？

* * *

编辑注意：我发现[了一个声明](http://www.osronline.com/showthread.cfm?link=136696)，其中海报表明 HANDLE / DWORD-Id 不匹配是某些 Windows 内部的一些已知错误功能。所以也许这也是这里的情况：

> GetCurrentThreadId 返回一个 DWORD，我在消息中将其发送给内核。PsLookupThreadByThreadId 采用 HANDLE 中的线程 ID，......
> 
> 这是一个已知的 Windows API 错误（“已知”是因为我与相关的过滤器管理器 DEV 讨论了这个问题，因为它也出现在过滤器管理器中，因为 I/O 管理器 API 问题。）只要你不这样做t 有超过 5 亿左右的线程和进程（它们使用单​​个共享句柄表）你会没事的。也许到那是一个真正的问题时，我们会运行一些不同的东西。[ *RE: ThreadId 处理 64 位？*, 08 年 8 月 8 日 14:21，托尼·梅森]

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-01T16:19:49.873

SDK 中名称以 RTL 或 Rtl 开头的任何标识符都是作为运行时层一部分的代码或声明，是将有据可查的 Winapi 与无证本机操作系统 api 结合起来的粘合剂。winapi 是一成不变的，本机操作系统会随着每个 Windows 版本发生重大变化。不可避免地，胶水也会发生变化。

winapi 是文档层，本机操作系统是无文档的。运行时层也没有记录在案，但随着时间的推移，它的一部分被揭露了。要么是因为它回填了 winapi 中缺少的功能。或者，在这种情况下，因为对于解决问题非常有用。然而，这样做的一个核心问题是，一旦声明被披露，微软就永远无法再更改它。因为这样做会破坏现有的程序，给客户带来很大的负担。

可以肯定的是，ThreadOwner 字段曾经在以前的 Windows 版本中真正拥有线程的句柄。请注意 LockSemaphore 也是如何误导的，它实际上是一个自动重置事件。来不及修复它，猫已经从袋子里出来了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-01T14:49:55.877

我认为主要原因是它是一个实现细节。如果在历史上的某个时候它真的是一个把手或类似的东西，我不会感到惊讶。

此外，我强烈建议不要在生产代码中使用内部成员，而且[我并不孤单](http://blogs.msdn.com/b/oldnewthing/archive/2005/07/01/434648.aspx)。如果您仔细观察，`CRITICAL_SECTION`您会发现使用的同步 API 不会在 MSDN 中记录为结构，而不是 RTL_CRITICAL_SECTION（其类型定义为 CRITICAL_SECTION）

存储在`OwningThread`member 中的值取自[Thread Information Block](http://en.wikipedia.org/wiki/Win32_Thread_Information_Block)的 CLIENT_ID 部分。在 CLIENT_ID 中，它被建模为 PVOID，这可能是它在 CRITICAL_SECTION 中以相同方式建模的原因：

```
typedef struct _CLIENT_ID
{
   PVOID UniqueProcess;
   PVOID UniqueThread;
} CLIENT_ID, *PCLIENT_ID; 
```**

# android - Android动画不流畅

> ID：12675305
> 
> 赞同：1
> 
> 时间：2012-10-01T14:31:31.143
> 
> 标签：android, animation, timertask

我正在开发一个游戏，其中我使用了一个计时器任务，它需要不断运行以更新 GUI。在这里，如果我尝试同时执行 2 个动画，它们运行不顺畅，并且动画看起来很不稳定。

例如，即使我执行一个帧动画，并且在它运行时，我尝试滚动一个列表，它也不会按照需要平滑滚动。我尝试在 runOnUiThread 中运行一些动画，但没有运气。

我还注意到一件事。使用 image.setVisibility(View.GONE) 或 image.setVisibility(View.VISIBLE) 会破坏动画流程。

请为此问题提出解决方案或替代方案。同时执行多个动画会导致android出现问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T16:57:32.727

你的目标 API 是什么？可以开启[硬件加速](http://developer.android.com/guide/topics/graphics/hardware-accel.html)吗？

```
 <application android:hardwareAccelerated="true" ...> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T16:26:06.900

如果您只是在模拟器上进行测试，也许您可​​以先在真机上尝试。我相信众所周知，模拟器并不像真实设备那样最擅长渲染动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T16:44:36.893

我认为你不能指望 4.0（冰淇淋三明治）之前的 android 版本的流畅动画。尝试在以后的 android 版本上运行它们，你会发现巨大的差异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-02T01:23:12.807

回复有点晚，但我最近遇到了同样的问题并想出了一个解决方法，所以对于那些有兴趣的人......

显然，如果您的视图超出其他视图，则这些视图将被迫重新绘制。防止过多重绘的一种方法是扁平化视图层次结构。

但是，当您一次有多个动画时，这可能还不够。在这种情况下，如果您为启用了硬件加速的设备编程，则在重绘的视图（例如背景视图）上禁用它会有所帮助（`View.setLayerType(View.LAYER_TYPE_SOFTWARE, null)`例如，调用）。我真的不知道为什么，但它可以很好地平滑动画。也许是因为 GPU 没有太多处理所有重绘。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-27T17:28:25.787

根据我的经验，内存使用会影响动画的性能。因此，如果您可以减少应用程序的内存占用，它可能会产生积极影响。一种简单的方法是减小您正在使用的任何图像的文件大小。

# cakephp - CakePHP 移动检测不起作用？

> ID：12675306
> 
> 赞同：0
> 
> 时间：2012-10-01T14:31:33.030
> 
> 标签：cakephp, mobile

我不知道为什么这不起作用！我在 AppController 中的 beforeFilter() 函数中有以下代码，我使用的是 CakePHP 2.2.2，我开始使用 '$this->RequestHandler->isMobile()' 但这给了我一个错误。查看 CakePHP 网站，我发现他们已将调用更改为我现在在下面使用的调用。

但是这不起作用，当我在 iPhone 上查看我的网站时，它应该只回显在视图文件上设置的测试消息，但它仍然会转到整个网站的 default.cpt 文件，我认为应该停止自动渲染命令？

那么我做错了什么或者我没有做我应该做的事情？

```
 if($this->request->is('mobile')) {
      $this->isMobile = true;
      $this->set('isMobile', true );
      $this->autoRender = false;
      $this->render('../mobile/test');
   } 
```

非常感谢格伦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T14:56:05.717

你有没有尝试过这样的事情？无法测试它，但它看起来应该可以工作。

```
public $components = array('RequestHandler');

public function beforeFilter() {
    if ($this->RequestHandler->is('mobile')) {
        // Execute code only if client accepts is mobile
    } else {
        // Execute Normal Code
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T15:23:22.180

按照编写良好的文档，您可以执行以下操作：

```
if ($this->request->is('mobile')) {
    $this->isMobile = true;
    ...
} 
```

[http://book.cakephp.org/2.0/en/controllers/request-response.html#inspecting-the-request](http://book.cakephp.org/2.0/en/controllers/request-response.html#inspecting-the-request)

这将是新的 2.x 风格。requesthandler 组件在这里只是一个包装器，可能有一天会弃用包装器访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-27T12:19:03.013

对于 cake php 2.x，在控制器顶部使用它

`public $components = array('RequestHandler');`

并在任何动作中使用这个

```
 if ($this->RequestHandler->isMobile()) { 
```

// 你的条件在这里

}

# java - 用java更改鼠标缓冲区

> ID：12675311
> 
> 赞同：5
> 
> 时间：2012-10-01T14:31:50.867
> 
> 标签：java, awtrobot

我正在使用 java 创建一个机器人，但是有一个具有特殊且强大的安全性的应用程序，我无法在那里执行我的机器人，由于某种我不知道的原因，当此类应用程序运行时，我的机器人无法更改鼠标位置跑步。我正在使用 java.awt.Robot 类来更改鼠标位置，但它不起作用，所以我想知道是否有另一种方法可以用 java 更改鼠标位置，我正在考虑尝试更改带有java的鼠标缓冲区（也许不可能，是吗？）。如果您能告诉我一些在不使用 java.awt.Robot 类的情况下使用 java 更改鼠标位置的方法，我将不胜感激。

例如，此代码将鼠标位置更改为 500、500 坐标：

```
Robot robot = new Robot();
robot.mouseMove(500, 500); 
```

，但在具有特殊安全性的应用程序运行时它不起作用。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T09:09:51.063

win7还是xp？如果win7，请尝试以管理员身份运行。

# facebook - 如何继续开发一个简单的应用程序，将链接发布在用户墙上

> ID：12675320
> 
> 赞同：2
> 
> 时间：2012-10-01T14:32:15.033
> 
> 标签：facebook, facebook-like, facebook-wall

我基本上想知道我应该从哪里开始阅读以开发这样一个简单的东西。我需要的是当有人点击时，该页面的链接会自动放在人们的墙上。现在我研究了一下，发现了很多教程，但大多是弃用的。我知道如何在 php 中编写代码以及所有必需品。只需要知道在哪里学习做这件小事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T01:36:57.503

[在这里](https://developers.facebook.com/docs/reference/plugins/like/)阅读此内容，然后将其复制，粘贴给您！

# mysql - 如何从 MySQL 中选择唯一的组合？

> ID：12675322
> 
> 赞同：0
> 
> 时间：2012-10-01T14:32:19.667
> 
> 标签：mysql

假设我的桌子上有这些。

```
Index   Resultant   First   Second
1       Ice         Water       Cold
2       Cold Air    Water       Cold
3       Cold Wind   Water       Cold
4       Hot Air     Volcano     Air
5       Normal Air  Oxygen      Hydrogen
6       Ice         Cold        Water
7       Cold Air    Cold        Water
8       Cold Wind   Cold        Water 
```

我只想显示这些

```
Index   Resultant   First   Second
1       Ice         Water       Cold
2       Cold Air    Water       Cold
3       Cold Wind   Water       Cold
4       Hot Air     Volcano     Air
5       Normal Air  Oxygen      Hydrogen 
```

因为如果你翻转它们，底部的 3 个区域都会重复。但我不希望第 1,2 行也被隐藏，因为它也是水和冷的组合。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T14:34:00.360

```
select least(col1, col2), greatest(col1, col2)
from MyTable
group by least(col1, col2), greatest(col1, col2) 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!2/05d8d/2)

# jquery - 将 jQuery Cycle 插件与 ScrollTo 插件一起使用

> ID：12675323
> 
> 赞同：1
> 
> 时间：2012-10-01T14:32:22.093
> 
> 标签：jquery, cycle, scrollto, pager

我正在使用 .cycle 插件来循环浏览图像。我的寻呼机上有 scrollTo 插件设置。它使用 .click 功能滚动，但在循环时不会滚动。如何让它在每个循环中滚动寻呼机？

```
 $(document).ready(init);

        function init() {
    var titles = ['1913', '1918', '1927', '1935', '1950', '1963', '1977', '1980', '1983', '1986', '1987', '1988', '1988-1999', '1990', '1992', '1993', '1993-1995', '1994', '1995', '1999', '1999', '2000', '2003', '2003', '2003', '2003', '2006', '2007-2008', '2011', '2011', '2013'];
    // dynamically add a div to hold the slideshow's pager
    $("#allCardContainer").before('<div id="pager"></div>');

    // now to use the cycle plugin
    $("#allCardContainer").cycle({
        pause: 1,
        pager: "#pager",
        pagerAnchorBuilder: function (index) {
            return '<a class="scroll" id="link' + [index] + '" href="#' + [index] + '">' + titles[index] + '</a>';

        }

    });

    $(".scroll").click(function (event) {
        event.preventDefault();
        $('#allCardContainer').cycle('pause');
        $('#pager').scrollTo($(this), 1500, { axis: 'x', offset:-50 });
    });

} 
```

因此，代码创建了寻呼机 div，然后循环浏览图像。第二个函数暂停循环并将寻呼机向左滚动。如何使该滚动在每个循环中触发，以便我选择的寻呼机 div 始终位于同一位置并且始终可见？

编辑：

如果我尝试这样做，我的点击效果很好，但寻呼机在循环期间不会滚动。

```
$(document).ready(init);

function init() {
    var titles = ['1913', '1918', '1927', '1935', '1950', '1963', '1977', '1980', '1983', '1986', '1987', '1988', '1988-1999', '1990', '1992', '1993', '1993-1995', '1994', '1995', '1999', '1999', '2000', '2003', '2003', '2003', '2003', '2006', '2007-2008', '2011', '2011', '2013'];
    // dynamically add a div to hold the slideshow's pager
    $("#allCardContainer").before('<div id="pager"></div>');

    // now to use the cycle plugin
    $("#allCardContainer").cycle({
        pause: 1,
        pager: "#pager",
        pagerAnchorBuilder: function (index) {
            return '<a class="scroll" id="link' + [index] + '" href="#' + [index] + '">' + titles[index] + '</a>'; 
        },
        before: slideScroll(false)
    });

    function slideScroll(clicked) {
        if (clicked) {
            //$('#allCardContainer').cycle('pause');
            $('#pager').scrollTo($('.activeSlide'), 1500, { axis: 'x', offset: -83 });
        }
        else {
            $('#pager').scrollTo($('.activeSlide'), 1500, { axis: 'x', offset: -20 });
            alert('sliding');
        }
    }

    $(".scroll").click(function(event){        
        slideScroll(true);
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:39:13.893

你将在循环的**before**选项中做你想做的事

```
// now to use the cycle plugin
$("#allCardContainer").cycle({
    pause: 1,
    pager: "#pager",
    pagerAnchorBuilder: function (index) {
        return '<a class="scroll" id="link' + [index] + '" href="#' + [index] + '">' + titles[index] + '</a>';
    },
    before: function(currSlideElement, nextSlideElement, options, forwardFlag) {
      // Do stuff here.
    }

}); 
```

[http://jquery.malsup.com/cycle/options.html](http://jquery.malsup.com/cycle/options.html)

编辑：

做这个：

```
$(document).ready(init);

function init() {
  var titles = ['1913', '1918', '1927', '1935', '1950', '1963', '1977', '1980', '1983', '1986', '1987', '1988', '1988-1999', '1990', '1992', '1993', '1993-1995', '1994', '1995', '1999', '1999', '2000', '2003', '2003', '2003', '2003', '2006', '2007-2008', '2011', '2011', '2013'];
  // dynamically add a div to hold the slideshow's pager
  $("#allCardContainer").before('<div id="pager"></div>');

  // now to use the cycle plugin
  $("#allCardContainer").cycle({
    pause: 1,
    pager: "#pager",
    pagerAnchorBuilder: function (index) {
      return '<a class="scroll" id="link' + [index] + '" href="#' + [index] + '">' + titles[index] + '</a>';
    },
    before: function() {
      if( $('.activeSlide').length > 0) {
        $("#pager").scrollTo($('.activeSlide'), 1500, { axis: 'x', offset:-50 });
      }
    }
  });

  $(".scroll").click(function(event) {
    event.preventDefault();
    $('#allCardContainer').cycle('pause');
    $('#pager').scrollTo($(this), 1500, { axis: 'x', offset:-50 });
  });
} 
```

[http://jsfiddle.net/xFMhA/](http://jsfiddle.net/xFMhA/)

# python - 在 wxpython 中为棋盘建模

> ID：12675325
> 
> 赞同：1
> 
> 时间：2012-10-01T14:32:27.030
> 
> 标签：python, wxpython, chess

我正在学习 wxPython 来制作国际象棋 GUI，但我不完全知道应该如何完成，要使用哪些小部件。我在想我把每个方块都做成一个带有图片的按钮，然后将它们放在板上，彼此相邻，所以我在板上有 64 个按钮。

当我移动一块时，我将按钮放在目标方格上，然后原方格将被一个代表空方格的按钮替换。

这是在 wxPython 中执行此操作的正确方法吗？我真的被困在这里，因为网络上没有 wxPython 中国际象棋 GUI 的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:47:46.150

啊，大约十年前，我用 wxPython 创建国际象棋程序是我自学 Python 编程的方式；-) 祝你好运。

首先，您需要为电路板绘制网格。这很简单。然后你需要一个数据结构来记住所有片段的位置。为此，我在这里使用了模块：[http](http://www.alcyone.com/pyos/chess/) ://www.alcyone.com/pyos/chess/ 。接下来，您需要一个例程，该例程`Board`将在适当的位置绘制碎片。

要移动棋子，您可能需要使用拖放操作。这样，您可以使一个正方形（或在该正方形上绘制的部分）可拖动。您将需要一个例程来根据屏幕坐标计算平方，例如`screen_to_board()`。在 drop 事件中，您将使用相同的程序计算目标方格。然后您只需更新板状态（使用`Board.move()`）并重绘屏幕。

# scala - 在几个文件中拆分 play2-mini 路由

> ID：12675327
> 
> 赞同：2
> 
> 时间：2012-10-01T14:32:36.757
> 
> 标签：scala, rest, playframework, play2-mini

我对整个 Scala 和 Play 很陌生，所以也许我解决这个问题的方法不是正确的。我正在使用 Scala 2.9.1 和 play-mini_2.9.1-2.0.1。

我有一个 App.scala 通常包含路线。但我的意图不是在此文件中插入所有可能的路由，而是按实体拆分它。就我而言：用户、角色、流程。

为了实现这一点，我尝试了类似的方法：

```
//in App.scala
object App extends Application { 
  println("Checking Database")
  ...      
  println("Resume executions from database")
  ...      
  def route = Routes(Process.routes :: User.routes) // I know this is wrong but I think you get what I want to do...
}

//in Process.scala
object Process {
  val routes = Routes(
    {
        case GET(Path("/process")) => Action{ request =>
            // returns a list of processes
        }
        case GET(Path("/process")) & QueryString(qs) => Action{ request =>  
            val id = QueryString(qs,"id").getOrElse(0)
            // return process by id
        } 
    }
  )
}

//in User.scala
object User { 
  val routes = Routes(
    {
        case GET(Path("/user")) => Action{ request =>
            // returns a list of processes
        }
        case GET(Path("/user")) & QueryString(qs) => Action{ request =>     
            val id = QueryString(qs,"id").getOrElse(0)
            // return process by id
        } 
    }
  )
} 
```

这只是第一步。我的最终目标是从指定的包中动态加载所有对象（进程、用户等）。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:43:43.860

您可以使用`orElse`组合路线：

```
val routes = User.routes orElse Process.routes 
```

实际上`Routes.apply`，您在编写时调用的方法`val routes = Routes(...)`将返回一个定义了上面使用的方法的 scala [PartialFunction](http://www.scala-lang.org/api/current/index.html#scala.PartialFunction)`orElse`。

请注意顺序，在我的示例中，`User.routes`将在`Process.routes`.

# c++ - IPlugEffect（音频单元目标）“打开“resource.h”期间的 SysError 0”

> ID：12675331
> 
> 赞同：0
> 
> 时间：2012-10-01T14:32:53.787
> 
> 标签：c++, osx-mountain-lion, xcode3.2, audiounit

我正在运行 OSX 10.8 和 Xcode 3.2.4，我尝试针对 10.5 和 10.6 进行编译，但无济于事。

我正在使用 Oli Larkin 的框架为每个 vst、vst3、au 和 rtas 编译音频插件。除了编译到音频单元之外，所有的工作都完美无缺。当我尝试编译时，我在打开“resource.h”时得到“SysError 0”。这不仅发生在我制作的重复项目中，而且发生在 IPlugEffect 和 IPlugMaxi 未更改的示例中。

这是 Xcode 给我的完整错误 -

Rez build-mac/MBPressor007.build/Debug/AU_32_intel.build/ResourceManagerResources/Objects/IPlugAU-73B43941A9DFE8A.rsrc ../../WDL/IPlug/IPlugAU.r cd "/Developer/Plugin SDKs/olilarkin-wdl-ol -92f9028/IPlugExamples/MBPressor007" /Developer/Tools/Rez -o"/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/build-mac/MBPressor007.build/Debug/AU_32_intel.build/ResourceManagerResources/对象/IPlugAU-73B43941A9DFE8A.rsrc" -d SystemSevenOrLater=1 -useDF -script Roman -d ppc_$ppc -d i386_YES -I /System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.framework/Versions/A/Headers -I /Developer/Examples/CoreAudio/AudioUnits/AUPublic/AUBase -arch i386 -i "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/build-mac/Debug" -i /Developer/SDKs /MacOSX10.5。sdk/System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.framework/Versions/A/Headers -i /Developer/Examples/CoreAudio/AudioUnits/AUPublic/AUBase -i "/Developer/Plugin SDKs/olilarkin-wdl- ol-92f9028/IPlugExamples/MBPressor007/../../WDL/swell" -i "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../../WDL" -i " /Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../../VST_SDK" -i "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../ ../WDL/IPlug/dfx" -i "/开发者/插件 SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007" -i "/开发者/插件 SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007 /../../WDL/IPlug/RTAS" -i "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../../VST3_SDK/public.sdk/source/common" -i "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028 /IPlugExamples/MBPressor007/../../VST3_SDK/pluginterfaces/gui" -i "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../../VST3_SDK/pluginterfaces/base" -i "/开发者/插件 SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../../VST3_SDK/public.sdk/source/vst" -i "/开发者/插件 SDKs/olilarkin-wdl- ol-92f9028/IPlugExamples/MBPressor007/../../VST3_SDK/pluginterfaces/vst" -i "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/app_wrapper" -i "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../../WDL/rtaudiomidi" -i"/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../../VST3_SDK/public.sdk/source/main" -i "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028 /IPlugExamples/MBPressor007/build-mac/Debug" -i "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/build-mac/Debug/include" -i /Developer/Plugin -i SDKs/ olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../../WDL/IPlug -isysroot /Developer/SDKs/MacOSX10.5.sdk "/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/ MBPressor007/../../WDL/IPlug/IPlugAU.r"/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/build-mac/Debug/include" -i /Developer/Plugin -i SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/.. /../WDL/IPlug -isysroot /Developer/SDKs/MacOSX10.5.sdk "/Developer/Plug SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../../WDL/IPlug/IPlugAU。 r"/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/build-mac/Debug/include" -i /Developer/Plugin -i SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/.. /../WDL/IPlug -isysroot /Developer/SDKs/MacOSX10.5.sdk "/Developer/Plug SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/../../WDL/IPlug/IPlugAU。 r"

/Developer/PlugAU.r:1: ### /Developer/Tools/Rez - SysError 0 在打开“资源.h”。致命错误！/Developer/PlugAU.r:1: ### /Developer/Tools/Rez - 致命错误，不能恢复。resource.h: ### /Developer/Tools/Rez - 由于发生错误，/Developer/Plugin SDKs/olilarkin-wdl-ol-92f9028/IPlugExamples/MBPressor007/build-mac/MBPressor007.build/Debug/AU_32_intel.build/ ResourceManagerResources/Objects/IPlugAU-73B43941A9DFE8A.rsrc 的资源分叉未写。

File DEFINITELY 存在，我尝试在目标的构建设置中设置 REZ_SEARCH_PATHS 选项以指向我项目的绝对路径，但没有运气。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T09:34:09.453

啊啊啊解决了！！

问题是我已经在 Developer 目录中安装了 SDK 和我的项目，这导致了某种冲突......在我的用户目录中重新安装了 SDK 和我的项目后，我再也没有任何问题了. 这应该适用于遇到任何关于看似不可读的 .h 文件的 rez 问题的人。

# stored-procedures - db2 最好的存储过程编辑器是什么？

> ID：12675335
> 
> 赞同：0
> 
> 时间：2012-10-01T14:33:12.857
> 
> 标签：stored-procedures, editor, db2

所以我正在为 db2 寻找一个好的存储过程编辑器。以下是我找到的选项，以及一些注意事项。

IBM Data Studio：这似乎工作得最好，但它确实是一个有问题的内存猪。您可以编辑存储过程、调试它们等。但是，内存时不时地增长得如此之大，以至于使我的系统崩溃，而且不仅会丢失（完全删除）您与现有数据源的连接。当您尝试支持大量必须重新建立连接列表的 db2 数据库时，这真的很烦人。Plus 似乎对 CVS 分支中的项目有问题。

RapidSQL：相当不错的工具，但是在 db2 中编辑和调试存储过程似乎存在问题。此外，没有查询历史记录真的很烦人。再加上它需要捆绑。

可能是对我的上述问题进行了修复，但我希望我花费一小时左右的时间研究这些问题能够解决这些问题——对于上述任何一个工具来说都不是这样。

想法？有没有比上面列出的两个更好的工具用于 db2 中的存储过程编辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:36:35.517

试用[TOAD for DB/2](http://toadfordb2.com/index.jspa)。我从未尝试过调试，但其他任何东西都很好用。版本控制对我来说有点丑陋。

# c++ - 如何在 C++ 中将值数组转换为参数

> ID：12675340
> 
> 赞同：4
> 
> 时间：2012-10-01T14:33:28.763
> 
> 标签：c++, function, dynamic, arguments

假设我有两个功能：

```
void a(int arg1) { ... }
void b(int arg1, arg2) { ... } 
```

而且我还有一个带有我要调用的函数名称的字符串，以及一个包含所有参数的数组：

```
string func_name = "b"; // 'a' or 'b'
int args[] = { 1, 2 }; // has either 1 or 2 values 
```

我需要动态调用该函数。使用没有参数的函数真的很容易，我刚刚创建了一个映射（字符串 function_name => 指向函数的指针）。

现在我还想传递参数，所以我想将数组转换为实际参数，如下所示：

```
auto f = std::bind(b, args); // Doesn't compile, requires 1,2 as arguments 
```

我希望问题很清楚并且可以解决。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T15:06:29.447

受此答案[https://stackoverflow.com/a/1287060/942596](https://stackoverflow.com/a/1287060/942596)的启发，您可以使用宏实现您想要的

```
#define BUILD0(x) x[0]
#define BUILD1(x) BUILD0(x), x[1]
#define BUILD2(x) BUILD1(x), x[2]
#define BUILD3(x) BUILD2(x), x[3]
#define BUILD(x, i) BUILD##i(x)

void foo(int i) {std::cout << i << std::endl;}
void foo(int i, int j) {std::cout << j << std::endl;}
void foo(int i, int j, int k) {std::cout << k << std::endl;}
void foo(int i, int j, int k, int l) {std::cout << l << std::endl;}

int main() {
    int x[] = {1, 2, 3};
    boost::bind(foo, BUILD(x, 2))();
} 
```

节点：这里不考虑参数为0的这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:34:59.520

只需将参数作为集合传递：

```
void a(std::vector<int> args)
{
    //...
} 
```

不需要回调或可变参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T14:37:13.897

你需要动态类型检查来完成这项工作——顺便说一下，这意味着像 Lua 或 Python 这样的动态语言。

编辑：ASP.NET 通过一个特殊的预处理步骤和反射来做到这一点。C++ 没有这些东西。您将必须执行转换。

# mysql - 用于显示所有外键/索引的 Sql 命令

> ID：12675342
> 
> 赞同：0
> 
> 时间：2012-10-01T14:33:33.310
> 
> 标签：mysql, sql, database

我想在 phpmyadmin/mysql 中调试我的数据库。查看数据库中所有外键和索引的最佳命令是什么？

还有一种方法可以查看可能的索引和外键错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:48:24.983

此代码段将向您显示所有外键：

```
SELECT concat(table_name, '.', column_name) as 'foreign key',
       concat(referenced_table_name, '.', referenced_column_name) as 'references'
  FROM INFORMATION_SCHEMA.key_column_usage
 WHERE referenced_table_name is not null; 
```

另一个向您显示所有索引：

```
SELECT DISTINCT TABLE_NAME, INDEX_NAME
  FROM INFORMATION_SCHEMA.STATISTICS; 
```

# c++ - 将 iTextSharp Dll 保存在自定义文件夹中

> ID：12675343
> 
> 赞同：0
> 
> 时间：2012-10-01T14:33:40.060
> 
> 标签：c++, windows, itextsharp

我正在创建一个 C++ 项目，在其中使用 iTextSharp 访问 PDF 的一些属性，因此我创建了一个托管 C++ Dll 来从 C# 获取值并将其传递给 C++。

现在，如果我将这两个 Dll（iTextSharp 和 Managed C++）保存在 Executable 文件夹中，那么一切正常，但如果我将这两个 Dll 保存在自定义文件夹中，则不会。这是我的代码。

LPCTSTR wrapperFullPath = "D://New Folder//PDFWrapper.dll";

LPCTSTR iTextFullPath = "D://新建文件夹//itextsharp.dll";

HMODULE wrapInst = LoadLibraryExA(wrapperFullPath , NULL, LOAD_WITH_ALTERED_SEARCH_PATH);

HMODULE iTextInst = LoadLibraryExA(iTextFullPath , NULL, LOAD_WITH_ALTERED_SEARCH_PATH);

if((wrapInst != NULL) && ((iTextInst != NULL)) {

... // 在此处获取 PDF 属性 - 第 1 行

}

现在，如果我的 iTextSharp Dll 是可执行文件夹，那么就可以了，否则它会在 Line 1 中崩溃。我也尝试设置环境变量，但这没有帮助。

-潘卡伊

# java - SocketServer与Socket通信，未收到Answer

> ID：12675344
> 
> 赞同：0
> 
> 时间：2012-10-01T14:33:42.293
> 
> 标签：java, sockets

我做了一个java ServerSocket。我使用 Socket 对象向它发送请求。请求被传递到 ServerSocket 但没有返回响应。

服务器代码：

```
 Socket startserver = this.wifiserver.accept();

                in = new InputStreamReader(startserver.getInputStream());
                BufferedReader read = new BufferedReader(in);
                String request = read.readLine();
                //System.out.println(request);

                if(request.equals("SNDKEY")){
                    System.out.println("Command is: SNDKEY");
                    out = new PrintWriter(startserver.getOutputStream());
                    out.print("12345678901234567890");
                    out.close();

                } 
```

客户代码：

```
 Socket connection = new Socket( ip, port );
        writeServer = new PrintWriter(connection.getOutputStream());
        inputStream = new InputStreamReader(connection.getInputStream());
        bufferStream = new BufferedReader(inputStream);
        writeServer.print("SNDKEY");

        this.Key = bufferStream.readLine(); 
```

问题是程序卡在命令 bufferStream.readLine() 上。我通过输出以下行命令检查了请求是否到达服务器： SNDKEY 并且它总是被打印出来。但是用户端永远不会收到密钥。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:41:14.840

`bufferStream.readLine()`阻塞，直到收到换行符。但是在服务器端，您使用 输出`PrintWriter.print()`，除非您告诉它，否则它不会发送任何换行符。所以客户端永远等待。将 print 更改为 println，或在消息末尾添加换行符：

```
out.print("12345678901234567890\n"); 
```

当您不想在协议中使用换行符时，您也可以在读取每个字节或读取特定数量的字节后使用`bufferStream.read`而不是`bufferStream.readLine`返回。

# c# - 无法加载文件或程序集 HttpException (0x80004005)

> ID：12675346
> 
> 赞同：3
> 
> 时间：2012-10-01T14:33:48.847
> 
> 标签：c#, dll

> **可能重复：**
> [BadImageFormatException 故障排除](https://stackoverflow.com/questions/8996653/troubleshooting-badimageformatexception)

我正在尝试编译我的解决方案，但收到有关 dll 的错误。我已经在另一个解决方案的 bin 文件夹中复制了那个 dll，但它没有编译它（第二个解决方案与那个 dll 无关，它不使用它）

我收到的错误是以下错误：

```
Server Error in '/browsertest1' Application.

Could not load file or assembly 'KT.AF.Engine.Core' or one of its dependencies. An attempt was made to load a program with an incorrect format. 
```

描述：`An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.`

异常详情：`System.BadImageFormatException: Could not load file or assembly 'KT.AF.Engine.Core' or one of its dependencies. An attempt was made to load a program with an incorrect format.`

源错误：

```
An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Assembly Load Trace: The following information can be helpful to determine why the assembly 'KT.AF.Engine.Core' could not be loaded.

WRN: Assembly binding logging is turned OFF.
To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.
Note: There is some performance penalty associated with assembly bind failure logging.
To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog]. 
```

堆栈跟踪：

```
[BadImageFormatException: Could not load file or assembly 'KT.AF.Engine.Core' or one of its dependencies. An attempt was made to load a program with an incorrect format.]
   System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0
   System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks) +567
   System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +192
   System.Reflection.Assembly.Load(String assemblyString) +35
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +118

[ConfigurationErrorsException: Could not load file or assembly 'KT.AF.Engine.Core' or one of its dependencies. An attempt was made to load a program with an incorrect format.]
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +11392147
   System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +484
   System.Web.Configuration.AssemblyInfo.get_AssemblyInternal() +127
   System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +334
   System.Web.Compilation.BuildManager.CallPreStartInitMethods() +280
   System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException) +1087

[HttpException (0x80004005): Could not load file or assembly 'KT.AF.Engine.Core' or one of its dependencies. An attempt was made to load a program with an incorrect format.]
   System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +11524352
   System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +141
   System.Web.HttpRuntime.ProcessRequestNotificationPrivate(IIS7WorkerRequest wr, HttpContext context) +4782309

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T14:39:49.757

看起来 DLL 文件已针对与您的解决方案所构建的系统架构不同的系统架构进行编译。

确保两件事：

您的项目设置为构建为“任何 CPU” - 这可以在 Visual Studio 的项目属性中找到。

IIS 已设置为允许在您的应用程序池中使用 32 位应用程序。

# ruby-on-rails - 检索括号之间的内容

> ID：12675348
> 
> 赞同：0
> 
> 时间：2012-10-01T14:34:07.497
> 
> 标签：ruby-on-rails

我需要检索括号之间的子字符串（不包括括号）：

我尝试了以下操作，但它返回了括号之间的值和括号。我想排除括号。

```
 a= "testing (EMI:30384)"
 a[/\(.*?\)/]   ***returns (EMI:30384) 
```

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:36:27.293

`()`捕获之间

`\(`并`\)`逃脱（）

```
\((.*)\) 
```

将匹配 EMI:30384

![在此处输入图像描述](../Images/471a8ca6994e46438c4195c4d499651c.png)

```
irb(main):005:0> a= "testing (EMI:30384)"
=> "testing (EMI:30384)"
irb(main):006:0> p a.match(/\((.*)\)/)[1]
"EMI:30384" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:37:12.290

您需要在表达式中使用括号返回匹配组，使用`\1`. 更多解释在这里[http://www.railsrocket.com/regular-expressions-in-ruby-and-rails](http://www.railsrocket.com/regular-expressions-in-ruby-and-rails)

```
str = "testing (EMI:30384)"
ptrn = "/\((.*?)\)/"
str.gsub(ptrn, "\1") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T14:44:06.927

作为捕获组的替代方法，您可以使用向后看和向前看，但对于您的用例`a[/(?<=\().*(?=\))/]`给出的确切信息来说，这可能太复杂了`EMI:30384`

# c# - C# 动态 Linq/查询

> ID：12675349
> 
> 赞同：13
> 
> 时间：2012-10-01T14:34:09.503
> 
> 标签：c#, linq-to-sql

**UPDATE2** 我开始更多地使用 James 关于使用反射的建议，并得到了一些工作，它将基于字符串变量返回一个属性值。虽然我觉得这可能不是最好的解决方案，但我还不想把它作为一个答案。这是代码：

```
DataContext dataBase = new DataContext();
List<string> listOfFields = new List<string>;
List<string> listOfUsers = new List<string>

//strFields and strNames are strings generated from listOfFields and listOfUsers
IEnumerable<myUserData> userInfo = dataBase.ExecuteQuery<myUserData>
                       ("select " + strFields + " from myUserData where user_id                          in (" + strNames + ")");    

foreach(var user in userInfo)
{
    foreach(string field in listOfFields)
    {
        string fieldValue = user.GetType().GetProperty(field).GetValue(user,null).ToString
        Console.WriteLine(fieldValue);
    }

} 
```

* * *

**更新：** 我正在进步！我认为。这可能是一个非常糟糕的解决方案和资源消耗，我还不确定，但它比我得到的空白屏幕要好。现在的问题是找到一种只返回值而不是字段名称的方法。这是我的代码：

```
foreach(string userID in listOfUserIDs)
{
    //dataBase is a Datacontext
    var userInfo = dataBase.myTable
                   .Where("user_id == @0", userID)
                   .Select("New(" + strFields + ")");

    foreach(var user in userInfo)
    {
         Console.WriteLine(user);
    }
} 
```

这会输出 {first_name = JOHN, last_name = DOE} 等任何其他字段。我希望我能找到一种方法来修改我的 Select 子句以仅选择值。

* * *

我是一名新手程序员，尤其是 C# 和任何涉及数据库的新手。这是我第一个使用查询和数据库的项目，我遇到了基于动态查询成功返回结果的问题。

我已经成功创建了一个将检索正确信息的查询，但我对如何访问检索到的特定字段感到困惑。

```
IEnumerable<myTable> userInfo = dataBase.ExecuteQuery<myTable>
("select " + Fields + " from myTable where userID in                 
(" + userNames + ")"); 
```

**编辑：**请原谅我的命名约定不好，但 myTable 的类型是：`System.Collections.Generic.IEnumerable<DatabaseConnection.myTable>{System.Data.Linq.SqlClient.SqlProvider.OneTimeEnumerable<DatabaseConnection.myTable>}` 这只是一个占位符名称，在我的数据库中有一个特定的名称。它在 Tables 文件夹中 XD

myTable 的类型是 DatabaseConnection。Fields 是我正在查找的一串字段，而 userNames 是一个由多个用户名组成的字符串，每个用户名用逗号分隔。示例：Fields = "firstName, lastName, idNumber" userNames = "John, Jane, Bob"

我的问题是，是否可以遍历我当前返回的对象类型中每个用户的每个字段？我只看到它像这样明确地完成：

```
 foreach(var x in userinfo)
{
        Console.Writeline(x.firstName);
} 
```

在我目前的情况下，这不起作用，因为用户可能想要与特定用户名相关的其他字段。

我也尝试过使用动态 Linq 库，虽然我能够成功设置我的选择字符串，但当用户 ID 等于几个不同的字符串时，我不确定如何正确设置我的 where 子句。（名字的数量并不总是相同的）

```
var dataInfo = dataBase.myTable
                       .Where("userID == @0", "(" + userIDs + ")")
                       .Select("New(" + fields + ")"); 
```

我已经坚持了好几天了。任何帮助将不胜感激。也许我认为解决方案太简单了？我觉得我应该能够在我的第一段代码中使用 GetProperties() 或类似的东西。

如果这个问题已经得到解答并且我的格式很差（这里的第一篇文章），我也很抱歉。在我的研究过程中，我无法找到我正在寻找的东西，或者我可能只是没有正确理解代码。再次感谢任何帮助！

**编辑：**所有这些都是针对我目前正在开发的 Excel 插件。我需要将信息放入列表或某种形式的对象中，这样我就可以将每个字段结果放入特定的单元格中。

**编辑：**如果我使用了错误的术语，请原谅。我觉得我的错误可能出在我的 Enumerable 类型中，将其命名为“myTable”可能会造成混淆。它是从项目中的 .dbml 文件中的服务器资源管理器中提取的表。

**编辑：**对每个用户运行查询并检索该用户名的每个请求字段是多么低效/耗时？如果我只需要添加一个简单的循环，我会觉得很傻。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:41:45.907

如果我正确理解您的问题并且您只想迭代对象的所有属性（不知道它们在编译时是什么），您可以使用反射，例如

```
foreach (var prop in userInfo.GetType().GetProperties())
{
    Console.WriteLine("Property name: " + prop.Name);
    Console.WriteLine("Property value: " + prop.GetValue(userInfo, null));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T16:49:08.157

由于您似乎只是在使用 LINQ to SQL，因此只需使用 LINQ 来查询数据。我将假设您已经创建了一个 DataContext 模型，并且`MyTable`您的模型中的一个元素包含某种用户信息。

```
using (MyDataContext db = new MyDataContext()) {

    var results = (from m in db.MyTable
                   where m.UserId == userId
                   select m);

    // Loop over all of the rows returned by the previous query and do something with it
    foreach (var m in results) {
        // m represents a single row in the results, do something with it.
        Console.WriteLine(m.UserId);
    }

} 
```

或者，如果您希望查询只返回一行，那么您可以使用`Single`或`SingleOrDefault`将结果投影到单个对象中，而不是结果集合：

```
using (MyDataContext db = new MyDataContext()) {

    var singleResult = (from m in db.MyTable
                        where m.UserId == userId
                        select m).SingleOrDefault();

    // Do something with the single result
    if (singleResult != null) {
        Console.WriteLine(singleResult.UserId);
    }

} 
```

**编辑：**

前面的示例处理了有关如何使用 LINQ 查询兼容数据源的基础知识。大多数 LINQ 提供程序（例如您正在使用的 LINQ to SQL）都支持该`IQueryable`接口。简短的解释是，此接口允许您动态构建查询，并将该查询的实际执行推迟到您实际尝试访问结果的最后一分钟。LINQ 查询返回的对象（例如`results`第一个示例中的变量）返回一个 IQueryable，其中 T 是您查询的对象的类型。它与您可能想到的 a 的意义不同`List<T>`，其中元素已经存在或被显式添加或删除。在第一个示例中，`results`它实际上没有任何元素，直到`foreach`循环尝试迭代结果。

为了处理您的过滤场景，让我们继续构建`results`查询，直到它满足您的需求，然后我们将在它准备就绪时执行它。

首先让我们假设您的表单有三个要过滤的字段：名字、姓氏和用户 ID。为了简单起见，这些字段只是`TextBoxes`，我们知道如果在其对应的`TextBox`. 我们还假设不需要验证，并且用户总是会在过滤器中输入正确的数据。

```
using (MyDataContext db = new MyDataContext()) {

    // Build out your base query, which would return everything from MyTable
    var results = (from m in db.MyTable
                   select m);

    // Check each textbox for a value to filter by.  Add the filter to the base
    // query where necessary.    

    if(!string.IsNullOrEmpty(txtUserId.Text)) {
        results = results.Where(x => x.UserId == (int) txtUserId.Text);
    }

    if(!string.IsNullOrEmpty(txtFirstName.Text)) {
        results = results.Where(x => x.FirstName == txtFirstName.Text);
    }

    if(!string.IsNullOrEmpty(txtLastName.Text)) {
        results = results.Where(x => x.LastName == txtLastName.Text);
    }

    // Loop over all of the rows returned by the previous query and do something with it.  
    // THIS is the actual point that the SQL would be generated from the query you've 
    // built and executed against the DB.  The elements returned by `results` 
    // should only meet all of the filters that you the user entered for one or
    // more of the fields.  Not entering any data would have resulted in all rows being
    // returned
    foreach (var m in results) {
        // m represents a single row in the results, do something with it.
        Console.WriteLine(m.UserId);
    }

} 
```

上面的示例非常简单，但它代表了您希望将一定数量的字段组合在一起的典型过滤场景。我确信有更优雅的方式来封装构建查询过滤器，但核心概念仍然是相同的。只需使用`IQueryable<T>`接口并将过滤器表达式链接到它上面。

这样做只允许您使用 AND 将谓词链接在一起，并且您不能执行诸如“用户 ID 为 6 或名字为 'John'”之类的操作。您可以使用`System.Linq.Expressions`命名空间来构建更复杂的表达式来构建 LINQ 表达式，但这些表达式相对复杂并且在大多数情况下不是必需的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T09:25:29.147

虽然我没有尝试过 DataContext（或 .NET 4.5），但在 4.0 中，您可以使用动态类直接访问字段：

```
IEnumerable<dynamic> userInfo = (from user in users
                                 where user.id equals userId
                                 select new { user.name, user.id /*, ...*/ }).ToList();

foreach (dynamic user in userInfo)
{
    Console.WriteLine(user.name);
    Console.WriteLine(user.id);
    //...
} 
```

dynamic 表示一个在运行时解析的类，因此即使在编码时看不到智能感知显示字段，只要它们正确，它就会起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T12:24:09.677

在更新 2 之后：

您可能可以将嵌套的 foreach 简化为一些 linq。就像是：

```
 PropertyInfo[] props = typeof(MyUserData).GetProperties();

        var results = from info in userInfo
                      from p in props
                      where listOfFields.Contains(p.Name)
                      select new
                      {
                          FieldName= p.Name,
                          UserId= info.UserId,
                          FieldValue= p.GetValue(info, null)
                      };

        foreach (var item in results)
        {
            Console.WriteLine("(userId = {0}) {1} = {2}", item.UserId, item.FieldName, item.FieldValue);
        } 
```

# mysql - Mysql加入带有计数条件的数据透视表

> ID：12675359
> 
> 赞同：0
> 
> 时间：2012-10-01T14:34:37.547
> 
> 标签：mysql

有没有办法计算已左连接的数据透视表，然后再次在数据透视表上运行 where 子句以过滤掉不需要的其余部分？

以下是我到目前为止的内容：

```
SELECT *
FROM 
      (
          SELECT COUNT(user_id) as Count
          FROM group_buys
      ) GroupBuy
      LEFT JOIN group_buy_users GroupBuysUser
          ON GroupBuysUser.group_buy_id = GroupBuy.id
WHERE GroupBuysUser.user_id = {$this->Auth->user('id')} 
```

我找到了一个解决方案：

```
SELECT *
        FROM group_buys GroupBuy
        LEFT JOIN group_buy_users GroupBuysUser
        ON GroupBuysUser.group_buy_id = GroupBuy.id
        LEFT JOIN (
            SELECT group_buy_id, COUNT(user_id) as Count
            FROM group_buy_users
            GROUP BY group_buy_id
        ) GroupBuysUserCount
        ON GroupBuysUserCount.group_buy_id = GroupBuy.id
        LEFT JOIN group_buy_merchant_offers GroupBuysMerchantOffer
        ON GroupBuysMerchantOffer.group_buy_id = GroupBuy.id
        WHERE GroupBuysUser.user_id = {$this->Auth->user('id')}
        GROUP BY GroupBuy.id
        HAVING GroupBuy.expiry_date > NOW()
        ORDER BY GroupBuysMerchantOffer.bid_price ASC 
```

基本上我只需要做一个 LEFT JOIN 一个虚拟表，该表已经在其 id 上使用团购计数，然后在 user_id 所属的用户上使用 where 子句，然后在 Groupbuy.id 上再次分组以消除重复项。我添加了到期，因为我必须删除所有已过期的旧团购，但这添加了 group_buy_users 表中的组用户计数，然后又添加了 group_buy_users 表，这样我也可以检索其他详细信息。

# c# - 仅在单击时才加载每个子“文件夹”的层次结构 C# 组件？

> ID：12675364
> 
> 赞同：2
> 
> 时间：2012-10-01T14:34:58.090
> 
> 标签：c#, .net, treeview, .net-4.5, treeviewitem

我正在修改一个使用UI 元素[的 Windows 应用程序](https://github.com/nicolas-raoul/CmisSync/tree/master/SparkleShare/Windows)， 我想让用户从层次结构中选择一个项目，所以看起来像这样：`System.Windows.Control`

![树](../Images/6a7449e1da25cedafe4efa0e1814d91b.png)

除了它不是文件夹，而是一个巨大的远程对象层次结构，非常深且检索缓慢。
在显示之前加载整个层次结构会太慢，我必须显示第一级，然后在用户单击它时显示在文件夹中。

我正在考虑`System.Windows.Control.TreeView`在元素上使用 a 和拦截选择事件`TreeViewItem`来在需要时填充它们。
**问题：**这是最佳实践策略，还是有`System.Windows.Control`更适合此的 UI 元素？

读取单击的元素的每个文件夹的内容的组件也是可以接受的。
该应用程序使用`.NET 4.5`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T07:24:34.687

如果我理解正确，您希望仅在父节点展开时才加载子节点（例如，通过单击其展开图标）。从用户体验的角度来看，在节点扩展时加载子节点确实听起来比在节点选择时加载它们更好。

我不知道有什么开箱即用的功能，但是您可以轻松地自己构建一个。我看到的方法是在每个尚未获取其子节点的节点下添加一个*虚拟节点*，并在扩展节点的事件处理程序中检查它是否有一个虚拟节点，如果有则加载其实际子节点并用它们替换假人。

虚拟节点使其父节点看起来是可展开的（例如，有一个“+”图标或折叠的三角形），这可能是您所需要的。如果您输入“（正在加载...）”或诸如假人的标题之类的名称，您将从中获得不错的用户体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T03:52:59.287

1）创建树视图：

```
System.Windows.Controls.TreeView treeView = new System.Windows.Controls.TreeView();
ContentCanvas.Children.Add(treeView); 
```

2）插入根项目：

```
System.Windows.Controls.TreeViewItem root = new System.Windows.Controls.TreeViewItem();
root.Header = repository;
treeView.Items.Add(root); 
```

3）选择一个项目时，根据需要添加子项：

```
treeView.SelectedItemChanged += delegate
{
    TreeViewItem item = (TreeViewItem)treeView.SelectedItem;
    SparkleLogger.LogInfo("bla", "object:"+item);
    System.Windows.Controls.TreeViewItem subItem = new System.Windows.Controls.TreeViewItem();
    subItem.Header = "hello";
    item.Items.Add(subItem);
}; 
```

添加必须仅在第一次选择时完成，否则元素将被复制。
任何更好的解决方案都将受到热烈欢迎！

# pdf - 如何使用 Ghostscript 设置自定义页面大小

> ID：12675371
> 
> 赞同：27
> 
> 时间：2012-10-01T14:35:11.827
> 
> 标签：pdf, ghostscript

我以 600 dpi，~ 9.36x12.67 英寸扫描了一些材料，并准备好 PostScript (PS) 格式。

现在，当我尝试使用 Ghostscript (GS) 将 PS 转换为 PDF 时，我得到了剪辑输出，因为我假设 GS 的默认页面大小设置为 A4。我在这里找到了 GS 的可用模板：[http](http://www.ghostscript.com/doc/9.06/Use.htm#Known_paper_sizes) ://www.ghostscript.com/doc/9.06/Use.htm#Known_paper_sizes但没有一个与我的 PS 文件的尺寸非常匹配，所以：

我可以指示 GS 输出自定义尺寸吗？如果可以，怎么做？

`-sPAPERSIZE`指令似乎只接受预定义的模板名称，如链接文档中所示。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-01T14:53:39.400

您可以设置使用的页面大小，`-gNNNNxMMMM`其中 NNMN 是 720 dpi 时的*像素*宽度（720 像素 == 1 英寸），MMMM 是 720 dpi 时的像素高度。

或者您*可以*使用`-dDEVICEWIDTHPOINTS=w -dDEVICEHEIGHTPOINTS=h`.

如果我没记错的话，*9.36 inch ≈= 674 points*和*12.67 inch ≈= 912 points*。

您还必须申请`-dPDFFitPage`才能使您的输入适合页面。

所以你可以使用

```
gs                          \
   -o output.pdf            \
   -sDEVICE=pdfwrite        \
   -dDEVICEWIDTHPOINTS=674  \
   -dDEVICEHEIGHTPOINTS=912 \
   -dPDFFitPage             \
    input.ps 
```

或者

```
gs                   \
   -o output.pdf     \
   -sDEVICE=pdfwrite \
   -r600             \
   -g8112x7596       \
   -dPDFFitPage      \
    input.ps 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-04T18:22:29.120

什么对我有用：

`gs -sDEVICE=pdfwrite -r720 -g4308x6066 -dPDFFitPage -o out.pdf in.pdf`

`4308x6066`是像素数，是`-r720`每英寸的像素数。

所以这里我们有 720dpi，例如 5 英寸，这将是 3600 像素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-15T19:55:19.827

我正在使用 GhostPDL 9.10，虽然我的 8.5x13 纸张尺寸在[https://www.ghostscript.com/doc/current/Use.htm#Known_paper_sizes](https://www.ghostscript.com/doc/current/Use.htm#Known_paper_sizes)`flsa`中列出，因为`-sPAPERSIZE=flsa`开关没有效果，但纸张尺寸仍然是 Letter。

`-g5100x7800`开关的正确单位匹配我的`-r600`（不是`720`）；`-g`作品。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-24T05:52:45.600

我发现`gs`即使我已将页面强制设置为最大标准尺寸 A0，它仍在裁剪我的输出。

原因是/发送到的 PostScript 文档`gs`包含覆盖Ghostscript 选择的规范。`groff``grops``%%DocumentMedia`

解决方案是给出`groff`命令行标志`-p-P48i,48i`。`-p`告诉将`groff`选项的其余部分传递给`grops`. 将纸张尺寸设置`-P48i,48i`为`grops`48 英寸 x 48 英寸。

# jquery - div内的CSS中心图像

> ID：12675373
> 
> 赞同：0
> 
> 时间：2012-10-01T14:35:24.977
> 
> 标签：jquery, html, css

我需要建立一个包含所有 1600 像素宽的大型高分辨率图像的网站，无论浏览器屏幕尺寸如何，我都需要将其居中放在屏幕上。

这些图像的设计使它们在 1024 像素的中心看起来很好，但需要始终从中心而不是顶部和左侧固定显示。

有没有人有一个解决方案 - 理想情况下适合图像的内联和背景版本！？

CSS3 解决方案很好，因为我的目标是 ie8 plus。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T14:37:32.493

因为你没有提供任何明确的 HTML 标记，只是对你的问题的一般描述，我为你提供了一个链接到[http://css-tricks.com/centering-in-the-unknown/](http://css-tricks.com/centering-in-the-unknown/) 在这里你可以找到各种 CSS 技术使内容垂直和水平居中。

jQuery 不需要将内容居中，我相信您将使用适当的 HTML 标记和一些 CSS 来管理它。

不过， Fiddle ( [http://jsfiddle.net](http://jsfiddle.net) ) 会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:11:15.293

您的意思是图像将保持相同的大小，但即使您只查看图像的中心部分，也设计得很好看？如果是这样...

```
<img href="..." class="centered" />

.centered {
    position:fixed; top:50%; left:50%;
    width:1600px; height:800px;
    margin: -400px 0px 0px -800px;
    } 
```

这将使 1600x800 像素的图像居中。只需将上边距更改为图像高度的负数。

不需要声明尺寸，只是为了说明而添加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:42:22.110

对我有用的是将图像放入带有 id 背景的 div 中，紧跟在 body 之后，然后使用这个 CSS：

```
#background {
    z-index: -1;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T18:03:59.990

两种方式：

*   使用背景图像

    这个很简单，CSS代码如下

    ```
    div.image-wrapper {
        background: url('imgs/example.png') no-repeat center;
    } 
    ```

    *   使用 IMG 标签

    这是HTML：

    ```
    <div id="img-area">
        <img src="imgs/example.png"/>
    </div> 
    ```

    CSS：

    ```
    #img-area img {
        display:block; //this will let us use margin auto
        margin:auto;
        top: (n)px;  //you can obtain 'n' by using JavaScript
    } 
    ```

    或者您可以使用 [http://css-tricks.com/centering-in-the-unknown/](http://css-tricks.com/centering-in-the-unknown/)中概述的方法；这将使您免于使用 javascript。

# android - 使用自己的数据库

> ID：12675375
> 
> 赞同：0
> 
> 时间：2012-10-01T14:35:35.547
> 
> 标签：android, sqlite

我为我的项目创建了自己的数据库，但在将其推送到数据/数据文件夹时遇到了麻烦。
我首先在我的手机上对其进行了测试，并成功推送了我创建的数据库。
现在我在另一部手机上测试它时遇到问题。我收到一个错误

```
android.database.sqlite.SQLiteException: no such table: tblFirstAid: , while compiling: SELECT faName FROM tblFirstAid 
```

我将我的数据库放在资产文件夹中，它在我的手机上运行良好。
我将为其添加什么代码以从资产文件夹中复制文件并将其推送到 /data/data 目录中。
我已经尝试过一个规则设计，但我得到了那个错误。

这是我的数据库助手类

```
package com.dr.droid.lee;

import java.io.IOException;
import java.util.ArrayList;

import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.net.http.SslCertificate.DName;
import android.util.Log;

public class DbHelper {

    public static final String Row_id = "_id";
    public static final String Row_Name = "faName";
    public static final String Row_Desc = "faInfo";
    private static final String db_Name = "dbDrDroid";
    private static final String db_Table = "tblFirstAid";
    private static final String db_HTable = "tblHospitals";
    private static final String Row_HosName = "HospitalName";
    private static final String Row_HosAdd = "Address";
    private static final String Row_HosReg = "Region";
    private static final String Row_HosCity = "City";
    private static final String Row_HosContact = "Contact";
    private static final String Row_dName = "dName";
    private static final String Row_dTable = "tblDisease";
    private static final int db_Version = 1;
    private dbhelp ourhelper;
    private static Context ourcontext;
    private SQLiteDatabase ourDB;

    private static class dbhelp extends SQLiteOpenHelper{

        public dbhelp(Context context) {
            super(context, db_Name, null, db_Version);
            // TODO Auto-generated constructor stub
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            // TODO Auto-generated method stub

            db.execSQL("CREATE TABLE IF NOT EXISTS " + db_Table + " (" + Row_id + " INTEGER PRIMARY KEY AUTOINCREMENT, "
                + Row_Name + " TEXT NOT NULL, "
                + Row_Desc + " TEXT NOT NULL)" );

        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            // TODO Auto-generated method stub
            db.execSQL("DROP TABLE IF EXISTS" + db_Table);
            onCreate(db);

        }

    }

    public DbHelper (Context c){
        ourcontext= c;
    }

    public DbHelper open(){
        ourhelper = new dbhelp(ourcontext);
        ourDB = ourhelper.getWritableDatabase();
        return this;
    }

    public void   close(){
        ourhelper.close();
    }

    public ArrayList<String> getFAData() {
        // TODO Auto-generated method stub
        ArrayList<String> comments = new ArrayList<String>();
        String [] columns = new String[]{Row_Name};
        Cursor c = ourDB.query(db_Table, columns, null, null, null, null, null);
        int iRow = c.getColumnIndex(Row_Name);
        c.moveToFirst();
        while (!c.isAfterLast()) {          
            comments.add(c.getString(iRow));
            c.moveToNext();
        }

        c.close();
        return comments;
    }

    public ArrayList<String> getHData(){
        ArrayList<String>  res = new  ArrayList<String>();
        String [] columns = new String []{Row_HosName};
        Cursor h = ourDB.query(db_HTable, columns, null, null, null, null, Row_HosName);
        int HRow = h.getColumnIndex(Row_HosName);
        h.moveToFirst();
         while (!h.isAfterLast()) {          
                res.add(h.getString(HRow));
                h.moveToNext();
            }

            h.close();
            return res;

    }

    public ArrayList<String> getDData(){
        ArrayList<String>  res = new  ArrayList<String>();
        String [] columns = new String []{Row_dName};
        Cursor d = ourDB.query(Row_dTable, columns, null, null, null, null, null);
        int HRow = d.getColumnIndex(Row_dName);
        d.moveToFirst();
         while (!d.isAfterLast()) {          
                res.add(d.getString(HRow));
                d.moveToNext();
            }

            d.close();
            return res;

    }

} 
```

这是我从规则设计中使用的课程

```
package com.dr.droid.lee;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import android.content.Context;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteException;
import android.database.sqlite.SQLiteOpenHelper;

public class DataBaseHelper extends SQLiteOpenHelper{

    //The Android's default system path of your application database.
    private static String DB_PATH = "/data/data/com.dr.droid.lee/databases/";

    private static String DB_NAME = "dbDrDroid";

    private SQLiteDatabase myDataBase; 

    private final Context myContext;

    /**
     * Constructor
     * Takes and keeps a reference of the passed context in order to access to the application assets and resources.
     * @param context
     */
    public DataBaseHelper(Context context) {

        super(context, DB_NAME, null, 1);
        this.myContext = context;
    }   

  /**
     * Creates a empty database on the system and rewrites it with your own database.
     * */
    public void createDataBase() throws IOException{

        boolean dbExist = checkDataBase();

        if(dbExist){
            //do nothing - database already exist
        }else{

            //By calling this method and empty database will be created into the default system path
               //of your application so we are gonna be able to overwrite that database with our database.
            this.getReadableDatabase();

            try {
                this.close();
                copyDataBase();

            } catch (IOException e) {

                throw new Error("Error copying database");

            }
        }

    }

    /**
     * Check if the database already exist to avoid re-copying the file each time you open the application.
     * @return true if it exists, false if it doesn't
     */
    private boolean checkDataBase(){

        SQLiteDatabase checkDB = null;

        try{
            String myPath = DB_PATH + DB_NAME;
            checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);

        }catch(SQLiteException e){

            //database does't exist yet.

        }

        if(checkDB != null){

            checkDB.close();

        }

        return checkDB != null ? true : false;
    }

    /**
     * Copies your database from your local assets-folder to the just created empty database in the
     * system folder, from where it can be accessed and handled.
     * This is done by transfering bytestream.
     * */
    private void copyDataBase() throws IOException{

        //Open your local db as the input stream
        InputStream myInput = myContext.getAssets().open(DB_NAME);

        // Path to the just created empty db
        String outFileName = DB_PATH + DB_NAME;

        //Open the empty db as the output stream
        OutputStream myOutput = new FileOutputStream(outFileName);

        //transfer bytes from the inputfile to the outputfile
        byte[] buffer = new byte[1024];
        int length;
        while ((length = myInput.read(buffer))>0){
            myOutput.write(buffer, 0, length);
        }

        //Close the streams
        myOutput.flush();
        myOutput.close();
        myInput.close();

    }

    public void openDataBase() throws SQLException{

        //Open the database
        String myPath = DB_PATH + DB_NAME;
        myDataBase = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);

    }

    @Override
    public synchronized void close() {

            if(myDataBase != null)
                myDataBase.close();

            super.close();

    }

    @Override
    public void onCreate(SQLiteDatabase db) {

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

    }
} 
```

如果我没有将数据库推送到手机中，我仍然会遇到一些错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:57:36.753

我假设您的 DB_NAME 与您的资产文件夹中存在的数据库不同。

如果您遵循“reigndesign”，请检查此行：

```
private static String DB_NAME ="myDBName"; 
```

DB_NAME 这里是您的数据库的名称。假设您在 assets 文件夹中有数据库的副本。您的 DB_NAME 必须与 assets 文件夹中存在的相同。

或者

按照[这个](https://stackoverflow.com/questions/9109438/how-to-use-existing-database-with-android-app/9109728#9109728)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:11:52.923

当你给它一个不存在的文件名时，SQLite 会愉快地创建一个新的空数据库。

确保用于复制和打开数据库的文件名相同。

# xslt - 获取 xml 记录中的最新日期

> ID：12675377
> 
> 赞同：9
> 
> 时间：2012-10-01T14:35:42.000
> 
> 标签：xslt, biztalk

我的数据模型如下：

```
<Club>
<Captain>
<Name></Name>
<DateOfBirth>15-01-1985</DateOfBirth>
</Captain>
<PlayingStaff>
<Player>
<DateOfBirth>14-01-1993</DateOfBirth>
</Player>
<Player>
<DateOfBirth>07-12-1975</DateOfBirth>
</Player>
<Player>
<DateOfBirth>11-11-1991</DateOfBirth>
</Player>
</PlayingStaff>
</Club> 
```

我尝试使用此处给出的答案：[XSLT：获取最新日期](https://stackoverflow.com/questions/684894/xslt-getting-the-latest-date/684964#684964)，但它没有给我任何价值。

我试图让最年轻的玩家传递给外部函数。

我在 Biztalk 中这样做，所以我必须坚持使用 XSLT1

到目前为止，我的工作如下：

```
<xsl:variable name="youngestPlayer">
            <xsl:for-each select="$ClubRoot/*[local-name()='PlayingStaff']/*[local-name()='Player']">
                <xsl:sort select="./*[local-name()='DateOfBirth']" order="descending"/>
                <xsl:if test="position() = 1">
                    <xsl:value-of select="DateOfBirth"/>
                </xsl:if>
            </xsl:for-each>
        </xsl:variable>
        <xsl:variable name="IsYoungestPlayerUnderAgeLimit" select="externalfunctionreturningboolean">
            <xsl:element name="blahhh"><xsl:value-of select="$IsYoungestPlayerUnderAgeLimit"/></xsl:element>
            <xsl:element name="blahhh"><xsl:value-of select="$youngestPlayer"/></xsl:element> 
```

这是一个大模板的一部分——我不能真正改变它，但 ClubRoot 的值是 "`<xsl:variable name="ClubRoot" select="/*[1]"/>"`以确保我可以读取它的子节点。

我总是得到

```
<blahhh>false</blahhh>
<blahhh/> 
```

作为我的调试值......所以我没有得到我期望的值

有人可以强调我哪里出错了吗？

根据上面的数据，我预计我的 youngestPlayer 变量中的值为 14-01-1993。但它是空白的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T15:52:05.487

问题是 XSLT1.0 并没有真正的日期概念，因此您可以有效地按**DateOfBirth**元素进行排序，就好像它们只是普通字符串一样。如果您可以确定日期始终采用 DD-MM-YYYY 格式，您可以使用字符串操作按年、月和日排序

```
<xsl:sort select="number(substring(DateOfBirth, 7, 4))" order="descending"/>
<xsl:sort select="number(substring(DateOfBirth, 3, 2))" order="descending"/>
<xsl:sort select="number(substring(DateOfBirth, 1, 2))" order="descending"/> 
```

因此，给定以下 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>
   <xsl:template match="/Club">
      <xsl:for-each select="PlayingStaff/Player">
         <xsl:sort select="number(substring(DateOfBirth, 7, 4))" order="descending"/>
         <xsl:sort select="number(substring(DateOfBirth, 3, 2))" order="descending"/>
         <xsl:sort select="number(substring(DateOfBirth, 1, 2))" order="descending"/>

         <xsl:if test="position() = 1">
            <xsl:value-of select="DateOfBirth"/>
         </xsl:if>
      </xsl:for-each>
   </xsl:template>
</xsl:stylesheet> 
```

当应用于您的 XML 时，将输出以下内容

```
14-01-1993 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-02T09:49:02.483

链接参考中的日期排序“有效”的原因是它采用`yyyy-MM-dd`格式，而不是您的`dd-MM-yyyy`格式。

Tim C / Sean 的建议的替代方法是使用 C# 脚本函数（因为您正在使用 BizTalk）根据您的链接将日期恢复为可排序的日期 - 但请注意，这不太可能与本机 xslt 函数一样高效。另请注意，您可能需要在变量上使用[msxsl:node-set](https://stackoverflow.com/questions/5302535/xsl-store-node-set-in-variable)来告诉 BizTalk 的解析器这是一个片段。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:userCSharp="http://schemas.microsoft.com/BizTalk/2003/userCSharp"
                xmlns:msxsl="urn:schemas-microsoft-com:xslt"
                exclude-result-prefixes="userCSharp msxsl"
                >
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="/">
        <xsl:variable name="ClubRoot" select="/*[1]"/>
        <xsl:variable name="orderedPlayers">
            <xsl:for-each select="msxsl:node-set($ClubRoot)/*[local-name()='PlayingStaff']/*[local-name()='Player']">
                <xsl:sort select="userCSharp:makeSortableDate(string(*[local-name()='DateOfBirth']), 'dd-MM-yyyy')" order="descending"/>
                <xsl:copy-of select="node() | @*"/>
            </xsl:for-each>
        </xsl:variable>

        <xsl:variable name="youngestPlayerDOB">
            <xsl:value-of select="msxsl:node-set($orderedPlayers)[1]/DateOfBirth/text()" />
        </xsl:variable>

        <xsl:element name="blahhh">
            <xsl:variable name="IsYoungestPlayerUnderAgeLimit" select="userCSharp:externalfunctionreturningboolean($youngestPlayerDOB)" />
            <xsl:value-of select="$IsYoungestPlayerUnderAgeLimit"/>
        </xsl:element>
        <xsl:element name="blahhh">
            <xsl:value-of select="$youngestPlayerDOB"/>
        </xsl:element>
    </xsl:template>

    <msxsl:script language="C#" implements-prefix="userCSharp">
        <![CDATA[
        public System.String makeSortableDate(System.String yourDate, string format)
        {
            return (System.DateTime.ParseExact(yourDate, format, System.Globalization.CultureInfo.InvariantCulture).ToString("yyyy-MM-dd"));
        }

        public bool externalfunctionreturningboolean(System.String dobString)
        {
            System.DateTime someDate;
            if (System.DateTime.TryParse(dobString, out someDate))
            {
                // NB : Doesn't work out leap years correctly!
                if ((System.DateTime.Now - someDate).Days < 21 * 365.25)
                {
                    return true;
                }
            }
            return false;
        }
    ]]>
    </msxsl:script>

</xsl:stylesheet> 
```

我对函数进行了破解，并猜测未成年人限制为 21 岁。以上返回

```
<blahhh>true</blahhh>
<blahhh>14-01-1993</blahhh> 
```

# objective-c - iOS 6 UIGestures (Tap) 停止使用 QLPreviewController

> ID：12675378
> 
> 赞同：4
> 
> 时间：2012-10-01T14:35:45.460
> 
> 标签：objective-c, ipad, ios5, ios6, qlpreviewcontroller

目前我在导航控制器中使用 QLPreviewController。（推视图控制器）

为了隐藏导航栏，我使用了 UITapGestureRecognizer。用户可以通过单击（点击）显示/隐藏导航栏。这在 iOS5 中运行良好

```
- (void)viewWillAppear:(BOOL)animated {
   [super viewWillAppear:animated];

   UITapGestureRecognizer *tapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapped:)];
   [tapRecognizer setNumberOfTapsRequired:1];
   [tapRecognizer setDelegate:self];
   [[self view] addGestureRecognizer:tapRecognizer];
   [tapRecognizer release];
}

- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer {
    return YES;
}

- (void)tapped:(UIGestureRecognizer*)gestureRecognizer
{
    //hide -/- show navigation bar
    [[self navigationController] setNavigationBarHidden:![[[self navigationController] navigationBar] isHidden] animated:YES];
} 
```

但是在 iOS 6 的发布版本中，现在完全忽略了点击，所以我不能再隐藏我的导航栏了。

**为什么我要隐藏导航栏？**

如果您打开 .numbers 文档，导航栏会隐藏导航栏下方的“工作表按钮”。

泰。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-11T15:17:11.650

由于 ios 6 QLPreviewController 实际上是一个完全独立的应用程序（独立的进程和一切）

苹果为此使用 XPC：

*   [http://oleb.net/blog/2012/10/remote-view-controllers-in-ios-6/](http://oleb.net/blog/2012/10/remote-view-controllers-in-ios-6/)
*   > > [https://twitter.com/eldudi/statuses/253438028163457024](https://twitter.com/eldudi/statuses/253438028163457024)

=> 所以当你按下它时，你的整个应用程序都会移动到 bg，包括它的窗口和手势识别器

# android - 片段堆栈问题

> ID：12675383
> 
> 赞同：0
> 
> 时间：2012-10-01T14:36:15.693
> 
> 标签：android, fragment

我的平板电脑中有 2 个窗格。左边是列表，右边会根据选择显示每个列表项的详细信息。在我的右窗格中，我为每个选定的列表项显示了一系列片段。问题是当我单击序列中的第二个片段时，它必须显示第三个片段，但是它首先显示几秒钟，然后将显示第三个片段。所有这些都在第二个窗格中它就像在第二个窗格中的 1 个项目单击 1 个片段 -> 显示 2 个片段-> 单击 2 个片段-> 显示 1（几秒钟）-> 显示 3 个片段->

但它应该像 Click on 1 -> Display 2 -> Click on 2 -> Display 3 ->

我需要做一些事情来正确设置 Fragment 堆栈

请检查以下代码

```
@Override
public void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);

    if (selected_item != null)
        if (selected_item != v) {
            if (selct_item_bg_color != 0)
                selected_item.setBackgroundColor(Color
                        .alpha(selct_item_bg_color));
            else {
                int rgb = Utill.hex2decimal("D2");
                //int rgb3=Utill.hex2decimal("82");
                selected_item.setBackgroundColor(Color.rgb(rgb, rgb, rgb));
                //selected_item.setBackgroundColor(Color.GRAY);
                Log.e("", "DEFAULT NOT SELECTED");
            }
        }
    selected_item = v;
    selct_item_bg_color = v.getDrawingCacheBackgroundColor();

    selected_item.setBackgroundDrawable(v.getContext().getResources()
            .getDrawable(R.drawable.list_selector));
    Log.e("POSITION", "SELECTED ITEM POSITION : " + position);

    FragmentManager frMgr = this.getFragmentManager();
    FragmentTransaction xaction = frMgr.beginTransaction();
    switch (position) {
    case 0:
        ScheduleFragment sc_fragment = new ScheduleFragment();
        xaction.add(R.id.second_pane, sc_fragment, "itinerary");
        xaction.commit();
        break;
    case 1:
        ItineraryFragment it_fragment = new ItineraryFragment();
        xaction.add(R.id.second_pane, it_fragment, "itinerary");
        xaction.commit();
        break;
    case 2:
        VenueFragment vn_fragment = new VenueFragment();
        xaction.add(R.id.second_pane, vn_fragment, "Venue");
        xaction.commit();
        break;
    case 3:
        Bundle sendData=new Bundle();
        sendData.putString("URL", URL+utilclass.getMyDbHelper().getToken());
        sendData.putString("TITLE", "Search");
       //intent.putExtra("URL", URL+utilclass.getMyDbHelper().getToken());
        //intent.putExtra("TITLE", "Search");

        SearchWebFragment sw_fragment = new SearchWebFragment();
        sw_fragment.setArguments(sendData);
        xaction.add(R.id.second_pane, sw_fragment, "searchWeb");
        xaction.commit();
        break;

    default: Log.e("","Please Choose Right option");

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T09:19:25.073

```
 I make it done by setting transaction to close using the below statement

    transaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_CLOSE);

   used as: 

    FragmentTransaction transaction = getFragmentManager().beginTransaction();
    Fragment frag=new AbstractAuthorsFragment();
    transaction.replace(R.id.second_pane, frag);
    transaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_CLOSE);
    transaction.addToBackStack(null);
    transaction.commit(); 
```

# eclipse - nSight eclipse版远程交叉编译和执行

> ID：12675384
> 
> 赞同：2
> 
> 时间：2012-10-01T14:36:16.143
> 
> 标签：eclipse, cuda, cross-compiling, nsight

我下载了 nVidia CUDA 5.0，因为我想尝试 nSight Eclipse 版本因为我是 Mac 用户，这对我来说很有意义。它工作得很好，但我真正想做的是在我的外部机器（家里和亚马逊）上远程编译和执行（和调试）代码，这些机器基本上是 Linux 机器。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T16:39:07.270

感谢您对 Nsight Eclipse 版的关注。不幸的是，当前版本的 Nsight EE 不支持远程开发，因此在另一个系统上进行开发的唯一方法是在系统本身上运行 Nsight（例如使用 VNC）。我们了解远程开发是我们产品非常重要的使用场景，我们正在积极探索在我们产品的未来版本中提供这些功能的方法。

另请注意，您可能无法在 VM 环境（例如 Amazon 云）中调试 CUDA 应用程序。

# excel - 使用 VBA 在 excel 2007 中插入超链接

> ID：12675385
> 
> 赞同：0
> 
> 时间：2012-10-01T14:36:17.020
> 
> 标签：excel, hyperlink

我的工作表“输入”范围“ `B11`”已生成目标 URL：

```
file:///C:/Results/H1230-01%20VEF%201288.doc 
```

我的工作表“输入”范围“ `B10`”已生成文本：

```
H1230-01 VEF 1288 
```

如何使用单元格中显示的文本自动插入目标 URL 的超链接？：

```
Worksheets("VEF").Range("m65536").End(xlUp).Offset(1, 0).Select 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:13:56.940

使用超链接公式示例：

```
=HYPERLINK("path","Text To Display") 
```

或使用代码：

```
Range.Formula = "=HYPERLINK(""path"",""Text To Display"") 
```

或使用您的实际参考使用以下公式：

```
=HYPERLINK(B11,B10) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:15:55.777

您也可以使用该`Hyperlink.Add`方法，例如 Excel-Help 中的此示例

```
With Worksheets("VEF")
    .Hyperlinks.Add Anchor:=.Range("m65536").End(xlUp).Offset(1, 0), _
        Address:=.Range("B11"), _
        ScreenTip:="Microsoft Web Site", _
        TextToDisplay:=.Range("B10")
End With

With Worksheets(1)
    .Hyperlinks.Add Anchor:=.Range("a5"), _
        Address:="http://example.microsoft.com", _
        ScreenTip:="Microsoft Web Site", _
        TextToDisplay:="Microsoft"
End With 
```

# mysql - 如何将不同表列中的数据显示到一个表列中

> ID：12675386
> 
> 赞同：0
> 
> 时间：2012-10-01T14:36:17.657
> 
> 标签：mysql, sql, database, sql-server-2008, relational-database

我正在尝试从 SQL2008 中一个数据库的不同表（具有相同名称）列中获取一个表列中的数据。

我使用不同的表主键列名创建了一个表（例如-我的新表看起来像

位置、客户、服务、渠道、每月周期......这些表已经创建。我正在尝试获取其他表中的每个表列值。（例如 - 新位置表列中的现有 Lacation 表列值。

请帮我。提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:55:30.950

这不是很清楚，但看起来您想将一个表的内容插入到另一个具有相同架构的表中。

假设您的表有三列 Location Customer 和 Service，并且具有相同架构的表是 Customer 和 Customer1，然后将第一个表的所有行插入到第二个表中，如下所示：

```
INSERT INTO Customer1
SELECT     Location, Customer, Service
FROM         Customer 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T23:51:44.037

嗨，在 sql server 中，您必须使用别名来执行此操作，例如您的查询中的示例

```
SELECT     Location =C.Location
           ,Customer =C.Customer
           ,Service =C.Service
           ,Location2=(SELECT B.Location FROM Table2 B  where     B.customerid=C.customerid)
    FROM   Customer C --  Use alais names 
```

# objective-c - 如何在 ARC 中释放对象

> ID：12675395
> 
> 赞同：3
> 
> 时间：2012-10-01T14:36:55.837
> 
> 标签：objective-c, automatic-ref-counting

虽然我通常在 Xcode 中使用 ARC 模式，但有时，我仍然需要释放一些 temp obj。我不知道如何使用它。这是一个例子：

TestViewController.h 文件

```
TestViewController
{
    A* a;
    A* b;
} 
```

TestViewController.m 文件

```
viewDidLoad()
{
   a = [[A alloc] init];
   b = a;

   [a release];
   // I want to release a here, but when I use [a release], there will be a build error. "release is unavailable: not available in ARC mode"
} 
```

谁能给我一些线索？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T14:40:11.347

ARC 会为您解决这个问题。没有理由手动释放`a`。无论如何这样做都是不正确的，因为`a`仍然指向对象。

但是您仍然不应该以这种方式直接访问您的 ivars。虽然 ARC 会做正确的事情（稍后会详细介绍），但它会导致许多其他问题。始终使用除 in`init`和之外的访问器`dealloc`。这应该是：

```
@interface TestViewController
@property (readwrite, strong) A* a;
@property (readwrite, strong) A* b;
@end

@implementation TestViewController
- (void)viewDidLoad {
    self.a = [[A alloc] init];
    self.b = self.a;
} 
```

至于 ARC 在您的代码中实际执行的操作，它将插入所需的保留，如下所示：

```
A* tmp = [[a alloc] init];
[a release];
a = tmp;
A* tmp2 = [a retain];
[b release];
b = tmp2; 
```

如果您不想`a`指向旧值，请将其设置`nil`为 Michael notes。这与保留和释放无关。专注于对象图。你希望每件事指向什么？ARC 将处理保留计数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:39:16.497

`a = nil;`应该做你想做的事。

但是，您创建的对象将被分配`b`并保留`b`。

# java - 使用 java 7 语法编译成 java 5

> ID：12675400
> 
> 赞同：3
> 
> 时间：2012-10-01T14:37:19.780
> 
> 标签：java, syntax, cross-compiling, java-7

有什么方法可以使用 java 7 语法并生成适用于 1.5 的字节码？据我所知，选项`-target`并`-source`不能有所不同。检查是否没有使用新的 API 也很好，但并不重要

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:46:11.440

不它不是。据我所知，不同`-source`且`-target`有效，但前提是源低于或等于目标（以提供向后兼容性）。可能有源代码转换器可以将您的 java 7 代码转换为旧版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:47:47.997

有一个名为[Retroweaver](http://retroweaver.sourceforge.net/)的项目，它允许您编写 Java 5 语法（包括泛型等）并将其转换为在 Java 1.4 和更早版本上运行的代码。

据我所知，没有类似的东西可以让 Java 7 语法的代码在旧版本上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:54:40.793

不，这是不可能的。例如，考虑新的 try-with-resources 构造：这可能会设置抑制的 throwable，但此 API 仅在 Java SE 7+ 中可用：

[http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html#getSuppressed%28%29](http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html#getSuppressed%28%29)

这意味着旧的 Java 版本无论如何都无法运行该代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T14:46:22.710

不，如果您使用 Java7 语法，则无法使用 Java 5 编译该代码。

`-source`并且`-target`仅当语法与 -target 版本兼容时才有效。

# php - foreach 不适用于 glob - 错误：无效参数

> ID：12675401
> 
> 赞同：0
> 
> 时间：2012-10-01T14:37:26.857
> 
> 标签：php, foreach, glob

我收到此代码的“无效参数”错误。请帮我修复它。

```
$sub1 = "sub1";
$sub2 = "sub2";
$td = "4";
foreach (glob("directory/".$sub1."/".$sub2."*.td".$td) as $filename) { //This is the line throwing the error
    echo "$filename size " . filesize($filename) . "\n"; //This is right from php.net manual
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:38:25.237

看起来你缺少一个斜杠：

```
foreach (glob("directory/".$sub1."/".$sub2."*.td".$td) as $filename) 
```

应该：

```
foreach (glob("directory/".$sub1."/".$sub2."/*.td".$td) as $filename) 
```

（如果我有一个存储目录的变量，我总是在最后添加斜线 - 它使事情保持一致，这意味着我不需要记住在使用它时重新添加斜线。）

# html - 使用适用于所有浏览器的音频标签

> ID：12675402
> 
> 赞同：0
> 
> 时间：2012-10-01T14:37:28.340
> 
> 标签：html, html5-audio

所以我进入了 HTML5，并成功地创建了一个**与所有浏览器兼容**的视频。（通过简单地给它多个来源）

由于音频和视频元素有很多相似之处，我尝试对音频元素做同样的事情。像这样：

```
 <audio controls="controls" preload="auto">
            <source src="s/audiomp3.mp3" type='audio/mpeg; codecs="mp3"'/><%-- Chrome --%>
            <source src="s/audioogg.ogg" type='audio/ogg; codecs="vorbis"'><%-- Chrome & Opera --%>
            <source src="s/audiomp4.mp4" type='audio/mp4; codecs="mp4a.40.5"'><%-- Chrome --%>
            <source src="s/audiowav.wav" type='audio/wav; codecs="1"'><%-- Chrome --%>
        </audio> 
```

有人看到问题是什么，或者是否有办法解决这段代码的问题？使用视频标签，我可以做同样的事情并让视频在我在这里拥有的每个浏览器中工作。

我已经搜索过这个，但**只找到了 js fallback libraries**，这不是我要搜索的。

或者这是唯一的解决方案？只是在每个不接受扩展的浏览器中实现 js/flash 回退？

编辑：请注意评论是针对 ASP.net 的，所以请忽略它们。这些是他们目前工作的浏览器。在我正在测试的 5 个中，它太少了。

编辑：浏览器如下（都在 windows xp 上）：chrome、firefox、Opera、Safari。还有 IE，但那不是这个问题的一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T01:27:53.540

如果您需要与 IE 7 和 8 兼容，您应该使用第三方库。但如果不是 - 保持简单。您只需要使用[mp3 和 ogg](http://en.wikipedia.org/wiki/HTML5_Audio)即可覆盖所有主流浏览器。

```
<audio controls="controls">
    <source src="s/audioogg.ogg" type="audio/ogg"/>
    <source src="s/audiomp3.mp3" type="audio/mpeg"/>
</audio> 
```

更重要的是，确保您的 Web 服务器配置为在提供 ogg 和 mp3 文件（audio/ogg 和 audio/mpeg）时使用正确的 MIME 类型。如果没有这一步，音频将在某些浏览器上失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T07:36:38.023

只需使用 SoundManager2：[http ://www.schillmania.com/projects/soundmanager2/](http://www.schillmania.com/projects/soundmanager2/)

# php - ajax 表单转到另一个页面而不是留在同一页面上

> ID：12675407
> 
> 赞同：-1
> 
> 时间：2012-10-01T14:37:38.433
> 
> 标签：php, jquery, html, ajax, forms

我有这个弹出 ajax 表单，它不是发送数据并保持在同一页面上，而是发送数据但将我带到我的表单中的文件 send.php。这是为什么？我在另一个站点上正确地实现了几乎相同的表单。我不知道我在这里做错了什么......

形式：

```
<form id="form" action="send.php"  name="form" method="post" >

    <input type="text"  id="name" name="name" value="" /><br />

    <input type="text"  id="email" name="email" value=""  /><br />

    <textarea name="message" cols="4" rows="4"  id="message" ></textarea><br />

    <input type="submit" value="" id="submit" title="Send!"/>

</form> 
```

阿贾克斯：

```
<script type="text/javascript">

$(document).ready(function () {
    $('#form').ajaxForm({
        beforeSubmit: validate
    });

    function validate(formData, jqForm, options) {
        var name = $('input[name=name]').fieldValue();
        var email = $('input[name=email]').fieldValue();
        var message = $('textarea[name=message]').fieldValue();

        if (!name[0]) {
            alert('Please enter a value for name');
            return false;
        }
        if (!email[0]) {
            alert('Please enter a value for email');
            return false;
        }
        if (!message[0]) {
            alert('Please enter a value for message');
            return false;
        }

        else {

        $("#prima_form").fadeOut(1000, function () {
            $(this).html("<img src='images/de_multumire.png'/>").fadeIn(2000);
        });

        var message = $('textarea[name=message]').val('');
        var name = $('input[name=name]').val('');
        var email = $('input[name=email]').val('');

} 
}

});

</script> 
```

发送.php：

```
<?php
        if($_POST){
                $email = $_POST['email'];
                $name = $_POST ['name'];
                $message = $_POST ['message'];
                // response hash
                $ajaxresponse = array('type'=>'', 'message'=>'');

                try {
                        // do some sort of data validations, very simple example below
                        $all_fields = array('name', 'email', 'message');

                        foreach($all_fields as $field){
                                if(empty($_POST[$field])){
                                        throw new Exception('Required field "'.ucfirst($field).'" missing input.');
                                }
                        }

                        // ok, if field validations are ok
                        // now Send Email, ect.

                        // let's assume everything is ok, setup successful response
                        $subject = "New Contact";
                        //get todays date
                        $todayis = date("l, F j, Y, g:i a") ;

                        $message = " $todayis \n
                        Attention: \n\n
                        Please see the message below: \n\n
                        Email Address: $email \n\n
                        Message: $message \n\n

                        ";

                        $from = "From: $email\r\n";

                        //put your email address here
                        mail("contact@xxx.ro", $subject, $message, $from);

                        //prep json response
                        $ajaxresponse['type'] = 'success';
                        $ajaxresponse['message'] = 'Thank You! Will be in touch soon';  
                } catch(Exception $e){
                        $ajaxresponse['type'] = 'error';
                        $ajaxresponse['message'] = $e->getMessage();
                }
                // now we are ready to turn this hash into JSON
                print json_encode($ajaxresponse);
                exit;
        }
?> 
```

我的 js 控制台给出了这个：

```
[17:38:03.840] [cycle] terminating; zero elements found by selector @ http://sociallab.ro/js/jquery_003.js:10
--
[17:38:16.012] POST http://sociallab.ro/send.php [HTTP/1.1 200 OK 218ms]

[17:38:16.204] The character encoding of the HTML document was not declared. The document will render with garbled text in some browser configurations if the document contains characters from outside the US-ASCII range. The character encoding of the page must to be declared in the document or in the transfer protocol. @ http://sociallab.ro/send.php 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:50:45.283

在纯 Javascript 中，您需要执行以下操作：

```
function sendWithAjax() {
    var ajax = new XMLHttpRequest();
    ajax.open("POST", "send.php", true); 
```

然后从输入元素中读取值：

```
 var email = document.getElementById('email').value;
    var name = document.getElementById('name').value;
    var message = document.getElementById('message').value; 
```

您可以在调用 .send() 之前在此处验证表单

（您可能需要使用 escape() 函数转义表单元素的内容）

并将它们放入发送方法中：

```
 ajax.send("email="+ email +"&name="+ name +"&message="+ message); 
```

并从您的表单代码中删除完整的表单标签。因此，您不需要提交按钮，因此将其更改为一个简单的按钮：

```
<input type="text"  id="name" name="name" value="" /><br />
<input type="text"  id="email" name="email" value=""  /><br />
<textarea name="message" cols="4" rows="4"  id="message" ></textarea><br />
<input type="submit" value="" id="submit" title="Send!" onclick="javascript:sendWithAjax()"/> 
```

要获取 ajax 响应，请使用：

```
 var response = ajax.responseText;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:06:20.200

尝试添加这个：

```
$('#submit').click(function(){ return false; /* stop html form from submitting*/ }) 
```

我相信正在发生的事情是 jquery 正在通过 ajax 发送表单数据，但是您并没有像往常一样阻止默认的“提交”按钮提交 html 表单。添加上面的代码应该会停止提交按钮的默认操作（将表单提交到 send.php），从而将您留在当前页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-26T13:45:58.400

就像是：

```
 $(document).ready(function(event){
        event.preventDefault();
        $('#FORMID').ajaxForm({
            type: 'POST',
            dataType: 'json',
            beforeSubmit: function(){
            },
            success: function(resp){

            },
            error: function(resp){

            }
        });
    }); 
```

希望这会有所帮助。

# c++ - 如何用“new”和“delete”替换“malloc”和“free”？

> ID：12675416
> 
> 赞同：2
> 
> 时间：2012-10-01T14:38:03.583
> 
> 标签：c++, malloc, new-operator

如何更改以下代码以便我可以使用`new`and`delete`而不是`malloc`and `free`？

```
#include <iostream>
#include <cstdlib>
#include <cstdio>
using namespace std;

class myclass{
  private:
    float **m_R;
  public:
    myclass();
    ~myclass();
    float **getR(void);
    void setR(void);
};

myclass::myclass()
{
  // first allocate rows (for pointers)
  m_R = (float**)malloc(3*sizeof(float));
  // next allocate columns for float values
  for(int i=0;i<3;i++)
    *(m_R+i) = (float*)malloc(3*sizeof(float));
}

myclass::~myclass()
{
  // first free memory allocated by columns
  for(int i = 0; i < 3; i++)
  {
    free(m_R[i]);
  }
  // next free memory allocated by rows
  free(m_R);
}

void myclass::setR(void)
{
  for(int i=0;i<3;i++)
  {
    for(int j=0;j<3;j++)
    {
      m_R[i][j] = 10*i+j;
      //cout << m_R[i][j] << ", ";
    }
    //cout << "\n";
  }
}

float **myclass::getR(void)
{
  return m_R;
}

int main () {

  myclass obj;
  obj.setR();

  for(int i=0;i<3;i++)
  {
    for(int j=0;j<3;j++)
    {
      printf("%02d, ",(int)obj.getR()[i][j]);
    }
    cout << "\n";
  }

  return 0;
} 
```

Edit1：请注意，我必须使用一个函数（不是我写的）`float**`作为参数，我别无选择（例如`vector`）而不是使用`float**`.

Edit2：该功能来自Proximity Query Package（PQP），编写如下：

```
int 
PQP_Distance(PQP_DistanceResult *result, 
             PQP_REAL R1[3][3], PQP_REAL T1[3], PQP_Model *o1,
             PQP_REAL R2[3][3], PQP_REAL T2[3], PQP_Model *o2,
             PQP_REAL rel_err, PQP_REAL abs_err,
             int qsize = 2); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-01T14:46:34.827

*   `T* a = (T*)malloc(sizeof(T))`变成`new T`.
*   `T* b = (T*)malloc(N * sizeof(T))`变成`new T[N]`.
*   `free(a)`变成`delete a`.
*   `free(b)`变成`delete[] b`.

所以你得到：

```
myclass::myclass()
{
  // first allocate rows (for pointers)
  m_R = new float*[3];
  // next allocate columns for float values
  for(int i=0;i<3;i++)
    *(m_R+i) = new float[3];
}

myclass::~myclass()
{
  // first free memory allocated by columns
  for(int i = 0; i < 3; i++)
  {
    delete[] m_R[i];
  }
  // next free memory allocated by rows
  delete [] m_R;
} 
```

请注意，这实际上不是非常理想的。如果你想要 3x3 矩阵，你最好在一个块中分配 9 个浮点数。

另请注意，您的 C 不正确。

```
m_R = (float**)malloc(3*sizeof(float)); 
```

应该

```
m_R = (float**)malloc(3*sizeof(float*)); 
```

您的代码可能“有效”，因为您正在编译 32 位，其中`float`和`float*`是 4 个字节。在 64 位构建上，`float*`是 8 个字节。

* * *

不过，老实说，由于您的尺寸是固定的且很小，您应该将所有内容存储在对象本身中：

```
class myclass{
  private:
    float m_R[3][3];
  public:
    myclass() {}
    ~myclass() {}
    void setR(void);
    float* operator[](unsigned i) { return m_R[i]; }
    const float* operator[](unsigned i) const { return m_R[i]; }
};

void myclass::setR(void)
{
  for(int i=0;i<3;i++)
  {
    for(int j=0;j<3;j++)
    {
      (*this)[i][j] = 10*i+j;
      //cout << (*this)[i][j] << ", ";
    }
    //cout << "\n";
  }
}

int main () {

  myclass obj;
  obj.setR();

  for(int i=0;i<3;i++)
  {
    for(int j=0;j<3;j++)
    {
      printf("%02d, ",(int)(obj[i][j]));
    }
    cout << "\n";
  }

  return 0;
} 
```

这就是我通常的做法，因此我获得了 [][] 的可读性和对象内存储的效率。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-01T14:46:24.953

假设使用标准 C++ 库是一个选项，您应该使用

```
std::vector<std::vector<float> > m_R; 
```

而不是`float**`. 绝对没有缺点，你会免费得到很多方便的东西。例如，您将能够找到向量的大小及其每个维度，而无需在旁边传递一对数字，或在某些假设中进行编码。您将能够在没有循环的情况下进行分配，并在根本没有代码的情况下删除。

如果这不是一个选项，您可以将`malloc`/`free`替换为`new[]`/ `delete[]`，如下所示：

```
// Creating
float **m_R = new float*[10];
for (int i = 0 ; i != 10 ; i++) {
    m_R[i] = new float[20];
}

// Deleting
for (int i = 0 ; i != 10 ; i++) {
    delete[] m_R[i];
}
delete[] m_R; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-01T14:59:45.780

您应该决定是要使用 C（因此，没有类）还是 C++（因此，当存在 C++ 库时，没有纯 C）进行编程。

现在你只有 C + 一些类。

尊重你所做的（一个包装二维固定数组的类），更合适的方法可以是：

```
#include <iostream>
#include <iomanip>
#include <cassert>

class myclass
{
public:
    mycalss() :m() {}

    float& at(size_t r, size_t c)
    { return m[r][c]; }

    const float& at(size_t r, size_t c) const
    { return m[r][c]; }

    void setR()
    {
        for(int i=0;i<3;i++)
            for(int j=0;j<3;j++)
                m[i][j] = 10*i+j;
    }

private:
    float m[3][3]; 
};

int main () 
{
    using namespace std;

    myclass obj;
    obj.setR();

    for(int i=0;i<3;i++)
        for(int j=0;j<3;j++)
            cout << setw(2) << obj.at(i,j) << endl;
    return 0;
} 
```

请注意，不需要使用动态内存。

如果您想使用动态内存（可能是因为数组大小应该更大），您可以依赖 std::vector 作为容器：

```
#include <iostream>
#include <iomanip>
#include <vector>
#include <cassert>

class myclass
{
public:
    mycalss(unsigned rows_, unsigned cols_) :m(), rows(rows_), cols(cols_) 
    { m.resize(rows_*cols_); }

    float& at(size_t r, size_t c)
    { return m[r*cols+c]; }

    const float& at(size_t r, size_t c) const
    { return m[r*cols+c]; }

    void setR()
    {
        for(int i=0;i<rows;i++)
            for(int j=0;j<cols;j++)
                at(i,j) = 10*i+j;
    }

private:
    std::vector<float> m; 
    size_t rows, cols;
};

int main () 
{
    using namespace std;

    static const size_t R=4, C=4;
    myclass obj(R,C);
    obj.setR();

    for(int r=0;r<R;r++)
        for(int c=0;c<C;c++)
            cout << setw(2) << obj.at(r,c) << endl;
    return 0;
} 
```

# bash - 结合图片和时间戳

> ID：12675418
> 
> 赞同：1
> 
> 时间：2012-10-01T14:38:11.830
> 
> 标签：bash, imagemagick

我有多个用时间戳定义的图片，例如：

```
face-01.jpg
face-02.jpg
...
screen-01.jpg
screen-02.jpg
... 
```

我需要使用 imagemagik 的“蒙太奇”命令将“面部”图片与“屏幕”图片合并。有什么建议吗？

```
montage -mode concatenate -tile 1x face-01.jpg screen-01.jpg 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:45:55.033

您可以使用以下循环创建相应面部/屏幕图像的蒙太奇。

```
for face in face*
do
   montage "$face" "screen-${face//[^0-9]/}.jpg" -mode Concatenate -tile x1 "montage_${face}"
done 
```

# haskell - 如何在 Haskell 中对元组使用 case 表达式？

> ID：12675420
> 
> 赞同：1
> 
> 时间：2012-10-01T14:38:15.930
> 
> 标签：haskell, switch-statement, tuples

在 Haskell 中使用 case 表达式时出现问题。

```
filterSth::[a]->(b,c)->[a]
filterSth (x:xs) (b, c) =
    case (b,c) of
        (1,0) -> ...
        (1,2) -> ...
        ... 
```

我可以做上面的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T14:41:35.603

是的，您可以执行上述操作，但如果您想将它们`b`与`c`数字常量进行模式匹配，则需要具有数字类型。

# c# - DateTime.ParseExact 格式字符串

> ID：12675421
> 
> 赞同：2
> 
> 时间：2012-10-01T14:38:19.693
> 
> 标签：c#, .net, datetime, query-string

我有一个 Web 应用程序，它通过查询字符串将 DateTime 从一个页面传递到另一个页面。它在 IE 和 FireFox 中都运行良好，但每当我在 Google Chrome 中尝试它时都会抛出异常。该程序在以下行令人窒息：

```
startDateTime = Convert.ToDateTime(Request.QueryString["start"]); 
```

于是，我运行调试器，发现查询字符串中的值为：

```
Wed Oct 03 2012 08:00:00 GMT-0400 (Eastern Daylight Time) 
```

我得出的结论是 Convert 不能胜任这项工作，并着手尝试让 DateTime.ParseExact 驯服这头野兽。但是，到目前为止，我还没有找到正确的格式字符串。这是我一直在尝试的代码（不起作用）：

```
DateTime.ParseExact(Request.QueryString["start"], "ddd MMM dd yyyy HH:mm:ss zzz", CultureInfo.InvariantCulture); 
```

该页面正在通过第三方组件 (DayPilotCalendar) 调用的一些 JavaScript 从另一个页面调用。以下是在 DayPilotCalendar 控件上设置的相关属性：

```
TimeRangeSelectedJavaScript="GB_showPage('Request Magnet Time', '../../../EventAddEdit.aspx?start=' + encodeURIComponent(start) + '&end=' + encodeURIComponent(end))" 
```

我的格式字符串有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T14:54:17.997

我是否可以建议不要在查询字符串中传递类似：“Wed Oct 03 2012 08:00:00 GMT-0400 (Eastern Daylight Time)”之类的内容，而是简单地传递日期的时间戳？例如，new Date().getTime()。（UTC 自 1970 年以来的毫秒数）。然后，在 C# 中你可以这样做：

```
var epoch = new DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc);
var dt =  epoch.AddMilliseconds(Convert.ToInt64(Request.QueryString["start"])); 
```

无需解析。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T14:46:57.303

可能只是您的格式未涵盖该`(Eastern Daylight Time)`部分。尝试使用常规字符串处理方法从字符串中解析出来，然后调用`ParseExact`其余部分。

编辑：正如 Oded 指出的那样，您还必须将其`GMT`作为文字放入格式字符串中：

```
"ddd MMM dd yyyy HH:mm:ss 'GMT'zzz" 
```

以下作品：

```
var input = "Wed Oct 03 2012 08:00:00 GMT-0400 (Eastern Daylight Time)";
var trim = input.Substring(0, input.IndexOf(" ("));
var dt = DateTime.ParseExact(
    trim,
    "ddd MMM dd yyyy HH:mm:ss 'GMT'zzz",
    CultureInfo.InvariantCulture); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:53:26.810

我尝试运行代码

```
static void Main(string[] args) {
    Console.WriteLine(DateTime.Now.ToString("ddd MMM dd yyyy HH:mm:ss zzz"));            
    Console.Read();
} 
```

输出是：

> 2012 年 10 月 1 日星期一 10:52:20 -04:00

所以我想你也需要解析字符串的 GMT 和（东部夏令时间）部分

# ruby-on-rails - 视图中的简单 RoR 关系

> ID：12675424
> 
> 赞同：0
> 
> 时间：2012-10-01T14:38:26.547
> 
> 标签：ruby-on-rails, devise

我正在研究 Ruby on Rails，我正在尝试使用 devise 创建这个简单的博客系统来创建登录部分。

这个问题肯定有一个很简单的答案，但是我用google找不到，所以最后放弃了，决定在这里问。

我有一个由设计创建的用户表和一个由脚手架命令创建的帖子表。

Posts 表有一个 user_id 字段。在创建帖子时，我使用以下代码：

```
 def create
    @post = Post.new(params[:post])
    @post.user_id = current_user.id

    respond_to do |format|
      if @post.save
        format.html { redirect_to @post, notice: 'Post was successfully created.' }
        format.json { render json: @post, status: :created, location: @post }
      else
        format.html { render action: "new" }
        format.json { render json: @post.errors, status: :unprocessable_entity }
      end
    end
  end 
```

这样我就得到了用户 ID 并创建了这种关系。

这是我的帖子模型：

```
class Post < ActiveRecord::Base
  attr_accessible :body, :title, :user_id

  belongs_to :user

end 
```

现在，我只想在 list 方法中显示作者的姓名。

我尝试了几件事，但似乎都没有完成。

如何将用户名链接到帖子而不是用户 ID？

我目前的索引方法是标准方法：

```
 def index
    @posts = Post.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @posts }
    end
  end 
```

我知道我需要在 Post.all 中添加参数，但是如何？

谢谢！

注意：我使用 rails 3 和 PostgreSQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:51:32.427

您可以通过关系访问用户对象：

```
@post.user.name 
```

如果您想预先加载关系，可以将您的`@posts = Post.all`语句更改为以下内容：

```
@posts = Post.includes(:user) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:50:35.867

假设用户名在 中`User#name`，您可以通过在视图中添加类似这样的内容来显示它：

```
<%= post.user.name %> 
```

您的 posts/index.html.erb 视图可能有一些代码 ala

```
<% @posts.each do |post| %>
  <tr>
    <td><%= post.name %></td>
    ...
  </tr>
<% end %> 
```

添加另一个带有作者姓名的表格单元格可以使它看起来像：

```
<% @posts.each do |post| %>
  <tr>
    <td><%= post.name %></td>
    <td><%= post.user.name %></td>
  </tr>
<% end %> 
```

# apache-flex - flex : VGroup 上的 Bitmapdata.draw 打印空白

> ID：12675425
> 
> 赞同：1
> 
> 时间：2012-10-01T14:38:26.890
> 
> 标签：apache-flex, bytearray, bitmapdata, displayobject

我希望将 VGroup（包含其他组和图像等多个元素）绘制到 BitmapData 中，然后将其编码为 ByteArray 并通过 POST 发送。

我正在使用小部件，假设我的 VGroup 是由小部件 A 构建的，我在小部件 B 中获取它。我使用单例来传输数据。我不知道我的传输是否良好，但是当我将其取回widet BI时可以显示它，并且显示正常。我的 VGroup 具有固定的高度和宽度，代码如下：

```
 var printBox:VGroup = SharedData.getInstance()._sharedData["Shared_EligibilitePopupWidget_vgroup"];
    this.addChild(printBox);
    var m:Matrix = new Matrix();

    var bd:BitmapData = new BitmapData(printBox.width, printBox.height);
    bd.draw(printBox, m);
    var ba:ByteArray = (new PNGEncoder()).encode(bd);
    _fileRef = new FileReference();
    _fileRef.save(ba, "test.png"); 
```

但是当我查看保存的文件时，打印是空白的，我尝试了多种方法但仍然是空白......我不知道出了什么问题，宽度？我在小部件 A 中创建了它的事实？

寻求帮助，谢谢。

# java - 如何在Android中按名称从类型化数组资源中获取值？

> ID：12675428
> 
> 赞同：4
> 
> 时间：2012-10-01T14:38:33.960
> 
> 标签：java, android

假设我有一个这样的资源 xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<resources>
    <array name="difficulties">
        <item>
            <integer name="level">1</integer>
            <integer name="fixed_blocks">2</integer>
            <integer name="color_count">2</integer>
        </item>
        <item>
            <integer name="level">2</integer>
            <integer name="fixed_blocks">4</integer>
            <integer name="color_count">3</integer>
        </item>
        <item>
            <integer name="level">3</integer>
            <integer name="fixed_blocks">6</integer>
            <integer name="color_count">3</integer>
        </item>
    </array>    
</resources> 
```

如何从`item`名称中获取整数值？的`TypedValue`API 似乎不包含任何方法。如果这是不可能的，那是`TypedArray`怎么回事？

如果我可以通过它的序数从一个项目中获得一个值，那也可以。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T15:02:25.363

我不记得这是可能的（但我可能是错的）。从项目的结构（在`difficulties`数组中）来看，您可以做其他事情，您可以使用整数数组的数组。知道项目数组`level`位于第一个位置，`fixed_blocks`作为第二个位置等，您可以轻松获取值。您可以在此处找到一个示例[Android Resource - Array of Arrays](https://stackoverflow.com/questions/4326037/android-resource-array-of-arrays)

**编辑：** 这是您正在寻找的方法吗？

```
private int[] getLevelConstants(int level) {
    int[] result = null;
    TypedArray ta = getResources().obtainTypedArray(R.array.difficulties);
    // keep in mind the differences between the level(starts at 1) and the index of the difficulties array which starts at 0
    int id = ta.getResourceId(level, 0); 
    if (id > 0) {
        result = getResources().getIntArray(id);
    } else {
        // something bad
    }
    return result;
} 
```

数组将是：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

    <integer-array name="difficulties">
        <item>@array/level1</item>
        <item>@array/level2</item>
    </integer-array>

    <integer-array name="level1" >
        <item>1</item>
        <item>2</item>
        <item>2</item>
    </integer-array>

    <integer-array name="level2" >
        <item>2</item>
        <item>4</item>
        <item>3</item>
    </integer-array>

</resources> 
```

# jquery - jQuery 将引用附加到添加的元素

> ID：12675429
> 
> 赞同：3
> 
> 时间：2012-10-01T14:38:43.417
> 
> 标签：jquery, append, dom-manipulation

我有一个通过 ajax 调用检索的数据集，我正在循环访问数据集，并且对于该集中的每个项目，将 a 添加`<li>`到页面上的列表中。

如何在每个循环中获取附加的列表项，以便我还可以对其执行单独的操作

```
var myData = getData();
var list = $('#list');
$.each(myData, function(index, person){
    list.append('<li>'+person.name+'</li>');
    // On the just appended <li> element I want to set the data-person attribute

    //var listitem = ???;
    //listitem.data('person', person);
}); 
```

这是一个小提琴来说明我的问题：http: [//jsfiddle.net/pcLt7/1/](http://jsfiddle.net/pcLt7/1/)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-01T14:42:18.383

只需从原始 HTML 创建一个 jQuery 对象，然后附加它

```
var listitem = $('<li>'+person.name+'</li>');
list.append(listitem);
listitem.data('person', person); 
```

注意：在循环中进行 DOM 操作不是一个好主意。

如果元素数量很少，那么只需使用我的解决方案。如果这可能是数百个元素，您可能希望通过在列表上使用 detach 来处理分离的节点，然后再添加项目，然后再次将其添加到 DOM。

不要过早优化。该解决方案使用更少的代码，并且比任何其他解决方案都更具可读性，并且工作得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:46:58.617

尝试这个

基于[Prinzhorn](https://stackoverflow.com/users/1422124/prinzhorn)的建议（[链接](https://stackoverflow.com/a/12675490/605154)）：

> 注意：在循环中进行 DOM 操作不是一个好主意

我已经更改了我的代码..现在我将“li”连接到一个字符串中，然后将它们全部添加到列表中

```
 var list = $('#list');
var str = "";
$.each(myData, function(index, person){
    str += "<li data-person='" + JSON.stringify(person) + "'>"
    + person.name + "</li>";

    // On the just appended <li> element I want to set the data-person attribute

    //var listitem = ???;
    //listitem.data('person', person);
});

list.append(str); 
```

[http://jsfiddle.net/pcLt7/2/](http://jsfiddle.net/pcLt7/4/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T02:21:13.043

一口气

```
$.each(myData, function(index, person){
    $('<li/>', {
        text: person.name,
        data: person
      }).appendTo(list);
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-01T14:44:45.650

```
$.each(myData, function(index, person){
    list.append('<li data-person="'+person.name+'"+ data-member="'+person.member+'">'+person.name+'</li>');
});

$('#list li').click(function(){
    var person = $(this).data('person');
    var member = $(this).data('member');
    alert(person + ' is ' + (member ? 'a' : 'no') + ' member');
}); 
```

[http://jsfiddle.net/gV9RJ/](http://jsfiddle.net/gV9RJ/)

# vb.net - 将 Date 转换为 Long 或其二进制形式以写入文件？

> ID：12675431
> 
> 赞同：1
> 
> 时间：2012-10-01T14:38:45.597
> 
> 标签：vb.net, date

如何将日期转换为长日期？铸造它不起作用：/。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T14:47:46.327

每个 DateTime 结构都有一个名为[ToBinary()](http://msdn.microsoft.com/en-us/library/system.datetime.tobinary%28v=vs.100%29.aspx)的方法和一个名为[FromBinary()](http://msdn.microsoft.com/en-us/library/system.datetime.frombinary%28v=vs.100%29.aspx)的方法，根据 MSDN

> 使用 ToBinary 方法将当前 DateTime 对象的值转换为二进制值。随后，使用二进制值和 FromBinary 方法重新创建原始 DateTime 对象。

ToBinary() 的返回值是一个 long 值，而 FromBinary 的输入值又是一个 long 值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:48:09.197

您可以获得对象`DateTime.MinValue`表示的刻度数`DateTime`。然后，当您从文件加载它时，您可以`DateTime`使用构造函数重新创建对象，该构造函数需要多个刻度。例如：

```
Dim ticks As Long = myDate.Ticks
Dim myDate2 As Date = New Date(ticks) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T14:47:43.277

那么在Java中，我们可能会做这样的事情：

```
 String str_date="11-June-07";
            DateFormat formatter ; 
            Date date ; 
            formatter = new SimpleDateFormat("dd-MMM-yy");
            date = (Date)formatter.parse(str_date); 
            long longDate=date.getTime();
            System.out.println("Today is " +longDate ); 
```

在 VB.net 中试试这个：

```
 Dim d As Date = Today
       MsgBox(d.ToOADate) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T14:43:18.747

您可以使用 Ticks 属性，假设这是您需要的 Long 值：

[http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx](http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx)

也可以看看：

[从刻度到日期的格式](https://stackoverflow.com/questions/1129410/format-from-ticks-to-date)

# java - JSTL - 如何在不访问服务器的情况下重置“ModelAttribute”？

> ID：12675435
> 
> 赞同：0
> 
> 时间：2012-10-01T14:39:07.820
> 
> 标签：java, spring, jstl

我有一个与`Search.jsp`a`form:form`连接的视图`ModelAttribute`。我想在我的视图中有一个“重置”按钮，它将重置搜索表单。

我目前正在使用一个简单的链接来重新加载页面，但这会向服务器发送一个新请求。有没有一种方法可以在 JSTL 中做到这一点，而无需访问服务器，即客户端？

重置按钮不起作用，因为值绑定到`@ModelAttribute`（除非页面已重新加载）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:03:14.653

不，JSTL 是**服务器端**。你需要用javascript来做。

[jQuery](http://jquery.com/)很好。就像是

```
$('input[type="text"]').val(''); 
```

# dynamics-crm-2011 - 创建“拆分按钮”

> ID：12675441
> 
> 赞同：2
> 
> 时间：2012-10-01T14:39:35.853
> 
> 标签：dynamics-crm-2011

在 CRM 2011 中，我想创建一个新的功能区按钮，其中包含不同操作的下拉菜单，例如运行报表或导入数据所获得的内容。

一些研究似乎表明这些被称为拆分按钮，但似乎没有任何关于实际如何创建它们的信息。

谁能帮我？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T15:10:10.707

制作这些的最简单方法是使用 Ribbon Workfbench，它是我推荐的极好的工具。

[色带工作台](http://www.develop1.net/public/page/Ribbon-Workbench-for-Dynamics-CRM-2011.aspx)

该站点还包括解释如何创建这些不同按钮的教程。

# node.js - 以编译的形式部署 node.js

> ID：12675446
> 
> 赞同：0
> 
> 时间：2012-10-01T14:39:51.977
> 
> 标签：node.js, express

我们正在考虑将 node.js 用于我们的下一个服务器端应用程序。但是我们不希望我们的客户能够查看我们应用程序的代码。我们可以以编译的形式部署用 node.js 编写的应用程序吗？如果是，那么如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T14:49:00.940

也许你可以混淆你所有的代码......我知道这不像编译，但至少，它会避免 99% 的客户查看代码：D

这是另一个主题：[如何混淆（保护）JavaScript？](https://stackoverflow.com/questions/194397/how-can-i-obfuscate-javascript)

祝你好运

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T20:05:15.387

> 但是我们不希望我们的客户能够查看我们应用程序的代码。

如果您将代码发送给您的客户，他们将能够*“查看您的应用程序代码”*。从技术上讲，*“运行代码”*的过程就是*“查看应用程序的代码”*。

拥有完全编译的代码版本肯定会让人感觉“更安全”，但他们仍然拥有某种可用形式的代码副本。他们仍然可以逆向工程或做其他事情。这些东西真的归结为许可证。

这是一个[相关的答案](https://stackoverflow.com/a/232767/261188)。他的报价是：

> 写许可证并请律师追捕违规者

否则，您应该自己托管这些东西并允许公众访问。

任何形式的混淆、缩小、编译都将成为*“窃取代码”*过程中的一个减速带。简单地拥有法律追索权可能要好得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-01T14:45:13.950

我不相信这是可能的。我的意思是，从技术上讲，我猜您可以将所有内容编写为本地 C++ 扩展，但这会破坏使用 node.js 的目的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-02T04:52:14.470

如前所述，Node.js 中没有真正的编译，因为 nod 可执行文件基本上是即时编译 javascript 代码。

许多开发人员使用 Google 的[Closure Compiler](https://developers.google.com/closure/compiler/)，它实际上只是“缩小”——删除注释、空格等——和“优化”——将 javascript 代码转换为更高效的 javascript。但是，生成的代码通常仍然是可解析的 javascript 代码（尽管相当难以阅读！）。查看此相关流以获取更多信息：[Getting closure-compiler and Node.js to play nice](https://stackoverflow.com/questions/8287597/getting-closure-compiler-and-node-js-to-play-nice)

几个可能有用的选项：

1.  为“专有”业务逻辑开发自定义模块并将其托管在您的安全服务器上
2.  将“专有”业务逻辑包装到 java 类或可执行文件中，在 Node.js 中作为外部进程调用
3.  将“专有”业务逻辑编码为在 Node.js 调用的单独应用程序服务器上可用的已编译 Web 服务。

由您来定义应用程序的哪些部分应被视为“专有”，但作为一般规则，我不会将 HTML 和相关的 javascript（发送到我们的浏览器）归类为“专有”。我的建议是在这里要明智。

最后，我发现以下流有一个有趣的方法，可能会有所帮助，但它相当先进并且可能有相当多的错误：[NodeJS 应用程序的安全分发](https://stackoverflow.com/questions/9413123/secure-distribution-of-nodejs-applications)

希望有帮助...

# php - mysql插入数据库 - 没有数据传递给数据库

> ID：12675447
> 
> 赞同：-3
> 
> 时间：2012-10-01T14:39:55.733
> 
> 标签：php, html, mysql

我正在将表单发送到 php 页面，然后将其保存到 mysql 数据库中。代码似乎执行没有错误，但没有值保存到数据库中。

我是否错过了代码中的某些内容？

形式：

```
<form action="newcourse.php" method="post">
<input name="title" type="text" id="title" value="">
<br /><br />
  <input name="location" type="text" id="location" value="">
<br /><br />
<input name="datestart" type="text" id="datestart" value="">
<br /><br />
<input name="dateend" type="text" id="dateend" value=""><br /><br />
<select name="noofweeks" id="noofweeks">
  <option value="1" selected>1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
  <option value="6">6</option>
  <option value="7">7</option>
  <option value="8">8</option>
  <option value="9">9</option>
  <option value="10">10</option>
  <option value="11">11</option>
  <option value="12">12</option>
</select><br /><br />
<select name="wheelchair" id="wheelchair">
  <option value="yes">yes</option>
  <option value="no" selected>no</option>
</select>
<br /><br />
<input name="time" type="text" id="time" value=""><br /><br />
<input name="courseleader" type="text" id="courseleader" value=""><br /><br />
<input name="pack" type="hidden" id="pack" value="participants_pack.pdf">
<input name="price" type="text" id="price" value=""><br /><br />
<input name="group" type="text" id="group" value=""><br /><br />
<input name="numberofplaces" type="text" id="numberofplaces" value=""><br /><br />
<select name="bookings" id="bookings">
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
  <option value="6">6</option>
  <option value="7">7</option>
  <option value="8">8</option>
  <option value="9">9</option>
  <option value="10">10</option>
  <option value="11">11</option>
  <option value="12">12</option>
  <option value="0" selected>0</option>
</select>
<br /><br />
<br /><br />
<input name="submit" type="submit" value="Save"></p></form> 
```

保存到mysql数据库：

```
<?php
$title=$_POST['title'];
$location=$_POST['location'];
$datestart=$_POST['datestart'];
$dateend=$_POST['dateend'];
$noofweeks=$_POST['noofweeks'];
$wheelchair=$_POST['wheelchair'];
$time=$_POST['time'];
$courseleader=$_POST['courseleader'];
$pack=$_POST['pack'];
$price=$_POST['price'];
$group=$_POST['group'];
$numberofplaces=$_POST['numberofplaces'];
$bookings=$_POST['bookings'];
//
require_once('connecttodatabase.php');
//
mysql_query("INSERT INTO courses (title, location, datestart, dateend, noofweeks, wheelchair, time, courseleader, pack, price, group, numberofplaces, bookings)  VALUES('$title', '$location', '$datestart', '$dateend', '$noofweeks', '$wheelchair', '$time', '$courseleader', '$pack', '$price', '$group', '$numberofplaces', '$bookings')");
mysql_close();
echo "Database updated!";
?> 
```

connecttodatabase.php 只是连接到数据库并适用于其他脚本，所以我知道这不是问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:43:08.713

您必须从 POST 中获取这些变量，例如：

```
$title = $_POST['title']; 
```

好的，您的编辑表明您正在这样做，如果我发现任何东西，我会更新它。

我建议查看 Bondye 的答案并使用：

```
mysql_query(...) or die(mysql_error()); 
```

因此您可以看到从 SQL 数据库返回的错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:55:15.047

您也使用`time`and`group`作为保留的 sql 关键字的列名，在列名周围使用反引号。我正在重写您的代码 lil ..此外，不要使用提交的名称作为提交，使用像`any_name //Change anyname to whatever`你这样的其他东西喜欢

```
<?php
require_once('connecttodatabase.php');

if(isset($_POST['any_name'])) {
$title=$_POST['title'];
$location=$_POST['location'];
$datestart=$_POST['datestart'];
$dateend=$_POST['dateend'];
$noofweeks=$_POST['noofweeks'];
$wheelchair=$_POST['wheelchair'];
$time=$_POST['time'];
$courseleader=$_POST['courseleader'];
$pack=$_POST['pack'];
$price=$_POST['price'];
$group=$_POST['group'];
$numberofplaces=$_POST['numberofplaces'];
$bookings=$_POST['bookings'];

   if(mysql_query("INSERT INTO courses (title, location, datestart, dateend, noofweeks, wheelchair, `time`, courseleader, pack, price, `group`, numberofplaces, bookings)  VALUES('$title', '$location', '$datestart', '$dateend', '$noofweeks', '$wheelchair', '$time', '$courseleader', '$pack', '$price', '$group', '$numberofplaces', '$bookings')")) {
     echo 'success';
      } else {
         echo 'Failed'.' '.mysql_error();
       }
    }
?> 
```

PS 开始使用`mysqli`-**[参考](http://php.net/manual/en/book.mysqli.php)**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-01T14:47:18.177

尝试这个

```
<?php
$title = $_POST['title']
//and rest

mysql_query("INSERT INTO courses (title, location,....) VALUES('{$title}', '{$location}', '{$datestart}', '{$dateend}'.....')");

?> 
```

# linq - Lightswitch 查询中的 DataServiceOperationException

> ID：12675448
> 
> 赞同：1
> 
> 时间：2012-10-01T14:39:58.340
> 
> 标签：linq, visual-studio-lightswitch

谁能告诉我这里的日期比较可能有什么问题？

在位置 60“参考 s.SwipeDateTime.Value.Date”的类型“Edm.DateTime”中不存在属性“日期”

```
 var lastSwipe = (from s in this.DataWorkspace.ApplicationData.EmployeeSwipeLogs
                         where s.Employee.Id == emp.Id &&
                         s.SwipeIsValid == true &&
                         s.SwipeDateTime.Value.Date == DateTime.Today
                         orderby s.SwipeDateTime descending
                         select s).FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T02:47:07.830

您可能还会发现[实体函数](http://msdn.microsoft.com/en-us/library/system.data.objects.entityfunctions_methods)很有用。这些允许您使用一些您无法使用的方法。

您需要添加：

*   *项目中对System.Data.Entity*的程序集引用（在 System.Data.Entity.dll 中）
*   使用函数的类中的 Imports/using *System.Data.Objects语句*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:19:22.760

如果您使用的是实体框架，那么您是对的，EDM.DateTime 没有 .Date 属性。查看[EDM.DateTime](http://msdn.microsoft.com/en-us/library/bb387157.aspx)了解您可以使用哪些方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T14:42:41.237

很简单，您使用的 LINQ 提供程序可能不支持`Convert.ToDateTime`. 到底是什么类型的`s.SwipeDateTime`？如果它已经是`DateTime`，那么您首先不需要转换 - 如果*不是* `DateTime`，它可能应该是。请注意，您可以使用`DateTime.Today`而不是`DateTime.Now.Date`，我个人会将其移至查询之前。

# android - 如何在 ListPreference 中更改 AlertDialog 的主题？

> ID：12675451
> 
> 赞同：1
> 
> 时间：2012-10-01T14:40:17.910
> 
> 标签：android

我知道 HoloEverywhere 不支持 ListPreference，但支持 AlertDialog。我可以将 ListPreference 中的 AlertDialog 覆盖为 HoloEverywhere.AlertDialog 吗？

# linux - Unix 命令“uniq”和“排序”

> ID：12675454
> 
> 赞同：2
> 
> 时间：2012-10-01T14:40:36.047
> 
> 标签：linux, sorting, unix, command, uniq

众所周知

```
uniq [options] [file1 [file2]] 
```

它从已排序的 file1 中删除重复的相邻行。选项 -c 打印每一行一次，计算每一行的实例。因此，如果我们有以下结果：

```
 34 Operating System
    254 Data Structure
      5 Crypo
     21 C++
   1435 C Language
    589 Java 1.6 
```

我们对上面的数据使用“sort -1knr”进行排序，结果如下：

```
 1435 C Language
    589 Java 1.6
    254 Data Structure
     34 Operating System
     21 C++
      5 Crypo 
```

谁能帮我解决如何按此顺序仅输出书名（无编号）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:23:58.497

您也可以使用`sed`它，如下所示：

```
uniq -c filename | sort -k -1nr | sed 's/[0-9]\+ \(.\+\)/\1/g' 
```

测试：

```
echo "34 Data Structure" | sed 's/[0-9]\+ \(.\+\)/\1/g'
Data Structure 
```

这也可以通过简化的正则表达式来完成（由 William Pursell 提供）：

```
echo "34 Data Structure" | sed 's/[0-9]* *//'
Data Structure 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:45:58.383

```
uniq -c filename | sort -k 1nr | awk '{$1='';print}' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-22T12:44:24.753

为什么你`uniq -c`要打印出现次数，然后你想用一些 cut/awk/sed 舞蹈来删除它？

相反，您可以只使用

```
sort -u $file1 $file2 /path/to/more_files_to_glob* 
```

或者某些系统是否带有`sort`不支持的版本`-u`？

# c# - 去除默认 HTML 代码

> ID：12675457
> 
> 赞同：0
> 
> 时间：2012-10-01T14:40:49.020
> 
> 标签：c#, asp.net

我想创建一个 Web 表单，我将在其中基于 GET 参数通过 jQuery 执行一些后台操作，并打印 1 或 0。但问题 - ASP.NET 默认打印大量 HTML，即使在不存在此类代码的情况下标记窗口

```
<%@ Page Language="C#"%>
<%
  try
  {
    int cID = int.Parse(Request.QueryString["cid"].ToString());
    //do some job and print 1 or 0
  }
  catch { }
%> 
```

但是在输出窗口中我看到了 HTML 代码

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD>
<META content="text/html; charset=windows-1252" http-equiv=Content-Type></HEAD>
<BODY></BODY></HTML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:44:46.460

我建议您使用 ashx（添加新项目 > 通用处理程序）处理程序而不是 aspx 表单

在流程请求中将响应 Mime 类型更改为 text/plain 并将查询字符串值写入响应

MyHandler.ashx.cs：

```
/// <summary>
/// Summary description for MyHandler
/// </summary>
public class MyHandler : IHttpHandler
{

    public void ProcessRequest(HttpContext context)
    {
        context.Response.ContentType = "text/plain";
        context.Response.Write(context.Request.QueryString["cid"]);
    }

    public bool IsReusable
    {
        get
        {
            return false;
        }
    }
} 
```

使用 jQuery 获取客户端的价值：

```
 $.ajax({
            type: "GET",
            url: "MyHandler.ashx?cid=10",
            contentType: "text/plain",
            dataType: "text",
            success: function (data) {
                alert(data);
            }
        }) 
```

# c# - C#.NET - 错误记录和相对文件路径

> ID：12675460
> 
> 赞同：0
> 
> 时间：2012-10-01T14:41:00.877
> 
> 标签：c#, file, logging, relative-path

我在 C# 中有一个类，可以在发生异常时将错误消息保存在日志文件中。现在我想将日志文件保存在包含应用程序（在我的情况下是网站）文件的同一文件夹中。我尝试使用 Environment.CurrentDirectory 但是它没有检索到我的网站的路径。我该怎么做才能使用指向网站目录内的相对文件路径？

这是班级的代码。如您所见，路径是绝对的。我想将其更改为指向我网站目录中文件夹的相对文件路径。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T14:42:37.687

通常`Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location)`返回当前程序集所在的路径。你可以使用

```
string logName = Path.Combine(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location), "MyLogFile.log"); 
```

创建日志文件名。

问题实际上是操作系统是否允许登录到应用程序的文件夹。此外，对于 Web 应用程序，日志文件将是**公开可见的，并可通过 Web 浏览器访问**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:42:43.640

对于网站使用：

```
HttpContext.Current.Server.MapPath("~/"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T13:44:19.683

你也可以试试这个解决方案：

```
string path  = AppDomain.CurrentDomain.BaseDirectory + "anotherFolder"; 
```

这会将应用程序的基本目录和项目中的文件夹！

# ruby-on-rails-3 - 对非属性使用 Ransack sort_link

> ID：12675470
> 
> 赞同：6
> 
> 时间：2012-10-01T14:41:25.547
> 
> 标签：ruby-on-rails-3, ransack

我在我的 rails 项目中使用 Ransack 的 sort_link 来显示我的*付款*模式的费用列表。但是，“fee_amount”不是*支付*模型的属性，而是*账单*模型（属于支付）的类方法。我目前拥有的是：

> <%= sort_link @search, :bill_fee_amount, "便利费" %>

它应该访问当前*付款的**账单*并调用该账单上的“fee_amount”方法，该方法进行*一些*计算并返回一个浮点数。我希望通过这些花车进行搜索。

 **可以这样做，还是我只能按我正在处理的模型的属性排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-30T00:55:43.603

你不能用它来洗劫，但检查[这个问题](https://github.com/ernie/ransack/issues/61)。似乎有些人已经为这个功能做了补丁，但我还没有尝试过。

[Ransack](https://github.com/ernie/ransack)，在内部，它总是使用数据库中定义的模型，我不能让它使用范围创建的临时表。

PD：重新修改评论作为答案，因为我总是回到这个问题：P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T07:24:11.993

Ransack 是 MetaSearch 的继承者，根据 MetaSearch 文档，您可以创建自定义搜索。这是链接：

[https://github.com/ernie/meta_search](https://github.com/ernie/meta_search)

我认为这样的事情会起作用：

```
scope :sort_by_bill_fee_amount_asc, joins(:bill).select('sum("bills"."fee_amount") AS bill_fee_amount').order('bill_fee_amount ASC')
scope :sort_by_bill_fee_amount_desc, joins(:bill).select('sum("bills"."fee_amount") AS bill_fee_amount').order('bill_fee_amount DESC') 
```

这个问题不清楚计算究竟是什么，所以我认为它只是一个名为`fee_amount`. 不幸的是，它可能比这更糟糕，我认为讨厌的 SQL 计算需要包含在`Payment`模型中。

我认为的关键点是 SQL 需要包含您正在排序的列，因此您需要让 SQL 计算它并将其包含在 Ransack 想要搜索的名称中。

我希望这会有所帮助。**

# python - PDFminer 给出奇怪的字母

> ID：12675471
> 
> 赞同：2
> 
> 时间：2012-10-01T14:41:26.603
> 
> 标签：python, pdf, encoding

我正在使用 python2.7 和 PDFminer 从 pdf 中提取文本。我注意到有时 PDFminer 会给我带有奇怪字母的单词，但 pdf 查看器不会。同样对于 PDFminer 和其他 pdf 查看器返回的某些 pdf 文档结果是相同的（奇怪），但是有些文档 pdf 查看器可以识别文本（复制粘贴）。以下是返回值的示例：

来自 pdf 查看器：فتــح بــاب استيــراد البيــــــاج المجمـــد 来自 PDFMiner：ó `ªéªdG êÉ````LódGh ¢†``«ÑdG OGô``«à°SG ÜÉ`H í``àa

所以我的问题是我能否得到与 pdf 查看器相同的结果，以及 PDFminer 有什么问题。它是否缺少我不知道的编码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T12:39:27.090

是的。

这将在使用自定义字体编码（例如身份-H、身份-V 等）但未正确嵌入字体时发生。

pdfminer 在这种情况下会提供垃圾输出，因为需要编码来解释文本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-19T21:41:59.213

也许您尝试阅读的 PDF 文件的编码尚不被 pdfMiner 支持。

上个月我遇到了类似的问题，最后通过使用名为“pdfBox”的java库并从python调用它来解决它。pdfBox 库支持我需要的编码，并且工作起来就像一个魅力！

[首先，我从官方网站](https://pdfbox.apache.org/download.cgi)下载了 pdfbox ，然后从我的代码中引用了 .jar 文件的路径。

这是我使用的代码的简化版本（未经测试，但基于我的原始测试代码）。您将需要 subprocess32，您可以通过调用安装它`pip install subprocess32`

```
import subprocess32 as subprocess
import os
import tempfile

def extractPdf(file_path, pdfboxPath, timeout=30, encoding='UTF-8'):
    #tempfile = temp_file(data, suffix='.pdf')
    try:
        command_args = ['java', '-jar', os.path.expanduser(pdfboxPath), 'ExtractText', '-console', '-encoding', encoding, file_path]
        status, stdout, stderr = external_process(command_args, timeout=timeout)
    except subprocess.TimeoutExpired:
        raise RunnableError('PDFBox timed out while processing document')
    finally:
        pass#os.remove(tempfile)

    if status != 0:
         raise RunnableError('PDFBox returned error status code {0}.\nPossible error:\n{1}'.format(status, stderr))

    # We can use result from PDFBox directly, no manipulation needed
    pdf_plain_text = stdout
    return pdf_plain_text

def external_process(process_args, input_data='', timeout=None):
   process = subprocess.Popen(process_args,
                              stdout=subprocess.PIPE,
                              stdin=subprocess.PIPE,
                              stderr=subprocess.PIPE)
   try:
      (stdout, stderr) =  process.communicate(input_data, timeout)
   except subprocess.TimeoutExpired as e:
      # cleanup process
      # see https://docs.python.org/3.3/library/subprocess.html?highlight=subprocess#subprocess.Popen.communicate
      process.kill()
      process.communicate()
      raise e

   exit_status = process.returncode
   return (exit_status, stdout, stderr)

def temp_file(data, suffix=''):
   handle, file_path = tempfile.mkstemp(suffix=suffix)
   f = os.fdopen(handle, 'w')
   f.write(data)
   f.close()
   return file_path

if __name__ == '__main__':
    text = extractPdf(filename, 'pdfbox-app-2.0.3.jar') 
```

` 此代码并非完全由我编写。我遵循了其他堆栈溢出答案的建议，但那是一个月前，所以我失去了原始来源。如果有人找到我得到这段代码的原始帖子，请告诉我，这样我就可以为他们的代码给予他们应得的荣誉。

# c - C - 打印不同排列的星形图案

> ID：12675481
> 
> 赞同：1
> 
> 时间：2012-10-01T14:41:54.447
> 
> 标签：c

我的作业需要使用 for 循环打印出星形图案，如下所示：

```
!!!!!
!!!!
!!!
!!
! 
```

这是我的循环：

```
 int i, j;
    for(i=5;i<=1;i--)
    {
        for(j=1;j<=i;j++)
        {
            printf("!");
        }
        printf("\n");
    } 
```

实际上我已经成功打印出如下模式：

```
! 
!! 
!!! 
!!!! 
!!!!! 
```

通过以下循环：

```
 int i, j;
    for(i=1;i<=5;i++)
    {
        for(j=1;j<=i;j++)
        {
            printf("!");
        }
        printf("\n");
    } 
```

现在我很困惑为什么不能打印模式 1，因为没有发现错误。当我继续运行程序时，输出窗口也会关闭。

我的 Xcode 是 Ver 4.4.1

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T14:45:28.013

这个循环不能执行任何东西：

```
for(i=5;i<=1;i--) 
```

它说“从 开始`i = 5`，然后`i <= 1`; 做`i--`”。

在第一次迭代中， i 已经 > 1，所以你的循环甚至没有进入。

你应该做的是扭转条件：

```
for (i = 5; i>= 1; i--) 
```

这样，您将从 开始循环`i = 5`，然后执行`i--`while `i >= 1`。

`for`循环的一般思考规则：

```
for (A; B; C)
{
    D;
} 
```

相当于

```
A;
while (B)
{
    C;
    D;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:46:38.753

在您的第一个代码示例中，您编写以下内容：

```
for(i=5;i<=1;i--) 
```

永远不会进入这个 for 循环。在开始时`i`设置为 5。然后`i<=1`进行测试，它将返回`false`并跳过 for 循环。

你应该这样做：

```
for(i=5;i>=1;i--) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T14:59:51.217

停止条件下的循环错误。采用

```
for(i=5;i>=1;i--) 
```

代替：

 ~~~~```
for(i=5;i<=1;i--) 
```~~~~

# android - 开始在前台的活动

> ID：12675484
> 
> 赞同：0
> 
> 时间：2012-10-01T14:41:59.453
> 
> 标签：android

有没有办法知道我要开始的活动是否已经是前台的活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T17:51:01.707

您可以`Activity`在前台使用`ActivityManager`. 这是代码：

```
ActivityManager activityManager = (ActivityManager)getSystemService(Context.ACTIVITY_SERVICE);
List<ActivityManager.RunningTaskInfo> runningTaskInfos = activityManager.getRunningTasks(1);
String foreGroundActivityName = runningTaskInfos.get(0).topActivity.getClassName().toString(); 
```

然后，您可以将名称与您的`Activity`. 并确保 `android.permission.GET_TASKS`在清单文件中添加权限。

# vb.net - 使用 new Microsoft.VisualBasic.Devices.Computer().FileSystem.CopyDirectory( sourceFolder, outputFolder ) 排除文件夹；

> ID：12675485
> 
> 赞同：1
> 
> 时间：2012-10-01T14:42:05.183
> 
> 标签：vb.net, .net-4.0

是否可以使用新的排除文件夹

```
Microsoft.VisualBasic.Devices.Computer().
    FileSystem.CopyDirectory( sourceFolder, outputFolder ); 
```

这会将整个内容从源复制到目标，但是假设我不想复制某些文件夹，有没有办法排除这些。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T07:28:19.510

使用 Reflector，代码中似乎没有任何公共（或私有）挂钩，`CopyDirectory`以允许在复制时跳过某些文件夹或文件。

看起来您必须自己重做递归`CreateDirectory`和`CopyFile`循环，添加挂钩以检查跳过文件或文件夹的条件。

并注意`Directory`and`DirectoryInfo` `EnumerateFiles`和`EnumerateDirectories`重载（.NET Framework 4.0 的新功能）可能允许您通过模式匹配选择文件夹（或文件），否则使用 Linq。

另请注意，`CopyDirectory`代码都在.NET 中`Microsoft.VisualBasic`，因此不想包含该程序集/命名空间的 C# 爱好者已经不得不削减用于复制目录树的代码，因此您可能会发现一些只需要转换为 VB.NET 的示例.

# python - setup.py 中的代码生成

> ID：12675495
> 
> 赞同：7
> 
> 时间：2012-10-01T14:42:34.597
> 
> 标签：python

我有一些 XML 文件，我打算从中派生一些 python 源代码；它们是语言代码列表之类的东西。分发模块是否有一个可以为此目的插入的钩子？或许更清楚一点，我不想到处发布 XML。我只想发送 .py 文件。我想通过运行从 XML 生成它们的程序来派生一些 .py 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T02:18:51.227

你可以为你的代码生成过程[创建一个自定义的 distutils](https://stackoverflow.com/a/1712544/11265)命令，或者你可以[覆盖 build self](https://stackoverflow.com/a/11332078/11265)。不过，这将要求您包含 XML。

我可能会将代码生成转移到我的本地构建过程中，使用[zc.buildout](http://www.buildout.org/)和像[z3c.recipe.template](http://pypi.python.org/pypi/z3c.recipe.template)这样的模板配方。然后，XML 将成为开发构建的一部分，只有代码生成的 Python 文件包含在用户分发中。

# java - 使用 jsoup 从 html 获取评论并保存为 XML 文件

> ID：12675510
> 
> 赞同：0
> 
> 时间：2012-10-01T14:43:25.613
> 
> 标签：java, xml, netbeans, jsoup

我需要帮助！转到页面： http: [//www.tweetfeel.com/](http://www.tweetfeel.com/) 然后输入“linkin park”，使用jsoup获取所有用户评论保存为xml？我将java与netbeans一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T08:50:00.637

不确定jsoup是否可行，因为内容是由javascript动态生成的。

# php - SQL SELECT * 但有一个转折 - CodeIgniter

> ID：12675511
> 
> 赞同：0
> 
> 时间：2012-10-01T14:43:28.660
> 
> 标签：php, sql, codeigniter, prepared-statement

好的，可以说我想从数据库表中选择一些列，但我不知道这些列在方法中是什么。我可以将它们传递进去，但它可能或多或少取决于调用数据库方法的方法。

一个快速的解决方法是 SELECT *，但我知道这很糟糕，可能导致返回的数据多于必要的数据，而且我绝对不需要该表中的所有数据。

所以我正在使用 CodeIgniter 和准备好的语句来做到这一点，下面是我目前拥有的（它有效，只是指出这一点）。

```
function get_pages() {
        $this->db->select('pages.id, pages.title, pages.on_nav, pages.date_added, admin.first_name, admin.last_name')
                 ->from('pages, admin') 
                 ->where('pages.admin_id = admin.id')
                 ->order_by('pages.id', 'ASC');

        $query = $this->db->get();

        return $query->result();
    } 
```

这是一个简单的功能，但目前仅限于获取“页面”。我也想将其转换为从其他表中获取。什么是最好的方法？

提前谢谢了。

**编辑** 在 CodeIgniter 中我有很多控制器。一个用于“页面”，一个用于“产品”，一个用于“新闻”，等等。我不想在我的模型中为每个控制器创建一个数据库查询方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:13:59.393

我认为没有 4 种方法的愿望是错误的。如果您在方法中没有信息，则必须将其传入。因此您可以传入带有所需表的字符串，然后根据表名切换更改查询，或者传入查询的所有必要部分。这将包括表名、条件列、条件和要选择的列。并且每次调用该函数时都需要传递该信息。这两种方法都不会真正为您节省大量代码，而且它们的可读性都低于用于每种目的的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T21:30:58.570

在您的模型中：

```
function get_pages($table_source) {
    $this->db->select($table_source.".id"); // or $this->db->select('id');

// for instance, if one of your $table_source ="users" and there is no 'title' column you can write
    if($table_source!='users') $this->db->select('title');

    $this->db->select('on_nav');
    $this->db->select('date_added');
    $this->db->select('admin.first_name');
    $this->db->select('admin.last_name'); 
    $this->db->join('admin','admin.id = '.$table_source.'.admin_id') 
    $this->db->order_by('pages.id', 'ASC');

    $query = $this->db->get($table_source);

    return $query->result_array();
} 
```

在您的控制器中：

```
function all_tables_info() {
    $tables = array("pages","users","customers"); 
    $i=0;
    foreach($tables as $table) {
    $data[$i++]=$this->your_Model->get_pages($table);
 }
  //do somthing with $data
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T15:20:41.150

使用模型将您的特定查询放到其中的持久层的整个想法。使用通用的包罗万象的方法可能是灾难性的并且难以测试。你应该围绕你试图解决的问题来塑造你的模型。

这使它更清洁，更容易使用。同时，您还必须避免过度尺寸模型的常见陷阱。每个模型都应遵循 SRP。尝试分离关注点，以便在您的控制器中，您可以轻松查看状态更改。

这有意义还是我只是漫无目的......？

# android - 尝试使用 android.hardware.Camera.setDisplayOrientation 时出现 RuntimeException

> ID：12675512
> 
> 赞同：2
> 
> 时间：2012-10-01T14:43:30.343
> 
> 标签：android, android-camera

我在几台设备上测试了我的应用程序：在 HTC Wildfire S 上运行 Android 2.3.5 和三星 Galaxy Nexus 上运行 Android 4.1。在三星上它运行良好，但在 HTC 上它有时会在显示方向改变时崩溃。它崩溃异常：

```
10-01 18:08:40.521: VERBOSE/GeoWash(2111): ScanActivity: onPause
10-01 18:08:40.521: VERBOSE/GeoWash(2111): Camera release
10-01 18:08:41.312: VERBOSE/GeoWash(2111): CameraPreview: surfaceDestroyed
10-01 18:08:41.332: VERBOSE/GeoWash(2111): ScanActivity: onResume
10-01 18:08:41.572: VERBOSE/GeoWash(2111): CameraPreview: acquire
10-01 18:08:41.843: VERBOSE/GeoWash(2111): CameraPreview: surfaceChanged
10-01 18:08:41.863: VERBOSE/GeoWash(2111): onPictureTaken
10-01 18:08:42.023: DEBUG/mm-camera 7x-vfe(74): set vfe_ack_complete true
10-01 18:08:42.023: DEBUG/mm-camera 7x-vfe(74): VFE_START_ACK CAMERA_STATE_PREVIEW_VFE_STARTED
10-01 18:08:42.924: WARN/ActivityManager(136): Binding with unknown activity: HistoryRecord{40a0b4c8 ru.realweb.geowash/.view.ScanActivity}
10-01 18:08:43.084: VERBOSE/GeoWash(2111): CameraPreview: surfaceCreated
10-01 18:08:43.084: VERBOSE/GeoWash(2111): CameraPreview: surfaceChanged
10-01 18:08:43.174: ERROR/AndroidRuntime(2111): FATAL EXCEPTION: main
        java.lang.RuntimeException: set display orientation failed
        at android.hardware.Camera.setDisplayOrientation(Native Method)
        at ru.realweb.geowash.view.CameraView.setPreviewRotation(CameraView.java:647)
        at ru.realweb.geowash.view.CameraView.setupPreview(CameraView.java:570)
        at ru.realweb.geowash.view.CameraView.access$1500(CameraView.java:29)
        at ru.realweb.geowash.view.CameraView$CameraPreview.surfaceChanged(CameraView.java:518)
        at android.view.SurfaceView.updateWindow(SurfaceView.java:557)
        at android.view.SurfaceView.dispatchDraw(SurfaceView.java:348)
        at android.view.ViewGroup.drawChild(ViewGroup.java:1730)
        at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
        at android.view.ViewGroup.drawChild(ViewGroup.java:1730)
        at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
        at android.view.View.draw(View.java:6973)
        at android.view.ViewGroup.drawChild(ViewGroup.java:1732)
        at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
        at android.view.ViewGroup.drawChild(ViewGroup.java:1730)
        at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
        at android.view.View.draw(View.java:6973)
        at android.widget.FrameLayout.draw(FrameLayout.java:357)
        at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:1997)
        at android.view.ViewRoot.draw(ViewRoot.java:1600)
        at android.view.ViewRoot.performTraversals(ViewRoot.java:1321)
        at android.view.ViewRoot.handleMessage(ViewRoot.java:1957)
        at android.os.Handler.dispatchMessage(Handler.java:99)
        at android.os.Looper.loop(Looper.java:150)
        at android.app.ActivityThread.main(ActivityThread.java:4277)
        at java.lang.reflect.Method.invokeNative(Native Method)
        at java.lang.reflect.Method.invoke(Method.java:507)
        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
        at dalvik.system.NativeStart.main(Native Method) 
```

在以下地方：

```
private void setPreviewRotation( Camera camera ){
        Display display = ((WindowManager) getContext().getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
        if(display.getRotation() == Surface.ROTATION_0){
            camera.setDisplayOrientation(90);
        }
    } 
```

有什么建议吗？

# batch-file - 根据 Windows 系统类型（x86 或 x64）将可执行文件（x86 或 x64）复制到远程计算机

> ID：12675516
> 
> 赞同：0
> 
> 时间：2012-10-01T14:44:00.437
> 
> 标签：batch-file

我需要帮助来通过批处理文件实现以下目标。这就是我想要做的，

1.  运行 psexec 执行“systeminfo”，找到字符串“System Type”

2.  从 PsExec 输出中确定“系统类型”（是“基于 X86 的 PC”还是“基于 X64 的 PC”）。

3.  在我的 PC 上本地映射驱动器并根据系统类型复制文件。

这是我的脚本！

```
@echo off
set logs="C:\logs.txt"

for /f %%i in (C:\pro_arch.txt) do (

    echo %%i >> %logs%
    PsExec.exe \\%%i -u domain\username -p "password" systeminfo | findstr /c:"System Type" >> "%Logs%"

        if "%%i"=="System Type:               X86-based PC" (
        net use m: \\%%i\C$ /user:domain\username "password"
        xcopy "C:\batch_file\x86.txt" \\%%i\C$\_support\setup\ /y
        net use m: /delete
        ) else (
        net use m: \\%%i\C$ /user:domain\username "password"
        xcopy "C:\batch_file\x64.txt" \\%%i\C$\_support\setup\ /y
        net use m: /delete
        )
) 
```

该脚本运行良好，直到这部分

```
@echo off
set logs="C:\logs.txt"

for /f %%i in (C:\pro_arch.txt) do (

    echo %%i >> %logs%
    PsExec.exe \\%%i -u domain\username -p "password" systeminfo | findstr /c:"System Type" >> "%Logs%" 
```

并根据系统类型输出以下内容：

系统类型：基于 X86 的 PC 或系统类型：基于 X64 的 PC

当 IF 语句执行时，问题就来了。它仅将 x64.txt 复制到远程计算机，而与远程计算机的系统类型无关。

使用 psexec 输出的命令替换也不起作用，

`for /f "tokens=*" %%a in '(PsExec.exe \\IPaddress -u domain\username -p "password" systeminfo | findstr /c:"System Type")' do set myvar=%%a`

它说

`| was unexpected at this time`

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:09:30.130

%%i 包含计算机名称，而不是您的 PsExec 的结果，因此您的 IF 语句当然永远不会为真。

您必须引用或转义特殊字符，例如`|`在 FOR /F DO() 子句中使用时。我建议转义为`^|`

```
@echo off
set logs="C:\logs.txt"

for /f %%i in (C:\pro_arch.txt) do (
  echo %%i >> %logs%
  for /f "delims=" %%A in ('PsExec.exe \\%%i -u domain\username -p "password" systeminfo ^| findstr /c:"System Type"') do (
    >> "%Logs%" echo %%A
    if "%%A"=="System Type:               X86-based PC" (
      net use m: \\%%i\C$ /user:domain\username "password"
      xcopy "C:\batch_file\x86.txt" \\%%i\C$\_support\setup\ /y
      net use m: /delete
    ) else (
      net use m: \\%%i\C$ /user:domain\username "password"
      xcopy "C:\batch_file\x64.txt" \\%%i\C$\_support\setup\ /y
      net use m: /delete
    )
  )
) 
```

# php - PHP - 基于数据库查询的电子邮件地址

> ID：12675517
> 
> 赞同：0
> 
> 时间：2012-10-01T14:44:00.850
> 
> 标签：php, mysql, database, email

我正在尝试创建对用户单击广告并可以发送电子邮件的广告表单的回复，但是我不希望用户实际看到他们将其发送到的地址，而是可以从基于广告用户名的数据库

我已经尝试过这段代码，但似乎无法让它工作，任何帮助表示赞赏！

```
$username = $_SESSION['username'];

$sql = "SELECT * FROM user WHERE username=:username";
$q = $conn->prepare($sql);
$q->bindParam(':username', $username, PDO::PARAM_STR);
$q->execute();
$row = $q->fetch(PDO::FETCH_ASSOC);

$email1 = $row['email']; 

 $to='$email1';
$messageSubject='Message subject';
$confirmationSubject='Confirmation message subject';
$confirmationBody="Confirmation message body";
 $email='';
  $body='';
$displayForm=true;
if ($_POST){
$email=stripslashes($_POST['email']);
$body=stripslashes($_POST['body']);
// validate e-mail address
$valid=eregi('^([0-9a-z]+[-._+&])*[0-9a-z]+@([-0-9a-z]+[.])+[a-z]{2,6}$',$email);
$crack=eregi("(\r|\n)(to:|from:|cc:|bcc:)",$body);
if ($email && $body && $valid && !$crack){
  if (mail($to,$messageSubject,$body,'From: '.$email."\r\n")
      && mail($email,$confirmationSubject,$confirmationBody.$body,'From: '.$to."\r\n")){
    $displayForm=false; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:46:35.507

不要使用 ereg 函数。它们已被弃用并且存在严重问题。改用 preg。

要回答您的问题，这应该很简单

```
$to = $email1; 
```

或者更好的是，跳过那个阶段并做

```
$email1 = $row['email1']; 
```

使用`'`单引号，您将强制 PHP 将`$email1`其视为字符串，而不是变量。所以你试图发送到一个名为的地址`$email1`，而不是`$email1`变量的内容。

# ios - 如何使用新的 iOS 6 方法使文本居中？

> ID：12675519
> 
> 赞同：0
> 
> 时间：2012-10-01T14:44:08.217
> 
> 标签：ios, uitextfield, uilabel, text-alignment

我的旧代码

```
sectorLabel.textAlignment = UITextAlignmentCenter; 
```

Xcode 说 textAlignment 已被弃用。如何使用新方法？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T14:45:09.503

它现在使用与 Mac 相同的属性。

改用`NSTextAlignmentCenter`：D

高温高压

# asp.net - 如何在网站项目中创建嵌入式资源？

> ID：12675520
> 
> 赞同：3
> 
> 时间：2012-10-01T14:44:13.560
> 
> 标签：asp.net, .net

如何在网站项目中创建嵌入式资源？

在 Web 应用程序项目中，我可以通过文件的属性窗口更改“构建操作”。在网站项目中没有属性窗口。我注意到，在 Web 应用程序项目中，当您更改文件的构建操作时，.csproj 文件会发生更改。在网站项目中当然没有 .csproj 文件。

是否可以在网站项目中创建嵌入式资源？

主要是，我们将项目更改为 Web 应用程序项目。但我还是很好奇。。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:47:57.950

您不能添加嵌入式资源，因为网站项目没有预编译。没有生成的 dll 可嵌入资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:51:55.647

您仍然可以获得网站项目的属性窗口 - 您的意思是要标记网站项目中的项目以包含在部署中吗？如果是这样，可以通过将解决方案中所选文件的构建操作属性设置为内容来完成。

Embedded Resource 是一个选项，但针对的是您希望嵌入到与您的 App_Code 相对应的已编译 DLL 中的项目。然后，您需要从程序集中加载资源。

# android - Android 记事本教程：仍然是“最先进的”？

> ID：12675522
> 
> 赞同：1
> 
> 时间：2012-10-01T14:44:27.397
> 
> 标签：android, sqlite

我要为 android 制作我的第一个应用程序（不用担心它只是一个学校项目，不会成为市场上另一个无用的应用程序 :>）。

因此，在开始这项任务之前，我做了一些教程，其中之一（我认为这将非常有用，因为 sqlite 部分）是[记事本教程](http://developer.android.com/training/notepad)。在处理它时，我看到它最初是为 Android 1.8 或其他东西设计的（当然它仍然适用于我的 android 4.1）。

我现在真正想知道的是：这段代码在android编程中是否仍然是“最先进的”（尤其是sqlite，还有其他的：）还是“不推荐使用”？如果是这样，你能给我指出一些更新更好的东西吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:50:05.317

SQLite 绝对仍然是每个 Android 设备上默认可用的数据库。此外，本教程中涵盖的基础知识仍然适用于任何 Android 版本。当然，每个新版本的操作系统也提供了新的可能性，比如可以使用哪些控件或其他新的 API，但是对于非常简单的应用程序，本教程仍然有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:38:38.897

我浏览了这篇文章；它的大部分内容似乎对 Android 4.x 有效。尽管我认为本教程在任何地方都没有提到片段：它们是在 Android 3.0 中引入的。

我认为本教程之后的一个重要练习是阅读片段文档；查看一些示例（如图库应用程序）并重写记事本以使用片段。
如果您的应用支持的最低 Android 版本低于 Android 3.0，您将不得不使用 Support Library 才能使用 Fragment，但我认为这也是一个有趣的练习。

一个小提示：许多初学者（也有经验丰富的开发人员 :)）错误来自在应用程序中添加新元素但忘记在 manifest.xml 中声明它。

# extjs - Extjs 选项卡调整大小

> ID：12675526
> 
> 赞同：1
> 
> 时间：2012-10-01T14:44:43.700
> 
> 标签：extjs, tabpanel

我已经实现了一个包含两个网格的 EXTJS 4.0 选项卡面板。

当我第一次加载它时，这一切都运行良好。但是当我转到另一个面板（不是选项卡面板的子面板）然后在视口中重新加载选项卡面板或调整我的浏览器窗口大小时，HTML 子主客户端（我的网格）消失（并且它的 HTML 元素已从选项卡面板中删除）。

![在此处输入图像描述](../Images/384b804933ab6e05c5ad87d4ac55ad48.png)

有人知道为什么会这样吗？

标签面板：

```
Ext.define('EY.view.center.home.container.Panel', {
    extend: 'Ext.tab.Panel',
    alias: 'widget.containerhome',
    id: 'containerhome',
    activeTab: 1,

    border: false,
    resizeTabs:true,

     items: [{
            title: 'Most Used clients',
            iconCls: 'tabIcon',
            xtype: 'mostUsedClients',
            id: 'mostUsedClients',
            scale: 'large'
        },{
                title: 'All Clients',
                xtype: 'homeclients',
                id: 'homeclients',
                scale: 'large'
            }
        ],
    requires: [
        'EY.view.center.home.client.Grid',
         'EY.view.center.home.client.mostUsedClients.mostUsedClients'
],

    initComponent: function () {
        Ext.apply(this, {

        })
        this.callParent(arguments);
    }
}); 
```

网格：

```
Ext.define('EY.view.center.home.client.Grid', {
    extend: 'Ext.grid.Panel',
    alias: 'widget.homeclients',
    id: 'homeclients',
    baseCls: 'homeclients',
    //frame:true,
    store: 'Clients', //Ext.data.StoreManager.lookup('serviceStore'),
    contextMenu: undefined,

    border: false,
    //flex: 1,
    padding: 3,
    hideHeaders: true,

    columns: [
        { header: 'CLIENTS', field: 'textfield', flex: 1 }

        ],

    features: [
        Ext.create('Ext.grid.feature.RowBody', {
            getAdditionalData: function (data, rowIndex, rec, orig) {
                var headerCt = this.view.headerCt;
                var colspan = headerCt.getColumnCount();
                return {

                    rowBody: createHtml(rec),
                    rowBodyCls: this.rowBodyCls,
                    rowBodyColspan: colspan
                };
            }
        }),
         {
             ftype: 'rowwrap'
         }
    ],

    viewConfig: {
        listeners: {
            itemclick: function (list, index, target, record, event) {
                if (event.target.id == 'grandAccess') {

                    var windowIsClosed = Ext.getCmp('ConfirmationWindow');
                    if (!windowIsClosed) {
                        var clientId = index.data.id;
                        var clientVat = index.data.rn;
                        eDocsUser.currentClientName = index.data.n;
                        eDocsUser.currentClientId = clientId;
                        eDocsUser.currentClientRegisterNummer = clientVat;

                        showGrantAccesWindow(index);
                    }
                } else {

                    if (Ext.getCmp('ConfirmationWindow')) {
                        Ext.getCmp('ConfirmationWindow').hide();
                    }
                    loadDataOfSelectedClient(index);
                }

            }
        }
    },

    initComponent: function () {

        this.callParent(arguments);

    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T13:59:00.680

我们通过将网格更改为用于调整大小问题的数据视图来解决此问题（网格可能会给我带来很多问题）。

然后我们通过更改解决了另一个问题：

```
layout.setActiveItem(Ext.getCmp('containerhome'), {
                                type: 'slide',
                                direction: 'left',
                                duration: 5000
                            }); 
```

到

```
layout.setActiveItem(0); 
```

我们（但不是我......：D）创建了一个新项目，而不是在卡片面板中调用旧项目。

# wolfram-mathematica - 使用 Total 和阈值参数减少列表的长度

> ID：12675529
> 
> 赞同：2
> 
> 时间：2012-10-01T14:44:51.203
> 
> 标签：wolfram-mathematica

我正在寻找一种使用 Total 函数和阈值参数来减少巨大列表长度的方法。我想避免使用 For 和 If （来自旧习惯）。

示例：我想“减少”`{1,5,3,8,11,3,4}`的列表：阈值为`5`.

我想要的输出：`{6,11,11,7}` 这意味着我在列表的第一部分使用 Total 函数并查看该函数的结果是否高于我的阈值。如果是这样，我使用 Total 函数的结果并转到列表的下一部分。

另一个例子是`{1,1,1,1,1}`阈值为`5`。结果应该是`{5}`。

谢谢！

编辑：它正在工作，但速度很慢。有什么想法可以更快吗？

编辑2：循环的东西（退出简单而不聪明）

```
For[i = 1, i < Length[mylist] + 1, i++,
sum = sum + mylist[[i]];
  If[sum > Threshold ,
result = Append[result , sum]; sum = 0;   ];   ]; 
```

编辑3：我现在有一件新事情要做。我现在必须使用 2D 列表，例如`{{1,2}{4,9}{1,3}{0,5}{7,3}}` 它或多或少是相同的想法，但列表的第一和第二部分必须高于阈值（两者）。示例：`If lst[[1]] and lst[[2]] > threshold do the summuation`对于 2D 列表的每个部分。我试图将 Mr.Wizard 的 f2 函数用于这种情况，但我没有成功。如果更简单，我可以提供 2 个独立列表并使用此输入`f3[lst1_,lst2_,thres_]:= Reap[Sow@Fold[If[Element of the lst1 > thr && Element of the lst2, Sow@#; #2, # + #2] &, 0, lst1]][[2, 1]]`。

编辑4：你是对的，这不是很清楚。但是该`Min@# > thr`语句的使用效果很好。

旧代码（丑陋而且一点也不聪明）：

```
sumP = 0;
resP = {};
sumU = 0;
resU = {};
For[i = 1, i < Length[list1 + 1, i++,
 sumP = sumP + list1[[i]];
 sumU = sumU + list2[[i]];
 If[sumP > 5 && sumU > 5 ,
  resP = Append[resP, sumP]; sumP = 0;
  resU = Append[resU, sumU]; sumU = 0;
  ];
 ] 
```

向导先生的新快速：

```
 f6[lst_, thr_] := 
 Reap[Sow@Fold[If[Min@# > thr  , Sow@#1; #2, #1 + #2] &, 0, lst]][[2, 
   1]] 
```

这大约快 40 倍。非常感谢。

```
Thread[{resP, resU}] == f6[Thread[{list1,list2}], 5] True 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T17:53:35.997

我建议使用`Fold`这种操作，结合链表或`Sow`和`Reap`来累积结果。 `Append`很慢，因为*Mathematica*中的列表是数组，每次添加元素时都必须重新分配。

从...开始：

```
lst = {2, 6, 4, 4, 1, 3, 1, 2, 4, 1, 2, 4, 0, 7, 4}; 
```

这是链表版本：

```
Flatten @ Fold[If[Last@# > 5, {#, #2}, {First@#, Last@# + #2}] &, {{}, 0}, lst] 
```

> ```
> {8, 8, 7, 7, 11, 4} 
> ```

这是之前的输出`Flatten`：

> ```
> {{{{{{{}, 8}, 8}, 7}, 7}, 11}, 4} 
> ```

* * *

这是使用`Sow`and的方法`Reap`：

```
Reap[Sow @ Fold[If[# > 5, Sow@#; #2, # + #2] &, 0, lst]][[2, 1]] 
```

> ```
> {8, 8, 7, 7, 11, 4} 
> ```

类似的方法应用于其他问题：[(1)](https://mathematica.stackexchange.com/a/2307/121) [(2)](https://mathematica.stackexchange.com/a/6654/121)

`Sow @`外部的有效`Fold`地附加了序列的最后一个元素，否则该元素会被算法删除。

* * *

以下是打包为函数的方法，以及为便于比较的 George 方法：

```
f1[lst_, thr_] := 
  Flatten @ Fold[If[Last@# > thr, {#, #2}, {First@#, Last@# + #2}] &, {{}, 0}, lst]

f2[lst_, thr_] := 
  Reap[Sow@Fold[If[# > thr, Sow@#; #2, # + #2] &, 0, lst]][[2, 1]]

george[t_, thresh_] := Module[{i = 0, s},
  Reap[While[i < Length[t], s = 0; 
     While[++i <= Length[t] && (s += t[[i]]) < thresh]; Sow[s]]][[2, 1]]
  ] 
```

时间：

```
big = RandomInteger[9, 500000];

george[big, 5] // Timing // First 
```

> 1.279

```
f1[big, 5] // Timing // First

f2[big, 5] // Timing // First 
```

> 0.593
> 
> 0.468

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:03:08.587

我将您的要求解释为：

*   如果列表中的某个元素小于阈值，则将其添加到列表中的下一个元素；
*   重复此过程，直到列表不再更改。

所以，对于你会得到的阈值`5`和输入列表`{1,5,3,8,11,3,4}`

```
{6,3,8,11,3,4}
{6,11,11,3,4}
{6,11,11,7} 
```

**编辑**

我现在已经测试了这个解决方案来解决你的问题......

使用替换规则实现操作：

```
myList = {1,5,3,8,11,3,4}
threshold = 5
mylist = mylist //. {a___, b_ /; b < threshold, c_, d___} :> {a, b+c, d} 
```

注意`ReplaceRepeated`（符号化`//.`）的使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-02T14:54:06.177

这是一个明显的方法，它快了 300 倍。漂亮并不总是最好的。

```
t = Random[Integer, 10] & /@ Range[2000];
threshold = 4;
Timing[
  i = 0; 
  t0 = Reap[
     While[i < Length[t], s = 0; 
     While[++i <= Length[t] && (s += t[[i]]) < threshold ]; 
     Sow[s]]][[2, 1]]][[1]]
Total[t] == Total[t0]
Timing[ t1 = 
   t //. {a___, b_ /; b < threshold, c_, d___} -> {a, b + c, d} ][[1]]
t1 == t0 
```

# javascript - Wordpress 条件 Javascript 包含

> ID：12675530
> 
> 赞同：1
> 
> 时间：2012-10-01T14:44:51.080
> 
> 标签：javascript, wordpress, conditional-statements

我正在尝试有条件地在 wordpress 的特定页面上包含 javascript 文件。我终于找到了一段代码，它完全符合我的要求，但它似乎不起作用。有什么想法吗？我没有包含真实的页面名称，但我使用的是页面 slug。

```
<?php if (is_page(array('page-slug','page-slug','page-slug'))) { ?>
   <script src="<?php echo get_template_directory_uri(); ?>/js/script.js"></script>
<? } else { ?>
   <script src="<?php echo get_template_directory_uri(); ?>/js/script.js"></script>
   <script src="<?php echo get_template_directory_uri(); ?>/js/conditional-script.js">    </script>
<? } ?> 
```

我将此代码放在我在自定义模板文件中调用其余脚本的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:09:00.257

在倒数第三行和最后一行，看起来您正在使用`<?`打开该行。尝试`<?php`改用。所以，它应该是：

```
<?php
if (is_page(array('page-slug','page-slug','page-slug'))) 
{ ?>
    <script src="<?php echo get_template_directory_uri(); ?>/js/script.js"></script>
<?php
} 
else 
{ ?>
    <script src="<?php echo get_template_directory_uri(); ?>/js/script.js"></script>
    <script src="<?php echo get_template_directory_uri(); ?>/js/conditional-script.js"></script>
<?php
}
?> 
```

正如我所提到的，我建议将来将[脚本](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)加入队列；）

# android - 项目文件未在目标 API 上运行

> ID：12675537
> 
> 赞同：0
> 
> 时间：2012-10-01T14:45:18.613
> 
> 标签：android, eclipse

以下行是我从控制台得到的错误

```
[2012-10-01 20:34:24 - User Tracking Client] Android Launch!
[2012-10-01 20:34:24 - User Tracking Client] adb is running normally.
[2012-10-01 20:34:24 - User Tracking Client] Performing com.buet.tracker.Copy_2_of_MainActivity activity launch
[2012-10-01 20:34:30 - User Tracking Client] Launching a new emulator with Virtual Device 'avd4.0.3'
[2012-10-01 20:34:32 - User Tracking Client] New emulator found: emulator-5554
[2012-10-01 20:34:32 - User Tracking Client] Waiting for HOME ('android.process.acore') to be launched...
[2012-10-01 20:36:21 - User Tracking Client] HOME is up on device 'emulator-5554'
[2012-10-01 20:36:21 - User Tracking Client] Uploading User Tracking Client.apk onto device 'emulator-5554'
[2012-10-01 20:36:21 - User Tracking Client] Installing User Tracking Client.apk...
[2012-10-01 20:38:26 - User Tracking Client] Failed to install User Tracking Client.apk on device 'emulator-5554!
[2012-10-01 20:38:26 - User Tracking Client] (null)
[2012-10-01 20:38:26 - User Tracking Client] Failed to install User Tracking Client.apk on device 'emulator-5554': device not found
[2012-10-01 20:38:26 - User Tracking Client] com.android.ddmlib.InstallException: device not found
[2012-10-01 20:38:26 - User Tracking Client] Launch canceled! 
```

模拟器运行正常，但从控制台显示它没有检测到 api

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:50:37.267

您是否在 Eclipse 中看到了项目中的正确库？

在您的项目上单击右键并转到属性。在 Android 选项卡中，您可以设置项目的正确目标。检查您是否选择了一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:53:52.307

从 android sdk 显式打开您的模拟器，一旦它被加载，然后从 eclipse 在当前模拟器中手动运行您的应用程序。

希望这可以帮助。

# c++ - 如何在 C++ 中编写比较运算符？

> ID：12675547
> 
> 赞同：2
> 
> 时间：2012-10-01T14:45:54.403
> 
> 标签：c++

我有一个包含三个字段的结构数组：

```
struct data{
   int s;
   int f;
   int w;   
};

struct data a[n]; 
```

为了根据字段 f 对结构数组进行排序，我使用了自己的比较运算符：

```
bool myf( struct data d1,const struct data d2){
   return d1.f < d2.f ; 
} 
```

上述运算符在内置`sort()`函数中工作正常：

```
 sort(a,a+n,myf); 
```

但它不适用于`upper_bound()`功能：

```
 upper_bound(a,a+n,someValue,myf); 
```

谁能告诉我我在哪里做错了？我的比较运算符错了吗？如果它是错误的，它为什么工作`sort() function and not upper_bound()`？

我正在关注编译：

```
 /usr/lib/gcc/i686-pc-linux-gnu/4.3.4/include/g++-v4/bits/stl_algo.h: In function     ‘_FIter std::upper_bound(_FIter, _FIter, const _Tp&, _Compare) [with _FIter = data*, _Tp =     int, _Compare = bool (*)(data, data)]’:
   prog.cpp:37:   instantiated from here

    /usr/lib/gcc/i686-pc-linux-gnu/4.3.4/include/g++-v4/bits/stl_algo.h:2243: error: conversion from ‘const int’ to non-scalar type ‘data’ requested 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T14:52:02.113

您真正需要的只是`operator<`为您的类型创建：

```
inline bool operator<( const data& lhs, const data& rhs ) {
    return lhs.f < rhs.f;
} 
```

标准算法将为您神奇地工作。

在 C++ 中，您不需要`struct`像在 C 中那样引用类型，并且您希望*通过 const 引用*传递以避免复制。

### 编辑0：

上面为您的类型重载了标准比较运算符`<`。您可以将其隐式用作：

```
data values[N];
// ... populate
std::sort( values, values + N ); 
```

或显式使用标准函子：

```
std::sort( values, values + N, std::less<data>()); 
```

### 编辑1：

看到编译器`_Tp = int`在警告中告诉你了吗？您需要将 的实例`data`作为第三个参数传递给`upper_bound`，而不是`int`：

```
data xxx = { 0, 1, 7 };
auto iter = std::upper_bound( values, values + N, xxx ); 
```

您还可以创建用于与整数进行比较的重载，例如：

```
inline bool operator<( const data& lhs, int rhs ) {
    return lhs.f < rhs;
}

inline bool operator<( int lhs, const data& rhs ) {
    return lhs < rhs.f;
} 
```

使您的原始调用生效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:48:56.123

首先，它不起作用，因为`upper_bound`接受自定义排序的重载需要四个参数：

```
// http://en.cppreference.com/w/cpp/algorithm/upper_bound
template< class ForwardIt, class T, class Compare >
ForwardIt upper_bound( ForwardIt first, ForwardIt last, const T& value, 
                       Compare comp ); 
```

`operator<`在您为您的类型介绍的另一个答案中提出了建议。但是，**不要仅仅为了一个特定的排序而这样做**。**仅当它们对您的类型有意义**时才引入比较运算符。

如果你不遵守这条规则，未来的程序员可能会使用你的类型并想知道为什么某些东西不应该有效，反之亦然。你未来的邪恶双胞胎可能还想为他的目的使用另一种分类。

例如，它对`complex`-datatype 类、SIMD 类（如）有意义，但对于一个类`std::valarray`没有任何*特定*`Employee`意义：

```
Employee foo, bar;

if (bar > foo) {
    // is bar taller than foo?
    // is bar older than foo?
    // is bar working better than foo?
    // is bar bigger newbie than foo?
} 
```

相反，您可以这样做：

```
namespace employee_ordering {
    struct by_name_ascending {
        bool operator() (Employee const &lhs, Employee const &rhs) const {
            return lhs.name() < rhs.name();
        }
    };

    struct by_name_descending {
        bool operator() (Employee const &lhs, Employee const &rhs) const {
            return lhs.name() > rhs.name();
        }
    }
};

....

upper_bound(first, last, ..., employee_ordering::by_name_ascending()); 
```

# c# - HashSet 作为数据源

> ID：12675550
> 
> 赞同：14
> 
> 时间：2012-10-01T14:46:02.630
> 
> 标签：c#, asp.net, .net, sharepoint

我正在尝试优化 SharePoint webpart 的代码。我有一个中继器控件：

```
<asp:Repeater ID="CountryOptionsRepeater" runat="server">
    <ItemTemplate>
        <option value='<%#Eval("CountryName") %>'><%#Eval("CountryName") %></option>
    </ItemTemplate>
</asp:Repeater> 
```

我用数据表填充它

```
countriesList = countriesList.Distinct<String>().ToList<String>();
countriesList.Sort();
//var noDupsCountriesList = new HashSet<String>(countriesList);

DataTable dt = new DataTable();
dt.Columns.Add("CountryName");

foreach (String countryName in countriesList)
{
    DataRow dr = dt.NewRow();
    dr["CountryName"] = countryName;
    dt.Rows.Add(dr);
}

CountryOptionsRepeater.DataSource = dt;
CountryOptionsRepeater.DataBind();
this.DataBind(); 
```

有没有办法直接将HashSet对象（noDupsCountriesList）绑定到具有相同repeater配置的DataSource，以实现优化？

就像是：

```
//countriesList = countriesList.Distinct<String>().ToList<String>();
//countriesList.Sort();
var noDupsCountriesList = new HashSet<String>(countriesList);

CountryOptionsRepeater.DataMember = "CountryName"; // ??
CountryOptionsRepeater.DataSource = noDupsCountriesList;
CountryOptionsRepeater.DataBind();
this.DataBind(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T15:45:17.477

我认为这一行可以替换您的第二个代码块：

```
CountryOptionsRepeater.DataSource = 
    countriesList
    .Distinct()
    .OrderBy(c => c)
    .Select(c => new { CountryName = c })
    .ToList(); 
```

# c# - 自定义服务器控件的浏览对话框

> ID：12675551
> 
> 赞同：0
> 
> 时间：2012-10-01T14:46:03.067
> 
> 标签：c#, asp.net

我创建了一个继承自 Hyperlink 的自定义服务器控件。呈现控件后的输出 html 是一个漂亮的带有图标的 css 按钮。对于图标，我有一个字符串属性。

我想做的是在源代码上打开类似于 NavigateUrl 属性对话框的图标的“浏览文件对话框”，请参见下面的屏幕

![在此处输入图像描述](../Images/eedc343c3628474774d06e48c941cdd8.png)

如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:48:11.310

看看 [`UrlPropertyAttribute`](http://msdn.microsoft.com/en-us/library/system.web.ui.urlpropertyattribute%28v=vs.100%29.aspx)。

# asp.net - 如何将 .aspx 标记中创建的 TemplateField 添加到代码后面的 GridView 列？

> ID：12675556
> 
> 赞同：2
> 
> 时间：2012-10-01T14:46:19.470
> 
> 标签：asp.net, gridview, controls, templatefield

基本上，我想要一个按钮，将带有我的控件（即 TextBox、DropDownList）的新列添加到我的 GridView。

这看起来已经很简单了：

```
protected void btn_AddColumn_Click(object sender, EventArgs e)
{
    TemplateField MyTemplateField = new TemplateField();
    gv_SupplierPrices.Columns.Add(MyTemplateField);
} 
```

假设我想添加这个标记：

```
<asp:TemplateField>
    <ItemTemplate>
       <table style="width:100%;">
          <tr>
             <td><asp:TextBox ID="tbox_ItemPrice" runat="server"></asp:TextBox></td>
          </tr>
       </table>
     </ItemTemplate>
</asp:TemplateField> 
```

这就是问题所在。如何使用我在 .aspx 页面上的标记中创建的 TemplateField 并将其添加到我在代码后面的新列中？我不知道也不想在后面的代码上创建我的 TemplateField，因为我将无法创建精致或花哨的标记。它们看起来就像彼此相邻的控件。这是非常丑陋的。

PS 如果有人对我实际制作的内容感到好奇，我基本上是在将我的 GridView 变成类似 Excel 的网格表。新列代表供应商，每一行代表供应商正在销售的商品。他们希望这样，因为在他们填满的时候更容易并排比较价格。

* * *

**更新：我已经想通了。我可以简单地从代码隐藏中调用我的 GridView 的列，该列代表我在标记中创建的 TemplateField，然后添加它。**

```
<asp:GridView ID="gv_SupplierTable" runat="server" AutoGenerateColumns="False" 
                        DataKeyNames="Id" DataSourceID="TestTable_DS">
                        <Columns>
                            <asp:BoundField DataField="Id" HeaderText="Id" InsertVisible="False" 
                                ReadOnly="True" SortExpression="Id" />
                            <asp:BoundField DataField="AccountType" HeaderText="AccountType" 
                                SortExpression="AccountType" />
                            <asp:TemplateField AccessibleHeaderText="MyTemplateFieldCreated in Markup">
                                <ItemTemplate>
                                    <table style="width:100%;">
                                        <tr>
                                            <td><asp:TextBox ID="tbox_ItemPrice" runat="server"></asp:TextBox></td>
                                        </tr>
                                    </table>
                                </ItemTemplate>
                            </asp:TemplateField>
                        </Columns>
                    </asp:GridView> 
```

然后在代码隐藏中，我可以访问代表在标记中创建的 TemplateField 的列，并在单击按钮时再次添加它，就像一个新副本：

```
 protected void btn_AddColumn_Click(object sender, EventArgs e)
    {
    DataControlField newColumn = this.gv_SupplierTable.Columns[2]; 
                                 //this column at index #2 from my GridView represents                  
                                 the TemplateField created in markup since the columns  
                                 at index #0 and index #1 are DataBound.
    gv_SupplierTable.Columns.Add(newColumn);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T22:01:19.823

在您的位置上，我会考虑硬着头皮研究以编程方式创建模板化字段。这会很麻烦，但是一旦你完成了，你就完成了。当然，您希望将它们抽象为辅助类或单独的控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:46:56.977

您可以切换每列的可见性。

```
gv_SupplierPrices.Columns[10].Visible = true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T22:13:14.263

这里有几个关于动态添加列的例子`GridView`：

```
protected void Page_Init(object sender, EventArgs e)
{
    btnAddColumn.Click += new EventHandler(btnAddColumn_Click);

    BoundField temp = new BoundField();
    temp.DataField = "Source";
    temp.HeaderText = "Source";
    temp.SortExpression = "Source";

    gv.Columns.Add(temp);
}

void btnAddColumn_Click(object sender, EventArgs e)
{
    TemplateField temp = new TemplateField();
    temp.HeaderText = txtNewColumn.Text;

    txtNewColumn.Text = string.Empty;

    gv.Columns.Add(temp);
} 
```

ASPX：

```
<div>
    <asp:TextBox ID="txtNewColumn" runat="server" />
    <asp:Button ID="btnAddColumn" runat="server" Text="Add Column" />
</div>
<asp:GridView ID="gv"
    runat="server"
    AutoGenerateColumns="False"
    DataSourceID="dsExceptions">
    <Columns>
        <asp:BoundField DataField="Message" HeaderText="Message" />
    </Columns>
</asp:GridView>

<asp:ObjectDataSource ID="dsExceptions"
    runat="server" 
    SelectMethod="GetExceptions"
    TypeName="WebApplication.Data.MyDataContext" EnablePaging="True" 
    SelectCountMethod="GetExceptionCount" >
    <SelectParameters>
        <asp:Parameter Name="maximumRows" Type="Int32" />
        <asp:Parameter Name="startPageIndex" Type="Int32" />
        <asp:Parameter Name="startRowIndex" Type="Int32" />
    </SelectParameters>
</asp:ObjectDataSource> 
```

我的 ObjectDataSource 只是获取`Exceptions`我创建的集合，因此您可以忽略这部分代码。

所以我通过`Page_Init`处理程序中的代码添加一列，以及添加一个标题文本设置为`txtNewColumn`. 但是，关于这一点的一件事是，如果您刷新页面，它将丢失您使用页面上的按钮添加的列。您需要在按钮单击事件处理程序中添加一些代码来存储新列，因此它们总是在`GridView`重新加载时出现。由于听起来这些列代表供应商，因此您可能只想添加一个表单以供某人将供应商添加到您的系统中。供应商被保存在某处的数据库/数据存储中，在 中`Page_Init`，您从该数据存储中获取所有供应商并循环它们，为供应商创建模板字段。它会是这样的：

```
// I am just creating a list here, you would pull the vendor names in from the 
// datastore here instead.
var vendors = new List<string> { "Vendor A", "Vendor B", "Vendor C" };
foreach (var vendor in vendors)
{
    TemplateField temp = new TemplateField();
    temp.HeaderText = vendor;
    gv.Columns.Add(temp);
} 
```

# php - 2列中的MySQL名称和姓氏与1列中的名称

> ID：12675565
> 
> 赞同：3
> 
> 时间：2012-10-01T14:46:53.407
> 
> 标签：php, mysql, performance

一个简单的问题，我找不到任何答案 id ：

name 应该在 2 个不同的 DB 列（name/surname）还是在 1 个列（name + surname）？

在我拥有的所有项目中，它们位于 2 个不同的列中，但现在我必须开始一个新项目，我想知道如何更好地存储它。我的意思是，2 个不同的列给我带来了一些麻烦，有时还会降低性能。请注意这非常重要的事情：

*   该站点公共部分的一个非常重要的部分将是高级搜索，它将在大约 20 万条记录中搜索全名。

所以你有什么建议 ？2列还是1？我倾向于使用 1 列解决方案，因为我找不到使用 2 的任何优势，但也许我错了？

**编辑**

谢谢你的回答。这个问题的唯一原因是性能问题，我需要我能得到的所有额外提升。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T14:48:15.240

关系数据库的重点是关联数据。如果您将全名（例如 John Smith）存储在单个字段中，您将无法轻松区分名字和姓氏。

如果将它们存储在单独的字段中，则可以非常轻松地将它们重新组合成一个全名，但是很难可靠地将名称分开成单独的名字 + 姓氏组件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T14:48:11.890

两列更加灵活。例如。

*   你想按姓氏排序吗？
*   您是否曾经想正式向该人讲话（例如：亲爱的 Cosmin 先生）？
*   您是否想按姓氏而不是姓氏进行搜索，反之亦然？

在任何设计合理的数据库中，20 万条记录都是微不足道的。

您可能会发现这是一本关于[名称主题的有趣读物](http://www.kalzumeus.com/2010/06/17/falsehoods-programmers-believe-about-names/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:49:12.107

使用两列，您可以按姓氏排序，而无需在 select 语句中执行昂贵的子字符串操作。在需要它的情况下，很容易执行 CONCAT 来获取全名，但很难从诸如“John Doe-Smith”或“John Doe III”之类的名称中解析出姓氏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T14:49:24.927

在我看来，我宁愿将它设计为**两个不同的列**，因为您可以有多种方式来处理记录。关于性能问题，在两列上添加索引以加快搜索速度。

有时您想要搜索`John Doe`并希望即使它是反向的`Doe John`但仍匹配到`John Doe`. 这是名称上具有单独字段的优点之一。

模式的示例设计，

```
CREATE TABLE PersonList
(
    ID INT AUTO_INCREMENT,
    FirstName VARCHAR(25),
    LastName VARCHAR(25),
    -- other fields here,
    CONSTRAINT tb_pk PRIMARY (ID),
    CONSTRAINT tb_uq UNIQUE (FirstName, LastName)
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-01T14:52:44.767

使用 2 列可以帮助您：

*   按姓氏轻松排序数据
*   通过姓名与用户交流（例如，许多网站上使用的“Hello Michael”等）
*   在多列中显示大量数据（当屏幕上没有空间时，您只能显示姓氏）

以“姓氏”格式存储的名称仍然易于排序，但在某些国家/地区可能会被视为不雅。

# java - Ant 的运行时类路径找不到 javac 的依赖项

> ID：12675571
> 
> 赞同：0
> 
> 时间：2012-10-01T14:47:03.490
> 
> 标签：java, ant, classpath, javac

我正在尝试让 Ant 编译我的项目，该项目具有以下目录结构：

```
MyProject/
    src/main/java/
        com/
            <The rest of my source>
    gen/
        bin/
            main/
                <Where I want all Java sources compiled to>
    lib/
        main/
            <All of my dependencies>
    build.xml
    build.properties 
```

这是我的 Ant 任务：

```
<path id="src.main.java.path">
    <fileset dir="src/main/java">
        <include name="**.*java"/>
    </fileset>
</path>

<path id="lib.main.path">
    <fileset dir="lib/main">
        <include name="**.*jar"/>
    </fileset>
</path>

<target name="compile">
    <javac includeantruntime="true" srcdir="src/main/java" destdir="gen/bin/main">
        <!--
        Define a new classpath composed of all main Java sources and main Java dependencies,
        and use them for this compilation.
        -->
        <classpath>
            <pathelement path="src.main.java.path"/>
            <pathelement path="lib.main.path"/>
        </classpath>
    </javac>
</target> 
```

我应该提到它`build.xml`位于项目根目录，并且它的`basedir`属性设置为`"."`（项目根目录）。

当我运行“编译”任务时，我得到 100 多个编译器错误，它找不到我的任何项目依赖项（例如 Guice、Joda-Time、XStream 等）：

```
compile:
    [javac] Compiling 53 source files to /<path-to-my-project-root>/MyProject/gen/bin/main
    [javac] /<path-to-my-project-root>/MyProject/src/main/java/org/me/Widget.java:37: package com.google.inject does not exist
    [javac] import com.google.inject.AbstractModule;
    [javac]                         ^
    [javac] /<path-to-my-project-root>/MyProject/src/main/java/org/me/MyWidget.java:45: cannot find symbol
    [javac] symbol: class AbstractModule
    [javac] public class AppUziContext extends AbstractModule {
    [javac]            

BUILD FAILED
/<path-to-my-project>/MyProject/build.xml:51: Compile failed; see the compiler error output for details. 
```

...列表中有 100 多个看起来像这样的错误，但对于它找不到的每个依赖项都是不同的。

我相信问题出在我配置并在里面引用的路径的某个地方`javac/classpath`，但是在阅读了 Ant 文档之后，我无法弄清楚我要去哪里出错。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T14:54:57.083

在你的目标中试试这个：

```
<classpath>
    <path refid="src.main.java.path"/>
    <path refid="lib.main.path"/>
</classpath> 
```

我通常为目标制作完整的类路径，然后在目标中使用单线类路径：

```
<path id="target.class.path">
    <path refid="src.main.java.path"/>
    <path refid="lib.main.path"/>
</path> 
```

然后在目标中：

```
<classpath refid="target.class.path"/> 
```

`pathelement`没有很好的文档记录，[这](http://ant.apache.org/manual/using.html#path)是您从 ant 站点获得的最好的。请注意，在这些示例中，`<pathelement path=`始终与属性一起使用，否则它会`<pathelement location`采用实际的文件夹名称（也可能是属性）。

# sql - 计算列规范 - 工作查询的验证错误

> ID：12675573
> 
> 赞同：0
> 
> 时间：2012-10-01T14:47:14.113
> 
> 标签：sql, sql-server

我想使用SQL Server 中的*计算列规范*根据另一列的值设置列的值。

基本上，如果列有关联的结果（在另一列中），我想将列的值设置为链接。这是我尝试将该列的*公式*部分放入的内容，但我总是得到这个

> *验证公式时出错*

T-SQL 代码：

```
SELECT 
    CASE 
       WHEN D.TestResultId IS NOT NULL 
       THEN ('<a href="Analysis?Result=' + CONVERT(varchar(max), D.TestResultId) + '">Analysis</a>')
       ELSE 'Pending Analysis' 
    END
FROM DailyReport AS D 
```

查询本身工作正常，但是当将其放入*计算列规范*时，它总是返回该错误。我什至尝试创建一个存储过程并调用它，但仍然是同样的问题。我可以得到任何帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:04:42.020

您不需要`SELECT - FROM`计算列上的部分。它应该只是：

```
CASE WHEN TestResultId IS NOT NULL 
THEN ('<a href="Analysis?Result=' + CONVERT(varchar(max), TestResultId) +
'">Analysis</a>') ELSE 'Pending Analysis' END 
```

# javascript - jquery .each() .load() 等待完成

> ID：12675575
> 
> 赞同：1
> 
> 时间：2012-10-01T14:47:19.007
> 
> 标签：javascript, jquery

我正在使用 jquery 将行加载到表中，我想知道如何让它们一一加载；即第二个块应该只有在第一个块完成加载后才开始加载。

我的表看起来有点像这样：

```
<table id="dynamicTable">
  <thead>
    <tr>
      <th>Heading</th>
      ...
    </tr>
  </thead>
  <tbody id="1">
  </tbody>
  <tbody id="2">
  </tbody>
</table> 
```

我的 jquery 看起来有点像这样：

```
$("table#dynamicTable tbody").each(function() {
  $(this).load("filethatgeneratestablerows.php");
}); 
```

（它比这更复杂一点，因为它基于 tbody id 生成内容，并且还包括一个复选框系统来选择您想要影响的 tbody 元素，但是一切正常，所以我已经将它剥离以制作我的实际问题更明显！）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T14:57:40.483

```
var bodies = $("table#dynamicTable tbody"),
    i = 0;

(function loadBody() {
   bodies.eq(i++).load("filethatgeneratestablerows.php", loadBody);
})(); 
```

这一次调用集合的每个索引的加载。完成一次加载后，它会`loadBody`使用递增的索引再次调用。

当`i`大于最后一个时，`.eq()`将返回一个空的 jQuery 对象，因此序列将在那里结束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:51:45.370

您需要创建一个数组来存储各种 tbodies。从第一个开始并运行负载。完成后，将第一个取出的阵列通过。所以你像这样传递：

[1, 2, 3, 4] [2, 3, 4] [3, 4] [4] []

你继续调用一个加载函数，该函数接受一个数组，加载第一个元素，然后传递剩余的元素或不传递任何元素。

前任：

```
loadElement( $("table#dynamicTable tbody") );

function loadElement( $elements ) {
    $elements.load( "filethatgeneratestablerows.php",
            loadElement( $elements.filter(":gt(0)") ) );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:51:37.763

你可以做一个

```
$("table#dynamicTable #1").load("filethatgeneratestablerows.php", function(event) {
     $("table#dynamicTable #2").load("filethatgeneratestablerows.php", function(event) {
        ....
     });
  });
}); 
```

未经测试，但你应该明白这一点

# c# - Linq 按列表排序 给出的 ID

> ID：12675577
> 
> 赞同：8
> 
> 时间：2012-10-01T14:47:25.683
> 
> 标签：c#, sql, linq, entity-framework

我正在尝试对 linq 查询进行排序，以便按照在 List[int] 中找到的 ID 的顺序返回结果。这是我当前的代码，可以很好地返回它们，但没有排序。

```
IEnumerable<NPost> nposts;

List<int> npostIDs = (from tc in db.TopComs
                      where tc.Type == "Comments"
                      select tc.NPostID).ToList();

            nposts = from np in repository.NPosts
                     where npostIDs.Contains(np.NPostID)
                     select np; 
```

我怎样才能让 nposts 按照 npostIDs 在 List[int] 中存在的顺序返回结果？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-01T14:49:52.803

```
IEnumerable<NPost> nposts = from np in repository.NPosts
                            let index = npostIDs.IndexOf(np.NPostID) 
                            where index >= 0
                            orderby index ascending
                            select np; 
```

## 更新

根据你的错误，我有另一个建议。我不是 100% 确定它是否会在 EF 中工作，但试一试，让我知道。我还有另一个想法，我知道它会起作用，但它不会表现得那么好。

```
IEnumerable<NPost> nposts = from npostID in npostIDs.AsQueryable()
                            join np in repository.NPosts
                            on npostID equals np.NPostID
                            select np; 
```

这将保持`npostIDs`无`orderby`子句的顺序。如果`ObjectContext`是相同的（也许如果不是），您实际上应该能够在单个查询中完成。但是，不清楚您是否正在缓存`npostIDs`列表，因此这可能不是一个选项。无论如何，这里：

```
IEnumerable<NPost> nposts = from tc in db.TopComs
                            where tc.Type == "Comments"
                            join np in repository.NPosts
                            on tc.NPostID equals np.NPostID
                            select np; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-09T13:10:42.840

接受的答案是正确的，我只是想提供这个答案的方法版本：

```
IEnumerable<NPost> nposts = repository.NPosts
                            .Where(np => npostIDs.IndexOf(np.NPostID) >= 0)
                            .OrderBy(np => npostIDs.IndexOf(np.NPostID)); 
```

# c# - C# 中的多线程、多客户端 NamedPipeServer

> ID：12675579
> 
> 赞同：2
> 
> 时间：2012-10-01T14:47:33.770
> 
> 标签：c#, .net, multithreading, namedpipeserverstream

我试图构建一个多线程的命名管道服务器/客户端。代码库基于这个线程，[Multithreaded NamePipeServer in C#](https://stackoverflow.com/questions/4570653/multithreaded-namepipeserver-in-c-sharp?lq=1)

真正的问题是，我需要一个双向管道来向 cleint 写确认。为此，`ProcessClientThread`我尝试`StreamWriter`使用输入创建`pipeStream`并写入它，但我收到“Broken Pipe”异常。管子`PipeDirection.InOut`已经好了。

任何想法？

# c++ - std::map、std::equal_range 和比较函数

> ID：12675580
> 
> 赞同：2
> 
> 时间：2012-10-01T14:47:35.967
> 
> 标签：c++, maps

如果我有一个使用比较函数（函子）插入键的映射/多重映射，是否也可以将 map::equal_range 与比较函数一起使用？例如，如果我有一个 std::map m 和键：

```
sometype a.getVal == 101
sometype b.getVal == 112 <-first pair (using equal_range)
sometype c.getVal == 113
sometype d.getVal == 121 <-second pair (using equal_range) 
```

我想得到一个范围/一组键 11* 这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:12:07.587

不能使用`map::equal_range()`自定义比较器有一个很好的理由：它会破坏容器的关联性。可以这样做，但算法将是 O(n) 而不是 O(log(n))，因为它必须比较所有`map`元素，而不管它们的位置如何。

我认为解决您的问题的最佳解决方案是使用自定义函数 `map::lower_bound()`并`map::upper_bound()`找到您的间隔限制。就像是：

```
typedef std::map<int>::iterator Iter;
std::pair<Iter, Iter> CustomEqualRange (const std::map<int>& theMap, int lowerBound, int range)
{
  Iter lower = theMap.lower_bound(lowerBound);
  Iter upper = theMap.upper_bound(lowerBound + range);
  return std::make_pair(lower, upper);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:11:47.287

该`equal_range`函数不提供该功能，但您可以调用`lower_bound`使用 传递值`getVal == 110`和使用`upper_bound`传递值`getVal == 120`。这对迭代器应该代表半开范围 [110, 120) 中的所有值。

# asp.net - 使用 Windows 身份验证时，User.Identity.Name 有时为空

> ID：12675593
> 
> 赞同：1
> 
> 时间：2012-10-01T14:48:02.753
> 
> 标签：asp.net, iis-7.5, windows-authentication

我的 Web 应用程序使用 Windows 身份验证。所有其他身份验证方法均被禁用。

一开始就有效；User.Identity.Name 返回“MYDOMAIN\myuser”。但是，如果我等待 131 秒（是的，我计时了，尽管我不确定它总是需要那么长时间）并重新加载页面，User.Identity.IsAuthenticated = false 和 User.Identity.Name = ""。在这一点上，我可以重新加载页面，它再次工作，另外 131 秒不活动。

web.config 的相关部分：

```
<authentication mode="Windows" />
<authorization> 
  <deny users="?" /> 
</authorization>
<identity impersonate="false" />
...
<security>
  <authentication>
    <windowsAuthentication enabled="true" />
    <anonymousAuthentication enabled="false" />
  </authentication>
</security> 
```

更多信息，可能相关：

我的解决方案部署到两个不同的 IIS 应用程序。第一个是内部用户；它只是使用 Windows 身份验证。第二个是针对外部用户的；它使用匿名身份验证（仅在根文件夹中）和表单身份验证。我只是对内部站点有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T14:17:40.653

Account 文件夹下的 web.config 文件允许匿名身份验证（我发布的问题是主 web.config）。不知道这是怎么发生的，但删除它可以解决问题。

# uikit - 自定义 UIFont 渲染导致应用程序崩溃 iOS 6

> ID：12675594
> 
> 赞同：1
> 
> 时间：2012-10-01T14:48:05.013
> 
> 标签：uikit, ios6, uifont

我测试了一个使用自定义 UIFont 的应用程序。此字体用于可缩放的 UILabel - 它有一个 CATiledLayer 图层。

这是 UILabel 类的代码：

```
#import "ZoomableLabel.h"

@implementation ZoomableLabel

+ (Class)layerClass
{
    return [CATiledLayer class];
}

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        [self setupView];
    }
    return self;
}

//- (id)initWithCoder:(NSCoder *)aDecoder {
//    self = [super initWithCoder:aDecoder];
//    if (self) {
//        // Initialization code
//        [self setupView];
//    }
//    return self;
//}

-(void)awakeFromNib {
    [super awakeFromNib];
    [self setupView];
}

- (void)setupView {
    CATiledLayer *layerForView = (CATiledLayer *)self.layer;
    layerForView.levelsOfDetailBias = 3;
    layerForView.levelsOfDetail = 1;
}

-(void)setText:(NSString *)value {
    self.layer.contents = nil;
    [super setText:value];
    [self setNeedsDisplay];
}

-(void)setTextColor:(UIColor *)value {
    self.layer.contents = nil;
    [super setTextColor:value];
    [self setNeedsDisplay];
}

@end 
```

当我第一次在设备或模拟器上运行应用程序（即应用程序第一次安装在设备或模拟器上）时，我遇到了崩溃。然后这种崩溃再也不会发生了！更新：崩溃非常随机发生（尤其是在演示应用程序时......），但不仅仅是第一次。这是我设法从 XCode 获得的所有信息：

```
Thread 3 name:  Dispatch queue: com.apple.root.default-priority
Thread 3 Crashed: 0   WebCore                           0x333adbfa WTF::HashTable<WebCore::FontData const*, std::__1::pair<WebCore::FontData const*, WebCore::GlyphPageTreeNode*>, WTF::PairFirstExtractor<std::__1::pair<WebCore::FontData const*, WebCore::GlyphPageTreeNode*> >, WTF::PtrHash<WebCore::FontData const*>, WTF::HashMapValueTraits<WTF::HashTraits<WebCore::FontData const*>, WTF::HashTraits<WebCore::GlyphPageTreeNode*> >, WTF::HashTraits<WebCore::FontData const*> >::rehash(int) + 42
1   WebCore                         0x333adcd4 WTF::HashTableAddResult<WTF::HashTableIterator<WebCore::FontData const*, std::__1::pair<WebCore::FontData const*, WebCore::GlyphPageTreeNode*>, WTF::PairFirstExtractor<std::__1::pair<WebCore::FontData const*, WebCore::GlyphPageTreeNode*> >, WTF::PtrHash<WebCore::FontData const*>, WTF::HashMapValueTraits<WTF::HashTraits<WebCore::FontData const*>, WTF::HashTraits<WebCore::GlyphPageTreeNode*> >, WTF::HashTraits<WebCore::FontData const*> > > WTF::HashTable<WebCore::FontData const*, std::__1::pair<WebCore::FontData const*, WebCore::GlyphPageTreeNode*>, WTF::PairFirstExtractor<std::__1::pair<WebCore::FontData const*, WebCore::GlyphPageTreeNode*> >, WTF::PtrHash<WebCore::FontData const*>, WTF::HashMapValueTraits<WTF::HashTraits<WebCore::FontData const*>, WTF::HashTraits<WebCore::GlyphPageTreeNode*> >, WTF::HashTraits<WebCore::FontData const*> >::add<WTF::HashMapTranslator<WTF::HashMapValueTraits<WTF::HashTraits<WebCore::FontData const*>, WTF::HashTraits<WebCore::GlyphPageTreeNode*> >, WTF::PtrHash<WebCore::FontData const*> >, WebCore::FontData const*, WebCore::GlyphPageTreeNode*>(WebCore::FontData const* const&, WebCore::GlyphPageTreeNode* const&) + 56
2   WebCore                         0x333a5cac WebCore::GlyphPageTreeNode::getChild(WebCore::FontData const*, unsigned int) + 264
3   WebCore                         0x333a55d8 WebCore::Font::glyphDataAndPageForCharacter(int, bool, WebCore::FontDataVariant) const + 528
4   WebCore                         0x333a53b6 WebCore::Font::glyphDataForCharacter(int, bool, WebCore::FontDataVariant) const + 18
5   WebCore                         0x333a4b36 WebCore::WidthIterator::advance(int, WebCore::GlyphBuffer*) + 398
6   WebCore                         0x333a4794 WebCore::Font::floatWidthForSimpleText(WebCore::TextRun const&, WebCore::GlyphBuffer*, WTF::HashSet<WebCore::SimpleFontData const*, WTF::PtrHash<WebCore::SimpleFontData const*>, WTF::HashTraits<WebCore::SimpleFontData const*> >*, WebCore::GlyphOverflow*) const + 60
7   WebCore                         0x333a4546 WebCore::Font::width(WebCore::TextRun const&, WTF::HashSet<WebCore::SimpleFontData const*, WTF::PtrHash<WebCore::SimpleFontData const*>, WTF::HashTraits<WebCore::SimpleFontData const*> >*, WebCore::GlyphOverflow*) const + 250
8   WebCore                         0x333a60e0 WebCore::truncateString(WTF::String const&, float, WebCore::Font const&, unsigned int (*)(WTF::String const&, unsigned int, unsigned int, unsigned short*, bool), bool, float*, bool, float, bool) + 296
9   WebCore                         0x333a5fac WebCore::StringTruncator::rightTruncate(WTF::String const&, float, WebCore::Font const&, WebCore::StringTruncator::EnableRoundingHacksOrNot, float&, bool, float) + 60
10  WebKit                          0x375fc718 applyEllipsisStyle(WTF::String const&, WebEllipsisStyle, float, WebCore::Font const&, WebCore::StringTruncator::EnableRoundingHacksOrNot, float*, bool, float, bool) + 464
11  WebKit                          0x375ff3a8 -[NSString(WebStringDrawing) __web_drawInRect:withFont:ellipsis:alignment:letterSpacing:lineSpacing:includeEmoji:truncationRect:measureOnly:renderedStringOut:drawUnderline:] + 5036
12  WebKit                          0x375fdfe8 -[NSString(WebStringDrawing) __web_drawInRect:withFont:ellipsis:alignment:letterSpacing:lineSpacing:includeEmoji:truncationRect:measureOnly:renderedStringOut:] + 112
13  WebKit                          0x375fdf64 -[NSString(WebStringDrawing) __web_drawInRect:withFont:ellipsis:alignment:letterSpacing:lineSpacing:includeEmoji:truncationRect:measureOnly:] + 108
14  WebKit                          0x375fdee4 -[NSString(WebStringDrawing) _web_drawInRect:withFont:ellipsis:alignment:lineSpacing:includeEmoji:truncationRect:measureOnly:] + 108
15  WebKit                          0x375fde64 -[NSString(WebStringDrawing) _web_sizeInRect:withFont:ellipsis:lineSpacing:] + 80
16  UIKit                           0x353698c2 -[NSString(UIStringDrawing) sizeWithFont:constrainedToSize:lineBreakMode:lineSpacing:] + 122
17  UIKit                           0x3535daa6 -[UILabel _legacy_drawTextInRect:baselineCalculationOnly:] + 594
18  UIKit                           0x35321c5a -[UILabel _drawTextInRect:baselineCalculationOnly:] + 162
19  UIKit                           0x35320a26 -[UILabel drawTextInRect:] + 446
20  UIKit                           0x35320860 -[UILabel drawRect:] + 68
21  UIKit                           0x3531fd20 -[UIView(CALayerDelegate) drawLayer:inContext:] + 360
22  QuartzCore                      0x37b84bb8 -[CALayer drawInContext:] + 108
23  QuartzCore                      0x37c62624 tiled_layer_render(_CAImageProvider*, unsigned int, unsigned int, unsigned int, unsigned int, void*) + 1416
24  QuartzCore                      0x37bd755c CAImageProviderThread(unsigned int*, bool) + 508
25  libdispatch.dylib               0x37b5e95c _dispatch_root_queue_drain + 248
26  libdispatch.dylib               0x37b5eabc _dispatch_worker_thread2 + 80
27  libsystem_c.dylib               0x38862a0e _pthread_wqthread + 358
28  libsystem_c.dylib               0x388628a0 start_wqthread + 4 
```

有人对此有任何想法吗？我认为这种崩溃不会发生在 iOS 5 设备上......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:30:13.997

这是我对 Summon 的回答的看法，它使用核心文本来解决英语以外的语言（尽管我只测试过瑞典语）和奇怪的字体符号的问题。请注意，它使用 initWithCoder，就像我使用 StoryBoard 一样。它还显示了如何将标签中的文本水平居中（垂直方向的运气不太好，我只需要测试我的方式到正确的位置）。

标题：

```
#import <UIKit/UIKit.h>
#import <QuartzCore/QuartzCore.h>

@interface DNLabel : UILabel 

@end 
```

执行：

```
#import "DNLabel.h"
#import <CoreText/CoreText.h>

@implementation DNLabel

+ (Class)layerClass
{
    return [CATiledLayer class];
}

- (id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];
    if (self)
    {
        [self setupView];
    }
return self;
}

-(void)awakeFromNib 
{
    [super awakeFromNib];
    [self setupView];
}

- (void)setupView {
CATiledLayer *layerForView = (CATiledLayer *)self.layer;
layerForView.levelsOfDetailBias = 10;
layerForView.levelsOfDetail = 10;
}

// LEAVE IT EMPTY
-(void)drawRect:(CGRect)r
{
// UIView uses the existence of -drawRect: to determine if should allow its CALayer
// to be invalidated, which would then lead to the layer creating a backing store and
// -drawLayer:inContext: being called.
// By implementing an empty -drawRect: method, we allow UIKit to continue to implement
// this logic, while doing our real drawing work inside of -drawLayer:inContext:
}

// These calls inside this method are thread SAFE
-(void)drawLayer:(CALayer*)layer inContext:(CGContextRef)context
{
    // Core Text version
    CTFontRef ctFont = CTFontCreateWithName((__bridge CFStringRef)self.font.fontName,
                                            self.font.pointSize,
                                            NULL);
    // set color
    CGColorRef color = [[[UIColor blackColor] colorWithAlphaComponent:0.75f] CGColor];

    // pack it into attributes dictionary
    NSDictionary *attributesDict = [NSDictionary dictionaryWithObjectsAndKeys:
                                    (id)CFBridgingRelease(ctFont), (id)kCTFontAttributeName,
                                    color, (id)kCTForegroundColorAttributeName,
                                    nil, (id)kCTUnderlineStyleAttributeName, nil];

    // make the attributed string
    NSAttributedString *stringToDraw = [[NSAttributedString alloc] initWithString:self.text
                                                                   attributes:attributesDict];
    // flip the coordinate system
    CGContextSetTextMatrix(context, CGAffineTransformIdentity);
    CGContextTranslateCTM(context, 0, self.bounds.size.height);
    CGContextScaleCTM(context, 1.0, -1.0);

    // check size of text and set position centered horizontally
    CGSize size = [self.text sizeWithFont:self.font];
    CGContextSetTextPosition(context, self.bounds.size.width/2 - size.width/2, 1);

    // draw
    CTLineRef line = CTLineCreateWithAttributedString(
                                                    (CFAttributedStringRef)CFBridgingRetain(stringToDraw));
    CTLineDraw(line, context);
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T12:19:06.047

这些是基于 CATiledLayer 且永不崩溃的可缩放标签的 .h 和 .m 类：

标题：

```
#import <QuartzCore/QuartzCore.h>

@interface ZoomableLabel : UILabel {
    CGPoint textDrawPoint;
    CGPoint shadowDrawPoint;
}

@end 
```

执行：

```
#import "ZoomableLabel.h"

@implementation ZoomableLabel

+ (Class)layerClass
{
    return [CATiledLayer class];
}

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        [self setupView];
    }
    return self;
}

-(void)awakeFromNib {
    [super awakeFromNib];
    [self setupView];
}

- (void)setupView {
    CATiledLayer *layerForView = (CATiledLayer *)self.layer;
    layerForView.levelsOfDetailBias = 3;
    layerForView.levelsOfDetail = 1;
    textDrawPoint = CGPointMake(11, -22);
    shadowDrawPoint = CGPointMake(10, -23);
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
        textDrawPoint = CGPointMake(11, -42);
        shadowDrawPoint = CGPointMake(8, -46);
    }
}

// DO NOT USER THESE METHODS ANYMORE
//-(void)setText:(NSString *)value {
////    self.layer.contents = nil;
//    [super setText:value];
//    [self setNeedsDisplayInRect:self.bounds];
//}
//
//-(void)setTextColor:(UIColor *)value {
////    self.layer.contents = nil;
//    [super setTextColor:value];
//    [self setNeedsDisplayInRect:self.bounds];
//}

// LEAVE IT EMPTY
-(void)drawRect:(CGRect)r
{
    // UIView uses the existence of -drawRect: to determine if should allow its CALayer
    // to be invalidated, which would then lead to the layer creating a backing store and
    // -drawLayer:inContext: being called.
    // By implementing an empty -drawRect: method, we allow UIKit to continue to implement
    // this logic, while doing our real drawing work inside of -drawLayer:inContext:
}

// These calls inside this method are thread SAFE
-(void)drawLayer:(CALayer*)layer inContext:(CGContextRef)context
{
    // Do all your drawing here. Do not use UIGraphics to do any drawing, use Core Graphics instead.
    CGContextScaleCTM(context, 1.0f, -1.0f);
    CGContextSelectFont(context, [self.font.fontName UTF8String], self.font.pointSize, kCGEncodingMacRoman);
    CGContextSetTextDrawingMode(context, kCGTextFill);
//    CGContextSetShouldAntialias(context, true);
    CGContextSetFillColorWithColor(context, [[[UIColor blackColor] colorWithAlphaComponent:0.75f] CGColor]);
    CGContextShowTextAtPoint(context, shadowDrawPoint.x, shadowDrawPoint.y, [self.text UTF8String], self.text.length);
    CGContextSetFillColorWithColor(context, [self.textColor CGColor]);
    CGContextShowTextAtPoint(context, textDrawPoint.x, textDrawPoint.y, [self.text UTF8String], self.text.length);
}

@end 
```

# php - oci_connect 从命令行失败，但在浏览器中工作

> ID：12675598
> 
> 赞同：2
> 
> 时间：2012-10-01T14:48:09.123
> 
> 标签：php, oracle, command-line

我编写了一个 PHP 脚本作为 cron 作业运行，但它没有运行。该脚本在浏览器中运行良好，但是当我从命令行运行它时发现出现此错误：

```
Warning: oci_connect(): ORA-12154: TNS:could not resolve the connect identifier specified in /usr/apps/webdata/cron/PropogateDB.php on line 190 
```

有问题的行是：

```
$conn_NRB = oci_connect($user, $pass, "nrb.njbbnrbpd1"); 
```

正如我所说，这个脚本在浏览器中运行良好。

我做了一些挖掘，找到了数据库的配置设置。然后我尝试了这个：

```
$conn_NRB = oci_connect($user, $pass, "(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=localhost)(PORT=1521))(CONNECT_DATA=(SID=nrb)))"); 
```

使用此代码，命令行和浏览器都会给我这个错误：

```
Warning: oci_connect() [function.oci-connect]: ORA-01017: invalid username/password; logon denied in /usr/apps/webdata/cron/PropogateDB.php on line 191 
```

据我所知，没有其他用户名和密码可以使用。（我现在正在尝试验证。）

我在这个网站上四处搜索，发现其他人也有类似的问题，虽然他的问题被颠倒了，他的原因是命令行和浏览器指向了两个不同的 php.ini 文件。我刚刚确认浏览器和命令行都调用了同一个 php.ini 文件。他们都指出：

```
Configuration File (php.ini) Path => /usr/local/php/lib 
```

脚本可以在浏览器中运行但在命令行中失败还有其他原因吗？我对 Oracle SQL 比较陌生，我没有直接访问数据库的权限，所以我不确定从这里去哪里。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:52:28.137

“EasyConnect”字符串

```
(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=localhost)(PORT=1521))(CONNECT_DATA=(SID=nrb))) 
```

指本地主机。“在浏览器中”可能意味着：*在服务器上*（PHP 脚本执行的地方）。

除非您*在同一服务器*的命令行上运行测试，否则您应该更改连接字符串以引用数据库服务器（可能只是您的 Web 服务器的主机名）。

当心可能会阻碍的防火墙限制。如果可能，最好使用贵公司的`tnsnames.ora`将数据库实例标识符解析为其连接字符串。

# excel - 从一张表引用到另一张表时，单元格中的文本会丢失其格式

> ID：12675603
> 
> 赞同：0
> 
> 时间：2012-10-01T14:48:17.340
> 
> 标签：excel

我在 Excel 工作表 A 的单元格列表中有一些文本，它们是工作表 B 中下拉列表的值。单元格中的部分文本带有下划线。

但是，在下拉列表中的工作表 B 中，当我选择具有部分文本下划线的单元格时，带下划线的格式不会显示在工作表 B 上。

任何想法为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-01T20:23:26.100

为了回答（由@Tim Williams 提供）：

> 验证列表不从源单元格复制格式，只复制它们的值。

# grails - Grails 中的唯一约束

> ID：12675604
> 
> 赞同：0
> 
> 时间：2012-10-01T14:48:21.230
> 
> 标签：grails, orm, grails-orm

假设我有以下圣杯域实体：

```
class A { ... }

class B { ... } 
```

在第三个实体中，我有一个一对多的关系，如下所示：

```
class C {
    static belongsTo = [a: A, b: B]

    static constraints {
        a unique: 'b'
    }
} 
```

是否可以在 grails 中基于类中的两个属性 ( `a`and `b`)定义唯一关系，因此不能创建具有相同组合的`C`两个实例and ？`C``a``b`

编辑：我的测试用例如下：

```
void testCompositeUniqueConstraint() {
    A a = // ...
    B b = // ...
    C existing = // ...
    existing.a = a
    existing.b = b
    mockForConstraintsTests(C, [existing])

    C c = // ...
    c.a = a
    c.b = b

    assertFalse c.validate()
} 
```

在我的测试课上，我已经包含了`@Mock([A, B])`注释。我希望这个测试会失败，但它会通过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:13:29.967

那将是

```
static constraints = {
   a unique: 'b'
} 
```

见[http://grails.org/doc/latest/ref/Constraints/unique.html](http://grails.org/doc/latest/ref/Constraints/unique.html)

# c# - 重载的方法匹配（无法将字符串转换为 int）

> ID：12675606
> 
> 赞同：2
> 
> 时间：2012-10-01T14:48:23.477
> 
> 标签：c#

我正在尝试从标签和 4 个 tekstboxes 中将 2 个 int 和 3 个字符串插入数据库。

我得到的错误：

> 方法 Insert 有一些无效的参数，参数不能从字符串转换为 int。

`lblHidden.Text`并`TextBoxDagnummer.Text`在其中包含字符串，但我需要将它们转换为整数。我是在插入之前还是在插入中转换它们，语法是什么？

**背后的代码**

```
protected void Button2_Click(object sender, EventArgs e)  
{
   Vakinhoudclass.Insert(lblHidden.Text, TextBoxDagnummer.Text, TextBoxHoofdstuk.Text, TextBoxOnderwerp.Text, TextBoxLes.Text);

   GridView1.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:50:25.543

尝试使用`int.Parse`or`int.TryParse`方法。例如：

```
int number = int.Parse(TextBoxDagnummer.Text)
Vakinhoudclass.Insert(lblHidden.Text, number, TextBoxHoofdstuk.Text, TextBoxOnderwerp.Text, TextBoxLes.Text); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:50:35.430

您需要从字符串中解析出整数。

使用[`int.Parse`](http://msdn.microsoft.com/en-us/library/system.int32.parse.aspx)or[`int.TryParse`](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx)从输入中获取整数。

如果输入*不能*被解析，`int.Parse`会抛出异常，同时`TryParse`会返回一个`bool`指示它是否能够解析。

```
int val;

if(int.TryParse(TextBoxDagnummer.Text, out val))
{
  // Parsed OK
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:52:50.383

我觉得最好在插入数据库之前转换为整数。这样，您就可以在与数据库交谈之前捕获任何可能发生的错误。

这是将字符串转换为整数的简单方法：

```
Convert.ToInt32(lblHidden.text) 
```

我还建议用 try-catch 块围绕它

```
 try
            {
                Convert.ToInt32(lblHidden.Text);
            }
            catch(Exception ex)
            {
                //an error occured
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-02T09:39:04.690

感谢您迄今为止对我的问题的反馈，但我遇到了同样的错误：-“Vakinhoudclass.Insert(int,int,string,string,string)”的最佳重载方法匹配有一些无效参数。- 参数 1 和 2 不能从 "string" 转换为 "int"

现在使用此代码：

int number = int.Parse(TextBoxDagnummer.Text); int number2 = int.Parse(lblHidden.Text); Vakinhoudclass.InsertVakInhoud(lblHidden.Text, TextBoxDagnummer.Text, TextBoxHoofdstuk.Text, TextBoxOnderwerp.Text, TextBoxLes.Text); GridView1.DataBind();

（也尝试过使用隐蔽方法）

**编辑**

哎呀，我看到我做错了什么，需要像这样将它们粘贴到插入函数中： int number = int.Parse(lblHidden.Text); int number2 = int.Parse(TextBoxDagnummer.Text); Vakinhoudclass.InsertVakInhoud(number, number2, TextBoxHoofdstuk.Text, TextBoxOnderwerp.Text, TextBoxLes.Text); GridView1.DataBind();

# php - 检测是否在 codeigniter 中启用了 JS

> ID：12675608
> 
> 赞同：0
> 
> 时间：2012-10-01T14:48:28.173
> 
> 标签：php, codeigniter, user-agent

> **可能重复：**
> [检查是否使用 PHP 启用了 JavaScript](https://stackoverflow.com/questions/4454551/check-if-javascript-is-enabled-with-php)

我需要一种方法来检测是否在 codeigniter 框架的用户代理中启用或禁用了 javascript

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:52:27.660

您无法直接在服务器端检测到这一点。请查看本文以获取替代解决方案：[http ://www.untwistedvortex.com/detect-javascript-enabled-php/](http://www.untwistedvortex.com/detect-javascript-enabled-php/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:27:42.690

您不会通过 HTTP 标头获得此信息。但我有一些解决方法：

您可以将此信息存储在用户会话中。默认情况下，您建议禁用 JS。第一个交付的页面应该对脚本执行 Ajax-Call，该脚本告诉 USER-Session，Javascript 已启用。

当然，这有一些缺点：

*   第一次 Page-Call 始终是无脚本的
*   如果用户突然禁用 Javascript，您不会得到信息
*   如果您在脚本版本和 noscript 版本之间存在很大差异，搜索引擎可能会对您的页面进行评分

有时，如果 JS 启用与否，在 CSS 中拥有信息就足够了。你可以这样做：

```
<head>
    <script type="text/javascript">
        // Jquery version
        $(function() {
            $('body').removeClass('noJs');
        });
    </script>
    <style type="text/css">
        .noJs #hello {
             display: none;
        }
    </style>
</head>
<body class="noJs">
    <div id="hello">Hello</div>
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:53:00.693

在 CodeIgniter 或其他框架/普通 PHP 中无法进行可靠的检测。

此外，该信息不是标准浏览器标头/用户代理的一部分。

# android - 是否可以检测到 Android 设备上的 USB 调试？

> ID：12675609
> 
> 赞同：13
> 
> 时间：2012-10-01T14:48:32.317
> 
> 标签：android, debugging, usb

在我的应用程序中，我需要一种方法来检测 android 设备是否在 USB 调试模式下运行。

是否可以？如果是，如何？

提前谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-01T15:24:37.170

您可以使用以下内容来获取是否启用了 ADB。

```
int adb = Settings.Secure.getInt(context.getContentResolver(), Settings.Secure.ADB_ENABLED, 0); 
```

如果启用，`adb == 1`，否则`adb == 0`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:32:01.797

在我的 Android 2.3 设备上，可以通过扫描进程的完整进程列表 ( `ps -s`)来检测 USB 调试模式`/sbin/adbd`。

如果存在此过程，则启用 USB 调试。

# scala - 将 ANORM SELECT 参数设置为 null

> ID：12675614
> 
> 赞同：1
> 
> 时间：2012-10-01T14:48:51.437
> 
> 标签：scala, select, parameters, null, anorm

我正在尝试执行 SELECT 语句，其中参数可能具有空值：

```
SQL(
      """
      SELECT id FROM devices WHERE
        name = {name}
      """)
  .on("name" -> device.name)()
  .collectFirst {
     ...
  }.getOrElse {
     ...
  } 
```

`device.name`可以返回null。我`db.default.logStatements=true`看到生成的 SQL 看起来像这样：`SELECT id FROM devices WHERE name = NULL`.

`name = NULL`对 Postgre SQL 不太有效，但我已经使用`transform_null_equals`. 现在，当我使用 pgAdmin 从日志中执行 SQL 时，它工作得非常好。但是，ANORM 没有找到任何东西。

以下代码确实返回结果：

```
SQL(
      """
      SELECT id FROM devices WHERE
        name = NULL
      """)
  .on("name" -> device.name)()
  .collectFirst {
      ...
  }.getOrElse {
     ...
  } 
```

它出什么问题了？！

# javascript - 使用javascript将日期转换为ccyymmdd

> ID：12675617
> 
> 赞同：0
> 
> 时间：2012-10-01T14:49:04.123
> 
> 标签：javascript, .net, xslt

我需要使用 JavaScript 将日期转换为`'2012-09-15T00:00:00'`CCYYMMDD 格式吗？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:57:54.720

我看不出 .NET 和 XSLT 与您的问题有什么关系。

您可以使用构造函数将[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)编码字符串`Date`解析为 javascript [Date](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)对象：

```
var dateStr = '2012-09-15T00:00:00';
var date = new Date(dateStr); 
```

然后构建所需的格式：

```
var year = '' + date.getFullYear();
var month = date.getMonth() + 1;
month = month < 10 ? '0' + month : month;
var day = '' + date.getDate();
day = day < 10 ? '0' + day : day;
var formattedDate = year + month + day; 
```

这是一个[现场演示](http://jsfiddle.net/Chsnt/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:02:47.370

使用`replace`和`split`。

```
var date = '2012-09-15T00:00:00';
date = date.replace(/-/,"").split("T")[0];// date will be 20120915 
```

# c++ - Boost dijkstra shortest_path - 如何获得最短路径而不仅仅是距离？

> ID：12675619
> 
> 赞同：11
> 
> 时间：2012-10-01T14:49:06.633
> 
> 标签：c++, boost, graph, boost-graph

我需要使用 Boost 库来获得从一个点到另一个点的最短路径。我查看了示例代码，它很容易理解。但是，该示例仅显示了如何获取总距离。我试图弄清楚如何迭代前任地图以实际*获得*最短路径，但我似乎无法弄清楚。我已经阅读了有关该主题的这两个问题：

[Dijkstra Shortest Path with VertexList = ListS in boost graph](https://stackoverflow.com/questions/7156880/dijkstra-shortest-path-with-vertexlist-lists-in-boost-graph)

[Boost:: Dijkstra Shortest Path，如何从路径迭代器中获取顶点索引？](https://stackoverflow.com/questions/10109862/boost-dijkstra-shortest-path-how-to-get-vertice-index-from-path-iterator)

但是在提供的两个示例中，IndexMap typedef 似乎不适用于 Visual Studio 编译器，坦率地说，Boost typedef 让我有点困惑，我在弄清楚所有这些方面遇到了一些麻烦。根据此处的 Boost 示例代码，谁能告诉我如何才能摆脱它？我将非常感谢。

[http://www.boost.org/doc/libs/1_46_1/libs/graph/example/dijkstra-example.cpp](http://www.boost.org/doc/libs/1_46_1/libs/graph/example/dijkstra-example.cpp)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-01T15:36:59.957

如果您只想从前任地图中获取路径，您可以这样做。

```
//p[] is the predecessor map obtained through dijkstra
//name[] is a vector with the names of the vertices
//start and goal are vertex descriptors
std::vector< graph_traits< graph_t >::vertex_descriptor > path;
graph_traits< graph_t >::vertex_descriptor current=goal;

while(current!=start) {
    path.push_back(current);
    current=p[current];
}
path.push_back(start);

//This prints the path reversed use reverse_iterator and rbegin/rend
std::vector< graph_traits< graph_t >::vertex_descriptor >::iterator it;
for (it=path.begin(); it != path.end(); ++it) {

    std::cout << name[*it] << " ";
}
std::cout << std::endl; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T12:31:04.970

这是[llonesmiz 的代码](https://stackoverflow.com/a/12676435/975129)稍作修改以显示从 A 到其他节点的中间段以及段距离：

**输出**

```
A[0] C[1] D[3] E[1] B[1] 
A[0] C[1] 
A[0] C[1] D[3] 
A[0] C[1] D[3] E[1] 
```

**代码**

```
// DISPLAY THE PATH TAKEN FROM A TO THE OTHER NODES

nodes  start = A;
for ( int goal=B; goal<=E; ++goal )
{
  std::vector< graph_traits< graph_t >::vertex_descriptor >  path;
  graph_traits< graph_t >::vertex_descriptor                 current=goal;

  while( current!=start )
  {
    path.push_back( current );
    current = p[current];
  }
  path.push_back( start );

  // rbegin/rend will display from A to the other nodes
  std::vector< graph_traits< graph_t >::vertex_descriptor >::reverse_iterator rit;
  int cum=0;
  for ( rit=path.rbegin(); rit!=path.rend(); ++rit) 
  {
    std::cout << name[*rit] << "[" << d[*rit]-cum << "] ";
    cum = d[*rit];
  }
  std::cout << std::endl;
} 
```

# ruby-on-rails-3 - 为什么当我在同一个类中实例化的对象上调用 save 时，它 不返回 true？

> ID：12675621
> 
> 赞同：0
> 
> 时间：2012-10-01T14:49:13.790
> 
> 标签：ruby-on-rails-3, rspec-rails

我创建了一个类方法，并在该类方法中实例化了同一类的另一个对象。根据我的测试，在尝试保存这个对象时，我得到了错误，但我不知道为什么。

至于落实押金。我已经单独测试了 transaction.credit 并且它按预期工作。问题是 transaction.save 没有返回 TRUE。只有当这两个方法的计算结果都为 TRUE 时，Anding (&&) 这两个方法才应该一起返回 true。

```
class Transaction
  .
  .
  .
  def self.deposit(account, amount, description, task_description_id)
    # create credit transaction
    transaction = Transaction.new
    transaction.description = description
    transaction.task_description_id = task_description_id

    transaction.credit(account, amount) && transaction.save
  end
  .
  .
  .
end 
```

我的测试

```
describe "when performing account deposit" do
  before { @flag = Transaction.deposit(@discrete_task.commitment_account, 10000, "transfer", 4) }
  it { @discrete_task.commitment_account.balance.to_f.should == 10000 }
  it { @flag.should be_true }
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:23:24.160

由于不满足验证要求，我的测试失败了，因此我的对象不会保存...感谢@23tux 帮助我获取我需要的错误消息来解决这个问题。

# javascript - SCRIPT1028：预期的标识符、字符串或数字

> ID：12675622
> 
> 赞同：26
> 
> 时间：2012-10-01T14:49:14.290
> 
> 标签：javascript, internet-explorer

我正在运行一个显示事件日历的插件。除了 IE 兼容模式外，它适用于所有浏览器。选中该选项后，日历就会消失。我相信这是一个 JS 错误。

IE 调试器错误：

```
element.qtip({
    content: {
    text: event.description,
    title: {
    text: 'Description',
    }
  },
position: {
    at: 'top right',
    adjust: {
    x: 0, y: 30
   },
}, 
```

在我的插件编辑器中，这是代码：

```
element.qtip({
  content: {
  text: event.description,
  title: {
  text: '<?php _e('Description', 'event_espresso'); ?>',
  }
},
position: {
   at: 'top right',
   adjust: {
   x: 0, y: 30
  },
}, 
```

我不擅长调试，所以任何帮助将不胜感激。

如果它有帮助，这里是页面：[http ://www.mbausa.org/calendar/](http://www.mbausa.org/calendar/)

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-01T14:51:23.013

Internet Explorer 在对象和数组中的尾随逗号有问题；

```
title: {
    text: 'Description', //<--
} 
```

你可能想要：

```
title: {
    text: 'Description'
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-23T05:35:42.667

此错误有 2 个常见原因。不恰当时使用尾随逗号，或使用 JavaScript 保留字。在您的情况下，您有 2 个不必要的逗号。下面是正确的代码片段，其中包含我删除逗号的注释。

```
element.qtip({
  content: {
  text: event.description,
  title: {
    text: '<?php _e('Description', 'event_espresso'); ?>' // Removed Comma
  }
},
position: {
  at: 'top right',
  adjust: {
    x: 0, y: 30
  } // Removed Comma
}, 
```

我实际上做了一篇博文（和视频），解释了错误并展示了示例和修复。可以在这里找到：http: [//mikemclin.net/fixing-error-script1028-expected-identifier-string-or-number/](http://mikemclin.net/fixing-error-script1028-expected-identifier-string-or-number/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-01T14:52:54.143

旧版 IE 不支持格式错误的 JSON 字符串。

如果后面没有大括号 '['、荣誉 '{' 或新的对象属性，则永远不要使用逗号 ',' 分隔符。

尝试 ：

```
position: {
at: 'top right',
adjust: {
   x: 0, y: 30
  } // <-- no comma here
}, 
```

代替 ：

```
position: {
at: 'top right',
adjust: {
   x: 0, y: 30
  }, // <-- comma here
}, 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-01-23T09:29:17.680

如果您使用的是 Vuex 并且问题在`computed`钩子调用中表现出来`mapState`，那么问题出在扩展运算符上。

```
},
computed: {
  ...mapState({ 
```

使用 babel 修复它： [https ://babeljs.io/docs/en/babel-plugin-proposal-object-rest-spread](https://babeljs.io/docs/en/babel-plugin-proposal-object-rest-spread)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-01T14:51:37.450

您可以强制使用非兼容模式，而不是使用兼容模式...

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" /> 
```

在你的`<head>`标签中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-05T07:31:39.343

另一个可能的错误是由于保留关键字被用作哈希键。

[定义 Javascript 对象时出现 IE8 错误？](https://stackoverflow.com/questions/14323586/ie8-errors-when-defining-a-javascript-object)

当我使用时，`{class:'icon'}`我也会收到此错误。其他 IE8 关键字也可能会这样做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-12T08:10:54.850

尝试导入 ES6 模块而不通过 Babel 或类似工具进行编译时出现此错误。

该行产生了错误：

从 'my-npm-ES6-module' 导入 myES6module

解决方案是确保您的工作流程实际上将其转换为与浏览器兼容的 JavaScript。

# eclipse-gef - ScrollingGraphicalViewer 选择和取消选择监听器

> ID：12675623
> 
> 赞同：1
> 
> 时间：2012-10-01T14:49:17.137
> 
> 标签：eclipse-gef

在 GEF 图中选择一个图形时，我需要触发一个方法。当我选择一个图形时，addSelectionChangedListener 效果很好，但是如果我再次单击同一个图形（“取消选择”），侦听器不会触发。

我该如何解决？

```
final GraphicalViewer viewer = new ScrollingGraphicalViewer();
viewer.addSelectionChangedListener(new ISelectionChangedListener() {
     public void selectionChanged(SelectionChangedEvent event) {
    //Fired when figure is selected, but not when same figure is selected again

     }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T18:54:43.433

我不认为您可以通过选择机制为 GEF 图实现切换行为。**选择更改**`selectionChanged`时会触发该事件，因此在同一个图形上单击两次不会成功。

 **考虑到选择另一个数字并可以从`SelectionChangedEvent`传递的对象中检索该元素时，也许需要采取不同的方法。

此外，您应该只关心用户在图表中选择一个图形，而不是与任何其他工作台部件不同的元素。**

# mysql - 使用 MySQL 记录传感器数据的最佳方法

> ID：12675624
> 
> 赞同：0
> 
> 时间：2012-10-01T14:49:22.177
> 
> 标签：mysql, triggers, average

我是SQL新手，请指教。

我希望每 5 秒记录一次来自传感器的传入数据以供将来绘制图表 在 MySQL 中设计数据库的最佳方法是什么？

*   当我喜欢按小时、天、周、月显示图表时，我可以使用时间戳记录并使用 AVG 函数吗？

或者我可以记录并平均每分钟，每小时，每天以减少数据库大小

收集数据超过 1 分钟时是否可以使用触发功能进行平均？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:01:57.110

答案是，这取决于您实际要记录的数据量、查询的频率以及需要多快的响应时间。如果它只是一个传感器，每 5 秒一次，您可能会一直持续下去，而不会遇到太多常规 sql 查询问题，无法在合理的时间内提取平均值、总和等。

我会说，根据经验，您可以使用 SQL 和时间序列数据做很多事情，但是您必须非常小心如何设计查询。我使用过具有数十亿行和这些行中的数万个单独传感器的时间序列表；在这么多时间序列行上实现非常快速的执行是可能的，但是您可能会花费一周的时间来尝试微调数据库。这绝对是灵活性和速度之间的权衡。

同样，出于您的目的，如果您只是在谈论一个传感器，它可能不会有太大的不同。只需编写一个常规 SQL 查询。但是，如果您预计增加数百个传感器或增加采样率，您可能需要考虑按照您的建议执行定期“汇总”功能。在这种情况下，我会更倾向于使用 NoSQL 数据库（例如 Cassandra、Couchbase 等）编写自定义解决方案，并使用定期运行的程序进行汇总。如果您有兴趣，我可以提供详细信息，但我真的认为您不需要走那么远。

这篇文章对在 SQL 与 NOSQL 中存储时间序列数据进行了很好的讨论： [https ://dba.stackexchange.com/questions/7634/timeseries-sql-or-nosql](https://dba.stackexchange.com/questions/7634/timeseries-sql-or-nosql)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T16:32:27.310

您应该阅读有关 RRDtool 的信息。

从 RRDtool 网站：

> RRDtool 是用于时间序列数据的开源行业标准、高性能数据记录和图形系统。

[http://oss.oetiker.ch/rrdtool/](http://oss.oetiker.ch/rrdtool/)

如果您不想使用它（它可能太复杂，对您的应用程序来说太大等） - 看看它是如何制作的，信息是如何存储的等等。

# php - PHP：访问多维会话数组

> ID：12675626
> 
> 赞同：0
> 
> 时间：2012-10-01T14:49:23.637
> 
> 标签：php

我想通过使用多维会话数组来实现购物车，但不知道如何访问它们。例如，

*   案例1：用户将一件商品添加到购物车，名称为“x”，尺寸为“m”。然后再次添加名称“x”和大小“m”

第1行：pname“x”大小“m”数量“2”

*   案例2：当用户将一件商品添加到购物车时，名称为“x”，尺寸为“m”。然后用户将另一个项目添加到购物车，名称为“x”但尺寸为“s”。

我怎样才能将它作为 2 行来操作？

第1行：pname“x”大小“m”数量“1”
第2行：pname“x”大小“s”数量“1”

```
 if (!isset($_SESSION['order'])) {
         $_SESSION['order'] = array();  
     }
     $_SESSION['order'][] = array('id'=>$pID, 'size'=>$size, 'quantity'=>0);

   switch ($action) {
    case "add":
        $_SESSION['order'][]['quantity']++;
    break;

    case "remove":
        unset($_SESSION['order'][][$pID]);
    break;

    case "empty":
        unset($_SESSSION['order']);
    break;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:52:32.817

每次调用时，您的会话都会获得一个元素`[]`。添加`$pID`为变量 id：

改成：

```
if (!isset($_SESSION['order'])) {
    $_SESSION['order'] = array();  
}
$_SESSION['order'][$pID.'-'.$size] = array('quantity'=>0);

switch ($action) {
    case "add":
        $_SESSION['order'][$pID.'-'.$size]['quantity']++;
        break;

    case "remove":
        unset($_SESSION['order'][$pID.'-'.$size]);
        break;

    case "empty":
        // unset($_SESSION['cart']);
        unset($_SESSSION['order']);
        break;
} 
```

您可以稍后访问该产品`$_SESSION['order'][$pID.'-'.$size]`

要访问它们：

```
foreach($_SESSION['order'] as $key => $one){
    list($pid, $size) = explode('-', $key);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:59:02.647

我建议您为此使用对象而不是数组。使用数组会产生一种复杂性，让你的代码更难读，更复杂；我建议您使用面向对象的方法。

只需创建两个类：

```
 class ShoppingCart {

    private $items;

    public function getItems(){

     return $this->items;
    }

    public function addItem($item){

       $this->items[] = $item;
}

class Item {

private $name;
private $size;

public function getName() { return $this->name;}
public function getSize() { return $this->siez; }
public function setName($name) { $this->name = $name; }
public function setSize($size) { $this->size = $size; }

Now you can add items to the cart like this:

$cart = new ShoppingCart();

$item1 = new Item();
$item1->setName('x');
$item1->setSize('m');

$item2 = new Item();
$item2->setName('x');
$item2->setSize('s');

$cart->addItem($item1);
$cart->addItem($item2); 
```

你看到了吗，这段代码是可读的，很容易理解。

# php - DoReferenceTransaction - 重新计费失败，15005

> ID：12675630
> 
> 赞同：3
> 
> 时间：2012-10-01T14:49:45.630
> 
> 标签：php, paypal

我正在使用 DoReferenceTransaction 并且即使在使用最新的计费交易 ID 后它也会随机失败。每天的故障率约为 30% 至 50%。每次我们得到 15005 错误。

我们提供的在线产品最初是 15 天试用期，然后根据使用情况我们通过 DoReferenceTransaction 向用户收费。付款和频率因使用情况而异。

为了授权信用卡 15 天的试用期，我们通过 DoDirectPayment API 进行 0.01 美元的授权、捕获和退款。15 天后，将使用来自 PayPal 的最新交易 ID 自动执行 cron 向用户收费。在这一点上，我们看到每天有 30% 到 50% 的失败率低于错误。产品价格高达 350 美元，因此我们不进行全额授权，而是 1 美分授权、捕获和退款，并根据使用情况由 DoReferenceTransaction 进一步交易。

错误/贝宝响应

```
TIMESTAMP=2012-09-27T12:38:36Z 
CORRELATIONID=e25f624542dc 
ACK=Failure 
VERSION=64 
BUILD=3719653 
L_ERRORCODE0=15005 
L_SHORTMESSAGE0=ProcessorDecline 
L_LONGMESSAGE0=Thistransactioncannotbeprocessed. 
L_SEVERITYCODE0=Error 
L_ERRORPARAMID0=ProcessorResponse 
L_ERRORPARAMVALUE0=0051 
AMT=44.95 
CURRENCYCODE=USD 
AVSCODE=S 
CVV2MATCH=P 
```

请帮助我理解和纠正这个问题。如果您需要更多信息，请告诉我。

# cocoaasyncsocket - AsyncSocket如何构造带有N字节指示数据包长度的前缀？

> ID：12675638
> 
> 赞同：0
> 
> 时间：2012-10-01T14:50:00.817
> 
> 标签：cocoaasyncsocket

我是 iOS 套接字编程的新手。我已经用带有 {packet, 4} 的 erlang 实现了一个 tcp 服务器，在 erlang 套接字之间进行通信很容易。但是如何在 AsyncSocket 中将数据包的长度添加到 4 个字节中？

一些代码表示赞赏。

我进行了如下测试，但对我的服务器端没有影响：

```
int s = 10;
NSMutableData *headData = [NSMutableData dataWithBytes:&s length:4];

const char *body = [@"hello" UTF8String];
NSMutableData* bodyData = [NSMutableData dataWithBytes:body length:strlen(body)];

[sock writeData:headData withTimeout:-1 tag:100];
[sock writeData:bodyData withTimeout:-1 tag:101]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:14:55.900

你告诉服务器你正在发送 10 个字节，而实际上你没有。您需要使用您发送的数据的实际长度。而且，由于服务器可能与您的机器具有不同的字节序，您需要确定协议中的长度是小端还是大端：

```
const char *body = [@"hello" UTF8String];
NSMutableData* bodyData = [NSMutableData dataWithBytes:body length:strlen(body)];

uint32_t s = strlen(body);
uint32_t swapped = CFSwapInt32HostToBig(s)
NSMutableData *headData = [NSMutableData dataWithBytes:&swapped length:4];

[sock writeData:headData withTimeout:-1 tag:100];
[sock writeData:bodyData withTimeout:-1 tag:101]; 
```

# java - Component/LayoutManager 显示 JPanel 列表

> ID：12675642
> 
> 赞同：0
> 
> 时间：2012-10-01T14:50:21.670
> 
> 标签：java, swing, drag-and-drop, jpanel, layout-manager

有没有办法显示`JPanels`并重新排列它们？创建一个列表可以使用 a 来完成`BoxLayout`，但是你怎么能交换两个`JPanels`呢？面板保持互动也很重要。

我会尝试一个例子：

```
import java.awt.Component;
import java.awt.EventQueue;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import java.util.List;

import javax.swing.BoxLayout;
import javax.swing.DefaultListModel;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.ListCellRenderer;

public class PanelList {

    private static final class Entry extends JPanel {

        public Entry(final int i) {
            super();
            final JButton button = new JButton("Dialog '" + i + "'");
            button.addActionListener(new ActionListener() {

                @Override
                public void actionPerformed(ActionEvent e) {
                    JOptionPane.showMessageDialog(Entry.this, "Hello World '"
                            + i + "'");
                }
            });
            this.add(button);
        }
    }

    public static void main(String args[]) {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame f = new JFrame("PanelList");
                f.setLayout(new GridLayout(1, 2));
                f.add(new BoxLayoutList());
                f.add(new JListList());
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                f.pack();
                f.setVisible(true);
            }
        });
    }

    private static final class BoxLayoutList extends JPanel {
        private final List<Entry> entries = new ArrayList<>();

        public BoxLayoutList() {
            this.setLayout(new BoxLayout(this, BoxLayout.Y_AXIS));
            int i = 0;
            while (i < 10) {
                final Entry entry = new Entry(i);
                this.add(entry);
                this.entries.add(entry);
                i++;
            }
        }
    }

    private static final class JListList extends JPanel {
        private final DefaultListModel<Entry> entries = new DefaultListModel<>();

        public JListList() {
            final JList<Entry> entryComponent = new JList<>(this.entries);
            this.add(entryComponent);
            entryComponent.setCellRenderer(new ListCellRenderer<Entry>() {
                @Override
                public Component getListCellRendererComponent(
                        JList<? extends Entry> list, Entry value, int index,
                        boolean isSelected, boolean cellHasFocus) {
                    return value;
                }
            });
            int i = 0;
            while (i < 10) {
                final Entry entry = new Entry(i);
                this.entries.addElement(entry);
                i++;
            }
            // Example: Swap entries 4 and 2
            final Entry buffer = this.entries.get(4);
            this.entries.set(4, this.entries.get(2));
            this.entries.set(2, buffer);
        }
    }
} 
```

现在 BoxLayout 是交互式的，但我不知道如何像在 JList 替代项中使用条目 4 和 2 那样交换条目。但是我不可能与组件进行交互。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T14:51:51.163

使用`JList`¹和拖放²重新排序。

1.  [如何使用列表](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html)
2.  [拖放和数据传输：简介](http://docs.oracle.com/javase/tutorial/uiswing/dnd/intro.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-02T11:15:24.830

从您的评论看来，我们认为太复杂了 - 如果您想以*编程*方式交换两个孩子，您所需要的只是

```
container.add(comp, index) 
```

一个快速的片段（带有硬编码索引的最粗略的逻辑:)

```
final JPanel panel = new JPanel();
panel.setLayout(new BoxLayout(panel, BoxLayout.PAGE_AXIS));
for (int i = 0; i < 6; i++) {
    panel.add(new JTextField("was at: " + i, 20));
}

Action action = new AbstractAction("exchange") {

    @Override
    public void actionPerformed(ActionEvent e) {
        JTextField one = (JTextField) panel.getComponent(2);
        JTextField second = (JTextField) panel.getComponent(5);
        second.setText(second.getText() + " -> 2");
        one.setText(one.getText() + " -> 5");
        panel.add(second, 2);
        panel.add(one, 5);
        panel.revalidate();
    }

};
frame.add(new JButton(action), BorderLayout.SOUTH); 
```

# vb.net - 为什么我不能将具有类型约束的泛型参数转换为受约束的类型？

> ID：12675643
> 
> 赞同：3
> 
> 时间：2012-10-01T14:50:23.970
> 
> 标签：vb.net, generics, inheritance

我已经习惯于使用接口、泛型并在真实环境中使用继承来开发它们，同时尝试将其用于我们即将进行的项目之一的新架构中，我有一个关于泛型的问题，我对此感到困惑。

这对我自己来说更像是一个教育问题，因为我不明白为什么 .NET 不允许这样做。

如果我有一个泛型类，`(Of T As IA, T2 As A)`那么我有以下接口和实现基本接口的类

```
Public Interface IA
  Property A As String
End Interface
Public Interface IB
  inherits IA
  Property B As String
End Interface

Public Class GenericClass(Of T As IA, T2 As A)
  'Should be list of IA?
  Public list As New List(Of T)
  Public Sub Add()
  End Sub
End Class 
```

因为我已经做了`T as IA`为什么在add方法`Dim foo4 As T = New A()`不合法的时候

```
Dim foo1 As IA = New A()
Dim foo2 As T
Dim foo3 = Activator.CreateInstance(Of T2)()
Dim x As IA = foo2
Dim y As IA = foo3
list.Add(x)
list.Add(y) 
```

以上都是？这正在成为我使用泛型等的学习曲线，但我只是很困惑为什么我在逻辑上不能这样做？

编辑：抱歉忘记了`Class A`，错误信息请见下文

```
Public Class A
  Implements IA
  Public Property A As String Implements IA.A
End Class 
```

编辑 2：错误输入错误

“a 类型的值不能转换为 T”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T16:12:04.553

目前尚不清楚您要做什么，但我注意到的一个问题是您似乎假设 a`List<TypeThatImplementsIA>`可以与 a 互换`List<IA>`。事实并非如此。想象一下，这`A`是一类会飞的鸟，`IA`由会飞的生物实现，有人创造了一个`GenericClass<Airplane, BlueJay)`. 尽管`Airplane`和`BlueJay`都是可以飞行的东西，但无法将 a 添加`BlueJay`到 a`List<Airplane>`中。框架中可以将 a`GenericType<DerivedType>`用作 a的一种常见情况`GenericType<BaseType>`是与`IEnumerable<T>`. 原因是不能将`T`'s 存储到`IEnumerable<T>`--one 只能读出它们。如果一个人期待一个`IEnumerable<Animal>`并且一个人得到一个`IEnumerable<MaineCoonCat>`，那么每次一个人期待阅读一个`Animal`，人们将读取 的一个实例`MainCoonCat`，该实例继承自`Animal`它，因此可以替代它。的这个特征`IEnumerable<T>`称为*协方差*。

但是，这种行为有一个限制，这是因为将接口用作一种存储位置（变量、参数等）与将其用作约束之间存在差异。对于每个不可为空的值类型，在运行时中实际上有两种相关的类型。其中之一是真正的值类型，它没有继承的概念（但可以实现接口）。`ValueType`另一种是派生自（又派生自）的堆对象类型`Object`。大多数 .net 语言会隐式地将前者类型转换为后者，并允许代码将后者显式转换为前者。接口类型的存储位置只能保存对堆对象的引用。这很重要，因为这意味着虽然实现接口的结构是*可转换*为该接口类型，这并不意味着该结构*的*实例是该接口类型的实例。协方差的工作前提是，例如 an 返回的每个对象`IEnumerable<DerivedType>`都可以直接用作 的实例而`BaseType` *无需转换*。这种直接可替换性适用于继承的类类型，以及*由类类型*实现的接口。它不适用于由结构类型实现的接口，或没有泛型的泛型`class`约束。将类约束添加到泛型类类型参数将允许该类型参数参与协变，但可能会阻止将结构用作泛型类型参数。请注意，除非有特定的理由期望接口将由结构实现（例如`IComparable<T>`，在许多情况下，接口不太可能由结构实现，因此`class`约束是无害的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T15:47:42.063

那是因为`T`不是接口`IA`本身。这是它的一种实现。

假设您有另一个类实现`IA`：

```
Public Class B
  Implements IA
  Public Property B_A As String Implements IA.A
  Public Property OtherProperty as Object
End Class 
```

然后你创建一个这样的新实例`Generic Class`：

```
Dim genericObject as new GenericClass(Of B, A) 
```

所以在这种情况下，`T`now 是`B`，并且`A`不能转换为`B`。

在这种情况下，代替您怀疑的部分，一个对我有意义的代码：

```
Dim foo4 As IA = New T() 
```

**编辑由于评论**

为了能够实例化`T`，有必要`New`在类型定义中声明约束。所以泛型类声明将是：

```
Public Class GenericClass(Of T As {New, IA}, T2 As A) 
```

# nosql - 映射减少“ORDER BY”2 列

> ID：12675646
> 
> 赞同：1
> 
> 时间：2012-10-01T14:50:34.163
> 
> 标签：nosql, mapreduce, couchdb

这是我的 SQL 查询，它列出了最年轻和最有才华的狗：

```
SELECT * FROM dog
ORDER BY dog.age ASC, dog.kudus DESC 
```

如何将其转换为 map/reduce？

```
// Map
function (doc) {
  emit([doc.age, doc.kudus], doc);
}
// Reduce
function (keys, values) {
  return ???
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T20:44:00.170

使用地图时，您正在使用创建一维索引。您遇到的问题是您希望结果显示在“kudus”属性中的排序顺序与年龄键的 asc 顺序相反。这是一个简单的修复：

```
// map
function(doc) {
   emit([doc.age, -doc.kudus], doc);
} 
```

为此，您不需要 reduce 函数。

看到负数有点有趣，但它可以让你得到正确的排序顺序。您可以 Math.abs(key[1]) 或使用 value.kudus 来获得真正的价值。

# android - 在一个对话框中同时显示 2 个 WebView

> ID：12675650
> 
> 赞同：0
> 
> 时间：2012-10-01T14:50:37.987
> 
> 标签：android, android-layout, android-webview, android-linearlayout, android-dialog

我目前有一个 WebView 作为对话框的“contentView”。这完美地工作。现在我想在一个对话框中并排显示两个 Webview。

我尝试将它们放在一个 LinearLayout 中，并使用该 LinearLayout 作为对话框的“contentView”。但它不起作用。

这是我的代码，结果只是一个空对话框（大约一行的高度）PS。活动固定在横向模式。

```
Dialog dialog = new Dialog(context);           
    LinearLayout linearLayout = new LinearLayout(this);
    linearLayout.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));

    WebView webView1 = new WebView(this);
    webView1.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,
            LayoutParams.WRAP_CONTENT, 1));
    webView1.getSettings().setPluginsEnabled(true);
    webView1.getSettings().setJavaScriptEnabled(true);
    webView1.setBackgroundColor(Color.LTGRAY);
    webView1.loadUrl("http://www.url1.com");
    linearLayout.addView(webView1);

    WebView webView2 = new WebView(this);
    webView2.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,
            LayoutParams.WRAP_CONTENT, 1));
    webView2.getSettings().setPluginsEnabled(true);
    webView2.getSettings().setJavaScriptEnabled(true);
    webView2.setBackgroundColor(Color.LTGRAY);
    webView2.loadUrl("http://www.url2.com");
    linearLayout.addView(webView2);

    dialog.setContentView(linearLayout);
    dialog.show(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T13:33:59.137

使用 getApplicationContext 而不是上下文来实例化对话框..这有时有效......

# java - 具有扩展持久上下文的意外分离实体

> ID：12675654
> 
> 赞同：3
> 
> 时间：2012-10-01T14:50:53.453
> 
> 标签：java, jboss, resteasy, entitymanager

我试图通过使用 EXTENDED_PERSISTENT_CONTEXT 来维护多个调用的状态。我的理解是托管实体不会在调用之间分离，但是在我之前抛出验证错误之后，我不断收到与调用中分离实体相关的错误。状态在有状态会话 bean 中维护：

```
@Named(SessionFacadeBean.SEAM_NAME)
@SessionScoped
@Stateful
@LocalBean
@AccessTimeout(value = 10, unit = TimeUnit.SECONDS)
public class SessionFacadeBean implements Serializable
{
    public static final String  SEAM_NAME        = "sessionCacheBean";

    @PersistenceContext(unitName = GlobalParameters.BACKEND_CODE_PERSISTENCE_CONTEXT_NAME, type = PersistenceContextType.EXTENDED)
    private EntityManager       em;

    private ParentOne sessionData;

    public synchronized ParentOne getSessionData() {
        if(sessionData == null) {
            sessionData = new ChildTwo();
        }
        return sessionData;
    }

    public boolean getLock() {
        return true;
    }

    public void clearLock() {
    }

    // Other stuff I don’t ‘think’ is relevant.
} 
```

（简化的）状态正在使用休眠进行存储。它由三个类（一个父类和两个子类，其中一个包含子类列表）组成：

```
@XmlRootElement(name = XMLConstants.COMPONENT_ELEMENT_NAME_IN_XML)
@XmlAccessorType(XmlAccessType.NONE)
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "Class", length = 50)
@Entity
public class ParentOne 
{   
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @XmlElement(name = "ID")
    private Long              iD;

    @XmlElement(name = "name")
    protected String              friendlyName          = "";
}

@XmlRootElement(name = XMLConstants.COMPONENT_ELEMENT_NAME_IN_XML)
@XmlAccessorType(XmlAccessType.NONE)
@Entity
public class ChildOne extends ParentOne
{
    public ChildOne(String name, ParentOne child) {
        super(name);
        myChild = child;
    }

    @ManyToOne(cascade = CascadeType.ALL)
    protected ParentOne myChild;   
}

@XmlRootElement(name = XMLConstants.COMPONENT_ELEMENT_NAME_IN_XML)
@XmlAccessorType(XmlAccessType.NONE)
@Entity
public class ChildTwo extends ParentOne
{
    public ChildTwo() {
            super(“common”);
    }
} 
```

我正在从无状态 bean 访问有状态 bean，如下所示：

```
@Stateless
@LocalBean
@Path("/")
public class MyService
{
    @PersistenceContext(unitName = GlobalParameters.BACKEND_CODE_PERSISTENCE_CONTEXT_NAME)
    private EntityManager       em;

    @Inject
    private SessionFacadeBean   sessionBean;

    @POST
    @Path("/create/item")
    @ValidateRequest
    public ComponentShortSummary addItem(@Form NewItemForm itemForm)
    {       
        if(sessionBean.getLock()) {
            try {
                if(itemForm.getName().equals("INVALID") == true) {
                    throw new ConstraintViolationException("Failed", new HashSet<ConstraintViolation<?>>());
                }

                ChildOne child = new ChildOne(itemForm.getName(), sessionBean.getSessionData());
                em.persist(child);
                return null;
            }
            finally {
                sessionBean.clearLock();
            }
        } else {
            return null;
        }
    }
} 
```

为了重现该问题，我执行以下顺序：

*   使用有效名称调用 addItem（这会将项目保存到数据库中）。
*   使用名称“INVALID”调用 addItem，这会引发约束异常。
*   使用有效名称调用 addItem（这会导致在`em.persist(child)`.

我不明白的是我如何/为什么最终得到分离的实体。在实际代码中，我会在修改状态之前执行一些请求/状态验证（因此我没有理由看到状态已被分离）。

如果我删除对的调用，`sessionBean.getLock()`那么问题就会消失（对象正确存在）。锁定方法的目的本质上是序列化对会话状态的访问，但是目前该`getLock()`方法是空的，感觉问题可能与我在抛出异常之前调用有状态 bean 的事实有关。

任何人都可以解释导致我的实体变得分离的原因/如果有办法避免它（最好将我指向任何支持解释的文档）？

虽然可能有一些方法可以解决当前问题，在访问有状态 bean 之前执行验证，但我担心一般情况（在调用中访问有状态 bean 后抛出任何异常）。当我不希望扩展持久上下文中的实体被分离时，是否有一种公认的处理异常的策略？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:54:07.247

看起来这是预期的行为。感谢[Scott Marlow](https://community.jboss.org/message/763922#763922)对 JPA 规范第 3.3.2 节的引用。

> 事务回滚 对于事务范围和扩展的持久性上下文，事务回滚会导致所有预先存在的托管实例和已删除的实例[31] 分离。实例的状态将是事务回滚时实例的状态。事务回滚通常会导致持久性上下文在回滚点处于不一致状态。特别地，版本属性的状态和生成的状态（例如，生成的主键）可能不一致。因此，以前由持久性上下文管理的实例（包括在该事务中持久化的新实例）可能无法以与其他分离对象相同的方式重用——例如，它们在传递给合并操作时可能会失败。 [32 ]

So, entities that are involved in the active transaction are detached when the transaction is rolled back and by calling out to the sessionBean I am involving it in the transaction.

One way around this appears to be to decorate acceptable exceptions with the `@AppicationException` annotation. This marks the exception as non-fatal and prevents the transaction from being rolled back. This approach is described in some detail by [David Blevin](http://blog.dblevins.com/2010/07/applicationexception-is-evil-sort-of.html).

# ios - CVOpenGLESTextureCacheCreateTextureFromImage 创建 IOSurface 失败

> ID：12675655
> 
> 赞同：17
> 
> 时间：2012-10-01T14:50:55.557
> 
> 标签：ios, opengl-es

对于我目前的项目，我正在阅读 iPhone 的主摄像头输出。然后，我通过以下方法将像素缓冲区转换为缓存的 OpenGL 纹理：`CVOpenGLESTextureCacheCreateTextureFromImage`. 这在处理用于预览的相机帧时非常有用。在 iPhone 3GS、4、4S、iPod Touch（第 4 代）和 IOS5、IOS6 的不同组合上进行了测试。

但是，对于具有非常高分辨率的实际最终图像，这仅适用于以下组合：

*   iPhone 3GS + IOS 5.1.1
*   iPhone 4 + IOS 5.1.1
*   iPhone 4S + IOS 6.0
*   iPod Touch（第 4 代）+ IOS 5.0

这不适用于：iPhone 4 + IOS6。

控制台中的确切错误消息：

```
Failed to create IOSurface image (texture)
2012-10-01 16:24:30.663 GLCameraRipple[676:907] Error at CVOpenGLESTextureCacheCreateTextureFromImage -6683 
```

我已经通过更改 Apple 的 GLCameraRipple 项目来隔离这个问题。你可以在这里查看我的版本：http: [//lab.bitshiftcop.com/iosurface.zip](http://lab.bitshiftcop.com/iosurface.zip)

以下是我如何将 stilloutput 添加到当前会话：

```
- (void)setupAVCapture
{
    //-- Create CVOpenGLESTextureCacheRef for optimal CVImageBufferRef to GLES texture conversion.
    CVReturn err = CVOpenGLESTextureCacheCreate(kCFAllocatorDefault, NULL, [EAGLContext currentContext], NULL, &_videoTextureCache);
    if (err) 
    {
        NSLog(@"Error at CVOpenGLESTextureCacheCreate %d", err);
        return;
    }

    //-- Setup Capture Session.
    _session = [[AVCaptureSession alloc] init];
    [_session beginConfiguration];

    //-- Set preset session size.
    [_session setSessionPreset:_sessionPreset];

    //-- Creata a video device and input from that Device.  Add the input to the capture session.
    AVCaptureDevice * videoDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
    if(videoDevice == nil)
        assert(0);

    //-- Add the device to the session.
    NSError *error;        
    AVCaptureDeviceInput *input = [AVCaptureDeviceInput deviceInputWithDevice:videoDevice error:&error];
    if(error)
        assert(0);

    [_session addInput:input];

    //-- Create the output for the capture session.
    AVCaptureVideoDataOutput * dataOutput = [[AVCaptureVideoDataOutput alloc] init];
    [dataOutput setAlwaysDiscardsLateVideoFrames:YES]; // Probably want to set this to NO when recording

    //-- Set to YUV420.
    [dataOutput setVideoSettings:[NSDictionary dictionaryWithObject:[NSNumber numberWithInt:kCVPixelFormatType_32BGRA]
                                                             forKey:(id)kCVPixelBufferPixelFormatTypeKey]]; // Necessary for manual preview

    // Set dispatch to be on the main thread so OpenGL can do things with the data
    [dataOutput setSampleBufferDelegate:self queue:dispatch_get_main_queue()];

    // Add still output
    stillOutput = [[AVCaptureStillImageOutput alloc] init];
    [stillOutput setOutputSettings:[NSDictionary dictionaryWithObject:[NSNumber numberWithInt:kCVPixelFormatType_32BGRA] forKey:(id)kCVPixelBufferPixelFormatTypeKey]];
    if([_session canAddOutput:stillOutput]) [_session addOutput:stillOutput];

    [_session addOutput:dataOutput];
    [_session commitConfiguration];

    [_session startRunning];
} 
```

以下是我捕获静止输出并对其进行处理的方法：

```
- (void)capturePhoto
{
    AVCaptureConnection *videoConnection = nil;
    for (AVCaptureConnection *connection in stillOutput.connections) {
        for (AVCaptureInputPort *port in [connection inputPorts]) {
            if ([[port mediaType] isEqual:AVMediaTypeVideo] ) {
                videoConnection = connection;
                break;
            }
        }
        if (videoConnection) { break; }
    }

    [stillOutput captureStillImageAsynchronouslyFromConnection:videoConnection completionHandler:
     ^(CMSampleBufferRef imageSampleBuffer, NSError *error) {
         // Process hires image
         [self captureOutput:stillOutput didOutputSampleBuffer:imageSampleBuffer fromConnection:videoConnection];
     }];
} 
```

以下是纹理的创建方式：

```
- (void)captureOutput:(AVCaptureOutput *)captureOutput 
didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer 
       fromConnection:(AVCaptureConnection *)connection
{
    CVReturn err;
    CVImageBufferRef pixelBuffer = CMSampleBufferGetImageBuffer(sampleBuffer);
    size_t width = CVPixelBufferGetWidth(pixelBuffer);
    size_t height = CVPixelBufferGetHeight(pixelBuffer);

    if (!_videoTextureCache)
    {
        NSLog(@"No video texture cache");
        return;
    }

    if (_ripple == nil ||
        width != _textureWidth ||
        height != _textureHeight)
    {
        _textureWidth = width;
        _textureHeight = height;

        _ripple = [[RippleModel alloc] initWithScreenWidth:_screenWidth 
                                              screenHeight:_screenHeight
                                                meshFactor:_meshFactor
                                               touchRadius:5
                                              textureWidth:_textureWidth
                                             textureHeight:_textureHeight];

        [self setupBuffers];
    }

    [self cleanUpTextures];

    NSLog(@"%zi x %zi", _textureWidth, _textureHeight);

    // RGBA texture
    glActiveTexture(GL_TEXTURE0);
    err = CVOpenGLESTextureCacheCreateTextureFromImage(kCFAllocatorDefault, 
                                                       _videoTextureCache,
                                                       pixelBuffer,
                                                       NULL,
                                                       GL_TEXTURE_2D,
                                                       GL_RGBA,
                                                       _textureWidth,
                                                       _textureHeight,
                                                       GL_BGRA,
                                                       GL_UNSIGNED_BYTE,
                                                       0,
                                                       &_chromaTexture);
    if (err) 
    {
        NSLog(@"Error at CVOpenGLESTextureCacheCreateTextureFromImage %d", err);
    }

    glBindTexture(CVOpenGLESTextureGetTarget(_chromaTexture), CVOpenGLESTextureGetName(_chromaTexture));
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE); 
} 
```

有什么建议可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T13:35:29.340

iPhone 4（以及 iPhone 3GS 和 iPod Touch 第 4 代）使用[PowerVR SGX 535](http://en.wikipedia.org/wiki/PowerVR#Series_5_.28SGX.29) GPU，其[最大 OpenGL ES 纹理大小为 2048x2048](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/OpenGLESPlatforms/OpenGLESPlatforms.html)。这个值可以通过调用找到

```
glGetIntegerv(GL_MAX_TEXTURE_SIZE, &maxTextureSize); 
```

iPod Touch 第 4 代。摄像头分辨率为 720x960，iPhone 3GS 为 640x1136，但 iPhone 4 的后置摄像头分辨率为 1936x2592，太大而无法放入单个纹理。

您始终可以以较小的尺寸重写捕获的图像，同时保留纵横比 (1529x2048)。Brad Larson 在[他的 GPUImage 框架](https://github.com/BradLarson/GPUImage/blob/master/framework/Source/GPUImageStillCamera.m)上完成了这项工作，但它非常简单，只需使用 Core Graphics 重绘原始像素缓冲区的数据，然后从重绘数据中制作另一个像素缓冲区。框架的其余部分也是一个很好的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T10:22:01.827

我们不能将静止图像纹理投射到 CVOpenGLESTextureCacheRef。Core Video 允许您将视频帧直接映射到 OpenGL 纹理。使用一个视频缓冲区，Core Video 在其中创建纹理并将它们提供给我们，已经在视频内存中。

要创建 opengles 纹理，此链接可能会对您有所帮助 [Link](http://iphonedevelopment.blogspot.in/2009/05/opengl-es-from-ground-up-part-6_25.html)

# xaml - 如何读取区域“网格”的大小？或者如何将 xaml 中的数据转换为 C++/CX 代码？

> ID：12675656
> 
> 赞同：0
> 
> 时间：2012-10-01T14:50:55.747
> 
> 标签：xaml, visual-c++, windows-8, windows-runtime

我正在使用区域“网格”的动态标记

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="1*"/>
        <ColumnDefinition Width="1*"/>
    </Grid.ColumnDefinitions>

    <!--This Grid-->
    <Grid Grid.Column="0" Name="gridImage" SizeChanged="gridImage_SizeChanged">
        <Image Name="image" HorizontalAlignment="Center" VerticalAlignment="Center"/>
    </Grid>     

</Grid> 
```

在我的代码中，我根据包含此图像的“网格”的大小逐像素绘制图像。如何在代码中读取“网格”区域的大小？

属性 gridImage->Width 和 gridImage->Height 让我可以设置值但不能获取它们。

```
gridImage->Width = 100;//OK
gridImage->Height = 100;//OK

int width = gridImage->Width;//return -2 147 483 648
int height = gridImage->Height;//return -2 147 483 648 
```

如果我对网格区域使用 SizeChanged 事件，那么我可以使用此代码读取大小

```
void MainPage::gridImage_SizeChanged(Platform::Object^ sender, Windows::UI::Xaml::SizeChangedEventArgs^ e)
{
    Size size = e->NewSize;
    int width = size.Width;//OK
    int height= size.Height;//OK
} 
```

但是这个事件只有在改变图像对象后才可用，这意味着在我需要它之后才可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:59:57.543

使用[ActualWidth](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.frameworkelement.actualwidth)和[ActualHeight](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.frameworkelement.actualheight.aspx)属性分别获取以像素为单位的实际宽度和高度。与 Height、Width、MinHeight、MinWidth、MaxHeight 和 MaxWidth 不同，它们实际上包含高度和宽度。

# c - 了解 glibc

> ID：12675658
> 
> 赞同：3
> 
> 时间：2012-10-01T14:50:59.027
> 
> 标签：c, linux, gcc, glibc, shared-libraries

我想将我的程序作为二进制文件分发，而不是源代码形式。我有两个测试系统：一个较旧的 Linux（带有 glibc 2.10 的 openSUSE 11.2）和一个最近的（带有 glibc 2.15 的 LinuxMint 13）。现在，当我在 LinuxMint 系统上使用 glibc 2.15 编译我的程序，然后尝试在 openSUSE 系统上使用 glibc 2.10 启动二进制文件时，我收到以下两个错误：

```
./a.out: /lib/libc.so.6: version 'GLIBC_2.15' not found (required by ./a.out)
./a.out: /lib/libc.so.6: version 'GLIBC_2.11' not found (required by ./a.out) 
```

这里让我感到困惑的是：为什么我也会在这里收到“glibc 2.11 not found”错误？我希望该程序现在需要 glibc 2.15，因为它是使用 glibc 2.15 编译的。为什么程序也在寻找 glibc 2.11？这是否意味着我的程序将在两个 glibc 版本（即 2.15 和 2.11）上运行？所以它至少需要2.11？还是无论如何都需要2.15？

另一个问题：glibc 向上兼容但不向下兼容的假设是否正确？例如，使用 glibc 2.10 编译的程序是否可以保证与任何未来版本的 glibc 完美配合？如果是这种情况，如果将来更改 PATH_MAX 之类的常量会怎样？目前它设置为 4096，我正在使用 PATH_MAX 常量为 realpath() POSIX 函数分配缓冲区。现在如果将来这个常数提高到 8192，可能会出现问题，因为我的程序只分配了 4096 个字节。还是我在这里误解了什么？

感谢您的解释！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T15:01:56.483

Libc 使用符号版本控制。这是相当高级的魔法，但基本上每个符号都根据它出现的版本附加标签。如果它的语义发生变化，则有两个版本，一个是旧语义，它是第一次出现的版本，另一个是新语义和它出现的版本。加载程序只会抱怨您的程序实际请求的符号。其中一些恰好是在 2.15 中引入的，而其中一些恰好是在 2.11 中引入的。

这样做的重点是保持 glibc 向后兼容。这真的很重要，因为有很多打包的软件，所有这些都是动态链接的，重新编译所有这些需要很长时间。还有很多软件没有可用的源代码，旧版本的 libc 可能不适用于新内核或其他新内核。

所以是的，glibc 是向后兼容的。只需确保针对需要运行它的最旧版本进行编译，因为它不（也不能）向前兼容。

Ad PATH_MAX：如果进行了这样的更改，glibc 将简单地导出使用新值的新版本符号和具有适当安全保证的旧版本符号，以使用针对旧值编译的代码。这就是所有魔法的要点。

# python - 为具有祖先的密钥创建一个好看的 url

> ID：12675664
> 
> 赞同：1
> 
> 时间：2012-10-01T14:51:16.150
> 
> 标签：python, google-app-engine, key, google-cloud-datastore

我需要从 ndb 的键中获取一个实例。该键可能有一个父键，但我不想将任何父键传递给 url，因为我想要一个好看的 url。我也不想将整个密钥字符串传递给 url。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:10:28.987

这是可能的。但是父键在您的代码中将是静态的。

当您获得数字 id 时，您只需重建密钥。

```
id = long(inputId) 
key = ndb.Key('Somekind', 'somevalue', 'kindOfInstance', id)

instance = key.get() # get instance 
```

'Somekind' 是父类的名称。'somevalue' 是父类的字符串 id。'kindOfInstance' 是实例类的名称。您可以只使用不带引号的类。

# python - 当数字不是一个快乐的数字时何时停止

> ID：12675665
> 
> 赞同：0
> 
> 时间：2012-10-01T14:51:22.003
> 
> 标签：python, algorithm

快乐数由以下过程定义。从任何正整数开始，将数字替换为其数字的平方和，然后重复该过程，直到数字等于 1。

但是当数字不是一个快乐的数字时，它会在一个不包括 1 的循环中无限循环。

我在 python 中编写了快乐数字问题，但问题是当数字不快乐时，我怎么能停止迭代循环。因为它不会以 1 结束，并且会不断重复。

```
def happynumber(number):

while(number!=1):
    numberstr = str(number) #converting a number to string
    index=0 
    sum=0
    while(index!=len(numberstr)):
        sum = sum + int(numberstr[index])*int(numberstr[index])
        index = index+1
    print sum

    number = sum
return number 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-01T15:10:26.467

您可以使用恒定的内存量来检测不满意的数字。根据[Wikipedia](https://en.wikipedia.org/wiki/Happy_number#10-happy_numbers)，对于任何正整数起点，序列将在 1 处终止，或在 处永远循环`4, 16, 37, 58, 89, 145, 42, 20, 4`。由于不存在其他循环，因此很容易测试不快乐。

```
def isHappy(x):
    while True:
        if x == 1:
            return True
        if x == 4:
            return False
        x = nextNumberInSequence(x) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-01T14:54:12.847

您必须记录到目前为止您在序列中产生的所有数字，如果其中一个第二次出现，您知道您有一个永远不会达到 1 的循环。一[组](http://docs.python.org/library/sets.html)可能是一个不错的选择存放数字的地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-01T14:58:51.467

只要当前数字超过 3 位，它的值在下一次迭代中减小。当数字有 3 位时，下一次迭代可以取的最大值是 3*81 <= 250。所以使用大小为 250 的数组，记录序列中小于 250 的所有数字。然后您可以轻松检测是否有重复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-10T07:33:11.493

如果给定的数字是快乐数字，则此方法将返回 true ，否则将返回 false。我们在这里使用 set 来避免无限循环的情况。

输入：19

输出：真

解释：

1*1 + 9*9 = 82

8*8 + 2*2 = 68

6*6 + 8*8 = 100

1*1 + 0*0 + 0*0 = 1

```
 public static boolean isHappy(int n) {

          Set<Integer> seen = new HashSet<Integer>();

          while(n != 1) {
            int current = n;
            int sum = 0;
            while(current != 0) {
                sum += (current % 10) * (current % 10);
                current /= 10;
            }

            if(seen.contains(sum)) {
                return false;
            }

            seen.add(sum);
            n = sum;
        }

        return true;

    } 
```

# model - 货币交易领域模型

> ID：12675674
> 
> 赞同：1
> 
> 时间：2012-10-01T14:51:51.643
> 
> 标签：model, currency, domain-model, banking

我必须为货币交易开发一个领域模型。到目前为止，我已经发现每个用户（货币账户）都有属性“金额”，它定义了他有多少钱，然后账户之间的交易在包含 user1.id、user2.id 和转账金额的 Transaction 类中。

现在我很好奇如何使用该模型来显示用户何时从信用卡向帐户进行交易。该交易没有“来自”。我应该把字段留空吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:55:00.977

在现实世界中，信用卡是它自己的“账户”，有它自己的余额（通常是负数；CC 持有人欠发卡机构的债务）以及你在银行账户上拥有的几乎所有其他东西。我会遵守那个约定。

# java - 带有服务提供商证书的 curl 命令示例

> ID：12675685
> 
> 赞同：0
> 
> 时间：2012-10-01T14:52:21.583
> 
> 标签：java, ssl, curl, jax-ws, ws-security

我对 curl 命令的用法有疑问。所以基本上我们正在尝试使用一些支持 ssl 的第三方服务。我们有两个不同的供应商

1.  一家供应商已将其服务配置为需要客户端身份验证的 ssl。为此，我们有两个密钥，一个是带有我们的公钥的私钥。我们给了他们我们的公钥，我们得到了他们的带有证书的公钥。我们有一个带有 curl 的 unix 客户端，为此我们生成了带有以下内容的 .pem 文件命令“cat server.crt serverpublickey.key > server.pem”并使用 curl 命令调用他们的服务。它工作正常。在这个供应商案例中，我们从未使用过从浏览器获取 wsdl。它曾经表明它需要客户端身份验证。

2.  我们有另一个供应商，其服务配置了 ssl，但他们没有配置客户端身份验证。所以我们能够点击浏览器的 wsdl 链接，该浏览器曾经要求我们接受他们的证书，我们在浏览器中接受了证书，我们是能够看到wsdl文件。从技术上讲，当我们使用 https:// 访问任何站点时，它们会发送公共证书和公钥。因此，浏览器会使用密钥对数据进行加密并发送回服务器，当我们从服务器获取数据时，浏览器会与公众一起解密钥匙。现在的问题是如何从 curl 调用此服务？我猜我们发送公钥的每个请求的前一个供应商，以便他们知道它来自我们这边。在其他供应商案例中，他们有身份验证服务。一旦我们成功通过身份验证，他们就会向我们发送一个会话 ID，我们需要将其用于相应的调用。这就是为什么我猜他们从来没有使用他们的 ssl 进行客户端身份验证配置的原因。这又是我的猜测……

“现在我的问题是对于第二个供应商，我们只有在浏览器中获得的证书。有人可以告诉如何使用证书调用 curl 命令并调用第三方服务”

我可能在某些概念上是错误的。我的理解的任何答案也是可观的

# c# - MVC IRouteConstraint 实体框架性能

> ID：12675687
> 
> 赞同：1
> 
> 时间：2012-10-01T14:52:26.467
> 
> 标签：c#, asp.net-mvc, entity-framework-4, asp.net-mvc-routing

我正在尝试使我的 MVC 应用程序尽可能高效。我刚刚遇到以下问题，我不确定是否可以在实体框架或 MVC 中解决。

我有以下路线：

```
 routes.MapRoute(
                "UserNameRoute",
                "{UserName}/{Action}",
                new { controller = "UserName", action = "Index" },
                new
                {
                    UserName = new UserConstraint(DependencyResolver.Current.GetService<IUserRepository>())
                }); 
```

然后是以下路由约束：

```
 private readonly IUserRepository repository;

    public UserConstraint(IUserRepository repository)
    {
        if (repository == null)
        {
            throw new ArgumentNullException("repository");
        }

        this.repository = repository;
    }

    public bool Match(HttpContextBase httpContext, Route route, string parameterName, RouteValueDictionary values, RouteDirection routeDirection)
    {
        if (!values.ContainsKey(parameterName))
        {
            return false;
        }

        var siteRoot = (string)values[parameterName];

        var user = this.repository.Users.FirstOrDefault(u => u.UserName == userName && !u.Archived);

        if (user!= null)
        {
            values[parameterName] = user;
            return true;
        }

        return false;
    }
} 
```

然后我的控制器对每个动作的所有需求是：

```
 public ActionResult ExampleAction(User userName)
    {
        return this.View(userName);
    } 
```

这很好用，我可以让我的用户参与操作，一点问题都没有。问题来了，当我像这样在视图中放置一个操作链接时：

```
@Html.ActionLink("View some action or other", "someaction", new { UserName = Model.UserName }, new { @class = "myclass" }) 
```

上面的这个操作链接将按原样通过我的 IRouteConstraint 并在数据库上执行另一个数据库选择以获取它之前拥有的相同用户。它将为页面上的每个操作链接执行此操作。是否有更有效的方法来执行此操作，以便仅执行一次数据库选择？

我可能应该指出我首先在 EF 中使用代码。我没有使用通用存储库或我自己的滚动工作单元。我正在使用 MVC 版本 4 和实体框架 v4.3。

# iframe - 如何将画布应用程序的父窗口滚动到顶部？

> ID：12675692
> 
> 赞同：0
> 
> 时间：2012-10-01T14:52:34.697
> 
> 标签：iframe, canvas, scroll, facebook-iframe, iframe-app

我构建了一个 Facebook 画布应用程序，它有一些相当长的页面。当您滚动到页面底部并单击链接时，它不会将您带到下一页的顶部。下一页加载并仅显示其底部。为了使这项工作正常，我需要将父窗口滚动到顶部。这甚至可能吗？如果是这样，我将如何实现它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-19T00:41:48.563

根据 Facebook 文档，您可以使用 FB.Canvas.scrollTo() 方法告诉 Canvas 滚动到其页面的 X、Y。例子：

```
FB.Canvas.scrollTo(0,0); 
```

参考： [https ://developers.facebook.com/docs/reference/javascript/FB.Canvas.scrollTo/](https://developers.facebook.com/docs/reference/javascript/FB.Canvas.scrollTo/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:27:02.973

尝试使用 javascript ScrollTo() 方法：

```
window.scrollTo(0, 0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-06T05:46:48.840

此代码将使用动画进行滚动，请查看：

```
if (FB !== undefined){

  FB.Canvas.getPageInfo(function(pageInfo){
    $({y: pageInfo.scrollTop}).animate(
        {y: 30},
        {duration: 1000, step: function(offset){
            FB.Canvas.scrollTo(0, offset);
        }
    });
  });
} 
```

# jquery - CSS闪烁与jquery加载函数（）

> ID：12675693
> 
> 赞同：1
> 
> 时间：2012-10-01T14:52:39.493
> 
> 标签：jquery, jquery-load

我一直在寻找答案但找不到答案，我正在使用 jquery load() 函数加载一个 HTML 页面，在它加载的 html 中还有一个样式表，但内容是在样式表之前加载导致 un显示的格式化内容会产生类似植绒的效果。

我怎样才能解决这个问题？

```
$('#mainbody').load("test.html", function(){
    $jq('#mainbody a').click(function(e){
        e.preventDefault();
        var url = $jq(this).attr('href');
        if(url != "#"){
            loadurl($jq(this).attr('href'));
        }
    });
}); 
```

test.html（只需继续将段落添加到页面以复制它）

```
<link href="css/loginform.css" rel="stylesheet" type="text/css" media="all">
<h2>Login</h2>
Unauthorised access, including unsuccessful attempts to access privileged information, constitutes an offense under the Computer Misuse Act 1990\.  This Network is protected by a Security System and logs will be used as evidence in court. If you are not an authorised user do not attempt to proceed beyond this point.
<p>line</p>
<p>line</p>
<p>line</p>
<p>line</p>
<p>line</p>
<p>line</p> 
```

css 可以是除此之外的任何东西（可能需要添加更多的臃肿

```
h2 {
    padding: 0; margin: 0; color: #ebebeb; font: bold 44px "Calibri", Arial;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:00:01.357

隐藏#mainbody div，直到项目加载完毕。

```
var $main_body = $('#mainbody');
$main_body.load("test.html", function(){
    $main_body.show();
    $jq('#mainbody a').click(function(e){
        e.preventDefault();
        var url = $jq(this).attr('href');
        if (url != "#"){
            loadurl($jq(this).attr('href'));
        }
    });
}); 
```

# python - 嗖嗖 问题

> ID：12675703
> 
> 赞同：3
> 
> 时间：2012-10-01T14:53:00.350
> 
> 标签：python, search, django-haystack, whoosh

我正在阅读 Whoosh[快速入门指南](http://packages.python.org/Whoosh/quickstart.html)，一切似乎都在工作，只是我无法完全复制指南中的结果。

我对[Searcher 对象](http://packages.python.org/Whoosh/quickstart.html#the-searcher-object)以及运行代码时有所了解

```
print(results[0]) 
```

如果找到匹配项，我不会返回实际结果，我只是返回

```
<Hit {}> 
```

而在本教程中，输出是

```
{"title": "Second try", "path": "/b", "icon": "/icons/sheep.png"} 
```

这显然更有帮助！

知道我可能做错了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-01T15:14:31.043

弄清楚了。

对于那些遇到同样问题的人，我没有明确说明我的架构中的任何项目都被存储了 - 即（存储=真），这让我搞砸了。

# css - 如何使用 razor 自定义 EditorFor CSS

> ID：12675708
> 
> 赞同：3
> 
> 时间：2012-10-01T14:53:15.257
> 
> 标签：css, asp.net-mvc-3, razor, editorfor

我有这门课

```
public class Contact
{
    public int Id { get; set; }
    public string ContaSurname { get; set; }
    public string ContaFirstname { get; set; }
    // and other properties...
} 
```

我想创建一个允许我编辑所有这些字段的表单。所以我使用了这段代码

```
<h2>Contact Record</h2>

@Html.EditorFor(c => Model.Contact) 
```

这很好用，但我想自定义元素的显示方式。例如，我希望每个字段与其标签显示在同一行中。因为现在，生成的 html 是这样的：

```
<div class="editor-label">
  <label for="Contact_ContaId">ContaId</label>
</div>
<div class="editor-field">
  <input id="Contact_ContaId" class="text-box single-line" type="text" value="108" name="Contact.ContaId">
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T13:00:00.210

我同意上面jrummell的解决方案：当你使用`EditorFor`-Extension时，你必须编写一个自定义的编辑器模板来描述可视化组件。

在某些情况下，我认为对具有相同数据类型的多个模型属性使用编辑器模板有点僵硬。就我而言，我想在我的模型中使用十进制货币值，该值应显示为格式化字符串。我想在我的视图中使用相应的 CSS 类来设置这些属性的样式。

我见过其他实现，其中 HTML 参数已使用模型中的注释附加到属性中。我认为这很糟糕，因为视图信息（如 CSS 定义）应该设置在视图中，而不是数据模型中。

因此，我正在研究另一种解决方案：

我的模型包含一个`decimal?`属性，我想将其用作货币字段。问题是，我想`decimal?`在模型中使用数据类型，但使用格式掩码（例如“42,13 €”）将视图中的十进制值显示为格式化字符串。

这是我的模型定义：

```
[DataType(DataType.Currency), DisplayFormat(DataFormatString = "{0:C2}", ApplyFormatInEditMode = true)]
public decimal? Price { get; set; } 
```

格式掩码`0:C2`格式化`decimal`2 位小数。`ApplyFormatInEditMode`如果您想使用此属性来填充视图中的可编辑文本字段，这一点很重要。所以我将它设置为`true`，因为在我的情况下，我想把它放到一个文本字段中。

通常，您必须`EditorFor`像这样在视图中使用 -Extension：

```
<%: Html.EditorFor(x => x.Price) %> 
```

问题：

我不能在这里附加 CSS 类，因为我可以使用`Html.TextBoxFor`例如。

使用 -Extension提供自己的 CSS 类（或其他 HTML 属性，如`tabindex`或`readonly`）`EditorFor`就是编写自定义 HTML-Helper，如`Html.CurrencyEditorFor`. 这是实现：

```
public static MvcHtmlString CurrencyEditorFor<TModel, TValue>(this HtmlHelper<TModel> html, Expression<Func<TModel, TValue>> expression, Object htmlAttributes)
{
  TagBuilder tb = new TagBuilder("input");

  // We invoke the original EditorFor-Helper
  MvcHtmlString baseHtml = EditorExtensions.EditorFor<TModel, TValue>(html, expression);

  // Parse the HTML base string, to refurbish the CSS classes
  string basestring = baseHtml.ToHtmlString();

  HtmlDocument document = new HtmlDocument();
  document.LoadHtml(basestring);
  HtmlAttributeCollection originalAttributes = document.DocumentNode.FirstChild.Attributes;

  foreach(HtmlAttribute attr in originalAttributes) {
    if(attr.Name != "class") {
      tb.MergeAttribute(attr.Name, attr.Value);
    }
  }

  // Add the HTML attributes and CSS class from the View
  IDictionary<string, object> additionalAttributes = (IDictionary<string, object>) HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes);

  foreach(KeyValuePair<string, object> attribute in additionalAttributes) {
    if(attribute.Key == "class") {
      tb.AddCssClass(attribute.Value.ToString());
    } else {
      tb.MergeAttribute(attribute.Key, attribute.Value.ToString());
    }
  }

  return MvcHtmlString.Create(HttpUtility.HtmlDecode(tb.ToString(TagRenderMode.SelfClosing)));
} 
```

这个想法是使用原始的`EditorFor`-Extension 来生成 HTML 代码并解析这个 HTML 输出字符串，用我们自己的 CSS 类替换创建的 CSS Html-Attribute 并附加其他额外的 HTML 属性。对于 HTML 解析，我使用 HtmlAgilityPack（使用 google）。

在视图中，您可以像这样使用这个助手（不要忘记将相应的命名空间放入`web.config`您的视图目录中！）：

```
<%: Html.CurrencyEditorFor(x => x.Price, new { @class = "mypricestyles", @readonly = "readonly", @tabindex = "-1" }) %> 
```

使用这个助手，你的货币价值应该很好地显示在视图中。

如果您想发布您的视图（表单），那么通常所有模型属性都将发送到您的控制器的操作方法。在我们的例子中，将提交一个字符串格式的十进制值，由 ASP.NET MVC 内部模型绑定类处理。

因为此模型绑定器需要一个`decimal?`-value，但获取的是字符串格式的值，所以将引发异常。所以我们必须将格式化的字符串转换回它的`decimal?`- 表示。因此`ModelBinder`需要一个自己的 - 实现，它将货币十进制值转换回默认十进制值（“42,13 €”=>“42.13”）。

这是这样一个模型绑定器的实现：

```
public class DecimalModelBinder : IModelBinder
{

    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
      object o = null;
      decimal value;

      var valueResult = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);
      var modelState = new ModelState { Value = valueResult };

      try {

        if(bindingContext.ModelMetadata.DataTypeName == DataType.Currency.ToString()) {
          if(decimal.TryParse(valueResult.AttemptedValue, NumberStyles.Currency, null, out value)) {
            o = value;
          }
        } else {
          o = Convert.ToDecimal(valueResult.AttemptedValue, CultureInfo.CurrentCulture);
        }

      } catch(FormatException e) {
        modelState.Errors.Add(e);
      }

      bindingContext.ModelState.Add(bindingContext.ModelName, modelState);
      return o;
    }
} 
```

活页夹必须在`global.asax`您的应用程序文件中注册：

```
protected void Application_Start()
{
    ...

    ModelBinders.Binders.Add(typeof(decimal), new DecimalModelBinder());
    ModelBinders.Binders.Add(typeof(decimal?), new DecimalModelBinder());

    ...
} 
```

也许解决方案会帮助某人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T14:54:49.747

创建一个`Contact.cshtml`使用您的自定义标记调用的局部视图`Views/Shared/EditorTemplates`。这将覆盖默认编辑器。

正如@smartcavemen 所述，请参阅[Brad Wilson 的博客](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-1-introduction.html)了解模板介绍。

# objective-c - 从 Cocoa 应用程序项目中导出 XCode 中的 OSX 可执行文件

> ID：12675711
> 
> 赞同：1
> 
> 时间：2012-10-01T14:53:45.140
> 
> 标签：objective-c, xcode, macos, cocoa

我在 XCode 中制作了一个命令行工具作为 Cocoa 应用程序，当我归档它时，它会生成一个包含底层可执行文件的 .app 文件。要实际运行它，我需要执行位于 AppName.app/Contents/MacOS/AppName 的基础文件。有什么办法可以让它只构建可执行文件吗？我不想创建一个从 .app 文件中复制可执行文件的构建后步骤。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T21:38:32.217

创建 Xcode 项目时，您选择项目类型。Cocoa 应用程序和命令行工具是其中的两个选择。显然您创建了一个 Cocoa 应用程序，但修改了模板提供的 main.m 文件以作为命令行工具执行。但是，一旦创建了项目，就无法将其转换为另一种项目类型。Xcode 仍会将其视为您创建它的项目类型。

您可以通过创建一个新项目来解决您的问题，这次输入命令行工具，复制到相同的软件中，然后构建。如您所愿，构建产品将是一个 UNIX 命令行程序。

# tfs - 限制 TFS2012 中的产品待办事项排序/优先级

> ID：12675712
> 
> 赞同：2
> 
> 时间：2012-10-01T14:53:46.490
> 
> 标签：tfs, permissions, drag-and-drop, scrum

在 TFS2012 中查看 Product Backlog 时，是否可以限制通过拖放重新排序项目的能力？我们只希望某些组能够使用 Team Web Access 中的拖放功能重新排序 PBI。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T04:27:39.597

您应该能够编辑积压 xml 文件并将其设置为特定用户组的只读积压优先级字段。

[http://social.msdn.microsoft.com/Forums/en-US/tfsprocess/thread/86635b29-be54-4c26-b918-0244f9d502c1/](http://social.msdn.microsoft.com/Forums/en-US/tfsprocess/thread/86635b29-be54-4c26-b918-0244f9d502c1/)

这可能不会阻止您拖动它们，但如果它们这样做可能会出错并且不会保存。

# c# - 在画布上显示数据库中的值

> ID：12675713
> 
> 赞同：0
> 
> 时间：2012-10-01T14:53:50.623
> 
> 标签：c#, javascript, html5-canvas

我有一个网站，显示荷兰游泳运动员的时间、个人记录、结果、限制等。我想补充的是一个图表，它显示了游泳者在一定行程/距离内随时间的进展。

为此，我想使用 HTML5 画布。我做了一些教程，阅读了一些网站，我能够通过 javascript 绘制一个漂亮的图表。但是现在：如何让数据库和（可能）javascript一起工作？我如何从我的数据库中获取值到 javascript 函数，所以它可以在我的画布上绘制图表？....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:57:24.313

将数据库放在服务器上。添加一个脚本（php？Python？无论您的网络服务器有什么）以通过 SQL 从数据库中检索值并将它们转换为 JSON（javascript 对象表示法）。

在您的 javascript 中，为上述服务器的数据页面创建一个 AJAX 脚本，瞧，浏览器中的数据。

主要问题是javascript（特别是在浏览器中）预计来自服务器并与之通信。它并没有真正的客户端数据库连接库。

如果你想在客户端做这一切，那么我建议你忽略 canvas 和 html，并使用 c# 选项。

# msdeploy - 在 msdeploy 中跳过规则

> ID：12675715
> 
> 赞同：6
> 
> 时间：2012-10-01T14:53:56.157
> 
> 标签：msdeploy, web-deployment, webdeploy

我将几个跳过参数传递给 msdeploy 以便不同步（删除和更新）某些目录和文件

```
 -skip:skipAction='Update',objectName='filePath',absolutePath='.*\\documents\\.*' 
```

它似乎不起作用，一些目录和文件被删除。我很确定给 absolutePath 的正则表达式没有问题

谁能澄清一下跳过规则的匹配是如何工作的？根据正则表达式和 objectName，它显然无法正常工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-02T11:14:16.037

看这里：

[http://forums.iis.net/p/1192163/2031814.aspx#2031813](http://forums.iis.net/p/1192163/2031814.aspx#2031813)

> 应用跳过规则的方式基于对实际对象（目录或文件）执行的同步操作（删除、更新、添加）的顺序。
> 
> 例如，如果对目录进行了删除操作，则删除操作的目录中文件的跳过规则不会阻止文件被删除！
> 
> 在我的例子中，目录 MySite\MobileForms 被完全删除。我为文件设置的跳过规则没用。
> 
> 对于目录，我的错误在于正则表达式：
> 
> `-skip:skipAction='Delete',objectName='dirPath',absolutePath='.*\\MobileForms\\.*'`
> 
> 应该：
> 
> `-skip:skipAction='Delete',objectName='dirPath',absolutePath='.*\\MobileForms$'`
> 
> 这表示它应该跳过删除目录路径 MobileForms（第一条规则错误地在正则表达式中包含斜杠）。

希望这对其他人也有帮助。

# django - TDD Django 测试似乎跳过了视图代码的某些部分

> ID：12675719
> 
> 赞同：3
> 
> 时间：2012-10-01T14:54:12.910
> 
> 标签：django, tdd

我正在为使用 django TDD 的站点编写一些测试。

问题是当我手动转到测试服务器时。填写表格并提交，然后它似乎工作正常。但是当我使用 manage.py test wiki 运行测试时，它似乎跳过了视图中的部分代码。页面部分似乎都工作正常。但是代码中的 pagemod-parts 甚至我创建的 write() 只是为了看看发生了什么似乎被忽略了。

我不知道是什么原因造成的，似乎也找不到解决方案。有任何想法吗？

这是代码：

测试.py

```
#imports
class WikiSiteTest(LiveServerTestCase):
....
def test_wiki_links(self):
    '''Go to the site, and check a few links'''
    #creating a few objects which will be used later
    .....
    #some code to get to where I want:
    .....

    #testing the link to see if the tester can add pages
    link = self.browser.find_element_by_link_text('Add page (for testing only. delete this later)')
    link.click()

    #filling in the form
    template_field = self.browser.find_element_by_name('template')
    template_field.send_keys('homepage')
    slug_field = self.browser.find_element_by_name('slug')
    slug_field.send_keys('this-is-a-slug')
    title_field = self.browser.find_element_by_name('title')
    title_field.send_keys('this is a title')
    meta_field = self.browser.find_element_by_name('meta_description')
    meta_field.send_keys('this is a meta')
    content_field = self.browser.find_element_by_name('content')
    content_field.send_keys('this is content')

    #submitting the filled form so that it can be processed
    s_button = self.browser.find_element_by_css_selector("input[value='Submit']")
    s_button.click() 
    # now the view is called 
```

和一个观点：

视图.py

```
def page_add(request):
'''This function does one of these 3 things:
    - Prepares an empty form
    - Checks the formdata it got. If its ok then it will save it and create and save
      a copy in the form of a Pagemodification.
    - Checks the formdata it got. If its not ok then it will redirect the user back'''
.....

if request.method == 'POST':
    form = PageForm(request.POST)
    if form.is_valid():
        user = request.user.get_profile()
        page = form.save(commit=False)
        page.partner = user.partner
        page.save() #works

        #Gets ignored
        pagemod = PageModification() 
        pagemod.template = page.template
        pagemod.parent = page.parent 
        pagemod.page = Page.objects.get(slug=page.slug)
        pagemod.title = page.title
        pagemod.meta_description = page.meta_description
        pagemod.content = page.content
        pagemod.author = request.user.get_profile()
        pagemod.save()
        f = open("/location/log.txt", "w", True)
        f.write('are you reaching this line?')
        f.close()
        #/gets ignored

        #a render to response 
```

然后我做：

测试.py

```
print '###############Data check##################'
print Page.objects.all()
print PageModification.objects.all()
print '###############End data check##############' 
```

并得到：

终端：

```
###############Data check##################
[<Page: this is a title 2012-10-01 14:39:21.739966+00:00>]
[]
###############End data check############## 
```

所有的进口都很好。将 page.save() 放在忽略的代码之后没有任何区别。这只发生在通过 TDD 测试运行它时。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T13:59:00.073

多么奇怪。会不会是这个观点在`Pagemodification`舞台上出现了某种错误？你有没有在你的测试中得到任何检查，断言来自视图的响应是正确的，即没有返回 500 错误？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-19T09:26:26.493

现在这是很久以前的事了。

解决了，但解决方案有点尴尬。基本上，是我愚蠢。我不记得确切的细节，但我相信调用了不同的视图，而不是我在这里展示的视图。除了“跳过”部分之外，该视图具有相同的代码。

我向任何花时间调查此事的人道歉。

# android - 定时器任务仅在手机唤醒时有效

> ID：12675721
> 
> 赞同：1
> 
> 时间：2012-10-01T14:54:17.933
> 
> 标签：android

我有一个活动，从警报广播接收器调用，它每 N 秒播放一次通知声音。这是通过以下代码实现的：

```
repeating_notification_sound_timer.schedule(ring_the_buzzer_task, 0, 1000 * N); 
```

在活动的 onCreate 函数的早期，我有以下代码：

```
pm = (PowerManager) getApplicationContext().getSystemService(Context.POWER_SERVICE);
wakeLock = pm.newWakeLock((PowerManager.SCREEN_BRIGHT_WAKE_LOCK | PowerManager.FULL_WAKE_LOCK | PowerManager.ACQUIRE_CAUSES_WAKEUP), "TAG");
            wakeLock.acquire(); 
```

只要手机在触发警报时处于唤醒状态，这一切都运行良好。但是，如果手机处于睡眠状态，则通知声音只会播放一次，并且不会再播放一次。该程序不会崩溃或报告任何错误。好像 repeating_notification_sound_timer 只能工作一次！有任何想法吗？

**编辑：**这是首先设置警报的代码：

```
static void set_alarm(long alarm_time_in_millis,Context cont,AlarmManager alarm_manager,String str)
{
    Intent launchIntent = new Intent(cont, to_call_when_alarm_goes_off.class);

    launchIntent.putExtra("string_passed_in_bundle", str);

    launchIntent.setAction(to_call_when_alarm_goes_off.CUSTOM_INTENT);

    PendingIntent pIntent = PendingIntent.getBroadcast(cont,0, launchIntent, 0);
    alarm_manager.cancel(pIntent);

    alarm_manager.set(AlarmManager.RTC_WAKEUP,alarm_time_in_millis, pIntent);
} 
```

**编辑：**在清单中我有：

```
<uses-permission android:name="android.permission.WAKE_LOCK" />
<uses-permission android:name="android.permission.DISABLE_KEYGUARD" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:12:29.470

您需要将 AlarmManager 警报设置为唤醒验证，否则广播将等待触发，直到您的手机被其他东西唤醒。

以太[RTC_WAKEUP](http://developer.android.com/reference/android/app/AlarmManager.html#RTC_WAKEUP)

或[ELAPSED_REALTIME_WAKEUP](http://developer.android.com/reference/android/app/AlarmManager.html#ELAPSED_REALTIME_WAKEUP)

具体请提供您的报警代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:56:37.520

如果您想要在很长一段时间内或当应用程序处于后台时跟踪时间，您确实需要使用服务。

# c++ - ANDing和比较时的符号转换

> ID：12675722
> 
> 赞同：1
> 
> 时间：2012-10-01T14:54:23.110
> 
> 标签：c++, gcc, casting, unsigned-char

我有以下代码：

```
const uint8_t HEADER_SIZE = 0x08;
std::vector<uint8_t> a, b;
uint8_t x;

/* populate 'a', 'b'. Set 'x' */

for ( uint8_t i = 0; i < HEADER_SIZE; ++i )
{
    // The if statement (specifically the AND): Conversion to 'unsigned int' from 'int' may change the sign of the result [-Wsign-conversion]
    if ( x != ( a[i + HEADER_SIZE] & b[i] ) )
    {
         /* ... */
         break;
    }
} 
```

我尝试了几乎所有内容，但我似乎无法弄清楚为什么一个简单的 AND 会导致此警告。两个变量都是无符号的。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:02:56.330

两者`a[i + HEADER_SIZE]`和`b[i]`都将被提升为`int`as，尽管它们都是无符号类型，但它们是比 更窄的类型`int`。所有较窄的整数类型都被提升为`int`（如果`int`可以表示被提升的类型的所有值）或`unsigned int`所有内置的算术运算。

将所有操作数显式转换为`unsigned int`应使警告静音：

```
unsigned int a_dash = a[i + HEADER_+SIZE];
unsigned int b_dash = b[i];
unsigned int x_dash = x;
if (x_dash != (a_dash & b_dash))
{ // ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:02:13.067

你的 '在被一起编辑之前`uint8_t`得到提升。然后就是被比较，仍然是。同样的事情发生在. 将结果转换回应该消除警告。`int``&``int``x``uint8_t``i + HEADER_SIZE``uint8_t`

```
x != uint8_t(a[uint8_t(i + HEADER_SIZE)] & b[i]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T14:59:55.277

问题在于索引，请尝试：

```
_a = a[i + HEADER_SIZE];
_b = b[i];
if ( x != (_a & _b) ) 
```

您会看到问题出在 _a = ... 行上。这是因为 i 和 HEADER_SIZE 的添加导致了从 uint8_t 到 int 的提升。

# postgresql - 更改数据的时区值

> ID：12675723
> 
> 赞同：9
> 
> 时间：2012-10-01T14:54:25.427
> 
> 标签：postgresql, datetime, timezone, timestamp, bulk-load

我必须导入**没有时区信息**的数据（但是，我知道我要导入的数据的具体时区），但我需要`timestamp with time zone`数据库中的格式。一旦我导入它并将时间戳数据类型设置为`timestamp with time zone`，Postgres 将自动假定表中的数据来自我的时区并将我的时区分配给它。不幸的是，我要导入的数据不是来自我的时间范围，所以这不起作用。

该数据库还包含具有不同时区的数据。但是，一个表中的时区始终是相同的。

现在，我可以在导入数据（使用命令）之前将数据库的时区设置为我要导入的数据`SET time zone`的时区，并在导入完成后将其更改回我的时区，我很确定已经存储的数据不受数据库时区变化的影响。但这似乎是一种非常肮脏的方法，以后可能会导致问题。

我想知道是否有一种更优雅的方式来指定导入的时区，而数据本身没有时区数据？

另外，我还没有找到在导入后编辑时区信息的方法。有没有办法不转换，而只是编辑整个表的时区，假设整个表具有相同的时区偏移量（即，如果在数据输入/导入时分配了错误的时区）？

编辑：
我设法在导入时指定了一个时区，整个命令是：

```
set session time zone 'UTC';
COPY tbl FROM 'c:\Users\Public\Downloads\test.csv' DELIMITERS ',' CSV;
set session time zone 'CET'; 
```

然后使用会话时区导入数据。我认为这对同时来自其他连接的数据库上的任何其他查询没有影响？

编辑 2：
我后来发现了如何更改表的时区：
[PostgreSQL update time zone offset](https://stackoverflow.com/questions/6492657/postgresql-update-time-zone-offset?rq=1)

我想在导入后更改表的时区然后使用 session 临时更改本地时区会更优雅。当然，假设整个表具有相同的时区。

所以现在的代码应该是这样的：

```
COPY tbl FROM 'c:\Users\Public\Downloads\test.csv' DELIMITERS ',' CSV;
UPDATE tbl SET <tstz_field> = <tstz_field> AT TIME ZONE '<correct_time_zone>'; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-01T18:47:33.060

为导入会话设置时区比稍后更新值要高效得多**。**

我的印象是，您将时区视为适用于表格中其他未更改值的设置。但它根本不是那样的。将其视为输入/输出修饰符。实际`timestamp`值（带或不带时区）*始终*在内部存储为 UTC 时间戳（自 以来的秒数`'2000-01-01 00:00'`）。更多细节：

*   [在 Rails 和 PostgreSQL 中完全忽略时区](https://stackoverflow.com/questions/9571392/ignoring-timezones-altogether-in-rails-and-postgresql/9576170#9576170)

在`UPDATE`您的第二个示例中，表的大小加倍，因为每一行都无效并添加了一个新版本（这就是Postgres中[MVCC](https://www.postgresql.org/docs/current/interactive/mvcc.html)`UPDATE`的工作方式）。除了昂贵的操作之外，以后还必须做更多的工作来清理表膨胀。非常低效。`VACUUM`

会话的本地时区是**完全安全**的。`SET`这不会以任何方式影响并发操作。顺便说一句，`SET SESSION`与普通相同，`SET`因为`SESSION`无论如何都是默认值。

如果您想*绝对*确定，可以使用 将设置限制为当前**事务**`SET LOCAL`。[我在这里](https://www.postgresql.org/docs/current/interactive/sql-set.html)引用手册

> 持续到当前事务结束的效果`SET LOCAL`，无论是否已提交。在单个事务中`SET`遵循一种特殊情况：该值将在事务结束之前看到，但之后（如果事务已提交）该值将生效。`SET LOCAL``SET LOCAL``SET`

放在一起：

```
BEGIN;
SET LOCAL timezone = 'UTC';
COPY tabledata FROM 'c:\Users\Public\Downloads\test.csv' DELIMITERS ',' CSV;
COMMIT; 
```

查看：

```
SHOW timezone; 
```

# cocoa - 更改框架时 NSTextField 滞后

> ID：12675734
> 
> 赞同：0
> 
> 时间：2012-10-01T14:55:15.990
> 
> 标签：cocoa

我正在为 osx 构建我的第一个应用程序，当我尝试更改 NSTextField 的框架时遇到了麻烦。

我正在尝试更改动画中文本字段的框架（接近 60 fps），并且当我的窗口非常小并且文本字段为空时它可以工作。但是当我在文本字段中输入大量文本或只是让它变得更大时，动画会严重滞后。当我调整包含文本字段的窗口大小时，也可以看到这一点。

在 TextEdit 应用程序中调整窗口大小的工作速度接近 60 fps，因此我需要一些帮助来实现类似的性能。

目前我在动画的每一帧上都做了类似下面的事情。

```
NSRect rect = NSMakeRect(0, 0, width, height);
self.textField.frame = rect; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T21:29:41.350

好的，所以我得到了一些使用 NSTextView 而不是 NSTextField 的建议，它解决了我的大部分问题。

# silverlight - 如何在 C# 中创建 RichTextBox 并测量其大小？

> ID：12675737
> 
> 赞同：0
> 
> 时间：2012-10-01T14:55:28.743
> 
> 标签：silverlight, windows-phone-7

我想创建多个`RichTextBox`来处理`UIElement`Windows Phone 上 2048px 的最大尺寸限制。我知道有一个[可滚动的文本块](http://blogs.msdn.com/b/priozersk/archive/2010/09/08/creating-scrollable-textblock-for-wp7.aspx)解决方案。

这是我的测试代码：

```
RichTextBox rtb = new RichTextBox();
rtb.TextWrapping = TextWrapping.Wrap;
rtb.FontSize = (Application.Current.Resources["PhoneFontSizeMedium"] as double?).Value;
rtb.FontFamily = Application.Current.Resources["PhoneFontFamilyNormal"] as FontFamily;
rtb.Width = this.Width;
Run run = new Run();
run.Text = "Hello World.Hello World.Hello World.Hello World.Hello World.";
Paragraph para = new Paragraph();
para.Inlines.Add(run);
rtb.Blocks.Add(para);
double rtbh = rtb.ActualHeight;
BodyPanel.Children.Add(rtb); 
```

`BodyPanel`是 a `StackPanel`，应用程序运行良好，但是，该`ActualHeight`属性在调试窗口中始终返回 0。

如果我`RichTextBox`在 XAML 中定义 a 并在 C# 中设置它的内容，它的大小属性都是正常的。

那么如何在纯 C# 中创建 RichTextBox 并获得其大小测量值？

顺便说一句，我找不到任何关于 2048px 限制的官方文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T14:28:23.303

ActualHeight 属性返回 0，因为 RichTextBox 未在 UI 中呈现。您正在尝试测量尚未添加到 UI 中的元素，因此其高度为 0。一旦将其添加到 UI 中并进行渲染，您将获得正确的 ActualHeight。

你可以试试这段代码：

```
 RichTextBox rtb = new RichTextBox();
            rtb.TextWrapping = TextWrapping.Wrap;
            rtb.FontSize = 12;
            rtb.FontFamily = new FontFamily("Arial");
            rtb.Width = this.Width;
            Run run = new Run();
            run.Text = "Hello World.Hello World.Hello World.Hello World.Hello World.";
            Paragraph para = new Paragraph();
            para.Inlines.Add(run);
            rtb.Blocks.Add(para);

            BodyPanel.Children.Add(rtb);
            Dispatcher.BeginInvoke(() =>
                {
                    double rtbh = rtb.ActualHeight;
                }); 
```

# mongodb - mongodb：使用 $lte 和 $gte 的问题

> ID：12675738
> 
> 赞同：0
> 
> 时间：2012-10-01T14:55:30.360
> 
> 标签：mongodb, pymongo

看看这个奇怪的结果：

```
list(db.users.find({"produit_up.spec.prix":{"$gte":0, "$lte": 1000}}, {"_id":0,"produit_up":1})) 
Out[5]: 
[{u'produit_up': [{u'avatar': {u'avctype': u'image/jpeg', 
 u'orientation': u'portrait', 
 u'photo': ObjectId('506867863a5f3a0ea84dcd6c')}, 
u'spec': {u'abus': 0, 
 u'date': u'2012-09-30', 
 u'description': u"portable tr\xe8s solide, peu servi, avec batterie d'une autonomie de 3 heures.", 
 u'id': u'alucaard134901952647', 
 u'namep': u'nokia 3310', 
 u'nombre': 1, 
 u'prix': 1000, 
 u'tags': [u'portable', u'nokia', u'3310'], 
 u'vendu': False}}, 
{u'avatar': {u'avctype': u'image/jpeg', 
 u'orientation': u'portrait', 
 u'photo': ObjectId('50686d013a5f3a04a8923b3e')}, 
 u'spec': {u'abus': 0, 
 u'date': u'2012-09-30', 
 u'description': u'\u0646\u0628\u064a\u0639 \u0623\u064a \u0641\u0648\u0646 \u062c\u062f\u064a\u062f \u0641\u064a  \u0627\u0644\u0628\u0648\u0627\u0637 \u0645\u0639\u0627\u0647 \u0634\u0627\u0631\u062c\u0648\u0631 \u062f\u0648\u0631\u064a\u062c \u064a\u0646', 
 u'id': u'alucaard134902092967', 
 u'namep': u'iphone 3gs', 
 u'nombre': 1, 
 u'prix': 20000, 
 u'tags': [u'iphone', u'3gs', u'apple'], 
 u'vendu': False}}, 
{u'avatar': {u'avctype': u'image/jpeg', 
 u'orientation': u'paysage', 
 u'photo': ObjectId('50686d3e3a5f3a04a8923b40')}, 
u'spec': {u'abus': 0, 
 u'date': u'2012-09-30', 
 u'description': u'vends 206 toutes options 2006 hdi.', 
 u'id': u'alucaard134902099082', 
 u'namep': u'peugeot 206', 
 u'nombre': 1, 
 u'prix': 500000, 
 u'tags': [u'voiture', u'206', u'hdi'], 
 u'vendu': False}}]}] 

list(db.users.find({"produit_up.spec.prix":{"$gte":0, "$lte": 100}}, {"_id":0,"produit_up":1})) 

Out[6]: [] 

pymongo.version 

Out[8]: '2.3+' 
```

它在 Mongo Shell 中给了我相同的结果：

```
db.version() 
2.2.0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:33:42.420

这是伯尼哈克特的答案

> “produit_up.spec.prix”有三个值，1000、20000、500000。为什么您认为 {"$gte":0, "$lte": 100} 会匹配这些值中的任何一个？100 小于所有这些值。{"$gte":0, "$lte": 1000} 返回所有三个文档的原因是它们都是数组中的子文档。由于数组中的一个子文档匹配**，因此整个封闭文档** 与您的查询匹配。由于您仅对“produit_up”进行了投影，因此仅返回该数组（包括所有数组成员）。在 MongoDB 2.2 中使用 $elemMatch 仅返回完全匹配的数组元素。MongoDB 和 PyMongo 正在按照这里的设计工作。
> 
> 要获得我认为您要求的行为，请查看 $elemMatch 运算符： [http ://docs.mongodb.org/manual/reference/projection/elemMatch/](http://docs.mongodb.org/manual/reference/projection/elemMatch/)

# c++ - 如何使用 wxWidgets 构建中文 GUI？

> ID：12675740
> 
> 赞同：-3
> 
> 时间：2012-10-01T14:55:30.530
> 
> 标签：c++, user-interface, wxwidgets

我想知道如何使用 wxWidgets 构建简体中文 GUI？谁能指出我可以研究的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:23:01.447

你的意思是这样的？

![在此处输入图像描述](../Images/5e4c117f5e97c43085b228f95bc3532b.png)

对于这种工作，我使用 Poedit ( [http://www.poedit.net/](http://www.poedit.net/) )

Poedit 是跨平台的 gettext 目录（.po 文件）编辑器。它是用 wxWidgets 工具包构建的，可以在它支持的任何平台上运行（尽管它只在带有 GTK+ 和 Windows 的 Unix 上进行了测试）。它旨在提供比启动 vi 和手动编辑文件更方便的方法来编辑目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T22:42:12.240

有一个关于在 wxWidgets 应用程序中启用多语言支持的[教程。](http://wxwidgets.info/wxtranslation/)和[视频](http://wxwidgets.info/localization_video/)。

# android - 发送 POST 数据 Android

> ID：12675741
> 
> 赞同：0
> 
> 时间：2012-10-01T14:55:37.560
> 
> 标签：android, post

我正试图在我的应用程序中利用该网站[http://www.rossnet.pl/Start.aspx](http://www.rossnet.pl/Start.aspx)的时事通讯唱歌。我正在尝试在我的 Android 应用程序中发送 POST 数据，一切看起来都很好，但电子邮件仍然不在时事通讯列表中。我的代码：

```
 public class MainActivity extends Activity {

private Button b;
private int TIMEOUT_MS = 10000;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    b = (Button) findViewById(R.id.button1);
    b.setOnClickListener(new View.OnClickListener() {

        public void onClick(View arg0) {
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
            nameValuePairs.add(new BasicNameValuePair(
                    "dnn_ctr1741_ViewNewsletterSubscribe_tb_hidden",
                    "k.o.p.t.u.s@gmail.com"));
            nameValuePairs
                    .add(new BasicNameValuePair(
                            "__EVENTVALIDATION",
                            "/wEWCwLbrPQDApzVwckKApul3dEEArGyrMYCAq6r4NoEAujm+N8IApWbjNwEAsHhzqkPAqD4jIQPAv7k8bICAtH1idgOYOyKdndX8LHZqHjXpX5IdUMCNvc="));

            nameValuePairs.add(new BasicNameValuePair("__EVENTTARGET",
                    "dnn$ctr1741$ViewNewsletterSubscribe$lbtn_subscribe"));

            nameValuePairs.add(new BasicNameValuePair("dnn$ctr1741$ViewNewsletterSubscribe$tb_hidden",
                    "k.o.p.t.u.s@gmail.com"));
            nameValuePairs.add(new BasicNameValuePair("ScriptManager_TSM",
                    ";;System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35:en:111e8464-2436-44db-9b34-0d84ed5253c8:ea597d4b:b25378d2"));

            HttpClient client = new DefaultHttpClient();
            HttpConnectionParams.setConnectionTimeout(
                    client.getParams(), TIMEOUT_MS);
            HttpConnectionParams.setSoTimeout(client.getParams(),
                    TIMEOUT_MS);
            HttpPost post = new HttpPost("http://www.rossnet.pl/Start.aspx");
            try {
                post.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                Log.d("debug", "lala1");
            } catch (UnsupportedEncodingException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            } // with list of key-value pairs
            try {
                Log.d("debug", "test1");
                client.execute(post, new ResponseHandler(){

                    public Object handleResponse(HttpResponse response)
                            throws ClientProtocolException, IOException {
                        Log.d("debug", "test2");
                        return null;
                    }});
            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            Log.d("debug", "test3");
        }
    });
} 
```

}

# android - 带有动态文本的右对齐按钮

> ID：12675743
> 
> 赞同：1
> 
> 时间：2012-10-01T14:55:45.537
> 
> 标签：android, android-layout

在我的用户界面中，我有一个带有 RelativeLayout 的片段。在这个 RelativeLayout 的底部，我有两个按钮：一个应该在左边，另一个在右边，它们之间有空白。左边有静态文本（但因为应用程序会被翻译，我不知道它会是什么宽度）。右边的文字可以任意改变。

由于我已经有一个 RelativeLayout，我开始尝试将它们布置在 RelativeLayout 中，如下所示：

```
<Button
    android:id="@+id/button_left"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:text="@string/left" />

<Button
    android:id="@+id/button_right"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentRight="true"
    android:text="@string/right" /> 
```

但这有一个问题，如果右侧按钮中的文本太长，它会与左侧按钮重叠。

接下来我尝试通过添加来限制右侧按钮的左侧边缘`android:layout_toRightOf="@+id/button_left"`，但是这样，右侧按钮将始终填充可用宽度。当右侧按钮中的文本很短时，我希望它缩小以在它和左侧按钮之间留出间隙。

接下来我尝试使用 LinearLayout，所以我可以在按钮上设置 layout_gravity，如下所示：

```
<LinearLayout
    android:id="@+id/buttons"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true" >

    <Button
        android:id="@+id/button_left"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/left" />

    <Button
        android:id="@+id/button_right"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="right"
        android:drawableLeft="@drawable/pass"
        android:text="@string/right" />

</LinearLayout> 
```

仍然没有喜悦。我希望这可以工作，但右侧按钮仅停留在左侧按钮的右侧，而不是粘在屏幕的右边缘。我可以在布局编辑器中看到 LinearLayout 正确地填充了屏幕的宽度，但按钮顽固地停留在它的朋友旁边。

我也尝试添加`android:layout_weight="1"`到右侧按钮，但同样，它总是扩展以填充可用空间。

接下来，我尝试在按钮之间添加一个空视图，以展开并强制向右按钮向右，如下所示：

```
<LinearLayout
    android:id="@+id/buttons"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true" >

    <Button
        android:id="@+id/button_right"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/left" />

    <View
        android:layout_width="0dp"
        android:layout_height="0dp"
        android:layout_weight="1" />

    <Button
        android:id="@+id/button_left"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="right"
        android:text="@string/right" />

</LinearLayout> 
```

当文本很短时，这很好用，就像我原来的 RelativeLayout 一样，但是现在当右侧按钮上的文本很长时，它的宽度受屏幕宽度的限制，而不是可用空间，所以它延伸了屏幕的右侧边缘。同样，我可以在布局编辑器中看到 LinearLayout 具有正确的宽度，但是按钮正在向我们的父级边界扩展。即使按钮有 ，也会发生这种情况`android:layout_width="match_parent"`。奇怪的是，增加右侧按钮上的 layout_gravity 会使其更小，直到它适合可用空间，但当然这也会在文本较小时填充空间。

我不敢相信要做到这一点这么难。我已经在 SO 上看到了六个类似的问题，但它们都有简单的解决方法。如果按钮文本是固定的，您可以手动将边距设置为固定宽度。如果展开的小部件是 TextView 而不是 Button，您可以让它展开并用于`android:gravity`移动小部件内的文本，但您不能使用按钮执行此操作，因为背景和边框在屏幕上可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:20:12.370

事实证明，添加 LinearLayout 是错误的方法。使用`android:layout_toRightOf="@+id/button_left" android:layout_alignParentRight="true"`TextView 可以正常工作，因为它可以在不改变外观的情况下吸收可用空间。而不是试图改变布局，我只需要使用可以扩展的东西来填充可用空间并包含按钮：一个 FrameLayout。这是工作代码，它仍然在我的根 RelativeLayout 中：

```
<Button
    android:id="@+id/button_left"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:text="@string/left" />

<FrameLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentRight="true"
    android:layout_toRightOf="@+id/button_left" >

    <Button
        android:id="@+id/Turn_button_pass"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="right"
        android:text="@string/right" />

</FrameLayout> 
```

现在，FrameLayout 总是占据左侧按钮右侧的所有空间，并使用`android:layout_gravity="right"`.

这个答案只增加了一个额外的布局，但如果有人有办法只使用现有的 RelativeLayout 来最小化布局中的 ViewGroups 的数量，我会接受它作为解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:09:22.310

您可以只使用 TextView 并使其看起来像一个按钮。创建一个虚拟按钮，提取背景并以编程方式将该背景设置为文本字段。（未经测试，但应该给它一个按钮的外观）

```
Drawable d = button1.getBackground();
textView1.setBackground(d); 
```

然后你只需设置 onClickListener ，这应该会产生你正在寻找的东西。TextView 将取代您的第一个布局中的“button_right”。

**编辑

你的 xml 看起来像这样

```
<Button
 android:id="@+id/button_left"
android:layout_width="wrap_content" 
android:layout_height="wrap_content"
 android:layout_alignParentBottom="true"
 android:layout_alignParentLeft="true"
android:text="@string/left" /> 

<TextView
    android:id="@+id/button_right"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"     
    android:layout_alignParentRight="true" 
    android:maxEms="10"
    android:text="TextView" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T15:21:21.173

如果您可以忍受约束，即右侧按钮最多只能占用一半的可用空间，那么这可能是您的解决方案：

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true" >

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_weight="1" >

        <Button
            android:id="@+id/button1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="A short text" />
    </RelativeLayout>

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1" >

        <Button
            android:id="@+id/button2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:text="A very long text which is limited to one half of the available space" />

    </RelativeLayout>
</LinearLayout> 
```

# java - 将外部文件夹挂载为 Wicket 中的资源

> ID：12675750
> 
> 赞同：4
> 
> 时间：2012-10-01T14:56:19.377
> 
> 标签：java, wicket

我想要完成的是将 css 文件中的一些图像引用放置在与实际应用程序分开的文件夹中。

是否可以将外部文件夹挂载为 Wicket 中的资源？

在伪代码中，这就是我想要做的：

```
public class Application extends WicketApplication
{
    init()
    {
        mountResource(new FolderResource("Path/to/some/folder", "someid"));
    }
} 
```

这样 .css 类将引用如下资源：

```
.someclass
{
    url("resources/someid/images/image.png")
} 
```

我确定我在某个地方看到过这个，但我似乎无法再次找到它......

**编辑** 还应该注意我目前在 Wicket 1.4 上运行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T17:02:12.783

如下所示。

**我的应用程序.java：**

```
public class MyApplication extends WebApplication {
    ...
    public void init() {
        ...
        final String resourceId = "images";
        getSharedResources().add(resourceId, new FolderResource(new File(getServletContext().getRealPath("img"))));    
        mountSharedResource("/image", Application.class.getName() + "/" + resourceId);
    }        
    ...
} 
```

**文件夹资源.java：**

```
public class FolderResource extends WebResource {

    private File folder;

    public FolderResource(File folder) {
        this.folder = folder;
    }

    @Override
    public IResourceStream getResourceStream() {
        String fileName = getParameters().getString("file");
        File file = new File(folder, fileName);
        return new FileResourceStream(file);
    }
} 
```

然后您可以通过简单的 URL 从应用程序内的“img”文件夹中获取任何图像：

```
/your-application/app/image?file=any-image.png 
```

这里“/your-application”是应用程序上下文路径，“/app”是web.xml中的Wicket servlet映射，“any-image.png”是图像文件的名称。

# xml - Web服务模式验证不起作用

> ID：12675754
> 
> 赞同：0
> 
> 时间：2012-10-01T14:56:35.070
> 
> 标签：xml, web-services

我正在尝试进行 xml 验证，但在进行 xml 验证时出现以下错误。

你能帮我吗，为什么我在验证时遇到错误

. 收到此错误“cvc-complex-type.2.4.a：发现以元素 'ObjectId' 开头的无效内容。应为“{LanguageCode}”之一。”

```
schema:
-------
<xs:complexType name="Paragraph">
        <xs:sequence>
            <xs:element name="ParagraphId" type="tns:ParagraphId" maxOccurs="unbounded" />
            <xs:element minOccurs="0" name="Name" type="string"/>
            <xs:element minOccurs="0" name="Description" type="string"/>
            <xs:element minOccurs="0" name="SectionNumber" type="string"/>
            <xs:element minOccurs="0" name="Editable" type="xs:boolean"/> <!-- If Y then This Paragraph is editable. -->
            <xs:element minOccurs="0" name="ParagraphText" type="ref:swaRef"/>
            <xs:element maxOccurs="1" minOccurs="0" name="Status" nillable="true" type="tns:StatusType"/>
            <!-- retrieveParagraph() : List of variables of this paragraph and the following are retrieved based on this “ReturnVariable” flag. -->
            <xs:element maxOccurs="unbounded" minOccurs="0" name="Variables" nillable="false" type="tns:Variable"/>
            <xs:element minOccurs="0" name="OldParagraphId" type="tns:ParagraphId"  maxOccurs="unbounded" /> <!-- It will be used to get effective time stamp of existing paragraph on which we are creating Modification -->
            <xs:element minOccurs="0" name="Action" type="xs:string"/>
            <xs:element minOccurs="0" name="LockedBy" type="string"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="ParagraphId">
        <xs:sequence>
            <xs:element name="CountryCode" type="tns:CountryCodeType" />
            <xs:element default="00" name="SubsidiaryCode" type="tns:SubsidiaryCodeType" />
            <xs:element name="LanguageCode" type="string" />
            <xs:element name="ObjectId" type="string" />
            <xs:element name="TextVersionId" type="string" />
        </xs:sequence>
    </xs:complexType> 

xml:
---
<Paragraphs>
                <ParagraphId>
                    <CountryCode>111</CountryCode>
                    <SubsidiaryCode>01</SubsidiaryCode>
                    <LanguageCode>AAA</LanguageCode>
                    <ObjectId>MMMM</ObjectId>
                    <TextVersionId>1</TextVersionId>
                </ParagraphId>
                <Description>Title</Description>
                <SectionNumber>2</SectionNumber>
                <ParagraphText>cid:urn:uuid:FCA0989FBA745C0A771349097015870@apache.org</ParagraphText>
                <Status>Draft</Status>
                <OldParagraphId>
                    <CountryCode>111</CountryCode>
                    <SubsidiaryCode>01</SubsidiaryCode>
                    <ObjectId>1111</ObjectId>
                    <LanguageCode>ENU</LanguageCode>
                    <TextVersionId>1</TextVersionId>
                </OldParagraphId> 
            </Paragraphs> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T16:37:03.097

您的架构说 OldParagraphId 在 ObjectId 之前必须有一个 LanguageCode，但在您的实例中，它们以相反的顺序出现。您需要更改架构或实例。

# c# - 使用 linq 对结果进行分组

> ID：12675758
> 
> 赞同：1
> 
> 时间：2012-10-01T14:56:41.700
> 
> 标签：c#, linq, left-join, linq-group

我有一些问题，不知道该怎么办，有人可以帮我吗？我有一张这样的桌子：

```
ID   Name   Produkt    Comment   aa    bb
1    Mike   AA         YY        x
1    Mike   AA         YY              x 
```

我想与 linq 分组，结果就像有 Mike 但就在一行中

```
1   Mike   AA          YY        x     x 
```

我的代码：

```
var results = from t1 in table.AsEnumerable()
                      join tb2 in table2.AsEnumerable()
                      on t1.Field<string>("Name") equals tb2.Field<string>("Name") into prodGroup
                      from table4 in prodGroup.DefaultIfEmpty()

                      select new
                      {
                          ID = t1.Field<Int32?>("ID"),
                          Name = t1.Field<String>("Name"),
                          Produkt = t1.Field<String>("Produkt"),
                          Attribute = t1.Field<String>("Attribute"),
                          Comment = table4 != null ? table4.Field<String>("Comment") : null,

                      };
foreach (var r in results)
{
    var productIndex = result.Columns.IndexOf(r.Attribute);
    var vals = new List<object>() { r.ID, r.Name, r.Produkt, r.Comment };
    for (int i = 4; i < result.Columns.Count; i++)
    {
        if (i == productIndex)
        {
            vals.Add(true);

        }
        else
        {
            vals.Add(false);
        }
    }
    result.LoadDataRow(vals.ToArray(), true);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T09:54:35.763

尝试这个：

```
var result = from t1 in table.AsEnumerable()
                group t1 by t1.Name into t1group
                select new
                {
                    Name = t1group.FirstOrDefault().Name
                    ,ID = t1group.FirstOrDefault().ID
                    ,Product = t1group.FirstOrDefault().Product
                    ,Comment = t1group.FirstOrDefault().Comment
                    ,aa = (t1group.Select(x => x.aa??"" + x.bb??"")).Aggregate((a, b) => (a + ", " + b))
                }; 
```

# php - 如何在 php 中使用 mysqldump 命令？

> ID：12675759
> 
> 赞同：2
> 
> 时间：2012-10-01T14:56:48.800
> 
> 标签：php, mysql

我想备份我的数据库。所以我使用了这个命令

`$command = "mysqldump --user=root asset_management > D:\assetmanagement\public\backup\backup.sql"; system($command);`

但这会产生一个空的sql文件..有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-21T07:08:53.727

**`$command = "mysqldump --user=root -pass=yourpassword asset_management > D:\assetmanagement\public\backup\backup.sql"; system($command);`**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T08:14:03.100

假设您的 mysqldump 位于 C:/wamp/bin/mysql/mysql5.1.33/bin/ 文件夹中

```
$mysqlPath="C:/wamp/bin/mysql/mysql5.1.33/bin/";
//There should be password for root user. Blank password will not work.

$command = $mysqlPath . "mysqldump.exe asset_management > D:\assetmanagement\public\backup\backup.sql --user=root --password=yourpassword "; 
```

# puppet - Puppet：将挂载点添加为 Windows 共享驱动器

> ID：12675760
> 
> 赞同：0
> 
> 时间：2012-10-01T14:56:50.943
> 
> 标签：puppet

如何在 fileserver.conf 中添加 Windows 共享驱动器？并将其用作文件的安装点。

猜猜这是否可以做到。我是否需要安装 samba 服务，然后使用 mount 命令挂载 windows 共享驱动器？

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:09:27.073

您需要 samba，但 puppet 可以确保安装 samba 和所有依赖项。所以你所需要
的只是适当的木偶清单。您可以在此处查看示例 puppet samba 模块。 [https://github.com/AllPlayers/puppet-samba](https://github.com/AllPlayers/puppet-samba)

查看 smb.conf.erb，您可以在其中定义所有 samba 挂载点。

# svn - svn 命令从 Maven 失败

> ID：12675763
> 
> 赞同：1
> 
> 时间：2012-10-01T14:57:00.613
> 
> 标签：svn, maven

我已经使用 Maven 导入了一个项目，该项目具有使用 STP-SCA 工具的模块。聚[甲醛](http://websvn.ow2.org/filedetails.php?repname=frascati&path=/trunk/org.eclipse.stp.sca.model/pom.xml)尝试通过 SVN 下载 STP-SCA 工具。

当我这样做时`mvn install`，`POM.xml`我在 cmd 上得到以下信息

```
[INFO]
[INFO] --- maven-scm-plugin:1.6:checkout (checkout) @ sca-model ---
[INFO] Removing C:\WorkSpace\FrascatiTrunk\org.eclipse.stp.sca.model\org.eclipse
.stp.sca\target\checkout
[INFO] Executing: cmd.exe /X /C "svn --non-interactive checkout svn://dev.eclips
e.org/svnroot/soa/org.eclipse.stp.sca-tools/org.eclipse.stp.sca/tags/3.5SR1/org.
eclipse.stp.sca C:\WorkSpace\FrascatiTrunk\org.eclipse.stp.sca.model\org.eclipse
.stp.sca\target\checkout"
[INFO] Working directory: C:\WorkSpace\FrascatiTrunk\org.eclipse.stp.sca.model\o
rg.eclipse.stp.sca\target
[ERROR] Provider message:
[ERROR] The svn command failed.
[ERROR] Command output:
[ERROR] "svn" no se reconoce como un comando interno o externo,
programa o archivo por lotes ejecutable.

[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.778s
[INFO] Finished at: Mon Oct 01 16:30:13 CEST 2012
[INFO] Final Memory: 7M/108M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-scm-plugin:1.6:che
ckout (checkout) on project sca-model: Command failed.The svn command failed. 
```

如果我在 Eclipse 上尝试 svn 目录，它就可以工作。

为什么 svn 命令从 Maven 失败？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:05:35.400

对你来说失败的命令是

`svn --non-interactive checkout svn://dev.eclipse.org/svnroot/soa/org.eclipse.stp.scatools/org.eclipse.stp.sca/tags/3.5SR1/org.eclipse.stp.sca C:\WorkSpace\FrascatiTrunk\org.eclipse.stp.sca.model\org.eclipse.stp.sca\target\checkout`

它失败了`"svn" no se reconoce como un comando interno o externo, programa o archivo por lotes ejecutable.`

现在我自己不会说那种语言，但我敢打赌它是说命令“svn”未被识别。

基本上，您需要做的是您需要安装和配置一个 SVN 客户端，以便您可以从命令行运行`svn`。

# lucene - Lucene SearchResult.Fields 集合缺少一些属性

> ID：12675765
> 
> 赞同：1
> 
> 时间：2012-10-01T14:57:11.547
> 
> 标签：lucene, umbraco

我也在[Our Umbraco 社区](http://our.umbraco.org/forum/developers/api-questions/35027-Lucene-SearchResultFields-collection-is-missing-some-properties)网站上问过以下问题，但到目前为止我还没有运气。

我有一项任务，我需要为媒体图像文件手动添加数据库记录，该文件将出现在我们客户的 Umbraco 站点中。

我的 SQL 包括：

*   在 umbracoNode 中为图像添加一条记录。
*   在 cmsContent 中添加记录
*   在 cmsContentXml 中添加记录
*   为图像的 umbracoFile、umbracoWidth、umbracoHeight、umbracoBytes、umbracoExtension 添加记录到 cmsPropertyData

执行上述操作并登录 Umbraco 后，我可以在 Media 区域看到图像，一切正常。

问题是当我想显示该图像时调用 @Model.MediaById() （在 Razor 文件中） - 由于未设置 img 'src' 属性，因此基本上没有显示图像。

我已经浏览了 Umbraco 代码并发现了问题。基本上，当代码使用 Lucene 搜索媒体 (ExaminedBackendMedia.GetUmbracoMedia()) 时，它确实找到了图像文件，但是 SearchResult 缺少许多字段。例如，添加到 cmsPropertyData 的“umbraco*”属性都不会出现在字段集合中。当我单步执行另一张图像的代码（手动添加的）时，我可以在字段集合中看到额外的 5 个左右的属性 - 包括所有“umbraco*”属性。

所以我可以看到我在这里缺少数据。基本上 SearchResult 对象缺少一些字段。有人可以建议我可能错过的吗？为什么 Lucene 没有选择我通过 SQL 脚本添加的“umbraco*”属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T14:30:10.383

您需要确保重新发布节点，这将从您创建的数据库条目中获取它们，并将它们放入 umbraco 在提供数据时实际使用的 XML 缓存中。

# ios - “非活动”视图不会更新背景颜色

> ID：12675767
> 
> 赞同：0
> 
> 时间：2012-10-01T14:57:18.173
> 
> 标签：ios, view, colors, background

我有这个奇怪的问题（或者我认为是这样）。我有两种看法。一个是“基本”视图，另一个是设置，我想将背景颜色更改为图案图像。这很好用，但是当我放置一些按钮让用户选择他们想要看到的颜色时。我当前的代码看起来像

```
 [[NSUserDefaults standardUserDefaults] setValue:@"Green" forKey:@"Theme"];
NSString *bgString = [NSString stringWithFormat:@"%@_bg.png", [[NSUserDefaults standardUserDefaults] objectForKey:@"Theme"]];
self.baseView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:bgString]];
self.settingsView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:bgString]]; 
```

出于某种原因，只有 settingsView 更新。SettingsView 在弹出框内，但我也在视图控制器中尝试过。当我退出并重新打开应用程序时，它会更新。我怎样才能让它立即更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:12:21.190

尝试`[[self settingsView] setNeedsDisplay]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:31:38.520

您是否正在使用任何后台线程或大量可能锁定 UI 的工作？尝试使用它来确保它在主线程上运行，看看情况如何。

```
dispatch_async(dispatch_get_main_queue(), ^{
                    //Your code here
                }); 
```

# database - 一对多关系中的Linq entityref分配

> ID：12675769
> 
> 赞同：1
> 
> 时间：2012-10-01T14:57:31.880
> 
> 标签：database, linq, windows-phone-7, database-design, windows-phone-7.1

我的 linq 数据库存在一对多关系的问题。以下是课程：

```
 private EntityRef<Account> _account;

    [Association(Storage = "_account", ThisKey = "IDMovement", OtherKey = "IDAccount", IsForeignKey = true)]
    public Account Account
    {
        get { return this._account.Entity; }
        set
        {
            Account previousValue = this._account.Entity;
            if (((previousValue != value) || (this._account.HasLoadedOrAssignedValue == false)))
            {
                NotifyPropertyChanging("Account");
                if ((previousValue != null))
                {
                    this._account.Entity = null;
                    previousValue.Movements.Remove(this);
                }
                this._account.Entity = value;
                if ((value != null))
                {
                    value.Movements.Add(this);
                }
                NotifyPropertyChanged("Account");
            }
        }
    } 
```

另一方面：

```
private EntitySet<Movement> _movements;

    [Association(Storage = "_movements", OtherKey = "IDMovement", ThisKey = "IDAccount")]
    public EntitySet<Movement> Movements
    {
        get { return this._movements; }
        set { this._movements.Assign(value); }
    }

    private void OnMovementAdded(Movement movement)
    {
        NotifyPropertyChanging("Movement");
        movement.Account = this;
        NotifyPropertyChanged("Movement");
    }

    private void OnMovementRemoved(Movement movement)
    {
        NotifyPropertyChanging("Movement");
        movement.Account = null;
        NotifyPropertyChanged("Movement");
    } 
```

我的问题是，当我必须在数据库中插入新动作时，我不知道如何为“EntityRef _account”变量分配数据库中已有的值。

例如：我必须为帐户“general”插入一个动作，这个帐户当然已经在我的数据库中......我怎么能对我的动作说它在“movement.Account”中的帐户“general”它与我的数据库中包含的完全相同吗？

我尝试了类似的方法，但它不起作用，因为就像我创建了一个新帐户一样：

```
Movement movement = new Movement();
            movement.Category = (from f in context.Categories
                         where f.Name == this.Categories.ElementAt(this.ChoosenCategory).Name
                         select f).FirstOrDefault();
            movement.Account = (from f in context.Accounts
                     where f.Name == ChoosenAccount.Name
                     select f).FirstOrDefault();

            context.Movements.InsertOnSubmit(movement);
            context.SubmitChanges(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:09:53.673

您需要为 EntityRef 调用[Load()](http://msdn.microsoft.com/en-us/library/bb896376.aspx)方法，例如`if (!order.CustomersReference.IsLoaded) order.CustomersReference.Load();`

# c - 类型转换输出

> ID：12675776
> 
> 赞同：2
> 
> 时间：2012-10-01T14:57:52.427
> 
> 标签：c, type-conversion

```
#include <stdio.h>

main()
{
    float x;
    x = (float)3.3==3.3;
    printf("%f",x);

    x=(float)3.5==3.5;
    printf("\n%f",x);
} 
```

我对第一种情况的答案是 0.000 和第二种情况的答案是 1.00 感到困惑，谁能解释一下？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T15:01:05.457

表达方式

```
(float)3.3==3.3 
```

首先将`double`值 3.3 转换为`float`精度，从而改变它的值，因为它在目标类型中不能完全表示。然后将该`float`值转换回`double`，而不更改用于比较的值`，导致比较返回 0 (false)。3.5 在两种类型中都可以精确表示，因此比较返回 true (1)。

然后在这两种情况下`int`，比较的结果都被转换`float`为赋值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:07:26.943

默认情况下，右侧数字被转换为双精度而不是浮点数。为了让这两种情况都打印 1，您需要将浮点类型转换更改为双精度或将第二个数字类型转换为浮点数：

```
float x;
x = (float)3.3==(float)3.3;
printf("%f",x);
x=(float)3.5==(float)3.5;
printf("\n%f",x); 
```

或者：

```
float x;
x = (double)3.3==3.3;
printf("%f",x);
x=(double)3.5==3.5;
printf("\n%f",x); 
```

# code-generation - 在 XTend 中调用另一个模板表达式

> ID：12675778
> 
> 赞同：2
> 
> 时间：2012-10-01T14:58:13.543
> 
> 标签：code-generation, xtend

我有一个关于从另一个模板表达式调用模板表达式方法的问题。

下面的例子不起作用，即。它不会在调用它的地方扩展和“打印”代码。如何修改此代码以`ResourceGenerator().generate(resource)`在调用它的地方打印结果？请注意，`ResourceGenerator().generate(resource)`它本身就是一个模板表达式。

```
class ServerGenerator extends RESTServiceGenerator {
       def generate(Server it) '''
          package nl.sytematic.projects.RESTServiceServlet;
          import javax.ws.rs.GET;
          import javax.ws.rs.Path;
          import javax.ws.rs.Produces;
          import javax.ws.rs.core.MediaType;

          @Path("«it.baseURI»")
          public class «it.name» {
              «it.resources.forEach[ resource |new ResourceGenerator().generate(resource)]»

          }

       '''

} 
```

希望我的问题很清楚。一个例子会很棒！（同样：ResourceGenerator().generate 返回一个 CharSequence）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T17:07:08.793

forEach 总是返回 null 并且只是在做副作用。你想要的是一张地图和一个连接。

```
it.resources.map(resource |new ResourceGenerator().generate(resource)).join 
```

但是还有一个更好的方法：

```
«FOR resource : resources»
  «new ResourceGenerator().generate(resource)»
«ENDFOR» 
```

我建议保留和重用 ResourceGenerator 的单个实例作为字段（您使用依赖注入吗？）或使 ResourceGenerator::generate 静态。

# javascript - 诺基亚地图 api 中的点击事件问题

> ID：12675780
> 
> 赞同：0
> 
> 时间：2012-10-01T14:58:42.723
> 
> 标签：javascript, here-api

我试试这段代码

```
for(i=0; i<num ;i++)
{
    points.push([lats[i], lngs[i]]);

    if(i==0) str = 'S';
    else if(i==num-1) str = 'E';
    else str = '';

    var marker = new nokia.maps.map.Marker(
            [lats[i], lngs[i]],
            {
                    title: str,
                    visibility: true,
                    icon: img,
                    anchor: new nokia.maps.util.Point(5, 5)
            });
    marker.addListener('click', function(evt){
            $('.loc').html(times[i]);
    });
    map.objects.add(marker);
} 
```

但它只是不会触发点击事件。代码有什么问题吗？

`lats`和`lngs`和`times`已定义，`points`将在以后使用。

编辑：

问题解决了。请参阅下面的评论以获取答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T09:19:13.593

看起来问题出在以下行：

```
$('.loc').html(times[i]); 
```

在标记侦听器内。该事件在触发时无法访问数组元素，因此失败。我认为您需要向标记添加一个属性并访问它，如下所示：

```
var marker = new nokia.maps.map.Marker(
            [lats[i], lngs[i]],
            {
                    title: str,
                    visibility: true,
                    icon: img,
                    anchor: new nokia.maps.util.Point(29, 71),
                    $html : times[i]
            });
    marker.addListener('click', function(evt){
            //$('.loc').html(times[i]); 
           alert (evt.target.$html);
    }); 
```

尝试以下操作（当然使用您自己的 App Id 和令牌）：

```
<!DOCTYPE HTML SYSTEM>
<html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=7; IE=EmulateIE9" />
        <script type="text/javascript" charset="UTF-8" src="http://api.maps.nokia.com/2.2.3/jsl.js"></script>

        <style type="text/css">

            html {
                overflow:hidden;
            }

            body {
                margin: 0;
                padding: 0;
                overflow: hidden;
                width: 100%;
                height: 100%;
                position: absolute;
            }

            #mapContainer {
                width:100%;
                height: 100%;
                left: 0;
                top: 0;
                position: absolute;
            }

 </style>
    </head>
    <body>
        <div id="mapContainer"></div>
        <script type="text/javascript">

            nokia.Settings.set( "appId", "YOUR APP ID GOES HERE"); 
            nokia.Settings.set( "authenticationToken", "YOUR AUTHENTICATION TOKEN GOES HERE");

var mapContainer = document.getElementById("mapContainer");

var DefaultLatitude = 52.516237;
var DefaultLongitude = 13.377686;
var defaultZoomLevel = 16;

var mapOptions =
{
    baseMapType: nokia.maps.map.Display.NORMAL,
    center: new nokia.maps.geo.Coordinate(DefaultLatitude, DefaultLongitude),    
    zoomLevel: defaultZoomLevel,
    components: [
        new nokia.maps.map.component.ZoomBar(),
        new nokia.maps.map.component.Behavior(),
        new nokia.maps.map.component.Overview(),
        new nokia.maps.map.component.ScaleBar(),
        new nokia.maps.map.component.ContextMenu()
    ]
};

  var map = new nokia.maps.map.Display(mapContainer, mapOptions);

var str ="";
var img = "http://api.maps.nokia.com/en/playground/examples/maps/res/markerHouse.png";
var points= new Array();
var lats = new Array();
var lngs = new Array();
var times = new Array();
var num;

lats[0] = 52.516237;
lngs[0] = 13.377686;
times[0] = "brandenburg gate";
num = 1;
for(var i=0; i<num ;i++)
{
    points.push([lats[i], lngs[i]]);

    if(i==0) str = 'S';
    else if(i==num-1) str = 'E';
    else str = '';

    var marker = new nokia.maps.map.Marker(
            [lats[i], lngs[i]],
            {
                    title: str,
                    visibility: true,
                    icon: img,
                    anchor: new nokia.maps.util.Point(29, 71),
                    $html : times[i]
            });
    marker.addListener('click', function(evt){
            //$('.loc').html(times[i]); 
           alert (evt.target.$html);
    });
    map.objects.add(marker);
}

 </script>
    </body>
</html> 
```

# php - PHP - 根据回显结果从数据库中捕获用户名到另一个页面

> ID：12675788
> 
> 赞同：0
> 
> 时间：2012-10-01T14:59:36.933
> 
> 标签：php, mysql, database, echo

我有一个显示广告列表的搜索引擎，我想知道如何从用户点击的结果中捕获用户名（使用数据库查询，PDO）

到目前为止，我有这个但不知道如何使它与用户点击的确切结果相关：

```
$sql = "SELECT * FROM user WHERE username=:username";
$q = $conn->prepare($sql);
$q->bindParam(':username', $username, PDO::PARAM_STR);
$q->execute();
$row = $q->fetch(PDO::FETCH_ASSOC);

$email1 = $row['email']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:01:07.297

理论上你的广告有一个唯一的 ID 不是吗？作为点击字符串的一部分，例如[http://mysite.com/adclick.php?adid=1](http://mysite.com/adclick.php?adid=1)，它知道在重定向时转到广告 ID 一个 url，然后您可以增加/存储任何用途等。

# jquery - 在上面选择 DIV，但不在里面

> ID：12675798
> 
> 赞同：2
> 
> 时间：2012-10-01T15:00:01.850
> 
> 标签：jquery, selector

选择器/横移有问题。基本上，我希望在用户点击选择时打开弹出 div。由于使用了较大的程序，我需要使用这种结构，所以我只是在寻找合适的选择器。

HTML

```
<div class="box">
 <div class="popup"></div>
 <select></select>
</div> 
```

jQuery

```
$('div.box select').focus(function (){
 $(this).closest('div').next().css('display','block');
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T15:01:58.937

选择它的父级然后找到弹出窗口：

```
$('div.box select').focus(function (){
  $(this).parent('.box').find('.popup').css('display','block');
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T15:01:41.733

您可以使用[prev()](http://api.jquery.com/prev/)方法。它将返回匹配元素的前一个兄弟：

```
$("div.box select").focus(function() {
    $(this).prev().css("display", "block");
}); 
```

**编辑：**如果您的标记结构可以变化并且您希望匹配`popup`该类，请改用[prevAll()](http://api.jquery.com/prevAll/)：

```
$("div.box select").focus(function() {
    $(this).prevAll(".popup").css("display", "block");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T15:13:03.590

试试这个

```
$('div.box select').focus(function (){
 $(this).closest('div').find('.popup').show();
}); 
```

# c - 如何在C中复制矩阵？

> ID：12675800
> 
> 赞同：7
> 
> 时间：2012-10-01T15:00:06.243
> 
> 标签：c, pointers, matrix

我正在尝试编写应该复制矩阵但编译器抱怨的函数matrixcopy：

```
/* minmatrix.c - test rows and columns of a matrix
 * Copyright abandoned. This file is in the public domain. */

#include <stdio.h>
#define ROWCOUNT (3)
#define COLUMNCOUNT (4)

int imat[ ROWCOUNT ][ COLUMNCOUNT ]; 
char cmat[ ROWCOUNT ][ COLUMNCOUNT ];
double dmat[ ROWCOUNT ][ COLUMNCOUNT ];
int rmat[ ROWCOUNT ][ COLUMNCOUNT ]; 

void matriscopy (int * destmat, int * srcmat, int rowcount, int columncount) 
{
  int i, j;
  for (i=0; i<rowcount; i=i+1) /* rad-nr */
    for (j=0; j<columncount; j=j+1) /* kolumn-nr */
      destmat[i][j] = srcmat[i][j];
}

int main()
{
  int i; int j;
  int * ip; char * cp; double * dp;

  for( i = 0; i < ROWCOUNT; i = i + 1 )
    for( j = 0; j < COLUMNCOUNT; j = j + 1 )
    {
      imat[ i ][ j ] = 10000 + 100*i + j;
      cmat[ i ][ j ] = 10*i + j;
      dmat[ i ][ j ] = 1.0 + i/100.0 + j/10000.0;
      rmat[ i ][ j ] = 0;
    };

  printf( "\n Examining imat:\n" );
  for( ip = &imat[ 0 ][ 0 ];
       ip <= &imat[ ROWCOUNT - 1 ][ COLUMNCOUNT - 1 ];
       ip = ip + 1 )
    printf( "memory at: %lx contains value: %d\n", (unsigned long) ip, *ip );

  printf( "\n Examining cmat:\n" );
  for( cp = &cmat[ 0 ][ 0 ];
       cp <= &cmat[ ROWCOUNT - 1 ][ COLUMNCOUNT - 1 ];
       cp = cp + 1 )
    printf( "memory at: %lx contains value: %d\n", (unsigned long) cp, *cp );

  printf( "\n Examining dmat:\n" );
  for( dp = &dmat[ 0 ][ 0 ];
       dp <= &dmat[ ROWCOUNT - 1 ][ COLUMNCOUNT - 1 ];
       dp = dp + 1 )
    printf( "memory at: %lx contains value: %f\n", (unsigned long) dp, *dp );

/* Add a statement here to call your matriscopy function. */

  printf( "\n Examining rmat:\n" );
  for( ip = &rmat[ 0 ][ 0 ];
       ip <= &rmat[ ROWCOUNT - 1 ][ COLUMNCOUNT - 1 ];
       ip = ip + 1 )
    printf( "memory at: %lx contains value: %d\n", (unsigned long) ip, *ip );

  return( 0 );
} 
```

我收到此错误：

```
$ cc minmatrix.c
minmatrix.c: In function ‘matriscopy’:
minmatrix.c:18:17: error: subscripted value is neither array nor pointer nor vector
minmatrix.c:18:32: error: subscripted value is neither array nor pointer nor vector 
```

你能帮我理解吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-01T15:24:41.857

您可以简单地使用 memcpy

```
void matriscopy (void * destmat, void * srcmat) 
{
  memcpy(destmat,srcmat, ROWCOUNT*COLUMNCOUNT*sizeof(int));
} 
```

`destmat`和`srcmat`应该具有相同的大小。

此功能只允许复制整个矩阵。

此函数无法从母矩阵复制子矩阵。

**示例：**如果我有一个 7 列和 7 行的矩阵。我无法使用上述函数从母矩阵复制子矩阵（4 行和 4 列）。为此，我们必须逐个单元格地复制

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T15:02:37.777

您的`matrixcopy`函数签名应如下所示：

```
void matrixcopy (int destmat[][COLUMNCOUNT], int srcmat[][COLUMNCOUNT], int rowcount, int columncount) 
```

当然，那么 columncount 是多余的。

或者，您可以将矩阵视为一维`rowcount * columncount`整数数组。在这种情况下，您可以在单个循环中进行复制，或使用`memcpy`标准库中的函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T15:15:02.003

您的函数的正确声明是：

```
void matriscopy (int destmat[][COLUMNCOUNT], int srcmat[][COLUMNCOUNT], int rowcount) 
```

所以你的功能变成

```
void matriscopy (int destmat[][COLUMNCOUNT], int srcmat[][COLUMNCOUNT], int rowcount) 
{
  int i, j;
  for (i=0; i<rowcount; i=i+1) /* rad-nr */
    for (j=0; j<COLUMNCOUNT; j=j+1) /* kolumn-nr */
      destmat[i][j] = srcmat[i][j];
} 
```

在多维数组中，除了第一个维度之外的所有维度都必须在函数参数中固定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T15:06:52.863

试试这个版本`matriscopy`。

```
void matriscopy (int * destmat, int * srcmat, int rowcount, int columncount)
{
  int i, j;
  int (*dst)[columncount];
  int (*src)[columncount];
  dst = (int (*)[columncount])destmat;
  src = (int (*)[columncount])srcmat;
  for (i=0; i<rowcount; i=i+1) /* rad-nr */
    for (j=0; j<columncount; j=j+1) /* kolumn-nr */
      dst[i][j] = src[i][j];
} 
```

> 自 c99 标准以来，C 允许可变长度数组 (VLA)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-01T15:04:41.567

在`matriscopy`中，您的变量`destmat`是一个整数指针。这意味着 的类型`destmat[i]`是整数。由于您无法索引到整数，因此您不能拥有`destmat[i][j]`. 你可能想`destmat`成为`int**`not类型`int*`。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-01T15:12:06.200

destmat 和 srcmat 应该是双指针。就像`int **destmat,int **srcmat`您实际上试图访问指向某些整数对象的整数指针数组一样。就像 a[i][j] 是您知道第 i 行第 j 列的对象。因此，当您定义 int **p; 时，就像 p 是一个指针数组，每个指针都指向一个整数对象。然后您可以像 p[i][j] 一样访问它。如果它解决了您的问题，请将其标记为答案。

# c# - 如何检测事件处理程序并释放它？

> ID：12675801
> 
> 赞同：1
> 
> 时间：2012-10-01T15:00:11.030
> 
> 标签：c#, events, event-handling, event-hooking

假设我有一个类说一个视图模式类 mvvm。然后有一些为此 vm 创建的事件处理程序。那么它可以被许多其他不同情况的人使用。

因此，如果我有一个 myvm 的实例，我想检测是否有任何事件处理程序连接并想释放它以解决内存问题。

从 myvm 中执行此操作的通用方法是什么，例如，我可能没有 myvm 的源代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:17:16.120

事件的设计使得声明它们的类之外的代码无法访问底层委托。例如，根据[C# 语言规范](http://go.microsoft.com/fwlink/?LinkId=199552)（强调我的）中的“10.8 事件”部分：

> 在 x += y 或 x -= y 形式的操作中，当 x 是一个事件并且引用发生在包含 x 声明的类型之外时，操作的结果具有 void 类型（与具有x 的类型，赋值后的 x 值）。**此规则禁止外部代码间接检查事件的底层委托。**

因此，在课堂外找出订阅了事件的内容可能充其量只是一种“变通”。

如果您有权访问包含该事件的类的源并且您希望跟踪连接到某个[事件](http://msdn.microsoft.com/en-us/library/8627sbea%28v=vs.110%29.aspx)的委托，请在事件定义中实现[add](http://msdn.microsoft.com/en-us/library/cc713648.aspx)和[remove](http://msdn.microsoft.com/en-us/library/cc713642.aspx) 关键字，[并在 Dictionary 中手动跟踪它们](http://msdn.microsoft.com/en-us/library/z4ka55h8.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T16:06:50.580

如果我理解正确的话。这个类包装了未知的 myvm 类，我使用 SocketAsyncEventArgs 来说明，因为显然我们没有 SocketAsyncEventArgs 类的源代码。

我包装了 SocketAsyncEventArgs 类的 Completed 事件。当该事件被触发时，_instance_Completed 将被触发，然后 _myvm 事件将被触发。所以我们需要做的是订阅/取消订阅 _myvm 事件。

然后我留下一个事件供人们订阅/取消订阅 _myvm 事件，作为订阅/取消订阅，代表被存储到一个列表中，因此您可以通过调用 ClearEvents() 方法来清除。

希望它会有所帮助。

```
 public class WrapperClass
    {
        private EventHandler<SocketAsyncEventArgs> _myEvent;
        private SocketAsyncEventArgs _myvm;
        private List<Delegate> delegates;

        public WrapperClass()
        {
            delegates = new List<Delegate>();
        }

        public void SetInstance(SocketAsyncEventArgs myvm)
        {
            _myvm = myvm;
            _myvm.Completed += new EventHandler<SocketAsyncEventArgs>(_instance_Completed);
        }

        private void _instance_Completed(object sender, SocketAsyncEventArgs e)
        {
            if (_myEvent != null)
            {
                _myEvent(sender, e);
            }
        }

        public event EventHandler<SocketAsyncEventArgs> myEvent
        {
            add
            {
                delegates.Add(value);
                _myEvent = (EventHandler<SocketAsyncEventArgs>)Delegate.Combine(_myEvent, value);
            }
            remove
            {
                delegates.Remove(value);
                _myEvent = (EventHandler<SocketAsyncEventArgs>)Delegate.Remove(_myEvent, value);
            }
        }

        public void ClearEvents()
        {
            foreach (var d in delegates)
            {
            _myEvent = (EventHandler<SocketAsyncEventArgs>)Delegate.Remove(_myEvent, d);
            }
        }
    } 
```

# php - 如何创建 DateTime HTML 输出？

> ID：12675802
> 
> 赞同：5
> 
> 时间：2012-10-01T15:00:21.193
> 
> 标签：php, forms, zend-framework2

当我将表单元素的类型设置为 Zend\Form\Element\Date 时，视图助手很好地为下拉日历创建了 HTML。但是，当我将其更改为**Zend\Form\Element\DateTime**时，我不仅没有收到时间输入，而且日期输入已恢复为文本输入。

获得完美绘制 DateTime HTML 表单元素的最简单方法是什么？

表单元素...

```
<?php

....

$this->add(array(
    'name' => 'dateTime',
    'type' => 'Zend\Form\Element\DateTime',
)); 
```

模板...

```
<?php

....

echo $this->formrow( $form->get('dateTime') ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T11:23:28.440

仅显示日历是因为浏览器支持 HTML5 日期输入。ZF2 没有画任何东西。

根据[WC3 学校](http://www.w3schools.com/html/html5_form_input_types.asp)的说法，日期时间是一种 HTML5 标准，但似乎并未得到广泛支持。

# unit-testing - 学习 F#：是否可以创建测试用例来验证签名？

> ID：12675808
> 
> 赞同：4
> 
> 时间：2012-10-01T15:00:45.807
> 
> 标签：unit-testing, f#, signature

通过对数百行 F# 代码进行单元测试，我意识到不仅检查输出而且检查签名都是有利的。原因是如果代码已针对发布进行验证，然后在发布后修改签名进行更改，人们会想知道签名更改的原因，以便可以为新签名更新测试用例或标记改变为引起问题。

是否可以创建一个测试用例来验证签名？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:15:30.143

我认为最好的方法是简单地提供覆盖签名范围的测试用例。例如，要验证返回类型是否为`int`，

```
let x:int = someFunc() //you'll get a compiler error if the return type changes 
```

真的，我希望仅仅通过详尽地测试您的公共 API，您就必须测试签名。尤其是在像 F# 这样的语言中，它具有相对严格的静态类型系统。

我想你也可以冒险使用反射来断言签名，但老实说，我认为这不是一个很好的时间投资。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T15:54:37.127

正如斯蒂芬所说，如果您为代码编写一些单元测试，单元测试通常会使用函数所需类型的值调用函数，因此也会自动检查签名（如果您更改签名，您将无法编译您的测试）。

另一种适用于库的替代方法是使用 F# 接口文件 ( `.fsi`)。接口文件在实现文件 ( `.fs`) 中指定了公共函数的类型，它也是文档的好地方。

如果您随后（不小心）更改了实现的类型，除非您更新接口文件中的类型，否则您的代码将无法编译。

您可能希望手动维护接口文件（请参阅 F# 库源以获得一个很好的示例），但您可以通过使用`--sig:mylibrary.fsi`. 您可能会使用此开关来自动化测试（并在每次编译后检查签名文件之间的差异）。

# html - ipad/iphone 功能问题

> ID：12675814
> 
> 赞同：0
> 
> 时间：2012-10-01T15:01:10.377
> 
> 标签：html, mobile-safari, anchor

我有以下 html 标记，适用于所有浏览器，但在 iPhone/ipad 中查看时，下拉列表不会打开。

由于我当前的 css 规则，使用空锚标记的原因是保持父链接的样式与我的菜单链接的其余部分相同；但同时防止父链接重定向页面。

这是一种非常错误的方法以及我遇到的问题的原因吗？

```
<ul class="primary-nav">
   <li><a>Group links</a>
    <ul id="sub_nav" class="sub">  
    <li><a href="/">Link</a></li>  
    <li><a href="/">Link 1</a></li>  
    <li><a href="/">Link 2</a></li>  
    <li><a href="/">Link 3 </a></li>
    </ul>
   </li>
  </ul> 
```

我可以看到菜单中有以下 javascript

```
 // Test is browser is IE
    var browserIsIE = null;
    if (jQuery.browser.msie == true) {
        browserIsIE = true;
    } else {
        browserIsIE = false;
    };
 // primary and secondary nav hover for IE < 9
    if (browserIsIE == true) {
        $(".primary-nav li, .secondary-nav li").hover(function () {
            $(this).addClass("hover");
        }, function () {
            $(this).removeClass("hover");
        });
    }; 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:39:27.283

主要问题是当`browserIsIE`评估为时`false`，什么都不会发生。if 语句要求它在将事件处理程序`true`附加`hover`到下拉菜单之前。

一旦你解决了这个问题，你很快就会意识到你不能`hover`在触摸设备上。这篇文章[https://ux.stackexchange.com/questions/14257/re-thinking-hover-functionality-with-touchscreens-in-mind](https://ux.stackexchange.com/questions/14257/re-thinking-hover-functionality-with-touchscreens-in-mind)涵盖了一些您可以实施的好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:50:13.380

问题是您正在观看悬停事件。移动设备上没有悬停事件。没有光标，因此无法悬停。

但是，浏览器会尝试处理它：

[http://sitr.us/2011/07/28/how-mobile-safari-emulates-mouse-events.html](http://sitr.us/2011/07/28/how-mobile-safari-emulates-mouse-events.html)

但是你最好的选择是设计一些东西来解决移动用户不能悬停的事实，而是注意像 touchStart 这样的东西。

# c# - 免费的 MS Word 库

> ID：12675816
> 
> 赞同：2
> 
> 时间：2012-10-01T15:01:18.167
> 
> 标签：c#, ms-office

我需要开源或免费用于商业用途的库，它可以从 MS Word 文件中获取数据。我想到了 LibreOffice。你知道别的吗？

我对 DOC 文件（版本 97-2003）感兴趣，库应该是 64 位的。

我可以用于商业目的吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:03:04.310

下载[OpenXML SDK](http://www.microsoft.com/en-us/download/details.aspx?id=5124)以读取 Office 文档，例如**MS Word**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T15:03:05.113

查看 NPOI（Apache NOI API 的 .NET 端口）：

[http://npoi.codeplex.com/](http://npoi.codeplex.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-05T11:58:24.867

我找到了不错的库 NetOffice (http://netoffice.codeplex.com/)，它可以与 MS Office 中的任何文件配合使用。（Word、Excel、Powerpoint 等）
要更正工作库需要安装 MS Office

# c# - 在自定义类的 IEnumerable 中对具有特定 ID 的项目求和

> ID：12675819
> 
> 赞同：3
> 
> 时间：2012-10-01T15:01:42.417
> 
> 标签：c#, .net, linq, list, ienumerable

```
CustomClass{
int ID;
int numberToSum;
float numToAverage;
}

IEnumerable<CustomClass> results = MethodToPopulateIEnumerable();
List<int> listOfIDs = MethodToGetListOfIDs(); 
```

我希望对这些进行处理，将我的`IEnumberable<CustomClass>`并选择 ID 中的所有值`List<int> listOfIDs`，然后我希望将其`numberToSum`值求和并将其保存在变量中并获取`numToAverage`属性的平均值并将其保存在多变的。

最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T15:06:37.823

我想你正在寻找这样的东西：

```
IEnumerable<CustomClass> results = MethodToPopulateIEnumerable();
List<int> listOfIDs = MethodToGetListOfIDs(); 
```

**查询语法**

```
 var query = from c in results
             where listOfIds.Any(x => x == c.ID)
             select c; 
```

**方法语法**

```
var query = results.Where(c => listOfIds.Any(x => x == c.ID)); 
```

**计算**

```
int numberToSum = query.Sum(x => x.numberToSum);
float numToAverage = query.Average(x => x.numToAverage); 
```

另一种替代方法可以减轻其他成员对性能的一些担忧，但仍然允许查询是友好的（`linq-to-entities`, `linq-to-sql`）：

```
var calculations = (from c in results
                   where listOfIds.Any(x => x == c.ID)
                   group c by 1 into g
                   select new {
                     numberToSum = g.Sum(x => x.numberToSum ),
                     numToAverage = g.Average(x => x.numToAverage),                
                   }).FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:08:56.607

我认为它是这样的：

```
var matchingIdsList = results.Where(x => listsOfIDs.Any(y => y == x.Id));
var sum = matchingIdsList.Sum(x=> x.numberToSum);
var average = matchingIdsList.Average(x=> x.numToAverage); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T15:11:34.213

我会这样做 - 不是很优雅但更有效：

```
// Load IDs into a hashset so Contains is O(1) not O(n)
var hashSetOfIDs = new HashSet<int>(listOfIDs);

// Aggreagate count and both sums in one pass, then calculate average.
var result = results.Where(cc => hashSetOfIDs.Contains(cc.ID)).Aggregate(
    new { Count = 0, Sum = 0, AverageSum = 0f },
    (a, cc) => new {
        Count = a.Count + 1,
        Sum = a.Sum + cc.numberToSum,
        AverageSum = a.AverageSum + cc.numToAverage },
    a => new { 
        Sum = a.Sum,
        Average = a.Count > 0 ? a.AverageSum / a.Count : float.NaN });

// Extract results
var sum = result.Sum;
var average = result.Average; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T15:15:26.177

```
var results = MethodToPopulateIEnumerable();
var listOfIDs = MethodToGetListOfIDs();

int numberToSum = 0;
float numberToAverage = 0;

var selected = results.Where(c => listOfIDs.Contains(c.ID)).Select(c =>
  {
    numberToSum += c.numberToSum;
    numberToAverage += c.numToAverage;
    return c;
  }).ToList();

float average = numberToAverage/selected.Count; 
```

# linux - 将标准错误发送到标准输出不起作用

> ID：12675821
> 
> 赞同：0
> 
> 时间：2012-10-01T15:01:45.237
> 
> 标签：linux, cron

我无法获取将标准错误发送到标准输出的命令。我打算把它放在 cron 中，但现在我只是手动运行。

```
/home/backups/backup_scripts/backup.sh 2>&1 >> /var/log/backups/backup.log 
```

我希望日志文件包含打印到标准输出的任何消息，但日志文件只显示标准输出，控制台输出显示错误。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:07:12.640

重定向的顺序很重要。您应该将其更改为：

```
/home/backups/backup_scripts/backup.sh >> /var/log/backups/backup.log 2>&1 
```

这会将 stdout 重定向到`/var/log/backups/backup.log`，然后将 stderr 重定向到 stdout（进入文件）。

您还可以使用以下较短的形式：

```
/home/backups/backup_scripts/backup.sh &>> /var/log/backups/backup.log 
```

`&>>file`在语义上等价于`>>file 2>&1`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T15:09:51.317

这是由于重定向的顺序而发生的。意思是“将`2>&1`标准错误重定向到标准输出的**当前**位置”。它们从左到右处理，因此第一个标准错误被重定向到当前的标准输出（仍然是终端），然后标准输出被重定向到一个文件。如果您将顺序切换为阅读

```
/home/backups/backup_scripts/backup.sh >> /var/log/backups/backup.log 2>&1 
```

它应该做你想做的事。如果你的 shell 是 bash，它有一个同时重定向标准输出和标准错误的快捷方式：`command &> file`将它们都重定向到一个文件并将它们都`command &>> file`附加到一个文件中。bash手册中也提到了这种顺序依赖

> 请注意，重定向的顺序很重要。例如，命令
> 
> ```
> ls > dirlist 2>&1 
> ```
> 
> 将标准输出和标准错误都指向文件 dirlist，而命令
> 
> ```
> ls 2>&1 > dirlist 
> ```
> 
> 仅将标准输出定向到文件 dirlist，因为在将标准输出重定向到 dirlist 之前，标准错误已从标准输出中复制。

我认为对文件描述符和重定向的工作方式存在一些误解。内核有一个系统上所有打开文件的大表，其中包含文件偏移量、状态标志和文件本身的名称。然后每个进程都有一个表，将文件描述符编号映射到这个全局表中的条目。

在任何重定向发生之前，全局表可能看起来像这样

```
A: TERMINAL 
```

进程表看起来像

```
0: A
1: A
2: A 
```

因为描述符编号 0、1 和 2 分别是标准输入、标准输出和标准错误。

然后`2>&1`处理重定向。这会更改进程表，以便 2 包含指向与 1 相同的全局条目的点。但是，它们已经相同，因此没有任何反应。

`>> /var/log/backups/backup.log`处理重定向时。首先打开文件并将其分配给进程表中的文件描述符 3，因此表看起来像

```
A: TERMINAL
B: /var/log/backups/backup.log 
```

和

```
0: A
1: A
2: A
3: B 
```

然后将标准输出更改为指向新打开的文件（好像`1>&3`已经完成），因此现在处理表

```
0: A
1: B
2: A
3: B 
```

请注意， 2 (stderr) 仍然指向终端。

当重定向以其他顺序完成时，之后的表格`>> /var/log/backups/backup.log`看起来相同。

```
0: A
1: B
2: A
3: B 
```

然后`2>&1`重定向改变了2点给予

```
0: A
1: B
2: B
3: B 
```

所以现在 stdout 和 stderr 都进入文件。

# wpf - WPF Listview - 获取特定项目并设置其颜色

> ID：12675823
> 
> 赞同：0
> 
> 时间：2012-10-01T15:01:51.603
> 
> 标签：wpf, listview

我通过这样的代码生成一个 ListView：

myListView.Items.Add(personToAdd);

现在我想做一些长期计算，在计算持续期间我想禁用该项目。计算后我想再次启用该项目。添加对象时如何获取 ListViewItem？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T09:15:53.407

你得到这样的 ListViewItem（这里我得到选定的 ListViewItem）：

```
object selectedEntry = (object)myListBox.SelectedItem;
ListBoxItem lbi = this.myListBox.ItemContainerGenerator.ContainerFromItem(selectedEntry) as ListBoxItem; 
```

但您也可以获得其他物品：

```
object selectedEntry = (object)myListBox.Items[int];
ListBoxItem lbi = this.myListBox.ItemContainerGenerator.ContainerFromItem(selectedEntry) as ListBoxItem; 
```

# .net - 屏幕区域的 OCR 方法。SDK 或应用程序

> ID：12675830
> 
> 赞同：1
> 
> 时间：2012-10-01T15:02:08.620
> 
> 标签：.net, sdk, screen-scraping, ocr, screen-capture

我还没有找到解决办法。我想做的是从专有的金融软件平台读取特定的数字文本值。我首先尝试了可访问性和元素间谍方法，但没有成功。我能想到的唯一可行的方法是使用屏幕的 OCR，具有特定的固定区域。

我检查过的所有 OCR 解决方案似乎都是基于文件的（PDF、TIFF 等）。我真正需要的是可以从屏幕上捕获的 OCR 解决方案。我能想到的几个挑战： 要捕获的文本是黑色背景，可以是彩色文本（黄色、绿色、红色、橙色）。文本大小也很小（我认为是 6pt）。

理想情况下，我想要一个 .NET API，但我愿意尝试任何可行的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:10:32.867

这可能无法回答您的 OCR 问题，但您可以尝试的最后一种方法是挂钩 windows 的 DrawText API。我最近了解到这一点是为了解决一个[类似的问题，就像你自己一样](https://stackoverflow.com/questions/12570167/getting-the-text-from-a-dialog-box-that-does-not-use-a-label-control/12609875)。

去下载[EasyHook](http://easyhook.codeplex.com/)库并查看示例。尝试在外部应用程序上连接[DrawTextA、DrawTextW](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162498%28v=vs.85%29.aspx)、[DrawTextExA 和 DrawTextExW](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162499%28v=vs.85%29.aspx)（这将与我在问题中的代码不同，因为我连接的是 Inproc DLL，而不是外部程序，但您的用例是 EasyHook 的设计目的，我的方式是一个黑客）。找出它使用什么，看看你是否可以让你的代码来解析文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:50:05.167

试试这个[OCR SDK](http://www.nicomsoft.com/products/ocr/)

您制作屏幕截图，指定区域并将其传递给 OCR。我们用这种方法得到了很好的结果。我们还尝试了 tesseract，但无法使其与屏幕字体正常工作。

# lazy-loading - 惰性加载 + 同位素

> ID：12675831
> 
> 赞同：11
> 
> 时间：2012-10-01T15:02:08.980
> 
> 标签：lazy-loading, jquery-isotope

我花了相当多的时间试图让同位素和延迟加载一起工作。

问题：如果用户向下滚动，延迟加载会起作用，但是如果用户使用过滤器，项目会显示在顶部，但图像不会加载。

这是一个有同样问题的人，但似乎他解决了这个问题。我尝试了几件事，但仍然无法正常工作。

这是讨论[https://github.com/tuupola/jquery_lazyload/issues/51](https://github.com/tuupola/jquery_lazyload/issues/51)

非常感谢你的帮助

我使用的代码如下。

```
jQuery(document).ready(function($) {
    $('#big_container .media_block img').each(function(index) {
        var item_height = $(this).attr("height");
        $(this).parent().parent().css("height",item_height);
    });
    $('#big_container').isotope({
    itemSelector : '.item',
    layoutMode : 'masonry',
    masonry: {
        columnWidth: 5,
    },
    sortBy : 'date',
    sortAscending : false,
    getSortData : {
        date : function ( $elem ) {
            return $elem.find('.date').text(); // Date format should be [Y-m-d H:i]
        },
        views : function( $elem ) {
            return parseInt( $elem.attr('data-views'), 10 );
          },
        //featured : function ( $elem ) {
        // return $elem.attr('data-featured');
        //  },
        rates : function( $elem ) {
            return parseInt( $elem.attr('data-rates'), 10 );
          },
        comments : function( $elem ) {
            return parseInt( $elem.attr('data-comments'), 10 );
          }
    }

    });

    $('#sort-by li a').click(function(){
        var $this = $(this);
        if ($(this).parent().hasClass('selected') ) {
          return false;
        }
        var $optionSet = $this.parents();
        $optionSet.find('.selected').removeClass('selected');
           $this.addClass('selected');
          var sortName = $(this).attr('href').slice(1);
          $('#big_container').isotope({ sortBy : sortName });
          return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-17T17:40:42.623

要使同位素的排序/过滤与延迟加载一起使用，您必须执行以下操作。

```
jQuery(document).ready(function($) {
    var $win = $(window),
        $con = $('#container'),
        $imgs = $("img.lazy");

    $con.isotope();

    $con.on('layoutComplete', function(){
        $win.trigger("scroll");
    });

    $imgs.lazyload({
        failure_limit: Math.max($imgs.length - 1, 0)
    });
}); 
```

## 解释

根据文档（[http://www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)）

> 滚动页面后，延迟加载会通过卸载的图像循环。在循环中，它检查图像是否可见。默认情况下，当找到折叠下方的第一张图像（不可见）时，循环停止。这是基于以下假设。页面上的图像顺序与 HTML 代码中的图像顺序相同。在某些布局假设下，这可能是错误的。

使用同位素排序/过滤列表，页面顺序肯定与 HTML 不同，因此我们需要调整我们的`failure_limit`.

如您所见，我们存储了 jQuery 对象，以便我们可以将其`length-1`用作 failure_limit。如果你好奇为什么会这样`length-1`，那是因为下面检查了lazyload的更新方法。

```
if (++counter > settings.failure_limit) {
    return false;
} 
```

## 其他事件的延迟加载

如果您没有在滚动时触发延迟加载，则需要将“滚动”触发器交换为您正在使用的任何事件。

## 演示

[http://jsfiddle.net/arthurc/ZnEhn/](http://jsfiddle.net/arthurc/ZnEhn/)

# 您网站的代码

我将一些 jQuery 对象存储在变量中，因为它们需要重复使用。

```
jQuery(document).ready(function($) {
    var $window = $(window);
    var $images = $('#big_container .media_block img');
    var $big_container = $('#big_container');

    $images.each(function(index) {
        var item_height = $(this).attr("height");
        $(this).parent().parent().css("height",item_height);
    });

    $big_container.isotope({
        itemSelector : '.item',
        layoutMode : 'masonry',
        masonry: {
            columnWidth: 5,
        },
        sortBy : 'date',
        sortAscending : false,
        getSortData : {
            date : function ( $elem ) {
                return $elem.find('.date').text(); // Date format should be [Y-m-d H:i]
            },
            views : function( $elem ) {
                return parseInt( $elem.attr('data-views'), 10 );
              },
            //featured : function ( $elem ) {
            // return $elem.attr('data-featured');
            //  },
            rates : function( $elem ) {
                return parseInt( $elem.attr('data-rates'), 10 );
              },
            comments : function( $elem ) {
                return parseInt( $elem.attr('data-comments'), 10 );
              }
        }

    });

    $big_container.on('layoutComplete', function(){
        $win.trigger("scroll");
    });

    $('#sort-by li a').click(function(){
        var $this = $(this);
        if ($(this).parent().hasClass('selected') ) {
          return false;
        }
        var $optionSet = $this.parents();
        $optionSet.find('.selected').removeClass('selected');
           $this.addClass('selected');
          var sortName = $(this).attr('href').slice(1);
          $big_container.isotope({ sortBy : sortName });
          return false;
    });

    $images.lazyload({
        failure_limit : Math.max($images.length-1, 0);
    })
}); 
```

# php - 在同一个文件中找不到类

> ID：12675835
> 
> 赞同：3
> 
> 时间：2012-10-01T15:02:13.723
> 
> 标签：php, class, initialization

> **可能重复：**
> [稍后在同一文件中定义的派生类“不存在”？](https://stackoverflow.com/questions/12617188/derived-class-defined-later-in-the-same-file-does-not-exist)

有没有人知道为什么我在下面的 if 语句中尝试初始化它时出现致命错误：找不到类“PublicacionController”？

```
--PublicacionController.php--
<?php
/*Some random includes, those are 
right as far as Im concerned*/

//AJAX call
if(!empty($_POST)){
    if($_POST['call']=='nuevaPublicacion'){
        $pc = new PublicacionController();
        $pc->nuevaPublicacion($_POST);
        exit;
    }
}

class PublicacionController extends Controller{/* STUFF*/}
?> 
```

它是一个文件。我从 AJAX 调用中调用控制器（不知道是否与它有关）。

我正在运行一个标准的 Amazon Ec2 实例，使用 Amazon Linux 以及来自 repos 的默认 https 和 PHP 版本（我认为同一个 Fedora 使用）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-01T15:04:18.153

PHP 类应在实例化之前定义，请参阅[PHP OO 文档的“新”部分](http://php.net/manual/en/language.oop5.basic.php)。

实现这一点的一种简单方法是首先声明类，然后声明主代码：

```
--PublicacionController.php--
<?php
/*Some random includes, those are 
right as far as I'm concerned*/

class PublicacionController extends Controller{/* STUFF*/}

//AJAX call
if(!empty($_POST)){
    if($_POST['call']=='nuevaPublicacion'){
        $pc = new PublicacionController();
        $pc->nuevaPublicacion($_POST);
        exit;
    }
}

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:05:06.013

它是一个 AJAX 调用这一事实与它没有任何关系，但调用代码位于类声明之上的事实却如此。

交换代码，或者更好的是，将其移动到单独的文件中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T15:06:50.427

这是一个`PHP ERROR`看：[稍后在同一个文件中定义的派生类“不存在”？](https://stackoverflow.com/questions/12617188/derived-class-defined-later-in-the-same-file-does-not-exist/12617996#12617996)

如果你跑

```
if (! empty($_POST)) {
    if ($_POST['call'] == 'nuevaPublicacion') {
        $pc = new PublicacionController();
        $pc->nuevaPublicacion($_POST);
        exit();
    }
}

class Controller {
    function nuevaPublicacion($array) {
    }
}
class PublicacionController extends Controller {/* STUFF*/ 
```

上面的代码可以正常工作，只要`Controller`通过外部文件包含它就会开始产生错误。

***建议在使用之前声明所有类，尤其是在处理继承时***

# javascript - Javascript 正则表达式匹配（）

> ID：12675839
> 
> 赞同：3
> 
> 时间：2012-10-01T15:02:34.707
> 
> 标签：javascript, regex, match

我只是希望这个函数根据字符串返回一个 int 但它不起作用它将是 H 或 V 后跟 1 或 2 位数字。

```
即：H1 返回 99
    H09返回91
    H10回报90
    H50 返回 50
    V1 返回 1
    V05 返回 5
    V11 返回 11
    V50返50

```

spot 将是我的字符串。

```
get100YardVersionEugene: function(spot)
{
        var team = spot.match(/[A-Z]+/);
        var yard = spot.match(/([0-9]+)/);

        if (team == "H")
        {
            return 100-yard;
        }
        else //V
        {
            return yard;
        }
    }, 
```

出于某种原因，当它的 V9（或 H9）坏了，但是当我放入 V09 时它可以工作。

有人能告诉我为什么吗？

编辑：它会中断...我有两个变量 start 和 end

所以我有类似 start = get100YardVersionEugene("V9") 的东西
，我使用 start 和 end 在 html5 画布上绘制它

start = get100YardVersionEugene("V9") //没有正确绘制 start = get100YardVersionEugene("V09") //正确绘制

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T15:06:15.920

试着把院子包起来`[parseInt][1]`。

```
var yard = parseInt(spot.match(/([0-9]+)/), 10); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-01T15:06:29.190

您可以稍微简化一下您的正则表达式，以便它只检查`H`or `V`。

关于数字，您需要记住它`match`返回一个数组，因此您需要通过索引获取值。此外，您不需要捕获组。

实际上，您真的应该只使用一个正则表达式。

```
get100YardVersionEugene: function(spot)
{
     var parts = spot.match(/(H|V)([0-9]+)/);
     if (parts) {
        if (parts[1] == "H")
        {
            return 100-(+parts[2] || 0);
        }
        else //V
        {
            return +parts[2];
        }
    }
}, 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-01T15:06:27.853

match 函数的结果是一个数组。做这个 ：

```
 var team = spot.match(/[A-Z]+/)[0]; 
```

并且您还需要将结果解析为 int。

或者，这里似乎不需要正则表达式：

```
var team = spot.substring(0, 1);
var yard = parseInt(spot.substring(1), 10);
return team=='H' ? (100-yard) : yard; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-01T15:10:33.110

正则表达式对此完全是矫枉过正。试试 String.charAt() 或 String.substr()：

```
get100YardVersionEugene: function(spot)
{
   var team = spot.charAt(0);
   var yard = parseInt(spot.substr(1,2), 10);

   ...
} 
```

演示：http: [//jsfiddle.net/yzq9j/2/](http://jsfiddle.net/yzq9j/2/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-01T15:11:05.840

您可能需要将您的院子转换为数字

```
if( team == H ){
 return 100-parseInt(yard);
} 
```

然后使用 isNaN 方法检查转换有效性可能会很好。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-01T15:11:43.267

修改后的代码：`spot.match(/([0-9]+)/)`正在返回一个数组

```
function get100YardVersionEugene(spot)
{
        var team = spot.match(/[A-Z]+/);
        var yard = spot.match(/([0-9]+)/);
       console.log(team , yard );
        if (team == "H")
        {
            return 100-yard[0];
        }
        else //V
        {
            return yard[0];
        }
    } 
```

# algorithm - 依赖于参数的 PRNG

> ID：12675840
> 
> 赞同：1
> 
> 时间：2012-10-01T15:02:36.453
> 
> 标签：algorithm, math, random, prng

我对`rand(x, y, seed)`基于其参数返回（伪）随机数的函数感兴趣，该函数具有以下属性：

1.  返回的值应该取决于它的 3 个参数，而**不是**取决于`rand`到目前为止被调用的次数。例如，假设这些调用，按以下顺序：

    > ```
    > rand(0, 0, 123) = 1
    > rand(0, 1, 123) = 2
    > rand(0, 2, 123) = 3 
    > ```

    然后`rand`用相同的参数调用，但顺序不同，我们应该得到相同的值。例如：

    > ```
    > rand(0, 1, 123) = 2
    > rand(0, 2, 123) = 3
    > rand(0, 0, 123) = 1 
    > ```

2.  该函数应该具有良好的通常属性（体面，我真的不需要任何非常花哨的东西）PRNG：大周期，均匀分布等。返回适合有符号整数的正整数很好。如果你愿意，它也可以更高。

3.  假设这些数字将用于生成矩阵。然后更改种子应确保生成的矩阵看起来与其他种子生成的矩阵尽可能不同。这应该发生在尽可能多的种子上：我不希望矩阵重复。

如果有帮助，我的种子将始终是以毫秒为单位的 unix 时间戳（如果这以某种方式使其更容易，也可以以秒为单位）。所有参数都可以高达 32 位有符号整数，但在函数内部使用 64 位值不是问题。

我可以为此使用什么功能？

**我想到的：**

[Perlin 噪声](http://freespace.virgin.net/hugo.elias/models/m_perlin.htm)似乎做了我想做的一些事情，但我不知道它作为 PRNG 到底有多合适，尤其是在分布方面。我也不确定它的效率如何，因为我的`(x, y)`参数将是相当随机的，我无法为所有参数预先计算它。

我还研究了以下功能：

```
p = 1400328593
rand(x, y, seed) = (x * x * seed + y * seed * seed + seed * x * y + seed) mod p
                 = (seed * (x * x + y * seed + x * y + 1)) mod p 
```

这**似乎**产生了足够好的数字。根据我的（非常弱的）测试，它们似乎也分布得很好。测试这个时期虽然更难，但我没有这样做。

**更新：**

这是上述函数的[Ent](http://fourmilab.ch/random/)`time(NULL)`的输出，其中in C 作为它的种子和为 生成的值`(x, y) in {0 ... 999} x {0 ... 999}`：

> 熵 = 每字节 3.312850 位。
> 
> 最佳压缩将使这个 9207076 字节文件的大小减少 58%。
> 
> 9207076 个样本的卡方分布为 229710872.43，并且随机超过该值的次数不到 0.01%。
> 
> 数据字节的算术平均值为 52.3354（127.5 = 随机）。Pi 的 Monte Carlo 值为 4.000000000（误差 27.32%）。序列相关系数为 0.036131（完全不相关 = 0.0）。

这在实践中是否足够好（理论上，上述测试表明它根本不好），还是我应该使用一些众所周知的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T10:32:36.463

听起来你想要一个哈希函数。如果不是太低效，请选择安全的，例如 SHA1，因为它保证具有良好的分布特性；否则，您可以使用常见的哈希函数，例如 FNV。只需使用您的种子和坐标作为输入数据，并将哈希值作为随机值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T16:58:42.167

您可以尝试使用[Blum Blum Shub](http://en.wikipedia.org/wiki/Blum_Blum_Shub)。它具有您可以直接计算系列的第 n 个值的属性，这似乎适合您的情况。它需要三个参数，p、q 和 x0。p 和 q 是素数，x0 是 p 和 q 的素数。因此，您的参数 x 和 y 可用于查找第 x 和第 y 素数，然后它们将适用于 p 和 q，然后您可以使用第三个参数为 x0 找到合适的值。这有点乏味，而且 Blum Blum Shub 很慢，因为它是一个加密的 RNG，但如果你真的不需要速度，那么它会工作并且不会很难实现。

另一种方法是使用像[CMWC](http://en.wikipedia.org/wiki/Multiply-with-carry#Complementary-multiply-with-carry_generators)这样的 RNG ，并用 x + y^i + seed^(2i) 之类的东西填充生成器的第 i 个位置，运行生成器一会儿（可能是一些乘以它存储的值的数量），然后从中提取一个值。

如果您想使用 CMWC，您可以在此处查看我在 github 上的实现，以及在[此处](https://github.com/runningwild/cmwc)构建具有已知周期的生成器的[值](https://github.com/runningwild/cmwc/blob/master/rand.go)。

# python - 如何在 PyQt4 中实现“退出”动作？

> ID：12675846
> 
> 赞同：3
> 
> 时间：2012-10-01T15:02:53.943
> 
> 标签：python, pyqt4, exit

许多软件在菜单栏项目中都有“退出”操作。我想知道如何在 pyqt4 中实现它。

我认为仅调用该方法`QtCore.QCoreApplication.quit()`是不够的，因为调用该方法时应用程序主窗口不会立即消失。

我认为为了“退出”，我们不仅应该调用该`quit()`方法，还应该同时关闭应用程序主窗口。

你怎么看 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:57:34.360

默认情况下，应用程序将在最后一个窗口关闭时退出 - 除非[quitOnLastWindowClosed](http://doc.qt.digia.com/4.8-snapshot/qapplication.html#quitOnLastWindowClosed-prop)已设置为`False`.

所以通常只调用`close()`主窗口就足够了。

不过，这里要考虑的另一件事是，在应用程序关闭之前是否应该采取任何最终操作（例如，保存设置、询问用户是否要保存任何修改过的文档等）。

所以重新实现主窗口的[closeEvent](http://doc.qt.digia.com/4.8-snapshot/qwidget.html#closeEvent)函数也很常见。

# android - Motorola Defy 上 JNI 函数的 jdouble 对齐错误

> ID：12675854
> 
> 赞同：0
> 
> 时间：2012-10-01T15:03:15.487
> 
> 标签：android, java-native-interface

在某些设备上，我遇到双值未正确传输到 C++ 的问题。看起来双精度值的第一部分被复制到目标变量的后半部分，而后半部分复制到下一个目标变量的前半部分。

问题：

如何更改 JNI 函数参数的对齐方式？

感兴趣的读者的更多细节：

所有变量在 java 中定义为 double，在 C++ 文件中定义为 jdouble。在所有设备上 ByteOrder.nativeOrder() 报告 LITTLE_ENDIAN。

在普通设备上，我以相反的顺序得到预期的十六进制字符串：

```
1A: 2.25   -> expected: 4002000000000000, found: 0000000000000240 (works) 
```

当调用摩托罗拉 Defy 时，我得到了奇怪的结果。我用 3 个 jdouble 变量调用一个函数。第一次 (1A-1C) 和第二次运行 (2A-2C) 如下所示：

```
1A: 2.25   -> expected: 4002000000000000, found: 005c814000000000
1B: 0.1275 -> expected: 3fc051eb851eb852, found: 0000024052B81E85 (second half of 1B?)
1C: 2.25   -> expected: 4002000000000000, found: EB51C03F00000000 (first half of 1B?)

2A: 5.25   -> expected: 4015000000000000, found: 005C814000000000
2B: 0.3045 -> expected: 3fd37ced916872b1, found: 00001530B1726891 (second half of 2B?)
2C: 5.25   -> expected: 4015000000000000, found: ED7CD33F00000000 (first half of 32?) 
```

对于“预期的”十六进制字符串，我在 Java 中使用 Long.toHexString(Double.doubleToRawLongBits(dV))，给出的结果与使用 Robert 的链接计算的结果相同。

在问题设备（摩托罗拉 Defy）上，“预期”值是相同的，因此 Java 部分似乎工作正常，但 JNI 代码中的“找到”值完全不同。我在这里没有真正看到模式，相同的输入导致不同的输出，并且字节甚至不接近“预期”中的字节。

第一印象是，这些值永远不会设置，它使用该内存位置的任何内容？可能是什么原因以及如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-10T21:01:29.940

通过更改参数的顺序来修复

(JNIEnv *env, jclass thiz, jobject bitmap1, jobject bitmap2, jdouble x1, jdouble y1, jdouble x2, jdouble y2)

到

(JNIEnv *env, jclass thiz, jdouble x1, jdouble y1, jdouble x2, jdouble y2, jobject bitmap1, jobject bitmap2)

看起来位图指针在参数列表的开头或结尾处被不同地对待。

# wpf - WPF-datagrid 滚动条很慢

> ID：12675855
> 
> 赞同：1
> 
> 时间：2012-10-01T15:03:17.280
> 
> 标签：wpf, datagrid, bigdata

我的程序中有datagrid。那个datagrid 包含大约1000 行。当我滚动滚动条时，它的工作非常缓慢，并且不会让用户看到没有爆炸的数据。这是数据网格的定义：（在 xmal 中）

```
 <DataGrid RowHeight="18" ColumnHeaderHeight="22" AlternationCount="2" AutoGenerateColumns="False" Margin="196,62,8,69" Name="dgItems" HeadersVisibility="All"  Loaded="dgItems_Loaded" Opacity="50" ItemsSource="{Binding}" MouseRightButtonDown="dgItems_MouseRightButtonDown" MouseDoubleClick="DataGrid_MouseDoubleClick" CanUserResizeRows="False" CanUserAddRows="False" CanUserDeleteRows="False" CanUserReorderColumns="True" IsReadOnly="True" AllowDrop="True" MouseLeftButtonDown="dgItems_MouseLeftButtonDown" Drop="dgItems_Drop" DragEnter="dgItems_DragLeave" PreviewMouseRightButtonDown="dgItems_PreviewMouseRightButtonDown" AlternatingRowBackground="#AC87CEFA" KeyDown="dgItems_KeyDown" EnableColumnVirtualization="True" IsTextSearchEnabled="True" GridLinesVisibility="None">
        <DataGrid.Background>
            <ImageBrush ImageSource="/MyUI;component/Images/User.png" Stretch="None" TileMode="None" />
        </DataGrid.Background>
        <DataGrid.Columns>
            <DataGridTemplateColumn Header="" Width="5" CanUserReorder="False" CanUserSort="False" CanUserResize="False">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <Grid Background="White">
                        <Button Content="" Name="btnAddit" Visibility="Visible" Height="13" Width="13" Click="btnAddIt_Click" ToolTip="Add to current playlist">
                            <Button.Background>
                                <ImageBrush ImageSource="/MyUI;component/Images/Add.png" />
                            </Button.Background>
                        </Button>
                        </Grid>
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
            <DataGridTextColumn Header="Title"  Binding="{Binding Title}"/>
            <DataGridTextColumn Header="Chapter" Binding="{Binding Chapter}" />
            <DataGridTextColumn Header="Number" Binding="{Binding Number}" />
            <DataGridTextColumn Header="Size" Binding="{Binding Size}" />
            <DataGridTextColumn Header="Language" Binding="{Binding Language}" />
            <DataGridTextColumn Header="Genre" Binding="{Binding Genre}" />
            <DataGridTextColumn Header="Rate" Binding="{Binding Rate}" />
            <DataGridTextColumn Header="Counter" Binding="{Binding Counter}" />
            <DataGridTextColumn Header="ReleaseDate" Binding="{Binding ReleaseDate}" />
            <DataGridTextColumn Header="InsertDate" Binding="{Binding InsertDate}" />
            <DataGridTextColumn Header="LastRead" Binding="{Binding LastRead}" />
        </DataGrid.Columns>
        <DataGrid.RowStyle>
            <Style TargetType="{x:Type DataGridRow}">
                <Setter Property="AllowDrop" Value="True" />
            </Style>
        </DataGrid.RowStyle>
    </DataGrid> 
```

# jquery - 警报信息弹出框

> ID：12675859
> 
> 赞同：0
> 
> 时间：2012-10-01T15:03:36.780
> 
> 标签：jquery

> **可能重复：**
> [jquery 中的消息框](https://stackoverflow.com/questions/4920459/message-box-in-jquery)

有没有类似警报的“信息弹出框”？我想用蓝色感叹号代替黄色三角形。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:08:12.267

您可以使用[jQuery UI - Dialog](http://jqueryui.com/demos/dialog/)以获得更好看的警报样式框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:08:28.007

你必须使用一些插件，它不是 nativ。

我可以建议你：

*   [http://fancybox.net/](http://fancybox.net/)
*   [http://www.99points.info/2010/04/jquery-alert-dialog-boxes-with-demos/](http://www.99points.info/2010/04/jquery-alert-dialog-boxes-with-demos/)
*   [http://smashingspy.com/32-best-jquery-popup-window-dialog-box-example/](http://smashingspy.com/32-best-jquery-popup-window-dialog-box-example/)

# ios6 - 在 IOS6 Simulator ABAddressBookGetAuthorizationStatus() 中总是返回 kABAuthorizationStatusAuthorized

> ID：12675860
> 
> 赞同：3
> 
> 时间：2012-10-01T15:03:37.637
> 
> 标签：ios6, abaddressbook

[这与模拟器中的 ABAddressBookGetAuthorizationStatus 总是返回 kABAuthorizationStatusAuthorized](https://stackoverflow.com/questions/12602984/abaddressbookgetauthorizationstatus-in-simulator-always-returns-kabauthorization)相同的问题，但该答案对我不起作用，我没有足够的声誉来评论该线程:(

在 IOS6 模拟器中`ABAddressBookGetAuthorizationStatus()`总是返回`kABAuthorizationStatusAuthorized`. 我正在寻找一种“重置”模拟器的方法，以便我可以让它询问用户“我尝试过重置

1.  设置->常规->重置中的“重置位置和隐私”和
2.  然后从 OSX 菜单 IOS Simulator->Reset Content and Settings 重置整个模拟器

我仍然总是得到授权

```
if (ABAddressBookGetAuthorizationStatus() == kABAuthorizationStatusAuthorized)
    // I get in here every time
else
    // I NEVER get here, but I should 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T17:09:15.237

似乎`simulator`总是返回被授予，因此不需要权限请求，并且重置也无济于事。

在真实设备上，您可以先获得“ `Not Determined`”，然后是永久的“ `Denied`”或“ `Authorized`”，直到用户转到`Settings > general > reset > reset location & privacy`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T16:32:52.603

这可能是一个愚蠢的问题，但您是否尝试过在模拟器中重置每个应用的隐私设置？

（它们位于：Settings.app / Privacy / Contacts / your-app-here）

# c# - 在不使用 Thread.Sleep c# 的情况下延迟发送电子邮件

> ID：12675864
> 
> 赞同：0
> 
> 时间：2012-10-01T15:03:46.497
> 
> 标签：c#

我有一个 for 循环，它循环并在每个循环中发送一封电子邮件。现在我正在使用 thread.sleep() 但我希望用户仍然能够与程序进行交互，只需 delap 那个循环。是否可以在不使用 thread.sleep 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:07:01.743

您是否在 UI 线程上运行循环？如果是这样，只需使用 Task.Factory.StartNew 在不同的线程中运行您的循环。如果您当时需要延迟发送电子邮件，请在实际开始循环之前放置一个 Thread.Sleep 。

它看起来像这样：

```
private void OnButtonClick(object sender, EventArgs e)
{
    //This code happens on the UI thread
    Task.Factory.StartNew(SendEmails);
}

private void SendEmails()
{
    Thread.Sleep(500);

    foreach(var email in emailAddresses) {
        SendEmail(email);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:05:51.033

您需要将发送邮件的方法放在单独的线程中以保持您的 GUI 交互。

```
Thread newThread = new Thread(new ThreadStart(SendMail));
newThread.Start();

public void SendMail() 
{
    //Send mails here       
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T15:06:04.033

您可以分拆一个新线程来发送电子邮件，这样您就不会锁定 UI 线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T15:06:35.597

尝试将代码转移到后台线程。

# .net - 如何在 HTML 中托管 .net 4 Windows 窗体控件

> ID：12675867
> 
> 赞同：0
> 
> 时间：2012-10-01T15:04:09.353
> 
> 标签：.net, winforms, c#-4.0, controls

我有一个使用 WSDualHttpBinding wcf 服务的 Windows 窗体应用程序。我想要做的是，在网络上显示这个应用程序。我能够在 html 页面上显示 Windows 窗体应用程序控件。为此，我使用 .net 2.0 编译项目并检查项目程序集属性以使其对 COM 访问可见。使用此设置一切正常，但我无法访问我的 wcf 服务。因为项目是框架 2.0 我无法添加服务引用。唯一的可能是添加 Web 参考（旧式 Web 服务），这可能不适用于当前情况。

那你建议我怎么做？

1-我可以使我的 wcf 服务以某种方式可用于 .net 2.0 应用程序 2-我可以使我的控件库在具有 .net 4.0 的浏览器上工作 3-另一种解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:09:24.653

1.  您不能使用 .NET 2.0 进行双重 HTTP 绑定。它只能使用 SOAP Web 服务。
2.  您必须编写一个 ActiveX 控件来托管它，但它不会是跨浏览器的。

# java - Java Swing：嵌套选项卡和布局

> ID：12675872
> 
> 赞同：1
> 
> 时间：2012-10-01T15:04:26.077
> 
> 标签：java, swing, scroll, jtextarea, jtabbedpane

我遇到了下一个 JTabbedPanes 的问题，这让我很困惑。我已将问题隔离为一个简短的演示应用程序（基于 oracle 选项卡式窗格教程）：

```
package main.java;

import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.Font;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTabbedPane;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;

public class TabbedPaneDemo extends JPanel {

public static JTabbedPane topTabs = new JTabbedPane();

public TabbedPaneDemo() {
    super(new BorderLayout());

    topTabs.setPreferredSize(new Dimension(400, 200));

    topTabs.add(makeReadoutPanel("\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15"));

    add(topTabs);
}

private static JTabbedPane makeReadoutPanel(String text) {
  // Create tabbed pane
  JTabbedPane tabs = new JTabbedPane();
  tabs.setName("Tabs");

  // Create text field
  JTextArea textArea = new JTextArea(text);
  textArea.setEditable(false);
  textArea.setFont(new Font("Monospaced", Font.PLAIN, 14));

  // Create first panel for text field
  JPanel textPanel = new JPanel();
  textPanel.setLayout(new BorderLayout());
  textPanel.setName("Text Panel");
  textPanel.add(textArea, BorderLayout.CENTER);

  // Add text field panel to tabs
  tabs.add(textPanel);

  return tabs;
}

private static void createAndShowGUI() {
    //Create and set up the window.
    JFrame frame = new JFrame("TabbedPaneDemo");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    //Add content to the window.
    frame.add(new TabbedPaneDemo(), BorderLayout.CENTER);

    //Display the window.
    frame.pack();
    frame.setVisible(true);
}

public static void main(String[] args) {
    //Schedule a job for the event dispatch thread:
    //creating and showing this application's GUI.
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
          //Turn off metal's use of bold fonts
          UIManager.put("swing.boldMetal", Boolean.FALSE);
          createAndShowGUI();
        }
    });
}
} 
```

当它运行时，JTextArea 被截断，没有滚动条，而不是垂直于面板。textPanel 中的 BorderLayout 不应该将文本区域大小设置为选项卡吗？这只发生在嵌套选项卡上：如果我只使用单级选项卡，则文本区域适合。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T15:07:59.070

您需要将 JTextArea 添加到 JScrollBar 的视口，然后将其添加到 JTabbedPane 持有的组件中。

```
JPanel textPanel = new JPanel();
textPanel.setLayout(new BorderLayout());
textPanel.setName("Text Panel");

// **** note change:
textPanel.add(new JScrollPane(textArea), BorderLayout.CENTER); 
```

请注意，将组件（此处为 JTextArea）添加到视口有两种常用方法。一种是如上所述将其传递给 JSrollPane 的构造函数，另一种是调用`setViewportView(...)`已创建的 JScrollPane，将组件传入方法的参数中。无论您做什么，都不要将 JTextArea 传递到已经创建的 JScrollPane 及其`add(...)`方法中，因为您将删除滚动窗格的视口，这将阻止它正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T15:10:40.957

您根本没有使用 a `JScrollPane`。改变这个：

```
JPanel textPanel = new JPanel();
textPanel.setLayout(new BorderLayout());
textPanel.setName("Text Panel");
textPanel.add(textArea, BorderLayout.CENTER); 
```

对此：

```
JPanel textPanel = new JPanel();
textPanel.setLayout(new BorderLayout());
textPanel.setName("Text Panel");
textPanel.add(new JScrollPane(textArea), BorderLayout.CENTER); // Changed 
```

不使用 a `JScrollPane`，您将不会获得滚动条。有关. [_](http://docs.oracle.com/javase/tutorial/uiswing/components/scrollpane.html) _ `JScrollPane`另外，作为参考，[Swing 组件的视觉指南](http://docs.oracle.com/javase/tutorial/ui/features/components.html)。

# .net - 是否可以在 WPF 浏览器应用程序中使用 DependencyProperty？

> ID：12675876
> 
> 赞同：0
> 
> 时间：2012-10-01T15:04:32.317
> 
> 标签：.net, wpf, xaml, dependency-properties, xbap

我是 WPF 的新手，我正在尝试将我的一个应用程序从 windows 应用程序更改为浏览器应用程序。在浏览器应用程序中，我们使用页面而不是窗口。所以我想知道我是否仍然可以使用依赖属性。这是我在 WPF Windows 应用程序中的代码：

```
 public static readonly DependencyProperty KinectSensorManagerProperty =
       DependencyProperty.Register(
           "KinectSensorManager",
           typeof(KinectSensorManager),
           typeof(MainWindow),
           new PropertyMetadata(null));

    public KinectSensorManager KinectSensorManager
    {
        get { return (KinectSensorManager)GetValue(KinectSensorManagerProperty); }
        set { SetValue(KinectSensorManagerProperty, value); }
    } 
```

因此，我可以在浏览器应用程序中使用相同的代码吗？如果不是，替代品是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:26:13.737

我没有看到 XBAP 不支持`DependencyProperties`，你可以访问这个 [链接](http://blog.wpfwonderland.com/2007/01/28/comparing-wpf-applications-and-xbap-whats-the-difference/)

# php - MySQL 使用 LIKE 命令在分号之间查找

> ID：12675882
> 
> 赞同：3
> 
> 时间：2012-10-01T15:04:44.230
> 
> 标签：php, mysql

这是我的数据

```
385_white   99  swarovski   12  black;blue
386_white   99  swarovski   12  black;blue;green
387_white   99  swarovski   12  yellow;green
389_white   99  swarovski   12  white;silver
385_white   99  swarovski   12  silver 
```

这是一个示例查询

```
SELECT *  FROM `products` WHERE `category` LIKE 'swarovski' AND `colours` LIKE 'silver' 
```

返回的结果为空。如果用户有黑色，那么它应该返回两个第一条记录。我无法编辑`color;color;color`格式。这在这个时候是收费的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T15:09:43.857

像这样的非规范化模式的惩罚是您必须对查询做更多的工作以确保准确匹配：

```
SELECT *  
FROM `products` 
WHERE `category` = 'swarovski' 
AND (
    `colours` = 'silver' 
    OR `colours` LIKE 'silver;%' 
    OR `colours` LIKE '%;silver;%' 
    OR `colours` LIKE '%;silver' 

) 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!2/58f66/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T16:09:00.380

我更喜欢做一个比较：

```
SELECT *  
FROM `products` 
WHERE `category` = 'swarovski' and
      concat(';', `colours`, ';') like ';silver;' 
```

也就是说，将分隔符添加到列的开头和结尾，然后执行单个`like`.

# javascript - dojo对话框中的滚动条在IE9中不起作用

> ID：12675885
> 
> 赞同：1
> 
> 时间：2012-10-01T15:04:56.017
> 
> 标签：javascript, dojo, dialog, scrollbar, arcgis

我的 web 应用程序中有一个对话框弹出框（使用带有 Dojo 的 ArcGIS Javascript API）。在 Firefox 中，我得到一个正常运行的滚动条，但在 IE 中，有一个滚动条，但它不起作用……我可以向上/向下箭头滚动，但是当我这样做时，对话框会闪烁并结结巴巴。 ...有什么建议么？谢谢，杰森

代码：

```
 infoBox = new dijit.Dialog({
    //title: "Information",
    id: "info",
    content: infoText,
    style: "width: 450px; height: 380px; overflow: auto",
    autofocus: !dojo.isIE, // NOTE: turning focus ON in IE causes errors when  reopening the dialog
    refocus: !dojo.isIE
    //autofocus: false, // I tried this alternative, but it didn't help
    //refocus: false

    }); 
```

（在我的设置中，我有： meta http-equiv="X-UA-Compatible" content="IE=7", "IE=9" / ）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T07:33:14.567

试试这个代码：

```
domStyle.set(infoBox.containerNode, {
    position: 'relative'
}); 
```

在顶部添加以下代码 -

```
require(["dojo/dom-style"], function(domStyle){ domStyle.get(node, style); domStyle.set(node, style, value); }); 
```

# c# - 正则表达式匹配字符串中的逗号

> ID：12675887
> 
> 赞同：4
> 
> 时间：2012-10-01T15:05:11.847
> 
> 标签：c#, regex

我需要 a 来匹配字符串中的逗号，这是示例：

> dog:Cat,hi:Bye,num:,1,2,3,5,6,7,8,9,10,this:that

![图片](../Images/d5dc9d028f3a738eaecf5ea31d21e0d3.png)

我只想使用正则表达式或其他东西将逗号与绿色箭头匹配

> “num:”的值总是相似的。例如“num:,4,7,9”或“num:,2”

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-01T15:07:03.023

这应该这样做：

```
,(?=\w+:) 
```

*   正则表达式演示：[http ://www.rubular.com/r/pv2lgKTO0m](http://www.rubular.com/r/pv2lgKTO0m)
*   C# 代码示例：http: [//ideone.com/vwX7O](http://ideone.com/vwX7O)

# javascript - HTML5 仅旋转图像而不是画布上下文

> ID：12675893
> 
> 赞同：3
> 
> 时间：2012-10-01T15:05:32.130
> 
> 标签：javascript, jquery, html

有没有办法在画布内旋转图像？我唯一能找到的就是旋转画布的整个上下文。我想在画布上独立旋转图像。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T15:10:35.057

不幸的是，您不能直接旋转图像。

如果您想在位置 X,Y 以角度 A（弧度）旋转并在图像中间显示一个宽度为 W 和高度为 H 的图像，您可以执行以下操作：

```
ctx.translate(-X - W / 2, -Y - H / 2);
ctx.rotate(A);
ctx.drawImage(YOUR_IMAGE, 0, 0);
ctx.rotate(-A);
ctx.translate(X + W / 2, Y + H / 2); 
```

# botnet - 来自特定 IP 地址的命中率异常高

> ID：12675898
> 
> 赞同：-1
> 
> 时间：2012-10-01T15:05:52.113
> 
> 标签：botnet

我的网站从一定范围的 IP 地址中获得了非常多的点击量。大多数情况下，它只是主页。

这是上周（数字代表点击量）

```
81.251.164.132  1689    Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.165.14   999 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.166.201  263 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.167.46   65  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.168.251  59  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.170.36   908 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.172.253  365 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.173.9    88  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.174.243  688 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.189.194  19  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.189.204  1165    Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.190.31   21  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.190.71   1655    Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.37.185   680 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.37.211   707 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.39.198   18  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.39.36    16  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.39.51    18  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.41.201   1580    Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.42.160   100 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.42.3 593 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.45.166   52  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.57.21    88  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.57.30    1275    Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)
81.251.63.20    1169    Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0) 
```

会是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:08:13.063

这似乎是一个机器人，你可以在这里看到 Spamhaus PBL 上列出的第一个 IP：

[http://www.spamhaus.org/query/ip/81.251.164.132](http://www.spamhaus.org/query/ip/81.251.164.132)

# security - 如何使用 OVAL 查找 CVE

> ID：12675899
> 
> 赞同：1
> 
> 时间：2012-10-01T15:05:52.833
> 
> 标签：security

我需要一种为特定平台（而不仅仅是桌面操作系统平台）查找 CVE 的方法。一直在查看 CVE 和 NVD 网站，看到了一个叫做 OVAL 的东西。有什么好处吗？

这个想法是用户在我的网站上设置他的操作系统/软件及其版本号，然后我检查漏洞数据库以查看他当前的操作系统或软件是否容易受到攻击。有没有人有这方面的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-21T02:15:45.327

OVAL（[开放漏洞和评估语言](https://oval.mitre.org)）很棒。它代表了安全自动化的未来。

使用 OVAL 有两个部分。语言本身定义了可以在计算机上观察到的不同类型的状态：文件模式、文件权限、注册表项等。这些状态组合成测试和定义。例如，您可以通过查找某些文件和注册表项的存在来检测是否存在单个已知漏洞。这是[一个 OVAL 定义的示例](http://scapsync.com/oval_definition/oval%3aorg.mitre.oval%3adef:14146)。

一旦定义了*内容*，就需要一个 OVAL 解释器工具来处理这些规则并实际评估它们并报告结果。大多数高端扫描产品都可以使用 OVAL 内容——尤其是财富 500 强中使用的扫描仪类型——但也有一些开源的 OVAL 解释器：

*   [http://oval.mitre.org/language/interpreter.html](http://oval.mitre.org/language/interpreter.html)
*   [http://sourceforge.net/projects/ovaldi/](http://sourceforge.net/projects/ovaldi/)

# iphone - 在带有 OR 的 IF 语句中使用 isEqualToString

> ID：12675910
> 
> 赞同：-3
> 
> 时间：2012-10-01T15:06:27.793
> 
> 标签：iphone, objective-c, nsstring

我正在使用下一个代码来检查 string 是否不等于 value ：

```
if (![myString  isEqualToString:@"text1"])
//DO SOMETHING 
```

现在我正在尝试将 2 个或更多字符串与此代码进行比较：

```
if (![myString isEqualToString:@"text1"] || ![myString isEqualToString:@"text2"])
//DO SOMETHING 
```

它不工作......当我将它分成 2 个 IF 语句它工作时，这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:07:45.150

您需要将 a`||`用于 OR。

例如`if (![myString isEqualToString:@"text1"] || ![myString isEqualToString:@"text2"])`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:12:34.653

如果您想在 myString 不是这些值中的任何一个（这里唯一有意义的事情）时做某事，您可以使用：

```
 if (![myString isEqualToString:@"text1"] && ![myString isEqualToString:@"text2"])
      // DO SOMETHING 
```

这使用了`&&`运算符，这意味着它们都必须为真。例如“myString 不是 text1 **，** myString 不是 text2”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T15:08:06.653

利用：

```
if (![myString isEqualToString:@"text1"] || ![myString isEqualToString:@"text2"]) 
```

但是这个逻辑有些奇怪。如果它不是`text1`或它不是`text2`总是保证是真的，因为它不能同时是两者。我强烈建议您检查您的逻辑条件。

听起来你想检查它是否不是`text1`or `text2`，在这种情况下，代码应该是：

```
if (! ([myString isEqualToString:@"text1"] || [myString isEqualToString:@"text2"]) ) 
```

# php - 这个 bindValue 错了吗？

> ID：12675914
> 
> 赞同：0
> 
> 时间：2012-10-01T15:06:37.657
> 
> 标签：php, pdo, pdostatement, bindvalue

我有`PDO statement`如下（**AFAIK**，PDO 不需要数据来`escaped`准备）：

```
$insert = "INSERT INTO `errors`(`code`,`number`,`title`,`message`) VALUES( :code, :num, :title, :err )";
$arr = Array(
    Array( ':code', $_POST['code'], 'PDO::PARAM_STR' ),
    Array( ':num', $_POST['number'], 'PDO::PARAM_INT' ),
    Array( ':title', $_POST['title'], 'PDO::PARAM_STR' ),
    Array( ':err', htmlentities( str_replace("\n", "<br />", $_POST['error']), ENT_HTML5, 'UTF-8' ), 'PDO::PARAM_STR' )
);
$stmt = $conn->prepare($insert);
foreach( $arr as $a ) {
    $stmt->bindValue( $a[0], $a[1], $a[2] );
}
$stmt->execute();
$stmt->debugDumpParams(); 
```

这段代码什么都不做。但它确实会生成这样的转储：

```
SQL: [91] INSERT INTO `errors`(`code`,`number`,`title`,`message`) VALUES( :code, :num, :title, :err )
Params:  0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:08:56.417

绑定参数的类型信息是 a `constant`，而不是*string*：

```
Array( ':code', $_POST['code'], PDO::PARAM_STR )
//                             ^              ^ no quotes 
```

**更新**

数组应如下所示：

```
$arr = Array(
    Array( ':code', $_POST['code'], PDO::PARAM_STR ),
    Array( ':num', $_POST['number'], PDO::PARAM_INT ),
    Array( ':title', $_POST['title'], PDO::PARAM_STR ),
    Array( ':err', htmlentities( str_replace("\n", "<br />", $_POST['error']), ENT_HTML5, 'UTF-8' ), PDO::PARAM_STR )
); 
```

# php - google drive api 访问代码寿命

> ID：12675916
> 
> 赞同：1
> 
> 时间：2012-10-01T15:06:37.963
> 
> 标签：php, oauth-2.0, google-drive-api

当基于 google drive api 的应用程序获得批准后，访问代码的有效期是多久？

我可以将此代码保存在我的应用程序中并重复使用它以避免需要人工重复授权吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T23:27:16.570

访问令牌会在一小时后过期，而刷新令牌（可用于请求新的访问令牌）会持续到用户撤销对应用程序的访问权限。

建议您为用户将来的请求存储刷新令牌，但应考虑到令牌随时可能无效并做出相应反应。

有关如何在 Google Drive 应用程序中处理授权的更多详细信息，请查看[https://developers.google.com/drive/credentials](https://developers.google.com/drive/credentials)

# php - 基于搜索结果的上一条/下一条记录

> ID：12675917
> 
> 赞同：0
> 
> 时间：2012-10-01T15:06:42.453
> 
> 标签：php, postgresql, pagination, paging

## 一些背景

所讨论的系统有大约一万条记录，允许用户通过不同搜索标准的“大量”阵列浏览或搜索。然后将结果显示在分页表中，范围从几页到数据库中的每个结果。

如果用户进行了大量过滤并最终得到结果并单击任意记录，则她将被带到一个新视图`/edit/{record_id}`，在那里她可以查看该记录的所有详细信息。随时返回上一个搜索结果很容易，因为条件保留在搜索栏中，但是：

## 我想要达到的目标

如果用户要根据搜索结果进行大量更改，使用上一个和下一个按钮访问相邻记录而不返回结果会*非常方便。*

我已经能够使用`id`s在基本级别上做到这一点

```
SELECT table.*, pn.p as previous_question, pn.n as next_question
   from table,
   (
       SELECT id, lead(id) OVER w as n, lag(id) OVER w as p
       FROM table
       window w as (order by id $order)
   ) as pn
   where table.id = $id
       and pn.id = $id 
```

这显然只适用于记录与数据库中的顺序相同的最简单的情况。我想要的是让他们在*每种*数据顺序情况下都能工作。不用说，对这些数据进行排序的方法几乎是无限的。

## 我一直在想什么

**创建某种函数/工具**，让我不让搜索 SQL 并像上面一样再次执行它，只使用搜索条件和偏移量而不是`id`s

**将结果中所有记录的顺序**列表保存**`$_SESSION`在, 数据库或其他地方，然后简单地遍历列表以获取`id`我需要的 s。**

 **## 手头的工具

PHP、PostgreSQL、JS/jQuery。

## TL;博士

无论用户单击“下一步”多少次，我都希望能够在不返回搜索的情况下获得下一个搜索结果。

# ----------

任何输入将不胜感激。相关文章的链接、处理方法甚至整个shebang ;)。能够在不吃掉所有服务器内存或过多的数据库访问的情况下解决这个问题也很好，尽管资源在这里并不是真正的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:13:03.057

我只是要把它扔在那里......你应该使用**Solr**或类似的东西，特别是如果这是一个[SAS](http://en.wikipedia.org/wiki/Software_as_a_service)并且暴露给许多用户。

基本上尝试跟踪分页搜索结果然后遍历将导致您的应用程序中的大量状态管理。

Solr（甚至只是简单的 postgres）的想法是为您的搜索（又名**OFFSET**和**LIMIT**）做一个开始和大小。Solr 的速度如此之快，几乎不是性能问题。只需确保您对 Solr 或 Postgres 进行可预测的排序（又名**ORDER BY**）。

如果您担心添加新项目会导致分页消失，那就是：`WHERE create time stamp is less than when we did the initial search`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T04:08:26.923

我在这里看到了很多可能的问题。最重要的是您正在尝试将无状态的 HTTP 请求映射到有状态的数据库操作，并且您正在尝试尽可能无状态地执行此操作。

我认为 REST 方面的优雅解决方案是使用导航按钮（后退 esp）和向下钻取以获取特定的详细记录。这样就可以将基本结果持久化在客户端，即浏览器缓存中。

通过这种方式，您必须使用后退按钮才能返回（可能是分页的）摘要搜索结果，但您不必回击即可返回搜索条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-22T06:32:14.457

存储搜索上下文，包括选定的过滤器、查询和排序顺序。可以选择按内容散列存储它们，以便最终获得唯一的搜索上下文列表。

在详细信息页面的链接中包含指向已保存搜索上下文的链接，使用某种哈希。

在详细信息页面上，通过散列检索搜索上下文并执行两个额外的搜索，一个在同一方向上前进，另一个在后退。通过在排序顺序定义中交换 asc 和 desc 来做到这一点。

在这两种情况下，将结果限制为 1 条记录，并添加一个附加子句以确保不包括当前详细记录。

这应该为您提供上一个和下一个链接的正确记录。

可以在此处找到 Elasticsearch 的更详细答案： [https ://stackoverflow.com/a/42384125/401467](https://stackoverflow.com/a/42384125/401467)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-01T15:47:59.987

解决这个问题的方法并不多。

1 - 因为您的查询是动态构建的，所以您必须坚持条件并在每次提供 LIMIT ... OFFSET 时执行查询，或者直接使用 result_id（在`WITH`子句中使用 row_number 窗口函数）。

2 - 您可以直接将结果集保存在服务器中，我不建议使用会话来存储这么多的数据。

3 - 或者您可以将集合保存在客户端，在 Json 中发送整个结果集并使用 angularjs 或主干js 之类的 Javascript 浏览它。我想如果你返回 10k 行，这也会很慢。

我建议1或3。**

# c - C 中的动态数组——我对 malloc 和 realloc 的理解正确吗？

> ID：12675919
> 
> 赞同：31
> 
> 时间：2012-10-01T15:06:43.880
> 
> 标签：c, arrays, malloc, realloc

我正在学习如何在 C 中创建动态一维数组。下面的代码尝试执行以下操作：

1.  使用`malloc`，创建一个长度的动态数组`10`，其中包含类型的值`double`。
2.  将数组的每个条目设置为`j/100`for `j = 0, 1,..., 9`。然后打印出来。
3.  使用 . 在数组末尾添加一个额外的空条目`realloc`。
4.  将新条目设置为`j/100`并再次打印出每个条目。

测试：

```
 double* data = (double*)malloc(10*sizeof(double));

 for (j=0;j<10;j++)
 {
      data[j]= ((double)j)/100;
      printf("%g, ",data[j]);
 }

 printf("\n");

 data = (double*)realloc(data,11*sizeof(double));

 for (j=0;j<11;j++)
 {
     if (j == 10){ data[j]= ((double)j)/100; }
     printf("%g, ",data[j]);
 }

 free((void*) data); 
```

**问题**

1.  我编码对吗？

2.  我发现教程`malloc`没有放在`(double*)`前面。例如，

    整数 * 指针；
    指针 = malloc(2*sizeof(int));

这不适用于我在 Visual Studio 2010、Windows 7 上编译。错误消息是

> void 类型的值不能分配给 类型的实体`int`。

为什么它适用于那些教程而不适用于我？我是否正确猜测这是因为他们使用的编译器`(int*)`在我的示例中自动为他们填写？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-10-01T15:18:18.167

你很近。

在 C 中（至少从 1989 版标准开始）， and 之前`malloc`的`realloc`强制转换是不必要的，因为 C 可以将类型的值转换`void *`为`int *`没有强制转换的值。这*不适*用于 C++，因此根据您遇到的错误，听起来您正在将此代码编译为 C++ 而不是 C。查看 VS2010 的文档以确定如何将代码编译为 C。

以下是我编写`malloc`电话的首选风格：

```
double *data = malloc(10 * sizeof *data); 
```

由于表达式的类型`*data`是`double`,`sizeof *data`等价于`sizeof (double)`。这也意味着如果类型发生变化，您不必调整`malloc`呼叫。`data`

至于`realloc`调用，将结果分配给临时指针值更安全。 `realloc`如果它不能扩展缓冲区，将返回 NULL，所以写起来更安全

```
double *tmp;
...
tmp = realloc(data, 11 * sizeof *data);
if (!tmp)
{
  // could not resize data; handle as appropriate
}
else
{
  data = tmp;
  // process extended buffer
} 
```

请注意，Microsoft 对 C 的支持以该语言的 1989 版本结束；从那时起，该语言标准进行了两次修订，引入了一些新功能并弃用了旧功能。因此，虽然一些 C 编译器支持 C99 特性，如混合声明和代码、可变长度数组等，但 VS2010 不支持。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-01T15:11:18.413

> 1）我编码对吗？

大多。但是`data = (double*)realloc(data,11*sizeof(double));`如果失败会丢失对分配内存的引用`realloc`，您应该使用临时指针来保存返回值`realloc`并检查它是否是`NULL`（并且您还应该检查返回值`malloc`）。

> 2) 我发现的教程使用 malloc 而不将 (double*) 放在前面。

在 C 中，`malloc`返回 a`void*`可以隐式转换为任何其他指针类型，因此不需要强制转换（并且由于强制转换可以隐藏错误而被广泛反对）。Visual Studio 显然将代码编译为需要强制转换的 C++。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-01T15:09:25.817

在 C 中，您不应该强制转换`malloc()`.

此外，在`malloc()`参数中编码类型也是一个坏主意。这是一个更好的方法：

```
double* data = malloc(10 * sizeof *data); 
```

# vba - PPT中可以使用VBA代码从剪贴板粘贴到PNG吗？

> ID：12675927
> 
> 赞同：1
> 
> 时间：2012-10-01T15:07:03.237
> 
> 标签：vba, powerpoint

我已经尝试了许多版本来获取此代码。这至少出错了...我想在 PowerPoint 中，从剪贴板选择性粘贴到 PNG。

```
Sub Test()
ActivePresentation.Slides.Paste.Shapes.PasteSpecial ppPastePNG

End Sub 
```

这个错误出来说

> “请求无效。剪贴板为空或包含可能无法粘贴到此处的数据。”

剪贴板不是空的，并且包含我可以粘贴的数据。

感谢您的任何想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-17T14:55:18.153

仅供参考 - 经过多次试验和错误，我想出了这个宏。它复制幻灯片内容并将其以 PNG 格式粘贴回幻灯片。

```
Sub test()
Dim sld As Slide
Dim pre As Presentation
Dim shp1 As Shape
Dim shp2 As Shape

Set pre = ActivePresentation

For Each sld In pre.Slides
    Set shp1 = sld.Shapes.AddShape(msoShapeRectangle, 0, 0, 20, 20)
    shp1.Line.Visible = msoFalse
    shp1.Fill.Transparency = 1

Set shp2 = sld.Shapes.AddShape(msoShapeRectangle, 0, 0, 20, 20)
shp2.Left = 720 - shp2.Width
shp2.Top = 540 - shp2.Width
shp2.Line.Visible = msoFalse
shp2.Fill.Transparency = 1
Next

For Each sld In pre.Slides
     sld.Shapes.Range.Cut

If sld.Shapes.Count > 0 Then
   sld.Shapes.Range.Delete
   sld.Shapes.PasteSpecial ppPastePNG
   sld.Shapes.Range.Align msoAlignCenters, msoTrue
   sld.Shapes.Range.Align msoAlignMiddles, msoTrue
End If

If sld.Shapes.Count = 0 Then
sld.Shapes.PasteSpecial ppPastePNG
sld.Shapes.Range.Align msoAlignCenters, msoTrue
sld.Shapes.Range.Align msoAlignMiddles, msoTrue
End If
Next

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-15T02:23:31.547

简单的回答：

```
Set m = ActivePresentation
n = m.Slides.Count
m.Slides.Add n + 1, ppLayoutBlank
m.Slides(2).Shapes.PasteSpecial ppPastePng 
```

PowerPoint 上的 msdn 参考页：
“形状”粘贴格式： http:
[//msdn.microsoft.com/en-us/library/office/ff745158 (v=office.15).aspx](http://msdn.microsoft.com/en-us/library/office/ff745158(v=office.15).aspx)

新幻灯片版式： http:
[//msdn.microsoft.com/en-us/library/office/ff745137 (v=office.15).aspx](http://msdn.microsoft.com/en-us/library/office/ff745137(v=office.15).aspx)

或者，如果需要纯文本：

```
m.Slides.Add n + 1, ppLayoutText
m.Slides(n + 1).Shapes(2).TextFrame.TextRange.PasteSpecial (ppPasteText) 
```

“textrange”粘贴特殊格式： http:
[//msdn.microsoft.com/en-us/library/office/ff745706 (v=office.15).aspx](http://msdn.microsoft.com/en-us/library/office/ff745706(v=office.15).aspx)

甚至将文本放入变量中：

```
 myVar = m.Slides(1).Shapes(1).TextFrame.TextRange.Text 
```

“textrange”文本属性： http:
[//msdn.microsoft.com/en-us/library/office/ff746239 (v=office.15).aspx](http://msdn.microsoft.com/en-us/library/office/ff746239(v=office.15).aspx)

PS
小写也可以用于属性或方法，尽管它们在文档中都是大写字母。
函数调用的括号可以省略，如上面的第一个代码块。

# jquery - jquery 1.6.2/jquery.min.js 和foundation2/jquery.min.js

> ID：12675931
> 
> 赞同：0
> 
> 时间：2012-10-01T15:07:12.953
> 
> 标签：jquery, zurb-foundation

我尝试使用一些带有 jquery 的项目，例如：

[http://awardwinningfjords.com/2009/06/16/iphone-style-checkboxes.html](http://awardwinningfjords.com/2009/06/16/iphone-style-checkboxes.html)

和基础框架 [http://foundation.zurb.com/](http://foundation.zurb.com/)

问题是：我认为基础框架有 jquery min 不同

```
<script src="oundation2/jquery.min.js"></script> 
```

顶部的示例使用：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" type="text/javascript"></script> 
```

当我删除：`<script src="foundation2/jquery.min.js"></script>`

效果完美，但我无法删除，因为我的网站需要基础框架。

一些帮助如何解决这个冲突？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T03:01:20.480

我不确定 SO 中是否存在故障，或者您的问题格式不正确，但这部分并没有给出太多内容；）

> 顶部的示例使用：
> 
> 当我删除：

无论如何，@user964836 已经给了你答案 - 只需组织资源引用。

但是更详细地说，使用当前的基础版本（撰写本文时为 3.2.5）我已经复制了您的问题，并通过简单地移动这一行（就在关闭 body 标签之前）解决了它：

```
<script src="javascripts/foundation.min.js"></script> 
```

在任何对 iPhone 复选框资源的引用之前，直到头部。

# c++ - 获得晋升类型

> ID：12675932
> 
> 赞同：-1
> 
> 时间：2012-10-01T15:07:13.600
> 
> 标签：c++, template-meta-programming

如何获得两个操作数的提升类型？

这可能对这样的代码有用：

```
template <typename LHS, typename RHS>
bool would_overflow_upon_addition (LHS lhs, RHS rhs) {
    return lhs > std::numeric_limits<promoted<LHS,RHS>::type>::max()-rhs;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:53:54.460

[`common_type`](http://en.cppreference.com/w/cpp/types/common_type)应该是你的答案：

```
#include <type_traits>

typedef std::common_type<LHS, RHS>::type ctype; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:07:13.600

这实际上比人们想象的要简单：

```
template <typename LHS, typename RHS>
bool would_overflow_upon_addition (LHS lhs, RHS rhs) {
    return lhs > std::numeric_limits<decltype(lhs+rhs)>::max()-rhs;
} 
```

`decltype(X)`不评估，只是`X`派生的静态类型^*

* * *

^(* 所以不会发生“编译时溢出”或“编译时未定义行为”)

# javascript - 如何在不使用回发的情况下重置变量并重建 DropDownList

> ID：12675934
> 
> 赞同：0
> 
> 时间：2012-10-01T15:07:21.133
> 
> 标签：javascript, asp.net

我已经有这个问题很长时间了，我试图通过 DropDownList 从一个人那里获取用户输入。它似乎第一次工作（回发后）。但是当我试图让用户从 DropDownList 中选择一个新值时，它似乎默认回到我之前选择的值。我的问题是如何让 javascript 代码将变量重新分配给当前新选择的值。如果我进行回发，它似乎可以工作，因为它会被刷新。但是我不想每次都回发。

这是我的javascript代码：

```
function getCaseFiles(canMoveExpenses) {
        //create Popup with content from div
        $('#ddlFiles').dialog({
            autoOpen: true,
            height: 'auto',
            width: 'auto',
            modal: true,
            buttons: {
                "Ok": function () {
                    debugger;
                    var dropDownList = document.getElementById("ddlCaseFilesNew");
                    var newCaseDdl = dropDownList.options[dropDownList.selectedIndex].value;
                    //alert("newCaseDdl = " + newCaseDdl);

                    var oldCaseFile = $("#hidCaseFile").val();//<asp:HiddenField id="hidCaseFile">
                    //alert(oldCaseFile);

                    if (newCaseDdl != -1) {
                        moveCasefile(canMoveExpenses, newCaseDdl, oldCaseFile);
                        $(this).dialog('close');
                        $("#viewExpensesGrid").flexReload();
                    }
                    else {
                        showMessage("Error. Please Select a Value From The Lists.");
                    }
                },
                Cancel: function () {
                    $(this).dialog('close');
                    $("#viewExpensesGrid").flexReload();
                }
            }
        });
    } 
```

这是我的 DropDownList div：

```
<div id="ddlFiles">
    <label>
        Select new CaseFile:</label>
    <asp:DropDownList runat="server" ID="ddlCaseFilesNew" DataSourceID="dsCaseFiles"
        DataTextField="Display" DataValueField="FileID" 
        OnPreRender="ddl_PreRender" Width="300px"/>
</div> 
```

我的函数调用此 div 并将其放置在自定义弹出窗口中。

如果不是回发，似乎我包含 selectedIndex 的变量不会被更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:20:58.187

你有一个有趣的纯 JS 和 jQuery 代码组合。看来问题出在这里：

```
var newCaseDdl = dropDownList.options[dropDownList.selectedIndex].value; 
```

`$(document).ready`触发时保存此值。
试试这条线：

```
var newCaseDdl = $("#ddlCaseFilesNew").val(); 
```

注意：如果您使用母版页，此元素的 ID 将如下所示：`ctl00$ddlCaseFilesNew`。
有几种方法可以避免它：指定`name`或`class`属性，并更改选择器：`$("[name=ddlCaseFilesNew]").val();`或`$(".ddlCaseFilesNew").val();`
第二种是`ClientIDMode="Static"`在页面或控件上指定。

# python - 寻找对角线数

> ID：12675938
> 
> 赞同：1
> 
> 时间：2012-10-01T15:07:32.113
> 
> 标签：python, list, multidimensional-array

所以我在这里有这个数组：

```
t = [[8,2,22,97,38,15,0,40,0,75,4,5,7,78,52,12,50,77,91,8],
     [49,49,99,40,17,81,18,57,60,87,17,40,98,43,69,48,4,56,62,0],
     [81,49,31,73,55,79,14,29,93,71,40,67,53,88,30,3,49,13,36,65],
     [52,70,95,23,4,60,11,42,69,24,68,56,1,32,56,71,37,2,36,91],
     [22,31,16,71,51,67,63,89,41,92,36,54,22,40,40,28,66,33,13,80],
     [24,47,32,60,99,3,45,2,44,75,33,53,78,36,84,20,35,17,12,50],
     [32,98,81,28,64,23,67,10,26,38,40,67,59,54,70,66,18,38,64,70],
     [67,26,20,68,2,62,12,20,95,63,94,39,63,8,40,91,66,49,94,21],
     [24,55,58,5,66,73,99,26,97,17,78,78,96,83,14,88,34,89,63,72],
     [21,36,23,9,75,0,76,44,20,45,35,14,0,61,33,97,34,31,33,95],
     [78,17,53,28,22,75,31,67,15,94,3,80,4,62,16,14,9,53,56,92],
     [16,39,5,42,96,35,31,47,55,58,88,24,0,17,54,24,36,29,85,57],
     [86,56,0,48,35,71,89,7,5,44,44,37,44,60,21,58,51,54,17,58],
     [19,80,81,68,5,94,47,69,28,73,92,13,86,52,17,77,4,89,55,40],
     [4,52,8,83,97,35,99,16,7,97,57,32,16,26,26,79,33,27,98,66],
     [88,36,68,87,57,62,20,72,3,46,33,67,46,55,12,32,63,93,53,69],
     [4,42,16,73,38,25,39,11,24,94,72,18,8,46,29,32,40,62,76,36],
     [20,69,36,41,72,30,23,88,34,62,99,69,82,67,59,85,74,4,36,16],
     [20,73,35,29,78,31,90,1,74,31,49,71,48,86,81,16,23,57,5,54],
     [1,70,54,71,83,51,54,69,16,92,33,48,61,43,52,1,89,19,67,48]] 
```

这只是一个二维列表，我需要做的是以任何方式找到与数字对角线的四个数字。

我使用 xy 坐标获取数字，然后获取它周围的数字，我认为这很容易。

我尝试做的是获取数字，然后找到其他 3 个数字，我这样做四次，每个方向

这是我尝试让它工作的代码，但它不想得到正确的数字。

```
def getD(t,x,y):
    z = [[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]
    xm = 1
    ym = 1
    for a in range(0,4):
        if a == 0:
            xm = 1
            ym = 1
        elif a == 1:
            xm = 1
            ym = -1
        elif a == 2:
            xm = -1
            ym = 1
        elif a == 3:
            xm = -1
            ym = -1
        for b in range(0,4):
            z[a][b]=t[y+(b*ym)][x+(b+xm)]
    print z 
```

`ym``xm`是我们要移动的方向，所以如果是`xm`-1，就向左，如果是1，就向右，如果`ym`是-1，就向下，否则向上。

有人有办法做到这一点吗？

如果我这样做`getD(t, 0, 0)`了，我会回来`[[2, 99, 73, 4], [2, 54, 29, 72], [8, 49, 49, 95], [8, 1, 73, 36]]`

我将如何发出无效的？例如，当它是`getD(t,0,0)`并且我只想要向下和向右的对角线，因为其他人不可能是正确的？

* * *

这是数组的格式化版本

```
08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08
49 49 99 40 17 81 18 57 60 87 17 40 98 43 69 48 04 56 62 00
81 49 31 73 55 79 14 29 93 71 40 67 53 88 30 03 49 13 36 65
52 70 95 23 04 60 11 42 69 24 68 56 01 32 56 71 37 02 36 91
22 31 16 71 51 67 63 89 41 92 36 54 22 40 40 28 66 33 13 80
24 47 32 60 99 03 45 02 44 75 33 53 78 36 84 20 35 17 12 50
32 98 81 28 64 23 67 10 26 38 40 67 59 54 70 66 18 38 64 70
67 26 20 68 02 62 12 20 95 63 94 39 63 08 40 91 66 49 94 21
24 55 58 05 66 73 99 26 97 17 78 78 96 83 14 88 34 89 63 72
21 36 23 09 75 00 76 44 20 45 35 14 00 61 33 97 34 31 33 95
78 17 53 28 22 75 31 67 15 94 03 80 04 62 16 14 09 53 56 92
16 39 05 42 96 35 31 47 55 58 88 24 00 17 54 24 36 29 85 57
86 56 00 48 35 71 89 07 05 44 44 37 44 60 21 58 51 54 17 58
19 80 81 68 05 94 47 69 28 73 92 13 86 52 17 77 04 89 55 40
04 52 08 83 97 35 99 16 07 97 57 32 16 26 26 79 33 27 98 66
88 36 68 87 57 62 20 72 03 46 33 67 46 55 12 32 63 93 53 69
04 42 16 73 38 25 39 11 24 94 72 18 08 46 29 32 40 62 76 36
20 69 36 41 72 30 23 88 34 62 99 69 82 67 59 85 74 04 36 16
20 73 35 29 78 31 90 01 74 31 49 71 48 86 81 16 23 57 05 54
01 70 54 71 83 51 54 69 16 92 33 48 61 43 52 01 89 19 67 48 
```

假设我想要`(0,0)`[顶角] 的所有对角线使用`getD(t,0,0)`

使用上面的代码，我想要一些类似的东西：

```
[[0, 0, 0, 0], [8, 49, 31, 23], [0, 0, 0, 0], [0, 0, 0, 0]] 
```

或者如果我想在点`(19,19)`[最后一个底角] 使用对角线`getD(t, 19, 19)`

使用上面的代码，我想要一些类似的东西：

```
[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [48, 5, 4, 40]] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T15:34:36.250

我想你可能想要类似的东西

```
def get_diagonal(t, x, y, length=4):
    rays = []
    diagonal_directions = [(1,1),(1,-1),(-1,1),(-1,-1)]
    for dx, dy in diagonal_directions:
        if not ((0 <= (x+dx*(length-1)) < len(t[0])) and
                (0 <= (y+dy*(length-1)) < len(t))):
            ray = []
        else:
            ray = [t[y+dy*i][x+dx*i] for i in range(length)]
        rays.append(ray)
    return rays 
```

[更好：`rays`完全且简单地移除`yield`每条射线。]

我总是在做这些事情时搞混`x`，`y`所以你会想检查一下，但我认为这样的事情应该可行。例子：

```
In [48]: get_diagonal(t, 0, 0)
Out[48]: [[8, 49, 31, 23], [], [], []]

In [49]: get_diagonal(t, 19, 19)
Out[49]: [[], [], [], [48, 5, 4, 40]]

In [50]: get_diagonal(t, 5, 5)
Out[50]: [[3, 67, 20, 97], [3, 63, 42, 93], [3, 64, 68, 58], [3, 51, 23, 31]]

In [51]: get_diagonal(t, 5, 5, 3)
Out[51]: [[3, 67, 20], [3, 63, 42], [3, 64, 68], [3, 51, 23]] 
```

您可以更改顺序`diagonal_directions`以符合您的期望。另外，请注意，如果您没有足够的条款，我会返回`[]`。`[0,0,0,0]`返回`[0,0,0,0]`是一个坏主意，ISTM - 您如何区分没有足够的术语和具有正确数量的术语但它们都为零？将该逻辑加载到对角函数中对我来说感觉很奇怪，但您可以轻松更改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T18:47:37.917

使用 Numpy 解决欧拉问题 11 真的很简单：

首先，创建您的 Numpy 矩阵：

```
>>> import numpy as np
>>> LoL=np.array([map(int,ss.split()) for ss in """\
... 08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08
... 49 49 99 40 17 81 18 57 60 87 17 40 98 43 69 48 04 56 62 00
... 81 49 31 73 55 79 14 29 93 71 40 67 53 88 30 03 49 13 36 65
... 52 70 95 23 04 60 11 42 69 24 68 56 01 32 56 71 37 02 36 91
... 22 31 16 71 51 67 63 89 41 92 36 54 22 40 40 28 66 33 13 80
... 24 47 32 60 99 03 45 02 44 75 33 53 78 36 84 20 35 17 12 50
... 32 98 81 28 64 23 67 10 26 38 40 67 59 54 70 66 18 38 64 70
... 67 26 20 68 02 62 12 20 95 63 94 39 63 08 40 91 66 49 94 21
... 24 55 58 05 66 73 99 26 97 17 78 78 96 83 14 88 34 89 63 72
... 21 36 23 09 75 00 76 44 20 45 35 14 00 61 33 97 34 31 33 95
... 78 17 53 28 22 75 31 67 15 94 03 80 04 62 16 14 09 53 56 92
... 16 39 05 42 96 35 31 47 55 58 88 24 00 17 54 24 36 29 85 57
... 86 56 00 48 35 71 89 07 05 44 44 37 44 60 21 58 51 54 17 58
... 19 80 81 68 05 94 47 69 28 73 92 13 86 52 17 77 04 89 55 40
... 04 52 08 83 97 35 99 16 07 97 57 32 16 26 26 79 33 27 98 66
... 88 36 68 87 57 62 20 72 03 46 33 67 46 55 12 32 63 93 53 69
... 04 42 16 73 38 25 39 11 24 94 72 18 08 46 29 32 40 62 76 36
... 20 69 36 41 72 30 23 88 34 62 99 69 82 67 59 85 74 04 36 16
... 20 73 35 29 78 31 90 01 74 31 49 71 48 86 81 16 23 57 05 54
... 01 70 54 71 83 51 54 69 16 92 33 48 61 43 52 01 89 19 67 48\
... """.splitlines()]) 
```

现在，您可以将 4x4 矩阵中的每 225 个视为其自己的简单部分：

```
def maxOfSub4x4(a):
    l=[]
    for i in range(4):             # each line of 4x4 square
        l.append(a[i])
        l.append(a[:,i])

    l.append(a.diagonal())
    l.append(a[::-1].diagonal())   # opposite diagonal
    print l

    return max([reduce(int.__mul__,[int(i) for i in e]) for e in l]) 
```

现在可以看到 LoL[0:4,0,4] 处特定方格的最大值：

```
 print maxOfSub4x4(LoL[0:4,0:4]) 
```

打印 4x4 子数组的元素，包括两条对角线，以及这些数组元素的最大乘积：

```
[array([ 8,  2, 22, 97]), array([ 8, 49, 81, 52]), array([49, 49, 99, 40]), array([ 2, 49, 49, 70]), array([81, 49, 31, 73]), array([22, 99, 31, 95]), array([52, 70, 95, 23]), array([97, 40, 73, 23]), array([ 8, 49, 31, 23]), array([52, 49, 99, 97])]
24468444 
```

现在，只需遍历 20 x 20 完整数组中的所有 225 个 4x4 子数组——完成。

# java - Tomcat / Jetty - 未处理间歇性请求

> ID：12675941
> 
> 赞同：3
> 
> 时间：2012-10-01T15:07:47.093
> 
> 标签：java, tomcat, tcp, jetty

我正在 Red Hat 服务器上使用 Tomcat/Jetty 部署 Java SOAP servlet。我在另一台服务器上启动一个客户端，每秒发送 5 个请求。我的读取超时时间为 10 秒，请求平均需要 20 毫秒来处理。

但有时 1 小时后，Web 服务器永远不会响应请求。客户端记录 SocketTimeoutException : Read timed out。

*   两台服务器上的平均负载、iowait 和内存使用率都很低。
*   我调整了我的垃圾收集器，暂停时间非常短。
*   我更改了缓冲区大小，但没有帮助。
*   我的 SOAP 消息只有 300-500 个字符。
*   我在另一台服务器上尝试过，它仍然发生。
*   Tomcat/Jetty 线程池未饱和。
*   我尝试使用 Jetty 7、8 和 Tomcat 7。
*   我没有看到容器记录的任何错误。
*   我在 64 位上使用 Java 7 update 7。
*   我正在使用属性 -Djava.net.preferIPv4Stack=true

我用 Wireshark 查看了 tcpdump，只有当它是 TCP 连接的第一个请求时才会出现问题。服务器确认所有数据包。当我降低 Keep-Alive 连接的数量时，问题会更频繁地发生。

似乎 Tomcat / Jetty 接受了连接，但它没有读取任何内容。我尝试读取超时 100 秒，但问题仍然存在。

你知道什么会导致这种情况吗？

# javascript - Groupon API 声明

> ID：12675942
> 
> 赞同：0
> 
> 时间：2012-10-01T15:07:47.047
> 
> 标签：javascript, json

我试图在他们的交易部分中回应每笔交易的所有标题。我猜 for 语句是正确的，而且我有点不知道如何循环打印语句以遍历所有标题。但我只是不确定如何？

我的代码：

```
$(document).ready(function() {
    $.ajax({
        url: 'https://api.groupon.com/v2/deals.json?client_id={accesstoken}&division_id=new-york',
        data: 'client_id='+ access_token + '&' + 'division_id'+ loc,
        dataType: 'jsonp',
        success: function (data) {
            items = data;
            // title = data.deals[0].shortAnnouncementTitle;
            console.log(items)
            handleResult(items)
            // handleResult(title)
        },
    });

    function handleResult(items) {
        for(var i=0; i<items.deals.length; i++) {
            var title = items.deals[i].shortAnnouncementTitle;
            s = "<h2 class='results'>" + title + "</h2>";
            console.log(title)
        }

        $("#result").html(s);
    } 
```

目前它循环并仅打印出列表中的最后一项，而在控制台中我看到了每个标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T16:16:42.497

这些都应该有效，您在每次迭代中都覆盖了 s 的值，您试图构建一个更大的字符串但错过了加号：

```
 function handleResult(items) {
    var s = "";
    for(var i=0; i<items.deals.length; i++) {
        var title = items.deals[i].shortAnnouncementTitle;
        s += "<h2 class='results'>" + title + "</h2>";
        //or s = s+ ....   
        console.log(title)
    }

    $("#result").html(s);
} 
```

你也应该在使用之前使用 var 声明变量 's' 否则你将设置全局 's' 属性，或者类似的东西，如果在没有 var 的情况下使用 s ，这将创建有趣的人工制品 :-)

```
 function handleResult(items) {
    for(var i=0; i<items.deals.length; i++) {
        var title = items.deals[i].shortAnnouncementTitle;
        var s = $("<h2 class='results'></h2>").text(title);
        $("#result").append(s);
        console.log(title)
    }
} 
```

以上将是我的首选解决方案，因为它可以让您更好地控制每个元素并提供一些灵活性。我想我上面写的很对。

希望有帮助。马特

# vb.net - 创建图像热点

> ID：12675944
> 
> 赞同：1
> 
> 时间：2012-10-01T15:07:48.540
> 
> 标签：vb.net, winforms, visual-studio-2010

我可能只是以我不知道的错误方式解决这个问题。我有一个 PNG，它是 1000x1000 像素。我的形状像一个五边形，每个部分都有一个盒子。我想要做的是让每个作为 PNG 一部分的框成为一个可点击的框。我试图研究如何做到这一点，但我找不到这个问题的任何答案。先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:18:38.593

您应该能够通过在单击 png 时检查鼠标事件参数来完成此操作。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.mouseeventargs.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.mouseeventargs.aspx)

[这](http://visualbasic.about.com/od/quicktips/qt/netc2.htm)是关于事件参数以及如何将它们传递给函数或子例程的教程。

我相信[这](http://visualbasic.about.com/od/learnvbnet/a/eventhandler_2.htm)正是你想要做的......

```
Private Sub PictureBox1_MouseDown( _
   ByVal sender As Object, _
   ByVal e As System.Windows.Forms.MouseEventArgs) _
   Handles PictureBox1.MouseDown
   Dim myPicBox As PictureBox = sender
   Select Case e.Y / myPicBox.Height
      Case Is > 2 / 3
         Debug.WriteLine("It's in the bottom third")
      Case Is > 1 / 3
         Debug.WriteLine("It's in the middle third")
      Case Else
         Debug.WriteLine("It's in the top third")
   End Select
End Sub 
```

- 参考上一个网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:32:53.693

您可以使用这样的 Contains 方法处理`MouseMove`事件和`MouseDown` 或`MouseClick`事件并检查是否`Cursor`在某个 Rectangle 内。它需要扩展以处理多个热点。

```
Public Class Form1
    Dim hotspot1 As Rectangle = New Rectangle(25, 25, 50, 50)

    Private Sub PictureBox1_MouseClick(sender As System.Object, e As System.Windows.Forms.MouseEventArgs) Handles PictureBox1.MouseClick
        If hotspot1.Contains(e.X, e.Y) Then
            Beep()
        End If
    End Sub

    Private Sub PictureBox1_MouseMove(sender As System.Object, e As System.Windows.Forms.MouseEventArgs) Handles PictureBox1.MouseMove
        If hotspot1.Contains(e.X, e.Y) Then
            If Cursor <> Cursors.Hand Then Cursor = Cursors.Hand
        Else
            If Cursor <> Cursors.Default Then Cursor = Cursors.Default
        End If
    End Sub

End Class 
```

# css - 居中绝对定位

> ID：12675956
> 
> 赞同：1
> 
> 时间：2012-10-01T15:08:15.910
> 
> 标签：css, html, center

我知道如何使用`position: relative;`and轻松地将 div 与 CSS 居中`margin:auto;`，但是我有一个应该位于所有其他 div 前面的 div - 所以我设置了`z-index: 1000;`and `position:absolute;`。如果我尝试相对，我想不出任何其他方法来将其设置在前面，`position: absolute;` 那么它将低于其他所有内容。我的问题是如何设置这个`z-index: 1000; position: absolute;`必须留在中心的 div？

我尝试`left: 20%;`看起来很完美，但是当它显示在更大的屏幕或小得多的屏幕上时，显然百分比不会相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T15:10:05.373

您可以执行以下两项操作之一：

1.  给出一个固定的 % 宽度并计算居中：

`position:absolute;width:60%;left:20%`( `100%-60% = 40%`--> `40% / 2 = 20%`)

2\. 使用 定位 div `position:absolute;text-align:center;`，并给出内部元素`position:relative;display:inline-block;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T15:17:52.027

确保你的 div 有一个宽度和高度，然后是 50% 的定位，边距是大小的负一半。例如一个 100px x 100px 的 div：

```
z-index: 1000; 
position: absolute;

top: 50%;
left: 50%;
margin-left: -50px;
margin-top: -50px; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-01T15:11:05.370

您仍然可以`z-index`在`position:relative`div 上使用。只要确保所有其他`z-index`对象也需要有一个声明的位置。

# c# - C# - ASPX - Checkbox needs to be checked only if certain text is in the DB

> ID：12675959
> 
> 赞同：0
> 
> 时间：2012-10-01T15:08:33.647
> 
> 标签：c#, asp.net

I'm looking for a small piece of code that allows me the have a checkbox checked or not checked depending on the text value of the Checkbox.

For example: If the text value of the checkbox is "Yes" it needs to be checked. If it's not "Yes" it shouldn't be checked.

This is what I have:

ASPX-page:

```
<asp:TemplateField HeaderText="Contract Check" SortExpression="Contract_Check" ItemStyle-Wrap="false">
            <EditItemTemplate></EditItemTemplate>
            <ItemTemplate>
                <asp:CheckBox ID="chk_contract_check" Checked='<%# contractCheck(Container.DataItem) %>' Text='<%# Bind("Contract_Check") %>' runat="server" Enabled="false" />
            </ItemTemplate>
            <FooterTemplate></FooterTemplate>
        </asp:TemplateField> 
```

Code Behind File:

```
protected String contractCheck(CheckBox obj)
    {
        if (obj.Text == "Prior Transition")
            return "True";
        else
            return "False";} 
```

However this is not working. Do you guys have any idea how I can get this too work? Thanks

Kevin

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T16:41:18.437

There are two options in my mind:

**1 - Inline logic: Updating the aspx (no function required)**

You should be able to just put the logic inline, directly into the markup:

```
<asp:TemplateField HeaderText="Contract Check" SortExpression="Contract_Check" ItemStyle-Wrap="false">
        <EditItemTemplate></EditItemTemplate>
        <ItemTemplate>
            <asp:CheckBox ID="chk_contract_check" Checked='<%# Eval("Text").ToString() == "Prior Transition" %>' Text='<%# Bind("Contract_Check") %>' runat="server" Enabled="false" />
        </ItemTemplate>
        <FooterTemplate></FooterTemplate>
    </asp:TemplateField> 
```

(the amended part is `Checked='<%# Eval("Text").ToString() == "Prior Transition" %>'`)

**OR**

**Option 2 - Separate Logic: Update the function**

If you'd prefer to keep the logic separate, then there are a couple of changes to make. You are currently passing in the data item, not the `Checkbox` (which is what your function is expecting). The second issue is that you need to return a `bool` from your logic function, not a `string`. You need to make two changes in this instance:

1 - Pass in the text to be checked to the function in the aspx

`<asp:CheckBox ID="chk_contract_check" Checked='<%# contractCheck(Eval("Text").ToString()) %>' Text='<%# Bind("Contract_Check") %>' runat="server" Enabled="false" />`

2 - Amend the function to check the text, and return a `bool`

```
protected bool contractCheck(string text)
{
    return text == "Prior Transition";
} 
```

Basically, the `Checked` attribute requires a `bool` to work, and you're giving it a String.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:13:38.767

Why don't you create a custom CheckBox control (inherit from CheckBox), then put the code-behind logic in there to check the box if necessary when the text is set?

Here's a link that may help: [http://www.codeproject.com/Articles/28783/Your-First-ASP-NET-Custom-Control](http://www.codeproject.com/Articles/28783/Your-First-ASP-NET-Custom-Control)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T15:18:17.527

Your contractCheck method needs the object that can be evaluated

Like this

```
protected String contractCheck(Object obj)
{
        if (DataBinder.Eval(obj, "Name of the field").ToString() == "Prior Transition")
            return "True";
        else
            return "False";} 
```

# .htaccess - .htaccess 重定向以避免 404

> ID：12675963
> 
> 赞同：0
> 
> 时间：2012-10-01T15:08:52.347
> 
> 标签：.htaccess, mod-rewrite

我最近在我的 CMS 中进行了更改，这导致谷歌网站管理员出现大量 404 错误。目前 404 未找到 URL 是

[http://pukhtoogle.com/gallery/postcard.img707.htm](http://pukhtoogle.com/gallery/postcard.img707.htm)

而工作 URL 是

[http://pukhtoogle.com/gallery/img707.htm](http://pukhtoogle.com/gallery/img707.htm)

我想通过 .htaccess 从 URL 中排除明信片，请建议一行来替换它，下面的代码显示了我现有的文件。

```
RewriteEngine On 

#RewriteBase /
RewriteRule ^sitemap.xml$ google.php
RewriteRule ^cat-(.*)-([0-9]+)\.htm$ categories.php?cat_id=$2&%{QUERY_STRING}
RewriteRule ^cat\.htm$ categories.php?%{QUERY_STRING}

#Mod_bmollet : Image name in URL
RewriteRule ^img-(.*)-([0-9]+)\.htm$ details.php?image_id=$2&%{QUERY_STRING}
RewriteRule ^img([0-9]+)\.search.htm$ details.php?image_id=$1&%{QUERY_STRING}
RewriteRule ^img([0-9]+)\.lightbox.htm$ details.php?image_id=$1&%{QUERY_STRING}
RewriteRule ^img([0-9]+)\.htm$ details.php?image_id=$1&%{QUERY_STRING}
RewriteRule ^img([0-9]+)\.([a-zA-Z0-9]+)\.htm$ details.php?image_id=$1&mode=$2&%        {QUERY_STRING}

#Mod_bmollet : This is to make search function work ( redirect links from search results )
RewriteRule ^search\.htm$ search.php?%{QUERY_STRING}
RewriteRule ^search\.([0-9]+)\.htm$ search.php?page=$1&%{QUERY_STRING}
RewriteRule ^lightbox\.htm$ lightbox.php?%{QUERY_STRING}
RewriteRule ^lightbox\.([0-9]+)\.htm$ lightbox.php?page=$1&%{QUERY_STRING} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T18:08:11.297

在`RewriteEngine On`您的 htaccess 文件中，添加：

```
RewriteRule ^gallery/postcard\.(.*)$ /gallery/$1 [L,R=301] 
```

* * *

编辑：在您的网站上玩了一会儿之后，看起来所有这些规则*实际上都在`gallery`目录*中，这从一开始就是非常宝贵的信息。

因此，您必须省略`gallery/`正则表达式的一部分：

```
RewriteRule ^postcard\.(.*)$ /gallery/$1 [L,R=301] 
```

或者

```
RewriteRule ^postcard\.(.*)$ http://pukhtoogle.com/gallery/$1 [L,R=301] 
```

# ruby-on-rails-3 - Rails Rake 任务电子邮件通知程序

> ID：12675964
> 
> 赞同：0
> 
> 时间：2012-10-01T15:08:54.270
> 
> 标签：ruby-on-rails-3, rake, actionmailer, rake-task

我是编写 Rails rake 任务的新手。我想编写一个 rake 任务来查找在到期后 30 分钟内的呼叫并执行邮件。下面是我将在控制器之外使用的代码，我怎样才能使它适应我的 rake 任务？

```
@call = Call.find(params[:id])
if Time.zone.now < @call.transfer_date + 30.minutes
   @call.units.each do |unit|
      CallMailer.cancel_call(unit.incharge, @call).deliver
      CallMailer.cancel_call(unit.attendant, @call).deliver
   end
end 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:23:42.340

```
namespace :send_due_emails do
  desc "" #task describtion
  task :send_due_emails_task => :environment do
     send_emails
  end

  def send_emails
    @call = Call.find(params[:id])
    if Time.zone.now < @call.transfer_date + 30.minutes
      @call.units.each do |unit|
         CallMailer.cancel_call(unit.incharge, @call).deliver
         CallMailer.cancel_call(unit.attendant, @call).deliver
      end
    end
  end
end 
```

[http://railscasts.com/episodes/66-custom-rake-tasks](http://railscasts.com/episodes/66-custom-rake-tasks)

[http://jasonseifer.com/2010/04/06/rake-tutorial](http://jasonseifer.com/2010/04/06/rake-tutorial)

# ios - 查找 iOS Simulator 应用程序的路径

> ID：12675965
> 
> 赞同：3
> 
> 时间：2012-10-01T15:08:53.637
> 
> 标签：ios, xcode, xcode4.2, ios-simulator

我想从命令行运行**模拟器**。有没有办法通过**命令行找到****模拟器路径**。Apple经常更改模拟器位置，例如

 **```
/Developer/Platforms/iPhoneSimulator.platform/Developer/Applications/iPhone Simulator.app/Contents/MacOS/iPhone Simulator

/Applications ........ / IOS simulato.... 
```

有没有办法从终端找到模拟器路径。?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T15:27:07.467

这里有两个建议：

*   您可以使用`xcode-select`打印 Xcode 的路径：

    ```
    # This returns sthg like "/Applications/Xcode.app/Contents/Developer"
    XCODEPATH=$(xcode-select --print-path)
    # Then build the rest of the path to the simulator SDK
    SIMSDKPATH=${XCODEPATH}/Platforms/iPhoneSimulator.platform/Developer
    # And add the rest of the path to the Simulator app
    SIMULATORPATH=$(SIMSDK}/Applications/iPhone Simulator.app/Contents/MacOS/iPhone Simulator 
    ```

*   您可以使用`xcrun`在 iphonesimulator SDK 中查找 xcodebuild 工具的路径，然后从此处扣除路径：

    ```
    # This returns sthg like "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/gcc"
    GCCPATH=$(xcrun -sdk iphonesimulator -find gcc)
    # Then go up 3 directories
    SIMSDKPATH=$(dirname $(dirname $(dirname ${GCCPATH})))
    # And down to the Simulator app
    SIMULATORPATH=${SIMSDKPATH}/Applications/iPhone Simulator.app/Contents/MacOS/iPhone Simulator 
    ```**

# java - 如何在 Java 中捕获和处理 Excel、IE、Winzip 关闭事件

> ID：12675968
> 
> 赞同：0
> 
> 时间：2012-10-01T15:08:54.920
> 
> 标签：java, excel, try-catch, handle

在我的应用程序中，首先，我将 xls、xlsx、zip 文件以二进制格式上传到数据库中。

其次，我创建了一个临时文件夹来加载二进制文件并将它们转换为临时文件夹中的原始格式，并自动打开它以供用户浏览。

但是出于安全考虑，我希望在用户关闭 excel 或 winzip 应用程序后删除临时文件。

在我看来，我需要捕捉 excel 和 winzip 等应用程序的关闭事件，然后完成剩下的工作。

我看到了一些使用 C# 或 VB 的解决方案。我希望 Java 也能完成这项工作。你能给我一些建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:10:46.573

您可以使用 Process.waitFor() 使启动外部进程的线程等待它完成。

[http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Process.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Process.html)

如果您不希望阻塞主线程（因为您可能不应该这样做，例如，如果这是一个 UI 应用程序），请启动一个单独的线程来执行外部转换。

# actionscript-3 - 为项目中的一组文件创建私有包

> ID：12675972
> 
> 赞同：1
> 
> 时间：2012-10-01T15:08:59.800
> 
> 标签：actionscript-3

如何为 Actionscript 项目中的一组文件创建私有包？假设我有 pack2，因此它们只能由 pack1.Class_A 和 pack1.Class_B 访问。app.Class_A 或 app.Class_B 不得访问 pack2：

源代码

1.  应用程序

    1.1-Class_A

    1.2-Class_B

2.  包1

    2.1-Class_A

    2.2-Class_B

    2.3包2

    2.3.1 -Class_C

编码 Class_C 如下：

```
package pack2  // <<<< NOTE, IT's NOT pack1.pack2 
{
    public class Class_C
    {
        public function Class_C()
       {

       }

     } 

} 
```

但这并不能解决我的目的，因为我看到 Class_C 仍然可以通过 app.Class_A 和 app.Class_B 使用 pack2.Class_C 访问

我怎样才能使 pack1.Class_A 和 pack1_ClassB 的 pack2.Class_C 私有

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:41:55.610

将您需要从pack1 访问的这些类放入pack1，将它们标记为内部，仅此而已。

# java - JUnit - IllegalArgumentException.class 失败？

> ID：12675975
> 
> 赞同：1
> 
> 时间：2012-10-01T15:09:12.520
> 
> 标签：java, eclipse, unit-testing, testing, junit

我创建了一个非常简单的 junit 测试，它在数据库的产品表中创建了一个空产品。

```
@Test(expected = IllegalArgumentException.class)
public void testCreate_NULL() {
    Product p = null;
    createProduct(p);
} 
```

但是当我做junit测试时它变成蓝色。

顺便提一句。其他测试，如创建产品、删除等。都是绿色的...

我很感谢你的回答！！！

PS.：我正在使用 hsql 数据库！

PPS.：错误是：

> java.lang.AssertionError：预期异常：org.junit.internal.runners.statements.ExpectException.evaluate(ExpectException.java:35) at org.junit.internal.runners.statements.RunBefores.evaluate( RunBefores.java:28) 在 org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30) 在 org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263) 在 org.junit.runners .BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68) at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47) at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231) at org.junit .runners.ParentRunner$1.schedule(ParentRunner.java:60) 在 org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229) 在 org.junit.runners.ParentRunner。访问$000(ParentRunner.java:50) at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222) at org.junit.runners.ParentRunner.run(ParentRunner.java:300) at org.eclipse.jdt .internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50) 在 org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38) 在 org.eclipse.jdt.internal.junit .runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner .run(RemoteTestRunner.java:390) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50) 上 org.eclipse.jdt.internal.junit.runner.TestExecution 上的 runners.ParentRunner.run(ParentRunner.java:300)。在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.runTests(RemoteTestRunner.java:467) 运行(TestExecution.java:38) java:683) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50) 上 org.eclipse.jdt.internal.junit.runner.TestExecution 上的 runners.ParentRunner.run(ParentRunner.java:300)。在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.runTests(RemoteTestRunner.java:467) 运行(TestExecution.java:38) java:683) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)38) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467) 在 org .eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)38) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467) 在 org .eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)

更新：

我的 createProduct 方法只是将产品插入数据库并在检查之前：

```
 if(p==null) {
        throw new IllegalArgumentException("null objects impossible");
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T15:12:23.257

也许它正在投掷`NullReferenceException`而不是`IllegalArgumentException`？您应该能够在测试失败的详细信息中看到。

如果没有任何迹象表明方法中有什么，很难诊断这一点`createProduct`。

# asp.net-mvc - Ninject 绑定可以基于 URL/路由值吗？

> ID：12675977
> 
> 赞同：4
> 
> 时间：2012-10-01T15:09:13.337
> 
> 标签：asp.net-mvc, ninject, ninject.web.mvc

我有一个控制器，我想将其用于实现相同接口的两个不同实体上的 CRUD 操作。我希望 Ninject 根据 URL 中的查询字符串值（或者可能是不同的 URL，路由到同一个控制器）给它一个不同的存储库。这可能吗？我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T15:15:25.367

这通常是一种设计气味，但您可以像这样定义绑定：

```
kernel.Bind<IRepo>().ToMethod(ctx => 
{
    var a = HttpContext.Current.Request["a"];
    if (a == "b")
    {
        return new RepoA();
    }

    return new RepoB();
}).InRequestScope(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-16T13:32:51.830

以下对我有用，从路线获取特定值

```
kernel.Bind<IRepo>().ToMethod(ctx => 
{
    var a = HttpContext.Current.Request.RequestContext.RouteData.Values["RouteDateValue"]
    if (a != null)
    {
        return new RepoA(a);
    }

    return new RepoB();
}) 
```

# c++ - c++ 64位网络到主机翻译

> ID：12675978
> 
> 赞同：0
> 
> 时间：2012-10-01T15:09:14.330
> 
> 标签：c++, network-programming

我知道使用 gcc byteswap 和网络上的其他替代方法可以解决这个问题，但我想知道为什么下面的代码不起作用。

首先，我有 gcc 警告（我觉得不应该出现），我不想使用字节交换的原因是因为我需要确定我的机器是大端还是小端并相应地使用字节交换，例如，如果我的机器是大端的，我可以按原样 memcpy 字节而不需要任何翻译，否则我需要交换它们并复制它。

```
static inline uint64_t ntohl_64(uint64_t val)
{
    unsigned char *pp =(unsigned char *)&val;
    uint64_t val2 = ( pp[0] << 56  | pp[1] << 48 
                    | pp[2] << 40  | pp[3] << 32 
                    | pp[4] << 24 | pp[5] << 16
                    | pp[6] << 8 | pp[7]);
    return val2;
}

int main()

{
    int64_t a=0xFFFF0000;
    int64_t b=__const__byteswap64(a);
    int64_t c=ntohl_64(a);
    printf("\n %lld[%x] [%lld] [%lld]\n ", a, a, b, c);
} 

 Warnings:-
 In function \u2018uint64_t ntohl_64(uint64_t)\u2019:
     warning: left shift count >= width of type
     warning: left shift count >= width of type
     warning: left shift count >= width of type
     warning: left shift count >= width of type

 Output:-
 4294901760[00000000ffff0000] 281470681743360[0000ffff00000000] 65535[000000000000ffff] 
```

我在一个小端机器上运行它，所以 byteswap 和 ntohl_64 应该产生完全相同的值，但不幸的是我得到了完全出乎意料的结果。如果有人能指出什么是错的，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:34:44.110

```
uint64_t val2 = ( pp[0] << 56  | pp[1] << 48 
                | pp[2] << 40  | pp[3] << 32 
                | pp[4] << 24 | pp[5] << 16
                | pp[6] << 8 | pp[7]); 
```

`pp[0]`是一个`unsigned char`并且`56`是一个整数，所以`pp[0] << 56`执行左移作为`unsigned char`一个`unsigned char`结果。这不是您想要的，因为您希望所有这些转变都具有 unsigned long long 类型。

解决此问题的方法是强制转换，例如`((unsigned long long)pp[0]) << 56`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T15:22:05.410

您的代码不起作用的原因是因为您正在转移`unsigned char`s. 当它们移位时，位会从顶部下降，任何大于 7 的移位都可以视为返回 0（尽管由于机器代码移位的工作方式，某些实现最终会产生奇怪的结果，x86 就是一个例子）。您必须将它们转换为您希望最终尺寸首先达到的任何尺寸：

```
((uint64_t)pp[0]) << 56 
```

您使用 gcc 的最佳解决方案是使用 htobe64。此功能为您完成一切。

PS这有点离题，但如果你想让函数跨字节序可移植，你可以这样做：

**根据 Nova Denizen 的评论进行编辑：**

```
static inline uint64_t htonl_64(uint64_t val)
{
    union{
        uint64_t retVal;
        uint8_t bytes[8];
    };

    bytes[0] = (val & 0x00000000000000ff);
    bytes[1] = (val & 0x000000000000ff00) >> 8;
    bytes[2] = (val & 0x0000000000ff0000) >> 16;
    bytes[3] = (val & 0x00000000ff000000) >> 24;
    bytes[4] = (val & 0x000000ff00000000) >> 32;
    bytes[5] = (val & 0x0000ff0000000000) >> 40;
    bytes[6] = (val & 0x00ff000000000000) >> 48;
    bytes[7] = (val & 0xff00000000000000) >> 56;

    return retVal;
}

static inline uint64_t ntohl_64(uint64_t val)
{
    union{
        uint64_t inVal;
        uint8_t bytes[8];
    };

    inVal = val;

    return bytes[0] |
        ((uint64_t)bytes[1]) <<  8 |
        ((uint64_t)bytes[2]) << 16 |
        ((uint64_t)bytes[3]) << 24 |
        ((uint64_t)bytes[4]) << 32 |
        ((uint64_t)bytes[5]) << 40 |
        ((uint64_t)bytes[6]) << 48 |
        ((uint64_t)bytes[7]) << 56;
} 
```

假设编译器在返回过程中没有对 uint64_t 做任何事情，并且假设用户将结果视为 8 字节值（而不是整数），那么该代码应该可以在任何系统上运行。运气好的话，如果你在一个大端系统上，你的编译器将能够优化整个表达式，如果你在一个小端系统上，你的编译器将能够使用一些内置的字节交换技术（并且保证它仍然可以在任何其他机器上工作一种机器）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T15:15:03.860

由于`pp[x]`是 8 位宽，因此表达式的`pp[0] << 56`结果为零。您需要对原始值进行显式屏蔽，然后进行移位：

```
uint64_t val2 = (( val & 0xff ) << 56 ) |
                (( val & 0xff00 ) << 48 ) |
                ... 
```

在任何情况下，只需使用编译器内置程序，它们通常会产生单个字节交换指令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T15:36:55.220

铸造和移位工作如 PlasmaHH 建议但我不知道为什么 32 位移位自动升频而不是 64 位。

```
typedef uint64_t __u64;

static inline uint64_t ntohl_64(uint64_t val)
{
unsigned char *pp =(unsigned char *)&val;
return ((__u64)pp[0] << 56 |
        (__u64)pp[1] << 48 | 
        (__u64)pp[2] << 40 |
        (__u64)pp[3] << 32 | 
        (__u64)pp[4] << 24 | 
        (__u64)pp[5] << 16 |
        (__u64)pp[6] << 8  |   
        (__u64)pp[7]);
} 
```

# javascript - 使用 drawImage 在画布上绘制像素数据

> ID：12675979
> 
> 赞同：0
> 
> 时间：2012-10-01T15:09:15.357
> 
> 标签：javascript, html, canvas

我有一个像素数组，我想将它绘制到画布上，而不使用 putImageData，因为该函数会忽略剪辑数据。

因此，为了完成这项工作，我将像素数组转换为数据 url，然后将 url 附加到图像上，然后将其绘制到画布上，如下所示：

```
var ctx = {
    display: document.querySelector('canvas#display').getContext('2d'),
    convert: document.querySelector('canvas#convert').getContext('2d')
}

var image_data = THE_IMAGE_DATA_THAT_I_ALREADY_HAVE;

ctx.convert.putImageData(image_data, 0, 0);

var image_data_URL = ctx.convert.canvas.toDataURL('image/png');
var converter_image = document.querySelector('img#converter-image');

converter_image.onload = function () {
    ctx.display.save();
    ctx.display.beginPath();
    ctx.display.arc(320, 240, 240, 0, Math.PI*2, true);
    ctx.display.clip();
    ctx.display.drawImage(converter_image, 0, 0, 640, 480);
    ctx.display.restore();
}
converter_image.src = image_data_URL; 
```

但是，这会带来非常糟糕的性能，特别是因为我想以 60/秒的速度执行此操作。

应该还有别的办法吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:19:20.077

一种解决方法是在屏幕外画布中使用 getImageData / putImageData 绘制像素，然后将屏幕外画布绘制回画布中。

更多信息：

[画布屏幕外](http://pierreloicdoulcet.fr/parisjs/#/17)

[使用 putImagedata 绘制像素（单击代码顶部的空白处以启动它）](http://pierreloicdoulcet.fr/parisjs/#/18)

# html - 在单元格中心对齐内容，但保持文本左对齐

> ID：12675980
> 
> 赞同：2
> 
> 时间：2012-10-01T15:09:19.057
> 
> 标签：html

我正在寻找一些 html 帮助。我将如何在单元格内集中移动文本块，同时保持它们的对齐不变。我不希望文本全部居中显示，因为我将使用无序列表。我只是希望将文本块移动到单元格的中心。

当前场景示例：http: [//jsfiddle.net/AygnN/](http://jsfiddle.net/AygnN/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:24:40.500

```
<table id="sub-content" style="width: 100%;">
  <tbody>
    <tr>
      <th>Departments</th>
      <th>KPI Types</th>
      <th>Bonus</th>
    </tr>
    <tr>
      <td>
        <ul>
          <li>dfgsdgfdfg</li>
        </ul>
      </td>
      <td>
        <ul>
          <li>sdfgsdfgsdfg</li>  
        </ul>
      </td>
      <td>
        <ul>
          <li>sdgsdfgsdffgsdgf</li>
        </ul>
      </td>
    </tr>
  </tbody>
</table> 
```

如果您将`<h1>`标签作为列标题，则应使用实际的表标题（`<th>`标签）。现在，在 CSS 中你可以说：

```
th { text-align:center; } 
```

**编辑：**

```
#sub-content td{ padding:0px 60px; } 
```

并且所有表格标题都将居中，而表格中的所有列表都将向左对齐。

这种方法更标准。

[JSFiddle](http://jsfiddle.net/NTc2v/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:13:40.793

您可以将文本放在 div 中，并将 div 托管在表格单元格中。文本将遵循 div 中指定的 css 样式，因为 div 本身将位于单元格的中心。

你给出的例子做同样的事情。而是将单元格划分为多个单元格并将文本放在中间一个。

# java - 如何使用 JSP 页面中的参数运行 java 类？

> ID：12675988
> 
> 赞同：2
> 
> 时间：2012-10-01T15:09:32.190
> 
> 标签：java, javascript, jsp, tomcat, classpath

我之前编写了一个从 bash 文件执行的 java 类，现在我需要允许使用 Javascript/HTML 按钮从 JSP 页面执行它，我想知道我该怎么做？

首先，我的班级是这样的：

```
 public class Sync
 {
   public static void main(String[] args)
   {
   //my content here
   }
 } 
```

此 Sync 类已从 bash 脚本运行，如下所示：

```
cd /root/tomcat/webapps/project/WEB-INF/classes/
echo "Executing first part..."
/usr/local/java/bin/java classes/CLRSyncCLI 120.0.0.1 up false Y ${IPS[@]}
echo "Executing second part..."
/usr/local/java/bin/java classes/CLRSyncCLI 127.0.0.1 down false Y ${IPS[@]} 
```

请注意：classes 是所有已编译的 java 类在 TomCat Web 服务器中的目录。

现在在jsp页面中我需要类似的东西：

```
<input type="button" value="Execute" name="to" action="run" onClick="path here"> 
```

如何通过单击一次按钮两次运行此同步类及其参数，并显示该类已通过消息执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T16:28:51.393

你的类必须扩展`javax.servlet.http.HttpServlet`和覆盖至少一个方法，如果你正在做一个表单，那么它将是一个方法`doPost()`

然后您需要在 WEB-INF/web.xml 中添加 a`<servlet/>`和 a`<servlet-mapping/>`以指向您的类（现在是一个 Servlet）。

从路径来看，您已经安装了 Tomcat。javax.servlet.* 可以在您的 tomcat/lib 中的名称 servlet-api.jar 下找到。您只需要它们进行编译。Tomcat 在运行时提供它们。

只有这样，您才能在 JSP 中创建这样的表单： `<form method="POST" action="MyServlet">...<input.../>...</form>` 假设 MyServlet 是您添加到 web.xml 的 Servlet 的名称（如果需要，请替换为您自己的名称）。

这是一个例子： http: [//met.guc.edu.eg/OnlineTutorials/JSP%20-%20Servlets/A%20servlet%20example.aspx](http://met.guc.edu.eg/OnlineTutorials/JSP%20-%20Servlets/A%20servlet%20example.aspx)

至少阅读 JavaEE 指南的第 4 章总是有意义的：http: [//docs.oracle.com/javaee/5/tutorial/doc/bnafd.html](http://docs.oracle.com/javaee/5/tutorial/doc/bnafd.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T17:32:17.610

**简短的回答：** `onClick="path here"`应该链接到运行类的第二个 JSP，而不是类本身。

**长答案：**

1.  将您的课程复制到 tomcat lib 文件夹中

2.  创建第二个 JSP 文件

3.  `onClick="path here"`在第一个 JSP 上应该链接到将运行该类的新 JSP，而不是类本身。

4.  将类路径添加到 JSP 标头`import="com.mypackage.*"`

5.  您将必须创建一个接收参数并运行逻辑的方法，您将无法像在命令行中那样运行 main 方法。

将调用代码添加到 JSP

```
<% 
   CLRSyncCLI o = new CLRSyncCLI();
   o.method();
%> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T19:01:59.720

首先，我想说你的提议是一个坏主意。您真的应该`Sync`按照前面的答案中的描述进行重构。

但是，如果您不按`Sync`原样使用，这里有一些代码可能会有所帮助：

```
<% if( request.getParameter( "to" ) == null ) { %>
    <p>
        Click 'Execute' to begin processing.
    </p>
    <form>

        <input type="submit" value="Execute" name="to" />
    </form>
<% } else { %>
    <p>
        Processing...
    </p>
    <pre>
        <%
            PrintStream sysout = System.out;
            try {
                File syncFile = File.createTempFile( "Sync", ".tmp" );

                PrintStream syncOs= new PrintStream( syncFile );
                System.setOut( syncOs );
                String[] myArgs = ...; // set up your args
                Sync.main( myArgs );
                // ... do whatever else you need to do
                syncOs.close();
                syncFile.close();

                FileReader syncRdr = new FileReader( syncFile );
                String line = null;
                while( ( line = syncRdr.readLine() ) {
                    out.println( line );
                }
                syncRdr.close();
                syncFile.delete();
            } catch( Exception ex ) {
                out.print( ex );
            } finally {
                System.setOut( sysout );
            }
        %>
    </pre>
<% } %> 
```

这里有一些潜在的陷阱，尤其是多线程。但也许你可以以此为起点？另外，我还没有调试它，所以你可能需要做更多的工作。

祝你好运，

直流