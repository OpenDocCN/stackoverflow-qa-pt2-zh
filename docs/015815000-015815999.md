# StackOverflow 问答 15815000-15815999

# ruby-on-rails - 我的 URL 附加了这个“?locale=en”。这正常吗？

> ID：15815001
> 
> 赞同：1
> 
> 时间：2013-04-04T15:07:36.987
> 
> 标签：ruby-on-rails, ruby-on-rails-3, internationalization

我的大部分网站都在语言环境（i18n）下工作。但是，现在我在管理方面工作。这在任何本地都不起作用。我刚刚意识到，不在本地范围内的每个 URL 都有这个“？locale = en”附加到 URL 的末尾。

你可以看看这个网站。每个 URL 似乎都很好。但是，如果您转到带您返回根目录的左上角图标，则会在 URL 中添加该位。 [http://hik-fyp.heroku.com](http://hik-fyp.heroku.com)

我猜是用某种语言显示根。但是，当涉及到管理部分（单语）时，它无处不在。

正常吗？这会以某种方式干扰网站吗？有没有办法摆脱它？我花了一段时间在网上研究，但找不到类似的东西。提前致谢...

这是 ApplicationController 的摘录

```
after_filter :store_location
  before_filter :set_locale

  def set_locale
    logger.debug "* Accept-Language: #{request.env['HTTP_ACCEPT_LANGUAGE']}"
    I18n.locale = params[:locale] || extract_locale_from_accept_language_header || I18n.default_locale
    logger.debug "* Locale set to '#{I18n.locale}'"
    if current_user
      current_user.locale = params[:locale]
      current_user.save
    end
    session[:locale] = I18n.locale
  end

  def default_url_options(options={})
    logger.debug "default_url_options is passed options: #{options.inspect}\n"
    { :locale => I18n.locale }
  end

  def store_location
    # store last url as long as it isn't a /users path
    session[:previous_url] = request.fullpath unless request.fullpath =~ /\/users/
  end

  def after_sign_in_path_for(resource)
    session[:previous_url] || root_path
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-09T19:16:30.570

您正在定义当您设置时会发生这种情况

```
def default_url_options(options={})
  { :locale => I18n.locale }
end 
```

这告诉 rails url_for 帮助器（它是 link_to 和许多其他的基础）自动包含 locale 参数。

# c# - C#从类访问表单组件

> ID：15815003
> 
> 赞同：0
> 
> 时间：2013-04-04T15:07:40.633
> 
> 标签：c#, class, methods

我有包含在 Form1 类中的方法

```
 public void ExecuteMessageOperations(MSMQMessage MSMQ)
    {
        switch (MSMQ.MesType)
        {
            case "01": { label1.Text = MSMQ.MesContent; MessageBox.Show(MSMQ.MesContent); button1.Text = MSMQ.MesContent; };
                break;
            case "02":
                {
                    dataGridView1.Columns.Add("Data", "Data");
                    dataGridView1.Rows.Add(MSMQ.MesContent);

                };
                break;
            case "03":
                {
                    string[] separated = MSMQ.MesContent.Split(new Char[] { ',' });
                    try
                    {
                        Rectangle rect = new Rectangle(Convert.ToInt16(separated[0]),
                            Convert.ToInt16(separated[1]), Convert.ToInt16(separated[2]),
                            Convert.ToInt16(separated[2]));
                        SolidBrush brush = new SolidBrush(XMLConfigs.GetBrushColor());
                        Graphics Grph = pictureBox1.CreateGraphics();
                        Grph.FillEllipse(brush, rect);

                    }
                    catch (Exception)
                    {
                        MessageBox.Show("Wrong parameters");
                    };
                };
                break;
        } 
```

以及名为 MSMQMessageThread 的类，它包含在 Form1 之外。这个类有方法

```
public void PerformOperations()
    {
        while (true)
        {
            try
            {
                Form1 f = new Form1();
                f.ExecuteMessageOperations(MSMQMessage.ReceiveMessage(@".\private$\TestQueue"));
            }
            catch (System.Messaging.MessageQueueException) { }
        }
    } 
```

代码编译正常，但方法 ExecuteMessageOperations 什么也不做。错误在哪里，如何访问方法 ExecuteMessageOperations 中的 Form1 组件？PS对不起我的英语

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:11:09.857

在您的 switch 语句和“跳过”处放置一个断点。让我们知道它是否实际上首先调用了该方法。

# python - 如何在 qtgui 中创建一个变化的情节

> ID：15815007
> 
> 赞同：0
> 
> 时间：2013-04-04T15:07:45.813
> 
> 标签：python, pyqt, pyqt4

我想在 QtGui 应用程序中添加一个变化的图，即它首先显示一个点，然后是 2，然后是 3，等等，或者您可以将其视为一个移动窗口，即您有 100 个点，但您首先显示前 10 个点然后你放下第一个点移动9个点并添加一个新点等。

就绘图点而言，我只是好奇我是否应该只是尝试更新情节，还是应该使用 QGraphicsScene 之类的东西。对我来说，这似乎有点矫枉过正，但我​​想我会问。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:24:17.260

我在这些主题中找到了信息

[如何在 python 程序的简单 UI 中显示实时图形？](https://stackoverflow.com/questions/4129697/how-do-i-display-real-time-graphs-in-a-simple-ui-for-a-python-program#)

[如何更新 matplotlib 中的绘图？](https://stackoverflow.com/questions/4098131/matplotlib-update-a-plot/4098938#)

我假设他们没有使用 QGRaphicsScene 这是正确的方法，即不使用它。

# node.js - 如何更改node.js中的ejs模板以避免这种情况

> ID：15815008
> 
> 赞同：1
> 
> 时间：2013-04-04T15:07:47.563
> 
> 标签：node.js, ejs

我在 node.js 中使用 ejs 模板，我遇到了路由问题，例如

我有两个 html 文件 home.html 和 list.html，它们都加载 list.ejs 文件以显示相同的内容 - 用户列表。

**主页.html**

```
<div class="container-fluid content">   
    <% include users/list %>        
</div> 
```

**列表.html**

```
<div class="container-fluid content">   
    <% include course/list %>       
</div> 
```

**列表.ejs**

```
 <article>
        <h2><a href="user/<%= user._id %>" ></a><%= user.title %></h2>
        <p>
            <a href="user/<%= user._id %>" >@waynespiegel</a><%= user.description %>
        </p>
    </article> 
```

但是，问题出现了 home.html 和 list.html 在不同的 url 中， home.html 的 url 是**'/'**而 home.html 的 url 是**'user/recent'**。

因此，如果我单击 home.html 页面中的“ ><%= user.title %> ，它会正确跳转到正确的页面**/user/'userid'**。但是当涉及到 list.html 时，链接变为**/user/user/'userid'**，这是错误的

所以我的问题是如何更改 ejs 以避免这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:18:38.350

这是您的新 list.ejs：

```
<article>
    <h2><a href="/user/<%= user._id %>" ></a><%= user.title %></h2>
    <p>
        <a href="/user/<%= user._id %>" >@waynespiegel</a><%= user.description %>
    </p>
</article> 
```

如果没有链接中的前导 / ，您将调用相对路径，现在您正在处理绝对路径（即：从您的服务器根目录开始）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:18:45.200

如果你在 url 的开头加上一个斜杠，你就让它相对于基本 url。通常这是您的域。

```
<article>
    <h2><a href="/user/<%= user._id %>" ></a><%= user.title %></h2>
    <p>
        <a href="/user/<%= user._id %>" >@waynespiegel</a><%= user.description %>
    </p>
</article> 
```

# php - 动态显示/隐藏动态生成 s

> ID：15815009
> 
> 赞同：0
> 
> 时间：2013-04-04T15:07:50.173
> 
> 标签：php, javascript, jquery, forms

我正在使用 PHP 动态生成多个`<select>`字段，每个字段下面有两个`<div>`s。自动选择一个选项，并且`<div>`PHP 根据初始条件自动显示/隐藏 s，但是除了在禁用或启用表单字段中创建表单字段之外，我如何`<div>`根据更改动态切换显示/隐藏?`<select>``div`

对于某些背景，我在页面上显示了所有可以使用的信息，但是`div`s 隐藏了每个未使用的选项（使用`display:none`），并且每个未使用`div`的还有一个禁用的表单字段。当用户在选择框中选择其他选项时，当前显示的`div`需要隐藏，`select`内部`div`需要禁用，新的`div`需要显示并`select`启用。我这样做是因为每个隐藏/显示的表单字段与我将它们发布到 PHP 脚本的名称相同。

所有的`<div>`s 都是`<div id="textdiv-uniqueID">`OR的格式`<div id="seldiv-uniqueID">`（这里`uniqueID`是每组`div`s 的唯一编号），每个`select`都是 的格式`<select name="uniqueID-good_value">`，其中 uniqueID 与对应`div`的 s 相同。

**回顾一下：**我有一组动态生成的选择框和表单域。每个选择框都有两个关联的表单域，每个域都有自己的`<div>`，其中一个将被隐藏/禁用，另一个将显示/启用。When the other option in a given select box is selected, the divs and form fields need to switch roles: the currently hidden/disabled one needs to be shown/enabled, and vice versa.

[这是一个包含基础知识的 jsFiddle](http://jsfiddle.net/sGVHs/)，包括我开始尝试弄清楚 Javascript/jQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:17:00.600

通常，类似于您需要的内容如下所示：

```
$('#uniqueID-good_value').on('change',function (){
    var val= $(this).val();
    if(val==1) {
        $('textdiv-uniqueID').show();
        $('seldiv-uniqueID').hide();
    }else{
        $('textdiv-uniqueID').hide();
        $('seldiv-uniqueID').show();
    }
}); 
```

对于您的情况，您需要在逻辑上做一些工作，以使其与 uniqueid 一起工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:13:22.190

你不能在相关字段上放一个“活动”或“隐藏”类，然后在事情发生变化时交换这个类吗？

例如：

$(".active").removeClass("active").addClass("hidden");

您可以将其放入您选择的小部件上的事件中（我不确定所有可用的事件是什么，但必须有类似 onselect 或 onselected 的东西，并且总是有 onmouseup）

# mysql - MySQL计算特定值的列

> ID：15815011
> 
> 赞同：47
> 
> 时间：2013-04-04T15:08:00.423
> 
> 标签：mysql

我有以下数据库表，我希望能够计算每个销售人员某些产品的销售实例。

```
|------------|------------|------------|
|id          |user_id     |product_id  |
|------------|------------|------------|
|1           |1           |2           |
|2           |1           |4           |
|3           |1           |2           |
|4           |2           |1           |
|------------|------------|------------| 
```

我希望能够创建如下结果集；

```
|------------|-------------|------------|------------|------------|
|user_id     |prod_1_count |prod_2_count|prod_3_count|prod_4_count|
|------------|-------------|------------|------------|------------|
|1           |0            |2           |0           |1           |
|2           |1            |0           |0           |0           |
|------------|-------------|------------|------------|------------| 
```

我正在使用这些数据创建图表，并且再次（如今天早些时候）我无法计算列总数。我试过了;

```
SELECT user_id, 
(SELECT count(product_id) FROM sales WHERE product_id = 1) AS prod_1_count,
(SELECT count(product_id) FROM sales WHERE product_id = 2) AS prod_2_count,
(SELECT count(product_id) FROM sales WHERE product_id = 3) AS prod_3_count,
(SELECT count(product_id) FROM sales WHERE product_id = 4) AS prod_4_count 
FROM sales GROUP BY user_id; 
```

我可以看到为什么这不起作用，因为对于每个带括号的 SELECT，user_id 与主 SELECT 语句中的外部 user_id 不匹配。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-04-04T15:12:22.130

您可以使用[`SUM`](http://dev.mysql.com/doc/refman/5.5/en/group-by-functions.html#function_sum)and执行此操作[`CASE`](http://dev.mysql.com/doc/refman/5.5/en/control-flow-functions.html#operator_case)：

```
select user_id,
  sum(case when product_id = 1 then 1 else 0 end) as prod_1_count,
  sum(case when product_id = 2 then 1 else 0 end) as prod_2_count,
  sum(case when product_id = 3 then 1 else 0 end) as prod_3_count,
  sum(case when product_id = 4 then 1 else 0 end) as prod_4_count
from your_table
group by user_id 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-04-04T15:15:38.487

您正在尝试*旋转*数据。MySQL 没有枢轴函数，因此您必须使用带有`CASE`表达式的聚合函数：

```
select user_id,
  count(case when product_id = 1 then product_id end) as prod_1_count,
  count(case when product_id = 2 then product_id end) as prod_2_count,
  count(case when product_id = 3 then product_id end) as prod_3_count,
  count(case when product_id = 4 then product_id end) as prod_4_count
from sales
group by user_id; 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!2/4266b/4)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T15:11:51.030

看看这是否有效：

```
SELECT a.user_id, 
(SELECT count(b.product_id) FROM sales b WHERE b.product_id = 1 AND a.user_id = b.user_id) AS prod_1_count,
(SELECT count(b.product_id) FROM sales b WHERE b.product_id = 2 AND a.user_id = b.user_id) AS prod_2_count,
(SELECT count(b.product_id) FROM sales b WHERE b.product_id = 3 AND a.user_id = b.user_id) AS prod_3_count,
(SELECT count(b.product_id) FROM sales b WHERE b.product_id = 4 AND a.user_id = b.user_id) AS prod_4_count 
FROM sales a GROUP BY a.user_id; 
```

干杯。注意可能有更好的方法来实现等效的结果。

# google-bigquery - google bigquery 加入每个

> ID：15815015
> 
> 赞同：0
> 
> 时间：2013-04-04T15:08:04.893
> 
> 标签：google-bigquery, jointable

我们在 google bigquery 中使用了新功能“JOIN EACH”，并收到以下错误消息：

```
Select             count( distinct  e.userid  )  , 
               avg(e.amount) , 
               e.country  
from         ( select userid,amount,country,ts from  [flat_table]
               where  event='E' ) as e  
              join    each   
             ( select userid,amount,country,ts from  [flat_table]
               where  event='B' ) as l    
              on   e.userid=l.userid 
  where       e.ts<=l.ts
  group  by   e.country; 
```

**查询失败错误：未知字段：usec**

几天前，上面的相同查询正常工作。发生了什么变化？你能推荐如何正确重写上面的 sqk 吗？我们不能使用 "JOIN" ，只能使用 "JOIN EACH" ，因为它是一个巨大表的自连接查询。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:33:11.537

这是一个查询解析/重写错误，我们正在积极努力修复，并正在寻找解决方法。该错误与处理查询中的嵌套记录有关。如果有一种方法可以在不引用嵌套字段的情况下重写您的查询（注意时间戳具有嵌套结构，因此您可以只使用微秒值），这可能会有所帮助。

# mysql - MySQL查询按一天中的小时对结果进行分组，考虑到夏令时

> ID：15815020
> 
> 赞同：2
> 
> 时间：2013-04-04T15:08:20.130
> 
> 标签：mysql, group-by, dst

我有一个使用类似于此的 sql 查询的报告：

```
SELECT HOUR(somedatetime) AS hour, COUNT(*) AS count
FROM table
GROUP BY HOUR(surveyenddatetime) 
```

我在这里简化了它，省略了可以将结果限制在给定时间段内的 where 子句。它可以很好地获取在所选时间段内输入的按一天中的小时分组的总记录。

但是，它有一个致命的缺陷。当所选时间段包含与运行报告的用户不在同一“时区”的记录时，例如夏令时之前的记录和夏令时之后的记录，则它不起作用。所有记录都以 GMT/UTC 格式存储在日期时间字段中，并通过 Web 前端在 php 中转换为本地时间。但是这个查询在任何这些发生之前运行，php 无法知道分组到每个小时的总数的原始日期是什么。

有没有一种方法可以解决这个查询，仅使用 MySQL 查询将夏令时考虑在内，还是我必须做一些更复杂的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:16:08.567

[`CONVERT_TZ`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_convert-tz)：

```
SELECT 
    HOUR(CONVERT_TZ(`somedatetime`, 'UTC', 'Europe/Amsterdam')) AS `hour`, 
    COUNT(*) AS `count`
FROM table
GROUP BY `hour` 
```

将用户的时区代替“欧洲/阿姆斯特丹”传递到查询中。

另请参阅：[https](https://dev.mysql.com/doc/refman/5.5/en/mysql-tzinfo-to-sql.html) : //dev.mysql.com/doc/refman/5.5/en/mysql-tzinfo-to-sql.html（您可能需要使用时区数据初始化 MySQL。）

# c# - WebApi - 返回要在 HTML 中呈现的图像或电影媒体类型

> ID：15815027
> 
> 赞同：0
> 
> 时间：2013-04-04T15:08:37.570
> 
> 标签：c#, html, asp.net-web-api

我目前需要在我的 WebAPI 控制器上有一个方法，它将存储在我的数据库中的字节数组作为图像或电影返回给我的客户端，其中它将相应地以 html 呈现。

主要问题之一是客户端 html 必须支持到 IE8，因此 HTML5 标签是不可能的。

到目前为止，我的控制器方法如下所示：

```
[AcceptVerbs("GET")]
    public HttpResponseMessage GetFile(int _id)
    {
        try
        {
            var content = result from DB call

            HttpResponseMessage result = new HttpResponseMessage(HttpStatusCode.OK);
            result.Content = new ByteArrayContent(content.File);

            if(content.ContentType.Format == Format.Image)
            {
                result.Content.Headers.ContentType = new MediaTypeHeaderValue("image/png");
                return result;
            }
            else
            {
                result.Content.Headers.ContentType = new MediaTypeHeaderValue("video/x-ms-wmv");
                return result;
            }
        }
        catch (Exception err)
        {
            throw err;
        }
    } 
```

上面的代码运行良好并返回了我需要的数据。在客户端方面，我尝试使用对象 HTML 标签，因为它可以显示电影和图像。所以客户端我有这个：

```
<object width="400" height="400" data="path/to/api"> 
```

这种工作，但它没有正确渲染数据，我实际上必须在数据值更改时手动调整屏幕大小。我收到“资源解释为文档但使用 MIME 类型图像/png 传输”的警告，这是有道理的，因为我没有在 HTML 中指定对象的类型，因为它可以是 2 种类型中的 1 种。

还需要循环播放我也没有弄清楚的视频。

我知道一个大而相当开放的问题，但有谁知道这是否是一种体面的方法，或者可以推荐一种替代方法。

# ruby-on-rails - 控制器中的私有方法“received_messages”

> ID：15815028
> 
> 赞同：0
> 
> 时间：2013-04-04T15:08:38.833
> 
> 标签：ruby-on-rails

我从头开始创建了一个消息收件箱。它已经工作了一个多星期，现在它崩溃了，给我一个“私有方法`received_messages'”错误，标题为“MessagesController#index中的NoMethodError”。

出于某种原因，当我昨天使用应用程序（我不使用终端推送）向 Github 推送新更新时，我的应用程序部分停止工作，我必须修复。我确定当您推送文件时它不会更改您的代码，但这不是第一次发生。任何人都知道我该如何解决这个错误？

当我单击新消息上的提交时，我只会收到错误消息。

消息控制器：

```
class MessagesController < ApplicationController

  before_filter :set_user

  def index
    if params[:mailbox] == "sent"
      @messages = @user.sent_messages
    elsif params[:mailbox] == "inbox"
      @messages = @user.received_messages
    #elsif params[:mailbox] == "archieved"
     # @messages = @user.archived_messages
    end
  end

  def new
    @message = Message.new
    if params[:reply_to]
      @reply_to = User.find_by_user_id(params[:reply_to])
      unless @reply_to.nil?
        @message.recepient_id = @reply_to.user_id
      end
    end
  end

  def create
    @message = Message.new(params[:message])
    @message.sender_id = @user_id
    if @message.save
      flash[:notice] = "Message has been sent"
      redirect_to user_messages_path(current_user, :mailbox=>:inbox)
    else
      render :action => :new
    end
  end

  def show
     @message = Message.find(params[:id])
     @message.readingmessage if @message.recepient == current_user
   end

  def delete_multiple
      if params[:delete]
        params[:delete].each { |id|
          @message = Message.find(id)
          @message.mark_message_deleted(@message.id,@user_id) unless @message.nil?
        }
        flash[:notice] = "Messages deleted"
      end
      redirect_to user_messages_path(@user, @messages)
  end

  private
    def set_user
      @user = current_user
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:20:27.103

正如 apneadiving 和 Teeg 所解释的，一种私有方法正在阻止接收到的消息。我向文件顶部的用户模型添加了一个新的私有方法。将其移至底部，一切都恢复正常。

确保是否添加私有方法将其放置在下方，以免阻塞其他功能。谢谢！

# php - mysql查询以查找列中最长的运行

> ID：15815031
> 
> 赞同：1
> 
> 时间：2013-04-04T15:08:51.630
> 
> 标签：php, mysql

我在 mysql 表中有一个列，其中列出了游戏的获胜者。我正在尝试找到一个查询，该查询将为每个玩家返回最长的获胜次数。或者一种用 php.ini 解释查询的方法。

在这种情况下，它将是 Kate 4，Ed 1，Mike 2，Harry 1，

```
**Winner**
Kate
Kate
Ed
Harry
Ed
Harry
Mike
Mike
Ed
Harry
Kate    
Kate  
Kate
Kate
Ed 
```

提前道歉，因为我对这一切都很陌生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T15:36:21.777

```
SELECT winner, MAX(winningStreak) FROM (
SELECT
winner,
IF(winner=@prev, @rownum:=@rownum+1, @rownum:=1) AS winningStreak,
@prev:=winner
FROM
yourTable
, (SELECT @prev:=NULL, @rownum:=1) vars
/*ORDER BY whateverDeterminesTheOrderOfTheWinners*/
)sq
GROUP BY winner
ORDER BY winningStreak DESC 
```

您需要另一列来确定获胜者的顺序，就像您列出它们一样，并调整查询的注释部分。除此之外，此查询有效，但在 PHP 中确实更容易完成。

看到它住[在这里](http://www.sqlfiddle.com/#!2/4257d/4)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T15:43:12.967

使用变量会使查询更简单，但我想只使用 SQL 来解决它。这是我的查询：

```
SELECT winner, COALESCE(MAX(id2-min_id1), 0)+1
FROM (
  SELECT MIN(w1.id) min_id1, w1.winner, w2.id id2
  FROM
    winners w1 LEFT JOIN winners w2
    ON w1.id < w2.id
       AND w1.winner = w2.winner
  WHERE
    NOT EXISTS (SELECT NULL FROM winners w3
                WHERE w3.winner != w1.winner
                      AND w3.id > w1.id AND w3.id < w2.id)
  GROUP BY
    w2.id, w1.winner
  ) s
GROUP BY
  winner 
```

请[在此处](http://sqlfiddle.com/#!2/d3a02/1)查看小提琴。我使用 ID 是因为没有 ID 或时间戳，无法确定 SQL 查询返回的行的顺序。这假设 ID 没有间隙。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T15:47:49.007

好的，轮到我了……这假设 id 是自动递增的，没有间隙……

```
SELECT winner
     , MAX(streak) longest_streak
  FROM
     ( SELECT a.*
            , MIN( c.id ) - a.id + 1 streak
         FROM results a
         LEFT 
         JOIN results b 
           ON a.id = b.id + 1 
          AND b.winner = a.winner
         LEFT 
         JOIN results c 
           ON a.id <= c.id 
          AND c.winner = a.winner
         LEFT 
         JOIN results d 
           ON c.id = d.id - 1 
          AND d.winner = a.winner
        WHERE b.id IS NULL
          AND c.id IS NOT NULL
          AND d.id IS NULL
        GROUP 
           BY a.id
     ) x
 GROUP
    BY winner
 ORDER  
    BY longest_streak DESC; 
```

# c++ - 为什么shared_ptr不能解析函数接口中的继承关系？

> ID：15815038
> 
> 赞同：3
> 
> 时间：2013-04-04T15:09:07.460
> 
> 标签：c++, templates, boost, c++11

这是一个[简化的示例](http://liveworkspace.org/code/3SRz1U%244)：

```
#include <memory>
#include <vector>

template< class T >
class K 
{
public:
    virtual ~K(){}
};

class KBOUM : public K<int>{};

template< class U >
void do_something( std::shared_ptr< K<U> > k ) { }

int main()
{
   auto kboom = std::make_shared<KBOUM>();
    do_something( kboom );  // 1 : error

   std::shared_ptr< K<int> > k = kboom; // 2 : ok
   do_something( k ); // 3 : ok

} 
```

无论是否使用 boost，无论我使用什么编译器，我都会在 #1 上收到错误，因为`shared_ptr<KBOOM>`不继承自`shared_ptr<K<int>>`. 但是，`KBOOM`确实继承自`K<int>`. 您可以看到 #2 有效，因为 shared_ptr 旨在允许将子类指针隐式传递给基类指针，就像原始指针一样。

所以我的问题是：

1.  是什么阻止了 std::shared_ptr 实现者使其在案例 #1 中工作（我的意思是，假设标准确实阻止了这种情况，应该有原因）；
2.  有没有办法在`auto kboom = std::make_shared<KBOUM>(); do_something( kboom );`不从 KBOOM 继承的 K 中查找 int 类型的情况下进行编写？

注意：我想**避免**函数的用户必须编写

```
std::shared_ptr<K<int>> k = std::make_shared<KBOOM>(); 
```

或者

```
do_something( std::shared_ptr<K<int>>( kboom ) ); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T15:16:36.677

这与`std::shared_ptr<>`. 实际上，您可以将其替换为任何类模板并获得相同的结果：

```
template<typename T> struct X { };

class KBOUM : public X<int> { };

template<typename U>
void do_something(X<K<U>> k) { }

int main()
{
    X<KBOUM> kboom;
    do_something(kboom); // ERROR!

    X<K<int>> k;
    do_something(k); // OK
} 
```

这里的问题是类型参数推导试图找到一个**完美的匹配**，并且没有尝试派生到基础的转换。

只有*在*所有模板参数都被明确地推导出来产生完美匹配（标准允许的少数例外）之后，在重载决议期间才考虑参数之间可能的转换。

**解决方法：**

可以根据[KerrekSB](https://stackoverflow.com/users/596781/kerrek-sb)在[StackOverflow 上的问答](https://stackoverflow.com/a/12182195/1932150)中发布的解决方案找出解决方法。首先，我们应该定义一个类型特征，它允许我们判断某个类是否派生自某个模板的实例：

```
#include <type_traits>

template <typename T, template <typename> class Tmpl>
struct is_derived
{
    typedef char yes[1];
    typedef char no[2];

    static no & test(...);

    template <typename U>
    static yes & test(Tmpl<U> const &);

    static bool const value = sizeof(test(std::declval<T>())) == sizeof(yes);
}; 
```

然后，我们可以使用 SFINAE 重写`do_something()`如下（注意 C++11 允许函数模板参数的默认参数）：

```
template<class T, std::enable_if<is_derived<T, K>::value>* = nullptr>
void do_something(X<T> k) 
{ 
    // ...
} 
```

通过这些更改，程序将正确编译：

```
int main()
{
    X<KBOUM> kboom;
    do_something(kboom); // OK

    X<K<int>> k;
    do_something(k); // OK
} 
```

这是一个[活生生的例子](http://liveworkspace.org/code/3SRz1U$19)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T17:12:13.037

Andy Prowl 对这个问题给出了完美的解释，并提出了一个聪明的解决方法。我想通过一些努力，解决方法也可以适应 C++03。（我没有尝试过。这只是一个猜测。）

我只想建议一个更简单的解决方法，它只适用于 C++11。您需要做的就是创建这个重载：

```
template< class T >
auto do_something(const std::shared_ptr<T>& k ) ->
    decltype(do_something( std::shared_ptr< K<int> >( k )))
{
    return do_something( std::shared_ptr< K<int> >( k ));
} 
```

基本上，它`do_something( std::shared_ptr< K<int> >( k ))`通过`decltype`（和 SFINAE）探测是否合法。如果是这样，则此重载执行“转换为基类”并将调用委托给`shared_ptr`基类的重载。

**更新：**

更一般地说，如果你有一个函数，说它`do_something`接受 a`shared_ptr<Base>`并且你希望编译器在你传递 a 时调用它，`shared_ptr<T>`其中`T`任何类型是公开派生的，`Base`那么解决方法是：

```
class Base {};
class Derived : public Base {};

// The original function that takes a std::shared_ptr<Base>
void do_something( const std::shared_ptr<Base>& ) {
    // ...
}

// The workaround to take a shared_ptr<T> where T publicly derives from Base
template <typename T>
auto do_something(const std::shared_ptr<T>& pd) ->
    decltype( do_something( std::shared_ptr<Base>( pd ) ) ) {
   return do_something( std::shared_ptr<Base>( pd ) );
}

// Example:
int main() {
    auto pd = std::make_shared<Derived>();
    do_something( pd );   
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T17:30:35.813

```
#include <memory>
#include <utility>

template< template<typename T>class Factory, typename T >
struct invert_factory {};

template< template<typename T>class Factory, typename U >
struct invert_factory< Factory, Factory<U> > {
  typedef U type;
};
template<typename T>
struct K {};

template<template<typename>class Factory, typename Default, typename U>
U invert_implicit_function( Factory<U> const& );
template<template<typename>class Factory, typename Default>
Default invert_implicit_function( ... );

template<template<typename>class Factory, typename U>
struct invert_implicit {
private:
   struct unused_type{};
public:
   typedef decltype( invert_implicit_function<Factory, unused_type>( std::declval<U>() ) ) type;
   enum{ value = !std::is_same< unused_type, type >::value };
};

template<typename spKU, typename=void >
struct is_shared_ptr_to_KU {};

template<typename spKU>
struct is_shared_ptr_to_KU< spKU,
  typename std::enable_if<
     invert_implicit< K,
          typename invert_factory<std::shared_ptr, spKU>::type
     >::value
  >::type
>:std::true_type {};

template< typename spKU >
auto do_something( spKU )->typename std::enable_if< is_shared_ptr_to_KU<spKU>::value >::type { }

struct Blah:K<int> {};
int main() {
  static_assert(invert_implicit< K, K<int> >::value, "one");
  static_assert(invert_implicit< K, Blah >::value, "two");
  do_something( std::shared_ptr<K<int>>() );
  do_something( std::shared_ptr<Blah>() );
 // do_something( 0 );
 // do_something( std::shared_ptr<int>() );
} 
```

需要一点润色，但可以满足您的要求。

处理`shared_ptr<K<U>>`采取了额外的间接级别。

如果需要，还包括实际提取`U`类型的方法。（如果`invert_implicit::value`是真的，那么`invert_implicit::type`是`U`）。

请注意，可以隐式转换为`K<U>`限定的类——`is_derived`如果您愿意，也可以进行检查。

# ios - iOS 表单键盘不会消失

> ID：15815041
> 
> 赞同：3
> 
> 时间：2013-04-04T15:09:15.577
> 
> 标签：ios, objective-c, uinavigationcontroller, uitextview

我知道我必须打电话

```
- (BOOL)disablesAutomaticKeyboardDismissal {
    return NO;
}
//this dismiss keyboard on ios
- (BOOL) textViewShouldBeginEditing:(UITextView *)textView {
    [self.comments resignFirstResponder];
    return YES;
} 
```

为了关闭表单上的键盘，我也知道`disablesAutomaticKeyboardDismissal`如果我有导航控制器，我必须调用它。

问题是：我以编程方式使用导航控制器创建表单，例如：

```
UIStoryboard*  sb = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:[NSBundle mainBundle]];
SettingsViewController *settingsVC = [sb instantiateViewControllerWithIdentifier:@"settingsViewController"];
//add navigation controller 
UINavigationController *modalViewNavController= [[UINavigationController alloc] initWithRootViewController:settingsVC];
modalViewNavController.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
modalViewNavController.modalPresentationStyle = UIModalPresentationFormSheet;
[self presentModalViewController:modalViewNavController animated:YES]; 
```

所以我没有用于表单的导航控制器类，在这种情况下如何关闭键盘？

我必须创建一个导航视图控制器吗？

**更新：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：： :::::::::::**

最终在故事板中创建导航控制器并调用`disablesAutomaticKeyboardDismissal`导航控制器的视图控制器，这解决了问题，但我仍然想知道如何在不创建导航控制器类的情况下做到这一点。

欢迎任何意见......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-21T14:15:29.227

你能试试下面的代码吗？

```
- (void)viewDidLoad {
    [super viewDidLoad];

    UITapGestureRecognizer *gestureRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(hideKeyboard)];
    gestureRecognizer.cancelsTouchesInView = NO;
    [self.view addGestureRecognizer:gestureRecognizer];
}

- (void)hideKeyboard {
    [self.view endEditing:YES];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-21T10:07:43.033

下面的代码对我有用：

```
@interface UINavigationController (dismissKeyBoard)

@end

@implementation UINavigationController (dismissKeyBoard)

- (BOOL)disablesAutomaticKeyboardDismissal
{
    return NO;
}

@end 
```

# java - OnPageStarted 从不在本地使用

> ID：15815052
> 
> 赞同：0
> 
> 时间：2013-04-04T15:09:45.553
> 
> 标签：java, android, webview

我这里有问题。日食说我的方法“onPageStarted”从未在本地使用过。

运行应用程序，调用方法“onPageFinished”，但根本不调用“onPageStarted”。

有没有人有任何线索？

```
myWebView.setWebViewClient(new SiteActivityClient(){
   public void onPageStarted(WebView view, String url){         
   }
   public void onPageFinished(WebView view, String url){
   }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:14:39.093

可能是因为您缺少一个参数，因此创建了一个新方法而不是从 WebViewClient 实现一个。

```
public void onPageStarted (WebView view, String url, Bitmap favicon) 
```

所以你不见了`Bitmap favicon`

# c# - 从逗号分隔列表中对数据表进行排序

> ID：15815053
> 
> 赞同：0
> 
> 时间：2013-04-04T15:09:47.490
> 
> 标签：c#, asp.net, .net, vb.net, datatable

我正在尝试找到一种方法来对数据表进行自定义排序。

我有一个逗号分隔的字符串列表，例如“John,Jake,Joe,Julie”，我在数据表中的实际记录排序为：Jake,Joe,John,Julie

如何根据我的列表更改数据表排序？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:45:58.530

If you don't need the DataTable, you could do LINQ to CSV. See [this](http://www.thinqlinq.com/Post.aspx/Title/LINQ-to-CSV-using-DynamicObject) and [this](http://www.thinqlinq.com/Post.aspx/Title/LINQ-to-CSV-using-DynamicObject-and-TextFieldParser).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:15:33.980

我假设这是家庭作业，所以我将描述一个算法并让你实现它;-)

对于逗号分隔列表中的每个名称

*   从源表中选择名称与列表中的当前名称相同的行
*   将结果联合/附加到先前迭代中已经收到的结果（例如，到新表/记录集/数组中）

# parsing - 如何在 Neo4j 中解析索引查询？

> ID：15815057
> 
> 赞同：0
> 
> 时间：2013-04-04T15:09:57.207
> 
> 标签：parsing, lucene, neo4j

我多次查询 neo4j 的自动索引，试图通过属性*ID*检索节点。它在大多数情况下运行良好，但如果我的查询包含*lucene 特殊字符*(+ - && || ! ( ) { } [ ] ^ " ~ * ? : ) 我会得到 ParseException。

我尝试使用以下代码解析查询字符串（如此[处](http://www.javalobby.org/java/forums/t86124.html)建议）：

```
String escapeChars ="[\\\\+\\-\\!\\(\\)\\:\\^\\]\\{\\}\\~\\*\\?]"; 
```

`String escaped = userInput.replaceAll(escapeChars, "\\\\$0");`

因此，索引查询返回 null。

难道我做错了什么？有没有更好的方法来逃避这些角色？

编辑：

我也尝试使用 Lucene 的`QueryParser.escape(query)`方法，但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:28:40.277

如果可以的话，可能更容易把它放在引号中（`\\`无论如何，双引号需要在它们前面，在 Cypher 中）。

```
id:"my_id_with*123y47123&" 
```

[http://console.neo4j.org/r/bpxvzv](http://console.neo4j.org/r/bpxvzv)

# python-2.7 - 使用 scipy odeint 进行集成

> ID：15815067
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:10:23.920
> 
> 标签：python-2.7, scipy

为什么同一问题的以下两个版本会给出不同的结果 y_phi，而所有参数都相同，并且随机值在两个版本中都以相同的值作为种子？我知道 Version_1 给出了正确的结果，而 Version_2 给出了错误的结果，为什么会这样？我在哪里犯了 Version_2 错误？

版本_1：

```
from numpy import *
import random
from scipy.integrate import odeint

def f(phi, t, alpha):
    v_phi = zeros(x*y, float)
    for n in range(x*y):
        cmean = cos(phi[n])
        smean = sin(phi[n])
        v_phi[n] = smean*cos(phi[n]+alpha)-cmean*sin(phi[n]+alpha)
    return v_phi

x = 5
y = 5
N = x*y
PI = pi
alpha = 0.2*PI
random.seed(1010)
phi = zeros(x*y, float)
for i in range(x*y):
    phi[i] = random.uniform(0.0, 2*PI)
t = arange(0.0, 100.0, 0.1)

y = odeint(f, phi, t, args=(alpha,))
y_phi = [y[len(t)-1, i] for i in range(N)]
print y_phi 
```

版本_2：

```
def f(phi, t, alpha, cmean, smean):
    v_phi = zeros(x*y, float)
    for n in range(x*y):
        v_phi[n] = smean[n]*cos(phi[n]+alpha)-cmean[n]*sin(phi[n]+alpha)
    return v_phi

x = 5
y = 5
N = x*y
PI = pi
alpha = 0.2*PI
random.seed(1010)
phi = zeros(x*y, float)
for i in range(x*y):
    phi[i] = random.uniform(0.0, 2*PI)
t = arange(0.0, 100.0, 0.1)

cmean = []
smean = []
for l in range(x*y):
    cmean.append(cos(phi[l]))
    smean.append(sin(phi[l]))

y = odeint(f, phi, t, args=(alpha, cmean, smean,))
y_phi = [y[len(t)-1, i] for i in range(N)]
print y_phi 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:47:49.843

在第一种情况下`smean = cos(phi(t)[n])`，它取决于 phi 的当前值，但在第二种情况下，它`smean = cos(phi(0)[n])`仅取决于初始值。（同样对于`cmean`）。

顺便说一句，您也可以使用[http://en.wikipedia.org/wiki/Rubber_duck_debugging找到这个问题](http://en.wikipedia.org/wiki/Rubber_duck_debugging)

# web.py - 错误 405 web.py

> ID：15815071
> 
> 赞同：1
> 
> 时间：2013-04-04T15:10:35.537
> 
> 标签：web.py

如您所见，我收到错误 405，这是我的代码和我对问题的猜测。代码非常基本，它们是 3 个文件，main.py、blog.py 和 form.html。作为附加信息：此代码使用会话、子应用程序和模板。

主要.py——

```
import web
import blog

urls = (
  "/blog", blog.app_blog,
  "/(.*)", "index"
)

web.config.debug = False
app = web.application(urls, locals())
session = web.session.Session(app, web.session.DiskStore('sessions'))    
render = web.template.render('views/', globals = {'session': session})

class index:

    def GET(self, path):
        session.names = ''
        session.surnames = ''
        session.nin = ''
        session.address = ''
        session.phone = ''
        session.email = ''
        return render.form()

if __name__ == "__main__":
    app.run() 
```

--

博客.py——

```
import web
urls = (
  "", "reblog",
  "/", "blog"
)

class reblog:
    def GET(self): raise web.seeother('/')

class blog:
    def GET(self):
        return "getblog"
    def POST(self):
        return "postblog"

app_blog = web.application(urls, locals()) 
```

-- form.html--

```
<form method=post action=blog>
    <ul>
        <li><input name=names required maxlength=24 placeholder="Name" value="$session.names"></li>
        <li><input name=surnames required maxlength=24 placeholder="Surname" value="$session.surnames"></li>
        <li><input name=nin requiered maxlength=12 placeholder="RUT" value="$session.nin"></li>
        <li><input name=address required maxlenght=64 placeholder="Address" value="$session.address"></li>
        <li><input name=phone required maxlength=10 placeholder="Phone" value=$session.phone></li>
        <li><input name=email type=email required maxlenght=254 placeholder="email" value=$session.email></li>
        <li><input name=password type=password required placeholder="password"></li>
        <li><input name=confirmpassword type=password required placeholder="Confirmar pass"></li>
        <li><input type=submit value="registrarse"></li>
    </ul> 
```

问题是 POST 不使用用户输入，而是给我一个错误 405，就像这样：“HTTP/1.1 POST /blog” - 405 Method Not Allowed

并且浏览器打印无。

伙计们，请帮帮我，这很令人沮丧，如果你知道我的意思的话。

预先感谢。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:58:20.910

发生这种情况是因为`/blog`url 映射到`class reblog`没有`POST`定义方法。

# sql-server - 存储过程中的 SQL Server“拒绝查看任何数据库到”

> ID：15815072
> 
> 赞同：0
> 
> 时间：2013-04-04T15:10:36.713
> 
> 标签：sql-server, stored-procedures

我有一个脚本，它为给定的 {databaseName} 生成一个数据库，然后为这个数据库的给定 {loginName} 创建一个登录名。

然后我想限制这个用户只能查看这个数据库，而不能查看其他用户。

我通过以下方式实现了这个工作：

```
USE [{DatabaseName}]
GO
ALTER AUTHORIZATION ON DATABASE::[{DatabaseName}] to [{LoginName}]
GO
USE [master]
GO
DENY VIEW ANY DATABASE TO [{LoginName}]
GO 
```

我现在已将其放入存储过程中，但我无法更改为 [master] 数据库来执行最后一行：

```
DENY VIEW ANY DATABASE TO [{LoginName}] 
```

有没有办法限制用户从存储过程中查看其他数据库？

存储过程当前位于另一个数据库上，但我可以移动它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:35:24.533

您可以通过执行以下操作更改给定 SQL 命令的数据库上下文：

```
master.dbo.sp_executesql N'print db_name()' 
```

虽然我怀疑可能有更好的方法来做你想做的事情

# java - BigQuery - 从 JAVA API 加载时出现后端错误

> ID：15815073
> 
> 赞同：3
> 
> 时间：2013-04-04T15:10:38.527
> 
> 标签：java, api, google-bigquery

尝试使用 JAVA API 设置加载作业时出现 503 - 后端错误。

我要加载的文件位于 Google Cloud Storage 上，如果我尝试从 BigQuery Web 界面加载数据，告诉我要从 Google Cloud Storage 加载，一切正常。

我使用 API 的方式可能有问题。

这是代码：

```
 String url = "[GOOGLE_CLOUD_STORAGE_URL];

    Job job = new Job();
    JobConfiguration config = new JobConfiguration();
    JobConfigurationLoad loadConfig = new JobConfigurationLoad();

    config.setLoad(loadConfig);

    job.setConfiguration(config);

    List<String> sources = new ArrayList<String>();
    sources.add("gs://" + url);
    loadConfig.setSourceUris(sources);

    TableReference tableRef = new TableReference();
    tableRef.setDatasetId("Foo");
    tableRef.setTableId("Bar");
    tableRef.setProjectId(PROJECT_ID);
    loadConfig.setDestinationTable(tableRef);

    List<TableFieldSchema> fields = new ArrayList<TableFieldSchema>();
    TableFieldSchema field = new TableFieldSchema();

            ..... A LOT OF FIELDS

            field.setName("real_dollars_balance");
    field.setType("float");

    fields.add(field);
            TableSchema schema = new TableSchema();
    schema.setFields(fields);
    loadConfig.setSchema(schema);

    Insert insert = bigquery.jobs().insert(PROJECT_ID, job);
    insert.setProjectId(PROJECT_ID);
    JobReference jobId = insert.execute().getJobReference(); 
```

由于插入操作失败，我无法获得有效的作业参考，我在 BigQuery 上看不到任何新作业。我在 BigQuery 上通过了正确的身份验证，我可以浏览数据集和表格。我错过了什么吗？

编辑-“execute()”方法调用抛出一个异常，GoogleJsonResponseException，包含：

```
com.google.api.client.googleapis.json.GoogleJsonResponseException: 503 Service           Unavailable
 {
   "code" : 503,
   "errors" : [ {
      "domain" : "global",
      "message" : "Backend Error",
      "reason" : "backendError"
    } ],
   "message" : "Backend Error"
  } 
```

而且，它永远不会变得“可用”。我真的不知道我错过了什么。你们是如何设置自动程序以在 Google BigQuery 上加载数据的？Google 上的文档并不清楚，就像我对这样的服务所期望的那样。

# c++ - C++ 迭代，文件 i/o

> ID：15815074
> 
> 赞同：0
> 
> 时间：2013-04-04T15:10:39.000
> 
> 标签：c++, file, io, iteration

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <stdlib.h> 

using namespace std;

int main()
{
    //Input .txt file
    ifstream inputFile ("input.txt");

    try
    {
        int i = 1;  //Line iterator
        int vertices = 0;
        int faces = 0;

        string line;
        while (getline(inputFile, line))
        {
            //Take number from line 4, set as variable "vertices"
            if (i == 3)
            {
                getline (inputFile,line); 
                size_t last_index = line.find_last_not_of("0123456789");  
                string str = line.substr(last_index);
                vertices = atoi(str.c_str());  //Convert to int
                cout << "vertices " + str << endl;
            }

            //Take number from line 11, set as variable "triangles"
            if (i == 11)
            {
                getline (inputFile,line); 
                size_t last_index = line.find_last_not_of("0123456789");
                string str = line.substr(last_index);
                faces = atoi(str.c_str());           //Convert to int
                cout << "faces " + str << endl;
            }

            if (i == 13)
            {
                i++;
                break;
            }

            cout << "line: " + i << endl;  //Prints line number
            i++;

        }
    } catch(const char* error) {
        cout << "Cannot read file, please try again." << error;
    }

    return 0;
} 
```

该程序只是试图读取文件，从几行中获取一个数字，并为每一行打印“line：”以及相应的行号。看起来 C++ 的迭代方式与 Java 不同？由于某种原因，该程序输出：

```
*ine: 
ne: 
vertices  752
e: 
: 

Cannot read mesh, please try again.
faces r
annot read mesh, please try again.
nnot read mesh, please try again.* 
```

我不知道为什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:12:56.673

这一行：

```
cout << "line: " + i << endl; 
```

应该：

```
cout << "line: " << i << endl; 
```

您`+`正在添加`i`到字符串 constant `"line: "`，其效果是每次在循环中将一个字符从前面敲掉（并最终离开结尾，导致未定义的行为）。

您不能以您尝试的方式将对象添加到 C++ 中的字符串，但您可以`cout`通过重复使用`<<`.

然后你在这里遇到同样的问题：

```
cout << "vertices " + str << endl; 
```

和这里：

```
cout << "faces " + str << endl; 
```

# c - 在 C 中定义时间间隔

> ID：15815077
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:10:46.167
> 
> 标签：c, time

我想在 C 中定义时间间隔。
例如，我想每 20 秒执行一次任务；下面的代码对这个任务是否正确？

澄清一下，我们的目标是与时间间隔一起工作。例如，我想每 20 秒读取一次数据包，并且在每个间隔结束时我想更改一些参数。

```
double blocktime = 20.000000;
clock_t current, next;

current = clock();
    while(trace_read_packet(trace,packet)> 0 ){
        //doing some tasks
        next = clock(); 
        if ((double((next - current) / CLOCKS_PER_SEC))== blocktime) // if it is end of the  interval do some tasks
        {
                          //doing some task
            current = next;

        }
    }//end of while 
```

和其他问题我如何定义与时间一起工作的循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:21:55.787

当你可以帮助它时，永远不要`==`在这样的情况下使用。你正在为失败做准备。如果由于某种原因代码被延迟并且您没有在 20 时将其击中，那么您就完蛋了，您将永远无法完成任务。

您应该“假设错过”并这样做：

```
if ((double((next - current) / CLOCKS_PER_SEC))>= blocktime) 
```

* * *

是的，取下一个电流并除以 CLOCKS_PER_SEC 会给你使用 cpu 时间。注意我说*CPU 时间使用*是因为[`clock()`](http://linux.die.net/man/3/clock)不报告睡眠时间，所以如果你`sleep()`在代码中使用调用`//doing some tasks`，这将是不准确的。否则，此代码应该与您尝试执行的操作足够接近。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:11:23.850

您的方法可能会使程序占用 100% 的 cpu 时间：程序将永久检查是否该运行`some_task()`。为什么不使用睡眠（）：

```
while (1) {
  /* packet handling.. */
  sleep(20);
  some_task();
} 
```

# c# - 除非 onPropertyChanged 被触发，否则将可观察集合绑定到列表框项源不会更新

> ID：15815079
> 
> 赞同：0
> 
> 时间：2013-04-04T15:10:49.220
> 
> 标签：c#, wpf, mvvm, observablecollection

我正在尝试使用列表框显示上传文件的文件名列表。我在列表框中有上传、打开和删除文件的按钮。我正在使用 mvvm 模式并将 itemsource 绑定到可观察的集合。当我修改集合（即：上传或删除）时，列表框不会刷新以反映集合更改时的更改。我确信我实现这一点的方式很糟糕。在这一点上，我对可观察集合如何通知更改感到完全困惑。下面是我的代码：

```
 <ListBox x:Name="Listbox1"    
          SelectedItem="{Binding SelectedFile}" 
          SelectedIndex="{Binding SelectedIndexNum}"
          ItemsSource="{Binding Path=FileNames, UpdateSourceTrigger=PropertyChanged}">                            
 </ListBox>
 <Button Content="UploadFile" 
         Command="{Binding Path=UploadFileCommand}" 
 </Button>

 <Button Content="Delete File" 
         Command="{Binding Path=DeleteFileCommand}" 
 </Button> 
```

视图模型属性：

```
 public ObservableCollection<string> FileNames
    {
        get
        {
            if (this.SomeDataStruc.UploadedFileDataCollection == null || this.SomeDataStruc.UploadedFileDataCollection .Count() <= 0)
            {
                return new ObservableCollection<string>();
            }
            else
            {
                var uploadedFileList = this.SomeDataStruc.UploadedFileDataCollection .Where(r => r.Id == this.SomeDataStruc.Id);
                var filenames = new ObservableCollection<string>(uploadedFileList.Select(c => c.FileName));//.ToList();
                return filenames;
            }
        }          
    } 
```

请注意 SomeDataStruc 有一个可观察的集合。这个 UploadedFileData 有很多字段，我只在列表框中显示文件名。

```
 private void DeleteReport(object parameter)
    {
        this.UploadedFileDataCollection[_selectedIndex].Status = DataStatusEnum.Deleted;

        this.SomeDataStruc.UploadedFileDataCollection.RemoveAt(_selectedIndex);

        this.OnPropertyChanged("FileNames"); // i need to do this...Listbox doesnt update without this.

    } 
```

我究竟做错了什么。我应该处理 collectionchanged 事件吗？如果是，为什么？这不是可观察收集的重点......它自己通知吗？

我检查了许多类似的主题。但这似乎并没有消除我的困惑。请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T16:15:51.050

您的问题是 FileNames 属性总是返回一个新的 ObservableCollection。

如果你有这样的代码：

```
private ObservableCollection<string> _fileNames;

public ObservableCollection<string> FileNames
{
    get
    {
        if(_fileNames == null) 
        { 
            _fileNames = new ObservableCollection<string>(); 
        }
        return _fileNames;
    }
} 
```

然后，对 FileNames 集合的任何更改都会导致通知和您的 UI 被更新。

例如

```
private void LoadFileNames()
{
    FileNames.Clear();
    foreach( ... ) 
    { 
        FileNames.Add(...);  // collection changed notification here
    }
} 
```

由于每次使用 FileNames 时都会更改集合（效率低下），因此您需要调用`this.OnPropertyChanged("FileNames");`以告知 UI 整个集合已被替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:20:10.720

这是正确的行为，因为您不会从 FileNames 中删除任何内容，而只是从作为常规列表的 UploadedFileDataCollection 中删除。很明显，您需要提高 propertyChanged 以使 UI 根据 UploadedFileDataCollection 中的剩余项目重新创建 FileNames 列表

# oop - 对于面向对象的 2D 模拟游戏来说，最好的网络语言是什么？

> ID：15815080
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:10:49.983
> 
> 标签：oop, web, game-engine

堆栈溢出！我希望或多或少地制作一个非常、非常简单的回合制 4X 游戏来获得乐趣，并学习 OOP 编程。我有 HTML、PHP、MySQL 和非 Web 语言的基本知识，但没有什么是真正“动态”的，而这正是我所需要的。

我的最终结果希望是这样[的（我的灵感是极其复杂的 Aurora 4X 的屏幕截图）](http://tof.canardpc.com/view/07a39151-47ef-467f-b327-6ee6539897d8.jpgg)。我想用 HTML5 Canvas、半静态 UI、许多交互的对象以及一些矢量数学和物理来绘制简单的形状和文本。

这甚至有可能成为一个初学者项目吗？我希望如此！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:37:56.647

您可以考虑使用 Unity 3D 之类的游戏引擎。如果您愿意，它将允许您开发基于网络的游戏和其他平台。网络上有大量视频和教程可帮助您入门。C#语言比较容易上手；它将使您对 OOP 有一个很好的理解。

[http://www.3dbuzz.com](http://www.3dbuzz.com)是一个很好的资源。

或者，Java 编程语言是一种很好的 OOP 语言，也相对容易学习。

# c# - IronPython 的 Gurobi API 异常 (GRBException)

> ID：15815084
> 
> 赞同：0
> 
> 时间：2013-04-04T15:11:01.477
> 
> 标签：c#, .net, ironpython, gurobi

我在通过 IronPython 使用 C#/.NET 库运行 Gurobi 优化模型时遇到问题。

我有一种方法可以通过变量的名称（即 GRBModel.GetVarByName）访问变量，例如

```
 public GRBVar variable(i,t)
    {
        try 
        {
            GRBModel M = getModel();
            string varname = varname(i,t);
            GRBVar var = M.GetVarByName(varname);
            return var;
        }
        catch (GRBException ex)
        {
            System.Console.WriteLine(ex.ToString());
            throw new GRBException(ex.ToString());
        }
    } 
```

问题是在我的 IronPython 脚本上，当我尝试访问一个不存在的变量时，什么也没有发生……消息没有出现在控制台上。我做错了什么？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:26:50.413

我认为您在某处缺少退货声明；如果您捕获到异常，则该方法不会返回。（在这种情况下不会出现 C# 编译器错误吗？）

如果此方法仅适用于 IronPython，您可以让异常传递到 IronPython 并在那里处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T17:55:41.900

根据Gurobi .NET 参考手册中的[这个](http://www.gurobi.com/documentation/5.1/reference-manual/node516)`GRBException`页面，继承自 .NET [Exception](http://msdn.microsoft.com/en-us/library/system.exception.aspx)类。要从`Exception`基础类获取错误消息，您应该使用[Message](http://msdn.microsoft.com/en-us/library/system.exception.message.aspx)属性而不是`ToString()`方法，默认情况下，该方法通常只显示引用类的类名。

换句话说，将`catch`子句更改为：

```
catch (GRBException ex)
{
    System.Console.WriteLine(ex.Message);
} 
```

或者，您可以输出特定于该类的[ErrorCode](http://www.gurobi.com/documentation/5.1/reference-manual/node518)属性。`GRBException`

# javascript - jQuery，下一个，上一个，循环到第一个和最后一个

> ID：15815085
> 
> 赞同：0
> 
> 时间：2013-04-04T15:11:04.453
> 
> 标签：javascript, jquery

抱歉这个令人困惑的标题。我想做的是一个函数（或者只是一个简单的方法），它会做简单的**.next()**，但如果没有下一个元素，首先匹配。**.prev()**也是如此- 如果没有前一个元素，则匹配最后一个。所以我这样做了：

```
var current_selected = getSelected();
if(current_selected.length) {
    var prev = current_selected.prev();
    if(prev.length) {
        setSelected(prev);
        return;
    }
}
setSelected(getLast()); 
```

但我真的不喜欢它，我认为有一些漂亮的方法可以做到这一点。有什么想法吗？( **getSelected**和**getLast**返回 jQuery 对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T15:17:24.573

您可以创建一些方便的小插件：

```
$.fn.nextWrap = function() {
    var $next = this.next();
    if ($next.length) return $next;
    return this.siblings().first();
};

$.fn.prevWrap = function() {
    var $prev = this.prev();
    if ($prev.length) return $prev;
    return this.siblings().last();
}; 
```

然后你可以简单地做`$('#something').nextWrap()`or `$('#something').prevWrap()`。

这是一个快速演示：http: [//jsfiddle.net/qpDKL/](http://jsfiddle.net/qpDKL/)

**注意：**这将主要表现得像`prev()`and `next()`（当然，带有换行行为），但它不支持`prev|next(selector)`语法。

* * *

编辑：这是一个稍微简洁的插件语法，因为它们几乎相同：

```
$.each(['next', 'prev'], function(i, nextOrPrev) {
    $.fn[nextOrPrev + 'Wrap'] = function() {
        var $item = this[nextOrPrev]();
        if ($item.length) return $item;
        return this.siblings()[nextOrPrev === 'next' ? 'first' : 'last']();
    };
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:16:02.517

这将适用于`prev`案例

```
var current_selected = getSelected();

var prev = current_selected.prev();
if(prev.length) {
    setSelected(prev);
} else {
    setSelected(getLast());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T15:18:07.157

我能想到的最好方法是拥有一个要循环的元素数组。您可以通过两种方式循环遍历数组：

```
array.push(array.shift()); 
```

或者

```
var count = 0;
function cycle() {
    return array[count++ % array.length];
} 
```

我认为前者看起来更干净。

[http://jsfiddle.net/ExplosionPIlls/feeF5/](http://jsfiddle.net/ExplosionPIlls/feeF5/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T15:21:02.843

这些线周围的东西：

```
if (!$('selected').next().length)
    return $('selected').parent().children().first();
else
    return $('selected').next();

if (!$('selected').prev().length)
    return $('selected').parent().children().last();
else
    return $('selected').prev(); 
```

# wcf - 在 WSDL 文件中包含模式类型

> ID：15815095
> 
> 赞同：8
> 
> 时间：2013-04-04T15:11:36.657
> 
> 标签：wcf, web-services, xsd, wsdl, contract-first

我手动创建了一个 WSDL，它只有一个操作，没有输入参数，也没有输出参数。

当我尝试从此 WSDL 创建客户端时出现以下错误：

> 无法导入 wsdl:portType 详细信息：运行 WSDL 导入扩展时引发异常：System.ServiceModel.Description.DataContractSerializerMessageContractImporter 错误：带有目标命名空间的架构' [http://www.xmlns.mycompany.com/GAME/service/Associate/ 1.1/](http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/) ' 找不到。错误源的 XPath： //wsdl:definitions[@targetNamespace=' [http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/](http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/) ']/wsdl:portType[@name='GAMEAssociateIntf'] C :\toolbox\BlueTest\BloodRedTest\BloodRedTest\Service

（将`types` 在客户端中使用）需要从 WSDL 中存在的 XML 生成。我认为，在添加服务参考时，由于 XML 中的一些错误，该工具无法创建它。**xsd**似乎是问题所在。

需要在 WSDL 中进行哪些更改才能创建代理？

注意：我试图包含在 WSDL 本身中定义的 xml 类型。[我不需要单独的文件来定义模式]

**WSDL**

```
<?xml version="1.0" encoding="UTF-8"?>
<definitions name="GAMEAssociate" 
         targetNamespace="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/"
         xmlns:tns="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/"
         xmlns="http://schemas.xmlsoap.org/wsdl/" 
         xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" 
         xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" 
         xmlns:xsd="http://www.w3.org/2001/XMLSchema"
         xmlns:wsp="http://www.w3.org/ns/ws-policy"
         >

<types>
<xsd:schema>
</xsd:schema>

<xsd:element name="myData">
  <xsd:complexType />
</xsd:element>

<xsd:element name="myDataResponse">
  <xsd:complexType />
</xsd:element>

</types>

<message name="getAllVicePresidentsRequest">
<part element="tns:myData" name="getAllVicePresidentsRequest"/>
</message>

<message name="getAllVicePresidentsResponse">
<part element="tns:myDataResponse" name="getAllVicePresidentsResponse"/>
</message>

<portType name="GAMEAssociateIntf">
<operation name="getAllVicePresidents">
  <input message="tns:getAllVicePresidentsRequest"/>
  <output message="tns:getAllVicePresidentsResponse"/>
</operation>
</portType>

<binding name="GAMEAssociateIntfBinding" type="tns:GAMEAssociateIntf">
<soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>

<operation name="getAllVicePresidents">
  <soap:operation soapAction="http://www.xmlns.mycompany.com/GAME/wsdl/AssociateIntf/1.4/getAllVicePresidentsRequest"
                  style="document"/>
  <input>
    <soap:body use="literal"/>
  </input>
  <output>
    <soap:body use="literal"/>
  </output>

</operation>

</binding>

<service name="GAMEAssociate">
<port binding="tns:GAMEAssociateIntfBinding" name="GAMEAssociateSOAP">
  <soap:address location="http://localhost:8014/associateservice/GAMEAssociate.svc"/>
</port>
</service>

</definitions> 
```

**参考文献**：

1.  [WSDL - 无输入 - 最佳实践](https://stackoverflow.com/questions/1108736/wsdl-no-input-best-practice)
2.  [此 WCF 错误是什么意思：“自定义工具警告：无法导入 wsdl:portType”](https://stackoverflow.com/questions/1872865/what-does-this-wcf-error-mean-custom-tool-warning-cannot-import-wsdlporttype)
3.  [手动编写 WSDL 1.1 Web 服务契约](http://blog.gamatam.com/2011/01/writing-wsdl-11-web-service-contract-by.html)
4.  [编写契约优先的 Web 服务](http://static.springsource.org/spring-ws/sites/2.0/reference/html/tutorial.html)
5.  [从 wsdl 文件生成 wcf 服务器代码](https://stackoverflow.com/questions/3467281/generate-wcf-server-code-from-wsdl-files)
6.  [如何让 wsdl 输入和输出名称出现](https://stackoverflow.com/questions/11457431/how-to-get-wsdl-input-and-output-names-to-appear)
7.  [内联架构](http://publib.boulder.ibm.com/infocenter/dmndhelp/v6rxmx/index.jsp?topic=/com.ibm.wbit.help.ie.doc/topics/rinline.html)
8.  [手卷 SOAP 请求](https://stackoverflow.com/questions/10534954/hand-rolled-soap-request)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T17:15:28.947

我花了一些时间试图找出问题。您的 wsdl 的 <types> 部分不正确，应该如下所示。有了这个，我现在可以在 Java 中生成客户端工件。

```
<types>
<schema targetNamespace="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/"
          xmlns="http://www.w3.org/2001/XMLSchema">
   <element name="myData">
     <complexType/> 
   </element>

   <element name="myDataResponse">
     <complexType/>
   </element>
</schema></types> 
```

**更新**

根据下面的对话。添加了一个`nillable`属性。

```
<element name="myDataResponse" nillable="true">
<complexType/>
</element> 
```

**要求**

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/">
<soapenv:Header/>
<soapenv:Body>
  <ns:myData/>
</soapenv:Body>
</soapenv:Envelope> 
```

**回复**

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
<s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <myDataResponse xsi:nil="true" xmlns="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/"/>
</s:Body>
</s:Envelope> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-26T13:14:50.910

wsi.org 有一套验证工具，当然值得一试。

使用这些工具的额外好处是，您实际上可以声称符合 WSDL 规范。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-26T17:21:21.820

我提到[了 Inline Schema](http://publib.boulder.ibm.com/infocenter/dmndhelp/v6rxmx/index.jsp?topic=/com.ibm.wbit.help.ie.doc/topics/rinline.html)。还要感谢@Indoknight。工作合同 WSDL 如下所示。

注意 1：xsd 前缀和 targetNamespace 存在于 wsdl 内部使用的架构中`type`

注2：nillable="true" 适用于响应消息中使用的类型

注意 3：如果您遇到以下异常，请确保`soapAction`合同 WSDL 和 WCF 服务生成的 wsdl 完全相同。一些用于生成服务代码的工具可能会随意修改 SOAP 操作。

> Faultcod: a:ActionNotSupported
> 
> Faultstring：由于 EndpointDispatcher 的 ContractFilter 不匹配，接收方无法处理带有 Action ' [http://www.xmlns.mycompany.com/GAME/wsdl/AssociateIntf/1.4/getAllVicePresidentsRequest '的消息。](http://www.xmlns.mycompany.com/GAME/wsdl/AssociateIntf/1.4/getAllVicePresidentsRequest)这可能是因为合约不匹配（发送方和接收方之间的操作不匹配）或发送方和接收方之间的绑定/安全不匹配。检查发送方和接收方是否具有相同的合同和相同的绑定（包括安全要求，例如消息、传输、无）。

SOAP 操作 - 合同 WSDL

```
 <soap:operation soapAction="http://www.xmlns.mycompany.com/GAME/wsdl/AssociateIntf/1.4/getAllVicePresidentsRequest" 
```

SOAP 动作 - 生成的 WSDL

```
<soap:operation soapAction="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/IGAMEAssociateIntf/getAllVicePresidents" 
```

**合同 WSDL**

```
<?xml version="1.0" encoding="UTF-8"?>
<definitions name="GAMEAssociate"
     targetNamespace="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/"
     xmlns:tns="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/"
     xmlns="http://schemas.xmlsoap.org/wsdl/"
     xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
     xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/"
     xmlns:xsd="http://www.w3.org/2001/XMLSchema"
     xmlns:wsp="http://www.w3.org/ns/ws-policy"
     >

<types>
<xsd:schema targetNamespace="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/"
            xmlns:xsd="http://www.w3.org/2001/XMLSchema" >
  <xsd:element name="myData">
    <xsd:complexType />
  </xsd:element>
  <xsd:element name="myDataResponse" nillable="true">
    <xsd:complexType />
  </xsd:element>
</xsd:schema>
</types>

<message name="getAllVicePresidentsRequest">
<part element="tns:myData" name="getAllVicePresidentsRequest"/>
</message>

<message name="getAllVicePresidentsResponse">
<part element="tns:myDataResponse" name="getAllVicePresidentsResponse"/>
</message>

<portType name="GAMEAssociateIntf">
<operation name="getAllVicePresidents">
  <input message="tns:getAllVicePresidentsRequest"/>
  <output message="tns:getAllVicePresidentsResponse"/>
</operation>
</portType>

<binding name="GAMEAssociateIntfBinding" type="tns:GAMEAssociateIntf">
<soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
<operation name="getAllVicePresidents">
  <soap:operation soapAction="http://www.xmlns.mycompany.com/GAME/wsdl/AssociateIntf/1.4/getAllVicePresidentsRequest"
                  style="document"/>
  <input>
    <soap:body use="literal"/>
  </input>
  <output>
    <soap:body use="literal"/>
  </output>
</operation>
</binding>

<service name="GAMEAssociate">
<port binding="tns:GAMEAssociateIntfBinding" name="GAMEAssociateSOAP">
  <soap:address location="http://localhost:8014/associateservice/GAMEAssociate.svc"/>
</port>
</service>

</definitions> 
```

**要求**

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/">
<soapenv:Header/>
<soapenv:Body>
  <ns:myData/>
</soapenv:Body>
</soapenv:Envelope> 
```

**回复**

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
<s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <myDataResponse xsi:nil="true" xmlns="http://www.xmlns.mycompany.com/GAME/service/Associate/1.1/"/>
</s:Body>
</s:Envelope> 
```

# ruby-on-rails - Git重置和删除分支没有正确恢复

> ID：15815101
> 
> 赞同：0
> 
> 时间：2013-04-04T15:11:50.967
> 
> 标签：ruby-on-rails, git

我创建了一个名为 user-microposts 的新分支。我开始在创建模型时搞砸了。我尝试使用以下命令返回上一次提交：

```
git reset --hard cb166caa1c70004f77eed6229168b06ad249a4ba 
```

这回馈了：

```
HEAD is now at cb166ca Eliminate an unnecessary assignment 
```

所以我尝试重做 Migrate，这给了我这个错误：

```
SQLite3::SQLException: table "microposts" already exists: CREATE TABLE "microposts"
.... 
```

我很惊讶，因为我想如果我回到之前的提交，就像什么都没发生一样。

所以我恢复到 master 分支并删除了我进行任何更改的分支。

然后我创建了一个新分支，并尝试创建另一个模型并运行 rake db:migrate。我又遇到了同样的错误

```
SQLite3::SQLException: table "microposts" already exists: CREATE TABLE "microposts"
.... 
```

我最近尝试手动删除其中包含微帖子的任何文件。再次没有这样的运气。

我不断收到同样的错误。我认为 git branch 和/或 git reset 的目的都会阻止这种情况，所以我很困惑。任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:19:51.630

您的数据库受源代码控制是不寻常的。因此，如果您还原您的源，您可能会在数据库和源之间出现不一致。该解决方案有几个选项：

1.  删除数据库并重新创建它
2.  回滚数据库以匹配源

对于上述两种情况，您将使用典型的“rake db”类型命令。

# c# - 在 ASP.NET 中加载外部资源

> ID：15815104
> 
> 赞同：0
> 
> 时间：2013-04-04T15:11:51.653
> 
> 标签：c#, asp.net, resources, .net-assembly

我们有一个名为“Main”的项目。在这个项目中，我们所有的资源都在一个名为 Ress 的文件夹中。当我们调用这些资源时，我们使用的是我们制作的 Translator 类。

```
public class Translator
{
    ResourceManager m_ressourceManager;
    string m_completeRessourceName;
    public Translator(string ressourceName)
    {
        m_completeRessourceName = String.Format("Main.Ressources.{0}", ressourceName);
        m_ressourceManager = new ResourceManager(m_completeRessourceName, Assembly.GetExecutingAssembly());
    }

    public string GetString(string name)
    {
        string retString = "";
        try
        {
            retString = m_ressourceManager.GetString(name);
        }
        catch
        {
            retString = m_completeRessourceName + "." + name;
        }
    return retString;
    }
} 
```

该项目中的所有内容都正确加载。现在我们有了第二个项目，叫做“Home”。在那个项目中，我添加了traduction类作为链接。如您所见，我们的翻译器构造函数被构建为在“Main”项目的子文件夹“Ressources”中加载资源。对于“主页”项目中的 about.aspx 页面，我在 Main/Ressources 中创建了一个名为 About.en-CA.resx 的资源文件。执行代码时，我没有收到任何错误，但没有加载资源。两个项目已重建。

```
protected override void setPageTranslator()
{
    base.setPageTranslator();
    m_pageTranslator = new Translator("About");
}

protected override void LoadStrings()
{
    m_aboutTitle.Text = m_pageTranslator.GetString("AboutTitle");
} 
```

# ios - 用户删除应用时触发用户注销的方法-iPad应用

> ID：15815105
> 
> 赞同：2
> 
> 时间：2013-04-04T15:11:53.647
> 
> 标签：ios, objective-c, ipad, logout

我有一个应用程序，我在其中实现了登录、注销和一些自定义操作。某些操作只能在用户登录时执行，但如果用户在登录后删除应用程序并且没有注销，那么我无法让其他用户知道他不再是用户并且所有只有在此用户再次安装应用程序并登录后，才能执行与登录相关的操作。

在应用程序删除之前是否有任何方法被调用？这样我就可以触发该函数中的注销方法。当用户从设备中删除应用程序时，有什么方法可以使用委托方法或通知注销用户？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T15:18:11.043

不幸的是，删除应用程序时没有调用任何方法。

我更喜欢这样的解决方案，您在用户退出应用程序时注销用户，并在他再次打开应用程序时进行安静登录，而不会注意到他已注销。因此，您需要存储凭据。

因此，您可以确保用户在不使用该应用程序时始终处于注销状态。

但在我看来，你应该改变你的后端，这样用户是否安装了应用程序就无关紧要了。但这可能取决于您的用例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T15:16:22.387

无法知道用户何时删除了他们的应用程序。您可以`NSUserDefaults`在他们登录后存储他们的登录名，并在您尝试使用他们必须登录才能使用的服务时检查它是否存在。如果应用程序已被删除并重新安装（或新安装），则 NSUserDefaults 值将为 nil，如果他们是已建立的用户，它将等于他们的用户名。

```
[[NSUserDefaults standardUserDefaults] setObject:@"the_user_name" forKey:@"kUsername"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

# javascript - 如何使 Superfish 菜单在第一级垂直但在第二级水平？

> ID：15815106
> 
> 赞同：0
> 
> 时间：2013-04-04T15:11:57.703
> 
> 标签：javascript, html, css, menu, superfish

我在 Drupal7 中使用 Superfish 菜单，我的第一个项目级别是垂直设计的。现在我想将我的第二个项目级别设置为水平样式。我怎么能这样做？我尝试了不同的 CSS 方法，通过 jQuery 添加了一些类名，例如

$('一级li')find('ul').addClass('sf-vertical');

但没有任何帮助。天呐！

编辑：[这是一个 jsfiddle](http://jsfiddle.net/headkit/2vaQ3/3/)，我的菜单看起来像

```
<ul id="superfish-1" class="sf-menu menu-page-menu sf-vertical sf-style-none sf-total-items-6 sf-parent-items-1 sf-single-items-5 sf-js-enabled">
    <li id="menu-622-1" class="first odd sf-item-1 sf-depth-1 sf-no-children">Item 1</li>
    <li id="menu-623-1" class="middle even sf-item-2 sf-depth-1 sf-total-children-5 sf-parent-children-0 sf-single-children-5 menuparent">Item 2
        <ul class="sf-vertical sf-hidden">
            <li id="menu-633-1" class="first odd sf-item-1 sf-depth-2 sf-no-children" style="white-space: normal; float: left; width: 100%; ">SubItem </li>
            <li id="menu-634-1" class="middle even sf-item-2 sf-depth-2 sf-no-children" style="white-space: normal; float: left; width: 100%; ">SubItem </li>
            <li id="menu-635-1" class="middle odd sf-item-3 sf-depth-2 sf-no-children" style="white-space: normal; float: left; width: 100%; ">SubItem </li>
            <li id="menu-636-1" class="middle even sf-item-4 sf-depth-2 sf-no-children" style="white-space: normal; float: left; width: 100%; ">SubItem </li>
            <li id="menu-637-1" class="last odd sf-item-5 sf-depth-2 sf-no-children" style="white-space: normal; float: left; width: 100%; ">SubItem </li>
        </ul>
    </li>
    <li id="menu-624-1" class="middle odd sf-item-3 sf-depth-1 sf-no-children">Item 3</li>
    <li id="menu-625-1" class="middle even sf-item-4 sf-depth-1 sf-no-children">Item 4</li>
    <li id="menu-626-1" class="middle odd sf-item-5 sf-depth-1 sf-no-children">Item 5</li>
    <li id="menu-627-1" class="last even sf-item-6 sf-depth-1 sf-no-children">Item 6</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T06:18:59.773

给出固定宽度`.sf-menu ul li ul`并`.sf-menu ul ul li`移除`width:100%`并给出`margin_right:XXpx;`

像 CSS

```
.sf-menu ul li ul{width:400px;}
.sf-menu ul ul li{float:left; margin-right:10px;} 
```

# openam - OpenAM：跨域 HTTP 状态 404 - / appagent / sunwCDSSORedirectURI

> ID：15815109
> 
> 赞同：0
> 
> 时间：2013-04-04T15:12:01.973
> 
> 标签：openam

`OpenAM`我使用跨域部署，但是当我尝试查看示例应用程序代理`tomcat`时，在验证服务器后`OpenAM`他返回`404 error`： `HTTP Status 404 - / appagent / sunwCDSSORedirectURI`

状态报告类型

`message / appagent / sunwCDSSORedirectURI`

描述 请求的资源 ( `/ appagent / sunwCDSSORedirectURI`) 不可用。

注意：在我的页面`sunwCDSSORedirectURI.jsp`代理部署上`tomcat`包含没有处理是正常的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T07:38:19.233

您还必须部署 'agentapp' ...文档是您的朋友' [http://docs.forgerock.org/en/openam-pa/3.1.0-Xpress/agent-install-guide/index.html# chap-apache-tomcat](http://docs.forgerock.org/en/openam-pa/3.1.0-Xpress/agent-install-guide/index.html#chap-apache-tomcat) ' 第 9.2 节，第 7 步

# c# - 如何获得对调用方法的 Window 的引用，并使用它来分配所有者？

> ID：15815114
> 
> 赞同：0
> 
> 时间：2013-04-04T15:12:17.410
> 
> 标签：c#

如何在被调用方法中获取调用对象？

我必须创建一个自定义 MessageBox，创建如下：

```
public static class MsgBox
{
    public static MessageBoxResult Show(string messageBoxText)
    {
        var msg = new CustomMessageBoxWindow(messageBoxText);
        msg.ShowDialog();

        return msg.Result;
    }
} 
```

我现在需要为这个 MessageBox 指定一个所有者。我可以通过强制开发人员传入调用对象来做到这一点，例如

```
public static MessageBoxResult Show(string messageBoxText, Window owner) 
```

并将所有者设置如下

```
msg.Owner = owner; 
```

但这意味着必须在很多地方改变很多电话。这是可行的，但并不理想。理想情况下，我可以从 Show() 方法中找出哪个类称为 MessageBox 并设置它，而无需传递任何新参数，例如

```
public static MessageBoxResult Show(string messageBoxText)
{
    var msg = new CustomMessageBoxWindow(messageBoxText);
    msg.ShowDialog();

    var owner = // somehow get the calling Window;
    msg.Owner = owner;

    return msg.Result;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:18:09.897

我目前正在做这样的事情。您将需要使用反射。不幸的是，我不能提供太多细节，因为我自己是反思的新手，但这里有一行代码：

```
new System.Diagnostics.StackFrame(2).GetMethod().DeclaringType.ToString(); 
```

从我看到的地方，这将 2 个级别向上移动到堆栈跟踪（在我的代码中，我需要 2 个级别，也许您需要更多？）。然后 GetMethod 返回调用方法，而 DeclaringType 属性为您提供声明此方法的类。我知道它不一定能解决你的问题，但也许这可以帮助......

PS：我在 ASP.NET 中执行此操作，但我认为这并不重要，只要程序集与 Web 无关...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:48:51.130

听起来你想要调用者的实例到你的消息框。反射不会给你这个。反射提供有关程序集中类的元数据。同样，StackFrame 也为您提供元数据（例如，GetMethod 为您提供 MethodBase，它为您提供堆栈框架中方法的特征）。

我不知道有一种方法可以获取调用对象的实例，而无需将其“this”指针作为参数。如果您从“表单”派生消息类，那么您可以尝试 Parent 和 ParentForm 属性，但我不认为这些是非 Null 的。

# ios - 如何在 LLDB 调试器中打印 C 变量？

> ID：15815116
> 
> 赞同：9
> 
> 时间：2013-04-04T15:12:23.727
> 
> 标签：ios, objective-c, c, xcode, lldb

正如问题所说。在 Xcode 4.6 中。

想要打印整数、字符、数组、自定义结构等。

可能的？

使用 Objective-C，我可以执行以下操作：

整数三 = 3；

po [NSString stringWithFormat:@"%i", 三];

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-04T15:15:34.377

`po`代表Print Object，它本质上是调用`description`对象上的方法。

用于`p`打印整数。例如：

```
p three 
```

# blackberry - 在 BlackBerry 应用程序中弹出多个屏幕

> ID：15815118
> 
> 赞同：1
> 
> 时间：2013-04-04T15:12:34.257
> 
> 标签：blackberry, blackberry-eclipse-plugin

我编写了一个 BlackBerry 应用程序，它有多个用户可以浏览的屏幕（如调查）。提交调查后，应用程序必须返回到开始屏幕，之后，不得允许他们导航回之前显示的屏幕。

实现这一点的正确方法是什么？

目前我正在打电话

```
UiApplication.getUiApplication().popScreen(UiApplication.getUiApplication().getActiveScreen()); 
```

有多少个不同的屏幕。是否有更优雅的解决方案可以返回开始屏幕？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T01:32:18.977

`UiApplication.getScreenCount()`总是会给你屏幕的数量，所以你可以这样做（从*任何地方*，它甚至不必来自任何特定的`Screen`类）：

```
 public void popToRoot() {
      UiApplication app = UiApplication.getUiApplication();
      while (app.getScreenCount() > 1) {
         app.popScreen(app.getActiveScreen());
      }
   } 
```

# sql - YII：你如何记录慢速 SQL 查询？

> ID：15815123
> 
> 赞同：1
> 
> 时间：2013-04-04T15:12:40.850
> 
> 标签：sql, yii

我只想记录速度较慢的 SQL 查询，其中慢速是由任何比我指定的值更长的查询决定的。这可能吗？以及如何启用它？

DBProfiler 工作得很好，但它似乎总是输出到屏幕而不是文件：

```
array( //db profiler
   'class'=>'ext.db_profiler.DbProfileLogRoute',
   'countLimit' => 1, // How many times the same query should be executed to be considered inefficient
   'slowQueryMin' => 0.1, // Minimum time for the query to be slow
), 
```

如何插入 DBProfiler 或以其他方式插入，以便每次查询缓慢时都可以将内容写入 application.log？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T01:28:44.783

在 db 组件配置中的 config/main.php 中，将 enableParamLogging 和 enableProfiling 参数设置为 true 并确保：

```
'log'=>array(
        'class'=>'CLogRouter',
        'routes'=>array(
            array(
                'class'=>'CFileLogRoute',
                'levels'=>'error, warning',
            ),
            // uncomment the following to show log messages on web pages

            array(
                'class'=>'CWebLogRoute',
            ),

        ),
    ), 
```

是这样的。有关更多信息[CDbConnection](http://www.yiiframework.com/doc/api/1.1/CDbConnection)和[CLogRouter](http://www.yiiframework.com/doc/api/1.1/CLogRouter)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T01:31:30.337

尝试 dbprofiler 扩展。我会帮助你的...

[dbprfiler](http://www.yiiframework.com/extension/dbprofiler/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T06:40:44.227

我最终编写了自己的日志记录功能：

```
private function slowQueryEvaluator($startTime, $endTime, $identifier) {

  $MAX_TIME = 0.1;

  $IP = Controller::getRealIpAddress();
  $userID = -1;
  if (isset(YII::app()->user->id)) {
    $userID = YII::app()->user->id;
  }
  $seconds = $endTime - $startTime;
  if ($seconds > $MAX_TIME ) {
    YII::log($IP.' - '.$userID.' - '.$seconds.' seconds - '.$identifier);
  }

} 
```

# .htaccess - 服务器上的文件夹到 404 页面

> ID：15815124
> 
> 赞同：0
> 
> 时间：2013-04-04T15:12:45.143
> 
> 标签：.htaccess, redirect

我有一个站点，其中包含一些当前只是列出内容的文件夹（我不想这样做）。

我可以简单地在其中粘贴一个索引文件，但是想知道是否有更优雅的方法可以使用 htaccess 文件来执行此操作。

所以例如我`http://localhost:8888/includes/`想去`http://localhost:8888/404.php`

**但**

需要`http://localhost:8888/includes/header.php`并且`http://localhost:8888/assets/img/head.png`仍然可以正常工作

干杯:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:37:34.507

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

# request is for a directory
RewriteCond %{REQUEST_FILENAME} -d
# there is no index.html inside requested directory
RewriteCond %{REQUEST_FILENAME}/index.html !-f
# redirect to /404.php
RewriteRule ^ /404.php [L,R] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T17:41:38.590

尝试在您的`.htaccess`文件上使用此代码：

```
Options +FollowSymlinks
RewriteEngine on

RewriteCond %{SERVER_PORT} ^8888$
RewriteCond %{REQUEST_URI} ^/includes/?$
RewriteRule ^(.*) http://%{HTTP_HOST}:%{SERVER_PORT}/404.php 
```

# operating-system - 最短作业优先调度

> ID：15815132
> 
> 赞同：0
> 
> 时间：2013-04-04T15:13:07.677
> 
> 标签：operating-system, scheduling

假设以下进程在指定的时间到达执行。每个进程将运行列出的时间量。

```
Process [Arrival Time(ms) , Burst Time(ms)]
A[0 , 5] , B[3 , 5] , C[5 , 3] , D[7 , 2] 
```

我想绘制*甘特*图并计算抢先式最短*作业优先*调度的平均等待时间。

解决方案

[http://imgur.com/fP8u61C](http://imgur.com/fP8u61C)

等待时间为 2ms。

请告诉我这是否正确。

我怀疑的步骤是，在进程 B 到达的 3ms 时，调度程序是完成进程 A 还是启动进程 B。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:16:23.667

你可能不得不自己做你的功课。

展示您的尝试并说出您的问题和问题。

不要等待完整的现成解决方案！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T17:40:02.200

是的，你的答案是正确的。事实上，提出的问题是模棱两可的，但两种可能性都给出了相同的答案。

首先，歧义： Shortest Job First 调度通常不被认为是抢占式的。抢占式变体称为 Shortest Remaining Time First Scheduling（例如参见[Wikipedia 上的 Shortest Job Next 条目](http://en.wikipedia.org/wiki/Shortest_job_next)。但是，您的练习声明“抢占式作业优先调度”，*这是*模棱两可的......

其次，正如您所提到的，这两个调度策略之间可能存在差异的唯一时间是`t=3`A 和 B 都符合条件的时候。但是如果调度是非抢占式的，当然 A 会继续执行。它是抢占式的，我们必须考虑剩余时间：A 还剩 2 毫秒，而 B 还剩 5 毫秒……所以 A 仍然获得 CPU。

最后，等待时间是 : `A -> 0 ms, B -> 7 ms, C -> 0 ms, D -> 1ms`，其平均值确实是`2 ms`。

# ios - UIImageView 停止动画

> ID：15815135
> 
> 赞同：4
> 
> 时间：2013-04-04T15:13:18.293
> 
> 标签：ios, objective-c, cocoa-touch, animation, uiimageview

在 Xcode 中，我有 2 个按钮：**Start**和**Stop**。

当您单击**开始** `startClick`时被调用，当您单击**停止** `stopClick`时被调用。

当您单击**Start**时，UIImageView 图像将闪烁来自 NSArray 的不同图像。当您单击**Stop**时，它会停止，但我希望它停止在我单击**Stop**时显示的图像上。目前它只是停止并消失......有什么帮助吗？

这是代码的一部分：

```
-  (IBAction)startClick:(id)sender {

    color.animationImages = [NSArray arrayWithObjects:
                            [UIImage imageNamed: @"img1.png"],
                            [UIImage imageNamed: @"img2.png"],
                            [UIImage imageNamed: @"img3.png"],
                            [UIImage imageNamed:  @"img4.png"],nil];     

    [color setAnimationRepeatCount: 0];
    color.animationDuration = 1;
    [color startAnimating];
}

- (IBAction)stopClick:(id)sender {
    [color stopAnimating];

    //What code do i put here to display the last image? (as i clicked stop).

} 
```

我还想添加 if statments，如果显示的颜色是 img1.png 则执行此操作...如果它的 img2.png 执行此操作...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:18:49.923

此代码将暂停您的动画：

```
color.frame = [[color.layer presentationLayer] frame];
[color.layer removeAllAnimations]; 
```

# redirect - 如何强制网站停留在框架中？

> ID：15815147
> 
> 赞同：1
> 
> 时间：2013-04-04T12:44:00.337
> 
> 标签：redirect, javascript, firefox

我正在使用`Firefox`+`searchbastard`插件对购物搜索引擎进行多重搜索。页面是框架的一部分。这对我目前尝试过的所有网站都很好，除了 shopmania.com。

如果我使用 noscript 来禁止来自 shopmania 域名的脚本，那么一切都会保持原样，但网站元素的一部分会变得无响应。我知道 Firefox 中有一个选项可以强制在新窗口中打开的链接在新选项卡中打开。有没有类似的东西可以防止网站跳出框架？也许是阻止这些请求的 Firefox 插件？

或者至少有人能告诉我是什么导致只有这个网站这样吗？

编辑：我可以使用什么工具来暂停 firefox 或 javascript 以及像 c++ 中的逐步执行代码？我尝试了一个 javascript 调试器和 firebug。他们没有帮助，但我可能没有正确使用它们..

EDIT2：我试过这个greasemonkey脚本：[https](https://userscripts.org/scripts/show/92424) ://userscripts.org/scripts/show/92424 。它不起作用，所以我想这不是因为“目标”属性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:19:54.710

这是错误的。我猜您正在使用插件来捕获和覆盖某些站点为您提供的输出。我很确定这违反了他们的 ToS，而且总的来说这不是一件好事。

JavaScript 的设计不允许这种干预。充其量是零散的。

如果您想使用来自网站的数据，以某种方式聚合或显示，请使用他们的公共 API。如果他们没有公共 API，他们可能不希望您以这种方式使用他们的服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T15:54:53.753

解决方案：我从[Stop execution of Javascript function (client side) 中获取脚本或对其进行调整](https://stackoverflow.com/questions/3972038/stop-execution-of-javascript-function-client-side-or-tweak-it)并对其进行修改以搜索其中包含的标签，`top.location = location`然后使用 if (top != self) {top. location = location;} 行注释。作为一个 js 新手，我不知道这是否是最优雅的选择，但它解决了问题。特别感谢蒂姆喷泉。
我将保持开放状态，以防其他人为我和其他人的教育提出更好的解决方案。再一次感谢你的帮助。
下面是代码：

```
// ==UserScript==
// @name _Replace evil Javascript
// @run-at document-start
// ==/UserScript==

/****** New "init" function that we will use
instead of the old, bad "init" function.
*/
function init () {
/* //changing stuff around here 
var newParagraph = document.createElement ('p');
newParagraph.textContent = "I was added by the new, good init() function!";
document.body.appendChild (newParagraph); */
<!--//--><![CDATA[//><!--
document.getElementsByTagName("html")[0].className+=" js "+(navigator.userAgent.toLowerCase().indexOf("webkit")>=0?"webkit":navigator.userAgent.toLowerCase().indexOf("opera")>=0?"opera":"");
for(i in css3_tags="abbr|header|footer".split("|")){document.createElement(css3_tags[i]);}
var PATH = "http://www.shopmania.com";
var PATH_STATIC = "http://im4.shopmania.org";
var PATH_SELF = "http://www.shopmania.com/";
var RETURN = "http%3A%2F%2Fwww.shopmania.com%2F";
var DOMAIN_BASE = "shopmania.com";
var SUBDOMAINS_FORCE_FILES_JS = "aff.remote,biz.remote,my.remote,cp.remote,cp.register_quick,cp.account_details,partner.remote,site.recommend,site.remote,site.feedback,site.report_problem,site.report,site.cropper";
var URL_REWRITE_MAPPING_JS = "cmd,section,do,option|feed,mode,option|forgot,section|info,page|login,section|logout,section|new_password,section,code|settings,section|shopping,param_main,param_sec|site,store_str_key|register,section|unsubscribe,section|agentie,store_str_key,id|brand,manuf_str_key|brands,letter|build,type,param_main,param_sec|compare,online|confirm,section|edit,section|deal,deal|dictionary,online|home,section|link_accounts,section|profile,user|reactivate,section|searches,letter|signup,section|rs_agent,store_str_key|rs_list,param_main,param_sec|rs_view,ad|agents,state|complex_list,param_main|complex_view,complex|list,cat|ad,a|map,option|my_ads,section|my_alerts,section";
var SVR_SITE_ID = "us";
var CONTEXT = "c5b27de70340c97a94092a43bd34b2b8";
var link_close = "Close";
var txt_loading = "Loading...";
var form_is_submitted = 0;
var search_is_focused = 0;
// Overlay object
var OL;
var DB;
var iframe_cnt = "";
// Facebook post to user's Wall action
var FACEBOOK_WALL_FEED_SIGNUP = "";
var SITENAME = "ShopMania";

//if (top != self) {top.location = location;} // SIT!

var comps = new Array();  comps['all'] = 0;var comps_cat_titles = new Array();  var views = new Array(); views['auto'] = 0; views['prod'] = 0; views['realestate'] = 0; views['classifieds'] = 0; views['all'] = 0; var search = new Array();  search['all'] = 0; search['prod'] = 0;
var favs = new Array(); favs['all'] = 0; favs['prod'] = 0; favs['store'] = 0; favs['manuf'] = 0; favs['other'] = 0; favs['realestate'] = 0; favs['auto'] = 0;
function addCss(c){var b=document.getElementsByTagName("head")[0];var a=document.createElement("style");a.setAttribute("type","text/css");if(a.styleSheet){a.styleSheet.cssText=c}else{a.appendChild(document.createTextNode(c))}b.appendChild(a)};
addCss(".lzl {visibility: hidden;}");
var RecaptchaOptions = { theme : 'clean' }; 
//--><!]]>
}

/*--- Check for bad scripts to intercept and specify any actions to take.
*/
checkForBadJavascripts ( [
[false, /top.location = location/, function () {addJS_Node (init);} ]
] );

function checkForBadJavascripts (controlArray) {
/*--- Note that this is a self-initializing function. The controlArray
parameter is only active for the FIRST call. After that, it is an
event listener.

The control array row is defines like so:
[bSearchSrcAttr, identifyingRegex, callbackFunction]
Where:
bSearchSrcAttr True to search the SRC attribute of a script tag
false to search the TEXT content of a script tag.
identifyingRegex A valid regular expression that should be unique
to that particular script tag.
callbackFunction An optional function to execute when the script is
found. Use null if not needed.
*/
if ( ! controlArray.length) return null;

checkForBadJavascripts = function (zEvent) {

for (var J = controlArray.length - 1; J >= 0; --J) {
var bSearchSrcAttr = controlArray[J][0];
var identifyingRegex = controlArray[J][1];

if (bSearchSrcAttr) {
if (identifyingRegex.test (zEvent.target.src) ) {
stopBadJavascript (J);
return false;
}
}
else {
if (identifyingRegex.test (zEvent.target.textContent) ) {
stopBadJavascript (J);
return false;
}
}
}

function stopBadJavascript (controlIndex) {
zEvent.stopPropagation ();
zEvent.preventDefault ();

var callbackFunction = controlArray[J][2];
if (typeof callbackFunction == "function")
callbackFunction ();

//--- Remove the node just to clear clutter from Firebug inspection.
zEvent.target.parentNode.removeChild (zEvent.target);

//--- Script is intercepted, remove it from the list.
controlArray.splice (J, 1);
if ( ! controlArray.length) {
//--- All done, remove the listener.
window.removeEventListener (
'beforescriptexecute', checkForBadJavascripts, true
);
}
}
}

/*--- Use the "beforescriptexecute" event to monitor scipts as they are loaded.
See https://developer.mozilla.org/en/DOM/element.onbeforescriptexecute
Note that it does not work on acripts that are dynamically created.
*/
window.addEventListener ('beforescriptexecute', checkForBadJavascripts, true);

return checkForBadJavascripts;
}

function addJS_Node (text, s_URL, funcToRun) {
var D = document;
var scriptNode = D.createElement ('script');
scriptNode.type = "text/javascript";
if (text) scriptNode.textContent = text;
if (s_URL) scriptNode.src = s_URL;
if (funcToRun) scriptNode.textContent = '(' + funcToRun.toString() + ')()';

var targ = D.getElementsByTagName ('head')[0] || D.body || D.documentElement;
//--- Don't error check here. if DOM not available, should throw error.
targ.appendChild (scriptNode);
} 
```

代码中的 cdata 部分存在一些转义问题。所以 SO 不允许我发布代码。编辑：固定

# android - ConnectivityManager.getActiveNetworkInfo() 是否经常调用昂贵？

> ID：15815150
> 
> 赞同：3
> 
> 时间：2013-04-04T15:14:27.360
> 
> 标签：android, optimization, android-networking

我正在尝试为我的应用程序找出一个策略，我需要在其中执行不同的网络操作。我的问题是，调用是否`ConnectivityManager.getActiveNetworkInfo()`被认为是一种长时间运行和耗电的操作，是否可以经常调用它，或者我应该通过应用其他策略来优化我的应用程序的性能？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T16:28:56.830

到目前为止，我已经在三个应用程序中使用了 ConnectivityManager.getActiveNetworkInfo()。您可以使用 checkNetwork() 方法并调用它，以确保每次用户启动需要网络的东西时您都处于正确的状态，以便他或她可以纠正这种情况。除此之外，您的错误处理可能会将 sleep() 调用与网络检查和连接管理结合起来。这意味着使用大约 30 亿的权限。但这将是一种合理的方法。

# machine-learning - 如何使用 RankBoost Bipartite 训练多个查询（每个查询都有不同的相关和不相关文档集）

> ID：15815156
> 
> 赞同：1
> 
> 时间：2013-04-04T15:14:42.013
> 
> 标签：machine-learning, information-retrieval

我指的是这篇论文 - An Efficient Boosting Algorithm for Combining Preferences ( [http://www.ai.mit.edu/projects/jmlr/papers/volume4/freund03a/freund03a.pdf](http://www.ai.mit.edu/projects/jmlr/papers/volume4/freund03a/freund03a.pdf) ) 并实施 3.3 - 一个有效的双向实施反馈。

现在，当我有来自多个查询的数据时，我对分布 v 感到困惑 - 例如，Q1 从（A ... Z）中返回一些文档（A，B，C）作为 1（相关），其他作为 0，Q2返回相关的 (D, N, V)。因此为不同的查询设置不同的 X0 和 X1。因此与 V 的 V 更新初始化和计算电位 (pi) 混淆。如果有人可以提出一些很棒的建议。

编辑：

我正在考虑为所有查询进行分布（x0 和 x1 的 v），使其总和为 1.0，并以类似的方式更新分布......请分享您的想法！

EDIT2：如果有人来这里，那么 EDIT1 就可以了！

# c++ - c++ 中虚拟静态函数的替代方案？

> ID：15815158
> 
> 赞同：1
> 
> 时间：2013-04-04T15:14:52.703
> 
> 标签：c++, oop, inheritance, static-methods, virtual-functions

在头文件 .hpp 中：

```
 class Base{
        public:
              static /*Some Return Type*/ func(/*Some Datatype*/);
  }    
  class Derived1 public Base{
        public: 
               Derived1();
               ~Derived1();
  }
  class Derived1 public Base{
        public: 
               Derived2();
               ~Derived2();
  } 
```

在 cpp 文件 .cpp 中：

```
 /*Some Return Type*/ Derived1::func(/*Some Datatype*/){
  }

  /*Some Return Type*/ Derived2::func(/*Some Datatype*/){
  } 
```

这显然失败了，因为没有办法覆盖子类中的静态方法。但是如何获得上述功能呢？

我必须这样称呼：

```
 /*Some Return Type*/ result = Derived1::func(/*Some Datatype*/)
  /*Some Return Type*/ result = Derived2::func(/*Some Datatype*/) 
```

我知道，可以像下面这样在基类中定义抽象方法，然后在派生类中定义它们：

在头文件 .hpp 中：

```
 class Base{
        public:
              virtual /*Some Return Type*/ func(/*Some Datatype*/) const = 0;
  } 
```

但问题是虚拟方法需要对象实例化，这不是我想要的。我想在不创建对象的情况下调用该方法。如果允许使用虚拟静态方法，它们就可以达到目的。

我能想到的唯一替代方法是`func()`在头文件的所有派生类中声明该函数，并将其从基类中删除。有没有其他方法可以做到这一点？这样声明在基类中只有一次，所有派生类只需要定义它们，而不是重新声明？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:21:26.327

在没有对象的情况下调用虚函数是一种矛盾，因为分辨率取决于对象的类型。在某些情况下，您可能需要根据对象的类型调用相同的函数，或者在没有对象的情况下显式指定类。这很容易通过使用两个函数来处理，一个是静态的，一个是虚拟的。（通常，虚拟的只会转发到静态的。）

## 编辑：

一个简单的例子（来自实际代码）：

```
#define DECLARE_CLASS_NAME(className)                               \
    static char className() { return STRINGIZE(className); }        \
    virtual char* getClassName() { return className(); }

class Base
{
public:
    DECLARE_CLASS_NAME(Base);
    //  ...
};

class Derived : public Base
{
public:
    DECLARE_CLASS_NAME(Derived);
    //  ...
}; 
```

等等，在所有派生类中。这用于获取序列化的类型名称，例如：

```
std::string typeName = pObj->getClassName(); 
```

以及作为原始 RTTI（大约 20 年前）：

```
if ( pObj->getClassName() == Derived::className() ) ... 
```

（我们已经建立了一个规则，即获得类名的唯一方法是使用其中一个函数。这有效地内化了类名，并允许简单的指针比较工作。在我们正在研究的系统上那么，这很重要。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T15:31:31.723

你可以这样做有点hacky =）

```
//header file
template<class T>
struct base_t
{
   static void do_smth();
};

struct derived1_t : base_t<derived1_t>
{

};

struct derived2_t : base_t<derived2_t>
{

};

//cpp file
void base_t<derived1_t>::do_smth() // `note base_t<derived1_t>::` instead of `derived1_t::`
{
   std::cout << "aaa" << std::endl;
} 
```

PS：很奇怪，你不想在派生类中声明这个函数，因为当你使用虚函数时，你应该在派生类中声明它们

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T18:04:39.393

一种可能性是仅在派生类中定义它们：

```
 struct  Base
  {
      // nothing
  };

  struct Derived1 : public Base
  {
      static void func() { /*...*/ }
  };

  struct Derived2 : public Base
  {
      static void func() { /*...*/ }
  }; 
```

这允许您调用：

```
Derived1::foo();
Derived2::foo(); 
```

为基类型调用它并期望编译器找出你的意思是哪个子类型*不能*工作：

```
// How will the compiler know to choose 
// between Derived1:: func or Derived2:: func ?
Base::func(); 
```

您可能想查看 CRTP 或 type-traits 以获得替代方法。

# c++ - 在另一个 .pro 文件中包含 .pro 文件

> ID：15815164
> 
> 赞同：5
> 
> 时间：2013-04-04T15:15:04.100
> 
> 标签：c++, qt-creator

我正在尝试使用 QtCreator 构建一些项目。

这两个 .pro 文件之间有很多共同的代码。

有没有办法让这两个 .pro 文件调用另一个包含公共信息的唯一 .pro 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:19:22.670

是的，请参阅[文档](http://qt-project.org/doc/qt-4.8/qmake-function-reference.html#include-filename)。你可以写：

```
include(otherproject.pro) 
```

不复制代码总是一个好主意。

# c - 由 Javascript 调用的 NPAPI 函数

> ID：15815165
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:15:05.480
> 
> 标签：c, google-chrome-extension, npapi, browser-plugin

我正在尝试编写一个 NPAPI 插件的 hello world 示例。我实现了所有需要的基础函数，并添加了一个 Get_String() 函数，它返回一个 hello world 字符串。

构建后，浏览器可以检测到插件和所有相关信息，但我无法从 JavaScript 调用我的 Get_String() 函数！这里有一些代码：plugin.c

```
#define PLUGIN_NAME        "Name Plugin"
#define PLUGIN_DESCRIPTION " Plugin Description"
#define PLUGIN_VERSION     "1.0"

static NPNetscapeFuncs* sBrowserFuncs = NULL;

NP_EXPORT(NPError)
NP_Initialize(NPNetscapeFuncs* bFuncs, NPPluginFuncs* pFuncs)
{
  sBrowserFuncs = bFuncs;

  if (pFuncs->size < (offsetof(NPPluginFuncs, setvalue) + sizeof(void*)))
    return NPERR_INVALID_FUNCTABLE_ERROR; 

  pFuncs->newp = NPP_New;
  pFuncs->destroy = NPP_Destroy;

  return NPERR_NO_ERROR;
}

NP_EXPORT(char*)
NP_GetPluginVersion()
{
  return PLUGIN_VERSION;
}

NP_EXPORT(const char*)
NP_GetMIMEDescription()
{
  return "application/my-plugin::";
}

NP_EXPORT(NPError)
NP_GetValue(void* future, NPPVariable aVariable, void* aValue) {
  switch (aVariable) {
    case NPPVpluginNameString:
      *((char**)aValue) = PLUGIN_NAME;
      break;
    case NPPVpluginDescriptionString:
      *((char**)aValue) = PLUGIN_DESCRIPTION;
      break;
    default:
      return NPERR_INVALID_PARAM;
      break;
  }
  return NPERR_NO_ERROR;
}

NP_EXPORT(NPError)
NP_Shutdown()
{
  return NPERR_NO_ERROR; 
}

NPError NPP_New(NPMIMEType pluginType, NPP instance, uint16_t mode, int16_t argc, char* argn[], char* argv[], NPSavedData* saved)
{

  return NPERR_NO_ERROR;
}

NPError NPP_Destroy(NPP instance, NPSavedData** save)
{

  return NPERR_NO_ERROR;
}

char* Get_String()
{
    return "hello world from Get function" ;
}

void Set(NPObject object){} 
```

测试.html

```
<doctype html>
<html>
<head>
<script>
  var plugin = document.getElementById("plugin");
  console.log(plugin.Get_String());
</script>
</head>
<embed id="plugin" type="application/typemine-plugin"> 
<body>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T16:52:01.173

您需要为浏览器[提供](https://developer.mozilla.org/en-US/docs/Gecko_Plugin_API_Reference/Scripting_plugins#What%27s_in_the_plugin_code.3F)来自`NPP_GetValue()`. 浏览器需要它来找出你的插件有哪些方法和属性，调用它们等等。

[您可以在出租车司机教程的第 3 部分](http://colonelpanic.net/2009/08/building-a-firefox-plugin-part-three/)中找到实现脚本的基本概述。

# html - 一张带有两个 href 的图像，由图像映射控制

> ID：15815167
> 
> 赞同：0
> 
> 时间：2013-04-04T15:15:12.463
> 
> 标签：html, css, imagemap

我试图找出一种将两个href附加到单个图像的方法，有点像老式的图像映射，但只是使用CSS。这甚至可能吗？

目前 HTML 看起来像这样。但是我被要求根据用户悬停鼠标的位置附加两个 URL。

```
<div id="logo-wide">
<a href="http://myurl"><img src="BIG-Logo_FINAL.png" alt="url-name"></a>
</div> 
```

菲利普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:18:13.187

你必须要么

1.  使用图像映射
2.  将图像切成两半并将每一半包装在一个链接中
3.  使用 z-index 将两个绝对定位的链接悬停在图像上（这将是非常骇人听闻和丑陋的）

选项 1 或 2 是最好的。

# wpf - 使用 Caliburn Micro 时在 WPF 中手动触发验证

> ID：15815169
> 
> 赞同：1
> 
> 时间：2013-04-04T15:15:17.483
> 
> 标签：wpf, validation, xaml, caliburn.micro

我有一个像这样实现 IDataErrorInfo （并从 Caliburn Micro 的 Screen 类派生）的视图模型

```
public class MyViewModel : Screen, IDataErrorInfo
{
    ...

    public BindableCollection<MyEntity> Entities { get; set; }

    public MyEntity SelectedEntity
    {
        get { return _entity; }

        set
        {
            _entity = value;
            OnSelectedEntityChanged();
        }
    }

    private void OnSelectedEntityChanged()
    {
        // implementation
    }

    public virtual string Error
    {
        get { // implementation }
    }

    public virtual string this[string columnName]
    {
        get { // implementation }
    }

    public void Populating(PopulatingEventArgs e)
    {
        // implementation
    }
} 
```

它使用 Caliburn Micro 绑定到以下 XAML（仅显示相关部分）

```
 <tk:AutoCompleteBox 
        x:Name="Entities"
        cal:Message.Attach="[Event Populating] = [Populating($eventArgs)]"    
        SelectedItem="{Binding Path=SelectedEntity, Mode=TwoWay}"  
        HorizontalAlignment="Stretch" 
        FilterMode="None"
        IsTextCompletionEnabled="True" 
        Text="{Binding SearchText}"
        ValueMemberPath="Name">
        <tk:AutoCompleteBox.ItemTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Name}"></TextBlock> 
            </DataTemplate>                            
        </tk:AutoCompleteBox.ItemTemplate>                          
    </tk:AutoCompleteBox> 
```

我遇到的问题是，当我以编程方式更新 SelectedEntity 属性时，它不会导致触发验证。我已经尝试了许多不同的可能解决方案，例如尝试获取绑定表达式并在其上调用 ValidateWithoutUpdate()、在 XAML 中添加应该导致触发验证的触发器等，但到目前为止都没有奏效。

如何触发最终会调用 IDataErrorInfo.Error 的验证？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-04T06:22:08.547

> /* 将 IDataErrorInfo 实现放在您的模型类中......而不是您的视图模型。数据错误在模型中而不是在视图模型中。ViewModel 引用模型，IDataErrorInfo 通过绑定中的 xaml **ValidatesOnDataErrors=True**与绑定通信 */

```
/* model */
    public class OldBoy : Screen, IOldBoy, IDataErrorInfo
    {
        private Guid oldBoyId;
        public Guid OldBoyId
        {
            get
            {
                return this.oldBoyId;
            }

            set
            {
                this.oldBoyId = value;
                NotifyOfPropertyChange(() => OldBoyId);
            }
        }

        private string firstName;
        public string Firstname
        {
            get
            {
                return this.firstName;
            }

            set
            {
                this.firstName = value;
                NotifyOfPropertyChange(() => Firstname);
            }
        }

        private string surName;
        public string Surname
        {
            get
            {
                return this.surName;
            }

            set
            {
                this.surName = value;
                NotifyOfPropertyChange(() => Surname);
            }
        }

        /* include a Property e.g.  CanSave in your Model that will be bound 
        to the IsEnabled DependencyProperty ofIsEnabled on your Submit Button
        Viz. 
        */

        public string this[string name]
        {
            get
            {
                string result = null;

                if (name == "Firstname")
                {
                    // force the issue
                    this.CanSave = true;
                    if (string.IsNullOrEmpty(this.Firstname))
                    {
                        result = "Model says that Firstname must be entered";
                    }
                }

                if (name == "Surname")
                {
                    // force the issue
                    this.CanSave = true;
                    if (string.IsNullOrEmpty(this.Surname))
                    {
                        result = "Model says that Surname must be entered";
                    }
                }

                return result;
            }
        }

        public string Error
        {
            get
            {
                return null;
            }
        }

        private bool canSave;
        public bool CanSave
        {
            get
            {
                return this.canSave;
            }

            set
            {
                if (string.IsNullOrEmpty(this.Firstname) || string.IsNullOrEmpty(this.surName))
                {
                    this.canSave = false;
                }
                else
                {
                    this.canSave = true;
                }

                NotifyOfPropertyChange(() => CanSave);
            }
        }
    }

    /*   in the ViewModel the underlying class for the edit window  */

    public class DetailsViewModel : Screen, IDetailsViewModel
    {
        private IOldBoy editingOldBoyItem;
        public IOldBoy EditingOldBoyItem
        {
            get
            {
                return this.editingOldBoyItem;
            }

            set
            {
                this.editingOldBoyItem = value;
                NotifyOfPropertyChange(() => EditingOldBoyItem);
            }
        }
        // elided
    } 
```

> 验证中涉及的 xml 文本框

```
 <Label Grid.Row="00"
                   Grid.Column="00"
                   Content="First Name" />
            <TextBox Text="{Binding Path=EditingOldBoyItem.Firstname, ValidatesOnDataErrors=True, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource TextBoxCellValidationStyle}"
                     Grid.Row="00"
                     Grid.Column="01">
                <i:Interaction.Behaviors>
                    <local:BindableFocusBehavior HasFocus="{Binding SetFocusToFirstName, Mode=TwoWay, UpdateSourceTrigger=Default}" />
                </i:Interaction.Behaviors>
            </TextBox>
            <Label Grid.Row="01"
                   Grid.Column="00"
                   Content="Surname" />
            <TextBox Text="{Binding Path=EditingOldBoyItem.Surname, ValidatesOnDataErrors=True, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     Validation.ErrorTemplate="{StaticResource ValidationTemplate}" 
                     Grid.Row="01"
                     Grid.Column="01">

<!-- save button that is disabled when CanSave is false -->

 <Button Content="Save Edit"
                    IsEnabled="{Binding Path=EditingOldBoyItem.CanSave}"
                    x:Name="Save"
                    Margin="4"
                    Template="{StaticResource RedGlassButton}" /> 
```

> 应用程序.xaml

```
 <ControlTemplate x:Key="ValidationTemplate">
                    <DockPanel LastChildFill="True">
                        <TextBlock DockPanel.Dock="Bottom"
                                   FontSize="12"
                                   FontWeight="Bold"
                                   Foreground="Red">
                            <TextBlock.ToolTip>
                                <ToolTip Placement="Center"
                                         Style="{StaticResource ErrorToolTip}">
                                    <TextBlock Foreground="White">
                                        <TextBlock.Text>
                                            <Binding Path="/ErrorContent" />
                                        </TextBlock.Text>
                                    </TextBlock>
                                </ToolTip>
                            </TextBlock.ToolTip>
                    </TextBlock>
                        <Border BorderBrush="Red"
                                BorderThickness="1">
                            <AdornedElementPlaceholder Name="adornerPlaceholder" />
                        </Border>
                    </DockPanel>
                </ControlTemplate>
                <Style x:Key="TextBoxCellValidationStyle"
                   BasedOn="{StaticResource {x:Type TextBox}}"
                   TargetType="{x:Type TextBox}">
                    <Style.Triggers>
                        <Trigger Property="Validation.HasError" Value="true">
                            <Setter Property="Background" Value="LightCyan" />
                            <Setter Property="Foreground" Value="Red" />
                            <Setter Property="Validation.ErrorTemplate" Value="{StaticResource ValidationTemplate}" />
                        </Trigger>
                    </Style.Triggers>
                </Style> 
```

# asp.net - Asp.net 网站管理工具使用错误的数据库

> ID：15815170
> 
> 赞同：2
> 
> 时间：2013-04-04T15:15:18.120
> 
> 标签：asp.net, asp.net-membership

我有一个使用会员功能的 ASP.Net 网络表单应用程序。**我已经在远程**服务器上使用 aspnet_regsql.exe 工具创建了所需的数据库。现在，如果我使用网站管理工具来定义角色，我会遇到以下情况：

*   我可以看到我以编程方式创建的用户 (Membership.CreateUser(...))
*   我可以定义新角色并将它们存储在某个地方
*   我无法将用户分配给角色（错误：“未找到用户 X”）。当我检查远程成员数据库时，角色表是空的。

我已经调查了这个问题，似乎角色被存储在App_Data 文件夹中**本地计算机上的 *mdf 数据库文件中。**这可能是因为该工具使用 machine.config 文件和 web.config 文件。

我的网络配置如下所示：

```
<connectionStrings>
<add name="userManagementConnectionString" connectionString="Data Source=myIp\SQLEXPRESS;Integrated Security=False;User ID=myUser;Password=myPW;Connect Timeout=15;Encrypt=False;TrustServerCertificate=False"/>

<add name="securityConnectionString" connectionString="Data Source=myIp\SQLEXPRESS;Initial Catalog=IsapMemberShip;Integrated Security=False;User ID=myUser;Password=myPW;TrustServerCertificate=False" providerName="System.Data.SqlClient" />
</connectionStrings>

<profile defaultProvider="DefaultProfileProvider">
  <providers>
    <add name="DefaultProfileProvider" type="System.Web.Providers.DefaultProfileProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="securityConnectionString" applicationName="/" />
  </providers>
</profile>

<membership defaultProvider="isapMembershipProvider">
  <providers>
    <add name="isapMembershipProvider"
    type="System.Web.Security.SqlMembershipProvider"
    connectionStringName="userManagementConnectionString" 
    ...      </providers>
</membership>

<roleManager enabled="true" defaultProvider="DefaultRoleProvider">
  <providers>
    <add connectionStringName="securityConnectionString" applicationName="/"
      name="DefaultRoleProvider" type="System.Web.Providers.DefaultRoleProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </providers>
</roleManager>

<sessionState mode="InProc" customProvider="DefaultSessionProvider">
  <providers>
    <add name="DefaultSessionProvider" type="System.Web.Providers.DefaultSessionStateProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="securityConnectionString" />
  </providers>
</sessionState> 
```

你可以看到我正在使用 2 个不同的连接字符串（一个用于用户存储，一个用于其余）。但是，两者都引用同一服务器上的同一数据库。我也尝试只使用“securityConnectionString”，但在这里没有成功（然后，该工具甚至找不到用户）。

那么...有人知道我如何使该工具（和我的应用程序）为所有会员目的使用相同的远程数据库吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:38:22.807

您有未匹配的连接字符串。

**请注意，会员标签`connectionStringName`是`userManagementConnectionString`**

它可能会解决您的问题，如果您将其更改为`securityConnectionString`- 与配置文件、roleManager 和 sessionState 相同。然后就可以删除了`userManagementConnectionString`。

```
<profile defaultProvider="DefaultProfileProvider">
  <providers>
    <add ...connectionStringName="securityConnectionString" 
       applicationName="/" />
  </providers>
</profile>

<membership defaultProvider="isapMembershipProvider">
  <providers>
    <add ... connectionStringName="userManagementConnectionString" ... />
  </providers>
</membership>

<roleManager enabled="true" defaultProvider="DefaultRoleProvider">
  <providers>
    <add connectionStringName="securityConnectionString" 
       applicationName="/" .../>
  </providers>
</roleManager>

<sessionState mode="InProc" customProvider="DefaultSessionProvider">
  <providers>
    <add ... connectionStringName="securityConnectionString" />
  </providers>
</sessionState> 
```

# javascript - 我们如何使用 phonegap 或 javascript 打开 iPhone/android 原生键盘

> ID：15815182
> 
> 赞同：1
> 
> 时间：2013-04-04T15:15:47.197
> 
> 标签：javascript, android, iphone, cordova

在我的 Phonegap 应用程序中，我需要一个可滚动的 div，当用户单击它时，设备键盘应该是打开的，并且文本应该可以在 div 中写入。但我不知道如何为这两个设备打开设备本机键盘。是否有任何插件可用于此功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:23:48.423

有一个隐藏的输入字段和`onclick`该 div 的事件，只需调用`focus()`该输入字段。它会自动调出键盘。然后您可以读取输入字段的内容并将其写入 div。

# objective-c - 如何在 Mac OS X 应用程序中直接从 NSOpenPanel 访问媒体部分（照片和电影）？

> ID：15815183
> 
> 赞同：0
> 
> 时间：2013-04-04T15:15:50.943
> 
> 标签：objective-c, macos, cocoa, nsopenpanel, iphoto

我已经参考了这个链接

[艾媒](https://github.com/karelia/iMedia)

现在我正在使用 NSOpenPanel 打开 iPhoto 库文件夹。

这是允许打开的代码。

```
int i = 0;
NSOpenPanel* openDlg = [NSOpenPanel openPanel];
[openDlg setCanChooseFiles:YES];
[openDlg setAllowedFileTypes:[NSArray arrayWithObjects:@"public.image",@"public.video",nil]];
[openDlg setAllowsMultipleSelection:TRUE];
[openDlg setAllowsOtherFileTypes:NO];

if ( [openDlg runModal] == NSOKButton )
{
    NSArray *files = [openDlg URLs];
    for( i = 0; i < [files count]; i++ )
    {
        NSLog(@"File path: %@", [[files objectAtIndex:i] path]);
    }
} 
```

此代码始终打开我的 Finder 库文件夹，因为我想直接打开媒体照片和电影文件夹。

请给我任何解决方案。

我在这里附上了一个屏幕截图。

![在此处输入图像描述](https://i.stack.imgur.com/dAKU4.jpg)

感谢和问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:38:10.773

您可以考虑添加以下代码片段：

```
 NSFileManager *fileManager = [NSFileManager defaultManager];
    NSError *error = nil;
    NSURL *picturesURL = [fileManager URLForDirectory:NSPicturesDirectory inDomain:NSUserDomainMask appropriateForURL:NULL create:NO error:&error];
    NSURL *iPhotoURL = [picturesURL URLByAppendingPathComponent:@"iPhoto Library.photolibrary"];

    [openDlg setDirectoryURL:iPhotoURL];

    // Now run the dialog 
```

如果用户将他的 iPhoto 图库移动到某个非标准位置，这将无济于事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T12:58:26.390

Apple 有一个私有 API，其中包含您想要访问的控件；此控件是一个**ILMediaBrowserView**并提供与 NSOpenDialog 中的完全相同的**视图**。如果您计划发布您的应用程序的 AppStore 版本，请不要使用它，但它可能很有用。集成到您的项目以获取该视图的框架是**/System/Library/** **PrivateFrameworks**中的 iLifeMediaBrowser.framework 。

# java - 处理复杂数据结构的正确方法是什么？

> ID：15815190
> 
> 赞同：0
> 
> 时间：2013-04-04T15:16:20.990
> 
> 标签：java

我有一个相当复杂的数据结构，它是在其他地图中堆叠地图结构：

```
Map<String, Map<Integer, PerformanceScopeMeta> > complex; 
```

这是 PerformanceScopeMeta 类：

```
class PerformanceScopeMeta {
    /* Meta information */
    private Map<String, String> meta;
    private List<PerformanceMessage> messages;
 } 
```

这就是我为“使内存可用于垃圾收集”所做的事情：

```
complex.put("SOME_KEY", null); 
```

这足够还是我完全错了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T15:18:58.837

好吧，如果没有*其他东西*可以引用地图，那么是的，这就足够了（假设您的地图接受空值）。

但请记住，如果`complex`引用的对象符合垃圾回收条件，那么您根本不需要做任何事情。只有当您需要清除地图的一部分时，您才需要执行此操作。根据我的经验，你必须为垃圾收集器做*任何事情是相对罕见的。*

我个人会使用`Map.remove`而不是您建议的代码：

```
complex.remove("SOME_KEY"); 
```

我假设您并不*真正*想要具有空值的条目......您只想完全摆脱该条目，对吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T15:19:11.243

`complex.remove("SOME_KEY")`如果您的任何代码都没有引用已删除的值或该已删除映射中的任何对象，则使用是可以的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-04T15:19:18.413

要从地图中删除键，请使用`complex.remove("SOME_KEY")`. 这将使相应的值符合垃圾回收的条件，*前提是没有剩余的对它的实时引用*。

# c# - 从工作流服务中的配置文件中读取端点

> ID：15815194
> 
> 赞同：0
> 
> 时间：2013-04-04T15:16:27.173
> 
> 标签：c#, web-services, workflowservice

我知道如何使用 C# 从活动中的配置文件中读取信息

```
 var servicesSection = (ClientSection)WebConfigurationManager.GetSection("system.serviceModel/client");
 ChannelEndpointElement endpoint = servicesSection.Endpoints[0]; 
```

但是当我尝试在工作流服务的 if 语句中读取这些信息时，它不起作用。我尝试使用以下代码从 web.config 文件中读取端点信息。

```
((ClientSection)WebConfigurationManager.GetSection("system.serviceModel/client")).Endpoints[0].toString().Equals(""); 
```

但它不起作用。不知何故，它不理解类型转换，我无法将 GetSection 输出转换为 clientSection 对象。您知道如何在工作流服务的 if 语句中执行此操作吗？（在调用其他活动之前从配置文件中检查一些内容）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-13T08:41:35.930

要从 app.config 中读取端点、绑定和其他部分，定义了一组 Section 类来帮助我们读取设置。

例如，要读取绑定列表，我们可以简单地使用，

```
private void GetNetTcpBindingName()
    {
        Configuration appConfig = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
        ServiceModelSectionGroup serviceModel = ServiceModelSectionGroup.GetSectionGroup(appConfig);
        BindingsSection oBinding = serviceModel.Bindings;

        List<BindingCollectionElement> bindingCollection = oBinding.BindingCollections;

        NetTcpBindingCollectionElement netTCPBindingCollectionElement = (NetTcpBindingCollectionElement)bindingCollection.Where(obj => obj.BindingName.Equals("netTcpBinding")).SingleOrDefault();

        if (netTCPBindingCollectionElement != null)
        {
            Console.WriteLine(netTCPBindingCollectionElement.ConfiguredBindings.ElementAt(0).Name);
        }
    } 
```

给定以下 app.config XML（感兴趣的部分以粗体显示），

```
<system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_ITrainerManagement" />
      </basicHttpBinding>
      **<netTcpBinding>
        <binding name="NetTcpBinding_ILiveStream">
          <security mode="None" />
        </binding>
      </netTcpBinding>**
    </bindings>
    <client>
      <endpoint address="net.tcp://sever-pc/PST.TS.LiveStream/LiveStream.svc"
          binding="netTcpBinding" bindingConfiguration="NetTcpBinding_ILiveStream"
          contract="LiveStreamServiceReference.ILiveStream" name="NetTcpBinding_ILiveStream" />
      <endpoint address="http://10.5.50.115/PST.TS.TrainerService/TrainerManagement.svc"
          binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_ITrainerManagement"
          contract="TrainerManagementServiceReference.ITrainerManagement"
          name="BasicHttpBinding_ITrainerManagement" />
    </client>
  </system.serviceModel> 
```

希望这可以帮助。这可用于读取任何标准设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-27T14:26:56.873

我有类似的要求，经过一些原型设计后，我按照以下方式进行了管理。希望这会对您和其他人有所帮助。

```
/* Using in System.ServiceModel.dll */
    using System.ServiceModel.Configuration;
    using System.Web.Configuration;

    /* Inside any method  */
    var clientSection = ((ClientSection)(WebConfigurationManager.GetSection("system.serviceModel/client")));
                if (clientSection != null)
                {
                    foreach (ChannelEndpointElement endPoint in clientSection.Endpoints)
                    {
                        ..... endPoint.Name / endPoint.Address etc.
                    }
                } 
```

您可以从配置中读取任何元素并将其转换为适当的元素类型。

# c - 如何打印用户输入的结果？

> ID：15815202
> 
> 赞同：-4
> 
> 时间：2013-04-04T15:16:44.803
> 
> 标签：c

这 ; 在编译器期望 void 之前。我真正的问题是：我能够输入 ID 和名称，但在 printf 中看不到它。是不是因为我的数据没有记录在指针里？如何解决问题？

```
#include <stdio.h>
struct data 
{
 int* ID;
 char* Name;
};

int main(void)
{
    struct data data1;
    struct data *data1Ptr;
    data1Ptr = &data1;
    printf("New ID:\n");
    scanf("%d",data1.ID);
    printf("Name:\n");
    scanf("%s",data1.Name);
    printf("The new ID is \n",&data1.ID);
    printf("The name input is \n",&data1.Name);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:19:34.410

你没有`printf()`正确使用。

它不会神奇地处理任何参数的格式化：您必须使用格式说明符（以 开头）*告诉它*`%`您要发送的参数以及您希望它们的值去哪里。

你需要：

```
printf("The new ID is %d\n", data1.ID);
printf("The name input is '%s'\n", data1.Name); 
```

另请注意，`ID`不应该`int *`，它需要存储一个实际的整数，所以它应该`int`只是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T15:28:28.923

```
#include <stdio.h>
#include <stdlib.h> /* for malloc and free */

struct data 
{
    /*int* ID; why a pointer? */
    int ID;
    char *Name;
};

/* void main() Noooo */
int main(void)
{
    struct data data1;
    struct data *data1Ptr; /* unused */

    data1Ptr = &data1;
    printf("New ID:\n");
    scanf("%d", &data1.ID); /* scanf expects a pointer */
    printf("Name:\n");
    /* you have to reserve mem for name before */
    data1.Name = malloc(100);
    /* check result of malloc here */
    scanf("%s",data1.Name);
    /*printf("The new ID is \n",data1.ID); You forget %d */
    printf("The new ID is %d\n",data1.ID);
    /* printf("The name input is \n",data1.Name); You forget %s */
    printf("The name input is %s\n",data1.Name);
    free(data1.Name);
    return 0;
} 
```

注意：如果您将 Name 声明为`char Name[100]`inside `struct data`，则无需`malloc`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T15:42:20.493

你这里似乎有很多问题。首先，您选择在结构中创建`Name`和`ID`指针。这意味着您需要在开始使用它们之前为两者动态分配内存：

```
struct data data1;
data1.ID = malloc(sizeof(int));
data1.Name = malloc(50); // so arbitrary amount big enough for a name. 
```

我不确定你为什么选择创建`ID`一个指针，它不一定在这个例子中，如果不是，它可能更容易理解；所以考虑改变它。

现在[`scanf()`](http://linux.die.net/man/3/scanf)需要一个格式字符串和许多指向正在读取的每种类型的指针。在您的情况下，您只是在读取一个 int 和一个字符串，所以您拥有的是：

```
scanf("%d",data1.ID);
scanf("%s",data1.Name); 
```

很好，请记住，如果您选择更改`ID`为 a`int`而不是指针，则需要传递它的地址：`scanf("%s",&data1.ID);`

[`printf()`](http://linux.die.net/man/3/printf)接受一个格式字符串，以及要打印的格式的数据。在你的情况下：

```
printf("The new ID is \n",&data1.ID);  // you're giving the address of the int
printf("The name input is \n",&data1.Name); // and the address of the string 
```

但是您没有提供任何格式...并且您不想发送指针的地址，这没有意义。

```
printf("The new ID is %d\n",*data1.ID);  // %d for an int, and * to dereference
printf("The name input is %s\n",data1.Name); // %s for a string 
```

您想要做的是相应地使用int`%d`和`%s`字符串（就像 with 一样`scanf()`），但是由于`ID`是指针，因此您需要在将其传递给`printf()`. C 中没有“字符串”类型，所以当你告诉`printf()`期待一个字符串时，它只需要一个`char *`已经`data1.Name`存在的字符串。

# c# - 以编程方式登录站点并将浏览器重定向到登录状态

> ID：15815213
> 
> 赞同：1
> 
> 时间：2013-04-04T15:17:09.760
> 
> 标签：c#, httpwebrequest, http-post, fiddler

我想在单击链接时登录站点，然后使用登录会话将浏览器重定向到那里。我遇到了一些麻烦，这是我尝试过的：

首先，我从登录站点获取会话 cookie：

```
CookieContainer cookies= new CookieContainer();
HttpWebRequest myHttpWebRequest = (HttpWebRequest)WebRequest.Create("http://someuri.com");
myHttpWebRequest.CookieContainer = cookies;
HttpWebResponse myHttpWebResponse = (HttpWebResponse)myHttpWebRequest.GetResponse();
myHttpWebResponse.Close(); 
```

然后我发布到登录页面进行登录：

```
HttpWebRequest getRequest = (HttpWebRequest)WebRequest.Create("http://signInURL.com");
getRequest.CookieContainer = cookies;
getRequest.Method = WebRequestMethods.Http.Post;
getRequest.UserAgent = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/535.2 (KHTML, like Gecko) Chrome/15.0.874.121 Safari/535.2";
getRequest.AllowWriteStreamBuffering = true;
getRequest.ProtocolVersion = HttpVersion.Version11;
getRequest.AllowAutoRedirect = true;
getRequest.ContentType = "application/x-www-form-urlencoded";

byte[] byteArray = Encoding.ASCII.GetBytes(PostParameterStringWithSignInInfo);
getRequest.ContentLength = byteArray.Length;
Stream newStream = getRequest.GetRequestStream();
newStream.Write(byteArray, 0, byteArray.Length);
newStream.Close();

HttpWebResponse getResponse = (HttpWebResponse)getRequest.GetResponse(); 
```

然后我想我需要将cookies设置给客户端：

```
CookieCollection cooki = getRequest.CookieContainer.GetCookies(new Uri("http://someUri.com"));
for(int i = 0; i < cooki.Count; i++)
{
    Cookie c = cooki[i];
    Response.Cookies.Add(new HttpCookie(c.Name, c.Value));
} 
```

然后重定向到您最终登录的位置：

```
Response.Redirect("http://URLwhenBeingSignedIn.com"); 
```

这不起作用。重定向时，我仍然注销。

尝试使用 Fiddler 执行此操作并成功登录并被重定向：

获取会话 cookie：

```
GET / HTTP/1.1
Content-type: application/x-www-form-urlencoded
Host: someuri.com 
```

发布到登录页面以进行登录：

```
POST /signIn HTTP/1.1
Accept: text/html, application/xhtml+xml, */*
Referer: http://someuri.com
Accept-Language: en-GB,en;q=0.7,tr;q=0.3
User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0)
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip, deflate
Connection: Keep-Alive
Content-Length: 90
DNT: 1
Host: signInURL.com
Pragma: no-cache
Cookie: JSESSIONID=fromBefore; Cookie2=fromBefore

PostParameterStringWithSignInInfo 
```

也许有一种比我现在想到的更简单的方法，您可以看到有效的提琴手请求，如果是这样，我很高兴看到它。

# backbone.js - 将参数传递给 Backbone.View 的构造函数

> ID：15815216
> 
> 赞同：2
> 
> 时间：2013-04-04T15:17:21.423
> 
> 标签：backbone.js

我创建了一个主干视图

```
App.MyView = Backbone.View.extend({...}); 
```

然后实例化它

```
new App.MyView(); 
```

但是如果我的对象需要一些初始值我

```
new App.MyView({name:"Beautiful"}); 
```

`MyView`然后我会像这样访问这个选项

```
App.MyView= Backbone.View.extend({
    initialize: function(){
        console.log(this.options.name);
    }
}); 
```

这很好用，但不是一个不言自明的对象：我必须事先知道需要以文字方式传递初始值`({this.name:"Beautiful"})`才能`MyView`正常工作..

我如何传递类似`initialize(name)`或类似的参数来明确视图中需要这些值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T17:48:25.837

Javascript 函数没有定义数量的参数，所以基本上你不能。
写作：

```
function(name) {...} 
```

只是一个快捷方式：

```
function() {
  var name = arguments[0];
  ...
} 
```

如果您的参数未定义，您最终可能会抛出错误：

```
function(name) {
  if(typeof name === 'undefined') throw 'Error: missing argument';
  ...
} 
```

但是，是的，除此之外，您不能强制使用论点。

**编辑：**
如果你的问题只是清晰度，我担心你也不能这样做。

**Edit2：**
好吧，如果你真的想的话，你可以，但我真的会避免走那些路。

# sql - ORA-00922: 使用 CREATE TABLE 时选项缺失或无效

> ID：15815217
> 
> 赞同：1
> 
> 时间：2013-04-04T15:17:22.170
> 
> 标签：sql, oracle

当我尝试创建表时，我不断收到此错误。这是我到目前为止所拥有的：

```
CREATE TABLE Club
    ( Club_ID          NUMBER(7)        NOT NULL
    , Club_Name        VARCHAR2(35)     NOT NULL
    , Street_Addr      VARCHAR2(40)     NOT NULL
    , City             VARCHAR2(20)     NOT NULL
    , State            CHAR(2)          NOT NULL
    , Zipcode          NUMBER(7)        NOT NULL
    , Phone            NUMBER(10)       NOT NULL
    , CONSTRAINT club_pk PRIMARY KEY (Club_ID)
    ) 

CREATE TABLE Member
    ( Member_ID        NUMBER(10)      NOT NULL
    , First_Name       VARCHAR2(20)    NOT NULL
    , Last_Name        VARCHAR2(30)    NOT NULL
    , Street_Addr      VARCHAR2(40)    NOT NULL
    , City             VARCHAR2(20)    NOT NULL
    , State            CHAR(2)         NOT NULL
    , Zipcode          NUMBER(7)       NOT NULL
    , Phone            NUMBER(10)      NOT NULL
    , CONSTRAINT member_pk PRIMARY KEY (Member_ID)
    ) ; 
```

我没有从每个单独的错误中得到任何错误，但是一旦像这样将它们放在一起，我就会遇到问题。在两个 CREATE TABLE 部分之间添加分号会导致不同的错误（“ORA-00911：无效字符”）。我应该做些什么不同的事情？

谢谢！

# javascript - javascript 对象属性末尾的破折号

> ID：15815219
> 
> 赞同：0
> 
> 时间：2013-04-04T15:17:30.510
> 
> 标签：javascript, properties, hyphen

我可以像这样在javascript对象属性名称的末尾使用破折号吗？我在任何文档中都找不到这是无效的，但在这种情况下尝试访问值 myProp- 时我得到了一些奇怪的结果。

```
var myObject = {"myProp-":"myValue"}; 
```

我只能像这样 myObject["myProp-"] 访问这个值，我想像这样访问

```
myObject.myProp- 
```

但我得到了“ SyntaxError: Unexpected token }”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T15:21:07.387

您必须使用括号表示法而不是点表示法：

```
myObject["myProp-"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:21:18.137

```
var myObject = {"myProp-":"myValue", "foo": "bar" };

myObject.foo;
myObject["foo"]; // these are equivalent

myObject.myProp-; // syntax error
myObject["myProp-"]; // this is fine

var key = "myProp-";
myObject[key]; // this works as well (dynamic index)
myObject.key; // undefined 
```

括号表示法与点表示法是等价的。

# oracle10g - ORA12704 Oracle 触发器中的错误

> ID：15815220
> 
> 赞同：0
> 
> 时间：2013-04-04T15:17:41.907
> 
> 标签：oracle10g

我有一个可以编译的触发器，但会引发 ORA12704 字符不匹配错误。这是引发错误的行

```
Begin
   if :new.ADD_TEXT = '{8A9AFF65-9BD8-4B2A-8686-5279CC34F24B}' and
      :new.MORE_TEXT is null then
      :new.MORE_TEXT := substr(:new.RES_TXT, instr(:new.RES_TXT, '.',-1)+1, 10); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:42:11.633

尝试更改线路

```
 :new.MORE_TEXT := substr(:new.RES_TXT, instr(:new.RES_TXT, '.',-1)+1, 10); 
```

至

```
 :new.MORE_TEXT := substr(:new.RES_TXT, instr(:new.RES_TXT, n'.',-1)+1, 10); 
```

即 instr 函数调用中的第一个和第二个参数在数据类型中匹配。即使拥有该参数，我也无法在 10.2.0.4 上复制该问题`'.'`。

.例如，如果您使用插入值在您的机器上运行这个煮沸的测试用例，它会失败吗？

```
drop table tester;
create table tester
(
ADD_TEXT  VARCHAR2 (38),
MORE_Text NVARCHAR2(500),
RES_TXT  NVARCHAR2(500)
);

create trigger tester_trig
before insert on tester
for each row
declare
begin
   if :new.ADD_TEXT = '{8A9AFF65-9BD8-4B2A-8686-5279CC34F24B}' and
      :new.MORE_TEXT is null then
      :new.MORE_TEXT := substr(:new.RES_TXT, instr(:new.RES_TXT, '.',-1)+1, 10); 
  end if;

end;
/

insert into tester values ('{8A9AFF65-9BD8-4B2A-8686-5279CC34F24B}', '', 'your.value' );
select * from tester; 
```

编辑：

根据您的新触发器：

```
SQL> CREATE OR REPLACE TRIGGER test_trigger_001
  2  Before Insert or update ON tester
  3  for each row
  4  declare
  5    v1_ext varchar2(10);
  6  Begin
  7    if :new.ADD_TEXT = '{8A9AFF65-9BD8-4B2A-8686-5279CC34F24B}'
  8      and :new.MORE_TEXT is null
  9    then
 10      :new.MORE_TEXT := substr(:new.RES_TXT, instr(:new.RES_TXT, '.',-1)+1, 10);
 11      select Case :new.MORE_TEXT
 12        WHEN 'avi' THEN 'video/x-msvideo'
 13        WHEN 'doc' THEN 'application/msword'
 14        else 'application/unknown'
 15      end
 16      into :new.MORE_TEXT
 17      from dual;
 18    end if;
 19    v1_ext := null;
 20  END;
 21  /

Warning: Trigger created with compilation errors.

SQL> show errors
Errors for TRIGGER TEST_TRIGGER_001:

LINE/COL ERROR
-------- -----------------------------------------------------------------
8/5      PL/SQL: SQL Statement ignored
9/12     PL/SQL: ORA-12704: character set mismatch 
```

修复`n`

```
SQL> CREATE OR REPLACE TRIGGER test_trigger_001
  2  Before Insert or update ON tester
  3  for each row
  4  declare
  5    v1_ext varchar2(10);
  6  Begin
  7    if :new.ADD_TEXT = '{8A9AFF65-9BD8-4B2A-8686-5279CC34F24B}'
  8      and :new.MORE_TEXT is null
  9    then
 10      :new.MORE_TEXT := substr(:new.RES_TXT, instr(:new.RES_TXT, n'.',-1)+1, 10);
 11      select Case :new.MORE_TEXT
 12        WHEN n'avi' THEN n'video/x-msvideo'
 13        WHEN n'doc' THEN n'application/msword'
 14        else n'application/unknown'
 15      end
 16      into :new.MORE_TEXT
 17      from dual;
 18    end if;
 19    v1_ext := null;
 20  END;
 21  /

Trigger created.

SQL> show errors
No errors.
SQL> insert into tester values ('{8A9AFF65-9BD8-4B2A-8686-5279CC34F24B}', '', 'foo.avi');

1 row created.

SQL> select * from tester;

ADD_TEXT
--------------------------------------
MORE_TEXT
--------------------------------------------------------------------------------
RES_TXT
--------------------------------------------------------------------------------
{8A9AFF65-9BD8-4B2A-8686-5279CC34F24B}
video/x-msvideo
foo.avi 
```

# asp.net-mvc - Ajax 轮询使浏览器崩溃，因为它的内存使用，cpu 使用不断增加？任何替代品

> ID：15815221
> 
> 赞同：0
> 
> 时间：2013-04-04T15:17:42.840
> 
> 标签：asp.net-mvc, jquery, ajax-polling

我是 ajax 轮询的新手，我实现了连续获取数据，但我遇到的问题是内存使用率和 CPU 使用率不断增加，最后浏览器崩溃。这是我用来连续获取数据的 ajax 调用。

```
$(document).ready(function () {

make_call();
function make_call() {
$.ajax({
url: "url",
              accepts: "application/json",
              cache: false,
              success: function (result) { // Some code here },
complete: make_call
});
}
} 
```

有没有其他选择，或者我做错了什么。请提供一些建议或解决方案。提前致谢 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:28:54.543

您的代码在先前请求完成的同时初始化一个新请求（完成是错误或成功）。您可能希望在请求新数据之前有一点延迟 - 这样做可以减少服务器和客户端的负载。

```
$.ajax({
  // ...
  complete: function() {
    setTimeout(make_call, 5000);
  }
}); 
```

上面的代码在发出下一个请求之前等待 5 秒。根据您对“连续”的需求调整值。

# java - 如何在列表视图下方添加视图

> ID：15815232
> 
> 赞同：2
> 
> 时间：2013-04-04T15:18:08.307
> 
> 标签：java, android, listview

我在这里找到了一些关于 SO 的主题，但它们不是我正在搜索的内容。其中之一就是这个[Android ListActivity - 如何在 ListView 下方添加视图？](https://stackoverflow.com/questions/6190820/android-listactivity-how-to-add-a-view-below-the-listview)

我知道我可以在列表视图的页脚放置一个视图（如按钮）。这意味着所需的视图将在最后一个视图之后定位自己。

我想知道如何在屏幕末尾放置一个视图（就在下面）。请检查以下两张图片：

![在此处输入图像描述](https://i.stack.imgur.com/wOmej.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/bivwC.png)

我想在java代码中做到这一点。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:25:09.287

试试下面的代码

```
<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_above="@+id/button1"
     >

</ListView>

<Button
    android:id="@+id/button1"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:text="Button" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:28:56.693

使用相对布局。将 Listview 的高度设置为所需的高度。将按钮相对于列表视图放置在按钮上。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"

tools:context=".MainActivity" >

<ListView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="200dp"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:text="TextView" />

<Button
    android:id="@+id/button1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_marginLeft="122dp"
    android:text="Button" />

 </RelativeLayout> 
```

# php - PHP“显示表”MySQLi 查询不起作用

> ID：15815233
> 
> 赞同：1
> 
> 时间：2013-04-04T15:18:08.993
> 
> 标签：php, mysqli, prepared-statement

我正在尝试使用 php 执行准备好的语句，但它不起作用。我准备好的陈述是这样的：

```
SHOW TABLES LIKE "italy_turin_mathematics" 
```

我这样做：

```
if ($stmt = $this->mysqli->prepare("SHOW TABLES LIKE ?_?_?")) {

    $stmt->bind_param('sss', "italy", "turin", "mathematics");

    $stmt->execute();

    $stmt->store_result();
    $stmt->bind_result($column1);

    while($stmt->fetch()) {
        echo "Table: ".$column1;
    }

} 
```

我确定它必须返回一些东西，因为使用 PHPMyAdmin 它确实可以，但是使用 PHP 它总是跳过 while 循环，我认为准备好的语句查询有问题，也许它需要转义下划线字符？

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:26:09.413

您的数据库体系结构完全**错误**。

应该**只有一张表**包含所有地点和科学的所有数据。
而且您必须以通常的方式查询它，而`SHOW TABLES`根本不使用它。

所以，它必须是这样的

```
$sql = "SELECT * FROM t WHERE country=? AND city=? and science=?";
$stm = $pdo->prepare($sql);
$stm->execute(array("italy", "turin", "mathematics"));
$data = $stm->fetchAll(); 
```

上面的代码在 PDO 中，因为你必须使用它而不是 mysqli。

拆分表是一个非常糟糕的主意，违反了关系数据库的基本规则。如您所见，它会让您运行这样一个奇怪的查询，并使您的进一步代码变得更糟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:29:31.430

```
if ($stmt = $this->mysqli->prepare("SHOW TABLES LIKE ?")) {

    $country = "italy";
    $city = "turin";
    $course = "mathematics";

    $stmt->bind_param('s', $country . "_" . $city . "_" . $course);

    $stmt->execute();

    $stmt->store_result();
    $stmt->bind_result($column1);

    while($stmt->fetch()) {
        echo "Table: ".$column1;
    }

} 
```

据我所知，您拥有的代码会导致查询如下所示：

```
SHOW TABLES LIKE 'italy'_'turin'_'mathematics' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T16:10:33.783

您不能在 mySQL 或我能想到的任何形式的 SQL 中进行这样的连接。

```
SHOW TABLES LIKE ?_?_? 
```

应该：

```
SHOW TABLES LIKE CONCAT(?, '_', ?, '_', ?) --this gives an error, see below 
```

我完全同意@your-common-sense 的评论，即这是一种*糟糕*的数据库设计方式，你会以更多的方式后悔，而不仅仅是这个搞砸的查询。

## 编辑：

MySQL 似乎不允许在`SHOW TABLES`语句中使用函数，因此您必须将表名连接到 PHP 中的单个字符串，或者您可以使用如下查询：

```
SELECT 
  TABLE_NAME
FROM    
  INFORMATION_SCHEMA.TABLES    
WHERE    
  table_schema = 'mydb' AND    
  table_name LIKE CONCAT(?, '_', ?, '_', ?); 
```

# floating-point - NEON 定点编码和定点与浮点运算性能比较

> ID：15815238
> 
> 赞同：2
> 
> 时间：2013-04-04T15:18:18.023
> 
> 标签：floating-point, embedded, arm, neon, fixed-point

正如我们在这里看到的“[手臂整数 NEON 运算周期](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0344b/BABBGJHI.html)”和手臂浮点 NEON 运算周期，整数乘法运算似乎与浮点乘法运算相比没有明显优势。当我将浮点代码转换为定点时，我必须在定点乘法/除法指令之后添加额外的“移位”指令。由于指令的增加，程序所需的周期实际上增加了。由于定点，我的程序的性能恶化了。（浮点代码为 14000 个周期，定点代码为 26000 个周期）。

是否有专门用于 NEON 的定点运算（乘法和除法）的特殊指令？我只找到了一条指令，它只转换 Fixed -float 和其他方式。有没有在 NEON 中编写定点程序的有效方法？

我为浮点代码编写了以下示例代码。

```
 VMUL   Q14.F32,Q8.F32,Q2.F32
    VMUL   Q15.F32,Q8.F32,Q3.F32
    VLD2    {Q10.F32,Q11.F32},[pTw2@256],TwdStep
    VLD2    {Q4.F32,Q5.F32},[pT1@256],fftSize
    VMLA   Q14.F32,Q9.F32,Q3.F32
    VMLS   Q15.F32,Q9.F32,Q2.F32 
```

以下代码通过在 VMUL A 指令后插入移位操作转换为定点代码。

```
 VMUL   Q14.S32,Q8.S32,Q2.S32
   VMUL   Q15.S32,Q8.S32,Q3.S32
   VLD2    {Q10.S32,Q11.S32},[pTw2@256],TwdStep
   VLD2    {Q4.S32,Q5.S32},[pT1@256],fftSize
   VMLA   Q14.S32,Q9.S32,Q3.S32
   VMLS   Q15.S32,Q9.S32,Q2.S32

   VRSHR    Q14.S32,Q14.S32,#12     ;Shift instructions to account for fixed point 
   VRSHR    Q15.S32,Q15.S32,#12     ; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T07:39:50.193

有关指令集，请参阅[矢量浮点指令集快速参考](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.subset.swdev.qrc/index.html)卡`NEON`。没有专门的定点指令。

我建议您阅读`blog.arm.com`标题[为 NEON 编码 - 第 3 部分：矩阵乘法](http://blogs.arm.com/software-enablement/241-coding-for-neon-part-3-matrix-multiplication/)/*定点*的帖子，它可能会给您一些尝试的想法。

它声称：

> > 使用定点算法进行计算通常比浮点数更快——它需要更少的内存带宽来读取和写入使用更少位的值，并且整数值的乘法通常比应用于浮点数的相同运算更快。
> > 
> > 但是，在使用定点算术时，您必须仔细选择表示以避免溢出或饱和，同时保持应用程序所需结果的精度。

# c# - 将短数组转换为字符串 C#

> ID：15815240
> 
> 赞同：7
> 
> 时间：2013-04-04T15:18:24.200
> 
> 标签：c#, utf-16

是否可以将`short`数组转换为`string`，然后显示文本？

```
short[] a = new short[] {0x33, 0x65, 0x66, 0xE62, 0xE63}; 
```

数组中有`utf16`（泰文字符）包含。它如何输出和显示泰语和英语单词？

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T15:24:11.153

您可以使用以下方法从 UTF16 字节数组中获取字符串：

```
System.Text.Encoding.Unicode.GetString(bytes) 
```

但是，这只接受一个字节数组。所以你首先必须将你的短裤转换为字节：

```
var bytes = a.SelectMany(x => BitConverter.GetBytes(x)).ToArray(); 
```

或者稍微冗长但更高效的代码：

```
var bytes = new byte[a.Length * 2];
Buffer.BlockCopy(a, 0, bytes, 0, a.Length * 2); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-04T15:30:05.323

我稍微扯掉了其他人的答案，但这是做同样事情的一种更清洁的方法：

```
short[] shorts = new short[] { 0x33, 0x65, 0x66, 0xE62, 0xE63 };
char[] chars = Array.ConvertAll(shorts, Convert.ToChar);
string result = new string(chars); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T15:20:04.817

尝试这个：

```
//short[] a = new short[] {0x33, 0x65, 0x66, 0xE62, 0xE63};
char[] a = new char[] {0x33, 0x65, 0x66, 0xE62, 0xE63};
string s = new string(a);

Console.WriteLine(s); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T15:28:00.847

你需要一个数组`char`。`string`有一个直接接受一个的重载。

```
char[] temp = new char[a.Length];
Array.Copy(a, temp, a.Length);
return new string(temp); 
```

不幸的是，这涉及复制整个数组。从理论上讲，您可以通过使用一些强制转换技巧和不安全的代码来避免这种情况，但这会很棘手。

理想情况下，正如其他人所提到的，您将从 a`char[]`而不是 a开始`short[]`。例如，如果您从文件加载，您可以在转换`char[]`后将找到的数字存储到 a 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T15:24:49.873

尝试这个：

```
short[] a = new short[] { 0x33, 0x65, 0x66, 0xE62, 0xE63 };
var contobyte = a.Select(b => (byte)b).ToArray();
var res = System.Text.Encoding.Unicode.GetString(contobyte); 
```

# php - 在同一域上的 Zend 和纯 PHP 之间共享会话

> ID：15815249
> 
> 赞同：1
> 
> 时间：2013-04-04T15:18:47.283
> 
> 标签：php, zend-framework, session

我有两个这样的文件夹：

1.  /public/zend_app/
2.  /public/pure_php/

Drupal 已安装在 root 中。

现在，我想在第二条路径中创建一个会话并在 zend 中使用它。我尝试了一些不同的方法来做到这一点，但失败是结果！

我检查**session_id**和**session_save_path**两者现在是一样的。

在第二个文件夹中，我有这个：

```
session_start();
session_id($_COOKIE[PHPSESSID]);
$_SESSION[user] = 123; 
```

在第一个：

```
$someNamespace = new Zend_Session_Namespace('ns');
//......

session_id($_COOKIE[PHPSESSID]);
print_r($_SESSION); 
```

但它返回空数组！

我也在第二个文件夹中试过这个：

```
set_include_path ( $zend_path );
include_once $zend_path . '/Session.php';
$user = new Zend_Session_Namespace('user'); 
```

但是我收到了这个错误：（我无法阻止运行 session_start 来逃避这个错误）

> Zend_Session_Exception：会话已经由 Zend_Session::start() 中的 session.auto-start 或 session_start() 启动（C:\wamp\www\zend_app\library\Zend\Session.php 的第 462 行）。

现在我的问题是如何与 zend 共享它？Zend 是否使用特殊处理程序？如何在纯 php 代码中使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T02:22:33.623

看一眼：

[http://framework.zend.com/manual/1.12/en/zend.session.basic_usage.html](http://framework.zend.com/manual/1.12/en/zend.session.basic_usage.html)

```
$myNamespace = new Zend_Session_Namespace('myNamespace');

// $myNamespace corresponds to $_SESSION['myNamespace'] 
```

摆脱`session_id()`，你不需要给 PHP cookie，它会自动处理。

我刚刚在 ZF 控制器中尝试过这个：

```
$session = new Zend_Session_Namespace('ns');
$session->foo = "bar";
print_r($_SESSION); 
```

这就是我得到的：

```
Array
(
        [ns] => Array
        (
            [foo] => bar
        )
} 
```

所以我`$_SESSION['ns']['foo']`现在可以用纯 PHP 访问。我还可以在纯 PHP 中设置值：

```
$_SESSION['ns']['baz'] = "quz"; 
```

以及后来在 ZF 中的访问：

```
echo $session->baz; // gives me "quz" 
```

# php - PHP 和 MySQL 中的特殊字符

> ID：15815252
> 
> 赞同：1
> 
> 时间：2013-04-04T15:18:52.667
> 
> 标签：php, mysql, html-entities

我在 PHP 中遇到了一些特殊字符的问题。我在 mysql (utf8_hungarian_ci) 中有一个表，其中包含一些带有特殊字符的文本，如 á、á、Ó、Ö、ö、ü，我想在我的页面上显示此文本。我已经测试过：

```
$text = htmlentities($text); //to convert the simple spec chars
$search = array("& otilde;","&O tilde;","& ucirc;","&U circ;");
$replace = array("& #337;","& #336;","& #369;","& #368;");
$text = str_replace($search, $replace, $text);
echo $text; 
```

但此代码仅在 $text 未从数据库设置时才有效。如果我使用此代码并且我的 $text 是从数据库中选择的，它不会显示任何文本，并且如果我只使用： echo $text; 没有 htmlentities 和替换

我得到这样的字符：�</p>

我知道对此有一些问题，我已经尝试过接受的答案，但它仍然不起作用，所以如果你愿意并且如果你有时间，请帮助我。还是非常感谢。祝大家有个美好的一天！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:26:14.083

还可以尝试在您的标头中设置以使用 UTF-8 编码。

在您的 PHP 文件中，添加

```
header('Content-type: text/html; charset=utf-8'); 
```

以及在您的`<meta>`标签中指定编码为 UTF-8，以确保您告诉浏览器。看看它是否能解决问题。

以及在您的`meta`标签中包含 UTF-8 编码。

```
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
...
</head> 
```

编辑：

1.  如果您有权访问 Apache 配置，请查看 AddDefaultCharset 是否设置为另一种编码。
2.  尝试使用`mysql_set_charset()`(mysqli_set_charset() 如果您使用的是 MySQLi)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:22:58.720

尝试把它放在你的 html 头文件中：

```
<meta http-equiv="Content-type" content="text/html; charset=utf-8" /> 
```

（此外，您可能需要将文件保存为“utf-8”文件编码）

.

其次，您可以使用它来尝试翻译或删除在您的情况下总是打印出来的令人不安的字符：

```
$str_out = @iconv("ISO-8859-1", "UTF-8//TRANSLIT//IGNORE", $str_in); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T08:12:56.357

这是一个稍微通用的答案，但请阅读我写的关于 PHP/MySQL 堆栈中常见字符编码陷阱的这篇文章，如果您仍然有问题，让我们尝试解决它们。

[http://webmonkeyuk.wordpress.com/2011/04/23/how-to-avoid-character-encoding-problems-in-php/](http://webmonkeyuk.wordpress.com/2011/04/23/how-to-avoid-character-encoding-problems-in-php/)

# javascript - 使用 Javascript 将多个空格转换为行首

> ID：15815256
> 
> 赞同：3
> 
> 时间：2013-04-04T15:19:11.133
> 
> 标签：javascript, regex, indentation, line-breaks

我正在为网站后端进行文本输入。我希望自动更正几件事。例如，我转换为的文本区域中的新行`<br>`。我还想让用户在新行上切换。

这需要将空格更改为`&nbsp;`. 我只想转换新行开头的空格。例如，假设用户将其输入到 textarea 中：

```
This is my text! It's pretty great.
This is a second line.
    This is a third line, that is indented by four spaces.
This is a fourth line. 
```

使用正则表达式，我得到了每行要转换的第一个空格：

```
.replace(/^[ ]/mg,'&nbsp;'); 
```

我已经将多个空格转换为一个空格：

```
.replace(/[ ]{2,}/mg,'&nbsp;'); 
```

不过，我不知道如何转换所有四个缩进空格。我已经在互联网上搜索了大约 3 个小时，我找到了类似的答案，但我无法在这里工作。有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T18:59:34.507

```
function escapeSpaces(str) {
    var regex = /^ +/mg;

    return str.replace(regex, function (match) {
        var result = "";
        for (var i = 0, len = match.length; i < len; i++) {
            result += "&nbsp;";
        }
        return result;
    });
} 
```

这可能不是最好的解决方案，但它确实有效。

或者：

```
function escapeSpaces (str) {
    return str.replace(/^ +/mg, function (match) {
        return match.replace(/ /g, "&nbsp;");
    });
} 
```

# javascript - 通过 JavaScript 将文本框值添加到多个选择框

> ID：15815257
> 
> 赞同：1
> 
> 时间：2013-04-04T15:19:11.627
> 
> 标签：javascript, coldfusion

我有一个文本框，允许用户在其中输入字母数字输入。我还有一个加号图像，单击时必须将输入的文本添加到名为“add key num”的多选框（如下所示）。在多选框“add key num”中添加几个输入后，用户可以单击左箭头将最终列表添加到“list key num”选择框中。我被困在将文本输入从文本框添加到第一个选择框的 JavaScript 上。请指教。![样本图像](https://i.stack.imgur.com/XCmSC.png)

这是我拥有的代码：

```
<cfparam name="SESSION.stkeynum" default="">
<table border="1" align="center" STYLE="margin-left:120px;" bgcolor="##B0C4DE">         
<tr>
    <td align="center" >ENTER KEY NUM</td>
    <td align="center" ></td>
    <td align="center" >ADD KEY NUM</td>                
    <td align="center" ></td>
    <td align="center" >LIST KEY NUM</td>
    <td align="center" >AMOUNT</td>             
</tr> 
<tr>
    <td align="center"><input type="text" maxlength ="8" name="vstkeynum" id="vstkeynum" value="" size="15"></td>
    <td><img src="../images/plus.jpg" alt="Add Key number" onclick="add_cc(document.myform.vstkeynum.value);"></img></td>
    <td nowrap>
        <div id="Div1"></div>   
        <select name="keynumber" size="5" multiple style="width: 175px; display: inline;">
            <option value="null"> </option> 
        </select> 
    </td>
    <td><img src="../images/arrow_right.gif" alt="Add To List" onclick="copySelectedOptions_edit(document.myform.keynumber,document.myform.keynumber_selection);">
        <hr>
        <img onclick="removeSelectedOptions_edit(document.myform.keynumber_selection);" src="../images/arrow_left.gif" alt="Delete From List">  
    </td>
    <td nowrap>
        <select name="keynumber_selection" size="5" multiple style="width: 175px;">
        </select>
    </td>
    <td align="center"><input type="text" maxlength ="8" name="amount" id="amount" value="" size="7"></td>
</tr> 
</table> 
```

JavaScript：

```
<script type="text/javascript">
    function add_cc(a) {
    // inital load
    ajax({
        url: 'add_keynum.cfm?vval=' + a,
        fillDiv: 'Div1',
        showBusy: true
    });
    document.myform.vstkeynum.value = "";
    }
</script>
<script>
    function copySelectedOptions_edit(from, to) {
    var options = new Object();
    if (hasOptions(to)) {
        for (var i = 0; i < to.options.length; i++) {
        options[to.options[i].value] = to.options[i].text;
        }
    }
    if (!hasOptions(from)) {
        return;
    }
    for (var i = 0; i < from.options.length; i++) {
        var o = from.options[i];
        if (o.selected) {
        if (options[o.value] == null || options[o.value] == "undefined" || options[o.value] != o.text) {
            if (!hasOptions(to)) {
            var index = 0;
            } else {
            var index = to.options.length;
            }
            to.options[index] = new Option(o.text, o.value, false, false);
        }
        }
    }
    if ((arguments.length < 3) || (arguments[2] == true)) {
        sortSelect(to);
    }
    from.selectedIndex = -1;
    to.selectedIndex = -1;
    }

    function removeSelectedOptions_edit(from) {
    if (!hasOptions(from)) {
        return;
    }
    if (from.type == "select-one") {
        from.options[from.selectedIndex] = null;
    } else {
        for (var i = (from.options.length - 1); i >= 0; i--) {
        var o = from.options[i];
        if (o.selected) {
            from.options[i] = null;
        }
        }
    }
    from.selectedIndex = -1;
    }
</script> 
```

这是 add_keynum.cfm 中的代码：

```
<cfif isDefined("vval")  >
    <cfif trim(vval) neq "">
        <cfset SESSION.stkeynum = Listappend(SESSION.stkeynum,vval)>
        <cfoutput>#SESSION.stkeynum#</cfoutput>
    <cfelse>
        <cfif isDefined("session.stkeynum")>
            <cfoutput>#SESSION.stkeynum#</cfoutput>
        </cfif>
    </cfif>
</cfif> 
```

# mongodb - 关于 MongoDB bind_ip 标志的说明

> ID：15815259
> 
> 赞同：2
> 
> 时间：2013-04-04T15:19:12.217
> 
> 标签：mongodb

我正在阅读 MongoDb 文档，我注意到您可以为您的实例 设置一个[bind_ip标志。](http://docs.mongodb.org/manual/reference/configuration-options/#bind_ip)`mongod`

从我阅读后收集的内容来看，您似乎可以在配置文件中使用它来使 MongoDB 仅响应来自特定 IP 地址的连接。

在互联网上挖掘以获取更多信息，它看起来好像[没有达到我的预期](https://groups.google.com/forum/?fromgroups=#!topic/mongodb-user/t5VZd8Ir4Vc)（检查最后一条评论）。虽然它可能是旧的/不准确的，但它已经有几年了。

那我说得对吗？bind_ip 是否限制哪些外部 IP 可以连接到数据库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:59:05.907

bind_ip 不限制外部 IP 地址。它将您的 mongod 实例绑定到它正在运行的机器上的特定网络接口。

例如，如果您有一台服务器，其中有 2 个网卡，一个与私有内部网络接口，另一个与公共、安全性较低的网络接口。您可以将 mongod 绑定到专用卡/接口，以便它只接受通过您的专用网络的连接。

# neo4j - Neo4j ResultSet Object - 如果结果是数组，如何获取数据

> ID：15815260
> 
> 赞同：0
> 
> 时间：2013-04-04T15:19:12.907
> 
> 标签：neo4j, resultset, gremlin

我有一个使用的 gremlin 查询`cap().next()`

并且`Everyman\Neo4j\Query\ResultSet` `Object`是

...

```
[data:protected] => Array
    (
        [v[1079]] => Array
            (
                [0] => 14
            )

        [v[1082]] => Array
            (
                [0] => 25
            )

        [v[1016]] => Array
            (
                [0] => 5
            )

        [v[1078]] => Array
            (
                [0] => 10
            )

        [v[1081]] => Array
            (
                [0] => 17
            )

    ) 
```

...

如何获得该数组？

`$result[0][0]`不管用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:23:09.123

要迭代结果集，请使用

```
 foreach ($result as $row) {
    echo $row['x']->getProperty('your_property') . "\n";
} 
```

或在 y 列中使用标量值

```
foreach ($result as $row) {
echo $row['x']->getProperty('your_property') . ": " . $row['y'] ."\n"; 
```

}

最好让原始的 gremlin 查询来查看您从中返回的内容。

见[github](https://github.com/jadell/neo4jphp/wiki/Cypher-and-gremlin-queries)

# javascript - jQuery 队列函数

> ID：15815264
> 
> 赞同：2
> 
> 时间：2013-04-04T15:19:24.623
> 
> 标签：javascript, jquery, queue

采取这两种方法：

```
function moveUp() {
     this.element.rotate(0);
     this.element.animate({"margin-top": "-=51px"}, "slow");
     //do some more things for instance.    
}

 function moveRight() {
     this.element.rotate(90);
     this.element.animate({"margin-left": "+=51px"}, "slow");
 } 
```

以防万一，我旋转一个对象，然后用动画移动它。这些功能映射到按键，所以如果用户按下向上或向右，对象就会移动。我的问题是动画正确排队，因为 jQuery 为它们使用 fx 队列。但是轮换会立即发生，就像我做的任何其他事情一样，因为它们是我的代码中的自定义内容。

结果很明显，如果你按 say up 并立即按 right，对象会向上旋转，但在向上移动时，它会向右旋转，它并没有真正等到它到达那里。

我如何编写这段代码，以便将整个方法链接起来，而不仅仅是它们的动画。我可以添加回调，但它们并不总是一起执行，如果它们碰巧同时被调用，我需要将它们排队，但我不太明白如何在 jQuery 中使用队列功能。

顺便说一句，为了查看更多这背后的代码，我最近也问了这个问题：[原型函数数组](https://stackoverflow.com/questions/15812167/javascript-array-of-prototype-functions)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:58:58.780

您可以使用以下内容对其进行动画处理：

```
 $elem.animate({rotation: 90},
    {
            duration: 'slow',
            step: function(now, fx) {
                    $(this).css({ "transform": "rotate("+now+"deg)", "-webkit-transform": "rotate("+now+"deg)", "-moz-transform": "rotate("+now+"deg)" });
            }
    }) 
```

这会自动将其添加到队列中

我在这里做了一个jsfiddle：

[http://jsfiddle.net/obartra/7Qwgd/1/](http://jsfiddle.net/obartra/7Qwgd/1/)

编辑：只是为了解释我的理由，我猜`rotate`您使用的方法是使用 setTimeout 逐步设置 CSS 中的旋转，因此不会将其添加到动画队列中。此处的代码`animate`用于旋转元素，以便将其添加到动画队列中。

# assembly - MIPS指令J格式

> ID：15815270
> 
> 赞同：4
> 
> 时间：2013-04-04T15:19:35.343
> 
> 标签：assembly, mips

我对以下 MIPS 代码有疑问：如果第一条指令位于内存地址 0xFFFFFF00，那么指令“j loopEnd”的十六进制表示形式是什么？我不知道该怎么做。任何帮助将不胜感激。谢谢。

```
loop:
    slt $t9, $s3, $s2   
    bne $t9, $zero, end
    add $s4, $s2, $s3           
    srl $s4, $s4, 1
    sll $t0, $s4, 2             
    add $t0, $s0, $t0       
    lw $t1, 0($t0)
    slt $t9, $s1, $t1       
    beq $t9, $zero, bigger  
    addi $s3, $s4, -1 
    j loopEnd
loopEnd:
    j loop 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-02-17T23:33:44.967

`j`是一条j型指令，格式如下：`opcode - address` 分别为6位和26位。

前 6 位，`opcode`对于一条`j`指令是`000010`

地址的下 26 位有点棘手。首先，您需要您所指标签的地址。在您的示例中，由于指令地址`slt`为`0xFFFFFF00`，每次向上计数 4，loopEnd 的指令地址（即指令`j loop`）将为`0xFFFFFF2C`。

所以现在我们有了目标指令的地址`0xFFFFFF2C`，但这是 32 位，而我们只有 26 位用于 J 型指令中的目标地址。这是通过删除第一个十六进制数字并删除最后 2 个二进制数字来处理的。实际跳转到的地址的第一个十六进制数字将与当前指令相同（`F`在您的情况下）。我们可以去掉最后 2 个二进制数字，因为指令地址总是 4 的倍数，所以我们不需要最后 2 个二进制数字给我们的 0、1、2、3 精度，它们总是`00`用于指令地址.

将所有这些结合起来作为您的示例：

`0xFFFFFF2C`-> `0x FFFFF2C`-> 转换为二进制

`1111_1111_1111_1111_1111_0010_1100`->`1111_1111_1111_1111_1111_0010_10`

现在我们将操作码与解释的指令地址结合起来： `000010_11111111111111111111001010`

那是机器代码`j loopend`

TL;博士

1.  获取跳转指令的操作码
2.  在十六进制的标签处获取地址
3.  删除地址的第一个十六进制数字
4.  转换为二进制
5.  删除最后两位
6.  结合操作码和解释地址

# java - 是否有通用绑定规则来解决多个问题：两个声明导致 ObjectFactory 类中的冲突

> ID：15815271
> 
> 赞同：2
> 
> 时间：2013-04-04T15:19:39.443
> 
> 标签：java, binding, xsd, jaxb, wsdl

我正在从一个 WSDL 和几个 XSD 文件生成 java 类。其中一个 XSD 包含超过 1000 个导致错误的复杂类型/元素：

两个声明导致 ObjectFactory 类中的冲突

我找到了如何通过使用如下绑定规则来修复它们：

```
<jxb:bindings node=".//xs:element[@name='ProjectEmployeeExpenseLineKey']">
     <jxb:factoryMethod name="ProjectEmployeeExpenseLineKeyEl"/>
</jxb:bindings> 
```

但由于有太多需要修复，我正在寻找一个通用规则来修复它们。

我发现了一些关于前缀的东西，但没有成功使它起作用。它看起来像这样：

```
<jxb:bindings schemaLocation="Microsoft1.xsd" >
        <jxb:schemaBindings>
            <jxb:nameXmlTransform>
                <jxb:elementName suffix="Element"/>
            </jxb:nameXmlTransform>
        </jxb:schemaBindings>
</jxb:bindings> 
```

我显然做错了什么..

如果你能帮我弄清楚......欢迎你的智慧和宝贵的知识:-)

谢谢大卫

# javascript - jquery/javascript 全部解开

> ID：15815274
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:19:42.187
> 
> 标签：javascript, jquery, regex, replace

我有这个：

```
<div>All <span class="hl">text</span> should <span class="hl">be <span class="hl">unwrapped</span> <span>but not me</span> </span></div> 
```

如何删除所有跨度（使用 class="h1"）来获得这个？

```
<div>All text should be unwrapped <span>but not me</span></div> 
```

ps：会考虑javascript Regex或jquery解决方案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:23:06.137

在 jQuery 中：

```
$("span.hl").contents().unwrap(); 
```

将为该特定代码行执行您想要的操作，但如果您的代码更改，您可能必须使用不同的选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:22:54.790

```
$('span .h1').contents().unwrap(); 
```

这段代码会做

# postgresql - 事务错误后回滚

> ID：15815275
> 
> 赞同：6
> 
> 时间：2013-04-04T15:19:49.933
> 
> 标签：postgresql

对于熟悉 Postgresql 的人来说，这应该很容易：

我的应用程序发出一个`begin_work`，执行一些操作，然后发出一个`commit`. 操作和提交被包装在一个 try-catch 块中，它的 catch 语句执行一个`rollback`. 假设：如果 SQL 操作发生错误，Postgresql 会自动回滚事务，因此我的回滚将是多余**但**无害的。这个假设正确吗？

（无论如何我要回滚的原因：以防发生与 SQL 操作无关的异常。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:33:54.893

如果发生错误，PostgreSQL 并不会真正回滚事务。它使每个后续语句都失败并出现错误。你可以在客户端试试这个。

您需要先执行回滚，然后才能成功执行任何语句。

如果您关闭连接并启动一个新连接，这没什么影响。但是，如果您保留连接并运行您希望成功执行的其他语句，它将不起作用。

# javascript - 在不同的数组中拆分文本（字符串）Javascript

> ID：15815279
> 
> 赞同：0
> 
> 时间：2013-04-04T15:19:58.480
> 
> 标签：javascript, split

我正在处理一个接收字符串变量的项目（通过调用 ac# 函数，因为我的 c# 代码发出 HTTPWebrequest 并接收回数据，并且该函数返回正确的数据）。

字符串变量是这样的：

```
Bus number:15
Bus destination: Walker Titan Road
Time: 14:39:00

Bus number:11
Bus destination: Walker Titan Road
Time: 14:42:00

Bus number:X78
Bus destination: Newcastle (city centre) Eldon Square Bus Station
Time: 14:49:00 
```

现在我想**在 Javascript中将这些字符串分隔在不同的数组中**

我想要以下内容：

```
BusNumbers[]{15,11,X78}
busDestinations][{Walker Titan Road,Walker Titan Road,Newcastle (city centre) Eldon Square Bus Station}
busTimes[]{14:39:00,14:49:00,14:49:00} 
```

我想要这个，因为我想（在 Javascript 中）制作一个表格，我可以将每个信息放在正确的列中。

我在 c# 中编写了一个简短的程序来显示我想在 javascript 中执行的操作：

```
string[] A1 = new string[] { "15", "X86", "54" };
        string[] A2 = new string[] { "Newcastle", "City Centre", "Monument" };
        string[] A3 = new string[] { "15:05", "16:06", "16:35" };

            for (int j = 0; j < A1.Length; j++)
            {
                listBox1.Items.Add("Busnumber: " + A1[j] + "--");
                listBox1.Items.Add(" Destination: " + A2[j] + "--");
                listBox1.Items.Add(" Time : " + A3[j] + "\n");

            } 
```

（它是用列表框制作的，但由于示例无关紧要......）

但在我可以创建一个 for 循环并在表中添加所有信息之前，我想知道如何分隔数组中的每个 busnumber、数组中的每个 busDestination 和数组中的每个 busTime。

这在Javascript中存在吗？

还是我需要寻找另一种选择？

如果没有我想在 c# 3 函数中制作的解决方案，其中每个函数返回正确的信息，一个函数显示所有总线号，一个显示所有目的地，一个显示所有时间。我可以在 Javascript 中调用所有这些函数并将文本拆分为“，”并将它们全部放入正确的数组中。

有人可以帮助我吗？我希望我的问题足够清楚......

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:39:51.707

假设 x 匹配您的输入（并且输入与您提供的内容一致）：

```
var x ='Bus number:15 \nBus destination: Walker Titan Road \nTime: 14:39:00  \nBus number:11 \nBus destination: Walker Titan Road \nTime: 14:42:00  \nBus number:X78 \nBus destination: Newcastle (city centre) Eldon Square Bus Station \nTime: 14:49:00\n';

var BusNo = x.match(/[.]*Bus number\:[\s]*([\S])+(?=\s)/g).map(function(m){return m.replace('Bus number:','');});
var BusDest = x.match(/[.]*Bus destination\:[\s]*[\w\s\(\)]*(?=\n)/g).map(function(m){return m.replace(/Bus destination\:[\s]*/,'').trim();});
var BusTime = x.match(/[.]*Time\:[\s]*[:|\d]*(?=\s)/g).map(function(m){return m.replace(/Time\:[\s]*/,'').trim();}); 
```

会给你描述的。注意*可能*有更好的正则表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:32:54.667

你必须选择：

1.  使用标准的 js 字符串操作函数（substr、regex 等）为这个字符串编写自己的解析器。我不会在这里提供代码，这是您需要自己做的事情。但这不是优雅的解决方案，这是您问题的直接解决方案。

2.  如果您可以修改生成此字符串的 C# 代码，那么您可以将其完全更改为生成 JSON 而不是字符串。这个过程称为序列化，您应该熟悉它。这个解决方案比第一个更优雅。

# java - 正则表达式替换标签之间的所有逗号

> ID：15815282
> 
> 赞同：1
> 
> 时间：2013-04-04T15:20:07.017
> 
> 标签：java, regex, string, replace

我试图用正则表达式替换java中的这个字符串，这个，因为它是一个jtextArea，它可以包含很多次这个组合，

```
input
%fila%
Val1,val2,val3
%/fila%

output
<tr>
<th>val1</th>
<th>val2</th>
<th>val3</th>
</tr> 
```

我尝试了几次没有运气

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:42:23.040

仅使用一个正则表达式很难做到这一点，但两个表达式会做得更好：

```
String test = "%fila%\nVal1,val2,val3\n%/fila%";

Pattern bracket = Pattern.compile("%([^%]+)%([^%]*)%/\\1%", Pattern.MULTILINE);
Matcher m = bracket.matcher(test);
if (m.find()) {
    String middle = m.group(2);
    String tagged = "<tr>"+
        middle
        .replaceAll("[^,\n]+", "<th>$0</th>")
        .replaceAll(",","\n")
    +"</tr>";
    System.out.println(tagged);
} 
```

第一个表达式找到标记区域；第二个（内部`replaceAll`）查找单个元素，并用`<th></th>`标签“框起来”它们。

不幸的是，这根本不涉及嵌套：如果您将多个`%fila%`s 相互嵌套，则上述方法将失败。但是，如果您必须允许无限嵌套相同的标签，则正则表达式将无法做到：在这种情况下，您需要计算嵌套级别，但正则表达式语言的功能不足以进行计数。

这是[关于 ideone 的演示](http://ideone.com/clone/FqbF4H)。

# jquery - 使用 ui-coverflow 翻转图像以显示一些细节

> ID：15815284
> 
> 赞同：0
> 
> 时间：2013-04-04T15:20:22.303
> 
> 标签：jquery, jquery-ui

我最近一直在使用addsyomani coverflow，并试图找到一种在单击以显示一些附加细节时翻转图像的方法。例如，当您单击 cd-cover 时，它会翻转到 cd-cover 的背面。

有没有办法做到这一点？

谢谢你的时间，和你的帮助！

这是我的代码：

```
<!-- Include theme -->
<link type="text/css" href="../../Content/jquery-ui-1.10.1.custom.css" rel="Stylesheet" />

<!-- Include jQuery and UI -->
<script type="text/javascript" src="../../Scripts/jquery-1.6.2.js"></script>
<script type="text/javascript" src="../../Scripts/jquery-ui-1.8.9.custom.min.js"></script>

<!-- Include jQuery CoverFlow widget -->
<script type="text/javascript" src="../../Scripts/ui.coverflow.js"></script>

<link type="text/css" href="../../Content/carrousel.css" rel="stylesheet" />

<!-- Transformie is a plugin that makes webkit's CSS transforms work in Internet Explorer -->
<script src="../../Scripts/sylvester.js" type="text/javascript"></script>
<script src="../../Scripts/transformie.js" type="text/javascript"></script>

<!-- Include mousewheel dependancies and app files -->
<script src="../../Scripts/jquery.mousewheel.min.js" type="text/javascript"></script>
<script src="../../Scripts/app.js" type="text/javascript"></script>

<script type="text/javascript">

$(function () {

    var demo = {

        yScroll: function (wrapper, scrollable) {

            var wrapper = $(wrapper), scrollable = $(scrollable),
                loading = $('<div class="loading">Loading...</div>').appendTo(wrapper),
                internal = null,
                images = null;
            scrollable.hide();
            images = scrollable.find('img');
            completed = 0;

            images.each(function () {
                if (this.complete) completed++;
            });

            if (completed == images.length) {
                setTimeout(function () {
                    loading.hide();
                    wrapper.css({ overflow: 'hidden' });
                    scrollable.slideDown('slow', function () {
                        enable();
                    });
                }, 0);
            }

            function enable() {
                var inactiveMargin = 99,
                    wrapperWidth = wrapper.width(),
                    wrapperHeight = wrapper.height(),
                    scrollableHeight = scrollable.outerHeight() + 2 * inactiveMargin,
                    wrapperOffset = 0,
                    top = 0,
                    lastTarget = null;

                wrapper.mousemove(function (e) {
                    lastTarget = e.target;
                    wrapperOffset = wrapper.offset();
                    top = (e.pageY - wrapperOffset.top) * (scrollableHeight - wrapperHeight) / wrapperHeight - inactiveMargin;
                    if (top < 0) {
                        top = 0;
                    }
                    wrapper.scrollTop(top);
                });
            }
        }
    }
    demo.yScroll('#scroll-pane', 'ul#sortable');
});
</script>

<h2>Covers</h2>

<div class="pageWrapper">
<div class="demo" style="position:relative">
    <div class="wrapper">
        <ul>
            <div id="coverflow">
                <img src="/Cover/GetCover/ironmaidenFotD_FRONT.jpg" data-artist="Iron Maiden" data-album="Fear of the Dark" />
                <img src="/Cover/GetCover/ironmaidenFotD_BACK.jpg" data-artist="Iron Maiden" data-album="Fear of the Dark" />
            </div>
        </ul>
    </div>

    <div id="imageCaption">
    Sample Text
    </div>

    <div id='slider'></div>
</div>

<div class="demo-description">
</div>

<div class="listholder" style="display:none">

    <div id="scroll-pane">
        <ul id="sortable">
        </ul>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:08:30.640

检查我的小提琴；[http://jsfiddle.net/Allendar/uK5av/](http://jsfiddle.net/Allendar/uK5av/)

不需要 JavaScript 'at' 'all' :)

**HTML**

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>HTML</title>
    <link rel="stylesheet" href="main.css" type="text/css" />
</head>
<body>
    <div id="f1_container">
        <div id="f1_card" class="shadow">
            <div class="front face">
                <img src="http://media-cdn.tripadvisor.com/media/photo-s/03/48/0b/14/dolphin-view-chalets.jpg" style="height: 281px; width: 450px;" />
            </div>
            <div class="back face center">
                Some text inside here
            </div>
        </div>
    </div>
</body>
</html> 
```

**CSS**

```
#f1_container {
    position: relative;
    margin: 10px auto;
    width: 450px;
    height: 281px;
    z-index: 1;
}
#f1_container {
    -webkit-perspective: 1000;
    perspective: 1000;
}
#f1_card {
    width: 100%;
    height: 100%;
    -webkit-transform-style: preserve-3d;
    -webkit-transition: all 1.0s linear;
    transform-style: preserve-3d;
    transition: all 1.0s linear;
}
#f1_container:hover #f1_card {
    -webkit-transform: rotateY(180deg);
    transform: rotateY(180deg);
    box-shadow: -5px 5px 5px #aaa;
}
.face {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}
.face.back {
    display: block;
    -webkit-transform: rotateY(180deg);
    transform: rotateY(180deg);
    box-sizing: border-box;
    color: white;
    text-align: center;
    background-color: #aaa;
} 
```

# jquery - setInterval + jQuery CSS Animation on Window Size

> ID：15815289
> 
> 赞同：0
> 
> 时间：2013-04-04T15:20:30.337
> 
> 标签：jquery, css, animation, setinterval, window-resize

我正在尝试解决这个问题，我已经尝试了各种方法，虽然从逻辑上讲它应该有效，但它只是没有。任何帮助都会很棒，因为我不擅长编码。

所以我试图将一个对象从左侧动画到右侧的末端。并且定位因屏幕尺寸而异。

到目前为止，这是我所拥有的。我正在检测用户的浏览器大小，但我也想在新的调整大小检测时销毁 setIntervals。

```
showViewportSize();
var $box = $('#box');

$(window).resize(function (e) {
    window.clearInterval('animation');
    showViewportSize();
});

function showViewportSize() {
    var width = $(window).width();
    var height = $(window).height();

    if (width <= 1024) {
        var box = setInterval(function () {
            $box.animate({
                "left": "+1200"
            }, 40000, function () {
                $box.removeAttr("style");
            });
        }, 400);
    }

    if ((width <= 1440) && (width > 1025)) {
        var box = setInterval(function () {
            $box.animate({
                "left": "+1200"
            }, 40000, function () {
                $box.removeAttr("style");
            });
        }, 400);
    }

    if (width >= 2000) {
        var box = setInterval(function () {
            $box.animate({
                "left": "+1200"
            }, 40000, function () {
                $box.removeAttr("style");
            });
        }, 400);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:34:20.450

将 CSS3 过渡与良好的“ol 媒体查询”混合起来怎么样？

```
#box {
    left: 0;

    -webkit-transition: left 0.4s ease-in-out;
    -moz-transition: left 0.4s ease-in-out;
    -o-transition: left 0.4s ease-in-out;
    transition: left 0.4s ease-in-out;
}

@media screen and (min-width : 1024px) {
    #box {
        left: 1200px;
    }
} 
```

应该可以工作，但尚未测试。

# c# - 将 .csv 转换为数据表时的额外引号

> ID：15815292
> 
> 赞同：2
> 
> 时间：2013-04-04T15:20:34.983
> 
> 标签：c#, string, file, csv, datatable

我需要用两个 excel 文件填充两个数据表。这些文件可以是逗号分隔值文件 (.csv)，也可以是 Excel 文档 (.xlsx) 文件。我使用一个函数将我的 .csv 转换为数据表：

* * *

```
public DataTable GetDataTableFromCsv(string path)
{
    DataTable dataTable = new DataTable();
    String[] values;

    values = File.ReadAllLines(path);

    string[] csvRows = System.IO.File.ReadAllLines(path);
    string[] headers = csvRows[0].Split(',');

    // Adding columns name
    foreach (var item in headers)
        dataTable.Columns.Add(new DataColumn(item));

    string[] fields = null;

    foreach (string csvRow in csvRows)
    {
        fields = csvRow.Split(',');
        DataRow row = dataTable.NewRow();
        row.ItemArray = fields;
        dataTable.Rows.Add(row);
    }
    return dataTable;
} 
```

当我尝试将两个数据表与以下内容进行比较时，就会出现问题：

```
ieDiff = dt1.AsEnumerable().Except(dt2.AsEnumerable(), DataRowComparer.Default); 
```

我通过 .xlsx 文件获得的第一个数据表包含正确的值，而我通过 .csv 文件获得的第二个数据表包含正确的值​​，但带有一些额外的引号。

**前任 ：**

*dt1.Rows[10]（来自 .csv 的数据表）将包含：*

1.  项目1
2.  项目2
3.  “。”
4.  “项目 4”

*dt2.Rows[10]（来自 .xlsx 的数据表）将包含：*

1.  项目1
2.  项目2
3.  .
4.  项目4

我知道我可以修剪所有这些，但肯定有更好的方法来执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:39:26.550

最简单的答案是您在问题中提到的一个，即修剪引号字符。

我的测试代码：

```
var test = new[] { "Item1", "Item2", "\".\"", "\"Item4\"" };
foreach (var s in test)
{
    textBox1.AppendTextAddNewLine(s.Trim('"'));
} 
```

结果输出：

```
Item1
Item2
.
Item4 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-22T11:02:33.213

我在下面编写了五种方法，它们会将 Csv 文件转换为 DataTable。

它们的设计考虑了可选的引号（例如 " 符号），并且在不使用其他库的情况下尽可能多地使用：

```
 public static DataTable GetDataTabletFromCSVFile(string filePath, bool isHeadings)
    {
        DataTable MethodResult = null;
        try
        {
            using (TextFieldParser TextFieldParser = new TextFieldParser(filePath))
            {
                if (isHeadings)
                {
                    MethodResult = GetDataTableFromTextFieldParser(TextFieldParser);

                }
                else
                {
                    MethodResult = GetDataTableFromTextFieldParserNoHeadings(TextFieldParser);

                }

            }

        }
        catch (Exception ex)
        {
            ex.HandleException();
        }
        return MethodResult;
    }

    public static DataTable GetDataTableFromCsvString(string csvBody, bool isHeadings)
    {
        DataTable MethodResult = null;
        try
        {
            MemoryStream MemoryStream = new MemoryStream();

            StreamWriter StreamWriter = new StreamWriter(MemoryStream);

            StreamWriter.Write(csvBody);

            StreamWriter.Flush();

            MemoryStream.Position = 0;

            using (TextFieldParser TextFieldParser = new TextFieldParser(MemoryStream))
            {
                if (isHeadings)
                {
                    MethodResult = GetDataTableFromTextFieldParser(TextFieldParser);

                }
                else
                {
                    MethodResult = GetDataTableFromTextFieldParserNoHeadings(TextFieldParser);

                }

            }

        }
        catch (Exception ex)
        {
            ex.HandleException();
        }
        return MethodResult;
    }

    public static DataTable GetDataTableFromRemoteCsv(string url, bool isHeadings)
    {
        DataTable MethodResult = null;
        try
        {
            HttpWebRequest httpWebRequest = (HttpWebRequest)WebRequest.Create(url);
            HttpWebResponse httpWebResponse = (HttpWebResponse)httpWebRequest.GetResponse();

            StreamReader StreamReader = new StreamReader(httpWebResponse.GetResponseStream());

            using (TextFieldParser TextFieldParser = new TextFieldParser(StreamReader))
            {
                if (isHeadings)
                {
                    MethodResult = GetDataTableFromTextFieldParser(TextFieldParser);

                }
                else
                {
                    MethodResult = GetDataTableFromTextFieldParserNoHeadings(TextFieldParser);

                }

            }

        }
        catch (Exception ex)
        {
            ex.HandleException();
        }
        return MethodResult;
    }

    private static DataTable GetDataTableFromTextFieldParser(TextFieldParser textFieldParser)
    {
        DataTable MethodResult = null;
        try
        {
            textFieldParser.SetDelimiters(new string[] { "," });

            textFieldParser.HasFieldsEnclosedInQuotes = true;

            string[] ColumnFields = textFieldParser.ReadFields();

            DataTable dt = new DataTable();

            foreach (string ColumnField in ColumnFields)
            {
                DataColumn DataColumn = new DataColumn(ColumnField);

                DataColumn.AllowDBNull = true;

                dt.Columns.Add(DataColumn);

            }

            while (!textFieldParser.EndOfData)
            {
                string[] Fields = textFieldParser.ReadFields();

                for (int i = 0; i < Fields.Length; i++)
                {
                    if (Fields[i] == "")
                    {
                        Fields[i] = null;

                    }

                }

                dt.Rows.Add(Fields);

            }

            MethodResult = dt;

        }
        catch (Exception ex)
        {
            ex.HandleException();
        }
        return MethodResult;
    }

    private static DataTable GetDataTableFromTextFieldParserNoHeadings(TextFieldParser textFieldParser)
    {
        DataTable MethodResult = null;
        try
        {
            textFieldParser.SetDelimiters(new string[] { "," });

            textFieldParser.HasFieldsEnclosedInQuotes = true;

            bool FirstPass = true;

            DataTable dt = new DataTable();

            while (!textFieldParser.EndOfData)
            {
                string[] Fields = textFieldParser.ReadFields();

                if(FirstPass)
                {
                    for (int i = 0; i < Fields.Length; i++)
                    {
                        DataColumn DataColumn = new DataColumn("Column " + i);

                        DataColumn.AllowDBNull = true;

                        dt.Columns.Add(DataColumn);

                    }

                    FirstPass = false;

                }

                for (int i = 0; i < Fields.Length; i++)
                {
                    if (Fields[i] == "")
                    {
                        Fields[i] = null;

                    }

                }

                dt.Rows.Add(Fields);

            }

            MethodResult = dt;

        }
        catch (Exception ex)
        {
            ex.HandleException();
        }
        return MethodResult;
    } 
```

如果像我一样，您正在从报告服务中保存，那么您应该像这样使用它：

```
 Warning[] warnings;
    string[] streamids;
    string mimeType;
    string encoding;
    string filenameExtension;

    byte[] bytes = rvMain.ServerReport.Render("csv", null, out mimeType, out encoding, out filenameExtension, out streamids, out warnings);

    string CsvBody = System.Text.Encoding.UTF8.GetString(bytes);

    DataTable dt = GetDataTableFromCsvString(CsvBody,true); 
```

否则，您需要做的就是：

```
 bool IsHeadings = true; //Does the data include a heading row?

    DataTable dt = GetDataTableFromCsvString(CsvBody, IsHeadings); 
```

或者直接从 csv 文件中使用

```
 bool IsHeadings = true; //Does the data include a heading row?

    DataTable dt = GetDataTabletFromCsvFile(FilePath, IsHeadings) 
```

或者使用远程存储的 csv 文件

```
 bool IsHeadings = true; //Does the data include a heading row?

    DataTable dt = GetDataTabletFromRemoteCsv(Url, IsHeadings) 
```

# c# - 如何在窗体之外访问和设置控件的属性？

> ID：15815299
> 
> 赞同：3
> 
> 时间：2013-04-04T15:20:54.920
> 
> 标签：c#, visual-studio-2010, forms, properties, controls

我对编程非常陌生，目前正在开发 C# Windows Forms 应用程序。

问题如下：我有一个包含不同对象和控件的表单，例如：标签页、文本框、计时器等。我还有一个 UserControl 表单，我将它加载到主表单的一个标签页中。

我想在 UserControl 中编写代码，如何操作主窗体的元素属性。

例如：当我单击 UserControl 窗体上的按钮时，它将主窗体的 timer.Enabled 控件设置为 true。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:23:41.413

可以这样做，但让用户控件访问和操作表单并不是最干净的方式 - 让用户控件引发事件并让托管表单处理事件会更好。（例如在处理按钮点击时，表单可以启用/禁用计时器等）

这样，如果需要，您可以针对不同的表单以不同的方式使用用户控件；它使正在发生的事情变得更加明显。

更新：在您的用户控件中，您可以声明一个事件 - 在按钮单击中，您引发事件：

```
namespace WindowsFormsApplication1
{
    public partial class UserControl1 : UserControl
    {
        public event EventHandler OnButtonClicked;

        public UserControl1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            EventHandler handler = OnButtonClicked;

            // if something is listening for this event, let let them know it has occurred
            if (handler != null)
            {
                handler(this, new EventArgs());
            }

        }
    }
} 
```

然后在您的表单中，添加用户控件。然后，您可以挂钩事件：

```
namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            userControl11.OnButtonClicked += userControl11_OnButtonClicked;
        }

        void userControl11_OnButtonClicked(object sender, EventArgs e)
        {
            MessageBox.Show("got here");
        }

        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:26:28.580

您可以将`timer1.Modifiers`属性设置为“内部”并使用实例访问它`Form1`：

```
form1.timer1.Enabled = true; 
```

您需要有一个类的实例`Form1`，而不是类本身。例如：

```
// INVALID
Form1.timer1.Enabled = true;

// VALID
var form1 = Form1.ActiveForm;
form1.timer1.Enabled = true; 
```

但这不是一种非常干净的方法，您宁愿使用 NDJ 的回答中描述的事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T15:34:27.437

您可能想重新考虑您要完成的工作。但是，要回答您的问题，可以这样做。

最好的方法是在你的 UserControl 中创建一个名为 MainForm 的属性：

```
public Control MainForm {
    get;
    set;
} 
```

然后，在 MainForm 的 Load 事件中，将属性设置为自身：

```
userControl1.MainForm = this; 
```

最后，在您的用户控件中，设置 MainForm 的计时器：

```
protected button_click(object sender, EventArgs e)
{
    timerName = "timer1";
    EnableTimer(timerName);
}

private void EnableTimer(timerName)
{
    var timer = MainForm.Controls.FirstOrDefault(z => z.Name.ToLower().Equals(timerName.ToLower());
    if (timer != null)
    {
         ((Timer)timer).Enabled = true;
    } else {
         // Timer was not found
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T15:49:55.680

这很简单。它被称为事件。在用户控件上，您将使用 EventHandler 公开一个事件以供表单订阅。

```
public partial class MyUserControl : UserControl
{
    /// You can name the event anything you want.
    public event EventHandler ButtonSelected;

    /// This bubbles the button selected event up to the form.
    private void Button1_Clicked(object sender, EventArgs e)
    {
         if (this.ButtonSelected != null)
         {
              // You could pass your own custom arguments back to the form here.
              this.ButtonSelected(this, e)
         }
    }
} 
```

现在我们有了用户控件代码，我们将在表单代码中实现它。可能在表单的构造函数中，您将拥有如下代码。

```
MyUserControl ctrl = new MyUserControl();
ctrl.ButtonSelected += this.ButtonSelected_OnClick; 
```

最后，在表单代码中，您将拥有一个订阅事件的方法，如下面的代码，它将启用 Timer 设置为 true。

```
private void ButtonSelected_OnClick(object sender, EventArgs e)
{
    this.Timer1.Enabled = true;
} 
```

这就是您允许表单上的用户控件上的事件在表单上设置对象的方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-24T11:55:48.373

您需要输入以下代码，

```
(`userControl11.OnButtonClicked += userControl11_OnButtonClicked;`) 
```

在 Visual Studio 中的单独文件中。另一个文件称为`'Form1.Designer.cs'`，可以在下面的`Solution Explorer`窗格中找到

`Form1 >> Form1.cs >> Form1.Designer.cs`.

希望这可以帮助！

# php - PHP DateTime createFromFormat 不会自然死亡

> ID：15815300
> 
> 赞同：2
> 
> 时间：2013-04-04T15:20:55.507
> 
> 标签：php, datetime, iso8601

我对 createFromFormat 的行为感到困惑。

```
 private function _event_date($eventdate) {

    $this->_logger->err($eventdate);

    $dt = new DateTime();

    $dt->createFromFormat(DATE_ISO8601, $eventdate);

    $formatted = $dt->format("m/d/Y");

    $this->_logger->err($formatted);

    return $formatted;
} 
```

我多次调用_event_date。我希望当我创建一个新的 DateTime 对象时，它将接受 $eventdate 并产生一个新的格式化日期。

奇怪的是（对我来说），我的输出看起来像这样：

```
2013-04-04 15:10:26 UTC error _event_date 2013-04-05T21:00:00-0400
2013-04-04 15:10:26 UTC error _event_date 04/04/2013
2013-04-04 15:10:26 UTC error _event_date 2013-04-12T20:00:00-0400
2013-04-04 15:10:26 UTC error _event_date 04/04/2013
2013-04-04 15:10:26 UTC error _event_date 2013-04-16T18:00:00-0400
2013-04-04 15:10:26 UTC error _event_date 04/04/2013
2013-04-04 15:10:26 UTC error _event_date 2013-04-17T19:30:00-0400
2013-04-04 15:10:26 UTC error _event_date 04/04/2013
2013-04-04 15:10:26 UTC error _event_date 2013-04-18T20:00:00-0400
2013-04-04 15:10:26 UTC error _event_date 04/04/2013 
```

似乎出于某种原因，DateTime 保留了我原来的 $eventdate 值。

为什么是这样？我是否误解了 createFromFormat 的工作原理？我错过了关于 PHP 的对象模型的一些东西吗？PHP 是不是在我的饮料里放了什么东西？

- - - - - - - 回答 - - - - - - - -

Marc B 在下面的回答确实解决了这个问题：

```
 // month/day/year
private function _event_date($eventdate) {

    $this->_logger->err($eventdate);

    $dt = DateTime::createFromFormat(DATE_ISO8601, $eventdate);

    $formatted = $dt->format("m/d/Y");

    $this->_logger->err($formatted);

    return $formatted;
} 
```

这会产生正确的结果：

```
2013-04-04 15:34:56 UTC error _event_date 2013-04-04T19:30:00-0400
2013-04-04 15:34:56 UTC error _event_date 04/04/2013
2013-04-04 15:34:56 UTC error _event_date 2013-04-05T21:00:00-0400
2013-04-04 15:34:56 UTC error _event_date 04/05/2013
2013-04-04 15:34:56 UTC error _event_date 2013-04-12T20:00:00-0400
2013-04-04 15:34:56 UTC error _event_date 04/12/2013
2013-04-04 15:34:56 UTC error _event_date 2013-04-16T18:00:00-0400
2013-04-04 15:34:56 UTC error _event_date 04/16/2013
2013-04-04 15:34:56 UTC error _event_date 2013-04-17T19:30:00-0400
2013-04-04 15:34:56 UTC error _event_date 04/17/2013
2013-04-04 15:34:56 UTC error _event_date 2013-04-18T20:00:00-0400
2013-04-04 15:34:56 UTC error _event_date 04/18/2013 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T15:30:37.260

createFromFormat 是静态方法，试试

```
$date = DateTime::createFromFormat(DATE_ISO8601, $eventdate); 
```

反而。

它返回一个 DateTime 对象，您没有捕获该对象，所以是的，您正在“记住”先前设置的日期，恰好是“现在”，因为您没有将日期作为构造函数参数传递。

# c++ - findHomography 返回的 mask 参数的值代表什么？

> ID：15815304
> 
> 赞同：12
> 
> 时间：2013-04-04T15:21:13.540
> 
> 标签：c++, opencv, computer-vision, homography, ransac

我将`findHomography`OpenCV 的功能与 RANSAC 方法一起使用，以找到将与一组关键点链接的两个图像相关联的单应性。

主要问题是我无法在任何地方找到函数输出的掩码矩阵的值。

我知道的唯一信息是 0 值是异常值，非零值是异常值。但这意味着内部值是什么？有人知道吗？

我调用的一段代码`findHomography`：

```
cv::Mat H12;
cv::Mat mask;

H12 = cv::findHomography(FvPointsIm1, FvPointsIm2, mask, CV_RANSAC, 5); 
ui->Debug_Label->setText(Mat2QString(mask)); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-04T16:25:52.897

返回的掩码`findHomography`是一个 8 位的单通道`cv::Mat`（或者`std::vector<uchar>`，如果您愿意），包含`0`或`1`指示异常值状态。

**编辑：**您通过调用访问掩码的每个元素`.at<double>`，这会导致输出混乱。您应该使用`.at<uchar>`，它将正确解释矩阵值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-26T08:12:25.957

我在应用关键点匹配后使用了*findHomography*方法。

*   **内点** 是匹配的关键点，计算为真阳性（正确匹配）；
*   **异常值** 是被计算为误报（错误匹配）的匹配关键点。

然后，您可以使用掩码输出从所有匹配项中提取正确匹配项的子集。

*   Python 3.6 & OpenCV 3.4.1 中有一个例子：

    ```
    good_kp = [gray_kp[m.queryIdx].pt for m in good_matches]
    correct_matched_kp = [good_kp[i] for i in range(len(good_kp)) if mask[i]] 
    ```

# c# - DataGridView 中没有重复项

> ID：15815307
> 
> 赞同：3
> 
> 时间：2013-04-04T15:21:15.357
> 
> 标签：c#, datagridview, rows, multiple-columns, cells

我正在使用 C# 在 DataGridView 中显示一些数据，我希望它不允许您添加重复的键。现在，我的 DataGridview 非常简单，只有 2 列。一个称为“Key”，另一个称为“Value”。我想要的是，当用户编辑或向 DataGridView 添加新条目时，它会检查是否已经存在重复项并取消新行的编辑/创建。这是我当前的代码：

```
private void dataGridView1_CellEndEdit(object sender, DataGridViewCellEventArgs e)
{
    foreach (DataGridViewRow row in dataGridView1.Rows)
    {
        if (row.Cells[0].Value.Equals(dataGridView1.Rows[e.RowIndex].Cells[0].Value))
        {
            dataGridView1.Rows.Remove(dataGridView1.Rows[e.RowIndex]);
            break;
        }
    }

    refresh();
} 
```

它根本不起作用......有人可以告诉我我应该怎么做吗？..谢谢！

编辑：我在 dataGridView1.Rows.Remove() 调用中也遇到了这个错误-

```
Operation is not valid because it results in a reentrant call to the  SetCurrentCellAddressCore function. 
```

编辑：

DataGridView 看起来像这样

```
Key     | Value 
----------------
blah    | something 
somekey | somevalue 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:29:29.243

这可能是您的`foreach`循环，它不允许删除行。

尝试这样的事情：

```
private void dgv_CellEndEdit(object sender, DataGridViewCellEventArgs e) {
  for (int i = 0; i < DataGridView1.Rows.Count; i++) {
    DataGridViewRow row = DataGridView1.Rows[i];
    if (row.Cells[0].Value == DataGridView1.Rows[e.RowIndex].Cells[0].Value) {
      DataGridView1.Rows.RemoveAt(e.RowIndex);
      DataGridView1.FirstDisplayedScrollingRowIndex = i;
      return;
    }
  }
} 
```

不过，我不允许行编辑，所以我可能是错的。

**编辑：**只是一个快速的编辑。我将设置`FirstDisplayedScrollingRowIndex`为`e.RowIndex`，但该行将被删除！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:59:44.240

我只是在猜测，但我已经尝试了您的代码并且我看到了一个逻辑错误：如果您调试它，您会看到使用 foreach 循环您将需要点击您刚刚编辑的元素，这显然等于本身。

我建议您将循环更改为 for 或检查行索引是否相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-24T05:12:06.677

尝试使用此代码，

```
protected void GV_RowCommand(object sender, GridViewCommandEventArgs e)
{
     DataTable dt1 = ViewState["dt"] as DataTable;
     if (e.CommandName == "Add")
     {
DataRow dr;
          dr = dt1.NewRow();
dr["DED_Id"] = Material_Id;
          dr["DED_Name"] = Material;
          dt1.Rows.Add(dr);
          dt1.AcceptChanges();
          ViewState["dt"] = dt1;
     }
} 
```

# php - 使用 imagemagick (PHP) 压缩图像时图像变为粉红色

> ID：15815309
> 
> 赞同：1
> 
> 时间：2013-04-04T15:21:17.827
> 
> 标签：php, imagemagick

在 PHP 上使用 imagemagick 压缩图像时，结果变为粉红色。

```
$im = new Imagick();

$imgsrc = file_get_contents( $imgFilepathIn );
$im->readImageBlob($imgsrc);    

$im->setImageColorspace(255);
$im->setImageCompression(Imagick::COMPRESSION_JPEG);
$im->setImageCompressionQuality(90);    

$im->setImageFormat('jpeg');                
$im->writeImage( $imgFilepathOut ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:21:17.827

问题是 jpg 的默认透明度颜色（粉红色）。

我们可以通过显式设置新的透明度/背景颜色来克服这个问题。

```
$im->setBackgroundColor(new ImagickPixel('transparent')); 
```

它也似乎

```
$im->setImageColorspace(255); 
```

有时会产生问题

# ruby - elsif 部分中的空条件

> ID：15815316
> 
> 赞同：3
> 
> 时间：2013-04-04T15:21:28.353
> 
> 标签：ruby

如果表达式为空，您能解释一下在“elsif”中使用 ruby​​ 的表达式是什么吗？

```
arg = 3
if (arg == 1)
  puts "1"
elsif (arg == 2)
  puts "2"
elsif
  puts "3"
end

p (1...10).map { |i|
  if (i == 1)
    1
  elsif (i == 2)
    2
  elsif
    3
  end
} 
```

脚本输出：

```
3
[1, 2, nil, nil, nil, nil, nil, nil, nil] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:29:02.497

基本上还有很多话要说：

在分支中，只要找到任何匹配条件，块`if-else`就返回匹配子句的最后一条语句。`if-else`考虑以下：

```
arg = 4
p m = if (arg == 1)
   "1"
elsif (arg == 3)
   "3"
elsif (arg ==4)
   "5";"11"
elsif
   "3"
end 
```

*输出：*

```
#11 
```

但是在与每个子句匹配期间，如果找到任何裸子`elsif`，则`if-else`块检查其直接表达式的真值并相应地返回值：

```
arg = "4"
p m = if (arg == "1")
   47
elsif 
   10 ; "7" 
elsif (arg =="5")
   12;14
elsif
   2
end 
```

***输出：***

```
#"7" 
```

下面的代码将`nil`作为无返回`10`值作为条件检查返回，之后代码中没有任何内容。所以`nil`被退回了。

```
arg = "4"
p m = if (arg == "1")
   47
elsif 
   10 
elsif (arg =="5")
   12;14
elsif
   2
end  #nil 
```

下面的另一个代码使事情最终变得清晰：

```
arg = "4"
p m = if (arg == "1")
   47
elsif 
   nil 
elsif (arg =="5")
   12;14
elsif
   2 ; "44"
end  #44 
```

综上所述，我希望上面的原因很清楚 - 下面的代码输出：`[1, 2, nil, nil, nil, nil, nil, nil, nil]`

```
p (1...10).map { |i|
  if (i == 1)
    1
  elsif (i == 2)
    2
  elsif
    3
  end
} 
```

要回答您的第一个代码，请先查看以下两个代码：

```
m = if puts "hi"
p "hello"
end #"hi" 
```

“hi”作为`puts`返回值打印`nil`在哪个`if`子句上，`false`因此`hello`不会打印。但是下面的代码按照`p`那里使用的方式执行，并且`if`子句在`p`返回值上执行，即`true`.

```
m = if p "hi"
p "hello"
end 

#"hi"
#"hello" 
```

现在希望您理解为什么`3`从下面的代码输出，从以上所有逻辑作为一个整体应用：

```
arg = 3
if (arg == 1)
  puts "1"
elsif (arg == 2)
  puts "2"
elsif
  puts "3"
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T16:37:59.843

如果同一行没有表达式，则将下一行的表达式用作条件。你不能有一个空的表达式。

您的第一个示例等效于：

```
arg = 3
if (arg == 1)
  puts "1"
elsif (arg == 2)
  puts "2"
elsif puts "3" # puts is the condition
  #empty
end 
```

第一个或第二个条件都不是真的，因为[`puts`返回`nil`](http://ruby-doc.org/core-2.0/Kernel.html#method-i-puts)也不是最后一个。但是`puts`在返回之前打印它的参数`nil`，所以你仍然可以`3`在输出中看到。

同样，您的第二个示例等效于：

```
p (1...10).map { |i|
  if (i == 1)
    1
  elsif (i == 2)
    2
  elsif 3
    nil #nil is the default if no result is specified
  end
} 
```

由于在 Ruby 中任何不是`false`或`nil`评估为`true`条件的东西，最后一个`elsif`总是评估为 true （`3`不是 false 或 nil），并且有效地表现得像一个 plain `else`。`nil`如果未指定任何内容，则返回的默认值也是如此，因此您会`nil`在结果中看到 s 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T16:21:45.470

假设您的意思是您想知道您正在迭代的元素是否为空白，而不是因为与以前的评估不匹配而失败：

```
elsif i.blank? 
```

如果你想要一个包罗万象的，那么只需使用：

```
else 
```

# asp.net-web-api - 将对象作为参数传递给 Breeze 控制器动作

> ID：15815319
> 
> 赞同：6
> 
> 时间：2013-04-04T15:21:43.487
> 
> 标签：asp.net-web-api, breeze

我试图通过 Breeze 发送一个对象作为参数但没有成功。

使用以下代码，我可以发送一个原始类型：

客户：

```
var query = EntityQuery
    .from('account/authenticate')
    .withParameters({ loginRequest: "hello" }); 
```

服务器：

```
[BreezeController]
public class AccountController : ApiController
{
    [HttpGet]
    public LoginResult Authenticate(string loginRequest)
    {
        // String for loginRequest received successfully
    }
} 
```

但是，如果我尝试向上传递一个复杂类型，则参数始终为空：

客户：

```
var loginRequest = { userName: 'me', password: 'pass' };

var query = EntityQuery
    .from('account/authenticate')
    .withParameters({ loginRequest: loginRequest }); 
```

服务器：

```
[BreezeController]
public class AccountController : ApiController
{
    [HttpGet]
    public LoginResult Authenticate(LoginRequest loginRequest)
    {
        // Object for loginRequest always null
    }
} 
```

我相信这部分是因为 Breeze 总是使用 GET 进行查询。POST 可能会正确处理序列化，但我在 Breeze API 中看不到任何强制 POST 的方法。

如果我传递对象的 JSON 字符串表示，我可以在服务器端获取它，但这需要手动反序列化。我意识到我可以通过标准的 WebAPI 调用在 Breeze 之外执行此操作，但我试图让我的所有服务器端调用都通过同一管道运行。

是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-11T11:49:23.447

您可能缺少 [FromUri] 属性。任何时候我试图传递一个更复杂的对象或一组参数，在我添加该属性之前，一切都会返回为空。

```
[BreezeController]
public class AccountController : ApiController
{
    [HttpGet]
    public LoginResult Authenticate([FromUri] LoginRequest loginRequest)
    {
        // Object for loginRequest always null
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T17:08:24.107

为什么不使用 ->

```
var loginRequest = { userName: 'me', password: 'pass' };

var query = EntityQuery
   .from('account/authenticate')
   .withParameters( loginRequest); 
```

代替

```
var loginRequest = { userName: 'me', password: 'pass' };

var query = EntityQuery
   .from('account/authenticate')
   .withParameters({ loginRequest: loginRequest }); 
```

# html - 从现有的 html 中获取表数据

> ID：15815326
> 
> 赞同：0
> 
> 时间：2013-04-04T15:22:01.847
> 
> 标签：html, html-table

我有一个页面，其中有一个包含 5 列和几行的基本表格。每一列代表一个工作日，每一行代表菜单上的不同菜肴。我想创建一个只显示今天菜单的页面。

我对此表没有写入权限。（如果有必要我可以要求网站管理员进行一些修改）

对我来说，显示所有具有 ID="monday" 的东西似乎是合乎逻辑的，但我无法从中得到任何东西。

这是现有的表：

```
<table cellpadding="4" class="weeklymenu" width="100%">
  <tbody>
    <tr ID="day">
      <th ID="monday" scope="col" width="20%">Monday</th>
      <th ID="tuesday" scope="col" width="20%">Tuesday</th>
      <th ID="wednesday" scope="col" width="20%">Wednesday</th>
      <th ID="thursday" scope="col" width="20%">Thursday</th>
      <th ID="friday" scope="col" width="20%">Friday</th>
    </tr>
    <tr ID="date">
        <td ID="monday" class="date" width="151">08/04/2013</td>
        <td ID="tuesday" class="date" width="179">09/04/2013</td>
        <td ID="wednesday" class="date" width="144">10/04/2013</td>
        <td ID="thursday" class="date" width="141">11/04/2013</td>
        <td ID="friday" class="date" width="152">12/04/2013</td>
    </tr>
      <tr ID="first">
          <td class="piatti" colspan="5" width="779">
              <strong>First dish / Primi</strong>
          </td>
      </tr>
      <tr ID="first">
          <td ID="monday" height="27" width="151">Riso in bianco</td>
          <td ID="tuesday" height="27" width="179">Pancetta piacentina</td>
          <td ID="wednesday" height="27" width="144">Riso in bianco</td>
          <td ID="thursday" height="27" width="141">Insalata russa</td>
          <td ID="friday" height="27" width="152">Riso in bianco</td>
      </tr>
      <tr ID="first">
          <td ID="monday" height="29" width="151">Zuppa d'orzo</td>
          <td ID="tuesday" height="29" width="179">Minestra di cicerchie</td>
          <td ID="wednesday" height="29" width="144">Minestra di fagioli adzuki</td>
          <td ID="thursday" height="29" width="141">Crema di sedano</td>
          <td ID="friday" height="29" width="148">Passato di legumi cpon crostini</td>
      </tr>
      <tr ID="first">
          <td ID="monday" height="48" width="151">Gnocchetti sardi broccoli e salsiccia</td>
          <td ID="tuesday" height="48" width="179">Risotto alla milanese</td>
          <td ID="wednesday" height="48" width="144">Pennette alla puttanesca</td>
          <td ID="thursday" height="48" width="141">Conchiglie tonno e capperi</td>
          <td ID="friday" height="48" width="148">Caserecce zafferano panna e speck</td>
      </tr>
      <tr ID="second">
        <td class="piatti" colspan="5" height="30" width="779">
            <strong>Second dish / Secondi</strong>
        </td>
    </tr>
    <tr ID="second">
        <td ID="monday" width="151">Controfiletto di puledro</td>
        <td ID="tuesday" width="179">Fesa di tacchino ai ferri</td>
        <td ID="wednesday" width="144">Spezzatino alla goriziana</td>
        <td ID="thursday" width="141">Verzini in umido</td>
        <td ID="friday" width="148">Vitello tonnato</td>
      </tr>
      <tr ID="second">
          <td ID="monday" height="43" width="151">Cotoletta di tofu con verdure</td>
          <td ID="tuesday" height="43" width="179">Tortino crecy</td>
          <td ID="wednesday" height="43" width="144">Mozzarella di bufala</td>
          <td ID="thursday" height="43" width="141">Ebly primaverile</td>
          <td ID="friday" height="43" width="148">Falafel con salsa tzatziki</td>
      </tr>
      <tr ID="second">
          <td ID="monday" height="52" width="151">Prosciutto crudo con melone</td>
          <td ID="tuesday" height="52" width="179">Persico del Nilo agli asparagi</td>
          <td ID="wednesday" height="52" width="144">Arrosticini di suino al forno</td>
          <td ID="thursday" height="52" width="141">Paillard di vitello alla piastra</td>
          <td ID="friday" height="52" width="148">Trancio di salmone al forno</td>
      </tr>
      <tr ID="side">
          <td class="piatti" colspan="5" height="28" width="779">
              <strong>Side dishes / Contorni</strong>
          </td>
      </tr>
      <tr ID="side">
          <td ID="monday" height="28" width="151">Patatine fritte</td>
          <td ID="tuesday" height="28" width="179">Patate prezzemolate</td>
          <td ID="wednesday" height="28" width="144">Purè di patate</td>
          <td ID="thursday" height="28" width="141">Patate al rosmarino</td>
          <td ID="friday" height="28" width="148">Patate al naturale</td>
      </tr>
      <tr ID="side">
          <td ID="monday" height="28" width="151">Cavolfiori alla parmigiana</td>
          <td ID="tuesday" height="28" width="179">Pomodori alla provenzale</td>
          <td ID="wednesday" height="28" width="144">Piselli alla francese</td>
          <td ID="thursday" height="28" width="141">Melanzane alla positana</td>
          <td ID="friday" height="28" width="148">Fagiolini all'olio</td>
      </tr>
      <tr ID="desert">
          <td class="piatti" colspan="5" height="28" width="779">
              <strong>Dessert / Dolci</strong>
          </td>
      </tr>
      <tr ID="desert">
          <td ID="monday" height="31" width="151">Crostatine al limone</td>
          <td ID="tuesday" height="31" width="179"> Budino</td>
          <td ID="wednesday" height="31" width="144">Macedonia</td>
          <td ID="thursday" height="31" width="141">Profitterol al cioccolato</td>
          <td ID="friday" height="31" width="148">Fragole</td>
      </tr>
      <tr ID="desert">
          <td ID="monday" width="151"/>
          <td ID="tuesday" width="179"> </td>
          <td ID="wednesday" width="144"> </td>
          <td ID="thursday" width="141"> </td>
          <td ID="friday" width="152"> </td>
      </tr>
      <tr ID="ingredients">
          <td ID="monday" class="date" width="151">Ingredients</td>
          <td ID="tuesday" class="date" width="179">Ingredients</td>
          <td ID="wednesday" class="date" width="144">Ingredients</td>
          <td ID="thursday" class="date" width="141">Ingredients</td>
          <td ID="friday" class="date" width="152">Ingredients</td>
    </tr>
  </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:36:19.387

我修改了您的表以包含类并将表修剪为只有两行并使用 jquery 进行操作。

这是html

```
 <table> 
  <tbody>
    <tr ID="day">
      <th class="monday" scope="col" width="20%">Monday</th>
      <th class="tuesday" scope="col" width="20%">Tuesday</th>
      <th class="wednesday" scope="col" width="20%">Wednesday</th>
      <th class="thursday" scope="col" width="20%">Thursday</th>
      <th class="friday" scope="col" width="20%">Friday</th>
    </tr>
    <tr ID="date">
        <td class="monday" class="date" width="151">08/04/2013</td>
        <td class="tuesday" class="date" width="179">09/04/2013</td>
        <td class="wednesday" class="date" width="144">10/04/2013</td>
        <td class="thursday" class="date" width="141">11/04/2013</td>
        <td class="friday" class="date" width="152">12/04/2013</td>
    </tr>
  </tbody>
</table> 
```

这是我用来获取数据的 JavaScript。你可以使用多个条件做任何你想做的事情

```
var data = '';
$('.monday').each( function() {
    data += $(this).html();
});
alert(data); 
```

小提琴的链接是 [http://jsfiddle.net/f2sTT/1/](http://jsfiddle.net/f2sTT/1/)

# android - 无法将自定义选择器添加到 ListView

> ID：15815328
> 
> 赞同：1
> 
> 时间：2013-04-04T15:22:07.020
> 
> 标签：android, android-layout, android-listview, android-selector

所以，我有一个`ListFragment`带有自定义布局的自定义布局，它有一个`CursorAdapter`将自定义视图传递给`ListView`. 其`ListView`选择模式设置为`MultiChoiceModal`。但是，无论我是在正常模式下选择一个项目还是在操作模式下选择几个项目，所选项目都不会突出显示。为了解决这个问题，我尝试了一个选择器。

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:color="@android:color/holo_blue_dark"
        android:state_pressed="true" />
    <item android:color="@android:color/holo_blue_light"
        android:state_checked="true" />
    <item android:color="@android:color/holo_blue_bright"
        android:state_selected="true" />
</selector> 
```

但是，将其应用于`ListView`列表`List Selector`只会导致应用程序崩溃，并且当我尝试运行它时会出现此错误：

```
04-04 15:01:41.196: E/AndroidRuntime(849): FATAL EXCEPTION: main
04-04 15:01:41.196: E/AndroidRuntime(849): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.mowdowndevelopments.vault/com.mowdowndevelopments.vault.AccountListActivity}: android.view.InflateException: Binary XML file line #9: Error inflating class android.widget.ListView
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.os.Looper.loop(Looper.java:137)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.ActivityThread.main(ActivityThread.java:5041)
04-04 15:01:41.196: E/AndroidRuntime(849):  at java.lang.reflect.Method.invokeNative(Native Method)
04-04 15:01:41.196: E/AndroidRuntime(849):  at java.lang.reflect.Method.invoke(Method.java:511)
04-04 15:01:41.196: E/AndroidRuntime(849):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-04 15:01:41.196: E/AndroidRuntime(849):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-04 15:01:41.196: E/AndroidRuntime(849):  at dalvik.system.NativeStart.main(Native Method)
04-04 15:01:41.196: E/AndroidRuntime(849): Caused by: android.view.InflateException: Binary XML file line #9: Error inflating class android.widget.ListView
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.createView(LayoutInflater.java:613)
04-04 15:01:41.196: E/AndroidRuntime(849):  at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.onCreateView(LayoutInflater.java:660)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:685)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
04-04 15:01:41.196: E/AndroidRuntime(849):  at com.mowdowndevelopments.vault.AccountListFragment.onCreateView(AccountListFragment.java:121)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.Fragment.performCreateView(Fragment.java:1695)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:861)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:1035)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.FragmentManagerImpl.addFragment(FragmentManager.java:1137)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.Activity.onCreateView(Activity.java:4717)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:680)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.inflate(LayoutInflater.java:466)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
04-04 15:01:41.196: E/AndroidRuntime(849):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:270)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.Activity.setContentView(Activity.java:1881)
04-04 15:01:41.196: E/AndroidRuntime(849):  at com.mowdowndevelopments.vault.AccountListActivity.onCreate(AccountListActivity.java:45)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.Activity.performCreate(Activity.java:5104)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
04-04 15:01:41.196: E/AndroidRuntime(849):  ... 11 more
04-04 15:01:41.196: E/AndroidRuntime(849): Caused by: java.lang.reflect.InvocationTargetException
04-04 15:01:41.196: E/AndroidRuntime(849):  at java.lang.reflect.Constructor.constructNative(Native Method)
04-04 15:01:41.196: E/AndroidRuntime(849):  at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.view.LayoutInflater.createView(LayoutInflater.java:587)
04-04 15:01:41.196: E/AndroidRuntime(849):  ... 33 more
04-04 15:01:41.196: E/AndroidRuntime(849): Caused by: android.content.res.Resources$NotFoundException: File res/color/view_selector_background.xml from drawable resource ID #0x7f0a0000
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.content.res.Resources.loadDrawable(Resources.java:1953)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.widget.AbsListView.<init>(AbsListView.java:772)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.widget.ListView.<init>(ListView.java:143)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.widget.ListView.<init>(ListView.java:139)
04-04 15:01:41.196: E/AndroidRuntime(849):  ... 36 more
04-04 15:01:41.196: E/AndroidRuntime(849): Caused by: org.xmlpull.v1.XmlPullParserException: Binary XML file line #4: <item> tag requires a 'drawable' attribute or child tag defining a drawable
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.graphics.drawable.StateListDrawable.inflate(StateListDrawable.java:178)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.graphics.drawable.Drawable.createFromXmlInner(Drawable.java:885)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.graphics.drawable.Drawable.createFromXml(Drawable.java:822)
04-04 15:01:41.196: E/AndroidRuntime(849):  at android.content.res.Resources.loadDrawable(Resources.java:1950)
04-04 15:01:41.196: E/AndroidRuntime(849):  ... 40 more 
```

它还会导致 Eclipse 抱怨：

```
org.xmlpull.v1.XmlPullParserException: Binary XML file line #3: <item> tag requires a 'drawable' attribute or child tag defining a drawable
    at android.graphics.drawable.StateListDrawable.inflate(StateListDrawable.java:178)
    at android.graphics.drawable.Drawable.createFromXmlInner(Drawable.java:885)
    at android.graphics.drawable.Drawable.createFromXml(Drawable.java:822)
    at com.android.layoutlib.bridge.impl.ResourceHelper.getDrawable(ResourceHelper.java:208)
    at android.content.res.BridgeTypedArray.getDrawable(BridgeTypedArray.java:782)
    at android.view.View.<init>(View.java:3330)
    at android.view.View.<init>(View.java:3259)
    at android.view.ViewGroup.<init>(ViewGroup.java:425)
    at android.widget.RelativeLayout.<init>(RelativeLayout.java:210)
    at sun.reflect.GeneratedConstructorAccessor64.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at android.view.LayoutInflater.createView(LayoutInflater.java:587)
    at android.view.BridgeInflater.onCreateView(BridgeInflater.java:86)
    at android.view.LayoutInflater.onCreateView(LayoutInflater.java:660)
    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:685)
    at android.view.BridgeInflater.createViewFromTag(BridgeInflater.java:131)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:466)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:372)
    at com.android.layoutlib.bridge.impl.RenderSessionImpl.inflate(RenderSessionImpl.java:385)
    at com.android.layoutlib.bridge.Bridge.createSession(Bridge.java:332)
    at com.android.ide.common.rendering.LayoutLibrary.createSession(LayoutLibrary.java:325)
    at com.android.ide.eclipse.adt.internal.editors.layout.gle2.RenderService.createRenderSession(RenderService.java:440)
    at com.android.ide.eclipse.adt.internal.editors.layout.gle2.RenderPreview.renderSync(RenderPreview.java:560)
    at com.android.ide.eclipse.adt.internal.editors.layout.gle2.RenderPreview.access$5(RenderPreview.java:506)
    at com.android.ide.eclipse.adt.internal.editors.layout.gle2.RenderPreview$RenderJob.runInUIThread(RenderPreview.java:1230)
    at org.eclipse.ui.progress.UIJob$1.run(UIJob.java:95)
    at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)
    at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)
    at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3529)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3182)
    at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2701)
    at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2665)
    at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2499)
    at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:679)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:668)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1438)
    at org.eclipse.equinox.launcher.Main.main(Main.java:1414) 
```

在将选择器应用于自定义视图的根布局（特别是作为背景）时，我从 Eclipse 得到了同样的抱怨，所以逻辑表明我会得到类似的错误。有什么我做错了吗？

**编辑：**嗯，多亏了 vArDo，没有更多的崩溃。但是选择器实际上并没有做任何事情。这是列表项布局的 xml，对于那些可能可以看到如何真正开始工作的人：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/itemLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/NameView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="Name"
        android:textAppearance="?android:attr/textAppearanceLarge"
        tools:ignore="HardcodedText" />

    <TextView
        android:id="@+id/balanceView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/NameView"
        android:text="Balance"
        android:textAppearance="?android:attr/textAppearanceSmall"
        tools:ignore="HardcodedText" />

    <ImageView
        android:id="@+id/favStar"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:layout_marginRight="10dp"
        android:layout_marginTop="10dp"
        android:contentDescription="@string/accessFav"
        android:src="@android:drawable/btn_star_big_on"
        android:visibility="gone" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T20:15:43.757

需要成为可`ListView`绘制*对象*（[请参阅文档](https://developer.android.com/reference/android/widget/AbsListView.html#attr_android%3alistSelector)），因此您的 XML 文件中的每个标签都必须包含在其中。只需更改为（您可以使用相同的值），您当前的错误就会消失。`android:listSelector`*`item``selector``android:drawable``android:color``android:drawable`*

 *替换后的文件应如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@android:color/holo_blue_dark"
        android:state_pressed="true" />
    <item android:drawable="@android:color/holo_blue_light"
        android:state_checked="true" />
    <item android:drawable="@android:color/holo_blue_bright"
        android:state_selected="true" />
</selector> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T23:42:35.203

好吧，显然我应该更频繁地挖掘源代码。我最终做的是采用列表项的根布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/itemLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent" > 
```

并添加了一个属性：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/itemLayout"
    android:background="?android:attr/activatedBackgroundIndicator"
    android:layout_width="match_parent"
    android:layout_height="match_parent" > 
```

这增加了在`android.R.layout.simple_list_item_activated_1`等人中看到的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T19:49:29.073

一种替代但更长的方法是在方法中手动设置 listView 项目的背景颜色`getView()`。

```
class CustomAdapter extends BaseAdapter{
...

int selectedID;

public void setSelectedId(int n)
{
selectedID = n;
}

public View getView(int position, View convertView, ViewGroup parent) {
....
if(position == selectedID)
convertView.setBackgroundColor(someColor);
return convertView;
} 
```

在 listView 中`OnItemClickListener`，添加：

```
customAdapter.setSelectedId(position) 
```

虽然这种方法效率不高，但它在我的项目中运行良好。此外，避免使用静态 ViewHolder 类或使用这种方法回收视图。*

# java - Java 匿名类

> ID：15815332
> 
> 赞同：1
> 
> 时间：2013-04-04T15:22:20.413
> 
> 标签：java

我对 Java 中的匿名类有点迷茫，我已经阅读过它们，但是我该如何使用这个类：

```
private abstract class CustomRectangle {
    protected final int width;
    protected final int height;
    protected final int xOffset;
    protected final int yOffset;
    protected final int borderSize;

    public CustomRectangle(final int width, final int height, final int xOffset, final int yOffset, final int borderSize) {
        this.width = width;
        this.height = height;
        this.xOffset = xOffset;
        this.yOffset = yOffset;
        this.borderSize = borderSize;
    }

    abstract void inBorder(final int dx, final int dy);

    abstract void outBorder(final int dx, final int dy);

    public void draw(Graphics2D g2d) {
        for (int x = 0; x < width; x++) {
            for (int y = 0; y < height; y++) {
                int dx = Math.min(x, width - 1 - x);
                int dy = Math.min(y, height - 1 - y);
                if (dx < borderSize || dy < borderSize) {
                    inBorder(dx, dy);
                }
                else {
                    outBorder(dx, dy);
                }
                g2d.drawLine(x + xOffset, y + yOffset, x + xOffset, y + yOffset);
            }
        }
    }
} 
```

在另一种方法中同时执行以下操作：

1.  扩展 CustomRectangle 以覆盖 InBorder() 和 outBorder()
2.  通过调用 draw() 方法绘制新的 CustomRectangle。

必须有一种简单的方法来做到这一点，而且我不想每次我想绘制一个 CustomRectangle 时都制作大量的类。

帮助表示赞赏:)

**编辑包括解决方案：**

```
 new CustomRectangle(CARD_DIMENSION.width, CARD_DIMENSION.height, 0, 0, 5) {
        @Override
        public void inBorder(final int dx, final int dy) {
            g2d.setColor(new Color(red, green, blue, 255 - Math.min(dx, dy)));
        }

        @Override
        public void outBorder(final int dx, final int dy) {
            g2d.setColor(new Color(red, green, blue, 192 - Math.min(dx, dy)));
        }
    }.draw(g2d); 
```

也许它看起来不那么漂亮，但它在我的应用程序设计中非常方便。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T15:24:42.650

匿名类扩展的语法`CustomRectangle`是：

```
CustomRectangle r = new CustomRectangle() {
    @Override
    public void inBorder(final int dx, final int dy) {
        // implementation
    }
    @Override
    public void outBorder(final int dx, final int dy) {
        // implementation
    }
} 
```

避免使用这些匿名类的另一种方法是使用辅助对象参数化您的矩形类以实现`inBorder`和`outBorder`。那么矩形类就不必是抽象的；相反，它将实现委托给辅助对象（可以在构造时或通过设置器提供）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:27:23.187

您可以通过在需要类的实例时简单地定义所需的函数来使用匿名类扩展这个抽象类。它看起来像这样：

```
CustomRectangle rect = new CustomRectangle() {
    @Override
    public void inBorder(final int dx, final int dy) {
        // Your implementation here.
    }
    @Override
    public void outBorder(final int dx, final int dy) {
        // Your implementation here.
    }
} 
```

然后你可以简单地调用`rect.draw()`或任何你需要的东西——它是一个像任何其他对象一样的对象。

# php - spl_autoload_register、SessionHandlerInterface 和 PHPUnit 的问题

> ID：15815342
> 
> 赞同：0
> 
> 时间：2013-04-04T15:22:55.417
> 
> 标签：php, phpunit, spl-autoload-register

我有一个非常简单的类的小单元测试。这是我要测试的课程：

```
<?php
namespace MyApp\sys;

class Auth
{
    // ...

    public static function getInstance()
    {
    if(!isset(self::$_instance))
        self::$_instance = new Auth();

    return self::$_instance;
    }

    public function authenticate($sMethod, $sData, $sAuth)
    {
        // ...
        return $this->authSession();
    }

    public function authSession()
    {
        // ...
        $oHandler = new SessionHandler();
    }
} 
```

这是 SessionHandler 类：

```
<?php

namespace MyApp\sys;

class SessionHandler implements \SessionHandlerInterface
{
    public function open($sSavePath, $sSessionId)
    {
        // ...
    }

    public function close()
    {
        // ...
    }

    public function read($sSessionId)
    {
        // ...
    }

    public function write($sSessionId, $sSessionData)
    {
        // ...
    }

    public function destroy($sSessionId)
    {
        // ...
    }

    public function gc($iMaxLifetime)
    {
        // ...
    }
} 
```

这是简单的单元测试：

```
<?php
namespace Test\MyApp\sys;

use PHPUnit_Framework_TestCase;

class AuthTest extends PHPUnit_Framework_TestCase
{
    protected function setUp()
    {
        parent::setUp();
    }

    protected function tearDown()
    {
        parent::tearDown();
    }

    public function testGetInstance()
    {
        $oAuth = \MyApp\sys\Auth::getInstance();
        $this->assertInstanceOf('\MyApp\sys\Auth', $oAuth);

        return $oAuth;
    }

    /**
     * @depends testGetInstance
     */
    public function testAuthenticate(\MyApp\sys\Auth $oAuth)
    {
        $res = $oAuth->authenticate(null, null, null);
    }
} 
```

我有以下 phpunit.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<phpunit
    bootstrap="bootstrap.php"
    convertErrorsToExceptions="true"
    convertNoticesToExceptions="true"
    convertWarningsToExceptions="true"
    stopOnError="true"
    stopOnFailure="true"
    strict="false"
    verbose="true">
    <testsuites>
        <testsuite name="Authentication">
            <directory suffix="Test.php">
                ./MyApp/sys/
            </directory>
        </testsuite>
    </testsuites>
</phpunit> 
```

...以及以下 bootstrap.php 文件：

```
<?php
define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../'));
define('APPLICATION_TEST_PATH', realpath(dirname(__FILE__)));

spl_autoload_register(function($sClas) {
    $nClass = str_replace("\\", "/", $sClas);
    require_once APPLICATION_PATH . '/' . $nClass . ".php";
}); 
```

目录结构是这样的：

```
- MyProject/
   - MyApp/
      - sys/
         . Auth.php
         . SessionHandler.php
   - Test/
      - MyApp/
         - sys/
            . AuthTest.php
      . bootstrap.php
      . phpunit.xml 
```

这就是我尝试从命令行运行这个小单元测试的方式（以及我得到的结果）：

```
# phpunit MyApp/sys/AuthTest.php 
PHPUnit 3.7.19 by Sebastian Bergmann.

Configuration read from /Users/pmpro/Code/Snevens/MyProject/Tests/phpunit.xml

.PHP Fatal error:  {closure}(): Failed opening required '/Users/pmpro/Code/Snevens/MyProject/SessionHandlerInterface.php' (include_path='.:/usr/share/pear') in /Users/pmpro/Code/Snevens/MyProject/Tests/bootstrap.php on line 7

Fatal error: {closure}(): Failed opening required '/Users/pmpro/Code/Snevens/MyProject/SessionHandlerInterface.php' (include_path='.:/usr/share/pear') in /Users/pmpro/Code/Snevens/MyProject/Tests/bootstrap.php on line 7 
```

我认为这将是注册的自动加载功能的问题，所以我决定跳过类自动加载，以防它是 SessionHandlerInterface 只是为了看看会发生什么：

```
spl_autoload_register(function($sClas) {
    if("SessionHandlerInterface" == $sClas)
        return;

    $nClass = str_replace("\\", "/", $sClas);
    require_once APPLICATION_PATH . '/' . $nClass . ".php";
}); 
```

这就是结果：

```
# phpunit MyApp/sys/AuthTest.php 
PHPUnit 3.7.19 by Sebastian Bergmann.

Configuration read from /Users/pmpro/Code/Snevens/MyProject/Tests/phpunit.xml

.PHP Fatal error:  Interface 'SessionHandlerInterface' not found in /Users/pmpro/Code/Snevens/MyProject/MyApp/sys/SessionHandler.php on line 9

Fatal error: Interface 'SessionHandlerInterface' not found in /Users/pmpro/Code/Snevens/MyProject/MyApp/sys/SessionHandler.php on line 9 
```

如果我直接从命令行调用 SessionHandler.php，它不会返回错误：

```
# php SessionHandler.php
(returns nothing) 
```

**我做错了什么或我错过了什么？**

这只发生在*SessionHandlerInterface*上。例如，我尝试只运行*testGetInstance*，使*Auth*类实现*ArrayAccess*，它根本没有抱怨。如果我让*Auth*类实现*SessionHandlerInterface*它会立即抱怨。

我正在运行 PHP 5.4.13 和 PHP Unit 3.7.19

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T09:47:23.580

好的，所以这是一个与 phpunit 脚本中引用的 PHP 版本相关的愚蠢问题。在 /usr/bin/phpunit 的顶部，路径是指 PHP 5.3.*，它显然不支持 SessionHandlerInterface。所以我只需要将该路径更改为正确的 PHP 版本，现在就可以使用了。

# css - 第一个表格列的 CSS 样式，但该列的第一个单元格除外

> ID：15815350
> 
> 赞同：0
> 
> 时间：2013-04-04T15:23:09.637
> 
> 标签：css, css-selectors, html-table, fixed-width

所以这里是`<table>`：

```
<table class='census'>
    <tr>
        <th colspan="2">My Title</th>
    </tr>
    <tr>
        <td colspan="2" class='chart'><SOME PIE CHART, GENERATED WITH JS></td>
    </tr>
    <tr>
        <td>Some title</td>
        <td>Some Data</td>
    </tr>
    <tr>
        <td>Some title</td>
        <td>Some Data</td>
    </tr>
    <tr>
        <td>Some title</td>
        <td>Some Data</td>
    </tr>
    <tr>
        <td>Some title</td>
        <td>Some Data</td>
    </tr>
    <tr>
        <td>Some title</td>
        <td>Some Data</td>
    </tr>
</table> 
```

我需要为第一列设置固定宽度。这很容易做到：

```
.census td:first-child {
    background-color: #F0F8FE;
    width: 250px;
} 
```

**现在的问题！** 带有 JS 饼图的固定宽度螺钉。

所以我需要对所有第一个`<td>`标签应用固定宽度，除了一个`colspan="2"`包含我的图表的标签。

如果是这样的话，我唯一能想到的（到目前为止）：

```
.census td:first-child:not(.chart) {
    background-color: #F0F8FE;
    width: 250px;
} 
```

它在所有浏览器中都给我带来了意想不到的结果。我在这一点上迷路了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T15:26:59.153

您是否可以不只是覆盖它，将图表类放在它之后，例如

```
 .census td:first-child {
        background-color: #F0F8FE;
        width: 250px;
    }

    .census td.chart {
      width: auto;
      etc...
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:27:59.953

如果您正在寻找一种跨浏览器兼容的方法，我会坚持使用 jQuery：

```
$('td:first-child:not([colspan=2])').css('width', '250px'); 
```

示例：http: [//jsfiddle.net/mZNGj/1/](http://jsfiddle.net/mZNGj/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T15:38:27.083

在我看来，这将是使用 caption/thead/tbody/tfoot 元素的好时机：

[http://jsfiddle.net/Ny6YZ/](http://jsfiddle.net/Ny6YZ/)

```
tbody td:first-child {
    width: 250px;
}

<table class='census'>
    <caption>My Title</caption>

    <thead>
        <tr>
            <td colspan="2" class='chart'>SOME PIE CHART, GENERATED WITH JS</td>
        </tr>
    </thead>

    <tbody>
        <tr>
            <td>Some title</td>
            <td>Some Data</td>
        </tr>
        <tr>
            <td>Some title</td>
            <td>Some Data</td>
        </tr>
        <tr>
            <td>Some title</td>
            <td>Some Data</td>
        </tr>
        <tr>
            <td>Some title</td>
            <td>Some Data</td>
        </tr>
        <tr>
            <td>Some title</td>
            <td>Some Data</td>
        </tr>
    </tbody>
</table> 
```

不过，饼图可能更适合 tfoot 而不是 thead。

或者，您可以在 colspanned 元素上覆盖它：

[http://jsfiddle.net/Ny6YZ/1/](http://jsfiddle.net/Ny6YZ/1/)

```
td:first-child {
    width: 250px;
}

td[colspan] {
    width: auto;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T20:25:36.633

一点点在 cimmanon 行中，（使用更多的表格布局助手）但有点不同：

我会尝试定义 cols：

```
<table class='census'>
    <col class="col1"></col>
    <col class="col2"></col>
    <thead>
        <th colspan="2">My Title</th>
    </thead>
    <tr>
        <td colspan="2" class='chart'>SOME PIE CHART, GENERATED WITH JS</td>
    </tr>
    <tr>
        <td>Some title</td>
        <td>Some Data</td>
    </tr>
    .... 
```

并在那里设置宽度：

```
.col1 {
    background-color: papayawhip;
    width: 250px;
} 
```

设置了 colspan 的 tds 不会受到 col 宽度的影响

## [演示](http://jsfiddle.net/vals/8fA8M/1/)

# java - JToolBar 防止最小化

> ID：15815351
> 
> 赞同：2
> 
> 时间：2013-04-04T15:23:12.883
> 
> 标签：java, swing, jtoolbar

JToolBar 可以从框架或面板中附加和分离到一个单独的窗口中。所以我想用它作为一组紧急命令和指示器。问题是当你最小化它所属的框架时，工具栏也会最小化，我希望它留在屏幕上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-21T12:15:50.980

```
 the toolbar also minimizes , I want for it to stay on the screen 
```

将工具栏设置为不可浮动。作为示例代码

```
JToolBar toolbar=new JToolBar();
toolbar.setFloatable(false);

...
toolbar.add(YourCompoenthere);

... 
```

它将限制工具栏与框架或面板分离。请参阅[Java 文档](http://docs.oracle.com/javase/6/docs/api/javax/swing/JToolBar.html#setFloatable%28boolean%29)和[示例](http://docs.oracle.com/javase/tutorial/uiswing/components/toolbar.html)

# solr - 使用空格、斜杠和冒号转义 LukeRequest

> ID：15815352
> 
> 赞同：0
> 
> 时间：2013-04-04T15:23:14.557
> 
> 标签：solr, solr4, luke

我正在使用 Solr 4.1。使用 LukeRequest，我想获取包含特定字段数据的文档数量。该字段的名称类似于`http://foo.org/bar/ baz`（注意和之间的空格`bar/`）`baz`。当我访问时，`http://127.0.0.1:8983/root/admin/luke`我会得到一份我所有领域的列表，包括上述领域。当我访问

`http://127.0.0.1:8983/root/admin/luke?fl=http://foo.org/bar/ baz`

我没有命中。我尝试过对字符串进行 url 编码，转义斜杠，转义冒号，转义空格，使用 + 代替空格，以及我能想到的所有可能的反斜杠组合。在 solr中的另一个 StackOverflow 问题[字段列表中发布的解决方案，其中“fl”参数用于中间有空格的字段](https://stackoverflow.com/questions/8575009/field-listing-in-solr-with-fl-parameter-for-a-field-having-space-in-between#)对我不起作用。

我真的只是在寻找是否有任何文档对这个特定字段有价值的答案，所以如果有比 LukeRequest 更好的方法来做到这一点，我也很乐意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:35:34.963

AFAIK，使用反斜杠转义特殊字符适用于值，而不适用于`fl`or之类的参数`sort`。

[lucene邮件列表上的](http://lucene.472066.n3.nabble.com/Search-on-dynamic-fields-which-contains-spaces-special-characters-tp472100p472102.html)这个答案也证实了我的想法。我猜你不应该在字段名中有空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T15:37:53.090

我相信您可以使用[TermsComponent](http://wiki.apache.org/solr/TermsComponent)完成同样的事情，因为它可以告诉您是否有任何术语与索引中的字段相关联。但是，您需要在查询中指定字段名称，因此您会遇到类似的问题。正如*Srikanth*回答的那样，您最好不要在字段名称中使用空格或特殊字符。

# android - 强制方向查看

> ID：15815353
> 
> 赞同：0
> 
> 时间：2013-04-04T15:23:15.560
> 
> 标签：android, android-view, android-orientation

对于一项活动，我有三种不同的观点。这三个视图存储在三个不同的 xml 文件中。

我知道可以使用这部分代码强制活动方向：

```
 <activity
        android:screenOrientation="portrait"
    </activity> 
```

但我想在第一个视图上有纵向方向，在另外两个视图上有横向方向。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:33:16.693

你可以看看 setRequestedOrientation(int)。设置视图后调用它。

[http://developer.android.com/reference/android/app/Activity.html#setRequestedOrientation(int)](http://developer.android.com/reference/android/app/Activity.html#setRequestedOrientation(int))

您可能想查看添加 android:configChanges="orientation"，它让 Android 知道您正在自己处理方向更改。

# jquery - JQueryui 对话框在页面中间显示白框

> ID：15815358
> 
> 赞同：1
> 
> 时间：2013-04-04T15:23:28.573
> 
> 标签：jquery, user-interface, dialog, confirmation

我有一个 css 问题，我相信当我在 IE 10 和 FireFox 19.0.2 中使用 jquery UI 对话框时，页面中间会出现一个白色矩形。希望有人能指出原因。下面是我正在使用的页面代码和 jquery，它是基本代码。

编辑：我发现它只发生在由于覆盖而在对话框对象上设置了 modal:true 时。

编辑：我解决了这个问题。将在 8 小时内更新答案。UI CSS 1.10.2 版修复了这个问题。估计我会升级。

如果有人想查看，JSFiddle 会对此进行测试[http://jsfiddle.net/9dpsA/](http://jsfiddle.net/9dpsA/)
要解决此问题，请将 UI CSS 的外部资源更改为 1.10.2 版本而不是 1.10.1。

```
<!DOCTYPE html>

  <html xmlns="http://www.w3.org/1999/xhtml">
  <head runat="server">
   <link href="../css/jquerycss/jquery-ui-1.10.1.custom.css" rel="stylesheet" />
    <script src="../JavaScript/jquery-1.9.1.min.js"></script>
    <script src="../JavaScript/jquery-ui-1.10.1.custom.min.js"></script>
    <script src="../JavaScript/jquery.blockUI.js"></script>
    <title>Site</title>

    <script>

        $(document).ready(function () {
            $('#dialog-confirm').hide();

            $("#btnArchive").click(function () {
                $('#dialog-confirm').dialog({
                    resizable: false,
                    height: "auto",
                    modal: true,
                    buttons: {
                        "Archive": function () {
                            $(this).dialog("close");
                        },
                        Cancel: function () {
                            $(this).dialog("close");
                        }
                    }
                });
            });

        });

       </script>
</head>
<body>
    <form id="form1" runat="server">

    <div id="page" style="text-align:center;">

        <div id="header">
            <h2>Site</h2>
            <asp:Button ID="btnMnu" runat="server" Text="Manage Tasks" PostBackUrl="someurl" />
            <input id="btnArchive" type="button" value="Archive Selected" />
            <asp:Button ID="btnDelete" runat="server" Text="Delete Selected" />
        </div>

        <div id="dialog-confirm" title="Archive the Selected Tasks?">
            <p>
                <span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;"></span>
                <span>Archiving will result in the deletion of the task. Are you sure you want to archive the task(s)?</span>
            </p>
        </div>

        <div id="footer">

        </div>
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T17:16:51.997

用这个替换你的 CSS：

```
<link href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" rel="stylesheet"/> 
```

**在此处查看演示**

[http://jsfiddle.net/9dpsA/1/](http://jsfiddle.net/9dpsA/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T15:51:04.517

UI CSS 1.10.2 版修复了这个问题。估计我会升级。

要解决此问题，请将 UI CSS 的外部资源更改为 1.10.2 版本而不是 1.10.1。

# c# - 如何在 kentico cms 的 CMS 桌面中添加新选项卡

> ID：15815361
> 
> 赞同：0
> 
> 时间：2013-04-04T15:23:41.353
> 
> 标签：c#, asp.net, kentico

如何在**CMSDesk** ->**内容**->**页面**
位置添加新选项卡，如下图红色部分所示。

![在此处输入图像描述](https://i.stack.imgur.com/HpSrX.png)

我试图通过在 Development -> Modules -> user interface 部分添加新元素来添加它。但没有获得本节的模块名称。

任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:23:07.437

我假设您使用的是 Kentico CMS v7。（情况在 v6 中有所不同。）

如果我理解正确，您想在“页面”选项卡下添加更多级别的选项卡。这是可能的，尽管我强烈不推荐。我宁愿通过简单地添加 UI 元素 CMSSitemanager->Development->Modules->Content->User Interface->Content->View mode->Edit 来将选项卡 NEXT 添加到 Page、Design 等。但是，如果您想回答您的问题，我会为您提供 :) 您需要自定义逻辑

```
 CMSDeskPage.GetDocumentPageUrlInternal(...) 
```

代码文件位于 CMSSolution\UIControls\Pages\CMSDesk\CMSDeskPage.cs

有一个带有大小写“编辑”的开关 - 这是确定将在“页面”选项卡下显示哪个页面的位置。您将不得不再创建一层页面（带有标签和内容的框架集）。您还必须创建 JavaScript 层以确保帧之间的正确通信。（我说的脚本是：tree.js、contenteditframeset.js、content.js、splitview.js）。

再一次 - 使用上面提到的 UI Elements 版本:)

# c# - 如何动态编译、加载和使用 C# DLL

> ID：15815363
> 
> 赞同：4
> 
> 时间：2013-04-04T15:23:44.747
> 
> 标签：c#, compilation, runtime, .net-assembly, appdomain

A) 即时编译 C# EXE 和 DLL 相对容易。
B) 执行一个 EXE 意味着一个新的应用程序正在运行。加载 DLL 意味着可以在应用程序或项目之间共享的情况下使用方法和函数。

现在，可以从[MSDN](http://msdn.microsoft.com/en-us/library/saf5ce06%28v=vs.110%29.aspx)或为了您的方便找到编译您的 EXE（或稍作修改，DLL）的最快和最简单的方法：

```
private bool CompileCSharpCode(string script)
{
lvErrors.Items.Clear();
    try
    {
        CSharpCodeProvider provider = new CSharpCodeProvider();
        // Build the parameters for source compilation.
        CompilerParameters cp = new CompilerParameters
        {
            GenerateInMemory = false,
            GenerateExecutable = false, // True = EXE, False = DLL
            IncludeDebugInformation = true,
            OutputAssembly = "eventHandler.dll", // Compilation name
        };

        // Add in our included libs.
        cp.ReferencedAssemblies.Add("System.dll");
        cp.ReferencedAssemblies.Add("System.Windows.Forms.dll");
        cp.ReferencedAssemblies.Add("Microsoft.VisualBasic.dll");

        // Invoke compilation. This works from a string, but you can also load from a file using FromFile()
        CompilerResults cr = provider.CompileAssemblyFromSource(cp, script);
        if (cr.Errors.Count > 0)
        {
            // Display compilation errors.
            foreach (CompilerError ce in cr.Errors)
            {
                //I have a listview to display errors.
                lvErrors.Items.Add(ce.ToString());
            }
            return false;
        }
        else
        {
            lvErrors.Items.Add("Compiled Successfully.");
        }
        provider.Dispose();
    }
    catch (Exception e)
    {
        // never really reached, but better safe than sorry?
        lvErrors.Items.Add("SEVERE! "+e.Message + e.StackTrace.ToString());
        return false;
    }
    return true;
} 
```

现在您可以即时编译，如何加载 DLL 之间存在一些差异。通常来说，您会将它作为参考添加到 Visual Studios 中以编译到项目中。这很简单，你可能已经做过很多次了，但是我们想在我们当前的项目中使用它，我们不能很好地要求用户每次想要测试他们的新 DLL 时都重新编译整个项目. 因此，我将简单讨论如何“动态”加载库。这里的另一个术语是“以编程方式”。为此，在成功编译后，我们加载一个程序集，如下所示：

```
Assembly assembly = Assembly.LoadFrom("yourfilenamehere.dll"); 
```

如果你有一个 AppDomain，你可以试试这个：

```
Assembly assembly = domain.Load(AssemblyName.GetAssemblyName("yourfilenamehere.dll")); 
```

现在 lib 已被“引用”，我们可以打开它并使用它。有两种方法可以做到这一点。一个要求您知道该方法是否有参数，另一个会为您检查。后面我会做，其他的你可以查看[MSDN](http://msdn.microsoft.com/en-us/library/25y1ya39.aspx)。

```
// replace with your namespace.class
Type type = assembly.GetType("company.project");
if (type != null)
{
    // replace with your function's name
    MethodInfo method = type.GetMethod("method");

    if (method != null)
    {
        object result = null;
        ParameterInfo[] parameters = method.GetParameters();
        object classInstance = Activator.CreateInstance(type, null);
        if (parameters.Length == 0) // takes no parameters
        {
                // method A:
            result = method.Invoke(classInstance, null);
                // method B:
            //result = type.InvokeMember("method", BindingFlags.InvokeMethod, null, classInstance, null);
        }
        else // takes 1+ parameters
        {
            object[] parametersArray = new object[] { }; // add parameters here

                // method A:
            result = method.Invoke(classInstance, parametersArray);
                // method B:
            //result = type.InvokeMember("method", BindingFlags.InvokeMethod, null, classInstance, parametersArray);
        }
    }
} 
```

问题：第一次编译工作正常。第一次执行工作正常。但是，重新编译尝试会出错，说明您的 *.PDP（调试器数据库）正在使用中。我听说过一些关于编组和 AppDomains 的提示，但我还没有完全解决这个问题。仅在加载 DLL 后重新编译才会失败。

* * *

编组 && AppDomain 的当前尝试：

```
class ProxyDomain : MarshalByRefObject
    {
        private object _instance;
        public object Instance
        {
            get { return _instance; }
        }
        private AppDomain _domain;
        public AppDomain Domain
        {
            get
            {
                return _domain;
            }
        }
        public void CreateDomain(string friendlyName, System.Security.Policy.Evidence securityinfo)
        {
            _domain = AppDomain.CreateDomain(friendlyName, securityinfo);
        }
        public void UnloadDomain()
        {
            try
            {
                AppDomain.Unload(_domain);
            }
            catch (ArgumentNullException dne)
            {
                // ignore null exceptions
                return;
            }
        }
        private Assembly _assembly;
        public Assembly Assembly
        {
            get
            {
                return _assembly;
            }
        }
        private byte[] loadFile(string filename)
        {
            FileStream fs = new FileStream(filename, FileMode.Open);
            byte[] buffer = new byte[(int)fs.Length];
            fs.Read(buffer, 0, buffer.Length);
            fs.Close();

            return buffer;
        }
        public void LoadAssembly(string path, string typeName)
        {
            try
            {
                if (_domain == null)
                    throw new ArgumentNullException("_domain does not exist.");
                byte[] Assembly_data = loadFile(path);
                byte[] Symbol_data = loadFile(path.Replace(".dll", ".pdb"));

                _assembly = _domain.Load(Assembly_data, Symbol_data);
                //_assembly = _domain.Load(AssemblyName.GetAssemblyName(path));
                _type = _assembly.GetType(typeName);
            }
            catch (Exception ex)
            {
                throw new InvalidOperationException(ex.ToString());
            }
        }
        private Type _type;
        public Type Type
        {
            get
            {
                return _type;
            }
        }
        public void CreateInstanceAndUnwrap(string typeName)
        {
            _instance = _domain.CreateInstanceAndUnwrap(_assembly.FullName, typeName);
        }
    } 
```

_instance = _domain.CreateInstanceAndUnwrap(_assembly.FullName, typeName); 上的错误 说我的程序集不可序列化。尝试将 [Serializable] 标签添加到我的班级，但没有成功。仍在研究修复。

当你看不到它们是如何被使用时，似乎事情会变得有点混乱，所以这里让它变得简单吗？

```
private void pictureBox1_Click(object sender, EventArgs e)
    {
        pd.UnloadDomain();

        if (CompileCSharpCode(header + tScript.Text + footer))
        {
            try
            {
                pd.CreateDomain("DLLDomain", null);
                pd.LoadAssembly("eventHandler.dll", "Events.eventHandler");
                pd.CreateInstanceAndUnwrap("Events.eventHandler"); // Assembly not Serializable error!

                /*if (pd.type != null)
                {
                    MethodInfo onConnect = pd.type.GetMethod("onConnect");

                    if (onConnect != null)
                    {
                        object result = null;
                        ParameterInfo[] parameters = onConnect.GetParameters();
                        object classInstance = Activator.CreateInstance(pd.type, null);
                        if (parameters.Length == 0)
                        {
                            result = pd.type.InvokeMember("onConnect", BindingFlags.InvokeMethod, null, classInstance, null);
                            //result = onConnect.Invoke(classInstance, null);
                        }
                        else
                        {
                            object[] parametersArray = new object[] { };

                            //result = onConnect.Invoke(classInstance, parametersArray);
                            //result = type.InvokeMember("onConnect", BindingFlags.InvokeMethod, null, classInstance, parametersArray);
                        }
                    }
                }*/
                //assembly = Assembly.LoadFrom(null);

            }
            catch (Exception er)
            {
                MessageBox.Show("There was an error executing the script.\n>" + er.Message + "\n   - " + er.StackTrace.ToString());
            }
            finally
            {
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-04T15:39:44.107

将 DLL 加载到正在运行的进程（的默认应用程序域）后，磁盘上的文件在进程终止之前不能被覆盖。DLL 不能像在非托管代码中一样在托管代码中卸载。

您需要在主机进程中创建一个新的应用程序域，并将新创建的 DLL 程序集加载到该应用程序域中。当您准备好编译新版本的 DLL 时，您可以处置 appdomain。这将从内存中卸载 DLL 并释放对 DLL 文件的锁定，以便您可以将新的 DLL 编译到同一文件。然后，您可以构建一个新的 appdomain 以将新的 DLL 加载到其中。

使用 appdomains 的主要危险是必须对跨 appdomain 边界的所有调用进行编组，很像 IPC 或网络 RPC。尽量将需要跨 appdomain 边界调用的对象的接口保持在最低限度。

您还可以将程序集编译到内存，接收字节数组或流作为输出，然后将该程序集加载到单独的应用程序域中。这样可以避免在磁盘上产生最终需要删除的碎片。

不要使用编译到内存作为文件锁定问题的解决方法。核心问题是程序集在加载到进程的默认应用程序域时无法从内存中删除。如果您想在进程生命周期的后期从内存中卸载该程序集，则必须创建一个新的 appdomain 并将 DLL 加载到该 appdomain 中。

以下是如何在另一个 appdomain 的上下文中构造对象的粗略概述：

```
 var appdomain = AppDomain.CreateDomain("scratch");
    byte[] assemblyBytes = // bytes of the compiled assembly
    var assembly = appdomain.Load(assemblyBytes);
    object obj = appdomain.CreateInstanceAndUnwrap(assembly.FullName, "mynamespace.myclass"); 
```

在此序列之后，`obj`将包含对链接到 appdomain 内实际对象实例的代理的引用。您可以使用反射或将 obj 类型转换为通用接口类型来调用 obj 上的方法，并直接调用方法。准备进行调整以支持方法调用参数的 RPC 编组。（请参阅 .NET 远程处理）

使用多个应用程序域时，您必须小心访问类型和程序集的方式，因为许多 .NET 函数默认在调用者的当前应用程序域中运行，这通常不是您拥有多个应用程序域时想要的。`compilerResult.CompiledAssembly`例如，**在调用者的 appdomain 中**内部执行生成的程序集的加载。您想要的是将程序集加载到您的其他应用程序域中。你必须明确地这样做。

更新：在您最近添加的显示您如何加载应用程序域的代码片段中，这一行是您的问题：

```
 _assembly = Assembly.LoadFrom(path); 
```

这会将 DLL 加载到*当前*的 appdomain（调用者的 appdomain）中，而不是加载到目标 appdomain（在您的示例中由 _domain 引用）。您需要使用`_domain.Load()`将程序集加载到*该*应用程序域中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T15:48:56.393

如果您不需要调试，或者不介意调试“动态”代码，但缺少一些信息。您可以在内存中生成代码..这将允许您多次编译代码..但不会生成 .pdb

```
cp.GenerateInMemory = true; 
```

或者，如果您不需要能够在磁盘上找到程序集，您可以要求编译器转储临时目录中的所有代码并为 dll 生成一个临时名称（这将始终是唯一的）

```
cp.TempFiles = new TempFileCollection(Path.GetTempPath(), false);
//cp.OutputAssembly = "eventHandler.dll"; 
```

在这两种情况下，要访问 dll 及其类型，您都可以从编译器结果中获取它

```
Assembly assembly = cr.CompiledAssembly; 
```

不需要显式加载

但是如果不适用这种情况，并且您必须在已知文件夹中使用带有 .pdp 的物理 .dll .. 我可以给您的唯一建议是在 dll 上放置版本号.. 如果您不这样做有一种简单的方法来控制编译 dll 的次数，您可以随时使用时间戳。

```
cp.OutputAssembly = "eventHandler"+DateTime.Now.ToString("yyyyMMddHHmmssfff")+".dll"; 
```

当然，您必须意识到，每次编译新的 .dll 时都会将其加载到内存中并且不会被卸载，除非您使用单独的应用程序域..但这超出了这个问题的范围..

# python - 在 py2app 应用程序中嵌入可执行文件

> ID：15815364
> 
> 赞同：0
> 
> 时间：2013-04-04T15:23:45.790
> 
> 标签：python, macos, py2app

我有一个 python 脚本，我想用 py2app 将它打包为 Mac 应用程序包。该脚本调用 CLI 可执行文件。

如何将该可执行文件嵌入到应用程序包中？

我尝试进行编辑`setup.py`以将其作为*资源*包含在内，但在这种情况下，执行权限将丢失。此外，py2app 的 strip 阶段会引发错误。我想知道是否有一个特定的`setup.py`选项可以复制*Content/MacOS*而不是*Content/Resources*中的可执行文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T08:03:34.593

以正确的方式将 CLI 可执行文件添加到资源中，但由于 py2app 中的错误（目前未复制文件权限），这不起作用。

最简单的解决方法是在调用 py2app 后重置文件权限。

# sql-server - sql server 存储过程 sp_executesql

> ID：15815367
> 
> 赞同：1
> 
> 时间：2013-04-04T15:23:57.277
> 
> 标签：sql-server, stored-procedures

我有这个存储过程

```
USE [all_things]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[sp_getThingsByType]
    @thingid int,
    @typeid int
AS

DECLARE @Sql NVARCHAR(MAX) = 'SELECT * from items'

IF @thingid IS NOT NULL
BEGIN
  SET @Sql += ' where thingid = @thingid'
END

IF @typeid IS NOT NULL
BEGIN
  SET @Sql += ' and TypeID = @typeid'
END

EXEC sp_executesql @sql, N'@thingid int,@typeid int',@thingid=@thingid,@typeid=@typeid; 
```

测试用例：

1.  当我用`thingid`is`null`和`typeid`is运行它时`null`，我得到了所有完美的结果。

2.  当`thingid`提供了并且`typeid`是`null`时，结果是好的

3.  这是结果不好的地方：`thingid`is`null`和`typeid`is 供应。一切都在归还。

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:40:14.667

感谢@tschmit007，我修复了它。

```
USE [all_things]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[sp_getThingsByType]
    @thingid int,
    @typeid int
AS

DECLARE @Sql NVARCHAR(MAX) = 'SELECT * from items'

IF @thingid IS NOT NULL
BEGIN
  SET @Sql += ' where thingid = @thingid'
END

IF @typeid IS NOT NULL AND @thingid IS NOT NULL
BEGIN
  SET @Sql += ' and TypeID = @typeid'
END

IF @typeid IS NOT NULL AND @thingid IS NULL
BEGIN
  SET @Sql += ' where TypeID = @typeid'
END

EXEC sp_executesql @sql, N'@thingid int,@typeid int',@thingid=@thingid,@typeid=@typeid; 
```

# sql - Postgres 数据库如果不存在则创建

> ID：15815372
> 
> 赞同：12
> 
> 时间：2013-04-04T15:24:06.560
> 
> 标签：sql, database, postgresql, ddl

是否有`CREATE TABLE IF NOT EXISTS`用于创建数据库的类比？

背景：我正在编写一个脚本来在未知系统上自动设置 PostgreSQL 中的模式。我不确定数据库（甚至架构的一部分）是否已经部署，所以如果某些结构已经存在，我想构建我的代码以使其不会失败（或者理想情况下甚至显示错误）。我想将阻止我创建数据库的错误（因此中止未来的架构更改，因为它们不起作用）与此错误区分开来。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:35:19.053

不，但您可以查询 pg_catalog.pg_database 表以查看它是否存在。

# android - 安卓。如何在没有内存异常的情况下缩放图像？

> ID：15815373
> 
> 赞同：0
> 
> 时间：2013-04-04T15:24:06.813
> 
> 标签：android, image, memory, scale, image-size

我花了很多时间来了解如何在没有内存不足异常的情况下缩放图像，我想分享我的知识，我编写了将图像（从大到小）缩放到精确大小的函数。算法是：

1.  我们使用尽可能匹配的快速算法缩放图像，但图像的尺寸仍应大于所需的尺寸。
2.  我们将图像缩放到精确的结果大小。

该功能注释很好，因此很容易理解。如果您发现错误或者您知道如何使其更正确和更快，请发表评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:24:06.813

享受！

```
//this function change image size(from big to small) using low memory(as possible)
//the bigger side of result image will equals to IMAGE_BIGGER_SIDE_SIZE
//and second side will be scaled proportionally
//for example if you have image 800x400 and call decodeBitmapSize(bm, 200)
//you will receive image 200x100
//algorithm:
//1\. we scale image using quick algorihtm as match as possible, 
//   but image will still has sizes more then required
//2\. we scale image to exactly result size
public static Bitmap decodeBitmapSize(Bitmap bm, int IMAGE_BIGGER_SIDE_SIZE){

      //we will return this Bitmap  
      Bitmap b = null;          

      //convert Bitmap to byte[]
      ByteArrayOutputStream stream = new ByteArrayOutputStream();
      bm.compress(Bitmap.CompressFormat.JPEG, 100, stream);
      byte[] byteArray = stream.toByteArray();

      //We need to know image width and height, 
      //for it we create BitmapFactory.Options object  and do BitmapFactory.decodeByteArray
      //inJustDecodeBounds = true - means that we do not need load Bitmap to memory
      //but we need just know width and height of it
      BitmapFactory.Options opt = new BitmapFactory.Options();          
      opt.inJustDecodeBounds = true;
      BitmapFactory.decodeByteArray(byteArray, 0, byteArray.length, opt);
      int CurrentWidth = opt.outWidth;
      int CurrentHeight = opt.outHeight;

      //there is function that can quick scale images
      //but we need to give in scale parameter, and scale - it is power of 2
      //for example 0,1,2,4,8,16...
      //what scale we need? for example our image 1000x1000 and we want it will be 100x100
      //we need scale image as match as possible but should leave it more then required size
      //in our case scale=8, we receive image 1000/8 = 125 so  125x125, 
      //scale = 16 is incorrect in our case, because we receive 1000/16 = 63 so 63x63 image 
      //and it is less then 100X100
      //this block of code calculate scale(we can do it another way, but this way it more clear to read)
      int scale = 1;
      int PowerOf2 = 0;
      int ResW = CurrentWidth;
      int ResH = CurrentHeight;
      if (ResW > IMAGE_BIGGER_SIDE_SIZE || ResH > IMAGE_BIGGER_SIDE_SIZE) {
          while(1==1)
          {
              PowerOf2++;
              scale = (int) Math.pow(2,PowerOf2);
              ResW = (int)((double)opt.outWidth / (double)scale);
              ResH = (int)((double)opt.outHeight / (double)scale);
              if(Math.max(ResW,ResH ) < IMAGE_BIGGER_SIDE_SIZE)
              {
                  PowerOf2--;
                  scale = (int) Math.pow(2,PowerOf2);
                  ResW = (int)((double)opt.outWidth / (double)scale);
                  ResH = (int)((double)opt.outHeight / (double)scale);
                  break;
              }

          }
      }

      //Decode our image using scale that we calculated
      BitmapFactory.Options opt2 = new BitmapFactory.Options();
      opt2.inSampleSize = scale; 
      b = BitmapFactory.decodeByteArray(byteArray, 0, byteArray.length, opt2);

      //calculating new width and height
      int w = b.getWidth();
      int h = b.getHeight();
      if(w>=h)
      {
          w = IMAGE_BIGGER_SIDE_SIZE;
          h =(int)( (double)b.getHeight() * ((double)w/b.getWidth()));
      }
      else
      {
          h = IMAGE_BIGGER_SIDE_SIZE;
          w =(int)( (double)b.getWidth() * ((double)h/b.getHeight()));
      }

      //if we lucky and image already has correct sizes after quick scaling - return result
      if(opt2.outHeight==h && opt2.outWidth==w)
      {
          return b;
      }

      //we scaled our image as match as possible using quick method
      //and now we need to scale image to exactly size
      b = Bitmap.createScaledBitmap(b, w,h,true);   

      return b;
  } 
```

# python - Django 从 POST 解析 XML

> ID：15815375
> 
> 赞同：0
> 
> 时间：2013-04-04T15:24:09.733
> 
> 标签：python, django

我收到一个 HTTP POST。发送一个参数：**xml**

它包含一个 xml 文档。本文件的格式为：

```
 <?xml version="1.1" encoding="ISO-8859-1"?>
    <delivery_receipt>
    <version>1.0</version>
    <status>Delivered</status>
</delivery_receipt> 
```

我需要`<status>`从 POST 中获取内容，如何解析参数并获取“状态”？

**更新....**

如果请求.POST：

```
from lxml.cssselect import CSSSelector
from lxml.etree import fromstring

h = fromstring(request.POST['xml'])
h.cssselect('delivery_reciept status').text_content() 
```

我不确定 request.POST['xml'] 是否会起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:34:35.037

您可以（并且应该）对 XML 文档使用 CSS 选择器，前提是您正在执行相对简单的任务来解析 XML 文档。CSS 选择器清晰易读，比 XPATH 查询更具表现力。

我建议安装[lxml](http://www.lfd.uci.edu/~gohlke/pythonlibs/#lxml)，并使用他们的[cssselect](http://lxml.de/cssselect.html)功能。

您的最终结果可能如下所示：

```
>>> h = fromstring("""<?xml version="1.1" encoding="ISO-8859-1"?>
    <delivery_receipt>
      <version>1.0</version>
      <status>Delivered</status>
    </delivery_receipt> """)
>>> h.cssselect('delivery_reciept status').text_content() 
```

# charts - 在 SSRS 2008 中动态定位垂直 StripLine

> ID：15815379
> 
> 赞同：2
> 
> 时间：2013-04-04T15:24:14.920
> 
> 标签：charts, ssrs-2008, reporting-services

我正在构建一个控制图，其中用户选择一个中断日期，我想在此*之前*放置 StripLine 。因此，假设用户选择 2009 年 7 月作为中断日期，我想将 StripLine 放置在 2009 年 6 月。根据我获得下图的方式，我需要使用基于索引的放置。如何确定 2009 年 6 月在图表上的位置？用户还可以选择开始日期和结束日期，这样图表会有所不同。

如果重要，水平轴标签是 MYYYY，但值是 YYYYMM 用于排序。在下图中，我将 IntervalOffset 设置为 3，而不是 72009 或 200907。

我有下面的图表（现在是什么）静态定位的垂直带状线。

![控制图](https://i.stack.imgur.com/pHBkO.png)

SSRS 不是我的强项，所以如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:51:00.340

好的，这非常适合我的场景，但我想我会发布答案，以防它可以帮助其他人。将 IntervalOffset 的表达式设置为以下值有效：

```
=IIf(
     Parameters!StartYear.Value = Parameters!InterruptYear.Value,
     CInt(Parameters!InterruptMonth.Value - Parameters!StartMonth.Value),
     CInt(
          (CInt(Parameters!InterruptYear.Value)*12+CInt(Parameters!InterruptMonth.Value)) -
          (CInt(Parameters!StartYear.Value)*12+CInt(Parameters!StartMonth.Value))
         )
    ) 
```

# android - dao 与 greendao 并发插入；执行 BEGIN EXCLUSIVE 时数据库被锁定

> ID：15815380
> 
> 赞同：0
> 
> 时间：2013-04-04T15:24:16.173
> 
> 标签：android, greendao

当同一进程中有两个不同的线程试图同时保持时，我们正在测试 greendao 的并发问题。

我们在同一个进程中生成两个线程，并让它们同时插入 100 个随机填充的 dao。

**绿道 1.3.0 版**

如果我们做错了什么或者您需要更多信息，请告诉我，谢谢！

* * *

我们不断收到此错误：

```
04-04 14:29:48.528: E/Database(17736): Failure 5 (database is locked) on 0x2d4c98 when executing 'BEGIN EXCLUSIVE;'
04-04 14:29:48.528: W/dalvikvm(17736): threadid=10: thread exiting with uncaught exception (group=0x40018560)
04-04 14:29:48.538: E/AndroidRuntime(17736): FATAL EXCEPTION: Thread-11
04-04 14:29:48.538: E/AndroidRuntime(17736): android.database.sqlite.SQLiteException: database is locked: BEGIN EXCLUSIVE;
04-04 14:29:48.538: E/AndroidRuntime(17736):    at android.database.sqlite.SQLiteDatabase.native_execSQL(Native Method)
04-04 14:29:48.538: E/AndroidRuntime(17736):    at android.database.sqlite.SQLiteDatabase.execSQL(SQLiteDatabase.java:1772)
04-04 14:29:48.538: E/AndroidRuntime(17736):    at android.database.sqlite.SQLiteDatabase.beginTransactionWithListener(SQLiteDatabase.java:536)
04-04 14:29:48.538: E/AndroidRuntime(17736):    at android.database.sqlite.SQLiteDatabase.beginTransaction(SQLiteDatabase.java:490)
04-04 14:29:48.538: E/AndroidRuntime(17736):    at de.greenrobot.dao.AbstractDao.executeInsert(AbstractDao.java:344)
04-04 14:29:48.538: E/AndroidRuntime(17736):    at de.greenrobot.dao.AbstractDao.insert(AbstractDao.java:293) 
```

* * *

这是我用于插入 dao 的代码：

```
getGreenDaoSession().getMyDao().insert(this.myDao); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:26:30.843

终于想通了。

每个线程都产生一个单独的`DaoSession`. 每个线程，*因为它们在同一个进程中*，所以需要使用相同的`DaoSession`.

不过，这确实让我担心，我想知道当我们尝试进行相同的测试但将线程放在不同的进程上时这将如何工作。

# codeigniter - CodeIgniter：如何在加载时将变量传递给模型

> ID：15815381
> 
> 赞同：1
> 
> 时间：2013-04-04T15:24:16.353
> 
> 标签：codeigniter, variables, model, controller

在 CI 中，我有一个模型......

```
<?php

class User_crud extends CI_Model {

var $base_url;
var $category;
var $brand;
var $filter;
var $limit;
var $page_number;

public function __construct($category, $brand, $filter, $limit, $page_number) {
    $this->base_url = base_url();
    $this->category = $category;
    $this->brand = $brand;
    $this->filter = $filter;
    $this->limit = $limit;
    $this->page_number = $page_number;
}

public function get_categories() {
    // output
    $output = "";
    // query
    $this->db->select("name");
    $this->db->from("categories");
    $query = $this->db->get();
    // zero
    if ($query->num_rows() < 1) {
        $output .= "No results found";
        return $output;
    }
    // result
    $output .= "<li><a class=\"name\">Categories</a></li>\n";
    foreach ($query->result_array as $row) {
        $output = "<li><a href=\"\">{$row['name']}</a></li>\n";
    }
    return $output;
} 
```

当我在我的控制器中调用它时......

```
<?php

class Pages extends CI_Controller {

// home page

public function home() {
}

// products page

public function products($category = "cell phones", $brand = "all", $filter = "latest") {
    // loading
    $this->load->model("user_crud");
    // 
} 
```

现在，如何在加载/实例化时将`$category, $brand and $filter`变量传递给模型？`user_crud`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:31:47.763

您不应该像这样使用您的模型，只需传递所需功能所需的项目：

```
$this->load->model("user_crud");

$data['categories'] = $this->user_crud->get_categories($id, $category, $etc); 
```

我会建议（在看到你的代码之后）你学习很棒的[codeigniter](http://ellislab.com/codeigniter/user-guide/)用户指南，因为它有很好的例子，你只是采用了完全不同的方式（将模型视为对象）。坚持它的设计方式与您正在做的事情更简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:30:51.247

你不能。一个更好的主意是在模型类中设置一些设置器以及一些私有变量，并在加载模型后设置它们。

如果您从设置器返回 $this，您甚至可以将它们链接在一起，例如 $this->your_model->set_var1('test')->set_var2('test2');

# solr - 如何从响应中获取组数？

> ID：15815385
> 
> 赞同：0
> 
> 时间：2013-04-04T15:24:23.343
> 
> 标签：solr

我正在使用 apache solr 4。我正在使用 group=true 的查询。

我的查询参数是“group=true&group.field=company_id”

我如何获得组数？在 solr 响应中，只有所有行数和每组中的行数。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:28:50.933

您可以将`ngroups`参数设置为 true 以获取组数

添加`group.ngroups=true`到您的查询字符串以实现此目的。

[本文档](http://wiki.apache.org/solr/FieldCollapsing)中的更多详细信息。

# java - neo4j java 查询停止

> ID：15815386
> 
> 赞同：0
> 
> 时间：2013-04-04T15:24:29.407
> 
> 标签：java, neo4j

我有我正在尝试运行的代码示例：

```
import org.neo4j.rest.graphdb.RestAPI;
import org.neo4j.rest.graphdb.RestAPIFacade;
import org.neo4j.rest.graphdb.query.RestCypherQueryEngine;
import org.neo4j.rest.graphdb.util.QueryResult;
import java.util.Map;
import static org.neo4j.helpers.collection.MapUtil.map;

public class TestRun {
   public static void main(String[] args) {
     System.out.println("starting test");
     final RestAPI api = new RestAPIFacade("http://localhost:7474/db/data");
     System.out.println("API created");
     final RestCypherQueryEngine engine = new RestCypherQueryEngine(api);
     System.out.println("engine created");
     final QueryResult<Map<String,Object>> result = engine.query("start n=node({id}) return n, id(n) as id;", map("id", 0));
     System.out.println("query created");
     for (Map<String, Object> row : result) {
        long id=((Number)row.get("id")).longValue();
        System.out.println("id is " + id);
     }
   }
} 
```

它似乎只是在 QueryResult 的构建中停滞不前。知道为什么它会卡在那里吗？没有错误或异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T15:32:11.387

您需要升级到 Neo4j API 的最新版本（目前为 1.9）

# haskell - Haskell Scion 项目似乎有两个不同的服务器

> ID：15815388
> 
> 赞同：4
> 
> 时间：2013-04-04T15:24:37.143
> 
> 标签：haskell, emacs, ide

我正在尝试为 Emacs 中的 Haskell 开发设置 Scion。我从这里使用原始版本的 Scion： [https ://github.com/nominolo/scion](https://github.com/nominolo/scion)

我的 GHC 是 7.4.2，我在 Ubuntu 12.04 / 13.04 下。

我通过“cabal install scion”编译了 scion-server 和 scion-worker。问题是我在 Emacs 中尝试运行“thing-at-point”命令时遇到了类似“Unknown server command: thing-at-point”的错误。

我查看了源代码，发现（看起来）有两个不同的服务器：

1.  接穗\src-execs\Server.hs。它使用 atto-lisp 来解析 Emacs lisp 请求。

2.  接穗\服务器\接穗\服务器。看起来这里的代码使用 JSON 请求。我可以看到这段代码支持 cmdThingAtPoint 命令，但是从 Emacs 调用的 Server 不使用它。

在使用 GHC 7.4.2 时，任何人都知道 Scion for Emacs 的工作版本/fork（带有东西）？

如果不是 - 那么尝试集成这两个服务器是一个好主意吗？（例如将 lisp 请求转换为 JSON）。

在此先感谢您的任何建议。

# sql - SQL 不包括字段 ID，其中包括以下内容

> ID：15815389
> 
> 赞同：0
> 
> 时间：2013-04-04T15:24:41.327
> 
> 标签：sql, oracle, oracle10g

我正在从 3 个表中读取数据

ID 在所有 3 个表之间是通用的。

**这有效**

```
select 

        T1.ID,
        T2.CAUSE_NO,
        T2.CAUSE_TYPE,
        T3.START_NO,
        T3.START_TYPE,
        T1.Comments
from    Table1 T1,
        Table2 T2,
        Table3 T3

where   T2.ID = T3.ID 
    and T1.ID = T2.ID 
    AND T2.CAUSE_NO NOT IN (64,8,43,63,65) 
```

我还需要添加我不想包含 ID 的条件`where CAUSE_NO = 13 and START_NO = 83.`

下面是样本表。绿色是我想要的最终结果，不应包含红色行。 ![在此处输入图像描述](https://i.stack.imgur.com/1dnDQ.png) 有人可以帮助添加此条件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:46:45.400

我想你想要这个`where`条款：

```
where   T2.ID = T3.ID 
    and T1.ID = T2.ID 
    AND T2.CAUSE_NO NOT IN (64,8,43,63,65)
    AND not (CAUSE_NO = 13 and START_NO = 83) 
```

您还应该学习使用 ANSI 标准连接语法。

# d3.js - cluster.size 在 D3JS 中做了什么？

> ID：15815392
> 
> 赞同：1
> 
> 时间：2013-04-04T15:24:43.667
> 
> 标签：d3.js

我正在尝试基于 Mike Bostock 的 Heirarchical Edge Bundling（[这里是要点](https://gist.github.com/mbostock/1044242)）创建一个图表。我需要让我的 JSON 看起来像 readme-flare-imports.json 一样，但我不知道“大小”是什么。我阅读了[API](https://github.com/mbostock/d3/wiki/Cluster-Layout#wiki-size)，但它似乎对我没有帮助。此外，它将是一个基于 mySQL 数据库的动态 JSON 文件，因此我无法自己设置大小。有没有人能帮我弄清楚它是什么，或者我如何能够确定尺寸应该是多少？先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:59:39.350

`cluster.size`确定集群将占用多大的区域。你像这样向它传递值

```
// The angle
var x = 360;
// The radius
var y = window.height / 2;
cluster.size([x, y]) 
```

`x`将确定集群将使用多少圆圈来分支子级。一个值`360`将使用整个圆圈来显示所有值。的值`180`将仅使用半个圆圈来分支值。

`y`将确定圆在任何单个方向上的宽度，即圆的半径。

在 Heirarchical Edge Bundling 示例中，我相信文件中的`size`属性`json`被忽略了，因为我在代码中找不到任何关心它的东西。

# jakarta-ee - 当我从 Eclipse 重新启动 tomcat 时，server.xml 更改被清除

> ID：15815395
> 
> 赞同：0
> 
> 时间：2013-04-04T15:24:50.310
> 
> 标签：jakarta-ee, tomcat, tomcat6

当我在更改 server.xml、tomcat-users.xml 等文件后重新启动/启动 Tomcat 时，更改就会消失。看起来文件总是恢复到默认值。

我正在使用Tomcat 6。

我该怎么做才能使更改保持不变？谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T11:05:20.767

您应该在`Servers`项目中进行这些更改，其中 Eclipse WTP 复制了 Tomcat 配置文件。它们将被复制到您在 Eclipse 中运行的 Tomcat 实例中。（更多细节在[WTP 文档](http://wiki.eclipse.org/WTP_Tomcat_FAQ#When_I_create_my_first_Tomcat_server.2C_why_is_a_Servers_project_created_in_my_workspace.3F)中。）

# linq - LINQ Query 使用 where 和 lambda 表达式过滤结果返回错误结果

> ID：15815401
> 
> 赞同：-2
> 
> 时间：2013-04-04T15:25:13.533
> 
> 标签：linq, filter, lambda

使用带有条件的子句过滤`IEnumerable`结果集会返回重复的条目。`where`

这是我们用来过滤结果的查询。`links`是一个`IEnumerable`计数为 299 的计数。执行以下查询时，`validLinks`计数将变为 588，并且每个条目都是重复的。请帮助我们确定此查询有什么问题。

```
var validLinks = links.Where(link => link.Categories
                                         .Where(category => category.!IsCatchAll)
                                         .Any()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:26:57.253

该代码将无法编译，因为 `!`它位于错误的位置。你也不需要做`Where`and `Any`。尝试这个：

```
var validLinks = links.Where(link => link.Categories.Any(category => !category.IsCatchAll); 
```

# c++ - 从png，winapi创建透明图像

> ID：15815404
> 
> 赞同：2
> 
> 时间：2013-04-04T15:25:30.520
> 
> 标签：c++, winapi, png, transparency

我创建了一个简单的表单来在 winapi 中进行测试：我在这里上传：http: [//pastebin.com/7dNjE1Tb](http://pastebin.com/7dNjE1Tb)

我想在我的 hwnd 中放一个简单的 png 文件，例如这张图片： http: [//www.ledavi-network.com/includes/images/bg_shadow_png.png](http://www.ledavi-network.com/includes/images/bg_shadow_png.png)

我知道我应该使用这个： http: [//msdn.microsoft.com/en-us/library/windows/desktop/dd145141](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145141(v=vs.85).aspx) (v=vs.85).aspx但我在winapi中很新，我没有找到任何例子如何使用这个 TransparentBlt 功能。

有人可以帮我创建一个非常简单的例子吗？

编辑：但我想做什么？我想创建一个带有阴影的特殊背景的按钮。因此，如果有人知道更简单的方法，我会忘记使用 TransparentBlt。那么还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:54:27.217

在这里，这将完成这项工作。您需要确保为 AlphaBlend 链接了 gdiplus 和 msimg32 库（TransparentBlt 假设图像中的*单个*rgb 颜色将被视为透明。即，使用 TransparentBlt 时它只是 1 位透明度 - 完全不透明或完全透明。 )

您（可能）希望使用 AlphaBlend 来完成这项工作。

注意 - 我没有费心将 WM_ERASEBKGND 添加到 WndProc 函数。因此，每次重新绘制图像时，它都会直接绘制在已经存在的顶部（尝试调整窗口大小）。只需在erasebkg 中做一个FillRect，就可以了。

编辑：代码更新为使用带有 NULL hbitmap 的 displayImage 来做背景。

开始了：

```
#define WIN32_LEAN_AND_MEAN
#define WINVER 0x0600       // needed for alphablend function..

#include <windows.h>
#include <gdiplus.h>

const char g_szClassName[] = "myWindowClass";

// BMP, GIF, JPEG, PNG, TIFF, Exif, WMF, and EMF
// requires GDIPlus
HBITMAP mLoadImg(WCHAR *szFilename)
{
   HBITMAP result=NULL;

   Gdiplus::Bitmap* bitmap = new Gdiplus::Bitmap(szFilename,false);
   bitmap->GetHBITMAP(NULL, &result);
   delete bitmap;
   return result;
}

//void CStaticImg::displayImage(HBITMAP mBmp, HWND mHwnd)
void displayImage(HBITMAP mBmp, HWND mHwnd)
{
    RECT myRect;
    BITMAP bm;
    HDC screenDC, memDC;
    HBITMAP oldBmp;
    BLENDFUNCTION bf;

    GetObject(mBmp, sizeof(bm), &bm);

    bf.BlendOp = AC_SRC_OVER;
    bf.BlendFlags = 0;
    bf.SourceConstantAlpha = 0xff;

    bf.AlphaFormat = AC_SRC_ALPHA;

    screenDC = GetDC(mHwnd);
    GetClientRect(mHwnd, &myRect);

    if (mBmp == NULL)
        FillRect(screenDC, &myRect, WHITE_BRUSH);

    else
    {
        memDC = CreateCompatibleDC(screenDC);
        oldBmp = (HBITMAP)SelectObject(memDC, mBmp);
        AlphaBlend (screenDC, 0, 0, myRect.right,myRect.bottom, memDC, 0, 0, bm.bmWidth,bm.bmHeight, bf);
        SelectObject(memDC, oldBmp);
        DeleteDC(memDC);
        ReleaseDC(mHwnd, screenDC);
    }
}

// Step 4: the Window Procedure
LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    static HBITMAP myImage;
    switch(msg)
    {
        case WM_CLOSE:
            DestroyWindow(hwnd);
        break;

        case WM_ERASEBKGND:
            displayImage(NULL, hwnd);
        break;

        case WM_CREATE:
            myImage = mLoadImg(L"bg_shadow_png.png");
        break;

        case WM_PAINT:
            //displayImage(HBITMAP mBmp, HWND mHwnd);
            displayImage(myImage, hwnd);
            ValidateRect(hwnd, NULL);
            break;

        case WM_DESTROY:
            PostQuitMessage(0);
        break;
        default:
            return DefWindowProc(hwnd, msg, wParam, lParam);
    }
    return 0;
}

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance,
    LPSTR lpCmdLine, int nCmdShow)
{
    WNDCLASSEX wc;
    HWND hwnd;
    MSG Msg;

    static Gdiplus::GdiplusStartupInput gdiplusStartupInput;
    static ULONG_PTR gdiplusToken;
    // so we can load all the image formats that windows supports natively - (I'm using a transparent PNG on the main dialog)
    GdiplusStartup(&gdiplusToken, &gdiplusStartupInput, NULL);

    //Step 1: Registering the Window Class
    wc.cbSize        = sizeof(WNDCLASSEX);
    wc.style         = 0;
    wc.lpfnWndProc   = WndProc;
    wc.cbClsExtra    = 0;
    wc.cbWndExtra    = 0;
    wc.hInstance     = hInstance;
    wc.hIcon         = LoadIcon(NULL, IDI_APPLICATION);
    wc.hCursor       = LoadCursor(NULL, IDC_ARROW);
    wc.hbrBackground = (HBRUSH)(COLOR_WINDOW+1);
    wc.lpszMenuName  = NULL;
    wc.lpszClassName = g_szClassName;
    wc.hIconSm       = LoadIcon(NULL, IDI_APPLICATION);

    if(!RegisterClassEx(&wc))
    {
        MessageBox(NULL, "Window Registration Failed!", "Error!",
            MB_ICONEXCLAMATION | MB_OK);
        return 0;
    }

    // Step 2: Creating the Window
    hwnd = CreateWindowEx(
        WS_EX_CLIENTEDGE,
        g_szClassName,
        "The title of my window",
        WS_OVERLAPPEDWINDOW,
        CW_USEDEFAULT, CW_USEDEFAULT, 240, 120,
        NULL, NULL, hInstance, NULL);

    if(hwnd == NULL)
    {
        MessageBox(NULL, "Window Creation Failed!", "Error!",
            MB_ICONEXCLAMATION | MB_OK);
        return 0;
    }

    ShowWindow(hwnd, nCmdShow);
    UpdateWindow(hwnd);

    // Step 3: The Message Loop
    while(GetMessage(&Msg, NULL, 0, 0) > 0)
    {
        TranslateMessage(&Msg);
        DispatchMessage(&Msg);
    }

    Gdiplus::GdiplusShutdown(gdiplusToken);
    return Msg.wParam;
} 
```

# android - 无头运行 Android Instrumentation 测试？

> ID：15815407
> 
> 赞同：2
> 
> 时间：2013-04-04T15:25:44.617
> 
> 标签：android, testing, ant, command-line

我什至不确定这是否有意义，但是否可以在无头模式下运行仪器测试？目前我从命令行运行我的测试套件，如下所示：

```
ant debug install test 
```

或者，如果我想专注于像这样的单个测试：

> adb shell am instrument -w -e class com.my.package.testClass#testCase com.my.package.tests/android.test.InstrumentationTestRunner

是否可以将标志传递给 ant 或 adb（或两者）以在没有 UI 的情况下运行测试？我没有使用模拟器。我正在我的设备上运行测试。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T16:13:15.503

这不是无头运行测试的问题，而是无头运行模拟器的问题。`-no-window`从命令行启动模拟器时使用该开关。

# drools - Drools Fusion“期间”时间运算符的问题

> ID：15815408
> 
> 赞同：0
> 
> 时间：2013-04-04T15:25:50.333
> 
> 标签：drools, drools-fusion

我已经开始使用 Drools Fusion 并且在时间运算符**期间遇到了奇怪的问题。****出于某种原因，例如在**操作员工作正常之后，我不能让它太工作。

这是我的事件的声明 - 它只包含特定类型的间隔：

```
声明WorkingDayInterval
   @角色（事件）
   @timestamp(event_ts_local)
   @duration(duration_in_seconds)
结尾

```

这是我的规则：

```
规则“处理期间的空闲”
什么时候
 $processing : WorkingDayInterval( subcategory == "processing")
 $longIdle : WorkingDayInterval(这在 $processing, subcategory == "idle",duration_in_seconds > 600)
然后
    System.out.println("Bad Idle Event:");
    System.out.println ($processing.event_ts_local);
    System.out.println ($processing.duration_in_seconds);
    System.out.println ($longIdle.event_ts_local);
    System.out.println ($longIdle.duration_in_seconds);
结尾

```

当我运行它时，没有任何东西被解雇。

但是，当我**在**得到以下结果**之后**更改为：

```
坏空闲事件：
2013 年 2 月 25 日星期一 05:19:00 MSK
2350
2013 年 2 月 25 日星期一 05:20:00 MSK
901

```

并查看值，我清楚地看到，基于开始时间戳和持续时间，第二个事件在第一个事件内，因此应该触发**持续时间。**

是 Drools Fusion 中的错误还是我做错了什么？

顺便说一句 - 我在**云**模式下运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T09:32:19.983

我认为问题在于您假设它`@duration`以**秒**为单位，而实际上 Fusion 期望它以**毫秒为单位**表示。因此，在您的情况下，`$processing`事件开始于`05:19:00.00`并结束于`05:19:02.35`并`$longIdle`开始于`05:20:00.00`并结束于`05:20:00.90`。如您所见，`$longIdle during $processing`is **false**但`$longIdle after $processing`为**true**。

希望能帮助到你，

# character-encoding - 需要合适的字符集才能从网络表单发送 SMS 消息

> ID：15815412
> 
> 赞同：1
> 
> 时间：2013-04-04T15:25:58.350
> 
> 标签：character-encoding, sms

我已经构建了一个允许客户发送 SMS 消息的网络表单，并且我想限制表单允许的字符集，以便编码将消息保留为 160 个字符。如果用户键入日文或西里尔字符，编码将切换为 16 位，短信长度将缩短为 70 个字符。我不想让这个。

见[https://en.wikipedia.org/wiki/SMS#Message_size](https://en.wikipedia.org/wiki/SMS#Message_size)

在 HTML 表单中，您可以指定字符集

```
form accept-charset="character_set" 
```

其中 'character_set' 类似于 UTF8 或 ISO-8859-1。GSM 3.38 定义了 SMS 消息字符 ( [http://en.wikipedia.org/wiki/GSM_03.38](http://en.wikipedia.org/wiki/GSM_03.38) )

有没有办法在我的网络表单中设置这个限制？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T16:00:58.490

无法使用 将表单限制为 GSM 3.38 字母表`accept-charset`，它不在允许的 HTML 字符集中。

唯一的方法是在 keypress 事件上添加一个 javascript 侦听器函数，并根据允许的字符检查每个输入的字符。

# c# - 在 Mono 中，当主应用程序退出或崩溃时关闭进程

> ID：15815431
> 
> 赞同：0
> 
> 时间：2013-04-04T15:26:49.633
> 
> 标签：c#, mono, gtk, exit

我有一个使用 Process 和 Process Start Info 启动本机应用程序 (App2) 的 Mono c# 应用程序 (App1)。一切运行顺利，但我想要某种处理程序、事件或其他任何东西，以便我可以收到 app1 已关闭的通知，以便我可以调用 App2.kill()。目前，当 app1 关闭时，app2 会继续运行，这是不可取的。我已经看到在 Microsoft 的 .net 中有可用的 Application.OnExit 事件等，但似乎在 Mono 中没有这样的东西。有没有人遇到过类似的问题并知道如何解决？

先感谢您，

托尼

# java - 从随机访问文件中读取数据

> ID：15815439
> 
> 赞同：0
> 
> 时间：2013-04-04T15:27:11.370
> 
> 标签：java, io, randomaccessfile

这是我的功能：

```
// Read a record from the specified RandomAccessFile
   public void read( RandomAccessFile file ) throws IOException    {
      account = file.readInt();
      byte b1[] = new byte[ 15 ];
      file.readFully( b1 );
      firstName = new String( b1, 0 );
      firstName = firstName.trim();
      byte b2[] = new byte[ 15 ];
      file.readFully( b2 );
      lastName = new String( b2, 0 );
      lastName = lastName.trim();
      balance = file.readDouble();
   } 
```

我必须能够从随机访问文件中读取我的一项考试，并且上面的代码有点令人困惑。

这就是我猜正在发生的事情，如果我错了，如果你能纠正我，将不胜感激。

我们从文件`file`中取出并`readInt`分配给`account`. 接下来我想我们创建一个大小为 15 的新字节，并将文件中的名字读入字节，然后分配给`firstname`. 现在这是我不明白的，有什么作用`readFully`？以及上面的代码如何知道转移到`lastName`. 所以简单地说，

```
byte b1[] = new byte[ 15 ];
      file.readFully( b1 );
      firstName = new String( b1, 0 );
      firstName = firstName.trim(); 
```

VS

```
 byte b2[] = new byte[ 15 ];
      file.readFully( b2 );
      lastName = new String( b2, 0 );
      lastName = lastName.trim();
      balance = file.readDouble(); 
```

为什么它不给出相同的值？我们在猜测每个值（名字、姓氏等）有多长？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:29:40.290

正如 api 所说：

从此文件中读取`b.length`字节到字节数组中，从当前文件指针开始。此方法从文件中重复读取，直到读取请求的字节数。

```
 public void write(RandomAccessFile file) throws IOException {
    file.writeInt(account);
    byte b1[] = new byte[15];
    // set firstname to b1
    file.write(b1);
    byte b2[] = new byte[15];
    // set lastname to b2
    file.write(b2);
    double balance =123.1;
    file.writeDouble(balance);
} 
```

如果你生成的文件与上面的完全一样，你阅读进度就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:45:11.200

If this is a school/university exam, bear in mind that they know to have absurdities on purpose, to confuse you.

Considering a comment from the code you posted:

> Read a **record** from the specified RandomAccessFile

I'd bet that it is defined that the binary file you are reading from has data stored in records like this:

*   account - 4B (size of int)
*   first name - 15B
*   last name - 15B
*   balance - 8B

I also bet that it is supposed that the data is written correctly - meaning exactly in the above order and length. If it is not, e.g. there is a string instead of the integer, or the first name is bigger, it will probably result in error or misinterpreted data - that's why your snippets give different results.

It is a [binary file](http://en.wikipedia.org/wiki/Binary_file) you are reading from anyway, if you want to read something out if it, you **must** now the exact format in which it was written. Otherwise it's like deciphering an alien letters.

As for the [RandomAccessFile.readFullyMethod](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/RandomAccessFile.html#readFully%28byte%5b%5d%29):

> Reads b.length bytes from this file into the byte array, starting at the current file pointer. This method *reads repeatedly* from the file *until the requested number of bytes are read*. This method *blocks until* the *requested number of bytes are read, the end of the stream is detected, or an exception is thrown*.

# ios - CALayer 上的绘制文本在运行时不会出现或崩溃

> ID：15815443
> 
> 赞同：4
> 
> 时间：2013-04-04T15:27:24.820
> 
> 标签：ios, objective-c, uilabel, calayer, catextlayer

我有一个 CALayer，我首先在上面画了一些东西，然后是一个文本：

```
- (void)drawInContext:(CGContextRef)context
{
    CGContextSaveGState(context);

    // draw things, everything displays correctly ...

    CGSize expectedCreditSize = [[gpData.credits stringValue] sizeWithFont:[UIFont 
                                                          systemFontOfSize:self.fontSize]];

    rect = CGRectMake(self.bounds.origin.x, self.bounds.size.height/2,
                      expectedCreditSize.width, expectedCreditSize.height);

    CGContextSetFillColorWithColor(context, [[UIColor whiteColor] CGColor]);

    [self.creditString drawInRect:rect
                         withFont:[UIFont systemFontOfSize:self.fontSize]
                    lineBreakMode:NSLineBreakByWordWrapping
                        alignment:NSTextAlignmentRight];

    CGContextRestoreGState(context);
} 
```

所有图形内容都正确显示，但文本根本不正确。我究竟做错了什么？

我还尝试将 CATextLayer 添加为 subLayer，但因此在运行时收到错误消息。

```
CATextLayer *creditsTextLayer = [[CATextLayer alloc] init];
[creditsTextLayer setFrame:self.frame];
[creditsTextLayer setPosition:self.position];
[creditsTextLayer setString:self.creditString];
[creditsTextLayer setFontSize:self.fontSize];
[creditsTextLayer setAlignmentMode:kCAAlignmentLeft];
[creditsTextLayer setForegroundColor:[[UIColor whiteColor] CGColor]];
[self addSublayer:creditsTextLayer]; 
```

唯一有效的是这个解决方案：

```
CGContextSelectFont (context,
                     "Helvetica-Bold",
                     self.fontSize,
                     kCGEncodingMacRoman);
CGContextSetTextDrawingMode (context, kCGTextFill);

CGContextSetRGBFillColor (context, 0, 1, 0, .5);
CGContextSetRGBStrokeColor (context, 0, 0, 1, 1);
CGContextShowTextAtPoint (context, 40, 0, self.creditString, 9); 
```

但这很不舒服。

有没有人知道，我能做些什么来提出我的第一个工作建议？我错过了显示文本的东西吗？

提前致谢！

**编辑：**

基于Seamus的回答，我现在开始工作了

```
- (void)drawInContext:(CGContextRef)context
{
    CGContextSaveGState(context);

    // draw things like circles and lines, 
    // everything displays correctly ...

    // now drawing the text
    UIGraphicsPushContext(context);

    CGSize expectedCreditSize = [[gpData.credits stringValue] sizeWithFont:[UIFont 
                                                          systemFontOfSize:self.fontSize]];

    rect = CGRectMake(self.bounds.origin.x, self.bounds.size.height/2,
                       expectedCreditSize.width, expectedCreditSize.height);

    CGContextSetFillColorWithColor(context, [[UIColor whiteColor] CGColor]);

    [self.creditString drawInRect:rect
                         withFont:[UIFont systemFontOfSize:self.fontSize]
                    lineBreakMode:NSLineBreakByWordWrapping
                        alignment:NSTextAlignmentRight];

    UIGraphicsPopContext();
    CGContextRestoreGState(context);
} 
```

这意味着我只是推送和弹出文本的图形上下文。这有意义吗？为什么它适用于绘制其他 CGContext 东西？也许有人可以解释......</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:40:28.173

观察它`-drawInRect:withFont:lineBreakMode:alignment:`不带`CGContextRef`参数 - 它绘制到“当前”图形上下文。您没有向我们展示您是如何获得要绘制的上下文的，但通常该`NSString`方法将用于`-drawRect`具有以下上下文的方法中：

```
CGContextRef context = UIGraphicsGetCurrentContext(); 
```

`UIGraphicsPushContext()`您可以使用（但确保您也调用）使您的上下文成为“当前上下文” `UIGraphicsPopContext()`：

```
- (void)drawInContext:(CGContextRef)context
{
    UIGraphicsPushContext(context);
    CGContextSaveGState(context);

    // draw things, everything displays correctly ...

    CGSize expectedCreditSize = [[gpData.credits stringValue] sizeWithFont:[UIFont 
                                                          systemFontOfSize:self.fontSize]];

    rect = CGRectMake(self.bounds.origin.x, self.bounds.size.height/2,
                      expectedCreditSize.width, expectedCreditSize.height);

    CGContextSetFillColorWithColor(context, [[UIColor whiteColor] CGColor]);

    [self.creditString drawInRect:rect
                         withFont:[UIFont systemFontOfSize:self.fontSize]
                    lineBreakMode:NSLineBreakByWordWrapping
                        alignment:NSTextAlignmentRight];

    CGContextRestoreGState(context);
    UIGraphicsPopContext();
} 
```

# javascript - 不区分大小写的正则表达式列表匹配

> ID：15815446
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:27:33.007
> 
> 标签：javascript, regex

我想使用正则表达式来确定用户提供的值是否存在于已批准值的列表中，*无论 case*。这是当前 JavaScript 代码的精简示例，它可以匹配“JAN”、“Jan”和“jan”——但不匹配“jAN”、“jAn”等：

```
var validateValue = function(field, patternName){
    "use strict"; //let's avoid tom-foolery in this function
    var pattern="";

    switch(patternName)
    {
    case "MMM": //month names only
        pattern=/^JAN|Jan|jan*$/;
        break;
    // other cases  and default follow in real code
    }

    if ( (!field.value.length) || pattern.test(field.value) ){
        //we're good (the field is blank or passes the regular expression test); remove field's error message, enable the submit button
    }
    else {
        //problems; let's show the error message and put focus back on problem field, disable the submit button
    }
}; 
```

我根据从“[不使用 RegexOptions 枚举的情况下不区分大小写](https://stackoverflow.com/q/2439965/1430996)的正则表达式”中学到的东西尝试了`pattern=/^`**(?i)**，但这并不能解决问题（“未捕获的 SyntaxError：无效的正则表达式......”）`JAN|Jan|jan*$/;`

**评估值是否匹配、不区分大小写、列表项的正确正则表达式是什么？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T15:28:21.480

您可以`i`像这样使用（不区分大小写）修饰符：

```
pattern = /^jan*$/i; // <-- it goes at the end 
```

定义正则表达式的另一种方法是使用`RegExp`对象：

```
pattern = new RegExp("^jan*$", "i"); 
```

我发现这种形式更具可读性。

* * *

另请记住，这`/^jan*$/i`将匹配以下内容：

```
JAN
jannnn
jannNN
jAn 
```

我不确定这是否是你想要的。

* * *

如果您只想匹配预定义的集合，您可以选择非正则表达式解决方案：

```
function isMonth(value) {
    var months = "jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec".split("|");
    return months.indexOf(value.toLowerCase()) !== -1;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T15:30:16.227

如果你不想使用正则表达式选项，你可以试试这个正则表达式：

```
pattern = /^[Jj][Aa][Nn]$/ 
```

# c++ - Visual Studio 2012 中的“Winmm.lib”错误

> ID：15815457
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:28:14.247
> 
> 标签：c++, opengl, visual-studio-2012

我正在为 Windows 8 的 Visual Studio Express 2012 中的 C++ 中的 Opengl 开发一个项目。它编译成功，但是当我部署它时，......它给出了“winmm.lib”文件的错误......

错误 LNK1104：无法打开文件“winmm.lib”。

如何下载 winmm.lib 文件以及从哪里下载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:32:17.310

它是 Windows SDK 的一部分。其中...您需要开发 Windows 应用程序。:)

# javascript - 是否已经存在支持 Dojo AMD、NodeJS 要求和浏览器窗口的代码。 [something] 用于 Javascript 微库

> ID：15815460
> 
> 赞同：7
> 
> 时间：2013-04-04T15:28:18.497
> 
> 标签：javascript, node.js, dojo, requirejs, amd

我有一些代码支持编写微库并将其加载到 Dojo AMD、NodeJS require() 和浏览器的普通窗口中。[某事]...但我想知道是否已经建立了这样做的方法，我只是重新发明了轮子，或者代码是否值得。我确实在互联网上进行了很好的搜索。

我创建的代码位于[https://gist.github.com/forbesmyester/5293746](https://gist.github.com/forbesmyester/5293746)，如果人们有评论，那很好，但我更感兴趣的是找出是否有合适的方法来做这件事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T12:05:27.213

我按照添加的链接 psema4 进行了一些阅读，发现[了这个 github 项目](http://github.com/umdjs/umd)，它试图将人们用来解决这个问题的所有不同方法整理成一组样板文件。

我确信 Forbesmyester 已经找到了这个解决方案，但我认为应该为将来发现这个问题的任何人提供它。

# angularjs - 如果选中复选框，则需要输入值

> ID：15815463
> 
> 赞同：16
> 
> 时间：2013-04-04T15:28:24.370
> 
> 标签：angularjs

我有一系列行，每个行都有一个复选框。每行有几个输入。我已经进行了验证，需要在所有行中至少选中一个复选框。但是，到目前为止，我无法要求输入仅对选中的复选框有一个值。

![在此处输入图像描述](https://i.stack.imgur.com/Bfmmo.jpg)

**的HTML：**

```
<div style="width: 100%;">
<checkboxgroup-Wheelbase min-required="1">          
    <table style="width: 100%">                                
        <tr>
            <td>
                <table style="width: 97%;">
                    <tr>
                        <th style="width: 220px;" class="wheelbaseHeaderCell">Wheelbase<br /><span style="font-weight: 400;">(choose min of 1)</span></th>
                        <th class="wheelbaseHeaderCell">Payload<br />[ pounds ]</th>
                        <th class="wheelbaseHeaderCell">Length<br />[ inches ]</th>
                        <th class="wheelbaseHeaderCell">Height<br />[ inches ]</th>
                        <th class="wheelbaseHeaderCell">Weight<br />[ pounds ]</th>
                        <th class="wheelbaseHeaderCell">Turn Radius<br />[ feet ]</th>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td style="height: 5px;"></td>
        </tr>
        <tr>
            <td>
                <div style="height: 170px; overflow: auto;">
                    <table style="width: 100%;">
                        <tr class="rowGroup" ng-repeat="wheelbase in wheelbases" data-rowParent="wheelbase[wheelbase.Id]">
                            <td class="wheelbaseCell" style="padding-left: 10px;" id="{{wheelbase.Id}}">
                                <!--Wheelbase-->                                    
                                <label class="checkbox" for="{{wheelbase.Id}}" style="text-align: left; width: 200px;">  
                                    {{wheelbase.WheelbaseGrade}} - {{wheelbase.Inches}} inches
                                    <input ng-model="wheelbase.checked" id="wheelbase{{wheelbase.Id}}" type="checkbox"  /></label>
                            </td>
                            <td >
                                <!--Payload Capacity-->
                                <span style="display: inline-block;" ng-controller="PayloadCapacitiesCtrl">
                                    <input ng-model="payloadCapacity.Pounds" data-rowChild="{{wheelbase[wheelbase.Id]}}" type="number" style="width: 80px;" min="0" ng-class="getClass({{wheelbase.Id}})" ng-disabled="!wheelbase.checked" />
                                </span>                                                                
                            </td>                                
                            <td >
                                <!--Length-->
                                <span style="display: inline-block;" ng-controller="VehicleLengthCtrl">
                                    <input data-rowChild="{{wheelbase[wheelbase.Id]}}" type="number" style="width: 80px;" min="0" ng-class="getClass({{wheelbase.Id}})" ng-disabled="!wheelbase.checked"/>
                                </span>                                
                            </td>
                            <td >
                                <!--Height-->
                                <span style="display: inline-block;" ng-controller="VehicleHeightCtrl">
                                    <input data-rowChild="{{wheelbase[wheelbase.Id]}}" type="number" style="width: 80px;" min="0" ng-class="getClass({{wheelbase.Id}})" ng-disabled="!wheelbase.checked"/>
                                </span>                                
                            </td>
                            <td >
                                <!--Weight-->
                                <span style="display: inline-block;" ng-controller="VehicleWeightCtrl">
                                    <input data-rowChild="{{wheelbase[wheelbase.Id]}}" type="number" style="width: 80px;" min="0" ng-class="getClass({{wheelbase.Id}})" ng-disabled="!wheelbase.checked"/>
                                </span>                                
                            </td>
                            <td >
                                <!--Turning Radii -->
                                <span style="display: inline-block;" ng-controller="TurningRadiiCtrl">
                                    <input data-rowChild="{{wheelbase[wheelbase.Id]}}" type="number" style="width: 80px;" min="0"  ng-class="getClass({{wheelbase.Id}})" ng-disabled="!wheelbase.checked"/>
                                </span>                                
                            </td>
                        </tr>
                    </table>  
                </div>
            </td>
        </tr>
    </table>
</checkboxgroup-Wheelbase>
<span class="hint" style="margin: 0 0 0 -35px; text-align: center; width: 100%;">         
    <button style="padding-top: 5px; ;" class="addNew"  ng-click="openDialog()"><i class="icon-plus"></i> [ add new wheelbase ]</button>
</span> 
```

**要求至少选中一个复选框的指令：**

```
.directive('checkboxgroupWheelbase', function() {
    return {
        restrict: 'E',
        controller: function($scope, $attrs) {
            var self = this;
            var ngModels = [];
            var minRequired;
            self.validate = function() {
                var checkedCount = 0;
                angular.forEach(ngModels, function(ngModel) {
                    if (ngModel.$modelValue) {
                        checkedCount++;
                    }
                });
                console.log('minRequired', minRequired);
                console.log('checkedCount', checkedCount);
                var minRequiredValidity = checkedCount >= minRequired;
                angular.forEach(ngModels, function(ngModel) {
                    ngModel.$setValidity('checkboxgroupWheelbase-minRequired', minRequiredValidity, self);
                });
            };

            self.register = function(ngModel) {
                ngModels.push(ngModel);
            };

            self.deregister = function(ngModel) {
                var index = this.ngModels.indexOf(ngModel);
                if (index != -1) {
                    this.ngModels.splice(index, 1);
                }
            };

            $scope.$watch($attrs.minRequired, function(value) {
                minRequired = parseInt(value, 10);
                self.validate();
            });
        }
    };
}) 
```

是否有一种简单、优雅的方法来要求这些复选框的输入字段是必需的？它通过“规则”在 JQuery 中直接出现，但我还没有找到通过 AngularJs 做到这一点的方法。有人建议我使用子表单，但我无法想象它的实现。

**万一我不够清楚：**

对于选中相应复选框的任何行，该行的所有输入都需要有一个值。因此，如果选中第 1,3 和 5 行的复选框，则第 1,3 和 5 行的输入需要值。如果选中了一行的复选框，则同一行的输入需要一个值。如果未选中该行的复选框，则不需要这些输入。在清除这一点时，我认为明智的做法是禁用所有输入，直到它们各自的轴距复选框被选中。

**更新：**

我要感谢 user2104976 让我考虑更好的用户体验，只要确保在未选中相应的轴距复选框时不添加输入值，所以我实现了这个

```
 **"ng-disabled="!wheelbase.checked"** 
```

在每个相应的输入中。多谢，伙计！！现在如何解决我原来的问题，哈哈！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-04T18:10:19.500

您可以使用 ng-required 来完成此操作：

**ng-required="wheelbase.checked"**

这是更新后的 HTML 的相关部分：

```
<table style="width: 100%;">
    <tr class="rowGroup" ng-repeat="wheelbase in wheelbases" data-rowParent="wheelbase[wheelbase.Id]" style="padding-top: 10px;">
        <td class="wheelbaseCell" style="padding-left: 10px;" id="{{wheelbase.Id}}">
            <!--Wheelbase-->                                    
            <label class="checkbox" for="{{wheelbase.Id}}" style="text-align: left; width: 200px;">  
                {{wheelbase.WheelbaseGrade}} - {{wheelbase.Inches}} inches
                <input ng-model="wheelbase.checked" id="wheelbase{{wheelbase.Id}}" type="checkbox" /></label>
        </td>
        <td >
            <!--Payload Capacity-->
            <span style="display: inline-block;" ng-controller="PayloadCapacitiesCtrl">
                <input ng-model="payloadCapacity.Pounds" data-rowChild="{{wheelbase[wheelbase.Id]}}" id="payload{{wheelbase.Id}}" type="number" style="width: 80px;" min="0" ng-disabled="!wheelbase.checked" ng-required="wheelbase.checked" ng-class="{'formRequire' : wheelbase.checked }"  />
            </span>                                                                
        </td>                                
        <td >
            <!--Length-->
            <span style="display: inline-block;" ng-controller="VehicleLengthCtrl">
                <input ng-model="vehicleLength.Inches" data-rowChild="{{wheelbase[wheelbase.Id]}}" type="number" style="width: 80px;" min="0"  ng-disabled="!wheelbase.checked" ng-required="wheelbase.checked" ng-class="{'formRequire' : wheelbase.checked }"  />
            </span>                                
        </td>
        <td >
            <!--Height-->
            <span style="display: inline-block;" ng-controller="VehicleHeightCtrl">
                <input ng-model="vehicleHeight.Inches" data-rowChild="{{wheelbase[wheelbase.Id]}}" type="number" style="width: 80px;" min="0"  ng-disabled="!wheelbase.checked" ng-required="wheelbase.checked" ng-class="{'formRequire' : wheelbase.checked }"  />
            </span>                                
        </td>
        <td >
            <!--Weight-->
            <span style="display: inline-block;" ng-controller="VehicleWeightCtrl">
                <input ng-model="vehicleWeight.Pounds" data-rowChild="{{wheelbase[wheelbase.Id]}}" type="number" style="width: 80px;" min="0"  ng-disabled="!wheelbase.checked" ng-required="wheelbase.checked" ng-class="{'formRequire' : wheelbase.checked }"  />
            </span>                                
        </td>
        <td >
            <!--Turning Radii -->
            <span style="display: inline-block;" ng-controller="TurningRadiiCtrl">
                <input ng-model="turningRadius.Feet" data-rowChild="{{wheelbase[wheelbase.Id]}}" type="number" style="width: 80px;" min="0"   ng-disabled="!wheelbase.checked" ng-required="wheelbase.checked"  ng-class="{'formRequire' : wheelbase.checked }"  />
            </span>                                
        </td>
    </tr>
</table> 
```

**使用 ng-disabled="!wheelbase.checked"** ![在此处输入图像描述](https://i.stack.imgur.com/brSoe.jpg)

**使用 ng-required="wheelbase.checked" & ng-class="{'formRequire' : wheelbase.checked }"**

![在此处输入图像描述](https://i.stack.imgur.com/hXiND.jpg)

如果选中了相应的轴距复选框，则这是进入输入的条件类：

.ng-invalid .formRequire { 轮廓：红色实心 3px; }

# testing - 当集合获取成功回调调用渲染时测试主干视图

> ID：15815466
> 
> 赞同：1
> 
> 时间：2013-04-04T15:28:32.000
> 
> 标签：testing, backbone.js, jasmine, backbone-views, sinon

我正在使用 Jasmine 和 Sinon 来测试我的 Backbone 应用程序，但我遇到了一些麻烦。我正在尝试测试初始化​​视图时是否调用了渲染

我有以下观点：

```
var MyView = Backbone.View.extend({
    el: '#myElement',
    initialize : function() {
        var that = this;
        this.collection.fetch({
            error : function() {
                alert("error!");
            },
            success : function() {
                that.render();
            }
        });
    },

    render : function() {
        this.collection.each(this.renderItem);
    }

    ... 
```

我的测试

```
it('Should call render when view is instantiated', function(){          
                spyOn(MyView.prototype, 'render');
                var myCollection = new MyCollection();
                this.view = new MyView({collection: myCollection});
                expect(MyView.prototype.render).toHaveBeenCalled();
        }); 
```

问题是在我的 fetch 的成功回调执行之前调用了 expect()。解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T08:42:30.260

所以这里的问题是你测试了两件事，视图和集合。您应该存根集合并仅测试视图：

```
sinon.stub(myCollection, 'fetch').yieldsTo('success') // will immediately call the success methode
sinon.stub(myCollection, 'each').callsArg(0) // will immediately call this.renderItem 
```

监视您要测试的课程也不是一个好主意。在您的情况下，您应该测试视图的 innerHTMl 在`this.renderItem`调用后是否已按预期更改

# visual-c++ - Visual C++ 11 在 CMake 生成的项目中找不到 Boost unit_test_framework 库

> ID：15815467
> 
> 赞同：3
> 
> 时间：2013-04-04T15:28:35.163
> 
> 标签：visual-c++, boost, cmake

我有一个使用 CMake 和 Boost 的 C++ 项目，它在 Linux 下编译/链接没有任何问题。我正在努力通过 Visual C++ 2012 将其移植到 Windows。

我的 CMake 配置如下：

```
set(BOOST_ROOT ${DEPENDENCY_DIR}/boost/)
set(Boost_USE_STATIC_LIBS   ON)
set(Boost_USE_MULTITHREADED ON)
set(Boost_USE_STATIC_RUNTIME    OFF)
find_package(Boost 1.53 COMPONENTS system date_time chrono serialization filesystem program_options random thread regex unit_test_framework)

message(STATUS "Boost Version:" ${Boost_VERSION})
message(STATUS "Boost Include Dirs:" ${Boost_INCLUDE_DIR})
message(STATUS "Boost Libraries:")
foreach(lib ${Boost_LIBRARIES})
        message(STATUS ${lib})
endforeach()

include_directories(${Boost_INCLUDE_DIR}) 
```

我在我的目标中使用`target_link_libraries`with 。`${Boost_LIBRARIES}`上面的`message`命令也显示所有找到的文件，没有任何问题。

此外，所需的库`libboost_unit_test_framework-vc110-mt-gd-1_53.lib`应按原样显示。

![库依赖项的屏幕截图](https://i.stack.imgur.com/UgPTG.png)

但是，当我构建目标之一时，我得到

```
2>LINK : fatal error LNK1104: cannot open file 'boost_unit_test_framework-vc110-mt-gd-1_53.lib' 
```

我删除了另一个 Boost 库，从错误中链接器似乎能够找到其他库。（如`chrono`或`serialization`。）但错误信息有点不同。文件名前面有*lib 。*

```
2>LINK : fatal error LNK1104: cannot open file 'libboost_serialization-vc110-mt-gd-1_53.lib' 
```

为什么 VC++ 为 unit_test_framework 寻找前缀为**boost**而不是**libboost**的文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:48:54.307

好吧，检查两件事：

*   确保文件实际存在于给定路径中，并且您具有读取权限。
*   确保将 32 位 .LIB 用于 32 位构建，将 64 位 .LIB 用于 64 位 LIB。

# json - symfony 2 仅在新的反序列化后持久化对象

> ID：15815472
> 
> 赞同：1
> 
> 时间：2013-04-04T15:28:47.110
> 
> 标签：json, symfony, merge, doctrine-orm, jmsserializerbundle

一直在用这个挠头。我有一个 symfony 2 json api，它为一个 android 应用程序提供数据。

api 序列化数据并使用 JMSSerializerBundle 将其发送到应用程序，完全没有问题。然后我使用 GSON 反序列化为本机 java 对象。

然后我的应用程序进行更改并将数据发布回 api。

我的问题是，当我反序列化从应用程序发送的 json 并尝试对其进行持久化/合并时，会在数据库中为已经存在的实体创建新对象。symfony 2 可以判断一个对象是否是新的吗？我会认为如果它有一个带有记录的 ID，它就会知道它是要更新而不是创建的。

这是我的控制器代码：

```
public function postSuggestionAction()
{

    $content = $this->get("request")->getContent();

    if (!empty($content))
    {
        $serializer = $this->get('jms_serializer');
        $suggestion = $serializer->deserialize($content, 'Calling\WebBundle\Entity\Suggestion', 'json');

        $em = $this->getDoctrine()->getManager();
        $em->persist($suggestion);
        $em->merge($suggestion->getCategory());
        $em->merge($suggestion->getNumber());
        $em->merge($suggestion->getCaller());
        $em->flush();

        $view = $this->view(true, 200);
        return $this->handleView($view);

    }

    $view = $this->view(false, 404);
    return $this->handleView($view);

} 
```

在此先感谢史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:52:46.423

**更新**

看来 EntityManager::merge() 方法确实应该有效。但是，您需要在实体的映射中使用 cascade=MERGE 或 cascade=ALL 选项。你的代码应该变成：

```
public function postSuggestionAction()
{

    $content = $this->get("request")->getContent();

    if (!empty($content))
    {
        $serializer = $this->get('jms_serializer');
        $detachedSggestion = $serializer->deserialize($content, 'Calling\WebBundle\Entity\Suggestion', 'json');

        $em = $this->getDoctrine()->getManager();
        $suggestion = $em->merge($detachedSuggestion);
        $em->flush();

        $view = $this->view(true, 200);
        return $this->handleView($view);

    }

    $view = $this->view(false, 404);
    return $this->handleView($view);

} 
```

**原始答案** 不，除了基于区分（唯一）列查询实体的 Doctrine 之外，没有其他办法。最好的方法是从 JSON 中获取 ID，但如果不这样做，则需要有一种方法来比较实体以查看它们是否相等。然后，您可以从数据库中查询它。

你的逻辑是：

*   在数据库中搜索对象（`SELECT s FROM Suggestion WHERE s.id = :id`; 如果你有 id）
*   返回对象或 null ; 如果为空，请保留您的逻辑，否则将您的 JSON 更改反映到您的对象，然后持久保存。

# python - 使用 Selenium WebDriver 直接操作剪贴板

> ID：15815475
> 
> 赞同：2
> 
> 时间：2013-04-04T15:28:54.800
> 
> 标签：python, selenium, selenium-webdriver

是否可以使用 Selenium WebDriver 使用一些要粘贴的文本预先填充剪贴板，就好像文本已在另一个应用程序中复制一样？（理想情况下使用 Python 绑定？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T17:03:41.820

不，似乎不是——作为**浏览器**操作工具，Selenium 旨在执行浏览器独有的功能。**通常，剪贴板操作是由文件管理器**处理的一项功能，通常包括一个 GUI，例如 Windows Explorer 或 Mac OS Finder。

各种 Selenium 接口（Java、Python 等）有*多种方法可以访问剪贴板功能，但这些方法仅在相关浏览器在包含它们的上下文中运行时才有效。*如果 Selenium 无头运行（意味着没有 GUI，例如使用虚拟显示器，例如[Xvfb](http://en.wikipedia.org/wiki/Xvfb)，可能作为虚拟机的一部分），则可能没有任何可访问的剪贴板功能上下文，并且 Selenium 本身不提供任何上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-12T05:31:47.770

您可以“预先填充”剪贴板的一种技巧是执行用户将其复制到剪贴板中所采取的步骤。

一种方法（假设您有一些要复制的文本）是打开一个包含文本的 url，在正文具有焦点时按“ctrl-a”键，然后按“ctrl-c”键

```
driver.findElements(By.tagname("body")).type(Keys.chord(keys.control, 'a'));
driver.findElements(By.tagname("body")).type(Keys.chord(keys.control, 'c')); 
```

您可能必须在每个步骤之间休眠，以便操作系统有时间实际执行复制操作 - 我发现有时硒运行得太快。

# excel - 如何在 ClosedXML 中创建数据透视表的示例

> ID：15815476
> 
> 赞同：2
> 
> 时间：2013-04-04T15:28:55.687
> 
> 标签：excel, pivot-table, closedxml

我们使用 ClosedXML 生成 .XLSX 电子表格，因为它小巧、灵活且快速。似乎所有的数据透视表类和方法都在 API 中，但是没有关于如何（以正确的顺序）创建数据透视表的文档或示例。我们的猜测尝试产生的文件在打开时会给出有关 XML 损坏的错误，并且 Excel 会提示您删除数据透视表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-07T19:30:04.787

我不确定[ClosedXML](https://closedxml.codeplex.com/)在哪个版本中实现了数据透视表，但至少从 v0.70 开始，它们已经实现。可以在[ClosedXML 文档](https://closedxml.codeplex.com/documentation)中找到一个[示例](https://closedxml.codeplex.com/wikipage?title=Pivot%20Table%20example)。下面是我在自己的项目中使用的 C# 示例。

```
IXLWorksheet xlPvSheet = xlBook.Worksheets.Add("Pivot");
IXLPivotTable xlPvTable = xlPvSheet.PivotTables.AddNew("PivotTable", xlPvSheet.Cell(1,1), xlForecastSheet.Range(1, 1, r, 11));
xlPvTable.RowLabels.Add("Box Type");
xlPvTable.RowLabels.Add("Box Color");
xlPvTable.ColumnLabels.Add("Request Date");
xlPvTable.Values.Add("Total Boxes"); 
```

# performance - 缓存 WCF 方法 .NET 3.5

> ID：15815478
> 
> 赞同：2
> 
> 时间：2013-04-04T15:28:58.717
> 
> 标签：performance, wcf, .net-3.5

我面临一个问题，想知道是否有任何解决方案可以克服这个问题。该应用程序是在 .NET 3.5 中开发的 WCF 服务。

假设它有 5 个功能：A、B、C、D 和 E。

现在，如果我继续使用 .NET 客户端调用函数 A，第一次调用它需要时间，但所有连续调用需要的时间要少得多。

但是，如果我以随机顺序调用函数，而不是连续调用每个函数，比如 A 然后 B 然后 C 然后 A 然后 C 然后 D，所有函数调用都需要更长的时间。

有什么办法可以克服这个吗？就像，我的意思是最后调用的函数是否被缓存或其他东西，所以连续调用需要更少的时间或类似的东西？可以在 web.config 中设置任何内容吗？

# c# - 避免在wpf中多次绑定进度条

> ID：15815484
> 
> 赞同：0
> 
> 时间：2013-04-04T15:29:21.243
> 
> 标签：c#, wpf, progress-bar

有一种情况，我必须将进度条值与类的属性绑定。但是，该类有多个实例，我不想多次设置 DataContext。有什么办法吗？

不想在循环中有这个语句：

```
 progressBarCurrent.DataContext = object; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:44:02.293

如果您必须重新绑定或重新设置 UI 元素上的数据上下文，您可能只是缺少`INotifyPropertyChanged`对其中一个 VM 上某些属性的实现。

而不是`ProgressBar`直接将数据上下文设置为对象，您应该将数据**上下文绑定**到 ViewModel上`ProgressBar`的属性，然后每当您重新初始化对象时，您只需设置该属性，您应该引发一个`PropertyChanged`事件并且`ProgressBar`将自动更新其 DataContext。

# android - 安卓通知管理

> ID：15815486
> 
> 赞同：0
> 
> 时间：2013-04-04T15:29:22.053
> 
> 标签：android

有没有人知道管理图标显示在通知栏中的android类的名称？我不是在谈论在通知栏中添加图标，我想要在通知栏中显示已添加图标的图标。我的问题如下：在通知栏中，只能显示 9 个图标。当我们有超过 9 个图标时，例如我们有 11 个图标，通知栏中显示 8 个图标，并且会显示一个包含 3 个的通知覆盖图标。我的问题是当我有 10 个图标时，覆盖图标不显示，并且第 10 个图标。

谢谢

# python - 多处理无法更新 GUI

> ID：15815491
> 
> 赞同：0
> 
> 时间：2013-04-04T15:29:32.353
> 
> 标签：python, multithreading, qt, user-interface, multiprocessing

我想知道是否有人对为什么以下 PyQt 信号/插槽设置会起作用有任何想法，而添加多处理会导致 GUI 不更新。在这两种情况下都会发送信号，但信号/插槽可以更新 GUI，而多处理布局则不能。

这是我拥有的一般设置：对于 PyQt 信号和插槽，我有这个，它有效：

```
# signals and slots 
class Worker(QObject):
    ...
    # send signals in for loop to tab
    ...

class Tab(QTabWidget):
    ...
    # start thread
    ...
    # get signals and update GUI

class MainWindow:
    ...
    # make GUI stuff
    ...
    # start worker process 
```

虽然这个多处理代码没有：

```
# signals and slots *with multiprocessing*
class Worker(QObject):
    ...
    # send messages down a pipe in for loop to tab
    ...
class Worker_thread(QThread):
    ...
    # start process
    ...
    # get messages from Worker and send signals to update GUI function in Tab

class Tab(QTabWidget):
    ...
    # start Worker_Thread
    ...
    # get signals and update GUI

class MainWindow:
    ...
    # make GUI stuff
    ...
    # start Worker_thread process 
```

这是从 Worker 获取消息并发送信号以在多处理情况下更新 GUI 的函数：

```
@QtCore.pyqtSlot()
def start_computation(self):
    self.process.start()
    while(True):
        try:
            message = self.consumer.recv()
            self.update_signal.emit(message)
        except EOFError:
            pass
        if message == 'done with processing':
            self.done_signal.emit()
            break
        #self.parent.update_GUI(message)
    self.process.join()
    return 
```

我需要关闭这里的`Pipe`某个地方吗？它必须不断地阅读进程以了解它的进度并始终更新 GUI，所以我不知道这在哪里是合适的。

此外，这里有一些完整的代码示例：

[多处理 GUI 模式以对抗“无响应”阻塞](https://stackoverflow.com/questions/15698251/weird-behavior-gui-not-responding)

和这里：

[https://stackoverflow.com/questions/15754826/gui-not-responding-general-multithreading-and-multprocessing-architecture?lq=1](https://stackoverflow.com/questions/15754826/gui-not-responding-general-multithreading-and-multprocessing-architecture?lq=1)

任何帮助深表感谢。

# java - PrimeFaces SelectOneMenu：空字符串提交为空

> ID：15815499
> 
> 赞同：1
> 
> 时间：2013-04-04T15:29:59.503
> 
> 标签：java, jsf, primefaces

**web.xml**

```
[...]
<context-param>
    <param-name>javax.faces.INTERPRET_EMPTY_STRING_SUBMITTED_VALUES_AS_NULL</param-name>
    <param-value>false</param-value>
</context-param>
[...] 
```

**视图.xhtml**

```
[...]
<p:selectOneMenu id="input1" value="#{myBean.value1}">
    <f:selectItem itemValue="" itemLabel="..." />
</p:selectOneMenu>

<p:inputText id="input2" value="#{myBean.value2}" />
[...] 
```

**MyBean.java**

```
[...]
private String value1;
private String value2;
[...] 
```

我`input2`留空，提交表单并检查托管 bean 中的值：

*   `value2`是一个空字符串 - 正如预期的那样！
*   `value1`一片空白

为什么是`value1`null 而不是空字符串？如果我希望该值是一个空字符串，我该如何实现呢？

**更新** “问题”在课堂上`com.sun.faces.renderkit.html_basic.MenuRenderer`：

```
public Object getConvertedValue(...) {
    [...]
    if (RIConstants.NO_VALUE.equals(newValue)) {
        return null;
    }
    [...]
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T04:53:20.853

您可以检查此[JSF 2 - Bean Validation: validation failed -> 空值被托管 bean 中的最后一个有效值替换。](https://stackoverflow.com/questions/3933786/jsf-2-bean-validation-validation-failed-empty-values-are-replaced-with-las)

如果要将其设置`value1`为空字符串，则可以使用此代码。

```
public Object getSubmittedValue() {
if (submittedValue == null && !isValid() && considerEmptyStringNull(FacesContext.getCurrentInstance())) {
    return "";
}
else {
    return submittedValue;
} 
```

}

# ruby - 是否可以在这里使用标准断言而不是模拟期望？

> ID：15815505
> 
> 赞同：2
> 
> 时间：2013-04-04T15:30:08.090
> 
> 标签：ruby, rspec, mocking, stubbing

我正在为 Delayed::Job 开发一个自定义作业类，以便我可以观察作业的运行以及它们的各种生命周期事件。在这种特殊情况下，我对它们何时完成感兴趣，以便我可以维护正在运行的作业的明确顺序。

生产代码：

```
class ObservableJob
  def self.new_with_listener(listener)
    job = ObservableJob.new
    job.add_listener(listener)
    job
  end

  def success
    notify_listeners(:on_success)
  end

  def add_listener(listener)
    (@listeners ||= []) << listener
  end

  def notify_listeners(event_name, *args)
    @listeners && @listeners.each do |listener|
      if listener.respond_to?(event_name)
        listener.public_send(event_name, self, *args)
      end
    end
  end
end 
```

测试代码：

```
describe ObservableJob do
  it "provides notification on job success" do
    notifier = stub{:on_success}
    notifier.should_receive(:on_success)
    ObservableJob.new_with_listener(notifier).success
  end
end 
```

我目前正在使用模拟期望来确保正确回调我的侦听器对象。这工作正常。然而，我更喜欢我的测试有明确的断言，而不是依赖于隐含的模拟期望。是否可以在这里使用显式断言？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T19:51:51.053

在对此进行了更多研究之后，在这种情况下不可能使用显式断言。

# c# - javascript返回页面

> ID：15815510
> 
> 赞同：1
> 
> 时间：2013-04-04T15:30:28.997
> 
> 标签：c#, javascript, asp.net, asp.net-mvc

目前我正在使用下面的代码。这目前有效，但说用户留下需要填写的信息并单击确认，因为它重定向到同一页面并显示错误。但是如果他们此时按下取消按钮，那么用户会返回到他填写的上一个表单，如果他然后在该页面上按下取消返回到初始页面，我将如何使用这种方法来选择它有的第一页，而不是前一页？

```
javascript:history.back() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:34:03.780

您可以使用 go() 方法返回两次，或者以显示页面的任何错误都不会创建历史条目的方式操作浏览器历史记录。您必须计算要忽略呼叫的页面数

```
window.history.go(-3); 
```

见这里： [https ://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:52:33.653

我手头没有任何代码，但我发现最好将初始位置存储在隐藏字段或 cookie 中，然后使用 DJ KRAZE 的建议。这样，您就可以完全控制您打算在哪里发生错误或取消或其他任何事情。

# sql-server - 如何将“可用数据库”设置为您正在使用的默认数据库？

> ID：15815511
> 
> 赞同：2
> 
> 时间：2013-04-04T15:30:31.703
> 
> 标签：sql-server, sql-server-2012, ssms

有没有办法将 SQL Server 2012 工具栏下拉框中的“可用数据库”设置为您正在使用的默认数据库？

我知道您可以在查询中使用以下内容：

```
USE databasename
GO 
```

或者

*只需在下拉框中选择正确的数据库，*

一切都会好起来的，但有时如果我想运行快速查询并跳过（忘记）那些步骤，它指的是“主”并且查询失败。

有办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:41:46.490

您是否查看过用户的默认数据库？在 SQL Server 的用户中，您可以设置您的用户默认数据库。

连接到服务器后，在 SSMS 中：

*   在安全/登录下，您应该看到您的用户或 Windows 组
*   右键单击用户并选择属性。
*   在 General 页面下选择您的默认数据库（见下图）：
*   点击保存

[![在此处输入图像描述](https://i.stack.imgur.com/Srkng.png)](https://i.stack.imgur.com/Srkng.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:30:56.753

如果您在对象资源管理器中展开数据库部分，选择要查询的数据库，然后单击“新建查询”按钮，它将自动将数据库设置为您选择的数据库。

但是，如果您在对象资源管理器中右键单击一个对象并选择前 1000 个等，它将自动使用主数据库并通过 3 部分名称引用您正在使用的数据库，这可能有点烦人。

# ios - 桌面与 iPad 上的悬停行为

> ID：15815513
> 
> 赞同：2
> 
> 时间：2013-04-04T15:30:39.043
> 
> 标签：ios, ipad, css, hover

我已经构建了一个使用纯 CSS 和`:hover`伪类来显示菜单的菜单。我在 iPad 上测试了这种行为，发现悬停并没有消失——即使点击其他地方也没有。

我已经在互联网上搜索了解决方案，但找不到任何有用的东西。

当我在 iPad 上单击页面上的其他位置时，有没有办法让悬停消失？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T17:05:47.363

## 避免依赖 :hover

依赖`:hover`限制了移动设备上的选项。JavaScript 或 jQuery 无法关闭`:hover`元素的状态。

作为替代方案，您可以`.hover`使用鼠标事件和触摸事件的组合来添加和删除一个类。如有必要，如果您检测到对触摸事件的支持，请不要添加鼠标事件。

这是一个带有两个悬停菜单的[JSFiddle 演示。](http://jsfiddle.net/FxCmy/)要在移动设备上运行它，请使用这个[独立版本的演示](http://fiddle.jshell.net/FxCmy/show/)。第一个菜单使用`:hover`伪元素，第二个使用`.hover`类。

在桌面浏览器上，这两个菜单的行为相同。但是对于触摸设备，@ErwaySoftware 的建议适用于第二个菜单：如果您在触摸设备上再次触摸菜单项，下拉菜单就会消失。当然，这仅适用于菜单项本身不是功能超链接（如果它的唯一目的是打开下拉菜单）。

**jQuery**

```
// Mouse events
$('.menu > li').on('mouseover', function(){
    $(this).addClass('hover');
});
$('.menu > li').on('mouseout', function(){
    $(this).removeClass('hover');
});

// Touch events
$('.menu > li > a').on('touchend', function(){
    $(this).parent().toggleClass('hover');
}); 
```

在继续使用任何解决方案之前，请务必在 Android 上进行测试。

## 移动优先

最简洁和最简单的方法可能是在支持移动设备时避免依赖悬停状态，而是依赖点击/触摸来使菜单出现和消失。换句话说，首先为移动构建，然后弄清楚如何让它在桌面浏览器上工作（而不是相反）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-24T07:20:29.363

我知道另一种方法（但我不认为它更好）。

要启用 css .hover 效果，您应该向元素添加空的 onclick：

```
<div class="hoverable" onclick="">...</div> 
```

悬停效果在您触摸元素时会起作用，但在您按住它时不起作用。而且我没有在安卓设备上测试它。但它适用于 ipad（移动 chrome 和 safari）。

PS 另外，我建议您在下面为所有元素添加 css 样式，用户可以触摸或按住：

```
-webkit-user-select: none; 
```

此选项关闭带有元素的剪切/复制/粘贴对话框。并且不要将它用于所有文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-28T13:22:37.347

这是我在下面的工作。我正在添加类 'clicked'，它具有按钮原始类的样式，但也附加了 !important ......（见下文）。

```
$('#your_button').click(function()
{
    // Removing the old class if there was one
    $(this).removeClass('clicked');
    // Adding clicked class
    $(this).addClass('clicked');
    // DO THE REST OF YOUR BUTTON CODE HERE
    return false;
});

#your_button{ background: #ff0000; color:#fff } 
#your_button:hover{ background: #88888; color:#fff } 
#your_button.clicked{ background: #ff0000 !important; color:#fff !important; } 
```

# google-chrome - RecorderJS 不再工作

> ID：15815514
> 
> 赞同：0
> 
> 时间：2013-04-04T15:30:41.257
> 
> 标签：google-chrome, web-audio-api, recorder.js

我尝试在`getUserMedia`. 一个月前这段代码有效，但现在我遇到了一些麻烦。`onaudioprocess`执行in时`recorder.js`，数组缓冲区仅包含 0。

我将此代码回调用于使用`Recorder`对象。

```
function gotStream(stream) {
    inputPoint = audioContext.createGain();

    // Create an AudioNode from the stream.
    realAudioInput = audioContext.createMediaStreamSource(stream);
    audioInput = realAudioInput;
    audioInput.connect(inputPoint);

    recorder = new Recorder(inputPoint);
} 
```

我认为 Chrome 已经改变了一些东西。有人有什么建议可以给我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:13:54.887

是`createGainNode`，不是`createGain`。

# django - Django-CMS 中的多种语言方言

> ID：15815516
> 
> 赞同：3
> 
> 时间：2013-04-04T15:30:49.733
> 
> 标签：django, django-cms

总之，我正在尝试创建一个多语言网站，该网站必须支持（除其他外）美式英语和英式英语。

我的设置包含：

```
LANGUAGES = (
    ('de', u'Deutsch'),
    ('en_GB', u'English (UK)'),
    ('en', u'English (US)'),
    ('es', u'Español'),
    ('fr', u'Français'),
    ('pt', u'Português'),
) 
```

所有其他语言都可以正常工作；用户可以切换语言并且一切正常。问题是en_GB。

我尝试将上述配置更改为“en-GB”、“en-gb”或“en_gb”，但行为没有任何变化。

中间件似乎只支持语言路径的前两个字母？如何正确支持基础语言的多种方言？这很容易是 es-US、es-MX、es-ES 或 fr-FR、fr-CA 或 de-DE、de-AT、de-CH 等。

我在 Python 2.7.2 上的 Django 1.4.5 上使用 Django-CMS 2.3.5（这是撰写本文时的最新生产版本）。

更新：我现在似乎可以正常工作了。我认为有两件事阻碍了我的进步。1) 说到英语，最好不要将一个作为“en”，另一个作为“en-gb”。2) 在我所有的实验中，我怀疑我弄乱了 Django-CMS 在数据库中的记录。删除我所有的页面并重新开始似乎已经解决了这个问题（注意：这在生产环境中比在这里更糟糕！）

最后，我发现这些设置对我有用：

```
LANGUAGE_CODE = 'en-us'

LANGUAGES = (
    ('en-us', u'English (US)'),
    ('de', u'Deutsch'),
    ('en-gb', u'English (UK)'),
    ('es', u'Español'),
    ('fr', u'Français'),
    ('pt', u'Português'),
)

CMS_LANGUAGES = LANGUAGES

CMS_LANGUAGE_CONF = {
    'de': ['en-gb', 'en-us', 'fr', 'es', 'pt'],
    'en-gb': ['en-us', 'fr', 'es', 'de', 'pt'],
    'en-us': ['en-gb', 'fr', 'es', 'de', 'pt'],
    'es': ['pt', 'fr', 'en-gb', 'en-us', 'de'],
    'fr': ['es', 'pt', 'en-gb', 'en-us', 'de'],
    'pt': ['es', 'fr', 'en-gb', 'en-us', 'de'],
}

CMS_HIDE_UNTRANSLATED = False 
```

此外，显然 Django-CMS 的模板标签 page_language_url 只会返回小写语言路径元素，因此 en_GB/en-GB 可能在一个级别上工作，但 UI 将因此无法匹配所选语言。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-02T16:38:42.580

[Django I18N Docs](https://docs.djangoproject.com/en/1.6/topics/i18n/)解释了两个代码，如下所示。**en_GB**是**英国（英国）** *语言环境*。**en-CA**是*在加拿大使用的英语*。

1.  **语言环境名称**有*下划线*
2.  **language_name**有*破折号*或*连字符*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-24T07:31:04.650

# 我认为这是顺序问题，语言必须高于语言代码。你能在下面试试这个吗？

```
LANGUAGES = (
        ('en-us', u'English (US)'),
        ('de', u'Deutsch'),
        ('en-gb', u'English (UK)'),
        ('es', u'Español'),
        ('fr', u'Français'),
        ('pt', u'Português'),
    )    

 LANGUAGE_CODE = 'en-us' 
```

# java - 如何将 PrimeFaces SelectOneMenu ItemLabel 和 ItemValue 与列表一起使用？

> ID：15815517
> 
> 赞同：2
> 
> 时间：2013-04-04T15:30:50.420
> 
> 标签：java, jsf, primefaces

据我所知，在 SelectOneMenu 中显示信息的正确方法是拥有一个对象列表并使用它的属性，如下所示：

```
<p:selectOneMenu id="player" value="">  
    <f:selectItem itemLabel="Select" itemValue="" />  
    <f:selectItems value="#{players}"
       var="player"
       itemLabel="#{player.name}"
       itemValue="#{player.id}"/> 
</p:selectOneMenu> 
```

但是如果我没有球员名单怎么办，如果我有这样的东西怎么办？我想让它像这样工作：

```
//PlayerManager
public List<String> getPlayerNames() {
    String[] names = new String[] {"player1", "player2"};
    return Arrays.asList(names);
}

public List<String> getPlayerIds() {
   String[] ids = new String[] {"1", "2"};
   return Arrays.asList(ids);
}

<p:selectOneMenu id="player" value="">  
    <f:selectItem itemLabel="Select" itemValue="" />  
    <f:selectItems value="#{playerManager.playerNames}"
       var="player"
       itemLabel="#{playerManager.playerNames}"
       itemValue="#{playerManager.playerIds}"/> 
</p:selectOneMenu> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T15:45:52.137

用于`<c:forEach>`生成`<f:selectItem>`组件。你可以使用它的`varStatus`属性来获取当前的迭代索引，这样就可以通过索引来获取其他列表的一个项目。

```
<c:forEach items="#{playerManager.playerIds}" var="playerId" varStatus="loop">
    <f:selectItem itemValue="#{playerId}" itemLabel="#{playerManager.playerNames[loop.index]}" />
</c:forEach> 
```

请注意，当`#{playerManager}`是视图范围时，此构造将在每次回发时重新创建 bean。另请参阅[JSF2 Facelets 中的 JSTL... 有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense/3343681#3343681)

# unix - 如果没有使用 awk 进行转义，则使用字段分隔符

> ID：15815519
> 
> 赞同：1
> 
> 时间：2013-04-04T15:30:52.440
> 
> 标签：unix, awk

我有一个问题，假设我使用“=”作为字段分隔符，在这种情况下，如果我的字符串包含例如

```
abc=def\=jkl 
```

所以如果我使用 = 作为字段分隔符，它将分成 3 为

```
abc def\ jkl 
```

但是因为我已经逃脱了第二个 "=" ，所以我的输出应该是

```
abc def\=jkl 
```

如果我能做到这一点，任何人都可以给我任何建议。提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:55:18.510

我发现将有问题的字符串转换为不出现在输入记录中的其他字符串或字符最简单（如果它不是正则表达式*，我倾向于使用 RS，因为它不能出现在记录中，或者 awk 内置 SUBSEP否则，因为如果出现在您的输入中，您还有其他问题）然后正常处理，而不是在必要时在每个字段中转换回来，例如：

```
$ cat file
abc=def\=jkl

$ awk -F= '{
   gsub(/\\=/,RS)
   for (i=1; i<=NF; i++) {
      gsub(RS,"\\=",$i)
      print i":"$i
   }
}' file
1:abc
2:def\=jkl 
```

* 如果 RS 是 RE（即多个字符），则使用 RS 的问题是循环中的 gsub(RS...) 可能会匹配最初未解析为记录分隔符的字符串，例如

```
$ echo "aa" | gawk -v RS='a$' '{gsub(RS,"foo",$1); print "$1=<"$1">"}'
$1=<afoo> 
```

当 RS 是单个字符时，例如默认换行符，这是不可能发生的，因此可以安全使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:49:03.093

如果它就像您问题中的示例，则可以完成。

awk 不支持环视正则表达式。所以通过设置来获得你想要的东西会有点困难`FS`。

如果我是你，我会做一些预处理，让数据更容易被 awk 处理。或者您可以阅读该行，并通过 awk 使用其他功能，例如`gensub()`删除那些`=`您不想在结果中出现的 s，并且`split`...但我想您想通过 play 来实现目标`field separator`，所以我只是不t 给出这些解决方案。

但是它可以通过`FPAT`变量来完成。

```
awk -vFPAT='\\w*(\\\\=)?\\w*' '...' file 
```

这将适用于您的示例。我不确定它是否适用于您的真实数据。

让我们举个例子，分割这个字符串：`"abc=def\=jkl=foo\=bar=baz"`

```
kent$  echo "abc=def\=jkl=foo\=bar=baz"|awk -vFPAT='\\w*(\\\\=)?\\w*' '{for(i=1;i<=NF;i++)print $i}'
abc
def\=jkl
foo\=bar
baz 
```

我想你想要那个结果，不是吗？

我的 awk 版本：

```
kent$  awk --version|head -1
GNU Awk 4.0.2 
```

# php - 在 PHP 中正确解析函数的返回语句

> ID：15815520
> 
> 赞同：1
> 
> 时间：2013-04-04T15:30:56.710
> 
> 标签：php, if-statement, user-defined-functions

我有一个可以返回 true 的函数；返回“空”；返回'only_site'；并返回“only_user”；

所以有4种可能的回报。在本声明中：

```
if(parse_ratings($user_rating, $st_rating, $rating_id) === 'empty') 
{
     $errors[] = 'Neither user_rating, nor site_rating cpule be spidered.'; 
}

     elseif(parse_ratings($user_rating, $st_rating, $rating_id) === 'only_site')           
         $errors[] = 'Only site rating was spidered';

 elseif(parse_ratings($user_rating, $st_rating, $rating_id) === 'only_user')      
         $errors[] = 'Only user rating was spidered'; 
```

if() 是否记住函数第一次运行时的输出，还是每次有 if() 时都会运行？

假设，脚本通过函数解析，第一个 IF 语句是否定的；然后它是否再次运行该函数以查看第二个 IF 是否也是负数，或者它是否记得第一次运行时的返回值。

我想知道这一点，因为我希望它在大多数情况下都是正确的，并且不希望该函数被连续调用 4 次。

希望这是有道理的。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:54:59.307

语句中的代码`if()`每次都会执行，让 PHP “记住”该值的唯一方法是使用变量：

```
$rating = parse_ratings($user_rating, $st_rating, $rating_id);
if($rating === 'empty') {
    $errors[] = 'Neither user_rating, nor site_rating cpule be spidered.'; 
} elseif($rating === 'only_site') {
    $errors[] = 'Only site rating was spidered';
} elseif($rating === 'only_user') }
    $errors[] = 'Only user rating was spidered';
} 
```

或者，您可以使用以下[`switch()`](http://www.php.net/manual/en/control-structures.switch.php)语句：

```
switch(parse_ratings($user_rating, $st_rating, $rating_id)) {
    case 'emtpy':
        $errors[] = 'Neither user_rating, nor site_rating cpule be spidered.'; 
        break;
    case 'only_site':
        $errors[] = 'Only site rating was spidered';
        break;
    case 'only_user':
        $errors[] = 'Only user rating was spidered';
        break;
    case true:
        break;
    default:
        $errors[] = 'An unhandle value was returned';
        break;
} 
```

# kendo-grid - kendoGrid 弹出编辑取消按钮删除现有行

> ID：15815521
> 
> 赞同：1
> 
> 时间：2013-04-04T15:31:00.657
> 
> 标签：kendo-grid

我已经查看了这个问题的其他答案，但没有一个能解决这个问题。在 kendoGrid 上使用弹出编辑器时，取消会完全删除该行。这是代码：

```
addWindow.element.find("#InventoryChecks").kendoGrid({
                               dataSource: {
                                        data: checkCallDetail.InventoryChecks,
                                        schema: {
                                            model: {
                                                id: "Id",
                                                fields: {
                                                    Id: { type: "number" },
                                                    BillOfLading: { type: "string" },
                                                    ReportedPieces: { type: "number" },
                                                    ReportedWeight: { type: "number" }

                                                }
                                            }
                                        },
                                        aggregate: [ 
                                            { field: "ReportedPieces", aggregate:"sum" },
                                            { field: "ReportedWeight", aggregate: "sum" }]
                                    },
                                    height: 200,
                                    scrollable: true,
                                    toolbar: ["create"], 
                                    columns: [
                                        { field: "BillOfLading", title: "BOL", width: "100px", footerTemplate: "Total: " },
                                        { field: "ReportedPieces", title: "Quantity", width: "70px", footerTemplate: " #= sum # " },
                                        { field: "ReportedWeight", title: "Weight", width: "70px", footerTemplate: " #= sum # " },
                                        { command: ["edit"], title: "&nbsp;"}
                                    ],
                                    editable: {
                                        mode: "popup",

                                    }
                                }) 
```

有什么建议么？

# ruby-on-rails-3 - Ruby on Rails - CanCan 用户在销毁操作期间为零

> ID：15815522
> 
> 赞同：0
> 
> 时间：2013-04-04T15:31:03.023
> 
> 标签：ruby-on-rails-3, devise, cancan

我正在使用连接到我的第一个 Ruby on Rails 应用程序的设计来获得 cancan。我有一些工作，但我遇到了一个我的新手大脑似乎无法理解的问题。

我正在尝试删除项目模型。cancan ability.initialize 调用不起作用，因为即使我已登录并且其他调用已成功授权，用户仍以 nil 传递

在我的节目视图中，我有这个链接：

```
<%= link_to "Purge this project", @project, method: :delete, data: {confirm: "There is no way to get it back. Are you sure you want to permanently remove this project?"} %> 
```

我认为我的控制器已正确连接，其他操作已正确授权

```
class ProjectsController < ApplicationController
  load_and_authorize_resource
  ...
  def destroy
    puts "***********removing: " + params.inspect 
    @project.destroy
    ...
  end 
```

我的 cancan 初始化是这样做的：

```
 def initialize(user)
    user ||= User.new # guest user
    puts "********  Evaluating cancan permissions for: " + user.inspect
    ... 
```

当我点击上面的删除链接时，这会被放到控制台（注意 user.id 是如何为零的，这是因为如果用户为零，我设置了来宾）

```
********  Evaluating cancan permissions for: #<User id: nil, email: ""...
Started DELETE "/projects/16" for 127.0.0.1 at 2013-04-04 10:48:23 -0400
Processing by ProjectsController#destroy as HTML
  Parameters: {"id"=>"16"}
WARNING: Can't verify CSRF token authenticity 
```

问题：为什么用户是零？？？是否与 CSRF 代币问题有关？我错过了关于 http method=delete 的特别之处吗？我怎样才能阻止哑巴，它很痛？

前面的“显示”动作产生了这个预期的放置（结论的东西应该充分连接）：

```
********  Evaluating cancan permissions for: #<User id: 2, email: "doug... 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:00:44.750

自我回答警告！所以，我想删除操作需要在表单帖子中发生，以便正确处理身份和 CSRF 内容？！？

用表单替换我的链接使事情再次起作用：

```
<%= form_for @project, :method => :delete do  %>   
  <%= submit_tag "Purge this project", confirm: "Are you sure you want to permanently remove this project?" %> 
<% end %> 
```

# javascript - 原型 JS：按值选择元素？

> ID：15815527
> 
> 赞同：2
> 
> 时间：2013-04-04T15:31:23.727
> 
> 标签：javascript, prototypejs, selector

我有一个具有唯一值的输入类型收音机。是否可以使用 Prototype JS 通过其唯一值 (147178) 选择该单选按钮？那是单选按钮：

```
<input type="radio" class="radio validate-nothing product-custom-option" value="147178"> 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:33:05.870

我有一段时间没有使用 Prototype JS 了，但这*应该*可以：

```
$$('input[type="radio"][value="147178"]') 
```

# android - 在 Eclipse（本地主机）上调试 Android（客户端 - 在物理智能手机设备中）和 tomcat（服务器）

> ID：15815528
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:31:29.830
> 
> 标签：android, eclipse, debugging, tomcat, client-server

如何在 Eclipse（本地主机）上调试 Android 应用程序（在物理智能手机设备而非模拟器中）和 tomcat（服务器）。

语境：

Android 应用程序（例如登录）指向 localhost 中的 tomcat 服务器应用程序。

对于使用模拟器进行开发调试工作正常，因为 Android 在另一个子网上运行并为自己保留 127.0.0.1，计算机的 localhost ip 更改为 10.0.2.2 ...

但是，当我尝试使用通过 USB 连接到我的 PC 的物理智能手机时，我可以调试 android 应用程序，但是来自智能手机的请求没有使用 localhost:8080/... 或 127.0.0.1 在 localhost 上调用我的 tomcat :8080/... 手机正在尝试连接到互联网，而不是子网。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:29:15.140

仅使用我的内网 ip 192.168.2.1:8080/...

# asp.net-mvc - 实体框架没有返回正确的数据。它正在重复来自单个记录的数据

> ID：15815533
> 
> 赞同：0
> 
> 时间：2013-04-04T15:31:49.237
> 
> 标签：asp.net-mvc, entity-framework-5

首先使用带有 EF 代码的 MVC 4。在执行 linq to EF 选择语句时，集合中填充了看起来像是最后一条记录的数据。更奇怪的是，只有一些属性重复，而其他属性没有。最好通过示例向您展示：

使用此查询返回正确的数据：

```
var orders = db.Orders.ToList(); 
```

OrderID OrderTotal 名称

1 215.00 鲍勃

2 415.00 马克

3 315.50 拉尔夫

当我通过外键订阅者 ID 过滤订单实体时，如下所示：

```
var orders = db.Orders.Where(s => s.SubscriberId == 2).ToList(); 
```

数据最终看起来像这样：

1 315.50 鲍勃

2 315.50 马克

3 315.50 拉尔夫

请注意 OrderTotal 是如何重复的，但名称保持不变。请注意，这不是视图问题。当我在控制器中调试时查看集合中的数据时，这就是我所看到的。这似乎不是唯一发生这种情况的地方。我在更复杂的模型中看到了类似的东西——但我想我会从最简单的样本开始。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T17:02:30.150

问题是我在模型上设置默认值时引起的。显然使用静态是不正确的。所以：

[ReadOnly(true)] [Display(Name = "Sub total")] private **static** decimal _OrderSubTotal = 0; 公共小数 OrderSubTotal { get { return _OrderSubTotal; } 设置 { _OrderSubTotal = 值；} }

应该写成

[ReadOnly(true)] [Display(Name = "Sub total")] private decimal _OrderSubTotal = 0; 公共小数 OrderSubTotal { get { return _OrderSubTotal; } 设置 { _OrderSubTotal = 值；} }

# objective-c - Objective-C - 遍历所有已安装的应用程序

> ID：15815535
> 
> 赞同：0
> 
> 时间：2013-04-04T15:31:54.990
> 
> 标签：objective-c, macos, cocoa

我一直在尝试使用 NSWorkspace 和 fullPathForApplication 但这不能满足我的需求，因为它没有返回正确的应用程序。

我可以做：

```
[NSBundle bundleWithPath: [[NSWorkspace sharedWorkspace] fullPathForApplication: @"My Application"]]; 
```

这将返回最近安装的（我相信）：

```
/Applications/My Application
/Applications/My Application 2 
```

我希望“我的申请”被退回，但第二个被退回。我不想假设所有应用程序都安装在 /Applications/ 中，所以我不只是要遍历一个文件夹。

有谁知道我如何手动遍历所有应用程序并验证哪个是正确的？或者与 fullPathForApplication 类似的方法，它会返回所有结果，而不是随机选择一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:52:20.117

我相信您使用的 NSWorkspace 方法是一个外观[`LSFindApplicationForInfo()`](https://developer.apple.com/library/mac/documentation/Carbon/Reference/LaunchServicesReference/Reference/reference.html#//apple_ref/c/func/LSFindApplicationForInfo)，它被记录为只返回一个应用程序：

> 如果找到多个与指定特征匹配的应用程序，Launch Services 会选择一个，其方式与查找用于打开项目的首选应用程序时相同。

如果您的应用打开特定文件类型或 URL，请使用[`LSCopyApplicationURLsForURL()`](https://developer.apple.com/library/mac/documentation/Carbon/Reference/LaunchServicesReference/Reference/reference.html#//apple_ref/c/func/LSCopyApplicationURLsForURL)，它会返回匹配应用的数组。

# php - SCTP 在 PHP 文件中但在控制台中不起作用

> ID：15815536
> 
> 赞同：1
> 
> 时间：2013-04-04T15:31:59.533
> 
> 标签：php, console, exec, scp

我想将文件从一台服务器复制到另一台服务器。我使用 rsa 身份验证文件进行操作。我的代码是：

**excec("scp -C -o StrictHostKeyChecking=no -P 22 -i /data/www/htdocs/project/tmp/keydata -r /data/www/htdocs/project/data/bild1.jpg user@172.18.8.11: /data/www/htdocs/testordner/bild1.jpg")**

当我在 concole 中执行它时，它工作正常。正在将文件复制到文件夹中。但是当我在 PHP 文件中执行此操作时，它不起作用。有人可以帮助我或提示这个问题吗？谢谢！！

# sql-server-2008 - 安装快捷版时出现“未经授权的操作”错误

> ID：15815538
> 
> 赞同：0
> 
> 时间：2013-04-04T15:32:03.433
> 
> 标签：sql-server-2008, windows-7-x64

带有 Business Contact Manager 的 Microsoft Outlook 2010 在我的 Vista 笔记本电脑上工作，但笔记本电脑死机了。现在，从 11 月开始拥有 Windows 7 Ultimate x64 塔式系统。加载 Office 2010 x86 就好了，但尝试安装 BCM 时，未能安装 SQL Server Express。

所以，现在我无法安装 SQL Server 2008；引擎，即所有支持文件都安装正常。我读到如果您可以使用 安装 SQL Server 2008 `ID=MSSMLBIZ`，BCM 将跳过服务器安装，并继续安装。我读到问题可能是 Win 7 x64 上的 SQL Server x86。所以，我尝试了 SQL Server x64。每次我得到一个`Attempted to perform an unauthorized operation`.

安装总是在 step 失败`SqlBrowserConfigAction_install_ConfigNonRC_Cpu32`。因此，以管理员身份运行，从管理员登录，从管理员登录的根目录，更改安全注册表 KEY 的权限，关闭防火墙，所有建议仍然失败。

巧合的是，我有一个适用于基于 x64 的系统的 Windows 7 更新 (KB2732487) 也未能安装。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:23:42.750

我认为您的 Windows 7 安装不正确，可能是在安装 Windows 更新时。但至于

> SqlBrowserConfigAction_install_ConfigNonRC_Cpu32

我不明白： ConfigNonRC ，用微软的术语来说代表候选版本的 RC。

如果我是你，我应该试试这个：

1.  以管理员身份打开 CMD
2.  类型：“证监会 /scannow”
3.  准备好后，您的电脑可能会重新启动。
4.  现在在 CMD 键入：“sfc /verifyonly”

如果显示任何错误，请再次尝试“sfc /scannow”。

如果它没有显示任何错误，请尝试安装 Windows 更新。他们全部。

如果可行，请删除所有现有的 SQL 应用程序。并首先安装核心。

如果更新无法安装，您可以尝试重新安装我基本上不应该做的 Windows 7，只使用 MySQL。这些天来更快更可靠。

我希望这能解决您的问题！

# postgresql - 支持 PostgreSQL 的 Joomla 扩展安装

> ID：15815539
> 
> 赞同：2
> 
> 时间：2013-04-04T15:32:03.990
> 
> 标签：postgresql, joomla, joomla3.0, joomla3.1

我想用我的扩展支持 PostgreSQL，但是当我尝试安装它时遇到了问题。目前，我在安装部分的 XML 中有以下内容：

```
<install>
   <sql>
      <file driver="mysql" charset="utf8">sql/install.mysql.utf8.sql</file>
      <file driver="postgresql" charset="utf8">sql/install.postgresql.utf8.sql</file>
   </sql>
</install> 
```

这是**install.postgresql.utf8.sql**的代码：

```
CREATE TABLE "#__shoutbox" (
    "id" serial NOT NULL,
    "name" character varying(25) DEFAULT '' NOT NULL,
    "when" timestamp without time zone DEFAULT '' NOT NULL,
    "ip" character varying(15) DEFAULT '' NOT NULL,
    "msg" text NOT NULL,
    "user_id" bigint(11) DEFAULT 0 NOT NULL,
    PRIMARY KEY ("id")
);

INSERT INTO "#__shoutbox" ("name", "when", "msg", "user_id") VALUES ('JoomJunk', '2013-04-04 20:00:00', 'Welcome to the Shoutbox', '0'); 
```

我注意到 MySQL 和 PostgreSQL 的查询之间存在一些差异，我认为我已经考虑到了这些差异，但是当我尝试安装扩展时，我收到以下错误：

```
Database query failed (error # %s): %s SQL=CREATE TABLE "pdo31_shoutbox" ( "id" serial NOT NULL, "name" character varying(25) DEFAULT '' NOT NULL, "when" timestamp without time zone DEFAULT '' NOT NULL, "ip" character varying(15) DEFAULT '' NOT NULL, "msg" text NOT NULL, "user_id" bigint(11) DEFAULT 0 NOT NULL, PRIMARY KEY ("id") ); 
```

没有关于支持 PostgreSQL 进行扩展的文档，所以我通过查看 Joomla 3.1 安装文件夹中的 SQL 文件做了我能做的。

我的查询有问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:43:08.773

when 的默认值不是有效的时间戳。如果您想何时为空，请删除 NOT NULL 约束，以便它可以为 NULL。否则指定一个有效的时间戳，如“2013-4-4 12:34:56”。

postgresql 中的 Bigint 不支持大小规范。它始终是 64 位（多于 11 个十进制数字）。

```
CREATE TABLE "pdo31_shoutbox" ( 
  "id" serial NOT NULL, 
  "name" character varying(25) DEFAULT '' NOT NULL, 
  "when" timestamp without time zone, 
  "ip" character varying(15) DEFAULT '' NOT NULL, 
  "msg" text NOT NULL, 
  "user_id" bigint DEFAULT 0 NOT NULL, 
  PRIMARY KEY ("id") 
); 
```

# java - 使用默认不运行的 JavaExe 服务 Windows Java

> ID：15815541
> 
> 赞同：0
> 
> 时间：2013-04-04T15:32:15.677
> 
> 标签：java, windows, service, jar

我正在使用 JavaExe 从我的 jar 文件创建 Windows 服务。我将 javaexe.exe 重命名为“Server.exe”，其中“Server”是我唯一的 jar 文件的名称。

当我尝试运行 exe 文件时，该服务已在 Windows 上正确创建，并且在关闭会话时不会停止。但是，当我重新启动 Windows 时，该服务没有运行（我可以在 Windows 服务上看到它但没有运行）。

我想做的是**让服务在 Windows 启动时运行**……有可能吗？我想这是“.properties”文件中的东西，但我似乎找不到正确的属性......

非常感谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:04:22.643

您应该阅读文档：[**FR**](http://devwizard.free.fr/doc/JavaExe%20-%20fr.pdf)或[**ENG**](http://devwizard.free.fr/doc/JavaExe%20-%20en.pdf)

有一些方法要声明，比如**serviceGetInfo()**告诉 JavaExe 服务的启动类型，它可以停止或不停止。

[**...并查看JavaExe.zip**](http://devwizard.free.fr/download/JavaExe.zip)中的示例（3、5 和 8）[](http://devwizard.free.fr/download/JavaExe.zip)

# phpunit - ZF2 - ServiceManager & getServiceConfig 问题 - 无法获取或创建实例

> ID：15815542
> 
> 赞同：3
> 
> 时间：2013-04-04T15:32:17.260
> 
> 标签：phpunit, zend-framework2

我在尝试使用 ZF2 的身份验证服务时遇到了一些问题。我必须关注 Module.php getServiceConfig 函数：

```
<?php

public function getServiceConfig()
{
    return array(
        'factories' => array(
            'Auth\Model\CustomerTable' =>  function($sm) {
                $tableGateway = $sm->get('CustomerTableGateway');
                $table = new CustomerTable($tableGateway);
                return $table;
            },
            'CustomerTableGateway' => function($sm) {
                $dbAdapter = $sm->get('Zend\Db\Adapter\Adapter');
                $resultSetPrototype = new ResultSet();
                $resultSetPrototype->setArrayObjectPrototype(new Customer()); // prototype pattern implemented.
                return new TableGateway('customer', $dbAdapter, null, $resultSetPrototype);
            },
            'Auth\Model\AuthStorage' => function($sm){
                return new \Auth\Model\AuthStorage('jamietech');  
            },
            'AuthService' => function($sm) {
                $dbAdapter = $sm->get('Zend\Db\Adapter\Adapter');
                $dbTableAuthAdapter  = new DbTableAuthAdapter($dbAdapter, 
                                          'customer','username','password');

                $authService = new AuthenticationService();
                $authService->setAdapter($dbTableAuthAdapter);
                $authService->setStorage($sm->get('Auth\Model\AuthStorage'));

                return $authService;
            },
        ),
    );
} 
```

AuthStorage 工厂只是为我们创建了一个新的 AuthStorage 来跟踪我拥有的 rememberMe 功能，而 AuthService 工厂为我们创建了一个新的身份验证服务。我看不到我做错了什么，但是在 AuthController.php 中运行以下代码时：

```
<?php

public function loginAction()
{
    //if already login, redirect to success page 

    if ($this->getAuthService()->hasIdentity()){
        return $this->redirect()->toRoute('success');
    }

    $form = new LoginForm();
    return array(
        'form'     => $form,
        'messages' => $this->flashmessenger()->getMessages()
    );
}

public function logoutAction()
{
    $this->getSessionStorage()->forgetMe();
    $this->getAuthService()->clearIdentity();
    $this->flashmessenger()->addMessage("You have logged out successfully.");

    return $this->redirect()->toRoute('auth', array('action'=>'login'));
} 
```

PHPUnit 在运行 PHPUnit 命令时遇到以下错误：

```
1: "testLoginActionCanBeAccessed - Zend\ServiceManager\ServiceManager::get was unable to fetch or create an instance of Zend\Db\Adapter\Adapter

1: "testLogoutActionCanBeAccessed - session_regenerate_id(): cannot regenerate session id - headers already sent. 
```

运行 -process-isolation 命令时，登录和注销都会出现此错误：

```
"Serialization of closure is not allowed in: C;\Users\-----\AppData\Local\Temp\----- 
```

如果有人可以提供帮助，那就太好了。我是 ZF 菜鸟，所以尽量不要太苛刻。

编辑：顺便说一句，global.php 文件包括 ZF2 教程应用程序中说明的 service_manager 适配器工厂。

谢谢！杰米麦克劳伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:43:50.533

你检查了这些：

*   autoload_classmap.php（用于您的模块）
*   在你的**module.config.php**

像这样

```
service_manager' => array(
 'aliases' => array(    
  'mymodule-ZendDbAdapter' => 'Zend\Db\Adapter\Adapter',
  ),
); 
```

我希望它可以帮助你找到答案

# api - REST 中的建模操作

> ID：15815546
> 
> 赞同：1
> 
> 时间：2013-04-04T15:32:20.873
> 
> 标签：api, http, rest

我正在为网络设备创建一个到管理系统（我们称之为系统 A）的 REST 接口，并且一切正常。A 从另一个后端系统（我们称之为系统 B）获取设备信息并将其索引到数据库中，然后每当客户端通过 REST 接口请求信息时，它都会以 JSON 形式返回。

但是有时客户端需要通过向B请求来强制A刷新一些设备信息（除了要求A刷新它之外，不涉及客户端）。刷新单个节点的信息需要几秒钟的时间，因此信息可能不会在与请求它的请求相同的请求中返回。`POST /jobs`目前，我们已将此建模为您使用一些数据创建“刷新信息”类型的作业。但这感觉设计过度，我们宁愿想要这样的东西，`POST /equipment/<id>/refresh`但这感觉违背了“REST方式”？

除了上面提到的工作之外，还有其他解决方案但仍然遵循“REST方式”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T18:48:42.117

我会使用`GET /equipment/<id>?since=<timestamp>`，其中`since`参数是可选的。这在语义上意味着：

*   获取带有给定的设备`id`，只要它碰巧最后一次刷新（当`timestamp`没有给定时），或者
*   获取具有给定`id`刷新的设备不早于给定`timestamp`

您系统中的每个`equipment`都有一个`last_refreshed`时间戳。`GET`带`since=<timestamp>`参数会刷新设备 if然后`last_refreshed < since`返回`equipment`.

然后，您服务的用户可以说`GET /equipment/123?since=<15 minutes ago>`并确保他们始终获得不超过 15 分钟的信息。`GET /equipment/123?since=<now>`意思是“强制刷新”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:30:26.720

请记住，`POST`在 Rest 服务中意味着您将创建一些对象。

要刷新一个对象，或更新，建议使用该`PUT`方法。

就像 um CRUD 一样，当你有`Create`, `Read`, `Update`, and `Delete`, in REST 将是`POST`, `GET`, `PUT`, `DELETE`（按顺序）。

也许在您的情况下，最好的 URL 是`PUT`to `/equipment/<id>`。

网址：

`POST to /equipment/`: 创建设备

`GET to /equipment/<id>`: 用 id 读取设备`<id>`

`PUT to /equipment/<id>`: 用 id 更新设备`<id>`

`DELETE to /equipment/<id>`: 删除 id 的设备`<id>`

希望能解决你的疑惑。

无论如何，一个很好的参考是[Apigee 电子书](http://apigee.com/about/api-best-practices/all/ebook)

# regex - 正则表达式允许任何字符除了反斜杠

> ID：15815547
> 
> 赞同：0
> 
> 时间：2013-04-04T15:32:22.470
> 
> 标签：regex

我正在使用 jQuery 验证引擎插件。这个正则表达式只允许字母数字，我想允许除反斜杠之外的任何其他字符。

```
/^[0-9a-zA-Z]+$/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:33:33.780

试试这个（转义反斜杠将取决于您的语言）：

```
/^[^\\]+$/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:34:14.497

```
/^[^\\]+$/ 
```

这是反斜杠的否定字符类。您在正则表达式文字中需要其中两个，否则它将尝试转义`]`

# php - mysql 结果时 JavaScript 重新加载

> ID：15815549
> 
> 赞同：0
> 
> 时间：2013-04-04T15:32:31.710
> 
> 标签：php, javascript, mysql

**问题：** 尝试使用 JavaScript 从 index.php 中的 MySQL 重新加载结果。但由于某种原因它不起作用，我遵循了stackoverflow的答案。

单击 ID“是”时，没有任何反应。我已经自由地定义了 jQuery，并且在控制台中得到了 0 个错误。

**问题**

我做错了什么？我如何解决它？

基本上我希望 JavaScript 重新加载/刷新来自 mySQL 的结果，如果单击 ID 'yes' 时有新结果。

```
 echo '<div id="messages">';
                while($row = $fetch->fetch( PDO::FETCH_ASSOC )) {
                        echo 
                        '<div class="background">'.$row['email'].' <span style="margin-left: 10px;"><font color="#ff0000">UNANSWERED</font></span><span id="right"><a href="index.php?recover='.$row['recover_id'].'">Read More</a></span></div><br />
                        ';
                }
                echo '</div>'; 
```

的HTML

```
<span id="yes">RELOAD</span> 
```

JS

```
<script type="text/javascript">
$(document).ready(function(){
    $("#yes").click(function(){
        $("#message").eq(0).load("index.php");
    })
})
</script> 
```

遵循这个：[使用 Ajax 在 DIV 中重新加载 MySQL 数据](https://stackoverflow.com/questions/11070607/reload-mysql-data-inside-a-div-using-ajax)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:40:02.620

您在第一个代码块中的 div 是 #messages

您在第二个代码块中的 JS 查找 #message

需要排队

# sharepoint - 无法从 InfoPath 2010 人员选取器控件中检索值

> ID：15815550
> 
> 赞同：0
> 
> 时间：2013-04-04T15:32:32.810
> 
> 标签：sharepoint, infopath

我在 InfoPath 2010 中的 Person Picker 控件出现问题。我输入了一个名称，它被解析并显示在控件上。到目前为止，一切都很好。现在我正在尝试检索控件提供的 AccountId 的值。当我在本地预览表单时它可以工作，但是当我将它发布到 SharePoint（这是一个支持浏览器的表单）时，AccountId 将返回为空白。

下面是我正在使用的 XPath。（我尝试添加一个索引，如“Person[1]”，但 InfoPath 也不喜欢那样。此外，我限制了控件，因此只能输入 1 个用户。）

/my:myFields/my:ApproverGroup/my:Analyst/pc:Person/pc:AccountId

如果我尝试获取 DisplayName 或 AccountType，则结果相同——在预览中有效，但在发布时无效。我正在发布到我的本地 SharePoint Server（我正在开发的同一台机器）。

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:05:01.817

我想到了。事实证明，在数据源反映在 People Picker 控件中输入的值之前，需要进行回发。为什么会这样，我不知道，但它以某种方式使控件正常工作。此回发可以在表单加载时完成一次，然后人员选择器将在此之后工作。所以我的下一个问题是寻找一种强制回发表单加载的方法。此外，人员选择器莫名其妙地不包括“回发设置”属性，例如文本框。我在表单的第一个文本框中启用了回发设置为“始终”，希望用户在向下滚动到 People Picker 控件之前输入一个值。这是一个可怕的黑客，但我到目前为止唯一的解决方法。如果有人可以在这里提供更好的答案，请这样做。

# php - 在网站中实现 Facebook 登录

> ID：15815552
> 
> 赞同：0
> 
> 时间：2013-04-04T15:32:35.983
> 
> 标签：php, javascript, mysql, facebook, facebook-login

我有一个 web 应用程序，它在服务器端使用 PHP 和 MySql，在客户端使用 Javascript/JQuery。我实现了developers.facebook 上提供的登录按钮，因为我有一个App Key。我想允许用户使用 Facebook 注册，所以我认为我应该检索 Facebook 提供的访问密钥，将其存储在我的数据库中，然后使用它来允许用户登录。

*   用户使用登录按钮允许我的应用程序后，我如何检索访问密钥？
*   这可能吗？我可以存储它以允许用户再次登录吗？
*   我是否有权同时请求用户的姓名和姓氏？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:08:06.113

您可以检索姓名、姓氏、生日、最新的墙帖……为了简短起见，您可以允许并显示此人的所有信息，因为他们可以单击“接受”或“拒绝”按钮，如果您添加登录/注册按钮。至于 SQL Access 密钥，我知道您可以存储它们，唯一的问题是我不知道任何代码 :(，但这是可能的。

我希望其他一些用户知道访问密钥脚本是如何工作的。

# python - 从 cmd 行或 bash 脚本将参数传递到 python 脚本

> ID：15815560
> 
> 赞同：1
> 
> 时间：2013-04-04T15:33:10.453
> 
> 标签：python, bash, variables, arguments

简单的问题。

如果我有这条线：

```
 j = json.load(urllib.urlopen("http://ajax.googleapis.com/ajax/services/search/images?v=1.0&q= ***$???*** ")) 
```

我正在尝试从另一个脚本 +/或命令行将参数传递到该位置。

在 bash 中，它很简单，1 美元、2 美元等。

我已经读过 (sys.argv[1]) 并且我错过了它，因为 bash 中这样一个简单的东西似乎需要在 python 中如此冗长。我试过这个：

```
 j = json.load(urllib.urlopen("http://ajax.googleapis.com/ajax/services/search/images?v=1.0&q='(sys.argv[1])'")) 
```

无济于事....我不明白什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:34:21.083

在 Python 中，默认情况下不插入字符串。尝试

```
("http://ajax.googleapis.com/ajax/services/search/images?v=1.0&q='%s'"
 % sys.argv[1]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T07:07:22.500

是的，为了完整起见，有“新格式”，它有点像 Java 的格式字符串，而且使用起来更好一些。

```
 $ python -c 'import sys; print("yojo{0}".format(sys.argv[1]))' mo
yojomo 
```

如果您只想连接字符串，则`+`运算符会为此而重载。

```
print("mystring" + sys.argv[1]) 
```

# fluent-nhibernate - 如何在 NHibernate 映射中解密 MD5 密码？

> ID：15815561
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:33:13.733
> 
> 标签：fluent-nhibernate, nhibernate-mapping, md5

有没有办法做到这一点？在我的映射类中，当我将数据库数据提取到实体中时，我想解密一个 MD5 密码。这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:47:23.277

MD5 可用于加密密码。MD5 被认为是[损坏](https://stackoverflow.com/a/6774381/892788)的。您所做的是使用 MD5 对密码进行哈希处理，并将其与数据库中的原始哈希值进行比较。由于 MD5 是一种方式，如果密码相同，则哈希值相同。

编辑：

如果您正在寻找破解 MD5 加密密码，那就不同了。看看[这个](https://stackoverflow.com/questions/1240852/is-it-possible-to-decrypt-md5-hashes)

你首先明白这**不是技术特定**的。这些是可以使用各种技术实现的基本计算机科学**通用概念。**在你的情况下 C# 和 NHibernate 等。

简单地说，你用**MD5（消息摘要算法 5）**做的是，你做**hashing**。因为它是一个哈希函数。看看[**这个**](http://en.wikipedia.org/wiki/Hash_function)。

但是这个 MD5 是一个单向哈希函数。“一种方式”意味着几乎不可能从字符串中导出原始文本。这就是为什么它用于密码加密。因为您无法反转单向功能并获取实际密码。看看[**这个**](http://en.wikipedia.org/wiki/Cryptographic_hash_function)。

我假设您想检查插入的密码是否正确并允许登录或做任何必要的事情。**您不应该对密码进行解密**。如果您不打算破解密码。密码破解更多的是一种猜测，并且可以使用已实施方法的弱点（在 MD5 散列冲突中）来减少范围。

在密码创建中，您获取密码并使用 MD5（在您的情况下）对其进行哈希处理。然后这个哈希值就是您要存储在数据库中的内容。然后下次你想检查天气时密码是正确的。然后您再次获取密码并再次使用 MD5 对其进行哈希处理。然后您获取该哈希值并将其与数据库中的哈希值进行比较。如果它们匹配插入的密码是正确的。

我可以看到你是新来的。我建议您最好先学习这些概念，无论您使用什么技术，这些概念都会对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T17:44:11.793

你不妨问问你能不能把一堆灰烬在烧掉之前重新变成原木。散列是一种单向动作......你不能“逆转”它。您唯一能做的就是确定一些生成相同哈希（哈希冲突）的源值。

# css - 如何使用 Internet Explorer 的 CSS 让液体页脚粘在底部？

> ID：15815563
> 
> 赞同：0
> 
> 时间：2013-04-04T15:33:30.840
> 
> 标签：css, internet-explorer-9, tumblr

我在 IE 上检查了我的 Tumblr 主题，页脚位于页面中间，这是我的代码。

```
#mastfooter {
    background-color: #4F3117;
    height: 295px;
    clear: both;
    margin-top: 0;
    margin-right: auto;
    margin-bottom: auto;
    margin-left: auto;
    width: 100%;
    position: absolute;
    left: 0px;
    bottom: -38px;
} 
```

是否有 Internet Explorer 9 解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:52:50.693

根据提供的代码，我猜您需要将其更改为类似这样-

```
#mastfooter {
background-color: #4F3117;
height: 295px;
clear: both;
margin-right: auto;
margin-left: auto;
width: 100%;
position: fixed; /* keeps the footer visible even when scrolling*/
bottom: 0px; 
```

}

请注意，顶部和底部边距已被删除，它们很可能是定位问题的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:37:49.990

Ryan Fait 拥有针对粘页脚的最佳跨浏览器解决方案

[看这里](http://ryanfait.com/resources/footer-stick-to-bottom-of-page/)

但是在 stackoverflow 上有无数只使用 CSS 的粘性页脚示例。

# highcharts - HighCharts 的对数轴问题

> ID：15815568
> 
> 赞同：0
> 
> 时间：2013-04-04T15:33:38.777
> 
> 标签：highcharts, highstock

我们正在使用对数刻度比较多个系列。大多数情况下，图表看起来很好，并且可以正确缩放到数据的最小/最大值。在下面的示例中，顶部系列被切断。唯一改变的是数据。如果我们将时间段更改为任何其他选项，它将正确重新缩放，回到 1Y 有同样的问题。有没有办法解决这个问题？

我的第二个问题是关于对数刻度时网格线/标签的逻辑。默认情况下，这些步骤不应该基于 Log(10)，例如 [0.10%, 1%, 10%, 100%, 1000%]？是否有配置选项来设置它？在下面的示例中，默认的 [0.10, 0.20, 0.40, 1.00] 没有多大意义。

**这就是标签/刻度应该始终看起来的样子：** jsfiddle.net/TeTMw/1

![对数比例问题](https://i.stack.imgur.com/uYcUX.png)

**编辑：**

这是导致此错误的 highcharts 代码。如果您能帮助解决此问题，那就太好了。

```
// Second case: We need intermediary ticks. For example 
            // 1, 2, 4, 6, 8, 10, 20, 40 etc. 
        } else if (interval >= 0.08) {
            var roundedMin = mathFloor(min),
                intermediate,
                i,
                j,
                len,
                pos,
                lastPos,
                break2;

            if (interval > 0.3) {
                intermediate = [1, 2, 4];
            } else if (interval > 0.15) { // 0.2 equals five minor ticks per 1, 10, 100 etc
                intermediate = [1, 2, 4, 6, 8];
            } else { // 0.1 equals ten minor ticks per 1, 10, 100 etc
                intermediate = [1, 2, 3, 4, 5, 6, 7, 8, 9];
            }

            for (i = roundedMin; i < max + 1 && !break2; i++) {
                len = intermediate.length;
                for (j = 0; j < len && !break2; j++) {
                    pos = log2lin(lin2log(i) * intermediate[j]);

                    if (pos > min && lastPos <= max) {
                        positions.push(lastPos);
                    }

                    if (lastPos > max) {
                        break2 = true;
                    }
                    lastPos = pos;
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T14:18:27.890

1.  有一个已知问题，即在 Highcharts 1.3.0 中可能会切断日志轴。这将在本周晚些时候发布的 1.3.1 中修复。请参阅[https://github.com/highslide-software/highcharts.com/issues/1666](https://github.com/highslide-software/highcharts.com/issues/1666)。

2.  有关 Y 轴刻度间隔，请参阅[http://api.highcharts.com/highcharts#yAxis.tickInterval](http://api.highcharts.com/highcharts#yAxis.tickInterval)。默认情况下，tickInterval 为 null，因此刻度的布局由 tickPixelInterval 确定。例如，在您的特定图表中，如果我们跳过 0.20 和 0.40，对于默认的 tickPixelInterval 72，刻度将变得过于普遍。

# iphone - SDL2_ttf 库未在 OS X 上加载

> ID：15815569
> 
> 赞同：0
> 
> 时间：2013-04-04T15:33:39.330
> 
> 标签：iphone, xcode, macos, sdl

我在 OS X 10.8 上使用 XCode 4.6。

当我构建我的 SDL2 项目时尝试使用 SDL2_ttf.framework 我收到此错误。我首先要说明的是我已经构建了 SDL2.framework，并且我已经在我的项目中包含了该框架。当我尝试运行该项目时，构建似乎还可以。

dyld：库未加载：@executable_path/../Frameworks/SDL2_ttf.framework/Versions/A/SDL2_ttf

看看 SDL2.framework 我确实在 Versions/A 中有 SDL2_ttf

任何想法这里可能有什么问题？

# python - 将存储在 Python 中的数组中的矩阵相乘

> ID：15815573
> 
> 赞同：1
> 
> 时间：2013-04-04T15:33:45.200
> 
> 标签：python, arrays, numpy, matrix-multiplication

这似乎是一个愚蠢的问题，但我是 Python（和编程）的血腥新手。我正在运行一个物理模拟，其中涉及我存储在一个数组中的许多（~10 000）2x2 矩阵。我在下面的代码中称这些矩阵 M 和数组 T 。然后我只想计算所有这些矩阵的乘积。这就是我想出的，但它看起来很难看，而且对于 10000+ 2x2 矩阵来说工作量很大。有没有更简单的方法或我可以使用的内置功能？

```
import numpy as np
#build matrix M (dont read it, just an example, doesnt matter here)    
def M(k1 , k2 , x):
    a = (k1 + k2) * np.exp(1j * (k2-k1) * x)
    b = (k1 - k2) * np.exp(-1j * (k1 + k2) * x)
    c = (k1 - k2) * np.exp(1j * (k2 + k1) * x)
    d = (k1 + k2) * np.exp(-1j * (k2 - k1) * x)
    M = np.array([[a , b] , [c , d]])
    M *= 1\. / (2\. * k1)
    return M

#array of test matrices T
T = np.array([M(1,2,3), M(3,3,3), M(54,3,9), M(33,11,42) ,M(12,9,5)])
#compute the matrix product of T[0] * T[1] *... * T[4]
#I originally had this line of code, which is wrong, as pointed out in the comments
#np.dot(T[0],np.dot(T[1], np.dot(T[2], np.dot(T[2],np.dot(T[3],T[4])))))
#it should be:
np.dot(T[0], np.dot(T[1], np.dot(T[2],np.dot(T[3],T[4])))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:37:44.750

不是非常 NumPythonic，但你可以这样做：

```
reduce(lambda x,y: np.dot(x,y), T, np.eye(2)) 
```

或者更简洁，如建议的那样

```
reduce(np.dot, T, np.eye(2)) 
```

# cygwin - 在 Cygwin 上安装 octopress 时出现“spawn.h not found”

> ID：15815574
> 
> 赞同：4
> 
> 时间：2013-04-04T15:33:53.500
> 
> 标签：cygwin, bundle, rbenv, spawn, octopress

我一直在尝试在 cygwin 上安装 octopress。我用谷歌搜索但无济于事。我希望有人可以建议一个黑客（无论多么复杂）来解决这个问题。

我按照[octopress 安装说明](http://octopress.org/docs/setup/)进行操作。一切都很顺利，直到`bundle install`舞台。当我达到这一点时，安装退出并显示错误提示它找不到**spawn.h**。

我搜索了一下，显然 spawn.h 没有出现在任何 cygwin 库中。我安装了所有我可以从 cygwin 安装程序中获得的 c++ 库，但这并没有帮助。

你能帮忙解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-06T23:27:27.480

我认为在这个过程中失败的宝石是`posix-spawn`. 为此，您可以在本地安装 gem：

```
$ gem install rake-compiler -v 0.7.6
$ git clone git://github.com/rtomayko/posix-spawn.git
$ cd posix-spawn
$ rake gem
$ cd pkg/posix-spawn-0.3.6
$ gem install --local posix-spawn-0.3.6.gem 
```

解释（来自我发现的[一篇文章）：](http://matt.scharley.me/2012/03/10/windows-cygwin-and-jekyll.html)

> gem 存储库中的版本存在一个错误，`posix-spawn`但这使得无法通过 gem 安装`Cygwin`

之后，再试`bundle install`一次，应该会成功。

这是 GitHub 项目上的一个相关[问题](https://github.com/imathis/octopress/issues/46)

**更新**：我最近[`scoop`](http://scoop.sh)为 Windows 安装了一个命令行安装程序，一个非常简单的设置。我毫不费力地安装了 Ruby、bundler 和 octopress。你应该试一试。

# javascript - Disqus 的 iframe 如何根据其中的内容调整自身大小？

> ID：15815576
> 
> 赞同：4
> 
> 时间：2013-04-04T15:33:58.283
> 
> 标签：javascript, jquery, html, web-applications, web

这是一个例子：[http ://www.npr.org/blogs/thetwo-way/2013/04/04/176224703/why-can-lance-armstrong-race-at-a-swim-meet](http://www.npr.org/blogs/thetwo-way/2013/04/04/176224703/why-can-lance-armstrong-race-at-a-swim-meet)

向下滚动到评论。Discus 在页面上插入一个 iframe，然后在 iframe 中加载评论。

不知何故，iframe 知道它的内容有多高，并在它插入的页面上扩展到该高度。

有谁知道这怎么可能？特别令人困惑，因为 Disqus 的 iframe 是一个不同的域，所以我不知道任何脚本如何检测到其中的内容..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T17:27:54.947

Disqus[`postMessage()`](https://www.google.com/search?q=javascript+postmessage)用于将消息从 iframe 发送回主机页面。如果您查看其主 iframe 中的 JavaScript 代码并搜索“postMessage”，您会发现此代码（原始代码已缩小，在此处重新格式化）：

```
 DISQUS.define("Bus", function() {
    function e(a) {
        a = a.split("/");
        return a[0] + "//" + a[2]
    }
    var g = DISQUS.use("JSON"),
        c = window.location.hash.slice(1),
        b = window.opener || window.parent,
        h = document.referrer,
        f = {};
    f.client = e(document.location.href);
    f.host = h ? e(h) : f.client;
    return {
        origins: f,
        messageHandler: function(a) {
            var b;
            try {
                b = DISQUS.JSON.parse(a.data)
            } catch (c) {
                return
            }
            if (!(b.name[0] === "!" && a.origin !== f.client)) switch (b.scope) {
            case "client":
                DISQUS.Bus.trigger(b.name, b.data)
            }
        },
        postMessage: function(a) {
            a.sender = c;
            a = g.stringify(a);
            b.postMessage(a, "*")
        },
        sendHostMessage: function(a, b) {
            b = b || [];
            DISQUS.Bus.postMessage({
                scope: "host",
                name: a,
                data: b
            })
        },
        sendGlobalMessage: function(a, b) {
            b = b || [];
            DISQUS.Bus.postMessage({
                scope: "global",
                name: a,
                data: b
            })
        }
    }
});
_.extend(DISQUS.Bus, Backbone.Events);
$(document).ready(function() {
    var e = window.addEventListener ? window.addEventListener : window.attachEvent,
        g = window.addEventListener ? "message" : "onmessage";
    if (!e) throw Error("No event support.");
    e(g, DISQUS.Bus.messageHandler, !1);
    window.onunload = function() {
        DISQUS.Bus.sendHostMessage("die")
    } 
```

这里的使用`Bus`是有道理的：“在计算机体系结构中，总线是在计算机内部的组件之间或计算机之间传输数据的子系统。” （[维基百科](http://en.wikipedia.org/wiki/Bus_(computing))）

我希望看到加载到主机页面的内容，例如设置事件侦听器的代码的最后一部分，尽管我在粗略搜索加载到主机页面的脚本时没有找到它。

另请参阅[根据内容调整 iframe 的大小以](https://stackoverflow.com/questions/153152/resizing-an-iframe-based-on-content)了解适用于旧版浏览器的相关技术。

# erlang - 由于语法错误，Erl 文件无法编译

> ID：15815578
> 
> 赞同：0
> 
> 时间：2013-04-04T15:34:09.293
> 
> 标签：erlang, ejabberd

我试图找出这段代码有什么问题，因为它给了我错误，阻止它正确编译成一个梁文件。我看不出语法有什么问题。有没有可以帮助我的IDE？

这些是错误：

```
 parallels@parallels-Parallels-Virtual-Platform:/var/backend/ejabberd_modules# erlc -I         /var/tmp/ejabberd/src/ mod_stanza_ack.erl
   ./mod_stanza_ack.erl:97: syntax error before: '.'
   ./mod_stanza_ack.erl:98: syntax error before: Body
   ./mod_stanza_ack.erl:16: function route/3 undefined
   ./mod_stanza_ack.erl:3: Warning: behaviour gen_mod undefined
   ./mod_stanza_ack.erl:111: Warning: function strip_bom/1 is unused
   ./mod_stanza_ack.erl:114: Warning: function send_presence/3 is unused
   ./mod_stanza_ack.erl:120: Warning: function echo/3 is unused
   ./mod_stanza_ack.erl:123: Warning: function send_message/4 is unused 
```

这是代码：

```
-module(mod_stanza_ack).
-behavior(gen_server).
-behavior(gen_mod).

-export([start_link/2]).

-export([start/2,
         stop/1,
         init/1,
         handle_call/3,
         handle_cast/2,
         handle_info/2,
         terminate/2,
         code_change/3]).

-export([route/3]).

-include("ejabberd.hrl").

-define(PROCNAME, ejabberd_mod_stanza_ack).
-define(BOTNAME, stanza_ack).

start_link(Host, Opts) ->
    Proc = gen_mod:get_module_proc(Host, ?PROCNAME),
    gen_server:start_link({local, Proc}, ?MODULE, [Host, Opts], []).

start(Host, Opts) ->
    Proc = gen_mod:get_module_proc(Host, ?PROCNAME),
    ChildSpec = {Proc,
        {?MODULE, start_link, [Host, Opts]},
        temporary,
        1000,
        worker,
        [?MODULE]},
    supervisor:start_child(ejabberd_sup, ChildSpec).

stop(Host) ->
    Proc = gen_mod:get_module_proc(Host, ?PROCNAME),
    gen_server:call(Proc, stop),
    supervisor:terminate_child(ejabberd_sup, Proc),
    supervisor:delete_child(ejabberd_sup, Proc).

init([Host, Opts]) ->
    ?DEBUG("ECHO_BOT: Starting echo_bot", []),
    % add a new virtual host / subdomain "echo".example.com
    MyHost = gen_mod:get_opt_host(Host, Opts, "echo.@HOST@"),
    ejabberd_router:register_route(MyHost, {apply, ?MODULE, route}),
    {ok, Host}.

handle_call(stop, _From, Host) ->
    {stop, normal, ok, Host}.

handle_cast(_Msg, Host) ->
    {noreply, Host}.

handle_info(_Msg, Host) ->
    {noreply, Host}.

terminate(_Reason, Host) ->
    ejabberd_router:unregister_route(Host),
    ok.

code_change(_OldVsn, Host, _Extra) ->
    {ok, Host}.

% Checks a presence /subscription/ is a part of this.
% we may want to impliment blacklisting / some kind of
% protection here to prevent malicious users
%route(From, #jid{luser = ?BOTNAME} = To, {xmlelement, "presence", _, _} = Packet) ->
route(From, To, {xmlelement, "presence", _, _} = Packet) ->
    case xml:get_tag_attr_s("type", Packet) of
        "subscribe" ->
            send_presence(To, From, "subscribe");
        "subscribed" ->
            send_presence(To, From, "subscribed"),
            send_presence(To, From, "");
        "unsubscribe" ->
            send_presence(To, From, "unsubscribed"),
            send_presence(To, From, "unsubscribe");
        "unsubscribed" ->
            send_presence(To, From, "unsubscribed");
        "" ->
            send_presence(To, From, "");
        "unavailable" ->
            ok;
        "probe" ->
            send_presence(To, From, "");
        _Other ->
            ?INFO_MSG("Other kind of presence~n~p", [Packet])
    end,
    ok;

%route(From, #jid{luser = ?BOTNAME} = To, {xmlelement, "message", _, _} = Packet) ->
route(From, To, {xmlelement, "message", _, _} = Packet) ->
    case xml:get_subtag_cdata(Packet, "body") of
    "" ->
        ok.
    Body ->
        case xml:get_tag_attr_s("type", Packet) of

        "error" ->
            ?ERROR_MSG("Received error message~n~p -> ~p~n~p", [From, To, Packet]);
        _ ->
            echo(To, From, strip_bom(Body))
        end
    end,
    ok.

%% HELPER FUNCTIONS

strip_bom([239,187,191|C]) -> C;
strip_bom(C) -> C.

send_presence(From, To, "") ->
    ejabberd_router:route(From, To, {xmlelement, "presence", [], []});

send_presence(From, To, TypeStr) ->
    ejabberd_router:route(From, To, {xmlelement, "presence", [{"type", TypeStr}], []}).

echo(From, To, Body) ->
    send_message(From, To, "chat", Body).

send_message(From, To, TypeStr, BodyStr) ->
    XmlBody = {xmlelement, "message",
           [{"type", TypeStr},
        {"from", jlib:jid_to_string(From)},
        {"to", jlib:jid_to_string(To)}],
           [{xmlelement, "body", [],
         [{xmlcdata, BodyStr}]}]},
    ejabberd_router:route(From, To, XmlBody). 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:44:27.393

`./mod_stanza_ack.erl:97: syntax error before: '.'`说错误在第 97 行。在第 97 行更改`ok.`为`ok;`. 这将解决问题。

Eclipse 的 Erlide 插件是一个很好的 IDE 试用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T15:49:54.153

在函数的第 97 行， is`route/3`的第一个子句`case`

```
 "" ->
        ok. 
```

这里`.`结束了a中间非法的函数，`case`应该是a `;`。这也意味着解析器假定`Body`下一行的变量启动了一个新函数，这也是非法的，因为函数名不能是变量。

看到函数`route/3`尚未定义，因此无法导出，这是第 16 行未定义函数错误的原因。

有时编译器错误消息有点神秘，但行号通常会有所帮助。

# asp.net-mvc - MVC FluentValidation 与单独的 .dll 中的实体框架

> ID：15815580
> 
> 赞同：0
> 
> 时间：2013-04-04T15:34:14.817
> 
> 标签：asp.net-mvc, entity-framework-5, fluentvalidation

在使用 FluentValidation 时，我有一个单独的.dll，其中包含我们的数据库模型和部分类等，它工作正常（桌面条形码终端和我们的网站都可以使用它）。

对于桌面应用程序，我可以读取并显示所有错误，如下所示

```
public override int SaveChanges()
    {
        var errors = this.GetValidationErrors();
        if (errors.Any())
        {
            //handle validation errors
            return 0;
        }
        else
        {
            return base.SaveChanges();
        }
    } 
```

对于 MVC 站点，我可以在单个模型上设置验证器或创建数据注释并让它们正常工作（这不是我想要的）。我无法理解的是如何强制我的模型映射到我的实体，以便我可以在视图中显示流畅的验证消息。我不想维护两组单独的逻辑，并且条形码应用程序和网站必须使用相同的逻辑。

我必须将我的实体直接映射到视图吗？我一直认为这是一件坏事，而且不是很灵活。或者有没有办法说明模型中的字段映射回我的一个实体的属性？也许是一些描述的注释。

编辑：

只是对我需要的验证类型进行一些说明。

大多数前端输入类型验证仍将保留在 viewModels 中（必需/长度/密码匹配等 - 基本上我也可以用于客户端验证的所有内容）。但是有所有我不想要的业务逻辑验证。必须在设置其他选项之前验证电子邮件地址之类的东西，帐号必须是基于名称的特定格式（我不能用正则表达式做的事情）。此特定日期不是有效的交货日期等。

我想我可以做的一件事是以某种方式将这些添加到 ValidationSummary 并将它们与各个字段分开显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:14:40.500

我认为你只是看错了情况。MVC 的全部内容是关注点分离。数据库需要知道您的视图可能不太关心的事情，反之亦然。这就是为什么推荐的做法是将视图模型与您的视图一起使用，而不是实体本身。

验证大致相同。密码确认需要与用户输入的密码相匹配这一事实与数据库完全无关。或者更恰当地说，诸如验证密码中的最小字符数之类的东西也与数据库无关；它只会收到密码的加盐和散列版本。因此，将这种验证放在您的实体上是错误的。它属于视图模型。

当我第一次开始使用 MVC 时，我曾经将所有验证逻辑添加到我的实体类中，然后在我的视图模型上重复相同的验证。随着时间的推移，我开始意识到实际上很少*需要*对两者进行验证。事实上，大多数验证应该只在您的视图模型上进行。它充当某种看门人；如果数据足以通过您的视图模型，那么对于您的数据库来说就足够了。对您的实体有意义的验证类型是这样的`Required`，但即使这样，也仅在*必须*在它到达您的数据库时有一个值。默认情况下，像 DateTimes 这样的东西是不可为空的，而 EF 足够聪明，可以使它们在默认创建的表上不可为空。`MaxLength`如果对数据库中文本字段的长度有硬性限制，有时是值得的，但通常情况下，nvarchars 工作得很好。

无论如何，关键是如果您真的坐下来开始评估实体上的验证，您可能会发现其中大部分是业务逻辑，仅适用于您的应用程序的工作方式，*而不*适用于数据在数据库中的表示方式等级。这是关键要点：在您的实体上，您只需要对数据库进行必要的验证。这通常很薄。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T17:00:33.533

只是一个更新。为了获得我需要的两层验证，我必须将所有实体模型类标记为 IValidatable。然后我覆盖每个类的验证方法并在那里调用我的流利验证验证器方法，传回所需的错误。对于modelstate.addmodelerror，我将键设置为字段名，它映射回来没问题。更多的代码，但它的工作原理。如果我找到更好的方法来做这个病态的更新。

# java - 在java中将列表转换为逗号分隔字符串的最佳方法

> ID：15815587
> 
> 赞同：167
> 
> 时间：2013-04-04T15:34:32.780
> 
> 标签：java, string, list, collections, set

我有`Set<String> result`& 想将其转换为逗号分隔的字符串。我的方法如下所示，但也在寻找其他意见。

```
List<String> slist = new ArrayList<String> (result);
StringBuilder rString = new StringBuilder();

Separator sep = new Separator(", ");
//String sep = ", ";
for (String each : slist) {
    rString.append(sep).append(each);
}

return rString; 
```

* * *

## 回答 #1

> 赞同：440
> 
> 时间：2013-04-04T15:36:34.417

从 Java 8 开始：

```
String.join(",", slist); 
```

来自 Apache Commons 库：

```
import org.apache.commons.lang3.StringUtils 
```

采用：

```
StringUtils.join(slist, ','); 
```

另一个类似的问题和答案[在这里](https://stackoverflow.com/a/63258/1651233)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-04T15:49:23.723

您可以先计算字符串的总长度，然后将其传递给 StringBuilder 构造函数。而且您不需要先转换 Set。

```
Set<String> abc = new HashSet<String>();
abc.add("A");
abc.add("B");
abc.add("C");

String separator = ", ";
int total = abc.size() * separator.length();
for (String s : abc) {
    total += s.length();
}

StringBuilder sb = new StringBuilder(total);
for (String s : abc) {
    sb.append(separator).append(s);
}

String result = sb.substring(separator.length()); // remove leading separator 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-04T15:36:43.403

您正在使用的`Separator`是一个 UI 组件。你最好使用一个简单的`String sep = ", "`.

# maven - maven找不到java编译器

> ID：15815589
> 
> 赞同：1
> 
> 时间：2013-04-04T15:34:32.947
> 
> 标签：maven, javac, maven-compiler-plugin

我是新手。我刚刚加入了一家新公司，他们的所有项目都使用 maven。我为 Maven 依赖项设置了公司的服务器。我正在使用 Fedora。

对于大多数项目来说，一切都很顺利。对于其中一些，我在运行 mvn compile 时收到此错误：

无法在项目 xlayer 上执行目标 org.apache.maven.plugins:maven-compiler-plugin:2.0.2:compile (default-compile)：致命错误编译：执行外部编译器时出错。执行过程时出错。无法运行程序“java -classpath”${env.M2_REPO}/org/eclipse/jdt/core/3.4.2.v_883_R34x/core-3.4.2.v_883_R34x.jar“org.eclipse.jdt.internal.compiler.batch .Main -sourcepath "src/main"" (在目录 "/home/es/ion_projects/XLayer"): error=2, No such file or directory -> [Help 1]

我在网上看了几个小时，什么也做不了。PATH 和 JAVA_HOME 设置正确。

运行 mvn --version 给出：

Apache Maven 3.0.4 (rNON-CANONICAL_2013-01-22_13-18_mockbuild; 2013-01-22 14:18:29+0100) Maven 主页：/usr/share/maven Java 版本：1.7.0_17，供应商：Oracle Corporation Java主页：/home/es/kit/jdk1.7.0_17/jre 默认语言环境：en_US，平台编码：UTF-8 操作系统名称：“linux”，版本：“3.8.3-103.fc17.i686”，arch：“ i386”，家庭：“unix”

更新：

在 pom.xml （父级，但这并不重要）中，maven-compiler-plugin 将可执行文件定义为

java -classpath "${env.M2_REPO}/org/eclipse/jdt/core/${org.eclipse.jdt.core.version}/core-${org.eclipse.jdt.core.version}.jar" org .eclipse.jdt.internal.compiler.batch.Main -sourcepath "src/main"

为了使用 Eclipse 编译器而不是 sun 的编译器。这适用于使用 Windows 的开发人员。在 linux 上，maven 尝试将“java -classpath ....”作为一个不存在的命令执行。

我仍在寻找解决方案。我发现的唯一黑客是将可执行文件“java -classpath ...”放在我机器上的可执行文件中，并将该文件的名称放在 maven 的标签中。

# sql - 单个事务中对单个表的多个 DDL 查询

> ID：15815592
> 
> 赞同：0
> 
> 时间：2013-04-04T15:34:48.023
> 
> 标签：sql, sql-server, transactions, sql-server-ce, alter-table

`ALTER TABLE`如果所有查询都在一个事务中，我是否可以依靠 SQL Server（和 SQL Server Compact）一次对单个表执行多个查询，而不是依次应用更改？

我正在从代码生成 DML 查询并希望简化代码，但我更愿意避免出现性能问题。

例如，此代码之间在性能方面是否存在差异：

```
 BEGIN TRAN
  ALTER TABLE t ADD COLUMN a int
  ALTER TABLE t ADD COLUMN b int
  ALTER TABLE t ADD COLUMN c int
  COMMIT TRAN 
```

这个代码：

```
 BEGIN TRAN
  ALTER TABLE t ADD COLUMN a int
              , ADD COLUMN b int
              , ADD COLUMN c int
  COMMIT TRAN 
```

PS 其他关系数据库引擎上的信息也会很有用，以防万一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:49:21.130

它们将在事务内是连续的，对事务外的其他会话是全有或全无。如果您关心性能，请考虑对表执行 DDL 语句将在事务期间锁定整个表的事实，因此不要在实时高流量表上执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T16:08:31.810

第二种情况原则上更可取，因为它为优化器提供了开展业务的机会。特别是，数据字典很可能是一次读取和写入，对表空间的所有更改也将一次性完成。但我怀疑仅仅通过添加整数，就像在这个例子中一样，它会产生很大的不同。并且绝对是特定于引擎的。

# jquery - 如何计算正则表达式中的字符长度

> ID：15815594
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:34:56.537
> 
> 标签：jquery

现在我正在使用如何计算 reg-ex 中的字符长度

```
function CheckForAlphaRegName(theObj) {
if (theObj.value.match(/[^a-zA-Z-\'\s]+/)) {
    theObj.value = theObj.value.replace(/[^a-zA-Z-\'\s]+/g, "");
}
if (theObj.value.match(/[-\'\s]+/).length > 1) {
    theObj.value.match(/[-\'\s]+/g, "");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:39:50.607

对于您拥有的这个特定示例，您要确保您要查找的字符串与您的正则表达式匹配。所以只需通过尝试以下代码来检查它是否不为空

```
if (theObj.value.match(/[-\'\s]+/)) {
    theObj.value.match(/[-\'\s]+/g, "");
} 
```

如果 theObj.value.match(/[-\'\s]+/) 返回**'null'**则表示没有匹配。希望能帮助到你。

# php - PDO 不允许插入查询

> ID：15815595
> 
> 赞同：-2
> 
> 时间：2013-04-04T15:34:59.277
> 
> 标签：php, mysql, sql, pdo

我正面临一个让我发疯的奇怪问题。我从来没有遇到过这样的事情。即使我可以预测这将是一件非常容易的事情，但我正在看它。

我正在根据业务角色逻辑执行查询。所以在某些情况下，我会选择并更新，在其他情况下，我会选择、更新，然后在第四次插入。这是我如何处理代码的总体结构

```
Open PDO connection

1 getDataSet 1 (select)
2 ProcessQuery (update)
3 getDataSet 1 (select)
4 ProcessQuery (Insert)

Close PDO connection by setting the PDO object to null. 
```

出于奇怪的原因，插入根本不起作用！选择有效，更新没有问题，但是当涉及到插入部分时，它不起作用。它甚至根本没有给我任何错误。事实上，我复制了相同的查询并在 phpMyAdmin 中执行它并且查询有效！

我应该注意我要插入的表非常大，并且有超过 400 万条记录和许多索引。

可能是什么问题呢？我还能检查什么？为什么插入不能从脚本工作，它是从 phpmyadmin 工作的？

这是我的代码

这是我当前用来连接服务器的 PDO 类 [http://pastebin.com/XQ2RrhA1](http://pastebin.com/XQ2RrhA1)

```
<?php

class connection {

        private $connString;
        private $userName;
        private $passCode;
        private $server;
        private $pdo;
        private $errorMessage;
        protected $lastQueryTime;
        protected $lastQuery;

        private $pdo_opt = array (
                                                        PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,
                                                        PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
                                                        PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES utf8"
                                                        );

        function __construct($dbName, $serverName = 'localhost'){

                //sets credentials
                $this->setConnectionCredentials($dbName, $serverName);

                //start the connect
                $this->startConnection();

        }

        function startConnection(){

                        $this->pdo = new PDO($this->connString, $this->userName, $this->passCode, $this->pdo_opt);

                        if( ! $this->pdo){

                                $this->errorMessage  = 'Failed to connect to database. Please try to refresh this page in 1 minute. ';
                                $this->errorMessage .= 'However, if you continue to see this message please contact your system administrator.';
                                echo $this->getError();
                        }
        }

        //this will close the PDO connection
        public function endConnection(){

                $this->pdo = null;
        }

        //return a dataset with the results
        public function getDataSet($query, $data = NULL)
        {
                $start = microtime(true);
                $cmd = $this->pdo->prepare( $query );

                $cmd->execute($data);
                $ret = $cmd->fetchAll();
                //$cmd->closeCursor();
                $this->lastQueryTime = microtime(true) - $start;
                $this->lastQuery = $query;

                return $ret;
        }

        public function processQuery($query, $data = NULL)
        {
                $start = microtime(true);
                           //$this->pdo->beginTransaction();
                $cmd = $this->pdo->prepare( $query );
                $ret = $cmd->execute($data);
                           //$this->pdo->commit();
                           //$cmd->closeCursor();
                $this->lastQueryTime = microtime(true) - $start;
                $this->lastQuery = $query;

                return $ret;
        }

        //return last insert id
        public function lastInsertId($name = NULL) {
                if(!$this->pdo) {
                        return false;
                }

                return $this->pdo->lastInsertId($name);
        }

        public function getOneResult($query, $data = NULL){
                $cmd = $this->pdo->prepare( $query );
                $cmd->execute($data);

                return $cmd->fetchColumn();
        }

        public function getError(){
                if($this->errorMessage != '')
                        return $this->errorMessage;
                else
                        return true;  //no errors found

        }

        //this where you need to set new server credentials with a new case statment
        function setConnectionCredentials($dbName, $serv){

                switch($serv){

                        case default:
                                $this->connString       = 'mysql:host='.$serv.';dbname='.$dbName.';charset=utf8';
                                $this->userName         = 'USER';
                                $this->passCode         = 'PASSWORD';
                        break;

                        }

        }

public function lastQueryTime() {
    if(!$this->lastQueryTime) {
        throw new Exception('no query has been executed yet');
    }
    return $this->lastQueryTime;
}

public function lastQuery() {
    if(!$this->lastQuery) {
        throw new Exception('no query has been executed yet');
    }
    return $this->lastQuery;
}

}

?> 
```

这是我的实际代码

```
<?php
require('../classes/connection.php');

$db = new connection(DATABASE_NAME, DATABASE_HOST);

$sendUpdate = 0;
$id = 0;
$resultCode = 0;
$callCode = 0;
$total_attempts = 0;
$account_id = 0;
$timer = 0;

$notes = '';
$triggerOn = '';
$subject = '';

if(isset($_POST['sendUpdate'])){
        $sendUpdate = 1;
}

if(isset($_POST['current_call_id'])){
        $id = bigint($_POST['current_call_id']);
}

if(isset($_POST['result_code_menu'])){
        $resultCode = bigint($_POST['result_code_menu']);
}

if(isset($_POST['selected_call_code'])){
        $callCode = bigint($_POST['selected_call_code']);
}

if(isset($_POST['total_attempts'])){
        $total_attempts = bigint($_POST['total_attempts']);
}

if(isset($_POST['account_id'])){
        $account_id = bigint($_POST['account_id']);
}

if(isset($_POST['notes'])){
        $notes = trim($_POST['notes']);
}

if(isset($_POST['triggerOn'])){
        $triggerOn = convertTimeToUTCzone( $_POST['triggerOn'], USER_TIME_ZONE );
}

        $subject = $resultCode;

if(isset($_POST['timer'])){
        $timer = convertTimeToSeconds($_POST['timer']);
}

//CONVERT $time to seconds

        $error_list = '';
        $pass_message = '';

        if($id  < 1){
                $error_list .= '<li>You have selected an invalid link</li>';
        }

        if($callCode == 0){
                $error_list .= '<li>You must select a call code.</li>';
        }

        if($resultCode == 0){
                $error_list .= '<li>You must select a result code.</li>';
        }

        if($timer == 0){
                $error_list .= '<li>You can not reset timer before submitting the form.</li>';
        }      

        //if pass all check
        if($error_list == ''){

                $pass_all = 0;

                //Find out what is the next action
                        $action = $db->getDataSet('SELECT result FROM result_codes WHERE result_code_id = '.$resultCode.' LIMIT 1;' );

                                if( count($action) == 1){
                                        $next_action = $action[0]['result'];
                                } else {
                                        $error_list .= '<li>Error #95: Unknown Error: result code was not found.</li>';
                                        $pass_all = 0;
                                }

                //Close existing open phone call
                if( $next_action == 'FINISH' || $next_action == 'CREATE NEW CALL'  || $next_action == 'TRY AGAIN' ){

                        $statment = $db->processQuery('UPDATE phone_calls SET result_code_id= ?, call_notes= ?, call_duration = ?,
                                                                                  first_attempt_on = if(first_attempt_on IS NULL,  NOW(), first_attempt_on),
                                                                                  first_attempt_by = if(first_attempt_by = "", '.USER_ID.',first_attempt_by),
                                                                                  last_attempt_on = NOW(), total_attempts = total_attempts+1, status=2 WHERE phone_call_id = '.$id.' LIMIT 1;'
                                                                                  , array($resultCode, $notes, $timer) );

                                if($statment){
                                        $pass_all = 1;
                                } else {
                                        $error_list .= '<li>Error #96: System could not update Phone Call</li>';
                                        $pass_all = 0;
                                }
                        $statment = null;
                }

                //Update the existing phone call & Keep it open to be called again
                if( $next_action == 'TRY AGAIN'){

                        $new_call = $db->getDataSet('SELECT call_code_title AS subject FROM call_codes WHERE call_code_id= '.$callCode.' LIMIT 1;' );

                                if( count($new_call) == 1 ){
                                        $subject = $new_call[0]['subject'];
                                } else {
                                        $error_list .= '<li>Error #79: Unknown Error: call code was not found.</li>';
                                }
                        $new_call = null;
                        $this_attempt = $total_attempts+1;

                        if($this_attempt >= 1){
                                $subject = $subject . ' attempt: ' . $this_attempt;
                        }

                                        $statment = $db->processQuery('INSERT INTO phone_calls (account_id, call_code_id, trigger_on, created_on, call_subject, status, last_call_id
                                                                                , call_direction, owner_id, workflow_generated, call_notes)
                                                                                                                 VALUES('.$account_id.', '.$callCode.', "'.$triggerOn.'", NOW(), "'.$subject.'", 1, '.$id.', "OUTBOUND", '.USER_ID.', 1, "");');                                                                                                                                         

                                if($statment ){
                                        $pass_all = 1;
                                } else {
                                        $error_list .= '<li>Error #80: System could not generate a new attempt</li>';
                                        $pass_all = 0;
                                }
                $statment = null;

                }

                //Update the existing phone call THEN assign the activity to the master user define in APP_configuration.php
                if( $next_action == 'MGR REVIEW'){

                        $statment = $db->processQuery('UPDATE phone_calls SET result_code_id= ?, call_notes= ?, call_duration = ?,
                                                                                  first_attempt_on = if(first_attempt_on IS NULL,  NOW(), first_attempt_on),
                                                                                  first_attempt_by = if(first_attempt_by = "", '.USER_ID.',first_attempt_by),
                                                                                  last_attempt_on = NOW(), total_attempts = total_attempts+1,
                                                                                  trigger_on = ?, owner_id = '.CMS_ADMIN_ID.' WHERE phone_call_id = '.$id.' LIMIT 1;'
                                                                                  , array($resultCode, $notes, $timer, $triggerOn) );

                                if($statment){
                                        $pass_all = 1;
                                } else {
                                        $error_list .= '<li>Error #98: System could not update Phone Call</li>';
                                        $pass_all = 0;
                                }
                $statment = null;
                }

                if($sendUpdate == 1 && $error_list == '' && $pass_all == 1 ){

                $statment = $db->processQuery('DELETE FROM phone_calls WHERE last_call_id = '.$id.' LIMIT 1;');

                                if($statment){
                                        $pass_all = 1;
                                } else {
                                        $error_list .= '<li>Error #81: System could not run reverse system flow.</li>';
                                        $pass_all = 0;
                                }                      
                $statment = null;
                }

                //Generate new phone call
                if( $next_action == 'CREATE NEW CALL'){

                        //Find the nect call code to generate

                                $new_call = $db->getDataSet('SELECT ie.action_id, CONCAT(cc.call_code_name, " - ", cc.call_code_title) AS subject FROM inventory_engine AS ie
                                                                                         INNER JOIN call_codes AS cc ON ie.action_id = cc.call_code_id
                                                                                         WHERE ie.call_code_id= ?  AND ie.result_code_id = ? LIMIT 1;', array($callCode,$resultCode ) );

                                if( count($new_call) == 1 ){
                                        $new_callcode_id = $new_call[0]['action_id'];
                                        $subject = $new_call[0]['subject'];
                                } else {
                                        $error_list .= '<li>Error #94: Unknown Error: call code was not found.</li>';
                                }

                                $new_call = null;

                $statment = $db->processQuery('INSERT INTO phone_calls (account_id, call_code_id, trigger_on, created_on, call_subject, status, last_call_id
                                                                                , call_direction, owner_id, workflow_generated, call_notes)
                                                                                                                 VALUES(?, ?, ?, NOW(), ?, 1, ?, "OUTBOUND", ?, 1, "");',
                                                                                                                 array($account_id, $new_callcode_id, $triggerOn, $subject, $id, USER_ID ) );

                                if($statment){
                                        $pass_all = 1;
                                } else {
                                        $error_list .= '<li>Error #99: System could not update Phone Call</li>';
                                        $pass_all = 0;
                                }
                $statment = null;
                }

                if($pass_all == 1 && $error_list == ''){
                        $pass_message = '<li>You have successfully complete the phone call.</li>';
                } else {
                        $error_list .= '<li>Error #100: Unknown Error: Please contact your system admin</li>';
                }

        }

//close database connection
$db->endConnection();

        $return = array();
        if($pass_message != ''){

                $return['msg']   = '<ul>'.$pass_message.'</ul>';
                $return['error'] = false;

        } else {
                $return['msg'] = '<ul>'. $error_list.'</ul>';
                $return['error'] = true;
        }

echo json_encode($return);

?> 
```

这是我的实际代码，不插入记录

[http://pastebin.com/QSt03qqx](http://pastebin.com/QSt03qqx)

谢谢你的帮助 ：）

PS 这是不会在我的代码中运行的查询，但是当我在 PHPmyadmin 中运行它时它会运行

```
INSERT INTO phone_calls (account_id, call_code_id, trigger_on, created_on, call_subject, status, last_call_id , call_direction, owner_id, workflow_generated, call_notes) VALUES(11601, 1, "2013-04-11 16:36:00", NOW(), "Initial Development attempt: 1", 1, 17132, "OUTBOUND", 1, 1, ""); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:05:29.797

> 可能是什么问题呢？我还能检查什么？为什么插入在脚本中不起作用，而在 phpmyadmin 中起作用？

欢迎来到程序员的话。
事实上，编程不仅仅是*写*代码。
但是，不幸的是，程序员最多 50% 的时间都花在了回答您上面提出的问题上。这不是一件容易的工作。必须付出相当大的努力。坏消息是，这类问题在问答网站上几乎找不到答案。你自己怎么回答的？所以，你自己的手是你最后的手段。因此，卷起袖子开始调试：

1.  确保您可以看到 PHP 引发的每个错误。
2.  确保 PDO 确实在错误时引发异常。
3.  确保您没有使用`@`,`try..catches`和零错误报告来扼杀这些错误。
4.  设置看门狗来记录错误查询、它们的数据并从 mysql 获得诊断（至少 SHOW PROCESSLIST）。

# jenkins - 将 Xbuild 与 Xamarin.Android（以前的 Mono for Android）一起使用

> ID：15815601
> 
> 赞同：1
> 
> 时间：2013-04-04T15:35:15.260
> 
> 标签：jenkins, xamarin.android, xamarin, xbuild

我们有一个 Xamarin.Android 项目，我们正在尝试在 Mac 上使用 Jenkins 构建该项目。解决方案文件包含几个不同的项目，其中之一是 MonoDroid 项目。MonoDroid 项目依赖于解决方案中的其他项目。

我遇到的问题是，当我使用`xbuild`构建解决方案文件时，我无法使用 /t:PackageForAndroid 目标，因为它仅对 MD 项目文件有效。

目前在詹金斯，我这样做是这样的：

```
xbuild MyCoolDroidAp/MyCoolDroidApp.sln /p:Configuration=Release /t:Clean
xbuild MyCoolDroidApp/MyCoolDroidApp.sln /p:Configuration=Release /t:Build
xbuild MyCoolDroidApp/MyCoolDroidProject.csproj /p:Configuration=Release /t:PackageForAndroid 
```

这是可行的，但在我看来，应该有办法消除第三步。有没有人有任何见解？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T17:02:27.037

您无需使用 Xamarin.Studio/MonoDevelop 对您的 APK 进行签名和压缩对齐，您可以在命令行中执行此操作。我很幸运使用[rake 来编译、签名和压缩我的 APK 文件](https://gist.github.com/topgenorth/5094153)。这样的东西对你有用吗？

如果做不到这一点，这里有一个简单的 Powershell 脚本，你可以很容易地移植它：

```
# First clean the Release target.
msbuild.exe HelloWorld.csproj /p:Configuration=Release /t:Clean

# Now build the project, using the Release target.
msbuild.exe HelloWorld.csproj /p:Configuration=Release /t:PackageForAndroid

# At this point there is only the unsigned APK - sign it.
# The script will pause here as jarsigner prompts for the password.
# It is possible to provide they keystore password for jarsigner.exe by adding an extra command line parameter -storepass, for example
#    -storepass <MY_SECRET_PASSWORD>
# If this script is to be checked in to source code control then it is not recommended to include the password as part of this script.
& 'C:\Program Files\Java\jdk1.6.0_24\bin\jarsigner.exe' -verbose -sigalg MD5withRSA -digestalg SHA1  -keystore ./xample.keystore -signedjar 
./bin/Release/mono.samples.helloworld-signed.apk 
./bin/Release/mono.samples.helloworld.apk publishingdoc

# Now zipalign it.  The -v parameter tells zipalign to verify the APK afterwards.
& 'C:\Program Files\Android\android-sdk\tools\zipalign.exe' -f -v 4
./bin/Release/mono.samples.helloworld-signed.apk ./helloworld.apk 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:04:25.480

围绕互联网的共识似乎是我这样做是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-21T12:07:06.077

关于签署你的apk，我使用这样的东西作为我的makefile的一部分，它工作正常：

```
...

BUILD_DIR = ./builds/$(platform)
KEYSTORE_PATH = your_keystore_pass
STORE_PASS = your_keystore_pass
ANDROID_SDK_PATH = path/to/your/android/sdk/dir 
#example ANDROID_SDK_PATH = /Developer/AndroidSDK
RES_APK = my_apk.apk
APK_NAME = my_signed_apk.apk

...

sign:
  (cd $(BUILD_DIR); jarsigner -verbose -sigalg MD5withRSA -digestalg SHA1 -keystore $(KEYSTORE_PATH) -storepass $(STORE_PASS) result.apk $(STORE_PASS))
  (cd $(BUILD_DIR); $(ANDROID_SDK_PATH)/tools/zipalign -v 4 result.apk $(APK_NAME))
  (cd $(BUILD_DIR);rm result.apk)
  (cd $(BUILD_DIR);rm $(RES_APK)) 
```

希望这可以帮助

# java - 在按钮单击时将图标添加到 ActionListener 中的 JLabel

> ID：15815603
> 
> 赞同：0
> 
> 时间：2013-04-04T15:35:20.487
> 
> 标签：java, swing, jbutton, jlabel, imageicon

我正在尝试将已在代码中定义的图像添加到 JLabel，但仅在单击按钮时。

目前，我已将图标定义如下：

```
 public class Lights extends JPanel implements ActionListener
    {
        public Lights()
        {
            //Dimmable light icons
            ImageIcon dimmable0 = createImageIcon("images/Dimmer0.png");
            ImageIcon dimmable1 = createImageIcon("images/Dimmer1.png");
            ImageIcon dimmable2 = createImageIcon("images/Dimmer2.png");
            ImageIcon dimmable3 = createImageIcon("images/Dimmer3.png"); 
```

在这部分设置它们可以很好地使用

```
 kDimLightLabel = new JLabel(dimmable0); 
```

然后，当我实现 ActionListener 时，我有一个按钮可以打开灯，当它打开时，我希望它将图标设置为 dimmable3 图标。目前它位于：

```
 public void actionPerformed(ActionEvent e)
{
    if(e.getSource() == kLightOn)
    {
        if(Lights[0].getlightStatus() == "Off")
        {
            Lights[0].setlightStatus("On");
            kLightOnOffLabel.setText(Lights[0].getlightStatus());
            kLights.setValue(3); //sets slider as lights go on or off
            dimmableLights[0].setdimLevel(3); //sets array value
            kDimLightLabel.setIcon(dimmable3); //sets label image
        }
    } 
```

当我运行它时，我得到了 12 个错误，对于 12 个按钮中的每一个都是相同的行！

kDimLightLabel.setIcon(dimmable3); //设置标签图像^符号：变量dimmable3位置：类灯

任何有关如何以正确方式设置图标的帮助将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:42:06.010

您的代码会建议该变量`dimmable3`仅在构造函数的范围内可用`Lights`。尝试使所有`ImageIcon`变量在类级别可用。

```
public class Lights extends JPanel implements ActionListener {
   private ImageIcon dimmable0; // initialize in constructor
   ...
   public Lights() {
      dimmable0 = createImageIcon(...);
      ... 
```

除此之外，这看起来很可疑：

```
if (Lights[0].getlightStatus() == "Off") 
```

它会建议您为每个实例都有一个静态`getlightStatus`方法。`Lights`使用非静态方法将确保每个实例都可以拥有自己的`lightStatus`. 也用于`String#equals`比较`String`内容。`==`运算符用于比较`Object`引用，通常*不是*您想要的。

# asp.net - 为什么我的自定义 404 错误处理程序在部署到 Web 服务器后不起作用

> ID：15815605
> 
> 赞同：4
> 
> 时间：2013-04-04T15:35:30.100
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4, error-handling, http-status-code-404

我关注[了这篇文章](https://stackoverflow.com/a/3160526/310767)并创建了一个全局错误处理程序。我自己添加了处理 404 错误。但是，当我在本地测试时它工作正常，但一旦部署到 Web 服务器，我的自定义消息就不再显示了。相反，出现了默认的丑陋的。

在远程调试中，我可以跟踪执行，它确实得到了我的自定义 404 错误操作，但不知何故，IIS 在某个时候接管了。

在我的 Global.asax.cs 中，我有：

```
protected void Application_Error()
{
    var exception = Server.GetLastError();
    var httpException = exception as HttpException;

    Response.Clear();
    Server.ClearError();

    var routeData = new RouteData();
    routeData.Values["controller"] = "Error";
    routeData.Values["action"] = "General";
    routeData.Values["exception"] = exception;

    Response.StatusCode = 500;

    if (httpException != null)
    {
        Response.StatusCode = httpException.GetHttpCode();

        switch (Response.StatusCode)
        {
            case 403:
                routeData.Values["action"] = "Http403";
                break;
            case 404:
                routeData.Values["action"] = "Http404";
                break;
        }
    }

    IController errorController = new ErrorController();
    var rc = new RequestContext(new HttpContextWrapper(Context), routeData);
    errorController.Execute(rc);
} 
```

然后在我的 ErrorHandler.cs 中，我有：

```
public ActionResult General(Exception exception)
{
    // log error

    return Content("General error", "text/html");
}

public ActionResult Http403(Exception exception)
{
    return Content("Forbidden", "text/plain");
}

public ActionResult Http404(Exception exception)
{
    return Content("Page not found.", "text/plain"); // this displays when tested locally, but not after deployed to web server.
} 
```

}

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T16:02:36.357

你是对的，远程 IIS 正在接管你的 404 页面。您需要的是告诉 IIS 跳过自定义错误设置`Response.TrySkipIisCustomErrors = true;`

所以你的代码应该是这样的。

```
protected void Application_Error()
{
    //...
    Response.TrySkipIisCustomErrors = true;
    Response.StatusCode = 404;
    //...rest of your code
} 
```

另请查看此链接以获取更多信息[http://www.west-wind.com/weblog/posts/2009/Apr/29/IIS-7-Error-Pages-taking-over-500-Errors](http://www.west-wind.com/weblog/posts/2009/Apr/29/IIS-7-Error-Pages-taking-over-500-Errors)

# php - HTML 输入自动完成/建议

> ID：15815610
> 
> 赞同：-2
> 
> 时间：2013-04-04T15:35:44.207
> 
> 标签：php, javascript, jquery, html

如何进行输入，以便当用户单击它时，它会显示输入可以采用的所有可能值？我可以使用 php 从我的数据库中获取值，但是要显示如下图所示的内容，我想我将不得不使用 javascript？我该怎么做？

例如，在 phpPgAdmin 中：

![在此处输入图像描述](https://i.stack.imgur.com/0AJo5.jpg)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:39:40.547

HTML中的选择标签怎么样？它会创建一个下拉菜单，其中包含您可以从 php 脚本（从数据库中获取）加载的选项。W3Schools 的一个例子在这里：

```
<select>
  <option value="volvo">Volvo</option>
  <option value="saab">Saab</option>
  <option value="mercedes">Mercedes</option>
  <option value="audi">Audi</option>
</select> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T15:47:27.190

在 html5 中，您有一个新的表单输入：

```
<input id="color" list="suggests">
<datalist id="suggests">
    <option value="Black">
    <option value="Red">
    <option value="Green">
    <option value="Blue">
    <option value="White">
</datalist> 
```

如果您的浏览器不支持此输入，您可以使用此处描述的 polyfill：http: [//css-tricks.com/relevant-dropdowns-polyfill-for-datalist/](http://css-tricks.com/relevant-dropdowns-polyfill-for-datalist/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T15:39:44.977

最好的插件或最容易弄清楚的是

[http://jqueryui.com/autocomplete/](http://jqueryui.com/autocomplete/)

我认为这对于我们使用 php 作为后端的用例来说应该足够了，并且还有多个自定义选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T15:41:48.990

这可以通过 Ajax 实现

**脚步 ：**

```
1\. prepare database for such suggested values.
2\. On key event run Ajax
3\. Get Response of Ajax and show in list using ul li in HTML 
```

**例如**

[http://www.ajaxdaddy.com/demo-jquery-autocomplete.html](http://www.ajaxdaddy.com/demo-jquery-autocomplete.html)

# matlab - subs(sinc(K), K, 0) 其中 K 是符号将返回 NaN。不应该是1吗？

> ID：15815613
> 
> 赞同：2
> 
> 时间：2013-04-04T15:35:52.723
> 
> 标签：matlab, symbolic-computation

MATLAB`sinc(0)`将按应有的方式返回 1。但是`sinc(K)`一些`K`用零值代替的符号将返回`NaN.`

以下代码说明了上述内容：

```
sinc(0)  % calculate sinc of 0, this will return 1

K = sym('K'); % define symbol K

% try to substitute value 0 for K in sinc(K), this will return NaN
subs(sinc(K), K, 0) 
```

我可以`sinc`在符号情况下强制返回 1（事先不知道 的值`K`）吗？

```
MATLAB Version: 8.0.0.783 (R2012b)
Symbolic Math Toolbox  Version 5.9  (R2012b) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T16:21:46.223

您正在潜水`0/0`，即`NaN`直接替换为`sin(pi*K)/(K*pi)`.

这`sinc`实际上是为了规避这一点。

```
i = find(x==0);                                                              
x(i) = 1;                                
y = sin(pi*x)./(pi*x);                                                     
y(i) = 1; 
```

您可以通过向您的值添加一个小的正则化器来获得相同的效果：

```
subs(sinc(K), K, 0+eps) 
ans =

     1 
```

# arrays - 在 vb.net 中构造的数据

> ID：15815619
> 
> 赞同：0
> 
> 时间：2013-04-04T15:36:13.413
> 
> 标签：arrays, vb.net, string

我在 Visual Basic .net 中有这个结构

```
Private Structure queueT
        Public name As String
        Public parent As String
        Public limitat As Integer
        Public maxlimit As Integer 
```

这是我得到的数据，我将其存储在一个一维字符串数组中（仅粘贴 3）：

```
!re=.id=*10000B0=name=Up-PBX=parent=Up=packet-mark=pack_pbx=limit-at=256000=queue=PCQ_Up=priority=1=max-limit=512000=burst-limit=0=burst-threshold=0=burst-time=00:00:00=invalid=true=disabled=true=comment=PBX

!re=.id=*10000C7=name=Down_Mauro=parent=Down=packet-mark==limit-at=315000=priority=8=max-limit=5000000=burst-limit=0=burst-threshold=0=burst-time=00:00:00=invalid=false=disabled=true

!re=.id=*10000C8=name=Down_Mauro_dom=parent=Down_Mauro=packet-mark=pack_Mauro_dom=limit-at=40000=queue=PCQ_Down=priority=2=max-limit=400000=burst-limit=0=burst-threshold=0=burst-time=00:00:00=invalid=false=disabled=true 
```

我需要将信息存储在我的结构中，所以它看起来像这样：

```
queueT.name = UP-PBX
queueT.parent = UP
queueT.limitat = 256000
queueT.maxlimit = 512000 
```

我只需要上面提到的信息，不需要其他的。我怎样才能做到这一点？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T16:03:11.153

看起来它是第一个值之后的键/值对。从您的样本中，这样的东西可能会起作用。

```
Private Function queueTParse(item As String) As queueT

    Dim queueValues = item.Split("=")
    Dim queueTItem = New queueT

    For i As Integer = 1 To queueValues.Length - 1 Step 2

        Select Case queueValues(i)
            Case "name"
                queueTItem.name = queueValues(i + 1)
            Case "parent"
                queueTItem.parent = queueValues(i + 1)
            Case "limit-at"
                queueTItem.limitat = queueValues(i + 1)
            Case "max-limit"
                queueTItem.maxlimit = queueValues(i + 1)
        End Select

    Next

    Return queueTItem

End Function 
```

# java - java设置类路径

> ID：15815621
> 
> 赞同：0
> 
> 时间：2013-04-04T15:36:13.697
> 
> 标签：java, jar, classpath

我刚刚在控制台中编译了一个 java 程序。现在我想运行它。我需要用于 postgresql 和 mysql 的 jdbc 驱动程序。因此我需要包括相应的罐子。

我做了以下

```
java -Xmx512m -cp ".;/path/to/sql/jars" main.Main rc 
```

这样做时，我得到以下错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: main/Main
Caused by: java.lang.ClassNotFoundException: main.Main
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
Could not find the main class: main.Main. Program will exit. 
```

当像这样忽略类路径选项时

```
java -Xmx512m  main.Main rc 
```

我收到以下错误

```
java.lang.ClassNotFoundException: org.postgresql.Driver
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:186)
    at database.PostgresQL.getConnection(Unknown Source)
    at database.PostgresQL.loadIndexFromDatabase(Unknown Source)
    at main.Main.readDataFromDatabase(Unknown Source)
    at main.Main.main(Unknown Source) 
```

因此，程序可以正常运行。我的问题：如何告诉程序在控制台中正确查找罐子？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T15:40:16.393

```
java -Xmx512m -cp ".;/path/to/sql/jars" main.Main rc 
```

首先，路径分隔符仅`;`在 Windows 上，`:`在其他平台上。其次，如果`/path/to/sql/jars`是包含 JAR 文件的*目录*，那么您需要`/*`在末尾添加 a 并使用单引号而不是双引号：

```
java -Xmx512m -cp '.:/path/to/sql/jars/*' main.Main rc 
```

该`java`命令将`path/*`类路径中的命令视为等同于`path/some-jar.jar:path/another-jar.jar`枚举目录中的所有 JAR 文件，但您必须防止`*`shell 扩展（因此使用单引号）。

如果您*使用的是*Windows，那么同样的技巧也适用，但使用分号、反斜杠和双引号：

```
java -Xmx512m -cp ".;C:\path\to\sql\jars\*" main.Main rc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:39:25.713

类路径条目的分隔符`;`在 Windows 和`:`Linux 上。根据路径，您似乎在 Linux 上。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-04-04T15:56:29.933

只需将 PostgreSQL 和 MySQL 连接器 jar 复制到 jdk.x.x_xx\jre\lib\ext 和 jre7\lib\ext 文件夹中（您可以在 PostgreSQL 和 MySQL 的安装目录中找到它们，

例如：-对于 MySQL，connector.jar 位于 MySQL\MySQL Connector J 文件夹中）

# java - 4.0之前的旧版本android如何安全地存储密码，accesstoken等数据？

> ID：15815622
> 
> 赞同：0
> 
> 时间：2013-04-04T15:36:15.293
> 
> 标签：java, android, security, mobile, android-keystore

我正在构建一个需要在 android 设备上存储安全数据的 android 应用程序，该设备还支持 4.0 之前的旧版本 android。我知道 android 4.0 和之后的版本支持钥匙串，但我的应用程序需要支持旧版本。那么任何人都可以帮助并让我知道旧操作系统版本的Android中使用了哪种方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:43:50.930

在 ICS 之前的 Android 版本上，您可以使用`KeyStore`，以下是存储到的示例`KeyStore`：

```
public boolean setEntry(String alias, String secretKey) {

    boolean keyStoreEntryWritten = false;

    if (mKeystore != null && secretKey != null) {
        // store something in the key store
        SecretKeySpec sks = new SecretKeySpec(secretKey.getBytes(), "MD5");
        KeyStore.SecretKeyEntry ske = new KeyStore.SecretKeyEntry(sks);
        KeyStore.ProtectionParameter pp = new KeyStore.PasswordProtection(null);

        try {
            mKeystore.setEntry(alias, ske, pp);

            // save key store
            boolean success = saveKeyStore();

            if (success) {
                keyStoreEntryWritten = true;
            }
        } catch (KeyStoreException ex) {
            Log.e(TAG, "Failed to read keystore" + mKeyStoreName);
        }
    }
    return keyStoreEntryWritten;
}

private boolean saveKeyStore() {

    FileOutputStream fos = null;
    boolean keyStoreSaved = true;

    // generate key store path
    String keyStoreFilePath = generateKeyStoreFilePath(mKeyStoreName, mKeystoreDirectoryPath);

    try {
        fos = new FileOutputStream(keyStoreFilePath);
        mKeystore.store(fos, mKeyStorePassword.toCharArray());
    } catch (Exception ex) {
        keyStoreSaved = false;
        Log.e(TAG, "Failed to save keystore " + mKeyStoreName);
    } finally {
        if (fos != null) {
            try {
                fos.close();
            } catch (IOException ex) {
                keyStoreSaved = false;
                Log.e(TAG, "Failed to close FileOutputStream");
            }
        }
    }
    return keyStoreSaved;
} 
```

您可以在这里找到更多信息：http: [//developer.android.com/reference/java/security/KeyStore.html](http://developer.android.com/reference/java/security/KeyStore.html "http://developer.android.com/reference/java/security/KeyStore.html")

**编辑：** 这是您检索密钥的方式：

```
public String getEntry(String alias) {

    String secretStr = null;
    byte[] secret = null;

    if (mKeystore != null) {

        try {
            if (!mKeystore.containsAlias(alias)) {
                Log.w(TAG, new StringBuilder().append("Keystore ").append(mKeyStoreName)
                        .append(" does not contain entry ").append(alias).toString());
                return null;
            }
        } catch (KeyStoreException ex) {
            Log.e(TAG, "Failed to read keystore entry " + alias);
        }

        // get my entry from the key store
        KeyStore.ProtectionParameter pp = new KeyStore.PasswordProtection(null);
        KeyStore.SecretKeyEntry ske = null;
        try {
            ske = (KeyStore.SecretKeyEntry) mKeystore.getEntry(alias, pp);
        } catch (Exception ex) {
            Log.e(TAG, "Failed to read keystore entry " + alias);
        }

        if (ske != null) {
            SecretKeySpec sks = (SecretKeySpec) ske.getSecretKey();
            secret = sks.getEncoded();

            if (secret != null) {
                secretStr = new String(secret);

            } else {
                Log.e(TAG, new StringBuilder().append("Read empty keystore entry ").append(alias).toString());
            }
        } else {
            Log.e(TAG, "Failed to read keystore entry " + alias);
        }
    }
    return secretStr;
} 
```

# sql-server - 使用 ROW_NUMBER 和动态排序的 SQL 性能

> ID：15815624
> 
> 赞同：14
> 
> 时间：2013-04-04T15:36:18.387
> 
> 标签：sql-server

我意识到这是一个常见问题，之前已经在 SO[上](https://stackoverflow.com/questions/3233164/row-number-cte-performance-when-using-order-by-case)讨论过，但我想我会再次提出这个问题，希望能找到一些可行的替代方案。

采用以下将分页与动态排序相结合的 SQL：

```
WITH CTE AS (
  SELECT 
      OrderID,
      ROW_NUMBER() OVER (ORDER BY
        CASE WHEN @SortCol='OrderID' THEN OrderID END ASC,
        CASE WHEN @SortCol='CustomerName' THEN Surname END ASC 
      ) AS ROW_ID
  FROM Orders WHERE X
)

SELECT Orders.* FROM CTE
INNER JOIN Orders ON CTE.OrderID = Orders.OrderID
WHERE ROW_ID BETWEEN @RowStart AND @RowStart + @RowCount -1; 
```

众所周知，ROW_NUMBER() 方法不适用于大型表，因为在 ORDER BY 子句中使用多个 CASE 语句时无法正确使用表上的索引（请参阅[链接](https://stackoverflow.com/questions/3233164/row-number-cte-performance-when-using-order-by-case)）。

我们多年来一直使用的解决方案是构造一个字符串，然后使用 sp_executesql 执行该字符串。使用这样的动态 SQL 时性能很好，但从易读性的角度来看，生成的代码很糟糕。

我听说过[ROWCOUNT 方法](http://www.4guysfromrolla.com/webtech/042606-1.shtml)，但据我所知，当您引入按元素的动态顺序时，它仍然容易受到相同问题的影响。

那么，冒着问不可能的风险，还有哪些其他选择呢？

**编辑**

为了在这里取得一些有用的进展，我汇总了三个查询，突出显示了各种建议的方法：

1.  当前，动态 SQL 解决方案（执行时间 147ms）

2.  gbn 解决方案（执行时间1687ms）

3.  Anders解决方案（执行时间1604ms）

4.  Muhmud 解决方案（执行时间 46ms）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-08T10:58:56.207

这个怎么样：

```
WITH data as (
    SELECT OrderID,
            ROW_NUMBER() OVER ( ORDER BY OrderID asc) as OrderID_ROW_ID,
            ROW_NUMBER() OVER ( ORDER BY Surname asc) as Surname_ROW_ID
        FROM Orders --WHERE X   
), CTE AS (               
        SELECT OrderID, OrderID_ROW_ID as ROW_ID
        FROM data
        where @SortCol = 'OrderID'

        union all

        SELECT OrderID, Surname_ROW_ID
        FROM data
        where @SortCol = 'Surname'
)
SELECT Orders.*, ROW_ID FROM CTE
INNER JOIN Orders ON CTE.OrderID = Orders.OrderID       
WHERE ROW_ID BETWEEN @RowStart AND @RowStart + @RowCount -1
order by ROW_ID
option (recompile); 
```

**编辑：**在帖子中的示例查询上使用`option (recompile)`它会更快。但是，`case`不能以这种方式在升序/降序之间进行选择。

其原因是正在为不适当的变量值生成计划，然后缓存该计划。强制重新编译允许它使用变量的实际值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-09T15:32:37.450

**（已编辑）**

```
DECLARE 
      @OrderColumnName SYSNAME
    , @RowStart INT
    , @RowCount INT
    , @TopCount INT

SELECT 
      @OrderColumnName = 'EmployeeID'
    , @RowStart = 5
    , @RowCount = 50
    , @TopCount = @RowStart + @RowCount – 1 
```

@muhmud 的解决方案 -

```
; WITH data AS 
(
    SELECT 
          wo.WorkOutID
        , RowIDByEmployee = ROW_NUMBER() OVER (ORDER BY wo.EmployeeID)
        , RowIDByDateOut = ROW_NUMBER() OVER (ORDER BY wo.DateOut)  
    FROM dbo.WorkOut wo
), CTE AS 
(         
    SELECT
          wo.WorkOutID
        , RowID = RowIDByEmployee 
    FROM data wo
    WHERE @OrderColumnName = 'EmployeeID'

    UNION ALL

    SELECT
          wo.WorkOutID
        , RowID = RowIDByDateOut
    FROM data wo
    WHERE @OrderColumnName = 'DateOut'
)
SELECT wo.*  
FROM CTE t
JOIN dbo.WorkOut wo ON t.WorkOutID = wo.WorkOutID
WHERE t.RowID BETWEEN @RowStart AND @RowCount + @RowStart - 1
ORDER BY t.RowID
OPTION (RECOMPILE)

Table 'WorkOut'. Scan count 3, logical reads 14254, physical reads 1,
read-ahead reads 14017, lob logical reads 0, lob physical reads 0, lob
read-ahead reads 0\. Table 'Worktable'. Scan count 0, logical reads 0,
physical reads 0, read-ahead reads 0, lob logical reads 0, lob
physical reads 0, lob read-ahead reads 0.
 SQL Server Execution Times:
   CPU time = 1295 ms,  elapsed time = 3048 ms. 
```

无数据公用表表达式的解决方案——

```
;WITH CTE AS 
(         
    SELECT
          wo.WorkOutID
        , RowID = ROW_NUMBER() OVER (ORDER BY wo.EmployeeID) 
    FROM dbo.WorkOut wo
    WHERE @OrderColumnName = 'EmployeeID'

    UNION ALL

    SELECT
          wo.WorkOutID
        , RowID = ROW_NUMBER() OVER (ORDER BY wo.DateOut) 
    FROM dbo.WorkOut wo
    WHERE @OrderColumnName = 'DateOut'
)
SELECT wo.*  
FROM CTE t
JOIN dbo.WorkOut wo ON t.WorkOutID = wo.WorkOutID
WHERE t.RowID BETWEEN @RowStart AND @RowCount + @RowStart - 1
ORDER BY t.RowID
OPTION (RECOMPILE)

Table 'WorkOut'. Scan count 3, logical reads 14254, physical reads 1, read-ahead reads 14017, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'Worktable'. Scan count 0, logical reads 0, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.

 SQL Server Execution Times:
   CPU time = 1296 ms,  elapsed time = 3049 ms. 
```

TOP 解决方案 -

```
;WITH CTE AS 
(         
    SELECT TOP (@TopCount)
          wo.WorkOutID
        , RowID = ROW_NUMBER() OVER (ORDER BY wo.EmployeeID) 
    FROM dbo.WorkOut wo
    WHERE @OrderColumnName = 'EmployeeID'

    UNION ALL

    SELECT TOP (@TopCount)
          wo.WorkOutID
        , RowID = ROW_NUMBER() OVER (ORDER BY wo.DateOut) 
    FROM dbo.WorkOut wo
    WHERE @OrderColumnName = 'DateOut'
)
SELECT wo.*  
FROM CTE t
JOIN dbo.WorkOut wo ON t.WorkOutID = wo.WorkOutID
WHERE t.RowID > @RowStart - 1
ORDER BY t.RowID
OPTION (RECOMPILE)

Table 'WorkOut'. Scan count 3, logical reads 14246, physical reads 1, read-ahead reads 14017, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'Worktable'. Scan count 0, logical reads 0, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.

 SQL Server Execution Times:
   CPU time = 1248 ms,  elapsed time = 2864 ms. 
```

* * *

![在此处输入图像描述](https://i.stack.imgur.com/veWE5.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T20:41:47.000

我会尝试类似的事情：

```
WITH CTEOrder AS (
  SELECT 
     OrderID,
     ROW_NUMBER() OVER (ORDER BY OrderID ASC) AS ROW_ID
  FROM Orders 
)
, CTECustomerName AS (
  SELECT 
     OrderID,
     ROW_NUMBER() OVER (ORDER BY Surname ASC) AS ROW_ID
  FROM Orders 
)
, CTECombined AS
(
  SELECT 'OrderID' OrderByType, OrderID, Row_ID
    FROM CTEOrder
   WHERE Row_id BETWEEN @RowStart AND @RowStart + @RowCount -1
  UNION
  SELECT 'CustomerName' OrderByType, OrderID, Row_ID
    FROM CTECustomerName
   WHERE row_id BETWEEN @RowStart AND @RowStart + @RowCount -1
)
SELECT Orders.* FROM CTECombined
INNER JOIN Orders ON CTECombined.OrderID = Orders.OrderID       
WHERE ROW_ID BETWEEN @RowStart AND @RowStart + @RowCount -1;  
AND OrderByType = @SortCol 
```

我用我自己的一张桌子尝试了这个，它有应用程序。400 万条记录。显然，它有不同的字段名称，所以如果我没有在答案中正确“翻译”这个并且 SQL 没有为您运行，我深表歉意。但是，这个想法应该是显而易见的。

使用您问题中的代码，我在我的表上获得了应用程序 200000 逻辑读取和 6068 毫秒 CPU，而上面我获得了 1422 逻辑读取和 78 毫秒 CPU。

我没有刷新缓存或任何其他真正的基准测试所需的东西，但我确实尝试了不同的页面、页面大小等，我的结果从一开始就一致。

如果您有许多想要排序的不同字段的查询，则此解决方案可能无法充分扩展，因为您必须扩展 CTE 的数量，但如果您仍然在构建 SQL，则可以在代码中执行此操作 - 并且对于对两个不同字段进行排序的示例对我来说就像一个魅力。

编辑：想一想，您可能不需要为每个 OrderBy 列单独的 CTE，您可能只需要一个在同一个 CTE 中同时执行`ROW_NUMBER()`的`UNION`CTE。原理是一样的，我认为优化器最终会做同样的事情，但我还没有进行基准测试。如果有时间验证，我会更新答案。

编辑 2：正如预期的那样，您可以`UNION`在一个 CTE 内完成。我不会更新代码，但我会按原样提供一些代码基准。我做了 10000 行的页面大小，看看这是否有很大的不同，但没有。（cusinar9 和我的代码的两次运行分别是等效运行的，所以冷启动两个版本的代码参数相同，第二次运行的参数不同，但两个版本的代码相同）：

**cusimar9的代码，冷启动：**

```
Table 'TestTable'. Scan count 10009, logical reads 43080, physical reads 189, read-ahead reads 12915, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'Worktable'. Scan count 0, logical reads 0, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.

SQL Server Execution Times:   CPU time = 3037 ms,  elapsed time = 2206 ms. 
```

**cusimar9 的代码，第二次运行，不同的参数：**

```
Table 'TestTable'. Scan count 10009, logical reads 43096, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'Worktable'. Scan count 0, logical reads 0, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.

SQL Server Execution Times:   CPU time = 4132 ms,  elapsed time = 1012 ms. 
```

**我的建议，冷启动：**

```
Table 'TestTable'. Scan count 10001, logical reads 31963, physical reads 12, read-ahead reads 6984, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'Worktable'. Scan count 0, logical reads 0, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.

SQL Server Execution Times:   CPU time = 218 ms,  elapsed time = 1410 ms. 
```

**我的建议，第二次运行：**

```
Table 'TestTable'. Scan count 10001, logical reads 31963, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'Worktable'. Scan count 0, logical reads 0, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.

SQL Server Execution Times:   CPU time = 218 ms,  elapsed time = 358 ms. 
```

* * *

编辑3：看到您发布的代码，我注意到了这个结构：

```
PagedCTE AS (
    SELECT (SELECT Max(ROW_ID) FROM OrderByCTE) AS TOTAL_ROWS, OrderID 
    FROM OrderByCTE             
    WHERE
        OrderByCTE.SortCol = @SortCol AND OrderByCTE.SortDir = @SortDir AND
        OrderByCTE.ROW_ID BETWEEN @RowStart AND @RowStart + @RowCount -1
) 
```

我不能 100% 确定这样做的目的，但我猜您想返回总行数，以便您可以计算（并向用户显示）我们在记录集中的距离。那么为什么不把这个数字排除在所有`ORDER BY`噪音之外呢？要坚持当前的风格，为什么不使用 ? 制作 CTE `SELECT COUNT(*)`？然后加入你的最终选择？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T16:10:38.900

尝试这个。这应该利用您拥有的索引

```
WITH CTE AS (               
        SELECT 
            Orders.*,
            ROW_NUMBER() OVER (ORDER BY OrderID) AS rnOrderID,
            ROW_NUMBER() OVER (ORDER BY Surname) AS rnSurname                                                                         
        FROM Orders WHERE X                                         
    )
SELECT CTE.*
FROM CTE
WHERE
   CASE @SortCol
       WHEN 'OrderID' THEN rnOrderID
   END BETWEEN @RowStart AND @RowStart + @RowCount -1; 
```

但是，对于大型数据集（100,000 或更多），还有其他技术，例如[http://www.4guysfromrolla.com/webtech/042606-1.shtml](http://www.4guysfromrolla.com/webtech/042606-1.shtml)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-06T17:48:09.910

这是存储过程的过程模式失败的一种情况。您尝试参数化优化器使用的属性不会让优化器完成它的工作。

在这种情况下，我将使用 2 个存储过程。

如果您真的开始使用参数，那么：

```
DECLARE @strSQL varchar(1000) = 
    'SELECT OrderID,ROW_NUMBER() OVER ( ORDER BY '                                                                                        
    + @SortCol +
    ' ASC) AS ROW_ID FROM Orders WHERE X ' +
    ' AND ROW_ID BETWEEN @RowStart and @RowStart + @RowCount - 1;'                                        

EXECUTE (@StrSQL) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-18T06:16:06.260

存在动态订单条件时没有 CTE 生成行号

```
select TotalCount = COUNT(U.UnitID) OVER() ,

ROW_NUMBER() over(
    order by 
     (CASE @OrderBy WHEN '1' THEN m.Title  END) ASC ,
     (CASE @OrderBy WHEN '2' THEN m.Title  END) DESC,
     (CASE @OrderBy WHEN '3' THEN Stock.Stock  END) DESC,
     (CASE @OrderBy WHEN '4' THEN Stock.Stock   END) DESC

) as RowNumber,

M.Title,U.ColorCode,U.ColorName,U.UnitID, ISNULL(Stock.Stock,0) as Stock

 from tblBuyOnlineMaster M

    inner join BuyOnlineProductUnitIn U on U.BuyOnlineID=M.BuyOnlineID 

    left join 
            ( select IT.BuyOnlineID,IT.UnitID,ISNULL(sum(IT.UnitIn),0)-ISNULL(sum(IT.UnitOut),0) as Stock 
                from [dbo].[BuyOnlineItemTransaction] IT 
                group by IT.BuyOnlineID,IT.UnitID
             ) as Stock

        on U.UnitID=Stock.UnitID

order by 
 (CASE @OrderBy WHEN '1' THEN m.Title  END) ASC ,
 (CASE @OrderBy WHEN '2' THEN m.Title  END) DESC,
 (CASE @OrderBy WHEN '3' THEN Stock.Stock  END) DESC,
 (CASE @OrderBy WHEN '4' THEN Stock.Stock   END) DESC

offset  @offsetCount rows fetch next 6 rows only 
```

# bitkeeper - 相当于 Bitkeeper 中的“svn revert”或“git checkout --”

> ID：15815629
> 
> 赞同：0
> 
> 时间：2013-04-04T15:36:27.683
> 
> 标签：bitkeeper

如果我修改了一个文件，然后就不需要这个修改了。我怎样才能回到文件的原始状态。我的意思是在本地进行的未签入、提交或推送的修改。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:54:34.983

从命令行：

```
bk unedit file 
```

或者运行 bk citool 并选择 Discard 按钮。

# web-applications - 如何在 Google 搜索结果中显示缩略图

> ID：15815635
> 
> 赞同：3
> 
> 时间：2013-04-04T15:36:38.477
> 
> 标签：web-applications, seo, googlebot

我想知道为什么 Google 在一个站点的搜索结果中显示缩略图，而在另一个站点中不显示？例如，当我在谷歌上搜索[肯德基鸡肉食谱](https://www.google.com/#hl=ru&gs_rn=8&gs_ri=psy-ab&tok=7NZbA4kT1AWo_MQB_C317Q&pq=fry%20recipe&cp=10&gs_id=5c&xhr=t&q=kfc+chicken+recipe&es_nrs=true&pf=p&newwindow=1&sclient=psy-ab&oq=kfc+chicke+recipe&gs_l=&pbx=1&bav=on.2,or.r_qf.&bvm=bv.44770516,d.bGE&fp=55e8d373b3323a76&biw=1280&bih=963)时，我可以看到 www.food.com 的缩略图，而在 www.tastyappetite.net 上看不到它。

我试图用谷歌搜索这个问题，但我只发现[这篇文章](http://googlecustomsearch.blogspot.com/2011/11/thumbnail-images-in-search-results-no.html)说谷歌会自动完成，我不需要担心。

有什么建议如何向 Google 提示这是该页面的缩略图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-25T13:50:57.860

谷歌显示的这种信息被称为“**微数据**”。您可以在您的代码中告知 **google 必须了解的内容**。正如 Carte Cole 所说，[schema.org](http://schema.org)向您展示了微数据的多种可能性。

举个例子，你的例子。你从炸鸡那里拿了一份食谱，谷歌显示了一张朋友鸡的照片，它的等级和烹饪准备时间。在 schema.org 中，您可以找到所有可以提供给 google 的食谱[微数据：食谱](http://schema.org/Recipe)的微数据。有很多（很多，很多）微数据有用的情况（人、食谱、地方......）。

顺便说一句，**它只是一些 HTML 代码添加到您的实际代码**中，如预览链接底部的示例中使用的那样。

> 前准备时间：烹饪时间：`<meta itemprop="cookTime" content="PT1H">1 hour`

**微数据对于出色的 SEO 策略**非常有用。它允许谷歌**很好地理解你的内容**，然后，如果有资格，它将出现在搜索引擎的结果页面中。

此外，带有微数据的合格页面精美地显示在谷歌搜索结果中，**让客户眼前一亮**！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T19:09:28.463

这实际上是针对谷歌自定义搜索而不是针对主要谷歌域。您可能正在寻找的是使用[http://schema.org](http://schema.org)标记您的数据，这允许他们显示有关页面上内容的更完整信息，因为它采用已知格式

# php - 将值从已由另一个 ajax 加载的 A 标记传递给 ajax

> ID：15815636
> 
> 赞同：0
> 
> 时间：2013-04-04T15:36:38.510
> 
> 标签：php, ajax, jquery, anchor

我想将一个值从已由另一个 ajax 加载的 Anchor 标记传递给 ajax。我有一个名为 profilesearch.php 的页面。我在标题中有这段代码

```
function loadData(page){
$.ajax({
type: "POST",
url: "load_data.php",
data: 'page='+page+'&user='+<?php echo json_encode($_GET['uid']); ?>,
success: function(msg){
    $("#container").ajaxComplete(function(event, request, settings){
        loading_hide();
        $("#container").html(msg);
        });
    }
});
} 
```

这段代码会从 load_data.php 文件返回一个设置的 div 到 #container 文件有分页。每个 div 都会有一个 Anchor 标签，Anchor 标签的 ID 是#myAnchor。当用户单击该#myAnchor 时，它应该再次对文件updateAjax.php 执行另一个ajax。

```
<script type="text/javascript">
$(document).ready(function(){
    $("#myAnchor").click(function(){
        alert("hi");
        $.ajax({
        url: "updateAjax.php",
        data: 'varName=hi',
        success: function(upmsg){
            $("#myAnchor").html(upmsg);
        }
        });
    });
});
</script> 
```

当我在同一页面中有一个锚标记时，即 profilesearch.php 这工作正常.. 但是当我从另一个 ajax 请求加载一个锚时它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:40:35.650

在涉及动态元素的情况下，您需要使用事件委托。您可以使用[.on()](http://api.jquery.com/on/)来实现这一点。

```
$(document).ready(function(){
    $("#container").on('click', '#myAnchor', function(){
        alert("hi");
        $.ajax({
        url: "updateAjax.php",
        data: 'varName=hi',
        success: function(upmsg){
            $("#myAnchor").html(upmsg);
        }
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:40:56.373

尝试像这样调用 click 函数：

```
$(document).on('click', '#myAnchor', function(){ 
    //code here
)}; 
```

# clojure - 为什么ISeq的“more”不命名为“rest”？

> ID：15815639
> 
> 赞同：5
> 
> 时间：2013-04-04T15:36:47.180
> 
> 标签：clojure

```
public interface ISeq extends IPersistentCollection {
  Object first();
  ISeq next();
  ISeq more();
  ISeq cons(Object o);
} 
```

`more`接口方法`ISeq`似乎正在运行`rest`。`more`为什么不命名`rest`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T17:22:11.470

这些信息是我对 Clojure git 存储库做一些考古的解释。

最初只有`rest`, 它返回`nil`而不是像今天那样返回 emtpy 列表。当 Rich 引入[惰性](https://github.com/clojure/clojure/commit/b8e333fb3437dca760f16136ed074a4dd463fe35#L19L23)时，它被重命名`next`，并`ISeq`获得了`more`方法。`ASeq`实现该`more`方法以返回一个空的 seq 而不是`nil`，并`next`保留方法抽象。在此之后的某个时刻，该`rest`函数作为我们今天所知的非序列、返回空列表的版本重新焕发生机，但 Java 代码没有被重构。

# c++ - 在 C++ 中很好地格式化数字

> ID：15815646
> 
> 赞同：19
> 
> 时间：2013-04-04T15:37:05.840
> 
> 标签：c++

在 Ada 中，可以写下划线来分隔数字，这大大提高了可读性。例如：1_000_000（相当于 1000000） C++ 有类似的方法吗？

编辑：这是关于源代码的问题，而不是 I/O。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-04T15:54:35.753

从 C++14 开始，您可以`'`用作[数字组分隔符](https://en.cppreference.com/w/cpp/language/integer_literal#Single_quote)：

```
auto one_m = 1'000'000; 
```

以前版本的 C++ 本身并不支持这一点。有两个主要的解决方法：

*   [在 C++11 中使用用户定义的文字](https://stackoverflow.com/a/14220849/1968)；这将允许您编写如下代码：

    ```
    auto x = "1_000_000"_i; 
    ```

    （把它写成 a`constexpr`会比较棘手——但绝对有可能。）

*   [使用简单的宏](https://stackoverflow.com/a/14220401/1968)，这将允许以下代码：

    ```
     auto x = NUM(1,000,000); 
    ```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-04T15:38:32.583

目前没有办法做到这一点。但是，有人提议引入[数字分隔符 (N3499)](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3499.html)。不过，他们还没有选择要使用哪个字符作为分隔符。目前的建议是：

*   空间：`4 815 162 342`
*   重音：`4`815`162`342`
*   单引号：`4'815'162'342`
*   下划线：`4_815_162_342`

不幸的是，它们都存在提案中描述的问题。

您可以使用用户定义的文字来采用 hacky 方法：

```
long long operator "" _s(const char* cstr, size_t) 
{
    std::string str(cstr);
    str.erase(std::remove(str.begin(), str.end(), ','), str.end());
    return std::stoll(str);
}

int main()
{
    std::cout << "4,815,162,342"_s << std::endl;
} 
```

这将打印出：

```
4815162342 
```

它只是从给定的文字中删除所有逗号并将其转换为整数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-04T21:33:19.443

```
int main()
{
   int x = 1e6;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-04T15:57:22.423

你总是可以定义一个可变参数宏，像`N(123,456,678)`. 不过，这比它的价值要麻烦得多。特别是，您可能必须解决一些用于计算参数的可移植代码的可视化 C++ 特性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T15:46:08.743

`imbue()`通过使用适当的语言环境方面（在本例中为[num_put](http://en.cppreference.com/w/cpp/locale/num_put)）输入 I/O 流，您正在寻找的内容完全可能。

（这是假设您在谈论 I/O。如果您在谈论源本身，那么从 C++11 开始这是不可能的。）

# animation - 在动画结束之前执行 Tweenmax 回调

> ID：15815648
> 
> 赞同：2
> 
> 时间：2013-04-04T15:37:09.863
> 
> 标签：animation, callback, gsap

我在我的网站上使用 greensock gsap 制作动画。问题是在动画结束之前执行的回调。在下面的示例中，元素在动画的一半处被删除。

```
TweenLite.to($(".flipper"), 2, {rotationY:180,onComplete:function(){
    $(this).remove()
}}); 
```

有没有人遇到过同样的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T18:53:31.783

不，对我来说很好（见下面的 jsfiddle）。但是，`this`在您的回调函数中不是您的动画对象，而是补间。因此，`this.target`如果要在动画后将其删除，则必须改用，如下所示：

```
TweenLite.to($(".flipper"), 1, {rotationY:180,onComplete:function(){
    (this.target).remove()
}}); 
```

[http://jsfiddle.net/brian_griffin/5Ltfg/](http://jsfiddle.net/brian_griffin/5Ltfg/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-15T17:29:05.437

我总是建议使用 onUpdateScope、onCompleteScope 等，这样您就可以完全清楚自己在做什么。文档在这方面相当薄弱，因为它有点被掩埋了。greensock 的所有 onDoSomething 函数都有一个范围参数。

```
TweenLite.to($(".flipper"), 2, {rotationY:180,onCompleteScope: $(".flipper"),
    onComplete:function(){$(this).remove()
}}); 
```

让 Tween 完全清楚 $(this) = $(".flipper")。当您想要对补间进行超出范围的更改时，这也非常有用。根据您运行补间的位置，它可能无法访问其范围之外的 jquery 对象，但您可以通过 onCompleteScope 传入不同的范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-23T10:57:26.993

正如@hjuster 所指出的，在 CSS 中声明的转换可能与 TweenMax 中的 onComplete 回调发生冲突。我认为在错误的时间调用 onComplete 的原因

# c++ - std::unordered_map 通过引用传递

> ID：15815649
> 
> 赞同：3
> 
> 时间：2013-04-04T15:37:12.447
> 
> 标签：c++

我通常用 C 编写代码。现在转向 C++。我有`std::unordered_map`6000 万个条目。它只加载一次，以后不会修改。我想不时将它传递给一些函数。但是这段代码每次都会复制哈希映射：

```
typedef unordered_map<uint64_t, mer*> mer_map;
void test_pass_by_ref3(mer_map kmers) {
}

void test_pass_by_ref2(mer_map kmers) {
    test_pass_by_ref3(kmers);
}

void test_pass_by_ref(mer_map kmers) {
    test_pass_by_ref2(kmers);
} 
```

如果我想传递`pointer`唯一的，如何传递它并像往常一样查询它：`value = mer_map[key]`？我搜索并找到了`passing by reference`语法：

```
void foo(const ClassName &name)
{
    ClassName& temp = const_cast<ClassName&>(name);
    ... ....
} 
```

但它似乎无法编译。请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-04T15:41:08.800

我猜您的问题是`operator[]`non `const`，因为当使用地图中尚不存在的键访问时，它会添加一个默认构造元素。您可以使用`at()`，它假定密钥存在，否则抛出异常：

```
typedef unordered_map<uint64_t, mer*> mer_map;

void foo(const mer_map& m)
{
  mer* val = m.at(key);
} 
```

或使用`std::unordered_map::find()`：

```
void foo(const mer_map& m)
{
  auto it = m.find(key);
  if (it != m.end())
  {
    // element is in map, use it
    mer* val = it->second;
  }
} 
```

**注意**：您*也可以*通过传递非常量引用来绕过该问题，但这样做意味着该函数会修改映射。如果你真的打算修改一个对象，你应该只使用非常量引用。

```
void foo(mer_map& m)
{
  mer* val = m[key];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T15:39:55.683

要使用引用传递，您的函数应声明为

```
typedef unordered_map<uint64_t, mer*> mer_map;
void test_pass_by_ref3(mer_map& kmers) {
}

void test_pass_by_ref2(mer_map& kmers) {
    test_pass_by_ref3(kmers);
}

void test_pass_by_ref(mer_map& kmers) {
    test_pass_by_ref2(kmers);
} 
```

这对于访问操作员来说是正常的

```
mer_map[key] 
```

并访问类似的成员函数

```
mer_map.find( 
```

* * *

要传递一个指针，它们应该是形式

```
typedef unordered_map<uint64_t, mer*> mer_map;
void test_pass_by_poi3(mer_map *kmers) {
}

void test_pass_by_ref2(mer_map *kmers) {
    test_pass_by_poi3(kmers);
}

void test_pass_by_ref(mer_map *kmers) {
    test_pass_by_poi2(kmers);
} 
```

但是，在使用访问运算符的指针版本中，您必须首先取消引用指针。

```
(*mer_map)[key] 
```

并访问类似的成员函数

```
kmers->find( 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T15:49:50.217

For`map`和`unordered_map`索引运算符`[]`是非常量的，因为使用不存在的索引调用它会导致创建该元素。`at()`如果您不想创建元素，请使用。然后你可以使用 const 引用`map`or `unordered_map`。请注意，`at()`如果元素不存在，则会抛出。

您可以使用迭代器来测试是否存在：

```
bool
esists(const mer_map& kmers, uint64_t i)
{
  unordered_map<uint64_t, mer*::const_iterator it = kmers.find(i);
  return it != kmers.end();
} 
```

或者您可以通过代码中的迭代器访问 mer_maps。

# java - RSS 提要描述返回“<”

> ID：15815650
> 
> 赞同：2
> 
> 时间：2013-04-04T15:37:15.293
> 
> 标签：java, android, rss, jsoup, rss-reader

我正在尝试解析来自此提要的 rss 数据：http: [//fulltextrssfeed.com/feeds.bbci.co.uk/news/rss.xml](http://fulltextrssfeed.com/feeds.bbci.co.uk/news/rss.xml)，它是使用[FullTextRssFeed](http://fulltextrssfeed.com/)站点生成的。唯一的问题是，当我尝试获取描述时，我收到'<'，其他一切正常！。我**试过**用[JSoup 来做](http://jsoup.org/)这个，但我不知道怎么做。你能建议怎么做吗？**我使用的代码与[本教程](http://android-er.blogspot.co.uk/2010/06/apply-custom-adapter-to-listview-for.html)**中使用的代码相同，但我替换了使用的 RSS URL。再次感谢！ ![*这是我的 RSS 阅读器*](https://i.stack.imgur.com/SGMm7.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T22:49:44.860

您的问题是因为您的 RSS 提要中的描述包含 html，而不是纯文本。以下是说明内容：

```
<div><span class="story-date"><span class="date">3 April 2013</span> <span class="time-text">Last updated at</span> <span class="time">23:25 ET</span></span> <p><img src="http://news.bbcimg.co.uk/media/images/66739000/jpg/_66739180_philpotts.jpg" width="464" height="261" alt="Mick and Mairead Philpott, Paul Mosley"/><span class="c2">Mick and Mairead Philpott, and Paul Mosley, will be sentenced on Thursday</span></p> <p class="introduction" id="story_continues_1">A couple convicted of killing six of their children in a house fire in Derby are due to be sentenced later.</p> <p>Mick and Mairead Philpott will reappear at Nottingham Crown Court where they were found guilty of six counts of manslaughter, along with their friend Paul Mosley, on Tuesday.</p> <p>The maximum sentence for the crime is life imprisonment.</p> <p>Mrs Justice Thirlwall was due to pass sentence on Wednesday but needed more time to consider mitigation.</p> <p>The court was told that Philpott, 56, was jailed for seven years in 1978 for attempting to murder a previous girlfriend and given a concurrent five-year sentence for stabbing the woman's mother.</p> <p>In 1991 he received a conditional discharge for assault after he head-butted a colleague</p> <p>And in 2010 he was given a police caution after slapping Mairead and dragging her outside by her hair.</p> <p>When Philpott set fire to his house in Victory Road, Derby, he was also facing trial over a road rage incident in which he punched a motorist in the face.</p> <p>He had admitted common assault in relation to the incident but denied dangerous driving.</p> <span class="cross-head">Rape allegation</span> <p>Police have also confirmed that they intend to "thoroughly" investigate an allegation that Philpott raped a woman several years ago.</p> <p>She made the allegation after the death of Philpott's children, but police decided to wait until the end of the manslaughter trial before investigating the complaint further.</p> <p>On Tuesday the jury returned unanimous manslaughter verdicts on Philpott and Mosley, 46, while Mairead Philpott, 32, was convicted by a majority.</p> <p>Jade Philpott, 10, John, nine, Jack, eight, Jesse, six, and Jayden, five, died on the morning of the fire on 11 May 2012.</p> <p>Mairead Philpott's son from a previous relationship, 13-year-old Duwayne, died later in hospital.</p> </div><img src="http://pixel.quantserve.com/pixel/p-89EKCgBk8MZdE.gif" border="0" height="1" width="1" /> 
```

您需要以某种方式更改解析器，使其可以忽略描述中的 html 内容中的内容。获得完整的 html 片段后，您可以在 WebView 中呈现它。我认为通常在诸如 RSS 提要之类的 XML 数据片段中存在某种其他类型的 XML 内容（在本例中为 HTML）时使用 CDATA。老实说，虽然我不熟悉它的来龙去脉，但我可能是不正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T18:38:06.243

您从中获得的 HTML`myRssFeed.getDescription()`如下所示：

```
<div><span class="story-date"><span class="date">6 April 2013</span> <span class="time-text">Last updated at</span> <span class="time">08:57 ET</span></span> <p><img src="http://news.bbcimg.co.uk/media/images/51606000/jpg/_51606573_fa1d16c0-9c6c-4f82-b0b8-ab66ddd94f78.jpg" width="304" height="171" alt="Breaking news"/></p> <p class="introduction">Nelson Mandela has been discharged from hospital after treatment for pneumonia, South Africa's government has said.</p> <p>It said there had been "a sustained and gradual improvement in his condition".</p> <p>The 94-year-old was admitted on 27 March for a recurring lung infection and had fluid drained at the undisclosed hospital.</p> <p>Mr Mandela served as South Africa's first black president from 1994 to 1999 and is regarded by many as the father of the nation.</p> <p>The <a href="http://redirect.viglink.com?key=11fe087258b6fc0532a5ccfc924805c0&u=http%3A%2F%2Fwww.thepresidency.gov.za%2Fpebble.asp%3Frelid%3D15178">presidency statement read</a>: "Former President Nelson Mandela has been discharged from hospital today, 6 April, following a sustained and gradual improvement in his general condition.</p> <p>"The former president will now receive home-based high care. President [Jacob] Zuma thanks the hard working medical team and hospital staff for looking after Madiba so efficiently."</p> <p>Madiba is Mr Mandela's clan name.</p> <p>The statement continued: "[Mr Zuma] also extended his gratitude to all South Africans and friends of the Republic in Africa and around the world for support."</p> </div><img src="http://pixel.quantserve.com/pixel/p-89EKCgBk8MZdE.gif" border="0" height="1" width="1" /> 
```

使用 Jsoup 你可以试试这个（未经测试）：

代替

```
feedDescribtion.setText(myRssFeed.getDescription()); 
```

用这个：

```
feedDescribtion.setText(extractDescriptionText(myRssFeed.getDescription()); 
```

使用以下方法：

```
private String extractDescriptionText(String description) {
    StringBuffer b = new StringBuffer();
    Document dom = Jsoup.parse(description);
    Elements paragraphs = dom.getElementsByTag("p");
    for (int i=1; i<paragraphs.size(); i++) { // start with 1 to skip the 'breaking news' paragraph
        Element p = paragraphs.get(i);
        b.append(p.text());
        b.append("\n"); // line-break after each paragraph
    }
    return b.toString();
} 
```

这应该有效。也许一些微调是必要的，但在 Jsoup 的帮助下可以很容易地实现。

**编辑：**

这就是`extractDescriptionText()`上面示例的内容：

> 南非政府表示，纳尔逊·曼德拉在接受肺炎治疗后已出院。它说“他的病情已经持续和逐渐好转”。这位 94 岁的老人于 3 月 27 日因反复肺部感染入院，并在未公开的医院引流了液体。曼德拉先生于 1994 年至 1999 年担任南非第一位黑人总统，被许多人视为国父。总统声明中写道：“前总统纳尔逊·曼德拉于今天 4 月 6 日出院，此前他的总体状况持续逐渐好转。”这位前总统现在将接受居家高级护理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T19:06:16.017

在网上搜索有关如何执行此操作的想法时，我发现这样做实际上是[非法](http://www.bbc.co.uk/terms/additional_rss.shtml)的，因为这种获取内容的方法违反了我希望使用的许多网络资源的使用条款。现在，您将不得不坚持使用简短的 RSS 提要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T19:07:15.120

我会发表评论，但我没有足够的积分。

我建议使用 yahoo 管道来重定向您的 rss 提要。您甚至可以选择将其重定向为 json 而不是 xml。

[http://pipes.yahoo.com/pipes/](http://pipes.yahoo.com/pipes/)

如果您的解析器在您访问的大多数网站上都可以正常工作，这将是解决问题的最简单方法。

# r - 使用 R 中的 ggplot 绘制两个数据帧的多图和叠加图

> ID：15815652
> 
> 赞同：0
> 
> 时间：2013-04-04T15:37:16.823
> 
> 标签：r, ggplot2

我有用于创建两个数据框的数据：

```
#Event csv
timestamp,event
2013-04-03 22:59:05.061Z,A
2013-04-03 22:59:05.061Z,B
2013-04-03 22:59:07.109Z,C
2013-04-03 22:59:07.115Z,D
2013-04-03 22:59:07.209Z,E

# Performance data
hostname;interval;timestamp;CPU;user;nice;system;iowait;steal;idle
box1;1;2013-04-03 22:59:02 UTC;-1;10.53;0.00;2.01;0.50;0.00;86.97
box1;1;2013-04-03 22:59:03 UTC;-1;0.25;0.00;0.00;0.00;0.00;99.75
box1;1;2013-04-03 22:59:04 UTC;-1;0.00;0.00;0.25;0.25;0.00;99.50
box1;1;2013-04-03 22:59:05 UTC;-1;10.72;0.00;1.00;0.25;0.00;88.03
box1;1;2013-04-03 22:59:06 UTC;-1;10.67;0.00;10.67;0.00;0.25;78.41
box1;1;2013-04-03 22:59:07 UTC;-1;5.01;0.00;9.02;3.51;0.00;82.46
box1;1;2013-04-03 22:59:08 UTC;-1;12.28;0.00;11.53;4.26;0.25;71.68
box1;1;2013-04-03 22:59:09 UTC;-1;15.88;0.00;11.66;10.92;0.50;61.04 
```

现在我正在尝试使用 ggplot 通过将来自事件的数据覆盖在性能数据上来绘制这两个数据帧。

```
# This works
perfomance <- read.csv("performance.csv", header=TRUE,sep=";")
perfomance$timestamp <- as.POSIXlt(perfomance$timestamp)
p <- ggplot(data=performance, aes(x=timestamp, y=idle)) + geom_line() 
```

哪个生产

![cpu 空闲时间图](https://i.stack.imgur.com/Spjfz.png)

现在，覆盖事件数据是有问题的。这是我尝试过的

```
> p + geom_point(data=events, aes(colour=factor(event)))
Error in eval(expr, envir, enclos) : object 'idle' not found

> p + geom_point(data=events, aes(colour=factor(event)), inherit.aes = FALSE)
Error: geom_point requires the following missing aesthetics: x, y

> p + geom_point(data=events, aes(x=timestamp, colour=factor(event)), inherit.aes = FALSE)
Error: geom_point requires the following missing aesthetics: y 
```

如何在图表上获得一些将事件显示为叠加的标记？我不在乎他们的Y坐标。我需要它们可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:29:14.223

尝试使用以下方法`geom_vline`：

```
p + geom_vline(linetype=4, aes(colour=factor(event),xintercept = timestamp) ) 
```

# c++ - 如何通过我的 C++ 代码读取和传递 svn 版本

> ID：15815656
> 
> 赞同：3
> 
> 时间：2013-04-04T15:37:36.140
> 
> 标签：c++, qt, svn

我读过太多关于颠覆关键字和许多其他细节（如锚点和锚点符号）的文章，但没有一篇是在谈论 c++。

我正在使用 QT creator，我希望 c++ 读取 svn 版本并将其作为值或字符串（或任何数据类型）通过我的代码。

那么，我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T16:00:31.990

来自[SVNBook](http://svnbook.red-bean.com/en/1.7/svn.advanced.props.special.keywords.html)的文本可能与此处相关：

> 新用户经常对 $Rev$ 关键字的工作方式感到困惑。由于存储库有一个单一的、全局递增的修订号，许多人认为 $Rev$ 关键字的值反映了这个数字。但是 $Rev$ 会展开以显示文件更改的最后一个修订版，而不是它更新到的最后一个修订版。理解这一点可以消除困惑，但常常会感到沮丧——没有 Subversion 关键字的支持，如何自动将全局修订号放入文件中？
> 
> 为此，您需要外部处理。Subversion 附带了一个名为 svnversion 的工具，它就是为此目的而设计的。它抓取您的工作副本并生成它找到的修订作为输出。您可以使用这个程序，加上一些额外的工具，将修订信息嵌入到您的文件中。有关 svnversion 的更多信息，请参阅名为“svnversion”的部分。

在我的项目中，我们最终没有使用`svnversion`，主要是因为我们的[源代码树很大](https://stackoverflow.com/a/14447434/283302)，而且这个命令似乎花费了过多的时间。但是我们最终确实得到了类似的东西来将修订号输入我们的软件。该`configure`脚本执行以下命令

```
svn info . > svn_revision 
```

这假设命令是从从 svn 存储库中签出的目录中执行的。为了解析这些数据，我有一个 Makefile 将各种字符串 grep 成常量

```
SVN_REV = $(shell cat svn_revision | grep "Last Changed Rev" | cut -f4 -d\ ) 
```

这是通过我调用的模板文件提供的`version.cc.template`，有一个 Makefile 规则将其转换为`.cc`文件

```
version.cc: version.cc.template /svn_revision
        sed -e "s/REVISION/$(SVN_REV)/" version.cc.template > $@ 
```

所以我最终得到了这样的东西

**版本.h**

```
namespace project {

extern const char* Revision;
extern const unsigned int SvnRevision;

} 
```

**版本.cc**

```
namespace project {

const char* Revision = "1234";
const unsigned int SvnRevision = 1234;

} 
```

`version.cc`在您的情况下可能不需要该文件，也可以在标题中定义常量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T16:08:27.230

[如何获取 system() 命令 qt c++ 的输出？](https://stackoverflow.com/questions/12696924/how-to-get-the-output-of-system-command-qt-c)

就像接受的答案所说，您可以使用 QProcess 通过系统终端运行命令，等待它完成，然后获取命令的文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T21:28:07.310

感谢你的帮助。实际上我找到了另一种方法。请参考这个问题：

[如何将命令行传递给 QMake #DEFINE](https://stackoverflow.com/questions/15837185/how-to-pass-a-command-line-to-a-qmake-define)

# jquery - Fancybox 拖动后不激活

> ID：15815658
> 
> 赞同：1
> 
> 时间：2013-04-04T15:37:38.437
> 
> 标签：jquery, drag-and-drop, fancybox-2

我正在使用[NiceScroll](https://github.com/inuyaksa/jquery.nicescroll)使容器可拖动。它本质上是一个被“掩盖”的时间表，可以左右拖动以查看一天中的更多时间。

我还使用[Fancybox](http://fancyapps.com/fancybox/)来弹出有关日程中每个事件的更多信息。

当您拖动日程表中没有活动事件的区域时，一切都很好。当您开始在具有活动事件 (.act) 的区域上拖动时，当您释放拖动时，它会打开 Fancybox。这是不希望的——我只是希望它停止拖动并且不打开 Fancybox。

是否可以在 open 或 beforeLoad 函数中使用某种比较来取消盒子的实际打开？如果 mousedown 位置距离鼠标向上位置超过 10px？

这是我为活动项目提供的代码：

```
$("#schedule .act").fancybox({
    openEffect:     'none',
    closeEffect:    'none',
    autoSize:       false,
    autoWidth:      false,
    autoHeight:     true,
    minHeight:      275,
    autoResize:     true,
    width:          500,
    padding:        [50, 60, 0, 60],
    arrows:         true,
    loop:           false,
    closeBtn:       '<a title="Close" class="fancybox-item fancybox-close" href="javascript:;">Close</a>',

    beforeLoad: function() {        
        $time = $(this.element).data('time');
        $type = $(this.element).data('type');
        $titl = $(this.element).data('title');
        $desc = $(this.element).data('desc');
        this.content = "<span class='time " + $type + "'> " + $time + " </span>" + "<span class='title'>" + $titl + "</span>" + "<div class='desc'>" + $desc + "</div>";
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:22:51.563

我知道了。困难的部分是让课程被删除。我尝试使用悬停状态，然后使用鼠标离开，但是当拖动开始时，直到释放拖动后，类才会被删除（即使鼠标离开元素）。在初始化我的 fancybox 调用之前，我的解决方案是：

```
var clickDrag;
$("#schedule .act").mousedown(function() {
    $(this).addClass("hovered");
    clickDrag = $(this);
    $("#schedule .act").mousemove(function() {
        $(this).removeClass("hovered");
    });
}); 
```

然后，在 fancybox 调用的 beforeLoad 中，我添加了：

```
if (!($(clickDrag).hasClass("hovered") ) ) {
    $.fancybox.cancel();
    return;
} 
```

# php - PHP/Javascript 复选框在选中时更改表单操作

> ID：15815663
> 
> 赞同：1
> 
> 时间：2013-04-04T15:38:00.753
> 
> 标签：php, javascript, checkbox, postdata

这就是我得到的：

```
<form action="invoiceCreate.php" method="post">
<input type="checkbox" name="business" id="business" vaulue="yes" /> 
```

基本上，当我选中`"business"`复选框时，我希望表单操作更改为`BusinessInoiveCreate.php`而不是`InvoiceCreate.php`.

最好的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:46:00.333

由于没有指定，这里有一个**不使用 jQuery**的简单方法。根据浏览器的兼容性，您可能需要以不同的方式附加事件侦听器，但一般概念是相同的。

**HTML**

```
<form name="myForm" action="invoiceCreate.php" method="post">
  <input type="checkbox" name="business" id="business" vaulue="yes" />
</form> 
```

**Javascript**

```
var form = document.getElementsByName("myForm")[0];
var checkBox = document.getElementById("business");

checkBox.onchange = function(){
  if(this.checked){
    form.action = "giveEmTheBusiness.php";
  }else{
    form.action = "invoiceCreate.php";
  }
  console.log(form.action);
}; 
```

或者类似地，将事件绑定到`submit`

```
form.onsubmit = function(){
  if(checkBox.checked)
      form.action = "giveEmTheBusiness.php"
  else
      form.action = "invoiceCreate.php";
}; 
```

[**例子**](http://jsfiddle.net/J9FcJ/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T15:43:00.310

```
$('#business').on('change', function(){
    if ($(this).is(':checked')) {
        $('form').attr('action', 'BusinessInoiveCreate.php');
    } else {
        $('form').attr('action', 'invoiceCreate.php');
    }
}); 
```

工作演示：http: [//jsfiddle.net/eV7vY/](http://jsfiddle.net/eV7vY/)

# json - 在 Play 2.1 中合并 JSON 读取

> ID：15815665
> 
> 赞同：1
> 
> 时间：2013-04-04T15:38:06.153
> 
> 标签：json, scala, playframework-2.1

我有2次阅读。一是用户。用户是称为注册的主要读取的子集。

```
{
 user: {
  id: "35fc8ba5-56c3-4ebe-9a21-489a1a207d2e",
  username: "flastname",
  first_name: "FirstName",
  last_name: "LastName",
  email_address: "first@foobar.com",
  user_avatar: "http://blog.ideeinc.com/wp-content/uploads/2010/04/tineye-robot.jpg"
 },
 activity_type: 8
} 
```

注册：包款

导入 play.api.libs.json._ 导入 play.api.libs.functional.syntax._

案例类注册（用户：（字符串，字符串，字符串，字符串，字符串，字符串），activityType：Int）

```
object Registration {
    implicit val regReads: Reads[Registration] = (
      (__ \ "user").read(
        (__ \ "id").read[String] ~
        (__ \ "username").read[String] ~
        (__ \ "first_name").read[String] ~
        (__ \ "last_name").read[String] ~
        (__ \ "email_address").read[String] ~
        (__ \ "user_avatar").read[String]
        tupled
      ) ~
      (__ \ "activity_type").read[Int]
      )(Registration.apply _)
} 
```

最终，我希望 User 成为它自己的单独对象。我希望能够在多个其他读取中使用用户，因此它需要更加模块化。这可能吗？

**奖励：**用户可以将每个字段序列化为单独的变量或哈希图而不是元组吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T12:07:48.017

您可以在任何需要的地方提取`User`并再次使用它：

```
case class User(id: String, username: String, firstName: String, lastName: String, email: String, avatar: String)
case class Registration(user: User, activityType: Int)

object Implicits{
  implicit val userReads = (
    (__ \ "id").read[String] ~
    (__ \ "username").read[String] ~
    (__ \ "first_name").read[String] ~
    (__ \ "last_name").read[String] ~
    (__ \ "email_address").read[String] ~
    (__ \ "user_avatar").read[String]
  )(User)

  implicit val regReads = (
    (__ \ "user").read[User] ~
    (__ \ "activity_type").read[Int]
  )(Registration)    
}

import Implicits._
Json.fromJson[Registration](json).asOpt.toString
//Some(Registration(User(35fc8ba5-56c3-4ebe-9a21-489a1a207d2e,flastname,FirstName,LastName,first@foobar.com,http://blog.ideeinc.com/wp-content/uploads/2010/04/tineye-robot.jpg),8)) 
```

# c# - 如何将通用列表传递给 WPF 窗口

> ID：15815671
> 
> 赞同：0
> 
> 时间：2013-04-04T15:38:22.160
> 
> 标签：c#, wpf, list, generics, crystal-reports

我试着`Print`去`List of objects`。`Crystal Report`所以我创建了一个 WPF 窗口，如下所示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;
using CrystalDecisions.CrystalReports.Engine;
using CrystalDecisions.Shared;

namespace Winlease.UI
{
    /// <summary>
    /// Logique d'interaction pour EcheancierPrint.xaml
    /// </summary>
    public partial class EcheancierPrint : Window
    {
        List<T> ListToPrint = null;

        public EcheancierPrint(List<T> lst) : base()
        {
            ListToPrint = lst;
        }

        public EcheancierPrint()
        {
            InitializeComponent();
        }

        private void Window_Loaded_1(object sender, RoutedEventArgs e)
        {
            ReportDocument rd = new ReportDocument();
            rd.Load("../../Echeancier.rpt");
            rd.SetDataSource(ListToPrint);
        }
    }
} 
```

这个窗口是从另一个窗口中按钮的 Click 事件处理程序调用的，这里的代码：

```
private void cmdPrint_Click(object sender, RoutedEventArgs e)
{
    EcheancierPrint pe = new EcheancierPrint(echeancier);
} 
```

`Echeancier`是一个`List of Object`叫`Echeance`。类型**“T”**和方法**InitializeComponent**变为红色下划线，并且不被 WPF 编译器接受。指令的相同行为：

```
EcheancierPrint pe = new EcheancierPrint(echeancier); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:59:32.240

如果`T`不是具体类型，则必须声明`EcheancierPrint`为泛型类型`EcheancierPrint<T>`，但当前 XAML 不支持泛型。（XAML 2009 支持但不支持已编译的 XAML）。
此外，在您的情况下，类型是开放的泛型类型。

您真的需要将演示对象（UI 控件）与业务对象混合吗？

# javascript - 如何在嵌入 JS 文件的服务器控件中使用 <%=control.ClientID%>

> ID：15815680
> 
> 赞同：2
> 
> 时间：2013-04-04T15:39:12.120
> 
> 标签：javascript, asp.net, custom-server-controls

我正在一个库项目中创建一个服务器控件，它有 javascript 代码，javascript 代码需要获取按钮的 ID，所以我使用了 <%= button.ClientID %>。然后我将 javascript 代码作为文件嵌入到库项目中，并使用 ScriptManager 在 CreateChildControls() 中添加脚本。

```
Dim sm = ScriptManager.GetCurrent(Me.Page) 
sm.Scripts.Add(New ScriptReference("xxx.js", "LibraryProjectName")) 
```

但是当我运行页面时，它有一个 jquery 解析错误：invalid expression term '>'。所以我猜代码已经生成，但服务器没有将 <%= button.ClientID %> 转换为生成的 ID 格式。那么在这种情况下我应该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T16:26:57.967

而不是按钮名称设置一个非常具体的 CSS 类名称：

```
<asp:Button ID="btnMyGroovy" runat="server" CssClass="VerySpecific" Text="Action" /> 
```

然后使用您的`jQuery`选择器获取`$('.VerySpecific')`而不是控件名称。请记住，项目可以有多个类关联。:)

您可以通过选择服务器控件 CSS 类来使选择更加精确，例如。`.VerySpecificContainer`然后选择 的实例*。`VerySpecific`*包含在控件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T09:15:15.500

在 aspx 文件中：

```
var serverPrefix ='<%= ClientID %>'; 
```

在 .js 文件中：

```
function getServerId(id){
  if (typeof(serverPrefix ) != 'undefined')
  {
   return document.getElementById(prefix + '_' + id);
  }
  else
  {
   id;
  }
} 
```

当你想调用某个元素时，像这样使用：

```
$(getServerId('myTitleTxt')).text('hello!'); 
```

希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T18:33:40.213

这通常是一种很好的方法来参数化您的外部 javascript 文件函数，以便在使用 asp.net 时它们不必出现在页面上。

所以你会有：

```
function foo (sender)
{
   return $(sender).val();
} 
```

代替

```
function foo ()
{
   return $("<%= sender.ClientID %>").val();
} 
```

**附带说明：**

您知道吗，如果您使用 Asp.Net 4 或更高版本，您可以将 id 设置为静态，这意味着 Id 将匹配服务器端和客户端的名称，那么您不需要 <% %> 标记确定身份。这可以在 web.config 或 apge 顶部的 page 指令中设置。

# python - 我需要确切知道如何使用 string.maketrans

> ID：15815696
> 
> 赞同：20
> 
> 时间：2013-04-04T15:39:55.673
> 
> 标签：python, python-2.7

我是python新手，请谁能告诉我如何使用`string.maketrans ()`，请举一些例子？

我发现一些像：

```
allchars = string.maketrans ('', '') 
```

返回字符图，但我不知道如何使用这种方法

谢谢你的帮助

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-04-04T15:43:16.513

使用 创建转换表后`string.maketrans`，您可以将其结果用于`str.translate`方法，例如：

```
import string
trans = string.maketrans('ae', 'bx') # a->b and e->x
text = 'abcdef'
print text.translate(trans)
# bbcdxf 
```

# php - 使用存储在 codeigniter 数据库中的 file_ids 动态加载视图

> ID：15815698
> 
> 赞同：0
> 
> 时间：2013-04-04T15:40:04.370
> 
> 标签：php, codeigniter

我有一个表，它将服务器上文件的文件 ID 存储在视图文件夹中>它用于一个项目，我允许用户上传 html 文件并查看用户上传的内容。我想使用单个控制器功能加载所有文件这就是我正在做的事情..

```
 public function site_pages()
          {
                 $this->load->model('model_site');
                 // a function which returns the name and file_ids in the database
                 $rows=$this->model_site->get_temp_sites();
                foreach ($rows as $r) 
                {$file_id=$rows->file_id;
                 $r->file_name=$this->uri->segment(3);  
                 $this->load->view('includes/header');
             $this->load->view('site_pages/'.$file_id,$user_data);
                 $this->load->view('includes/footer');
                 }

      } 
```

然而，这显示了两个相互嵌套的网页......我怎样才能克服这个问题以及使用单个控制器加载所有文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:44:54.607

This is one of the cases where an iframe may actually be a good idea. Your enclosing page can simply provide an iframe pointed at the URL for the HTML content page to be viewed.

I think the iframe makes sense here in that, I assume, you are trying to provide an unaltered view of the HTML content (i.e. not use enclosing page's CSS rules, javascript, etc.).

# python - 在类中使用函数

> ID：15815706
> 
> 赞同：0
> 
> 时间：2013-04-04T15:40:17.233
> 
> 标签：python, list, class, object, methods

我正在尝试通过制作商品对象列表来制作收据程序。我通过创建一个类和函数来做到这一点：

```
class ware(object):

    def __init__(self, code, name, price, quantity):
        self.code= code
        self.name = name
        self.price = price    
        self.quantity= quantity

    def code (self):
        return self.code

def my_wares():
    wares_from_file= open("wares.txt", "r")
    list_of_wares= []
    for line in wares_from file:
        every_ware1= line
        every_ware2= varje_vara1.split("/")
        wares= ware(every_ware2[0],every_ware2[1], every_ware2[2], every_ware2[3])
        list_of_wares.append(varorna)

    list_of_wares.sort()
    return(list_of_wares) 
```

在我列出对象列表后，我通过以下方式在主函数中调用我的函数：

```
def main():
    all_wares = my_wares() 
```

现在我需要在另一个类方法中使用这个 ware 对象列表，我尝试这样做：

```
class receipt_part(ware):
    def __init__(self, kod, namn, pris, butik_antal):
        ware.__init__(self, code, name, price, quantity)
        self.price_toal= 0
        self.customer_quantity= 0

    def shop_ware(kod):
        wares_quantity= input("how many wares does the customer wants?")
        self.name= all_wares[1]
        self.price= all_wares[2] 
        peice_total+= all_wares[3]*wares_quantity
        customer_quantity+= int(wares_quantity)
        quantity= int(all_wares[4]) - int(wares_quantity)
        __str__() 
```

但是它说 all_wares 没有定义，虽然我在我的 main 函数中使用了它，这是为什么呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:50:33.167

即使调用了第一个函数，您也不能在一个函数中定义变量并在另一个函数中使用它`main`。您需要将变量显式传递给第二个函数。

# c# - 用变量实例化一个对象或对象列表

> ID：15815707
> 
> 赞同：0
> 
> 时间：2013-04-04T15:40:18.983
> 
> 标签：c#

让我们假设我有一个名为 str 的字符串，其中某个值是类的名称。例如 `string str="MyClass";`，有没有办法使用这个变量来实例化一个对象或对象列表？

（那是因为我从一开始就不知道我应该创建什么类型的对象，但是在程序内部的某个地方我得到了一个带有类名的字符串列表）

我真正想要的一些愚蠢的代码是：

```
List<**str**> myList = new List<str>(); 
```

或者

```
**str** object = new **str**(); 
```

提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:46:50.107

You can use reflection, assume your class is in the same assembly:

```
string input = "MyClass";

var type = Assembly.GetExecutingAssembly()
                   .GetTypes()
                   .FirstOrDefault(t => t.Name == input);

MyClass myObject = (MyClass)Activator.CreateInstance(type); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:02:46.667

您可以基于以下代码构建您的代码，它根据其名称构造一个 MyClass 的实例：

```
namespace MyNameSpace {

    public class MyClass {
        public MyClass() {
            // initialise
        }

        public static MyClass CreateMyClassFromName() {
            Type myType = Type.GetType("MyNameSpace.MyClass");
            System.Reflection.ConstructorInfo constinfo = myType.GetConstructor(new Type[] { });
            MyClass mc = (MyClass)constinfo.Invoke(null);
            return mc;
        }

    }

} 
```

# c# - C#，Databound Datagridview 在以编程方式插入行后显示错误数据

> ID：15815709
> 
> 赞同：1
> 
> 时间：2013-04-04T15:40:22.420
> 
> 标签：c#, datagridview, insert, databound

我遇到了数据绑定 DataGridView 的问题：

我正在使用一个视图，包括来自 SQL-Server 数据库的内部连接作为数据源。当我以编程方式插入行时，数据写入正确，但 DataGridView 没有显示它应该显示的数据。

视图中的某些列与另一个表连接。基本上，我将主表中的 ID 值与子表连接起来，以便能够显示列的文本值。当我将包含 id 值的行插入 GridView 时，它会显示 ID 值，但不显示相应的文本值。

如果我重新启动程序，一切都会正确显示。如何更新/刷新 GridView 以显示正确的文本值？我已经尝试过 GridView.EndEdit() 和 GridView.Refresh()，将数据源重新绑定到 GridView，并且一直在搜索网络但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T17:11:30.133

`DataGridView.Refresh()`用于*图形*刷新，而不是*数据*刷新。您需要在更新后重新绑定数据源。

插入后将数据源设置为null：`DataGridView.DataSource = null;`然后通过重新查询数据并应用更新的源重新绑定数据源`DataGridView.DataSource = someSource`，最后`DataBind()`再次调用。

它对您来说性能不够，我可能会建议限制结果集中返回的行数，或者将一些有价值的索引应用于您的表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:43:41.983

使用您在第一页加载时使用的相同查询重新查询。

# java - 在 RESTful Web 服务中公开服务

> ID：15815711
> 
> 赞同：0
> 
> 时间：2013-04-04T15:40:24.520
> 
> 标签：java, spring, jakarta-ee

我正在创建一个 Web 服务，并遵循 RESTful 方式。所以我有 Person、Ticket 等资源。我有所有正常的 CRUD 操作、一些查找器等。我还想公开服务方法，例如`randomTicket()`在类中定义的方法`RandomTicketGenerator`。我不确定在这样的 REST API 中公开服务方法是否不好？例如，上面的路径将`/randomTicket`仅响应 GET 请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:59:00.137

`/ticket/random`有点令人困惑，因为它可以解释为“给我 ID=random 的票”

如何通过以下方式退回单件商品：`GET /ticket?random=true`

或通过以下方式列出项目：`GET /tickets?random=true&maxItems=1`

# ios - UIWebView 支付处理

> ID：15815712
> 
> 赞同：0
> 
> 时间：2013-04-04T15:40:24.330
> 
> 标签：ios, objective-c, uiwebview, payment-processing, worldpay

我正在为应用程序中的实物商品实施购买系统，因为它不是数字商品，因此不会被归类为应用程序内购买。

我需要使用的支付服务没有公共 API。所以我想知道我是否可以在 UIWebView 中点击他们的网址并通过那里付款。

它会被 AppStore 接受吗？

还是我必须离开我的应用程序并转到 Safari 才能完成交易？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T17:51:18.410

您的方法很好，无需切换到野生动物园。只需确保 url 具有`https`前缀，以便通过 ssl 处理信用卡。

# android - 用于查询我的应用程序、编辑我的应用程序和上传新应用程序的 Google Play API

> ID：15815717
> 
> 赞同：0
> 
> 时间：2013-04-04T15:40:31.557
> 
> 标签：android, google-play, google-play-services

Google 是否提供 Web 服务 API 来为我的帐户查询应用程序、编辑这些应用程序以及上传新应用程序？如果是这样，有人可以提供链接吗？

我能找到的唯一允许批量操作的是通过 CSV 文件用于 Google Play IAP。应用程序是否也存在批量上传？

[http://developer.android.com/google/play/billing/billing_admin.html](http://developer.android.com/google/play/billing/billing_admin.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:07:03.517

没有这样的 API，抱歉。

充其量，您可以编写一个使用您的凭据进行身份验证的脚本，并尝试复制来自开发控制台 Web 界面的 POST 和 GET 请求，以尝试复制该功能。

# c# - 如何通过速记“if-else”结果打破循环？

> ID：15815718
> 
> 赞同：3
> 
> 时间：2013-04-04T15:40:32.690
> 
> 标签：c#, loops, if-statement, break, shorthand

假设我在循环中有一个速记 if-else 语句，如本例所示：

```
for(...)
{
    a = b == c ? b : c;
    // More unnecessary code if the result was true.
} 
```

我想通过条件的结果来打破循环：

```
for(...)
{
    a = b == c ? b break : c;
    // Now the unnecessary code is not executed.
} 
```

我意识到我可以像这个例子一样完整地输入它：

```
for(...)
{
    if( b == c )
    {
        a = b;
        break;
    }
    else
    {
        a = c;
    }
    // Now the unnecessary code is not executed.
} 
```

但它太长了，我试图在一行中包含每个中断条件，因为它们中有几个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T15:44:22.177

您可以在不使用三元运算符的情况下使用缩短的语法，但是您尝试做的事情是不可能的。`else`如果您`break`在`if`.

```
for (...)
{
    if (b == c) { a = b; break; }

    a = c;
    // More code if b does not equal c
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T15:44:28.780

对于您给出的示例，您可以对其进行重组

```
for (int i = 0; i < count && b != c; ++i)
{
    if( b != c )
    {
        // code
    }
}
a = b; 
```

但是，您尝试做的特定事情（从三元组中打破）是不可能的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T15:45:51.060

以下是有关三元运算符及其用途的一些信息： [`?: Operator (C#)`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/conditional-operator)

你想做的事是不可能的……这不是它的工作方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T15:47:44.197

三元运算符（即“速记 if-else”）仅用于评估基于布尔值的两个语句之一。与其说是流控制结构，不如说是`if`; 它实际上返回它执行的语句的结果。你不能用它来执行这样的代码。

如果您最终得到一个很长的 else-if-else-if 链，请考虑进行一些重构。可以用`switch`块代替它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T15:47:51.607

为测试创建一个函数。如果它被重用，它至少比你的例子短。

```
int a;
if(TryEqual(b, c, out a))
    break;

bool TryEqual(int x, int y, out res)
{
    if(x == y)
    {
        res = x;
        return true;
    }
    res = y;
    return false;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-04T19:00:12.473

我想出了这个解决方案。

```
for (...)
{
  if ( (b == c ? (a=b) == a : (a=c) != a) ) break;
} 
```

当然，精明的读者会注意到，当且仅当as 等价时，您*总是*可以分配`a=c`然后中断。`b==c`

```
for (...)
{
  a = c; if (b==c) break;
} 
```

这将尽可能短而优雅，同时仍将那些讨厌的 if-else 构造合并为一行。

# scripting - 如何获取运行批处理脚本的驱动器号？

> ID：15815719
> 
> 赞同：14
> 
> 时间：2013-04-04T15:40:33.963
> 
> 标签：scripting, batch-file, drive

我在 CD 上有一个批处理脚本。每当我尝试运行它并输入`%~d0`时，它都会返回 C: 驱动器而不是 F:，这是我的 CD 驱动器。

有什么方法可以找到驱动器号？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-04T15:49:40.327

从当前目录获取驱动器号：

```
%cd:~0,2% 
```

%~dp0 在 bat 中非常有用：它是执行 bat 文件所在的文件夹。

也许在脚本的顶部，执行以下操作：

```
set _SCRIPT_DRIVE=%~d0
set _SCRIPT_PATH=%~p0 
```

然后将其回显以进行调试。%~d0 应该给你你想要的，但我提到的其他选项可能有助于解决挑战。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-22T14:16:04.670

您可以使用`%~dp0`获取当前/工作目录：

```
%~d0 
```

# javascript - 当类别的所有条形值都等于 0 时，Highcharts 条形图删除类别

> ID：15815723
> 
> 赞同：0
> 
> 时间：2013-04-04T15:40:47.313
> 
> 标签：javascript, jquery, highcharts

当类别的所有条形值都等于 0 时，如何删除类别

见：（[http://jsfiddle.net/no1uknow/EJFsH/1/](http://jsfiddle.net/no1uknow/EJFsH/1/)）

如果只有一个条等于 0，则不应删除该条。但如果所有 3 个条形都等于 0，则应删除该类别。

```
chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            type: 'column'
        },
        title: {
            text: 'Stacked column chart'
        },
        xAxis: {
            categories: ['Apples', 'Oranges', 'Pears', 'Grapes', 'Bananas']
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Total fruit consumption'
            },
            stackLabels: {
                enabled: true,
                style: {
                    fontWeight: 'bold',
                    color: (Highcharts.theme && Highcharts.theme.textColor) || 'blue'
                }
            }
        },
        legend: {
            align: 'right',
            x: -100,
            verticalAlign: 'top',
            y: 20,
            floating: true,
            backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColorSolid) || 'gray',
            borderColor: '#CCC',
            borderWidth: 1,
            shadow: false
        },
        tooltip: {
            formatter: function() {
                return '<b>'+ this.x +'</b><br/>'+
                    this.series.name +': '+ this.y +'<br/>'+
                    'Total: '+ this.point.stackTotal;
            }
        },
        plotOptions: {
            column: {
                stacking: 'normal',
                dataLabels: {
                    enabled: true,
                    color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white'
                }
            }
        },
        series: [{
            name: 'John',
            data: [5, 3, 4, 7, 2]
        }, {
            name: 'Jane',
            data: [2, 2, 3, 2, 1]
        }, {
            name: 'Joe',
            data: [3, 4, 4, 2, 5]
        }]
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:13:02.550

您需要在初始化图表之前过滤数据，如下所示：

```
var data = [{
    name: 'Year 1800',
    data: [0, 0, 0, 0, 0]
}, {
    name: 'Year 1900',
    data: [0, 156, 947, 408, 6]
}, {
    name: 'Year 2008',
    data: [0, 914, 4054, 732, 34]
}];

data = $.grep(data, function (category) {
    return $.grep(category.data, function (item) {
        return item > 0;
    }).length > 0;
}); 
```

[http://jsfiddle.net/EJFsH/2/](http://jsfiddle.net/EJFsH/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T13:33:55.830

问题是当您想动态删除类别（通过 setCategories 函数设置它们）时，您还应该注意数据系列中的元素。换句话说，当您想修改类别时，您还应该删除数据点。在使用 highcharts 中的数据之前，最好准备好没有零的数据。

# windows - 删除批处理脚本中的文件夹内容，windows，没有提示

> ID：15815734
> 
> 赞同：4
> 
> 时间：2013-04-04T15:41:13.717
> 
> 标签：windows, batch-file

我正在尝试编写一个批处理脚本，我必须在其中删除文件夹的内容，而不删除文件夹本身。我尝试使用

```
del "." 
```

但它会在此时停止批处理脚本，询问我是否确定删除。我不想要任何提示。有没有更简单的方法可以安静地做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:44:37.257

`del /q "."`

/q：安静模式，不询问是否可以删除全局通配符

与大多数命令一样，您可以使用`del /?`来查看此类选项。

# eclipse - 在 ubuntu 12.04 上启动时 Eclipse 崩溃

> ID：15815736
> 
> 赞同：4
> 
> 时间：2013-04-04T15:41:25.113
> 
> 标签：eclipse, ubuntu, crash

我只是发现安装了 ubuntu 12.04 的笔记本电脑上的 eclipse 总是崩溃。而且我尝试了不同版本的eclipse（3.6/3.7/4.2）。我还尝试了许多其他基于 Eclipse 的应用程序，但这些应用程序都不起作用。几天前它工作得很好，所以我想这应该是最新的 libc 更新有问题。

错误信息是

```
Unhandled exception
Type=Segmentation error vmState=0x00040000
J9Generic_Signal_Number=00000004 Signal_Number=0000000b Error_Value=00000000 Signal_Code=00000080
Handler1=B4BDAA36 Handler2=B4BB0021 InaccessibleAddress=00000000
EDI=08306E58 ESI=92F2BB43 EAX=BFB87E14 EBX=B7754FF4
ECX=00000000 EDX=0000000B
EIP=B76E15C5 ES=007B DS=007B ESP=BFB85324
EFlags=00010246 CS=0073 SS=007B EBP=B75AE6C0
Module=/lib/i386-linux-gnu/libc.so.6
Module_base_address=B75AF000
Target=2_40_20130114_134867 (Linux 3.2.0-39-generic-pae)
CPU=x86 (4 logical CPUs) (0x1f1439000 RAM)
----------- Stack Backtrace -----------
(0xB4BA3B76 [libj9prt24.so+0xbb76])
(0xB4BAF66C [libj9prt24.so+0x1766c])
(0xB4BA3C09 [libj9prt24.so+0xbc09])
(0xB4BA3D2C [libj9prt24.so+0xbd2c])
(0xB4BA39A8 [libj9prt24.so+0xb9a8])
(0xB4BAF66C [libj9prt24.so+0x1766c])
(0xB4BA3A1C [libj9prt24.so+0xba1c])
(0xB4BDB771 [libj9vm24.so+0xf771])
(0xB4BDB3F1 [libj9vm24.so+0xf3f1])
(0xB4BAF66C [libj9prt24.so+0x1766c])
(0xB4BDABD6 [libj9vm24.so+0xebd6])
(0xB4BB0199 [libj9prt24.so+0x18199])
(0xB779740C)
--------------------------------------- 
```

最近有人遇到同样的问题吗？有什么解决方法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-29T23:35:10.750

Ubuntu 12.04 不是 Eclipse 4.2 支持的平台。但是，10.04 使用的是 IBM Java 6 SR9。

[http://www.eclipse.org/eclipse/development/readme_eclipse_4.2.php#TargetOperatingEnvironments](http://www.eclipse.org/eclipse/development/readme_eclipse_4.2.php#TargetOperatingEnvironments)

当您使用 IBM Java 时，我建议您改用 OpenJDK 或 Oracle Java。注意：这是为了运行 Eclipse 本身——您仍然可以在 Eclipse 中使用 IBM Java 编写您自己的代码。

# function - 当用户在jquery中的输入之外单击时尝试填充输入字段

> ID：15815738
> 
> 赞同：1
> 
> 时间：2013-04-04T15:41:28.557
> 
> 标签：function, jquery

我对 jquery 很陌生，如果这是基本的，我很抱歉。

我目前有一个函数可以清空用户名输入字段的值，因此用户不必在输入用户名之前将其删除。

```
 $("#usernameInput").click(function(){
        $(this).val("");
    }); 
```

但是，如果用户没有在输入字段中输入任何内容，则我被困在尝试用“用户名”重新填充输入字段时，他们在单击输入字段后单击输入字段并使用上一个功能将其清除。

这是我到目前为止所尝试的：

```
$("html").click(function(){
    if( $("usernameInput").val() == " " ){
        $("usernameInput").val("username");
    }
    else{
        //do nothing as user has entered username
    }

}); 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:42:32.887

您通常会为此使用焦点和模糊事件

```
$("#usernameInput").on({
    focus: function(){
        if (this.value.trim() == 'username') this.value = '';
    },
    blur: function() {
        if (!this.value.trim().length) this.value = 'username';
    }
}); 
```

或者在 HTML5 中你可以使用占位符

```
<input type="text" id="usernameInput" placeholder="username" /> 
```

[**小提琴**](http://jsfiddle.net/wUUzD/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:44:29.310

试试这个

```
$("#usernameInput").focusout(function(){
    if(this.value == ""){
        $("usernameInput").val("username");
    }
    else{
        //do nothing as user has entered username
    }

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T15:45:16.530

```
$("#usernameInput").focus(function(){
    $(this).val("");
});

$("#usernameInput").blur(function(){
    if($(this).val().length < 1)
    {
      $(this).val("username");
    }
}); 
```

# ruby - Middleman Slim 模板 - 有没有办法将变量传递到 YAML 前端？

> ID：15815742
> 
> 赞同：2
> 
> 时间：2013-04-04T15:41:50.570
> 
> 标签：ruby, yaml, slim-lang, middleman

我正在使用 Middleman 和 Slim 模板。

我正在代理数据以自动创建多个页面。我需要使用变量设置 YAML 前端，但我不知道该怎么做！有人知道吗？

例如

在 config.rb

```
data.videos.expert_challenge_videos.each do |v|
  proxy "/live/expertchallenge/#{v.slug}.html", "/live/expertchallenge/template.html", :locals => { :v => v }, :ignore => true
end 
```

在 template.html.slim

```
---
title: Expert Challenge - #{v.name}
---
.live-single-video

  == partial 'header'

  .spacer

  .grid-container
    .grid-100.heading
      == image_tag "label-expertchallenge.png", alt: ''
  .grid-container
    .grid-100.video-container
      iframe src="http://area.autodesk.com/areaadmin/ooyala/show/ZobHQ4NzrsYP4CNnu2EijUGDRztihF7j/1000/562" width="1000" height="562" frameborder="0" webkitAllowFullScreen="webkitAllowFullScreen" mozallowfullscreen="mozallowfullscreen" allowFullScreen="allowFullScreen"

  .grid-container
    .grid-50.video-description
      .name
        | <b>Name:</b> #{v.name}
      .date
        | <b>Date:</b> #{v.date}
      .topics
        | <b>Topics:</b> #{v.topics}
    .grid-50.video-share
      | <div class="fb-like" data-send="false" data-layout="button_count" data-width="200" data-show-faces="false" data-href="#{endpoint}/live/expertchallenge/#{v.slug}.html"></div>&nbsp;&nbsp;&nbsp;
      | <a href="https://twitter.com/share" class="twitter-share-button" data-url="#{endpoint}/live/expertchallenge/#{v.slug}.html" data-via="Autodesk_ME" data-text="#{v.name}">Tweet</a>

== partial 'footer' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-20T16:30:45.903

在您的 config.rb 中添加以下行：

```
set :frontmatter_extensions, %w(.html .slim) 
```

这应该可以解决问题。

# java - Java 上的 Dijkstra：使用 Fibonacci Heap 与 PriorityQueue 获得有趣的结果

> ID：15815744
> 
> 赞同：5
> 
> 时间：2013-04-04T15:41:54.797
> 
> 标签：java, data-structures, heap, dijkstra, fibonacci-heap

我最近使用两种数据结构对 Dijkstra 算法的运行时间进行了初步比较，基于 Java 的 PriorityQueue（如果我没记错的话，基于二进制堆）和 Fibonacci 堆。我使用 Java 的 currentTimeMillis() 进行计算。我最终得到的结果非常有趣。这是我的一个测试用例的输出：

```
Running Dijkstra's with 8 nodes and 27 links
- Execution time with binary heap: 1 miliseconds
- Execution time with Fibonacci heap: 4 miliseconds 
```

诚然，我目前缺乏数据集，上面的图表是我最大的（我计划尽快制作更多）。但这有意义吗？我一直认为斐波那契堆比其他数据结构更快，因为与其他数据结构相比，它们摊销了运行时间。我不确定这 3 毫秒的差异是从哪里来的。（我在 Intel Core Ivy Bridge i7-3630M 处理器上运行它，如果有帮助的话。）

注意：我偶然发现了[这个可能解释这个问题的线程](https://stackoverflow.com/questions/504823/has-anyone-actually-implemented-a-fibonacci-heap-efficiently)，但我仍然不清楚为什么斐波那契堆版本需要更长的时间。根据该线程，这可能是因为我的图不够密集，因此减少键操作的数量不足以使斐波那契堆的性能真正发挥作用。这是唯一合理的结论，还是我还缺少其他东西？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-04T16:16:01.440

斐波那契堆比二进制堆（Java 的优先级队列中使用的数据结构）*渐近*更快，因为 Dijkstra 的算法在斐波那契堆中将花费 O(m + n log n) 时间，但在二进制堆中将花费 O(m log n) 时间。这意味着对于大而密集的图，在最坏的情况下，斐波那契堆会更快。

尽管斐波那契堆在渐近上比二叉堆快，但它们具有众所周知的大常数因子，并且斐波那契堆上的许多基本操作需要很长时间才能完成。从长远来看，它们会胜过二叉堆，但对于小图，常数项可能太大，以至于斐波那契堆实际上更慢。

其次，比较渐近运行时间（O(m + n log n) 与 O(m log n)）。如果您使用的图形是稀疏的（即 m = O(n)），那么这两个渐近运行时都是相同的（O(n log n)）。在这种情况下，斐波那契堆的理论优势不存在，二叉堆可能是更好的选择。

最后，请注意，在这种情况下，大 O 表示法指的是最坏情况下的行为，而不是平均情况下的行为。不久前有一篇论文表明，对于某种类型的随机图，Dijkstra 的期望算法远低于最坏情况下减少键和出列操作的数量。在这种情况下，即使在大型图上，二叉堆的性能也可能优于斐波那契堆，因为最坏情况下的行为可能永远不会被触发。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T16:11:00.253

斐波那契堆具有更快的*渐近线*，但它们的常数因子不一定很大。在超过一百万左右的可笑输入时，它们可能会更快，但对于小输入，二进制堆可能会明显更快。

# c# - C# 运行外部控制台应用程序并且没有输出？

> ID：15815747
> 
> 赞同：1
> 
> 时间：2013-04-04T15:42:00.620
> 
> 标签：c#

在我的项目（MVC 3）中，我想使用以下代码运行外部控制台应用程序：

```
 string returnvalue = string.Empty;

   ProcessStartInfo info = new ProcessStartInfo("C:\\someapp.exe");
   info.UseShellExecute = false;
   info.Arguments = "some params";
   info.RedirectStandardInput = true;
   info.RedirectStandardOutput = true;
   info.CreateNoWindow = true;

   using (Process process = Process.Start(info))
   {
      StreamReader sr = process.StandardOutput;
      returnvalue = sr.ReadToEnd();
   } 
```

但是我在 中得到一个空字符串，`returnvalue`该程序因此创建了一个文件，但没有创建任何文件。也许 taht`Process`没有被执行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T16:38:52.053

如果我没记错的话，要同时读取标准错误和标准输出，您必须使用异步回调：

```
var outputText = new StringBuilder();
var errorText = new StringBuilder();
string returnvalue;

using (var process = Process.Start(new ProcessStartInfo(
    "C:\\someapp.exe",
    "some params")
    {
        CreateNoWindow = true,
        ErrorDialog = false,
        RedirectStandardError = true,
        RedirectStandardOutput = true,
        UseShellExecute = false
    }))
{
    process.OutputDataReceived += (sendingProcess, outLine) =>
        outputText.AppendLine(outLine.Data);

    process.ErrorDataReceived += (sendingProcess, errorLine) =>
        errorText.AppendLine(errorLine.Data);

    process.BeginOutputReadLine();
    process.BeginErrorReadLine();
    process.WaitForExit();
    returnvalue = outputText.ToString() + Environment.NewLine + errorText.ToString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:54:28.180

您必须等待外部程序完成，否则在您想要读取时甚至不会生成您想要读取的输出。

```
using (Process process = Process.Start(info))
{
  if(process.WaitForExit(myTimeOutInMilliseconds))
  {
  StreamReader sr = process.StandardOutput;
  returnvalue = sr.ReadToEnd();
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T15:54:36.257

正如 TimothyP 在评论中所说，设置后`RedirectStandardError = true`，然后通过`process.StandardError.ReadToEnd()`我得到错误消息内容

# c++ - 在此指令“MOV Incoming_Packet_Length,DWORD PTR SS:[EBP-14]”处出现错误 C2415

> ID：15815749
> 
> 赞同：0
> 
> 时间：2013-04-04T15:42:10.010
> 
> 标签：c++, hook

我是 C++ 和内联 asm 的新手，搜索并没有让我在任何地方得到错误 C2415

```
MOV Incoming_Packet_Length,DWORD PTR SS:[EBP-14]
MOV Incoming_Packet_Pointer,DWORD PTR SS:[EBP-1C] 
```

我挂了这个

```
Address   Hex dump          Command    
006D89D0  |> >FF75 EC       PUSH DWORD PTR SS:[EBP-14]
006D89D3  |. |FF75 E4       PUSH DWORD PTR SS:[EBP-1C]
006D89D6  |. |E8 B4C5FFFF   CALL 006D4F8F 
```

我想获得这些值的变量都是静态整数

静态 int Incoming_Packet_Length; 静态 int Incoming_Packet_Pointer;

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:45:37.080

我猜 C2415 是一种“无效的寻址模式”。您需要分两步进行移动：

```
MOV      EAX,DWORD PTR SS:[EBP-14]
MOV      Incoming_Packet_Length,EAX
MOV      EAX,DWORD PTR SS:[EBP-1C]
MOV      Incoming_Packet_Pointer,EAX 
```

X86 不支持直接从内存移动到内存 - 一侧需要是寄存器。

# python - 使用 HTTP Digest 身份验证保护 REST 端点

> ID：15815751
> 
> 赞同：2
> 
> 时间：2013-04-04T15:42:13.870
> 
> 标签：python, security, rest, authentication, flask

*   我正在开发一个`Python`使用的项目，`Flask`其端点为

> ```
> @app.route(/transaction)
> def get(request):
>   ...
> 
> @app.route(/transaction)
> def post(request):
>   ... 
> ```

*   另外，我希望 REST 端点在方法执行之前经过身份验证
*   我对此进行了很多搜索，发现我可能需要[摘要身份验证](http://en.wikipedia.org/wiki/Digest_access_authentication)（直到现在我还不确定）

**问题**

*   如何使用 python 和烧瓶实现这样的安全模式？我可以看到并从中学习的任何可用示例？
*   我不想以明文形式传递密码并且使用令牌是一个更好的主意，那么考虑 HTTP 摘要式身份验证是一个正确的选择吗？
*   你们还有什么想推荐的吗？

我希望我的服务器是**无状态**的，并且不在服务器端存储任何会话

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T10:33:17.893

查看[https://flask-restless.readthedocs.org/en/latest/](https://flask-restless.readthedocs.org/en/latest/)。

为了安全存在扩展：[http://pythonhosted.org/Flask-Login/](http://pythonhosted.org/Flask-Login/)和[http://pythonhosted.org/Flask-Principal/](http://pythonhosted.org/Flask-Principal/)。

无状态服务不存储会话数据，这意味着您必须为每个请求发送凭据。

1.  您可以只使用普通的登录名和密码，也可以为此使用哈希函数。
2.  您可以在用户端存储密钥并生成/加密您的纯数据作为登录名、密码、另一个请求数据。这可以保护您免受其他请求的影响，但不能保护您免受某些请求的影响，但您也可以添加时间戳之类的内容并拒绝任何旧请求或添加唯一的请求 ID 并拒绝某些请求。
3.  您可以使用更有效的方法，例如 https。

有状态服务还可以获得普通的登录名和密码进行身份验证，并生成授权令牌，随每个请求一起发送。

# regex - 仅使用内置 T-SQL 选择捕获的值

> ID：15815752
> 
> 赞同：1
> 
> 时间：2013-04-04T15:42:18.223
> 
> 标签：regex, sql-server-2008, tsql

我只想从中提取电子邮件

> 违反 UNIQUE KEY 约束“UQ_Email”。无法在对象“dbo.User”中插入重复键。重复键值为 (name.surname@email.com)。该语句已终止。

在**DescriptionError**列中。

在 C# 中，这是几行代码，但我想知道是否可以仅使用**T-SQL***内置函数捕获***(name.surname@email.com)**部分。

 ***我试过的：

```
SELECT SUBSTRING(DescriptionError,NULLIF(PATINDEX('%@email.com)%',DescriptionError) - 15,1),35) 
as UserEmail
FROM ErrorLog
order by DateInserted desc 
```

这可行，但我必须猜测开始/结束长度。

更新：

需要明确的是，**DescriptionError**列包含各种错误日志（正如错误日志表所预期的那样），括号内的值与电子邮件不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T10:57:38.117

`Like`模式相当有限，这是寻找的一种天真的方法

*一个括号 > 至少一个字符 > @ > 域以 az/0-9 开头 > 更多字符 > 句点 > tld 和 2 个 az > 更多字符 > 括号*

```
create function udfTryGetEmail(@value varchar(1024)) returns varchar(64) as begin
   declare @pos int = 1 + patindex('%(_%@[0-9A-Z]%.[A-Z][A-Z]%)%', @value)
   if @pos = 1
      return ''

   return substring(@value, @pos, charindex(')', @value, @pos) - @pos)
end

select dbo.udfTryGetEmail(DescriptionError) ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:01:27.820

您可以使用 CHARINDEX。尝试这个：

-- 寻找起点

```
DECLARE @Start INT

SELECT @Start = CHARINDEX('(', DescriptionError, 0) 
FROM ErrorLog 
```

--找到终点

```
DECLARE @End INT

SELECT @End = CHARINDEX(')', DescriptionError, 0) 
FROM ErrorLog 
```

如果您真的想使用正则表达式，阅读您的更新后，我会阅读这篇文章： [https ://www.simple-talk.com/sql/t-sql-programming/tsql-regular-expression-workbench/](https://www.simple-talk.com/sql/t-sql-programming/tsql-regular-expression-workbench/)***

# jboss - javax.naming.NameNotFoundException：未绑定 TDIDS

> ID：15815756
> 
> 赞同：0
> 
> 时间：2013-04-04T15:42:25.103
> 
> 标签：jboss, jndi

我收到主题错误。详情`*.ds.xml`如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<datasources>
    <local-tx-datasource>
        <jndi-name>KHDS</jndi-name>
        <connection-url>
            jdbc:sqlserver://servername:1433;DatabaseName=mydb;SelectMethod=cursor
        </connection-url>
        <driver-class>
            com.microsoft.sqlserver.jdbc.SQLServerDriver
        </driver-class>
        <user-name>user</user-name>
        <password>pwd</password>
        <min-pool-size>50</min-pool-size>
        <max-pool-size>500</max-pool-size>
        <query-timeout>60</query-timeout>   
        <blocking-timeout-millis>60000</blocking-timeout-millis>
        <idle-timeout-minutes>1</idle-timeout-minutes>
        <metadata>
            <type-mapping>MS SQLSERVER2000</type-mapping>
        </metadata>
    </local-tx-datasource>
</datasources> 
```

错误跟踪如下：

```
- javax.naming.NameNotFoundException: KHDS not bound
    at org.jnp.server.NamingServer.getBinding(NamingServer.java:491)
    at org.jnp.server.NamingServer.getBinding(NamingServer.java:499)
    at org.jnp.server.NamingServer.getObject(NamingServer.java:505)
    at org.jnp.server.NamingServer.lookup(NamingServer.java:278)
    at org.jnp.interfaces.NamingContext.lookup(NamingContext.java:544)
    at org.jnp.interfaces.NamingContext.lookup(NamingContext.java:520)
    at javax.naming.InitialContext.lookup(InitialContext.java:392)
    at pk.com.tdi.core.db.DBManager.createConnection(DBManager.java:203)
    at pk.com.tdi.core.db.DBManager.<init>(DBManager.java:65)
    at pk.com.tdi.core.wf_1_0.facade.WorkflowServiceImpl.getCurrentStage(WorkflowServiceImpl.java:384)
    at pagecode.PolicySearchDetail.onPageLoadBegin(PolicySearchDetail.java:241) 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:19:53.550

您尝试访问的 JNDI 资源不存在。请检查服务器中的资源是否存在您尝试访问的 JNDI 名称。

问候，

# jquery - 无法删除整个可拖动

> ID：15815757
> 
> 赞同：0
> 
> 时间：2013-04-04T15:42:32.037
> 
> 标签：jquery, jquery-ui

我有一个既可拖动又可调整大小的 img 元素。我正在尝试为此元素创建一个删除按钮。删除按钮嵌入在可拖动容器中。当我做

`$('deleteBtn').parent().remove();`

除了原始图像之外，一切都进行了。我究竟做错了什么。

[http://jsfiddle.net/p9PBA/2/](http://jsfiddle.net/p9PBA/2/)

单击图像以创建可拖动，然后左上角的黑框是删除。

编辑：这可能与 img 元素的静态定位有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:56:34.070

这似乎有效：

```
deleteBtn.click(function(){
    $(this).siblings('img').remove();
    $(this).parent().remove();
}); 
```

# qt - Qt QProcess 抱怨 QThread::Start ，线程创建错误

> ID：15815759
> 
> 赞同：0
> 
> 时间：2013-04-04T15:42:38.257
> 
> 标签：qt, qthread, qprocess, qtembedded

我有一个非常简单的应用程序，它应该使用 QProcess 来进行一些系统控制。然后整个程序如下。每次我运行该应用程序时，它都会抱怨以下内容：

```
QThread::start: Thread creation error: Resource temporarily unavailable 
```

我使用 _POSIX_THREAD_THREADS_MAX 打印出一个进程的最大线程数，它打印 64。我也可以在命令行上运行 QProcess 命令，没有任何问题。是什么赋予了？

代码：

```
int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);

    // Get the command line parameter to turn wifi on or off
    QString wifiSwitch = argv[1];

    // Print the number of threads available
    qDebug() << "Single Process can spawn this many threads:" << _POSIX_THREAD_THREADS_MAX;

    // Switch based on the input and control wifi with systemctl
    if ( wifiSwitch == "on" ) {

        // Subprocess systemd
        QProcess controlWifi;
        controlWifi.start("systemctl start wiap.service");
        controlWifi.waitForFinished();

        // Grab the output and use it to determine whether we successfully turned on the wifi
        QString didTurnOnWifi = QString(controlWifi.readAll()).trimmed();
        controlWifi.close();

        // So if there is no error messages from the subprocess we were successful
        if ( didTurnOnWifi.length() == 0 ) {
            qDebug() << "SUCCESS";
            exit(0);
        }
        else {
            qDebug() << "FAILURE";
            exit(-1);
        }

    }
    else if ( wifiSwitch == "off" ) {

        // Subprocess systemd
        QProcess controlWifi;
        controlWifi.start("systemctl stop wiap.service");
        controlWifi.waitForFinished();

        // Grab the output and use it to determine whether we successfully turned on the wifi
        QString didTurnOnWifi = QString(controlWifi.readAll()).trimmed();
        controlWifi.close();

        // So if there is no error messages from the subprocess we were successful
        if ( didTurnOnWifi.length() == 0 ) {
            qDebug() << "SUCCESS";
        }
        else {
            qDebug() << "FAILURE";
        }

    }
    else {

        // No arguments
        qDebug() << "FAILURE: You didn't specify any command line arguments, call this program like './fluke-control-wifi on|of'";
        exit(-1);

    }

    return a.exec();
} 
```

注意：我最近从 Qt 4.8.3 升级到 Qt 4.8.4 但这真的不应该破坏 QProcess .. 我也找不到错误报告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T09:08:54.417

尝试添加

```
if(!controlWifi.waitForStarted())
{
    qDebug("Error starting process\n");
    return;
} 
```

刚打电话开始。

# facebook - HTML5 facebook Like 框中的问题

> ID：15815760
> 
> 赞同：0
> 
> 时间：2013-04-04T15:42:43.217
> 
> 标签：facebook, facebook-like

我在我们的网站上使用 Facebook Like 框。但是当喜欢 Facebook 的人在那里显示用户拇指图像时，它会隐藏起来。

我在哪里做错了？？？怎么修？请告诉我。

请参阅下面的链接 Facebook 代码和显示。检查后请点击like按钮。

查看现场演示：www.jsfiddle.net/aQnjC/

看截图[点击这里](http://demo.harnishdesign.net/like.jpg)。

先感谢您。

# java - 在集合布局之外添加元素（即 JLabels）

> ID：15815761
> 
> 赞同：0
> 
> 时间：2013-04-04T15:42:44.710
> 
> 标签：java, swing, layout, jpanel, layout-manager

作为项目的一部分，我们必须有 9 个盒子，在这里我刚刚实现了交替颜色作为示例来代替我们应该使用的图像。但是，虽然我希望这 9 个`JLabels`在此网格`layout (3,3)`中，但我还希望在顶部 (a `JLabel`) 有一条消息，我可以将其集中起来，比如欢迎消息以及在`JButtons`下面有大约四个？有人可以为我指出如何实现这一目标的正确方向吗？

谢谢！

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

class HomeController extends JPanel implements MouseListener
{
    HomeController()
    {
        setLayout(new GridLayout(3,3));

        JLabel apl1 = new JLabel("");
        apl1.setBackground(Color.WHITE);
        apl1.setOpaque(true);
        this.add(apl1);

        JLabel apl2 = new JLabel("");
        apl2.setBackground(Color.BLACK);
        apl2.setOpaque(true);
        this.add(apl2);

        JLabel apl3 = new JLabel("");
        apl3.setBackground(Color.WHITE);
        apl3.setOpaque(true);
        this.add(apl3);

        JLabel apl4 = new JLabel("");
        apl4.setBackground(Color.BLACK);
        apl4.setOpaque(true);
        this.add(apl4);

        JLabel apl5 = new JLabel("");
        apl5.setBackground(Color.WHITE);
        apl5.setOpaque(true);
        this.add(apl5);

        JLabel apl6 = new JLabel("");
        apl6.setBackground(Color.BLACK);
        apl6.setOpaque(true);
        this.add(apl6);

        JLabel apl7 = new JLabel("");
        apl7.setBackground(Color.WHITE);
        apl7.setOpaque(true);
        this.add(apl7);

        JLabel apl8 = new JLabel("");
        apl8.setBackground(Color.BLACK);
        apl8.setOpaque(true);
        this.add(apl8);

        JLabel apl9 = new JLabel("");
        apl9.setBackground(Color.WHITE);
        apl9.setOpaque(true);
        this.add(apl9);

        JLabel message = new JLabel("hello world");
        this.add(message);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:18:39.440

您可以组合具有不同布局的多个面板。有关详细信息，请查看[A Visual Guide to Layout Managers](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)。

例如，默认布局`JFrame`为`BorderLayout`. 使用`BorderLayout`，您可以将标题放置在`BorderLayout.NORTH`，将带有按钮的面板放置在 ，将`BorderLayout.SOUTH`带有标签网格的面板放置在`BorderLayout.CENTER`。每个面板可能有自己更复杂的布局。例如，标签网格使用`GridLayout`，按钮面板使用`FlowLayout`。

这是一个基于已发布代码的非常简单的示例，它演示了这种方法：

![在此处输入图像描述](https://i.stack.imgur.com/LVJji.png)

```
import java.awt.*;
import javax.swing.*;

public class TestGrid {
    public TestGrid() {
        final JFrame frame = new JFrame("Grid");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel mainPanel = new JPanel(new GridLayout(3, 3));

        for (int idx = 0; idx < 9; idx++) {
            JLabel label = new JLabel();
            label.setBackground(idx % 2 == 0 ? Color.WHITE : Color.BLACK);
            label.setOpaque(true);
            mainPanel.add(label);
        }
        mainPanel.setPreferredSize(new Dimension(200, 200));
        frame.add(mainPanel, BorderLayout.CENTER);

        frame.add(new JLabel("Title", JLabel.CENTER), BorderLayout.NORTH);

        JPanel buttonsPanel = new JPanel();
        buttonsPanel.add(new JButton("Start"));
        buttonsPanel.add(new JButton("Stop"));
        frame.add(buttonsPanel, BorderLayout.SOUTH);

        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        try {
          UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        } catch (Exception e) {
            e.printStackTrace();
        }
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new TestGrid();
            }
        });
    }
} 
```

# apache-flex - 使用 fdt 编译 flex 项目 使用 flex sdk 作为运行时共享 swc

> ID：15815763
> 
> 赞同：0
> 
> 时间：2013-04-04T15:42:47.323
> 
> 标签：apache-flex, flex4.5, swc, fdt

我一直在尝试使用 flex SDK 4.5.1 编译 flex 项目。

我使用日食 FDT。

我希望我的 flex 应用程序不占用太多空间。

我的所有页面包含 4 个不同的 swf 文件，每个文件都包含整个 flex sdk。我试图通过将 flex sdk 从它们中取出并将其上传到它们的位置来缩小它们。

当我单击我的项目的属性并转到`Build Path`然后转到时`Build Order`，我确保所有相关的 swc 文件都在顶部并被标记`Use as Runtime Shared Code`。当然我说的是 flex sdk swc 文件（spark.swc、mx.swc 等等......）

我还将所有这些 swc 文件复制并上传到我的主 swf 文件所在的同一位置。

当我执行主 swf 文件时。我在打开了firebug的firefox浏览器上执行它，我得到了许多它找不到Application、UIMovieClip等的VerifyError异常。

我认为主 swf 文件根本没有尝试定位 sdk，这就是缺少类的原因。

任何想法如何解决这个问题？

我在下面粘贴了完整的堆栈跟踪、fdt 构建路径和编译器页面。

![fdt 构建路径](https://i.stack.imgur.com/HaB0j.png)

![fdt 编译器](https://i.stack.imgur.com/x1BbQ.png)

```
 VerifyError: Error #1014: Class spark.components::Application could not be found.
 VerifyError: Error #1014: Class mx.flash::UIMovieClip could not be found.
 Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class spark.components::Application could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class mx.flash::UIMovieClip could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class mx.core::SpriteAsset could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class mx.resources::ResourceBundle could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class mx.resources::ResourceBundle could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class mx.resources::ResourceBundle could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class mx.resources::ResourceBundle could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class mx.resources::ResourceBundle could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class mx.resources::ResourceBundle could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class mx.resources::ResourceBundle could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
Warning: Failed to parse corrupt data.
VerifyError: Error #1014: Class mx.resources::ResourceBundle could not be found.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
ReferenceError: Error #1065: Variable _class_embed_css_Assets_swf__553552754_mx_skins_cursor_BusyCursor_617494571 is not defined.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick()
ReferenceError: Error #1065: Variable buy_coins_component is not defined.

at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:284]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\managers\SystemManager.as:2633]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.5.1\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T10:36:37.710

> 我还将所有这些`swc`文件复制并上传到我的主 swf 文件所在的同一位置

`swc`文件不能在运行时使用。

如果您在编译期间指定 rsl url，则您的 swf 可以从 adobe 站点（或...可能是 Apache 站点）或其他地方获取 flex rsls。

这些 rsls 应为`.swf`形式或`.swz`形式（签名的）。

您可以`.swf`在 sdk 文件夹中找到 rsls，或者您可以根据需要从中提取它们`.swc`，但是，当您的 swf 构建时，编译器应将 rsls 放置在输出文件夹中（至少它们总是被填充，`bin-debug`并且`bin-release`当使用 构建时`Flash Builder`，不要知道是否`FDT`不同）。

您还可以使用`Charles`查看您的 swf 请求的 url，包括 rsl url。

您可能还希望避免使用指向 adobe/apache 的默认 rsl url，因为它们并不总是可靠的（至少我遇到了问题，我们必须将所有 flex rsl 存储在我们的服务器上）。

# c# - 下载非常大的文件会导致客户端每隔 1:30-1:45 分钟断开连接

> ID：15815770
> 
> 赞同：0
> 
> 时间：2013-04-04T15:43:01.230
> 
> 标签：c#, file-io, download

这是我下载文件的代码。

```
 Stream iStream = null;

            // Buffer to read 1K bytes in chunk:
            byte[] buffer = new Byte[ 4194304 ];

            // Length of the file:
            int length;

            // Total bytes to read:
            long dataToRead;

            // Identify the file to download including its path.
            string filepath = PathToFile;

            // Identify the file name.
            //string filename = Path.GetFileName( filepath );
                             Response.Clear();
            try
            {
                // Open the file.
                iStream = new FileStream( filepath, FileMode.Open,
                            FileAccess.Read, FileShare.Read );

                // Total bytes to read:
                dataToRead = iStream.Length;

                Response.ContentType = ContentType;
                Response.AddHeader("Content-Disposition", "attachment; filename=" + clientNameOfFile);
                Response.AddHeader("Content-Length", dataToRead.ToString());

                Response.BufferOutput = true;
                // Read the bytes.
                while ( dataToRead > 0 )
                {
                    // Verify that the client is connected.

                    if ( Response.IsClientConnected )
                    {
                        // Read the data in buffer.
                        length = iStream.Read( buffer, 0, 100000 );

                        // Write the data to the current output stream.
                        Response.OutputStream.Write( buffer, 0, length );

                        // Flush the data to the HTML output.
                        Response.Flush();

                        buffer = new Byte[ 100000];
                        dataToRead = dataToRead - length;
                    }
                    else
                    {
                        //prevent infinite loop if user disconnects
                        dataToRead = -1;
                    }
                }
            }
            catch ( Exception ex )
            {
                // Trap the error, if any.
                Response.Write( "Error : " + ex.Message );

            }
            finally
            {
                if ( iStream != null )
                {
                    //Close the file.
                    iStream.Close();
                }
                Response.Close();
            } 
```

尝试下载 50MB 文件时，客户端每隔 1:30- 1:45 分钟就会断开连接。我应该检查哪些可能导致客户端断开连接的事情？

```
I have the following web config settings
<httpRuntime executionTimeout="999999" maxRequestLength="51200" />
<sessionState mode="StateServer" stateConnectionString="xxx:42424"   useHostingIdentity="true" timeout="10000" />
<requestFiltering>
            <requestLimits maxAllowedContentLength="209715200" />
        </requestFiltering> 
```

IIS 应用程序池空闲超时设置为 20。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-13T10:16:18.167

您的代码不一致。你已经声明了 byte[] buffer = new Byte[ 4194304 ]; 在开始并将其更改为 buffer = new Byte[ 100000]; 在while循环中。长度也不一致 length = iStream.Read(buffer, 0, 100000);

# javascript - 如何在提交表单之前删除 AutoNumeric 格式？

> ID：15815771
> 
> 赞同：17
> 
> 时间：2013-04-04T15:43:01.497
> 
> 标签：javascript, jquery, jquery-plugins, autonumeric.js

我正在使用 jQuery 插件[AutoNumeric](http://www.decorplanit.com/plugin/)但是当我提交表单时，我无法删除之前字段的格式`POST`。

我尝试使用`$('input').autonumeric('destroy')`（和其他方法），但它在文本字段上留下了格式。

如何`POST`将未格式化的数据发送到服务器？如何删除格式？在初始配置或其他地方是否有它的属性？

我不想将序列化的表单数据发送到服务器（使用 AJAX）。我想提交带有未格式化数据的表单，就像普通的 HTML 操作一样。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-05T08:37:53.743

我在 jQuery 中为此编写了一个更好、更通用的 hack

```
$('form').submit(function(){
    var form = $(this);
    $('input').each(function(i){
        var self = $(this);
        try{
            var v = self.autoNumeric('get');
            self.autoNumeric('destroy');
            self.val(v);
        }catch(err){
            console.log("Not an autonumeric field: " + self.attr("name"));
        }
    });
    return true;
}); 
```

此代码使用非 autoNumeric 值的错误处理清除表单。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2019-06-12T18:13:07.763

对于较新的版本，您可以使用以下选项：

```
unformatOnSubmit: true 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-18T23:24:47.590

在数据回调中，您必须调用 getString 方法，如下所示：

```
 $("#form").autosave({
        callbacks: {
            data: function (options, $inputs, formData) {

                return $("#form").autoNumeric("getString");
            },
            trigger: {
                method: "interval",
                options: {
                    interval: 300000
                }
            },
            save: {
                method: "ajax",
                options: {
                    type: "POST",
                    url: '/Action',
                    success: function (data) {

                    }
                }
            }
        }
    }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T15:45:44.930

使用`get`方法。

> '得到' | 通过 ".val()" 或 ".text()" 返回未格式化的对象 | $(selector).autoNumeric('get');

* * *

```
<script type="text/javascript">
    function clean(form) {
        form["my_field"].value = "15";
    }
</script>

<form method="post" action="submit.php" onsubmit="clean(this)">
    <input type="text" name="my_field">
</form> 
```

这将始终提交`"15"`。现在发挥创意:)

* * *

镜像原始值：

```
<form method="post" action="submit.php">
    <input type="text" name="my_field_formatted" id="my_field_formatted">
    <input type="hidden" name="my_field" id="my_field_raw">
</form>

<script type="text/javascript">
    $("#my_field_formatted").change(function () {
        $("#my_field").val($("#my_field_formatted").autoNumeric("get"));
    });
</script> 
```

in`submit.php`忽略 for 的值`my_field_formatted`并`my_field`改为使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-11T09:45:11.707

您可以随时使用 php`str_replace`函数

```
str_repalce(',','',$stringYouWantToFix); 
```

它将删除所有逗号。如有必要，您可以将值转换为整数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-30T00:19:55.837

```
$("input.classname").autoNumeric('init',{your_options});
$('form').submit(function(){
   var form=$(this);
   $('form').find('input.classname').each(function(){
       var self=$(this);
       var v = self.autoNumeric('get');
       // self.autoNumeric('destroy');
       self.val(v);
   });
}); 
```

**classname**是您的输入类，它将作为 autoNumeric 初始化对不起英语不好^_^

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-21T08:29:19.677

还有另一种集成解决方案，它不会干扰您的客户端验证，也不会导致提交前未格式化的文本闪烁：

```
var input = $(selector);
var proxy = document.createElement('input');
proxy.type = 'text';
input.parent().prepend(proxy);
proxy = $(proxy);
proxy.autoNumeric('init', options);
proxy.autoNumeric('set', input.val())''
proxy.change(function () {
    input.val(proxy.autoNumeric('get'));
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-27T15:21:07.480

您可以使用**getArray**方法（[http://www.decorplanit.com/plugin/#getArrayAnchor](http://www.decorplanit.com/plugin/#getArrayAnchor)）。

`$.post("myScript.php", $('#mainFormData').autoNumeric('getArray'));`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-02T18:16:23.523

我想出了这个，似乎是最干净的方法。我知道这是一个很老的线程，但它是第一个谷歌匹配，所以我会把它留在这里以备不时之需

```
$('form').on('submit', function(){
    $('.curr').each(function(){
        $(this).autoNumeric('update', {aSign: '', aDec: '.', aSep: ''});;
    });
}); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-27T08:07:25.980

**AJAX 用例解决方案**

> 我相信这是上述所有问题中更好的答案，因为写这个问题的人正在做 AJAX。所以请点赞它，以便人们轻松找到它。对于非 ajax 表单提交，@jpaoletti 给出的答案是正确的。

```
// Get a reference to any one of the AutoNumeric element on the form to be submitted
var element = AutoNumeric.getAutoNumericElement('#modifyQuantity');

// Unformat ALL elements belonging to the form that includes above element
// Note: Do not perform following in AJAX beforeSend event, it will not work
element.formUnformat();

$.ajax({
    url: "<url>",
    data : {
        ids : ids,
        orderType : $('#modifyOrderType').val(),

        // Directly use val() for all AutoNumeric fields (they will be unformatted now)
        quantity : $('#modifyQuantity').val(),
        price : $('#modifyPrice').val(),
        triggerPrice : $('#modifyTriggerPrice').val()
    }
})
.always(function(  ) {
    // When AJAX is finished, re-apply formatting    
    element.formReformat();     
}); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-01-25T13:04:18.157

`autoNumeric("getArray")`不再工作。

`unformatOnSubmit: true`使用 serializeArray() 使用 Ajax 提交表单时似乎不起作用。

而是用于`formArrayFormatted`获取等效的序列化数据`form.serializeArray()`

只需从表单中获取任何 AutoNumeric 初始化元素并调用该方法。它将序列化整个表单，包括非自动数字输入。

```
$.ajax({
    type: "POST",
    url: url,
    data: AutoNumeric.getAutoNumericElement("#anyElement").formArrayFormatted(),
)}; 
```

# ember.js - 从父路由继承模型

> ID：15815774
> 
> 赞同：3
> 
> 时间：2013-04-04T15:43:15.640
> 
> 标签：ember.js

我有一个应用程序路由，它需要一个应用程序 ID，从这里我转到 app/:app_id/settings，这会从一个单独的模板打开一个 Twitter Bootstrap 模式，从这里我希望能够做一些事情，比如更改应用程序名称和其他类似的东西，但我似乎无法访问该模型。我假设因为我嵌套了路由，所以我可以访问当前的应用程序模型，但我没有。我也无权访问父路由中的参数，所以不知道该怎么做。我在下面包含了相关的（我认为）代码。

```
WEM.Router.map(function(){
    this.resource( 'apps', { path: '/' }, function(){
        this.resource( 'app', { path: 'app/:app_id'}, function(){
            this.resource( 'settings', { path: 'settings' } );
            this.resource( 'error', { path: 'error/:error_id' } );
        });
    });
});

// Routes
WEM.AppsRoute = Ember.Route.extend({
    model: function(){
        return WEM.App.find();
    }
});

WEM.SettingsRoute = Ember.Route.extend({
    model: function( params ){
        console.log( WEM.App.find( params.app_id ).get( 'id' ) );
        return WEM.App.find( params.app_id );
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:52:58.200

我认为将您的模型挂钩更改`SettingsRoute`为

```
model: function(params) {
    return this.modelFor("app");
} 
```

可能有帮助。

# xcode - 如果未触摸 PickerView，则 UIPickerView 选择第 0 行

> ID：15815776
> 
> 赞同：0
> 
> 时间：2013-04-04T15:43:18.810
> 
> 标签：xcode, uipickerview

我试图消除的关于 PickerView 的一个烦人的事情是，如果用户必须从第零行移开并重新选择它。我希望这样，如果用户决定选择零行，他只需按下按钮即可转到下一个视图，并且将选择零行值。

有任何想法吗？

非常感谢

这是我的代码 - 目前，如果按下连接到 saveSelectedCondition 的按钮，并且 pickerView 没有移出第 0 行，则为 selectedCondition 返回 null，而不是第 0 行的条件值：

```
 - (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component {

        Condition *condition = [[self.fetchedResultsController fetchedObjects] objectAtIndex:row];
        self.selectedCondition = condition;
        NSLog(@"The '%@' condition was selected using the picker", self.selectedCondition.name);
    }

    - (IBAction)saveSelectedCondition:(id)sender {
        [self.selectedCondition setValue:@"YES" forKey:@"isSelectedCondition"];
        [self.managedObjectContext save:nil];
        NSLog(@"Saving selected condition (%@) with isSelectedCondition set to '%@'", self.selectedCondition.name, self.selectedCondition.isSelectedCondition);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T05:51:29.037

尝试一下....

```
- (IBAction)saveSelectedCondition:(id)sender {
    myText.text = [myArray objectAtIndex:0];//Just add this line for set first value
    [self.selectedCondition setValue:@"YES" forKey:@"isSelectedCondition"];
    [self.managedObjectContext save:nil];
    NSLog(@"Saving selected condition (%@) with isSelectedCondition set to '%@'", self.selectedCondition.name, self.selectedCondition.isSelectedCondition);
}

Set first value when your picker view called. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T11:50:40.900

我现在使用以下代码在 performFetch 之后对其进行了整理：

```
 [self performFetch];
    NSLog(@"The following Conditions were fetched for the Picker by SelectorViewController:");
    for (Condition *fetchedCondition in [self.fetchedResultsController fetchedObjects]) {
        if (fetchedCondition ==[[self.fetchedResultsController fetchedObjects] objectAtIndex:0])
        {[fetchedCondition setValue:@"YES" forKey:@"isSelectedCondition"];
            self.selectedCondition = fetchedCondition;}
        else
        [fetchedCondition setValue:@"NO" forKey:@"isSelectedCondition"];    
        [self.managedObjectContext save:nil];
        NSLog(@"Condition: %@, isSelectedCondition %@", fetchedCondition.name, fetchedCondition.isSelectedCondition);
    }

} 
```

# database - DB2 数据库 + 验证

> ID：15815778
> 
> 赞同：0
> 
> 时间：2013-04-04T15:43:22.507
> 
> 标签：database, search, grails, db2

所以我是数据库新手，我正在努力学习。我有一个我熟悉的 DB2 数据库。我被分配了一个任务，我需要编写一个在数据库上进行搜索的方法。搜索将采用两个参数，用户名和用户 ID 号。如果用户和用户 ID 号不匹配，或者如果其中一个或另一个结果为空，则需要抛出错误。如果它有效，那么它将继续吐出有关用户的信息。

有人告诉我使用 findall() 函数或类似的函数。我在网上看，我发现的是处理喜欢或喜欢的例子，我不确定这样的事情在我的情况下如何工作。我将如何开始做这件事的一个体面的例子是什么？

任何帮助表示赞赏。如果我取得任何进展，我会回复。

注意：我使用的是 groovy/grails。域，控制器，查看设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:58:57.797

这是学校的一些家庭作业吗？

findall() 通常是正则表达式中的一种方法，我认为在这里不相关。如果你有一个 SQL 数据库，这意味着你有一个使用 SQL 作为查询语言的 RDBMS。您需要了解 SELECT 命令，当您第一次查看手册时可能会令人望而生畏，但对于您的情况而言，它实际上很简单。你需要类似的东西：

```
SELECT userfield1, userfield2,..
FROM   myusertable
WHERE  myusertable.username = 'uname' AND myusertable.userid = userid 
```

uname 和 userid 是您的搜索参数。请注意，出于安全原因，此 SQL 查询应使用 PREPARED 语句完成。

当您使用您的数据库库运行此查询时，您将返回一组您必须分析的结果。如果为空，则未找到用户。

编辑：更新考虑到休眠的使用

Hibernate 使用 HQL，它类似于 SQL，并且确实有一个 findAll 方法。请参阅[http://grails.org/doc/latest/ref/Domain%20Classes/findAll.html](http://grails.org/doc/latest/ref/Domain%20Classes/findAll.html)

# design-patterns - 类之间的循环依赖

> ID：15815780
> 
> 赞同：3
> 
> 时间：2013-04-04T14:16:08.590
> 
> 标签：design-patterns, architecture, language-agnostic

我在两个类之间的依赖关系方面遇到了麻烦。问题如下：

我有两个类，时间戳和异常。异常是抽象的，所有可能的异常都派生自这个抽象类。每个异常都有一个时间戳来告诉异常何时被抛出。所以例外需要包括（在我使用的语言中称为导入）时间戳类。但是使用时间戳可能会发生错误，从而引发异常。因此时间戳类必须导入异常类。

还有我的循环依赖。现在我的实际问题是（这就是它独立于语言的原因）：在这种情况下，避免循环依赖的正确设计是什么？我无法解决这个问题，因为我想不出一个解决方案来让这些类像现在这样独立但没有循环依赖。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-04T14:51:13.160

我会放弃整个“Exception-has-timestamp-property”的想法。异常应该表示异常行为，仅此而已。也许你想做一些日志记录？记录器跟踪时间戳并将它们与适当的异常配对更有意义。

问问自己异常的工作是什么。显然，异常的工作是被抛出。这取决于它何时被抛出？没有。异常是否关心这个？没有。有别的在乎吗？是的，异常记录器。但是，由于记录器是关心时间戳的人，记录器也应该获取这些时间戳，并用它们做一些事情。毕竟，这是它工作的一部分。而且，在适当的设计中，记录器不会将他的部分工作外包给异常。

解决了循环依赖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T14:30:48.203

好问题，特别是你想避免循环依赖而不是让它工作。但考虑到循环依赖通常不是坏习惯。在你的情况下，我可以合理地使用这两个类。

因此，许多语言允许您定义类原型。我猜你正在使用 python，虽然在 C++ 中这看起来是这样的。

```
class Timestamp; 
```

您现在可以定义`Exception`类并将`Timestamp`对象用作成员。当然你不能使用它的方法，因为它们还没有定义。但是如果`Timestamp`构造函数将它的实例初始化为当前时间，您可能不需要访问`Exception`类中的成员。

```
class Exception
{
    // ...
    Timestamp timestamp;
}; 
```

稍后你定义整个`Timestamp`类。

```
class Timestamp
{
    Timestamp()
    {
        // initialize to current time
    }
}; 
```

但请注意，以这种方式耦合两个类会使它们非常依赖。如果没有另一个，您就不能使用其中之一。

因此，您可能想放弃使用`Timestamp`异常类来存储它们发生的时间的想法。我想在大多数操作系统上获取实际时间戳只需要你几行代码。因此，如果您不需要整个`Timestamp`课程，我建议复制代码以获取当前时间。这可能是最实用的方法，例如，如果您想在日志文件中写入异常及其时间。

# android - 如何使用 ViewPropertyAnimator 生成循环动画？

> ID：15815784
> 
> 赞同：10
> 
> 时间：2013-04-04T15:43:47.607
> 
> 标签：android, animation, android-animation

我想构建一个 TextViews 的动画，它会在完成后重复。

对于我想要动画的每个视图，我使用以下代码

```
final float oldX = v.getX();
final float newX = v.getX() - (float)totalWidth;
final AnimatorListenerAdapter listener = new AnimatorListenerAdapter() {
    @Override
    public void onAnimationEnd(Animator animation) {
        v.setX(oldX);
        animFinished = true;

        //This line won't compile
        //v.animate().setDuration(animDuration).setInterpolator(newsInterpolator)
        //    .setListener(listener).x(newX);
    }
};

v.animate().setDuration(animDuration).setInterpolator(newsInterpolator)
    .setListener(listener).x(newX); 
```

我试图将最后一段代码放入 onAnimationEnd，但 Java 不会编译，因为它认为对象侦听器未初始化。此外，我不认为这种“递归”动画调用是一个好的解决方案，这是我想到的第一件事。我怀疑有一种简单而可靠的方法来实现循环属性动画，但是我没有找到它，所以我转向这里寻求帮助。

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T17:13:45.943

好吧，我将再次回答自己。

TranslateAnimation 类有关于重复动画的方法，所以我用它代替了 ViewPropertyAnimator。

以下代码似乎有效：

```
 long duration = 1000* ((long)totalWidth / newsScrollSpeed);
            System.out.println("totalWidth="+totalWidth);
            TranslateAnimation  anim = new TranslateAnimation(0,-totalWidth,0,0);
            anim.setInterpolator(linearInterpolator);
            anim.setDuration(duration);
            anim.setRepeatCount(TranslateAnimation.INFINITE);
            anim.setRepeatMode(TranslateAnimation.RESTART);

            for(i=0;i<this.getChildCount();i++)
            {
                View v = this.getChildAt(i);

                if(v.getId() == R.id.yuruyen_yazi)
                {
                    continue;
                }

                v.startAnimation(anim);
            } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-07T19:56:52.337

不是优雅的方式，但它有效：

```
Runnable runnable = new Runnable() {
    @Override
    public void run() {
        // update newX
        v.animate().setDuration(animDuration).setInterpolator(newsInterpolator).x(newX).withEndAction(this).start(); 
    }
};

v.animate().setDuration(animDuration).setInterpolator(newsInterpolator).x(newX).withEndAction(runnable).start(); 
```

# zeromq - ZMQ 通过 epgm 为 PUB/SUB 提供哪些可靠性保证（如果有）？

> ID：15815786
> 
> 赞同：13
> 
> 时间：2013-04-04T15:43:51.433
> 
> 标签：zeromq

我有一个应用程序在 epgm PUB 套接字上向一个或多个 epgm SUB 套接字发送消息。事情大部分都有效，但如果订阅应用程序的时间足够长，它通常最终会丢失一条消息或几条消息。（我的消息有序列号，所以我可以判断是否有任何丢失或乱序。）根据我对 ZMQ 文档的阅读，我认为 epgm 的“可靠多播”性质会阻止这种情况发生，即在 SUB 套接字收到一条消息后，可以保证一直收到它们，直到关闭或出现重大网络故障（即连接被最大化）。

无论如何，这就是上下文，但问题只是标题：ZMQ 通过 epgm 为 PUB/SUB 提供哪些可靠性保证（如果有）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T20:25:02.480

ZeroMQ 中的 PGM 实现使用内存中的窗口进行恢复，因此只是短暂的。如果由于窗口耗尽而导致恢复失败：例如发布速度比恢复转换所需的速度快，则底层 PGM 套接字将重置并尽最大努力继续。

这意味着在高数据速率或大量数据包丢失时，传输将不断重置，您将丢弃无法恢复的消息：因此无法保证可靠传递。

PGM 配置的目标是实时广播，这样慢速接收器就不会停止发送器。该协议确实支持这两种范式，但由于缺乏需求，后者尚未实施。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-04T18:59:32.667

ZeroMQ 只做了一个保证：所有消息都是完整的——你永远不会收到部分消息。它不保证可靠性。您应该查看高水位线 (HWM) 行为的文档，这是导致消息丢失的最常见原因，如[suicidal snail](http://zguide.zeromq.org/page%3aall#Slow-Subscriber-Detection-Suicidal-Snail-Pattern)所示。

# ios - 多个表视图和多个集合视图的正确模式

> ID：15815788
> 
> 赞同：0
> 
> 时间：2013-04-04T15:43:55.383
> 
> 标签：ios, cocoa-touch, uitableview, design-patterns, uicollectionview

我需要实现具有 2 个不同视图的项目列表：文本列表和照片列表，类似于 iPad 上的 iBooks 所做的：

![iBooks 视图类型选择器](https://i.stack.imgur.com/0qUNk.png)

但是，我有 4 种不同类别的项目：电影、音乐、游戏和书籍，每一种都有不同的特征，需要显示不同的信息。用户将使用下拉菜单而不是选项卡栏更改类别，因为选项卡栏已在使用中（这将是应用程序的库部分）。

我的意图是为项目的文本列表使用表格视图，为照片列表使用集合视图。对于每个项目类别，表格视图和集合视图的数据源可能相同，因为集合视图只提供较少的信息。

我的问题是使用哪种模式。我本可以有：

*   A. 4 个表视图控制器 + 4 个集合视图控制器
*   B. 1个表视图控制器+1个集合视图控制器（分别管理1个表视图和1个集合视图，有4种表视图单元格，4种集合视图单元格）。
*   C. 1个表视图控制器+1个集合视图控制器（分别管理4个表视图和4个集合视图）
*   D. 4个视图控制器（每个管理1个表和1个集合视图，共享数据源）
*   E. 1 个视图控制器（管理所有内容、1 个表格视图和 1 个集合视图、4 个不同的表格视图单元格、4 个不同的集合视图单元格）。

我相信解决方案 A 和 D 在代码方面应该是最干净的，B 是最容易实现的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T20:20:47.803

我会使用 B 并尽量不要在添加新内容时过多地触摸它们。

对于集合视图，

*   外观可以使用 NIB 和`applyLayoutAttributes:`/或每种内容类型的自定义布局进行自定义（如果您想要不同的动画）。
*   动作可以这样实现：长按手势识别器，使用`locationInView:`and获取最后一个按下的视图`indexPathForItemAtPoint:`，弹出 a`UIMenuItem`并将动作应用于视图（一种方法）。

对于每种内容类型，我会将操作及其实现放在一个单独的类中。您可以使用命名约定“content-class-name + Actions”来查找此类，或使用控制器中的工厂模式来获取它。然后注入它需要的任何服务，并传递与启动该操作的视图相关的操作和模型类。这部分也适用于桌子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T11:43:47.307

我会推荐一种混合方法，使用 B 作为主控制器，但对每种单元使用控制器，并根据所选类别设置此控制器。

**更新**：在对主题进行更多重新思考之后，我将使用选项 D。每个类别的一个视图控制器充当表视图和集合视图的数据源和代表。

# c++ - 为什么我们将通过引用传递的值视为地址？

> ID：15815789
> 
> 赞同：3
> 
> 时间：2013-04-04T15:43:58.093
> 
> 标签：c++, syntax, constructor, pass-by-reference

我找到了这段代码：

```
foo::foo(const foo & arg) :
     impl_(new impl(*arg.impl_))
{}; 
```

据我了解，这个类的构造函数将类`foo`的另一个对象`foo`作为唯一的参数。我不清楚的是为什么我们`*`在前面使用`arg`. 据我所知，当我们通过引用传递参数时，我们应该将函数“主体”中的这个参数视为普通变量（而不是变量的地址，*即*我们不应该使用`*`）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T15:46:14.007

The `.` operator has higher precedence than the indirection (`*`) operator, so your code is parsed as

```
*(arg.impl_) 
```

`impl_` appears to be a pointer, because you initialize it with new. To invoke the copy constructor, you have to pass an object, not a pointer, so you need to dereference it beforehand.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T15:47:43.420

这是复制构造函数，它接受一个*const 引用*（不是“对象”）作为它的参数。

您还没有显示类定义，但是

```
*arg.impl_ 
```

并不意味着*取消引用`arg`，然后寻找一些名为 的成员`impl_`*，它看起来像以下之一：

```
(*arg).impl_
arg->impl_ 
```

相反，它意味着*取消引用指针`arg.impl_`*，即：

```
*(arg.impl_) 
```

这是为任何类型调用等效的复制构造函数`impl_`。

* * *

样本：

```
struct Impl {
    int i_;

    Impl() : i_(0) {}
    Impl(const Impl& other) : i_(other.i_) {}
};

struct Foo {
    Impl *impl_;

    // Foo::Foo calls Impl::Impl
    Foo() : impl_(new Impl()) {}

    // Foo::Foo(const Foo&) calls Impl::Impl(const Impl&)
    Foo(const Foo& other) : impl_(new Impl(*other.impl_)) {}
}; 
```

注意。这看起来像*pimpl*（或指向实现的指针）习语。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T15:46:40.297

Because `impl_` is a pointer to a `impl`, which takes a a reference as copy constructor parameter (as is usually the case).

# javascript - 持久性 JS - 循环

> ID：15815794
> 
> 赞同：1
> 
> 时间：2013-04-04T15:44:03.717
> 
> 标签：javascript, persistence

我正在尝试使用 for 循环为使用 persistenceJS 的数据库值之一填充数据库（[http://persistencejs.org](http://persistencejs.org)）

我遇到的问题是，当我执行 alert(i) 然后执行 persistenceJS 调用时，两个警报都会在运行 persistenceJS 之前显示。

下面的代码解释得更好

```
 for(var i = 0; i < 2; i++) {

        alert(i); //0 and 1 are alerted then the below runs

        Answer.all().count(function(co) {
            alert('current count is:' + co); //alerts 0
    });
    } 
```

上面是一些显示问题的测试代码，下面是我将实际使用的代码。

```
Answer = persistence.define('Answer', {
 level: "INT",
 image: "INT",
 correct: "INT",
 hints: "INT"
});

 persistence.store.websql.config(persistence,'FootballQuiz', 'Storage of answer status', 5 * 1024 * 1024);
 persistence.schemaSync();

for(var i = 0; i < 2; i++)
//checks to see if the current value exists in the db
Answer.all().filter('level', '=', 1)
            .and(new persistence.PropertyFilter('image', '=', i))
            .count(function(c){
                if(c > 0) {
                    alert('already exists');
                } else {
                    var tmpAnswer = new Answer();
                    tmpAnswer.level = "1";
                    tmpAnswer.image = i;
                    tmpAnswer.correct = "0";
                    persistence.add(tmpAnswer); 
                    persistence.flush();
                }
            });
} 
```

我希望persistenceJS 执行每个循环。谢谢

# java - 实现矩阵的最佳方式（地铁站/地铁线路）

> ID：15815803
> 
> 赞同：1
> 
> 时间：2013-04-04T15:44:40.280
> 
> 标签：java, matrix, implementation

我正在用 Java 开发一个小型 Web 应用程序，它给出了伦敦的地理位置，它可以找到最近的地铁站及其各自的线路。我正在尝试找到表示 MetroStation - MetroLines 关系的最佳方式。如您所知，一个地铁站可以是多条线路的一部分。我现在正在做的是我的数据库中有一个表，关系表示为矩阵。像这样的东西：

```
stationId | blueLine | blackLine | pinkLine | purpleLine | ... | greenLine
    25          0          1          1           0                  1 
```

其中 0 和 1 是布尔值，表示车站是该地铁线路的一部分（不可为空，默认为 0）。当然，这些数据不会经常更改（他们不会经常建立新的车站或线路），而且我认为每次我需要这些数据（很多）时都调用数据库有点矫枉过正。我知道一种解决方案可能是缓存它，但我一直在考虑存储这些数据的 Java 方法是否更适合我：也许是地铁对象的常量列表，某种静态类，其中包含所有地铁站数据，使用一个bean类并使用依赖注入注入它......

我想听听您的意见，您认为实现此功能的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:52:14.873

如果我真的必须将所有对象保存在内存中，我将为我需要的每种查询创建一个 Map：

一

```
HashMap<Line, List<Station>> 
```

和一个

```
HashMap <Station, List<Line>> 
```

例如。这样你的查询会相当快，因为​​地图存储了对象的指针，所以不会占用更多的空间。

最后，您可以创建一个充当“数据访问层”的单例类，提供一组固定的查询方法来获取您需要的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T15:37:42.520

我终于选择了类似于西蒙建议的东西。我有：

```
HashMap<MetroLine, List<MetroStation>> hmMetroLines;
EnumSet<MetroStation> esMetroStations; 
```

MetroStation 是一个枚举，其中包含其所属行的所有数据。像这样的东西：

```
public enum MetroStation{
METRO1(1, true, false, true, false, false, false, false, false, false, false, 
        false, false, false, false, false, false, "descirption1"),
METRO2(2, true, true, false, false, false, false, false, false, false, false,
        false, false, false, false, false, false, "description2"),...

private int id;
private boolean line1;
private boolean line2;
private boolean line3;
...
private boolean line14;
private String description; 
```

我使用 Simon 建议的 Singleton 类，只创建一次 HashMap 和 Set 。

# .net - 在 .NET Framework 中使用多个计时器

> ID：15815806
> 
> 赞同：2
> 
> 时间：2013-04-04T15:44:53.627
> 
> 标签：.net, winforms, visual-studio-2010

我有一个带有[System.Windows.Forms.Timer](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)的 MDI 表单，它会在一定时间后缓慢滴答作响以注销员工。

此外，还有其他可能使用或未使用的形式也使用计时器。一些计时器用于从[System.IO.Ports.SerialPort](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.aspx)读取，其他计时器用于处理文本，因为它要么是键入的，要么是在 SQL 2000 数据库中更改的记录。

现在，我将在新表单中添加另一个计时器，该表单也将使用串行端口。

PC 上只有一 (1) 个串行端口，因此我已经重新设计了应用程序，以便 MDI 父级包含串行端口对象，并且只将引用传递给需要它们的表单。

现在，我开始更多地考虑这些计时器。

我开始考虑重新设计我的 MDI Parent 以拥有一个通用的 Tick 事件，一切都可以使用委托来监听。

但后来我开始思考：我想知道 Visual Studio 是否已经这样做了？

因此，如果我将多个 Timer 控件添加到 Windows 窗体项目，Visual Studio（或 .NET Framework）是否只是将侦听器或其他东西插入到始终运行的更大的计时器中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T16:46:42.407

计时器不会“运行”，真的。计时器将操作系统触发器设置为在特定时间触发。

不，最好创建一个通用的 Tick 事件。如果您这样做了，那么计划每分钟发生一次的事情将获得每秒一次的滴答声，他们将不得不忽略这些滴答声。你最终会写出一堆复杂而脆弱的代码。

令人高兴的是，Windows 为您完成了这一切。底层计时器代码基本上完成了您正在谈论的工作。它有一个可以监听的通用滴答声，并根据需要将事件分派给您的计时器。如果你自己实现了这个，你最终会更有效地复制 Windows 已经做的事情。

# iphone - Landscape only UIViewController in UINavigationController

> ID：15815808
> 
> 赞同：0
> 
> 时间：2013-04-04T15:44:57.883
> 
> 标签：iphone, ios, uiviewcontroller, orientation, landscape

I have `UITableViewController` in which on one tab is `UINavigationViewController`. `UINavigationController` root view controller is UITableViewController, and when clicked on cell, `UIViewController` appears which has to be locked in `Landscape`.

I want every Controller to be locked in `Portrait`, except the mentioned `UIViewController` that must be locked in `Portrait`.

**I have tried the following:**

**CustomTabBarController.m:**

```
#import "CustomTabBarController.h"

@implementation CustomTabBarController

-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // You do not need this method if you are not supporting earlier iOS Versions
    return [self.selectedViewController shouldAutorotateToInterfaceOrientation:interfaceOrientation];
}

- (BOOL)shouldAutorotate{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations{
    return [self.selectedViewController supportedInterfaceOrientations];
}

@end 
```

**CustomNavigationController.h:**

```
#import "CustomNavigationController.h"

@implementation CustomNavigationController

-(NSUInteger)supportedInterfaceOrientations
{
    return [self.topViewController supportedInterfaceOrientations];
}

-(BOOL)shouldAutorotate
{
    return YES;
}

@end 
```

**And in UIViewController that must be locked in to Landscape, I have put:**

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return ((interfaceOrientation == UIInterfaceOrientationLandscapeLeft) || (interfaceOrientation == UIInterfaceOrientationLandscapeRight));
}

-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscape;
}

-(BOOL)shouldAutorotate
{
    return YES;
} 
```

But it doesn't work, I can rotate it to Landscape and it will stay locked in Landscape, but I want it to appear automatically in Landscape.

Any suggestions?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:49:05.937

过去我遇到了一个大问题，即`UITabBarController`不尊重我支持的显示视图控制器的界面方向。

I solved the problem by sub-classing `UITabBarController`and capturing whenever an item was selected. 然后我会自己调用视图控制器，询问它支持的方向是什么，并在需要时自己强制旋转。我还会在旋转时调用选定的视图控制器来设置/更改我支持的方向。

我实现了`UITabBarDelegate`and 用于`didSelectItem`捕获选项卡开关。我不确定现在是否有更好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-13T10:45:27.287

尝试使用该方法阻止特定窗口的某些方向：

```
– application:supportedInterfaceOrientationsForWindow: 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-24T05:24:07.923

尝试覆盖方法

`- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation`

# jquery - 将 jquery-ui DatePicker 添加到 SmartWizard

> ID：15815809
> 
> 赞同：0
> 
> 时间：2013-04-04T15:45:02.233
> 
> 标签：jquery, jquery-ui-datepicker, smart-wizard

我正在使用 IE8 和 SmartWizard 2.0 插件。SmartWizard 中的步骤之一包括一个日期选择器。但是单击输入标签时不会显示弹出窗口。

```
var step4 = '<table id="Step4EffectiveDate" style="margin : auto; padding-top : 50px; height : 50%">';
step4 += '<tr>';
step4 += '<td style="margin : auto"><div class="stepDatePickerDiv">Effective Date: <input type"text" id="datepicker"/></div></td>';
step4 += '</tr>';
step4 += '</table>';

$("#step4").append(step4);

$("#datepicker").datepicker({
    changeMonth: true,
    changeYear: true,
    dateFormat: 'yy-mm-dd'
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T06:28:52.250

我认为这是因为 datepicker 的 z-index 小于 SmartWizard 的 z-index。我将 datepicker 的 z-index 增加到 9999，它现在工作得很好！

```
$(".ui-datepicker").css("z-index", 9999); 
```

# c# - How to handle derived classes at UI without switch statements when using MVC/MCP?

> ID：15815810
> 
> 赞同：2
> 
> 时间：2013-04-04T15:45:07.107
> 
> 标签：c#, asp.net-mvc, switch-statement, derived-class

I'm using a MVC/MCP pattern for my C# (WinForms) application.

In the business logic I have derived classes like

```
abstract public class Item
{
    abstract double CalculatePrice();
    ...
}

public class Nail : Item
{
    ...
}

public class Car : Item
{
    ...
} 
```

For the business logic the derived type of an item doesn't matter. I always can call methods like CalculatePrice() no matter what type the item really is.

**But How do I handle such items at the UI (WinForms) when presenting these items to the user?** (and of course a *Car* is presented differently than a *Nail*)

*   I do not want to have a big switch statement in the UI / controller to handle all types of items.
*   I do not want to implement a

    abstract double ShowMeAtUI()

    method in the item class, because this is business logic and it should not care about UI stuff.

So what is the cleanest preferred way to design this.

Thanks in advance!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:06:26.933

在我看来，您需要视图的[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)，对吗？

我使用 MVP 解决此问题的一种方法是创建`UserControl`子视图。即使是子视图，我也会使用演示者。如果您可以将主视图模块化为 UserControl 组件，或者如果这样做有意义，那么这可能是一种选择。

您可以实现一个字典来知道将哪个子视图添加到父控件的容器中。

或者，我记得，我确实使用了一个字典，它的值是一个委托来显示给定父控件的特定子视图。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-04-04T18:14:23.247

我不明白你为什么需要抽象方法 ComputePrice。商品的价格大概在数据中。如果是这种情况，那么您只需要基类 Item 中的属性 Price 来获取任何 Item 实例的价格。

对于其他常见字段（例如名称、描述、销售量等）也是如此。然后，与 Price 属性类似，您将向 Item 基类添加一个属性（Name、Description、SalesVolume）。

也许某件商品的价格在数据中没有明确显示，必须进行计算。如果是这样的话，我仍然不明白为什么这个计算不能在基类中。例如，必须根据客户对标价进行折扣。在这种情况下，Item 类应用折扣规则和进行购买的客户。

也许您可以解释为什么 ComputePrice 必须是一个抽象和/或提供其他抽象示例，这些示例需要在每个派生类（Nail、Car）中进行特定的实现。

# iphone - How to prevent the CoreBluetooth library from prompting to turn-on an iOS device's bluetooth?

> ID：15815811
> 
> 赞同：1
> 
> 时间：2013-04-04T15:45:10.407
> 
> 标签：iphone, ios, core-bluetooth, bluetooth-lowenergy

I would like to detect whether an iOS device has Bluetooth enabled so that I can prevent the CoreBluetooth library from prompting the app user to enable it. I am NOT looking to check the state of the CBCentralManager; I just want to prevent the blue popup box so that it doesn't annoy my users.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:01:04.843

如果没有对话框，您将无法在应用程序中使用 CoreBluetooth。所以，如果你想一起阻止它，你不能。

如果您只是想阻止他们是否关闭了蓝牙，那么首先检查 CBCentralManager 的状态是正确的方法（即检查它是否 == CBCentralManagerStatePoweredOff）。

# jquery - jquery-select2 how to edit the selected value

> ID：15815817
> 
> 赞同：0
> 
> 时间：2013-04-04T15:45:29.540
> 
> 标签：jquery, jquery-select2

i'm using the [jquery-select2](http://ivaynberg.github.io/select2/) plugin on select list :

```
$("#product").select2({
    minimumInputLength: 2
}); 
```

i have a list of products in my select :

*   screen 19"
*   screen 17"
*   screen 15"
*   screen 13"

suppose i select 'screen 17"' instead of 'screen 15"' and i want to change it to screen 15" so i've to reopen the list and retype all the keyword screen..., my question : is there any way to edit the selected value directly so i can replace (in this case 17 by 15) instead of retype all the keyword to get the wanted value.

# deployment - Not working Class-Path reference

> ID：15815820
> 
> 赞同：0
> 
> 时间：2013-04-04T15:45:40.850
> 
> 标签：deployment, jboss, weblogic

I have this error when deploy war with wlfullclient.jar on the jboss:

```
erver:server-one] 17:27:12,937 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-4) JBAS015960: Class Path entry lib\jcom.jar in /C:/Users/admin/Desktop/JBoss/EAP/content/ek-web-0.1-SNAPSHOT.war/WEB-INF/lib/wlfull3client-10.3.3.jar  does not point to a valid jar for a Class-Path reference.
erver:server-one] 17:27:12,957 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-4) JBAS015960: Class Path entry lib\weblogic-L10N.jar in /C:/Users/admin/Desktop/JBoss/EAP/content/ek-web-0.1-SNAPSHOT.war/WEB-INF/lib/wlfull3client-10.3.3.jar  does not point to a valid jar for a Class-Path reference.
erver:server-one] 17:27:13,747 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) JBAS015893: Encountered invalid class name 'com.sun.faces.vendor.Tomcat6InjectionProvider:org.apache.catalina.util.DefaultAnnotationProcessor' for service type 'com.sun.faces.spi.injectionprovider'
erver:server-one] 17:27:13,748 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) JBAS015893: Encountered invalid class name 'com.sun.faces.vendor.Jetty6InjectionProvider:org.mortbay.jetty.plus.annotation.InjectionCollection' for service type 'com.sun.faces.spi.injectionprovider'
erver:server-one] 17:27:13,749 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) JBAS015893: Encountered invalid class name 'org.xmlpull.mxp1.MXParser,org.xmlpull.mxp1_serializer.MXSerializer' for service type 'org.xmlpull.v1.XmlPullParserFactory'
erver:server-one] 17:27:16,584 WARN  [org.jboss.modules] (MSC service thread 1-3) Failed to define class weblogic.wsee.jaxws.client.async.AsyncTransportProvider in Module "deployment.ek-web-0.1-SNAPSHOT.war:main" from Service Module Loader: java.lang.LinkageError: Failed to link weblogic/wsee/jaxws/client/async/AsyncTransportProvider (Module "deployment.ek-web-0.1-SNAPSHOT.war:main" from Service Module Loader)
erver:server-one]     at org.jboss.modules.ModuleClassLoader.defineClass(ModuleClassLoader.java:396)
erver:server-one]     at org.jboss.modules.ModuleClassLoader.loadClassLocal(ModuleClassLoader.java:243)
erver:server-one]     at org.jboss.modules.ModuleClassLoader$1.loadClassLocal(ModuleClassLoader.java:73)
erver:server-one]     at org.jboss.modules.Module.loadModuleClass(Module.java:527)
erver:server-one]     at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:182)
erver:server-one]     at org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)
erver:server-one]     at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)
erver:server-one]     at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:423)
erver:server-one]     at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)
erver:server-one]     at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)
erver:server-one]     at java.lang.Class.forName0(Native Method) [rt.jar:1.6.0_26]
erver:server-one]     at java.lang.Class.forName(Unknown Source) [rt.jar:1.6.0_26]
erver:server-one]     at org.jboss.as.server.deployment.reflect.DeploymentClassIndex.classIndex(DeploymentClassIndex.java:54)
erver:server-one]     at org.jboss.as.ee.component.deployers.EEModuleConfigurationProcessor.deploy(EEModuleConfigurationProcessor.java:81) [jboss-as-ee-7.1.2.Final-redhat-1.jar:7.1.2.Final-redhat-1]
erver:server-one]     at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:116) 
```

My MANIFEST.FM in the wlfullclient.jar:

```
Manifest-Version: 1.0
Implementation-Vendor: Oracle Corp.
Implementation-Title: JDK 1.6 Client jar for WebLogic Server 10.3  Fri
  Apr 9 00:05:28 PDT 2010 1321401 
Implementation-Version: 10.3.3.0
Class-Path: lib\weblogic-container-binding.jar lib\weblogic-doma
 in-binding.jar lib\diagnostics-binding.jar lib\diagnostics-imag
 e-binding.jar lib\kodo-conf-binding.jar lib\wlcipher.jar lib\x
 mlx.jar lib\ojdbc6.jar lib\EccpressoAsn1.jar lib\EccpressoCore
 .jar lib\EccpressoJcae.jar lib\mysql-connector-java-commercial-
 5.0.3-bin.jar  lib\wlbase.jar lib\wlutil.jar lib\wlsqlser lib
 \ver.jar lib\wldb2.jar lib\wlsybase.jar lib\wlinf lib\ormix.j
 ar lib\wlw-langx.jar lib\pdev.jar lib\jcom.jar lib\web
 logic-L10N.jar 
```

Anyone know what path should be in this file? (I`ve jars in the lib direcotry in the jar).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T21:16:22.960

weblogic/wsee/jaxws/client/async/AsyncTransportProvider 在 weblogic.jar 中，我看不到你包括那个

# php - 使用布局模板的 Flash 消息重定向回来

> ID：15815821
> 
> 赞同：4
> 
> 时间：2013-04-04T15:45:43.473
> 
> 标签：php, redirect, laravel, laravel-4, flash-message

在我的控制器中，我有一个登录用户的功能。

如果登录成功，我可以简单地使用`return Redirect::back()`.

当凭据不正确并且我想使用 Flash 消息重定向时，我的问题就开始了。

我知道我可以将`with`方法链接到重定向，但这会将数据发送到特定视图，而不是发送到登录 HTML 所在的布局。

我可以像这样加载视图：

```
$this->layout
     ->with('flash',$message)
     ->content = View::make('index'); 
```

但我需要重定向回引用页面。

将数据传递到布局时是否可以重定向？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T15:59:57.197

Laravel Validator 类可以很好地处理这个问题......我通常这样做的方式是在刀片的布局/视图中添加一个条件......

```
{{ $errors->has('email') ? 'Invalid Email Address' : 'Condition is false. Can be left blank' }} 
```

如果有任何返回错误，这将显示一条消息。然后在您的验证过程中，您有...

```
 $rules = array(check credentials and login here...);

$validation = Validator::make(Input::all(), $rules);

if ($validation->fails())
{
    return Redirect::to('login')->with_errors($validation);
} 
```

这样...当您进入登录页面时，无论提交如何，它都会检查错误，如果发现任何错误，它会显示您的消息。

**编辑部分** 用于处理 Auth 类.. 这在您看来...

```
@if (Session::has('login_errors'))
    <span class="error">Username or password incorrect.</span>
@endif 
```

然后在你的身份验证中......沿着这些路线......

```
 $userdata = array(
    'username'      => Input::get('username'),
    'password'      => Input::get('password')
);
if ( Auth::attempt($userdata) )
{
    // we are now logged in, go to home
    return Redirect::to('home');
}
else
{
    // auth failure! lets go back to the login
    return Redirect::to('login')
        ->with('login_errors', true);

} 
```

# python - 使用 xmmp python 库和谷歌应用引擎发送 xmpp 消息

> ID：15815834
> 
> 赞同：1
> 
> 时间：2013-04-04T15:46:06.913
> 
> 标签：python, google-app-engine, xmpp

我正在尝试使用 xmpp 和谷歌应用引擎发送消息。我正在为 python 使用 xmpp 库。我的代码如下：

```
import webapp2
import xmpp

_SERVER = 'serverdomain'

class MainPage(webapp2.RequestHandler):
    def post(self):

        msg = 'hello'

        global username 
        username = 'user'
        global passwd
        passwd = 'ssdsd'

        global xmppClient
        global to
        to='toAddress' 

        jid = xmpp.protocol.JID(username)
        xmppClient = xmpp.Client(jid.getDomain(),debug=[])
        xmppClient.connect(server=_SERVER)
        xmppClient.auth(username, passwd, 'botty')
        xmppClient.sendInitPresence()
        self.response.out.write('me conecte '+xmppClient.isConnected())
        xmppClient.send(xmppClient.Message(to, msg, type='chat'))

app = webapp2.WSGIApplication([ ('/', MainPage)], debug=True) 
```

当我执行我的测试时，我收到以下错误

> ImportError：没有名为 xmpp 的模块

一遍又一遍地。我将 .egg xmpp 库放入 pythonpath 并且 Eclipse 识别了它，因此我可以使用 CTRL+TAB 自动完成。这表明编辑器识别库但没有服务器（GAE）所​​以也许我需要将库添加到服务器并编译它。这是一个好主意吗？任何其他服务器建议？我需要帮助。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-16T04:28:08.237

在Debian中，遇到了同样的问题。就我而言，我解决了安装*python-xmpp*包的问题： apt-get install python-xmpp

希望对你有帮助

有关软件包的详细信息，请参见此处： [https ://packages.debian.org/sid/python/python-xmpp](https://packages.debian.org/sid/python/python-xmpp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T23:15:12.133

看起来您的导入路径不完整。尝试：

```
from google.appengine.api import xmpp 
```

代替

```
import xmpp 
```

更多细节[在这里](https://developers.google.com/appengine/docs/python/xmpp/overview)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:50:56.603

查看有关为 GAE 设置第三方库的其他问题。请注意，如果 xmpp 库不是纯 python（即使用本机代码），您将无法使用它。

[https://stackoverflow.com/search?q=google-app-engine+python+third+party+libraries](https://stackoverflow.com/search?q=google-app-engine+python+third+party+libraries)

# java - 删除重复代码的模式

> ID：15815835
> 
> 赞同：3
> 
> 时间：2013-04-04T15:46:07.843
> 
> 标签：java, oop, design-patterns, code-duplication

我一直在从事的一个 Java 项目与多个 RDBMS 集成。我们减少处理它们的方式之间的代码重复的最明显方法是创建一个类型层次结构，例如：

```
 ThirdPartySoftware (superclass)
                      /|\
                     / | \
                 TPS1  2  3 
```

然而，这种方法最终导致 TPS1、TPS2 和 TPS3 的实现非常相似（但不完全如此！）。如果超类本质上没有意识到可能有所不同的每个地方，就很难将所有功能拉入超类，击败封装子类意味着要收买我们。

我们考虑过的一种方法是用它们共享的特性来表示数据库，例如“支持特性 X”和“不能做特性 Y”，但是并不完全清楚代码最终会以这种方式更易于维护，因为：

1.  许多怪癖只适用于一个数据库。
2.  我们想不出足够多的共享/可比较（基本上是抽象的）特性来使这变得有价值。

有没有人对我们可以减少子类之间的代码重复的方法有其他建议，也许使用设计模式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T16:00:47.360

[http://en.wikipedia.org/wiki/Bridge_pattern](http://en.wikipedia.org/wiki/Bridge_pattern)

只适合您的情况，但无论如何，找出 API 是什么是您的工作。

也许，org.hibernate.dialect.Dialect 会给你一些新的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:30:02.227

我不是 java 人，但除了超类/抽象类之外，您还可以使用接口和[依赖注入](http://www.vogella.com/articles/DependencyInjection/article.html)以及[存储库模式](http://msdn.microsoft.com/en-us/library/ff649690.aspx)。这些模式不是唯一的，我经常有接口实现是主类的子类，例如

SqlDataAccess：BaseDataAccess、IDataAccess 和 TPSDataAccess：SqlDataAccess、ITPSDataAccess

# dynamics-crm-2011 - 如何从 DB CRm 2011 中提取插件 dll

> ID：15815839
> 
> 赞同：3
> 
> 时间：2013-04-04T15:46:23.030
> 
> 标签：dynamics-crm-2011, dynamics-crm

我需要提取在数据库中注册的 Crm 2011 插件 DLL。有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-21T11:35:47.067

对于 CRM 2011，有一种更简单的方法可以实现这一目标。

*   创建一个新的解决方案
*   将插件程序集添加到解决方案
*   导出为非托管解决方案（硬盘驱动器上的 Zip 文件）
*   解压缩 Zip 文件的内容

您可以在这样的文件夹中找到 DLL：

```
[Unzip Folder]\PluginAssemblies\[DLLName-00000000-0000-0000-0000-000000000000]\ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-27T08:18:44.120

[创建插件提取工具是为了帮助 Dynamics CRM 管理部门提取以前在 CRM 数据库中注册为插件的程序集。](https://onedrive.live.com/redir?resid=ce989f76cdcfaebe%21421)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T17:17:26.733

基本上，该插件存储为您可以提取的 Base64-String。参见例如[http://mytechlifedays.wordpress.com/2011/12/08/retrieving-the-plugin-dlls-from-ms-crm-dynamics-database/](http://mytechlifedays.wordpress.com/2011/12/08/retrieving-the-plugin-dlls-from-ms-crm-dynamics-database/)

# linux - 是否可以在linux中显示排序的进度？

> ID：15815840
> 
> 赞同：9
> 
> 时间：2013-04-04T15:46:28.490
> 
> 标签：linux, bash, sorting

我的工作涉及从非常大的文件中对大量字段进行排序。我通常使用`sort`bash 中的命令来执行此操作。不幸的是，当我开始排序时，我永远无法确定需要多长时间。我应该等待结果出现，还是应该在它运行时开始处理其他事情？

有没有可能的方法来了解排序的进展情况或工作速度有多快？

```
$ cut -d , -f 3 VERY_BIG_FILE | sort -du > output 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-04T15:59:05.247

不，GNU`sort`不做进度报告。

但是，如果您`sort`只是使用删除重复项，并且您实际上并不关心排序，那么有一种[更具可扩展性的方式](http://www.catonmat.net/blog/wp-content/uploads/2008/09/awk1line.txt)来做到这一点：

```
awk '! a[$0]++' 
```

这会在看到一行后立即写出第一次出现的行，这可以让您了解进度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-05T07:42:12.150

您可能想尝试[pv](http://www.ivarch.com/programs/pv.shtml)，它应该可以让您很好地了解管道中在吞吐量方面发生的情况。

`pv`示例（未经测试）在命令前后注入`sort`以了解吞吐量：

```
$ cut -d , -f 3 VERY_BIG_FILE | pv -cN cut | sort -du | pv -cN sort > output 
```

**编辑**：我错过了排序命令中的 -u ，因此首先计算行才能获得百分比输出是无效的。从我的答案中删除了那部分。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2013-04-04T16:18:12.540

你可以在后台执行你的“排序”，你会得到提示，你可以做其他工作

$sort ...... & # (& 表示在后台运行)

# apache - 使用 HLS 并将内容推送到 Apache

> ID：15815842
> 
> 赞同：0
> 
> 时间：2013-04-04T15:46:39.227
> 
> 标签：apache, http, streaming, push, live

我的客户有一个 envivio 编码器。今天，他们将实时 HLS 流推送到 Akamai。现在他们想尝试将流推送给我们。我需要什么样的网络服务器，如何配置服务器以将推送流保存到 webb-storage。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-12T08:29:07.600

我相信您的编码器（以及许多其他编码器）正在使用 HTTP PUT 来发布视频。Apache Web 服务器可以轻松做到这一点。如果您需要帮助在 Apache 中启用 HTTP PUT 功能 - 请尝试 [如何在 Apache2 和 PHP 中启用和使用 HTTP PUT 和 DELETE？](https://stackoverflow.com/questions/2934554/how-to-enable-and-use-http-put-and-delete-with-apache2-and-php)

# java - OpenCV：应用adaptiveThreshold函数后最大值为-1

> ID：15815846
> 
> 赞同：1
> 
> 时间：2013-04-04T15:46:46.700
> 
> 标签：java, android, opencv, image-processing

我正在尝试使用 AdaptiveThreshold 方法对 RGB 图像进行二值化。我的代码如下：

```
public byte[] filter(byte[] buff, int width, int height) {

    Mat img_rgb = new Mat(width, height, CvType.CV_8UC3);
    Mat img_gray = new Mat(width, height, CvType.CV_8U);
    Mat img_bin = new Mat(width, height, CvType.CV_8U);     

    img_rgb.put(0, 0, buff);        
    Imgproc.cvtColor(img_rgb, img_gray, Imgproc.COLOR_RGB2GRAY);                
    Imgproc.adaptiveThreshold(img_gray, img_bin, 255, 
               Imgproc.ADAPTIVE_THRESH_GAUSSIAN_C, Imgproc.THRESH_BINARY, 5, 2);

    int size = (int) img_bin.total() * img_bin.channels();
    byte[] bin_buff = new byte[size];
    img_bin.get(0, 0, bin_buff);

    return bin_buff;

} 
```

应用adaptiveThreshold后数据的最大值`img_bin`应该是255，但它是-1。为什么会这样？我是 OpenCV 的新手，我找不到任何解释。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:47:57.653

有符号字节中 -1 的二进制补码表示等于无符号字节中 255 的补码表示。这可能是您的代码中某处缺少强制转换。

# java - 使用 FileDownloader 时懒惰地确定文件名

> ID：15815848
> 
> 赞同：2
> 
> 时间：2013-04-04T15:46:48.953
> 
> 标签：java, download, vaadin

在vaadin 7中，如何在使用时懒惰地确定文件名`FileDownloader`？

```
final Button downloadButton = new Button("Download file");
FileDownloader downloader = new FileDownloader(new StreamResource(new StreamSource() {
    @Override
    public InputStream getStream () {
        return new ByteArrayInputStream(expesiveCalculationOfContent());
    }
}, "file.snub"));

downloader.extend(downloadButton); 
```

在此代码示例中，文件名很明显

1.  是垃圾
2.  必须早日知道。

如何懒惰地确定下载文件的文件名？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-04T21:40:11.833

我不知道它是否脏，但这有效：扩展 FileDownloader.handleConnectorRequest() 以在调用其超级方法之前调用 StreamResource.setFilename()。

```
 {
        final Button downloadButton = new Button("Download file");
        final StreamResource stream = new StreamResource(
                new StreamSource() {
                    @Override
                    public InputStream getStream() {
                        return new ByteArrayInputStream("Hola".getBytes());
                    }
                }, "badname.txt");
        FileDownloader downloader = new FileDownloader(stream) {
            @Override
            public boolean handleConnectorRequest(VaadinRequest request,
                    VaadinResponse response, String path)
                    throws IOException {
                stream.setFilename("better-name.txt");
                return super
                        .handleConnectorRequest(request, response, path);
            }
        };

        downloader.extend(downloadButton);
        layout.addComponent(downloadButton);
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T09:30:44.793

这是我想出的最终解决方案：

```
/**
 * This specializes {@link FileDownloader} in a way, such that both the file name and content can be determined
 * on-demand, i.e. when the user has clicked the component.
 */
public class OnDemandFileDownloader extends FileDownloader {

  /**
   * Provide both the {@link StreamSource} and the filename in an on-demand way.
   */
  public interface OnDemandStreamResource extends StreamSource {
    String getFilename ();
  }

  private static final long serialVersionUID = 1L;
  private final OnDemandStreamResource onDemandStreamResource;

  public OnDemandFileDownloader (OnDemandStreamResource onDemandStreamResource) {
    super(new StreamResource(onDemandStreamResource, ""));
    this.onDemandStreamResource = checkNotNull(onDemandStreamResource,
      "The given on-demand stream resource may never be null!");
  }

  @Override
  public boolean handleConnectorRequest (VaadinRequest request, VaadinResponse response, String path)
      throws IOException {
    getResource().setFilename(onDemandStreamResource.getFilename());
    return super.handleConnectorRequest(request, response, path);
  }

  private StreamResource getResource () {
    return (StreamResource) this.getResource("dl");
  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-25T05:08:42.493

如果假设延迟确定文件名意味着动态设置文件名而不管实际的文件系统名称可能是什么，那么下面的代码就是我正在使用的。

在下面的代码中，fileName 指向我们希望在下载时更改名称的本地文件系统文件。一个用例是当一个文件上传到 tmp 时，文件名包含一些原始上传中不存在的随机字符。

```
File file = new File(localFile);
final FileResource fileResource = new FileResource(file);
if (!file.exists()) {
   throw new IllegalStateException();
}
final StreamResource stream = new StreamResource(
                            new StreamSource() {
                                @Override
                                public InputStream getStream() {
                                    return fileResource.getStream().getStream();
                                }
                            }, "newname.txt");

FileDownloader fileDownloader = new FileDownloader(stream);
fileDownloader.extend(downloadButton); 
```

# python - 如何将列添加到numpy数组

> ID：15815854
> 
> 赞同：53
> 
> 时间：2013-04-04T15:47:10.080
> 
> 标签：python, numpy

我正在尝试将一列添加到从创建的数组中`recfromcsv`。在这种情况下，它是一个数组：（`[210,8]`行，列）。

我想添加第九列。空或带零无关紧要。

```
from numpy import genfromtxt
from numpy import recfromcsv
import numpy as np
import time

if __name__ == '__main__':
 print("testing")
 my_data = recfromcsv('LIAB.ST.csv', delimiter='\t')
 array_size = my_data.size
 #my_data = np.append(my_data[:array_size],my_data[9:],0)

 new_col = np.sum(x,1).reshape((x.shape[0],1))
 np.append(x,new_col,1) 
```

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2013-04-04T16:37:57.883

我认为您的问题是您希望`np.append`就地添加列，但是由于 numpy 数据的存储方式，它的作用是创建连接数组的副本

```
Returns
-------
append : ndarray
    A copy of `arr` with `values` appended to `axis`.  Note that `append`
    does not occur in-place: a new array is allocated and filled.  If
    `axis` is None, `out` is a flattened array. 
```

所以你需要保存输出`all_data = np.append(...)`：

```
my_data = np.random.random((210,8)) #recfromcsv('LIAB.ST.csv', delimiter='\t')
new_col = my_data.sum(1)[...,None] # None keeps (n, 1) shape
new_col.shape
#(210,1)
all_data = np.append(my_data, new_col, 1)
all_data.shape
#(210,9) 
```

替代方式：

```
all_data = np.hstack((my_data, new_col))
#or
all_data = np.concatenate((my_data, new_col), 1) 
```

我相信这三个函数（以及`np.vstack`）之间的唯一区别是它们在未指定时的默认行为`axis`：

*   `concatenate`假设`axis = 0`
*   `hstack`假设`axis = 1`除非输入是 1d，那么`axis = 0`
*   `vstack``axis = 0`如果输入为 1d，则在添加轴后假设
*   `append`展平阵列

* * *

根据您的评论，并更仔细地查看您的示例代码，我现在相信您可能想要做的是向[*记录数组*](http://www.scipy.org/Cookbook/Recarray)*添加一个字段*。您导入了返回[*结构化数组*](http://docs.scipy.org/doc/numpy/user/basics.rec.html)和返回略有不同的[*记录数组*](http://www.scipy.org/Cookbook/Recarray)[(](http://www.scipy.org/Cookbook/Recarray) [)](http://www.scipy.org/Cookbook/Recarray)的两者。您现在使用的 so实际上是 a ，这意味着很可能因为 recarrays 是一维记录数组，其中每条记录都是具有给定 dtype 的元组。[](http://www.scipy.org/Cookbook/Recarray)*`genfromtxt`[](http://docs.scipy.org/doc/numpy/user/basics.rec.html)*`recfromcsv`[*`recarray`*](http://www.scipy.org/Cookbook/Recarray)*`recfromcsv``my_data``recarray``my_data.shape = (210,)`***

 ***所以你可以试试这个：

```
import numpy as np
from numpy.lib.recfunctions import append_fields
x = np.random.random(10)
y = np.random.random(10)
z = np.random.random(10)
data = np.array( list(zip(x,y,z)), dtype=[('x',float),('y',float),('z',float)])
data = np.recarray(data.shape, data.dtype, buf=data)
data.shape
#(10,)
tot = data['x'] + data['y'] + data['z'] # sum(axis=1) won't work on recarray
tot.shape
#(10,)
all_data = append_fields(data, 'total', tot, usemask=False)
all_data
#array([(0.4374783740738456 , 0.04307289878861764, 0.021176067323686598, 0.5017273401861498),
#       (0.07622262416466963, 0.3962146058689695 , 0.27912715826653534 , 0.7515643883001745),
#       (0.30878532523061153, 0.8553768789387086 , 0.9577415585116588  , 2.121903762680979 ),
#       (0.5288343561208022 , 0.17048864443625933, 0.07915689716226904 , 0.7784798977193306),
#       (0.8804269791375121 , 0.45517504750917714, 0.1601389248542675  , 1.4957409515009568),
#       (0.9556552723429782 , 0.8884504475901043 , 0.6412854758843308  , 2.4853911958174133),
#       (0.0227638618687922 , 0.9295332854783015 , 0.3234597575660103  , 1.275756904913104 ),
#       (0.684075052174589  , 0.6654774682866273 , 0.5246593820025259  , 1.8742119024637423),
#       (0.9841793718333871 , 0.5813955915551511 , 0.39577520705133684 , 1.961350170439875 ),
#       (0.9889343795296571 , 0.22830104497714432, 0.20011292764078448 , 1.4173483521475858)], 
#      dtype=[('x', '<f8'), ('y', '<f8'), ('z', '<f8'), ('total', '<f8')])
all_data.shape
#(10,)
all_data.dtype.names
#('x', 'y', 'z', 'total') 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-04T15:58:50.947

如果您有一个数组，`a`例如 210 行乘 8 列：

```
a = numpy.empty([210,8]) 
```

并且想要添加第九列零，您可以这样做：

```
b = numpy.append(a,numpy.zeros([len(a),1]),1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-17T18:30:41.197

最简单的解决方案是使用**numpy.insert()**。

`np.insert()`over的优点`np.append`是您可以将新列插入自定义索引。

```
import numpy as np

X = np.arange(20).reshape(10,2)

X = np.insert(X, [0,2], np.random.rand(X.shape[0]*2).reshape(-1,2)*10, axis=1)
''' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-01T10:49:26.103

我以这种方式向矩阵数组添加一个新列：

```
Z = append([[1 for _ in range(0,len(Z))]], Z.T,0).T 
```

也许效率不高？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-14T07:49:31.970

可以这样做：

```
import numpy as np

# create a random matrix:
A = np.random.normal(size=(5,2))

# add a column of zeros to it:
print(np.hstack((A,np.zeros((A.shape[0],1))))) 
```

一般来说，如果 A 是一个 m*n 矩阵，并且需要添加一列，则必须创建一个 n*1 零矩阵，然后使用“hstack”将零矩阵添加到矩阵 A 的右侧.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-25T20:41:46.450

[`np.append`](https://numpy.org/doc/stable/reference/generated/numpy.append.html)或[`np.hstack`](https://numpy.org/doc/stable/reference/generated/numpy.hstack.html)期望附加的列是正确的形状，即 N x 1。我们可以使用`np.zeros`创建这个 zeros 列（或`np.ones`创建一个列）并将其附加到我们的原始矩阵（2D 数组）。

```
def append_zeros(x):
    zeros = np.zeros((len(x), 1))  # zeros column as 2D array
    return np.hstack((x, zeros))   # append column 
```***

# java - Cannot be resolved to a variable?

> ID：15815855
> 
> 赞同：-5
> 
> 时间：2013-04-04T15:47:13.917
> 
> 标签：java, variables

I'm trying to write a program that creates random spell effects, but 'length' cannot be resolved to a variable...

```
package Chaos;

import java.util.Random;

public class Effects {
    public static void main(String[] args) {

        String[] objects = { "Effect1", "Effect2", "Effect3", "Effect4" };

        int effect = objects.length;

        for (int i = 0; 1 < length; i++) {
            int rand = (int) (Math.random() * length);
            System.out.print(objects[rand]);
            System.out.print(" ");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T15:48:59.707

您将变量声明为`effect`，而不是`length`：

```
int effect = objects.length;

for (int i = 0; 1 < length; i++) // <-- You are using the wrong variable name here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:59:33.360

在您的代码中进行以下更改：

```
 int effect = objects.length;

    for (int i = 0; i < effect ; i++) { 
```

或者

```
String[] objects = { "Effect1", "Effect2", "Effect3", "Effect4" };

    for (int i = 0; i < objects.length; i++) { 
```

# php - PHP - mongodb client - skip and limit usage

> ID：15815856
> 
> 赞同：1
> 
> 时间：2013-04-04T15:47:16.427
> 
> 标签：php, mongodb, profiling

May be this is a silly question, but anyway I have the doubt.

Please take a look at this query:

```
db.posts.find({ "blog": "myblog", 
                "post_author_id": 649, 
                "shares.total": { "$gt": 0 } })
        .limit(10)
        .skip(1750)
        .sort({ "shares.total": -1, "tstamp_published": -1 }); 
```

actually I see into the mongodb profiler this report:

```
mongos> db.system.profile.find({ nreturned : { $gt : 1000 } }).limit(10).sort( { millis : 1 } ).pretty();
{
    "ts" : ISODate("2013-04-04T13:28:08.906Z"),
    "op" : "query",
    "ns" : "mydb.posts",
    "query" : {
        "$query" : {
            "blog" : "myblog",
            "post_author_id" : 649,
            "shares.total" : {
                "$gt" : 0
            }
        },
        "$orderby" : {
            "shares.total" : -1,
            "tstamp_published" : -1
        }
    },
    "ntoreturn" : 1760,
    "nscanned" : 12242,
    "scanAndOrder" : true,
    "nreturned" : 1760,
    "responseLength" : 7030522,
    "millis" : 126,
    "client" : "10.0.232.69",
    "user" : ""
} 
```

Now the question is: why mongodb is returning 1760 documents when I have explicitly asked to skip 1750?

This is my current Mongodb version, in cluster/sharding.

```
mongos> db.runCommand("buildInfo")
{
    "version" : "2.0.2",
    "gitVersion" : "514b122d308928517f5841888ceaa4246a7f18e3",
    "sysInfo" : "Linux bs-linux64.10gen.cc 2.6.21.7-2.ec2.v1.2.fc8xen #1 SMP Fri Nov 20 17:48:28 EST 2009 x86_64 BOOST_LIB_VERSION=1_41",
    "versionArray" : [
        2,
        0,
        2,
        0
    ],
    "bits" : 64,
    "debug" : false,
    "maxBsonObjectSize" : 16777216,
    "ok" : 1
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:41:43.823

> 现在的问题是：当我明确要求跳过 1750 时，为什么 mongodb 会返回 1760 文档？

因为服务器端正`skip()`是这样做的：它迭代前 1750 个结果，然后再获得 10 个（根据限制）。

正如@devesh 所说，这就是为什么应该避免非常大的分页，因为 MongoDB 没有有效地使用`skip()`or的索引`limit()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:37:25.943

我认为您已经中了靶心，我认为这就是为什么 mongoDB 文档要求我们避免大量跳过[http://docs.mongodb.org/manual/reference/method/cursor.skip/](http://docs.mongodb.org/manual/reference/method/cursor.skip/)的原因。请看这里它会回答你的结果。使用将与 $gt 运算符一起使用的其他键会快得多。就像第 1 页中最后一个键的日期时间戳一样，然后在日期时间上使用 $get。

> cursor.skip() 方法通常很昂贵，因为它要求服务器在开始返回结果之前从集合或索引的开头步行以获取偏移量或跳过位置

# codeigniter - codeigniter 从表单上传图片

> ID：15815858
> 
> 赞同：0
> 
> 时间：2013-04-04T15:47:21.887
> 
> 标签：codeigniter, codeigniter-2

我有一个表单字段（正在上传个人图片）。所以用户从 pc 中选择图像并提交表单。我稍后将通过以下方式处理所有发布的数据：

```
$this->input->post() 
```

我插入数据库的方法是：

```
public function add_user()
    {
        $data = array(
            'membership'=>$this->input->post('membership_type'),
            'fullname'=>$this->input->post('fullname'),
            'username'=>$this->input->post('username'),
            'password'=>md5($this->input->post('password')),
            'email'=>$this->input->post('email'),
            'city'=>$this->input->post('city'));
            'profilepic'=>$this->input->post('profilepic'));

        $this->db->insert('members',$data);

    } 
```

现在我要在 profilepic 字段中插入的是服务器上图像的路径。我知道上面做错了，因为这种方式插入了发布到 profilepic 的图片。我需要一些更正。有没有可以执行上传和返回路径的功能？但是我又如何将图片的上传与用户数据的上传联系起来呢？

问候，

编辑：尝试了下面提供的代码并得到了这个：

> 遇到 PHP 错误
> 
> 严重性：通知
> 
> 消息：使用未定义的常量 full_path - 假定为 'full_path'
> 
> 文件名：models/membership_model.php
> 
> 行号：29
> 
> 遇到 PHP 错误
> 
> 严重性：警告
> 
> 消息：无法修改标头信息 - 标头已由（输出开始于 /home2/xsysdeve/public_html/system/core/Exceptions.php:185）
> 
> 文件名：core/Common.php
> 
> 行号：438

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:05:23.123

请试试这个：

```
public function add_user()
    {
         $config['upload_path'] = '/file_path/';
         $config['allowed_types'] = 'gif|jpg|png|jpeg';
         $this->load->library('upload', $config);
         $this->upload->do_upload('profilepic');
         $data_upload_files = $this->upload->data();

         $image = $data_upload_files[full_path];

        $data = array(
            'membership'=>$this->input->post('membership_type'),
            'fullname'=>$this->input->post('fullname'),
            'username'=>$this->input->post('username'),
            'password'=>md5($this->input->post('password')),
            'email'=>$this->input->post('email'),
            'city'=>$this->input->post('city'));
            'profilepic'=>$image;

        $this->db->insert('members',$data);

    } 
```

有关更多信息，请访问此链接：[http ://ellislab.com/codeigniter/user-guide/libraries/file_uploading.html](http://ellislab.com/codeigniter/user-guide/libraries/file_uploading.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-26T21:51:46.623

您还可以尝试使用 2 个 CI 函数并检查文本数据的 POST 以及图像验证：

```
class SomeForm extends CI_Controller{   

function add_user()  //this function is your form
{
    $this->load->view('templates/header');
    $this->load->view('new_form_entry', array('error' => ' ' ));
    $this->load->view('templates/footer');
}

function add_user_status()  //this function is your form processing
{

    $config['upload_path'] = './assets/images';
    $config['allowed_types'] = 'gif|jpg|png';
    //$config['max_size']   = '2000';
    //$config['max_width']  = '340';
    //$config['max_height']  = '190';

    $this->load->library('upload', $config);

    if ( ! $this->upload->do_upload())
    {
        //check for errors with the upload
        $error = array('error' => $this->upload->display_errors());
        $this->load->view('templates/header');
        $this->load->view('new_form_entry', $error);
        $this->load->view('templates/footer');
    }
    else
    {
        //upload the new image
        $upload_data = $this->upload->data();
        $image_name = $upload_data['file_name'];

        if($_POST){

        $data = array(
            'author'=>$_POST['author'],
            'name'=>$_POST['name'],
            'image_thumb'=>'../assets/images/'.$image_name,
            'video'=>$_POST['video'],
            'title'=>$_POST['title'],
            'body'=>$_POST['body'],
            'created' => date('Y-m-d H:i:s')

        );

        //insert the new post
        $this->your_database_model_name->insert_entry($data);
        }                   

        redirect(base_url().'SomeForm/index');          
    }
} 
```

}

# python - Apply affine transform to quiver in python matplotlib

> ID：15815862
> 
> 赞同：2
> 
> 时间：2013-04-04T15:47:33.637
> 
> 标签：python, matplotlib

I am trying to apply an affine transform to a quiver plot. This is an example based on one of the matplotlib quiver demos. Currently the result of the plot command transforms one direction while the result of the quiver command goes the other direction. Why is this and how do I fix it?

```
import matplotlib as mpl
from pylab import *
from numpy import ma

X,Y = meshgrid( arange(0,2*pi,.2),arange(0,2*pi,.2) )
U = cos(X)
V = sin(Y)

#3
fig = figure()
ax = subplot(111)
base_trans = ax.transData
tr =  mpl.transforms.Affine2D(matrix = array([[1,1,0],[0,1,0],[0,0,1]])) + base_trans

Q = quiver( X[::3, ::3], Y[::3, ::3], U[::3, ::3], V[::3, ::3],
            pivot='mid', color='r', units='inches', transform = tr )
qk = quiverkey(Q, 0.5, 0.03, 1, r'$1 \frac{m}{s}$', fontproperties={'weight': 'bold'})
plot( X[::3, ::3], Y[::3, ::3], 'k.', transform = tr)

axis([-1, 7, -1, 7])
fig.savefig('demo.png')
show() 
```

# sql - 改进数据库架构

> ID：15815866
> 
> 赞同：0
> 
> 时间：2013-04-04T15:47:43.450
> 
> 标签：sql, database, oracle

![宠物店数据库架构](https://i.imgur.com/2Mi7EIU.png)

我正在为一个项目创建一个小型宠物店数据库

数据库需要有一个按供应商的产品列表，可以按宠物类型或产品类别分组。

每个店内销售和客户订单每个订单可以有多个产品，并且附加到他们的员工客户订单必须有客户，员工必须有职位，

[http://imgur.com/2Mi7EIU](https://imgur.com/2Mi7EIU)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:40:33.667

以下是一些随机的想法

1.  我经常将地址与有地址的东西分开。您可以在 Employee、Customer 和 Supplier 之间建立一对多关系到地址表。这将允许您为每个实体拥有不同类型的地址，并在不触及原始表格的情况下更改地址。

2.  如果某件商品的价格可能发生变化，则您需要以某种方式对此进行解释。有创建定价表的想法，或者在销售项目表上捕获价格。

3.  我不喜欢你处理销售项目表的方式。基于事务类型的不同外键并不完全正确。另一种方法是将 SalesItem SaleID 和 OrderId 替换为 SalesRecordId... 另一个更好的选择是将 InStoreSale、SalesRecord 和 CustomerOrders 中的字段合并到一个表中并在表上添加一个指示符以指示哪种类型的交易它是。

4.  您可能会尝试与您的桌子上的复数保持一致。例如，CustomerOrders 与 CustomerOrder。

5.  将 PositionPay 放在 EmployeePosition 表上似乎是为了……同一职位的员工通常可以有不同的薪酬。

6.  PetType 的结构是否足够复杂？您不能拥有适用于一种以上宠物类型的物品吗？例如，鱼缸可以用来养鱼还是蜥蜴？如果是这样，您将需要一个多对多连接表。

希望这可以帮助！

# mysql - Doctrine2 LEFT JOIN 有 2 个条件

> ID：15815869
> 
> 赞同：11
> 
> 时间：2013-04-04T15:47:47.223
> 
> 标签：mysql, doctrine-orm, symfony-2.0

我试图通过 ID 查找“产品”，并在两个条件下加入所有“照片”：语言环境和活动状态。

这是我的 QueryBuilder ：

> ```
> $queryBuilder = $this->createQueryBuilder('p')
>             ->select('p, photos, photoTranslation')
>             ->leftJoin('p.photos', 'photos')
>             ->leftJoin('photos.translations', 'photoTranslation')
>             ->where('p.id = :id')
>             ->andWhere('(photoTranslation.locale = :locale OR photoTranslation.locale IS NULL)')
>             ->andWhere('(photoTranslation.active = :active OR photoTranslation.active IS NULL)')
>             ->setParameters(array(
>                 'id' => $id
>                 'locale' => $this->getLocale(),
>                 'active' => true
>              )); 
> ```

当没有照片或有活动照片时它可以正常工作，但当有非活动照片时则不行，因为它不符合这两个条件之一。

如果我只使用一种条件，例如只使用语言环境部分，它可以正常工作：

> ```
> $queryBuilder = $this->createQueryBuilder('p')
>             ->select('p, photos, photoTranslation')
>             ->leftJoin('p.photos', 'photos')
>             ->leftJoin('photos.translations', 'photoTranslation')
>             ->where('p.id = :id')
>             ->andWhere('(photoTranslation.locale = :locale OR photoTranslation.locale IS NULL)')
>             ->setParameters(array(
>                 'id' => $id
>                 'locale' => $this->getLocale()
>              )); 
> ```

现在，我循环这些结果并取消设置所有非活动照片......但我想要在 QueryBuilder 中做一个干净的方法。

我还尝试将条件放在 LEFT JOIN 子句上：

> ```
> ->leftJoin('photo.translations', 'phototTranslation', Doctrine\ORM\Query\Expr\JOIN::WITH, 'photoTranslation.locale = :locale AND photoTranslation.active = :active') 
> ```

但它总是返回照片，即使它处于非活动状态。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2014-02-11T15:17:46.683

对于这个问题，一个解决方案可能是：

```
$em = $this->getEntityManager();
$qb = $em->createQueryBuilder();
$qb
    ->select('p', 'pp')
    ->from('Product', 'p')
    ->leftJoin('p.photos', 'pp')
    ->leftJoin('pp.translations', 'ppt', Doctrine\ORM\Query\Expr\Join::WITH, $qb->expr()->andX(
        $qb->expr()->eq('ppt.locale', ':locale'),
        $qb->expr()->eq('ppt.active', ':active')
    ))
    ->where('p.id', ':productId')
    ->setParameters(
        array(
            'productId', $productId,
            'active', $active,
            'locale', $locale
        )
    );

    $query = $qb->getQuery();
    return $query->getResult(); // or ->getSingleResult(); 
```

注意：此示例是在 Symfony2 (2.3) 实体存储库中执行此操作的方法

# mdx - MDX TTM 计算会员 - 日级别

> ID：15815873
> 
> 赞同：2
> 
> 时间：2013-04-04T15:47:51.890
> 
> 标签：mdx, leap-year

我需要创建一个计算成员来计算与选定日期（日级别）关联的 TTM（过去十二个月）的收入。

我试过这样的事情：

```
SUM(
    {
        [Accounting Effective Date].[Date Hierarchy].CurrentMember.Lag(365)
        : [Accounting Effective Date].[Date Hierarchy].CurrentMember
    },  
    [Measures].[Revenue]
) 
```

但这不适用于闰年，例如，如果我选择 2013-01-01 而不是返回 2012-01-02。

我也试过这个，但这个也不好，因为它需要一个月的第一天：

```
SUM(
    {
        [Accounting Effective Date].[Date Hierarchy].CurrentMember.Parent.Lag(12).FirstChild 
        : [Accounting Effective Date].[Date Hierarchy].CurrentMember
    },  
    [Measures].[Revenue]
) 
```

日期层次如下：年 > 季度 > 月 > 日期

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-02-16T19:14:35.377

以下查询可以提供帮助，它使用表亲函数返回去年的日期。

```
with member [Measures].[TestValue] as 
(cousin([Date].[Calendar].currentmember,[Date].[Calendar].currentmember.parent.parent.lag(1)),[Measures].[Internet Sales Amount])
member [Measures].[TestDate] as 
cousin([Date].[Calendar].currentmember,[Date].[Calendar].currentmember.parent.parent.lag(1)).item(0).name
select
{[Measures].[Internet Sales Amount],[Measures].[TestValue],[Measures].[TestDate]}
on columns,
{
[Date].[Calendar].[Date].&[20130922]
}
on rows from 
[adventure works] 
```

[![在此处输入图像描述](https://i.stack.imgur.com/3DLVL.png)](https://i.stack.imgur.com/3DLVL.png)

# extjs - 在 ExtJS 4 中，为什么列渲染不适用于对象？

> ID：15815874
> 
> 赞同：0
> 
> 时间：2013-04-04T15:47:52.923
> 
> 标签：extjs, extjs4, extjs4.1

我正在尝试将渲染器用于网格内的列。这是json数据

```
{
    "success": true,    
    "products": [{
        "myfield": [30, 50]
    }]
} 
```

这是列渲染器的代码

```
 {
      text: "Myfield",
      dataIndex: 'myfield',
      renderer: function (val) {
          if (typeof (val) == 'object') {
              // Here am getting for 3 times 
              console.log(val);
              return val;
          } else {
              return val;
          }
      }
  } 
```

在控制台中为什么要打印 3 次？

```
 [30, 50]
 [30, 50]
 [30, 50] 
```

我正在尝试为数组中的每个值创建跨度元素，因此使用渲染器。

谢谢你的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T12:58:19.797

ExtJs 解释您的 json 的方式是未定义的，或者换句话说 - 就 ExtJs 而言，您的 josn 是无效的。

```
"products": [{
    // ExtJs has no way to understand this.
    "myfield": [30, 50]
}] 
```

您正在使用：

```
dataIndex: 'myfield' 
```

这意味着该列显示模型记录中的一个字段。模型记录的字段必须是原始类型 - 它不能是数组或对象。如果您考虑一下 - 将数组或对象作为字段值是没有意义的。

您应该查看您尝试表示的数据的关联。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-11T15:33:38.797

```
renderer:function(value, metaData, record){
         return record.raw.myfield // here you can get array and create string for rendering
} 
```

# android - 将 JSON 结果打印到屏幕

> ID：15815877
> 
> 赞同：0
> 
> 时间：2013-04-04T15:48:30.107
> 
> 标签：android, json, http-post

我有这个 HTTP/JSON 代码应该从数据库中检索数据，但是我该如何将它打印到屏幕上。如果您需要任何额外的代码，请告诉我。谢谢

```
String result = "";
List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(1);
nameValuePairs.add(new BasicNameValuePair("name","Badminton"));

//http post
try{
HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost("myurl.php");
httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
HttpResponse response = httpclient.execute(httppost);
HttpEntity entity = response.getEntity();
InputStream is = entity.getContent();
}
catch(Exception e1){
Log.e("log_tag", "Error in http connection "+e1.toString());
}

//convert response to string
try{
BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
StringBuilder sb = new StringBuilder();
String line = null;
while ((line = reader.readLine()) != null) {
sb.append(line + "\n");
}

is.close();
result=sb.toString();
}

catch(Exception e){
Log.e("log_tag", "Error converting result "+e.toString());
}

//parse json data
try{
JSONArray jArray = new JSONArray(result);
for(int i=0;i<jArray.length();i++)
{
JSONObject json_data = jArray.getJSONObject(i);
Log.i("log_tag","type: "+json_data.getInt("id"));
}
}

catch(Exception e)
{
Log.e("log_tag", "Error parsing data "+e.toString());
} 
```

那么我将如何将我从 PHP 文件收到的数据打印到屏幕上，我稍后会用它做更多的事情

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:09:04.417

如果您只是对查看 JSON 感兴趣，并且如果它足够小，您可以举杯。

```
Toast.makeText(context, text, Toast.LENGTH_LONG).show(); 
```

如果您想查看整个 json，可以将其放入 a`TextView`并使用 JSON 对象的[toString](http://www.json.org/javadoc/org/json/JSONObject.html#toString%28int%29)方法来漂亮地打印它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:05:01.050

如果您只想快速向用户显示它，您可以使用`Toast`. 更多关于 Toasts 的信息可以在[这里找到](http://developer.android.com/guide/topics/ui/notifiers/toasts.html)

```
Toast toast = Toast.makeText(getApplicationContext(), text, Toast.LENGH_SHORT).show(); 
```

如果您想在特定视图中显示它，例如`TextView`屏幕上，您需要找到该视图并设置您想要显示的文本。

```
TextView v = (TextView) findViewById(R.id.where_im_displaying_text);
v.setText(text); 
```

如果您正在尝试做其他事情，请告诉我们，以便我们提供帮助。

# php - 部署后 PHP 访问被拒绝 - 登录

> ID：15815884
> 
> 赞同：0
> 
> 时间：2013-04-04T15:49:05.317
> 
> 标签：php, mysql, phpmyadmin

我一直在本地开发一个简单的站点，现在准备将其部署到我的服务器 - 该站点在本地工作。该站点从 MySql 数据库中读取数据并部署在 Ubuntu 服务器上——我已经安装了我需要的所有东西。

我的页面内容是：

```
 include "Connection.php";
    $db_handle = mysql_connect($server, $user_name, $password);
    $db_found = mysql_select_db($database, $db_handle);
    //code continues 
```

Connection.php 的内容是：

```
<?php
  $user_name = "myuser";
$password = "123456";
$database = "results";
$server = "localhost";
?> 
```

使用 PhpMyAdmin，我创建了“结果”数据库，并为它分配了一个名为“myuser”的用户，并拥有所有权限。当我尝试导航到该站点时，我收到错误消息：

```
Access denied for user 'www-data'@'localhost' (using password: NO) 
```

这让我觉得网站没有读取我的“Connection.php”文件。我是对的，我该如何解决这个问题？我是否需要更改网站文件夹或其他任何内容的权限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:14:57.187

当您没有有效的连接并尝试数据库查询时，php/mysql 将尝试使用“www-data”创建连接，该用户是运行 apache 和 php 的系统用户。

在 mysql_connect() 中捕获错误并打印 mysql_error() 消息，这将有所帮助。这可能是因为超出了最大连接数。

尝试在 mysql_connect 和 mysql_select_db 函数中硬编码细节只是为了测试。

还要检查 Connection.php 是否包含在内。使用“require”而不是include，以便在文件丢失时抛出错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:06:28.957

使用一些调试...

1.  尝试使用`require()`

    > 如果 PHP 解释器未能包含文件以响应对 include() 或 include_once() 的调用，则会生成警告并在没有该文件的情况下继续执行。其中，未能包含由 require() 或 require_once() 调用的文件会生成致命错误，并且执行会在那里停止。

    并使脚本在连接失败或包含文件时抛出错误。

2.  再次检查用户名和密码。这包括您甚至检查用户是否存在。

# sql - 将csv导入sqlite时如何保留撇号

> ID：15815885
> 
> 赞同：-1
> 
> 时间：2013-04-04T15:49:09.753
> 
> 标签：sql, csv, import

我在 android 应用程序中使用 SQL 数据库并且遇到了撇号问题。

我的数据库是我在 MS Excel 2007 中的报价数据库，然后以 .csv 格式保存。然后我将它导入到我为应用程序拥有的 sql 表中。但是，带有撇号的引号在数据库（以及应用程序）中未正确显示。每个撇号都替换为一个不可见的字符。我知道它的存在是因为字符数以及例如在看起来像“arent”的单词“不是”中，它需要点击 3 次右箭头才能从 n 的左侧到右侧t 的一侧。如果我手动将撇号添加到 sql 表中，它会在保存数据库时转换回这个不可见字符。在 android 应用程序中，这个不可见的字符显示为一个空心矩形。

我确信问题不在于我的应用程序显示报价，因为我已将字符串传递给相同的代码，并且它显示撇号非常好。

有没有办法解决这个问题，可能通过更改字符集或类似的东西？还是 SQL 不支持撇号？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:18:16.860

由于单引号和撇号是同一个字符，因此您必须在 sql 中做一些事情来告诉数据库何时将其视为字符串的一部分或何时使用它来包围字符串。在我知道的每个 RDBMS 中，如果您希望字符成为字符串的一部分，则“引用引号”，即在与数据库交谈时将 ' 更改为 ''。

这似乎只是你问题的一部分。另一部分是您的 android 应用程序将此字符显示为矩形或撇号。这与sql无关。那是android应用程序的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T15:31:21.813

我找到了该问题的替代解决方案。

在应用程序运行时，我用撇号替换不可见字符，最后的字符串就是引号的外观。

```
String quote = (get the quote from the SQL table)
char[] tempQuoteCharArr = new char[quote.length()];
tempQuoteCharArr = quote.toCharArray();
    for(int i = 0; i < quote.length(); i++){
        if(tempQuoteCharArr[i] == ''){
            tempQuoteCharArr[i] = '\'';
        }
    }
    quote = String.valueOf(tempQuoteCharArr); 
```

不可见字符位于 if 语句中的单引号之间。

# mysql - 密码哈希函数抛出错误 1146

> ID：15815886
> 
> 赞同：4
> 
> 时间：2013-04-04T15:49:10.787
> 
> 标签：mysql, mysql-workbench

我有这样的查询

```
UPDATE `database`.`user` 
SET `Password`=Password("test1234!@#$") 
WHERE `UserID`='1234'; 
```

我运行了一次，它更新了密码。我在测试中更改了 t 的大小写，它开始失败并显示消息

> 错误代码：1146。表 'database.Unknown' 不存在。

经过一些实验，我发现删除`$`字符串中的 允许查询成功运行。我试图用 / 转义字符，但错误仍然发生。列上的排序规则是`utf8`，它是`varchar(50)`。

查询本身`MySQL Workbench 5.2.47`在`MySQL version 5.1.62`Community Edition 中执行。

谁能告诉我为什么美元很麻烦。

编辑：它现在正在发生，没有任何特殊字符。我也知道有更安全的方法来散列密码。在这一点上，我只是好奇为什么会发生特定错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:35:19.573

首先推断问题来自工作台：从命令提示符（mysql -u 用户名 -pPassword -h 主机名）或使用 phpmyadmin 登录，然后尝试执行查询。

如果可行，那就是工作台。

然后，您可能首先只想删除工作台中所有已配置的连接设置并重新添加它们。这可能已经解决了您的问题。

如果问题仍然存在，您可以尝试重新安装工作台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T14:16:18.887

最终是存在一个触发器，里面有这个

```
INSERT INTO Unknown VALUES(1); 
```

我不知道这样做的目的是什么，但显然是导致问题的原因。感谢大家的帮助。

# iphone - 没有根元素ios的Json

> ID：15815888
> 
> 赞同：1
> 
> 时间：2013-04-04T15:49:17.893
> 
> 标签：iphone, ios, objective-c, json

所以我对 ios 开发非常陌生，我正在创建我的第一个应用程序，它连接到服务器并提取一些信息。我遵循了许多不同的教程，并设法从不同的地方撤回了一些 json。我遇到的问题是我需要提取的信息没有根元素，我需要更改什么才能将信息发送到我的应用程序？

以下是我正在使用的代码：

```
 #import "leagueTableViewController.h"

   #define kBgQueue dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0)

    #define kjsonURL [NSURL URLWithString: @"http://api.kivaws.org/v1/loans/search.json?status=fundraising"]
     @interface leagueTableViewController ()

      @end

      @implementation leagueTableViewController{

    NSMutableArray *jsonResults;
     }

    - (id)initWithStyle:(UITableViewStyle)style
    {
    self = [super initWithStyle:style];
     if (self) {
    // Custom initialization
     }
      return self;
        }

      - (void)viewDidLoad
       {
      [super viewDidLoad];

        dispatch_async(kBgQueue, ^{

           NSData* data = [NSData dataWithContentsOfURL:

                    kjsonURL];

          [self performSelectorOnMainThread:@selector(fetchedData:)

                           withObject:data waitUntilDone:YES];

             });
           }

        - (void)fetchedData:(NSData *)responseData {

           NSError* error;

           NSDictionary* json = [NSJSONSerialization

                      JSONObjectWithData:responseData

                      options:kNilOptions

                      error:&error];

       jsonResults = [json objectForKey:@"loans"];

       [self.tableView reloadData];

        }

    - (void)didReceiveMemoryWarning
      {
      [super didReceiveMemoryWarning];
       // Dispose of any resources that can be recreated.
        }

      #pragma mark - Table view data source

      - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
        {

      // Return the number of sections.
       return 1;
       }   

  - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:   (NSInteger)section
   {
   return [jsonResults count];
  }

      - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:  (NSIndexPath *)indexPath

       {
      static NSString *CellIdentifier = @"Cell";

       UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

        NSDictionary *appsdict = [jsonResults objectAtIndex:indexPath.row];

       NSString *VersionString = [appsdict objectForKey:@"funded_amount"];

       NSString *priceString = [appsdict objectForKey:@"loan_amount"];

       cell.textLabel.text = [appsdict objectForKey:@"name"];

      cell.detailTextLabel.text = [NSString stringWithFormat:@"Version: %@ Price: $ %@ USD",VersionString,priceString];

     return cell;

     }

       #pragma mark - Table view delegate

      - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath   *)indexPath
     {
     //    NSDictionary *appsdict = [jsonResults objectAtIndex:indexPath.row];
     //    
    //    NSString *appURL = [appsdict objectForKey:@"trackViewUrl"];
     //    
    //    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:appURL]];
     }

    @end 
```

这是上面代码使用的 json 示例，您可以看到根元素：

```
 {
       "paging": {
      "page": 1,
      "total": 873,
      "page_size": 20,
       "pages": 44
        },
       "loans": [{
        "id": 544449,
        "name": "Sajad",
        "description": {
            "languages": ["en"]
          },
          "status": "fundraising",
          "funded_amount": 0,
          "basket_amount": 0,
          "image": {
            "id": 1325179,
            "template_id": 1
           },
          "activity": "Cloth & Dressmaking Supplies",
          "sector": "Retail",
           "use": "to renovate his shop and increase his textile inventory",
           "location": {
            "country_code": "IQ",
            "country": "Iraq",
            "geo": {
                "level": "country",
                "pairs": "33 44",
                "type": "point"
            }
           },
           "partner_id": 166,
          "posted_date": "2013-04-04T15:40:01Z",
           "planned_expiration_date": "2013-05-04T15:40:01Z",
           "loan_amount": 2400,
           "borrower_count": 1
            } 
```

这是我需要获取的 json，但它没有根元素，我需要做什么才能在我的应用程序中显示它：

```
 [{
    "position": 1,
    "team_id": 10260,
    "team": "Manchester United",
    "teamshort": "Man Utd",
    "played": 30,
    "won": 25,
    "drawn": 2,
    "lost": 3,
    "for": 70,
    "against": 31,
    "difference": 39,
    "home": {
        "played": 15,
        "won": 14,
        "drawn": 0,
        "lost": 1,
        "for": 39,
        "against": 15,
        "difference": 24
    },
    "away": {
        "played": 15,
        "won": 11,
        "drawn": 2,
        "lost": 2,
        "for": 31,
        "against": 16,
        "difference": 15
    },
    "points": 77,
    "info": "championsleague"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T17:08:42.373

使用 JSON，您需要事先了解结构。向您发送数据的 API 会让您知道这一点。

您收到错误的原因是您将 NSArray 视为 NSDictionary。这是一个例子。

这应该被解析为 NSArray：

```
[{
    username: 'johndoe'
}] 
```

这将是 NSDictioanry：

```
{
   username: 'johndoe'
} 
```

您拥有的数据与我提出的第一个案例相似。因此，要获取数据，您需要以下内容：

```
NSArray* json = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&error];

[[json objectAtIndex: 0] objectForKey:@"thekey"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:16:39.800

如果您在尝试阅读之前去掉第一个括号，则第二个块将正确解析：

```
NSData *strippedData = [data subdataWithRange:NSMakeRange(1, data.length-1)]; 
```

就您收到的错误而言，这不是 NSJSONSerialization 错误，它表示返回的对象是 NSArray 类型（即使您期待 NSDictionary 类型）并且您正在尝试调用`objectForKey:`它，即不是 NSArray 的方法。您应该分析数组，看看它是否包含您需要的信息。这可能看起来像这样：

```
NSArray *jsonArray = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableContainers error:&jsonError];
jsonResults = [[jsonArray objectAtIndex:0] objectForKey:@"loans"]; 
```

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T16:34:13.470

“没有根元素”的第二个响应**不是有效的 JSON**。这就是它无法解析的原因。没有没有根元素的 JSON 之类的东西——只有有效的 JSON 和损坏的无效 JSON。你有几个选择：

1.  正如@daltonclaybrook 建议的那样，去掉前导的“[”。或者，在末尾添加一个额外的“]”。任何一种更改都会产生有效的 JSON。我不喜欢这种方法，因为如果服务器给你提供了损坏的 JSON，那么它可能不会一直被损坏，或者他们可能会在某个时候修复它。

2.  **修复服务器端的 JSON**。如果您与服务器有任何连接，请告诉他们他们的 JSON 已损坏并让他们修复它。如果你不能把它修好，我的哀悼，因为处理搞砸的服务器一点也不好玩。如果有任何可能解决这个问题，**那就去做吧，**而不是试图弄清楚*这次*是怎么坏的，然后再把它修好。

# regex - perl(s//)中如何使用变量作为替换文本？

> ID：15815892
> 
> 赞同：0
> 
> 时间：2013-04-04T15:49:26.137
> 
> 标签：regex, perl, substitution

我想使用变量作为 perl (s//) 中的替换文本？显然，以下代码不起作用。有没有办法做我想做的事？

```
~$  ./subsuffix.pl 
xxx_$1_outsuffix.txt 
```

subsuffix.pl：

```
#!/usr/bin/env perl

use strict;
use warnings;

my $filename="xxx_5p_insuffix.txt";
my $insuffix="_((5|3)p)_insuffix.txt";
my $outsuffix = '_$1_outsuffix.txt';

#result of the following is what I expect
#$filename =~ s/$insuffix$/_$1_outsuffix.txt/;
#But I want used a variable as the substitution text. 
#Unfortunately, the following do not work.
$filename =~ s/$insuffix$/$outsuffix/;
print "$filename\n"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:52:24.147

替换通常不会被评估。您必须`/e`在替换末尾添加几个 's 并添加一些引号以使其在第一次评估后保持有效表达式：

```
$filename =~ s/$insuffix$/qq("$outsuffix")/ee; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T15:57:58.867

您可以使用`/e`修饰符将替换模式视为要评估的代码：

```
$filename =~ s/$insuffix$/ "_" . $1 . "_outsuffix.txt" /e; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T17:50:25.873

你所拥有的`$outsuffix`是一个模板。模板不会神奇地处理自己。您需要调用处理器。[String::Interpolate](http://search.cpan.org/perldoc?String%3a%3aInterpolate)可以理解你的模板。

```
use String::Interpolate qw( interpolate );

my $filename="xxx_5p_insuffix.txt";
my $insuffix="_((5|3)p)_insuffix.txt";
my $outsuffix = '_$1_outsuffix.txt';

$filename =~ s/$insuffix$/interpolate($outsuffix)/e;
print "$filename\n"; 
```

# sql - SQL Azure - 创建复杂的数据透视表

> ID：15815893
> 
> 赞同：0
> 
> 时间：2013-04-04T15:49:26.933
> 
> 标签：sql, sql-server, pivot, azure-sql-database, pivot-table

这个问题都是针对 SQL Azure 的。我有一个按年份列出的各种商品价格的数据集和一个单价，例如：

大米 - 2007 - 0.5
大米 - 2007 - 0.3
大米 - 2007 - 0.8
小麦 - 2006 - 1.1
小麦 - 2006 - 1.4
等

如何创建一个数据透视表，为我提供每年为每种商品支付的 MAX 和 MIN 价格？我知道如何做一个可以给我平均水平的数据透视表——这很容易。但是我需要我的“主要”枢轴列作为年份，然后每年都会有 2 个“子列”，分别为 MIN 和 MAX 价格，我不太确定如何做到这一点。帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:58:39.660

除非我在您的解释中遗漏了某些内容，否则您可以在没有 PIVOT 功能的情况下轻松完成此操作：

```
select product,
  year,
  min(price) MinPrice,
  max(price) MaxPrice
from yourtable
group by product, year 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/bfc88/1)。

如果您希望将数据放在单独的列中，那么您可以通过几种方法来执行此操作。

**用 CASE 聚合函数：**

```
select product,
  min(case when year=2006 then price else 0 end) [2006_MinPrice],
  max(case when year=2006 then price else 0 end) [2006_MaxPrice],
  min(case when year=2007 then price else 0 end) [2007_MinPrice],
  max(case when year=2007 then price else 0 end) [2007_MaxPrice]
from yourtable
group by product 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/bfc88/11)

**UNPIVOT 和 PIVOT：**

UNPIVOT 用于将列数据转换为行。进入行后，您可以使用年份创建新列，然后进行透视：

```
select *
from
(
  select product, 
    cast(year as varchar(4))+'_'+col as piv_col,
    value
  from
  (
    select product,
      year,
      min(price) MinPrice,
      max(price) MaxPrice
    from yourtable
    group by product, year
  ) x
  unpivot
  (
    value for col in (minPrice, maxPrice)
  ) u
) d
pivot
(
  max(value)
  for piv_col in ([2006_MinPrice], [2006_MaxPrice],
                  [2007_MinPrice], [2007_MaxPrice])
) piv; 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/bfc88/13)。这些给出了结果：

```
| PRODUCT | 2006_MINPRICE | 2006_MAXPRICE | 2007_MINPRICE | 2007_MAXPRICE |
---------------------------------------------------------------------------
|    Rice |             0 |             0 |           0.3 |           0.8 |
|   Wheat |           1.1 |           1.4 |             0 |             0 | 
```

如果你有一个未知的年数，那么你也可以实现动态 sql。

# ormlite-servicestack - ServiceStack：OrmLite 的 nuget 安装没有安装所有需要的部分？

> ID：15815894
> 
> 赞同：1
> 
> 时间：2013-04-04T15:49:31.630
> 
> 标签：ormlite-servicestack

根据文档安装包并尝试了一个简单的查询

```
db.SingleOrDefault<Customer>("Id={0}",id) 
```

并得到错误

> 无法从程序集 'ServiceStack.Text，Version=3.9.26.0，Culture=neutral，PublicKeyToken=null' 加载类型 'ServiceStack.Text.PlatformExtensions'。":"ServiceStack.Text.PlatformExtensions"}

nuget 定义是否缺失？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:00:01.310

您正在引用旧的 NuGet 包。所有 ServiceStack NuGet 包 (inc [ServiceStack.Text](https://nuget.org/packages/ServiceStack.Text/) ) 的当前版本是 v3.9.43。

清除旧的 NuGet 包并再次重新引用它们。

# jquery - Flexigrid 不在 ASP.NET 中显示数据

> ID：15815896
> 
> 赞同：1
> 
> 时间：2013-04-04T15:49:38.993
> 
> 标签：jquery, asp.net, flexigrid

我有一个 Flexigrid 从我创建的 WebService 获取 JSON 数据。在调试时，我可以看到，正在调用 GetData() Web 方法，并且该方法返回有效的 JOSN 数据。但它不会显示在 flexigrid 中。这是我正在使用的代码片段：

```
 $(document).ready(new function ()
{
   $("#flex1").flexigrid
  (
    {
        url: "FlexigridDataService.asmx/GetData",
        dataType: 'json',
      //  method: 'GET',            
        colModel: [
            {
                display: 'MetaDataKey', name: 'MetaDataKey', width: 600, sortable:     true, align: 'center'
            },
            {
                display: 'MetaDataValue', name: 'MetaDataValue', width: 600, sortable: true, align: 'center'
            }
        ],
        searchitems: [
            { display: 'MetaDataKey', name: 'MetaDataKey', isdefault: true },
            { display: 'MetaDataValue', name: 'MetaDataValue' }
        ],
        onError: function (jqXHR, textStatus, errorThrown) {
            alert("ERROR!!!" + + errorThrown)
        },
        sortname: "MetaDataKey",
        sortorder: "asc",
        usepager: true,
        title: 'Meta-Data..',
        useRp: true,
        rpOptions:[50,100,150,200,250],
        rp: 100,
        showTableToggleBtn: false,
        width: 1200,
        //onSubmit: addFormData,
        height: 500,            
        singleSelect: false
    }
); 
```

});

GetData() 从 MS-SQL 数据库中获取数据并形成 JSON 对象。我错过了什么吗？？真的很生气..任何帮助表示赞赏..

谢谢， DK

# php - 即使使用参数，PHP htmlentities 也无法正常工作

> ID：15815899
> 
> 赞同：8
> 
> 时间：2013-04-04T15:49:43.313
> 
> 标签：php, html-entities, htmlspecialchars

当然，这已经被问过并且已经寻找解决方案，到目前为止所有这些都没有奏效。我想使用`htmlentities`or将 TM 符号和 & 符号更改为它们的 html 等效项`htmlspecialchars`：

```
$TEST = "Kold Locker™ & other stuff";
echo "ORGINIAL: " . $TEST . "<BR/>";

echo "HTML: " . htmlentities($TEST, ENT_COMPAT, 'UTF-8'); 
```

这显示：

```
ORGINIAL: Kold Locker™ & other stuff
HTML: 
```

我也试过了`htmlspecialchars`，第二个参数改变了同样的结果。

我错过了什么其他人声称在其他解决方案中有效的东西？

**更新**：我尝试只显示`utf8_encode($TEST)`并显示`HTML: Kold LockerÂ™ & other stuff`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-04T00:49:59.620

我不知道为什么，这对我有用（***htmlentities 必须为我调用两次***）

```
$html="<html> <head><head>something like this   </html>"
$entities_correction= htmlentities( $html, ENT_COMPAT, 'UTF-8');
echo  htmlentities( $entities_correction, ENT_COMPAT, 'UTF-8'); 
```

**输出 ：**

> `&lt;html&gt; &lt;head&gt;&lt;head&gt;something like this &lt;/html&gt;`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-31T08:37:18.523

我以为我和 Pjack 有同样的问题（7 月 14 日 8:54 的消息）：

```
$str = "A 'quote' is <b>bold</b>";
echo htmlentities($str); 
```

在浏览器（在我的情况下为 Firefox）中给出原始字符串 $str （没有*任何*翻译），而

```
echo htmlentities(htmlentities($str)); 
```

给出：

```
A 'quote' is &lt;b&gt;bold&lt;/b&gt; 
```

（我使用从 windows-7 XAMPP 获得的 PHP/5.4.16）。

然而，经过一番思考，我突然想到浏览器显示字符串 < 和> 作为 > 和 <。（请参阅浏览器中的源代码）。htmlentities 的第二次调用将 & 转换为`&amp;`，然后浏览器首先显示您的预期。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-04T16:01:16.137

你的代码对我有用：-？

在[手册页中，`htmlentities()`](http://php.net/htmlentities)我们可以阅读：

> **返回值**
> 
> 返回编码的字符串。
> 
> 如果输入字符串在给定编码中包含无效的代码单元序列，则将返回空字符串，除非设置了 ENT_IGNORE 或 ENT_SUBSTITUTE 标志。

我的猜测是输入数据未正确编码为 UTF-8，并且该函数返回一个空字符串。（假设脚本没有崩溃，即该部分之后的代码仍然运行。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-09T10:02:56.023

我遇到了几乎相同的问题（不知何故，它每次都显示相同的文本）并且结合了不同的 echo´si 得到了它。似乎像 Firefox 这样的网络浏览器每次都显示相同的文本。那是因为当您`echo`使用 htmlentities-text 时，它会在回显时转换回普通文本。当我使用要生成的变量/文本回显脚本时`console.log`，它实际上（几乎）正确地回显了 htmlentities 文本。它不是用 html 编码替换每个特殊字符，而是用我以前见过的一些其他编码替换“em”（我不记得名字了）。再次使用 Htmlentities，我再次得到相同的文本回显（记住它会转换所有内容），但在 console.log-version 中回显它会给我预期的结果。现在，再次，结果：
1\. 执行`htmlentities` **两次**！
2.**不要**（至少使用 firefox）将 htmlentities 像往常一样**回显****到网页**中。如果您想检查该值是否确实正确，请回显将其记录到控制台的脚本。
我希望这可以帮助其他有同样问题的人，
VicStudio

**编辑**： 3\. 如果您使用的是`$_POST`公式，请不要忘记将`accept-charset="UTF-8"`（或其他一些字符集）添加到`<form>`标签中。

**更多编辑**`htmlentities`：如果您希望将结果正常回显到页面中，请仅执行 2 次。如果您想直接发送数据库，只需执行一次！-> 我之前所说的部分是错误的。:(

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-02T18:48:36.070

这是一篇旧帖子，但对于仍在寻找解决方案的任何人，这是我成功使用的：

```
echo html_entity_decode($htmlString); 
```

# c - 执行 x87 FPATAN 操作的扩展 GCC 内联汇编中的 clobber 列表说明

> ID：15815901
> 
> 赞同：4
> 
> 时间：2013-04-04T15:49:45.520
> 
> 标签：c, gcc, assembly, x86, inline-assembly

以下代码在**MinGW** [x86inline.h](http://www.willus.com/mingw/x87inline.h)文件中：

```
/*
** in-line atan2(y,x) function.
** Computes arctan(y/x).
*/
#define atan2(y,x) atan2_x87_inline(y,x)
double atan2_x87_inline(double y,double x);
extern __inline__ double atan2_x87_inline(double y,double x)
    {
    double result;
    __asm__ ("fpatan" : "=t" (result) : "0" (x), "u" (y) : "st(1)");
    return(result);
    } 
```

据我了解，x87`fpatan`操作使用`st(0)`and`st(1)`寄存器，覆盖寄存器的内容`st(1)`，然后弹出顶部寄存器。

那么为什么只`st(1)`包含在clobber列表中，而不是`st(0)`同样？

**编辑**：事实上，为什么它需要一个clobber列表，因为编译`st(0)`器`st(1)`应该通过`"t"`and`"u"`约束知道它。是对的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T16:50:01.103

这在[关于 inline asm 的 GCC 文档](http://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html)中有解释（参见关于 i386 浮点的第 6.41.2 节）：

> 给定一组在 asm 中死掉的输入寄存器，有必要知道哪些被 asm 隐式弹出，哪些必须由 GCC 显式弹出。
> 
> 由 asm 隐式弹出的输入寄存器必须被显式破坏，除非它被限制为匹配输出操作数。

在这种情况下，该`fpatan`操作会弹出两个输入并推送输出，因此我们通过破坏`st(1)`来指示这一点。我们只需要破坏`st(1)`而不是`st(0)`因为`st(0)`受限于输出操作数。

# android - java.lang.ClassCastException 切换片段

> ID：15815903
> 
> 赞同：0
> 
> 时间：2013-04-04T15:49:52.603
> 
> 标签：android

```
private void switchFragment(Fragment fragment) {
    if (getActivity() == null)
        return;

    ClassA pm = (ClassA) getActivity();
    pm.switchContent(fragment);
} 
```

我正在尝试`switch fragments`从 ClassB 开始，当我尝试这样做时，我遇到了这个异常。我正在尝试调用`Class A`Activity 的片段。

> java.lang.ClassCastException: com.test.ClassB 不能转换为 com.test.ClassA

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:56:53.383

用于在将类型转换为 or之前`instanceof`检查类型。试试看：`getActivity()``ClassA``ClassB`

```
if (getActivity() instanceof ClassA) {
  ClassA pm = (ClassA) getActivity();
  pm.switchContent(fragment);
 } 
 else if (getActivity() instanceof ClassB) {
  ClassB pm = (ClassB) getActivity();
  pm.switchContent(fragment);
} 
```

# java - 使用带返回值的同步方法包装一系列异步调用

> ID：15815907
> 
> 赞同：10
> 
> 时间：2013-04-04T15:50:05.347
> 
> 标签：java, asynchronous, concurrency, synchronous

我当前的代码使用了一系列异步过程，这些过程最终产生了结果。我需要以这样一种方式包装每一个，即每一个都可以通过同步方法访问，并将结果作为返回值。我想使用执行器服务来做到这一点，以允许其中许多同时发生。我觉得 Future 可能与我的实现有关，但我想不出一个好的方法来实现这一点。

我现在拥有的：

```
public class DoAJob {
  ResultObject result;

  public void stepOne() {
    // Passes self in for a callback
    otherComponent.doStepOne(this);
  }

  // Called back by otherComponent once it has completed doStepOne
  public void stepTwo(IntermediateData d) {
    otherComponent.doStepTwo(this, d);
  }

  // Called back by otherComponent once it has completed doStepTwo
  public void stepThree(ResultObject resultFromOtherComponent) {
    result = resultFromOtherComponent;
  //Done with process
  }
} 
```

这在内部工作得很好，但现在我需要将我的流程映射到一个同步方法，其返回值如下：

```
public ResultObject getResult(){
  // ??? What goes here ???
} 
```

有谁知道如何优雅地实现这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-04T16:23:22.877

如果要将异步操作（完成后执行回调）转换为同步/阻塞操作，可以使用阻塞队列。如果您愿意，可以将其包装在 Future 对象中。

1.  定义一个只能容纳一个元素的阻塞队列：

    `BlockingQueue<Result> blockingQueue = new ArrayBlockingQueue<Result>(1);`

2.  启动您的异步进程（将在后台运行），并编写回调，以便在完成后将其结果添加到阻塞队列中。

3.  在您的前台/应用程序线程中，从队列中获取它（），该队列会阻塞，直到元素变得可用：

    `Result result = blockingQueue.take();`

我之前使用 Future 之类的东西写过类似的东西（前台线程需要阻止来自远程机器的异步响应），您可以[在此处](http://code.google.com/p/mobility-rpc/source/browse/mobility-rpc/trunk/src/main/java/com/googlecode/mobilityrpc/session/impl/MobilitySessionImpl.java#395)找到示例代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T16:00:14.040

我对 Guava 库做了类似的事情；这些链接可能会为您指明正确的方向：

[是否可以使用 Guava 链接异步调用？](https://stackoverflow.com/questions/8191891/is-it-possible-to-chain-async-calls-using-guava/8193077#8193077)

[https://code.google.com/p/guava-libraries/wiki/ListenableFutureExplained](https://code.google.com/p/guava-libraries/wiki/ListenableFutureExplained)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T16:30:19.483

如果你想弄脏你的手，你可以这样做

```
ResultObject result;

public void stepOne() 

    otherComponent.doStepOne(this);

    synchronized(this)
        while(result==null) this.wait();
    return result;

public void stepThree(ResultObject resultFromOtherComponent) 

    result = resultFromOtherComponent;

    synchronized(this)
        this.notify(); 
```

或者您可以使用更高级别的并发工具，例如 BlockingQueue、Semaphore、CountdownLatch、Phaser 等。

请注意，这`DoAJob`不是线程安全的 - 如果两个线程`stepOne`同时调用，则会确保出现问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T16:09:19.353

我建议使用[invokeAll(..)](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html#invokeAll%28java.util.Collection%29)。它将向执行者提交一组任务，并阻塞直到最后一个完成（成功/例外）。然后它返回已完成的 Future 对象列表，因此您可以循环它们并将结果合并到单个 ResultObject 中。

如果您希望以同步方式仅运行单个任务，可以使用以下命令：

```
executor.invokeAll(Collections.singleton(task)); 
```

- 编辑 -

现在我想我更了解您的需求。我假设您需要一种方法来提交独立的任务序列。请查看我在[此答案](https://stackoverflow.com/a/3253936/196211)中发布的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-07T19:32:56.967

[Bumerang 是我的仅异步 http 请求库，它使用 Java -> https://github.com/hanilozmen/Bumerang](https://github.com/hanilozmen/Bumerang)为 Android http 请求构建。我需要在不接触我的图书馆的情况下进行同步调用。这是我的完整代码。npgall 的回答启发了我，谢谢！类似的方法将应用于各种异步库。

```
public class TestActivity extends Activity {

MyAPI api = (MyAPI) Bumerang.get().initAPI(MyAPI.class);
BlockingQueue<Object> blockingQueue = new ArrayBlockingQueue<Object>(1);

static int indexForTesting;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_test);
    Thread t = new Thread(new Runnable() {
        @Override
        public void run() {
            for(int i = 0; i < 10; i++) {
                getItems();
                try {
                    Object response = blockingQueue.take(); // waits for the response
                    Log.i("TAG", "index " + indexForTesting + " finished. Response " + response.toString());
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
    });
    t.start();
}

void getItems() {
    Log.i("TAG", "index " + ++indexForTesting + " started");
    api.getItems(new ResponseListener<Response<List<ResponseModel>>>() {
        @Override
        public void onSuccess(Response<List<ResponseModel>> response) {
            List<ResponseModel> respModel = response.getResponse();
            try {
                blockingQueue.put(response);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void onError(Response<List<ResponseModel>> response) {
            Log.i("onError", response.toString());
            try {
                blockingQueue.put(response);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    });
} 
```

}

# css - 更改浏览器窗口的分辨率大小时，CSS媒体查询不起作用

> ID：15815908
> 
> 赞同：2
> 
> 时间：2013-04-04T15:50:21.343
> 
> 标签：css, responsive-design, media-queries

我似乎无法让这两个查询一起工作。似乎我在“最大宽度：1360”中列出的显示内容覆盖了我必须为 990 像素显示的内容。990px​​ 的媒体查询不会覆盖 1360px 查询中定义的任何内容。我为页脚做了一个工作，但我认为这不是系统的设计方式。我做了一些研究，但我找不到任何人能够解释为什么这不起作用：

```
@media screen and (max-width: 990px)    {
#header {width: 990px; display: inherit;}
#header_info {width: 990px;}
#border_header {width:990px;}
#contact_data { display: none;}
#contact_data1 {width: 990px; display: inherit;}
#contact_data1 img {float: left; }
#contact_info {width: 990px;}
#wrapper {width: 990px; float: left; }
#container {width: 990px; float: left; }
#left_window {width: 200px; float: left;  }
#left_window a {font-size:20px;}
#content {width: 687px; }
#right_window {display:none}

#footer {display:none;}
#footer_content {display:none;}
#footer_container {display:none;}
#footer_content_left {display:none;}
#footer_content_center {display:none;}
#footer_content_right {display:none;}

#footer1 {width: 990px; display:inherit;}
#footer_content1 {width: 990px; display:inherit;}
#footer_container1 {width: 990px; display:inherit;}
#footer_content_left1 {width: 150px; display:inherit;}
#footer_content_center1 {width: 150px; display:inherit;}
#footer_content_right1 {width: 150px; display:inherit;}

#product_listing {margin-left: 55px; }

#breakgarage {display: inherit;}

}

@media screen and (max-width: 1360px)    {    
#footer {width: 1360px;}
#footer_content {width: 1360px;}
#footer_container {width: 1360px;}
#footer_content_left {width:330px;}
#footer_content_center {width: 330px;}
#footer_content_right {width: 330px;}

#header {width: 100%;}
#header_info {width: 1360px;}
#border_header {width:1360px;}
#contact_data {width: 1360px;}
#contact_data img {float: left;}
.contact_data_space {padding-left: 75px;}
#contact_info {width: 1360px;}
#wrapper {width: 1360px;}
#container {width: 1360px;}

contact_info img {width: 50%}

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T15:51:12.693

CSS是级联的。它从上到下解释。这就是为什么您的`1360px`样式会覆盖`990px`样式。`990px`是 的`1360px`子匹配，但它具有相同的优先级，因此它首先下降到最后一个覆盖。

反转您的订单。如果您使用`max-width`，请从上到下从最大的结尾开始写到最小的结尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:54:57.353

我认为您应该将第二个媒体查询更改为：

```
@media screen and (min-width: 991px) and (max-width: 1360px) 
```

这样它只会在屏幕尺寸在 991px 和 1360px 之间时应用。

在您的代码中，第二个媒体查询将始终应用于 990px​​ 以下的屏幕，因为小于 990px​​ 的东西也小于 1360px，如果您明白我的意思...

# scons - 如何将 Scons 设置为在 sconstruct 所在的位置上方输出目录？

> ID：15815909
> 
> 赞同：1
> 
> 时间：2013-04-04T15:50:25.207
> 
> 标签：scons

我有一个类似于以下的文件夹结构：

项目
-----src
--------lib
-----bin
--------Debug
-----scons

我的 sconstruct 和 sconscripts 在“scons”文件夹中。我想做的是从我的 lib 文件夹中获取构建输出并将其放入 bin/debug 文件夹中。我试过做这样的事情：

**构造：**

```
VariantDir('../bin/Debug','.')
lib = SConscript('libSconscript') 
```

**应征者：**

```
env.StaticLibrary('../bin/Debug/lib', Glob('../src/lib/*.cpp')) 
```

但这似乎不起作用。从手册页中，听起来 VariantDir() 会像我所做的那样工作，但似乎没有。如果有的话，它要么根本不构建，要么构建在当前目录中。有人指出我做错了什么吗？

如果有任何令人困惑的地方，我深表歉意。在 sconscript 中跟踪所有这些目录比人们想象的要困难得多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:37:22.327

目前 SCons 不支持这个。SConstruct 必须位于项目的根级别。也就是说，您需要执行以下操作：

```
Project
-----SConstruct
-----src
--------lib
-----bin
--------Debug 
```

# c# - 应用程序 CTRL-C 信号只工作一次

> ID：15815910
> 
> 赞同：0
> 
> 时间：2013-04-04T15:50:25.407
> 
> 标签：c#, console

我遇到了一个相当奇怪的问题，我无法通过 Google 搜索出来。

在一些几乎没有意义的学校演示程序上工作，我需要有一个工作循环来处理它的业务，直到它被一个 CTRL-C 信号中断，然后运行一些其他功能。完成后，程序会从上次中断的地方恢复它的前一个工作循环。

一切都很好，新的按键事件是这样完成的：

```
Console.TreatControlCAsInput = false;
Console.CancelKeyPress += new ConsoleCancelEventHandler(interrupt); 
```

当按下 CTRL-C 时，“中断”方法被正确调用并执行......一次。

当它通过时，我似乎完全无法通过中断信号再次调用它。任何后续的 CTRL-C 按键都将被完全忽略。

“中断”方法以 .Join 结尾以与其父线程合并，因为事件处理程序出于某种原因在单独的线程上运行。

是什么阻止我根据需要多次调用中断方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:54:01.677

`Thread.Join`不会“合并”线程。它阻塞当前线程，直到另一个线程完成。当您加入主线程时，这将永远不会发生，直到程序退出。

只需完全删除该呼叫。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T15:56:16.677

您是否将[`Cancel`](http://msdn.microsoft.com/en-gb/library/system.consolecanceleventargs.cancel.aspx)属性设置为`true`适当？这对我有用：

```
using System;
using System.Threading;

class Test
{
    static void Main()
    {
        Console.TreatControlCAsInput = false;
        Console.CancelKeyPress += (sender, args) => {
            // We want to keep going...
            args.Cancel = true;
            Console.WriteLine("Handler called");
        };
        Console.WriteLine("Go for it!");
        for (int i = 0; i < 10; i++)
        {
            Console.WriteLine(i);
            Thread.Sleep(1000);
        }
    }
} 
```

目前尚不清楚您的线程是什么样的 - 根据丹尼尔的回答，这很可能是另一个不正确的方面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T15:57:05.557

[Console.TreatControlCAsInput](http://msdn.microsoft.com/en-us/library/system.console.treatcontrolcasinput.aspx)看起来不应该设置为 false：

> 如果 Ctrl+C 被视为普通输入，则为 true；否则为假。

# javascript - 调试一个简单的 JavaScript 代码

> ID：15815914
> 
> 赞同：4
> 
> 时间：2013-04-04T15:50:37.087
> 
> 标签：javascript

开始学习 Javascript，我在 FireFox 的 FireBug 中写了这样的东西：

```
var myObject = {
"first_name" : "Rick",
"last_name" : "Hummer"
};

var name;
for (name in myObject) {
if(typeof myObject[name] != 'function') {
  (name + ' : ' + myObject[name])
}

} 
```

当我运行它时，它只显示姓氏，它不应该也列出名字吗？

另外，我怎样才能放置断点并进行调试呢？

![在此处输入图像描述](https://i.stack.imgur.com/M3Q1v.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:53:52.037

您没有告诉浏览器输出这些值。

默认情况下，它会写出最后执行的行的结果，即`(name + ' : ' + myObject[name])`

要解决这个问题，只需添加`console.log`：

```
var myObject = {
"first_name" : "Rick",
"last_name" : "Hummer"
};

var name;
for (name in myObject) {
  if(typeof myObject[name] != 'function') {
    console.log(name + ' : ' + myObject[name]);
  }
} 
```

适用于 Firefox 19： ![演示](https://i.stack.imgur.com/bGWHi.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T15:53:28.737

您有一个不做任何事情的语句，它构建一个字符串但不使用它。调试器可能只是向您显示最后执行的语句。

改变

```
(name + ' : ' + myObject[name]) 
```

到：

```
console.log(name + ' : ' + myObject[name]) 
```

您应该会看到两个键都出现在日志中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T16:14:47.567

此外，对于调试，您应该在要放置断点的行处简单地编写“调试器”（不带任何引号）。据我所知，所有浏览器都支持该声明。

# selenium - 通过 selenium 设置 userAgent 会引发异常

> ID：15815924
> 
> 赞同：0
> 
> 时间：2013-04-04T15:51:16.270
> 
> 标签：selenium, selenium-webdriver

我最近将我的 selenium 从 2.19.0 更新到了 2.31.0。我在设置 userAgent 以进行测试时遇到问题。这是代码：

```
void testMessage() {
    verifySomething(this.driver, "iPhone");
}

void verifySomething(WebDriver driver, String userAgent) {
    String script = null;
    if (driver instanceof HtmlUnitDriver) {
        script = "navigator.userAgent=" + "'" + userAgent + "';";
    }
    else {
        // something
    }
    ((JavascriptExecutor) driver).executeScript(script);
} 
```

我收到以下错误：

> ======= 异常开始 ========

```
EcmaError: lineNumber=[1] column=[0] lineSource=[] name=[TypeError] sourceName=[injected script] message=[TypeError: Cannot set property [Navigator].userAgent that has only a getter to iPhone. (injected script#1)]
com.gargoylesoftware.htmlunit.ScriptException: TypeError: Cannot set property [Navigator].userAgent that has only a getter to iPhone. (injected script#1)
at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:663)
                at net.sourceforge.htmlunit.corejs.javascript.Context.call(Context.java:559)
                at net.sourceforge.htmlunit.corejs.javascript.ContextFactory.call(ContextFactory.java:525)
                at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.callFunction(JavaScriptEngine.java:594)
                at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.callFunction(JavaScriptEngine.java:569)
                at com.gargoylesoftware.htmlunit.html.HtmlPage.executeJavaScriptFunctionIfPossible(HtmlPage.java:996)
                at org.openqa.selenium.htmlunit.HtmlUnitDriver.executeScript(HtmlUnitDriver.java:466)
...
... 
```

== 调用 JAVASCRIPT ==

```
 function () {
      navigator.userAgent = "iPhone";
  }

======= EXCEPTION END ======== 
```

我知道它在抱怨二传手。它曾经在 selenium 2.19.0 中工作，但我猜他们可能已将属性更改为只读。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:59:50.740

您不能在 navigator.userAgent 中设置任何内容。

navigator.UserAgent 只是有关您当前浏览器的信息。

[http://www.w3schools.com/jsref/prop_nav_useragent.asp](http://www.w3schools.com/jsref/prop_nav_useragent.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T12:17:04.180

对于 FF 使用这个 (profile.setPreference("general.useragent.override", "your useragent") 一切都需要从 firefox 配置文件进行设置。

# regex - 用清漆+正则表达式替换页面中的内容

> ID：15815926
> 
> 赞同：5
> 
> 时间：2013-04-04T15:51:26.397
> 
> 标签：regex, caching, webserver, varnish, varnish-vcl

如果我希望我的清漆缓存服务器在提供或存储页面（vcl_fetch？）之前从后端替换页面内的内容（即：更改 div 上的类），如何做到这一点？

我想使用简单的正则表达式来执行替换，因为我想它在清漆中本机支持。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T07:26:14.650

Varnish 本身不支持修改响应正文。为此，您需要一个 Varnish 模块 (vmod)。

Aivars Kalvans 有[libvmod-rewrite](https://github.com/aivarsk/libvmod-rewrite)，它完全符合您的要求。然而，vmod 是一个概念证明，根据 Aivars 的说法，它还没有准备好用于生产。在任何情况下，您都可以将其用作起点。

如果您使用的是 Apache，您可以使用[mod_ext_filter](http://httpd.apache.org/docs/2.2/mod/mod_ext_filter.html)来修改响应正文。这是 mod_ext_filters 文档中的一个示例。由于您可以将响应正文传递给任何外部命令，因此很容易对内容进行必要的修改。

```
# mod_ext_filter directive to define a filter which
# replaces text in the response
#
ExtFilterDefine fixtext mode=output intype=text/html cmd="/bin/sed s/verdana/arial/g"

<Location />
# core directive to cause the fixtext filter to
# be run on output
SetOutputFilter fixtext
</Location> 
```

# jquery - 控制台消息未显示

> ID：15815927
> 
> 赞同：0
> 
> 时间：2013-04-04T15:51:26.353
> 
> 标签：jquery, json, jsonp

我目前正在使用 jQuery JSONP 加载 csv 文件作为图形数据源。这是我的代码：

```
var query= "http://abc.123.com/somefile.csv"
$.ajax({
     url:query,
     dataType:'jsonp'
}).done(function(msg){
     console.log("done");
     for (vari=0; i<5; i++){
          drwaChart(i);
     }
}); 
```

不知何故，控制台没有显示上面代码的“完成”，但会显示“完成”：

```
var query= "http://abc.123.com/somefile.csv"
$.ajax({
    url:query,
    dataType:'jsonp'
}).done(console.log("done")); 
```

任何人都可以提供有关此问题的一些信息吗？因为我什至不确定此时数据是否已加载...

谢谢！

（修正了“”错字..我在这里复制代码时打错了..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T15:58:17.953

问题是您以 a 开头数据类型并以导致被解释为 a 的a`'`关闭它。简单的错误，容易修复:)`"``console.log()``string`

**正确代码：**

```
var query= "http://abc.123.com/somefile.csv"
$.ajax({
     url:query,
     dataType:'jsonp'
}).done(function(data){ 
     console.log("done");
     for (vari=0; i<5; i++){
          drwaChart(i);
     }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:27:02.967

好吧，在你说的第一个代码中

```
.done(function(msg){console.log("done");....} 
```

console.log 命令位于包装函数内，只有在成功接收到结果时才会执行，否则它不会运行 console.log，并且由于您错误地使用了“json”而不是“json”，（使用单引号）你的调用没有成功（你可能在服务器端将结果发送回 jquery 时也有一些错误）。因此，你的 .done 没有被执行。

但是，在第二个代码中，它不会检查成功条件，因为您可能没有包装函数。因此，它运行 console.log。用包装函数检查第二个代码，看看结果如何。

# java - 带有 EOFException 的 Java 流

> ID：15815928
> 
> 赞同：0
> 
> 时间：2013-04-04T15:51:30.393
> 
> 标签：java, objectinputstream, objectoutputstream, eofexception

我写了一些客户端-服务器程序，它共享数据，但在服务器端我`EOFException`在接收数据后得到。我试图自己修复它，但很难找到自己的错误。

错误是由这一行引起的：`Message command =(Message) serInputStream.readObject();`

这是服务器的一些输出：

```
 java.io.EOFException

at Java.io.ObjectInputStream$BlockDataInputStream.peekByte(ObjectInputStream.java:2577)
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1315)
at java.io.ObjectInputStream.readObject(ObjectInputStream.java:369)
at transfer.Serwerus.run(Serwerus.java:42) 
```

服务器代码：

```
import java.io.*;
import java.net.*;

public class Serwerus implements Runnable
{
public InputStream is;
public FileOutputStream fos;
public BufferedOutputStream bos;
public ObjectOutputStream serOutputStream;
public ObjectInputStream serInputStream;
ServerSocket socket;
private String clientMessage, clientFileName;
private int clientFileSize;

public Serwerus()
{
    try
    {
        socket = new ServerSocket(6060);
        System.out.println("Server started....");
    }
    catch(IOException e)
    {
        System.err.println("Error: " + e);
        e.printStackTrace();
    }
}

@Override
public void run()
{
    try 
        {
            Socket sock = socket.accept();
            System.out.println("Client accepted");
            serOutputStream = new ObjectOutputStream(sock.getOutputStream());
            serInputStream = new ObjectInputStream(sock.getInputStream());
          while (true) 
          {
              Message command =(Message) serInputStream.readObject();
              System.out.println("after readObject");
              if (command.getCommand().startsWith("FileU")) 
              {
                  System.out.println("Name = " + command.getfileName() + ", size= " + command.getfileSize());
                  serOutputStream.writeObject(new Message("Bring", "", 0));
                  //ReciveData(socket, command.getfileName(), command.getfileSize());
              }
              else if(command.getCommand().startsWith("Wait"))
              {
                  System.out.println("hohoho");
                  ReciveData(sock, command.getfileName(), command.getfileSize());
              }
              else if(command.getCommand().startsWith("Quit"))
              {
                  System.exit(1);
              }
              else
              {
                  System.out.println("Unknow");
              }
          }
        }
        catch(ClassNotFoundException | IOException ex)
        {
            ex.printStackTrace();
        } 
        finally 
        {
            try 
            {
                serInputStream.close();
                serOutputStream.close();
                socket.close();
            } 
            catch (IOException e) 
            {
                System.err.println("Fallen on closing socket.\n Error: " + e);
            }
        }
}

public void SendData(Socket sock, String filePath) throws Exception
{
    File myFile = new File (filePath);
    System.out.println("File name = " + myFile.getName() + " File len = " + (int)myFile.length());
    byte [] mybytearray  = new byte [(int)myFile.length()];
    FileInputStream fis = new FileInputStream(myFile);
    BufferedInputStream bis = new BufferedInputStream(fis);
    bis.read(mybytearray,0,mybytearray.length);
    OutputStream os = sock.getOutputStream();
    System.out.println("Sending...");
    os.write(mybytearray,0,mybytearray.length);
    os.flush();
    sock.close();
    System.out.println("Sending finished");
}

public void ReciveData(Socket sock, String filePath, int fileSize)
{
    System.out.println("Recive in progress, filesize = " + fileSize);
    int bytesRead = 0, current = 0;
    byte[] array = new byte[fileSize];

    try 
    {

        is = sock.getInputStream();
        FileOutputStream fos = new FileOutputStream(filePath);
        bos = new BufferedOutputStream(fos);
        do
        {
            System.out.println(bytesRead);
            bytesRead = is.read(array);
            current += bytesRead;
        }
        while(bytesRead > -1);

        bos.write(array, 0 , current);
        bos.flush();
        bos.close();
        fos.close();
       // sock.close();
        System.out.println("Reciveing finished");
    } 
    catch (IOException ex) 
    {
        ex.printStackTrace();
    }
}

 public static void main (String [] args ) throws IOException 
 {
     new Thread(new Serwerus()).start(); 
 }
} 
```

客户端代码：

```
import java.io.*;
import java.net.*;

public class Clientus implements Runnable
{
    InputStream is;
    FileOutputStream fos;
    BufferedOutputStream bos;
    ObjectOutputStream cliOutputStream;
    ObjectInputStream cliInputStream;
    Socket socket;
    File actFile;
    private String serverMessage, serverFileName;
    private int serverFileSize;

    public Clientus()
    {
        try 
        {
            socket = new Socket("localhost", 6060);
            cliOutputStream = new ObjectOutputStream(socket.getOutputStream());
            cliInputStream = new ObjectInputStream(socket.getInputStream());
            File file = new File(<filepath>);
            actFile = file;
        } 
        catch (Exception e) 
        {
            System.err.println("Error: " + e);
            e.printStackTrace();
        }
    }

    @Override
    public void run()
    {
        try 
            {   
                cliOutputStream.writeObject(new Message("FileU", actFile.getPath(), (int) actFile.length()));
                cliOutputStream.flush();
              //while (true) 
              //{
                  Message command =(Message) cliInputStream.readObject();
                  if (command.getCommand().startsWith("File")) 
                  {
                      String name = command.getfileName();
                      int size = command.getfileSize();
                      System.out.println("Name = " + command.getfileName() + ", size= " + command.getfileSize());
                      if(size != 0 && !"".equals(name))
                      {
                          //ReciveData(socket, 0);
                      }
                  }
                  else if(command.getCommand().startsWith("Bring"))
                  {
                      cliOutputStream.writeObject(new Message("Wait", "D:\\KP2\\Serwer\\dupa.txt",(int) actFile.length()));
                      cliOutputStream.flush();
                      try 
                      {
                          SendData(socket, actFile.getPath());
                          //this.socket.close();
                      } 
                      catch (Exception ex) 
                      {
                         System.err.println("Error with: SendData()");
                      }
                  }
                  else if(command.getCommand().startsWith("Quit"))
                  {
                      System.exit(1);
                  }
                  else
                  {
                      System.out.println("Command unknown");
                  }
              //}
            }
            catch(ClassNotFoundException | IOException ex)
            {
                ex.printStackTrace();
            } 
            finally 
            {
                try 
                {
                    socket.close();
                    cliOutputStream.close();
                    cliInputStream.close();
                } 
                catch (IOException e) 
                {
                    System.err.println("Fallen on closing socket.\n Error: " + e);
                }
            }
    }

    public void SendData(Socket sock, String filePath) throws Exception
    {
        byte [] mybytearray  = new byte [(int) new File(filePath).length()];
        FileInputStream fis = new FileInputStream(filePath);
        BufferedInputStream bis = new BufferedInputStream(fis);
        bis.read(mybytearray,0,mybytearray.length);
        OutputStream os = sock.getOutputStream();
        System.out.println("Sending...");
        os.write(mybytearray,0,mybytearray.length);
        fis.close();
        bis.close();
        os.close();
        System.out.println("Sending finished");
    }

    public void ReciveData(Socket sock, String fileName, int fileSize)
    {
        int bytesRead, current = 0;
        byte[] array = new byte[fileSize+1];
        try 
        {
            is = sock.getInputStream();
            fos = new FileOutputStream(<file_path>);

            bos = new BufferedOutputStream(fos);
            bytesRead = is.read(array,0,array.length);

            current = bytesRead;
            do
            {
                bytesRead = is.read(array, current, (array.length - current));
                if(bytesRead >= 0)
                    current += bytesRead;
            }
            while(bytesRead > -1);

            bos.write(array, 0 , current);
            bos.flush();

            long end = System.currentTimeMillis();

            //System.out.println("Send time: " + (end - start));
            bos.close();
            sock.close();
            System.out.println("Reciveing finished");
        } 
        catch (IOException ex) 
        {
            ex.printStackTrace();
        }
    }

    public static void main (String [] args ) throws IOException 
    {
        new Thread(new Clientus()).start();
    }
} 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T16:08:51.203

您的客户端在发送数据后可能会断开连接，并且由于您的服务器正在等待更多数据，因此`EOFException`会发生这种情况。

要解决此问题，您可以添加`try-catch`块以在客户端断开连接时捕获此异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:18:23.997

您正在使用`ObjectOutputStream`套接字和套接字自己的`OutputStream`来发送数据，并且您正在不同步。当您直接通过套接字发送原始数据时，您不会先发送长度，因此接收方不知道有多少字节属于此传输。事实上，它只是在 EOS 之前读取所有内容，所以下次你调用`ObjectInputStream.readObject()`它时自然会得到 EOFException。要解决这个问题：

1.  将`ObjectInputStream`and`ObjectOutputStream`用于*一切*。
2.  在发送文件之前，发送它的长度，通过`writeLong().`
3.  在接收端，当接收到文件时，首先获取它的长度，`readLong(),`然后从 中读取那么多字节`ObjectInputStream`并将它们复制到文件中。

# php - 最后一行解析错误

> ID：15815933
> 
> 赞同：0
> 
> 时间：2013-04-04T15:51:58.173
> 
> 标签：php, html

我已经更正并清理了以前的代码、php 和 html .. 我在最后一行遇到解析错误.. 我不知道出了什么问题.. 另外，网站让我为帖子添加无用的文本，所有回复都值得赞赏。谢谢

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
</head>

<body>

<?php
if(isset($_POST['email'])) {

    // EDIT THE 2 LINES BELOW AS REQUIRED
    $email_to = 'xxx.com, ';
    $email_subject = "xxx Questons";

    function died($error) {
        // your error code can go here
        echo "We are very sorry, but there were error(s) found with the form you submitted. ";
        echo "These errors appear below.<br /><br />";
        echo $error."<br /><br />";
        echo "Please go back and fix these errors.<br /><br />";
        die();
    }

    // validation expected data exists
    if(!isset($_POST['email']) ||    
       !isset($_POST['comments'])) 
    {
        died('We are sorry, but there appears to be a problem with the form you submitted.');       
    }

    $name = $_POST['name']; // not required

    $email_from = $_POST['email']; // required
    $comments = $_POST['comments']; // required

    $error_message = "";
    $email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
  if(!preg_match($email_exp,$email_from)) {
    $error_message .= 'The Email Address you entered does not appear to be valid.<br />';
  }
    $string_exp = "/^[A-Za-z .'-]+$/";

    if(strlen($comments) < 2) {
    $error_message .= 'The Comments you entered do not appear to be valid.<br />';
  }
  if(strlen($error_message) > 0) {
    died($error_message);
  }
    $email_message = "Form details below.\n\n";

    function clean_string($string) {
      $bad = array("content-type","bcc:","to:","cc:","href");
      return str_replace($bad,"",$string);
    }

    $email_message .= "Name: ".clean_string($name)."\n";

    $email_message .= "Email: ".clean_string($email_from)."\n";

    $email_message .= "Comments: ".clean_string($comments)."\n";     

// create email headers
$headers = 'From: '.$email_from."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();
@mail($email_to, $email_subject, $email_message, $headers);  
?>

<!--include your own success html here -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>

<head>

<meta http-equiv="Refresh" content="10; URL=xxxx"> 
 <title>xxx xxcx xxx</title>
 <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="no" />

      <meta name="MSSmartTagsPreventParsing" content="true" />

    <meta name="description" content="xxxsxxx xxx. " />

    <meta name="keywords" content="orchids, xxx, Orchid judging, xxx" /><style type="text/css" media="all">@import "css/master.css";</style>
</head>
<body> 
<p><div id="textbox"><br><br>

<center><h1>Thank you for contacting us. <br />
We will be in touch with you very soon.</h1>

<br><br>  

Please wait 10 seconds and you will be transferred to the next page or <a href=http:xxxindex.html><font color="#0000ff">click here</font></a> to go now!</center>

<p><center>Please visit our website <a href="xxx"><i>www.</i></a> to learn more <br />
    about the xxx</center>
<p>&nbsp;</p>
</div>    
</div>
</div> 

</body>
</html>
 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T15:53:10.147

您在`}`PHP 代码的末尾缺少一个结束

最初的开口`{`来自这一行：

```
if(isset($_POST['email'])) { 
```

所以，在`mail`函数之后，添加另一个`}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:56:29.937

改变：

```
// create email headers
$headers = 'From: '.$email_from."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();
@mail($email_to, $email_subject, $email_message, $headers); 
```

到

```
 // create email headers
    $headers = 'From: '.$email_from."\r\n".
    'Reply-To: '.$email_from."\r\n" .
    'X-Mailer: PHP/' . phpversion();
    @mail($email_to, $email_subject, $email_message, $headers);  
} // 
```

# f# - F# OleDb 语法错误在 INSERT INTO 语句中将数据从访问中提取到链接的 SQL Server

> ID：15815934
> 
> 赞同：2
> 
> 时间：2013-04-04T15:52:01.310
> 
> 标签：f#, sql-server-2008-r2, oledb, ms-access-2010, insert-into

我正在运行 F# 应用程序以将数据从 Access 表中提取到链接的 SQL Server 表中。这是结果查询：

```
INSERT INTO dbo_TempTerm (UnitID, PolicyTermYear, InsuredName, PolicyNumber, RenewalDate, CovATotal, CovBTotal, CovLTotal, DwellExtn, AllOtherPerilDeductible, MedPay, TotalPremium, HurricaneDeductible, Zone, Subzone, PercentCRC, PercentCRD, YearBuilt, RenYrs, PercentCFD, PercentHA, PercentMLD, GRP1, PercentNH, QCLM, RateV, CRI, AgentCode, AgentName, AFOCode, PolicyType, PolicyForm, OC, DateCreated)
SELECT [UNIT ID], [POLICY TERM YEAR], [INSURED NAME], [POLICY #], [RENEWAL DT], [COV A TOTAL], [COV B TOTAL], [COV L TOTAL], [DWELL EXTN], [ALL/OTHER PERIL DEDUCTIBLE], [MED PAY], [TOT PREMIUM], [HURR DED], ZONE, SUBZONE, [%CRC], [%CRD], [YR BLT], RENYRS, [%CFD], [%HA], [%MLD], GRP1, [%NH], QCLM, [RATE V], CRI, [AGENT CODE], [AGENT NAME], [AFO CODE], [POLICY TYPE], [POLICY FORM], OC, DateCreated
FROM tblPrior 
```

查询在 Access 中解析并运行良好。但是在我的应用程序中，它引发了一个错误：INSERT INTO 语句中的语法错误。

这是我的 F#，尽管我认为这无关紧要。

```
module Data

open System.Data
open System.Data.OleDb

type Period = Prior | Current

let Upload (p:Period) db =
    use conn = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + db + ";Persist Security Info=False;")

    let execNonQuery s =
        let comm = new OleDbCommand(s, conn) in
        comm.ExecuteNonQuery() |> ignore

    let (table,proc) = match p with
                       | Prior   -> ("tblPrior"  ,"InitPriorTable")
                       | Current -> ("tblCurrent","InitCurrentTable")

    do conn.Open()

    let u = sprintf "INSERT INTO dbo_TempTerm (UnitID, PolicyTermYear, InsuredName, PolicyNumber, RenewalDate, CovATotal, CovBTotal, CovLTotal, DwellExtn, AllOtherPerilDeductible, MedPay, TotalPremium, HurricaneDeductible, Zone, Subzone, PercentCRC, PercentCRD, YearBuilt, RenYrs, PercentCFD, PercentHA, PercentMLD, GRP1, PercentNH, QCLM, RateV, CRI, AgentCode, AgentName, AFOCode, PolicyType, PolicyForm, OC, DateCreated) SELECT [UNIT ID], [POLICY TERM YEAR], [INSURED NAME], [POLICY #], [RENEWAL DT], [COV A TOTAL], [COV B TOTAL], [COV L TOTAL], [DWELL EXTN], [ALL/OTHER PERIL DEDUCTIBLE], [MED PAY], [TOT PREMIUM], [HURR DED], ZONE, SUBZONE, [%%CRC], [%%CRD], [YR BLT], RENYRS, [%%CFD], [%%HA], [%%MLD], GRP1, [%%NH], QCLM, [RATE V], CRI, [AGENT CODE], [AGENT NAME], [AFO CODE], [POLICY TYPE], [POLICY FORM], OC, DateCreated FROM %s" table
    // DEBUG.
    printfn "%s" u
    // DEBUG.
    execNonQuery u
    execNonQuery proc 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T18:38:12.510

`Zone`并且`DateCreated`都是[保留字](http://allenbrowne.com/AppIssueBadWord.html)。很难预测保留字何时会给 SQL 语句带来麻烦，但在我看来，OleDb 可能不太宽容，即保留字更有可能失败。查看是否将所有这些名称的出现括起来将允许`INSERT`成功。

```
let u = sprintf "INSERT INTO dbo_TempTerm (UnitID, PolicyTermYear, InsuredName, PolicyNumber, RenewalDate, CovATotal, CovBTotal, CovLTotal, DwellExtn, AllOtherPerilDeductible, MedPay, TotalPremium, HurricaneDeductible, [Zone], Subzone, PercentCRC, PercentCRD, YearBuilt, RenYrs, PercentCFD, PercentHA, PercentMLD, GRP1, PercentNH, QCLM, RateV, CRI, AgentCode, AgentName, AFOCode, PolicyType, PolicyForm, OC, [DateCreated]) SELECT [UNIT ID], [POLICY TERM YEAR], [INSURED NAME], [POLICY #], [RENEWAL DT], [COV A TOTAL], [COV B TOTAL], [COV L TOTAL], [DWELL EXTN], [ALL/OTHER PERIL DEDUCTIBLE], [MED PAY], [TOT PREMIUM], [HURR DED], [ZONE], SUBZONE, [%%CRC], [%%CRD], [YR BLT], RENYRS, [%%CFD], [%%HA], [%%MLD], GRP1, [%%NH], QCLM, [RATE V], CRI, [AGENT CODE], [AGENT NAME], [AFO CODE], [POLICY TYPE], [POLICY FORM], OC, [DateCreated] FROM %s" table 
```

# android - 安卓模拟器没有键盘

> ID：15815936
> 
> 赞同：0
> 
> 时间：2013-04-04T15:52:12.843
> 
> 标签：android, adt, avd

我下载了适用于 linux 的 ADT Bundle，但它没有在右侧显示键盘，也无法识别我的键盘。如果我签入 AVD“硬件键盘存在”中的选项，那么会提供相同的结果。在 hardware-properties.ini 文件中，我发现了这个：

```
# Keyboard support (qwerty/azerty)
name        = hw.keyboard
type        = boolean
default     = no
abstract    = Keyboard support
description = Whether the device has a QWERTY keyboard. 
```

如果我将“默认”更改为是，那么也不会发生任何事情。我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:26:24.350

编辑您的模拟器`.ini`文件（它应该在 中的某处`~/.android/avd/`）并添加如下行：

```
hw.keyboard=yes 
```

# scala - Scala 2.10 风暴项目 ClassNotFoundException

> ID：15815948
> 
> 赞同：2
> 
> 时间：2013-04-04T15:52:49.247
> 
> 标签：scala, apache-storm

我怀疑这可能是某种版本控制问题，但仍然无法深究。我正在尝试使用基于[https://github.com/velvia/ScalaStorm](https://github.com/velvia/ScalaStorm)的 Scala DSL 在 Scala 2.10 中设置 play2.1/storm 项目。我将 DSL 文件复制并编辑到我的项目中。我的问题是在尝试从同一个项目中实现 WordCountTopology 示例时出现的。示例的直接复制/粘贴可以正常编译，并且 eclipse 不会抱怨任何事情，但是在运行 main 函数时，我得到了 classNotFoundExceptions

这些类被明确定义，并注释掉使用它们的行（builder.setSpout 和 builder.setBolt 行）并创建 ClassNotFound 类的新对象（RichStormSpout、WordCount、SplitSentence），尽管它没有做任何事情，编译并运行得很好。

任何帮助深表感谢

编辑：这是一个堆栈跟踪：

```
│java.lang.RuntimeException: java.lang.ClassNotFoundException: storm.WordCount                                                                     
│        at backtype.storm.utils.Utils.deserialize(Utils.java:70) ~[storm-0.8.2.jar:na]                                                                                              
│        at backtype.storm.utils.Utils.getSetComponentObject(Utils.java:199) ~[storm-0.8.2.jar:na]                                                                                                               
│        at backtype.storm.daemon.task$get_task_object.invoke(task.clj:56) ~[storm-0.8.2.jar:na]                                                                                      
│        at backtype.storm.daemon.task$mk_task_data$fn__3766.invoke(task.clj:158) ~[storm-0.8.2.jar:na]                                                                               
│        at backtype.storm.util$assoc_apply_self.invoke(util.clj:731) ~[storm-0.8.2.jar:na]                                                                                           
│        at backtype.storm.daemon.task$mk_task_data.invoke(task.clj:152) ~[storm-0.8.2.jar:na]                                                                                        
│Caused by: java.lang.ClassNotFoundException: storm.WordCount                                                                                                                         
│        at java.net.URLClassLoader$1.run(URLClassLoader.java:202) ~[na:1.6.0_35]                                                                                                     
│        at java.security.AccessController.doPrivileged(Native Method) ~[na:1.6.0_35]                                                                                                 
│        at java.net.URLClassLoader.findClass(URLClassLoader.java:190) ~[na:1.6.0_35]                                                                                                 
│        at java.lang.ClassLoader.loadClass(ClassLoader.java:306) ~[na:1.6.0_35]                                                                                                      
│        at java.lang.ClassLoader.loadClass(ClassLoader.java:247) ~[na:1.6.0_35]                                                                                                      
│        at sbt.PlayCommands$$anonfun$53$$anonfun$55$$anon$2.loadClass(PlayCommands.scala:535) ~[na:na] 
```

# puppet - Puppet：自定义资源中的 if 语句

> ID：15815955
> 
> 赞同：1
> 
> 时间：2013-04-04T15:53:23.653
> 
> 标签：puppet

我正在尝试编写一个遍历数组以创建和维护应用程序用户的清单。用户列表通过以下方式从 init.pp 传递到清单：

```
$app_users = [ at1,et1,at2,et2 ] 
```

users.pp 清单然后读取数组以创建用户：

```
 define appuser {
    user { $name:  
    ensure           => 'present',
    comment          => "Application User - $name",
    gid              => 'app',
    home             => "/apps/$app/$name",
    shell            => '/usr/bin/bash',
  }
 }

 appuser  { $app_users: } 
```

该解决方案与我编写的另一个模块配合得很好，但在这种情况下，主目录路径包含一个变量，该变量取决于用户名。

在资源中添加以下 if 语句会引发错误：

```
if $name =~ /^(et|ep)/ {
 $app = "echos"
 notice('app is $app')
 }

Syntax error at 'if'; expected '}' at .../users.pp:9 
```

我在某处读到您不能在资源中放置 if 语句...

在这种情况下，我有什么选择？我遇到了编码障碍...

我们使用的是 puppet master 版本 2.7.19 (Puppet Enterprise 2.7.0)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T16:15:11.280

听起来这只是一个语法错误，你应该在定义中添加你的 if 语句，比如

```
define appuser {

    if $name =~ /^(et|ep)/ {
      $app = "echos"
      notice('app is $app')
    }

    user { $name:  
    ensure           => 'present',
    comment          => "Application User - $name",
    gid              => 'app',
    home             => "/apps/$app/$name",
    shell            => '/usr/bin/bash',
  }
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T17:00:13.437

在这种情况下，我更喜欢`case`if 语句，例如，

```
 define appuser {
        user { $name:  
        ensure           => 'present',
        comment          => "Application User - $name",
        gid              => 'app',
        home => $name ? { 
        '/^(et|ep)/' => "/apps/echos/$name",
         default => "/apps/$app/$name",},
        shell            => '/usr/bin/bash',
      }
   } 
```

# php - 在 PHP 中订购 XML foreach 结果

> ID：15815956
> 
> 赞同：0
> 
> 时间：2013-04-04T15:53:27.640
> 
> 标签：php, xml, foreach, simplexml

这是我的代码，它显示了我所追求的结果，但是否可以按顺序列出它们或

```
 $xml = simplexml_load_file('racing.xml');

    foreach ($xml->sport[0]->event_path->event_path as $gameinfo):

    $description        =   $gameinfo->description;
    $getdate            =   $gameinfo->event['date'];
    $event_id           =   $gameinfo->event['id'];
    $date               =   substr($getdate,0,10); 
```

编码

```
 <?=substr($description, -5)?> 
```

给我留下了变量作为时间，即：14:40、15:50:14:20:18:40 等，但它们按 XML 的顺序而不是按时间显示。

我可以包含一行代码来按日期变量对结果进行排序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:07:50.417

PHP具有非常有用的排序功能，可以定义用户比较功能。见链接：[http ://www.php.net/manual/en/function.uasort.php](http://www.php.net/manual/en/function.uasort.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:18:42.777

首先是一些改进代码的一般提示：

```
foreach ($xml->sport[0]->event_path->event_path as $gameinfo): 
```

是个坏主意。取而代之的是，我给自己做了一个礼物，并给了一个新的变量（稍后你可以感谢我）：

```
$gameinfos = $xml->sport[0]->event_path->event_path;
foreach ($gameinfos as $gameinfo): 
```

所以现在你想对`$gameinfos`. 这里的问题是那些是迭代器而不是数组。该`uasort`函数（以及所有其他数组排序函数）不会进一步帮助您。幸运的是，这[已经被概述了](https://stackoverflow.com/a/12761317/367456)，您可以将迭代转换为数组：

```
$gameinfos = iterator_to_array($gameinfos, FALSE); 
```

现在`$gameinfos`是一个可以排序的数组。为此，获取定义排序顺序的值（`$gameinfos`应该对其进行排序），我假设这是`substr($description, -5)`您在上面写的时间：

```
$order = array();
foreach ($gameinfos as $game) 
    $order[] = substr($game->description, -5)
;

array_multisort($order, $gameinfos);

// $gameinfos are sorted now. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T09:08:16.973

谢谢你的时间！我现在有我的代码：

```
 $xml = simplexml_load_file('racing.xml');

    $gameinfos = $xml->sport[0]->event_path->event_path;
    foreach ($gameinfos as $gameinfo):

    $gameinfos = iterator_to_array($gameinfos, FALSE);

    $order = array();
    foreach ($gameinfos as $game) 
    $order[] = substr($game->description, -5) ;

    array_multisort($order, $gameinfos);

    // $gameinfos are sorted now.

    $description        =   $gameinfo->description;
    $getdate            =   $gameinfo->event['date'];
    $event_id           =   $gameinfo->event['id'];
    $date               =   substr($getdate,0,10); 
```

不过，这只会返回一个结果，我想我在某些地方出错了？

# oracle - oracle工作中的DELETE Collection方法错误

> ID：15815959
> 
> 赞同：0
> 
> 时间：2013-04-04T15:53:32.930
> 
> 标签：oracle, oracle11g

我想使用`DELETE Collection`Method 删除集合中的一些元素，例如：

```
create or replace procedure testloop3 (clearaaa out nestedtable) as
type nestedtable is table of varchar2(255);
reply_ref_messageIds nestedtable; 
getDelete_messageIds nestedtable;   
begin 
 select distinct r.messagebox_id bulk collect into reply_ref_messageIds from reply r;
 select m.id bulk collect into  getDelete_messageIds from messagebox m;
        getDelete_messageIds.delete(2);
   getDelete_messageIds.delete(4);
   getDelete_messageIds.delete(7);
    getDelete_messageIds.delete(11);
     getDelete_messageIds.delete(13);
    for i in getDelete_messageIds.FIRST .. getDelete_messageIds.LAST loop
  dbms_output.put_line(i);
end loop;
for i in 5 .. 12 loop
  dbms_output.put_line(i);
end loop;
end; 
```

然后我用 plsql dev 调试这个过程

```
-- Created on 2013/4/4 by THINKPAD 
declare 
  -- Local variables here
 aa nestedtable;
begin
  -- Test statements here
  testloop3(aa);
end; 
```

我得到了`getDelete_messageIds`删除前的索引，它们是 1 到 15。

但是：当我调试`getDelete_messageIds.delete(2);`它时，它会删除索引 1 和 2 ......我无法解释为什么。
然后当我调试下一条语句时`getDelete_messageIds.delete(4);`，它会删除索引 3 和 4。然后`getDelete_messageIds.delete(7);`只删除索引 7 ......
我无法理解......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:19:36.463

如发布的那样，您的程序没有显示任何此类内容。你只是像循环一样

```
for idx in 1..15 loop 
```

（.FIRST 将解析为 1，.LAST 将解析为 15）。这并不意味着 NT 中仍有 15 个元素。

您没有检查索引是否已删除。我认为您对遍历存在间隙的嵌套表的正确方法感到困惑。

即你可以看到元素被删除：

```
SQL> create table messagebox(id ) as select to_char(rownum) from dual connect by level <= 15;

Table created.

SQL> create or replace procedure testloop3
  2  as
  3    type nestedtable is table of varchar2(255);
  4    getDelete_messageIds nestedtable;
  5    v_idx number;
  6  begin
  7      select m.id bulk collect into  getDelete_messageIds from messagebox m;
  8      getDelete_messageIds.delete(2);
  9      getDelete_messageIds.delete(4);
 10      getDelete_messageIds.delete(7);
 11      getDelete_messageIds.delete(11);
 12      getDelete_messageIds.delete(13);
 13      v_idx := getDelete_messageIds.first;
 14      while v_idx is not null
 15      loop
 16        dbms_output.put_line(v_idx);
 17        v_idx := getDelete_messageIds.next(v_idx);
 18      end loop;
 19  end;
 20  /

Procedure created.

SQL> exec testloop3
1
3
5
6
8
9
10
12
14
15 
```

所以 2, 4, 7, 11, 13 被删除。完全符合预期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-02T06:22:49.847

你可以看到

```
DECLARE
   TYPE NumList IS TABLE OF NUMBER;
   n NumList := NumList(1,3,5,7);
   counter INTEGER;
BEGIN
   DBMS_OUTPUT.PUT_LINE('N''s first subscript is ' || n.FIRST);
   DBMS_OUTPUT.PUT_LINE('N''s last subscript is ' || n.LAST);
-- When the subscripts are consecutive starting at 1, 
-- it's simple to loop through them.
   FOR i IN n.FIRST .. n.LAST
   LOOP
      DBMS_OUTPUT.PUT_LINE('Element #' || i || ' = ' || n(i));
   END LOOP;
   n.DELETE(2); -- Delete second element.
-- When the subscripts have gaps
-- or the collection might be uninitialized,
-- the loop logic is more extensive.
-- Start at the first element
-- and look for the next element until there are no more.
   IF n IS NOT NULL THEN
      counter := n.FIRST;
      WHILE counter IS NOT NULL
      LOOP
         DBMS_OUTPUT.PUT_LINE
           ('Element #' || counter || ' = ' || n(counter));
         counter := n.NEXT(counter);
      END LOOP;
   ELSE
      DBMS_OUTPUT.PUT_LINE('N is null, nothing to do.');
   END IF;
END; 
```

参考[查找第一个或最后一个集合元素](http://docs.oracle.com/cd/B28359_01/appdev.111/b28370/collections.htm#i20453)

# sql - 如何只获取列的非数字部分

> ID：15815961
> 
> 赞同：0
> 
> 时间：2013-04-04T15:53:35.753
> 
> 标签：sql, sql-server

我有一个名为 TCODE 的列，其值类似于 5T、6545H、25 和 S4444。现在，我只想要返回的 4 行中的 3 行，以及这些列 T、H 或 S 的以下非数字位。表名是 CODES 。

伪代码 从 CODES 中选择 TCODE，在其中我去掉了那些存在数字和非数字混合的列的数字部分。

预期成绩

```
TCODE 
T
H
S 
```

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:37:00.770

在 SQL Server 中，您可以使用 PATINDEX：

```
SELECT SUBSTRING(TCODE,PATINDEX('%[^0-9]%', TCODE),1)
FROM CODES
WHERE PATINDEX('%[^0-9]%',TCODE) > 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:01:25.500

我想到的方式是相当野蛮的：

```
select replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(tcode, '0', ''),
                                                                               '1', 0),
                                                                       '2', 0),
                                                                '3', 0),
                                                       '4', 0),
                                               '5', 0),
                                       '6', 0),
                                '7', 0),
                         '8', 0),
                 '9', 0) as theletters
  . . . 
```

您可以将其放在子查询中，然后选择`where theletters <> ''`进行过滤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T16:12:33.307

一种选择：

```
with cte as
(select 0 n, replace(tcode,'0','') tcode from codes
 union all
 select n+1 n, replace(tcode,convert(varchar,n+1),'') tcode
 from cte
 where n<9)
select tcode from cte
where n=9 
```

[（这里](http://sqlfiddle.com/#!3/e7bfb/7)的 SQLFiddle ）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T16:14:57.363

您可以创建这样的功能

```
CREATE FUNCTION RemoveDigits(@strText VARCHAR(1000))
RETURNS VARCHAR(1000)
AS
BEGIN
    WHILE PATINDEX('%[0-9]%', @strText) > 0
    BEGIN
        SET @strText = STUFF(@strText, PATINDEX('%[0-9]%', @strText), 1, '')
    END
    RETURN @strText
END
GO 
```

然后使用它

```
SELECT dbo.RemoveDigits(TCODE) TCODE
  FROM CODES
 WHERE PATINDEX('%[^0-9]%', TCODE) > 0 
```

输出：

```
| TCODE |
---------
|     T |
|     H |
|     S | 
```

**[SQLFiddle](http://sqlfiddle.com/#!3/b8013/4)**

# php - 当我回显一个变量时，幕后会发生什么？

> ID：15815963
> 
> 赞同：2
> 
> 时间：2013-04-04T15:53:39.190
> 
> 标签：php, apache, echo

如果我的措辞有问题或者我的问题有点含糊，我很抱歉。

假设我有一个简单的脚本，它位于运行带有 mod_php 的 Apache 的 Ubuntu 机器上。这是我的整个脚本：

```
<?php
echo 'Hello, World!';
?> 
```

当我调用 echo 时会发生什么？文本是否被写入某处的缓冲区，然后在脚本结束时发送到客户端？我想掌握这样低水平的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:13:56.070

通常，脚本输出（注意我的措辞）在脚本解析期间直接发送到客户端。当您想在发送之前存储（读取：缓冲）输出时，您可以使用输出缓冲，就像已经提到的 Yazmat。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:57:01.833

我想你正在寻找这个：[输出缓冲](http://php.net/manual/en/book.outcontrol.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T16:07:29.393

我的想法是，当客户端调用服务器以查看其托管的 PHP 文件时，服务器将向客户端发送执行的 PHP 脚本，因此它不再是 PHP 脚本。

# qooxdoo - qooxdoo qx.Desktop : 将网格布局设置为全屏

> ID：15815969
> 
> 赞同：0
> 
> 时间：2013-04-04T15:53:59.880
> 
> 标签：qooxdoo

也许这是一个新手问题，如何将网格布局设置为全屏？

我当前的代码是：

```
 var container = new qx.ui.container.Composite().set({
        decorator: "main",
        backgroundColor: "yellow",
        allowGrowX: false,
        allowGrowY: false
    });
    var layout = new qx.ui.layout.Grid(2,2);
    layout.setSpacing(5);
    container.setLayout(layout);

    var w1 = new qx.ui.core.Widget();
    var w2 = new qx.ui.core.Widget();
    var w3 = new qx.ui.core.Widget();
    var w4 = new qx.ui.core.Widget();

    container.add(w1, {row: 0, column: 0});
    container.add(w2, {row: 0, column: 1});
    container.add(w3, {row: 1, column: 0});
    container.add(w4, {row: 1, column: 1});
    container.set({backgroundColor : "white"});
    this.getRoot().add(container, {edge: 0}); 
```

我错过了什么 ？它只占浏览器的一小部分。

ps 我正在处理`qx.Desktop`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T06:57:16.943

为了使网格布局占据全屏，我必须添加：

```
layout.setRowFlex(1, 1);
layout.setColumnFlex(1, 1); 
```

之后`var layout = new qx.ui.layout.Grid(2,2);`。

代码是将网格的宽度和高度设置为 Grid Layour 灵活的 (1,1)。对于函数`setRowFlex()`or `setColumnFlex()`，第一个参数是网格的索引，而第二个参数设置网格是否具有灵活的宽度/高度（1 = 灵活，0 = 固定）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T15:42:18.217

关于什么

```
...
allowGrowX: true,
allowGrowY: true
... 
```

？！（想想名字）。

# c# - 从多个线程访问 SQL Server CE 是否安全？

> ID：15815971
> 
> 赞同：0
> 
> 时间：2013-04-04T15:54:06.807
> 
> 标签：c#, multithreading, concurrency, thread-safety, sql-server-ce

我有一个大约 5MB 的大型 CSV 数据库，其中包含我正在尝试导入 SQL Server CE 数据库的邮政编码、城市和州。

使用单线程，该过程估计需要大约 3 小时才能完成。虽然这对于完成工作很好，但我想尝试将任务拆分到多个线程中，以减少 3 小时的总时间。如果我在每个线程上创建一个`SqlCeConnection`对象，同时在每个线程上运行命令是否安全？

我感觉会有并发和死锁的问题。这是我找到 CSV 数据库的地方：[http ://www.unitedstateszipcodes.org/zip-code-database/](http://www.unitedstateszipcodes.org/zip-code-database/)

这是我的相关代码：

```
List<AddressSet> addressList;

public void OpenCSV(string file)
{
    var addresses = from line in File.ReadAllLines(file).Skip(1)
                    let columns = line.Split(',')
                    select new AddressSet
                    {
                        ZipCode = columns[0].Replace("\"", "").Trim(),
                        City = columns[2].Replace("\"", "").Trim(),
                        State = columns[5].Replace("\"", "").Trim()
                    };
    addressList = addresses.ToList();

    Thread worker = new Thread(new ThreadStart(ProcessData));
    worker.Start();

}

private void ProcessData()
{
    try
    {
        int i = 1;
        DateTime operationStart = DateTime.Now;
        foreach (AddressSet address in addressList)
        {
            int stateId = InsertState(address.State);
            int zipCodeId = InsertZipCode(address.ZipCode, stateId);
            int cityId = InsertCity(address.City, stateId);

            UpdateRelationships(zipCodeId, cityId);
            float pct = i / (float)addressList.Count() * 100;
            TimeSpan timeSinceStart = DateTime.Now.Subtract(operationStart);
            TimeSpan totalTime = TimeSpan.FromMilliseconds(timeSinceStart.TotalMilliseconds / (pct/100));
            TimeSpan timeLeft = totalTime - timeSinceStart;
            //richTextBox1.BeginInvoke((MethodInvoker)(() => richTextBox1.Text = pct.ToString("N2") + "% (" + i + " of " + addressList.Count().ToString() + ") " + address.City + ", " + address.State + " " + address.ZipCode 
            //    + "\nEstimated Total Time: " + totalTime.Days.ToString() + " days, " + totalTime.Hours.ToString() + " hours, " + totalTime.Minutes.ToString() + " minutes" +
            //    " - Time Left: " + timeLeft.Days.ToString() + " days, " + timeLeft.Hours.ToString() + " hours, " + timeLeft.Minutes.ToString() + " minutes"));
            richTextBox1.BeginInvoke((MethodInvoker)(() => richTextBox1.Text = pct.ToString("N2") + "% (" + i + " of " + addressList.Count().ToString() + ") " + address.City + ", " + address.State + " " + address.ZipCode
                + "\nEstimated Total Time: " + totalTime.ToString("h'h 'm'm 's's'") +
                "\nTime Left: " + timeLeft.ToString("h'h 'm'm 's's'") +
                "\nRunning Time: " + timeSinceStart.ToString("h'h 'm'm 's's'")));
            richTextBox1.BeginInvoke((MethodInvoker)(() => richTextBox1.SelectionStart = richTextBox1.Text.Length));
            richTextBox1.BeginInvoke((MethodInvoker)(() => richTextBox1.ScrollToCaret()));
            i++;
        }
        this.Invoke(new Action(() =>
        {
            MessageBox.Show("Done!");
            btnChooseCSV.Enabled = true;
        }));
    }
    catch (Exception ex)
    {
        this.Invoke(new Action(() =>
        {
            MessageBox.Show(ex.Message);
        }));
    }
}

private int InsertZipCode(string zipCode, int stateId)
{
    string connstr = System.Configuration.ConfigurationManager.ConnectionStrings["AddressInformation"].ConnectionString;
    SqlCeConnection connection = new SqlCeConnection(connstr);
    connection.Open();

    SqlCeCommand command = new SqlCeCommand("SELECT COUNT(*) FROM ZipCode WHERE ZipCode = @ZipCode", connection);

    command.Parameters.AddWithValue("ZipCode", zipCode);

    int result = (int)command.ExecuteScalar();

    // if nothing found, insert
    if (result == 0)
    {
        command = new SqlCeCommand("INSERT INTO ZipCode(ZipCode, StateId) VALUES(@ZipCode, @StateId)", connection);
        command.Parameters.AddWithValue("ZipCode", zipCode);
        command.Parameters.AddWithValue("StateId", stateId);
        command.ExecuteNonQuery();

        command = new SqlCeCommand("SELECT @@IDENTITY", connection);
    }

    if (result == 1)
    {
        command = new SqlCeCommand("SELECT ZipCodeId FROM ZipCode WHERE ZipCode = @ZipCode", connection);
        command.Parameters.AddWithValue("ZipCode", zipCode);
    }

    string test = command.ExecuteScalar().ToString();
    result = int.Parse(test);

    connection.Close();
    return result;
}

private int InsertCity(string city, int stateId)
{
    string connstr = System.Configuration.ConfigurationManager.ConnectionStrings["AddressInformation"].ConnectionString;
    SqlCeConnection connection = new SqlCeConnection(connstr);
    connection.Open();

    SqlCeCommand command = new SqlCeCommand("SELECT COUNT(*) FROM City WHERE CityName = @City", connection);
    command.Parameters.AddWithValue("City", city);
    int result = (int)command.ExecuteScalar();

    // if nothing found, insert
    if (result == 0)
    {
        command = new SqlCeCommand("INSERT INTO City(CityName, StateId) VALUES(@City, @StateId)", connection);
        command.Parameters.AddWithValue("City", city);
        command.Parameters.AddWithValue("StateId", stateId);
        command.ExecuteNonQuery();

        command = new SqlCeCommand("SELECT @@IDENTITY", connection);
    }

    if (result == 1)
    {
        command = new SqlCeCommand("SELECT CityId FROM City WHERE CityName = @City", connection);
        command.Parameters.AddWithValue("City", city);
    }
    string test = command.ExecuteScalar().ToString();
    result = int.Parse(test);

    connection.Close();
    return result;
}

private int InsertState(string state)
{
    string connstr = System.Configuration.ConfigurationManager.ConnectionStrings["AddressInformation"].ConnectionString;
    SqlCeConnection connection = new SqlCeConnection(connstr);
    connection.Open();

    SqlCeCommand command = new SqlCeCommand("SELECT COUNT(*) FROM State WHERE State = @State", connection);
    command.Parameters.AddWithValue("State", state);
    int result = (int)command.ExecuteScalar();

    // if nothing found, insert
    if (result == 0)
    {
        command = new SqlCeCommand("INSERT INTO State(State) VALUES(@State)", connection);
        command.Parameters.AddWithValue("State", state);
        command.ExecuteNonQuery();

        command = new SqlCeCommand("SELECT @@IDENTITY", connection);
    }

    if (result == 1)
    {
        command = new SqlCeCommand("SELECT StateId FROM State WHERE State = @State", connection);
        command.Parameters.AddWithValue("State", state);
    }
    string test = command.ExecuteScalar().ToString();
    result = int.Parse(test);

    connection.Close();
    return result;
}

private void UpdateRelationships(int zipCodeId, int cityId)
{
    string connstr = System.Configuration.ConfigurationManager.ConnectionStrings["AddressInformation"].ConnectionString;
    SqlCeConnection connection = new SqlCeConnection(connstr);
    connection.Open();

    SqlCeCommand command = new SqlCeCommand("INSERT INTO CityZipCode(CityId, ZipCodeId) VALUES(@CityId, @ZipCodeId)", connection);

    command.Parameters.AddWithValue("CityId", cityId);
    command.Parameters.AddWithValue("ZipCodeId", zipCodeId);
    command.ExecuteNonQuery();

    connection.Close();
} 
```

**编辑：**

澄清一下，我不只是简单地从 CSV 文件中插入每一行信息。我通过将每个相应的项目插入单独的表并添加每个实体之间的关系来更改数据的布局方式。

例如，一个城市可以有多个邮政编码，而一个邮政编码有时可以覆盖多个城市，因此可以用多对多关系表示。城市和邮政编码只有一个州，因此这种关系是多对一的。

我有一张城市、邮政编码和州的表格。我还有一张将城市与邮政编码相关联的表格。我将需要修改我的关系表架构，以使同名城市可能存在于多个州。关系表实际上应该是一个包含城市、州和邮政编码的集合，而不仅仅是城市和邮政编码。

我的最终目标是将带有密码保护的 SQL Server CE 数据库与另一个用于城市、州和邮政编码验证的应用程序一起分发。我不想分发 CSV 数据库，因为任何人都可以更改它以通过验证。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T16:06:24.330

您必须为每个线程创建一个连接对象，这对于多线程是不安全的：

[SqlCeConnection 类](http://msdn.microsoft.com/en-us/library/system.data.sqlserverce.sqlceconnection%28v=VS.100%29.aspx)

**已编辑**

> SQL CE 对象不是线程安全的，也不是线程关联的。如果 SqlCeConnection 或 SqlCeTransaction 的实例在线程间共享而没有确保线程安全，则可能导致 Access Violation 异常。
> 
> 建议每个线程应该使用单独的连接而不是共享。如果确实需要跨线程共享 SQL CE 对象，那么应用程序应该序列化对这些对象的访问。

[使用 SQL Server Compact 进行多线程编程](http://social.msdn.microsoft.com/Forums/en-US/sqlce/thread/df341f51-b3f6-4cd4-a7ed-d2149c0c4ce2/)

为什么不使用[SQL Server Compact Toolbox](http://sqlcetoolbox.codeplex.com/)你可以使用它，它会根据 CSV 文件生成 INSERT 语句。

或使用[CSV 到 SQLCE 数据库](http://www.fullconvert.com/CSV-to-SQLCE/)应用程序的转换

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-11T00:01:09.253

只是一个建议，我正在做同样的事情，这就是我所拥有的，与简单的解决方案相比它非常快

```
public static DataTable CSVToDataTable(string path, string name)
{
    return CSVToDataTable(Path.Combine(path, name));
}

public static DataTable CSVToDataTable(string path)
{
    DataTable res = new DataTable();
    if (!File.Exists(path))
    {
        return res;
    }
    using (FileStream stream = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
    {
        using (StreamReader re = new StreamReader(stream))
        {
            if (re.EndOfStream)
                return res;
            string line = re.ReadLine();
            if (line.IsNullOrWhiteSpace())
                return res;
            string[] headers = LineToArray(line);
            foreach (string header in headers)
            {
                res.Columns.Add(header);
            }
            int i = 0;
            string[] cells = new string[0];
            DataRow row = null;
            while (!re.EndOfStream)
            {
                line = re.ReadLine();
                if (line.IsNullOrWhiteSpace())
                    continue;
                cells = LineToArray(line);
                row = res.NewRow();
                for (i = 0; i < headers.Length && i < cells.Length; i += 1)
                {
                    row[i] = cells[i];
                }
                res.Rows.Add(row);
            }
        }
    }
    return res;
}

private static string[] LineToArray(string line, char delimiter = ',')
{
    if (line.Contains("\""))
    {
        List<string> l = new List<string>();
        bool inq = false;
        string cell = string.Empty;
        char lastCh = 'x';
        foreach (char ch in line)
        {
            if (ch == '"')
            {
                if (cell.Length == 0)
                {
                    inq = true;
                }
                else if (lastCh == '\\')
                {
                    cell += ch;
                }
                else
                {
                    inq = false;
                }
            }
            else if (delimiter == ch)
            {
                if (inq)
                {
                    cell += ch;
                }
                else
                {
                    l.Add(cell);
                    inq = false;
                    cell = string.Empty;
                }
            }
            else
            {
                cell += ch;
            }
            if (inq)
                lastCh = ch;
            else
                lastCh = 'x';
        }
        return l.ToArray();
    }
    else
    {
        return line.Split(new String[] { delimiter.ToString() }, StringSplitOptions.None);
    }
}

public void insert(string path, string name, string table, bool KeepNulls){

    DataTable data = CSVToDataTable(path, name);
    //do data manipulation here

    SqlCeBulkCopyOptions options = new SqlCeBulkCopyOptions();
    if (KeepNulls)
    {
        options = options |= SqlCeBulkCopyOptions.KeepNulls;
    }
    using (SqlCeBulkCopy bc = new SqlCeBulkCopy(Fastway_Remote_Agent.Properties.Settings.Default.DatabaseConnectionString, options))
    {
        bc.DestinationTableName = table;
        bc.WriteToServer(data);
    }
} 
```

使用这个库：[http ://sqlcebulkcopy.codeplex.com/](http://sqlcebulkcopy.codeplex.com/)

也用于线程池（更改它以满足您的需要）：

```
/// <summary>
/// Manages open connections on a per-thread basis
/// </summary>
public abstract class SqlCeConnectionPool
{
    private static Dictionary<int, DBCon> threadConnectionMap = new Dictionary<int, DBCon>();

    private static Dictionary<int, Thread> threadMap = new Dictionary<int, Thread>();

    /// <summary>
    /// The connection map
    /// </summary>
    public static Dictionary<int, DBCon> ThreadConnectionMap
    {
        get { return SqlCeConnectionPool.threadConnectionMap; }
    }

    /// <summary>
    /// Gets the connection string.
    /// </summary>
    /// <value>The connection string.</value>
    public static ConnectionString ConnectionString
    {
        get { return global::ConnectionString.Default; }
    }

    /// <summary>
    /// Gets a connection for this thread, maintains one open one of each.
    /// </summary>
    /// <remarks>Don't do this with anything but SQL compact edition or you'll run out of connections - compact edition is not
    /// connection pooling friendly and unloads itself too often otherwise so that is why this class exists</remarks> 
    /// <returns>An open connection</returns>
    public static DBCon Connection
    {
        get
        {
            lock (threadConnectionMap)
            {
                //do some quick maintenance on existing connections (closing those that have no thread)
                List<int> removeItems = new List<int>();
                foreach (var kvp in threadConnectionMap)
                {
                    if (threadMap.ContainsKey(kvp.Key))
                    {
                        if (!threadMap[kvp.Key].IsAlive)
                        {
                            //close the connection
                            if (!kvp.Value.Disposed)
                                kvp.Value.Dispose();
                            removeItems.Add(kvp.Key);
                        }
                    }
                    else
                    {
                        if (!kvp.Value.Disposed)
                            kvp.Value.Dispose();
                        removeItems.Add(kvp.Key);
                    }
                }
                foreach (int i in removeItems)
                {
                    threadMap.Remove(i);
                    threadConnectionMap.Remove(i);
                }

                //now issue the appropriate connection for our current thread
                int threadId = Thread.CurrentThread.ManagedThreadId;

                DBCon connection = null;
                if (threadConnectionMap.ContainsKey(threadId))
                {
                    connection = threadConnectionMap[threadId];
                    if (connection.Disposed)
                    {
                        if (threadConnectionMap.ContainsKey(threadId))
                            threadConnectionMap.Remove(threadId);
                        if (threadMap.ContainsKey(threadId))
                            threadMap.Remove(threadId);
                        connection = null;
                    }
                    else if (connection.Connection.State == ConnectionState.Broken)
                    {
                        connection.Dispose();
                        if (threadConnectionMap.ContainsKey(threadId))
                            threadConnectionMap.Remove(threadId);
                        if (threadMap.ContainsKey(threadId))
                            threadMap.Remove(threadId);
                        connection = null;
                    }
                    else if (connection.Connection.State == ConnectionState.Closed)
                    {
                        connection.Dispose();
                        if (threadConnectionMap.ContainsKey(threadId))
                            threadConnectionMap.Remove(threadId);
                        if (threadMap.ContainsKey(threadId))
                            threadMap.Remove(threadId);
                        connection = null;
                    }

                }
                if (connection == null)
                {
                    connection = new DBCon(ConnectionString);
                    //connection.Connection.Open();
                    if (threadConnectionMap.ContainsKey(threadId))
                        threadConnectionMap[threadId] = connection;
                    else
                        threadConnectionMap.Add(threadId, connection);
                    if (threadMap.ContainsKey(threadId))
                        threadMap[threadId] = Thread.CurrentThread;
                    else
                        threadMap.Add(threadId, Thread.CurrentThread);

                }
                return connection;
            }
        }
    }
} 
```

# gcc - gcc - 为另一台机器编译不起作用

> ID：15815972
> 
> 赞同：3
> 
> 时间：2013-04-04T15:54:16.660
> 
> 标签：gcc, cross-compiling, legacy

我有以下问题：

*   我有旧系统 - ARM CPU。
*   在遗留系统上，我没有开发库，也没有 GCC。
*   在遗留系统上，我没有足够的资源（主要是 RAM 和 SWAP 是不可能的）来编译。

我需要编译我有源代码的非常简单的程序。当我在另一台也有 ARM CPU（更新一点）的机器上使用以下 GCC 命令编译它时：

```
gcc -mcpu=arm920t -march=armv4t -o app app.c 
```

（-mcpu 和 -march 设置为遗留系统的 CPU）

当我将此编译文件复制到旧系统时，使其可执行并尝试运行它，我收到以下消息：

```
$ ./app
-sh: ./app: No such file or directory
$ ls -lah
total 237K
drwxr-xr-x  2 root    root    0 Apr  4 07:35 .
drwxr-xr-x  4 root    root    0 Dec 31  1969 ..
-rwxr-xr-x  1 root    root 108K Mar 14 09:23 app
$ 
```

路径没有问题，**没有**使用 noexec 选项挂载分区。当我将任何系统（例如 cat）文件复制到同一目录时，我可以毫无问题地启动它。

这是我编译的应用程序（第一个结果）和已经在系统上的应用程序（第二个结果）之间的区别：

```
$ readelf -h app
ELF Header:
  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00
  Class:                             ELF32
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              EXEC (Executable file)
  Machine:                           ARM
  Version:                           0x1
  Entry point address:               0xa278
  Start of program headers:          52 (bytes into file)
  Start of section headers:          100104 (bytes into file)
  Flags:                             0x5000002, has entry point, Version5 EABI
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         10
  Size of section headers:           40 (bytes)
  Number of section headers:         38
  Section header string table index: 35
$ 
```

和：

```
$ readelf -h cat
ELF Header:
  Magic:   7f 45 4c 46 01 01 01 61 00 00 00 00 00 00 00 00
  Class:                             ELF32
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            ARM
  ABI Version:                       0
  Type:                              EXEC (Executable file)
  Machine:                           ARM
  Version:                           0x1
  Entry point address:               0x8c34
  Start of program headers:          52 (bytes into file)
  Start of section headers:          15220 (bytes into file)
  Flags:                             0x2, has entry point, GNU EABI
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         6
  Size of section headers:           40 (bytes)
  Number of section headers:         24
  Section header string table index: 23
$ 
```

输出`file cat app`：

```
app: ELF 32-bit LSB executable, ARM, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.16, not stripped
cat: ELF 32-bit LSB executable, ARM, version 1, dynamically linked (uses shared libs), for GNU/Linux 2.2.0, stripped 
```

我不确定这里有什么问题，因为即使应用程序编译错误，我也希望收到与“没有这样的文件或目录”不同的错误消息。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-07-21T14:59:38.593

这个问题主要是由于共享库libc问题。当你在支持gcc的arm机器上编译程序时，使用的库（libc）与你的目标不同。所以首先在主机和目标上检查你的库。要交叉检查上面的评论，你试试这个。

```
gcc -static -o app app.c 
```

现在将您的应用程序可执行文件复制到您的目标。在目标上执行，它将毫无问题地执行。检查上面静态编译的代码。使用文件应用程序或 ldd 应用程序。

如果您不想静态编译，则在编译时从目标 rootfs 的 /lib 复制您的库，提供指向目标库而不是主机库的库路径。这可以通过

```
LDFLAGS=-L/<path-to-target-lib>  gcc  -o app app.c 
```

# c# - 递归方法中的 Parallel.ForEach

> ID：15815975
> 
> 赞同：1
> 
> 时间：2013-04-04T15:54:19.700
> 
> 标签：c#, .net-4.0, task-parallel-library

我有一种收集共享信息并将结果写入数据库的方法，我使用 Parallel.Foreach 提高了性能，尤其是在扫描 100 TB 时

如果我在本地数据库中运行此代码，我没有问题，但在沙盒数据库中，我有大量异常/内部异常

代码：

```
private static INodeCollection NodesLookUp(string path, int maximumLevel)
       {

           var shareCollectionNode = new ShareCollection(path);
           shareCollectionNode.GetNodeProperties();
           shareCollectionNode.GetPermissionEntires();
           WriteNodeToDatabase(shareCollectionNode); // write collected infomation to database
           if (maximumLevel <= 0 && _maximumSubLevels != -1)
           {
               return shareCollectionNode;
           }

           Parallel.ForEach(Directory.GetDirectories(shareCollectionNode.FullPath), directory =>
           {
              try
             {
                  lock (shareCollectionNode)
                  {
                      shareCollectionNode.AddNode(NodesLookUp(directory, maximumLevel - 1));
                  }

              }
              catch (UnauthorizedAccessException unauthorizedAccessException)
              {
                  lock (_shareIssues)
                  {
                      _shareIssues.Add(new ShareIssue(TraceStatu.UnauthorizedAccess, directory,
                     unauthorizedAccessException.Message, dfsId, currentLevel));
                  }

               }

           });

           return shareCollectionNode;
       } 
```

写入数据库：

```
private static void WriteNodeToDatabase(ShareCollection shareCollection)
    {
        var nodeId = Persistence.UpsertShare(shareCollection);
        var sharePermissions = new List<IPermissionRight>();
        foreach (var permissionEntry in shareCollection.PermissionEntries)
        {
            permissionEntry.NodeId = nodeId;
            var permissionEntryId = Persistence.InsertPermissionEntry(permissionEntry);
            permissionEntry.SetPermissions(permissionEntryId);
            sharePermissions.AddRange(permissionEntry.Permissions);
        }
        Persistence.InsertPermissions(sharePermissions);
    } 
```

例外：

```
 System.Data.SqlClient.SqlException (0x80131904): Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery() 
```

如果我删除 Parallel.Foreach 并使用正常的 for 循环，那么除了应用程序需要很长时间才能运行之外，我没有任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T09:02:11.773

首先尝试替换这个

```
lock (shareCollectionNode)
{
    shareCollectionNode.AddNode(NodesLookUp(directory, maximumLevel - 1));
} 
```

有了这个

```
var node = NodesLookUp(directory, maximumLevel - 1);
lock (shareCollectionNode)
{
    shareCollectionNode.AddNode(node);
} 
```

和第二个锁一样。

虽然这是通过并行实现您想要的更好的方法，但它也可能有助于在本地重现相同的错误，因为它应该增加数据库活动。

我认为实际问题依赖于数据库事务 - 看起来在并发数据库操作期间会导致表中的中间结果返回无效数据；在我们看到实际的查询和表模式之前，我不能说更多。

# python - 基于值的字典分组/计数列表

> ID：15815976
> 
> 赞同：16
> 
> 时间：2013-04-04T15:54:21.980
> 
> 标签：python, list, aggregate-functions

我有一个令牌列表，看起来像：

```
[{
    Value: "Blah",
    StartOffset: 0,
    EndOffset: 4
}, ... ] 
```

我想要做的是计算每个值在令牌列表中出现的次数。

在 VB.Net 我会做类似...

```
Tokens = Tokens.
GroupBy(Function(x) x.Value).
Select(Function(g) New With {
           .Value = g.Key,
           .Count = g.Count}) 
```

Python中的等价物是什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-04-04T16:00:45.697

IIUC，您可以使用`collections.Counter`：

```
>>> from collections import Counter
>>> tokens = [{"Value": "Blah", "SO": 0}, {"Value": "zoom", "SO": 5}, {"Value": "Blah", "SO": 2}, {"Value": "Blah", "SO": 3}]
>>> Counter(tok['Value'] for tok in tokens)
Counter({'Blah': 3, 'zoom': 1}) 
```

如果你只需要一个计数。如果您希望它们按值分组，您可以使用类似的`itertools.groupby`东西：

```
>>> from itertools import groupby
>>> def keyfn(x):
        return x['Value']
... 
>>> [(k, list(g)) for k,g in groupby(sorted(tokens, key=keyfn), keyfn)]
[('Blah', [{'SO': 0, 'Value': 'Blah'}, {'SO': 2, 'Value': 'Blah'}, {'SO': 3, 'Value': 'Blah'}]), ('zoom', [{'SO': 5, 'Value': 'zoom'}])] 
```

虽然它有点棘手，因为`groupby`要求分组的术语是连续的，所以你必须先按键排序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-04T16:04:04.093

假设这是您的 python 列表，包含字典：

```
my_list = [{'Value': 'Blah',
            'StartOffset': 0,
            'EndOffset': 4},
           {'Value': 'oqwij',
            'StartOffset': 13,
            'EndOffset': 98},
           {'Value': 'Blah',
            'StartOffset': 6,
            'EndOffset': 18}] 
```

一个班轮：

```
len([i for i in a if i['Value'] == 'Blah']) # returns 2 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T16:01:55.500

```
import collections

# example token list
tokens = [{'Value':'Blah', 'Start':0}, {'Value':'BlahBlah'}]

count=collections.Counter([d['Value'] for d in tokens])
print count 
```

节目

```
Counter({'BlahBlah': 1, 'Blah': 1}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T16:02:15.830

```
token = [{
    'Value': "Blah",
    'StartOffset': 0,
    'EndOffset': 4
}, ... ]

value_counter = {}

for t in token:
    v = t['Value']
    if v not in value_counter:
        value_counter[v] = 0
    value_counter[v] += 1

print value_counter 
```

# asp.net-mvc - 具有 HTML5 模式和 ASP.Net MVC 的 AngularJS 可选 URL 参数

> ID：15815980
> 
> 赞同：4
> 
> 时间：2013-04-04T15:54:31.240
> 
> 标签：asp.net-mvc, html, routing, angularjs

类似于我问的最后一个问题，但有点复杂。

我有一个 ASP.Net MVC 服务的 Angular 应用程序。

```
.when("/Catalog",
{
    templateUrl: "/htm/catalog/catalog.htm"
})
.when("/Catalog/:Category1",
{
    templateUrl: "/htm/catalog/search.htm"
})
.when("/Catalog/:Category1/:Category2",
{
    templateUrl: "/htm/catalog/search.htm"
})
.when("/Catalog/:Category1/:Category2/:Category3",
{
    templateUrl: "/htm/catalog/search.htm"
})
.when("/Catalog/:Category1/:Category2/:Category3/:Category4",
{
    templateUrl: "/htm/catalog/search.htm"
}); 
```

$locationProvider.html5Mode(true);

MVC 路由看起来像这样：

```
// AngularJS Route. This is what allows angular to handle its own routing.
routes.MapRoute(
    "hash",
    "#/{whatever}/{param}/{param2}/{param3}/{param4}/{param5}",
    new
    {
        controller = "Home",
        action = "Index",
        param = UrlParameter.Optional,
        param2 = UrlParameter.Optional,
        param3 = UrlParameter.Optional,
        param4 = UrlParameter.Optional,
        param5 = UrlParameter.Optional
    }
);

// This catches all of the other requests (e.g. /img/logo.jpg);
routes.MapRoute(
    "whatever",
    "{whatever}/{param}",
    new
    {
        controller = "Home",
        action = "Index",
        param = UrlParameter.Optional,
        param2 = UrlParameter.Optional,
        param3 = UrlParameter.Optional,
        param4 = UrlParameter.Optional,
        param5 = UrlParameter.Optional
    }
); 
```

home/index 操作只返回我的索引页面：

```
public void Index()
{
    String html = System.IO.File.ReadAllText(HttpContext.Server.MapPath("~/htm/index.htm"));
    HttpContext.Response.Write(html);
} 
```

我遇到的问题是，当我尝试使用可选参数访问其中一个路由时，页面挂起，给出了这个 javascript 错误：

错误：达到 10 次 $digest() 迭代。中止！

有时它会无休止地渲染自己（就像一面镜子照镜子），这让我觉得“随便”的路线会导致问题。如果没有这些可选参数，路由将完全失败。这样页面确实呈现并且参数被加载到$routeParams，但是页面挂起，大概是因为它递归地呈现自己。

如果我取出“whatever”MVC 路由上的可选参数并尝试使用哈希表示法（/#/Catalog/test）命中路由，它加载得很好（它不会挂起并且路由参数在那里） ，但 html5 版本（/Catalog/test）找不到 MVC 路由。

很明显我的问题在于我的路由，但我不确定我做错了什么。有人可以阐明问题可能是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T08:12:15.830

不确定它会有所帮助。但有几件事要记住。

*   当`$locationProvider.html5Mode(true);`哈希仅被旧版浏览器使用时（IE <= 9）
*   url 的哈希部分不会发送到服务器。所以你不需要`routes.MapRoute`for 哈希
*   当浏览器请求一个 URI（即 /Catalog/test）时，它将首先命中**ASP.NET**路由，然后，当页面加载时，它将由**AngularJS处理**
*   看起来`routes.MapRoute`处理程序“无论如何”再次发送整个页面，这意味着当 angular 尝试处理路由并尝试加载`/htm/catalog/search.htm`ASP.NET 路由时，将再次提供页面。这将导致无限循环，因为 angular.js 加载的页面包含其自身，并且它将尝试再次加载它。

希望能帮助到你。

# python - XML 解析的数据类型

> ID：15815982
> 
> 赞同：-3
> 
> 时间：2013-04-04T15:54:32.370
> 
> 标签：python, xml, python-3.x

在处理 XML 并决定使用哪种数据类型时，是否有一种明显的 Pythonic 方式？字典方法让我觉得很直观，但我想知道经常处理 XML 的人是否会插话为什么字典是/不是一个好方法。

想到的缺点是字典的可变性。但是如果我知道我需要什么数据，那么我就可以构建合适大小的字典。

下面是我正在解析的一小段数据

```
<Issuer>fotokem</Issuer>
<Creator>ClipsterDCI 4.5.0.24</Creator>
<Id>urn:uuid:6ab4b76e-0e26-4d73-8d01-6f08c96feb71</Id>
<Path>MINI-NOT-NORM-USA_ADV_F_EN-XX_51_2K_SPO_20121127_FKI_01.mxf</Path> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:31:02.603

解析 XML 的最 Pythonic 方式是[`lxml`](http://lxml.de/).

# php - 使用 grails php 插件从 groovy gsp 中调用 PHP 标记

> ID：15815985
> 
> 赞同：0
> 
> 时间：2013-04-04T15:54:39.683
> 
> 标签：php, wordpress, grails, plugins

我正在尝试将 wordpress 博客集成到我的 grails 应用程序中。Wordpress 是 php，所以 grails 显然不能立即使用它。这里有一个（相当过时的）grails php 插件：http: [//grails.org/plugin/php](http://grails.org/plugin/php)，我已经下载并安装了它。该插件运行良好，让我可以启动并运行 Wordpress。

我遇到的问题是尝试在 groovy gsp 页面中显示 wordpress 内容。可以使用 PHP 标记访问内容。但是，grails php 插件的描述指出：

*   您可以使用 JSP include 从 web-app 下的 JSP 页面加载 PHP 页面
*   您还不能从 .gsp 中包含 .php，请检查[GRAILS-3906](http://jira.grails.org/browse/GRAILS-3906)

所以我不能在 gsp 中包含 php。他们提到了一些解决方法，比如包括整个 php 页面，但是......我不走运吗？

有没有人这样做过？网络似乎很难找到答案。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-18T15:29:30.487

我宁愿尝试相反的方法：让网站使用 wordpress 开发，并且 wp-plugin 可以使用由 e 自定义 wordpress 插件代理的 restful 调用集成您的 grails 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T15:31:25.353

（相当旧的）Wordpress 插件提供了用于从 wordpress 中提取内容以在 grails 中显示的标签。

ehcache 用于将 wordpress 内容缓存 5 分钟。

[http://grails.org/plugin/wordpress](http://grails.org/plugin/wordpress)

# c# - 在 C# 中为子类动态赋值

> ID：15815986
> 
> 赞同：0
> 
> 时间：2013-04-04T15:54:46.437
> 
> 标签：c#, .net, linq, inheritance, polymorphism

如何根据继承类的值在 C# 中动态加载子类？

我有一个继承实体的类，并且由于我无法将父类转换为其子类型，因此我想动态加载实体数据而不显式定义每个属性。

我尝试通过使用 foreach 循环进行循环，但如您所知，您不能为 foreach 变量赋值。

我的失败尝试：

```
public class ABroker : DP_ePAFBroker
{
    public ABroker() : base()
    {
    }
    public ABroker(DP_ePAFBroker data)
    {
        var props = typeof(DP_ePAFBroker).GetProperties();
        foreach(object obj in this)
        {
            foreach (var prop in props)
            {
                obj = prop.GetValue(obj, null);
            }
        }

    }
    public IEnumerator GetEnumerator()//List of Objects
    {
        var props = typeof(DP_ePAFBroker).GetProperties().Select(p).ToList<Object>();
        return props.GetEnumerator();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:07:04.570

看起来您正在尝试将所有值从基类实例复制到继承者。

你可以这样做：

```
public ABroker(DP_ePAFBroker data)
{
    foreach(var property in typeof(DP_ePAFBroker).GetProperties())
    {
        // get the value
        var value = property.GetValue(data, null);
        // set it on this instance
        property.SetValue(this, value, null);
    }
} 
```

不过，请小心以这种方式复制引用类型。你最终可能会做一些丑陋的事情，并在以后为自己创造一些非常恼人的错误。

# java - SSID 与 BSSID：以编程方式通过 Android 连接到 Wifi / 使用 WifiManager 连接到网络

> ID：15815987
> 
> 赞同：0
> 
> 时间：2013-04-04T15:54:47.260
> 
> 标签：java, android, networking, ssid, bssid

我听说一些开发人员在指定 SSID 时无法连接到 wifi：

[https://groups.google.com/forum/?fromgroups=#!topic/android-developers/di4gMhC0ZTY](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/di4gMhC0ZTY)

但是其他开发人员正在通过 SSID 进行连接：

[如何以编程方式连接到 Android 中的特定 Wi-Fi 网络？](https://stackoverflow.com/questions/8818290/how-to-connect-to-a-specific-wifi-network-in-android-programmatically)

应该使用哪种方法？

我目前无法连接。

资源：

```
import java.util.List;

import android.app.Activity;    
import android.net.wifi.WifiConfiguration;
import android.net.wifi.WifiManager;
import android.os.Bundle;
import android.util.Log;
import android.content.Context; 

public class Connect extends Activity  {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.connect);
        String networkSSID = "ANDRE-PC_NETWORK";
        String networkPass = "superman";

        WifiConfiguration conf = new WifiConfiguration();
        conf.SSID = "\"" + networkSSID + "\"";   //ssid must be in quotes

        conf.wepKeys[0] = "\"" + networkPass + "\""; 
        conf.wepTxKeyIndex = 0;
        conf.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE);
       conf.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.WEP40); 

        conf.preSharedKey = "\""+ networkPass +"\"";

        conf.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE);

        WifiManager wifiManager = (WifiManager)getSystemService(WIFI_SERVICE); 
        wifiManager.addNetwork(conf);

        List<WifiConfiguration> list = wifiManager.getConfiguredNetworks();
        for( WifiConfiguration i : list ) {
            if(i.SSID != null && i.SSID.equals("\"" + networkSSID + "\"")) {
                 wifiManager.disconnect();
                 wifiManager.enableNetwork(i.networkId, true);
                 wifiManager.reconnect();                

                 break;
            }           
         }

    }} 
```

日志猫：

```
04-04 12:05:11.843: I/ActivityManager(479): START u0 {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10000000 cmp=com.wifi.connect/.Connect} from pid 2785
04-04 12:05:11.873: D/Finsky(1555): [159] ConsumptionAppServiceConn.getDataFromService: retrieved 20 documents from [2]
04-04 12:05:11.923: D/dalvikvm(479): GC_FOR_ALLOC freed 2477K, 23% free 17481K/22424K, paused 59ms, total 60ms
04-04 12:05:11.943: D/AndroidRuntime(2785): Shutting down VM
04-04 12:05:11.953: D/dalvikvm(2795): Late-enabling CheckJNI
04-04 12:05:11.953: D/dalvikvm(2785): GC_CONCURRENT freed 96K, 17% free 500K/600K, paused 0ms+0ms, total 3ms
04-04 12:05:11.953: D/jdwp(2785): Got wake-up signal, bailing out of select
04-04 12:05:11.953: D/dalvikvm(2785): Debugger has detached; object registry had 1 entries
04-04 12:05:11.953: I/ActivityManager(479): Start proc com.wifi.connect for activity com.wifi.connect/.Connect: pid=2795 uid=10110 gids={50110, 3003, 1028}
04-04 12:05:12.073: D/dalvikvm(785): GC_FOR_ALLOC freed 2349K, 25% free 18097K/24032K, paused 40ms, total 40ms
04-04 12:05:12.073: D/Finsky(1555): [1] ConsumptionAppDataCache.setConsumptionAppData: data didn't change for backend=[2], ignoring!
04-04 12:05:12.093: D/dalvikvm(479): GC_CONCURRENT freed 2628K, 24% free 17135K/22424K, paused 3ms+24ms, total 171ms
04-04 12:05:12.143: D/dalvikvm(2795): GC_FOR_ALLOC freed 74K, 3% free 7379K/7580K, paused 19ms, total 19ms
04-04 12:05:12.163: I/dalvikvm-heap(2795): Grow heap (frag case) to 10.841MB for 3686416-byte allocation
04-04 12:05:12.193: D/dalvikvm(2795): GC_FOR_ALLOC freed 1K, 2% free 10977K/11184K, paused 30ms, total 30ms
04-04 12:05:12.233: D/dalvikvm(2795): GC_CONCURRENT freed <1K, 2% free 10977K/11184K, paused 4ms+3ms, total 41ms
04-04 12:05:12.363: D/dalvikvm(785): GC_FOR_ALLOC freed 2349K, 25% free 18097K/24032K, paused 49ms, total 49ms
04-04 12:05:12.393: D/dalvikvm(479): GC_CONCURRENT freed 2439K, 24% free 17143K/22424K, paused 14ms+13ms, total 184ms
04-04 12:05:12.503: D/dalvikvm(785): GC_FOR_ALLOC freed 2349K, 25% free 18097K/24032K, paused 28ms, total 28ms
04-04 12:05:12.533: D/dalvikvm(479): GC_CONCURRENT freed 2423K, 24% free 17098K/22424K, paused 3ms+9ms, total 100ms
04-04 12:05:12.533: D/dalvikvm(479): WAIT_FOR_CONCURRENT_GC blocked 1ms
04-04 12:05:12.543: D/dalvikvm(2795): GC_FOR_ALLOC freed <1K, 2% free 10977K/11184K, paused 18ms, total 18ms
04-04 12:05:12.563: I/dalvikvm-heap(2795): Grow heap (frag case) to 17.067MB for 6529744-byte allocation
04-04 12:05:12.583: D/dalvikvm(2795): GC_FOR_ALLOC freed 0K, 2% free 17353K/17564K, paused 19ms, total 19ms
04-04 12:05:12.613: D/dalvikvm(2795): GC_CONCURRENT freed <1K, 2% free 17353K/17564K, paused 4ms+12ms, total 37ms
04-04 12:05:12.623: D/dalvikvm(2333): GC_CONCURRENT freed 174K, 6% free 7846K/8304K, paused 10ms+37ms, total 71ms
04-04 12:05:12.633: D/dalvikvm(785): GC_FOR_ALLOC freed 2349K, 25% free 18097K/24032K, paused 37ms, total 37ms
04-04 12:05:12.643: D/dalvikvm(479): GC_CONCURRENT freed 2359K, 24% free 17093K/22424K, paused 4ms+10ms, total 97ms
04-04 12:05:12.663: I/ActivityManager(479): Start proc com.android.keychain for broadcast com.android.keychain/.KeyChainBroadcastReceiver: pid=2819 uid=1000 gids={41000, 1015, 1028, 3002, 3001, 3003, 3007}
04-04 12:05:12.703: W/ContextImpl(2819): Calling a method in the system process without a qualified user: android.app.ContextImpl.startService:1352 android.content.ContextWrapper.startService:450 android.content.ContextWrapper.startService:450 com.android.keychain.KeyChainBroadcastReceiver.onReceive:12 android.app.ActivityThread.handleReceiver:2376 
04-04 12:05:12.753: I/ActivityManager(479): Start proc com.google.android.googlequicksearchbox for broadcast com.google.android.googlequicksearchbox/com.google.android.apps.sidekick.GmmLocationProviderImpl$GmmPackageWatcher: pid=2837 uid=10055 gids={50055, 3003, 1028, 1007, 3002, 1015, 1006}
04-04 12:05:12.793: I/ActivityManager(479): No longer want com.google.android.gms (pid 2258): empty #17
04-04 12:05:12.823: I/ActivityManager(479): Start proc com.google.android.partnersetup for content provider com.google.android.partnersetup/.RlzAppProvider: pid=2854 uid=10025 gids={50025, 3003, 1028}
04-04 12:05:12.853: D/GStaticConfiguration(2837): #loadConfiguration
04-04 12:05:12.873: D/GStaticConfiguration(2837): #loadConfiguration from preference
04-04 12:05:12.883: E/wpa_supplicant(594): Line 0: Invalid WEP key length 8 - this network block will be ignored
04-04 12:05:12.913: D/dalvikvm(2837): GC_CONCURRENT freed 233K, 5% free 7558K/7916K, paused 4ms+2ms, total 45ms
04-04 12:05:12.913: D/dalvikvm(2837): WAIT_FOR_CONCURRENT_GC blocked 8ms
04-04 12:05:12.913: D/dalvikvm(2837): WAIT_FOR_CONCURRENT_GC blocked 8ms
04-04 12:05:12.913: D/dalvikvm(2837): WAIT_FOR_CONCURRENT_GC blocked 9ms
04-04 12:05:12.913: W/GAV2(2837): Thread[main,5,main]: Connection to service failed 1
04-04 12:05:12.913: W/ActivityManager(479): Unable to start service Intent { act=com.google.android.gms.analytics.service.START (has extras) } U=0: not found
04-04 12:05:12.923: I/wpa_supplicant(594): wlan0: CTRL-EVENT-DISCONNECTED bssid=20:4e:7f:08:61:e6 reason=3 locally_generated=1
04-04 12:05:12.933: D/GStaticConfiguration(2837): Configuration loaded [70]
04-04 12:05:12.933: W/GAV2(2837): Thread[main,5,main]: Need to call initialize() and be in fallback mode to start dispatch.
04-04 12:05:12.933: D/CommandListener(123): Clearing all IP addresses on wlan0
04-04 12:05:12.943: D/ConnectivityService(479): ConnectivityChange for WIFI: DISCONNECTED/DISCONNECTED
04-04 12:05:12.943: D/ConnectivityService(479): Attempting to switch to BLUETOOTH_TETHER
04-04 12:05:12.943: D/ConnectivityService(479): Attempting to switch to ETHERNET
04-04 12:05:12.963: D/NetUtils(479): android_net_utils_resetConnections in env=0x68afd138 clazz=0x3e400001 iface=wlan0 mask=0x3
04-04 12:05:12.963: D/ConnectivityService(479): resetConnections(wlan0, 3)
04-04 12:05:12.973: W/Smack/Packet(898): notify conn break (IOEx), close connection
04-04 12:05:12.973: W/Sidekick_LocationOracleImpl(2837): Best location was null
04-04 12:05:12.973: I/ActivityManager(479): Start proc jp.co.omronsoft.iwnnime.ml for broadcast jp.co.omronsoft.iwnnime.ml/.UninstallReceiver: pid=2883 uid=10062 gids={50062, 1028}
04-04 12:05:12.993: D/ConnectivityService(479): ConnectivityChange for WIFI: DISCONNECTED/DISCONNECTED
04-04 12:05:12.993: D/ConnectivityService(479): Attempting to switch to BLUETOOTH_TETHER
04-04 12:05:12.993: D/ConnectivityService(479): Attempting to switch to ETHERNET
04-04 12:05:12.993: D/NetUtils(479): android_net_utils_resetConnections in env=0x68afd138 clazz=0x40a00001 iface=wlan0 mask=0x3
04-04 12:05:12.993: D/ConnectivityService(479): resetConnections(wlan0, 3)
04-04 12:05:12.993: I/ActivityManager(479): No longer want com.google.android.calendar (pid 2122): empty #17
04-04 12:05:12.993: I/ActivityManager(479): No longer want com.android.providers.calendar (pid 2142): empty #17
04-04 12:05:13.083: I/ActivityManager(479): No longer want com.google.android.talk (pid 2217): empty #17
04-04 12:05:13.113: I/ActivityManager(479): Start proc com.google.android.gms for broadcast com.google.android.gms/.common.receiver.SystemBroadcastReceiver: pid=2900 uid=10021 gids={50021, 3003, 1007, 1028, 1015, 2001, 3006}
04-04 12:05:13.113: I/ActivityManager(479): Displayed com.wifi.connect/.Connect: +1s174ms
04-04 12:05:13.123: I/qtaguid(898): Failed write_ctrl(u 50) res=-1 errno=22
04-04 12:05:13.123: I/qtaguid(898): Untagging socket 50 failed errno=-22
04-04 12:05:13.123: W/NetworkManagementSocketTagger(898): untagSocket(50) failed with errno -22
04-04 12:05:13.123: D/ConnectivityService(479): handleInetConditionChange: no active default network - ignore
04-04 12:05:13.193: D/dalvikvm(2900): Trying to load lib /data/app-lib/com.google.android.gms-2/libAppDataSearch.so 0x426085b0
04-04 12:05:13.203: D/dalvikvm(2900): Added shared lib /data/app-lib/com.google.android.gms-2/libAppDataSearch.so 0x426085b0
04-04 12:05:13.203: D/dalvikvm(2900): No JNI_OnLoad found in /data/app-lib/com.google.android.gms-2/libAppDataSearch.so 0x426085b0, skipping init
04-04 12:05:13.213: D/Icing(2900): Init last flush num docs 0 last docstore size 0
04-04 12:05:13.213: D/Icing(2900): Docid map file has no data, nothing to scan
04-04 12:05:13.213: D/Icing(2900): File /data/data/com.google.android.gms/files/AppDataSearch/main/cur/ds.perdocdata contains 0 records of size 6
04-04 12:05:13.213: D/Icing(2900): Init docstore ok num docs 0 bytes 0
04-04 12:05:13.263: V/Icing(2900): Lite index crc computed in 0.101ms
04-04 12:05:13.263: V/Icing(2900): Lite index init ok in 4.994ms
04-04 12:05:13.263: V/Icing(2900): Warming lite-index took 0.007ms
04-04 12:05:13.263: V/Icing(2900): Warming lexicon took 0.005ms
04-04 12:05:13.263: V/Icing(2900): Warming display mappings took 0.004ms
04-04 12:05:13.263: D/Icing(2900): Init index ok num docs 0
04-04 12:05:13.263: D/Icing(2900): Init done 
```

附言

我想要做的就是建立与特定 wifi 网络的连接。如果有人知道在哪里可以找到一些可以测试的源代码的工作副本 - 它可能会解决我的所有问题（我能找到的唯一帖子是上面显示的来自 SO 而不是在职的）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-27T15:15:07.080

你可以试试这个方法

```
conf.SSID = "\" + networkSSID + \"";   //ssid must be in quotes

conf.wepKeys[0] = "\" + networkPass + \""; 
```

# extjs - ExtJs 根节点

> ID：15815988
> 
> 赞同：0
> 
> 时间：2013-04-04T15:54:48.007
> 
> 标签：extjs, extjs4.1

`root`如果我得到这样的 Json，属性值是多少：

```
{
    "status": {
        "status": 0,
        "msg": "Ok",
        "protocolversion": "extjs.json"
    },
    "value": {
        "table": [
            [
                "admin",
                "Administrator",
                ""
            ],
            [
                "test",
                "Test",
                ""
            ]
        ],
        "total": 2
    }
} 
```

数据将显示在网格面板中，1 行是管理员，1 行是测试等。

试过：

`value`,`value.table`

如何让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T17:46:01.130

value.table 对于 root 属性是正确的，但是您使用的是 json 格式，我认为 Ext 没有设置为默认处理。它有一个用于读取对象数组的 json 读取器，而不是用于没有对象映射信息的嵌套字段值数组。

如果您必须使用该格式，您将需要创建自己的读取器/写入器或只使用 Ext.Ajax.request()，并在回调中将嵌套数组解析为对象。就像是：

```
Ext.Ajax.request({
    url: 'path.com/to/content',
    success: function (response, operation) {
        var data = Ext.JSON.decode(response.responseText);
        var fields = data.value.table;
        var records = [];
        Ext.Array.each(fields, function (fieldArray, fieldIndex) {
            Ext.Array.each(fieldArray, function(fieldValue, valueIndex) {
                //Create record object if it doesn't exist
                var record = records[valueIndex] || {};
                //Create a switch statement based on the array index to set fields
                switch(fieldIndex) {
                    case 0:
                        record.User_id = fieldValue;
                        break;
                    case 1:
                        record.Username = fieldValue;
                        break;
                }
            });
        });

        //Add the objects to the empty store
        store.add(records);
    }
}); 
```

无论如何，这都不是生产解决方案，因为它不处理列表末尾的空字符串，或者您在每个字段中得到一个参差不齐的数组数组的情况，我无法想象如何处理。如果它在您的控制或影响范围内，我建议您使用更像 Ext 建议的格式，以便您可以使用内置的 json 代理/读取器/写入器或疯狂使用它并实现 ext 的远程过程调用格式：

```
{
    "success": true,
    "message": "Success",
    "data": [
        {
            "User_id": "admin",
            "Username": "Administrator"
        }, {
            "User_id": "admin",
            "Username": "Administrator"
        }
    ]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:57:23.863

在上面的示例中，“值”是根属性。但对于 JSON 阅读器，它是一个属性名称（如果根是嵌套的，则它是一个以点分隔的属性名称列表）。

所以你可以分配到你需要关注的领域。

字段：['table.admin'，'table.test']

# unix - 修改重复行删除，订单保留，单行awk命令

> ID：15815993
> 
> 赞同：1
> 
> 时间：2013-04-04T15:55:11.040
> 
> 标签：unix, awk, uniq

我正在尝试处理来自 FE 代码的数据文件，以删除由未收敛计算生成的答案。我的文件基本上是两列数字。我从 stackoverflow 中的另一个提问者那里找到了一个有用的 AWK 解决方案（[解释这个重复行删除、订单保留、单行 awk 命令](https://stackoverflow.com/questions/10842118/explain-this-duplicate-line-removing-order-retaining-one-line-awk-command)）

```
awk '!x[$1]++' file > outFile 
```

这仅打印列 a 的值重复的一组行中的第一行

但是在我的数据文件中，第二列中的正确值将是列 a 重复的最后一行，例如：

对于包含数据的文件：

```
a   b
a   c
a   d
b   a
c   d
e   f 
```

`awk '!x[$1]++' file > outFile`生产

```
a   b
b   a
c   d
e   f 
```

但我需要生成

```
a   d
b   a
c   d
e   f 
```

是否可以通过修改 awk 之类的方法来做到这一点？

由 Ed Morton 编辑（抱歉，由于格式问题，我无法将其放在评论中）：

鉴于海报评论“*列 a 中的值可能对每个节点重复，但我只希望在它们相邻时删除重复项*”，我认为他的真实样本输入和预期输出将是这样的：

输入：

```
a   b
a   c
a   d
b   a
c   d
a   x
a   y
e   f 
```

输出：

```
a   d
b   a
c   d
a   y
e   f 
```

对于 OP - 如果我错了，请删除上面的内容。

编辑：

抱歉，我试图简化我的问题，但显然未能充分做到这一点。我不想发布一个完整的文件，因为这些是几个 mb 的 txt。每个文件包含按节点结果输出的数据（至少数百个节点）。每个节点数据都以标题部分开头：

```
 S:Min Principal (
                         Avg: 75p) PI: BLA
                         DE_MERGE-1 N: 143
              X                  6 
```

每个标题部分之后是一个两列列表。第一列是时间，第二列是该时间点和节点的计算值。但是，当计算不收敛时，可能会出现给定时间戳的重复条目。每次的最后一个条目将是正确的（收敛的）结果。时间可能（但可能不会）在节点之间重复，并且每次应该在每个节点中保留一行。

下面是文件中一个节点的示例输出。这个文件只有几次重复，可以手动编辑。在其他节点，大多数时间可能出现 10-15 次 - 重复次数各不相同 - 预期的时间点数也是如此。

```
 0\.                 0\.         
            2.E-03            -4.43054    
            4.5E-03           -4.43195    
           10.125E-03         -4.43515    
           22.7813E-03        -4.44235    
           51.2578E-03        -4.45856    
          115.33E-03          -4.49509    
          259.493E-03         -4.57752    
          583.859E-03         -4.76425    
            1.31368           -5.19031    
            2.95578           -6.24656    
            6.65051           -8.77117    
           14.9637           -11.385      
           32.4455           -11.385      
           52.4455           -11.385      
           72.4455           -11.385      
           92.4455           -11.385      
          100\.               -11.385      
          100\.               -11.385      
          102\.               -11.385      
          105.75             -11.385      
          114.188            -11.385      
          133.172            -11.385      
          175.887            -11.385      
          271.995            -11.6325     
          458.493            -27.0386     
          600\.               -32.1938     
          600\.               -32.1938     
          600.2              -32.1939     
          600.575            -32.1943     
          601.419            -32.1938     
          603.317            -32.192      
          607.589            -32.1879     
          617.2              -32.1759     
          638.824            -31.9507     
          687.479            -31.311      
          796.952            -29.3312     
            1.04327E+03      -27.8592     
            1.59748E+03      -25.3054     
            2.84445E+03      -21.0816     
            4.84445E+03      -20.8229     
            6.84445E+03      -20.8229     
            8.84445E+03      -20.8229     
           10.8444E+03       -20.8229     
           12.6E+03          -20.8229     
           12.6E+03          -20.8229     
           12.6002E+03       -20.8229     
           12.6006E+03       -20.8229     
           12.6014E+03       -20.8229     
           12.6033E+03       -20.8229     
           12.6076E+03       -20.8229     
           12.6172E+03       -20.8229     
           12.6388E+03       -20.8229     
           12.6875E+03       -19.8705     
           12.797E+03        -19.8283     
           12.9955E+03       -20.3811     
           13.1955E+03       -20.6489     
           13.3955E+03       -23.6448     
           13.5955E+03       -23.9506     
           13.7955E+03       -27.1146     
           13.9955E+03       -28.8359     
           14.1955E+03       -24.484      
           14.3955E+03       -11.7371     
           14.42E+03         -11.4293 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:30:53.107

```
awk 'NR>1 && $1!=p{print s} {p=$1;s=$0} END{print s}' file 
a   d
b   a
c   d
a   y
e   f 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T18:08:23.813

这是您`uniq`无需`sort`先使用即可使用的情况之一。如果第一个字段是固定宽度，您可以简单地执行以下操作：

```
uniq -w1 file
a   b
b   a
c   d
a   x
e   f 
```

如果不是固定宽度，请使用旧`rev`技巧：

```
rev file | uniq -f1 | rev
a   b
b   a
c   d
a   x
e   f 
```

注意：使用**[EdMorton](https://stackoverflow.com/users/1745001/ed-morton)**的代表输入作为`file`.

# javascript - 使用带有可选 https 的 FineUploader？

> ID：15815996
> 
> 赞同：1
> 
> 时间：2013-04-04T15:55:30.027
> 
> 标签：javascript, cors, fine-uploader

我已经在一个站点上设置了 FineUploader，并且我包含了一个复选框，允许用户根据需要使用 HTTPS 上传文件。

不幸的是，如果用户使用 http 访问该站点，然后尝试使用 ssl 它会出错，我认为是因为 CORS 问题。我认为这是一个 CORS 问题，因为如果我使用 https 访问该站点并尝试使用 ssl 上传它可以正常工作。

我找到[了一些](http://blog.fineuploader.com/2013/01/31/cors-support-in-3-3/)关于启用 CORS 支持的文档，但似乎您要么需要这样做，要么只发出 CORS 请求，或者不发出任何请求。在我的情况下，有时会有 CORS 请求而不是其他请求。

有谁知道解决这个问题的好方法？单击复选框时，我是否应该使用 HTTPS 重新加载整个页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-02-22T11:00:59.150

**如果您要直接上传到 Amazon s3 ，请参阅**[官方文档](http:////%20Alternative%20might%20be%20just%20the%20double%20slash%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20default%20documentation%20suggests%20the%20simpler%20mybucket.s3.amazonaws.com)中的注释，*“SSL 也受支持，在这种情况下，您的`endpoint`地址必须以`https://`”*开头，在您的 uploaderpage.html 文件中的脚本中。

```
request: {
    endpoint: 'https://mybucket.s3.amazonaws.com', 
                // Note that "https://" added before bucket name, to work over https                     
    accessKey: 'AKIAblablabla' // as per the specific IAM account
}, 
```

*   如果 uploaderpage.html 通过 http 提供服务，这仍然有效（或者如果您需要灵活的端点，您可以动态填充端点值）。
*   这将帮助您避免通过 https 上传时出现混合内容错误，“请求不安全的 XMLHttpRequest 端点”，如果页面是 https 但您请求 http 端点，则会发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:58:18.427

只是重申我在评论中提到的内容（这样其他人可以很容易地看到这一点）......

也许您可以在用户选择 HTTP 或 HTTPS 作为上传协议后实例化 Fine Uploader。如果必须，您可以通过选项的`expected`属性启用 CORS 功能`cors`。请记住，在处理 CORS 请求时，您必须在服务器端处理一些细节，尤其是在涉及 IE9 或更早版本的情况下。有关更多详细信息， 请参阅[我关于 CORS 功能的博客文章。](http://blog.fineuploader.com/2013/01/31/cors-support-in-3-3/)

# c# - 将正则表达式与 xml 一起使用

> ID：15815998
> 
> 赞同：0
> 
> 时间：2013-04-04T15:55:39.937
> 
> 标签：c#, xml, regex

我有一个 xml 文件：

`"<?xml version=\"1.0\" encoding=\"utf-8\"?><response list=\"true\"><count>2802</count><post><id>4210</id><from_id>2176594</from_id><to_id>-11423648</to_id><date>1365088358</date><text>dsadsad #ADMIN</text>...`

我想在`<from_id>`and之间取一个字符串`</from_id>`。

我有一个正则表达式`<from_id>(.*?)</from_id>`，但它返回带有标签的字符串。你能帮助我吗？等待回复） PS：对不起我的英语不好！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T16:02:40.207

[正如其他人已经指出的那样，使用 XML 解析器](https://stackoverflow.com/questions/55828/how-does-one-parse-xml-files)可能会更安全、更干净。

也就是说，您已经有了一个有效的正则表达式。只要确保检索捕获组#1。这会让你得到第一对括号内的内容。

如果您使用的是 C#，而不是调用`toString()`，[`Match`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.match.aspx)请查看其[`Groups`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.match.groups.aspx)属性并获取其第一个元素：

```
string pattern = "<from_id>(.*?)</from_id>";
string input = "<?xml version=\"1.0\" encoding=\"utf-8\"?><response list=\"true\"><count>2802</count><post><id>4210</id><from_id>2176594</from_id><to_id>-11423648</to_id><date>1365088358</date><text>dsadsad #ADMIN</text>";
Match match = Regex.Match(input, pattern);
if (match.Success){
    System.Console.WriteLine(match.Groups[1].Value);
} 
```

看到它在这个[**Ideone**片段](http://ideone.com/zVrCLP)中工作。

如果你想获得模式的所有匹配，你可以使用，并以相同的方式[`Regex.Matches()`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.matches.aspx)迭代每个。`Match``MatchCollection`

# python - 有没有标准的方法在 Python 中存储 XY 数据？

> ID：15815999
> 
> 赞同：10
> 
> 时间：2013-04-04T15:55:52.917
> 
> 标签：python, numpy, standards

在 Python 中是否有存储 (x,y)、(x,y,z) 或 (x,y,z,t) 数据的*标准方法？*

我知道 NumPy 数组经常用于这样的事情，但我想你也可以使用 NumPy 矩阵来做到这一点。

我已经看到使用两个压缩在一起的列表，这完全是使用 NumPy 的一步。

```
XY_data = zip( [x for x in range(0,10)] , [y for y in range(0,10)] ) 
```

有*标准*吗？如果没有，你*最喜欢*的方式是什么，或者你见过最多的方式是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T16:04:31.260

一种不错的方法是使用[结构化数组](http://docs.scipy.org/doc/numpy/user/basics.rec.html)。这提供了 NumPy 数组的所有优点，但它具有方便的访问结构。

要使 NumPy 数组成为“结构化”数组，您需要做的就是为其提供`dtype`参数。这为每个“字段”提供了名称和类型。如果您愿意，它们甚至可以具有更复杂的形状和层次结构，但这是我保存 xy 数据的方式：

```
In [175]: import numpy as np

In [176]: x = np.random.random(10)

In [177]: y = np.random.random(10)

In [179]: zip(x,y)
Out[179]:
[(0.27432965895978034, 0.034808254176554643),
 (0.10231729328413885, 0.3311112896885462),
 (0.87724361175443311, 0.47852682944121905),
 (0.24291769332378499, 0.50691735432715967),
 (0.47583427680221879, 0.04048957803763753),
 (0.70710641602121627, 0.27331443495117813),
 (0.85878694702522784, 0.61993945461613498),
 (0.28840423235739054, 0.11954319357707233),
 (0.22084849730366296, 0.39880927226467255),
 (0.42915612628398903, 0.19197320645915561)]

In [180]: data = np.array( zip(x,y), dtype=[('x',float),('y',float)])

In [181]: data['x']
Out[181]:
array([ 0.27432966,  0.10231729,  0.87724361,  0.24291769,  0.47583428,
        0.70710642,  0.85878695,  0.28840423,  0.2208485 ,  0.42915613])

In [182]: data['y']
Out[182]:
array([ 0.03480825,  0.33111129,  0.47852683,  0.50691735,  0.04048958,
        0.27331443,  0.61993945,  0.11954319,  0.39880927,  0.19197321])

In [183]: data[0]
Out[183]: (0.27432965895978034, 0.03480825417655464) 
```

其他人可能会建议使用[Pandas](http://pandas.pydata.org/)，但如果您的数据相对简单，那么普通的 NumPy 可能会更容易。

您可以根据需要添加层次结构，但通常它比必要的复杂。

例如：

```
In [200]: t = np.arange(10)

In [202]: dt = np.dtype([('t',int),('pos',[('x',float),('y',float)])])

In [203]: alldata = np.array(zip(t, zip(x,y)), dtype=dt)

In [204]: alldata
Out[204]:
array([(0, (0.27432965895978034, 0.03480825417655464)),
       (1, (0.10231729328413885, 0.3311112896885462)),
       (2, (0.8772436117544331, 0.47852682944121905)),
       (3, (0.242917693323785, 0.5069173543271597)),
       (4, (0.4758342768022188, 0.04048957803763753)),
       (5, (0.7071064160212163, 0.27331443495117813)),
       (6, (0.8587869470252278, 0.619939454616135)),
       (7, (0.28840423235739054, 0.11954319357707233)),
       (8, (0.22084849730366296, 0.39880927226467255)),
       (9, (0.429156126283989, 0.1919732064591556))],
      dtype=[('t', '<i8'), ('pos', [('x', '<f8'), ('y', '<f8')])])

In [205]: alldata['t']
Out[205]: array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])

In [206]: alldata['pos']
Out[206]:
array([(0.27432965895978034, 0.03480825417655464),
       (0.10231729328413885, 0.3311112896885462),
       (0.8772436117544331, 0.47852682944121905),
       (0.242917693323785, 0.5069173543271597),
       (0.4758342768022188, 0.04048957803763753),
       (0.7071064160212163, 0.27331443495117813),
       (0.8587869470252278, 0.619939454616135),
       (0.28840423235739054, 0.11954319357707233),
       (0.22084849730366296, 0.39880927226467255),
       (0.429156126283989, 0.1919732064591556)],
      dtype=[('x', '<f8'), ('y', '<f8')])

In [207]: alldata['pos']['x']
Out[207]:
array([ 0.27432966,  0.10231729,  0.87724361,  0.24291769,  0.47583428,
        0.70710642,  0.85878695,  0.28840423,  0.2208485 ,  0.42915613]) 
```