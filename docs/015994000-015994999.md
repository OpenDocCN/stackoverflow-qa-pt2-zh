# StackOverflow 问答 15994000-15994999

# bash - CocoaDialog 标准下拉混淆

> ID：15994001
> 
> 赞同：0
> 
> 时间：2013-04-13T23:20:36.127
> 
> 标签：bash

我有两个可能相关的问题。首先，我的返回值显然没有设置为结果变量。其次， --button1 标志及其相关文本实际上显示在 --items 列表中。我已经尝试了所有可能的 "$result" == "#" 场景 - 引号、无引号和混合引号，但我仍然得到不同的结果。

```
 #!/bin/bash

CD="/Applications/CocoaDialog.app/Contents/MacOS/CocoaDialog"

result=`$CD standard-dropdown --title "Database Tasks" --text "What would you like 
to             
do?"        
--items "Clear Pending Commands" "Clear Verify Signature" "Show Processlist" --button1 "OK"`

if [ "$result" == 0 ]; then
echo "Clearing commands"
elif  [ "$result" == 1 ]; then
echo "Verifying"
elif  [ "$result" == 2 ]; then
echo "Process"
fi 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T01:45:44.863

我想通了。下拉列表返回多个返回。我添加了 | tail -1 到我的命令以获取最后一行返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-01T20:22:15.100

我知道这是一个老问题，但是对于遇到此 cocoadialog 的其他任何人来说，都可以使用 --quiet 来消除单击 OK/no/cancel 的响应。

# django - 在 Django 中，如何实现一个表单来将多个用户分配给一个项目？

> ID：15994002
> 
> 赞同：1
> 
> 时间：2013-04-13T23:20:44.163
> 
> 标签：django, django-models, django-forms

我有两个模型需要为其创建表单。

```
def Item(models.Model):
    title = models.CharField()
    description = models.TextField()

def ItemUser(models.Model):
    item = models.ForeignKey(Item)
    user = models.ForeignKey(User) 
```

我需要制作一个表单，用户可以在其中创建新项目并能够添加/删除多个 ItemUser。由于我使用电子邮件地址作为用户 ID，因此我计划将其作为 ItemUser 的输入。所以表单应该呈现用于获取电子邮件地址的输入框，然后在后端我需要获取这些电子邮件地址的用户 ID 以保存到 ItemUser 表中。

如何在 Django 中实现这个表单？

编辑：

添加另一个模型示例以增加清晰度。

```
def Blog(models.Model):
    creator = models.ForeignKey(User)
    title = models.CharField()
    description = models.TextField()

def BlogAccessUser(models.Model):
    blog = models.ForeignKey(Blog)
    access_user = models.ForeignKey(User) 
```

每个博客都有一个允许访问它的用户列表。因此，在表单中，用户将创建一个博客并将多个用户添加到该博客。类似于 Google DOCS 中的“共享”功能，我可以将多个用户添加到我的文档中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T08:27:02.090

> 用户可以在哪里创建新项目

所以这表明一个项目属于一个用户，一对一的关系。所以让我们从这个开始......

```
def Item(models.Model):
    title = models.CharField()
    description = models.TextField()
    user = models.OneToOneField(User, related_name="item") 
```

> 能够添加/删除多个 ItemUser

这将建议多对多关系，因此您还需要将其添加到项目模型中......

```
def Item(models.Model):
    title = models.CharField()
    description = models.TextField()
    user = models.OneToOneField(User, related_name="item")
    item_users = models.ManyToManyField(ItemUser, related_name="item") 
```

> 我需要做一个表格

因此，为此您创建了一个模型表单，您可以对电子邮件进行过滤，因为您可以看到电子邮件在您创建表单时传递了**init**。

```
 class ItemForm(forms.ModelForm):
        class Meta:
            model = Item

          def __init__(self, email=None, *args, **kwargs):
          super(ItemForm, self).__init__(*args, **kwargs)

        # Representing the many to many related field in Item
        ItemUsers = forms.ModelMultipleChoiceField(queryset=ItemUser.objects.filter(user__email=email))
self.fields['item_users'] = forms.ModelChoiceField(queryset=ItemUsers) 
```

就是这样，在您看来，只需传递电子邮件进行过滤，`form = itemForm(email=email)`

以上是手绘的，所以可能会有一些错误，但它应该给你正确的想法，希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-16T12:37:29.657

原始问题的答案是在 Django 中使用表单集。我最终使用了 InlineFormset 并为表单编写了自定义渲染方法。我还使用 JS 来动态添加/删除表单。

# java - 保持 JComboBox 大小

> ID：15994004
> 
> 赞同：0
> 
> 时间：2013-04-13T23:20:48.847
> 
> 标签：java, swing, jpanel, jcombobox, layout-manager

我想为一个项目制作一个帐户屏幕，但我还是 GUI 的新手。这是我第一次使用 JComboBox，我遇到了一些麻烦。我想基本上将 JComboBox 放在一个框内，这将是我的背景图像的一部分。我尝试使用 BorderLayout，但这只是做了一个巨大的组合框，占据了我的整个屏幕。我在这里有[我的代码](http://pastebin.com/U98ee1W1)和一张图，它在下面说明了我的目标：![我的目标](https://i.stack.imgur.com/uf7xr.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:01:59.880

有关可以轻松居中包含组合框的面板的 2 个布局， 请参阅[此答案。](https://stackoverflow.com/a/7181197/418556)

![](https://i.stack.imgur.com/QsSEU.png)

在该面板中使用边框和布局填充来获得所需的空白。

# ruby - 我已经安装了 1.9.3 ruby 版本，但 --version 显示我有 1.8.7？

> ID：15994007
> 
> 赞同：0
> 
> 时间：2013-04-13T23:21:03.810
> 
> 标签：ruby, version, upgrade

我的电脑上有 1.8.7 ruby​​ 版本。今天下午我在我的opensuse操作系统上安装了1.9.3，但是当我写“ruby --version”时它说我还有ruby 1.8.7。

我不知道为什么...有人可以告诉我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:29:28.470

如果您正在使用`rvm`，您可以像这样切换到使用 1.9.3 ruby​​：

```
rvm use 1.9.3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:37:50.037

如果您使用[RVM](https://rvm.io)安装它，您可以通过执行以下操作将默认 ruby​​ 切换并设置为 1.9.3：

```
rvm --default use 1.9.3 
```

# knockout.js - 启用和禁用精细上传器

> ID：15994012
> 
> 赞同：1
> 
> 时间：2013-04-13T23:21:28.967
> 
> 标签：knockout.js, fine-uploader

我正在使用精细上传器和淘汰赛。我只想在用户单击某个按钮时启用精细上传。在页面加载时，我想禁用精细上传器并仅在单击某个按钮时启用。

我的尝试：

```
<input type="text" class="input-medium"  data-bind="value: someThing"/>
                            <div class="fileupload fileupload-new pull-right" data-bind="enable:$root.isClicked,uploader: true"> 
```

isClicked 是一个最初为假的可观察对象。因此，应该禁用fineuploader，但事实并非如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:27:16.957

正如我在上一条评论中提到的，只需在适当的时候显示或隐藏包含上传器的容器。如果您需要将上传重置为原始状态，请使用[`reset`API 方法](https://docs.fineuploader.com/branch/master/api/methods.html#reset)。

# mysql - 如何将文件上传到数据库

> ID：15994018
> 
> 赞同：2
> 
> 时间：2013-04-13T23:21:41.663
> 
> 标签：mysql, vb.net

好的，所以我试图上传到数据库，选择文件的名称、类型、大小（以字节为单位）以及它自己到数据库的文件。到目前为止，除了将自己的文件上传到数据库之外，我一切顺利。所以我的问题是我如何将文件本身上传到数据库

这是我已经拥有的代码

```
 Dim s = My.Computer.FileSystem.GetFileInfo(OpenFileDialog1.FileName)
    MessageBox.Show("File Name:" & s.Name)
    MessageBox.Show("File Type:" & s.Extension)
    MessageBox.Show("File Size (Bytes):" & s.Length)
    Try

        Dim cmd As New MySqlCommand
        Dim insertStatment As String = "INSERT INTO upload (name, type, size) VALUES 
        (@name, @type, @size)"
        cmd = New MySqlCommand(insertStatment, db_con)
        cmd.Parameters.AddWithValue("@name", s.Name)
        cmd.Parameters.AddWithValue("@type", s.Extension)
        cmd.Parameters.AddWithValue("@size", s.Length)

        cmd.ExecuteNonQuery()
        MessageBox.Show("ok")
        db_con.Close()
           Catch ex As Exception
        MessageBox.Show("Something went wrong, please try again")
        db_con.Close()
       End Try 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:26:42.063

看看这个链接

[http://mirificamppress.com/permalink/saving_a_file_into_mysql](http://mirificampress.com/permalink/saving_a_file_into_mysql)

这是我一个月前遇到同样问题时使用的方法，它对我有用。它在 C# 中，但它与 VB.NET 完全相同，我相信将此处给出的 C# 代码转换为 VB.NET 不会成为问题

# c# - ListViewItem IsSelected 绑定 - 适用于 WPF，但不适用于 WinRT

> ID：15994021
> 
> 赞同：10
> 
> 时间：2013-04-13T23:22:10.200
> 
> 标签：c#, xaml, windows-runtime, winrt-xaml

我正在尝试将 ListViewItem 的 IsSelected 属性绑定到 ViewModel 中的属性。它在 WPF 中运行良好，但在 Windows RT 中，IsSelected 属性永远不会被设置。

```
public class Item : INotifyPropertyChanged
{
    private readonly string name;
    private bool isSelected;
    public event PropertyChangedEventHandler PropertyChanged;

    public bool IsSelected
    {
        get { return isSelected; }
        set { isSelected = value; RaisePropertyChanged("IsSelected"); }
    }

    public string Name { get { return name; } }

    public Item(string name)
    {
        this.name = name;
    }

    protected void RaisePropertyChanged(string propertyName)
    {
        var handler = PropertyChanged;
        if (handler != null)
            handler.Invoke(this, new PropertyChangedEventArgs(propertyName));
    }
}

public class ViewModel
{
    private readonly ObservableCollection<Item> items = new ObservableCollection<Item>(Enumerable.Range(0, 10).Select(p => new Item(p.ToString())));
    public ObservableCollection<Item> Items { get { return items; } }
}

public sealed partial class MainPage : Page
{
    public MainPage()
    {
        this.InitializeComponent();
        DataContext = new ViewModel();
    }
} 
```

xml:

```
<StackPanel Orientation="Horizontal">
    <ListView ItemsSource="{Binding Path=Items}" SelectionMode="Multiple">
        <ListView.ItemContainerStyle>
            <Style TargetType="ListViewItem">
                <Setter Property="IsSelected" Value="{Binding Path=IsSelected, Mode=TwoWay}"/>
            </Style>
        </ListView.ItemContainerStyle>
    </ListView>
    <ListView.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Path=Name}"/>
         </DataTemplate>
     </ListView.ItemTemplate>
</StackPanel> 
```

我可以单击屏幕上的项目，但 IsSelected 属性没有传播到 ViewModel。任何想法为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:30:26.290

从 Windows 8.0 开始，WinRT 根本不支持 setter 中的绑定。必应寻找解决方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-18T11:12:20.677

一个很好且简单的方法是继承 ListView

```
public class MyListView : ListView
    {
        protected override void PrepareContainerForItemOverride(Windows.UI.Xaml.DependencyObject element, object item)
        {
            base.PrepareContainerForItemOverride(element, item);
            // ...
            ListViewItem listItem = element as ListViewItem;
            Binding binding = new Binding();
            binding.Mode = BindingMode.TwoWay;
            binding.Source = item;
            binding.Path = new PropertyPath("Selected");
            listItem.SetBinding(ListViewItem.IsSelectedProperty, binding);
        }
    } 
```

**或者**，您似乎也可以使用[WinRT XAML Toolkit](http://winrtxamltoolkit.codeplex.com/)来完成。

```
<ListView
            x:Name="lv"
            Grid.Row="1"
            Grid.Column="1"
            SelectionMode="Multiple"
            HorizontalAlignment="Left"
            Width="500">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <TextBlock
                        Extensions:ListViewItemExtensions.IsSelected="{Binding IsSelected}"
                        Extensions:ListViewItemExtensions.IsEnabled="{Binding IsEnabled}"
                        Text="{Binding Text}"
                        Margin="15,5"
                        FontSize="36" />
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView> 
```

就个人而言，我使用了第一种方法，因为它更灵活，并且我需要绑定一些自动化属性。

感谢 ForInfo 和 ehuna： [http ://social.msdn.microsoft.com/Forums/windowsapps/en-US/9a0adf35-fdad-4419-9a34-a9dac052a2e3/listviewitemisselected-data-binding-in-style-setter-is-不工作](http://social.msdn.microsoft.com/Forums/windowsapps/en-US/9a0adf35-fdad-4419-9a34-a9dac052a2e3/listviewitemisselected-data-binding-in-style-setter-is-not-working)

# google-app-engine - 一个谷歌应用引擎应用如何服务于多个域？

> ID：15994024
> 
> 赞同：5
> 
> 时间：2013-04-13T23:22:33.933
> 
> 标签：google-app-engine, multi-tenant, forwarding, domain-name

或者可以做到吗？

例如，我想帮助几个朋友建立他们的购物车网站。他们已经购买了他们的网站域名。但是我想在[*www.mywebsite.com*](http://www.mywebsite.com)支付一个谷歌应用引擎应用程序，并且我想将他们的域“转发”到[www.mywebsite.com/friend1](http://www.mywebste.com/friend1)，[www.mywebsite.com/friend2](http://www.mywebsite.com/frend2)。通过这种方式，我希望他们的客户看到他们的网站，可能是[http://www.friend1.com](http://friend1.com)，但他们实际上是由一个单一的应用程序引擎应用程序提供服务的。

在我的应用程序中，我知道如何分析路径，以便我可以去数据存储区提供不同的页面，html。所以问题是如何或可以从不同的域转发一个谷歌应用程序引擎。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-19T13:38:49.603

I'm not quite sure what is your exact meaning of "forward", but I try to answer for different situations.

1.  If you want the browser to keep displaying www.friend1.com all the way without ever showing www.mywebsite.com, you should have friend1.com setup as a Google App account, and add their domain into your application (just like you did for your own domain). This way, all traffic to www.friend1.com (or what ever subdomain they pick) goes to your appengine app. And your App should detect the domain of the http request and response accordingly.

2.  If you just want a "redirect"... that means, user goes to www.friend1.com will have their browser auto goes to www.mywebsite.com/friend1 and displaying it in the URL bar , well, just setup one index.html page in www.friend1.com and add [meta refresh header](http://en.wikipedia.org/wiki/Meta_refresh) in the file. Or use any server side redirect method.

# knapsack-problem - 如何从 01-knapsack 算法的 scanf 值中读取并传递给函数

> ID：15994025
> 
> 赞同：0
> 
> 时间：2013-04-13T23:22:41.410
> 
> 标签：knapsack-problem

如果我输入数字：

```
3 10
7 6
5 5 
4 5 
```

输出是：9。好的——这是正确的值。但如果我输入：

```
10 25
3 5
3 5
3 5 
3 5
3 5
3 5
3 5
3 5
3 5
3 5 
```

正确的输出应该是：15 但我收到 2005985278。这段代码有什么问题？

```
#include<stdio.h>
#include<stdlib.h>
#define MA 29
int max(int a, int b) { 
return (a > b)? a : b; 
}
int knapsack(int W, int P[], int V[], int N)
{
int i, w;
int K[N+1][W+1];

for (i = 0; i <= N; i++)
  {
  for (w = 1; w <= W; w++)
    {
      if (i==0 || w==0)
          K[i][w] = 0;
      else if (P[i-1] <= w)
          K[i][w] = max(V[i-1] + K[i-1][w-P[i-1]],  K[i-1][w]);
      else
          K[i][w] = K[i-1][w];
    }
  }

return K[N][W];
}

int main()
{
int N,W,i;// N: Quantidade de Objetos - W: Capacidade da Mochila; i: interação
int Val=1;//V: Valor;
int Pes=1;//P: Peso;
do{

    scanf("%d %d",&N,&W);//ler N e W
    for (i=1;i<=N;i++) // iteração 
    scanf("%d %d",&Val,&Pes);//ler V
    //ler P
    int V[]={Val};//declaração do vetor V e recebendo Val do scanf
    int P[]={Pes};//declaração do vetor P e recebendo Pes do scanf
    printf("%d",knapsack(W, P, V, N));
    printf("\n");
    }while(N!=0 && W!=0);

return 0;
} 
```

我需要输入物品数量N和容量W：

当我输入 N = 1, W - 7 和对象 P = 4, V = 5 时，输出为 4。

如果我输入其他值，例如 N = 10、W = 25 和 P = 3 3 3 3 3 3 3 3 3 3、V = 5 5 5 5 5 5 5 5 5 5，我会收到 2005985278 而不是 15。

请问我的代码有什么错误？

* * *

现在我的代码是这样的，但我在输出中收到错误：3 10 7 6 5 5 4 5

1 7 4 5

正确的输出是：9 和 4，我收到 7 和 0；在这种情况下，我如何在输入 N==0 && W==0 时添加程序的结尾？

```
#include<stdio.h>
#include<stdlib.h>
#define MA 29
int max(int a, int b) { 
return (a > b)? a : b; 
}
int knapsack(int W, int P[], int V[], int N)
{
int i, w;//interação;
int K[N+1][W+1];//declaração de K recebendo o valor de N e W +1;

 for (i = 0; i <=N; i++) // para i=0 i< = N incrementa i;
 {
   for (w = 0; w <= W; w++)
   {

       if (i==0 || w==0)
           K[i][w] = 0;
       else if (P[i-1] <= w)
             K[i][w] = max(V[i-1] + K[i-1][w-P[i-1]],  K[i-1][w]);
       else
             K[i][w] = K[i-1][w];
   }
 }

  return K[N][W];
 }

 int main()
{
 int N,W,i;// N: Quantidade de Objetos - W: Capacidade da Mochila; i: interação
 //P: Peso;

    while (scanf("%d %d", &N, &W) == 2)

{
    int V[N];
    int P[N];

for (i = 1; i <= N; i++)
    if (scanf("%d %d", &V[i], &P[i]) != 2)
        break;       
printf("%d\n", knapsack(W, P, V, N));
}

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T02:38:00.040

您的问题是您正在分配大小为 1 的数组，然后尝试访问这些数组中的 10 个元素。C 不会阻止你尝试，但它通常会给你错误的答案。

现有代码：

```
do{
    scanf("%d %d",&N,&W);   // Should test for success and terminate loop on failure
    for (i=1;i<=N;i++)
        scanf("%d %d",&Val,&Pes);  // Should check for success; should store values

    int V[]={Val};  // V is an array with one entry, the last value entered as Val.
    int P[]={Pes};  // P is an array with one entry, the last value entered as Pes.
    printf("%d",knapsack(W, P, V, N));
    printf("\n");
} while (N!=0 && W!=0); 
```

C99 代码：

```
while (scanf("%d %d", &N, &W) == 2)
{
    int V[N];
    int P[N];
    for (i = 1; i <= N; i++)
        if (scanf("%d %d", &V[i], &P[i]) != 2)
            break;       
    printf("%d\n", knapsack(W, P, V, N));
} 
```

请注意，如果您将输入打印到`knapsack()`函数中，无论是在调用代码中还是在函数本身中，您都会很快发现问题。在您完成阅读后打印输入数据是一种强大的技术。请注意，在您阅读时打印它可以掩盖在您完成阅读后打印会发现的问题。

显然，如果你的背包算法不正确，你仍然会得到错误的答案；我没有对此进行审查，也没有特别计划这样做。但是，您应该获得正确的输入数据，这极大地提高了获得正确输出的机会。

# jquery - jquery .prepend 克隆错误

> ID：15994026
> 
> 赞同：0
> 
> 时间：2013-04-13T23:22:46.873
> 
> 标签：jquery, prepend, cloning

当屏幕小于 480 像素且滚动大于 80 时，我正在尝试向导航栏添加一个项目。该项目的多个副本被插入到我的主导航中。有人可以帮我理解为什么会这样吗？[你可以去这里](http://stephencranedesign.com/portfolio)看看发生了什么。

```
$(function () {
    var $window = $(window);
    var $width = $(window).width();

    function windowWidth() {
        if ($width < 480) {
            function top() {
                var $top = $window.scrollTop();
                if ($top < 80) {
                    $(".main-nav").css({
                        'position': '',
                        'width': '99.5%'
                    });
                    $(".thick-line-header").css("display", "");
                } else {
                    var $homeTab = $('<li class="home"><a href="#top" >test</a></li>');
                    $(".main-nav li").css({
                        'position': 'fixed',
                        'width': '100%',
                        'top': '0',
                        'left': '0',
                        'margin-top': '0'
                    });
                    $("#main-nav").prepend($homeTab);
                    $(".thick-line-header").css("display", "none");
                }
            };
            $(window).scroll(top);
        }
    };
    windowWidth();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:29:24.573

我试图重现你的错误，但我没有机会，也许我错过了一些东西无论如何我想你需要添加一个标志天气数据是否已经添加过，因为你的条件不止一次并且在你滚动时

```
var added = false; 
$(function() {
    var $window = $(window);
    var $width = $(window).width();
    function windowWidth() {
        if ( $width< 480 ) {
            function top() {
                var $top = $window.scrollTop();
                if( $top < 80 ) {
                   $(".main-nav").css({
                      'position': '',
                      'width': '99.5%'
                   }); 
                   $(".thick-line-header").css("display",""); 
                }
                else {
                   var $homeTab = $('<li class="home"><a href="#top" >test</a></li>');
                   $(".main-nav li").css({
                      'position': 'fixed',
                      'width': '100%', 
                      'top':'0', 
                      'left':'0', 
                      'margin-top':'0'
                   });
                   if(!added) {
                      $("#main-nav").prepend($homeTab);
                      added = true; 
                   }
                   $(".thick-line-header").css("display","none");    
                }
             };
             $(window).scroll(top);
          }
       };
       windowWidth();
    }); 
```

我希望这可以帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:41:51.887

你给了一个位置：固定在列表项上。您需要在容器上设置“固定”选项。例如

```
$(".main-nav").css({'position': 'fixed', 'width': '100%', 'top':'0', 'left':'0', 'margin-top':'0'}); 
```

代替

```
$(".main-nav li").css({'position': 'fixed', 'width': '100%', 'top':'0', 'left':'0', 'margin-top':'0'}); 
```

希望这可以帮助！

# firefox - 有没有一种简单的方法来检查/编辑存储在 nsIPrefBranch 中的值？

> ID：15994028
> 
> 赞同：0
> 
> 时间：2013-04-13T23:23:22.497
> 
> 标签：firefox, firefox-addon, xpcom

我正在寻找一种方法来快速编辑和查看我的扩展凭据列表（我使用 nsIPrefBranch 来存储它）。

有什么简单的方法可以做到这一点吗？我试图查看它的存储位置，但找不到它。

非常感谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T11:07:28.223

知道了，它在 %appdata%\Mozilla\Firefox\Profiles{ID}\prefs.js 里面

# java - 我从未见过的 MPJ Express 错误

> ID：15994032
> 
> 赞同：1
> 
> 时间：2013-04-13T23:23:27.633
> 
> 标签：java, mpi

我收到此运行时错误：

```
MPJ Express (0.35) is started in the cluster configuration
Starting process <0> on <Tornado>
Starting process <1> on <Predator>
mpi.MPIException: Error in SimplePacker : count <1> is less than length <2>
        at mpi.SimplePackerChar.unpack(SimplePackerChar.java:105)
        at mpi.Comm.recv(Comm.java:1305)
        at mpi.Comm.Recv(Comm.java:1255)
        at PingPongVariousLengths.main(PingPongVariousLengths.java:29)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at runtime.daemon.Wrapper.execute(Wrapper.java:165)
        at runtime.daemon.Wrapper.main(Wrapper.java:180)
java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at runtime.daemon.Wrapper.execute(Wrapper.java:165)
        at runtime.daemon.Wrapper.main(Wrapper.java:180)
Caused by: mpi.MPIException: mpi.MPIException: mpi.MPIException: Error in Simple
Packer : count <1> is less than length <2>
        at mpi.Comm.Recv(Comm.java:1259)
        at PingPongVariousLengths.main(PingPongVariousLengths.java:29)
        ... 6 more
Caused by: mpi.MPIException: mpi.MPIException: Error in SimplePacker : count <1>
 is less than length <2>
        at mpi.Comm.recv(Comm.java:1317)
        at mpi.Comm.Recv(Comm.java:1255)
        ... 7 more
Caused by: mpi.MPIException: Error in SimplePacker : count <1> is less than leng
th <2>
        at mpi.SimplePackerChar.unpack(SimplePackerChar.java:105)
        at mpi.Comm.recv(Comm.java:1305)
        ... 8 more 
```

没看懂什么意思

这是导致它的代码：

```
import mpi.* ;

class PingPongVariousLengths {

    static public void main(String[] args) {

        MPI.Init(args);
        int myrank = MPI.COMM_WORLD.Rank();
        int tag = 99;
        int maxlen = 104857600; //200 megabytes     104857600 characters * 2 bytes per character = 209715200 bytes total, or 200 megabytes
        int minlen = 1; // 2 bytes
        char [] sendbuff = new char [maxlen];
        char [] recvbuff = new char [maxlen];
        long speedKbps;
        long speedMbps;
        long durationseconds;
int MAX_LOOPS = 20;

for (int len = minlen; len <= maxlen; len *= 2) {
        if (myrank == 0) {
                durationseconds = 0;
                for (int i = 0; i < MAX_LOOPS; i++) {
                        long startTime = System.nanoTime();           
                        MPI.COMM_WORLD.Send(sendbuff, 0, len, MPI.CHAR, 1, tag);
                        MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 1, tag);
                        long endTime = System.nanoTime();
                        long duration = endTime - startTime;
                        durationseconds = durationseconds + (duration* 10-9);
                }
                durationseconds = durationseconds / MAX_LOOPS;
                System.out.println("Average time for the ping to be sent and recived of " + (len*2) + " bytes is " + durationseconds + " seconds");
                double transferRateMb = ((len*524288.0) / durationseconds );
                System.out.println("average transferRate (megabytes) : " + transferRateMb + " megabytes per second");
        } else if (myrank == 1) {
                MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 0, tag);
                MPI.COMM_WORLD.Send(recvbuff, 0, len, MPI.CHAR, 0, tag);
        }
}

        MPI.Finalize();
    }
} 
```

是什么导致了错误，如何解决？

艾迪特

将 minlength 更改为 2

```
import mpi.* ;

class PingPongVariousLengths {

    static public void main(String[] args) {

        MPI.Init(args);
        int myrank = MPI.COMM_WORLD.Rank();
        int tag = 99;
        int maxlen = 104857600; //200 megabytes     104857600 characters * 2 bytes per character = 209715200 bytes total, or 200 megabytes
        int minlen = 2; // 2 bytes
        char [] sendbuff = new char [maxlen];
        char [] recvbuff = new char [maxlen];
        long speedKbps;
        long speedMbps;
        long durationseconds;
int MAX_LOOPS = 20;

for (int len = minlen; len <= maxlen; len *= 2) {//len=*2 doubles the ping size each time
        if (myrank == 0) {
                durationseconds = 0;
                for (int i = 0; i < MAX_LOOPS; i++) {
                        long startTime = System.nanoTime();           
                        MPI.COMM_WORLD.Send(sendbuff, 0, len, MPI.CHAR, 1, tag);
                        MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 1, tag);
                        long endTime = System.nanoTime();
                        long duration = endTime - startTime;
                        durationseconds = durationseconds + (duration* 10-9);// Converts nanoseconds to seconds
                }
                durationseconds = durationseconds / MAX_LOOPS;
                 //double transferRate = ((len*2.0) / durationseconds ) ; //amount of data in bytes transferred in 1 second. Currently returning 0 for every result
                //System.out.println("transferRate: " + transferRate + " bytes per second");
                System.out.println("Average time for the ping to be sent and recived of " + (len*2) + " bytes is " + durationseconds + " seconds");
                double transferRateMb = ((len*524288.0) / durationseconds );
                System.out.println("average transferRate (megabytes) : " + transferRateMb + " megabytes per second");
        } else if (myrank == 1) {
                MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 0, tag);
                MPI.COMM_WORLD.Send(recvbuff, 0, len, MPI.CHAR, 0, tag);
        }
}

        MPI.Finalize();
    }
} 
```

并收到此错误：

```
PongVariousLengths
MPJ Express (0.35) is started in the cluster configuration
Starting process <0> on <Tornado>
Starting process <1> on <Predator>
mpi.MPIException: Error in SimplePacker : count <2> is less than length <4>
        at mpi.SimplePackerChar.unpack(SimplePackerChar.java:105)
        at mpi.Comm.recv(Comm.java:1305)
        at mpi.Comm.Recv(Comm.java:1255)
        at PingPongVariousLengths.main(PingPongVariousLengths.java:25)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at runtime.daemon.Wrapper.execute(Wrapper.java:165)
        at runtime.daemon.Wrapper.main(Wrapper.java:180)
java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at runtime.daemon.Wrapper.execute(Wrapper.java:165)
        at runtime.daemon.Wrapper.main(Wrapper.java:180)
Caused by: mpi.MPIException: mpi.MPIException: mpi.MPIException: Error in Simple
Packer : count <2> is less than length <4>
        at mpi.Comm.Recv(Comm.java:1259)
        at PingPongVariousLengths.main(PingPongVariousLengths.java:25)
        ... 6 more
Caused by: mpi.MPIException: mpi.MPIException: Error in SimplePacker : count <2>
 is less than length <4>
        at mpi.Comm.recv(Comm.java:1317)
        at mpi.Comm.Recv(Comm.java:1255)
        ... 7 more
Caused by: mpi.MPIException: Error in SimplePacker : count <2> is less than leng
th <4>
        at mpi.SimplePackerChar.unpack(SimplePackerChar.java:105)
        at mpi.Comm.recv(Comm.java:1305)
        ... 8 more 
```

编辑 2

好的，所以经过一些试验和错误后，我在第 19 行注释掉了 '//len *= 2)'，注释掉了这个，程序会运行，但它会以 2 个字节持续运行，并且在需要之后没有停止20个循环，所以我认为这是问题所在，但是如何解决呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:48:26.113

Your exception seems to be thrown by this [block of code:](http://raytracempj.googlecode.com/svn/trunk/MPJServer/src/mpi/SimplePackerChar.java)

```
 public void unpack(mpjbuf.Buffer mpjbuf, int length, Object buf,
                  int offset, int count) throws MPIException {

    if(count * numEls < length) {
      throw new MPIException ("Error in SimplePacker : count <"+
          (count*numEls)+"> is less than length <"+length+">");
    } 
```

So it appears that `count * numEls` is less than `length`. And it all seems to lead to your `Recv()` call (what I assume to be line 29), either:

```
MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 1, tag); 
```

or

```
MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 0, tag); 
```

So the "count" (`len`) is less than the length (which is 2). You have `minlen` set to 1 (which isn't "2" like the comments say), try setting it to 2 instead.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-10T22:31:59.923

您的代码的主要问题是您错过了一个内部循环，该循环`i=0`在. 由于外循环的长度不同，因此您的进程正在发送while 进程的消息，因为它在下一个外循环迭代中，所以正在期待消息。如果您插入打印语句，您将看到您的第一条消息已成功完成。但是对于第二次迭代，它的长度是不匹配的。这是代码修复：`MAX_LOOP``rank=1``rank=0``len=2``rank=1``len=4`

```
for (int len = minlen; len <= maxlen; len *= 2) {
        if (myrank == 0) {
                durationseconds = 0;
                for (int i = 0; i < MAX_LOOPS; i++) {
                        long startTime = System.nanoTime();
                        System.out.println("Processor 0 printing len="+len);
                        MPI.COMM_WORLD.Send(sendbuff, 0, len, MPI.CHAR, 1, tag);
                        MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 1, tag);
                        long endTime = System.nanoTime();
                        long duration = endTime - startTime;
                        durationseconds = durationseconds + (duration* 10-9);
                }
                durationseconds = durationseconds / MAX_LOOPS;
                System.out.println("Average time for the ping to be sent and recived of " + (len*2) + " bytes is " + durationseconds + " seconds");
                double transferRateMb = ((len*524288.0) / durationseconds );
                System.out.println("average transferRate (megabytes) : " + transferRateMb + " megabytes per second");
        } else if (myrank == 1) {
                for(int i =0; i < MAX_LOOPS; i++){
                        System.out.println("Processor 1 printing len="+len);
                        MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 0, tag);
                        MPI.COMM_WORLD.Send(recvbuff, 0, len, MPI.CHAR, 0, tag);
                }
        }
} 
```

# rose-db-object - 为什么 $my_item->save 使用 Rose::DB::Object 失败？

> ID：15994034
> 
> 赞同：0
> 
> 时间：2013-04-13T23:23:29.943
> 
> 标签：rose-db-object

我正在尝试将数据简单地添加到数据库表（PostgreSQL）中。起初，我什至无法得到一个简单的

```
$my_item = $_item_class->new(...); 
```

去工作。我发现我在代码中拼写的字段与我在“模型”代码中的拼写不同。

但是，现在，这是可行的，但是当我尝试时：

```
$my_item->save; 
```

似乎抛出了异常。所有这一切都发生在 eval {...} 结构中，我想捕捉异常并看看出了什么问题，但我不知道该怎么做。

为什么像“保存”这样的东西会在这里失败？我检查了一切，一切似乎都正确（当然！）。

而且，我如何捕捉似乎被抛出的异常？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T01:50:57.750

这一切都是我自己想出来的。这很简单。当我对它进行编辑时，我不知何故在我的课堂上复制了一个字段。就这些。该类只是在类的哈希表中指定了两个同名字段，两者具有相同的特征。当我删除其中一个时，代码起作用了。

关于我关于如何捕获异常的第二个问题，我必须学习如何拥有一个

```
if ($@) {
    .
    .
    .
} 
```

在我的“eval {...}”结构之后。因为我是 Perl 的新手，所以我不明白这一点。但是，实际上很容易弄清楚。我的问题是我正在使用一些代码作为我的模型，但没有这样做，而是命名了在其“eval {...}”代码中引发的特定异常。所以，我认为我必须知道 Rose::DB::Object 调用可能引发的异常的名称，但我在文档中找不到任何此类异常。当我了解“if ($@) {...}”时，我能够在 $@ 中打印出报告的异常，并且从中我能够看到我上面提到的重复字段的问题。

这就是它的全部。现在一切正常。

# rust - 如何让 Rust 编译器解析从 std 的导入？

> ID：15994036
> 
> 赞同：3
> 
> 时间：2013-04-13T23:23:51.233
> 
> 标签：rust, rust-obsolete

我正在为 mingw32 使用 Rust 0.6 编译器。我能够编译从“core”导入但不能从“std”导入的小程序。这是一个显示一个简单示例以及我如何编译它的成绩单：

```
$ cat prog.rs
use std;
$ rustc.exe prog.rs
error: failed to resolve imports
prog.rs:1:4: 1:8 error: unresolved import
prog.rs:1 use std;
              ^~~~
error: aborting due to 2 previous errors 
```

如何让 rustc.exe 解决导入问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T04:04:03.203

您首先需要通过 加载外部板条箱`extern mod std;`，然后您可以`use`在该板条箱中使用模块，或者直接使用它们`std`，例如

```
extern mod std;
use std::bigint;

fn main () {
    bigint::BigInt::from_uint(1);
    std::semver::parse("1.2.3-alpha1");
} 
```

[这里有更多信息](http://static.rust-lang.org/doc/tutorial.html#using-other-crates)。

# c++ - C++ 标准布局和参考

> ID：15994042
> 
> 赞同：7
> 
> 时间：2013-04-13T23:24:42.973
> 
> 标签：c++, standard-layout

根据 C++ 标准：

> 标准布局类是这样的类：
> 
> > — 没有非标准布局类（或此类类型的数组）或引用类型的非静态数据成员。

引用的哪些属性会阻止具有引用成员的类包含在标准布局类的定义中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-13T23:33:19.443

*标准布局类就是为内存*中的特定类型提供良好定义的布局。在 C++ 中，引用不是对象，因此没有任何可以由符合程序以明确定义的方式访问的存储，即使实现通常必须为它们提供某种特定于实现的存储。

*出于这个原因，在必须具有标准*布局的东西中包含引用成员是没有意义的。

在关于 C++ 内存模型的部分的标准中有一个非规范性注释，其中提到了这一点：

> [注意：语言的各种特性，例如引用和虚函数，可能涉及程序无法访问但由实现管理的额外内存位置。——尾注]

# javascript - 如何获取图像真实的css显示属性

> ID：15994051
> 
> 赞同：9
> 
> 时间：2013-04-13T23:26:54.107
> 
> 标签：javascript, html, css, properties

我有一段 html

```
<img style="cursor: pointer; width: auto; height: auto; display: inline;" src="http://www.kidsgen.com/fables_and_fairytales/images/rapunzel.gif" alt="rapunzel" title="rapunzel" align="right"> 
```

即使我设置`display: inline;`了它的样式，当我尝试像这样获取它的 css 显示属性时：

```
alert($('img:first').css('display')) 
```

或者

```
var el=document.getElementsByTagName('img')[0]
alert(document.defaultView.getComputedStyle(el,null)['display']) 
```

它总是给我价值`block`。

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T23:50:24.383

属性分配导致 img 元素的`align='right'`显示属性设置为“块”。没有属性的代码将[在 jsFiddle 上](http://jsfiddle.net/rsGQ9/1/)`align='right'`警告“内联” 。

```
<body>
    <img style="cursor: pointer; width: auto; height: auto; display: inline;" src="http://www.kidsgen.com/fables_and_fairytales/images/rapunzel.gif" alt="rapunzel" title="rapunzel" />
</body>

alert($('img:first').css('display')); // alerts 'inline' 
```

一个相关的额外信息是 img 标签实际上[是默认的内联元素。](http://www.w3schools.com/html/html_blocks.asp)但是，`align='right'`在 img 标记中设置了 set，即使插入这行代码，我也无法将 display 属性设置回内联：

```
$('img:first').css('display', 'inline'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T23:51:16.763

这是因为您`align="right"`在图像标签中有；

该 CSS 规则用于对齐块元素（[了解更多](http://www.w3schools.com/css/css_align.asp)）。

# ios - 为什么我在函数 prepareForSegue 中丢失了 NSMutableArray 中的对象？崩溃

> ID：15994054
> 
> 赞同：-1
> 
> 时间：2013-04-13T23:27:18.737
> 
> 标签：ios, objective-c

我有一个数据对象，我希望在我的 iOS 应用程序的所有不同视图之间随意存储、访问和修改。基本设计前提如下图所示。让我感兴趣的是，如果我用 NSString 替换 NSMutableArray，一切正常，没什么大不了的，但是当我把它变成一个数组并在其中存储一个字符串时，它就吓坏了。我选择了一个数组，因为我需要同时存储不同版本的 userData，而在实际的应用程序中，不仅仅是一个用户数据变量。

我正在使用 ARC，但我不得不承认我不清楚我是否正确使用它。建议表示赞赏。

```
//  data.h

@interface Data : NSObject

@property (nonatomic, retain) NSMutableArray *data;
@property (assign) NSNumber *Num; // determines which "level" on the array we're accessing

+(id) sharedInstance;

@end

// data.m

+(id) sharedInstance
{    
    static id sharedInstance = nil;
    if (sharedInstance == nil) {
        sharedInstance = [[self alloc] init];        
    }
    return sharedInstance;
}

- (id)init
{
    self = [super init];

    if (self)
    {        
        _Num = [NSNumber numberWithInt:0];
        _data = [NSMutableArray array];
    }

    return self;
}

// userInput.h

@property (strong, nonatomic) IBOutlet UITextField *userData;

@property (nonatomic, retain) Data *dataStore; 
```

在这里，我向我的数据对象添加了一个空字符串，因为没有任何用户输入是强制性的，但是当没有输入时我需要知道这一点，所以我至少使用一个空字符串。

```
// userInput.m

viewDidLoad
{
    _dataStore = [Data sharedInstance];
            [_dataStore.data addObject:@""];

}

prepareForSegue
{
    int num = [_dataStore.Num intValue];

    NSString *transferData = [NSString stringWithFormat:@"%@", _userData.text];
    [_dataStore.data replaceObjectAtIndex:num withObject:transferData]; // crash at this line. replacing the empty string with whatever the user inputs
} 
```

崩溃报告

```
Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM replaceObjectAtIndex:withObject:]: index 0 beyond bounds for empty array' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T03:31:46.587

你的控制器进程的顺序是这样的：

ViewController ---> 初始 ---> TDC

您可以在 ViewController 的 viewDidLoad 方法中获得 FlightData 类的共享实例，并且该类中的初始化代码会实例化您的所有数组。然后，当您执行 prepareForSegue 以转到 Initial 时，将空字符串添加到这些数组中。问题出在下一个控制器 Initial 中。您在 didMoveToParentViewController 中的这些数组上调用 removeAllObjects，这会在视图出现后立即发生。然后在 prepareForSegue 去 TDC 中，您尝试使用 replaceObjectAtIndex:withObject: 这当然会使应用程序崩溃，因为您刚刚清空了这些数组。

# oop - Object Pascal：必须释放所有对象（类）吗？

> ID：15994056
> 
> 赞同：0
> 
> 时间：2013-04-13T23:27:33.613
> 
> 标签：oop, pascal, freepascal, delphi

我可以在`class`不释放它们的情况下扔掉 es，还是我的软件会开始泄漏？

例如我可以这样做吗

```
Engine := TEngine.Create(TV); 
```

然后摆脱引用没有任何问题，还是我必须先调用它的`Free`方法？

或者有一个返回 a`TSomething`而不必稍后释放它的引用的函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T23:39:30.263

一般规则是，如果你创建它，你应该释放它。最好的方法是尝试..finally 如果您在代码中创建它：

```
var
  Engine: TEngine;
begin
  Engine := TEngine.Create(TV);
  try
    // Do stuff with Engine
  finally
    Engine.Free;
  end;
end; 
```

例外情况是，如果您有一个接受所有者作为参数的对象（例如类似的可视控件`TEdit`或 的非可视后代`TComponent`）。如果您分配所有者，它将在所有者被释放时释放它。（如果您在没有所有者的情况下创建它，您仍然必须自己释放它。）

```
procedure TForm1.FormCreate(Sender: TObject);
var
  EditA, EditB: TEdit;
begin
  EditA := TEdit.Create(Self);  // You're passing the form as owner; don't free
  EditB := TEdit.Create(nil);   // Creating without an owner; you free.
end; 
```

如果该类是另一个对象的成员（字段），则在包含对象中创建它并在其中`constructor`释放它`destructor`：

```
type
  TOuterClass = class(TObject)
  private
    FEngine: TEngine;
  public
    constructor Create;
    destructor Destroy; override;
  end;

implementation

constructor TOuterClass.Create;
begin
  inherited;
  FEngine := TEngine.Create(TV);
end;

destructor TOuterClass.Destroy;
begin
  FEngine.Free;
  inherited;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T05:30:26.383

从技术上讲，是的，您使用构造函数初始化的所有内容都必须显式释放。

但是有一些简单的解决方法，如果使用得当，可以为您省去大部分麻烦：

1：使用 TInterfacedObject：

```
 IMyStuff = interface(IUnknown)
    ['{9DF82155-2475-4403-8933-969DC4912AD7}']
    function Print:boolean;
    procedure DoStuff;
  end;

  TMyStuff = class(TInterfacedObject, IMyStuff)
    private
      function Print:boolean;
      procedure DoStuff;
   end; 
```

像任何其他类一样实现 TMyStuff。但是，当您在代码中使用该类时，请使用 IMyStuff 类型的变量，如下所示：

```
procedure MyIProcedure;
var myStuff: IMyStuff;
begin

   myStuff:=TMyStuff.create;
   myStuff.DoStuff;

end; 
```

无需在 'TMyStuff.create' 调用中进行强制转换（在这种情况下 - 有时是......） - 因为变量是 IMystuff 类型，所以这是隐式的。不需要释放 IMyStuff （事实上你不能，虽然你可以调用 IMyStuff:=nil。）因为它被声明为接口类型，自动垃圾收集是使用 COM 引用计数模型实现的 - Delphi 为你处理这个当您从 TInterfacedObject 继承时。

**但是**不要混合类类型变量：即 TMyStuff 与 IMyStuff 变量类型。这可能会导致一些令人讨厌的混乱和错误，让您摸不着头脑。这就是我通常将 TInterfacedObject 的成员声明为**PRIVATE**的原因，就像我在这里所做的那样，通过对 TMyStuff 的引用使它们无法访问。但是，它们可以通过对 IMyStuff 的引用来访问：根据定义，所有接口成员都是公共的。

2：除了 Ken 的出色回答之外，VCL 的 TObjectList 和 TObjectDictionary 为它们包含的所有对象引用提供了自动垃圾收集（有关详细信息，请参阅 Delphi 文档） - 但它们本身必须被释放，然后其余的被释放。

只要在 TInterfacedObject 的析构函数中释放 ObjectList 或 ObjectDictionary，在 TInterfacedObject 中使用 TObjectList 或 TObjectDictionary 就不必再担心垃圾回收了。当 referenceCount=0 时，Delph 的实现将自动调用该析构函数。

# php - 根据 where 子句选择行时，如何匹配完整的单词？

> ID：15994060
> 
> 赞同：1
> 
> 时间：2013-04-13T23:27:48.537
> 
> 标签：php, mysql, search, sql-like

我正在尝试为网站创建搜索功能。在 MySQL 中，我想完全匹配单词，例如，如果我有几篇带有这些标题的帖子：

> 一天时间

和

> 即将到来的一天

我有以下搜索字符串：

```
SELECT title
        FROM posts
        WHERE title LIKE '%in%'
        ORDER BY Date
        DESC 
```

它将返回两行，因为该`LIKE`术语`%in%`同时`in`出现在第一行和 `coming`第二行中。

但我只希望它匹配整个单词，以便只返回第一行。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:33:17.170

您正在寻找 MySQL 单词边界 REGEXP：

```
SELECT title
  FROM posts
  WHERE title REGEXP '[[:<:]]in[[:>:]]' 
```

来自 MySQL 文档：

*这些标记代表单词边界。它们分别匹配单词的开头和结尾。单词是前面或后面没有单词字符的单词字符序列。*

[http://dev.mysql.com/doc/refman/5.1/en/regexp.html](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:29:20.273

这样做：

```
SELECT title
    FROM posts
    WHERE title LIKE '% in %'
    ORDER BY Date
    DESC 
```

如果它是一个词，你肯定有问题的词前后有空格。

# xcode - 记录 NSURL 时 xcode 抛出错误

> ID：15994061
> 
> 赞同：0
> 
> 时间：2013-04-13T23:28:03.663
> 
> 标签：xcode, nsurl

使用以下代码运行 xcode 并尝试 nslog url1 时，任何人都可以帮助解决此错误

.m 文件

```
 NSLog(@"URL flag is not set, Reverting to stored value");
//url1 = [NSURL URLWithString: [NSString stringWithFormat: @"http://radio.qkradio.com.au:8382/listen.mp3"]];
        url1 = [NSURL URLwithString:@"http://radio.qkradio.com.au:8382/listen.mp3"];
        NSLog(url1); 
```

.h 文件

```
NSURL *url1; 
```

错误

```
2013-04-14 09:18:41.958 iQkradio[61530:4803] REACHABLE!
2013-04-14 09:18:41.990 iQkradio[61530:c07] Application windows are expected to have a root view controller at the end of application launch
2013-04-14 09:18:42.569 iQkradio[61530:4803] URL flag is not set, Reverting to stored value
2013-04-14 09:18:42.570 iQkradio[61530:4803] +[NSURL URLwithString:]: unrecognized selector sent to class 0x1ef926c
2013-04-14 09:18:42.570 iQkradio[61530:4803] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '+[NSURL URLwithString:]: unrecognized selector sent to class 0x1ef926c' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:17:26.337

正如其他人提到的，您需要使用`URLWithString:`.

但还有更多。尝试像这样格式化您的日志`NSLog(@"%@",url1);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:52:42.193

您的代码中有错字。正确的代码是：

```
url1 = [NSURL URLWithString:@"http://radio.qkradio.com.au:8382/listen.mp3"]; 
```

[请注意，这里](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURL_Class/Reference/Reference.html)提到的“W”是大写的。希望这可以帮助！

# vb.net - 加起来 2 个 datagridview 单元格值

> ID：15994063
> 
> 赞同：1
> 
> 时间：2013-04-13T23:28:10.197
> 
> 标签：vb.net

我有 3 个 vb.net 形式的 Datagridview 控件。DGV1 带有价格栏，DGV2 带有数量栏，第三个是总栏 DGV3。任何人都请告诉我如何执行此操作，DGV1*DGV2 在 DGV3 上显示总数，并在每次 DVG1 单元格值更改时更新 DGV3。我下面的代码不会更新 DGV3。此外，问题之一是 DGV3 在 DGV2 绑定 DATA 之前计算，如果 DGV2 单元格值 = 0，它会给我一个错误的总数。任何想法 ？赞赏，

```
 Private Sub DGV1_CellValueChanged(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DGV1.CellValueChanged
    Dim Tot As Int32 = 0
   DGV3.Enabled = False
    DGV3.DataSource = Nothing
    DGV3.Enabled = True

    Dim OBJ As Double
    Dim SALES As Integer
    Dim dtt As DataTable
    For Each R As DataGridViewRow In Me.DGV1.Rows
        For Each N As DataGridViewRow In Me.DGV2.Rows

            OBJ = CDbl(R.Cells(4).Value)
            SALES = CInt(CDbl(N.Cells(0).Value))
            Tot = CInt(OBJ * SALES)
            DGV3.Rows.Add(Tot.ToString)

        Next
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:50:01.683

如果您能够使用一个 datagridview，我会这样做：

```
 Public Class Form1

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        ''// Set the number of columns.
        DataGridView1.ColumnCount = 3
        DataGridView1.ColumnHeadersVisible = True

        ''// Set the column header style. 
        Dim columnHeaderStyle As New DataGridViewCellStyle()

        columnHeaderStyle.BackColor = Color.Beige
        columnHeaderStyle.Font = New Font("Verdana", 10, FontStyle.Bold)
        DataGridView1.ColumnHeadersDefaultCellStyle = columnHeaderStyle

        ''// Set column names.
        DataGridView1.Columns(0).Name = "Price"
        DataGridView1.Columns(1).Name = "Quantity"
        DataGridView1.Columns(2).Name = "Total"

        DataGridView1.Enabled = False
        DataGridView1.DataSource = Nothing
        DataGridView1.Enabled = True

    End Sub

    Private Sub DataGridView1_CurrentCellChanged(sender As Object, e As EventArgs) Handles DataGridView1.CurrentCellChanged

        ''// show the total in column 3 and update column 3 everytime column `price's` cellvalue gets changed.
        If (DataGridView1.CurrentCell.ColumnIndex = 0) Then
            ''// MsgBox("Updating column three `Total`")

            For Each R As DataGridViewRow In DataGridView1.Rows
                On Error Resume Next ''// iKNOW <-.->

                Dim price As Double = R.Cells(0).Value.ToString
                Dim quantity As Integer = R.Cells(1).Value.ToString

                ''// not the auto new new at the bottom. <`.'>
                If Not (R.IsNewRow) Then
                    Dim Tot As Double = CInt(price * quantity)
                    R.Cells(2).Value = Tot
                End If

            Next

        End If

     End Sub
 End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T08:53:30.773

创建一个空 DGV 并使用添加列在其中添加所需的列。然后使用编辑列选择要在您现在创建的每个特定列下显示的值。您可以在每个新创建的列中看到 DataBindingsource 选项。所以选择你需要绑定的数据源和 DisplayMember （包含你想显示的值的列名）

# magento - Magento：在购物车中获取属性值

> ID：15994064
> 
> 赞同：1
> 
> 时间：2013-04-13T23:28:16.083
> 
> 标签：magento, attributes, cart

这是我在 Magento 的第一个项目，我在尝试获取购物车项目的属性值时遇到问题。我现在所拥有的没有显示任何东西。我有 3 个基本属性（宽度、高度、深度）和一个可配置属性（织物）。这是我在 default.phtml 中用于结帐项目的内容：

```
$_item = $this->getItem();
$_product = Mage::getModel('catalog/product')->load($_item->getProductId());

echo $_product->getWidth();
echo $_product->getHeight();
echo $_product->getDepth();

echo $_product->getAttributeText('fabric'); 
```

如果有人能够告诉我如何让它工作，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-11T13:29:46.700

当你添加你的属性时，你给了他们一个属性代码，只有小写和下划线。（目录 > 属性 > 管理属性，属性代码通常列在左侧）。假设您将它们命名为类似于它们的描述，那么....

```
echo $_product->getData('width');
echo $_product->getData('height');
echo $_product->getData('depth'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T08:20:13.963

尝试这个

```
$attributes = $_product->getAttributes();
foreach ($attributes as $attribute) {
    if ($attribute->getIsVisibleOnFront()) {
      echo  $value = $attribute->getFrontend()->getValue($_product);

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-11T07:41:42.390

对于下拉属性类型在购物车中获取值可以通过以下代码完成：

`echo nl2br($_product->getResource()->getAttribute('fabric')->getFrontend()->getValue($_product));`

面料是属性代码。您可以在此处使用您的属性代码。

# ios - 代表不在单例中工作

> ID：15994066
> 
> 赞同：3
> 
> 时间：2013-04-13T23:28:23.603
> 
> 标签：ios, objective-c, xcode, delegates, singleton

为了在我的多个视图上建立网络连接，我创建了一个单例网络控制器来处理服务器和客户端之间的数据。不幸的是，它不起作用，因为没有从我的单例调用委托方法到另一个视图。在我的代码下面：

** 单例是 SocketIOConnection.h 和 .m

```
//
//  SocketIOConnection.h

#import <Foundation/Foundation.h>
#import "SocketIO.h"
#import "SocketIOPacket.h"

@protocol SocketIOConnectionDelegate <NSObject>
@required
- (void) receivedPacket:(id)packet;
@end

@interface SocketIOConnection : NSObject <SocketIODelegate> {

    SocketIO *IO;
    id <SocketIOConnectionDelegate> delegate;

}

@property (nonatomic, retain) IBOutlet SocketIO *IO;
@property (retain) id <SocketIOConnectionDelegate> delegate;

+ (SocketIOConnection *)sharedSingleton;

@end

//
//  SocketIOConnection.m

#import "SocketIOConnection.h"

@implementation SocketIOConnection

@synthesize IO, delegate;

static SocketIOConnection *shared = NULL;

-(id)init {
    if (self = [super init]) {
        IO = [[SocketIO alloc] initWithDelegate:self];
        [IO connectToHost:@"domain.com" onPort:443];
    }
    return self;
}

+ (SocketIOConnection *)sharedSingleton
{
    @synchronized(shared)
    {
        if ( !shared || shared == NULL )
        {
            // allocate the shared instance, because it hasn't been done yet
            shared = [[SocketIOConnection alloc] init];
        }

        return shared;
    }
}

-(void)socketIO:(SocketIO *)socket didReceiveEvent:(SocketIOPacket *)packet {
    NSLog(@"Delegating received packet..");
    [delegate receivedPacket:packet.dataAsJSON];
}

@end 
```

所以这是我的单例代码，下面我将发布我的 viewcontroller.h 和 .m 的代码

```
//
//  ViewController.h

#import <UIKit/UIKit.h>
#import "MBProgressHUD.h"
#import "SocketIOConnection.h"

@interface ViewController : UIViewController <MBProgressHUDDelegate, SocketIOConnectionDelegate>
{
    MBProgressHUD   *HUD;
}

@property (nonatomic, retain) SocketIOConnection *IOConnection;

@end

//
//  ViewController.m

#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController {
    NSDictionary *operatorData;
}

@synthesize SESSION, IOConnection;

#pragma mark - view Did Load, View Will Appear & didReceiveMemoryWarning

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

}

-(void)viewWillAppear:(BOOL)animated {

    IOConnection    = [SocketIOConnection sharedSingleton];

    // fire auth function to verify the operator and sign him in.
    NSMutableDictionary *tokenAndLicense = [[NSMutableDictionary alloc] init];
    [tokenAndLicense setValue:[operatorData objectForKey:@"token"] forKey:@"__ca.token"];
    [tokenAndLicense setValue:[operatorData objectForKey:@"license"] forKey:@"__ca.license"];
    [IOConnection.IO sendEvent:@"auth" withData:tokenAndLicense];

}

-(void)receivedPacket:(id)packet { <<<< void that should be fired because of the delegate
    NSLog(@"Receive ieks..");
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

为什么我的委托方法没有被调用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-13T23:40:08.663

您似乎忘记在代码中设置委托。您应该在视图控制器中调用单例后立即执行此操作`ViewWillAppear`。

```
-(void)viewWillAppear:(BOOL)animated {

    IOConnection    = [SocketIOConnection sharedSingleton];

    IOConnection.delegate = self;

    // fire auth function to verify the operator and sign him in.
    NSMutableDictionary *tokenAndLicense = [[NSMutableDictionary alloc] init];
    [tokenAndLicense setValue:[operatorData objectForKey:@"token"] forKey:@"__ca.token"];
    [tokenAndLicense setValue:[operatorData objectForKey:@"license"] forKey:@"__ca.license"];
    [IOConnection.IO sendEvent:@"auth" withData:tokenAndLicense];

} 
```

# asp.net - ASP.NET Excel 和 PDF 下载将“[1]”附加到我的 .PDF/.XLS 扩展名

> ID：15994069
> 
> 赞同：1
> 
> 时间：2013-04-13T23:29:10.133
> 
> 标签：asp.net, mime-types

我有一个 Web 表单页面，它应该能够根据用户所做的选择将 Crystal Report 的内容写入 pdf 或 excel 文档。

我有两个问题：

1.  对于 .pdf 和 .xls 扩展名，都有一个括号，其中一个括号被附加到扩展名 IE：[fileName.xls'1](https://i.stack.imgur.com/wzRbz.gif) '

2.  如果用户选择一个 excel 文档，在 IE 中会出现文件下载提示并询问我们是否要保存或打开文件：

![在此处输入图像描述](https://i.stack.imgur.com/wzRbz.gif)

PDF文件保存得很好，但是如果我们选择打开excel文件，它会打开一个资源管理器窗口，我们会得到垃圾......

这是我们的代码：

```
try
{
    permission = new FileIOPermission(FileIOPermissionAccess.Read, output);
    fs = File.Open(output, FileMode.Open, FileAccess.Read);
    byte[] byteArray = new byte[fs.Length];
    fs.Read(byteArray, 0, (int)fs.Length);
    fs.Close();
    fs.Dispose();
    Response.Clear();
    Response.ClearHeaders();
    Response.ClearContent();
    fileName = fileName + '.' + extn;
    //Response.AddHeader("Content-Disposition", "attachments;filename=\"" + fileName + ".\"" + extn);
    Response.AddHeader("Content-Disposition", "attachments;filename=\"" + fileName + "\"");
    Response.AddHeader("Content-Length", byteArray.Length.ToString());

    switch ("." + extn)
    {
        case ".pdf":
            Response.AppendHeader("Content-Type", "application/pdf");
            break;
        case ".xls":
            //Response.ContentType = "application/vnd.ms-excel";
            //Response.ContentType = "application/octet-stream";
            Response.AppendHeader(".xls", "application/excel");
            //Response.AppendHeader("Content-Type", "application/vnd.ms-excel");
            //Response.AppendHeader("Content-Type", "application/force-download");

            break;
        case ".txt":
            Response.AppendHeader("Content-Type", "application/notepad");
            break;

    }
    FileInfo info = new FileInfo(output);
    info.Delete();
    Response.BinaryWrite(byteArray);
    Response.Flush();
    Response.End();
}
catch (Exception ex)
{

    if (fs != null)
        fs.Close();
} 
```

我一直在研究人们体验“ [1](https://i.stack.imgur.com/wzRbz.gif) ”被附加到扩展的现象，但是没有发现太多关于它并调试代码并确认扩展是干净的。

我的下一个猜测是 Response.BinaryWrite(byteArray); 行或 mime 类型或内容标题...

提前感谢您的帮助

道格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T12:46:15.960

将您扩展`switch`到以下内容：

```
switch ("." + extn)
{
    // case ".pdf":
    // ...

    default:
        throw new NotImplementedException();
} 
```

如果抛出异常，这可能会提示您出了什么问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:39:34.060

我在我的项目中做过类似的事情。我已经粘贴了我在下面使用的代码。我想，你只需更换线路。Response.AppendHeader(".xls", "application/excel"); with Response.ContentType = "应用程序/excel";

```
string name = Path.GetFileName(path);
        string ext = Path.GetExtension(path);
        string type = "";
        // set known types based on file extension 
        if (ext != null)
        {
            switch (ext.ToLower())
            {
                case ".htm":
                case ".html":
                    type = "text/HTML";
                    break;

                case ".txt":
                    type = "text/plain";
                    break;

                case ".doc":
                case ".docx":
                case ".rtf":
                    type = "Application/msword";
                    break;

                case ".pdf":
                    type = "application/pdf";
                    break;

                case ".csv":
                case ".xlsx":
                    type = "application/vnd.ms-excel";
                    break;
            }
        }
        Response.AppendHeader("content-disposition",
            "attachment; filename=" + name);
        if (string.IsNullOrEmpty(type))
        {

        }
        else
        {
            Response.ContentType = type;
        }
        Response.WriteFile(path);
        Response.End(); 
```

# javascript - 同时选择大字体和低视力 css 样式表

> ID：15994072
> 
> 赞同：2
> 
> 时间：2013-04-13T23:29:21.633
> 
> 标签：javascript, jquery, html, css, web

我正在设计我的第一个网站，但我遇到了以下问题。我有 3 个样式表：一个用于低视力；一种是大字体，一种是默认字体。我有 3 个按钮可以选择这些，但我一次只能选择一个。我想知道是否可以同时选择 2 个，即低视力和大字体，或者我需要创建第四个样式表。

这就是我所拥有的..

```
<link rel="stylesheet" type="text/css" href="css/style.css" title="default" />
<link rel="stylesheet" type="text/css" href="css/large_font.css" title="large_font"     disabled />
<link rel="stylesheet" type="text/css" href="css/low_vision.css" title="low_vision" disabled />

<script type="text/javascript" src="js/styleswitch.js"></script>
<script type='text/javascript' src='js/jquery.min.js'></script>
<script type='text/javascript' src='js/jquery.scrollTo-min.js'></script>
<script type='text/javascript' src='js/jquery.localscroll-min.js'></script>
<script type="text/javascript">
$(document).ready(function () {
$.localScroll();
});
</script> 

<link rel="stylesheet" href="css/slimbox.css" type="text/css" media="screen" /> 
<script type="text/JavaScript" src="js/slimbox.js"></script> 

</head>

<body>

<div id="background">

<div id="wrapper">
    <div id="accessibility">
            <ul id="access_list">
                <li><a href="#" onclick="setActiveStyleSheet('default'); return false;">Default</a> | </li>
                <li><a href="#" onclick="setActiveStyleSheet('large_font'); return false;">Large Font</a> | </li>
                <li><a href="#" onclick="setActiveStyleSheet('low_vision'); return false;">Low Vision</a></li>
            </ul>
        </div>
    <div id="header">
        <div id="site_title"><a href="#">Sean's Site</a></div>

    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T00:50:48.423

如果我理解正确，您希望有选择地启用/禁用每个样式表，而不是选择其中一个作为“活动的”。

为此，首先为您的样式表提供唯一的 id：

```
<link rel="stylesheet" type="text/css" href="css/style.css" id="default" />
<link rel="stylesheet" type="text/css" href="css/large_font.css" id="large_font"     disabled />
<link rel="stylesheet" type="text/css" href="css/low_vision.css" id="low_vision" disabled /> 
```

然后创建javascript函数`toggleStylesheet`：

```
<script type="text/javascript">
  function toggleStylesheet(id) {
    var o = document.getElementById(id);
    if (o.hasAttribute('disabled') {
      o.removeAttribute('disabled');
    } else {
      o.setAttribute('disabled', 'disabled');
    }
  }
</script> 
```

现在您可以在界面中使用该功能：

```
<ul id="access_list">
  <li><a href="#" onclick="toggleStylesheet('default')">Default</a></li>
  <li><a href="#" onclick="toggleStylesheet('large_font')">Large Font</a></li>
  <li><a href="#" onclick="toggleStylesheet('low_vision')">Low Vision</a></li>
</ul> 
```

另请参阅此问答以获取有关该`toggleStylesheet`功能的更多信息：[HTML“链接”（样式表）禁用属性](https://stackoverflow.com/questions/10564806/html-link-stylesheet-disabled-attribute)

# java - 外部存储和 HTC One V

> ID：15994076
> 
> 赞同：0
> 
> 时间：2013-04-13T23:30:01.653
> 
> 标签：java, android, storage

几周前，我在 HTC One V 上测试了我的应用程序。当我的应用程序在第一次运行时检查外部存储的可用性时，发现没有。（我使用`getExternalStorageState()`并基于结果， `getExternalFilesDir(null)`）。

我阅读了相关的 stackoverflow 线程（和 Android 文档），因此我得出结论，任何支持 Google Play 的设备都必须提供某种外部存储（SD 卡或其他）。Android 官方主页还暗示`getExternalFilesDir`必须始终返回一个有效的位置（除非未安装，或安装到 PC 等）。

允许我进行测试的 HTC One V 的所有者告诉我，他的手机没有任何 SD 卡。（我知道外部存储也可以是其他东西，但正如您在上面看到的，标准`getExternalStorageState`调用返回没有，即它没有返回 HTC One V 的内部存储。）

如果我关闭了我的应用程序的外部存储使用（而是依靠手机内存），One V 上一切正常。问题是，它是一个游戏，将大于 50MB，所以我被迫使用谷歌的 APK 扩展文件的可能性——这需要外部存储。

供应商/移动运营商是否有权销售没有外部存储（在这种情况下，没有 SD 卡）的手机？我知道这不是一个真正的开发问题，但正如您所看到的，这里一定有问题。据我所知，One V 有一个很大的内部存储，所以我想知道为什么`getExternalStorageState`不报告它可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T05:16:57.463

我设计了一个[应用程序](https://play.google.com/store/apps/details?id=com.torcellite.whatsappduplicatemediaremover&feature=search_result#?t=W251bGwsMSwxLDEsImNvbS50b3JjZWxsaXRlLndoYXRzYXBwZHVwbGljYXRlbWVkaWFyZW1vdmVyIl0.)，它虽然不需要外部存储，但可以处理“外部存储”中的文件。Whatsapp 也适用于 a `HTC One V`，因此显然您的代码存在问题。

问题是，在我的应用程序中，虽然`minSdkVersion="8"`我没有使用`getExternalFilesDir(null)`. 相反，我使用[了 getExternalStorageDirectory()](http://developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory%28%29)，这不是因为选择。在开发应用程序时我不知道该`getExternalFilesDir()`功能。但是，该应用程序在朋友的`HTC One V`. 所以我建议你使用`getExternalStorageDirectory()`.

示例代码：

```
String mountStatus = Environment.getExternalStorageState();
                if (mountStatus.equalsIgnoreCase("mounted")) {
                    Toast.makeText(MainActivity.this,
                            Environment.getExternalStorageDirectory().getAbsolutePath(), Toast.LENGTH_SHORT).show();
                } 
```

# jquery - 使用 jQuery Mobile 进行 XML 解析

> ID：15994078
> 
> 赞同：4
> 
> 时间：2013-04-13T23:30:18.510
> 
> 标签：jquery, xml, jquery-mobile, xml-parsing

我正在尝试使用 jQuery mobile 解析 XML 文件。这是我的 jQuery 脚本：

```
<script>
    $(document).ready(function(){
        $.ajax({
            type: "GET",
            url: "bars.xml",
            dataType: "xml",
            success: function(xml) {
                $(xml).find('bar').each(function(){
                    var date = new Date();
                    var day = date.getDay();
                    var name = $(this).attr('name');
                    var id = $(this).attr('id');
                    var specials = $(this).find('specials').text();
                    if (id == day)
                    {   
                        $('<li data-role="list-divider" id="link_'+id+'"></li>').html(name).appendTo('#daily-specials');
                        $('<li class="specials"></li>').html(specials).appendTo('#link_'+id);
                        }
                    });
                }); 
            });
        });
 </script> 
```

还有我的 XML 文件：

```
 <?xml version="1.0" encoding="iso-8859-1"?>
<bars>
    <!-- Friday specials for bar one -->
    <bar name="Bar One" id="5">
       <specials>
         Special 1 <br />
         Special 2 <br />
         Special 3 <br />
         Special 4 <br />
         Special 5
       </specials>
   </bar>
   <!-- Saturday specials for bar one -->
    <bar name="Bar One" id="6">
       <specials>
         Special 1 <br />
         Special 2 <br />
         Special 3 <br />
         Special 4 <br />
         Special 5
       </specials>
   </bar>
</bars> 
```

谁能看到我做错了什么？如您所见，我正在尝试获取一周中当天的“Bar One”的特别信息，然后将该信息传递给我页面上的 HTML 类。不过，我的网站上没有打印出来。如果我什至不接近，我深表歉意，但方向会有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-20T07:37:56.653

正如您所说，网站上没有任何内容。我看到您正在使用本地 xml 文件。同源政策可能会受到影响。我猜你使用的是chrome浏览器。（在 chrome 上使用 F12 键查看错误的控制台。）

在 Firefox 或 IE 上试试。

如果您仍想使用 chrome.. 请在 chrome 快捷方式的 targer 属性中添加以下内容。--allow-file-access-from-files

希望这会有所帮助，您将其标记为答案。

# wordpress - 任何父类别的 Wordpress 类别列表

> ID：15994080
> 
> 赞同：1
> 
> 时间：2013-04-13T23:30:30.827
> 
> 标签：wordpress, categories

我想显示博客类别的子类别列表。我怎么做？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:15:04.680

[`wp_list_categories()`](http://codex.wordpress.org/Function_Reference/wp_list_categories)与`child_of`设置为父类别的 ID 的参数一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T09:10:06.657

试试这个代码，它将显示当前帖子的子类别：

```
$category=get_the_category();
$parent_id = $category[0]->cat_ID;

foreach($category as $childcat) 
{
  if (cat_is_ancestor_of($parent_id, $childcat)) 
  {
    echo $childcat->cat_name;
  }
} 
```

把它放在循环里面。

# node.js - 更新与 findByIdAndUpdate 相比是否有猫鼬性能优势

> ID：15994083
> 
> 赞同：2
> 
> 时间：2013-04-13T23:31:07.410
> 
> 标签：node.js, mongoose

我想通过 put 操作使用 REST api 更新基本的 CRUD 样式。我有一个咖啡脚本基类，其中@model 是一个猫鼬模型，例如子类中的 mongoose.model *('Company', schema)*。我正在使用两种方式进行 PUT/更新：

```
und = require 'underscore'

class CRUDApi

  # using findByIdAndUpdate
  update1: (req, res) =>
    data = und.clone req.body
    delete data._id # so mongo doesn't complain
    @model.findByIdAndUpdate req.params.id, data, (e, r) ->
      res.send r

  # using update
  update2: (req, res) =>
    data = und.clone req.body
    delete data._id # so mongo doesn't complain
    @model.update { _id: req.params.id }, data, (e, r) ->
      res.send req.body 
```

我的问题是：

1) update 和 findByIdAndUpdate 之间有性能差异吗？findByIdAndUpdate 似乎是语法的更好选择，特别是因为它返回 'r' 中的结果而不是增量计数，这比在 update2() 中使用 req.body '伪造'响应感觉更好

2）克隆请求并删除 _.id 属性似乎也很尴尬，所以猫鼬不会抱怨。这是正常的做法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T01:26:02.047

`findByXAndUpdate()`1)如果您想取回已更新的文档，使用 mongoose 会带来性能优势。下面，它使用了 mongo 的[findAndModify](http://mongodb.github.io/node-mongodb-native/api-generated/collection.html#findandmodify)方法，该方法有一个选项，可以在更新后返回更新的文档。另一种方法是`find()`在更新后执行以获取文档。返回发布的正文可能不是一个好习惯，因为它不应该被信任，因为它来自用户，并且它不会考虑返回允许部分更新的完整文档。

2) 将传入的数据从 req.body 过滤到您期望的字段绝对是一个好习惯，特别是因为您将它们直接传递到模型的更新函数中。剥离 _id 似乎是合适的。

# c - 在 C 中读取一个字符并对其进行操作

> ID：15994084
> 
> 赞同：2
> 
> 时间：2013-04-13T23:31:11.030
> 
> 标签：c, while-loop

好的，所以我正在尝试学习一些 C。我正在尝试编写一个具有数字并让用户询问数字的程序。

在它猜测它询问用户是否想再次玩之后，我已经接受了一切。如果他们输入 Y 或 y，那么游戏将重新开始，如果他们输入“N”或“n”，那么程序将终止。

我想做什么

```
int   main(){

 while(playAgain == 'y' || 'Y') {

*playing code here*

printf("would you like to play again");
scanf("%s", &playAgain);

 } 
```

它不会破坏......根本......永远，无论我输入什么。我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:40:27.933

这里的问题（除了评论中的内容）是您的条件语义。你想`playAgain == 'y' || 'Y'`被解释为`playAgain equals 'y' or playAgain equals 'Y'`.

相反，它被解析为`(playAgain equals 'y') or ('Y')`. 由于 true 被定义为非零且`'Y'`非零（ASCII 值为 131），`'Y'`因此始终为 true，并且您的条件始终为 true。你要：

```
while (playAgain == 'y' || playAgain == 'Y') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T23:44:28.627

我猜这里 playAgain 的类型是字符？

您没有正确使用 scanf 。[http://www.cplusplus.com/reference/cstdio/scanf/](http://www.cplusplus.com/reference/cstdio/scanf/)

带有 %s 的 scanf 期望读取一个字符串。在 C 中，字符串是 char*，因此它将用指针值写入 playAgain 并丢弃最高位。这几乎是一个随机值，比较会失败。如果你想保持 playAgain 作为一个角色，你应该使用 %c。

顺便说一句，它不是美元。

或者，您可以将 playAgain 实现为字符串。在这种情况下，您可以这样做：

```
int   main(){
    char playAgain[buffer_size];
    do{
        /*playing code here*/
        printf("would you like to play again");
        scanf("$s", &playAgain);
        lower_case_string( playAgain); // Call a function for changing string to lower case
    }while( !strcmp( "yes", playAgain) || !strcmp( "y", playAgain );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T00:16:04.347

您必须修复代码中的一些内容：

```
char playAgain = 'y';
while(playAgain == 'y' || playAgain == 'Y') // *1
{

    //*playing code here*

    printf("would you like to play again? ");
    scanf("%s", &playAgain); //*2
} 
```

*1 您必须将每个条件用 AND 或 OR（&& 或 ||）分割。

*2 使用 scanf 参数的正确格式是使用“%”，而不是“$”。在此处查看更多使用信息：[http ://www.cplusplus.com/reference/cstdio/scanf/](http://www.cplusplus.com/reference/cstdio/scanf/)

修复代码后，循环 while 将始终重复用户键入以“y”或“Y”开头的任何单词，例如“黄色”将在此代码中重新启动循环。如果要控制引入的完整字符串，则必须使用 char 数组或字符串并将其与辅助函数进行比较，如下所示：

```
bool compareArrays(char* str1, char* str2, int lenght)
{
    int i;
    for (i=0; i<lenght; ++i)
        if (str1[i] != str2[i]) return false;
    return true;
} 
```

# linux - 将所有非 HTTPS 请求重定向到 HTTPS

> ID：15994086
> 
> 赞同：0
> 
> 时间：2013-04-13T23:31:28.293
> 
> 标签：linux, apache, url, ssl

我为网站购买了 SSL 证书，并按照供应商提供的完整安装程序进行操作。它现在处于活动状态，如果我去，可以说`https://website.com`我得到了想要的结果。

但是，当有人尝试`http://website.com`请求时不会重定向到`https://website.com`. 我希望当有人输入`website.com`请求时自动重定向到`https://www.website.com`.

我正在使用 GoDaddy Linux 服务器托管。请建议我应该怎么做才能实现我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:59:18.747

这也包括 SEO 301 重定向。经过测试并且工作正常：

```
Options +FollowSymlinks
RewriteEngine On
RewriteBase /

RewriteCond %{HTTPS} !^on$
RewriteRule (.*) https://www.site.co.uk/$1 [L,R=301]

RewriteCond %{HTTP_HOST} ^site.co.uk [NC]
RewriteRule ^(.*)$ https://www.site.co.uk/$1 [L,R=301] 
```

# mysql - MySQL返回特定答案上方和下方的行

> ID：15994090
> 
> 赞同：2
> 
> 时间：2013-04-13T23:32:22.517
> 
> 标签：mysql, phpmyadmin

我有一个简单数据表，其中包含三列、一个 ID、人员姓名和相关的销售数字。当按销售数字排名时，我不知道如何返回上面和下面的行。

```
id | Name | Sales
---|------|------
0  | Tim  | 9
1  | Jim  | 5
2  | Joe  | 3
3  | Ryan | 6
4  | Phil | 7
5  | James| 1 
```

因此，例如，用户 Ryan 的总销售额为 6。我将如何返回 Jim，他有 5 个销售额，在他下方 [Ryan]，然后 Phil 在他上方 [Ryan] 有 7。我尝试了几个查询甚至一分为二。使用查询，如果输出此结果：

```
id | Name | Sales
---|------|------
4  | Phil | 7
3  | Ryan | 6
1  | Jim  | 5

select * from SalesFigures where id >= '3' LIMIT 2 ORDER BY Sales ASC 
```

这个错误，理论上只会返回查询的行和它下面的行。

这个结果将如何实现？因为我似乎无法按销售数字订购。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:02:23.833

我会使用这样的东西：

```
SELECT SalesFigures.*
FROM
  SalesFigures INNER JOIN (
  SELECT s1.Sales v1, MAX(s2.Sales) v2, MIN(s3.Sales) v3
  FROM
    SalesFigures s1 LEFT JOIN SalesFigures s2
    ON s1.Sales > s2.Sales
    LEFT JOIN SalesFigures s3
    ON s1.Sales < s3.Sales
  WHERE
    s1.ID =3) m ON SalesFigures.Sales IN (m.v1, m.v2, m.v3) 
```

使用 UNION 查询将如下所示：

```
SELECT SalesFigures.*
FROM SalesFigures WHERE ID=3
UNION ALL
(SELECT SalesFigures.*
 FROM SalesFigures INNER JOIN SalesFigures s
      ON SalesFigures.Sales < s.Sales
 WHERE s.ID = 3
 ORDER BY SalesFigures.Sales DESC LIMIT 1)
UNION ALL
(SELECT SalesFigures.*
 FROM SalesFigures INNER JOIN SalesFigures s
      ON SalesFigures.Sales > s.Sales
 WHERE s.ID = 3
 ORDER BY SalesFigures.Sales LIMIT 1) 
```

但是，虽然这适用于示例数据，但如果有多行具有相同的销售值，它将只返回一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:37:37.877

首先，您会收到一个错误，因为该`LIMIT`子句必须在该子句之后`ORDER BY`。在您的示例中，它们是错误的方法，但是 SQL 中子句的顺序很重要。

使用 UNION 我会这样做：

```
(SELECT id, name, sales
FROM salesfigures
WHERE sales = (SELECT MIN(sales) FROM salesfigures 
   WHERE sales > (SELECT sales FROM salesfigures where id=3)))
UNION
(SELECT id, name, sales
FROM salesfigures
WHERE sales = (SELECT sales FROM salesfigures WHERE id=3))
UNION
(SELECT id, name, sales
FROM salesfigures
WHERE sales = (SELECT MAX(sales) FROM salesfigures 
   WHERE sales < (SELECT sales FROM salesfigures where id=3))) 
```

嵌套的 subselect 语句有点难看，但它结合了三个 select 语句来查找销售额立即大于等于且小于 ID 为 3 的用户。

在第一个语句中，它找到 ID 3 (Ryan) 的销售数据，然后在 SELECT 语句中使用它来找到高于它的最小值，然后在 SELECT 语句中使用它来返回具有该销售数据的所有整数。第三个陈述显然是相反的（最大值低于 Ryan 的）。中间的语句简单地找到 ID 3 (Ryan) 的销售数字，然后返回任何相同的值。联合中语句的顺序意味着它将根据您的示例按降序排序。但如果销售数据不是唯一的，它可能会返回如下内容：

```
id | Name   | Sales
---|--------|------
12 | George | 7
4  | Phil   | 7
9  | Pat    | 6
23 | Tony   | 6
3  | Ryan   | 6
1  | Jim    | 5 
```

这取决于您希望如何处理销售数据不唯一的情况，以及您希望如何对它们进行二次排序。

# vagrant - 无法移除 Vagrant 框 - 移除命令表示未找到它，即使 list 命令列出了它

> ID：15994097
> 
> 赞同：20
> 
> 时间：2013-04-13T23:34:39.750
> 
> 标签：vagrant

嗨，伙计们，你能告诉我为什么我不能删除我的任何盒子，拜托。

```
$ vagrant box list
base    (virtualbox)
lucid32 (virtualbox)
$ vagrant box remove lucid32 http://files.vagrantup.com/lucid32.box
Box 'lucid32' could not be found.
$ vagrant box remove base http://files.vagrantup.com/lucid32.box
Box 'base' could not be found.
$ 
```

初始设置是这样的：

```
vagrant box add lucid32 http://files.vagrantup.com/lucid32.box
vagrant box add base http://files.vagrantup.com/lucid32.box 
```

**更新** 在我最初的问题中，我写了以下内容：~~文档似乎非常基本，不包括故障排除。我看了这里：...~~等等。我说错了，确实如此。SO用户@cmur2 回答指出我的错误，这被接受了（见下面他们的回答）。他们提供了我在这里没有的一双新鲜的眼睛。感谢他们。这个问题是微不足道的，但我仍然觉得值得保留，以防其他人有与我相同的块。

在 MacOS 10.7.5、Vagrant 版本 1.1.5 上运行（最新来自[http://downloads.vagrantup.com/](http://downloads.vagrantup.com/)）

删除的原因是我想重新开始，我添加了太多的盒子。我应该能够删除所有我相信的盒子。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-13T23:37:56.883

list 命令在括号中显示提供程序，提供程序类似于 virtualbox 或 vmware，而不是您从中获取框的 URL，您必须在删除期间指定提供程序以消除歧义，例如：

```
vagrant box remove lucid32 virtualbox 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-25T09:38:32.587

我必须输入框的全名（如“vagrant box list”所示才能将其删除。用“tab”完成命令导致： `vagrant box remove ferventcoder-VAGRANTSLASH-win7pro-x64-nocm-lite`while list command显示`ferventcoder/win7pro-x64-nocm-lite`。这导致Vagrant给我一个错误：`The box you requested to be removed could not be found. No boxes named 'opentable-VAGRANTSLASH-win-2012r2-standard-amd64-nocm' could be found.`

我解决了这个从`vagrant box list`命令中复制名称的问题： `vagrant box remove ferventcoder/win7pro-x64-nocm-lite`。

# c# - Linq orderby 文化（丹麦语，æøå）

> ID：15994098
> 
> 赞同：6
> 
> 时间：2013-04-13T23:34:43.527
> 
> 标签：c#, asp.net-mvc, linq, entity-framework

我的 orderby linq 表达式有问题。它以错误的顺序生成输出。我来自丹麦，正在创建一个丹麦网站，因此订单必须准确无误。

这是我的查询：

```
var model = (from w in db.News
                orderby w.Title
                select w).ToList(); 
```

输出是：

```
1, 123
2, æøå
3, hallo
4, know 
```

正确的顺序应该是这样的：

```
1, 123
2, hallo
3, know
4, æøå 
```

我该如何纠正？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-13T23:39:21.050

`OrderBy`如果您将使用流利的 Linq 语法，则可以将字符串比较器传递给方法：

```
var model = db.News.OrderBy(w => w.Title, StringComparer.InvariantCulture)
              .ToList(); 
```

顺便说一句，您可以使用以下方法创建特定于您的文化的字符串比较器`StringComparer.Create`：

```
StringComparer.Create(new CultureInfo("da-DK"), true) 
```

# shell - pager (less) -- 获取当前滚动位置？

> ID：15994099
> 
> 赞同：0
> 
> 时间：2013-04-13T23:34:49.423
> 
> 标签：shell, unix, tmux, pager, less-unix

我正在`git diff`使用 tmux 编写脚本输出的显示（嗯，它只是程序）：一旦检测到文件系统更改，shell 脚本就会执行`tmux send-keys q enter C-l "git diff" enter`，它可以有效地刷新`git diff`视图。

您可能会认为这类似于[iTerm 的 coprocesses](http://www.iterm2.com/coprocesses.html#/section/home)提供的功能。

问题是，我希望它在刷新时滚动回它所在的位置。

使用 tmux 的原因之一是窗口实际上是一个完全正常的交互式终端会话，可以正常交互以滚动查看完整输出。

但我想以某种方式获得滚动位置。

假设我想实际对终端窗口本身的文本内容进行计算，就像 iTerm2 的协同进程一样，但是我可以在 Linux 上使用它（通过 ssh）。tmux 提供这种能力吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T07:06:51.717

我不确定是否用脚本捕获它，但`less -N`会显示行号。`-jn`或者`--jump-target=n`可以跳转到某个位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-28T03:32:38.603

关于 iTerm 的协同进程，

`tmux`有一个命令`pipe-pane`，可用于将 shell 命令的输入和输出通过管道传输到 . 指定的目标窗格的输出和输入`-t`。

因此，如果我有一个 shell 程序，`~/script.sh`例如：

```
#!/usr/bin/env bash
while read line; do
    if [[ "$line" = "are you there?"* ]]; then
        echo "echo yes"
    fi
done 
```

请注意，`read line`它将读取打印到窗格的每一行，即提示。

我可以将其标准输入和标准输出连接到窗格 0，`my-session:my-window`如下所示：

```
tmux pipe-pane -IO -t my-session:my-window.0 "~/script.sh" 
```

然后在提示符下键入`echo are you there?`，它会响应：

```
$ echo are you there?
are you there?
$ echo yes
yes 
```

一起使用时要小心`-IO`，因为它很容易导致反馈循环（我在试验这个功能时不得不杀死 tmux 服务器几次，哈哈）。

# ruby - Ruby 评估没有评估？

> ID：15994101
> 
> 赞同：5
> 
> 时间：2013-04-13T23:35:09.797
> 
> 标签：ruby, eval

我如何在不使用 eval 的情况下评估数学字符串？

例子：

```
mathstring = "3+3" 
```

无论如何，可以在不使用 eval 的情况下进行评估？

也许正则表达式的东西..？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T23:52:18.623

您必须要么或`eval`它，要么解析它；并且由于您不想`eval`：

```
mathstring = '3+3'
i, op, j = mathstring.scan(/(\d+)([+\-*\/])(\d+)/)[0] #=> ["3", "+", "3"]
i.to_i.send op, j.to_i #=> 6 
```

如果您想实现可以使用的更复杂的东西`RubyParser`（正如@LBg 在[这里](https://stackoverflow.com/questions/4880886/ruby-parse-replace-and-evaluate-a-string-formula)写的那样-您也可以查看其他答案）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T00:01:04.693

我假设您出于安全原因不想使用 eval，并且确实很难正确清理 eval 的输入，但是对于简单的数学表达式，也许您可​​以检查它是否仅包含数学运算符和数字？

```
mathstring = "3+3"
puts mathstring[/\A[\d+\-*\/=. ]+\z/] ? eval(mathstring) : "Invalid expression"
=> 6 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T00:01:30.063

您有 3 个选项：

1.  老实说，最好 - 将其解析为反向波兰表示法，然后将其解析为等式
2.  正如你所说，使用 RegExps
3.  最快，但危险，通过调用`eval`但不是`Kernel#eval`

    ```
    RubyVM::InstructionSequence.new(mathstring).eval 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T23:46:59.470

Sure--you'd just want to somehow parse the expression using something other than the bare Ruby interpreter.

There appear to be some good options here: [https://www.ruby-toolbox.com/search?q=math](https://www.ruby-toolbox.com/search?q=math)

Alternatively, it probably wouldn't be *that* hard to write your own parser. (Not that I've seriously tried--I could be totally full of crap.)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-14T19:33:56.800

[Dentaku](https://github.com/rubysolo/dentaku)似乎（我还没有使用它）是一个很好的解决方案——它可以让你检查你的（数学和逻辑）表达式，并评估它们。

```
calculator = Dentaku::Calculator.new
calculator.evaluate('kiwi + 5', kiwi: 2) 
```

# .net - 在 Visual Studio 2012.2 中调试管理访问权限中断的进程

> ID：15994103
> 
> 赞同：1
> 
> 时间：2013-04-13T23:35:32.490
> 
> 标签：.net, visual-studio-2012

我有一个小型 C# 应用程序，它在内部使用多个 SCM API，例如 [OpenService](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684330%28v=vs.85%29.aspx)。因此，这是一个我知道需要管理权限才能正常运行的应用程序。通过运行具有管理访问权限的 Visual Studio，我已在 Visual Studio 2012 中成功调试此应用程序。这意味着由 Visual Studio 调试器启动的任何进程也以提升的访问权限启动。

安装 VS 2012 更新 2 后，这不再有效。即使您以管理权限启动 Visual Studio，似乎也不会以管理权限启动已调试进程。还有其他人遇到这个问题或知道解决方法吗？

操作系统：Windows 8（自 2012 年 4 月 13 日起全面更新）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T10:38:41.177

我安装了 Visual Studio Ultimate 2012 版本 11.0.60315.01 Update 2，并使用以下控制台应用程序项目对其进行了测试：

`类程序{

```
 [DllImport("shell32.dll")]
    public static extern bool IsUserAnAdmin();

    static void Main(string[] args)
    {
        Console.WriteLine("Elevated: " + IsUserAnAdmin());
        Console.ReadLine();
    }
}` 
```

从非提升的 Visual Studio 输出启动时为“提升：假”从提升的 Visual Studio 输出启动时为“提升：真”

你得到相同的结果吗？

# java - while 循环只在 deleteMax() 堆方法中执行一次

> ID：15994105
> 
> 赞同：2
> 
> 时间：2013-04-13T23:36:05.037
> 
> 标签：java, while-loop, heap

```
package x;

public class MaxHeap {

    private Element[] heapArray;
    private int maxSize;
    private int currentSize;

    public MaxHeap(int max) {
        maxSize = max;
        currentSize = 0;
        heapArray = new Element[maxSize]; // create the heap
    }

    public boolean isEmpty() {
        return currentSize == 0;
    }

    // Move an element up in the heap tree.
    public void adjustHeap(int index) {

        int parent = (index - 1) / 2;
        Element bottom = heapArray[index];

        while (index > 0 && heapArray[parent].getData() < bottom.getData()) {
            heapArray[index] = heapArray[parent]; // move it down
            index = parent;
            parent = (parent - 1) / 2;
        }
        heapArray[index] = bottom;
    }

    public boolean insert(int key) {
        if (currentSize == maxSize)
            return false;
        Element newElement = new Element(key);
        heapArray[currentSize] = newElement;
        adjustHeap(currentSize++);
        return true;
    }

    public Element[] getMaxHeap() {

        return heapArray;
    }

    public void printHeap() {
        int i;
        for (i = 0; i < maxSize; i++)
            System.out.print(heapArray[i].getData() + " ");
        System.out.println();
    }

    public void deleteMax() {
        heapArray[0].setData(heapArray[maxSize - 1].getData());
        currentSize--;

        int i = 0;
        while (i<=heapArray[maxSize - 1].getData()) {

            int left = 2 * i + 1;
            int right = 2 * i + 2;      

            if (heapArray[left].getData() <= heapArray[right].getData()) {
                i = (2 * i + 1);
                adjustHeap(right);
                i++;
            }
            if (heapArray[left].getData() >= heapArray[right].getData()) {
                i = (2 * i + 2);
                adjustHeap(left);
                i++;
            }

        }
    }
}

    package x;

    class Element {
        private int inData;
        public Element(int data){
            inData = data;
        }
        public int getData(){
            return inData;
        }
        public void setData(int data){
            inData = data;
        }
    }

package x;

public class Test {

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

        MaxHeap heap = new MaxHeap(13);
        heap.insert(2);
        heap.insert(20);
        heap.insert(10);
        heap.insert(5);
        heap.insert(6);
        heap.insert(15);
        heap.insert(7);
        heap.insert(8);
        heap.insert(18);
        heap.insert(11);
        heap.insert(4);
        heap.insert(3);
        heap.insert(1);

        heap.printHeap();
        System.out.println("\n");

        heap.deleteMax();
        heap.printHeap();

    }
} 
```

我的问题是：为什么我的 while 循环只执行一次？我希望我的 deleteMax 方法删除最大节点（根），然后正确排序堆，使其再次成为最大堆。最大堆如下： 20 18 15 8 11 10 7 2 6 5 4 3 1

一旦 deleteMax 被调用，它应该输出： 18 11 15 8 5 10 7 2 6 1 3 4

但它改为输出： 18 1 15 8 11 10 7 2 6 5 4 3 1

显然它正在删除最大节点，用最底部的叶子替换它，并用它最大的孩子交换新的根。然后它应该继续在堆中交换 1，但在这样做之前它会停止。

我为 while 循环尝试了许多不同的逻辑，包括：

```
while(Math.floor(i/2) <= 2*i+1 && Math.floor(i/2) <= 2*i+2) 
```

并增加 i 但似乎没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:09:04.233

你没有旋转根。你的循环体应该看起来像这样。

```
if (heapArray[left].getData() < heapArray[i].getData()) {
    temp = heapArray[i].getData();
    heapArray[i].setData(heapArray[left].getData());
    heapArray[left].setData(temp);
    i = (2 * i + 1);
 }
 else if (heapArray[right].getData() > heapArray[i].getData()) {
     temp = heapArray[i].getData();
     heapArray[i].setData(heapArray[right].getData());
     heapArray[right].setData(temp);
     i = (2 * i + 2);
 } 
```

您的`adjustHeap`方法可能已经在执行此交换，我无法确定。底线是您需要在堆中旋转根（而不是比较分支），并且您不应该`i++`在其中放置语句。它也应该是`<`代替`<=`和`>`代替`>=`，但这只是一个小的优化。

# c# - C# 优先级队列，泛型类型 转换

> ID：15994108
> 
> 赞同：-1
> 
> 时间：2013-04-13T23:37:02.767
> 
> 标签：c#, generics, queue, priority-queue

```
public class PriorityQueue<T> : IPriorityQueue<T> 
                            where T : IComparable 
```

所以，我用上面的 Header 制作了一个优先队列类，我正在尝试将它与另一个类一起使用。

```
 private static PriorityQueue<Order> PQ; 
```

看起来这应该可以正常工作，但我收到了这个错误。

> My`namespace.Order`不能用作`T`泛型方法中的类型参数`namespace.PriorityQueue<T>`。没有从`namespace.Order`到的隐式转换`System.IComparable`

我无法真正辨别那告诉我要做什么。这是否意味着我的`IComparable`实现不足以达到此目的，还是我正在使用某种糟糕的语法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T23:39:23.093

它说，你的泛型类型参数（即`Order`类型）应该实现[IComparable](http://msdn.microsoft.com/en-us/library/system.icomparable.aspx)接口。

# internet-explorer - 这是来自 IE 还是来自我的代码的错误？- “等待 http://mysite.com”

> ID：15994113
> 
> 赞同：12
> 
> 时间：2013-04-13T23:37:50.617
> 
> 标签：internet-explorer, freeze, titlebar

当我访问我的页面时，标题已正确加载，但一秒钟后，它变为“等待[http://example.com](http://example.com) ”。

页面加载，但即使在加载完所有内容后，标题仍会继续，但仅在 IE 选项卡中，因为在托盘中标题应为应有的样子。

PS：Chrome不会发生这种情况。并且 IE 版本是 10

问题的图片：
![在此处输入图像描述](https://i.stack.imgur.com/ANyHb.png)

我的 HTML 代码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <link rel="shortcut icon" type="image/ico" href="http://www.datatables.net/favicon.ico" />

        <title>DataTables Editor example</title>
        <style class="include" type="text/css">
            @import "support/bootstrap/css/bootstrap.css";
            @import "support/bootstrap/dataTables/dataTables.bootstrap.css";
            @import "css/customTable.css";
        </style>

        <script class="include" type="text/javascript" charset="utf-8" src="../../../media/js/jquery.js"></script>
        <script class="include" type="text/javascript" charset="utf-8" src="../../../media/js/jquery.dataTables.js"></script>
        <script class="include" type="text/javascript" charset="utf-8" src="../../TableTools/media/js/TableTools.js"></script>
        <script class="include" type="text/javascript" charset="utf-8" src="../../TableTools/media/js/ZeroClipboard.js"></script>
        <script class="include" type="text/javascript" charset="utf-8" src="../media/js/dataTables.editor.js"></script>

        <script class="include" type="text/javascript" charset="utf-8" src="support/bootstrap/js/bootstrap.js"></script>
        <script class="include" type="text/javascript" charset="utf-8" src="support/bootstrap/dataTables/dataTables.bootstrap.js"></script>
        <script class="include" type="text/javascript" charset="utf-8" src="support/bootstrap/dataTables/dataTables.editor.bootstrap.js"></script>

        <script class="include" type="text/javascript" charset="utf-8" src="./js/custom.js"></script>

    </head>
    <body class="c_body">
        <div class="mContainer">
            <div id="dt_div">
                <table class="table table-striped table-bordered display" id="example">
                    <thead>
                        <tr>
                            <th style="text-align: center;">Data</th>
                            <th style="text-align: center;">Tema</th>
                            <th style="text-align: center;">V&iacute;nculo</th>
                            <th style="text-align: center;">Empresa</th>
                            <th style="text-align: center;">Sub contratada</th>
                            <th style="text-align: center;">NDP</th>
                            <th style="text-align: center;">CH</th>
                            <th style="text-align: center;">HHT</th>
                            <th style="text-align: center;">Ger&ecirc;ncia</th>
                            <th style="text-align: center;">&Aacute;rea Solicitante</th>
                            <th style="text-align: center;">CC</th>
                            <th style="text-align: center;">Rateio</th>
                        </tr>
                    </thead>
                </table>
            </div>
            <div class="spacer"></div>

        </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-01-26T22:35:20.143

微软已经承认这个问题是 IE10 中的一个错误。该问题已关闭，状态为“无法修复”。 [https://connect.microsoft.com/IE/feedback/details/787208/ie10-waiting-for-domains-url-text-occasionally-gets-stuck-on-tabs-title-only-after-refreshing-it](https://connect.microsoft.com/IE/feedback/details/787208/ie10-waiting-for-domains-url-text-occasionally-gets-stuck-on-tabs-title-only-after-refreshing-it)

这也是 IE11 中的一个已知错误。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-01-23T02:54:30.093

奇怪的是，我似乎设法为 ie8 修复了它，而在 JavaScript 中使用它显然不会对 Firefox 或 Chrome 造成任何损害

```
 <script language="javascript">
  window.onfocus = function(){
  var title_var = document.title;
  document.title = title_var;
  }
 </script> 
```

正如 Charly H 建议的那样，也可以使用 onload

```
 <script language="javascript">
  window.onload = function(){
  var title_var = document.title;
  document.title = title_var;
  }
 </script> 
```

# r - 根据另一个表更新数据框变量

> ID：15994116
> 
> 赞同：2
> 
> 时间：2013-04-13T23:38:31.090
> 
> 标签：r, dataframe, data-analysis

我有两个**数据框**表 1 和表 2，每个数据框都有两个变量（V1，V2）我想要做的是根据表 2 的 V2 更新表 1 的每一行的 V2。

例如，在表 1 中有两行 V1==27，它们的 V2 值分别为 6 和 7。根据表 2，每个 V1==27 应该是 6.5，所以我想从表中更新每个 V1==27 1 并设置其 V2=6.5。

我怎样才能用 R 做到这一点？

```
Table 1
  V1     V2
   1     1
   5     2
   18    3
   24    4
   25    5
   27    6
   27    7

Table 2
  V1     V2
   1     1.0
   5     20000.0
   18    3.0
   24    4.0
   25    5.0
   27    6.5

Resulting Table 3
  V1     V2
   1     1.0
   5     20000.0
   18    3.0
   24    4.0
   25    5.0
   27    6.5
   27    6.5 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T00:08:14.773

几种方法：

```
transform(table1, V2 = table2$V2[match(V1, table2$V1)]) 
```

或者

```
merge(table1["V1"], table2, all.x = TRUE) 
```

# exception - ArgumentNullException 与 Contract.Requires

> ID：15994117
> 
> 赞同：0
> 
> 时间：2013-04-13T23:39:19.420
> 
> 标签：exception, code-contracts

如果传递给它的参数为空，则**ArgumentNullException**会引发异常。这发生在运行时。**Contract.Requires**是做什么的？是编译时检查还是运行时检查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:30:00.340

`Contract.Requires`[是运行时检查（运行时检查在编译时自动生成 - 请参阅文档](http://research.microsoft.com/en-us/projects/contracts/userdoc.pdf)的第 6.2 章和第 7 章）。也可以执行某些静态检查（参见[文档](http://research.microsoft.com/en-us/projects/contracts/userdoc.pdf)的第 6.6 章），但`Requires`它是运行时检查。

请注意，有一个通用重载可以让您指定要抛出的异常（例如，ArgumentNullException）

# php - 单击按钮后加载json

> ID：15994122
> 
> 赞同：1
> 
> 时间：2013-04-13T23:39:31.517
> 
> 标签：php, javascript, json, html

我想在用户单击按钮后加载一个 json 文件，但不知道该怎么做。

如果我直接加载文件，它将使用以下内容加载。

```
 <script src="data.json" type="text/javascript"></script> 
```

但我希望用户在加载之前单击一个按钮，而不是在访问页面时加载。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T23:50:06.660

Simple: use AJAX. It will load anything you want via Javascript which you can assign timings to. In this example we attach a `click` event to `#myButton` and when the event fires, we run a `getJSON()` call to the URL and handle the data accordingly.

**HTML**

```
<button id="myButton">Button</button> 
```

**Javascript (jQuery in my example)**

```
$("#myButton").on('click', function() {
    $.getJSON("data.json", function(data) {
        //Handle my response
        alert(data);
    });
}); 
```

If you want an example not using jQuery then [Google "Javascript AJAX"](https://www.google.com/search?q=jquery%20getjson&aq=f&oq=jquery%20get&aqs=chrome.0.59j57j5j59j60l2.1949j0&sourceid=chrome&ie=UTF-8#sclient=psy-ab&q=Javascript%20AJAX&oq=Javascript%20AJAX&gs_l=serp.3..0l4.64521.67231.0.67390.17.9.1.7.7.0.72.425.9.9.0...0.0...1c.1.9.psy-ab.P97AK_OQO5E&pbx=1&bav=on.2,or.r_qf.&bvm=bv.45175338,d.eWU&fp=6c3dfd5e76c68c34&biw=1335&bih=727).

# python - Python中元组的扁平化列表

> ID：15994124
> 
> 赞同：0
> 
> 时间：2013-04-13T23:39:34.393
> 
> 标签：python, list

我正在使用递归函数来创建穿过迷宫的流动路径。该函数返回正确的路径元组（行，列），但我需要以元组列表的形式。例如我需要创建这个表单

```
[(0,0),(1,1),(2,2),(3,3),(4,3)] 
```

但是该函数返回：

```
[(0, 0), [(1, 1), [(2, 2), [(3, 3), (4, 3)]]]] 
```

这是功能：

```
def FlowPathAt(fdir,row,col):
    lItem = FlowOut(fdir,row,col)
    if not lItem:
        return (row,col)
    else:
        r,c = lItem
        return [(row,col) ,  FlowPathAt(fdir,r,c)] 
```

`FlowOut(fdir,row,col)`是一个函数，它返回从 (row,col) 开始的下一个单元格地址

有没有办法在构建过程中展平这个列表？

类似：[如何将元组列表展平为 pythonic 列表](https://stackoverflow.com/questions/27454390/how-to-flatten-a-list-of-tuples-into-a-pythonic-list)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T23:46:43.267

Try this:

```
def FlowPathAt(fdir,row,col):
    lItem = FlowOut(fdir,row,col)
    if not lItem:
        return [(row,col)] # More convenient base case
    else:
        r,c = lItem
        return [(row,col)] + FlowPathAt(fdir,r,c) # Append list to list instead of nesting 
```

(This always returns a list of tuples, too, which just seems like a better idea than sometimes returning a list and sometimes returning a single tuple. If that's not acceptable, you'll need to do some post-processing.)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-14T00:55:13.063

列表增长需要大量内存管理，为什么不将其重构为生成器函数：

```
def FlowPathAt(fdir, row, col):
    while True:
        yield row, col
        lItem = FlowOut(fdir, row, col)
        if lItem is None: break
        row, col = lItem 
```

# google-apps-script - importRange 和导入评论？

> ID：15994127
> 
> 赞同：1
> 
> 时间：2013-04-13T23:39:45.547
> 
> 标签：google-apps-script

我正在尝试将注释与单元格值一起导入。我正在使用 importRage() 作为值。我还发现了以下应该获得评论的 Google Apps 脚本：

```
 function importComments(spreadsheetKey,a1NotationReference) {
      return SpreadsheetApp.openById(spreadsheetKey).getRange(a1NotationReference).getComments();
    } 
```

但是，每次运行它时，我都会收到“缺少形式参数”错误。

我也试过这样运行它，但没有运气/

```
 function importComments(0AqvTp4ajjRSUdHYyV09QcWtnRFQ2SDUwSTF6OTBKQ0E,Overall!B2:I2) {
      return SpreadsheetApp.openById(0AqvTp4ajjRSUdHYyV09QcWtnRFQ2SDUwSTF6OTBKQ0E).getRange(Overall!B2:I2).getComments();
    }; 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T10:04:03.150

您没有正确调用该函数，以下是您添加到 Google 脚本管理器的内容。这不需要更改。

```
function importComments(spreadsheetKey,a1NotationReference) {
      return SpreadsheetApp.openById(spreadsheetKey).getRange(a1NotationReference).getComments();
    } 
```

然后，您可以使用以下函数在电子表格中调用它。只需像普通的电子表格方程式一样输入单元格。

```
=importComments("0AqvTp4ajjRSUdHYyV09QcWtnRFQ2SDUwSTF6OTBKQ0E", "Overall!B2:I2") 
```

正如 Google 论坛上的 Henrique Abreu 所提到的，这与 importRange 非常相似。[请查看此页面以了解其用法](http://support.google.com/drive/bin/answer.py?hl=en&answer=155183)，因为它将有助于 importComments。

**编辑**两者的例子......***未经测试***

```
function importBoth(spreadsheetKey,a1NotationReference){
   return SpreadsheetApp.openById(spreadsheetKey).getRange(a1NotationReference).getComments();
   return SpreadsheetApp.openById(spreadsheetKey).getRange(a1NotationReference).getValue();
} 
```

# iphone - CAEmitterCell 不尊重持续时间值

> ID：15994133
> 
> 赞同：1
> 
> 时间：2013-04-13T23:41:29.043
> 
> 标签：iphone, ios, caemitterlayer, caemittercell

我有一个发射器，我想在 2 秒后结束，但我无法让它停止运行！

我的代码如下：

```
// Emitter Layer
    //
    emitter = [CAEmitterLayer layer];
    emitter.emitterSize = CGSizeMake(20, 20);
    emitter.renderMode = @"additive";
    emitter.emitterMode = @"points";
    emitter.emitterShape = @"rectangle";
    emitter.emitterPosition = CGPointMake(310, 230);
    //emitter.duration = 2; // setting duration on the emitterLayer prevents anything from firing it seems

// Emitter Cells
    //

    // 'New Emitter' cell configuration
    newEmitter = [CAEmitterCell emitterCell];
    newEmitter.scaleSpeed = 7;
    newEmitter.lifetime = 2.481715;
    //newEmitter.duration = 2; // I would expect this to stop the emitter after 2 seconds, but it doesn't!
    newEmitter.velocity = 332.3636968085106;
    newEmitter.contents = newemitterImg;
    newEmitter.name = @"New Emitter";
newEmitter.scaleRange = 4.178236607142859;
    newEmitter.lifetimeRange = 1.6;
    newEmitter.greenRange = -2.775558e-17;
    newEmitter.birthRate = 40;
    newEmitter.emissionRange = -6.283185306666667;
    newEmitter.scale = 0;

    // Emitter Cell Chains
    //

    emitter.emitterCells = [NSArray arrayWithObjects:newEmitter, nil]; 
```

尽管已经成为 iOS 的一部分大约 2 年，但似乎很少有关于此的信息！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T04:18:21.523

您可以使用计时器和停止发射器生成新粒子的方法来执行此操作...

在现有代码的末尾添加：

```
 [newEmitter setName:@"newEmitter"];
    [NSTimer scheduledTimerWithTimeInterval:2.0
                                     target:self
                                   selector:@selector(stopEmitter:)
                                   userInfo:nil
                                    repeats:NO]; 
```

然后制作一个 stopEmitter: 方法……</p>

```
 - (void) stopEmitter:(NSTimer*)timer
    {
        [emitter setValue:@0
               forKeyPath:@"emitterCells.newEmitter.birthRate"];
    } 
```

# loops - SASS 或 LESS 关键帧百分比循环

> ID：15994136
> 
> 赞同：10
> 
> 时间：2013-04-13T23:41:43.513
> 
> 标签：loops, sass, less, css-animations

我正在测试一些特殊的东西，我试图在关键帧内循环以动态地将百分比写入其中。

我已经用 SASS 测试过类似的东西，但它不起作用。

```
@keyframes test{

    @for $i from 0 through 100 {
        #{$i}% {
            //do special stuff
        } 
        $i: $i + 1;
    } 
```

我希望它输出：

```
@keyframes test{
    0%{
          ...
    }
    1%{
          ...
    }
    2%{
          ...
    }
    3%{
          ...
    }
    ...
} 
```

但我得到了

```
Error on line number: 23\. Invalid CSS after "    #{$i}%": expected placeholder name, was " {" 
```

我已经在 LESS 中对此进行了测试，但它也不起作用。

```
 @a: 0%;

    @keyframes test{

       .func (@a, @b, @c);

    }

    .func (@a, @b, @c) when (@a < 100%){  
        (@a){
            //do special stuff
        }

        .func (@a+1, @b, @c);
    } 
```

有人能帮我吗 ？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-14T00:00:47.610

如果您像这样处理它，它将起作用：

```
@keyframes test {
  @for $i from 0 through 100 {
    #{$i * 1%} {
      // do special stuff
    } 
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-09T12:40:12.273

# 少版本

需要`.for`mixin

*   [https://github.com/pixelass/more-or-less/blob/master/less/fn/_for.less](https://github.com/pixelass/more-or-less/blob/master/less/fn/_for.less)

## 注意

这是一个非 inline-js 版本，以实现最大兼容性

## 输入

```
@keyframes crazy {
    .for(0,100);.-each(@i){
        @selector: e('@{i}%');

        @{selector} {
            /* do crazy stuff */
        }
    }
} 
```

## 输出

```
@keyframes crazy {
  0% {
    /* do crazy stuff */
  }
  1% {
    /* do crazy stuff */
  }
  2% {
    /* do crazy stuff */
  }
  3% {
    /* do crazy stuff */
  }
  4% {
    /* do crazy stuff */
  }
    ...etc
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-07-19T18:51:06.203

Sass 显然需要一个定义为百分比的值才能正确渲染。此示例生成关键帧来为背景设置动画，但您可以将值列表和属性更改为动画。

# SASS

```
 //Given a list of colors
$COLORS: $COLOR-MAIN #f39d75 #c1cecd #f3f57e

// Define a mixin
=animate-color-keyframes($list: $COLORS, $property: background)
    //declare the first keyframe statically
    0%
        #{$property}: nth($list, -1)
    @for $i from 1 through length($list)
        // calculate the keyframe percentage
        $percentage: $i / length($list)
        $keyframe: percentage($percentage)
        // render keyframes
        #{$keyframe}
            #{$property}: nth($list, $i)

// .....
@keyframes change-bg-color
    +animate-color-keyframes 
```

# CSS 输出

```
 @keyframes change-bg-color {
  0% {
    background: #f3f57e; }
  25% {
    background: #abf0b3; }
  50% {
    background: #f39d75; }
  75% {
    background: #c1cecd; }
  100% {
    background: #f3f57e; } 
} 
```

# java - Java中的对象不变性

> ID：15994141
> 
> 赞同：0
> 
> 时间：2013-04-13T23:42:33.607
> 
> 标签：java

为了在 Java 中使对象不可变，我将类标记为 final，它的所有变量都标记为 final，并且没有提供 setter 和 getter。这些是否会提供足够的保证来保证对象不会被修改？是全部 3 个必要条件还是 3 个条件中的 2 个就足够了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T23:49:33.587

```
public final class MyClass 
```

Has nothing to do with immutability, it only disallows inheritance.

Just marking variable references `final` is not enough, every object you refer to has to be immutable as well.

`final` doesn't make an object immutable, it makes the references immutable;

```
private final List<String> strings = new ArrayList<String>(); 
```

`strings` is still a mutable `List`, only the **reference** to the `List` is immutable.

Be careful with things like:

```
Collections.unmodifiableList(strings); 
```

`Collections.unmodifiableList()` [JavaDoc](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#unmodifiableList%28java.util.List%29) provides a "unmodifiable view" but it still doesn't guarantee that the underlying list could not be changed by an external reference to the original `List` that is being wrapped. A deep copy of the list contents would have to be made into a new list and that list wrapped with `unmodifiable`.

And every instance of every object and all their children and children's children have to be immutable as well.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T23:53:23.807

将您的字段标记为最终选项是您在上述集合中唯一需要的选项。您可以提供 getter，但要小心像集合这样的可变子对象。Final 使引用不可变，但内容不可变。如果值是可变的，则使用 getter 的一个有用技术是制作一个防御性副本，如下所示：

```
public class ImmutableExample{

    private final int value1; // immutable
    private final List<Integer> value2; // contents will not be immutable

    public ImmutableExample(...){...} // be careful here to copy the collection as you want to disalow any outside modification.

    public int getValue1(){
        return value1;
    }

    public List<Integer> getValue2(){
        return Collections.unmodifiableList(value2);
    }
} 
```

另一种选择是使用包含不可变集合的[Google Guava](https://code.google.com/p/guava-libraries/)集合，正如我们在此处讨论的： [不可变对象和不可修改集合](https://stackoverflow.com/questions/12451013/immutable-objects-and-unmodifiable-collections)。这些导致非常简单的不可变类：

```
public class ImmutableExample{

    private final int value1; // immutable
    private final ImmutableList<Integer> value2; // immutable

    public ImmutableExample(...){...}

    public int getValue1(){
        return value1;
    }

    public List<Integer> getValue2(){
        return value2;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T00:06:29.523

将所有变量设置为私有并仅提供 getter 会更自然。然后，您无需设置`final`不必要的类。

如果字段本身是非最终对象（例如集合），则必须进一步考虑。您应该只存储这些副本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T23:45:30.953

Marking your class as `final` you're only telling that no one can subclass it.

That said, marking your variables as `final` would be enough, as long as your class had only 'primitive' attributes. It's ok (and encouraged) to keep the getters, however, you also may want remove the setters, since while you don't want any external class to mess around with your variables, setters won't be needed.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-14T00:50:35.793

与这里的一些评论相反，使类 final*确实*与不变性有关。对于一个不可变的类，它*应该*是最终的，以便不允许子类覆盖任何 getter，从而不允许它们通过返回不同的值来“改变”它。

```
Recall that to guarantee immutability, a class must not permit itself to be subclassed.

- Joshua Bloch, Effective Java 
```

此外，来自 Java 教程，[定义不可变对象的策略](http://docs.oracle.com/javase/tutorial/essential/concurrency/imstrat.html)：

> 3.不允许子类覆盖方法。最简单的方法是将类声明为 final

# php - 传递变量的更好方法？

> ID：15994145
> 
> 赞同：1
> 
> 时间：2013-04-13T23:43:03.970
> 
> 标签：php, javascript, jquery

我有在文本区域框中生成内容的表单，目前我正在传递表单选项，如下所示：

```
function button_click() {
    var columns = $('#form_id').val();
    var url='generate.php?';        
    url+='&form_id='+encodeURIComponent(form_id);
    $.ajax({
    url: url,
    beforeSend: function (xhr) {
        xhr.overrideMimeType("application/json; charset=x-user-defined");
    }
    }) 
```

然后在php页面上我有一个请求：

```
$form_id= $_REQUEST['form_id']; 
```

然后我可以在 php 中使用我希望的变量。

好像有点多余。

如果我将表单全部设为 php 而不是全部使用 ajax/json，我该如何浓缩这一点，这会有很大的不同吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-13T23:59:18.480

如果我正确理解了你的问题，我会说不可能做你想做的事。问题是 PHP 脚本在服务器端执行，而 javascript 和表单由客户端（浏览器）处理。

所以一般来说，没有办法从 PHP 直接访问表单/javascript 的变量（元素）。您只能通过 GET/POST HTTP 请求将这些变量从表单传递到您可以通过 PHP 脚本处理它们的服务器。

# .net - 有没有办法使用 LDAP 只获取前 N 个搜索结果？

> ID：15994150
> 
> 赞同：4
> 
> 时间：2013-04-13T23:43:48.920
> 
> 标签：.net, ldap

有没有一种好方法只检索 LDAP 查询的前 N ​​个结果，以节省服务器负载并增加响应时间？

例如，用例是基于渐进式 AJAX 的名称选择器（通过 LDAP 到 HTTP 网关，该网关希望将查询大小限制为支持 LDAP 目录），它将查找以用户迄今为止键入的字母开头的所有结果。

使用 .NET 4.5 System.DirectoryServices.Protocols 的示例代码将不胜感激，但这不是必需的，因为如果我知道实际的协议要求是什么，我就可以弄清楚如何发送请求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T00:18:08.103

这正是 Java [PagedResultsControl](http://docs.oracle.com/javase/6/docs/api/javax/naming/ldap/PagedResultsControl.html)的用途。[.NET](http://msdn.microsoft.com/en-us/library/system.directoryservices.protocols.pageresultrequestcontrol.aspx)中也有一个。这些东西为你实现了协议，只提供了一个 API。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T22:53:50.060

EJP的好答案。请注意，虽然 LDAP 客户端可以很容易地将自己限制为前 N 个结果，但从搜索返回的排序条目是*不可重复*的。也就是说，搜索结果中返回的条目顺序不仅没有定义，而且不保证重复，即使在同一连接毫秒后也是如此。对排序敏感的 LDAP 客户端可能会遇到故障或无法解释的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T00:49:55.057

对于您的特定目的（自动完成建议），我会使用 ldap sizelimit 而不是分页结果。区别如下：

**尺寸限制**

您对前 xx 个对象感兴趣。你不关心其余的，你也不需要其余的。

**分页结果**

您对*所有*对象感兴趣，但您希望以每页xx 个对象的批次/*页的形式检索它们。*您最终可能需要从服务器获取所有对象。

这里明显的开销是，对于分页结果，服务器必须记住您的搜索状态并在您请求下一页时适当地恢复它。由于这对于自动完成列表通常是不必要的（除非您希望可以选择进一步按需扩展自动完成列表），因此您可以使用 sizelimit 比使用分页结果为您的服务器节省一些额外的负载。

我不是 .NET 程序员，但谷歌发现了这个，你可能会感兴趣：
[system.directoryservices.directorysearcher.sizelimit](http://msdn.microsoft.com/en-us/library/system.directoryservices.directorysearcher.sizelimit.aspx)

有关更多详细信息，您还可以查看 RFC 页面（在此处搜索 sizelimit）：
[rfc1777](http://www.ietf.org/rfc/rfc1777.txt)

# jquery - 尝试将 CSS3 动画应用于跨度中的文本

> ID：15994151
> 
> 赞同：1
> 
> 时间：2013-04-13T23:43:49.520
> 
> 标签：jquery, css, animation

我正在尝试将 CSS3 动画应用于包含在跨度中的文本。

它在元素具有动画类和动画名称的类时起作用。

我正在使用 jQuery 添加这些类，因为此动画在单击时发生并且将在 click() 函数中。我还在添加它们之前删除了这些类，因为这些类只能存在一次才能使动画工作。

我以前做过很多次，但是由于某种原因，当我尝试用 span 包裹的文本时它不起作用。

jQuery 似乎在开发人员工具中工作，我看到单击时添加和删除的类，但动画没有发生。

这是我的 jQuery 代码：

```
$(document).ready(function(){
    $('.I').click(function(){
            $(this).removeClass('animated').removeClass('wiggle').addClass('animated').addClass('wiggle');
    });
}); 
```

这是动画的CSS：

```
.animated{-webkit-animation-fill-mode:both;-moz-animation-fill-mode:both;-ms-animation-fill-mode:both;-o-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:1s;-moz-animation-duration:1s;-ms-animation-duration:1s;-o-animation-duration:1s;animation-duration:1s;}.animated.hinge{-webkit-animation-duration:2s;-moz-animation-duration:2s;-ms-animation-duration:2s;-o-animation-duration:2s;animation-duration:2s;}@-webkit-keyframes wiggle {
0% { -webkit-transform: skewX(9deg); }
10% { -webkit-transform: skewX(-8deg); }
20% { -webkit-transform: skewX(7deg); }
30% { -webkit-transform: skewX(-6deg); }
40% { -webkit-transform: skewX(5deg); }
50% { -webkit-transform: skewX(-4deg); }
60% { -webkit-transform: skewX(3deg); }
70% { -webkit-transform: skewX(-2deg); }
80% { -webkit-transform: skewX(1deg); }
90% { -webkit-transform: skewX(0deg); }
100% { -webkit-transform: skewX(0deg); }
}

@-moz-keyframes wiggle {
    0% { -moz-transform: skewX(9deg); }
    10% { -moz-transform: skewX(-8deg); }
    20% { -moz-transform: skewX(7deg); }
    30% { -moz-transform: skewX(-6deg); }
    40% { -moz-transform: skewX(5deg); }
    50% { -moz-transform: skewX(-4deg); }
    60% { -moz-transform: skewX(3deg); }
    70% { -moz-transform: skewX(-2deg); }
    80% { -moz-transform: skewX(1deg); }
    90% { -moz-transform: skewX(0deg); }
100% { -moz-transform: skewX(0deg); }
}

@-o-keyframes wiggle {
    0% { -o-transform: skewX(9deg); }
    10% { -o-transform: skewX(-8deg); }
    20% { -o-transform: skewX(7deg); }
    30% { -o-transform: skewX(-6deg); }
    40% { -o-transform: skewX(5deg); }
    50% { -o-transform: skewX(-4deg); }
    60% { -o-transform: skewX(3deg); }
    70% { -o-transform: skewX(-2deg); }
    80% { -o-transform: skewX(1deg); }
    90% { -o-transform: skewX(0deg); }
100% { -o-transform: skewX(0deg); }
}

@keyframes wiggle {
    0% { transform: skewX(9deg); }
    10% { transform: skewX(-8deg); }
    20% { transform: skewX(7deg); }
    30% { transform: skewX(-6deg); }
    40% { transform: skewX(5deg); }
    50% { transform: skewX(-4deg); }
    60% { transform: skewX(3deg); }
    70% { transform: skewX(-2deg); }
    80% { transform: skewX(1deg); }
    90% { transform: skewX(0deg); 
100% { transform: skewX(0deg); }
}

.wiggle {
    -webkit-animation-name: wiggle;
    -moz-animation-name: wiggle;
    -o-animation-name: wiggle;
    animation-name: wiggle;

    -webkit-animation-timing-function: ease-in;
    -moz-animation-timing-function: ease-in;
    -o-animation-timing-function: ease-in;
    animation-timing-function: ease-in;
} 
```

**更新：这是一个重现问题的小提琴：http:** [//jsfiddle.net/3Ld8e/1/](http://jsfiddle.net/3Ld8e/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:10:34.727

跨度是内联或流元素，因此没有位置、高度、宽度；他们只是根据他们的位置流动。

尝试将跨度更改为

```
display: inline-block 
```

这应该允许每个跨度都有自己的大小属性，然后可以设置动画。

您还需[要让浏览器](http://mir.aculo.us/2010/08/17/when-does-javascript-trigger-reflows-and-rendering/)在删除 css 类并重新添加它们之间重新绘制页面。当前添加和删除类时不会发生这种情况：元素在浏览器之前和之后看起来相同。

最好的解决方案是监听`animationend`事件，然后删除类（在动画执行之后）。

```
$(document).ready(function(){

    var letters = $('.I');

    letters.on('animationend oanimationend webkitAnimationEnd', function () {
        $(this).removeClass('animated wiggle');
    });

    letters.on('click', function(){
        $(this).addClass('animated wiggle');
    });
}); 
```

更新的 JSFiddle 在这里：http: [//jsfiddle.net/thefrontender/3Ld8e/3/](http://jsfiddle.net/thefrontender/3Ld8e/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:51:08.200

您缺少动画 CSS 开头的类选择器。现在它是将动画应用于动画类的元素 bazinga。

# exception - MIPS 汇编子例程和堆栈，异常 5 错误数据地址，异常 7 存储地址错误

> ID：15994153
> 
> 赞同：0
> 
> 时间：2013-04-13T23:43:56.317
> 
> 标签：exception, assembly, mips, subroutine, stack-frame

我正在尝试通过组装找出一些堆栈框架业务，我承认我不知道我在做什么......但我认为我很接近？

我的程序调用一个从 10 开始倒计时然后退出的子程序。这实际上似乎工作正常，但我收到一些异常错误。

# 这是我的输出

![在此处输入图像描述](https://i.stack.imgur.com/6rxpE.png)

# 这是我的代码：

```
main: ######################################################################

    ################### SAVE STACK ###################

    subu $sp, $sp, 32           # create 32 byte stack frame

    ########## save ra and fp
    sw $ra, 0($sp)              # save return address
    sw $fp, 4($sp)              # save frame pointer

    #addu $fp, $sp, 28          # setup new frame pointer ?????

    ########## save general purpose registers

    sw $s0, 8($s0)              # save counter 

    ##################################################

    ########## Begin Message
    li, $v0, 4                  # sys call #4, print string
    la, $a0, STR_BEGIN          # load string
    syscall                     # execute call

    li, $s0, 10                 # init loop counter

    ########## Print Starting Point
    li $v0, 1                   # sys call #1, print int
    move $a0, $s0               # load starting count
    syscall                     # execute call

    ########## Call Subroutine
    jal subroutine              # call subroutine
    # print something to show when it returns

    ########## END Message
    #li, $v0, 4                 # sys call #4, print string
    #la, $a0, STR_END           # load string
    #syscall                    # execute call

    ################## RESTORE STACK #################

    ########## restore general purpose registers
    lw $s0, 8($sp)              # restore counter

    ########## restore ra and fp
    lw $ra, 0($sp)              # restore return address
    lw $fp, 4($sp)              # restore frame pointer

    addu $fp, $sp, 32           # restore callers stack pointer

    ##################################################

ending:    jr $31               # stop the program, why does this loop if i uncomment the above syscall?

subroutine: ######################################################################

    ################### SAVE STACK ###################

    subu $sp, $sp, 32           # create 32 byte stack frame

    ########## save ra and fp
    sw $ra, 0($sp)              # save return address
    sw $fp, 4($sp)              # save frame pointer

    addu $fp, $sp, 28           # setup new frame pointer ?????? why am i doing this?

    ########## save general purpose registers

    sw $s0, 8($s0)              # save counter 

    ##################################################

    sub $s0, $s0, 1             # decrement by one

    ########## Count Down
    li, $v0, 4                  # sys call #4, print string
    la, $a0, STR_ELIPS          # load string
    syscall                     # execute call

    li $v0, 1                   # sys call #1, print int
    move $a0, $s0               # load starting count
    syscall                     # print output

    ########## subroutine condition
    bgt $s0, 0, subroutine      # if count < 10, then loop  

    ################## RESTORE STACK #################

    ########## restore general purpose registers
    lw $s0, 8($sp)              # restore counter

    ########## restore ra and fp
    lw $ra, 0($sp)              # restore return address
    lw $fp, 4($sp)              # restore frame pointer

    addu $fp, $sp, 32           # restore callers stack pointer

    ##################################################

    jr  $ra                     # return to caller

# END subroutine ###################################################################### 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T18:48:32.263

我能发现的第一个明显错误是你的

```
sw $s0, 8($s0)              # save counter 
```

行（出现 2 次）。您可能希望稍后从那里`sw $s0, 8($sp)`恢复。`s0`修复它并使用调试器查找更多错误（如果有）。

更新：这也是错误的：

```
addu $fp, $sp, 32           # restore callers stack pointer 
```

应该是`addu $sp, $sp, 32`。

# python - Python中如何区分读卡器和键盘？

> ID：15994154
> 
> 赞同：1
> 
> 时间：2013-04-13T23:44:21.323
> 
> 标签：python, cardreader

我有一个读卡器（MagTec MSR100），我想用它来读取卡片磁条的信息。当我插入读卡器时，计算机将读卡器解释为键盘，将相应的按键发送到我所在的任何应用程序（终端、vim 等）的标准输入。我真正想做的是捕获专门来自该设备而不是键盘的输出。

我已经读取了设备的权限（对我来说，/dev/usb/hiddev0），当我尝试以下代码时

```
f = open('/dev/usb/hiddev0', 'r')
f.readline() 
```

在 Python 中刷卡，磁条中编码的信息（类似`%6091430968014=FIRST/LAST?`）看起来就像我刚刚输入的一样，并且对 readline 的调用没有返回。如何收听来自此特定设备的输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-26T17:47:19.187

如果您使用的是 Linux，请尝试 Python 模块 evdev。

```
from evdev import InputDevice, categorize, ecodes

# Initialize card reader
swiper = InputDevice("/dev/input/event0") # magswipe card reader

scancodes = {
    # Scancode: ASCIICode
    0: None, 1: u'ESC', 2: u'1', 3: u'2', 4: u'3', 5: u'4', 6: u'5', 7: u'6', 8: u'7', 9: u'8',
    10: u'9', 11: u'0', 12: u'-', 13: u'=', 14: u'BKSP', 15: u'TAB', 16: u'Q', 17: u'W', 18: u'E', 19: u'R',
    20: u'T', 21: u'Y', 22: u'U', 23: u'I', 24: u'O', 25: u'P', 26: u'[', 27: u']', 28: u'CRLF', 29: u'LCTRL',
    30: u'A', 31: u'S', 32: u'D', 33: u'F', 34: u'G', 35: u'H', 36: u'J', 37: u'K', 38: u'L', 39: u';',
    40: u'"', 41: u'`', 42: u'LSHFT', 43: u'\\', 44: u'Z', 45: u'X', 46: u'C', 47: u'V', 48: u'B', 49: u'N',
    50: u'M', 51: u',', 52: u'.', 53: u'/', 54: u'RSHFT', 57: u' ', 100: u'?'
}

def read_card(lcd_line_1, lcd_line_2):
    while True:
        # listen to card swiper
        for event in swiper.read_loop():
            if event.type == ecodes.EV_KEY:
                data = categorize(event)  # Save the event temporarily to introspect it
                if data.keystate == 1:  # Down events only
                    key_lookup = scancodes.get(data.scancode) or u'UNKNOWN:{}'.format(data.scancode)  # Lookup or return UNKNOWN:XX
                    print(key_lookup) 
```

# angularjs - AngularJS - 资源 - 请求必须在 $scope.$apply 内吗？

> ID：15994155
> 
> 赞同：2
> 
> 时间：2013-04-13T23:44:27.793
> 
> 标签：angularjs, angularjs-scope, angularjs-service

我在文档中找不到任何关于此的内容，但似乎任何请求都必须在`$apply()`调用中 - （无论此`$apply()`调用来自操作还是手动调用）。

我无法以任何其他方式解释这种奇怪的行为：

```
// inside a controller
$scope.resources = Resource.query(); 
// a request gets sent 
```

工作得很好，但是

```
// somewhere else - in a callback for auto-complete 
// just to show that this is outside $scope.$apply() - not realy setTimeout
setTimeout(function(){ 

  $scope.resources = Resource.query();

},100);
// no request gets sent;

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T00:23:12.727

我认为您正在查看此问题：[https](https://github.com/angular/angular.js/issues/2371) ://github.com/angular/angular.js/issues/2371 。您可能需要跟进。

# php - Why can't I get DNS results for bing?

> ID：15994171
> 
> 赞同：1
> 
> 时间：2013-04-13T23:47:14.663
> 
> 标签：php, dns, bing

I have been trying to get DNS results for bing.com using php:

```
<?php
$domain = 'bing.com';
$dns_results = dns_get_record($domain, DNS_ALL);
?> 
```

The problem is that I get a php warning: `Warning: dns_get_record() [function.dns-get-record]: Dns Query failed`

This code works fine with other domains. And `gethostbyname($domain)` works fine. So why is this failing? What's special about Bing's DNS? and is there a workaround beyond suppressing the error using `@dns_get_record`?

# javascript - Populate select box dynamically based on user prompts (jquery/javascript)

> ID：15994180
> 
> 赞同：0
> 
> 时间：2013-04-13T23:48:31.623
> 
> 标签：javascript, jquery, html, forms

If a user enters a value(s) (via javascript prompt), and that value is stored in a changing array, is there a way to automatically update a select box in an HTML form with the value(s) that the user enters? I ask because I am fairly new to jquery and front-end design, and I'm not certain if this can be done after a page is loaded.

I appreciate the help from the two people who responded, and I would upvote both of your answers as helpful, but I do not have enough reputation yet.

To clarify my question a bit better, what I would like to see happen is a select box automatically filled with values, based on user prompts.

For example, if I have

```
var r = true;
while(r == true){
var path = window.prompt("Please enter path here"); 
//I would like to put <option>path</option> inside a selection box
var r = confirm("Enter another path?");
} 
```

If this is not entirely possible, I understand, but that's why I asked the question in the first place.

EDIT:

Found a solution here [How to add option to select list in jQuery](https://stackoverflow.com/questions/1730360/how-to-add-option-to-select-list-in-jquery)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:38:52.307

所以，我有点无聊了一会儿；既然如此，我可以给你这个：

```
var startValues = ['apple', 'banana', 'cherry'];

function childElementType(node) {
    var props = {
        childType: '',
        textType: Node.textContent ? 'textContent' : 'innerText',
        hasValue: false
    };
    switch (node.tagName.toLowerCase()) {
        case 'select':
            props.childType = 'option';
            props.hasValue = true;
            break;
        case 'ol':
        case 'ul':
            props.childType = 'li';
            break;
    }
    return props;
}
Object.prototype.populate = function (values) {
    if (this.length) {
        return this;
    } else {
        var child = childElementType(this),
            newChild;
        for (var i = 0, len = values.length; i < len; i++) {
            newChild = document.createElement(child.childType);
            newChild[child.textType] = values[i];
            if (child.hasValue) {
                newChild.value = newChild[child.textType];
            }
            this.appendChild(newChild);
        }
    }
    return this;
};

Object.prototype.addTo = function (message) {
    var control = document.createElement('button'),
        that = this;
    control.appendChild(document.createTextNode(message || '+ add to ' + that.tagName.toLowerCase()));
    this.parentNode.insertBefore(control, this.nextSibling);
    var child = childElementType(this);

    function addNew() {
        var text = prompt('Add the new entry:'),
            newEntry;
        if (text) {
            newEntry = document.createElement(child.childType);
            newEntry[child.textType] = text;
            that.appendChild(newEntry);
        }
    }
    control.onclick = addNew;
    return this;
};

document.getElementById('select').populate(startValues).addTo();
document.getElementById('ul').populate(startValues).addTo(); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/YDgCK/1/)。

您还可以将默认消息传递给`addTo()`方法，为创建的按钮提供特定文本，并且由于每个方法都返回`this`对象/节点，因此您可以按任意顺序调用它们（显然，只要您*首先*选择元素)，例如*这*两种方法都是有效且可用的：

```
document.getElementById('select').addTo('Moar options..?').populate(startValues);
document.getElementById('ul').populate(startValues).addTo('Go on, add more!'); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/YDgCK/3/)。

参考：

*   [条件（'三元'）运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Conditional_Operator)。
*   [`document.createElement()`](https://developer.mozilla.org/en-US/docs/DOM/document.createElement).createTextNode
*   [`document.createTextNod()`](https://developer.mozilla.org/en-US/docs/DOM/document.createTextNode).
*   [`for (...) {}`循环](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for)。
*   [`Node.appendChild()`](https://developer.mozilla.org/en/docs/DOM/Node.appendChild).
*   [`Node.insertBefore()`](https://developer.mozilla.org/en-US/docs/DOM/Node.insertBefore).
*   [`Node.textContent`](https://developer.mozilla.org/en/docs/DOM/Node.textContent).
*   [`switch () {...}`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/switch).
*   [`window.prompt`](https://developer.mozilla.org/en-US/docs/DOM/window.prompt).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:57:18.113

像下面这样的东西应该可以工作。这种方式将覆盖现有选项，但可以将它们附加到现有选项。

```
$("#saveButton").on("click", function(){
    var options = '';

    for ( var item in optionsArray ){
        options += "<option>" + item +"</option>";
    }    

    $('#selectbox').html(options)
}); 
```

小提琴：http: [//jsfiddle.net/njgray/BM8KL/](http://jsfiddle.net/njgray/BM8KL/)

# c - 仅读取字母字符 - C

> ID：15994184
> 
> 赞同：5
> 
> 时间：2013-04-13T23:49:09.433
> 
> 标签：c, scanf

我正在打开一个文本文件，并且只想阅读字母单词。例如，如果我有一个带有“Hello-World Hey”的文本文件。我想读“Hello”、“World”、“Hey”这些词。

问题是我不确定这个输出的“格式说明符”应该是什么。我尝试了无数种组合，但都没有像希望的那样奏效。

```
FILE *fpin; 
char str[50];

while (fscanf(fpin, "%s[a-zA-Z]", str) != EOF) {
    // do something with str
} 
```

任何帮助将非常感激！谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-14T00:16:58.660

你快到了；应该使用扫描集，但扫描集也没有`s`转换。

```
while (fscanf(fpin, "%49[a-zA-Z]", str) == 1) { 
```

49 防止缓冲区溢出（是的，它必须比数组的维度小一）。

当然，这适用于第一个单词；然后，您需要跳过非单词字符才能阅读下一个单词，因此您可能有：

```
while (fscanf(fpin, "%49[a-zA-Z]", str) == 1)
{
    ...do something with word in str...
    if (fscanf(fpin, "%49[^a-zA-Z]", str) != 1)
        ...decide what to do...
        ...but remember one problem might be that the 'word' was too long...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T00:08:43.137

我对自己编程还很陌生，但也许这就是你要找的。希望能帮助到你。

```
#include <ctype.h>

int i = 0;
FILE *fpin; 
char c, str[50];

while ((c = fgetc(fpin)) != EOF)
{
    if(isalpha(c))
        str[i++] = c;

}
str[i] = '\0';
// do something with str 
```

# graphics - 如何在 Three.js / WebGL 中创建对象边界？

> ID：15994193
> 
> 赞同：1
> 
> 时间：2013-04-13T23:50:42.743
> 
> 标签：graphics, 3d, three.js, webgl

我是图形新手，想知道如何为我的游戏创建对象边界。

现在我有一个对象跟随我的鼠标。当我的船的 rotation.z 为 0 时，这适用于我的边界。但是，当我旋转船时，边界有奇怪的行为。

我尝试获取船的世界位置并简单地检查 x 和 y 边界。但是，当我旋转时，世界位置似乎给了我不同的 x 和 y。我怎样才能创建一个适用于我的船所有旋转的边界。

这是我的游戏（为了帮助而关闭了碰撞）：[http ://www.cis.gvsu.edu/~chaua/CS371/WebGLProject/home.html](http://www.cis.gvsu.edu/~chaua/CS371/WebGLProject/home.html)

当你不旋转船时，我想要的行为会发生。用鼠标左/右键旋转船。

相关代码片段（在渲染循环中）：

```
if(mouseLeftDown)
        ship.rotation.z += leanSpeed;
if(mouseRightDown)
        ship.rotation.z += -leanSpeed;
....
....

targetX = ((lastMouseX / window.innerWidth) * 2 - 1) * 90;
targetY = -((lastMouseY / window.innerHeight) * 2 - 1) * 60;

var worldPosition = (new THREE.Vector3()).getPositionFromMatrix(ship.matrixWorld);

if(worldPosition.x + targetX <= (randSpawnWidth/2)-500 && worldPosition.x + targetX >= -(randSpawnWidth/2)+500)
    ship.translateX(targetX);
if(worldPosition.y + targetY <= (randSpawnHeight/2)-500 && worldPosition.y + targetY >= -(randSpawnHeight/2)+500)
    ship.translateY(targetY); 
```

我将不胜感激任何帮助。谢谢！

# javascript - 如何将x，y坐标转换为角度？

> ID：15994194
> 
> 赞同：46
> 
> 时间：2013-04-13T23:50:46.067
> 
> 标签：javascript, css, svg, gradient, trigonometry

Microsoft 提供了一个出色的[SVG 渐变生成器](http://ie.microsoft.com/testdrive/graphics/svggradientbackgroundmaker/)，因此 IE9 也可以具有“CSS3”渐变（单击自定义）。

我目前在我的[Fireworks](http://mattstow.com/css-professionalzr.html)和[Dreamweaver](http://mattstow.com/easy-css3.html)扩展中使用他们的逻辑来将渐变转换为 SVG，但我只知道如何为标准的顶部、底部、左侧、右侧方向执行此操作。如果您输入角度，我不会进行转换，因为我不确定如何将 x1、x2、y1、y2 转换为 CSS3 角度。

梯度生成器提供如下值： x1="0%" y1="0%" x2="56.262833675564686%" y2="68.29999651227678%"

我不擅长数学或三角学，所以有人可以帮助我吗？如果可能的话，我还想在 Sass mixin 中使用相同的数学来做类似的事情。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-04-13T23:57:36.643

如果您从坐标中获取`deltaX`和，则返回其参数商的反正切。返回值以弧度为单位。`deltaY`[`Math.atan2`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/atan2)

```
var deltaX = x2 - x1;
var deltaY = y2 - y1;
var rad = Math.atan2(deltaY, deltaX); // In radians 
```

然后，您可以将其转换为度数，如下所示：

```
var deg = rad * (180 / Math.PI) 
```

![在此处输入图像描述](https://i.stack.imgur.com/iRVFa.png)

## 编辑

我最初的答案中有一些错误。我相信在更新的答案中，所有的错误都得到了解决。如果您认为这里有问题，请在此处发表评论。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-09-29T03:38:26.960

当前接受的答案不正确。首先，这`Math.tan`是完全错误的——我怀疑 Mohsen 的意思是`Math.atan`这只是一个错字。

但是，作为对该答案状态的其他响应，您应该真正使用`Math.atan2(y,x)`。常规反正切将仅返回 -pi/2 和 pi/2（象限 1 和 4）之间的值，因为输入不明确——反正切无法知道输入值是否属于象限 1 和 3，或者2对4。

`Math.atan2`另一方面，可以使用给定的 xy 值来确定您所在的象限，并为所有 4 个象限中的任何坐标返回适当的角度。然后，正如其他人所指出的，如果需要，您可以乘以`(180/Math.pi)`将弧度转换为度数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-27T20:03:13.697

而不是使用 Math.tan 函数您应该使用 Math.atan2：

这是一个使用示例：

```
deltaX = x2 - x1;
deltaY = y2 - y1;
deg = Math.atan2(deltaY, deltaX)*180.0/Math.PI; 
```

这将从 <-180;180> 返回一个度数。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-06-11T18:21:15.460

如果你在象限

P1=(X0,Y0)

P2=(X1,Y1)

a=(X0-X1)

b=(Y0-Y2)

```
deltaX=((a)**2)**0.5
deltaY=((b)**2)**0.5
rad=math.atan2(deltaY, deltaX)
deg = rad * (360 / math.pi)
print deg 
```

度数将在 0 ~ 180 之间

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-08-24T15:35:49.233

此函数接受 2 个元素并返回元素中间的度数。

例如，我在世界地图上使用它，使平面图像沿城市方向旋转。

```
function degFromTwoElements(el1,el2){
    var x1,x2,y1,y2,cx1,xy1,cx2,cy2,deltaX,deltaY,dx,dy,rad,deg,shortest,number;
    x1 = el1.position().left;
    y1 = el1.position().top;
    x2 = el2.position().left;
    y2 = el2.position().top;
    cx1 = x1 - (el1.width() / 2);
    cy1 = y1 - (el1.height() / 2);
    cx2 = x2 - (el2.width() / 2);
    cy2 = y2 - (el2.height() / 2);

    deltaX = cx2 - cx1;
    deltaY = cy2 - cy1;
    y1 = Math.sqrt((Math.abs(deltaY)*Math.abs(deltaY))+(Math.abs(deltaX)*(Math.abs(deltaX))));
    x1 = 0;
    dy = deltaY-y1;
    dx = deltaX-x1;
    rad = Math.atan2(dy, dx);
    deg = rad * (360 / Math.PI);

    shortest;
    number = Math.abs(deg);
    if ((360 - number ) < number){
        shortest = 360 - number;
        console.log('shorter degree: ' + shortest);
        return shortest;
    } 
    else console.log('Angle is: ' + deg);
    return deg;

} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2015-09-29T03:15:38.107

```
var x,x1,x2,y,y1,y2;
var cells = 'cell0';
		var h,w;
		var cx,cy;
		var dx,dy;
		var derajat;
		var deg;
		var ang;
		var light;
		var control;
			function mouse_watch(event){
				x = event.clientX;
				y = event.clientY;
				cell_data(cells);
				koordinat(x2,y2);
				busur(derajat);
			}
			function koordinat(x2,y2){
				x2 = x-cx;
				y2 = y-cy;
				yk = y2;
				xk = x2;
			}
			function busur(derajat){

				y1 = Math.sqrt((Math.abs(yk)*Math.abs(yk))+(Math.abs(xk)*(Math.abs(xk))));
				x1 = 0;
				dy = yk-y1;
				dx = xk-x1;
				rad = Math.atan2(dy, dx);
				derajat = rad * (360 / Math.PI);
				cell = document.getElementById(cells);
				ang = cell.getElementsByClassName('angle0')[0];
				ang.style.transform = 'rotate('+derajat+'deg)';
				light = ang.getElementsByClassName('points')[0];
				light.style.height = y1+'px';
			}
			function cell_data(cells){
				cell = document.getElementById(cells);
				h = Number(cell.style.height.replace('px',''));
				w = Number(cell.style.width.replace('px',''));
				cy = Number(cell.style.top.replace('px',''))+h/2;
				cx = Number(cell.style.left.replace('px',''))+w/2;
			}
```

```
 .preview_engine{
				position: absolute;
				top: 0;
				left: 0;
				padding: 10px;
				background-color: #2E8AE6;
				color: white;
			}
			body{
				cursor: default;
				width: 100%;
				height: 100%;
				font-family: Arial;
				font-size: 12px;
			}
			.fieldwork{
				width: 100%;
				height: 100%;
				position: absolute;
				top: 0px;
				left: 0px;
			}
			.cell{
				position: relative;
				transition : width 2s, height 2s, top 2s, left 2s;
				background-color: red;
			}
			.angle0{
				width: 200px;
				height: 200px;
				position: absolute;
				top: -75px;
				left: -75px;
				background-color: green;
				border-radius: 50%;
				opacity: 0.5;
				transition : width 2s, height 2s, top 2s, left 2s;
			}
			.points{
				width: 10px;
				height: 10px;
				position: absolute;
				left: 95px;
				top: 95px;
				background-color: red;
				border-radius: 1em;
				opacity: none;
			}
```

```
<div class="fieldwork" onmousemove="mouse_watch(event)">
<div class='cell' id="cell0" style="width:50px;height:50px;top:200px;left:400px;">
<div class="angle0">
<div class="points"></div>
</div>
</div>
</div>
```

# r - 将簇分配给R中的对象

> ID：15994197
> 
> 赞同：2
> 
> 时间：2013-04-13T23:51:20.263
> 
> 标签：r, object, hclust

将集群分配给 R 中的组的最简单方法是什么？使用的功能是：

> hclust 和 cutree。

基本上，我想将在 cutree 下创建的集群之一分配给一个对象。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:59:34.760

`cutree`给你一个集群索引的向量

```
hc <- hclust(dist(USArrests))
clusters.idx <- cutree(hc, k = 5) # create five clusters

head(clusters.idx)
#    Alabama     Alaska    Arizona   Arkansas California   Colorado 
#          1          1          1          2          1          2 
```

您可以将其用于`split`原始数据：

```
clusters <- split(USArrests, clusters.idx) 
```

这里`clusters`是 data.frames 的列表。例如，您可以使用 访问第一个集群`clusters[[1]]`。

# jquery - Jquery 用户对话框按钮

> ID：15994199
> 
> 赞同：0
> 
> 时间：2013-04-13T23:51:58.640
> 
> 标签：jquery, html

我有这个 Jquery 用户对话框：

```
 <!-- jQuery UI dialogs -->
    <div class="widget">    
        <div class="head"><h5 class="iAlert">jQuery UI dialogs</h5></div>
        <div class="body aligncenter">

            <div class="uDialog">
                <div id="dialog-message" title="Download complete">
                    <p><img src="images/icons/color/tick.png" alt="" class="icon" />Your files have downloaded successfully into the My Downloads folder.</p>
                    <p>Currently using <strong>36% of your storage space</strong></p>

                    <div class="uiForm">
                        <form action=""  class="mainForm">
                            <input type="text" value="http://" name="inputtext"/>
                            <input type="radio" name="question1" checked="checked" /><label>Selected radio</label>
                            <input type="radio" name="question1" /><label>Normal state</label>
                        </form>
                    </div>
                </div>
                <!-- Sample page content to illustrate the layering of the dialog -->
                <input type="button" value="Usual jQuery UI dialog" class="blueBtn" id="opener" />
            </div>

        </div>
    </div> 
```

我想将输入从按钮更改为图像，如下所示：

```
<a href="#" title=""class="btn55 mr10"><img src="images/add.png" alt="" /><span>Add</span></a> 
```

有一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:59:59.250

你能创造一个小提琴，所以我可以更精确吗？
这是一个链接[jsfiddle.net/trajce/yhQeZ/](http://jsfiddle.net/trajce/yhQeZ/)
对于输入，您可以这样做：

```
/* this is general selector, if you want to target specific element, then add class or id*/
    input[type="button"]
    {
        width:120px;/*these are just some sample width and height*/
        height:30px;
        background: url('http://www.google.com/images/srpr/logo4w.png') center no-repeat;/*set your image as background of the input.*/
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:52:47.840

[小提琴](http://jsfiddle.net/FnDht/)中的示例

使用输入的类

```
.blueBtn {
    background-image: url('http://www.psdgraphics.com/wp-content/uploads/2009/07/push-button.jpg');
    background-size: 100%;
    background-repeat: no-repeat;
    background-position: center;
    height: 40px;
    width: 50px;
} 
```

或与后台规则相结合

```
.blueBtn {
    background: url('http://www.psdgraphics.com/wp-content/uploads/2009/07/push-button.jpg')no-repeat center;
    background-size: 100% 100% ;
    height: 40px;
    width: 50px;
} 
```

# java - 以特定格式打印二维数组的 ArrayList

> ID：15994203
> 
> 赞同：0
> 
> 时间：2013-04-13T23:52:51.830
> 
> 标签：java

我正在尝试将 ArrayList 以特定格式保存到文本文件中。它的格式正确，但它只打印出块 ArrayList 中一个元素的颜色。我知道问题出在 getBlockColor() 方法上，实现此方法的最佳方法是什么？这是我到目前为止所得到的。

这是具有 ArrayList 帧的类中的方法。

```
public void saveFrames(String fileName) {
    System.out.println("**method save writes data back to a file "
            + fileName);
    try {
        PrintWriter outfile = new PrintWriter(new OutputStreamWriter(
                new FileOutputStream(fileName)));
        outfile.println(frames.size());
        outfile.println(Frame.getCOLUMNS());
        for (Frame f : frames) {
            for (int i = 0; i < 20; i++) {
                for (int j = 0; j < 20; j++) {
                    Color a = f.getBlockColor();
                    if (a.equals(Color.white)) {
                        outfile.print("w");
                    }
                    if (a.equals(Color.orange)) {
                        outfile.print("o");
                    }
                    if (a.equals(Color.red)) {
                        outfile.print("r");
                    }
                    if (a.equals(Color.yellow)) {
                        outfile.print("y");
                    }
                    if (a.equals(Color.green)) {
                        outfile.print("g");
                    }
                    if (a.equals(Color.blue)) {
                        outfile.print("b");
                    }

                }
                outfile.println("");
            }
        }
        outfile.close();
    }

    catch (IOException e) {
        System.out.println("file not found try again");
    }
} 
```

这是应该获取块颜色的框架中的代码。

```
public Color getBlockColor() {
    for (int ROWS = 0; ROWS < 20; ROWS++) {
        for (int COLUMNS = 0; COLUMNS < 20; COLUMNS++) {
            blockColor = blocks[ROWS][COLUMNS].getBackground();
        }
    }
    return blockColor;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:03:29.533

我认为您在获取块颜色时犯了一个小错误。我猜你应该返回特定行和列的颜色，如下所示：

```
public Color getBlockColor(int row, int column) {
    return blocks[row][column].getBackground();
} 
```

# c++ - 在 C++ 中打印或遍历链表

> ID：15994205
> 
> 赞同：0
> 
> 时间：2013-04-13T23:52:57.770
> 
> 标签：c++, pointers, linked-list, graph-theory, traversal

我想打印出我刚刚制作的链表。我已经弄清楚如何打印出第一个和最后一个元素，但想不出打印整个列表的方法。

我需要从第一个元素移动到下一个元素，并且需要在最后停止的条件。

但我不对此实现迭代器。仅使用指针和节点可以打印整个列表吗？

```
int main ()
{ LinkedList name_list;
  name_list.TraPrinhead(name_list); }

void LinkedList::TraPrinHead(const LinkedList& p)
{ 
  cout << "The First Element of this List is : ";
  cout << header->next->elem; // print out the first element
  cout << endl;

  cout << "The Last Element of this List is : ";
  cout << tail->prev->elem; // print out the first element
  cout << endl;

  cout << "Now the whole list.......";
  cout << ??????????????????????
}

  class LinkedList {

  public: class Nodes { // Doubly Linked List Node
  public:
    Nodes(const string& e);
    void ToNodeValue(const string& e);
    string getElemValue() const;
    void printNodeValue();
  private:
     string elem;  // node element value
     Nodes* prev; // previous node in list
     Nodes* next; // next node in list
     // pointer that points to current node is this pointer

  public:
    void ConnectSingly(Nodes* a, Nodes* b); 
    void ConnectDoubly(Nodes* a, Nodes* b);

  friend class LinkedList; 
  };

  public:
    LinkedList(); 
    virtual ~LinkedList(); 
    bool empty() const; 
    const string& getFirst() const; 
    const string& getLast() const; 
    void addtoFront(const string& e); 
    void addtoBack(const string& e); 
    void TraPrinHead(const LinkedList& p); 
  private: 
     Nodes* header; 
     Nodes* tail;

  protected: 
    void InsertDoublyBefore(Nodes* d, const string& e); 
    void InsertDoublyAfter(Nodes* d, const string& e);

  friend class Nodes;
  };

       void LinkedList::InsertDoublyBefore(Nodes* d, const string& e) {

       if (header->next == tail)
         { // header->next->elem = e;
           Nodes* n = new Nodes;
        n->elem = e; 
            n->next = tail;
        n->prev = tail->prev;
            tail->prev->next = tail->prev = n; 
        header->next = n; 
       }
       else
       {
        Nodes* n = new Nodes; 
        n->elem = e;
        n->next = d;
        n->prev = d->prev;
        d->prev->next = d->prev = n; 
       }

       } 

       void LinkedList::InsertDoublyAfter(Nodes* d, const string& e) 
       {
          InsertDoublyBefore(d->next, e);
       }

       void LinkedList::addtoFront(const string& e)  { InsertDoublyBefore(header->next, e); }

       void LinkedList::addtoBack(const string& e) { InsertDoublyBefore(tail, e); }

       void LinkedList::Nodes::ConnectSingly(Nodes* a, Nodes* b)
       {
        a->next = b; // a's next pointer points to b
       }

       void LinkedList::Nodes::ConnectDoubly(Nodes* a, Nodes* b)
       {
        a->next = b; // a's next pointer points to b
        b->prev = a; // b's prev pointer points to a
       } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:02:26.597

```
Node* p = myList.head;
while(p) {
  std::cout << p->elem << " ";;
  p = p->next;
} 
```

正如你所期望的那样，继续到下一个元素直到它为 NULL（到达结束） NULL 被编译器更改为 0，并且 0==false

你应该试着看看你的讲义，因为我已经为你回答了一个关于这门课的问题。

另外，我相信通常 tail 指向最后一个元素，而不是过去的一个元素。所以打印最后一个元素应该是

```
cout << tail->elem; // print out the first element 
```

**除非你的导师另有定义。**

很明显，您将需要为这些变量中的大多数创建“getter”函数，因为它们被声明为私有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:07:02.973

链表的全部意义在于您可以使用一个元素访问下一个元素。因此，您只需要使用指针遍历列表。

```
Nodes* currentNodes = header->next; //pointer used to iterate through list; initially points at first element of list

while(currentNodes != tail) { //condition to stop
  cout << currentNodes->elem << endl; 
  currentNodes = currentNodes->next;
} 
```

# cygwin - cygpath 不能正确转换 Windows 路径

> ID：15994207
> 
> 赞同：2
> 
> 时间：2013-04-13T23:53:11.550
> 
> 标签：cygwin, cygpath

**命令行外壳**

```
echo %PIG_HOME%
C:\cygwin\usr\lib\pig 
```

**赛格温**

```
echo $PIG_HOME
C:\cygwin\usr\lib\pig

echo $( cygpath -u "$PIG_HOME" )
/usr/lib/pig

cd $( cygpath -u "$PIG_HOME" )
-bash: cd: /usr/lib/pig: No such file or directory 
```

**问题：**为什么`cygpath`不将其转换为`/cygdrive/c/cygwin/usr/lib/pig`？

**更新：**

文件夹的路径`pig`是正确的。

**命令行外壳**

```
C:\Users\john.doe> cd %PIG_HOME%
C:\cygwin\usr\lib\pig> 
```

**赛格温**

```
john.doe@COMPUTER ~
$ cd /cygdrive/c/cygwin/usr/lib/pig/

john.doe@COMPUTER /cygdrive/c/cygwin/usr/lib/pig
$ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:16:40.177

与 Cygwin 一起，

```
C:\cygwin\lib\pig = /usr/lib/pig 
```

和

```
C:\cygwin\usr\lib\pig = /cygdrive/c/cygwin/usr/lib/pig 
```

此设置是设计使然。

该`C:\cygwin\usr\lib`文件夹不是由任何包创建的，也不应该由您创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:15:01.633

`mount`在您的终端窗口中输入。

我的`c:\cygwin\bin`和`c:\cygwin\lib\`分别安装在`/usr/bin`和`/usr/lib`。我怀疑你`c:\cygwin\usr\lib`的安装在`/usr/lib`.

因此，“unix”路径`c:\cygwin\usr\lib\pig`将是`/usr/lib/pig`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-18T08:37:56.187

您是否尝试过选项“-m，--mixed : 像--windows，但使用常规斜杠 (C:/WINNT)”

```
$ cd /cygdrive/c/cygwin64/home
$  cygpath -m $(pwd)
C:/cygwin64/home 
```

# android - bindService() 给出 NullPointerException 和 onServiceConnected() 从未调用过

> ID：15994208
> 
> 赞同：0
> 
> 时间：2013-04-13T23:53:18.207
> 
> 标签：android, service, android-service-binding

首先让我说我已经搜索了很长时间，发现了很多类似的问题（关于 SO），但我还找不到任何解决这个问题的方法：

我有一个`Service`通过调用 startservice() 启动的 (jobcrawler)。在这个服务中，我启动了一个长时间运行的线程，它在某个时候调用了一个类（webservice），它的 init 看起来像这样：

```
public webservice(Context context) {
    this.context = context;
    this.db = new DatabaseHandler(this.context);
    this.access_token = db.getAuthKey();
} 
```

在一些网络调用之后，类(webservice) 在一个名为recieveData() 的方法中接收数据。在 recieveData 我试图绑定到服务如下：

```
 if (!isBound) {
            // not bound yet, then bind to the service.
            Intent intent = new Intent(this, jobcrawler.class);
            bindService(intent, myConnection, Context.BIND_AUTO_CREATE);
        } 
```

现在，我在调用 bindservice 的那一行得到了 nullpointerexemption。请注意，我实际上还没有尝试对服务做任何事情。我只是想绑定它。任何帮助将不胜感激......如果我有头发，我会把它拔出来！哈哈

这是我认为相关的一些附加代码。我的连接：

```
private ServiceConnection myConnection = new ServiceConnection() {
    public void onServiceConnected(ComponentName className,IBinder service) {
        Log.e("webservice", "service is connected");
        MyLocalBinder binder = (MyLocalBinder) service;
        myService = binder.getService();
        isBound = true;
    }

    public void onServiceDisconnected(ComponentName arg0) {
        Log.e("webservice", "service is disconnected");
        isBound = false;
    } 
```

};

来自名为 MyLocalBinder 的服务的活页夹：

```
public class MyLocalBinder extends Binder {
    public jobcrawler getService() {   
            Log.e("Job Crawler", "returning self");
        return jobcrawler.this;
    }
} 
```

服务的onbind方法：

```
private final IBinder myBinder = new MyLocalBinder();

@Override
public IBinder onBind(Intent arg0) {
  Log.d("JobCrawler Service", "Service is bound");
    return myBinder;
} 
```

哦，这是我从服务内的线程加载类的地方，以防万一我应该使用不同的上下文或其他东西：

```
 private webservice ws= new webservice(getBaseContext()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-22T15:06:35.710

我知道这有点晚了，但我遇到了同样的问题，也许一些谷歌人会很高兴:)

所以对我来说，以下工作：参考您的上下文调用 bindService 方法：

```
context.bindService(intent, serviceConnection, Context.BIND_AUTO_CREATE) 
```

# caching - 使用 HDFS 在 RAM 中缓存

> ID：15994211
> 
> 赞同：5
> 
> 时间：2013-04-13T23:53:46.260
> 
> 标签：caching, hadoop, hdfs

我需要用一个小集群（~10 个服务器）处理一些大文件（~2 TB），以便生成一个相对较小的报告（一些 GB）。

我只关心最终报告，而不是中间结果，而且机器有大量 RAM，所以用它来尽可能减少磁盘访问（并因此提高速度）会很棒，最好是通过存储数据块在易失性内存中仅在使用磁盘时。

查看配置文件和[之前的问题](https://stackoverflow.com/questions/15047756/hadoop-data-block-caching-techniques)，Hadoop 似乎不提供此功能。Spark 网站[讨论了 memory_and_disk](http://spark-project.org/faq/)选项，但我更愿意要求该公司部署基于新语言的新软件。

我发现的唯一“解决方案”是在 hdfs-default.xml 中设置 `dfs.datanode.data.dir`，`/dev/shm/`以欺骗它使用易失性内存而不是文件系统来存储数据，但在这种情况下，我认为当 RAM 变满时它的行为仍然很糟糕它使用交换。

有没有一个技巧可以让 Hadoop 尽可能多地将数据块存储在 RAM 上并仅在必要时才在磁盘上写入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-01T14:41:49.177

自 Hadoop 2.3 发布以来，您可以[在内存缓存中使用 HDFS](http://hadoop.apache.org/docs/r2.3.0/hadoop-project-dist/hadoop-hdfs/CentralizedCacheManagement.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T07:27:54.820

You can toy around with `mapred.job.reduce.input.buffer.percent` (defaults to `0`, try something closer to `1.0`, see for example this [blog post](http://gbif.blogspot.ie/2011/01/setting-up-hadoop-cluster-part-1-manual.html)) and also setting the value of `mapred.inmem.merge.threshold` to `0`. Note that finding the right values is a bit of an art and requires some experimentation.

# php - 数据库键码表

> ID：15994214
> 
> 赞同：0
> 
> 时间：2013-04-13T23:54:16.040
> 
> 标签：php, database, html-table, key

我创建了一个表，用于将“密钥”输入数据库以及从数据库中删除它们的选项它完美地显示了该表，但问题是我无法让它将密钥输入数据库，即使细节已挂钩。

```
 <?php
    define(DBUSER,"N/A");
    define(DBPWD, "N/A");
    define(DBNAME, "N/A");
    define(DBHOST, "N/A");
   $dbConn = dbconnect();

    $txt = "<table align=\"center\">";
    $txt .= "<tr><td>KeyCode</td><td>Date</td><td>Sold</td><td>Email</td></tr>";
    $sql = "SELECT * FROM `benkeys` where keycode = 1";

$res = mysql_query($sql, $dbConn)
or die(mysql_error());
if($res && mysql_num_rows($res)) {
}
  $row=mysql_fetch_assoc($res);
mysql_close($dbConn);
        $cal = "js_del_key('".$row["keycode"]."'); return false;";
        $txt .= "<tr><td>".$row['keycode']."</td><td>".$row['datum']."</td>";
        $txt .= "<td>".$row['sold']."</td><td>".$row['email']."</td>";
        $txt .= "<td><input type=\"button\" name=\"del\" value=\"DELETE\" onclick=\"".$cal."\"></td></tr>";

    $cal = "js_add_key(); return false;";
    $txt .= "<tr><td><input type=\"text\" size=\"46\" id=\"nkey\" /></td><td>".date("Y-m-d")."</td>";
    $txt .= "<td>N</td><td>&nbsp;</td>";
    $txt .= "<td><input type=\"button\" name=\"addkey\" value=\"ADD NEW\" onclick=\"".$cal."\"></td></tr>";
    $txt .= "</table>";
    echo $txt;
    function closeConn(){
    mysql_close();
}
    return($txt);

function p_adm_del_key($key)
{
    $link = dbconnect();
    $sql = "delete from `benkeys` where `keycode`='".$key."' limit 1";
    mysql_query($sql);
    mysql_close($link);
    return(p_adm_list_keys());
}
function p_adm_add_key($key)
{
    $link = dbconnect();
    $sql = "insert into `benkeys` (`keycode`,`datum`,`sold`) values ('".$key."','".date("Y-m-d")."','N')";
    $returnValue = mysql_query($sql, $link);
    mysql_close($link);
    return $returnValue; //This will return true/false if the query succeeded or not
}
if (p_adm_add_key('some-key')) {
    //Success!
} else {
    //Failure. ;(
}

function dbconnect()   
{
    $link = mysql_connect(DBHOST, DBUSER, DBPWD) or die ("Error: ".mysql_error());
    mysql_select_db(DBNAME) or die("Could not select database: ".mysql_error());
    return($link);
}
    <? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:10:31.800

您的`dbconnect()`函数引用了一些常量（DBHOST、DBUSER、DBPWD、DBNAME），但我看不到它们在任何地方定义。要么定义它们，要么将它们作为参数传递给函数。

## 数据库连接

只需从这里更改脚本的顶部：

```
$username="N/A";
$password="N/A";
$database="N/A";
$host="N/A";
$dbConn = mysql_connect($host, $username, $password, $database)
    or die("Could not connect: " + mysql_error());
mysql_select_db($database, $dbConn)
    or die("Could not find database: " + mysql_error()); 
```

...对此：

```
define(DBUSER,"N/A");
define(DBPWD, "N/A");
define(DBNAME, "N/A");
define(DBHOST, "N/A");
$dbConn = dbconnect(); 
```

## 添加按键功能

```
function p_adm_add_key($key)
{
    $link = dbconnect();
    $sql = "insert into `benkeys` (`keycode`,`datum`,`sold`) values ('".$key."','".date("Y-m-d")."','N')";
    $returnValue = mysql_query($sql, $link);
    mysql_close($link);
    return $returnValue; //This will return true/false if the query succeeded or not
} 
```

然后你可以像这样调用 add key 函数：

```
if (p_adm_add_key('some-key')) {
    //Success!
} else {
    //Failure. ;(
} 
```

# ios - -[UITableView _configureCellForDisplay:forIndexPath:] 中的断言失败

> ID：15994216
> 
> 赞同：10
> 
> 时间：2013-04-13T23:55:04.100
> 
> 标签：ios, xcode, uitableview

谁能告诉我为什么会出现这个错误？

这是我的 .m 文件：

```
#import "ListaParticipantesViewController.h"
#import "Participantes.h"
#import "ModParticipantesViewController.h"

@implementation ListaParticipantesViewController

@synthesize dao;
@synthesize participantes;

- (void)viewDidLoad
{
    dao = [[ParticipantesDAO alloc] init];
    participantes = [[NSMutableArray alloc] init];
    participantes = [dao getDatos];
    [super viewDidLoad];

}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [participantes count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"celda";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    cell.textLabel.text = [[participantes objectAtIndex:[indexPath row]] valueForKey:@"nombre"];

    return cell;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    ModParticipantesViewController *destino = [self.storyboard instantiateViewControllerWithIdentifier:@"visualizacion"];
    Participantes *tmp = [participantes objectAtIndex:[indexPath row]];
    destino.participante = tmp;

    [self.navigationController pushViewController:destino animated:YES];
}

@end 
```

显示的错误是：

```
2013-04-13 17:40:20.235 Registro[5314:c07] *** Assertion failure in -[UITableView _configureCellForDisplay:forIndexPath:], /SourceCache/UIKit_Sim/UIKit-2380.17/UITableView.m:5471
2013-04-13 17:40:20.237 Registro[5314:c07] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'UITableView dataSource must return a cell from tableView:cellForRowAtIndexPath:'
*** First throw call stack:
(0x209d012 0x11aae7e 0x209ce78 0xc40665 0x1a4c1b 0x13940c 0x1a4a7b 0x1a9919 0x1a99cf 0x1921bb 0x1a2b4b 0x13f2dd 0x11be6b0 0x2699fc0 0x268e33c 0x2699eaf 0x1de2bd 0x126b56 0x12566f 0x125589 0x1247e4 0x12461e 0x1253d9 0x1282d2 0x1d299c 0x11f574 0x11f76f 0x11f905 0x128917 0xec96c 0xed94b 0xfecb5 0xffbeb 0xf1698 0x1ff8df9 0x1ff8ad0 0x2012bf5 0x2012962 0x2043bb6 0x2042f44 0x2042e1b 0xed17a 0xeeffc 0x306d 0x1ef5)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-14T00:06:49.123

故事板或 XIB 没有使用您指定的单元标识符定义的单元。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-13T10:00:58.600

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

  return cell; // at the end of your method 
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-01-17T07:20:17.353

您需要在标题中设置 tableview 的委托和数据源。

目标c

```
<UITableViewDataSource, UITableViewDelegate> 
```

迅速

```
class HomeViewController: UIViewController, UITableViewDataSource, UITableViewDelegate { 
```

}

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-17T20:30:19.917

您是否使用 UITableViewDelegate、UITableViewDataSource 类对 ListaParticipantesViewController 进行了子类化？他们需要能够使用委托和数据源方法。

在斯威夫特：

```
class ListaParticipantesViewController: UIViewController, UITableViewDelegate, UITableViewDataSource {
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-12-16T11:48:47.153

我得到了同样的错误。事实证明这是同样的问题，它找不到我的单元格标识符，但出于不同的原因 - 我是 UITableViewCell 的子类，但没有使用我的 UITableView 注册我的 .XIB 文件以获得重用标识符。

我通过在 viewDidLoad 中重新设置来解决它

```
- (void)viewDidLoad {
  [super viewDidLoad];

  //LOAD XIB
  UINib *nib = [UINib nibWithNibName:@"NAME_OF_NIB_FILE"
                              bundle:nil];

  //REGISTER XIB, CONTAINING THE CELL (IDENTIFIER NAME USUALLY SAME AS NIB NAME)
  [[self tableView] registerNib:nib
         forCellReuseIdentifier:@"IDENTIFIER_NAME"]; 
} 
```

然后创建单元格

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

  //GET THE RECYCLED CELL
  TableCellSubclass *cell = [tableView dequeueReusableCellWithIdentifier:@"IDENTIFIER_NAME"];

  //CONFIGURE THE CELL

  return cell;
} 
```

希望这对某人有帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-26T14:35:00.270

就我而言，我有一个简单的错误..

我的行数由array.count 定义。

当我刷新这个数组时，我正在删除所有对象，启动连接，将对象添加到数组中，然后重新加载 tableview。

连接完成后，我将对象删除，它解决了我的问题。

# php - 获取具有所需属性的产品

> ID：15994218
> 
> 赞同：0
> 
> 时间：2013-04-13T23:55:25.777
> 
> 标签：php, mysql, kohana, entity-attribute-value

我有一个包含产品的类别和一组属性。这些属性是“形状”和“直径”。

当我打开一个类别而不应用过滤器时，我会得到带有以下查询的产品：

```
"SELECT * FROM `products` 
WHERE `category_id` 
IN ('6', '7', '29', '8', '9', '36')" 
```

然后我点击属性“直径”（id = 2），值为“8mm”（id = 4）我生成以下查询：

```
"SELECT * FROM `products`
JOIN `products_attributes_values`
ON (`products_attributes_values`.`product_id` = `products`.`id`)
WHERE `category_id` IN ('6', '7', '29', '8', '9', '36')
AND `products_attributes_values`.`attribute_id` = 2
AND `products_attributes_values`.`value_id` = ('4')" 
```

我得到了我需要的所有珠子“直径 8 毫米”然后我想更多地过滤我的产品并单击属性“形状”（id = 3），值为“圆形”（id = 11）我什么也没得到，查询看起来像：

```
"SELECT * FROM `products` 
JOIN `products_attributes_values`
ON (`products_attributes_values`.`product_id` = `products`.`id`)
WHERE `category_id` IN ('6', '7', '29', '8', '9', '36')
AND `products_attributes_values`.`attribute_id` = 2
AND `products_attributes_values`.`value_id` = ('4')
AND `products_attributes_values`.`attribute_id` = 3
AND `products_attributes_values`.`value_id` = ('11')" 
```

所以我想要得到直径为 8 毫米和圆形的珠子，而不是什么都没有。单独所有过滤器都可以正常工作。当我想像上面的例子一样混合它们时，它只是不起作用。我需要如何修改查询以完成工作？

谢谢。

**更新：**

我想将一个属性上的多个值与另一个或多个属性结合起来。

例如，我想获得直径（id=2）为 8mm（id=4）或直径（id=2）10mm（id=5）和形状（id=3）为圆形（id=11）或形状的珠子(id=3) 刻面(id=62)

所以最后我想得到圆形或多面形状的 8 毫米或 10 毫米珠子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:03:31.687

这 2 个过滤器需要单独处理，因为每个过滤器需要查看`products_attributes_values`表中完全不同的记录。

```
SELECT * FROM products
WHERE category_id IN ('6', '7', '29', '8', '9', '36')
    AND id IN (
        SELECT product_id
        FROM products_attributes_values
        WHERE attribute_id = 2
            AND value_id = '4')
    AND id IN (
        SELECT product_id
        FROM products_attributes_values
        WHERE attribute_id = 3
            AND value_id = '11') 
```

来自 UAMoto：

它工作但有点慢，所以我使用了一个人告诉我的连接别名：

```
"SELECT * FROM `products`
JOIN `products_attributes_values` AS pav1
ON (`pav1`.`product_id` = `products`.`id`)
JOIN `products_attributes_values` AS pav2
ON (`pav2`.`product_id` = `products`.`id`)
WHERE `category_id` IN ('6', '7', '29', '8', '9', '36')
AND (`pav1`.`attribute_id` = '2' AND `pav1`.`value_id` = '4')
AND (`pav2`.`attribute_id` = '3' AND `pav2`.`value_id` = '11')" 
```

## 更新了属性组合的查询：

```
SELECT * FROM products
WHERE category_id IN ('6', '7', '29', '8', '9', '36')
    AND id IN (
        SELECT product_id
        FROM products_attributes_values
        WHERE attribute_id = 2
            AND value_id IN ('4', '5'))
    AND id IN (
        SELECT product_id
        FROM products_attributes_values
        WHERE attribute_id = 3
            AND value_id IN ('11', '62')) 
```

或者

```
SELECT *
FROM `products`
    JOIN `products_attributes_values` AS pav1 ON (`pav1`.`product_id` = `products`.`id`)
    JOIN `products_attributes_values` AS pav2 ON (`pav2`.`product_id` = `products`.`id`)
WHERE `category_id` IN ('6', '7', '29', '8', '9', '36')
AND (`pav1`.`attribute_id` = '2' AND `pav1`.`value_id` IN ('4', '5'))
AND (`pav2`.`attribute_id` = '3' AND `pav2`.`value_id` IN ('11', '62')) 
```

# php - MySQL 有时会出现无效的查询语法

> ID：15994221
> 
> 赞同：1
> 
> 时间：2013-04-13T23:55:53.480
> 
> 标签：php, mysql, encryption, mysqli

试图加密社会安全号码，查询偶尔会工作，但每 5 到 10 次就会抛出一个

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '�9~���d�~/C�yK�~�� _', ' 50', '62' )' at line 1
SSN: _mosPEdaXEsB7zJCQe5aymaCmkcSl9bnPL5ClLXcz2QA=_ 
IV: _ �6�k���_O�'�9~���d�~/C�yK�~�� _ 
```

这是代码

```
 //Encryption/Decryption key
     $Key = hash("SHA256", $Lname, true);
    //Encryption Algorithm
    $cipher_alg = MCRYPT_RIJNDAEL_256;

    $iv =  mcrypt_create_iv(mcrypt_get_iv_size($cipher_alg, MCRYPT_MODE_ECB), MCRYPT_RAND);

    $ESSN = mcrypt_encrypt($cipher_alg, $Key, $SSN, MCRYPT_MODE_CBC, $iv);
    $ESSN = '_' . base64_encode($ESSN) . '_';
     $iv = '_' . $iv . '_';

if(!mysqli_query($connection, "CALL Update_ClientSSN('$ESSN','$iv', ' $AppID',  '" . $_SESSION['ID'] . "' );")){
        $Save .= " Error saving Client SSN";
    echo $connection->error;
    echo $ESSN . ' IV: ' . $iv;
    } 
```

同样最初我只是将IV和密文连接起来然后爆炸，但这仍然会引发错误，所以下划线只是我在试验。我很难过

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:03:30.127

您应该尝试像使用 $ESSN 一样对 $iv 变量进行base64_encode，或者至少在将其存储到数据库之前将其转换为十六进制格式，看看是否有帮助。原因是 $iv 可能包含非法字符，例如 '（单引号）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:03:43.733

您的问题是，生成的值`$iv`包含一个单引号（中间某处：O�'�9），这会导致插入语句无效。使用准备好的语句（PDO 或[Prepared statements](http://php.net/manual/en/mysqli.prepare.php)）或编码`$iv`应该可以解决您的问题

# matlab - 在 Matlab 中使用 svmtrain 内存不足

> ID：15994222
> 
> 赞同：3
> 
> 时间：2013-04-13T23:56:29.157
> 
> 标签：matlab, machine-learning, out-of-memory, svm, convergence

我有一组数据，我正在尝试使用 SVM 学习。对于上下文，数据的维度为 35，包含大约 30'000 个数据点。

我之前用这个数据集在 Matlab 中训练过决策树，大约需要 20 秒。对错误率并不完全满意，我决定尝试 SVM。

我第一次尝试`svmtrain(X,Y)`。大约 5 秒后，我收到以下消息：

> ？？？在 453 处使用 ==> svmtrain 时出错 计算内核函数时出错：内存不足。键入 HELP MEMORY 作为您的选项。

当我查找此错误时，有人建议我使用*SMO*方法：`svmtrain(X, Y, 'method', 'SMO');`. 大约一分钟后，我得到了这个：

> ？？？在 236 处使用 ==> seqminopt>seqminoptImpl 时出错 在主循环通过的最大次数 (15000) 内未实现收敛
> 
> ==> seqminopt 中的错误为 100 [alphas offset] = seqminoptImpl(data, targetLabels, ...
> 
> ==> svmtrain 在 437 [alpha 偏差] = seqminopt(training, groupIndex, ...

我尝试使用其他方法（LS 和 QP），但我再次得到第一个行为：然后延迟 5 秒

> ？？？在 453 处使用 ==> svmtrain 时出错 计算内核函数时出错：内存不足。键入 HELP MEMORY 作为您的选项。

我开始认为我做错了什么，因为决策树使用起来非常轻松，在这里我陷入了看似非常简单的操作。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T00:18:14.000

您是否阅读[了](http://www.mathworks.com/help/stats/svmtrain.html#btm3iae-3)关于算法内存使用情况的评论？

尝试将方法设置为`SMO`并使用`kernelcachelimit`适合您机器上可用内存的值。

在学习过程中，算法将构建一个大小为 的双矩阵`kernelcachelimit-by-kernelcachelimit`。默认值为 5000

否则，对您的实例进行二次抽样并使用交叉验证等技术来衡量分类器的性能。

以下是相关部分：

> ### 内存使用和内存不足错误
> 
> 当您将“方法”设置为“QP”时，svmtrain 函数对包含 N 个元素的数据集进行操作，并创建一个 (N+1)×(N+1) 矩阵来查找分离超平面。该矩阵至少需要 8*(n+1)^2 字节的连续内存。如果此大小的连续内存不可用，软件会显示“内存不足”错误消息。
> 
> 当您将“方法”设置为“SMO”（默认）时，内存消耗由 kernelcachelimit 选项控制。SMO 算法仅存储内核矩阵的子矩阵，受 kernelcachelimit 选项指定的大小限制。但是，如果数据点的数量超过 kernelcachelimit 选项指定的大小，SMO 算法会变慢，因为它必须重新计算内核矩阵元素。
> 
> 在大型数据集上使用 svmtrain 时，如果内存不足或优化步骤非常耗时，请尝试以下任一方法：
> 
> *   使用较少数量的样本并使用交叉验证来测试分类器的性能。
>     
>     
> *   将“方法”设置为“SMO”，并将 kernelcachelimit 选项设置为系统允许的最大大小。

# ruby-on-rails - Rails：如何使用 AJAX 渲染页面并保持 DRY

> ID：15994227
> 
> 赞同：1
> 
> 时间：2013-04-13T23:57:54.523
> 
> 标签：ruby-on-rails, ajax

我有一个日历页面，显示一个人整个月的例行公事。在顶部，我有上个月和下个月的按钮。单击这些时，我对 change_date 操作进行 AJAX 调用，该操作会更新日期并查找新例程。当change_date.js.erb被调用时，我是否必须再次编写代码来更改日常操作的内容？这似乎违反了 DRY。有什么方法可以重用我在初始加载时用来填充页面的部分来用新值重新填充页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:08:14.353

当页面首次加载时，我也会通过 ajax 加载该人的例程。

我会将它封装在一个 js 函数中，并在第一次加载页面时以及每次更改月份时调用该函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:10:00.810

当然，有。只需`render`像在 html 模板中一样使用。通常支持 ajax 和常规调用的设置看起来像这样（当然名称是猜测的）：

```
# controller
def change_date
  @dates = Date.where(:date => params[:date])

  respond_to do |format|
    format.html
    format.js
  end
end

# change_date.html.erb
<ul id="calendar">
  <%= render @dates %>
</ul>

# change_date.js.erb
$("#calendar").html("<%= escape_javascript(render @dates) %>");

# _date.html.erb
<li><%= date.date %></li> 
```

所以你看，你可以简单地在两种情况下使用相同的部分。

还有另一个建议：根据您的设置，在控制器中没有其他方法可能会更安静，但`show`在这种情况下使用根据查询参数操作的方法......

# python - 如何在 Python 中打开一个应用程序，然后让脚本的其余部分运行？

> ID：15994229
> 
> 赞同：0
> 
> 时间：2013-04-13T23:58:14.477
> 
> 标签：python, subprocess, raspberry-pi

我一直在尝试创建一个脚本，如果互联网闪烁，它会重新加载一个名为 Midori 的网络浏览器。但是，它似乎只有在我通过 CLI 打开 Midori 时才有效 - 否则，程序在我重新加载后崩溃。我决定最好的办法是让脚本通过`subprocess`模块打开 Midori。所以，我把它作为我代码中的第一个参数之一：

```
import subprocess as sub
sub.call(["midori"]) 
```

浏览器打开，但程序的其余部分冻结，直到我退出 Midori。我曾尝试使用线程，但它似乎不起作用。

有没有办法通过 Python 打开应用程序，然后在打开所述应用程序后让脚本的其余部分继续运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:00:35.707

从[文档](http://docs.python.org/3.3/library/subprocess.html#subprocess.call)：

> 运行 args 描述的命令。**等待命令完成**，然后返回 returncode 属性。

（重点补充）

你可以看到这是我们应该期待的行为。要解决此问题，请[`subprocess.Popen`](http://docs.python.org/3.3/library/subprocess.html#popen-constructor)改用。这不会以同样的方式阻塞：

```
from subprocess import Popen
midori_process = Popen(["midori"]) 
```

# c# - 如何用另一个表单正确监听表单事件

> ID：15994230
> 
> 赞同：2
> 
> 时间：2013-04-13T23:58:17.623
> 
> 标签：c#, winforms, forms, events

卡在另一种形式的侦听事件中。

当我尝试关闭 Form2 时，Form1 上没有任何反应。当 Form2 关闭时，我想在 Form1 中做一些事情。

这是我的 Form1 代码

```
public partial class Form1: Form
        {
             public Form1()
            {
                InitializeComponent();

                Form2 frm2= new Form2();
                frm2.FormClosing += new FormClosingEventHandler(frm2_FormClosing);
            }

            void frm2_FormClosing(object sender, FormClosingEventArgs e)
            {
                throw new NotImplementedException();
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:16:06.390

您将需要显示您正在实现它的`FormClosing`事件的对象。由于您正在创建的新对象在您的构造函数中，我假设 frm2 不是您正在显示的表单，这意味着您没有处理该事件。

```
public Form1()
{
    InitializeComponent();

    Form2 frm2 = new Form2();
    frm2.FormClosing += frm2_FormClosing;
    frm2.Show();    
}

void frm2_FormClosing(object sender, FormClosingEventArgs e)
{
    MessageBox.Show("Form2 is closing");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T00:35:03.963

您创建了一个新的 form2 实例，并听取了它的关闭事件 - 但是从您发布的代码中您从未显示过它？不知道我错过了什么，但你认为应该工作的工作确实有效 - 即：

```
 public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            Form2 frm2 = new Form2();
            frm2.FormClosing += frm2_FormClosing;
            frm2.Show();
        }

        void frm2_FormClosing(object sender, FormClosingEventArgs e)
        {
            MessageBox.Show("form 2 closed");
        }
    } 
```

# database - 使用自动递增主键将 csv 导入 sqlite

> ID：15994231
> 
> 赞同：20
> 
> 时间：2013-04-13T23:58:18.163
> 
> 标签：database, csv, sqlite

我正在尝试在 sqlite 中创建一个表，该表从 csv 文件中获取数据并将自动递增的主键添加到第一列。这是我要插入数据的表：

```
DROP TABLE IF EXISTS Allegiance;
CREATE TABLE Allegiance (
  AllegianceID INTEGER PRIMARY KEY AUTOINCREMENT,
  CharacterID INTEGER,
  Title TEXT,
  FOREIGN KEY (CharacterID) REFERENCES Characters(CharacterID)); 
```

这是 .csv 文件中的数据

```
, 3, King of the North
, 14, King of the Andals and the First Men
, 15, Lord of Dragonstone
, 26, Khaleesi
, 35, Lord Reaper of Pyke 
```

这是我收到的错误：

```
sqlite> .mode csv
sqlite> import allegiances.csv Allegiance;
Error: datatype mismatch 
```

如果我在每行的第一个逗号之前有“null”，我会收到相同的错误。当我在每行的第一个逗号之前添加随机数时，我没有收到任何错误。但是，我需要使用的实际数据集可能要大得多，因此，我不能简单地为每个条目手动添加唯一的主键。我真的很感激这方面的帮助

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-14T10:50:01.147

`INTEGER PRIMARY KEY`CSV 文件中的空字段只是一个空字符串，对列无效。

导入没有该列的临时表，然后使用以下命令复制数据：

```
INSERT INTO Allegiance(CharacterID, Title) SELECT * FROM TempTable; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-01T19:29:08.577

您可以在文本文件中添加带有主键的列，然后将其导入。注意：如果您在第一列中收到该错误，请确保您的文件没有 BOM。如果它有 BOM（文件开头的 3 个字节），它将在第一行失败。

1：插入失败：数据类型不匹配

```
>     drop table words ;
>     CREATE TABLE words (id INTEGER PRIMARY KEY AUTOINCREMENT, name COLLATE NOCASE, rank INT);
>     .import file.txt words

1|a|0
2|b|0
3|c|0
4|d|0
5|e|0
6|f|0
7|g|0 
```

# android - 我的数据库出现有趣的错误

> ID：15994232
> 
> 赞同：0
> 
> 时间：2013-04-13T23:58:27.837
> 
> 标签：android

我的应用程序是通讯录，最后一切正常，但是当我“用户”添加新联系人时，我会强制关闭..但应用程序没有关闭，而是重新启动！当我检查联系人列表时，我发现我尝试添加的内容确实被添加了！！！logcat 说错误在这里：

```
return cursorToContact(cursor); 
```

它是这个添加功能的一部分：

```
 /** Add new Contact to Database. */
public Contact createContact(Contact contact) {
    //Used to store data like : COLUMN_NAME , VALUE.
    ContentValues values = new ContentValues();
    values.put(MySQLiteHelper.COLUMN_FIRST_NAME, contact.getFirstName());
    values.put(MySQLiteHelper.COLUMN_LAST_NAME, contact.getLastName());
    //Insert new contact and get the id of it.
    long insertId = database.insert(MySQLiteHelper.TABLE_NAME_FTS, null,
            values);
    //To show how to query (To get contact by it id).
    Cursor cursor = database.query(MySQLiteHelper.TABLE_NAME_FTS,
            allColumns, MySQLiteHelper.COLUMN_ID + " = " + insertId, 
                             null,
            null, null, null);
    //Move Cursor to the first row.
    cursor.moveToFirst();
    return cursorToContact(cursor);
} 
```

那么为什么会发生这种情况>请帮助我注意我正在使用 sqlite fts3 数据库

cursorToContact ：

```
 /** Used to get Contact data from Cursor to Memo Object. */
private Contact cursorToContact(Cursor cursor) {
    Contact contact = new Contact();
    contact.setId(cursor.getLong(0));
    contact.setFirstName(cursor.getString(1));
    contact.setLastName(cursor.getString(2));
    return contact;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T04:37:24.720

这一行实际上将数据添加到您的数据库中：

```
 long insertId = database.insert(MySQLiteHelper.TABLE_NAME_FTS, null,
            values); 
```

之后发生的任何事情都是偶然的（大部分）。

如果你的查询搞砸了，你的其他部分就会失败。您的查询：

```
Cursor cursor = database.query(MySQLiteHelper.TABLE_NAME_FTS,
        allColumns, MySQLiteHelper.COLUMN_ID + " = " + insertId, 
                         null,
        null, null, null); 
```

看起来很合适。不过，allColumns 可能会搞砸。

另外，我不知道你为什么要在 CursorToContact 中设置一个新的联系人，只是为了返回一些其他值。

```
 /** Used to get Contact data from Cursor to Memo Object. */
private Contact cursorToContact(Cursor cursor) {
    Contact contact = new Contact();
    contact.setId(cursor.getLong(0));
    contact.setFirstName(cursor.getString(1));
    contact.setLastName(cursor.getString(2));
    return contact;
} 
```

你从不使用联系方式。我本来希望你把它还给我的。

# c# - 反序列化c#

> ID：15994234
> 
> 赞同：1
> 
> 时间：2013-04-13T23:58:37.583
> 
> 标签：c#, serialization, xml-serialization, deserialization, encryption

我有一个 WPF 应用程序包含这个类：*

```
{[Serializable]
public class Parametres
{
    private string admin_login;
    private string admin_pwd;
    private string server;
    private string db;
    private string user;
    private string pwd;} 
```

我用这个函数序列化一个对象：

```
 public static void Serialize_Parametres(string filename, Parametres obj)
    {
        using (FileStream fs = File.Open(filename, FileMode.OpenOrCreate))
        {
            using (CryptoStream cs = new CryptoStream(fs, key.CreateEncryptor(), CryptoStreamMode.Write))
            {
                XmlSerializer xmlser = new XmlSerializer(typeof(Parametres));
                xmlser.Serialize(cs, obj);
            }
        }
    } 
```

它工作正常，它会生成一个文件 .txt ，但是当我尝试反序列化这个文件并使用这个函数获取对象参数时：

```
 public static Parametres DeSerialize_Parametres(string filename)
        {
            using (FileStream fs = File.Open(filename, FileMode.Open))
            {

              using (CryptoStream cs = new CryptoStream(fs, key.CreateDecryptor(), CryptoStreamMode.Read))

                {

                    XmlSerializer xmlser = new XmlSerializer(typeof(Parametres));
                    return (Parametres)xmlser.Deserialize(cs);

                }
            }

        } 
```

我在这`Length of the data to decrypt is invalid`条线上遇到了这个错误`return (Parametres)xmlser.Deserialize(cs);`

这个错误的确切原因是什么？我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:18:00.493

使用此技术序列化对象时，您必须分两部分进行。长度加密的流必须存储为最终流的一部分，由您决定。但是，您应该将其分解为更可重复使用的形式。

比如先把你想要的图序列化成字节流；然后加密字节流；然后将其保存到文件中。

下面是一个关于如何使用 AES 序列化到文件的示例：

```
 public class ObjectXmlSerializer
    {
        //---------------------------------------------------------------------
        public override Byte[] Serialize(Object obj)
        {
            using (MemoryStream ms = new MemoryStream())
            {
                new XmlSerializer(obj.GetType()).Serialize(ms, obj);
                return ms.ToArray();
            }
        }
        //---------------------------------------------------------------------
        public override T Deserialize<T>(Byte[] bObj)
        {
            using (MemoryStream ms = new MemoryStream(bObj))
            {
                return (T)new XmlSerializer(typeof(T)).Deserialize(ms);
            }
        }
        //---------------------------------------------------------------------
        public override T Deserialize<T>(Stream iostream)
        {
            return (T)new XmlSerializer(typeof(T)).Deserialize(iostream);
        }
    } 
```

// 下一个

```
public static class CryptoSerivces
{
        //---------------------------------------------------------------------
        public static Byte[] AesEncrypt(Byte[] src, Byte[] key, Byte[] IV)
        {
            using (RijndaelManaged myRijndael = new RijndaelManaged())
            {
                try
                {
                    myRijndael.Mode = CipherMode.CBC;
                    myRijndael.Key = key;
                    myRijndael.IV = IV;
                    myRijndael.Padding = PaddingMode.PKCS7;

                    using (ICryptoTransform encryptor = myRijndael.CreateEncryptor())
                    using (MemoryStream msEncrypt = new MemoryStream())
                    using (CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))
                    {
                        csEncrypt.Write(src, 0, src.Length);
                        csEncrypt.FlushFinalBlock();

                        return msEncrypt.ToArray();
                    }
                }
                finally
                {
                    myRijndael.Clear();
                }
            }
        }
        //---------------------------------------------------------------------
        public static Byte[] AesDecrypt(Byte[] src, Byte[] key, Byte[] IV)
       {
        using (RijndaelManaged myRijndael = new RijndaelManaged())
        {
            try
            {
                myRijndael.Mode = CipherMode.CBC;
                myRijndael.Key = key;
                myRijndael.IV = IV;
                myRijndael.Padding = PaddingMode.PKCS7;

                using (ICryptoTransform decryptor = myRijndael.CreateDecryptor())
                using (MemoryStream msDecrypt = new MemoryStream())
                using (CryptoStream csDecrypt = new CryptoStream(msDecrypt, decryptor, CryptoStreamMode.Write))
                {
                    csDecrypt.Write(src, 0, src.Length);
                    csDecrypt.FlushFinalBlock();

                    return msDecrypt.ToArray();
                }
            }
            finally
            {
                myRijndael.Clear();
            }
        }
    }
} 
```

// 把所有的部分放在一起

```
void SaveToFile(String fileName, Parametres obj)
{
   ObjectXmlSerializer oxs = new ObjectXmlSerializer();
   Byte[] bObj = oxs.Serialize(obj);
   Byte[] bEncObj = CryptoSerivces.AesEncrypt(bObj, SomeKey, SomeIV);

   using (FileStream fs = File.Open(filename, FileMode.OpenOrCreate))
   {
      fs.Write(bEncObj, 0, bEncObj.Length);
   }
} 
```

// 我将把阅读留给你。

# c++ - is_standard_layout 有什么用？

> ID：15994237
> 
> 赞同：13
> 
> 时间：2013-04-13T23:58:51.413
> 
> 标签：c++, c++11, standard-layout

据我了解，标准布局允许三件事：

*   空基类优化
*   通过某些指针转换向后兼容 C
*   偏移量的使用

现在，库中包含`is_standard_layout`谓词元函数，但我看不出它在泛型代码中有多少用处，因为我上面列出的那些 C 功能似乎极少需要检查泛型代码。我唯一能想到的就是在里面使用它`static_assert`，但这只是为了让代码更健壮，并不是必需的。

有`is_standard_layout`什么用？没有它，是否有任何事情是不可能的，因此在标准库中需要它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T00:56:45.483

## 一般反应

这是一种验证假设的方法。如果不是这种情况，您将不想编写假定标准布局的代码。

C++11 提供了一堆这样的实用程序。它们对于编写通用代码（模板）特别有价值，否则您必须相信客户端代码不会犯任何错误。

* * *

## 特定于的注释`is_standard_layout`

在我看来，（伪代码）定义`is_pod`大致是......

```
// note: applied recursively to all members
bool is_pod(T) { return is_standard_layout(T) && is_trivial(T); } 
```

因此，您需要了解`is_standard_layout`才能实施`is_pod`. 鉴于此，我们不妨将其公开`is_standard_layout`为库开发人员可用的工具。另请注意：如果您有 的用例`is_pod`，您可能需要考虑在这种`is_standard_layout`情况下实际上可能是更好（更准确）的选择的可能性，因为 POD 本质上是标准布局的子集。

我觉得他们添加了所有可能的类型评估变体，不管有什么明显的价值，以防万一有人在下一个标准出现之前的某个时候遇到需求。我怀疑这些“额外”类型属性是否会给编译器开发人员增加显着的额外负担。

这里有一个关于标准布局的很好的讨论：[为什么 C++11 的 POD “标准布局”定义是这样的？](https://stackoverflow.com/questions/7160901/why-is-c11s-pod-standard-layout-definition-the-way-it-is) cppreference.com 上也有很多很好的细节：[非静态数据成员](http://en.cppreference.com/w/cpp/language/data_members)

# php - 购物车页面未显示任何内容

> ID：15994240
> 
> 赞同：0
> 
> 时间：2013-04-13T23:59:19.670
> 
> 标签：php, mysql, cart

我已经对我的购物车页面进行了编码，但它似乎没有显示任何内容。以前在我的产品页面上，我有一个表单操作，点击添加到购物车后会引导我进入 cart.php。我不确定这里出了什么问题。

```
<?php
session_start();
//script error reporting
error_reporting(E_ALL);
ini_set('display_errors', '1');
// Connect to the MySQL database
include "storescripts/connect.php";
?>

<?php
if (isset($_POST['pid'])) {
$pid = $_POST['pid'];
$wasFound = false;
$i = 0;
// if the cart session variable is not set or cart array is empty
if (!isset($_SESSION["cart_array"]) || count($_SESSION["cart_array"]) < 1) {
    // run if the cart is empty or not set
    $_SESSION["cart_array"] = array(1 => array("item_id" => $pid, "quantity" => 1));
} else {
    // run if the cart has at least one item in it
    foreach ($_SESSION["cart_array"] as $each_item) {
        $i++;
        while (list($key, $value) = each($each_item)) {
            if ($key == "item_id" && $value == $pid) {
                //that item is in cart already so let's adjust its quantity using array_slice()
                array_splice($_SESSION["cart_array"], $i-1, 1, array(array("item_id" => $pid, "quantity" => $each_item['quantity'] + 1)));
                $wasFound = true;
            } //close if condition
        }//close while loop
    }//close foreach loop
    if ($wasFound == false) {
        array_push($_SESSION["cart_array"], array("item_id" => $pid, "quantity" => 1));
    }
  }
}
?>
<?php
 // SECTION 2(if user chooses to empty their shopping cart)
if (isset($_GET['cmd']) && $_GET['cmd'] == "emptycart") {
unset($_SESSION["cart_array"]);
}
?>
<?php
// SECTION 3 (render the cart for the user to view)
$cartOutput = "";
if (!isset($_SESSION["crt_array"]) || count($_SESSION["cart_array"]) < 1) {
$cartOutput = "<h2 align='center'>Your shopping cart is empty</h2>";
} else {
$i = 0;
foreach ($_SESSION["cart_array"] as $each_item) {
    $i++;
    $item_id = $each_item["item_id"];
    $sql = mysql_query("SELECT * FROM products WHERE id='$item_id' LIMIT 1");
    while ($row = mysql_fetch_array($sql)) {
        $product_name = $row["product_name"];
        $price = $row["price"];
    }
    $cartOutput .= "<h2>Cart Item $i</h2>";
    //while(list($key, $value) = each($each_item))
          //  $cartOutput .= "$key: $value<br/>";
    $cartOutput .= "Item ID:" . $each_item['item_id'] . "<br/>";
    $cartOutput .= "Item Quantity:" . $each_item['quantity'] . "<br/>";
    $cartOutput .= "Item Name:" . $product_name . "<br/>";
    $cartOutput .= "Item Price: $" . $price . "<br/>";
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:06:26.313

你有一个小错误。拼写错误亲爱的。它发生了。人为错误总是发生（：及其在会话购物车数组（：

# android - 从适用于 Android 的 Python 获取 root

> ID：15994243
> 
> 赞同：1
> 
> 时间：2013-04-13T23:59:50.450
> 
> 标签：android, python, root, sl4a

我正在使用 Python for Android 和 SL4A 来编写 Android 应用程序。我的问题是：你能从 Python for Android 获得 root 访问权限吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:32:40.747

我解决了我自己的问题。我最终找到了[https://code.google.com/p/android-scripting/issues/detail?id=184](https://code.google.com/p/android-scripting/issues/detail?id=184)并使用答案中给出的`suu`和二进制文件。`sush`工作完美！

**编辑：** Timeskip 更新，这是自 SL4A 移至 GitHub 以来[的新问题链接。](https://github.com/damonkohler/sl4a/issues/281)不确定这与 Magisk 的效果如何，因为我个人已经有一段时间没有使用 SL4A 了。

# php - 如何在 PHP 中组合/合并具有相同键的多维数组？

> ID：15994246
> 
> 赞同：2
> 
> 时间：2013-04-14T00:00:12.307
> 
> 标签：php, arrays

所以我有这个数组，它的 vardump 看起来像这样：

```
array (size=4)
  0 => 
    array (size=1)
      'field_4' => 
        array (size=1)
          0 => string 'item-1' (length=6)
  1 => 
    array (size=1)
      'field_4' => 
        array (size=1)
          0 => string 'info-1' (length=6)
  2 => 
    array (size=1)
      'field_5' => 
        array (size=1)
          0 => string 'item-2' (length=6)
  3 => 
    array (size=1)
      'field_5' => 
        array (size=1)
          0 => string 'info-2' (length=6) 
```

所以我试图将数组与相同的键组合，例如“field_4”将被合并/组合成一个包含 2 个项目“item-1”和“info-1”的数组。

所以我想要的最终结果是这样的：

```
array (size=2)
  0 => 
    array (size=1)
      'field_4' => 
        array (size=2)
          0 => string 'item-1' (length=6)
          1 => string 'info-1' (length=6)
  1 => 
    array (size=1)
      'field_5' => 
        array (size=1)
          0 => string 'item-2' (length=6)
          1 => string 'info-2' (lenght=6) 
```

那么是否有一个 PHP 便利函数来处理这个问题，还是我必须重建数组？

感谢您的关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:05:44.837

只需遍历输入数组，构建合并数组：

```
$merged = array();
foreach ($input as $a)
    foreach ($a as $k => $v)
        foreach ($v as $v2)
            $merged[$k][] = $v2; 
```

然后将其展平为您奇怪的所需输出：

```
$flattened = array();
foreach ($merged as $k => $v)
    $flattened[] = array($k => $v); 
```

输入：

```
$input = array(
    array('field_4' => array('item-1')),
    array('field_4' => array('info-1')),
    array('field_5' => array('item-2')),
    array('field_5' => array('info-2')),
); 
```

输出：

```
array(
    array('field_4' => array('item-1', 'info-1')),
    array('field_5' => array('item-2', 'info-2')),
) 
```

转储输出时，`print_r`或`var_export`制作一个比`var_dump`

# android - 没有依赖项的适用于 Android APK 的 Python

> ID：15994251
> 
> 赞同：2
> 
> 时间：2013-04-14T00:01:22.740
> 
> 标签：android, python, apk, sl4a

是否可以使用 Python for Android 构建一个不需要 Python for Android 的 APK，即它包括 Python？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:25:02.647

我相信这就是你要找的东西：[https ://code.google.com/p/android-python27/](https://code.google.com/p/android-python27/)

这会将 python 嵌入到您的 apk 中。首次启动时，它会给您一个对话框，说明它正在“安装”。这部分将安装您的脚本以及 python 的集成版本。如果您有偏好（2.6、2.7 和 3.2），您还可以嵌入不同版本的 python。

*   可在此处找到入门教程：[https ://code.google.com/p/android-python27/w/list](https://code.google.com/p/android-python27/w/list)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-02-19T12:02:34.470

我认为您可以使用 py2exe 将您的程序转换为 .exe - 文件，然后将此 .exe - 文件转换为 .apk - 文件。

# spring-batch - 春季批处理 - 处理器链

> ID：15994254
> 
> 赞同：1
> 
> 时间：2013-04-14T00:01:39.510
> 
> 标签：spring-batch

我需要依次执行七个不同的过程（一个接一个）。数据存储在 Mysql 中。我正在考虑以下选项，如果我错了，或者如果有更好的解决方案，请纠正我。

要求：

1.  从 Db 中读取数据，最后执行七个过程（datavalidation、calculation1、calculation2 ...等），将处理后的数据写入 DB。

2.  需要分块处理数据。

我的解决方案和问题： 数据读取：

1.  使用 JdbcCursorItemReader 读取数据，因为这是性能最好的数据库读取器 - 但是，SQL 非常复杂，所以我可能不得不考虑使用 JdbcTemplate 自定义 ItemReader？这使我在处理数据时更加灵活。

过程：

1.  定义七个步骤和块，使用databean共享步骤之间的数据。但是，这不是一个好主意，因为数据以块的形式处理，并且在每个块之后，step1 编写器将在 databean 中创建一组新数据。当这个databean 跨其他步骤共享时，数据完整性将成为一个问题。

2.  使用 StepExecutionContext 在步骤之间共享数据。但这可能会影响性能，因为这涉及批处理作业存储库。

3.  只定义一个步骤，一个 ItemReader 和一个进程链（七个进程），并创建一个 ItemWriter 将处理后的数据写入 DB。但是，我将无法管理或监控每个不同的进程，所有这些都将在一个步骤中完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T11:44:07.583

这[`org.springframework.batch.item.support.CompositeItemProcessor`](https://docs.spring.io/spring-batch/trunk/apidocs/org/springframework/batch/item/support/CompositeItemProcessor.html)是 Spring Batch 框架中的一个开箱即用的组件，它将支持您的要求，类似于您的第二个选项。这将允许您执行以下操作；- 在您的设计/解决方案中保持分离以从数据库中读取（itemreader） - 保持每个单独的处理器“关注点”和配置的分离 - 允许任何单独的处理器通过返回 null 来“关闭”块，而不管之前的进程如何

`CompositeItemProcessor`迭代一个委托循环，因此它与动作模式“相似” 。它在您描述的场景中非常有用，并且仍然允许您利用 Chunk 的好处（异常、重试、提交策略等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T13:50:17.237

建议：

1) 使用 JdbcCursorItemReader 读取数据。

所有开箱即用的组件都是不错的选择，因为它们已经实现了 ItemStream 接口，使您的步骤可重新启动。但是就像您提到的，有时，请求只是为了复杂化，或者像我一样，您已经拥有可以重用的服务或 DAO。

我建议您使用 ItemReaderAdapter。它允许您配置一个委托服务来调用以获取您的数据。

```
 <bean id="MyReader" class="xxx.adapters.MyItemReaderAdapter">
       <property name="targetObject" ref="AnExistingDao" />
       <property name="targetMethod" value="next" />        
   </bean> 
```

注意 targetMethod 必须遵守 ItemReaders 的读取约定（没有更多数据时返回 null）

如果您的工作不需要重新启动，您可以简单地使用类：**org.springframework.batch.item.adapter.ItemReaderAdapter**

但是如果你需要你的工作是可重新启动的，你可以像这样创建你自己的 ItemReaderAdapter：

```
public class MyItemReaderAdapter<T> extends AbstractMethodInvokingDelegator<T> implements ItemReader<T>, ItemStream {

private long currentCount = 0;

private final String CONTEXT_COUNT_KEY = "count"; 

/**
 * @return return value of the target method.
 */
public T read() throws Exception {

    super.setArguments(new Long[]{currentCount++});
    return invokeDelegateMethod();
}
@Override
public void open(ExecutionContext executionContext)
        throws ItemStreamException {
    currentCount = executionContext.getLong(CONTEXT_COUNT_KEY,0);

}

@Override
public void update(ExecutionContext executionContext) throws ItemStreamException {
    executionContext.putLong(CONTEXT_COUNT_KEY, currentCount);
    log.info("Update Stream current count : " + currentCount);
}

@Override
public void close() throws ItemStreamException {
    // TODO Auto-generated method stub

}

} 
```

因为开箱即用的 itemReaderAdapter 不可重新启动，您只需创建自己的实现 ItemStream

2）关于 7 步与 1 步。

我会在这一步上使用compositeProcessor 一步。7个步骤选项只会带来问题IMO。

1）7步databean：所以你的作家在databean中提交直到第7步..然后第7步作家尝试提交到真正的数据库和繁荣错误！！！一切都丢失了，批次必须从第 1 步重新开始！！

2）上下文的7个步骤：可能会更好，因为您将状态保存在spring批处理元数据中..但是将大数据存储在springBatch的元数据中不是一个好习惯！

3）是去海事组织的方式。;-)

# java - 在 Java HashMap 中使用 hash() 方法进行随机化

> ID：15994256
> 
> 赞同：2
> 
> 时间：2013-04-14T00:02:02.357
> 
> 标签：java, hash, hashmap, bit-manipulation, xor

在 Java 的 HashMap 实现中，在计算了 key 对象的哈希值之后，我猜想在其上使用函数 hash(int hashvalue) 来进一步随机化生成的哈希值。当它进行右移时，它会更多地随机化 LSB 位。他们为什么不通过执行左移来随机化 MSB？

而不是做喜欢

*   h ^= (h >>> 20) ^ (h >>> 12); // 这里从右边第 21 位开始的位不变 // 考虑输入的哈希值在 (2^21) -(2^22) 范围内的情况，这些值将分布在桶中(2^21) -(2^22) 的索引和散列图中的剩余存储桶未使用。

*   返回 h ^ (h >>> 7) ^ (h >>> 4); // 更加随机化 LSB 部分。

为什么他们不能做类似的事情

*   h ^= (h >>> 20) ^ (h >>> 12) ^ (h <<< 20) ^ (h <<< 12); // 这会随机化 LSB 位和 MSB 位

*   返回 h ^ (h >>> 7) ^ (h >>> 4) ^ (h <<< 7) ^ (h <<< 4);

结果，我们将得到一个具有随机 MSB 和 LSB 位的随机数。

# paypal - 在我调用 paypal 沙盒 api 的网页底部显示额外内容

> ID：15994257
> 
> 赞同：0
> 
> 时间：2013-04-14T00:02:06.900
> 
> 标签：paypal, paypal-sandbox, paypal-ipn, paypal-subscriptions

我在我的页面中使用了贝宝沙盒调用 3 次。当页面加载它看起来不错。但不幸的是，最后一次它加载了一些文本，如下面的 3 次，在我的代码中称为 pai 3 次。

*   即将 connect() 到 api-3t.sandbox.paypal.com 端口 443 (#0) * 正在尝试 173.0.82.83... * 已连接 * 已连接到 api-3t.sandbox.paypal.com (173.0.82.83) 端口 443 (#0) * 使用 AES256-SHA 的 SSL 连接 * 服务器证书：* 主题：C=US；ST=加利福尼亚；L=圣何塞；O=贝宝公司；OU=贝宝生产；CN=api-3t.sandbox.paypal.com * 开始日期：2011-08-11 00:00:00 GMT * 到期日期：2013-09-17 23:59:59 GMT * 发行人：C=US；O=威瑞信公司；OU=威瑞信信任网络；OU= [https://www.verisign.com/rpa](https://www.verisign.com/rpa) (c)10 上的使用条款；CN=VeriSign Class 3 Secure Server CA - G3 * SSL 证书验证结果：无法获取本地颁发者证书 (20)，仍然继续。> POST /nvp HTTP/1.1 主机：api-3t.sandbox.paypal.com 接受：*/*内容长度：899 内容类型：application/x-www-form-urlencoded < HTTP/1.1 200 OK < 日期：2013 年 4 月 13 日星期六 23:55:08 GMT < 服务器：Apache < 内容长度：412 < 连接: 关闭 < Content-Type: text/plain; charset=utf-8 < * 关闭连接 #0

幸运的是，当我从本地主机运行相同的代码时，一切正常。将其上传到服务器后，它看起来像这样。

**如何摆脱这个？**

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:55:30.517

你在使用 PHP 吗？如果您在 CURL 请求中显示帖子标题，看起来会发生一些事情。尝试将以下内容添加到您的 CURL 代码中...

```
curl_setopt('CURLOPT_HEADER',TRUE); 
```

如果您不使用 PHP，那么无论您使用什么方法将数据发布到 PayPal，都应该有类似的东西。

# ios - 检查日期是否在日期范围内

> ID：15994262
> 
> 赞同：0
> 
> 时间：2013-04-14T00:02:53.700
> 
> 标签：ios, objective-c, nsdate

确定日期是否在特定日期范围内的最佳方法是什么？我现在正在这样做：

```
if (([rangeStart compare:userEnteredDate] == NSOrderedAscending) && ([rangeEnd compare:userEnteredDate] == NSOrderedDescending) 
```

上述代码的唯一问题是，如果 rangeStart 日期和 userEnteredDate 相同，则 if 语句会因我不知道的某种原因产生“假”。任何人有任何想法为什么？

有没有更好的方法来检查 userEnteredDate 是否在 rangeStart 和 rangeEnd 范围内？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:10:23.547

原因是如果`rangeStart`等于`userEnteredDate`，则布尔表达式的第一块将计算为

```
NSOrderedSame == NSOrderedAscending 
```

这确实是错误的。

我会重新排列顺序并使用类似的东西

```
if (([userEnteredDate compare:rangeStart] != NSOrderedDescending)
     && ([userEnteredDate compare:rangeEnd] != NSOrderedAscending)) {
   //... 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:11:05.150

不知道是否有更直接的方法，但这应该可行。-

```
if (([rangeStart compare:userEnteredDate] == NSOrderedAscending || 
     [rangeStart compare:userEnteredDate] == NSOrderedSame) && 
     ([rangeEnd compare:userEnteredDate] == NSOrderedDescending ||
      [rangeEnd compare:userEnteredDate] == NSOrderedSame)) 
```

# java - 采用 JMS 技术的 SMTP

> ID：15994263
> 
> 赞同：0
> 
> 时间：2013-04-14T00:03:27.267
> 
> 标签：java, spring, smtp, jms

我知道 EJB/Spring 框架中消息驱动 Bean 的概念。我知道如何使用 Java Mail API 发送电子邮件，并且我知道 JMS 体系结构的两种协议：

*   发布和订阅（主题）
*   点对点（队列）

我必须使用 JMS 作为处理电子邮件的技术。Java Spring 提供消息驱动 Bean 支持和 JMS 支持。我的问题是如何为 SMTP 服务器配置 JMS 队列？我在网上找不到任何关于此的信息，但人们已经这样做了。

所以我想做的是，消息队列会监听进来的电子邮件，当有电子邮件进来时，它会进行一些处理。我知道我必须使用消息驱动 Bean，但问题是如何配置 JMS 以连接到 SMTP 服务器。

任何帮助，将不胜感激。如果你能包括一些例子，那就太好了。我尝试在 Google 上查找，但没有任何显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T03:25:14.933

您不能真正设置 JMS 队列以供 SMTP 服务器直接使用。你能做的是

1.  在您的服务器中设置 JMS 队列
2.  创建一个 JMS 生产者，当调用它时，它应该接收电子邮件数据（主题、正文、收件人、抄送等）并将其发布到步骤 1 中的队列设置
3.  创建一个 JMS Consumer，它订阅第 1 步中创建的 Queue，它的 onMessage 应该调用 JavaMail API 来发送电子邮件。

为什么要做这一切？这样JavaMail 调用是异步的。

# list - 方案 - 截断列表

> ID：15994268
> 
> 赞同：0
> 
> 时间：2013-04-14T00:04:08.957
> 
> 标签：list, scheme

我是新来的计划。我正在尝试以新列表不应包含第一个和最后一个元素的方式截断列表。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:09:34.153

有很多方法可以做到这一点，一种可能性是使用[`drop-right`](http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._drop-right%29%29)删除最后一个元素和[`rest`](http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._rest%29%29)（或`cdr`）删除第一个元素：

```
(define lst '(1 2 3 4 5))
(rest (drop-right lst 1))
=> '(2 3 4) 
```

如果`drop-right`在您的解释器中不可用，则只需实现一个过程，该过程返回一个新列表，其中包含输入列表中的所有元素，最后一个除外。您甚至可以在一个过程中结合删除这两个元素。这是解决方案的总体思路，假设列表至少有两个元素（否则会发生错误）- 填空：

```
(define (truncate-first-last lst)
  (define (drop-last lst)          ; helper procedure for removing last element
    (if <???>                      ; if the rest of the list is empty
        <???>                      ; then return the empty list
        (cons <???>                ; else `cons` the first element
              (drop-last <???>)))) ; and advance the recursion
  (drop-last <???>))               ; call helper, remove first element from list 
```

不要忘记测试它：

```
(truncate-first-last '(1 2 3 4 5))
=> '(2 3 4) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T03:24:24.220

你可以这样做：

```
(define (compose f1 . fn)
  (cond ((null? fn) f1)
        (else (let ((fr (apply compose fn)))
                (lambda (x) (f1 (fr x)))))))

(define truncate-first-last (compose reverse cdr reverse cdr))

> (truncate-first-last '(1 2 3 4))
(2 3) 
```

# javascript - AngularJS 监视服务变量

> ID：15994269
> 
> 赞同：3
> 
> 时间：2013-04-14T00:04:19.597
> 
> 标签：javascript, angularjs, angularjs-service

好吧，我真的在努力解决这个问题。我到处寻找解决方案，但即使有很多类似的问题也没有找到。

我有一堂课。我只需要一个实例，所以我为它提供了服务：

```
services.factory('PlayerService', ->
     new Player()
) 
```

如您所见，它是某种播放器。**当歌曲更改时，我需要更新我的视图**。

**这是一个暴露问题的极其简化的演示 plnk：http: [//plnkr.co/edit/L3WndT](http://plnkr.co/edit/L3WndT)**

这是我根据[这个问题](https://stackoverflow.com/questions/12576798/angularjs-how-to-watch-service-variabes)尝试过的。任何解决方案都不起作用。

### 看法

```
<div ng-controller="PlayerController">
    {{ player.currentSong }}
</div> 
```

### 第一

```
PlayerController = ($scope, PlayerService) ->
    $scope.player = PlayerService
    return 
```

### 第二个

```
PlayerController = ($scope, PlayerService) ->
    $scope.$watch(
        'myApp.services.PlayerService'
        (newval, oldval) ->
            $scope.currentSong = newval
        true
    )
    return 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:34:32.130

如果您真的在处理一些定期更新的外部服务并且不提供任何方式来监听更新事件（如您的 Plunker 中所示），您可以轮询更新并保持范围同步，如下所示：

[http://plnkr.co/edit/PJpQ2a?p=preview](http://plnkr.co/edit/PJpQ2a?p=preview)

请注意， poll 方法不需要显式更新范围。Angular 已在您嵌入视图中的表达式“serviceClass.prop”上创建了一个监视。$timeout 服务触发一个摘要循环，当表达式更改并更新视图时，它会触发监视侦听器。

# javascript - 使用 CSS 设置跨度中的第 n 个字母

> ID：15994270
> 
> 赞同：10
> 
> 时间：2013-04-14T00:04:27.520
> 
> 标签：javascript, css, styling, pseudo-class

我有：

```
<span id="string">12h12m12s</span> 
```

我希望使`h`,`m`和`s`小于文本的其余部分。我听说过`nth-letter`css 中的伪元素，但它似乎不起作用：

```
#string:nth-letter(3),
#string:nth-letter(6),
#string:nth-letter(9) {
    font-size: 2em;
} 
```

我知道我可以使用 javascript 来解析字符串并用周围的标签替换字母并`span`设置标签的样式。但是，字符串每秒更新一次，并且似乎解析通常会占用大量资源。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-14T00:37:27.200

性能方面，我推荐`span`地狱。

```
<span id="string"><span id="h">12</span><span class="h">h</span><span id="m">12</span><span class="m">m</span><span id="s">12</span><span class="s">s</span></span> 
```

每个`h`,`m`和`s`字母都有一个跨度，以便您可以正确设置它们的样式（可以为每个应用相同或不同的样式）。

每个数字的另一个跨度，以便您可以缓存参考。总之，这是一个非常简单的本地时钟的 JS：

```
//cache number container element references
var h = document.getElementById('h'),
    m = document.getElementById('m'),
    s = document.getElementById('s'),
    //IE feature detection
    textProp = h.textContent !== undefined ? 'textContent' : 'innerText';

function tick() {
    var date = new Date(),
        hours = date.getHours(),
        mins = date.getMinutes(),
        secs = date.getSeconds();
    h[textProp] = hours < 10 ? '0'+hours : hours;
    m[textProp] = mins < 10 ? '0'+mins : mins;
    s[textProp] = secs < 10 ? '0'+secs : secs;
}
tick();
setInterval(tick, 1000); 
```

[**小提琴**](http://jsfiddle.net/rsfax/2/)

这说明了缓存选择器的基本思想。通过不重新创建元素，您还可以获得良好的性能提升。

不过，对于如此简单的事情来说，每秒一次并不是很繁重的工作（除非您的页面中有数百个时钟）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T00:23:28.890

这可能是使用 javascript 和 jQuery 执行此操作的冗长方式，但这里有一个可能的解决方案。

`h`将, `m`&`s`与原始字符串分开。

```
string = $('#string').text();

hD = string.substr(0,2)
h = "<span>"+string.substr(2,1)+"</span>";
mD = string.substr(3,2)
m = "<span>"+string.substr(5,1)+"</span>";
sD = string.substr(6,2)
s = "<span>"+string.substr(8,1)+"</span>";

finalString = hD + h + mD + m + sD + s;

$('#string').html(finalString); 
```

然后，您可以`#string`使用 CSS 设置跨度的样式。

```
#string{font-size:1.2em}
#string > span{font-size:0.8em} 
```

这是[显示上述内容的演示小提琴](http://jsfiddle.net/sLgZE/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-14T01:05:20.407

这只会将字母扔到跨度中并为它们提供相同的类。也许值得一提，哈哈 :-)

[jsFiddle](http://jsfiddle.net/rsGQ9/11/)

JavaScript：

```
var str = document.getElementById('string'),
    chars = str.innerHTML.split('');

for (var i = 0; i < chars.length; i++) {
    if (chars[i].match(/[hms]/)) {
        chars[i] = "<span class='smaller'>" + chars[i] + "</span>";
    }
}
str.innerHTML = chars.join(''); 
```

HTML：

```
<body>
    <span id="string">12h12m12s</span>        
</body> 
```

CSS：

```
.smaller {
    font-size: 10px;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-21T08:36:23.983

使用 CSS 的简单解决方案并用跨度标签包装每个字符：

```
#text span:nth-child(2) {
  color: #ff00ff;
}

#text span:nth-child(5) {
  color: #00ffff;
}

#text {
  font-size: 20px;
}

<span id="text"><span>H</span><span>e</span><span>l</span><span>l</span><span>o</span></span> 
```

[https://jsfiddle.net/f8vffLj0/](https://jsfiddle.net/f8vffLj0/)

# jquery - 使用 jQuery 重新排序 SELECT 列表中的选项

> ID：15994272
> 
> 赞同：6
> 
> 时间：2013-04-14T00:04:54.797
> 
> 标签：jquery, html

有什么建议如何使用/重新排序其中的`<option>`元素`<select>`吗？这是html：

```
<select class="required" name="jform[params][language]" id="jform_params_language">
    <option value="cs-CZ">Czech (Cestina)</option>
    <option value="en-GB">English (United Kingdom)</option>
    <option value="sk-SK">Slovak (Slovencina)</option>
</select> 
```

我需要它是这样的：

```
<select class="required" name="jform[params][language]" id="jform_params_language">
    <option value="sk-SK">Slovak (Slovencina)</option>
    <option value="en-GB">English (United Kingdom)</option>
    <option value="cs-CZ">Czech (Cestina)</option>
</select> 
```

需要提一下，我无法修改 html。我尝试使用 jQuery 的`sort()`功能，但不知道该怎么做。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-14T00:09:40.420

你可以使用`reverse`方法。

```
var $sel = $('#jform_params_language'),
    $o = $sel.children().toArray().reverse();

$sel.append($o); //[0].selectedIndex = 0; 
```

[http://jsfiddle.net/3UWx6/](http://jsfiddle.net/3UWx6/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-21T07:59:48.087

例如，将第三个选项移到第一个选项之前，我们可以使用下面的 jquery：

```
$('select[name="NameOfDropDown"] option:eq(2)').insertBefore($('select[name="NameOfDropDown"] option:eq(0)')); 
```

# highslide - 左侧的垂直拇指条显示所有画廊的拇指

> ID：15994273
> 
> 赞同：0
> 
> 时间：2013-04-14T00:05:00.933
> 
> 标签：highslide

我有三个带有 highslide 的画廊，每个画廊都有十张图片，每个图片的左侧都有一个垂直的拇指条。问题是每个画廊都显示所有 30 个缩略图，我只想查看与每个画廊相关的 10 个缩略图。

我该如何控制这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:42:56.647

请参阅此 Highslide 常见问题解答项目：[如何在同一页面中放置多个画廊？](http://www.highslide.com/forum/viewtopic.php?f=4&t=4682)

# ruby-on-rails - Heroku Bash：ls 命令不显示 .dat 文件

> ID：15994281
> 
> 赞同：2
> 
> 时间：2013-04-14T00:06:40.780
> 
> 标签：ruby-on-rails, bash, heroku

我将一些 .dat 文件存储在 heroku 上我的 rails 应用程序的公共文件夹中。但是，我无法在 heroku bash 中显示这些文件。

注意 ls -l 结果中的“total 4”

```
~/public/files $ ls
README.txt

~/public/files $ ls -a
.  ..  README.txt

~/public/files $ ls -l
total 4
-rw------- 1 u5517 5517 25 2013-04-13 23:35 README.txt 
```

所以我知道他们在那里，他们只是没有被展示出来。我需要能够查看它们以验证我的应用程序是否正常工作。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T06:50:00.453

Heroku dynos 具有[临时文件系统](https://devcenter.heroku.com/articles/dynos#ephemeral-filesystem)，因此如果您在 Web 进程中编写文件，其他 dynos 将无法使用它们，包括从`heroku run bash`会话创建的。还请记住，[测功机至少每 24 小时重新启动一次](https://devcenter.heroku.com/articles/dynos#automatic-dyno-restarts)，因此除非这些只是临时文件，否则最好将文件放在像 S3 这样具有长期持久性并且可以被所有测功机访问的地方。

# c# - 从动态数组中删除按钮

> ID：15994282
> 
> 赞同：3
> 
> 时间：2013-04-14T00:06:43.530
> 
> 标签：c#, dynamic-arrays

在我的程序中生成按钮之前，应该使用以下方法清除它们：

```
for (int i = 0; i < buttons.Length; i++)
    this.Controls.Remove(buttons[i]); 
```

但是，上一代的所有按钮都保留了下来。这可能是什么原因造成的？

（下面是整个函数，其他函数中numButton的变化。）

```
 int numButtons = 5;
    Button[] buttons = new Button[10];

    private void generate_buttons()
    {
        for (int i = 0; i < buttons.Length; i++)
        {
            this.Controls.Remove(buttons[i]);
        }
        for (int i = 0; i < numButtons; i++)
        {
            buttons[i] = new Button();
            buttons[i].Name = "btn" + i.ToString();
            buttons[i].Text = Convert.ToString(i + 1);
            buttons[i].Size = new Size(40, 24);

            int yOffset = 40;
            int xOffset = 20 + i * 42;
            buttons[i].Location = new Point(xOffset, yOffset);
            buttons[i].BackColor = System.Drawing.SystemColors.Control;
            buttons[i].Enabled = false;
            buttons[i].Click += new EventHandler(this.clickMe);
            buttons[i].Visible = true;
            this.Height = yOffset + 104;
            this.Width = xOffset + 75;
        }
        Controls.AddRange(buttons);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T00:24:55.520

尽管您要从控件集合中删除按钮，但您并没有从`buttons`数组中删除它。添加

```
Array.Clear(buttons, 0, buttons.Length); 
```

我还修改了删除循环，以显式处理按钮持有的任何资源，如[MSDN 上](http://msdn.microsoft.com/en-us/library/82785s1h%28v=vs.80%29.aspx)所示。

```
for (int i = 0; i < buttons.Length; i++)
{
    //you can change break to 'continue' if you remove buttons
    //from the array randomly so that if it encounters a null 
    //it will carry on reading the rest of the array.
    if (buttons[i] == null)
        break;  

    //dispose any button resources and event handlers so no references remain
    buttons[i].Click -= new EventHandler(this.clickMe);
    this.Controls.Remove(buttons[i]);
    buttons[i].Dispose(); 
}

Array.Clear(buttons, 0, buttons.Length);

//.. 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-14T00:09:55.453

考虑改用通用列表集合。这允许您使用 .Add() 和 .Remove()/.RemoveAt() 方法更轻松地添加和删除元素。

教程/示例： http: [//www.dotnetperls.com/list](http://www.dotnetperls.com/list)

# perl - 内置 Tkx 图标

> ID：15994284
> 
> 赞同：1
> 
> 时间：2013-04-14T00:06:58.590
> 
> 标签：perl, tkx

在 Perl[`Tkx`](https://metacpan.org/module/Tkx)中，我创建了自己的弹出窗口，效果很好。

但我想嵌入那些内置图标，如信息、问题。

有谁知道我如何在自己的小部件上做到这一点以及如何做到这一点？

```
sub PopDialog {
    my ($TITLE, $NOTE, @buttons) = @_;

    my (@butt, $ret);
    my $wait  = 1;
    my $xwm   = Tkx::widget->new(".");
    my $popwm = $xwm->new_toplevel();

    $popwm->g_wm_title("$TITLE");
    $popwm->g_wm_minsize(200, 10);
    $popwm->g_wm_resizable(0, 0);

    my $back = $popwm->new_ttk__frame(-padding => "5 5 5 5");
    $back->g_grid(-column => 0, -row => 0, -sticky => "n");

    $popwm->g_grid_columnconfigure(0, -weight => 1);
    $popwm->g_grid_rowconfigure(0, -weight => 1);

    if ($NOTE !~ /^$/) {
        my $frm0 = $back->new_ttk__frame(-padding => 5);
        my $label = $frm0->new_ttk__label(-text => "$NOTE", -font => 'logo_font')->
                g_grid(-column => 0, -row => 0);
        $frm0->g_pack();
    }

    my $frm1 = $back->new_ttk__frame(-padding => 5);

    for my $x (0 .. $#buttons) {
        $butt[$x] = $frm1->new_ttk__button(
            -text      => "$buttons[$x]",
            -underline => 0,
            -command   => sub { $ret = "$buttons[$x]"; $wait = 0; }
        )->g_grid(-column => $x, -row => 0);
    }

    $frm1->g_pack();
    $popwm->g_wm_protocol(WM_DELETE_WINDOW => sub { $ret = "Exit"; $wait = 0; });    # Close Button returns "Exit"
    $popwm->g_bind('<Unmap>', sub { $popwm->g_wm_deiconify; $xwm->g_focus; });    # No minimizing to Icon Allowed

    while ($wait) {
        Tkx::update();
        $popwm->g_focus;
    }

    $popwm->g_destroy;

    return $ret;
} 
```

# java - Should I use @SuppressWarnings - Type safety: Unchecked cast from Object[] to T[]

> ID：15994290
> 
> 赞同：0
> 
> 时间：2013-04-14T00:08:12.927
> 
> 标签：java, warnings

Trying to make a growable array ie, an array whose capacity can increase like that of an arraylist. I get a warning in the code below. Should I fix it or suppress it ? What are the consequences of suppressing it ?

```
import java.util.*;

public class GrowableArray<T>{
  private T[] array;
  //more variables

GrowableArray{
  this.array = (T[]) new Object[10]; // Warning - Type safety: Unchecked cast 
                                     //from Object[] to T[]
  //more code

 }     

//more code 
```

**For full code look below -**

```
import java.util.*;  

public class GrowableArray<T>{  

    private T[] array;  
    private int increaseSizeBy;  
    private int currentIndex;//That is first free position available  
    private int lastIndex;  

    public GrowableArray(){       
        this.array = (T[]) new Object[10];  
        this.currentIndex = 0;  
        this.lastIndex = 10-1;  
        this.increaseSizeBy = 10;  
    }  

    public GrowableArray(int initialSize){  
        this.array = (T[]) new Object[initialSize];  
        currentIndex = 0;  
        lastIndex = initialSize - 1;  

    }  

    public void increaseSizeBy(int size){  
        this.increaseSizeBy = size;  

    }  

    public void add(T anObject){  

        if(currentIndex > lastIndex){ ;  
            //create a bigger array  
            int oldLength = array.length;  
            int newLength = oldLength + this.increaseSizeBy;  
            Object [] biggerArray = Arrays.copyOf(array, newLength);  
            array = (T[]) biggerArray;  
            currentIndex = oldLength;  
            lastIndex = array.length-1;  

        }else{  
            array[currentIndex] = anObject;  
            currentIndex++;  

        }  

    }  

    public void display(){  

        System.out.println();  

        for(int i = 0; i < this.currentIndex; i++){  
            System.out.print(array[i] + ", ");  

        }  

        System.out.println();  

    }  

    public static void main(String[]args){  

        GrowableArray<Integer> gArr = new GrowableArray<Integer>();  

        for(int i = 0; i <= 35; i++){  
            gArr.add(i);  

        }  

        gArr.display();  

        gArr.add(300);  
        gArr.add(301);  
        gArr.add(302);  
        gArr.add(303);  
        gArr.add(304);  
        gArr.add(305);  

        gArr.display();  

    }  

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:22:05.853

In Java 7 you can use varargs. No suppressing at all:

```
public class GrowableArray<T> {
  // Default empty to size 10.
  private static final int DefaultLength = 10;
  // My current array.
  private T[] array;

  // Empty constructor.
  GrowableArray () {
    // Passing no 2nd param at all forces jvm to manufacture an empty one for me - which is an array<T>.
    array = makeNew(DefaultLength);
  }

  // Make a new one of the right size.
  private T[] makeNew(int length, T... sample) {
    return Arrays.copyOf(sample, length);
  }
} 
```

# algorithm - 如何解锁宝库中的所有宝箱？

> ID：15994293
> 
> 赞同：11
> 
> 时间：2013-04-14T00:08:22.190
> 
> 标签：algorithm, dynamic-programming

在 Google Code Jam 中听到以下问题。现在比赛已经结束了，聊聊就好了[https://code.google.com/codejam/contest/2270488/dashboard#s=p3](https://code.google.com/codejam/contest/2270488/dashboard#s=p3)

> 按照一张旧地图，您偶然发现了恐怖海盗拉里的秘密宝库！
> 
> 宝库由 N 个上锁的箱子组成，每个箱子只能用特定类型的钥匙打开。而且，一旦钥匙被用来打开箱子，就再也不能使用了。在每个箱子里，你当然会发现很多宝藏，你可能还会发现一把或多把钥匙，可以用来打开其他箱子。一个箱子可能包含多个相同类型的钥匙，您可以持有任意数量的钥匙。
> 
> 您已经拥有至少一把钥匙，并且您的地图显示在各个箱子内还可以找到哪些其他钥匙。有了所有这些信息，你能弄清楚如何解锁所有的箱子吗？
> 
> 如果有多种打开所有箱子的方式，请选择“按字典顺序最小”的方式。

比赛有两个数据集，一个包含最多 20 个箱子的小数据集，一个包含最多 200 个箱子的大型数据集。

[我的回溯分支定界算法](https://github.com/matt-hickford/codejam/blob/master/2013/qualification/treasure/treasure.py)只够快解决小数据集。什么是更快的算法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-14T01:08:40.760

我不习惯算法比赛。我对这个问题有点不安：要在分支和绑定通用算法中切割分支，您需要了解您将拥有的一般输入。

基本上，我查看了小集合中提供的一些输入。在这组中发生的事情是，您最终会进入无法获得某种类型 t 的任何钥匙的路径：这种类型 t 的所有剩余钥匙都在具有相同类型 t 锁的箱子中。因此，您将无法再访问它们。

所以你可以建立以下切割标准：如果有一些类型为 t 的箱子要打开，如果所有剩余的类型为 t 的钥匙都在这些箱子里，如果你没有这种类型的钥匙，那么你不会在这个分支中找到解决方案。

您可以概括切割标准。考虑一个图，其中顶点是键类型，如果 t1 中仍然有一些封闭的箱子具有 t2 类型的键，则在 t1 和 t2 之间存在一条边。如果你有一些 t1 类型的钥匙，那么你可以打开一个这种类型的箱子，然后至少得到一把钥匙，可以从外边进入其中一个箱子。如果您遵循一条路径，那么您知道您可以在这条路径中打开至少一个每种锁类型的箱子。但是，如果没有通往顶点的路径，您知道您将无法打开由该顶点表示的箱子。

有切割算法。从您拥有的密钥的顶点集中计算所有可到达的顶点。如果有无法到达的顶点仍然是封闭的胸部，那么你切断分支。（这意味着你回溯）

这足以解决大集合。但我必须添加你写的第一个条件：

```
if any(required > keys_across_universe):
    return False 
```

否则，它就行不通了。这意味着当钥匙的数量非常接近箱子的数量时，我的解决方案很弱。

这种切割条件并不便宜。它实际上可能花费 O(N²)。但它削减了如此多的分支，它绝对值得……只要数据集很好。（公平的 ？）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T21:07:11.760

令人惊讶的是，这个问题可以通过贪心算法解决。我也将其实现为记忆深度优先搜索。直到后来我才注意到搜索从未回溯，并且没有命中记忆缓存。只需要对问题的状态和部分解决方案进行两次检查，就可以知道是否应该进一步追求特定的解决方案分支。它们很容易用一对例子来说明。

首先，考虑这个测试用例：

```
Chest Number  |  Key Type To Open Chest  |  Key Types Inside
--------------+--------------------------+------------------
1             |  2                       |  1
2             |  1                       |  1 1
3             |  1                       |  1
4             |  2                       |  1
5             |  2                       |  2

Initial keys: 1 1 2 
```

这里总共只有两把类型 2 的钥匙：一把在 5 号箱子里，一把在你最初拥有的地方。但是，*三个*箱子需要使用类型 2 的钥匙才能打开。我们需要比现有更多的这种类型的钥匙，所以显然不可能打开所有的箱子。我们立即知道这个问题是不可能的。我称这个键为“全局约束”。我们只需要检查一次。我看到这个检查已经在你的程序中了。

仅通过这个检查和记忆的深度优先搜索（就像你的一样！），我的程序能够解决这个小问题，尽管速度很慢：大约花了一分钟。知道程序无法在足够的时间内解决大输入，我从小集合中查看了测试用例。一些测试用例很快就解决了，而另一些则需要很长时间。这是程序花了很长时间才找到解决方案的测试用例之一：

```
Chest Number  |  Key Type To Open Chest  |  Key Types Inside
--------------+--------------------------+------------------
1             | 1                        | 1
2             | 6                        |
3             | 3                        |
4             | 1                        |
5             | 7                        | 7 
6             | 5                        | 
7             | 2                        |
8             | 10                       | 10
9             | 8                        | 
10            | 3                        | 3
11            | 9                        | 
12            | 7                        |
13            | 4                        | 4
14            | 6                        | 6
15            | 9                        | 9
16            | 5                        | 5
17            | 10                       |
18            | 2                        | 2
19            | 4                        |
20            | 8                        | 8

Initial keys: 1 2 3 4 5 6 7 8 9 10 
```

经过简单的检查，这个测试用例的结构是显而易见的。我们有 20 个箱子和 10 把钥匙。十种钥匙类型中的每一种都将打开两个箱子。在使用给定钥匙类型可打开的两个箱子中，一个包含另一个相同类型的钥匙，另一个根本不包含任何钥匙。解决方案很明显：对于每种类型的钥匙，我们必须首先打开将给我们另一把钥匙的箱子，以便能够打开同样需要该类型钥匙的第二个箱子。

该解决方案对人类来说是显而易见的，但是该程序需要很长时间才能解决它，因为它还没有任何方法来检测是否有任何无法再获取的密钥类型。“全局约束”涉及每种密钥的数量，而不是获取它们的顺序。这第二个约束关注的是可以获取密钥的顺序，而不是它们的数量。问题很简单：对于我需要的每种密钥类型，有什么方法我仍然可以得到它吗？

这是我为检查第二个约束而编写的代码：

```
# Verify that all needed key types may still be reachable
def still_possible(chests, keys, key_req, keys_inside):
    keys = set(keys)         # set of keys currently in my possession
    chests = chests.copy()   # set of not-yet-opened chests

    # key_req is a dictionary mapping chests to the required key type
    # keys_inside is a dict of Counters giving the keys inside each chest

    def openable(chest):
        return key_req[chest] in keys

    # As long as there are chests that can be opened, keep opening
    # those chests and take the keys.  Here the key is not consumed
    # when a chest is opened.
    openable_chests = filter(openable, chests)
    while openable_chests:
        for chest in openable_chests:
            keys |= set(keys_inside[chest])
            chests.remove(chest)
        openable_chests = filter(openable, chests)

    # If any chests remain unopened, then they are unreachable no 
    # matter what order chests are opened, and thus we've gotten into
    # a situation where no solution exists.
    return not chests   # true iff chests is empty 
```

如果此检查失败，我们可以立即中止搜索分支。执行此检查后，我的程序运行得非常快，需要 10 秒而不是 1 分钟。此外，我注意到缓存命中数下降到零，而且，搜索从未回溯。我删除了记忆并将程序从递归形式转换为迭代形式。然后，[Python 解决方案](https://github.com/tobin/codejam/blob/master/2013/treasure.py)能够在大约 1.5 秒内解决“大”测试输入。使用优化编译的几乎相同的[C++ 解决方案](https://github.com/tobin/codejam/blob/master/2013/treasure.cc)可在 0.25 秒内解决大量输入。

[在Google 官方](https://code.google.com/codejam/contest/2270488/dashboard#s=a&a=3)对该问题的分析中给出了这种迭代、贪心算法正确性的证明。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-14T01:14:00.017

我也无法解决这个问题。起初我的算法太慢了，然后我添加了一些增强功能，但我想我在其他方面失败了：

1.  正如 Valentin 所说，我计算了可用的密钥以快速丢弃棘手的情况

2.  第一次命中时试图忽略里面没有钥匙的箱子，跳到下一个

3.  从更高的箱子开始跳过解决方案

4.  检查“钥匙圈”，如果可用的钥匙不足以打开一个箱子（箱子里面有自己的钥匙）

性能很好（25 个小案例<2 秒），我手动检查了案例，它工作正常，但还是得到了不正确的答案：P

# angularjs - 如何在其他控制器中使用来自 $http 的数据

> ID：15994294
> 
> 赞同：0
> 
> 时间：2013-04-14T00:08:41.093
> 
> 标签：angularjs

如何在我设置的函数之外使用 totalResults？我只是不知道该怎么做，我需要使用从数据库中收集的 totalResults 并在另一个函数中使用来计算页面数量。我这样做是为了不将所有数据加载到客户端，但我仍然需要知道数据库表中的总行数。

**我的 json 看起来像：**

```
Object {total: 778, animals: Array[20]} 
```

**角度：**

```
var app = angular.module('app', []);

app.controller('AnimalController', ['$scope', 'animalSrc', function($scope, animalSrc)
{
    $scope.animals = [];

    var skip = 0;
    var take = 20;
    var totalResults = null;
    //$scope.totalResults = null;

    $scope.list = function()
    {
        animalSrc.getAll(skip, take, function(data) {
            $scope.animals = $scope.animals.concat(data.animals);

            // I need to be able to use this outside of function ($scope.list)
            totalResults = data.total;
            //$scope.totalResults = data.total;
        });
    };

    $scope.showMore = function()
    {
        skip += 20;
        $scope.list();
    };

    $scope.hasMore = function()
    {
        //
    };

    // Outputs null, should be the total rows from the $http request
    console.log(totalResults); 
}]);

app.factory('animalSrc', ['$http', function($http)
{
    // Private //

    return {
        getAll: function(skip, take, callback)
        {
            $http({
                method: 'GET',
                url: 'url' + skip + '/' + take
            }).
            success(function(data) {
                callback(data);
            }).
            error(function(data) {
                console.log('error: ' + data);
            });
        }
    };
}]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:42:44.613

这是我刚刚为自己编写的类似设置的样板，其中数据是一个需要拆分为多个范围项的对象。您没有掌握的问题是将数据存储在服务中，而不仅仅是使用服务来检索数据。然后通过注入服务，数据项可跨多个控制器和指令使用

```
app.run(function(MyDataService){
  MyDataService.init();
})

app.factory('MyDataService',function($http,$q){

  var myData = {
    deferreds:{},

    mainDataSchema:['count','items'],
    init:function(){
      angular.forEach(myData.mainDataSchema,function(val,idx){ 
        /* create deferreds and promises*/
        myData.deferreds[val]=$q.defer();
        myData[val]= myData.deferreds[val].promise
      });     
      /* load the data*/
      myData.loadData();

    },     

    loadData:function(){
         $http.get('data.json').success(function(response){
           /* create resolves for promises*/
           angular.forEach(myData.mainDataSchema,function(val,idx){            
             myData.deferreds[val].resolve(response[val]);
        });
       /* TODO -create rejects*/

      })

    }
  }

  return myData;

  })

app.controller('Ctrl_1', function($scope,MyDataService ) {
    $scope.count = MyDataService.count;
    $scope.items =MyDataService.items;
});

app.controller('Ctrl_2', function($scope,MyDataService ) {
  $scope.items =MyDataService.items;
  $scope.count = MyDataService.count;
}); 
```

[Plunker 演示](http://plunker.co/edit/hHJhs92hRkBjTwUYygRo?p=preview)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T00:45:14.120

你需要开始异步思考。您的 console.log 在 $http 返回并设置 totalResults 之前被调用。因此，totalResults 将始终为空。

您需要找到一些方法来延迟对console.log 的调用，以便在运行console.log 之前完成$http 调用。一种方法是将console.log 调用放在回调函数中，以便在$http 成功后肯定会调用它。

一个更优雅的方法是使用 Promise。angular.js 实现了 $q，它类似于一个 Promise 库 Q。

[http://docs.angularjs.org/api/ng.$q](http://docs.angularjs.org/api/ng.%24q)

您无需在 getAll 中创建回调函数，而是返回一个 Promise。在 $http success 中，您使用数据解决了 Promise。然后，在您的控制器中，您有一个在解决承诺时调用的函数。Promise 很好，因为它们可以被传递，并且它们允许您控制异步代码的流程而不会阻塞。

# java - 打印范围内的所有数字仅显示素数

> ID：15994297
> 
> 赞同：-1
> 
> 时间：2013-04-14T00:09:01.260
> 
> 标签：java

我已经为此工作了两天，完全没有运气。我需要我的程序打印用户给定的范围并显示该范围内的所有素数。所有非质数都应打印为“-”。我需要每行有 10 个数字，然后是 | 以及该行中的最后一个数字。它看起来像这样：

71 - 73 - - - - - 79 - | 80

我知道我需要使用 printf，但我不知道在哪里放置我的 print 语句或如何在开始新行之前停止 printf 语句停止在 10 个数字处。此外，我不知道如何在仍然使用 printf 的同时将非质数打印为“-”。每次我尝试它都会出错。这是用户输入他的数字后的代码：

```
for(d=start;d<end;d++) { 
        b=0; 
        for(c=1;c<=d;c++){ 
            if(d%c==0) 
                b=b+1;
        } 
        if(b==2){ 
            System.out.printf("%4d", d); 
            //prints prime numbers with the spacing required
            primes=primes+1;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:13:03.923

一种选择是制作一个计数器，当 counter%10==0 时，你打印一个新行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:17:46.290

我建议您将问题分解为较小的子问题。例如，打印出引物编号列表，无需担心格式或打印出给定范围内的数字，每行 10 个数字。在你弄清楚如何分别做这些之后，*然后*尝试将它们结合起来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T20:16:32.353

在我提出问题后不久就想通了，这是我使用的代码：

```
for(d=start;d<=end;d++) { 
        b=0; 
        for(c=1;c<=d;c++){ 
            if(d%c==0) 
                b=b+1;
        } 
        if(b==2){ 
            primes=primes+1;
            if(d!=start){
                System.out.printf("%4d", d);
            }
        }else{
            if(d!=start){
                System.out.printf("   -");
            }
        }
        if(d%10==0&&d!=start){
            System.out.printf(" | ");
            System.out.printf("%4d", d);
            System.out.println();
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-02T10:35:38.873

在 python 中尝试它给你一个启动点，考虑下面的代码，

```
def prime_display(n):
    for i in range(1, n+1):
        if is_prime(i) == True:
            print(i, end=' ')
        else:
            if divisible_by_10(i):
                print(f'- | {i}', end='\n')

            print('-', end=' ')

def divisible_by_10(n):
    if (n % 10) == 0:
        return True
    return False

def is_prime(n):
    if n > 1:
        for i in range(2, n):
            if (n % i) == 0:
                return False
        else:
                return True
    else:
        return False

prime_display(39) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-14T00:44:31.227

编译：gcc prime.c 运行（范围为 1-200）：./a.out 1 200

```
#include<stdio.h>
#include<math.h>
int isPrime(int n){
    if(n==1) return 0;
    int i=2;
    while(i<=sqrt(n))
        if(n%i++==0)
            return 0;
    return 1;
}
int main(int argc, char *argv[]){
    int a,b,count;
    if(argc<3)
        return 0;
    a=atoi(argv[1]);
    b=atoi(argv[2]);
    count=1;
    for(;a<=b;a++){
        if(isPrime(a)) printf("%d ",a);
        else printf("- ");
        if(count++==10){
            printf("| %d\n",a);
            count=1;
        }
    }
    return 0;
} 
```

# java - 从底部而不是顶部排列按钮？

> ID：15994310
> 
> 赞同：0
> 
> 时间：2013-04-14T00:11:24.433
> 
> 标签：java, android

我正在动态创建按钮。但问题是它们是从顶部创建的。我想从底部创建它。

```
public class MainActivity extends Activity implements View.OnClickListener {
    int i, j, butNum, lay1num = 1, lay2num = 100, lay3num = 100, store;
    Button[] Button;
    EditText numBut;
    LinearLayout mainLayout;
    LinearLayout[] subLayout;
    LinearLayout.LayoutParams params;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        butNum = 5;
        Button = new Button[butNum];
        subLayout = new LinearLayout[3];
        LinearLayout mainLayout = new LinearLayout(this);
        mainLayout.setOrientation(LinearLayout.HORIZONTAL);
        mainLayout.setWeightSum(90);
        mainLayout.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT,
                LayoutParams.MATCH_PARENT));
        layoutGen();

        for (j = 0; j < butNum; j++) {
            int value = j + 1;
            Button[j] = new Button(this);
            Button[j].setText("" + value);
            Button[j].setLayoutParams(new LayoutParams(
                    LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
            Button[j].setTextSize(20);
            Button[j].setTag(value);
            Button[j].setId(j);
            subLayout[0].addView(Button[j]);
            Button[j].setOnClickListener(this);
        }

        mainLayout.addView(subLayout[0], params);

        setContentView(mainLayout);
    } 
```

无论如何我可以创建与底部对齐的按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:21:15.517

```
subLayout.setGravity(Gravity.BOTTOM); 
```

您不需要将布局大小设置为 match_parent。

最终你可以设置一个 layout_gravity 像[这里](https://stackoverflow.com/questions/8049620/how-to-set-layout-gravity-programmaticaly)

# branch - OCaml 分支信息

> ID：15994311
> 
> 赞同：7
> 
> 时间：2013-04-14T00:11:38.007
> 
> 标签：branch, ocaml

[在http://caml.inria.fr/cgi-bin/viewvc.cgi/ocaml/branches/](http://caml.inria.fr/cgi-bin/viewvc.cgi/ocaml/branches/)中有很多有趣的 OCaml 分支。不过，我似乎找不到任何关于这些功能的好信息。他们不想公开吗？例如，README 文件在所有分支中都是相同的。如何找到有关它们的更多信息（只是谷歌搜索无济于事）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T05:40:42.783

以下是一些关于一些更主要的分支的信息（可以通过 OPAM 安装的那些——http : [//opam.ocamlpro.com](http://opam.ocamlpro.com)）：

```
4.00.1+short-types  C 4.00.1+short-types         Better heuristic to display long type names
--                 -- 3.11.2                     Official 3.11.2 release
--                 -- 3.12.1                     Official 3.12.1 release
--                 -- 4.00.0                     Official 4.00.0 release
--                 -- 4.00.1                     Official 4.00.1 release
--                 -- 3.12.1+mirage-unix-direct  Mirage compiler for unix
--                 -- 3.12.1+mirage-xen          Mirage compiler for xen
--                 -- 3.12.1+natdynlink-osx      Support for native dynlink on OSX
--                 -- 4.00.0+debug-runtime       Debug runtime
--                 -- 4.00.0+fp                  Runtime with frame-pointers (improved GDB & perf usage)
--                 -- 4.00.0+raspberrypi         Native backend for Raspberry-PI
--                 -- 4.00.1+BER                 BER MetaOCaml (http://okmij.org/ftp/ML/MetaOCaml.html)
--                 -- 4.00.1+alloc-profiling     support allocation profiling on x86_64
--                 -- 4.00.1+annot               Enable -binannot by default
--                 -- 4.00.1+french              French translation of error messages
--                 -- 4.00.1+mirage-unix         Mirage compiler for unix
--                 -- 4.00.1+mirage-xen          Mirage compiler for xen
--                 -- 4.00.1+open-types          add open extensible types to OCaml
--                 -- 4.00.1+raspberrypi         Native backend for Raspberry-PI
--                 -- 4.01.0dev+endian           Improved low-level integer primitive access
--                 -- 4.01.0dev+mirage-unix      UNIX tuntap backend for Mirage
--                 -- 4.01.0dev+mirage-xen       Xen unikernel builds for Mirage
--                 -- 4.01.0dev+short-paths      latest trunk snapshot with short type names
--                 -- 4.01.0dev+trunk            latest trunk snapshot 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T02:44:20.593

[您可以尝试通过以下方式向 OCaml 维护人员发送电子邮件：caml@inria.fr，或在OCaml 论坛](http://caml.inria.fr/resources/forums.en.html)中发布有关分支的问题。每个分支的修订日志也可以提供一些关于每个分支的用途的线索。

# jquery - jQuery 手风琴宽度 - firefox

> ID：15994314
> 
> 赞同：0
> 
> 时间：2013-04-14T00:11:58.260
> 
> 标签：jquery, wordpress, firefox

我的 jquery 手风琴 (100%) 的容器的全宽适用于除 Firefox 之外的所有浏览器。我已经尝试添加“重要”来防止这种情况，但是 firefox 是迄今为止唯一拒绝全宽度的浏览器

请问有人可以帮助我吗？

谢谢

```
/* Vertical Accordion Style */

.container {
        width:100% !important;
        position:relative;
        margin:40px auto 0 auto;
        top: -17px;
        left: 0px;
}

.va-wrapper{
    width:100%;
    height:100%;
    position:relative;
    overflow:hidden;
    background:#000;
        left: 0px;
}
.va-slice{
    cursor:pointer;
    position:absolute;
    width:100%;
    left:0px;
    overflow:hidden;
}
.va-slice-1{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/Airfreight10.png) no-repeat center center;
}
.va-slice-2{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/Seafreight2.png) no-repeat center center;
}
.va-slice-3{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/Satellite.png) no-repeat center center;
}
.va-slice-4{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/Guarding11.png) no-repeat center center;
}
.va-slice-5{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/Move3.png) no-repeat center center;
}
.va-slice-6{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/Investigations2.png) no-repeat center center;
}
.va-slice-7{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/transport2.png) no-repeat center center;
}
.va-slice-color-1{
    background-color:#97c5eb;
}
.va-slice-color-2{
    background-color:#68ace5;
}
.va-slice-color-3{
    background-color:#0072cf;
}
.va-slice-color-4{
    background-color:#0039a6;
}
.va-slice-color-5{
    background-color:#00338e;
}
.va-slice-color-6{
    background-color:#002c76;
}
.va-slice-color-7{
    background-color:#002144;
}
.va-title{
    font-family: 'Open Sans Condensed', sans-serif;
    text-transform:uppercase;
    font-size:40px;
    margin-left:20px;
    color:#fff;
    text-shadow: 0px 0px 1px white;
}
.va-content{
    display:none;
    margin-left:25px;

}
.va-slice p{
    font-size: 22px;
    font-style: italic;
    font-family:Georgia, serif;
}
.va-slice ul{
    margin-top:20px;
}
.va-slice ul li{
    float:left;
    margin:0px 2px;
}
.va-slice ul li a{
    color:#000;
    background:#eede2f;
    padding:3px 6px;
    font-size:14px;
    font-family:'PT Sans', sans-serif;
    text-transform:uppercase;
}
.va-slice ul li a:hover{
    background:#000;
    color:#fff;
    text-shadow:none;
}
.va-nav span{
    width:40px;
    height:25px;
    background:transparent url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/prev.png) no-repeat center center;
    position:absolute;
    top:-35px;
    left:50%;
    margin-left:-20px;
    text-indent:-9000px;
    opacity:0.7;
    cursor:pointer;

    z-index:100;
}
.va-nav span.va-nav-next{
    background-image:url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/next.png);
    top:auto;
    bottom:-35px;
}
.va-nav span:hover{
    opacity:1.0;
}

/* End Additional CSS Styles */ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:28:02.250

我找到了一个解决方案 - 以防其他人有这个问题：

“位置：绝对”

```
.va-wrapper{
    width:100%;
    height:100%;
    position:absolute;
    overflow:hidden;
    background:#000;
        left: 0px;
} 
```

# jquery - jquery输入val不工作

> ID：15994315
> 
> 赞同：0
> 
> 时间：2013-04-14T00:12:14.960
> 
> 标签：jquery

我正在尝试使用变量传递的值设置“输入文本”，但我不能。

html和js如下：

JS：

```
function clique_mapa(latlng) {        
    var value1_lat = $('#antena01_lat').val();
    var value1_log = $('#antena01_log').val();

    var value2_lat = $('#antena02_lat').val();
    var value2_log = $('#antena02_log').val();

    if (typeof value1_lat == 'undefined') {
        $('input[name=antena01_lat]').val(value1_lat);
        $('input[name=antena01_log]').val(value1_log);                        
    }
}; 
```

html:

```
<div class="coluna menu">
    Latitude<br />
    <input type="text" name="antena01_lat"/> <br />
    Longitude<br />
    <input type="text" name="antena01_log"/> <br /><br />    

    <input type="button" id="clique_mapa" name="clique_mapa" value="Abrir mapa" />
</div> 
```

tks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:30:49.077

您需要为您的输入分配一个 id

```
<input type="text" name="antena01_lat" id="antena01_lat"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T00:15:43.770

你有

```
if (typeof value1_lat == 'undefined') 
```

这不应该是

```
if (typeof value1_lat != 'undefined') 
```

# clojure - Clojure 头部保留

> ID：15994316
> 
> 赞同：29
> 
> 时间：2013-04-14T00:12:15.507
> 
> 标签：clojure, functional-programming, jvm, lisp

我正在阅读 O'Reilly 的 Clojure Programming 一书。

我遇到了一个头部保留的例子。第一个示例保留对`d`（我认为）的引用，因此不会收集垃圾：

```
(let [[t d] (split-with #(< % 12) (range 1e8))]
    [(count d) (count t)])
;= #<OutOfMemoryError java.lang.OutOfMemoryError: Java heap space> 
```

虽然第二个示例没有保留它，但它没有问题：

```
(let [[t d] (split-with #(< % 12) (range 1e8))]
    [(count t) (count d)])
;= [12 99999988] 
```

我在这里没有得到的是在这种情况下究竟保留了什么以及为什么保留。如果我尝试返回 just `[(count d)]`，如下所示：

```
(let [[t d] (split-with #(< % 12) (range 1e8))]
    [(count d)]) 
```

它似乎产生了同样的内存问题。

此外，我记得读过`count`在每种情况下都实现/评估一个序列。所以，我需要澄清一下。

如果我尝试先返回`(count t)`，与根本不返回相比，这如何更快/更节省内存？在这种情况下保留什么以及为什么保留？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-14T02:47:48.870

在第一个和最后一个示例中，传递给的原始序列`split-with`被保留，同时在内存中完全实现；因此OOME。这种情况发生的方式是间接的；直接保留的是`t`，而原始序列被`t`一个惰性序列保持*在其未实现状态*。

保持原始序列的方式`t`如下。在实现之前，`t`是一个`LazySeq`对象，它存储了一个 thunk，可以在某些时候调用它来实现`t`；这个 thunk 需要存储一个指向原始序列参数的指针，`split-with`然后才能将其传递给`take-while`- 请参阅`split-with`. 一旦`t`实现，thunk 将有资格进行 GC（对象中保存它的字段`LazySeq`设置为`null`），`t`不再持有巨大输入序列的头部。

输入 seq 本身完全由`(count d)`需要实现的 实现`d`，因此是原始输入 seq。

继续讨论为什么`t`要保留：

在第一种情况下，这是因为`(count d)`在 之前进行了评估`(count t)`。由于 Clojure 从左到右评估这些表达式，本地`t`需要等待第二次调用 count，并且由于它碰巧持有一个巨大的 seq（如上所述），这导致了 OOME。

理想情况下，返回only 的最后一个示例`(count d)`不应保留`t`; 不是这种情况的原因有些微妙，最好通过参考第二个示例来解释。

第二个例子恰好可以正常工作，因为 after`(count t)`被评估，`t`不再需要。Clojure 编译器注意到了这一点，并使用了一个巧妙的技巧让本地重置为与进行调用`nil`同时进行。`count`Java 代码的关键部分执行类似的操作`f(t, t=null)`，以便将 的当前值`t`传递给适当的函数，但在将控制权移交给 之前清除本地值，因为这是作为参数`f`的表达式的副作用发生的; 很明显，Java 从左到右的语义是这项工作的关键。`t=null``f`

回到最后一个例子，这是行不通的，因为`t`它实际上并没有在任何地方使用，并且未使用的局部变量不会由局部变量清除过程处理。（清除发生在最后使用点；如果程序中没有这样的点，则没有清除。）

至于`count`实现惰性序列：它必须这样做，因为没有一般的方法可以在没有意识到的情况下预测惰性序列的长度。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-02-15T21:18:34.333

@Michał Marczyk 的回答虽然正确，但有点难以理解。我发现[Google Groups 上的这篇文章](https://groups.google.com/d/msg/clojure/bTAYeLXc25w/gBKY2GWGUoQJ)更容易掌握。

我是这样理解的：

**第 1 步**创建惰性序列：`(range 1e8)`. 值尚未实现，我将它们标记为星号 ( `*`)：

```
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * ... * * * 
```

**步骤 2**创建另外两个惰性序列，它们是“窗口”，您可以通过它们查看原始的巨大惰性序列。第一个窗口仅包含 12 个元素 ( `t`)，另一个是其余元素 ( `d`)：

```
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * ... * * *
t t t t t t t t t t t t t d d d d d d d d d d d d d d d d d ... d d d 
```

**第 3 步 - 内存不足场景**- 您评估`[(count d) (count t)]`。因此，首先计算 中的元素`d`，然后计算 中的元素`t`。将会发生的是，您将从 的第一个元素开始遍历所有值`d`并实现它们（标记为`!`）：

```
* * * * * * * * * * * * * ! * * * * * * * * * * * * * * * * ... * * *
t t t t t t t t t t t t t d d d d d d d d d d d d d d d d d ... d d d 
                          ^
                         start here and move right ->

* * * * * * * * * * * * * ! ! * * * * * * * * * * * * * * * ... * * *
t t t t t t t t t t t t t d d d d d d d d d d d d d d d d d ... d d d 
                            ^

* * * * * * * * * * * * * ! ! ! * * * * * * * * * * * * * * ... * * *
t t t t t t t t t t t t t d d d d d d d d d d d d d d d d d ... d d d 
                              ^

                     ...

; this is theoretical end of counting process which will never happen
; because of OutOfMemoryError
* * * * * * * * * * * * * ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ... ! ! !
t t t t t t t t t t t t t d d d d d d d d d d d d d d d d d ... d d d 
                                                                    ^ 
```

问题是所有已实现的值 ( `!`) 都被保留了，因为仍然需要集合的头部（前 12 个元素）——我们仍然需要评估`(count t)`。这会消耗大量内存，导致 JVM 崩溃。

**第 3 步 - 有效场景**- 这次您进行评估`[(count t) (count d)]`。所以我们首先要计算较小的**头部**序列中的元素：

```
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * ... * * *
t t t t t t t t t t t t t d d d d d d d d d d d d d d d d d ... d d d 
^
start here and move right ->

                        ! * * * * * * * * * * * * * * * * * ... * * *
t t t t t t t t t t t t t d d d d d d d d d d d d d d d d d ... d d d 
                        ^ 
```

`d`然后，我们按顺序计算元素。编译器知道`t`不再需要来自的元素，因此它可以垃圾收集它们以释放内存：

```
 ! * * * * * * * * * * * * * * * * ... * * *
t t t t t t t t t t t t t d d d d d d d d d d d d d d d d d ... d d d 
                          ^

                            ! * * * * * * * * * * * * * * * ... * * *
t t t t t t t t t t t t t d d d d d d d d d d d d d d d d d ... d d d 
                            ^

                     ...

                                                            ...     !
t t t t t t t t t t t t t d d d d d d d d d d d d d d d d d ... d d d 
                                                                    ^ 
```

现在我们可以看到，因为`t`不再需要 from 的元素，编译器能够在经过大序列时清除内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-08T09:58:00.830

最后一个例子的一个重要补充：

```
(let [[t d] (split-with #(< % 12) (range 1e8))]
    [(count d)]) 
```

> 回到最后一个例子，这是行不通的，因为 t 实际上并没有在任何地方使用，并且未使用的局部变量不会由局部变量清除过程处理。

现在不是这样了。由于 Clojure 1.9 未使用的解构局部变量被清除。有关详细信息，请参阅[CLJ-1744 。](https://clojure.atlassian.net/browse/CLJ-1744)

# css - 在jade中使用“style='foo'”修改伪元素“:before”相关的css

> ID：15994318
> 
> 赞同：0
> 
> 时间：2013-04-14T00:12:40.493
> 
> 标签：css, pug, stylus

编辑：我试图实施 user1737909 的建议。使用类（即，`.pie.size-{size}:BEFORE`）而不是属性选择器（即，`.pie[data-value={size}]:BEFORE`）已经让我通过了第一步，并且不会阻止加载 .css 文件。不幸的是，由于难以将字符串连接到手写笔中的变量，我无法设置旋转量。以下都不起作用。什么是正确的语法？

```
transform rotate(size+1+'deg')

transform rotate({size}+1+'deg')

foo = size+1+'deg'
transform rotate(foo)

bar = 'rotate('+size+1+'deg)'
transform bar
-webkit-transform bar 
```

如果做不到这一点，是否有人对制作 css/html 仪表有任何想法？

* * *

我正在 CSS 中制作一个径向仪表，它将显示在 mixin 中的每个帖子上。我以[这段代码](http://codepen.io/AtomicNoggin/pen/fEish)在 CSS 中制作饼图为例。设置饼图楔形的值就像更改以下代码中的“数据值”一样简单：

```
<div class="pie" data-start="0" data-value="30"></div> 
```

不幸的是，代码对应于静态 css：

```
.pie[data-value="30"]:BEFORE {
    -moz-transform: rotate(31deg); /* Firefox */
    -ms-transform: rotate(31deg); /* IE */
    -webkit-transform: rotate(31deg); /* Safari and Chrome */
    -o-transform: rotate(31deg); /* Opera */
    transform:rotate(31deg);
} 
```

这适用于静态插图，但我的页面将有各种不同大小的楔形。最简单的解决方案是为所有 360 度创建新条目，但这似乎是一个糟糕的主意。

我的想法是在我设置“数据值”的同时为翡翠混合中的每个仪表定义样式。就像是：

```
pieStyle = '-moz-tranform: rotate('+ degreesPlusOne + 'deg); -ms-tranform: rotate('+ degreesPlusOne + 'deg); -o-tranform: rotate('+ degreesPlusOne + 'deg); -webkit-tranform: rotate('+ degreesPlusOne + 'deg); tranform: rotate('+ degreesPlusOne + 'deg)'

.pie2(data-start='0', data-value=degrees, style=pieStyle) 
```

不幸的是，要设置的样式不是'.pie'，而是'.pie:BEFORE'。有什么方法可以在 mixin 中使用这个伪元素设置样式吗？

或者有没有办法在手写笔中解决这个问题？我正在开发的网站是一个新闻聚合器，任何用户都会看到几十个甚至上百个这样的仪表。在这样的环境中，我会在不太长的时间内将所有 360 集作为 css 的一部分简单地传输并在将来在缓存中引用它们会更好吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T10:13:39.320

你绝对可以用手写笔做到这一点

```
for size in 30 60 180 360
  .pie.size-{size}
    transform: rotate(size+1) 
```

使用笔尖，`transform`将有其所有前缀:)。

# vb.net - 使用 VB 应用程序从记事本中读取行并提交信息

> ID：15994319
> 
> 赞同：1
> 
> 时间：2013-04-14T00:12:42.400
> 
> 标签：vb.net, browser, refresh, notepad

因此，我最近创建了一个脚本，可以登录到各种网站，例如 Twitter、Xbox、YouTube，它会检查“用户名”何时被释放。这些社交网络服务中的大多数在这么久之后，都会删除不活跃的帐户并允许这些帐户被认领。所以用户名为“John391”的用户只要处于非活动状态就可以获得用户名“John”，然后网络将释放它。所以我的脚本登录到这些网站，并允许您在文本框中输入您想要的用户名，然后单击提交。该程序不断尝试在它可用时声明它。但是，我不想使用文本框，而是想使用带有列表的记事本，就像这样：

```
John
Achilles
Richard
Logan 
```

所以在它试图认领 John 之后（如果 John 仍然不可用），然后它会去 Achilles 等等。到目前为止，这是我的脚本，我有一个计时器和一个按钮来完成大部分工作。计时器用于不断检查文本框值中的内容，而按钮只是启动该过程。我还必须提到，当我第一次开始这样做时，我的程序继续超时，我发现解决这个问题的唯一方法是暂停声明并刷新页面，但这很好。无论如何，让我解释一下我的脚本：

```
 Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick

    If Not number_of_ticks > NumericUpDown1.Value Then
        number_of_ticks += 1
        If ((WebBrowser1.IsBusy)) Then
        Else
            If WebBrowser1.Url.ToString = "https://live.xbox.com/en-US/ChangeGamertag" Then

                WebBrowser1.Document.GetElementById("NewGamertag").SetAttribute("value", txtTurbo.Text)

                WebBrowser1.Document.GetElementById("claimIt").InvokeMember("Click")
            Else

                WebBrowser1.Navigate("https://live.xbox.com/en-US/ChangeGamertag")

            End If
        End If

    Else
        'number_of_ticks has exceed the maximum amount of allowed ticks
        Timer1.Enabled = False
        WebBrowser1.Refresh()

        number_of_ticks = 0
        Timer1.Enabled = True

    End If

End Sub 
```

正如您在此处看到的计时器，它检查 number_of_ticks 以确定页面何时刷新。这也是由使用该程序的人设置的。通常它是 250，所以它会尝试直到 250，然后刷新。它也有一点保护，我注意到如果它试图在页面未加载时声明它会使程序无响应，所以我抛出了几个 if 语句来解决这个问题。当然，该按钮仅具有启用计时器工作的命令和一些其他次要功能。

现在，我想要做的是，而不是使用文本框 txtTurbo 来允许一遍又一遍地声明，我想要一个记事本来列出要声明的内容。所以我知道这个值会以某种方式改变：

```
WebBrowser1.Document.GetElementById("NewGamertag").SetAttribute("value", txtTurbo.Text) 
```

它将被制成流式传输记事本/txt文件以读取要声明的文件，并且在每次声明后它应该更改为记事本/txt文件的下一行。但是，我没有阅读文本文件的经验，直到大约一个月前我才知道这是可能的。我想知道是否有人可以引导我朝着正确的方向前进？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:04:44.353

如果您尝试从文本文件中读取，这是一个好方法。我创建了 4 个不同的字符串 (val1-4)，并读取了我制作的测试文本文件 (Testt.txt) 中的所有行。然后将文本文件的值赋给相应的字符串

```
Dim val1 As String
Dim val2 As String
Dim val3 As String
Dim val4 As String

Dim lines = System.IO.File.ReadAllLines("C:/testt.txt")
val1 = lines(0)
val2 = lines(1)
val3 = lines(2)
val4 = lines(3) 
```

在您的情况下 val1 将等于**John**， val2 将等于**Achilles**等等。

# python - 与加密混淆

> ID：15994320
> 
> 赞同：-2
> 
> 时间：2013-04-14T00:12:45.100
> 
> 标签：python

我正在尝试编写一个程序，该程序以随机​​顺序生成一个从 1 到 26 的数字列表，然后使用该列表“加密”给定的单词，以便将字母表的第 n 个字母映射到第 n 个随机列表中的数字。例子：

随机列表是：

```
[8,2,25,17,6,9,12,19,21,20,18,3,15,1,11,0,23,14,4,7,24,5,10,13,16,22] 
```

这意味着单词`act`变成`[8,25,7]`，单词`xyzzy`变成`[13,16,22,22,16]`。

我有以下代码，但我不确定如何继续：

```
#8a
def randomalpha():
    a=[0]*26
    count = 0
    while count < 25:
        r = randrange(0,26)
        if r not in a:
            a[count] = r
            count += 1
    return(a)
print(f())
#8b
ls=['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z']
def encrypt(alphabet):
    a=randomalpha()
    count=0
    b=input('enter a word')
    for i in b:               #not sure if i am ok up to here but this is when i got really confused 

print(encrypt(ls)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:38:52.557

我的看法：

```
from string import ascii_lowercase
from random import shuffle

def char2num(chars):
    r = range(len(chars))
    shuffle(r)
    return dict(zip(chars, r))

def encrypt(s, lookup):
    return ' '.join(str(lookup[ch]) for ch in s)

print encrypt('cat', char2num(ascii_lowercase)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:25:35.373

```
import random
import string

def randomalpha():
    nums, result = range(26), [] # [0, 1, 2, 3, ... --> 25]
    random.shuffle(nums)
    for i in range(26):
        result.append(nums.pop())
    return result

def encrypt(s):
    alphabet = list(string.lowercase) # ['a', 'b', 'c', ... --> 'z']
    key = dict(zip(alphabet, randomalpha()))
    return ''.join([str(key[ltr]) for ltr in s]) 
```

参考：

*   [字典 ( `{'a': 1, 'b': 2, ... --> 'z': 26}`)](http://docs.python.org/2/tutorial/datastructures.html#dictionaries)
*   [列出理解 ( `\[elem for elem in iterable\]`)](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)
*   [`string.join(iterable)`](http://docs.python.org/2/library/stdtypes.html#str.join)
*   [`zip(*iterables)`( `zip(\['a', 'b', 'c'\], \[1, 2, 3\])`=> `\[('a', 1), ('b', 2), ('c', 3)]`)](http://docs.python.org/2/library/functions.html?highlight=zip#zip)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-05T19:13:51.003

由于今天提出的这个问题而在此处添加此内容：[将数字分配给字母表的最简单方法？](https://stackoverflow.com/questions/57811534/easiest-way-to-assign-a-number-to-the-alphabet)

```
 import random, string
    alpha = list(string.ascii_lowercase)
    numLst = list()
    while len(numLst) != 26:
        num = random.randint(1,26)
        if (num not in numLst):
            numLst.append(num) 
```

现在您所要做的就是索引列表以获取字母和相应的唯一随机数。例如 alpha[0] 为您提供“a”，而 numLst[0] 将为您提供相应的唯一编号。

# c# - N 层应用程序配置检索/存储

> ID：15994324
> 
> 赞同：0
> 
> 时间：2013-04-14T00:13:17.197
> 
> 标签：c#, asp.net-mvc, domain-driven-design, n-tier-architecture

在使用 ASP.NET MVC (C#) 开发我的网站时，我使用了域驱动设计 (N-Tier) 作为架构。

我想知道如何为我的应用程序创建设置/配置（不使用数据库表）。

我首先想到了 .settings 文件，但我仍然不确定这是否是正确的方法（例如，它应该放在哪里？）。因此，我在 web.config 中添加了配置值，然后在核心层中创建了一个 t4 模板，该模板从 web.config 生成 AppConfigurationManager，以免破坏 DDD 设计。

我仍然认为我使用了一种不好的方法。

那么，在处理领域驱动设计时，您建议如何保存配置？

我的 t4 模板（以防它有助于理解）：

```
<#@ template debug="false" hostspecific="true" language="C#" #>
<#@ output extension=".cs" #>
<#@ assembly Name="System.Configuration" #>
<#@ assembly name="System.Xml" #>
<#@ assembly name="System.Linq" #>
<#@ assembly name="System.Collections" #>
<#@ assembly name="System.Xml.Linq" #>
<#@ assembly name="System.Net" #>
<#@ assembly name="System" #>
<#@ import namespace="System.Configuration" #>
<#@ import namespace="System.Xml" #>
<#@ import namespace="System.Net" #>
<#@ import namespace="Microsoft.VisualStudio.TextTemplating" #>
<#@ import namespace="System.Xml.Linq" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Collections" #>
<#@ import namespace="System.Collections.Generic" #>
// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
using System;
using System.Configuration;

namespace KNadlan.Core.Configuration
{
    public partial class AppConfigurationManager
    {
        <#
        string path = @"C:\Visual Studio 2012\Projects\MyApp\MyApp.Web.UI\Web.config";
        string configNamespace = "myapp";

        var xDocument = XDocument.Load(path);
        var results =   xDocument.Descendants("appSettings");

        foreach (var xElement in results.Descendants())
        {
            string origKeyName = xElement.Attribute("key").Value.Trim();
            string keyName = origKeyName;

            /* Skip on third-party configurations */
            if (!string.IsNullOrEmpty(configNamespace))
            {
                if (!keyName.StartsWith(string.Format("{0}:", configNamespace)))
                {
                    continue;
                }

                keyName = keyName.Substring(string.Format("{0}:", configNamespace).Length);
            }

            /* Valid key? */
            if (!System.Text.RegularExpressions.Regex.IsMatch(keyName, @"^([a-zA-Z0-9]+)$", System.Text.RegularExpressions.RegexOptions.Compiled | System.Text.RegularExpressions.RegexOptions.IgnoreCase))
            {
                continue;
            }

            /* Format field and property names */
            string fieldName = "_" + keyName.Substring(0, 1).ToLower() + keyName.Substring(1);
            string propertyName = keyName.Substring(0, 1).ToUpper() + keyName.Substring(1);
            #>

        #region <#= propertyName #>

        private static string <#= fieldName #> = ConfigurationManager.AppSettings["<#= origKeyName #>"];
        public static string <#= propertyName #>
        {
            get { return <#= fieldName #>; }
            set
            {
                <#= fieldName #> = value;
                ConfigurationManager.AppSettings["<#= origKeyName #>"] = value;
            }
        }

        #endregion
        <#
        }
        #>
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T10:43:29.617

从域层访问配置有时适用于**域服务**，但它会使服务难以单独测试。

顺便说一句，您应该避免从实体和值对象进行此类访问。

更好的方法是读取基础设施层中的配置，并通过域对象中的构造函数参数注入所需的值。请注意，工厂和存储库是基础架构的一部分，因此如果需要，它们可以访问此类配置。

最后一个重要的注意事项，出于经验：**保持配置尽可能小**。在 .NET 中，该`.config`文件是配置的最佳位置，因为它是开发人员已经接受过培训的地方。但在企业应用程序中，它们可能会变得不受控制，因为每个开发人员都希望编写灵活的组件。这是一种糟糕的架构的味道：只将您**知道**将用于不同配置的可配置。

稍后在实际需要时添加配置部分比删除在每次部署时剪切和粘贴的部分更容易。此类配置可能会过度设计以获得他们不需要的灵活性。

# javascript - 通过 tan 从比率中获取度数

> ID：15994325
> 
> 赞同：1
> 
> 时间：2013-04-14T00:13:42.310
> 
> 标签：javascript, math, trigonometry, angle

我想在JS中得到一个三角形的角度。

在计算相反/相邻之后，如何用 Tangent 得出角度的度数？

![TAN 公式](https://i.stack.imgur.com/F1HMt.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T00:21:54.847

```
degrees = Math.atan(a/b) * 180 / Math.PI; 
```

一定要验证 b... 如果它为 0，可能会发生坏事。

参考文献：[Math.atan](http://www.w3schools.com/jsref/jsref_atan.asp)，[Math.PI](http://www.w3schools.com/js/js_obj_math.asp)

# javascript - 单击 iframe 中的链接完全没有效果

> ID：15994328
> 
> 赞同：3
> 
> 时间：2013-04-14T00:14:13.197
> 
> 标签：javascript, html

在谷歌浏览器中，我注意到点击一些链接似乎根本没有效果：

```
<a href="http://google.com">clicking this link does nothing at all.</a> 
```

这是一个[JSBin](http://jsbin.com/epileg/1/edit)和一个[JSFiddle](http://jsfiddle.net/WQhbe/)。

这是正常的，还是表明最新版本的 Google Chrome 存在某种错误？我以前从来没有遇到过这个问题，像这样的链接过去对我来说很好用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T00:16:13.100

如果您查看开发者控制台，您将看到以下内容：

`Refused to display 'https://www.google.com/' in a frame because it set 'X-Frame-Options' to 'SAMEORIGIN'.`

请参阅[https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options](https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-04-14T00:22:02.413

这是因为您无法在 iframe 中显示外部页面。这是一个浏览器限制，主要是出于安全原因

# opengl - 基于平铺剔除概念问题的延迟渲染

> ID：15994332
> 
> 赞同：9
> 
> 时间：2013-04-14T00:14:36.573
> 
> 标签：opengl, lighting, culling, deferred-rendering, deferred-shading

**编辑：**我仍在寻找有关使用 OpenCL 或计算着色器的帮助。我宁愿继续使用 OGL 3.3 而不必处理对 OGL 4.3 和 OpenCL 1.2 的不良驱动程序支持，但无论如何我都想不出在不使用两者之一的情况下进行这种类型的着色（匹配灯光和瓷砖）。是否可以在不使用 GPGPU 的情况下实现基于切片的剔除？

我在 OpenGL 3.3 中编写了一个延迟渲染。现在我不对灯光通道进行任何剔除（我只是为每个灯光渲染一个全屏四边形）。这（显然）有大量透支。（有时约为 100%）。正因为如此，我一直在寻找在光通过期间提高性能的方法。似乎（几乎）每个人都认为最好的方法是使用屏幕空间图块来剔除场景。这是 Frostbite 2 中使用的方法。我在 SIGGRAPH 2010 期间阅读了 Andrew Lauritzen 的演示文稿（[http://download-software.intel.com/sites/default/files/m/d/4/1/d/8 /lauritzen_deferred_shading_siggraph_2010.pdf](http://download-software.intel.com/sites/default/files/m/d/4/1/d/8/lauritzen_deferred_shading_siggraph_2010.pdf)），我不确定我是否完全理解这个概念。（就此而言，为什么它比其他任何东西都好，如果它对我更好）

在演示文稿中，Laurtizen 使用光量、四边形和瓷砖来筛选场景，介绍了延迟着色。根据他的数据，基于图块的延迟渲染器是最快的（到目前为止）。我不明白为什么会这样。我猜这与每个瓷砖的所有灯光都集中在一起这一事实有关。在演示文稿中，它说读取 G-Buffer 一次然后计算光照，但这对我来说没有意义。在我看来，我会这样实现：

```
for each tile {
  for each light effecting the tile {
    render quad (the tile) and compute lighting
    blend with previous tiles (GL_ONE, GL_ONE)
  }
} 
```

这仍然需要对 G-Buffer 进行大量采样。我认为这样做与为每个灯光渲染屏幕对齐的四边形具有相同（如果不是更差）的性能。不过，从它的措辞来看，似乎是这样的：

```
for each tile {
 render quad (the tile) and compute all lights
} 
```

但我看不出如何在不超过某些 GPU 上片段着色器的指令限制的情况下做到这一点。谁能帮我这个？似乎几乎每个基于 tile 的延迟渲染器都使用计算着色器或 OpenCL（批处理灯光），为什么会这样，如果我不使用这些会发生什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T00:44:36.210

> 但我看不出如何在不超过某些 GPU 上片段着色器的指令限制的情况下做到这一点。

这取决于你有多少灯。“指令限制”非常高；在退化的情况下，这通常不是您需要担心的事情。即使 100 多个灯影响一个图块，您的照明计算也不会超过指令限制的可能性相当大。

现代 GL 3.3 硬件可以在片段着色器中运行至少 65536 条动态指令，甚至可能更多。对于 100 盏灯，仍然是*每盏*灯 655 条指令。即使您使用 2000 条指令来计算相机空间位置，仍然会为每盏灯留下 635 条指令。即使您直接在 GPU 中执行 Cook-Torrance，这也可能已经足够了。

# visual-studio - Visual Studio 2012：脚本诊断权限

> ID：15994340
> 
> 赞同：6
> 
> 时间：2013-04-14T00:16:02.063
> 
> 标签：visual-studio, asp.net-mvc-3, visual-studio-2012, visual-studio-debugging

我在网上找不到任何地方的描述。当我尝试运行和调试 ASP.NET MVC3 项目时，我从 Visual Studio 2012 Pro 收到此提示。我想知道：

1.  它所说的这些“脚本诊断”是什么？
2.  它将进行哪些权限更改？它是在修改我的项目目录还是 Visual Studio 安装目录或其他？在我知道它在做什么以及它在哪里做之前，我不想“确定”它。

![脚本诊断权限](https://i.stack.imgur.com/a9BHD.png)

# android - 无法使用 ADT 版本 21 创建新项目（创建空项目）

> ID：15994347
> 
> 赞同：2
> 
> 时间：2013-04-14T00:17:16.660
> 
> 标签：android, eclipse-adt

我刚刚下载了适用于**Mac的 Android Developer Tools** **v21.1.0-569685**。每当我按照以下步骤操作时，我都无法创建一个 android 应用程序项目并获得一个空项目。

 **1.  我已经打开了 Eclipse。
2.  并使用菜单`File`-> `New`-> `Android Application Project`。
3.  我`TestApp`作为名称输入。
4.  然后在所有页面中单击下一步，保留默认选项。
5.  当我到达最后一页（`Next`已禁用并`Finish`启用）时，我单击`Finish`。发生这种情况时会有一些活动，我可以在后台看到一个项目添加到包资源管理器中，但带有`Finish`按钮的窗口仍然存在。如果我取消了 android 应用程序向导，它创建的项目仍然存在，因为它是空的（见截图）。![](https://i.stack.imgur.com/BGEqp.png)

注意：我已经尝试了[无法使用 ADT 版本 20 创建新项目](https://stackoverflow.com/questions/11259069/not-able-to-create-new-project-with-adt-version-20)的解决方案，但没有任何乐趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-10T04:49:51.057

问题是另一个 Java 应用程序已将某些 .jar 文件的不同版本安装到`/Library/Java/Extensions`. 该路径上的 .jar 文件会自动加载。从该路径中删除 .jar 文件解决了该问题。

在我的情况下，问题特别是澳大利亚政府的 AUSKey 软件将 .jars 安装到 Extensions 目录中。

此处报告了该解决方案[https://code.google.com/p/android/issues/detail?id=54452](https://code.google.com/p/android/issues/detail?id=54452)。**

# c - 为什么连接字符串时会出现段错误？

> ID：15994348
> 
> 赞同：0
> 
> 时间：2013-04-14T00:17:18.313
> 
> 标签：c, segmentation-fault

我正在制作一个模拟火灾蔓延的森林火灾模型。我们没有以图形方式显示森林，而是指示我们将森林作为纯文本输出到控制台。结果，输出很难区分，所以我决定为不同的元素着色，因此

```
int i;
int j;

//Initialize a string for what will be outputted to the screen
char output[2000]="";
//Initialize strings that will be concat'd to the main string
char tree[]= "\033[22;31m T \033[22;30m";
char burn[]=" B";
char dirt[]=" D";
char fizzled[]=" F";
char newl[]="\n";
for(i=0;i<25;i++){
    for(j=0;j<25;j++){
        if(forest[i][j]==1){
           strcat(output, tree);
        }else if(forest[i][j]==500){
            strcat(output,burn);
        }else if(forest[i][j]==-1){
            strcat(output,fizzled);
        }
        else{
            strcat(output,dirt);
        }

    }

    strcat(output,newl);

}
printf("------------------------------------------\n");
printf("%s",output); 
```

健康的树在第一次迭代中的颜色不同，它们应该如此。但是，它然后返回一个段错误，我不知道为什么会发生。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T00:24:45.960

看起来你正在溢出你的`output`数组。

`"\033[22;31m T \033[22;30m"`长于大约 15 个字符（我没有准确计算）。在最坏的情况下，当一切都是树时，您可以获得此模式 25*25 次，总数将大于 15*25*25=9375 个字符。而且`char output[2000]`只能容纳2000个。

顺便说一句，如果您打算在 中使用 N 个字符`output[]`，则应在数组中为 NUL 字符串终止符再保留 1 个字符`'\0'`。

# php - 获取照片的随机部分

> ID：15994351
> 
> 赞同：0
> 
> 时间：2013-04-14T00:17:29.397
> 
> 标签：php, javascript, jquery, css

我正在开发一个网络应用程序，并且对网络开发很陌生。

目前我的程序得到一个并要求用户输入与照片相关的内容。

为了完成我的项目，我需要能够做以下两件事之一：

1.  在照片中选择一个随机方块并仅显示该部分。我希望每次重新加载页面以显示不同的部分时，图像的这一部分都会发生变化。

2.  检测面部特征，如眼睛或嘴巴，并仅显示图像的该部分。

任何免费库或实现这些功能的简单方法？

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:46:47.107

对于第一个问题，它相对容易。您只需将图片 url 设置为方形元素的背景图片，例如 a `<div>`，然后使用 JS为属性随机生成 a`x%`和：`y%``background-position: x% y%`

```
$(document).ready(function() {
    // Generate random x-y coordinates
    var x = parseInt(100*Math.random(0,1)),
        y = parseInt(100*Math.random(0,1));

    // Set background-image and position
    $('#img').css({
        'background-image':'url('+$('#img').data('img-src')+')',
        'background-position':x+'% '+y+'%'
    });
}); 
```

对于 HTML 部分，我们利用 HTML`data-`属性：

```
<div id="img" data-img-src="/path/to/image"></div> 
```

CSS 也很简单：

```
#img {
    width: 400px;
    height: 400px;
} 
```

你可以在这里看到小提琴 - [http://jsfiddle.net/teddyrised/gabxj/](http://jsfiddle.net/teddyrised/gabxj/)

第二个问题 -*你试过*什么？我在 Google 和 SO 上进行了快速搜索 - [JavaScript 中用于人脸识别的任何库？](https://stackoverflow.com/questions/7291065/any-library-for-face-recognition-in-javascript)

# android - 防止android应用程序崩溃

> ID：15994353
> 
> 赞同：0
> 
> 时间：2013-04-14T00:17:35.027
> 
> 标签：android

我创建了一个非常简单的转换器应用程序，如果将数据输入到一个或另一个文本框中，它可以正常工作，但是如果我将它们都留空并单击一个或另一个转换按钮，它会崩溃，所以我尝试包含一个if 语句来处理这个问题，但它似乎忽略了该语句并无论如何都会崩溃。基本上，如果单击按钮并且没有输入数字，我想做什么，只需向屏幕发送一条消息，要求用户输入数据。

```
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    final EditText txtCentimetersValue = (EditText) findViewById(R.id.txtCentimetersValue);
    final EditText txtInchesValue = (EditText) findViewById(R.id.txtInchesValue);

    Button btnConvert = (Button) findViewById(R.id.btnConvert);
    Button btnConvert2 = (Button) findViewById(R.id.btnConvert2);
    Button btnClear = (Button) findViewById(R.id.btnClear);

    btnClear.setOnClickListener(new OnClickListener()
    {
        @Override
        public void onClick(View arg0)
        {
            txtCentimetersValue.setText("");
            txtInchesValue.setText("");
        }
    });

    btnConvert.setOnClickListener(new OnClickListener()
    {

        @Override
        public void onClick(View arg0)
        {

                txtInchesValue.setText("");

                double centimeters = Double.valueOf(txtCentimetersValue.getText().toString());
                double inches = centimeters / 0.393700787;

                txtInchesValue.setText(String.valueOf(inches));
        }

    });

    btnConvert2.setOnClickListener(new OnClickListener()
    {
        @Override
        public void onClick(View arg0)
        {

                txtCentimetersValue.setText("");

                double inches = Double.valueOf(txtInchesValue.getText().toString());
                double centimeters = inches / 0.393700787;

                txtCentimetersValue.setText(String.valueOf(centimeters));
        }

    });
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:23:09.170

> 所以我尝试包含一个 if 语句来处理这个问题，但它似乎忽略了该语句并且无论如何都会崩溃。

我没有看到 if 语句，也许你试图用来`==`比较字符串（你不能在 Java 中这样做）或者认为值是`null`. 无论如何，您可以简单地使用`isEmpty()`：

```
String value = txtCentimetersValue.getText().toString();
if(!value.isEmpty()) {
    double centimeters = Double.valueOf(value);
    double inches = centimeters / 0.393700787;

    txtInchesValue.setText(String.valueOf(inches));
} 
```

对英寸到厘米做类似的事情。

# javascript - 如何在 HTML 中编写算法/伪代码？

> ID：15994354
> 
> 赞同：15
> 
> 时间：2013-04-14T00:17:35.367
> 
> 标签：javascript, css, html, latex

在 Beamer 中准备幻灯片时，我习惯于在 LaTeX 中编写[算法](http://en.wikibooks.org/wiki/LaTeX/Algorithms)，但现在我正在使用 HTML 演示引擎 ( [shower](https://github.com/shower/shower) ) 来准备我的幻灯片。是否有任何类似的工作流程/样式（css、javascript）来用 HTML 编写算法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2017-01-13T09:37:43.057

我相信它们有很多，但是您可以检查[pseudocode.js](http://www.tatetian.io/pseudocode.js/)。

> Pseudocode.js 使 JavaScript 能够像 LaTeX 一样漂亮地排版算法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-14T01:16:33.170

您可以查看[MathJax](http://www.mathjax.org/)，它可以很好地渲染 LaTeX（至少就数学而言）。不过，我还没有用它做过算法，所以我不能说它做得如何（或是否）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-12T13:33:59.077

我认为像[handlebars.js](http://handlebarsjs.com/)这样的轻量级解决方案在这里是一个不错的选择。您可以创建动态布局，例如：

```
{{#if isActive}}
  <img src="star.gif" alt="Active">
{{else}}
  <img src="cry.gif" alt="Inactive">
{{/if}} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-12T14:02:11.360

如果你想在你的 HTML 中使用算法，比如条件等。您可以使用 Jade 或 Handlebars 等模板引擎。

玉：[https](https://www.npmjs.com/package/jade) ://www.npmjs.com/package/jade 车把：[http ://handlebarsjs.com/](http://handlebarsjs.com/)

# c - 需要帮助创建 FindMaxOverlap 函数

> ID：15994360
> 
> 赞同：2
> 
> 时间：2013-04-14T00:18:41.053
> 
> 标签：c, algorithm

我正在尝试创建一个函数，给定两个 C 字符串，它会返回两个字符串之间连续字符重叠的数量。

例如，

```
String 1: "Today is monday."
String 2: " is monday." 
```

这里的重叠将是“is monday.”，即 11 个字符（包括空格和 '.'）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:45:48.703

如果您需要更高效的东西，请考虑字符串 1 和 2 之间的部分不匹配意味着您可以沿字符串 1 跳跃字符串 2 的其余部分的长度。这意味着您不需要搜索整个字符串 1。

看看[Boyer-Moore 算法](http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm)。尽管它用于字符串搜索，但您可以使用字符串 2 作为模式和字符串 1 作为目标文本来实现此算法以查找最大长度的子字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:06:57.007

可能有一种更有效的方法来做到这一点，但这里有一个简单的方法：

```
#include <string.h>
int main() {
char s1[17] = "Today is monday.";
char s2[12] = " is monday.";

int max = 0;
int i_max = -1;
int j_max = -1;
int i = 0, j = 0, k=0;
int endl = 0, sl1, sl2;
char *ss1, *ss2;

for(i = 0; i < strlen(s1)-1; i++) {
    ss1 = s1+i;
    sl1 = strlen(ss1);

    if(max >= sl1) {
        break; // You found it.
    }

    for(j = 0; j < strlen(s2)-1; j++) {
        ss2 = s2+j;
        sl2 = strlen(ss2);

        if(max >= sl2) {
           break;    // Can't find a bigger overlap.
        }
        endl = (sl1 > sl2)?sl2:sl1;

        int n_char = 0;
        for(k = 0; k < endl+1; k++) {
            // printf("%s\t%s\n", ss1+k, ss2+k);   // Uncomment if you want to see what it compares.
            if(ss1[k] != ss2[k] || ss1[k] == '\0') {
                n_char = k;
                break;
            }
        }

        if(n_char > max) {
            max = n_char;
            i_max = i;
            j_max = j;
        }
    }
}
char nstr[max+1];
nstr[max] = '\0';
strncpy(nstr, s1+i_max, max);

printf("Maximum overlap is %d characters, substring: %s\n", max, nstr);
return 0;
} 
```

**更新：**我已经修复了错误。这绝对可以编译。结果如下：[http://codepad.org/SINhmm7f](http://codepad.org/SINhmm7f) 问题是 endl 定义错误，我没有检查行尾条件。

希望代码不言自明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T04:44:46.310

这是我的解决方案，它将返回重叠起点的位置，这有点复杂，但这就是它在 C 中的完成方式：

```
#include <string.h>

int FindOverlap (const char * a, const char * b)
{
    // iterators
    char * u = a;
    char * v = b;
    char * c = 0; // overlap iterator

    char overlapee = 'b';

    if (strlen(a) < strlen(b)) overlapee = 'a';

    if (overlapee == 'b')
    {
        while (*u != '\0')
        {
            v = b; // reset b iterator
            c = u;
            while (*v != '\0')
            {
                if (*c != *v) break;
                c++;
                v++;
            }

            if (*v == '\0') return (u-a); // return overlap starting point
        }
    }
    else if (overlapee == 'a')
    {
        while (*v != '\0')
        {
            u = a; // reset b iterator
            c = v;
            while (*u != '\0')
            {
                if (*c != *u) break;
                c++;
                u++;
            }

            if (*v == '\0') return (v-b); // return overlap starting point
        }
    }

    return (-1); // not found
} 
```

# html - 使 Nivo Slider 全宽

> ID：15994362
> 
> 赞同：1
> 
> 时间：2013-04-14T00:19:13.590
> 
> 标签：html, css, twitter-bootstrap, nivo-slider

我正在开发一个将 Nivo Sliders 与 Twitter Bootstrap 结合使用的项目。我遇到了一个可能无法修复的问题，因为 Nivo 可能不是为它构建的。但我试图将使用 span12 的当前滑块变成全角滑块。这是可能的还是我应该只是寻找一个全角滑块来集成？我目前的看法是。

```
<div class="slider-wrapper theme-default">
<div class="row">
    <div class="span12">
       <div id="nslider" class="nivoSlider"> 

/* Nivo SLider */
.nivoSlider {
position:relative;
width:100%;
height:auto;
overflow hidden;
}
.nivoSlider img { position absolute; top:0px; left:0px; max-width:none; }
.nivo-main-image {
display: block !important;
position: relative !important; 
width: 100% !important;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T11:58:38.227

如果要使滑块全宽，一般方法是将滑块移到 span12、行和容器 div 之外。

从您发布的代码来看，您似乎在一个容器 div 中，所以首先关闭它，添加滑块代码，然后为页面的其余部分重新打开一个新的容器 div：

```
</div> <!-- NEW close open container div -->

<div class="slider-wrapper theme-default"> <!-- open full width slider-wrapper div -->

<div id="nslider" class="nivoSlider">  
<!-- slider code -->
</div> <!-- close nslider -->

</div> <!-- close slider-wrapper -->  

<div class="container">  
<!-- continue as normal --> 
```

根据滑块代码和 CSS 的具体情况，这可能需要一些微调。

祝你好运！

# jquery - jQuery toggelClass 适用于桌面但不适用于 iOS

> ID：15994363
> 
> 赞同：0
> 
> 时间：2013-04-14T00:19:19.150
> 
> 标签：jquery

我编写了一些 JavaScript 来使一些具有“最近”类的 div 隐藏其中包含的图像的 4/5。单击时，这些 div 会得到一个额外的类，以显示整个图像。这在桌面上运行良好，但在 iOS 上表现非常不稳定。当它发生时我不能完全确定，但在某些时候（当我滚动时？当地址栏消失时？） div 根本不会响应触摸，然后有时当我旋转设备时某些功能会返回。不知道发生了什么。此外，这可能是一个完全不同的问题，但我认为它与上述问题有关，如果您在桌面上展开浏览器，JavaScript 似乎不会在 768px 宽后“停用”（最近的 div 的高度或多或少比它们包含的图像。在窗口为 768px 宽后它们应该是相同的）。这是网站 www.distantfuturejosh.com/playground/Pending%20Axioms，这是必要的代码：

HTML

```
<div class="recent">
    <img src="img/comic_2.jpg">
</div> 
```

CSS

```
.recent {
    width: 98%;
margin: 0% 0% 2% 2%;
float: left;
    position: relative;
    left: 0%;
    box-shadow: 0px 0px 20px -6px;
    overflow: hidden;
}
.recent img {
width: 100%;
}
.resize {
    height: auto !important;
} 
```

JavaScript

```
$(document).ready(function(){

    $(window).ready(phoneStyle);
    $(window).resize(phoneStyle);

    function phoneStyle()
    {
        if ($(window).width() <= 767) {

            // make the height of header and recent divs a percentage of window width
            $('div.recent, header').css('height', $(window).width() / 5);

            // make the recent divs show and hide (patially) when clicked
            $('div.recent').click(function() {
                $(this).toggleClass('resize');   // phone.css--> .resize {height: auto !important;}
            });
        } else {
            return;
        }
    }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:22:20.290

我不确定这是否会导致问题，但会在 click 事件中`.click` *添加*一个绑定，而不是在调用时*替换*它。`phonestyle`因此，如果 phoneStyle 被调用两次，那么`.toggleClass`每次点击时都会运行两次，可能不会导致任何事情发生。尝试在`$('div.recent').unbind('click');`之前放置`$('div.recent').click(function() {`并让我知道这是否有帮助。

# spring - ActiveMQ 的消息被重新传递（PooledConnectionFactory 错误配置可疑）

> ID：15994367
> 
> 赞同：3
> 
> 时间：2013-04-14T00:19:56.390
> 
> 标签：spring, activemq, pool

我有一个使用 Spring MessageListenerContainers 和 ActiveMQ 的应用程序。按照 activemq 的文档，我已将其配置为使用 PooledConnectionFactory。

我的情况如下：

*   来自队列的两个 java-app 消费者（2 个不同的 tomcat）
*   主从 activemq 代理，带有故障转移 url
*   PooledConnectionFactory 已配置
*   应用程序上的骆驼
*   activemq 5.8.0，带有commons-pool 1.6

一切似乎都正常，但有时消息会重新传递给消费者，这会导致应用程序错误。

根据日志，我怀疑此错误是由 spring 的 PooledConnectionFactory bean 定义中的一些错误配置引起的，该定义甚至关闭了已使用的连接，然后强制回滚当前会话，从而重新传递消息

池的弹簧配置如下：

```
<bean id="AMQconnFactory" class="org.apache.activemq.ActiveMQConnectionFactory">
        <property name="brokerURL">
            <value>${activemq_url}?initialReconnectDelay=100&amp;timeout=3000&amp;jms.prefetchPolicy.all=1&amp;jms.redeliveryPolicy.initialRedeliveryDelay=300000
            </value>
        </property>
    </bean>
    <bean id="sharedConnectionFactory" class="org.apache.activemq.pool.PooledConnectionFactory" abstract="true">
        <property name="connectionFactory" ref="AMQconnFactory" />
        <property name="maxConnections" value="30" />
    </bean>

    <bean id="MotionJMSConnectionFactory" parent="sharedConnectionFactory" class="org.apache.activemq.pool.PooledConnectionFactory"
        init-method="start" destroy-method="stop" />

<bean id="sharedListenersProps" abstract="true" class="org.springframework.jms.listener.DefaultMessageListenerContainer">
        <property name="maxConcurrentConsumers" value="1" />
        <property name="concurrentConsumers" value="1" />
        <property name="connectionFactory" ref="MotionJMSConnectionFactory" />
        <property name="sessionTransacted" value="true" />
        <property name="transactionTimeout" value="300"/>
    </bean> 
```

将我指向该方向的日志如下：

```
[TRACE] (ActiveMQMessageConsumer.java:494) (09:48:16,412) - ID:bbiovx01.bglobal.bcorp-56155-1365791814916-1:3222:1:1 received message: MessageDispatch {commandId = 0, responseRequired = false, consumerId = 
ID:bbiovx01.bglobal.bcorp-56155-1365791814916-1:3222:1:1, destination = queue://EntradaQueue, message = ActiveMQObjectMessage {commandId = 12999, responseRequired = true, messageId = ID:bbiovx01.bglobal.bco
rp-33973-1365792268762-1:28:2:1:12, originalDestination = null, originalTransactionId = null, producerId = ID:bbiovx01.bglobal.bcorp-33973-1365792268762-1:28:2:1, destination = queue://EntradaQueue, transac
tionId = null, expiration = 0, timestamp = 1365857296363, arrival = 0, brokerInTime = 1365857296364, brokerOutTime = 1365857296410, correlationId = null, replyTo = null, persistent = true, type = null, prio
rity = 4, groupID = null, groupSequence = 0, targetConsumerId = null, compressed = false, userID = null, content = org.apache.activemq.util.ByteSequence@31efa8c3, marshalledProperties = null, dataStructure 
= null, redeliveryCounter = 0, size = 0, properties = null, readOnlyProperties = true, readOnlyBody = true, droppable = false}, redeliveryCounter = 0}
[DEBUG] (AbstractPollingMessageListenerContainer.java:313) (09:48:16,412) - Received message of type [class org.apache.activemq.command.ActiveMQObjectMessage] from consumer [PooledMessageConsumer { ActiveMQ
MessageConsumer { value=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-1:3222:1:1, started=true } }] of session [PooledSession { ActiveMQSession {id=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-1:3222:1,sta
rted=true} }]
<!-- app LOG -->
[DEBUG] (MDPEntrada.java:53) (09:48:16,413) - Mensagem de entrada recebida ActiveMQObjectMessage {commandId = 12999, responseRequired = true, messageId = ID:bbiovx01.bglobal.bcorp-33973-1365792268762-1:28:2:1:12, originalDestination = null, originalTransactionId = null, producerId = ID:bbiovx01.bglobal.bcorp-33973-1365792268762-1:28:2:1, destination = queue://EntradaQueue, transactionId = null, expiration = 0, timestamp = 1365857296363, arrival = 0, brokerInTime = 1365857296364, brokerOutTime = 1365857296410, correlationId = null, replyTo = null, persistent = true, type = null, priority = 4, groupID = null, groupSequence = 0, targetConsumerId = null, compressed = false, userID = null, content = org.apache.activemq.util.ByteSequence@31efa8c3, marshalledProperties = null, dataStructure = null, redeliveryCounter = 0, size = 0, properties = null, readOnlyProperties = true, readOnlyBody = true, droppable = false}
TRACE] (PooledConnectionFactory.java:121) (09:48:17,295) - Destroying connection: ConnectionPool[null]
[TRACE] (PooledConnectionFactory.java:154) (09:48:17,295) - Connection has expired: ConnectionPool[null] and will be destroyed
[TRACE] (PooledConnectionFactory.java:121) (09:48:17,295) - Destroying connection: ConnectionPool[null]
[TRACE] (PooledConnectionFactory.java:154) (09:48:17,296) - Connection has expired: ConnectionPool[ActiveMQConnection {id=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-1:3222,clientId=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-0:3218,started=true}] and will be destroyed
[TRACE] (PooledConnectionFactory.java:121) (09:48:17,296) - Destroying connection: ConnectionPool[ActiveMQConnection {id=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-1:3222,clientId=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-0:3218,started=true}]
[TRACE] (PooledConnectionFactory.java:154) (09:48:17,297) - Connection has expired: ConnectionPool[ActiveMQConnection {id=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-1:3221,clientId=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-0:3217,started=true}] and will be destroyed
[TRACE] (PooledConnectionFactory.java:121) (09:48:17,297) - Destroying connection: ConnectionPool[ActiveMQConnection {id=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-1:3221,clientId=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-0:3217,started=true}]
[WARN ] (PooledSession.java:123) (09:48:17,297) - Caught exception trying rollback() when putting session back into the pool, will invalidate. javax.jms.IllegalStateException: The Session is closed
javax.jms.IllegalStateException: The Session is closed
        at org.apache.activemq.ActiveMQSession.checkClosed(ActiveMQSession.java:731)
        at org.apache.activemq.ActiveMQSession.rollback(ActiveMQSession.java:574)
        at org.apache.activemq.pool.PooledSession.close(PooledSession.java:120)
        at org.springframework.jms.support.JmsUtils.closeSession(JmsUtils.java:108)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.clearResources(DefaultMessageListenerContainer.java:1099)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:958)
        at java.lang.Thread.run(Thread.java:662)
[WARN ] (DefaultMessageListenerContainer.java:818) (09:48:17,297) - Setup of JMS message listener invoker failed for destination 'topic://AtualizaAssinaturasETemplatesTopic' - trying to recover. Cause: The Session is closed
javax.jms.IllegalStateException: The Session is closed
        at org.apache.activemq.ActiveMQSession.checkClosed(ActiveMQSession.java:731)
        at org.apache.activemq.ActiveMQSession.getTransacted(ActiveMQSession.java:521)
        at org.apache.activemq.pool.PooledSession.getTransacted(PooledSession.java:259)
        at org.springframework.jms.listener.AbstractMessageListenerContainer.commitIfNecessary(AbstractMessageListenerContainer.java:571)
        at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:358)
        at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:263)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1059)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1050)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:947)
        at java.lang.Thread.run(Thread.java:662)
[TRACE] (PooledConnectionFactory.java:154) (09:48:17,302) - Connection has expired: ConnectionPool[null] and will be destroyed
[TRACE] (PooledConnectionFactory.java:121) (09:48:17,302) - Destroying connection: ConnectionPool[null]
[TRACE] (PooledConnectionFactory.java:154) (09:48:17,302) - Connection has expired: ConnectionPool[null] and will be destroyed
[TRACE] (PooledConnectionFactory.java:121) (09:48:17,303) - Destroying connection: ConnectionPool[null]
[TRACE] (PooledConnectionFactory.java:140) (09:48:17,303) - Created new connection: ConnectionPool[ActiveMQConnection {id=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-1:3320,clientId=null,started=false}]
[INFO ] (DefaultMessageListenerContainer.java:862) (09:48:17,306) - Successfully refreshed JMS Connection
[INFO ] (SEntradaImpl.java:368) (09:48:17,311) - Tempo de Processamento da requisicao: 843ms
[INFO ] (SEntradaImpl.java:227) (09:48:17,311) - * FINALIZANDO ENTRADA *
[WARN ] (AbstractMessageListenerContainer.java:694) (09:48:17,312) - Execution of JMS message listener failed, and no ErrorHandler has been set.
javax.jms.IllegalStateException: The Session is closed
        at org.apache.activemq.ActiveMQSession.checkClosed(ActiveMQSession.java:731)
        at org.apache.activemq.ActiveMQSession.getTransacted(ActiveMQSession.java:521)
        at org.apache.activemq.pool.PooledSession.getTransacted(PooledSession.java:259)
        at org.springframework.jms.listener.AbstractMessageListenerContainer.commitIfNecessary(AbstractMessageListenerContainer.java:571)
        at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:481)
        at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:325)
        at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:263)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1059)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1050)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:947)
        at java.lang.Thread.run(Thread.java:662)
[WARN ] (PooledSession.java:123) (09:48:17,312) - Caught exception trying rollback() when putting session back into the pool, will invalidate. javax.jms.IllegalStateException: The Session is closed
javax.jms.IllegalStateException: The Session is closed
        at org.apache.activemq.ActiveMQSession.checkClosed(ActiveMQSession.java:731)
        at org.apache.activemq.ActiveMQSession.rollback(ActiveMQSession.java:574)
        at org.apache.activemq.pool.PooledSession.close(PooledSession.java:120)
        at org.springframework.jms.support.JmsUtils.closeSession(JmsUtils.java:108)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.clearResources(DefaultMessageListenerContainer.java:1099)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:958)
        at java.lang.Thread.run(Thread.java:662)
[WARN ] (DefaultMessageListenerContainer.java:818) (09:48:17,312) - Setup of JMS message listener invoker failed for destination 'queue://EntradaQueue' - trying to recover. Cause: The Session is closed
javax.jms.IllegalStateException: The Session is closed
        at org.apache.activemq.ActiveMQSession.checkClosed(ActiveMQSession.java:731)
        at org.apache.activemq.ActiveMQSession.getTransacted(ActiveMQSession.java:521)
        at org.apache.activemq.pool.PooledSession.getTransacted(PooledSession.java:259)
        at org.springframework.jms.listener.AbstractMessageListenerContainer.commitIfNecessary(AbstractMessageListenerContainer.java:571)
        at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:481)
        at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:325)
        at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:263)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1059)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1050)
        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:947)
        at java.lang.Thread.run(Thread.java:662)
[TRACE] (PooledConnectionFactory.java:140) (09:48:17,312) - Created new connection: ConnectionPool[ActiveMQConnection {id=ID:bbiovx01.bglobal.bcorp-56155-1365791814916-1:3322,clientId=null,started=false}]
[INFO ] (DefaultMessageListenerContainer.java:862) (09:48:17,316) - Successfully refreshed JMS Connection 
```

如果需要，我可以提供更多细节。

此致。

编辑：

另外，我尝试将池大小减少到 1，现在，我更经常地收到以下堆栈（警告）：

```
[WARN ] (PooledSession.java:123) (02:00:00,160) - Caught exception trying rollback() when putting session back into the pool, will invalidate. javax.jms.IllegalStateException: The Session is closed
javax.jms.IllegalStateException: The Session is closed
    at org.apache.activemq.ActiveMQSession.checkClosed(ActiveMQSession.java:731)
    at org.apache.activemq.ActiveMQSession.rollback(ActiveMQSession.java:574)
    at org.apache.activemq.pool.PooledSession.close(PooledSession.java:120)
    at org.springframework.jms.support.JmsUtils.closeSession(JmsUtils.java:108)
    at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.clearResources(DefaultMessageListenerContainer.java:1099)
    at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:958)
    at java.lang.Thread.run(Thread.java:662)
[WARN ] (PooledSession.java:123) (02:00:00,160) - Caught exception trying rollback() when putting session back into the pool, will invalidate. javax.jms.IllegalStateException: The Session is closed
javax.jms.IllegalStateException: The Session is closed
    at org.apache.activemq.ActiveMQSession.checkClosed(ActiveMQSession.java:731)
    at org.apache.activemq.ActiveMQSession.rollback(ActiveMQSession.java:574)
    at org.apache.activemq.pool.PooledSession.close(PooledSession.java:120)
    at org.springframework.jms.support.JmsUtils.closeSession(JmsUtils.java:108)
    at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.clearResources(DefaultMessageListenerContainer.java:1099)
    at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:958)
    at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T10:12:07.217

这是由 PooledConnection 代码中的[错误](https://issues.apache.org/jira/browse/AMQ-4366)引起的，将在版本 5.9.0 中修复。一种解决方法是将 PooledConnectionFactory 上的空闲超时设置为 0。

```
PooledConnectionFactory.setIdleTimeout(0) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-07T23:56:18.707

添加属性

```
<property name="idleTimeout" value="0"/> 
```

到您的 PooledConnectionFactory

# r - 如何使在函数内创建的对象可在外部使用

> ID：15994368
> 
> 赞同：24
> 
> 时间：2013-04-14T00:20:00.357
> 
> 标签：r, function, environment-variables, global-variables, assign

我创建了一个生成矩阵的函数，但我不知道如何使该函数的输出在函数环境之外可用，以便例如将其保存在 csv 文件中。

我的函数代码如下：

## 创建的函数从特定站点获取 url 并返回页面标题：

```
getTitle <- function(url) {
  webpage <- readLines(url)
  first.row <- webpage[1]
  start <- regexpr("<title>", first.row)
  end <- regexpr("</title>", first.row)
  title <- substr(first.row,start+7,end-1)
  return(title)
} 
```

## 创建的函数采用 url 向量并返回 n*2 矩阵，其中包含 url 和页面标题：

```
getTitles <- function(pages) {
  my.matrix <- matrix(NA, ncol=2, nrow=nrow(pages))
  for (i in seq_along(1:nrow(pages))) {
    my.matrix[i,1] <- as.character(pages[i,])
    my.matrix[i,2] <- getTitle(as.character(pages[i,])) }
  return(my.matrix)
  print(my.matrix)} 
```

[在从这里http://goo.gl/D9lLZ](http://goo.gl/D9lLZ)我用 read.csv 函数导入并命名为“mypages”的示例文件上运行此函数后，我得到以下输出：

```
getTitles(mypages)
     [,1]                                               [,2]                                                
[1,] "http://support.google.com/adwords/answer/1704395" "Create your first ad campaign - AdWords Help"      
[2,] "http://support.google.com/adwords/answer/1704424" "How costs are calculated in AdWords - AdWords Help"
[3,] "http://support.google.com/adwords/answer/2375470" "Organizing your account for success - AdWords Help" 
```

这正是我所需要的，但我希望能够将此输出导出到 csv 文件或重复使用以进行进一步的操作。但是，当我尝试打印（my.matrix）时，我收到一条错误消息“错误：找不到对象'my.matrix'”

我觉得这是我知识上的一个非常基本的差距，但是有一段时间没有使用 R 并且无法解决这个问题。

谢谢！谢尔盖

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-14T00:21:16.080

这很简单：`<<-`用于分配给全局。

但话又说回来，全局分配是邪恶的，没有功能。也许您宁愿从您的函数返回一个包含多个结果的列表？查看您的代码，似乎您的第二个函数可能会混淆`return`and `print`。确保返回正确的数据结构。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-04-14T00:28:37.593

一点关于函数式编程的知识。首先，当你定义你的函数时：

```
getTitles <- function(pages) {
  [...]
  return(my.matrix)
  print(my.matrix)
} 
```

知道当函数被调用时，它永远不会到达`print`语句。相反，它将在之前退出，带有`return`. 所以你可以删除那个`print`语句，它是没用的。

现在更重要的东西。在您的函数内部，您定义并返回`my.matrix`. 该对象只存在于函数的范围内：函数退出时，返回的是一个*未命名*的对象（并且`my.matrix`丢失了。）

在你的会话中，当你打电话时

```
getTitles(mypages) 
```

结果被打印，因为您没有分配它。相反，您应该这样做：

```
out.matrix <- getTitles(mypages) 
```

现在将不会打印结果，但您绝对可以通过键入`print(out.matrix)`或仅`out.matrix`在一行上打印。并且因为您已将结果存储在一个对象中，您现在可以*重用它以进行进一步的操作*。

如果它可以帮助您掌握概念，这`c()`与从命令行调用函数完全一样：

```
c(1, 5, 2)      # will return and print a vector 
x <- c(1, 5, 2) # will return and assign a vector (not printed.) 
```

* * *

奖励：真的，我认为您不需要定义`getTitles`，但您可以使用其中一个`*apply`功能。我会试试这个：

```
url    <- as.character(mypages)
title  <- sapply(url, getTitle)
report <- data.frame(url, title)
write.csv(report, file = "report.csv", row.names = FALSE) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-04-20T14:13:38.330

您不能只使用`<<-`将对象分配给工作区吗？以下代码适用于我并保存`amort_value`对象。

```
amortization <- function(cost, downpayment, interest, term) {
  amort_value <<- (cost)*(1-downpayment/100)*(interest/1200)*((1+interest/1200)^(term*12))/((1+interest/1200)^(term*12)-1)
  sprintf("$%.2f", amort_value)         

}
amortization(445000,20,3,15)
amort_value 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-07-13T21:18:03.727

在函数结束时，您可以`return`得到结果。

首先定义函数：

```
getRangeOf <- function (v) {
    numRange <- max(v) - min(v)
    return(numRange)
} 
```

然后调用它并将输出分配给一个变量：

```
scores <- c(60, 65, 70, 92, 99)
scoreRange <- getRangeOf(scores) 
```

从这里开始`scoreRange`在环境中使用。**外部无法访问您定义的函数中**的任何变量或嵌套函数，当然，除非您使用`<<-`分配全局变量。所以在这个例子中，你不能`numRange`从外部看到什么，除非你把它变成全局的。

通常，在早期尽量避免使用全局变量。变量是“封装的”，因此我们知道在当前上下文（“环境”）中使用了哪个变量。全局变量更难驯服。

# css - DIV 标签行为异常

> ID：15994371
> 
> 赞同：0
> 
> 时间：2013-04-14T00:21:14.277
> 
> 标签：css, html

我的私人网页的主要内容在 Firefox 中没有奇怪地显示。页眉和页脚栏都显示，并且主要文本被放置在它们旁边的右侧。有时，页脚也会移到正文上方。我猜这是一个涉及我不知何故丢失的DIV定位的问题。[这个已经解决]

在 Chrome 中显示时，两个同样高的 DIV 的高度也不同。这个问题也出现在 Safari 中，但方式不同。在 Chrome 或 Firefox 中查看时，徽标和导航栏之间存在 1 px 的间隙。谁能想到一种方法来重置所有浏览器默认设置以防止将来发生类似的事情？

该网站目前尚未上线，我正在对其进行调试以进行最终发布。（我真的不想在目前的情况下发布它，因为它会让任何不使用 webkit 浏览器的人感到沮丧。）

另外，作为旁注，有人知道如何修复我在 Internet Explorer 9 中遇到的 CSS 错误吗？导航栏中的渐变消失了，某些区域缺少背景颜色，所有图片链接周围都有烦人的框。

编辑：我在一个在线 CSS 渐变生成器中看到了我需要做什么才能使渐变在 IE9 中工作。背景问题显然源于同一来源。

[此外，Opera 中是否有人在http://jsbin.com/ipixay/1](http://jsbin.com/ipixay/1)遇到最新调试版本的问题？（这要归功于 Sunyatasattva。）

小提琴的链接（代码发布在哪里）是：http: [//jsfiddle.net/aaQSD/7/](http://jsfiddle.net/aaQSD/6/)请原谅我仍然存在的 CSS 数量，但我不知道是哪个导致 Internet Explorer 9个问题。

我最好的猜测是 Firefox 的问题出在 CSS 的这一部分：

```
body {
    margin: 0;
    padding: 0;
    text-align: center;
    font-family: Times;
    background: #efefef url(pics/background.png) repeat top center;
}
#container {
    overflow:auto;
    width: 95%;
    min-height: 100%;
    min-width: 946px;
    margin: 0 auto 10px auto;
}
#content-wrapper {
    width: 100%;
    float: right;
    text-align: left;
    margin: 10px 0 0 0;
}
#content-inner {
    padding: 0 15px 0 15px;
}
.center-slide {
    font: normal 62.5%/1.5 Times;
    letter-spacing: 0;
    width: 900px;
    height: 485px;
    position: relative;
    padding: 20px 0 0 0;
    margin: 0 auto 0 auto;
    background-color: #FFFFFF;
    border-radius: 8px;
}
.boxes {
    margin: 0 auto 0 auto;
    width: 900px;
}
.left-box {
    float: left;
    background-color: #FFFFFF;
    border-radius: 8px;
    margin: 10px 5px 0 0;
    padding: 20px;
    width: 500px;
    position: relative;
}
.logo {
    width: 26%;
    text-align: center;
    float: left;
    font-family: Times;
    font-size: 65px;
    font-weight: bold;
    color: #FFFFFF;
    padding: 10px 0 0 0;
    background-image: -moz-linear-gradient(0% 22px 90deg, #0B3474, #517ABA);
    background-image: -webkit-gradient(linear, 0% 0%, 0% 70%, from(#517ABA), to(#0B3474));
}
header {
    width: 100%;
    min-width: 863px;
    background-color: #000047;
    float: left;
    padding: 10px;
    color: #FFFFFF;
    text-align: left;
    font-size: 20px;
    overflow: hidden;
    margin: 0 0 10px 0;
}
nav {
    background-color: #6a6a6a;
    font: 16px Times;
    min-width: 700px;
    float: right;
    width: 74%;
}
footer {
    font-family: Times;
    text-align: center;
    background-color: #000047;
    color: #FFFFFF;
    text-align: center;
    padding: 10px 0;
    width: 100%;
    min-width: 863px;
} 
```

以下是已修复的事项列表：

*   图片周围不需要的框/边框
*   火狐显示问题
*   有问题的页脚

**编辑：我目前正在努力使用最少的代码来复制评论中建议的问题。我希望你能原谅我的愚蠢错误。谢谢，到目前为止所有回复的人！**

**编辑2：小提琴出来了！我已经删除了曾经在下面的潘多拉魔盒。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T01:10:21.727

我已经编辑了您的小提琴以使其正常工作。我基本上只是添加`float: left;`到您的`#container`. 您可以查看我的编辑以获取更多详细信息。[http://jsfiddle.net/aaQSD/8/](http://jsfiddle.net/aaQSD/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T01:24:45.327

# c# - C# 绘制与折线平行的线

> ID：15994374
> 
> 赞同：1
> 
> 时间：2013-04-14T00:21:28.693
> 
> 标签：c#, wpf, draw

我正在 wpf 中创建一个程序，该程序绘制折线以及一条平行的偏移线。它适用于第一组平行线，但在接下来的每条线上，右线都是倾斜的（以红色显示）。

![在此处输入图像描述](https://i.stack.imgur.com/V6GL9.png)

到目前为止的代码：

```
 private void DrawingCanvas_MouseLeftButtonUp(object sender, MouseButtonEventArgs e) {
        if (polylineLeft != null) {
            var canvas = (Canvas)sender;
            leftSegment.Points[1] = e.GetPosition(canvas);

            var distance = (leftSegment.Points[0] - leftSegment.Points[1]).Length;

            if (distance >= 20) {

                polylineLeft.Points.Add(leftSegment.Points[1]);
                //calculate second line
                var L = Math.Sqrt((leftSegment.Points[0].X - leftSegment.Points[1].X) * 
                    (leftSegment.Points[0].X - leftSegment.Points[1].X) + 
                    (leftSegment.Points[0].Y - leftSegment.Points[1].Y) * 
                    (leftSegment.Points[0].Y - leftSegment.Points[1].Y));
                var x1p = leftSegment.Points[0].X + width * (leftSegment.Points[1].Y-leftSegment.Points[0].Y) / L;
                var x2p = leftSegment.Points[1].X + width * (leftSegment.Points[1].Y-leftSegment.Points[0].Y) / L;
                var y1p = leftSegment.Points[0].Y + width * (leftSegment.Points[0].X-leftSegment.Points[1].X) / L;
                var y2p = leftSegment.Points[1].Y + width * (leftSegment.Points[0].X-leftSegment.Points[1].X) / L;
                if (!initialLeftPoint) {
                    polylineRight.Points.Clear();
                    polylineRight.Points.Add(new Point(x1p, y1p));
                    initialLeftPoint = true;
                }
                polylineRight.Points.Add(new Point(x2p, y2p));
                leftSegment.Points[0] = leftSegment.Points[1];
                rightSegment.Points[0] = rightSegment.Points[1];
            } else {
                if (polylineLeft.Points.Count < 2) {
                    canvas.Children.Remove(polylineLeft);
                }

                polylineLeft = null;
                polylineRight = null;
                leftSegment.Points.Clear();
                rightSegment.Points.Clear();
                canvas.Children.Remove(leftSegment);
                canvas.Children.Remove(rightSegment);
            }
        }
    } 
```

如何确保在我的第二条线上（红色）与主线（绿色）平行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:31:43.350

在 WPF Vector 结构的帮助下，问题的一部分很容易解决。`p1`给定两个点和之间的线段`p2`，您可以像这样计算法线向量：

```
Point p1 = ...
Point p2 = ...
var v = p2 - p1;
var n = new Vector(v.Y, -v.X);
n.Normalize();
// now n is a Vector of length 1, perpendicular to the line p1-p2 
```

您现在可以像这样创建一个平行线段（由 Points`p3`和给出`p4`）：

```
var distance = 20d;
var p3 = p1 + n * distance;
var p4 = p3 + v; 
```

但是，上面的代码创建了一个与原始长度相同的平行线段。这可能不是您想要的，因为我猜您想创建一条“平行折线”。如果是这种情况，事情会变得有点复杂，因为您还必须计算平行折线的相邻线段之间的交点。在这些计算过程中，甚至可能会出现其中一些片段消失的情况。

# java - 从 Java 中的 DOM 解析器创建对象？

> ID：15994379
> 
> 赞同：3
> 
> 时间：2013-04-14T00:22:05.407
> 
> 标签：java, xml-parsing, domparser

我正在尝试使用 DOM 解析器解析 XML 文件。XML 文件包含按名称、FAA 标识符、纬度/经度和 URL 列出的机场列表。这是它的一个片段：

```
<station>
    <station_id>NFNA</station_id>
    <state>FJ</state>
    <station_name>Nausori</station_name>
    <latitude>-18.05</latitude>
    <longitude>178.567</longitude>
    <html_url>http://weather.noaa.gov/weather/current/NFNA.html</html_url>
    <rss_url>http://weather.gov/xml/current_obs/NFNA.rss</rss_url>
    <xml_url>http://weather.gov/xml/current_obs/NFNA.xml</xml_url>
</station>

<station>
    <station_id>KCEW</station_id>
    <state>FL</state>
            <station_name>Crestview, Sikes Airport</station_name>
    <latitude>30.79</latitude>
    <longitude>-86.52</longitude>
            <html_url>http://weather.noaa.gov/weather/current/KCEW.html</html_url>
            <rss_url>http://weather.gov/xml/current_obs/KCEW.rss</rss_url>
            <xml_url>http://weather.gov/xml/current_obs/KCEW.xml</xml_url>
</station> 
```

我正在尝试创建包含每个已解析机场信息的对象（每个机场一个），以便我可以仅按名称显示每个机场。其余的机场信息将在稍后的项目中使用。

谁能告诉我如何根据这个 DOM 解析器提供的信息创建和实例化对象，以便我只能显示每个机场的名称？

这是我的代码：

```
import java.io.File;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class Test {

//initialize variables
String station_id;
String state;
String station_name;
double latitude;
double longitude;
String html_url;

//Here is my constructor, I wish to instantiate these values with
//those of obtained by the DOM parser
Test(){

    station_id = this.station_id;
    state = this.state;
    station_name = this.station_name;
    latitude = this.latitude;
    longitude = this.longitude;
    html_url = this.html_url;

}

//Method for DOM Parser
  public void readXML(){

    try {

        //new xml file and Read
        File file1 = new File("src/flwxindex3.xml");
        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        DocumentBuilder db = dbf.newDocumentBuilder();
        Document doc = db.parse(file1);
        doc.getDocumentElement().normalize();

        NodeList nodeList = doc.getElementsByTagName("station");

        for (int i = 0; i < nodeList.getLength(); i++) {

            Node node = nodeList.item(i);

            if(node.getNodeType() == Node.ELEMENT_NODE){

                Element first = (Element) node;

                station_id =      first.getElementsByTagName("station_id").item(0).getTextContent();
                state = first.getElementsByTagName("state").item(0).getTextContent();
                station_name = first.getElementsByTagName("station_name").item(0).getTextContent();
                latitude = Double.parseDouble(first.getElementsByTagName("latitude").item(0).getTextContent());
                longitude = Double.parseDouble(first.getElementsByTagName("longitude").item(0).getTextContent());
                html_url = first.getElementsByTagName("station_id").item(0).getTextContent();
            }

            /*These are just test to see if the actually worked
             * 
            System.out.println(station_id);
            System.out.println(state);
            System.out.println(station_name);
            System.out.println(latitude);
            System.out.println(longitude);
            System.out.println(html_url);
            */

        }
        } catch (Exception e) {
        System.out.println("XML Pasing Excpetion = " + e);
        }

}

public static void main(String[] args) {

    //Create new object and call the DOM Parser method
    Test test1 = new Test();
    test1.readXML();
    //System.out.println(test1.station_name);

}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T00:41:14.073

您目前有对您的班级来说是全局的变量。你需要一个`Object`来包含你的变量：

```
public class Airport {
    String stationId;
    String state;
    String stationName;
    double latitude;
    double longitude;
    String url;

    //getters/setters etc
} 
```

`List`现在在您的班级顶部创建您的机场

```
final List<Airport> airports = new LinkedList<Airport>(); 
```

最后创建机场实例并将其添加到`List`循环中

```
if(node.getNodeType() == Node.ELEMENT_NODE){

    final Element first = (Element) node;
    final Airport airport = new Airport();

    airport.setStationId(first.getElementsByTagName("station_id").item(0).getTextContent());
    airport.setState(first.getElementsByTagName("state").item(0).getTextContent());
    //etc
    airports.add(airport);
} 
```

并且要遍历机场并显示名称，只需

```
for(final Airport airport : airports) {
    System.out.println(airport.getStationName());
} 
```

老实说，这有点混乱。如果您想将 XML 解组为 java POJO，我真的建议您使用 JAXB。

这是使用 XML 模式、maven-jaxb2-plugin 和 JAXB 的快速示例。

通过一些准备，您可以创建`Airport`仅使用以下代码的列表（`Airport`已成为`Station`您的 xml 元素名称）。

```
public static void main(String[] args) throws InterruptedException, JAXBException {
    final JAXBContext jaxbc = JAXBContext.newInstance(Stations.class);
    final Unmarshaller unmarshaller = jaxbc.createUnmarshaller();
    final Stations stations = (Stations) unmarshaller.unmarshal(Thread.currentThread().getContextClassLoader().getResource("airports.xml"));
    for (final Station station : stations.getStation()) {
        System.out.println(station.getStationName());
    }
} 
```

输出：

```
Nausori
Crestview, Sikes Airport 
```

为了让它工作，我创建了一个 xml 模式来定义你的 xml 文件格式

```
<xs:element name="stations">
    <xs:complexType>
        <xs:sequence>
            <xs:element name="station" minOccurs="1" maxOccurs="unbounded">
                <xs:complexType>
                    <xs:all>
                        <xs:element name="station_id" type="xs:string"/>
                        <xs:element name="state" type="xs:string"/>
                        <xs:element name="station_name" type="xs:string"/>
                        <xs:element name="latitude" type="xs:decimal"/>
                        <xs:element name="longitude" type="xs:decimal"/>
                        <xs:element name="html_url" type="xs:anyURI"/>
                        <xs:element name="rss_url" type="xs:anyURI"/>
                        <xs:element name="xml_url" type="xs:anyURI"/>
                    </xs:all>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:complexType>
</xs:element> 
```

定义 xml 文件的格式。请注意，它有一个`stations`包含两个站标签的标签。这是一个示例 xml

```
<stations>
    <station>
        <station_id>NFNA</station_id>
        <state>FJ</state>
        <station_name>Nausori</station_name>
        <latitude>-18.05</latitude>
        <longitude>178.567</longitude>
        <html_url>http://weather.noaa.gov/weather/current/NFNA.html</html_url>
        <rss_url>http://weather.gov/xml/current_obs/NFNA.rss</rss_url>
        <xml_url>http://weather.gov/xml/current_obs/NFNA.xml</xml_url>
    </station>
    <station>
        <station_id>KCEW</station_id>
        <state>FL</state>
        <station_name>Crestview, Sikes Airport</station_name>
        <latitude>30.79</latitude>
        <longitude>-86.52</longitude>
        <html_url>http://weather.noaa.gov/weather/current/KCEW.html</html_url>
        <rss_url>http://weather.gov/xml/current_obs/KCEW.rss</rss_url>
        <xml_url>http://weather.gov/xml/current_obs/KCEW.xml</xml_url>
    </station>       
</stations> 
```

我使用 pom.xml 中的以下内容将架构编译为 java 类 - 使用 maven。如果不使用 maven，您可以从命令行调用 xjc。

```
<plugin>
    <groupId>org.jvnet.jaxb2.maven2</groupId>
    <artifactId>maven-jaxb2-plugin</artifactId>
    <version>0.8.0</version>
    <configuration>
        <schemaDirectory>src/main/resources/</schemaDirectory>
        <generatePackage>com.boris.airport</generatePackage>                    
    </configuration>
    <executions>
        <execution>
            <id>generate</id>
            <goals>
                <goal>generate</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-30T10:17:37.563

> 您可以使用 POJO 类来存储站属性。

该程序`BeanUtils`用于将属性填充到 bean 中，而不是为每个属性使用 setter/getter。

您的 XML 中缺少的另一件事是

```
<?xml version="1.0" encoding="UTF-8"?> 
```

并将所有的都包含`station`在一个外部`stations`标记中，如下所示，以形成一个有效的 XML，上面写着

> 根元素必须是格式良好的

```
<?xml version="1.0" encoding="UTF-8"?>
<stations>
    <station>
        ...
    </station>

    <station>
        ...
    </station>
</stations> 
```

这是代码

```
import java.io.FileInputStream;
import java.lang.reflect.InvocationTargetException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.apache.commons.beanutils.BeanUtils;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class DOMParsarDemo3 {
    protected DocumentBuilder docBuilder;
    protected Element root;

    private static List<AirportStation> stations = new ArrayList<AirportStation>();

    public DOMParsarDemo3() throws Exception {
        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        docBuilder = dbf.newDocumentBuilder();
    }

    public void parse(String file) throws Exception {
        Document doc = docBuilder.parse(new FileInputStream(file));
        root = doc.getDocumentElement();
        System.out.println("root element is :" + root.getNodeName());
    }

    public void printAllElements() throws Exception {
        printElement(root);
    }

    public void printElement(Node node) {
        if (node.getNodeType() != Node.TEXT_NODE) {
            Node child = node.getFirstChild();
            while (child != null) {
                if ("station".equals(child.getNodeName())) {
                    NodeList station = child.getChildNodes();

                    Map<String, String> map = new HashMap<String, String>();
                    for (int i = 0; i < station.getLength(); i++) {
                        Node s = station.item(i);
                        if (s.getNodeType() == Node.ELEMENT_NODE) {
                            map.put(s.getNodeName(), s.getChildNodes().item(0).getNodeValue());
                        }
                    }

                    AirportStation airportStation = new AirportStation();
                    try {
                        BeanUtils.populate(airportStation, map);
                    } catch (IllegalAccessException e) {
                        e.printStackTrace();
                    } catch (InvocationTargetException e) {
                        e.printStackTrace();
                    }

                    stations.add(airportStation);
                }
                printElement(child);
                child = child.getNextSibling();
            }
        }
    }

    public static void main(String args[]) throws Exception {
        DOMParsarDemo3 demo = new DOMParsarDemo3();
        demo.parse("resources/abc2.xml");
        demo.printAllElements();

        for (AirportStation airportStation : stations) {
            System.out.println(airportStation);
        }
    }
} 
```

POJO

```
import java.io.Serializable;

public class AirportStation implements Serializable {

    private static final long serialVersionUID = 1L;

    public AirportStation() {

    }

    private String station_id;
    private String state;
    private String station_name;
    private String latitude;
    private String longitude;
    private String html_url;
    private String rss_url;
    private String xml_url;

    public String getStation_id() {
        return station_id;
    }

    public void setStation_id(String station_id) {
        this.station_id = station_id;
    }

    public String getState() {
        return state;
    }

    public void setState(String state) {
        this.state = state;
    }

    public String getStation_name() {
        return station_name;
    }

    public void setStation_name(String station_name) {
        this.station_name = station_name;
    }

    public String getLatitude() {
        return latitude;
    }

    public void setLatitude(String latitude) {
        this.latitude = latitude;
    }

    public String getLongitude() {
        return longitude;
    }

    public void setLongitude(String longitude) {
        this.longitude = longitude;
    }

    public String getHtml_url() {
        return html_url;
    }

    public void setHtml_url(String html_url) {
        this.html_url = html_url;
    }

    public String getRss_url() {
        return rss_url;
    }

    public void setRss_url(String rss_url) {
        this.rss_url = rss_url;
    }

    public String getXml_url() {
        return xml_url;
    }

    public void setXml_url(String xml_url) {
        this.xml_url = xml_url;
    }

    @Override
    public String toString() {
        return "station_id=" + getStation_id() + " station_name=" + getStation_name();
    }

} 
```

# javascript - D3 树布局不折叠

> ID：15994381
> 
> 赞同：0
> 
> 时间：2013-04-14T00:22:10.383
> 
> 标签：javascript, json, d3.js

我之前曾问过一个类似的问题，但似乎我对我的问题不够精确——希望是这样。

树布局的许多示例将其层次结构数据集格式化为：[https ://gist.github.com/tchaymore/1249394#file-math_map_compact-json](https://gist.github.com/tchaymore/1249394#file-math_map_compact-json)

但是，例如，我想将 json 中的“children”节点更改为“children1”

```
 var flare = {

"Name": "Example",
"children1": [

{
 "BName":"Ja",   
 "Email":"",
 "children1":[
 {

    "NickName":"NC",
    "id":2

 }
],

}
 ]}; 
```

当我更改了该节点的名称后，我使用了 children 函数：

```
 var tree = d3.layout.tree()
.size([height, width])
.children(function(d) { return d.children1; }); 
```

之后，我将所有“children”引用更改为“children1”等。

但是，现在我遇到了无法将树折叠回其父级的问题。我尝试将此示例用作参考，但没有运气：[http ://blog.pixelingene.com/2011/07/building-a-tree-diagram-in-d3-js/](http://blog.pixelingene.com/2011/07/building-a-tree-diagram-in-d3-js/)

这是我当前问题的一个示例：http: [//jsfiddle.net/mEyQW/1/](http://jsfiddle.net/mEyQW/1/)

..我为之前的混乱道歉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T05:53:35.727

我真的不明白你想用你的`collapse()`函数做什么，`_children1`但是如果你删除它，那么一切正常：

jsFiddle：http: [//jsfiddle.net/chrisJamesC/mEyQW/2/](http://jsfiddle.net/chrisJamesC/mEyQW/2/)

# c++ - boost::numeric::quadrature 或 gsl 正交中的加权函数

> ID：15994382
> 
> 赞同：2
> 
> 时间：2013-04-14T00:22:17.773
> 
> 标签：c++, boost, gsl

我正在尝试获取伽玛 PDF 的积分（pdf（x，a，b））并应用加权函数（w（x））。我一直在尝试为 boost 或 gsl 在 c++ 中执行此操作找到一个示例，但到目前为止还不够。

我试图将其用作 boost 中的输入函数，但它似乎不起作用

```
struct f(a, b)
{
    double operator()(double x){ return w(x)*gamma_distribution(a, b) };

} 
```

我不是 100% 确定为什么。

提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-21T23:26:17.950

首先，你的语法是错误的。你的片段应该是

```
struct f
{
    double operator()(double x) { return w(x)*gamma_distribution(a, b); }
}; 
```

# ruby - Ruby 用正则表达式计算表达式，没有 eval

> ID：15994383
> 
> 赞同：1
> 
> 时间：2013-04-14T00:22:18.140
> 
> 标签：ruby, regex, eval

对不起，如果这是重复的。我想我会稍微改一下我的问题。

我如何使用正则表达式来评估数学表达式？不使用 eval 函数。

示例表达式：

```
math1 = "1+1"
math2 = "3+2-1" 
```

我希望它适用于表达式中可变数量的数字，就像我在示例中显示的那样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T06:52:52.703

这只是个坏主意。Regexp 不是解析器，也不是评估器。

使用语法来描述你的表达方式。使用像可爱的 ruby​​ gem [Treetop](http://treetop.rubyforge.org/)这样的正式解析器来解析它。然后评估解析器生成的抽象语法树 (AST)。

天哪，Treetop 的[算术示例](https://github.com/nathansobo/treetop/tree/master/examples/lambda_calculus)实际上免费为您提供了解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-06T13:49:53.723

这有点晚了，但我写了一个用于评估任意数学表达式的 gem（它内部不使用 eval）：[https ://github.com/rubysolo/dentaku](https://github.com/rubysolo/dentaku)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T00:28:59.860

对于加法和减法，这应该有效

`(?:(/d+)([-+]))+(/d+)`

这表示：

*   一位或多位数字，后跟正好是一个加号或减号
*   以上可以根据需要重复多次（这是一个非捕获组）
*   然后必须以一位或多位数字结尾。

请注意，每个单独的数字和符号都在组 1..n 中捕获

因此，要评估，您可以使用捕获 1 和 3，应用捕获 2 中的符号。然后将捕获 4 中的符号（如果存在）与之前的结果和捕获 5 中的数字（如果捕获 4 存在，则必须存在）一起应用等等...

因此，在伪代码中进行评估：

```
 i=1
  result=capture(i)
  loop while i <= (n-2) (where n is the capture count):
    If capture(i+1) == "-" // is subtraction 
       result = result - capture(i+2)
    Else // is addition 
       result = result + capture(i+2)
    End if
    i = i + 2
  End while 
```

这仅适用于您提供的示例中的简单加法和减法，因为它依赖于从左到右的关联性。正如其他人所建议的那样，您可能需要正确解析任何更复杂的东西，例如通过构建一个节点树，然后可以以正确的（深度优先？）顺序进行评估。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T00:58:42.020

这真是乱七八糟……</p>

```
 math2 = "12+3-4"
  head, *tail = math2.scan(/(?<digits>\d+)(?<op>[\+\-\*\/])?/)
  .map{|(digits,op)| 
    [digits.to_i,op]
  }
  .reverse

  tail.inject(head.first){|sum,(digits,op)|
    op.nil? ? 
      digits : 
      digits.send(op,sum) 
    }
  # => 11 
```

不过，您确实应该考虑使用[解析器](https://github.com/mjijackson/citrus#readme)。

# asp.net-mvc - Razor 转义冒号内联

> ID：15994384
> 
> 赞同：11
> 
> 时间：2013-04-14T00:22:24.293
> 
> 标签：asp.net-mvc, razor

如何在剃刀代码中转义冒号？

这是我的问题：

```
@count@:: @item.Title - @item.Link - @item.Price 
```

在 @count 变量之后导致错误。我如何使用计数旁边的冒号？

它应该像这样呈现：

```
1: Title - Link - Price 
```

** 更新 **

我的代码块

```
@{
    int count = 0;
    foreach (var item in Model.Wishes) {
        count++;
        @count@:: @item.Title - @item.Link - @item.Price
        <br />
    }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-14T00:48:06.737

您需要将代码的显示部分包装在`<text>`标签中。冒号不需要转义。

```
@{
    int count = 0;

    foreach (var item in Model.Wishes) {
        count++;
        <text>
        @count: @item.Title - @item.Link - @item.Price
        <br />
        </text>
    }
} 
```

[https://weblogs.asp.net/scottgu/archive/2010/12/15/asp-net-mvc-3-razor-s-and-lt-text-gt-syntax.aspx](https://weblogs.asp.net/scottgu/archive/2010/12/15/asp-net-mvc-3-razor-s-and-lt-text-gt-syntax.aspx)

> `<text>`标签是 Razor 特殊处理的元素。它导致 Razor 将`<text>`块的内部内容解释为内容，并且不渲染包含`<text>`标签元素（这意味着只会渲染元素的内部内容`<text>`- 标签本身不会）。当您要呈现未由 HTML 元素包装的多行内容块时，这很方便。

[https://www.asp.net/web-pages/tutorials/basics/2-introduction-to-asp-net-web-programming-using-the-razor-syntax#BM_CombiningTextMarkupAndCode](https://www.asp.net/web-pages/tutorials/basics/2-introduction-to-asp-net-web-programming-using-the-razor-syntax#BM_CombiningTextMarkupAndCode)

> 使用`@:`运算符或`<text>`元素。输出包含纯文本或不匹配的 HTML 标记的`@:`单行内容；该`<text>`元素包含要输出的多行。当您不想将 HTML 元素呈现为输出的一部分时，这些选项很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:36:23.187

如果 count 被声明为变量，那么这应该可以工作。

```
@{
   var count = 4;
}

   @count: 
```

如果 count 是您模型的一部分，那么这应该可以。

```
@model MvcApplication4.Models.DemoViewModel

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

@Model.Count: 
```

# jquery - 通过 jQuery 设置文本的元素无缘无故地换行

> ID：15994385
> 
> 赞同：0
> 
> 时间：2013-04-14T00:22:26.820
> 
> 标签：jquery, dom

我有一些通过 jQuery 设置文本的 DIV 和 LI。

如

```
var answers = ['Participants will be added and  invited to this team', 'A Sign Up Sheet will be created'];
$('#inv-type').text(answers[value]); 
```

或者

```
$('#summary').append('<li>'+answer+'</li>'); 
```

在这两种情况下，文本在分配给 DIV 或 LI 时都会换行，尽管在这两种情况下，文本都有足够的空间不必换行。这是检查的DIV：

![在此处输入图像描述](https://i.stack.imgur.com/0Y5XQ.png)

为什么会这样？

# ios - UIGestureRecognizer 不工作

> ID：15994386
> 
> 赞同：0
> 
> 时间：2013-04-14T00:23:00.250
> 
> 标签：ios, objective-c, touch

不知道我做错了什么，但这里有一个简化的例子：

```
@interface Test : NSObject<UIGestureRecognizerDelegate> {
    UIView *_someParentView;
    UIView *_someChildView;
}
- (id)initWithParentView:(UIView *)parentView;
@end

@implementation Test

- (id)initWithParentView:(UIView *)parentView
{
    if (self = [super init])
    {
        _someParentView = parentView;
    }
    return self;
}

- (void)addSubViewsWhenReady
{
    _someChildView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 100, 100)];
    _someChildView.backgroundColor = [UIColor blackColor];
    [_someChildView setUserInteractionEnabled:YES];
    [_someParentView addSubview:_someChildView];

    UITapGestureRecognizer *singleFingerTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleSingleTap:)];
    singleFingerTap.delegate = self;
    [_someChildView addGestureRecognizer:singleFingerTap];
}

- (void)handleSingleTap:(id)sender
{
    NSLog(@"handle the single tap");
}

@end 
```

输出：“处理单击”永远不会被记录。关于我做错了什么的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-30T00:24:36.060

像你一样设置目标：

```
UITapGestureRecognizer *singleFingerTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleSingleTap:)]; 
```

是你的问题。如果这里的“self”是一个 UIViewController，它会起作用。

IE

```
@interface Test : UIViewController<UIGestureRecognizerDelegate> {
    UIView *_someParentView;
    UIView *_someChildView;
}
- (id)initWithParentView:(UIView *)parentView;
@end

@implementation Test

- (id)initWithParentView:(UIView *)parentView
{
    if (self = [super init])
    {
        _someParentView = parentView;
    }
    return self;
}

- (void)addSubViewsWhenReady
{
    _someChildView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 100, 100)];
    _someChildView.backgroundColor = [UIColor blackColor];
    [_someChildView setUserInteractionEnabled:YES];
    [_someParentView addSubview:_someChildView];

    UITapGestureRecognizer *singleFingerTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleSingleTap:)];
    singleFingerTap.delegate = self;
    [_someChildView addGestureRecognizer:singleFingerTap];
}

- (void)handleSingleTap:(UIGestureRecognizer*)recognizer    {
    NSLog(@"handle the single tap");
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T00:41:36.000

尝试将您的定义更改`handleSingleTap:`为

```
- (void)handleSingleTap:(UIGestureRecognizer*)recognizer {
    NSLog(@"handle the single tap");
} 
```

* * *

从`UIGestureRecognizer`文档：

> 手势识别器有一个或多个与之关联的目标-动作对。如果有多个目标-动作对，它们是离散的，而不是累积的。手势的识别导致将动作消息分派到这些对中的每一对的目标。**调用的操作方法必须符合以下签名之一**：
> 
> `- (void)handleGesture;`
> 
> `- (void)handleGesture:(UIGestureRecognizer *)gestureRecognizer;`

# javascript - iframe 不会动态调整大小

> ID：15994387
> 
> 赞同：0
> 
> 时间：2013-04-14T00:23:05.743
> 
> 标签：javascript, jquery, html, iframe

这已经被问过很多次了，但我问是因为没有解决方案对我有用，而且我还没有找到很多合适的解决方案。我想要一个静态宽度，但是一个基于内部内容的动态高度。

我在子域上托管一个博客，并通过 iframe 将其插入到我的主域上的页面中。我可以设置静态高度和滚动，以便用户仍然可以使用博客，但我想要看起来更好的东西。当我发布新帖子，或者用户点击评论部分时，我希望 iframe 能够自动调整大小，以便它可以在没有滚动条的情况下显示所有内容。

到目前为止，我还没有找到有效的解决方案，主要是因为许多涉及同一域中的页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:01:35.053

由于您可以控制 iframe 中的内容，您可以尝试窗口[消息](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage "信息")事件。

将此添加到您的框架内容中：

```
// post a message to the top window with information about the height
window.onload = function(){
    top.postMessage(document.body.scrollHeight, '*');
} 
```

这到包含 iframe 的页面：

```
// listen for the message and set the iframe height when it arrives
window.addEventListener( "message", function(event){
    document.getElementById('test').style.height = event.data+'px';
}, false);

<iframe id="test" src="test.html"/> 
```

* * *

回应您的评论。当 iframe 内容更改时，您可以通过以下方式更新 iframe 高度。

**1.** [突变事件](https://developer.mozilla.org/en-US/docs/DOM/Mutation_events "突变事件")

```
// listen to all descendants of the body and if there are any modifications, post an update to the top window 
document.body.addEventListener("DOMSubtreeModified", function(){
    top.postMessage(document.body.scrollHeight, '*');
}, false); 
```

这种方法已被贬低。这是替代品，但尚未完全支持：

**2.** [突变观察者](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver?redirectlocale=en-US&redirectslug=DOM/DOM_Mutation_Observers "突变观察者")

```
// create a MutationObserver to listen for modification to the body and post an update to the top window
var observer = new MutationObserver(function(){
    top.postMessage(document.body.scrollHeight, '*');
});
observer.observe(document.body, {childList: true, subtree: true}); 
```

我会选择第一个选项，直到第二个得到更好的支持

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-21T23:56:00.597

只是想我会补充一点，**offsetHeight**比**scrollHeight**更可靠，用于计算 iFrame 的大小。只要将正文边距设置为 0。问题是 ScrollHeight 只会增加页面的大小，不会减小它。[可以克服](https://stackoverflow.com/questions/22402895/why-does-document-body-offsetheight-document-body-bottommargin-not-equal-docum)边距问题，但是如果您关心**IE8** ，则代码量很大。

MutationEvents 已死，请使用**MutationObserver**。虽然它在 IE10 及更低版本中不起作用，但您必须退回到**setInterval** ，如果您不希望用户看到任何屏幕闪烁，您应该使用**32的计时器。****RequestAnimationFrame**也有助于消除屏幕闪烁。

您可能有兴趣查看处理所有这些问题的[https://github.com/davidjbradshaw/iframe-resizer 。](https://github.com/davidjbradshaw/iframe-resizer)

# javascript - Node.js 和 socket.io，客户端不共享计数器

> ID：15994390
> 
> 赞同：0
> 
> 时间：2013-04-14T00:23:52.977
> 
> 标签：javascript, node.js, scope, socket.io

我正在玩 node.js 和 socket.io，试图让计数程序正常工作。基本上它应该是每次连接的客户端按下按钮时将共享计数器增加 1，并将该数字显示给所有连接的客户端。

我得到的是每个客户都有一个单独的计数器。例如，如果我在一个客户端上数到 10，然后开始从另一个客户端开始数，它从 1 开始。如果我回去，第一个客户端将从 10 恢复。我已经尽力解决这个问题，但是当涉及到 JS 范围问题（我怀疑这是）或套接字时，我不太了解。

```
var socketio = require('socket.io');
var io;
var count = 1;

exports.listen = function(server){
    io = socketio.listen(server);
    io.set('log level', 1);

    io.sockets.on('connection', function (socket){
        joinRoom(socket, 'Lobby');
        count = handleCounter(socket, count);
    });
};

function handleCounter(socket, count){
    socket.on('endCount', function(){
        io.sockets.emit('endCount', {
            success: true,
            num: count
        });
            count++;
            console.log(count);
    });
    return count;
}

function joinRoom(socket, room){
    socket.join(room);
} 
```

作为一个注释，我之前只是将handleCounter中的代码放入`io.sockets.on('connection')`函数中时它工作过，但我想知道为什么当我尝试像上面的代码一样将它放在外面时它不会工作。

非常感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T01:14:20.473

您`count`在 结束时返回`handleCounter()`，但它在异步函数中递增，因此在返回之前它没有递增。

`count`您可以直接引用`count`您在文件顶部声明的变量，而不是四处传递，该变量在您的所有闭包中都可用。`endCount`如果您只想在每次客户端连接时向客户端发送新计数，您也不需要侦听器和发射器。

```
var socketio = require('socket.io');
var io;
var count = 1;

exports.listen = function(server){
    io = socketio.listen(server);
    io.set('log level', 1);

    io.sockets.on('connection', function (socket){
        joinRoom(socket, 'Lobby');
        handleCounter();
    });
};

function handleCounter(){
    count++;
    console.log(count);

    io.sockets.emit('count', {
        success: true,
        num: count
    });
}

function joinRoom(socket, room){
    socket.join(room);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:10:05.437

[http://realtimeanswer-5042.usw1.actionbox.io:4000/](http://realtimeanswer-5042.usw1.actionbox.io:4000/)

简而言之，在连接时发送数据，并在单击按钮时将数据发送给所有客户端。

客户端只有在从服务器收到消息时才更新 dom。

我在您的代码中看到的最大问题是您使计数范围复杂化。它是模块范围，可以简单地使用而无需传递它。

服务器：

```
var app = require('express')()
  , server = require('http').createServer(app)
  , io = require('socket.io').listen(server)
  , count = 0;

var port = 4000;

server.listen(port);

app.get('/', function (req, res) {
  res.sendfile(__dirname + '/index.html');
});

io.set('log level', 1);

io.sockets.on('connection', function (socket) {
  console.log(count);
  socket.emit('count', count);
  socket.on('inc', function () {
    count++;
    console.log('inc', count);
    io.sockets.emit('count', count);
  });
}); 
```

客户

```
<!DOCTYPE html>
<meta charset='utf-8'>
<title>real time fun</title>
<script src="/socket.io/socket.io.js"></script>
<script src="http://code.jquery.com/jquery.js"></script>

<script>
  $(function() {
    var socket = io.connect();

    socket.on('count', function (count) {
      $('#count').text(count);
    });

    $('button').click(function () {
      socket.emit('inc');
    });
  });
</script>
<div id='count'></div>
<button>inc</button> 
```

# ember.js - Ember 控制台不工作

> ID：15994391
> 
> 赞同：0
> 
> 时间：2013-04-14T00:24:15.013
> 
> 标签：ember.js

我正在按照官方网站上[的指南进行操作。](http://youtu.be/Ga99hMi7wfY?t=16m46s)它向我展示了在浏览器控制台中进行了一些模型更改，例如：

`App.Post.find(1)`

但在我的电脑上显示![在此处输入图像描述](https://i.stack.imgur.com/RpLCN.png)

任何想法？

* * *

这是我的测试代码的[git repo](https://github.com/markson/ember-tutorial-learning)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:54:51.910

因为您使用的是自动将所有代码包装在匿名函数中的 CoffeeScript，所以您需要将 App 变量初始化为 window.App 以便在您的 app.coffee 文件之外访问它。

`window.App = Ember.Application.create...`

# ajax - 使用 "var X = document.getElementById("X");" 从表单中收集 var

> ID：15994394
> 
> 赞同：1
> 
> 时间：2013-04-14T00:24:24.617
> 
> 标签：ajax, getelementbyid

很棒的网站，出色的贡献者，我提前感谢您。

（咆哮）>72 小时，头发减少 50%，谷歌搜索“.ajax 简单示例”= 网络上没有简单、有效的示例 - :-)(/rant)

我正在从一个表单中收集数据，将该数据传递给一个 javascript 例程，该例程启动一个写入我的数据库的 php 文件。一切都很好 - 这是简单的工作脚本：

```
<script type="text/javascript">
$(document).ready(function(e) {
$("#submitbutton").click(function() {

var ln = 'DaVinci';
var fn = 'Leonardo';
$.ajax({
        type: "POST",
        url: "testbackendinsert.php",
        data: {lastname: ln, firstname: fn}
       })
        .done( function( msg ) {alert( "Data Saved: " + msg );});

});
});     
</script> 
```

我可以将任何字符串放入 ln 和 fn 变量中，数据最终会出现在 db 中。

当我将表单放入（EASY，一个输入，一个按钮）时：

```
<form><table>
<tr><td>First Name</td><td><input type="text" id="fn" name="FirstName"></td></tr> 
<tr><td colspan="2"><input type="submit" id="submitbutton" value="Submit" /></td></tr>
</table></form> 
```

并使用这条线

```
var ln = document.getElementById("fn"); 
```

代替 var ln = "Somedudesname"; 它不起作用，或者崩溃（是的，崩溃，挂起）IE（我必须关闭并重新打开）。我已经尝试过 ("fn")、('fn')、(#fn)、('#fn')、("#fn") 并且不行。我敢肯定这是微不足道的（总是如此）-我错过了什么？

## 非常感谢！

## 这是整个代码：

HTML/JavaScript

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="jquery-1.9.1.js"></script>
<title>test ajax frontend</title>

<style>
#divtest {
    width:40%;
    background-color:#C1C1FD;
    text-align:left;
    margin-left:auto;
    margin-right:auto;
    margin-top:5%;
    font-size:16px;
    line-height:16px;
    border: 20px solid #FCD1E3;}
</style>
</head>

<body>

<div id="divtest">
<form>
<table>
<tr><td>First Name:</td><td><input type="text" id="fn" name="FirstName"></td></tr>
<tr><td>Last Name:</td><td><input type="text" id="ln" name="FirstName"></td></tr>
<tr><td>Zip code:</td><td><input type="text" id="zp" name="FirstName"></td></tr> 
<tr><td colspan="2"><input type="submit" id="submitbutton" value="Submit" /></td></tr>
</table>
</form>
</div>

<script type="text/javascript">
$(document).ready(function(e) {
$("#submitbutton").click(function() {

var ln = document.getElementById("ln").value;
var fn = document.getElementById("fn").value;
var zp = document.getElementById("zp").value;
$.ajax({
        type: "POST",
        url: "testbackendinsert.php",
        data: {lastname: ln, firstname: fn, zip: zp}
       })
        .done( function( msg ) {alert( "Data Saved: " + msg );});

});
});     
</script>

<!--
document.getElementById("fn")
document.getElementById("ln")
-->

</body> 
```

## 这是写入数据库的 php：

```
<?php
echo "<title>Read db table.php</title>";

$ln = $_POST['lastname'];
$fn = $_POST['firstname'];
$z = $_POST['zip'];

$host = "name of host";
$user = "username";
$password = "password";
$dbname = "dbname";

$cxn = mysqli_connect($host,$user,$password,$dbname);
if (mysqli_connect_errno()) {echo "No connection" . mysqli_connect_error();}
echo "connection made";

$query = "INSERT INTO testtable (lastname, firstname, zip) VALUES ('$ln', '$fn', '$z')";

$result = mysqli_query($cxn, $query) or die ("No query");
mysqli_close($cxn);
?> 
```

祝大家编码愉快！再次感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-14T00:27:54.623

您可能想要获取该元素的值：

```
var ln = document.getElementById("fn").value; 
```

或者使用 jQuery：

```
var ln = $("#fn").val(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T00:31:10.367

我怀疑你正在寻找：

```
var ln = document.getElementById("fn").value 
```

获取输入的值。`.getElementById()`只会将元素本身存储在 var 而不是 value 属性中。

# php - CodeIgniter 表单验证问题

> ID：15994395
> 
> 赞同：0
> 
> 时间：2013-04-14T00:24:35.817
> 
> 标签：php, codeigniter, validation

像往常一样，我设置表单验证的规则，如果它们没有通过，我`$this->load->view()`会再次使用并加载表单。

在 Firefox 和 Opera 上一切正常。但是在所有其他浏览器中，当表单验证没有通过并且再次加载表单时，文档会被格式化。我使用 HTML Tidy 来检查我是否错过了结束标签或其他东西，但一切都很好。

我还使用 W3C HTML5 Validator 检查了源代码。文件通过，没有错误。然后，我运行了表单验证并再次检查了相同的源代码。这次验证器出现了 5 个错误。

```
 Line 2, Column 1: Non-space characters found without seeing a doctype first. Expected <!DOCTYPE html>.
<!DOCTYPE html>

 Line 2, Column 1: Element head is missing a required instance of child element title.
<!DOCTYPE html>
Content model for element head:
If the document is an iframe srcdoc document or if title information is available from a higher-level protocol: Zero or more elements of metadata content.
Otherwise: One or more elements of metadata content, of which exactly one is a title element.

 Line 2, Column 16: Stray doctype.
<!DOCTYPE html>

 Line 3, Column 19: Stray start tag html.
<html lang="pt-br">

 Line 3, Column 19: Cannot recover after last error. Any further errors will be ignored.
<html lang="pt-br"> 
```

`<!DOCTYPE html>`我知道，在事情变得糟糕之前，当有事情发生时。但我那里没有任何变量。也许 CI 正在产生一些东西。

有没有人可以帮忙？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T01:51:04.003

问题是我的应用程序中有两个带有 BOM 文件的 UTF-8。因此，如果表单验证返回 false 并重新加载视图，则在导致这些错误`EF BB BF`之前将字节集添加到文档的开头。`<!DOCTYPE html>`所以我将这两个文件保存为没有BOM编码的UTF-8，现在一切正常。

# javascript - 使用 bootstrap/jquery 在图像加载上制作进度条

> ID：15994397
> 
> 赞同：4
> 
> 时间：2013-04-14T00:24:49.517
> 
> 标签：javascript, jquery, progress-bar

我尝试在图像加载时使用引导 css 制作进度条。为此，我使用以下脚本：

```
<html>
<head>
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet"/>
<script type="text/javascript">

var n=0;
var c=0;

$('img').each(function() {
    n++; 
    var tmpImg = new Image() ;
    tmpImg.src = $(this).attr('src') ;
    tmpImg.onload = function() {
    c++;
    };
    });

var interval = setInterval(function() {
    percent = n/100;
    loaded = c/percent;

    // for displaying purposes
    setBar(getBar()+50)
    // feed loaded var to the progressbar
    if (loaded == 100) {
    clearInterval(interval);
    }

    }, 1);

function setBar(n) {
  var bar = document.getElementById('fabbar');
  bar.style.width = n+'%';
}
function getBar() {
  var bar = document.getElementById('fabbar');
  return parseInt(bar.style.width);
}

</script>

</head>
<body>

<div class="progress progress-info progress-striped active">
<div class="bar" id='fabbar' style="width: 20%"></div>
</div> 
```

但这不起作用，即进度条没有进展。我怎么能那样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T03:36:25.163

试试这个（[演示](http://jsfiddle.net/Mottie/yphM4/)）：

```
$(function () {
    var n = 0,
        $imgs = $('img'),
        val = 100 / $imgs.length,
        $bar = $('#fabbar');

    $imgs.load(function () {
        n = n + val;
        // for displaying purposes
        $bar.width(n + '%').text(n + '%');
    });
}); 
```

# c# - 预处理文件

> ID：15994400
> 
> 赞同：-4
> 
> 时间：2013-04-14T00:24:59.737
> 
> 标签：c#

我的 PC 中有一个包含很多音乐的文件夹，并且我想在另一台 PC 中列出我的音乐，而不为我的另一台 PC 获取文件，换句话说，我想预处理音乐文件并列出我的另一台电脑....

我将开发服务器和客户端，如何进行这种转移的最佳方式？

如何进行音乐文件的预处理和客户端接收音乐预处理信息并播放音乐？

对于IP系统，我将使用Hamachi，因为我没有固定IP，或者我有其他方法可以建立这个连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:29:38.337

您可以[`Socket`](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.aspx)在服务器和客户端上创建一个。服务器侦听连接，客户端连接到服务器。只要你能弄清楚服务器的IP（例如它是固定的，或者你有一个总是解析到正确地址的域名），那么你就可以让它工作。

查找 ID3 标签库以从您的音乐文件中读取元数据。然后您可以发送元数据并在另一侧列出您的所有音乐。

# java - Java中的排名。如何设置？

> ID：15994401
> 
> 赞同：1
> 
> 时间：2013-04-14T00:25:00.253
> 
> 标签：java

我有一个名为排名的课程。它有一定的等级：将军、士兵、下士、市长。

现在我需要通过排名将其设置为默认值：

1.  士兵
2.  下士
3.  市长
4.  一般的。

这是会员：

```
private static char Ranks[]; // size 4 
```

我在哪里可以默认设置它们，例如：

```
Ranks[0] = soldier;
Ranks[1] = corporal... 
```

我真的不知道将默认值放在哪里，所以程序会知道默认情况下士兵是 Ranks[0]。进入构造函数？入会员？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-14T00:26:44.637

我建议改用枚举。

您可以在类中有一个常量，使用 Enum 来指出默认值，并有一个构造函数/设置器来代替另一个。

```
public enum Rank {
    SOLDIER, CORPORAL, MAYOR, GENERAL
} 
```

...

```
public class MilitaryPerson {

    private static final Rank DEFAULT_RANK = Rank.SOLDIER;

    private Rank rank;

    public MilitaryPerson() {
        this.rank = DEFAULT_RANK;
    }

    public MilitaryPerson(Rank rank) {
        this.rank = rank;
    }

    // ...

} 
```

另一种（更好的）解决方案是在配置文件中设置默认值（例如 *.properties）

# php - 如何在 PHP 中解析 JSON 对象？

> ID：15994405
> 
> 赞同：2
> 
> 时间：2013-04-14T00:25:40.877
> 
> 标签：php, json, parsing, post

我有一个要发送到 PHP 脚本的 JSON 对象，但在解析 JSON 时遇到了问题。这是 POST 请求：

```
http://mywebsite.com?action=somefunction&{%22id%22:1,%22Name%22:%22Mike%22} 
```

这是我的 PHP 函数，它显然不起作用：

```
$data = $_GET['data'];
$obj = json_decode($data);
echo $obj->Name;
die(); 
```

最终目标是从 URL 字符串中提取名称“Mike”。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T00:27:32.693

尝试查看 PHP 输出的内容`json_decode()`：

```
$data = $_GET['data'];
$obj = json_decode($data);
var_dump($obj); 
```

您的代码本身工作正常：http: [//ideone.com/0jsjgT](http://ideone.com/0jsjgT)

`data=`但是您的查询字符串在实际 JSON 之前缺少。这个：

```
http://mywebsite.com?action=somefunction&{%22id%22:1,%22Name%22:%22Mike%22} 
```

应该是这样的：

```
http://mywebsite.com?action=somefunction&data={%22id%22:1,%22Name%22:%22Mike%22} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T00:27:23.853

你应该做

```
echo $obj->{'Name'}; 
```

这也是[json_decode 对 Echo data json的重复问题](https://stackoverflow.com/questions/7823563/echo-data-json-by-json-decode)

# elasticsearch - ElasticSearch 查询搜索消息并限制到节点id

> ID：15994410
> 
> 赞同：0
> 
> 时间：2013-04-14T00:26:30.350
> 
> 标签：elasticsearch, dsl

我在 ElasticSearch 中有以下映射：

```
{
  "xenforo" : {
    "post" : {
      "_source" : {
        "enabled" : false
      },
      "properties" : {
        "date" : {
          "type" : "long",
          "store" : "yes"
        },
        "discussion_id" : {
          "type" : "long",
          "store" : "yes"
        },
        "message" : {
          "type" : "string"
        },
        "node" : {
          "type" : "long"
        },
        "thread" : {
          "type" : "long"
        },
        "title" : {
          "type" : "string"
        },
        "user" : {
          "type" : "long",
          "store" : "yes"
        }
      }
    }, 
```

我想在消息字段中搜索单词 test 但将其限制为节点 id 5。我将如何修改此 DSL 搜索？

```
$data_string = '{
"from" : 0, "size" : 100,
"sort" : [
    { "date" : {"order" : "desc"} }
],
"query": {
        "match" : {
            "message" : {
                "query" : "test"
            }
        }
    }
}'; 
```

感谢您的协助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:41:41.553

您可以使用[过滤](http://www.elasticsearch.org/guide/reference/query-dsl/filtered-query/)查询：

```
{
  "from": 0,
  "size": 100,
  "sort": [{
    "date": {
      "order": "desc"
    }
  }],
  "query": {
    "filtered": {
      "query": {
        "match": {
          "message": {
            "query": "test"
          }
        }
      },
      "filter": {
        "term": {
          "node": 5
        }
      }
    }
  }
} 
```

# javascript - 将 jquery 函数应用于 JSON 数组？

> ID：15994414
> 
> 赞同：0
> 
> 时间：2013-04-14T00:26:53.463
> 
> 标签：javascript, jquery

我写了一个简单的函数来通过 JSON 数组值应用数学，它没有问题。

```
$(document).ready(function(){
    var arr1 = {"gold":"1000","iron":"2000","wood":"4500","food":"800"} ;
    var arr2 = [{"gold":"100","iron":"80","wood":"120","food":"70"}];
    Array.max = function( array ){
    return Math.max.apply( Math, array );
    };
    Array.min = function( array ){
        return Math.min.apply( Math, array );
    };
    function getValidenum(resources,cost) {
        var output = [] ;
         $.each(cost, function(i, item) {
          output.push(Math.floor(resources.gold / item.gold)) ;  
          output.push(Math.floor(resources.iron / item.iron)) ;
          output.push(Math.floor(resources.wood / item.wood)) ;
          output.push(Math.floor(resources.food / item.food)) ;
        });
        return Array.min(output) ;
    }
    alert(getValidenum(arr1,arr2));
}); 
```

当我向第二个数组添加更多值并尝试循环遍历数组以应用函数时，就会出现问题。

```
$(document).ready(function(){
    var arr1 = {"gold":"1000","iron":"2000","wood":"4500","food":"800"} ;
    var arr2 = [{"gold":"100","iron":"80","wood":"120","food":"70"},{"gold":"10","iron":"20","wood":"50","food":"30"}];
    Array.max = function( array ){
    return Math.max.apply( Math, array );
    };
    Array.min = function( array ){
        return Math.min.apply( Math, array );
    };
    function getValidenum(resources,cost) {
        var output = [] ;
         $.each(cost, function(i, item) {
          output.push(Math.floor(resources.gold / item.gold)) ;  
          output.push(Math.floor(resources.iron / item.iron)) ;
          output.push(Math.floor(resources.wood / item.wood)) ;
          output.push(Math.floor(resources.food / item.food)) ;
        });
        return Array.min(output) ;
    }
     $.each(arr2, function(i, item) {
          alert(getValidenum(arr1,item));
        });

}); 
```

而不是为 arr2 中的 2 个数组显示 2 次结果

```
var arr2 = [{"gold":"100","iron":"80","wood":"120","food":"70"},{"gold":"10","iron":"20","wood":"50","food":"30"}]; 
```

它显示 NaN 两次

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:04:48.073

您已经更改了`getValidenum`在两个示例之间用作第二个参数的内容。

在第一个中`arr2`，您传入一个对象数组。

在第二个中，您传入`item`匿名函数的参数，即`arr2`数组中的一个对象。

如果您将第一个示例更改为也使用`$.each`in 调用`getValidenum`，您会看到类似的失败。

当参数 of是一个对象`NaN`时，它本身会产生结果，因为它会将对象属性拆分为 key ( ) 和 value ( )。因此，在第二个示例的迭代中，您将具有以下值：`cost``getValidenum``.each``i``item`

```
i === "gold"
item === "100" 
```

然后，当您尝试访问时`item.gold`，您实际上是在询问除以它时`"100".gold`哪个是`undefined`和产生。`NaN`

# c# - C# Tabless 控件上一个/后退/返回按钮失败？

> ID：15994419
> 
> 赞同：0
> 
> 时间：2013-04-14T00:27:42.570
> 
> 标签：c#

我希望这里有人可以帮助我，我的 Windows 窗体应用程序上有一个 Tabless 控件，基本上因为这些选项卡是故意隐藏的，所以我在每个选项卡“下一步”和“返回”中添加了 2 个按钮。

这是我的“下一步”按钮的代码片段：

```
private void nextbutton1_Click(object sender, EventArgs e)
{
    tabControl1.SelectedTab = tabPage3;
    this.toolStripStatusLabel8.Text = System.DateTime.Now.ToString();
} 
```

效果很好，但是当我在“返回”按钮上使用完全相同的理论时，它不起作用：

```
private void backbutton1_Click(object sender, EventArgs e)
{
    tabControl1.SelectedTab = tabmain;
    this.toolStripStatusLabel1.Text = System.DateTime.Now.ToString();
} 
```

所以我的问题是如何从按钮转到上一个标签页？我已经浏览过这里并尝试了所有出现的链接，但没有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T02:37:39.180

您应该使用该`SelectedIndex`属性而不是使用具体`TabPage`实例。这样，当您决定更改 pab 页面的顺序或添加新页面时，它仍然可以工作：

```
private void previousButton_Click(object sender, EventArgs e)
{
    if (tabControl1.SelectedIndex > 0)
    {
        tabControl1.SelectedIndex--;
    }
}

private void nextButton_Click(object sender, EventArgs e)
{
    if (tabControl1.SelectedIndex < tabControl1.TabCount - 1)
    {
        tabControl1.SelectedIndex++;
    }
} 
```

由于 .NET Framework 中没有“Tabless”选项卡控件，我只能假设它的工作方式类似于标准的[`TabControl`](http://msdn.microsoft.com/library/system.windows.forms.tabcontrol.aspx). 如果解决方案不起作用，您应该向我们提供有关您使用的实际类的一些信息。

顺便说一句：没有必要重复每一页上的按钮。为什么不把按钮放在 TabControl 之外呢？

另外：我看到您使用 a`ToolStripStatusLabel`来显示当前时间。而不是每次用户单击某处时都更新它，而是将 a 添加`Timer`到您的表单中。将其设置`Interval`为 1000 并处理其`Tick`事件。在那里更新标签：

```
private void timer1_Tick(object sender, EventArgs e)
{
    toolStripStatusLabel1.Text = DateTime.Now.ToLongTimeString();
} 
```

这样它会不断更新，无需重复任何内容。您需要调用`timer1.Start()`表单的构造函数。

# python - 我如何在 django python 中进行面向方面的编程

> ID：15994422
> 
> 赞同：0
> 
> 时间：2013-04-14T00:28:21.570
> 
> 标签：python, django, signals

我正在使用 django 并且我有非常复杂的权限矩阵。假设我有 10 组权限组，例如

`Permissions = [basic, medium, advanced , very advanced , admin , superadmin , public , etc]`

另一件事是我有 10 个模型，并且所有模型`view, edit`对每个组都有不同的权限，所以总的来说，规则变成了一种`10 X 10`等等。

我现在没有权限就拥有所有代码。我真的不想在所有地方触摸当前代码进行权限检查。

我需要在以下地方进行权限检查

权限将基于登录的用户权限组

1.  在模板中，我们将根据权限显示编辑、插入、删除按钮
2.  在显示之前的视图中，检查用户是否可以查看/更新/删除它

有没有办法在显示`delete,update,insert`系统的任何视图之前自动从权限矩阵中检查，而无需在视图中编写任何代码。

然后只剩下可以在需要时编写的模板

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:34:11.400

我相信您只是在寻找 Django 在模板中提供的权限变量

[https://docs.djangoproject.com/en/1.5/topics/auth/default/#permissions](https://docs.djangoproject.com/en/1.5/topics/auth/default/#permissions)

```
{% if perms.foo %}
    <p>You have permission to do something in the foo app.</p>
    {% if perms.foo.can_vote %}
        <p>You can vote!</p>
    {% endif %}
    {% if perms.foo.can_drive %}
        <p>You can drive!</p>
    {% endif %}
{% else %}
    <p>You don't have permission to do anything in the foo app.</p>
{% endif %} 
```

示例中间件：

```
from django import http

class PermissionMiddleware(object):
    def process_view(self, request, view_func, view_args, view_kwargs):
        # you should somehow derive this from the view function and/or view args/kwargs
        your_object = SomeThing.objects.get(...)

        if not request.user.has_perm('name_of_your_object.permission'):
            return http.HttpResponseForbidden() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-16T10:37:50.027

在视图中，您可以使用[权限装饰器](https://docs.djangoproject.com/en/2.2/topics/auth/default/)！

它们看起来像这样：

```
from django.contrib.auth.decorators import login_required

@login_required
def my_view(request):
    ... 
```

或者这个，不仅仅是登录，即权限：

```
from django.contrib.auth.decorators import permission_required

@permission_required('polls.can_vote')
def my_view(request):
    ... 
```

如果您需要更复杂的场景（这些是我为自己制作的），您还可以定义自己的装饰器：

```
from django.contrib.auth.decorators import user_passes_test
from django.core.exceptions import PermissionDenied

def group_required(*group_names):
    """Requires user membership in at least one of the groups passed in."""

    def in_groups(u):
        if u.is_authenticated:
            if u.groups.filter(name__in=group_names).exists() | u.is_superuser:
                return True
        return False
    return user_passes_test(in_groups)

def superuser_only(function):
    """Limit view to superusers only."""

    def _inner(request, *args, **kwargs):
        if not request.user.is_superuser:
            raise PermissionDenied
        return function(request, *args, **kwargs)
    return _inner

def has_group(user, group_name):
    return user.groups.filter(name=group_name).exists() 
```

...并像这样使用它们：

```
@login_required
@group_required('A', 'B')
def my_view(request):
    .... 
```

为了在模板中使用，您可以定义自己的模板标签：

```
from django import template

register = template.Library()

@register.filter
def multiply(value, arg):
    return (value * arg) 
```

# php - MySQL查询返回双打

> ID：15994427
> 
> 赞同：1
> 
> 时间：2013-04-14T00:29:44.147
> 
> 标签：php, mysql, sql

出于某种原因，当我运行此查询时，它会两次返回相同的数据（双倍）。数据只在数据库中一次。为什么它返回双打？我想不通。

注意：我是这类查询的新手，因此非常感谢任何指导。

```
SELECT 
             `conversations_messages`.`message_date`,
             `conversations_messages`.`message_date` > `conversations_members`.`conversation_last_view` AS `message_unread`,
             `conversations_messages`.`message_text`,
             `users`.`username`
      FROM   `conversations_messages`
      INNER JOIN `users` ON `conversations_messages`.`user_id` = `users`.`user_id`
      INNER JOIN `conversations_members` ON `conversations_messages`.`conversation_id` = `conversations_members`.`conversation_id`
      WHERE `conversations_messages`.`conversation_id` = {$conversation_id}
      ORDER BY `conversations_messages`.`message_date` DESC 
```

.....这是完整的功能。

```
function fetch_conversation_messages ($conversation_id) {
$conversation_id=(int)$conversation_id;
$sql="SELECT 
             `conversations_messages`.`message_date`,
             `conversations_messages`.`message_date` > `conversations_members`.`conversation_last_view` AS `message_unread`,
             `conversations_messages`.`message_text`,
             `users`.`username`
      FROM   `conversations_messages`
      INNER JOIN `users` ON `conversations_messages`.`user_id` = `users`.`user_id`
      INNER JOIN `conversations_members` ON `conversations_messages`.`conversation_id` = `conversations_members`.`conversation_id`
      WHERE `conversations_messages`.`conversation_id` = {$conversation_id}
      ORDER BY `conversations_messages`.`message_date` DESC";

     $result = mysqli_query($sql);
     $messages = array();

     while (($row= mysqli_fetch_assoc($result)) !== false){
       $messages[] = array(
            'date'      => $row['message_date'],
            'unread'    => $row['message_unread'],
            'text'      => $row['message_text'],
            'username'  => $row['username'],
       );
}
     return $messages; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:37:48.657

您的查询正在创建[笛卡尔积](http://en.wikipedia.org/wiki/Cartesian_product)。我假设每条消息有两个对话成员，并且加入匹配他们两个。

# python - 斐波那契数列

> ID：15994428
> 
> 赞同：-2
> 
> 时间：2013-04-14T00:29:45.427
> 
> 标签：python, while-loop, sequence, fibonacci

我正在尝试计算 100 以下的斐波那契数列的数量，但我编写的代码不起作用。我所拥有的是：

```
def fib(n):
    if n == 0:
        return 0
    elif n == 1:
        return 1
    else:
        return fib(n-1) + fib(n-2)
num=0
while(num<100):
        print (fib(num))
        num+=1 
```

我认为这应该可行，但它没有，所以这绝对是我的编码问题。谁能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:36:55.690

那么这段代码不起作用怎么办？看起来实现是正确的，但它当然很慢。您可以尝试将计算的数字存储在某种数据结构中，以减少堆栈跟踪并避免在尝试计算 24 的 fib 时重新计算 23 的 fib。

# asp.net - ASP:Dropdownlist onselectedindexchanges 函数不会触发，即使我将自动回发设置为 true

> ID：15994429
> 
> 赞同：2
> 
> 时间：2013-04-14T00:29:49.737
> 
> 标签：asp.net, drop-down-menu, autopostback

我正在使用向导。在第二步中，用户可以添加有关将要存储的位置的信息。他可以根据需要添加任意数量的位置。在第三步中，我想输入有关特定位置的更多信息。要选择要使用的位置，我有 ASP:dropdownlist，当用户输入内容时我会填充它。我想更改索引，但它不起作用当我尝试调试时它永远不会进入函数。我正在使用标签进行调试。

当我更改所选项目时，页面会重新加载，并且下拉列表中的第一个项目始终被选中，即使我选择了其他内容。我不明白为什么会这样

这是我拥有的 ASPX 文件

```
Select location to enter data for:
<asp:DropDownList ID="s3_location_list" runat="server" AutoPostBack="true" OnSelectedIndexChanged="stepThree_location_list_SelectedIndexChanged">
                </asp:DropDownList>
                &nbsp;&nbsp; Current location index:
                <asp:Label ID="Label3" runat="server" Text="Label"></asp:Label> 
```

CS文件

/*这是我在下拉列表中添加数据的地方

```
protected void stepTwo_addLocationData(object Sender, System.EventArgs e)
    {
        //initialize a temporary string array to get all the data from the form

        //Console.Write("AAAAA"+ Context.Items["IsRefreshed"]);

        Boolean refreshed = (Boolean)Context.Items["IsRefreshed"];
        if (!refreshed)
        {
            //if user is adding a new entry to the location table

            LocationData new_location = new LocationData();
            //add stuff to locationData

            if (stepTwo_locationTableIndex == -1)
            {
                //add the new_location element into the location_data array
                location_data.Add(new_location);

                //redraw the table
                DataRow dr = dt.NewRow();
                dr["Location"] = new_location.City;
                //dr["Name"] = loc;
                dt.Rows.Add(dr);

            }
            else
            {
                location_data[stepTwo_locationTableIndex] = new_location;
                dt.Rows[stepTwo_locationTableIndex]["Location"] = City.Text;
            }

            GridView1.DataSource = dt.DefaultView;
            GridView1.DataBind();
            ///CreateTable();
            stepFive_setLocationListOptions();
            stepThree_setLocationListOptions();
            stepTwo_resetForm();
     } 
```

/*这是第3步的页面加载

```
protected void stepThree_load()
    {
        if (!IsPostBack && Session["s_s3_locationDropdownIndex"] == null)
        {
            stepThree_locationDropdownIndex = s3_location_list.SelectedIndex;
            Session["s_s3_locationDropdownIndex"] = stepThree_locationDropdownIndex;
        }
        else
        {
            stepThree_locationDropdownIndex = (int) Session["s_s3_locationDropdownIndex"];
        }

        s3_location_list.SelectedIndex = stepThree_locationDropdownIndex;
        Label3.Text = "" + s3_location_list.SelectedIndex;

    } 
```

/*这是我填充列表的地方

```
 protected void stepThree_setLocationListOptions()
    {
        s3_location_list.Items.Clear();
        int i = 0;
        foreach (LocationData item in location_data)
        {
            s3_location_list.Items.Add(new ListItem(item.City, "" + i));
        }
        s3_location_list.DataBind();
    } 
```

/*这是更改选定索引时的函数。

```
 protected void stepThree_location_list_SelectedIndexChanged(object sender, EventArgs e)
    {
        Label3.Text = "Hello";
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:36:41.797

我认为问题在于执行顺序。您应该只初始化`DropDownList`一次，否则它将覆盖您的`SelectedIndex`. 例如，使用`OnInit`事件：

```
<asp:DropDownList ID="s3_location_list"
                  runat="server"
                  OnInit="s3_location_list_Init"/> 
```

并像这样编写事件方法：

```
protected void s3_location_list_Init(object sender, EventArgs e)
    if (!IsPostBack) {
        foreach (LocationData item in location_data)
        {
            s3_location_list.Items.Add(new ListItem(item.City, "" + i));
        }
        s3_location_list.DataBind();
    }
} 
```

# sql - SQL：查找包含用户列表的团队

> ID：15994430
> 
> 赞同：1
> 
> 时间：2013-04-14T00:30:13.913
> 
> 标签：sql, postgresql, relational-division

我有一个游戏，我的团队包含许多用户。每个团队中有不同数量的用户，但对于任何团队来说，用户的组合使该团队独一无二。

我为此创建了三个数据库表。

```
 Team    User    TeamUsers
 t_id    u_id    t_id, u_id 
```

如果用户 1、4、5 和 7 以前一起在一个团队中，我想知道该团队的团队 ID。SQL 会是什么样子呢？

我已经尝试过这样的事情：

```
SELECT t_id FROM teamusers WHERE u_id IN (users[1], ..., users[i])
GROUP BY t_id HAVING COUNT(t_id) = users[].length; 
```

`users`数组以编程方式填充值。这看起来正确吗？还有其他更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:51:09.650

这是**关系划分**的经典案例。我们在这个密切相关的问题下组装了一整套查询：
[How to filter SQL results in a has-many-through relationship](https://stackoverflow.com/questions/7364969/how-to-filter-sql-results-in-a-has-many-through-relation)

让所有拥有所有球员的球队的一种方法是你已经拥有的。应该是最有效的查询之一。

对于更长的数组，`unnest()`+`JOIN`表现更好：

```
SELECT t_id
FROM  (SELECT unnest($users) AS u_id) u
JOIN   team_users USING (u_id)
GROUP  BY 1
HAVING count(*) = array_length($users, 1); 
```

但对于只有一手玩家来说，这并不重要。
对于重复使用，您可以创建一个表函数，而不是在您的应用程序中构建查询：

```
CREATE OR REPLACE FUNCTION f_get_teams(_users int[])
  RETURNS SETOF int AS
$func$

SELECT t_id
FROM  (SELECT unnest($1) AS u_id) u
JOIN   team_users USING (u_id)
GROUP  BY 1
HAVING count(*) = array_length($1, 1);

$func$ LANGUAGE SQL STRICT; 
```

称呼：

```
SELECT * FROM f_get_teams('{1,4,5,7}'::int[]); 
```

# python - 如何逃避特殊字符

> ID：15994431
> 
> 赞同：0
> 
> 时间：2013-04-14T00:30:18.023
> 
> 标签：python, character-encoding, python-3.x, ascii

我得到了以下代码来处理中文字符问题，或者 powerpoint 文件中的一些特殊字符，因为我想使用的内容`ppt`作为文件名来保存。如果它包含一些特殊字符，它会抛出一些异常，所以我使用下面的代码来处理它。

它在 Python 2.7 下运行良好，但是当我使用 Python 3.0 运行时，它给了我以下错误：

```
 if not (char in '<>:"/\|?*'):
TypeError: 'in <string>' requires string as left operand, not int 
```

我用谷歌搜索了错误消息，但我不明白如何解决它。我知道代码 `if not (char in '<>:"/\|?*'):`是将字符转换为ASCII码数字，对吗？

有什么例子可以解决我在 Python 3 中的问题吗？

```
def rm_invalid_char(self,str):

    final=""
    dosnames=['CON', 'PRN', 'AUX', 'NUL', 'COM1', 'COM2', 'COM3', 'COM4', 'COM5', 'COM6', 'COM7', 'COM8', 'COM9', 'LPT1', 'LPT2', 'LPT3', 'LPT4', 'LPT5', 'LPT6', 'LPT7', 'LPT8', 'LPT9']
    for char in str:
        if not (char in '<>:"/\|?*'):
            if ord(char)>31:
                final+=char
        if final in dosnames:
            #oh dear...
            raise SystemError('final string is a DOS name!')
        elif final.replace('.', '')=='':
            print ('final string is all periods!')
            pass
    return final 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:33:05.003

简单：使用这个

```
re.escape(YourStringHere) 
```

从文档：

> 返回所有非字母数字反斜杠的字符串；如果您想匹配其中可能包含正则表达式元字符的任意文字字符串，这很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T04:32:28.670

您正在将一个第一个元素是整数 (232) 的可迭代对象传递给`rm_invalid_char()`. 问题不在于这个函数，而在于调用者。

一些调试是按顺序进行的：在 的开头`rm_invalid_char()`，您应该这样做`print(repr(str))`：您不会看到字符串，这与`rm_invalid_char()`. 您必须通过在调用*之前* 调整代码来解决此问题，直到看到您期望的字符串。`rm_invalid_char()`

问题可能是由于 Python 2 和 Python 3 处理字符串的方式（在 Python 2 中，`str`对象是字节字符串，而在 Python 3 中，它们是字符串）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T04:21:10.117

我很好奇为什么“str”中有一些东西就像一个整数 - 输入发生了一些奇怪的事情。

但是，我怀疑您是否：

*   将您的值的名称更改为`str`其他名称，例如`char_string`
*   在`for char in char_string`强制将您的输入输入到字符串之后

那么您描述的问题将得到解决。

您还可以考虑在生成的文件名的末尾添加一个随机位，这样您就不必担心与 DOS 保留名称发生冲突。

# html - 如何使 UIWebView 链接在 UIPopover 中打开？

> ID：15994432
> 
> 赞同：2
> 
> 时间：2013-04-14T00:30:23.400
> 
> 标签：html, ios, uiwebview, uipopover

我目前在 UIWebView 中加载了一个简单的 HTML 文件，并在文件的文本中嵌入了一堆链接。我想知道是否有办法让这些链接在 UIPopover 中打开。

这些链接指向另一个 HTML 文件，因此我希望它们加载到 UIPopover 中，其中包含 UIWebView。

如果我对我在寻找什么还不够清楚，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T00:37:18.393

你应该看看 UIWebViewDelegate 这个方法

```
- (BOOL)webView:(UIWebView *)webView
            shouldStartLoadWithRequest:(NSURLRequest *)request
                        navigationType:(UIWebViewNavigationType)navigationType 
```

每当用户触发链接时，都会调用它

因此，将包含 UIWebView 的 viewController 放入该 webView 的委托中，并实现此方法。

如果有一个 BOOL 返回值。如果您返回“NO”，则 webview 本身不会尝试处理链接，因此您可以控制它。

`(NSURLRequest *)request`给你实际的链接...

所以从这里你可以触发一个带有内容 viewController 的 UIPopover... 它可以包含一个 UIWebView，你可以在其中加载你的链接数据。

（有趣的是你现在应该问这个问题，我现在正在实施类似的东西..）

*更新*

正如您所注意到的，这里有一个微妙之处需要观察。当您的 UIWebView 第一次加载它的内容时（例如在 viewDidLoad 上），将调用此委托方法。如果您`NO`在这种情况下返回，初始内容将不会加载，并且您将拥有一个神秘的空白 webView。

要解决此问题，您需要考虑`navigationType`参数。`UIWebViewNavigationTypeLinkClicked`基本上，如果 navigationType 是（您激活链接），您只想返回“NO” 。否则你想返回`YES`（webView 应该加载它的内容）。

因此，该方法的完整实现可能如下所示

```
-               (BOOL)webView:(UIWebView *)webView
   shouldStartLoadWithRequest:(NSURLRequest *)request
               navigationType:(UIWebViewNavigationType)navigationType
{
  BOOL result = YES;
    if (navigationType=UIWebViewNavigationTypeLinkClicked){
        [self launchPopOverWithRequest:request]
        result =  NO;
   }
   return result;
} 
```

# iphone - 在 UIBarButtonItem 选择器中包装 UIButton 不会调用

> ID：15994433
> 
> 赞同：0
> 
> 时间：2013-04-14T00:30:30.120
> 
> 标签：iphone, xcode4.5, selector, uibarbuttonitem

我创建了以下类来获取带有彩色图像的工具栏

```
@interface likeUIBarButtonItem : UIBarButtonItem
- (id) initWithStatus: (enum ApartmentLikeStatus)p_status;
@end 
```

m 文件如下所示：

```
- (IBAction) likeStatus_Clicked: (id) sender
{
    self.numberOfClicks++;
    [self.statusButton setImage:[self getStatusImage] forState:UIControlStateNormal];
}

- (id) initWithStatus: (enum ApartmentLikeStatus)p_status
{
    self.statusButton =  [UIButton buttonWithType:UIButtonTypeCustom];
    [self.statusButton setImage:[self getStatusImage] forState:UIControlStateNormal];
    [self.statusButton addTarget:self action:@selector(likeStatus_Clicked:)      forControlEvents:UIControlEventTouchUpInside];
    [self.statusButton setFrame:CGRectMake(0, 0, 20, 20)];
    self = [[likeUIBarButtonItem alloc] initWithCustomView:self.statusButton];

    return self;
} 
```

在视图控制器中，我执行以下操作：

```
likeUIBarButtonItem* stausBtn = [[likeUIBarButtonItem alloc]    initWithStatus:self.apartmentToShow.userLikness];
// List of toolbaritems
NSArray* toolbarItems = [NSArray arrayWithObjects: stausBtn, nil];
self.toolbarItems = toolbarItems;
self.navigationController.toolbarHidden = NO; 
```

该按钮被显示，但点击它时我得到一个汇编代码

```
0x120a09f:  movl   (%edi), %esi  <-- thread 1: EXC_BAD_ACCESS (code=2 address=0x0) 
```

虽然我的 statusButton 被声明了，但`(strong, nonatomic)`我猜它在 init 和函数调用之间的某个地方被释放，是这种情况还是其他原因？不管它是什么，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:50:51.117

这不是您覆盖方法的`init*`方式。

像这样的东西你可能会更好

```
- (instancetype)initWithStatus:(enum ApartmentLikeStatus)status
{
  UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
  [button setImage:[self getStatusImage] forState:UIControlStateNormal];
  [button addTarget:self action:@selector(likeStatus_Clicked:) forControlEvents:UIControlEventTouchUpInside];
  [button setFrame:CGRectMake(0, 0, 20, 20)];

  self = [super initWithCustomView:button];
  if (self) {
    self.statusButton = button;
  }
  return self;
} 
```

您的版本的问题是您创建了一个按钮并将其分配给`self`但最后您重新分配`self`给一个全新的对象。因此，初始`self`值可能会立即释放，因为没有其他人可以处理它，这基本上意味着您正在将一个悬空指针传递给该`initWithCustomView:`方法

# php - PHP 复制类中的其他值

> ID：15994440
> 
> 赞同：-1
> 
> 时间：2013-04-14T00:31:48.607
> 
> 标签：php, if-statement

我想要完成的是下载两个地方之一的文件。如果文件不存在，则需要尝试从其他位置下载。但是，如果第一个文件确实存在，则需要停止并且不要尝试下载第二个文件，否则第二个文件仍将作为空白文件下载，覆盖第一个文件。我将如何使用诸如 else 值之类的东西来做到这一点？

```
<?php

$source_file = 'http://somesitehere.tld/' . $_GET["u"] . '.png'; 
$dest_file = '/enter/directory/here/' . $_GET["u"] . '.png';

copy($source_file, $dest_file);

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:34:44.523

您是否尝试过使用类似的东西，根据您的需要使用**[file_exists](http://php.net/manual/en/function.file-exists.php)**、**[file_get_contents](http://php.net/manual/en/function.file-get-contents.php)**或**[fopen函数。](http://php.net/manual/en/function.fopen.php)**

如果您使用的是内部文件，请尝试使用**file_exists()**：

```
if( file_exists( $source_file ) ) { 

copy( $source_file, $dest_file );

} else {

copy( $source_file2, $dest_file2 );

} 
```

如果您使用的是外部文件，请尝试使用**file_get_contents()**：

```
if( file_get_contents( $source_file ) ) { 

copy( $source_file, $dest_file );

} else {

copy( $source_file2, $dest_file2 );

} 
```

或者，您可以尝试使用**fopen()**：

```
if( fopen( $source_file ) ) { 

copy( $source_file, $dest_file );

} else {

copy( $source_file2, $dest_file2 );

} 
```

# javascript - 示例显示 D3JS 中线性和对数刻度之间的动画转换？

> ID：15994442
> 
> 赞同：3
> 
> 时间：2013-04-14T00:31:52.477
> 
> 标签：javascript, d3.js

我很确定如果我能找到一个展示我正在尝试做的事情的例子，我可以对它进行逆向工程/重新实现。有没有人看过一个例子，展示了 D3JS 中线性和对数比例之间的平滑/动画转换？

我有两个秤独立工作，但我必须重新加载页面才能更改比例。

我的谷歌技能让我失望了！

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-14T11:12:14.040

[这是jsfiddle](http://jsfiddle.net/QLZcr/)的概念证明。您只需重新选择数据点并使用新比例重新绘制它们。对于轴标签，转换更加简单——您只需要再次调用轴函数。相关摘录如下。

```
// change to log scale...
yScale = d3.scale.log().domain([1, 100]).range([dim-padding,padding]);

svg.selectAll("circle").data(data)
   .transition().delay(1000).duration(1000)
   .attr("cx", function(d) { return xScale(d); })
   .attr("cy", function(d) { return yScale(d); });

svg.selectAll(".y")
   .transition().delay(1000).duration(1000)
   .call(yAxis.scale(yScale)); 
```

您可能需要尝试如何生成标签以使其看起来“不错”，但原则上 d3 将负责整个过渡。

# c# - 在应用程序上更改多个表单样式的最简单方法是什么？

> ID：15994445
> 
> 赞同：0
> 
> 时间：2013-04-14T00:32:35.327
> 
> 标签：c#, .net, css, forms

除了创建自定义按钮、自定义文本框和自定义标签等，然后在应用程序的所有表单中使用这些控件，然后根据需要更改这些控件的默认颜色和字体之外，还有一个简单的方法吗？如何在包含多个表单的现有应用程序上实现这种类似 css 的功能？

顺便说一句，我知道我可以以编程方式打开每个 *.Designer.cs 文件，然后用“My.Namespace.My[Control]”搜索/替换“System.Windows.Forms.[Control]”的实例，但是我不确定在代码设置控件的字体和颜色以及类似属性的情况下这将如何工作。那么是否只是确保自定义控件覆盖所有相关的 getter 方法的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T02:54:32.973

Windows 窗体不提供任何类型的皮肤。

一个简单的解决方法是在类上编写某种扩展方法`Form`：

```
public static void ApplySkin(this Form form, Skin skin)
{
    foreach (Control ctrl in form.Controls)
    {
        if (ctrl is TextBox)
        {
            TextBox textBox = (TextBox)ctrl;
            textBox.BackColor = skin.BackColor;
            textBox.ForeColor = skin.ForeColor;
            textBox.Font = skin.Font;
            ...
        }
        else if (ctrl is ComboBox)
        {
            ComboBox comboBox = (ComboBox)ctrl;
            comboBox.BackColor = skin.BackColor;
            comboBox.ForeColor = skin.ForeColor;
            comboBox.Font = skin.Font;
            ...
        }
        else if (ctrl is ...)
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:47:59.990

关于 Designer.cs 文件 - 您应该完全避免更改它们的代码。它们由设计师使用，并且出于某种原因而分开。

如果您确实想更改内容，在 Form CTOR 中，在调用 InitializeComponent() 之后，只需使用您想要的任何更改调用您自己的函数（更改属性值，例如颜色、委托等...）

如果您希望多个表单具有相同的样式（或功能），只需将此方法放在不同的类中，并通过将自身作为参数发送来让所有表单使用相同的方法。

现在，该方法当然不知道哪些控件位于哪些窗体上，因此您可以使用 Controls.Find（Form 方法之一）按名称定位控件。只需确保表单中的控件使用相同的约定正确命名（例如，所有列表框都将命名为 listBoxX，其中 X 是数字...）。

# java - Joda DateTime 到时间戳的转换

> ID：15994450
> 
> 赞同：42
> 
> 时间：2013-04-14T00:33:24.877
> 
> 标签：java, jodatime

我正在尝试更改*Joda*`Timestamp`中by`DateTimeZone`的值：

 *```
 DateTime dt = new DateTime(rs.getTimestamp("anytimestampcolumn"),
                             DateTimeZone.forID("anytimezone"));
  Timestamp ts = new Timestamp(dt.getMillis()); 
```

*   对于`DateTime`，值为 ：`2013-04-13T22:56:27.000+03:00`

*   对于`TimeStamp`，值为 ：`2013-04-13 22:56:27.0`

`Timestamp`没有时区差异。

*如何使用 TimeZone 获得正确的时间戳？* 例如我想得到“2013-05-13 01:56:27.0”。

提前致谢。

**编辑：**使用*MySQL*，列类型`TIMESTAMP`当然`rs`是`ResultSet`.

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-04-14T01:08:09.807

世界各地的时间（可测量的第四维度）是不同的，这是一个普遍的误解。时间戳作为一个时刻是独一无二的。然而，日期会影响我们“看到”时间的方式，但实际上它是“一天中的时间”。

**一个例子：**两个人同时看表。时间戳是一样的，对吧？但其中一个在伦敦，看到中午 12:00（格林威治标准时间，时区偏移量为 0），另一个在贝尔格莱德，看到 14:00（CET，中欧，现在是夏令时，偏移量为 +2）。

他们的看法不同，但时刻是相同的。

**[您可以在此答案](https://stackoverflow.com/questions/10522267)中找到更多详细信息。**

# 更新

好的，这不是[这个问题](https://stackoverflow.com/questions/5942702)的重复，但它是没有意义的，因为你混淆了“时间戳 = 时刻（客观）”和“日期 [时间] = 一天中的时间（主观）”这两个术语。

让我们看一下您的原始问题代码，如下所示：

```
// Get the "original" value from database.
Timestamp momentFromDB = rs.getTimestamp("anytimestampcolumn");

// Turn it into a Joda DateTime with time zone.
DateTime dt = new DateTime(momentFromDB, DateTimeZone.forID("anytimezone"));

// And then turn it back into a timestamp but "with time zone".
Timestamp ts = new Timestamp(dt.getMillis()); 
```

我还没有运行这段代码，但我确信它`true`每次都会打印相同的毫秒数：

```
System.out.println("momentFromDB == dt : " + (momentFromDB.getTime() == dt.getTimeInMillis());
System.out.println("momentFromDB == ts : " + (momentFromDB.getTime() == ts.getTime()));
System.out.println("dt == ts : " + (dt.getTimeInMillis() == ts.getTime()));

System.out.println("momentFromDB [ms] : " + momentFromDB.getTime());
System.out.println("ts [ms] : " + ts.getTime());
System.out.println("dt [ms] : " + dt.getTimeInMillis()); 
```

但是正如您所说，您自己将它们打印为字符串会导致“不同”时间，因为`DateTime`应用了时区。这就是为什么“时间”作为`Timestamp`对象存储和传输（基本上包含 a `long`）并显示或输入为`Date[Time]`.

在您自己的答案中，您是在人为地添加偏移量并创建“错误”时间。如果您使用该时间戳创建另一个`DateTime`并将其打印出来，它将被偏移两次。

```
// Turn it back into a Joda DateTime with time zone.
DateTime dt = new DateTime(ts, DateTimeZone.forID("anytimezone")); 
```

PS 如果您有时间，请查看非常复杂的[Joda Time 源代码](https://github.com/JodaOrg/joda-time/blob/master/src/main/java/org/joda/time/DateTime.java)，看看它如何保持时间（毫秒）以及如何打印它。

# JUnit 测试作为证明

```
import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.*;

import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.Locale;
import java.util.TimeZone;

import org.junit.Before;
import org.junit.Test;

public class WorldTimeTest {
    private static final int MILLIS_IN_HOUR = 1000 * 60 * 60;
    private static final String ISO_FORMAT_NO_TZ = "yyyy-MM-dd'T'HH:mm:ss.SSS";
    private static final String ISO_FORMAT_WITH_TZ = "yyyy-MM-dd'T'HH:mm:ss.SSSXXX";

    private TimeZone londonTimeZone;
    private TimeZone newYorkTimeZone;
    private TimeZone sydneyTimeZone;
    private long nowInMillis;
    private Date now;

    public static SimpleDateFormat createDateFormat(String pattern, TimeZone timeZone) throws Exception {
        SimpleDateFormat result = new SimpleDateFormat(pattern);
        // Must explicitly set the time zone with "setCalendar()".
        result.setCalendar(Calendar.getInstance(timeZone));
        return result;
    }

    public static SimpleDateFormat createDateFormat(String pattern) throws Exception {
        return createDateFormat(pattern, TimeZone.getDefault());
    }

    public static SimpleDateFormat createDateFormat() throws Exception {
        return createDateFormat(ISO_FORMAT_WITH_TZ, TimeZone.getDefault());
    }

    public void printSystemInfo() throws Exception {
        final String[] propertyNames = {
                "java.runtime.name", "java.runtime.version", "java.vm.name", "java.vm.version",
                "os.name", "os.version", "os.arch",
                "user.language", "user.country", "user.script", "user.variant",
                "user.language.format", "user.country.format", "user.script.format",
                "user.timezone" };

        System.out.println();
        System.out.println("System Information:");
        for (String name : propertyNames) {
            if (name == null || name.length() == 0) {
                continue;
            }
            String value = System.getProperty(name);
            if (value != null && value.length() > 0) {
                System.out.println("  " + name + " = " + value);
            }
        }

        final TimeZone defaultTZ = TimeZone.getDefault();
        final int defaultOffset = defaultTZ.getOffset(nowInMillis) / MILLIS_IN_HOUR;
        final int userOffset = TimeZone.getTimeZone(System
                .getProperty("user.timezone")).getOffset(nowInMillis) / MILLIS_IN_HOUR;
        final Locale defaultLocale = Locale.getDefault();

        System.out.println("  default.timezone-offset (hours) = " + userOffset);
        System.out.println("  default.timezone = " + defaultTZ.getDisplayName());
        System.out.println("  default.timezone.id = " + defaultTZ.getID());
        System.out.println("  default.timezone-offset (hours) = " + defaultOffset);
        System.out.println("  default.locale = "
                + defaultLocale.getLanguage() + "_" + defaultLocale.getCountry()
                + " (" + defaultLocale.getDisplayLanguage()
                + "," + defaultLocale.getDisplayCountry() + ")");
        System.out.println("  now = " + nowInMillis + " [ms] or "
                + createDateFormat().format(now));
        System.out.println();
    }

    @Before
    public void setUp() throws Exception {
        // Remember this moment.
        now = new Date();
        nowInMillis = now.getTime(); // == System.currentTimeMillis();

        // Print out some system information.
        printSystemInfo();

        // "Europe/London" time zone is DST aware, we'll use fixed offset.
        londonTimeZone = TimeZone.getTimeZone("GMT");
        // The same applies to "America/New York" time zone ...
        newYorkTimeZone = TimeZone.getTimeZone("GMT-5");
        // ... and for the "Australia/Sydney" time zone.
        sydneyTimeZone = TimeZone.getTimeZone("GMT+10");
    }

    @Test
    public void testDateFormatting() throws Exception {
        int londonOffset = londonTimeZone.getOffset(nowInMillis) / MILLIS_IN_HOUR; // in hours
        Calendar londonCalendar = Calendar.getInstance(londonTimeZone);
        londonCalendar.setTime(now);

        int newYorkOffset = newYorkTimeZone.getOffset(nowInMillis) / MILLIS_IN_HOUR;
        Calendar newYorkCalendar = Calendar.getInstance(newYorkTimeZone);
        newYorkCalendar.setTime(now);

        int sydneyOffset = sydneyTimeZone.getOffset(nowInMillis) / MILLIS_IN_HOUR;
        Calendar sydneyCalendar = Calendar.getInstance(sydneyTimeZone);
        sydneyCalendar.setTime(now);

        // Check each time zone offset.
        assertThat(londonOffset, equalTo(0));
        assertThat(newYorkOffset, equalTo(-5));
        assertThat(sydneyOffset, equalTo(10));

        // Check that calendars are not equals (due to time zone difference).
        assertThat(londonCalendar, not(equalTo(newYorkCalendar)));
        assertThat(londonCalendar, not(equalTo(sydneyCalendar)));

        // Check if they all point to the same moment in time, in milliseconds.
        assertThat(londonCalendar.getTimeInMillis(), equalTo(nowInMillis));
        assertThat(newYorkCalendar.getTimeInMillis(), equalTo(nowInMillis));
        assertThat(sydneyCalendar.getTimeInMillis(), equalTo(nowInMillis));

        // Check if they all point to the same moment in time, as Date.
        assertThat(londonCalendar.getTime(), equalTo(now));
        assertThat(newYorkCalendar.getTime(), equalTo(now));
        assertThat(sydneyCalendar.getTime(), equalTo(now));

        // Check if hours are all different (skip local time because
        // this test could be executed in those exact time zones).
        assertThat(newYorkCalendar.get(Calendar.HOUR_OF_DAY),
                not(equalTo(londonCalendar.get(Calendar.HOUR_OF_DAY))));
        assertThat(sydneyCalendar.get(Calendar.HOUR_OF_DAY),
                not(equalTo(londonCalendar.get(Calendar.HOUR_OF_DAY))));

        // Display London time in multiple forms.
        SimpleDateFormat dfLondonNoTZ = createDateFormat(ISO_FORMAT_NO_TZ, londonTimeZone);
        SimpleDateFormat dfLondonWithTZ = createDateFormat(ISO_FORMAT_WITH_TZ, londonTimeZone);
        System.out.println("London (" + londonTimeZone.getDisplayName(false, TimeZone.SHORT)
                + ", " + londonOffset + "):");
        System.out.println("  time (ISO format w/o TZ) = "
                + dfLondonNoTZ.format(londonCalendar.getTime()));
        System.out.println("  time (ISO format w/ TZ)  = "
                + dfLondonWithTZ.format(londonCalendar.getTime()));
        System.out.println("  time (default format)    = "
                + londonCalendar.getTime() + " / " + londonCalendar.toString());
        // Using system default time zone.
        System.out.println("  time (default TZ)        = "
                + createDateFormat(ISO_FORMAT_NO_TZ).format(londonCalendar.getTime())
                + " / " + createDateFormat().format(londonCalendar.getTime()));

        // Display New York time in multiple forms.
        SimpleDateFormat dfNewYorkNoTZ = createDateFormat(ISO_FORMAT_NO_TZ, newYorkTimeZone);
        SimpleDateFormat dfNewYorkWithTZ = createDateFormat(ISO_FORMAT_WITH_TZ, newYorkTimeZone);
        System.out.println("New York (" + newYorkTimeZone.getDisplayName(false, TimeZone.SHORT)
                + ", " + newYorkOffset + "):");
        System.out.println("  time (ISO format w/o TZ) = "
                + dfNewYorkNoTZ.format(newYorkCalendar.getTime()));
        System.out.println("  time (ISO format w/ TZ)  = "
                + dfNewYorkWithTZ.format(newYorkCalendar.getTime()));
        System.out.println("  time (default format)    = "
                + newYorkCalendar.getTime() + " / " + newYorkCalendar.toString());
        // Using system default time zone.
        System.out.println("  time (default TZ)        = "
                + createDateFormat(ISO_FORMAT_NO_TZ).format(newYorkCalendar.getTime())
                + " / " + createDateFormat().format(newYorkCalendar.getTime()));

        // Display Sydney time in multiple forms.
        SimpleDateFormat dfSydneyNoTZ = createDateFormat(ISO_FORMAT_NO_TZ, sydneyTimeZone);
        SimpleDateFormat dfSydneyWithTZ = createDateFormat(ISO_FORMAT_WITH_TZ, sydneyTimeZone);
        System.out.println("Sydney (" + sydneyTimeZone.getDisplayName(false, TimeZone.SHORT)
                + ", " + sydneyOffset + "):");
        System.out.println("  time (ISO format w/o TZ) = "
                + dfSydneyNoTZ.format(sydneyCalendar.getTime()));
        System.out.println("  time (ISO format w/ TZ)  = "
                + dfSydneyWithTZ.format(sydneyCalendar.getTime()));
        System.out.println("  time (default format)    = "
                + sydneyCalendar.getTime() + " / " + sydneyCalendar.toString());
        // Using system default time zone.
        System.out.println("  time (default TZ)        = "
                + createDateFormat(ISO_FORMAT_NO_TZ).format(sydneyCalendar.getTime())
                + " / " + createDateFormat().format(sydneyCalendar.getTime()));
    }

    @Test
    public void testDateParsing() throws Exception {
        // Create date parsers that look for time zone information in a date-time string.
        final SimpleDateFormat londonFormatTZ = createDateFormat(ISO_FORMAT_WITH_TZ, londonTimeZone);
        final SimpleDateFormat newYorkFormatTZ = createDateFormat(ISO_FORMAT_WITH_TZ, newYorkTimeZone);
        final SimpleDateFormat sydneyFormatTZ = createDateFormat(ISO_FORMAT_WITH_TZ, sydneyTimeZone);

        // Create date parsers that ignore time zone information in a date-time string.
        final SimpleDateFormat londonFormatLocal = createDateFormat(ISO_FORMAT_NO_TZ, londonTimeZone);
        final SimpleDateFormat newYorkFormatLocal = createDateFormat(ISO_FORMAT_NO_TZ, newYorkTimeZone);
        final SimpleDateFormat sydneyFormatLocal = createDateFormat(ISO_FORMAT_NO_TZ, sydneyTimeZone);

        // We are looking for the moment this millenium started, the famous Y2K,
        // when at midnight everyone welcomed the New Year 2000, i.e. 2000-01-01 00:00:00.
        // Which of these is the right one?
        // a) "2000-01-01T00:00:00.000-00:00"
        // b) "2000-01-01T00:00:00.000-05:00"
        // c) "2000-01-01T00:00:00.000+10:00"
        // None of them? All of them?
        // For those who guessed it - yes, it is a trick question because we didn't specify
        // the "where" part, or what kind of time (local/global) we are looking for.
        // The first (a) is the local Y2K moment in London, which is at the same time global.
        // The second (b) is the local Y2K moment in New York, but London is already celebrating for 5 hours.
        // The third (c) is the local Y2K moment in Sydney, and they started celebrating 15 hours before New York did.
        // The point here is that each answer is correct because everyone thinks of that moment in terms of "celebration at midnight".
        // The key word here is "midnight"! That moment is actually a "time of day" moment illustrating our perception of time based on the movement of our Sun.

        // These are global Y2K moments, i.e. the same moment all over the world, UTC/GMT midnight.
        final String MIDNIGHT_GLOBAL = "2000-01-01T00:00:00.000-00:00";
        final Date milleniumInLondon = londonFormatTZ.parse(MIDNIGHT_GLOBAL);
        final Date milleniumInNewYork = newYorkFormatTZ.parse(MIDNIGHT_GLOBAL);
        final Date milleniumInSydney = sydneyFormatTZ.parse(MIDNIGHT_GLOBAL);

        // Check if they all point to the same moment in time.
        // And that parser ignores its own configured time zone and uses the information from the date-time string.
        assertThat(milleniumInNewYork, equalTo(milleniumInLondon));
        assertThat(milleniumInSydney, equalTo(milleniumInLondon));

        // These are all local Y2K moments, a.k.a. midnight at each location on Earth, with time zone information.
        final String MIDNIGHT_LONDON = "2000-01-01T00:00:00.000-00:00";
        final String MIDNIGHT_NEW_YORK = "2000-01-01T00:00:00.000-05:00";
        final String MIDNIGHT_SYDNEY = "2000-01-01T00:00:00.000+10:00";
        final Date midnightInLondonTZ = londonFormatLocal.parse(MIDNIGHT_LONDON);
        final Date midnightInNewYorkTZ = newYorkFormatLocal.parse(MIDNIGHT_NEW_YORK);
        final Date midnightInSydneyTZ = sydneyFormatLocal.parse(MIDNIGHT_SYDNEY);

        // Check if they all point to the same moment in time.
        assertThat(midnightInNewYorkTZ, not(equalTo(midnightInLondonTZ)));
        assertThat(midnightInSydneyTZ, not(equalTo(midnightInLondonTZ)));

        // Check if the time zone offset is correct.
        assertThat(midnightInLondonTZ.getTime() - midnightInNewYorkTZ.getTime(),
                equalTo((long) newYorkTimeZone.getOffset(milleniumInLondon.getTime())));
        assertThat(midnightInLondonTZ.getTime() - midnightInSydneyTZ.getTime(),
                equalTo((long) sydneyTimeZone.getOffset(milleniumInLondon.getTime())));

        // These are also local Y2K moments, just withouth the time zone information.
        final String MIDNIGHT_ANYWHERE = "2000-01-01T00:00:00.000";
        final Date midnightInLondon = londonFormatLocal.parse(MIDNIGHT_ANYWHERE);
        final Date midnightInNewYork = newYorkFormatLocal.parse(MIDNIGHT_ANYWHERE);
        final Date midnightInSydney = sydneyFormatLocal.parse(MIDNIGHT_ANYWHERE);

        // Check if these are the same as the local moments with time zone information.
        assertThat(midnightInLondon, equalTo(midnightInLondonTZ));
        assertThat(midnightInNewYork, equalTo(midnightInNewYorkTZ));
        assertThat(midnightInSydney, equalTo(midnightInSydneyTZ));

        // Check if they all point to the same moment in time.
        assertThat(midnightInNewYork, not(equalTo(midnightInLondon)));
        assertThat(midnightInSydney, not(equalTo(midnightInLondon)));

        // Check if the time zone offset is correct.
        assertThat(midnightInLondon.getTime() - midnightInNewYork.getTime(),
                equalTo((long) newYorkTimeZone.getOffset(milleniumInLondon.getTime())));
        assertThat(midnightInLondon.getTime() - midnightInSydney.getTime(),
                equalTo((long) sydneyTimeZone.getOffset(milleniumInLondon.getTime())));

        // Final check - if Y2K moment is in London ..
        final String Y2K_LONDON = "2000-01-01T00:00:00.000Z";
        // .. New York local time would be still 5 hours in 1999 ..
        final String Y2K_NEW_YORK = "1999-12-31T19:00:00.000-05:00";
        // .. and Sydney local time would be 10 hours in 2000.
        final String Y2K_SYDNEY = "2000-01-01T10:00:00.000+10:00";

        final String londonTime = londonFormatTZ.format(milleniumInLondon);
        final String newYorkTime = newYorkFormatTZ.format(milleniumInLondon);
        final String sydneyTime = sydneyFormatTZ.format(milleniumInLondon);

        // WHat do you think, will the test pass?
        assertThat(londonTime, equalTo(Y2K_LONDON));
        assertThat(newYorkTime, equalTo(Y2K_NEW_YORK));
        assertThat(sydneyTime, equalTo(Y2K_SYDNEY));
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-14T22:49:52.010

其实这不是一个重复的问题。这就是我多次解决问题的方法：

```
 int offset = DateTimeZone.forID("anytimezone").getOffset(new DateTime()); 
```

这是从所需时区偏移的方法。

让我们回到我们的代码，我们从查询结果集中获取时间戳，并将它与时区一起使用来创建我们的日期时间。

```
 DateTime dt = new DateTime(rs.getTimestamp("anytimestampcolumn"),
                         DateTimeZone.forID("anytimezone")); 
```

现在我们将我们的偏移量添加到日期时间，并从中获取时间戳。

```
 dt = dt.plusMillis(offset);
    Timestamp ts = new Timestamp(dt.getMillis()); 
```

可能这不是获得它的实际方法，但它解决了我的情况。我希望它可以帮助任何被困在这里的人。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-27T17:38:28.213

```
//This Works just fine
DateTime dt = new DateTime();
Log.d("ts",String.valueOf(dt.now()));               
dt=dt.plusYears(3);
dt=dt.minusDays(7);
Log.d("JODA DateTime",String.valueOf(dt));
Timestamp ts= new Timestamp(dt.getMillis());
Log.d("Coverted to java.sql.Timestamp",String.valueOf(ts)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-13T11:10:35.773

我以这种方式解决了这个问题。

```
String dateUTC = rs.getString("date"); //UTC
DateTime date;
DateTimeFormatter dateTimeFormatter = DateTimeFormat.forPattern("yyyy-MM-dd HH:mm:ss.SSS").withZoneUTC();
date = dateTimeFormatter.parseDateTime(dateUTC); 
```

这样，您将忽略服务器 TimeZone 强制您选择的 TimeZone。*

# java - Android 应用程序在单击按钮时崩溃

> ID：15994457
> 
> 赞同：0
> 
> 时间：2013-04-14T00:35:01.180
> 
> 标签：java, android, button, crash

我一直在尝试在 Eclipse 中制作我的第一个 android 应用程序（一个简单的温度转换器），但是当我单击手机上的按钮时，应用程序崩溃了。这是完整的java代码

```
package com.example.myfirstapp;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.view.Window;
import android.widget.EditText;
import android.widget.RadioButton;
import android.widget.TextView;
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}
String number;
int number2;
int output;
boolean F;
public void onBtnClicked(View view){

    EditText mEdit = (EditText)findViewById(R.id.editText1);
    TextView myTextView = (TextView) findViewById(R.id.label);

number = mEdit.getText().toString();
number2 = Integer.parseInt(number);

if(F=true){
output=number2*9/5+32;
}
else{
output=number2-32*5/9;
}

myTextView.setText(output);
} 

public void onRadioButtonClicked(View view) {

    boolean checked = ((RadioButton) view).isChecked();

    switch(view.getId()) {
        case R.id.radio0:
            if (checked)
                F = true;
            break;
        case R.id.radio1:
            if (checked)
                F = false;
            break;
    }
}
} 
```

单击按钮时的 LogCat

```
04-13 20:19:50.423: E/AndroidRuntime(25200): FATAL EXCEPTION: main
04-13 20:19:50.423: E/AndroidRuntime(25200): java.lang.IllegalStateException: Could not execute method of the activity
04-13 20:19:50.423: E/AndroidRuntime(25200):    at android.view.View$1.onClick(View.java:3674)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at android.view.View.performClick(View.java:4198)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at android.view.View$PerformClick.run(View.java:17158)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at android.os.Handler.handleCallback(Handler.java:615)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at android.os.Handler.dispatchMessage(Handler.java:92)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at android.os.Looper.loop(Looper.java:137)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at android.app.ActivityThread.main(ActivityThread.java:4918)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at java.lang.reflect.Method.invokeNative(Native Method)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at java.lang.reflect.Method.invoke(Method.java:511)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1004)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:771)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at dalvik.system.NativeStart.main(Native Method)
04-13 20:19:50.423: E/AndroidRuntime(25200): Caused by: java.lang.reflect.InvocationTargetException
04-13 20:19:50.423: E/AndroidRuntime(25200):    at java.lang.reflect.Method.invokeNative(Native Method)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at java.lang.reflect.Method.invoke(Method.java:511)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at android.view.View$1.onClick(View.java:3669)
04-13 20:19:50.423: E/AndroidRuntime(25200):    ... 11 more
04-13 20:19:50.423: E/AndroidRuntime(25200): Caused by: android.content.res.Resources$NotFoundException: String resource ID #0x59
04-13 20:19:50.423: E/AndroidRuntime(25200):    at android.content.res.Resources.getText(Resources.java:242)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at android.widget.TextView.setText(TextView.java:3773)
04-13 20:19:50.423: E/AndroidRuntime(25200):    at  com.example.myfirstapp.MainActivity.onBtnClicked(MainActivity.java:43)
04-13 20:19:50.423: E/AndroidRuntime(25200):    ... 14 more
04-13 20:19:50.453: E/android.os.Debug(718): !@Dumpstate > dumpstate -k -t -z -d -o /data/log/dumpstate_app_error 
```

最后是按钮的xml

```
<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/radioGroup1"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="16dp"
    android:onClick="onBtnClicked"
    android:text="Calculate" /> 
```

我不确定如何解决这个问题，所以希望有人可以提供帮助。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T00:55:35.357

首先初始化您的按钮，然后将 onclicklistener 设置为它们

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    //initialize views here 
    EditText mEdit = (EditText) findViewById(R.id.editText1);
    TextView myTextView = (TextView) findViewById(R.id.label);
    Button yourButton = (Button) findViewByid(R.id.youridforbutton);
    //set onclicklistener for your button
    yourbutton.setOnClickListener(
        new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                number = mEdit.getText().toString();
                number2 = Integer.parseInt(number);

                if (F = true) {
                    output = number2 * 9 / 5 + 32;
                } else {
                    output = number2 - 32 * 5 / 9;
                }

                myTextView.setText("" + output);
            }
        });

} 
```

同样设置其他按钮也

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T00:49:31.420

您需要将输出转换为字符串

```
myTextView.setText(String.valueOf(output)); 
```

setText 方法重载，当您将整数传递给它时，它期望它是资源的 id。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T00:49:37.647

您不能将整数设置为 TextViews。您必须将它们转换为字符串。

```
myTextView.setText(String.valueOf(output)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T00:42:09.873

您需要告诉点击侦听器侦听特定按钮。所以，换句话说，在按钮上设置一个 OnItemClickListener。如下所示：

```
Button button = (Button) findViewById(R.id.button1);
button.setOnClickListener(new OnClickListener() {
  @Override
  public void onClick(View v) {
    // do the "on click" action here
  }
}); 
```

希望这可以帮助。如果没有，那么请评论进一步的问题。

# c++ - C++ CLI GUI 事件处理

> ID：15994460
> 
> 赞同：2
> 
> 时间：2013-04-14T00:35:20.277
> 
> 标签：c++, events, click, c++-cli, mouse

我正在开发一个 c++ CLI 应用程序，并且在处理事件时遇到了一些困难。我想知道是否可以在单击鼠标按钮时触发事件。例如，我想检查鼠标是否已经移动到下一个方块，只有当他们点击鼠标时。这意味着如果他们点击方块 1，他们应该能够按住该点击并移动方块 2 和我的程序认识到这一点。

我已经在鼠标上运行了许多不同的事件，包括“单击”事件，但是在按下按钮时不会触发悬停、鼠标输入或鼠标按下事件。“MouseClick”事件，其作用相同。我尝试只使用 mouseDown 事件，但这不会让另一个 mouseDown 事件、鼠标进入或悬停事件触发。

没有检查鼠标位置，我不知道我能做什么。我不想做鼠标位置检查。

如果有人有任何想法，他们将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:47:20.277

显然，您需要注意 MouseMove 事件，以便您可以看到鼠标移动到另一个方块中。大致：

```
 void panel1_MouseMove(Object^ sender, MouseEventArgs^ e) {
        if ((e->Button & System::Windows::Forms::MouseButtons::Left) == 
                         System::Windows::Forms::MouseButtons::Left) {
            int square = MapPosToSquare(e->Location);
            if (square != currentSquare) {
                currentSquare = square;
                OnSquareClicked(currentSquare);
            }
        }
    } 
```

如果这些“方块”实际上是控件，那么您将遇到不同的问题。您必须在 MouseDown 事件处理程序中将控件的 Capture 属性设置为 false，这样它就不会捕获鼠标。

# iptables - iptables 允许 whm 邮件端口 25

> ID：15994462
> 
> 赞同：-1
> 
> 时间：2013-04-14T00:35:29.870
> 
> 标签：iptables

试图理解 iptables（我在 VPS 上安装了 cPanel）并玩了一点游戏，所以这听起来像是一个愚蠢的问题，我在做什么。

我已将默认 iptables 配置复制到备份（以防万一恢复出错）并创建自定义 iptables 配置（/etc/sysconfig/iptables），如果我 DROP INPUT/OUTPUT/FORWARDING（所以一切）。

然后，除了电子邮件（：25）之外，我设法获得了我想要访问所需工作的所有端口（传入/传出 HTTP/s/SSH/FTP 等）。我正在使用 Roundcube 并使用以下配置发送电子邮件，但无法在我的服务器上发送/接收电子邮件（如果我恢复默认配置（接受所有内容）则有效，因此除了端口：25 之外，我还需要允许访问的任何其他端口吗？在知道所有内容都已丢弃的情况下发送邮件？）。我在我的自定义（/etc/sysconfig/iptables）中使用下面的电子邮件配置：-

```
-A INPUT -p tcp --dport 25 -m state --state NEW,ESTABLISHED -j ACCEPT
-A OUTPUT -p tcp --sport 25 -m state --state ESTABLISHED -j ACCEPT

-A OUTPUT -p tcp --dport 25 -j ACCEPT
-A INPUT -p tcp --sport 25 -m state --state ESTABLISHED -j ACCEPT 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T10:05:41.750

IP 是双向通信，当您**收到**邮件时，数据包会在您的服务器上的 25 端口上发送，您将在任意分配的端口号（在连接建立期间确定）发送响应数据包。

因此，iptables 的常见规则是：无论连接状态如何，都接受来自指定端口（邮件为 25）输入的数据包 `-A INPUT -p tcp --dport 25 -j ACCEPT`

无论目标端口如何，都接受为所有已建立的连接发回数据包。`-A OUTPUT -p tcp -m state --state ESTABLISHED -j ACCEPT`

现在，如果您想向服务器**发送**邮件，您必须允许数据包发送到端口 25 并允许传入所有已建立的连接。

`-A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT`

`-A OUTPUT -p tcp --dport 25 -j ACCEPT`

另一个想法是记录应该丢弃的数据包。将日志行 a 放在所有链规则的末尾。

```
iptables -A INPUT -p tcp -j LOG --log-prefix "INPUT PACKET DROPPED"
iptables -A OUTPUT -p tcp -j LOG --log-prefix "OUTPUT PACKET DROPPED"
```

这样，您将在 /var/log/message（或使用 dmesg）中看到到达链规则末端并被丢弃的每个数据包的一行。

# c++ - 使用 cin 检查空行

> ID：15994463
> 
> 赞同：2
> 
> 时间：2013-04-14T00:35:34.323
> 
> 标签：c++

我想检查一个空行作为执行特定操作的输入。我尝试使用 cin.peek() 并检查它是否等于 '\n'，但这没有意义。

> 一个
> 
> b
> 
> C

空行（在这里，我想执行我的操作）

> 一个

我试过这段代码：

```
char a,b,c;
cin>>a;
cin>>b;
cin>>c;
if(cin.peek()=='\n') {
cout<<a<<endl;
cout<<b<<endl;
cout<<c<<endl;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T00:48:07.523

使用`getline`，然后处理字符串。如果用户输入了空行，则字符串将为空。如果他们没有，您可以对字符串进行进一步处理。您甚至可以将其放入 an`istringstream`并将其视为来自`cin`.

这是一个例子：

```
std::queue<char> data_q;
while (true)
{
    std::string line;
    std::getline(std::cin, line);

    if (line.empty())    // line is empty, empty the queue to the console
    {
        while (!data_q.empty())
        {
            std::cout << data_q.front() << std::endl;
            data_q.pop();
        }
    }

    // push the characters into the queue
    std::istringstream iss(line);
    char ch;
    while (iss >> ch)
        data_q.push(ch);
} 
```

# php - PHP检索数据库的内容

> ID：15994464
> 
> 赞同：1
> 
> 时间：2013-04-14T00:35:36.787
> 
> 标签：php, mysql, database-connection

我有一个数据库，里面有几个表。我正在处理的表中有 6 列，

`school_id, title, location, content, class_date and user_id`

school_id 是唯一的（范围从 1-20），并且有 4 个不同的 user_id（范围从 1-4）.....我正在一个网站上工作，该网站有一个表格，显示有关用户的信息及其对应关系. 我在显示表的最后一列中有一个 ReadMore 链接，我的问题是，当我单击 ReadMore 链接时，我希望它根据单击的事件显示数据库中的内容字段。

## 对于登录，用户被询问他们的 user_id 作为他们的密码。

```
//$T is called from a previous page which is the user_id or the password
$T = $_SESSION["ID"];

$INFO= $dbc->query("SELECT content FROM events where school_id='$T'");
$a = $INFO->fetch();

$b = $a['content'];
print_r($b); 
```

上面的代码是我如何尝试打印出正确的内容，但只打印出第一个实例

以下代码是表格在我的网站上的显示方式

```
<?php
$gold= $dbc->query("SELECT * FROM events WHERE user_id='$idcheck' ORDER BY     event_dateLIMIT 10");
    $x = $gold->fetchAll();

    echo "<table border = '1'>";
    echo "<tr>
         <td> Event </td>
         <td> Date of Event </td>
         <td> Location </td>
         <td> Event Information</td>
         </tr>";

    foreach ($r as $back) {
        $title = $back['title'];
        $eventdate = $back['class_date'];
        $location = $back['location'];

        echo "<tr>";
        echo "<td>$title</td>";
        echo "<td>$eventdate</td>";
        echo "<td>$location</td>";
        echo "<td>";
        ?>
<form action="displaycontent.php" method="post"> 

            <input type="submit" value="Read More">
        </form>
        <?php
        echo "</td>";
        echo "</tr>";
    }
    echo "</table>";
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:56:41.937

fetch 方法从您的语句中返回下一个找到的行。您必须遍历结果以获取所有行。

就像是

```
while ($row = $INFO->fetch()) {
    $b[] = $row;
} 
```

然后看看 print_r($b)。它应该看起来像

```
array(0=>array('content'=>'Some content1'),
      1=>array('content'=>'Some content2'), ....) 
```

并且您输出结果的方式应该有效。

# javascript - HTML 5 + 进度元素检查？

> ID：15994465
> 
> 赞同：8
> 
> 时间：2013-04-14T00:35:42.123
> 
> 标签：javascript, html

这可能是非常基本的，或者是不可能的，但它暗示了我，值得一问。有没有办法检查浏览器是否支持 html 5 进度元素？

```
var progress = document.createElement('progress'); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T11:35:18.847

另一个 oneliner，取自[Modernizr](https://github.com/Modernizr/Modernizr/blob/master/feature-detects/elem/progress-meter.js)：

```
//returns true if progress is enabled
var supportsProgress = (document.createElement('progress').max !== undefined); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T00:50:14.403

创建一个`progress`元素并检查`max`属性：

```
function progressIsSupported() {
  var test = document.createElement('progress');
  return (
      typeof test === 'object' &&
      'max' in test
    );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T01:25:22.163

漂亮的一个班轮：

```
function supportsProgress() {
    return (t = document.createElement("progress")) && t.hasOwnProperty("max");
} 
```

或者，如果您真的不想使用全局：

```
function supportsProgress() {
    var t = document.createElement("progress");
    return t && t.hasOwnProperty("max");
} 
```

# ruby-on-rails - 如何在 Rails 中存储我的对称密钥

> ID：15994467
> 
> 赞同：0
> 
> 时间：2013-04-14T00:36:00.887
> 
> 标签：ruby-on-rails, ruby-on-rails-3, security, encryption, cryptography

我想将加密数据及其签名存储在我的数据库中，以便我可以在其他时间读回它。如何安全地存储用于加密的对称密钥？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:29:24.677

将其存储在文件系统上，从不进行版本跟踪！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:13:27.920

我想我在这里找到了我的问题的答案：[你在哪里将你的密钥存储在 Java Web 应用程序中？](https://stackoverflow.com/questions/13991100/where-do-you-store-your-secret-key-in-a-java-web-application)

如果有更好的做事方式，请告诉我。

TLDR：将其存储在文件系统上。

# plot - Gnuplot 仅绘制指定的数据集

> ID：15994468
> 
> 赞同：0
> 
> 时间：2013-04-14T00:36:01.907
> 
> 标签：plot, gnuplot

我有以下结构的文件：

```
#title
month graph1 graph2 graph3
January 1 2 3
February 2 3 4

#title2
month graph1 graph2 graph3
January 1 2 3
February 2 3 4 
```

我想只绘制以title2开头的数据集。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T06:15:43.467

使用足够新的 gnuplot 版本，您可以将名称指定为“索引”：

```
plot 'datafilename' index 'title2' 
```

对于较旧版本的 gnuplot，使用以下命令仍然相对简单`sed`：

```
plot "< sed '1,/#title2/d' datafile" using ... 
```

如果你想停止而不是绘制`#title3`数据：

```
plot "< sed -n '/#title2/,/#title3/p' datafile" using ... 
```

# 演示：

测试数据 -

```
#title
month graph1 graph2 graph3
January 1 2 3
February 2 3 4

#title2
month graph1 graph2 graph3
January 1 2 3
February 2 3 4

#title3
January 5 6 3
February 3 6 4.6 
```

测试脚本：

```
plot "< sed '1,/#title2/d' test.dat" using 2:4 w lines,\
     "< sed -n '/#title2/,/#title3/p' test.dat" using 2:4 w p ps 5 
```

产生这个情节：

![在此处输入图像描述](https://i.stack.imgur.com/Q8ddH.png)

请注意，只有第一行在末尾绘制了点。

# c# - 在运行时打印 EntityFramework 版本

> ID：15994469
> 
> 赞同：4
> 
> 时间：2013-04-14T00:36:02.840
> 
> 标签：c#, entity-framework

有没有办法在运行时获取 EF 的版本？类似的东西

```
Console.WriteLine(Environment.Version); 
```

将返回

```
4.0.30319.18034 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T00:46:57.040

扩展阿列克谢的想法，你可以做到

```
string version = typeof(DbSet).Assembly.GetName().Version.ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T00:45:34.740

从您感兴趣的框架中打印任何类型的程序集“版本”：

```
Console.Write( typeof(String).Assembly.GetName().Version); 
```

# node.js - 使用 Node JS 设置 Cloud9 SSL 应用程序

> ID：15994471
> 
> 赞同：9
> 
> 时间：2013-04-14T00:36:33.527
> 
> 标签：node.js, ssl, https, configuration

我一直在玩 Cloud9 IDE，并且玩得很开心。但是，我正在尝试使用节点 js 设置一个简单的 https 服务器，但我似乎无法让它工作。当我运行页面时，Cloud9 说“运行节点进程”，但是当我访问服务器应该响应的 url 时：[https](https://workspace.user.c9.io) ://workspace.user.c9.io页面说

```
Service Temporarily Unavailable

The server you are trying to contact is down either because it was stopped or is unable to service your request due to maintenance downtime or capacity problems. Please try again later.
node-web-proxy/0.4 Server at project-livec9f70a01ca28.rhcloud.com Port 8000 
```

我使用 OPENSSL 创建了一个测试证书，并使用以下代码来设置我的服务器。我可以确认 OPENSSL 证书已正确构建。

```
var https = require("https");
var fs = require("fs");
var url = require("url");

var options = {
    key: fs.readFileSync('certs/cert.pem'),
    cert: fs.readFileSync('certs/cert.pem')
};

// create a server

https.createServer(options, function(req, res) {

    console.log("This works!");

    res.writeHead(200);
    res.end("Hello world from Cloud9! Url:"+req.url);

}).listen(process.env.PORT); 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-21T23:57:02.113

你需要`.listen(process.env.PORT,process.env.IP);`

它应该说，当你启动一个程序。

# jquery - parseJSON 解码数组

> ID：15994476
> 
> 赞同：0
> 
> 时间：2013-04-14T00:36:56.497
> 
> 标签：jquery, parsing, json

我首先做了一个 MySQL 查询并将行存储在 exArray 中，如下所示：

```
$exArray = array();
index = 0;
while($row = mysql_fetch_assoc($result)) 
{
     $exArray[$index] = $row; //Total of three rows
     $index++;
} 
```

然后，我用

```
json_encode($exArray); 
```

[{“第一”：“001”，“第二”：“002”}，{“第一”：“003”，“第二”：“004”}]

注意：我的 query.php 中的数据包含更多元素。为了简洁起见，我在这里缩短了它。实际上，它是一个三行八列的数组。在这里，我展示了两行两列。

这是我尝试过的。

首先，我尝试使用下面的代码并警告“001”但没有成功。警报根本不会在我的屏幕上弹出。

```
$(document).ready(function() {
    $.getJSON('query.php', function(data) {        
        if(data)
        {
        var obj = jQuery.parseJSON(data);
        alert(obj[0].first);
        }   
        });
    }); 
```

我也试过这种方法。我想将 this.first 推入一个数组。我试图将“001”附加到class ='test'的一段。但是，我也没有成功。

```
$(document).ready(function() {
    $.getJSON('query.php', function(data) {        
        if(data)
        {
            $.each(data, function(){
            $(this.first).appendTo(".test")
            }  
        });
    }); 
```

非常欢迎您的帮助。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T04:09:27.610

在 php 文件中，我首先调用了，

```
 json_encode($exArray); 
```

然后，

```
$(document).ready(function() {
        $.getJSON('vconj.php', function(data) {        
        if(data)
        {
        alert(data[0].first);
        }   
        });
    }); 
```

成功报警 001。没有必要使用 jQuery.parseJSON(data)。

谢谢。

# python - 对列出的列表使用 for/in 测试

> ID：15994480
> 
> 赞同：1
> 
> 时间：2013-04-14T00:37:24.127
> 
> 标签：python, list, loops, replace

我一直在尝试检查用户提交的字符串是否包含某个子字符串，并在打印回复时替换它们。

```
list_in_list = [["I", "you"], ["We", "Us"], ["Her", "Him"]] 
```

我一直在使用以下代码来测试这些值是否作为调试回复：

```
print [row[0] for row in list_in_list] in reply 
```

回复是用户输入的字符串

但是它返回此错误：

```
TypeError: 'in <string>' requires string as left operand, not list 
```

* * *

我也无法弄清楚如何检索要替换的正确值。我正在考虑循环它

```
reply.replace(list_in_list[0][x], list_in_list[0][x]) 
```

其中 x = 执行的循环数量，但我对如何编码感到困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T00:50:37.100

要测试是否有任何值，`reply`您可以执行类似的操作

```
print any(row[0] in reply for row in list_in_list) 
```

替换中的所有值`reply`

```
for row in list_in_list:
    reply = reply.replace(row[0], row[1])
print reply 
```

回应您的评论

```
reply = "This is a test I We Her"
#rw = replace_with
rw = {"I":"You", "We":"Us", "Her":"Him"}

reply = " ".join([rw[word] if word in rw else word for word in reply.split()])

print reply 
```

根据您输入的复杂程度，您可能会考虑使用正则表达式或研究自然语言处理（用于处理收缩等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T00:41:21.603

你的意思是这样的：

```
print [row[0] for row in list_in_list if row[0] in reply] 
```

这将为您提供第一列中的值，但前提是它们是`in reply`. 例如：

```
>>> list_in_list = [["I", "you"], ["We", "Us"], ["Her", "Him"]]
>>> reply = "I like cake"
>>> print [row[0] for row in list_in_list if row[0] in reply]
['I']
>>> reply = "We met Her yesterday"
>>> print [row[0] for row in list_in_list if row[0] in reply]
['We', 'Her'] 
```

# python - Tornado 设置 get_argument 的最小值和最大值

> ID：15994490
> 
> 赞同：0
> 
> 时间：2013-04-14T00:39:47.520
> 
> 标签：python, python-2.7, tornado

我目前正在使用 Tornado RequestHandler.get_argument 来获取 http POST 和 GET 参数。RequestHandler.get_argument 允许您设置默认值。Tornado 中有没有办法在 tornado 中设置 GET 和 POST 参数的最大值和最小值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:42:57.307

为什么不使用简单的 if 语句？

例如，如果你的最小可接受值是`7`，最大可接受值是`47`你可以写：

```
def post(self):
    my_arg = self.get_argument('my_arg')
    if not 7 <= my_arg <= 47:
        raise tornado.web.HTTPError(400)  # 400 Bad Request 
```

如果您经常这样做，您可以尝试覆盖该方法，例如：

```
class MyHandler(tornado.web.RequestHandler):

    def get_argument(self, name, minimum, maximum):
        argument = super(MyHandler, self).get_argument(name)
        if not minimum <= argument <= maximum:
            raise tornado.web.HTTPError(400)  # 400 Bad Request
        return argument

    def post(self):
        small_arg = self.get_argument('small_arg', 1, 3)
        medium_arg = self.get_argument('medium_arg', 7, 47)
        large_arg = self.get_argument('large_arg', 9001, 10000) 
```

随意选择不同的[HTTP 状态代码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)。

# javascript - jQuery倒计时日期

> ID：15994491
> 
> 赞同：0
> 
> 时间：2013-04-14T00:39:55.217
> 
> 标签：javascript, jquery, date, countdown

我有这段从网上获得的 JavaScript 代码，我正在尝试将其修改为倒计时到 2013 年 7 月 10 日。

```
var currentDate = new Date();
$('div#clock').countdown(45 * 40 * 30 * 30 * 1000 + currentDate.valueOf(), function(event) { 
```

![在此处输入图像描述](https://i.stack.imgur.com/HrkPc.png)

2013 年 7 月 10 日距离现在大约 100 天，所以我希望天数显示为 100。我不明白日期是如何传递的格式，我试过弄乱它，但它仍然无法正常工作。我尝试将一个新的 Date 对象传递给它，但这也不起作用。这段代码似乎来自这个[jQuery 倒计时库](https://github.com/hilios/jQuery.countdown)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:45:40.867

而不是 "45 * 40 * 30 * 30 * 1000" 使用 "100 * 24 * 60 * 60 * 1000" 所以：

```
var currentDate = new Date();
$('div#clock').countdown(45 * 40 * 30 * 30 * 1000 + currentDate.valueOf(), function(event) { 
```

将是最终代码。即 1000（毫秒/秒）* 60（秒/分钟）* 60（分钟/小时）* 24（小时/天）* 100（天）。

# javascript - 无法理解如何调用 JavaScript 对象中的值

> ID：15994495
> 
> 赞同：1
> 
> 时间：2013-04-14T00:40:30.993
> 
> 标签：javascript, knockout.js, momentjs

我正在使用 knockout.js 和 moment.js 来计算给定月份的一些值。以下代码按预期工作：

```
var calendarViewModel = {
    selectedMonth: ko.observable(moment().format("M")),
    daysInMonth: ko.observable(moment().month(3).daysInMonth())
};

ko.applyBindings(calendarViewModel); 
```

selectedMonth 的返回值为“4”，daysInMonth 的返回值为“30”。

但我*想做*的是根据 selectedMonth 的当前值（会改变）计算 daysInMonth 的值。我能想到的最好的代码是这样的：

```
var calendarViewModel = {
    selectedMonth: ko.observable(moment().format("M")),
    daysInMonth: ko.observable(moment().month(calendarViewModel.selectedMonth() - 1).daysInMonth())
};

ko.applyBindings(calendarViewModel); 
```

我进入`Uncaught TypeError: Cannot read property 'selectedMonth' of undefined`控制台。我无法理解的是如何在这种情况下正确引用 selectedMonth 。如果我在 viewModel 之外的其他一些通用变量中创建 selectedMonth ，那么我所做的一切都可以正常工作。

我很确定这与我对 JavaScript 对象的（较差的）理解有关，与库本身无关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:46:16.613

您需要为此创建一个[计算](http://knockoutjs.com/documentation/computedObservables.html)：

```
var calendarViewModel = function(){
    var self = this;
    self.selectedMonth = ko.observable(moment().format("M"));
    self.daysInMonth = ko.computed(function(){
        var selectedMonth = self.selectedMonths();
        return moment().month(selectedMonth - 1).daysInMonth();
    });
};

ko.applyBindings(new calendarViewModel()); 
```

至于区别......这里我们正在创建一个实际的 a 实例，`calendarViewModel`它将按照您期望的方式设置`this`上下文。

它还使用闭包来确保您可以在`computed`.

# excel - VBA / 宏 - 如何避免为每个文件导入模块

> ID：15994503
> 
> 赞同：0
> 
> 时间：2013-04-14T00:42:20.427
> 
> 标签：excel, vba

我已经`VBA module (macro)`成功构建了个人需要的。但是，问题是我必须在一周内每天在近 100 个不同的文件中使用它。现在我不想`import`为每个文件添加模块。我也不想将它添加为`addin`每天。

所以，如果有人得到一个永久的解决方案，它是一个`just-once`解决方案（比如一个将随 Windows 本身加载的 dll），请随时分享。

另请注意，我希望我为它制作的快捷键也能被保留。

非常感谢。

# php - 如何在 ATK4 中引用模型的字段设置过滤器

> ID：15994508
> 
> 赞同：0
> 
> 时间：2013-04-14T00:43:10.180
> 
> 标签：php, atk4

我目前正在做一个复杂的多级分类系统。

为简化起见，我将通过提供理论示例来解释我要完成的工作：

我有一个小组表：

```
group id| group name
   1    |     A
   2    |     B
   3    |     C 
```

我有一个子组表：

```
subgroup id| group id| sub-group name
    1      |    1    | A-aaaa
    2      |    1    | A-bbbb
    3      |    1    | A-cccc
    4      |    2    | B-111111
    5      |    2    | B-222222
    6      |    3    | C-ONE
    7      |    3    | C-TWO 
```

我有一个使用这两个表作为参考的模型：

```
class Model_ItemGrouping extends Model_Table {
   public $entity_code = 'items';

   function init() {
      parent::init();

      $this->addField('itemname')->caption('Item Description');

      $this->addField('group_id')->caption('Group Name')
         ->refModel('Model_Groups')->displayField('groupname');

      $this->addField('subgroup_id')->caption('Sub Group Name')
         ->refModel('Model_SubGroups')->displayField('subgroupname');
   }
} 
```

现在，我将此模型应用于我的代码中的表单，如下所示：

```
$form = $this->add('MVCForm');
$form->addSubmit();

$model=$form->setModel('ItemGrouping');

if($model->isInstanceLoaded())
   $form->getModel()->loadData(55); // force it to load item id #55 
```

加载并显示此表单后，用户现在可以编辑并能够为该项目选择不同的组和/或不同的子组。

但我想做的是*限制*可以根据项目的当前状态从下拉列表中选择的选项集。

如果项目 id #55 当前来自第 3 组，则该组应锁定到第 3 组，并且子组下拉列表应仅包含第 3 组的子组，而不是整个列表。

现在，更详细和具体的问题是：

有没有办法根据项目的状态*动态锁定*两个引用模型：

`Model_Groups`领域参考`group_id`

和

`Model_SubGroups`领域参考`subgroup_id`

`$model`仅使用表单实例及其在**PHP**`addCondition`中的相应方法而不是前端 JavaScript的一组特定选定项？

 **我想象这样的事情（修改我之前的片段）：

```
$form = $this->add('MVCForm');
$form->addSubmit();

$model=$form->setModel('ItemGrouping');

if($model->isInstanceLoaded()) {
   $form->getModel()->loadData(55); // force it to load item id #55

   // if item is of group #2, force references to show options for group #2
   $model->getFieldRefModel('group_id')->addCondition('id=',2);
   $model->getFieldRefModel('subgroup_id')->addCondition('group_id=',2);
} 
```

注意：这`getFieldRefModel`是不存在的，这当然是为了提供使用静态值的概述而过度简化，而我还需要动态传递项目 ID 号并在我实际设置之前首先检查项目的当前分组状态过滤条件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:32:04.930

如果我正确理解了您的要求，那么

```
$model->getFieldRefModel('group_id')->addCondition('id=',2);
$model->getFieldRefModel('subgroup_id')->addCondition('group_id=',2); 
```

你可以写

```
$model->ref('group_id')->addCondition('id',2);
$model->ref('subgroup_id')->addCondition('group_id',2); 
```

那是最新的 ATK4 版本，我猜你没有使用 :(

其实这些条件都是在后台自动添加的，所以你可以简单的写

```
$model->ref('group_id');
$model->ref('subgroup_id'); 
```

并且不要忘记在您的模型初始化方法中使用 hasOne、hasMany 来定义这些字段。现在这些字段不是“关系”，因此当您没有使用 hasOne/hasMany 定义字段时，ref() 将不起作用。

此外，我相信您的数据结构存在缺陷。您在 Item 和 SubGroup 之间有什么样的关系（1:n 或 n:1）？**

# vim - 防止 gVim 将控制权返回给命令行（从 Stata 调用时）

> ID：15994509
> 
> 赞同：1
> 
> 时间：2013-04-14T00:43:59.007
> 
> 标签：vim, stata

当我使用`shell`（或等效地使用`!`）从 Stata 调用 gVim 时，Stata 不会等待命令完成并继续使用 .do 文件。我通常会指定一个简短的并且一切正常（在[此处](http://www.stata.com/statalist/archive/2002-06/msg00295.html)`sleep`的 Stata 邮件列表中讨论）。

但有时 gVim 调用很长，并且长度是先验未知的。例如。我使用 gVim`argdo`从文本文件文件夹中删除标题。

```
!gvim -c "argdo 1,3d | update" *sheet*.txt 
```

有什么办法可以强制 gVim 不将控制权交还给 Stata？`pause`或者我是在 .do 文件之外或使用/ longy 完成此步骤的最佳选择`sleep`吗？谢谢！

哦，我在使用 gVim 7.3 的 Win 8（64 位）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T10:51:35.600

我认为您需要将此调用设为 Stata 命令或其等效命令。

也就是说，尝试从 do-file 编辑器窗口单独运行它，或者将其包装在单独的 do-file 中。

我意识到这不是一个有吸引力的解决方案，但原则上它似乎是唯一的一个。

（`sleep`我不喜欢软糖的解决方案，但我想原则上没有人喜欢它们。）

# javascript - Javascript 文本输入计算器

> ID：15994510
> 
> 赞同：1
> 
> 时间：2013-04-14T00:44:11.920
> 
> 标签：javascript, html

我对 Javascript 有点陌生，我正在尝试制作一个具有 3 个文本输入、第一个数字文本框、一个操作文本框和第二个数字文本框的基本计算器，但是当我单击时它不会打印出文本一个按钮或使用任何其他方法来触发事件。这是我的代码：

```
<html>
<script>
function calc()
{
    var D = "";
    var A = document.getElementById("num1").value;
    var B = document.getElementById("op").value;
    var C = document.getElementById("num2").value;
    if(B == "+")
    {
        D = A+C;
    }
    elseif(B == "-")
    {
        D = A-C;
    }
    elseif(B == "*")
    {
        D = A*C;
    }
    elseif(B == "/")
    {
        D = A/C;
    }
    document.getElementById("result").innerHTML = D;
}
</script>

<body>
    <input type="text" id="num1" name="num1" />
    <input type="text" id="op" name="op" />
    <input type="text" id="num2" name="num2" />
    <br />
    <input type="button" value="Solve" onclick="calc()" />

    <p id="result" name="r1">
        <br />
    </p>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:12:11.777

我建议以下（代码本身中注释的解释）：

```
function calc() {
        /* finds out whether the browser uses textContent (Webkit, Opera, Mozilla...)
           or innerText (Microsoft) to set the text of an element/node */
    var textType = Node.textContent ? 'textContent' : 'innerText',
        /* uses parseFloat to create numbers (where possible) from the entered value
           if parseFloat fails to find a number (it's empty or nonsensical)
           then a 0 is used instead (to prevent NaN being the output). */
        num1 = parseFloat(document.getElementById('num1').value) || 0,
        num2 = parseFloat(document.getElementById('num2').value) || 0,
        // retrieves the result element
        result = document.getElementById('result');

    // switch is used to avoid lots of 'if'/'else if' statements,
    // .replace() is used to remove leading, and trailing, whitespace
    // could use .trim() instead, but that'd need a shim for (older?) IE
    switch (document.getElementById('op').value.replace(/\s/g,'')){
        // if the entered value is:
        // a '+' then we set the result element's text to the sum
        case '+':
            result[textType] = num1 + num2;
            break;
        // and so on...
        case '-':
            result[textType] = num1 - num2;
            break;
        case '*':
            result[textType] = num1 * num2;
            break;
        case '/':
            result[textType] = num1 / num2;
            break;
        // because people are going to try, give a default message if a non-math
        // operand is used
        default:
            result[textType] = 'Seriously? You wanted to try math with that operand? Now stop being silly.'
            break;
    }
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/wxhU9/4/)。

参考：

*   [`parseFloat()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat).
*   [`switch () {...}`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/switch).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:49:47.807

我会做一些不同的事情，但是为了回答你的问题并让你的代码正常工作，我做了以下事情：

这是您重新编写的代码：

```
<html>
<script>
function calc(form) {

var D = "0";
var A = document.getElementById("num1").value;
var B = document.getElementById("op").value;
var C = document.getElementById("num2").value;

if (B === "+")
{
D = parseInt(A)+parseInt(C); 
}
else if(B === "-")
{
D = parseInt(A)-parseInt(C);
}
else if(B === "*")
{
D = parseInt(A)*parseInt(C);
}
else if (B === "/")
{
D = parseInt(A)/parseInt(C);
}
document.getElementById("result").innerHTML = D;
return false;
}
</script>
<body>

<input type="text" id="num1" name="num1" />
<input type="text" id="op" name="op" />
<input type="text" id="num2" name="num2" />
<br />
<input type="button" value="Solve" onClick="calc(this)">

<p id="result" name="r1">
<br />
</p>

</body>
</html> 
```

我使用 parseint() 是因为您在 if 语句中的表达式将值视为文本。

接下来我们需要使用 === 三个等号，它表示 A 真的等于 + 或者第二个输入值是什么。

第三个是 onclick，我做了一个 (this) 并反馈表单，正如你在函数 calc 行中看到的那样。

为了更好地衡量，我添加了一个 return false; 防止表单提交（但没有它它会起作用）。

也像其他海报所说的那样，它是 else if 而不是 elseif。

我希望这是有帮助的。同样，我会以不同的方式做事，但可以通过一些解释来解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-10T20:00:45.067

我建议使用 eval() 如果用户输入 "5+6" 或 "(9*3)/5" 并将其设置为变量，则 eval() 将解析并解决问题！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T00:50:14.647

`else if`不是`elseif`。_ 您还需要在 A+C 上使用 parseInt，否则它会将您的字符串视为......以及字符串。您应该已经在浏览器中看到 elseif 错误。你在用萤火虫之类的东西吗？如果你不是，开始吧。让工具为您完成繁重的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-17T03:44:18.403

有一种方法可以使用单个输入框来完成：

```
function findOps(s) {
  for (var i = 0; i < s.length; i++) {
    if (s[i] == "+")
      return "+";
    if (s[i] == "-")
      return "-";
    if (s[i] == "*")
      return "*";
    if (s[i] == "/")
      return "/";
  }
}
var input = '';
function calc() {
  var dom = $("#input");
  input = dom.val();
  try {
    switch (findOps(input)) {
      case "+":
        var a = input.split("+");
        var x = parseFloat(a[0]);
        var y = parseFloat(a[1]);
        var res = x + y;
        if (!isNaN(res)) {
          setTimeout(function() {
            dom.val(res.toFixed(3));
            dom.get(0).setSelectionRange(0, 0);
          }, 150);

        }
        break;
      case "-":
        var a = input.split("-");
        var x = parseFloat(a[0]);
        var y = parseFloat(a[1]);
        var res = x - y;
        if (!isNaN(res)) {
          setTimeout(function() {
            dom.val(res.toFixed(3));
            dom.get(0).setSelectionRange(0, 0);
          }, 150);

        }
        break;
      case "*":
        var a = input.split("*");
        var x = parseFloat(a[0]);
        var y = parseFloat(a[1]);
        var res = x * y;
        if (!isNaN(res)) {
          setTimeout(function() {
            dom.val(res.toFixed(3));
            dom.get(0).setSelectionRange(0, 0);
          }, 150);

        }
        break;
      case "/":
        var a = input.split("/");
        var x = parseFloat(a[0]);
        var y = parseFloat(a[1]);
        var res = x / y;
        if (!isNaN(res)) {
          setTimeout(function() {
            dom.val(res.toFixed(3));
            dom.get(0).setSelectionRange(0, 0);
          }, 150);

        }
        break;
    }

  } catch (err) {
    alert("catched¡");
  }

} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2021-06-11T09:42:20.660

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Amanpreet singh</title>
</head>
<body>
    <center>
<table  cellpadding="10" cellspacing="10" style="font-size:2em">
    <tr><td>Number 1:</td>
        <td><input type="text" id="num1" name="num1" /></td>
    </tr>
    <tr><td>Number 2:</td>
        <td> <input type="text" id="num2" name="num2" /></td>
    </tr>
    <tr>
        <td>  <label for=" Operator"> Operator:</label></td>
        <td> <select name="Operator" id="op" name="op">
    <option value="+">Add</option> <option value="-">Subtract</option>
    <option value="*">Muliply</option><option value="/">Divide</option>
  </select></td>
    </tr>
    <tr><td colspan="2" align="cover">
   <center> <input type="button" value="Solve" onclick="calc()" />
</center></td>
</tr>
<tr><td colspan="2" style="text-align: center;"><p id="result" name="r1" ></p></td></tr>
</table></center>
<script type="text/javascript">
function calc() {
var D = "0";
var A = document.getElementById("num1").value;
var B = document.getElementById("op").value;
var C = document.getElementById("num2").value;
if (B === "+")
{
D = parseInt(A)+parseInt(C); 
}
else if(B === "-")
{
D = parseInt(A)-parseInt(C);
}
else if(B === "*")
{
D = parseInt(A)*parseInt(C);
}
else if (B === "/")
{
D = parseInt(A)/parseInt(C);
}
document.getElementById("result").innerHTML = "Result is :"+D;
return false;
}
</script>
</body>
</html>

```
 <!DOCTYPE html>
    <html>
    <head>
        <meta charset="utf-8">
        <title>Amanpreet singh</title>
    </head>
    <body>
        <center>
    <table  cellpadding="10" cellspacing="10" style="font-size:2em">
        <tr><td>Number 1:</td>
            <td><input type="text" id="num1" name="num1" /></td>
        </tr>
        <tr><td>Number 2:</td>
            <td> <input type="text" id="num2" name="num2" /></td>
        </tr>
        <tr>
            <td>  <label for=" Operator"> Operator:</label></td>
            <td> <select name="Operator" id="op" name="op">
        <option value="+">Add</option> <option value="-">Subtract</option>
        <option value="*">Muliply</option><option value="/">Divide</option>
      </select></td>
        </tr>
        <tr><td colspan="2" align="cover">
       <center> <input type="button" value="Solve" onclick="calc()" />
    </center></td>
    </tr>
    <tr><td colspan="2" style="text-align: center;"><p id="result" name="r1" ></p></td></tr>
    </table></center>
    <script type="text/javascript">
    function calc() {
    var D = "0";
    var A = document.getElementById("num1").value;
    var B = document.getElementById("op").value;
    var C = document.getElementById("num2").value;
    if (B === "+")
    {
    D = parseInt(A)+parseInt(C); 
    }
    else if(B === "-")
    {
    D = parseInt(A)-parseInt(C);
    }
    else if(B === "*")
    {
    D = parseInt(A)*parseInt(C);
    }
    else if (B === "/")
    {
    D = parseInt(A)/parseInt(C);
    }
    document.getElementById("result").innerHTML = "Result is :"+D;
    return false;
    }
    </script>
    </body>
    </html>
``` 
```

# deployment - 有什么方法可以在 PhpStorm 中部署数据库？

> ID：15994512
> 
> 赞同：0
> 
> 时间：2013-04-14T00:44:32.690
> 
> 标签：deployment, phpstorm

我可以通过 FTP 将文件部署到远程主机。有没有办法将数据库与文件一起部署？我使用 CMS，所以当我在控制面板中更改某些内容时，它将被写入数据库。我不想做双重工作或手动完成（这是错误的方式，呵呵）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-29T19:11:48.037

PHPStorm 有一个视图“数据库”，可以查看数据库的所有结构。您还可以从本地文件运行 SQL 脚本到远程数据库。也许与触发器等一起工作......

[PHPStorm 数据库](http://blog.jetbrains.com/webide/2012/11/sql-support-and-database-tools/)

# javascript - 如何使用更多的javascript修改页面中的javascript？

> ID：15994515
> 
> 赞同：0
> 
> 时间：2013-04-14T00:44:49.347
> 
> 标签：javascript, jquery

我有一个包含一些内联 javascript 的页面

```
<script type="text/javascript">
            $('#clipboardContainer').hide();
            $( '#clipboard' ).click(function() {
                $("#clipboardContainer").toggle( "slide", {direction: "up", mode: "hide"}, "slow" );
                $("#reportsContainer").toggle();

                if ($("#clipboard").html() == 'Open Clipboard')
                    $("#clipboard").html('Close Clipboard');
                else
                    $("#clipboard").html("Open Clipboard");
            });
            $('#prev').click(function() {
                $.ajax({
                    type: "GET",
                    url: "/teams/change_date",
                    data: {
                        'id': '<%= @team.id %>',
                        'date': '<%= @date - 1.day %>'
                    }
                });
            });
            $('#next').click(function() {
                $.ajax({
                    type: "GET",
                    url: "/teams/change_date",
                    data: {
                        'id': '<%= @team.id %>',
                        'date': '<%= @date + 1.day %>'
                    }
                });
            });
        </script> 
```

ajax 调用后，我想使用 Jquery 修改“日期”属性。如何使用 DOM 引用 javascript 函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:55:30.933

正如 Esailija 所说，没有办法使用 DOM 函数来操作 javascript 代码，您需要的是实现在成功调用 ajax 后修改的变量：

首先将您的 ajax 数据对象拉出到变量中：

```
/// pull your ajax data objects out into vars, best not to
/// pollute the global namespace though, as is done here,
/// if you can help it. I've kept things like this for simplicity.
var nextdata = {
  type: "GET",
  url: "/teams/change_date",
  dataType: 'json',
  data: {
    'id': '<%= @team.id %>',
    'date': '<%= @date - 1.day %>'
  }
};

var prevdata = {
  type: "GET",
  url: "/teams/change_date",
  dataType: 'json',
  data: {
    'id': '<%= @team.id %>',
    'date': '<%= @date + 1.day %>'
  }
}; 
```

然后创建两个新函数，它们将在您的 ajax 调用成功返回后被调用。

```
/// these two functions are just examples to illustrate
/// they will alter the ajax data objects when required
/// that is as long as your change_date script returns json
/// containing a 'newdate' property in your expected format.
var nextcallback = function( resp ){
  nextdata.date = resp.newdate;
};

var prevcallback = function( resp ){
  prevdata.date = resp.newdate;
}; 
```

然后修改您的原始代码，如下所示：

```
$('#clipboardContainer').hide();
$( '#clipboard' ).click(function() {
  $("#clipboardContainer").toggle( "slide", 
    {direction: "up", mode: "hide"}, "slow" );
  $("#reportsContainer").toggle();
  if ($("#clipboard").html() == 'Open Clipboard') {
    $("#clipboard").html('Close Clipboard');
  }
  else {
    $("#clipboard").html("Open Clipboard");
  }
});
$('#prev').click(function() {
  $.ajax(prevdata).done(prevcallback);
});
$('#next').click(function() {
  $.ajax(nextdata).done(nextcallback);
}); 
```

### 全局命名空间

关于我关于避免污染全局命名空间的评论，您应该包装您的代码，首先在“无冲突”匿名包装器中，然后在 dom 就绪包装器中 - 如下所示：

```
;(function($){ /// <-- no conflict wrapper

  /// place your methods here

  $(function(){ /// <-- dom ready wrapper

    /// place your jQuery DOM manipulation here

  });

})(jQuery); 
```

这样你就可以让你的代码与其他任何东西隔离开来，你需要知道你的函数在这些包装函数之外是不可访问的——除非你将它们作为事件侦听器附加或以其他方式在全球范围内公开它们。

或者正如 Ohgodwhy 准确指出的那样，您可以为自己保存一个函数包装器：

```
jQuery(function($){ /// <-- dom ready + no conflict wrapper
  /// place your functions + jQuery here
}); 
```

# css - LESS 行为中的嵌套混合

> ID：15994520
> 
> 赞同：1
> 
> 时间：2013-04-14T00:45:30.920
> 
> 标签：css, inheritance, less, mixins, concept

是否有可能在 LESS 中将一个 mixin 嵌套在另一个 mixin 中，以便只有当元素是具有后者 mixin 的元素的子元素时才调用前者？

我知道，令人困惑，这是一个简单的例子（**不是工作代码**，只是概念）：

**较少的**

```
.foo(@x) {
    width: @x;

    .foo(@y) {
        width: @y/@x;
    }
}

.a {
    .foo(20px);

    .b { 
        .foo(2);
    }
} 
```

**输出 CSS**

```
.a {
    width: 20px;
}

.a .b {
    width: 10px;
} 
```

当我这样做时，调用`.foo(2)`会`.b`编译为`width: 2`.

这应该是设计使然，还是我的语法有问题？另外，我是否从一个完全错误的角度来解决这个问题，并且可能有一个我没有考虑的更简单的解决方案？

## 编辑

好的，显然，最新版本的 LESS 已经解决了这个问题，不过，我想要实现的目标比我上面给出的最小示例稍微复杂一些。

基本上我想要发生的是，`.foo`作为另一个元素的子元素的每一个都`.foo`将使用它的父变量进行计算，所以，**理想情况下**

**较少的**

```
.foo(@x) {
    width: @x;

    .foo(@y) {
        width: (@x/@y);
    }
}

.a {
    .foo(100px);

    .b { 
        .foo(2px);

        .c {
            .foo(5px);
            /* ...and so on */
        }
    }
} 
```

**输出 CSS**

```
.a {
    width: 100px;
}

.a .b {
    width: 50px;
}

.a .b .c {
    width: 10px;
} 
```

我得到的是，相反：

```
.a .b .c {
    width: 50px;
} 
```

我试图修改LESS如下：

```
.foo(@x) {
    width: @x;

    .foo(@y) {
        @x:    (@x/@y)
        width: (@x);
    }
} 
```

但是我得到**递归变量定义**的语法错误。显然 LESS 不允许定义如下：

```
@a: 1;
@a: (@a+1); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T05:57:22.237

我认为这里的主要问题是`@y/@x`. 尝试一下`@x/@y`，它应该会给人更多的期望；-)

> 由于嵌套的 mixin 在不同的 less 实现中得到不同的解释，我现在将答案分为两部分：

## 1\. 使用 LESS >1.3.1 在less2css.org 上工作的解决方案（使用您的嵌套混合）

否则，我认为上面的代码实际上在 less2css.org 上做了你想要的。正如 LESS 1.4 中的一个概念，您需要小心数学，因为默认情况下它需要放在括号中。

如果你现在只是在非嵌套规则上调用这样的 mixin，比如

.b { .foo(@y); }

你需要在输入变量中使用单位，或者`unit()`在你的 mixin 中使用广告，否则你只会得到你输入的数字，例如 2：

```
.foo(@x) {
    width: unit(@x,px);
    .foo(@y) {
        width: (@x/@y);
    }
}

.a {
    .foo(20px);
    .b{
        .foo(2);
     }
}
.c {
    .foo(2);
} 
```

将输出**CSS：**

```
.a {
  width: 20px;
}
.a .b {
  width: 10px;
}
.c {
  width: 2px;
} 
```

如果子类中的属性以像素为单位，您可以变得更加花哨，并检查守卫，以便您还可以嵌套不传递因子的类：

```
.foo(@x) {
    width: @x;
    .foo(@y) when (ispixel(@y)) {
        width: @y;
    }
    .foo(@y) when not (ispixel(@y)) {
        width: (@x/@y);
    }
} 
```

然而，测试这个嵌套的 mixin 解决方案似乎只在 less2css.org 上工作，而不是在 jsbin.com、lesstester.com 和其他一些服务[你需要调用嵌套（第二）级别的 mixin`.foo .too`以应用第二级来自 mixin 的样式]。

所以我提出了一种替代方法，我测试过它似乎可以在所有提到的页面上使用 less-css 编译器，小于 >1.2。

## 2\. 使用防护装置的解决方案`ispixel`应该适用于大多数 LESS >1.2 安装

您可以构建两个 mixin，而不是嵌套的 mixin，它们基于以检查像素为单位的警卫。

*   如果属性`@x`以像素为单位 => 返回`width:@x;`并分配`@x`给变量`@width`
*   如果属性`@x`不是像素=>返回`width:@width/@x;`（**注意：** `@width`需要先通过调用mixin来`@x`分配`px`）

示例**更少：**

```
.foo(@x) when (ispixel(@x)) {
        width:@x;
        @width:@x;
}
.foo(@x) when not (ispixel(@x)) {
        width: (@width/@x);
}

.a, .b {
  background-color: #ddd;
  height: 100px;
}
.a {
  .foo(100px);
  .b {
    background-color: red;
    .foo(2);
  }
} 
```

输出**CSS**：

```
.a, .b {
  background-color: #ddd;
  height: 100px;
}
.a {
  width: 100px;
}
.a .b {
  background-color: red;
  width: 50px;
} 
```

与您的方法不同，但可能更直接一些，并且似乎效果很好。

## 编辑：

因此，由于您不想区分带单位的输入和不带单位的输入，我只能考虑调用**两个参数 mixin**，其中一个参数用于基础（`width`在您的情况下），第二个参数用作默认值到 1\. 你现在可以递归调用任意多次。

**较少的：**

```
.foo(@x,@y:1){
    width:unit(@parent,px);
    @parent:(@x/@y);
}

.a {
    .foo(100px);
    .b{
        .foo(@parent,2px);
        .c{
            .foo(@parent,5px);
            .d{
                .foo(@parent,0.05);
            }
        }
    }
} 
```

输出**CSS：**

```
.a {
  width: 100px;
}
.a .b {
  width: 50px;
}
.a .b .c {
  width: 10px;
}
.a .b .c .d {
  width: 200px;
} 
```

因此，现在输入具有什么单位并不重要，因为您可以在 mixin 中为输出分配所需的单位。当您调用 mixin 时，它会覆盖`@parent`当前范围的变量，然后将其继承到嵌套规则，您可以`@x`在再次调用 mixin 时将其用作宽度参数。这应该会给你想要的结果。

# c - 为什么我的 C 程序会产生奇怪的 printf 输出？

> ID：15994524
> 
> 赞同：3
> 
> 时间：2013-04-14T00:45:41.567
> 
> 标签：c, printf, scanf

我的源代码如下：

```
#include <stdio.h>
int main()
{
    float latitude;
    float longitude;
    char info[80];
    int started = 0;
    puts("data=[");
    while (scanf("%f, %f, %79[^\n]", &latitude, &longitude, info) == 3) {
        if (started)
            printf(",\n");
        else
            started = 1;
        printf("{latitude: %f, longitude: %f, info: '%s'}", latitude, longitude, info);

    }
    puts("\n]");
    return 0;
} 
```

我有一个数据文件 gpsdata.csv 如下：

```
42.363400,-71.098465,Speed = 21
42.363327,-71.097588,Speed = 23
42.363255,-71.096710,Speed = 17 
```

我明白了

```
./geo2json < gpsdata.csv
data=[
'},titude: 42.363400, longitude: -71.098465, info: 'Speed = 21
'},titude: 42.363327, longitude: -71.097588, info: 'Speed = 23
{latitude: 42.363255, longitude: -71.096710, info: 'Speed = 17'}
] 
```

看起来行尾以某种方式覆盖了行首。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T00:50:40.540

您的数据文件使用 Windows 样式的行结尾（`\r\n`; 回车 + 换行，而不是普通操作系统的`\n`（换行））。打印回车，每次将光标移动到行首。

# c# - 使用 DateTime 时我无法启动方法

> ID：15994525
> 
> 赞同：0
> 
> 时间：2013-04-14T00:45:43.823
> 
> 标签：c#, function, datetime, methods, datetimepicker

我的代码有问题...初始化日期时间时看不到消息框。代码有什么问题？我根本找不到任何错误。我正在使用支持 DateTimePicker 的 WPF 修改应用程序。它看起来像这样：

```
 private void Start_Click(object sender, RoutedEventArgs e)
    {
        startjob();
    }
    private void startjob()
    {
        DateTime start = (DateTime)DateTimePicker1.Value;
        DateTime end = (DateTime)DateTimePicker2.Value;
        DateTime now = DateTime.Now;
        if ((now > start) && (now < end))
        {
            System.Windows.MessageBox.Show("It works");
        }

XAML:
<wpfTool:DateTimePicker x:Name="DateTimePicker1" Margin="506,189,192,1137" Width="227" TimeFormat="LongTime">
                </wpfTool:DateTimePicker>
                <wpfTool:DateTimePicker x:Name="DateTimePicker2" Margin="506,238,192,1088" Width="227" Height="25">
                    </wpfTool:DateTimePicker> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:07:51.557

```
DateTime? start = DateTimePicker1.Value;
DateTime? end = DateTimePicker2.Value;
DateTime now = DateTime.Now;

if (start == null || end == null)
{
    // one of the pickers is empty
}
else if (now >= start.Value && now <= end.Value)
{
    // you selected values in range of "now"
} 
```

# devexpress - 删除 GridControl 中的“查找和清除”按钮

> ID：15994534
> 
> 赞同：0
> 
> 时间：2013-04-14T00:47:15.400
> 
> 标签：devexpress, gridcontrol

就像我可以消除 GridControl 的按钮（查找和清理）一样，独自离开 TextEdit。

![在此处输入图像描述](https://i.stack.imgur.com/aRYmE.png) 问候亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T08:33:43.990

您可以使用[如何自定义查找面板布局？](http://www.devexpress.com/Support/Center/p/E2806.aspx)例子：

1.  创建 GridControl/GridView 后代组件
2.  覆盖该`GridView.CreateFindPanel`方法以将您自己的自定义`FindControl`实例提供到视图中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-25T11:27:47.433

对的，这是可能的。您将需要访问 FindControl，然后访问 layoutControl 及其控件项。在 form_load 等中使用以下代码：

```
 // Get the Find Control on Grid : gcMain
        FindControl _FindControl = gcMain.Controls.Find("FindControl", true)[0] as FindControl;

           //Get the Layout Control
        LayoutControl lc = (_FindControl.ClearButton.Parent as LayoutControl);

        //Allow Control Hiding 
        lc.Root.AllowHide = true;

        //Hide Find Button
        (lc.Root.Items[2] as LayoutControlItem).ContentVisible = false;

        //Hide Clear Button
        (lc.Root.Items[3] as LayoutControlItem).ContentVisible = false; 
```

# ssis - ssis 2008，脚本组件上的参数？

> ID：15994537
> 
> 赞同：0
> 
> 时间：2013-04-14T00:47:48.070
> 
> 标签：ssis

我正在研究 SSIS 2008。

在我的 ssis 的控制流上，我有一个执行 SQL 任务，它连接到一个数据流任务，为数据流任务提供一个变量值。

在数据流任务上，我有一个脚本组件，它有一个 sql 查询，并且 sql 查询将使用变量值。

我希望脚本组件“接收”或“获取”变量作为参数，以便我可以使用参数值。

我想要的是类似 OLE DB 源的东西：如果双击 Ole Db 源并将 Sql 命令置于数据访问模式，您可以看到“参数”按钮，在那里您可以放置​​参数并将变量分配给范围。

我已经测试了脚本组件选项，但直到现在我还没有看到像 Ole DB Source 这样的功能。

如何使用脚本组件做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T04:44:48.550

如果您使用的是`OLE DB Source`组件，您应该能够像在执行 SQL 任务中那样映射参数。只需使用 a`?`作为变量占位符。

如果您使用的是 ADO.NET 连接，则更痛苦，因为参数必须映射到实际数据流之外。有关更多详细信息，请参阅此[答案](https://stackoverflow.com/questions/13961534/how-do-i-pass-value-to-a-stored-procedure-parameter-in-ole-db-source-component/13976990#13976990)。

如果您有使用 的紧迫业务需求`Script Component`，那么请务必使用它。单击脚本转换编辑器窗口的 ReadOnlyVariable 属性上的省略号。

![只读变量](https://i.stack.imgur.com/3XLoC.png)

在结果窗口中，向下滚动并检查您需要访问的所有变量。

![在此处输入图像描述](https://i.stack.imgur.com/TrPT9.png)

现在在您的脚本任务中，您将能够引用这些变量。语法应该类似于`this.ComponentMetadata.Variables.MyVariableName`

# c++ - 查找二叉树高度

> ID：15994538
> 
> 赞同：3
> 
> 时间：2013-04-14T00:47:51.907
> 
> 标签：c++, tree, binary-tree

我正在尝试编写一个函数来获取二叉树的高度。当我打印值的`maxi`值是我所期望的，但是当函数返回值时，值始终为 0。有人可以告诉我在这里做错了什么吗？

```
int treeHeight(tree *p)
{
    static int maxi=0;
    static int i=0;
    if(p==NULL)
    {
        return maxi;
    }
    else
    {
        if(p->left!=NULL||p->right!=NULL)
        {
            i++;
        }
        else
        {
            i++;
            if(maxi<i)
            {
                maxi=i;
            }
        }
        treeHeight(p->left);
        treeHeight(p->right);
        i--;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-14T00:54:03.783

您的`treeHeight`函数应如下所示：

```
int treeHeight(tree *p)
{
   if (p == NULL)
   {
      return -1;
   }

   int left = treeHeight(p->left);
   int right = treeHeight(p->right); 

   return 1 + std::max(left, right);
} 
```

为什么你需要静态变量`i`和`maxi`那里？您不需要那里的这些变量来找出二叉树的高度。

# java - 轴 2 会自动创建（并保存）wsdl 文件吗？

> ID：15994541
> 
> 赞同：8
> 
> 时间：2013-04-14T00:48:04.347
> 
> 标签：java, web-services, axis2, wso2, bpel

我有一个使用 eclipse/tomcat/axis2 启动并运行的 Web 服务。我想让它链接到一个 bpel 进程，所以我需要 wsdl 文件。我可以通过启动服务器并转到

```
http://localhost:8080/axis2/services/MyService?wsdl 
```

但是如果我搜索项目的目录结构，我找不到 wsdl 文件。我当然可以从浏览器复制并粘贴 wsdl 并将其保存为文本文件，然后将 bpel 指向该 wsdl。但似乎轴 2 会为我生成（并保存）一个 wsdl 文件，对吧？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-14T05:22:30.453

默认情况下，当您添加 时`?wsdl`，Axis2 不会检索以前生成的 WSDL 文档。每次都会生成。但是，如果您将 WSDL 文档文件和相应的 XML Schema 文件放在`META-INF`服务存档文件中的文件夹内，则可以通过以下方式恢复：

```
http://localhost:8080/axis2/services/MyService.wsdl 
```

中给出的`services.xml`服务名称和 WSDL 文档中定义的服务名称应该相同。

另一方面，如果您想保存生成的 WSDL 文档，只需在项目的某个类上运行类似以下代码片段作为*Java 应用程序*，使用 class [**`org.apache.ws.java2wsdl.Java2WSDL`**](http://svn.apache.org/repos/asf/axis/axis2/java/core/trunk/modules/java2wsdl/src/org/apache/ws/java2wsdl/Java2WSDL.java)。

```
public static void main(String[] args) throws Exception {
    Java2WSDL.main("-cn com.abc.MyService".split("\\s+"));
} 
```

执行后，生成的 WSDL 文档文件和相应的 XML Schema 文件可以在项目的文件夹中找到。

![在此处输入图像描述](https://i.stack.imgur.com/hSHdN.png)

要了解更多选项以将此工具与它们一起使用，请使用以下命令：

```
public static void main(String[] args) throws Exception {
    Java2WSDL.printUsage();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T04:56:08.080

它不在文件系统中保留 wsdl。您需要将其保存为 .wsdl 文件并将您的 BPEL 指向它。或者您可以按照[http://axis.apache.org/axis2/java/core/tools/eclipse/wsdl2java-plugin.html](http://axis.apache.org/axis2/java/core/tools/eclipse/wsdl2java-plugin.html)中提到的 java2wsdl 向导从代码生成 wsdl。

# streaming - Flowplayer 安全流式传输（通过 PHP）：MP4 视频不是伪流式传输（FLV 可以）

> ID：15994544
> 
> 赞同：1
> 
> 时间：2013-04-14T00:48:20.467
> 
> 标签：streaming, mp4, flowplayer, pseudo-streaming

我遇到了 MP4 安全伪流的问题。

首先，有几个事实供您了解：

*   我正在使用流播放器
*   我已经安装并工作了 mod_h264_streaming。
*   我已经成功添加了安全流插件（PHP 验证），它正在使用伪 FLV 视频（当然要感谢 mod_h264_streamin）。
*   我正在使用开头带有 moov-atom 的 MP4 进行测试（并且视频立即开始。但不是伪的）。

现在...当 flowplayer 加载 MP4 时，播放器会发出如下请求：

```
http://mydomain.com/videos/fa3...[security_hash]...46/video.mp4?start=0 
```

注意**?start=0**

当我寻找视频的另一部分（尚未加载）时，播放器会发出以下请求：

```
http://mydomain.com/videos/fa3...[security_hash]...46/video.mp4?start=33.342 
```

注意**?start=33.342**

这导致视频从头开始，这就是问题所在。

附加事实：对于 MP4 文件，*开始*发送（到 PHP 脚本）作为您单击的时间线的秒数，对于 FLV，*开始*发送作为以字节为单位的搜索位置，我认为这种差异是问题的主要原因.

**我的问题是：**

如何在我的 PHP 伪流脚本中处理 MP4 视频流？

**自动提问：**我应该使用*字节范围*标头吗？

我没有发布代码，因为它不是编码问题，而是概念问题：现在让我们专注于这个想法。此外，我正在测试的所有文件都经过良好编码，它们不是问题。

谢谢

# facebook - Facebook 应用白名单流程

> ID：15994546
> 
> 赞同：10
> 
> 时间：2013-04-14T00:48:28.703
> 
> 标签：facebook, facebook-graph-api, whitelist

有谁知道将 FB 应用程序列入白名单以启用某些功能的过程？我见过很少有人问同样的问题，但没有答案。FB 有处理白名单申请的联系人吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-08-19T17:22:08.643

虽然没有申请白名单的公共流程。

与大多数公司一样，Facebook 可能拥有少量私有 API，这些 API 仅供白名单中的合作伙伴使用——但它们只提供给那些亲密的合作伙伴。

Facebook 有一些功能，您可能会在审核过程中要求访问这些功能：[https](https://developers.facebook.com/docs/apps/review) ://developers.facebook.com/docs/apps/review 。在撰写本文时，这些仅包括 Taggable Friends API 和 Page Mentions。

# backbone.js - 如何在 Backbone.js 的模型中放置一个集合？

> ID：15994548
> 
> 赞同：13
> 
> 时间：2013-04-14T00:49:15.490
> 
> 标签：backbone.js, backbone.js-collections

我想了解如何在模型中添加结构集合。我的简单应用程序有团队（即团队模型和团队集合），每个团队都有一堆玩家（玩家模型和玩家集合）。所以它的视觉结构是这样的：

```
Team A
   - Player 1
   - Player 2
   - Player 3
Team B
   - Player 1
   - Player 2 
```

等等...

如何构建这样一个主干应用程序？到目前为止，我的计划如下： 1) 我将拥有一个团队集合，它将包含多个团队，其模型属性对应于 TeamModel。2) 一个玩家集合，它将包含所有多个玩家，并且模型属性对应于 PlayerModel。

现在我很困惑如何让 Team Collection 和 Model 与 Player Collection 和 Model 相对应。即根据我的设计，第三种关系是每支球队都有一组球员。但是我不确定如何实现它。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-14T11:17:52.217

“*现在我很困惑如何拥有 Team Collection 和 Model，与 Player Collection 和 Model 相对应。也就是说，根据我的设计，第三种关系是每个团队都有一个球员集合。* ”

只需向您的团队模型添加一个属性，该属性将是一组玩家。

```
var Team = Backbone.Model.extend({
  initialize: function() {
    // assuming Players a collection of players
    this.set('players', new Players());
  }
}); 
```

现在，填充数据是另一个有很多解决方案的问题。但是以这种方式做事会给你一个强大的结构。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-14T01:24:06.083

您可以执行以下操作：

```
App.Models.Player = Backbone.Model.extend({});

App.Collections.Players = Backbone.Collection.extend({
    model: App.Models.Player,
    url: 'players',
    getTeam: function(idTeam){
        var gf = _.filter( this.models, function(model){
    return (
        model.get('idTeam') == idTeam
    );
    });
        return gf;
    }
});

App.Models.Team = Backbone.Model.extend({
    players: players( this.get('id') ) // asuming that players is an App.Collections.Players instance.
});

App.Collections.Team = Backbone.Collection.extend({
    model: App.Models.Team,
    url: 'teams'
}); 
```

然后，当您创建每个实例并从服务器收集数据时，在填充所有集合后启动路由器。它应该这样工作。

# php - Php 到 JSON 传递到高位图表

> ID：15994550
> 
> 赞同：0
> 
> 时间：2013-04-14T00:49:29.767
> 
> 标签：php, javascript, json, highcharts

我正在编写一个脚本，该脚本通过 PHP 从数据库中获取数据，然后将其传递给另一个脚本，该脚本将数据用作高图表的输入（条形钻取）。使用 JSON 数组发送数据。我有两个文件如下所示：

在服务器端：

```
 <?php
header("content-type: application/json"); 

    $array = array(

                        "y" => array(44.11),

                        "color" => array( "colors" => array(0)),

                        "drilldown" => array(

                                "name" => array("MSIE versions"),

                                "categories" => array("MSIE 6.0","MSIE 7.0","MSIE 8.0", "MSIE 9.0"),    

                                "data" => array(1,2,3,5,6),

                                "color" => array("colors" => array(0))

                        )

        );

     echo $_GET['callback']. '('. json_encode($array) . ')';    

    ?> 
```

在客户端：

```
$(document).ready(function() {

        var colors = Highcharts.getOptions().colors,
            categories = ['MSIE', 'Firefox', 'Chrome', 'Safari', 'Opera'],
            name = 'Browser brands',
            data = [{}];

    var url =  "php/live-server-data.php?callback=?";
    $.getJSON(url,  function(input) {

    data = input
   }); 
```

高图表需要的输入格式（以及我试图重新创建的）是：

```
data = [{
                    y: 55.11,
                    color: colors[0],
                    drilldown: {
                        name: 'MSIE versions',
                        categories: ['MSIE 6.0', 'MSIE 7.0', 'MSIE 8.0', 'MSIE 9.0'],
                        data: [10.85, 7.35, 33.06, 2.81],
                        color: colors[0]
                    }}]
            }); 
```

我没有让它工作，谁能帮我看看我做了什么错误？非常感谢任何帮助。我被困住了

br。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:04:48.040

我认为你必须更换这个：

```
echo $_GET['callback']. '('. json_encode($array) . ')'; 
```

和

```
echo json_encode($array); 
```

如果您需要将“回调”数组与 $array 连接起来，您必须以编程方式进行，而不是像字符串一样对待......

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:15:28.770

如果预期的格式是：`[{...}]`那么您上面的示例不是缺少最外层的数组吗？当前返回的 PHP 数据是`{...}`.

这可以在 PHP 中解决：

```
echo $_GET['callback']. '(['. json_encode($array) . '])'; 
```

或者在 JS 中使用：

```
data = [input] 
```

# php - 手动执行php脚本而不通过ssh运行

> ID：15994552
> 
> 赞同：1
> 
> 时间：2013-04-14T00:49:31.623
> 
> 标签：php, sql

我的虚拟主机已禁用 ssh 和命令行。我曾尝试使用 cron 任务但无济于事。我正在尝试安装一个 wiki 扩展，它要求我执行一个名为 update.php 的脚本才能完成安装。不幸的是，我不熟悉 php 代码。我可以手动执行以下脚本中的功能来安装扩展程序吗？如果可以，有人可以列出我需要采取的查询/步骤来编辑 SQL 数据库吗？

```
<?php
if ( !function_exists( 'version_compare' ) || ( version_compare( phpversion(), '5.3.2' ) < 0 ) ) {
echo "You are using PHP version " . phpversion() . " but MediaWiki needs PHP 5.3.2 or higher. ABORTING.\n" .
"Check if you have a newer php executable with a different name, such as php5.\n";
die( 1 );
}

$wgUseMasterForMaintenance = true;
require_once( __DIR__ . '/Maintenance.php' );

/**
 * Maintenance script to run database schema updates.
 *
 * @ingroup Maintenance
 */
class UpdateMediaWiki extends Maintenance {

function __construct() {
    parent::__construct();
    $this->mDescription = "MediaWiki database updater";
    $this->addOption( 'skip-compat-checks', 'Skips compatibility checks, mostly for developers' );
    $this->addOption( 'quick', 'Skip 5 second countdown before starting' );
    $this->addOption( 'doshared', 'Also update shared tables' );
    $this->addOption( 'nopurge', 'Do not purge the objectcache table after updates' );
    $this->addOption( 'force', 'Override when $wgAllowSchemaUpdates disables this script' );
}

function getDbType() {
    /* If we used the class constant PHP4 would give a parser error here */
    return 2 /* Maintenance::DB_ADMIN */;
}

function compatChecks() {
    $test = new PhpXmlBugTester();
    if ( !$test->ok ) {
        $this->error(
            "Your system has a combination of PHP and libxml2 versions which is buggy\n" .
            "and can cause hidden data corruption in MediaWiki and other web apps.\n" .
            "Upgrade to PHP 5.2.9 or later and libxml2 2.7.3 or later!\n" .
            "ABORTING (see http://bugs.php.net/bug.php?id=45996).\n",
            true );
    }

    $test = new PhpRefCallBugTester;
    $test->execute();
    if ( !$test->ok ) {
        $ver = phpversion();
        $this->error(
            "PHP $ver is not compatible with MediaWiki due to a bug involving\n" .
            "reference parameters to __call. Upgrade to PHP 5.3.2 or higher, or \n" .
            "downgrade to PHP 5.3.0 to fix this.\n" .
            "ABORTING (see http://bugs.php.net/bug.php?id=50394 for details)\n",
            true );
    }
}

function execute() {
    global $wgVersion, $wgTitle, $wgLang, $wgAllowSchemaUpdates;

    if( !$wgAllowSchemaUpdates && !$this->hasOption( 'force' ) ) {
        $this->error( "Do not run update.php on this wiki. If you're seeing this you should\n"
            . "probably ask for some help in performing your schema updates.\n\n"
            . "If you know what you are doing, you can continue with --force", true );
    }

    $wgLang = Language::factory( 'en' );
    $wgTitle = Title::newFromText( "MediaWiki database updater" );

    $this->output( "MediaWiki {$wgVersion} Updater\n\n" );

    wfWaitForSlaves( 5 ); // let's not kill databases, shall we? ;) --tor

    if ( !$this->hasOption( 'skip-compat-checks' ) ) {
        $this->compatChecks();
    } else {
        $this->output( "Skipping compatibility checks, proceed at your own risk (Ctrl+C to abort)\n" );
        wfCountdown( 5 );
    }

    # Attempt to connect to the database as a privileged user
    # This will vomit up an error if there are permissions problems
    $db = wfGetDB( DB_MASTER );

    $this->output( "Going to run database updates for " . wfWikiID() . "\n" );
    $this->output( "Depending on the size of your database this may take a while!\n" );

    if ( !$this->hasOption( 'quick' ) ) {
        $this->output( "Abort with control-c in the next five seconds (skip this countdown with --quick) ... " );
        wfCountDown( 5 );
    }

    $shared = $this->hasOption( 'doshared' );

    $updates = array( 'core', 'extensions', 'stats' );
    if( !$this->hasOption('nopurge') ) {
        $updates[] = 'purge';
    }

    $updater = DatabaseUpdater::newForDb( $db, $shared, $this );
    $updater->doUpdates( $updates );

    foreach( $updater->getPostDatabaseUpdateMaintenance() as $maint ) {
        if ( $updater->updateRowExists( $maint ) ) {
            continue;
        }
        $child = $this->runChild( $maint );
        $child->execute();
        $updater->insertUpdateRow( $maint );
    }

    $this->output( "\nDone.\n" );
}

function afterFinalSetup() {
    global $wgLocalisationCacheConf;

    # Don't try to access the database
    # This needs to be disabled early since extensions will try to use the l10n
    # cache from $wgExtensionFunctions (bug 20471)
    $wgLocalisationCacheConf = array(
        'class' => 'LocalisationCache',
        'storeClass' => 'LCStore_Null',
        'storeDirectory' => false,
        'manualRecache' => false,
    );
}
}

$maintClass = 'UpdateMediaWiki';
require_once( RUN_MAINTENANCE_IF_MAIN ); 
```

# javascript - 下载类似 mega.co.nz 的文件

> ID：15994554
> 
> 赞同：94
> 
> 时间：2013-04-14T00:49:43.363
> 
> 标签：javascript, flash, download

今天我检查了 mega.co.nz，我对一些功能感到兴奋。例如在下载页面中，它将在浏览器上下载文件，然后使用 javascript 解密它们。

例如，查看此链接以下载 png 文件：

[https://mega.co.nz/#!7JRgFJzJ!efpJGWuPhYczLexY19ex82nuwfs4sR_DG4JXddeClH4](https://mega.co.nz/#!7JRgFJzJ!efpJGWuPhYczLexY19ex82nuwfs4sR_DG4JXddeClH4)

在此链接中，它将在浏览器中开始下载。我检查了检查元素中的网络选项卡，它会在完成文件的所有部分后使用 AJAX 下载部分文件，并将所有文件自动保存在计算机上的一个文件中！

我想知道他们做什么？你能解释或链接到一些关于在浏览器中下载文件的资源吗？

也可以只用 javascript 来完成，还是应该使用一些 flash 插件或类似的东西？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2013-04-14T01:42:13.450

Mega 使用几种不同的方法来做到这一点：（截至 2013 年 11 月 27 日）

1.  [文件系统 API](http://www.html5rocks.com/en/tutorials/file/filesystem/)（Chrome/Firefox 扩展 polyfill）
2.  Adobe Flash SWF Filewriter（旧浏览器后备）
3.  [BlobBuilder](http://msdn.microsoft.com/en-us/library/ie/hh673542%28v=vs.85%29.aspx) (IE10/IE11)
4.  MEGA Firefox 扩展（已弃用）
5.  Arraybuffer/Blob（在内存中）+ [a[download]](http://updates.html5rocks.com/2011/08/Downloading-resources-in-HTML5-a-download)（对于支持 a[download] 的浏览器）
6.  [MediaSource](https://developer.mozilla.org/en-US/docs/Web/API/MediaSource)（实验性流媒体解决方案）
7.  存储在 IndexedDB 存储中的 Blob + [a[下载]](http://updates.html5rocks.com/2011/08/Downloading-resources-in-HTML5-a-download)（Firefox 20+，对内存 Blob 方法的改进）

（来源：[https](https://eu.static.mega.co.nz/js/download_6.js) ://eu.static.mega.co.nz/js/download_6.js ）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-12-17T12:44:44.060

[此处](https://github.com/ebraminio/downloader.js/blob/45457f03e9eeba9eed7921f2ea7b7ba45ad7891a/downloader.html#L46-L80)介绍了使用 Blob 和 URL API 的多部分浏览器内下载器的基本实现。它下载 4 个并发请求的文件并显示进度。请注意，似乎`range`在 XHR 请求中设置标头通常不是一个好主意，请查看[此主题](https://stackoverflow.com/questions/15561508)。

下载时：

[![下载时](https://i.stack.imgur.com/3tPLN.png)](https://i.stack.imgur.com/3tPLN.png)

下载后：

[![下载后](https://i.stack.imgur.com/QpFTP.png)](https://i.stack.imgur.com/QpFTP.png)

另一个有趣的话题是实现 Mega 的暂停/恢复功能。当前浏览器的 XHR API 不提供该功能，因此您唯一的机会是下载多个小块并放弃小块的下载部分，这似乎也在 Mega 上完成。但是`fetch`流式传输功能可以用于此目的，我对此的探索还不够好，但[在此处](https://jakearchibald.com/2015/thats-so-fetch/)进行了记录。

顺便说一句，看看这些很棒的项目：

*   [https://github.com/eligrey/FileSaver.js](https://github.com/eligrey/FileSaver.js)
*   [https://github.com/jimmywarting/StreamSaver.js](https://github.com/jimmywarting/StreamSaver.js)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-09T23:31:45.537

## MEGAcmd

有[megacmd](https://mega.nz/cmd)，官方的命令行界面。您也可以从 github 上的源代码构建它，网址为[https://github.com/meganz/MEGAcmd](https://github.com/meganz/MEGAcmd)

`megacmd`是 Mega SDK 的包装器，如果您决定自己编译它，您将需要与下面列出的 Mega SDK 相同的依赖项（在 ubuntu 上）。

有关使用的详细信息，请参阅[MEGAcmd 用户指南](https://github.com/meganz/MEGAcmd/blob/master/UserGuide.md)。

## 超级 SDK

[Mega SDK 可以按照github](https://github.com/meganz/sdk)页面上的步骤进行编译。它包括`megacli`实用程序，它是一个用于同步和下载/上传的交互式 shell。

```
## compilation steps for ubuntu
git clone --depth 1 https://github.com/meganz/sdk megasdk
cd megasdk
sudo apt install libcurl4-openssl-dev  libc-ares-dev libssl-dev libcrypto++-dev  zlib1g-dev libsqlite3-dev  libfreeimage-dev libswscale-dev
autogen.sh
./configure
make -j 8  ## pass the number of CPUs you have to speed up compilation
sudo make install 
```

## mega.py python 模块（已弃用）

对于那些在文本模式下搜索实际配方以下载链接的问题，这里有一个简单的 python 脚本，它使用[mega.py](https://code.richard.do/richardARPANET/mega.py)模块（安装它`sudo pip install mega.py`）：

```
import sys
import getpass
#install the module with: 'sudo pip install mega.py'
from mega import Mega

email = '_your_megamail_@domain.com'
password = getpass.getpass(prompt='Mega password for {}:'.format(email))

mega = Mega({'verbose': True})
m = mega.login(email, password)
m.download_url(sys.argv[1]) 
```

该脚本适用于 python 2.7，并采用 mega.nz 链接的 URL。

> ^(***getpass***用于在控制台中安全地输入密码，以避免将密码存储在脚本中——如果您愿意对密码进行硬编码，则将其设置在第 7 行中。)

## `megatools`

在大多数 Linux/posix 机器上，您可以从标准存储库安装[megatools](https://github.com/megous/megatools)，即

### 在 ubuntu/debian 上：

```
apt install megatools 
```

### 在 MacOS 上：

```
brew install megatools 
```

安装后，您会发现许多命令行实用程序，[`megadl`](http://manpages.ubuntu.com/manpages/bionic/man1/megadl.1.html)其中可以下载共享文件和您自己的文件。详情请参阅`megadl -h`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-27T09:57:35.897

自 2020 年起，您可以使用 Service Workers 将您的自定义代码与浏览器的内置下载管理器无缝集成：[https ://developers.google.com/web/updates/2016/06/sw-readablestreams](https://developers.google.com/web/updates/2016/06/sw-readablestreams)

我还猜想您将拥有以下标头，以便下载而不是查看文件：

```
 headers: {
   'Content-Type': 'application/octet-stream',
   'Content-Disposition': 'attachment; filename="your_filename.bin"',
 } 
```

就我个人而言，我发现这种方法在 Firefox 和 Google Chrome 中都能完美运行，而且我已经在生产中使用它。

# android - 那里有 Android Google Maps v2 Marker Manager 吗？

> ID：15994556
> 
> 赞同：2
> 
> 时间：2013-04-14T00:50:08.457
> 
> 标签：android, google-maps-android-api-2, android-maps-v2

我正在尝试找到一种方法来管理我在我的应用程序中的 android 地图 (v2) 实现上拥有的标记。我希望能够绘制在可视边界内的标记，同时只显示高于某个缩放级别的标记。这似乎是一个普遍的问题。所以，我问这里是否有人使用标记管理器库之类的东西。只是为了让事情变得更容易，而且我不必从头开始制作。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T12:56:09.513

还不是管理员，但您可能想查看具有集群功能的[Android 地图扩展程序。](http://code.google.com/p/android-maps-extensions/)

**编辑：**

在 AME 中，可以通过以下方式在可见区域内绘制标记：

```
map.setClustering(new ClusteringSettings().addMarkersDynamically(true)); 
```

或者

```
map.setClustering(new ClusteringSettings().enabled(false).addMarkersDynamically(true)); 
```

如果您不想要聚类，但只在添加许多标记时针对大小写进行优化。

仅当您达到某个缩放级别时才显示标记尚未完全实现，但已[在此处](https://github.com/mg6maciej/android-maps-extensions/pull/11)请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-07T23:47:54.273

我意识到这个问题已经很老了，但如果有人仍然有同样的问题，可以使用[Google Maps Android Marker Clustering Utility](https://developers.google.com/maps/documentation/android-api/utility/marker-clustering#introduction)。
应采取的步骤如下：

1.  实现 ClusterItem 以表示地图上的标记。集群项将标记的位置作为 LatLng 对象返回。
2.  添加一个新的 ClusterManager 以根据缩放级别对集群项目（标记）进行分组。
3.  将地图的 OnCameraChangeListener() 设置为 ClusterManager，因为 ClusterManager 实现了监听器。
4.  如果要添加特定功能以响应标记单击事件，请将地图的 OnMarkerClickListener() 设置为 ClusterManager，因为 ClusterManager 实现了侦听器。
5.  将标记输入 ClusterManager。

示例实现：

```
public class MyItem implements ClusterItem {
   private final LatLng mPosition;

   public MyItem(double lat, double lng) {
       mPosition = new LatLng(lat, lng);
   }

   @Override
   public LatLng getPosition() {
       return mPosition;
   }
}

private void setUpClusterer() {
    // Declare a variable for the cluster manager.
    private ClusterManager<MyItem> mClusterManager;

    // Position the map.
    getMap().moveCamera(CameraUpdateFactory.newLatLngZoom(new LatLng(51.503186, -0.126446), 10));

    // Initialize the manager with the context and the map.
    // (Activity extends context, so we can pass 'this' in the constructor.)
    mClusterManager = new ClusterManager<MyItem>(this, getMap());

    // Point the map's listeners at the listeners implemented by the cluster
    // manager.
    getMap().setOnCameraChangeListener(mClusterManager);
    getMap().setOnMarkerClickListener(mClusterManager);

    // Add cluster items (markers) to the cluster manager.
    addItems();
    }

private void addItems() {

    // Set some lat/lng coordinates to start with.
    double lat = 51.5145160;
    double lng = -0.1270060;

    // Add ten cluster items in close proximity, for purposes of this example.
    for (int i = 0; i < 10; i++) {
        double offset = i / 60d;
        lat = lat + offset;
        lng = lng + offset;
        MyItem offsetItem = new MyItem(lat, lng);
        mClusterManager.addItem(offsetItem);
    }
} 
```

有关更多信息，您可以查看[此处](https://developers.google.com/maps/documentation/android-api/utility/#introduction)和[图书馆的 Github 页面](http://googlemaps.github.io/android-maps-utils/)

# html - 3 个内联块 div 之间的空格

> ID：15994560
> 
> 赞同：0
> 
> 时间：2013-04-14T00:50:20.410
> 
> 标签：html

这是我的jsfiddle，我有一个非常基本的问题。 [http://jsfiddle.net/DQL2U/](http://jsfiddle.net/DQL2U/)

为什么三个选项卡（主页、关于我、联系人）之间的空间很小？我该怎么做才能让它们看起来彼此相连？我看到这是一个经常遇到的问题，但找不到解决方案。

```
<!DOCTYPE html>

<html>
    <head>
        <title>
            Burak Özmen - A Newbie Web Designer
        </title>
        <link rel="stylesheet" href="index.css"/>
    </head>

    <body>
        <nav>
            <a href="http://www.facebook.com">
                <div id="home">
                    <p>Home</p>
                </div>
            </a>
            <a href="">
                <div id="about">
                    <p>About Me</p>
                </div>
            </a>
            <a href="">
                <div id="contact">
                    <p>Contact</p>
                </div>
            </a>
        </nav>
    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:52:36.950

将浮动设置为导航中的链接。

```
a {
    float:left;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:05:18.923

原因是您的标记中有空格。[默认情况下，空白属性设置为`normal`](http://www.w3.org/TR/CSS2/text.html#propdef-white-space).

> **normal**：此值指示用户代理折叠空白序列，并根据需要换行以填充行框。

有很多方法可以摆脱空格`float`：`font-size: 0`在包含的 div 上，然后将其还原回 div 内；甚至只是删除标记本身中的空格。

[http://jsfiddle.net/DQL2U/4/](http://jsfiddle.net/DQL2U/4/)（从标记中删除了必要的空格）

# javascript - 单击后在 div 中显示的递增数字

> ID：15994562
> 
> 赞同：-2
> 
> 时间：2013-04-14T00:50:24.160
> 
> 标签：javascript, jquery

我正在尝试创建一个评级系统。这个想法是在页面加载时我会看到每颗星有多少颗星。当我点击星星时，它会增加条的宽度。这就是我正在做的事情。到目前为止的问题是 1：条形图显示不正确 2：星数没有正确递增。这个想法是在新的点击后更新栏。这是小提琴。我有几个与此相关的其他问题。一旦我解决了这个问题，我会做一个新的帖子

[http://jsfiddle.net/sghoush1/VU3LP/37/](http://jsfiddle.net/sghoush1/VU3LP/37/)

Jquery 看起来像这样

```
$(function(){

    var baractive = $('<div class="barActive"></div');
    baractive.appendTo('.bar');

    var curr_val = $('.reading').html();
    var new_val = parseInt(curr_val)+1;

    if(curr_val< 20){
        $('.barActive').css('height', '20px').css('width', '20px');
    }
    if(curr_val< 40){
        $('.barActive').css('height', '20px').css('width', '40px');
    }

    $('.star').click(function(){
        $('.reading').eq($(this).index('.star')).html(new_val); 

        $(this).addClass('active');
        $('.bar').eq($(this).index('.star')).addClass('barActive');

    });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:58:04.607

就问题 #2 而言：您需要在点击响应函数内部进行读取`curr_val`和计算。`new_val`实际上，您阅读了第一个并将其用于所有星形条。

就问题 1 而言：我没有答案；你说条形图显示不正确，但你没有说你想要什么行为。`new_val`但是，我怀疑如果您将 css 分配也移动到 click 函数中（使用而不是`curr_val`用于栏），这个问题也会消失。您仍然需要使用其特定值和索引来初始化每个柱。

# ios - 为什么我不能从另一个类访问我的 UIView 的类属性？

> ID：15994567
> 
> 赞同：0
> 
> 时间：2013-04-14T00:50:51.840
> 
> 标签：ios, objective-c, xcode, uiview, uitableview

当我在使用它的 UITableViewCell 子类中尝试访问 cellFront 对象的 title 属性时，出现以下错误：

![在此处输入图像描述](https://i.stack.imgur.com/IHrDR.png)

但是我导入了 CellFront.h，它具有以下属性：

![在此处输入图像描述](https://i.stack.imgur.com/BFWIJ.png)

我究竟做错了什么？我在 Xcode 4.6 和 iOS 上，所以我不需要合成我的变量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T01:13:40.640

您导入了需要导入的所有内容，但您已转换或声明`self.cellFront`为 UIView，而不是 CellFront。编译器是对的；UIView 没有`title`.

当你让编译器知道它`self.cellFront`实际上是一个 CellFront 时，问题就会得到解决。记住，这不是看这个东西到底是什么*类*；直到运行时才会发生。编译器只知道你告诉它什么。

# netbeans - JPanel 的标题边界问题

> ID：15994569
> 
> 赞同：2
> 
> 时间：2013-04-14T00:51:26.890
> 
> 标签：netbeans, netbeans-7, netbeans-6.9

我使用 netbeans 开发了一个应用程序。但是 JPanel 的标题边框的标题有一些对齐问题。在“显示预览”中，标题按预期显示，但在运行代码时，标题在面板上方。谁能帮我解决这个问题。

# 预期面板

![在此处输入图像描述](https://i.stack.imgur.com/bpWX0.png)

# 运行项目时的实际面板

![在此处输入图像描述](https://i.stack.imgur.com/10pP5.png)

# 面板属性

![在此处输入图像描述](https://i.stack.imgur.com/GXaL4.png)

我知道这是面板的一些属性问题。我用谷歌搜索找不到有效的解决方案。请堆栈专家帮助解决此问题。我正在使用 netbeans 7.2.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T04:19:18.500

看看 Netbeans 的外观和感觉：

[http://wiki.netbeans.org/NBLookAndFeels](http://wiki.netbeans.org/NBLookAndFeels)

默认设置为 Nimbus，您可能需要 Windows。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-30T19:02:40.417

通过编辑应用程序的外观设置，您可以获得预期的结果。

```
 for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
        if ("Nimbus".equals(info.getName())) {
            javax.swing.UIManager.setLookAndFeel(info.getClassName());
            break;
        }
    } 
```

您必须将 nimbus 的外观和感觉更改为 windows ..

```
 for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
        if ("Windows".equals(info.getName())) {
            javax.swing.UIManager.setLookAndFeel(info.getClassName());
            break;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-26T11:23:55.210

您可以尝试以下选项

```
jPanel.setBorder(new TitledBorder(new LineBorder(Color.BLUE), "Sample title", TitledBorder.DEFAULT_JUSTIFICATION, TitledBorder.CENTER, new Font("SansSerif", Font.PLAIN, 12), Color.BLUE)) 
```

# sql - SQL查询从同一张表中减去净头寸

> ID：15994570
> 
> 赞同：0
> 
> 时间：2013-04-14T00:51:29.510
> 
> 标签：sql, sqlite, cordova

我正在开发一个 phonegap 应用程序——找出谁欠谁一杯酒。我想我已经接近解决方案，但如果没有外部连接（SQL Lite 不支持），就无法计算出最后一部分。

该数据库由代表购买者和接收者的用户 ID 以及单独的饮料类型（啤酒、葡萄酒、鸡尾酒等）构成。我想检查并取消相同类型的饮料，以计算出每种类型的饮料谁领先。

结果应该是一个表格，每个饮料代码都在旁边，欠的数字（可能是负数）

```
var sql = "select too.drinkType, ifnull(fro.cnt, 0) - ifnull(too.cnt, 0) as cnt FROM "+
"(SELECT drinkType, count(drinkType) as Cnt FROM drink "+
"WHERE boughtBy = "+0+" and boughtFor = " + id + " GROUP BY drinkType) too "+
" LEFT OUTER JOIN  " +
"(SELECT drinkType, count(drinkType) as Cnt FROM drink "+
"WHERE boughtBy = "+id+" and boughtFor = " + 0 + " GROUP BY drinkType) fro "+
"on too.drinkType = fro.drinkType "

tx.executeSql(sql, [], getDrinksNet_success); 
```

这几乎可以工作，但错过了仅由第二个查询（来回）返回的drinkTypes。我认为外部连接是我需要的，但 phonegap 似乎不支持这一点。有办法解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T10:06:33.537

尝试使用这样的查询，根据谁买了饮料来计数：

```
SELECT drinkType, SUM(CASE WHEN boughtBy = :id THEN 1 ELSE -1 END) AS cnt
FROM drink
WHERE (boughtBy = :id AND boughtFor = 0)   
OR (boughtFor = :id AND boughtBy = 0)
GROUP BY drinkType 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T10:57:50.117

在一般情况下，您可以`FULL OUTER JOIN`通过[组合](http://www.sqlite.org/lang_select.html#compound)左外连接和右外连接来实现 a，并`RIGHT OUTER JOIN`通过使用 a`LEFT OUTER JOIN`并交换两个表来实现 a。您的查询将如下所示：

```
SELECT ... FROM
(SELECT ...) too
LEFT OUTER JOIN
(SELECT ...) fro
ON too.drinkType = fro.drinkType
UNION
SELECT ... FROM
(SELECT ...) fro
LEFT OUTER JOIN
(SELECT ...) too
ON fro.drinkType = too.drinkType 
```

# javascript - 最大允许值

> ID：15994576
> 
> 赞同：2
> 
> 时间：2013-04-14T00:53:07.250
> 
> 标签：javascript, html

我有这个输入字段：

```
<input type="text"/> 
```

我怎样才能只允许输入一个不大于某个预定义值的数字，例如 10，所以每次尝试输入大于 10 的数字都不会被允许？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T01:09:52.470

Javascript

```
function createValidator(element) {
    return function() {
        var min = parseInt(element.getAttribute("min")) || 0;
        var max = parseInt(element.getAttribute("max")) || 0;

        var value = parseInt(element.value) || min;
        element.value = value; // make sure we got an int

        if (value < min) element.value = min;
        if (value > max) element.value = max;
    }
}

var elm = document.body.querySelector("input[type=number]");
elm.onkeyup = createValidator(elm); 
```

HTML

```
<input type="number" min="0" max="10"></input> 
```

我还没有测试过，但我认为它应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T01:19:12.260

立即将该值转换为数字，然后将其与最大值进行比较：

```
window.onload = function () {
    var textbox = document.getElementById("text1");
    var maxVal = 10;

    addEvent(textbox, "keyup", function () {
        var thisVal = +this.value;

        this.className = this.className.replace(" input-error ", "");
        if (isNaN(thisVal) || thisVal > maxVal) {
            this.className += " input-error ";
            // Invalid input
        }
    });
};

function addEvent(element, event, callback) {
    if (element.addEventListener) {
        element.addEventListener(event, callback, false);
    } else if (element.attachEvent) {
        element.attachEvent("on" + event, callback);
    } else {
        element["on" + event] = callback;
    }
} 
```

**演示：http:** [//jsfiddle.net/jBFHn/](http://jsfiddle.net/jBFHn/)

在您键入时，如果该值不是数字或该值大于最大值，`class`则会将“输入错误”添加到元素中。您可以取出整个`class`变化，并放入您自己的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-17T14:30:48.397

这就是我在项目中使用此属性的方式。

```
<script>
function integerInRange(value, min, max, name) {

    if(value < min || value > max)
    {
        document.getElementById(name).value = "100";
        alert("Write here your message");
    }
}
</script> 
```

我的输入是这样的

```
<input type="text" id="yyy" name="xxx" onkeyup="integerInRange(this.value, 0, 100, "yyy")" /> 
```

如果您使用引导程序，您可以使用警报窗口！函数整数范围（值，最小值，最大值，名称）{

```
 if(value < min || value > max)
    {
        document.getElementById(name).value = "100";
        $.pnotify({ title: 'UYARI', text: 'Girilen değer ' + min + ' ile ' + max + ' arasında olmalıdır.', type: 'error' });
        $(".ui-pnotify-history-container").remove();
    }
} 
```

# html - 通过 webbserver 流式传输 .LRF 文件

> ID：15994580
> 
> 赞同：0
> 
> 时间：2013-04-14T00:53:44.180
> 
> 标签：html

我注意到在 LoLReplays 网页上，您现在可以通过他们的程序 LoLRecorder 流式传输实时游戏。我在他们的页面上找到了这段代码

href="lrf://spectator spectator.eu.lol.riotgames.com 2nHvYdkaSjjqC7f+mtHQeIhFcUSQLFu5 488978485 EUN1 3.01.0.1"

而且我已经尝试从我自己的（已经录制的）游戏中流式传输。但我得到的只是找不到匹配项。我的问题是：这里有人知道这是如何工作的吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T01:11:00.673

> TL;博士; 您无法播放任何内容，但您可以在旁观者模式下为特定比赛打开 LoLReplay。

尝试重新安装 LoLReplay，似乎解决了我遇到的问题。

您的帖子标题有些误导，因为实际上没有发生流式传输 - 该链接所做的只是在您的本地计算机上打开 LoLReplay 并传递您想要观看的比赛的详细信息。

这仅适用于*现在*正在发生的比赛，因为它的连接方式与您观看比赛时 LoL 客户端的连接方式相似。

## 从浏览器调用 LoLReplay

链接的格式似乎如下：

```
lrf://spectator [Observer IP Address][:Observer Port] [Observer Encryption Key] [Game Id] [Platform Id] [Client Version?] 
```

`lrf://spectator`告诉 LoLReplay 在旁观者模式下打开。

`Observer IP Address`是必需的，可以是主机名或 IP 地址。主机名通常采用`spectator.[eu/na/br/etc.].lol.riotgames.com`.

`Observer Port`是可选的，我相信它默认为 8088，这似乎是默认的观众模式端口。

`Observer Encryption Key`... 是所需的每次匹配加密密钥。

`Game Id`是一个必需的、每个匹配的整数 id。

`Platform Id`是该地区的一个更具体的版本，我想这与 Riot 如何对他们的服务器进行分组有关。例如 EUW1。

`Client Version`，最后一个字段似乎是版本号 - 我只能假设这是 LoLReplay 正在使用的客户端版本或比赛中玩家正在使用的客户端版本。

## 如何查找 IP 地址、加密密钥等。

编辑：您现在可以使用官方 Riot API 获取您需要的所有信息，您只需要您要查询的用户的 SummonerId。有关用法，请参阅[当前游戏](https://developer.riotgames.com/api/methods#!/976)API 文档。

# html - 为什么 html 表格和文本框在 CSS 中具有相同的宽度，但它们却不对齐？

> ID：15994583
> 
> 赞同：0
> 
> 时间：2013-04-14T00:54:28.287
> 
> 标签：html, css, textbox, css-tables

我有一个网页表单，其中一行有一个文本框，下一行有一个表格。

在我的 CSS 中，我的宽度相同：

```
#myTable {
width: 745px;
border: 1px solid;   
border-collapse: collapse; 
```

}

```
.fullRowTextBox {
    width: 745px;
    border: 1px solid;
} 
```

但文本框似乎比那张桌子长一点。有什么理由不能让文本框和表格的宽度完全相同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T00:57:50.387

默认文本框有`padding`. 删除它

```
.fullRowTextBox {
    padding: 0;
} 
```

在这种情况下，您的表`width`必须补偿`border`，因为默认使用表`box-sizing: border-box`。所以将`width`表格的设置为文本框的`width`+ `2px`。

或者设置`box-sizing`. 有了这个你`#myTable`和`.fullRowTextBox`可以有相同的`width`设置。

```
.fullRowTextBox {
    box-sizing: border-box;
} 
```

注意：此方法可能与旧版浏览器不[兼容](http://caniuse.com/#feat=css3-boxsizing)。你应该添加[供应商前缀](http://webdesign.about.com/od/css/a/css-vendor-prefixes.htm)。

# java - 更改节点的值

> ID：15994592
> 
> 赞同：0
> 
> 时间：2013-04-14T00:56:31.063
> 
> 标签：java

我目前有三个带有值的节点的 LinkedStack。这些值是使用我在下面提到的类中创建的 push 方法创建的。我的问题是在我按下 :"1,2,3"; 之后 我有一个 3 个元素的列表，在我的分配中需要使用条件 while(current != null) 等从顶部节点到底部的顺序进行更改。但我的问题是如何在没有的情况下设法更改元素值使用 Arraylist 库或用于简化此类命令的方法，仅在主类上使用 setMethods，例如，这就是我所做的，但显然它不会起作用，因为它只是指自己没有改变任何东西。我所做的是通过“代码应该在哪里更改您已经在列表中推送的值的值”行。有人可以解释我在那条线上做错了什么吗？我尝试使用主类上的列表对象来调用 LinearNode 类方法，但它不会让我因为它期望给定的变量 current 等于该对象。祝福你。

# 线性节点类

```
public class LinearNode<T> 
{

    private LinearNode<T> next; //se guarda la direccion del Nodo
    private T element;          //Lista vacia

    public LinearNode()
{
    next = null;
    element = null;
    }
    //-----------------------------------------------------------------
    // Creates a node storing the specified element.
    //-----------------------------------------------------------------
    public LinearNode (T elem, LinearNode reference)
    {
    next = reference;
    element = elem;
    }
    //-----------------------------------------------------------------
    // Returns the node that follows this one.
    //-----------------------------------------------------------------
    public LinearNode<T> getNext()
    {
    return next;
    }
    //-----------------------------------------------------------------
    // Sets the node that follows this one.
    //-----------------------------------------------------------------
    public void setNext (LinearNode<T> node)
    {
    next = node;
    }
    //-----------------------------------------------------------------
    // Returns the element stored in this node.
    //-----------------------------------------------------------------
    public T getElement()//asigna valor
    {
    return element;
    }

    public void setElement(T elem)
    {

        element = elem;

    }

    } 
```

# LinkedStack 类

```
public class LinkedStack<T> implements Stack<T> {

private int count;
private LinearNode<T> top; //referencia del Nodo ( direccion) 

//-----------------------------------------------------------------
// Creates an empty stack using the default capacity.
//-----------------------------------------------------------------
public LinkedStack()
{
count = 0;
top = null;

}
//-----------------------------------------------------------------
// Removes the element at the top of this stack and returns a
// reference to it. Throws an EmptyCollectionException if the
// stack contains no elements.
//-----------------------------------------------------------------

public LinearNode getLinearNode(){
    return top;
}

    @Override
    public boolean IsEmpty()

    {
        if(top == null)
        {
        System.out.println("Stack is empty");
        }
        return top == null;
    }

    @Override
    public void Push(T element)
{

     LinearNode<T> current = new LinearNode<>(element, top);
     current.setNext(top);top a la variable de referencia next
     top = current;
     count++;

}

    @Override 
    public T Pop() 
{

    T result;
    System.out.println("Lets pop the top element!");

   if(count == 0)
   {
    System.out.println("Stack is empty");   
   }

    result = top.getElement();
    top = top.getNext(); 
    count--;
    System.out.println("The element that we have poped is: " + "'" + result + "'" + "\n");

    return result;

}

    @Override
    public String toString()
{

String result = "";
LinearNode current = top;
System.out.print("<top of stack-->" + "\n");
while (current != null)
{

result += "[" + current.getElement() + "]" + "\n"; 
current = current.getNext();
}
return result  + "<--bottom of stack>" + "\n";

}

    @Override
    public T Peek() {
        System.out.println("Lets peek the top element!");
        if(count == 0)
        {
         System.out.println("Peek failed stack is empty");
        }
        System.out.println("The element that we have peeked is: " + "[" + top.getElement()+ "]" +"\n");
        return top.getElement();

    }

    @Override
    public int Size() {
        if(count != 0)
        {
        System.out.println("Let's check the size of the list!");
        System.out.println("The size of the list is: "+ "'" + count + "'" + "\n");
        }
        if(count == 0)
        {
          System.out.println("The size of the list is...Woah.");  
          System.out.println("The list size is now: " + "'" + count + "'"  + "\n" + "Push more elements!");
        }

        return count;
    }

    } 
```

# 主班

```
public class LSmain {

    public static void main(String[]args)
    {
     LinkedStack<Integer> list = new LinkedStack<>();   
     System.out.println("Let's make a List!");
     System.out.println("Push 3 times.");
     System.out.println("Check the size.");
     System.out.println("Peek the top element.");
     System.out.println("Pop three times.");
     System.out.println("The size now should be zero!" + "\n");
     list.Push(1);
     list.Push(2);
     list.Push(3);
     list.Size();
     System.out.println(list.toString());
     System.out.println("Change values");

     #//# 
```

## 代码应该更改您已在列表中推送的值的值

```
 LinearNode<Integer>current;
     current = list.getLinearNode();

     while(current != null)
     {
     current.setNext(current);
     current.setElement(5);
     }
     #//#   

     System.out.println(list.toString()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T05:17:57.727

代码注释说`getLinearNode`删除堆栈顶部的元素并返回对它的引用，但您实际上并没有从堆栈中删除顶部堆栈元素。我假设您的实现是正确的，并且您的评论不正确，或者我误解了您的评论。否则，`LinkedStack`将需要一个在不修改堆栈的情况下返回对堆栈顶部的引用的方法，以便您能够遍历堆栈节点。

```
LinkedStack stack;
LinearNode current = stack.getLinearNode();
while(current != null) {
    current.setElement(T); // I don't know what T is supposed to be here
    current = current.getNext();
} 
```

# symfony - symfony2：安装 PUGXMultiUserBundle 后出现问题

> ID：15994596
> 
> 赞同：1
> 
> 时间：2013-04-14T00:56:44.233
> 
> 标签：symfony

我已经安装了 PUGXMultiUserBundle 以便在我的 symfony 项目（买家和卖家）中使用多用户。安装 PUGXMultiUserBundle 后，我创建了抽象类和继承抽象类的 2 个实体（卖家、买家）。

当我尝试通过运行命令更新数据库时：

```
php app/console doctrine:schema:update --force 
```

我有以下错误：

```
[Symfony\Component\DependencyInjection\Exception\InvalidArgumentException]
The service definition "fos_user.registration.form.factory" does not exist. 
```

我该如何解决这个问题？

# c - 如何在 Linux 内核中休眠？

> ID：15994603
> 
> 赞同：34
> 
> 时间：2013-04-14T00:58:12.227
> 
> 标签：c, linux, linux-kernel, sleep

我可以使用 msleep() 函数在内核空间中休眠指定的时间吗？如果是这样，我需要包含哪些头文件？`#include <linux/time.h>`似乎不是正确的。为此目的可能有更好的功能吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-04-14T01:11:54.073

我需要包括`<linux/delay.h>`在内核空间中使用 msleep。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-05-24T08:42:26.170

**Linux 内核文档**

[Documentation/timers/timers-howto.txt](https://github.com/torvalds/linux/blob/a351e9b9fc24e982ec2f0e76379a49826036da12/Documentation/timers/timers-howto.txt)下的 Linux 内核文档对主要方法有很好的概述：

```
Inserting Delays
----------------

The first, and most important, question you need to ask is "Is my
code in an atomic context?"  This should be followed closely by "Does
it really need to delay in atomic context?" If so...

ATOMIC CONTEXT:
    You must use the *delay family of functions. These
    functions use the jiffie estimation of clock speed
    and will busy wait for enough loop cycles to achieve
    the desired delay:

    ndelay(unsigned long nsecs)
    udelay(unsigned long usecs)
    mdelay(unsigned long msecs)

    udelay is the generally preferred API; ndelay-level
    precision may not actually exist on many non-PC devices.

    mdelay is macro wrapper around udelay, to account for
    possible overflow when passing large arguments to udelay.
    In general, use of mdelay is discouraged and code should
    be refactored to allow for the use of msleep.

NON-ATOMIC CONTEXT:
    You should use the *sleep[_range] family of functions.
    There are a few more options here, while any of them may
    work correctly, using the "right" sleep function will
    help the scheduler, power management, and just make your
    driver better :)

    -- Backed by busy-wait loop:
        udelay(unsigned long usecs)
    -- Backed by hrtimers:
        usleep_range(unsigned long min, unsigned long max)
    -- Backed by jiffies / legacy_timers
        msleep(unsigned long msecs)
        msleep_interruptible(unsigned long msecs)

    Unlike the *delay family, the underlying mechanism
    driving each of these calls varies, thus there are
    quirks you should be aware of.

    SLEEPING FOR "A FEW" USECS ( < ~10us? ):
        * Use udelay

        - Why not usleep?
            On slower systems, (embedded, OR perhaps a speed-
            stepped PC!) the overhead of setting up the hrtimers
            for usleep *may* not be worth it. Such an evaluation
            will obviously depend on your specific situation, but
            it is something to be aware of.

    SLEEPING FOR ~USECS OR SMALL MSECS ( 10us - 20ms):
        * Use usleep_range

        - Why not msleep for (1ms - 20ms)?
            Explained originally here:
                http://lkml.org/lkml/2007/8/3/250
            msleep(1~20) may not do what the caller intends, and
            will often sleep longer (~20 ms actual sleep for any
            value given in the 1~20ms range). In many cases this
            is not the desired behavior.

        - Why is there no "usleep" / What is a good range?
            Since usleep_range is built on top of hrtimers, the
            wakeup will be very precise (ish), thus a simple
            usleep function would likely introduce a large number
            of undesired interrupts.

            With the introduction of a range, the scheduler is
            free to coalesce your wakeup with any other wakeup
            that may have happened for other reasons, or at the
            worst case, fire an interrupt for your upper bound.

            The larger a range you supply, the greater a chance
            that you will not trigger an interrupt; this should
            be balanced with what is an acceptable upper bound on
            delay / performance for your specific code path. Exact
            tolerances here are very situation specific, thus it
            is left to the caller to determine a reasonable range.

    SLEEPING FOR LARGER MSECS ( 10ms+ )
        * Use msleep or possibly msleep_interruptible

        - What's the difference?
            msleep sets the current task to TASK_UNINTERRUPTIBLE
            whereas msleep_interruptible sets the current task to
            TASK_INTERRUPTIBLE before scheduling the sleep. In
            short, the difference is whether the sleep can be ended
            early by a signal. In general, just use msleep unless
            you know you have a need for the interrupt 
```

改编自这个很棒的答案：[https ://stackoverflow.com/a/39921020/895245](https://stackoverflow.com/a/39921020/895245)

接下来看看源代码中每个函数的文档注释。例如[`usleep_range`](https://github.com/torvalds/linux/blob/a351e9b9fc24e982ec2f0e76379a49826036da12/kernel/time/timer.c#L1862)：

```
/**
 * usleep_range - Sleep for an approximate time
 * @min: Minimum time in usecs to sleep
 * @max: Maximum time in usecs to sleep
 *
 * In non-atomic context where the exact wakeup time is flexible, use
 * usleep_range() instead of udelay().  The sleep improves responsiveness
 * by avoiding the CPU-hogging busy-wait of udelay(), and the range reduces
 * power usage by allowing hrtimers to take advantage of an already-
 * scheduled interrupt instead of scheduling a new one just for this sleep.
 */
void __sched usleep_range(unsigned long min, unsigned long max) 
```

[LDD3 7.3。延迟执行](http://www.makelinux.net/ldd3/chp-7-sect-3) 是另一个必备资源。

**最小的可运行示例**

最后编写自己的最小测试来尝试一下！

```
#include <linux/delay.h> /* usleep_range */
#include <linux/kernel.h>
#include <linux/kthread.h>
#include <linux/module.h>

MODULE_LICENSE("GPL");

static struct task_struct *kthread;

static int work_func(void *data)
{
    int i = 0;
    while (!kthread_should_stop()) {
        printk(KERN_INFO "%d\n", i);
        usleep_range(1000000, 1000001);
        i++;
        if (i == 10)
            i = 0;
    }
    return 0;
}

int init_module(void)
{
    kthread = kthread_create(work_func, NULL, "mykthread");
    wake_up_process(kthread);
    return 0;
}

void cleanup_module(void)
{
    /* Waits for thread to return. */
    kthread_stop(kthread);
} 
```

[GitHub 上游](https://github.com/cirosantilli/linux-kernel-module-cheat/blob/9f6ddbc436f344dd77dd9d5646dbe643f97533e4/kernel_modules/kthread.c).

# python - 即使文件中存在单词，String.count() 也会返回 0

> ID：15994604
> 
> 赞同：1
> 
> 时间：2013-04-14T00:58:14.307
> 
> 标签：python, string, substring

所以这是一个简单的代码，试图找出一个短语（“每一种资产”）在多个文件中出现的频率。

```
import codecs
import glob
import os.path

filelocation = "C:\\Users\\Shoi\\Desktop\\mark project\\BITs\\*.txt"

for filepath in glob.glob(filelocation): # for each file
    FILE = codecs.open(filepath, 'r', encoding="utf-8")
    if ("every kind of asset" in FILE.read().lower()):
        print ("Found in " + os.path.basename(filepath))
        freq = FILE.read().lower().count("every kind of asset")
        print(freq)
    else:
        print ("not found in " + os.path.basename(filepath)) 
```

但是，即使在某些文件中找到了该短语（打印了“在文件中找到”），计数函数也会返回并始终打印 0。

此代码仅搜索一个短语。当我遍历短语列表时，在所有文件中搜索每个短语 - count 函数为某些短语返回完全正确的频率结果，但为其他短语返回 0，即使该短语存在于文件中并且它打印“找到”

请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T01:02:31.427

你有两个电话到`FILE.read()`. 在第一个之后，光标将位于文件末尾，因此第二个调用将返回一个空字符串，其中根本不包含您要查找的字符串。

读取内容一次并将它们存储在变量中：

```
for filepath in glob.glob(filelocation): # for each file
    FILE = codecs.open(filepath, 'r', encoding="utf-8")
    contents = FILE.read().lower()
    if "every kind of asset" in contents:
        print("Found in " + os.path.basename(filepath))
        freq = contents.count("every kind of asset")
        print(freq)
    else:
        print("not found in " + os.path.basename(filepath)) 
```

# php - 需要帮助修改摘录代码

> ID：15994605
> 
> 赞同：0
> 
> 时间：2013-04-14T00:58:15.650
> 
> 标签：php, wordpress

我的 wordpress 主题目前在摘录的末尾添加了“...”。要阅读整篇文章，您必须单击特色图片或文章标题。

我想用“...阅读更多”替换“...”，并喜欢帖子。

我的博客位于@www.cur-mudg-eon.com，如果您现在需要查看它是如何设置的。

theme-function.php 中的代码完整地位于[pastebin](http://pastebin.com/kVp6m5wn)上。

这是我认为需要更改的代码：

```
 <?php

// The excerpt based on words
function my_string_limit_words($string, $word_limit)
{
  $words = explode(' ', $string, ($word_limit + 1));
  if(count($words) > $word_limit)
  array_pop($words);
  return implode(' ', $words).'...';
}

// The excerpt based on character
function my_string_limit_char($excerpt, $substr=0)
{

$string = strip_tags(str_replace('...', '...', $excerpt));
if ($substr>0) {
    $string = substr($string, 0, $substr);
}
return $string;
    } 
```

如果需要更多信息/代码来回答我的问题，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:24:13.907

来自[`codex`](http://codex.wordpress.org/Function_Reference/the_excerpt#Make_the_.22read_more.22_link_to_the_post)：

```
function new_excerpt_more( $more ) {
    return ' <a class="read-more" href="'. get_permalink( get_the_ID() ) . '">...Read More</a>';
}
add_filter( 'excerpt_more', 'new_excerpt_more' ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T00:47:47.110

这是我更改的代码部分：

```
// The excerpt based on words
function my_string_limit_words($string, $word_limit)
{
  $words = explode(' ', $string, ($word_limit + 1));
  if(count($words) > $word_limit)
  array_pop($words);
  return implode(' ', $words).'...';
} 
```

我只是用以下代码替换了“...”：

```
<a class="read-more" href="'. get_permalink( get_the_ID() ) . '">...Read More</a> 
```

这是最终代码的样子：

```
// The excerpt based on words
function my_string_limit_words($string, $word_limit)
{
  $words = explode(' ', $string, ($word_limit + 1));
  if(count($words) > $word_limit)
  array_pop($words);
  return implode(' ', $words).'<a class="read-more" href="'. get_permalink( get_the_ID() ) . '">...Read More</a>';
  } 
```

# python - GAE - 具有将（）自身放入数据库的函数的数据存储模型类？

> ID：15994606
> 
> 赞同：0
> 
> 时间：2013-04-14T00:58:16.490
> 
> 标签：python, google-app-engine, google-cloud-datastore

我正在尝试编写一个 Datastore 模型类，该类具有一个创建对象并将其一次性添加到 Datastore 的函数。这是我目前拥有的（不起作用）：

```
class Channel(db.Model):
    name = db.StringProperty(required = True)
    subscriber_list = db.ListProperty(users.User)

    def addChannelWithName(name):
        channel = Channel()
        channel.name = name
        channel.put() 
```

从这里我得到的问题是传递给 addChannelWithName() 的第一件事是假设是一个 Channel 实例，但当然我正在尝试做一个通道实例不应该存在。它应该在此函数期间创建。我应该如何去做这项工作？有没有办法将此函数保留为 Channel 的方法，或者这应该是一个与类完全分离的函数？还是我应该做点别的？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T03:08:19.470

Or you could make it a class method or static method. That way if your using the model somewhere else you don't need to import the seperate function from the module.

```
class Channel(db.Model):
    name = db.StringProperty(required = True)
    subscriber_list = db.ListProperty(users.User)

    @classmethod
    def addChannelWithName(cls,name):
        channel = cls()
        channel.name = name
        channel.put() 
```

or a static method and omit cls.

You would call it as Channel.addChannelWithName(name) If you use a class or static method I would drop the "Channel" bit from the method name as it's redundant. ie Channel.addWithName(name) because you only call it from the class.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:41:15.760

我认为最简单的解决方案是使其成为顶级的独立函数而不是方法。（你可以把它变成一个静态方法，或者——通过改变调用签名——一个类方法，但我真的看不出这样做有什么好处。）

# c++ - C++ 链表打印...我得到了无限循环

> ID：15994609
> 
> 赞同：0
> 
> 时间：2013-04-14T00:58:39.477
> 
> 标签：c++, pointers, data-structures, linked-list, graph-theory

我在我的主要功能中使用了它，但它不起作用

```
void LinkedList::TraPrinHead(const LinkedList& p)
{
  Nodes* currentNodes = header->next;
  while( currentNodes != tail ) {
     cout << currentNodes->elem << " ----> ";
     currentNodes = currentNodes->next; }
} 
```

我希望从这个打印整个列表......但我不断得到无限循环。

```
 cout << currentNodes->elem << " ----> ";
   currentNodes = currentNodes->next;
   cout << currentNodes->elem << " ----> ";
   currentNodes = currentNodes->next; 
```

即使我简化它只是为了打印出列表中的前两个元素，我也不会得到无限循环，而是会为不同的两个节点得到相同的结果

例如，我的第一个节点是 A1，第二个是 A2，但是使用该函数我希望得到 A1 ----> A2 但我得到的是 A1 ----> A1 ---->

我认为我的添加功能有问题。

这是我使用的功能

```
 void LinkedList::InsertDoublyBefore(Nodes* d, const string& e) {

  if (header->next == tail) 
  { 
     Nodes* n = new Nodes;
     n->elem = e; 
     n->next = tail;
     n->prev = tail->prev;
     tail->prev->next = tail->prev = n; 
     header->next = n; // very important!!!!
  }
  else
  {
       if (d==tail) 
        {
         Nodes* n = new Nodes;
         n->elem = e;
         n->next = tail;
         n->prev = tail->prev;
         tail->prev = n;
         }
       else
       {
         Nodes* n = new Nodes; 
         n->elem = e; 
         n->next = d; 
         n->prev = d->prev;
         d->prev->next = d->prev = n; 
        }
      }

     }

     void LinkedList::InsertDoublyAfter(Nodes* d, const string& e) 
     {
         InsertDoublyBefore(d->next, e);
     }

   void LinkedList::addtoFront(const string& e)  { InsertDoublyBefore(header->next, e); }
   void LinkedList::addtoBack(const string& e) { InsertDoublyBefore(tail, e); } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:20:52.913

这条线

```
 tail->prev->next = tail->prev = n; 
```

看起来不对。在`tail->prev = n`你要修改之后`n->next`，`tail->prev->next = ...`而不是真的`tail->prev->next`. 实际上，您在这里有未定义的行为，因为您修改然后`tail->prev`在表达式中使用相同的变量 ( )，这更糟。

这里

```
 if (d==tail) 
    {
     Nodes* n = new Nodes;
     n->elem = e;
     n->next = tail;
     n->prev = tail->prev;
     tail->prev = n;
     } 
```

您似乎只修改了一半的链接。

和这里

```
 {
     Nodes* n = new Nodes; 
     n->elem = e; 
     n->next = d; 
     n->prev = d->prev;
     d->prev->next = d->prev = n; 
    } 
```

您遇到与上述问题类似的问题。

使用您的调试器。但在此之前，把所有事情都写在纸上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:13:02.327

你的案子有点多余。这个特定的插入函数应该处理的情况包括。

1.  d==head（需要将head改为newNode）
2.  head==tail（需要改变head和tail，当list为空时也是这种情况head==tail==NULL）

您还可以考虑访问您的助教或您的教师办公时间。

你对非常基础的概念有很多问题，如果你没有从你的讲义中收集足够的信息来理解这些想法背后的逻辑（从你所有的帖子中），那么你应该尝试联系你的导师，助教，或其他在校园内获得帮助的选项。因为这些对于未来开发定制数据结构和应用程序开发来说是非常重要的思想。

# php - 显示来自 JSON 响应的用户名

> ID：15994613
> 
> 赞同：1
> 
> 时间：2013-04-14T00:59:31.130
> 
> 标签：php, json, api, curl

我正在尝试通过 enjin API 显示来自此 JSON 响应的所有用户名的列表，但我收到此错误：

警告：为 foreach() 提供的参数无效

代码

```
<?php

$s = curl_init();
curl_setopt($s, CURLOPT_URL, 'http://oceanix.enjin.com/api/get-users');

$output = curl_exec($s);
curl_close($s);

$decodedJson = json_decode($output);
?>

<table>
    <tr>
        <th>username</th>
    </tr>
<?php

    foreach ($decodedJson as $username) { ?>
    <tr>
        <td><?php echo $username->username; ?></td>
    </tr>
<?php 
}?>
</table> 
```

任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:11:11.147

你没有设置它，所以它进入变量，而是被发送到输出流。

添加：

```
curl_setopt($s, CURLOPT_RETURNTRANSFER, 1); 
```

在您调用之前`curl_exec()`，它会被放入您的变量中。请[`curl_setopt`](http://php.net/manual/en/function.curl-setopt.php)参阅`CURLOPT_RETURNTRANSFER`：

> TRUE 将传输作为 curl_exec() 的返回值的字符串返回，而不是直接输出。

有效的完整代码：

```
<?php

$s = curl_init();
curl_setopt($s, CURLOPT_URL, 'http://oceanix.enjin.com/api/get-users');
curl_setopt($s, CURLOPT_RETURNTRANSFER, 1);
$output = curl_exec($s);
curl_close($s);

$decodedJson = json_decode($output);
?>

<table>
    <tr>
        <th>username</th>
    </tr>
<?php

    foreach ($decodedJson as $username) { ?>
    <tr>
        <td><?php echo $username->username; ?></td>
    </tr>
<?php 
}?>
</table> 
```

# c# - 如何使用 C# 计算 RichTextBox 中的字符数

> ID：15994615
> 
> 赞同：2
> 
> 时间：2013-04-14T01:00:42.743
> 
> 标签：c#, count, richtextbox, charactercount

我是编程新手，在为按钮的字符计数器制作简单代码时遇到问题。我以某种方式设法编写了一行实际上可以计算单词的代码。这里是：

```
private void button_add_Click(object sender, EventArgs e)
{   
string count = richTextBox.Text;
label_info.Text = "Word count is " + (count.Split(new char[] {' '}, StringSplitOptions.RemoveEmptyEntries).Length).ToString();
//Trying to add a new character count down here
// label_info.Text = "Character count is " + ....code ...;
} 
```

任何意见，将不胜感激。

**编辑：**谢谢大家，我在这里得到了答案：

```
private void button_add_Click(object sender, EventArgs e)
{   
string count = richTextBox.Text;
label_info.Text = "Word count is " + (count.Split(new char[] {' '}, StringSplitOptions.RemoveEmptyEntries).Length).ToString();
label_info.Text = "\nCharacter count is " + richTextBox.Text.Lenth; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-16T06:13:13.130

您不必编写复杂的代码。您可以使用长度属性计算字符数。请参阅下面的示例代码。在其中我们使用一个文本框和一个标签，标签显示在文本框中输入的字符数。

```
void textBox1_TextChanged(object sender, EventArgs e)
  {
     lablename.Text = textboxname.Text.length.Tostring();
  } 
```

我还创建了它的视频教程。[**在 YouTube 上观看**](https://www.youtube.com/watch?v=yxCDJacc9BU)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:04:02.423

尝试使用字符串的[Length](http://msdn.microsoft.com/en-us/library/system.string.length.aspx)属性。

```
label_info.Text = label_info.Text +  "\nCharacter count is " + richTextBox.Text.Lenth; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T01:05:23.953

您正在拆分每个空格上的字符串并计算结果数组的长度。如果您想要字符串的长度（带有空格等），您可以这样做：

```
label_info.Text = "Character count is " + count.length; 
```

如果你不想要空格，你可以这样做：

```
label_info.Text = "Character count is " + count.Replace(" ", "").length; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-09T14:56:26.993

```
string a = richTextBox1.Text;
label2.Text = a.Length.ToString(); 
```

# perl - 如何在 Perl 中使用哈希进行搜索和替换

> ID：15994619
> 
> 赞同：1
> 
> 时间：2013-04-14T01:01:00.413
> 
> 标签：perl, hash

我是 Perl 的新手，恐怕我被卡住了，想问问是否有人可以帮助我。

我有一个包含旧名称和新名称两列（制表符分隔）的文件。

我想使用旧名称作为键，新名称作为值并将其存储为哈希。

然后我想打开一个不同的文件（gff 文件）并用新名称替换其中的所有旧名称并将其写入另一个文件。

我已经尽了最大的努力，但遇到了很多错误。

如果你能让我知道我做错了什么，我将不胜感激。

以下是这两个文件的外观：

旧名称新名称（SFXXXX）文件：

```
genemark-scaffold00013-abinit-gene-0.18 SF130001
augustus-scaffold00013-abinit-gene-1.24 SF130002
genemark-scaffold00013-abinit-gene-1.65 SF130003 
```

要在其中搜索和替换的文件（其中一行的示例）：

```
scaffold00013   maker   gene    258253  258759  .   -   .   ID=maker-scaffold00013-augustus-gene-2.187;Name=maker-scaffold00013-augustus-gene-2.187; 
```

这是我的尝试：

```
#!/usr/local/bin/perl
use warnings;
use strict;

my $hashfile = $ARGV[0];
my $gfffile  = $ARGV[1];
my %names;
my $oldname;
my $newname;

if (!defined $hashfile) {
    die "Usage: $0 hash_file gff_file\n";
}

if (!defined $gfffile) {
    die "Usage: $0 hash_file gff_file\n";
}

###save hashfile with two columns, oldname and newname, into a hash with oldname as key and newname as value.

open(HFILE, $hashfile) or die "Cannot open $hashfile\n";

while (my $line = <HFILE>) {
    chomp($line);
    my ($oldname, $newname) = split /\t/;
    $names{$oldname} = $newname;
}

close HFILE;

###open gff file and replace all oldnames with newnames from %names.

open(GFILE, $gfffile) or die "Cannot open $gfffile\n";

while (my $line2 = <GFILE>) {
    chomp($line2);

    eval "$line2 =~ s/$oldname/$names{oldname}/g";

    open(OUT, ">SFrenamed.gff") or die "Cannot open SFrenamed.gff: $!";

    print OUT "$line2\n";

    close OUT;
}

close GFILE; 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T01:25:27.583

您的主要问题是您没有拆分`$line`变量。`split /\t/`默认情况下会拆分`$_`，并且您没有在其中放置任何内容。

该程序构建散列，然后通过按长度降序对所有键进行排序并使用`|`正则表达式交替运算符将它们连接起来，从所有键构造一个正则表达式。排序是必要的，以便在有任何选择的情况下选择所有可能选择中*最长的一个。*

正则表达式的每次出现都被输入文件每一行中相应的新名称替换，并将输出写入新文件。

```
use strict;
use warnings;

die "Usage: $0 hash_file gff_file\n" if @ARGV < 2;

my ($hashfile, $gfffile) = @ARGV;

open(my $hfile, '<', $hashfile) or die "Cannot open $hashfile: $!";
my %names;
while (my $line = <$hfile>) {
    chomp($line);
    my ($oldname, $newname) = split /\t/, $line;
    $names{$oldname} = $newname;
}
close $hfile;

my $regex = join '|', sort { length $b <=> length $a } keys %names;
$regex = qr/$regex/;

open(my $gfile, '<', $gfffile) or die "Cannot open $gfffile: $!";
open(my $out, '>', 'SFrenamed.gff') or die "Cannot open SFrenamed.gff: $!";

while (my $line = <$gfile>) {
    chomp($line);
    $line =~ s/($regex)/$names{$1}/g;
    print $out $line, "\n";
}

close $out;
close $gfile; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T01:23:26.920

你为什么使用评估？并且`$oldname`将在第二个 while 循环中未定义，因为第一个 while 循环您在该范围内重新声明它们（即使您使用外部范围，它也会存储您处理的最后一个值，这不会有帮助） .

取出脚本顶部的`my $oldname`and ，它是没用的。`my $newname`

取出整`eva`条 l 线。您需要为要替换的每件事重复正则表达式。尝试类似：

```
$line2 =~ s/$_/$names{$_}/g for keys %names; 
```

另见鲍罗丁的回答。他做了一个大的正则表达式而不是一个循环，并发现你缺少第二个参数来拆分。

# regex - Perl 正则表达式和 < 字符

> ID：15994623
> 
> 赞同：-1
> 
> 时间：2013-04-14T01:01:09.927
> 
> 标签：regex, perl, cgi

一直在寻找这个问题的答案，但没有运气。可耻地问，因为我认为我错过了一些基本的东西。此代码是 HTML 表单+CGI 脚本的一部分，该脚本上传文件、提取文件，然后根据表单选择以 HTML 格式从上传的文件中显示信息。这部分是在名为“mylogs”的目录中创建一个 .xml 文件列表，然后删除一些路径并添加字符以使其成为有效的 HTTP 链接。

它一直运行直到`for (@array) {s/^/<a href="/};`小于字符导致问题，因为如果我删除它，它会处理其他所有内容。包含小于符号时，它会删除所有输出。

```
my $dir = "$upload_dir/var/mylogs";
my @array = <$dir/*.xml>;
for (@array) {s/\/volume1\/web//g};
for (@array) {s/^/http:\/\/192.168.1.155/g};
for (@array) {s/^/<a href="/g};
for (@array) {s/$/<a\/>/g}; 
```

我也尝试过逃避角色，但也没有成功。任何想法为什么会发生或完成上述最终结果的更好方法？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T01:10:04.020

您没有正确关闭标签（`/g`替换时不需要使用修饰符`^`or `$`）：

```
$_ = '/foo';
s/^/http:\/\/192.168.1.155/;   
  # Result is: http://192.168.1.155/foo
s/^/<a href="/;
  # Result is: <a href="http://192.168.1.155/foo
s/$/<a\/>/;
  # Result is: <a href="http://192.168.1.155/foo<a/>
  # Should be: <a href="http://192.168.1.155/foo"> What do you want here? </a> 
```

您是否真的查看过您生成的 HTML 的源代码？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T02:25:04.007

你没有证明你的问题，你的说法是错误的。

```
$ perl -E'
   my @array = qw( foo bar );
   for (@array) {s/^/<a href="/g};
   say for @array;
'
<a href="foo
<a href="bar 
```

# php - 自动发布到 pinterest

> ID：15994628
> 
> 赞同：1
> 
> 时间：2013-04-14T01:02:49.230
> 
> 标签：php, curl, pinterest

我几乎完成了这段代码，但我遇到了一个障碍，我正在为 pinterest 编写一个自动固定脚本，它会加载页面但不会提交:(我只需要一点帮助来完成这个脚本。

```
function login() {
    // Create Cookie File
    $cookiefile = './pinitcookie.txt';
    if (file_exists($cookiefile)) { unlink ($cookiefile); }
    //User and pass to Pinterest
    $email    = '<email>';
    $password = '<passowrd>';

    // initial login page which redirects to correct sign in page, sets some cookies
    $URL =  'https://pinterest.com/login';
    $ch  = curl_init();
    curl_setopt($ch, CURLOPT_URL, $URL);
    curl_setopt($ch, CURLOPT_COOKIEJAR, $cookiefile);
    curl_setopt($ch, CURLOPT_COOKIEFILE, $cookiefile);
    curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_HEADER, 1);        
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_VERBOSE, true);
    //Create the page for login
    $page = curl_exec($ch);
    preg_match('/^Set-Cookie:\s*([^;]*)/mi', $page, $m);
    //Get Pinterest CSRF token
    parse_str($m[1], $cookies);
    $token=$cookies['csrftoken'];

    // try to find the actual login form
    if (!preg_match('/<form id="AuthForm".*?<\/form>/is', $page, $form)) {
        die('Failed to find log in form!');
    }

    $form = $form[0];

    // find the action of the login form
    if (!preg_match('/action="([^"]+)"/i', $form, $action)) {
        die('Failed to find login form url');
    }

    $URL2 = "https://pinterest.com".$action[1]; // this is our new post url

    // find all hidden fields which we need to send with our login, this includes security tokens 
    $count = preg_match_all('/<input type="hidden"\s*name="([^"]*)"\s*value="([^"]*)"/i', $form, $hiddenFields);

    $postFields = array();

    // turn the hidden fields into an array
    for ($i = 0; $i < $count; ++$i) {
        $postFields[$hiddenFields[1][$i]] = $hiddenFields[2][$i];
    }

    // add our login values
    $postFields['email']    = $email;
    $postFields['csrfmiddlewaretoken']   = $token;
    $postFields['password'] = $password;

    $post = '';

    // convert to string, this won't work as an array, form will not accept multipart/form-data, only application/x-www-form-urlencoded
    foreach($postFields as $key => $value) {
        $post .= $key . '=' . urlencode($value) . '&';
    }

    $post = substr($post, 0, -1);

    curl_setopt($ch, CURLOPT_URL, $URL2);
    curl_setopt($ch, CURLOPT_REFERER, $URL);
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $post);
    curl_setopt($ch, CURLOPT_VERBOSE, true);
    $page = curl_exec($ch); // make request

    if ($page === FALSE) {
    var_dump(curl_getinfo($ch));

    }
    post_to_pinterest($ch, $token, $cookiefile, $URL);
}

function post_to_pinterest($ch, $token, $cookiefile, $URL) {

#URL3 = "http://www.pinterest.com/pin/create/button/?url=" . rawurlencode(get_permalink($post)) . "&media=" . rawurlencode($url) . "&description=" . rawurlencode(get_the_title($post));
#$URL3 = "http://www.pinterest.com/pin/create/button/?url=http://www.biofects.com&media=http://www.biofects.com/wp-content/uploads/2013/01/Untitled-11.png&description=This is a test";
$URL3 = "http://pinterest.com/pin/create/button/?";
#echo $URL3;
    $posting = "board=test&url=http://www.domain.com&media=http://www.domain.com/wp-content/uploads/2013/01/Untitled-11.png&description=This is a test&csrfmiddlewaretoken=$token";
    $x="error";
        //curl_setopt($ch, CURLOPT_COOKIEFILE, $cookiefile); 
    curl_setopt($ch, CURLOPT_URL, $URL3);
        //curl_setopt($ch, CURLOPT_REFERER, $URL);
        curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $posting);
        //curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
        //curl_setopt($ch, CURLOPT_MAXREDIRS, 5);
    //curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    //curl_setopt($ch, CURLOPT_VERBOSE, true);
    $pagetopost = curl_exec($ch);// make request
        if($x != 'error' & trim($x) != ''){
            echo "Curl Try Error".$x;
        }

  //      preg_match('/^Set-Cookie:\s*([^;]*)/mi', $pagetopost, $m);
        //Get Pinterest CSRF token
   //     parse_str($m[1], $cookies);
   //     $token=$cookies['csrftoken'];

    curl_close($ch);

}

login(); 
```

任何帮助实现这一点都会很棒，谢谢

顺便说一句，我看到人们已经完成了此操作，但正在出售此代码，完成后我将免费发布:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T01:59:00.590

大家好，我已经发布了 wordpress 插件。我已经对其进行了测试，它已在 3 个域上运行，如果您不使用 wordpress，您可以获取代码并使其成为您自己的代码。你可以在这里找到插件[http://wordpress.org/extend/plugins/lazy-pinner/](http://wordpress.org/extend/plugins/lazy-pinner/)

# c# - C# 中的 Bloomberg 数据类型库

> ID：15994632
> 
> 赞同：2
> 
> 时间：2013-04-14T01:04:12.863
> 
> 标签：c#, activex, bloomberg

一段时间以来，我一直在 C# 中成功使用旧的 Bloomberg 数据类型库 (blpdatax.dll)，直到我切换到 64 位机器并开始使用 Visual Studio 2012。现在每次尝试调用 BlpData 接口上的方法都会产生结果在访问冲突中。

附加信息：

我的目标机器类型是 x86。

使用 Bloomberg 数据类型库的 Perl 脚本继续正常工作。

其他使用第三方 32 位 COM 对象引用的 C# 程序也可以正常工作。

这是代码。异常发生在订阅调用并被描述为 Win32 异常（访问冲突）。

```
 void Test()
    {
        BlpData blp = new BlpData();
        blp.ActivateRealtime = false;
        object res;
        object symbols = "ADX US Equity";
        object fields = "PX_LAST";
        object start = new DateTime(2013, 1, 1);
        object end = new DateTime(2013, 1, 31);
        int cookie = 0;
        blp.Subscribe(symbols, cookie, fields, Type.Missing, Type.Missing, out res, Type.Missing);
        object[,] result = (object[,])res;
        Console.WriteLine(result[0,0].ToString());
    } 
```

我知道长期的解决方案是使用更新的 Bloomberg API，但目前我没有这个选择。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T00:26:29.633

事实证明，V3 API 比我想象的更容易使用，尽管其中涉及一些试验和错误。但我仍然很想知道 ActiveX 控件的问题所在。

# actionscript-3 - AS3 键盘事件

> ID：15994637
> 
> 赞同：0
> 
> 时间：2013-04-14T01:04:30.697
> 
> 标签：actionscript-3, keyboard-events, event-listener

如何为多次击键添加事件侦听器，例如，如果按下向上和向右按钮，玩家会沿对角线方向移动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T03:19:47.470

查看以下代码，我将按下的键存储在一个对象中，然后使用该对象为精灵设置动画：

```
package 
{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.KeyboardEvent;
    import flash.ui.Keyboard;

    public class Main extends Sprite 
    {
        private var _keys:Object = { };
        private var _sprite:Sprite = new Sprite;

        public function Main():void 
        {
            if (stage) init();
            else addEventListener(Event.ADDED_TO_STAGE, init);
        }

        private function init(e:Event = null):void 
        {
            removeEventListener(Event.ADDED_TO_STAGE, init);
            // entry point

            _sprite.graphics.beginFill(0xff0000, 1);
            _sprite.graphics.drawRect(0, 0, 40, 40);
            _sprite.graphics.endFill();
            _sprite.x = 100;
            _sprite.y = 100;
            addChild(_sprite);

            stage.addEventListener(KeyboardEvent.KEY_DOWN, onKeyDown);
            stage.addEventListener(KeyboardEvent.KEY_UP, onKeyUp);
            stage.addEventListener(Event.ENTER_FRAME, onEnterFrame);
        }

        private function onKeyDown(e:KeyboardEvent):void 
        {
            _keys[e.keyCode] = true;
        }

        private function onKeyUp(e:KeyboardEvent):void 
        {
            _keys[e.keyCode] = false;   
        }

        private function onEnterFrame(e:Event):void 
        {

            if (_keys[Keyboard.UP])
            {
                _sprite.y --;
            }

            if (_keys[Keyboard.DOWN])
            {
                _sprite.y ++;
            }

            if (_keys[Keyboard.RIGHT])
            {
                _sprite.x++;
            }

            if (_keys[Keyboard.LEFT])
            {
                _sprite.x--;
            }
        }

    }

} 
```

# python - 启动 Tkinter 时如何防止出现两个根窗口？

> ID：15994640
> 
> 赞同：2
> 
> 时间：2013-04-14T01:04:54.993
> 
> 标签：python, tkinter, smtp

**问题**

如何隐藏程序中弹出的两个 Tkinter 根窗口？我已经尝试使用`root.widthdraw()`. [这是我的 Pastebin 的链接。](http://pastebin.com/TMzQkvW3)

**背景**

我正在尝试创建一个*非常*基本的电子邮件客户端，以了解有关 Tkinter 和 SMTP 的更多信息。我决定我的程序将首先创建一个[顶级](http://effbot.org/tkinterbook/toplevel.htm)窗口，用户将在其中输入他们的凭据，如果服务器可以验证他们，那么程序将打开电子邮件发送对话框。令人讨厌的是，我无法隐藏程序启动时打开的另外两个根窗口。我试图用它`root.widthdraw()`来避免这个问题。

**相关代码**

```
#-----Authen is a toplevel class-------------

passcheck = Authen()

root = Tk()
root.mainloop()
root.widthdraw() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:21:43.340

您应该在创建任何其他窗口*之前创建您的根窗口。*否则你会得到你所观察到的结果：当你第一次创建其他小部件时，Tkinter 会自动创建一个根窗口，而你正在创建第二个小部件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:13:40.000

我正在使用默认`tkinter`包运行 Python2.7，而我的`root`对象没有`withdraw()`方法。除此之外，你也可以直接跑掉`mainloop`被叫`toplevel`，`passcheck`它会为你节省一个窗口。

```
class Authen(Frame):
    def __init__(self, master):
        Frame.__init__(self, master) 
```

然后：

```
root = Tk()
passcheck = Authen(root) 
root.mainloop() 
```

编辑：这是一个解决方案，而不是`Authen`a `TopLevel`，而是 a ，并作为主人`Frame`传递。[http://pastebin.com/TtnvU0er](http://pastebin.com/TtnvU0er)`root`

# php - IE8 Video.js 宽高比/大小问题

> ID：15994641
> 
> 赞同：2
> 
> 时间：2013-04-14T01:04:55.857
> 
> 标签：php, internet-explorer, cross-browser, html5-video, video.js

我对我正在从事的这个项目的痛苦结局感到沮丧，哈哈。我正在使用 Video.js 创建网站，该网站将成为用户上传比赛视频的网站。

我正在使用 twitter bootstrap，我从 PSD 创建了一个响应式设计，它在所有真实的浏览器（ff、safari、chrome 等）中看起来都很棒。它甚至在 IE7、IE9 和 IE10 中看起来都相当不错。但是，由于某种原因，它在 IE8 中完全崩溃了。

我正在使用 jquery 脚本来强制 16x9 纵横比，这就是问题所在。IE8 完全忽略了它，而且 html5 视频元素上没有宽度或高度，所以它完全吓坏了浏览器。

有任何想法吗？最终我试图只拥有响应宽度和 16x9 的高度比。我使用的脚本非常适合它，但我必须能够支持 IE8。不关心7。

这是该网站的实时预览，它使用的是 codeigniter 框架，但这并不重要......

[现场预览](http://422clients.com/renditionbattle)

这是我的页面代码...

```
<!DOCTYPE html>
<html>
<head>
<title>Cover Song Contests | Rendition Battle</title>
<meta name="description" content="RenditionBattle.com offers cash prizes for cover song contests.">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Bootstrap -->
<link href="http://localhost:8888/renditionbattle/css/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="http://localhost:8888/renditionbattle/css/main.css" rel="stylesheet" media="screen">
<link href="http://localhost:8888/renditionbattle/css/responsive.css" rel="stylesheet" media="screen">

<!-- Video.js in head for older IE -->
<link href="http://vjs.zencdn.net/c/video-js.css" rel="stylesheet">
<script src="http://vjs.zencdn.net/c/video.js"></script>
</head>
<body>

    <!-- Sticky Footer Wrapper -->
    <div class="heightWrapper">

        <!-- Login Header -->
        <div class="loginHeader">
            <div class="container">
                <div class="pull-right register">
                    <a href="#" class="btn btn-small btn-inverse">Signup</a> <a href="#">Sign Up</a> | <a href="#">Register</a>
                </div>
            </div>
        </div>
        <!-- End Login Header -->

        <!-- Logo and Navigation -->
        <div class="container header">
            <div class="logo pull-left"><a href="#"><img src="http://localhost:8888/renditionbattle/img/logo.png" alt="Rendition Battle" /></a></div>
            <ul class="mainnav pull-right">
                <li><a href="#">Home</a></li>
                <li><a href="#">Latest Battle</a></li>
                <li><a href="#">Vote Now</a></li>
                <li><a href="#">Request a Contest</a></li>
                <li><a href="#">FAQ's</a></li>
                <li><a href="#">Contact Us</a></li>
            </ul>
            <div class="btn-group mobilenav">
                <a class="btn dropdown-toggle btn-inverse" data-toggle="dropdown" href="#">Menu <span class="caret"></span></a>
                <ul class="dropdown-menu">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Latest Battle</a></li>
                    <li><a href="#">Vote Now</a></li>
                    <li><a href="#">Request a Contest</a></li>
                    <li><a href="#">FAQ's</a></li>
                    <li><a href="#">Contact Us</a></li>
                </ul>
            </div>
        </div>
        <div class="stripes"></div>
        <!-- End Logo and Navigation -->        
        <!-- Battle Leader Section -->
        <div class="background">
            <div class="container">
                <p class="tagline">sign up. upload your rendition of the contest's song. win money.</p>
                <div class="battleLeader">
                    <div id="battleVideo">
                        <div class="battleTag"></div>
                        <video id="battle" class="video-js vjs-default-skin" width="500" height="300" controls preload="auto" poster="my_video_poster.png" data-setup='{"techOrder": ["html5", "flash"]}'>
                          <source src="http://video-js.zencoder.com/oceans-clip.mp4" type='video/mp4'>
                          <source src="http://video-js.zencoder.com/oceans-clip.webm" type='video/webm'>
                        </video>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Battle Leader Section -->

        <!-- Upload Now -->
        <div class="uploadNow">
            <div class="container">
                <div class="row">
                    <div class="span9 acEntries">
                        <h4>CURRENT CONTEST ACCEPTING ENTRIES UNTIL MARCH 30, 2013</h4>
                        <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's.</p>
                    </div>
                    <div class="span3"><a href="#" class="btn btn-block btn-large btn-info">Upload Now <i class="icon-share-alt icon-white"></i></a></div>
                </div>
            </div>
        </div>
        <!-- End Upload Now -->

        <!-- Featured Member and Comments-->
        <div class="featuredMember">
            <div class="container">
                <div class="row">

                    <!-- Latest Comments -->
                    <div class="span6 latestComments">
                        <div class="comment">
                            <div class="lcContent">
                                <div class="lcAvatar"><img src="http://localhost:8888/renditionbattle/img/placeholder.jpg" alt="placeholder" /></div>
                                <div class="lcDate">Jan 7th, 2013</div>
                                <div class="lcComment">
                                    <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum is simply dummy text of the printing and typesetting industry</p>
                                </div>
                                <div class="lcMore">
                                    <a href="#" class="btn btn-small">View Profile</a>
                                </div>
                            </div>
                        </div>

                        <div class="comment">
                            <div class="lcContent">
                                <div class="lcAvatar"><img src="http://localhost:8888/renditionbattle/img/placeholder.jpg" alt="placeholder" /></div>
                                <div class="lcDate">Jan 7th, 2013</div>
                                <div class="lcComment">
                                    <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum is simply dummy text of the printing and typesetting industry</p>
                                </div>
                                <div class="lcMore">
                                    <a href="#" class="btn btn-small">View Profile</a>
                                </div>
                            </div>
                        </div>

                        <div class="comment">
                            <div class="lcContent">
                                <div class="lcAvatar"><img src="http://localhost:8888/renditionbattle/img/placeholder.jpg" alt="placeholder" /></div>
                                <div class="lcDate">Jan 7th, 2013</div>
                                <div class="lcComment">
                                    <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum is simply dummy text of the printing and typesetting industry</p>
                                </div>
                                <div class="lcMore">
                                    <a href="#" class="btn btn-small">View Profile</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Latest Member -->
                    <div class="span6 latestMember">
                        <h3>Current Contest Leader</h3>
                        <p class="lmp">ShockForce75's rendition of Carly Rae Jaspen's: Call Me Maybe</p>
                        <div class="latestvid">
                            <video id="lvid" class="video-js vjs-default-skin" controls preload="auto" poster="my_video_poster.png" data-setup='{"techOrder": ["html5", "flash"]}'>
                              <source src="http://video-js.zencoder.com/oceans-clip.mp4" type='video/mp4'>
                              <source src="http://video-js.zencoder.com/oceans-clip.webm" type='video/webm'>
                            </video>
                        </div>
                        <div class="lvidComment">
                            <div class="lvidCommentTail"><img src="http://localhost:8888/renditionbattle/img/lc.png" alt="latest comment" /></div>
                            <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum is simply dummy text of the printing.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Featured Member -->

        <!-- Previous Members -->
        <div class="pwHeader">
            <div class="container">
                <h4>Previous Winners</h4>
            </div>
        </div>
        <div class="pw">
            <div class="container">
                <div class="row">
                    <div class="span2 pwMember"><img src="http://localhost:8888/renditionbattle/img/placeholder.jpg" alt="placeholder username" /></div>
                    <div class="span2 pwMember"><img src="http://localhost:8888/renditionbattle/img/placeholder.jpg" alt="placeholder username" /></div>
                    <div class="span2 pwMember"><img src="http://localhost:8888/renditionbattle/img/placeholder.jpg" alt="placeholder username" /></div>
                    <div class="span2 pwMember"><img src="http://localhost:8888/renditionbattle/img/placeholder.jpg" alt="placeholder username" /></div>
                    <div class="span2 pwMember"><img src="http://localhost:8888/renditionbattle/img/placeholder.jpg" alt="placeholder username" /></div>
                    <div class="span2 pwMember"><img src="http://localhost:8888/renditionbattle/img/placeholder.jpg" alt="placeholder username" /></div>
                </div>
            </div>
        </div>
        <!-- End Previous Members -->       <div class="push"></div>
    </div>
    <!-- End Sticky Footer Wrapper -->

    <!-- Footer -->
    <div class="footer">
        <div class="container">
            <div class="pull-left">
                <p>Copright &copy; 2013 RenditionBattle.com. All Rights Reserved.<br />
                <a href="http://422studios.com" target="_blank">Dallas Web Development</a> by 422 Studios, LLC</p>
            </div>
            <div class="pull-right">
                <a href="#"><img src="http://localhost:8888/renditionbattle/img/icon-twitter.png" alt="twitter" /></a> 
                <a href="#"><img src="http://localhost:8888/renditionbattle/img/icon-fb.png" alt="facebook" /></a>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
    <!-- End Footer -->

    <!-- JS -->
    <input type="hidden" id="siteUrl" value="http://localhost:8888/" />
    <input type="hidden" id="baseUrl" value="http://localhost:8888/" />
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="http://localhost:8888/renditionbattle/js/bootstrap.min.js"></script>
    <script src="http://localhost:8888/renditionbattle/js/respond.min.js"></script>
    <script src="http://localhost:8888/renditionbattle/js/main.js"></script>
    <script src="http://localhost:8888/renditionbattle/js/aspectratio.js"></script>

</body>
</html> 
```

这是我的纵横比的 JS ......

```
//Battle video aspect ratio
// Once the video is ready
$(document).ready(function() {
      _V_("battle").ready(function(){

        var myPlayer = this;    // Store the video object
        var aspectRatio = 9/16; // Make up an aspect ratio

        function resizeVideoJS(){
          // Get the parent element's actual width
          var width = document.getElementById(myPlayer.id).parentElement.offsetWidth;
          // Set width to fill parent element, Set height
          myPlayer.width(width).height( width * aspectRatio );
        }

        resizeVideoJS(); // Initialize the function
        window.onresize = resizeVideoJS; // Call the function on resize
    });

    //Latest video aspect ratio
    // Once the video is ready
      _V_("lvid").ready(function(){

        var myPlayer = this;    // Store the video object
        var aspectRatio = 9/16; // Make up an aspect ratio

        function resizeVideoJS(){
          // Get the parent element's actual width
          var width = document.getElementById(myPlayer.id).parentElement.offsetWidth;
          // Set width to fill parent element, Set height
          myPlayer.width(width).height( width * aspectRatio );
        }

        resizeVideoJS(); // Initialize the function
        window.onresize = resizeVideoJS; // Call the function on resize
    });
}); 
```

关于如何修改我的代码以使其工作的任何想法？如果有人知道我可以用来实现我的终极目标的东西，我愿意在需要时完全更换解决方案。

此外，如果它们是 IE8，我确实尝试了所有我能找到并想到的重定向到[http://www.422clients.com/page/upgrade但它只会永远加载并最终在 ie8 上给我一个奇怪的连接错误页面。](http://www.422clients.com/page/upgrade)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T06:37:56.470

ie8 不支持 video 标签，ie7 也不支持 - 不知道你是如何让它在那里工作的。

证明：[http ://caniuse.com/#feat=video](http://caniuse.com/#feat=video)

您将需要使用 Flash 替代品，或放弃 ie8 的视频，或放弃 ie8 支持。您可以使用的一个好的库是[https://github.com/zencoder/video-js](https://github.com/zencoder/video-js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:12:25.307

无论如何，当您使用 jQuery 时，请使用它的 resize() 方法，因为它似乎在 IE8 上更可靠地工作。

此外，根据[API Docs](https://github.com/zencoder/video-js/blob/master/docs/api.md) ， size() 比 height() 和 width() 更有效。

```
function resizeVideoJS(){
  // Get the parent element's actual width
  var width = document.getElementById(myPlayer.id).parentElement.offsetWidth;
  // Set width to fill parent element, Set height
  myPlayer.size(width,Math.floor(width*aspectRatio));
}

resizeVideoJS();
$(window).resize(resizeVideoJS); 
```

# php - 将图像复制到多个文件夹

> ID：15994642
> 
> 赞同：0
> 
> 时间：2013-04-14T01:04:59.343
> 
> 标签：php

我写了一个关于减小图像大小的测试工作代码，当图像上传时，它从一个文件夹复制到另一个文件夹。它将图像大小减小到 300 的宽度和 300 的高度。

我还想将相同的图像大小减小到 100 的宽度和 100 的高度，这样我就可以使用最小的图像作为个人资料图片和电子邮件收件箱图像。而另一个在用户相册上的图像为 300，高度为 300。

我希望上传的图像复制到宽度 300 和高度 300 以及 100 和高度 100 的 2 个不同尺寸。

请帮我。

```
 if(move_uploaded_file($this->tem_path, $terger_path)){                  
                $exe = explode(".", $this->filename);
                $ext = $exe[1];
                $w = 300;
                $h = 300;
                $target = SITE_ROOT.DS.$this->img_path.DS.$this->filename;              
                $newcopy = SITE_ROOT.DS.$this->resize.DS.$this->filename; 
                list($w_orig, $h_orig) = getimagesize($target);
                $scale_ratio = $w_orig / $h_orig;
                if (($w / $h) > $scale_ratio) {
                   $w = $h * $scale_ratio;
                } else {
                   $h = $w / $scale_ratio;
                }
                $img = "";
                $ext = strtolower($ext);
                if ($ext == "gif"){ 
                     $img = imagecreatefromgif($target);
                } else if($ext =="png"){ 
                     $img = imagecreatefrompng($target);
                } else { 
                  $img = imagecreatefromjpeg($target);
                }
                $tci = imagecreatetruecolor($w, $h);
                imagecopyresampled($tci, $img, 0, 0, 0, 0, $w, $h, $w_orig, $h_orig);
                if(@imagejpeg($tci, $newcopy, 80)){
                //  return true;
                    $terger_path = SITE_ROOT.DS.$this->img_path.DS.$this->filename;
                    return unlink($terger_path) ? true : false;                     
                }                   

            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:53:10.170

嗯，这很容易：

1.  首先调整大小，将其复制到第一个位置。不要删除上传的文件。
2.  进行第二次调整大小，复制到其他位置。
3.  完成清洁（如有必要）

# c++ - C++11 在不使用 try / catch 块的情况下安全地加入线程

> ID：15994650
> 
> 赞同：10
> 
> 时间：2013-04-14T01:06:41.203
> 
> 标签：c++, multithreading, exception, c++11, exception-handling

根据[此处](http://en.cppreference.com/w/cpp/thread/thread/join)和[此处](http://en.cppreference.com/w/cpp/thread/thread/joinable)的文档，C++11 线程的 join 方法将抛出`std::system_error`if `joinable() == false`。因此，等待线程完成执行的自然方式是：

```
if (thread2.joinable()) thread2.join(); 
```

但是，这有可能引发 std::system_error。考虑线程1调用thread2.joinable()，返回true，说明thread2还在运行。然后调度程序暂停线程 1 并将上下文切换到线程 2。线程 2 完成，然后线程 1 恢复。线程 1 调用 thread2.join()，但 thread2 已经完成，结果抛出 std::system_error。

一个可能的解决方案是将整个东西包装在一个 try 块中：

```
try {
    thread2.join();
catch (std::system_error &e) {} 
```

但是当一个合法的 std::system_error 被抛出时，可能表明线程**未能加入**，程序继续运行，就好像一切都很好而且花花公子一样。除了使用这样的 try/catch 块之外，还有没有合适的方法来加入线程？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-14T01:27:39.460

`joinable`不做你认为它做的事。它所做的只是返回线程对象是否与线程相关联*。*但是，`thread::join`如果线程对象也代表当前线程，则会失败。`thread::join`因此，由于缺乏而失败的唯一原因`joinable`是如果您尝试加入自己。

一个*完整*的线程（不是你自己的）仍然是完全可连接的。

# javascript - SHOUTcast 流媒体音乐和 OpenX 广告

> ID：15994652
> 
> 赞同：0
> 
> 时间：2013-04-14T01:07:01.087
> 
> 标签：javascript, streaming, facebook-javascript-sdk, openx

我创建了一个标签页应用程序，通过 OpenX（由 Facebook 批准）流式传输音乐并显示横幅广告。Facebook 内的框架页面位于此处：[https ://www.mypchost.com/stream/](https://www.mypchost.com/stream/)

我遇到的问题是横幅广告将在 Facebook 外部正确显示，但不能在应用程序本身内显示（[https://www.facebook.com/pages/MyPCHostcom/220325541429517?id=220325541429517&sk=app_484549871594370](https://www.facebook.com/pages/MyPCHostcom/220325541429517?id=220325541429517&sk=app_484549871594370)）。应该发生的是，背景应该以 30 秒的间隔旋转，并且横幅应该在页面加载时发生变化；有时刷新页面 3-6 次会发生这种情况，它会有所不同。

我尝试过使用通过 OpenX 提供的 JavaScript 和`iframe`代码。两者都可以在 Facebook 之外工作 - 但绝不会在其中。

我已经尝试了我能想到的一切。我可以使用 JavaScript 将横幅设置为手动旋转，但这不允许 OpenX 广告服务器的功能旋转横幅，因为它没有绑定到服务器，而是手动编码到页面上。

有没有人知道为什么这在 Facebook 外部而不是内部起作用？如果您打开一个带有外部版本的窗口和一个带有 Facebook 内应用程序的窗口并刷新两者，您将看到投放的不同广告。这是一件如此简单的事情，但为什么它不工作！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T20:01:35.437

您遇到的问题是因为 OpenX 的交付 URL 没有使用您的 SSL URL。很可能您需要做的就是将横幅区域的调用代码中的 http: 替换为 https:。可能还有更多内容，但这就是要点。

# html - 如何在表单上布局文本和输入以适应特定宽度（合理）？

> ID：15994654
> 
> 赞同：4
> 
> 时间：2013-04-14T01:07:07.440
> 
> 标签：html, css, forms, layout

我有一个表格，我正在尝试使一行“合理”，以便整行（这是一个 4 个文本框和标签）适合精确的像素宽度（比如说 800 像素）。通常，如果我只是在没有任何特殊 css 的情况下进行布局，它小于 800px。我想将其“拉伸”为 800 像素。我不在乎是否必须拉伸文本框或它们之间的空格。

如果这有助于描述我正在寻找的内容，这类似于 MS Word 中的合理布局。这可能在表单布局中的 html / css 中吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T14:57:34.370

您基本上需要[`text-align-last: justify`](https://developer.mozilla.org/en-US/docs/CSS/text-align-last)它指定块元素中“最后一个文本行”的对齐方式，这默认为标准方向，即`left`LTR。

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>SO question 15994654</title>
        <style>
            #fields {
                width: 1000px;
                border: 1px solid gray;
            }

            .justified {
                text-align-last: justify;
            }
        </style>
    </head>
    <body>
        <p id="fields" class="justified">
            <label for="input1">label1</label>
            <input id="input1" />
            <label for="input2">label2</label>
            <input id="input2" />
            <label for="input3">label3</label>
            <input id="input3" />
            <label for="input4">label4</label>
            <input id="input4" />
        <p>
    </body>
</html> 
```

这在 IE 和 Firefox 中有效（对于较旧的 Firefox 版本，`-moz-text-align-last: justify`如有必要，请添加），但在基于 Webkit 的浏览器（Chrome/Safari）中失败。为了覆盖这些浏览器，您需要进行`.justified`如下替换，以便最后一行不再显示为“最后一行”，这样就`text-align: justify`可以按照通常的方式完成工作：

```
.justified {
    text-align: justify;
}

.justified:after {
    content: '';
    display: inline-block;
    width: 100%;
} 
```

请注意，`text-align-last: justify`这种方式变得多余。

这是[jsfiddle 演示](http://jsfiddle.net/rj6aM/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-25T13:31:36.123

实际上，使用纯 CSS 使用`text-align: justify;`.

您没有成功，因为对齐对最后一行不起作用（当只有一行时，它被认为是最后一行）。有一个 CSS3 属性可以设置最后一行的文本对齐方式：[text-align-last](http://www.w3.org/TR/css3-text/#text-align-last)。不幸的是，它没有得到广泛支持。

解决方案是产生一个额外的元素，该元素将下降到下一行，然后第一行将是合理的：

```
<form>
  <input type="text" value="" />
  <input type="text" value="" />
  <input type="text" value="" />
  <input type="text" value="" />
</form> 
```

```
form {
  width: 800px;
  text-align: justify;    /* Can we really make this work? Sure! */
}

input {
  display: inline-block;  /* making elements respect text-align */
}

form:after {
  content: "";            /* creating a hidden element that drops to next line */
  display: inline-block;  /* making it respect text-align and width */
  width: 100%;            /* forcing it to drop to next line */
} 
```

演示： http: [//jsbin.com/ituroj/5/](http://jsbin.com/ituroj/5/)（点击右上角的“编辑”来修改代码）。

结果：语义化、没有 HTML 占用空间、最少的 CSS 代码、完整的浏览器支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T01:12:55.247

一种方法是：

```
input[type=text] {
    width: 25%;
    box-sizing: border-box;
} 
```

或者，如果字段确实在[此 Fiddle](http://jsfiddle.net/se6Fu/1/)`<table/>`中的类似内容中，则可以将文本框的 设置为，以便表格控制宽度：`width``100%`

```
input[type=text] {
    width: 100%;
    box-sizing: border-box;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T05:09:38.157

您可以通过将输入和标签嵌套在按百分比确定宽度的“列”内来实现 - 这样您就可以控制表单的宽度并且输入将保持合理。

**HTML**

```
<form>
    <div class="col4">
        <label>Input</label>
        <div class="inputWrapper">
                <div class="textInput">
                    <input type="text"/>
                </div>
        </div>
    </div>
    <div class="col4">
        <label>Input</label>
        <div class="inputWrapper">
                <div class="textInput">
                    <input type="text"/>
                </div>
        </div>
    </div>
    <div class="col4">
        <label>Input</label>
        <div class="inputWrapper">
                <div class="textInput">
                    <input type="text"/>
                </div>
        </div>
    </div>
    <div class="col4 last">
        <label>Input</label>
        <div class="inputWrapper">
                <div class="textInput">
                    <input type="text"/>
                </div>
        </div>
    </div>
</form> 
```

**CSS**

```
form{
    width:800px;
}

.col4{
    width:23.5%;
    margin-right:2%;
    float:left;
}

.last{
    margin:0;
}

.inputWrapper{
    width:100%;
}

.textInput{
    border:1px solid #ccc;
    display:block;
    padding:5px;
}

.textInput input{
    width:100%;
    border:none;
    padding:0;
} 
```

您可以在此处查看 jsFiddle 示例[http://jsfiddle.net/patricklyver/4mbks/](http://jsfiddle.net/patricklyver/4mbks/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T14:56:17.640

你可以`float`结合`box-sizing`. 您将不得不浮动，因为表单在不同的浏览器中具有不同的怪异之处。例如，在 OS X 上的 Safari 中，顶部总是有一个隐藏的 1px 填充。

[JSfiddle](http://jsfiddle.net/Allendar/XjbeW/)

**HTML**

```
<form id="myForm">
    <input type="text" value="" />
    <input type="text" value="" />
    <input type="text" value="" />
    <input type="text" value="" />
    <div class="clear"></div>
</form> 
```

**CSS**

```
#myForm {
    border: 1px solid blue;
    width: 800px;
}

#myForm input[type=text] {
    margin: 0px;
    display: block;
    float: left;
    box-sizing: border-box;
    width: 25%;
    border: 0px;
    background-color: orange;
}

#myForm .clear {
    clear: both;
} 
```

# android - 我在主目录中清除了一个数组列表，但是当我从另一个类中添加所有内容时，原始数据会在添加新数据之前重新出现

> ID：15994655
> 
> 赞同：0
> 
> 时间：2013-04-14T01:07:37.520
> 
> 标签：android, arraylist

我在我的 main 中清除了一个数组列表（sizecheck 说 0），但是当我再次从我的类中添加时，原始数据在新数据之前重新出现，大小检查确认了这一点。有没有办法解决？

澄清一下：我一直在清除，通过 log cmd 确认 arraylist 大小为 0 的大小，重新添加新数据只会增加总数。清除 50-->0，然后添加 50 = 100，清除 100-->0 并再次添加 50，它是 150，等等。

帮我杀了这个僵尸数据！

以下为节录：

```
ArrayList<Integer> imagearray = new ArrayList<Integer>();
....onCreate....
imagearray.clear(); // confirmed this makes arraylist size = 0
imagearray.addAll(animalclass.getpics(songtolearn)); 
// this last line is dragging all the cleared data back and adds the new data too 
```

它从以下位置拖动数据：

```
public ArrayList<Integer> getpics(int songnumber) {

switch (songnumber) { 
case 1:
  animalpics.add(1);
  animalpics.add(1);
break;
return animalpics; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T11:42:47.190

在动物类中，我需要删除 ArrayList animalpics = new ArrayList(); 我从哪里声明变量并将其放在本地 getpics 命令中。

# bigdata - 非常大的仅附加动态数组的库

> ID：15994661
> 
> 赞同：1
> 
> 时间：2013-04-14T01:08:44.577
> 
> 标签：bigdata

我正在寻找一个允许`append(element)`和`get(index)`. 不`insert`，`set`是`delete`必需的。

*   该阵列将是如此之大，它主要留在硬盘上。
*   新元素的访问频率高于旧元素。
*   每次随机访问之后都会有许多顺序访问。

这些表明可以压缩和存储来自很远的数据。

这个数组的大小应该是无限的，它只受硬盘上的存储量的限制。

硬盘上的文件也可以被其他进程访问，因为只有一个进程会完成所有的写入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-03T11:48:51.023

如果您可以使用 Python（没有提及语言？），[PyTables](http://www.pytables.org/moin)是一个不错的选择。它

*   使用紧凑的二进制[HDF5](http://en.wikipedia.org/wiki/Hierarchical_Data_Format#HDF5)格式
*   [可以使用blosc](http://www.blosc.org/)有效地压缩数字数据
*   以性能为导向，有很多[优化技巧](http://pytables.github.io/usersguide/optimization.html)

# cron - 使用 Cron 作业按大小删除目录内的文件

> ID：15994664
> 
> 赞同：2
> 
> 时间：2013-04-14T01:09:00.000
> 
> 标签：cron

我正在尝试删除某个目录中具有一定大小的所有文件，在这种情况下是 39 位。我知道下面的代码将删除所有 0 位的文件。

```
find /home/.../...* -size 0 -type f -exec rm -f '{}' \; 
```

那么我需要做什么才能使其适用于 39 位文件？下面的 cron 不起作用。

```
find /home/.../...* -size 39 -type f -exec rm -f '{}' \; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:50:03.330

你有什么理由使用 rm 而不是 find 自己的 delete primary 吗？

```
find /home/.../...* -size 39c -type f -delete 
```

为什么它不起作用的关键，尽管它的大小主要是参数作为 512k 块的数量并将文件大小四舍五入以满足该大小，所以 39 实际上意味着文件大小在 14,337 和 19,968 字节之间。要以字节为单位指定要匹配的大小，您需要添加`c`(for characters) 的后缀。

如果您必须使用 rm，那么以 a`+`而不是`\;`更有效地结束命令，因为它将批量匹配文件名（如使用 xargs）以减少它需要调用 rm 的次数。

# javascript - 当转发器中的对象为空时，AngularJS显示消息

> ID：15994666
> 
> 赞同：8
> 
> 时间：2013-04-14T01:09:08.713
> 
> 标签：javascript, angularjs

我正在使用 AngularJS 和中继器来迭代一些结果。还有一个过滤器用于搜索。

我希望能够处理两种情况，并且正在寻找最“有角度”的方式。

第一个条件是如果没有结果开始。

第二个条件是如果在使用过滤器时，没有返回结果。

我看到了[这个](https://stackoverflow.com/questions/13845409/angularjs-default-text-for-empty-ng-repeat-on-javascript-object)，这似乎就足够了，我可以为每个条件创建一个。但是，无论如何，是否有本机角度指令来处理这些条件，而不需要控制器中的代码？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-14T03:35:34.370

您可以在过滤后的数组上添加 ngSwitch 指令，并根据其长度显示不同的 HTML。

[js小提琴](http://jsfiddle.net/zGPew/1/)。

HTML：

```
<div ng-app ng-controller="Ctrl">
Search: <input ng-model="searchText">
<div ng-init="filtered = (friends | filter:searchText)">
    <div>{{(friends | filter:searchText).length}}</div>
    <div ng-switch="(friends | filter:searchText).length">
        <span ng-switch-when="0">Nothing was found</span>
        <table id="searchTextResults" ng-switch-default>
            <tr>
                <th>Name</th>
                <th>Phone</th>
            </tr>
            <tr ng-repeat="friend in filtered | filter:searchText">
                <td>{{friend.name}}</td>
                <td>{{friend.phone}}</td>
            </tr>
        </table>
    </div>
</div> 
```

JS：

```
function Ctrl($scope) {
$scope.searchText = "";
$scope.friends = [{
    name: 'John',
    phone: '555-1276'
}, {
    name: 'Mary',
    phone: '800-BIG-MARY'
}, {
    name: 'Mike',
    phone: '555-4321'
}, {
    name: 'Adam',
    phone: '555-5678'
}, {
    name: 'Julie',
    phone: '555-8765'
}];
} 
```

另一种选择是直接在控制器中对朋友数组应用 $filter("filter")，这将缩短 HTML 标记。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-10T07:56:55.030

您可以使用此语法在未找到数据时显示消息

```
<p ng-show="(friends | filter:searchText).length==0">Sorry No Result Found</p>` 
```

Friends 是 JSON 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-15T14:59:31.773

[ngRepeat](https://docs.angularjs.org/api/ng/directive/ngRepeat)允许您在处理完所有过滤器后为结果项目提供别名。然后，您可以使用此别名来显示您的消息。

```
<p ng-repeat="friend in friends | filter:searchText as displayedFriends">
    {{friend.name}}
</p>
<p ng-if="!displayedFriends.length">
    Nothing was found
</p> 
```

# ruby - Ruby Sinatra 验证向视图返回错误

> ID：15994668
> 
> 赞同：3
> 
> 时间：2013-04-14T01:09:20.017
> 
> 标签：ruby, sinatra

Rails dev 是 sinatra 的新手……我正在尝试做一些简单的验证。当我尝试：

```
validates_presence_of :email, message: "Email cannot be blank."

   @emails.errors.each do |e|
      puts e
    end 
```

辛纳屈回归

**[:errorI"^Rack::Lint::LintError: Body 产生非字符串值 [:email, ["Email 不能为空。"]**

如何从该数组中提取错误消息，以及我应用于此表的任何进一步验证。

我已经尝试过`puts e.first`和其他一些选择，但我无处可去。我应该这样做吗？

提前致谢！

```
# app.rb
require "sinatra"
require "Clipboard"
require "sinatra/activerecord"
require 'pony'

#basic auth
use Rack::Auth::Basic, "Enter Demo password." do |username, password|
  [username, password] == ['censor', 'censor']
end

#options
set :port, 3000

# configure :development do
  set :database, "sqlite3:///exceptDev.db"
# end

#end options

######################
####    MODELS      #
######################

class Emails < ActiveRecord::Base
  #validate fields  
  validates_presence_of :email, message: "Email cannot be blank."
end

######################
####    ROUTES       #
######################

get '/' do
  erb :index
end

get '/contact' do
  #create email record
  @fullname = params[:name].split
  @emails = Emails.create(first_name: @fullname.first, 
                          email: params[:email], 
                          last_name: @fullname.last,
                          msg: params[:msg],
                          postcards: params[:postcards],
                          stickers: params[:stickers]
                          )

  if @emails.save 
    redirect "/", notice: "HYFR!"
  else
    redirect "", errors: "wsdfasdf"
    # @emails.errors.each do |e|
    #   puts e
    # end #errors block
  end #if save
end #contact action 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T01:34:42.030

从[文档中](http://www.sinatrarb.com/intro#Return%20Values)：

> 路由块的返回值至少决定了传递给 HTTP 客户端的响应主体，或者至少决定了 Rack 堆栈中的下一个中间件。最常见的是，这是一个字符串

您正在尝试传递数组而不是字符串。返回类型是（再次，在文档中列出）

*   一个包含三个元素的数组：[status (Fixnum), headers (Hash), response body (responds to #each)]
*   一个包含两个元素的数组：[status (Fixnum), response body (responds to #each)]
*   响应 #each 并且只将字符串传递给给定块的对象
*   表示状态代码的 Fixnum

如果您发布了您编写的代码，那么向您展示要做什么会更容易，但这基本上就是正在发生的事情。

* * *

从附加代码：

在路线的最后，尝试这样的事情：

```
get '/contact' do
  # other code, then… 
```

~~如果@emails.errors~~

```
 unless @emails.errors?
    haml :show_a_nice_view_to_the_user
  else
    output = @emails.errors.join("; ")
    # log problems… 
```

~~停止 500，输出~~

```
 haml :error_template
  end
end

# in the error_template (or the show_a_nice_view_to_the_user
# it's up to you if you show a special page or not)
- @errors.full_messages.each do |error|
  %p= error 
```

# ruby-on-rails - 自定义域证书错误 • 服务器的证书 (heroku) 与 URL www.app.com 不匹配

> ID：15994671
> 
> 赞同：2
> 
> 时间：2013-04-14T01:09:52.530
> 
> 标签：ruby-on-rails, security, heroku, dns, certificate

我使用heroku制作了一个网络应用程序，并按照此处的说明设置了自定义域：[https ://devcenter.heroku.com/articles/custom-domains](https://devcenter.heroku.com/articles/custom-domains)

现在在 chrome 中，我的 Https 被划掉了，上面写着：

```
The identity of this website has not been verified 
• Server's certificate does not match the URL.

You attempted to reach www.app.com, but instead you actually reached a server
identifying itself as *.herokuapp.com. This may be caused by a misconfiguration
on the server. Cannot verify that that is the same site as www.app.com 
```

我不认为我错过了一步。我是否必须使用 heroku 证书续订证书？还是自己签名？或者是什么？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T01:39:03.680

如果您也想在您的自定义域上使用 SSL，您还必须遵循[SSL 指南](https://devcenter.heroku.com/articles/ssl#customdomain-ssl)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T02:24:42.483

ssl 证书适用于特定域。m.yourdomain.com 不会接受来自 yourdomain.com 的证书。

听起来像你的问题。你可以得到一个通配符证书，所以 *yourdomain.com，虽然，这些都是昂贵的！

# c++ - GNUPlot 的 MPI IO 格式化

> ID：15994675
> 
> 赞同：1
> 
> 时间：2013-04-14T01:10:29.910
> 
> 标签：c++, mpi, gnuplot, mpi-io

我有一个使用 MPI 的 C++ 程序，我希望每个进程（最多 32 个）写入文件。我正在使用一个小型测试数据集，该数据集由 100 个双打组成，均匀分布在各个流程中。到目前为止，输出的格式如下：

```
 data_sink.Write(&d_p[i], 1, MPI::DOUBLE);
  data_sink.Write(&space, 1, MPI::CHAR);
  data_sink.Write(&r_p[j], 1, MPI::DOUBLE);
  data_sink.Write(&new_line, 1, MPI::CHAR); 
```

格式化此输出以便 GNUPlot 可以直接解释结果的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T01:37:05.557

我假设这里`data_sink`是一个`MPI::File`. 足够的代码能够重现您的输出会很有帮助。

首先要知道的是 MPI-IO 例程以二进制输出；在每个值之后输出空格和换行符不会改变这一点。但要知道的另一件事是[gnuplot 可以很好地读取二进制文件](http://gnuplot.sourceforge.net/docs_4.2/node103.html)。所以这里有一个小的 MPI-IO 代码，它输出一个正弦波，每个进程获得整个域的 20 个点：

```
#include <mpi.h>
#include <cmath>

int main(int argc, char **argv) {

    int rank, size;
    const int nperrank = 20;
    double *data = new double[2*nperrank];

    MPI_Init(&argc,&argv);
    MPI_Comm_size(MPI_COMM_WORLD,&size);
    MPI_Comm_rank(MPI_COMM_WORLD,&rank);

    int totnpts = nperrank * size;
    double dx = (2.*3.14159/totnpts);
    double left = rank * nperrank * dx;

    for (int i=0; i<nperrank; i++) {
        double x = left + dx*i;
        double sinx = sin(x);

        data[2*i] = x;
        data[2*i+1] = sinx;
    }

    MPI_File file;
    MPI_File_open(MPI_COMM_WORLD, "out.dat", MPI_MODE_WRONLY |  MPI_MODE_CREATE,
                    MPI_INFO_NULL, &file);

    MPI_Status status;
    MPI_File_write_at_all(file, 2*rank*nperrank*sizeof(double),
                            data, 2*nperrank, MPI_DOUBLE, &status);

    MPI_File_close(&file);

    MPI_Finalize();
    return 0;
} 
```

这是运行它并绘制的输出：

```
$ mpicxx -o io io.cc
$ mpirun -np 4 ./io
$ gnuplot

    G N U P L O T
    Version 4.2 patchlevel 6
    [...]

Terminal type set to 'x11'
gnuplot> plot 'out.dat' binary format="%lf%lf" using 1:2 with linespoints
gnuplot> 
```

![在此处输入图像描述](https://i.stack.imgur.com/PLQXX.png)

# sql - 在 sql 中，多次使用子查询的最佳语法

> ID：15994677
> 
> 赞同：2
> 
> 时间：2013-04-14T01:10:57.490
> 
> 标签：sql, postgresql, subquery

从表

```
create table seeplai.item(
  itm_id  serial  primary key,
  itp_id  int     not null references seeplai.item_type,
  itm_sq  int2    not null default 10,
  ... )
create index item_itp_sq on seeplai.item( itp_id, itm_sq ); 
```

以`item`记录为基础，我希望找到`itp_sq`具有相同 `itp_id`和`itm_sq`更少的最伟大的。现在使用两个子查询，在语法和逻辑上都是正确的，但是感觉不对。

```
select  max(itm_sq)
into    v_prev_sq
from    seeplai.item itm
where   itm.itp_id = (select itp_id from seeplai.item where itm_id=p_itm_id)
and     itm.itm_sq < (select itm_sq from seeplai.item where itm_id=p_itm_id); 
```

我*知道*我使用了更好的方法，但它的语法已经融入了我的脑海

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:26:26.660

要获得比*您*所在`itm_sq`行中的那个更小的一个：

```
SELECT  i2.itm_sq
FROM    seeplai.item i
JOIN    seeplai.item i2 USING (itp_id)
WHERE   i.itm_id = p_itm_id
AND     i2.itm_sq < i.itm_sq 
ORDER   BY i2.itm_sq DESC
LIMIT   1; 
```

要打破关系（具有相同的多行`itm_sq`），您可以`ORDER BY`添加列。

这样您就不必重复使用任何东西。如果必须，可以使用子查询或[CTE](http://www.postgresql.org/docs/current/interactive/queries-with.html)工具。

* * *

如果您需要前一个共享相同的每个项目`itm_sq`的*窗口*`itp_id`功能[**`lag()`**](http://www.postgresql.org/docs/current/interactive/functions-window.html)（或`lead()`相反的顺序）将是有帮助的：

```
SELECT  i2.*, lag(i2.itm_sq) OVER (ORDER BY i2.itm_sq) AS previous_itm_sq
FROM    seeplai.item i
JOIN    seeplai.item i2 USING (itp_id)
WHERE   i.itm_id = p_itm_id
ORDER   BY i2.itm_sq DESC; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:24:37.023

您需要将表连接到自身：

```
select max(itm_sq)
into v_prev_sq
from seeplai.item itm
join seeplai.item itm2 on itm.itm_tp = itm2.itm_tp and itm2.itm_id=p_itm_id
join seeplai.item itm3 on itm.itm_sq < itm3.itm_sq and itm3.itm_id=p_itm_id 
```

这是您查询的“直接翻译”，但我认为这种简化也可以：

```
select max(itm_sq)
into v_prev_sq
from seeplai.item itm
join seeplai.item itm2
    on itm.itm_tp = itm2.itm_tp 
    and itm2.itm_id = p_itm_id
    and itm.itm_sq < itm2.itm_sq 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T01:24:06.680

也许您正在寻找公用表表达式？[http://www.postgresql.org/docs/9.2/static/queries-with.html](http://www.postgresql.org/docs/9.2/static/queries-with.html)

虽然我认为实际上使用连接更容易做到这一点......

```
select  max(itm_0.itm_sq)
into    v_prev_sq
from    seeplai.item itm_0,
join itm_1
on itm_0.itm_tp = itm_1.itm_tp
and itm_0.itm_sq < itm_1.itm_sq
and itm_0.itm_id = itm_1.p_itm_id
group by itm_1.p_itm_id 
```

`DISTINCT ON`如果需要，可能使用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T01:23:21.393

我不确定，但也许你可以使用 PostgreSQL 的[WITH Queries (Common Table Expressions)](http://www.postgresql.org/docs/9.1/static/queries-with.html)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-14T01:14:52.823

只需将子查询的值存储在变量中：

```
declare @retVal varchar(20);
set @retVal = select itm_tp from seeplai.item where itm_id=p_itm_id

select  max(itm_sq)
into    v_prev_sq
from    seeplai.item itm
where   itm.itm_tp = @retVal
and     itm.itm_sq < @retVal; 
```

# webgl - WebGL 交互式

> ID：15994678
> 
> 赞同：0
> 
> 时间：2013-04-14T01:11:05.177
> 
> 标签：webgl

有什么方法可以单击 WebGL 动画的一个非常特定的位置并在它之外产生任何响应，例如将值发送到数据库。

这似乎是一个非常简单的问题，但 WebGL 似乎真的很强大，但相对较新的东西不太为人所知，任何问题的答案都很难找到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T12:41:20.173

HTML5 元素 CANVAS 像任何其他 HTML 元素一样产生具有精确鼠标位置的 onclick / onmousewheel / ... 事件。

您可以在 CANVAS 上保存有关场景对象位置的一些信息。经常使用带有第二帧缓冲区和着色对象的技术。

在 Packt Publishing, Chapter 8: Picking 一书中有很好的例子。

# java - 在 JPanel 中将多个 JLabel 居中

> ID：15994679
> 
> 赞同：0
> 
> 时间：2013-04-14T01:11:06.333
> 
> 标签：java, swing, jlabel, layout-manager, centering

我有一个显示多个 JLables 的 JPanel，每个 JLables 代表一个二进制字符串的一个字符。（他们都是独立的，因为每个人都必须有一个 MouseListener，但这不是我的问题的一部分）

我的问题是我似乎无法将 JLables 居中。

我努力了

```
this.setLayout(new BoxLayout(this, BoxLayout.X_AXIS));
add(label1);   //= left aligned
label1.setAlignmentX(Component.CENTER_ALIGNMENT);  //= still left aligned 
```

和

```
this.setLayout(new BorderLayout());
add(label1, BorderLayout.CENTER);  //= only 1 showed up 
```

我也将其保留为默认 FlowLayout，但由于某种原因，这忽略了 jLabels 的大小和间距，因此它们并不都适合它们应该放置的行。我还尝试将 FlowLayout 放在 Boxlayout 中。仍然没有工作。

请注意，在我上面的例子中，我有多个标签（我实际上有 31 个！！）

我应该如何让它工作？

编辑：更新了我复制错误代码的地方。label1.setAlignmentX(Component.CENTER_ALIGNMENT)

编辑： jLabels 需要在水平行中，而不是列中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:26:38.357

`BoxLayout`需要沿着`Y_AXIS`任何中心对齐的布局才能工作。在 的情况下`BorderLayout`，虽然可以水平放置 3 个组件（`WEST`、`CENTER`、`EAST`），但它们分布不均。类似地，`FlowLayout`虽然允许组件居中对齐，但不会均匀分布它们。

最简单的方法是使用`GridLayout`：

```
setLayout(new GridLayout());
label1.setHorizontalAlignment(JLabel.CENTER); 
```

# php - 避免重复投票

> ID：15994686
> 
> 赞同：0
> 
> 时间：2013-04-14T01:12:18.467
> 
> 标签：php, mysql, sql

我是 PHP/MySQL 和整个网站设计的新手。我正在建立一个预定义用户可以投票的网站。我有一个包含用户列表的数据库。我试图避免重复投票。我读到您可以阻止 IP 地址或使用 cookie，但我正在尝试使用另一种方法。

在我的名为“用户”的数据库中，我有三列 - 用户名、密码和标志。Flag 的默认值为 0。一旦用户投票，我将该特定用户的 flag 设置为 1。现在，如果用户再次尝试投票，我想检查数据库中 flag 的值。如果为 0，我会将他发送到“感谢您投票”页面并更新我创建的另一个名为 results 的数据库，该数据库跟踪每个候选人收到的票数。如果没有，我将他带到另一个页面，上面写着“你已经投票了”。到目前为止一切正常，除了我不知道如何读取数据库中标志的值并使用它的 if 条件。

这是我到目前为止所拥有的：

```
<?php

$host="localhost"; // Host name 
$username="dbxxxxx"; // Mysql username 
$password="password"; // Mysql password 
$db_name="dbxxxxx_users"; // Database name 
$tbl_name="users"; // Table name 

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

$user = $_COOKIE["details"];  //cookie details has the username the user used to log in

$SQL = "SELECT flag FROM users WHERE Username='$user'";
$flag = mysql_query( $SQL );   //no clue what's happening here. Just trying random stuff
$db_field = mysql_fetch_assoc($flag);  

if($db_field==0)     //checking the value of flag in the database
{       
    mysql_query("UPDATE result SET Votes=Votes+1 //if flag in database = 0 
    WHERE Name='Candidate1'");  //updates result for candidate1 if the user voted for 1

    $user = $_COOKIE["details"];  //reading the cookie again. can be omitted.

    mysql_query("UPDATE users SET flag=1   //changing flag to 1 so user cannot vote again
    WHERE Username='$user'");

    header("location: http://www.lithuaniavote.com/thankyou.html");
 }

else    //flag != 1 or user has already voted
{
    header("location: http://www.lithuaniavote.com/alreadyvoted.html");
}

?> 
```

PS：此代码将数据库中的标志从0更改为1。但是，if 条件有问题。即使标志为 1，我也可以投票，这表明我已经投票，或者换句话说，它永远不会带我进入已投票页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T17:27:23.633

我认为您应该尝试一种更清洁（且面向未来）的方法。让我用 PDO 重新构建您的问题的解决方案：

```
namespace Voting {
    $pdo = new \PDO("mysql:host={$host};dbname={$db_name};charset=utf8", $username, $password);

    if ($query1 = $pdo->prepare("SELECT `flag` FROM `users` WHERE `Username` = ?;", [\PDO::ATTR_CURSOR => \PDO::CURSOR_FWDONLY])) {
        if ($query1->execute([$_COOKIE["details"]])) {
            $result = $query1->fetch(\PDO::FETCH_ASSOC);

            if (intval($result["flag"]) === 0) {
                if ($query2 = $pdo->prepare("UPDATE `users` SET `flag` = '1' WHERE `Username` = ?")) {
                    $query2->execute([$_COOKIE["details"]]);
                    $pdo = null;
                    header("Location: http://www.lithuaniavote.com/thankyou.html");
                }
            } else {
                $pdo = null;
                header("Location: http://www.lithuaniavote.com/alreadyvoted.html");
            }
        }
    }
} 
```

**警告**：考虑到我没有检查`$_COOKIE`安全性。您必须进行某种形式的清理以防止注入和其他漏洞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T04:08:57.243

原始代码：

```
$SQL = "SELECT flag FROM users WHERE Username=$user";
$flag = mysql_query( $SQL );   //no clue what's happening here. Just trying random stuff
$db_field = mysql_fetch_assoc($flag);  
if($db_field==0)     //checking the value of flag in the database 
```

尝试这个：

```
$SQL = "SELECT flag FROM users WHERE Username = '$user'"; // $user should be in 'quotes'
$flag = mysql_query( $SQL );  // This is the actual query to the database
$db_field = mysql_result($flag, 0);  // This is the result of the query.
if($db_field===0)  // Use 3 equals signs instead of 2 in this case (which means "exactly equal to") 
```

# java - 将按钮添加到 LinearLayout 不起作用

> ID：15994687
> 
> 赞同：0
> 
> 时间：2013-04-14T01:12:20.250
> 
> 标签：java, android

我正在尝试以编程方式将按钮添加到 LinearLayout，但应用程序崩溃：

活动主.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity"
    android:id="@+id/main_view" >

    <Button
        android:id="@+id/button1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignRight="@+id/textView1"
        android:layout_below="@+id/textView1"
        android:text="Button"
        android:onClick="onClickBtn" />

</LinearLayout> 
```

这是代码：

```
package com.chovanec.runo;

import android.os.Bundle; // and more

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);  
        return true;
    }

    public void onClickBtn(View v)
    {
        Button btn = new Button(getBaseContext());
        btn.setText("New Button");

        LinearLayout l = (LinearLayout) findViewById(R.layout.activity_main);
        l.addView(btn);

    }

} 
```

日志猫：

```
04-14 03:09:00.150: D/AndroidRuntime(7375): Shutting down VM
04-14 03:09:00.150: W/dalvikvm(7375): threadid=1: thread exiting with uncaught exception (group=0x415102a0)
04-14 03:09:00.155: E/AndroidRuntime(7375): FATAL EXCEPTION: main
04-14 03:09:00.155: E/AndroidRuntime(7375): java.lang.IllegalStateException: Could not execute method of the activity
04-14 03:09:00.155: E/AndroidRuntime(7375):     at android.view.View$1.onClick(View.java:3691)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at android.view.View.performClick(View.java:4211)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at android.view.View$PerformClick.run(View.java:17267)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at android.os.Handler.handleCallback(Handler.java:615)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at android.os.Looper.loop(Looper.java:137)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at android.app.ActivityThread.main(ActivityThread.java:4898)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at java.lang.reflect.Method.invokeNative(Native Method)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at java.lang.reflect.Method.invoke(Method.java:511)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at dalvik.system.NativeStart.main(Native Method)
04-14 03:09:00.155: E/AndroidRuntime(7375): Caused by: java.lang.reflect.InvocationTargetException
04-14 03:09:00.155: E/AndroidRuntime(7375):     at java.lang.reflect.Method.invokeNative(Native Method)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at java.lang.reflect.Method.invoke(Method.java:511)
04-14 03:09:00.155: E/AndroidRuntime(7375):     at android.view.View$1.onClick(View.java:3686)
04-14 03:09:00.155: E/AndroidRuntime(7375):     ... 11 more
04-14 03:09:00.155: E/AndroidRuntime(7375): Caused by: java.lang.NullPointerException
04-14 03:09:00.155: E/AndroidRuntime(7375):     at com.chovanec.runo.MainActivity.onClickBtn(MainActivity.java:37)
04-14 03:09:00.155: E/AndroidRuntime(7375):     ... 14 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:18:16.893

应该 `LinearLayout l = (LinearLayout) findViewById(R.id.main_view);`

您也错过`android:orientation="vertical"`了线性布局，这就是新按钮没有出现的原因。除非您希望按钮并排显示，否则您必须在按钮 xml中更改`android:layout_width="fill_parent"`为`android:layout_width="wrap_content"`

你不能使用

```
android:layout_alignRight="@+id/textView1"
android:layout_below="@+id/textView1" 
```

除非是相对布局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:15:27.727

尝试使用：

```
 Button btn = new Button(this); 
```

代替：

```
 Button btn = new Button(getBaseContext()); 
```

**更新：**

并尝试将按钮添加到内部`LinearLayout`：

```
 LinearLayout l = (LinearLayout) findViewById(R.id.main_view); 
```

代替：

```
 LinearLayout l = (LinearLayout) findViewById(R.layout.activity_main); 
```

我认为您不能直接将按钮添加到活动布局中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T01:20:43.650

你`LinearLayout l`实际上是**null**。

改变这个：

```
LinearLayout l = (LinearLayout) findViewById(R.layout.activity_main); 
```

对此：

```
LinearLayout l = (LinearLayout) findViewById(R.id.main_view); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T01:29:15.687

问题就在这里

```
LinearLayout l = (LinearLayout) findViewById(R.layout.activity_main);
l.addView(btn); 
```

findViewById 期望视图元素的 id 你给它布局 id。

尝试这个

```
LinearLayout l = (LinearLayout) findViewById(android.R.id.content); 
```

或者

```
LinearLayout l = (LinearLayout) findViewById(android.R.id.content).getRootView() 
```

# c# - 这是 IDisposable 的正确用法吗？

> ID：15994689
> 
> 赞同：2
> 
> 时间：2013-04-14T01:12:37.683
> 
> 标签：c#, idisposable

我有一个 FTP 类，它有一个`Dipose()`方法

```
public class Ftp : IFtp
    {
        //other methods, properties and fields

        public void Dispose()
        {
            if (_ftp.IsConnected)
                _ftp.Close();

            _ftp.Dispose();
            _ftp = null;
        }
    } 
```

这是我用来访问`Ftp`类的接口

```
public interface IFtp : IDisposable
    {
        //other methods signatures
        void Dispose();
    } 
```

这是处理所使用的内容的适当且实用的方式`Ftp`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T01:19:40.400

这适用于该类的常规使用。但是，您应该`_ftp`在开始访问它之前检查引用是否为空。通常的做法是您应该能够`Dispose`多次调用该方法而不会造成任何伤害。

您可能还想在类中添加一个终结器，您可以在其中处理它，以防使用该类的人由于某种原因无法正确处理它。

[`IDisposable`接口](http://msdn.microsoft.com/en-us/library/System.IDisposable.aspx)文档中的编码示例非常完整并且注释很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T01:19:58.897

我认为 _ftp 是一个 IDisposable 对象。如果是这样，那么执行以下操作就足够了：

```
public class Ftp : IFtp
{
    //other methods, properties and fields

    public void Dispose()
    {
        _ftp.Dispose();    
    }
} 
```

还

```
public interface IFtp : IDisposable
{
    //other methods signatures    
} 
```

`Dispose()`也就是说，如果你的接口继承自，你不需要重新指定方法（在你的接口中） `IDisposable`，因为它已经在`IDisposable`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-14T01:16:24.867

[接口](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)一般参考[MSDN 文档。`IDisposable`](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)

[MSDN`IDisposable.Dispose()`文档](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx)特别指出：

> 实现此方法时，请确保通过在包含层次结构中传播调用来释放所有持有的资源。例如，如果一个对象 A 分配了一个对象 B，而对象 B 分配了一个对象 C，那么 A 的 Dispose 实现必须调用 B 上的 Dispose，而 B 又必须调用 C 上的 Dispose。一个对象还必须调用其基类的 Dispose 方法如果基类实现 IDisposable，则为类。

...这就是你在做什么。

有关您的设计警告的详细信息，请参阅[MSDN CA1063：正确实现 IDisposable](http://msdn.microsoft.com/en-AU/library/ms244737.aspx)。

假设您的底层 FTP 实现不受管理，您还*应该*包括一个终结器（如果基础实现中还没有终结器）。[MSDN`IDisposable.Dispose()`文档](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx)特别指出：

> 因为必须显式调用 Dispose 方法，所以实现 IDisposable 的对象还必须实现终结器以在未调用 Dispose 时处理释放资源。

另请参阅[MSDN`Object.Finalize`](http://msdn.microsoft.com/en-us/library/system.object.finalize.aspx)和[MSDN 实施 Finalize 和 Dispose 以清理非托管资源](http://msdn.microsoft.com/en-us/library/b1yfkh5e.aspx)

如果您的继承链中某处没有适当的终结器，也许这就是您发出警告的原因？

另请注意（作为反例）Microsoft 建议*消费者*不要`Dispose()`直接致电。 [MSDN`using`声明文档](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)指出：

> 通常，当您使用 IDisposable 对象时，您应该在 using 语句中声明和实例化它。

*消费者*的首选方法是“使用”`IDisposable`资源，如下所示：

```
 using (FTP myDisposableFTP = new FTP()) {
     ...
   } 
```

这基本上是“语法糖”，以确保`Dispose()`在您完成使用一次性资源（即块的末尾）时调用该方法，或者重要的是，如果块*内*发生`using`异常。*`using`*

 *此模式还避免了`null`检查实例引用的要求，因为实例是在块的开头构造的。它还确保无法重新分配对象（保护底层资源不被意外打开，即使您的原始引用超出范围）。

但是我认为您能否将这种模式（或等效的 try/catch/finally）合并到您的继承/接口实现中是值得怀疑的。

所以是的，调用该`Dispose()`方法在功能上是可以的，只要你记得在所有需要它的情况下调用它（例如在你的异常处理中），或者你将它重新暴露给你的消费者以正确处理“包装”`IDisposable`实现的一部分。但是，如果您的资源是非托管的，您还应该添加一个终结器。*

# java - 跟踪 Java Web 应用程序中的并发文件处理

> ID：15994690
> 
> 赞同：0
> 
> 时间：2013-04-14T01:12:39.950
> 
> 标签：java, multithreading, web-applications, concurrency, executorservice

我有一个 Java 1.5 Web 应用程序，可以将任意 PDF 文件转换为图像。一次处理一个 PDF 的所有页面都需要很长时间，所以我想按需处理页面。

我已经[读到，`ExecutorService`](https://stackoverflow.com/a/4908012/687315)当特定页面的 HTTP 请求到达时，我可以使用 an 在新线程中启动/排队图像生成操作。我如何确保我不会排队重复操作（例如，两个用户从同一个 PDF 请求同一个页面）而不求助于单线程执行器？如何使用同步列表之类的东西来跟踪工作线程正在处理的图像（或者，什么类型的同步机制可以帮助我跟踪）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:20:22.253

您可以使用[ConcurrentSkipListSet](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentSkipListSet.html)或[ConcurrentHashMap](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)来跟踪哪些 PDF 已被处理（并且可能已被缓存）或当前正在被处理。使用[ConcurrentLinkedQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)处理您的 PDF 到图像请求；当工作线程从队列中拉出一个请求时，它会将其添加到 Set/Map 中，如果添加成功则线程处理该请求，如果添加失败则该请求已经在容器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T09:31:38.343

您可以使用`ConcurrentHashMap<String, Future<String>>`带有 PDF 标识符（例如文件路径等）的 a 作为键，并将表示转换操作本身的任务作为值。

的`putIfAbsent`方法`ConcurrentHashMap`可以处理*比较和设置*操作的问题，而可以指示转换是否完成的`isDone`方法。`Future`

`putIfAbsent`返回时`null`，表示给定 PDF 的转换任务尚不存在，因此您需要调用`ExecutorService.submit(Callable<T> task)`来启动新创建的转换任务；否则你省略这一步并等待已经存在的任务完成。

小样：

```
Future<String> conversionTask = ... // blah
Future<String> existingTask = conversions.putIfAbsent(pdfId, conversionTask);
if (existingTask != null) {
    conversionTask = existingTask;
}
// Either way, conversion is scheduled by now. 
```

负责将`ExecutorService`您的转换请求排队。

`Future<V>.get()`转换完成后，您可以通过方法检索结果。

*请注意，规范不允许在 Java EE 应用程序中生成线程。*一种常见的方法是将您的异步处理分离为 JMS 服务 - [Apache Camel](http://camel.apache.org/)可以在这方面为您提供帮助。

# c# - 使用保存多个富文本框

> ID：15994700
> 
> 赞同：1
> 
> 时间：2013-04-14T01:14:11.923
> 
> 标签：c#

我一直在尝试新的东西，基本上我偶然发现了这个： http: [//www.homeandlearn.co.uk/csharp/csharp_s4p11.html](http://www.homeandlearn.co.uk/csharp/csharp_s4p11.html)

我的表单有一个另存为选项以及多个选项卡。我想将所有的富文本框保存到文本文件中。但是当我添加多个richtextbox时，它只会保存底部的一个，所以我猜公式是错误的？

```
private void saveToolStripMenuItem_Click(object sender, EventArgs e)
{
    string Saved_File = "";

    saveFD.InitialDirectory = "C:";
    saveFD.Title = "Save your file as...";
    saveFD.FileName = "";
    saveFD.Filter = "Text (*.txt)|*.txt|All Files(*.*)|*.*";
    if (saveFD.ShowDialog() != DialogResult.Cancel)
    {
        Saved_File = saveFD.FileName;
        richTextBox1.SaveFile(Saved_File, RichTextBoxStreamType.PlainText);
        richTextBox2.SaveFile(Saved_File, RichTextBoxStreamType.PlainText);
        richTextBox3.SaveFile(Saved_File, RichTextBoxStreamType.PlainText);
        richTextBox53.SaveFile(Saved_File, RichTextBoxStreamType.PlainText);
    }
} 
```

在上面的例子中它只会保存richTextBox53，为什么不保存上面所有的richTextBoxes？以及如何将它们全部保存到文本文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:36:21.157

正如我在评论中所说，覆盖是 saveFile 函数中流的默认行为，
因此您需要指定文件模式。

```
System.IO.FileStream fs = 
                    new System.IO.FileStream(Saved_File,
                        System.IO.FileMode.OpenOrCreate,System.IO.FileAccess.ReadWrite);
    richTextBox1.SaveFile(fs, Saved_File);
        richTextBox2.SaveFile(fs, Saved_File);
        richTextBox3.SaveFile(fs, Saved_File);
        richTextBox53.SaveFile(fs, Saved_File);
fs.Close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T02:37:21.120

```
using (StreamWriter writer = File.AppendText(saveFD.FileName))
{
    richTextBox1.SaveFile(writer , RichTextBoxStreamType.PlainText);
    richTextBox2.SaveFile(writer , RichTextBoxStreamType.PlainText);
    richTextBox3.SaveFile(writer , RichTextBoxStreamType.PlainText);
    richTextBox53.SaveFile(writer , RichTextBoxStreamType.PlainText);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T01:40:57.233

试试这个

```
 string Saved_File = "";

        saveFD.InitialDirectory = "C:";
        saveFD.Title = "Save your file as...";
        saveFD.FileName = "";
        saveFD.Filter = "Text (*.txt)|*.txt|All Files(*.*)|*.*";
        if (saveFD.ShowDialog() != DialogResult.Cancel)
        {
            Saved_File = saveFD.FileName;
            RichTextBox allrtb = new RichTextBox();
            // This one add new lines using the "\n" every time you add a rich text box
            allrtb.AppendText(richTextBox1.Text + "\n" + richTextBox2.Text + "\n" + richTextBox3.Text+ "\n" + richTextBox53.Text );
            allrtb.SaveFile(Saved_File, RichTextBoxStreamType.PlainText);
        } 
```

现在，如果您想在 Richtextbox 之间留出空格，只需将新行（即 \n）更改为如下所示的空格：

```
allrtb.AppendText(richTextBox1.Text + " " + richTextBox2.Text + " " + richTextBox3.Text+ " " + richTextBox53.Text ); 
```

# android - 导入 Google Play 服务库时出错（无法写入文件）

> ID：15994703
> 
> 赞同：1
> 
> 时间：2013-04-14T01:14:44.493
> 
> 标签：android, android-maps-v2, google-play-services

尝试在 Eclipse 中导入 Google Play Services 库时，出现以下错误

![在此处输入图像描述](https://i.stack.imgur.com/tNheK.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T04:17:44.233

这可能是 Windows 的权限问题。尝试使用“程序文件（x86）”之外的文件路径进行尝试

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T14:14:17.180

将 google-play-services_lib 复制到类似的位置`C:\Development\`并从那里导入。

不要将 google-play-services_lib 放在工作区中。Eclipse 在导入已经在工作区中的项目时似乎有一个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-08T23:21:35.030

首先从 sdk 管理器安装，然后从您的 sdk 文件夹中导入，如下所示：http: [//developer.android.com/google/play-services/setup.html#Install](http://developer.android.com/google/play-services/setup.html#Install)

# c++ - 使用 boost::string_ref 进行字符串迭代的 Int 变小

> ID：15994704
> 
> 赞同：0
> 
> 时间：2013-04-14T01:14:45.627
> 
> 标签：c++, string, performance, boost

我正在写类似标记器的东西。我想`boost::string_ref`用来返回“令牌值”。我想遍历 string_ref 逐字符读取字符，然后返回包含值的子字符串。

让我们看一个非常简约的例子：

```
string test = "testing string";
boost::string_ref rtest(test);

//-------- and now we can go this way --------
auto begin = rtest.begin();
auto end   = rtest.end();
for(/*something*/){
    process_char(*end); // print char
    end ++;
}
// how to return rtest(begin,end)?

// -------- or this way --------
int begin = 0;
int end   = 0;
for(/*something*/){
    process_char(rtest[end]);
    end++;
}
return rtest.substr(begin, end); 
```

在代码中，显示了两种迭代字符串的方法：使用指针和使用 int。指针方式很好，但是没有办法`boost::string_ref.substr`在指针之间返回，第二种方法使用 int 和 int 可以处理一些数字，对于大型输入文件来说可能很小。

那么是否有可能以这种方式对大量输入进行迭代？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:48:18.197

要返回给定两个指针的子字符串，请执行以下操作：

```
return boost::string_ref(begin, end-begin); 
```

只需确保您的参考字符串存在于您要返回的范围内。

# django - Django：三个模型相互关联，最好的方法是什么

> ID：15994705
> 
> 赞同：1
> 
> 时间：2013-04-14T01:14:49.647
> 
> 标签：django, many-to-many, models, relationship, one-to-one

我有一个网上商店。有单品要买，但也有一些套装包含其中一些单品。现在我正在尝试为这些关系找到最佳/有用的解决方案。这就是我到目前为止所拥有的。

楷模：

```
class Wine(models.Model):
    name = models.CharField(max_length=128)

class WineBox(models.Model):
    name = models.CharField(max_length=128)
    wines = models.ManyToManyField(Wine)

class Product(models.Model):
    wine = models.OneToOneField(Wine, blank=True, null=True)
    winebox = models.OneToOneField(WineBox, blank=True, null=True)
    price = models.DecimalField(max_digits=4, decimal_places=2)
    public = models.BooleanField(blank=True) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:29:18.983

`WineBox`两者都是`Product`必要的吗？似乎有点多余。为什么不做一些更简单的事情，比如：

```
class Wine(models.Model):
    name = models.CharField(max_length=128)

class Product(models.Model):
    wine = models.ForeignKey(Wine)
    winebox = models.ManyToManyField(Wine)
    price = models.DecimalField(max_digits=4, decimal_places=2)
    public = models.BooleanField(blank=True) 
```

这看起来仍然是多余的，我宁愿删除该`wine`字段`Product`并留下：

```
class Product(models.Model):
    wines = models.ManyToManyField(Wine)
    price = models.DecimalField(max_digits=4, decimal_places=2)
    public = models.BooleanField(blank=True) 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T09:41:10.003

感谢所有的帮助，但最后我想出了一个非常简单的解决方案，非常适合我的需求。我不想使用泛型关系，因为我可以控制我的所有模型，它们使一切变得复杂，或者 Cartucho 解决方案，因为我以后可能想要更多的产品。我使用 Product 作为基类，现在模型看起来像：

```
class Product(models.Model):
    price = models.DecimalField(max_digits=4, decimal_places=2)
    public = models.BooleanField(blank=True)

class Wine(Product):
    name = models.CharField(max_length=128)

class WineBox(Product):
    name = models.CharField(max_length=128)
    wines = models.ManyToManyField(Wine) 
```

# matlab - Matlab帮助在用户定义的函数中定义参数和返回变量，将数字转换为特定的颜色

> ID：15994709
> 
> 赞同：0
> 
> 时间：2013-04-14T01:15:13.113
> 
> 标签：matlab

我正在尝试使用以下代码正确定义我的参数（temp）并返回变量（color）。此代码生成一个 101 长的颜色数组（1x3 矩阵）列表。换句话说，它创建了一个 101x3 矩阵，每一行都定义了 Jet 颜色图中的一种颜色。

我的问题是它可以工作并创建一个地图，但我无法弄清楚如何正确定义 temp 参数，所以如果我想显示 tempToColor(0) 它将显示第一行 (0 0 .5769)。或 tempToColor(50) 它将显示第 49 行 (.5 1 .5) 上颜色的行索引。

这是我的代码。注意 steamTemp = 100，coolantTemp = 0（常量函数），这可能不是编写这个程序的最佳方式，但我的导师给了我们这种风格作为硬件作业的一部分，我需要尽可能地坚持下去。

```
function [color] = tempToColor(temp)

% This function turns a temperature into
% different colors based on that temp.

persistent map

if isempty(map)

    map = jet(steamTemp-coolantTemp+1);
else

end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:57:15.643

基本矩阵索引：

```
%# colormap matrix: 101-by-3
N = 101;
cmap = jet(N);

%# 66-th row
clr = cmap(66,:) 
```

现在，如果您想将某个范围内的值映射到颜色，您可以应用插值：

```
%# range of values [10,30]
mn = 10; mx = 30;
val = 22.3;

%# normalize value into [0,1] range and map it into a color
f = @(x) interp1(linspace(0,1,N), cmap, (x - mn)./(mx - mn)); 
```

例子：

```
val = linspace(mn,mx,50);
clr = f(val);      %# vectorized call
rgbplot(clr) 
```

# search - 用前序和中序遍历重构二叉搜索树

> ID：15994710
> 
> 赞同：0
> 
> 时间：2013-04-14T01:15:24.900
> 
> 标签：search, tree, binary-search-tree

我正在研究一个重建二叉搜索树的函数。我试着先用手做。

说我有：pre- 10,3,5,4,15,7,8,2,9,20 in- 4,5,3,15,10,20,8,7,9,20

我想不通。我知道 10 必须是根，并且有序序列中 10 左侧的所有数字都需要在右子树中。

那会给我 4,5,3,15

15 大于 10 并且要成为二叉搜索树，左子树中的所有节点都应该小于根。

这是否意味着这两个序列形成了无效的二叉搜索树？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:28:31.173

你是对的。根据您获得的按顺序遍历，您的树似乎不是 BST。10 必须是根节点，正如您从前序遍历中的第一个节点中收集到的那样。有序遍历中 10 左边的所有内容都应该在左子树中，而 10 右边的所有内容都应该在右子树中。正如您所指出的，15 不可能在 10 的左侧（或者 7、8 和 9 不可能在 10 的右侧）。话虽如此，您仍然可以从这些数据中重建一棵树。它只是没有按排序顺序排列的节点。

# vim - vim 关闭 README 和文本文件的自动缩进

> ID：15994715
> 
> 赞同：2
> 
> 时间：2013-04-14T01:16:03.167
> 
> 标签：vim

当我在 vim 中打开一个 README 文件并开始输入时，我注意到每当我按 Enter 键时，它都会自动添加一个缩进。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:16:03.167

将以下代码段放入您的 .vimrc 将关闭具有任何或没有特定扩展名（行中的星号）并且没有任何特定语法集（`&syntax == ''`表达式）的文件的自动文本格式。

```
au BufNewFile,BufRead * if &syntax == '' | set paste | endif 
```

这与在 vim 控制台中执行 :set paste 的效果相同，它关闭了有时会妨碍事情的自动文本格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T06:13:35.527

不，您正在使用手提钻钻针孔。

您想禁用文件`'autoindent'`选项，`README`但是：

*   `*`将匹配*每个*文件（因此您的条件为`&syntax`），
*   `set paste`除了重置之外，还做了很多丑陋的事情`'autoindent'`。

这是一个更好的解决方案：

```
autocmd BufNewFile,BufRead README set noautoindent 
```

它仅适用于`README`文件，*仅适用*于您不喜欢的选项。不够的话还可以玩`'formatoptions'`。基本上，您的解决方案过于宽泛：您必须使其更具体。

# c++ - ISO C++ 禁止声明没有类型的“TwoWayVectorIterator”

> ID：15994717
> 
> 赞同：0
> 
> 时间：2013-04-14T01:16:10.637
> 
> 标签：c++, vector, iterator, declaration

我正在尝试在不使用库和迭代器的情况下在 c++ 中实现一个可以采用正索引和负索引（如在 python 中从后面计算）的向量。我遇到了这个问题：当我`g++ TwoWayVectorIterator.cc`，我得到这个`ISO C++ forbids declaration of ‘TwoWayVectorIterator’ with no type`和`error: expected ‘;’ before ‘&lt;’ token` 。我尝试了很多东西作为在 .h 文件中分离模板，但没有奏效。:( 任何帮助将不胜感激！

在 TwoWayVector.cc 中

```
#ifndef TWOWAYVECTOR_CC
#define TWOWAYVECTOR_CC

#include"TwoWayVectorIterator.cc"
#include <iostream>
#include <cmath>
using namespace std;

template <typename T> class TwoWayVector 
{
private:
    T* data;
    int capacity;
    int nextFree;
public:
    TwoWayVector();
    ~TwoWayVector();
    int size();
    void push_back(T);
    T pop_back();
    void checkIndex(int index);
    T& operator[] (int index);
    TwoWayVectorIterator<T> begin();
    TwoWayVectorIterator<T> end();
    //TwoWayVectorConstIterator<T> const_begin();
    //TwoWayVectorConstIterator<T> const_end(); 

};

template<typename T> TwoWayVector<T>::TwoWayVector(){ //construct function
    data = new T[10] ;   // initial memory storage
    capacity=10;
    nextFree=0;
}

template<typename T> 
TwoWayVector<T> ::~TwoWayVector(){
    delete []data;
    //delete capacity;
    //delete nextFree;
}

template<typename T>
int TwoWayVector<T> ::size(){
    return nextFree;
}

template<typename T> void TwoWayVector<T> ::push_back(T element){
    if(this->size() == this->capacity){
        T* data2 = new T[2 * this->capacity];
        int capacity2 = 2*this->capacity;
        int nextFree2 =0;
        int i;
        for (i=0; i<this->capacity; i++) {
            data2[i] = this->data[i];
        }
        data2[this->nextFree] = element;
        nextFree2 =this->nextFree+1;
        T * temp = this->data;
        delete []temp;  //  release original memory
        this->data = data2;
        this->capacity = capacity2;
        this->nextFree = nextFree2;

    }else{
        this->data[this->nextFree] = element;
        nextFree++;
    }
}

template<typename T> T TwoWayVector<T> ::pop_back(){
    if(this->size()>0){
        T popped =  this->data[(this->nextFree)-1];
        this->data[(this->nextFree)-1] = 0;
        this->nextFree --;  
        return popped;
    }else{
        return 0;
    }
}

template<typename T> void TwoWayVector<T> ::checkIndex(int index) {

    if((index>0 && (index+1)>this->size())||(index<0 && abs(index)> this->size()))
    {
        throw index;
    }
}

template<typename T> T& TwoWayVector<T> :: operator[] (int index){
    try{
    checkIndex(index);
    }
    catch (int)
    {
        cerr <<"error: the index " <<index<<" is not in the valid range." << endl;
        exit(1);
    }
    if(index>=0)
        return data[index];
    else
        return data[nextFree + index];  
}

template<typename T> TwoWayVectorIterator<T> TwoWayVector<T> ::begin(){
    TwoWayVectorIterator *a = new TwoWayVectorIterator<T>(&this, 0);
    return *a;
}

template<typename T> TwoWayVectorIterator<T> TwoWayVector<T> ::end(){
    TwoWayVectorIterator *a = new TwoWayVectorIterator<T>(&this, this.size());
    return *a;
}

#endif 
```

然后在 TwowayVectorIterator.cc

```
/*
*  TwoWayVectorIterator.cc
*  assig4
*
*  Created by yunjing tian on 13-04-09.
*
*/
#ifndef TWOWAYVECTORITERATOR_CC
#define TWOWAYVECTORITERATOR_CC

#include"TwoWayVector.cc"
using namespace std;

template <typename T> class TwoWayVectorIterator 
{
private:
    TwoWayVector<T> * vector;
    int currentPosition;
public:

    TwoWayVectorIterator(TwoWayVector<T> &a, int initialPosition);
    bool operator== (TwoWayVectorIterator b);
    bool operator!= (TwoWayVectorIterator b);
    TwoWayVectorIterator<T> & operator++();
    TwoWayVectorIterator<T> & operator++(TwoWayVectorIterator a);
    TwoWayVectorIterator<T> & operator=(TwoWayVectorIterator a);
    TwoWayVectorIterator<T> & operator+(int i);
    TwoWayVectorIterator<T> & operator-(int i);
    bool operator<(TwoWayVectorIterator b);
    TwoWayVector<T>& operator*();
};

template<typename T> TwoWayVectorIterator<T>::TwoWayVectorIterator(TwoWayVector<T> &a, int initialPosition){ //construct function
    vector = a ;   
    currentPosition = initialPosition;
}

template<typename T> bool TwoWayVectorIterator<T> :: operator== (TwoWayVectorIterator b){
    if (this.vector == b.vector && this.currentPosition == b.currentPosition) {
        return true;
    }
    else {
        return false;
    }

}

template<typename T> bool TwoWayVectorIterator<T> :: operator!= ( TwoWayVectorIterator b){
    if (this.vector != b.vector || this.currentPosition != b.currentPosition) {
        return true;
    }
    else {
        return false;
    }

}

template<typename T> TwoWayVectorIterator<T>& TwoWayVectorIterator<T> ::operator++(){

    currentPosition++;
    return *this;
}

template<typename T> TwoWayVectorIterator<T>& TwoWayVectorIterator<T> ::operator++(TwoWayVectorIterator a){

    ++a.currentPosition;
    return *a;
}

template<typename T> TwoWayVectorIterator<T>& TwoWayVectorIterator<T> ::operator=(TwoWayVectorIterator other){
    vector = other.vector;
    currentPosition = other.currentPosition;
    return *this;
}

template<typename T> TwoWayVectorIterator<T>& TwoWayVectorIterator<T> ::operator+(int i){
    currentPosition= currentPosition+i;
    return *this;

}

template<typename T> TwoWayVectorIterator<T>& TwoWayVectorIterator<T> ::operator-(int i){
    currentPosition= currentPosition-i;
    return *this;

}

template<typename T>  bool TwoWayVectorIterator<T> :: operator<( TwoWayVectorIterator b){
    if(this.currentPosition < b.currentPosition) return true;
    else return false;

}

template<typename T> TwoWayVector<T>& TwoWayVectorIterator<T> ::operator*(){
    return (*vector)[ currentPosition ];
}

/*int main(){
    TwoWayVector<int> numbers;
    numbers.push_back(3);
    numbers.push_back(2);
    for (TwoWayVectorIterator current = numbers.begin();
         current != numbers.end();
         current++)
    {
        cout << *numbers;
    }
}*/

#endif 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:20:33.803

你有一种循环依赖。`TwoWayVectorIterator`您可以通过在`TwoWayVector.cc`顶部前向声明来解决它。然后不包括`TwoWayVectorIterator.cc`在`TwoWayVector.cc`

```
#ifndef TWOWAYVECTOR_CC
#define TWOWAYVECTOR_CC

// #include"TwoWayVectorIterator.cc"
^^^^^^^^^^^^^^^^^^^^^^

#include <iostream>
#include <cmath>
using namespace std;

template <typename T>
class TwoWayVectorIterator;
^^^^^^^^^^^^^^^^^^^^^^

template <typename T> class TwoWayVector 
```

* * *

而且您在这里缺少模板参数

```
template<typename T> TwoWayVectorIterator<T> TwoWayVector<T> ::begin(){
    TwoWayVectorIterator<T> *a = new TwoWayVectorIterator<T>(&this, 0);
                        ^^^
    return *a;
}

template<typename T> TwoWayVectorIterator<T> TwoWayVector<T> ::end(){
    TwoWayVectorIterator<T> *a = new TwoWayVectorIterator<T>(&this, this.size());
                        ^^^
    return *a;
} 
```

# c# - Autofac 自注册 TypedNamedAndKeyedServices

> ID：15994722
> 
> 赞同：0
> 
> 时间：2013-04-14T01:16:33.917
> 
> 标签：c#, inversion-of-control, ioc-container, autofac, caliburn.micro

我有一个简单的系统，根据用户选择的**分子**类型显示不同的屏幕 (WPF) 。为了实现它，我将 Caliburn.Micro 与 Autofac 一起用作 Ioc 容器。

需要一个简单的命名约定：

**[MoleculeName] <--> [MoleculeName]ViewModel --> [MoleculeName]View**

Caliburn.Micro 提供视图/视图模型约定，我的目标是复制 Molecule<->MoleculeViewModel 部分的约定。

每个 Molecule 都由一个类型表示并继承自**IMolecule**

```
public Interface IMolecule {...} 
```

IoC 由 AutoFac 提供，以下工作正常：

```
private void ConfigureMoleculesLibs(Autofac.ContainerBuilder builder)
{
  var builder = new ContainerBuilder();

  // get assemblies
  var assemblies = AppDomain.CurrentDomain.GetAssemblies();

  // register molecules
  builder
    .RegisterAssemblyTypes(assemblies)
    .Where(t => t.IsAssignableTo<IMolecule>())
    .AsSelf();

  // register molecules view models
  builder
    .RegisterType<H2SO4MoleculeViewModel>()
    .Keyed<Type>(TypeOf(H2SO4Molecule));
  builder
    .RegisterType<HClMoleculeViewModel>()
    .Keyed<Type>(TypeOf(HClMolecule));
  builder
    .RegisterType<H2oMoleculeViewModel>()
    .Keyed<Type>(TypeOf(H2oMolecule));

} 
```

以便允许以下情况：

```
public class MoleculeWrapperViewModel : Screen
{
    public delegate MoleculeWrapperViewModel Factory(IMolecule molecule);

      public MoleculeWrapperViewModel(
        IIndex<Type, Screen> moleculeScreensLookup, 
        IMolecule molecule)
    {
        this.MoleculeViewModel = moleculeScreensLookup[molecule.GetType()];
    }

    public Screen MoleculeViewModel { get; private set; }
} 
```

有没有办法通过将名称与其对应的 ViewModels 匹配来自动注册 Keyed Types，就像 Caliburn 在 Views 和 ViewModels 之间所做的一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T12:07:00.270

听起来您想在这里使用一点反射来遍历所有分子类型并调用相应的`AutoFac`泛型方法

您需要使用您的分子类型来生成您的类型名称：

```
var viewModelTypeName = moleculeTypeName + "ViewModel";

Type yourViewModelType = Type.GetType(viewModelTypeName); // Not 100% on the syntax here, don't have VS open :P

Type type = typeof(ContainerBuilder);
MethodInfo miGeneric = type.GetMethod("RegisterType");

MethodInfo mi = miGeneric.MakeGenericMethod(yourViewModelType);

mi.Invoke(...) // etc 
```

显然它有点复杂，因为您正在链接方法（不确定`RegisterType`返回什么 - 可能是类型注册对象？）并且您必须为第一次调用的返回对象等的通用方法提供这个

你有没有尝试过这样的方法？

不确定是否`AutoFac`支持开箱即用的任何东西 - 但基本上这就是 CM 正在做的所有事情（但有一些正则表达式的魔力和可能更少的泛型？）

# php - 购买后发送电子邮件

> ID：15994723
> 
> 赞同：2
> 
> 时间：2013-04-14T01:16:37.260
> 
> 标签：php, email, paypal-ipn

我有一个捐赠网站。在收到捐款后，我希望收到一封电子邮件，其中包含在此处输入的买家用户名：

```
<input type="text" name="custom" value="Enter your Minecraft username here!"><br /><br /> 
```

我将如何获取该用户名并将其通过电子邮件发送到我的电子邮件？

这是贝宝的ipn：

```
<?php
/**
* PayPal IPN Listener
*
* A class to listen for and handle Instant Payment Notifications (IPN) from
* the PayPal server.
*
* https://github.com/Quixotix/PHP-PayPal-IPN
*
* @package PHP-PayPal-IPN
* @author Micah Carrick
* @copyright (c) 2011 - Micah Carrick
* @version 2.0.5
* @license http://opensource.org/licenses/gpl-3.0.html
*/
include('config.php');
ini_set('log_errors', true);
ini_set('error_log', dirname(__FILE__).'/donator_errors.log');
error_log('abc');
class IpnListener {
    public $use_curl = true;
    public $force_ssl_v3 = true;
    public $follow_location = false;
    public $use_ssl = true;
    public $use_sandbox = false;
    public $timeout = 30;
    private $post_data = array();
    private $post_uri = '';
    private $response_status = '';
    private $response = '';
    const PAYPAL_HOST = 'www.paypal.com';
    const SANDBOX_HOST = 'www.sandbox.paypal.com';
    protected function curlPost($encoded_data) {
        if ($this->use_ssl) {
            $uri = 'https://'.$this->getPaypalHost().'/cgi-bin/webscr';
            $this->post_uri = $uri;
        } else {
            $uri = 'http://'.$this->getPaypalHost().'/cgi-bin/webscr';
            $this->post_uri = $uri;
        }
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $uri);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $encoded_data);
        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, $this->follow_location);
        curl_setopt($ch, CURLOPT_TIMEOUT, $this->timeout);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_HEADER, true);
        if ($this->force_ssl_v3) {
            curl_setopt($ch, CURLOPT_SSLVERSION, 3);
        }
        $this->response = curl_exec($ch);
        $this->response_status = strval(curl_getinfo($ch, CURLINFO_HTTP_CODE));
        if ($this->response === false || $this->response_status == '0') {
            $errno = curl_errno($ch);
            $errstr = curl_error($ch);
            throw new Exception("cURL error: [$errno] $errstr");
        }
    }
    protected function fsockPost($encoded_data) {
        if ($this->use_ssl) {
            $uri = 'ssl://'.$this->getPaypalHost();
            $port = '443';
            $this->post_uri = $uri.'/cgi-bin/webscr';
        } else {
            $uri = $this->getPaypalHost(); // no "http://" in call to fsockopen()
            $port = '80';
            $this->post_uri = 'http://'.$uri.'/cgi-bin/webscr';
        }
        $fp = fsockopen($uri, $port, $errno, $errstr, $this->timeout);
        if (!$fp) {
            throw new Exception("fsockopen error: [$errno] $errstr");
        }
        $header = "POST /cgi-bin/webscr HTTP/1.0\r\n";
        $header .= "Content-Type: application/x-www-form-urlencoded\r\n";
        $header .= "Content-Length: ".strlen($encoded_data)."\r\n";
        $header .= "Connection: Close\r\n\r\n";
        fputs($fp, $header.$encoded_data."\r\n\r\n");
        while(!feof($fp)) {
            if (empty($this->response)) {
                $this->response .= $status = fgets($fp, 1024);
                $this->response_status = trim(substr($status, 9, 4));
            } else {
                $this->response .= fgets($fp, 1024);
            }
        }
        fclose($fp);
    }
    private function getPaypalHost() {
        if ($this->use_sandbox) return IpnListener::SANDBOX_HOST;
        else return IpnListener::PAYPAL_HOST;
    }
    public function getPostUri() {
        return $this->post_uri;
    }
    public function getResponse() {
        return $this->response;
    }
    public function getResponseStatus() {
        return $this->response_status;
    }
    public function getTextReport() {
        $r = '';
        for ($i=0; $i<80; $i++) { $r .= '-'; }
        $r .= "\n[".date('m/d/Y g:i A').'] - '.$this->getPostUri();
        if ($this->use_curl) $r .= " (curl)\n";
        else $r .= " (fsockopen)\n";
        for ($i=0; $i<80; $i++) { $r .= '-'; }
        $r .= "\n{$this->getResponse()}\n";
        for ($i=0; $i<80; $i++) { $r .= '-'; }
        $r .= "\n";
        foreach ($this->post_data as $key => $value) {
            $r .= str_pad($key, 25)."$value\n";
        }
        $r .= "\n\n";
        return $r;
    }
    public function processIpn($post_data=null) {
        $encoded_data = 'cmd=_notify-validate';
        if ($post_data === null) {
            if (!empty($_POST)) {
                $this->post_data = $_POST;
                $encoded_data .= '&'.file_get_contents('php://input');
            } else {
                throw new Exception("No POST data found.");
            }
        } else {
            $this->post_data = $post_data;
            foreach ($this->post_data as $key => $value) {
                $encoded_data .= "&$key=".urlencode($value);
            }
        }
        if ($this->use_curl) $this->curlPost($encoded_data);
        else $this->fsockPost($encoded_data);
        if (strpos($this->response_status, '200') === false) {
            throw new Exception("Invalid response status: ".$this->response_status);
        }
        if (strpos($this->response, "VERIFIED") !== false) {
            return true;
        } elseif (strpos($this->response, "INVALID") !== false) {
            return false;
        } else {
            throw new Exception("Unexpected response from PayPal.");
        }
    }
    public function requirePostMethod() {
        // require POST requests
        if ($_SERVER['REQUEST_METHOD'] && $_SERVER['REQUEST_METHOD'] != 'POST') {
            header('Allow: POST', true, 405);
            throw new Exception("Invalid HTTP request method.");
        }
    }
}

// Start IPN listener by chaseoes.
$listener = new IpnListener();
$listener->use_sandbox = false;
try {
    $listener->requirePostMethod();
    $verified = $listener->processIpn();
} catch (Exception $e) {
    error_log($e->getMessage());
    exit(0);
}
if ($verified) {
    $errmsg = '';
    if ($_POST['payment_status'] != 'Completed') { 
        exit(0); 
    }
    if ($_POST['receiver_email'] != $seller_email) {
        $errmsg .= "'receiver_email' does not match: ";
        $errmsg .= $_POST['receiver_email']."\n";
    }
    if ($_POST['mc_currency'] != $currency) {
        $errmsg .= "'mc_currency' does not match: ";
        $errmsg .= $_POST['mc_currency']."\n";
    }
    if (empty($errmsg)) {
    $user = $_POST['custom'];
    error_log($user);
    $gross = $_POST['mc_gross'];
    error_log($gross);
    $date = $_POST['payment_date'];
    $sandbox = $listener->use_sandbox;
    $firstname = $_POST['first_name'];
    $lastname = $_POST['last_name'];
    $payeremail = $_POST['payer_email'];
    $con = mysql_connect($host,$username,$password);
    if (!$con) {
         error_log("MySQL connection error.");
    }
    mysql_select_db("$database_name", $con);
    mysql_query("INSERT INTO donations (username, amount, date, processed, sandbox, first_name, last_name, payer_email, expires, expired)
    VALUES ('$user','$gross','$date','false','$sandbox','$firstname','$lastname','$payeremail','null','false')");
    mysql_close($con);
    }
}
// End IPN listener by chaseoes.
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:08:02.503

假设您的其余代码是有效的，您可以将以下内容放在后面`mysql_close($con);`

把这样的东西放在那里：

```
mail("youremail@example.com", "Donation received", "You have received a new payment from ".$custom.""); 
```

将 yourremail@example.com 替换为您希望接收这些邮件的邮件地址。

所以你的最终代码如下所示：

```
 mysql_close($con);
   mail("youremail@example.com", "Donation received", "You have received a new payment from ".$custom."");
} 
```

# jquery - 滚动到动态添加数据的第一个 div

> ID：15994724
> 
> 赞同：0
> 
> 时间：2013-04-14T01:16:41.913
> 
> 标签：jquery, html, ajax

我正在制作一个无尽的卷轴。

当我按下“获取更多帖子”按钮时，添加数据后，它应该向下滚动到动态添加数据的第一个帖子（在 div 中）。

所以我想获得动态添加数据的第一个 DIV。

我试图让 jQuery 在添加的最后一个帖子之后找到 div id（这是帖子的 post_id 编号），然后让 jQuery 找到下一个最低的帖子编号（应该是动态的第一个 div id添加数据）。然后它应该向下滚动到那个。

例如：

```
 <div id = "5">
        //Post.
    </div>
    <div id = "4">
        //Post.
    </div>

    //THIS IS THE DYNAMICALLY ADDED CONTENT, IT IS ONLY ADDED AFTER THE AJAX CALL WITH JQUERY.
    <div id = "2"> //<--- It should scroll down to that one.
        //Post.
    </div>
    <div id = "1">
        //Post.
    </div>
//Dynamically added content ends.

<script type = "text/javascript">
$(document).ready(function(){
    $('#get-more-post').click(function(){

    var post_id = $('div.Posted:last').attr('rel');
    //In this case, the post_id = 4.

    $.post("add_more_post.php", {post_id: post_id} , function(data){
        if(data){
            var scroll_div = //I want jQuery to find the post which is lower than post_id = 4, that is post_id = 2\. How is it done?;
            parent.$("html, body").animate({ scrollTop: $("div#"+scroll_div).offset().top; }, "slow");
        }
    });
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:25:40.373

像这样的东西应该工作。

```
var scrollDiv = $("#4").next("div").attr("id"); 
```

[http://jsfiddle.net/637eT/1/](http://jsfiddle.net/637eT/1/)

# android - 在查看器上设置 textView 时出现 NullPointerException（非空）

> ID：15994726
> 
> 赞同：0
> 
> 时间：2013-04-14T01:16:47.940
> 
> 标签：android, android-fragments, android-gridview, android-logcat, android-adapter

我有一个自定义适配器类，在里面`getView`我遇到了查看器和设置/访问元素的问题。`NullPointerException`当我尝试将 设置为查看器时，我始终收到一个`textView`。我已经测试了数据并逐步记录了该过程，似乎视图设置不正确，或者它试图访问的元素不是？logcat 中的前几行显示：

```
04-13 20:55:13.620: W/dalvikvm(23329): threadid=1: thread exiting with uncaught exception (group=0x40dd8930)
04-13 20:55:13.644: E/AndroidRuntime(23329): FATAL EXCEPTION: main
04-13 20:55:13.644: E/AndroidRuntime(23329): java.lang.NullPointerException
04-13 20:55:13.644: E/AndroidRuntime(23329):    at com.idealiner.metrosleepuniversal.adapter.LocationModelGridAdapter.getView(LocationModelGridAdapter.java:99) 
```

第 99 行是我尝试访问 textView 元素时：

```
viewHolder.textView.setText(locationModel.col_line); 
```

我已经测试过`locationModel.col_line` **它不会返回空值**。似乎`Viewholder`无法访问...或者找不到 textView *？*我不完全确定。

整个 getView 方法：

```
 public View getView(int position, View convertView, ViewGroup parent) {

        View       view = convertView;
        ViewHolder viewHolder;

        if (view == null || view.getTag() == null) {

            view = mInflater.inflate(R.layout.grid_view, parent, false);

            viewHolder = new ViewHolder();
//            viewHolder.imageView = (ImageView) view.findViewById(R.id.grid_image);
            viewHolder.textView  = (TextView) view.findViewById(R.id.grid_label);
            view.setTag(viewHolder);

            Log.v("GetViewAdapter", "View is null, setup viewholder");

        }else {

            viewHolder = (ViewHolder) view.getTag();
            Log.v("GetViewAdapter", "View is not null, setup viewholder");

        }

        lineModel locationModel = mLine[position];

        Log.v("GetViewAdapter", "mline has a position of: " + position);
        Log.v("GetViewAdapter", "mline has a name of: " + locationModel.col_line);

        if(locationModel!=null) {

            viewHolder.textView.setText(locationModel.col_line);
        }

        return view;
    } 
```

该类的其余代码可以在这里找到：[https ://gist.github.com/markbratanov/5380875](https://gist.github.com/markbratanov/5380875)

我整天都在思考这个问题，所以任何建议/提示将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:49:59.203

我不知道它是否能解决你的问题，但看看定义，

```
view.findViewById(R.id.grid_label) 
```

“查找具有给定 id 的子视图。如果此视图具有给定 id，则返回此视图。”

除非你确定重用的观点是`R.id.grid_label`...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:31:02.000

正如@Ted-hopp 所说，textView 为空，因为我将错误的布局膨胀为视图，其中没有 textView。

谢谢你的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T05:01:08.327

TextViews 只能显示“String”或“CharSequence”。

所以，试试这个`viewHolder.textView.setText((location.col_line).toString());`

# php - Laravel FacebookSDK 捆绑包不工作

> ID：15994729
> 
> 赞同：0
> 
> 时间：2013-04-14T01:17:37.647
> 
> 标签：php, laravel, laravel-3

伙计们，我正在 Laravel 中编写一个包含游戏的 facebook 应用程序，我需要保存最终分数。问题是，我需要获取用户 ID（谁在玩）才能将获得的分数保存到数据库中。

我已经安装了 Laravel 网站上的 FacebookSDK 包，但是当我尝试定义它时，我得到以下信息：

应用控制器：

```
<?php

class App_Controller extends Base_Controller {

public $restful = true;    

public function get_check()
{
    // Define FbkSDK
    $facebook = IoC::resolve('facebook-sdk');
    // Get UserId
    $uid = $facebook->getUser();

}    

public function get_game()
{
    // Imprimo la pantalla del juego
}    

} 
```

错误：

```
Unhandled Exception
Message:

Class facebook-sdk does not exist

Location:

/home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/laravel/ioc.php on line 155

Stack Trace:

#0 /home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/laravel/ioc.php(155): ReflectionClass->__construct('facebook-sdk')
#1 /home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/laravel/ioc.php(118): Laravel\IoC::build('facebook-sdk', Array)
#2 /home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/application/controllers/app.php(10): Laravel\IoC::resolve('facebook-sdk')
#3 [internal function]: App_Controller->get_check()
#4 /home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/laravel/routing/controller.php(325): call_user_func_array(Array, Array)
#5 /home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/laravel/routing/controller.php(285): Laravel\Routing\Controller->response('check', Array)
#6 /home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/laravel/routing/controller.php(165): Laravel\Routing\Controller->execute('check', Array)
#7 /home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/laravel/routing/route.php(153): Laravel\Routing\Controller::call('app@check', Array)
#8 /home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/laravel/routing/route.php(124): Laravel\Routing\Route->response()
#9 /home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/laravel/laravel.php(167): Laravel\Routing\Route->call()
#10 /home/pablo/htdocs/conamor/CUENTAS/AventuraCenter/pacman/public/index.php(34): require('/home/pablo/htd...')
#11 {main} 
```

我无法让它工作。我已按照所有安装说明进行操作。

任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T03:35:55.727

这听起来确实像捆绑包尚未启动。

确保该包已在您的`application/bundles.php`文件中列出并设置为自动启动。

```
return array(
   'facebook-sdk' => array('auto' => true)
); 
```

如果这不起作用，请尝试事先手动启动捆绑包。

```
Bundle::start('facebook-sdk'); 
```

如果您没有使用 Artisan 安装包，请记住包目录的名称应与`application/bundles.php`文件中的键对应。如果没有，则设置`location`捆绑包的。

```
return array(
   'facebook-sdk' => array('auto' => true, 'location' => 'facebook-sdk-path')
); 
```

这个位置是相对于`bundles`目录的。

最后，作为调试措施，您可以检查 IoC 容器注册表以确认（在捆绑包启动后）`facebook-sdk`正在绑定实例。

```
die(var_dump(IoC::$registry)); 
```

你应该得到一个包含`facebook-sdk`. 如果它不存在，那么再次检查前两个步骤以确保捆绑包已启动。

# ember.js - 与 ember 重定向和/或 renderTemplate 非常混淆

> ID：15994730
> 
> 赞同：3
> 
> 时间：2013-04-14T01:17:46.563
> 
> 标签：ember.js

我是 ember 的新手，我真的很想知道如何完成应该是一个相当简单的任务。

我正在尝试将我的简历放入 ember 应用程序中。作为简历的一部分，我有一些参考资料。

当有人点击导航中的“参考”链接时，我希望它显示每个参考的链接，以及第一个参考，显示为链接的子项。

显然，我在这里的选择是重定向到“references/1”url（不是很理想），或者显示“reference”模板。

我会为此构建一个 JSFiddle，但 jsfiddle 似乎已损坏，因为我无法加载或查看已经存在的任何内容。

我有这个与常规路线一起工作的地方，我在其中加载引用，它显示链接，如果我点击一个链接，或者直接使用'references/2' url 加载页面，它会显示正确的内容。

如果我使用重定向

```
App.ReferencesRoute = Ember.Route.extend({
    模型：函数（）{
        返回 App.References.find();
    },
    重定向：函数（）{
        this.transitionTo('reference',App.References.find(1));
    }

});

```

我得到正确重定向的 url，但我没有得到引用的链接。我确实加载了“参考”模板，但模型没有通过。我试过使用`this.modelFor('references').get('firstObject')`，但这也没有返回任何东西，这就是我使用`find(1)`.

如果我尝试像这样使用渲染模板和控制器执行此操作

```
App.ReferencesRoute = Ember.Route.extend({
    模型：函数（）{
        返回 App.References.find();
    },
    渲染模板：函数（）{
        this.render();
        this.render('reference',{into: 'references',controller:'reference'});

    }
});

App.ReferenceController = Ember.ObjectController.extend({
    信：'测试信'
});

```

我收到了链接和“测试信”消息，但遇到了其他一些问题。

1) 我不知道如何将 Reference 控制器传递给第一个模型，以便它实际上返回与用户在'/references/1' url 相同的结果

2）如果我单击链接，则不显示所选字母，这意味着如果我使用控制器，链接将不起作用。

3）我希望第一个链接处于活动状态，因为那是已经显示的字母，但与其他问题相比，这是一个小细节。

我会完全错了吗？我有什么大不了的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T04:39:14.667

为了通过重定向传递模型，我使用这样的东西：

```
App.ReferencesIndexRoute = Ember.Route.extend({
   model    : function(){
       return App.References.find();
   },
   redirect : function(){
      var model = this.controllerFor('references').get('model');
      this.transitionTo('reference', model);
   }
}); 
```

# php - 对于每个未正确列出结果的循环

> ID：15994737
> 
> 赞同：0
> 
> 时间：2013-04-14T01:18:42.617
> 
> 标签：php, mysql

我有这个查询

```
try
{
$sql2 = 'SELECT tpf_news.park_id name
FROM tpf_news
INNER JOIN tpf_parks ON tpf_news.park_id = tpf_parks.park_id GROUP BY name ORDER BY date DESC ' ;
$result2 = $pdo->query($sql2);
}
catch (PDOException $e)
{
$error = 'Error fetching news by park: ' . $e->getMessage();
include 'error.html.php';
exit();
} 
```

它会创建一个包含新闻故事的主题公园列表。每个公园都有很多新闻报道。问题是当我尝试在每个循环中回显结果时，我只看到“park_id”而不是“名称”。下面是循环

```
<?php foreach ($result2 as $row2): ?>

<h3>
<?php echo $row2['name'].''.$row2['park_id']; ?>
</h3>
<br>

<?php endforeach; ?> 
```

如果我更改顺序，我可以使“名称”出现但不显示“park_id”。奇怪的是 park_id 正在通过 $row2['name'] 回显，它的 $row2['park_id'] 似乎什么都不做。我究竟做错了什么？

如果它在“新闻”表中有帮助，那么重要的列是“news_id”，这是键和“park_id”。'park_id' 是将新闻表连接到 parks 表的内容，在此表中是从中提取 'name' 的位置。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:45:39.517

要么您在字段之间缺少逗号：

```
$sql2 = 'SELECT tpf_news.park_id, name
FROM tpf_news
INNER JOIN tpf_parks ON tpf_news.park_id = tpf_parks.park_id 
GROUP BY name 
ORDER BY date DESC '; 
```

或者您正在尝试使用别名，我会这样指定：

```
$sql2 = 'SELECT tpf_news.park_id as park_name
FROM tpf_news
INNER JOIN tpf_parks ON tpf_news.park_id = tpf_parks.park_id 
GROUP BY name 
ORDER BY date DESC '; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:47:15.850

首先，您的查询仅返回带有“name”别名的 park_id。您没有从表中选择任何名称。其次，您无法以您的方式获得查询结果。试试这个：

```
while($row2 = $result2->fetch()){
    echo $row2['name'];
} 
```

# actionscript-3 - 在单个动作脚本中编写多个按钮（几乎相同）的问题

> ID：15994739
> 
> 赞同：0
> 
> 时间：2013-04-14T01:19:12.313
> 
> 标签：actionscript-3, flash, actionscript, flash-cs5, flash-cs4

我是动作脚本 3 的菜鸟，所以请原谅这个详细的帖子！（和代码发布错误）

我正在制作一个交互式 Flash 项目......它有 17 个独立的场景......

*   介绍场景
*   “主序列”
*   15个单独的标题歌曲页面

我已经编写了 Intro-->“main” 序列的脚本，没有任何问题....

**我的问题是“主序列”有 15 个按钮，我需要将它们链接到 15 个单独的场景......我尝试了两组不同的代码（见下文）并不断收到编译器错误......**我会如果有人能告诉我这两种格式中哪一种最适合我的目的以及我到底做错了什么......

**代码 1：**这是我用来将各个页面链接回主序列的修改

```
TD_g.addEventListener(MouseEvent.MOUSE_DOWN,mouseDownHandler1);
function mouseDownHandler1(event:MouseEvent):void {

gotoAndStop(1,"Tweedlee_Dee");
}
  s_g.addEventListener(MouseEvent.MOUSE_DOWN,mouseDownHandler2);
function mouseDownHandler2(event:MouseEvent):void {

gotoAndStop(1,"Sincerely");
}
      ats_g.addEventListener(MouseEvent.MOUSE_DOWN,mouseDownHandler3);
  function mouseDownHandler3(event:MouseEvent):void {

gotoAndStop(1,"Ain’_that_a_shame"); 
```

...重复 15 次 ...该 `_g`部分是指我分配给主序列上每个按钮的唯一**实例名称**...我更改了每个按钮，`#`因为`MouseDownHandlr`我在某处读到每个事件必须不同（？） ..每次我测试场景时，我都会得到以下结果......

TypeError：错误 #1009：无法访问空对象引用的属性或方法。在 music_Sheet_project_14_Main_Sequence_fla::MainTimeline/frame1( ...然后场景以鼠标悬停效果开始并且它的动画随后是鼠标悬停效果但是如果我单击它们应该返回错误的按钮（？）不会产生“反应”

...每次我测试电影（只用那个短代码！）我得到以下...

14 编译器错误

**全部 1021：重复的函数定义。**资源 ：`function mouseDownHandler(event:MouseEvent):void {`

## ..所以我尝试了不同的路线...

**Code2 **这是我在尝试修复第一个代码时发现的风格不同的代码

```
stop();
TD_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
s_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
ats_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
iyk_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
hms_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
tf_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
hd_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
ld_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
ll_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
ts_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
ipsy_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
ysm_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
ihm_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
iss_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
tl_g.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
function mouseDownHandler(event:MouseEvent):void
{
var nameOfButton:String = event.currentTarget.name;
if (nameOfButton == "TD_g")
{
 gotoAndStop(1, "Tweedlee_Dee");
}
 else if (nameOfButton=="s_g")
{
gotoAndStop(1, "Sincerely");
}
else if (nameOfButton=="ats_g")
{
gotoAndStop(1, "Ain’_that_a_shame");
}
else if (nameOfButton=="iyk_g")
{
 gotoAndStop(1, "I_hear_you_knocking");
} 
```

**...这继续 15 次，包括第 64 行**

```
{
else if (nameOfButton=="ysm_g");
{
 gotoAndStop(1, "You_shook_me"); 
```

当我尝试运行它时，我得到以下...

**“1083：语法错误：否则是意外的。**来源`else if (nameOfButton=="ysm_g");`

当我查找此内容时，我收到有关语法错误的建议...但是为什么会选择这一行而不是所有其他行...我已尝试重新键入和重新格式化，但我一直收到该错误...

****这些代码中哪一个最适合使用？（为什么它不起作用？？？）任何/所有建议和帮助将不胜感激......谢谢！****

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:28:03.940

问题是在 else 语句之前没有相应的右大括号。此外，您在 else 末尾有分号，这会使事情变得混乱：

```
{
else if (nameOfButton=="ysm_g");
{
 gotoAndStop(1, "You_shook_me"); 
```

应该

```
{
//...Whatever code goes here
}
else if (nameOfButton=="ysm_g")
{
   gotoAndStop(1, "You_shook_me");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T17:00:43.630

如果将对象链接到要触发的场景的名称，则可以避免整个 if-elseif 混乱。这更容易阅读和维护，因为所有配置都是在下面的 init() 方法中完成的。方法 setSceneByTarget() 是公开的，因此您可以在运行时添加更多项目。

```
public class Main extends MovieClip
{
    private var _scenesByTarget:Dictionary;
    public function Main()
    {
        _scenesByTarget = new Dictionary(true);
        //call init() or hook it to ADDED_TO_STAGE event if you want
    }
    public function init():void
    {
        //add your listeners here like this:

        //myItem1.addEventListener(MouseEvent.MOUSE_DOWN, onMouseDown);
        //setSceneByTarget(myItem1, myItem1Scene);

        //myItem2.addEventListener(MouseEvent.MOUSE_DOWN, onMouseDown);
        //setSceneByTarget(myItem2, myItem2Scene);

        //...
    }

    public function setSceneByTarget(targetObj:Object, targetScene:String):void
    {
        _scenesByTarget[targetObj] = targetScene;
    }
    private function jumpToSceneByTarget(targetObj):void
    {
        if (_scenesByTarget[targetObj] != null) {
            gotoAndStop(1, _scenesByTarget[targetObj]);
        }
    }
    private function onMouseDown(evt:MouseEvent):void
    {
        jumpToSceneByTarget(evt.target);
    }
} 
```

# php - php文本字段编辑文件

> ID：15994740
> 
> 赞同：0
> 
> 时间：2013-04-14T01:19:30.437
> 
> 标签：php, html, file, config, textfield

我已经制作了一个系统，允许您通过网页上的文本字段编辑 config.php 文件但是文本框显示整个文件内容有没有办法我可以限制它只显示像这样的行的一部分

```
$paypal_email = "mypaypalemail@gmail.com"; 
```

并且只显示

```
mypaypalemail@gmail.com 
```

在文本框中。这是我的代码

```
<?php
$process = array(&$_GET, &$_POST, &$_COOKIE, &$_REQUEST);
while (list($key, $val) = each($process)) {
    foreach ($val as $k => $v) {
        unset($process[$key][$k]);
        if (is_array($v)) {
            $process[$key][stripslashes($k)] = $v;
            $process[] = &$process[$key][stripslashes($k)];
        } else {
            $process[$key][stripslashes($k)] = stripslashes($v);
        }
    }
}
unset($process);
?>
<?php

$file = 'config.php';
// print_r( glob( dirname(__FILE__) . "/*.php"  ) );

$configFile = html_entity_decode(file_get_contents($file), ENT_NOQUOTES);

if ( isset( $_POST["save_button"] ) && $_POST["config_changes"]){
$changes = $path = str_replace("\"", "", $_POST["config_changes"]);
  file_put_contents($file, $_POST["config_changes"]);
}
?>

<html>
  <body>
  <center>
  <b>
  <font face="arial" size="3" color="#000000">
  Welcome edit your Options here
  <br>
    <form method="post" action="controlpanel.php">
      <textarea name="config_changes" rows="30" cols="50"><?php echo $configFile ?></textarea>
      <br>
      <button name="save_button">Save</button>
    </form>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:29:54.657

我的第一个想法是使用正则表达式，但我偶然发现了更好的方法。准确地说是PHP 函数[token_get_all()](http://www.php.net/manual/en/function.token-get-all.php)。

您将文件内容传递给该函数（在此演示中，我使用 token_get_all 中的一些示例代码作为参数。不过，您可以在此处传递完整的文件。

```
$tokens = token_get_all('<?php $paypal_email = "mypaypalemail@gmail.com"; ?>');

$vars = array();
foreach ($tokens as $token) {
    if ($token[0] == T_CONSTANT_ENCAPSED_STRING) {
        $vars[] = $token[1];
        continue;
    }
}

var_dump($vars); 
```

它应该返回该文件中的所有变量，如下所示：

```
array(1) { [0]=> string(25) ""mypaypalemail@gmail.com"" } 
```

使用它进行一些调试并检查您正在搜索的变量是哪个索引。然后，您可以访问给定索引处的变量。

如前所述，我不知道你用它做什么，但听起来不安全。我强烈建议寻找另一种解决方案。

# android - 查看图像时的Android ArrayIndexOutOfBoundsExeption

> ID：15994741
> 
> 赞同：0
> 
> 时间：2013-04-14T01:19:35.283
> 
> 标签：android, arrays, image, dialog

我有一个简单的应用程序，当您单击 GridView 中的图像时，会弹出一个对话框，其中包含一个显示“视图”的按钮。当您单击按钮时，我想查看已在图库中单击的图像。当我让应用程序在没有对话框的情况下导航到图库时，我可以毫无问题地让它工作，但我需要它首先点击一个对话框。我的 LogCat 正在返回的错误`Java.lang.ArrayIndexOutOfBoundsExeption`。关于我需要做什么来查看图像的任何想法？下面是我的代码。

```
public void onClick(View v) {
  Dialog dia = new Dialog(ViewGrid.this);
  dia.setContentView(R.layout.viewimage);
  dia.setTitle("What To Do?");
  dia.show(); 
  dia.setCancelable(true);
  Button button = (Button)dia.findViewById(R.id.viewImage);
  button.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
      int id = v.getId(); 
      Intent intent = new Intent();  
      intent.setAction(Intent.ACTION_VIEW);     
      intent.setDataAndType(Uri.parse("file://" + arrPath[id]), "image/*");
      startActivity(intent);
    }
  }); 
} 
```

我在这一行收到错误：

```
intent.setDataAndType(Uri.parse("file://" + arrPath[id]), "image/*"); 
```

我想到了！下面的代码是工作代码。我需要将我从视图中获得的 ID 设置为单击图像，而不是单击视图按钮。谢谢大家的帮助！

```
public void onClick(final View viewIt) {
  Dialog dia = new Dialog(ViewGrid.this);
  dia.setContentView(R.layout.viewimage);
  dia.setTitle("What To Do?");
  dia.show(); 
  dia.setCancelable(true);
  Button button = (Button)dia.findViewById(R.id.viewImage);
  button.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
      int id = viewIt.getId(); 
      Intent intent = new Intent();  
      intent.setAction(Intent.ACTION_VIEW);     
      intent.setDataAndType(Uri.parse("file://" + arrPath[id]), "image/*");
      startActivity(intent);
    }
  }); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:52:07.227

不确定，但我相信`dia.show();`应该在最后调用 - 即在**view.setOnClickListener**之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T02:50:27.617

这个 ArrayIndexOutOfBoundsException 是从哪里抛出的？我假设它在您访问 arrPath[i] 时被抛出。您如何认为视图的 id 应该是 arrPath 的索引？这似乎是问题所在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T10:59:56.773

尝试打印

```
arrPath[id] 
```

你应该得到同样的错误。正如 Sky Kelsey 提到的，视图 id 作为数组的索引有问题。

如果文件路径是例如

```
File file = new File("/sdcard/yourfile-VIEWID.jpg"); 
```

然后尝试而不是使用数组来保存路径，做一些事情

```
File file = new File("/sdcard/yourfile-"+String.valueof(id)+".jpg"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T20:56:39.633

我已经找出了问题并在问题上方发布了我的正确代码。感谢所有帮助过的人。

# python - For-Loop 在 while 循环中中断

> ID：15994742
> 
> 赞同：1
> 
> 时间：2013-04-14T01:19:39.977
> 
> 标签：python, if-statement, break

这是我的代码：

```
primes = [2, 3]

while len(primes) != 1001:
    a = primes[-1] + 2
    for i in primes:
        if a % i == 0:
            break
    else:
        print(primes)
        primes.append(a)

print(primes[1002]) 
```

这应该创建一个直到第 1001 个素数的列表，然后打印第 1001 个数字。它首先取列表中的最后一个数字并加 2，然后检查给定的数字是否可以被素数列表的任何成员整除。如果它是可整除的，则 for 循环中断并跳过 else 子句。如果不是，则将该数字附加到素数列表中。重复该过程，直到列表的长度为 1001。循环结束后，打印最后一个数字。

但是，输出如下：

```
[2, 3]
[2, 3, 5]
_ 
```

并且在手动执行此操作之前，该程序不会终止。你能告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T01:25:55.353

这是因为，在`primes[-1] + 2`不是素数的情况下，不会更改任何状态（因此程序永远循环）。

更好的方法可能是这样的：

```
 from itertools import count

 primes = [2, 3]
 for a in count(5, step=2):
     for p in primes:
         if a % p == 0:
             break
     else:
         primes.append(a)
         if len(primes) > 1001:
             break 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:34:37.957

`a`您遇到的第一个非质数`a`停止增长。这有效：

```
primes = [2, 3]

a = 3
while len(primes) != 1001:
    a += 2
    for i in primes:
        if a % i == 0:
            break
    else:
        print(primes) # I'm not sure why you'd want to do this
        primes.append(a)

print(primes[1000]) # Note the index: 1000, not 1002 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T01:35:00.793

首先，我会告诫不要在 while 循环中使用 == 和 != ，除非您可以保证会达到标记值。您可能想使用：*while len(primes) < 1000:*例如。

同样，您需要确保最终会达到循环的退出条件。

另一种选择是使用*while True:*作为循环头，并在循环内使用 break 进行一些其他处理。（`if iteration_count > 1000000 or len(primes > 1000): break ... else iteration_count += 1`例如）。

（想象一下，在您的示例中，在素数列表中附加了多个值的错误……即使其余代码正确，它也可能永远循环——数百万个素数之后程序因内存不足而崩溃）。

*else:*循环子句是 Python 特有的功能。在大多数其他编程语言中，您必须创建一个标记变量并在离开循环后测试其值。将循环中的*else:*子句视为特定于尝试搜索某物的尝试……而*else:*是在循环中没有找到合适的项目时执行的代码。

鉴于我不确定您在这里真正想要做什么。

# c++ - QListWidget 清除功能的问题

> ID：15994749
> 
> 赞同：0
> 
> 时间：2013-04-14T01:20:41.380
> 
> 标签：c++, qt

我正在尝试清除三个 QListWidgets，以便我可以用不同的数据重新填充它们。我决定这样做：

```
void MainWindow::createActions()
{
    m_openAction = new QAction("Open", this); // filemenu (Open)
        connect(m_openAction, SIGNAL(triggered()), this, SLOT(open()));
        connect(m_openAction,SIGNAL(triggered()),m_listAlbum,SLOT(clear()));
        connect(m_openAction,SIGNAL(triggered()),m_listGenre,SLOT(clear()));
        connect(m_openAction,SIGNAL(triggered()),m_listArtist,SLOT(clear()));
} 
```

该程序编译得很好，但是一旦我运行它就会崩溃。这里的代码有问题吗？有没有更简单的方法来删除 QListWidget 中的项目？

# google-maps - 增加谷歌地图路线的悬停区域

> ID：15994752
> 
> 赞同：1
> 
> 时间：2013-04-14T01:20:46.653
> 
> 标签：google-maps, google-maps-api-3, routes

我在谷歌地图上显示了几条路线。当用户悬停/点击路线（或附近）时，我会弹出一个包含路线信息的弹出窗口。

问题是，我认为谷歌没有让路线被点击/悬停，因为你**需要很高的鼠标精度**！您**必须在路线像素**上单击它或悬停以激活。这很有挑战性！

我已经尝试让路线线更粗，但我不能让它们在重叠之前变得太粗，并且在视觉上变得无用。

**如何增加悬停区域？**

我注意到，对于方向，谷歌有一个鼠标跟踪器，它显示了距离路线更大的鼠标距离。该鼠标跟踪器是路线上的一个点，当鼠标与路线有一定距离时，它会显示出来。这有点像我想要的。我可以通过遍历路线中的所有路段来手动实现一个，并计算从路段终点（以及可能在路段上插值的几个点 - 取决于路段长度）到地图上鼠标坐标的距离。我必须考虑缩放级别或有办法将地图上的距离转换为屏幕上的距离/像素。

# google-apps-script - 检查单元格更新 Google 电子表格

> ID：15994755
> 
> 赞同：0
> 
> 时间：2013-04-14T01:21:08.337
> 
> 标签：google-apps-script, google-sheets

我正在处理由多人编辑的 Google 电子表格。这是为了跟踪各种成员的统计信息，所以他们每个只更新一行。我要做的是检查行中的单元格何时更新，并根据更新日期更改该行中另一个单元格的背景。

```
function onEdit() {
 var s = SpreadsheetApp.getActiveSheet();
 if( s.getName() == "HT ~ Stats" ) { //checks that we're on the correct sheet
   var r = s.getActiveCell();
   if( r.getColumn() == 7 ) { //checks for the correct column
     var dateCell = r.offset(0,21);
     //var date = new Date()
     var date = Utilities.formatDate(new Date(), "GMT", "MM-dd-yyyy")

     dateCell.setValue(date); //sets column AB of selected row to the date of the update

 };
} 
```

正是在这一点上，我被卡住了。在此之后我想要发生的事情是将 var date 的值与当前日期进行比较。比较后，如果结果在当前日期的 3 天内，我希望所选行中的第一个单元格将其背景更改为绿色。

这是我第一次在 Google Scripts 中做任何事情，所以我确信有任何更简单或更好的方法可以做到这一点。谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T13:49:57.287

我尚未测试以下内容，但它可能会让您走上正轨。它基本上完成了您在上面所做的工作，但是在第二次编辑时，它获取原始日期，将其转换为整数，获取新的日期整数，计算出差异，如果大于 3 天（以毫秒为单位）然后设置第一个单元格的背景颜色。

它可能需要一些调整，但我希望它有所帮助。

```
 function onEdit() {
  //G ets current spreadsheet
  var s = SpreadsheetApp.getActiveSheet();
  // If on the right spreadsheet
  if( s.getName() == "HT ~ Stats" ) { 
    // Gets the active cell
    var r = s.getActiveCell();
    // If on the right column
    if( r.getColumn() == 7 ) {
      // Sets the AB column
      var dateCell = r.offset(0,21);
      // Retrieves the currentDate
      var currentDate = dateCell.getValue().getTime();
      // Creates a new date
      var date = new Date();
      // Adds the date to the AB cell
      dateCell.setValue(date);
      // Creates a date integer
      var dateInt = date.getTime();
      // Works out the difference of the current date and new date
      var difference = dateInt - currentDate;
      // Creates a 3 day integer
      var threeDays = 259200000;
      // If the difference is greater than 3 days. 
      if(difference >= threeDays)
      {
        //Set the first cell background colour.
        r.offset(0,-6).setBackgroundColor("#D3E375");
      }
    }
  }
} 
```

# numpy - 使用条件绘制 matplotlib

> ID：15994759
> 
> 赞同：3
> 
> 时间：2013-04-14T01:21:56.090
> 
> 标签：numpy, matplotlib, conditional, multidimensional-array

我有一个二维数组，我需要绘制列 x 和 y，但只能在 x 的某个范围内。我知道如何使用索引进行绘图，但我需要指定 x 的*值*。我有一些这样的数组，所以我试图找到一种方法来做到这一点，而不必单独查看它们中的每一个。

这是一个例子：

```
array([[  4.40148390e+03,   1.13200000e+00],
       [  4.40248390e+03,   1.12200000e+00],
       [  4.40348440e+03,   1.11600000e+00],
       [  4.40448440e+03,   1.10600000e+00],
       [  4.40548490e+03,   1.09200000e+00],
       [  4.40648490e+03,   1.07700000e+00],
       [  4.40748540e+03,   1.08700000e+00],
       [  4.40848540e+03,   1.09400000e+00],
       [  4.40948580e+03,   1.10200000e+00],
       [  4.41048580e+03,   1.09500000e+00],
       [  4.41148630e+03,   1.12000000e+00]]) 
```

所以假设我只需要`4402 < x < 4410`但我不知道索引。我可以放一些类似的东西：`plot(x, y, where(4402 < x < 4410))`？

我觉得我在这里缺少一些明显的东西：p

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T03:07:12.390

You could use **matplotlib** to set limits on your x-axis so as not to display all the points in your data series. However, we can filter your **numpy** array above as follows:

```
a = array([[ .... ]])
x = a[:,0]
y = a[:,1]

filter = (x>4402)&(x<4410)

plot(x[filter],y[filter]) 
```

# java - 为什么调用方法和返回局部变量有区别？

> ID：15994762
> 
> 赞同：0
> 
> 时间：2013-04-14T01:22:18.397
> 
> 标签：java, testcase

在 h.getNetYearlyIncome() 失败，似乎 5k 太高了。我整天都在研究它，但无法弄清楚。

为什么 h.getNetYearlyIncome()= h.getGrossYearlyIncome() - h.getTaxesWithheld() 不等于 yearlyIncome-taxesWitheld

```
public void testSalariedEmployeeMakingOver100K() {
SalariedEmployee h = new SalariedEmployeeImpl("John", "Doe", "Mechanical Turk", 1111, 9166.75);

    assertEquals(h.getFirstName(), "John");
    assertEquals(h.getLastName(), "Doe");
    assertEquals(h.getJobTitle(), "Mechanical Turk");
    assertEquals(h.getID(), 1111);
    assertEquals(h.getMonthlySalary(), 9166.75, 0.005);
    assertEquals(h.getGrossYearlyIncome(), 9166.75*12, 0.005);
    assertEquals(h.getTaxableIncome(), h.getGrossYearlyIncome(), 0.005);
    assertEquals(h.getTaxesWithheld(), 15000.25, 0.005);
    assertEquals(h.getNetYearlyIncome(), h.getGrossYearlyIncome()-h.getTaxesWithheld(), 0.005);
}

public class SalariedEmployeeImpl extends EmployeeImpl implements
    SalariedEmployee {
String first_name;
String last_name;
String job_title;
int id;
double monthly_salary = 0.0;
double yearlyIncome = 0.0;
double taxableIncome = 0.0;
double netIncome = 0.0;
double taxesWitheld = 0.0;
double over100k = 0.0;
double over50k= 0.0;

SalariedEmployeeImpl(String first_name, String last_name, String job_title,
        int id, double monthly_salary) {
    this.first_name = first_name;
    this.last_name = last_name;
    this.job_title = job_title;
    this.id = id;
    this.monthly_salary = monthly_salary;
}

public String getFirstName() {

    return first_name;
}

public String getLastName() {

    return last_name;
}

public String getJobTitle() {

    return job_title;
}

public int getID() {

    return id;
}

public double getGrossYearlyIncome() {

    yearlyIncome = (monthly_salary * 12);

    return yearlyIncome;
}

public double getTaxableIncome() {

    taxableIncome = (monthly_salary*12);
    return taxableIncome;
}

    public double getTaxesWithheld() {

    double over100k = 0.0;
double over50k= 0.0;

    if(taxableIncome>100000.0){
        over100k = taxableIncome -100000.0;
        taxableIncome -=over100k;

    }
    if(taxableIncome >50000.0 && taxableIncome <=100000.0){
        over50k = taxableIncome-50000.0;
        taxableIncome -=over50k;

    }

        taxesWitheld = taxesWitheld + (.15 * over50k)+(.25 * over100k)+(.1*taxableIncome);

        return taxesWitheld ;
}
public double getNetYearlyIncome() {

    return yearlyIncome-taxesWitheld;
}
public double getMonthlySalary() {

    return monthly_salary;
}

public void setMonthlySalary(double salary) {
    this.monthly_salary = salary;

} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T01:26:09.570

您的函数`getGrossYearlyIncome`不仅仅是一个 getter 函数——它初始化`yearlyIncome`. 在您调用该函数之前，`yearlyIncome`其值为 0。但是，`getNetYearlyIncome`使用`yearlyIncome`但不调用`getGrossYearlyIncome`，因此`yearlyIncome`在第一次调用时未正确初始化。

`getTaxableIncome`与and有类似的问题——它们`getTaxesWithheld`不仅获取值，而且在调用时初始化成员字段。

# php - 使用 JavaScript 的 mousedown 事件

> ID：15994764
> 
> 赞同：0
> 
> 时间：2013-04-14T01:22:31.843
> 
> 标签：php, javascript, raspberry-pi, gpio

我正在处理的代码是，一旦我单击一个按钮，两个电机将连续旋转，直到我按下另一个按钮停止。我希望能够按住一个按钮来旋转电机，但是一旦放开那个按钮，电机就会停止。

**我的 remoteControl.php 文件的一部分：**

```
$action = $_GET['action'];
$pin = mysql_real_escape_string($_GET['pin']);
        if ($action == "forward"){
        $setting = "1";
        mysql_query("UPDATE pinStatus SET pinStatus='$setting' WHERE pinNumber='17';");
        mysql_query("UPDATE pinStatus SET pinStatus='$setting' WHERE pinNumber='22';");
        mysql_close();
        header('Location: remoteControl.php'); ..........
........
<form action="remoteControl.php" method="get">
<input id="forward" type="image" src="uparrow.jpg" IMG STYLE="position:absolute; TOP:150px; LEFT:170px; WIDTH:50px; HEIGHT:50px;">
<input type=hidden name="action" value="forward">
</form> 
```

**我正在尝试使用的 JavaScript：**

```
<head>
    <script type="text/javascript">
        function OnButtonDown (button) {
            "can't figure out what to put";
        }
        function OnButtonUp (button) {
            "can't figure out what to put";
        }

        function Init () {
            var button = document.getElementById ("forward");
            if (button.addEventListener) {  // all browsers except IE before version 9
                button.addEventListener ("mousedown", function () {OnButtonDown (button)}, false);
                button.addEventListener ("mouseup", function () {OnButtonUp (button)}, false);
            }
            else {
                if (button.attachEvent) {   // IE before version 9
                    button.attachEvent ("onmousedown", function () {OnButtonDown (button)});
                    button.attachEvent ("onmouseup", function () {OnButtonUp (button)});
                }
            }
        }
    </script>
</head>
<body onload="Init ()"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T15:06:05.280

鼠标按下时调用 OnButtonDown，鼠标抬起时调用 OnButtonUp。如果这是有效的，唯一的问题是你不知道在该功能上做什么才能用状态更新你的数据库（我想有某种控制器可以检查数据库上的状态并更新 GPIO状态）。

您需要调用文件 remoteControl.php（它需要一个 GET 参数来更新数据库）。这可以使用 jquery 中的 ajax 函数来完成。

```
<head>
<!-- First we include jquery library. In this case from Google CDN -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<script type="text/javascript">
    function OnButtonDown (button) {
        //We pass the parameter forward to remoteControl.php
         $.ajax({
            data:  action=forward,
            url:   'remoteControl.php',
            type:  'get',
            success:  function (response) {

            }
         });
    }
    function OnButtonUp (button) {
        //Here the same as in OnButtonDown but passing another parameter
    }

    function Init () {
        var button = document.getElementById ("forward");
        if (button.addEventListener) {  // all browsers except IE before version 9
            button.addEventListener ("mousedown", function () {OnButtonDown (button)}, false);
            button.addEventListener ("mouseup", function () {OnButtonUp (button)}, false);
        }
        else {
            if (button.attachEvent) {   // IE before version 9
                button.attachEvent ("onmousedown", function () {OnButtonDown (button)});
                button.attachEvent ("onmouseup", function () {OnButtonUp (button)});
            }
        }
    }
</script> 
```

# java - entityManager.find() 返回 null

> ID：15994776
> 
> 赞同：0
> 
> 时间：2013-04-14T01:24:24.337
> 
> 标签：java, find, derby, entitymanager

我正在使用 Derby 数据库，这是执行查找的实体

```
package ca.etsmtl.gti525.entity.presentation;

import ca.etsmtl.gti525.commun.CommunService;
import java.io.Serializable;
import java.util.Date;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.ManyToOne;
import javax.persistence.OneToOne;
import javax.persistence.Table;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;

/**
 * Remarque : peu importe la date et l'heure une représantation ce fait que dans une seul salle a la fois. (pour un même spectacle)
 * @author REDOUANE
 *
 */
@Entity
@Table(name = "SHOW_REPRESENTATION")
public class Representation implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "ID")
    private Long id;
    @Column(name = "DATE_DEBUT")
    @Temporal(TemporalType.DATE)
    private Date dateDebut;
//    @Column(name = "HEURE_DEBUT")
//    @Temporal(TemporalType.TIME)
//    private Calendar heureDebut;

    @Column(name = "NB_BILLETS_DISPO")
    private Integer nbBilletsDispo;
    @Column(name = "QTE_SELECTED")
    private Integer QTE=0;
    @Column(name = "PRIX")
    private Float prix;

    @OneToOne
    private Salle salle;

    @ManyToOne
    private Spectacle spectacle;

    @OneToOne(mappedBy = "representation")
    private Billet billet;

    public Integer getQTE() {
        return QTE;
    }

    public void setQTE(Integer QTE) {
        this.QTE = QTE;
    }

    public Billet getBillet() {
        return billet;
    }

    public void setBillet(Billet billet) {
        this.billet = billet;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public Spectacle getSpectacle() {
        return spectacle;
    }

    public void setSpectacle(Spectacle spectacle) {
        this.spectacle = spectacle;
    }

    public Integer getNbBilletsDispo() {
        return nbBilletsDispo;
    }

    public void setNbBilletsDispo(Integer nbBilletsDispo) {
        this.nbBilletsDispo = nbBilletsDispo;    
        //int min_ticket_allowed = nbBilletsDispo;
       // if (nbBilletsDispo >= 6) min_ticket_allowed = 6;
       // optionsQte2.clear();
       // for (int i=0; i< min_ticket_allowed +1; i++) optionsQte2.add(i);
    }

    public Float getPrix() {
        return prix;
    }
    public void setPrix(Float prix) {
        this.prix = prix;
    }

    public Date getDateDebut() {
        return dateDebut;
    }

    public void setDateDebut(Date dateDebut) {
        this.dateDebut = dateDebut;
    }
    public Salle getSalle() {
        return salle;
    }

    public void setSalle(Salle salle) {
        this.salle = salle;
    }

    public void verfierDispo(){
//      CommunService.addWarn("QTE !", ""+this.QTE);
      if(this.nbBilletsDispo<this.QTE){  
      CommunService.addWarn("ATTENTION !", "Le nombre de billets disponible est insuffisant");
      }

    }
} 
```

这是我的 dao 类，其中包含 find 方法

```
package ca.etsmtl.gti525.dao.presentation;

import ca.etsmtl.gti525.entity.presentation.Artiste;
import ca.etsmtl.gti525.entity.presentation.Billet;
import ca.etsmtl.gti525.entity.presentation.Representation;
import ca.etsmtl.gti525.entity.presentation.Salle;
import ca.etsmtl.gti525.entity.presentation.Spectacle;
import ca.etsmtl.gti525.entity.vente.Reservation;
import java.io.Serializable;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.Query;
import javax.persistence.criteria.CriteriaQuery;
import org.springframework.transaction.annotation.Transactional;

@Transactional
public class DaoJpaPresentation implements IDaoPresentation, Serializable {
    private static final long serialVersionUID = 1L;

    //l'ingection du "e-ticket-jpa-hibernate-PU"
    @PersistenceContext
    private EntityManager em;

    // liste des clients
    @Override
    public List<Artiste> getAllArtistes() {
        try {
            CriteriaQuery cq = em.getCriteriaBuilder().createQuery();
            cq.select(cq.from(Artiste.class));
            return em.createQuery(cq).getResultList();

        } catch (Exception ex) {
            //getLogger().log(Level.WARNING, "Exception lors de l''appel au service " + entityClass + " Impl.findAll {0} : ", ex.getMessage());
            return null;
        }
    }

    @Override
    public List<Spectacle> getAllSpectacle() {
        try {
            CriteriaQuery cq = em.getCriteriaBuilder().createQuery();
            cq.select(cq.from(Spectacle.class));
            return em.createQuery(cq).getResultList();

        } catch (Exception ex) {
            //getLogger().log(Level.WARNING, "Exception lors de l''appel au service " + entityClass + " Impl.findAll {0} : ", ex.getMessage());
            return null;
        }
    }

    @Override
    public List<Representation> getAllRepresentation() {
        try {
            CriteriaQuery cq = em.getCriteriaBuilder().createQuery();
            cq.select(cq.from(Representation.class));
            return em.createQuery(cq).getResultList();

        } catch (Exception ex) {
            //getLogger().log(Level.WARNING, "Exception lors de l''appel au service " + entityClass + " Impl.findAll {0} : ", ex.getMessage());
            return null;
        }
    }

    @Override
    public void createBillet(Billet billet) {
        try {
            em.persist(billet);
        } catch (Exception ex) {
            Logger.getLogger(DaoJpaPresentation.class.toString()).log(Level.SEVERE, ex.toString());
        }
    }

    @Override
    public Representation findRepresentation(Long id) {
        try {
            Query query;
            query = (Query) em.createQuery("SELECT a FROM Representation a  where a.id=:id");
            query.setParameter("id", id);

            return ((Representation) query.getSingleResult());
        } catch (Exception ex) {
            Logger.getLogger(DaoJpaPresentation.class.toString()).log(Level.SEVERE, ex.toString());
            return null;
        }
    }

    @Override
    public Salle findSalle(Long id) {
        return null;
    }

    @Override
    public Reservation findReservation(Long id) {
        return null;
    }

    @Override
    public void createRepresentation(Representation representation) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    public void createSalle(Salle salle) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    public void createSpectacle(Spectacle spectacle) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    public void createArtist(Artiste artist) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    public Representation findRepresentationByID(Long id) {
        try {
            return em.find(Representation.class, id);
        } catch (Exception ex) {
            //getLogger().log(Level.WARNING, "Exception lors de l''appel au service " + entityClass + " Impl.find {0} : ", ex.getMessage());
            System.out.print("Erreure ici au DAO");
            return null;
        }
    }
} 
```

这就是我如何调用该方法

```
Long idRep = panier.getIdRep();
                            bil.setRepresentation(this.daoPresentation.findRepresentationByID(idRep)); 
```

所以最后一行给了我一个空指针异常，因为 find 方法没有返回表示对象

```
java.lang.NullPointerException
    at ca.etsmtl.gti525.vente.ProcessPaiementControleur.save(ProcessPaiementControleur.java:103)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.el.parser.AstValue.invoke(AstValue.java:278)
    at org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:274)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.event.MethodExpressionActionListener.processAction(MethodExpressionActionListener.java:148)
    at javax.faces.event.ActionEvent.processListener(ActionEvent.java:88)
    at javax.faces.component.UIComponentBase.broadcast(UIComponentBase.java:769)
    at javax.faces.component.UICommand.broadcast(UICommand.java:300)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:947)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1009)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1852)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

我正在搜索，但当我执行这个 sql 查询时，它给了我正确的行

```
select * from APP.SHOW_REPRESENTATION a where a.id=4 
```

# javascript - 如何使用 Meteor.js 浏览器 Javascript 控制台？

> ID：15994786
> 
> 赞同：0
> 
> 时间：2013-04-14T01:25:57.267
> 
> 标签：javascript, meteor

启动新的 Meteor.js 项目。在 client.js 我把

```
var hi = "widget";

    if (Meteor.isClient()){
    ...
    } 
```

在我的浏览器控制台中，我输入：

```
>> hi
ReferenceError: hi is not defined
>> this.hi
undefined 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:31:23.607

它可能是本地范围的。

尝试：

```
var global = Function("return this")();
global.hi = "widget"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T17:00:59.580

好的，这最近在 0.6 版中发生了变化，似乎只是一个错误。如果您在 hi 的声明中删除 var，变量的范围将会改变，并且可以通过 JS 控制台访问。不过，这只是暂时的情况，可能会在未来的版本中得到修复。

> ID：15994787
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# c++ - ＃包括 在多个文件中

> ID：15994790
> 
> 赞同：6
> 
> 时间：2013-04-14T01:26:11.963
> 
> 标签：c++, include, iostream

我希望这个网站以前没有被问过。我无法从谷歌找到可靠的答案。

当您在项目的多个文件中#include iostream 时会发生什么？我总是在我的头文件中使用#ifndef 和#define。这是否会阻止 iostream 被多次包含？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T01:52:15.413

我对这个问题有两种解释：

1.  您可以`iostream`在同一个编译单元中包含多次吗？
    *   是的，安全。所有标准标头都包含防护装置，因此可以安全地使用。
2.  在你的代码中使用包含保护会防止`iostream`被多次包含吗？
    *   当然，它也会阻止编译器不止一次地看到介于`#ifndef`and之间的所有内容`#endif`（或在标有 的标头中，在支持它的编译器中）......这正是包含警卫所做的，对吧？`#pragma once`但这并不是真正需要的`#include <iostream>`，因为它已经防止了多个包含。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T01:31:49.623

就像 chris 和 Haroogan 说的，是的，他们会阻止这种情况发生。#ifndef 和 #define 是预处理器指令，用英文翻译成

#ifndef（如果未定义）

#define（定义）

因此，如果您创建一个标头，并 #include "myheader.h" 两次，那么该文件将不会被再次包含，因为您将它包含在一个 if 语句中，这将导致该文件仅在它有时被包含（和定义）尚未包括（定义）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T01:29:35.543

不管。即使您使用`ifndef`. 因为多个文件将被包含一次。并且所有尝试包括`<iostream>`但如果你打开`<iostream>`它有

```
#pragma once 
```

这基本上意味着它只会被包含一次。这不是避免我在行业中发现的多个包含的建议方法。因为更难知道它不会再次被包含在内。与在顶部和底部看到 ifndef 相比。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-25T09:47:39.117

```
#ifndef __IOSTREAM_H
#include <iostream>
#endif

... 
```

似乎大多数标准标头都有一种如上所述的包含保护。

或者，您可以通过定义所需的宏来制作自己的包含防护。

# php - 我的组件与 Auth 组件冲突

> ID：15994795
> 
> 赞同：0
> 
> 时间：2013-04-14T01:27:10.973
> 
> 标签：php, cakephp, facebook-php-sdk, cakephp-1.2

我决定将 Facebook 功能处理到一个组件中，我编写了以下代码来启动我自己的 Facebook 组件：

```
<?php
class FacebookComponent extends Object{
  var $name = 'Facebook';
 // var $components = array('Auth', 'Session');
  var $settings = array();
  var $controller = null;
  var $facebook;
  var $fbUid;

  function initialize(&$controller, $settings) {
    Configure::load('app.conf');
    App::import('Vendor', 'Facebook', array('file' => 'facebook/src/facebook.php'));
    $this->facebook = new Facebook(array(
        'appId' => Configure::read('FBappId'),
        'secret' => Configure::read('FBsecret')
    ));

    $this->fbUid = $this->facebook->getUser();  
  }

  function is_user(){
    if ($this->fbUid){
      return true;
    }
    else{
      return false;
    }   
  }
  function getLoginUrl(){
      return $this->facebook->getLoginUrl(array( 'scope' => 'publish_stream'));
    }

}

?> 
```

如果不使用 users_controller.php 中的上述组件，有关 auth 组件和用户控制器的登录操作的所有内容都可以正常工作。但是，只是通过 var $components 在 users_controller.php 的组件列表中添加我的 Facebook 组件，我发现登录操作的行为方式很奇怪：

```
function login(){       
      if (!$this->Auth->user()){
        if (empty($this->data['User']['username'])){         
          $this->Session->setFlash(__('You have to login', true), 'error_msg');
        }
        else{
          $this->Session->setFlash(__('bad login', true), 'error_msg');

        }

      }
      else{
        $this->Session->setFlash(__('correct login', true), 'done_msg');
      }
} 
```

当我尝试通过 Auth 组件访问任何控制器的任何受保护操作时，我会得到带有正确登录消息的登录页面，并在再次重新登录后重定向到网站的主页。

还有另一个症状，我有导航元素，如果用户登录，它会显示注销链接，除了登录页面，它不会在网站的任何部分显示此链接

```
<?php if ($session->read('Auth.User.id')): ?>
    <li><?php echo $html->link($html->image('close.png') . __('logout', true), array('controller' => 'users', 'action' => 'logout', 'admin' => false), array(), null, false); ?></li>
  <?php endif; ?> 
```

**我正在使用来自供应商的 CakePHP 1.2.10 和 Facebook PHP SDK (v.3.0.0)。我想确认没有该组件，一切都很好。有什么问题？**

# java - 在 servlet 的 init 参数中查找 JNDI 是个好主意吗？

> ID：15994804
> 
> 赞同：0
> 
> 时间：2013-04-14T01:29:14.697
> 
> 标签：java, performance, jakarta-ee, jdbc, jndi

我目前正在构建一个 Java EE Web 应用程序，并发现[这篇](http://www.javaworld.com/javaworld/jw-06-2004/jw-0628-performance.html?page=1)文章给了我一些关于如何构建一个更好的应用程序的很好的指导。第一个技巧是“**使用 HttpServlet init() 方法缓存数据**”。这听起来像是一个天才的想法，但现在我已经实现了自己的版本，我担心线程安全和保持连接打开。

1.  这个想法，以及我实现它的方式是线程安全的，以确保每个线程都有自己的数据库连接吗？
2.  我知道这需要在任何时候我想更改 JNDI 查找时重新启动 servlet，我对此没意见，但是除了在 JDBC 方法中进行 JNDI 查找还有其他缺点吗？
3.  我使用destroy方法关闭上下文变量的方式是一个聪明的想法，还是这不适用于大量线程或任何其他障碍？

这里有一些代码可以让您了解我是如何实现这个想法的。在我在我的 40 个其他 servlet 上实现它之前，我只是想要一些关于我的第一个实现的指导。非常感谢您的阅读。哦，如果有帮助的话，我也可以添加 dao 方法。

**Servlet 注释：**在 init 中，我只是调用了一个 bean，它完成了所有 JNDI 绒毛，以使其更容易添加到多个 servlet。然后在servelt中，我将数据源发送到要使用的dao方法。我还认为在启动时添加负载会很聪明，这样我就可以在启动服务器时查看 JNDI 是否立即工作。

```
@WebServlet(name="GetBoardPostCommenters", urlPatterns={"/getBoardPostCommenters"}, loadOnStartup = 1)
public class GetBoardPostCommenters extends HttpServlet
{
    private InstrideJndi jndi = null;
    private static final long serialVersionUID = 1L;

    public void init(ServletConfig servletConfig) throws ServletException
    {
        super.init(servletConfig);
        jndi = new InstrideJndi("GetBoardPostCommenters");
    }

    public void destroy()
    {
        jndi.closeConnection();
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException
    {
        BoardPost boardPost;

        boardPost = new BoardPost();
        boardPost.setId(Long.parseLong(request.getParameter("boardPostId")));
        boardPost = BoardPostCommentLikeDAO.getBoardPostCommenters(boardPost, jndi.getDataSource());

        request.setAttribute("likerCommenterList", boardPost.getCommenterList());
        request.getRequestDispatcher("WEB-INF/util/likerCommenterList.jsp").forward(request, response);
    }
} 
```

**Bean Notes：**控制器获取调用此方法以帮助调试的 servlet 的名称。关闭连接完成了我通常在 dao 方法的 finally 中所做的事情。

```
public class InstrideJndi
{
    private DataSource dataSource = null;
    private Context initialContext = null;
    private Context environmentContext = null;

    public InstrideJndi(String className)
    {
        try
        {
            this.initialContext = new InitialContext();
            this.environmentContext = (Context) initialContext.lookup("java:/comp/env");
            this.dataSource = (DataSource) environmentContext.lookup("jdbc/instride");
        }
        catch(NamingException error)
        {
            System.out.println("Error With JNDI Lookup -  " + className + " - " + error.getMessage());
            error.printStackTrace();
        }
    }

    public DataSource getDataSource()
    {
        return this.dataSource;
    }

    public void closeConnection()
    {
        if (initialContext != null) try{initialContext.close();} catch(NamingException ignore) {}
        if (environmentContext != null) try{environmentContext.close();} catch(NamingException ignore) {}
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T02:04:07.987

每个线程在此处***没有***自己的 DataSource 引用。您的 servlet 将是多个请求线程中的一个实例，每个线程调用`doGet()`. 相反，`init()`仅在 web 模块启动时调用，在 servlet 实例服务请求之前。

另一个提示 - 在一次查找中检索容器管理的资源是相当普遍的。

```
this.dataSource = new InitialContext().lookup("java:/comp/env/jdbc/instride"); 
```

我可能是错的，但我通常从不`close()`使用这些类型的 InitialContext 实例，除非我特别期望它是网络操作（ldap、从远程应用程序服务器查找资源等）。

# java - 如何暂停直到事件在activeMQ中发生

> ID：15994807
> 
> 赞同：0
> 
> 时间：2013-04-14T01:29:34.867
> 
> 标签：java, events, listener, activemq

我希望该方法等到侦听器的事件发生。我应该如何实现这一目标？在我的程序中，我想循环直到事件的结果满足某些条件，否则，我将无休止地发送请求

```
public void run(double r, double sigma, double strike, double s0, String t, int d) throws JMSException, InterruptedException {
  double actureError = 0.0;
  double epsilon = 0.00001;

  // iterate until the relative error rate is less than requested (converged)
  while ((actureError < epsilon) || (actureError > ESTIMATION_ERROR)) {
    sendRequest(r, sigma, strike, s0, t, d);

    Topic topic = session.createTopic("topic");
    MessageConsumer consumer = session.createConsumer(topic); 
    OptionMessageListener listener = new OptionMessageListener(task);
    consumer.setMessageListener(listener);

    double absoluteError = y * task.getSigma()
      / Math.sqrt(task.getCount());
    actureError = absoluteError / (task.getAvg() + epsilon);
  }

  return task.getAvg() * Math.exp(-r * 252);
}

public void sendRequest(double r, double sigma, double strike, double s0, String t, int d) throws JMSException {
  // send request to the client
  MessageProducer producer = session.createProducer(queue);
  OptionRequest request = new OptionRequest(r, sigma, strike, s0, t, d, null);
  ObjectMessage requestMessage = session.createObjectMessage(request);
  producer.send(requestMessage);
}

public class OptionMessageListener implements MessageListener {
  private Task task;

  public OptionMessageListener(Task task) {
    this.task = task;
  }

  @Override
  public void onMessage(Message message) {
    if (message instanceof ObjectMessage) {
      ObjectMessage objectMessage = (ObjectMessage) message;
      try {
        Result result = (Result) objectMessage.getObject();      
        double payout = result.getPayout();
        task.addPayout(payout);
      } catch (JMSException e) {
        e.printStackTrace();
      } 
    }
  }
} 
```

我是activeMQ的新手，谁能帮帮我？谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T10:14:26.193

创建一个设置为 1 的 CountDownLatch 并在主应用程序中等待它。然后，您可以在满足条件时让 onMessage 方法对闩锁进行倒计时。这还允许您在等待调用上设置超时值，以便您的应用程序可以唤醒并检查其是否需要关闭或执行其他工作等。

# php - 在 CakePHP 2 Paginator 中获取特定路由

> ID：15994809
> 
> 赞同：0
> 
> 时间：2013-04-14T01:29:50.283
> 
> 标签：php, cakephp

我有 4 条通往同一控制器/动作的路线。

```
Router::connect('/noticias/:id/:slug/*', array(
    'controller' => 'posts', 'action' => 'listing', 'admin' => false),
    array(
        'pass' => array('id','slug'),
        'id' => '[0-9]+',
        'slug' => '[a-zA-Z0-9_-]+'
    )
);

Router::connect('/servicos/:id/:slug/*', array(
    'controller' => 'posts', 'action' => 'listing', 'admin' => false),
    array(
        'pass' => array('id','slug'),
        'id' => '[0-9]+',
        'slug' => '[a-zA-Z0-9_-]+'
    )
);

Router::connect('/aplicacoes/:id/:slug/*', array(
    'controller' => 'posts', 'action' => 'listing', 'admin' => false),
    array(
        'pass' => array('id','slug'),
        'id' => '[0-9]+',
        'slug' => '[a-zA-Z0-9_-]+'
    )
);

Router::connect('/produtos/:id/:slug/*', array(
    'controller' => 'posts', 'action' => 'listing', 'admin' => false),
    array(
        'pass' => array('id','slug'),
        'id' => '[0-9]+',
        'slug' => '[a-zA-Z0-9_-]+'
    )
); 
```

但是，当我尝试为这些不同的路由生成分页时，CakePHP 只会为 routes.php 文件中的第一个（找到的）路由生成。

我怎样才能得到具体的路线？还是在 Paginator 中**手动设置路由？**

**什么**是最好的解决方案？创建 4 个动作？正则表达式？重定向？

* * *

```
<div class="paging right">
    <?php $this->Paginator->options(array(
        'url'=> array(
            'controller' => 'posts', 
            'action'     => 'listing',
            'id'         => $this->params->pass['0'],
            'slug'       => $this->params->pass['1'],
            'admin'      => false
        )
    )); ?>

    <?php echo $this->Paginator->prev('<' . __(''), array(), null, array('tag' => 'a', 'separator' => '')); ?>

    <?php echo $this->Paginator->numbers(array('separator' => '')); ?>

    <?php echo $this->Paginator->next(__('') . '>', array(), null, array('tag' => 'a', 'separator' => ''));  ?>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T06:59:04.517

所有 4 条路线的第二个参数数组都是相同的。那么你期望 cake 在反向路由时如何区分生成哪个 url 字符串呢？它将始终使用第一个匹配的。选择更好的、逻辑上可区分的路线。

# c# - 仅在经过一段时间后才执行某事

> ID：15994811
> 
> 赞同：0
> 
> 时间：2013-04-14T01:29:57.127
> 
> 标签：c#, events, time, timer, vote

这对我来说有点难以解释，但请看：

我做了一个 MMORPG 服务器启动器，它有一个开始按钮，当你点击它时会弹出一个小窗口，要求你投票给服务器，然后你可以再次点击开始来启动游戏（在你可以之前有 10 秒倒计时）实际开始游戏）

唯一的问题是投票网站每 12 小时只接受一个用户的投票（基于 IP 和 cookie），并且在有人投票一次后，每次你想开始时弹出那个小窗口并等待有点烦人游戏。

我的想法是：当有人点击打开投票窗口时，他的系统的日期和确切的时间 aer 被写入一个文件。

之后，每次您单击启动时，启动器都会读取该日期和时间，并计算自您上次投票以来是否已过去 12 小时，如果是，它会再次要求您投票，如果不是，它将跳过该部分并直接开始游戏。

我不是很有经验，我不知道从哪里开始以及如何进行这项工作，非常感谢您的帮助。

谢谢！

如果有帮助，这是我的活动。

```
 private void btnStart_Click(object sender, EventArgs e)
    {
        var voteForm = new VoteWindow();
        voteForm.Show();
        voteForm.BringToFront();
        this.Enabled = false;
    } 
```

这是我实际开始游戏的代码。

```
 private void btnStart2_Click(object sender, EventArgs e)
    {
        string error1 = "Deleted because it was too long...";
        string title1 = "Deleted because it was too long...";

        if (File.Exists("engine.exe"))
        {
            Process.Start("engine.exe", "/load /config debug");
            Application.Exit();
        }
        else
        {
            MessageBox.Show(error1, title1, MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:03:53.660

只需使用`Properties.Settings`. 您可以通过转到`Solution Explorer`然后展开`Properties`和打开来创建新设置`Settings.Settings`。在此页面上，您可以创建一个新`System.DateTime`对象。然后你会做这样的事情。

```
private void btnStart_Click(object sender, EventArgs e)
{
    TimeSpan ts = DateTime.Now - Properties.Settings.Default.MySetting;

    if (ts.TotalHours > 12)
    {
        Properties.Settings.Default.MySetting = DateTime.Now;
        Properties.Settings.Default.Save();

        var voteForm = new VoteWindow();
        voteForm.Show();
        voteForm.BringToFront();
        this.Enabled = false;
    }
} 
```

# actionscript-3 - 区分变量

> ID：15994812
> 
> 赞同：0
> 
> 时间：2013-04-14T01:30:42.370
> 
> 标签：actionscript-3, flash-cs5

```
var gridArray:Array = new Array(7);
   gridArray[0] = [4,2,1,1,2,3,1];
   gridArray[1] = [2,2,1,4,2,1,2];
   gridArray[2] = [1,2,1,2,1,1,2];
   gridArray[3] = [2,2,2,5,1,1,2];
   gridArray[4] = [1,2,2,1,1,1,2];
   gridArray[5] = [1,1,2,2,2,2,2];
   gridArray[6] = [2,1,2,3,1,1,2];

    for (var i:int=0; i<gridArray.length; i++)
    {
      for (var u:int=0; u<gridArray[i].length; u++)
      {  
        var tile:MovieClip = new Tile();
        tile.gotoAndStop(gridArray[i][u]);
        tile.x = (u-i);
        tile.y = (u+i);
        addChild(tile);
      }
    }

tile.addEventListener(MouseEvent.ROLL_OVER, mouseover); 
```

所以上面是在一个生成网格的for循环中。它在一个名为 Main 的类中。影片剪辑 Tile 有 5 个帧，其中包含不同的内容。我在 Tile 类中有一个名为 hp 的变量，我在其中分配了一个数字。

```
if (currentFrame == 1)
{
  hp = 10;
}
else if (currentFrame == 2)
{
  hp = 20;
}
else if (currentFrame == 3)
{
  hp = 30;
}
else if (currentFrame == 4)
{
  hp = 40;
}
else if (currentFrame == 5)
{
  hp = 50;
} 
```

我通过使用鼠标翻转事件来跟踪瓷砖的 hp，但结果我只得到 10 个（这意味着它在第 1 帧上），即使我的数组有不同的帧。下面是我的鼠标悬停功能

编辑：

```
function mouseover(event:MouseEvent)
            {
                trace(event.currentTarget.currentFrame, Tile.hp);
            } 
```

如何跟踪每个单独的图块？我正在考虑将 currentframe 添加到 Tile.hp，但这似乎不起作用。

# ruby-on-rails - 在 rspec，user.invoices.count 说 0 但它显示它有模型

> ID：15994813
> 
> 赞同：1
> 
> 时间：2013-04-14T01:31:17.720
> 
> 标签：ruby-on-rails, rspec

我正在构建用户 rspec 测试。我有许多与用户关联的发票。在控制台中，当我执行 user.invoices 时，它会显示发票的哈希值。但是，当我执行 user.invoices.count 以获取该用户的发票数量时，它显示为 0。这是我的代码：

```
 before(:each) do
    @user = FactoryGirl.build(:user)

    @invoice = FactoryGirl.build(:invoice)
    @invoice.issue_date = "2013-01-01"
    @user.invoices << @invoice 
```

然后如果我在那里放一个调试器，它会说 count = 0。这是输出：

```
(rdb:1) p user.invoices
[#<Invoice id: nil, user_id: 279, issue_date: "2013-01-01", due_date: nil, payment_term: "Net 15", discount: nil, created_at: nil, updated_at: nil, client_id: 140, client_invoice_id: 1, custom_message: nil, sent_to: nil, status: nil, public_id: "1234", grand_total: nil, user_name: nil, company_name: nil, custom_email_message: nil, address_line_one: nil, address_line_two: nil>, 
 #<Invoice id: nil, user_id: 281, issue_date: "2013-01-01", due_date: nil, payment_term: "Net 15", discount: nil, created_at: nil, updated_at: nil, client_id: 141, client_invoice_id: 1, custom_message: nil, sent_to: nil, status: nil, public_id: "1234", grand_total: nil, user_name: nil, company_name: nil, custom_email_message: nil, address_line_one: nil, address_line_two: nil>, 
 #<Invoice id: nil, user_id: 283, issue_date: "2012-01-01", due_date: nil, payment_term: "Net 15", discount: nil, created_at: nil, updated_at: nil, client_id: 142, client_invoice_id: 1, custom_message: nil, sent_to: nil, status: nil, public_id: "1234", grand_total: nil, user_name: nil, company_name: nil, custom_email_message: nil, address_line_one: nil, address_line_two: nil>, 
 #<Invoice id: nil, user_id: 285, issue_date: "2011-01-01", due_date: nil, payment_term: "Net 15", discount: nil, created_at: nil, updated_at: nil, client_id: 143, client_invoice_id: 1, custom_message: nil, sent_to: nil, status: nil, public_id: "1234", grand_total: nil, user_name: nil, company_name: nil, custom_email_message: nil, address_line_one: nil, address_line_two: nil>]
(rdb:1) p user.invoices.count
0 
```

为什么计数不能正常工作？这是我试图通过的测试：

```
 it "should return the correct count of all invoices in the specified year" do
   # there are two invoices in 2013
   user = @user
   user.count_of_invoices_by_year("2013", :total).should == 2
 end 
```

count_of_invoices_by_year 使用 .count 并且无法正常工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T03:02:53.300

这是因为发送 .count 使用 COUNT(*) 查询数据库。由于您使用的是 FactoryGirl.build，因此数据库中没有记录，因此它返回 0。

另请参阅： [http](http://rhnh.net/2007/09/26/counting-activerecord-associations-count-size-or-length) : //rhnh.net/2007/09/26/counting-activerecord-associations-count-size-or-length 其中解释了 .size、.length 和 .count 之间的区别。

编辑：这是测试您的方法的方法（这会将记录保存到数据库中，但在测试后它们将被销毁）

```
before(:each) do
  @user = FactoryGirl.create(:user)

  @invoice = FactoryGirl.create(:invoice)
  @invoice.issue_date = "2013-01-01"
  @invoice.save
  @user.invoices << @invoice
  @user.save 
```

# php - 创建一个没有重复元素的数组

> ID：15994816
> 
> 赞同：0
> 
> 时间：2013-04-14T01:32:10.887
> 
> 标签：php

我想创建一个没有重复元素的数组。我一开始创建了一个空数组，但是在 PHP 中这样做是没有意义的。更好的方法？

表格1：

```
Id Name 
```

表2：

```
Id Year PROJECT DURATION
1  2012  A      3
1  2012  B      2 
```

获取数据：

```
$sql = $mysqli->prepare(SELECT Name, 
            Table1.Id, 
            Year
            FROM Table1 JOIN Table2 
            WHERE Table1.Id=Table2.Id
            ORDER BY Id);
$sql->execute();
$result = $sql->get_result();

$Id[]=array();

while($row = $result->fetch_assoc()){

    if (!in_array($row["Id"], $Id)){
        $Id[]=$row["Id"];
        ...
    }
} 
```

我不使用 DISTINCT 因为我需要 all和`year`之后的条目。我可以更改数据库。如何修改和使用table2中的唯一ID？感谢您的建议。`project``duration`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:36:41.873

试试这个 PHP 函数：

[http://php.net/manual/en/function.array-unique.php](http://php.net/manual/en/function.array-unique.php)

听起来如果你想使用 PHP，它会做你想做的事。否则，请按照 @zerkms 的建议在 SQL 中使用 DISTINCT 关键字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T02:02:46.513

我会说它不完全是重复的，因为 OP 可能不知道集合数据结构，这是许多语言中可用的概念，但 Stack Oveflow 中还有另一个问题：

[内置对 PHP 集合的支持？](https://stackoverflow.com/questions/8127384/built-in-support-for-sets-in-php)

解释一下，集合数据结构是一种保存其他元素（如数组）的数据类型，但保证它们在集合中是唯一的，通常保证插入、删除和搜索的复杂度较低（O(1) 或 O(log N ），具体取决于实现）。

从链接看起来，PHP 最接近集合（及其复杂性保证）是使用数组的索引键来存储数据，而不是在数组本身中。

但是，如果您不担心复杂性（如果您的数据集太大或执行过多的插入/删除/搜索，则不建议使用），您可以使用`array_unique`，如链接中所述。

# javascript - 使用 innerHTML 文本的 Javascript 表单验证不会消失

> ID：15994821
> 
> 赞同：2
> 
> 时间：2013-04-14T01:33:11.973
> 
> 标签：javascript, html

在我的 html 表单中，当一个字段留空并执行 Javascript 时，会使用 innerHTML 显示一条错误消息。但是，在为该字段使用允许的输入后，另一个字段为空白，该消息不会消失。如果我刷新页面，字段中的所有信息都会保留，但 innerHTML 消息会消失。单击计算按钮并执行Javascript后，有没有办法使错误消息消失？就像让它重新检查并以某种方式将消息带走一样。

这是我的html代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <title>The Happy Hoppin' Hotel</title>
    <link type="text/css" rel="stylesheet" href="happyhoppin_skeleton.css" />
    <script src="happyhoppin_skeleton.js" language="javascript" type="text/javascript"></script> 
  </head>
    <body>
        <form>
            <h1>The Happy Hoppin' Hotel Checkout Page</h1>
            <p>Fill out the form below to calculate balance due</p>
            Guest ID Number: <input type="text" id="custID" /><div id="guestID"> </div>
            Room Type: 
            <select id="roomType" />
                <option></option>
                <option>Double</option>
                <option>Single</option>
                <option>Parlor</option>
            </select><div id="room"> </div>
            Length of Stay: <input type="text" id="stayLength" name="" /><div id="stay"> </div>
            Number of Drinks: <input type="text" id="drinkNum" name="" /><div id="drink"> </div>
            Number of Towels: <input type="text" id="towelNum" name="" /><div id="towel"> </div>
            Number of Flushes: <input type="text" id="flushNum" name="" /><div id="flush"> </div>
            Bug Complaints?:  <label><br>
            <input type="radio" id="radio" name="bugComplaint" value="Yes" onclick="getCheckedRadio(this)" />Yes<br>
            <input type="radio" id="radio" name="bugComplaint" value="No" onclick="getCheckedRadio(this)" />No

            <div id="comments">Customer Comments: 
            <textarea name="customerComment" id="comments" onFocus="this.value=''" value="Make me disappear" cols="50" rows="5">Enter your comments here...</textarea> 
            </div>
            <input type="button" onclick="calculateFinalBill()" value="Calculate">
        </form>
    </body> 
</html> 
```

这是我的 Javascript 代码：

```
const doublePrice = 150;
const singlePrice = 100;
const parlorPrice = 80;
const drinkPrice = 5;
const towelPrice = 3;
const flushPrice = 1;

var custID;
var roomPrice;
var stayLength;
var drinkNum;
var towelNum;
var flushNum;
var totalDue;
var subtotal;
var roomType;
var bugDiscount;

function calculateFinalBill() {
    validateForm();
    if(roomType == "Double"){
    roomPrice = doublePrice;
    }

    if(roomType == "Single"){
    roomPrice = singlePrice;
    }

    if(roomType == "Parlor"){
    roomPrice = parlorPrice;
    }

    roomTotal = roomPrice * stayLength

    towelTotal = towelPrice * towelNum

    flushTotal = flushPrice * flushNum

    drinkTotal = drinkPrice * drinkNum

    subtotal = roomTotal + towelTotal + flushTotal + drinkTotal

    totalDue = subtotal - bugDiscount

    displayBill();
}

function getCheckedRadio(which){
var bugValue = which.value;
    if (bugValue == "No"){
    bugDiscount = 0;
    }
    if (bugValue == "Yes"){
    bugDiscount = 20;
    }
}

function validateForm(){
custID = parseInt(document.getElementById("custID").value);
if(isNaN(custID)){
    document.getElementById('guestID').innerHTML="*Guest ID must be a number"
    throw "stop execution";
}

if(custID <= 0){
    document.getElementById('guestID').innerHTML="*Guest ID must be greater than zero"
    throw "stop execution";
}

roomType = document.getElementById("roomType").value;
if(roomType == ""){
    document.getElementById('room').innerHTML="*Room type must be selected"
    throw "stop execution";
}

stayLength = parseInt(document.getElementById("stayLength").value);
if(isNaN(stayLength)){
    document.getElementById('stay').innerHTML="*Length of Stay must be a number"
    throw "stop execution";
    }
if(stayLength < 0){
    document.getElementById('stay').innerHTML="*Length of Stay must be greater than zero"
    throw "stop execution";
}

drinkNum = parseInt(document.getElementById("drinkNum").value);
if(isNaN(drinkNum)){
    document.getElementById('drink').innerHTML="*Number of Drinks must be a number"
    throw "stop execution";
    }
if(drinkNum < 0 || drinkNum > 25){
    document.getElementById('drink').innerHTML="*Number of Drinks must be 0-25"
    throw "stop execution";
}

towelNum = parseInt(document.getElementById("towelNum").value);
if(isNaN(towelNum)){
    document.getElementById('towel').innerHTML="*Number of Towels must be a number"
    throw "stop execution";
    }
if(towelNum < 0){
    document.getElementById('towel').innerHTML="*Number of Towels must be zero or greater"
    throw "stop execution";
}

flushNum = parseInt(document.getElementById("flushNum").value);
if(isNaN(flushNum)){
    document.getElementById('flush').innerHTML="*Number of Flushes must be a number"
    throw "stop execution";
    }
if(flushNum < 0){
    document.getElementById('flush').innerHTML="*Number of Flushes must be zero or greater"
    throw "stop execution";
}

customerComment = document.getElementById("customerComment");
}

function displayBill(){
var newPage =  "<html><head><title>Billing Summary</title></head>"; //Add CSS after title
    newPage += "<body><h1>Happy Hoppin Hotel</h1>";
    newPage += "<h2>Guest Billing Summary</h2>";
    newPage += "Guest Identification: " + custID;
    newPage += "<br />";
    newPage += "Room Type: " + roomType;
    newPage += "<br />";
    newPage += "Length of Stay: " + stayLength;
    newPage += "<br />";
    newPage += "Room Charge: $" + roomTotal;
    newPage += "<br />";
    newPage += "Drink Charge: $" + drinkTotal;
    newPage += "<br />";
    newPage += "Towel Charge: $" + towelTotal;
    newPage += "<br />";
    newPage += "Flushing Charge: $" + flushTotal;
    newPage += "<br />";
    newPage += "Subtotal: $" + subtotal;
    newPage += "<br />";
    if(bugDiscount != 0)
    {
    newPage += "Discount: $" + bugDiscount;
    newPage += "<br />";
    }
    newPage += "Total Due: $" + totalDue;
    newPage += "<br />";
    newPage += "Come back and visit us again at the Happy Hoppin' Hotel"

var j = window.open('','','width=400,height=500');
j.document.write(newPage);
j.document.close();

} 
```

这可能有助于直观[http://jsbin.com/ifuxiv/1/edit](http://jsbin.com/ifuxiv/1/edit) 如果您单击计算，在访客 ID 中输入一个值，然后再次单击计算，您将看到“访客 ID 必须是数字”消息不会消失。

如果我的问题令人困惑或需要任何其他信息，请在拒绝我的问题之前询问。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:40:52.603

这可以通过在验证开始时重置错误消息来简单地解决：

```
document.getElementById('guestID').innerHTML='';
document.getElementById('room').innerHTML='';
document.getElementById('stay').innerHTML='';
document.getElementById('drink').innerHTML='';
/// and so on. 
```

然而，最好以更干燥的方式处理这个问题（不要重复自己），或者创建用于设置每个错误消息的通用方法，或者至少存储对每个错误输出元素的 var 引用，`var gID = document.getElementById('guestID');`这意味着你可以轻松地写`gID.innerHTML`在任何你需要的地方，并且可以节省重新搜索 DOM。

# windows - 在 Windows 命令行上伪造标准输入

> ID：15994824
> 
> 赞同：9
> 
> 时间：2013-04-14T01:33:49.553
> 
> 标签：windows, cmd, evernote

我想使用[Evernote 的 ENScript.exe](http://dev.evernote.com/documentation/local/chapters/windows.php#enscript)创建新笔记，输入文本和标题作为参数。问题是 ENScript 只允许通过文件或标准输入输入文本。

对于我当前的解决方法，我使用 .bat 文件将参数写入文件，然后使用`/s`指向文件的参数调用 ENScript 以将其读入，但这会强制将默认标题设为临时文件的文件名（我不这样做的行为想）。

所以我的问题是：有没有办法在 Windows 命令行上“伪造”标准输入，以便我可以使用参数（从另一个程序传递）来生成注释文本？脚本的开头类似于

```
ENScript.exe createNote /i %1 
```

标准输入如下。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-14T12:02:37.990

您正在寻找一种管道操作，它捕获一个命令的输出并将其作为输入发送到下一个命令。这是大多数操作系统中的标准功能。

Windows CMD 的管道符号是`|`

您的脚本可能很简单：

```
@echo %~2|@ENScript.exe createNote /i %1 
```

如果您的脚本名为 MakeNote.bat，您可以这样称呼它

```
MakeNote "your title" "This is the text of your note" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:45:11.713

可以使用重定向“伪造”标准输入：

```
command args... < filename args... 
```

其中`<`表示输入重定向（“从文件名读取标准输入`<`而不是终端”）。

（请注意，旧的 Windows 或 DOS 程序可能会直接从终端读取，从而使输入重定向无用；希望这不适用于最近的 Evernote 程序。）

对于您的示例：

```
ENScript.exe < "%1" 
```

随意在重定向之前或之后添加更多参数。例如，如果您的脚本将被称为`script filename title`，您将需要调用`ENScript /i "%2" < "%1"`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-16T15:56:22.433

```
echo Note text>Title&ENScript.exe createNote /s Title 
```

# c - 在 C 中使用 strsep 和 fwrite 时出现奇怪的输出

> ID：15994826
> 
> 赞同：1
> 
> 时间：2013-04-14T01:34:32.597
> 
> 标签：c, string, file, fwrite, strsep

我打算制作一个 python 程序来读取 XML 文档并在执行操作时将其用作参考。但是，手动创建 XML 文档会很乏味，所以我决定编写一个 C 程序来完成大部分工作，不包括第一行和根元素。这是代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
int main(){
    FILE * fp = fopen("/Users/rajshrimali/Desktop/SPC_CMS.txt", "r");
    FILE * fw = fopen("/Users/rajshrimali/Desktop/SPC_XML", "a");
    char *line = NULL;
    size_t linecap = 0;
    ssize_t linelen;
    while ((linelen = getline(&line, &linecap, fp)) > 0){
        char *token;
        int x = 1; 
        while((token = strsep(&line, ",")) != NULL){
            printf("%s", token);
            if(x == 1){
                fwrite("<item> \n", linelen, 1, fw);
                fwrite("<name> \n", linelen, 1, fw);
                fwrite(token, linelen, 1, fw);
                fwrite("\n </name> \n", linelen, 1, fw);
                x++; 
            }
            if(x == 2) {
                fwrite("<SPC> \n", linelen, 1, fw);
                fwrite(token, linelen, 1, fw);
                fwrite("\n </SPC> \n", linelen, 1, fw);
                fwrite("</item> \n", linelen, 1, fw);
            }
        }
    }
} 
```

编译的代码没有错误。但是，当我运行它时，文件 SPC_XML 几乎不正确：

```
<item> 
�&lt;na<name> 

 <Agate�0.80

 </name> 
�&lt;SPC> 

 </Agate�0.80

 </SPC> 
<</item> 
,�&lt;item> 
<na<name> 
```

这种胡说八道持续了一段时间。输入文件`fp`具有以下格式的数据：

```
Agate,0.80
Aluminum bronze,0.436
Aluminum,0.87
Antimony,0.21
Apatite,0.84 
```

我*认为*错误出在 fwrite 上，尽管我不知道它是什么。问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:37:04.750

您的`if`语句有一些明显的错误，`=`当您应该使用`==`相等时，您正在使用赋值，例如：

```
 if(x = 1) 
```

应该：

```
if(x == 1) 
```

我建议打开警告，与`-Wall -W -pedantic`您一起使用 gcc 会看到如下内容：

```
warning: suggest parentheses around assignment used as truth value [-Wparentheses]
         if(x = 1){ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T01:41:59.507

当您调用`fwrite`时，第二个参数应该是您正在编写的字符串的长度。所以，当你这样做时：

```
fwrite("<item> \n", linelen, 1, fw); 
```

你最终会写额外的数据，或者可能不够，这取决于是什么`linelen`。相反，您应该手动计算字符串的大小或调用`strlen`每个字符串。所以，上面的调用可以变成：

```
fwrite("<item> \n", 8, 1, fw); 
```

当你写出令牌时，你应该调用`strlen`：

```
fwrite(token, strlen(token), 1, fw); 
```

# javascript - Three.js 自定义几何问题与旋转

> ID：15994828
> 
> 赞同：2
> 
> 时间：2013-04-14T01:34:40.577
> 
> 标签：javascript, three.js, webgl

我刚刚开始使用 Javascript，特别是three.js。我有一个自定义几何图形，我用它来创建一个三棱柱。它产生了正确的形状，但是当它旋转时，一些面看起来不正确。其他内置几何图形（CubeGeometry、CylinderGeometry ...）工作得很好。它与我的自定义几何图形有关还是与照明有关？还是网格或材质？

这是正在发生的事情的一个例子的小提琴：[3D Shapes Fiddle](http://jsfiddle.net/JLKCU/1/ "3D 形状小提琴")

以下是相关代码：

```
function getTriPrismGeometry(){
    var geometry = new THREE.Geometry()

    geometry.vertices.push( new THREE.Vertex(new THREE.Vector3( -100,  100, 0 )) );
    geometry.vertices.push( new THREE.Vertex(new THREE.Vector3( -100, -100, 0 ) ));
    geometry.vertices.push( new THREE.Vertex(new THREE.Vector3(  100, -100, 0 )) );
    geometry.vertices.push( new THREE.Vertex(new THREE.Vector3( -100,  100, -100 )) );
    geometry.vertices.push( new THREE.Vertex(new THREE.Vector3( -100, -100, -100 ) ));
    geometry.vertices.push( new THREE.Vertex(new THREE.Vector3(  100, -100, -100 )) );

    geometry.faces.push( new THREE.Face3(0,1,2 ) );
    geometry.faces.push( new THREE.Face3(3,4,0 ) );
    geometry.faces.push( new THREE.Face3( 0, 1, 4 ) );
    geometry.faces.push( new THREE.Face3( 1, 4, 5 ) );
    geometry.faces.push( new THREE.Face3( 1, 2,5) );
    geometry.faces.push( new THREE.Face3( 2, 0, 3 ) );
    geometry.faces.push( new THREE.Face3( 2, 3, 5 ) );
    geometry.faces.push( new THREE.Face3( 3,4, 5 ) );

    geometry.computeCentroids();
    geometry.computeFaceNormals();
    geometry.computeVertexNormals();

    init(geometry, true);
}

function init(geometry, isCustom) {

    camera = new THREE.PerspectiveCamera( 75, width/height, 1, 10000 );
    camera.position.z = 300;

    scene = new THREE.Scene();

    material = new THREE.MeshLambertMaterial( { color: 0xff0000  } );
    mesh = new THREE.Mesh( geometry, material );

    if (isCustom){
        material.side = THREE.DoubleSide;
        mesh.doubleSided = true;
    }

    scene.add( mesh );

    ambient = new THREE.AmbientLight( 0x101010 );
    ambient.position.set(0, -70, 100).normalize();
    scene.add( ambient );

    directionalLight = new THREE.DirectionalLight( 0xffffff );
    directionalLight.position = camera.position;
    scene.add( directionalLight );;

}

function animate() {

    // note: three.js includes requestAnimationFrame shim
    requestAnimationFrame( animate );

    render();
}
function render(){
    var delta = Date.now() - start;

    directionalLight.position = camera.position;

    //mesh.position.y = Math.abs( Math.sin( delta * 0.002 ) ) * 150;
    mesh.rotation.x = delta * 0.0003;
    mesh.rotation.z = delta * 0.0002;

    renderer.render( scene, camera );

} 
```

我对 three.js 非常陌生，尤其是 3D 渲染，非常感谢任何帮助。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T07:22:56.867

在您的自定义几何图形中，您需要按逆时针顺序指定面顶点。

通过该修复，您的自定义几何图形就可以了。

另外，从当前的 three.js 示例中学习。您的代码使用过时的模式。例如，`Vertex`已弃用。这种新模式是：

```
geometry.vertices.push( new THREE.Vector3( -100, 100, 0 ) ); 
```

[http://jsfiddle.net/JLKCU/3/](http://jsfiddle.net/JLKCU/3/) - three.js r.54

# ruby-on-rails - 如何设置图片库的样式以允许同时作为链接的纵向和横向图片

> ID：15994831
> 
> 赞同：0
> 
> 时间：2013-04-14T01:35:07.950
> 
> 标签：ruby-on-rails, ruby-on-rails-3, css

我试图弄清楚如何设置图片库的布局。图库包含链接到各个图片的缩略图。图像可能是纵向或横向的。我正在努力弄清楚如何设置缩略图库以适应两种可能的布局。

我一直在寻找，并找到了两种方法，每种方法都能让我得到我想要的一半。现在的问题是：我如何得到我想要的一切。

因此，这适用于获取链接。

标记：

```
<% @pics.each do |pic| %>
  <div class="thumbnail">
     <%= link_to (image_tag pic.url), pics_path(pic: single_image(pic)) %> 
  </div>
<% end %> 
```

CSS：

```
.thumbnail {
  margin: 30px;
} 
```

这适用于显示横向和纵向图像。

在标记中：

```
<div style="width:200px; 
            height:200px;
             background: url(<%= single_image(pic) %>) no-repeat center;"> 
```

（我很想把这个样式从标记中去掉。感觉很脏，但我有动态生成的内容）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:09:11.997

您可以轻松地将宽度和高度放入 css 文件中。为此，您需要向图像添加一个 id 或类，因此它会像这样：

```
<%= link_to (image_tag pic.url), pics_path(pic: single_image(pic)), class: "class-name" %> 
```

CSS看起来像这样：

```
.class-name {
     width: 200px;
     height: 200px;
 } 
```

或者，如果您的 div 是缩略图 div，您的 css 将如下所示：

```
.thumbnail {
   margin: 30px;
   width: 200px;
   height: 200px;
} 
```

问题来自背景图像。您不能将动态代码`<% sing_image(pic) %>`放入样式表中。您可能想查看这篇 SO 帖子：[在 Rails 应用程序中从数据库中提取 CSS 资产（如背景图像）？](https://stackoverflow.com/questions/6359413/pulling-css-assets-like-background-images-from-the-database-in-a-rails-app).

或者您可以考虑不将其设置为背景图像。而是将标记（使用与上述相同的 css）更改为如下所示：

```
<% @pics.each do |pic| %>
  <div class="thumbnail">
     <%= link_to pic do %>
        <%= image_tag pics_path(pic: single_image(pic), :class => 'img-styling') %> 
     <% end %>
  </div>
<% end %> 
```

在 css 中，您可以添加：

```
.img-styling {
   your styling here
} 
```

这对你有帮助吗？

# node.js - 在 NodeJS 中测试长时间运行的任务

> ID：15994833
> 
> 赞同：2
> 
> 时间：2013-04-14T01:36:08.220
> 
> 标签：node.js, rest

我的 NodeJS 项目有一些长期运行的任务，我正在该项目上构建一个 RESTful 接口。

我想测试我的 REST 接口是否可以继续被访问，在运行时间较长的任务正在执行时提供状态更新。

在多线程环境中，这很容易测试，因为您只需让一个线程休眠一段时间，因为您的 HTTP 控制器在另一个线程中运行。这在 NodeJS 中显然是不可能的（由于单线程）:)

我可以存根任务，但是如何让存根“等待”一段时间而不阻塞线程，以便我可以访问 REST 端点并获取状态更新？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T01:57:49.153

假设您指的是 CPU 绑定的长时间运行任务。

解决此问题的最佳方法是将 CPU 绑定任务发送到子进程。您可以使用[child_process](http://nodejs.org/api/child_process.html#child_process_example_sending_server_object)包。

有了`child_process`它，您可以生成新进程并通过管道与它们通信。让您的子进程期望标准输入上的数据并将结果写入标准输出。

您的 Node 进程可以在另一个进程中生成所有 CPU 绑定任务，同时继续为网络请求提供服务。

您还应该查看[worker-farm](https://github.com/rvagg/node-worker-farm)软件包。

# javascript - 使用 javascript 和 ajax 请求从控制器实现逻辑

> ID：15994836
> 
> 赞同：0
> 
> 时间：2013-04-14T01:36:52.637
> 
> 标签：javascript, ruby-on-rails, ajax

在我的 Rails 应用程序中，当他查看某个帖子时，我将某个用户添加到读者列表中。

**PostsController#Show**

```
@post = Post.find(params[:id])
if (current_user)
  @post.reader_links.create(reader_id: current_user.id)
end 
```

但是，我想从客户端实现这一点，使用 javascript 和 ajax 请求。该功能将稍作更改，以便仅当用户**输入某种形式（按一个键）时，他才会被添加到列表中。**

所以原来的代码会被**posts/show.erb.html中的如下代码代替**

```
function typeCatch(){
  $(this).off("keypress",typeCatch)//remove handler
  //I WANT TO ADD THE USER TO THE LIST AT THIS POINT
}

$("#field_id").on("keypress",typeCatch) 
```

我需要一些帮助来实现 javascript 中的原始功能并通过 ajax 请求发布。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T03:00:34.863

这行中的一些东西：

```
# on a controller
def update_links
  @post = Post.find(params[:id])
  if (current_user)
    @post.reader_links.create(reader_id: current_user.id)
  end
end

// on your javascript
function typeCatch(){
  $(this).off("keypress",typeCatch)//remove handler
  $.post('/path/to/controller/post_id/action')
 }

 $("#field_id").on("keypress",typeCatch) 
```

请注意，javascript 不应该是您的新操作的答案，而必须在触发创建新阅读器链接事件的页面中。

如果您不知道自己在做什么，我建议您阅读@FlufflyJack 在您的问题中评论的链接

# java - Joda Time - 获取时区名称？

> ID：15994843
> 
> 赞同：11
> 
> 时间：2013-04-14T01:38:40.790
> 
> 标签：java, jodatime

我的时区是 UTC+03:00。它存储在 DateTimeZone 对象中。我如何将其转换为它的真实名称，即[东非时间/EAT](http://en.wikipedia.org/wiki/UTC+03:00)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-11-12T18:21:25.683

使用 joda，可以获得时区缩写或名称，如下所示

```
DateTimeZone dz = DateTimeZone.forID("America/New_York");
String tzid = dz.getShortName(DateTimeUtils.currentTimeMillis());
//tzid will be 'EST'

String longerTimeZoneName = dz.getName(DateTimeUtils.currentTimeMillis());
//longerTimeZoneName  will be 'Eastern Standard Time' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-14T21:00:34.730

使用方法[TimeZone#getDisplayName()](http://docs.oracle.com/javase/6/docs/api/java/util/TimeZone.html#getDisplayName%28%29)

```
DateTimeZone tz = //...  
tz.toTimeZone().getDisplayName(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-04T18:25:06.890

我无法在 JodaTime 中找到任何可以给出可读性好的名称。根据我的经验， DateTimeZone.getName() 返回 id 而不是更有用的名称。所以我只能得到“America/New_York”，而不是“东部标准时间”。

TimeZone.getDisplayName 的建议似乎假设您使用的是 Java 中的 TimeZone，而不是 Joda。我看不到 JodaTime 的 getDisplayName()。

# c++ - 我应该把这个方法放在哪个类？C++

> ID：15994849
> 
> 赞同：0
> 
> 时间：2013-04-14T01:40:26.777
> 
> 标签：c++, class, object, inheritance, implementation

我正在制作基于 Nethack 的 Rogue Like 游戏。我需要决定最好的班级来放置在地牢中导航的方法。现在我实现移动的方式是简单地向**播放器**询问字符输入。（使用 W、A、S、D 作为箭头）。我设置了一段时间，所以它循环直到触发字符结束程序。在这个循环中，它从打印地牢的状态开始。要求输入字符，然后是 if 语句以检查输入的字符。在每个 if 语句中，它将调用一个相对于要移动的输入/方向的方法。所以我将拥有：moveUp()、moveRight() 等等。我只需要弄清楚哪个类最适合放置这些方法，这将决定如何调用这些方法、传递什么以及很快。

我将以粗体列出这些类，并用缩进表示继承。这是我参与的课程：

*   **实体**：基类。它本质上代表任何/所有对象
    *   **生物**：基本上代表地牢中的一个活的“东西”
        *   **玩家**：基本上是一个扩展的生物.. 这是谁在玩的类。
    *   **Item**：作为任何被视为 Item 的东西的基类
        *   **武器**：武器..
        *   **盔甲**：一件盔甲..
        *   **消耗品**：可以消耗的物品..还有其他几个类别

我还有一些独立课程：

*   **Tile**：“游戏板”上的一个空间。它拥有一个指向 Creature 的 ptr、指向 Items 的指针向量和一个显示该空间所代表内容的字符。
*   **DungeonLevel**：这是单个关卡的游戏板/网格。它有一个**Tile**对象的 2D 矢量。

我已经有地牢生成正确，什么不是。对于每个**DungeonLevel**对象，所有的**Tiles**都将保持在同一个位置。因此，当**玩家**或**生物**移动（1 个位置）时，程序将调用这些方法来操作**DungeonLevel**对象（**Tile 的**2D 向量），通过将玩家/生物从 Tile 传递到 Tile 来反映它们移动到的位置。然后程序重新开始循环。

我不确定将这些方法放在哪个类中。我基本上需要 Creatures 和 Player 才能移动。玩家根据字符输入移动。游戏中生成的生物/怪物将向玩家移动 1 个空间（如果可能）。

所以我不确定我是否应该使用相同的方法来控制任何**实体**，或者**DungeonLevel**是否应该控制移动，或者 Creature 基类和派生的 Player 类应该有相同的移动方法，或者 Creature 是否应该有自己的移动方法并且 Player 应该有自己的。

建议？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:05:28.927

因为你在做一个 2d 游戏。我假设您正在使用opengl。或直接。

用于移动地牢的瓷砖。我建议你不要移动它们。而是移动“相机”，有很多关于 opengl 和 directx 的书籍来了解渲染的工作原理。这样你需要做的所有事情。检查哪些图块在屏幕上或不在屏幕上，只在屏幕上绘制。

至于决定谁应该控制什么。玩家控制他自己的动作是合乎逻辑的。但具有允许外部类移动他的功能。不允许直接访问他的私人信息，因为他们不是朋友；）。

现在看看你的课程应该如何布置。很难明确回答这个问题。但从所呈现的。

像这样看，玩家和生物以及物品都继承自实体。他们都需要有什么共同点？他们都需要一个职位。函数能够获取和设置它们的位置。他们的轮换。也许是一个名字来识别它们。以及处理发生在他们身上的任何动作的更新函数？这就是虚函数派上用场的地方。

因为你可以`virtual void Update(int a_iDeltaTime);` 在你的基类中拥有。并且从它继承的所有东西都有自己的更新类型。即播放器检查按键。而敌人只更新他们的旋转和移动。

编辑：这样你就可以存储你所有敌人的玩家物品。作为实体*，当您调用更新时，因为它是虚拟的。它会根据它真正的类型调用正确的更新。这意味着您只需要 1 个列表来存储游戏中的每种类型的实体。结尾。

这样你就可以把它们之间共享的所有东西都放在基类中。并且只将独特的东西放在主类中。

我所说的一切都只是建议，因为您的实施应该最适合您面临的确切问题。只有通过实践才能更好地了解在哪里使用什么实现，正如前面提到的，你应该明确地了解更多关于设计模式的知识，因为它会让你对编写代码的方式敞开心扉。并允许您编写更简单易读的代码。希望这可以帮助。

# javascript - 带有构造函数的 Javascript 模块

> ID：15994850
> 
> 赞同：0
> 
> 时间：2013-04-14T01:40:38.193
> 
> 标签：javascript, oop

我有一个 javascript 对象，它通常需要用 5 个以上的变量进行初始化，我不认为每次创建对象时为每个变量使用一堆设置器`new Person`会很好。也许是构造函数？如何将构造函数放入我的模块对象中？我找到了一个如何在 javascript 中编写构造函数的示例，但我不确定它是否适合该对象的设计方式：[Constructors in JavaScript objects](https://stackoverflow.com/questions/1114024/constructors-in-javascript-objects)

我希望能够用变量初始化每个人以设置人的私人信息：

```
var p = new Person(a, b, c, d, e); 
```

我的对象：

```
var Person = (function() {

    // private

    var name;
    var gender;
    var weight;
    var location;

    return {
        // public
        myfunc: function() {

        }
    }

})(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:45:32.010

像这样：

```
function Person(a,b,c,d,e) {
    this.name = a;
    this.gender = b;
    this.weight = c;
    this.location = d
    this.whatever = e;

}
Person.prototype.myName = function () { return this.name; }
Person.prototype.myGender = function () { return this.gender; }

var p = new Person("John", "male", 180, "USA", "Something");
p.myName();
p.myGender(); 
```

这使用了 JS 的内部对象和继承模型，因此您可以设置单个对象的唯一变量，而只指定/创建一次 in-comman 函数和方法，然后“Person”对象的所有实例都将使用这些

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:56:27.313

```
var Person = function(name) {
    var gender = "male";

    this.changeName = function(newName) {
        name = newName;
    };

    this.displayName = function() {
        return "<p>" + name + "</p>";
    };

    this.displayGender = function() {
        return "<p>" + gender + "</p>";
    };
}

var bart = new Person("Bart");
document.body.innerHTML = bart.displayGender(); 
```

该解决方案基于“闭包”继承模型（[http://javascript.crockford.com/private.html](http://javascript.crockford.com/private.html)）

关于原型继承模型，请参考 SReject 的解决方案。请注意，它不允许真正的私人成员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T03:05:58.010

此模式将为您提供封装的数据（隐藏字段），并让您轻松控制如何公开访问它们：

```
var PersonFactory = {    
    create: function (nm, gn, wt, loc) {
        var name = nm,
            gender = gn,
            weight = wt,
            location = loc;

        return function (method, arg) {
            if (method === 'isName') {
                if (name === arg) {
                    return true;
                } else {
                    return false;
                }
            } else if (method === 'isFemale') {
                if (gender === arg) {
                    return true;
                } else {
                    return false;
               }
            }

        }
    }
};

var chris = PersonFactory.create("Chris", "male", 210, "Pluto");
chris('isName', 'Chris'); // returns true
var jane = PersonFactory.create("Jane", "female", 160, "Alpha Centauri");
jane('isName', 'Jane'); // returns true
jane('isName', 'Chris'); // returns false 
```

我希望这就是你要找的。请记住，只有函数对象可以隐藏数据，这还不错，因为您可以使用 immaFunciton('methodName', 'args') 模式以非常简单的方式访问该数据。

祝你好运，奇尔斯

# java - 运行 java 应用程序时出现 noClassDeffound 错误的原因是什么？

> ID：15994853
> 
> 赞同：-2
> 
> 时间：2013-04-14T01:40:53.463
> 
> 标签：java, noclassdeffounderror

当我运行我的程序时，我收到以下错误，我不知道这个错误是什么意思？有没有人有任何想法？

```
java.lang.NoClassDefFoundError: program/pkg7/Program7 
java.lang.ClassNotFoundException: program.pkg7.Program7
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: programja.pkg7.Program7\.  Program will exit.
Exception in thread "main" Java Result: 1
BUILD SUCCESSFUL (total time: 0 seconds) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:01:11.657

你的问题有些可疑。诊断显示两个不同的例外：

```
java.lang.NoClassDefFoundError: program/pkg7/Program7 
java.lang.ClassNotFoundException: program.pkg7.Program7 
```

然后底部的消息说：

```
Could not find the main class: programja.pkg7.Program7\.  Program will exit. 
```

请注意，程序名称不同。

但是忽略不一致（由错误的复制和粘贴引起的？），最可能的原因是以下之一：

*   您尝试启动的类的完全限定名称不是“program.pkg7.Program7”......而是（我猜）“pkg7.Program7”
*   启动命令时执行类路径不正确，导致JVM无法定位到该类。（类路径告诉 Java 在哪里寻找它需要加载的类。）

在没有您提供有关如何运行程序的更多信息的情况下，我可以建议您*仔细*阅读有关类路径如何工作的 Oracle 文档：

*   [“设置类路径”](http://docs.oracle.com/javase/6/docs/technotes/tools/windows/classpath.html)
*   [路径和类路径](http://docs.oracle.com/javase/tutorial/essential/environment/paths.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T02:02:00.163

好的，这可能是你的问题。

您的**Program7**类具有名为**program.pkg7**的包。你正在pkg7目录中执行**java** **Program7**

解决方案是：

回到你编译的类根目录并运行如下：

```
java -classpath . program.pkg7.Program7 
```

问候，拉维

# asp.net-mvc - WebAPI + Forms Authentication + SimpleMembershipProvider 在不应该使用 WindowsIdentity 时使用

> ID：15994857
> 
> 赞同：13
> 
> 时间：2013-04-14T01:41:28.113
> 
> 标签：asp.net-mvc, security, authentication, asp.net-web-api

**我做了什么**

我正在构建一个 REST 风格的 WebAPI 应用程序。我正在尝试在这里实现表单身份验证，因此客户端可以允许用户从浏览器登录/注册/注销。我正在使用 simpleMembership，用户存储在我的应用程序的 simpleMembership 数据库表中。作为第一步，我在我的 AccountsController 中实现了一个登录方法：

```
 [System.Web.Http.HttpPost]
    public HttpResponseMessage LogIn(LoginModel model)
    {
        if (ModelState.IsValid)
        {
            if (User.Identity.IsAuthenticated)
            {
                return Request.CreateResponse(HttpStatusCode.Conflict, "already logged in.");
            }
            if (WebSecurity.Login(model.UserName, model.Password, persistCookie: model.RememberMe))
            {
                FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe);
                //TODO: look up by id, not by name
                var userProfile = _service.GetUser(WebSecurity.GetUserId(model.UserName));
                return Request.CreateResponse(HttpStatusCode.OK, userProfile);
            }
            else
            {
                return new HttpResponseMessage(HttpStatusCode.Unauthorized);
            }
        }

        // If we got this far, something failed
        return new HttpResponseMessage(HttpStatusCode.InternalServerError);
    } 
```

**问题**

这是正在发生的事情：

1.  我在`if (User.Identity.IsAuthenticated)`.
2.  使用 POSTMan 或 Fiddler 之类的东西，我尝试使用一些伪造的凭据登录。
3.  正如预期的那样，我打断点并为 IsAuthenticated 获得“假”。
4.  我跳到下一个“如果”，尝试登录失败，正如预期的那样。
5.  语句中的代码`else`被命中，但一旦返回，1）我的断点再次被命中，2）主体设置为我的 windows 身份。两者都是出乎意料的，我正试图弄清楚如何纠正它。

![在此处输入图像描述](https://i.stack.imgur.com/6Psc9.png)

**预期行为**

*   该方法只返回 401 Unauthorized，因为我的应用程序数据库中不存在虚假用户。

**配置**

我*认为*这是一个配置问题 - 在身份验证失败时，由于某种原因，主体会自动设置为我的 Windows 帐户。与我的配置相关的一些细节：

```
<authentication mode="Forms">
  <forms loginUrl="~/" timeout="2880" />
</authentication> 
```

*   我没有在应用程序的任何地方启用 Windows 身份验证。我的 web.config 在上面 ^
*   使用 IISManager 我已禁用匿名身份验证
*   在我的 applicationhost.config 中，我禁用了 Windows 和匿名身份验证

**问题**

1.  为什么断点被击中两次，而不是 LogIn 方法只返回 Unauthorized ，因为最后一个“else”被击中？
2.  为什么我的 Windows 凭据被用于这个意外和不希望的“环回”？
3.  我怎样才能防止这种情况发生？或者：
4.  我需要使用 MessageHandler 来设置主体吗？如果是这样，这对 [Authenticate] 和 IsAuthenticated 有何影响？有什么例子吗？

**更新 1**

我尝试注册以下处理程序：

```
public class PrincipalHandler : DelegatingHandler
    {

        protected async override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request,
                                                                               System.Threading.CancellationToken
                                                                                   cancellationToken)
        {
            HttpContext.Current.User = new GenericPrincipal(new GenericIdentity(string.Empty), null);
            Thread.CurrentPrincipal = HttpContext.Current.User;
            return await base.SendAsync(request, cancellationToken);
        }

    } 
```

现在主体从未设置为我的 Windows 身份。从 POSTMan（浏览器扩展），if 语句被击中两次，我得到一个弹出窗口，要求提供凭据。正如预期的那样，从 Fiddler 那里，我得到了 401 Unauthorized。

**新问题**

1.  如何根据响应 cookie 中的内容设置主体，并针对我的应用程序的简单成员表进行身份验证？

**更新 2**

这篇文章似乎让我朝着正确的方向前进——在我的 LoginMethod 中使用 Membership 而不是 User：

[ASP.NET MVC - 设置自定义 IIdentity 或 IPrincipal](https://stackoverflow.com/questions/1064271/asp-net-mvc-set-custom-iidentity-or-iprincipal)

将继续更新进展，但我仍然愿意接受建议/建议。

**更新 3** 我从来没有像现在这样既放松又生气——这里不需要自定义处理程序。我的项目属性中启用了 Windows 身份验证。登录和注销的工作解决方案在这里，并且与我的会员表“一起工作”：

```
public HttpResponseMessage LogIn(LoginModel model)
        {
            if (ModelState.IsValid)
            {
                if (User.Identity.IsAuthenticated)
                {
                    return Request.CreateResponse(HttpStatusCode.Conflict, "already logged in.");
                }
                if (WebSecurity.Login(model.UserName, model.Password, persistCookie: model.RememberMe))
                {
                    FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe);
                    return Request.CreateResponse(HttpStatusCode.OK, "logged in successfully");
                }
                else
                {
                    return new HttpResponseMessage(HttpStatusCode.Unauthorized);
                }
            }

            // If we got this far, something failed
            return new HttpResponseMessage(HttpStatusCode.InternalServerError);
        }

public HttpResponseMessage LogOut()
        {
            if (User.Identity.IsAuthenticated)
            {
                WebSecurity.Logout();
                return Request.CreateResponse(HttpStatusCode.OK, "logged out successfully.");
            }
            return Request.CreateResponse(HttpStatusCode.Conflict, "already done.");
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T19:18:47.587

您是否使用 IIS Express 进行开发？如果是这样，请在 Visual Studio 中单击您的项目并检查属性窗口。这里有一个用于 Windows 身份验证的选项，我相信它默认是启用的。在这里也禁用它。

# python - Pylint - 如何打印 Pylint 的 sys.path？

> ID：15994860
> 
> 赞同：4
> 
> 时间：2013-04-14T01:42:05.423
> 
> 标签：python, pylint, sys.path

我正在尝试将模块添加到我的 Pylint 路径中，以便可以使用[此问题中看到](https://stackoverflow.com/questions/1899436/pylint-unable-to-import-error-how-to-set-pythonpath)的解决方案来导入它们。不幸的是，我希望在使用此解决方案后可以导入的模块似乎仍然不存在。我想检查我尝试添加到 Pylint 的路径是否实际添加。有没有一种简单的方法可以打印出 Pylint 的 sys.path？非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T10:31:56.273

Pylint 应该`PYTHONPATH`以与 Python 解释器相同的方式使用。如果不是，它可能被视为一个错误并被报告为这样。

您可能想`pylint --init-hook 'print(sys.path)'`在首先显示其 Python 路径时尝试运行 pylint。

# html - 如何将字符串从 XHTML 页面中的 Java 小程序传递到托管 bean

> ID：15994862
> 
> 赞同：0
> 
> 时间：2013-04-14T01:42:20.310
> 
> 标签：html, jsf-2, xhtml, javabeans, glassfish-3

因此，正如建议的那样，我正在扩展我之前的问题以获取打开我的网页的系统的用户名，然后相应地验证该用户。多亏了一些有用的建议，经过长时间的阅读和测试，我设法编写了一个非常简单的 Java Applet，我将它嵌入到 login.xhtml 页面中。但是，现在我被困在下一个适当的步骤中，以便将 java 小程序获取的用户名传递给登录托管 bean。允许我的网页根据系统的用户名对用户进行身份验证，而用户实际上不必将他的用户名放在 login.xhtml 页面中。与此同时，我试图寻找下一个合适的步骤，我觉得我的理解在上下左右。我能选择的最好的方法是，现在为了将从 java 小程序中获取的用户名传递给登录 bean，我将不得不编写 JavaScript？但我不确定这是否真的是必需的，或者还有另一个适当的步骤可以更优雅地处理这个问题。请原谅我对这方面的知识有限。

**根据答案进行的更新**

**Java 小程序代码**

```
 import java.applet.Applet;

    public class SSOApplet extends Applet {

        /**
         * 
         */
        private static final long serialVersionUID = 1L;
        String sysUser = null;

        public String getSystemUsername() {
            try {
                sysUser = System.getProperty("user.name");
                return sysUser;
            } catch (Exception e) {
                System.out.println(e);
                return null;
            }

        }

    public void sendToJs() {
        String name = getSystemUsername();
        System.out.println("sendTOJS picked this username of user" + name);
        try {
            JSObject window = JSObject.getWindow(this);
            window.call("updateServer", new Object[] {name});
        } catch (JSException jse) {
            jse.printStackTrace();
        }
    }
    } 
```

**我的 login.xhtml 中的代码片段**

```
<script type="text/javascript">
    function updateServer(name) {
        document.getElementById('username').value = name;
        document.getElementById('button').click();
    }
</script>
    <object>
            <param name="myApplet" value="SSOApplet.class" />
        </object> 
```

如果有人可以建议下一个适当的步骤，那将非常有帮助。提前非常感谢！

**UserDaoBean 控制器类**

```
public boolean validateUser(String username) {
        try {

            String checkUser = (String) entityManager
                    .createQuery(
                            "select u.username from User u where u.username =:username")
                    .setParameter("username", username).getSingleResult();
            System.out.println("User found in database: " + checkUser);

            if (checkUser.equalsIgnoreCase(username)) {
                System.out.println("Loggin sucessful!");
                return true;
            }
        } catch (NoResultException e) {
            System.out.println("No result found in database");

            return false;
        }
        return false;

    } 
```

**登录托管 Bean**

```
@ManagedBean(name = "loginBean")
@RequestScoped
public class LoginBean implements Serializable {

    /**
     * 
     */
    private static final long serialVersionUID = 1L;

    @EJB
    private UserDaoBean uDB;
    @EJB
    private UserGroupDaoBean uGDB;
    private User userId;

    SSOApplet myapplet = new SSOApplet();

    public String username = myapplet.getSystemUsername();

//  private String username;

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public String login() {
        FacesContext context = FacesContext.getCurrentInstance();
System.out.println("JS sent this username" + username);
        if (uDB.validateUser(username)) {
            userId = uDB.findUser(username);

            context.getExternalContext().getSessionMap().put("userId", userId);
            if (uGDB.validateGroup(userId)) {
                return "home.jsf?faces-redirect=true&amp;includeViewParams=true";
            }
            return "normalHome.jsf?faces-redirect=true&amp;includeViewParams=true";

        } else {
            FacesMessage message = new FacesMessage();
            message.setSeverity(FacesMessage.SEVERITY_ERROR);
            message.setSummary("Username doesn't exists! OR User is trying to login from someone else's account");
            context.addMessage("", message);
            return null;
        }
    } 
```

**控制台中打印的消息**

信息：JS 发送此用户名null 信息：在数据库中未找到结果信息：警告：FacesMessage(s) 已入队，但可能尚未显示。sourceId=[severity=（错误2），summary=（用户名不存在！或用户正在尝试从其他人的帐户登录），detail=（用户名不存在！或用户正在尝试从其他人的帐户登录)]

**在 Bean 中调用 Applet 后出现异常**

```
WARNING: StandardWrapperValve[Faces Servlet]: PWC1406: Servlet.service() for servlet Faces Servlet threw exception
java.lang.ClassNotFoundException: netscape.javascript.JSException
    at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1509)
    at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1359)
    at beans.LoginBean.<init>(LoginBean.java:31)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at java.lang.Class.newInstance0(Class.java:372)
    at java.lang.Class.newInstance(Class.java:325)
    at com.sun.faces.mgbean.BeanBuilder.newBeanInstance(BeanBuilder.java:188)
    at com.sun.faces.mgbean.BeanBuilder.build(BeanBuilder.java:102)
    at com.sun.faces.mgbean.BeanManager.createAndPush(BeanManager.java:409)
    at com.sun.faces.mgbean.BeanManager.create(BeanManager.java:269)
    at com.sun.faces.el.ManagedBeanELResolver.resolveBean(ManagedBeanELResolver.java:244)
    at com.sun.faces.el.ManagedBeanELResolver.getValue(ManagedBeanELResolver.java:116)
    at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176)
    at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203)
    at com.sun.el.parser.AstIdentifier.getValue(AstIdentifier.java:103)
    at com.sun.el.parser.AstValue.getTarget(AstValue.java:149)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:237)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T07:17:36.930

最简单的方法是利用`JSObject`类，它允许 Java 与来自 Applet 的 JavaScript 进行通信，以使用您的字符串作为参数调用 JavaScript 函数，该函数将完成更新服务器端托管 bean 的工作。

# 1.小程序到JavaScript部分

在您的小程序中引入以下方法：

```
public void sendToJs() {
    String name = getSystemUsername();
    try {
        JSObject window = JSObject.getWindow(this);
        window.call("updateServer", new Object[] {name});
    } catch (JSException jse) {
        jse.printStackTrace();
    }
} 
```

# 2\. JavaScript 更新

```
function updateServer(name) {
    document.getElementById('username').value = name;
    document.getElementById('button').click();
} 
```

# 3\. JSF 视图到 JSF 支持 bean

```
<h:form prependId="false">
    <h:inputHidden id="username"/>
    <h:commandButton id="button" style="display:none">
        <f:ajax execute="@form/>
    </h:commandButton>
</h:form> 
```

您可以注意到，如果使用 Primefaces（查找`<p:remoteCommand>`）和 jQuery 之类的 JS 库，代码会更少。另请注意，用户名可以通过 POST/GET 直接从 applet 发送到例如特殊的专用 servlet 进行处理（查找 Apache 的`HttpClient`）。

# android - 单击Android时如何让我的文件管理器应用程序启动文件？

> ID：15994864
> 
> 赞同：0
> 
> 时间：2013-04-14T01:42:55.160
> 
> 标签：android

我正在开发基本文件管理器，但无法启动文件。我有它，所以当您单击一个文件夹时它会打开，但是当单击一个文件时如何让它启动一个文件？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T02:01:07.600

对于视频或音频，您可以像这样启动文件，

```
Intent intent = new Intent();
intent.setAction(android.content.Intent.ACTION_VIEW);
File file = new File("/sdcard/test.mp4");
intent.setDataAndType(Uri.fromFile(file), "video/*");
startActivity(intent); 

Intent intent = new Intent();
intent.setAction(android.content.Intent.ACTION_VIEW);
File file = new File("/sdcard/test.mp3");
intent.setDataAndType(Uri.fromFile(file), "audio/*");
startActivity(intent); 
```

对于其他类型的文件，您可以通过 MimeTypeMap ( [http://developer.android.com/reference/android/webkit/MimeTypeMap.html](http://developer.android.com/reference/android/webkit/MimeTypeMap.html) ) 获取其 MIME 类型。

# ruby-on-rails - 使用 Devise on Grape API 进行 Ajax 登录

> ID：15994866
> 
> 赞同：2
> 
> 时间：2013-04-14T01:43:00.687
> 
> 标签：ruby-on-rails, ruby, ajax, api, authentication

我有一个使用 Grape 和 Devise 构建的 rails 应用程序来进行身份验证。该应用程序的范围是向 JavaScript 前端提供 API（所以这里根本没有 ERB）。

添加类 api 的 Warden/Devise 相关帮助程序部分后 < Grape::API 看起来像这样

```
resource :ticket do
    desc "Returns all tickets for a the requesting user; for admins, returns all tickets."
    get :all do
        authenticated_user
            @all_tickets = Ticket.where(user_id: current_user.id)
        end
    end
end 
```

它工作得很好，它调用“authenticated_user”，如果返回用户登录，它返回数据。如果不是，则返回 401 - Unauthorized（使用 ajax 调用请求 json 响应）。用户当然必须先到[http://domain.com/users/sign_in](http://domain.com/users/sign_in)登录。然后它将重定向到可以进行所有这些调用的应用程序页面。

现在，为了应用程序流程，我需要让登录表单基于 ajax。从用户在应用程序中的任何时间开始。

我已经按照教程[Ajax Login with Devise](http://jessehowarth.com/2011/04/27/ajax-login-with-devise)和许多其他人进行了操作。但这对我来说更有意义。但是我得到了非常奇怪的结果。

考虑以下 JavaScript 代码：

```
$('#login').click(function (e) {
$.ajax({
    url: 'http://api.domain.com/users/sign_in?',
    type: 'post',
    data: {remote: true, commit: "Sign in", utf8: "✓", user: {remember_me: 0, password: "12345678", email: "admin@domain.com"}},
    format: "json",
    xhrFields: { withCredentials: true },
        success: function (data) {
            console.log(data);
        }
    });     
}); 
```

请注意，我使用 cors/rack 来执行跨域调用。有2种情况：

1 - 当我拨打这个电话时，我得到状态 200 OK。但是，cookie 集不足以执行需要身份验证的 api 调用。因此，api 调用返回 401 - 未经授权。

2 - 如果我将“remember_me”设置为 true（或 0），然后单击登录按钮，它将第一次返回 200OK。它不会随请求发送 cookie（因为在我退出时还没有 cookie）。响应标头中带有 rails cookie，响应为 200 OK。

然而，在那次调用之后，我第二次点击登录按钮，它返回“302 临时移动”，然后另一个请求命中 domain.com/ - 之后我通过了身份验证。当我进行需要身份验证的 API 调用时，将返回数据。这次发送了 cookie（从第一次登录尝试中获得），并在响应标头中返回了另一个 cookie。这个和我发的不一样，我认为是因为 CSRF。每次发送 cookie 时，都会用新的令牌返回一个新的 cookie。

在执行 API 调用时，我必须使用 "xhrFields: { withCredentials: true}" 以便能够随请求发送 cookie，以便设计可以验证 API 调用者。因此，如果我使用默认的 Devise 表单登录，则数据会轻松返回。

另一种选择是沿着请求发送 CSRF 令牌（从 HTML 的元数据中获取），但正如我上面解释的那样，我正在构建一个客户端 JS 客户端，并且页面不会从 rails 本身呈现。

有没有办法使用 ajax 使用 Devise 登录，而不必拨打两次电话？

提前致谢！DD

# pear - 在 Uniserver 上安装 phpdocumentor

> ID：15994868
> 
> 赞同：0
> 
> 时间：2013-04-14T01:43:41.930
> 
> 标签：pear, phpdoc

当我使用 Uniserver 8.8.1 提供的 PEAR Web 界面安装 phpdocumentor 时，我得到通常的“Downloading...”，然后是下载完成消息。然后，什么也没有发生。

接下来我需要做什么？

快速浏览这些软件包表明该程序尚未安装。

我尝试使用不同的浏览器、重新启动计算机并使用 pear.phpdoc.org 频道。

编辑：

当我尝试从命令行安装它时，我得到以下信息：

> 警告：require_once(PEAR.php)：打开流失败：第 21 行的 Config.php 中没有这样的文件或目录 y
> 
> 警告：require_once(PEAR.php)：打开流失败：第 21 行的 C:\UniServer\home\us_pear\PEAR\PEAR\Config.php 中没有这样的文件或目录 y
> 
> 致命错误：require_once()：无法在 C:\UniServer\home\us_pea r\PEAR\PEAR\ 中打开所需的“PEAR.php”（include_path='C :\Coral_8_7_3\z_test_1\UniServer\home\us_pear\PEAR'）第 21 行的 Config.php

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T22:43:32.083

使用“pear.bat”命令行实用程序而不是 Web 界面。它会给你更好的错误信息。

* * *

您的 PEAR 安装已损坏。通过下载并执行重新安装它`go-pear.phar`。

# iphone - cocos2d/cocosbuilder 的Bug：为什么timeline 0(sequenceId) 会自动运行？

> ID：15994875
> 
> 赞同：1
> 
> 时间：2013-04-14T01:45:38.543
> 
> 标签：iphone, ios, cocos2d-iphone, cocosbuilder

这是我的工具：`CocosBuilder-2.1/CCBReader-2.1/cocos2d-iphone-2.0`

我创建了`TestNode.ccb`（根对象是 CCNode），在其中我创建了 2 个时间线，`@"t0name"`（2s 长）和`@"t1name"`（2s 长），根节点设置为自定义类`TestNode`

我创建了`TestNode.h`：

```
#import "CCBAnimationManager.h"

@interface TestNode : CCNode <CCBAnimationManagerDelegate>{

}
@property (nonatomic, assign) BOOL condition;
@property (nonatomic, assign) BOOL t1Played;

-(void)playAnimation:(NSString *)name;
-(void)playAnimation;

@end 
```

这是`TestNode.m`：

```
#import "TestNode.h"
#import "CCBReader.h"

@implementation TestNode

@synthesize condition;
@synthesize t1Played;

-(void)playAnimation:(NSString *)name{
    CCBAnimationManager* animationManager = self.userObject;
    [animationManager runAnimationsForSequenceNamed:name];
}

-(void)playAnimation{
    if(self.condition==YES) {
        [self playAnimation:@"t1name"];
        self.t1played=YES;
    }else{
        [self playAnimation:@"t0name"];
    }
}

-(void)didLoadFromCCB{
    CCBAnimationManager* animationManager = self.userObject;
    animationManager.delegate = self;
}

-(void)completedAnimationSequenceNamed:(NSString *)pName{
    if (self.t1played==YES) {
        NSLog(@"t1played");
    }else{
        [self playAnimation];
    }
}

@end 
```

还有一个主层（`TestScene.h/.m`），在这个场景中我会添加`CCNode`一些其他的东西......

正常情况：

在主层的`onEnter(`) 中，我添加了一个实例`TestNode`并命名为 playAnimation，根据上面的代码，命名的时间线`@"t0name"`将永远播放，实际发生的情况与我的假设相同。

奇怪的情况：在主层中`onEnter()`，我添加了一个实例`TestNode`并调用它`playAnimation`，并调度了一个函数`[self schedule:@selector(changeTestNodeCondition) interval:1.0];`this function( `changeTestNodeCondition`)只是将`TestNode`'条件设置为YES，根据上面的代码，`@"t0name"`将播放一次名为的时间线（`t0'`长度为2s )，然后命名的时间线`@"t1name"`将播放一次，然后控制台将打印“t1played”，一切都停止了，但发生的事情是：

1.  时间线命名`@"t0name"`播放一次
2.  时间线命名`@"t1name"`播放一次
3.  控制台打印“t1played”
4.  时间线命名`@"t0name"`再次播放
5.  控制台再次打印“t1played”

为什么会发生第 4 步？它导致`completedAnimationSequenceNamed:(NSString *) name`再次调用并再次控制台打印“t1played”（步骤 5）

我检查了`TestNode.ccb`，两个时间线都没有链接的时间线，两个时间线都未选中自动播放，`@"t0name"`有`sequenceId 0`，`@"t0name"`有`sequenceId 1`，`timeline 0`自动播放？？？为什么？？？

我做了另一个有趣的实验：我将时间轴`@"t0name"`序列 ID 更改为 1，将时间轴`@"t1name`序列 ID 更改为 2（直接使用任何文本编辑器编辑 ccb 文件），发生以下事情：

1.  名为@“t0name”的时间线播放了一次
2.  名为@"t1name" 的时间线播放了一次
3.  控制台打印“t1played”
4.  控制台打印“t1played”一次又一次……死循环

我猜在这种情况下`CCAnimationManager`尝试播放`timeline 0`，但`timeline 0`不存在所以看不到动画，但调用“播放”操作然后`completedAnimationSequenceNamed:(NSString *) name`调用！

# javascript - 在jQuery上的元素内按类选择项目

> ID：15994879
> 
> 赞同：0
> 
> 时间：2013-04-14T01:46:26.607
> 
> 标签：javascript, jquery

我尝试选择父`.preview`元素中的所有子元素。`.dropzone`

```
$('.dropzone').add($('.preview')).length 
```

这将返回 3 但有 2 个对象。我想这也是`.dropzone`容器的数量。

我怎样才能只选择这两个`.preview`项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:49:18.950

尝试

```
$('.dropzone').find('.preview').length 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T01:51:06.190

请尝试此演示：http: [//jsfiddle.net/KjJZx/1/](http://jsfiddle.net/KjJZx/1/) **或** [http://jsfiddle.net/wbkVS/](http://jsfiddle.net/wbkVS/)

接口：[http ://api.jquery.com/children/](http://api.jquery.com/children/) `Get the children of each element in the set of matched elements, optionally filtered by a selector`

希望能满足需求！`:)`

**代码**

`$('.dropzone').children('.preview').length`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T01:53:43.707

用于选择它的常用选择器语法只是：

`$('.dropzone .preview').length`或者

`$('.dropzone > .preview).length`（如果它是 的直接子代`.dropzone`）

[http://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

@Igor 的回答也很好用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T02:03:06.380

你是对的，它也在计算容器 div。使用 jQuery 函数中的 CSS 后代选择器（以及元素之间的空白区域）来选择元素的后代（后代是元素内的所有元素）。

```
$('.dropzone .preview').length === 2 
```

或者，如果您只想要孩子（直系后代），请使用孩子选择器 (>)。

```
$('.dropzone > .preview').length === 2 
```

正如您所怀疑的，add 函数添加到 jQuery 对象中的当前元素。

# php - Codeigniter 中的表单提交

> ID：15994883
> 
> 赞同：0
> 
> 时间：2013-04-14T01:47:02.550
> 
> 标签：php, forms, codeigniter

我有这个问题，在我提交表单后，我执行“F5”或“刷新”仍然有提交的数据，每次我按“F5”与我第一次提交表单时相同的数据，然后它变成重复条目，我尝试清除CI中的POST数据以及field_data，仍然有提交的值，我不知道为什么它不能被困在`form_validation`哪里，我设置了一个需要的规则。

```
$this->load->library('form_validation');

$this->form_validation->set_rules('name', 'Name', 'required');
$this->form_validation->set_rules('email', 'Email', 'required|valid_email');
$this->form_validation->set_rules('comment','Comment','required');

if(/*form validation is false*/) //fail
{
   // some code for incorrect values
}
else //success
{
   $_POST = array();
   $this->form_validation->clear_field_data();
  //and some code for views
} 
```

现在，在一个正常的过程中，它没有错误，但是当我按下“F5”或刷新页面时，数据再次提交，从而再次将其插入数据库，我真的不知道为什么它已经发生了清除了从现场数据到实际帖子数据的所有内容，如果您有任何知识，请分享

顺便说一句，我`form_validation`是定制的，扩展了 CI 的原生 form_validation

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T03:35:50.027

尝试使用`redirect`函数而不是`$this->load->view`

你可以[在这里看到](http://ellislab.com/codeigniter/user-guide/helpers/url_helper.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T04:17:28.917

您可以使用重定向（首选）或使用服务器端标头不存储发布数据：

```
header ("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
header ("Pragma: no-cache"); // HTTP/1.0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T05:31:24.490

试试这个

```
if ($this->form_validation->run() == FALSE) 
{
   $data['Name']['value'] = $this->input->post('name', TRUE);
   $this->load->view("someview",$data);
}
else
{
   $data['Name']['value'] = "";
   $this->load->view("someview",$data);

} 
```

# java - JComponent 没有出现在 JApplet 中

> ID：15994887
> 
> 赞同：0
> 
> 时间：2013-04-14T01:47:44.163
> 
> 标签：java, swing, applet, jcomponent, preferredsize

我已经成功构建了一个 JComponent 饼图，它位于它自己的单独类 IAPieChart.java 中。PieChart 逻辑位于扩展 JComponent 的静态内部类中。JApplet 本身构建良好并显示“我在这里！” 表示面板是使用以下代码构建和添加的：

```
public class IAPieChartApplet extends JApplet {

     JPanel controls;
     JPanel chartPanel;
     JComponent pieChart;

    /**
     * Initialization method that will be called after the Applet is loaded into
     * the browser.
     */

    public void init() {

        // Build the Pie Chart Panel
        buildPieChartPanel();

        // Build the controls panel
        buildControlsPanel();

        //Set the Layout
        setLayout(new FlowLayout());

        //getContentPane().add(new PieChart(), controls);
        //add(chartPanel);
        //add(controls);

    }

    private void buildPieChartPanel(){

        // Build the panel JPanel
        chartPanel = new JPanel();
        pieChart = new PieChart();
        JLabel label = new JLabel("Here I Am!");
        chartPanel.add(pieChart);
        chartPanel.add(label);

    }

    private void buildControlsPanel() {

        controls = new JPanel();
        JLabel here = new JLabel("Here I Am");
        controls.add(here);

    }

} 
```

当我运行这个 IAPieChartApplet.java 文件时，我得到了标签但没有 PieChart。

![标签和没有饼图](https://i.stack.imgur.com/BTRk4.png)

我在这里设置了一个方法断点，并进入了静态 PieChart 类：

```
private void buildPieChartPanel(){

        // Build the panel JPanel
        chartPanel = new JPanel();
        pieChart = new PieChart();
        JLabel label = new JLabel("Here I Am!");
        chartPanel.add(pieChart);
        chartPanel.add(label);

    } 
```

调试带我到这里，然后退出课堂。它确实逐步完成了 PieChart 类中的其余逻辑。这是 PieChart 静态类的代码，它再次运行良好。调试将带我到 IAPieChart 数组，然后退出该方法。这“可能”是它不显示的原因。

![在此处输入图像描述](https://i.stack.imgur.com/aiMl9.png)

这是饼图类代码：

```
public static class PieChart extends JComponent { 

        IAPieChart[] pieValue = {new IAPieChart(2, Color.green),
                                new IAPieChart(4, Color.orange),
                                new IAPieChart(4, Color.blue),
                                new IAPieChart(3, Color.red)

        };

        public void paintComponent(Graphics g) {

            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g; 
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, 
                    RenderingHints.VALUE_ANTIALIAS_ON);
            drawPie((Graphics2D) g, getBounds(),  pieValue);

        }

        void drawPie(Graphics2D g, Rectangle area, IAPieChart[] pieValue){

            double sum = 0.0;
            for (int i = 0; i < pieValue.length; i++) {

                sum += pieValue[i].arcValue;
            }
            // DONT NEED endPoint to make the pieChart (Mishadoff's sample). 
            // needs double endPoint = 0.0D for (phcoding's sample).
            double endPoint =  0.0D;
            int arcStart = 0; 
            for (int i = 0; i < pieValue.length; i++){

                /////////THIS IS THE OLD STATEMENT////////
                //endPoint += (int) (endPoint * 360 / sum);
                arcStart = (int) (endPoint * 360 / sum);

                // this statement makes the pieChart.
                int radius = (int) (pieValue[i].arcValue * 360/ sum);
                g.setColor(pieValue[i].color);
                //g.fillArc(area.x, area.y, area.width, area.height, arcStart , radius);
                g.fillArc(area.x, area.y, area.width, area.height, arcStart , radius);

                ///////THIS IS THE OLD STATEMENT////
                //arcStart += pieValue[i].arcValue;
                endPoint += pieValue[i].arcValue;

                // this statement will make the pieChart.
                //arcStart += radius;
            }

        }
    }   // END PieChart class.* 
```

我尝试过使用 getContentPane()、repaint() 和其他在我的搜索中看起来不错的东西，但我没有选择。在过去的几周里，我一直做得很好，但是这项任务一直困扰着我。我希望你能帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T02:38:03.450

饼图没有出现，因为`PieChart`没有任何首选大小。因此`JPanel`使用默认值的包含`FlowLayout`不显示它。`getPreferredSize`应该用于`setPreferredSize`：

```
@Override
public Dimension getPreferredSize() {
   return new Dimension(100, 100);
} 
```

*更新：*

在您修改后的小程序中，您正在扩展旧的 AWT `Applet`，它不会覆盖`paintComponent`，`JApplet`而是使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T09:57:14.743

我已根据给出的建议尽我所能重做程序，但图形仍然不会显示在小程序中。摆脱实例化错误后，我成功构建了小程序，但饼图不会显示。我希望有人能对此提供帮助，以便我可以使用该程序继续使用其他功能。

这是我现在拥有的：

```
package iapiechart;

import java.applet.Applet;
import java.awt.*;
import javax.swing.JComponent;

public class IAPieChart2 extends Applet
{
   double arcValue;        // passes a value for the calculation of the arc.
    Color color;            // holds value for color (expressed as an integer
    public IAPieChart2(){};
    public IAPieChart2(double value, Color color){

        arcValue = value;
        this.color = color;
    } 

    public  class PieChart extends JComponent { 

        public PieChart(){};

        IAPieChart[] pieValue = {new IAPieChart(2, Color.green),
                                new IAPieChart(4, Color.orange),
                                new IAPieChart(4, Color.blue),
                                new IAPieChart(3, Color.red)

        };
        @Override
    public void paintComponent(Graphics g) {

            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g; 
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, 
                    RenderingHints.VALUE_ANTIALIAS_ON);
            drawPie((Graphics2D) g, getBounds(),  pieValue);

        }
    void drawPie(Graphics2D g, Rectangle area, IAPieChart[] pieValue){

            double sum = 0.0;
            for (int i = 0; i < pieValue.length; i++) {

                sum += pieValue[i].arcValue;
            }
            // DONT NEED endPoint to make the pieChart (Mishadoff's sample). 
            // needs double endPoint = 0.0D for (phcoding's sample).
            double endPoint =  0.0D;
            int arcStart = 0; 
            for (int i = 0; i < pieValue.length; i++){

                /////////THIS IS THE OLD STATEMENT////////
                //endPoint += (int) (endPoint * 360 / sum);
                arcStart = (int) (endPoint * 360 / sum);

                // this statement makes the pieChart.
                int radius = (int) (pieValue[i].arcValue * 360/ sum);
                g.setColor(pieValue[i].color);
                //g.fillArc(area.x, area.y, area.width, area.height, arcStart , radius);
                g.fillArc(area.x, area.y, area.width, area.height, arcStart , radius);

                endPoint += pieValue[i].arcValue;

            }
    }
    }
    @Override
    public void init(){

        IAPieChart2 iap2 = new IAPieChart2();
        PieChart pc = new PieChart();
        setPreferredSize(new Dimension(300, 200));
        iap2.getPreferredSize();
        super.add(pc);
        setVisible(true);

    }

} 
```

# python - 将函数作为参数传递时如何知道将括号放在哪里？

> ID：15994892
> 
> 赞同：0
> 
> 时间：2013-04-14T01:48:44.510
> 
> 标签：python, function, probability

为什么我在传递函数时出现语义错误`rollDie()`，`checkPascal(numTrials, roll)`但是当我传递它的名称，然后将括号放在变量之后，它会按预期工作？（请看一下代码）。我已经尝试过使用它并且也在寻找，但我似乎无法正确地用它来找到任何地方的答案。

这将不胜感激，因为我似乎无法弄清楚。这不是什么大问题，这个问题甚至不是课堂作业的一部分。我们正在我的 OpenCourseWare MITx 课程中学习蒙特卡罗方法，我偶然发现了这一点。我不知道为什么括号在他们所在的地方。我认为它们应该在 def 行中。我正在参加以前录制的免费在线课程，所以我没有可以告诉我的讲师。谢谢。

```
import random

def rollDie():
    """returns a random int between 1 and 6"""
    return random.choice([1,2,3,4,5,6])

def checkPascal(numTrials, roll):
    yes = 0.0
    for i in range(numTrials):
        for j in range(24):
            d1 = roll #correct line would be d1 = roll()
            d2 = roll #d2 = roll()
            if d1 == 6 and d2 == 6:
                yes += 1
                break
    print 'Probability of losing =', 1.0 - yes/numTrials

checkPascal(10000, rollDie()) #incorrect code
#correct code would be checkPascal(10000, rollDie) 
```

据我了解，“滚动”只是一个变量，变量不能有参数，至少我是这么认为的。这似乎在直觉上是错误的。这是因为它是弱类型语言吗？我很好奇。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T01:53:16.373

只传递名称`rollDie`传递**函数** `rollDie`。`roll`这就是为什么在进一步向下工作之后放置括号，您正在**调用**变量引用的函数`roll`。

传递`rollDie()`评估该函数，并返回`random.choice([1,2,3,4,5,6])`（在这种情况下`roll`是一个整数）

尝试：

```
print rollDie
print rollDie() 
```

看看有什么不同。

# asp.net-mvc - 将 Google Analytics 仪表板集成到 MVC Razor View 中？

> ID：15994896
> 
> 赞同：2
> 
> 时间：2013-04-14T01:49:10.217
> 
> 标签：asp.net-mvc, html, razor, asp.net-mvc-4, google-analytics

我希望有一个仪表板供我的网站管理员在登录网站的管理部分后立即查看，这是一个 MVC4 Web 应用程序，使用 Razor 视图引擎。我对 Web 开发相当陌生，我找不到有关如何执行此操作的简单教程。

如何创建一个具有某种“小部件”或包含来自谷歌分析网站的仪表板的 cshtml 视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T14:35:36.843

Mahdi Taghizadeh 写了一篇文章，可以帮助您从 Google 检索分析数据并将其呈现在视图中：

[如何在 ASP.NET MVC 中使用 Google Data API。第 1 部分 - 谷歌分析](http://mahdi.ws/how-to-use-google-data-api-in-asp-net-mvc-part-1-google-analytics/)

# php - 在 On Bodyload 命令中显示 GET 值

> ID：15994897
> 
> 赞同：-5
> 
> 时间：2013-04-14T01:49:12.763
> 
> 标签：php, onload

这是我想出的，但我不确定我还需要做什么。

```
<body onload=window.location='<?php " . $_GET["u"] . " ?>'> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:50:56.613

您错过了`echo`并写了额外`"`的 s：

```
<body onload=window.location='<?php echo $_GET["u"]; ?>'> 
```

请注意，您从`GET`或`POST`应首先对您收到的任何输入进行清理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:51:29.770

你需要回应它：

```
<?php echo $_GET["u"]; ?> 
```

为什么需要这样做？这将使您的网站容易受到 XSS 的攻击。

# c# - ASP.NET MVC4 - 集合对象的远程验证

> ID：15994899
> 
> 赞同：4
> 
> 时间：2013-04-14T01:49:19.357
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, remote-validation

我无计可施，试图找出一种方法来完成这项工作。我有一个 ASP.NET MVC4 视图，它被强类型化为包含许多集合对象的 ViewModel。其中一个对象是列标题列表

```
public List<ColumnHeader> ColumnHeaders { get; set; } 
```

我希望能够简单地使用远程验证属性来限定该成员，例如

```
[Remote("AreCustomExpressionsSafe", "Validation")] 
```

然后我可以接受整个集合作为我的验证控制器的 AreCustomExpressionsSafe 操作的参数，以一次对该集合的所有成员执行客户端验证，并与服务器进行一次往返。任何人都可以演示实现这一点所需的代码，可能在 View 和 ViewModel 定义中？任何帮助都将是一个完整的救生员——我真的别无选择。

# ios - iOS应用程序名称中的mdash？

> ID：15994905
> 
> 赞同：-1
> 
> 时间：2013-04-14T01:50:11.143
> 
> 标签：ios, search, app-store, search-engine

我有一个 iOS 应用程序。我正在考虑在应用程序名称中使用 mdash。换句话说，调用应用程序

```
Foo — Bar 
```

我想知道这是否会对我的应用程序的可发现性产生任何影响。换句话说，使用不在键盘上的字符会让人在搜索中不那么喜欢它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T03:38:41.480

Apple 不仅使用您的 App 名称，还使用关键字和您的公司名称作为搜索元素。阅读这篇文章：

> **算法**
> 
> 该算法将搜索词与应用程序名称、关键字字段和公司名称中指定的关键字进行匹配。应用程序名称允许 255 个字符，而关键字字段仅允许 100 个字符。Apple 为您的应用程序名称提供了更多空间这一事实意味着越来越多的开发人员正在用关键字填充它。

[http://www.techrepublic.com/blog/ios-app-builder/itunes-app-store-search-optimization-tips/438](http://www.techrepublic.com/blog/ios-app-builder/itunes-app-store-search-optimization-tips/438)

所以你的应用的可发现性主要取决于你的名字和关键词，也取决于应用截图，因为如果你使用丑陋的截图，用户甚至不会打开你的应用的介绍页面。在我看来，在您的应用名称中添加“破折号”不会有太大帮助或影响，Apple 的算法甚至可能会忽略应用名称中的“破折号”和空格（这只是我的猜测，但对于搜索引擎来说是合理的）。关键字和屏幕截图至关重要。

PS：不要尝试添加与您的应用程序无关的关键字（例如“twitter”或“google”）以增加可发现性。你可能会受到惩罚。

PS2：不要尝试用很多关键字（我认为> 3）填写您的应用程序名称。它只会让用户感到困惑并远离它。

# gdb - GDB 和 DDD 不完整类型

> ID：15994910
> 
> 赞同：0
> 
> 时间：2013-04-14T01:51:10.693
> 
> 标签：gdb, ddd-debugger

我已阅读但不理解当前可用的材料。我去年春天才安装了 Linux，当时我也自学了如何编写 C++。我对此很陌生。

我正在尝试调试一个使用[Trilinos](http://trilinos.sandia.gov/)矩阵求解器包的程序。我有[Epetra_SerialDenseMatrix](http://trilinos.sandia.gov/packages/docs/r6.0/packages/epetra/doc/html/classEpetra__SerialDenseMatrix.html)的可变类型。[gdb和](http://www.gnu.org/software/gdb/)[ddd](http://www.gnu.org/software/ddd/)都不能显示这些变量类型的内容。

具体来说，我如何获取`gdb`和/或`ddd`链接到 Trilinos 库以便可以打印这些类型的变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T03:48:56.857

你看过这些[Trilinos 教程](https://code.google.com/p/trilinos/wiki/TrilinosHandsOnTutorial)吗？

我还发现[这个页面](http://trilinos.sandia.gov/packages/docs/dev/packages/stk/doc/html/stk__mesh__testing__and__debugging.html)显示了如何使用 GDB 或[Totalview](http://www.roguewave.com/products/totalview.aspx)来调试 Trilinos 附带的单元测试。

### 摘自 Trilinos 页面

*   串口调试可以在gdb或者totalview中完成
    *   广发银行
        *   数据库
        *   `% run -- --gtest_filter=<failing-test>`

*   可以用 valgrind 来调试内存问题
    *   串行：`valgrind <utest-exe> -- --gtest_filter=<failing-test>`

# ios - CoreData 用户定义的数据库结构？

> ID：15994911
> 
> 赞同：1
> 
> 时间：2013-04-14T01:51:19.413
> 
> 标签：ios, core-data

所以，我刚刚开始开发一个 iOS 库存应用程序，我希望它非常灵活。我想要的是让用户能够定义一个产品类别，然后是它的自由度，即颜色、尺寸、图像、样式等。我知道我可以通过设计一个已经包含这些属性的数据模型来实现这一点，但用户可能并不总是需要每一个，而且（更麻烦的是）可能需要我没有想到的其他属性（如材料或品牌）。有没有办法使用 CoreData 构建这种灵活的数据模型？我确信我可以使用 plist 来做到这一点，但我想利用 iCloud 和 NSFetchedResultsController，更不用说谓词等了。

这甚至不是可以使用数据库实现的东西吗？现在我正在查看问题，似乎我可能会受到强制结构的限制......如果用户在添加记录后更改属性怎么办？我必须处理迁移商店吗？啊。

...

好的，这是另一种方法，也许有人可以评论这是否疯狂。我开始思考，用户可能添加的所有属性基本上都属于同一类型——它们有一个字符串标签（属性的名称，例如“颜色”）和一系列字符串值（例如“红色”、 “木炭”、“蓝色”等）。那么为什么不建立实体的这些关系而不是属性呢？所以，现在我的对象模型中有三个实体：`MerchCategory`，这是我们正在讨论的商品类型，`MerchItem`，这是库存中的单个项目，并且`Dimension`是项目可能具有的质量。

`MerchItem`具有`sku`属性，与 具有多对多关系`Dimension`，与 具有多对一关系`MerchCategory`。

`Dimension`具有`name`和`value`属性，以及`categories`和`items`多对多关系。

这是一个合理的模式吗？在我看来，我将能够通过查看它们的名称来查询每个维度，并通过查看它们的值来获取每个配置的计数......并且用户将能够添加新的而无需使用 NSEntityDescription . 想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:03:35.673

请参阅[如何以编程方式将属性添加到现有的核心数据实体（对象）？](https://stackoverflow.com/questions/15625088/how-to-add-attributes-to-an-existing-core-data-entity-object-programmatically).

你正在完成一项非常大的任务。可以办到。FileMaker 正在使用[FileMaker Mobile](http://www.filemaker.com/support/technologies/mobility.html)和[Bento for iPad](http://www.filemaker.com/products/bento/for-ipad/)来做到这一点。但我怀疑他们有更多的人投入到产品中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T02:09:59.473

只要您不需要通过这些属性获取，您就可以编写代码来添加和减去自定义属性，将它们存储在 nsarray 中并将它们全部捆绑到 nsdata 中并将其存储在核心数据中。您可以简单地创建一个具有尽可能多的固定属性的实体，以便能够排序和获取并将其余部分存储在一个 nsdata 属性中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T01:56:13.243

我认为您需要以编程方式将实体添加到您的 NSManagedObjectModel，使用 NSEntityDescription 和 NSPropertyDescription 将属性添加到您的实体。我不确定迁移将如何工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-12T17:08:04.603

我正在做类似的事情，我正在考虑创建一个名为“属性”的新核心数据类，因此我可以将我的对象设置为“与许多属性有关系”。每个属性都将具有核心数据字符串类型属性：“属性”、“类型”和“值”。

我认为这应该提供足够的灵活性来即时添加产品属性。如果我碰巧实现了这个，我会在这里发布

# ruby-on-rails - 在 Rails 中呈现 JSON 错误时不存在空格

> ID：15994912
> 
> 赞同：2
> 
> 时间：2013-04-14T01:51:21.223
> 
> 标签：ruby-on-rails, json

我一直在我的控制器中这样做

```
render json: {errors: @user.errors}, status: 422 
```

当我在浏览器控制台看到用户在保存时出错时，我看到如下内容：

```
{errors: {my_field: ["Anerrorhasocurred"]}} 
```

我应该在哪里修复这个错误？

# 更新

我忘了写`{errors: ...}`，所以我通过哈希来`render json:`调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T06:08:09.703

您可能想尝试 full_messages - [http://api.rubyonrails.org/classes/ActiveModel/Errors.html#method-i-full_messages](http://api.rubyonrails.org/classes/ActiveModel/Errors.html#method-i-full_messages)

```
render json: @user.errors.full_messages, status: 422 
```

应该返回一组验证错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T05:04:02.693

> 你确定字符串在jsonification之前有空格吗？

尝试添加一行与`@user.errors.inspect`一起下降到开发日志`@user.errors.to_json`，然后重试错误。

# c - c中带符号整数未定义行为的模算术？

> ID：15994917
> 
> 赞同：-1
> 
> 时间：2013-04-14T01:52:34.870
> 
> 标签：c, unsigned, undefined-behavior, signed

阅读完所有答案和评论后[，即使它们是非负数，您是否应该始终对 C 中的数字使用“int”？](https://stackoverflow.com/questions/3259413/should-you-always-use-int-for-numbers-in-c-even-if-they-are-non-negative/15937117#15937117)我仍然不确定在以下情况下该怎么做。

两个远程设备正在对各自位置的事件进行计数。他们定期向 PC 报告计数器读数，其中反馈算法以某种方式将计数器读数的差异保持在范围内。事件序列是无止境的，因此读数以 2^n 为模报告。对于模运算，建议使用无符号整数。然而，差异很可能会变成负数。在计算差异之前将读数转换为有符号整数在我测试它的平台上工作得很好（也就是说，我得到的差异模 2^n 的值很小）。在界面中将读数声明为已签名会产生优雅的代码。但是，代码应该是可移植的。我应该认真对待 UB 警告吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:57:29.237

> 我应该认真对待 UB 警告吗？

如果你不希望你的编译器或 CPU 欺骗你，你的代码应该是无 UB 的。

# android - SQLite 查询中的日历日期比较不适用于该月的第一天

> ID：15994920
> 
> 赞同：0
> 
> 时间：2013-04-14T01:53:21.853
> 
> 标签：android, sqlite

我取当前日期，然后将月份中的日期设置为 1。然后，在查询中，我说已经存储在数据库中的日期必须在该日期之后或之后发生。正如您从代码中看到的那样，被比较的日期以毫秒为单位。

我的问题是当我在数据库中创建一个条目并将日期设置为每月的第一天时，由于某种原因它从未包含在结果中。但是，如果我只是将它设置为当月的 2 号，它会按预期工作。我希望错误出现在此查询周围。至少如果这一切对你来说都很好，我会知道我的逻辑在其他地方一定是错误的。

编辑：有问题的查询是第二次设置为 cursor2 的查询（在第一个 for 循环中）。

```
public void buildTable () {
    SQLiteDatabase db = BalanceDb.getInstance(this).getDB();
    String curCat = "", category = "", spent = "";
    double catTotal, percent, curBudget;
    Calendar cal = Calendar.getInstance();
    cal.set(Calendar.DATE, 1);
    long backDate = cal.getTimeInMillis();

    Cursor cursor1 = db.query(CategoriesDbContract.TblCategories.TABLE_NAME, 
                             null, null, null, null, null, null);
    Cursor cursor2 = db.query(TransactionsDbContract.TblTransactions.TABLE_NAME,
                             null, null, null, null, null, null);

    if (cursor1.moveToFirst() == false) {
        Toast.makeText(this, "No categories found.", Toast.LENGTH_SHORT).show();
    }
    else {
        for (int i = cursor1.getCount() - 1; i >=0; i--) {
            catTotal = 0;
            cursor1.moveToPosition(i);

            curCat = cursor1.getString(cursor1.getColumnIndexOrThrow(
                    CategoriesDbContract.TblCategories.COLUMN_NAME_CATEGORY));
            curBudget = cursor1.getDouble(cursor1.getColumnIndexOrThrow(
                    CategoriesDbContract.TblCategories.COLUMN_NAME_BUDGET));

            cursor2 = db.query(TransactionsDbContract.TblTransactions.TABLE_NAME,
                           null, 
                           TransactionsDbContract.TblTransactions.COLUMN_NAME_CATEGORY + "= '" + curCat + "'" +
                           "AND " + TransactionsDbContract.TblTransactions.COLUMN_NAME_DATE + ">=" + backDate, 
                           null, null, null, null);

            for (int j = cursor2.getCount() - 1; j >= 0; j--) {

                cursor2.moveToPosition(j);

                catTotal += -1 * (cursor2.getDouble(cursor2.getColumnIndexOrThrow(
                        TransactionsDbContract.TblTransactions.COLUMN_NAME_AMOUNT)));
            }

            percent = catTotal/curBudget * 100;
            DecimalFormat df = new DecimalFormat();
            df.setMaximumFractionDigits(1);
            String percStr = df.format(percent);

            category += cursor1.getString(cursor1.getColumnIndexOrThrow(
                    CategoriesDbContract.TblCategories.COLUMN_NAME_CATEGORY)) + "\n";

            spent += percStr + "\n";
        }

        textCat.setText(category);
        textSpent.setText(spent);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T02:09:35.760

根据理性主义者解决方案编辑答案。时间是您打电话的时间，`cal.set(Calendar.DATE, 1);`您需要更改

```
cal.set(Calendar.DATE, 0); 
```

# clojure - 计算可变数量参数的最大值

> ID：15994927
> 
> 赞同：1
> 
> 时间：2013-04-14T01:55:24.070
> 
> 标签：clojure

我是 Clojure 的新手，所以我想知道是否有人可以向我解释我哪里出错了。我正在解决[4Clojure](http://www.4clojure.com)中的一些问题来熟悉，其中之一是计算可变数量参数的最大值，*而不使用 Clojure 的内置 max 函数*。我应该填空：

```
(_ 1 8 3 4) 
```

所以结果是4。

为此，我正在尝试实现一个可变参数的功能。由于 Lisp 中的所有内容都必须是递归的，所以我的基本情况是只有一个元素，在这种情况下，最大值就是元素本身。否则，我比较第一个和第二个元素，并在适当的情况下递归调用该函数：

```
(fn max-of
    ; base case, only one element, return the element
    ([x] x)
    ; if more than one element...
    ([x & more]
        ; ...compare the first element and the second
        ; if the first element is bigger than the second
        ; drop the second element, else drop the first 
        (if (> x (first more)) (max-of (cons x (rest more)))
                               (max-of more)))) 
```

但这给了我：

```
user=>     ((fn max-of
#_=>         ([x] x)
#_=>         ([x & more]
#_=>             (if (> x (first more)) (max-of (cons x (rest more)))
#_=>                                    (max-of more))))
#_=>     1 8 3 4)
(8 3 4) 
```

而且我不知道为什么这会返回一个列表而不是在所述列表上调用我的函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:03:29.360

因为在第一次递归调用中，您将列表作为单个实体传递，请查看

`(max-of 8 3 4)`和`(max-of '(8 3 4))`

您可以使用`apply`来缓解此问题：

`(apply max-of (cons x (rest more)))`

# php - 尝试不使用 Stripe 充电

> ID：15994930
> 
> 赞同：2
> 
> 时间：2013-04-14T01:56:05.327
> 
> 标签：php, try-catch, stripe-payments

我正在我的网站上测试 Stripe，但无法通过下面看到的“尝试”。基本上，我从来没有在“尝试”之后看到“测试”。

我在这里做错了吗？

```
 try {
$charge = Stripe_Charge::create(array(
  "amount" => 50, // amount in cents, again
  "currency" => "usd",
  "customer" => $customer->id,
  "card" => $token,
  "description" => $email));
echo "TEST1";
} catch (Stripe_CardError $e) {
    // Since it's a decline, Stripe_CardError will be caught
    $body = $e->getJsonBody();
    $err  = $body['error'];
    echo 'Status is:' . $e->getHttpStatus() . "\n";
    echo 'Type is:' . $err['type'] . "\n";
    echo 'Code is:' . $err['code'] . "\n";
    // param is '' in this case
    echo 'Param is:' . $err['param'] . "\n";
    echo 'Message is:' . $err['message'] . "\n";
}
echo "TEST"; 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T15:04:19.850

您不太可能遇到另一个错误——如果是，您将看到一个未捕获的错误异常。话虽如此，正如 periklis 建议的那样，您也应该捕获其他类型的异常。

最有可能发生的是 Stripe_CardError*被*抛出和捕获，但是因为您没有在 catch 语句中回显任何内容，所以它会默默地失败。尝试这个：

```
} catch (Stripe_CardError $e) {
    // Since it's a decline, Stripe_CardError will be caught
    $body = $e->getJsonBody();
    $err  = $body['error'];

    echo 'Status is:' . $e->getHttpStatus() . "\n";
    echo 'Type is:' . $err['type'] . "\n";
    echo 'Code is:' . $err['code'] . "\n";
    // param is '' in this case
    echo 'Param is:' . $err['param'] . "\n";
    echo 'Message is:' . $err['message'] . "\n";
} catch (Exception $e) {
    echo $e->getMessage();
} catch (ErrorException $e) {
    echo $e->getMessage();
} 
```

编辑 4/16/13 - 您在评论中指出您甚至没有在 try 语句中看到您的回声。因此，要么 a）您的 echo 语句从视图中隐藏，要么 b）它之前的代码块失败。但是，由于您没有捕获 Stripe_CardError，因此它必须是不同类型的异常。我现在的猜测是，您传递给 Stripe 函数的变量之一存在问题......要么未声明，要么试图访问非对象的属性。

添加其他 catch 语句，看看你是否得到任何东西。您无法到达最后一个回显语句的唯一方法是抛出未捕获的异常......您只是没有看到它。

这是在黑暗中拍摄的，但是您的 php 环境是否有可能以其他不明显的方式抑制或处理异常报告？有时，生产环境设置为忽略或记录异常，而不是向用户显示它们。检查一下，因为如果你没有看到它，它就会被其他地方捕获并记录或隐藏在视图之外。

尝试在尝试捕获之前将其插入某处：

```
ini_set('error_reporting', E_ALL); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-01T09:10:08.043

我知道这是一个迟到的答复，但我遇到了完全相同的问题。我尝试在每一行代码后回显，并且在尝试收费后回声停止，我将我的“金额”设置为 10 美分（愚蠢），它应该是 10 欧元（1000），条纹不允许这样小额费用，一旦我将金额增加到 1000 美分，它就起作用了。

```
$charge = Stripe_Charge::create(array(
  "amount" => 50, // amount in cents, again <<THIS IS WHAT CAUSED MY ISSUE!!
  "currency" => "usd",
  "customer" => $customer->id,
  "card" => $token,
  "description" => $email)); 
```

# html - 导航菜单堆叠

> ID：15994931
> 
> 赞同：0
> 
> 时间：2013-04-14T01:56:07.103
> 
> 标签：html, css, navigation, z-index

我的导航菜单的下拉菜单在我的页面内容下出现问题。现在我尝试弄乱 z-index 但没有运气。

这是问题的图片：

![在此处输入图像描述](https://i.stack.imgur.com/LIfdV.jpg)

这是我的CSS

```
 @charset "utf-8";
body {
    font: 100%/1.4 Verdana, Arial, Helvetica, sans-serif;
    background-color: #FFF;
    margin: 0;
    padding: 0;
    color: #000;
}

/*--Navigation bar--*/
nav ul ul {
    display: none;
}
nav ul li:hover > ul {
        display: block;
}
nav ul {
    background: #181f32; 
    background: linear-gradient(top, #344268 0%, #181f32 100%);  
    background: -moz-linear-gradient(top, #344268 0%, #181f32 100%); 
    background: -webkit-linear-gradient(top, #344268 0%, #181f32 100%);
    box-shadow: 0px 0px 10px #000;
    padding: 0 10px;
    border-radius: 5px;  
    list-style: none;
    position: relative;
    display: inline-table;
}
nav ul:after {
        content: ""; clear: both; display: block;
}
nav ul li {
    float: left;
}
nav ul li:hover {
        background: #344268;
        background: linear-gradient(top, #4f5964 0%, #5f6975 40%);
        background: -moz-linear-gradient(top, #4f5964 0%, #5f6975 40%);
        background: -webkit-linear-gradient(top, #4f5964 0%,#5f6975 40%);
}
nav ul li:hover a {
            color: #fff;
}
nav ul li a {
        display: block; padding: 15px 20px;
        color: #fff; text-decoration: none;
}
nav ul ul {
    background: #181f32; border-radius: 0px; padding: 0;
    position: absolute; top: 100%; z-index:-1;
}
nav ul ul li {
        float: none; 
        border-top: 1px solid #999;
        border-bottom: 1px solid #999;
        position: relative;
        z-index:-1;
}
nav ul ul li a {
            padding: 15px 40px;
            color: #fff;
            z-index:-1;
}   
nav ul ul li a:hover {
                background: #344268;
}
nav ul ul ul {
    position: absolute; left: 100%; top:0;
}
/*--container--*/
#container {
    left:50%;
    margin-left:-460px;
    width:900px;
    height:auto;
    margin-bottom: 40px;
    position: absolute;
}
/*--Header--*/
#header {
    position:relative;
    width: 900px;
    height: 200px;
    margin-bottom: 40px;
}
/*--Content--*/
#wrap {
    width: 900px;
    height:auto;
    position:relative;
}
#contain {
    width: 100%;
    height:auto;
    float:left;
    margin-bottom:20px;
    z-index:-8;
}
#right {
    width: 220px;
    background: rgba(24, 31, 50, .8);
    background: rgb(24, 31, 50);
    float:right;
    margin-left:5px;
    border-top-right-radius: 5px;
    height:200px;
    box-shadow: 0 0 8px #000;
}
#center {
    width: 450px;
    background: rgba(24, 31, 50, .8);
    background: rgb(24, 31, 50);
    height:800px;
    left:50%;
    float:right;
    box-shadow: 0 0 8px #000;
}
#left{
    width: 220px;
    border-top-left-radius: 5px;
    background: rgba(24, 31, 50, .8);
    background: rgb(24, 31, 50);
    height: 300px;
    float: left;
    box-shadow: 0 0 8px #000;
} 
```

以及我的html：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>

<body>

    <div id="container">

        <div id="header">
            <img name="nojoke" src="" width="400" height="180" alt="nojoke logo" style="background-color: #666666" />
        </div>

        <div>

            <nav>
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Tutorials</a>
                        <ul>
                            <li><a href="#">Photoshop</a></li>
                            <li><a href="#">Illustrator</a></li>
                            <li><a href="#">Web Design</a>
                                <ul>
                                    <li><a href="#">HTML</a></li>
                                    <li><a href="#">CSS</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li><a href="#">Articles</a>
                        <ul>
                            <li><a href="#">Web Design</a></li>
                            <li><a href="#">User Experience</a></li>
                        </ul>
                    </li>
                    <li><a href="#">Inspiration</a></li>
                </ul>
            </nav>

        </div>

        <div id="wrap">

            <div id="contain">

                <div id="right">
                </div>

                <div id="center">
                </div>

                <div id="left">
                </div>

            </div>

        </div>

     </div>

</body>
</html> 
```

任何帮助都会很棒！我曾尝试寻找问题，但没有这样的运气。我认为 z-index 可以解决问题，但不行 =/ 非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T02:01:37.447

添加`position: relative;`到`#contain`

这是工作代码[http://jsfiddle.net/jZP78/](http://jsfiddle.net/jZP78/)

属性`z-index`仅适用于具有绝对、相对和固定定位的元素。

# ruby-on-rails - Ruby on Rails 中的多维数组？

> ID：15994935
> 
> 赞同：0
> 
> 时间：2013-04-14T01:56:54.937
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, multidimensional-array

我想知道是否可以在rails中做多维数组？

我想得到类似制定一些数据的东西：

```
apple => 'tasty', 'red', 'round'
cereal => 'milk', 'breakfast'
name => 'tags' 
```

我试图获取右侧是标签的名称-值对，因此当我调用名称时，我可以获得标签。

编辑：

我目前有这个

```
@array = ['apple', 'cereal', 'name'] 
```

但想为这些添加标签

```
@array = ['apple'=>['tasty', 'red', 'round'], 'cereal' => ['milk', 'breakfast'], 'name' => ['tags']] 
```

我想做这样的事情，所以当我循环输出名称和相关标签时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:00:29.333

就像戴夫牛顿在上面的问题评论中所说的那样，它被称为哈希，它用于诸如`key => value`. Hash 可以使用 Array 作为值，Array 可以使用 Hash 作为值。

`{apple: ['tasty', 'red', 'round'], cereal: ['milk', 'breakfast'], name: ['tags']}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T05:11:05.883

你听说过 YAML 吗？您可以将 YAML 格式的数据放入文件中，将其读入，它会自动为您创建哈希和数组：

```
apple:
   - tasty
   - red
   - round
cereal:
   - milk
   - breakfast
name: tags 
```

然后在红宝石中：需要'yaml'

```
file=YAML.load_file(filename)
file.each_pair do |key, value|
   ...etc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T04:53:27.627

你想要的叫做`Hash`，它的元素是键值对。键应该是`string`或`symbol`；值可以是任何对象。

在您的特定情况下，`apple`是关键，`['tasty', 'red', 'round']`也是价值。

查看此[链接](http://ruby-doc.org/core-2.0/Hash.html)以了解有关 Ruby 中的 Hash 的更多信息。

# vb.net - VB net 2012 代码在 windows 7 开始菜单中搜索程序和文件

> ID：15994936
> 
> 赞同：0
> 
> 时间：2013-04-14T01:57:02.623
> 
> 标签：vb.net, search, startmenu

我想制作一个功能类似于 Windows 7 开始菜单中的搜索文本框的文本框。当我在 Windows 7 开始菜单中搜索某些内容时，进程 searchindexer.exe 会运行。所以你会认为这是我必须在我的程序中运行的。但是当我运行它时，什么也没有发生。

有人说要使用 .NET Framework 的 Windows API 代码包，因为它提供了 API 挂钩，以便在我自己的应用程序中使用现有的 Windows 搜索。听起来这就是我想要的。有人可以让我开始了解如何使用 API 挂钩，因为我是编程新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T02:27:33.893

我不是钩子大师，但在这里

[http://support.microsoft.com/kb/319524](http://support.microsoft.com/kb/319524)

和这里

[http://www.codeguru.com/vb/gen/vb_system/keyboard/article.php/c4831/Managing-LowLevel-Keyboard-Hooks-with-the-Windows-API-for-VB-NET.htm](http://www.codeguru.com/vb/gen/vb_system/keyboard/article.php/c4831/Managing-LowLevel-Keyboard-Hooks-with-the-Windows-API-for-VB-NET.htm)

似乎是一个好的开始。

# python - 布尔类型列作为 SQLAlchemy 中的 ClauseElement

> ID：15994938
> 
> 赞同：5
> 
> 时间：2013-04-14T01:57:15.293
> 
> 标签：python, sqlalchemy

为什么在 SQLAlchemy 中不能使用 Boolean 类型的列作为 ClauseElement 本身？

```
session.query(Table).filter(Table.name == 'huszar', Table.valid) 
```

当然`Table.valid == True`可以，但对我来说看起来有点难看......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T04:53:39.340

我想也许你在 0.7 并且 ORM 还不支持单个 filter() 调用中的多个条件，这是在 0.8 中添加的，如果独立，0.7 似乎也需要表绑定列。一切都在 0.8 中工作：

```
from sqlalchemy import *
from sqlalchemy.orm import *
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base()

class A(Base):
    __tablename__ = "a"

    id = Column(Integer, primary_key=True)
    data = Column(String(20))
    boolean = Column(Boolean)

# works
e = create_engine("sqlite://", echo=True)

# works
#e = create_engine("postgresql://scott:tiger@localhost/test", echo=True)

# works
#e = create_engine("mysql://scott:tiger@localhost/test", echo=True)

Base.metadata.create_all(e)

s = Session(e)
s.add_all([
    A(data='a1', boolean=True),
    A(data='a2', boolean=False),
    A(data='a3', boolean=True),
])

# works
print s.query(A).filter(A.data > 'a1', A.boolean).all()

# works
print s.query(A).filter(A.boolean).all()

# if before 0.8, need to use and_() or table-bound column
# print s.query(A).filter(and_(A.data > 'a1', A.boolean)).all()
# print s.query(A).filter(A.__table__.c.boolean).all() 
```

# ios - 如何将现有的 iOS DocSet 添加到 xcode？

> ID：15994941
> 
> 赞同：1
> 
> 时间：2013-04-14T01:57:41.817
> 
> 标签：ios, xcode, docset

我已经下载了 iOS 6.1 DocSet，当我导航到 Finder 时，如下所示`/Applications/Xcode.app/Contents/Developer/Documentation/DocSets/`：

![Finder 中的文档集](https://i.stack.imgur.com/XYJqV.jpg)

但是，当在 Xcode 首选项中它再次提示我`Install`时，即使它已经被下载：

![Xcode 首选项](https://i.stack.imgur.com/22GuH.jpg)

如何让 Xcode 读取已经安装的 DocSet？

# grails - doWithDynamicMethods 访问服务

> ID：15994943
> 
> 赞同：1
> 
> 时间：2013-04-14T01:58:00.810
> 
> 标签：grails, grails-plugin

我很难访问 doWithDynamicMethod 中的特定服务。

```
def doWithDynamicMethods = { ctx ->
        def nodeDriverProxy  = application.getServiceClass('NodeDriverProxyService')
        application.domainClasses.each{ cClass ->
            delegate.log.warn('cClass: ' + cClass.toString())
            cClass.metaClass.cacheInstance = { domainIns->
                delegate.log.warn "domain is being cached id: ? with version ?"
                nodeDriverProxy.registerUpdate(domainIns.id, domainIns.version)
            } 
```

变量 nodeDriveProxy 为空或访问“application.serviceClasses”时出现异常我做错了什么？谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T02:20:11.150

你不想要`GrailsServiceClass`，你想要服务实例。你有`ctx`变量是 Spring `ApplicationContext`，所以它会是

```
def doWithDynamicMethods = { ctx ->
   def service = ctx.nodeDriverProxyService
   application.domainClasses.each { cClass ->
      delegate.log.warn('cClass: ' + cClass.toString())
      cClass.metaClass.cacheInstance = { domainIns ->
         delegate.log.warn "domain is being cached id: ? with version ?"
         service.registerUpdate(domainIns.id, domainIns.version)
      }
   }
} 
```

# three.js - Threejs中的透明对象

> ID：15994944
> 
> 赞同：70
> 
> 时间：2013-04-14T01:58:25.873
> 
> 标签：three.js

我正在尝试在 Three.js 中编写一个小程序，它显示两个球体，一个在另一个球体内部。sphere2 的半径应该在 0.5 和 1.5 之间波动，而 sphere1 的半径始终为 1.0。每个球体都是透明的（不透明度：0.5），因此可以看到较大的球体中包含的较小的球体。当然，“更小”和“更大”的角色随着 sphere2 半径的变化而变化。

现在的问题是 Three.js 使我在我的程序中定义的第一个球体变得透明，而不是第二个球体。如果我定义第一个 sphere1 那么它变得透明但 sphere2 完全不透明。如果我定义第一个 sphere2 那么这是透明的。将它们添加到场景中的顺序不起作用。

我在下面包含了一个显示正在发生的事情的最小程序（没有动画）。在其当前状态下，只有 sphere1 可见且不透明。如果我在 sphere2 之前定义 sphere1 则 sphere1 变得透明但 sphere2 不再透明。将 sphere2 的半径更改为 1.2 将隐藏 sphere1。

有没有办法让两个球体都透明？

```
var scene = new THREE.Scene();
var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);

camera.position.set(0, 0, 3);
camera.lookAt(new THREE.Vector3(0, 0, 0));
scene.add(camera);

var ambient = new THREE.AmbientLight( 0x555555 );
scene.add(ambient);

var light = new THREE.DirectionalLight( 0xffffff );
light.position = camera.position;
scene.add(light);

var renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Definition 2
var geometry2 = new THREE.SphereGeometry(0.8,32,24);
var material2 = new THREE.MeshLambertMaterial({color: 0x0000ff, transparent: true, opacity: 0.5});
var sphere2 = new THREE.Mesh(geometry2, material2);

// Definition 1
var geometry1 = new THREE.SphereGeometry(1.0,32,24);
var material1 = new THREE.MeshLambertMaterial({color: 0x00ff00, transparent: true, opacity: 0.5});
var sphere1 = new THREE.Mesh(geometry1, material1);

scene.add(sphere1);
scene.add(sphere2);

renderer.render(scene, camera); 
```

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2013-04-14T03:30:45.137

你的两个球体都是透明的，并且一直如此。发生的事情是较小的球体根本没有被渲染。

WebGL 中的透明度很棘手。您可以搜索该问题以了解更多信息。

但是您偶然发现了一个与*three.js 特别是*如何处理透明度相关的问题。

three.js`WebGLRenderer`中的对象根据与相机的距离对对象进行排序，并按照从最远到最近的顺序渲染透明对象。（这是很重要的一点：它根据*对象*的*位置*对对象进行排序，并按排序顺序呈现*对象*。）

因此，要正确渲染两个透明对象，必须先渲染后面的对象（在您的情况下是较小的球体）。否则，由于深度缓冲区，它根本不会被渲染。

但是在您的情况下，您有两个位于同一位置的球体，因此与相机等距。这就是问题——首先渲染哪个；这是一个折腾。

因此，您需要将较小的球体放置得比较大的球体更远离相机，以便正确渲染场景。

一种解决方案是将较小的球体向后移动一点。

另一种解决方案是设置`renderer.sortObjects = false`. 然后对象将按照它们添加到场景中的顺序进行渲染。在这种情况下，请务必先将较小的球体添加到场景中。

第三种解决方案是设置`material1.depthWrite = false`和`material2.depthWrite = false`。

编辑：

具有`material.transparent = false`（不透明对象）的可渲染对象在具有`material.transparent = true`（透明对象）的对象之前渲染。

所以第四个解决方案是使较小的球体不透明，以便首先渲染它。

r.71 的新功能：

现在有一处`Object3D.renderOrder`房产。在每一类对象（不透明或透明）中，对象按 指定的顺序呈现`object.renderOrder`。`renderOrder`的默认值为`0`。注意`renderOrder`不被子对象继承；您必须为每个可渲染对象设置它。

`renderOrder`如上所述，具有相同（关系）的对象按深度排序。

所以第五个解决方案是设置`renderOrder = 1`更大的球体。在您的情况下，这可能是最好的解决方案。

三.js r.71

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-14T02:53:52.130

一对夫妇的评论。

第一的。如果您要问一个希望人们审查代码的问题，请将其放在 jsfiddle 中。如果你这样做，你会让更多的人偷看。话虽如此，这里是您在 jsfiddle 中的代码稍作修改的版本，请将其用作未来问题的指南。 [jsfiddle 示例](http://jsfiddle.net/crossphire/9eXKN/)

```
var scene = new THREE.Scene();
var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);

camera.position.set(0, 0, 3);
camera.lookAt(new THREE.Vector3(0, 0, 0));
scene.add(camera);

var ambient = new THREE.AmbientLight( 0x555555 );
scene.add(ambient);

var light = new THREE.DirectionalLight( 0xffffff );
light.position = camera.position;
scene.add(light);

var renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

renderer.sortObjects = false;

// Definition 2
var geometry2 = new THREE.SphereGeometry(0.8,32,24);
var material2 = new THREE.MeshLambertMaterial({color: 0x0000ff, transparent: true, opacity: 0.5});
var sphere2 = new THREE.Mesh(geometry2, material2);

// Definition 1
var geometry1 = new THREE.SphereGeometry(1.0,32,24);
var material1 = new THREE.MeshLambertMaterial({color: 0xff0000, transparent: true, opacity: 0.5});
var sphere1 = new THREE.Mesh(geometry1, material1);

scene.add(sphere2);
scene.add(sphere1);

renderer.render(scene, camera); 
```

我在您的代码中所做的更改是将 sortObjects 设置为 false，然后更改球体添加到场景中的顺序。这样做是因为接下来 2 个链接中的信息

[WebGL 透明平面](https://stackoverflow.com/questions/11165345/three-js-webgl-transparent-planes-hiding-other-planes-behind-them) [透明纹理行为](https://stackoverflow.com/questions/8763603/transparent-textures-behaviour-in-webgl)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-23T18:54:16.963

对于它的价值，我无法使用上述方法解决相同的问题，但发现具有：

```
scene = new THREE.Scene();
group = new THREE.Group();
scene.add( group ); 
```

在我的 init() 中，然后将正面网格添加到场景中，但是要分组的背面网格解决了这个问题。IE：

```
var materialfront = new THREE.MeshPhongMaterial({ 
opacity:1, map:texture });
materialfront.transparent = true ;     
materialfront.side = THREE.FrontSide ; 
frontthing = new THREE.Mesh( geometry, materialfront );
frontthing.renderOrder = 2;
scene.add(frontthing); 
```

然后

```
var texture2 = texture.clone();
texture2.needsUpdate = true;
var materialBack = new THREE.MeshPhongMaterial({
opacity:0.1, map: texture2})
materialBack.transparent = true ;
materialBack.side = THREE.BackSide;
backthing = new THREE.Mesh( geometryback, materialBack );
backthing.renderOrder = 1;
group.add(backthing); 
```

我的材质贴图是透明的 .png 纹理。

我无法解释为什么其他建议的方法对我不起作用，但我希望以上内容可能对处于类似位置的人有所帮助。

# r - R中某些点的条件着色散点图

> ID：15994945
> 
> 赞同：2
> 
> 时间：2013-04-14T01:58:26.187
> 
> 标签：r, scatter-plot

我正在绘制我关心的两条数据，**medv**和**lstat**。

我已经使用箱线图绘制了这两个，它们被称为**lstatBox**和**medvBox**。我这样做的原因是因为我想访问这两组数据的异常值。

访问异常值是这样完成的......

```
>lstatBox$out
[1] 34.77 34.37 34.41 34.02 36.98 37.97 

>medvBox$out    
[1] 50.0 43.1 39.8 50.0 43.5 50.0 50.0 50.0 46.7 50.0 48.3 50.0 50.0 50.0 48.5 42.3 37.6 37.9 50.0 41.7 41.3 50.0 50.0 46.0
[25] 48.8 50.0 38.7 50.0 45.4 37.2 44.0 43.8 37.3 42.8 50.0 44.8 50.0 
```

我目前可以通过这样做来制作散点图....

```
plot(medv,lstat) 
```

但是，我希望每个类的异常值是不同的颜色。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T02:18:13.300

您可以创建一组异常颜色：

```
outlier.colors <- (medv %in% medvBox$out)*1 + (lstat %in% lstatBox$out)*2
outlier.colors <- outlier.colors + 1

plot(medv, lstat, col=outlier.colors) 
```

# javascript - 禁用 CakePHP FormHelper 生成的按钮

> ID：15994946
> 
> 赞同：1
> 
> 时间：2013-04-14T01:58:30.827
> 
> 标签：javascript, jquery, cakephp

我正在使用 CakePHP FormHelper 生成的提交按钮。单击按钮后，我想使用 jQuery 禁用它。我尝试使用正常的“禁用”属性，但没有做任何事情。

如何禁用该按钮以防止意外重新提交表单？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T02:21:12.053

禁用表单可能是一个更好的解决方案，以防止除了单击提交按钮之外的提交，例如在文本输入中按 Enter。您可以`data-disabled`在第一次提交后在表单上设置属性，如果设置了，则在后续提交时阻止它。

```
$('form').on('submit', function(e) {
    var $form = $(this);

    if($form.attr('data-disabled') === true) {
        e.preventDefault();
        return false;
    }
    $form.attr('data-disabled', true);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-25T08:34:52.730

您只需将提交按钮添加到您的表单并在单击后禁用提交按钮

```
<?php 
        echo $this->Form->input('submitButton', array(
        'id' => 'submit',
        'type' => 'submit',
        'label' => '',
        'onclick' => '$(#"submit").disabled = true;'
        ));
?> 
```

# php - 如何使用 Ajax 将 javascript 数组与其他非数组数据一起发送到 PHP 脚本？

> ID：15994950
> 
> 赞同：1
> 
> 时间：2013-04-14T01:59:51.680
> 
> 标签：php, javascript, jquery, ajax

我有一个用户可以订购商品的网站。我目前正在向 PHP 脚本发送各种信息，以便可以从那里将它们添加到数据库中：

```
$.ajax ({
  type: "POST",
  url: "./pay.php",
  dataType: "json",
  data: {
    "firstName" : firstName,
    "lastName" : lastName,
    "email" : email,
    "price" : price
  }  
}); 
```

这运作良好。现在我想发送两个数组，其中包含 id 和订购的产品数量。由于我不知道在任何给定点有多少产品或它们的 id 是什么，我不能像上面所做的那样将它们添加为单独的项目。目前，我将产品 ID 及其相应的数量放在单独的数组中，如下所示：

```
productIds: ["6", "1"]
quantities: ["1", "4"] 
```

我想将这些数组与其余变量一起发送到 PHP 脚本，这样我就可以遍历这些数组并将信息插入数据库。

我可以这样做吗？

```
$.ajax ({
      type: "POST",
      url: "./pay.php",
      dataType: "json",
      data: {
        "firstName" : firstName,
        "lastName" : lastName,
        "email" : email,
        "price" : price,
        "productIds" : productIds,
        "quantities" : quantities
      }  
 }); 
```

我目前能够在 PHP 脚本中像这样访问的非数组变量：

```
$email = $_POST['email'];
$firstName = $_POST['firstName'];
$lastName = $_POST['lastName'];
$price = $_POST['price']; 
```

我想在 PHP 脚本中像这样循环遍历 productIds 数组，但我想我遗漏了一些东西：

```
$i = 1;
foreach ($_POST['productIds'] as $value) {
  $sql = 'INSERT INTO orders SET
  product_id = "'.$_POST['productIds'][$i].'",
  quantity = "'.$_POST['quantities'][$i].'"';

  $result = $conn->query($sql);
  $i++;
} 
```

如何使用 Ajax 将 javascript 数组与其他非数组数据一起发送到 PHP 脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T02:05:18.167

只需将数组传递给 data 参数

```
var productIds = ["6", "1"];
var quantities = ["1", "4"];
$.ajax ({
  type: "POST",
  url: "./pay.php",
  dataType: "json",
  data: {
    "firstName" : firstName,
    "lastName" : lastName,
    "email" : email,
    "price" : price,
    "productIds": productIds,
    "quantities": quantities
  }  
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T02:09:39.633

您可以在收集表单数据时立即形成一个 JavaScript 对象。将该对象直接发送到 PHP。像这样：

```
//Your object could look like this
var data = {
    name: 'blah',
    product_data: {
        '<some product id>': '<some product name>',
        '<another product id>': '<another product name>'
    }
} 
```

`product_data`在 PHP 端，您可以通过$_POST中的键以关联数组的形式访问产品数据`array`。现在由您决定如何收集表单数据。

**更新：**

```
$products = $_POST['product_data'];
foreach($products as $product_id => $product_name){
    echo $product_id.', '.$product_name;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T02:08:40.603

PHP 将接受数组参数，但您必须以可接受的形式发送参数，

```
<?php
    $str = "first=value&arr[]=foo+bar&arr[]=baz";
    parse_str($str);
    echo $first;  // value
    echo $arr[0]; // foo bar
    echo $arr[1]; // baz

    parse_str($str, $output);
    echo $output['first'];  // value
    echo $output['arr'][0]; // foo bar
    echo $output['arr'][1]; // baz
?> 
```

对于 HTTP 帖子，您可以简单地通过`$_POST`变量访问数组。

在 JavaScript 方面，代码是这样的，

```
$.post(url, {'arr[]': array}, function(data){
    // do something with received data
}); 
```

# php - 我在哪里放 substr？

> ID：15994957
> 
> 赞同：0
> 
> 时间：2013-04-14T02:02:21.030
> 
> 标签：php

我需要添加此代码，`substr`以将描述输出限制为 100 个字符：

```
description=<?=nl2br(strip_tags($v['listing_description']));?> 
```

我在哪里以及如何添加`substr`到这一行？

我尝试了几种不同的方法，都没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T02:03:49.890

`substr`介于和`nl2br`之间`strip_tags`：

```
description=<?=nl2br(substr(strip_tags($v['listing_description']), 0, 100));?> 
```

这样做的原因是因为您*首先*想要`strip_tags`（最里面的括号），*然后* `substr`是 100 个字符，*然后*将换行符转换为`<br>`s。

# ios - UIActivityViewController - 仅附加特定活动的 URL

> ID：15994961
> 
> 赞同：9
> 
> 时间：2013-04-14T02:03:01.407
> 
> 标签：ios, objective-c, xcode, url, uiactivityviewcontroller

我一直在尝试使用新的 UIActivityViewController 来替换我所有的 UIActionSheets 进行共享，但是我遇到了一个问题。

我有 5 个活动，消息、电子邮件、复制、Twitter 和 Facebook。我已经想出了如何让它们显示不同的文本，通过这个在自定义 UIActivityProvider 子类中：

```
- (id) activityViewController:(UIActivityViewController *)activityViewController
      itemForActivityType:(NSString *)activityType
{
    if ( [activityType isEqualToString:UIActivityTypePostToTwitter] )
        return twitter;
    if ( [activityType isEqualToString:UIActivityTypePostToFacebook] )
        return facebook;
    if ( [activityType isEqualToString:UIActivityTypeMessage] )
        return urlScheme;
    if ( [activityType isEqualToString:UIActivityTypeMail] )
        return urlScheme;
    if ( [activityType isEqualToString:UIActivityTypeCopyToPasteboard])
        return urlScheme;
    return nil;
} 
```

这在我的视图控制器中：

```
 ActivityProvider *aProvider = [[ActivityProvider alloc] init];
    aProvider.facebook = facebook;
    aProvider.twitter = twitter;
    aProvider.urlScheme = URL;

    NSArray *Items = @[aProvider, sharedURL];

    UIActivityViewController *activityVC = [[UIActivityViewController alloc]initWithActivityItems:Items applicationActivities:Nil];
    activityVC.excludedActivityTypes = @[UIActivityTypePrint, UIActivityTypeAssignToContact,UIActivityTypeSaveToCameraRoll, UIActivityTypePostToWeibo];

    [self presentViewController:activityVC animated:TRUE completion:nil]; 
```

但是，我只想在 Facebook 和 Twitter 共享表中显示 URL (sharedURL)，而不是消息、电子邮件或副本。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-14T03:30:38.097

您可以选择要发送到每种类型的活动的内容。我创建了一个自定义活动提供程序并像这样调用它：

```
 NSMutableArray *activityItems = [NSMutableArray array];

     CustomActivityItemProvider *activityItemProvider =
     [[CustomActivityItemProvider alloc] initWithText:text
                                                     urlText:urlString];

     [activityItems addObject:activityItemProvider];

     //you can have your own custom activities too:
     NSArray *applicationActivities = @[[CustomActivity new],
                                              [OtherCustomActivity new]];
     UIActivityViewController *vc = [[UIActivityViewController alloc]initWithActivityItems:activityItems
                                                                     applicationActivities:applicationActivities]; 
```

自定义提供者是 UIActivityItemProvider 的子类

```
@interface CustomActivityItemProvider : UIActivityItemProvider

- (id)initWithText:(NSString *)text urlText:(NSString *)url;

@end 
```

我的自定义提供程序类的内容如下所示：

```
- (id)initWithText:(NSString *)text urlText:(NSString *)url{

    if ((self = [super initWithPlaceholderItem:text])) {       
        self.text = text ?: @"";
        self.url = url ?: @"";
    }   
    return self;
}

- (id)item {   
    NSString *activityType = self.activityType;
    if ([self.placeholderItem isKindOfClass:[NSString class]]) {            
        if ([self.activityType isEqualToString:UIActivityTypePostToFacebook] ||
            [self.activityType isEqualToString:UIActivityTypeMail]) {

            return [NSString stringWithFormat:@"%@\n%@", self.text, self.url];

        } else if ([activityType isEqualToString:UIActivityTypePostToTwitter]) {

            return [self findBestStringOfLength:kTwitterMessageLength hashTags:YES];

        } else if ([activityType isEqualToString:UIActivityTypeMessage]) {

            return [self findBestStringOfLength:kSMSMessageLength hashTags:YES];

        } else {
            return self.text;
        }
    }

    return self.placeholderItem;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-16T14:35:21.993

您应该能够实现自己的 UIActivityItemProvider，并为您不想使用该数据的任何活动类型返回 nil。

# c++ - c++ 代码中的错误可能指针未指向任何内容

> ID：15994963
> 
> 赞同：0
> 
> 时间：2013-04-14T02:03:24.893
> 
> 标签：c++, debugging, pointers

```
#include "BST.hpp"
#include <iostream>
#include <algorithm>
#include <vector>

using namespace std;

int main() {

  /* Create an STL vector of some ints */
  vector<int> v;
  v.push_back(3);
  v.push_back(4);
  v.push_back(1);
  v.push_back(100);
  v.push_back(-33);

  /* Create an instance of BST holding int */
  BST<int> b;

  /* Insert a few data items. */
  vector<int>::iterator vit = v.begin();
  vector<int>::iterator ven = v.end();

  for(; vit != ven; ++vit) {
    // all these inserts are unique, so should return a std::pair
    // with second part true
    std::pair<BST<int>::iterator,bool> pr = b.insert(*vit);
    if(! pr.second ) {
      cout << "Incorrect bool return value when inserting " << *vit << endl;
      return -1;
    }

    if(*(pr.first) != *vit) {
      cout << "Incorrect iterator return value when inserting " << *vit << endl;
      return -1;
    }       
  } 
```

程序抱怨这行代码

```
if(*(pr.first) != *vit) 
```

以及关于这行代码

```
 BSTIterator(BSTNode<Data>* curr) {
this->curr = curr; 
```

}

这是在不同的头文件中。我已经被这个错误困住了 2 天了，我仍然不知道如何解决它。顺便说一句，这个错误是一个运行时错误，因为它没有给出标准的编译错误输出。我的猜测是指针没有指向任何东西，但我可能又错了。我能得到一些关于从哪里开始寻找错误或如何解决它的线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:26:04.420

是的，取消引用 NULL 指针通常会导致分段错误或核心转储。

通常建议在取消引用 NULL 之前进行检查。除非您正在创建一个类（如这里）并且您希望用户进行该检查，就像您必须对 std::vector 一样。

如果您的插入函数曾经返回一个 NULL 迭代器，那么这将导致您取消引用一个 NULL 迭代器，您可以使用

```
if(!pr.first || *(pr.first) != *vit) 
```

如果 pr.first 为 NULL，那么它将进入 if 语句并显示您的错误。

由于 NULL==0==False。

# c++ - 字符串和递归

> ID：15994971
> 
> 赞同：1
> 
> 时间：2013-04-14T02:04:17.903
> 
> 标签：c++, string, recursion

所以我在网上四处寻找，发现有人发布了一些作业问题，我想我想试一试。它处理一个类和一个我不想尝试的称为派生类的东西，（主要是因为我不知道那是什么），但我看到了这些要求，想知道它们是否都可以完成递归，使用类似 void 或 int 函数。这是我所拥有的：

> 一个称为 strLength 的方法，它返回字符串的长度。
> 
> 一个称为 lowerCase 的方法，它返回小写字符的数量。
> 
> 一个名为 upperCase 的方法，它返回大写字符的数量。
> 
> 一个名为 vowelCnt 的方法，它返回字符串中元音的数量。
> 
> 一种称为 charSum 的方法，它返回字符串中所有字符的总和。

我想我可以做到最后一个：

```
int charSum(string x, int i)
{
  if(x.size() == i)
    return (0 + x[i]);
  else
    return charSum(x, i + 1) + x[i];
} 
```

虽然我不太确定用实际的 char 来做，但是为了练习和看看它是如何使用递归完成的，我不太担心天气它是一个 char 还是一个字符串，只是它可以工作。

检查一下，我找到了这个，（注意，我没有想出这个，一个叫 eazar001 的人做了......）：

```
int countString(char sample[], int i, int total)
 {
   if(sample[i] == 0)
   {
       return total;
   }
   else
   {
       return countString(sample, i+1, ++total);
   }
 } 
```

有谁知道如何处理列表中的其他内容，或者有什么可以指点我的东西，可以告诉我如何扫描字符串以查找这些东西，（尤其是大写和小写的东西，我不知道那里是有区别的）。感谢任何愿意在我尝试自学时带我学习这些东西的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:40:30.300

```
int strlen1(char * s){
    if(*s=='\0') return 0;
    else return strlen1(++s)+1;
}
int lowercase_count(char *s){
    if(*s=='\0') return 0;
    else if(*s>=97 && *s<=97+26) return lowercase_count(++s)+1;
    else return lowercase_count(++s);
}
int uppercase_count(char *s){
    if(*s=='\0') return 0;
    else if(*s>=65 && *s<=65+26) return uppercase_count(++s)+1;
    else return uppercase_count(++s);
}
int isVowel(char c){
    char v[10]={'a','e','i','o','u','A','E','I','O','U'};
    int i;
    for(i=0;i<10;i++)
        if(v[i]==c) return 1;
    return 0;
}
int vowel_count(char *s){
    if(*s=='\0') return 0;
    else if(isVowel(*s)) return vowel_count(++s)+1;
    else return vowel_count(++s);
} 
```

# jquery - Jquery UI 对话框（方法？）

> ID：15994973
> 
> 赞同：0
> 
> 时间：2013-04-14T02:04:23.660
> 
> 标签：jquery

我有这个 jQuery UI 对话框

单击删除时，会打开一个窗口并出现表单。

窗口上有一个确定按钮。单击时没有任何反应。也许我需要设置方法，但确定按钮链接到下面的 JS。

如何正确设置方法？

Javascript确定按钮：

```
$( "#dialog-message" ).dialog({
    autoOpen: false,
    modal: true,
    buttons: {
        OK: function() {
            $( this ).dialog( "close" );
        }
    }
}); 
```

用户界面对话框：

```
 <div class="widget">    
        <div class="head"><h5 class="iAlert">DELETE</h5></div>
        <div class="body aligncenter">
            <div class="uDialog">
                <div id="dialog-message" title="Delete">
                    <p><img src="images/exclamation.png" alt="" class="icon" /><br/>
                    <br/>
                    </p>
                    <div class="aligncenter">Input your password</div>
                    <div class="uiForm">
                        <form method="post" action="delete.php" class="mainForm">
                            <input type="password" value="" name="inputtext"/>
                        </form>                            
                    </div>
                </div>
                <!-- Sample page content to illustrate the layering of the dialog -->
                <input type="button" value="DELETE" class="redBtn" id="opener" />
            </div>

        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T02:21:34.140

我在下面修改了 OK 函数，其中 #delete 是表单 ID。

```
$( "#dialog-message" ).dialog({
    autoOpen: false,
    modal: true,
    buttons: {
    OK: function() {
    //$( this ).dialog( "close" );
            $("#delete").submit();

        }
    }
}); 
```

# c++ - 是否可以制作一个用分号替换换行符的宏

> ID：15994974
> 
> 赞同：2
> 
> 时间：2013-04-14T02:04:25.360
> 
> 标签：c++, macros

假设有人真的很懒，不想一直记住在行尾输入分号，有没有办法用宏来解决这个问题？

我不是说这是我想做的事情。只是好奇是否有人尝试过/如果可能的话。

就像是：

```
#define '\n'  ';\n' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T02:09:17.373

不可以，宏标识符只能是字母、数字和下划线。

此外，这会导致大量不必要的分号

```
if (cond)
    stmt;
/* or */
if (cond)
{
    stmts;
} 
```

会被这个理论宏毁掉。

如果您想用分号后跟换行符替换所有换行符（这是一个**非常糟糕的主意**），您可以使用 sed 行

```
sed -i "s/^\([^#].*[^\;{]\)$/\1;/" file.cpp 
```

这将在任何行的末尾添加一个分号：

1.  尚未以分号结尾
2.  不是开头`#`
3.  不以 a 结尾`{`

虽然这仍然不完美。总会有你不想以分号结尾的情况，这会导致代码无法编译，尽管这比上面的 ifs 是空语句要好。

```
int var = //like here
    some_value;

func(arg1, arg2, // and here
     arg3, arg4);

int func()  // and here too
{
    //body
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T02:06:52.797

您不会在每行末尾自动需要分号。

没有办法编写用分号替换换行符的 C 预处理器宏，因为 C 宏名称必须是标识符——以非数字字符开头的字母数字字符（加上下划线）序列。

你必须这样做：

```
#define SC ;

int x = 0 SC 
```

这比您要解决的问题更糟糕。

# clojure - Clojure：原子和参考的惯用用法？

> ID：15994976
> 
> 赞同：3
> 
> 时间：2013-04-14T02:05:03.963
> 
> 标签：clojure, idioms, ref, stm

我正在编写一些 Clojure 代码，它将引用映射并增加映射中的键值对。我认为我正确使用了 ref，但我不确定 atom。我需要使用swap吗！更地道？我是 STM 和 Clojure 的新手，这看起来是线程安全的/理智的吗？我错过了什么？

```
(defn increment-key [ref key]
    (dosync
        (if (= (get @ref key) nil)
            (alter ref assoc key (atom 1))
            (alter ref assoc key (atom (inc @(get @ref key)))))))

(defn -main [& args]
    (def my-map (ref {}))
    (increment-key my-map "yellow")
    (println my-map)
    (increment-key my-map "yellow")
    (println my-map)) 
```

印刷

```
$ lein run
#<Ref@494eaec9: {yellow #<Atom@191410e5: 1>}>
#<Ref@494eaec9: {yellow #<Atom@7461373f: 2>}> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T03:05:46.167

It's not very idiomatic Clojure to do this: embedding mutable objects within a persistent data structure generally defeats the whole point of immutable data structures.

I would avoid the internal atom entirely, and just have a number associated with the key. Then the entire data structure contained within `my-map` will be immutable.

As for the thread safety: it really depends on how you are going to use it. A `ref` appears to be overkill in this case as it is only really needed when you need to co-ordinate transactions across multiple refs, which you don't have here. Probably an `atom` is sufficient for what you are trying to do.

Here's how you might tackle it instead:

```
(defn increment-key [ref key]
  (swap! ref update-in [key] (fn [n] (if n (inc n) 1))))

(def my-map (atom {}))
(increment-key my-map "yellow")
(println my-map)  ;; => {"yellow" 1}
(increment-key my-map "yellow")
(println my-map)  ;; => {"yellow" 2} 
```

**EDIT**: even better would be to keep mutability out of your functions and define increment-key as a pure function.

```
(defn increment-key [m key]
  (assoc m key (if-let [n (m key)] (inc n) 1)))

(def my-map (atom {}))
(swap! my-map increment-key "yellow")
(println my-map)   ;; => {"yellow" 1}
(swap! my-map increment-key "yellow")
(println my-map)   ;; => {"yellow" 2} 
```

# java - 单击 JRadioButton 时更改 JLists

> ID：15994977
> 
> 赞同：0
> 
> 时间：2013-04-14T02:05:05.323
> 
> 标签：java, swing, user-interface, nullpointerexception

在我的 GUI 中，我有 3 个单选按钮，它们属于同一个 ButtonGroup。我试图得到它，以便在单击任何一个按钮时，都会出现一个 JList 。在我的动作监听器中，我编写了 JLists，但是当我尝试运行它时，我得到了 NullPointerException。我尝试将 JList 放在动作侦听器之外并且它可以工作，所以我很确定我的动作侦听器有问题。我的按钮按照我的意愿出现在 GUI 中。

它是主 GUI 类中的一个内部类：

```
 rbGenCancers = new JRadioButton("genCan");
    rbRelCancers = new JRadioButton("relCan");
    rbCancers = new JRadioButton("nonC");
    ButtonGroup bg = new ButtonGroup();
    bg.add(rbGenCancers);
    bg.add(rbRelCancers);
    bg.add(rbCancers);

    JPanel rbButtons = new JPanel(new FlowLayout(3, 2, 2));
    rbButtons.add(rbGenCancers);
    rbButtons.add(rbRelCancers);
    rbButtons.add(rbCancers);
    //added to the JFrame correctly through GridBagLayout and GridBagConstraints

 public class RadioButtonListener implements ActionListener {

    @Override
    public void actionPerformed(ActionEvent e) {
        switch(e.getActionCommand()) {
            case "genCan":
                listModel = new DefaultListModel();
                for(int i = 0; i < 8; i++) {
                    cancerNames = _controller.selectGeneralCancer(i);
                    listModel.addElement(cancerNames);
                }
                cancerList = new JList(listModel);
                cancerList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
                cancerList.setSelectedIndex(-1);
                cancerList.setVisibleRowCount(3);
                cancerListScroller = new JScrollPane(cancerList);
                break;
            case "relCan":
                listModel = new DefaultListModel();
                for(int i = 0; i < 22; i++) {
                    split = _controller.readCancer(i);
                    cancerNames = split[0];
                    listModel.addElement(cancerNames);
                }
                cancerList = new JList(listModel);
                cancerList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
                cancerList.setSelectedIndex(-1);
                cancerList.setVisibleRowCount(3);
                cancerListScroller = new JScrollPane(cancerList);
                break;
            case "nonC":
                listModel = new DefaultListModel();
                for(int i = 22; i < 36; i++) {
                    split = _controller.readCancer(i);
                    cancerNames = split[0];
                    listModel.addElement(cancerNames);
                }
                cancerList = new JList(listModel);
                cancerList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
                cancerList.setSelectedIndex(-1);
                cancerList.setVisibleRowCount(3);
                cancerListScroller = new JScrollPane(cancerList);
                break;
        }
    }

} 
```

下面是抛出的异常：

```
Exception in thread "main" java.lang.NullPointerException
at java.awt.Container.addImpl(Container.java:1086)
at java.awt.Container.add(Container.java:998)
at javax.swing.JFrame.addImpl(JFrame.java:562)
at java.awt.Container.add(Container.java:966)
at Cancer.gui.CancerGUI.<init>(CancerGUI.java:306)
at Cancer.run.CancerApp.main(CancerApp.java:19)
Java Result: 1
BUILD SUCCESSFUL (total time: 2 seconds) 
```

这是执行所有代码的类。打印堆栈中的第 19 行对应于 CancerGUI _gui = new CancerGUI(); CancerGUI 中的第 306 行对应于我通过 GridBagConstraints 将cancerListScroller 添加到 JFrame 的位置。

```
public class CancerApp {
public static void main(String[] args) {
    CancerGUI _gui = new CancerGUI();
    Disease _disease = new Disease();
    CancerController _controller = new CancerController(_disease, _gui);
    _gui.setController(_controller);

    CancerApp _app = new CancerApp();
    _app.run(_gui);
}

public void run(CancerGUI _gui) {
    _gui.setVisible(true);   
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-21T20:13:51.093

我也有同样的想法。单选按钮有效，但我的动作侦听器似乎没有使用 setModel(listmodel) 设置新列表。我没有例外。当我确实遇到异常时，那是因为类型不匹配。这些可能会令人愤怒。我会仔细检查以确保消息通过，但它应该。

```
 else if(ae.getActionCommand().equals("chooseTitle"))
{
  jlst.setModel(lm);
} 
```

它可能工作正常，但我必须做一些事情才能让它显示？

# python - Python - 从文件夹中读取所有文件（.shp、.dbf、.mxd 等）

> ID：15994981
> 
> 赞同：3
> 
> 时间：2013-04-14T02:05:39.340
> 
> 标签：python, arcgis

谁能帮我？我正在尝试编写一个从数据文件夹中读取所有文件的代码。这些文件都有不同的扩展名：.shp、.dbf、.sbx、.mxd）我使用的是 Windows。谢谢。

我有：

```
import os    
path=r'C:\abc\def\ghi\'    
folderList = os.listdir(path) 
```

现在我需要读取文件夹中的所有文件，所以我知道我需要类似的东西

`f.open(path)`?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T02:34:40.987

你走在正确的道路上：

```
import os
path = r'C:\abc\def\ghi'  # remove the trailing '\'
data = {}
for dir_entry in os.listdir(path):
    dir_entry_path = os.path.join(path, dir_entry)
    if os.path.isfile(dir_entry_path):
        with open(dir_entry_path, 'r') as my_file:
            data[dir_entry] = my_file.read() 
```

# java - Robolectric 测试：无法获取语言环境

> ID：15994982
> 
> 赞同：0
> 
> 时间：2013-04-14T02:05:41.467
> 
> 标签：java, android, unit-testing, robolectric, android-testing

我正在使用 robolectric 框架来测试我的 android 项目。它工作得很好，但我找不到解决问题的方法：

在我的活动课上，我必须采用以下当前语言：

```
private void setCurrentLanguageChoosenInRadioGroup() {
    Configuration c = new Configuration(getResources().getConfiguration());
    String locale = c.locale.getLanguage();

    if(locale.equalsIgnoreCase(Constants.DUTCH_LANGUAGE)){          
        radioLanguageGroup.check(dutchButton.getId());
    }
    else if(locale.equalsIgnoreCase(Locale.FRENCH.getLanguage())){
        radioLanguageGroup.check(frenchButton.getId());
    }
    else if(locale.equalsIgnoreCase(Locale.ENGLISH.getLanguage())){
        radioLanguageGroup.check(englishButton.getId());
    }
} 
```

但在“c.locale.getLanguage();”这一行 我得到空指针异常。这是我的测试方法：

```
public void setUp() throws Exception {
    activity = new MainActivity();
    activity.onCreate(null); .... 
```

有谁知道问题是什么以及如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T04:16:25.907

您正在获得 NPE，因为未设置区域设置字段。如果在实例化`Configuration`对象后调试并在行上放置断点，请注意加载的实际类。你会看到它不是`Configuration`，它是`ShadowConfiguration`。

您可以在此处查看源代码：[https ://github.com/pivotal/robolectric/blob/master/src/main/java/org/robolectric/shadows/ShadowConfiguration.java](https://github.com/pivotal/robolectric/blob/master/src/main/java/org/robolectric/shadows/ShadowConfiguration.java)

我假设（没有实际运行您的代码）`getResources().getConfiguration()`返回 null，或者没有设置语言环境。ShadowConfiguration 中有一个 setLocale 方法，您可以在测试中设置该方法来操作`setCurrentLanguageChoosenInRadioGroup()`方法中的逻辑流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T14:57:54.083

将 robolectric 更新到 2.x 版本可以解决问题！在他们网站上的默认版本 0.9.x 中，它不适用！

因此，它可以通过这种方式进行调整：

```
Locale loc = new Locale("desired language/country");
Configuration c = new Configuration();
c.setLocale(loc); 
```

# php - 在 PHP/CSS 中添加滚动条

> ID：15994983
> 
> 赞同：1
> 
> 时间：2013-04-14T02:05:46.637
> 
> 标签：php, css

如何将滚动条添加到数据库输出的信息中：

IE：

```
DATA   S  /\
DATA   C  ||
DATA   R  ||
DATA   O  ||
DATA   L  ||
DATA   L  ||
DATA   B  ||
DATA   A  ||
DATA   R  \/ 
```

代码：

```
<?php
   mysql_connect("localhost","user","pass") or die("Could not connect to localhost");
   mysql_select_db("db") or die( "Could not connect to database");
?>

    <p class="scroll">
<?php
   $result = mysql_query("SELECT * FROM this ORDER BY name ASC");

    while ($row = mysql_fetch_array($result)) {
        echo "<div style='margin: 0 auto;'>
                    <span style='display:inline-block; width:200px; text-align:left;'>" . ucwords($row['name']) . "</span>
                    <span style='display:inline-block; text-align:left;'>" . ucwords($row['number']) . "</span>
                </div>
                <br>";
   }
?>
   </p>
 </font>
</div> 
```

[CSS]

```
.scroll 
{
    overflow:scroll;
} 
```

如何将滚动条添加到输出的右侧并使其向下滚动以查看显示的所有数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T02:24:45.400

尝试这个...

```
.scroll {
    width: 100px;
    height: 100px;
    overflow: scroll;
} 
```

这是[jsfiddle](http://jsfiddle.net/JtUz6/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T02:25:42.607

尝试这个：

```
.scroll {
    overflow-y: scroll;
    width: 200px;
    height: 200px;
} 
```

`overflow: scroll;`除非您还想要一个水平滚动条，否则您不想要。你还需要给它一个宽度和高度。

# c++ - 我可以编写一个与带有引用参数的 C++ 函数兼容的 C 函数吗？

> ID：15994986
> 
> 赞同：1
> 
> 时间：2013-04-14T02:06:03.983
> 
> 标签：c++, c

我正在为 C++ 库添加 C 包装器。在某些情况下，应将用户定义的回调函数传递给库。并且回调函数的原型有引用参数。例如：

```
typedef void (*callBackFunc)(A& a, B& b);  //A, B are classes 
```

我想在外部头文件中使用下面的 C 原型和包装库中内置的一些帮助函数来解释对象 a 和 b。

```
typedef void (*callBackFunc)(void *a, void *b); 
```

包装库中的辅助函数：

```
extern "C" int getValueFromA(void *a) {
    A* pa = (A *)a;
    return pa->value;
}
.... 
```

这种方法行得通吗？我不确定参考参数是如何实现的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T02:25:18.137

从 C++ 调用 C 会有些痛苦；试图从 C 调用 C++对非受虐狂来说是非常痛苦的*。*它取决于编译器、运行时版本和许多其他细节。你必须确保你的 C 程序设置了 C++ 环境，构造了所有使用的全局对象，......当你最终让它工作时，下一个编译器将继续运行并破坏你所有的逆向工程工作。

此外，“C 函数引用”根本不存在。*那*需要有趣的脚手架……在栅栏的*两边*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T04:26:27.703

传递引用只是问题的一部分。如果 A & B 是 POD 类，那么您可以使用转发 C++ 包装器使其工作，但它可能不符合标准。并且可能会在未来的编译器版本等或不同的编译器中中断。如果 A&B 包含方法，并且回调需要调用这些方法，那就更难了。

# ipython - 让 IPython 使用我原来的启动脚本

> ID：15994989
> 
> 赞同：3
> 
> 时间：2013-04-14T02:06:48.467
> 
> 标签：ipython, startupscript

我已经为 python 设置了一个 startup.py 脚本，它导入了常用的模块，如 re、os 和 sys。然而，Ipython 似乎并没有在启动时运行它，因为尝试使用其中一个模块会引发错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T03:16:35.443

如果你将你`startup.py`的文件放到 找到的目录中`$(ipython locate profile)/startup/`，那么它将在每次 IPython 启动时运行（你可能需要先创建`startup`目录）。

# c++ - “检查”如果两个不同的几何形状对象发生碰撞

> ID：15994993
> 
> 赞同：2
> 
> 时间：2013-04-14T02:07:28.813
> 
> 标签：c++, c, geometry

我只是想“检查”两个不同几何形状的物体是否发生碰撞。一个是圆形，第二个是正方形。我搜索了谷歌以找到一个简单的示例并从中学习，因为我不知道该怎么做。我找到了这个例子，试过了，但什么也没发生。代码中大多数存在错误。请帮助我用 C 或 C++ 语言更正它。

```
bool Collision(int circleX, int circleY, int radius, int squareX, int squareY, int width, int height)
{
    int distance = 0;

    if(circleX < squareX) 
        distance += pow(circleX - boxX,2); //x-axis
    else if (circleX > squareX + width)
        distance += pow(circleX - squareX - width, 2);

    if(circleY < squareY) 
        distance += pow(circleY - squareY,2); //y-axis
    else if (circleY > squareY + height) 
        distance += pow(circleY - squareY - height, 2);

    if( distance <= pow(radius, 2))
        return true; 
    else    
        return false;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T02:15:39.380

首先，让我们弄清楚如何表示圆形和正方形。

在约定中，`square`表示如下：

```
 squarexX, squareY + height  ------------ squareX+ width, squareY +height
  |                                               |
  |                                               |
   squareX, squareY          ------------- squareX + width, squareY 
```

While`circle`由圆的坐标`(circleX, circleY)` 和`radius`值表示。考虑到这一点，您甚至应该能够编写自己的函数。请注意，圆没有宽度或高度。

所以在他们的代码中：

```
 if(circleX < squareX) distance += pow(circleX - boxX,2); //x-axis 
```

应该

```
 if(circleX < squareX) distance += pow(circleX - squareX,2); //x-axis 
```

判断正方形是否与圆形重叠/碰撞的思路如下：

1.  假设正方形位于二维平面的原点，如果不是，我们可以将原点移动到正方形的中心
2.  接下来，找出圆与正方形最近的边缘交点之间的距离，如果这个距离大于半径，则不重叠，否则重叠。一个特殊的情况是，如果圆位于正方形内部，那么所谓的交点就是圆本身的中心。在这种情况下，testForCollision 将返回 true。

完整的函数应该如下所示：

```
//this function computes the distance between center of circle
//to closest point on one of the edges of square, that edge is on the
//same side as the circle
#include <algorithm>
bool testForCollision(int circleX, int circleY, int width, int height, int radius)
{   

    int dx = std::min(circleX, (int)(width  * 0.5));
    int dx1 = std::max(dx, (int)(-width *0.5));

    int dy = std::min(circleY, (int)(height * 0.5));
    int dy1 = std::max(dy, (int)(-height * 0.5));

    return (dx1 - circleX) * (dx1 - circleX) 
           + (dy1 - circleY) * (dy1 - circleY) <= radius * radius;
}

bool Collision(int circleX, int circleY, int radius, 
               int squareX, int squareY, int width, int height)
{

    //get center of square
    int center_of_square_x = squareX + width/2;
    int center_of_square_y = squareY + height/2;

    //if square is already at origin, test directly
    if ( center_of_square_x == 0 && center_of_square_y ==0)
    {
        return testForCollision(circleX, circleY, width, height, radius);
    }
    else
    {
        //shift center of square to origin and update coordinates of circle
        //only consider part of the situation, more to add about shifting
        circleX = circleX - center_of_square_x;
        circleY = circleY - center_of_square_y;
        return testForCollision(circleX, circleY, width, height, radius);
    }
} 
```

这样，它应该能够识别圆形和正方形是否相互碰撞。

**编辑：**让我们通过一个测试用例：

```
circleX = 60 circleY = 172 radius = 39
squareX = 120 squareY = 180 width = 72 height = 72 
```

我们有正方形的坐标如下（包括中心）

```
120, 252  -------- 192, 252
 |                   |
 |--------156,216----|
 |                   |
120,180   ---------192,180 
```

我们可以看到 (60,172) 位于边缘 (120,252)-->(120,180) 的左侧，(120,180) 和 (60,72) 之间的距离大于 39。 (120,252) 和 (60,72) 之间的距离也大于39，没有重叠。为了更好地理解它，给定圆心 (60,172) 和半径 39，您可以从圆心到达的 x 和 y 范围是 (60-39,60 +39) = (21,99) 和 ( 172-39, 172+39) = (133,211)。如果您将其可视化，这应该与正方形没有重叠。

如果您首先将原点转换为 (156,216)，我们将 (-96,-44) 作为新坐标系中的圆心。它位于第三象限。如果您运行 testForCollision 函数，您将看到没有重叠。

```
dx = min(-96,36) = -96
dx1 = max(dx, -36) = -36
dy = min(-44, 36) = -44
dy1 = max(dy,-36) = -36

distance = (-36 - (-96))^2 + (-36 - (-44))^2 = 60^2 + 8^2 > 39^2, so no overlap 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T03:34:09.067

有3种情况：

*   形状重叠，因此一个形状的边缘穿过另一个形状的边缘
*   圆圈完全在正方形内（例如，想象在某处有一个小圆圈的巨大矩形）
*   完全在圆圈内的矩形（例如，想象一个带有小矩形的巨大圆圈）

首先确定圆心到矩形中心的距离。我们称这个距离为 D。

然后找到足够小以适合矩形的最大圆圈。这将具有等于矩形高度或矩形宽度（以较小者为准）的直径。如果新圆的半径加上原圆的半径小于距离D，那么肯定有碰撞。

然后找到足够大以包含整个矩形的最小圆。这个圆的半径可以用毕达哥拉斯找到（从矩形中心到矩形任意角的距离）。如果这个新圆的半径加上原圆的半径大于距离D，那么就不可能发生碰撞。

如果这两个测试都没有给你答案；那么两个形状都不完全在另一个形状内，但它们可能重叠或不重叠；因此您必须确定一个形状的边缘是否与另一个形状的边缘相交。为此，扩展矩形的所有边缘，使其无限长（使用线段来描述一条线）；并尝试通过将 x 或 y “插入”到圆的公式中来计算这些无限长的线与圆的圆周相交的位置（注意：您会发现没有交点、1 个交点或 2 个交点）。如果有 2 个交叉点，则必须测试其中一个是否是边缘。

例如，如果您的矩形的顶部边缘在`y = 2`您的正前方，您将插入`y = 2`一个圆形。如果您发现这条线`x = 3`在 x = 6` 处相交，然后测试 3 和 6 是否都在矩形的左边缘和矩形的右边缘之间 - 如果它们是，那么圆的边缘与矩形的顶部边缘，你有一个碰撞。

如果您对矩形的所有 4 个边缘进行“边缘相交”测试而没有检测到碰撞，那么就不会检测到碰撞。

# java - Lock Free 解决方案，同时从地图中增加计数器然后读取它

> ID：15994994
> 
> 赞同：1
> 
> 时间：2013-04-14T02:07:42.053
> 
> 标签：java, multithreading, concurrency, atomic, ibm-jvm

我正在尝试衡量客户端代码的性能。意味着需要多少时间`end to end client side code`以及客户端代码中的其他类很少。所以我做了我的基准测试。

下面是我目前正在使用的简单程序。但这有一个问题。

```
public class PerformanceTest {

    public static void main(String[] args) {

        ExecutorService executor = Executors.newFixedThreadPool(5);

        try {
            for (int i = 0; i < 10 * 5; i++) {
                executor.submit(new ThreadTask(i));
            }

            executor.shutdown();
            executor.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS);
        } catch (InterruptedException e) {

        }
    }
} 
```

下面是实现的类`Runnable interface`

```
class ThreadTask implements Runnable {
    private int id;
    public static ConcurrentHashMap<Long, AtomicLong> millisecondsMap = new ConcurrentHashMap<Long, AtomicLong>();

    public ThreadTask(int id) {
        this.id = id;
    }

    @Override
    public void run() {

        long start = System.nanoTime();

        attributes = beClient.getAttributes(columnsList);

        long end = System.nanoTime() - start;

        final AtomicLong before = millisecondsMap.putIfAbsent(end / 1000000L, new AtomicLong(1L));
        if (before != null) {
            before.incrementAndGet(); //this is a blocking call in IBM JVM
        }
    }
} 
```

**问题陈述：-**

我`IBM JVM`在我的机器上运行。因为我在一家他们使用的公司工作`IBM JVM`，`SUN JVM`所以我无法更改 JVM 部分。

所以在 IBM JVM`incrementAndGet()`方法看起来，首先对我来说很奇怪

```
/**
 * Atomically increments by one the current value.
 *
 * @return the updated value
 */
public final synchronized long incrementAndGet() {                          //IBM-perf_AtomicLong
   ++value;                                                                 //IBM-perf_AtomicLong
   return value;                                                            //IBM-perf_AtomicLong
} 
```

所以它是一个阻塞调用，这`synchronized`意味着每个线程将相互等待。现在我正在寻找`Lock free solution`这个来衡量每种方法的性能。

我知道，这里会有很小的延迟。但是无论我想在客户端代码中测量什么方法的性能，我通常都会将下面的行放在该方法的正上方

`long start = System.nanoTime();`

这两行采用相同的方法但不同`ConcurrentHashMap`

```
long end = System.nanoTime() - start;

final AtomicLong before = millisecondsMap.putIfAbsent(end / 1000000L, new AtomicLong(1L));
        if (before != null) {
            before.incrementAndGet();// this is a blocking call in IBM JVM
        } 
```

因此，如果我`5-8 different methods`在客户端代码的不同类中有相同的上述代码。然后端到端性能测量将是错误的，因为每个线程都将在那里等待增加值。这就是我为此寻找无锁解决方案的原因。

有什么简单的方法可以做到这一点吗？任何人都可以为此提供任何例子吗？

提前致谢。

**更新代码：-**

```
public static ConcurrentHashMap<Long, Long> millisecondsMap = new ConcurrentHashMap<Long, Long>();

@Override
public void run() {

    long start = System.nanoTime();

    beAttributes = client.getAttributes(columnsList);

    long end = System.nanoTime() - start;

    long key = end / 1000000L;
    boolean done = false;

    while(!done) {
        long oldValue = millisecondsMap.get(key);
        done = millisecondsMap.replace(key, oldValue, oldValue + 1);
    }

} 
```

此代码是否也是线程安全代码？因为它也将被多个线程访问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T03:23:26.183

与其使用 AtomicLong，不如使用 ConcurrentHashMap 的`replace(key, old value, new value)`方法来增加值。

```
ConcurrentHashMap<Long, Long> millisecondsMap = new ConcurrentHashMap<>();
long key = end / 1000000L;
boolean done = false;
while(!done) {
    Long oldValue = millisecondsMap.putIfAbsent(key, 1L);
    if(oldValue != null) {
        done = millisecondsMap.replace(key, oldValue, oldValue + 1);
    } else {
        done = true;
    }
} 
```