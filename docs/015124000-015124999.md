# StackOverflow 问答 15124000-15124999

# ios - 在不同的视图控制器中保存和加载整数分数

> ID：15124003
> 
> 赞同：-1
> 
> 时间：2013-02-27T22:45:25.600
> 
> 标签：ios, uiviewcontroller

我有 3 个视图控制器，每个控制器都有一个名为 Count 的 int。计数是用户的高分，即使应用程序被杀死，这也是我想要保留的。

这是整数；

```
int Count = 100; 
```

这是分数显示的地方（ViewDiDLoad 中的 UILabel）；

```
scoreCounter.text = @""; 
```

这就是我用（Inside IBAction）调用它的代码；

```
NSString *numValue = [[NSString alloc] initWithFormat:@"%d", Count--];
scoreCounter.text = numValue;
[numValue release]; 
```

基本上每次我按下按钮，分数都会下降。我在三个不同的视图控制器中都有上面的代码，它们是这样打开的；

```
if(Count == 90)
{
    SecondLevelViewController *screen = [[SecondLevelViewController alloc] initWithNibName:nil bundle:nil];
    screen.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
    [self presentModalViewController:screen animated:YES];
    [screen release]; 
```

我需要一种方法来保存这个分数，并保存上次使用的视图控制器，这样如果分数为 90，应用程序将启动 SecondViewController。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T22:47:58.220

`NSUserDefaults`对此很有用。

保存：

```
[[NSUserDefaults standardUserDefaults] setInteger:Count forKey:@"Count"]; 
```

装载：

```
Count = [[NSUserDefaults standardUserDefaults] integerForKey:@"Count"]; 
```

由于最初没有值，因此您的第一次加载将为您提供 0 而不是 100。这可以通过设置默认值来处理。

```
NSDictionary *defaults = @{ @"Count" : @100 };
[[NSUserDefault standardUserDefaults] registerDefaults:defaults]; 
```

将此代码添加到您的应用程序启动中，例如在应用程序委托`application:didFinishLaunchingWithOptions:`方法中。

# javascript - node.js，mongo快速保存唯一编号的方法

> ID：15124006
> 
> 赞同：0
> 
> 时间：2013-02-27T22:45:33.140
> 
> 标签：javascript, node.js, mongodb, guid

我想让 mongo 为我保留一个递增的数字，以便我可以调用该数字，然后从中生成一个字符串。

```
x = 1e10
x.toString(36).substring(2,7)

>>'dqpds' 
```

每次从 mongo 调用它时，我都有办法增加数字

```
db.counter.update({ _id: 1 }, { $inc: { seq: 1 } }, {upsert: true}, 
    function(err, val){
    //...
}) 
```

但是我想在开头将数字设置为 1e10 这样我得到一个 5 个字符长的字符串，但我宁愿只调用一次数据库。

如何在 mongo 中为 upsert 设置默认值。还是您有更有效的方法来生成唯一的 5 - 6 个字符的字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T04:07:22.163

如果您只需要一个不一定是连续的唯一 id，您可以使用[ObjectId](http://docs.mongodb.org/manual/core/object-id/)的第一部分。

从上面的文档中有一个描述：

> ObjectId 是一个 12 字节的 BSON 类型，使用以下方法构造：
> 
> ```
> a 4-byte timestamp,
> a 3-byte machine identifier,
> a 2-byte process id, and
> a 3-byte counter, starting with a random value. 
> ```

所以你可以这样做：

```
x = ObjectId().toString().subString(0,4) 
```

这种方式不涉及数据库IO，性能会更好。如果您想更确定它的唯一性，请将计数器的最后 2 个字节添加到 6 个字符中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:19:34.793

在 MongoDB 中有一种方法可以做到这一点。

您使用[findAndModify](http://docs.mongodb.org/manual/reference/method/db.collection.findAndModify/#db.collection.findAndModify)命令，并在您在这里寻找的上下文中详细描述了它：

[http://docs.mongodb.org/manual/tutorial/create-an-auto-incrementing-field/](http://docs.mongodb.org/manual/tutorial/create-an-auto-incrementing-field/)

# mongodb - 您如何从 mongodb 中的引用中聚合数据？

> ID：15124011
> 
> 赞同：0
> 
> 时间：2013-02-27T22:45:56.050
> 
> 标签：mongodb, sorting, mapreduce, aggregation-framework, nosql

```
User{
      '_id' : ObjectId(..),
      'Friends': [{_id : ref1},{id : ref2}]
      'Posts' : [{'popularity' :103,...}, {'popularity' : 86,...}
} 
```

并且每个引用链接到朋友中的另一个用户 id。从所有用户朋友中获取最受欢迎帖子的最快方法是什么？也许只是前20名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:17:24.530

MongoDB 允许灵活的模式设计来弥补没有连接的问题。所以我假设在这个模式中关系是“双向的”（即，如果我是你的朋友，那么你在我的朋友数组中，而我在你的朋友数组中？）

在这种情况下，您可以执行以下聚合查询：

```
db.users.aggregate([
    {$match : { "Friends._id": <my _id> } },
    {$unwind : "$Posts" },
    {$sort :  { "Posts.popularity" : -1 },
    {$limit : 20 }
] ) 
```

基本上，过滤所有在他们的朋友数组中有我的用户，展开他们的帖子数组，排序以首先获得最受欢迎的帖子并限制在前 20 位。

如果您没有关于“Friends._id”的索引，这将不是一个快速查询。

# java - ntlm 身份验证的 Java URLConnection 错误，但仅在 Linux 和 Java 7 上

> ID：15124019
> 
> 赞同：11
> 
> 时间：2013-02-27T22:47:04.893
> 
> 标签：java, authentication, ntlm, urlconnection

我正在尝试打开到受 NTLM 身份验证方案保护的 url 的 http 连接。当我们在 Java 6 上时，这段代码已经正常工作了 2 年。我编写了一个小型 Java 程序，它访问那个特定的 url 以使测试用例尽可能简单。

问题是我无法使程序在 linux 上运行，并且在使用 JDK 7 版本时。Java 尝试 20 次访问 URL，然后我收到一个错误，告诉我服务器重定向太多次。它适用于 linux 和 JDK 6，以及适用于 JDK 6 或 7 的 windows 7。

我检查并尝试了此处列出的解决方案（以及许多其他解决方案）：[Getting "java.net.ProtocolException: Server redirected too many times" 错误](https://stackoverflow.com/questions/11022934/getting-java-net-protocolexception-server-redirected-too-many-times-error)。它没有用。我还必须补充一点，从浏览器访问 url 时，我可以看到没有涉及 cookie。

这是我尝试过的 os/java 版本的详细信息：

成功：

*   Windows 7：Java(TM) SE 运行时环境（内部版本 1.7.0_15-b03）（64 位）
*   Windows 7：Java(TM) SE 运行时环境（内部版本 1.7.0_10-b18）（64 位）
*   Windows 7：Java(TM) SE 运行时环境（内部版本 1.6.0_33-b04）（64 位）
*   Redhat 企业版 linux 6.4：Java(TM) SE 运行时环境（内部版本 1.6.0_33-b04）（64 位）

失败：

*   Redhat 企业版 linux 6.4：Java(TM) SE 运行时环境（内部版本 1.7.0-b147）（64 位）
*   Redhat 企业版 linux 6.4：Java(TM) SE 运行时环境（内部版本 1.7.0_05-b06）（64 位）
*   Redhat 企业版 linux 6.4：Java(TM) SE 运行时环境（内部版本 1.7.0_13-b20）（64 位）
*   Redhat 企业版 linux 6.4：Java(TM) SE 运行时环境（内部版本 1.7.0_15-b03）（64 位）

当程序运行时，我会看到使用的身份验证方法和我尝试下载的文档作为输出：

```
Scheme:Negotiate
Scheme:ntlm
.... document content ....
Done 
```

当它失败时，我有以下输出：

```
Scheme:Negotiate
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
Scheme:ntlm
java.net.ProtocolException: Server redirected too many  times (20)
        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1635)
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:254)
        at TestWs.testWs(TestWs.java:67)
        at TestWs.main(TestWs.java:20) 
```

这是程序的源代码：

```
package com.test;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.Authenticator;
import java.net.CookieHandler;
import java.net.CookieManager;
import java.net.CookiePolicy;
import java.net.PasswordAuthentication;
import java.net.URL;
import java.net.URLConnection;

public class TestWs {

    public static void main(String[] args) throws Exception {
        new TestWs().testWs();
    }

    public void testWs() {
        try {
            CookieHandler.setDefault(new CookieManager(null, CookiePolicy.ACCEPT_ALL));
            Authenticator.setDefault(new MyAuthenticator("username", "password"));

            URL url = new URL("https://someurlprotectedbyntlmauthentication.com");
            URLConnection connection = url.openConnection();
            InputStream is = connection.getInputStream();
            InputStreamReader isr = new InputStreamReader(is);
            BufferedReader br = new BufferedReader(isr);
            while (true) {
                String s = br.readLine();
                if (s == null)
                    break;
                System.out.println(s);
            }
            System.out.println("Done");
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
}

class MyAuthenticator extends Authenticator {
    private String httpUsername;
    private String httpPassword;

    public MyAuthenticator(String httpUsername, String httpPassword) {
        this.httpUsername = httpUsername;
        this.httpPassword = httpPassword;
    }

    @Override
    protected PasswordAuthentication getPasswordAuthentication() {
        System.out.println("Scheme:" + getRequestingScheme());
        return new PasswordAuthentication(httpUsername, httpPassword.toCharArray());
    }
} 
```

任何帮助将不胜感激。

**更新：**

经过更多调查，我发现如果我使用域用户，身份验证有效，但如果我使用本地用户，则无效。

JDK 7 中的这段代码给我带来了麻烦（com.sun.security.ntlm.Client 类）：

```
public byte[] type3(byte[] type2, byte[] nonce) throws NTLMException {
if (type2 == null || (v != Version.NTLM && nonce == null)) {
throw new NullPointerException("type2 and nonce cannot be null");
}
debug("NTLM Client: Type 2 received\n");
debug(type2);
Reader r = new Reader(type2);
byte[] challenge = r.readBytes(24, 8);
int inputFlags = r.readInt(20);
boolean unicode = (inputFlags & 1) == 1;
String domainFromServer = r.readSecurityBuffer(12, unicode);
if (domainFromServer != null) {
domain = domainFromServer;
} 
```

因此，由于服务器已在域中注册，它会将其域作为 NTLM 协议的一部分发送回客户端。Java每次都用变量“domainFromServer”替换我试图强制执行的域，但由于用户存在于服务器上而不是服务器的域上，所以它失败了。

我不知道该怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T20:04:09.843

我更改了 Client.java 类中的代码，并将其与 com.sun.security.ntlm 包的其余部分一起重新编译，然后我创建了一个名为 rt_fix.jar 的 jar，其中包含该特定包的类。然后我使用了一个 java 启动选项来强制它在内部 rt.jar 之前加载我的 jar。

-Xbootclasspath/p:/path_to_jar/rt_fix.jar

我不喜欢这个解决方案，但它有效。

这是我在 Client.java 中更改的代码，在方法 type3 中：

前 ：

```
 if (domainFromServer != null) {
        domain = domainFromServer;
    } 
```

后 ：

```
 if (domainFromServer != null) {
        //domain = domainFromServer;
    } 
```

在发送 NTLM 身份验证的第三部分时，它会阻止 Java 更改我尝试使用从服务器收到的域进行身份验证的域。我试图验证的域实际上是服务器的名称，因为用户帐户是本地的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-02T06:07:34.803

我有同样的问题，只是通过指定包含域的用户名来解决它：

```
 Authenticator.setDefault(new Authenticator() {
        @Override
        protected PasswordAuthentication getPasswordAuthentication() {
            return new PasswordAuthentication(
                    System.getProperty("DOMAIN\\user"),
                    System.getProperty("password").toCharArray() ) ;
        }
    }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-27T16:36:36.177

正确的是这样：

```
Authenticator.setDefault(new Authenticator() {
        @Override
        protected PasswordAuthentication getPasswordAuthentication() {
            return new PasswordAuthentication(
                    "DOMAIN\\user",
                    "password".toCharArray() ) ;
        }
    }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-07T14:24:36.260

此问题已在 JDK 9-ea 中通过[http://bugs.java.com/view_bug.do?bug_id=7150092得到解决，并且该修复程序也通过](http://bugs.java.com/view_bug.do?bug_id=7150092)[http://bugs.java.com/](http://bugs.java.com/view_bug.do?bug_id=8049690)反向移植到 JDK 8u40 [view_bug.do?bug_id=8049690](http://bugs.java.com/view_bug.do?bug_id=8049690)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-03T10:25:05.663

此错误的另一个可能原因：域用户被阻止

```
Scheme:ntlm
Scheme:ntlm
java.net.ProtocolException: Server redirected too many  times (20) 
```

在我不小心阻止了我的域用户后，当我尝试使用超过域策略允许的错误密码登录时，我遇到了同样的错误。

# java - 数独回溯 无效数独

> ID：15124022
> 
> 赞同：2
> 
> 时间：2013-02-27T22:47:16.833
> 
> 标签：java, backtracking, sudoku

我创建了一个数独回溯求解器，它工作得很好，但现在如果数独无法解决，我想给出一个错误，因为它是无效的，例如，如果给出这个数独：

[http://img5.imageshack.us/img5/2241/sudokugq.jpg](http://img5.imageshack.us/img5/2241/sudokugq.jpg)

如果无法解决，我该怎么做才能使我的解决方法出错？我总是以零结束或陷入循环。

```
 public void solve( int row, int col ) throws Exception
   {
      // Throw an exception to stop the process if the puzzle is solved
      if( row > 8 ){
        //Gelöst
      }
      // If the cell is not empty, continue with the next cell
      if( sudo[row][col] != 0 ){
         next( row, col ) ;
        }
      else
      {
         // Find a valid number for the empty cell
         for( int num = 1; num < 10; num++ )
         {
            if( checkHorizontal(row,num) == false && checkVertikal(col,num)== false&& checkBox(row,col,num)== false )
            {
               sudo[row][col] = num ;

               // Delegate work on the next cell to a resudosive call
               next( row, col ) ;
            }
         }

         // No valid number was found, clean up and return to caller
         sudo[row][col] = 0 ;
      }

   }

   //Ruft solve für das nächste Feld auf
   public void next( int row, int col ) throws Exception
   {
      if( col < 8 )
         solve( row, col + 1 ) ;
      else
         solve( row + 1, 0 ) ;
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T22:59:46.557

当然，当您点击`sudo[row][col] = 0 ;`代码时，您刚刚尝试完正方形中的每个值，但没有找到任何解决方案。当然，这就是您决定放弃无解决方案状态的关键。

进一步考虑 - 我怀疑我几乎是对的。如果您点击此代码**并且**这是您尝试的**第一个**单元格（即您找到的第一个空单元格），那么这就是您的失败时刻。

顺便说一句 - 我不确定使用 Exception 来指示您在评论中建议的解决方案是否是一个好主意。

* * *

这现在正确地拒绝了您发布的板 - 请注意，不仅第一行有两个“3”，第一列还有两个“5”。这段代码现在似乎对我有用。也许你可以在一个不溶的上试一试。

```
public class Test {

    static final int S = 9;
    int[][] sudo;

    public Test() {
        // Just leave it empty.
        sudo = new int[S][S];
    }

    public Test(int[][] sudo) {
        this.sudo = sudo;
    }

    // This number should not appear anywhere in the row.
    public boolean checkHorizontal(int row, int num) {
        for (int i = 0; i < S; i++) {
            if (sudo[row][i] == num) {
                return false;
            }
        }
        return true;
    }

    // This number should not appear anywhere in the col.
    public boolean checkVertical(int col, int num) {
        for (int i = 0; i < S; i++) {
            if (sudo[i][col] == num) {
                return false;
            }
        }
        return true;
    }

    // This number should not appear anywhere in the box.
    private boolean checkBox(int row, int col, int num) {
        // Round down to nearest 3.
        int r = (row / 3) * 3;
        int c = (col / 3) * 3;
        for (int i = r; i < r + 3; i++) {
            for (int j = c; j < c + 3; j++) {
                if (sudo[i][j] == num) {
                    return false;
                }
            }
        }
        return true;
    }

    boolean check(int row, int col, int num) {
        // All checks must pass.
        return checkHorizontal(row, num)
                && checkVertical(col, num)
                && checkBox(row, col, num);
    }

    public boolean solve(int row, int col) {
        // Got to the end?
        if (row >= S) {
            //Gelöst
            return true;
        }
        // If the cell is empty
        if (sudo[row][col] == 0) {
            // Find a valid number for the empty cell
            for (int num = 1; num < 10; num++) {
                // Can this number be put there?
                if (check(row, col, num)) {
                    // Yes!
                    sudo[row][col] = num;
                    // Try that.
                    if (next(row, col)) {
                        return true;
                    }
                }
            }
            // Clean up.
            sudo[row][col] = 0;
        } else {
            // Move on.
            if (next(row, col)) {
                return true;
            }
        }
        // Failed to find a solution.
        return false;
    }

    //Ruft solve für das nächste Feld auf
    public boolean next(int row, int col) {
        if (col < S - 1) {
            // Step right.
            return solve(row, col + 1);
        } else {
            // Step down.
            return solve(row + 1, 0);
        }
    }

    public boolean boardOk() {
        // Initial test to ensure it is a valid array.
        // Must have that many rows.
        boolean ok = sudo.length == S;
        for (int row = 0; ok && row < S; row++) {
            // Each row must be that long.
            ok &= sudo[row].length == S;
            for (int col = 0; ok && col < S; col++) {
                // Each filled square must be valid.
                if (sudo[row][col] != 0) {
                    int num = sudo[row][col];
                    // Remove it.
                    sudo[row][col] = 0;
                    // Check it can be added.
                    ok &= check(row, col, num);
                    // Put it back.
                    sudo[row][col] = num;
                }
            }
        }
        return ok;
    }

    void solve() {

        if (boardOk()) {
            boolean solved = solve(0, 0);
            if (solved) {
                System.out.println("Solved!");
                print();
            }
        } else {
            System.out.println("Insoluble!");
            print();
        }
    }

    public void print() {
        for (int i = 0; i < sudo.length; i++) {
            System.out.println(Arrays.toString(sudo[i]));
        }
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        new Test().solve();
        int[][] test = {
            {0, 0, 6, 5, 8, 3, 3, 2, 7},
            {0, 0, 0, 0, 9, 0, 0, 5, 0},
            {5, 8, 0, 0, 0, 0, 0, 0, 3},
            {0, 3, 1, 0, 4, 0, 5, 0, 0},
            {0, 0, 0, 9, 2, 0, 3, 0, 6},
            {0, 0, 0, 0, 0, 0, 0, 0, 1},
            {3, 4, 2, 0, 0, 6, 9, 1, 5},
            {5, 0, 5, 4, 0, 9, 0, 3, 2},
            {0, 1, 0, 0, 0, 0, 0, 0, 4},};
        new Test(test).solve();
    }
} 
```

# c# - 用于 C# 的小型可嵌入 Web/HTTP 堆栈？

> ID：15124026
> 
> 赞同：6
> 
> 时间：2013-02-27T22:47:32.313
> 
> 标签：c#, .net, embeddedwebserver

这可能问得太多了。（到底为什么我要离开 IIS？）

我正在寻找的是一个非常好的嵌入式 HTTP 服务器。我环顾四周，我还没有在[Kayak](https://github.com/kayak/kayak)上出售。但我还没有找到很多其他人。

任何人都可以推荐一个用 C# 编写的可靠的、可嵌入的 HTTP 服务器吗？最好是实现[Python WSGI](http://wsgi.readthedocs.org/en/latest/)规范的，那会很棒。

# c# - 从 SqlDataReader 读取字符串时内存不足

> ID：15124034
> 
> 赞同：15
> 
> 时间：2013-02-27T22:48:17.753
> 
> 标签：c#, sql, performance, memory

我遇到了我无法弄清楚的最奇怪的事情。我有一个 SQL 表，其中有一堆存储在 ntext 字段中的报告。当我将其中一个的值复制并粘贴到记事本中并保存时（使用 Visual Studio 从不同行的较小报告中获取值），原始 txt 文件大约为 5Mb。当我尝试使用 SqlDataReader 获取相同的数据并将其转换为字符串时，出现内存不足异常。这是我尝试的方法：

```
string output = "";
string cmdtext = "SELECT ReportData FROM Reporting_Compiled WHERE CompiledReportTimeID = @CompiledReportTimeID";
SqlCommand cmd = new SqlCommand(cmdtext, conn);
cmd.Parameters.Add(new SqlParameter("CompiledReportTimeID", CompiledReportTimeID));
SqlDataReader reader = cmd.ExecuteReader();
while (reader.Read())
{
    output = reader.GetString(0); // <--- exception happens here
}
reader.Close(); 
```

我尝试创建一个对象和一个字符串构建器来获取数据，但我仍然得到相同的内存不足异常。我也尝试过使用 reader.GetValue(0).ToString() 也无济于事。该查询只返回 1 行，当我在 SQL Management Studio 中运行它时，它会尽可能快乐。

抛出的异常是：

```
System.OutOfMemoryException was unhandled by user code  
Message=Exception of type 'System.OutOfMemoryException' was thrown.  
Source=mscorlib  
 StackTrace:  
 at System.String.CreateStringFromEncoding(Byte* bytes, Int32 byteLength, Encoding       encoding)  
   at System.Text.UnicodeEncoding.GetString(Byte[] bytes, Int32 index, Int32 count)  
   at System.Data.SqlClient.TdsParserStateObject.ReadString(Int32 length)  
   at System.Data.SqlClient.TdsParser.ReadSqlStringValue(SqlBuffer value, Byte type, Int32 length, Encoding encoding, Boolean isPlp, TdsParserStateObject stateObj)  
   at System.Data.SqlClient.TdsParser.ReadSqlValue(SqlBuffer value, SqlMetaDataPriv md, Int32 length, TdsParserStateObject stateObj)  
   at System.Data.SqlClient.SqlDataReader.ReadColumnData()  
   at System.Data.SqlClient.SqlDataReader.ReadColumn(Int32 i, Boolean setTimeout)  
   at System.Data.SqlClient.SqlDataReader.GetString(Int32 i)  
   at Reporting.Web.Services.InventoryService.GetPrecompiledReportingData(DateTime ReportTime, String ReportType) in   C:\Projects\Reporting\Reporting.Web\Services\InventoryService.svc.cs:line 3244  
   at SyncInvokeGetPrecompiledReportingData(Object , Object[] , Object[] )  
   at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]& outputs)  
   at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc& rpc)  
 InnerException:   
    null 
```

我用其他似乎有效的行号进行了测试，但这是一个误报，因为那些测试 ID 没有数据。在查看包含几乎相同的报告的表格后，我提取了其他一些测试 ID，并且我得到了相同的异常。也许它是如何编码字符串的？存储在表中的数据是一个 JSON 编码的字符串，它是由我在其他地方制作的一个非常粗糙的类生成的，以防万一。

这是前面的代码块：

```
// get the report time ID
int CompiledReportTimeTypeID = CompiledReportTypeIDs[ReportType];
int CompiledReportTimeID = -1;
cmdtext = "SELECT CompiledReportTimeID FROM Reporting_CompiledReportTime WHERE CompiledReportTimeTypeID = @CompiledReportTimeTypeID AND CompiledReportTime = @ReportTime";
cmd = new SqlCommand(cmdtext, conn);
cmd.Parameters.Add(new SqlParameter("CompiledReportTimeTypeID", CompiledReportTimeTypeID));
cmd.Parameters.Add(new SqlParameter("ReportTime", ReportTime));
reader = cmd.ExecuteReader();
while (reader.Read())
{
    CompiledReportTimeID = Convert.ToInt32(reader.GetValue(0));
}
reader.Close(); 
```

CompiledReportTypeIDs 是一个字典，它根据在方法开头输入的字符串参数获取正确的 CompiledReportTimeTypeID。ReportTime 是较早输入的 DateTime。

编辑：我将删除表并使用 ReportData 字段作为 nvarchar(MAX) 而不是 ntext 重新创建它，只是为了排除 SQL 数据类型问题。这是一个很长的镜头，我会再次更新我的发现。

Edit2：将表中的字段更改为 nvarchar(max) 无效。我也尝试使用 output = cmd.ExecuteScalar().ToString() ，没有任何影响。我正在尝试查看 SqlDataReader 是否有最大大小。当我从 SQL Mgmt Studio 复制文本的值时，保存在记事本中时只有 43Kb。为了验证这一点，我提取了一个具有已知工作 ID 的报告（一个较小的报告），当我直接从 Visual Studio 中复制该值并将其转储到记事本中时，它大约为 5MB！这意味着这些大报告可能在 nvarchar(max) 字段中的 ~20MB 范围内。

Edit3：我重新启动了所有东西，包括我的开发 IIS 服务器、SQL 服务器和我的开发笔记本电脑。现在它似乎正在工作。这不是为什么会发生这种情况的答案。我将这个问题留待解释发生了什么，我会将其中一个标记为答案。

Edit4：话虽如此，我在没有改变任何东西的情况下运行了另一个测试，并且返回了相同的异常。我真的开始认为这是一个 SQL 问题。我正在更新这个问题的标签。我制作了一个单独的应用程序，它运行完全相同的查询并且运行良好。

Edit5：我已经按照以下答案之一实现了顺序访问。一切都被正确地读入流中，但是当我尝试将其写入字符串时，我仍然遇到内存不足异常。这是否表明获取连续内存块的问题？这是我实现缓冲的方式：

```
 reader = cmd.ExecuteReader(CommandBehavior.SequentialAccess);
            long startIndex = 0;
            long retval = 0;
            int bufferSize = 100;
            byte[] buffer = new byte[bufferSize];
            MemoryStream stream = new MemoryStream();
            BinaryWriter writer = new BinaryWriter(stream);
            while (reader.Read())
            {
                // Reset the starting byte for the new CLOB.
                startIndex = 0;

                // Read bytes into buffer[] and retain the number of bytes returned.
                retval = reader.GetBytes(0, startIndex, buffer, 0, bufferSize);

                // Continue while there are bytes beyond the size of the buffer.
                while (retval == bufferSize)
                {
                    writer.Write(buffer);
                    writer.Flush();

                    // Reposition start index to end of last buffer and fill buffer.
                    startIndex += bufferSize;
                    retval = reader.GetBytes(0, startIndex, buffer, 0, bufferSize);
                }

                //output = reader.GetString(0);
            }
            reader.Close();
            stream.Position = 0L;
            StreamReader sr = new StreamReader(stream);
            output = sr.ReadToEnd(); <---- Exception happens here
            //output = new string(buffer); 
```

Edit6：补充一点，当发生 OOM 异常时，我看到 IIS 工作进程（它保存正在运行的方法）达到近 700MB。这是在 IIS Express 上运行的，而不是在生产服务器上的完整 IIS。这和它有什么关系吗？此外，当我调用 Byte[] data = stream.ToArray() 时，我也会间歇性地得到 OOM。我认为我真正需要的是一种为这个过程提供更多内存的方法，但我不知道在哪里配置它。

Edit7：我刚刚将我的开发服务器从使用本地计算机上的 IIS Express 更改为内置的 Visual Studio Web 服务器。OOM 异常现在消失了。我真的认为这是分配一个连续的内存块问题，无论出于何种原因，IIS Express 都不会分叉它。现在它运行良好，我将发布到运行常规 IIS7 的 2008R2 上的完整服务器，看看它是如何运行的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-28T21:59:43.217

您应该尝试通过在执行阅读器时指定[命令行为](http://msdn.microsoft.com/en-us/library/y6wy5a0f.aspx)来顺序读取数据。根据文档，**使用 SequentialAccess 检索大值和二进制数据。否则，可能会发生 OutOfMemoryException 并且连接将被关闭**。

虽然顺序访问通常用于大型二进制数据，但根据 MSDN 文档，您也可以使用它来读取大量字符数据。

> 访问 BLOB 字段中的数据时，使用 DataReader 的 GetBytes 或 GetChars 类型访问器，它们用数据填充数组。您也可以使用 GetString 获取字符数据；然而。为了节省系统资源，您可能不想将整个 BLOB 值加载到单个字符串变量中。您可以改为指定要返回的数据的特定缓冲区大小，以及要从返回的数据中读取的第一个字节或字符的起始位置。GetBytes 和 GetChars 将返回一个 long 值，表示返回的字节数或字符数。如果将空数组传递给 GetBytes 或 GetChars，则返回的 long 值将是 BLOB 中的字节或字符总数。您可以选择将数组中的索引指定为正在读取的数据的起始位置。

这个[MSDN 示例](http://msdn.microsoft.com/en-us/library/87z0hy49%28v=vs.110%29.aspx)展示了如何执行顺序访问。我相信您可以使用[GetChars](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getchars.aspx)方法来读取文本数据。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-01T08:34:45.933

从根本上说，a`System.OutOfMemoryException`不仅仅发生在内存不足时，而是当您无法为对象分配单个连续的内存块时。当您尝试创建一个非常大的数组，或加载一个大的位图对象时，或者有时在创建大型 XmlDocuments 时，您经常会看到该错误......

`Array`并且`String`通常需要连续分配，即不能分成几块并分配到内存中的空白空间。

这可能不是 SQL 问题，而更多的是 SqlReader 尝试分配足够大的字符串以包含连续数据的问题。

您提到它在重新启动后正常工作，所以让我们假设您的代码基本正确（可能仍然可以优化以将数据公开为流而不是缓冲记录集）并且当前症状是环境问题。刚重新启动的机器可能没有那么多碎片内存，但是随着您使用的更多，内存碎片并返回错误...

您*可以*通过关闭尽可能多的其他程序来证明连续内存理论，并在有错误的代码之前添加代码以强制`GC.Collect(GC.MaxGeneration)`( [reference )。](http://msdn.microsoft.com/en-us/library/y46kxc5e.aspx)这不是保证，因为分配给您的进程的内存可能仍然是碎片化的。

我认为流式传输值可能是阻止错误发生的方法，并且最好避免尝试将所有内容缓冲到字符串中。这样做的缺点是您将保持数据库连接打开，而结果由程序的其余部分流式传输/使用，这将带来自己的开销。我不确定您的代码需要对结果做什么，但如果它需要与`String`实例一起使用，您可能需要扩展进程可用的内存（有几种方法可以帮助实现这一点，但可能是题外话 -发表评论，如果需要，我可以添加到此答案中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T21:00:05.870

在这里疯狂猜测。

```
cmd.Parameters.Add(new SqlParameter("CompiledReportTimeID", CompiledReportTimeID)); 
```

你错过了@符号。所以它用 id 替换了 CompiledReportTimeID 的两个实例，你得到所有的结果，而不是因为相等？

# reporting-services - ssrs 的动态格式

> ID：15124038
> 
> 赞同：0
> 
> 时间：2013-02-27T22:48:30.643
> 
> 标签：reporting-services, ssrs-2008, ssrs-tablix, csrss

这是我的报告

![在此处输入图像描述](../Images/06432be33bf58ef49a20e752d562d460.png) 这是我的结果（但 iddescripcion 不可见）

![在此处输入图像描述](../Images/d4da96ca42fe41ac37995378659ba223.png)

我的问题是。

当 iddescripcion=1,3,5,8 或 10 时，我如何得到，那么当 iddescripcion=2,4,6 或 9 时，valor 将采用这种格式 10,000（不是小数），然后 valor 将采用这种格式 1,000.0 或3,000.1（一位小数），当 iddescripcion=7,11 时，valor 将采用这种格式 $2,389,012（之前不是小数和 $）我相信我需要在此处添加它的格式，但我不知道该怎么做。 . ![在此处输入图像描述](../Images/db57f0f0b6305eb6d2df4b83a8367b37.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:06:12.470

您可以在文本框表达式值中使用`Switch`or语句应用条件格式。`IIf`

![在此处输入图像描述](../Images/47eab93c06e8edb078f44c04e1879def.png)

我使用以下表达式将一个简单的示例放在一起：

```
=Switch(Fields!iddescripcion.Value = 1 or Fields!iddescripcion.Value = 2, Format(Fields!valor.Value, "N0")
    , Fields!iddescripcion.Value = 3 or Fields!iddescripcion.Value = 4, Format(Fields!valor.Value, "N1")
    , Fields!iddescripcion.Value = 5 or Fields!iddescripcion.Value = 6, Format(Fields!valor.Value, "$#,#")) 
```

基本上只是根据每行的*iddescripcion*`Format`应用到*valor*。这适用于一些简单的数据：

 *![在此处输入图像描述](../Images/b15b2ae3b8bfb7c4ad4d8fb8e58a905d.png)

希望您可以将其用于您的示例。*

# c# - 无法连接到任何指定的 MySQL 主机

> ID：15124040
> 
> 赞同：2
> 
> 时间：2013-02-27T22:48:33.997
> 
> 标签：c#, mysql, visual-studio-2010

这是问题所在。我正在尝试执行查询及其抛出和异常`connection.Open`。奇怪的是，在同一个应用程序上，我正在执行“选择”查询，它工作正常。但是当我执行“更新”查询时，它会抛出这个无法连接到任何指定的 MySQL 主机错误。一直卡在这上面。有人可以发现我哪里出错了。

```
 private void button1_Click(object sender, EventArgs e)
    {
        if (radioButton1.Checked)
        {
            timerEnabled = 1;
        }

        connection.Open();

        //update the settings to the database table 
        MySqlCommand command = connection.CreateCommand();
        command.CommandText = "update Admin_Settings set Difficulty='" + comboBox3.Text + "'," + "NoOfQuestions='" + comboBox4.Text + "'," + "NoOfChoices='" + comboBox5.Text + "'," +
            "Subject='" + comboBox8.Text + "'," + "Timer='" + comboBox2.Text + "," + "TimerEnabled=" + timerEnabled + "," + "TimerType='" + comboBox1.Text + "'";

        command.ExecuteNonQuery();

        MessageBox.Show("Settings updated");
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T22:58:20.193

我将建议您执行以下操作：

```
private void button1_Click(object sender, EventArgs e)
        {
            using (System.Data.SqlClient.SqlConnection connection = new System.Data.SqlClient.SqlConnection(connString))
            {
                if (radioButton1.Checked)
                {
                    timerEnabled = 1;
                }

                connection.Open();

                //update the settings to the database table 
                MySqlCommand command = connection.CreateCommand();
                command.CommandText = "update Admin_Settings set Difficulty='" + comboBox3.Text + "'," + "NoOfQuestions='" + comboBox4.Text + "'," + "NoOfChoices='" + comboBox5.Text + "'," +
                    "Subject='" + comboBox8.Text + "'," + "Timer='" + comboBox2.Text + "," + "TimerEnabled=" + timerEnabled + "," + "TimerType='" + comboBox1.Text + "'";

                command.ExecuteNonQuery();

                MessageBox.Show("Settings updated");
            }
        } 
```

我知道您在想自己，您应该保持连接以方便使用等等，但根据我的经验，这是浪费精力。最终发生的事情有很多你不想要或不需要的麻烦。您最终没有意识到您在其他地方打开了连接，并且您花费数小时排除您不应该解决的问题。打开你的连接，完成后关闭它。

如果您想拥有一个连接对象，那很好，但使用 using 模式以便每次都将其处理掉，并始终从您的连接开始。

注意：用 yoru MySqlConnection 对象替换我的连接！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:05:09.827

正如迈克所说，你总是最好使用“使用”块，因为一旦它退出使用块，它就会处理任何连接。我使用了两个 using 块，一个用于连接，另一个用于命令对象。

试试这个

```
 private void button1_Click(object sender, EventArgs e)
    {
        using (SqlConnection connection = new SqlConnection(connString))
        {
            if (radioButton1.Checked)
            {
                timerEnabled = 1;
            }

           string queryString = "update Admin_Settings set Difficulty='" +      
            comboBox3.Text + "'," + "NoOfQuestions='" + comboBox4.Text + "'," + 
            "NoOfChoices='" + comboBox5.Text + "'," + "Subject='" + comboBox8.Text +  
           "'," + "Timer='" + comboBox2.Text + "," + "TimerEnabled=" + timerEnabled +  
              "," + "TimerType='" + comboBox1.Text + "'";

          using (SqlCommand command = new SqlCommand(queryString, connection))
          {
            //update the settings to the database table 

            command.Connection.Open();
            command.ExecuteNonQuery();
            command.Connection.Close();

            MessageBox.Show("Settings updated");
          }
        }
    } 
```

# php - 在sql查询中插入php代码

> ID：15124042
> 
> 赞同：-3
> 
> 时间：2013-02-27T22:48:38.720
> 
> 标签：php, mysql, codeigniter, phpmyadmin

```
function search_num_rows($param){
        $company_name=$param['company_name'];
        $loan_no=$param['loan_no'];

        $q = $this->db->query("select Count(0) as num_rows
                                from contact_new 
                                inner join  companies c on contact_new.company_id = c.id 
                                inner join history on contact_new.id = history.receiver_email 
                                inner join escalation_level on contact_new.escalation_level_id = escalation_level.id
                                inner join departments on contact_new.departmend_id = departments.id
                                WHERE  loan_no= '$loan_no' if($company_name){ AND company_name= '$company_name'} ")->result();
    return $q[0]->num_rows;
} 
```

我可以像在 where 子句中那样插入 php 代码吗？有没有其他方法可以在不使用活动记录的情况下执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T22:52:28.573

其实很简单：

```
function search_num_rows($param){
        $company_name = (isset($param['company_name']) && !empty($param['company_name']) ? " AND company_name = '$param[company_name]'" : '');
        $loan_no=$param['loan_no'];

        $q = $this->db->query("select Count(0) as num_rows
                                from contact_new 
                                inner join  companies c on contact_new.company_id = c.id 
                                inner join history on contact_new.id = history.receiver_email 
                                inner join escalation_level on contact_new.escalation_level_id = escalation_level.id
                                inner join departments on contact_new.departmend_id = departments.id
                                WHERE  loan_no= '$loan_no' $company_name")->result();
    return $q[0]->num_rows;
} 
```

# python-2.7 - 当类调用彼此的方法时，Python / Tkinter 失败

> ID：15124048
> 
> 赞同：0
> 
> 时间：2013-02-27T22:48:59.487
> 
> 标签：python-2.7, tkinter

我正在使用 Tkinter 在 Python 2.7.3 中编写图形前端。我有一个主菜单（示例中的 A）和一个窗口（B）。A 包含一个列表框，B 正在做一些需要 A 中列表框内容的事情。B 完成工作后，我需要在 A 中调用一个方法（doSomething）。我的简化代码如下所示：

```
#!/usr/bin/env python

import Tkinter as tk

class A(object):
    def __init__(self, root):
        self.__mainMenu = root
        self.__LB = tk.Listbox(self.__mainMenu)
        self.__LB.pack()
        self.__LB.insert(tk.END, "foo")
        b = B(self.__mainMenu, self.__LB)

    def doSomething(self):
            print "Ham and spam!"

class B(object):
    def __init__(self, mainMenu, LB):
        self.__mainMenu = mainMenu
        self.__LB = LB
        print self.__LB.get(0)
        self.__mainMenu.doSomething()

def main():
    root = tk.Tk()
    gui = A(root)
    root.mainloop()

main() 
```

产生以下输出：

```
$ ./myTest.py 
foo
Traceback (most recent call last):
  File "./myTest.py", line 29, in <module>
    main()
  File "./myTest.py", line 26, in main
    gui = A(root)
  File "./myTest.py", line 11, in __init__
    b = B(self.__mainMenu, self.__LB)
  File "./myTest.py", line 21, in __init__
    self.__mainMenu.doSomething()
  File "/usr/lib/python2.7/lib-tk/Tkinter.py", line 1767, in __getattr__
    return getattr(self.tk, attr)
AttributeError: doSomething 
```

这个错误来自哪里？为什么错误输出这么差？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:43:56.470

我总是使用 gtk（没有使用 Tk 的经验），但据我所知，您在 B.init 中调用 root 的 doSomething 方法，而不是 A 类的方法。__mainMenu.doSomething()在 A **init**
中使用 self 调用 B：

```
b = B(self, self.__LB) 
```

# java - AudioTrack - 使用 jlayer（java mp3 解码器）的短数组到字节数组失真

> ID：15124050
> 
> 赞同：8
> 
> 时间：2013-02-27T22:49:02.620
> 
> 标签：java, android, mp3, pcm, jlayer

我使用 jLayer 来解码 MP3 数据，这个调用：

```
SampleBuffer output = (SampleBuffer) decoder.decodeFrame(frameHeader, bitstream); 
```

这个返回解码数据的调用返回一个 short[] 数组。 `output.getBuffer();`

当我使用该方法调用 AudioTrack write() 时，它会在我循环浏览文件时正常播放：

```
at.write(output.getBuffer(), 0, output.getBuffer().length); 
```

但是，当我使用此答案中的任何方法将 short[] 数组转换为 byte[] 数组时：[https](https://stackoverflow.com/a/12347176/1176436) ://stackoverflow.com/a/12347176/1176436声音会失真和抖动：

```
at.write(output.getBuffer(), 0, output.getBuffer().length); 
```

变成：

```
byte[] array = ShortToByte_Twiddle_Method(output.getBuffer());
at.write(array,  0,  array.length); 
```

我做错了什么，我能做些什么来解决它？不幸的是，我需要将 pcm 数据放在我正在使用的另一个 3rd 方库的字节数组中。如果这很重要，文件是 22kHz，这就是实例化的方式：

```
at = new AudioTrack(AudioManager.STREAM_MUSIC, 22050, AudioFormat.CHANNEL_OUT_STEREO,
                AudioFormat.ENCODING_PCM_16BIT, 10000 /* 10 second buffer */,
                AudioTrack.MODE_STREAM); 
```

非常感谢你。

编辑：这就是我现在实例化 AudioTrack 变量的方式。因此，对于 44kHz 文件，发送的值为 44100，而对于 22kHz 文件，发送值为 22050。

```
at = new AudioTrack(AudioManager.STREAM_MUSIC, decoder.getOutputFrequency(), 
                                  decoder.getOutputChannels() > 1 ? AudioFormat.CHANNEL_OUT_STEREO : AudioFormat.CHANNEL_OUT_MONO,
                                  AudioFormat.ENCODING_PCM_16BIT, 10000 /* 10 second buffer */,
                                  AudioTrack.MODE_STREAM); 
```

这是解码方法：

```
public byte[] decode(InputStream inputStream, int startMs, int maxMs) throws IOException {
        ByteArrayOutputStream outStream = new ByteArrayOutputStream(1024);

        float totalMs = 0;
        boolean seeking = true;

        try {
            Bitstream bitstream = new Bitstream(inputStream);
            Decoder decoder = new Decoder();

            boolean done = false;
            while (!done) {
                Header frameHeader = bitstream.readFrame();
                if (frameHeader == null) {
                    done = true;
                } else {
                    totalMs += frameHeader.ms_per_frame();

                    if (totalMs >= startMs) {
                        seeking = false;
                    }

                    if (!seeking) {
                        // logger.debug("Handling header: " + frameHeader.layer_string());
                        SampleBuffer output = (SampleBuffer) decoder.decodeFrame(frameHeader, bitstream);                            

                        short[] pcm = output.getBuffer();
                        for (short s : pcm) {
                            outStream.write(s & 0xff);
                            outStream.write((s >> 8) & 0xff);
                        }
                    }

                    if (totalMs >= (startMs + maxMs)) {
                        done = true;
                    }
                }
                bitstream.closeFrame();
            }

            return outStream.toByteArray();
        } catch (BitstreamException e) {
            throw new IOException("Bitstream error: " + e);
        } catch (DecoderException e) {
            throw new IOException("Decoder error: " + e);
        }
    } 
```

听起来是这样的（等待几秒钟）：[https](https://vimeo.com/60951237) ://vimeo.com/60951237 （这是实际文件：[http](http://www.tonycuffe.com/mp3/tail%20toddle.mp3) ://www.tonycuffe.com/mp3/tail%20toddle.mp3 ）

编辑：我很想分红，但我把赏金给了比尔，把接受的答案给了尼尔。两者都是巨大的帮助。对于那些想知道的人，我最终重写了 Sonic 原生代码，它帮助我完成了这个过程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-03T17:05:04.227

正如@Bill Pringlemeir 所说，问题在于您的转换方法实际上并没有转换。short 是一个 16 位的数字；一个字节是一个 8 位数字。您选择的方法不会转换短裤的内容（即内容从 16 位变为 8 位），它改变了存储相同位集合的方式。正如你所说，你需要这样的东西：

```
SampleBuffer output = (SampleBuffer) decoder.decodeFrame(frameHeader, bitstream);
byte[] array = MyShortToByte(output.getBuffer());
at.write(array,  0,  array.length); 
```

@Bill Pringlemeir 的方法相当于将所有短裤除以 256 以确保它们适合字节范围：

```
byte[] MyShortToByte(short[] buffer) {
    int N = buffer.length;
    ByteBuffer byteBuf = ByteBuffer.allocate(N);
    while (N >= i) {
        byte b = (byte)(buffer[i]/256);  /*convert to byte. */
        byteBuf.put(b);
        i++;
    }
    return byteBuf.array();
} 
```

这会起作用，但可能会给你非常安静、前卫的音调。如果您负担得起处理时间，则两次通过的方法可能会产生更好的结果：

```
byte[] MyShortToByte(short[] buffer) {
    int N = buffer.length;
    short min = 0;
    short max = 0;
    for (int i=0; i<N; i++) {
         if (buffer[i] > max) max = buffer[i];
         if (buffer[i] < min) min = buffer[i];
         }
    short scaling = 1+(max-min)/256; // 1+ ensures we stay within range and guarantee no divide by zero if sequence is pure silence ...

    ByteBuffer byteBuf = ByteBuffer.allocate(N);
    for (int i=0; i<N; i++) {
        byte b = (byte)(buffer[i]/scaling);  /*convert to byte. */
        byteBuf.put(b);
    }
    return byteBuf.array();
} 
```

同样，请注意已签名/未签名的问题。以上作品有符号->有符号和无符号->无符号；但不在两者之间。可能是您正在阅读带符号的短裤（-32768-32767），但需要输出无符号字节（0-255），...

如果您负担得起处理时间，更精确（更顺畅）的方法是通过浮点数（这也解决了签名/未签名问题）：

```
byte[] MyShortToByte(short[] buffer) {
    int N = buffer.length;
    float f[] = new float[N];
    float min = 0.0f;
    float max = 0.0f;
    for (int i=0; i<N; i++) {
         f[i] = (float)(buffer[i]);
         if (f[i] > max) max = f[i];
         if (f[i] < min) min = f[i];
         }
    float scaling = 1.0f+(max-min)/256.0f; // +1 ensures we stay within range and guarantee no divide by zero if sequence is pure silence ...

    ByteBuffer byteBuf = ByteBuffer.allocate(N);
    for (int i=0; i<N; i++) {
        byte b = (byte)(f[i]/scaling);  /*convert to byte. */
        byteBuf.put(b);
    }
    return byteBuf.array();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-03T16:19:15.880

~~问题在于您`short`的`byte`转换。[字节转换](https://stackoverflow.com/a/12347176/1176436)链接保留所有信息，包括高位和低位部分`byte`。当您将 16 位 PCM 样本转换为 8 位[PCM](http://en.wikipedia.org/wiki/Pulse-code_modulation)样本时，您必须丢弃低字节。我的 Java 技能很弱，所以以下内容可能无法逐字执行。另请参阅：[短字节转换。](https://stackoverflow.com/questions/3114935/convert-from-short-to-byte-and-viceversa-in-java)~~

 ~~```
ByteBuffer byteBuf = ByteBuffer.allocate(N);
while (N >= i) {
  /* byte b = (byte)((buffer[i]>>8)&0xff);  convert to byte. native endian */
 byte b = (byte)(buffer[i]&0xff);  /*convert to byte; swapped endian. */
 byteBuf.put(b);
  i++;
} 
```~~ 

也就是下面的转换，

```
 AAAA AAAA SBBB BBBB  -> AAAA AAAA, +1 if S==1 and positive else -1 if S==1 
```

`A`是有点保留。 `B`是一个被丢弃`S`的位，是您可能希望用于舍入的位。不需要四舍五入，但听起来可能会好一些。基本上，16 位 PCM 的分辨率高于 8 位 PCM。转换完成后，您*会丢失这些位。*`short`to`byte`例程试图保留所有信息。

当然，您必须告诉声音库您正在使用`8-bit PCM`. 我猜，

```
at = new AudioTrack(AudioManager.STREAM_MUSIC, 22050, AudioFormat.CHANNEL_OUT_STEREO,
            AudioFormat.ENCODING_PCM_8BIT, 10000 /* 10 second buffer */,
            AudioTrack.MODE_STREAM); 
```

如果你只能`16bit PCM`用来播放音频，那么你必须做相反的事情并将`8bit PCM`库中的转换`16bit PCM`为播放。另请注意，通常，`8bit`样本通常**不是**直接 PCM，而是[u-law](http://en.wikipedia.org/wiki/%CE%9C-law_algorithm)或[a-law](http://en.wikipedia.org/wiki/A-law_algorithm)编码。如果 3 ^(rd)方库使用这些格式，则转换会有所不同，但您应该能够从 wikipedia 链接对其进行编码。

**注意：**我没有包含舍入代码，因为`overflow`处理`sign`会使答案复杂化。您必须检查`overflow`（即，0x8f + 1 给出 0xff 或 255 + 1 给出 -1）。但是，我怀疑图书馆不是直的`8bit PCM`。

另请参阅：[Alsa PCM 概述](http://www.alsa-project.org/alsa-doc/alsa-lib/pcm.html)， PCM[上的多媒体 wiki 条目](http://wiki.multimedia.cx/index.php?title=PCM)- 最终，Android 使用**ALSA**来获取声音。

~~PCM 原始缓冲区必须正确的其他因素是采样率、通道数（立体声/单声道）、PCM 格式（包括位、*压扩*、小/大端和样本交错）。~~

**编辑：**经过一番调查，JLayer 解码器通常返回`big endian`16 位值。**Sonic 过滤器**，但在 16 位以下`byte`威胁它们`little endian`。最后，`AudioTrack`该类期望`little endian`下面有 16 位。我相信出于某种原因，`JLayer`mp3 解码器将返回 16 位`little endian`值。问题中的`decode()`方法对 16 位值进行字节交换。此外，发布的音频听起来好像字节被交换了。

```
public byte[] decode(InputStream inputStream, int startMs, int maxMs, bool swap) throws IOException {
...
                    short[] pcm = output.getBuffer();
                    for (short s : pcm) {
                        if(swap) {
                          outStream.write(s & 0xff);
                          outStream.write((s >> 8) & 0xff);
                        } else {
                          outStream.write((s >> 8) & 0xff);
                          outStream.write(s & 0xff);
                        }
                    }
... 
```

对于 44k mp3，您可以使用`swap = true;`. 对于 22k mp3 `swap = false`。这解释了所有报道的现象。我不知道为什么`JLayer`mp3 解码器有时会输出`big endian`，有时会输出`little endian`。我想这取决于源 mp3 而不是采样率。

# mediawiki - mediawiki 标准安装未生成 localsettings.php

> ID：15124051
> 
> 赞同：-2
> 
> 时间：2013-02-27T22:49:08.417
> 
> 标签：mediawiki, wiki

我成功安装了媒体 wiki，但是当我查看包含 index.php 的根目录时，我没有看到 localsettings.php

我在哪里可以找到这个文件？[文档](http://www.mediawiki.org/wiki/Manual%3aLocalSettings.php)说默认值在 include/defaultsettings.php 中，但我也没有看到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:12:17.667

我的猜测是你在安装中做错了什么。我会继续尝试第二次安装它。

# c# - 停止儿童在 Moq/AutoFixture 中的嘲弄

> ID：15124054
> 
> 赞同：4
> 
> 时间：2013-02-27T22:49:16.907
> 
> 标签：c#, mocking, moq, autofixture

我遇到了一个问题，即 moq 或 Ploeh.AutoFixture.AutoMoq 正在模拟所有子接口，而在一种情况下，我希望其中一个为空。

我正在使用 Npoc，它有一个名为 IDatabase 的接口

```
 public interface IDatabase : IDatabaseQuery
    {
        IDbConnection Connection { get; }
        IDbTransaction Transaction { get; }

        void AbortTransaction();
        void BeginTransaction();
        void BeginTransaction(IsolationLevel? isolationLevel);
        void CompleteTransaction();
        IDataParameter CreateParameter();
        int Delete(object poco);
        int Delete<T>(object pocoOrPrimaryKey);
        int Delete<T>(Sql sql);
        int Delete<T>(string sql, params object[] args);
        int Delete(string tableName, string primaryKeyName, object poco);
        int Delete(string tableName, string primaryKeyName, object poco, object primaryKeyValue);
        void Dispose();
        Transaction GetTransaction();
        Transaction GetTransaction(IsolationLevel? isolationLevel);
        object Insert(object poco);
        object Insert(string tableName, string primaryKeyName, object poco);
        object Insert(string tableName, string primaryKeyName, bool autoIncrement, object poco);
        void Save(object poco);
        void Save(string tableName, string primaryKeyName, object poco);
        IDatabase SetTransaction(IDbTransaction tran);
        int Update(object poco);
        int Update<T>(Sql sql);
        int Update(object poco, IEnumerable<string> columns);
        int Update(object poco, object primaryKeyValue);
        int Update<T>(string sql, params object[] args);
        int Update(object poco, object primaryKeyValue, IEnumerable<string> columns);
        int Update(string tableName, string primaryKeyName, object poco);
        int Update(string tableName, string primaryKeyName, object poco, IEnumerable<string> columns);
        int Update(string tableName, string primaryKeyName, object poco, object primaryKeyValue);
        int Update(string tableName, string primaryKeyName, object poco, object primaryKeyValue, IEnumerable<string> columns);
    } 
```

我不想 `IDbTransaction Transaction { get; }`被嘲笑，因为我希望它为空，但它被嘲笑了。

然后，我还有一个 IUnitOfWork，其中包含 IDatabase 接口。

```
 public interface IUnitOfWork : IDisposable 
    {
        void Commit();
        IDatabase Db { get; }
        void SetOneTimeCommandTimeout(int timeout);
        void SetGlobalCommandTimeout(int timeout);
        void BeginTransaction();

    } 
```

// 代码

```
 fixture = new Fixture().Customize(new AutoMoqCustomization());
 fixture.Freeze<Mock<IDatabase>>();
 var test = fixture.CreateAnonymous<MyService>(); 
```

由于 Transaction 是一个只读属性，我不知道如何将其设置回 null。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T23:25:22.707

尝试

```
 fixture = new Fixture().Customize(new AutoMoqCustomization());
  var mock = fixture.Freeze<Mock<IDatabase>>();
  mock.SetupGet(o => o.Transaction).Returns((IDbTransaction)null);
  var test = fixture.CreateAnonymous<MyService>(); 
```

# oracle - Oracle中的定点算术错误

> ID：15124060
> 
> 赞同：0
> 
> 时间：2013-02-27T22:49:45.453
> 
> 标签：oracle, plsql

我正在开发一个使用 NUMERIC (27,12) 字段的 Oracle 项目。我首先将 db 字段中的现金值转换为标准化百分比形式，对这些百分比进行一些算术运算，然后最后将它们转换回现金金额。

这是一个资金管理应用程序，有时结果会差一些便士，有些便士短，我相信这是由于这种转换。

我需要知道如何避免在 oracle SQL 中以某种方式引入的这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:30:20.293

没有任何代码很难回答。你使用 BigDecimal 吗？如果转换是错误的（我不这么认为）尝试将值存储/检索为字符串，将字符串转换为 bigdecimal 或其他任何内容，对其进行操作，看看是否获得相同的精度。

# objective-c - 我可以将scanf用于字符串吗？

> ID：15124064
> 
> 赞同：-1
> 
> 时间：2013-02-27T22:50:00.233
> 
> 标签：objective-c

我无法让输入/输出正常工作。请帮忙。

这是我的代码...

```
 char choice1;

    printf("This is a text game! You will be shown what is going on");
    printf("\nand it is up to you to decide what to do.");

    printf("\n\nThere is a gem on the ground.");
    printf("\nWhat do you want to do");
    printf("\n>");

    scanf("%c", &choice1);

    if (choice1 == pick up gem) {
        printf("Got Gem");
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T22:56:07.163

`%c`用于输入单个字符，而不是字符串。如果您想允许用户输入多个字符，那么您需要类似以下内容：

```
char string[256];
fgets(string, 255, stdin);

if (strcmp(string, "pick up gem\n") == 0) {
    printf("Got Gem");
} 
```

顺便说一句 - 这不是 Objective-C，这是 C。

如果用户输入超过 256 个字符，就会发生不好的事情。

**更新**：原来`scanf`只抓取输入的第一个单词。使用`fgets`通过换行符向上读取。

# python - 如何使用 django 实现波兰语复数？

> ID：15124068
> 
> 赞同：2
> 
> 时间：2013-02-27T22:50:17.647
> 
> 标签：python, django, internationalization, django-i18n

我想做一些 i18n 翻译，但不知道如何用 django 来做。

例如我想做这样的翻译 PO 文件示例）：

```
#: mainwindow.cpp:127
#, kde-format
msgid "Time: %1 second"
msgid_plural "Time: %1 seconds"
msgstr[0] "Czas: %1 sekunda"
msgstr[1] "Czas: %1 sekundy"
msgstr[2] "Czas: %1 sekund" 
```

使用这样的复数规则：

```
nplurals=3; plural=(n==1 ? 0 : n%10>=2 && n%10<=4 && (n%100<10 || n%100>=20) ? 1 : 2); 
```

我找到了这样的功能，但它支持英语而不是波兰语如何在 django 中实现它？

```
def ungettext(singular, plural, number):
    return real_ungettext(singular, plural, number) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T23:00:53.977

我的~~女朋友~~妻子是波兰人，在尝试学习波兰语 18 个月后，我会说这是不可能的。开个玩笑，你试过这个吗？

[https://code.google.com/p/django-pluralize-pl/](https://code.google.com/p/django-pluralize-pl/)

# forms - 从表单提交创建可下载的表格

> ID：15124071
> 
> 赞同：0
> 
> 时间：2013-02-27T22:50:28.673
> 
> 标签：forms, post, download, save

好的，所以我的最后一个问题已关闭，因为我没有以正确的方式问它......我想做的是，创建一个 HTML 表单，在提交时以表格格式输出表单并允许您下载该文件，或者自动完成，所以我想简而言之......用户导航到页面，填写表格，点击提交，HTML表格要求下载。我希望我问得正确。这可以帮助我的呼叫中心的座席组织和保存他们丰富的登录名和密码，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:00:48.300

我做了一个快速的谷歌。
您将希望获取表单以提交数据（可能进行客户端验证）
，然后在需要时进行任何服务器端数据验证。
然后将数据输出为表格。例如，如果您将使用 excel 打开它，您还可以使用[此处](http://tejash.me/how-to-export-html-table-into-excel-via-php)
解释的 php 代码导出表格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:11:26.227

您是否尝试过现有的服务，例如[Google Forms](http://support.google.com/drive/bin/answer.py?hl=en&answer=87809)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:11:35.193

为了扩展 jskye，创建一个 HTML 表格将是这样的。

```
//Get POST data from Form
$formData_Name= $_POST['Name'];
$formData_Age= $_POST['Age'];
$formData_Message= $_POST['Message'];

//Modify header information so it knows to download this and how to save it
header("Content-type: application/x-msdownload");
header("Content-Disposition: attachment; filename=table.htm");

//Print headers to table
print "<html><body><table>\n\t".
    "<tr>\n\t\t".
     "<th>Name</th>\n\t\t".
     "<th>Age</th>\n\t\t".
     "<th>Message</th>\n\t".
    "</tr>";
//Print form data to table
print "<table>\n\t".
    "<tr>\n\t\t".
     "<td>". $formData_Name ."</td>\n\t\t".
     "<td>". $formData_Age ."</td>\n\t\t".
     "<td>". $formData_Message ."</td>\n\t".
    "</tr>";
//Close form data
print .= "</table></body></html>"; 
```

# c++ - typedef 和 using 声明在同一范围内的同名

> ID：15124077
> 
> 赞同：10
> 
> 时间：2013-02-27T22:50:37.363
> 
> 标签：c++, typedef, using-declaration

我搜索了 C++11 标准（嗯，n3242 草案）和互联网，但找不到准确的答案。下面的代码在 clang 3.2 和 g++ 4.7.2 以及 Visual Studio 2010 中编译得很好，但我希望得到一个错误。

```
#include <iostream>
#include <typeinfo>

typedef int a_t;

namespace a_ns
{
class a_t {};
}

using a_ns::a_t;

int main()
{
    a_t a;
    std::cout << typeid(a).name() << std::endl;
    return 0;
} 
```

内置：

```
clang -std=c++11 -pedantic -Wall -o a a.cpp -lstdc++
g++ -std=c++11 -pedantic -Wall -o a a.cpp -lstdc++
cl -EHsc -GR a.cpp 
```

clang 和 g++ 生成的可执行文件打印“i”，这似乎表明*a*是 int 类型并且 typedef 占了上风。cl 生成的可执行文件打印“class a_ns::a_t”，这似乎表明 Visual Studio 更喜欢 using 声明。

我希望代码不会根据以下标准摘录进行编译。我预计会出现类似于“使用声明的目标与范围内的声明冲突”的错误。

> 7.1.3.6 类似地，在给定范围内，类或枚举不应使用与在该范围内声明的类型定义名称相同的名称来声明，并且该名称引用类或枚举本身以外的类型。
> 
> 7.3.3.1 using-declaration 将名称引入到 using-declaration 出现的声明性区域中。
> 
> 7.3.3.2 每个使用声明都是一个声明 [...]

标准中可能缺少一些东西来解释这种行为（或者我太累了，看不到明显的东西），但我似乎找不到它。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T23:04:17.460

没错，您所显示的内容使代码无效。还有 3.3.1p4 也使其无效（参见 7.3.3p13）。

对于现实测试，我使用 ICC 进行了测试，它按预期拒绝了它。

# python - Python：编写具有特殊设置行为的“属性”子类

> ID：15124082
> 
> 赞同：1
> 
> 时间：2013-02-27T22:51:01.240
> 
> 标签：python, inheritance, properties

我想编写一个 Python 的子类，`property`它已经有一个设置器，它在设置之前对值进行特定检查。

背景：我有一个具有许多属性的类，这些属性都不能是负数。所以我想将它们全部设置为属性并检查它们是否设置为非负值。但我不想多次编写同一个 setter。

请看下面的例子：

```
class Body(object):
  _mass = 0.
  _size = 0.

  @nonnegative
  def mass(self):
    return self._mass

  @nonnegative
  def size(self):
    return self._size 
```

现在我想定义应该从“property”继承的“nonnegative”。我的 ansatz 正在覆盖该`__set__`方法，但我被卡住了：

```
class nonnegative(property):
  def __set__(self, obj, value):
    if value < 0:
      raise ValueError, 'value must not be negative'
    ### then set the attribute to value, but how?
    ### how can I know the name of the attribute? 
```

或者也许我应该覆盖`fset`？或者`setter`？有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:13:55.977

不像这样更简单：

```
class Body(object):
def __init__(self):
    self._mass = 0.
    self._size = 0.

    self.last = True

def __setattr__(self, name, val):
    if 'last' in self.__dict__:
        if val < 0:
            raise ValueError('value must not be negative')
            return
    self.__dict__[name] = val

def mass(self):
    return self._mass

def size(self):
    return self._size 
```

“最后一个”仅用于跳过您在 init 上提供的值。保持它...最后。显然，您可以检查 attr 名称是否不是保留/特殊名称，否则

```
if val < 0 
```

将检查您在初始化后设置的所有内容。

已编辑：这将在您设置值时检查非负数，而不是在您获得时。如果您想允许负值，但仅在检索时增加错误，请使用

```
__getattr__ 
```

或者（对于 abarnert）以经典方式，但您必须为每个属性编写 setter/getter：

```
class Body(object):
    def __init__(self):
        self._mass = 0.
        self._size = 0.

    @property
    def mass(self):
        return self._mass

    @mass.setter
    def mass(self, value):
        if value < 0:
            raise ValueError('value must not be negative')
        self._mass = value

    @mass.getter
    def mass(self):
        return self._mass 
```

# c# - TFS API - 如何仅返回经过身份验证的用户有权访问的项目，而不是整个列表？

> ID：15124088
> 
> 赞同：2
> 
> 时间：2013-02-27T22:51:29.933
> 
> 标签：c#, tfs, tfs-sdk

我目前正在使用 api 从 TFS 返回一个项目列表。

```
var tfs = TfsTeamProjectCollectionFactory.GetTeamProjectCollection(new Uri("some URI"));
var store = (WorkItemStore)tfs.GetService(typeof(WorkItemStore));
var projects = store.Projects 
```

这工作正常。但是，它会为每个用户返回我们的 TFS 团队项目的完整列表。有没有办法返回或过滤列表，以便只返回特定用户有权访问的项目？

这是使用 TFS 2010。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T23:06:58.647

在 TFS 2010 中，我相信您可以通过在拨打电话时[模拟](http://blogs.msdn.com/b/taylaf/archive/2009/12/04/introducing-tfs-impersonation.aspx)您感兴趣的用户来做到这一点。

TFS 2010 API 允许（适当授权的）应用程序“模拟”您想要的任何有效用户并以该用户的身份采取行动。这是“授权”模拟——您没有以另一个用户身份进行身份验证，因此没有密码输入，但您“代表”另一个用户采取行动。执行此操作需要特定权限，因此您的应用程序需要以具有“代表其他用户发出请求”权限的用户身份*实际运行。*

完成后，代码非常简单。您从 TPC 中提取所需的身份，然后在不同的上下文中创建第二个“模拟”身份，并将该第二个上下文用于您的实际工作：

```
var tfs = TfsTeamProjectCollectionFactory.GetTeamProjectCollection(new Uri("some URI"));
var identityService = tfs.GetService<IIdentityManagementService>();
var identity = identity = identityService.ReadIdentity(
        IdentitySearchFactor.AccountName,
        "someuser", 
        MembershipQuery.None, 
        ReadIdentityOptions.None);

var userTfs = new TfsTeamProjectCollection(tfs.Uri, identity.Descriptor); 
```

您执行的任何操作都`userTfs`将像指定的用户名一样执行；这允许您代表其他用户查询项目、队列构建等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T11:12:49.280

如果添加`using System.net`，则可以使用凭据缓存并在获取集合时将当前用户的默认凭据传递给 TFS

```
using (var tfs = new TfsTeamProjectCollection(tfsUri, CredentialCache.DefaultCredentials))
            {
                var store = (WorkItemStore)tfs.GetService(typeof(WorkItemStore));
                var projects = store.Projects                
            } 
```

# javascript - 检查数组是否包含字符串或值

> ID：15124090
> 
> 赞同：0
> 
> 时间：2013-02-27T22:51:36.630
> 
> 标签：javascript, jquery

我目前正在通过在 texfield 中编写一些内容并单击一个按钮来将一个数组添加到另一个数组。我还有一个 if 语句，它应该检查我正在编写的字符串是否已经存在于表中，如果存在，我应该得到一个警报。但是，即使我的数组为空，每次尝试添加内容时都会收到警报。有什么解决办法吗？

Javascript

```
$(document).ready(function(){

var films = [];

// ändra bakgrundsfärg för textfield 
$('#name').keyup(function(){
            $('#name').css('background-color', 'white');
});

// ändra bakgrundsfärg för select lista
$('#options').change(function(){
            $('#options').css('background-color', 'white');
});

// kör funktionen när knappen med id "button" klickas
$("#button").click(function(){
    var titelBetyg = [];

    var titel = $('#name').val();
    var betyg = $('#options').val();

    // kontrollera om textfield är tom
    if(titel == ""){
        $('#name').css('background-color', 'red');
        alert("Mata in titel.....");
    }

    // kontrollera om select lista inte är vald
    else if(betyg == "0"){
        $('#options').css('background-color', 'red');
        alert("Välj betyg....");
    }

         // HERE IS THE IF STATEMENT WHERE IT FAILS
    // kontrollera om filmen redan finns
    else if($.inArray($("#name"), films) > -1){
        alert("Filmen finns redan...");
    }

    else{
        titelBetyg.push(betyg);
        titelBetyg.push(titel);
        films.push(titelBetyg);

        var ul = $('#rightbar ul').empty();
        if (!ul.length){ // om ul inte finns
            ul = $("<ul>").appendTo('#rightbar'); // skapa en ny
        }

        // loopa igenom arrayen och placera innehållet i ul och li
        for (var i=0; i<films.length; i++){
            ul.append("<li>" + films[i][1] + " " + "<span>" + films[i][0] + "</span>" + "</li>");
        }

        $('#form').get(0).reset();

    }
});

// kör funktionen när knappen med id "stigande" klickas
 $('#stigande').click(function () {
    if (films.length > 1) {
        films.sort(function (a, b) {
            return (a[0].length < b[0].length) ? 1 : -1;
        })
        var ul = $('#rightbar ul').empty();
        for (var i = 0; i < films.length; i++) {
            ul.append("<li>" + films[i][1] + " " + "<span>" + films[i][0] + "</span>" + "</li>");
        }
    }
});

// kör funktionen när knappen med id "fallande" klickas
$('#fallande').click(function () {
    if (films.length > 1) {
        films.sort(function (a, b) {
            return (a[0].length > b[0].length) ? 1 : -1;
        })
        var ul = $('#rightbar ul').empty();
        for (var i = 0; i < films.length; i++) {
            ul.append("<li>" + films[i][1] + " " + "<span>" + films[i][0] + "</span>" + "</li>");
        }
    }
});

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T22:54:29.267

```
$.inArray($("#name"), films) > -1 
```

您正在检查数组中是否存在 jQuery 元素的集合，您可能的意思是：

```
$.inArray($.trim( $("#name").val() ), films) > -1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T22:54:41.687

是`$('#name')`一个`input`？如果是这样，您应该使用`$('#name').val()`而不仅仅是`$('#name')`.

# python - Python中优先级较高的优先级队列

> ID：15124097
> 
> 赞同：17
> 
> 时间：2013-02-27T22:52:04.103
> 
> 标签：python, queue, priority-queue

我需要一个优先级队列，它首先获取具有最高优先级值的项目。我目前正在使用[队列](https://docs.python.org/2/library/queue.html)库中的 PriorityQueue 类。但是，此函数仅首先返回具有最低值的项目。我尝试了一些丑陋的解决方案，例如 (sys.maxint - priority) 作为优先级，但只是想知道是否存在更优雅的解决方案。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-27T22:53:29.360

改为使用负优先级，无需从 中减去`sys.maxint`。

```
queue.put((-priority, item)) 
```

例如，优先级为 -10 的项目将在优先级为 -5 的项目之前返回。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-07-09T20:47:15.603

您可以扩展优先级队列以保持逻辑不变：

```
from Queue import PriorityQueue

class DualPriorityQueue(PriorityQueue):
    def __init__(self, maxPQ=False):
        PriorityQueue.__init__(self)
        self.reverse = -1 if maxPQ else 1

    def put(self, priority, data):
        PriorityQueue.put(self, (self.reverse * priority, data))

    def get(self, *args, **kwargs):
        priority, data = PriorityQueue.get(self, *args, **kwargs)
        return self.reverse * priority, data

minQ = DualPriorityQueue()
maxQ = DualPriorityQueue(maxPQ=True)

minQ.put(10, 'A')
minQ.put(100, 'A')

maxQ.put(10, 'A')
maxQ.put(100,'A')

print "Min DQ: {}".format(minQ.get())
print "Max DQ: {}".format(maxQ.get()) 
```

输出：

```
Min DQ: (10, 'A')
Max DQ: (100, 'A') 
```

# excel - Excel - 如何制作第三列颜色的散点图？

> ID：15124103
> 
> 赞同：12
> 
> 时间：2013-02-27T22:52:31.793
> 
> 标签：excel, sorting

我有一个`excel`包含如下数据的工作表：

```
Type   X     Y
B      1.2   5.6
B      4.5   2.5
B      2.3   0.9
A      1.2  -9.3
B      2.2  -2.3
C      3.5   6.7 
```

虽然当然还有更多的行。

我正在尝试`XY scatter`为`X`和`Y`数据点绘制图，但是，我希望根据`'Type'`列对图进行着色。

有谁知道我该怎么做？我可以手动创建一个新的数据系列，但这对于我拥有的行数是不可能的，而且这些`'type'`值不一定是按顺序排列的。

谢谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-27T23:39:57.420

这是我能想到的最好的（非 vba）方式（如果你知道这种语言，我会推荐 VBA），但它可能涉及太多的手动工作，具体取决于你真正拥有的类型。

首先，翻转 Y 和 X 列，并为您拥有的每种数据类型添加一个新列（见下图）

在区域 D2:F7 中，使用此公式：`=IF(D$1=$A2, $B2, #N/A)` *如果列标题等于该行中的类型，则从该行复制 Y 值，否则该单元格为 '#N/A'*

这将为您留下一个如下图所示的表格。选择范围 C1:F7，然后插入散点图，它应该会给出您想要的结果：

![在此处输入图像描述](../Images/c9ea969a101faf29d8264e52a1ee3e3f.png)

# java - 使用 jnlp 启动 java 小程序，但未指定宽度和高度

> ID：15124108
> 
> 赞同：2
> 
> 时间：2013-02-27T22:52:50.293
> 
> 标签：java, applet, jnlp, java-web-start

我有一个小程序，想通过 jnlp 启动它。目前它启动，但问题在于宽度和高度。如果我手动启动小程序（java -jar applet.jar），我没有指定宽度和高度。小程序根据其他一些动态条件自行决定它应该是什么大小。但是当通过 jnlp 文件 (javaws applet.jnlp) 启动时，我必须指定一个大小。是否可以通过 jnlp 启动小程序并让小程序决定自己的大小？如果我只是从 jnlp 文件中省略了宽度和高度，我会收到一条错误消息，指出需要宽度和高度。但是只有小程序知道宽度和高度应该是多少。另外，我不想修改小程序的源代码。这可能吗？如何？

# java - Eclipse 导出为不同的项目使用相同的位置和文件名

> ID：15124117
> 
> 赞同：1
> 
> 时间：2013-02-27T22:53:32.540
> 
> 标签：java, eclipse, export

我目前在同一个工作区中处理 4 个不同的 Java 项目，每当我导出一个项目时，文件位置和文件名都是我最后一次导出的，即使它来自不同的项目。

eclipse 中是否有一个选项可以更改每个项目的导出的默认文件位置和文件名？

例子：

C:/projects/exports/foo.jar 被设置为导出到的默认位置，即使我正在导出一个不同的项目，我想在 C:/projects/exports/bar.jar

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:04:52.687

stock eclipse 安装不提供设置默认导出位置的方法。

尝试`File -> Export`功能存储最后导出的位置列表，您可以重复使用这些位置。

# c - C 显示两者（简单的 if-then）

> ID：15124118
> 
> 赞同：-4
> 
> 时间：2013-02-27T22:53:36.623
> 
> 标签：c

我一定是疯了:-(。我不确定，但如果我输入 2，我会得到是和不显示...

```
int main(void)
{
    int input;
    char yes[3] = "yes";
    char no[2] = "no";
    printf("Are you ok? Type in 1 for yes or 2 for no.\n");
    scanf("%d", &input);

    if (input == 1)
       printf("%s, I am\n.", yes);
    else
       printf("%s, I am not\n.", no);
    getchar();
    getchar();
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T22:55:05.253

```
char yes[3] = "yes"; 
```

您需要`4`数组中的字符。

```
 char no[2] = "no"; 
```

您需要`3`数组中的字符。

否则 C 不会终止你的数组。

更好的方法是让大小在构建时自动处理：

```
char no[] = "no";
char yes[] = "yes"; 
```

# c# - 以编程方式确定 VSS 数据库中的最近签入

> ID：15124128
> 
> 赞同：3
> 
> 时间：2013-02-27T22:54:35.743
> 
> 标签：c#, visual-sourcesafe

我正在从 VSS 迁移到 TFS。我正在迁移的安装使用多个 VSS 数据库（其中很多）。

我正在寻找一种简单的方法来确定每个 vss 数据库的最后一次签入的日期和时间，以便我可以知道是否需要刷新 TFS 中已经存在的代码。

在高层次上，我想写一个这样的方法：

```
DateTime GetLatestCheckIn(string pathToVssDatabase) {} 
```

有没有办法用 VSS COM API 来完成这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:19:22.990

我想我明白了！

这是一个非常粗略的剪辑，只是一个显示最新更新和更新日期的控制台应用程序。这效率不高——现在我知道该怎么做，我将消除排序并只做一次，比较最近的项目，但是，这里是它的要点：

```
 class Program
    {
        static void Main(string[] args)
        {
            //Environment.CurrentDirectory = @"c:\Program Files (x86)\Microsoft Visual SourceSafe Upgrade";
            IVSSDatabase db = new VSSDatabase();

            db.Open(@"ThePath\srcsafe.ini", "Admin", "ThePassword");
            IVSSItem rootFolder = db.get_VSSItem("$/", false);
            var versions = new List();
            foreach (IVSSVersion item in rootFolder.get_Versions((int)Microsoft.VisualStudio.SourceSafe.Interop.VSSFlags.VSSFLAG_RECURSYES))
            {
                versions.Add(new VersionInfo()
                {
                    ItemName = item.VSSItem.Name,
                    ItemFullPath = item.VSSItem.Spec,
                    ItemVersionDate = item.Date,
                    ItemVersionNumber = item.VersionNumber
                });
            }

            // echo all 
            var versionInfo = versions.OrderByDescending(i => i.ItemVersionDate).First();
            Console.WriteLine("{0} {1}", versionInfo.ItemFullPath, versionInfo.ItemVersionDate);
            Console.ReadLine();
        }
    }

    class VersionInfo
    {
        public string ItemName { get; set; }
        public string ItemFullPath { get; set; }
        public DateTime ItemVersionDate { get; set; }
        public int ItemVersionNumber { get; set; }
    }

```

# sharepoint - 控制台应用程序到 SharePoint om 的 powershell

> ID：15124131
> 
> 赞同：0
> 
> 时间：2013-02-27T22:54:44.210
> 
> 标签：sharepoint, powershell, sharepoint-2010

是否可以将此博客代码从控制台应用程序转换为 powershell？如果是，如何？

[http://digsharepoint.blogspot.com/2011/11/retrieving-credentials-from-secure.html](http://digsharepoint.blogspot.com/2011/11/retrieving-credentials-from-secure.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T08:17:03.277

为什么不直接使用完全相同的代码创建一个类库 DLL，然后在 PowerShell 中使用

```
 #Load assemblies (needed for SharePoint Server)
 [void][System.Reflection.Assembly]::LoadWithPartialName("YourDllNameSpace") 
```

这将从 GAC 加载，但您也可以指定 LoadFile 和 DLL 路径。

有关更多信息，请参阅[此](http://www.dougfinke.com/blog/index.php/2010/08/29/how-to-load-net-assemblies-in-a-powershell-session/)帖子。

希望能帮助到你，

安德鲁

# c# - 串口轮询和数据处理

> ID：15124132
> 
> 赞同：5
> 
> 时间：2013-02-27T22:54:45.127
> 
> 标签：c#, serial-port, polling

我正在尝试通过微控制器从传感器读取多个串行端口。每个串口将接收超过 2000 个测量值（每个测量值是 7 个字节，全部为十六进制）。他们同时开火。现在我正在从 4 个串行端口轮询。此外，我将每个测量值转换为字符串并将其附加到 Stringbuilder。当我完成接收数据时，它们将被输出到一个文件中。问题是CPU消耗非常高，从80%到100%不等。

我浏览了一些文章并将 Thread.Sleep(100) 放在最后。当没有数据到来时，它会减少 CPU 时间。当 BytesToRead 小于 100 时，我还将 Thread.Sleep 放在每次轮询的末尾。它仅在一定程度上有所帮助。

有人可以建议一种解决方案来从串行端口轮询并处理我得到的数据吗？也许每次我得到一些东西时都附加会导致问题？

```
//I use separate threads for all sensors
private void SensorThread(SerialPort mySerialPort, int bytesPerMeasurement, TextBox textBox,     StringBuilder data)
    {
        textBox.BeginInvoke(new MethodInvoker(delegate() { textBox.Text = ""; }));

        int bytesRead;
        int t;
        Byte[] dataIn;

        while (mySerialPort.IsOpen)
        {
            try
            {
                if (mySerialPort.BytesToRead != 0)
                {
                  //trying to read a fix number of bytes
                    bytesRead = 0;
                    t = 0;
                    dataIn = new Byte[bytesPerMeasurement];
                    t = mySerialPort.Read(dataIn, 0, bytesPerMeasurement);
                    bytesRead += t;
                    while (bytesRead != bytesPerMeasurement)
                    {
                        t = mySerialPort.Read(dataIn, bytesRead, bytesPerMeasurement - bytesRead);
                        bytesRead += t;
                    }
                    //convert them into hex string
                    StringBuilder s = new StringBuilder();
                    foreach (Byte b in dataIn) { s.Append(b.ToString("X") + ","); }
                    var line = s.ToString();

                                            var lineString = string.Format("{0}  ----          {2}",
                                                      line,
                                                    mySerialPort.BytesToRead);
                    data.Append(lineString + "\r\n");//append a measurement to a huge Stringbuilder...Need a solution for this.

                    ////use delegate to change UI thread...
                    textBox.BeginInvoke(new MethodInvoker(delegate() { textBox.Text = line; }));

                    if (mySerialPort.BytesToRead <= 100) { Thread.Sleep(100); }
                }
            else{Thread.Sleep(100);}

            }
            catch (Exception ex)
            {
                //MessageBox.Show(ex.ToString());
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T23:06:51.957

这不是一个好方法，处理 DataReceived 事件要好得多。

基本上，串行端口有一个运行良好的 3 阶段过程。

*   从串口接收数据
*   等到你有一个相关的数据块
*   解释数据

所以像

```
class DataCollector
{
    private readonly Action<List<byte>> _processMeasurement;
    private readonly string _port;
    private SerialPort _serialPort;
    private const int SizeOfMeasurement = 4;
    List<byte> Data = new List<byte>();

    public DataCollector(string port, Action<List<byte>> processMeasurement)
    {
        _processMeasurement = processMeasurement;
        _serialPort = new SerialPort(port);
        _serialPort.DataReceived +=SerialPortDataReceived;
    }

    private void SerialPortDataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        while(_serialPort.BytesToRead > 0)
        {
           var count = _serialPort.BytesToRead;
           var bytes = new byte[count];
           _serialPort.Read(bytes, 0, count);
           AddBytes(bytes);
        }
    }

    private void AddBytes(byte[] bytes)
    {
        Data.AddRange(bytes);
        while(Data.Count > SizeOfMeasurement)            
        {
            var measurementData = Data.GetRange(0, SizeOfMeasurement);
            Data.RemoveRange(0, SizeOfMeasurement);
            if (_processMeasurement != null) _processMeasurement(measurementData);
        }

    }
} 
```

注意：添加字节会一直收集数据，直到您有足够的数据作为测量值，或者如果您获得大量数据，则将其拆分为单独的测量值......因此您可以一次获得 1 个字节，下一次获得 2 个字节，并且再下一个，然后将其转换为测量值。大多数情况下，如果您的 micro 以突发方式发送它，它将作为一个输入，但有时它会分成 2 个。

然后你可以做的地方

```
var collector = new DataCollector("COM1", ProcessMeasurement); 
```

和

```
 private void ProcessMeasurement(List<byte> bytes)
            {
                // this will get called for every measurement, so then
                // put stuff into a text box.... or do whatever
            } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:34:00.960

首先考虑阅读[Using Stopwatches and Timers in .NET](http://robertgreiner.com/2010/06/using-stopwatches-and-timers-in-net/)。您可以用它来分解任何性能问题，并准确判断您的代码的哪一部分导致了问题。

使用[SerialPort.DataReceived 事件](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx)触发数据接收过程。

单独的接收过程和数据操作过程。先存储您的数据，然后再处理。

不要从阅读循环中编辑 UI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T23:14:14.767

我猜你应该做的是添加一个事件处理程序来处理传入的数据：

```
mySerialPort.DataReceived += new SerialDataReceivedEventHandler(mySerialPort_DataReceived); 
```

这消除了为您侦听的每个串行端口运行单独线程的需要。此外，每个 DataReceived 处理程序将在有可用数据时准确调用，并且将仅消耗处理数据所需的 CPU 时间，然后屈服于应用程序/操作系统。

如果这不能解决 CPU 使用问题，则意味着您进行了过多的处理。但是除非你有一些非常快的串行端口，否则我无法想象你在那里的代码会造成问题。

# ruby-on-rails - 如何防止“rake test”删除“rake db:seed”数据？

> ID：15124142
> 
> 赞同：1
> 
> 时间：2013-02-27T22:55:26.247
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, rake-test

我的 Ruby 版本是 ruby​​ 1.9.3p385 。我的 Rails 版本是 3.2.12。

我使用以下内容加载测试数据库：

```
rake db:seed RAILS_ENV=test 
```

一切都很好。所有工厂女孩的东西都装得很好。

test/factories.rb 的内容包含工厂。db/seeds.rb 的内容很简单：

```
FactoryGirl.create(:music_categorization)
FactoryGirl.create(:dance_categorization) 
```

现在，当我使用以下命令运行测试时：

```
rake test 
```

Rails 删除了所有种子数据，测试失败。我想要一种方法来防止“rake test”删除数据。

我走的另一条路线是加载种子数据，作为本[问题](https://stackoverflow.com/questions/1574797/how-to-load-dbseed-data-into-test-database-automatically)中提到的“rake test”命令的一部分。但是，最终会加载两次测试数据（基本上 db/seeds.rb 出于某种原因被调用了两次）。我放弃了这条路线，现在只想执行以下操作来运行我的测试：

```
rake db:seed RAILS_ENV=test
rake test 
```

任何帮助表示赞赏。我基本上想防止 rake test 删除我的数据，或者想办法不让 db/seeds.rb 调用两次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:36:04.287

首先，我只想说，一般来说，您不应该在测试中使用种子数据。测试应该使用空数据库运行，并且您只创建每个测试所需的数据。

在您的情况下，您似乎没有理解种子数据的含义，这基本上是您的应用程序正常工作所需的核心数据。如果您需要在测试中实例化几个模型，只需执行（假设您使用的是 rspec）

```
 before(:each) do
      FactoryGirl.create(:music_categorization)
      FactoryGirl.create(:dance_categorization)
    end 
```

如果您仍想使用种子数据运行测试，您可以随时尝试并运行`rspec`，它只会运行您所有的 rspec 示例，而测试数据库保持原样。但请相信，这不是你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:42:25.063

AFAIK 通常不`db:seed`用于为您的测试加载数据，它通常仅用于加载种子数据以用于开发目的。

相反，您应该在实际的测试文件中创建测试数据。通常在每次测试后使用 database_cleaner 删除测试数据[，](https://github.com/bmabey/database_cleaner)因此每次测试都从一个空数据库开始。

例如，在 rspec 中，您可以在[`let`](https://www.relishapp.com/rspec/rspec-core/v/2-11/docs/helper-methods/let-and-let)块、[`before`](https://www.relishapp.com/rspec/rspec-core/v/2-2/docs/hooks/before-and-after-hooks)块或测试本身中加载测试数据，例如

```
require 'spec_helper'

describe Page do
  let(:user) { FactoryGirl.create(:user) }

   before do
     # create some data
   end

  it '#name returns XYZ' do
    page = FactoryGirl.create(:page, :user => user)
    page.description.should == 'XYZ'
  end

  it '#description returns ABC' do
    page = FactoryGirl.create(:page, :user => user)
    page.description.should == 'ABC'
  end
end 
```

# visual-studio-2008 - 图像显示在 Visual Studio 和报表生成器中——但不在 SSRS 中

> ID：15124143
> 
> 赞同：0
> 
> 时间：2013-02-27T22:55:25.900
> 
> 标签：visual-studio-2008, reporting-services, reportbuilder3.0

我继承了在 Visual Studio 2008 中开发的几个报表。我被要求将它们上传到 SSRS 报表管理器，以便人们可以在报表生成器中维护它们。两份报告中的一份上传没有问题，但是...

在其中一份报告中，图像（嵌入）未显示在 SSRS 中，我看到的是占位符。但奇怪的是，如果我继续使用 Report Builder，图像就在那里！这向我表明，图像也必须存在于 SSRS 中，但 SSRS 出于某种原因没有显示它们。而且由于图像***显示***在另一个报告上，因此我的全局 SSRS 配置不会有问题。（正确的？）

如果我的一些术语令人困惑，请提前道歉，我对这一切***都很陌生。***

非常感谢你的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T17:36:44.307

图片背后有代码吗？我有以下代码，它在 SSRS 和 RB 3.0、RB2.0 中显示正常

System.Convert.FromBase64String(Mid(System.Convert.ToBase64String(Fields!Picture.Value),105))

# perl - 如何在 2 个不同的 perl 脚本之间共享一个全局参数

> ID：15124146
> 
> 赞同：1
> 
> 时间：2013-02-27T22:55:31.257
> 
> 标签：perl, export, global-variables

论坛上也有同样的问题。 [如何在两个不同的 perl 脚本之间共享/导出全局变量？](https://stackoverflow.com/questions/4543934/how-to-share-export-a-global-variable-between-two-different-perl-scripts)

但是，对此的建议是在声明时使用“我们的”，然后在另一个脚本中添加“要求”。当我尝试使用它时，脚本失败说“不推荐使用保留字“我们的”。

是否有不同的方法可以在不同的文件之间共享参数。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:21:14.783

如果您不能使用`our`关键字，那么您必须退回到简单地使用变量而不正确声明它：

```
{
  no strict;
  $variable = "foo"; # implicitly a global
} 
```

语法

```
$MyPackage::variable = "foo"; # uses the fully qualified name 
```

也应该工作。

这些将允许您使用全局，但不会正确限定名称的可见性。

但是，您绝对应该立即升级该 perl——它是一个开发版本，而不是常规版本。当前版本是 perl5 v16.2。

# internet-explorer-9 - 仅在 IE9 上找不到页面

> ID：15124154
> 
> 赞同：0
> 
> 时间：2013-02-27T22:56:30.330
> 
> 标签：internet-explorer-9

我的[这个网页](http://accm.com.eg/news/news.html)可以在任何浏览器上完美运行……除了 IE9。它闪烁了一秒钟，然后抛出了 404 错误页面找不到。

知道如何挖掘和修复它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:04:35.787

您有一个脚本试图调用此 URL：[http](http://accm.com.eg/news/undefined) ://accm.com.eg/news/undefined 。

IE 和其他浏览器的处理方式不同，但问题不在于浏览器。您必须找出脚本有什么问题；）

# f# - 使用非 Bool 返回类型重载相等和比较运算符

> ID：15124155
> 
> 赞同：2
> 
> 时间：2013-02-27T22:56:34.470
> 
> 标签：f#

为什么覆盖相等和比较运算符以产生除 bool 以外的类型如此困难，是否有特定的原因。

我在下面有一个解决方法，但为什么语言不能让这更容易呢？

我在这里使用的是一个外部库，它已经重载了这些运算符，我只是希望它们在 F# 中以相同的方式工作。我必须这样做才能实现这一点似乎并不正确。

```
type ATArrayLT = ATArrayLT with
    static member        (?<-) (x:ATArray, ATArrayLT, y:int    ) = ATArray.op_LessThan(x, float32 y)
    static member        (?<-) (y:int    , ATArrayLT, x:ATArray) = ATArray.op_LessThan(x, float32 y)        
    static member        (?<-) (x:ATArray, ATArrayLT, y:float32) = ATArray.op_LessThan(x, y)
    static member        (?<-) (y:float32, ATArrayLT, x:ATArray) = ATArray.op_LessThan(x, y)
    static member        (?<-) (x:ATArray, ATArrayLT, y:ATArray) = ATArray.op_LessThan(x, y)
    static member inline (?<-) (x        , ATArrayLT, y        ) = x < y

let inline (<) x y = x ? (ATArrayLT) <- y 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:23:03.160

比较和相等运算符 ( `<`, `>`, `=`) 具有明确定义的行为 ([规范 §8.15.6](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec.html#_Toc335818970) )。具体来说，比较取决于`IComparable`实现，相等取决于`Equals`.

与 C# 中的同名运算符只有短暂的相似之处。您仍然可以提供具有非传统行为的 C# 变体，以便在其他 .NET 语言中使用

```
type T() =
  static member op_LessThan (a: T, b: T) = new obj() 
```

但它们对 F# 的相等和比较运算符没有影响。

# jquery-mobile - jQuery Mobile 图形在移动设备上与在桌面浏览器上查看时不同

> ID：15124162
> 
> 赞同：3
> 
> 时间：2013-02-27T22:57:08.190
> 
> 标签：jquery-mobile

我有一个`jQuery Mobile`单选按钮集，当在桌面浏览器上查看时，会为非活动选择显示一个灰色填充的点，为活动选择显示一个带有白色中心的红色填充点。

但是，当我在移动设备中查看页面时（要么 要么`iOS`，`Android)`我没有得到任何非活动选择和一个奇怪的活动选择的新图形。新图形是一个红点，但有三个白色条相互垂直堆叠，并且到点的右侧。

通常我不会在意，但这个图形看起来可能是公司标志或其他东西，因此有点分散注意力。此外，非活动选择缺少灰点很烦人。有人知道这里发生了什么吗？

# java - 获取 Selenium 测试的错误列表，而不是使用 try-catch 块在单个错误上停止测试

> ID：15124163
> 
> 赞同：1
> 
> 时间：2013-02-27T22:57:11.377
> 
> 标签：java, selenium, error-handling, try-catch, testng

我一直在尝试使用 Selenium 中的“验证”选项而不是“断言”选项。我的想法是使用验证选项是我的测试可以完全运行，然后获取错误列表。在尝试这样做时，我意识到“代码明智”的验证选项与 Assert 相同，但它只是被 try-catch 块包围。我已经尝试了各种选项来完成这项工作，但我面临的问题是测试仍然停止在中断的语句上，而不是给我一个错误列表。

我的结构是：

```
public class SelTests {

    public StringBuffer verificationErrors = new StringBuffer();
    public WebDriver driver;

    @BeforeTest
    public void setup() throws Exception {
        // DO SETUP STUFF
    }

    @Test
    public void TestScript1() throws Exception {

    try { //assertEquals("string1", "string2") } catch (Exception e) {verificationErrors.append(e.toString());}
    try { //assertEquals("string1", "string2") } catch (Exception e) {verificationErrors.append(e.toString());}
    try { //assertEquals("string1", "string2") } catch (Exception e) {verificationErrors.append(e.toString());}

    @AfterTest
    public void tearDown() throws Exception{

        driver.close();

        String verificationErrorString = verificationErrors.toString();
        if (!"".equals(verificationErrorString)) {
            fail(verificationErrorString);
            System.out.println(verificationErrorString);    
        }    
    } 
```

但即使在以多种方式修改后，我仍然遇到同样的问题。我还尝试包围整个断言语句块，而不是像上面的代码中那样单独执行它们，但没有任何效果。我故意在一些断言中引入了错误，但每次我只得到 1 个错误的日志。

环境：

```
Selenium 2.30 Server-standalone
TestNG annotations and frameworks
Java code using WebDriver implementations
Eclipse
Windows 7 - 64bit (this should not matter though) 
```

任何帮助指导我实现我想要实现的目标都将不胜感激。

谢谢，

阿利斯特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T04:15:45.777

它不去 catch 块的原因是 Asserts throw AssertionErrors。错误不同于异常。当您捕获异常时，您不会捕获 AssertionError。将 catch 块 Exception e 更改为 AssertionError 或 Throwable，这意味着任何异常或错误。

# cuda - 我无法在 CUDA 内核中设置断点

> ID：15124169
> 
> 赞同：0
> 
> 时间：2013-02-27T22:57:48.200
> 
> 标签：cuda, nsight

我是 NSIGHT 和 CUDA 的新手。我试图在我的 CUDA 内核代码中设置一个断点，但我不能——断点设置在我的内核末尾，而不是在我要调试的特定行上。

*   我正在使用带有 NSIGHT 2.2 和 CUDA 4.2 的 VS2010（MFC 项目）。
*   我正在调试模式下编译。
*   我在一个不是“StratUp 项目”的项目中使用 CUDA。
*   我正在使用带有“是（-g）”的“生成主机调试信息”
*   我正在使用带有“是（-G）”的“生成设备调试信息”

我目前正在通过*Menu->Nsight->Start CUDA debugging*运行程序。当我尝试在另一个项目（即“启动项目”）上设置断点时，我确实成功了。关于如何让断点作用于特定行而不是整个内核的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:24:33.790

我使用了太多线程 (256X256) 来激活我的内核。dim3 线程（256,256）（内核<<<...，线程>>>

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-03T13:43:46.553

需要注意的是，调试 CUDA 时，如果机器上的内核数大于正在运行的 CUDA 线程数，设备代码中设置的断点将无法正常工作。此外，如果 CUDA 线程数不能被内核数整除，则某些内核将不会在最后一次迭代中命中设备代码断点。

# silverlight-5.0 - Silverlight 工具包破解 silverlight 5 应用程序

> ID：15124170
> 
> 赞同：1
> 
> 时间：2013-02-27T22:57:49.193
> 
> 标签：silverlight-5.0, silverlight-toolkit

我正在将 Silverlight 4 应用程序升级到 Silverlight 5。我在将目标 Silverlight 版本更改为 Silverlight 5 (Visual Studio 2010) 后运行了该应用程序，并在加载应用程序之前收到以下错误：

Silverlight 应用程序代码中未处理的错误：2110
类别：InitializeError
消息：AG_E_UNKNOWN_ERROR

我无法使用 Visual Studio 调试器找到问题，所以我认为这可能是参考的问题。我注意到大多数核心库现在都指向 Microsoft/Framework 目录中的 Silverlight/v5.0 目录，但 Toolkit 库没有升级。我下载了 2012 年 5 月发布的工具包并手动升级了所有这些库，但仍然收到错误消息。所以我创建了一个新的 Silverlight 5 项目并开始逐步添加库。然后，当我添加对 Silverlight Toolkit 的引用时，该应用程序引发了该错误。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T22:57:49.193

在写我的问题的过程中，我决定尝试使用 nuget 安装工具包，现在错误已经解决。我留下这个问题是因为我花了几个小时来解决这个问题，并且没有太多关于 Silverlight 错误代码 2110 的信息。我确实注意到 nuget 安装了 4.0.5.0 版的工具包库，而 2012 年 5 月的工具包显示了 5.0.5.0 版，所以这可能是问题所在。

# android - 将位图大小调整为固定值但不更改纵横比

> ID：15124179
> 
> 赞同：15
> 
> 时间：2013-02-27T22:58:16.167
> 
> 标签：android, view, bitmap, scaling

我正在寻找以下问题的解决方案：如何将 a 的大小更改为`Bitmap`固定大小（例如 512x128）。必须保留位图内容的纵横比。

我认为应该是这样的：

*   创建一个空的 512x128 位图

*   在保持纵横比的情况下缩小原始位图以适应 512x128 像素

*   将缩放后的位图复制到空位图中（居中）

实现这一目标的最简单方法是什么？

这一切的原因是，`GridView`当图像的纵横比与另一个不同时，布局会变得混乱。这是一个屏幕截图（除最后一张外，所有图像的纵横比均为 4:1）：

[截屏](http://www.thkusch.de/gridview.png)

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2014-04-05T15:29:31.610

试试这个，计算比率，然后重新调整。

```
private Bitmap scaleBitmap(Bitmap bm) {
    int width = bm.getWidth();
    int height = bm.getHeight();

    Log.v("Pictures", "Width and height are " + width + "--" + height);

    if (width > height) {
        // landscape
        float ratio = (float) width / maxWidth;
        width = maxWidth;
        height = (int)(height / ratio);
    } else if (height > width) {
        // portrait
        float ratio = (float) height / maxHeight;
        height = maxHeight;
        width = (int)(width / ratio);
    } else {
        // square
        height = maxHeight;
        width = maxWidth;
    }

    Log.v("Pictures", "after scaling Width and height are " + width + "--" + height);

    bm = Bitmap.createScaledBitmap(bm, width, height, true);
    return bm;
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-02-06T13:32:18.103

Coen Damen 的回答并不总是尊重最大高度和最大宽度。这是一个答案：

```
 private static Bitmap resize(Bitmap image, int maxWidth, int maxHeight) {
    if (maxHeight > 0 && maxWidth > 0) {
        int width = image.getWidth();
        int height = image.getHeight();
        float ratioBitmap = (float) width / (float) height;
        float ratioMax = (float) maxWidth / (float) maxHeight;

        int finalWidth = maxWidth;
        int finalHeight = maxHeight;
        if (ratioMax > 1) {
            finalWidth = (int) ((float)maxHeight * ratioBitmap);
        } else {
            finalHeight = (int) ((float)maxWidth / ratioBitmap);
        }
        image = Bitmap.createScaledBitmap(image, finalWidth, finalHeight, true);
        return image;
    } else {
        return image;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-27T06:56:42.240

我在我的项目中多次偶然发现同样的问题，每次由于缺乏时间（和懒惰），我都会对一个不太理想的解决方案感到满意。但最近我找到了一些时间来解决这个特殊问题。这是我的解决方案，我希望它可以帮助某人。

```
Bitmap scaleDownLargeImageWithAspectRatio(Bitmap image)
            {
                int imageVerticalAspectRatio,imageHorizontalAspectRatio;
                float bestFitScalingFactor=0;
                float percesionValue=(float) 0.2;

                //getAspect Ratio of Image
                int imageHeight=(int) (Math.ceil((double) image.getHeight()/100)*100);
                int imageWidth=(int) (Math.ceil((double) image.getWidth()/100)*100);
                int GCD=BigInteger.valueOf(imageHeight).gcd(BigInteger.valueOf(imageWidth)).intValue();
                imageVerticalAspectRatio=imageHeight/GCD;
                imageHorizontalAspectRatio=imageWidth/GCD;
                Log.i("scaleDownLargeImageWIthAspectRatio","Image Dimensions(W:H): "+imageWidth+":"+imageHeight);
                Log.i("scaleDownLargeImageWIthAspectRatio","Image AspectRatio(W:H): "+imageHorizontalAspectRatio+":"+imageVerticalAspectRatio);

                //getContainer Dimensions
                int displayWidth = getWindowManager().getDefaultDisplay().getWidth();
                int displayHeight = getWindowManager().getDefaultDisplay().getHeight();
               //I wanted to show the image to fit the entire device, as a best case. So my ccontainer dimensions were displayWidth & displayHeight. For your case, you will need to fetch container dimensions at run time or you can pass static values to these two parameters 

                int leftMargin = 0;
                int rightMargin = 0;
                int topMargin = 0;
                int bottomMargin = 0;
                int containerWidth = displayWidth - (leftMargin + rightMargin);
                int containerHeight = displayHeight - (topMargin + bottomMargin);
                Log.i("scaleDownLargeImageWIthAspectRatio","Container dimensions(W:H): "+containerWidth+":"+containerHeight);

                //iterate to get bestFitScaleFactor per constraints
                while((imageHorizontalAspectRatio*bestFitScalingFactor <= containerWidth) && 
                        (imageVerticalAspectRatio*bestFitScalingFactor<= containerHeight))
                {
                    bestFitScalingFactor+=percesionValue;
                }

                //return bestFit bitmap
                int bestFitHeight=(int) (imageVerticalAspectRatio*bestFitScalingFactor);
                int bestFitWidth=(int) (imageHorizontalAspectRatio*bestFitScalingFactor);
                Log.i("scaleDownLargeImageWIthAspectRatio","bestFitScalingFactor: "+bestFitScalingFactor);
                Log.i("scaleDownLargeImageWIthAspectRatio","bestFitOutPutDimesions(W:H): "+bestFitWidth+":"+bestFitHeight);
                image=Bitmap.createScaledBitmap(image, bestFitWidth,bestFitHeight, true);

                //Position the bitmap centre of the container
                int leftPadding=(containerWidth-image.getWidth())/2;
                int topPadding=(containerHeight-image.getHeight())/2;
                Bitmap backDrop=Bitmap.createBitmap(containerWidth, containerHeight, Bitmap.Config.RGB_565);
                Canvas can = new Canvas(backDrop);
                can.drawBitmap(image, leftPadding, topPadding, null);

                return backDrop;
            } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T23:02:32.980

[https://developer.android.com/reference/android/graphics/Bitmap.html#createScaledBitmap(android.graphics.Bitmap, int, int, boolean)](https://developer.android.com/reference/android/graphics/Bitmap.html#createScaledBitmap%28android.graphics.Bitmap,%20int,%20int,%20boolean%29)

并确保`dstWidth`和`dstHeight`都是从`src.getWidth()*scale`和获得的`src.getHeight()*scale`，其中`scale`是您需要确定的值，以确保缩放的位图适合 512x128。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-20T09:59:12.303

我认为@Coen 的回答不是这个问题的正确解决方案。我也需要这样的方法，但我想对图像进行平方。

这是我的方形图像解决方案；

```
public static Bitmap resizeBitmapImageForFitSquare(Bitmap image, int maxResolution) {

    if (maxResolution <= 0)
        return image;

    int width = image.getWidth();
    int height = image.getHeight();
    float ratio = (width >= height) ? (float)maxResolution/width :(float)maxResolution/height;

    int finalWidth = (int) ((float)width * ratio);
    int finalHeight = (int) ((float)height * ratio);

    image = Bitmap.createScaledBitmap(image, finalWidth, finalHeight, true);

    if (image.getWidth() == image.getHeight())
        return image;
    else {
        //fit height and width
        int left = 0;
        int top = 0;

        if(image.getWidth() != maxResolution)
            left = (maxResolution - image.getWidth()) / 2;

        if(image.getHeight() != maxResolution)
            top = (maxResolution - image.getHeight()) / 2;

        Bitmap bitmap = Bitmap.createBitmap(maxResolution, maxResolution, Bitmap.Config.ARGB_8888);
        Canvas canvas = new Canvas(bitmap);
        canvas.drawBitmap(image, left, top, null);
        canvas.save();
        canvas.restore();

        return  bitmap;
    }
} 
```

# javascript - 从 Knockout 中的下拉列表选择中向表中添加行

> ID：15124184
> 
> 赞同：2
> 
> 时间：2013-02-27T22:58:31.390
> 
> 标签：javascript, html, knockout.js

我有一个简单的下拉列表，其中包含一些虚拟数据，每次我使用敲除从下拉列表中选择一个项目时，我想填充表格的一行。

但我有几个问题：

1.  不显示 optionValues 中的选项
2.  默认的 LaborReservations 未显示
3.  每次进行下拉选择时，我都不确定如何添加一行

我遵循了淘汰页面上的一些示例，但看不到如何使用下拉菜单执行我想要的操作。

HTML：

```
<h2>Add Labor to table</h2>
<select data-bind="options: optionValues"></select>
<br><br><br>   
<table>
    <thead><tr>
    <th>Labor name</th><th></th>
    </tr></thead>
    <tbody data-bind="foreach: labors">
        <tr>
            <td data-bind="text: name"></td>
        </tr> 
     </tbody>
</table> 
```

JavaScript：

```
// Class to represent a row in the labors grid
function LaborReservation(name) {
    var self = this;
    self.name = ko.observable(name);
}

// Overall viewmodel for this screen, along with initial state
function LaborsViewModel() {
    var self = this;
    var viewModel = { optionValues: ["Test Labor Row 1", "Test Labor Row 2", "Test Labor Row 3"]};
    self.availableLabors = [{
        "LaborName": "Test Labor 1"
        },
        {
        "LaborName": "Test Labor 2"
        },
        {
        "LaborName": "Test Labor 3"
    }];

    // Editable data
    self.labors = ko.observableArray([
        new LaborReservation("Labor Item 1"),
        new LaborReservation("Labor Item 2")
    ]);

    self.addLabors = function() {
        self.labors.push(new LaborReservation(//want to add selected dropdown item
        ));
}

ko.applyBindings(new LaborsViewModel()); 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:13:34.770

您需要将您的选择绑定到某个值，并订阅它以添加到您的表中。例如：

```
self.newValue = ko.observable();
self.newValue.subscribe(function(value) {
    self.labors.push(new LaborReservation(value));
}) 
```

这个示例完成了您作为开始所要求的大部分内容：

[http://jsfiddle.net/NzTSU/3/](http://jsfiddle.net/NzTSU/3/)

# wcf-data-services - 是否提供数据服务 支持 Upsert（插入或替换）

> ID：15124186
> 
> 赞同：2
> 
> 时间：2013-02-27T22:58:49.627
> 
> 标签：wcf-data-services

据我了解，基于 OData 的服务支持“upsert”（即，插入一行，或者如果具有此键的行已经存在则更新它）的常用方法是通过包含行过滤器的 PUT 请求和分区键。

```
http://myaccount.table.core.windows.net/mytable(PartitionKey='myPartitionKey', RowKey='myRowKey1') 
```

据我所知，这就是 Azure 表存储支持 upsert 的方式。但据我所知，如果您在使用 .NET Framework 的内置实现的 OData 服务上尝试相同的操作`DataService<T>`，则只有在该行已经存在时才会成功。如果该行不存在，我会收到 404 错误。

换句话说，这仅适用于更新，不适用于插入。

我怀疑 upsert 根本不受支持，但无法找到明确的答案。谁能告诉我该怎么做，或者确认我绝对不能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T10:27:30.623

您可以尝试创建自己的自定义查询提供程序（IDataServiceQueryProvider 的实现）。如果用户正在请求一个不存在的对象并且当前 http 请求的方法是 PUT，则返回一个具有给定 id 的新对象。我*认为*内置的更新提供者应该能够从那里处理它并更新记录。否则，您可能还需要自己的更新提供程序。

使用[WCF 数据服务工具包](http://wcfdstoolkit.codeplex.com/)可能会使您的工作更轻松。否则，您将不得不编写自己的 linq 提供程序，这对于集成测试来说听起来有点矫枉过正。

[这](http://blogs.msdn.com/b/alexj/archive/2010/01/07/data-service-providers-getting-started.aspx)是 msdn 上很好的系列博客文章，描述了如何构建自定义 ds 提供程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T10:53:53.023

好的，我已经尝试了 Jason Freitas 的建议，结果太复杂而无法在评论中解决，所以我添加了一个答案。

tl; dr：您可以做到这一点，尽管解决方案围绕`IDataServiceUpdateProvider`and展开`IUpdatable`。（Jason 建议`IDataServiceQueryProvider`，这似乎没有帮助。）但是，问题在于`DataService<T>`它并不是真正设计为支持 upsert，也不是用于更新的接口，所以虽然你可以让它工作，但解决方案是hack（而且不是很好），我怀疑将来可能会导致问题。

长版：

我已经在实现`IUpdatable`，这是支持更新、插入和删除所需的。`IDataServiceQueryProvider`不添加任何与更新支持相关的内容，因此`IUpdatable`是关键。我最初错误地认为`IUpdatable.GetResource`即使请求的项目不存在也安排返回项目会弄乱查询行为。但是当然，针对的查询`DataService<T>`不会通过`IUpdatable`，因此无论请求什么，都可以让该方法返回一个对象。

这样做非常复杂，而且事实证明这还不够。这是代码：

```
public object GetResource(IQueryable query, string fullTypeName)
{
    var item = query.Cast<object>().SingleOrDefault();
    if (item == null && fullTypeName != null)
    {
        var ctor = Type.GetType(fullTypeName).GetConstructor(Type.EmptyTypes);
        if (ctor != null)
        {
            item = ctor.Invoke(null);
            PopulatePutStandin(query.Expression, item);
        }
    }

    return item;
}

private void PopulatePutStandin(Expression expression, object item)
{
    var call = expression as MethodCallExpression;
    if (call != null && call.Method.Name == "Where" && call.Method.DeclaringType == typeof(Queryable))
    {
        foreach (Expression arg in call.Arguments)
        {
            var ux = arg as UnaryExpression;
            if (ux != null)
            {
                var op = ux.Operand as LambdaExpression;
                if (op != null)
                {
                    var bx = op.Body as BinaryExpression;
                    if (bx != null && bx.Method.Name == "op_Equality")
                    {
                        var left = bx.Left as MemberExpression;
                        var right = bx.Right as ConstantExpression;
                        if (left != null && right != null)
                        {
                            var prop = left.Member as PropertyInfo;
                            if (prop != null)
                            {
                                prop.SetValue(item, right.Value);
                            }
                        }
                    }
                }
            }
            else
            {
                PopulatePutStandin(arg, item);
            }
        }
    }
} 
```

该`GetResource`方法是`IUpdatable`接口的一部分，`DataService<T>`当它接收到 PUT 时，它是用来尝试查找现有资源的方法。如您所见，如果对象还不存在，它只是构造一个新实例。然而，仅仅让新对象保持默认状态是不够的。`PartitionKey`和`RowKey`必须匹配传入 PUT 请求的值。而且您不会直接被告知这些值 - 它们嵌入在查询中。

因此，我编写了该`PopulatePutStandin`方法以将这些值从查询中提取出来。它遍历表示查询的调用表达式链，查找`Where`调用。（这不处理任何其他 LINQ 运算符，但对于更新/插入，您不应该看到任何更复杂的东西。）对于每个`Where`测试特定属性是否具有特定值的子句，我的代码将该属性设置为新对象的值。在实践中，这将最终只设置`PartitionKey`and`RowKey`因为这些是唯一`Where`存在于 upsert 的子句，但是编写不查找任何特定属性的代码更容易。

这有点不稳定，因为它假设每个属性都将通过自己的`Where`子句处理。理论上，没有什么可以停止`DataService<T>`使用一个`Where`包含对`PartitionKey`and的单个表达式测试的子句`RowKey`。所以理论上它可以使用：

```
src.Where(e => e.PartitionKey == "123").Where(e => e.RowKey == "456") 
```

或者

```
src.Where(e => e.PartitionKey == "123" && e.RowKey == "456") 
```

两者应该具有相同的效果。它碰巧使用了前者，我的代码依赖于它，但我没有找到任何`DataService<T>`承诺以任何特定形式提供查询的文档。所以我们对`DataService<T>`. 一个更健壮的实现会想要处理任何一种形式，尽管这感觉很麻烦——理论上我们可以被问到很多方法。目前尚不清楚是否有一种完全通用且安全的方法来制作与我们可能在此处收到的任何查询匹配的新对象。

但是，这是在测试中运行的代码，所以我们会在开发时检测到这种问题，所以我想这是可以接受的。

然而，尽管这使我们能够为 PUT 生成合适的目标，但事实证明这还不够。我们得到`DataServiceException`以下错误：

> 由于实体类型“Mm.Web.Tests.Fakes.AzureTableStorage.FakeUserPermission”具有一个或多个 etag 属性，因此必须为该类型的 DELETE/PUT 操作指定 If-Match HTTP 标头。

内部`DataService<T>`已经决定 PUT 请求必须包含一个 ETag 如果它有任何意义，因为你将如何确定你正在编辑你要编辑的实体？这对于更新是有意义的，但对于插入显然没有意义。所以这对upsert不友好。

我尝试在客户端包含一个 etag：

```
var permission = new TableEntity(userId, claimId) { ETag = "*" };
await _myTable.ExecuteAsync(TableOperation.InsertOrReplace(permission)); 
```

但是，Azure 表存储客户端显然足够聪明，知道 etag 对 upsert 没有意义。（如果你知道 etag，你知道这绝对是一个更新，所以你不应该使用 upsert。）所以它实际上并没有传递那个 ETag。

但是，您可以解决此问题。`IUpdatable`您可以实现，而不仅仅是实现`IDataServiceUpdateProvider`，它派生自`IUpdatable`并添加一个成员：

```
public void SetConcurrencyValues(
    object resourceCookie,
    bool? checkForEquality,
    IEnumerable<KeyValuePair<string, object>> concurrencyValues)
{
} 
```

如果你实现了这个接口，你基本上就是在告诉`DataService<T>`你想自己处理 ETags。因为我很高兴没有 ETag，所以什么也不做也没关系。只需提供此接口的空实现即可禁用默认的 ETag 处理，并且我们不再遇到异常。所以它似乎有点工作。

一个问题是，在您生成假替身时，没有明确的方法来区分 PUT 或 DELETE。`GetResource`没有被告知手术是什么。或者至少，不是直接的。碰巧的是，我发现该`fullTypeName`论点恰好是`null`针对 DELETE 的，但文档并没有承诺这一点。所以我觉得我在依赖一个无证的巧合。

而这反过来又像是一个潜在问题的症状：这里涉及的接口并不是为了支持 upsert 而设计的。因此，尽管有可能让它类似于“工作”的东西，但它总是会有点令人不满意。

所以我怀疑唯一令人满意的解决方案是在 HTTP 级别伪造它，因为这是支持我试图伪造的语义的唯一方法。

# exception - bean 实例化失败；嵌套异常是 java.lang.NoClassDefFoundError: org/apache/log4j/Logger

> ID：15124192
> 
> 赞同：1
> 
> 时间：2013-02-27T22:59:41.213
> 
> 标签：exception, maven, classnotfoundexception, apache-commons-logging

我正在尝试让公共日志记录为 log4j 配置工作，但在启动服务器时我不断收到异常。尝试使用可通过另一个公共库获得的 StringUtils 时，我也遇到了类似的异常。

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'listPlacesBean' defined in ServletContext resource [/WEB-INF/web-applicationContext.xml]: Instantiation of bean failed; nested exception is java.lang.NoClassDefFoundError: org/apache/log4j/Logger
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:997)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:943)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:609)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.NoClassDefFoundError: org/apache/log4j/Logger
    at com.sample.managedbean.common.ListPlacesBean.<clinit>(ListPlacesBean.java:19)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147)
    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:76)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:990)
    ... 23 more
Caused by: java.lang.ClassNotFoundException: org.apache.log4j.Logger
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1714)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)
    ... 31 more
Feb 27, 2013 5:50:51 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'listPlacesBean' defined in ServletContext resource [/WEB-INF/web-applicationContext.xml]: Instantiation of bean failed; nested exception is java.lang.NoClassDefFoundError: org/apache/log4j/Logger
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:997)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:943)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:609)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.NoClassDefFoundError: org/apache/log4j/Logger
    at com.sample.managedbean.common.ListPlacesBean.<clinit>(ListPlacesBean.java:19)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147)
    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:76)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:990)
    ... 23 more
Caused by: java.lang.ClassNotFoundException: org.apache.log4j.Logger
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1714)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)
    ... 31 more 
```

pom依赖：

```
<dependencies>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>3.8.1</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-lang3</artifactId>
            <version>3.1</version>
        </dependency>
        <dependency>
            <groupId>commons-io</groupId>
            <artifactId>commons-io</artifactId>
            <version>2.4</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.1.13</version>
        </dependency>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>2.1.13</version>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
        </dependency>
        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>jsp-api</artifactId>
            <version>2.1</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-tx</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aop</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.21</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>4.1.7.Final</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>1.6.6</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-ehcache</artifactId>
            <version>4.1.7.Final</version>
        </dependency>
        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib</artifactId>
            <version>2.2.2</version>
        </dependency>
        <dependency>
            <groupId>commons-logging</groupId>
            <artifactId>commons-logging</artifactId>
            <version>1.1.1</version>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.17</version>
        </dependency>
        <dependency>
            <groupId>org.primefaces</groupId>
            <artifactId>primefaces</artifactId>
            <version>3.4.2</version>
        </dependency>
    </dependencies> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T01:15:26.730

尝试包括`org.slf4j:slf4j-log4j12`依赖。我认为它需要这种依赖作为桥梁

# rspec - 如何创建一个仅运行已更改的测试文件的 Guard 配置监视？

> ID：15124193
> 
> 赞同：2
> 
> 时间：2013-02-27T22:59:42.123
> 
> 标签：rspec, guard

没有太多关于如何在线执行此操作的信息，但在我的 Guardfile 中，我正在`watch`为我希望 Guard 监视更改的各种目录/文件进行设置。您如何为`spec/test`已更新的已更改文件指定监视并仅在发生这种情况时运行该特定文件？谢谢！

```
guard 'rspec' do
  watch(%r|^spec/.+_spec\.rb$|)               { "spec" }
end 
```

当前，当`spec`目录下的文件发生更改时，上面会运行所有规范/测试。但我只希望运行更改后的测试文件的测试。

当前`spec`目录树：

```
spec
 -models
  -user_spec.rb
  -classroom_spec.rb
 -controllers
  -classroom_spec.rb
 -lib
  -support_spec.rb 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T10:40:42.113

Guard RSpec 插件有一个演示 Guardfile，您可以使用它创建

```
$ bundle exec guard init rspec 
```

内容如下：

```
# A sample Guardfile
# More info at https://github.com/guard/guard#readme

guard 'rspec' do
  watch(%r{^spec/.+_spec\.rb$})
  watch(%r{^lib/(.+)\.rb$})     { |m| "spec/lib/#{m[1]}_spec.rb" }
  watch('spec/spec_helper.rb')  { "spec" }

  # Rails example
  watch(%r{^app/(.+)\.rb$})                           { |m| "spec/#{m[1]}_spec.rb" }
  watch(%r{^app/(.*)(\.erb|\.haml)$})                 { |m| "spec/#{m[1]}#{m[2]}_spec.rb" }
  watch(%r{^app/controllers/(.+)_(controller)\.rb$})  { |m| ["spec/routing/#{m[1]}_routing_spec.rb", "spec/#{m[2]}s/#{m[1]}_#{m[2]}_spec.rb", "spec/acceptance/#{m[1]}_spec.rb"] }
  watch(%r{^spec/support/(.+)\.rb$})                  { "spec" }
  watch('config/routes.rb')                           { "spec/routing" }
  watch('app/controllers/application_controller.rb')  { "spec/controllers" }

  # Capybara features specs
  watch(%r{^app/views/(.+)/.*\.(erb|haml)$})          { |m| "spec/features/#{m[1]}_spec.rb" }

  # Turnip features and steps
  watch(%r{^spec/acceptance/(.+)\.feature$})
  watch(%r{^spec/acceptance/steps/(.+)_steps\.rb$})   { |m| Dir[File.join("**/#{m[1]}.feature")][0] || 'spec/acceptance' }
end 
```

我建议坚持这一点，因为它包含许多文件/文件夹命名和触发相关规范的最佳实践。

要回答您的问题，如果您省略 watch 表达式的块，Guard 会使用发生更改的确切文件：

```
guard 'rspec' do
  watch(%r|^spec/.+_spec\.rb$|)
end 
```

这将为 spec 文件夹中以`_spec.rb`.

监视表达式的块用于将文件名转换为其他内容，黑色的参数是正则表达式的匹配，因此您可以为其添加一些特殊逻辑。演示这一点的简短示例：

```
watch(%r{^lib/(.+)\.rb$})     { |m| "spec/lib/#{m[1]}_spec.rb" } 
```

文件更改`lib/file.rb`将触发插件，并且该块将该文件名转换为`spec/lib/file_spec.rb`，因为`m[1]`包含来自 RegExp 的匹配组，即`file`.

# sql - 如何获取每个摘要都依赖于另一列的摘要行？

> ID：15124197
> 
> 赞同：0
> 
> 时间：2013-02-27T22:59:57.490
> 
> 标签：sql, oracle11g, analytics, summary

**Oracle11g**

如何获得每对行满足最小总和的汇总行？当我指定时`where total_lot > N`，我排除了我想要保留的行。

我想回答这个数据问题：哪些 id 的 KEYS 的总手数大于 6 **，**而 LOCK 的总手数大于 4？

```
with inventory_items as
(
  select 1 as item_id, 'KEYS' as code, '1020' as sub_code, 4 as lot_size from dual     union all
  select 1 as item_id, 'KEYS' as code, '2210' as sub_code, 4 as lot_size from dual  union all
  select 1 as item_id, 'LOCK' as code, '1610' as sub_code, 3 as lot_size from dual  union all
  select 1 as item_id, 'LOCK' as code, '1031' as sub_code, 2 as lot_size from dual  union all
  select 2 as item_id, 'KEYS' as code, '1020' as sub_code, 2 as lot_size from dual  union all
  select 2 as item_id, 'KEYS' as code, '2210' as sub_code, 1 as lot_size from dual  union all
  select 2 as item_id, 'LOCK' as code, '1610' as sub_code, 1 as lot_size from dual  union all
  select 2 as item_id, 'LOCK' as code, '1031' as sub_code, 3 as lot_size from dual  union all
  select 3 as item_id, 'KEYS' as code, '1031' as sub_code, 8 as lot_size from dual 
  )
  select distinct item_id, code, 
         sum(lot_size) over (partition by item_id, code) as total_lot
  from inventory_items
  order by item_id, code 
```

**期望的结果**

1.  ID有LOCK和
2.  ID 有 KEYS 和
3.  KEYS 的 Total_lot 大于 6 并且
4.  LOCK 的 Total_lot 大于 4

输出：

```
 ITEM_ID   CODE   TOTAL_LOT
 -----     -----  --------
 1         KEYS   8
 1         LOCK   5 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:20:00.707

你在寻找这样的东西吗？

```
select item_id, code, sum(lot_size)
from inventory_items ii
group by item_id, code
having sum(lot_size) > (case when code = 'KEYS' then 6
                             when code = 'LOCK' then 4
                        end) 
```

顺便说一句，您的示例代码中的查询是一种非常繁琐的`group by`.

在回应您的评论时，假设您的意思是两者的*手数总和*：

```
select item_id, sum(lot_size)
from inventory_items ii
group by item_id
having sum(case when code = 'KEYS' then lot_size else 0 end) > 6 and
       sum(case when code = 'LOCK' then lot_size else 0 end) > 4 
```

如果您的意思是任何手数都大于一个值，那么在子句中使用`max()`而不是。`sum()``having`

包含代码的最简单方法是将原始数据连接回此。这是一种表达方式：

```
select *
from inventory_items ii
where ii.item_id in (select item_id, sum(lot_size)
                     from inventory_items ii
                      group by item_id
                      having sum(case when code = 'KEYS' then lot_size else 0 end) > 6 and
                             sum(case when code = 'LOCK' then lot_size else 0 end) > 4
                    ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T14:27:25.033

这是一个解决方案。

**解释**

使用 Gordon 的查询选择所有满足数量要求的 item_id。此查询返回 ID=3，因为总 KEYS > 6。

```
select item_id, 
       code, 
       sum(lot_size) total_lot
from inventory_items 
group by item_id, code
having sum(lot_size) > (case 
                         when code = 'KEYS' then 6
                         when code = 'LOCK' then 4
                        end) 
```

**输出**

```
ITEM_ID  CODE  TOTAL_LOT
------------------------
 1       KEYS  8
 1       LOCK  5
 3       KEYS  8 
```

现在，您需要排除 ID=3，因为您的要求是只包括那些同时具有 KEYS 和 LOCK 的 ID。也就是说，您希望每个 item_id 恰好返回两行。所以取上一个查询并添加一个计算 item_id 数量的列。

```
select item_id,
       code,
       total_lot,
       count(*) over (partition by item_id) as item_count
from (
select item_id, 
       code, 
       sum(lot_size) total_lot
from inventory_items 
group by item_id, code
having sum(lot_size) > (case 
                         when code = 'KEYS' then 6
                         when code = 'LOCK' then 4
                        end)
 ) 
```

**输出**

```
ITEM_ID CODE  TOTAL_LOT ITEM_COUNT
------- ---- ---------- ----------
1       KEYS      8          2
1       LOCK      5          2
3       KEYS      8          1 
```

这为您提供了一个用于过滤行数的列，但要使用它，您需要再次嵌套。

```
select item_id, 
       code,
       total_lot
from (
 select item_id,
       code,
       total_lot,
       count(*) over (partition by item_id) as item_count
from (
select item_id, 
       code, 
       sum(lot_size) total_lot
from inventory_items 
group by item_id, code
having sum(lot_size) > (case 
                         when code = 'KEYS' then 6
                         when code = 'LOCK' then 4
                        end)
 ) 
) where item_count=2 
```

**输出**

```
 ITEM_ID  CODE  TOTAL_LOT
 ------------------------
 1       KEYS  8
 1       LOCK  5 
```

# ruby-on-rails - XMPP (xmpp4r) 中的 Ruby 线程死锁

> ID：15124200
> 
> 赞同：2
> 
> 时间：2013-02-27T23:00:04.060
> 
> 标签：ruby-on-rails, ruby, xmpp, google-talk, xmpp4r

我正在实现一个 Google Talk 侦听器，它会向我更新我所有联系人列表项的存在情况。

```
require 'xmpp4r'
require 'xmpp4r/roster'
require 'xmpp4r/roster/helper/roster'

sender_jid = Jabber::JID.new('email')
client = Jabber::Client.new(sender_jid)
client.connect('talk.google.com')
client.auth('password')

client.send(Jabber::Presence.new.set_type(':available'))

#Presence updates:
client.add_presence_callback do |pres|
  puts pres.from.to_s.split("/")[0] unless pres.nil?
  puts pres.show.to_s.inspect unless pres.nil?
end

Thread.stop
client.close 
```

代码工作正常，线程继续在一个 gmail 帐户上收听，但在出现几个联系人后给了我这个错误：

```
client.rb:33:in `stop': deadlock detected (fatal)
    from client.rb:33:in `<main>' 
```

出现此错误的另一个帐户有更多具有不同状态的联系人。似乎无法弄清楚为什么会这样。任何帮助都会很棒。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T16:53:25.217

通过记录器解决了问题。它抛出了一个死锁，因为有一个解析错误。我与无法解析的字符有某些联系。

似乎 xmpp4r 有一段时间没有更新了，我的解决方案是转移到一些人已经更新的 repo。

如果有人遇到类似问题，请查看： [https ://github.com/whitehat101/xmpp4r](https://github.com/whitehat101/xmpp4r)

解析是通过 nokogiri 完成的。

更新：有一群新的维护者已经分叉了上面的许多更新+修复了其他问题： [https ://github.com/xmpp4r/xmpp4r](https://github.com/xmpp4r/xmpp4r)

# javascript - 尝试使用 Node.js 动态设置循环中的页面

> ID：15124202
> 
> 赞同：2
> 
> 时间：2013-02-27T23:00:16.220
> 
> 标签：javascript, node.js, express, for-in-loop, serving

我正在尝试做一些简单的事情（我希望）：从数据库接收 JSON 并循环通过它以在 Node.js 中创建所有必要的页面路由。截至目前，我只是使用存根数据，但 console.log 始终显示键值对中的最后一个值“联系人”。第一个控制台正确显示所有内容。

这是我的代码：

```
routes = {
"Home" : "index.html",
"about" : "about.html",
"How it Works" : "how_it_works.html",
"contribute" : "contribute.html",
"contact" : "contact.html"
};

function routesGetandSet(data) {
  for (key in data) {
    console.log(key + "---" + '/' + data[key]);
    app.get('/' + data[key], function(req, res) {
      console.log(data[key]);
    });
  }
}

routesGetandSet(routes); 
```

我认为这将是在 Node 中动态创建页面路由的最简单方法（最终我会将数据绑定到其中），但我可能错了。

谁能指出我正确的方向？我正在使用 express 框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:04:31.250

问题是`key`闭包中的值对于所有路由都是相同的（最后一次迭代中的值）。

这应该有助于解释如何创建一个新的闭包，每个闭包都有一个单独的值： [http ://www.mennovanslooten.nl/blog/post/62](http://www.mennovanslooten.nl/blog/post/62)

这样的事情应该会有所帮助：

```
for (key in data) {
  console.log(key + "---" + '/' + data[key]);
  (function(key1) {
    app.get('/' + data[key1], function(req, res) {
       console.log(data[key1]);
    });
   }
  )(key);
} 
```

在上面的代码中，`key1`在单独的闭包中为每次迭代保留不同的值。

# git - 使用 git 更新自身

> ID：15124205
> 
> 赞同：4
> 
> 时间：2013-02-27T23:00:34.400
> 
> 标签：git, ubuntu, updates

我在 git 下载页面[http://git-scm.com/downloads](http://git-scm.com/downloads) [在许多其他教程页面中] 上看到您可以通过自身更新 git。目前我的桌面有 git 1.7.9.5，最新的是 1.8.1.3

我正在运行 Ubuntu 12.04 LTS 并在主目录中运行这些命令 [~/]

我运行了以下命令并得到了以下输出：

```
~$ git version
git version 1.7.9.5
~$ git clone https://github.com/git/git.git
Cloning into 'git'...
remote: Counting objects: 149633, done.
remote: Compressing objects: 100% (49646/49646), done.
remote: Total 149633 (delta 109386), reused 136311 (delta 98050)
Receiving objects: 100% (149633/149633), 34.92 MiB | 864 KiB/s, done.
Resolving deltas: 100% (109386/109386), done.
~$ git version
git version 1.7.9.5 
```

最终结果是 git 版本是一样的。唯一的区别是现在我的主目录中有一个名为 git 的文件夹，我只能假设是组成该软件的文件。我显然遗漏了几个步骤，我已经在 Google 和 YouTube 上搜索过，以找到演练或某种进一步的解释，而不是“你可以通过 git 获取 git，只需键入此命令”。

如果之前已经回答过这个问题，我深表歉意。如果有人知道我在哪里可以找到缺少的步骤，我将非常感谢链接/解释。

我也很抱歉，这似乎是一件我自己无法弄清楚的极其简单的事情。

最后，我非常感谢所有帮助我找到答案的人！

编辑 3.18.13：所以当我本周得到一台新笔记本电脑时，我最终不得不再次这样做；多亏了你们，我才能跑`git --version`回来`git version 1.8.2`

我按照 git book 中的说明进行操作，感谢[iltempo](https://stackoverflow.com/users/428260/iltempo)：

然后，编译并安装：

```
$ tar -zxf git-1.7.2.2.tar.gz
$ cd git-1.7.2.2
$ make prefix=/usr/local all
$ sudo make prefix=/usr/local install 
```

除了我从 github 获得了一个 zip 文件，所以我将其解压缩。我没有做任何其他步骤...

这是/是我第一次从源代码构建东西，所以我不太确定下面提到的一些术语是什么意思：

'确保`/usr/local/bin`在你的路径之前' - [iltempo](https://stackoverflow.com/users/428260/iltempo)

我看到[了如何将目录添加到我的路径](https://askubuntu.com/questions/60218/how-to-add-a-directory-to-my-path/60221#60221)，但我不明白这个的含义或当我这样做时发生了什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T09:13:03.680

“使用 git 更新 git”意味着在克隆[https://github.com/git/git](https://github.com/git/git)后使用更新 git repo*源*。`git pull`

您仍然需要从上述来源*构建*git，并在看到`git --version`命令的差异之前安装它。

查看“ [`INSTALL`](https://github.com/git/git/blob/master/INSTALL)”文件：

```
$ make prefix=/usr/local all doc info ;# as yourself
# make prefix=/usr/local install install-doc install-html install-info ;# as root 
```

由于您要在 /usr/local/bin 中安装更新的 git，因此请确保该路径位于您自己的`$PATH`环境变量中（您可以在您的环境变量中[设置`.profile`](https://askubuntu.com/a/60221/5470)）

* * *

另一种方法是使用 apt-install（请参阅“[如何在 Ubuntu Hardy 上升级 Git？](https://superuser.com/questions/56134/how-to-upgrade-git-on-ubuntu-hardy) ”），但是当我[查找包 git-core](http://packages.ubuntu.com/search?keywords=git-core&searchon=names&suite=all&section=all)时，[Precise 包](http://packages.ubuntu.com/precise/git-core)只升级到 git_1.7.9.5。
这就是为什么从源代码构建可以替代等待 git-core 更新的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T02:10:07.513

`git`使用标准的 GNU 自动工具设置，请参阅`INSTALL`源文件中的文件。然后你就可以跳标准`./configure; make; make install`舞了。

对于我个人使用，我使用 进行设置`prefix=$HOME`，并`alias git=~/bin/git`在我的 中添加一个`.bashrc`，所以`PATH`这不是问题。

# haskell - 使用向量来操作字符而不是列表

> ID：15124206
> 
> 赞同：1
> 
> 时间：2013-02-27T23:00:36.707
> 
> 标签：haskell

我有一些可以编译和工作的代码。然后一些没有。我担心的是第一个版本太臃肿以至于在运行太大的参数时崩溃了，所以我写了第二个版本时考虑到了性能。第二个版本甚至没有编译。请指教。

```
import System.Environment   (getArgs)
import Data.List            (nub)
import System.Random
import Control.Applicative  ( (<$>) )
import Control.Monad        (replicateM)

randomItem :: [a] -> IO a
randomItem xs = (xs!!)  <$> randomRIO (0, length xs - 1)

genFromMask :: [String] -> IO String
genFromMask = mapM randomItem

genMeSome :: [String] -> Int -> IO [String]
genMeSome mask n = do
  glist <- replicateM (n*10) (genFromMask mask)
  return $ take n $ nub glist

writeIt ::  FilePath -> Int -> [String] -> IO ()
writeIt fi n mask = do
    glist <- genMeSome mask n
   writeFile fi $ unlines glist

maj :: String
maj = ['A'..'Z']

numa :: String
numa = ['0'..'9']

-- | Certaines regions n'utilisent aucune des plages libres
genBra :: [String]
genBra = ["VWXYZ",maj,maj," ",numa,numa,numa,numa]

genAus :: [String]
genAus = [maj,maj,maj," ",numa,numa,numa]

main :: IO ()
main = do
  args <- getArgs
  case args of
    (mo:fi:n:_) -> case mo of
      "aus" -> writeIt fi (read n) genAus
      "bra" -> writeIt fi (read n) genBra
      _     -> error "country is not supported"
    _           -> error "wrong input, format is: genLicensePlate country file number" 
```

这是第二个：

```
import System.Environment   (getArgs)
import System.Random
import Crypto.Random.AESCtr (makeSystem)
import Control.Applicative  ( (<$>) )
import qualified Data.Vector  as V
import qualified Data.Text    as T
import qualified Data.Text.IO as T

nubV :: V.Vector a -> V.Vector a
nubV va
  | V.null va              = V.empty
  | V.any (== headV) tailV = nubV tailV
  | otherwise              = headV `V.cons` nubV tailV
 where
  headV = V.head va
  tailV = V.tail va

randomItem :: RandomGen g => g -> V.Vector a -> (a,g)
randomItem g xs =
  (xs V.! fst shamble, snd shamble)
 where
  shamble = randomR (0, V.length xs - 1) g

genFromMask :: RandomGen g => g -> V.Vector (V.Vector a) -> V.Vector a
genFromMask g xs =
  if V.null xs
     then V.empty
     else fst paket `V.cons` genFromMask (snd paket) (V.tail xs)
 where
  paket = randomItem g (V.head xs)

genMeSome :: RandomGen g => g -> V.Vector (V.Vector a) -> Int -> V.Vector (V.Vector a)
genMeSome g mask n =
  V.take n $ nubV $ V.replicateM (n*10) (genFromMask g mask)

writeIt :: RandomGen g => g -> FilePath -> Int -> V.Vector (V.Vector a) -> IO ()
writeIt g fi n mask =
   T.writeFile fi $ T.unlines $ T.pack $ V.toList (V.map V.toList $ genMeSome g mask n)

maj   = V.fromList ['A'..'Z']
num a = V.fromList ['0'..'9']
vspa  = V.fromList " "
vtir  = V.fromList "-"

-- | Certaines regions n'utilisent aucune des plages libres
genBra = V.fromList [static,maj,maj,vspa,numa,numa,numa,numa]
 where
  static = V.fromList "VWXYZ"

genAus = V.fromList [maj,maj,maj,vspa,numa,numa,numa]

main :: IO ()
main = do
  g    <- makeSystem
  args <- getArgs
  case args of
    (mo:fi:n:_) -> case mo of
      "aus" -> writeIt g fi (read n) genAus
      "bra" -> writeIt g fi (read n) genBra
      _     -> error "country is not supported"
    _           -> error "wrong input, format is: genLicensePlate country file number" 
```

我正在尝试生成假车牌，以填充匿名数据库。

编辑1：

以下是错误：

```
genLicensePlate.hs:22:12:
    No instance for (Eq a)
      arising from a use of `=='
    In the first argument of `V.any', namely `(== headV)
    In the expression: V.any (== headV) tailV
    In a stmt of a pattern guard for
               an equation for `nubV':
      V.any (== headV) tailV

genLicensePlate.hs:48:52:
    Couldn't match expected type `Char' with actual type
    Expected type: V.Vector Char
      Actual type: V.Vector [a]
    In the first argument of `V.toList', namely
      `(V.map V.toList $ genMeSome g mask n)'
    In the second argument of `($)', namely
      `V.toList (V.map V.toList $ genMeSome g mask n)' 
```

编辑2：

所以总体思路是使用掩码生成随机字符串。像 myFunc g [['A'..'Z'],['A'..'Z']] 给出 AA 或 ZZ 或 BA 或 FG 等......然后我使用这个函数来制作很多这些字符串基于掩码。之后，我删除重复项并根据需要获取尽可能多的数量（因为即使有重复项我也可以生成 10 倍于所要求的数字）。最后我把它放在一个文件上。

我希望它更清楚。

亲切的问候，萨尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:29:09.623

`nubV`需要一个`Eq`约束，因为它比较元素（但你真的应该使用一个`Set`或`HashSet`左右来获得更好的算法）

```
nubV :: Eq a => V.Vector a -> V.Vector a
nubV va
  | V.null va              = V.empty
  | V.any (== headV) tailV = nubV tailV
  | otherwise              = headV `V.cons` nubV tailV
 where
  headV = V.head va
  tailV = V.tail va 
```

而在`writeIt`，你缺少一个`map`，

```
writeIt :: RandomGen g => g -> FilePath -> Int -> V.Vector (V.Vector a) -> IO ()
writeIt g fi n mask =
   T.writeFile fi $ T.unlines $ map T.pack $ V.toList (V.map V.toList $ genMeSome g mask n)
                            --  ^^^ 
```

`Char`因为您获得了from的列表列表`V.toList (V.map V.toList $ genMeSome g mask n)`。

这修复了两个报告的错误。

# android - Android - OnItemClickListener 不会在适配器视图中捕获事件点击

> ID：15124207
> 
> 赞同：1
> 
> 时间：2013-02-27T23:00:37.953
> 
> 标签：android, checkbox, imageview, onitemclicklistener

我有一个有 AdapterView 的活动来显示 ImageView 的网格视图

活动：

```
package com.xlck.mislistas

import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;

import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.SherlockActivity;
import com.xlck.mislistas.adapters.ExpandableHeightGridView;
import com.xlck.mislistas.adapters.ImageGridAdapter;
import com.xlck.mislistas.adapters.ImageGridAdapter.ViewHolder;
import com.xlck.mislistas.adapters.ImageGridBean;

public class AmigosActivity extends SherlockActivity {
...

    private ExpandableHeightGridView gridViewImagenes;
        gridViewImagenes = (ExpandableHeightGridView) findViewById(R.id.grvImagenes);

    // Adapter GridView
    gridViewImagenes.setAdapter(imageGridAdapter);
    gridViewImagenes.setExpanded(true);
    .
    .
    .

    // Listener
    gridViewImagenes.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
            Do something ...;
        }
    });
} 
```

适配器：

```
package com.xlck.mislistas.adapters;

import java.util.ArrayList;
import java.util.List;

import android.app.Activity;
import android.content.Context;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.CheckBox;
import android.widget.ImageView;
import android.widget.TextView;

import com.xlck.mislistas.R;

public class ImageGridAdapter extends BaseAdapter {

private Context mContext;

private List<ImageGridBean> items;

// Constructor
public ImageGridAdapter(Context context, ArrayList<ImageGridBean> items) {
    this.mContext = context;
    this.items = items;
}

@Override
public int getCount() {
    return items.size();
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder = null;
    ImageGridBean item = (ImageGridBean) items.get(position);

    LayoutInflater mInflater = (LayoutInflater) mContext
            .getSystemService(Activity.LAYOUT_INFLATER_SERVICE);
    if (convertView == null) {
        convertView = mInflater.inflate(R.layout.item_grid_imagen, null);
        holder = new ViewHolder();
        holder.txtId = (TextView) convertView.findViewById(R.id.uid);
        holder.txtNombre = (TextView) convertView
                .findViewById(R.id.txtNombre);
        holder.imagen = (ImageView) convertView
                .findViewById(R.id.imgImagen);

        holder.check = (CheckBox) convertView.findViewById(R.id.chkItem);
        holder.txtFondoNombre = (TextView) convertView.findViewById(R.id.txtFondoNombre);

        convertView.setTag(holder);
    } else
        holder = (ViewHolder) convertView.getTag();

    holder.txtId.setText(item.getId());
    holder.txtNombre.setText(item.getNombre());
    holder.imagen.setImageBitmap(item.getImagen());
    if (item.getId().equals("0"))
        holder.check.setVisibility(View.INVISIBLE);

    return convertView;
}

@Override
public ImageGridBean getItem(int position) {
    return items.get(position);
}

@Override
public long getItemId(int position) {
    return 0;
}

// --------------------------------------------------------< ViewHolder >---
// -------------------------------------------------------------------------

/* private view holder class */
public class ViewHolder {
    public TextView txtId;
    public TextView txtNombre;
    public TextView txtFondoNombre;
    public ImageView imagen;
    public CheckBox check;
}
} 
```

我有这个布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/relativeLayout1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:descendantFocusability="blocksDescendants" >

    <RelativeLayout
        android:id="@+id/relativeLayout2"
        android:layout_width="92dp"
        android:layout_height="92dp"
        android:layout_alignParentBottom="false"
        android:layout_alignParentLeft="false" >

        <TextView
            .../>

        <ImageView
            .../>

        <TextView
            .../>

        <TextView
            ... />

    </RelativeLayout>

    <LinearLayout
        android:layout_width="38dp"
        android:layout_height="32dp"
        android:layout_alignRight="@+id/relativeLayout2"
        android:layout_alignTop="@+id/relativeLayout2"
        android:layout_marginRight="0dp"
        android:layout_marginTop="4dp" >

        <CheckBox
            android:id="@+id/chkItem"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />
    </LinearLayout>

</RelativeLayout> 
```

好吧，如果我在 ImageView 中单击，它会触发事件单击并且侦听器会捕获它，但是如果我在 CheckBox 中单击，则不会触发事件单击。

我做错了什么？我需要做什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-06T15:32:13.947

`android:focusableInTouchMode="false" android:focusable="false"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:20:04.173

@Sam 是对的，复选框自己处理点击，点击事件永远不会到达 AdapterView。

现在，从技术上讲，您可以`android:clickable="false"`在布局文件中为您的复选框设置，然后单击事件将传递到视图层次结构中，但在这种情况下，您将无法对复选框做任何有用的事情，它只会始终不加检查。

这是更好的方法。将“做某事”移动到不同的方法中，并为复选框添加另一个 onClickListener，以执行相同的操作：

```
gridViewImagenes.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
        doSomething();
    }
});

myCheckbox.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View view) {
        doSomething();
    }
});

}

private void doSomething() {
    //Do Stuff
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T00:51:32.607

认为你将不得不实施 a `OnCheckedChangelistener`to the `checkbox`，在你的情况下 to `chkItem`。

请参阅[**CompoundButton.OnCheckedChangeListener**](http://developer.android.com/reference/android/widget/CompoundButton.OnCheckedChangeListener.html)

实施将类似于...

```
CheckBox checkBox = (CheckBox) findViewById(R.id.chkItem);
checkBox.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {   
    @Override
    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
        if(isChecked) {
            // checkbox is checked - doSomething()
        } else {
            // checkbox is unchecked
        }
    }
}); 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T13:08:16.680

最后决定把适配器放到Activity类中。在 Class Adapter 中放置 ImageView 和 CheckBox 组件的侦听器，因为这些侦听器调用 Activity 类的方法。

感谢大家的时间和回复！！！

# javascript - jquery（但可能更多是 javascript）构造解释

> ID：15124217
> 
> 赞同：0
> 
> 时间：2013-02-27T23:01:10.090
> 
> 标签：javascript, jquery

有人可以用外行的术语解释以下构造在做什么：

```
(function(jQuery) {
   // some javascript code here
})(jQuery); 
```

当然，任何“阅读这篇文章”，或“阅读此链接”，甚至“不要那样做！这是更好的方式”的回应也是非常受欢迎的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:10:26.210

此代码正在创建一个匿名的自调用函数，该函数引用`jQuery`从作为第一个参数传递的父范围调用的变量。

这种语法通常用于“命名空间”您正在编写的代码以避免全局范围的污染，在 JavaScript[**模块**](http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth)模式中非常流行。

# jquery - 如何在两列列表中正确使用浮点数

> ID：15124218
> 
> 赞同：0
> 
> 时间：2013-02-27T23:01:13.043
> 
> 标签：jquery, html, css, listitem

我正在制作一个列表，其中包含两列列表，按日期排序。我想使用以下方法交替不同日子的背景颜色（白色/红色/白色/红色）：

```
.evenDayBlock {
    background:#red
} 
```

[我创建了一个小提琴来显示布局 http://jsfiddle.net/Ceh37/](http://jsfiddle.net/Ceh37/)

问题是，由于我已经浮动了每个列表项，因此具有类的 div 在`evenDayBlock`填充列表时没有向下扩展。如果我删除每个列表项的浮动，则 div 会正确展开。如何使用浮点数同时确保父 div 尊重子大小？

**更新**

好的，我知道我不能用列表项代替 div，因为它会产生邪恶的东西。我在这里更新了小提琴：

[http://jsfiddle.net/Ceh37/2/](http://jsfiddle.net/Ceh37/2/)

全部切换到div。这让我处于一个更好的位置，因为现在 evenDayBlock 被推过第一个oddDayBlock，但它仍然没有扩展到覆盖它包含的所有子 div。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:11:01.647

在更正小提琴的语义之后（请参阅对问题的评论），您应该尝试`overflow: hidden`在所有浮动元素的父容器上使用（例如，如果s 是浮动的，则在*直接*父级`<li>`上使用溢出技巧）。*`<ul>`*

 *或者，您可以使用[clearfix](http://nicolasgallagher.com/micro-clearfix-hack/)方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:15:15.970

如果你的块中有浮动元素，并且块的背景没有扩展到其内容的大小，你可以通过在块的样式中添加“overflow:auto”来解决这个问题。

```
.evenDayBlock {
    background:#red;
    overflow:auto;
} 
```

顺便说一句`"#red"`，我觉得很奇怪，使用`"red"`或`"#F00"`

我希望这可以帮助你。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-27T23:12:16.083

我不确定你做对了，但是在你使用花车并想要设置终点线之后，你应该：

```
<div style="clear:both;"> 
```*

# sql - SQL：在嵌套查询中使用 Not Exists

> ID：15124220
> 
> 赞同：3
> 
> 时间：2013-02-27T23:01:15.160
> 
> 标签：sql, exists, except

我无法理解此查询有效。假设返回订购了所有商品的客户的姓名。

**R**是指客户下的商品订单表，其中包含客户 id (cid) 和商品 id (iid)

**I**指的是可以订购的项目表，其中包含项目 ID

**C**是带有客户 ID 的客户表

```
SELECT cname
FROM Customer C
WHERE NOT EXISTS
(  (SELECT I.iid
       FROM Item I)
    EXCEPT
   (SELECT R.iid
      FROM Order R
      WHERE R.cid=C.cid)) 
```

根据我的假设，带有 SELECT R.iid 的底部嵌套查询获取任何客户订购的所有商品。

然后上面的嵌套查询 EXCEPT with SELECT I.iid，通过减去下面的查询来找到之前没有订购过的所有项目。

如果它是嵌套的，那么 NOT EXISTS 会评估什么语句？是因为 FROM Customer C 而导致的 R.cid = C.cid 吗？. 我不确定我将如何得到我的最终结果。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:14:10.240

把它分解。从最里面的查询开始向后/：

这将返回客户订购的项目 ID 列表。（我假设 iid 代表项目 ID，并且是 R 中的 fk）

```
SELECT R.iid FROM Order R WHERE R.cid=C.cid 
```

这将返回项目 ID 的列表（通常），*除了*客户已经订购的那些

```
SELECT I.iid FROM Item I EXCEPT... 
```

最后，这将返回一个客户列表，这些客户没有订购列表中的某一项。

```
SELECT cname FROM Customer C Where NOT EXISTS... 
```

所以基本上，您正在寻找至少订购了所有东西的客户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:16:44.913

`SELECT I.iid FROM Item I`表示“所有项目的 ID”。

`SELECT R.iid FROM Order R WHERE R.cid=C.cid`表示“客户`C`曾经订购过的所有商品的 ID”（其中`C`由包含的查询确定）。

一般来说，`query1 EXCEPT query2`意思是“所有被返回`query1`和*不*被返回的行`query2`”。在您的特定情况下，`(SELECT I.iid FROM Item I) EXCEPT (SELECT R.iid FROM Order R WHERE R.cid=C.cid)`表示“客户从未订购过的所有商品的`C`ID *”*。

在`NOT EXISTS (subquery)`表达式内部，真正重要的是是否`subquery`返回任何行（在这种情况下它“存在”）。`(SELECT I.iid FROM Item I) EXCEPT (SELECT R.iid FROM Order R WHERE R.cid=C.cid)`如果有客户从未订购过的任何物品，`C`则存在 -*如果*没有任何*此类*物品*，则不存在。*

 *因此，整个查询会找到订购了每件商品的客户的姓名。*

# java - 如何重载方法

> ID：15124221
> 
> 赞同：0
> 
> 时间：2013-02-26T03:44:48.447
> 
> 标签：java

所以我想我的问题太含糊了。我将`runningTotal`方法放在下面类的末尾，`ArrayIntList`并要求我将其重写为`runningTotal(ArrayIntList)`and `static runningTotal(ArrayIntList)`，并实现所有三个，重载。也许我让自己感到困惑，但我无法弄清楚从这里去哪里......我希望这更清楚一点，感谢您的所有帮助！

```
import java.io.*;

public class ArrayIntList {
    private int[] elementData;
    private int size;

    public ArrayIntList(){
        elementData = new int[100];
        size = 0;
    }

    public void add(int value){
        elementData[size] = value;
        size++;
    }

    public void print(){
        if (size == 0){
            System.out.println("[]");
        }
        else {
            System.out.print("[" + elementData[0]);
            for (int i = 1; i < size; i++)
                System.out.print(", " + elementData[i]);
            System.out.println("]");
        }
    }

    public ArrayIntList runningTotal() {
        ArrayIntList newList = new ArrayIntList();
        int i = 0;
        int total = 0;
        while (i < size) {

            total = elementData[i];
            for(int j = 0; j < i; j++);
            newList.add(total);
            i++;
        }
        return newList;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T04:36:39.220

你问的真的没有意义。我只算了一个 runningTotal，只调用了一个。你还没有写其他的。重载的函数只是同名的函数，通常具有相似的功能，但设置不同。所以：

```
void runningTotal(int valueIn)
{/*one thing*/}

void runningTotal(int[] arrayIn)
{/*another thing*/}

int runningTotal()
{return yetAnotherThing;} 
```

...都是同名的功能，但都是完全不同的功能。它的强大之处在于方便的形式，允许您将值传递给函数，而无需注意您实际传递的类型。

您需要做的只是再次定义函数。如果存在功能重叠，您甚至可以从您正在编写的重载中调用其他重载之一。

计算机大部分时间都在查看参数排序。function(int, int) 与 function(string, int) 或 function() 不同。这样做的必然结果是它不关心参数名称。例如，function(int a, int b) 与 function(int c, int d) 完全相同。

如果您想*在同一时间点逐字运行这些功能，*您应该研究[Java 线程和并发](http://docs.oracle.com/javase/tutorial/essential/concurrency/index.html)

# testing - IIS6+ 的负载测试工具

> ID：15124226
> 
> 赞同：0
> 
> 时间：2013-02-27T23:01:53.273
> 
> 标签：testing, asp.net-mvc-4, asp.net-web-api, iis-7.5, load-testing

我正在托管一个 mvc4 web api，想知道有哪些好的负载/性能测试工具？

我只想发送一个 http get 并确保它不会每次都被服务器（我的应用程序）缓存。

（即）-> [http://mysrv.com/api/dev/loadtest?data=1](http://mysrv.com/api/dev/loadtest?data=1)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:37:01.157

你应该看看 wcat：

[http://www.iis.net/downloads/community/2007/05/wcat-63-(x86)](http://www.iis.net/downloads/community/2007/05/wcat-63-(x86)) [http://www.iis.net/downloads/community/2007/05/wcat-63-(x64)](http://www.iis.net/downloads/community/2007/05/wcat-63-(x64))

它完全可以进行您想要的负载测试。

# mongodb - MongoDB。还原时保留有关分片集合的信息

> ID：15124227
> 
> 赞同：0
> 
> 时间：2013-02-27T23:02:09.997
> 
> 标签：mongodb, sharding, database-backups, database-administration

我在 MongoDB 2.2 的复制分片集群中使用 mongodump 和 mongorestore。获取备份并恢复它。

首先，我使用 mongodump 创建所有系统的转储，然后删除一个具体集合并使用 mongorestore 将其恢复，并使用 mongodump 的输出。在那之后，集合是正确的（它包含的数据和索引都是正确的），但是关于这个集合是否被分片的信息会丢失。在丢弃它之前，该集合已被分片。然而，在恢复之后，该集合不再被分片。

我当时想知道是否存在将这些信息保存在备份中的方法。我在想，收集的分片信息可能保存在管理数据库中，但在转储中，管理文件夹是空的，并且对这个数据库使用 show collections 我什么也得不到。然后我想它可以保存在元数据中，但这会很奇怪，因为我知道，在元数据中，关于索引的信息被存储并且索引被正确恢复。

然后，我想知道是否可以使用文件系统快照而不是 mongodump + mongorestore 来保留这些信息；或者可能仍在使用 mongodump 和 mongorestore 但停止系统或锁定写入。我不认为最后一个选项可能是原因，因为我在恢复时没有执行写入操作，甚至没有锁定它，而只是为了提供想法。

我还想知道是否有人完全确定当前版本是否仍然不提供此功能。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:10:30.197

如果您使用 mongodump 备份您的分片集合，您确定它真的需要分片吗？通常分片集合非常大，mongodump 需要很长时间才能备份它。

此处描述了备份大型分片集合可以执行的操作[。](http://docs.mongodb.org/manual/administration/backups/#sharded-cluster-backups)

关键是备份您的配置服务器以及每个分片 - 并在停止平衡后尽可能接近“同时”进行。Config DB 很小，所以无论如何你应该经常备份它。备份大型分片的最佳方式是通过文件快照。

# jquery - jQuery - 基于属性的选择器

> ID：15124230
> 
> 赞同：0
> 
> 时间：2013-02-27T23:02:12.457
> 
> 标签：jquery, variables

我有这个选择器尝试：

```
<textarea tinymce="basicoptions"></textarea>
<textarea tinymce="advancedoptions"></textarea>
<script language="javascript" type="text/javascript">
$(document).ready(function(){
   $('textarea[tinymce]').each(function(){ 
   var tinymceopts = $(this).attr('tinymce');
   $(this).tinymce(tinymceopts); 

});
</script> 
```

简单地说，我正在使用我的自定义属性，调用`tinymce`它来保存一个字符串，它是我存储在 javascript 文件中的变量的名称。
（javascript文件中的示例： `var basicoptions = { ....stuff.... }` 该变量内部包含tinymce编辑器的自定义选项。

上面的代码不起作用。但是如果我用`$(this).tinymce(tinymceopts);`实际变量之一替换它： `$(this).tinymce(basicoptions);` 它工作正常。

我实际上有 4 个变量可以使用，但我上面只显示了 2 个。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:03:59.540

好的，在重新阅读您的问题后，听起来您只需要访问一个名称与属性相似的变量即可。假设它是一个全局变量，请这样做：

```
$(document).ready(function(){
   $('textarea[tinymce]').each(function(){ 
   var tinymceopts = $(this).attr('tinymce');
   $(this).tinymce(window[tinymceopts]); 
}); 
```

您现在不是将字符串“basicoptions”传递给`tinymce`方法，而是引用一个`window.basicoptions`应该映射到您的变量的`var basicoptions`变量，假设范围确实在全局级别。如果不是，只需替换`window`为适用的命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:12:32.923

这似乎不是关于 jQuery 属性选择器，甚至 jQuery 的问题。

根据我的理解，您已经为编辑器创建了四个具有不同选项集的变量 - 而不是这个，为什么不创建一个具有多个属性的对象呢？

```
var config = {
    basic: {...},
    advanced: {...}
}; 
```

通过这种方式，您可以访问相应的配置，执行以下操作：

```
$('textarea[tinymce]').each(function() {
   var tinymceopts = $(this).attr('tinymce');
   $(this).tinymce(config[tinymceopts]);
}); 
```

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:17:33.647

是否可以将选项放在标记中的数据集属性（[docs](https://developer.mozilla.org/en-US/docs/DOM/element.dataset)）中？然后，您可以使用 jQuery `data()`( [docs](http://api.jquery.com/data/) ) 方法直接检索选项，而无需使用辅助变量。

您可以将 JSON 字符串放入属性中，jQuery 会自动将其解析为可用对象。

```
<textarea class="tinymce" data-tinymceoptions='{"option":"option_value"}'></textarea>

$('textarea.tinymce').each(function(){
    var options = $(this).data('tinymceoptions');
    // pass the options on to the tiny MCE library
}); 
```

在 jsFiddle 上试试：http: [//jsfiddle.net/gF5Uq/](http://jsfiddle.net/gF5Uq/)

**文档**

*   `jQuery.data`- [http://api.jquery.com/data/](http://api.jquery.com/data/)
*   MDN 上的 HTML5 元素数据集 - [https://developer.mozilla.org/en-US/docs/DOM/element.dataset](https://developer.mozilla.org/en-US/docs/DOM/element.dataset)

# php - php - 需要一个 foreach 循环来仅显示一组值

> ID：15124241
> 
> 赞同：2
> 
> 时间：2013-02-27T23:02:48.547
> 
> 标签：php

我正在尝试编写一个脚本，该脚本从 SQL 查询中获取结果，并在遍历每个结果时检查 $row[13] 的名称应该是什么，然后我想要遍历它识别的每个查询结果任何相似的名称，并记录它看到该名称的次数。我以为我有一个循环计算出相同名称在数组中出现的次数，然后显示它。我正在寻找的最终结果是

```
Operations - 87
Training - 32
HR - 12 
```

但是在我运行这段代码之后：

```
 while($row = mysql_fetch_array($result_id))
  {
        $profile8 = mysql_query
                    ("
                        SELECT org
                        FROM cost_centers
                        WHERE cost_center = '$row[13]'
                    ")
                    or die(mysql_error());
                    $anymatches=mysql_num_rows($profile8);
                        while($pro8 = mysql_fetch_array($profile8))
                        {
                            $orgnames = $pro8[0];
                        }

                            $names[] = $orgnames;

                            $newArray = array_count_values($names);

                            foreach ($newArray as $key => $value) {
                                echo "$key - $value <br />";
                            }

  } 
```

我最终会像这样不断地计算它：

```
HR - 1 
HR - 1 
Communications - 1 
HR - 1 
Communications - 1 
- 1 
HR - 1 
Communications - 1 
- 2 
HR - 1 
Communications - 1 
- 3 
HR - 1 
Communications - 1 
- 4 
HR - 2 
Communications - 1 
- 4 
HR - 3 
Communications - 1 
- 4 
HR - 3 
Communications - 1 
- 4 
Operations - 1 
HR - 4 
Communications - 1 
- 4 
Operations - 1 
HR - 4 
Communications - 1 
- 5 
Operations - 1 
HR - 4 
Communications - 1 
- 6 
Operations - 1 
HR - 4 
Communications - 1 
- 6 
Operations - 2 
HR - 4 
Communications - 1 
- 6 
Operations - 3 
HR - 4 
```

所以它看起来就像是先分组然后计数，然后在不断增加计数时重新分组。我希望这是有道理的，并提前感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:08:01.117

为什么不使用以下查询：

```
SELECT 
    SUM(IF(org='HR', 1, 0)) AS HRCount,
    SUM(IF(org='Communications', 1, 0)) AS ComCount,
    SUM(IF(org='Operations', 1, 0)) AS OpCount,
FROM cost_centers
WHERE cost_center = '$row[13]' 
```

然后你可以通过调用来访问这些值`$row["HRCount"];`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:08:28.473

这是因为您每次都在循环内打印计数器。它必须是这样的：

```
<?php

while($row = mysql_fetch_array($result_id))
{
    $profile8 = mysql_query("
        SELECT org
        FROM cost_centers
        WHERE cost_center = '$row[13]'")
    or die(mysql_error());

    $anymatches=mysql_num_rows($profile8);
    while($pro8 = mysql_fetch_array($profile8))
    {
        $orgnames = $pro8[0];
        $names[] = $orgnames;
    }
}

$newArray = array_count_values($names);

foreach ($newArray as $key => $value) {
    echo "$key - $value <br />";
} 
```

无论如何，对第一行中的每一行进行新查询都不是一个好的选择。您应该更好地学习 SQL，尤其是关于 JOIN 和（在您的情况下）COUNT 运算符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:08:41.603

试试这个 ：

```
SELECT cost_centers.org, count(*) FROM cost_centers WHERE cost_center = what_you_want GROUP BY cost_centers.org 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T23:21:54.213

你在正确的轨道上。

在while之前制作一个数组：

```
$org = array(); 
```

现在，在 foreach 中，使用 $key 在新数组中创建一个键，然后添加一个

```
foreach ($newArray as $key => $value) {
    $org[$key] += 1;
} 
```

当您完成 while($row = mysql_fetch_array($result_id)) 循环后，再创建一个 foreach 循环并显示结果。

```
foreach($org as $name => $count){
    echo $name . " = " . $count . "<br />";
} 
```

# iphone - 在 Xcode 中搜索 API

> ID：15124246
> 
> 赞同：0
> 
> 时间：2013-02-27T23:03:18.867
> 
> 标签：iphone, objective-c, api, xcode4.5

我正在开发一个 iPhone 应用程序，它使用 API 从[http://www.recipepuppy.com/about/api/](http://www.recipepuppy.com/about/api/)查找食谱。

必须将三个参数放入返回结果中。有 i、q 和 p，其中 i 是成分，q 在普通搜索查询中，p 是页面#。我可以专门添加这些参数，然后将结果加载到 Xcode 中的表格视图中。

我还想实现一个搜索，允许用户根据他们的感觉搜索食谱并返回结果。有人可以指出我如何做到这一点的正确方向。我知道我必须接受用户输入的内容并将其放入字符串中，但是如何将该字符串实现到 URL 的参数中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:07:34.027

要回答您的问题：

> 我知道我必须接受用户输入的内容并将其放入字符串中，但是如何将该字符串实现到 URL 的参数中？

您可以使用 NSString 的 stringWithFormat 方法。例如：

```
NSString *ingredients = @"ingredients";
NSString *query = @"soups";
NSString *page = @"1";

NSString *url = [NSString stringWithFormat:@"http://www.recipepuppy.com/api/?i=%@&q=%@&p=%@",ingredients,query,page]; 
```

在使用此 URL 之前，建议您对其进行 URL 编码。

```
NSString *encodedURL = [url stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

现在您已经有了 URL，只需启动到 Web 的连接（NSURLConnection、AFNetworking，由您选择），解析返回的数据，并将其加载到数组中以显示在表格视图中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:23:04.023

要构建涉及通过网络进行 JSON 通信的可靠应用程序，您可以使用 JSONModel 库。它为您提供数据模型，并负责向您的 API 服务发送和接收 JSON。

你可以看看 GitHub 页面： [https ://github.com/icanzilb/JSONModel/](https://github.com/icanzilb/JSONModel/)

或者还有关于如何将 YouTube JSON API 与 JSONModel 一起使用的示例： [http ://www.touch-code-magazine.com/how-to-make-a-youtube-app-using-mgbox-and-jsonmodel/](http://www.touch-code-magazine.com/how-to-make-a-youtube-app-using-mgbox-and-jsonmodel/)

在 GitHub 页面上有更多代码示例。祝你好运 ：）

（披露：我是 JSONModel 的作者）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:12:17.463

我会为您的所有网络请求使用 AFNetworking： [https ://github.com/AFNetworking/AFNetworking](https://github.com/AFNetworking/AFNetworking)

要发出请求，只需构造一个 NSString 并将其发送出去

```
[NSString stringWithFormat:@"http://www.recipepuppy.com/api/?i=%@&q=%@&p=%d", self.ingredients, self.query, self.page] 
```

# c# - 在应用程序中操作 PowerShell？

> ID：15124253
> 
> 赞同：2
> 
> 时间：2013-02-27T23:03:59.760
> 
> 标签：c#, wpf, powershell, powershell-3.0

我想制作一个包含 PowerShell 脚本集合的可执行文件。在左侧，用户可以看到要选择和运行的不同脚本的列表，而右侧是输出。

如果我有一个如下所示的基本 wpf 应用程序：![在此处输入图像描述](../Images/e580d7c66d2fe1f49d588147265494d2.png)

我可以在窗口的右侧创建一个 PowerShell 实例吗？

即是这样的：![在此处输入图像描述](../Images/90ddce4d9835ce8024630391bbcb4403.png)

输出窗口（右侧）几乎只是用于运行任何脚本的输出。

不过，在我对这个想法投入过多之前，是否可以在 WPF 应用程序的窗口内运行/输出 PowerShell 脚本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T23:46:12.593

[我在我的博客PowerShellStation.com](http://powershellstation.com/category/writing-a-host/ "PowerShellStation.com")（Writing a Host）上有一系列关于在 .net 应用程序中使用 PowerShell 的文章

# c++ - 如何在 OpenGL/C++ 中绘制居中的字符串？

> ID：15124254
> 
> 赞同：0
> 
> 时间：2013-02-27T23:04:00.827
> 
> 标签：c++, opengl, glut

```
void DrawGLText(string text, float loc_x, float loc_y) {
  glColor4f(1.0, 1.0, 1.0, 0.5);
  glRasterPos3f(loc_x, loc_y, 1);
  glutBitmapString(GLUT_BITMAP_HELVETICA_18), text.c_str());
} 
```

这是我在特定位置绘制文本的代码。我想调整它以绘制以 (loc_x, loc_y) 为中心而不是左对齐的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:10:30.650

使用[`glutBitmapWidth()`](http://www.opengl.org/resources/libraries/glut/spec3/node77.html)或`glutBitmapLength()`查找字符串的宽度并沿 X 轴平移`-textWidth / 2.0f`。

# android - Android中的圆形语音动画

> ID：15124262
> 
> 赞同：10
> 
> 时间：2013-02-27T23:04:44.980
> 
> 标签：android

有谁知道如何在 Android 中制作像“Talk now”这样的成长圈动画？

![动画](../Images/cb8f09f1ca10f77825f23ef0337d12b6.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-07-28T08:48:27.033

我建议你看看这个项目。 [https://github.com/kyze8439690/AndroidVoiceAnimation](https://github.com/kyze8439690/AndroidVoiceAnimation)

# ios - Objective C 将文本文件解析为 CGPoint 对象

> ID：15124264
> 
> 赞同：1
> 
> 时间：2013-02-27T23:04:54.800
> 
> 标签：ios, objective-c, parsing, core-animation

在我的应用程序中，我试图从制表符分隔的 xyt 值的行中加载`foo.txt`并使用动画在屏幕上的路径，`CABasicAnimation`并且我试图让动画根据`foo.txt`.

**所以我想这个问题有两个部分：如何在`foo.txt`不进行数百次 fscanf 调用的情况下加载文件并在 iOS 上轻松解析值，以及如何以编程方式使动画更改速度？**

以下是 4 行示例`foo.txt`，时间以毫秒为单位：

```
x      y      t
200    300    698
250    322    827
484    192    858
286    752    907 
```

我几乎可以肯定必须有一种非常有效的方法来执行以下操作，但我的第一个想法是创建一个`Point`对象：

```
@interface Point : NSObject {
CGFloat x;
CGFloat y;
CGFloat t; } 
```

并且，假设`foo.txt`get 中的值转移到`SOMETHING`，我可以将每个值转换为 CGFloat 并将其转移到`pathMutable`，我可以在以后迭代它以进行路径。

```
// somehow load and parse foo.txt intelligently, place values in the SOMETHING object
// not sure how in objective-c besides reinventing the wheel with fscanf    

for (int i = 0; i<[SOMETHING count]; i++) {   
        Point * p = [SOMETHING objectAtIndex:i];  //pseudocode
        NSArray * tempVal = [NSArray arrayWithObjects: [NSValue valueWithCGPoint:CGPointMake(p.x,p.y)], nil];
        [pathMutable addObject:tempVal];  

    } 
```

我当前的 xy-only 路径是：

```
UIBezierPath * path = [UIBezierPath bezierPath];
for (int i = 0; i<[pathMutable count]; i++) {
    NSValue * val = [pathMutable objectAtIndex:i];
    CGPoint p = [val CGPointValue];

    if (i == 0) {
        [path moveToPoint:p];
    }
    else {
        [path addLineToPoint:p];
    }
} 
```

查看动画路径的文档，我注意到很多方法只需要 x 和 y，当你开始你的动画时，你定义`duration`了动画的总和，`fromValue`和`toValue`。如何将我的个人时间值挂钩？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:44:16.980

既然你问了两个问题，那我只回答一个。解析这样一个结构良好的文件并不难，并且已经有很多关于解析的问题。至于第二部分，你想要的类是[CAKeyframeAnimation](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CAKeyframeAnimation_class/Introduction/Introduction.html)。这将使您可以很好地控制动画行为。

# python - Python：总和中的 Lambda

> ID：15124268
> 
> 赞同：2
> 
> 时间：2013-02-27T23:05:11.920
> 
> 标签：python, lambda, sum, closures

我正在尝试执行以下操作，这是我最终目标的代表性示例：

```
 yu = lambda x: 0
 for i in range(0,5):
      yu = lambda x: i + yu(x) 
```

不幸的是，它返回：

`RuntimeError: maximum recursion depth exceeded`

当我做：

```
print yu(0) 
```

打印语句应返回 10。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T23:08:56.900

最后，你有：

```
yu = lambda x: i + yu(x) 
```

但将在*运行时*`yu`查找，而不是在您构造 lambda 时查找。改为这样做：

 *```
for i in range(0,5):
    yu = lambda x, yu=yu: i + yu(x) 
```

但是，这*不会*返回`10`。它`20`改为返回：

```
>>> yu = lambda x: 0
>>> for i in range(0,5):
...     yu = lambda x, yu=yu: i + yu(x)
... 
>>> yu(0)
20 
```

因为 now`i`仍然从上下文中查找（现在循环已经完成，所以它是`4`）。解决方案？也移动`i`到关键字参数：

```
for i in range(0,5):
    yu = lambda x, yu=yu, i=i: i + yu(x) 
```

*现在*这有效：

```
>>> yu = lambda x: 0
>>> for i in range(0,5):
...     yu = lambda x, yu=yu, i=i: i + yu(x)
... 
>>> yu(0)
10 
```

故事的道德启示？将您的上下文正确绑定到 lambda 的范围。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:10:53.687

```
 yu = lambda x: i + yu(x) 
```

这使得它`yu`成为一个始终调用自身的函数，保证了没有基本情况的无限递归。

为什么？好吧，您已经构建了一个闭包，其中`yu`(and ) 是循环`i`所属的函数或模块中的局部变量。`for`那不是你想要的；您想关闭 and 的*当前值*，`yu`而`i`不是外部变量。

我不确定你为什么一开始就使用`lambda`它。如果要定义函数并为其命名，请使用`def`.

这是一个简单的解决方案：

```
def yu(x): return 0
def make_new_yu(yu, i):
    def new_yu(x): return i + yu(x)
    return new_yu
for i in range(0, 5):
    yu = make_new_yu(yu, i) 
```

通过使包装明确，正确的方法成为最明显的方法。

当然，您可以使用`lambda`inside`make_new_yu`而不会使事情变得更加混乱：

```
def make_new_yu(yu, i):
    return lambda x: i + yu(x) 
```

如果需要，您甚至可以将初始定义设为 a `lambda`。但是，如果您坚持不使用*任何* `def`语句，则需要以某种方式强制将正确的值放入闭包中，例如，通过使用默认值技巧。这更容易出错——一旦你完成了它就更难阅读了。

如果您想直观地了解差异，而无需了解细节：函数体定义了一个新范围。因此，在该函数内定义函数（通过`lambda`或`def`）意味着您的闭包来自该新范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:52:31.110

考虑到您尝试总结 0、1、2、3、4 的答案。如果这是正确的，您可以使用以下 lambda 表达式：

```
yu = lambda x: x + yu(x+1) if x<4 else x 
```

因为`yu(0)`它提供了 10 个结果。中断条件是`x`需要保持小于 4 才能相加的值。

假设这是您想要做的，您应该省略循环以获得相当简洁的语句。

此 lambda 表达式与其他 lambda 表达式的不同之处在于根据给定参数产生不同的值（当不选择 0 作为参数 x 时，除 10 外）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-31T15:14:17.663

我相信我没有完全理解您的问题，但是有人可以检查他是否是这个意思吗？

*我假设您不需要迭代器来生成数字列表*

```
yu = lambda x: x[0] + yu(x[1:]) if x!=[] else 0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-28T12:48:33.687

```
facto = lambda f: f if f == 0 else f + facto(f-1)
print(facto(4)) 
```*

# c++ - 跟踪对象和引用

> ID：15124271
> 
> 赞同：-4
> 
> 时间：2013-02-27T23:05:26.150
> 
> 标签：c++

如果我们注释掉下面强调的行，我们会在控制台中得到 777。否则我们会得到一些像（-534532345）这样的垃圾。我的环境是 Microsoft Visual Studio 2012 Pro。

```
class C
{
public:
    C () { x = 777; }
    void ou() {cout << x;}
protected:
    int x;
};

class A
{
public:
    A(C & rrc) : rc(rrc) {};
    void koo () {rc.ou();}
protected:
    C & rc;
};

int _tmain(int argc, _TCHAR* argv[])
{
    C c;
    C * pc = new C;
    A a(*pc);
    delete pc; // <<<< this line
    a.koo();

    return 0;
} 
```

谁能帮我弄清楚为什么我会看到这种行为？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T23:08:18.067

在您调用 a.koo() 时，您已删除其`rc`引用所指的基础对象。那当然是UB。接下来发生的事情很可能在给定平台上针对给定编译具有一致的行为，甚至可能输出 777（实际上，可能会输出 777，因为最近删除了底层对象）。在您的情况下，似乎先前分配给 _tmain() 的内存`pc`对象已被重新分配给其他已覆盖它的东西，或者您正在使用调试版本，其内存分配器用某个固定值显式覆盖已删除/已释放的内存，通常非零且不是全部，但其他可识别的东西，如 0xAAAAAAA 或0x死亡。由于 -534532345 是 0xE023AF07（或 0xFFFFFFFFE023AF07），我猜它是前者（内存已分配给其他已覆盖它的东西）。由于在您的示例中对 a.koo() 的调用紧随其后`delete pc`，我发现它这么快就被覆盖了，但从技术上讲，因为它是 UB，所以一切皆有可能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T23:08:28.900

删除会给您留下一个悬空的引用，您会跟随它，导致未定义的行为。它不是 C++ 或 MS VS 中的漏洞。该语言允许许多非法操作不受检查，并让程序员不要调用 UB。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-27T23:08:30.100

该代码具有未定义的行为。您持有一个不再存在的对象的引用。所以，`rc.ou()`行为是不确定的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T23:08:54.030

如果你删除 pc，那么 A::rc 将指向垃圾位置和 rc.ou(); 也会输出垃圾。这是预期的行为，无论您使用什么编译器，它都会这样做

顺便说一句，99[.99]% 的时间你认为你在编译器中发现了一个错误，这真的是你的错误

# html - 如何使元素在浏览器调整大小时不移动？

> ID：15124273
> 
> 赞同：-1
> 
> 时间：2013-02-27T23:05:38.433
> 
> 标签：html, css

我在网站上工作，顶部固定链接，底部固定提交按钮。`overflow:auto`中间的内容可以使用;滚动。

当我减小浏览器窗口大小的高度时，我注意到 2 个问题：

1.  滚动条高度不会随着浏览器的高度而变化。
2.  当高度减小时，固定按钮显示在滚动条的顶部

当浏览器高度发生变化时，如何使按钮始终保持在固定位置以及自动调整溢出高度？

我在这里做了一个 JSFiddle 演示我的问题 -> [MY JSFIDDLeDEMO](http://jsfiddle.net/dev1212/8yMN7/)

我正在使用 Firefox 19.0 和 chrome 版本 26.0.1410.12 和 IE9

这是我在 JSfiddle 中的代码：

```
<!DOCTYPE HTML>
<html>

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>overflow based Layout</title>
        <style type="text/css">
            <!--
            /* Pretty Stuff */
            /* Zero down margin and paddin on all elements */
            * {
                margin: 0;
                padding: 0;
            }
            body {
                font: 92.5%/1.6"Lucida Grande", "Lucida Sans", "Lucida Sans Unicode", Verdana, sans-serif;
            }
            h1 {
                font-size: 2.4em;
                font-weight: normal;
            }
            h2 {
                font-size: 2.0em;
                font-weight: normal;
            }
            p, li {
                font-size: 1.4em;
            }
            h1, h2, p {
                margin: 1em 0;
            }
            #branding h1 {
                margin: 0;
            }
            #wrapper {
                background-color: #fff;
            }
            #branding {
                height: 50px;
                background-color:#b0b0b0;
                padding: 20px;
            }
            #form-b {
                height: 500px;
                overflow: auto;
                position: fixed;
                top: 164px;
                width: 98%;
            }
            #mainNav {
                list-style: none;
                background-color:#eee;
            }
            #footer {
                background-color:#b0b0b0;
                padding: 1px 20px;
            }
            /* The Core Technique
================================= */
            body {
                text-align: center;
                min-width: 1260px;
            }
            #wrapper {
                width: 100%;
                margin: 0 auto;
                text-align: left;
            }
            #content {
                width: 100%;
                float: right;
            }
            #mainNav li {
                /*  width: 180px; 
  float: left;  */
                display:inline;
            }
            #submit-b {
                border: 0px solid red;
                bottom: 77px;
                position: fixed;
                text-align: cemter;
                width: 100%;
            }
            #footer {
                clear: both;
            }
            /* Add some padding 
================================== */
            #mainNav {
                padding-top: 20px;
                padding-bottom: 20px;
                position: fixed;
                width: 100%;
            }
            #mainNav * {
                padding-left: 20px;
                padding-right: 20px;
            }
            #mainNav * * {
                padding-left: 0;
                padding-right: 0;
            }
            #content * {
                padding-right: 20px;
            }
            #content * * {
                padding-right: 0;
            }
            -->
            /* fieldset styling */
            fieldset {
                margin: 1em 0;
                /*  space out the fieldsets a little*/
                padding: 1em;
                border : 1px solid #ccc;
                background-color:#F5F5F5
            }
            /* legend styling */
            legend {
                font-weight: bold;
            }
            form p {
                position: relative;
                width: 100%;
            }
            /* style for  labels */
            label {
                float: left;
                width: 10em;
            }
            #remember-me label {
                width: 4em;
            }
            /* style for required labels */
            label .required {
                font-size: 0.83em;
                color:#760000;
            }
            /* style error messages */
            label .feedback {
                position: absolute;
                margin-left: 11em;
                left: 200px;
                right: 0;
                font-weight: bold;
                color:#760000;
                padding-left: 18px;
                background: url(images/error.png) no-repeat left top;
            }
            /* :KLUDGE: Explicitly set the width for IE6- */
            * html .feedback {
                width: 10em;
            }
            input {
                width: 200px;
            }
            input[type="text"], textarea {
                border-top: 2px solid #999;
                border-left: 2px solid #999;
                border-bottom: 1px solid #ccc;
                border-right: 1px solid #ccc;
            }
            input.radio, input.checkbox, input.submit {
                width: auto;
            }
            /* style form elements on focus */
            input:focus, textarea:focus {
                background: #ffc;
            }
            input.radio {
                float: left;
                margin-right: 1em;
            }
            textarea {
                width: 300px;
                height: 100px;
            }
            /* Date of Birth form styling */
            #monthOfBirthLabel, #yearOfBirthLabel {
                text-indent: -1000em;
                width: 0;
            }
            #dateOfBirth {
                width: 3em;
                margin-right: 0.5em;
            }
            #monthOfBirth {
                width: 10em;
                margin-right: 0.5em;
            }
            #yearOfBirth {
                width: 5em;
            }
            /* Color form styling */
            #favoriteColor {
                margin: 0;
                padding: 0;
                border: none;
                background: transparent;
            }
            #favoriteColor h2 {
                width: 10em;
                float: left;
                font-size: 1em;
                font-weight: normal;
            }
            #favoriteColor div {
                width: 8em;
                float: left;
            }
            #favoriteColor label {
                /*width: 3em;*/
                float: none;
                display: inline;
            }
        </style>
    </head>

    <body>
        <div id="wrapper">
            <div id="branding">

<h1>Branding</h1>

            </div>
            <div id="content">
                <ul id="mainNav">
                    <li class="first">
                        <a href="#">Home</a>
                    </li>
                    <li>
                        <a href="#">About</a>
                    </li>
                    <li>
                        <a href="#">News</a>
                    </li>
                    <li>
                        <a href="#">Products</a>
                    </li>
                    <li>
                        <a href="#">Services</a>
                    </li>
                    <li>
                        <a href="#">Clients</a>
                    </li>
                    <li>
                        <a href="#">Case Studies</a>
                    </li>
                </ul>
                <div id="form-b">
                    <form id="comments_form" action="#" method="post">
                        <fieldset>
                            <legend>Your Contact Details</legend>
                            <p>
                                <label for="author">Name: <span class="required">(Required)</span>
                                </label>
                                <input name="author" id="author" type="text" />
                            </p>
                            <p>
                                <label for="email">Email Address: <span class="feedback">Incorrect email address. Please try again.</span>
                                </label>
                                <input name="email" id="email" type="text" />
                            </p>
                            <p>
                                <label for="url">Web Address:</label>
                                <input name="url" id="url" type="text" />
                            </p>
                        </fieldset>
                        <fieldset>
                            <legend>Your Contact Details</legend>
                            <p>
                                <label for="author">Name: <span class="required">(Required)</span>
                                </label>
                                <input name="author" id="author" type="text" />
                            </p>
                            <p>
                                <label for="email">Email Address: <span class="feedback">Incorrect email address. Please try again.</span>
                                </label>
                                <input name="email" id="email" type="text" />
                            </p>
                            <p>
                                <label for="url">Web Address:</label>
                                <input name="url" id="url" type="text" />
                            </p>
                        </fieldset>
                        <fieldset>
                            <legend>Your Contact Details</legend>
                            <p>
                                <label for="author">Name: <span class="required">(Required)</span>
                                </label>
                                <input name="author" id="author" type="text" />
                            </p>
                            <p>
                                <label for="email">Email Address: <span class="feedback">Incorrect email address. Please try again.</span>
                                </label>
                                <input name="email" id="email" type="text" />
                            </p>
                            <p>
                                <label for="url">Web Address:</label>
                                <input name="url" id="url" type="text" />
                            </p>
                        </fieldset>
                        <fieldset>
                            <legend>Your Contact Details</legend>
                            <p>
                                <label for="author">Name: <span class="required">(Required)</span>
                                </label>
                                <input name="author" id="author" type="text" />
                            </p>
                            <p>
                                <label for="email">Email Address: <span class="feedback">Incorrect email address. Please try again.</span>
                                </label>
                                <input name="email" id="email" type="text" />
                            </p>
                            <p>
                                <label for="url">Web Address:</label>
                                <input name="url" id="url" type="text" />
                            </p>
                        </fieldset>
                        <fieldset id="submit-b">
                            <legend></legend>
                            <p>
                                <input id="submit" class="submit" name="submit" type="submit" />
                            </p>
                        </fieldset>
                    </form>
                </div>
            </div>
            <div id="footer">
                <p>Footer</p>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:33:12.740

**1.滚动条高度不随浏览器高度变化。**
那是因为你已经为 设置了一个固定的高度`#form-b`，设置为 500px：

```
#form-b {
    height: 500px;
    overflow: auto;
    position: fixed;
    top: 164px;
    width: 98%; 
} 
```

**2\. 当高度减小时，固定按钮显示在滚动条的顶部**
提交按钮不需要用`fieldset`. 简单地将提交按钮相对于包含父级的`<form>`.

**3\. 如何让按钮始终保持在固定位置，并且在浏览器高度发生变化时自动调整溢出高度？**
固定位置，固定在视口中，还是相对于滚动 div 固定？此外，每当浏览器高度发生变化时，您将不得不依靠 JS 重新调整表单的高度，类似于：

```
$(document).ready(function() {
    $(window).resize(function() {
        // Set <form> height here with calculations (...)
        $("#form-b).height(...);
    }).resize(); // Trigger another resize when document is ready
}); 
```

# ios - 如何创建一个透明的 UIBarButtonItem？

> ID：15124274
> 
> 赞同：1
> 
> 时间：2013-02-27T23:05:39.587
> 
> 标签：ios, transparency, uibarbuttonitem, transparent, tint

我有一个带有图案的 UINavigationBar。我见过很多实现透明 UIBarButtonItem 的 UI，我想知道如何实现。

不幸的是，Tint dosent 可以解决问题...

请帮忙...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T23:06:32.377

在 UIBarButton 项内放置一个 UIButton。按钮可以是透明的。在 Xcode 的 Interface Builder 中，只需将 UIButton 拖到 UINavigationBar 的空白角落之一。Xcode 会自动创建一个 UIBarButtonItem 并将 UIButton 放入其中。然后，您可以将 UIButton 类型设置为自定义并应用其他属性，例如标题或图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:35:45.410

按照 Melsam 描述的过程并使用设置按钮的透明度

button.backgroundColor = [UIColor colorWithRed:0.0 green:0.0 blue:0.0 alpha:0.5];

# android - android : 遮蔽布局及其内容

> ID：15124279
> 
> 赞同：0
> 
> 时间：2013-02-27T23:05:58.090
> 
> 标签：android, android-layout, android-linearlayout, shadow

我想在线性布局上制作绿色阴影，其内容如下图所示

![阴影视图](../Images/533d0bfdf387e13c60e7002c53027090.png)

这是用户界面的代码片段

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="168dp"
    android:layout_height="120dp" 
    android:orientation="vertical" 
    android:background="@drawable/grid_item_init_border"
    >

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="90dp"
        android:padding="8dp"
        android:orientation="horizontal"
        android:background="@color/white"
        android:layout_margin="1dp">

    <ImageView
        android:id="@+id/image"
        android:layout_width="80dp"
        android:layout_height="match_parent"
        android:src="@drawable/no_image" />

        <TextView
            android:id="@+id/app_name" 
            android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@+id/image"
        android:maxLines="2"
        android:ellipsize="end"
        android:layout_marginLeft="4dp"
        android:text="VVVVVVVVVVz"/>

        <TextView android:id="@+id/category"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignLeft="@+id/app_name"
            android:layout_below="@+id/app_name"
            android:lines="1"
            android:ellipsize="marquee"
            android:text="xxxxxxxxxxz"/>

    </RelativeLayout>

    <CheckBox
        android:id="@+id/share"
        android:layout_width="match_parent"
        android:layout_height="30dp"
        android:layout_margin="4dp"
        android:paddingLeft="24dp"
        android:text="CheckBox" 
        android:button="@drawable/checkbox_white_gray" 
        android:background="@color/init_grid_item_checkbox_gray"/> 
```

我应该在我的代码中添加什么以便在布局上绘制阴影？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:25:24.447

您应该在 中添加另一个视图`RelativeLayout`并按如下方式排列边距/填充：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
android:layout_width="168dp"
android:layout_height="120dp" 
android:orientation="vertical" 
android:background="@drawable/grid_item_init_border">

<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="90dp"
    android:orientation="horizontal"
    android:background="@color/white"
    android:layout_margin="1dp">

  <ImageView
    android:id="@+id/image"
    android:layout_width="80dp"
    android:layout_height="match_parent"
    android:layout_marginLeft="8dp"
    android:layout_marginTop="8dp"
    android:layout_marginDown="8dp"
    android:src="@drawable/no_image" />

  <TextView
    android:id="@+id/app_name" 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@+id/image"
    android:maxLines="2"
    android:ellipsize="end"
    android:layout_marginLeft="4dp"
    android:layout_marginTop="8dp"
    android:layout_marginRight="8dp"
    android:text="VVVVVVVVVVz"/>

  <TextView
    android:id="@+id/category"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginRight="8dp"
    android:layout_marginBottom="8dp"
    android:layout_alignLeft="@+id/app_name"
    android:layout_below="@+id/app_name"
    android:lines="1"
    android:ellipsize="marquee"
    android:text="xxxxxxxxxxz"/>

  <View android:id="@+id/overlay"
    layout_width="match_parent"
    layout_height="match_patent"
    background="@drawable/green_overlay"/>

 </RelativeLayout>

 <CheckBox
    android:id="@+id/share"
    android:layout_width="match_parent"
    android:layout_height="30dp"
    android:layout_margin="4dp"
    android:paddingLeft="24dp"
    android:text="CheckBox" 
    android:button="@drawable/checkbox_white_gray" 
    android:background="@color/init_grid_item_checkbox_gray"/>

</LinearLayout> 
```

您的叠加层在哪里`@drawable/green_overlay`（颜色、形状、图像甚至 9patch）。如果您需要按下/未按下状态，您甚至可以使用`selector`（看看[这里](http://developer.android.com/guide/topics/resources/drawable-resource.html#StateList)）

# javascript - HTML5 Canvas 从浏览器拖出到桌面

> ID：15124288
> 
> 赞同：3
> 
> 时间：2013-02-27T23:06:51.880
> 
> 标签：javascript, html, canvas, html5-canvas

我正在尝试创建一个小的图像处理网络应用程序作为一个项目。我正在尝试将画布图像从浏览器拖到桌面。我做了一些挖掘并发现

[http://www.thecssninja.com/javascript/gmail-dragout](http://www.thecssninja.com/javascript/gmail-dragout)和[http://jsfiddle.net/bgrins/xgdSC/](http://jsfiddle.net/bgrins/xgdSC/)（由 TheCssNinja 和 Brian Grinstead 提供）

```
 function dragoutImages() {

    if (!document.addEventListener) {
        return;
    }

    document.addEventListener("dragstart", function(e) {
        var element = e.target;
        var src;

        if (element.tagName === "IMG" && element.src.indexOf("data:") === 0) {
            src = element.src;
        }

        if (element.tagName === "CANVAS") {
            try {
                src = element.toDataURL();
            }
            catch(e) { }
        }

        if (src) {
            var name = element.getAttribute("alt") || "download";
            var mime = src.split(";")[0].split("data:")[1];
            var ext = mime.split("/")[1] || "png";
            var download = mime + ":" + name + "." + ext + ":" + src;

            e.dataTransfer.setData("DownloadURL", download);   
        }
    }, false);
    }

    function drawCanvas(){
    var canvas = document.getElementById('mycanvas');
    var ctx = canvas.getContext('2d');

    var lingrad = ctx.createLinearGradient(0,0,0,150);
    lingrad.addColorStop(0, '#000');
    lingrad.addColorStop(0.5, '#669');
    lingrad.addColorStop(1, '#fff');

    ctx.fillStyle = lingrad;

    ctx.fillRect(0, 0, canvas.width, canvas.height);

    var img = new Image();
    img.src = canvas.toDataURL("image/png");
    img.alt = 'downloaded-from-image';

    $(img).appendTo("body");

    }

   dragoutImages();
   drawCanvas(); 
```

这适用于作为 HTML 元素的文件，但我无法获取画布图像并使用该理论下载它。有没有人实现过这样的功能？

我已经使用 canvas.toDataURL 来获取图像数据，如果我发出警报，我会看到我的画布拖动开始的编码图像数据，但是当在浏览器之外时，图标会变回停止符号。

寻找有关如何实现这一点的方法和想法。

这是我设法实施并且效果很好的方法，

```
function download(e){
downloadImageData = eCanv.getImageData(750 - (scaledWidth / 2), 250 - (scaledHeight / 2), scaledWidth, scaledHeight);
dlcanvas = document.createElement('canvas');
dlcanvas.setAttribute('width',scaledWidth);
dlcanvas.setAttribute('height',scaledHeight);
dlcontext = dlcanvas.getContext("2d");
dlcontext.putImageData(downloadImageData, 0,0);
url = dlcanvas.toDataURL('image/jpg');
//name = document.getElementById("filename").value;
var mime = url.split(";")[0].split("data:")[1];
var name = mime.split("/")[0];
var ext = mime.split("/")[1] || "jpg";
var download = mime + ":" + name + "." + ext + ":" + url;
e.dataTransfer.setData("DownloadURL", download);        
} 
```

改编自 cssninja 和 Brian Grinstead 的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:42:19.280

不。

出于安全原因，Javascript*无法*写入本地文件系统。

Javascript 可以使用文件阅读器从本地文件系统读取：http: [//www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

它甚至可以写入沙盒浏览器文件（本地存储）：[http ://www.w3schools.com/html/html5_webstorage.asp](http://www.w3schools.com/html/html5_webstorage.asp)

您甚至可以将其从服务器上退回，然后询问用户是否要从服务器上下载图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-16T10:07:47.013

对于基于本地 Web 的应用程序，您可以使用或编写本地 Web 服务器或服务，或者利用例如 php 添加功能以从 javascript 与本地文件系统交互。似乎这被遗忘了，不禁止像浏览器一样在同一台机器上安装网络服务器:)

# sql - 记录三个表中的差异 - MS Access

> ID：15124295
> 
> 赞同：0
> 
> 时间：2013-02-27T23:07:13.970
> 
> 标签：sql, ms-access

我有三个表`Tab1`，`Tab2`并且`Tab3`具有几乎相同的结构（在 MS Access 中）。但是比. `Tab2`_`Tab3``Tab1`

`Tab2`并且`Tab3`是完全相同的结构。以下是加入键

```
col1
col2
col3 
```

基本上`Tab1`记录应该`Tab2`和`Tab3`在一起。如果我需要获取丢失的记录`Tab2`以及`Tab3`何时比较`Tab1`可能是有效的方法

感谢您的回复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:11:41.257

如果您只关心键，这是一个好方法：

```
select col1, sum(isTab1) as numTab1, sum(isTab2) as numTab2, sum(isTab3) as numTab3
from ((select col1 as col, 1 as isTab1, 0 as isTab2, 0 as isTab3 from tab1
      ) union all
      (select col2, 0 as isTab1, 1 as isTab2, 0 as isTab3 from tab2
      ) union all
      (select col3, 0 as isTab1, 0 as isTab2, 1 as isTab3 from tab3
      )
     ) t
group by col
having sum(isTab1)*sum(isTab2)*sum(isTab3) <> 1 
```

这将返回每个键值，并告诉您它们在哪些表中和不在三个表中的键。作为奖励，这还将告诉您是否有任何表具有重复键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:14:49.783

通常你会 SELECT FROM tab1 LEFT JOINing tab2 和 tab3 LEFT JOINed 一起。这样，您将从 tab1 获取所有记录。当 tab2 和 tab3 有一些缺失的记录时，会有空值。您可以在 WHERE 子句中检查空值

因此，查询看起来与此类似（请注意括号 - 这是 ms-access 的要求）：

```
SELECT * FROM
tab1 LEFT JOIN (tab2 LEFT JOIN tab3 ON tab2.col1 = tab3.col1 AND tab2.col2 = tab3.col2)
ON tab1.col1 = tab2.col1 AND tab1.col2 = tab2.col2 
WHERE tab2.col1 Is Null; 
```

# ssis - SSIS 等到执行进程任务完成

> ID：15124300
> 
> 赞同：0
> 
> 时间：2013-02-27T23:07:36.633
> 
> 标签：ssis

我有一个 ssis 包，它有两个对象：执行流程任务和数据流任务。

执行任务运行一个将数据插入到我的 sql 数据中的 .exe（这是一个漫长的过程）。此过程需要在下一个任务开始之前完成。但是，当 .exe 运行时，它会触发一个成功值（即使它没有完成），它会执行下一个任务。如何让数据流任务等待？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:50:51.993

您使两个不同的进程通过表中的条目相互通信。当进程 1 启动时，在表中写入一行。设置一个标志（Process1 未完成）。完成后，切换标志（过程 1 完成）。

将下一个任务 - 进程 2 置于循环中。在循环中检查标志。如果流程 1 完成 - 执行任务 2。

对于这种特定情况，返回一个值并将其存储为 StandardOutput。这将消除写入表的需要。

现在您有了三个潜在的解决方案，请尝试分享您的发现。

# objective-c - 无法访问显然来自情节提要的 UIWebView

> ID：15124301
> 
> 赞同：1
> 
> 时间：2013-02-27T23:07:40.443
> 
> 标签：objective-c, ios5, ios6, uiwebview, uipageviewcontroller

有一个视图，其中一个 UIWebview 处于纵向，两个较小的 UIWebView 处于横向 - 在横向中，两个视图代表一本书的页面，并且正在进行一些页面浏览量。我无法确定第二个 UIWebView 来自哪里。当超级视图以横向加载时，我只能访问左侧视图之一。右侧的视图完美地显示了正确的数据，但我无法从代码中访问它，直到某些原因导致屏幕重绘，例如页面被“翻转”或方向改变。这听起来很熟悉吗？

此外，我的 NSLog 功能不再工作，我不知道在哪里点击让它回来。请帮忙。

# 编辑

这是一些代码

```
// this is the function which is not accessing the view.
-(void) setCurrentTextSize:(int)cts {
     for(int pageViewIndex = 0; pageViewIndex < [arrayOfReaderViewControllers count]; pageViewIndex++) {
        readerViewController *r = [self arrayOfReaderViewControllers:pageViewIndex];
        [r setCurrentTextSize:cts];
        [r webViewDidFinishLoad:r.webView];
    }
}

//this function populates arrayOfReaderViewControllers
-(void)initializeArrayOfReaderViewControllers {
    readerViewController *vcLeft;
    if([self.delegate isFirstLoad]) {
        //we don't care what happens here 'cause it's not being called.
    } else {
        vcLeft = [readerViewController new];
        if ( lastPageNumber > currentPageNumber) {
            currentPageNumber        = lastPageNumber;
            [arrayOfReaderViewControllers replaceObjectAtIndex:0 withObject:[self jumpToPageVC:vcLeft]];
            if(self.isLandscape) {
                vcLeft  = [arrayOfReaderViewControllers objectAtIndex:0];
                [arrayOfReaderViewControllers replaceObjectAtIndex:1 withObject:[self getNextPageViewController:vcLeft]];
            }
        }
    }
    [self.delegate doMoreInitialization];
} 
```

# c# - 如何从 ac# 列表中提取单列？

> ID：15124302
> 
> 赞同：1
> 
> 时间：2013-02-27T23:07:50.180
> 
> 标签：c#, visual-studio-2010, list

我的代码定义了一个 LoginUser 对象，其中包含许多列 --`LoginUserId, UserName, ActiveFlag`等。我有一个`List<LoginUser>`这些对象。

现在，我的代码创建一个`List<int>`，然后遍历 ，依次`List<LoginUser>`将每个`LoginUserId`插入到`List<int>`中。

有没有更有效的方法来处理这个问题，或者有某种内置功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T23:09:26.660

您可以使用 LINQ：

```
var userIds = loginUser.Select(l => l.LoginUserId); 
```

`loginUser`您的 LoginUser 对象列表在哪里。

这将生成一个`IQueryable<int>`您可以按原样枚举或转换为列表（通过`.ToList()`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:15:16.100

使用 LINQ

```
List<int> userIds = (from user in userList
                select user.LoginUserId).ToList(); 
```

# ruby-on-rails - 为什么 Rails 不尊重我在 en.yml 中的日期格式？

> ID：15124307
> 
> 赞同：2
> 
> 时间：2013-02-27T23:08:14.763
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

我想要一个自定义格式，`:results`所以我可以`@obj.date.to_s(:results)`在我的视图中进行调用。

如果我将自定义格式放入初始化程序中，那么它可以工作：

```
Time::DATE_FORMATS[:results] = "%D" 
```

但是，如果我尝试将其放入我的`en.yml`文件中，则它不起作用（因为它不会按预期格式化）：

```
en:
  time:
    # See also config/initializers/time_formats.rb for lambda based configs
    formats:
      results: '%D'
  date:
    formats:
      default: '%m/%d/%Y"'
      results: '%D' 
```

我读到的一切都表明这应该有效。我错过了什么？

**编辑：**这基本上是[Rails 的副本，没有在 en.yml 中选择自定义日期和时间格式](https://stackoverflow.com/questions/12082665/rails-not-picking-up-custom-date-time-formats-in-en-yml?rq=1)所以我想问题是如何在 yml 中设置默认值而不是初始化（它更容易管理）。是否有内置方式，还是我需要手动加载 yaml 文件并`Time::DATE_FORMAT`自己设置哈希？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:57:39.423

答案是[Rails 没有在 en.yml 中选择自定义日期和时间格式](https://stackoverflow.com/questions/12082665/rails-not-picking-up-custom-date-time-formats-in-en-yml?rq=1)

您提到的第二种方式是使用 I18n（国际化），这意味着使用它您必须调用它。

在你看来你可以做

```
<%= l @obj.date, format: :result %> 
```

# python - Django cookie 和标头

> ID：15124308
> 
> 赞同：6
> 
> 时间：2013-02-27T23:08:16.913
> 
> 标签：python, django, cookies

在 Django（和一般情况下）中，cookie 也是一个标题，就像，例如`User-Agent`？
也就是说，这两种方法在 Django 中是等价的吗？

**使用`set_cookie`：**

```
response.set_cookie('food', 'bread')
response.set_cookie('drink', 'water') 
```

**使用标题设置：**

```
response['Cookie'] = ('food=bread; drink=water')
# I'm not sure whether 'Cookie' should be capitalized or not 
```

另外，如果我们可以使用第二种方式设置 cookie，我们如何在字符串中包含附加信息，
如`path`,`max_age`等？我们应该用一些特殊
字符将它们分开吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T02:06:00.907

如果你使用它会容易得多`set_cookie`。但是是的，您可以通过设置响应标头来设置 cookie：

```
response['Set-Cookie'] = ('food=bread; drink=water; Path=/; max_age=10') 
```

`Set-Cookie`但是，由于在对象中重置`response`会清除前一个，因此在 Django 中不能有多个`Set-Cookie`标题。让我们看看为什么。

[在response.py 中`set_cookie`](https://github.com/django/django/blob/master/django/http/response.py#L146)观察，[方法](https://github.com/django/django/blob/master/django/http/response.py#L146)：

```
class HttpResponseBase:

    def __init__(self, content_type=None, status=None, mimetype=None):
        # _headers is a mapping of the lower-case name to the original case of
        # the header (required for working with legacy systems) and the header
        # value. Both the name of the header and its value are ASCII strings.
        self._headers = {}
        self._charset = settings.DEFAULT_CHARSET
        self._closable_objects = []
        # This parameter is set by the handler. It's necessary to preserve the
        # historical behavior of request_finished.
        self._handler_class = None
        if mimetype:
            warnings.warn("Using mimetype keyword argument is deprecated, use"
                          " content_type instead",
                          DeprecationWarning, stacklevel=2)
            content_type = mimetype
        if not content_type:
            content_type = "%s; charset=%s" % (settings.DEFAULT_CONTENT_TYPE,
                    self._charset)
        self.cookies = SimpleCookie()
        if status:
            self.status_code = status

        self['Content-Type'] = content_type

    ...

    def set_cookie(self, key, value='', max_age=None, expires=None, path='/',
                   domain=None, secure=False, httponly=False):
        """
        Sets a cookie.

        ``expires`` can be:
        - a string in the correct format,
        - a naive ``datetime.datetime`` object in UTC,
        - an aware ``datetime.datetime`` object in any time zone.
        If it is a ``datetime.datetime`` object then ``max_age`` will be calculated.

        """
        self.cookies[key] = value
        if expires is not None:
            if isinstance(expires, datetime.datetime):
                if timezone.is_aware(expires):
                    expires = timezone.make_naive(expires, timezone.utc)
                delta = expires - expires.utcnow()
                # Add one second so the date matches exactly (a fraction of
                # time gets lost between converting to a timedelta and
                # then the date string).
                delta = delta + datetime.timedelta(seconds=1)
                # Just set max_age - the max_age logic will set expires.
                expires = None
                max_age = max(0, delta.days * 86400 + delta.seconds)
            else:
                self.cookies[key]['expires'] = expires
        if max_age is not None:
            self.cookies[key]['max-age'] = max_age
            # IE requires expires, so set it if hasn't been already.
            if not expires:
                self.cookies[key]['expires'] = cookie_date(time.time() +
                                                           max_age)
        if path is not None:
            self.cookies[key]['path'] = path
        if domain is not None:
            self.cookies[key]['domain'] = domain
        if secure:
            self.cookies[key]['secure'] = True
        if httponly:
            self.cookies[key]['httponly'] = True 
```

这里有两点值得注意：

1.  `set_cookie`方法将为您处理`datetime`，`expires` 如果您自己设置，则必须自己设置。
2.  `self.cookie`是字典的字典。所以每个`key`人都会在标题中添加一个`["Set-Cookie"]`，你很快就会看到。

然后里面的`cookies`对象`HttpResponse`将被传递给 [`WSGIHandler`](https://github.com/django/django/blob/master/django/core/handlers/wsgi.py#L224)，并被附加到响应头中：

```
response_headers = [(str(k), str(v)) for k, v in response.items()]
for c in response.cookies.values():
    response_headers.append((str('Set-Cookie'), str(c.output(header='')))) 
```

上面的代码也是为什么只`set_cookie()`允许`Set-Cookie`在响应头中使用多个，而直接将 cookie 设置为`Response`对象只会返回一个`Set-Cookie`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:18:14.290

当然可以，但是将“Cookie”更改为“Set-Cookie”并添加“Path=/”以使其在站点范围内。

```
response["Set-Cookie"] = "food=bread; drink=water; Path=/" 
```

**编辑：**

在自己尝试后，我发现了一个有趣的怪癖，`set_cookie`它不会将相似的 cookie（相同的路径、过期、域等）组合在同一个标​​头中。它只是在响应中添加了另一个“Set-Cookie”。可以理解，因为检查和弄乱字符串可能比在 HTTP 标头中添加一些额外的字节要花费更多的时间（并且充其量只是一个微优化）。

```
response.set_cookie("food",  "kabanosy")
response.set_cookie("drink", "ardbeg")
response.set_cookie("state", "awesome")

# result in these headers
#   Set-Cookie: food=kabonosy; Path=/
#   Set-Cookie: drink=ardbeg; Path=/
#   Set-Cookie: state=awesome; Path=/

# not this
#   Set-Cookie:food=kabanosy; drink=ardbeg; state=awesome; Path=/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T00:36:47.823

类代码的片段**`HttpResponse`**：

```
class HttpResponse(object):

    #...

    def __init__(self, content='', mimetype=None, status=None,

        #...

        self.cookies = SimpleCookie()

    #...

    def set_cookie(self, key, value='', max_age=None, expires=None, path='/',
                   domain=None, secure=False, httponly=False):

        self.cookies[key] = value

        #... 
```

也就是说，无论何时`response.set_cookie()`调用，它要么在该键处放置一个新的 cookie
`value`，`response.cookies[key]`要么更改现有值（如果该键上有一个）。
它解释了为什么它设置多个`Set-Cookie`标题。
我想知道我们怎么能用`response['Set-Cookie']`.

# c# - 局部视图中的 .Net mvc 表单调用了错误的控制器

> ID：15124310
> 
> 赞同：0
> 
> 时间：2013-02-27T23:08:24.610
> 
> 标签：c#, asp.net-mvc, razor

我有这个表格

```
@using (Html.BeginForm("SendEmail", "Bids", FormMethod.Post, new { @id = "EmailForm" }))
{
    @Html.EditorFor(o => o.AddedVendors)
    @Html.HiddenFor(o => o.BidID)
    @Html.LabelFor(o => o.Negotiation)
    <br />
    @Html.EditorFor(o => o.Negotiation)
    <br />
    @Html.LabelFor(o => o.Subject)
    <br />
    @Html.EditorFor(o => o.Subject)
    <br />
    @Html.LabelFor(o => o.Body)
    <br />
    @Html.EditorFor(o => o.Body, "TextArea")
    <br />
    @Html.LabelFor(o => o.From)
    <br />
    @Html.EditorFor(o => o.From)
    <br />
    <input type="submit" value="Send" />
} 
```

在标题`_BidEmail`为`Bids`.

提交此表单时，它会调用控制器`Bids/SendEmail`以及控制器`Bids/_BidEmail`。为什么是这样？

如果我使用`$("#EmailForm").submit(function(){return false;});`它不会调用`SendEmail`但仍会调用`_BidEmail`.

# oracle11g - 选择具有相同 id 的多个表

> ID：15124314
> 
> 赞同：2
> 
> 时间：2013-02-27T23:08:35.823
> 
> 标签：oracle11g

我只需要从四个表中选择一个数据。

在我**的“计算”**表中，我有我需要的所有记录。

**但我需要从'programs'**、**'term'**和**'imported'**表中检索每条记录的其他信息。

**'calculated'**具有来自**'programs' 的**ID 。

但是，要从**'imported'**获得记录，我需要加入**'item'**表，因为 'item' 具有来自**'programs'**和来自**'imported' 的**ID 。

**'term'**具有来自**'imported' 的**ID 。

所以，我尝试了这个：

```
select  c.date,
    p.name,
    c.name1,
    c.name2,
    t.date,
    i.version,
    c.price1,
    c.price2,
    c.price3
from calculated c, programs p, term t, imported i, item it
where c.programs_id = p.programs_id
    and c.programs_id = it.programs_id
    and it.imported_id = i.imported_id
    and i.term_id = t.term_id; 
```

**但是当我在'calculated'**上使用 count(*) 时，我得到了 30k 条记录，并且从我的 select 语句中我得到了超过 1.3 亿条记录。

我究竟做错了什么？

我应该怎么做才能使它起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T01:03:50.780

你忘了加入`term`表。

可能你需要添加

```
and t.term_id = i.term_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T21:03:21.353

如果所有重复的行都是等价的，你可以像这样尝试

```
select  c.date,
    p.name,
    c.name1,
    c.name2,
    t.date,
    i.version,
    c.price1,
    c.price2,
    c.price3
from calculated c, programs p, term t, imported i
where c.programs_id = p.programs_id and
(select imported_id from item it where c.programs_id = it.programs_id and rownum = 1) = i.imported_id
and i.term_id = t.term_id; 
```

其中“rownum = 1”是对 oracle 选择一行的限制。

# c# - 我正在创建一个电子邮件应用程序，但我不知道要使用什么控件

> ID：15124315
> 
> 赞同：0
> 
> 时间：2013-02-27T23:08:37.010
> 
> 标签：c#, winforms

所以当用户登录时，应用程序会进入收件箱页面。并且将显示每条消息的主题和发件人。当用户选择一封电子邮件时，它就会打开。所以我的问题是我应该使用什么控件来显示主题和发件人？

我正在考虑使用标签链接，但随后每封电子邮件都会为每封电子邮件有一个事件（肯定是错误的）

我想使用 GridView 之类的东西，这对于 asp.net 网站来说非常容易，但我不知道 windowsform 是否可以相同。

如果 Gridview 是答案，你能告诉我如何创建行，以及当用户选择电子邮件时如何获取选定的行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:14:41.380

（数据）GridView 可以工作。

您可以使用 Click 或 SelectionChanged 等事件以及 SelectedRows[ ] 等值。

您可以手动创建行或将 DataTable 绑定为 DataSource（这将更容易处理）。

数据网格视图：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx) 数据表：http: [//msdn.microsoft.com/en-us/library/system.data.datatable .aspx](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)

# ember.js - Ember.js 多对多关系。如何访问数据

> ID：15124317
> 
> 赞同：3
> 
> 时间：2013-02-27T23:08:43.317
> 
> 标签：ember.js, ember-data

我们正在开发一个消息系统，该系统将允许用户向许多社交媒体帐户提交消息，这将导致每个帐户都有帖子。在我们的应用程序中，我们有帐户、消息和帖子。消息是我的内容的单个实例，然后可以作为帖子发送。

帐户可以有许多消息。

消息可以绑定到多个帐户。消息可以有多个帖子。

帖子属于消息。

我们像这样对数据进行建模：

```
Social.Account = DS.Model.extend({
    username: DS.attr('string'),
    messages: DS.hasMany('Social.Message')
});

Social.Message = DS.Model.extend({
    user_id: DS.attr('number'),
    text: DS.attr('string'),
    accounts: DS.hasMany('Social.Account'),
    posts: DS.hasMany('Social.Post')
});

Social.Post = DS.Model.extend({
    created: DS.attr('date'),
    text: DS.attr('string'),
    message: DS.belongsTo('Social.Message')
}); 
```

和 FIXTURE 数据看起来像这样：

```
Social.Account.FIXTURES = [{
    id: 1,
    username: "commadelimited",
    messages: [1, 2]
}];

Social.Message.FIXTURES = [{
    id: 1,
    user_id: 1,
    text: 'This is message #1 sent by account #1',
    accounts: [1],
    posts: [1]
}, {
    id: 2,
    user_id: 1,
    text: 'This is message #2 sent by account #1',
    accounts: [1],
    posts: [2]
}];

Social.Post.FIXTURES = [{
    id: 1,
    created: "5 minutes ago",
    text: 'This is post #1 sent by account #1, tied to message #1'
}, {
    id: 1,
    created: "5 minutes ago",
    text: 'This is post #2 sent by account #1, tied to message #2'
}]; 
```

即使在我们的系统中，消息可能会导致人工帖子，但就 UI 而言，消息是一对一的关系。

当我必须首先遍历 Message 开始时，我无法考虑如何输出结果 Post。此代码正确输出消息，但我需要输出帖子。

```
{{#each messages in messages}}
    <article>
        <time>{{post.ts}}</time>
        <div class="post-content">
            <h2>{{post.text}}</h2>
        </div>
    </article>
{{/each}} 
```

我试过`{{#each messages in messages.posts}}`了，没什么。在每个循环中，我在`{{message}}`返回的循环中输出`<Social.Message:ember391:1>`。我可以使用此语句在控制台中访问 Post 数据

`Social.Account.find().objectAt(0).get('messages').objectAt(0).get('posts')`

它返回正确类型的对象。

那么，如何获取每条消息的 Post 数组？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T23:36:35.620

> 那么，如何获取每条消息的 Post 数组？

您可以通过每条消息的 posts 属性访问 post 数组。所以在车把中：

```
{{#each message in messages}}
  <p>Message: {{message}}</p>
  <p>Message posts: {{message.posts}}</p>
  {{#each post in message.posts}}
    <article>
        <time>{{post.ts}}</time>
        <div class="post-content">
            <h2>{{post.text}}</h2>
        </div>
    </article>
  {{/each}}
{{/each}} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T02:04:08.420

我的示例可能比您想要的更“完成”，但因为我知道您正在使用 django 后端工作......这是整个 m2m 设置（使用 ember.js 和 django-rest-framework）

首先 - django 模型

```
class Tag(models.Model):
    description = models.CharField(max_length=200)

class Session(models.Model):
    name = models.CharField(max_length=150)
    tags = models.ManyToManyField(Tag) 
```

基本的“查找所有”和“查找每个标签”网址

```
url(r'^/sessions/$', views.SessionList.as_view()),
url(r'^/sessions/(?P<session_pk>\d+)/tags/$', views.TagBySessionList.as_view()), 
```

django 视图（如果您愿意，启用 django-rest-framework）

```
from rest_framework import generics
class SessionList(generics.ListCreateAPIView):
    model = Session
    serializer_class = SessionSerializer

class TagBySessionList(generics.ListCreateAPIView):
    model = Tag
    serializer_class = TagSerializer

    def get_queryset(self):
        session_pk = self.kwargs.get('session_pk', None)
        if session_pk is not None:
            return Tag.objects.filter(session__pk=session_pk)
        return [] 
```

现在使用 django-rest-framework 序列化程序来获取 REST api 设置

```
from rest_framework import serializers
class SessionSerializer(serializers.ModelSerializer):
    tags = serializers.ManyPrimaryKeyRelatedField()

    class Meta:
        model = Session
        fields = ('id', 'name', 'tags')

class TagSerializer(serializers.ModelSerializer):
    class Meta:
        model = Tag
        fields = ('id', 'description') 
```

接下来 - ember-data 模型（注意 - 这里没有夹具适配器，真正的 REST api 调用）

```
CodeCamp.Session = DS.Model.extend({
  name: DS.attr('string'),
  tags: DS.hasMany('CodeCamp.Tag')
});

CodeCamp.Tag = DS.Model.extend({
  description: DS.attr('string')
}); 
```

简单加载父元素的根元素（基本全部查找）

```
CodeCamp.SessionsRoute = Ember.Route.extend({
  model: function() {
      return CodeCamp.Session.find();
  }
}); 
```

（无需在此处询问 m2m，因为 DjangoRESTAdapter 会处理给定上述端点的问题）

确实显示父级及其下的每个标签的车把模板（m2m 每个工作）

```
{{#each session in controller}}
  {{session.name}}<br />
  {{#each tag in session.tags}}
    {{tag.description}}<br />
  {{/each}}
{{/each}} 
```

# python - ndarray 中最大值的索引列表

> ID：15124318
> 
> 赞同：2
> 
> 时间：2013-02-27T23:08:44.993
> 
> 标签：python, numpy, indexing

我有一个ndarray。从这个数组中，我需要选择具有最大值的 N 个数字的列表。我发现`heapq.nlargest`找到了 N 个最大的条目，但我需要提取索引。我想构建一个新数组，其中只有第一列中权重最大的 N 行才能存活。其余行将被随机值替换

```
import numpy as np
import heapq   # For choosing list of max values
a = [[1.1,2.1,3.1], [2.1,3.1,4.1], [5.1,0.1,7.1],[0.1,1.1,1.1],[4.1,3.1,9.1]]
a = np.asarray(a)
maxVal = heapq.nlargest(2,a[:,0])

if __name__ == '__main__':
    print a
    print maxVal 
```

我的输出是：

```
[[ 1.1  2.1  3.1]
[ 2.1  3.1  4.1]
[ 5.1  0.1  7.1]
[ 0.1  1.1  1.1]
[ 4.1  3.1  9.1]]

[5.0999999999999996, 4.0999999999999996] 
```

但我需要的是`[2,4]`作为构建新数组的索引。索引是行，所以如果在这个例子中我想用 0 替换其余部分，我需要完成：

```
[[0.0  0.0  0.0]
[ 0.0  0.0  0.0]
[ 5.1  0.1  7.1]
[ 0.0  0.0  0.0]
[ 4.1  3.1  9.1]] 
```

我被困在需要索引的地方。原始数组有 1000 行和 100 列。权重是归一化的浮点数，我不想做类似的事情，`if a[:,1] == maxVal[0]:`因为有时我的权重非常接近，并且可以完成`maxVal[0]`比我原来的 N更多的值。

是否有任何简单的方法可以在此设置中提取索引以替换数组的其余部分？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T23:18:48.190

如果您只有 1000 行，我会忘记堆并`np.argsort`在第一列上使用：

```
>>> np.argsort(a[:,0])[::-1][:2]
array([2, 4]) 
```

如果你想把它们放在一起，它看起来像：

```
def trim_rows(a, n) :
    idx = np.argsort(a[:,0])[:-n]
    a[idx] = 0

>>> a = np.random.rand(10, 4)
>>> a

array([[ 0.34416425,  0.89021968,  0.06260404,  0.0218131 ],
       [ 0.72344948,  0.79637177,  0.70029863,  0.20096129],
       [ 0.27772833,  0.05372373,  0.00372941,  0.18454153],
       [ 0.09124461,  0.38676351,  0.98478492,  0.72986697],
       [ 0.84789887,  0.69171688,  0.97718206,  0.64019977],
       [ 0.27597241,  0.26705301,  0.62124467,  0.43337711],
       [ 0.79455424,  0.37024814,  0.93549275,  0.01130491],
       [ 0.95113795,  0.32306471,  0.47548887,  0.20429272],
       [ 0.3943888 ,  0.61586129,  0.02776393,  0.2560126 ],
       [ 0.5934556 ,  0.23093912,  0.12550062,  0.58542137]])
>>> trim_rows(a, 3)
>>> a

array([[ 0\.        ,  0\.        ,  0\.        ,  0\.        ],
       [ 0\.        ,  0\.        ,  0\.        ,  0\.        ],
       [ 0\.        ,  0\.        ,  0\.        ,  0\.        ],
       [ 0\.        ,  0\.        ,  0\.        ,  0\.        ],
       [ 0.84789887,  0.69171688,  0.97718206,  0.64019977],
       [ 0\.        ,  0\.        ,  0\.        ,  0\.        ],
       [ 0.79455424,  0.37024814,  0.93549275,  0.01130491],
       [ 0.95113795,  0.32306471,  0.47548887,  0.20429272],
       [ 0\.        ,  0\.        ,  0\.        ,  0\.        ],
       [ 0\.        ,  0\.        ,  0\.        ,  0\.        ]]) 
```

对于您的数据大小，它可能足够快：

```
In [7]: a = np.random.rand(1000, 100)

In [8]: %timeit -n1 -r1 trim_rows(a, 50)
1 loops, best of 1: 7.65 ms per loop 
```

# javascript - Jquery $.Ready 函数的最佳实践

> ID：15124319
> 
> 赞同：0
> 
> 时间：2013-02-27T23:08:45.993
> 
> 标签：javascript, jquery, asp.net-mvc, partial-views

我有很多可以在多个页面上重用的 MVC3.0 部分视图。每个部分视图都有自己的带有 JQuery $.Ready 函数的 JavaScript。

我想知道是否有人可以帮助我了解`$.ready`以下使用的最佳做法：

1.  我是否应该创建 Ready.js ，其中包含应该进行的所有事件/功能`$.ready`？并参考主布局页面。

2.  或者每个页面都应该有自己的。

3.  当`$.ready`函数执行并且由于部分视图页面未用于该页面而找不到被引用的元素时会发生什么。

4.  一般来说，组织 JavaScript 的最佳实践是什么，即每个页面/小部件/控件的 js？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T04:11:00.503

使用这篇[文章](http://net.tutsplus.com/tutorials/javascript-ajax/14-helpful-jquery-tricks-notes-and-best-practices/)

> ```
> $(document).ready(function() {  
>     // let's get up in heeya  
> }); 
> ```
> 
> 不过，您很有可能遇到了一个不同的、更令人困惑的包装函数。
> 
> ```
> $(function() {  
>     // let's get up in heeya  
> }); 
> ```
> 
> 尽管后者的可读性稍差，但上面的两个片段是相同的。不相信我？只需检查 jQuery 源代码。
> 
> ```
> // HANDLE: $(function)  
> // Shortcut for document ready  
> if ( jQuery.isFunction( selector ) ) {  
>     return rootjQuery.ready( selector );  
> } 
> ```
> 
> rootjQuery 只是对根 jQuery（文档）的引用。当您将选择器传递给 jQuery 函数时，它将确定您传递的选择器类型：字符串、标记、id、函数等。如果传递了一个函数，jQuery 将调用其 ready() 方法，并传递您的匿名函数作为选择器。

# javascript - 如何重定向修改标题？

> ID：15124320
> 
> 赞同：1
> 
> 时间：2013-02-27T23:08:48.130
> 
> 标签：javascript

我想使用像*document.location="stackoverflow.com"*这样的 JavaScript 进行重定向，但要修改标头，特别是 Referer 标头。那么，有没有办法使用 Javascript 修改重定向的标头进行重定向？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:12:33.003

不，你不能。要修改响应的标头，您必须在服务器端。Javascript在客户端。

# python - python tkinter 按钮事件

> ID：15124321
> 
> 赞同：1
> 
> 时间：2013-02-27T23:08:50.343
> 
> 标签：python, button, gridview, tkinter

我编写了以下代码来列出给定路径中的所有目录/文件，然后将它们写入按钮。我如何使用 tkinter 的事件处理程序，以便每当在小部件窗口中双击任何按钮时，它都会调用一个新函数。

```
def display_toplevel(globpath):
    global row, column
    dir=globpath
    dirs = os.listdir(dir)
    for file in dirs:
        Button(master, width=8, height=4, text=file).grid(row=row, column=column, padx=10, sticky=W)
        column = column + 2
        if column == 10:
            row = row + 3
            column = 0
            column = column + 2
            break 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:18:45.750

这适用于单击；在创建按钮的代码中，添加`command = # function`参数：

```
Button(master, width=8, height=4, text=file,command=my_funct).grid(row=row, column=column, padx=10, sticky=W)
# note how the function does not have parentheses (after command=) 

def my_funct():
    # code 
```

参考：[Tkinter 按钮小部件和参数](http://www.tutorialspoint.com/python/tk_button.htm)

# c - 无效的写入大小为 4

> ID：15124323
> 
> 赞同：1
> 
> 时间：2013-02-27T23:08:54.900
> 
> 标签：c, memory-management, valgrind

这是有问题的代码：

```
long number = atol(argv[1]);
long prime_limit = number / 2;
int * primes = malloc(sizeof(int) * prime_limit);
long i;
for (i = 2; i <= prime_limit; i++) {
    primes[i] = 1; # This is line 16
} 
```

以下是错误：

```
==9318== Invalid write of size 4
==9318==    at 0x40065B: main (003.c:16)
==9318==  Address 0x8 is not stack'd, malloc'd or (recently) free'd
==9318== 
==9318== 
==9318== Process terminating with default action of signal 11 (SIGSEGV)
==9318==  Access not within mapped region at address 0x8
==9318==    at 0x40065B: main (003.c:16)
==9318==  If you believe this happened as a result of a stack
==9318==  overflow in your program's main thread (unlikely but
==9318==  possible), you can try to increase the size of the
==9318==  main thread stack using the --main-stacksize= flag.
==9318==  The main thread stack size used in this run was 8388608. 
```

我相信错误必须是我使用 malloc 的方式，但我不太确定。argv[1] 的值为 600851475143。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T23:09:39.153

数组是`0`C 中的 -origin：

```
i <= prime_limit; 
```

应该

```
i < prime_limit; 
```

否则`atol`不安全，无法进行错误检测。用于`strtol`将字符串转换为`long`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T00:18:11.870

您的分配失败：

```
=9318==  Address 0x8 is not stack'd, malloc'd or (recently) free'd 
```

...哪种有意义，因为您正在尝试分配 600851475143 * 4 / 2，或 1201702950288 字节或 1.2TB。

`primes`因此`NULL`，您尝试在执行时取消引用它`primes[i]`，从而导致未定义的行为。

为了比较，如果你写的东西超出了正确分配的内存块的范围，Valgrind 会给出类似于以下内容的输出：

```
==10088==  Address 0x51f104c is 0 bytes after a block of size 12 alloc'd 
```

**始终检查的返回值`malloc`**：

```
int * primes = malloc(sizeof(int) * prime_limit);
if (primes == NULL) {
    perror("Allocation failure!");
    /* handle error */
} 
```

并且不要试图一次性分配 1TB...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:43:33.880

除了 ouah 发布的内容之外，我认为您应该检查 malloc() 返回的指针值。您可能无法分配您请求的内存量。

# jquery - 检查选项卡上的单选按钮

> ID：15124326
> 
> 赞同：0
> 
> 时间：2013-02-27T23:08:58.010
> 
> 标签：jquery, forms, radio-button, jquery-events

如果我通过包含单选按钮的表单元素进行选项卡，当我进入单选按钮时，有没有办法选择（检查）单选按钮？当我进入文本字段时，它会获得一个焦点，这在视觉上很清晰，但不是单选按钮。我认为使用 jQuery 应该是可能的。

这将选择它但不是焦点，稍后单击

```
$(':input:visible').keypress(function(event) {
       if(event.keyCode == '9' && $(this).is(':radio')) { // Tab
            $(this).attr('checked', true);
       }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:38:16.580

您可以尝试处理该`focus`事件：

```
$(':radio').focus(function () {
    this.checked = true;
}); 
```

[jsFiddle 演示](http://jsfiddle.net/q9Hq9/)

# javascript - 即使关闭弹出层，弹出页面上的视频仍在播放

> ID：15124335
> 
> 赞同：0
> 
> 时间：2013-02-27T23:09:43.453
> 
> 标签：javascript, css, youtube, soundcloud, popupwindow

我的网站上有一个弹出层，上面显示最新消息。现在我想在上面嵌入一个 YouTube 视频，一旦用户打开网站就会播放。我希望它在用户关闭弹出页面后停止播放。我试过 SoundCloud 播放器，当我关闭它时它会停止。

[这是实时链接。](http://tinyurl.com/a49cohf)

您也可以在此处下载文件源文件 (.zip)： [源文件](http://tinyurl.com/popup-test-zip)

所以我想让视频在用户关闭弹出页面时停止播放。

任何的想法？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T13:06:05.090

朋友们

不要试图关闭 facebox/fancybox 弹出窗口。尝试创建一个包含视频文件/嵌入代码的容器。单击关闭链接后，只需删除该嵌入/视频文件容器的 HTML。

前任。`<div id="myVideoFilePlay">Video File/Embed Data</div>`

脚本文件：

```
document.getElementById('remodeVideoPlayer').innerHTML =""; 
```

之后关闭花哨的盒子

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:38:18.643

以下是有关嵌入 YouTube 的自动播放功能的一些信息。

[http://support.google.com/youtube/bin/answer.py?hl=en&answer=1181821](http://support.google.com/youtube/bin/answer.py?hl=en&answer=1181821)

“要使其自动播放，只需将 &autoplay=1 放在视频 ID 之后，如下所示：”

```
<object width="425" height="350">
<param name="movie" value="http://www.youtube.com/v/XXXXXXX&autoplay=1"></param>
<embed src="http://www.youtube.com/v/XXXXXXX&autoplay=1" type="application/x-shockwave-flash" width="425" height="350">
</embed></object> 
```

至于停止视频，我建议你看看这里并设置一些简单的功能来做点击“X”时的暂停。请参阅：[隐藏 iframe 时如何暂停 YouTube 播放器？](https://stackoverflow.com/questions/8667882/how-to-pause-a-youtube-player-when-hiding-the-iframe)

**编辑：添加了更多信息..**

我可以看到您在站点加载时将 jQuery 设置为 #dialogjj，然后 HTML 位于 div 内部，因此将其设置为 display:none; 它不会停止播放。我有一个让它工作的想法 - 可能会有更好的 jQuery 更好，但这工作正常。不幸的是，由于提出问题的方式/不太容易调查，我觉得没有人会进一步回答。这也许就是为什么您对这个问题投反对票的原因，看看其他人如何在此处提出问题以获取未来指南，它通常不仅仅是提供指向您的网站的链接以期望人们查看，而是尝试指出您的问题和您所拥有的尝试过让其他人对此有所了解，但我们都从某个地方开始，所以不要担心:)。

我的想法是您实际上使用 jQuery 设置了 FOR #dialogjj 的内容（因此嵌入代码是通过 JS 文件而不是 HTML 页面放入的），并且您可以以同样的方式实际附加它以摆脱该嵌入代码。我已经设置了一个简单的 JSfiddle，它可以按照您想要的方式执行此操作。不过，您可以将其合并到您的代码中:)

**JS Fiddle 链接[http://jsfiddle.net/ivandude/vLrvA/2/](http://jsfiddle.net/ivandude/vLrvA/2/)**

如果您喜欢该解决方案，请单击打勾作为答案：D 我的第一个也许.. 哈哈

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T14:35:34.533

答案真的很简单。当我使用旧的对象嵌入代码时，它就可以工作了。感谢您提出的解决方案，但它适用于 iframe。但不需要任何额外的代码。

# php - 扩展如何在不强制用户安装服务器和 php 的情况下与数据库交互

> ID：15124338
> 
> 赞同：0
> 
> 时间：2013-02-27T23:10:03.657
> 
> 标签：php, javascript, database, google-chrome-extension

我正在编写一个 Chrome 扩展程序，它将一些数据发送到 PHP 文件，然后 PHP 文件将其发送到数据库。

一切都很好，但我只想问我的用户是否需要在他们的机器上安装 PHP 以及服务器，才能使扩展工作？

根据一些帖子它确实如此（[例如](https://stackoverflow.com/questions/10186009/ajax-responsetext-returns-my-entire-php-code-locally)）。但如果确实如此，那么扩展如何在不强制用户安装服务器和 PHP 的情况下与数据库交互。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:13:29.360

php 是一种服务器端脚本语言，这意味着所有处理都在您的服务器上完成。没有理由任何用户都需要安装任何东西才能访问 php 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:40:27.593

您可能想查看 WebSQL ( [http://en.wikipedia.org/wiki/Web_SQL_Database](http://en.wikipedia.org/wiki/Web_SQL_Database) )。它不再开发（并且仍未完成），但根据这篇 Wikipedia 文章，它基于 SQLite 和 chrome 支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T02:03:04.710

您可以在扩展中使用 JS 与数据库 (IndexedDB) 进行交互。

资源：

*   [我可以用吗...](http://caniuse.com/#feat=indexeddb)
*   [索引数据库 | MDN](https://developer.mozilla.org/en-US/docs/IndexedDB)

由于您正在制作 Chrome 扩展程序，因此可能无需担心跨浏览器支持，但根据[HTML5 Please](http://html5please.com/#indexeddb)，建议使用 polyfill。

# coldfusion - CFIMAP 从所有文件夹中读取电子邮件

> ID：15124339
> 
> 赞同：3
> 
> 时间：2013-02-27T23:10:12.730
> 
> 标签：coldfusion, imap, coldfusion-9

我每天都在使用 CFIMAP 下载电子邮件附件。尽管到目前为止我已经尝试过，但脚本是从我的所有文件夹中读取电子邮件，而不是仅从收件箱中读取。有人知道怎么修这个东西吗？

这是我的代码：

```
 <cfimap 
        server = "mail.example.com" 
        username = "user@sexample.com" 
        action="open" 
        secure="yes" 
        password = "pass" 
        connection = "mail.example.com" >

      <cfimap   
        action="GetAll" 
        folder="Inbox"  
        name="test"
        attachmentpath="e:\testfolder" 
        GenerateUniqueFilenames="yes"
        connection="mail.example.com" >

    <cfimap 
        action="MoveMail" 
        newfolder="processedEmails" 
        stoponerror="true" 
        connection="mail.example.com">

   <cfimap action="close" connection = "mail.example.com"> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T07:17:13.967

你可以试试下面的代码..

```
<cfimap action="open" connection="Conn" server="serverurl" username="useremail"      password="passwrd" secure="yes" port="">
<cfimap action="getall" connection="Conn" name="getAttachments" folder="Inbox" attachmentpath="#GetTempDirectory()#" >

<cfquery dbtype="query" name="getMailAttachments">
    select * 
  from getAttachments 
  where seen=<cfqueryparam value="no" cfsqltype="cf_sql_varchar"> 
   and ATTACHMENTS is not null
</cfquery>
<cfloop query="getMailAttachments">
   <cfimap action="MarkRead" connection = "Conn" uid="#getMailAttachments.UID#">
   <cfimap action="movemail" connection = "Conn"  newfolder="Read mails" uid="#getMailAttachments.UID#">
</cfloop> 
```

# git - github，更改丢失

> ID：15124345
> 
> 赞同：0
> 
> 时间：2013-02-27T23:10:42.767
> 
> 标签：git, github

我对我的本地 github 存储库进行了一些更改。

我试图推动：

```
git push --force origin 
```

但是现在我的硬盘上的所有更改都丢失了，并且存储库的外观与我的远程 github 相同，我该怎么做才能恢复上一个版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T16:56:47.253

如果您真的*丢失了*本地存储库并且没有其他人拥有副本，那么不幸的是，将无法恢复您的历史记录。如果您只是*认为*您在本地丢失了它，但它仍然是同一个存储库，那么您很可能可以重置为实际上仍然包含所有提交的旧 HEAD。

您可以使用`git reflog`. 它将显示对 HEAD 指针的更改。如果你看到一个提交是你的旧版本，你可以通过`git reset --hard HEAD@{n}`where `n`is the number from the reflog 将你的 HEAD 重置为那个版本。

# wcf - 如何从身份验证代理后面运行 svcutil.exe

> ID：15124350
> 
> 赞同：8
> 
> 时间：2013-02-27T23:11:09.557
> 
> 标签：wcf, svcutil.exe

我想运行该`svcutil.exe`工具来访问 Internet 上的 Web 服务。不幸的是，每当我尝试时，都会收到一堆错误，其中包括以下消息：

> 请求失败，HTTP 状态为 407：需要代理身份验证（ISA 服务器需要授权才能完成请求。对 Web 代理过滤器的访问被拒绝。

正如我从[这篇相关文章](https://stackoverflow.com/a/8180854/93394)中了解到的（[这里有更多详细信息](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2397357-fix-it-so-that-net-apps-can-access-http-thru-auth)），问题是我坐在身份验证代理后面。那篇文章解释说我需要编辑`app.config`文件，但我不知道该怎么做。我想我会使用这个 `/svcutilConfig:alternate_app.config`开关，但我不知道如何构造一个有效的 .config 文件来传递给那个开关。svcutil.exe 使用的默认 app.config 文件是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-27T23:14:33.830

好吧，我想我已经找到了问题的答案：

事实证明，使用的默认`.config`文件`svcutil.exe`被称为`svcutil.exe.config`，并且（至少对我而言）它位于此文件夹中：

```
C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin 
```

我决定直接编辑该文件（而不是摸索`/svcutilConfig`开关）。我需要管理员权限才能这样做。

该文件的最终内容如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <runtime>
    <generatePublisherEvidence enabled="false" />
  </runtime>
  <system.net> 
    <defaultProxy useDefaultCredentials="true" /> 
  </system.net>
</configuration> 
```

`<system.net>`（用元素埋藏的秘方。）

为了让这一切正常工作，我必须以*管理员*身份启动命令提示符，导航到上面列出的文件夹，然后从那里运行 svcutil.exe 命令。

希望这可以帮助其他陷入困境的可怜的灵魂！感谢@AndrewWebb 为我提供的线索！

# c# - 如何使用外键将 SimpleMembership UserProfile 链接到扩展配置文件？

> ID：15124354
> 
> 赞同：2
> 
> 时间：2013-02-27T23:11:24.900
> 
> 标签：c#, asp.net-mvc-4, ef-code-first, entity-framework-5, simplemembership

我已经没有关于如何让这段代码按照我想要的方式工作的想法了。我有 3 个模型，如下所述。

`UserProfile and Player` **一对一的关系**

首先创建 UserProfile，在注册时将 emailConfirmation 发送到用户提供的电子邮件。一旦他们确认了他们的帐户，他们就会被重定向到他们的第一个登录页面，如果经过身份验证，他们会被重定向到创建新玩家页面，以提供有关他们扩展资料的更多信息。在创建页面上，我希望`UserId`登录用户与即将创建的播放器相同。当我按原样尝试代码时，没有响应，也没有添加或保存到数据库中。

`Team and Player` **一对多关系**

几乎不言自明，一个球员必须属于一个团队。这使得重定向到编辑操作成为不行`Player.TeamId != null`。

**用户资料**

```
[Table("UserProfile")]
public class UserProfile
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }

    public string UserName { get; set; }

    public string Email { get; set; }

    public virtual Player Player { get; set; }
} 
```

**团队**

```
 public class Team
    {
    [Key]
    [HiddenInput(DisplayValue = false)]
    public int TeamId { get; set; }

    [Display(Name = "Full Name:")]
    public string Name { get; set; }         

    public virtual ICollection<Player> Players { get; set; }        
} 
```

**播放器**

```
public class Player
{
    [Key]
    [ForeignKey("UserProfile")]
    [HiddenInput(DisplayValue = false)]
    public int UserId { get; set; }

    [Required]
    [Display(Name = "Full name")]
    public string FullName{ get; set; }        

    [Display(Name = "Team")]
    public int TeamId { get; set; }

    public virtual Team Team { get; set; }

    public virtual UserProfile UserProfile { get; set; }
 } 
```

**保存播放器**

```
public void SavePlayer(Player player)
    {
        using (var context = new EFootballDb())
        {
            if (player.UserId == 0)
            {
                context.Players.Add(player);
            }
            else if (player.UserId > 0)
            {
                 var currentPlayer = context.Players                        
                    .Single(t => t.UserId == player.UserId);

                context.Entry(currentPlayer).CurrentValues.SetValues(player);                    
            }
            context.SaveChanges();
        }
    } 
```

**创建动作**

```
[HttpGet]
    public ActionResult Create()
    {
        PopulateTeamsDropDownList();
        return View();
    }

    [HttpPost]
    public ActionResult Create(Player model)
    {
       try
       {
           if (ModelState.IsValid)
           {
                _dataSource.SavePlayer(model);
                return RedirectToAction("Detail", "Team", new { id = model.TeamId });
            }
        }
        catch (Exception)
        {
            ModelState.AddModelError("", "Unable to save changes. Try again, and if the problem persists, see your system administrator.");
        }
        PopulateTeamsDropDownList(model.TeamId);
        return View(model);
    }

private void PopulateTeamsDropDownList(object selectedTeams = null)
    {
        var teamsQuery = from d in _dataSource.Teams
                         orderby d.Name
                         select d;
        ViewBag.TeamID = new SelectList(teamsQuery, "TeamId", "Name", selectedTeams);
    } 
```

一切都很好，`Team and Player`但我无法`UserProfile and Player`在 Creation 连接。有没有人有我应该尝试的想法或不同的方法？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T20:57:52.227

更新：我正在添加另一种方法来做到这一点。这是一种非常复杂的方式，它可以工作，但最终你不会想要这个。

这是一种痛苦。我也花了很多时间弄清楚这一点。我找到的最接近的在线资源是[这里](http://blog.spontaneouspublicity.com/including-asp-net-simple-membership-tables-as-part-of-your-entity-framework-model)。

请注意，该页面上有两个错误。1) 使用 Add-Migration 而不是 Create-Migration 2) 更新 UsersContext 时，请确保包含 DbSet 的泛型类型。IE

```
public DbSet<Membership> Membership { get; set; } 
```

按照该链接上的步骤操作。然后你需要多走一点。

对于我的解决方案，我将所有模型移至模型类库，将 UsersContext 移至 DAL 类库，但这不是必需的。

完成迁移后，您可以添加一个基本类以链接到 UserProfile，如下所示...

```
public class User
{
    public int UserId { get; set; }

    public string FirstName { get; set; }

    public int UserProfileId { get; set; }

    [ForeignKey("UserProfileId")]
    public UserProfile UserProfile { get; set; }
} 
```

不要忘记更新 UsersContext。注意：您可以将 UsersContext 重命名为您喜欢的任何名称。

```
public DbSet<User> Users { get; set; } 
```

最后一步是添加一个在 AccountController 中调用的类来代替 WebSecurity.CreateUserAndAccount(...)

```
public class CustomSimpleMembershipProvider
{
    private readonly UsersContext _db = new UsersContext();

    public bool CreateUser(string username, string password, string firstName)
    {
        var userCreated = false;

        WebSecurity.CreateUserAndAccount(username, password);

        var userProfile = _db.UserProfiles.FirstOrDefault(u => u.UserName == username);

        // Check if user already exists
        if (userProfile != null)
        {
            var member = new Model.User { FirstName = firstName, UserProfile = userProfile };

            try
            {
                _db.Users.Add(member);
                _db.SaveChanges();

                userCreated = true;
            }
            catch (Exception)
            {
                //Add logging or throw whatever exceptions needed
                throw;
            }

        }
        return userCreated;
    }
} 
```

迁移的原因是它允许您在自己的上下文中控制成员资格表。我试图在不同的上下文中创建它们但没有成功。我希望这能满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:59:29.523

一个更简单的方法是创建一个具有 UserProfile 的虚拟外键的类。Virtual 用于延迟加载。我这样做的原因是，一旦我使用了 OAuth，它就更容易工作了。

```
 public class User
    {
        public int Id { get; set; }

        public string FirstName { get; set; }

        public string LastName { get; set; }

        public int UserProfileId { get; set; }

        [ForeignKey("UserProfileId")]
        public virtual UserProfile UserProfile { get; set; }
    } 
```

然后像这样将您的 UsersContext 从 AccountModels.cs 移到您的自定义上下文中。

```
public class OAuthNoMigrateContext : DbContext
{
    public OAuthNoMigrateContext()
        : base("DefaultConnection")
    {
    }

    public DbSet<User> Users { get; set; }
    public DbSet<UserProfile> UserProfiles { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {

    }
} 
```

创建一个与我的其他答案类似的 CustomSimpleMembershipProvider 。

```
public class CustomSimpleMembershipProvider
{
    private readonly OAuthNoMigrateContext _db = new OAuthNoMigrateContext();

    public bool CreateUser(string username, string password, User user)
    {
        var userCreated = false;

        WebSecurity.CreateUserAndAccount(username, password);

        var userProfile = _db.UserProfiles.FirstOrDefault(u => u.UserName == username);

        // Check if user exists
        if (userProfile != null)
        {
            user.UserProfile = userProfile;

            try
            {
                _db.Users.Add(user);
                _db.SaveChanges();

                userCreated = true;
            }
            catch (Exception)
            {
                //Add logging or throw whatever exceptions needed
                throw;
            }

        }
        return userCreated;
    }
} 
```

将此添加到 Application_Start

```
Database.SetInitializer(new OAuthNoMigrateInitializer()); 
```

注意：我喜欢创建一个检查用户并从 Application_Start 调用的方法。当您第一次调用数据库时，初始化就开始了，它就是这样做的。

```
private static void ViewDb()
    {
        using (var context = new OAuthNoMigrateContext())
        {
            var user = context.Users.Where(u => u.FirstName.StartsWith("T"));
        }
    } 
```

调用这个初始化器

```
public class OAuthNoMigrateInitializer : DropCreateDatabaseAlways<OAuthNoMigrateContext>
{
    private readonly CustomSimpleMembershipProvider _provider = new CustomSimpleMembershipProvider();

    protected override sealed void Seed(OAuthNoMigrateContext context)
    {
        //Initialize UserProfile
        WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId", "UserName", autoCreateTables: true);

        AddUsers(context);
    }

    private void AddUsers(OAuthNoMigrateContext context)
    {
        if (WebSecurity.UserExists("username")) return;

        var user = new User
        {
            FirstName = "FName",
            LastName = "LName"
        };

        _provider.CreateUser("username", "password", user);
    }
} 
```

# perl - 如何从提示符捕获错误消息 - shell 或 perl

> ID：15124357
> 
> 赞同：0
> 
> 时间：2013-02-27T23:11:29.627
> 
> 标签：perl, shell

我正在尝试捕获命令的输出。如果命令执行，它工作正常。但是，当出现错误时，我无法捕获命令行中显示的内容

例如。

```
$ out=`/opt/torque/bin/qsub submitscript`
qsub: Unauthorized Request  MSG=group ACL is not satisfied: user abc@xyz.org, queue home
$ echo $out

$ 
```

我希望 $out 有消息

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:33:54.813

错误在 stderr 上，因此您需要将它们重定向到 stdout 以便反引号将其捕获：

```
out=`/opt/torque/bin/qsub submitscript 2>&1`
if [ $? -gt 0 ] ; then
    # By convention, this is sent to stderr, but if you need it on
    # stdout, just remove the >&2 redirection
    echo "Error: $out" >&2
else
    echo "Success: $out"
fi 
```

您应该测试命令的退出状态以确定输出代表什么（显示的一种方式）。perl 类似，当然语法略有不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:27:37.473

你有没有试过这样做

```
$ out=`/opt/torque/bin/qsub submitscript 2>&1 > /dev/null`
$ echo $out 
```

# jsp - com.ibatis.common.jdbc.exception.NestedSQLException：无法启动事务

> ID：15124362
> 
> 赞同：0
> 
> 时间：2013-02-27T23:12:01.833
> 
> 标签：jsp, tomcat, transaction-log

当 Microsoft 数据库的事务日志已满时，我的 jsp 站点和 asp 站点开始抛出错误消息。所以我进去缩小了日志文件，asp站点开始工作得很好，但是jsp站点仍然抛出关于无法启动新事务的错误。我是 JSP 的新手，所以仍在尝试弄清楚。JSP 站点在 Windows 机器上的 tomcat 服务器上运行。我需要做什么来重置 jsp 站点。我附上了堆栈跟踪：

> processloginaction com.ibatis.common.jdbc.exception.NestedSQLException：无法启动事务。原因：com.ibatis.sqlmap.engine.transaction.TransactionException：TransactionManager 无法启动新事务。事务已经开始。原因：com.ibatis.sqlmap.engine.transaction.TransactionException：TransactionManager 无法启动新事务。事务已经开始。在 com.ibatis.sqlmap.engine.impl.SqlMapExecutorDelegate.startTransaction(SqlMapExecutorDelegate.java:728) 在 com.ibatis.sqlmap.engine.impl.SqlMapSessionImpl.startTransaction(SqlMapSessionImpl.java:129) 在 com.ibatis.sqlmap.engine .impl.SqlMapClientImpl.startTransaction(SqlMapClientImpl.java:101) at action.ProcessLoginAction.execute(ProcessLoginAction.java:170) at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor. TransactionException：TransactionManager 无法启动新事务。事务已经开始。在 com.ibatis.sqlmap.engine.transaction.TransactionManager.begin(TransactionManager.java:46) 在 com.ibatis.sqlmap.engine.transaction.TransactionManager.begin(TransactionManager.java:39) 在 com.ibatis.sqlmap.engine .impl.SqlMapExecutorDelegate.startTransaction(SqlMapExecutorDelegate.java:726) ... 24 更多原因：com.ibatis.sqlmap.engine.transaction.TransactionException：TransactionManager 无法启动新事务。事务已经开始。在 com.ibatis.sqlmap.engine.transaction.TransactionManager.begin(TransactionManager.java:46) 在 com.ibatis.sqlmap.engine.transaction.TransactionManager.begin(TransactionManager.java:39) 在 com.ibatis.sqlmap.engine .impl.SqlMapExecutorDelegate.startTransaction（SqlMapExecutorDelegate.java：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T15:24:34.257

我想重新启动服务器对我有用。但是不明白为什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T15:34:53.617

您可能在当前正在运行的事务中启动了另一个事务。如果要在一个事务中运行另一个事务，请尝试使用线程

# c# - 将第 3 方 C# 转换为 PowerShell

> ID：15124363
> 
> 赞同：1
> 
> 时间：2013-02-27T23:12:04.457
> 
> 标签：c#, powershell, translate

使用最近从我们的硬件供应商处获得的 dll（用于在 .NET sdk 中工作）。他们为所有的类、方法等提供了不错的文档。但他们所有的示例都是用 C# 编写的。我不精通 C#，正在努力将所有内容都转换为 PowerShell。我取得了一些进展，但遇到了困难，正在寻求帮助。

这是他们在 C# 中的示例：

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;

    namespace Vendor.Components.Flashlight.Sdk.Examples
    {
        class MyApp
        {
            public void Execute()
            {
                var device = new FlashlightController();
                device.Light(FlashlightColor.Green);
            }
        }
    } 
```

到目前为止，这是我在 PowerShell 中的位置（如果有更雄辩的方式，请随时告诉我）：

```
 ## Vendor DLL path
    $assemblyFlashlight = 'C:\FlashlightDLL\Flashlight.Sdk.dll'
    ## Adding new assembly as a Type and listing members
    $typeFlashLight = Add-Type -Path $assemblyFlashlight -PassThru
    $typeFlashlight

    IsPublic IsSerial Name                                     BaseType
    -------- -------- ----                                     --------
    True     False    DotfuscatorAttribute                     System.Attribute
    True     False    BusylightController                      System.Object
    True     True     BusylightSoundClip                       System.Enum
    True     True     BusylightVolume                          System.Enum
    True     False    BusylightColor                           System.Object
    False    False    b                                        System.Object
    False    False    c                                        System.Object
    False    False    e                                        System.Object
    False    False    f                                        System.Object
    False    False    d                                        System.Object
    False    False    i                                        System.ValueType
    False    False    a                                        System.ValueType
    False    False    g                                        System.Object
    False    False    h                                        System.ValueType
    False    True     d                                        System.MulticastDelegate
    False    False    b                                        System.ValueType
    False    False    e                                        System.Object
    False    False    c                                        System.Object
    False    False    f                                        System.Object
    False    False    a                                        d
    False    False    a                                        System.Object

    ## Creating objects
    $objController = New-Object $typeFlashLight[1]
    $objSoundClip = New-Object $typeFlashLight[2]
    $objVolume = New-Object $typeFlashLight[3]
    $objColor = New-Object $typeFlashLight[4] 
```

上面的 PowerShell 代码运行没有错误，我的所有 $obj 变量都包含预期的成员：

```
 $objColor|Get-Member

    Name          MemberType Definition
    ----          ---------- ----------
    Equals        Method     bool Equals(System.Object obj)
    GetHashCode   Method     int GetHashCode()
    GetType       Method     type GetType()
    ToString      Method     string ToString()
    BlueRgbValue  Property   int BlueRgbValue {get;set;}
    GreenRgbValue Property   int GreenRgbValue {get;set;}
    RedRgbValue   Property   int RedRgbValue {get;set;} 
```

所以我认为我在正确的轨道上。但我不知道如何翻译某些东西，比如“IsPublic”、“IsSerial”，而且我对“Dotfuscator”的研究并没有给我任何我能消化的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:17:42.553

IsPublic 和 IsSerial 不是您要实现的属性。它们是 System.RuntimeType 的属性，其中有一个与 .NET 中的每种类型相关联。尝试这个：

```
$objColor.GetType() 
```

至于将 C# 转换为 PowerShell，请记住并不总是 100% 映射。也就是说，在 PowerShell 中，您不能创建类或接口，更不用说从其他类型派生的类型了。在 CLI 中，PowerShell 更像是一种消费者语言，而不是生产者语言。大多数情况下，这对于基本实用程序库来说都不是问题。但是，如果该库确实是一个需要您从其基类或接口继承的框架，您将无法使用 PowerShell。

# java - 检查字符串是否是有效的 JSON 字符串？

> ID：15124367
> 
> 赞同：4
> 
> 时间：2013-02-27T23:12:16.237
> 
> 标签：java, json, string, resultset

我正在尝试执行`SELECT SQL`查询，之后我需要遍历`ResultSet`并获取`columns`并检查我为这些返回的数据是否`columns`有效`JSON String`。

这`columnsList`是一个`ArrayList`包含`Columns`特定表的所有名称的。

```
ResultSet rs = preparedStatement.executeQuery();

while (rs.next()) {
    for (String column : columnsList.split(",")) {

        //check whether rs.getString(column) is a valid JSON String?
        if(rs.getString(column).ISvalid_JSON_String()) {

            System.out.println("Valid JSON String data")
        }
    }
} 
```

我不确定我应该如何检查我为每一列返回的数据是否是有效的 JSON 字符串？

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:16:53.460

如果您需要确定它确实是有效的 JSON，您将需要解析它。我喜欢的一个快速、简单、轻量级的解析器是 json-simple。在这里查看他们的示例。

[http://code.google.com/p/json-simple/wiki/DecodingExamples#Example_2_-_Faster_way:_Reuse_instance_of_JSONParser](http://code.google.com/p/json-simple/wiki/DecodingExamples#Example_2_-_Faster_way:_Reuse_instance_of_JSONParser)

调整你的代码我得到：

```
JSONParser parser = new JSONParser();
ResultSet rs = preparedStatement.executeQuery();

while (rs.next()) {
    for (String column : columnsList.split(",")) {
        //check whether rs.getString(column) is a valid JSON String?
        try{ 
            parser.parse(rs.getString(column)); 
            System.out.println("Valid JSON String data");
        } catch (ParseException e) {
            System.out.printlnn("Invalid JSON String data");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-17T01:18:47.197

我更喜欢使用擅长处理大文件的 Jackson 库。

```
 import com.fasterxml.jackson.databind.ObjectMapper;
   import java.io.IOException;

    private Boolean isValidJson(String maybeJson){
        try {
            final ObjectMapper mapper = new ObjectMapper();
            mapper.readTree(maybeJson);
            return true;
        } catch (IOException e) {
            return false;
        }
    } 
```

我编写了一些测试来检查这种方法的行为。

```
 Assert.assertThat(isValidJson("{\"token_type\":\"bearer\",\"access_token\":\"AAAA%2FAAA%3DAAAAAAAA\",\"scope\": \"scope of the token\",\"expires_in\": 200,\"refresh_token\":\"fdb8fdbecf1d03ce5e6125c067733c0d51de209c\"}"), Is.is(true));
    Assert.assertThat(isValidJson("[ \"Ford\", \"BMW\", \"Fiat\" ]\n"), Is.is(true));
    Assert.assertThat(isValidJson(""), Is.is(false));
    Assert.assertThat(isValidJson("Lachlan"), Is.is(false));
    Assert.assertThat(isValidJson("{ key: value }"), Is.is(false)); 
```

将此解决方案重新集成到您的代码中。我假设您会将验证代码放在同一个类中。

```
while (rs.next()) {
    for (String column : columnsList.split(",")) {
        String maybeJson = rs.getString(column)
        //check whether rs.getString(column) is a valid JSON String?
        if(isValidJson(maybeJson)) {
            System.out.println("Valid JSON String data")
        }
    }
} 
```

考虑根据什么值和期望的行为添加一个空检查。

# python - Python - SQL UPDATE 不更新每一行

> ID：15124373
> 
> 赞同：0
> 
> 时间：2013-02-27T23:12:31.203
> 
> 标签：python, sql

```
cur.execute("""SELECT match_own_goals.game_id, home_team, away_team, team, time FROM football.match_own_goals JOIN football.match_info ON match_own_goals.game_id = match_info.game_id""")
e = cur.fetchall()

for game in e:
        print game
        time = game[4]
        if game[3] == 1:
            team_id = game[1]
        else:
            team_id = game[2]
        cur.execute("""UPDATE football.match_own_goals SET team_id = %s WHERE game_id = %s AND time = %s""", (team_id, game[0], time))
        db.commit() 
```

在应该更新的 108 行中，它只更新了大约 10 行，我不知道为什么会这样。它提取 SELECT 语句中的所有信息。这可能很明显，但已经晚了哈哈。

Team 是 1 或 2，最初表示主场或客场

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T02:10:08.113

查询是：

```
UPDATE football.match_own_goals
    SET team_id = %s
    WHERE game_id = %s AND time = %s 
```

如果这*有时*有效，那么查询在语法上是正确的，并且您已连接到数据库。

发生的事情是所选行不是您所期望的。因此，运行此查询以查看应更新的内容：

```
select *
from football.match_own_goals
WHERE game_id = %s AND time = %s 
```

这两个字段之一导致比较出现问题。

我的猜测是时间字段是问题所在。时间可以非常精确，比打印到用户输出的内容更精确。例如，也许时间保持在 1/10 秒，但时间只打印到秒。只有大约 1/10 的行会真正匹配完全匹配。

# php - 如何加入表并在 mysql 中显示随机查询，而不再显示相同

> ID：15124384
> 
> 赞同：-2
> 
> 时间：2013-02-27T23:13:14.110
> 
> 标签：php, mysql

我有 2 张桌子我需要他们有相同 id 的答案

*   表1 `e107_users`：用户 ID、用户名、用户图像
*   表 2 `e107_extended`：user_id、premium、电话

我只需要显示 5 个随机选择的用户，并让它仅在溢价时显示。

```
---------  ---------  ---------  ---------  ---------
* Phone *  * Phone *  * Phone *  * Phone *  * Phone *
* image *  * image *  * image *  * image *  * image *
* Name  *  * Name  *  * Name  *  * Name  *  * Name  *
*********  *********  *********  *********  ********* 
```

不应该重复，所以只能在`user_id`查询中看到同一个用户

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:17:30.447

```
SELECT * FROM e107_users u 
JOIN e107_extended e ON u.user_id = e.user_id
WHERE premium = 1
ORDER BY RAND()
LIMIT 5 
```

这应该可以解决问题。`ORDER BY RAND()`告诉 MySQL 进行随机排序，这意味着它只会随机排列条目。然后`LIMIT 5`将您的结果限制为前 5 个条目。在大多数情况下，这类似于“最大 5”、“最小 5”，但这里是“全部随机集合中的前 5 个”，即“随机 5”。

我假设`e107_users`不包含任何 user_id 重复项。对我来说没有多大意义。

我还假设`e107_users`to`e107_extended`是**1:1 关系**，但这可能会有所不同。但是，您的问题没有为此提供足够的信息。有一些关于重复 ID 的提及，但我不知道它们可能出现在哪里。

以防万一**不是 1:1 关系**，您可以使用`GROUP BY`：

```
SELECT * FROM e107_users u 
JOIN e107_extended e ON u.user_id = e.user_id
WHERE premium = 1
GROUP BY u.user_id
ORDER BY RAND()
LIMIT 5 
```

这将告诉 MySQL 使用 u.user_id （表`user_id`中的`e107_users`）将元素分组在一起。`e107_extended`因此，如果相同的有多个元素`user_id`，则只会选择一个）。

**但是**，这可能不会打乱扩展表中的元素。这意味着将始终选择相同的电话号码。但是，名称和图像将被洗牌。我不知道如何完全洗牌。

# vim - gvim 屏幕左下角的@符号是什么意思？

> ID：15124386
> 
> 赞同：4
> 
> 时间：2013-02-27T23:13:19.097
> 
> 标签：vim

在过去的两周里，我已经习惯了使用 vim，并且真的开始喜欢它了。我一直想知道一件事 - 有时当我输入某些内容时，这些只有 @ 符号的行会出现在屏幕底部：

![当我注意到这一点时，我正在做的 vim 笔记的屏幕截图 - 屏幕底部有 2 个 @ 行](../Images/1f52e87d1a706ca7cc967c604ff4a842.png)

这已经发生了几次，但我从来没有过多关注它，但我很好奇 - 就像在那种情况下，按 enter 摆脱其中一个，再次按 enter 摆脱另一个。然后另外两个进入，另一个@行出现。有谁知道他们的意思？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T23:25:18.963

当您打开一个非常大的文件（或非常长的行）时，通常会发生这种情况。

您可以设置`display`选项以显示所有行。（不显示那些`@`）。

```
lastline    When included, as much as possible of the last line
        in a window will be displayed.  When not included, a
        last line that doesn't fit is replaced with "@" lines. 
```

例如在我的 vimrc 中，我有`set display=lastline`

如果您想了解有关它的详细信息，请检查`:h 'display'`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-27T23:22:31.523

这意味着您有一条线大于终端的高度和宽度。

# jquery - 根据破折号'-'将 li 分组为 ul

> ID：15124387
> 
> 赞同：1
> 
> 时间：2013-02-27T23:13:20.423
> 
> 标签：jquery, html-lists, grouping

我有一个这样的代码下拉列表：

```
<select id="Folder" name="Folder">
<option value="0">Top Folder</option>
<option value="11">2nd Folder 01</option>
<option value="17">---3rd Folder 01-01</option>
<option value="18">---3rd Folder 01-02</option>
<option value="383">------4th Folder 01-02-01</option>
<option value="384">---------5th Folder 01-02-01-01</option>
<option value="385">---------5th Folder 01-02-01-02</option>
<option value="386">---------5th Folder 01-02-01-03</option>
<option value="387">---------5th Folder 01-02-01-04</option>
<option value="388">---------5th Folder 01-02-01-05</option>
<option value="19">---3rd Folder 03</option>
<option value="20">---3rd Folder 04</option>
<option value="22">---3rd Folder 05</option>
<option value="130">------5th Folder 01-02-05-01</option>
<option value="131">------5th Folder 01-02-05-02</option>
<option value="132">------5th Folder 01-02-05-03</option>
<option value="133">------5th Folder 01-02-05-04</option>
<option value="134">------5th Folder 01-02-05-05</option>
<option value="398">------5th Folder 01-02-05-06</option>
<option value="158">2nd Folder 02</option>
<option value="257">---3rd Folder 02-01</option>
<option value="258">---3rd Folder 02-02</option>
<option value="259">---3rd Folder 02-03</option>
<option value="16">2nd Folder 03</option>
<option value="382">---3rd Folder 03-01</option>
<option value="51">---3rd Folder 03-02</option>
<option value="113">------4th Folder 03-02-01</option>
<option value="125">------4th Folder 03-02-02</option>
</select> 
```

我用 jquery 将它们转换成一个列表：

```
 <script type="text/javascript">//<![CDATA[ 
    $(window).load(function(){
    $(function() {
        var $yearFilter = $("#Folder");
        $yearFilter.find("option").map(function() {
            var $this = $(this);
            return $("<li>").attr("value",$this.attr("value")).text($this.text()).get();
        }).appendTo($("<ul>").attr({
                    id: $yearFilter.attr("id"),
            name: $yearFilter.attr("name")
        })).parent().replaceAll($yearFilter);
    });
    });//]]>  
    </script> 
```

这给了我这个：

```
 <ul id="Folder" name="Folder">
    <li value="0">Top Folder</li>
    <li value="11">2nd Folder 01</li>
    <li value="17">---3rd Folder 01-01</li>
    <li value="18">---3rd Folder 01-02</li>
    <li value="383">------4th Folder 01-02-01</li>
    <li value="384">---------5th Folder 01-02-01-01</li>
    <li value="385">---------5th Folder 01-02-01-02</li>
    <li value="386">---------5th Folder 01-02-01-03</li>
    <li value="387">---------5th Folder 01-02-01-04</li>
    <li value="388">---------5th Folder 01-02-01-05</li>
    <li value="19">---3rd Folder 03</li>
    <li value="20">---3rd Folder 04</li>
    <li value="22">---3rd Folder 05</li>
    <li value="130">------5th Folder 01-02-05-01</li>
    <li value="131">------5th Folder 01-02-05-02</li>
    <li value="132">------5th Folder 01-02-05-03</li>
    <li value="133">------5th Folder 01-02-05-04</li>
    <li value="134">------5th Folder 01-02-05-05</li>
    <li value="398">------5th Folder 01-02-05-06</li>
    <li value="158">2nd Folder 02</li>
    <li value="257">---3rd Folder 02-01</li>
    <li value="258">---3rd Folder 02-02</li>
    <li value="259">---3rd Folder 02-03</li>
    <li value="16">2nd Folder 03</li>
    <li value="382">---3rd Folder 03-01</li>
    <li value="51">---3rd Folder 03-02</li>
    <li value="113">------4th Folder 03-02-01</li>
    <li value="125">------4th Folder 03-02-02</li>
    </ul> 
```

但是，我想要实现的是：

```
 <ul id="Folder">
    <li>Top Folder</li>
    <li>2nd Folder 01
    <ul class="something01">
    <li>3rd Folder 01-01</li>
    <li>3rd Folder 01-02
    <ul>
    <li>4th Folder 01-02-01
    <ul class="something01-02-01">
    <li>5th Folder 01-02-01-01</li>
    <li>5th Folder 01-02-01-02</li>
    <li>5th Folder 01-02-01-03</li>
    <li>5th Folder 01-02-01-04</li>
    <li>5th Folder 01-02-01-05</li>
    </ul>
    </li>
    </ul>
    </li>
    <li>3rd Folder 03</li>
    <li>3rd Folder 04</li>
    <li>3rd Folder 05
    <ul class="something05">
    <li>5th Folder 01-02-05-01</li>
    <li>5th Folder 01-02-05-02</li>
    <li>5th Folder 01-02-05-03</li>
    <li>5th Folder 01-02-05-04</li>
    <li>5th Folder 01-02-05-05</li>
    <li>5th Folder 01-02-05-06</li>
    </ul>
    </li>
    </ul>
    </li>
    <li>2nd Folder 02
    <ul class="something02">
    <li>3rd Folder 02-01</li>
    <li>3rd Folder 02-02</li>
    <li>3rd Folder 02-03</li>
    </ul>
    </li>
    <li>2nd Folder 03
    <ul class="something03">
    <li>3rd Folder 03-01</li>
    <li>3rd Folder 03-02
    <ul>
    <li>4th Folder 03-02-01</li>
    <li>4th Folder 03-02-02</li>
    </ul>
    </li>
    </ul>
    </li>
    </ul> 
```

所以我想知道是否有一种方法可以根据破折号“-”将所有第二、第三等级别分组到一个 ul 组中。还是我必须给每个 li 一个班级然后从那里分组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:17:20.710

查看标签 optgroup 是否可以解决您的问题

[http://www.w3schools.com/tags/tag_optgroup.asp](http://www.w3schools.com/tags/tag_optgroup.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T03:53:32.647

是的，您应该能够使用破折号，前提是级别始终是破折号的数量除以三。关键是使用堆栈。它还有助于具有计算破折号的功能。

```
// Helper function.
function countLeadingChars(str, ch) {
    for (var i = 0; i < str.length; i++) {
        if (str.charAt(i) !== ch) {
            return i;
        }
    }
    return str.length;
}

var stack = [];

$('#Folder').children().each(function() {
    var $option = $(this);

    var text = $option.text();

    // Count the dashes.
    var dashes = countLeadingChars(text, '-');

    // Level is # of dashes divided by 3.
    var level = dashes / 3;

    // Remove anything in the stack beyond the current level.
    // This will cause new <ul>s to get created when higher
    // levels are encountered again.
    if (stack.length > (level + 1)) {
        stack.length = level + 1;
    }

    // Get the <ul> for the level, creating it if it doesn't exist.
    var $ul = stack[level];
    if (!$ul) {
        $ul = $('<ul/>');
        stack[level] = $ul;

        // Add the <ul> to the last <li> of the parent <ul>.
        if (level > 0) {
            stack[level - 1].children(':last').append($ul);

            // Add the "class" to the <ul>.
            var parentText = $ul.parent().text();
            var index = parentText.lastIndexOf(' ');
            $ul.addClass('something' + parentText.slice(index + 1));
        }
    }

    // Create the <li> and add it to the <ul>.
    $('<li>' + text.slice(dashes) + '</li>').appendTo($ul);
});

// At this point, stack[0] is the top-most <ul>. 
```

[jsfiddle 上的现场演示](http://jsfiddle.net/hspVd/)

**编辑：**`<ul>`我刚刚注意到您想要在我为上面添加代码的元素上添加一个“类” 。

[jsfiddle 上的新现场演示](http://jsfiddle.net/hspVd/2/)

# facebook - 如何自动刷新像 facebook 这样的新闻提要？

> ID：15124389
> 
> 赞同：0
> 
> 时间：2013-02-27T23:13:27.817
> 
> 标签：facebook

知道像 facebook 这样的自动刷新新闻提要是如何工作的吗？我们正在开发一个类似于 facebook 的新闻提要功能的网站。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:15:30.470

如果通过自动刷新您的意思是在用户在页面上时进行更新，您可以通过网络套接字进行更新，或者使用较旧的技术只需每 x 秒进行一次简单的 ajax 检查，然后注入内容。

# commit - 克隆和提交 BitBucket 项目的“Wiki”存储库的最佳实践

> ID：15124395
> 
> 赞同：9
> 
> 时间：2013-02-27T23:13:38.713
> 
> 标签：commit, wiki, bitbucket

在 BitBucket 中，您可以为项目创建 Wiki。但是，Wiki 本身是一个与源代码库分开的代码库。当您克隆它时，它会创建一个名为“wiki”的存储库。

克隆这个 repo 的理想或常规位置在哪里？你把它放在源代码库中吗？如果是这样，您在从源代码库提交时是否 .gitignore /wiki？或者您是否在源代码库中包含 wiki 代码库？

推送时，您是否提交两次，一次是在源代码库中，一次是在 wiki 代码库中？或者您可以修改源的 git 以同时提交源和 wiki 吗？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-08-12T19:42:56.193

理想的方法是使用 Git 的子模块功能：

```
$ cd project
$ git submodule add https://bitbucket.org/user/project.git/wiki 
```

这将创建一个文件夹`wiki`和`.gitmodules`文件，然后：

```
$ cd wiki
$ nano Home.md 
```

更改文件中的一些信息，并且：

```
$ git add .
$ git commit -m "Some comment"
$ git push origin master 
```

返回项目：

```
$ cd ..
$ git add .
$ git commit -m "Added wiki module"
$ git push [remoteName] [remoteBranch] 
```

有了这个，项目 repo 将生成一个链接，一个特定的 wiki repo 提交，您可以只更新其中一个。

我希望这是有帮助的。

更多信息：[https ://git-scm.com/book/en/v2/Git-Tools-Submodules](https://git-scm.com/book/en/v2/Git-Tools-Submodules)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-25T17:41:42.490

我为存储库维护以下结构。

![在此处输入图像描述](../Images/1e30c19eb1f47198c01ccbb28b01ce8c.png)

这个想法是维护代码仓库和它的相关维基作为兄弟姐妹。这样就不需要告诉 .gitignore 忽略任何 wiki 相关文件。此外，您只需推送到您正在进行更改的存储库。希望，这就是你要找的。

# c - 文件数据到 C 中的链表

> ID：15124396
> 
> 赞同：1
> 
> 时间：2013-02-27T23:13:54.780
> 
> 标签：c

我在这里真的很近。

这会读取文件并使用 gdb 我可以看到文本文件中的单词进入链接列表。

但是，当我打印我的链表（代码的底部）时，整个链表似乎只包含文件中的最后一个单词，因为文件中有很多条目。

```
bool load(const char* dictionary) {
    // open dictionary
    FILE* file = fopen(dictionary, "r");
    if (file == NULL)
        return false;

    char buf[LENGTH];

    //read the contents of the file and write to linked list
    while (!feof(file)) {
        fscanf(file,"%s", buf);

        // try to instantiate node
        node* newptr = malloc(sizeof(node));
        if (newptr == NULL) {
            return false;
        }

        // initialize node
        newptr->next = NULL;

        // add new word to linked list
        newptr->dictword = buf;

        //move node to start of linked list
        newptr->next = first;
        first = newptr;
    }

    fclose(file); 

    // traverse and print list.
    node* ptr = first;
    while (ptr != NULL) {
        printf("%s\n", ptr->dictword);
        ptr = ptr->next;
    }

    return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:16:54.240

您只有一个`char buf[]`可以阅读每个单词的内容。您在每个链表元素中保存一个指向该缓冲区的指针，但您会立即读取数据。当你把它放入分配的`node`. 最简单的方法是使用`newptr->dictword = strdup(buf)`which 一步完成分配和复制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:25:39.263

使用 feof 表示您是 1\. 不使用 unix 环境并且必须适应 mingw 无法在标准输入中正确 eof。2\. 想太多，实际上应该检查eof。

我通常这样做：

```
void* collection = ...;
FILE* filebehere = ...;
char buffer[1337];
while (fgets(buffer, 1337, filebehere)) {
    if (strlen(buffer) != 0) {
        buffer[strlen(buffer) - 1] = 0;
        collection_insert(collection, buffer);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:28:37.470

线路有问题：

```
// add new word to linked list
newptr->dictword = buf; 
```

通过这种方式，您总是将对 buf 开头的引用传递给所有元素，因此当您更新“buf”时，所有元素都会更新。这就是为什么你有提到的行为。

尝试将其替换为：

```
newptr->dictword = (char*) malloc((strlen(buf)+1)*sizeof(char));
strcpy(newptr->dictword, buf); 
```

“strlen(buf)+1”是存储在 buf 中的当前字符串的长度加上字符“\0”的空格，表示字符串的结尾。

PS。假设您已经用 char* 声明了元素“dictword”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T23:18:16.537

假设**dictword**的大小**LENGTH**与您的**buf**一样，即：

```
struct node {
...
...
    char dictword[LENGTH];
...
...
}; 
```

您需要在代码中进行以下更改：

```
strcpy(newptr->dictword, buf); 
```

问题是您只是将字典设置为指向与链表所有节点中的 buf 相同的内存。

更好的方法是为字符串动态分配内存：

```
struct node {
...
...
    char* dictword;
...
...
};

newptr->dictword = (char*)malloc(strlen(buf) + 1);
strcpy(newptr->dictword, buf); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T23:19:02.303

我推荐`strdup`BenJackson 的解决方案。但它不存在于标准 C 库中。

这是我的解决方法：

```
char *strdup(const char *data)
{
   char *retval = malloc(strlen(data) + 1);
   strcpy(retval, data);
   return retval;
} 
```

# cakephp - 如何在 CakePHP 上安装 DebugKit

> ID：15124398
> 
> 赞同：22
> 
> 时间：2013-02-27T23:14:00.313
> 
> 标签：cakephp

我正在学习如何使用，`CakePHP`并且我已经配置好了一切，但是现在，我收到了这个警告：

`DebugKit is not installed. It will help you inspect and debug different aspects of your application. You can install it from github`

我已经点击了该链接，并下载了该应用程序，但我不知道将这些文件夹放在哪里......我正在使用**EasyPhp**作为我的网络主机。
同样[在这里](https://github.com/cakephp/debug_kit)，我按照步骤操作，
并且有：

```
`Ensure the plugin is loaded in app/Config/bootstrap.php by calling CakePlugin::load('DebugKit');` 
```

但我不知道`call`这里怎么做，有提示吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-02-27T23:15:16.947

***如何为 CakePHP 安装 DebugKit（只需 4 个简单的步骤！）：***

**STEP 1（选项A）：传统/下载方式：**

`DebugKit`在您的目录中创建一个文件夹`app/Plugin`，并将下载的内容放入其中（不是顶级文件夹 - 里面的东西）。如果您知道如何从 github 克隆，那也可以。

* * *

**第 1 步（选项 B）：Composer 方法**

这似乎是目前最受欢迎的选择（并且有充分的理由）。如果您已经在使用[Composer [在此处了解更多信息]](http://getcomposer.org/)，那么添加 DebugKit 非常简单。如果您以前没有使用过 Composer，请不要担心 - 只需使用上面的“选项 A”。最终结果是一样的，也很容易。

> 确保 composer.json 中存在 require。这会将插件安装到 Plugin/DebugKit 中：

```
{
    "require": {
        "cakephp/debug_kit": "2.2.*"
    }
} 
```

* * *

**第2步：**

然后，在您的 中`app/Config/bootstrap.php`，添加（或取消注释）以下行：

```
CakePlugin::load('DebugKit'); 
```

最后，在您的`app/Controller/AppController.php`文件中（在班级内），添加：

```
public $components = array(
    'DebugKit.Toolbar'
); 
```

（如果您已经有一个`$components`数组，那么只需添加它 - 不要重新设置它。）

* * *

**第 3 步：确保调试为 1 或更多**

在您的`Config/core.php`文件中，确保这一行：

```
Configure::write('debug', 2); 
```

值为 1 或 2。 [（在此处阅读有关调试模式的更多信息）](http://book.cakephp.org/2.0/en/deployment.html#update-core-php)

* * *

**第 4 步：删除`sql_dump`：**

在您的布局文件中，删除“sql_dump”元素（在默认布局的底部）

* * *

**根据[debugKit 页面](https://github.com/cakephp/debug_kit)上的“安装”部分：**

*   克隆/复制此目录中的文件到 app/Plugin/DebugKit
*   通过调用 CakePlugin::load('DebugKit'); 确保插件在 app/Config/bootstrap.php 中加载；
*   在 AppController.php 中包含工具栏组件： public $components = array('DebugKit.Toolbar');
*   将调试模式设置为至少 1。
*   如果您想体验令人敬畏的调试工具包 SQL 日志，请确保从布局中删除“sql_dump”元素。

* * *

**我怎么知道它是否有效？**

您应该会在网站右上角的灰色方块上看到一个小图标。单击此以展开选项，然后单击一个选项以开始变得很棒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-18T15:45:35.147

在根应用程序文件夹中：去`\vendor\cakephp\`复制文件夹`debug_kit`并将其粘贴到`\plugins`文件夹中，这在 heroku 部署中对我有用（不是生产，仅用于开发）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-11T15:49:39.860

它只是一个版本问题。下载 DebugKit 的兼容版本，它应该可以正常运行。确认的！

# python - 表单提交未收到多个 html 选择

> ID：15124399
> 
> 赞同：3
> 
> 时间：2013-02-27T23:14:06.493
> 
> 标签：python, html, django, forms, post

我有一个带有 2 个字段的小表单，一个隐藏的和一个多选的。当我提交表单时，我收到了 django views.py 文件中的隐藏字段，但没有出现多选；就好像它从未存在过一样。问题是什么？

有表格的代码：

```
<form method="post" action="/admin/admin/grupos/configuracao/broadcast/post/" style="margin:0;" id="form_grupo">
        <table cellspacing="0" width="100%" style="margin-top: 0px; margin-bottom: 10px; border:2px solid #ccc;">
            <tbody>

                    <tr><td width="50%"><input  onclick="remove_grupo()"  type="button" value="Remover do Grupo" style="float:left; margin-top:205px;"></td><td>

                   <select id="select-to" name="unidades"  style="width:360px;height:500px;" multiple="multiple">
                {% ifnotequal numero_unidades 0 %}
            {% for unidade in unidades %}
                     <option value="{{ unidade.relacao.id }}">
                        {{ unidade.desc }}
                     </option>
                {% endfor %}
                {% endifnotequal %}
        </select>   
        <input type="hidden" name="grupo_id" id="grupo_id" value="{{ grupo.id }}">
        </tbody>
    </table>
</form> 
```

我的观点：

```
def Salvar_Configuracao_Grupo_UR( request ):

    if request.user.is_authenticated() and request.user.is_superuser:

        Grupo_EPR.objects.filter( grupo = request.POST['grupo_id'] ).delete()
        grupo = Grupo.objects.filter( id = request.POST['grupo_id'] )[0]
        unidades = request.POST.getlist('unidades')

        for unidade in unidades:
            grupo_epr = Grupo_EPR()
            grupo_epr.relacao = unidade
            grupo_epr.grupo = grupo
            grupo_epr.save()

        return HttpResponseRedirect('/admin/admin/grupos/configuracao/broadcast/0')
    else:
        return HttpResponseRedirect('/admin/') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:15:03.640

在您看来，使用`request.GET.getlist()`或`request.POST.getlist()`从多个具有相同名称的输入中获取值列表。

# java - 保证 Array 处理的顺序 .each() Groovy

> ID：15124405
> 
> 赞同：1
> 
> 时间：2013-02-27T23:14:29.913
> 
> 标签：java, groovy, foreach

在 groovy 中，我知道 Map 上的 .each() 循环[不能保证](http://groovy.codehaus.org/groovy-jdk/java/util/Map.html#each)处理内容的顺序。对象数组上的 .each() 怎么样？我的想法是，数组上的 .each() 每次都会安全地给我预期的订单，但前几天与朋友交谈，他说他认为订单不会得到保证。例如：

```
MyObj[] x = [ obj1, obj2, obj3 ];

x.each(){ obj ->
  //what order will my objs come in?
} 
```

另外，关于：

```
x.eachWithIndex() { obj, i ->
  println(i); //what order will they come in?
} 
```

我可以保证我的 .each() 或 .eachWithIndex() 循环的顺序吗？

[参考](http://groovy.codehaus.org/Looping)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:28:36.117

顺序保证是集合的顺序。

不要将基于闭包的循环与并发性或并行性混淆。这只是单个线程中的简单迭代。关于 Maps 的评论只是强调 Java Maps 没有保证顺序。请注意，groovy 默认使用 LinkedHashMaps。那些*确实*有保证的顺序：按插入顺序。

另请注意，使用 GPars，您可以在上述不适用的情况下使用并行集合。

# mysql - 正确使用 HAVING 子句

> ID：15124406
> 
> 赞同：1
> 
> 时间：2013-02-27T23:14:30.737
> 
> 标签：mysql, having-clause

我正在使用 MySQL，我的目标是`UPDATE`仅在表中满足特定条件的字段。这是我所拥有的：

```
UPDATE tbl_money AS m 
SET m.amount = m.amount + (SELECT SUM( b.bn_ppd )
                           FROM tbl_emp AS e
                           LEFT JOIN tbl_bonuses AS b 
                              ON b.bn_id = e.bn_id
                           WHERE m.u_id = e.u_id
                           HAVING COUNT(e.u_id) > 0
                           GROUP BY e.u_id LIMIT 1) 
```

有了以上内容，我想在当前金额上添加员工拥有的奖金总和，并且仅适用于存在于`tbl_emp`. 事实上，我收到一条错误消息：

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 7 行的“GROUP BY o.user_id LIMIT 1)”附近使用正确的语法

如果没有`HAVING`条款，系统会更新所有员工的金额，但没有任何奖金的员工，它只是将金额重置为0（即使他们已经有金额）。对于那些有奖金的人，工作正常。

有任何想法吗？正确的使用方法是`HAVING`什么？

更新：

```
tbl_bonuses
-----------
bn_id | bn_ppd
1       5
2       2
3       4
4       10

tbl_emp
-------
emp_id | u_id | bn_id | ...
1       30      2
2       30      3
3       31      1

tbl_money
---------
m_id | u_id | amount
1      30     100
2      31     56
3      32     35 
```

更新后所需的结果应该是

```
 tbl_money
    ---------
    m_id | u_id | amount
    1      30     106
    2      31     57
    3      32     35 
```

但是，我得到了这个结果，

```
 tbl_money
    ---------
    m_id | u_id | amount
    1      30     106
    2      31     57
    3      32     0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:16:57.673

HAVING 需要在 GROUP BY 子句之后

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T01:30:06.090

您可以使用以下`UPDATE`语句：

```
update tbl_money m
INNER JOIN
(
  SELECT e.u_id, SUM( b.bn_ppd ) BonusPaid
  FROM tbl_emp AS e
  LEFT JOIN tbl_bonuses AS b 
    ON b.bn_id = e.bn_id
  GROUP BY e.u_id
  HAVING COUNT(e.u_id) > 0
) e
  on m.u_id = e.u_id
set m.amount = m.amount + e.BonusPaid 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!2/d3efa9/1)

# c# - 如何编码字符串以便可以通过http发送？

> ID：15124411
> 
> 赞同：2
> 
> 时间：2013-02-27T23:14:36.870
> 
> 标签：c#, asp.net, .net

我的 POST 请求中有这段字符串：

```
"signature=bI�(��0�P���h;" 
```

现在，我想对其进行编码，因为我的`WebResponse`班级不想将其发送过来。我尝试使用`HttpUtility.HtmlEncode()`，但该方法不想合作（我的意思是字符串保持不变）。

我如何编码那些奇怪的字符，以便它通过 http？

**编辑：好的 nvm，我刚刚发现还有一个名为 .UrlEncode() 的方法，它按预期工作，对不起！**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T23:17:17.973

.NET 也有 URL 编码：http: [//msdn.microsoft.com/en-us/library/zttxte6w.aspx](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx)或查找 HttpUtility.UrlEncode

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:18:16.250

您可以使用[`HttpUtility.UrlEncode`](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx).

`HttpUtility.UrlEncode`- URL 编码确保所有浏览器都能正确传输 URL 字符串中的文本。问号 (?)、与号 (&)、斜线 (/) 和空格等字符可能会被某些浏览器截断或损坏。因此，这些字符必须在标签或查询字符串中编码，其中字符串可以由浏览器在请求字符串中重新发送。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T23:20:19.100

如果您的意思是“作为表单值发布”，那么这是一件相当标准的事情。为什么不让库组件担心这一点：

```
using (var client = new WebClient())
{
   var vals = new NameValueCollection();
   vals["signature"] = yourString;
   // other form inputs here...
   client.UploadValues(url, "post", vals);
} 
```

# windows-7 - 为什么在 Windows 7 上调用 ftd2xx 打开（使用 tclftd2xx.dll）后 tcl/tk 在退出时挂起

> ID：15124414
> 
> 赞同：1
> 
> 时间：2013-02-27T23:15:01.473
> 
> 标签：windows-7, tcl, ftdi

我有一个在 Windows 8 机器上开发的 Tcl/Tk 应用程序。该应用程序使用 FTDI USB windows 驱动程序和 tclftd2xx tcl 扩展来打开 USB 设备。

作为测试的一部分，我将应用程序安装到 Windows 7 机器上。该应用程序运行良好，直到我尝试退出 tcl。当执行退出命令时，应用程序就会挂起。

我以为它与Tk有关，但事实并非如此。tcl 代码非常简单（loc 22 只是一个例子）：

```
package require ftd2xx
set handle [ftd2xx open -location 22]
exit 
```

这不是一个“好的”挂起——即使是程序 KILL 也不会关闭它。摆脱这种情况的唯一方法是对机器进行硬重置，因为 Windows 不会对活动进程进行“安全”关闭。

我确实发现调用 ftd2xx 重置会清除 tcl 正在等待的任何内容，并允许退出完成。

如：

```
package require ftd2xx
set handle [ftd2xx open -location 22]
ftd2xx reset $handle
exit 
```

现在我的问题是，如果用户在关闭应用程序之前拔下 USB 设备，文件句柄 ($handle) 就会过时，因此 ftd2xx 重置无法释放挂起，我又要硬重启了。

我不知道错误是在我的初始化、libftd2xx.c、FTDI 驱动程序还是 Tcl 中。我不想发布所有 libftd2xx.c

如果有人对此有所了解，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T21:46:25.373

问题是：

1) FTDI 芯片本身配置为 async-bit-bash 模式。根据 FTDI 文档，在此模式下，FTDI 芯片对其并行端口引脚进行采样（无论方向 (i/o) 配置如何），并在每个 USB 时钟上将值写入内部缓冲区。

2）我没有使用非阻塞读取（tcl 通道配置 -blocking 0），因为在这个应用程序中，USB 是“只写”的。（IE，端口的每一位都配置为一个输出，每个输出驱动一个单独的逻辑电平到板子）

解决方法：将通道配置为非阻塞并定义一个读取垃圾的读取处理程序。这是一个代码片段 - 请原谅未定义的变量；他们在那里是为了上下文。

```
.
.
.

set handle [ftd2xx open -location $loc]
chan configure $handle -blocking 0 -translation binary -0xFF01
fileevent $handle readable readhandler
.
.
proc readhandler {} {
  gets $handle junk
} 
```

事实上，readhandler 经常被调用，$junk 有时有多达 10K 字节的数据。拔下 USB 后，会捕捉到后续的“flush $filehandle”错误，从而使程序能够有序地关闭。

# eclipse - 无法连接到在 Eclipse 中启动的 Tomcat 6 实例

> ID：15124415
> 
> 赞同：0
> 
> 时间：2013-02-27T23:15:02.107
> 
> 标签：eclipse, tomcat6

我正在运行 Tomcat 6.0.36。在控制台中独立运行时，服务器运行良好。我还将 Eclipse 配置为能够运行它，以便我可以调试。配置成功完成，没有错误。但是，当我运行服务器时，我无法`http://localhost:8080`在浏览器中访问（得到 404）。

这是 Eclipse 跟踪：

```
Feb 27, 2013 6:02:53 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: <my path>
Feb 27, 2013 6:02:53 PM org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-8080
Feb 27, 2013 6:02:53 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 294 ms
Feb 27, 2013 6:02:53 PM org.apache.catalina.core.StandardService start
INFO: Starting service Catalina
Feb 27, 2013 6:02:53 PM org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.36
Feb 27, 2013 6:02:53 PM org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
Feb 27, 2013 6:02:53 PM org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
Feb 27, 2013 6:02:53 PM org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/16  config=null
Feb 27, 2013 6:02:53 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 164 ms 
```

控制台跟踪如下：

```
Feb 27, 2013 6:02:00 PM org.apache.catalina.core.AprLifecycleListener init
INFO: Loaded APR based Apache Tomcat Native library 1.1.23 using APR version 1.4.6.
Feb 27, 2013 6:02:00 PM org.apache.catalina.core.AprLifecycleListener init
INFO: APR capabilities: IPv6 [true], sendfile [true], accept filters [false], random [true].
Feb 27, 2013 6:02:01 PM org.apache.catalina.core.AprLifecycleListener initializeSSL
INFO: OpenSSL successfully initialized with version OpenSSL 1.0.0g 18 Jan 2012
Feb 27, 2013 6:02:01 PM org.apache.coyote.http11.Http11AprProtocol init
INFO: Initializing Coyote HTTP/1.1 on http-8080
Feb 27, 2013 6:02:01 PM org.apache.coyote.ajp.AjpAprProtocol init
INFO: Initializing Coyote AJP/1.3 on ajp-8009
Feb 27, 2013 6:02:01 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 1026 ms
Feb 27, 2013 6:02:01 PM org.apache.catalina.core.StandardService start
INFO: Starting service Catalina
Feb 27, 2013 6:02:01 PM org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.36
Feb 27, 2013 6:02:01 PM org.apache.catalina.startup.HostConfig deployDescriptor
INFO: Deploying configuration descriptor host-manager.xml
Feb 27, 2013 6:02:01 PM org.apache.catalina.startup.HostConfig deployDescriptor
INFO: Deploying configuration descriptor manager.xml
Feb 27, 2013 6:02:01 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory docs
Feb 27, 2013 6:02:01 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory examples
Feb 27, 2013 6:02:01 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory ROOT
Feb 27, 2013 6:02:01 PM org.apache.coyote.http11.Http11AprProtocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
Feb 27, 2013 6:02:01 PM org.apache.coyote.ajp.AjpAprProtocol start
INFO: Starting Coyote AJP/1.3 on ajp-8009
Feb 27, 2013 6:02:01 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 341 ms 
```

我注意到的第一件事是 Eclipse 跟踪的第二行：

`INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path`

而运行良好的控制台跟踪报告

`INFO: Loaded APR based Apache Tomcat Native library 1.1.23 using APR version 1.4.6.`

APR 真的有问题吗？如果是，我该如何修复它以使 Eclipse 服务器使用与控制台相同的库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T01:08:54.910

APR 不是问题。当您从 eclipse 启动 tomcat 时，eclipse 会“覆盖”一些服务器配置（您也可以直接从 eclipse 中的 package/project explorer 下的“Server”项目中更改配置文件）。

如果你想访问你的 tomcat 的根目录，你可以双击服务器（当所有项目都被删除时）并选择显示`Takes control of Tomcat installation`. 然后保存，重新启动服务器，您将能够在`localhost`没有部署任何应用程序的情况下访问。

[PS这里](https://stackoverflow.com/questions/2848194/tomcat-works-but-i-cant-reach-http-localhost8080)已经有更详细的解释

# jsf-2 - Primefaces dataTable rowIndexVar 与分页

> ID：15124417
> 
> 赞同：3
> 
> 时间：2013-02-27T23:15:05.020
> 
> 标签：jsf-2, primefaces, datatable

我正在使用带有单行选择和分页的 primefaces 数据表。对于每一行，我都有一些命令链接（其中一个被禁用），我希望用户单击以对该行执行操作（例如：删除、编辑）。为了提供用户单击右侧行上的按钮的视觉确认，我希望在单击时选择该行，然后继续执行所需的 bean 方法。如果表格只有一页或者是第​​ 1 页，这将按预期工作；在所有其他页面上，我得到一个 NullPointerException。
我弄清楚为什么会发生这种情况：我使用 rowIndexVar 执行选择，但它似乎返回与整个表相关的索引，并且 selectRow 方法需要与当前页面相关的索引。这意味着如果我每页有 10 行，然后单击第二页的第三行，则返回的索引是“12”而不是“2”，并且 selectRow(12, false) 返回 null，因为上面只有 10 个项目页。

我的问题是：***如何传递正确的 rowIndex 以便在所有页面上获得正确的选择？***

支持 bean 是 ViewScoped，方法并没有什么特别之处，但由于它有很多与 web 服务和 jaxb 生成的类相关的代码，而且我签署了 NDA，我无法将其粘贴到此处（我已经通过共享数据表代码）。

```
<p:dataTable id="dataTable" var="item" rowIndexVar="rowIndex"
    value="#{dgRefTypePubBean.itemList}"      
    widgetVar="itemsTable"
    filteredValue="#{dgRefTypePubBean.filteredItems}" paginator="true"
    rows="10"
    paginatorTemplate="{FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
    rowsPerPageTemplate="2,5,10,20" rowKey="#{item.EID}"
    selection="#{dgRefTypePubBean.selectedItem}" selectionMode="single"
    emptyMessage="#{msgs['dgreftype.datatable.message.emptyList']}"
    resizableColumns="false">

    <p:ajax event="page" oncomplete="itemsTable.unselectAllRows(); itemsTable.selectRow(0, false)" />
    <p:ajax event="rowSelect" listener="#{dgRefTypePubBean.onRowSelect}"
        update=":form:obs :form:index_info :form:elimination_just :form:left_footer :form:right_footer" />
    <p:ajax event="rowUnselect" listener="#{dgRefTypePubBean.onRowUnselect}" update=":form:obs" />

    <p:column style="text-align:right; width:22px; border:none; background:white">
        <h:graphicImage rendered="#{item.EState==2}" library="images" name="data-delete.png" width="15" height="15" style="border:none; padding:0" />
    </p:column>
    <p:column id="codColumn" headerText="#{msgs['dgreftype.datatable.label.functionalCode']}" filterStyle="height:10px; font-weight:normal" style="text-align:left; width:120px" filterBy="#{item.EFunctionalCode}">
        <h:outputText value="#{item.EFunctionalCode}" />
    </p:column>
    <p:column id="designationColumn" headerText="#{msgs['dgreftype.datatable.label.name']}" filterStyle="height:10px; font-weight:normal" style="text-align:left; word-wrap: break-word" filterBy="#{item.EName}">
        <h:outputText value="#{item.EName}" />
    </p:column>
    <p:column id="variableColumn" headerText="#{msgs['dgreftype.datatable.label.variableTypeName']}" filterStyle="height:10px; font-weight:normal" style="text-align:left; width:200px" filterBy="#{item.EVariableTypeName}">
        <h:outputText value="#{item.EVariableTypeName}" />
    </p:column>
    <p:column id="buttonsColumn" style="width:55px">
        <h:panelGrid columns="3" style="border-collapse:separate; border:none !important">
            <h:commandLink onclick="itemsTable.unselectAllRows(); itemsTable.selectRow(#{rowIndex}, false)" action="#{dgRefTypePubBean.editSelectedItem()}">
                <h:graphicImage library="images" name="edit-text.png" width="15" height="15" style="border:none" />
            </h:commandLink>
            <h:graphicImage library="images" name="detail-disabled.png" width="15" height="15" style="border:none" onclick="itemsTable.unselectAllRows(); itemsTable.selectRow(#{rowIndex}, false)" />
            <h:commandLink onclick="itemsTable.unselectAllRows(); itemsTable.selectRow(#{rowIndex}, false); confirmation.show(); return false;">
                <h:graphicImage library="images" name="edit-delete.png" width="15" height="15" style="border:none" />
            </h:commandLink>
        </h:panelGrid>
    </p:column>
</p:dataTable> 
```

我正在使用 JSF 2.0 和 Primefaces 3.4.2。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-09T13:32:07.257

可以使用此功能从分页器获取当前页面：

```
itemsTable.paginator.getCurrentPage() 
```

因此，我们可以根据这个值、#{rowIndex} 的值和每页的最大行数来计算正确的行索引。

```
 <h:commandLink onclick="itemsTable.unselectAllRows(); itemsTable.selectRow(#{rowIndex}-itemsTable.paginator.getCurrentPage()*10)" action="#{dgRefTypePubBean.editSelectedItem()}">
      <h:graphicImage library="images" name="edit-text.png" width="15" height="15" style="border:none" />
 </h:commandLink> 
```

我希望这会有所帮助。

问候。

# visual-studio-2010 - 为什么我在 Visual Studio 中不断出现此弹出窗口（“文件已在源编辑器之外进行了修改）？

> ID：15124419
> 
> 赞同：1
> 
> 时间：2013-02-27T23:15:11.830
> 
> 标签：visual-studio-2010

这可能是一个非常简单的问题，但它让我发疯.. 所以，在 Visual Studio 2012 中，在编辑代码时，我不断得到：

```
"File has been modified outside of the source editor. Do you want to reload it" 
```

![在此处输入图像描述](../Images/d80532d298365b184aec162e0cb2e46c.png)

但我什至不记得编辑任何东西？SVN 能改变吗？（即如果代码在 SVN 中共享，如果其他人更改了 sxomething，那么它会询问我吗？）

# php - 多次从同一表单获取数据的不同方式

> ID：15124422
> 
> 赞同：0
> 
> 时间：2013-02-27T23:15:15.577
> 
> 标签：php, get

我有一个具有名称文本区域的表单。该表单指向我使用的主页，`$_GET['name']`然后将其存储到会话中并稍后使用。我需要这些会话中的每一个都是独一无二的，所以我用`$_GET`来帮助命名它们。

我现在面临的问题是我需要多次使用该表单并基于该表单存储多个会话，`$_GET`但每次我`$_GET`更改以前的会话名称时。

有什么更好的方法来处理这个问题？

就像是 ：

```
if (isset($_GET['name']))
{
    $_SESSION['name_' . $_GET['name']] = $_GET['name'];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:24:21.820

我不知道我对你的理解是否正确，但如果你想在同一用户、浏览器或其他任何东西的多个会话之间交换一些值，我建议使用 cookie。它们是独立于页面的，当然可以禁用 cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:28:20.903

你想要独一无二的吗？试试这个：

```
$_SESSION['my_unique_key'] = time();
$myS = $_SESSION['my_uniqie_key'];
$_SESSION['name_' . $_GET['name'] . '_' . $myS] = $_GET['name']; 
```

注意

```
 $_SESSION['my_unique_key'] 
```

将拥有唯一的密钥（几乎是唯一的），因为它获得了时间戳。因此，每次设置会话时，它都会获得唯一的密钥，因此每次提交表单时都会有不同的时间戳，这将是唯一的。

# git - 如何递归检出包括所有子模块的旧 git commit？

> ID：15124430
> 
> 赞同：54
> 
> 时间：2013-02-27T23:15:42.263
> 
> 标签：git, git-submodules

我有一个带有多个子模块的 git repo。这些子模块之一有它自己的多个子模块。我要做的就是检查主存储库上的旧提交，并让它检查来自所有子模块的适当提交，以获得当时代码的正确状态。

我知道 git 包含必要的信息，因为该`ls-tree`命令可以告诉我每个子模块在哪个提交上。但是，我必须手动检查每一个，这非常耗时。

我正在寻找类似的东西，`git checkout --recursive`但这样的命令似乎不存在。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-02-27T23:17:30.717

您需要两个命令来实现这一点：

```
git checkout *oldcommit*
git submodule update --recursive 
```

* * *

**更新：**截至 2018 年，此答案已过时 -有关更多当前信息，请参阅[下面的 VonC 答案。](https://stackoverflow.com/questions/15124430/how-to-checkout-old-git-commit-including-all-submodules-recursively/44249558#44249558)

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2017-05-29T19:50:50.310

注意：如果您有多个子模块（以及子模块内的子模块），Git 2.14（2017 年第三季度）将有所帮助（比 2013 年的 OP 更新）

```
git checkout --recurse-submodules 
```

> using`--recurse-submodules`将根据超级项目中记录的提交更新所有初始化子模块的内容。
> 如果子模块中的本地修改将被覆盖，则检出将失败，除非`-f`使用。

" `git checkout --recurse-submodules`" 不适用于本身具有子模块的子模块。它将与 Git 2.14 一起使用。

* * *

注意：使用 Git 2.19（2018 年第三季度）`git checkout --recurse-submodules another-branch`更强大。
之前，它没有报告在哪个子模块中更新工作树失败，这导致了一个无用的错误消息。

请参阅[Stefan Beller ( ) 的](https://github.com/stefanbeller)[提交 ba95d4e](https://github.com/git/git/commit/ba95d4e4bdf03badef6bc5c44bc059464f3e79d3)（2018 年 6 月 20 日[）](https://github.com/stefanbeller)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 392b3dd](https://github.com/git/git/commit/392b3dde513083b9975c990cd2cf410d2846b941))^(中，2018 年 7 月 24 日）)[`stefanbeller`](https://github.com/stefanbeller)
^([`gitster`](https://github.com/gitster))

> `submodule.c`: 报告发生错误的子模块
> 
> 当更新子模块的工作树发生错误时 `submodule_move_head`，告诉用户**错误发生在哪个子模块**。
> 
> 调用`read-tree`包含一个超级前缀，以便`read-tree` 正确报告任何与路径相关的问题，但一些错误消息不包含路径，例如：
> 
> ```
> ~/gerrit$ git checkout --recurse-submodules origin/master
> ~/gerrit$ fatal: failed to unpack tree object 07672f31880ba80300b38492df9d0acfcd6ee00a 
> ```
> 
> 提示哪个子模块有问题。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-03-19T23:13:57.773

根据旧结帐中是否有更多子模块，您可能必须执行以下操作来初始化新提交中不再存在的子模块：

```
git checkout *oldcommit*
git submodule init
git submodule update --recursive 
```

# php - 将 yyyy-mm-dd hh:mm:ss 转换为 dayoftheweek, dd of monthname yyyy

> ID：15124431
> 
> 赞同：0
> 
> 时间：2013-02-27T23:15:42.237
> 
> 标签：php, date

我几乎有这个

```
$this->fecha = '2013 05-05 05:55:05'
$yearvalue = date("Y", strtotime($this->fecha) );
$monthname = date("F", strtotime($this->fecha) );
$dayvalue = date("d", strtotime($this->fecha) );
$printFecha = "$dayvalue of $monthname $yearvalue"; 
```

输出 2013 年 5 月 5 日

如何获取星期几的名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:18:41.943

使用日期 2005-05-12:

```
echo date("l", mktime(0, 0, 0, 5, 12, 2005)); 
```

你会得到“星期四”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:23:29.693

你可以这样做，

```
echo date('l j \of F Y', $this->date); 
```

您的输出将是这样的

```
Sunday 5 of May 2013 
```

# c++ - 使用迭代器和内存位置检查列表中的对象实例

> ID：15124432
> 
> 赞同：0
> 
> 时间：2013-02-27T23:15:48.387
> 
> 标签：c++, list, this

我有一堂课，像这样：

```
class Particle()
{

    void CalcSomething(Super& arg){
        for(unsigned long long index = 0; index < arg.NumberOfParticle(); index ++){                              
            if(this != arg.ParticleMemoryPointer(index)){
                // Do the calculations
            }
        }
    }

} 
```

以下类包含粒子：

```
class Super()
{

    const Particle* const ParticleMemoryPointer(unsigned int index)
    {
        std::list<Particle>::iterator iter = mParticles.begin();
        std::advance(iter, index);
        return &(*iter);
    }

    std::list<Particle> mParticles;
} 
```

这个想法是，调用 CalcSomething 的粒子实例需要检测何时从与函数内部索引所寻址的粒子实例相同的 Particle 实例调用 CalcSomething `CalcSomething`。（这有意义吗？我的措辞不是很好……）

您意识到这样做的原因是，如果我们要在两个粒子之间进行计算，我们需要确保它们是*不同*的粒子。

一些 cout 语句显示 ParticleMemoryPointer 返回的内存地址`this`与列表中有一项时的指针不同。（它们应该是，对于一个项目，我们用同一个粒子进行两次计算。）

我希望这是可以理解的。

**编辑**Super 中调用 CalcSomething 的函数：

```
void Super::UpdateParticles(double time_step)
{
    std::list<Particle>::iterator iter = mParticles.begin();

    for(unsigned long long index = 0; index < mParticles.size(); index ++){
        std::advance(iter, 1);
        iter->CalcSomething(*this);
    }
} 
```

**编辑 2**我们不能使用 std::vector。（我们知道你在想它！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:43:38.057

将元素插入 a 后`list`，只要该列表和该元素存在，它的指针就永远不会失效。有关更多信息，请参阅此答案：[指向 std::vector 和 std::list 元素的指针](https://stackoverflow.com/questions/3287801/pointers-to-elements-of-stdvector-and-stdlist)

只需确保在插入列表后，您不会将未插入的原始元素与插入的元素进行比较 - 插入会将元素移动或复制到列表中。

出于您的预期目的，我不禁觉得有一种更简单的方法，一种不需要`Particle`了解任何关于的方法`Super`，甚至不需要检查指针：

（伪代码）

```
for particle in particles(start, end - 1):
    for otherParticle in particles(particle + 1, end)
        DoSomething(particle, otherParticle) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T01:12:57.897

```
template<typename Iter, typename Func>
void pair_wise(Iter it, Iter last, Func func) {
    while(it != last) {
        Iter other = it;
        ++other;
        while(other != last) {
            func(*it, *other);
            ++other;
        }
        ++it;
    }
} 
```

例如，这将使用 4 个值`1`、`2`、进行迭代`3`，`4`并将它们配对：

```
(1, 2), (1, 3), (1, 4)
(2, 3), (2, 4)
(3, 4) 
```

您可以将它与 C++11 中的 lambda 函数一起使用：

```
int main() {
    list<Particle> particles;

    pair_wise(particles.begin(), particles.end(),
              [](Particle& lhs, Particle& rhs) {
                  lhs.doSomething(rhs);
              });                  
} 
```

或 C++11 之前的版本，例如，使用函数指针：

```
void calcSomething(Particle& lhs, Particle& rhs) {
    lhs.calcSomething(rhs);
}

int main() {
    list<Particle> particles;

    pair_wise(particles.begin(), particles.end(),
              calcSomething);                  
} 
```

# c - 带有 CUDA 和 cudaMallocPitch 的二维数组

> ID：15124435
> 
> 赞同：1
> 
> 时间：2013-02-27T23:16:11.223
> 
> 标签：c, cuda, nvidia

我一直在阅读有关 2D 数组和 cudaMallocPitch 的 stackoverflow 上的一些线程，并且我尝试将 cudaMallocPitch 与我找到的小文档一起使用。但是我现在面临一个问题。

我需要通过一个数组并做类似的事情：

```
 for(int k=0; k<100; ++k){
     for(i=SID; i<SID+stride; ++i){
        while(-1 < j && Driver[k][j] != Road[i]){
            j = Pilot[j][k];

        }
        ++j;
     }
  } 
```

因此我想知道，我应该如何调整这段代码以使其适用于音高，因为我已经读过我必须将指针更新到行的开头。当然，我的内核收到以下内容：

```
__global__ void driving(char *Driver, size_t pitch_driver, 
                        char *Road, int *Pilot, size_t pitch_pilot) 
```

而且我不确定如何使事情正常进行，我一直在阅读和尝试，但目前似乎不起作用。

谢谢你。

**编辑 1：**我一直在阅读这个主题：[如何在 CUDA 中使用 2D 数组？](https://stackoverflow.com/questions/5029920/how-to-use-2d-arrays-in-cuda/9974989#9974989)并遇到了以下问题：

```
for (int row = 0; row < rowCount; row++)  
 {  
     // update the pointer to point to the beginning of the next row  
    float* rowData = (float*)(((char*)d_array) + (row * pitch));  
    for (int column = 0; column < columnCount; column++)  
     {  
       rowData[column] = 123.0; // make every value in the array 123.0  
       destinationArray[(row*columnCount) + column] = rowData[column];  
      }  
 } 
```

这是更新下一行的指针，我不确定如何使用我的 2 for 循环以及在前面的代码中工作时。

目前我只能访问数组的一维，而不能访问另一维。

它返回值 2，但是当我尝试多重比较时，它只返回 0，甚至比较两个值都不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-04T15:34:20.760

在 CUDA 参考手册中它说：

> 5.8.2.17 cudaError_t cudaMallocPitch (void devPtr, size_t pitch, size_t width, size_t height)
> 
> [...]
> 
> 给定类型 T 的数组元素的行和列，地址计算如下：
> 
> T* pElement = (T*)((char*)BaseAddress + Row * pitch) + Column;

因此，您需要先将指针转换为 char*，进行数学运算，然后再将其转换回您的类型。

# jquery - jQuery自动播放视频

> ID：15124438
> 
> 赞同：3
> 
> 时间：2013-02-27T23:16:23.760
> 
> 标签：jquery, html5-video

嗨，我有一些非常基本的 html 视频：

```
<div class="video_holder">
      <video id="video_player" controls="controls" poster=""> 
        <source id="video_mp4" src="" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"' />
      </video>
</div> 
```

在我的 js 中：

```
 function playFile(e) {
      ...
      e.preventDefault()
      var selected = $(this);
      var path = selected.attr('href');
      $("#video_mp4").attr('src', path);
      // how do I get this thing to auto-play?????
  }; 
```

这对于将正确的路径注入`src`属性非常有用，并且我已经验证了该路径是正确且可访问的。但是，我无法让视频在加载时自动播放。

我试过了：

```
document.getElementById("video_player").play();

$('#video_player').trigger('play');

$('#video_player').play(); 
```

如何触发视频自动播放？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-28T00:20:55.240

您可以使用：

```
$("#video_player")[0].play(); 
```

或者：

```
$("#video_player")[0].autoplay = true; 
```

或者：

```
document.getElementById("video_player").setAttribute('autoplay', true); 
```

什么适合你。使用`$('#video_player').play();`您正在引用`play`jQuery 中不存在的方法，您应该引用`$("#video_player")`.

要在 JS 中更改视频的 src，您只需要这样的东西：

```
function playFile() {
    var video = $("#video_player");
    video[0].src = "http://www.yoursrc.com/video_new.mp4";
    video[0].load();
    video[0].play();
}; 
```

* * *

**注意：**在 Chrome 中，如果要使用属性
，还需要添加属性。参考：[https ://developers.google.com/web/updates/2017/09/autoplay-policy-changes](https://developers.google.com/web/updates/2017/09/autoplay-policy-changes)`muted``autoplay`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-12-17T16:03:06.740

**这是一个循环播放整个窗口和自动播放的视频**示例。它是通过 JavaScript 按需创建的。

我需要这个视频**只应在请求时加载和播放**，即不是在页面的每次加载时。（用 隐藏元素是`display: none;`不行的，因为即使没有显示，视频仍然会加载。）

# JavaScript

```
/**
 * Create the video.
 *
 * An alternative might have been to use an HTML template tag inside the Twig template,
 * to then create an element and append it. But this worked only in Chrome:
 * - in Firefox, `autoplay loop muted` (inside the <template>) get converted to
 *   `autoplay="" loop="" muted=""` (in the Inspector) and there's no playback.
 * - in Safari, nothing happens.
 *
 * Another alternative (that worked this one) is to just append the whole HTML as a
 * single string, but it's harder to read.
 */
var video = $('<video />', {
    id: 'video',
    class: 'myclass',
    poster: 'https://path/to/my/poster.jpg'
}).prop({
    muted: true,
    autoplay: true,
    loop: true,
});
var src1 = $('<source />', {
    type: 'video/webm', // for Firefox, Chrome; slightly smaller file size
    src: 'https://path/to/my/video.webm'
}).appendTo(video);
var src2 = $('<source />', {
    type: 'video/mp4', // for Safari, Firefox, Chrome
    src: 'https://path/to/my/video.mp4'
}).appendTo(video);
video.appendTo($('body')); 
```

注意：

*   **`muted`, `autoplay`,`loop`必须进去`prop()`**。将它们设置为属性将**不起作用**！（并且会产生很大的误导，因为你会认为你设置了它们，而实际上你并没有。）
*   **`muted`**Chrome 中需要它`autoplay`才能工作。
*   创建海报的一种简单方法：用 VLC 打开视频，拍一张`Snapshot`，将生成的 PNG 转换为 JPG。
*   确保视频已正确转换。并非所有 MP4 文件都可以在浏览器中使用。这被证明是有用[的：使用 FFmpeg (for Web) 进行视频转换](https://gist.github.com/jaydenseric/220c785d6289bcfd7366)。

上面提到的难以阅读的替代方案：

```
$('body').append('<video class="c-congrats  c-congrats--outofnew" autoplay loop muted> <source src="https://path/to/my/video.webm" type="video/webm" /> <source src="https://path/to/my/video.mp4" type="video/mp4" /> Your browser does not support the video tag. </video>') 
```

# CSS

```
.myclass {
    position: fixed;
    z-index: -1;
    height: 100vh;
    top: 0;
    left: 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-28T09:20:18.933

请检查这个简单的步骤，这对我很有效

```
$('video').trigger('play'); 
```

谢谢

# python - Python Pandas 中因子变量的最接近等价物

> ID：15124439
> 
> 赞同：40
> 
> 时间：2013-02-27T23:16:34.673
> 
> 标签：python, r, pandas

[与Python pandas](http://pandas.pydata.org/)中的[R 因子变量](http://www.stat.berkeley.edu/classes/s133/factors.html)最接近的等价物是什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2014-11-19T17:46:49.703

这个问题似乎是从一年前开始的，但由于它仍然是开放的，所以这里有一个更新。pandas 引入了一个`categorical`dtype，它的操作与 R 非常相似`factors`。有关更多信息，请参阅此链接：

[http://pandas-docs.github.io/pandas-docs-travis/categorical.html](http://pandas-docs.github.io/pandas-docs-travis/categorical.html)

从上面的链接中复制一个片段，展示如何在 pandas 中创建“因子”变量。

```
In [1]: s = Series(["a","b","c","a"], dtype="category")

In [2]: s
Out[2]: 
0    a
1    b
2    c
3    a
dtype: category
Categories (3, object): [a < b < c] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-14T06:08:22.513

如果你想做建模等，[patsy 库](https://pypi.python.org/pypi/patsy/)中有很多好东西。我承认我自己也曾为此苦苦挣扎。我发现[这些幻灯片](http://jseabold.net/presentations/seabold_pydata2012.html#slide1)很有帮助。希望我能举一个更好的例子，但这是我自己得到的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-06T22:11:29.310

如果您希望像 R 一样将分类变量映射到数字，Pandas 实现了一个功能，它将为您提供这样的功能：[https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas。分解.html](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.factorize.html)

```
import pandas as pd

df = pd.read_csv('path_to_your_file')
df['new_factor'], _ = pd.factorize(df['old_categorical'], sort=True) 
```

此函数返回枚举映射以及唯一值列表。如果你只是在做变量赋值，你必须像上面那样把后者扔掉。

如果您想要一个本土解决方案，您可以在函数中使用集合和字典的组合。此方法更容易应用于多个列，但您必须注意 None、NaN 等将作为一个类别包含在此方法中：

```
def factor(var):
    var_set = set(var)
    var_set = {x: y for x, y in [pair for pair in zip(var_set, range(len(var_set)))]}
    return [var_set[x] for x in var]

df['new_factor1'] = df['old_categorical1'].apply(factor)
df[['new_factor2', 'new_factor3']] = df[['old_categorical2', 'old_categorical3']].apply(factor) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-04T06:01:34.833

```
C # array containing category data
V # array containing numerical data

H = np.unique(C)
mydict = {}
for h in H:
    mydict[h] = V[C==h]

boxplot(mydict.values(), labels=mydict.keys()) 
```

# assembly - NASM中“section”和“segment”的区别

> ID：15124440
> 
> 赞同：25
> 
> 时间：2013-02-27T23:16:36.740
> 
> 标签：assembly, syntax, nasm

我正在使用一些婴儿 NASM 程序来帮助我学习语言。

根据我的阅读，NASM 程序可以分为三个部分；.data、.bss 和 .text 是强制性的。但是，我经常发现有时部门的名称是，有时`section`是`segment`。

例如，我在网上找到的这个“Hello World”：

```
;  hello.asm  a first program for nasm for Linux, Intel, gcc
;
; assemble: nasm -f elf -l hello.lst  hello.asm
; link:     gcc -o hello  hello.o
; run:          hello 
; output is:    Hello World 

    SECTION .data       ; data section
msg:    db "Hello World",10 ; the string to print, 10=cr
len:    equ $-msg       ; "$" means "here"
                ; len is a value, not an address

    SECTION .text       ; code section
        global main     ; make label available to linker 
main:               ; standard  gcc  entry point

    mov edx,len     ; arg3, length of string to print
    mov ecx,msg     ; arg2, pointer to string
    mov ebx,1       ; arg1, where to write, screen
    mov eax,4       ; write sysout command to int 80 hex
    int 0x80        ; interrupt 80 hex, call kernel

    mov ebx,0       ; exit code, 0=normal
    mov eax,1       ; exit command to kernel
    int 0x80        ; interrupt 80 hex, call kernel 
```

如果我将每个实例更改`SECTION`为`SEGMENT`它仍然可以工作。

有人可以解释两者之间的区别（如果有的话）吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-27T23:21:43.130

从[nasm 文档](http://www.nasm.us/xdoc/2.10.07/html/nasmdoc6.html#section-6.3)：

> SECTION 指令（SEGMENT 是完全等价的同义词）

Nasm 可以产生各种格式的输出，其中一些支持部分。某些部分名称可以是任意的（例如您列出的三个），对于它们来说，只有部分标志才算在内。预定义的只是方便快捷方式，`.text`被标记为包含代码、`.data`读写初始化数据和`.bss`零初始化读写数据。只要将代码标记为代码部分，您就可以将代码放在一个名为`foo`的部分中，并且您可以根据需要使用多个部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-01-27T12:37:08.290

此外，值得注意的是，您可以使用特殊标志定义*自己的部分（并更改默认部分的标志），这是***对部分指令的精灵扩展。** [从文档](https://www.nasm.us/doc/nasmdoc7.html#section-7.9.2)：

> 与 obj 格式一样，elf 允许您在 SECTION 指令行上指定附加信息，以控制您声明的部分的类型和属性。

例如，您可以创建这样的部分：

```
section .special write 
```

组装后您可以检查它：`readelf -S test.o`

```
[3] .special          PROGBITS         0000000000000000  00000250
   0000000000000005  0000000000000000  WA       0     0     1 
```

# jquery - jQuery：检测 src= 属性中的字符

> ID：15124441
> 
> 赞同：1
> 
> 时间：2013-02-27T23:16:37.743
> 
> 标签：jquery

我一直在尝试在 SO 中查看其他帖子，但我无法将我的头脑围绕在代码示例中。请注意，我仍在学习 jQuery/JavaScript，非常感谢您对此的任何帮助。

假设我在网站上的许多不同页面上都有这些图像：

第 1 页：`<img alt="..." src="images/ss-project-name.png">`

第2页：`<img alt="..." src="images/ss-another-project-name.png">`

第 3 页：`<img alt="..." src="images/ss-yet-another-project-name.png">`

网站上有很多这样的图像，编辑标记是不可能的，我需要为`class="screenshot"`所有这些图像添加一个。

所以我最终会得到这样的结果：

`<img alt="..." src="images/ss-project-name.png" class="screenshot">`

以下是我尝试过的一些脚本，它们当然不起作用，但它可以让您了解我想要完成的工作：

尝试#1：

```
$('img').each(function(){
    if ($(this).attr('src') == "ss-"){
        $(this).addClass('screenshot');
    }
}); 
```

尝试#2：

```
$("img:has([src^='ss-'])").addClass('screenshot'); 
```

对此的任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:20:15.997

你很接近，这应该工作：

```
$("img[src*='ss-']").addClass('screenshot'); 
```

您第一次尝试失败的原因是因为您正在测试该`src`属性是否完全`ss-`不包含该子字符串。第二次尝试没有奏效，因为`:has()`正如[jQuery 文档](http://api.jquery.com/has-selector/)所说：

> 选择至少包含一个与指定选择器匹配的元素的元素。

而且还因为`[src^='ss-']`会查找以`src` **开头**的元素`ss-`，并且在您的情况下，它们以字符串开头`images/`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:29:05.227

你可以试试这个选择器：`$('img[src*="images/ss-"]').addClass('screenshot');`

它将从图像目录中找到所有以`ss-`. 作为选择器的一部分添加`images/`将避免匹配文件，例如`<img src="media/miss-you-so-much.png" />`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:22:19.380

试试这个代码

```
 $('img').each(function(){
        var src = $(this).attr('src'); 
        if (src.substr(0,2) == "ss-"){
            $(this).addClass('screenshot');
        }
    }); 
```

# jquery - jQuery 多个幻灯片切换

> ID：15124444
> 
> 赞同：0
> 
> 时间：2013-02-27T23:16:48.963
> 
> 标签：jquery, html

```
$(document).ready(function(){
    $('#event1').click(function(){
        $('.eventdetails').slideToggle('fast');
    });
}); 
```

我的问题是一次有多个`events`切换多个`eventdetails`。我考虑过为每个人设置不同的 ID。但是我不知道如何仍然能够通过 HTML 表单创建更多事件，并且不是让每个事件都切换每个事件细节。

页面的相关 HTML：

```
<p class="event" id="event1">Hawksbury 1</p>
<div class="eventdetails" >
    <form name="event" method="post" action="">
        <table>
            <tr>
                <td><div>Transport</div></td>
                <td><input type="checkbox" name="transport" id="transport"> </input></td>
                <td><div>Accomodation</div></td>
                <td><input type="checkbox" name="accomodation" id="accomodation"></input></td>
            </tr>
            <tr>
                <td><div>Food</div></td>
                <td><input type="checkbox" name="food" id="food"> </input></td>
                <td><div>Competing</div></td>
                <td><input type="checkbox" name="competing"     id="competing"></input></td>
            </tr>
            <tr>    
            <td><input type="submit"></input></td>
            </tr>
        </table>
    </form>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T03:53:31.503

尝试使用类而不是 id 进行查询：

```
$(document).ready(function(){
    $('.event').click(function(){
        $(this).next('.eventdetails').slideToggle('fast');
    });
}); 
```

演示：http: [//jsfiddle.net/WMzKm/](http://jsfiddle.net/WMzKm/)

如果您还不熟悉 jquery： $(this).next() 将返回您单击的元素的以下兄弟。[在这里](http://api.jquery.com/next/)查看更多。

# jquery - 关闭窗口后，带有 youtube 视频的 jquery ui 对话框消失

> ID：15124449
> 
> 赞同：1
> 
> 时间：2013-02-27T23:16:56.213
> 
> 标签：jquery, jquery-ui

我一直在使用 jquery ui 的对话框弹出框在其中放置一个 youtube 视频....

它工作得很好，但我想要的是当用户在你的管视频上点击播放时......如果他们点击 x 关闭开箱......视频停止播放但是当我重新打开盒子时盒子又是空的

所以我的问题是我该怎么做才能让当用户关闭开箱时视频停止播放，他们可以重新打开盒子再次观看视频

继承人的html

```
 <h2 class="demoHeaders">Dialog</h2>
  <p><a href="#" id="dialog-link" class="ui-state-default ui-corner-all"><span class="ui-          icon ui-icon-newwin"></span>Open Dialog</a></p>

   <!-- ui-dialog -->
   <div id="dialog" title="Dialog Title">
<iframe width="560" height="315" src="http://www.youtube.com/embed/7Lmxmh9zDEk"   frameborder="0" allowfullscreen></iframe>
   </div> 
```

这是jquery

```
$(function() {

    $( "#dialog" ).dialog({
        autoOpen: false,
        width: 400,
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            },
            {
                text: "Cancel",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    // Link to open the dialog
    $( "#dialog-link" ).click(function( event ) {
        $( "#dialog" ).dialog( "open" );
        event.preventDefault();
    });

            $(".ui-icon-closethick").click (event) ->
        event.preventDefault()
       $("#video").remove() 
```

这是小提琴的链接[http://jsfiddle.net/QBKzH/1/](http://jsfiddle.net/QBKzH/1/)

谢谢你们的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:28:29.017

我遇到过同样的问题。我从我的嵌入中抓取了 url，并在事件点击时将其附加，并在模式关闭时将其分离。我相信你可以在你的 iframe 中做同样的事情。

给你的 iframe 一个 id

`<iframe id="video" />`或者其他的东西

```
$('#dialog-link').on("click", function(e) {
    e.preventDefault();

            // Set video url
    var videoSourceLink = 'http://www.youtube.com/embed/7Lmxmh9zDEk';

            // Attach video link
    $('#video').attr('src', videoSourceLink);

    $('#dialog').dialog({
        modal: true,
        width:658,
        height:404,
        resizable: false,
        open: function(){
            $('.ui-widget-overlay').bind('click',function(){
                $('#video').removeAttr('src');  
                $('<don't remember what this select is').dialog('close');                
            });
        }                   
    });
}); 
```

# javascript - 什么是 CommonJS，我为什么要关心它如何帮助编写 .js 应用程序？

> ID：15124451
> 
> 赞同：79
> 
> 时间：2013-02-27T23:16:59.913
> 
> 标签：javascript, commonjs

我正在学习 JS，更有经验的人提到他们使用 CommonJS 来处理保持 js 代码的组织性（因为没有“模块”功能）。

我查看了 Quora，但它解释了*小组*及其目标，而不是我如何使用它。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-02-27T23:28:38.127

CommonJS 模块使您能够在当前范围内包含 javascript 模块，并有效地防止全局范围被污染。

这大大减少了命名冲突的机会并保持代码井井有条。

话虽如此，我认为 AMD 模块现在比 CommonJS 更受欢迎是很安全的。

RequireJS 网站上有一个很好的部分，介绍了[为什么要使用模块](http://requirejs.org/docs/whyamd.html)以及 CommonJS 和 AMD 之间的区别。

# jquery - 如何使用 JQuery datepicker 将默认日期设置为即将到来的星期六和星期日？

> ID：15124452
> 
> 赞同：1
> 
> 时间：2013-02-27T23:17:00.367
> 
> 标签：jquery, datepicker

我对 JQuery 很陌生，我找不到解决问题的正确方法。

所以这里是我写的代码：

```
$(function() {
         $("#from").datepicker({
                    //dateFormat: 'yy-mm-dd',
                        minDate: 0,
                    defaultDate: "+1w",
                    changeMonth: true,
                    numberOfMonths: 1,
                        dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'], 
                    onSelect: function(selectedDate) {
                        $("#to").datepicker("option", "minDate", selectedDate);
                    }
                });

                $("#to").datepicker({
                    //dateFormat: 'yy-mm-dd',
                        minDate: 0,
                    defaultDate: "+1w",
                    changeMonth: true,
                    numberOfMonths: 1,
                        dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                    onSelect: function(selectedDate) {
                        $("#from").datepicker("option", "maxDate", selectedDate);
                    }
                });
}); 
```

如果今天在星期六之前，我想将“#from”文本框设置为最近的星期六（日期），将“#to”文本框设置为星期日（日期），否则，将星期日（日期）设置为两个文本框中的默认值天。

前任。今天是 2013 年 2 月 27 日（星期三），我想把 03/02/2013 放在“#from”中，把 03/03/2013 放在“#to”中，如果今天是 03/02/2013，我想把2013 年 3 月 3 日在两个文本框中。

我想创建一个变量 currDay 并将今天的日期存储到它。由于 datepicker 中的天数从 0 到 6，然后我将计算当天与即将到来的星期六/星期日之间的差异，然后将默认日期设置为 currDay + diff

我该怎么做呢？

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:41:29.290

我可能没有很好地澄清我的问题...感谢 r0m4n 的尝试。我自己设法解决了这个问题。如果您将以下代码粘贴到您的 js 部分中，您将看到我正在尝试做什么...

```
function toDay() {
    var date = new Date();
    var currDay = date.getDay();
    var diff = 7 - currDay;
    return (diff);
}

$(function () {
    var saturday = new Date();
    var sunday = new Date();
    sunday.setDate(sunday.getDate() + toDay());
    if (toDay != 0) {
        saturday.setDate(saturday.getDate() - 1 + toDay());
    } else {
        saturday = sunday;
    }
    var comingSaturday = (saturday.getMonth() + 1) + '/' + saturday.getDate() + '/' + saturday.getFullYear();

    var comingSunday = (sunday.getMonth() + 1) + '/' + sunday.getDate() + '/' + sunday.getFullYear();
    $("#from").val(comingSaturday);
    $("#to").val(comingSunday);
}) 
```

当然，我是新手....我可能犯了一些错误，请随时为我挑选错误。再次感谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:22:28.243

如果您获得一周中的当前日期，您可以从一周中的位置中减去该数字以获得您想要的结果：

```
$(function () {
    var d = new Date();
    var n = d.getDay();

    var from=6-n;
    var to=7-n;

    if(n==0)
        from=0;

    $("#from").datepicker({
        //dateFormat: 'yy-mm-dd',
        minDate: 0,
        defaultDate: "+"+from+"d",
        changeMonth: true,
        numberOfMonths: 1,
        dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
        onSelect: function (selectedDate) {
            $("#to").datepicker("option", "minDate", selectedDate);
        }
    });

    $("#to").datepicker({
        //dateFormat: 'yy-mm-dd',
        minDate: 0,
        defaultDate:  "+"+to+"d",
        changeMonth: true,
        numberOfMonths: 1,
        dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
        onSelect: function (selectedDate) {
            $("#from").datepicker("option", "maxDate", selectedDate);
        }
    });
}); 
```

[http://jsfiddle.net/6WHyK/](http://jsfiddle.net/6WHyK/)

# c# - 关闭时打开前一个表单

> ID：15124454
> 
> 赞同：0
> 
> 时间：2013-02-27T23:17:00.783
> 
> 标签：c#

首先，我是 C# 和一般编程的新手。我已经进行了相当彻底的搜索，但我只能找到有人想要打开另一个表单并隐藏按下按钮的表单的实例。

在这种情况下，当我在除主“Form1”之外的任何表单上按 (X) 时，我的程序持续运行时遇到问题。表单到表单导航工作正常。即：单击一个按钮隐藏主窗口并打开相应的表单，该表单上的“后退”按钮隐藏自身并显示（我猜是另一个实例）前一个“主”表单。——我可能也可以在这方面使用一些指导。哈哈

如果按下 X，我不介意关闭整个应用程序，但我需要在所有窗口上显示“X”，如果按下 X，所有窗口都需要退出整个应用程序。有什么建议么？

提前致谢，

代码：

**表格1：**

```
 public partial class Form1 : Form
        {
            public Form1()
            {
                InitializeComponent();
            }
            public void btnTransaction_Click(object sender, EventArgs e)
            {
                Transaction transactionForm = new Transaction();
                Form mainForm = this;
                transactionForm.Show();
                mainForm.Hide();
            }
        } 
```

**交易表格：**

```
 public partial class Transaction : Form
        {
            public Transaction()
            {
                InitializeComponent();
            }
            private void button4_Click(object sender, EventArgs e)
            {
                Form1 mainForm = new Form1(); //not sure if I'm doing this right..
                this.Hide();                  //I don't know how to "reuse" the original Form1
                mainForm.Show();
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:03:54.830

我建议您为此创建一个 MDI 容器。将一个 MenuStrip 从 ToolBox 拖放到 Form1，然后在 MenuStrip 中创建一个 ToolStripMenuItem“form2”。现在你可以像这样在form1中调用你的form2

```
public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            IsMdiContainer = true;
        }
        Form2 frm2;
        public void CreateMdiChild<T>(ref T t) where T : Form, new()
        {
            if (t == null || t.IsDisposed)
            {
                t = new T();
                t.MdiParent = this;
                t.Show();
            }
            else
            {
                if (t.WindowState == FormWindowState.Minimized)
                {
                    t.WindowState = FormWindowState.Normal;
                }
                else
                {
                    t.Activate();
                }
            }
        }
        private void form2ToolStripMenuItem_Click(object sender, EventArgs e)
        {
            CreateMdiChild<Form2>(ref frm2);
        }
    } 
```

当通过单击 ToolStripMenuItem 触发 ToolStripmenuItem 事件时，它会将 Form2 显示为 form1 中的子项，即 mdi 容器，并在您关闭 form1 时关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:23:51.890

您可以使用`Form.ShowDialog()`

调用此方法时，它后面的代码（'ShowDialog()' 下面的代码）直到对话框关闭后才会执行。

```
private void button4_Click(object sender, EventArgs e)
{
    Form1 mainForm = new Form1();
    this.Hide();                 
    mainForm.ShowDialog();
    this.Show();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:25:24.877

您可以使用`ShowDialog()`要求用户在返回前一个表单之前与新表单交互的方法。例如你可以试试这个：

```
public void btnTransaction_Click(object sender, EventArgs e)
{
    using (var transactionForm = new Transaction())
    {
      this.Hide();
      if (transactionForm.ShowDialog() == DialogResult.OK)
      {
          this.Show();
      }
    }
} 
```

这`DialogResult`是您可以设置的东西，`TransactionForm`如下所示：

```
private void button4_Click(object sender, EventArgs e)
{
    this.DialogResult = DialogResult.OK;
    this.Close();
} 
```

这是在新表单上强制交互的一种非常标准的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T23:23:14.473

```
 public partial class Transaction : Form
    {
        Form1 _mainForm;

        public Transaction(Form1 mainForm)
        {
            InitializeComponent();
            _mainForm = mainForm;
        }
        private void button4_Click(object sender, EventArgs e)
        {
            this.Close();  //since you always create a new one in Form1
            _mainForm.Show();
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-21T04:27:16.847

```
protected override void OnClosing(CancelEventArgs e)
{
    this.Hide();
    menu menu = new menu("administrator");
    menu.ShowDialog();
    this.Close();
} 
```

//快乐编码

# c# - 如何为 DNN WebAPI 端点提供凭据？

> ID：15124473
> 
> 赞同：4
> 
> 时间：2013-02-27T23:18:30.077
> 
> 标签：c#, dotnetnuke, asp.net-web-api

我有一个 DNN 7 网站，其 Web 服务端点如下：

```
public class DNNRoleManagementServiceController: DnnApiController
{
    //[AllowAnonymous]
    [RequireHost]
    [HttpGet]
    public HttpResponseMessage ManagePortalUserToRole(int PortalID, int UserID, int RoleID, bool RemoveFromRole )
    {
        //stuff
    }
} 
```

它是用于开发的 AllowAnonymous，现在是 RequireHost，因为端点上的安全性很好。这些端点只能由我们的系统使用，因此`[RequireHost]`似乎是正确的身份验证级别。

我有我的 c# 库来调用这个端点：

```
WebClient webClient = new WebClient();
Uri uri = new Uri(uriString.ToString());
webClient.Credentials = new NetworkCredential("host", "password");
webClient.DownloadStringCompleted += GetStringCompleted;
webClient.DownloadStringAsync(uri); 
```

即使使用正确的密码，我得到的只是 400 或 401 响应。所以很明显，我以错误的方式提供了我的凭据。只是，正确的方法是什么？我在 DNN WebAPI 上找到的所有文档都是“应用`[AllowAnonymous]`属性，以便任何人和他们的狗都可以使用您的网络服务！” 如果您提供的服务是供公众消费的，那就太好了。这不是其中一种情况。

那么提供主机凭据以使调用有效的正确方法是什么？我真的不确定这里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T11:02:38.280

你试过做

`[DnnAuthorize(RequireHost=true)]`

不知道它是否会起作用，因为我只为实际登录的用户而不是从外部来源传递用户名和密码凭据。

您也许可以查看这个 codeplex 项目以获取更多信息。

[Codeplex：dnndashservice](http://dnndashservice.codeplex.com/SourceControl/changeset/view/20684#287707)

# ruby - Ruby、文件、制表符

> ID：15124476
> 
> 赞同：1
> 
> 时间：2013-02-27T23:18:42.630
> 
> 标签：ruby, csv, tabs

我正在解析一个 csv 文件，该文件在每列之后都有“\t”字符。为什么当我在终端中打印出单独的行或在文本编辑器中打开文件时，每列之间的制表符间距不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:37:50.257

你的意思是像

```
1   1
12345678    1 
```

后果

```
puts "1\t1"
puts "12345678\t1" 
```

一个制表符以 8 个空格的步长跳到下一个位置（8 个空格是常见的距离，但这取决于您的编辑器的设置。对于 ruby​​，通常使用 2 个空格的距离）。

如果前面的文本长于 8 个字符，那么你跳到下一个位置，你会有不同制表符间距的印象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:55:58.223

当您使用制表符时，您实际上是在移动到下一个制表符位置，而不是移动特定距离。要查看差异，请尝试使用 4 个空格而不是制表符。或者，或者，运行以下代码，我认为您可能会清楚。

```
puts "Hel\tlo world!"
puts "H\tello world!"
puts "Hell\to world!" 
```

希望有帮助。

# c++ - 加载共享库时出错

> ID：15124480
> 
> 赞同：2
> 
> 时间：2013-02-27T23:18:59.440
> 
> 标签：c++, static-libraries

我正在尝试解决这个问题，但我不能。

我对 libboost 有疑问。

```
error while loading shared libraries: libboost_filesystem.so.1.42.0: cannot open shared object file: No such file or directory 
```

我也确实重新安装了它。

> apt-get 删除 libboost1.42-dev apt-get install libboost1.42-dev

但它仍然不起作用。

我也读过它：[Compiled C++ program raises "cannot open shared object file" on another system but the file is present](https://stackoverflow.com/questions/4078292/compiled-c-program-raises-cannot-open-shared-object-file-on-another-system-t)

但我仍然不知道我应该做什么。

你能逐步解释我如何解决它吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:27:22.363

如果我的记忆还不错的话，Ubuntu 的`libboost-dev`软件包并没有安装整套 Boost 库，而只是安装了一些有限的一套。所以你需要安装`libboost-filesystem-dev`. 不过，对您来说最简单的方法可能是安装`libboost-all-dev`它应该将整个 Boost 库集合带到您的系统中。

# mysql - MySQL“未知”

> ID：15124490
> 
> 赞同：7
> 
> 时间：2013-02-27T23:20:23.647
> 
> 标签：mysql

我刚刚发现[你可以写](http://dev.mysql.com/doc/refman/5.1/en/comparison-operators.html#operator_is)类似的东西

```
SELECT NULL IS UNKNOWN 
```

哪个返回`1`。

还有其他地方可以使用`UNKNOWN`吗？它似乎不是关键字（不能做`SELECT UNKNOWN`）。`NULL IS NULL`也是如此，那么有什么目的`UNKNOWN`呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-28T00:00:48.860

`UNKNOWN`只是`BOOLEAN` `NULL`...的`TRUE`别名_ _ [_](http://dev.mysql.com/doc/refman/5.0/en/numeric-type-overview.html) [_](http://dev.mysql.com/doc/refman/5.0/en/numeric-type-overview.html)`1``FALSE``0`[`BOOLEAN``TINYINT(1)`](http://dev.mysql.com/doc/refman/5.0/en/numeric-type-overview.html)

为什么它甚至在那里？因为它是 SQL-92 标准的一部分：

```
<truth value> ::=
                TRUE
              | FALSE
              | UNKNOWN 
```

为什么你可以`SELECT NULL`，，，`SELECT TRUE`却`SELECT FALSE`不行`SELECT UNKNOWN`？可能只是一个错误，[因为`UNKNOWN`直到更新版本的 MySql 才支持它本身](http://bugs.mysql.com/bug.php?id=24531)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:27:36.060

在我看来，在 MySQL 中，`UNKNOWN`是 的别名`NULL`，用于布尔意义。

我可以找到这个参考：

> 在 SQL 中，所有逻辑运算符的计算结果为 TRUE、FALSE 或 NULL (UNKNOWN)。

[MySQL 文档 - 12.3.3。逻辑运算符](http://dev.mysql.com/doc/refman/5.0/en/logical-operators.html)

有关一般 SQL NULL 和 UNKNOWN 的更多信息：

> 当受 NOT NULL 约束时，SQL BOOLEAN 的工作方式与其他语言中的布尔类型类似。然而，不受限制，BOOLEAN 数据类型，尽管它的名字，可以保存真值 TRUE、FALSE 和 UNKNOWN，所有这些都根据标准定义为布尔文字。该标准还断言 NULL 和 UNKNOWN “可以互换使用以表示完全相同的事物”。

[维基百科上的 NULL](http://en.wikipedia.org/wiki/Null_%28SQL%29#Data_typing_of_Null_and_Unknown)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T23:25:28.203

它的唯一用途是描述一个没有已知值的布尔值。就像第一个例子说的那样，它相当于`NULL`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-30T12:54:54.677

当比较涉及 NULL 时，在这种情况下，`unknown`就会出现。

例如，考虑以下查询：

```
select* from tbl
where x>5 
```

在这里，假设某些元组可能包含列的空值`x`。现在，在评估每个元组时：

1.  如果 x 不为空且 x>5，则表达式的`x>5`计算结果为 true
2.  如果 x 为非空且 x<=5，则表达式的`x>5`计算结果为 false
3.  但是如果 x 为 null，那么表达式的`x>5`计算结果是什么？（答案未知）

对于案例 3，说真假中的任何一个都是错误的。因此，为了处理 case-3，sql 中存在另一个逻辑值，即`unknown`.
（因此，sql中有3个逻辑值：真、假、未知）

现在，规则是：

> 如果一个元组的 where 子句谓词计算结果为 false 或 unknown，则该元组不会添加到结果中。

因此，对于上面的例子，只有 case-1 元组会被添加到结果中。

这样，SQL 在内部玩弄着unknown。

此外，当 where 子句谓词涉及多个逻辑表达式时，我们会得到一些结果：

*   表达式的结果`true and unknown`是`unknown`
*   表达式的结果`false and unknown`是`false`
*   表达式的结果`unknown and unknown`是`unknown`
*   表达式的结果`true or unknown`是`true`
*   表达式的结果`false or unknown`是`unknown`
*   表达式的结果`unknown or unknown`是`unknown`
*   表达式的结果`not unknown`是`unknown`

# android - AsynTask 取消长时间运行的操作，如 HttpGet

> ID：15124499
> 
> 赞同：0
> 
> 时间：2013-02-27T23:21:45.320
> 
> 标签：android, android-asynctask

我看过[其他](https://stackoverflow.com/questions/14724640/asynctask-is-not-cancelling-the-long-running-operation-in-android)几篇关于取消 AsynTask 的帖子，但我认为它们中的任何一个都不能解决问题。想象一下这个场景：

```
public class TestTask extends AsyncTask<Void, Void, Object> {

@Override
protected void onCancelled(Object result) {
    running = false;
    Log.i("Test", "onCancelled");
}

@Override
protected Object doInBackground(Void... params) {
        try {
            Log.i("Test", "cancelling");
            cancel(true);
            Thread.sleep(5000);
            Log.i("Test", "Past sleep");
        } catch (InterruptedException e) {
            Log.i("Test", "InterruptedException", e);
        }

    return null;
}

} 
```

想象一下，我想在下载过程中取消这个长达 20 秒的请求，例如，如果服务器对 json 请求的响应速度很慢。所以 Thread.sleep(5000) 可能是我想取消的 HttpGet 请求。但是，取消方法被标记为最终方法，因此我无法覆盖它并调用 get.abort()。onCancel 钩子发生在 doInBackground 之后并返回 UI 线程。一旦 HttpGet 请求开始，检查 isCancel 对我没有任何好处。

我解决这个问题的方法是在我的 AsynTask 上创建一个 abort() 方法，然后调用它。

```
public void abort() {
   get.abort();
   cancel(true);
} 
```

但这似乎有点违背Android的原则。有没有更好的方法来取消请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:24:00.993

在 的[文档中`HttpGet`](http://developer.android.com/reference/org/apache/http/client/methods/HttpUriRequest.html#abort%28%29)，没有提及线程安全，因此调用`abort()`您描述的方式可能会导致不希望的结果（充其量）。你可以做的是`HttpGet`在你的构造函数中传递一个对象`AsyncTask`，或者通过一个setter（只要你在调用之前这样做`AsyncTask.execute()`）。

`doInBackground()`如果任务已被取消，您必须定期检查内部：

```
@Override
protected Object doInBackground(Void... params) {
        // start GET request
        try {
            Log.i("Test", "cancelling");
            cancel(true);
            Thread.sleep(5000);
            Log.i("Test", "Past sleep");

            if ( this.isCancelled() ) {
               // abort GET request and/or stop doing other work
               return null;
            }
            else {
                // do what ever work you need to
            }
        } catch (InterruptedException e) {
            Log.i("Test", "InterruptedException", e);
        }

    return null;
} 
```

[来源](http://developer.android.com/reference/android/os/AsyncTask.html#isCancelled%28%29)。

`AsyncTask.cancel(true)`每当您觉得应该停止任务时，您都可以随时调用( [`AsyncTask.cancel()`](http://developer.android.com/reference/android/os/AsyncTask.html#cancel%28boolean%29))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:34:38.670

我不确定这是否适用，但您可以使用执行下载任务的执行程序服务创建另一个线程并继续检查`isCancelled()`内部`doInBackground()`或直到未来对象返回，以先发生者为准：

```
@Override
protected Object doInBackground(Void... params)
{
    Callable<Void> downlaodTask = new Callable<Void>()
    {
        @Override
        public Void call() throws Exception
        {
            // download task here

            return null;
        }
    };

    ExecutorService executor = Executors.newSingleThreadExecutor();
    Future<Void> future = executor.submit(downlaodTask);

    while(true) // check every second
    {
        try
        {
            future.get(1, TimeUnit.SECONDS); // wait until the download task finishes with 1 second as a timeout
            break;
        }
        catch(TimeoutException e)
        {
            if(isCancelled())
            {
                executor.shutdownNow(); // or abort() or both
                break;
            }
        }
    }

    return null;
} 
```

# php - php文件上传无法正常工作

> ID：15124501
> 
> 赞同：0
> 
> 时间：2013-02-27T23:21:49.643
> 
> 标签：php, file-upload

我被分配了修复旧 php 站点的任务，因为它已移至较新的服务器。它现在所在的服务器不允许全球化变量，而这几乎就是这个站点运行的所有内容。尝试上传图像时，我的 sql 语句显示除了我添加图像的列表的 id 之外的所有内容。我希望有人能帮我解决这个问题。

这是我的上传功能：

```
function upload(){
global $imagefolder, $id;
global $tbl_units;

include "globalizePOSTGET.php";

// $uid = uuid();
$minsize = 5000;            // 5kb
$maxsize = 3000000;     // 3mb
$ext = explode('.',basename($_FILES['userfile']['name']));
$ext = $ext[count($ext)-1];
$ext = strtolower($ext);

if ($ext != "jpg" && $ext != "jpeg" && $ext != "png") {
    echo "<script> alert('Image is not a png or jpeg format'); </script>";
    return false;
}

$imagename = $_POST['id']."_img".$_FILES['img'].".$ext";
$imagename2 = "X_".$imagename;
$uploadfile = $imagefolder . $imagename;
$uploadfile2 = $imagefolder . $imagename2;
$uploadthumb = $imagefolder . "tn_" . $imagename;

if (file_exists($uploadfile)) unlink($uploadfile);
if (file_exists($uploadthumb)) unlink($uploadthumb);

if (file_exists($uploadfile)) { 
    echo "<script> alert('Image already exists!'); </script>";
}
else
{
    if(is_uploaded_file($_FILES['userfile']['tmp_name'])) {
        // check the file is less than the maximum file size
        if($_FILES['userfile']['size'] < $maxsize) {
            $imgData = addslashes(file_get_contents($_FILES['userfile']['tmp_name']));      // prepare the image for insertion
            $size = getimagesize($_FILES['userfile']['tmp_name']);          // get the image info..
            if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile2)) {
                $Image = @imagecreatefromjpeg($uploadfile2);
                if ($Image) {
                 $img_height = imagesy($Image);
                 $img_width = imagesx($Image);
                 imagedestroy($Image);
                }

                if ($img_height > $img_width) {         // portrait  
                    $tempMultiplier = 150 / $img_height;
                    $tempMultiplierFull = 600 / $img_height;
                } else {
                    $tempMultiplier = 150 / $img_width;
                    $tempMultiplierFull = 600 / $img_width;
                }

                $imageHeight = $img_height * $tempMultiplier;
                $imageWidth = $img_width * $tempMultiplier;
                $fullimageHeight = $img_height * $tempMultiplierFull;
                $fullimageWidth = $img_width * $tempMultiplierFull;
                createthumb($imagename2,"tn_".$imagename,$imageWidth,$imageHeight);

                if($_FILES['userfile']['size'] > $minsize) {
                    createthumb($imagename2,$imagename,$fullimageWidth,$fullimageHeight);
                    if (file_exists($uploadfile2)) unlink($uploadfile2);
                } else {
                    rename($uploadfile2, $uploadfile);
                }

                $sql = "UPDATE $tbl_units SET photo".$_FILES['img']." = \"" . $imagename . "\" WHERE id = " . $_POST['id'];
                echo $sql;
                if(!mysql_query($sql)) {
                    echo "<script> alert('Unable to upload file'); </script>";
                } else {
                    ?> <script>location.replace('memonly.php?action=edit_record&id=<?php echo $id; ?>');</script> <?php
                }
            }
        }   else {
            // if the file is not less than the maximum allowed, print an error
            $file_n = basename($_FILES['userfile']['name']);
            $file_s = $_FILES['userfile']['size'];
            ?>
            <script> alert("File exceeds the maximum limit of <?php echo $maxsize; ?>\nFile <?php echo $file_n; ?> is <?php echo $file_s; ?>");</script>
            <?php
        }
    }
}
} 
```

我想，我正在回显给我错误的行上的 sql 语句。点击提交后，页面告诉我`Unable to upload file'. Which is why I echoed the sql there. I end up with a sql statement looking like this:`UPDATE member_units SET photo = "_img.jpg" WHERE id = `

有人请帮助我！我对 PHP 非常缺乏经验，我不知道在这里做什么。

这是正在上传的表单：

```
<form enctype="multipart/form-data" action="<?php echo $_SERVER['PHP_SELF']?>" method="post">
<input type="hidden" name="_submit_check" value="1" /> 
<input type="hidden" name="id" value="<?php echo $id; ?>" />
<input type="hidden" name="img" value="<?php echo $img; ?>" />
Image URL: <input type="file" name="userfile" value=""  style="font-size: 10px; width: 100%;">
<input type="submit" value="Submit" onClick="return validate();">&nbsp;
<input type="button" value="Cancel" onClick="location.href='/memonly.php?action=edit_record<?php echo "&id=$id&memberid=$memberid"; ?>';">
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:45:15.240

处理此类问题需要做的第一件事是解决问题似乎发生的位置。所以拿你的回声声明...

> UPDATE member_units SET photo = "_img.jpg" WHERE id = `

这对应于...

```
UPDATE $tbl_units SET photo".$_FILES['img']." = \"" . $imagename . "\" WHERE id = " . $_POST['id']; 
```

通过比较我们可以看到，很明显 $_FILES['img'] 是一个空变量，只要将其转换为字符串即可。$_POST['id'] 也是如此，而 $imagename 给出了一个简短的**_img.jpg**文件名。

追溯您可以看到 $imagename 来自...

```
$_POST['id']."_img".$_FILES['img'].".$ext"; 
```

这就是您的**photo = "_img.jpg"**的来源。同样，$_FILES['img'] 和 $_POST['id']

您到达 echo 语句的事实意味着正在上传某些内容，但它是通过 $_FILES['userfile'] 数组以及所有相关变量，例如 $_FILES['userfile']['name' ] 这将为您提供正在上传的图像的文件名。

接下来您需要问自己的是您期望 $_POST['id'] 来自哪里，因为它丢失或为空，以及 HTML 表单中的哪个字段提供该变量。然后你需要问问自己你想用你的命名系统实现什么。例如，如果您希望图像文件看起来像： 1_imgLolCat.jpg 那么您的变量需要看起来更像

```
$imagename = $_POST['id']."_img".$_FILES['userfile']['name']; 
```

但是，我在下面回答的最后一部分让我认为，您要查找的实际上不是文件名，而是表示图像类别或类型的 POST 变量，在这种情况下，您可能希望使用...

```
$imagename = $_POST['id']."_img".$_POST['img'].".$ext"; 
```

...如果存在名称为“img”的 HTML 字段！

最后看看你的SQL语句......

```
SET photo".$_FILES['img']." = \"" . $imagename . "\" 
```

并仔细检查您的表格，因为您似乎正在尝试在表格中设置一个唯一变量，该变量取决于从表单传递的内容。我在这里可能错了，但我假设（正如我上面所说）你想要 $_POST['img'] 在那里。

警告的话，您需要...在将这些变量输入到这样的 SQL 语句之前，需要对其进行清理**。**有人可以很容易地采取

```
SET photo".$_POST['img'] 
```

如果为您的数据库设置了权限，则删除您的整个表。关于如何正确执行此操作，还有很多其他答案。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:28:20.587

似乎“id”字段未在 HTML 表单中发送。我想这应该是一个隐藏的输入？

请注意，您的脚本可能是 SQL 注入的目标：您直接在 SQL 查询中使用用户输入 ($_POST['id'])。您应该检查此输入是否实际设置为数字。

# c++ - 多层复杂状态机

> ID：15124502
> 
> 赞同：0
> 
> 时间：2013-02-27T23:21:54.137
> 
> 标签：c++, design-patterns, state-machine

我目前正在尝试为多层状态机的编码提出一个干净的设计，到目前为止，我还没有在有关 C++ 或其他中的正常状态机使用的文章中找到解决方案。

在层次结构的最底部，我们有原子状态：a、b、c、...、x、y、z。最重要的是，有第一层复合状态：A、B、C、D。最后，在最顶层，有一个最终聚合根状态 X。

```
 X
    A B C D
a b c d e f g h... 
```

与通常的状态机相比，最低状态是由外部因素定义和确定的；没有可检测到的事件会改变它们，只需通过观察即可检测到变化。

在原子状态变化之后，第一个复合层具有一组可以采用的状态，具体取决于较低状态的组合。例如：a、b 和 c 是 A 的“子”状态：

```
a b c - A
0 0 0 - 0
1 0 0 - 1
2 0 0 - x
2 1 0 - 2 
```

依此类推...其中 x 未定义。

最后，根状态有一组它可以采用的状态，基于复合状态——遵循与以前相同的逻辑。

到目前为止，我尝试了一种自上而下的方法，在这种方法中，根会调用子状态，而子状态又会调用原子状态来更新它们，然后级联起来。

我还尝试了一种自下而上的方法，原子状态将更新并调用到子状态，而子状态又会调用到根状态。

在这两种情况下，单个子状态可能仅依赖于一个或多个原子状态这一事实使得状态验证非常复杂，我最终得到了不可接受的、臃肿的代码。我觉得我需要一种不同的方法，但我坚持目前的设计。如果有人有这种问题的经验并且可以提供一些灵感，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T02:19:53.330

**一个快速的想法：**

1）复合和原子状态之间的观察者模式（“a”，“b”，“c”作为观察者，“A”作为观察者，等等..）

2) 使用 Pimpl idiom 实现 class-A 以分离接口和实现细节，从而在更改实现细节方面拥有更多控制权并表现出更灵活。

3）让A类有某种工厂抽象来为“A”的每个独特状态创建和管理专门的实现对象。

4) 因此，每当“A”观察到 a、b、c 的变化时，Factory 都会帮助检索“A”的相应实现状态并进行状态更改。在“A”和“X”之间应用相同的方法。

**更详细的布局：**

1) 定义所需的接口（通用或抽象类）IX、IA、Ia、Ib、Ic。

2) 在接口 IA 中，定义 public IaChanged(Ia*), IbChanged(Ib*) & IcChanged(Ic*) 方法来接收 Ia, Ib & Ic 状态变化通知（观察者模式的回调方法）。

3) 在原子接口 Ia、Ib 和 Ic 内部。定义公共 Register(IA&) 和私有 Notify() 方法。在界面 Ia 中，

```
 Where Notify() { foreach(observer in m_Observers) 
                     observer->IaChanged(this);
                     } 
```

在界面 Ib 中，

```
 Where Notify() { foreach(observer in m_Observers) 
                     observer->IbChanged(this);
                     } 
```

很快...

4) 具有从各自接口派生的类 X、A、a、b、c。X->IX, A->IA, a->Ia, b->Ib & c->Ic，其中->代表“衍生”。

5) 让 A 类定义 A_implState (Pimpl Idiom)，其中 A_implState 可以派生自新接口 IA_implState 以保持通用性。

将类 A_implState0、A_implState1、A_implState2、A_implStateX 作为 IA_implState 的专用版本。

在哪里，

```
 class IA_implState
    {
        public:
           virtual void processStateChange()=0;
    };

    class A_implState0 : public IA_implState
    {
        public:
            void processStateChange()
            {
                // do your stuff specific to State "0" of "A".
            }
    };

    class A_implStateX : public IA_implState
    {
        public:
            void processStateChange()
            {
                // do your stuff specific to State "X" of "A".
            }
    };      
    so on... 
```

6) 对 A 的每个不同状态有一个 IA_Impl 特化，基于：

```
a b c - A
0 0 0 - 0
1 0 0 - 1
2 0 0 - x
2 1 0 - 2 
```

7) 在 A 类中，每当 IaChanged(IaPtr) 或 IbChanged(IbPtr) 或 IcChanged(IcPtr) 被相应的被观察者触发时，将更改通知处理为：

```
 // a changed
    void A::IaChanged(IaPtr a)
    {
     //Buffer Ia inside a member
     m_pIa = a;
     //Retrieve A-implementer based on the current state.
     m_pimplA = m_implAContainer[GetCurrentState()]; // or use FactoryMethod or AbstractFactory pattern if required.
     m_pimplA->processStateChange();
    }

   // b changed
    void A::IbChanged(IbPtr b)
    {
      //Buffer Ib inside a member
      m_pIb = b;
      m_pimplA = m_implAContainer[GetCurrentState()]; // use FactoryMethod or AbstractFactory pattern if required.
      m_pimplA->processStateChange();
    } 
```

**/* 一个粗略的草图，可能看起来像 */**

使用 shared_pointers 来管理生命周期，定义一些 typedef 以便于使用。

```
 typedef std::shared_ptr<Ia> IaPtr;
    typedef std::shared_ptr<Ib> IbPtr;
    typedef std::shared_ptr<IA_impl> IAImplPtr;
    typedef std::map<int /* or other datatype as required */ , IA_implPtr> ImplAPtrContainer;

    // class-A may look like
    class A : public IA
    {
     public:
      void IaChanged(const IaPtr ptr_a);
      void IbChanged(const IbPtr ptr_b);
      void Init();
      void DeInit() { m_implAContainer.clear(); }

    private:
       int GetCurrentState();

    private:
     ImplAPtrContainer m_implAContainer;
     IAImplPtr m_pimplA;
     IaPtr m_aPtr;
     IbPtr m_bPtr;
     IcPtr m_cPtr;
    }; 
```

*// 使用 A 类的所有可能实现状态初始化 Container*

```
 void A::Init()
    {
      m_implAContainer.insert(/*state*/ 0, IAImplPtr(new A_implState0));
      m_implAContainer.insert(/*state*/ 1, IAImplPtr(new A_implState1));
      m_implAContainer.insert(/*state*/ X, IAImplPtr(new A_implStateX));
    } 
```

*// 根据a,b & c'当前状态判断A的当前状态*

```
 int A::GetCurrentState()
    {
        // Have this method return A's state based on a b c, prefer enums over magic numbers
        if(m_aPtr->GetState() == 0 && m_bPtr->GetState() == 0 && m_cPtr->GetState() == 0)
          return 0; 
    } 
```

# c# - Autofac 中的混合生活方式

> ID：15124505
> 
> 赞同：3
> 
> 时间：2013-02-27T23:21:56.220
> 
> 标签：c#, asp.net-mvc-3, autofac

我在 ASP.NET MVC 中有一个应用程序，它也有一个 WCF 服务包含在同一个项目中。

我使用 Autofac 来管理依赖注入。问题是，当通过 Web 访问应用程序时，我需要为每个 Http 请求实例化依赖项。当通过 WCF 访问应用程序时，我需要为每个依赖项实例化依赖项。

在 Castle.Windsor 中，有一个管理混合生活方式的项目（在[此链接](http://bugsquash.blogspot.com.ar/2010/06/hybrid-lifestyles-in-windsor.html)中）。

我需要类似的东西，比如：

```
builder.Register<UnitOfMeasureService>(x => new UnitOfMeasureService())
            .As<IUnitOfMeasureService>().HybridLifetimeInstance(); 
```

是否有一种解决方法来管理实例生命周期，具体取决于应用程序何时有`HttpContext`或没有？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T19:06:47.577

**Autofac 不支持自定义生活方式管理器。**

Autofac 生命周期围绕作用域展开，作用域是可嵌套的，并且可以选择使用已知 ID 进行标记。这就是每个 HTTP 请求实例的工作方式：当 Web 请求进入时，会创建一个带有已知值（“AutofacWebRequest”）的嵌套范围“标记”。层次结构如下所示：

*   容器（根生命周期范围）
    *   Web 请求范围（标记为“AutofacWebRequest”）
        *   您可能在代码中创建的任何子范围

使用`InstancePerHttpRequest`时基本与`InstancePerMatchingLifetimeScope("AutofacWebRequest")`. 如果您解析类型，它会回退，直到找到具有该名称的范围，然后在该标记范围中使用相同的实例。

在标准 WCF 托管中，Autofac 解析所有您可以从实例上下文 ( `AutofacInstanceContext.Current.OperationLifetime`) 获取的子范围之外的内容。您可以从中创建一个子生命周期范围并手动标记它，然后像这样解决您的依赖项：

```
var opScope = AutofacInstanceContext.Current.OperationLifetime;
using(var requestScope = opScope.BeginLifetimeScope("AutofacWebRequest"))
{
  // Resolve InstancePerHttpRequest items from requestScope
} 
```

但是，无法自动执行此操作，并且 WCF 托管机制目前还没有以您可以“插入”并执行此操作的方式构建 - 如果您需要自动创建 Web 请求范围，**则必须自行创建基于 Autofac 源代码的 WCF 托管机制**。

另**一种选择是拥有两个不同的容器**——一个用于 Web 内容，一个用于 WCF 内容——并在每个容器中注册具有不同生命周期的组件。

除此之外......**真的没有办法根据 context 来“切换”生命周期**。组件声明了一个生命周期，并且必须为该组件注册表使用它。

# jquery - 如果选中绑定事件，则向插件添加选项

> ID：15124506
> 
> 赞同：0
> 
> 时间：2013-02-27T23:21:56.797
> 
> 标签：jquery

我正在尝试[为此 stringToSlug 插件](http://leocaseiro.com.br/jquery-plugin-string-to-slug/)添加一个额外的选项，因此只有在选中该选项以打开/关闭插件时才绑定事件。

例如，我有表单字段：

1.  标题
2.  网址
3.  自动 URL（复选框）？

当我添加`if($(checkbox).is(":checked"))`这仅适用于第一次加载时，而不是当您取消勾选/欺骗复选框时，stringToSlug 插件不会再次开始工作。

插入

```
/*
 * jQuery stringToSlug plug-in 1.2.1
 *
 * Plugin HomePage http://leocaseiro.com.br/jquery-plugin-string-to-slug/
 *
 * Copyright (c) 2009 Leo Caseiro
 * 
 * Based on Edson Hilios (http://www.edsonhilios.com.br/ Algoritm
 * 
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */

jQuery.fn.stringToSlug = function(options) {
    var defaults = {
        setEvents: 'keyup keydown blur', //set Events that your script will work
        getPut: '#permalink', //set output field
        space: '-', //Sets the space character. If the hyphen,
        prefix: '',
        suffix: '',
        replace: '' //Sample: /\s?\([^\)]*\)/gi
    };

    var opts = jQuery.extend(defaults, options);

    jQuery(this).bind(defaults.setEvents, function () {
        var text = jQuery(this).val();
        text = defaults.prefix + text + defaults.suffix; //Concatenate with prefix and suffix       
        text = text.replace(defaults.replace, ""); //replace
        text = jQuery.trim(text.toString()); //Remove side spaces and convert to String Object

        var chars = []; //Cria vetor de caracteres
        for (var i = 0; i < 32; i++) {
            chars.push ('');
        }   

        /*** Abaixo a lista de caracteres ***/
        chars.push (defaults.space); // Unicode 32
        chars.push ('');   // !
        chars.push ('');   // "
        chars.push ('');   // #
        chars.push ('');   // $
        chars.push ('');   // %
        chars.push ('');   // &
        chars.push ("");   // '
        chars.push (defaults.space);  // (
        chars.push (defaults.space);  // ); 
        chars.push ('');   // *
        chars.push ('');   // +
        chars.push (defaults.space);  // ); 
        chars.push (defaults.space);  // -
        chars.push (defaults.space);  // .
        chars.push (defaults.space);  // /
        chars.push ('0');  // 0
        chars.push ('1');  // 1
        chars.push ('2');  // 2
        chars.push ('3');  // 3
        chars.push ('4');  // 4
        chars.push ('5');  // 5
        chars.push ('6');  // 6
        chars.push ('7');  // 7
        chars.push ('8');  // 8
        chars.push ('9');  // 9
        chars.push ('');   // :
        chars.push ('');   // ;
        chars.push ('');   // <
        chars.push ('');   // =
        chars.push ('');   // >
        chars.push ('');   // ?
        chars.push ('');   // @
        chars.push ('A');  // A
        chars.push ('B');  // B
        chars.push ('C');  // C
        chars.push ('D');  // D
        chars.push ('E');  // E
        chars.push ('F');  // F
        chars.push ('G');  // G
        chars.push ('H');  // H
        chars.push ('I');  // I
        chars.push ('J');  // J
        chars.push ('K');  // K
        chars.push ('L');  // L
        chars.push ('M');  // M
        chars.push ('N');  // N
        chars.push ('O');  // O
        chars.push ('P');  // P
        chars.push ('Q');  // Q
        chars.push ('R');  // R
        chars.push ('S');  // S
        chars.push ('T');  // T
        chars.push ('U');  // U
        chars.push ('V');  // V
        chars.push ('W');  // W
        chars.push ('X');  // X
        chars.push ('Y');  // Y
        chars.push ('Z');  // Z
        chars.push (defaults.space);  // [
        chars.push (defaults.space);  // /
        chars.push (defaults.space);  // ]
        chars.push ('');   // ^
        chars.push (defaults.space);  // _
        chars.push ('');   // `
        chars.push ('a');  // a
        chars.push ('b');  // b
        chars.push ('c');  // c
        chars.push ('d');  // d
        chars.push ('e');  // e
        chars.push ('f');  // f
        chars.push ('g');  // g
        chars.push ('h');  // h
        chars.push ('i');  // i
        chars.push ('j');  // j
        chars.push ('k');  // k
        chars.push ('l');  // l
        chars.push ('m');  // m
        chars.push ('n');  // n
        chars.push ('o');  // o
        chars.push ('p');  // p
        chars.push ('q');  // q
        chars.push ('r');  // r
        chars.push ('s');  // s
        chars.push ('t');  // t
        chars.push ('u');  // u
        chars.push ('v');  // v
        chars.push ('w');  // w
        chars.push ('x');  // x
        chars.push ('y');  // y
        chars.push ('z');  // z
        chars.push ('Z'); 
        chars.push ('z'); 

        for (var i = 256; i < 100; i++) {
            chars.push ('');
        }

        var stringToSlug = new String (); //Create a stringToSlug String Object
        for (var i = 0; i < text.length; i ++) {
            stringToSlug += chars[text.charCodeAt (i)]; //Insert values converts at slugs
        }

        stringToSlug = stringToSlug.replace (new RegExp ('\\'+defaults.space+'{2,}', 'gmi'), defaults.space); // Remove any space character followed by Breakfast
        stringToSlug = stringToSlug.replace (new RegExp ('(^'+defaults.space+')|('+defaults.space+'$)', 'gmi'), ''); // Remove the space at the beginning or end of string

        stringToSlug = stringToSlug.toLowerCase(); //Convert your slug in lowercase     

        jQuery(defaults.getPut).val(stringToSlug); //Write in value to input fields (input text, textarea, input hidden, ...)
        jQuery(defaults.getPut).html(stringToSlug); //Write in HTML tags (span, p, strong, h1, ...)

        return this;
    });

  return this;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:40:17.137

可能有几种方法可以做到这一点，但您基本上需要添加一个处理程序来单击触发 stringToSlug 处理程序的“自动 URL”复选框，并在进行转换之前选中该复选框。

我通过在插件中添加一个选项“检查”来做到这一点，该插件是“自动 URL”复选框的选择器。然后我使用它来附加一个处理程序，该处理程序触发绑定到`setEvents`. 我刚刚添加了一个调用`stringtoslug`来完成此操作的自定义事件。在处理程序内部，如果未选中复选框，它只会返回，什么也不做。

```
jQuery.fn.stringToSlug = function(options) {

    var defaults = {
        setEvents: 'keyup keydown blur', //set Events that your script will work
        getPut: '#permalink', //set output field
        check: undefined,  // Checkbox
        space: '-', //Sets the space character. If the hyphen,
        prefix: '',
        suffix: '',
        replace: '' //Sample: /\s?\([^\)]*\)/gi
    };

    var opts = jQuery.extend(defaults, options);

    var source = this; // save "this" for triggering

    // If a checkbox was defined, add a handler to it
    if(defaults.check !== undefined) {

        // When the checkbox changes, custom fire a "stringtoslug" event
        jQuery(defaults.check).on('change', function() {
            jQuery(source).trigger('stringtoslug');
        });
    }

    // Add a "stringtoslug" event listener to the others
    jQuery(this).bind(defaults.setEvents + ' stringtoslug', function () {

        // If the checkbox is defined and it is not checked, don't do anything
        if(defaults.check !== undefined && !jQuery(defaults.check).prop('checked')) {
            return;    
        }

        // ...EVERYTHING ELSE IS THE SAME...
    }
} 
```

并称之为：

```
$('#title').stringToSlug({
    getPut: '#url',
    check: '#autourl'
}); 
```

演示：http: [//jsfiddle.net/jtbowden/KJzvZ/](http://jsfiddle.net/jtbowden/KJzvZ/)

# c++ - 尝试调用字符串变量时出错

> ID：15124507
> 
> 赞同：0
> 
> 时间：2013-02-27T23:21:57.810
> 
> 标签：c++

我正在编写一个 c++ 程序，它接受用户输入的汽车类型、租用天数和行驶里程，根据常数值计算变量并生成报告。我使用 if 语句编写了代码，该语句查看用户输入的 carType、“f”或“c”，并根据该输入执行计算。然而，输出需要显示车辆的名称，福特或雪佛兰，而不是输入的“f”或“c”。

我在尝试获取这封信并将其等同于品牌时遇到错误。另外，我正在为用户创建的每个条目获取标题，我怎样才能获取 5 个条目并将它们输出到一个标题下？

这是我的代码：

```
#include <iostream>
#include <string>
#include <sstream>
#include <iomanip>
#include <cmath>

using namespace std;

int main()
{
    // Change the console's background color.
    system ("color F0");

    // Declare the variables.
    char carType, brand;
    string f("Ford"), c("Chevrolet");
    int counter = 0, cars = 0;
    double days, miles, cost_Day, cost_Miles, day_Total;

    cout << "Enter the number of cars you wish to enter: ";
    cin >> cars;
    cin.ignore();

    while (counter <= cars)
    {

        cout << "Enter the car type (F or C): ";
        cin >> carType;
        cin.ignore();
        cout << "Enter the number of days rented: ";
        cin >> days;
        cin.ignore();
        cout << "Enter the number of miles driven: ";
        cin >> miles;
        cin.ignore();

        if (carType == 'F' || carType == 'f')
        {
            cost_Day = days * 40;
            cost_Miles = miles * .35;
            day_Total = cost_Miles + cost_Day;
            brand = f;
        }
        else
        {
            cost_Day = days * 35;
            cost_Miles = miles * .29;
            day_Total = cost_Miles + cost_Day;
            brand = c;
        }

        cout << "\nCar          Days          Miles          Rental Cost\n";
        cout << left << setw(13) << brand << left << setw(13) << days << left << setw(13) << miles 
        << fixed << setprecision(2) << showpoint << "$" << setw(13) << right << day_Total << "\n\n";
        counter++;
    }

        system ("pause");
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:27:51.380

`brand`是 char 类型，但您为其分配了字符串。`brand`必须是一个字符串。

我还建议养成更好的命名约定的习惯：`c`这`f`不是好的选择。还要考虑可扩展性：如果添加丰田、马自达、法拉利等会怎样？

# android - 如何将 DialogFragment 上的按钮设置为平面样式？

> ID：15124511
> 
> 赞同：1
> 
> 时间：2013-02-27T23:22:15.057
> 
> 标签：android, user-interface, android-dialogfragment

也许我只是瞎了。在对话框片段中，我膨胀了一些自定义布局。该按钮上没有使用任何样式。我使用 Holo.Light 作为主题。但是 Button 不是那种扁平的样式。

我该如何存档？

干杯，风筝冲浪者

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:27:29.593

您必须设置正确的样式。我正在使用以下内容（应该在 HoneyComb+ 上工作）：

```
<LinearLayout
    style="?android:attr/buttonBarStyle"
    android:layout_width="match_parent"
    android:layout_height="48dp">

    <Button
        android:id="@+id/positive"
        style="?android:attr/buttonBarButtonStyle"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="0.5"
        android:drawableLeft="@drawable/ic_action_done"
        android:drawablePadding="8dp"
        android:gravity="start|center_vertical"
        android:padding="4dp"
        android:text="@string/done"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/negative"
        style="?android:attr/buttonBarButtonStyle"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="0.5"
        android:drawableLeft="@drawable/ic_action_cancel"
        android:drawablePadding="8dp"
        android:gravity="start|center_vertical"
        android:padding="4dp"
        android:text="@string/cancel"
        android:textAppearance="?android:attr/textAppearanceMedium" />
</LinearLayout> 
```

# jquery - JQuery Console.log 每个上传的文件

> ID：15124522
> 
> 赞同：0
> 
> 时间：2013-02-27T23:23:04.033
> 
> 标签：jquery, html, ajax, upload, foreach

我有一个 AJAX 上传表单，我可以正常工作，但是如果您选择多个文件，所有文件都会一次上传。我想要做的是为每个文件制作一个 div 并显示每个文件的进度。我在这里有这段代码来测试文件的数量，但它每次在控制台中都返回 1。

```
var EachFile = 0
$('#Files').each(function()
{
    ++EachFile;
    console.log(EachFile);
}); 
```

HTML：

```
<div id="UForm">
    <form action="" method="post" enctype="multipart/form-data">
        <input type="file" class="Files" id="Files" name="File[]" />
        <input type="submit" name="Submit" class="AB" id="Submit" value="Upload!" />
        <div id="Progress"></div>
        <div class="Caption"><label id="Loaded"></label></div>
    </form>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:27:14.100

您只是在计算文件输入以计算仅使用`$('#Files')[0].files.length`或使用您自己的代码的文件。

```
var EachFile = 0;
$.each($('#Files')[0].files, function()
{
    ++EachFile;
    console.log(EachFile);
}); 
```

# django - 将现有站点更新为新的 Django 1.5 用户模型后 django_admin_log 上的完整性错误

> ID：15124523
> 
> 赞同：27
> 
> 时间：2013-02-27T23:23:08.590
> 
> 标签：django, django-1.5

显然，在将我的新用户表添加到站点后，django_admin_log 仍然具有到 auth_user 表的 FK。有什么办法解决这个问题吗？我在分期或本地没有看到这个问题，所以一定发生了一些奇怪的事情。

**Traceback**（最近一次通话最后一次）**：**

> 文件“/app/.heroku/python/lib/python2.7/site-packages/django/core/handlers/base.py”，第 115 行，在 get_response response = callback(request, *callback_args, **callback_kwargs)
> 
> 文件“/app/.heroku/python/lib/python2.7/site-packages/newrelic-1.10.0.28/newrelic/api/object_wrapper.py”，第 220 行，**调用** self._nr_instance，args，kwargs）
> 
> 包装器中的文件“/app/.heroku/python/lib/python2.7/site-packages/newrelic-1.10.0.28/newrelic/hooks/framework_django.py”，第 475 行，返回已包装（*args，**kwargs）
> 
> 包装器中的文件“/app/.heroku/python/lib/python2.7/site-packages/django/contrib/admin/options.py”，第 372 行 return self.admin_site.admin_view(view)(*args, * *夸格斯）
> 
> _wrapped_view 中的文件“/app/.heroku/python/lib/python2.7/site-packages/django/utils/decorators.py”，第 91 行 response = view_func(request, *args, **kwargs)
> 
> _wrapped_view_func 中的文件“/app/.heroku/python/lib/python2.7/site-packages/django/views/decorators/cache.py”，第 89 行 response = view_func(request, *args, **kwargs)
> 
> 内部返回视图中的文件“/app/.heroku/python/lib/python2.7/site-packages/django/contrib/admin/sites.py”，第 202 行（请求，*args，**kwargs）
> 
> _wrapper 中的文件“/app/.heroku/python/lib/python2.7/site-packages/django/utils/decorators.py”，第 25 行 return bound_func(*args, **kwargs)
> 
> _wrapped_view 中的文件“/app/.heroku/python/lib/python2.7/site-packages/django/utils/decorators.py”，第 91 行 response = view_func(request, *args, **kwargs)
> 
> 文件“/app/.heroku/python/lib/python2.7/site-packages/django/utils/decorators.py”，第 21 行，在 bound_func 返回 func(self, *args2, **kwargs2)
> 
> 文件“/app/.heroku/python/lib/python2.7/site-packages/django/db/transaction.py”，第 223 行，内部返回 func(*args, **kwargs)
> 
> 文件“/app/.heroku/python/lib/python2.7/site-packages/django/db/transaction.py”，第 217 行，**退出** self.exiting(exc_value, self.using)
> 
> 退出提交中的文件“/app/.heroku/python/lib/python2.7/site-packages/django/db/transaction.py”，第 281 行（使用=使用）
> 
> 提交 connection.commit() 中的文件“/app/.heroku/python/lib/python2.7/site-packages/django/db/transaction.py”，第 152 行
> 
> **提交self._commit** () 中的文件“/app/.heroku/python/lib/python2.7/site-packages/django/db/backends/init .py”，第 241 行
> 
> 文件“/app/.heroku/python/lib/python2.7/site-packages/django/db/backends/postgresql_psycopg2/base.py”，第 242 行，在 _commit *tuple(e.args)), sys.exc_info()[2])
> 
> _commit 中的文件“/app/.heroku/python/lib/python2.7/site-packages/django/db/backends/postgresql_psycopg2/base.py”，第 240 行，返回 self.connection.commit()
> 
> 提交中的文件“/app/.heroku/python/lib/python2.7/site-packages/newrelic-1.10.0.28/newrelic/hooks/database_dbapi2.py”，第 68 行，返回 self._nr_connection.commit()
> 
> IntegrityError：在表“django_admin_log”上插入或更新违反了外键约束“django_admin_log_user_id_fkey”详细信息：表“auth_user”中不存在键（user_id）=（2）。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2014-08-15T17:31:55.480

如果您遇到这种情况并且您正在使用 >=1.7：

```
./manage.py dbshell

DROP TABLE django_admin_log; 
```

进而：

```
./manage.py sqlmigrate admin 0001 | ./manage.py dbshell 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-11-20T11:36:56.760

那是因为该`django_admin_log`表仍然包含与旧表的外键关系`auth_user`。

您需要删除它并重新创建表。

```
$ heroku pg:psql
psql => drop table django_admin_log; 
```

对于 Django < 1.7

```
$ heroku run python manage.py syncdb 
```

对于 Django >= 1.7

```
$ ./manage.py sqlmigrate admin 0001 | heroku pg:psql 
```

就是这样:)

> 编辑@dustinfarris Django 1.7+ 答案精度

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-11-19T22:21:56.593

如果您使用的是 Django 1.7 或更高版本，`django_admin_log`我认为添加适当的迁移以更改表是一个更好的选择。这样您就可以保留任何现有的日志条目，这实际上可能是您使用的东西。进行这样的更改需要 id 字段相同，例如具有相同的名称等。

首先，您必须找出约束的名称，这可以通过进入数据库 shell 来完成：

```
./manage.py dbshell 
```

然后描述`django_admin_log`表：

```
\d+ django_admin_log; 
```

这将在输出中有约束，例如：

```
"user_id_refs_id_c0d12874" FOREIGN KEY (user_id) REFERENCES my_custom_auth_model(id) DEFERRABLE INITIALLY DEFERRED 
```

where`my_custom_auth_model`是您的自定义身份验证模型所在的表的名称，并且`user_id_refs_id_c0d12874`是约束的名称，您应该稍后复制它。

接下来，创建一个新的迁移：

```
./manage makemigrations --empty my_custom_auth_model 
```

我重命名了我的新迁移（即`0000_alter_admin_log_constraint.py`）以在文件名中包含有用的东西而不是日期戳。但是不要使用四个零，使用创建迁移时分配的任何内容:)

在新的迁移中，这是我用于操作的：

```
operations = [
    migrations.RunSQL(
        '''ALTER TABLE django_admin_log DROP CONSTRAINT user_id_refs_id_c0d12874''',
        reverse_sql='''ALTER TABLE django_admin_log ADD CONSTRAINT user_id_refs_id_c0d12874
            FOREIGN KEY (user_id) REFERENCES auth_user(id) DEFERRABLE INITIALLY DEFERRED'''),
    migrations.RunSQL(
        '''ALTER TABLE django_admin_log ADD CONSTRAINT user_id_refs_id_c0d12874
            FOREIGN KEY (user_id) REFERENCES my_custom_auth_model(id) DEFERRABLE INITIALLY DEFERRED''',
        reverse_sql='''ALTER TABLE django_admin_log DROP CONSTRAINT user_id_refs_id_c0d12874'''),
] 
```

替换`user_id_refs_id_c0d12874`为您之前复制的任何约束名称。如您所见，这两个操作及其逆操作是互逆的，这意味着您也可以将此迁移向后移动。

现在，您所要做的就是应用新的迁移：

```
./manage.py migrate 
```

该`django_admin_log`表现在应该可以再次使用，并且管理员向它写入的任何内容都可以正常工作，而不是使用`IntegrityError`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-03T05:02:56.920

当您运行此操作时，似乎可能存在错误事务，您可以尝试使用以下命令完全重置您的数据库：

```
heroku pg:reset 
```

或者您可以尝试将 psql 插入数据库并检查/更正导致问题的数据（这可能是它尝试两次插入同一个用户）：

```
heroku pg:psql 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-17T13:59:19.780

我认为管理应用程序只安装 django_admin_log 表。

```
python manage.py sqlclear admin

BEGIN;
DROP TABLE "django_admin_log";

COMMIT; 
```

所以你也可以试试。

```
python manage.py sqlclear admin | python manage.py dbshell
python manage.py syncdb 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-03-23T14:05:55.540

删除数据库并创建一个超级用户，最后运行`migrate`：

```
python manage.py createsuperuser    
python manage.py migrate 
```

# c# - 单击gridview中的数据透视表项目时如何获取标题值

> ID：15124529
> 
> 赞同：1
> 
> 时间：2013-02-27T23:23:24.513
> 
> 标签：c#, asp.net, gridview

这可能有点棘手，所以请多多包涵。

我从 gridview 得到这个结果，数据来自数据透视表：

```
DateCreate        02/11/2013 02/19/2013  Total 
OrdersPendInvoice 0          1           1 
OrdersPendPickUp  1          15          16 
```

这里可选择的项目是数字，并且只是大于零的数字。

因此，首先我需要这些项目（可选择的项目）使它们像 linkBut​​tons 子，当我单击其中一个时，我可以将两个标题都作为参考（这里是另一个棘手的部分）传递。

我们举个例子：

如果我点击数字 15，这基本上意味着 2013 年 2 月 19 日有 15 个 OrdersPendPickUp。然后我将转到带有参考文献的不同页面，`02/19/2013`并`OrdersPendPickUp`在那里显示这 15 条记录。只要我有参考资料，我对最后一部分没有任何问题。

对于这种`Total`情况，我只需要`OrdersPendInvoice`or `OrdersPendPickUp`（取决于所选项目），因为无论日期如何，我都会获得该参考的所有记录。

我这样做了，但实际上并不多，只是改变了大于零的项目的颜色:(

```
protected void gvOrdersProcessed_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType != DataControlRowType.Pager)
    {
        for (int i = 0; i <= e.Row.Cells.Count - 1; i++)
        {
            if (TryToParse(e.Row.Cells[i].Text) > 0)
            {
                e.Row.Cells[i].ForeColor = System.Drawing.Color.Red;
            }
        }
    }
}

private int TryToParse(string value)
{
    int number;
    bool result = Int32.TryParse(value, out number);
    if (result)
        return number;
    else
        return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:11:41.753

是的，这很棘手。但是，请尝试以下操作：

```
private List<string> _headers = new List<string>();

protected void gvOrdersProcessed_RowDataBound(object sender, GridViewRowEventArgs e)
{
    //Collect the texts from the column headers
    if (e.Row.RowType == DataControlRowType.Header)
    { 
        for (int i = 0; i <= e.Row.Cells.Count - 1; i++)
        {
            this._headers.Add(e.Row.Cells[i].Text);
        }
    }

    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        for (int i = 0; i <= e.Row.Cells.Count - 1; i++)
        {
            if (TryToParse(e.Row.Cells[i].Text) > 0)
            {
                string rowKey = e.Row.Cells[0].Text;
                string column = this._headers[i];

                HyperLink link = new HyperLink();
                link.Text = e.Row.Cells[i].Text;
                link.NavigateUrl="page.aspx?key=" + rowKey  + "&column=" +column;

                e.Row.Cells[i].Controls.Clear();
                e.Row.Cells[i].Controls.Add(link);
            }
        }
    }
} 
```

链接就像：

**正常值：** `~/page.aspx?key=OrdersPendPickUp&column=02/19/2013`
**总计：** `~/page.aspx?key=OrdersPendPickUp&column=Total`

# python - Python 2.7 是否有“忽略”功能？

> ID：15124531
> 
> 赞同：2
> 
> 时间：2013-02-27T23:23:28.013
> 
> 标签：python

总新手在这里。

那么，如果满足某些条件，有什么方法可以阻止执行功能？

这是我的源代码：

```
answer = raw_input("2+2 = ")
if answer == "4":
    print "Correct"
else:
    print "Wrong answer, let's try something easier"
    answer = raw_input("1+1 = ")
if answer == "2":
    print "Correct!"
else:
    print "False" 
```

所以基本上，如果我在第一个问题上输入 4，我会从下面的“else”函数中得到“False”评论。如果在第一个问题上输入 4，我想阻止这种情况发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:27:09.700

缩进级别在 Python 中很重要。只需缩进第二个`if`语句，使其成为第一个语句的一部分`else`。

```
answer = raw_input("2+2 = ")
if answer == "4":
    print "Correct"
else:
    print "Wrong answer, let's try something easier"
    answer = raw_input("1+1 = ")

    if answer == "2":
        print "Correct!"
    else:
        print "False" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:30:49.550

您可以将代码放在函数中，并在满足任何给定条件后立即返回：

```
def func():
    answer = raw_input("2+2 = ")
    if answer == "4":
        print "Correct"
        return
    else:
        print "Wrong answer, let's try something easier"
        answer = raw_input("1+1 = ")
    if answer == "2":
        print "Correct!"
    else:
        print "False" 
```

**输出：**

```
>>> func()
2+2 = 4
Correct
>>> func()
2+2 = 3
Wrong answer, let's try something easier
1+1 = 2
Correct! 
```

# c# - C#为今天未发生的事件创建列表

> ID：15124535
> 
> 赞同：-5
> 
> 时间：2013-02-27T23:23:43.597
> 
> 标签：c#

我正在申请一个动物收容所，每次将一只狗添加到动物列表中时，它都必须有它最后一次散步的日期。部分任务是展示今天没有走出去的狗的名单。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:26:39.020

好的，假设您的数据结构中有一个“LastWalked”列，您需要以下内容：

```
var dogsNotWalked = allDogs.Where(d => d.LastWalked < DateTime.Today); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:27:54.290

如果您在寻求帮助之前先尝试一下，这会有所帮助。更不用说展示你的作品了。实际上，这并不难，单线。尝试这样的事情：

```
public IEnumerable<Dog> Dogs { get ; set ; }

public IEnumerable<Dog> FindDogsNotWalkedRecently( DateTime referenceDate )
{
    return Dogs.Where( dog => dog.LastWalkedAt < referenceDate ) ;
} 
```

# c++ - 在 OpenCV 中使用 cv::imwrite 的运行时错误

> ID：15124539
> 
> 赞同：0
> 
> 时间：2013-02-27T23:23:59.133
> 
> 标签：c++, opencv

我正在使用 OpenCV 2.3.1。我的语言是 C++。

如果我像这样硬编码输出文件的名称，cv::imwrite 可以正常工作。

```
cv::imwrite("/home/peter/BlendedInterpolatedPlane.jpg", srcnorm); 
```

但是，当我尝试将输出文件名作为这样的字符串传递时，出现运行时错误。

```
cv::imwrite(outputFileName.c_str(), srcnorm); 
```

或者像这样

```
cv::imwrite(outputFileName, srcnorm); 
```

虽然没有编译器错误。

outputFileName 被声明为 std::string 并包含输出文件名。

堆栈跟踪如下。

```
org.netbeans.modules.viewmodel.TreeModelNode@1999add[Name=, displayName=__kernel_vsyscall()]    
org.netbeans.modules.viewmodel.TreeModelNode@186304c[Name=, displayName=raise()]    
org.netbeans.modules.viewmodel.TreeModelNode@cce801[Name=, displayName=abort()] 
org.netbeans.modules.viewmodel.TreeModelNode@93b1a8[Name=, displayName=__gnu_cxx::__verbose_terminate_handler()()]  
org.netbeans.modules.viewmodel.TreeModelNode@749412[Name=, displayName=Address: [@0x00554fa5]]  
org.netbeans.modules.viewmodel.TreeModelNode@1a52b00[Name=, displayName=std::terminate()()] 
org.netbeans.modules.viewmodel.TreeModelNode@aa277d[Name=, displayName=__cxa_throw()]   
org.netbeans.modules.viewmodel.TreeModelNode@106904c[Name=, displayName=cv::error(cv::Exception const&)()]  
org.netbeans.modules.viewmodel.TreeModelNode@1eb6f21[Name=, displayName=cv::imwrite_(std::basic_string<char, std::char_traits<char>,   std::allocator<char> > const&, cv::Mat const&, std::vector<int, std::allocator<int> > const&, bool)()]   
org.netbeans.modules.viewmodel.TreeModelNode@1ccf1f3[Name=, displayName=cv::imwrite(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, cv::_InputArray const&, std::vector<int, std::allocator<int> > const&)()]    
org.netbeans.modules.viewmodel.TreeModelNode@20a41d[Name=, displayName=main(argc=9,argv=0xbffff564) at main.cpp:259] 
```

任何帮助将不胜感激，
彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T01:30:39.363

我发现了问题。输出文件名的后缀无效。一旦我解决了这个问题，它就可以使用

```
cv::imwrite(outputFileName, srcnorm); 
```

其中 outputFileName 是 std::string 类型。

# linux - 如何组合 sed '句子'？

> ID：15124541
> 
> 赞同：0
> 
> 时间：2013-02-27T23:24:13.053
> 
> 标签：linux, sed

我做了这个脚本：

```
xrandr | grep '*' | sed 's/\S*\(*+\)\S*//g'| sed 's/ //g' | sed 's/x.*//' 
```

如何组合这三个`sed`命令：

1.  `sed 's/\S*\(*+\)\S*//g'`
2.  `sed 's/ //g'`
3.  `sed 's/x.*//'`

成一个命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:26:43.227

与`-e`：

```
xrandr | grep '*' | sed -e 's/\S*\(*+\)\S*//g' -e 's/ //g' -e 's/x.*//' 
```

请注意，这`grep`不是必需的：

```
xrandr | sed -e '/\*/!d' -e 's/\S*\(*+\)\S*//g' -e 's/ //g' -e 's/x.*//' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T23:27:17.710

您可以将这些命令放在一个名为 sedscr 的文件中，例如，每行一个：

```
s/x.*//
s/ //g
s/\S*\(*+\)\S*//g 
```

然后调用：

```
xrandr | grep '*' | sed -f sedscr 
```

我更喜欢这种方法，以防我将来想添加更多命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T23:26:12.953

您可以简单地将所有`sed`命令视为脚本并`;`在命令之间添加一个：

```
xrandr | grep '*' | sed 's/\S*\(*+\)\S*//g ; s/ //g ; s/x.*//' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T23:28:27.177

使用*换行符*：

```
echo coobas | sed 's:c:f:
s:s:r:' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T23:31:28.000

没有`sed`但只是`grep`：

```
$ xrandr | grep -oP '^\s+\K\d+(?=.*?\*)'
1440 
```

或使用[perl](/questions/tagged/perl "显示标记为“perl”的问题")：

```
$ xrandr | perl -lne 'print $1 if /^\s+(\d+)(?=.*?\*)/'
1440 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T23:33:02.687

要考虑的另一件事是制作一个 sed 配置文件（称为**config.sed**）列出所有替换规则。例如：

```
1,/^END/{
   s/x.*//
   s/ //g
   s/\S*\(*+\)\S*//g
} 
```

然后运行

```
sed -f config.sed filein.txt > fileout.txt 
```

# asp-classic - “Do While Not”循环中的多个“If Then Else”不起作用，但它们单独起作用

> ID：15124542
> 
> 赞同：0
> 
> 时间：2013-02-27T23:24:21.080
> 
> 标签：asp-classic, vbscript

好的，这就是把我的头发拉出来的原因！我有一个页面，它从一个 DB 中的表中读取记录，稍微操作数据，然后将其写入另一个 DB。

在 Do While Not EOF 循环中，我有许多 If Then Else 语句来操作数据。

如果我完整地运行代码，大多数 If Then Else 都不起作用，如果我只运行其中每个页面，它们就可以正常工作。

我已经花了 8 小时以上的时间来解决这个问题，但仍然感到困惑

```
Dim rsndb, fieldstr1, fieldstr2, fieldstr3, fieldstr4, fieldstr5, fieldstr6, fieldstr7, fieldstr8, fieldstr9, fieldstr10, fieldstr11, fieldstr12, fieldstr13, fieldstr14, fieldstr15
recordstr = 0

'##### Empty temp table #####
Set Connection = Server.CreateObject("ADODB.Connection")
Connection.Open "DSN=website"
cSql = "DELETE FROM newtandltest"
Connection.Execute (cSql)
Connection.Close
Set Connection = Nothing

' Select Records From House Database
Set adoCon = Server.CreateObject("ADODB.Connection")
adoCon.Open "DSN=newdatabase;UID=Intranet;Pwd=password;"
Set rsndb = Server.CreateObject("ADODB.Recordset")

strSQL="Select top 500 VendorTransaction.VendorNo As propvendor, Resort.ResortCode As rid, Resort.ResortName As resname, Locations.LocationName As proploc, Country.CountryCode As propcountry, Season.SeasonDesc As propsea, Property.SeasonDesc As propextrasea, Property.Size As psize, Property.Occupancy As occ, FloatingPoints.FloatingPointsName As TAOLF, Property.StartWeek As propsw, Property.EndWeek As propew, Property.Weeks As propweeks, Property.Points As proppoints, Property.WebPricePW As webprice, Property.Priority As priority, Property.OpenToOffer As offers, Property.PoAOffer As poa, Property.RentalPW As rentalpw, Property.WebDate As webdate"

strSQL = strSQL & " From Property Inner Join Resort On Property.ResortId = Resort.Id Inner Join Country On Resort.CountryId = Country.Id Inner Join Locations On Resort.LocationId = Locations.Id Inner Join FloatingPoints On Property.FloatPointId = FloatingPoints.Id Inner Join PropertyStatus On Property.StatusId = PropertyStatus.Id Inner Join PropertyType On Property.TypeId = PropertyType.Id Inner Join Season On Property.SeasonId = Season.Id Inner Join VendorTransaction On VendorTransaction.propertyId = Property.Id Where (Property.WebDate >= DateAdd(day, -187, GetDate()) And Property.StatusId = 4 and year(Property.WebDate) <> 9999)"

rsndb.Open strSQL, adoCon
Set adoCon1 = Server.CreateObject("ADODB.Connection")
adoCon1.Open "DSN=website"

Do While not rsndb.EOF
    '------------------------------------------------------------------------------------------------------------------
    fieldstr1 = rsndb("webdate")
    '------------------------------------------------------------------------------------------------------------------
    fieldstr2 = rsndb("propvendor")
    '------------------------------------------------------------------------------------------------------------------
    fieldstr3 = rsndb("propcountry")
    If rsndb("proploc") = "FLOR" Then
        fieldstr3 = rsndb("proploc")
    End If
    If rsndb("proploc") = "MADE" Then
        fieldstr3 = rsndb("proploc")
    End If
    If rsndb("propcountry") = "ESC" Then
        fieldstr3 = rsndb("propcountry") & left(rsndb("proploc"),1)
    End If
    '------------------------------------------------------------------------------------------------------------------
    resnamestr = replace(rsndb("resname"),chr(13)," ")
    resnamestr = replace(rsndb("resname"),chr(34),"")
    resnamestr = replace(rsndb("resname"),"'","")
    fieldstr4 = resnamestr
    '------------------------------------------------------------------------------------------------------------------
    fieldstr5 = rsndb("propsea")
    If len(rsndb("propextrasea")) > 3 Then
        fieldstr5 = rsndb("propextrasea")
    End If
    If rsndb("propcountry") = "POIN" Then
        fieldstr5 = ""
    End If
    '------------------------------------------------------------------------------------------------------------------
    fieldstr6 = ""
    '------------------------------------------------------------------------------------------------------------------
    fieldstr7 = rsndb("propweeks")
    If rsndb("propcountry") = "POIN" Then
        fieldstr7 = rsndb("proppoints")
    End If
    '------------------------------------------------------------------------------------------------------------------
    If rsndb("propsw") = rsndb("propew") Then
        fieldstr8 = rsndb("propsw")
    End If
    If rsndb("propcountry") = "POIN" Then
        fieldstr8 = "POINTS"
        fieldstr9 = "n/a"
    End If
    If rsndb("propsw") < rsndb("propew") Then
        fieldstr8 = rsndb("propsw") & "/" & rsndb("propew")
    End If
    If rsndb("TAOLF") = "F" Then
        fieldstr8 = "FLOATING"
    End If
    '------------------------------------------------------------------------------------------------------------------
    tempsize = rsndb("psize")
    Select Case tempsize
        Case 1
            fieldstr9 = "Studio" & " - " & rsndb("occ")
        Case 2
            fieldstr9 = "1 Bedroom" & " - " & rsndb("occ")
        Case 3
            fieldstr9 = "2 Bedroom" & " - " & rsndb("occ")
        Case 4
            fieldstr9 = "3 Bedroom" & " - " & rsndb("occ")
        Case 5
            fieldstr9 = "4 Bedroom" & " - " & rsndb("occ")
    End Select
    '------------------------------------------------------------------------------------------------------------------
    fieldstr10 = rsndb("rid")
    '------------------------------------------------------------------------------------------------------------------
    fieldstr11 = rsndb("rid")
    '------------------------------------------------------------------------------------------------------------------
    fieldstr12 = ""
    '------------------------------------------------------------------------------------------------------------------
    fieldstr13 = "N"
    '------------------------------------------------------------------------------------------------------------------
    fieldstr14 = rsndb("webprice")
    If rsndb("offers") = 1 Then
        fieldstr14 = "Offers"
    End If
    If rsndb("poa") = 1 Then
        fieldstr14 = "POA"
    End If
    '------------------------------------------------------------------------------------------------------------------
    fieldstr15 = rsndb("rentalpw")
    lCount = lCount + 1
    Set Connection1 = Server.CreateObject("ADODB.Connection")
    Connection1.Open "DSN=website"
    cSql = "INSERT INTO newtandltest(datefield, field1, field2, field3, field4, field5, field6, field7, field8, field9, field10, field11, field12, price, bargainprice)"
    cSql = cSql & "VALUES('"&fieldstr1&"','"&fieldstr2&"','"&fieldstr3&"','"&fieldstr4&"','"&fieldstr5&"','"&fieldstr6&"','"&fieldstr7&"','"&fieldstr8&"','"&fieldstr9&"','"&fieldstr10&"','"&fieldstr11&"','"&fieldstr12&"','"&fieldstr13&"','"&fieldstr14&"','"&fieldstr15&"');"
    Connection1.Execute (cSql)
    Connection1.Close
    Set Connection1 = Nothing
    rsndb.MoveNext
Loop
rsndb.Close
adoCon.Close
Set rsndb = Nothing
Set adoCon = Nothing 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T10:56:53.180

我和影子巫师在一起。整理你的代码，每个键只使用一次 rsndb。并使用字典以合理的名称存储您的字段。就像现在一样，它是不可维护的：有人怎么知道 fieldStr12 代表什么？

我发现了一个真正的错误：您对原始字符串进行了三次替换，因此实际上只有最后一次替换可见。

建议如何整理您的代码：

```
Do While not rsndb.EOF

    Set fld = createObject("Scripting.Dictionary")
    fld.Add "webdate",      rsndb("webdate")
    fld.Add "propvendor",   rsndb("propvendor")
    fld.Add "propcountry",  rsndb("propcountry")

    ' etc...

    Select Case fld("proploc")
        Case "FLOR"     fld("propcountry") = fld("proploc")
        Case "MADE"     fld("propcountry") = fld("proploc")
    End case

    If fld("propcountry") = "ESC" Then 
        fld("propcountry") = fld("propcountry") & left(fld("proploc"),1)
    End If

    ' This part is not correct, it is only replacing the ' by an empty string
     'resnamestr = replace(rsndb("resname"),chr(13)," ")
     'resnamestr = replace(rsndb("resname"),chr(34),"")
     'resnamestr = replace(rsndb("resname"),"'","")
     'fieldstr4 = resnamestr

    fld("resname") = replace(fld("resname"), chr(13), " ")
    fld("resname") = replace(fld("resname"), chr(34), "")
    fld("resname") = replace(fld("resname"), "'", "")

    ' etc...

    Set Connection1 = Server.CreateObject("ADODB.Connection")
    Connection1.Open "DSN=website"
    cSql = "INSERT INTO newtandltest(datefield, field1, field2, field3, field4, field5, field6, field7, field8, field9, field10, field11, field12, price, bargainprice)"

    ' the Items property of a dictionary is an array in the same order that you add them to the dictionary
    ' You could do the same with the Keys property.
    cSql = cSql & "VALUES('" & join(fld.Items, "','") & "');"
    Connection1.Execute (cSql)
    Connection1.Close
    Set Connection1 = Nothing
    rsndb.MoveNext
Loop 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T12:06:04.660

```
Something u can improve in your code.

1) You have open connection before while loop so you do not need to open it again in While loop it should be remove 

Set Connection1 = Server.CreateObject("ADODB.Connection")
    Connection1.Open "DSN=website
While loop ...
WEND
Connection1.Close
    Set Connection1 = Nothing

2) check Null and blank before replacing with some value.

for e.g 
if(fld("resname") <> "" AND NOT ISNULL(fld("resname")))
replace(fld("resname"), chr(13), " ")
end if

- Note track loop with default value like response.write ("hello") and check in which row loop is breaking and by which cause 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T07:58:51.907

我能看到的唯一可能导致这种情况的是多次阅读同一个字段；对于某些类型的字段（例如 Access 的备注字段），它可能会在第一次阅读后变为空白。

要解决此类问题，您需要读取每个字段**一次**，并将其存储到局部变量中：

```
Do While not rsndb.EOF
    curPropLoc = rsndb("proploc")
    curPropCountry = rsndb("propcountry")
    '...
    fieldstr3 = curPropCountry
    If curPropLoc = "FLOR" Then
        fieldstr3 = curPropLoc
    End If
    If curPropLoc = "MADE" Then
        fieldstr3 = curPropLoc
    End If
    '...keep using curPropLoc instead of rsndb("proploc") throughout the loop...
    '...keep using curPropCountry instead of rsndb("propcountry") throughout the loop...
    '......
    rsndb.MoveNext
Loop 
```

# github - 我可以在 GitHub 页面中使用 Markdown 文件吗？

> ID：15124547
> 
> 赞同：14
> 
> 时间：2013-02-27T23:24:35.883
> 
> 标签：github, markdown, wiki, github-pages

由于[GitHub wiki 不支持目录](https://stackoverflow.com/questions/11088285/github-wiki-directories)，我想将我的 md 文件放入 GitHub 页面中。然而，当我打开它们时，我发现它们根本没有被解释。GitHub 只是给了我原始文件。请参阅[http://greenlaw110.github.com/Rythm/en/index.md](http://greenlaw110.github.com/Rythm/en/index.md)。任何想法？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-28T05:56:20.430

文档对此并不是特别清楚，但鉴于 Markdown 渲染是由[Jekyll](https://github.com/mojombo/jekyll/blob/master/README.textile)完成的，我相信您需要他们所谓的[“YAML 前端”](http://jekyllrb.com/docs/frontmatter/)来编译页面。所以试着把它放在文件的顶部：

```
---
title: Document Center
--- 
```

这应该足以触发 Jekyll。（然后你就可以[开始花哨](https://help.github.com/articles/using-jekyll-with-pages)并开始使用布局等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-02-04T22:55:50.020

您可能会获得原始文件的另一个原因（根据经验发现）`index.md`是，如果您碰巧也有一个类似名称的`index.html`文件。这会阻止 GH 页面。

删除`index.html`（在网站上）产生一个新`index.html`的带有解析的降价。原件`index.md`将不再可访问。

# facebook - 应用程序发布到页面提要返回无效的 post_id

> ID：15124549
> 
> 赞同：1
> 
> 时间：2013-02-27T23:24:39.917
> 
> 标签：facebook, facebook-graph-api

当应用程序（即我的应用程序、FriendCaster、GraphAPI）发布到用户喜欢的页面的提要时，返回 post_id 并且我总是可以看到该消息显示在页面上——当从浏览器查看时。

但是，当我尝试从任何应用程序读取页面提要时，这些相同的帖子并没有全部显示出来。有时我会看到应用程序的前几条帖子，然后就什么也没有了。

此外，如果我尝试使用 Graph API Explorer 显示从成功发布返回的 post_id 的状态，它要么返回一个空对象，要么返回通用的“不支持的获取请求。”，代码“：100。

我已经尝试了应用程序默认隐私的所有设置，没有任何变化。

我也尝试在应用程序上设置所有权限，但没有任何改进。

建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:57:56.793

使用此信息打开了一个 Facebook[错误](http://developers.facebook.com/bugs/350672038370328?browse=search_513d1bc14bc216185501923)，原因似乎是垃圾邮件过滤器启动（尽管有点笨拙）

`This is by design. Posting too many times to a page repeatedly will be marked as spam.`

不幸的是，页面没有办法将允许频繁发帖的应用列入白名单。

正如我在上面的评论中提到的，这引发了我将在 FB 网站上跟进的其他几个问题。

# php - mcrypt_decrypt()：IV参数必须和blocksize一样长

> ID：15124554
> 
> 赞同：1
> 
> 时间：2013-02-27T23:25:13.800
> 
> 标签：php, encryption, mcrypt, sha

我试图在我的代码中加密一些信息，所以我寻找了一种方法来做到这一点。我在php官方网站上找到了这个： [http ://www.php.net/manual/vote-note.php?id=107483&page=book.mcrypt&vote=down](http://www.php.net/manual/vote-note.php?id=107483&page=book.mcrypt&vote=down)

所以，我改变了一点，我这样做了：

```
class EncrypterDecrypter {

private $SECRET = "xxxxxxxxxxxxxxxxxxxx";

function encrypt($decrypted, $salt = 'zzzzzzzzzzzzzzzzzz') {
    $password = $this->SECRET;
    // Build a 256-bit $key which is a SHA256 hash of $salt and $password.
    $key = hash('SHA256', $salt . $password, true);
    // Build $iv and $iv_base64\.  We use a block size of 128 bits (AES compliant) and CBC mode.  (Note: ECB mode is inadequate as IV is not used.)
    srand();
    $iv = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), MCRYPT_RAND);
    if (strlen($iv_base64 = rtrim(base64_encode($iv), '=')) != 22)
        return false;
    // Encrypt $decrypted and an MD5 of $decrypted using $key.  MD5 is fine to use here because it's just to verify successful decryption.
    $encrypted = base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, $decrypted . md5($decrypted), MCRYPT_MODE_CBC, $iv));
    // We're done!
    return $iv_base64 . $encrypted;
}

public function decrypt($encrypted, $salt = 'zzzzzzzzzzzzzzzzzz') {
    $password = $this->SECRET;
    // Build a 256-bit $key which is a SHA256 hash of $salt and $password.
    $key = hash('SHA256', $salt . $password, true);
    // Retrieve $iv which is the first 22 characters plus ==, base64_decoded.
    $iv = base64_decode(substr($encrypted, 0, 22) . '==');
    // Remove $iv from $encrypted.
    $encrypted = substr($encrypted, 22);
    // Decrypt the data.  rtrim won't corrupt the data because the last 32 characters are the md5 hash; thus any \0 character has to be padding.
    $decrypted = rtrim(
            mcrypt_decrypt(MCRYPT_RIJNDAEL_128,
                    $key, base64_decode($encrypted),
                    MCRYPT_MODE_CBC, $iv),
            "\0\4");
    // Retrieve $hash which is the last 32 characters of $decrypted.
    $hash = substr($decrypted, -32);
    // Remove the last 32 characters from $decrypted.
    $decrypted = substr($decrypted, 0, -32);
    // Integrity check.  If this fails, either the data is corrupted, or the password/salt was incorrect.
    if (md5($decrypted) != $hash)
        return false;
    // Yay!
    return $decrypted;
   }
} 
```

我已经尝试更改密钥和盐大小，但警告不断显示。我还搜索了其他主题，但找不到任何答案，它们都看起来很具体。

# oracle11g - oracle11g 权限

> ID：15124563
> 
> 赞同：0
> 
> 时间：2013-02-27T23:25:41.967
> 
> 标签：oracle11g, privileges

我有 3 个用户，用户 A、用户 B、用户 C。使用 userC 我必须对 usuarioB.subject 进行查询。userC 的权限必须通过 userA 分配。userB 必须做什么才能让 userA 向其他用户授予权限？后来，我怎样才能通过userA给userC特权？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:54:39.347

查找授予命令并授予选择权限给用户A

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-08T23:47:51.610

*在 b.table1 上以UserB 或 DBA 身份登录，*
使用授权选项向 UserA 授予选择；

*以 UserA 身份登录，*
将 b.table1 上的选择授予 UserC；

# php - 如何在jquery中访问枚举

> ID：15124564
> 
> 赞同：1
> 
> 时间：2013-02-27T23:25:43.857
> 
> 标签：php, jquery

我正在使用 ajax 向 php 脚本发布请求，并从脚本返回枚举，即

```
success: function(data){
    console.log(data) 
} 
```

在控制台上我看到：

```
enum('Engineering','Finance','Economics','Project Management') 
```

现在我如何迭代枚举的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:34:47.110

如果您在谈论关联数组或地图或集合，例如

```
var x = new Array();
x['test'] = 1;
x['something'] = 2;
x['something_else'] = 3; 
```

您可以通过以下方式循环它们：

```
for(i in x){
   alert( " key: "+i+" / value: "+x[i]);
} 
```

但我认为 JS 中一般没有枚举器。

**根据您在下面的评论进行更新：**

** 注意，如果您不能 100000000% 确定来自 db 的内容（str 的内容），请不要使用 eval，这很危险，而且是 XSS 的大门。

您可以使用：

```
str // is the string you retrieved from SQL.
eval(str.replace("enum","var enum=new Array")); 
```

然后遍历名为 enum 的数组

```
 for( i in enum){

   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:36:52.090

枚举在 javascript 中不存在，它被序列化为一个字符串，它恰好从 php.ini 中引入了变量的类型。

您需要更改 php 脚本的返回类型

# iis - 使用 Powershell 编辑现有 IIS IP 限制

> ID：15124565
> 
> 赞同：1
> 
> 时间：2013-02-27T23:25:48.200
> 
> 标签：iis, powershell, iis-7

我正在编写一个 Powershell 脚本来为使用 Powershell 的网站添加/删除/编辑 IP 限制。到目前为止，我能够添加限制，但想知道编辑现有 ip 限制的最佳方法。

**添加**

```
Add-WebConfiguration -Filter /system.webserver/security/ipsecurity -Value @{ipAddress=$ipAddress;subnetMask="255.255.255.255";allowed=$allowed} -Location $websiteName -PSPath "IIS:\" 
```

**编辑**

我尝试了以下各种组合：

```
Set-WebConfiguration -Filter system.webServer/security/ipSecurity/add[@ipAddress='192.123.123.123'] -Name "ipAddress" -Value $ipAddress -Location $websiteName -PSPath "IIS:\"

Set-WebConfigurationProperty -Filter system.webServer/security/ipSecurity/add[@ipAddress='192.123.123.123'] -Value = @{ipAddress=$ipAddress;subnetMask="255.255.255.255";allowed=$allowed} -Location $websiteName -PSPath "IIS:\" 
```

最好的方法本质上是清除所有内容并每次重新创建吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-19T14:59:01.977

我有同样的问题并像这样修复它 -

```
# Compose new entry    
$value = @{allowed="true";ipAddress="192.168.0.1"}

# Add new entry to restrictions
Add-WebConfigurationProperty  -Filter 'system.webServer/security/ipSecurity' -PSPath "IIS:\Sites\MySite\" -Location "MyService" -Name "." -Value $value -ErrorAction Stop 
```

# python - 从代码中调用 py.test 并收集结果

> ID：15124566
> 
> 赞同：5
> 
> 时间：2013-02-27T23:25:48.853
> 
> 标签：python, unit-testing, pytest

我正在开发一个系统，该系统需要能够使用 py.test 测试 python 文件，并在程序中使用输出（哪些测试通过和失败）。无论如何从python中调用py.test，告诉它在[otherName].py中的代码上运行[name].py中的测试代码，并让它返回测试结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T15:11:45.653

我认为您正在使用和调用页面寻找从[Python](http://pytest.org/latest/usage.html)代码[调用 pytest 。](http://pytest.org/latest/usage.html#calling-pytest-from-python-code)

也可以通过[指定测试/选择测试来限制对特定文件的测试](http://pytest.org/latest/usage.html#specifying-tests-selecting-tests)。

换句话说，这应该可以解决问题：

```
pytest.main(['my_test_file.py']) 
```

PS：[Py.test 文档](http://pytest.org/latest/contents.html)非常好，你可以在那里找到大部分答案；）。

# python - 如何在 django 中使用单个提交按钮提交多个表单？

> ID：15124567
> 
> 赞同：1
> 
> 时间：2013-02-27T23:25:53.310
> 
> 标签：python, django, django-forms

我已经设法使用 modelformset_factory 创建了我需要的表单。

```
avaluos = Avaluo.objects.filter(Estatus__contains='CONCLUIDO',Factura__isnull=True)
FacturaFormset = modelformset_factory(Avaluo,form=FacturaForm,extra=0) 
```

目前，这正在为找到的每一行生成以下 HTML：

```
<form id="id-FacturaForm" class="blueForms" method="post">[..]</form>
<form id="id-FacturaForm" class="blueForms" method="post">[..]</form>
<form id="id-FacturaForm" class="blueForms" method="post">[..]</form> 
```

我想使用单个提交按钮提交所有表单。

有任何想法吗？

# 更新

我最终使用了[django-crispy-forms](https://github.com/maraujop/django-crispy-forms)，它允许我为每一行生成输入，然后我只是手动添加表单并提交。

```
 self.helper.form_tag = False

{{example_formset.management_form }}
       {% for a,b in olist %}
{{ b.id }}
<tr>
    <td style="width:10px;"> {% crispy b %} </td>
    <td> {{a.id}} </td>     
</tr>
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-28T00:02:52.517

阅读更多[模型表单集](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#model-formsets)。您不需要有单独`form`的标签，这是使用表单集的全部意义所在。

```
<form method="post" action="">
    {{ factura_formset.management_form }}
    <table>
        {% for form in factura_formset %}
            {{ form }}
        {% endfor %}
    </table>
</form> 
```

此外，每次您`id`在页面上多次使用该属性时……开发人员都会哭着睡在世界的某个地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:43:07.250

如果您尝试创建“相同”表单的许多实例（也就是说，它们看起来都相同），就好像它是属于单个主元素的多个子元素之一，您实际上不需要创建一个每个表单集的表单标签。

如果我没记错的话，您正在尝试为单个*avaluo*对象编辑许多*事实。*我对吗？该表示将是具有许多内联表单集的单个“avaluo”表单，每个“factura”一个。

查看[内联表单集工厂](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#inline-formsets)而不是模型表单集工厂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:32:09.807

我怀疑您将需要使用 Ajax 来完成 - 否则一旦提交了一个表单，您将无法采用其他方式。

有一些 jQuery 表单库应该使它相对简单。例如，[http](http://malsup.com/jquery/form/) ://malsup.com/jquery/form/ 。

它看起来像：

```
$('#button-id').click(function() {
  $('.blueForms').ajaxSubmit();
}); 
```

当然，您随后需要处理错误处理并等待所有表单提交。

# ruby-on-rails - 在 Rails 中按下返回按钮时保持页面状态

> ID：15124569
> 
> 赞同：0
> 
> 时间：2013-02-27T23:26:12.623
> 
> 标签：ruby-on-rails, ajax

这是我的情况：

我有一个页面，其中一个容器显示所有用户，如果我应用了任何过滤器，另一个容器将显示用户。因此，默认情况下，我会在容器中显示 ID 为 all_users 的所有用户，如果我应用任何过滤器，我会隐藏该容器并使用过滤器的 ID 进行 AJAX 调用，并将结果的内容放入容器中id .filtered_users。

当我点击一个用户时，我会转到他的页面，但是当我点击后退按钮时，我总是会得到所有用户。当我点击该特定用户时，我没有得到被过滤的用户。

您如何保持这两个页面之间的状态？这样当我点击后退按钮时，我就知道点击用户时我来自哪里。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:32:26.767

只需通过浏览器地址栏跟踪状态，让all_users和filtered_users有不同的地址，返回时返回正确的地址。

它可以通过历史对象进行操作。例如，参见[https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)

# java - Camel Netty UDP 侦听器在 0.0.0.0 上侦听但未接收数据包

> ID：15124571
> 
> 赞同：2
> 
> 时间：2013-02-27T23:26:13.917
> 
> 标签：java, udp, netty, apache-camel

我是 Camel、Netty 和 UDP 的新手，但我已经研究了一段时间，但仍然无法弄清楚发生了什么。

我要做的就是使用 Camel 和 Netty 实现一个 UDP 侦听器（目前在 Windows 7 上，但将把项目移到 Linux 上）。我的弹簧配置如下：

```
<camel:camelContext id="test">
    <camel:route>
        <camel:from uri="netty:udp://localhost:5150?sync=false"/>
        <camel:to uri="log:cameltest?level=DEBUG"/>     
        <camel:to uri="file://outbox"/>
    </camel:route>
</camel:camelContext> 
```

侦听器似乎可以正常启动（通过 Eclipse 运行）。但是，当我执行 netstat 时，我看到：

```
UDP    0.0.0.0:5150
UDP    [::ffff:127.0.0.1]:5150 
```

当我期望它在 127.0.0.1 上收听时。我在网上读到的任何内容都不清楚这是否是 Camel/Netty/UDP 的预期行为。

我正在通过从 Java NIO UDP 客户端发送来对此进行测试。如果 NIO UDP 服务器正在侦听，它会很好地接收数据包（全部通过 localhost 完成）。

我还测试了一个 Camel/Netty/TCP 监听器，效果很好。

为什么监听器监听所有本地地址？如果是这样，为什么它没有从本地主机接收我的数据包？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T16:32:03.323

我想到了。这是我最后的春天背景：

```
<bean class="org.jboss.netty.handler.codec.string.StringDecoder" id="stringDecoder">
    <constructor-arg value="ISO_8859_1" />
</bean>

<camel:camelContext id="test">
    <camel:route>
        <camel:from uri="netty:udp://localhost:5150?decoder=#stringDecoder&amp;disconnectOnNoReply=false&amp;sync=false"/>
        <camel:to uri="log:cameltest?level=DEBUG"/>     
        <camel:to uri="file://outbox"/>
    </camel:route>
</camel:camelContext> 
```

在对 UDP 和 Netty 做了一些研究之后，我发现在 0.0.0.0:[port#] 上监听似乎是 Netty/UDP 的默认行为。有关 0.0.0.0 含义的更多信息，[请参阅此链接](https://serverfault.com/questions/78048/whats-the-difference-between-ip-address-0-0-0-0-and-127-0-0-1)。

一位程序员同事建议（因为我本质上是在框架中使用框架），取出骆驼的东西并尝试让它在 Netty 中工作。我试过这个，我能够让它工作，并且还能够从我的 NIO UDP 客户端发送给它。有一段时间我认为问题出在骆驼身上，因为我看不出 Netty 实现有什么问题。

在 Netty/UDP、Camel/TCP 和“损坏的”Camel/UDP 中进行了数小时的逐步调试后，我注意到 Camel Netty 实现使用包中的 a`ConnectionlessBootstrap`来`org.jboss`绑定连接。在我的 Netty 实现中，我使用`Bootstrap`的是`io.netty`包中的。

[我从http://massapi.com/class/org/jboss/netty/bootstrap/ConnectionlessBootstrap.java.html](http://massapi.com/class/org/jboss/netty/bootstrap/ConnectionlessBootstrap.java.html)找到了一个使用`ConnectionlessBootstrap`and`org.jboss`包的示例。当我让它工作时，我将实现与我的实现进行了比较，并注意到他在两端都有一个编码器和解码器。这就是我想为我的听众添加解码器并设法让项目正常工作的地方。`CharsetUtil.ISO_8859_1`

我还注意到我一次只能发送一次。将该属性设置`disconnectOnNoReply`为 false 允许侦听器在不断开连接的情况下多次接收。

希望这对将来的人有所帮助。:)

[编辑] 实际上，经过进一步测试，可能不需要“disconnectOnNoReply”。我只是在没有它的情况下尝试过它并且它有效。

# ruby-on-rails - 具有嵌套模型的表单不更新也不提供嵌套参数

> ID：15124575
> 
> 赞同：0
> 
> 时间：2013-02-27T23:26:49.877
> 
> 标签：ruby-on-rails, nested-forms, nested-attributes, params

在 rails 3.2.* 我有一个 has_one belongs_to 嵌套模型，如下所示：

```
class Unicycle < ActiveRecord::Base
  attr_accessible :brand, :wheel, :wheel_attributes
  has_one :wheel
  accepts_nested_attributes_for :wheel
end

class Wheel < ActiveRecord::Base
  attr_accessible :diameter, :unicycle
  belongs_to :unicycle
end 
```

我的控制器看起来像这样：

```
class UnicyclesController < ApplicationController
  def index
    @unicycles = Unicycle.all
  end

  def edit
    @unicycle = Unicycle.find_by_id params[:id]
  end

  def update
    @unicycle = Unicycle.find_by_id params[:id]
    if @unicycle.update_attributes! params[:unicycle]
      redirect_to unicycles_path
    else
      render 'edit'
    end
  end
end 
```

我的 edit.html.erb 像这样：

```
<%= form_for @unicycle do |formbuilder| %>
  <%= formbuilder.text_field :brand %>

  <%= fields_for @unicycle.wheel do |fieldbuilder| %>
    <%= fieldbuilder.number_field :diameter %>
  <% end %>

  <%= formbuilder.submit %>
<% end %> 
```

但是当我更新时，对 wheel.diameter 所做的更改会被默默地忽略。

我发现即使我的`fields_for`调用嵌套`form_for`在 edit.html.erb 的块中，**发送到我的更新函数的参数也不是嵌套的**。

参数包含：

```
 {"utf8"=>"✓",
 "_method"=>"put",
 "authenticity_token"=>"owiV5xwbbt+ft8h4K4bIqshp5I6jrlj5XWEKeVXpoCQ=",
 "unicycle"=>{"brand"=>"Unibike"},
 "wheel"=>{"diameter"=>"70"},
 "commit"=>"Update Unicycle",
 "action"=>"update",
 "controller"=>"unicycles",
 "id"=>"1"} 
```

但根据 rails 文档（[ActiveRecordNestedAttributes](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)），车轮参数应该真正嵌套在 unicycle 中，如下所示：

```
 "unicycle"=>{"brand"=>"Unibike", "wheel"=>{"diameter"=>"68"}}, 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:57:18.643

这是生成嵌套字段的方式：

```
# ...
<%= formbuilder.fields_for :wheel do |fieldbuilder| %>
  <%= fieldbuilder.number_field :diameter %>
<% end %>
# ... 
```

# vba - 编辑 Word 文档中所有超链接的样式

> ID：15124578
> 
> 赞同：3
> 
> 时间：2013-02-27T23:26:55.310
> 
> 标签：vba, ms-word

我有一个充满超链接的word文档。链接本身工作正常，但由于某种原因，它们中的大多数不再是蓝色的了！我真正想做的就是尝试找到一种方法来使用宏或其他东西来浏览文档并将“超链接”样式格式添加到每个超链接。

我试图自己编辑一些宏代码（一个更改所有链接 URL 的代码），但我一直让问题变得更糟！我曾经擅长 VBScript，但从那时起已经很久了。

任何不涉及手动更改每种样式的简单解决方案？

作为旁注，出于某种原因，它们目前都处于“正常”风格。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T11:05:49.440

尝试执行此 VBA 脚本（最好在调试模式下使用 F8 键 - 并排放置 VBA 和 Word 窗口，以便查看发生了什么）：

```
Sub FormatLinks()
Dim H As Hyperlink

    For Each H In ActiveDocument.Hyperlinks
        H.Range.Select                                      ' (A)
        Selection.ClearFormatting                           ' (B)

        H.Range.Style = ActiveDocument.Styles("Hyperlink")  ' (C)
    Next H
End Sub 
```

这将

*   循环浏览文档 (A) 中的所有超链接，
*   删除基础文本 (B) 上的任何格式和
*   将不依赖的文本分配给样式“超链接”（C）

(C) 不是绝对必要的，因为 (B) 应该已经清理了您的文档，但是将超链接真正分配给样式“超链接”可能会更好，因为您以后可能想更改样式。

# ios - iOS嵌入视频，在另一个视图中视频仍然播放

> ID：15124579
> 
> 赞同：1
> 
> 时间：2013-02-27T23:27:00.027
> 
> 标签：ios, uiwebview, youtube, embed, uicollectionview

所以可以说我的视图上有一个 UIWebView，嵌入了一个 YouTube 视频。该视图连接到导航视图控制器。这意味着当我单击一个按钮时，它会将视图推送到堆栈上。但是当我播放 youtube 视频并转到下一个视图时。视频仍在播放。在转到另一个视图时，是否有办法停止嵌入 youtube 视频？

如果我在 UICollectionView 中有多个带有嵌入 YouTube 视频的 UIWebView 的单元格怎么办？我没有参考所有 UIWebViews 设置为零。（抱歉之前的混淆）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T11:11:00.313

如果您使用[Youtube Javascript api](https://developers.google.com/youtube/js_api_reference?hl=us)播放视频 - 您可以在离开当前视图时暂停它

```
-(void)viewWillDisapper:(BOOL)animated
{
    [super viewWillDisappear:animated];
    [webView stringByEvaluatingJavaScriptFromString: @"player.pauseVideo();"];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:37:40.687

当我移动到另一个页面时，我所做的只是将 UIWebView 的内容设置为 nil，这会完全删除视频播放器，但如果你只是想暂停视频以便用户在他们回来时可以恢复，你会有使用 javascript 与 youtube 播放器交谈。有关一种方法，请参阅[如何在 UIWebView 中暂停媒体播放。](https://stackoverflow.com/questions/11640135/how-to-pause-media-playback-in-uiwebview)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:37:27.177

您需要在 UIWebView 中加载一个空白页面以停止视频播放。这是一个快速的方法：

```
- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated]
    [yourWebView loadHTMLString:nil baseURL:nil];        
} 
```

# mysql - 使用 REGEX 查询表以查找 A OR B

> ID：15124580
> 
> 赞同：1
> 
> 时间：2013-02-27T23:27:04.107
> 
> 标签：mysql, regex, mariadb

我正在尝试对 MySQL 查询（*实际上是 MariaDB*）进行正则表达式匹配，以查找包含字符串“！Mutex”的文件路径中的任何单词，或者该文件夹是否以大写“M”结尾。

因此，如果单元格包含以下路径。

```
-------------
|路径_文件夹|
-------------------------------------------------- -----
|E:\folder01\folder01\folder03\!Mutex\folder05 |
|E:\folder01\folder01\folder03\folder4\!Mutex\folder06|
|E:\folder01\folder01\folder03\folder04\folderM |
-------------------------------------------------- -----

```

我不想将它移植到任何地方（没有 php），只是想找到结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:58:38.637

我知道您要求使用正则表达式解决方案，但有时这不是答案。:-)

您可以使用普通的 SQL`LIKE`表达式来代替。

```
SELECT 
  Path_Folder 
FROM 
  Your_Table 
WHERE 
  (Path_Folder LIKE '%!Mutex%') 
OR 
  (Path_Folder LIKE '%M') 
```

A`LIKE`应该可以满足您的需要，并且比正则表达式更快（并且更易于阅读/维护）。

# java - 为什么包含 JAVA_OPTS Xmx 时 Tomcat 不启动？

> ID：15124584
> 
> 赞同：1
> 
> 时间：2013-02-27T23:27:18.817
> 
> 标签：java, windows, tomcat, java-opts

我的本地 Windows 7 机器上有 Tomcat 7。当我`-Xmx`在我的 catalina.bat 文件中包含`JAVA_OPTS`Tomcat 时不会启动。但如果它被删除运行。什么可能导致这种情况发生？我的语法错了吗？

`catalina.bat`文件：

```
set JAVA_OPTS=-Xms128m –Xmx1024m -XX:PermSize=256m -Djava.rmi.server.hostname=MY_IP 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:31:02.123

有时，当您指定的内存超过运行环境分配给 VM 的可用内存时，它可能无法运行。检查日志以查找引发的特定错误/异常。

请注意，无论您指定的上限如何，JVM 都可能无法使用可用的系统内存。这取决于正在运行的其他应用程序。操作系统通常在内存分配方面占上风。

另外，这个[答案](https://stackoverflow.com/questions/5374455/what-does-java-option-xmx-stand-for)可能会对您有所帮助。

# r - R中的列绑定

> ID：15124590
> 
> 赞同：1
> 
> 时间：2013-02-27T23:27:46.850
> 
> 标签：r, binding, dataframe

我在 R 中使用 cbind 命令将许多 data.frames 绑定在一起，并且每个数据框具有相同的列名，因此当我将它们全部绑定时，R 会自动将列名更改为原始名称。例如，有一个名为“X”的列，因此对于每个绑定，它都会重命名此 X.1、X.2、X.3 等。有没有办法让我在不更改任何列名的情况下绑定它们并拥有多个具有相同名称的列？

我希望这样做的原因是，我可以按列名对组合后的 data.frame 进行排序，以便按照它们在组合 data.frame 中的相同顺序将所有相同命名的列放在一起。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T23:34:05.330

为了说明我评论中的观点：

```
> d1 <- data.frame(a = 1:5,b = 1:5)
> d2 <- data.frame(a = letters[1:5],b = letters[1:5])
> cbind(d1,d2)
  a b a b
1 1 1 a a
2 2 2 b b
3 3 3 c c
4 4 4 d d
5 5 5 e e

> data.frame(cbind(d1,d2))
  a b a.1 b.1
1 1 1   a   a
2 2 2   b   b
3 3 3   c   c
4 4 4   d   d
5 5 5   e   e

> x <- data.frame(cbind(d1,d2))
> sort(colnames(x))
[1] "a"   "a.1" "b"   "b.1"
> x[,order(colnames(x))]
  a a.1 b b.1
1 1   a 1   a
2 2   b 2   b
3 3   c 3   c
4 4   d 4   d
5 5   e 5   e 
```

# javascript - d3.js 无法解析“MNaN，NaN”

> ID：15124600
> 
> 赞同：1
> 
> 时间：2013-02-27T23:28:15.373
> 
> 标签：javascript, d3.js

我正在尝试用 d3.js 绘制地图，但我不断收到`Problem parsing d="MNaN,NaN"`

```
 <!-- language: lang-js -->
    var width=960, height=500;
    var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);
    var q = 0;
    var sc = 3000;
    var d3line2 = d3.svg.line()
                    .x(function(d){q= 0.95105*sc*(d[0]+66.4262);  return q;})
                    .y(function(d){q= sc*(-1*d[1]+ 18.2336);  return q;})
                    .interpolate("linear"); 

    d3.json("/prCounties.json", function(d){

        for(var k = 0; k < d.features[0].length; k++){
            svg.append("path")
            .attr("d", d3line2(d.features[0][k].geometry.coordinates) )
            .attr("class", "stroke");
        }
    }); 
```

这是 GeoJson 文件 - 它应该与[GitHub 上](https://github.com/johan/world.geo.json/blob/master/countries/USA/PR/Adjuntas.geo.json)的相同。

```
{
"type": "FeatureCollection", 
"properties": {"kind": "state", "state": "PR"}, 
"features": [[
    {"geometry": {"type": "MultiPolygon", "coordinates": [[[[-66.7222, 18.2198], [-66.6838, 18.2034], [-66.6729, 18.1541], [-66.6948, 18.1322], [-66.7167, 18.1322], [-66.7331, 18.1103], [-66.7715, 18.1377], [-66.7989, 18.1322], [-66.8262, 18.1705], [-66.8153, 18.2308], [-66.7824, 18.2527]]]]}, 
"type": "Feature", "properties": {"kind": "county", "name": "Adjuntas", "state": "PR"}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T01:50:05.880

可能有不止一个问题（jsFiddle 会有所帮助），但这里有一个：

生成器`d3.svg.line()`需要一个点数组。你给它`[[[[-66.7222, 18.2198], [-66.6838, 18.2034]....`，这*是*一个点数组，但它进一步嵌套到两个数组级别。我猜这是因为`coordinates`按规范的属性可以描述多个段（例如构成单个地理实体的多个岛屿，或“洞”，例如边界内的湖泊）。

所以在你的情况下你需要给它`d.features[0][k].geometry.coordinates[0][0]`

说了这么多，在不知道目的的情况下，请注意您将绘制经度纬度对，而不是投影的 X、Y 点。如果后者是您所期望的，那么您将需要查看`d3.geo.path()`，这将允许您指定投影。

# c - 生成所有列表（置换）

> ID：15124609
> 
> 赞同：2
> 
> 时间：2013-02-27T23:28:40.233
> 
> 标签：c

我很不确定为什么当我输入 6 个或更多数字/字符时我的代码会这样做，它只显示一些输出。（我知道数字/字符不会影响任何东西）。

例如，如果我输入 cat 它会列出所有可能的变化： cat cta act atc tac tca

但是当我输入 123456（或任何 6+ 个字母的字符串）时：它开始显示在 462513-612345（如果你知道我的意思的话）。其余的（123456-462513）怎么了？

```
 #include <stdio.h>
    #include <string.h>

    void swap (char *X, char *Y)
    {
      char Z;
      Z = *X;
      *X = *Y;
      *Y = Z;
    }

    void mixmatch (char *A, int i, int n)
    {
      int j;
      if (i == n)
         printf("%s\n", A);
      else
      {
         for (j = i; j <= n; j++)
         {
            swap((A+i), (A+j));
            mixmatch(A, i+1, n);
            swap((A+i), (A+j));
         }
      }
    }

    int main()
    {
       char A[100];
       printf ("Enter the string/set of numbers: ");
       gets(A);

       int k;
       k=strlen(A);
       mixmatch(A, 0, k-1);

    return 0;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:37:12.593

问题不在于您的代码，问题在于 Windows`cmd.exe`没有足够的缓冲区来向您显示*所有*排列。

我尝试使用 cygwin，它完美无缺。

以下是证明这一点的屏幕截图：

# 使用 cmd.exe

![在此处输入图像描述](../Images/ab7734159e902fddb0c3e33192adc375.png)

# 用cygwin

![在此处输入图像描述](../Images/2f491925ecb55a6ca056309b873724a0.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:42:46.930

阿尼凯特是对的。

这是做什么：

您可以使用左上角菜单的设置来增加 cmd.exe 的存储空间。将缓冲区高度设置为 9999。

# mongodb - 同一台服务器上的多个 Mongo DB 实例

> ID：15124610
> 
> 赞同：58
> 
> 时间：2013-02-27T23:29:03.227
> 
> 标签：mongodb

我正在与 Mongo DB 合作，我是新手。我即将将它安装在专门用于 Mongo 的服务器上。

我想创建 2 个实例 - 1 个用于支持 QA 环境，另一个用于支持暂存环境。

我更熟悉可以创建多个实例的 SQL Server。

是否可以对 Mongo DB 做同样的事情，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2015-01-28T14:06:31.547

上述[答案](https://stackoverflow.com/a/15930192/2505920)不是运行多个实例的推荐方法（尤其是当服务器可能同时运行时），因为它会导致使用相同的配置参数，例如*logpath*和*pidfilepath*在大多数情况下不是你的想。

请考虑创建专用的 mongod 配置文件，例如*mongod-QA.conf*和*mongod-STAGE.conf*。在这些文件中，您可能希望提供特定于每个 mongod 实例的*dbpath*、*logpath*文件夹、*bind_ip*、*port*和*pidfilepath*，它们不会相互影响。

在这些步骤之后，您可以触发两个实例，如下所示

```
mongod --config <path-to>/mongod-QA.conf
mongod --config <path-to>/mongod-STAGE.conf 
```

您可以在 mongodb 文档[页面上找到更多详细信息](http://docs.mongodb.org/manual/administration/configuration/#run-time-database-configuration)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2013-04-10T15:30:35.213

您只需要为第二个实例创建另一个文件夹（例如：mongodb2） **dbpath ，并在不同的****端口**（例如：27018）中运行它

```
 mongod --dbpath /usr/local/var/mongodb2 --port 27018 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2016-02-04T05:32:35.667

这是我**在同一台电脑上启动 4 个***mongod* 以在开发环境中**模拟生产环境的方法。**

 ****要启动*mongod*，您应该**为每个 mongod 使用单独的配置**。获取 4 个配置并使用它们启动*mongods*：

```
start C:\mongodb\bin\mongod.exe --config C:\net2\dev1-pc\configs\mongod-primary1.cfg 
start C:\mongodb\bin\mongod.exe --config C:\net2\dev1-pc\configs\mongod-secondary1.cfg --rest
start C:\mongodb\bin\mongod.exe --config C:\net2\dev1-pc\configs\mongod-secondary2.cfg
start C:\mongodb\bin\mongod.exe --config C:\net2\dev1-pc\configs\mongod-secondary3.cfg 
```

配置如下所示：

*mongod-primary1.cfg 文件内容*

```
systemLog:
    destination: file
    path: c:\net2\primary1-pc\data\log\mongod.log
storage:
    dbPath: c:\net2\primary1-pc\data\db
net:
    port: 27018
replication:
    replSetName: repl1 
```

*mongod-secondary1.cfg 文件内容*

```
systemLog:
    destination: file
    path: c:\net2\secondary1-pc\data\log\mongod.log
storage:
    dbPath: c:\net2\secondary1-pc\data\db
net:
    port: 27019
replication:
    replSetName: repl1 
```

*mongod-secondary2.cfg 文件内容*

```
systemLog:
    destination: file
    path: c:\net2\secondary2-pc\data\log\mongod.log
storage:
    dbPath: c:\net2\secondary2-pc\data\db
net:
    port: 27020
replication:
    replSetName: repl1 
```

*mongod-secondary3.cfg 文件内容*

```
systemLog:
    destination: file
    path: c:\net2\secondary3-pc\data\log\mongod.log
storage:
    dbPath: c:\net2\secondary3-pc\data\db
net:
    port: 27021
replication:
    replSetName: repl1 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-02-28T00:07:30.667

这是可能的——你会给每个人一个自己的端口来监听，以及它自己的 --dbpath 目录来放置它的文件，但我不建议这样做，因为它们都会竞争相同的资源——RAM、i/ o 带宽等。

如果您在此服务器上有多个磁盘，则可以将它们的数据文件放在不同的设备上，但您仍然冒着 QA 实例降低生产实例可用性的风险，可能是在最坏的时间。

在将 QA 实例与我的生产实例并置之前，我会将 QA 实例放在正在做一些不重要的事情的随机机器上。****

# css - 使用 simple_form 如何在这些内部标签和外部标签上获得此类？

> ID：15124611
> 
> 赞同：2
> 
> 时间：2013-02-27T23:29:03.343
> 
> 标签：css, ruby-on-rails, ruby-on-rails-3, simple-form

所以这就是我想要得到的结果：

```
<div class="control-group">
  <label class="control-label" for="ListingType">Listing Type:</label>
  <div class="controls">
    <label class="inline"><input type="radio" name="ListingType"> For Sale</label>
    <label class="inline"><input type="radio" name="ListingType"> For Rent</label>
  </div>
</div> 
```

我试过这个：

```
<%= f.association :listing_type, label: "Listing Type: ", as: :radio_buttons, input_html: { class: 'inline'} %> 
```

这是产生的：

```
<div class="control-group radio_buttons optional">
   <label class="radio_buttons optional control-label">Listing Type:</label>
   <div class="controls">
      <label class="radio"><input class="radio_buttons optional inline" id="listing_listing_type_id_1" name="listing[listing_type_id]" type="radio" value="1" />For Sale</label>
      <label class="radio"><input class="radio_buttons optional inline" id="listing_listing_type_id_2" name="listing[listing_type_id]" type="radio" value="2" />For Rent</label>
  </div>
</div> 
```

注意 与`label.class="radio"`相对`label.class="inline"`。

这是我试图正确完成的主要事情。

我试过`label_html: { class: 'inline' }`了，它产生了这个：

```
<div class="control-group radio_buttons optional">
   <label class="radio_buttons optional control-label inline">Listing Type:</label>
   <div class="controls">
     <label class="radio"><input class="radio_buttons optional" id="listing_listing_type_id_1" name="listing[listing_type_id]" type="radio" value="1" />For Sale</label>
     <label class="radio"><input class="radio_buttons optional" id="listing_listing_type_id_2" name="listing[listing_type_id]" type="radio" value="2" />For Rent</label>
   </div>
</div> 
```

即它将类移动`inline`到最外层`<label>`，而不是`label`每个单选按钮。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:42:15.907

只需将@flynfish 的答案从[如何更改 simple_form 中复选框的标签类别](https://stackoverflow.com/questions/5812325/how-to-change-class-of-a-label-for-checkboxes-in-simple-form)复制到此线程。似乎是根据@marcamillion 评论这里的一个。

> 您可以使用此选项为标签指定一个类：item_wrapper_class => 'class_goes_here'
> 
> 这是一个完整的例子：
> 
> ```
> = user.input :resident, 
>          :collection => [["In the U.S", true],["Outside the U.S.", false]], 
>          :label_method => :first, 
>          :value_method => :last,
>          :as => :radio_buttons, 
>          :label => "Where is your principle residence?",
>          :item_wrapper_class => 'inline' 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-04T01:55:18.000

@moonfly 的答案对于当前版本不再适用`simple_form`（我已经尝试过 3.3.1 版）。

要更改每个单选按钮标签的类，您必须使用如下选项`item_label_class`：

```
<%= f.association :listing_type, label: "Listing Type: ", as: :radio_buttons, item_label_class: 'inline' %> 
```

或来自@moonfly 的回答：

```
= user.input :resident, 
     :collection => [["In the U.S", true],["Outside the U.S.", false]], 
     :label_method => :first, 
     :value_method => :last,
     :as => :radio_buttons, 
     :label => "Where is your principle residence?",
     :item_label_class => 'inline' 
```

`item_wrapper_class`将为新版本的 simple_form 修改每个单选按钮跨度的类。

# c# - 在异步任务完成之前返回

> ID：15124615
> 
> 赞同：10
> 
> 时间：2013-02-27T23:29:13.277
> 
> 标签：c#, asp.net-mvc-4, .net-4.5, async-await

我正在开发一个 ASP.NET MVC 4 Web 应用程序。我正在使用 .NET 4.5 并试图利用新的异步 API。

我有几种情况，我想安排一个异步任务稍后运行，同时我立即返回一个立即重要的值。例如，这是一个“登录”方法，我想尽快返回一个新的 SessionID，但是一旦我返回了 SessionID，我想清除旧的过期 SessionID：

```
public async Task<Guid> LogIn(string UserName, string Password)
{
    //Asynchronously get ClientID from DB using UserName and Password

    Session NewSession = new Session()
    {
        ClientID = ClientID,
        TimeStamp = DateTime.Now
    };
    DB.Sessions.Add(NewSession);
    await DB.SaveChangesAsync();    //NewSession.ID is autopopulated by DB

    CleanSessions(ClientID);    //Async method which I want to execute later

    return NewSession.ID;
}

private async void CleanSessions(int ClientID)
{
    //Asynchronously get expired sessions from DB based on ClientID and mark them for removal
    await DB.SaveChangesAsync();
} 
```

我尝试了很多不同的东西，包括 Task.Run() 和 Parallel.Invoke() 的组合，但 CleanSessions 永远不会被调用。如何实现后台任务调度？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-27T23:39:02.860

不建议在没有请求的情况下在 ASP.NET 中运行任务。[这很危险。](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)

也就是说，更改`CleanSessions`为返回`Task`，您可以这样做：

```
Task.Run(() => CleanSessions()); 
```

`CleanSessions`在您的情况下，我认为可以，因为如果不执行或在执行过程中终止（这可能由于回收而在 ASP.NET 中发生），则不会出现长期问题。如果你想通知 ASP.NET 你正在进行一些与请求无关的工作，你可以使用[`BackgroundTaskManager`我的博客](http://blog.stephencleary.com/2012/12/returning-early-from-aspnet-requests.html)中的如下：

```
BackgroundTaskManager.Run(() => CleanSessions()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T07:04:34.960

如果，如前所述，您正试图在 ASP.NET 内部做一些“一劳永逸”的事情 - 那么您可能想看看`ConfigureAwait`; 您可以使用它作为`await`告诉它忽略同步上下文的一部分。正是同步上下文将其与 ASP.NET 执行管道联系起来，但如果没有必要，您可以避免使用它。例如：

```
public async Task<Guid> LogIn(string UserName, string Password)
{
    //Asynchronously get ClientID from DB using UserName and Password

    Session NewSession = new Session()
    {
        ClientID = ClientID,
        TimeStamp = DateTime.Now
    };
    DB.Sessions.Add(NewSession);
    await DB.SaveChangesAsync().ConfigureAwait(false);    //NewSession.ID is autopopulated by DB

    await CleanSessions(ClientID).ConfigureAwait(false);    //Async method which I want to execute later

    return NewSession.ID;
}
// simplified: no need for this to be full "async"
private Task CleanSessions(int ClientID)
{
    //Asynchronously get expired sessions from DB based on ClientID
    return DB.SaveChangesAsync();
} 
```

# jquery - jquery - 加载图像然后使用该图像触发事件

> ID：15124619
> 
> 赞同：0
> 
> 时间：2013-02-27T23:29:27.697
> 
> 标签：jquery

我正在做一些代码来将图像插入到 div 中，加载它们后，用户可能能够通过单击图像来触发事件，由于某些奇怪的原因，这不起作用，这里是代码：

```
 $(function(){
    getPictures('pictures.xml');

    function getPictures(picturesXML){
        $.get(picturesXML, function(data){

            var pictures = data;    
            var countElements = $(pictures).find('pic').length;             

            $(pictures).find('pic').each( function( i ){

                var img = $('<img src="images/' + $(this).attr('src') + '" style="top : ' + $(this).attr('top') + 'px; left: ' + $(this).attr('left') + 'px" width=" '+ $(this).attr('w')  +'"/>');

                    img.load( function(){   
                        $('.space').append( $(this) );
                        $(this, 'space').delay(100*i).fadeIn('fast');   
                    });                                 

            })      

            $('.space img').mouseenter(function(){
                alert('hello');

            })

        })
    }
}) 
```

有没有人可以帮我解决这个问题。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:33:35.060

常规的 jQuery 事件函数往往不支持事件冒泡。尝试使用 $.on 方法。在这种情况下，替换：

```
$('.space img').mouseenter(function(){
            alert('hello');

        }) 
```

和：

```
$(document).on('mouseenter','.space img', function(){
            alert('hello');

        }); 
```

另外，请注意缺少的分号。这应该可以解决问题。

# actionscript-3 - Vector可以转换为布尔值吗？

> ID：15124628
> 
> 赞同：0
> 
> 时间：2013-02-27T23:30:39.203
> 
> 标签：actionscript-3

我预计如果我将 Vector 传递给带有布尔参数的方法，编译器会抱怨。但它甚至没有发出警告。当我将 Sprite 作为参数传递时，我收到警告，但程序仍然可以编译。为什么类型检查系统没有捕捉到这个？

```
package {
    import flash.display.Sprite;

    public class Main extends Sprite {
        public function Main():void {
            test(new Vector.<Number>()); // No warning or error.
            test(new Sprite()); // Warning, but no error.
        }

        public function test(value:Boolean):void {
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T23:39:52.850

这是因为您的函数`test()`会将您给它的值转换为布尔值（真或假），具体取决于它是真还是*假*。

例子：

```
function test(bool:Boolean):void
{
    trace(bool);
}

test( new Sprite() ); // true
test( 5 );            // true
test( undefined );    // false
test( "" );           // false
test( null );         // false 
```

`if`这与准备语句时使用的过程相同：

```
if(new Sprite())
{
    trace("Yep.");
}

if(null)
{
    // Never happens.
    trace("Nope.");
} 
```

您可以在此处阅读有关转换为 Boolean 的过程的更多信息：[Casting to Boolean](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7f87.html#WS5b3ccc516d4fbf351e63e3d118a9b90204-7f87__WS5b3ccc516d4fbf351e63e3d118a9b90204-7f77)。

> **强调**
> 
> *   如果实例为空，则从 Object 类的实例转换为布尔值返回 false；否则，它返回真。
> *   如果字符串为 null 或空字符串 ("")，则从字符串值转换为布尔值将返回 false。否则，它返回真。
> *   如果数值为 0，则从任何数值数据类型（uint、int 和 Number）转换为布尔值会导致 false，否则为 true。对于 Number 数据类型，值 NaN 也会导致 false。

# linux - -o 在 Linux 终端中（Dash o）；这是什么意思？

> ID：15124629
> 
> 赞同：7
> 
> 时间：2013-02-27T23:30:47.990
> 
> 标签：linux, terminal

我是 Linux 终端的新手，很多命令都 `-o`在其中使用。

例如编译你说的 NASM 程序

```
gcc prgram1.o -o prgram1 
```

我可以猜测它与输出有关，但任何人都可以为我提供正确的定义和直觉吗？

PS 我做了很多谷歌搜索，找到了很多带有 Linux 终端命令参考的页面，但没有涵盖简单的`-o`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-27T23:40:29.630

在大多数情况下，-o 将代表输出，但它不是一个定义的标准，它可能意味着开发人员希望它意味着的任何东西，人们知道哪些命令的唯一方法是使用 --help、-h 的命令行选项，或者其他的东西 -？再次显示一个简单的命令列表，因为程序的开发人员选择了可能的输入参数，这意味着这可能因程序而异。

最安全的了解方式通常是运行

```
man gcc 
```

用您想要的程序名称替换第二部分。

```
man <program name> 
```

这列出了该程序的完整指南，其中包含更多详细信息，并且通常格式正确，可以在终端上阅读。读完后按Q。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-27T23:33:12.317

-o 标志通常用于表示输出文件的名称。但是，由于它是一个标志，您应该在手册中查找具体标志是什么。您也可以使用 -h 或 --help 运行程序以显示选项和标志列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-27T23:34:28.317

-o 标志表示编译或链接操作的输出文件。查看命令的手册页以找出所有可能的命令行选项。

# jquery - jQuery 选择器：如何在父 div 中选择另一个元素

> ID：15124631
> 
> 赞同：0
> 
> 时间：2013-02-27T23:30:59.017
> 
> 标签：jquery, css, jquery-selectors

我需要在我的 HTML 中找到一个`.detailsBox`用 jQuery 调用的 div。div 是在循环中输出的所有具有相同类名的一系列 div 之一，当单击链接时将向下滑动。

这是HTML：

```
<div id="support">
    <h2><a href="#" class="title"><?php echo $growing->title; ?></a></h2>  <!-- Click on this link... -->

    <div class="detailsBox">  <-- ... and this div will slide down from being hidden -->
        <div id="tabs-text">
            <p class="description"><?php echo $growing->description; ?></p>
        </div>

        <div id="learnmore">  
            <a class="sendEmail" target="_blank" id="<?php echo $growing->link;?>" href="<?php echo base_url() . 'channel-partners/tools/' . $growing->link; ?>"><?php echo $growing->link_text; ?></a>      
            <a class="sendEmail" id="<?php echo $growing->link2;?>"  href="<?php echo $growing->link2; ?>"><?php echo $growing->link_text2; ?></a>   
       </div>

    </div>
 </div> 
```

我可以像这样找到父 div：

```
var parent = $(this).parent().parent(); 
```

但我需要一种方法来找到孩子`.detailsBox`。我怎么做。我试过这个，但没有奏效：

```
$(parent + '> div.detailsBox').slideDown(); 
```

控制台抱怨这是一个无法识别的表达式，因为我试图组合一个对象和一个字符串。如何使整个东西成为包装在 jQuery 中的选择器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:32:54.750

尝试`parent.children('.detailsBox').slideDown();`

`parent()`返回一个 jQuery 对象，因此您可以使用该对象的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:33:14.610

您可以在 jquery 中将 parent 作为上下文参数传递，即。

```
$('div.detailsBox', $(parent)).slideDown(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:34:55.497

只需使用`parent.find(".detailsBox")`. 但是我总是建议在 jquery 对象前加上 $ 符号，即`var $parent = $(...)`

# objective-c - 如何在目标中编写函数 - c 将 6 位整数转换为 4 字节十六进制值？

> ID：15124635
> 
> 赞同：1
> 
> 时间：2013-02-27T23:31:06.143
> 
> 标签：objective-c

如何在 Objective-C 中将整数 6 位数字（例如“1234674”）转换为十六进制 4 字节 NSData？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:40:20.917

数据是字节，字节是位而不是十六进制，十六进制只是解释数据的一种方式。ARM 中的 int 是 32 位的（可以使用 int32_t 或 sizeof）

你可以做

```
int x = 1234674;
NSData *myData = [NSData dataWithBytes:&x length:sizeof(int)] 
```

然后如果您想将该数据打印为十六进制：

```
char c[4] = [myData bytes];
NSLog("%@",[NSString stringWithFormat:@"%02X%02%02X%02",c[0],c[1],c[2],c[3]]); 
```

如果您只想打印或转换为十六进制字符串，可以使用这样的 char 指针：

```
char *c = &x;
NSString *hexStr = [NSString stringWithFormat:
    @"%02X%02%02X%02", *c, *(c+1), *(c+2), *(c+3)]; 
```

我没有尝试编码，但应该可以工作，以防万一我希望你明白了

# android - 带有自行实现的 OnClickListener 的 NullPointerException

> ID：15124640
> 
> 赞同：0
> 
> 时间：2013-02-27T23:31:25.777
> 
> 标签：android

对不起，但似乎我只是到处都有各种 OnClickListener 的东西在过去的几天里不起作用......

我有一个我正在显示的固定各种变量/数据（联系人）的 ListView，对于每个 ListView 项目，我使用单独的 XML 文件 ( `contacts_item`) 来格式化/显示这些数据。ListView 中的每个项目要么是电话联系人，要么是电子邮件联系人。我正在努力做到这一点，以便当点击其中一个联系人时，它会开始打电话或显示新电子邮件。（现在专注于调用方面，但这有什么关系？）

主要活动的代码片段：

```
public void onCreate(Bundle saveInstanceState) {
    super.onCreate(saveInstanceState);
    setContentView(R.layout.contacts_layout);

    // Show "back" button
    aboutButton = (Button) findViewById(R.id.aboutButton);
    aboutButton.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            Contacts.this.finish();
        }
    });

ListView listview = (ListView) findViewById(R.id.contactItem);
ArrayList<HashMap<String, String>> items = new ArrayList<HashMap<String, String>>();
// loop through 8 times for each contact entry
for (int i = 0; i < 8; i++) {
        HashMap<String, String> entry = new HashMap<String, String>();
        entry.put("title", title[i]);
        entry.put("name", name[i]);
        entry.put("label", label[i]); // Call, mail, etc.
        entry.put("info", info[i]); // The actual phone number or email

        // Check the label field of each entry
        if (label[i].equals("Call")) {
            TextLabel = (TextView) findViewById(R.id.contactLabel); // contactLabel is from the separate XML file I mentioned
            Log.v("textlabel", "textlabel: " + R.id.contactLabel);

            // Crashes here              
            //TextLabel.setOnClickListener(new ContactOCL(info[i]));
        }

        // Let's see if all of this is printing out right
        Log.v("title", "Title: " + title[i]);
        Log.v("name", "Name: " + name[i]);
        Log.v("label", "Label: " + label[i]);
        Log.v("info", "Info: " + info[i]);

        items.add(entry);
}

ListAdapter adapter = new SimpleAdapter(Contacts.this, items, R.layout.contacts_item, new String[] {"title", "name", "label", "info"},
            new int[] {R.id.contactTitle, R.id.contactName, R.id.contactLabel, R.id.contactInfo});

    // Create an inflater to use another xml layout (the Facebook/Twitter/Instagram buttons)
    LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View footerView = inflater.inflate(R.layout.contacts_footer, null);

    // Define their clicks
    facebookButton = (ImageButton) footerView.findViewById(R.id.facebookButton);
    twitterButton = (ImageButton) footerView.findViewById(R.id.twitterButton);
    instagramButton = (ImageButton) footerView.findViewById(R.id.instagramButton);

    facebookButton.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            // Open up the Facebook page when clicked
            facebookPage = new Intent(android.content.Intent.ACTION_VIEW);
            facebookPage.setData(Uri.parse(facebookURL));
            startActivity(facebookPage);
        }
    });

    twitterButton.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            // Open up the Twitter page when clicked
            twitterPage = new Intent(android.content.Intent.ACTION_VIEW);
            twitterPage.setData(Uri.parse(twitterURL));
            startActivity(twitterPage);
        }
    });

    instagramButton.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            // Open up the Instagram page when clicked
            instagramPage = new Intent(android.content.Intent.ACTION_VIEW);
            instagramPage.setData(Uri.parse(instagramURL));
            startActivity(instagramPage);
        }
    });

    // Add the footer to the listview, then set adapter
    // MUST BE CALLED IN THIS ORDER!
    listview.addFooterView(footerView);
    listview.setAdapter(adapter); 
```

联系OCL：

```
public class ContactOCL extends Activity implements OnClickListener {
    String contactInfo;
    public ContactOCL(String contactInfo) {
        this.contactInfo = contactInfo;
    }

    public void onClick(View v) {
        try {
            Intent callIntent = new Intent(Intent.ACTION_CALL);
            callIntent.setData(Uri.parse("tel:" + contactInfo));
            v.getContext().startActivity(callIntent);
        } catch (ActivityNotFoundException activityException) {
            Log.e("Calling a Phone Number", "Call failed", activityException);
        }
    }

} 
```

这是堆栈跟踪：

```
02-27 16:29:15.813: E/AndroidRuntime(1025): FATAL EXCEPTION: main
02-27 16:29:15.813: E/AndroidRuntime(1025): java.lang.RuntimeException: Unable to start activity ComponentInfo{org.radio.app/org.radio.app.Contacts}: java.lang.NullPointerException
02-27 16:29:15.813: E/AndroidRuntime(1025):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at android.os.Looper.loop(Looper.java:137)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at android.app.ActivityThread.main(ActivityThread.java:4745)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at java.lang.reflect.Method.invokeNative(Native Method)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at java.lang.reflect.Method.invoke(Method.java:511)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at dalvik.system.NativeStart.main(Native Method)
02-27 16:29:15.813: E/AndroidRuntime(1025): Caused by: java.lang.NullPointerException
02-27 16:29:15.813: E/AndroidRuntime(1025):     at org.radio.app.Contacts.onCreate(Contacts.java:78)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at android.app.Activity.performCreate(Activity.java:5008)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
02-27 16:29:15.813: E/AndroidRuntime(1025):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023) 
```

textlabel 也打印了几次，所有这些都是相同的数字/ID...我假设这是一个不好的迹象，而不是我想要的。所以我不确定是不是我的实现导致了这个崩溃，或者......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:51:49.137

您不能使用`View`诸如 a`TextView`或`Button`来自`Layout`尚未使用`setContentView()`or a 膨胀的 a `layoutInflater`。这似乎是你的问题，除非我错过了你在哪里做的。放入您要使用`Views`的`Layout`，然后如果您需要进一步格式化，您可以通过编程方式更改属性

# c# - 使用 API 时从 MSBUILD 中跳过/排除项目类型

> ID：15124641
> 
> 赞同：4
> 
> 时间：2013-02-27T23:31:27.497
> 
> 标签：c#, msbuild, msbuild-api

我正在使用 MSBUILD API 来构建使用服务的解决方案。

例如

```
var pc = new ProjectCollection();
var buildProperties = new Dictionary<string, string>
{
   {"Configuration", "Release"},
   {"Platform", "Any CPU"},
   {"OutputPath", _outputPath}
};

var buildParameters = new BuildParameters(pc);

var buildRequest = new BuildRequestData(_buildFile, buildProperties, null, new[] { "Clean", "Rebuild" }, null);            

var buildResult = BuildManager.DefaultBuildManager.Build(buildParameters, buildRequest); 
```

我想要做的是传入排除项目类型或扩展的列表。首先，我想排除：

*   数据库项目
*   WinRT 项目
*   通用 MSBUILD 文件（无项目类型 GUID）。

有没有办法通过将一些参数传递给 MSBUILD 管理器来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T00:20:46.390

这不是您所追求的，但我只是在过去的日常工作中碰巧在使用 msbuild API，并认为这段代码可能有用*：*

```
var basePath = "path-to-where-source-is";
var outputDir = "path-to-output";

// Setup some properties that'll apply to all projs
var pc = Microsoft.Build.Evaluation.ProjectCollection.GlobalProjectCollection;
pc.SetGlobalProperty("Configuration", "Debug");
pc.SetGlobalProperty("Platform", "Any CPU");
pc.SetGlobalProperty("OutDir", outputDir);

// Generate the metaproject that represents a given solution file
var slnProjText = SolutionWrapperProject.Generate(
    Path.Combine(basePath, "NAME-OF-SOLUTION-FILE.sln"), 
    "4.0", 
    null);

// It's now a nice (well, ugly) XML blob, so read it in
using(var srdr = new StringReader(slnProjText))
using(var xrdr = XmlReader.Create(srdr))
{
    // Load the meta-project into the project collection        
    var slnProj = pc.LoadProject(xrdr, "4.0");

    // Slice and dice the projects in solution with LINQ to
    // get a nice subset to work with
    var solutionProjects = 
        from buildLevel in Enumerable.Range(0, 10)
        let buildLevelType = "BuildLevel" + buildLevel
        let buildLevelItems = slnProj.GetItems(buildLevelType)
        from buildLevelItem in buildLevelItems
        let include = buildLevelItem.EvaluatedInclude
        where !include.Contains("Some thing I don't want to build")
        select new 
        { 
            Include=include, 
            Project = pc.LoadProject(Path.Combine(basePath, include))
        };

    // For each of them, build em!
    foreach (var projectPair in solutionProjects)
    {
        var project = projectPair.Project;
        var include = projectPair.Include;
        var outputPath = outputDir;
        project.SetProperty("OutputPath", outputPath);
        Console.WriteLine("Building project:" + project.DirectoryPath);
        var buildOk = project.Build("Build");
        if(buildOk)
        {
            Console.WriteLine("Project build success!");
        } 
        else
        {
            throw new Exception("Build failed");
        }
    }
} 
```

# windows-phone-7 - Windows Phone 中可以自定义 contextMenu 或 QuickAction 对话框吗？

> ID：15124646
> 
> 赞同：1
> 
> 时间：2013-02-27T23:31:42.537
> 
> 标签：windows-phone-7, windows-phone-8, windows-phone

美好的一天，我对 Windows Phone 开发很陌生。我正在为 Windows 手机设计一个应用程序的原型，所以我需要知道我能做什么/不能做什么，或者我能多接近这种功能。我的问题是，有没有一种方法可以在按下按钮时在 Windows 手机中使用自定义 QuickAction 或 ContextMenu 对话框，就像在 android 中一样。

![快速操作栏](../Images/285af39137df6715ea52d1ab0d396def.png)

像这样的事情，或者我怎样才能最好地得到一个带有图像的弹出窗口？请任何指向我正确方向的链接将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T04:54:43.227

您可能想要研究的是使用[`Windows Phone Toolkit`'s](http://phone.codeplex.com/) `ContextMenu`类。

这将允许您实现一个上下文菜单，如：![上下文菜单示例](../Images/da961040364c81c349f8d469d51363bd.png)

阅读[http://windowsphonegeek.com/articles/wp7-contextmenu-in-depth--part1-key-concepts-and-api](http://windowsphonegeek.com/articles/wp7-contextmenu-in-depth--part1-key-concepts-and-api)应该可以帮助您！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T07:18:13.137

来自 Syncfusion Windows Phone 工具包的径向菜单，可以用作快速上下文菜单。它以针对触摸设备优化的圆形布局显示分层菜单。

[http://www.syncfusion.com/products/windows-phone/controls](http://www.syncfusion.com/products/windows-phone/controls)

# iphone - NSUserDefaults 导致崩溃

> ID：15124647
> 
> 赞同：-1
> 
> 时间：2013-02-27T23:32:02.270
> 
> 标签：iphone, sdk, nsuserdefaults

长话短说，我目前在我的 viewDidLoad 中使用此代码来恢复任何已保存的值（使用 NSUserDefaults）并检查这是否是第一次运行该应用程序。一切正常，直到我通过重新启动手机或从我的多任务处理中删除应用程序来测试 NSUserDefaults。基本上，该应用程序打开时冻结、崩溃、无法执行任何操作。我觉得这与回忆可能不存在的价值观有关。

```
NSDictionary *defaultsDict =
[[NSDictionary alloc] initWithObjectsAndKeys:[NSNumber numberWithBool:YES], @"FirstLaunch", nil];
[[NSUserDefaults standardUserDefaults] registerDefaults:defaultsDict];

NSUserDefaults *sharedDefaults = [NSUserDefaults standardUserDefaults];
if ([sharedDefaults boolForKey:@"FirstLaunch"]) {

    NSLog(@"first launch");

    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.5];
    [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromLeft forView:self.view cache:YES];
    [nameView removeFromSuperview];
    [amountView removeFromSuperview];
    [self.view addSubview:firstView];
    [initialText becomeFirstResponder];

    [sharedDefaults setBool:NO forKey:@"FirstLaunch"];
    [sharedDefaults synchronize];
}

NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

NSObject * object = [defaults objectForKey:@"budgetLabel"];
if(object != nil){

    NSString *budgetSaved = [defaults objectForKey:@"budgetLabel"];
    NSArray *namesSaved = [defaults objectForKey:@"nameArray"];
    NSArray *pricesSaved = [defaults objectForKey:@"priceArray"];

    budgetLabel.text = budgetSaved;
    [nameArray addObjectsFromArray:namesSaved];
    [priceArray addObjectsFromArray:pricesSaved];
} else {

} 
```

请记住，任何帮助表示赞赏！

**编辑**

这是我用来存储数据的代码：

```
- (void)saveData {
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setObject:budgetLabel.text forKey:@"budgetLabel"];
[defaults setObject:nameArray forKey:@"nameArray"];
[defaults setObject:priceArray forKey:@"priceArray"];
[defaults synchronize];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T03:04:01.397

解决了！

我已经用以下代码解决了我的问题：

```
nameArray = [[defaults mutableArrayValueForKey:@"nameArray1"] mutableCopy];
priceArray = [[defaults mutableArrayValueForKey:@"priceArray1"] mutableCopy]; 
```

感谢大家的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T09:15:26.347

```
NSArray *namesSaved = [defaults objectForKey:@"nameArray"]; 
```

使用它，您将获得非可变数组，然后

```
[nameArray addObjectsFromArray:namesSaved]; 
```

您正在将它添加到 mutableArray。

这就是它造成崩溃的原因。

# gnuplot - 如何使用mac终端从数据文件中进行gnuplot

> ID：15124648
> 
> 赞同：0
> 
> 时间：2013-02-27T23:32:03.513
> 
> 标签：gnuplot

我在 OSX Lion 上安装了 gnuplot。但是，我在使用 plot 命令从文件中绘制数据时遇到了困难，我收到了这个错误提示，

```
plot /Users/kukiyuki/Desktop/gnuplottest/test.txt u 1:2 w l
     ^
invalid expression 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:43:22.833

尝试使用引号，例如：

```
gnuplot> plot "./data.txt" #it appears a graph 
```

而没有引号会出现您的错误：

```
gnuplot> plot ./data.txt
              ^
         invalid expression 
```

# php - 在PHP中以大写字母拆分？

> ID：15124652
> 
> 赞同：11
> 
> 时间：2013-02-27T23:32:35.097
> 
> 标签：php, preg-split

我发现了这个类似的问题，但它没有回答我的问题，[Split word by capital letter](https://stackoverflow.com/questions/9645445/split-word-by-capital-letter)。

我有一个字符串是[驼峰式](https://en.wikipedia.org/wiki/CamelCase)的。我想在每个大写字母处分解该字符串，如下所示。

```
$str = 'CamelCase'; // array('Camel', 'Case'); 
```

我已经做到了这一点：

```
$parts = preg_split('/(?=[A-Z])/', 'CamelCase'); 
```

但是结果数组的开头总是以一个空值结束！`$parts`看起来像这样

```
$parts = array('', 'Camel', 'Case'); 
```

如何摆脱数组开头的空值？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-27T23:35:06.333

您可以像这样使用 PREG_SPLIT_NO_EMPTY 标志：

```
$parts = preg_split('/(?=[A-Z])/', 'CamelCase', -1, PREG_SPLIT_NO_EMPTY); 
```

请参阅[*preg_split*](http://php.net/manual/en/function.preg-split.php)[的文档](http://php.net/manual/en/function.preg-split.php)*。*

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T23:39:13.803

你需要一个积极的向后看。试试这个：

```
$parts = preg_split('/(?<=\\w)(?=[A-Z])/', 'CamelCase')

array(2) {
  [0]=>
  string(5) "Camel"
  [1]=>
  string(4) "Case"
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T23:35:32.063

数组过滤器可用于删除所有空值：

```
$parts = array_filter( $parts, 'strlen' ); 
```*

# maven - 是否可以强制 jenkins 的 maven 插件以 root 身份运行？

> ID：15124653
> 
> 赞同：1
> 
> 时间：2013-02-27T23:32:36.017
> 
> 标签：maven, jenkins, root

我有一个特别涉及的 java 应用程序，它需要在构建运行文件挂载时对系统资源进行 root 访问。有没有办法通过 maven2/3 插件使用 jenkins 的“sudo”直接调用 maven？还是插件总是以jenkins运行。？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:11:40.437

以下是如何以 root 身份运行 Jenkins - 这将导致 maven 插件进程也以 root 身份运行。

# 方法1）在JENKINS_USER中修改如下行`/etc/sysconfig/jenkins`

```
 #JENKINS_USER=jenkins
  JENKINS_USER=root 
```

在基于 Debian 的系统中，该文件位于`/etc/default/jenkins`

# 方法二）直接修改/etc/init.d/jenkins

```
 #daemon --user "$JENKINS_USER" --pidfile "$JENKINS_PID_FILE" $JAVA_CMD $PARAMS > /dev/null
  echo "WARNING: RUNNING AS ROOT"
  daemon --user root --pidfile "$JENKINS_PID_FILE" $JAVA_CMD $PARAMS > /dev/null 
```

然后，当然，您必须运行：

```
service jenkins restart 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T01:13:06.777

尝试以 root 身份运行 jenkins 进程（尽管在安全方面并不理想），它应该以同一用户的身份生成 maven 进程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T06:06:50.513

当您通过 Jenkins maven 插件运行 maven 时，它会在 jenkins 的进程中执行。运行服务器是根是一个坏主意。您可以尝试将插件作为 shell 命令运行：

```
sudo mvn org.apache.maven.plugins:maven-dependency-plugin:2.4:get -DartifactId=... 
```

另请参阅： [https ://superuser.com/questions/67765/sudo-with-password-in-one-command-line](https://superuser.com/questions/67765/sudo-with-password-in-one-command-line)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-02-28T07:03:09.107

我对使用 jenkins 运行 root 的建议是在 jenkins 上编译一个二进制文件并给它 suid 位，以便它可以由 jenkins 用户启动但以 root 身份执行。例如，我写了一个 C 文件：

```
#include <stdio.h>
#include <stdlib.h>

int main(){
    system("whoami");
} 
```

编译它（作为根）

```
# gcc -c iamroot.c
# gcc -o iamroot iamroot.o 
```

并给它一点

```
# chmod u+s iamroot 
```

然后您获得（与任何其他用户一样）

```
$ ./iamroot
root 
```

现在这可以由 jenkins 用户运行，并声明它是 root。在安全性方面，它比给 jenkins 用户 root 或 sudo 权限要好得多。

# .net - 如何在页面加载时设置 GlobalizationSection.Culture？

> ID：15124666
> 
> 赞同：1
> 
> 时间：2013-02-27T23:33:41.250
> 
> 标签：.net

我有一个网页，我想在其上显示日期，根据用户定义的文化代码动态。

我可以像下面这样设置我的 web.config 来实现我想要的：

```
<system.web>
  <globalization culture="fr-CA"/>
</system.web> 
```

但是，我希望这是用户定义的，所以当他们登录时它会自动更改。

知道我该怎么做吗？

# video-streaming - 显示 Live555 RTSP 流

> ID：15124670
> 
> 赞同：0
> 
> 时间：2013-02-27T23:33:53.097
> 
> 标签：video-streaming, rtsp, live555

我正在为桌面（C++）开发一个 RTSP 客户端。我现在了解了库[live555](http://www.live555.com)的操作，并且可以使用示例“testRTSPClient”接收帧。现在我想在屏幕上显示视频。如何将接收到的数据转换为图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-27T08:00:16.490

您将需要使用编解码器将流式（压缩/编码）格式转换为您可以在屏幕上绘制的格式。我建议使用 FFMPEG (libavcodec)，有几个示例说明如何使用 FFMPEG 创建媒体播放器。

# asp.net - 向客户端发送大量 Excel 报表数据

> ID：15124676
> 
> 赞同：0
> 
> 时间：2013-02-27T23:34:28.730
> 
> 标签：asp.net

MS VS 2008，ASP.Net 3.5。在客户端：客户端选择开始和结束日期，报表格式为 Excel，单击“运行报表”按钮在单击重定向到 reportToExcel.aspx 时，在 Page_Load 事件存储过程中的 reportToExcel.aspx.vb 中执行以检索报表数据：

```
oSQLDataReader = oSqlCommand.ExecuteReader() 
```

然后：

```
Response.ContentType = "application/ms-excel"
Response.AddHeader("Content-Disposition", "attachment; filename=" + MyBase.UserSession.ReportName + ".xls") 
```

然后 Response.Write 用于将检索到的报表数据以 XML 格式写入 Response 对象，如

```
Response.Write("<td>" & FormatColumnValue(oSQLDataReader.GetValue(I), arrColHeader(I + 1).ColumnFormat) & "</td>"), etc.  Last callis Response.End(). 
```

我知道 Response.End 不应该被使用，我打算用 is with

```
context.Response.Flush()
context.ApplicationInstance.CompleteRequest() 
```

但我怀疑它会改善响应时间。

问题：在客户端需要 6 分钟来接收 32.5 MB 的数据。这太长了。如何减少这个时间？

据我所知：Excel 报告无法进行分块，无论如何客户都希望收到一个完整的 Excel 报告。为了使用 Response.TransferFile ：必须首先创建 Excel 文件，然后压缩以减少要下载的数据量，然后再下载。为此，应在服务器上安装 Excel，这在我们的案例中是不可接受的。

将数据以 csv 格式交付给客户是不可接受的：客户必须将其导入 Excel，这是他们不喜欢的。

从 SQL 管理工作室执行的存储过程显示不一致的运行时间：从 12 秒到 4 分钟。

那么，还有其他方法可以减少向客户“交付”报告的时间吗？

谢谢大家的回复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T03:48:22.597

您确实需要降低存储过程的运行时间。但这本身就是一个完整的问题和答案。

您写出 HTML 的方法比它需要的要慢。本质上，您正在执行重复的字符串连接，这很慢。考虑在将整个文档写入响应流之前 使用[StringBuilder构建整个文档。](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)

另一种选择（也许更好）是尝试免费的 Excel Xml Writer 库之类的东西：http: [//www.carlosag.net/tools/excelxmlwriter/](http://www.carlosag.net/tools/excelxmlwriter/)。我没有使用它，但我听说过它的好东西。这将（我相信）让您在服务器上编写 Excel 文件，而无需安装 Excel 本身。

# bash - 使用 bash 分析 svn 存储库

> ID：15124678
> 
> 赞同：0
> 
> 时间：2013-02-27T23:34:40.290
> 
> 标签：bash, svn, shell, repository, increment

我正在分析软件，并在系统生命的三个不同点收集 svn。开始、中间和结束。我目前能够以我设置的任何数字收集存储库的起点，但是当存储库开始在主干中包含数据或代码时，我需要收集 svn。最好的做法是使用 while 循环，而 $ip 不包含... 删除当前 $ip 并获取 $ip+1

我在 svn_url.txt 中有 svn url，在 svn_name.txt 中有项目名称。所以我得到一个我目前收到的输出是：

```
https://ponkout.svn.sourceforge.net/svnroot/ponkout
ponkout
Checked out revision 73.
final revision is: 73
mid revision is: 36
Checked out revision 36.
Checked out revision 1.

#!/bin/bash

for i in `cat svn_url.txt`; do echo $i; done;
for j in `cat svn_name.txt`; do echo $j; done;

svn co $i $j-fp && fpInfo=`svnversion $j-fp`;
echo "final revision is: "$fpInfo;
mpInfo=$((fpInfo/2));
echo "mid revision is: "$mpInfo;
svn co -r$mpInfo $i $j-mp;
ip=$((1));
svn co -r$ip $i $j-ip; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:21:16.303

> 当存储库开始在主干中有数据或代码时，我需要收集 svn

为什么您不能简单地检索日志，从修订 1 开始并查找创建您感兴趣的路径的条目？

或者更好的是，检索那些特定路径的日志，并查看第一个条目 - 那将是它被添加的时候。

# java - 类无法解析为类型

> ID：15124684
> 
> 赞同：1
> 
> 时间：2013-02-27T23:35:03.617
> 
> 标签：java, jsp

将对象调用到 jsp 页面时出现以下错误。

```
PatientData cannot be resolved to a type 
```

我正在使用 MVC 架构，并将我的模型和控制器都导入了 jsp 页面：

```
<%@ page import="website.web.controller.*" %>
<%@ page import="website.web.model.*"%> 
```

*   Patient 是读取数据库时用于存储患者数据的患者类
*   PatientData 是一个链表，用于在读入数据库时​​存储所有 Patient
*   PatientData 类型的对象作为属性添加到 doGet 中的会话

    `request.getSession().setAttribute("data", patientData);`

这行jsp代码中的错误提示

```
<%  PatientData savedData = (PatientData)request.getSession().getAttribute("data"); %> 
```

servlet 的名称是 GetData。这在 web.xml 中映射如下：

```
<servlet>
<servlet-name>GetData</servlet-name>
<servlet-class>website.web.GetData</servlet-class>
</servlet>
<servlet-mapping>
<servlet-name>GetData</servlet-name>
<url-pattern>/Pilot_1</url-pattern>
</servlet-mapping> 
```

不知道我哪里错了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T08:39:04.513

你应该做一个完全合格的导入

```
<%@ page import="website.web.model.PatientData" %> 
```

或在 scriptlet 代码中使用完全限定的类名

```
<% website.web.model.PatientData savedData = (website.web.model.PatientData) request.getSession().getAttribute("data"); %> 
```

.

# ruby-on-rails - 注册控制器中的名称错误#create

> ID：15124689
> 
> 赞同：1
> 
> 时间：2013-02-27T23:35:19.777
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

昨天刚刚安装了设计，登录功能工作得很好，即：如果我输入了错误的密码/用户名，它会有一个闪光的味精，我可以使用正确的信息登录等等......

然而，SiGN-UP 领域并不完全相同。当我输入错误的登录凭据时，我收到以下错误：

## 注册控制器中的名称错误#create

### # 未定义的局部变量或方法“身份验证”

不确定要包含哪些其他控制器或内容，所以一旦您提出要求，我将使用它们更新 OP。

**User.rb 控制器**

```
class User < ActiveRecord::Base
  has_many :authentication

  # Include default devise modules. Others available are:
  # :token_authenticatable, :lockable, :timeoutable and :activatable
  devise :database_authenticatable, :registerable, 
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation
  # attr_accessible :title, :body

  def apply_omniauth(omniauth)
    self.email = omniauth['user_info']['email'] if email.blank?
    authentications.build(:provider => omniauth['provider'], :uid => omniauth['uid'])

  end

  def password_required?
    (authentications.empty? || !password.blank?) && super
  end
end 
```

***身份验证控制器***

```
class AuthenticationsController < ApplicationController
  def create
    omniauth = request.env["omniauth.auth"]
    authentication = Authentication.find_by_provider_and_uid(omniauth['provider'], omniauth['uid'])
    if authentication
      flash[:notice] = "Signed in successfully."
      sign_in_and_redirect(:user, authentication.user)
    elsif current_user
      current_user.authentications.create!(:provider => omniauth['provider'], :uid => omniauth['uid'])
      flash[:notice] = "Authentication successful."
      redirect_to authentications_url
    else
      user = User.new
      user.apply_omniauth(omniauth)
      if user.save
        flash[:notice] = "Signed in successfully."
        sign_in_and_redirect(:user, user)
      else
        session[:omniauth] = omniauth.except('extra')
        redirect_to new_user_registration_url
      end
    end
  end
end 
```

***全跟踪***

```
activemodel (3.2.11) lib/active_model/attribute_methods.rb:407:in `method_missing'
activerecord (3.2.11) lib/active_record/attribute_methods.rb:149:in `method_missing'
app/models/user.rb:19:in `password_required?'
activesupport (3.2.11) lib/active_support/callbacks.rb:447:in `_run__3532959459969647100__validate__3266504065108489171__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_validate_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
activemodel (3.2.11) lib/active_model/validations.rb:228:in `run_validations!'
activemodel (3.2.11) lib/active_model/validations/callbacks.rb:53:in `block in run_validations!'
activesupport (3.2.11) lib/active_support/callbacks.rb:425:in `_run__3532959459969647100__validation__3266504065108489171__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_validation_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
activemodel (3.2.11) lib/active_model/validations/callbacks.rb:53:in `run_validations!'
activemodel (3.2.11) lib/active_model/validations.rb:195:in `valid?'
activerecord (3.2.11) lib/active_record/validations.rb:69:in `valid?'
activerecord (3.2.11) lib/active_record/validations.rb:77:in `perform_validations'
activerecord (3.2.11) lib/active_record/validations.rb:50:in `save'
activerecord (3.2.11) lib/active_record/attribute_methods/dirty.rb:22:in `save'
activerecord (3.2.11) lib/active_record/transactions.rb:259:in `block (2 levels) in save'
activerecord (3.2.11) lib/active_record/transactions.rb:313:in `block in with_transaction_returning_status'
activerecord (3.2.11) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
activerecord (3.2.11) lib/active_record/transactions.rb:208:in `transaction'
activerecord (3.2.11) lib/active_record/transactions.rb:311:in `with_transaction_returning_status'
activerecord (3.2.11) lib/active_record/transactions.rb:259:in `block in save'
activerecord (3.2.11) lib/active_record/transactions.rb:270:in `rollback_active_record_state!'
activerecord (3.2.11) lib/active_record/transactions.rb:258:in `save'
devise (2.2.3) app/controllers/devise/registrations_controller.rb:15:in `create'
app/controllers/registrations_controller.rb:3:in `create'
actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.11) lib/active_support/callbacks.rb:436:in `_run__4484154356758125938__process_action__1943485731429773152__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.11) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.11) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.11) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.11) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:36:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/mapper.rb:42:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:601:in `call'
omniauth (1.1.3) lib/omniauth/strategy.rb:177:in `call!'
omniauth (1.1.3) lib/omniauth/strategy.rb:157:in `call'
omniauth (1.1.3) lib/omniauth/builder.rb:48:in `call'
warden (1.2.1) lib/warden/manager.rb:35:in `block in call'
warden (1.2.1) lib/warden/manager.rb:34:in `catch'
warden (1.2.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.5) lib/rack/etag.rb:23:in `call'
rack (1.4.5) lib/rack/conditionalget.rb:35:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.5) lib/rack/session/abstract/id.rb:210:in `context'
rack (1.4.5) lib/rack/session/abstract/id.rb:205:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/cookies.rb:341:in `call'
activerecord (3.2.11) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.11) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `_run__499975101759753584__call__3266504065108489171__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `block in call'
activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.5) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.5) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.5) lib/rack/lock.rb:15:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.11) lib/rails/engine.rb:479:in `call'
railties (3.2.11) lib/rails/application.rb:223:in `call'
rack (1.4.5) lib/rack/content_length.rb:14:in `call'
railties (3.2.11) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.5) lib/rack/handler/webrick.rb:59:in `service'
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:06:44.960

我发现了！（但愿如此）

```
has_many :authentication 
```

应该：

```
has_many :authentications 
```

为什么？因为 Rails 期望您在 has_many 和其他情况下使用复数形式的对象名称。

# google-maps-api-3 - 通过坐标模糊的 Maps API 3 方向

> ID：15124690
> 
> 赞同：2
> 
> 时间：2013-02-27T23:35:29.340
> 
> 标签：google-maps-api-3, google-directions-api

我有许多描述路线的 GPS 坐标。我的目的是沿着路线绘制一条折线，然后根据我拥有的一些数据对线段进行着色。

问题是，GPS 坐标可能出现在主要道路两侧的路边。当使用明显的 Directions 服务解决方案时，会发生很多“来回”，因为 Google 试图让我进入分车道道路的任一侧![路径不佳](../Images/59445b9ec1d7aa82915bcc8dd82723aa.png) 我的目标是从 AH 穿过每个航路点的直接路线。我考虑过将坐标反向地理编码为街道名称，并让方向使用街道作为路标，但这会选择街道上可能与实际路线无关的特定点。单折线也不是一种选择，因为某些路线有转弯。

有没有办法“模糊”我的航路点，以便在通过点的某个半径范围内时方向是快乐的？如果没有，有没有人有任何其他的解决方案？

多谢了。

编辑：不使用中间点也不是一种选择，因为有时路径不是最佳的。

现在也尝试了我自己的模糊坐标，对每个连续的 lat/lng 对 +- 一些小值。不出所料，我很快就遇到了 OVER_QUERY_LIMIT。

# ios - NSDateFormatter 缺少方法...我是否缺少导入

> ID：15124694
> 
> 赞同：2
> 
> 时间：2013-02-27T23:35:39.047
> 
> 标签：ios, objective-c, nsdateformatter

我是 IOS 新手，但我尽可能地向前迈进。

我搜索了这个网站和谷歌，但没有找到我的问题的答案，甚至没有任何相似之处。

我正在使用文档中声明的方法（我实际上是从网站上借用了这一行以获取时区偏移量（以小时为单位））：

```
NSDateFormatter *dateFormat = [[NSDateFormatter alloc] initWithDateFormat:@"zzz" allowNaturalLanguage:NO]; 
```

但是编译器错误消息说：

> 'NSDateFormatter' 没有可见的@interface 声明选择器'initWithDateFormat:allowNaturalLanguage:'

当我尝试自动完成时，它不建议使用这种特定`init`方法，只有`init`和`initWithCoder`.

我错过了一些必需的进口吗？我以为这是`Foundation.h`.

任何帮助将不胜感激。

谢谢。

杰森

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T23:53:57.003

该方法`NSDateFormatter initWithDateFormat:allowNaturalLanguage:`不是 iOS 的一部分。该方法仅适用于 Mac。对于 iOS，请执行以下操作：

```
NSDateFormatter* dateFormat = [[NSDateFormatter alloc] init];
[dateFormat setDateFormat:@"zzz"]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:56:17.167

你得到

```
No visible @interface for 'NSDateFormatter' declares the selector 'initWithDateFormat:allowNaturalLanguage:' 
```

因为 iOS 不支持这个选择器。只有 OS X。

在这篇文章中更详细地解释了： [为什么一个记录在案的 NSDateFormatter 初始化方法没有被识别？](https://stackoverflow.com/questions/2219948/why-is-a-documented-nsdateformatter-init-method-not-getting-recognized?rq=1)

Also, the Apple Developer Libraries are really helpful. NSDateFormatter Class Reference: [https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html). It states, "iOS Note: iOS supports only the 10.4+ behavior. 10.0-style methods and format strings are not available on iOS." Link to new formatters: [https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/DataFormatting.html#//apple_ref/doc/uid/10000029i](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/DataFormatting.html#//apple_ref/doc/uid/10000029i)

# delphi - 在 DWScript 中设置入口点

> ID：15124697
> 
> 赞同：3
> 
> 时间：2013-02-27T23:35:49.207
> 
> 标签：delphi, dwscript

有没有办法在 DWScript 中设置入口点？

例如，如果我开始执行脚本，我希望它执行一个过程 Main，而不是常规入口点中的代码（begin ... end.）。

我知道可以从 Delphi 执行函数，但我不确定这是否完全相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:52:14.630

除了编写你的`procedure Main();`然后让你的常规脚本入口点只包含调用之外`Main`，这可能不是你想要的，不，在 DWS 中没有办法做到这一点。

尽管在语法上进行了所有创新，DWS 仍然是 Pascal，并且仍然按照 Pascal 的工作方式工作。要求某种命名的`Main`例程将与 Pascal 风格大相径庭。

编辑：回答评论中发布的澄清：

如果你想让你的脚本产生一个新的脚本线程，你必须在外部 Delphi 代码中处理它。在撰写本文时，DWS 系统还没有内置任何多线程概念。如果您想这样做，您可以这样做：

创建一个名为`SpawnThread(EntryPoint: string)`. 它的 eval 方法（在 Native-Delphi-land 中）会产生一个新线程来加载当前脚本，然后找到具有指定名称的例程并执行它。

这是在没有语言级别支持的情况下让它工作的唯一方法。如果您想从 DWS 中生成线程，请尝试将其作为功能请求添加到[问题跟踪器](http://code.google.com/p/dwscript/issues/list)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T08:48:33.740

直接调用函数在

[https://code.google.com/p/dwscript/wiki/FirstSteps#Functions](https://code.google.com/p/dwscript/wiki/FirstSteps#Functions)

如果你想在不同的线程中执行一个函数，你需要一些 Delphi 端代码来创建一个新线程，一个新的执行，然后调用你的函数。然后，主执行和线程执行将彼此沙箱化（因此无法共享共享全局变量等）。

如果您需要在线程之间共享数据，您可以通过公开函数或外部变量来做到这一点，这将在适当的同步和锁定的情况下调用 Delphi 代码（什么是“正确的”取决于您的代码想要做什么，就像在多线程中一样......）。

请注意，可以在脚本执行之间传递对象、接口和动态数组（前提是它们是同一程序的执行），但就像使用常规代码一样，您必须明确使用锁、临界区或互斥锁。

# jquery - jQuery scrollTop 视口问题。如何向 position().top 添加自定义值

> ID：15124698
> 
> 赞同：0
> 
> 时间：2013-02-27T23:35:56.127
> 
> 标签：jquery, html, position, viewport, scrolltop

我正在开发一个单页 wordpress 网站。因为它是单页的，所以我使用 jQuery scrollTop 为菜单设置动画。当我单击带有 div id 的相应菜单链接时，我想转到特定的 div。当前的问题是固定位置的菜单选项卡正在穿过内容。它显示在 div 内容上（视口问题）。

我想在此菜单选项卡和 div 内容之间留出空隙，以使内容完全可见。

用于滚动效果的jQuery代码如下：

```
$(document).ready(function() {

    $('a[href=#welcome]').click(function(){

     $('html, body').animate({scrollTop:$('#welcome').position().top}, 'slow');

     return false;

    });

});

$(document).ready(function() {

  $('a[href=#aboutus]').click(function(){
     $('html, body').animate({scrollTop:$('#aboutus').position().top}, 'slow');

     return false;

  });

}); 
```

我需要的是在上面 div 的顶部位置“.position().top}”上添加一些值，例如 200px，以便我可以滚动到 div 顶部以下的位置...

编辑：“对不起，伙计们......我在上述要求中犯了一个错误......我必须从 div 的顶部位置减去一个值，以便我可以滚动到 div 顶部上方的位置......”

我怎样才能解决这个问题？任何帮助将不胜感激..

提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:39:40.207

可以获取菜单的高度，例如：

```
var menuHeight = $('#mainMenu').height(); 
```

当您在线滚动时：

```
$('html, body').animate({scrollTop:$('#aboutus').position().top}, 'slow'); 
```

你减去菜单高度：

```
$('html, body').animate({scrollTop:$('#aboutus').position().top-menuHeight}, 'slow'); 
```

未经测试，但我认为它应该工作。基本上，您说滚动到您的 div 位置，但滚动到该位置之前的位置，即菜单高度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:39:49.713

我不确定我是否完全理解，但您可以将 200（因为它以 px 为单位）添加到您的位置。

```
$(document).ready(function() {
  var marginTop = 200;  // add or remove or even grab the position of another element

   $('a[href=#aboutus]').click(function(){
       $('html, body').animate({scrollTop:$('#aboutus').position().top + marginTop}, 'slow');
         return false;
   });
}); 
```

# java - Java运行进程无法获得标准输出

> ID：15124701
> 
> 赞同：0
> 
> 时间：2013-02-27T23:36:10.790
> 
> 标签：java, process

我在下面有我的代码。我正在尝试运行我的 ruby​​ 脚本并获取标准，在这种情况下我真的不需要标准错误。出于某种原因，我在生产主机中根本无法获得任何输出，而且我只得到空字符串。相同的代码在我的桌面上运行良好。如果我自己运行我的 ruby​​ 脚本，我可以从中获得输出。我的 ruby​​ 脚本现在只有 puts 语句。有谁知道原因吗？是不是我需要某种块来等待 ruby​​ 脚本完成？

```
ProcessBuilder processBuilder = new ProcessBuilder();
processBuilder.command("ruby", "tests.rb");
Process process = processBuilder.start();

BufferedReader bufferReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

StringBuilder output = new StringBuilder();
String line;

while ((line = bufferReader.readLine()) != null) {
    System.out.println("Line is: " + line);
    output.append(line + "\n");
}

bufferReader.close();
return output.toString(); 
```

我有运行 zsh 的 redhat 机器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:38:37.083

您需要关闭进程的输出流（其标准输入），并且您可能应该合并输出流和错误流。你可能认为你不想要它们，但你可能错了，如果进程产生足够多的未读错误输出，它将停止。

# mysql - SQL 连接，包括表 a 中不匹配表 b 的行

> ID：15124705
> 
> 赞同：4
> 
> 时间：2013-02-27T23:36:33.300
> 
> 标签：mysql, sql, join, inner-join

```
SELECT orders.* FROM orders JOIN order_rows 
  ON orders.id = order_rows.order_id 
  WHERE order_rows.quant <> order_rows.quant_fulfilled 
  GROUP BY orders.id 
  ORDER BY orders.id DESC 
```

我需要它来包含没有相应 order_row 条目的行（这将是一个还没有项目的订单）。似乎必须有一种方法可以通过添加到 ON 或 WHERE 子句来做到这一点？

在给定时间只会有几个空订单，因此如果对此的最佳答案会显着降低性能，我将使用单独的查询。但我希望将它们包含在此查询中，以便它们按orders.id 与其余部分一起排序。只是不想将查询时间加倍，只是为了包括没有项目的 1-3 个订单。

我正在使用 MySQL。提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-27T23:41:13.680

只需使用`LEFT JOIN`而不是`JOIN`. 您将获得所有订单行。

```
SELECT orders.* FROM orders LEFT JOIN order_rows 
  ON orders.id = order_rows.order_id 
  WHERE order_rows.quant IS NULL OR order_rows.quant <> order_rows.quant_fulfilled 
  GROUP BY orders.id 
  ORDER BY orders.id DESC 
```

# highcharts - 指定类别时，highcharts 刻度位置不正确

> ID：15124709
> 
> 赞同：2
> 
> 时间：2013-02-27T23:36:39.953
> 
> 标签：highcharts, categories

请查看按预期显示的此图（即刻度位于指定位置）：

[http://jsfiddle.net/a3ZrC/3/](http://jsfiddle.net/a3ZrC/3/)

```
xAxis: {
    tickPositions: [1, 3, 4, 5, 10],
    gridLineWidth: '1',
    lineWidth: 1
    //tickPosition: 'outside'       
}, 
```

现在，如果我指定类别，刻度位置（和网格）会发生变化，它们不再出现在标签上，请参阅：

[http://jsfiddle.net/a3ZrC/4/](http://jsfiddle.net/a3ZrC/4/)

```
xAxis: {
    tickPositions: [1, 3, 4, 5, 10],
    categories: ['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve'],
    gridLineWidth: '1',
    lineWidth: 1
    //tickPosition: 'outside'       
}, 
```

这是一个错误还是我错过了什么？

干杯，

托尼。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T06:37:18.743

猜猜你在这里错过了一个技巧。您可以指定[**tickmarkPlacement**](http://api.highcharts.com/highcharts#xAxis.tickmarkPlacement)选项。

它默认为`between`. 指定它`on`以获得所需的结果。

```
xAxis: {            
        tickPositions: [1, 3, 4, 5, 10],
        categories: ['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve'],
        gridLineWidth: '1',
        lineWidth: 1,
        tickmarkPlacement: 'on'
    }, 
```

[`Fiddled`](http://jsfiddle.net/gopinaghr/a3ZrC/6/)版本。

希望这可以帮助。

# php - PHP表单未定义变量

> ID：15124713
> 
> 赞同：0
> 
> 时间：2013-02-27T23:37:05.660
> 
> 标签：php, forms

我正在使用 PDO，但我对此处未定义变量的错误感到困惑：

它与数据库连接后的变量 cat_name 相关。

我直接将值添加到变量中。它已将错误更改为：

SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 ''categories'('cat_name', 'cat_description') VALUES ('ohnoe','ohnoes')' 附近使用正确的语法

```
 <?php
    try{
    include 'database.php';
    $db =  database:: getConnection();
        $catName = "ohnoe";
        $catDesc = "ohnoes";
    if(isset($_POST['submit'])){
    if(isset($_POST['cat_name'])){
        $catName = $_POST['cat_name'];
    }
    else{
        echo "already set";
    }

    if(isset($_POST['cat_description'])){
    echo"Oh dear";
    }
    else{
    $catDesc = $_POST['cat_description'];
    }}
    $sqlQuery = ("INSERT INTO 'categories'('cat_name', 'cat_description') VALUES (:cat_name,:cat_description)");

    $statement = $db->prepare($sqlQuery);
    $statement->bindValue(":cat_name",$catName);
    $statement->bindValue(":cat_description",$catDesc);

    $count = $statement->execute();

    $db = null;
    }catch(PDOException $e){
    echo $e->getMessage();
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:44:14.120

您确定它是“未定义的变量”，而不是“未定义的索引”吗？如果您在渲染表单和处理数据的情况下都运行此脚本，那么您必须通过在任何数据处理之前放置`if ($_POST)`或更具体的方式来检查请求类型。`if (isset($_POST['cat_name']) && isset($_POST['cat_description'])`

# signalr - 客户端重新连接

> ID：15124716
> 
> 赞同：1
> 
> 时间：2013-02-27T23:37:26.400
> 
> 标签：signalr

我对（JavaScript）集线器客户端的理解是，如果连接丢失，它会进入尝试重新连接的“重新连接...”阶段。如果它不能这样做，它将进入“断开连接”状态，直到被要求重新开始为止。

~~“重新连接……”阶段在放弃之前要持续多久？我之前已经阅读了 40 秒，但我的客户似乎花费的时间要少得多——大约 10 秒，也许更少。~~[*编辑：没关系这部分，我在服务器上配置了 10 个断开连接作为测试......但忘记了。我知道这是由服务器在协商期间设置的。说得通！*] ...我宁愿让客户不断重试，直到被告知中止 - 可以这样做，会导致问题吗？

另一个问题; 在重新连接...阶段，如果我尝试调用集线器方法（再次在 JS 中），它似乎永远不会完成。我正在使用返回的 Deferred 来检查“完成”和“失败”事件，但似乎都没有被调用。这是设计使然吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:35:19.360

你绝对可以让它不断地重新连接。

处理客户端的断开连接事件并调用connection.start：

```
$.connection.hub.disconnected(function() {
   setTimeout(function() {
       $.connection.hub.start();
   }, 5000); // Re-start connection after 5 seconds
}); 
```

这会导致的唯一问题是您可能会触发对不存在客户端计算机的服务器的无限请求。当您将移动市场引入这种情况时，这变得更加麻烦（像疯了一样耗尽电池）。

当您在重新连接 SignalR 时尝试调用集线器方法时，将尝试发送您的命令。由于有 2 个通道，一个用于接收数据，一个用于发送，（适用于除 Web 套接字之外的所有传输）在某些情况下，您仍然可以在离线时发送请求。因此，在浏览器告诉它无法成功发出请求之前，SignalR 不知道请求是否失败。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-12T11:40:35.530

我可能有一个线索......触摸Web.config会产生一个appPool Recycle，这意味着将为新请求创建一个新的工作进程，而现有进程将继续一段时间，直到剩余的请求结束或达到超时。未在超时期限内结束的请求将被终止。

当长时间运行的任务在旧进程中运行时，Signalr 客户端重新连接到新进程，所以当你在长时间运行的任务上时

`GlobalHost.ConnectionManager.GetHubContext<ForceHub>();`

当客户端连接到“新”集线器时，您实际上会获得“旧”集线器的参考。这就是为什么由 Wasp 执行的测试有效的原因：他正在发出一个新请求，以在新创建的工作进程中处理的信号器集线器上发布。

您可以尝试配置一个 singalr 背板 ( [https://www.asp.net/signalr/overview/performance/scaleout-in-signalr](https://www.asp.net/signalr/overview/performance/scaleout-in-signalr) )，使用 Sql Server ( [https://www.asp. net/signalr/overview/performance/scaleout-with-sql-server](https://www.asp.net/signalr/overview/performance/scaleout-with-sql-server) )。背板应该能够连接两个工作进程，希望您能在客户端收到通知。

如果这是问题所在，即使没有背板，新请求生成的通知也会起作用。请注意，背板的真正目的是扩展信号器，即在它们之间连接一组 WebServer。

还要记住，在 IIS 中运行长时间运行的任务是难以实现的任务，除其他外，IIS 会定期执行 appPool 回收，并且对执行请求有超时限制。我建议您阅读以下帖子：[http://www.hanselman.com/blog/HowToRunBackgroundTasksInASPNET.aspx](http://www.hanselman.com/blog/HowToRunBackgroundTasksInASPNET.aspx) “如果您认为自己可以编写后台任务，那么您很可能会弄错。我不是在指责你的技能，我只是说它很微妙。另外，你为什么必须这样做？”</p>

希望这可以帮助

# objective-c - 更好地理解属性声明

> ID：15124721
> 
> 赞同：-1
> 
> 时间：2013-02-27T23:37:33.747
> 
> 标签：objective-c, types, properties

我想向您展示我的一个头文件的示例，并获得您对在以下情况下我可以做得更好的建议。

*启用 ARC*

```
@property (nonatomic, assign) int some_simple_value;
@property (nonatomic, strong) NSMutableArray *someArray;
@property (nonatomic, weak) IBOutlet UIButton *someButton;
@property (nonatomic, copy) NSMutableArray *someArrayCopy
@property BOOL some_bool; 
```

我理解很多类型的含义，但我不知道为什么在某些情况下我会使用给定的类型而不是另一种类型。另外，如果我知道我的对象只能被一个类访问，我应该不使用`nonatomic`（因为不用担心多个线程访问它，对吗？）

# 回答

这些答案极大地帮助了我：

[原子属性和非原子属性有什么区别？](https://stackoverflow.com/questions/588866/atomic-vs-nonatomic-properties)

和

[Objective-C 声明的@property 属性（非原子、复制、强、弱）](https://stackoverflow.com/questions/9859719/xcode-property-attributes-nonatomic-copy-strong-weak)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:43:10.790

好吧，您*可以*阅读文档！:) 但是如果你想要一个更友好的指导性解释，我给你写了一个：

[http://www.aeth.com/iOSBook/ch12.html#_properties_2](http://www.apeth.com/iOSBook/ch12.html#_properties_2)

但是，在阅读之前，您应该真正阅读该章前面的内存管理：

[http://www.aeth.com/iOSBook/ch12.html#_memory_management](http://www.apeth.com/iOSBook/ch12.html#_memory_management)

`strong`并且*确实非常*`weak`不同；如果您了解内存管理和 ARC，您就会知道原因。

# python - Python脚本脚本进入和退出

> ID：15124725
> 
> 赞同：0
> 
> 时间：2013-02-27T23:37:58.080
> 
> 标签：python

我正在尝试创建一个 python 脚本，单击一个按钮会打开另一个 python 脚本并关闭自身，并且第二个脚本中的一些返回函数返回到原始脚本希望你能提供帮助。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:42:04.770

由于您的问题非常模糊，因此这里有一个有点模糊的答案：

首先，想想你是否真的需要这样做。为什么第一个脚本不能`import`将第二个脚本作为一个模块并在其上调用一些函数？

但是让我们假设您对此有一个很好的答案，并且您确实需要“关闭”并运行另一个脚本，其中“关闭”的意思是“使您的 GUI 不可见”。

```
def handle_button_click(button):
    button.parent_window().hide()
    subprocess.call([sys.executable, '/path/to/other/script.py'])
    button.parent_window().show() 
```

这将隐藏窗口，运行另一个脚本，然后在另一个脚本完成后再次显示窗口。在事件处理程序中间做一些缓慢和阻塞的事情通常是一个非常糟糕的主意，但在这种情况下，因为我们无论如何都隐藏了整个 UI，所以你可以侥幸逃脱。

更智能的解决方案将涉及第二个脚本发送或观察者线程发送的某种信号。例如：

```
def run_other_script_with_gui_hidden(window):
    gui_library.do_on_main_thread(window.hide)
    subprocess.call([sys.executable, '/path/to/other/script.py'])
    gui_library.do_on_main_thread(window.show)

def handle_button_click(button):
    t = threading.Thread(target=run_other_script_with_gui_hidden)
    t.daemon = True
    t.start() 
```

显然，您必须用适合您选择的窗口库的代码替换诸如`button.window()`、`window.hide()`、等之类的东西。`gui_library.do_on_main_thread`

如果您希望第一个脚本实际退出，而第二个脚本重新启动它，您*可以*这样做，但这很棘手。您不想将第二个脚本作为子进程启动，而是作为兄弟进程启动。理想情况下，您希望它只接管您自己的流程。除非您需要在执行此操作之前关闭 GUI，除非您的操作系统会自动执行此操作（基本上，Windows 会，Unix 不会）。看看这个[`os.exec`](http://docs.python.org/2/library/os.html#os.execl)系列，但你真的需要了解这些东西在 Unix 中是如何工作的才能正确地完成它。除非您希望两个脚本紧密耦合在一起，否则您可能希望在命令行上传递第二个脚本，正确的参数来重新启动第一个脚本（基本上，`sys.argv`在任何其他参数之后传递整个脚本）。

作为替代方案，您可以使用[`execfile`](http://docs.python.org/2/library/functions.html#execfile)在现有解释器实例中运行第二个脚本，然后让`execfile`您返回第二个脚本。这与解决方案有相似但不相同的问题`exec`。

# java - 如何从 Eclipse 中的另一个项目访问现有的 SQLite 数据库

> ID：15124731
> 
> 赞同：0
> 
> 时间：2013-02-27T23:38:22.217
> 
> 标签：java, eclipse, sqlite, project

我在 Eclipse 中有 2 个项目。第一个项目从第二个项目调用一个方法，将一个对象传递给第二个项目，该对象将写入第二个项目中的现有 SQLite 数据库。但是，我收到以下错误：

```
opening db: 'tomato.db': Zugriff verweigert 
```

Zugriff verweigert 是德语，表示*访问被拒绝*。

如何允许数据库从第一个项目访问位于第二个项目中的数据库文件tomato.db？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T11:50:03.853

## ***解决方案***

我使用来自[xerial](https://bitbucket.org/xerial/sqlite-jdbc)的 sqlite-jdbc 。在他们的教程中，他们通过这一行获得了数据库连接：

```
 connection = DriverManager.getConnection("jdbc:sqlite:yourdatabasefile.db"); 
```

但是，这不适用于 Eclipse 中的另一个项目。解决方案实际上非常简单：

```
 connection = DriverManager.getConnection("jdbc:sqlite:C:\\path\\to\\your\\database\\file\\yourdatabasefile.db"); 
```

另一种解决方案是使用内存中的 sqlite 数据库，如下所示：

```
connection = DriverManager.getConnection("jdbc:sqlite::memory:"); 
```

希望这可以帮助。

# java - IllegalArgumentException：使用@JsonString 注释反序列化生成的对象

> ID：15124744
> 
> 赞同：2
> 
> 时间：2013-02-27T23:39:19.847
> 
> 标签：java, google-cloud-endpoints

Cloud Endpoints 生成的对象中的长值使用 @JsonString 进行注释。当使用 GsonFactory 反序列化这些对象时，这会导致 IllegalArgumentException。

这是堆栈跟踪：

```
Caused by: java.lang.IllegalArgumentException: number type formatted as a JSON number cannot use @JsonString annotation [key updated, field private java.lang.Long com.google.api.services.timetable.model.Lesson.updated]
    at com.google.common.base.Preconditions.checkArgument(Preconditions.java:119)
    at com.google.api.client.json.JsonParser.parseValue(JsonParser.java:599)
    at com.google.api.client.json.JsonParser.parse(JsonParser.java:350)
    at com.google.api.client.json.JsonParser.parseValue(JsonParser.java:586)
    at com.google.api.client.json.JsonParser.parse(JsonParser.java:289)
    at com.google.api.client.json.JsonParser.parse(JsonParser.java:266)
    at com.google.api.client.json.JsonFactory.fromString(JsonFactory.java:207) 
```

产生异常的示例代码：

```
GsonFactory gsonFactory = new GsonFactory();
Lesson lesson = new Lesson();
lesson.setUpdated(2);
String json = gsonFactory.toString(lesson);
gsonFactory.fromString(json, Lesson.class); 
```

原始讨论[https://groups.google.com/d/msg/endpoints-trusted-testers/-/_TKGoruZVt0J](https://groups.google.com/d/msg/endpoints-trusted-testers/-/_TKGoruZVt0J)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T01:04:26.357

发生此异常的原因是因为 Java 客户端库需要引用所有长整数（也称为字符串），因为 JavaScript 无法正确处理 64 位整数精度。存在一个已知问题，即 Python SDK 无法将 64 位整数正确序列化为字符串。我不确定你从哪里得到 JSON，确切地说，但如果它在用户代码中，你需要确保你也有正确引用的 64 位整数。

# actionscript-3 - AS3 如何从另一个 SWF 获得孩子

> ID：15124745
> 
> 赞同：1
> 
> 时间：2013-02-27T23:39:24.587
> 
> 标签：actionscript-3, get, flash, external, children

我该怎么做？我一直在使用装载机，然后尝试从那里获取孩子，但当 SWF 有 4 个孩子时，我只收到一个孩子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T08:41:16.187

尝试这个 ：

```
package
{
    import flash.display.DisplayObject;
    import flash.display.DisplayObjectContainer;
    import flash.display.Loader;
    import flash.display.LoaderInfo;
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.net.URLRequest;
    import flash.utils.getQualifiedClassName;

    public class GetChildren extends Sprite
    {
        public function GetChildren()
        {
            var l : Loader = new Loader;
            l.contentLoaderInfo.addEventListener(Event.COMPLETE, onSwfLoaded);
            l.load(new URLRequest("http://staticns.ankama.com/dofus/www//game/items/src/1223.swf"));
        }

        protected function onSwfLoaded(event:Event):void
        {
            var result : Vector.<DisplayObject> = getChildren(LoaderInfo(event.target).content as DisplayObjectContainer);
            trace("Children count : " + result.length);
        }

        private function getChildren(target : DisplayObjectContainer, inc : String = "", result : Vector.<DisplayObject> = null) : Vector.<DisplayObject> {
            if(!result)
                result = new Vector.<DisplayObject>;

            for(var i : uint = 0; i < target.numChildren; ++i)
            {
                var child : DisplayObject = target.getChildAt(i);
                result.push(child);
                displayInfo(child, inc);
                if(child is DisplayObjectContainer)
                    getChildren(child as DisplayObjectContainer, inc + "   ", result);
            }

            return result;
        }

        private function displayInfo(target : DisplayObject, inc : String = "") : void
        {
            trace(inc + target.name +" : " + target + " (" + getQualifiedClassName(target).split("::").pop() + ")");            
        }
    }
} 
```

将输出：

```
instance3 : [object Shape] (Shape)
instance4 : [object MovieClip] (MovieClip)
   instance5 : [object Shape] (Shape)
instance6 : [object MovieClip] (MovieClip)
   instance7 : [object Shape] (Shape)
instance8 : [object MovieClip] (MovieClip)
   instance9 : [object Shape] (Shape)
instance10 : [object MovieClip] (MovieClip)
   instance11 : [object Shape] (Shape)
instance12 : [object Shape] (Shape)
instance13 : [object MovieClip] (MovieClip)
   instance14 : [object Shape] (Shape)
instance15 : [object Shape] (Shape)
instance16 : [object MovieClip] (MovieClip)
   instance17 : [object Shape] (Shape)
instance18 : [object Shape] (Shape)
instance19 : [object MovieClip] (MovieClip)
   instance20 : [object Shape] (Shape)
instance21 : [object Shape] (Shape)
instance22 : [object MovieClip] (MovieClip)
   instance23 : [object Shape] (Shape)
instance24 : [object Shape] (Shape)
instance25 : [object Shape] (Shape)
Children count : 23 
```

# java - 了解对象初始化中的泛型

> ID：15124748
> 
> 赞同：4
> 
> 时间：2013-02-27T23:39:49.357
> 
> 标签：java, generics, object, initialization

我对 Java 中的泛型有一个基本问题：以下两个映射初始化有什么区别？

```
 Map<String, String> maplet1 = new HashMap<String, String>();

        Map<String, String> maplet2 = new HashMap(); 
```

我知道第一个初始化是在对象构造中指定泛型，但我不了解这样做的潜在后果，而不是后一个对象构造（maplet2）。在实践中，我总是看到代码使用 maplet1 构造，但我不明白这样做比其他方法有什么好处。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T23:45:56.980

第二个`Map`分配给原始类型并将导致编译器警告。您可以简单地使用第一个版本来消除警告。

有关更多信息，请参阅：[什么是原始类型，为什么我们不应该使用它？](https://stackoverflow.com/questions/2770321/what-is-a-raw-type-and-why-shouldnt-we-use-it)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:47:04.810

第一个是类型安全的。

[您可以使用菱形运算符](http://www.javaworld.com/community/node/7567) 来简写右侧`<>`。此运算符从赋值的左侧推断类型参数。

`Map<String, String> maplet2 = new HashMap<>();`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T23:51:29.483

让我们了解擦除的概念。在 RUNTIME`HashMap<String, String>()`和`HashMap()`用 HashMap 表示的都是一样的。

转换`HashMap<String,String>`为`HashMap`（原始类型）的过程称为擦除。

如果不使用 Generics ，您必须每次都将 Map 中的值明确地转换为 String 。

泛型的使用迫使你消除演员阵容。

如果您不使用 Generics ，未来开发人员很可能会插入另一种类型的 Object ，这将导致 `ClassCastException`

# javascript - 按高价和 az 排序

> ID：15124755
> 
> 赞同：0
> 
> 时间：2013-02-27T23:40:14.277
> 
> 标签：javascript, xml, list, sorting, dataset

有人可以指出一些 javascript 的方向，这将帮助我按高/低价或 A 到 Z 等变量对列表进行排序？像这样的东西？

我相信我们都在亚马逊、ebay 和其他商店网站上看到过这些。

当前使用 .xml 数据集

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:57:26.483

查看[如何按多个字段对对象数组进行排序？](https://stackoverflow.com/questions/6913512/how-to-sort-an-array-of-objects-by-multiple-fields)

它有多个指向其他帖子的链接，这些帖子也告诉您如何完成此操作。

祝你好运！

# php - Phil Sturgeon 的缓存库

> ID：15124760
> 
> 赞同：0
> 
> 时间：2013-02-27T23:40:38.027
> 
> 标签：php, codeigniter, caching

好的，这是他写的缓存库的链接：[https ://github.com/philsturgeon/codeigniter-cache](https://github.com/philsturgeon/codeigniter-cache)

无论如何，他的文档绝对是……含糊不清，根本没有帮助。我知道这是不言自明的......在一定程度上。

```
$this->cache->model('blog_m', 'getPosts', array($category_id, 'live'), 120); // keep for 2 minutes 
```

第三个参数是什么？这是创建缓存的原因还是创建缓存文件的原因：

```
$this->cache->write($data, 'cached-name'); 
```

如果是这样， $data 究竟应该持有什么价值？整体查询orrr...?? 如果有人可以解释如何创建缓存文件..基本上我想缓存选择一堆新闻帖子的查询..每次创建新帖子时，删除该缓存并重新缓存它显示新的新闻发布..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:47:29.280

文档似乎相当清楚。无论如何，我会尝试用更好的术语来解释它：

```
// cached model call
$this->cache->model('blog_m', 'getPosts', array($category_id, 'live'), 120); // keep for 2 minutes 
```

这会调用`getPosts`模型上的方法`blog_m`并将结果缓存 120 秒。如果您在接下来的 2 分钟内再次进行相同的调用，它将返回缓存的结果，否则它将从数据库中获取数据并更新缓存。这对于您将经常调用的模型上的方法很有用。

如果要手动添加和从缓存中获取数据，则使用：

```
// cached array or object
$this->cache->write($data, 'cached-name');
$data = $this->cache->get('cached-name'); 
```

`$data`将保存您想要缓存的任何内容。例如，如果您想缓存用户的电子邮件，以下是缓存和获取它的方式

```
$email = 'foobar@example.com';
$this->cache->write($email, 'user-email');
// to fetch
$user_email = $this->cache->get('user-email'); 
```

# c# - Win8 ComboBox IsDropDownOpen + Visibility 导致 UI 出现故障

> ID：15124761
> 
> 赞同：3
> 
> 时间：2013-02-27T23:40:39.637
> 
> 标签：c#, multithreading, xaml, microsoft-metro, windows-store-apps

我正在使用 XAML 和 C# 开发 Windows 8 应用程序。我的 ComboBox 有问题，并有一个简单的示例来演示它。

1.  将以下内容添加到布局感知页面（新 BasicPage）

    ```
    <ComboBox x:Name="comboBox1" DropDownClosed="comboBox1_DropDownClosed" Visibility="Collapsed" HorizontalAlignment="Left" Margin="179,217,0,0" Grid.Row="1" VerticalAlignment="Top" Width="998" Height="51">
        <x:String>Option 1</x:String>
        <x:String>Option 2</x:String>
        <x:String>Option 3</x:String>
    </ComboBox>
    <Button Click="Button_Click" Margin="585,130,0,416" Grid.Row="1" Height="82" Width="154">
        <Viewbox>
            <TextBlock Text="Press Me" />
        </Viewbox>
    </Button> 
    ```

2.  将此添加到页面的 CodeBehind

    ```
    private void Button_Click(object sender, RoutedEventArgs e)
    {
        comboBox1.Visibility = Windows.UI.Xaml.Visibility.Visible;
        comboBox1.IsDropDownOpen = true;
    }

    private void comboBox1_DropDownClosed(object sender, object e)
    {
        comboBox1.Visibility = Windows.UI.Xaml.Visibility.Collapsed;
    } 
    ```

**预期：** 当按钮被按下时，ComboBox 应该出现并且选项应该展开，允许用户选择一个。一旦用户选择了一个选项，ComboBox 就会消失。

**实际结果：** 按下按钮时，没有任何反应。如果再次按下该按钮，ComboBox 会出现故障状态，并且应用程序基本上没有响应。（所有输入都指向 ComboBox，它永远不会关闭。

注意：DropDownClosed 事件在 Button_Click 事件之后立即触发。删除事件处理程序不会改变任何事情，但有趣的是 DropDownClosed 事件正在触发。

**Rejected 解决方案：** 建议我在更改生效后使用`Dispatcher.RunAsync`设置。这似乎是一种竞争条件，因为它只在*某些*时候有效。**如果有办法确认 ComboBox 已呈现可见，**则将此检查添加到 RunAsync 方法可以解决问题。`IsDropDownOpen``Visibility`

 ***作为一种解决方法，我目前将 Dispatcher.RunAsync 延迟 200 毫秒，这是一个烦人的解决方法。还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:17:27.850

多么讨厌的错误，啊？

一个简单的解决方法是不使用 Visibility 属性，而是使用 Opacity。它按预期工作：

```
 <ComboBox x:Name="comboBox1" DropDownClosed="comboBox1_DropDownClosed" Opacity="0" HorizontalAlignment="Left" Margin="179,217,0,0" Grid.Row="1" VerticalAlignment="Top" Width="998" Height="51">
        <x:String>Option 1</x:String>
        <x:String>Option 2</x:String>
        <x:String>Option 3</x:String>
    </ComboBox>

    private void Button_Click(object sender, RoutedEventArgs e) {
        comboBox1.Opacity = 1;
        comboBox1.IsDropDownOpen = true;
    }

    private void comboBox1_DropDownClosed(object sender, object e) {
        comboBox1.Opacity = 0;
    } 
```

干杯!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T05:55:32.410

你是对`comboBox1`的，在尝试设置`IsDropDownOpen`. 这样做的方法是通过以下方式拨打第二个电话`Dispatcher`：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    comboBox1.Visibility = Windows.UI.Xaml.Visibility.Visible;
    Dispatcher.RunAsync(CoreDispatcherPriority.Normal, () => comboBox1.IsDropDownOpen = true);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T00:54:21.547

我已经在我的台式机和 Surface 设备上测试了以下内容，它似乎一直都在工作。它是延迟设置的一种变体`IsDropDownOpen`。我了解您可能已经尝试了一些产生竞争条件的变体。我没有看到比赛条件，所以希望它也对你有用。

```
// need this for Task
using System.Threading.Tasks;
...

// note async keyword added to function signature
async private void Button_Click(object sender, RoutedEventArgs e)
{
    comboBox1.Visibility = Windows.UI.Xaml.Visibility.Visible;
    // add small delay before opening dropdown
    await Task.Delay(1);
    comboBox1.IsDropDownOpen = true;
} 
```***

# objective-c - 为矩形添加颜色

> ID：15124764
> 
> 赞同：0
> 
> 时间：2013-02-27T23:40:59.170
> 
> 标签：objective-c, c, ipad, quartz-graphics

我想用填充颜色制作一个圆圈。这是我的代码：

```
 context = UIGraphicsGetCurrentContext();
    CGContextSetLineWidth(context, 2.0);
    CGContextSetRGBStrokeColor(context, 0, 34, 102, 1);
    CGContextSetRGBFillColor(context, 135, 206, 250, 0.5);
    rectangle = CGRectMake(1, 1, 500, 500);
    CGContextAddArc(context, pointWhereUserClickedX, pointWhereUserClickedY, 50, 0, 2*3.14159265359, YES);
    CGContextDrawPath(context, kCGPathFillStroke); 
```

当我运行它时，填充颜色是白色的，即使我已经填充了蓝色。当我想在两个“塔”矩形后面添加一个背景矩形时，我遇到了同样的问题：

```
context = UIGraphicsGetCurrentContext();

//Background styling
CGContextSetRGBFillColor(context, 202, 255, 112, 1);

//Background setup
background = CGRectMake(1, 1, 1024, 786);               
CGContextAddRect(context, background);
CGContextDrawPath(context, kCGPathFill);

//Styling
CGContextSetLineWidth(context, 2.0);
CGContextSetRGBStrokeColor(context, 0, 0, 225, 1);
CGContextSetRGBFillColor(context, 0, 0, 225, 1);

//first tower setup
firstTower = CGRectMake(20, 20, 25, 100);
CGContextAddRect(context, firstTower);

//second tower setup
secondTower = CGRectMake(20, 800, 25, 100);
CGContextAddRect(context, secondTower);

//Draw towers
CGContextDrawPath(context, kCGPathFillStroke); 
```

当我添加背景颜色时，我仍然看不到任何变化。它只是白色的，所以我想这与圆圈的问题相同。第二个塔也根本没有显示。

怎么了？或者我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:48:55.527

Quartz 命令要求颜色参数在 0 和 1（浮点数）的范围内。这里的这一行（与它类似的其他行）：

`CGContextSetRGBFillColor(context, 135, 206, 250, 0.5);`

实际上应该是：

`CGContextSetRGBFillColor(context, 135.0/255.0, 206.0/255.0, 250.0/255.0, 0.5);`

# numpy - 补充过滤器代码不起作用

> ID：15124767
> 
> 赞同：2
> 
> 时间：2013-02-27T23:41:19.217
> 
> 标签：numpy, python-2.7

我挠头太久了。

数据来自 3D 加速度计和 3D 陀螺仪。我正在使用互补滤波器来控制漂移。

我让它在 excel 中工作，但似乎无法让这个 python 代码做同样的事情：

```
r1_angle_cfx = np.zeros(len(r1_angle_ax))
r1_angle_cfx[0] = r1_angle_ax[0]

for i in xrange(len(r1_angle_ax)-1):
        j = i + 1
        r1_angle_cfx[j] = 0.98 *(r1_angle_cfx[i] + r1_alpha_x[j]*fs) + (0.02 * r1_angle_ax[j])    #complementary filter 
```

在 excel（正确）中，我得到：

[![图1](../Images/8ba755b9ae87cb37fae5037ff41d2189.png)](https://i.stack.imgur.com/WcoL7.png)

在python（不正确）中，我得到：

[![图2](../Images/543f11e08b86ddb580d166fbd39b4174.png)](https://i.stack.imgur.com/TQg5r.png)

出了什么问题？有没有更好的方法在 python 中做到这一点？

谢谢，斯科特

编辑：链接到数据文件 - [示例数据](https://www.dropbox.com/sh/408k5mgt5uzxkrt/AAConhbc8ZMJk_Ec2vgsa-5ta) 1\. csv 文件包含输入到过滤器公式中的加速度计、陀螺仪数据以及在 excel 中计算的那些值。2\. excel 文件包含所有原始数据（上面没有提到的步骤，但我已经三重检查，并且相当于输入过滤器公式的点）。

编辑 2：更新 - 结果我的代码有效。这是草率的调试。fs 应为 fs = 0.01。在我的代码中，我有 fs = 1/100 最终在脚本中 = 0 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:43:45.337

你的 Python 代码看起来很合理。如果没有示例数据，我只能这么说。

但我能猜到。我查找了“互补过滤器”并找到了一个解释它们的链接：

[https://sites.google.com/site/myimuestimationexperience/filters/complementary-filter](https://sites.google.com/site/myimuestimationexperience/filters/complementary-filter)

此链接提供了一个与您的非常相似的示例方程：

```
angle = (1-alpha)*(angle + gyro * dt) + (alpha)*(acc) 
```

你有`fs`这个有的地方`dt`，并且`dt`被计算为`1/sampling_frequency`。如果`fs`是采样频率，也许你应该尝试反转它？

编辑：好的，既然你发布了数据，我就玩弄这个。这是我得到正确结果的程序。

您的代码看起来基本正确，所以我认为您在收集值的代码中一定犯了一个错误。我不太确定，因为你的变量名让我感到困惑。

我使用 a`namedtuple`和作为名称，我使用了 CSV 文件中的列标题（删除了空格和句点以生成有效的 Python 标识符）。

```
import collections as coll
import csv
import matplotlib.pyplot as plt
import numpy as np
import sys

fs = 100.0
dt = 1.0/fs
alpha = 0.02

Sample = coll.namedtuple("Sample",
    "accZ accY accX rotZ rotY rotX r acc_angZ acc_angY acc_angX cfZ cfY cfX")

def samples_from_file(fname):
    with open(fname) as f:
        next(f)  # discard header row
        csv_reader = csv.reader(f, dialect='excel')

        for i, row in enumerate(csv_reader, 1):
            try:
                values = [float(x) for x in row]
                yield Sample(*values)
            except Exception:
                lst = list(row)
                print("Bad line %d: len %d '%s'" % (i, len(lst), str(lst)))

samples = list(samples_from_file("data.csv"))

cfx = np.zeros(len(samples))

# Excel formula: =R12
cfx[0] = samples[0].acc_angX
# Excel formula: =0.98*(U12+N13*0.01)+0.02*R13
# Excel: U is cfX  N is rotX  R is acc_angX
for i, s in enumerate(samples[1:], 1):
    cfx[i] = (1.0 - alpha) * (cfx[i-1] + s.rotX*dt) + (alpha * s.acc_angX)

check_line = [s.cfX - cf for s, cf in zip(samples, cfx)]

plt.figure(1)
plt.plot(check_line)
plt.plot(cfx)
plt.show() 
```

`check_line``cfX`是CSV 文件中保存的值与新计算值之间的差异`cfx`。正如你在图中看到的，这是一条 0 处的直线，所以我的计算与你的非常吻合。

所以我猜名字的映射是：

```
your_name       my_name
________________________
r1_angle_cfx    cfx
r1_alpha_x      rotX
r1_angle_ax     acc_angX 
```

# svn - 合并时乌龟 SVN 错误

> ID：15124768
> 
> 赞同：2
> 
> 时间：2013-02-27T23:41:31.323
> 
> 标签：svn, tortoisesvn

我正在尝试将两个分支与 Tortoise SVN 合并，并在测试模式和实际合并中都出现错误。错误是：

```
Command: Merging from svn://[IP Address]/Folder1, revision HEAD to svn://[IP Address]/Folder2, revision HEAD into C:\code\Folder2, respecting ancestry, Test Only  
Error: Unable to connect to a repository at URL  
Error:  'svn://[IP Address]/Folder1'  
Error: Network connection closed unexpectedly  
Completed!: 
```

搜索这个，我发现了很多关于 SVN+SSH 与 PuTTY 冲突的信息，但这不是我的问题，因为我什至没有在这台机器上安装 PuTTY。我可以签出、签入、浏览并通常使用这两个分支，它唯一的合并给我这个错误，我在网上找不到任何对我有帮助的东西。此外，我尝试删除并重新安装，并回退了几个版本，但没有运气修复它。有谁知道为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T17:39:44.643

当 Tortoise 进行合并时，如果您将修订框留空，它将仅使用 mergeinfo 属性来确定要合并的修订。因此，您“取消阻止”修订，只需明确合并该修订即可。Tortoise 不会在日志中列出已经合并的修订。

Tortoise 可能会再次在 mergeinfo 中记录合并，因此请稍后查看目录的 svn 属性以查看它是否这样做（并编辑额外的条目 - 虽然我认为服务器会这样做，但有时手动更容易） .

另一种方法是查看 mergeinfo 属性并查看此修订是否已列出，如果已列出，请将其删除并提交。然后重复合并，它应该可以按预期工作。

目的地通常有合并信息，但我猜在你的情况下，分支也有一些可能会阻止合并。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:41:26.743

很久以前，当我从虚拟机运行 SVN 时，我遇到了类似的问题。经过一些测试和错误后，我发现问题出在 IP 地址上。因此，我开始使用服务器的名称，而不是使用服务器的 IP 地址。我不知道为什么，但这解决了我的问题。

另外，请确保您已更新您的 SVN 客户端。此外，如果您遇到相同的错误，您应该尝试另一个 SVN 客户端来查看。

您可以使用 Tortoise 在存储库中运行 CLEAN。我发现的大多数错误都可以通过简单地运行 CLEAN 命令来解决。

最后一个提示：尝试在另一台机器上运行该命令，禁用防火墙和防病毒软件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T23:09:43.620

合并时，您需要对要合并到的位置进行干净的结帐。*然后，您从*工作目录中合并合并的 URL 。

幸运的是，TortoiseSVN 有 Subversion 命令行客户端，`svn`命令。每当您遇到问题时，我建议您使用命令行客户端进行尝试，因为它通常会显示错误可能在哪里。

您可能必须将`PATH`命令行客户端放在您的 PATH 环境变量中，但它应该在`C:\Program Files\TortoiseSVN\bin`目录下（或安装 TortoiseSVN 的位置）。

在命令行上试试这个：

```
C> cd %TO_YOUR_DIRECTORY%
C> svn st   <==== You should see nothing under here. No 'M'odified files. No 'A'dded files.
C> svn up   <==== Make sure your working directory is completely up to date. 
```

您应该会看到一个完全干净且最新的工作目录。如果有任何状态问题，请先解决它们。或者更好的是，做一个新的干净结帐：

```
C> svn co svn://url/Folder1      <=== Merging to here 
```

一旦您对所有内容都感到满意，请从命令行进行合并。

```
C> svn merge svn://url/Folder2   <=== This is where you're merging from. 
```

这将使您更好地了解正在发生的事情。我喜欢 TortoiseSVN，但有时便利性和易用性会妨碍我。

顺便说一下，`svn help merge`查看所有各种命令行参数。首先尝试它，以确保您不会遇到与上次相同的错误，一旦您验证了这一点，您就可以执行 a`svn revert -R .`然后再试一次。

# ios - 从 ios 媒体库中检索元信息的最快方法？

> ID：15124771
> 
> 赞同：2
> 
> 时间：2013-02-27T23:41:39.713
> 
> 标签：ios, objective-c

我正在尝试从 ios 媒体库中检索元信息，然后以 json 格式将其发送到服务器。

但是，我发现循环 MPMediaQuery 结果并拉取元信息非常慢。

```
MPMediaQuery *query = [[MPMediaQuery alloc]init];
MPMediaPropertyPredicate *predicate = [MPMediaPropertyPredicate predicateWithValue:[NSNumber numberWithInteger:MPMediaTypeMusic] forProperty:MPMediaItemPropertyMediaType];
[query addFilterPredicate:predicate];

NSMutableArray *songs = [[NSMutableArray alloc] init];
songs = [query items];

[songs enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    [obj valueForProperty:MPMediaItemPropertyTitle];
    [obj valueForProperty:MPMediaItemPropertyPlaybackDuration];
    [obj valueForProperty:MPMediaItemPropertyArtist];
    [obj valueForProperty:MPMediaItemPropertyAlbumTitle];
    [obj valueForProperty:MPMediaItemPropertyGenre];
    [obj valueForProperty:MPMediaItemPropertyAlbumTrackNumber];
}]; 
```

对于 9000 首歌曲的库，完成枚举循环可能需要 25 秒以上的时间。

有没有更快的方法来批量检索元信息？在这种情况下，ValueForProperty 似乎效率很低（循环中的每个调用都会增加大约 5 秒）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T00:18:16.103

`MPMediaItem`说明 using通常`enumerateValuesForProperties:usingBlock:`比单独调用`valueForProperty:`. 试试这个：

```
NSSet *properties = [NSSet setWithArray:@[ MPMediaItemPropertyTitle, MPMediaItemPropertyPlaybackDuration, MPMediaItemPropertyArtist,  MPMediaItemPropertyAlbumTitle, MPMediaItemPropertyGenre, MPMediaItemPropertyAlbumTrackNumber ]];

[songs enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    MPMediaItem *item = (MPMediaItem *)obj;
    [item enumerateValuesForProperties:properties usingBlock:^(NSString *property, id value, BOOL *stop) {
        // do something with this property / value pair
    }];
}]; 
```

# selenium - Selenium 2 Firefox 配置文件更改位置

> ID：15124772
> 
> 赞同：3
> 
> 时间：2013-02-27T23:41:40.443
> 
> 标签：selenium, selenium-webdriver, selenium-grid, selenium-firefoxdriver, remotewebdriver

几个星期以来，我一直在环顾四周，但没有看到任何有关更改 Firefox 配置文件保存位置的信息。

我正在使用特定的 Firefox 配置文件，但是，当测试运行时，会话是在 /tmp/ 中创建的。我希望会话在不同的位置启动，并将它使用的文件保存在如下位置：/var/tmp/。有没有办法做到这一点？

注意：这不是关于我在哪里让 RemoteWebDriver 使用特定 Firefox 配置文件的问题。

编辑：我正在使用 Selenium 2.28 和 Firefox 15.0.1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T12:46:19.153

看着[`FirefoxProfile:442`](http://code.google.com/p/selenium/source/browse/java/client/src/org/openqa/selenium/firefox/FirefoxProfile.java#442)

```
File profileDir = TemporaryFilesystem.getDefaultTmpFS()
          .createTempDir("anonymous", "webdriver-profile");
copyModel(model, profileDir); 
```

[`TemporaryFilesystem`](http://selenium.googlecode.com/git/docs/api/java/org/openqa/selenium/io/TemporaryFilesystem.html)它的[位置来自`"java.io.tmpdir"`:](http://code.google.com/p/selenium/source/browse/java/client/src/org/openqa/selenium/io/TemporaryFilesystem.java#40)，通常指向系统的临时目录。由于这条线，Santoshsarma 的解决方案将起作用（但它也会移动您的操作系统临时目录）。

```
private static File sysTemp = new File(System.getProperty("java.io.tmpdir")); 
```

我们可以做得更多！看[*公共*](http://selenium.googlecode.com/git/docs/api/java/org/openqa/selenium/io/TemporaryFilesystem.html#setTemporaryDirectory%28java.io.File%29)方法[`setTemporaryDirectory`](http://code.google.com/p/selenium/source/browse/java/client/src/org/openqa/selenium/io/TemporaryFilesystem.java#47)！

您可以在实例化之前调用此方法`FirefoxDriver`，它应该在您指定的位置创建它的配置文件副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T08:29:57.403

**Firefox 使用操作系统临时文件位置来存储临时文件**

如果您想为临时文件使用其他位置，则需要在 Windows 的控制面板中更改临时文件的位置。

您可以更改 %TEMP% 和 %TMP% 环境变量并使它们指向您要使用的临时文件夹。

```
Control Panel > System > Advanced > Environment variables 
```

参考：[火狐支持](http://support.mozilla.org/en-US/questions)

# php - 突出显示搜索结果 - 整个表达式和单个单词

> ID：15124773
> 
> 赞同：0
> 
> 时间：2013-02-27T23:41:54.987
> 
> 标签：php, regex, preg-replace

我要突出显示整个表达式和单个单词

```
$text ="text text aaa bbb ccc text aaa text xxaaayy text bbb ccc text bbb cccxxx text";
$words = array('aaa bbb ccc','aaa bbb','bbb ccc','aaa','bbb','ccc');
foreach ($words as $k=>$v){
  $text = preg_replace('/(\w*?'.$v.'\w*)/i', '[b]$1[/b]', $text);
} 
```

此代码将返回：

**文本文本 [b][b]aaa[/b] [b]bbb[/b] [b]ccc[/b][/b] 文本 [b]aaa[/b] 文本 [b]xxaaayy[/b ] 文本 [b][b]bbb[/b] [b]ccc[/b][/b] 文本 [b][b]bbb[/b] [b]cccxxx[/b][/b] 文本**

如何得到这个结果：

**文本文本 [b]aaa bbb ccc[/b] 文本 [b]aaa[/b] 文本 [b]xxaaayy[/b] 文本 [b]bbb ccc[/b] 文本 [b]bbb cccxxx[/b]文本**

如何修改 preg_replace ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:51:47.243

你去：

```
<?php

$text ="text text aaa bbb ccc text aaa text xxaaayy text bbb ccc text bbb cccxxx text";
$words = array('aaa bbb ccc','aaa bbb','bbb ccc','aaa','bbb','ccc');
$text = preg_replace('/('.implode("|",$words).')/i', '[b]$1[/b]', $text);
echo $text;

?> 
```

**更新后的版本：**

```
<?php

$text ="text text aaa bbb ccc text aaa text xxaaayy text bbb ccc text bbb cccxxx text";
$words = array('aaa bbb ccc','aaa bbb','bbb ccc','aaa','bbb','ccc');
$text = preg_replace('/(\w*('.implode("|",$words).')\w*)/i', '[b]$1[/b]', $text);
echo $text;

?> 
```

# android - 将多个视图添加到 ViewPager 中的连续页面

> ID：15124775
> 
> 赞同：1
> 
> 时间：2013-02-27T23:42:15.413
> 
> 标签：android, android-layout, android-viewpager

我正在开发一个 Android 应用程序，它使用一个`ViewPager`代表餐厅菜单的小部件。每个页面都应包含多个项目选择和标题，例如：

**第 1 页：**

*肉*

*   肉类 1 价格

*   肉类2价格

*   其余的部分...

*   肉7类价格

**第2页：**

*   8型肉价格

*   9型肉价格

*鱼*

*   鱼类型 1 价格

*   鱼型 2 价格

*   其余的部分...

每一个都由一个`LinearLayout`包含名称、价格的元素表示，或者在瓷砖的情况下仅包含名称。

我想以`ViewPager`一种方式实现，如果我添加另一种类型的肉，它会在标题下方添加并将`Fish`整个菜单“向下”移动（如果有必要，最后可能会创建另一个页面）。是否可以使用 a 来实现`ViewPager`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T07:42:12.730

> 我想以一种方式实现 Viewpager，如果我添加另一种类型的肉，它会在 Fish 标题下方添加并将整个菜单“向下”移动（如果有必要，最后可能会创建另一个页面）。是否可以使用 Viewpager 来实现？

这是可能的，而且很容易制作。您需要将所有数据放在同一个列表中（以便该列表包含所有类型的项目、标题和各种食物）。该列表将根据`ViewPager`. 当您需要添加新项目时，将其插入到列表中的正确位置并调用`notifyDataSetChanged()`的`ViewPager`适配器（需要稍作更改）以刷新数据并在需要时更新页面。

我已经写了一个简单的示例来说明你可以如何做到这一点。你可以在[这里](https://github.com/luksprog/DroidPlayground/blob/master/src/com/luksprog/dp/view/ViewPagerAdapt.java)找到它，因为在这里发布有点大。它应该是不言自明的，但不要犹豫，问你是否有问题。

# css - *[class].tdwrap 电子邮件中的 css

> ID：15124777
> 
> 赞同：2
> 
> 时间：2013-02-27T23:42:24.740
> 
> 标签：css, class, html-email

我正在考虑使用 html 和 css 发送一些电子邮件，并一直在查看一些电子邮件的源代码，我在一些电子邮件的标题中发现了这种对 css 的修饰。

```
*[class].tdwrap{display: inline-block !important;}
*[class].vspacer{ margin-left: 50px; } 
```

我知道 * 通常表示“全部”，但我以前从未见过 [class] 部分，并且通过多次谷歌搜索无法找到有关它的文章。

关于这意味着什么的任何想法？

这是从 AppleMail 电子邮件的来源中获取的，也许它只是和 AppleMail 的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:46:31.113

这是[属性选择器](http://www.w3.org/TR/CSS2/selector.html#attribute-selectors)。它选择具有此属性的任何元素（无论其值如何）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:47:08.160

`[class]`是一个属性选择器，当它前面是通用选择器 ( `*`) 时，它会选择任何设置了类属性的元素，而不管属性值是什么。

从规范中了解更多关于选择器的信息：http: [//www.w3.org/TR/CSS2/selector.html](http://www.w3.org/TR/CSS2/selector.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T23:47:28.487

选择器匹配具有属性集`[class]`的任何元素（匹配任何值）。`class`它是一个标准的 CSS 属性选择器，定义在[CSS2.1](http://www.w3.org/TR/CSS21/selector)中。我认为它在这里没有任何作用，因为`.tdwrap`and`.vspacer`已经需要类属性。

选择器可以只替换为它们的类选择器。

# php - 我如何在 mysqli 中求和值

> ID：15124782
> 
> 赞同：0
> 
> 时间：2013-02-27T23:42:54.193
> 
> 标签：php, mysqli, sum

Mysql结构和日期：

```
--
-- Table structure for table `site_links`
--

CREATE TABLE IF NOT EXISTS `site_links` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `username` varchar(15) NOT NULL,
  `link_title` varchar(255) NOT NULL,
  `link_url` text NOT NULL COMMENT,
  `status` tinyint(1) NOT NULL DEFAULT '0',
  `views_count` int(11) unsigned NOT NULL DEFAULT '0',
  `unlocks_count` int(11) unsigned NOT NULL DEFAULT '0',
  `report_count` int(11) unsigned NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=74 ;

--
-- Dumping data for table `site_links`
--

INSERT INTO `site_links` (`id`, `username`, `link_title`, `link_url`, `status`, `views_count`, `unlocks_count`, `report_count`) VALUES
(56, 'john', 't1', 'http://google.com', 1, 4, 0, 0),
(57, 'john', 't2', 'http://google.com', 1, 0, 0, 0),
(58, 'james', 't3', 'http://google.com', 1, 3, 0, 0),
(59, 'dave', 't4', 'http://google.com', 1, 8, 0, 0),
(60, 'john', 't4', 'http://google.com', 1, 5, 0, 0), 
```

我需要对用户名 "john" 的 "view_count" 值求和，所以输出应该是 "9"

我试过这个

```
<?php
$dpl = $db->query("SELECT SUM(`views_count`) FROM site_links WHERE username='john'",true);

echo $dpl;
?> 
```

但它不能正常工作，我收到此错误“资源 id #92”

请问我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:45:28.820

我假设你正在使用 mysqli 或其他东西

```
<?php

$dpl = $db->query("SELECT SUM(`views_count`) as `total` FROM site_links WHERE username='john'");

$row = $dpl->fetch_assoc();

echo $row['total'];

?> 
```

# java - 拆分文本文件

> ID：15124787
> 
> 赞同：1
> 
> 时间：2013-02-27T23:43:08.587
> 
> 标签：java

首先，我是 Java 新手。

我正在尝试对用户指定的 txt 文件使用 Split() 函数。它应该使用空间拆分文件以输出字符串数组。我正在使用 JFileChooser 但我不知道如何对选定的 txt 文件执行拆分。我正在使用扫描仪来执行此操作。

请如果有人可以完成代码，由于某种原因我无法理解它：-/

到目前为止，我已经做到了：

```
 JFileChooser chooser = new JFileChooser("C:\\");
            chooser.setFileSelectionMode(JFileChooser.FILES_ONLY);

            FileNameExtensionFilter filter = new FileNameExtensionFilter(
            ".txt and .java files", "txt", "java");
            chooser.setFileFilter(filter);

            int code = chooser.showOpenDialog(null);
            if (code == JFileChooser.APPROVE_OPTION) {
            File selectedFile = chooser.getSelectedFile();
            Scanner input;
            try {
                input = new Scanner(selectedFile);

                while (input.hasNext()) {

                String[] splits = input.next().split(" ");
                } 
                } catch (FileNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } 

}
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:44:37.930

如果您需要按空格字符拆分输入，则包含一个带空格的字符串，而不是空字符串。代替

```
String[] splits = f.split(""); 
```

和

```
String[] splits = f.split(" ");  // One space 
```

正如其他人指出的那样，`f`未在您的块中声明。您必须将其声明为 a`String`并使用您`Scanner`将输入读入`f`，*然后*使用`split`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:45:58.890

```
f.split(""); 
```

或者

```
f.split("[\\s]+"); 
```

使用制表符和双空格确保安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:46:46.503

是什么`f`？它没有在任何地方声明，除非在之前使用过之后作为异常声明，这是没有意义的。

你的 while 循环应该这样写：

```
while (input.hasNextLine()) {

    String line = input.nextLine();
    String[] splits = line.split(" ");
    // put the result of split somewhere
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T23:47:04.210

```
 while (input.hasNext()) {

        String[] splits = f.split("");

        input.next();
    }

    System.out.println(f); 
```

首先，`splits`从来没有使用过。其次，`input.next()`永远不会存储在变量中。另外，我不知道是什么`f`。尝试这样的事情：

```
 while (input.hasNext()) {

        String[] splits = input.next().split(" ");
        someList.add(splits);

    } 
```

您可以声明`someList`为`new ArrayList<String[]>()`.

# c++ - 从文本文件c ++获取信息的问题

> ID：15124788
> 
> 赞同：0
> 
> 时间：2013-02-27T23:43:09.617
> 
> 标签：c++

我对 C++ 比较陌生，并且一直无法从文本文件中获取输入。

相关代码：

```
vector<string> nutrientName;
vector<float> nutrientAmount;
vector<string> nutrientUnits;
vector<float> nutrientCalories;

ifstream nutrientFile;
nutrientFile.open(nutrientFileName);
float newAmount = 0;
string newUnit;
float newCalories = 0;

while (!nutrientFile.eof())
{
    int place = 0;
    char nameArray [50];

   while(c != ';')
    {
        if (c != '\n')
            nameArray[place] = c;

        c = nutrientFile.get();
        place++;
    }

    string newName(nameArray, place);
    nutrientName.push_back(newName);

    nutrientFile >> newAmount;
    nutrientAmount.push_back(newAmount);

    nutrientFile >> newUnit;
    nutrientUnits.push_back(newUnit);

    nutrientFile >> newCalories;
    nutrientCalories.push_back(newCalories);

}

nutrientFile.close(); 
```

输入是一个成分列表和一些关于它们的营养成分，如下所示：

成分1（1+字）；amountOfUnitsInServingSize(float) unitType(1 word)caloriesPerServing(float) Ingredient2(1+ words); amountOfUnitsInServingSize(float) unitType(1 word)caloriesPerServing(float)

.

.

.

我的问题是，当我尝试从文件中引入内容时，它会卡在任一 while 循环中（如果内部循环被注释掉）。当我投入调试代码时，它表明它实际上没有从文件中获取任何输入。

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:39:29.673

有2或3个问题。

**看评论：**

```
while (nutrientFile.good() == true)   // use good() its more safe with your implementation
{
      int  place = 0;
      char nameArray [50];
      char c;                         // not defined    

      c = nutrientFile.get();         // was not init
      while (c != ';')
      {
             if (c != '\n')
                  nameArray[place] = c;
             c = nutrientFile.get();
             place++;
      }
      string newName(nameArray, place);
      nutrientName.push_back(newName);
      nutrientFile >> newAmount;
      nutrientAmount.push_back(newAmount);
      nutrientFile >> newUnit;
      nutrientUnits.push_back(newUnit);
      nutrientFile >> newCalories;
      nutrientCalories.push_back(newCalories);
} 
```

祝你好运 ;）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:15:01.073

还要检查内部 while 循环上的 eof。

# javascript - 在javascript中仅连接二维数组的一个元素

> ID：15124803
> 
> 赞同：2
> 
> 时间：2013-02-27T23:45:08.270
> 
> 标签：javascript

我是 javascript 新手，所以这个问题可能是非常基本的..

我有一个这样的列表：

```
[ ["word",number],["word2",number2]......] 
```

我想得到一个字符串

```
concat_str = "word\nword1\n....." 
```

我看到对于一维数组有这个连接..

```
 array.join() 
```

方法..

但是我如何只为二维数组的一个元素执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:49:33.290

您想要做的事情没有简单的功能，因为您想要的更具体一点：您希望连接每个数组的特定元素。不过也不算太难：

```
array.reduce(function (prev, cur) {
    return prev += cur[0] + "\n";
}, '').trim(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:48:20.793

```
var str = '';
for (var x = 0; x < arr.length; x++) {
    str += arr[x].join('') + "\n";
} 
```

# jquery - JQuery拖放到iframe内的可排序DIV

> ID：15124804
> 
> 赞同：1
> 
> 时间：2013-02-27T23:45:12.643
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable, jquery-ui-draggable

情况是这样的：我有可拖动的元素，需要将它们连接到 iframe 内的可排序 DIV。

编码：

**page.html**

```
<div id="draggable">
    <div>a</div>
    <div>b</div>
</div>

<iframe id="iframe" src="iframe.html"></iframe> 
```

**iframe.html**

```
<div id="sortable">
    <div>Element 1</div>
    <div>Element 2</div>
</div> 
```

不幸的是我不能改变结构，我真的需要使用 iframe。我正在尝试遵循此示例：

[http://jqueryui.com/draggable/#sortable](http://jqueryui.com/draggable/#sortable)

但是目标在 iFrame 中是可排序的，我无法使示例适应这种情况。如果有人在 jsfiddle 中有任何演示或任何可能对我有帮助的建议，我将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T12:34:04.870

[仅在 iframe 中放置元素，否则还原](https://stackoverflow.com/questions/15320455/drop-elements-inside-iframe-only-else-revert)

检查上面的链接...我已经设法拖放，但可放置区域有一点问题。

# ruby-on-rails - Rails 3：如何将代码从视图移动到控制器（或模型）？

> ID：15124806
> 
> 赞同：0
> 
> 时间：2013-02-27T23:45:15.793
> 
> 标签：ruby-on-rails

我认为这是`index`：

```
<% @submissions.each do |submission| %>
    <tr>
        <td><%= submission.id %></td>
        <td><%= User.find_by_id(submission.user_id).name.to_s %></td>
    </tr>
<% end %> 
```

我知道我不应该`find_by`在视图中使用。

如何将其移至控制器（或模型）？

我试图将它插入到`index`我的`submission`控制器的方法中并使用`username`变量，但它不起作用。

```
def index
    @submissions = Submission.all
    @submissions.each do |submission|
      username = User.find_by_id(submission.user_id).name.to_s
    end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:54:25.200

模型，添加与用户的关系

```
class Submission
  belongs_to :user
end 
```

控制器，渴望加载用户以避免 N+1 查询。

```
def index
  @submissions = Submission.includes(:user).all
end 
```

查看，只需从每次提交中投射用户

```
<% @submissions.each do |submission| %>
    <tr>
        <td><%= submission.id %></td>
        <td><%= submission.user.name.to_s %></td>
    </tr>
<% end %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:51:46.127

```
#in controller
def index
  @submissions = Submission.all
end

#in view
<% @submissions.each do |submission| %>
    <tr>
        <td><%= submission.id %></td>
        <td><%= submission.user.name %></td>
    </tr>
<% end %> 
```

此代码意味着您已声明以下关系：

*   提交`belongs_to :user`
*   用户`has_many :submissions`（或 has_one）

您可以使用预先加载（使用较少的数据库查询）来改进之前的代码：

```
@submissions = Submission.includes(:user).all 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T23:47:35.513

您可以使用 ActiveRecord 关联：

```
class Submission
  belongs_to :user

  # etc
end 
```

那么在你看来：

```
<td><%= submission.id %></td>
<td><%= submission.user.first_name</td> <!-- or whatever --> 
```

# javascript - Javascript中的按位检查

> ID：15124808
> 
> 赞同：0
> 
> 时间：2013-02-27T23:45:28.610
> 
> 标签：javascript, jquery, ajax

我玩一个游戏，在数据库中我们将 100663296 设置为 GM 领导者，但数据库中的这个字段也被写入不同的东西，所以它将该数字更改为 100794368 我被告知可以使用 a`bit-wise check`来检查第一个数字与第二个数字相同，我已经用谷歌搜索过使用`bit-wise checks`但对我的支票使用什么感到困惑。

以下是其他一些变化的数字，包括上面的数字。

```
predefined number   new changed number/ever changing number.
100663296       =       100794368
67108864        =       67239936
117440512       =       2231767040 
```

那么我应该如何检查这些数字呢？

这是我在注意到数字变化之前使用的代码的一部分。

```
if (playerData[i].nameflags == 67108864) 
{ 
    playerRows += '<img src ="icons/GM-Icon.png" alt="GM" title="GM"></img>';
} 
```

谢谢Bergi，以获得答案。

```
 if (playerData[i].nameflags & 0x400000 /* === 0x400000 */) 
```

这个接缝很好用。

也感谢 vr1911428 和其他所有人的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:41:00.807

因此，让我们将这些数字转换为二进制表示（无符号整数）：

```
> 100663296
00000110000000000000000000000000
> 100794368
00000110000000100000000000000000
> 67108864
00000100000000000000000000000000
> 67239936
00000100000000100000000000000000
> 117440512
00000111000000000000000000000000
> 2231767040
10000101000001100001000000000000 
```

请注意，最后一个数字超出了[JavaScript 按位算术](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Bitwise_Operators)的范围，它仅适用于 32 位有*符号*整数 - 您将无法使用最左边的位。

那么你现在想比较哪些位？有很多可能性，上面的方案没有说清楚，但看起来你正在寻找右边的第 27 位（2 ^(26) = 67108864）。要匹配它，您可以应用二进制 AND 位掩码：

```
x & Math.pow(2, 26) 
```

它应该再次评估为 2 ^(26)或为零 - 所以你可以检查真实性。顺便说一句，`pow`您可以使用十六进制表示法而不是使用：`0x4000000`. 这样，您的情况将如下所示：

```
if (playerData[i].nameflags & 0x400000 /* === 0x400000 */) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T03:17:59.873

如果你需要检查两个整数的完全按位相等，你只需要'=='运算符，但要使用它，你应该保证两个操作数都是整数：

```
left = 12323;
right = 12323;
if (left == right)
   alert("Operands are binary equal; I'll guarantee that. :-)"); 
```

不过要非常小心；如果至少有一个操作数是表示数字的字符串，而不是数字，则这两个操作数都将被视为字符串，您可能会得到令人困惑的结果：

```
left = "012323";
right = 12323;
if (left != right)
   alert("Operands are not equal, even though they represent 'equal values', as they     are compared as strings."); 
```

总的来说，这些天来，试图用表示数据的字符串而不是数据本身来操作是对初学者的真正诅咒。很难向他们解释。在 JavaScript 中尤其难以解释，其松散类型的类型概念本身就是非常复杂且难以理解的，背后是虚幻的简单。

最后，如果您需要比较单独的位（并且，根据您的问题，我认为不需要），您可以使用二元运算符：
[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Bitwise_Operators](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Bitwise_Operators)
基本上就是这样。.....................

# google-fusion-tables - 合并的 Google Fusion Tables - 在合并键错误时选择带有 WHERE 子句的查询

> ID：15124812
> 
> 赞同：0
> 
> 时间：2013-02-27T23:45:46.700
> 
> 标签：google-fusion-tables

我在键“PID”上将两个融合表合并在一起。现在我想做一个 SELECT 查询 WHERE PID = "value'。错误回来了，表中不存在名为 PID 的列。对另一列的查询给出了这个结果：

```
"kind": "fusiontables#sqlresponse",
 "columns": [
  "\ufeffPID",
  "Address",
  "City",
  "Zoning"
 ],
 "rows": [
  [
   "001-374-079",
   "# LOT 15 MYSTERY BEACH RD",
   "No_City_Value",
   "R-1"
  ], 
```

似乎列名已从“PID”更改为“\ufeffPID”，无论尝试多少次尝试获取读取 GET Url 的语法，我都会不断收到错误消息。

查询合并表的键有什么限制吗？由于我似乎无法为该列获取正确的名称，因此解决方法是使用 Column ID 但这似乎也不是一个选项。这是网址：

[https://www.googleapis.com/fusiontables/v1/query?sql=SELECT](https://www.googleapis.com/fusiontables/v1/query?sql=SELECT) '﻿PID','Address','City','Zoning' FROM 1JanYNl3T45kFFxqAmGS0BRgkopj4AS207qnLVQI WHERE '\ufeffPID' = 001-493-078&key=myKey

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:15:02.533

我没有解释那里的 \ufeff ；那是 Unicode 字符“零宽度无间隔”，因此可以想象它实际上存在于列名中，因为它在 UI 中是不可见的。因此，首先我建议更改基表中的名称，看看是否可行。

合并表的列 ID 具有与基表不同的形式。获取它们的一种简单方法是将感兴趣的过滤器添加到您的一个选项卡（任何类型都可以），然后执行“工具”>“发布”。顶部文本（“在电子邮件或 IM 中发送链接”）有一个包含您需要的查询 URL。通过 URL 解码器（例如[http://meyerweb.com/eric/tools/dencoder/](http://meyerweb.com/eric/tools/dencoder/) ）运行它，您将看到 PID 的列 ID 为 col0>>0。

杆

# emacs - Emacs 键绑定在自定义主模式下不起作用

> ID：15124824
> 
> 赞同：6
> 
> 时间：2013-02-27T23:47:05.740
> 
> 标签：emacs, elisp, key-bindings, major-mode

我正处于[为 Emacs 创建主要模式](https://github.com/vermiculus/sx.el)以浏览 Stack Exchange 网络并与之交互的早期阶段。

涉及到几种主要模式，都具有类似于`dired`. 我查看了 的来源`dired`，并提取了我认为可行的内容：

```
(defvar stack-network-mode-map
  (let ((map (make-keymap)))
    (define-key map "n"     'stack-network-next-site)
    (define-key map "p"     'stack-network-previous-site)
    (define-key map ","     'stack-network-move-site-up)
    (define-key map "."     'stack-network-move-site-down)
    (define-key map "j"     'stack-network-jump-to-bookmarks)
    (define-key map "\C-m"  'stack-network-do-enter-site) ; ret
    (define-key map "o"     'stack-network-do-enter-site)
    (define-key map "u"     'stack-network-do-profile-summary)
    (define-key map "\C-uu" 'stack-network-do-profile-summary-for-user)
    (define-key map "i"     'stack-network-do-inbox)
    (define-key map "b"     'stack-network-toggle-bookmark)
    (define-key map "?"     'stack-network-list-functions) ; [1]
    (define-key map "\C-i"  'stack-network-display-details) ; tab
    map)
  "Keymap for Stack Exchange: Network Browser major mode") 
```

但不幸的是，这似乎完全没有效果；像任何其他普通缓冲区一样简单地编辑缓冲区。如果不是这样，我如何实现单键键绑定？（顺便说一句，我敢肯定。这里肯定发生了其他事情。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T01:50:39.783

您想定义`stack-network-mode`using `define-derived-mode`（并使其派生自`special-mode`，例如）。

关于您的代码的其他评论：

*   使用`()`而不是`nil`空参数列表。
*   stack-network-next-site 需要`(interactive)`紧跟在文档字符串之后才能使其成为交互式命令，否则它将无法用作键绑定。

如果您不想使用`special-mode`，您可以`supress-keymap`在创建`make-keymap`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T16:26:22.230

将定义移到`stack-network-mode-map`模式定义之前。否则`define-derived-mode`隐式定义了这个变量，并且`defvar`不改变非 nil 变量的值，所以 map 实际上是空的。

请参阅[派生模式](http://www.gnu.org/software/emacs/manual/html_node/elisp/Derived-Modes.html)：

> 新模式有自己的稀疏键映射，名为 variant `-map`。`define-derived-mode`使父模式的 keymap 成为新地图的父级，除非`-map`已经设置了变体并且已经有父级。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T00:52:57.930

您已经定义了一个键盘映射，但您还没有使用它。该变量存在但不捕获任何关键事件。

```
(use-local-map stack-network-mode-map) 
```

# c++ - 文件上的 unlink() 和 remove() 有什么区别吗？

> ID：15124826
> 
> 赞同：4
> 
> 时间：2013-02-27T23:47:08.047
> 
> 标签：c++, linux, unlink

在 Linux 上的 C++ 中，我在 remove() 的手册页上看到它部分说明：

> remove 从文件系统中删除一个名称。它对文件调用 unlink，对目录调用 rmdir。

所以我想知道在文件上调用 remove() 和 unlink() 之间是否有任何区别？也许唯一的区别是 unlink() 稍微快一点，因为它不必处理目录？

# django - Django 测试数据库不自动刷新

> ID：15124828
> 
> 赞同：7
> 
> 时间：2013-02-27T23:47:25.850
> 
> 标签：django, testing, testcase, autoflush, django-tests

我有一堆单元测试文件，所有这些文件都由 django.test.TestCase 类组成。

给自己写了一个小 shell 脚本来取消注释/注释我的 __init__.py 文件中的测试文件导入，所以我可以根据我给它的命令行参数从某些测试文件运行测试。我还能够一次性运行所有测试文件的所有测试（用于回归测试目的）。

我有一个包含一些 JSON 夹具的测试文件，第一个测试检查某个模型/表中是否有 3 条记录（由 JSON 夹具定义）。

所以这就是问题所在：当我自己运行这个测试文件时，它的测试以优异的成绩通过，但是当我用所有其他测试运行测试时，我提到的那个特定的测试用例失败了。

当我运行所有测试时，数据库说表/模型中有 6 条记录，但应该只有 3 条（来自夹具），就像测试文件自己运行时一样。

我还尝试使用其他一些测试文件（不是全部）运行该测试文件并且它通过了。所以唯一没有的时候是所有测试文件都运行时。

对我来说，这似乎是 Django 或 PostgreSQL（我正在使用的 DB）中的一个错误，因为 Django TestCases 不应该在每个测试方法之间自动刷新/重置数据库，更不用说测试类了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-03T10:28:30.323

这可能是由于 Django 中的 TestCase 和 TransactionTestCase 之间的清理方式不同。在 Django 1.5 之前，TransactionTestCases 需要在 TestCases 之后运行（而 Django 的 testunner 已经为您做到了）。不过，这应该[在 1.5 中修复](https://code.djangoproject.com/ticket/18271)，因此请尝试在那里再次运行测试...

# python - 检查元组的元组中是否存在元素

> ID：15124833
> 
> 赞同：31
> 
> 时间：2013-02-27T23:47:39.423
> 
> 标签：python, list

我有一个看起来像的元组列表：

```
CODES = (
    ('apple', 'reddelicious'),
    ('caramel', 'sweetsticky'),
    ('banana', 'yellowfruit'),
) 
```

检查该元组中是否存在值的最佳方法是什么？例如，我希望能够说：

```
'apple' in CODES 
```

并得到真

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-02-27T23:48:44.043

您正在寻找[`any()`](http://docs.python.org/3/library/functions.html#any)：

```
if any('apple' in code for code in CODES):
    ... 
```

结合一个简单的[生成器表达式](http://www.youtube.com/watch?v=pShL9DCSIUw)，这可以完成任务。生成器表达式接受每个元组，`True`如果它是 contains 则产生`'apple'`。`any()`然后`True`在它请求的第一个项目返回时返回`True`（否则，`False`）。因此，这可以满足您的需求。它也很好读 -*如果任何元组包含`'apple'`*.

如果您要多次执行此操作并且需要性能，那么可能值得制作一组所有值以允许您非常快速地执行此操作：

```
cache = set(itertools.chain.from_iterable(CODES))) 
```

自然地，构建它会很慢并且会占用内存，因此除非您需要大量性能并且会进行大量成员资格检查，否则这不是一个好主意。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-27T23:49:10.030

您可以使用[`itertools.chain()`](http://docs.python.org/2/library/itertools.html#itertools.chain)：

使用它`in`会导致短路，类似于`any()`.

```
In [30]: CODES = (
   ....:     ('apple', 'reddelicious'),
   ....:     ('caramel', 'sweetsticky'),
   ....:     ('banana', 'yellowfruit'),
   ....: )

In [31]: from itertools import chain

In [32]: 'apple' in chain(*CODES)
Out[32]: True

In [33]: 'foo' in chain(*CODES)
Out[33]: False 
```

* * *

对于**性能比较**，您可以查看我的[其他答案](https://stackoverflow.com/questions/26902359/best-way-to-check-if-an-item-is-present-in-a-list-of-lists)。

# outlook - 检查 pst 文件是否受 java-libpst 密码保护

> ID：15124834
> 
> 赞同：1
> 
> 时间：2013-02-27T23:47:42.557
> 
> 标签：outlook, java, pst

我正在使用开源库[java-libpst](https://code.google.com/p/java-libpst/)来解析 Outlook`pst`文件。在解析之前我想知道该文件是否受密码保护。问题是我们这个库打开密码保护的文件没有密码，所以我没有找到任何检查文件是否受密码保护的方法。

我可以为此目的使用任何其他 java 库，只要它们是开源的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T06:04:28.170

不知道 .pst 文件的任何开源 java 库，但有商业库[JPST](http://www.independentsoft.de/jpst)。我们用它来读取 .pst 文件。该库能够从 .pst 文件中读取密码哈希。我记得密码存储在 MessageStore 对象中。

密码不用于加密 .pst 文件内容。任何应用程序或库都可以在不知道密码的情况下读取 Outlook .pst 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T10:12:50.713

在受密码保护的 pst 文件中，实际上没有加密。pst 文件的密码存储在标识符 0x67FF 中。如果没有密码，则存储的值为 0x00000000。Outlook 在打开 pst 文件时会匹配此密码。由于这个原因,java库java-libpst也可以在不需要密码的情况下访问密码保护文件的所有内容。

要检查文件是否受密码保护，请使用 java-libpst 使用：

```
 /**
     * checks if a pst file is password protected
     * 
     * @param file - pst file to check 
     * @return - true if protected,false otherwise
     * 
     * pstfile has the password stored against identifier 0x67FF.
     * if there is no password the value stored is 0x00000000.
     */
    private static boolean ifProtected(PSTFile file,boolean reomovePwd){
        try {
            String fileDetails = file.getMessageStore().getDetails();
            String[] lines = fileDetails.split("\n");
            for(String line:lines){
                if(line.contains("0x67FF")){
                    if(line.contains("0x00000000"))
                        return false;
                    else
                        return true;
                }

            }
        } catch (PSTException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return false;
    } 
```

# c - 为什么while循环中的这条语句从不执行？

> ID：15124835
> 
> 赞同：-1
> 
> 时间：2013-02-27T23:47:43.303
> 
> 标签：c

我编写了一些代码来正确证明 char 字节中的所有位。但是，应用程序卡在一个循环中，因为它从不执行该行`positionmask<<1;`

为什么会这样？

```
void rjustify(char thisChar)
{
    unsigned char c = thisChar;
    unsigned char positionmask = 1;
    unsigned char insertionmask = 1;
    while(positionmask)
    {
            if(c & positionmask)
            {
                    c^=positionmask;
                    c|=insertionmask;
                    insertionmask<<=1;
            }
            positionmask<<1; //This line is never executed.
    }
    printf("%c", &c);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T23:49:29.317

当该行被执行时，它没有任何作用。打开编译器警告并将其更改为：

```
 positionmask <<= 1; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T23:49:37.640

你需要这样做：`positionmask <<= 1;`相反！

编译器永远不会产生错误代码。除非生成编译器的编译器有问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T23:49:35.463

它被执行，它是一个 noop

位置掩码 <<= 1;

自我注意：不要急于发表评论，它会产生垃圾邮件。

# c++ - boost::asio::local::stream_protocol::acceptor 抛出错误

> ID：15124836
> 
> 赞同：1
> 
> 时间：2013-02-27T23:47:44.060
> 
> 标签：c++, boost, boost-asio

我正在尝试使用`boost::asio::local::stream_protocol::acceptor`这样的：

```
accept_(getIOService(), endpoint_) 
```

此调用返回的错误是：

```
[exec] unknown file: Failure
[exec] C++ exception with description "bind: No such file or directory" thrown in the test body. 
```

有没有人见过这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:48:35.660

验证端点的路径是否正确。当我通常观察到这些错误时，这是​​与路径相关的问题，例如在当前目录中不存在目录`"tmp/example"`时构建端点，因为我打算使用.`tmp``"/tmp/example"`

Boost.Asio 的例外是从接收的 `ENOENT`翻译`bind()`。状态的手册页[`bind()`](http://pubs.opengroup.org/onlinepubs/009695399/functions/bind.html)表明`ENOENT`：

> 路径名的组件未命名现有文件或路径名是空字符串。

# php - 使您的表格“粘性”

> ID：15124837
> 
> 赞同：-2
> 
> 时间：2013-02-27T23:47:53.680
> 
> 标签：php

我的代码有问题。当我单击“提交”时，错误检查工作正常，但以前的值消失了。我的代码有什么问题？谢谢

```
<?php

$FnameErr = $LnameErr = $GenderErr = $TimeErr = $EduErr = $ApatErr = $QuoteErr = "";
if($_SERVER["REQUEST_METHOD"] == "POST")
{
    if(empty($_POST["Fname"]))
    {
        $FnameErr = "Enter First Name";
    }
    else
    {
        $Fname = $_POST["Fname"];
    }

    if(empty($_POST["Lname"]))
    {
        $LnameErr = "Enter Last Name";
    }
    else
    {
        $Lname = $_POST["Lname"];
    }

    if(empty($_POST["gender"]))
    {
        $GenderErr = "Enter Gender";
    }
    else
    {
        $gender = $_POST["gender"];
    }

    if(empty($_POST["living"]))
    {
        $ApatErr = "Enter living";
    }
    else
    {
        $living = $_POST["living"];
    }

    if(empty($_POST["quote"]))
    {
        $QuoteErr = "Enter Quote";
    }
    else
    {
        $quote = $_POST["quote"];
    }
    if(empty($_POST["education"]))
    {
        $EduErr = "Enter Education";
    }
    else
    {
        $education = $_POST["education"];
    }

    if(empty($_POST["TofD"]))
    {
        $TimeErr = "Enter Time";
    }
    else
    {
        $TofD = $_POST["TofD"];
    }
    if(isset($Fname) && isset($Lname) && isset($gender) && isset($living) && isset($quote) && isset($TofD))
    {

        echo "Hello, " . $Fname . " " . $Lname . ".<br />";
        echo "You are " . $gender . ", and you live in ";
        foreach($living as $f)
        {
            echo $f . "<br />";
        }

        echo "You're favorite time is " . $TofD . ", and you passed " . $education . "!<br />";
        echo "<i>" . $quote . "</i><br />";
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:55:17.580

没有简单的方法可以做到这一点。您只需向表单添加值。

```
<input type=text name=FName value="<?php echo $FName; ?>"> 
```

为每个单独的表单输入做类似的事情

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:55:23.657

有两种快速的方法：

1.  用于早期测试值的 JavaScript。

在将表单提交到 PHPscript 之前，您必须创建一个 JavaScript 函数来检查每个字段的内容，如果没有内容，则在页面上显示一些消息。

1.  使用 PHP。

您必须将所有值添加到会话中，然后在重新加载表单时（如果其中一个字段中没有数据），将会话中的值添加到表单中。如果没有错误并且表单验证，您必须清除会话以删除值，因此下次加载表单时，不会添加任何值。

# javascript - 如何将 div 保持在一行并附加省略号

> ID：15124838
> 
> 赞同：8
> 
> 时间：2013-02-27T23:47:54.823
> 
> 标签：javascript, css, html, layout

css 中有没有办法确保 div 或 class 只是一行文本，如果超出，在其上附加省略号？我知道您可以将 div/class 设置为某个高度和`overflow:hidden`，但是对于我正在尝试做的事情来说它看起来很奇怪。

在下图中，您可以看到右侧的 div 比左侧的大。如果我可以将歌曲名称与省略号放在一行，它们将具有相同的高度。有谁知道如何做到这一点？PS 我想要一个比在 php 中做类似的事情更好的方法`$song = substr(0, 10, $song)`......希望通过 CSS 实现。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-27T23:50:58.383

1.  在容器上设置宽度。
2.  设置空白：nowrap。
3.  设置文本溢出：省略号。
4.  隐藏溢出*

演示：http: [//jsfiddle.net/jD99d/](http://jsfiddle.net/jD99d/)

```
.my-class-name {
    white-space: nowrap;
    text-overflow: ellipsis;
    width: 100px;
    overflow: hidden;
} 
```

请参阅[https://developer.mozilla.org/en-US/docs/CSS/text-overflow](https://developer.mozilla.org/en-US/docs/CSS/text-overflow)

^(* 请注意“此 CSS 属性不会强制发生溢出；要这样做并应用文本溢出，作者必须在元素上应用一些附加属性，例如将溢出设置为隐藏。”)

# excel - vbTrue 不是 True

> ID：15124840
> 
> 赞同：2
> 
> 时间：2013-02-27T23:48:19.350
> 
> 标签：excel, vba, userform

Excel 常量“True”的计算结果为 True，而常量“vbTrue”的计算结果为 -1。我一直认为这些在 VBA 代码中是可互换的，但事实并非如此。这两个常量产生不同结果的一个地方是设置 CheckBoxes。将 CheckBox.value 设置为 True 会产生预期的结果，但将其设置为 vbTrue 会使 CheckBox 处于 TripleState 中。

```
Sub setCkBox1()
       CheckBox1.TripleState = False
       CheckBox1.Value = vbTrue   '<<<< the check mark is dimmed to show TripleState is True
       Debug.Print CheckBox1.TripleState: Stop  '<<<< even though it won't admit it

       CheckBox1.Value = True  '<<<< check mark is not dimmed

End Sub 
```

所以我的问题是，在 VBA 中，这两个常量在哪里是不可互换的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T00:05:05.807

`True`是布尔值，`vbTrue`是长整数。在布尔值和长整数不可互换的任何地方，它们都不可互换。

# symfony - Symfony2 setController 转发

> ID：15124842
> 
> 赞同：1
> 
> 时间：2013-02-27T23:48:43.210
> 
> 标签：symfony

在我实现的事件监听器类中`kernel.controller`

我有

```
$event->setController(.....) 
```

并且正在工作，但它正在执行重定向操作，我如何使用但转发。

# c++ - 使用 OpenSSL 提升 ASIO 无法读取 HTTP 标头

> ID：15124844
> 
> 赞同：0
> 
> 时间：2013-02-27T23:48:52.140
> 
> 标签：c++, boost, ssl, openssl, boost-asio

我正在尝试使用 Boost ASIO 编写一个简单的 HTTP/HTTPS 代理。HTTP 工作正常，但我在使用 HTTPS 时遇到了一些问题。作为记录，这是一个本地代理。无论如何，这里是一个事务如何与我的设置一起工作的示例。

浏览器请求 Google.com
我对浏览器撒谎并告诉它转到 127.0.0.1:443
浏览器套接字连接到我在 443 上的本地服务器
我尝试读取标头以便进行真正的主机查找并打开第二个上游socket 所以我可以简单地转发请求。

这是事情立即失败的地方。当我尝试打印传入套接字的标头时，它们似乎已被发出请求的浏览器加密。起初我认为混乱的控制台输出可能只是标题被压缩，但经过一些彻底的测试后，情况并非如此。

所以我想知道是否有人能指出我正确的方向，也许是一些阅读材料，我可以更好地理解这里发生的事情。为什么在与“服务器”（我的代理）的连接甚至完成并有机会与客户端通信之前，标头会立即加密？是临时键吗？我是否需要忽略初始标头并返回一些命令告诉客户端使用什么临时密钥或根本不压缩/加密？非常感谢您的帮助，我已经坚持了一段时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:51:05.887

HTTPS 通过安全的 SSL 连接传递所有 HTTP 流量、标头和所有内容。这是通过设计来准确防止您尝试执行的操作，这本质上是中间人攻击。为了成功，您必须想出一种方法来破坏 SSL 安全性。

一种方法是提供浏览器将接受的 SSL 证书。浏览器抱怨证书的常见原因有两个：(1) 证书不是由浏览器信任的授权机构签署的；(2) 证书公用名 (CN) 与 URL 主机不匹配。

只要您控制浏览器环境，那么 (1) 很容易通过创建您自己的[证书颁发机构](http://en.wikipedia.org/wiki/Certificate_authority)(CA) 并将其证书安装为您的操作系统和/或浏览器中受信任的证书来解决。然后在您的代理中提供由您的 CA 签名的证书。您基本上是在告诉浏览器可以信任您的代理提供的证书。

(2) 将更加困难，因为您必须先提供具有正确 CN 的证书，然后才能读取 HTTP 标头以确定浏览器试图访问的主机。此外，除非您已经知道可能被请求的主机，否则您必须动态生成（并签名）匹配的证书。也许您可以为您的代理使用一个 IP 地址池并与您的欺骗 DNS 服务协调，以便您知道应该在哪个连接上提供哪个证书。

通常 HTTPS 代理不是一个好主意。我会劝阻它，因为你真的会违背浏览器的安全性。

我喜欢[这本书](http://amzn.com/0201615983)作为 SSL/TLS 参考。您可以使用[OpenSSL](http://www.openssl.org/)等工具来创建和签署您自己的证书。

# cloudbees - cloudbees RUN@cloud 是按小时还是按分钟计费？

> ID：15124847
> 
> 赞同：0
> 
> 时间：2013-02-27T23:49:09.680
> 
> 标签：cloudbees, paas

例如，如果我正在运行一个应用程序，并且它在 10 分钟内扩展到 5 个服务器，我是为 5 个服务器支付 10 分钟的费用，还是为整个小时支付 5 个服务器的费用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:51:01.987

CloudBees 每小时多次测量您的应用程序，并按使用的分钟数计费。DEV@cloud 也是如此（因此测量的分辨率是按分钟计算的）。

# java - java.util.logging 在每个日志条目中包含 jSessionId

> ID：15124852
> 
> 赞同：0
> 
> 时间：2013-02-27T23:49:27.640
> 
> 标签：java, jakarta-ee, java.util.logging

我在我的应用程序中使用 j2se 记录器。有什么方法可以在不修改当前日志语句的情况下使用日志文件中的每个日志条目记录 jSessionId。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T16:12:29.380

我得到了解决方案。这可以通过 ThreadLocal、一个 servlet 过滤器和一个日志过滤器来完成。步骤如下：

使用 ThreadLocal 变量创建会话 id 持有者类：

```
public abstract class SessionUtil {
      private static final ThreadLocal<String> sessionIdThreadLocal = new ThreadLocal<String>();
      public static String getSessionId() {
            return sessionIdThreadLocal.get();
      }
      public static void setSessionId(String jSessionId) {
            sessionIdThreadLocal.set(jSessionId);
      }
      public static void removeSessionId() {
            sessionIdThreadLocal.remove();
      }
} 
```

创建一个 ServletFilter 并在 ServletFilter 类的 init() 方法中，将日志过滤器与日志处理程序连接起来：

```
Handler[] handlers = Logger.getLogger("").getHandlers();
for (Handler handler : handlers) {
LogFilter logFilter = new MyLogFilter();
handler.setFilter(logFilter);
} 
```

在 ServletFilter 类的 doFilter() 方法中，添加以下行以将 JSessionId 添加到 ThreadLocal：

```
SessionUtil.setSessionId(request.getSession(false).getId()); 
```

在 ServletFilter 类的 doFilter() 方法的 finally 块中，添加以下行以在处理请求后从 ThreadLocal 中删除 JSessionId：

```
SessionUtil.removeSessionId(); 
```

定义日志过滤器类：

```
public class MyLogFilter implements LogFilter {
    public boolean isLoggable(LogRecord record) {
    if (SessionUtil.getSessionId() != null && 
            !SessionUtil.getSessionId().toString().equals("")) {
        StringBuilder sessId = new StringBuilder(SessionUtil.getSessionId().toString());
        String methodName = record.getSourceMethodName();
            if (methodName != null && !methodName.equals("")) {
            if (!methodName.endsWith(sessId.toString())) {
                    record.setSourceMethodName(sessId.insert(0, " ").insert(0, methodName).toString());
            }
            } else {
            record.setSourceMethodName(sessId.toString());
            }
    }
        return true;
    }
} 
```

现在示例日志条目将如下所示：

```
[4/12/13 10:00:46:685 EDT] 00000020 SampleClass    I com.example.SampleClass sampleMethod() [ROatVgqdnLd-ls3_ONvXcXU] Sample message 
```

# java - Spring 部分更新对象数据绑定

> ID：15124858
> 
> 赞同：25
> 
> 时间：2013-02-27T23:49:50.760
> 
> 标签：java, spring, spring-mvc

我们正在尝试在 Spring 3.2 中实现一个特殊的部分更新功能。我们使用 Spring 作为后端，并有一个简单的 Javascript 前端。我无法找到满足我们要求的直接解决方案，即*update() 函数应该接受任意数量的字段：值并相应地更新持久性模型。*

我们对所有字段进行了内联编辑，因此当用户编辑字段并确认时，id 和修改后的字段作为 json 传递给控制器​​。控制器应该能够从客户端获取任意数量的字段（1 到 n）并仅更新这些字段。

例如，当 id==1 的用户编辑他的 displayName 时，发布到服务器的数据如下所示：

```
{"id":"1", "displayName":"jim"} 
```

目前，我们在 UserController 中有一个不完整的解决方案，如下所述：

```
@RequestMapping(value = "/{id}", method = RequestMethod.POST )
public @ResponseBody ResponseEntity<User> update(@RequestBody User updateUser) {
    dbUser = userRepository.findOne(updateUser.getId());
    customObjectMerger(updateUser, dbUser);
    userRepository.saveAndFlush(updateUuser);
    ...
} 
```

此处的代码有效，但有一些问题：`@RequestBody`创建一个新的`updateUser`，填充`id`和`displayName`。将其与数据库中的相应字段`CustomObjectMerger`合并，更新.`updateUser``dbUser``updateUser`

问题是 Spring`updateUser`使用默认值和其他自动生成的字段值填充了一些字段，这些字段在合并时会覆盖我们在`dbUser`. 明确声明它应该忽略这些字段不是一种选择，因为我们希望我们`update`也能够设置这些字段。

我正在寻找某种方式让 Spring 仅自动将显式发送到`update()`函数中的信息合并到`dbUser`（不重置默认/自动字段值）中。有什么简单的方法可以做到这一点吗？

**更新：**我已经考虑过以下选项，它几乎可以满足我的要求，但并不完全。问题是它需要更新数据，`@RequestParam`并且（AFAIK）不执行 JSON 字符串：

```
//load the existing user into the model for injecting into the update function
@ModelAttribute("user")
public User addUser(@RequestParam(required=false) Long id){
    if (id != null) return userRepository.findOne(id);
    return null;
}
....
//method declaration for using @MethodAttribute to pre-populate the template object
@RequestMapping(value = "/{id}", method = RequestMethod.POST )
public @ResponseBody ResponseEntity<User> update(@ModelAttribute("user") User updateUser){
....
} 
```

我考虑过重写我的代码`customObjectMerger()`以更适合使用 JSON，计算并让它只考虑来自`HttpServletRequest`. `customObjectMerger()`但是，当 spring*几乎完全提供了我正在寻找的东西，减去缺少的 JSON 功能时，*即使必须首先使用 a 也会让人感觉很糟糕。如果有人知道如何让 Spring 做到这一点，我将不胜感激！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-28T20:56:32.067

我刚刚遇到了同样的问题。我目前的解决方案看起来像这样。我还没有做太多的测试，但在初步检查时，它看起来工作得相当好。

```
@Autowired ObjectMapper objectMapper;
@Autowired UserRepository userRepository;

@RequestMapping(value = "/{id}", method = RequestMethod.POST )
public @ResponseBody ResponseEntity<User> update(@PathVariable Long id, HttpServletRequest request) throws IOException
{
    User user = userRepository.findOne(id);
    User updatedUser = objectMapper.readerForUpdating(user).readValue(request.getReader());
    userRepository.saveAndFlush(updatedUser);
    return new ResponseEntity<>(updatedUser, HttpStatus.ACCEPTED);
} 
```

ObjectMapper 是一个 org.codehaus.jackson.map.ObjectMapper 类型的 bean。

希望这可以帮助某人，

**编辑：**

遇到子对象的问题。如果子对象接收到要部分更新的属性，它将创建一个新对象，更新该属性并设置它。这会删除该对象上的所有其他属性。如果我遇到一个干净的解决方案，我会更新。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T06:35:21.537

我们正在使用 @ModelAttribute 来实现您想要做的事情。

*   创建一个使用@modelattribute 注释的方法，该方法基于存储库中的路径变量加载用户。

*   使用参数 @modelattribute 创建方法 @Requestmapping

这里的重点是 @modelattribute 方法是模型的初始化器。然后 spring 将请求与这个模型合并，因为我们在 @requestmapping 方法中声明了它。

这为您提供了部分更新功能。

一些，甚至很多？;) 会争辩说这是不好的做法，因为我们直接在控制器中使用我们的 DAO，而不是在专用服务层中进行此合并。但是目前我们并没有因为这种方法而遇到问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-11-28T05:05:44.147

在调用持久化或合并或更新之前，我构建了一个将视图对象与实体合并的 API。

这是第一个版本，但我认为这是一个开始。

只需在 POJO`S 字段中使用注释 UIAttribute 然后使用：

`MergerProcessor.merge(pojoUi, pojoDb);`

它适用于原生属性和集合。

混帐：[https ://github.com/nfrpaiva/ui-merge](https://github.com/nfrpaiva/ui-merge)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-03T22:07:57.063

可以使用以下方法。

对于这种情况，PATCH 方法会更合适，因为实体将被部分更新。

在控制器方法中，将请求正文作为字符串。

将该字符串转换为 JSONObject。然后迭代键并使用传入数据更新匹配变量。

```
import org.json.JSONObject;

@RequestMapping(value = "/{id}", method = RequestMethod.PATCH )
public ResponseEntity<?> updateUserPartially(@RequestBody String rawJson, @PathVariable long id){

    dbUser = userRepository.findOne(id);

    JSONObject json = new JSONObject(rawJson);

    Iterator<String> it = json.keySet().iterator();
    while(it.hasNext()){
        String key = it.next();
        switch(key){
            case "displayName":
                dbUser.setDisplayName(json.get(key));
                break;
            case "....":
                ....
        }
    }
    userRepository.save(dbUser);
    ...
} 
```

这种方法的缺点是，您必须手动验证传入的值。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-04-30T10:17:32.053

我有一个使用 java.lang.reflect 包的定制和肮脏的解决方案。我的解决方案运行良好 3 年没有问题。

我的方法有 2 个参数，objectFromRequest 和 objectFromDatabase 都具有 Object 类型。

代码只是这样做：

```
if(objectFromRequest.getMyValue() == null){
   objectFromDatabase.setMyValue(objectFromDatabase.getMyValue); //change nothing
} else {
   objectFromDatabase.setMyValue(objectFromRequest.getMyValue); //set the new value
} 
```

来自请求的字段中的“空”值意味着“不要更改它！”。

名称以“Id”结尾的引用列的 -1 值表示“将其设置为空”。

您还可以为您的不同场景添加许多自定义修改。

```
public static void partialUpdateFields(Object objectFromRequest, Object objectFromDatabase) {
    try {
        Method[] methods = objectFromRequest.getClass().getDeclaredMethods();

        for (Method method : methods) {
            Object newValue = null;
            Object oldValue = null;
            Method setter = null;
            Class valueClass = null;
            String methodName = method.getName();
            if (methodName.startsWith("get") || methodName.startsWith("is")) {
                newValue = method.invoke(objectFromRequest, null);
                oldValue = method.invoke(objectFromDatabase, null);

                if (newValue != null) {
                    valueClass = newValue.getClass();
                } else if (oldValue != null) {
                    valueClass = oldValue.getClass();
                } else {
                    continue;
                }
                if (valueClass == Timestamp.class) {
                    valueClass = Date.class;
                }

                if (methodName.startsWith("get")) {
                    setter = objectFromRequest.getClass().getDeclaredMethod(methodName.replace("get", "set"),
                            valueClass);
                } else {
                    setter = objectFromRequest.getClass().getDeclaredMethod(methodName.replace("is", "set"),
                            valueClass);
                }

                if (newValue == null) {
                    newValue = oldValue;
                }

                if (methodName.endsWith("Id")
                        && (valueClass == Number.class || valueClass == Integer.class || valueClass == Long.class)
                        && newValue.equals(-1)) {
                    setter.invoke(objectFromDatabase, new Object[] { null });
                } else if (methodName.endsWith("Date") && valueClass == Date.class
                        && ((Date) newValue).getTime() == 0l) {
                    setter.invoke(objectFromDatabase, new Object[] { null });
                } 
                else {
                    setter.invoke(objectFromDatabase, newValue);
                }
            }

        }
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

在我的 DAO 类中，simcardToUpdate 来自 http 请求：

```
simcardUpdated = (Simcard) session.get(Simcard.class, simcardToUpdate.getId());

MyUtil.partialUpdateFields(simcardToUpdate, simcardUpdated);

updatedEntities = Integer.parseInt(session.save(simcardUpdated).toString()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-28T04:29:31.920

主要问题在于您的以下代码：

```
@RequestMapping(value = "/{id}", method = RequestMethod.POST )
public @ResponseBody ResponseEntity<User> update(@RequestBody User updateUser) {
    dbUser = userRepository.findOne(updateUser.getId());
    customObjectMerger(updateUser, dbUser);
    userRepository.saveAndFlush(updateUuser);
    ...
} 
```

在上述函数中，您调用了一些私有函数和类（userRepository、customObjectMerger、...），但没有说明它是如何工作的或这些函数的样子。所以我只能猜测：

> CustomObjectMerger 将此 updateUser 与数据库中相应的 dbUser 合并，更新 updateUser 中包含的唯一字段。

在这里，我们不知道 CustomObjectMerger 中发生了什么（那是你的函数，你没有显示它）。但是根据您的描述，我可以猜测：您将所有属性从`updateUser`数据库中复制到您的对象中。这绝对是一种错误的方式，**因为当 Spring 映射对象时，它会填充所有数据**。而且您只想更新一些特定的属性。

您的情况有两种选择：

1）将所有属性（包括未更改的属性）发送到服务器。这可能会花费更多的带宽，但您仍然保持自己的方式

2) 您应该设置一些特殊值作为 User 对象的默认值（例如，id = -1，age = -1...）。然后在 customObjectMerger 中，您只需设置不是 -1 的值。

如果你觉得以上2个方案都不满意，可以考虑自己解析json请求，不要纠结Spring对象映射机制。有时它只是混淆了很多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-30T20:34:04.683

我已经用 java Map 和一些反射魔法完成了这个：

```
public static Entidade setFieldsByMap(Map<String, Object> dados, Entidade entidade) {
        dados.entrySet().stream().
                filter(e -> e.getValue() != null).
                forEach(e -> {
                    try {
                        Method setter = entidade.getClass().
                                getMethod("set"+ Strings.capitalize(e.getKey()),
                                        Class.forName(e.getValue().getClass().getTypeName()));
                        setter.invoke(entidade, e.getValue());
                    } catch (Exception ex) { // a lot of exceptions
                        throw new WebServiceRuntimeException("ws.reflection.error", ex);
                    }
                });
        return entidade;
    } 
```

和入口点：

```
 @Transactional
    @PatchMapping("/{id}")
    public ResponseEntity<EntityOutput> partialUpdate(@PathVariable String entity,
            @PathVariable Long id, @RequestBody Map<String, Object> data) {
        // ...
        return new ResponseEntity<>(obj, HttpStatus.OK);
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-09-30T07:12:54.740

部分更新可以通过使用`@SessionAttributes`功能来解决，这些功能可以执行您自己使用`customObjectMerger`.

在这里查看我的答案，尤其是编辑，以帮助您入门：

[https://stackoverflow.com/a/14702971/272180](https://stackoverflow.com/a/14702971/272180)

# python - 两个字符字典的最大相似度？

> ID：15124859
> 
> 赞同：1
> 
> 时间：2013-02-27T23:49:51.103
> 
> 标签：python

假设我有一个 python 字典：

```
d = {"a":1, "b":2} 
```

这表示一个字符在字符串中出现的次数。所以上面的字典可以生成“abb”、“bab”或“bba”的字符串。

两个字典之间的最大相似度是一个 >= 0 和 <= 1 的比率，它描述了两个最相似生成的字符串的相似程度。

例如，

```
d1 = {"a":1, "b":2}
d2 = {"c": 3}
d3 = {"a":1, "d":2}

max_sim(d1, d2) # equals to 0.0 because no indexes 
# of an arrangement of ccc matches any indexes of an arrangement of abb
max_sim(d1, d3) # equals to 0.333 because an arrangement of add matches
# one out of three characters of an arrangement of abb
# note that if we compared dda and abb, the similarity ratio would be 0.0
# but we always take into account the most similarly generated strings 
```

如何仅通过查看每个字符的出现次数来生成任何两个字典（相同长度）的最大相似度？即简单地分析字典而不是实际生成字符串并检查每对的相似度。

注意：我在字典上使用 max_sim 而不是字符串，因为我已经遍历了两个字符串来收集它们的字典数据（除了其他东西）。如果我在两个字符串（原始字符串或将字典转换回字符串）上使用 max_sim，我想我只是在做冗余计算。因此，如果答案将两个字典作为输入，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:01:02.600

那这个呢：

```
def max_sim(d1, d2):
    # assume that's the same for both dicts
    length = sum(d1.values())
    matches = 0
    for letter in set(d1.keys() + d2.keys()):
        matches += min(d1.get(letter, 0), d2.get(letter, 0))
    return matches / float(length) 
```

结果：

```
d1 = {"a":1, "b":2}
d2 = {"c": 3} 
d3 = {"a":1, "d":2}
d4 = {"a": 1, "b": 1, "c": 1 }

max_sim(d1, d2) # 0.0
max_sim(d1, d3) # 0.333
max_sim(d1, d4) # 0.666
max_sim(d1, d1) # 1.0 
```

# jquery-ui - CKEditor 4 和 jQuery UI 可排序在排序后删除内容

> ID：15124860
> 
> 赞同：11
> 
> 时间：2013-02-27T23:49:51.823
> 
> 标签：jquery-ui, ckeditor, jquery-ui-sortable

我遇到了 CKEditor 4 和 jQuery UI 的可排序方法的问题，如果我对具有 CKEditor 实例的容器进行排序，它会删除该值并抛出错误“未捕获的类型错误：无法调用未定义的方法 'getSelection'”。它还使编辑器无法编辑。我能够在 CKEditor 3 中通过以下技巧之一解决这个问题： [CKEditor freezes on jQuery UI Reorder](https://stackoverflow.com/questions/3379653/ckeditor-freezes-on-jquery-ui-reorder)

在查看 Chrome DOM 检查器时，似乎 iframe 的内容已被删除。

下面是粗略的测试代码：

```
    <html>
    <头部>
        <title>测试</title>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.24/jquery-ui.min.js"></script>
        <script src="ckeditor.js"></script>
        <script type="text/javascript">
        $(函数(){

            var tmpStore = {};
            $('#sortable').sortable({
                光标：'移动'，

                // 用于在 V3 上工作但不适用于 V4 的黑客：
                // https://stackoverflow.com/questions/3379653/ckeditor-freezes-on-jquery-ui-reorder
                开始：函数（事件，ui）{
                    $('textarea').each(function(){
                        var id = $(this).attr('id');
                        tmpStore[id] = CKEDITOR.instances[id].getData();
                    })
                 },
                停止：函数（事件，用户界面）{
                    $('textarea').each(function(){
                        var id = $(this).attr('id');
                        CKEDITOR.instances[id].setData(tmpStore[id]);
                    })
                  }
            });
            $('textarea').each(function(){
                var ckId = $(this).attr('id');
                配置 = {};
                CKEDITOR.replace(ckId, 配置);
            })
        })

        li { 填充：10px; 宽度：800 像素；高度：300px；}

    </head>
    <正文>
        <ul id="可排序">
            <li><textarea id="test1" name="test1">test1</textarea></li>
            <li><textarea id="test2" name="test1">test2</textarea></li>
            <li><textarea id="test3" name="test1">test3</textarea></li>
        </ul>
    </正文>
    </html>

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-07-30T12:59:36.583

我遇到了同样的问题，并根据此处的答案进行了修复。请看下面的小提琴

问题： **[https ://jsfiddle.net/33qt24L9/1/](https://jsfiddle.net/33qt24L9/1/)**

```
 $(function() {
        $( "#sortable" ).sortable({
      placeholder: "ui-state-highlight"
    });

       CKEDITOR.replace( 'editor1' );
       CKEDITOR.replace( 'editor2' );
       CKEDITOR.replace( 'editor3' );
       CKEDITOR.replace( 'editor4' );

  }); 
```

已解决的问题：**[https ://jsfiddle.net/57djq2bh/2/](https://jsfiddle.net/57djq2bh/2/)**

```
 $(function() {
        $( "#sortable" ).sortable({
      placeholder: "ui-state-highlight",

             start: function (event, ui) 
        {
            var id_textarea = ui.item.find(".ckeditor").attr("id");
            CKEDITOR.instances[id_textarea].destroy();
        },
        stop: function (event, ui) 
        {
            var id_textarea = ui.item.find(".ckeditor").attr("id");
            CKEDITOR.replace(id_textarea);
        }           

    });

       CKEDITOR.replace( 'editor1' );
       CKEDITOR.replace( 'editor2' );
       CKEDITOR.replace( 'editor3' );
       CKEDITOR.replace( 'editor4' );

  }); 
```

**编辑：如果像我一样，每个编辑器都有单独的配置，这里更新的代码会有所帮助：**

```
start: function (event, ui)
        {
            $('.wysiwyg', ui.item).each(function(){
                var tagId = $(this).attr('id');
                var ckeClone = $(this).next('.cke').clone().addClass('cloned');
                ckeConfigs[tagId] = CKEDITOR.instances[tagId].config;
                CKEDITOR.instances[tagId].destroy();
                $(this).hide().after(ckeClone);
            });
        },

        stop: function(event, ui) {
            // for each textarea init ckeditor anew and remove the clone
            $('.wysiwyg', ui.item).each(function(){
                var tagId = $(this).attr('id');
                CKEDITOR.replace(tagId, ckeConfigs[tagId]);
                $(this).next('.cloned').remove();
            });
        } 
```

感谢：[https ://github.com/trsteel88/TrsteelCkeditorBundle/issues/53](https://github.com/trsteel88/TrsteelCkeditorBundle/issues/53)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T12:17:46.267

一旦底层 DOM 结构被修改，您必须重新创建 CKEditor。创建新实例后，使用`editor.getData()`之前保存编辑器数据`editor.destroy()`并使用恢复内容。`editor.setData( data )`由于 CKEditor 强烈依赖 DOM 结构，因此没有其他方法可以解决此问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-02-25T13:33:39.627

删除 CKEditor 开始排序

```
var ckeConfigs = [];
$('.ui-sortable').sortable({
 start:function (event,ui) {
  $('.lineItemCommentBox', ui.item).each(function(){
    var tagId = $(this).attr('id');
        ckeConfigs[tagId] = CKEDITOR.instances[tagId].config;
    CKEDITOR.instances[tagId].destroy();
  });
 },
 stop: function(event, ui) {
  $('.lineItemCommentBox', ui.item).each(function(){
   var tagId = $(this).attr('id');
   CKEDITOR.replace(tagId, ckeConfigs[tagId]);
  });
 }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-11T07:42:21.843

下面的代码对我有用，我们必须在启动时销毁编辑器，并在拖动结束时重新创建它，获取来自数据的 textarea 的值：

```
jQuery(function($) 
{
    var panelList = $("#nameofyourdiv");
    panelList.sortable(
    {
        handle: ".classofyourdivforsorting", 
        start: function (event, ui) 
        {
            var id_textarea = ui.item.find("textarea").attr("id");
            CKEDITOR.instances[id_textarea].destroy();
        } 
        stop: function (event, ui) 
        {
            var id_textarea = ui.item.find("textarea").attr("id");
            CKEDITOR.replace(id_textarea);
        }           
    });
}); 
```

希望它可以帮助某人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-26T09:33:18.280

我已经通过在打开 jquery 对话框后实例化 CKEditor 来解决此类问题

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-22T10:38:11.737

我遇到了与 CKEDITOR 类似的问题，下面的代码对我有用。销毁 Ckeditor 实例并删除 Ckeditor 并在拖动结束时再次用 Ckeditor 替换当前文本区域

```
 $("#sortable").sortable({
        items: '.dynamic',
        start: function (event , ui) {

                var editorId = $(ui.item).find('.ckeditor').attr('id');// get the id of your Ckeditor
                editorInstance = CKEDITOR.instances[editorId]; // Get the Ckeditor Instance
                editorInstance.destroy(); // Destroy it
                CKEDITOR.remove(editorId);// Remove it

        },
        stop: function(event, ui) { 
                var editorId = $(ui.item).find('.ckeditor').attr('id');// Get the Id of your Ckeditor 
                CKEDITOR.replace(editorId);// Replace it
            }
        } 

    });
    $("#sortable").disableSelection(); 
```

这里**#sortable是****可排序**的DIV的**ID**，**'** .dynamic' 是分配给有资格排序的DIV 的类，**'.ckeditor'**是Textarea 的类。

 ******我从[这里](http://ckeditor.com/forums/CKEditor/CKEditor-Becomes-Disabled-When-Moved-with-Javascript)得到了我的解决方案，希望这对将来的某人有所帮助。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-06-15T12:42:59.983

我只是使用 ckeditorOff() 和 ckeditorOn() 函数在移动过程中保留数据和重新/取消实例化 ckeditor 实例。

```
$('#sortable').sortable({
    cursor: 'move',
    start:function (event,ui) {
        if(typeof ckeditorOff=='function')ckeditorOff();
    },
    stop: function(event, ui) { 
        if(typeof ckeditorOn=='function')ckeditorOn();
    } 
}); 
```

我`typeof ckeditorOff`声明使代码与 ckeditor 的未来版本兼容，以防他们决定删除这两个函数。******

# multithreading - Google App Engine Python 2.5/2.7 实例中的线程安全/它是如何工作的？

> ID：15124866
> 
> 赞同：0
> 
> 时间：2013-02-27T23:50:19.130
> 
> 标签：multithreading, google-app-engine, thread-safety

这是一个高级问题，但看起来很简单 - 请参阅代码（一个全局变量，每个 http 处理程序调用都会增加一个变量）。

```
some_global_var = 0

class DebugCgiHandler(webapp.RequestHandler):
  def get(self):
    some_global_var++
    self.response.out.write(some_global_var) 
```

Q1。问题是如果变量设置为 1 并且并发调用发生在另一个请求中，那么在 Python 2.5 和 Python 2.7 单线程模式下会发生什么，因此变量将在第二个请求之前递增`self.response.out.write(some_global_var)`。第一个请求中将显示什么，第二个请求中将显示什么？

* * *

Q2。第二个问题是，如果 Python 2.7 以多线程模式运行，在同样的情况下会发生什么？

* * *

Q3。如何在整个请求处理过程中避免变量更改以保持相同的值直到最后免受其他线程的影响？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T00:23:05.700

Q1：在单线程模式下你不会有并发请求调用进来，所以你不必担心线程安全。

Q2：启用多线程后，您可能会遇到不可预知的行为，因为不同的线程可能会增加 some_global_var 并在不同的时间显示它们。例如，如果时间以特定方式发生， some_global_var 可能只会增加一次。

Q3：使用 threading.Lock()

现在我还没有回答你会得到什么结果，因为对于 App Engine，这个问题已经被打破了。some_global_var 在特定实例中将是“全局的”，但您无法控制您的请求转到哪些实例。因此，即使在单线程环境中，您的两个请求也可能会遇到两个单独的实例，在这种情况下，您会看到两个请求都为 1。或者他们可能会遇到同一个实例，您会看到 2。您的线程问题将在此基础上应用。

# image - XSLT 以一致的大小显示新闻项目图像

> ID：15124868
> 
> 赞同：0
> 
> 时间：2013-02-27T23:50:22.273
> 
> 标签：image, xslt, image-resizing, image-size

我有一个 RSS XML 新闻文件，其中包含一个项目列表，其中包括一个图像的 URL。我也有一个关联的 XSLT。

问题是图像大小不一致，我想限制图像大小，将它们调整为漂亮的缩略图。

我将如何修改 XSLT 来实现这一点？

XML 示例：

```
<?xml version="1.0" encoding="UTF-8" ?>
<rss version ="2.0" xmlns:g="http://base.google.com/ns/1.0">
    <channel>
        <title>Company Name</title>
        <description>Company description</description>
        <link>http://www.mycompanyurl.com</link>

        <item>
            <title>News Item Title</title>
            <link>http://www.whateverurl.com/</link>
            <category>Space</category>
            <pubDate>12 April 1961</pubDate>
            <description>Software to reduce your job search to a half hour per day. all major job sites, job boards, classifieds. unemployment paperwork, CRM, interviews, more</description>
            <image>
                <url>~/App_Data/NewsControl/whatever.png</url>
                <title>Whatever1</title>
                <link>javascript:void(0)</link>
            </image>
            <g:id>1</g:id>
            <g:brand>Whatever2</g:brand>
            <g:condition>whatever3</g:condition>
            <g:price>$whatever4</g:price>
            <g:product_type>Whatever5</g:product_type>
        </item>
    </channel>
</rss> 
```

这是相关的 XSLT：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="/">
    <items>
      <xsl:for-each select="//item">
        <item Name="{position()}" HeaderText="{title}" Text="{description}" NavigateUrl="{position()}" Date="{pubDate}" ImageUrl="{image/url}"/>
      </xsl:for-each>
    </items>
  </xsl:template>
</xsl:stylesheet> 
```

**第一个答案的结果**：

```
<items>
    <xsl:for-each select="//item">
       <item Name="{position()}" HeaderText="{title}" Text="{description}" NavigateUrl="{position()}" Date="{pubDate}" ImageUrl="/Tools/thumber.php?img={image/url}"/>
    </xsl:for-each>
</items> 
```

我进行了这些更改，在服务器上启用了 PHP（从服务器和本地测试），并看到了 2 个问题： 1\. 我没有得到图像，只是没有图像框。

1.  如果我尝试编辑 ImageUrl 并添加“&W=xxx&H=xxx”，Visual Studio 验证器会抱怨并在 & 上抛出错误。

**更新 2** 这是 XSLT 中的最新行：http://myserver.com/Tools/thumber.php?img=',image/url)}"/>

XML 中对应的图像部分

```
<image>
    <url>/Products/Jobfish/Images/Boxshots/Jobfish_DVDCaseCD_ShadowOut.jpg</url>
    <title>Jobfish</title>
    <link>javascript:void(0)</link> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T06:53:49.847

XSLT 没有用于调整大小或缩略图的内置函数。您将不得不为此使用外部处理器，例如。通过使用 PHP 缩略图生成器。

然后用指向缩略图生成器的 URL 替换原始图像路径，源是原始图像。

假设 ImageUrl = mediaserver.xyz/ourlogo.jpg 新的 ImageUrl 将变为 myserver.com/thumbnailgenerator.php?src= [http://mediaserver.xyz/ourlogo.jpg](http://mediaserver.xyz/ourlogo.jpg)

请确保您选择一个缓存缩略图库（例如[https://code.google.com/p/phpthumbmaker/wiki/ThumberWiki](https://code.google.com/p/phpthumbmaker/wiki/ThumberWiki)），因为如果您跳过它，这将是一个严重的资源消耗。重新提供这些缩略图时，还要考虑版权问题。

# vb.net - 无法从 .NET 关闭 MS Word

> ID：15124871
> 
> 赞同：2
> 
> 时间：2013-02-27T23:50:25.593
> 
> 标签：vb.net, ms-word

我有以下代码片段。它可以工作（打开目录中的所有 Word 文档，然后将它们关闭）......但是当我完全退出程序时它不会自行清理。

我的意思是，如果我在退出 VB.NET 应用程序后查看 TaskManager，我会看到 WINWORD.EXE，即使它在我打开应用程序之前并不存在。

这是我的声明：

```
Dim WordApp As Microsoft.Office.Interop.Word.Application
Dim aDoc As Microsoft.Office.Interop.Word.Document

Dim missing As Object = System.Reflection.Missing.Value
Dim nullobj As Object = System.Reflection.Missing.Value

Dim MYreadOnly As Object = False
Dim isVisible As Object = False 
```

这是代码：

```
Private Sub cmdGenerate_Click(sender As System.Object, e As System.EventArgs) Handles cmdGenerateKeywords.Click

  Dim xmldoc As New XmlDataDocument()
  Dim xmlnode As XmlNodeList
  Dim i As Integer
  Dim fs As FileStream

  WordApp = New Microsoft.Office.Interop.Word.Application
  WordApp.Visible = False

  For Each f As FileInfo In New DirectoryInfo(txtFolderName.Text).GetFiles("*.docx")
    ' Open the document that was chosen by the dialog
    aDoc = WordApp.Documents.Open(f.FullName, missing, [MYreadOnly], _
           missing, missing, missing, missing, missing, missing, missing, _
           missing, isVisible)
    'aDoc.Close()
    aDoc = Nothing
  Next

  'Close the Word Document
  'aDoc.Close(nullobj, nullobj, nullobj)
  WordApp.Application.Quit()
  WordApp = Nothing
End Sub 
```

如您所知，我已经评论和取消了关于关闭 Word 文档和 Word 应用程序本身的各种声明。我尝试过的任何方法似乎都无法摆脱那个讨厌的 WINWORD.EXE

有些东西似乎有锁，不会让它关闭？是这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-12T14:03:18.170

显式运行垃圾收集器，如[本文](http://code.msdn.microsoft.com/office/CSAutomateWord-4df8dc29)所示：

```
 // Clean up the unmanaged Word COM resources by forcing a garbage 
 // collection as soon as the calling function is off the stack (at 
 // which point these objects are no longer rooted).

 GC.Collect();
 GC.WaitForPendingFinalizers();
 // GC needs to be called twice in order to get the Finalizers called 
 // - the first time in, it simply makes a list of what is to be 
 // finalized, the second time in, it actually is finalizing. Only 
 // then will the object do its automatic ReleaseComObject.
 GC.Collect();
 GC.WaitForPendingFinalizers(); 
```

尽管有上面的链接，但我的经验是运行一次就足够了。但是第二次调用不会抛出错误，所以这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-12T12:19:47.543

```
fs.Close()
fs.Dispose() 
```

[http://msdn.microsoft.com/en-us/library/system.io.filestream.dispose.aspx](http://msdn.microsoft.com/en-us/library/system.io.filestream.dispose.aspx)

这会释放您的资源。可能允许其他关闭方法起作用。我通读了两次代码，并没有看到您像我期望的那样在任何地方使用“fs”。

# javascript - Javascript + CSS 问题。无法修改样式

> ID：15124874
> 
> 赞同：1
> 
> 时间：2013-02-27T23:51:01.317
> 
> 标签：javascript

我正在为一项活动（主要是样式）编辑一个 javascript Jeopardy 游戏。然而，我改变的一件事是允许多少玩家，现在当你点击答案时它们会重叠。

游戏：[http ://warp.byu.edu/jeopardy/](http://warp.byu.edu/jeopardy/)

见下图：http: [//imageshack.us/photo/my-images/826/jeopardy.png/](http://imageshack.us/photo/my-images/826/jeopardy.png/)

我的问题是我对 CSS 所做的所有更改都没有影响。我认为 JS 正在设置宽度（它无法使任何工作）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:58:54.813

在css上设置一个最大宽度，它不会超过那个

# java - 如何从android中的json url获取新的数据更新？

> ID：15124877
> 
> 赞同：1
> 
> 时间：2013-02-27T23:51:24.957
> 
> 标签：java, android, json

我正在从事在线广播流媒体项目。我从一个 url 播放流并从另一个 json url 解析音轨信息。我所做的只是每 10 秒后重复解析 json，这就是为什么当音轨发生变化时，我可以获得该特定音轨的音轨信息。但是 json 文件在曲目更改前 30+ 秒更新，这就是为什么有时曲目和曲目信息之间存在明显差异的原因。

这是我正在播放流的 asyncTask 类。

```
public class RadioPlayer extends AsyncTask<String, Void, Void> {

        MediaPlayer mediaPlayer = new MediaPlayer();

        @Override
        protected void onPreExecute() {

        }

        @Override
        protected Void doInBackground(String... params) {

            mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
            try {
                mediaPlayer.setDataSource(params[0]);
                mediaPlayer.prepare();

            } catch (IllegalArgumentException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            } catch (SecurityException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            } catch (IllegalStateException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            } catch (IOException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }

            // might take long! (for buffering, etc)
            mediaPlayer.start();
            return null;
        }

        @Override
        protected void onPostExecute(Void result) {

        } 
```

这是我每 10 秒更新一次跟踪信息的处理程序：

```
private void getSongStatistics() {
        r = new Runnable() {
            public void run() {

                try {
                    title = tsp.parseInitiator();
                } catch (ClientProtocolException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } finally {

                    Log.i("title", title);
                    try {
                        String[] subTitles = title.split("-");
                        tvTitle.setText(subTitles[1]);
                        tvArtist.setText(subTitles[0]);
                    } catch (Exception e) {

                        tvArtist.setText(title);
                    }
                    handler.postDelayed(this, 10000);

                }

            }
        };

        handler.postDelayed(r, 10000);

    } 
```

有什么解决方案可以让我摆脱这个奇怪的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:14:20.303

使用[推送](http://developer.android.com/google/gcm/index.html)而不是轮询来更新数据。

# c# - ASP.NET MVC3：新行上的 ValidationMessageFor

> ID：15124878
> 
> 赞同：7
> 
> 时间：2013-02-27T23:51:27.233
> 
> 标签：c#, css, asp.net-mvc, asp.net-mvc-3, validation

我的模型有一条验证消息：

```
 <td colspan="2">
        <div class="rereg-input">
           @Html.TranslatedTextBoxFor(m => m.Email)
           @Html.ValidationMessageFor(m => m.Email)
         </div>
     </td> 
```

当用户忘记时，文本会在字段旁边很好地显示一个 *：

![在此处输入图像描述](../Images/24df0d47d5555aba8dc68c170ca456ff.png)

但是，当他们输入错误的电子邮件时，消息就会被放在最后。我怎样才能把它弄下来？

![在此处输入图像描述](../Images/ccb0e6d73deb43e31130055d5360c8db.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T23:57:30.677

您需要重新排列/修复 CSS/HTML 结构。

```
<td colspan="2">
    <div class="rereg-input">
        @Html.TranslatedTextBoxFor(m => m.Email)
        <div>
            @Html.ValidationMessageFor(m => m.Email)
        </div>
    </div>
</td> 
```

您最好修改 MVC 放在验证消息元素和 set 上的任何 CSS 类`display:block;`。

```
.validation-message {
    /* ... */
    display:block;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-27T23:55:39.550

简单地用 div 包围它就可以了

```
<div>@Html.ValidationMessageFor(m => m.Email)</div> 
```

# c# - 使用 StopWatch 类测量 C#/异步数据访问

> ID：15124880
> 
> 赞同：7
> 
> 时间：2013-02-27T23:51:42.840
> 
> 标签：c#, asynchronous

我有以下代码，似乎经过的毫秒数不准确：

```
 public async Task<ActionResult> Index()
    {
        try
        {
            var connString = RoleEnvironment.IsEmulated
                                 ? ConfigurationManager.ConnectionStrings["Poc"].ConnectionString
                                 : ConfigurationManager.ConnectionStrings["PocVm"].ConnectionString;

            var repository = new AccountRepository(connString);
            var stopWatch = new Stopwatch();
            stopWatch.Start();

            var accounts = await repository.GetAll();

            stopWatch.Stop();
            ViewBag.Accounts = accounts;
            ViewBag.VmStatus = stopWatch.ElapsedMilliseconds;
        }
        catch (Exception e)
        {
            blah blah blah...
        }

        return View();
    } 
```

这看起来正确还是我错过了一些非常明显的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-26T05:28:38.493

这对我来说看起来完全没问题。

如果 Repository.GetAll 方法不是异步的，则可能会出现错误，希望它具有如下签名：

```
 public async Task<IEnumerable<Account>> GetAll(); 
```

# php - 从目录中一张一张地获取图片

> ID：15124887
> 
> 赞同：2
> 
> 时间：2013-02-27T23:52:11.503
> 
> 标签：php, javascript, jquery, jquery-slider

在php中我想问如何从文件夹目录中一张一张地获取图像并显示在jquery滑块中我已经尝试过这个php代码，因为它没有按我想要的方式工作？

```
 <ul class="jcarousel-list">
 <li class="jcarousel-item">
 <?php 
 $directory = "data/uploads/topslider/";
 if (glob($directory . "*") != false)
 {
   $filecount = count(glob($directory . "*"));
 }
 else
 {
 } 
 $files_index = glob("data/uploads/"."top"."slider/*.*");
 for ($i=0; $i<$filecount; $i++)
 {
   $num2 = $files_index[$i];
 ?>
 <img src="<?php echo $num2;?>" width="50" height="50" alt="" /> <? 
 }?></li>
 </ul> 
```

我想要这样的显示：

**Image1 Image2 Image3......等等来自单个文件夹或目录**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:11:32.157

有四项主要检查：

1.  您的`$directory`路径相对于您当前在 PHP 中的工作目录是否正确？您可以通过执行临时`echo getcwd();`. 它需要返回“数据”文件夹的父目录才能使您的代码正常工作。

2.  `data`可以从网络上的当前页面访问该文件夹吗？例如，如果您手动从 URL 中删除页面（例如，`index.php`）并添加您知道存在于您的文件夹中的图像在`data/uploads/topslider/someimage.png`哪里，图像是否在浏览器中正确加载？如果没有，您需要更新在标签中构建属性的方式。`someimage.png``topslider``src``img`

3.  您只是`jcarousel-item`为所有图像添加一个，这对我来说似乎不正确。我猜你应该为每张图片添加一个列表项。

4.  您不需要调用 glob 两次来确定您必须处理多少个文件。只做一次`foreach`声明：

    ```
    echo '<ul class="jcarousel-list">';
    foreach(glob($directory . '*') as $filename) {
        echo '<li class="jcarousel-item"><img src="'.$filename.'" width="50" height="50" alt="" /></li>';
    }
    echo '</ul>'; 
    ```

# c++ - ifstream 到动态分配的数组

> ID：15124891
> 
> 赞同：0
> 
> 时间：2013-02-27T23:52:18.060
> 
> 标签：c++, memory, dynamic, ifstream

我有一个文本文件，内容如下：

“二锹三锹四锹”……等等。

我正在使用以下代码提取单词：

```
 char *temp;
   temp = new char[20];

   fin >> *temp;
   charCount=stringLength(temp);
   deckPtr->rank = new char[charCount+1];
   stringCopy(temp, deckPtr->rank);

   fin >> *temp;
   charCount=stringLength(temp);
   deckPtr->suit = new char[charCount+1];
   stringCopy(temp, deckPtr->suit); 
```

第二部分和第三部分在一个循环中，在写入所有结构成员后继续到下一个“卡片”。

（stringCopy 和 stringLength 是我自己编写的函数，它们已经过测试可以工作）

后来，当我计算结构成员时，我发现一次只提取了一个字符。例如，第一个元素的等级是't'，花色是'w'，然后它继续进入下一张带有'o'和's'的牌的花色和等级......显然，一个字符在正在提取时间。如何获取整个字符串，以空格结尾？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:01:19.407

问题是：

```
fin >> *temp;

<stream> >> <char> 
```

所以它只会读取一个字符。
您正在从流中读取一个字符。

你想要的是读取一个字符串（或一个单词）

```
<stream>  >> <C-String>

// This is expressed as:
fin >> temp; // Note no '*' 
```

如果您使用 std::string 和 std::vector 编写此代码，则大约需要 10 行代码。像这样用 C 语言编写它并带有一些 C++ 特性会使正确编写变得更加困难。

# c# - 在渲染集群中的节点之间同步视图状态

> ID：15124892
> 
> 赞同：2
> 
> 时间：2013-02-27T23:52:19.930
> 
> 标签：c#, network-programming, opentk

我正在构建一个显示墙演示应用程序。

环境：

*   N 台机器，每台最多可驱动六台显示器
*   有线千兆交换机
*   OpenTK 应用程序绘制漂亮的图片，在每个节点上运行 1 个副本

每个节点运行演示可执行文件的相同副本。每个节点还具有一些配置数据，其中包含整面墙的分辨率以及该节点在该空间内的显示的相对位置。渲染时，在投影矩阵之后应用缩放/平移变换（有效放大节点负责渲染的视图部分。

节点在启动脚本中设置了一个“模式”开关，将它们置于“发送”或“接收”模式。除一个节点外，所有节点都处于“接收”状态。（将一个节点切换到“发送”会导致所有其他节点切换到“接收”）。

演示应用程序是一些基本几何体（网格、二十面体等）的基本 FPS 类型飞行。在每次更新时，发送方节点都会广播一个包含一些状态信息（摄像机平移/旋转、移动对象的变换）的 UDP 数据报。

侦听器异步接收这些数据报，反序列化状态并更新其本地副本。

最终效果是我在笔记本电脑上运行该应用程序并飞来飞去，墙壁很好地跟随。这一切都很好。

但是，我担心随着系统的扩展（从 10 台显示器到 500 台显示器），网络延迟将成为一个问题。我还认为，与其通过这种方式在网络上发送垃圾邮件状态，不如将其填充到数据库中并让每个节点从那里拉出，但我怀疑任何现成的数据库都将达到一个 60FPS * 500 个节点的循环。

建议？在很多节点之间真正非常快速地共享状态的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T15:08:01.027

[我在gamedev.stackexchange.com](http://gamedev.stackexchange.com)上收到了相当完整的回复。有兴趣的可以[在这里查看](https://gamedev.stackexchange.com/questions/50415/synchronizing-view-state-between-nodes-in-a-rendering-cluster)。

# php - 如果经过身份验证并且用户存在于 DB 中，则将 Facebook 用户登录到 CakePHP 应用程序

> ID：15124894
> 
> 赞同：3
> 
> 时间：2013-02-27T23:52:45.293
> 
> 标签：php, facebook, cakephp

我已经构建了一个非常简单的 CakePHP 应用程序来测试 Facebook PHP SDK 的可能实现，用户可以使用该应用程序或 Facebook 进行注册，也可以使用该应用程序或 Facebook 登录。但是因为用户可以在应用程序上做事，所以即使他们通过 Facebook 帐户登录/注册，他们也会在应用程序上拥有一个用户帐户。

到目前为止，我已经创建了两种处理身份验证和获取用户信息的方法：

```
// Asks user to authenticate
public function facebook()
{
    $params = array(
      'redirect_uri' => 'http://domain.com/users/signupfacebook',
      'scope'=> 'email',
      'display' => 'popup'
    );

    $loginUrl = $this->Facebook->Sdk->getLoginUrl($params);

    // Need to know if user is already a user on OUR app
    // If true log them in. If false redirect to signup form like below

    $this->autoRender = false;
    $this->response->header('Location', $loginUrl);

}

// Handle the return
public function signupfacebook()
{
    $user = $this->Facebook->Sdk->getUser();

    if($user)
    {
        try
        {
            $facebookuser = $this->Facebook->Sdk->api('/me');

            $this->set('facebookuser', $facebookuser);
        }
        catch(FacebookApiException $e)
        {
            error_log($e);
            $user = NULL;
        }
   }
   else
   {
        $this->Session->setFlash('An error has occurred! Please try again.');

        $this->redirect(array('action'=>'index'));
   }
} 
```

因此，一个用户说我想使用 Facebook 进行身份验证，这使用了我的控制器的 facebook() 方法，然后它会询问他们的许可并根据此操作重定向他们。目前它只会将他们发送到一个注册页面，其中一些字段是根据他们传递的用户信息预先填写的，如下所示：

```
<?php echo $this->Form->create('User'); ?>

    <?php echo $this->Form->input('User.email', array('type' => 'text', 'default'=> $facebookuser['email'], 'label' => array('class' => 'placeholder', 'text' => 'Email address') )); ?>

        <?php echo $this->Form->input('User.firstname', array('type' => 'text', 'default'=> $facebookuser['first_name'], 'label' => array('class' => 'placeholder', 'text' => 'Firstname') )); ?>

        <?php echo $this->Form->input('User.lastname', array('type' => 'text', 'default'=> $facebookuser['last_name'], 'label' => array('class' => 'placeholder', 'text' => 'Lastname') )); ?>

        <?php echo $this->Form->input('User.username', array('type' => 'text', 'default'=> $facebookuser['username'], 'label' => array('class' => 'placeholder', 'text' => 'Username') )); ?>

        <?php echo $this->Form->input('User.password', array('value' => '','type' => 'password', 'label' => array('class' => 'placeholder', 'text' => 'Password') )); ?>

    <button type="submit">Create</button>

<?php echo $this->Form->end(); ?> 
```

**但我这里有几个问题：**

**问题 1.)**如果用户已经在系统中拥有一个带有他们刚刚输入的 Facebook 凭据的帐户，那么它需要处理这个问题并让用户登录。这是否需要使用 Facebook 端的任何特殊功能？因为我只想在用户表中搜索匹配的帐户，然后自动登录，但我没有在网上找到任何在 FB 身份验证发生后验证您自己的用户表的示例。

**问题 2.)**可能与上一个问题有关，但是当用户注册帐户时，不会保存与他们用于登录的 Facebook 帐户的关联，因此如果当他们尝试使用 Facebook 再次登录时，将不会看到关联，除非我在数据库中搜索类似的详细信息，但这似乎很不稳定，而且 API 的使用不正确。本质上，用户只是使用 FB 来填充表单，而实际上并未使用他们的 Facebook 帐户进行实际注册。

我可以检查数据库中是否存在与通过 Facebook 传递的电子邮件地址相同的电子邮件地址，但如果他们从那以后更改了它怎么办？我考虑过可能将 Facebook 用户 ID 存储在应用程序中的用户 ID 表中，以便存储连接。这会是一个解决方案吗？或者错误的方法来做到这一点？

例如一个新表来存储 FB 用户和 CakePHP 应用程序用户之间的链接：

```
id
user_id (this is the relationship to your USER table)
facebook_user_id 
```

但即使这样做，我也不确定如何利用它以有用的方式正确链接帐户并正确处理通过 Facebook 的身份验证，而不是仅在某些详细信息匹配时自动填充表单或登录用户（我确信这有潜在的安全风险）。

**问题 3.)**当用户通过 Facebook 发送回注册表单时，他们会收到以下 URL（出于安全原因，注意位已更改）：

```
http://domain.com/users/signupfacebook?state=dbf2f6dds322b7cb90d71b6c958a001bf4a3ba&code=AQa7-GDsesM0ZfgswjgGF-mMKwjcoboLl19WKprIA2-f4iZzUdsd8o8z-NweYYODzySS3h9GksBw0G9WCXj79Pp-0ldyeIRCOLSt9gfgfsmEFEfOrEO6gm7a0jmDuQvchdsaHaw1QpI8RdGTCrqAPlLzpHGcqiCtBvXjiQtBhQP--tMr8CIlvRwbrJRwiZwF6xo30howlRkVTLddsdDCDt60_KGznPVmEe-T4Qbu9gdkv9v#_=_ 
```

据我所知：[https](https://developers.facebook.com/docs/howtos/login/server-side-login/) ://developers.facebook.com/docs/howtos/login/server-side-login/我应该在上面发布的两种方法之间创建一个额外的步骤来处理代码并获得一个访问令牌回来。

**但是我已经访问了填写注册表单所需的所有信息，而无需执行 OAuth 流程的第二阶段并获得访问令牌！**所以不确定在这种情况下我是否需要它......或者我需要它吗？如果是这样，它将如何帮助解决前两个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T08:35:52.543

以下是允许用户通过 注册的步骤`facebook`。

我用来完成此任务的表结构如下，

```
CREATE TABLE IF NOT EXISTS `users` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(200) NOT NULL,
  `email` varchar(255) NOT NULL,
  `password` varchar(200) NOT NULL,
  `profile_name` varchar(100) NOT NULL,
  `dob` date NOT NULL,
  `phone_number` bigint(20) NOT NULL,
  `location` varchar(200) NOT NULL,
  `user_picture` varchar(200) NOT NULL,
  `profile_view` bigint(20) NOT NULL,
  `facebook_id` bigint(11) NOT NULL,
  `facebook_status` tinyint(4) NOT NULL,
  `login_status` tinyint(4) NOT NULL,
  `status` tinyint(4) NOT NULL,
  `activation_link` varchar(200) NOT NULL,
  `password_link` varchar(200) NOT NULL,
  `created` datetime NOT NULL,
  `modified` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=7 ; 
```

首先使用以下代码创建视图文件。我把它放在`views/users/signup.ctp`

```
<div class="grid_7 alpha">
    <a href="Javascript:void(0);" onclick="connect_facebook(); return false;">
      Signup with facebook
    </a>
</div> 
```

应用一些 css 使它看起来更漂亮。现在在同一个视图文件中，在页面底部添加以下代码。

```
<script type="text/javascript">
    window.fbAsyncInit = function()
    {
        FB.init(
        {
            appId: FACEBOOK_API,
            cookie: true,
            xfbml: true,
            oauth: true
        });
    };

    function connect_facebook()
    {
        FB.login(function(response)
        {
            if (response.authResponse)
            {
                $.ajax(
                {
                    url         : HOST+'users/facebook_signup/'+response.authResponse.userID,
                    dataType    : 'json',
                    beforeSend  : function()
                    {
                        $.blockUI({
                            message: '<img src="'+HOST+'img/popup/pre_code_bg.gif" alt="" />'
                        });
                    },
                    success     : function(data)
                    {
                        $.unblockUI();
                        if(data.status == "false")
                        {
                            FB.logout(function(response)
                            {
                                window.location = HOST+'users/logout';
                            });
                            return false;
                        }
                        else
                        {
                            document.location.reload(true);
                        }
                    }
                });
            }
            else
            {
                FB.logout(function(response)
                {
                    window.location = HOST+'users/logout';
                    alert('User cancelled login or did not fully authorize.');
                });
            }
        });
    }

    (function()
    {
        var e = document.createElement('script'); e.async = true;
        e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
        document.getElementById('fb-signup-root').appendChild(e);
    }());
</script> 
```

只需相应地更换`FACEBOOK_API`。

现在在`users_controller`文件里面粘贴下面的代码，

```
<?php
class UsersController extends AppController
{
    var $name = 'Users';

    function beforeFilter()
    {
        parent::beforeFilter();
        $this->Auth->allow( 'login','signup''facebook_signup' );
    }

    function facebook_signup($facebook_id)
    {
        $this->autoRender = false;
        $this->layout = "ajax";

        App::import('Vendor', 'Facebook', array('file' => 'facebook'.DS.'facebook.php'));

        $response = array();

        $facebook = new Facebook(array
        (
            'appId'  => FACEBOOK_API,
            'secret' => FACEBOOK_SKEY,
        ));

        $facebook_user = $facebook->getUser();

        if ($facebook_user)
        {
            try
            {
                $user_profile = $facebook->api('/me');
            }
            catch (FacebookApiException $e)
            {
                echo '<pre>'.htmlspecialchars(print_r($e, true)).'</pre>';
                $facebook_user = null;
            }
        }

        $find_facebookemail = $this->User->find('first',array
        (
            'conditions' => array
            (
                'User.email' => $user_profile['email'],
                'OR' => array
                (
                    'User.facebook_id' => 0,
                    'User.facebook_id' => $facebook_id
                )

            ),
            'recursive' => -1
        ));

        if(!empty($find_facebookemail))
        {
            $this->data['User']['id'] = $find_facebookemail['User']['id'];
            $this->data['User']['email'] = $find_facebookemail['User']['email'];
            $this->data['User']['name'] = $find_facebookemail['User']['name'];
            $this->data['User']['facebook_id'] = $find_facebookemail['User']['facebook_id'];
            $this->data['User']['location'] = $find_facebookemail['User']['location'];
            $this->data['User']['dob'] = $find_facebookemail['User']['dob'];

            $this->Session->write("Auth.User", $find_facebookemail['User']);
            $this->Session->write("Auth.User.facebook_user", true);

            $response['status'] = "true";
            echo json_encode($response);
            exit;
        }
        else
        {
            $this->data['User']['email'] = $user_profile['email'];
            $this->data['User']['name'] = $user_profile['name'];
            $this->data['User']['facebook_id'] = $user_profile['id'];
            $this->data['User']['location'] = $user_profile['location']['name'];
            $this->data['User']['facebook_status'] = 1;
            $this->data['User']['status'] = 1;

            $dob = explode("/",$user_profile['birthday']);
            $this->data['User']['dob'] = $dob[2].'-'.$dob[0].'-'.$dob[1];

            if($this->User->save($this->data['User']))
            {
                $this->Session->write("Auth.User.id", $this->User->getLastInsertID());
                $this->Session->write("Auth.User.name", $this->data['User']['name']);
                $this->Session->write("Auth.User.email", $this->data['User']['email']);
                $this->Session->write("Auth.User.facebook_id", $this->data['User']['facebook_id']);
                $this->Session->write("Auth.User.location", $this->data['User']['location']);
                $this->Session->write("Auth.User.dob", $this->data['User']['dob']);
                $this->Session->write("Auth.User.facebook_user", true);

                $img = file_get_contents('https://graph.facebook.com/'.$find_facebookemail['User']['facebook_id'].'/picture?width=500&height=500');
                $img_thumbs = file_get_contents('https://graph.facebook.com/'.$find_facebookemail['User']['facebook_id'].'/picture?width=150&height=150');

                $file = "img".DS."user_picture".DS."".$find_facebookemail['User']['facebook_id'].".jpg";
                $file_thumbs = "img".DS."user_picture".DS."thumbs".DS."".$find_facebookemail['User']['facebook_id'].".jpg";

                file_put_contents($file, $img);
                file_put_contents($file_thumbs, $img_thumbs);

                $this->data['User']['id'] = $this->Session->read('Auth.User.id');
                $this->data['User']['user_picture'] = $find_facebookemail['User']['facebook_id'].".jpg";

                $this->User->save($this->data['User']);

                $response['message'] = "You have successfully registered with us.";
                $response['status'] = "true";
                echo json_encode($response);
                exit;
            }
            else
            {
                $response['message'] = "Something is wrong during process.Please try again later.";
                $response['status'] = "false";
                echo json_encode($response);
                exit;
            }
        }
        exit;
    }
} 
```

控制器代码所做的是检查`facebook`具有已发布 ID 的用户是否**已经注册**，然后允许他`login`访问站点并设置**cakephp auth.user 会话**，如果没有，则将**用户和他/她的图片以及所有其他数据添加到 mysql 数据库**中。

现在您的数据库中有用户条目，因此您可以在他/她更改密码后要求用户更改他的密码，然后他们可以在没有帐户`login`的情况下访问您的应用程序。`login``facebook`

**上面的代码经过多次全面测试并且可以正常工作。**

完毕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T16:43:24.803

**数据库表结构：**通常您的常规用户表包含姓名、电子邮件、生日等以及包含 Facebook 用户 ID 的附加字段。我称之为“facebook_uid”。这将为您提供与 Facebook API 相关的识别目的。如果您需要在用户注销您的应用程序时做一些事情，那么您将需要一个名为“access_token”的附加字段。此访问令牌以及正确的权限将允许您在用户离线时代表用户执行操作，例如在他的墙上发帖等。

**答案 1.)**如果用户已经在您的应用程序中注册了 Facebook，您只需检查 Facebook API 调用中出现的 Facebook 用户 ID 并将其与您的用户表匹配。如果找到，那么您就可以像往常一样使用 CakePHP 处理本地会话。如果未找到，则表示是新用户，他们必须完成注册过程。

**答案 2.)**将手动注册用户和 Facebook 注册用户关联起来的唯一数据是他们的电子邮件。如果本地邮箱与Facebook邮箱匹配，则表示是同一用户，只需更新数据库中的“facebook_uid”字段，下次他登录时，你就已经可以识别他了。如果 Facebook 电子邮件与他在您网站上注册时使用的电子邮件不同，那么您无法知道是同一个人。您可以随时查看其他信息，例如姓名、生日和其他信息，但这根本不可靠，您可能会弄乱您的用户数据。此外，您不需要 2 张桌子。您的原始用户表已经有“facebook_uid”字段。

**答案 3.)**就像我之前解释的那样，如果您需要在用户注销时在用户的 Facebook 帐户上做一些事情，例如在他的墙上发帖或喜欢某事，您将只需要访问令牌。为了得到他的访问令牌，你只需要从你的 Facebook API 类中调用 getAccessToken() 方法：

```
$this->Facebook->Sdk->getAccessToken(); 
```

这将返回一个长字符串，您可以将其存储在您的用户表中，然后检索它以在他的 Facebook 帐户上执行任务。以下是基于 CodeIgniter 的 Wall 帖子示例：

```
$facebook = new Facebook(array(
  'appId'  => 'XXXXXXXXXXXXXXXXXXXX',
  'secret' => 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',
));

$facebook->setAccessToken($row->access_token); //this access token was previously stored in the database

$args = array(
    'message'   => 'Ya estoy participando en el Concurso - Se la Estrella',
    'link'      => $this->config->item('tabUrl'),
    'name'      => 'Concurso - Se la Estrella de Kreisel',
    'caption'   => '¡Vota por mi video! Tu también puedes participar.',
    'picture'   => site_url().'/assets/main/uploads/captures/'.$row->facebook_id.'.jpg'
);

$post_id = $facebook->api("/me/feed", "post", $args); 
```

**另外，我个人对您的注册表单的建议：**不要让用户修改或查看表单上的 Facebook 信息，只需询问他您可能需要 Facebook 不会提供的任何其他信息，例如他的电话、公司等。 姓名等信息、姓氏、电子邮件、生日等已在 Facebook 上，显示已填写此数据的表单会使用户感到困惑。所以，如果用户在 Facebook 上注册，你几乎不需要问他什么，只需检查用户是否已经存在于你的本地数据库中，如果存在，你登录他，如果不存在，只是保存他的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T02:24:18.613

是的，您需要将帐户链接在一起。

我通常为用户添加**facebook_id**列。因此，每当我的用户想要使用 FB 登录或获得积极的身份验证响应时

```
function connectWithFacebook() {
    FB.getLoginStatus(function(response) {
    var uid = '';
    var accessToken = '';
    if (response.status === 'connected') {
        uid = response.authResponse.userID;
        accessToken = response.authResponse.accessToken;
        FB.api('/me', function(response) {
            $.post("http://" + AppSettings.baseURL + "/Users/checkState", 
            {data : response}, 
            function(postResponse){
                if(postResponse == 'registered') {
                    // do after registration stuff
                } else if( postResponse == 'authenticated') {
                        // do after login stuff
                    }
            });
        });
    }
 });
}

FB.Event.subscribe('auth.login', function () {
    connectWithFacebook();
}); 
```

在控制器方面。

```
public function checkState() {
    $userExists = $this->User->userExists($this->request->data['id']);
    if (!empty($userExists)) {         
        $this->authorizeUser($userExists);  // Already exisits, login user to our system with id
        echo "authorized";
        return;
    }
    if ($this->request->is('post')) {
        $this->User->create();
        $this->request->data['User']['role_id'] = 4;

        if ($this->User->save($this->request->data, array('validate' => false))) {
            echo "registered";
        }
        return;
    }
} 
```

对于不使用 Facebook 注册的用户，facebook_id 列保持为 0。

我希望这有帮助

# actionscript - adobe flash cs5 如何移动容器和儿童

> ID：15124897
> 
> 赞同：1
> 
> 时间：2013-02-27T23:52:55.187
> 
> 标签：actionscript, flash-cs5

那么我怎样才能为坦克（没有代码 as3）创建一个容器来移动坦克（使用 as3，如 tank.x += tankSpeed）本身以及他的所有部件（轮子、转轮、其他东西），因为我不想在每一帧中独立移动所有部件，例如旋转转轮并同时移动坦克的容器，我没有在 adobe flash cs5 中找到如何添加形状（矩形、圆形.. .) 到某个主容器并给它一些对象名称，然后在代码（as3）中得到类似的东西：

```
container //get the container itself

container.child1

container.child2 
```

如果可能当然

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:38:55.157

在 CS5 中创建一个新`MovieClip`的，将其放在舞台上，并为其命名为 instance name `tank`。在里面`MovieClip`画出你的坦克，但将每个移动部件放入`MovieClips`它们自己的每个部件中，每个部件都有一个唯一的实例名称，比如`wheel_1`, `wheel_2`, `turret`, `other_thing`。

现在您可以独立于主时间轴上的代码来操作坦克的各个部分，如下所示：

```
tank.wheel_1.play();
tank.turret.stop();
tank.wheel_2.gotoAndPlay('reverse'); 
```

移动坦克的简单程序看起来像这样（未经测试）：

```
var speed = 10;

this.addEventListener(Event.ENTER_FRAME, enterFrameHandler);

// Execute on each frame
function enterFrameHandler(event:Event):void
{
    tank.x += speed;
} 
```

# python - 列表中的 Python 错误

> ID：15124899
> 
> 赞同：2
> 
> 时间：2013-02-27T23:53:14.743
> 
> 标签：python, list

我需要用作用于列表每个位置的函数“counterPosition”的相应输出值替换列表阵营的所有元素

```
camp = [[True, False, False, False, False, True],
         [False, False, False, False, False, True],
         [True, True, False, True, False, True],
         [True, False, False, False, False, False],
         [False, False, True, False, False, False],
         [False, False, False, False, False, False]]

def counterPosition(x, y):
    bombs = 0
    for i in range(x-1, x+2):
        for j in range(y-1, y+2):
            if i<0 or j<0: continue
            elif camp[i][j] == True:
                bombs += 1
    return bombs

for x in range (len(camp)):
   for y in range (len(camp[x])):
       camp[x][y] = counterPosition(x,y)
print camp 
```

这使：

```
IndexError: list index out of range 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:58:50.500

问题出在你的`counterPosition`功能上。尤其是：

```
for i in range(x-1, x+2):
    for j in range(y-1, y+2):
        …
        elif camp[i][j] == True: 
```

您正在传递`x`范围从`0`到的值`len(camp)-1`。这意味着`i`范围从`-1`到`len(camp)-1+2`。因此，例如，当您到达最后一行时，`x=5`,的`i`范围将从`-1`到`6`。但是`camp[6]`已经越界了。所以你得到一个`IndexError`.

当然，你会遇到同样的问题`y`and `j`。

那么，你如何解决这个问题？嗯，这取决于你想做什么。但是，鉴于这一行：

```
if i<0 or j<0: continue 
```

我想你想要的是添加这个：

```
elif i>=len(camp) or j>=len(camp[i]): continue 
```

虽然确实如此，但在循环之外消除这些会更简单——例如，`for i in range(max(x-1, 0), min(x+2, len(camp)):`

* * *

同时，我不确定你的程序想要做什么，但它看起来像是某种与扫雷有关的东西，是吗？如果是这样，我认为即使您解决了这个问题，它也不会做您想做的事情。当您用计数替换`True`and值时，对于. 所以，最终的结果是：`False``camp[i][j] == True``i<=x and j<=y`

```
[[2, 2, 2, 1, 3, 2],
 [2, 2, 3, 2, 4, 2],
 [3, 2, 1, 2, 1, 2],
 [1, 3, 2, 3, 1, 2],
 [1, 3, 1, 2, 1, 2],
 [1, 3, 1, 3, 1, 2]] 
```

当我认为你可能想要这个时：

```
[[1, 1, 0, 0, 2, 2],
 [3, 3, 2, 1, 4, 3],
 [3, 3, 2, 1, 3, 2],
 [3, 4, 3, 2, 2, 1],
 [1, 2, 1, 1, 0, 0],
 [0, 1, 1, 1, 0, 0]] 
```

这是在偶数给定方格上相邻炸弹的数量。要获得后者，要么迭代或修改 的副本`camp`，而不是对相同的`list`. 例如：

```
newcamp = copy.deepcopy(camp)
for x in range (len(camp)):
   for y in range (len(camp[x])):
       newcamp[x][y] = counterPosition(x,y)
print newcamp 
```

要不就：

```
camp = [[counterPosition(x, y) for y in range(len(camp[x]))] 
        for x in range(len(camp))]
print camp 
```

（虽然真的，我会给他们不同的名字，比如`bombcamp`和`flagcamp`或什么的……）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:15:21.070

存储此数据的另一种方法是使用集合：

```
bombs = {
    (i, j) for i, row in enumerate(camp)
           for j, is_bomb in enumerate(row)
           if is_bomb
} 
```

然后，而不是`camp[i][j] == True`，做`(i, j) in bombs`

# c++ - 为什么 KD 树对于点集中的最近邻搜索如此缓慢？

> ID：15124900
> 
> 赞同：13
> 
> 时间：2013-02-27T23:53:22.813
> 
> 标签：c++, data-structures, raytracing, kdtree, cgal

我正在使用 CGAL 的（最新的）KD-tree 实现来搜索点集中的最近邻。而且 Wikipedia 和其他资源似乎表明 KD-trees 是要走的路。但不知何故，它们太慢了，Wiki 还建议它们的最坏情况时间为 O(n)，这远非理想。

[BEGIN-EDIT] **我现在使用“nanoflann”，它比 CGAL 中的 K-neighbor 搜索快 100-1000 倍。我正在使用“Intel Embree”进行光线投射，它比 CGAL 的 AABB 树快大约 100-200 倍。** [结束编辑]

我的任务如下所示：

我有一个巨大的积分集，比如最多 100 mio。积分！！并且它们的分布在三角几何的表面上（是的，光子示踪剂）。所以可以说它们在 3D 空间中的分布是 2D，因为它在 3D 中是稀疏的，但在查看表面时是密集的……这可能是问题所在吗？因为对我来说，这似乎触发了 KD 树的最坏情况性能，它可能可以更好地处理 3D 密集点集......

CGAl 非常擅长它的工作，所以我有点怀疑他们的实现很糟糕。我用于光线追踪的他们的 AABB 树在几分钟内在地面上燃烧了十亿条光线......我想这很了不起。但另一方面，他们的 KD-tree 甚至无法处理 mio。在任何合理的时间点和 250k 样本（点查询）......

我想出了两个解决方案，它们可以摆脱 KD-trees：

1) 使用纹理贴图将光子存储在几何体的链表中。这始终是 O(1) 操作，因为无论如何您都必须进行光线投射......

2) 使用视图相关的切片哈希集。那就是你离得越远，哈希集就越粗糙。所以基本上你可以在 NDC 坐标中考虑一个 1024x1024x1024 的栅格，但是使用哈希集来节省稀疏区域的内存。这基本上具有 O(1) 复杂性并且可以有效地并行化，对于插入（微分片）和查询（无锁）都是如此。

前一种解决方案的缺点是几乎不可能对相邻的光子列表进行平均，这在较暗的区域避免噪声很重要。后一种解决方案没有这个问题，应该在功能方面与 KD-trees 相提并论，只是它具有 O(1) 最坏情况下的性能，哈哈。

所以你怎么看？糟糕的KD树实现？如果没有，对于有界最近邻查询，是否有比 KD 树“更好”的东西？我的意思是我没有反对我上面的第二个解决方案，但是提供类似性能的“经过验证的”数据结构会更好！

谢谢！

这是我使用的代码（虽然不可编译）：

```
#include "stdafx.h"
#include "PhotonMap.h"

#pragma warning (push)
    #pragma warning (disable: 4512 4244 4061)
    #pragma warning (disable: 4706 4702 4512 4310 4267 4244 4917 4820 4710 4514 4365 4350 4640 4571 4127 4242 4350 4668 4626)
    #pragma warning (disable: 4625 4265 4371)

    #include <CGAL/Simple_cartesian.h>
    #include <CGAL/Orthogonal_incremental_neighbor_search.h>
    #include <CGAL/basic.h>
    #include <CGAL/Search_traits.h>
    #include <CGAL/point_generators_3.h>

#pragma warning (pop)

struct PhotonicPoint
{
    float vec[3];
    const Photon* photon;

    PhotonicPoint(const Photon& photon) : photon(&photon) 
    { 
        vec[0] = photon.hitPoint.getX();
        vec[1] = photon.hitPoint.getY();
        vec[2] = photon.hitPoint.getZ();
    }

    PhotonicPoint(Vector3 pos) : photon(nullptr) 
    { 
        vec[0] = pos.getX();
        vec[1] = pos.getY();
        vec[2] = pos.getZ();
    }

    PhotonicPoint() : photon(nullptr) { vec[0] = vec[1] = vec[2] = 0; }

    float x() const { return vec[0]; }
    float y() const { return vec[1]; }
    float z() const { return vec[2]; }
    float& x() { return vec[0]; }
    float& y() { return vec[1]; }
    float& z() { return vec[2]; }

    bool operator==(const PhotonicPoint& p) const
    {
        return (x() == p.x()) && (y() == p.y()) && (z() == p.z()) ;
    }

    bool operator!=(const PhotonicPoint& p) const 
    { 
        return ! (*this == p); 
    }
}; 

namespace CGAL 
{
    template <>
    struct Kernel_traits<PhotonicPoint> 
    {
        struct Kernel 
        {
            typedef float FT;
            typedef float RT;
        };
    };
}

struct Construct_coord_iterator
{
    typedef const float* result_type;

    const float* operator()(const PhotonicPoint& p) const
    { 
        return static_cast<const float*>(p.vec); 
    }

    const float* operator()(const PhotonicPoint& p, int) const
    { 
        return static_cast<const float*>(p.vec+3); 
    }
};

typedef CGAL::Search_traits<float, PhotonicPoint, const float*, Construct_coord_iterator> Traits;
typedef CGAL::Orthogonal_incremental_neighbor_search<Traits> NN_incremental_search;
typedef NN_incremental_search::iterator NN_iterator;
typedef NN_incremental_search::Tree Tree;

struct PhotonMap_Impl
{
    Tree tree;

    PhotonMap_Impl(const PhotonAllocator& allocator) : tree()
    {
        int counter = 0, maxCount = allocator.GetAllocationCounter();
        for(auto& list : allocator.GetPhotonLists())
        {
            int listLength = std::min((int)list.size(), maxCount - counter);
            counter += listLength; 
            tree.insert(std::begin(list), std::begin(list) + listLength);
        }

        tree.build();
    }
};

PhotonMap::PhotonMap(const PhotonAllocator& allocator)
{
    impl = std::make_shared<PhotonMap_Impl>(allocator);
}

void PhotonMap::Sample(Vector3 where, float radius, int minCount, std::vector<const Photon*>& outPhotons)
{
    NN_incremental_search search(impl->tree, PhotonicPoint(where));
    int count = 0;

    for(auto& p : search)
    {
        if((p.second > radius) && (count > minCount) || (count > 50))
            break;

        count++;
        outPhotons.push_back(p.first.photon);
    }

} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-05T15:24:56.107

答案不是提问的地方，但你的问题不是问题，而是 CGAL 的 kd-tree 很烂的陈述。

读取地质数据模型的 1.8mio 点，并计算每个点的 50 个最近点，在我的 Dell Precision、Windows7、64bit、VC10 上具有以下性能：

*   从文件中读取点：10 秒
*   树的构建 1.3 秒
*   报告 50 个最近点的 1.8 个 mio 查询：17 秒

有没有类似的表现。你会期望 kd-tree 更快吗？

另外我想知道您的查询点在哪里，靠近表面或靠近骨架。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-05T17:14:41.380

几个月前，我对快速 KD-tree 实现进行了一些研究，我同意 Anony-Mousse 的观点，即质量（和库的“重量”）差异很大。以下是我的一些发现：

[kdtree2](https://github.com/jmhodges/kdtree2)是一个鲜为人知且非常简单的 KD-tree 实现，我发现它对于 3D 问题非常快，尤其是如果您允许它复制和重新排序您的数据。此外，它很小，很容易合并和适应。[这](http://arxiv.org/abs/physics/0408067)是作者的一篇关于实现的论文（不要因为标题中提到的 Fortran 而被推迟）。这是我最终使用的库。我的同事将它的 3D 点速度与[VLFeat 的](http://www.vlfeat.org)KD-trees 和另一个我不记得的库（许多 FLANN，见下文）进行了基准测试，结果它赢了。

[FLANN](http://people.cs.ubc.ca/~mariusm/index.php/FLANN/FLANN)以速度快着称，最近经常被使用和推荐。它针对更高维的情况，它提供近似算法，但也用于处理 3D 问题的[点云库。](http://pointclouds.org)

我没有尝试 CGAL，因为我发现这个库太重了。我同意 CGAL 有很好的声誉，但我觉得它偶尔会受到过度复杂的影响。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-01T23:25:20.907

不幸的是，根据我的经验，实施质量差异很大。然而，我从未看过 CGAL 的实现。

kd-tree 最坏的情况通常是由于增量更改而变得过于*不平衡*，应该重新加载。

但是，一般而言，当您不知道数据分布时，此类树最有效。

在您的情况下，听起来好像简单的基于网格的方法可能是最佳选择。如果需要，您可以将纹理视为密集的 2d 网格。所以也许你可以找到一个网格工作良好的二维投影，然后与这个投影相交。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-22T21:54:20.397

如果 kdtree 对小集合来说很快，但对大集合（>100000？）来说“慢”，你可能会因为刷新处理器缓存而受苦。如果前几个节点与很少使用的叶节点交错，那么您将在处理器缓存中放置较少的频繁使用的节点。这可以通过最小化节点的大小和仔细布局内存中的节点来改善。但最终你还是会刷新相当数量的节点。您最终可能会访问成为瓶颈的主内存。

Valgrind 告诉我，我的代码的一个版本减少了 5% 的指令，但我相信秒表告诉我对于相同的输入它会慢 10% 左右。我怀疑 valgrind 进行完整的缓存模拟会告诉我正确的答案。

如果您是多线程的，您可能希望鼓励线程在类似区域中进行搜索以重用缓存......假设单个多核处理器 - 多个处理器可能需要相反的方法。

提示：与 64 位指针相比，您在内存中打包的 32 位索引更多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-16T13:12:15.857

看看 MPL 许可证下的 ApproxMVBB 库：

[https://github.com/gabyx/ApproxMVBB](https://github.com/gabyx/ApproxMVBB)：

kdTree 实现应该与 PCL(FLANN) 相当，并且可能更快。（在我的实现中，使用 PCL 进行的测试似乎更快！）

免责声明：我是这个库的所有者，绝不是这个库声称更快，还没有进行严格的性能测试，但我在速度为王的粒状刚体动力学中成功地使用了这个库！但是，这个库非常小，并且 kdTree 实现非常通用（参见示例），并且允许您自定义拆分启发式和其他奇特的东西 :-)。

实现了与 nanoflann（直接数据访问等，通用数据，n 维）类似的改进和考虑......（参见 KdTree.hpp）头文件。

**一些时间更新：**
该示例`kdTreeFiltering`包含一些小基准：加载了 35947 点的标准兔子（开箱即用的 repo 中的完整工作示例）：

*结果：*

**兔子.txt**

```
Loaded: 35947 points 
KDTree::  Exotic point traits , Vector3* +  id, start: =====
KdTree build took: 3.1685ms.
Tree Stats: 
     nodes      : 1199
     leafs      : 600
     tree level : 11
     avg. leaf data size : 29.9808
     min. leaf data size : 0
     max. leaf data size : 261
     min. leaf extent    : 0.00964587
     max. leaf extent    : 0.060337
SplitHeuristics Stats: 
     splits            : 599
     avg. split ratio  (0,0.5] : 0.5
     avg. point ratio  [0,0.5] : 0.22947
     avg. extent ratio (0,1]   : 0.616848
     tries / calls     : 599/716 = 0.836592
Neighbour Stats (if computed): 

     min. leaf neighbours    : 6
     max. leaf neighbours    : 69
     avg. leaf neighbours    : 18.7867
(Built with methods: midpoint, no split heuristic optimization loop)

Saving KdTree XML to: KdTreeResults.xml
KDTree:: Simple point traits , Vector3 only , start: =====
KdTree build took: 18.3371ms.
Tree Stats: 
     nodes      : 1199
     leafs      : 600
     tree level : 10
     avg. leaf data size : 29.9808
     min. leaf data size : 0
     max. leaf data size : 306
     min. leaf extent    : 0.01
     max. leaf extent    : 0.076794
SplitHeuristics Stats: 
     splits            : 599
     avg. split ratio  (0,0.5] : 0.448302
     avg. point ratio  [0,0.5] : 0.268614
     avg. extent ratio (0,1]   : 0.502048
     tries / calls     : 3312/816 = 4.05882
Neighbour Stats (if computed): 

     min. leaf neighbours    : 6
     max. leaf neighbours    : 43
     avg. leaf neighbours    : 21.11
(Built with methods: midpoint, median,geometric mean, full split heuristic optimization) 
```

**具有 1400 万个点的**Lucy.txt模型：****

 **```
Loaded: 14027872 points 
KDTree::  Exotic point traits , Vector3* +  id, start: =====
KdTree build took: 3123.85ms.
Tree Stats: 
         nodes      : 999999
         leafs      : 500000
         tree level : 25
         avg. leaf data size : 14.0279
         min. leaf data size : 0
         max. leaf data size : 159
         min. leaf extent    : 2.08504
         max. leaf extent    : 399.26
SplitHeuristics Stats: 
         splits            : 499999
         avg. split ratio  (0,0.5] : 0.5
         avg. point ratio  [0,0.5] : 0.194764
         avg. extent ratio (0,1]   : 0.649163
         tries / calls     : 499999/636416 = 0.785648
(Built with methods: midpoint, no split heuristic optimization loop)

KDTree:: Simple point traits , Vector3 only , start: =====
KdTree build took: 7766.79ms.
Tree Stats: 
     nodes      : 1199
     leafs      : 600
     tree level : 10
     avg. leaf data size : 11699.6
     min. leaf data size : 0
     max. leaf data size : 35534
     min. leaf extent    : 9.87306
     max. leaf extent    : 413.195
SplitHeuristics Stats: 
     splits            : 599
     avg. split ratio  (0,0.5] : 0.297657
     avg. point ratio  [0,0.5] : 0.492414
     avg. extent ratio (0,1]   : 0.312965
     tries / calls     : 5391/600 = 8.985
Neighbour Stats (if computed): 

     min. leaf neighbours    : 4
     max. leaf neighbours    : 37
     avg. leaf neighbours    : 12.9233
(Built with methods: midpoint, median,geometric mean, full split heuristic optimization) 
```

注意解释！并查看示例[File](https://github.com/gabyx/ApproxMVBB/blob/master/example/kdTreeFiltering/src/main.cpp "文件")中使用的设置。然而，与其他人的结果相比：14*10⁶ 点约 3100 毫秒是相当光滑的 :-)

使用的处理器：Intel® Core™ i7 CPU 970 @ 3.20GHz × 12 , 12GB Ram**

# file-upload - 我正在使用精细的上传插件，上传后无法使用删除文件功能

> ID：15124901
> 
> 赞同：0
> 
> 时间：2013-02-27T23:53:23.620
> 
> 标签：file-upload, fine-uploader

根据他们的文档[http://blog.fineuploader.com/2013/01/25/delete-an-uploaded-file-in-3-3/](http://blog.fineuploader.com/2013/01/25/delete-an-uploaded-file-in-3-3/)，有要删除的文件的 UUID 发送服务器与 teh delte要求。但是我一整天都在尝试，但我无法让它工作。

例如，这里是文件“1a2c636f-04f0-48c3-956f-22274a93b82f”的 UUID，我不知道如何使用它来删除文件。是否应该首先使用某种形式的功能对其进行解密。

这可能是一件简单的事情，但我不知道该怎么做。

提前谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T03:14:51.667

文件的 UUID 与每个请求一起传递。您必须将此 UUID 与实际的文件服务器端相关联。当 DELETE 请求进来时，找到与传递的 UUID 关联的文件，将其删除，并返回 200 响应。

再次查看[服务器端自述](http://docs.fineuploader.com/integrating/server/)文件，我意识到每个请求中是否存在此参数可能没有很好地记录。我刚刚更新了文档以添加对该参数的另一个引用。

# solr - Solr4.1 无法删除超过 30 天的文档

> ID：15124903
> 
> 赞同：0
> 
> 时间：2013-02-27T23:53:24.843
> 
> 标签：solr

我正在运行 Solr4.1。我确实有一个*版本*字段，但我不明白如何通过关于时间的查询来删除。我的架构中没有任何字段，其中包含我可以看到的时间戳。

我要做的是运行一个查询，删除所有早于 30 天的文档。

我已经尝试了所有可以在网上找到的东西。

```
curl http://localhost:8983/solr/update?commit=true -H "Content-Type: text/xml" --data-binary '<delete><query>_version_:[* TO NOW-60DAYS] </query></delete>'

curl http://localhost:8983/solr/update?commit=true -H "Content-Type: text/xml" --data-binary '<delete><query>timestamp:[* TO NOW-60DAYS] </query></delete>'

curl http://localhost:8983/solr/update?commit=true -H "Content-Type: text/xml" --data-binary '<delete><query>createTime:[* TO NOW-60DAYS] </query></delete>' 
```

其他删除工作正常，例如

```
curl http://localhost:8983/solr/update?commit=true -H "Content-Type: text/xml" --data-binary '<delete><query>field:value</query></delete>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T01:27:22.070

您可以启用包含在 schema.xml 中的时间戳字段，只是将其注释掉。每次将文档插入索引时，该字段都会自动填充当前日期时间。在您的 schema.xml 中查找以下内容：

```
 <!-- Uncommenting the following will create a "timestamp" field using
      a default value of "NOW" to indicate when each document was indexed.
   -->
 <!--
 <field name="timestamp" type="date" indexed="true" stored="true" 
    default="NOW" multiValued="false"/>
 --> 
```

您需要重新索引您的文档，以便它们设置此值。

# java - 使用数据库数据填充 jTable

> ID：15124904
> 
> 赞同：1
> 
> 时间：2013-02-27T23:53:30.500
> 
> 标签：java, swing, jdbc, jtable, defaulttablemodel

我正在尝试使用我的 Derby 数据库数据填充 Netbeans GUI-builder jTable。

我在我的 Account.java 类中使用以下代码：

```
public DefaultTableModel getData() {
    try {
        String stmt = "SELECT * FROM APP.DATAVAULT";
        PreparedStatement ps = Main.getPreparedStatement(stmt);
        ResultSet rs = ps.executeQuery();
        ResultSetMetaData md = rs.getMetaData();
        int columnCount = md.getColumnCount();
        Vector columns = new Vector(columnCount);
        //store column names  
        for (int i = 1; i <= columnCount; i++) {
            columns.add(md.getColumnName(i));
        }

        Vector data = new Vector();
        Vector row;
        while (rs.next()) {

            row = new Vector(columnCount);
            for (int i = 1; i <= columnCount; i++) {
                row.add(rs.getString(i));
            }
            data.add(row);

            //Debugging                
        }

        // List.setModel(tableModel);

        ps.close();
        rs.close();
    } catch (SQLException e) {
        System.out.println(e.getMessage());
    }
    DefaultTableModel tableModel = new DefaultTableModel(data, columns);
    return tableModel;
} 
```

理想情况下，我希望能够返回带有参数数据和列的 tableModel，因为我知道在我的 GUI 中执行此方法是不好的做法。所有在线教程都没有显示如何将数据发送到另一个类，它们只是在 GUI 类中编写数据库代码。

我有一个错误，它看不到数据和列，因为它们是在我的方法的不可访问部分中声明和使用的。完成此操作后，我需要找到一种方法将其传递给我的 GUI 类并为我的 jTable 设置模型，该模型由 Netbeans GUI builder 制作。

我一直在这个网站上寻找答案，我尝试了很多解决方案。但是，由于我对系统进行编码的方式，我似乎从来没有得到任何工作。我也尝试过其他网站，例如：

[http://tips4java.wordpress.com/2009/03/12/table-from-database/](http://tips4java.wordpress.com/2009/03/12/table-from-database/)

[http://chang.advits.com/populate-data-from-database-into-jtable-in-netbeans](http://chang.advits.com/populate-data-from-database-into-jtable-in-netbeans) <这本来是理想的，但它不起作用。我跟着它去了一个发球台！

并查看了 jTable、DefaultTableModel 和 ResultSetTableModel 的 Javadocs——我从来没有尝试过自己通过学习等来做这件事......

我怎样才能用我为我的系统建模的方式来做到这一点？另外，无论如何要修复我的方法还是应该完全废弃它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T00:16:30.157

因此，您需要某种方式来“告诉”表格已经加载了模型。您可以使用侦听器回调机制，但使用 a 可能更容易`SwingWorker`。

这将允许您在后台线程中调用数据库，并在完成后从 EDT 中更新 UI。

```
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.util.Vector;
import java.util.concurrent.ExecutionException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JTable;
import javax.swing.SwingWorker;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableModel;
import sun.applet.Main;

public class DataLoadWorker extends SwingWorker<TableModel, TableModel> {

    private final JTable table;

    public DataLoadWorker(JTable table) {
        this.table = table;
    }

    @Override
    protected TableModel doInBackground() throws Exception {
        Vector data = new Vector();
        Vector columns = new Vector();
        PreparedStatement ps = null;
        ResultSet rs = null;
        try {
            String stmt = "SELECT * FROM APP.DATAVAULT";
            ps = Main.getPreparedStatement(stmt);
            rs = ps.executeQuery();
            ResultSetMetaData md = rs.getMetaData();
            int columnCount = md.getColumnCount();
            //store column names  
            for (int i = 1; i <= columnCount; i++) {
                columns.add(md.getColumnName(i));
            }

            columns.ensureCapacity(columnCount);

            Vector row;
            while (rs.next()) {

                row = new Vector(columnCount);
                for (int i = 1; i <= columnCount; i++) {
                    row.add(rs.getString(i));
                }
                data.add(row);

                //Debugging                
            }

            // List.setModel(tableModel);

        } finally {
            try {
                ps.close();
            } catch (Exception e) {
            }
            try {
                rs.close();
            } catch (Exception e) {
            }
        }

        DefaultTableModel tableModel = new DefaultTableModel(data, columns);
        return tableModel;
    }

    @Override
    protected void done() {
        try {
            TableModel model = get();
            table.setModel(model);
        } catch (InterruptedException | ExecutionException ex) {
            ex.printStackTrace();
        }
    }
} 
```

你的例子也行不通。

`Vector`s`columns`和`data`是在 的上下文中声明的，`try-catch`这意味着它们对方法的其余部分不可见，因此`DefaultTableModel tableModel = new DefaultTableModel(data, columns);`不会编译。

您至少应该转储任何异常的堆栈跟踪，它将帮助您找到实际错误的位置，因此`System.out.println(e.getMessage());`您应该使用`e.printStackTrace();`. 更好的解决方案是使用`Logger`来自 JDK 或第三方记录器（如`log4j`.

你也是资源，也就是说，如果你打开它，你就应该关闭它。当您调用`ps.close()`and`rs.close()`时，如果出于某种原因发生异常，它们将不会被调用，从而使资源保持打开状态。

将这些添加到`finally`您的块中`try-catch`以确保它们已关闭并尽最大努力关闭它们。

# tsql - 更改表 xyz 删除列

> ID：15124906
> 
> 赞同：0
> 
> 时间：2013-02-27T23:53:32.883
> 
> 标签：tsql, sql-server-2000

我有一个包含 200 列的表，我必须从该表中删除 96 列。

使用语句

```
alter table XYZ drop column a,b,c,d................... 
```

正在永远删除 SQL Server2000 上的列

任何人都可以帮助或给我一些想法如何有效地做到这一点..

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:00:39.463

对于任何 RDBMS 来说，这都不是一个微不足道的改变，而且可能需要一段时间。根据平台的不同，如果有很多行并且您要删除的列包含非空数据，也可能会加剧这种情况。

也许将要保留的列选择到新表中，删除该列，然后将新表重命名为原始表名会更可行。

*故意写成通用的答案*

# android - 如何确保您的 Android Google Maps API 密钥工作正常

> ID：15124908
> 
> 赞同：0
> 
> 时间：2013-02-27T23:53:52.430
> 
> 标签：android, google-maps-android-api-2, api-key

我有一个用于 android 的活动 Google Maps v2 API 密钥，但是当我运行代码时它总是显示

找不到 com.google.settings 的提供商信息

找不到 com.google.settings 的提供商信息

在测试之前如何检查我的 API 密钥是否正常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T23:58:19.200

如果您使用此处的示例项目`<android-sdk>/extras/google-play-services/samples/maps`并将您的密钥放在所需的位置（我认为清单中需要它）是测试您的密钥的好方法，因为您知道 google 提供的示例项目可以工作。

# redirect - 将 domain.com/index.php/xyz 重定向到 domain.com/xyz

> ID：15124910
> 
> 赞同：0
> 
> 时间：2013-02-27T23:54:02.037
> 
> 标签：redirect

嗨，我使用以下 index.php 重定向到主页（及其工作）

重写条件 %{THE_REQUEST} ^。*/index.php\ HTTP/ RewriteRule ^(.* )index.php$ /$1 [R=301,L]

我希望它的子页面也将示例 index.php/xyz 重定向到 home/xyz

请帮我如何修改上面的代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:02:47.750

在规则的末尾添加：

RewriteRule ^index.php/(.*) $1 [NS,NC,L,R=301]

# c++ - 具有索引值的线性搜索返回数组位于

> ID：15124912
> 
> 赞同：-1
> 
> 时间：2013-02-27T23:54:17.503
> 
> 标签：c++, algorithm, function, search, pointers

我尝试了一个程序来返回一个数组，其中包含找到特定输入值的数组的索引，但是每次运行都会导致错误，这似乎是无限的运行时间。该错误似乎是在打印出找到的最后一个索引后立即发生的。

任何人都可以帮忙吗？（旁注：我已经看过多页关于删除指针的内容；我应该在这里这样做吗？）

忘了提 - 我希望返回数组的第一个插槽保存数组的大小，以便稍后在程序中轻松访问它

```
#include <iostream>
#include <vector>
using namespace std;

int* linearSearch(int* n, int k, int f) {
    // Input: Index 0 Address ; Size of Array; Element to Search
    // Output: Array of Found Indicies
    vector <int> a;
    int* b;
    for(int i = 0; i < k; i++)
        if(n[i] == f)
            a.push_back(i);
    *b = a.size();
    for(int i = 0; i < a.size(); i++)
        b[i + 1] = a[i];
    return b;
}

int main() {
    int c[10] = {4, 4, 6, 3, 7, 7, 3, 6, 2, 0};
    int* k = linearSearch(&c[0], sizeof(c)/sizeof(int), 4);
    for(int i = 0; i < k[0]; i++) {
        cout << "Found at index: " << k[i + 1] << endl;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:59:44.863

您正在写入从未声明过的堆内存。

```
int* b; 
```

该指针从未被初始化，指向一个未定义的内存地址。然后，当您使用索引运算符分配匹配项时，您将写入未定义内存地址之后的后续字节。

您需要使用“new[]”运算符分配空间来存储结果。此外，如果您正确地声明了内存，您会将匹配结果的数量分配给结果数组中的第一个元素——这似乎不是您的意图。

看看 C++ 中使用 new [] 运算符的动态内存分配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T23:57:05.867

```
int* b;
....
*b = a.size(); 
```

`b`必须分配。尝试以下操作：

```
int* b = new int[a.size() + 1];
b[0] = a.size(); 
```

我明白你的意思了。`b`在第一个元素中会有神奇的长度。这在 Pascal/Delphi 中是这样，但在 C/C++ 中不是这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T00:06:20.767

这并不完美，但这更接近于正确的实现，您应该能够通过一些工作更进一步：

```
#include <iostream>
#include <vector>
using namespace std;

std::vector<int> linearSearch(int* n, int k, int f)
{
  vector <int> a;

  for(int i = 0; i < k; i++)
  {
      if(n[i] == f)
      {
          a.push_back(i);
      }
  }

  return a ;
}

int main() {
  int c[10] = {4, 4, 6, 3, 7, 7, 3, 6, 2, 0};
  std::vector<int> result = linearSearch(&c[0], sizeof(c)/sizeof(int), 4);

  for(unsigned int i = 0; i < result.size(); i++)
  {
      cout << "Found at index: " << result[i + 1] << endl;
  }
  return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T00:07:34.973

如果您仍然使用 std::vector，为什么不在最需要的地方使用它呢？此外，如果您不打算通过该指针修改数组，请通过 const 指针表示：

```
std::vector<int> linearSearch(const int* n, int k, int f)
{
   std::vector<int> res;
   for(int i = 0; i < k; i++)
        if(n[i] == f) res.push_back(i);
   return res;
}

int main() {
    int c[10] = {4, 4, 6, 3, 7, 7, 3, 6, 2, 0};
    std::vector<int> k = linearSearch(&c[0], sizeof(c)/sizeof(int), 4);
    for(int i = 0; i < k.size(); i++) {
        cout << "Found at index: " << k[i] << endl;
    }
    return 0;
} 
```

# r - 修复具有不同拼写等的字符串变量

> ID：15124913
> 
> 赞同：0
> 
> 时间：2013-02-27T23:54:18.407
> 
> 标签：r

我有一个包含个人姓名、地址、电话号码等的数据集。有些人出现多次，姓名/和/或收件人和/或电话号码略有不同。假数据的片段如下所示：

```
first       last    address         phone    
Jimmy       Bamboo  P.O. Box 1190   xxx-xx-xx00
Jimmy W.    Bamboo  P.O. Box 1190   xxx-xx-xx22
James West  Bamboo  P.O. Box 219    xxx-66-xxxx 
```

... 等等。有时 E. 拼写为east，St. 拼写为 Street，有时则不是。

我需要做的是遍历近 120,000 行数据，以根据他们的姓名、地址和电话号码识别每个唯一的个体。任何人都知道如何在不手动运行每条记录的情况下完成此操作，一次一个？我盯着它看的越多，我就越认为如果不做出一些判断并说如果至少有两个或三个字段相同，则将其视为一个人是不可能的。

谢谢！！

阿尼

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T00:33:21.517

正如我在评论中提到的，这并非微不足道。您必须在程序员时间/解决方案复杂性与结果之间做出权衡。你不会达到 100% 的结果。你只能接近它，时间和复杂性成本会随着你接近 100% 的增加而增加。从一个简单的解决方案（精确匹配）开始，看看最常导致错过匹配的问题。实施一个模糊的解决方案来解决这个问题。冲洗并重复。

您可以使用多种工具（我们都使用它们）。

1）距离匹配，如[Damerau Levenshtein](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)。您可以将其用于姓名、地址和其他内容。它处理错误，如换位、次要拼写、省略字符等。

2）[拼音词匹配](http://en.wikipedia.org/wiki/Phonetic_algorithm)——soundex不好。还有其他更高级的。我们最终编写了自己的代码来处理我们经常遇到的混合种族。

3）昵称查找 - 许多昵称不会被语音或距离匹配捕获 - 像 Fanny for Frances 这样的名字。有很多这样的昵称。您可以建立对常规名称的昵称查找。考虑像 Jennifer -> Jen、Jenny、Jennie、Jenee 等这样的变化。

名字可能很难。名称的创造性拼写似乎是当前的时尚。例如，我们的数据库有超过 30 种名称 Kaitlynn 的拼写变体，它们都是真实姓名的拼写。当您尝试将 Katy 与其中任何一个匹配时，这使得昵称匹配变得困难。

以下是我在 stackoverflow 上就类似主题所做的其他一些答案：

[处理蒙古语姓名](https://stackoverflow.com/questions/12427240/processing-of-mongolian-names)

[如何解决在 MySQL 中存储人名的困境，同时保持可辨别性和对相似名称的搜索？](https://stackoverflow.com/questions/6868748/how-to-solve-dilemma-of-storing-human-names-in-mysql-and-keep-both-discriminabil)

[MySQL 将 Damerau–Levenshtein Fuzzy 与 Like 通配符混合](https://stackoverflow.com/questions/14261580/mysql-mixing-dameraulevenshtein-fuzzy-with-like-wildcard)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:02:04.990

您可以计算 Levenshtein 距离的成对矩阵。

有关更多信息，请参阅此最近的帖子：http: [//www.markvanderloo.eu/yaRb/2013/02/26/the-stringdist-package/](http://www.markvanderloo.eu/yaRb/2013/02/26/the-stringdist-package/)

# sql - 查询以在单行中获取用户信息和角色列表

> ID：15124918
> 
> 赞同：0
> 
> 时间：2013-02-27T23:54:40.303
> 
> 标签：sql, postgresql

我被要求在 Postgresql 9.2 上开发一个查询，我只接触过这个查询，它将返回一个用户信息（从`users`表中）以及他们的角色（从`role`表中 - 一个用户可能有很多角色）在一个单一的排。我所拥有的是：

```
[user table] --> [user_role table] <-- [role table]
users table: id, firstname, lastname, username, ... ; 
user_role table: id, user_id (fk to user); 
role_id (fk to role); role table: id, name; 
```

我需要得到的是：

```
users.firstname, users.lastname, users.username, users....(other user info),
role.name, role.name (one role name for each role a user has). 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:09:50.447

像这样的东西，我希望：

```
SELECT u.id, u.firstname, u.lastname, array_agg(r.name)
FROM user u 
LEFT OUTER JOIN user_role ur ON (u.id = ur.user_id)
LEFT OUTER JOIN role r ON (ur.role_id = r.id)
GROUP BY u.id; 
```

您可能想要`string_agg`而不是`array_agg`取决于所需的输出格式。

由于您没有提供示例数据，因此未经测试。如果您使用的是旧 PostgreSQL 版本，则还需要明确指定列表中`user`出现的每一列。`SELECT``GROUP BY`

请注意，角色在单个列中返回。这是必要的；不支持动态宽度表，其中不同的行可以有不同的宽度。您可以使用几乎任何您喜欢的格式来生成结果 - 分隔文本、xml、json、hstore、数组等。

您的列是完全没有必要的，除非您正在处理无法处理复合主键的愚蠢 ORM，否则`user_role.id`应该将其替换为。`PRIMARY KEY(user_id, role_id)`

# arrays - 来自不规则范围的随机数 C

> ID：15124919
> 
> 赞同：1
> 
> 时间：2013-02-27T23:54:58.320
> 
> 标签：arrays, random, numbers

您好，我如何使用 C 中的数组从一组特定数字中随机获取数字？比如说，我想从一组这些数字中生成 50 个数字：

```
52 67 80 87 90 95 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:57:44.583

1.  制作一个大小为 n 的数组 A 来存储任意集合，例如 { 52, 67, 80, 87, 90, 95 }
2.  保存固定数组的长度 l 例如，6
3.  制作一个从 0 到长度互斥的随机数 r
4.  项目 = A[r] 其中 r = rand % l

# php - 匹配不区分大小写的精确短语与空格

> ID：15124922
> 
> 赞同：4
> 
> 时间：2013-02-27T23:55:04.033
> 
> 标签：php, regex, preg-match

如果我有一个字符串`"Hello I went to the store today"`并且我有一个匹配数组

```
$perfectMatches = array("i went","store today"); 
```

它应该匹配这两个。（数组可能会变得很大，所以我更喜欢在 1 个 preg_match 中完成）

编辑：得到这个工作！谢谢！

```
preg_match_all("/\b(" . implode($perfectMatches,"|") . ")\b/i", $string, $match1) 
```

我还需要一个很难解释的单独的正则表达式。说我有一个数组

```
$array = array("birthday party","ice cream");//this can be very long 
```

如果“生日”和“派对”以及字符串中的任何位置，是否可以获得匹配字符串的正则表达式？

所以它应该匹配“嗨，今天是我的生日，我要去参加一个派对”？但是在 1 preg_match 中也有“冰淇淋”？

谢谢

编辑：示例...

用户提交了一个项目的描述，我想检查垃圾邮件。我知道大多数垃圾邮件帖子都有“个人支票”或“特价”之类的短语，所以我想获取所有这些短语的列表并与描述进行检查。如果描述中有我列表中的任何短语，它将被标记为垃圾邮件。这种情况适用于我想要的第一个正则表达式。

第二个正则表达式是如果我知道某些垃圾邮件帖子在某处有“减肥”“体重”“快速”等词，不必按任何顺序排列，但这三个词在描述中。因此，如果我得到这些短语“快速减肥”、“需要信用卡”的列表并与描述进行核对，我可以将其标记为垃圾邮件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T09:38:47.417

听起来您的问题的第 1 部分已经解决，因此此答案仅关注第 2 部分。据我了解，您正在尝试确定给定的输入消息是否包含任何顺序的所有单词列表。

这可以通过正则表达式和`preg_match`每条消息的单个来完成，但是如果您有大量单词列表，则效率非常低。如果 N 是您要搜索的单词数，M 是消息的长度，那么算法应该是 O(N*M)。*如果您注意到，每个*关键字的正则表达式中有两个 `.*`术语。使用前瞻断言，正则表达式引擎必须为每个关键字遍历一次。这是示例代码：

 *```
<?php

// sample messages
$msg1 = "Lose all the weight all the weight you want.  It's fast and easy!";
$msg2 = 'Are you over weight? lose the pounds fast!';
$msg3 = 'Lose weight slowly by working really hard!';

// spam defining keywords (all required, but any order).
$keywords = array('lose', 'weight', 'fast');

//build the regex pattern using the array of keywords
$patt = '/(?=.*\b'. implode($keywords, '\b.*)(?=.*\b') . '\b.*)/is';

echo "The pattern is: '" .$patt. "'\n";
echo 'msg1 '. (preg_match($patt, $msg1) ? 'is' : 'is not') ." spam\n";
echo 'msg2 '. (preg_match($patt, $msg2) ? 'is' : 'is not') ." spam\n";
echo 'msg3 '. (preg_match($patt, $msg3) ? 'is' : 'is not') ." spam\n";
?> 
```

输出是：

```
The pattern is: '/(?=.*\blose\b.*)(?=.*\bweight\b.*)(?=.*\bfast\b.*)/is'
msg1 is spam
msg2 is spam
msg3 is not spam 
```

第二种解决方案似乎更复杂，因为代码更多，但正则表达式要简单得多。它没有前瞻断言，也没有`.*`条款。该`preg_match`函数在`while`循环中被调用，但这并不是什么大问题。每条消息只遍历一次，复杂度应该是 O(M)。这也可以使用单个`preg_match_all`函数来完成，但是您必须执行 an`array_search`才能获得最终计数。

```
<?php

// sample messages
$msg1 = "Lose all the weight all the weight you want.  It's fast and easy!";
$msg2 = 'Are you over weight? lose the pounds fast!';
$msg3 = 'Lose weight slowly by working really hard!';

// spam defining keywords (all required, but any order).
$keywords = array('lose', 'weight', 'fast');

//build the regex pattern using the array of keywords
$patt = '/(\b'. implode($keywords,'\b|\b') .'\b)/is';

echo "The pattern is: '" .$patt. "'\n";
echo 'msg1 '. (matchall($patt, $msg1, $keywords) ? 'is' : 'is not') ." spam\n";
echo 'msg2 '. (matchall($patt, $msg2, $keywords) ? 'is' : 'is not') ." spam\n";
echo 'msg3 '. (matchall($patt, $msg3, $keywords) ? 'is' : 'is not') ." spam\n";

function matchall($patt, $msg, $keywords)
{
  $offset = 0;
  $matches = array();
  $index = array_fill_keys($keywords, 0);
  while( preg_match($patt, $msg, &$matches, PREG_OFFSET_CAPTURE, $offset) ) {
    $offset = $matches[1][1] + strlen($matches[1][0]);
    $index[strtolower($matches[1][0])] += 1;
  }
  return min($index);
}
?> 
```

输出是：

```
The pattern is: '/(\blose\b|\bweight\b|\bfast\b)/is'
msg1 is spam
msg2 is spam
msg3 is not spam 
```*

# android - android ClassNotFoundException：找不到类

> ID：15124924
> 
> 赞同：12
> 
> 时间：2013-02-27T23:55:18.617
> 
> 标签：android

```
 02-28 01:49:27.741: E/AndroidRuntime(23024): FATAL EXCEPTION: main
    02-28 01:49:27.741: E/AndroidRuntime(23024): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.appname.android/com.appname.android.ITCutiesReaderAppActivity}: java.lang.ClassNotFoundException: Didn't find class "com.appname.android.ITCutiesReaderAppActivity" on path: /data/app/com.appname.android-2.apk
    02-28 01:49:27.741: E/AndroidRuntime(23024):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2106)
    02-28 01:49:27.741: E/AndroidRuntime(23024):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
...
    02-28 01:49:27.741: E/AndroidRuntime(23024):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
    02-28 01:49:27.741: E/AndroidRuntime(23024):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
    02-28 01:49:27.741: E/AndroidRuntime(23024):    at dalvik.system.NativeStart.main(Native Method)
    02-28 01:49:27.741: E/AndroidRuntime(23024): Caused by: java.lang.ClassNotFoundException: Didn't find class "com.appname.android.ITCutiesReaderAppActivity" on path: /data/app/com.appname.android-2.apk
    02-28 01:49:27.741: E/AndroidRuntime(23024):    at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:65)
    02-28 01:49:27.741: E/AndroidRuntime(23024):    at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
    02-28 01:49:27.741: E/AndroidRuntime(23024):    at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
    02-28 01:49:27.741: E/AndroidRuntime(23024):    at android.app.Instrumentation.newActivity(Instrumentation.java:1054)
    02-28 01:49:27.741: E/AndroidRuntime(23024):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2097)
    02-28 01:49:27.741: E/AndroidRuntime(23024):    ... 11 more 
```

在删除具有相同应用程序文件的应用程序文件夹中的额外文件夹（并更改应用程序名称，所有文件中的固定名称）后，我开始收到此错误。我怎样才能解决这个问题？

这是 manifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.appname.android"
    android:versionCode="3"
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="7" />
    <uses-permission android:name="android.permission.INTERNET"/>
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name">
        <activity
            android:name=".ITCutiesReaderAppActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".ItemDescriptionActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
            </intent-filter>
            </activity>
    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-28T00:29:29.760

您*确实*有包不匹配错误，它需要是：

```
package="com.haber29.android.reader" 
```

因为`reader`是下一个子包，*这*是包含活动的子包。

并且不要忘记，您可以为每个 Activity 指定完全限定名称，以防止混淆：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.haber29.android"
    android:versionCode="3"
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="7" />
    <uses-permission android:name="android.permission.INTERNET"/>
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name">
        <activity
            android:name="com.haber29.android.reader.ITCutiesReaderAppActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.haber29.android.reader.ItemDescriptionActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
            </intent-filter>
            </activity>
    </application>
</manifest> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-20T06:34:24.967

我今天也有同样的问题，因为我的库包含`android-support-v4.jar`与我的演示不匹配的内容。我删除了库`android-support-v4.jar`并复制了我的演示 jar 并将其放入我的库中，它开始工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-27T07:34:13.810

就我而言，我的防病毒软件（Mac 版 Avira）在我每次构建后都会抓取 dex 文件并将它们隔离。在我停止 Avira 后，我的项目将构建并运行。

# ruby - 示例中的 Ruby 中的 print 和 puts 有什么区别？

> ID：15124925
> 
> 赞同：1
> 
> 时间：2013-02-27T23:55:20.503
> 
> 标签：ruby

可能这是一个重复的问题，Ruby 中的 print 和 puts 有什么区别？我可以用例子回答吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:09:33.760

这很简单。`puts`打印时自动附加换行符。`print`不加修改地打印字符串。

另一个区别在于底层写操作的数量。`puts`（大致）相当于：

```
STDOUT.write(str)
STDOUT.write("\n") 
```

并且`print`（大致）相当于：

```
STDOUT.write(str) 
```

因此，在多线程环境中，`puts`可以创建一些看起来很奇怪的东西，例如：

```
Message1Messa
ge2
(blank line) 
```

虽然`print`ing 带有串联换行符的字符串会产生：

```
Message1
Message2 
```

除此之外，它们是相同的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:58:17.350

`print`不会在末尾添加换行符..`puts`会。

大多数其他语言也有类似的结构。

Java 有`System.out.println()`和`System.out.print()`

C# 有`Console.WriteLine()`和`Console.Write()`

帕斯卡有`Writeln()`和`Write()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T23:58:03.397

```
irb(main):014:0> class Person
irb(main):015:1>  attr_accessor :name, :age, :gender
irb(main):016:1> end
=> nil
irb(main):017:0> person = Person.new
=> #<Person:0x2bf03e0>
irb(main):018:0> person.name = "Robert"
=> "Robert"
irb(main):019:0> person.age = 52
=> 52
irb(main):020:0> person.gender = "male"
=> "male"

irb(main):021:0> puts person
#<Person:0x2bf03e0>
=> nil
irb(main):022:0> print person
#<Person:0x2bf03e0>=> nil
irb(main):023:0> print person.name
Robert=> nil
irb(main):024:0> puts person.name
Robert
=> nil 
```

print 和 puts 之间的区别在于 puts 自动将输出光标移动到下一行（也就是说，它添加一个换行符来开始一个新行，除非字符串已经以换行符结尾），而 print 继续将文本打印到同一行与上次一样。

puts 不以完成该方法的类或对象的名称为前缀，而 puts 是从 Kernel 模块提供的方法，默认情况下包含和搜索，因此通常您不需要使用 Kernel。提出参考它。

```
Kernel.puts "Hello, world!" 
```

puts 只接受一个参数，并且很少跟随其他方法或逻辑，因此括号不是绝对必要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-22T12:02:16.207

一般而言，puts 和 print 之间有两个主要区别。

**1.新线**

`puts`获取每个元素并在换行符中打印（最后没有指定换行符的需要`"\n"`）

而 print 不会在新行中打印每个元素，除非程序员明确指定它。

```
puts "Hello, Welcome to Ruby" 
```

**输出：**

```
 Hello, Welcome to Ruby
 Dell-System-XPS:~/Documents/2016RoR/Ruby$

print "Hello, Welcome to Ruby" 
```

**输出：**

```
 Hello, Welcome to RubyDell-System-XPS:~/Documents/2016RoR/Ruby$ 
```

你注意到了吗，输出后没有新行。但是，当您明确提及新行字符时，新行应该可以工作，如下所示

```
print "Hello, Welcome to Ruby \n" 
```

**输出：**

```
Hello, Welcome to Ruby
Dell-System-XPS:~/Documents/2016RoR/Ruby$ 
```

**2\. 空字符或 NIL 值**

`print`语句打印空值或 NIL 值，但 puts 语句如果它们包含值则不会打印它们`NIL`。

```
> print [nil, 33,44,55]
> [nil, 33, 44, 55] => nil 

 > puts [nil, 33,44,55]
 >  33
 >  44
 >  55
 => nil 
```

“你看到了区别，使用时没有打印 NIL 值`puts`”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T23:59:20.607

可以在[print 与 put](http://mattberther.com/2009/02/11/puts-vs-print-in-ruby)中看到比较。例如看一下[Ruby 中的 Input & output](http://zetcode.com/lang/rubytutorial/io/)。

# php - mysql多查询和mysql_insert_id()？

> ID：15124927
> 
> 赞同：0
> 
> 时间：2013-02-27T23:55:31.843
> 
> 标签：php, mysql, mysqli, mysql-insert-id

嗨，我用多个查询复制一行，并希望从结果中获取 mysql_insert_id()。复制工作正常，但我似乎无法从中获取最后一个 id。

这是我的代码：

```
 $mysqli = new mysqli("localhost", "xxxx", "xxxx", "xxxx");

if ($mysqli->connect_errno) {
    echo($error_page_header);
    echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
    echo($error_page_footer);
    exit;
}

$sql = "CREATE TEMPORARY TABLE tmp ENGINE=MEMORY SELECT * FROM test_table WHERE id=1; ";
$sql.= "UPDATE tmp SET id=NULL; ";
$sql.= "INSERT INTO test_table SELECT * FROM tmp; ";
$sql.= "DROP TABLE tmp; ";

if (!$mysqli->multi_query($sql)) {
    echo($error_page_header);
    echo "Multi query failed: (" . $mysqli->errno . ") " . $mysqli->error;
    echo($error_page_footer);
    exit;

} do {
    if ($res = $mysqli->store_result()) {
        var_dump($res->fetch_all(MYSQLI_ASSOC));
        $res->free();
    }

} while ($mysqli->more_results() && $mysqli->next_result());    

echo( 'id: ' . mysql_insert_id() ); // prints 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:57:55.373

不要混淆..`ext/mysql`并且`mysqli`不兼容并且不能相互使用。使用[`$mysqli->insert_id`](http://www.php.net/manual/en/mysqli.insert-id.php)（它是每个连接）

# c# - 如何在不迭代的情况下将 Linq 结果转换为 DTO 类对象

> ID：15124931
> 
> 赞同：21
> 
> 时间：2013-02-27T23:55:48.813
> 
> 标签：c#, .net, linq, entity-framework

我正在构建一个 Web API 项目，该项目可供第三方使用，也可供我自己的 Web 应用程序使用。Web API 方法将返回复杂类型/对象的 JSON 表示。这些是我可以提供给第三方的预定义类，以便他们了解数据的结构并可以反序列化 JSON。在有人纠正我之前，我会将这些类称为 DTO 类。

我有以下自动生成的实体模型（来自数据库），这无论如何都是与 Scan 表有关系的 User 类（出于这个问题的目的，可以忽略关系）......

```
public partial class User
{
    public User()
    {
        this.Scans = new HashSet<Scan>();
    }

    public int Id { get; set; }
    public string Username { get; set; }
    public string Password { get; set; }
    public bool Active { get; set; }

    public virtual ICollection<Scan> Scans { get; set; }
} 
```

以及我想作为 List 返回到表示层的以下 DTO 类（我认为我不应该使用 IEnumerable 进行业务演示？）。

```
public class User
{
    public int Id;
    public string Username;
    public string Password;
    public bool Active;
} 
```

我的这个组件的业务层目前如下所示。使用 Linq 从数据库中获取用户，然后解析结果并返回 POCO 用户的 List<>。

```
public List<User> Get()
{
    List<User> userList = new List<User>();

    using (var db = new MyContext())
    {
        var query = from u in db.Users
                    orderby u.FirstName
                    select u;

        foreach (var item in query)
        {
            User user = new User();
            user.Id = item.pkUser;
            user.Username = item.Username;
            user.Password = item.Password;
            user.Active = item.Active;

            userList.Add(user);
        }
    }

    return userList;
} 
```

解析这样的结果似乎效率低下，而且我已经看到您可以在 Linq 查询中执行此类操作而无需迭代（例如，此问题[Mapping Linq Query results to a DTO class](https://stackoverflow.com/questions/9333005/mapping-linq-query-results-to-a-dto-class)中的答案）。

我不确定我应该在哪里/如何实现 IEnumerable 以在我的对象上启用这种类型的 Linq 查询，并且我也不确定如何编写与上面引用的问题中的查询类似的查询，但对于我更简单的场景。

提前感谢您的帮助。

PS 请忽略我通过 Web API 公开用户名和密码以及我同时返回所有用户的事实。以上是我的代码的简化版本，用于此问题。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-28T00:00:17.580

完整的方法可以是：

```
public List<User> Get()
{
    using (var db = new MyContext())
    {
        return (from u in db.Users
                orderby u.FirstName
                select new User()
                {
                    Id = u.pkUser,
                    Username = u.Username,
                    Password = u.Password,
                    Active = u.Active
                }).ToList();
    }
} 
```

你说你想要“没有迭代”的结果。使用 LINQ 也不会消除迭代。你没有在你的代码中这样做，但是当你调用`ToList()`方法时它确实发生了。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-27T23:58:48.967

您可以使用 LINQ to Objects 进行转换：

```
using (var db = new MyContext())
{
    var query = from u in db.Users
                orderby u.FirstName
                select u;

    return query.AsEnumerable().Select(item => 
                 new User 
                     { 
                        Id = item.pkUser,
                        Username = item.Username,
                        Password = item.Password,
                        Active = item.Active
                     }).ToList();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T00:07:47.770

如果我们使用[AutoMapper](http://automapper.org/) ，我们可以变得非常紧凑。

在您的存储库中引导映射器：

`Mapper.CreateMap<AutoGenNamespace.User, DtoNamespace.User>();`

然后就很简单了（返回 IEnumerable 也没什么问题）。

```
public IEnumerable<User> Get()
{
    using (var db = new MyContext())
    {
        return (from u in db.Users
                orderby u.FirstName
                select Mapper.Map(u)).AsEnumerable();
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-01-13T00:57:28.450

在我的查询中，我有多个孩子的父表。

```
public class TeamWithMembers
        {
            public int TeamId { get; set; }
            public string TeamName { get; set; }
            public string TeamDescription { get; set; }
            public List<TeamMembers> TeamMembers { get; set; }
        } 
```

在这种情况下，当我`ToList()`在 linq 查询中使用时，它给出了错误。现在我在 linq 查询中使用匿名类型并将其转换为像这样的下一个查询

```
List<TeamModel.TeamWithMembers> teamMemberList = teamMemberQueryResult.AsEnumerable().Select(item =>
new TeamModel.TeamWithMembers() {
    TeamId=item.TeamId,
    TeamName=item.TeamName,
    TeamMembers=item.TeamMembers.ToList()
}).ToList(); 
```

`teamMemberQueryResult`linq 查询的结果集在哪里。

# c# - 点阵印刷

> ID：15124932
> 
> 赞同：1
> 
> 时间：2013-02-27T23:55:50.223
> 
> 标签：c#, printing, dot-matrix

我喜欢很多人只需要在点阵打印机上打印文本。

我已经运行了[此处](http://support.microsoft.com/kb/322091)找到的示例。

它似乎可以工作，但只有 XP 它似乎不适用于 Wnidows 7。

我已经使用通用/纯文本打印到文件驱动程序进行了测试，因为我将无法访问我的打印机几个 dyas。在 XP 上，它要求我输入文件名，然后成功创建文件。在 Windows 7 上，文件卡在打印队列中，当您查看它时，它只会显示打印错误。我知道通用打印机驱动程序适用于 win7，因为我可以从我的文本编辑器打印到它。

短期的解决方案是使用直接连接到 LPT 端口，我还没有测试过，但最终的项目将在没有 LPT 端口的机器上运行。事实上，我们很快将评估一个新的爱普生，它将使用 USB 连接，所以 LPT 是不可能的。

在任何人建议使用图形之前，他们应该知道这是一个事件记录应用程序，需要一次打印一行。它不能等待一页文本在打印前准备好。

# c# - 验证使用 Moq 调用的通用方法

> ID：15124934
> 
> 赞同：9
> 
> 时间：2013-02-27T23:55:56.710
> 
> 标签：c#, moq, verify

我无法验证`IInterface.SomeMethod<T>(T arg)`使用`Moq.Mock.Verify`.

我可以使用`It.IsAny<IGenericInterface>()`or验证在“标准”接口上调用了该方法`It.IsAny<ConcreteImplementationOfIGenericInterface>()`，并且使用 验证泛型方法调用没有问题`It.IsAny<ConcreteImplementationOfIGenericInterface>()`，但我无法验证使用调用泛型方法`It.IsAny<IGenericInterface>()`- 它总是说该方法没有被调用并且单元测试失败。

这是我的单元测试：

```
public void TestMethod1()
{
    var mockInterface = new Mock<IServiceInterface>();

    var classUnderTest = new ClassUnderTest(mockInterface.Object);

    classUnderTest.Run();

    // next three lines are fine and pass the unit tests
    mockInterface.Verify(serviceInterface => serviceInterface.NotGenericMethod(It.IsAny<ConcreteSpecificCommand>()), Times.Once());
    mockInterface.Verify(serviceInterface => serviceInterface.NotGenericMethod(It.IsAny<ISpecificCommand>()), Times.Once());
    mockInterface.Verify(serviceInterface => serviceInterface.GenericMethod(It.IsAny<ConcreteSpecificCommand>()), Times.Once());

    // this line breaks: "Expected invocation on the mock once, but was 0 times"
    mockInterface.Verify(serviceInterface => serviceInterface.GenericMethod(It.IsAny<ISpecificCommand>()), Times.Once());
} 
```

这是我正在测试的课程：

```
public class ClassUnderTest
{
    private IServiceInterface _service;

    public ClassUnderTest(IServiceInterface service)
    {
        _service = service;
    }

    public void Run()
    {
        var command = new ConcreteSpecificCommand();
        _service.GenericMethod(command);
        _service.NotGenericMethod(command);
    }
} 
```

这是我的`IServiceInterface`：

```
public interface IServiceInterface
{
    void NotGenericMethod(ISpecificCommand command);
    void GenericMethod<T>(T command);
} 
```

这是我的接口/类继承层次结构：

```
public interface ISpecificCommand
{
}

public class ConcreteSpecificCommand : ISpecificCommand
{
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T03:09:01.670

这是当前发布版本 Moq 4.0.10827 中的一个已知问题。请参阅 GitHub [https://github.com/Moq/moq4/pull/25](https://github.com/Moq/moq4/pull/25)上的讨论。我已经下载了它的 dev 分支，编译并引用了它，现在你的测试通过了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T01:18:57.997

我要飞起来。由于`GenericMethod<T>`需要提供 T 参数，是否可以这样做：

```
mockInterface.Verify(serviceInterface => serviceInterface.GenericMethod(It.Is<object>(x=> typeof(ISpecificCommand).IsAssignableFrom(x.GetType()))), Times.Once()); 
```

# java - ActionListener 不为任何事情工作

> ID：15124935
> 
> 赞同：0
> 
> 时间：2013-02-27T23:55:57.990
> 
> 标签：java, swing, user-interface, awt, actionlistener

我对编程很陌生，我需要为宠物屋程序创建一个 GUI，允许用户添加、删除和排序记录。

问题是，无论出于何种原因，我`ActionListeners`都无法正常工作。GUI 可以很好地打开，但是如果我单击菜单项，则什么也没有发生。Quit MenuItem 不执行任何操作，添加动物也不执行任何操作。删除也不起作用（尽管这也可能是我的编程错误。）

这是代码：

```
import java.awt.Color;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTabbedPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.border.Border;
import javax.swing.table.DefaultTableModel;
import scrap.knockoff;

public class knockoff extends JFrame {

    private ButtonHandler handler;
    static int animals;
    static Color Backgroundcolor = Color.red;
    private JTable thelist;
    private JTextField search, breed, category, buyprice, sellprice;
    private JMenuBar menuBar;
    private JMenu menu;
    private JMenuItem menuAdd, menuDelete, menuQuit;
    private JLabel maintitle, breedquery, categoryquery, buypricequery, sellpricequery;
    private JButton sortbreed, sortcat, sortdog, sortratios, searchButton, add, delete, modify;
    private JPanel animalPane, sortPane, titlePane, searchPane, tablePane, optionPane;
    static Container container;
    static int recnumber;
    static String control[] = new String[100];
    static double buyprices, sellprices, profitratios;
    static String BreedName, CategoryName;
    static String Pets[][] = new String[50][5];

    public knockoff() {
        super("The Peel Pet House Program"); //This just changes the name at the top there.
        setSize(700, 600);
        Border paneEdge = BorderFactory.createEmptyBorder(0, 10, 10, 10);
        JTabbedPane tabbedPane = new JTabbedPane();
        tabbedPane.setLocation(0, 30);
        tabbedPane.setSize(200, 100);
        //These are our panels. The sortPane just keeps the buttons responsible for sorting the animals where they are. The animalPane is for the other functions (add, delete, whatnot) and the title pane
        //just holds the title. The AnimalPane is just a constant, it's there just so that the Animals menu process has a place to be. The Table Pane holds the table.
        tablePane = new JPanel();
        tablePane.setLocation(200, 35);
        tablePane.setSize(500, 500);
        titlePane = new JPanel();
        titlePane.setSize(700, 30);
        animalPane = new JPanel();
        Border greenline = BorderFactory.createLineBorder((Color.green).darker());
        animalPane.setBorder(greenline);
        animalPane.setLocation(0, 135);
        animalPane.setSize(200, 400);
        sortPane = new JPanel();
        sortPane.setBorder(paneEdge);
        search = new JTextField();
        searchButton = new JButton("Search");
        searchPane = new JPanel();
        FlowLayout searchLayout = new FlowLayout();
        searchPane.setLayout(searchLayout);
        searchPane.setBorder(paneEdge);
        search.setPreferredSize(new Dimension(190, 30));
        searchPane.add(search);
        searchPane.add(searchButton);
        optionPane = new JPanel();
        optionPane.setSize(100, 30);
        //This establishes our table
        String[] columns = {"Breed", "Category", "Buying Price", "Selling Price", "Profit Ratio"};
        thelist = new JTable(Pets, columns);
        JScrollPane listbrowser = new JScrollPane(thelist);
        tablePane.add(listbrowser);
        //These establish the buttons for our various sorting sprees.
        sortbreed = new JButton("Breed");
        sortcat = new JButton("Cat");
        sortdog = new JButton("Dog");
        sortratios = new JButton("Profit Ratio");
        sortPane.add(sortbreed);
        sortPane.add(sortcat);
        sortPane.add(sortdog);
        sortPane.add(sortratios);
        //Our ever reliable menu bar maker.
        menuBar = new JMenuBar();
        setJMenuBar(menuBar);
        menu = new JMenu("File");
        menuBar.add(menu);
        //The items of the file menu.
        menuQuit = new JMenuItem("Quit");
        menuQuit.addActionListener(handler);
        menu.add(menuQuit);
        //Animal Menu Creation
        menu = new JMenu("Animals");
        menuBar.add(menu);
        menuAdd = new JMenuItem("Add an Animal");
        menuAdd.addActionListener(handler);
        menu.add(menuAdd);
        menuDelete = new JMenuItem("Delete Animal");
        menuDelete.addActionListener(handler);
        menu.add(menuDelete);
        //Adding everything to the container now.
        Container container = getContentPane();
        container.setLayout(null);
        maintitle = new JLabel("The Piddly Penultimate Peel Pet House Program");
        titlePane.add(maintitle);
        container.setBackground(Backgroundcolor.darker()); //This just makes a darker version of red to set as the background on the Content Pane. Grey is boring.
        container.add(tablePane);
        container.add(titlePane);
        container.add(tabbedPane);
        container.add(animalPane);
        container.add(optionPane);
        tabbedPane.addTab("Sort By:", null, sortPane, "Sorts the Table");
        tabbedPane.addTab("Search", null, searchPane, "The Search Function");
    }

    public static void main(String args[]) {
        knockoff application = new knockoff();
        application.setVisible(true);
    }

    private class ButtonHandler implements ActionListener {

        public void actionPerformed(ActionEvent event) {
            if (event.equals("Add an Animal")) {
                addananimal();
            } else if (event.equals("Delete Animal")) {
                deleteanimal();
            } else if (event.getSource().equals(add)) //getsource relates to the button, it just makes it so that anybody programming can freely change the text of the button without worrying about this.
            {
                addanimal();
            } else if (event.getSource().equals(delete)) {
                deleteanimal();
            } else if (event.getSource().equals(sortbreed)) {
                breedsort();
            } else if (event.getSource().equals(sortcat)) {
            } else if (event.getSource().equals(sortdog)) {
            } else if (event.getSource().equals(sortratios)) {
            } else if (event.equals("Quit")) {
                hide();
                System.exit(0);
            }
        }
        //Add new Record Method

        public void addananimal() {
            container = getContentPane();
            //Plate cleaner. Or dishwasher.
            if (animalPane != null) {
                container.remove(animalPane);
            }
            animalPane = new JPanel();
            Border greenline = BorderFactory.createLineBorder((Color.green).darker());
            animalPane.setBorder(greenline);
            animalPane.setLocation(0, 135);
            animalPane.setSize(200, 400);
            FlowLayout animalLayout = new FlowLayout();
            animalPane.setLayout(animalLayout);
            breedquery = new JLabel("Add Animal Name:");
            categoryquery = new JLabel("Cat or Dog?");
            buypricequery = new JLabel("Buying Price:");
            sellpricequery = new JLabel("Selling Price:");
            animalPane.add(breedquery);
            breed = new JTextField(18);
            animalPane.add(breed);
            animalPane.add(categoryquery);
            category = new JTextField(18);
            animalPane.add(category);
            animalPane.add(buypricequery);
            buyprice = new JTextField(18);
            animalPane.add(buyprice);
            animalPane.add(sellpricequery);
            sellprice = new JTextField(18);
            add = new JButton("Add Animal");
            //The above list of .add and JComponent things were just to establish the
//            contents of our new animalPane.
            profitratios = Double.parseDouble(sellprice.getText()) / Double.parseDouble(buyprice.getText());
            //This just makes finding the profit ratio an autonomous action.
            add.addActionListener(handler);
            animalPane.add(add);
            container.add(animalPane);
            setVisible(true);
        }

        public void addanimal() {
            animals = animals + 1;
            Pets[animals][0] = breed.getText();
            Pets[animals][1] = category.getText();
            Pets[animals][2] = buyprice.getText();
            Pets[animals][3] = sellprice.getText();
            Pets[animals][4] = profitratios + "";
            breed.setText(" ");
            category.setText(" ");
            buyprice.setText(" ");
            sellprice.setText(" ");
            thelist.repaint(); //This is supposed to update the JTable in real time.
        }

        public void deleteanimal() {
            removeSelectedRows(thelist);
        }

        public void removeSelectedRows(JTable table) {
            DefaultTableModel model = (DefaultTableModel) table.getModel();
            int[] rows = table.getSelectedRows();
            for (int x = 0; x < rows.length; ++x) {
                model.removeRow(rows[x] - x);
            }
            for (int x = 0; x < animals; ++x) {
                if (Pets[x][0].equalsIgnoreCase(table.getValueAt(table.getSelectedRow(), 0) + "")) {
                    Pets[x][0] = null;
                    Pets[x][1] = null;
                    Pets[x][2] = null;
                    Pets[x][3] = null;
                    Pets[x][4] = null;
                }
            }
        }

        public void breedsort() {
            for (int x = 0; x < animals; ++x) {
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T00:04:11.423

你从不初始化`ButtonHandler`，这意味着每次你打电话时，`addActionListener(handler)`你实际上是在打电话`addActionListener(null)`

尝试在构造函数中初始化处理程序，然后再将其添加到任何内容......

```
public knockoff() {
    super("The Peel Pet House Program"); //This just changes the name at the top there.
    handler = new ButtonHandler(); 
```

**更新**

更好的是，改为查看[Action API](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T00:04:16.850

您没有在任何地方实例化和注册 ButtonHandler ......

# java - 我的自定义存储库实现中的 CrudRepository

> ID：15124937
> 
> 赞同：20
> 
> 时间：2013-02-27T23:56:06.967
> 
> 标签：java, spring, hibernate, spring-mvc, spring-data-jpa

我试图获取对在我的自定义实现 ( ) 中`UserRepository`扩展的存储库接口 () 的引用，以便访问 Spring JPA 提供的所有方法。`CrudRepository``UserRepositoryExtensionImpl`

粗扩展：

```
@Repository
public interface UserRepository extends CrudRepository<User, String>, UserRepositoryExtension<RosterUser> {
    ...any custom spring JPA methods...
} 
```

扩展接口：

```
@Repository
public interface UserRepositoryExtension <T> {
   public T put(T entity);
} 
```

自定义实现：

```
public class UserRepositoryExtensionImpl implements UserRepositoryExtension<User> {

    UserRepository userRepository;

    @Autowired
    public UserRepositoryExtensionImpl(UserRepository userRepository) {
        this.userRepository = userRepository;
    }

    @Override
    public User put(User user) {
        System.out.println(user + "was put");
        // ...put logic here
        return null;
    }...
} 
```

但是，我无法注入，`UserRepository`因为存在循环依赖项（假设`UserRepository`扩展了 my 实现的接口`UserRepositoryImpl`）。我收到以下错误：

```
org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name '    userRepositoryImpl': Requested bean is currently in creation: Is there an unresolvable circular     reference? 
```

一个可能但不太理想的解决方案是注入和`EntityManager`进入`UserRepositoryImp`，但在这种情况下，我无权访问由 提供的任何 Spring JPA 方法`CrudRepository`，或我可能在 UserRepository 中创建的任何其他方法。

关于如何解决这个问题的任何建议？

任何帮助将不胜感激。

编辑：正如@shelley 的回答中提到的，我能够通过进行 3 处更改来解决这个问题：

*   删除`@Repository`从`UserRepositoryExtensionImpl`
*   重命名`UserRepositoryExtensionImpl`为`UserRepositoryImpl`. 显然，这使 Spring 意识到实现的存在。参见[Spring 文档](http://static.springsource.org/spring-data/jpa/docs/current/reference/html/repositories.html#repositories.custom-implementations)
*   删除我的构造函数并将 移动`@Autowired`到该`userRepository`字段

成功！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-28T17:00:42.183

为了使它起作用，需要更改一些小事情：

*   从自定义存储库接口 ( ) 中删除`@Repository`注释。`UserRepositoryExtension`

*   自定义存储库实现实际上应该命名为“ `<StandardRepository>Impl`”而不是“ `<CustomRepository>Impl`”。在您的代码示例中，这应该是`UserRepositoryImpl`而不是`UserRepositoryExtensionImpl`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-21T07:31:25.703

正如雪莱指出的那样，命名对于使自动接线工作非常重要。在下面的示例中，我为我的自定义接口及其实现遵循了正确的命名标准。但是我扩展 JpaRepository 的接口被命名为“ItemDao”而不是“ItemRepository”，这导致 spring 完全忽略了我的自定义实现......

OBS！！！应该是“ItemRepository”

```
@Repository
public interface ItemDao extends JpaRepository<Item, Long>, ItemRepositoryCustom {} 
```

我的界面

```
interface ItemRepositoryCustom {...} 
```

我的实现类

```
class ItemRepositoryImpl implements ItemRepositoryCustom {...} 
```

如果有人有类似的问题，请按照以下链接中的 spring 文档中使用的命名标准开始。

[http://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.custom-implementations](http://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.custom-implementations)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T07:50:30.187

您应该遵循[在 Spring Data JPA 中创建自定义存储库实现的定义明确的方法](http://static.springsource.org/spring-data/jpa/docs/current/reference/html/repositories.html#repositories.custom-implementations)。基本上你需要扩展`CrudRepository`，所以你不必在你的自定义实现中注入它的实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T21:29:20.590

我已经通过`ApplicationContext`使用`applicationContext.getBean(UserRepository.class)`. 它以这种方式工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-17T14:34:10.880

那么在这种情况下，我建议使用`@Lazy`注释。

```
public class MyCustomRepositoryImpl implements MyCustomRepository {

    @Lazy
    @Autowired
    private MyRepository myRepository;

    @Override
    public boolean customMethod() {
       return myRepository.count() > 0;
    }

} 
```

使用构造函数参数 Spring 尝试创建需要您自定义存储库的“基本”存储库类，该存储库需要您“基本”存储库 - 具有循环依赖的典型情况。

没有`@Lazy`但只有`@Autowired`它也不会工作（基本回购的工厂bean会有问题）。

我认为在这种情况下，这`@Lazy`是最优雅的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-30T22:43:59.310

我发现我不需要`@Autowire`：

```
public interface UserRepository extends 
    UserRepositoryBasic,
    UserRepositoryExtension 
{ 
}

public interface UserRepositoryBasic extends
    JpaRepository<User, String>
{
    // standard Spring Data methods, like findByLogin
}

public interface UserRepositoryExtension 
{
    public void customMethod();
}

public class UserRepositoryExtensionImpl implements
    UserRepositoryExtension 
{
    private final UserRepositoryBasic userRepositoryBasic;

    // constructor-based injection
    public UserRepositoryExtensionImpl(
        UserRepositoryBasic userRepositoryBasic)
    {
        this.userRepositoryBasic = userRepositoryBasic;
    }

    public void customMethod() 
    {
        // we can call all basic Spring Data methods using
        // userRepositoryBasic
    }
} 
```

# java - Java中的列表列表

> ID：15124941
> 
> 赞同：0
> 
> 时间：2013-02-27T23:56:24.077
> 
> 标签：java, list

我对 Java 编程非常陌生，我正在尝试从列表中获取元素并将它们作为单例列表放入超级列表中：

`[object1,object2,object3] ---> [[object1][object2][object3]]`

我该怎么做呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T00:01:58.450

如果要创建列表列表，可以执行以下操作：

```
List<List<Object>> list = new ArrayList<List<Object>>(); 
```

`Object`您要放入列表中的对象类型在哪里，例如`String`对象，那么您只需编写：

```
List<List<String>> list = new ArrayList<List<String>>(); 
```

如果您想知道“我如何访问主列表中的列表中的元素”，那么首先您知道要访问主列表中的列表，例如：

```
List list2 = list.get(index); 
```

接下来，您可以使用`list2`访问主列表中的列表元素，例如：

```
Object o = list2.get(index); 
```

ETC

# php - 为每个文件 JQuery 和 AJAX 创建上传状态

> ID：15124942
> 
> 赞同：0
> 
> 时间：2013-02-27T23:56:28.363
> 
> 标签：php, jquery, html, css, ajax

我有一个 AJAX 上传工作，一切准备就绪，除了百分比和进度条之外，用户真的看不到任何信息。我想做的是为每个文件创建一个 div 并显示每个文件的进度。我必须使用 Flash 还是我可以从 jquery 中完成这一切，因为我完成了 ajax 部分，剩下的就是为每个文件制作 div 并为每个文件显示一个进度条。如果我要上传多个文件，它将显示 1 个将所有文件一起上传的进度条，我想为每个文件单独进行。所以基本上有一个表单来选择多个文件并为每个文件创建一个 div 以显示每个文件的完成百分比。

JavaScript：

```
$('#Submit').click(function(event)
{
    if ( !("FormData" in window) ) {
        $('#Wrapper').append('<div class="DMsg"><label class="DText">You Are Using An Outdated Browser, Please Upgrade To Google Chrome Or Firefox, If You Dont Most Features Will Not Work. Click Anywhere To Dismiss.</label></div>');
        $('#Wrapper').find('.DMsg').hide().slideDown('slow');
        var Close = setTimeout(function()
        {
            $('.DMsg').slideUp('slow', function()
            {
                $('.DMsg').remove();
            });
        }, 10000);
    }
    else
    {
        function Upload()
        {
            event.preventDefault();
            event.stopPropagation();

            var FInput = $('#Files').val();

            if(FInput != '')
            {
                var Data = new FormData();

                var Files = document.getElementById('Files');

                for(var I = 0; I < Files.files.length; ++I)
                {
                    var FilesName = Files.files[I].name;

                    Data.append('File[]', Files.files[I]);
                }
                var Request = new XMLHttpRequest();
                Request.upload.addEventListener('progress', function(event)
                {
                    if(event.lengthComputable)
                    {
                        Percent = event.loaded / event.total;
                        Progress = document.getElementById('Progress');
                        Loaded = Math.round(Percent * 100);

                        $('#Progress').progressbar({
                            value: Loaded
                        });

                        $('#Loaded').text(Loaded + '%');
                    }
                    else
                    {
                        $('#Progress').text('There Was An Error Getting The Percent');  
                    }
                });

                Request.upload.addEventListener('load', function(event)
                {

                });

                Request.upload.addEventListener('error', function(event)
                {
                    alert('Upload Failed.');
                });

                Request.addEventListener('readystatechange', function(event)
                {
                    if(this.readyState == 4)
                    {
                        if(this.status == 200)
                        {
                            $('#Wrapper').append('<div class="DMsg"><label class="DText">Your Files Have Finished Uploading. Click Anywhere To Dismiss.</label></div>');
                            $('#Wrapper').find('.DMsg').hide().slideDown('slow');
                            $('#Loaded').text('100%');
                            $('#Progress').progressbar({
                                value: 100
                            });
                            var Close = setTimeout(function()
                            {
                                $('.DMsg').slideUp('slow', function()
                                {
                                    $('.DMsg').remove();
                                });
                            }, 10000);
                        }
                        else
                        {
                            $('#Wrapper').append('<div class="DMsg"><label class="DText">There Was An Error In Uploading Your Files. Click Anywhere To Dismiss.</label></div>');
                            $('#Wrapper').find('.DMsg').hide().slideDown('slow');
                            var Close = setTimeout(function()
                            {
                                $('.DMsg').slideUp('slow', function()
                                {
                                    $('.DMsg').remove();
                                });
                            }, 10000);
                        }
                    }
                });

                Request.open('POST', 'Upload.php');
                Request.setRequestHeader('Cache-Control', 'no-cache');
                Progress.style.display = 'block';
                Request.send(Data); 
            }
            else
            {
                $('#Wrapper').append('<div class="DMsg"><label class="DText">Please Select A File / Files. Click Anywhere To Dismiss.</label></div>');
                $('#Wrapper').find('.DMsg').hide().slideDown('slow');
                var Close = setTimeout(function()
                {
                    $('.DMsg').slideUp('slow', function()
                    {
                        $('.DMsg').remove();
                    });
                }, 10000);
            }   
        }

        var EachFile = 0
        $.each($('#Files')[0].files, function()
        {
            ++EachFile;
            Upload();
        });
    }
}); 
```

HTML：

```
<div id="UForm">
    <form action="" method="post" enctype="multipart/form-data">
        <input type="file" class="Files" id="Files" name="File[]" />
        <input type="submit" name="Submit" class="AB" id="Submit" value="Upload!" />
        <div id="Progress"></div>
        <div class="Caption"><label id="Loaded"></label></div>
    </form>
</div> 
```

很抱歉有很多代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:07:49.617

它显示了一个很大的加载栏，因为您正在使用 DMsg 类搜索元素，而 jquery 从上到下搜索，因此它总是会找到您设置的第一个加载栏。

您需要一种方法为每个新栏设置不同的 ID，或者在执行

```
$('#Wrapper').find('.DMsg').hide().slideDown('slow'); 
```

想办法得到最后的结果。

# java - Apache Mailer 在 Scala 中抛出编译器错误？

> ID：15124944
> 
> 赞同：3
> 
> 时间：2013-02-27T23:56:36.423
> 
> 标签：java, scala, apache-commons

创建了一个简单的 Apache Commons Email 对象并编译它。进口：`import org.apache.commons.mail._`并且`javax.mail.internet.MimeMessage`还做了以下事情：

```
 def sendVerification(user: User) = {
    val email = new SimpleEmail()
        email.setHostName("smtp.sendgrid.net")
        email.setSmtpPort(465)
        email.setAuthenticator(new DefaultAuthenticator("user", "pass"))
        email.setSSLOnConnect(true)
        email.setFrom("Community Admin <admin@domain.com>")
        email.setSubject("TestMail")
        email.setMsg("""Welcome %s!

        Thanks for signing up. This email is to confirm your email address.

        Cheers,
        Admin Team
        """ format user.firstName)
        email.addTo(user.email)
        email.send()
  } 
```

错误如下：

```
[error] C:\Users\path\to\AccountService\models\User.scala:43: object mail is not a member of package javax
[error] import javax.mail.internet.MimeMessage
[error]              ^
[error] error while loading Email, Missing dependency 'class javax.mail.internet.MimeMessage', required by C:\Users\path\lib\commons-email-1.2.jar(org/apache/commons/mail/Email.class)
[error] C:\Users\path\com\threetierlogic\AccountService\models\User.scala:256: value setHostName is not a member of org.apache.commons.mail.SimpleEmail
[error]                 email.setHostName("smtp.sendgrid.net") 
```

但是，当我去编译时，它会在调用的每个方法上引发错误`val email`。这是与可变性有关的问题吗？或者版本有什么变化`1.3`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T00:59:17.877

Mel Nicholson 指出了正确的问题，它与未获取的依赖项有关。我没有意识到我下载的 Apache JAR 没有附带它。因此，我只是将其添加到我的 sbt 中`Build.scala`，瞧！它编译。

`val commonsMail = "org.apache.commons" % "commons-email" % "1.3"`

# rest - Dropwizard 是否支持服务器发送事件？

> ID：15124947
> 
> 赞同：0
> 
> 时间：2013-02-27T23:56:47.013
> 
> 标签：rest, dropwizard

似乎 Jersey 2.0 支持 SSE，但 Dropwizard 使用的是 Jersey 1.x。Dropwizard 是否支持 SSE ？

# c++ - C++ 变量不变

> ID：15124951
> 
> 赞同：0
> 
> 时间：2013-02-27T23:57:09.840
> 
> 标签：c++, variables, sdl, frame-rate, zero

我有一个`Timer`类，但是每当我尝试更改任何变量的值时，该变量都保持为零。`SDL_GetTicks()`返回它应该的值，但是当我尝试将该值分配给一个变量时，该变量保持为零。我已经尝试对数字进行硬编码，但变量仍然为零。我班级中的变量`Main`工作得很好，但是当我尝试更改其中的任何一个时，它都不起作用。此外，该方法也`timeSinceCreation()`返回零。

```
#include "Timer.h"
#include "SDL.h"

Timer::Timer() : m_timeOfLastCall(0.0f)
{
SDL_Init(SDL_INIT_TIMER);
}

Timer::~Timer() {}

float Timer::timeSinceCreation()
{
 return SDL_GetTicks();
 }

float Timer::timeSinceLastFrame()
{
 float thisTime = timeSinceCreation();
 float deltaTime = thisTime - m_timeOfLastCall;
m_timeOfLastCall = thisTime;
printf("%u ms \n", thisTime );
return deltaTime;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:02:55.773

您的代码具有未定义的行为，因为您的`printf`调用具有不匹配的类型（`%u`需要 a `unsigned int`，但您正在传递 a `float`）。因此，您不应期待任何合理的行为。

# php - 从mysql数据库正确输出乱码的unicode文本

> ID：15124955
> 
> 赞同：-2
> 
> 时间：2013-02-27T23:57:27.630
> 
> 标签：php, mysql, unicode

在我的 mysql 数据库字段中，unicode 文本是这样的

```
à¤•à¤¾à¤ à¤®à¤¾à¤¡à¥Œà¤, à¥¨à¥ª à¤®à¤¾à¤˜ / à¤¸à¤‚à¤µà¤¿à¤§à¤¾à¤¨à¤¸à¤­à¤¾ à¤¸à¤¦à¤¸à¥à¤¯à¤•à¥‹ à¤°à¤¿à¤•à¥à¤¤ à¥¬ à¤¸à¤¿à¤Ÿà¤•à¤¾ à¤²à¤¾à¤—à¤¿ à¤†à¤—à¤¾à¤®à¥€ à¤šà¥ˆà¤¤ à¥¨à¥® à¤—à¤¤à¥‡ à¤¹à¥à¤¨à¥‡ 
```

但是，当上述文本在浏览器中输出时，它在我的旧网站中是正确格式化的 unicode 字符。我已经编写了新的 php 5.3 网站并回显了 avove 文本，我得到的结果与上面完全相同，这对访问者来说是不可读的。我也有标题，因为`<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />`仍然没有运气。

我想知道上面的文字是如何在旧网站而不是新网站上正确呈现的？我也没有看到旧站点中使用的任何特殊功能。我相信有人可以帮助我解决这个问题。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:06:29.393

您需要为您的表格选择一个 utf8_* 字符集。

或按列

```
col1 VARCHAR(250) CHARACTER SET utf8 COLLATE utf8_unicode_ci 
```

# postgresql - PostgreSQL 8.4 Win 32Bit，复制策略到 64 位 Linux

> ID：15124959
> 
> 赞同：1
> 
> 时间：2013-02-27T23:57:48.250
> 
> 标签：postgresql, postgresql-9.1, postgresql-8.4

所以我们有一个在 Windows 上使用 PostgresSQL 8.4 的应用程序（是的，我知道）..

我们在我们的国家有几个这样的应用程序。

我们想要做的是在数据中心有一个 linux 服务器，它存储数据库的完整副本，并定期将数据流输入其中。

这不需要实时 100% 一致，但我们希望尽可能接近这一点，因为我们将用于跟踪全天的销售数据。

“奴隶”（数据中心）不需要做任何事情，然后接收所有数据，然后应用程序将在其上运行一些报告。

我已经研究过它，slony，pgpool，在 64 位 linux 上运行 32 位 PostgreSQL 等，但这是一个很大的领域，所以寻找一些关于我们不太理想的设置的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T12:53:12.413

正如克雷格指出的那样，您的基本选择是布卡多、朗迪斯特和斯洛尼。与流复制相比，这些设置都有些复杂。

您不能做的最重要的事情是使用流复制或类似的解决方案。这些应用架构（和主要版本）特定的日志文件，因此跨架构将在好的日子里不起作用，而在糟糕的日子里会导致从服务器上的数据损坏。不要这样做。

这三种解决方案以独立于架构的格式提取数据，并通过额外的基础设施将其发送到从站上保存。这里有很大的权衡，我建议在提交之前彻底研究每个选项。

要记住的一件事是，PostgreSQL 社区通常非常坚持认为没有一种万能的复制解决方案是可能的，因此众多选项导致了许多通常的解决方案，每个解决方案通常都非常专业。

其中，Slony 可能是最可配置的，而 Londiste 是最简单的。不过，它们适用于非常不同的用例。如果我有时间并且没有人能打败我，我可能会发布三者的比较，或者至少链接到其他人。

**更新**：简要比较。

懒惰-I

Slony-I 是最古老、最强大的逻辑复制系统。实际上，我更愿意将 Slony-I 视为复制*工具包*而不是解决方案。工具包方法提供了难以置信的灵活性和解决复杂环境中各种问题的能力。缺点是灵活性很复杂。正如我所说，“Slony 很乐意让你只复制数据库的一部分。另一方面，Slony 很乐意让你只复制数据库的一部分。” 这是一个非常有用的解决方案，使各种事情成为可能，但复杂性远高于其他解决方案。

然而，Slony 的一个主要优点是它具有用于管理 DDL 更改的工具。据我所知，朗迪斯特和布卡多没有。这意味着在 Slony 上可以向表中添加列，但在其他系统上则不然。

布卡多

这在复杂性上介于 Londiste 和 Slony 之间。它的主要有用特性是能够在两个主服务器之间进行多主服务器复制。它广泛使用 Perl。我不知道它在 Windows 上的测试效果如何，这可能是一个缺点。

隆迪斯特

Londiste 是 Skype 的基于 pgq 的主从复制系统（基本上是一个连接到 PostgreSQL 的事件队列，其中包含在数据库操作上引发的事件）。它以易于设置但不易保护副本免受修改而闻名。这当然可能是一个功能或错误，具体取决于您如何看待它。

# ios - 使用 GPUImageTransformFilter 和 iOS 平移手势转换 GPUImage 位置？

> ID：15124961
> 
> 赞同：2
> 
> 时间：2013-02-27T23:58:02.383
> 
> 标签：ios, objective-c, math, transformation, gpuimage

我在使用 GPUImage 变换过滤器时遇到问题。我正在使用平移手势识别器来重新定位图像。我的代码有效，但图像以大约一半的速度移动。如果我`CGAffineTransform newTransform`将坐标加倍，图像会按预期拖动。但是，当我开始一个新的平移手势时，图像会跳到距离中心大约两倍的点。也许我的数学是错误的。有任何想法吗？或者，任何人都可以提出比我这里更好的解决方案吗？

```
- (void)move:(UIPanGestureRecognizer *)sender {
    // Translated CGPoint from GPUImageView
    CGPoint translation = [sender translationInView:self.primaryImageView];
    // Current transform from GPUImageTransformFilter
    CGAffineTransform currentTransform = self.transFilter.affineTransform;
    // Size of GPUImageView bounds for later calculations
    CGSize size = self.primaryImageView.bounds.size;

    if ([sender state] == UIGestureRecognizerStateBegan) {
        // Set a beginning CGPoint 
        // Multiply GPUImageView bounds by current transform to get
        // the translated coordinates in pixels.
        self.beginPoint = CGPointMake(size.width*currentTransform.tx, size.height*currentTransform.ty);
    }

    // Calculate difference from beginning point to translated point
    CGPoint updatedPoint = CGPointMake(self.beginPoint.x+translation.x, self.beginPoint.y+translation.y);

    // Create a new transform translation.
    // Divide updated coordinates by GPUImageView bounds to get
    // a percentage value (-1 to 1)
    CGAffineTransform newTransform = CGAffineTransformMakeTranslation(updatedPoint.x/(size.width), updatedPoint.y/(size.height));

    // Apply new transform to filter and process.
    [self.transFilter setAffineTransform:newTransform];
    [self.sourcePicture processImage];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T17:43:58.063

正如@BradLarson 建议的那样，我创建了一个使用`CGAffineTransformTranslate()`. 我还发现平移计算还必须考虑变换比例以准确平移位置。这是我的解决方案：

```
- (void)move:(UIPanGestureRecognizer *)sender {
    CGPoint translatedPoint = [sender translationInView:self.primaryImageView];
    if ([sender state] == UIGestureRecognizerStateBegan) {
        self.lastPoint = translatedPoint;
    }

    CGSize size = self.primaryImageView.bounds.size;
    // Subtract the last point from the translated point to get the difference.
    CGPoint updatedPoint = CGPointMake(translatedPoint.x-self.lastPoint.x, translatedPoint.y-self.lastPoint.y);
    CGAffineTransform currentTransform = self.transFilter.affineTransform;
    // Divide updated point by the bounds to get the transform translate value.
    // Multiply transform value by the result of the offset factor divided
    // by the transform scale value.
    CGAffineTransform newTransform = CGAffineTransformTranslate(currentTransform, (updatedPoint.x/size.width)*(2/currentTransform.a), (updatedPoint.y/size.height)*(2/currentTransform.a));

    [self.transFilter setAffineTransform:newTransform];
    [self.sourcePicture processImage];
    self.lastPoint = translatedPoint;
} 
```

我已将偏移因子设置为`2`. 我仍然不确定为什么这个偏移是必要的，但我猜它可能与 Retina 屏幕有关。虽然，我还没有在非视网膜屏幕设备上测试过。

# map - RavenDB 复杂索引

> ID：15124967
> 
> 赞同：2
> 
> 时间：2013-02-27T23:58:23.483
> 
> 标签：map, indexing, group-by, ravendb, reduce

虽然我对使用 RavenDB 作为 OLTP 应用程序存储的想法感到非常兴奋，但我对 Linq/Map-Reduce 索引实现有点麻烦。

这是我正在尝试做的-我有文件-

```
Event {
   UserId:  "1",
   Location : "X",
   EventDate : "1/1/2010",
   EventType : "type A"
}
...
Event {
   UserId:  "2",
   Location : "Y",
   EventDate : "1/1/2011",
   EventType : "type B"
} 
```

应该执行的操作查询/索引是

“在按位置、事件分组的特定日期范围内为特定用户提供不同事件的计数”

结果示例：

```
Location | Count(EventA) | Count(EventB) 
---------------------------------------
X        | 10            |     2
Y        |  4            |    22 
```

我相信这应该是直截了当的。我可能只是错过了一些东西。

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T10:36:42.350

你问的是一个典型的举报案例。这是 RavenDB 不太适合的一件事（[http://ravendb.net/docs/server/bundles/index-replication](http://ravendb.net/docs/server/bundles/index-replication)）。您的问题类似于 SQL Server Analysis Services 中多维数据集的结构。

![在此处输入图像描述](../Images/336119ca4f0702aaf6ea6e9a9536967b.png)

这种情况下的问题是日期范围。如果范围是固定的，比如我想知道每个月的情况，您可以在索引中执行此操作，但如果范围是临时的，那么我相信在 Raven 中使用索引是不可能的，而且可能甚至不可能一个查询，因为您必须在客户端进行分组，因此必须检索大量文档（远远超过 Raven 的默认值 128）。

但是，如果有人在我们省略日期范围的索引中按示例搜索多个组，那么遵循索引实现，其中结果按用户 ID、位置和事件类型分组可能是一种解决方案：

```
public class Index : AbstractIndexCreationTask<Index.Result>
{
    public class Result
    {
        public string UserId { get; set; }
        public string Location { get; set; }
        public string EventType { get; set; }
        public int Count { get; set; }
    }

    public Index()
    {
        Map = events => from e in events
                        select new Result
                        {
                            UserId = e.UserId,
                            Location = e.Location,
                            EventType = e.EventType,
                            Count = 1
                        };

        Reduce = results => from result in results
                            group result by new { result.UserId, result.Location, result.EventType }
                                into g
                                select new Result
                                {
                                    UserId = g.Key.UserId,
                                    Location = g.Key.Location,
                                    EventType = g.Key.EventType,
                                    Count = g.Sum(x => x.Count)
                                };
    }
} 
```

这会给你这个结果

```
UserId   | Location | EventType     | Count
-------------------------------------------
1        | X        | A             |     2
1        | X        | B             |     4
1        | Y        | A             |    22
1        | Y        | B             |     6
2        | X        | A             |     7
2        | X        | B             |     3
2        | Y        | A             |     9
2        | Y        | B             |    16 
```

然后，您可以查询该索引并对查询结果进行额外分组。

# iphone - 设置和拆卸 OCUnit 测试用例引发异常

> ID：15124968
> 
> 赞同：1
> 
> 时间：2013-02-27T23:58:24.740
> 
> 标签：iphone, ocunit

```
- (void)setUp
{
    [super setUp];
    @try {
        [Problem setupProblem];
    }
    @catch (NSException *exception) {

        NSLog(@"exception Caught %@: %@", [exception name], [exception reason]);
        STFail(@"Should Pass, no exception is expected. Exception <%@>", exception);
    }
}

- (void)tearDown
{
    // Tear-down code here.

    @try {
        [Problem teardownproblem];
    }
    @catch (NSException* exception) {

        NSLog(@"exception Caught %@: %@", [exception name], [exception reason]);
    STFail(@"Should Pass, no exception is expected. Exception <%@>", exception);
}
    }
-(void)testGetComponentNil{

    id testComponet = (id<Solution>)[Problem getComponent:nil];
            STAssertNil(testComponet, @"Return Nil");
STAssertNotNil(id<Solution>[problem getComponent:@"Problem"], @"");

}

exception Caught NSInternalInconsistencyException: Cannot teardownProblem() before setupProblem()

 <Cannot teardownProblem() before setupProblem().> 
```

对于我的信息，第一个 setup 方法将被调用并调用 testcaseMethod，然后会调用 tear down。它在安装前拆解，任何人都在这个问题上建议我为什么在安装前拆解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T04:26:49.437

不要将 STFail 断言放在 setUp 或 tearDown 中。你也不需要异常处理；OCUnit 将捕获并报告任何抛出的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T21:51:29.860

您可以使用以下命令打印调用堆栈并通常查看这些异常`SenTestCaseDidFailNotification`：

例子：

```
@implementation TestCase
- (void)setUp
{
    [super setUp];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(didFailTest:) name:SenTestCaseDidFailNotification object:nil];
}

- (void)didFailTest:(NSNotification *)notification
{
    SenTestCaseRun *theRun = notification.object;

    for (NSException *exception in theRun.exceptions) {
        NSLog(@"Exception: %@ - %@", exception.name, exception.reason);
        NSLog(@"\n\nCALL STACK: %@\n\n",exception.callStackSymbols);
    }
} 
@end 
```

# mysql - 从多个表中获取数据以更新列

> ID：15124970
> 
> 赞同：0
> 
> 时间：2013-02-27T23:58:43.977
> 
> 标签：mysql, wordpress, phpmyadmin

```
UPDATE wp_postmeta
set meta_value = 'a:1:{i:0;s:6:"Subbed";}' 
WHERE meta_key = 'episode_sdversion' 
```

这基本上是我能走多远。这只是意味着我想更新`wp_postmeta`表并将列设置`meta_value`为何`a:1:{i:0;s:6:"Subbed";}`时`meta_key`可以`episode_sdversion`。

这是问题所在，我想检索另一个 WHERE 子句。但是要获得“WHERE”，我需要从多个表中检索信息。

`name`从具有第一个单词“ Subbed”的表 wp_terms 列中，我从 term_id 列中获取 ID。所以我想这会像这样工作

```
SELECT term_id
FROM  `wp_terms` 
WHERE  `name` LIKE  '%Subbed %' 
```

然后使用您刚刚在表中检索到的 term_id 值`wp_term_relationships` 并检查它是否等于列中的值，`term_taxonomy_id`然后检查`object_id`列 WHERE中的值`term_taxonomy_id = whatever you just got from before`。这`object_id`将等于我的第二个 WHERE 子句中的`post_id`列...`wp_postmeta`

所以我的最终代码看起来与此类似

```
UPDATE wp_postmeta
set meta_value = 'a:1:{i:0;s:6:"Subbed";}' 
WHERE meta_key = 'episode_sdversion'
AND WHERE post_id = the ID that I am trying to get from going through different tables 
```

我也可以使用...所以只有`WHERE meta_value = ''`将 meta_value 设置为空白...`a:1:{i:0;s:6:"Subbed";}``meta_value = ''`

因此，如果你们对如何从其他表中获取信息并将其保存在某种变量中然后在最终查询中引用它有任何想法，那会很棒，或者组合多个查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:18:07.963

我同意——你的问题很难理解。如果您可以发布您的表结构、示例数据和所需的输出，这会变得容易得多。

但是，如果我正确理解您的要求，那么这应该很接近：

```
UPDATE wp_postmeta
SET meta_value = 'a:1:{i:0;s:6:"Subbed";}' 
WHERE meta_key = 'episode_sdversion' AND
    post_id IN (
       SELECT tr.object_id 
       FROM  wp_terms t
          JOIN wp_term_relationships tr ON t.term_id = tr.term_taxonomy_id 
       WHERE  t.name LIKE '%Subbed %'   
   ) AND meta_value = '' 
```

如果我的理解是正确的，这也可能有效：

```
UPDATE wp_postmeta pm
    JOIN wp_term_relationships tr ON pm.post_id = tr.object_id
    JOIN wp_terms t ON t.term_id = tr.term_taxonomy_id 
SET pm.meta_value = 'a:1:{i:0;s:6:"Subbed";}' 
WHERE pm.meta_key = 'episode_sdversion'
    AND t.name LIKE '%Subbed %' 
    AND meta_value = '' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:09:29.407

这是一种糟糕的方法。如果有人出现并发布了一个纯粹的联合解决方案，请使用它。另外，我几乎无法破译您使用的所有表格，以及您到底想做什么，这是我阅读您的想法的最大努力。

```
UPDATE wp_postmeta
set meta_value = 'a:1:blahblbah'
WHERE meta_key='episode_sdversion'
  AND post_id in(SELECT post_id FROM wp_terms WHERE name like '%Subbed%'); 
```

您有一个看起来需要在子查询中完成的连接，但是从您的帖子中我无法分辨那是什么。如果您无法从这里弄清楚，请发布有关另一张桌子的更多信息，但它会像：

```
UPDATE wp_postmeta
set meta_value = 'a:1:blahblbah'
WHERE meta_key='episode_sdversion'
  AND post_id in(SELECT post_id
    FROM wp_terms 
    JOIN OTHERTABLE on OTHERTABLE.PK=wp_terms.PK
    WHERE name like '%Subbed%' and OTHERTABLE.WhateverColumn='whatevervalue'); 
```

鉴于信息，这是我能做的最好的事情。享受。

# php - 如果没有内容，则使 div 消失

> ID：15124981
> 
> 赞同：0
> 
> 时间：2013-02-27T23:59:30.173
> 
> 标签：php, wordpress

我想知道是否有办法让某个 div 显示：没有帖子时没有。

到目前为止，这是我想出的：

```
<div class="MVP-box">

    <?php 
        $loop = new WP_Query(array('post_type' => 'MVP', 'posts_per_page' => 1)); 
    ?>
    <?php while ( $loop->have_posts() ) : $loop->the_post(); ?>
    <?php   
        $custom = get_post_custom($post->ID);
        $screenshot_url = $custom["screenshot_url"][0];
        $website_url = $custom["website_url"][0];
    ?>

        <div class="post-entry">
        <div class="MVP-title">
        <?php the_title(); ?>
        </div>
        <div class="MVP-thumbnail">
            <?php the_post_thumbnail('MVP-picture'); ?>
        </div>
       <?php the_content(); ?>
        </div>
        <?php endwhile; ?>  

</div> 
```

我想知道的是，如果没有帖子内容，是否有办法让 MVP-box div 消失。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T00:05:19.737

您可以在绘制 div 之前检查 have_posts 吗？

```
<?php 
  $loop = new WP_Query(array('post_type' => 'MVP', 'posts_per_page' => 1)); 
  if ($loop->have_posts()) { ?>
   <div class="MVP-box">

<?php while ( $loop->have_posts() ) : $loop->the_post(); ?>
<?php   
    $custom = get_post_custom($post->ID);
    $screenshot_url = $custom["screenshot_url"][0];
    $website_url = $custom["website_url"][0];
?>

    <div class="post-entry">
    <div class="MVP-title">
    <?php the_title(); ?>
    </div>
    <div class="MVP-thumbnail">
        <?php the_post_thumbnail('MVP-picture'); ?>
    </div>
   <?php the_content(); ?>
    </div>
    <?php endwhile; ?>  

</div>
<?php } ?> 
```

# java - 将位数组值转换为一串二进制数

> ID：15124982
> 
> 赞同：0
> 
> 时间：2013-02-27T23:59:34.150
> 
> 标签：java, arrays, binary, type-conversion

**现在只看下半部分**

我在这里看到过将十六进制转换为二进制的方法，但我的问题是：是否可以将字节数组中的十六进制值转换为二进制值并将其放入一个大字符串中？

到目前为止，我一直在处理的代码是：

```
public static void main (String[] args){

    byte [] ex;
    ex = new byte [] {(byte)0xFF, (byte)0x11, (byte)0xEE, (byte)0x22, (byte)0xDD, (byte)0x33, (byte)0xCC, (byte)0x44};
    printByteArray(ex);

}

public static void printByteArray(byte [] array)

{
    System.out.print("[  ");
    for(int i = 0; i < array.length; i++)
    {
        System.out.print(Integer.toHexString((array[i]>>4)&0x0F).toUpperCase());
        System.out.print(Integer.toHexString(array[i]&0x0F).toUpperCase() + "  ");
    }
    System.out.println( "]");
} 
```

我想要改变的是能够将整个二进制字符串放入一个字节数组中，即获取每个十六进制数的二进制值，然后将其全部放入巨大的字节数组中。

**已编辑**

好吧，我将使用第一个，这并不重要，我猜它们有多长，它们仍然是正确的。但是现在你能不能帮我拿走那根绳子。我有这个代码：

```
public static void main (String[] args){

    String binary;
    byte [] ex;
    ex = new byte [] {(byte)0xFF, (byte)0x11, (byte)0xEE, (byte)0x22, (byte)0xDD, (byte)0x33, (byte)0xCC, (byte)0x44};
    printByteArray(ex);
    binary = hexToBin(ex);
    System.out.println(binary);

}

public static String hexToBin(byte [] array)
{
    String binStr = null;
    for(int i = 0; i < array.length; i++){
        binStr.append(Integer.toBinaryString(array[i]));
    }
    return binStr;
} 
```

...但由于我如何初始化字符串（起初），我的输出包含`null`在其中。任何想法如何解决这个问题？另外我只是将其更改为附加，现在我不知道为什么但不会让我使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:24:40.790

试试这个（请注意，这`byte`是 8 位而不是 16 位，因为您似乎在上面建议，这可能是混淆的一部分，对于 16 位您想要 a`short`和 32 将是`int`）

```
public class PrintBytes {

  public static void printByteArray(byte [] array)

  {
    System.out.print("[ ");
    for (byte anArray : array) {
      byte b = anArray;
      for (int j = 0; j < 8; j++) {
        System.out.print((b & 128) < 1 ? "0" : "1");
        b <<= 1;
      }
      System.out.print(" ");
    }
    System.out.println( "]");
  }

  public static void main(String[] args) {
    printByteArray(new byte[] {64, 32, -1});
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T00:06:27.537

Integer.toBinaryString 会给你你想要的吗？

[http://docs.oracle.com/javase/6/docs/api/java/lang/Integer.html#toBinaryString(int)](http://docs.oracle.com/javase/6/docs/api/java/lang/Integer.html#toBinaryString(int))

```
public static void printByteArray(byte [] array)
{
    System.out.print("[  ");
    for(int i = 0; i < array.length; i++)
    {
        System.out.print(Integer.toBinaryString(array[i]));
    }
    System.out.println( "]");
} 
```

# c - C - 数据不能分配给全局变量

> ID：15124984
> 
> 赞同：0
> 
> 时间：2013-02-27T23:59:35.503
> 
> 标签：c

我有一个外部变量`char myArr[3]`，我正在尝试为它分配一些东西。例如，在我的函数中，我有`myArr[3] = {1,2,3}`. 编译器告诉我我有“意外的标记：=”，但只要我在本地声明我的变量 ( `myArr[3] = {1,2,3}`)，错误就会消失。我尝试在我的函数中屏蔽外部变量，但没有结果。

```
char myArr[3];

void my func(){
    myArr = {1,2,3}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T00:04:39.500

当你这样做

```
char myArr[3] = { 1, 2, 3} 
```

您正在创建一个包含 3 个字符的数组，并将它们分别设置为值 1、2 和 3。

当你这样做

```
myArr[3] = { 1, 2, 3 } 
```

您正在尝试设置`myArr[3]`（顺便说一下，这是三个字符数组中的*第四个*`{ 1, 2, 3 }`字符；您将“越界”）没有意义。在 C 中，您不能这样设置数组：这是语法错误。

如果要将数组设置为值 1、2 和 3，请尝试以下操作：

```
myArr[0] = 1;
myArr[1] = 2;
myArr[2] = 3; 
```

# javascript - mustache.js vsdust.js：我如何定位我的学校阵列？

> ID：15124987
> 
> 赞同：0
> 
> 时间：2013-02-28T00:00:02.730
> 
> 标签：javascript, ajax, json, mustache, dust.js

如果您在[http://bucktowndigital.com/js_templates/mustache/v2-pub.html](http://bucktowndigital.com/js_templates/mustache/v2-pub.html)查看我的代码，您会发现我在学校对象中的高中和大学数组方面遇到了问题。

我知道胡子和灰尘是没有逻辑的，但这是否意味着我在使用它们时根本不能使用逻辑？

例如，我想放置一些条件代码，说明如果有 2 所或更多学院类型的学校，则只列出数组中的第一项。

另外，我将使用dust.js 做同样的测试。

我会遇到同样的问题吗？

我不一定需要正确的答案，但要指出解决问题的正确方向。

查看 json 数据：[http ://bucktowndigital.com/js_templates/mustache/v2-pub.json](http://bucktowndigital.com/js_templates/mustache/v2-pub.json)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T07:56:28.853

关于dustjs，是的，这是可能的。我推荐你：

1.  阅读本教程：[https ://github.com/linkedin/dustjs/wiki/Dust-Tutorial](https://github.com/linkedin/dustjs/wiki/Dust-Tutorial)
2.  使用dustjs的linkedin版本：http: [//linkedin.github.com/dustjs](http://linkedin.github.com/dustjs)
3.  使用linkedin助手：[https ://github.com/linkedin/dustjs-helpers](https://github.com/linkedin/dustjs-helpers)
4.  建立自己的助手。这很简单。

祝你好运！

# python - 在 Python 正则表达式中计算捕获的命名组的数量和命名组的总数

> ID：15124990
> 
> 赞同：0
> 
> 时间：2013-02-28T00:00:22.247
> 
> 标签：python, regex

我有两个清单。一个列表 ,`ref`包含正则表达式项，允许越来越大的灵活性，而另一个列表 ,`input`包含要与正则表达式匹配的输入列表。到目前为止，我能够创建`match`下面的字典。下面是我正在尝试创建的字典，`match_upd`. `match`由输入中的键和`ref`值中的对应匹配项组成。值项由 中每个匹配的元组项的第二项组成`ref`。此外，其中的每个值都`match`包含实现匹配的命名捕获组。所需的输出，`match_upd`, 将包含相同的值，但这些值中的每一个还包括匹配的捕获组中成功匹配的命名捕获组的计数，以及匹配捕获组中匹配的那些计数。下面的例子非常抽象，如果这让人感到困惑，我深表歉意。基本上，我试图统计比赛中可选捕获组的数量，以及参与比赛的这些组的数量。我正在使用 Python 的新[正则表达式](https://pypi.python.org/pypi/regex)模块。

```
input = [(' PREDIR NAME SUFTYP B1 ', 'CCCC, 11111'), (' NAME SUFTYP SUFDIR A1 ', 'CCCC, 11111')]

ref = [('(?P<iter1> PREDIR PRETYP NAME SUFTYP SUFDIR )|(?P<iter2> (?P<iter2pd>PREDIR )?(?P<iter2pt>PRETYP )?NAME(?P<iter2st> SUFTYP)?(?P<iter2sd> SUFDIR)? .*? )|(?P<iter3>.*? NAME .*? )', ['PREDIR,PRETYP,NAME,SUFTYP,SUFDIR,', 'CCCC, 11111']), ('(?P<iter1> NAME )|(?P<iter2> NAME )|(?P<iter3>.*? NAME .*? )', [',,NAME,,,', 'CCCC, 11111']), ('(?P<iter1> PREDIR NAME SUFTYP )|(?P<iter2> (?P<iter2pd>PREDIR )?NAME(?P<iter2st> SUFTYP)? .*? |(?P<iter3> .*? NAME .*?)', ['PREDIR,,NAME,SUFTYP,,', 'CCCC, 11111'])]

match {' NAME SUFTYP SUFDIR A1 , CCCC, 11111': (([',,NAME,,,', 'CCCC, 11111'], 'iter3'), (['PREDIR,,NAME,SUFTYP,,', 'CCCC, 11111'], 'iter2'), (['PREDIR,PRETYP,NAME,SUFTYP,SUFDIR,', 'CCCC, 11111'], 'iter2')), ' PREDIR NAME SUFTYP B1 , CCCC, 11111': ((['PREDIR,,NAME,SUFTYP,,', 'CCCC, 11111'], 'iter2'),['PREDIR,PRETYP,NAME,SUFTYP,SUFDIR,', 'CCCC, 11111'], 'iter2'), ([',,NAME,,,', 'CCCC, 11111'], 'iter3'))}

match_upd {' NAME SUFTYP SUFDIR A1 , CCCC, 11111': (([',,NAME,,,', 'CCCC, 11111'], 'iter3',0,0), (['PREDIR,,NAME,SUFTYP,,', 'CCCC, 11111'], 'iter2',1,2), (['PREDIR,PRETYP,NAME,SUFTYP,SUFDIR,', 'CCCC, 11111'], 'iter2',2,4)), ' PREDIR NAME SUFTYP B1 , CCCC, 11111': ((['PREDIR,,NAME,SUFTYP,,', 'CCCC, 11111'], 'iter2',2,2),['PREDIR,PRETYP,NAME,SUFTYP,SUFDIR,', 'CCCC, 11111'], 'iter2',2,4), ([',,NAME,,,', 'CCCC, 11111'], 'iter3',0,0))} 
```

我可以`match`使用以下代码生成：

```
def match(i,o,addr,ref,group):
    m = regex.fullmatch(i[0],o[0])
    if m:
        addr.append(str(o).strip('('')').replace("'",""))
        ref.append(i[1])
        m = m.groupdict()
        for k,v in m.items():
            if v is not None:
                group.append(k)

addr = []
ref = []
group = []

for i in ref:
    for t in input:
        if t[1] == i[1][2]:
            match(i,t,addr,ref,group)

unmatched = []
for i in input:
    unmatched.append(str(i).strip('('')').replace("'",""))

match_iter123 = zip(addr,zip(ref,group))
unmatched123 = list((set(unmatched)) - (set(addr)))

matchdict123 = {}
[matchdict123.setdefault(k,[]).append(v) for k,v in match_iter123]

matchdict = defaultdict(tuple)

for i in match_iter123:
    matchdict[i[0]] += i[1:]

match = {k:v for k, v in matchdict.items()} 
```

我尝试附加所需输出的尝试`match_upd`并没有取得成果：

```
def match(i,o,addr,ref,group,matchattributes,totalattributes):
    m = regex.fullmatch(i[0],o[0])
    if m:
        addr.append(str(o).strip('('')').replace("'",""))
        ref.append(i[1])
        m = m.groupdict()
        for k,v in m.items():
            if v is not None and re.search(r'pd|pt|sd|st',k) is None:
                group.append(k)
        for k,v in m.items():
            if v is not None and re.search(r'pd|pt|sd|st',k) is not None:
                matchattributes.append(len(k))
        for k,v in m.items():
            if re.search(r'pd|pt|sd|st',k) is not None:
                totalattributes.append(len(k)) 
```

我是编程新手，如果这个答案很简单，请原谅我。我基本上需要对最后两个`for`语句进行计数。感谢您的帮助和耐心。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T13:58:04.633

我想到了。回想起来，这是一个非常简单的解决方案。`matchattributes`我只需要确定和`totalattributes`变量的总数。该`+=`函数是解决方案，将总数附加到一个空列表中。

```
def match(i,o,addr,ref,group,matchattributes,totalattributes):
    matchcounter = 0
    totalcounter = 0
    m = regex.fullmatch(i[0],o[0])
    if m:
        addr.append(str(o).strip('('')').replace("'",""))
        ref.append(i[1])
    m = m.groupdict()
    for k,v in m.items():
            if v is not None and re.search(r'pd|pt|sd|st',k) is None:
                group.append(k)
    for k,v in m.items():
        if v is not None and re.search(r'3(pd|pt|sd|st)',k):
            matchcounter += 1
    matchattributes.append(matchcounter)
    for k,v in m.items():
        if re.search(r'3(pd|pt|sd|st)',k):
            totalcounter += 1
    totalattributes.append(totalcounter) 
```

# olap - OLAP Cube 设计问题 - 如何删除多对一关系

> ID：15124992
> 
> 赞同：2
> 
> 时间：2013-02-28T00:00:25.407
> 
> 标签：olap, many-to-one, star-schema

我在之前的问题[OLAP Cube design issue for Telecommunication Data](https://stackoverflow.com/questions/15102752/olap-cube-design-issue-for-telecommunication-data)中包含了我的项目详细信息。我有一个问题是否有必要删除 OLAP 上的一对多关系。我听说OLAP应该可以回答零维问题，一维问题等等。此外，我在同一天有几个通话细节，所以我该如何设计它以便回答问题第 1 天通话的持续时间是多少？我不是最擅长解决问题的人，所以如果在理解问题时出现任何问题，请在下面发表评论。

# java - java 如何从一个月中获取一天

> ID：15124993
> 
> 赞同：-1
> 
> 时间：2013-02-28T00:00:31.013
> 
> 标签：java

我有一个日历选择器，允许用户选择开始日期和结束日期。

我想从一个月中提取一天，使用 getDay 的旧方法会从一个月中产生错误的一天。有没有其他方法可以用来从一个月中获取日期并将其放入 int 类型？

```
 Date date_from = HolidayForm.pickerFrom.getDate();
      Date date_to = HolidayForm.pickerTo.getDate();

      //getDay is deprecated 
      int from = date_from.getDay();
      int to = date_to.getDay();

      //so i can do to find difference. 
      int diff = to-from; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T00:02:50.490

使用[**日历 API**](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html)：

类中的方法`java.util.Date`大多已被弃用。您必须使用`java.util.calendar`类才能对日期进行操作。

```
Date d = new Date(); 
        Calendar cal = Calendar.getInstance();
        cal.setTime(d);
        System.out.println(cal.get(Calendar.DAY_OF_MONTH)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T00:05:30.970

使用[日历](http://docs.oracle.com/javase/6/docs/api/java/util/Calendar.html)对象：

尝试这个 ：

```
Date date_from = HolidayForm.pickerFrom.getDate();
Date date_to = HolidayForm.pickerTo.getDate();

Calendar calFrom = Calendar.getInstance();
calFrom.setTime(date_from);
int from = calFrom.get(Calendar.DAY_OF_MONTH);

Calendar calTo = Calendar.getInstance();
calTo.setTime(date_to);
int to = calTo.get(Calendar.DAY_OF_MONTH);

int diff = to-from; 
```

# android - 没有 GUI 的应用程序在启动后会阻塞当前屏幕

> ID：15124994
> 
> 赞同：2
> 
> 时间：2013-02-28T00:00:36.063
> 
> 标签：android, android-service

我创建了没有 GUI 的应用程序，它有一个 Activity 来启动它。

问题是，应用程序启动后，当前屏幕变得不活跃，就像新的 Activity 已经启动一样。

图片相同，但未激活。它只有在触摸“返回”或“主页”按钮后才会激活。

活动代码：

```
public class LaunchActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        //super.onCreate(savedInstanceState);

        Intent serviceIntent = new Intent(LaunchActivity.this, MainService.class);
        startService(serviceIntent);
    }

} 
```

显现：

```
<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@android:style/Theme.NoDisplay" >
    <activity
        android:name="com.example.execdroid.LaunchActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <service
        android:name="com.example.execdroid.MainService"
        android:enabled="true"
        android:exported="true"
        android:label= "@string/service_name">
    </service>

</application> 
```

应用程序启动后，我应该更改什么以激活当前屏幕？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T00:08:34.057

您需要在启动服务后完成您的活动。尝试添加`finish()`后`startService(serviceIntent);`

刚刚测试过这个 - 工作正常。

# javascript - 如何等待异步方法的回调返回值？

> ID：15124995
> 
> 赞同：9
> 
> 时间：2013-02-28T00:00:39.023
> 
> 标签：javascript, asynchronous, google-chrome-extension

我知道等待异步方法是愚蠢的，[应该使用回调来代替](https://stackoverflow.com/questions/5010288/how-to-make-a-function-wait-until-a-callback-has-been-called-using-node-js)。但是，如果第三方 API 强制您进行同步怎么办？

我正在开发一个 Chrome 扩展程序，它将阻止用户访问已经在另一个选项卡中打开的网站。我基本上需要根据打开的标签中的 url 取消请求。我想这样使用[`chrome.webRequest.onBeforeRequest`](https://developer.chrome.com/extensions/webRequest.html#event-onBeforeRequest)：

```
function onBeforeRequest(details) {
  var websiteAlreadyOpenInOtherTab;

  // Here i want to set `websiteAlreadyOpenInOtherTab` by using the `chrome.tabs`
  // API. It's asynchronous though and that's my problem. I cant return a value
  // from an asynchronous method call.

  if (websiteAlreadyOpenInOtherTab) {
    return { cancel: true };
  }
}

chrome.webRequest.onBeforeRequest.addListener(
  onBeforeRequest,
  { urls: ['<all_urls>'], types: ['main_frame'] },
  ['blocking']); 
```

希望您在上面的代码中看到我的困境。我需要根据异步方法调用的结果返回一个对象。有可能实现这一目标吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T07:51:09.060

***也许***您可以通过跟踪标签 URL 来解决问题？：

1.  当应用程序启动时，通过使用获取所有打开的选项卡 URL`chrome.tabs.query`
2.  订阅`chrome.tabs.onUpdated`并`chrome.tabs.onRemoved`在 URL 更改时添加/删除/更新 URL。

[基于文档](http://developer.chrome.com/extensions/tabs.html)的某种代码示例：

```
var tabUrlHandler = (function() {
   // All opened urls
   var urls = {},

   queryTabsCallback = function(allTabs) {
      allTabs && allTabs.forEach(function(tab) {
          urls[tab.id] = tab.url;
      });
   },

   updateTabCallback = function(tabId, changeinfo, tab) {
       urls[tabId] = tab.url;
   },

   removeTabCallback = function(tabId, removeinfo) {
       delete urls[tabId]; 
   };

   // init
   chrome.tabs.query({ active: true }, queryTabsCallback);
   chrome.tabs.onUpdated.addListener(updateTabCallback);
   chrome.tabs.onRemoved.addListener(removeTabCallback);

   return {
     contains: function(url) {
        for (var urlId in urls) {
           if (urls[urlId] == url) {
              return true;
           }
        }

        return false;
     }
   };

}()); 
```

现在您应该可以`tabUrlHandler`直接在您的`onBeforeRequestMethod`:

```
function onBeforeRequest(details) {
  var websiteAlreadyOpenInOtherTab = tabUrlHandler.contains(details.url);

  if (websiteAlreadyOpenInOtherTab) {
    return { cancel: true };
  }
} 
```

# asp.net - 在 asp.net 中保存图像的正确方法是什么？

> ID：15124998
> 
> 赞同：1
> 
> 时间：2013-02-28T00:00:41.587
> 
> 标签：asp.net, sql-server, image, save

在我的系统中，有一个功能可以保存添加的项目的图像，我所做的是将图像的文件名保存到 SQL Server 中，并将图像保存到 asp.net 的文件夹中

这是我在 sql server 中保存图像文件名的代码：

```
INSERT INTO schemaImage.Image(image_name) VALUES ('image1.FileName') 
```

这是我将图像保存到文件夹中的代码：

```
image1.SaveAs(Server.MapPath("Images/" + image1.FileName)) 
```

是否可以将图像保存到数据库中？

在这里保存图像更合适？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:19:56.060

1.  是的，可以在 SQL Server 中将图像保存为二进制类型。

    [详情：](http://msdn.microsoft.com/en-us/library/aa260858%28v=vs.60%29.aspx) [http ://www.asp.net-crawler.com/articles/ADO.Net/Storing-binary-blob-data-images-files-SQL-server-ADONet.aspx](http://www.asp.net-crawler.com/articles/ADO.Net/Storing-binary-blob-data-images-files-SQL-server-ADONet.aspx)

2.  保存图像的正确方法取决于您的应用程序的要求：例如，如果您需要经常修改图片并且它们很大，则将它们保存在文件系统中更合适，因为它可以更好地处理碎片。 [更多细节..](http://msdn.microsoft.com/en-us/library/aa260858%28v=vs.60%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:16:11.820

您需要将图像转换为字节以将其存储在数据库中。您可以`IO.File.ReadAllBytes()`用于本地文件或`Net.WebClient.DownloadData()`Web 文件。该`IMAGE`数据类型在 SQL Server 中将消失，因此请用于`VARBINARY(MAX)`存储它。

### 代码：

```
Dim url As String = "http://example.com/image.png",
    file As String = "c:\image.png"

Using connection As New Data.SqlClient.SqlConnection("your connection string"),
    saveImage As New Data.SqlClient.SqlCommand("dbo.saveImage", connection)

    connection.Open()
    saveImage.CommandType = Data.CommandType.StoredProcedure

    'use only one of these
    saveImage.Parameters.AddWithValue("@imageData", New Net.WebClient().DownloadData(url)) 'get file from url
    'saveImage.Parameters.AddWithValue("@imageData", IO.File.ReadAllBytes(file)) 'get file locally

    saveImage.ExecuteNonQuery()

End Using 
```

### 程序：

```
CREATE PROCEDURE [dbo].[saveImage] ( @imageData AS VARBINARY(MAX) )
AS
INSERT INTO dbo.myImage ( imageData ) VALUES ( @imageData ) 
```

### 桌子：

```
CREATE TABLE [dbo].[myImage](
    [imageData] [varbinary](max) NOT NULL
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T00:16:29.073

当然，您可以在 SQL Server 中存储图像数据，有 varbinary 和 image 等数据类型来存储图像数据。[您可以在此链接](http://msdn.microsoft.com/en-us/library/ms187993.aspx)中找到有关使用这些类型的详细信息。但在此之前，您必须阅读[在 SQL Server 中存储图像？](https://stackoverflow.com/questions/5613898/what-about-storing-images-in-sql-server)决定是否将图像存储在数据库中。