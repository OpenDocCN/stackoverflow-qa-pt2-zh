# StackOverflow 问答 13464000-13464999

# jquery - videojs没有播放第二个视频

> ID：13464001
> 
> 赞同：1
> 
> 时间：2012-11-19T23:06:53.787
> 
> 标签：jquery, video-streaming, html5-video, video.js

我在我的移动网站中使用视频 js 插件，一个视频一切正常，但是当我添加第二个视频时，第一个播放正常，但第二个根本不播放，视频在两个不同的页面中，他们有不同的ID

有任何想法吗？提前致谢

# javascript - Codeacademy JavaScript - 第 2-1 节

> ID：13464003
> 
> 赞同：3
> 
> 时间：2012-11-19T23:07:07.060
> 
> 标签：javascript

几年前我参加了 AP 计算机科学课程，从中学习了 Java。我现在正在尝试这个 Codeacademy，我对这个问题感到困惑，有人可以向我解释一下吗？这是问题：

你是习惯的产物。每周你买 5 个橙子。但是橙子的价格一直在变化！

1.  您想声明一个计算购买 5 个橙子的成本的函数。
2.  然后，您要一起计算 5 的成本。
3.  编写一个称为 orangeCost() 的函数。
4.  它应该采用一个参数，即橙子的成本，并将其乘以 5。
5.  它应该将乘法的结果记录到控制台。
6.  调用每个橘子售价 5 美元的函数。

这是我的代码：

```
var getCost = orangeCost (costOfOrange) {
    console.log(costOfOrange * 5);
};
getCost(5); 
```

我相信它遵循早期问题中显示的语法，但我得到了这个输出：

```
SyntaxError: missing  before statement
Oops, try again. 
It looks like your syntax isn't quite right. 
Feel free to peek back at earlier exercises if you need help! 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:10:15.863

JavaScript 中的函数定义可以采用两种主要形式之一：

```
function funcName(param1, param2, ...) { } 
```

或者

```
funcName = function(param1, param2, ...) { } 
```

你的例子也没有遵循。你可能想要：

```
orangeCost = function(costOfOrange) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:11:12.527

它看起来就像您忘记了`function`关键字一样简单，并且在 之后没有 orangeCost `=`：

```
var getCost = function (costOfOrange) {
    console.log(costOfOrange * 5);
};
getCost(5); 
```

这有很大帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T19:09:13.430

我已经使用以下代码解决了我的问题：

```
var orangeCost = function (price) {
    console.log(price * 5);
};
orangeCost(5); 
```

我相信它要求验证 orangeCost 是函数名称，这就是为什么它拒绝任何其他事情，尽管还有其他方法可以做到这一点。希望这会有所帮助，因为我也对这个问题感到惊讶并花一些时间:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-25T22:16:21.463

```
var orangeCost = function (price) {

    console.log(price * 5);
}

orangeCost(5); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-27T11:58:56.940

```
var orangeCost = function (price) {
    console.log (price * 5);
};

orangeCost(5); 
```

您应该调用 orangeCost 值而不是函数名称“price”。就这样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-05T10:45:37.737

```
var orangeCost = function(price){
    var val = price*5;
    console.log(val);
}
orangeCost(7) 
```

这是我的代码，您可以参考

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-14T11:32:08.837

![在此处输入图像描述](../Images/417cf6667be06e50140fb648cf57b069.png)

检查一下伙计。您所做的是使用 orangeCost 代替 function 关键字。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-02T10:21:28.147

这是你应该做的：

```
var orangeCost = function(price) {
    console.log(price * 5);
}

orangeCost(5); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-08-23T21:17:33.573

请按照以下说明进行操作：

```
var  functionName = function(parameterName){
//function definition.what you want to do 
} 
```

在您的情况下，代码可能是这样的：

```
var orangeCost = function(price)
{
    console.log(price*5);
}
orangeCost(5); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-03T19:40:01.620

简单的。只需创建函数并在打印时对其进行评估

```
var orangeCost = function (cost){
    console.log(cost * 5)
}

orangeCost(5); 
```

# javascript - 为只读文本输入字段的 jQuery 值添加 +1

> ID：13464007
> 
> 赞同：13
> 
> 时间：2012-11-19T23:07:15.797
> 
> 标签：javascript, jquery

我正在使用一个有`readonly`文本`input`的函数，当我执行该函数时，我想要数值 + 1。假设我有 60，当我执行该函数时，返回的数字应该是 61。

但它却出现了 601，它只是将数字 1 添加到字符串中。关于发生了什么的任何线索？减法，乘法和除法都可以正常工作。这是一个片段

```
 var num= $("#originalnum").val() + 1;
 $("#originalnum").val(num); 
```

是的，我尝试了一些不同的变化，我错过了什么吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-19T23:09:37.520

在这种情况下，一个简单的一元`+`足以将字符串转换为数字：

```
var num = +$("#originalnum").val() + 1;
$("#originalnum").val(num); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-19T23:10:38.630

问题在于`.val()`将元素的值作为字符串返回，并且当您`+`在字符串上使用运算符时，它会进行字符串连接。您需要先将值转换为数字：

```
var num = +$("#originalnum").val() + 1;            // unary plus operator
// OR
var num = Number($("#originalnum").val()) + 1;     // Number()
// OR
var num= parseFloat($("#originalnum").val()) + 1;  // parseFloat()
// OR
var num= parseInt($("#originalnum").val(),10) + 1; // parseInt() 
```

请注意，如果您使用，则`parseInt()`必须*将*基数 (10) 作为第二个参数，否则它将（取决于浏览器）将带有前导零的字符串视为八进制，将带有前导的字符串`"0x"`视为十六进制。另请注意，`parseInt()`忽略字符串末尾的任何非数字字符，包括用户可能打算作为小数点的句号，因此`parseInt("123.45aasdf",10)`返回`123`. 同样`parseFloat()`忽略字符串末尾的非数字字符。

此外，如果它是用户输入的值，您应该仔细检查它是否真的是一个数字，如果不是，则可能提供错误消息。

当您使用`*`,`/`或`-`运算符时，JS 会尝试自动将字符串转换为数字，这就是这些运算符“工作”的原因（假设字符串*可以*转换）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-19T23:08:00.057

您应该使用该`parseInt`函数并确保值为数字（使用 isNaN 函数）：

```
var val = $("#originalnum").val();

var num = 0;

if ( !isNaN(val) )
  num= parseInt(val) + 1; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-19T23:08:37.400

使用`parseInt()`：

```
var num= parseInt($("#originalnum").val(),10) + 1; 
```

因此，您的数字被视为整数而不是字符串（`.val()`默认情况下将结果视为字符串）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-04-21T04:20:18.357

如果你不喜欢上面的代码拼写，你也可以这样尝试。

```
$("#originalnum").val(function() {
   $(this).val(parseInt($(this).val()) + 1)
}); 
```

# python - 根据日期和时区计算 tm_isdst

> ID：13464009
> 
> 赞同：1
> 
> 时间：2012-11-19T12:49:57.790
> 
> 标签：python, time, timezone

当我跑线时

```
time.strptime("2012-06-01 12:00:00 "+time.strftime("%Z"), "%Y-%m-%d %H:%M:%S %Z") 
```

它为我创建了一个结构，但标志`tm_isdst`是错误的。在 6 月初 DST 处于活动状态，但无论我在什么日期输入`tm_isdst`标志始终设置为`localtime()`现在的状态。我需要知道 DST 在我输入的日期是否有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T13:26:34.243

首先，不要包含`time.strftime('%Z')`在您的格式中。您正在告诉它您当前的 GMT 偏移量（包括关闭夏令时），并且它 [可能] 使用它来设置 tm_isdst。

没有它，你应该得到一个结构`tm_isdst=-1`：

```
>>> time1 = time.strptime("2012-06-01 12:00:00", "%Y-%m-%d %H:%M:%S")
>>> time1
time.struct_time(tm_year=2012, tm_mon=6, tm_mday=1, tm_hour=12, tm_min=0,
tm_sec=0, tm_wday=4, tm_yday=153, tm_isdst=-1) 
```

现在，您可以将它传递给 mktime，它会在给定`-1`值的情况下“猜测”DST 值（我将“猜测”放在引号中，因为它总是正确的，除了凌晨 2 点不明确的情况）。这将以`time()`格式给出绝对时间。

```
>>> time.mktime([previous value]) # my timezone is US Eastern
1338566400.0 
```

然后你可以用这个值调用本地时间，它会有一个正确设置的 DST 标志：

```
>>> time.localtime(1338566400).tm_isdst
1 
```

您也可以跳过 strptime 步骤，直接将值传递给 mktime：

```
>>> time.mktime((2012,6,1,12,0,0,-1,-1,-1))
1338566400.0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-17T17:01:01.720

您的问题相当于如何将作为字符串给出的本地时间转换为附有本地时区信息的本地时间：

```
from datetime import datetime
from pytz.exceptions import InvalidTimeError # $ pip install pytz
from tzlocal import get_localzone # $ pip install tzlocal

naive_dt = datetime.strptime("2012-06-01 12:00:00", "%Y-%m-%d %H:%M:%S")
local_tz = get_localzone()
try:
    local_dt = local_tz.localize(naive_dt, is_dst=None)
except InvalidTimeError as e:
    print("can't determine whether DST is active, reason: %s" % (e,))
else:
    assert local_dt.dst() is not None
    print("DST is %sactive" % ("" if local_dt.dst() else "not ",)) 
```

它使用[Olson tz 数据库](http://www.iana.org/time-zones/repository/tz-link.html)（`pytz`模块），因此：

*   它适用于过去的日期，因为与 DST 无关的原因，UTC 偏移量可能有所不同。
*   当 DST 无法确定时，它会检测不明确或不存在的本地时间
*   它适用于 Windows 和 *nix (`tzlocal`模块)

注意：[`mktime()`@Random832'a 中显示的基于解决方案的答案](https://stackoverflow.com/a/13464010/4279)：

```
import time

isdst = time.localtime(time.mktime(naive_dt.timetuple())).tm_isdst > 0 
```

*   如果操作系统不提供自己的历史时区数据库，它可能会默默地为过去的某个日期提供错误的结果
*   对于不明确或不存在的当地时间（在 DST 转换期间），它可能会默默地提供错误的结果

# jquery - jQuery - 删除表格中的一行

> ID：13464015
> 
> 赞同：0
> 
> 时间：2012-11-19T23:07:45.393
> 
> 标签：jquery, html-table, row

我正在尝试使用 jQuery 删除表中的行。该表将按钮显示为一行中的第一项。单击该按钮应从 MySQL 表中删除该行。

这是javascript代码

```
 $("#list .del").click(function() {
      cell = $(this);
      row  = cell.closest("tr");
      vid = row.find (".vid");
      alert (vid.text());

      $.post ("db_deleteplayer.php",
        {vid:vid.text()},
        updateSignup);
      return;

    }) //#list .del click      

    function updateSignup(data) {
        $('#list').html(data);
      return;
    } 
```

这对于我要删除的第一行非常有效，但此后失败。我已经在 Firefox、Chrome 和 IE 中确认了这一点。

我的猜测是第一次删除是修改 DOM 并且 jQuery 会感到困惑。有人可以解释我要去哪里错了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-19T23:09:21.503

改变：

```
$("#list .del").click(function({ 
```

至：

```
$("#list").on('click', '.del', function(){ 
```

基本上，当您调用时，`$('#list').html(..)`您正在替换 中的元素`#list`，并且在这样做时，您删除了先前绑定的事件处理程序。

通过替换`.on('click', '.del', function...`，您将处理程序附加到`#list`，它始终保留在 DOM 中（在您的示例中）。然后处理程序检查事件原始目标，查看它是否具有类`.del`，如果有，则执行处理程序。

阅读有关委托事件的更多信息：[https ://stackoverflow.com/a/8111171/1238887](https://stackoverflow.com/a/8111171/1238887)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:12:37.343

那这个呢？这只会删除按钮`.del`所在的行（因此它实际上不会更新它）。当然，这取决于您的设置是否可以找到它有用，但如果`.del`在行内，它应该可以正常工作。

```
$("#list .del").click(function(e) {
    var row = $(this).closest("tr");
    $.post(
        "db_deleteplayer.php",
        {
            vid: row.find(".vid").text()
        },
        function(data) {
            row.remove();
        }
    );

    e.stopPropagation();
    e.preventDefault();
}); 
```

# sql - oracle - 每组最大值

> ID：13464019
> 
> 赞同：2
> 
> 时间：2012-11-19T23:08:01.890
> 
> 标签：sql, oracle

大学表 - UniversityName、UniversityId

租赁表 - LeaseId、BookId、UniversityId、LeaseDate

图书表 - BookId、UniversityId、Category、PageCount。

对于每所大学，我必须找到租借书籍数量最多的类别。

所以，像

```
UniversityName Category #OfTimesLeased 
```

我一直在玩它，使用`Dense_Rank`etc 取得了一些成功 - 但如果有平局，只有一个出现，而我希望他们两个都出现。

当前查询：

```
select b.UniversityId, MAX(tempTable.type) KEEP (DENSE_RANK FIRST ORDER BY tempTable.counter DESC)
from book b 
join 
(select count(l.leaseid) AS counter, b.category, b.universityid
from lease l
join book b
on b.bookid =l.bookid AND b.universityid=r.universityid
 group by b.category, b.universityid) tempTable
 on counterTable.universityid= b.universityid
 group by b.universityid 
```

^无法解决平局问题并获取租借次数最多的图书类型的租借次数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:19:23.383

试试这个

```
WITH CTE AS
(
SELECT UniversityName, Category, Count(*) NumOfTimesLeased 
FROM University u
INNER JOIN Book b on u.UniversityId = b.UniversityId
INNER JOIN Lease l on b.bookid = l.bookid and b.UniversityId = l.UniversityId
GROUP BY UniversityName, Category    
), 
CTE2 AS (
SELECT UniversityName, Category, NumOfTimesLeased,
RANK() OVER (PARTITION BY UniversityName 
             ORDER BY NumOfTimesLeased DESC) Rnk
FROM CTE)

SELECT * FROM CTE2 WHERE Rnk = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:17:12.707

您使用分析函数走在正确的轨道上：

```
select Univerity, Category, NumLeased
from (select t.*,
             row_number() over (partition by university order by Numleased desc) as seqnum
      from (select l.university, b.category, count(*) as NumLeased
            from lease l join
                 book b
                 on l.bookid = b.bookid
            group by l.university, b.category
           ) t
     ) t
where seqnum = 1 
```

我使用 row_number() 因为你只想要一个最高值。当您查找“1”以外的值时，Rank 和 dense_rank 更有用。

如果您希望在出现平局时显示最高值，请使用`dense_rank`而不是`row_number`. 这些值将位于不同的行上。

# mysql - 即使在每个可能的组合之后创建 TABLE 时也会出现 FOREIGN KEY 错误

> ID：13464024
> 
> 赞同：1
> 
> 时间：2012-11-19T23:08:49.453
> 
> 标签：mysql, reference, foreign-keys, create-table

我已经用头撞了两天了，终于寻求帮助。

我用最少的数据创建了两个测试表以保持简单，所以至少我有一些工作要做，并且想要创建第三个表，我可以用它来将数据拉入我的网站（我希望创建查询以后可以从不同的表中提取数据，但现在必须这样做）。

这是我为第一个 TABLE 导出的信息：

```
CREATE TABLE `about` (
`about_id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
`about_title` varchar(50) NOT NULL,
`about_description` text NOT NULL,
`creator_id` smallint(5) unsigned NOT NULL,
`about_image` varchar(150) NOT NULL,
PRIMARY KEY (`about_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=3 ;

INSERT INTO `about` (`about_id`, `about_title`, `about_description`, `creator_id`, `about_image`) VALUES
(1, 'Exciter', 'This is an awesome album', 1, 'images/depeche_mode_exciter.jpg'),
(2, 'Autobahn', 'This is a great album', 2, 'images/kraftwerk_autobahn.jpg'); 
```

这是我为第二个 TABLE 导出的信息：

```
CREATE TABLE `creator` (
`creator_id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
`creator_name` varchar(50) NOT NULL,
PRIMARY KEY (`creator_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=3 ;

INSERT INTO `creator` (`creator_id`, `creator_name`) VALUES
(1, 'Depeche Mode'),
(2, 'Kraftwerk'); 
```

这是我尝试用来创建一个新表的最新版本，它将 creator_id 转换为 Depeche 模式或艺术家在任何 creator_id 行上的任何内容：

```
CREATE TABLE `about_creator` (
`about_id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
`about_title` varchar(50) NOT NULL,
`about_description` text NOT NULL,
`about_image` varchar(150) NOT NULL,
`creator_id` smallint(5) unsigned NOT NULL,
PRIMARY KEY (`about_id`)
FOREIGN KEY (`creator_id`) REFERENCES `creator` (`creator_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ; 
```

现在说真的，它肯定不会变得更容易，但是每次我尝试它时，我都会收到以下错误：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FOREIGN KEY (`creator_id`) REFERENCES `creator` (`creator_id`) ) ENGINE=InnoDB ' at line 8 
```

我正在从在 MAMP 2.0 版中运行的 phpMyAdmin 3.5.4 访问 PHP 5.4.4 版

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:10:55.410

您的定义后缺少逗号`PRIMARY KEY`：

```
CREATE TABLE `about_creator` (
`about_id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
`about_title` varchar(50) NOT NULL,
`about_description` text NOT NULL,
`about_image` varchar(150) NOT NULL,
`creator_id` smallint(5) unsigned NOT NULL,
PRIMARY KEY (`about_id`),
FOREIGN KEY (`creator_id`) REFERENCES `creator` (`creator_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ; 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/2a274)上查看。

# ios - 如果语句在 Xcode 中被忽略

> ID：13464028
> 
> 赞同：-1
> 
> 时间：2012-11-19T23:09:12.083
> 
> 标签：ios, xcode, if-statement

在xcode中，当_nice为0时，仍然执行[self ifsss]。为什么当我明确声明它应该在日志中说“工作”时会这样？

```
 NSLog(@"nice is %@", _nice);

if (_nice != @"0") {
    [self ifsss];
    NSLog(@"Should not have worked %@", _nice);
}
else {
    NSLog(@"worked %@", _nice);
} 
```

NSLog 结果如下：

1.  不错是 22
2.  不应该工作 22

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T23:11:50.273

假设`_nice`是一个`NSString`，你需要做：

```
if (![_nice isEqualToString:@"0"]) { 
```

您不能对对象使用基本比较运算符，只能使用基本类型，如`int`or `float`。

# ssl - EventMachine 中的 TLS 连接如何工作？

> ID：13464038
> 
> 赞同：4
> 
> 时间：2012-11-19T23:09:55.867
> 
> 标签：ssl, eventmachine

我有一个基于 Protobuf 的自定义协议，我已将其实现为 EventMachine 协议，我想通过服务器和客户端之间的安全连接使用它。每次我从客户端向服务器发送消息时，我都会在消息前面加上一个 4 字节整数，表示要发送的 Protobuf 序列化字符串的大小，以便服务器在解析之前知道要从线路读取多少字节数据返回到 Protobuf 消息中。

我在客户端和服务器协议处理程序中调用`start_tls`回调`post_init`方法，服务器处理程序中的一个被传递服务器的私钥和证书。根据我正在打印的日志消息，在这个阶段似乎没有发生错误。

我遇到麻烦的地方是当我开始`receive_data`在服务器处理程序代码的回调中解析数据时......我从线路上读取了 4 个字节的数据并将其解压缩为一个整数，但解压缩的整数与我的整数不同从客户端发送（即我发送 17，但接收 134222349）。

请注意，当我不使用 TLS 时不会发生这种情况......如果我删除`start_tls`客户端和服务器代码中的调用，一切正常。

使用 TLS 时SSL/TLS 数据是否会传递给`receive_data`回调？如果是这样，我怎么知道来自客户端的数据何时开始？我似乎找不到任何讨论这个用例的示例代码......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-16T20:11:17.373

好的，所以通过对 EventMachine Google Group的[交叉发布，我发现了我的问题所在。](https://groups.google.com/forum/?fromgroups=#!topic/eventmachine/ONKQdSMGZwk)本质上，我试图在 TLS 握手完成之前将数据从客户端发送到服务器，因为我没有等到`ssl_handshake_completed`回调被调用。

这是我必须工作的代码，以防万一将来有人遇到这篇文章。:)

服务器端的处理程序代码：

```
require 'eventmachine'

class ServerHandler < EM::Connection
  def post_init
    start_tls :private_key_file => 'server.key', :cert_chain_file => 'server.crt', :verify_peer => false
  end

  def receive_data(data)
    puts "Received data in server: #{data}"
    send_data(data)
  end
end 
```

客户端的处理程序代码：

```
require 'eventmachine'

class ClientHandler < EM::Connection
  def connection_completed
    start_tls
  end

  def receive_data(data)
    puts "Received data in client: #{data}"
  end

  def ssl_handshake_completed
    send_data('Hello World! - 12345')
  end
end 
```

启动服务器的代码：

```
EventMachine.run do
  puts 'Starting server...'
  EventMachine.start_server('127.0.0.1', 45123, ServerHandler)
end 
```

启动客户端的代码：

```
EventMachine.run do                      
  puts 'Starting client...'              
  EventMachine.connect('127.0.0.1', 45123, ClientHandler)
end 
```

# ruby-on-rails - 无法在 Rails 3.2 上获得 AJAX 形式的部分工作

> ID：13464044
> 
> 赞同：0
> 
> 时间：2012-11-19T23:10:08.307
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, forms

我正在尝试使用 AJAX 呈现表单。非 ajax 版本可以正常工作，但 ajaxified 版本不能。它的链接在 index.html.erb 中。Webrick 服务器显示：

在 2012-11-19 17:19:27 -0500 开始 GET "/categories/3/new_sub" for 127.0.0.1
由 CategoriesController#new_sub 作为 JS
参数处理：{"id"=>"3"}
类别负载（0.1 ms) SELECT "categories".* FROM "categories" WHERE "categories"."id" = ? LIMIT 1 [["id", "3"]]
渲染类别/_form.html.erb (1.8ms)
渲染类别/new_sub.js.erb (3.6ms)
8ms 内完成 200 OK (Views: 6.3ms | ActiveRecord: 0.1毫秒）

这是我的类别控制器：

```
# GET /categories
# GET /categories.json
def index
  @categories = Category.roots

  respond_to do |format|
    format.html # index.html.erb
    format.json { render json: @categories }
  end
end

# GET /categories/1/new_sub.html
# GET /categories/1/new_sub.js
def new_sub
  @parent = Category.find(params[:id])
  @category = Category.new

  respond_to do |format|
    format.html
    format.js
  end
end 
```

index.html.erb：

```
<h1>Listing categories</h1>

<%= recurse_categories(@categories) %>

<br />

<%= link_to 'New Category', new_category_path %> 
```

recurse_categories 助手：

```
def recurse_categories(cats)
  s = "<ul>"
  cats.each do |cat|
    s << "<li id=\"#{cat.id}\">#{link_to cat.name, new_sub_category_path(cat), remote: true}</li>"
    if cat.has_children?
      s << recurse_categories(cat.children)
    end
  end
  s << "</ul>"
  s.html_safe
end 
```

new_sub.js.erb：

```
$('ul').after(<%= render partial: "form", locals: { parent: @parent, category: @category } %>); 
```

_form.html.erb：

```
<%= form_for(category) do |f| %>

  <div class="field">
    <%= f.text_field :name  %>
    <%= f.hidden_field :ancestry, value: "#{parent.ancestry + '/' + parent.id.to_s}" %>
    <%= f.submit "Create subcategory" %>
  </div>

<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:39:17.123

您的“ul”标签在类别错误的条件块下。您确定要将您的回复附加到“error_explanation”div 中吗？

你可以有一个 span 标签并在 new_sub.js.erb 中使用它

```
<div class="field">

 <span id="subcat"/>     

<%= f.text_field :name  %>
<%= f.hidden_field :ancestry, value: "#{parent.ancestry + '/' + parent.id.to_s}" %>
<%= f.submit "Create subcategory" %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T01:14:57.893

解决它！我只是忘记了 jquery 选择器和参数周围的引号，DUH！

# sql - 这两条SQL语句能合二为一吗？使用两个约束更改多个索引

> ID：13464047
> 
> 赞同：0
> 
> 时间：2012-11-19T23:10:22.800
> 
> 标签：sql, database

我有一个表单，用户可以使用它来编辑我的数据库中的数据。数据库的结构如下：

![桌子](../Images/ffa59babae0d6666494a14d4b8e053ba.png)

如果用户想要同时编辑 FAVE_COLOR 和 FAVE_FOOD，我将如何在我的 SQL 语句中执行此操作？我可以想到这一点，但有没有办法在一个声明中做到这一点？

```
string sql1 = "UPDATE MYTABLE " +
              "SET PROP_VALUE = '" + form["color"] + "' " +
              "WHERE ID = " + form["id"] + " " +
              "AND PROP_NAME = 'FAVE_COLOR'"

string sql2 = "UPDATE MYTABLE " +
              "SET PROP_VALUE = '" + form["food"] + "' " +
              "WHERE ID = " + form["id"] + " " +
              "AND PROP_NAME = 'FAVE_FOOD'" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:21:14.527

```
string sql = "UPDATE MYTABLE " +
             "SET PROP_VALUE = CASE " +
             "WHEN PROP_NAME = 'FAVE_COLOR' THEN '" + form["color"] + "' " +
             "WHEN PROP_NAME = 'FAVE_FOOD'  THEN '" + form["food"]  + "' " +
             "END " +
             "WHERE ID = " + form["id"] + " " +
             "AND PROP_NAME IN ('FAVE_COLOR', 'FAVE_FOOD')" 
```

但要小心 SQL 注入！您*确实*应该使用[准备好的语句](https://stackoverflow.com/a/60496)，将变量作为参数传递给其中，这些参数不会针对 SQL 进行评估。如果您不知道我在说什么，或者如何解决它，请阅读[Bobby Tables](https://stackoverflow.com/q/332365)的故事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:21:45.113

您可以使用 case 语句：

```
UPDATE MYTABLE
SET PROP_VALUE = (
 CASE favefood
   WHEN PROP_NAME = 'FAVE_FOOD'
   THEN 'PIZZA'
 CASE favecolor
   WHEN PROP_NAME = 'FAVE_COLOR'
   THEN 'BLUE'
WHERE ID = @myIdValue 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:21:40.917

对于 MS SQL Server，您可以使用 UPDATE FROM 来同时更新两个属性，如下所示：

```
CREATE TABLE MYTABLE (
  ID INT,
  PROP_NAME VARCHAR(20),
  PROP_VALUE VARCHAR(20));
go

INSERT INTO MYTABLE VALUES (1, 'A','B')
go

INSERT INTO MYTABLE  VALUES (1, 'C', 'D')
go

UPDATE MYTABLE
SET PROP_VALUE = X.PROP_VALUE
FROM MYTABLE MT JOIN (
  SELECT 'A' AS PROP_NAME, 'F' AS PROP_VALUE
  UNION
  SELECT 'C' AS PROP_NAME, 'G' AS PROP_VALUE) AS X ON MT.PROP_NAME = X.PROP_NAME
WHERE ID = 1 
```

对于其他 SQL DB 服务器，如果不完全相同，解决方案应该是相似的。

# c# - WebClient 状态码

> ID：13464051
> 
> 赞同：1
> 
> 时间：2012-11-19T23:10:47.710
> 
> 标签：c#, webclient, http-status-code-302

我正在使用 WebClient 从有时不可用的页面获取一些信息 [302 临时移动]。所以我想编程来检测页面是否存在

我尝试使用以下代码覆盖 WebClient WebResponse 以仅在页面状态正常但不起作用时才返回页面。

```
protected override WebResponse GetWebResponse(WebRequest request)
{
    var response = base.GetWebResponse(request);

    if (response is HttpWebResponse)
        return (response as HttpWebResponse).StatusCode == HttpStatusCode.OK ? response : null;
    return null;
} 
```

当我使用我的覆盖类来获取页面时（当它不可用时）它只是重定向并且没有返回 null

获取代码

```
private async Task<string> Get(string uri)
{
    return await Handler.DownloadStringTaskAsync(new Uri(uri));
} 
```

[我想要实现的目标]：我希望 Web 客户端尝试获取该页面但未找到，因此它已被重定向到另一个页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:17:13.393

`WebClient`默认情况下会自动跟随重定向（最多可达最大数量）。

如果您重写`GetWebRequest`以修改返回的`HttpWebRequest`，将其[`AllowAutoRedirect`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.allowautoredirect.aspx)属性设置为 false，那么我相信它只会直接返回 302 - 尽管可能通过异常...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:43:52.520

这不会告诉您状态，但可以通过您被重定向的事实来推断。

```
if(reponse.ResponseUri != request.RequestUri) {
   // if you really want to know the status
   // set AllowAutoRedirect = false;
   // and send another request in here.
} 
```

# php - 我如何在 php 中使用 ajax 在模式中检索配置文件数据？

> ID：13464052
> 
> 赞同：0
> 
> 时间：2012-11-19T23:10:49.767
> 
> 标签：php, mysql, ajax, codeigniter, modal-dialog

这是交易，我创建了一个搜索结果页面，我想打开一个模式并通过 php 中的 ajax 检索配置文件数据，但我不太确定如何实现它。我已经创建了模态，但我不知道如何从单击搜索结果中获取“id”，将其传递给 ajax 以检索配置文件详细信息。

Twitter 有这种功能。当您单击提要中的用户名时，它会打开一个模式并为您提供个人资料的简要概述以及指向完整个人资料的链接。

如果有人可以帮助我或为我指明正确的方向，那对我来说意义重大！:)

PS我正在使用codeigniter，如果有人想知道我正在使用什么框架。

编辑：这是代码

```
<?php
/*** PHP Search Results Loop ***/
if ($num > 0){
foreach ($query->result_array() as $row)
{
    echo "link to ajax"'>";
}
} else {
echo "<strong>results not found :(</strong>";
}?>

<script> /* jQuery Runs When Result Has Been Clicked */
    $('#ResultText').click(function() {

        var targetid = {
            id: /*Profile Id*/,
            ajax: '1'
        };

        /* Modal Code */
        $('.modal-backdrop, .modal-profilebox').css('display', 'block');
        $('.modal-backdrop').animate({'opacity':'.50'}, 100, 'linear');
        $('.modal-profilebox').animate({'opacity':'1.00'}, 200, 'linear');

        $.ajax({
            url: "<?php echo site_url('finder/modal'); ?>",
            type: 'POST',
            data: form_data,
            success: function(profileData) {
                $('.modal-profilebox').html(profileData);
            }
        });

        return false;
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:24:01.987

尝试这样的事情

```
public function ajax_user_profile($user_id)
{
    if( !$this->input->is_ajax_request() )
    {
        redirect('/'); //only allow ajax requests
    }

    try
    {
        $user_profile = ''; //grab user object from DB

        if( !$user_profile )
            throw new Exception("Error Message");
    }
    catch(Exception $e)
    {
        log_message('error', $e->getMessage());
        echo json_encode(array(
            'error' =>  1
        ));
        exit;
    }

    $data = $this->load->view(array(
        'some_view' =>  'some_view',
        'user'      =>  $user_profile
    ), TRUE); //NO Template, just the view by adding TRUE

    echo json_encode(array(
        'error' =>  0,
        'data'  =>  $data
    )); //return view data

} 
```

--

```
<a rel="modal" data-user-id="1" >Joe Bloggs</a> 
```

--

```
(function($){

    var userObj = {

        init : function(){
            this.getProfile();
        },
        getProfile : function(){

            var modalSearch = $("a[rel='modal']");

            modalSearch.on('click', function(){

                //trigger the modal window

                //request ajax
                $.ajax({
                    url : BASEPATH + 'users/profile/' + $(this).data('user-id'),
                    type : 'POST',
                    dataType: 'json',
                    success : function(callback){
                        if(callback.error ==0)
                        {
                            $('.modal-profilebox').html(callback.data);
                        }
                    }
                });
            });

        }
    }

    $(function(){
        userObj.init()
    });
})(jQuery); 
```

# java - 循环继承使用

> ID：13464055
> 
> 赞同：8
> 
> 时间：2012-11-19T23:10:57.490
> 
> 标签：java, inheritance

因此，如果我用 Java 编写以下代码：

```
public class A extends A{
    public static void main(String[] args){
    }
} 
```

这给出了涉及 A 的编译器错误消息循环继承。

如果我编写两个类 A 和 B 并且 A 继承 B 并且 B 继承 A，也会发生同样的情况。

这对我来说很有意义，因为很难想象这怎么可能。

然后，我向我大学的一位教授询问了这个问题。他说有些语言可以做到这一点，他感叹这在 Java 中是不可能的，并且他做过一些使用循环继承等的项目，但我无法真正理解其中的任何一个。他还提到他曾遇到过希望使用循环继承的问题。

你能告诉我这种奇怪的循环继承现象的可能用途吗？什么时候有可能，怎么做？有什么问题可能有用吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T00:07:13.657

我挖出了这个[有趣的参考资料](http://www.cs.washington.edu/research/projects/cecil/www/Vortex-Three-Zero/doc-cecil-lang/cecil-spec-46.html)：基本上它说只要没有重复的字段，循环继承就有效，因为查找任何字段只需要遍历循环的一个循环即可找出含义。如果一个字段被重复，那么这两个定义中没有一个比另一个更有效，显然会有问题。

因此，假设您要将一个人定义为人类和选民，并为每个人设置不同的属性。在伪代码中：

```
class Person extends Human:
  String name;

class Human extends Voter:
  String language;

class Voter extends Person:
  Country residence; 
```

现在您可以解决个人的不同方面而无需定义层次结构，并且您可以将不同的人实例化为人（有名字）、人（说某种语言）或选民（在特定国家/地区）。没有哪个方面比其他方面更重要。

虽然很有趣，但我认为在研究项目之外使用它并不实用。想象一下，为所有将参数传递给 super() 构造函数的类都有构造函数——很容易弄乱整个构造。

更新：给定的伪代码在翻译成 Java 8 时无法编译，显然在任何语言下（除了上面给出的链接所示的 Cecil）。似乎没有人发现任何有效的用途，因此不允许循环继承。这并不意味着这个概念本质上是不可能的；只是实际用途并不能证明实施特殊情况的努力是合理的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:14:18.150

如果这些类位于同一层次结构中，我只能看到它是可能的。将类层次结构视为一棵树，它就是这样。Java 会寻找至少高于或更高级别的层次结构。在某些语言中，您将能够从与您正在使用的类处于同一级别的类继承特征。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:19:26.897

我没有循环继承的感觉。我不知道为什么你的教授认为它在任何情况下都是有用的，即称为**IS-A**关系的继承关系指出如果 B 是 A 的子类，那么 B IS-A A 在任何地方都需要 A 的意义上a B 可以毫无问题地使用（*里氏替换原则*）。

现在，理论上，如果 A 是 B 的子类并且 B 是 A 的子类，那么这两个类必须具有完全相同的外部接口。这是因为如果您向其中任何一个添加一个方法，另一个将自动继承相同的方法，因此您必须要么重写它以获取另一个实现。

此外，您将在许多情况下发挥奇怪的副作用（想想方法`A.foo()`调用`super.foo()`和`B.foo()`调用`super.foo()`。我没有看到任何实际原因，因为这应该是允许的。

继承旨在作为一棵树，其中每个子类都指定树中的行为或类，在同一级别有两个类并不意味着任何有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-04T19:54:59.183

我不同意接受的答案，即他们的代码不会引发错误。我正在运行 Java 8 并编译了以下代码：

```
class Person extends Human:
  String name;
class Human extends Voter:
  String language;
class Voter extends Person:
  String residence; 
```

我收到一条错误消息，指出“错误：涉及 Person 的循环继承”。

因此，在 Java 中不能有循环继承。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-03T18:41:01.893

**循环继承**是没有用的，而且让我们看看为什么在逻辑上它是不允许的。

我想从`Object`类开始，如果一个类不扩展任何类它扩展`Object`类（这是真的），如果一个类扩展任何其他类间接扩展`Object`该类。

**例子：**

```
class B
{
..//
}
class A extends B
{
...//
} 
```

类`A`扩展`Object`，因为`B`类扩展`Object`类。

所以当我们做**Cyclic Inheritance**时，它​​从未扩展 Object 类。

**例子：**

```
class A extends A
{
} 
```

我希望我很清楚，所以一个不能扩展`Object`类的类在 Java 中是不可能的。

# html - 更改页面的缓存设置

> ID：13464057
> 
> 赞同：1
> 
> 时间：2012-11-19T23:11:07.423
> 
> 标签：html, mozilla, html5-audio

我想为我的网站禁用浏览器缓存。我怎么做？我根据页面中的图像加载音频文件，图像一直在刷新，但音频仅在 Mozilla 中保持不变，而在 Chrome 中运行良好。所以我想禁用缓存过程。这样 Mozilla 就不会从缓存中加载音频文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:23:44.030

我建议通过您的 .htaccess 文件执行此操作。以下所有代码均取自[html5 样板](https://github.com/h5bp/html5-boilerplate)。基本上，这是一个缓存控制列表，其中包含您能想到的每种类型的 Web 资源。因此，如果您希望您的音频没有缓存，只需将片段中的相应行设置为值“访问加 0 秒”。

希望这对你有用。

```
# ----------------------------------------------------------------------
# Expires headers (for better cache control)
# ----------------------------------------------------------------------

# These are pretty far-future expires headers.
# They assume you control versioning with filename-based cache busting
# Additionally, consider that outdated proxies may miscache
#   www.stevesouders.com/blog/2008/08/23/revving-filenames-dont-use-querystring/

# If you don't use filenames to version, lower the CSS and JS to something like
# "access plus 1 week".

<IfModule mod_expires.c>
  ExpiresActive on

# Perhaps better to whitelist expires rules? Perhaps.
  ExpiresDefault                          "access plus 1 month"

# cache.appcache needs re-requests in FF 3.6 (thanks Remy ~Introducing HTML5)
  ExpiresByType text/cache-manifest       "access plus 0 seconds"

# Your document html
  ExpiresByType text/html                 "access plus 0 seconds"

# Data
  ExpiresByType application/json          "access plus 0 seconds"
  ExpiresByType application/xml           "access plus 0 seconds"
  ExpiresByType text/xml                  "access plus 0 seconds"

# Feed
  ExpiresByType application/atom+xml      "access plus 1 hour"
  ExpiresByType application/rss+xml       "access plus 1 hour"

# Favicon (cannot be renamed)
  ExpiresByType image/x-icon              "access plus 1 week"

# Media: images, video, audio
  ExpiresByType audio/ogg                 "access plus 1 month"
  ExpiresByType image/gif                 "access plus 1 month"
  ExpiresByType image/jpeg                "access plus 1 month"
  ExpiresByType image/png                 "access plus 1 month"
  ExpiresByType video/mp4                 "access plus 1 month"
  ExpiresByType video/ogg                 "access plus 1 month"
  ExpiresByType video/webm                "access plus 1 month"

# HTC files  (css3pie)
  ExpiresByType text/x-component          "access plus 1 month"

# Webfonts
  ExpiresByType application/vnd.ms-fontobject "access plus 1 month"
  ExpiresByType application/x-font-ttf    "access plus 1 month"
  ExpiresByType application/x-font-woff   "access plus 1 month"
  ExpiresByType font/opentype             "access plus 1 month"
  ExpiresByType image/svg+xml             "access plus 1 month"

# CSS and JavaScript
  ExpiresByType application/javascript    "access plus 1 year"
  ExpiresByType text/css                  "access plus 1 year"

</IfModule> 
```

# javascript - 当要替换两个以上相同的单词时，Javascript .replace 不能与 .match 单词一起使用

> ID：13464062
> 
> 赞同：0
> 
> 时间：2012-11-19T23:11:32.347
> 
> 标签：javascript, jquery, html

当我要替换三个完全相同的单词时，我无法理解为什么我的代码不起作用。假设输入是“www.facebook.com www.facebook.com wwww.facebook.com”

我的输出将是这不是我想要的

```
<div class="content" style="font-size:13px;">
<a href="www.facebook.com">www.facebook.com</a>
<a href="&lt;a href=" www.facebook.com'=""> www.facebook.com</a>'&gt; www.facebook.com www.facebook.com
</div> 
```

但如果我输入让我们说“www.facebook.com www.google.com wwww.yahoo.com”我得到我想要的

```
<div class="content" style="font-size:13px;">
<a href="www.facebook.com">www.facebook.com</a>
<a href=" www.google.com"> www.google.com</a> 
<a href="wwww.yahoo.com">wwww.yahoo.com</a>
</div> 
```

我实际上想要做的是当用户在文本区域中输入链接并提交它时。该代码将用锚标记替换匹配链接。

这是我的 .js

```
var wordlink2 = /(^|[^\/])(www\.[\S]+(\b|$))/gim;
var hyperlink2;

hyperlink2 = content.match(wordlink2);

var $item = $("#ClassroomCommentComment").val();

if (hyperlink2 != null) {
    for (x = 0; x < hyperlink2.length; x++) {
        var site2 = hyperlink2[x].toString();
        var z2 = $item.replace(hyperlink2[x], "<a href='" + site2 + "'>" + site2 + "</a>");
        $item = z2;
    }
}​ 
```

我已经对此感到震惊。谁能帮我这个 ：（

**更准确地说，这是我的功能：**

```
function checkSubmit()
    {
        var $item = $("#ClassroomCommentComment").val();
        var $cont = $("#FileFile").val();

        if($item == "")
        {
            return false;
        }
        else
        {
            //$("#ClassroomCommentComment").css('color', 'white');

            if (hyperlink != null)
            {
                for (x= 0; x<hyperlink.length; x++)
                {

                    var site = hyperlink[x].toString();
                    var z = $item.replace(hyperlink[x],"<a href='" + site + "'>" + site +"</a>" );
                    $item = z;
                }       
            }

            if (hyperlink2 != null)
            {               
                for (x= 0; x<hyperlink2.length; x++)
                {
                    var site2 = hyperlink2[x].toString();
                    var z2 = $item.replace(hyperlink2[x],"<a href='" + site2 + "'>" + site2 +"</a>" );
                    $item = z2;

                }       
            }

            for (x=0; x<=arraycontroller; x++)
            {
                var n = $item.replace(fullnamewp[x],"<a href = 'http://www.classoncloud.org/" + userlink[x] + "'>" + fullnamewp[x] +"</a>" );
                $item = n;
                //$("#ClassroomCommentComment").val(n);
            }

            if (hash != null)   
            {
                for (x= 0; x<hash.length; x++)
                {
                    var new_item = hash[x].toString().substr(1).split("#");
                    var b = $item.replace(hash[x],"<a href='http://www.classoncloud.org/results/" + new_item + "'>" + hash[x] +"</a>" );
                    $item = b;
                }   
            }

            arraycontroller = 0;
            fullnamewp = [];
            userlink = [];

            var classroom_id = $("#ClassroomCommentClassroomId").val();
            var user_id = $("#ClassroomCommentUserId").val();
            var comment = $item;
            var image = "<?php echo $profile_pic; ?>";
            var name = "<?php echo $current_user_name; ?>";

        $.ajax({
        type: "POST",   
        url: '/learns/classroom/',
        data: "data[ClassroomComment][classroom_id]=" + classroom_id + "&data[ClassroomComment][user_id]=" + user_id + "&data[ClassroomComment][comment]=" + comment,
        dataType: "html",
        success: function(data){

        var parent_id = data;

        $('#comment-list').prepend('<div class="comments">  <a href="'+user_id+'"  class="image"><img src="'+image+'" width="50" height="50">   </a><a href="#" class="wall_delete" id='+parent_id+' style="display: none;"></a>    <div class="name">  <a href="'+user_id+'" class="close">X</a><a href="#" style="font-size:13px;">'+name+'</a><div class="content" style="font-size:13px;">'+comment+'</div> <div class="time"><div class="star-count"></div><a class="my-star" href="#" id='+parent_id+'>myStar .</a><a class="click" href="#">Comment</a> 1 seconds&nbsp;ago </div></div>       <form id="LearnsClassroomForm" accept-charset="utf-8" method="post" action="/learns/classComment"><input type="hidden" name="data[ClassroomComment][parent_id]" action="classroom" value='+parent_id+' id="ClassroomCommentParentId"><input type="hidden" name="data[ClassroomComment][classroom_id]" action="classroom" value="'+classroom_id+'"id="ClassroomCommentClassroomId"><input type="hidden" name="data[ClassroomComment][user_id]" action="classroom" value="'+user_id+'" id="ClassroomCommentUserId"><div class="displaycomment"><textarea name="data[ClassroomComment][comment]" class="textarea" placeholder="Write comment here..." id="ClassroomCommentComment" style="overflow: hidden; word-wrap: break-word; resize: none; height: 18px;"></textarea> <input type="submit" value="Comment" class="submit" style=" margin-right:7px; margin-top:10px;"> </div> </form></div>');

            }
        }); 

        $("#ClassroomCommentComment").val("");
        $("#ClassroomCommentComment").css('color', 'black');

        $($(this).parent().parent().find("textarea")).css("height","30px");     
        return false;   

        }   

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T23:36:10.750

我认为你让这比你需要的更复杂。该`.replace()`方法接受一个正则表达式来指定应该替换的内容，如果您`g`在正则表达式上设置标志，它会进行全局替换。因此，您可以通过一次调用对所有超链接进行适当的更改，`replace`如下所示：

```
var $item = $("#ClassroomCommentComment").val();
$item = $item.replace(/((^|[^\/])(www\.[\S]+(\b|$)))/gi, '<a href="$1">$1</a>');
// do something with $item 
```

演示：http: [//jsfiddle.net/7vcZd/1/](http://jsfiddle.net/7vcZd/1/)

无需先使用该`.match()`方法即可将该匹配的结果用作`.replace()`.

您的代码产生奇怪输出的原因是您将字符串作为第一个参数传递给`.replace()`- 当您这样做时，它不会进行全局替换，它只是替换第一个实例。因为您在循环中进行了相同的替换，所以第二次和后续替换都在`<a ...`您在第一次替换中添加的部分内。如果您`console.log($item)`在循环末尾添加一条语句，您将看到每次迭代发生了什么......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:37:21.443

替换在以下行中的工作方式是导致问题的原因：

```
$item.replace(hyperlink2[x],"<a href='" + site2 + "'>" + site2 +"</a>" ); 
```

它的作用是搜索`$item`第一种情况`hyperlink2[x]`并将其替换为链接。

在您的`www.facebook.com`3 次示例中，它将始终用链接替换 ​​www.facebook.com 的第一个实例。

要分解错误发生的位置，让我们通过 for 循环，看看每次 to 会发生什么`content`。

**在进入for循环之前**

```
www.facebook.com www.facebook.com www.facebook.com 
```

**在 for 循环的第一次交互之后**

```
<a href='www.facebook.com'>www.facebook.com</a>
www.facebook.com www.facebook.com 
```

**在 for 循环的第二次交互之后**

```
<a href='<a href='www.facebook.com'>www.facebook.com</a>
'>www.facebook.com</a>
www.facebook.com www.facebook.com 
```

它这样做是因为它正在寻找并替换 的第一个实例`www.facebook.com`，但原始字符串现在已更改，并且该实例现在位于 href='' 内。

最好创建一个字符串并返回它，而不是使用替换。

像这样：

**Javascript**

```
var content = "www.facebook.com www.facebook.com www.facebook.com";

var wordlink2 = /(^|[^\/])(www\.[\S]+(\b|$))/gim;
var hyperlink2 = content.match(wordlink2);

var returnString = "";

if (hyperlink2 !== null) {
    for (x = 0; x < hyperlink2.length; x++) {
        var site2 = hyperlink2[x].toString();
        returnString += "<a href='" + site2 + "'>" + site2 + "</a>\n";
    }
}

$("#ClassroomCommentComment").text(returnString); 
```

**例子**

[http://jsfiddle.net/RDkcc/1/](http://jsfiddle.net/RDkcc/1/)

或者更好的是，nnnnnn 的答案看起来最好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:45:04.793

从最初的问题我认为这是你想要的：http: [//jsfiddle.net/nb6SQ/6/](http://jsfiddle.net/nb6SQ/6/)

```
var wordlink2 = /(^|[^\/])(www\.[\S]+(\b|$))/gim;
var items = $(".content a");
var repval = $("#replacetext").val();

items.each(function(i,el) {
    var item = $(el);
 item.attr("href", item.attr("href").replace(wordlink2, repval));
 item.text(item.text().replace(wordlink2, repval));
}); 
```

# c++ - 检查是否在整数变量中设置了标志

> ID：13464063
> 
> 赞同：2
> 
> 时间：2012-11-19T23:11:37.847
> 
> 标签：c++, c, bit-manipulation

我正在制作自己的简单绘图引擎。我正在尝试使用我认为所谓的按位比较来确定变量是否已设置为特定值，但我可能错了。

我一直对以下是什么以及如何使用它感到有些困惑：

```
int DRAW_REPEAT_X = 70001; // I have a feeling I should make this value binary instead of a unique number, ie, 0
int DRAW_REPEAT_Y = 70002; // I have a feeling I should make this value binary instead of a unique number, ie, 2
int drawMethod    = DRAW_REPEAT_X | DRAW_REPEAT_Y; // this means I want to repeat an image on both the x and y axis doesn't it?

// Now I want to check if drawMethod has DRAW_REPEAT_X set: this is where I struggle to know how to check this
// Is the following correct?
if (drawMethod && DRAW_REPEAT_X) {
  // the user wants me to repeat an image along the x axis
}

// Now I want to check if drawMethod has DRAW_REPEAT_Y set: this is where I struggle to know how to check this
if (drawMethod && DRAW_REPEAT_Y) {
  // the user wants me to repeat an image along the x axis
} 
```

**以下代码是否正确检查是否设置了 DRAW_REPEAT_X？**在我的 anding 检查中它总是返回 1。

*编辑* 并检查是否设置了这两个位，我这样做吗？

```
if (drawMethod & DRAW_REPEAT_X & DRAW_REPEAT_Y) {
   // both set
}

// OR

if (drawMethod & DRAW_REPEAT_X && drawMethod & DRAW_REPEAT_Y) {
   // both set
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-19T23:21:11.063

为此，您的每个标志变量都需要设置一个唯一的位。那一点是“标志”。对于重要的是按位表示的常量，使用十六进制或八进制（因为这些基数是 2 的幂）比十进制更方便。因此，例如：

```
enum {
    DRAW_REPEAT_X = 0x01,    /* First bit set */
    DRAW_REPEAT_Y = 0x02,    /* Second bit set */
    DRAW_MIRRORED = 0x04,    /* Third bit set */
};

int drawMethod = DRAW_REPEAT_X | DRAW_REPEAT_Y;  /* Will have both first and second bits set */ 
```

然后使用按位与`&`而不是逻辑与`&&`来测试位。 当且仅当在和`a & b`中都设置了至少一位时，它将是非零的。在测试标志的情况下，其中之一将只设置一个位 - 您感兴趣的标志 - 因此当且仅当标志设置为时，结果将非零：`a``b``a & flag``a`

```
if (drawMethod & DRAW_REPEAT_X) {
  // the user wants me to repeat an image along the x axis
}

if (drawMethod & DRAW_REPEAT_Y) {
  // the user wants me to repeat an image along the x axis
} 
```

设置一位常量的十六进制模式是`0x01`, `0x02`, `0x04`, `0x08`, `0x10`, `0x20`, ...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-19T23:12:36.253

不，不是，您应该改用按位 AND 运算符 -`&`并将标志设置为二进制值 - 您的直觉在那方面是正确的。

设置特定位的一个常见技巧是使用移位运算符：

```
int DRAW_REPEAT_X = 0x1 << 0;  //first bit set to 1, others 0
int DRAW_REPEAT_Y = 0x1 << 1;  //second bit set to 1, others 0 
```

并将 int 检查为

```
if (drawMethod & DRAW_REPEAT_X)  //check it that particular flag is set, ignore others
{
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:14:36.247

就目前而言，您并没有使用标志，而是使用指示方法的值。更好的是使用某种位，如下所示：

```
int DRAW_REPEAT_X=0x01;
int DRAW_REPEAT_Y=0x02; 
```

然后像你现在做的那样检查 ifs，但是用一个 &

```
if (drawMethod & DRAW_REPEAT_X) 
```

通常，如果您使用的是类架构，您的整数 ( `DRAW_REPEAT_X`) 应该是。`public static`但不知道是不是这样，我不会包括他们

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-09T20:41:27.603

这是一个使用 WinAPI 的代码片段，它显示将两个标志设置为一个值，然后检查该值中是否存在这些标志中的至少一个。它应该`return 0;`

```
INPUT mip;
mip.type = INPUT_MOUSE;
mip.mi.mouseData = 0;
mip.mi.dwFlags = MOUSEEVENTF_ABSOLUTE | MOUSEEVENTF_MOVE;

if (mip.mi.dwFlags & (MOUSEEVENTF_ABSOLUTE | MOUSEEVENTF_HWHEEL))
    return 0; 
```

如果你想检查一个精确的值组合，你不需要使用按位运算符`&`，并且可以做一个简单的`==`检查。

例如，底部附近的更新线

```
INPUT mip;
mip.type = INPUT_MOUSE;
mip.mi.mouseData = 0;
mip.mi.dwFlags = MOUSEEVENTF_ABSOLUTE | MOUSEEVENTF_MOVE;

if (mip.mi.dwFlags == (MOUSEEVENTF_ABSOLUTE | MOUSEEVENTF_MOVE))
    return 0; 
```

# c++ - 类模板的友元函数的显式特化

> ID：13464064
> 
> 赞同：5
> 
> 时间：2012-11-19T23:11:37.193
> 
> 标签：c++, templates

[我在这里](https://stackoverflow.com/a/1297622/955273)阅读了 litb 对一个问题的回答，他详细说明了如何创建**类模板的专用友元函数**。

我试图创建一个符合他建议的示例（*最后的代码*）：

```
// use '<>' to specialize the function template with the class template's type
friend std::ostream& operator<< <>(std::ostream& os, const foo<T>& f) 
```

它会导致**编译器错误**：

```
error: defining explicit specialization ‘operator<< <>’ in friend declaration 
```

在特化中显式声明模板参数也不起作用：

```
friend std::ostream& operator<< <T>(std::ostream& os, const foo<T>& f) // same error 
```

另一方面，从使用特化改为使用友元**函数模板***确实*有效：

```
template<typename U>
friend std::ostream& operator<<(std::ostream& os, const foo<U>& f) // this works 
```

所以我的问题是：

*   是什么导致了第一个错误？
*   我怎样才能明确地专门`ostream operator`化周围的类模板专业化？

**下面的示例代码：**

```
#include <iostream>

// fwd declarations
template<typename T> struct foo;
template<typename T> std::ostream& operator<<(std::ostream&, const foo<T>&);

template<typename T>
struct foo
{
    foo(T val)
        : _val(val)
    {}

    friend std::ostream& operator<< <>(std::ostream& os, const foo<T>& f) // error line
    //template<typename U>
    //friend std::ostream& operator<<(std::ostream& os, const foo<U>& f) // this works
    {
        return os << "val=" << f._val;
    }

    T _val;
};

int main()
{
    foo<std::string> f("hello world");
    std::cout << f << std::endl;
    exit(0);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:26:46.910

在 litb 的示例中，他只是将专业化声明为班级中的朋友。他没有**定义**专业化，这是您的代码正在做的事情。不允许在类声明（或任何非命名空间范围）中定义特化。

你需要的是这样的：

```
template <class T>
class foo;

template<class T>
std::ostream& operator<<(std::ostream& os, const foo<T>& f)
{
    return os << "val=" << f._val;
}

template<typename T> 
struct foo
{
    // ...
private:
    friend std::ostream& operator<< <>(std::ostream& os, const foo<T>& f);
    T _val;
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:24:32.327

您有 2 个选择：

删除 fwd 声明并定义类中的所有内容。

**例子**

```
template <typename U>
friend std::ostream& operator<<(std::ostream& os, const foo<U>& f) // this works
{
    return os << "val=" << f._val;
} 
```

在类之外定义友元函数。

**例子**

```
template<typename T> struct foo;
template<typename T> std::ostream& operator<<(std::ostream&, const foo<T>&);

template<typename T>
struct foo
{
    foo(T val)
        : _val(val)
    {}

    friend std::ostream& operator<< <>(std::ostream& os, const foo<T>& f);

    T _val;
};

template <typename T>
std::ostream& operator<<(std::ostream& os, const foo<T>& f)
{
       return os << "val=" << f._val;
} 
```

# java - RESTful Web 服务返回 JSON 对象但缺少字段

> ID：13464065
> 
> 赞同：0
> 
> 时间：2012-11-19T23:11:37.127
> 
> 标签：java, jakarta-ee, java-ee-6, glassfish-3, netbeans-7

我在使用 net beans 向导创建并托管在 glassfish 3.1.2 中的 jpa 实体之上有一个简单的 WS。

调用 WS 时，仅返回带有数据的字段。从 Jason 或 XML 中省略空值字段。

我试过使用 @xmlelement(required=true) 但这被忽略了。

我应该从哪里开始调查，或者这是一个需要应用的简单设置。

感谢所有提示欢迎

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T06:53:55.120

我想补充@Maxim Shostuin 的答案：
想想以下场景：
A. 有人序列化您的对象（带有空字段）。
B. 这个搅拌被发送到执行反序列化的客户端。
C. 由于那里没有空字段的指示，因此创建的对象将包含字段的默认值（0 表示 int，null 表示非原始），在您的情况下为空。
所以这表明你这是正确的行为。[我在Ovirt](http://www.ovirt.org)开源项目中
也遇到过这个问题，我存储了一些实体的 json 序列化，然后这些实体的结构发生了变化，当我反序列化时，我没有错误，新字段只是得到空值，

我相信这是一个正确的行为。

# php - PHP 数组元素未放入字符串（错误）

> ID：13464074
> 
> 赞同：0
> 
> 时间：2012-11-19T23:12:04.727
> 
> 标签：php, forms, post, curl

以下代码无法按我的预期工作......

```
curl_setopt($ch, CURLOPT_POSTFIELDS, "password="+$alphas[$x]+"&submit=yes"); 
```

通过将字母放入字符串中， $alphas[$x] 部分似乎不起作用。下面几行我回显 $alphas[$x] 并且效果很好。

例如，如果我将第一行代码更改为...

```
curl_setopt($ch, CURLOPT_POSTFIELDS, "password=j&submit=yes"); 
```

它可以按预期完美运行，因此我认为 $alpahs[$x] 没有像应有的那样将字母放入字符串中。

```
$content = "7";
$x = 0;
$alphas = array_merge(range("A", "Z"), range("a", "z"));

while($x < 52) {
print_r($alphas[$x]);
$ch = curl_init();
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_URL, "/Demo/form.php");
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, "password="+$alphas[$x]+"&submit=yes");
$content=curl_exec($ch);

echo $content;
echo "Pass: ";
echo $alphas[$x];
echo "<br>";
$x++;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:12:45.347

句点是字符串连接运算符，而不是加号：

```
curl_setopt($ch, CURLOPT_POSTFIELDS, "password=".$alphas[$x]."&submit=yes"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T02:10:51.567

您还可以使用以下语法将变量插入双引号字符串：

```
curl_setopt($ch, CURLOPT_POSTFIELDS, "password={$alphas[$x]}&submit=yes"); 
```

# ruby - “从外部”控制 Ruby 应用程序的实践

> ID：13464079
> 
> 赞同：0
> 
> 时间：2012-11-19T23:12:27.020
> 
> 标签：ruby, sinatra, ipc, ruby-1.9, eventmachine

所以，我有一个长期运行的 Ruby 进程，它可以做各种各样的事情，这取决于它被告知要做什么（带有二进制消息的 EventMachine TCP 服务器）。现在，我想让某些人能够通过 Web 界面监控、更改、关闭给定进程。我计划为此使用[Sinatra.rb](http://www.sinatrarb.com/)，但我愿意接受更好的选择。

我最初的想法是在 a 中运行 Sinatra Web 界面（它基于[Rack](http://rack.github.com/)，适合那些不熟悉 Sinatra 的人）`Thread`并让它在后台运行。

但是，我认为如果我这样做可能会影响性能，所以我决定研究[IPC](http://en.wikipedia.org/wiki/Inter-process_communication)能力和 Ruby 的替代实现（[resque](https://github.com/defunkt/resque)、内存共享、[命名管道](http://www.pauldix.net/2009/07/using-named-pipes-in-ruby-for-interprocess-communication.html)等）。

我真的很喜欢 resque 的想法（而且这个名字真的很诙谐），但我不完全确定它是否是我需要的，或者它是否可能是矫枉过正。实际上，我什至不确定如何最好地使用 Sinatra*和*EventMachine 来实现它（尽管我没有阅读 resque 的完整文档，只是快速浏览并阅读了示例和用例。）。

想到的另一个想法是在内部使用 Sinatra `EventMachine::defer`，但这与创建新的本质上不一样`Thread`吗？

我从来没有用`Fiber`s 做过任何严肃的事情，所以我不知道它们的*全部*潜力，但它们确实在我脑海中闪过。

那么，哪些（或建议更好的）实践最适合 Ruby PCI。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T01:44:08.987

我建议您使用信号与正在运行的进程进行通信。

使用这种方法，您使用的框架无关紧要，
尽管我最好的建议是[Espresso Framework](http://e.github.com/)。

所以这里是交易。`kill`您可以通过接口向您的流程发送很多信号。

信号可以从命令行或另一个 Ruby 进程发送。

您所需要的只是在您的应用程序中捕获/捕获发送的信号。

示例：内部受控过程：

```
# build your app

Signal.trap("USR1") do
  # do some stuff here
end

Signal.trap("USR2") do
  # do another stuff here
end

# run your app 
```

当您启动您的应用程序时，请确保获得它的`PID`.

有了它，`PID`您可以通过`kill`
（不，除非您为此发送明确的信号，否则它不会杀死您的应用程序）向您的应用程序发送信号。

然后从另一个 Ruby 进程中，您可以执行以下操作：

```
Process.kill "USR1", PID 
```

或直接从命令行：

```
kill USR2 PID 
```

您的应用程序将捕获/捕获发送信号并执行相应的操作。

只需确保`PID`用受控应用程序的真实进程 ID 替换即可。

Unicorn Web 服务器成功地使用了这种做法。

以下是信号列表：

[http://en.wikipedia.org/wiki/Unix_signal](http://en.wikipedia.org/wiki/Unix_signal)

关于在 Ruby 中处理信号的一些见解：

[https://jellyjelly.net/blog/2010/04/27/unix-signal-programming-in-ruby/](https://jellyjelly.net/blog/2010/04/27/unix-signal-programming-in-ruby/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T05:46:29.993

您可以使用本地消息队列，例如 RabbitMQ（AMQP 的实现），但这实际上与您提到的使用 Redis 相同。

这种方法将不依赖于操作系统特定的进程间通信机制。所以是的，你将运行另一个服务，但你不会耦合到任何低级别。当需要扩展时，这可能是一件非常好的事情。

# java - Java：非静态变量 this 不能从静态上下文中引用

> ID：13464086
> 
> 赞同：0
> 
> 时间：2012-11-19T23:12:52.663
> 
> 标签：java, static

> **可能重复：**
> [“不能从静态上下文引用非静态方法”背后的原因是什么？](https://stackoverflow.com/questions/290884/what-is-the-reason-behind-non-static-method-cannot-be-referenced-from-a-static)

我是 Java 新手。我有以下几组代码。

```
class Default
{
    private short s;
    private int i;
    private long l;
    private float f;
    private double d;
    private char c;
    private String str;
    private boolean b;

    public static void main (String args[ ])
    {

        Default df = new Default();

        System.out.println("\n Short = "+s);

        System.out.println ("\n int i =" + i);
        System.out.println ("\n long l =" + l );
        System.out.println ("\n float f =" + f);
        System.out.println ("\n double d =" + d);
        System.out.println ("\n char c =" + c);
        System.out.println ("\n String s =" + str);
        System.out.println("\n boolean b =" + b);
    }
} 
```

这会产生一条错误消息作为此问题的主题，但以下代码可以完美运行。

```
class Default
{
    private short s;
    private int i;
    private long l;
    private float f;
    private double d;
    private char c;
    private String str;
    private boolean b;

    public static void main (String args[ ])
    {

        Default df = new Default();

        System.out.println("\n Short = "+df.s);

        System.out.println ("\n int i =" + df.i);
        System.out.println ("\n long l =" + df.l );
        System.out.println ("\n float f =" + df.f);
        System.out.println ("\n double d =" + df.d);
        System.out.println ("\n char c =" + df.c);
        System.out.println ("\n String s =" + df.str);
        System.out.println("\n boolean b =" + df.b);
    }
} 
```

这给出了期望的结果。这两组代码有什么区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:19:17.250

您有一个`Default`名为的实例化对象，`df`它正在调用这些变量。由于您创建的变量不是`static`，它们必须与已创建的某个对象分开。

```
Default df = new Default();
df.i //<- is now a part of the instantiated object df. 
```

`static`如果关键字不与对象一起使用，则使用关键字。所以你可以说：

```
private static char c; 
```

然后你可以`char c`随时调用，这将是`null`因为你还没有给它一个值。

您`static`将在没有对象的情况下使用该变量或方法时使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:34:40.250

两组代码之间的区别在于，在第二个示例中，您有一个类的实例，当您说`Default df = new Default();`.

您已将`Default`类中的所有变量声明为实例级变量，这意味着为了访问它们，您必须通过类的特定实例。或者换一种说法，你的类的每个实例都有自己的一组变量，所以编译器知道你实际访问的是哪个实例的唯一方法是你先指定你想使用的实例。

例如，您可以这样做：

```
Default df = new Default();
Default anotherOne = new Default();

df.s = 1;
anotherOne.s = 2;

System.out.println("\n Short(df) = "+df.s);                  //'1'
System.out.println("\n Short(anotherOne) = "+anotherOne.s);  //'2' 
```

尝试直接从`main()`（或从任何其他静态方法）访问实例变量的问题在于该`main()`方法不直接与您的类的任何实例相关联。所以在这种情况下，编译器不知道从哪个实例中获取变量，除非您明确指定一个。

当然，您可以将变量设置为静态，但是无论您创建多少个实例，您都只需为该类设置一组变量，而不是每个实例的一组值。在这种情况下，示例中的代码 about 仍然会编译和运行（尽管它会/应该产生编译器警告），但两个语句都会打印“2”，因为`s`每个实例只有一个变量而不是一个变量类的。

# php - php 和错误的输出与 UTF-8 编码

> ID：13464087
> 
> 赞同：1
> 
> 时间：2012-11-19T23:13:01.093
> 
> 标签：php, utf-8

我正在使用 php 来读取包含任何类型字符的 .txt 文件。当我使用php函数时，可以正确识别诸如éàêô...之类的utf8_decode()字符，但汉字显示为????。当我不使用 utf8_decode() 时，汉字的回声输出类似于 åŒ—äº¬å。奇怪的是，在生成的网页的源代码中，汉字是正确显示的。

我该怎么做才能有正确的输出？

我使用 fgets 函数创建一个变量 $buffer 以读入 .txt 文件，然后：

```
$buffer = explode(" ", $buffer);

foreach($buffer as $word){
    //$word=utf8_decode($word);
    echo "$word \n";
} 
```

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:58:40.820

看看 mb_string 的不同功能 - [http://php.net/mb_string](http://php.net/mb_string)

# ios - XCode 部署目标 iOS 6 = 兼容？

> ID：13464089
> 
> 赞同：25
> 
> 时间：2012-11-19T23:13:17.047
> 
> 标签：ios, deployment, xcode4.5

我似乎没有正确理解 XCode (4.5) 中特定部署目标的影响。具体来说，我在之前为部署目标 5.0 设置的应用商店中获得了一个应用，这意味着在应用商店页面上它显示“需要 iOS 5.0”。因此，当我现在在下一次更新中将部署目标设置为 6.0 时，这是否意味着它*需要*iOS 6 否则将无法启动？我没有在更新中使用新的 iOS 6 功能。

我想这意味着我的部署目标应该保持在 5.0，但是那么更改部署目标的意义何在（前提是您之前使用的那个不是完全过时的）？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-11-19T23:21:55.753

有两个主要设置用于定位构建：

基础 SDK 和部署目标。

**基础 SDK** = 我希望此应用程序提供哪些最新功能？

**部署目标**= 我希望能够运行此应用程序的最早操作系统是什么？

因此，如果您将这两者都设置为 iOS 6，则用户*必须*拥有 iOS 6 才能安装或运行该应用程序。

如果您有 iOS 5.0 的部署目标和 6.0 的 Base SDK，这意味着它将在 iOS 5.0 中安装和运行，但是如果用户正在运行，您需要小心分支代码并且不要使用任何 iOS 6.0 功能iOS 5.0 设备。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-19T23:22:02.917

> 因此，当我现在在下一次更新中将部署目标设置为 6.0 时，这是否意味着它需要 iOS 6 否则将无法启动？

是的，如果您的部署目标是 iOS 6，那么用户将需要 iOS 6 或更高版本才能运行它。简单如。

您的部署目标是受支持设备的基准，它是您支持的最低版本。这**并不**意味着您不能使用 iOS 6 的特定功能，但这确实意味着您需要在运行时考虑 iOS 5 用户（请参阅[iOS SDK 兼容性指南](http://developer.apple.com/library/ios/#documentation/developertools/conceptual/cross_development/Introduction/Introduction.html)）

开发人员通常做的是更新他们的**基础 SDK**。这意味着他们能够利用 SDK 的最新功能，为使用该 iOS 版本的用户提供更好的用户体验。拥有 iOS 6 的基础 SDK**并不**意味着该应用程序不适用于 iOS 5 用户。

# javascript - 为什么这个 javascript 在本地运行而不是在 Web 服务器上运行？

> ID：13464098
> 
> 赞同：2
> 
> 时间：2012-11-19T23:14:23.493
> 
> 标签：javascript, jquery

我的页面上有以下 Javascript/jQuery：

```
<script>
 $("#mymarkdown").load("./LPInfo.md");
 var md = markdown.toHTML($("#mymarkdown").html());
 $("#mymarkdown").html(md);
</script> 
```

该页面在这里：

[http://www.nickhodges.com/LeanTed/bootstrap/about.html](http://www.nickhodges.com/LeanTed/bootstrap/about.html)

该页面使用引导程序。渲染代码时，我在控制台中查看并没有看到任何错误。

正如你所看到的，它没有做我想要的，它使用 markdown.js 将文件的内容呈现为 HTML。

这是奇怪的部分，也是我问题的根源：

如果我将页面作为本地文件打开，Chrome 什么也不做。IE9 将打开并正确呈现页面，但前提是我授予运行脚本的权限。

两种浏览器都无法使用上述链接正确呈现页面。Firefox 也有同样的结果。

我承认在这一切上几乎是一个 n00b，但我无法解释这种不一致的行为。我知道代码正在访问本地文件，但是通过 Web 服务器访问时这应该不是问题，对吧？

无论如何，我们将不胜感激。

更新：这是页面的代码：

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>LeanTed Markdown Editor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <link href="css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="../assets/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#">LeanTed Markdown Editor</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li><a href="hero.html">Home</a></li>
              <li class="active"><a href="#">About</a></li>
              <li><a href="http://www.nickhodges.com/contact.aspx">Contact</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container">
      <div id="mymarkdown"></div>
    </div> <!-- /container -->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="../assets/js/bootstrap-transition.js"></script>
    <script src="../assets/js/bootstrap-alert.js"></script>
    <script src="../assets/js/bootstrap-modal.js"></script>
    <script src="../assets/js/bootstrap-dropdown.js"></script>
    <script src="../assets/js/bootstrap-scrollspy.js"></script>
    <script src="../assets/js/bootstrap-tab.js"></script>
    <script src="../assets/js/bootstrap-tooltip.js"></script>
    <script src="../assets/js/bootstrap-popover.js"></script>
    <script src="../assets/js/bootstrap-button.js"></script>
    <script src="../assets/js/bootstrap-collapse.js"></script>
    <script src="../assets/js/bootstrap-carousel.js"></script>
    <script src="../assets/js/bootstrap-typeahead.js"></script>

    <script src="markdown.js"></script>

    <script>
     $("#mymarkdown").load("./LPInfo.md");
     var md = markdown.toHTML($("#mymarkdown").html());
     $("#mymarkdown").html(md);
    </script>

  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-19T23:20:43.057

问题是您试图`markdown.toHTML`在内容`#mymarkdown`完全加载到 DOM 之前运行它（[`load`](http://api.jquery.com/load/)异步）。使用“完成”回调，`load`它可以工作：

```
$("#mymarkdown").load("./LPInfo.md", function() {
   var md = markdown.toHTML($("#mymarkdown").html());
   $("#mymarkdown").html(md);
}); 
```

（它在本地工作的原因可能是因为`lpinfo.md`它几乎是即时加载的，或者是因为 1\. 对 localhost 的 Ajax 调用非常快，或者 2\. 您的浏览器已经缓存了来自 localhost 的文件。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:23:02.550

这样做：

```
$(function () {
    $.get( './LPInfo.md', function ( data ) {
        $( '#mymarkdown' ).html( markdown.toHTML( data ) );
    });
}); 
```

因此，代码位于 DOMContentLoaded 处理程序中，以确保 DOM 已准备就绪（因为您正在向其中注入内容）。此外，`$.get`这里是适当的检索机制。您正在做的事情`.load()`在您的情况下没有多大意义。

你在做什么`.load()`：

1.  通过 Ajax 获取 MD 文件，
2.  将其内容插入 DOM，
3.  从 DOM 中检索该内容，
4.  使用 Markdown 处理内容，
5.  将生成的 HTML 源代码插入 DOM。

我的代码在做什么：

1.  通过 Ajax 获取 MD 文件，
2.  使用 Markdown 处理其内容，
3.  将生成的 HTML 源代码插入 DOM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:22:41.073

查看有关如何通过 XHR 启用本地文件系统访问的[这个](https://stackoverflow.com/questions/3102819/chrome-disable-same-origin-policy)或[那个问题。](https://stackoverflow.com/questions/2541949/problems-with-jquery-getjson-using-local-files-in-chrome)

您的实际问题是[`.load()`](http://api.jquery.com/load/)它只会*启动*文件的*异步*加载。但即使在加载之前，您也会获得 HTML 内容（可能是空的？）并将其呈现为降价。不久之后，该元素将被 ajax 回调覆盖。使用回调参数！

`load`如果您不加载 HTML，则根本不要使用。jQuery 有一个[强大的 ajax 功能](http://api.jquery.com/extending-ajax/)，你甚至可以在它上面设置一个 Markdown2html 转换器，它在提供 markdown 文件并且需要 html 时自动使用：

```
$.ajaxSetup({
    accepts: {
        "markdown": "text/x-markdown" // MIME type
    },
    contents: {
        "markdown": /markdown/ // MIME type matcher
    },
    converters: {
        "markdown html": markdown.toHTML
    }
}); 
```

但为了您的目的，只需使用一个简单的[`.ajax`调用](http://api.jquery.com/jQuery.ajax/)：

```
$.ajax("./LPInfo.md").done(function(md) {
    $(function() {
        $("#mymarkdown").html(markdown.toHTML(md));
    });
}); 
```

# gcc - 使用带有调试符号的编译标志 -ffunction-sections

> ID：13464099
> 
> 赞同：1
> 
> 时间：2012-11-19T23:14:24.360
> 
> 标签：gcc, assembly, debug-symbols, sections

我正在使用 gcc 标志 -ffunction-sections 编译一个 C 文件，以将每个函数移动到它自己的部分中。汇编程序抛出错误：

```
job_queue.s:2395: Error: operation combines symbols in different segments 
```

此处给出了第 2395 行的编译器汇编输出：

```
.section    .debug_ranges,info
.Ldebug_ranges0:
.4byte  .LBB7-.Ltext0 
```

符号 LBB7 位于名为“.text.add_event_handler”的函数（因此该节）中 符号 Ltext0 位于名为“.text”的（否则为空）节中

GCC --version 给出：

```
pic30-elf-gcc.exe (GCC) 4.0.3 (dsPIC30, Microchip v3_30) (B) Build date: Jun 29 2011 
```

如果我使用编译器标志 -g0 （关闭调试信息），一切都会编译并完美运行。

我的问题：这个 GCC 输出明显错误吗？在我看来，GCC 应该从 .add_even_handler 部分而不是 .text 部分的开头计算符号 LBB7 的偏移量。

我怀疑我误解了什么，因为我在谷歌上找不到任何有同样困难的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T07:53:11.473

GCC 输出肯定是错误的。也许它已在较新的 GCC 版本中修复。如果您无法升级编译器，请尝试使用`-gdwarf-2`或编译失败`-gdwarf-2 -gstrict-dwarf`（因为`-gstrict-dwarf`您也必须升级编译器）。

此选项的作用是指示 GCC 生成（严格）DWARF2，它不包括在 DWARF3 中引入的非连续地址范围支持。

当然，这可能会降低调试信息的质量，YMMV。

# html - 我应该在菜单的哪里添加过渡效果？

> ID：13464101
> 
> 赞同：2
> 
> 时间：2012-11-19T23:14:34.217
> 
> 标签：html, css, drop-down-menu, menu, transition

我希望在我当前的 CSS 下拉菜单中添加一个过渡。

我有我的“过渡：高度缓入 500 毫秒；” 代码都准备好了，我只需要知道在哪里添加它。

我的菜单设置是这样的：

```
<ul id="nav">

    <li>
        <a href="/about/index.html">About Us <img style="border:0;" src="/index_files/darrow.png" /></a>

        <ul id="accordion">

            <li><a href="/about/mission.html">Who We Are</a></li>
            <li><a href="/about/contactUs.php">Contact Us</a></li>
            <li><a href="/about/mission.html">Join Us For Worship</a></li>
            <li><a href="/about/staff.html">Meet Our Staff</a></li>

        </ul>

    </li>
</ul> 
```

所以，我想知道我会将转换代码放在我的 .css 文件中以影响“手风琴”部分的位置。（我可以删除该`id="accordion"`部分，那只是在测试中。

感谢所有帮助，谢谢。

编辑：这是CSS：

```
#nav {

    font-size:20px;
    text-align:center;
    position:relative;
    z-index:500;
    display:block;
    margin-bottom:20px;
    padding:0;
    width:950px;
    background:#33A1DE;
    float:left;
    border-bottom:none;
    color:white;
    -moz-box-shadow: 0px 5px 10px #333333;
    -webkit-box-shadow: 0px 5px 10px #333333;
    box-shadow: 0px 5px 10px #333333;
}

#nav a:visited, #nav a {
    color:white;
}

#nav li a, #nav li {
    float:left;

}

#nav > li {
    line-height:2em;
    width:20%;
    list-style:none;
    position:relative;
    border-top:none;
    border-right:1px solid white;
    box-sizing:border-box;
    -moz-box-sizing:border-box;
    -webkit-box-sizing:border-box;
}

#nav > li.right {
    line-height:2em;
    width:20%;
    list-style:none;
    position:relative;
    border-right:none;
    box-sizing:border-box;
    -moz-box-sizing:border-box;
    -webkit-box-sizing:border-box;
}

#nav li a {
    height:100%;
    width:100%;
    text-decoration:none;
    background:#33A1DE; 
}

#nav li a:hover {
    background:#000000;
}

/* Submenu */

#nav li ul {
    list-style:none;
    width:100%;
    display:none;
    position:absolute;
    left:0;
    top:100%;
    padding:0; margin:0;
}

#nav li ul:last-child {
    border-bottom:1px solid white;
}

#nav li:hover > ul {
    display:block;
}

#nav li ul li, #nav li ul li a {
    float:none;
}

#nav li ul > li {
    left:-1px;
    text-align:center;
    margin:auto;
    position:relative;
    box-sizing:border-box;
    -moz-box-sizing:border-box;
    -webkit-box-sizing:border-box;
    _display:inline; /* for IE6... God knows why */
}

#nav li ul li a {
    display:block;
    border:1px solid white;
    border-bottom:none;
}

/* Sub-Submenu */

#nav li ul li > ul {
    list-style:none;
    display:none;
    position:absolute;
}

#nav li ul li:hover ul {
    border-left:1px solid white;
    z-index:5;
    left:0px;
    top:0px;
    left:100%;
    width:200px;
}

#nav li ul li ul:last-child {
    border-bottom:1px solid white;
}

#nav li ul li:hover ul.youth {
    border-left:1px solid white;
    z-index:5;
    left:0px;
    top:-100%;
    left:100%;
    width:200px;
    box-sizing:border-box;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T07:43:48.927

首先删除`display:none`from 到手风琴。然后指定手风琴 li 元素的高度以及过渡类型。在 About us li 的 :hover 状态下，您指定手风琴 li 的新高度。 [演示](http://jsfiddle.net/vpDEK/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:16:41.990

`:hover`您在菜单高度更改（而不是状态）的相同规则上添加该指令。

如果您想要更详细的答案，您必须向我们提供更多详细信息。

# javascript - 在 div 中渲染把手脚本

> ID：13464110
> 
> 赞同：0
> 
> 时间：2012-11-19T23:15:35.670
> 
> 标签：javascript, html, ember.js, handlebars.js

我想在`div`. 这曾经可以与*ember.0.9.8.js*一起正常工作，但现在我正在使用*ember-1.0.0-pre.2.js*和*handlebars-1.0.rc.1.js*它不再工作了。渲染的脚本放在`div`.

这是一个说明问题的 JSFiddle：http: [//jsfiddle.net/YnwQB/](http://jsfiddle.net/YnwQB/)

这与 ember 9.8 相同，效果很好：http: [//jsfiddle.net/zWGyn/](http://jsfiddle.net/zWGyn/)

这是一个错误吗？还是我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T03:06:06.957

我根据对我报告的 Ember.js[问题](https://github.com/emberjs/ember.js/issues/1552#issuecomment-10541095)的一些评论回答了我自己的问题：

我必须`data-template-name="application"`在`rootElment`. `Ember.Application`这是解决它的jsfiddle：http: [//jsfiddle.net/YnwQB/5/](http://jsfiddle.net/YnwQB/5/)

# java - 以编程方式访问应用程序上下文和上下文位置

> ID：13464113
> 
> 赞同：2
> 
> 时间：2012-11-19T23:15:42.343
> 
> 标签：java, spring, applicationcontext, spring-test

我有一些测试（我没有编写它们，我正在维护它们）使用 spring ContextConfiguration 注释来提供应用程序上下文：

```
@ContextConfiguration(locations = { "testCustomContext.xml" })
public class MyTest  {
} 
```

无论如何，有几个问题。我对不指定 file:/ 或 classpath:/ 的 spring 自定义上下文位置不太熟悉。这是什么意思？此测试类路径上有很多具有该名称的资源。他们都加载了吗？如果没有，Spring 怎么知道要加载哪个？

其次，有没有办法以编程方式访问以这种方式连接的弹簧上下文？

即是否有一个静态 Spring Class 或 ThreadLocal 变量可以让我访问当前上下文？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:18:50.057

您可以通过在测试类中自动装配来访问应用程序上下文：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration
public class MyTest {

    @Autowired
    private ApplicationContext applicationContext;

    // class body...
} 
```

至于你的第二个问题：

> 我对不指定 file:/ 或 classpath:/ 的 spring 自定义上下文位置不太熟悉。这是什么意思？此测试类路径上有很多具有该名称的资源。他们都加载了吗？如果没有，Spring 怎么知道要加载哪个？

来自 Java 文档：

> 普通路径（例如“context.xml”）将被视为与定义指定类的包相关的类路径资源。以斜杠开头的路径被视为绝对类路径位置，例如：“/org/springframework/whatever/foo.xml”。引用 URL 的路径（例如，前缀为 classpath:、file:、http: 等的路径）将不加改变地添加到结果中。

`Resources`您可以在文档中了解 Spring ：http: [//static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/resources.html](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/resources.html)

JavaDocs`@ContextConfiguration`也可以为您提供更多知识。

我鼓励你学习 Spring Docs。

# jenkins - 如何为 CloudBees 构建指定构建机器大小

> ID：13464114
> 
> 赞同：0
> 
> 时间：2012-11-19T23:15:44.203
> 
> 标签：jenkins, cloudbees

如果我想设置 jenkins 构建从机大小 - 例如将其限制为“m1.large”大小 - 我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:15:44.203

您检查选项“限制此构建可以运行的位置”并将其放入“m1.large”

见这里[http://developer.cloudbees.com/bin/view/DEV/m1.large+support+for+Jenkins+jobs](http://developer.cloudbees.com/bin/view/DEV/m1.large+support+for+Jenkins+jobs)

# blackberry - 如何验证从 TextField 获取的 URL？

> ID：13464119
> 
> 赞同：0
> 
> 时间：2012-11-19T23:16:13.527
> 
> 标签：blackberry

黑莓中是否有可以验证 URL 的 API？
我正在使用愚蠢的方法

```
开始（http://）
```

并读取字符串的索引以确保它包含“.com/”和其他字符串以确保它看起来像一个验证 URL。
但我觉得这是一种愚蠢而漫长的使用方式。
是否有任何 API 可以使它更容易？
**我正在寻找在黑莓 API 而不是外部包中实现它**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T14:22:32.670

在 API 中，唯一的类是：

*   [`URLTextFilter`](http://www.blackberry.com/developers/docs/6.0.0api/net/rim/device/api/ui/text/URLTextFilter.html): 仅用于将其添加到文本字段（调用`EditField.setFilter`）。它将丢弃无效字符。
*   [`URI`](http://www.blackberry.com/developers/docs/6.0.0api/net/rim/device/api/io/URI.html)：它允许您通过调用来验证 URI `URI.create`。当然，不是所有的 URI 都是 URL，但 URL 应该是 URI。

# rotation - 处理中的“旋转”和“翻译”让我头疼

> ID：13464122
> 
> 赞同：2
> 
> 时间：2012-11-19T23:16:43.993
> 
> 标签：rotation, processing

作为进入处理的一个小作业，我不得不编写一些代码来获得以下内容： ![任务](../Images/3717934236a980db525005a053345ee5.png)

使用

```
public void setup() {
   size(300,200);
   noFill();
   rect(100, 20, 40, 80);
   ellipseMode(CENTER);
   fill(#000000);
   ellipse(width/2, height/2, 5,5);

   noFill();
   translate(width/2, height/2);
   rotate(radians(65));
   rect(-20, -40, 40, 80);
}
public void draw() {
} 
```

到目前为止，这非常有效。但我不喜欢我必须更改底部`rect`指令内的坐标才能正确旋转。我知道通过旋转您不会旋转单个元素，而是旋转整个坐标系。我不知道将哪些值放入`translate`指令中以使输出如上图所示，同时在`rect`命令中仍使用相同的坐标。

任务已经用我使用的代码完成了，我只是不太喜欢它。所以这不仅仅是要求别人做我的功课，而是纯粹的兴趣。

编辑：一个问题的更一般化的尝试：我如何知道在旋转之前要翻译哪些值以获得我想要的任何结果？有没有办法计算它们？当然，这不仅仅是尝试，不是吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T03:28:34.447

处理中的很多混淆是坐标系。在处理中，原点 (0,0) 位于屏幕的左上角，屏幕上仅显示正坐标。对此非常常见的解决方法是调用：

```
translate(width/2, height/2); 
```

在您的`void draw()`方法开始时。这样 0,0 现在位于草图的中心，任何后续调用的方法`rotate(radians(65))`都将从草图的中心执行操作。

这也很好，因为使用`P3D`或`OPENGL`渲染器的草图通常会调用 translate 以将坐标系更改为更易于使用的东西。例如，位于 0,0 或 0,0,0 的对象位于中心，这使得相机更容易围绕对象旋转或让对象围绕其中心旋转。

另一种绘制对象的流行方法是如上所述设置原点，而不是给出每个对象的坐标，即`rect(-100, -50, 50, 50)`在平移之前使用 popMatrix() 和 pushMatrix，然后在 0,0 处绘制每个对象，如下所示：

```
translate(width/2, height/2);
pushMatrix();
  translate(-100, -50);
  rect(0,0,50,50);
popMatrix(); 
```

如果您认为最终可能会迁移到 3d 渲染器，这是在 2d 渲染器中使用的好方法，因为您可以轻松替换`rect()`或`box()`创建`sphere()`自己的方法或对象，假设原点位于 0,0 处绘制几何图形。

如果您将 x 和 y 坐标替换为变量或在 for 循环中遍历数组，则可以非常轻松地在 2d 或 3d 中绘制数百或数千个形状，而只需最少的工作量和最少的代码重写。

* * *

更新：根据他们的评论添加了对原始海报的说明。

* * *

我稍微改变了这个问题，向您展示我将如何解决这个问题。我正在使用推送和弹出矩阵展示我上面描述的翻译/旋转方法。我只是在猜测这些值，但如果您想要精确的像素，您可以在 Photoshop 或预览等图像编辑程序中进行测量。

![矩形1](../Images/f07dd4cc864e11fbff44ca4190d49abd.png)

```
translate(180, 150);
rect(0, 0, 180, 80); 
```

![矩形2](../Images/af8cbf5d9c8d111071c62b7d33dcecee.png)

```
translate(185, 170);
rotate(radians(65));
rect(0, 0, 180, 80); 
```

![椭圆](../Images/ecafc87efd50ec919a3996d1998ef48a.png)

```
translate(180, 250);
ellipse(0, 0, 8, 8); 
```

`pushMatrix()`将它们与和放在一起`popMatrix()`。

```
void setup(){
  size(400,400);
}

void draw(){
  // rect1
  noFill();
  pushMatrix();
    translate(180, 150);
    rect(0, 0, 180, 80);
  popMatrix();
  // rect2
  pushMatrix();
    translate(185, 170);
    rotate(radians(65));
    rect(0, 0, 180, 80);
  popMatrix();
  // ellipse
  fill(0);
  pushMatrix();
    translate(180, 250);
    ellipse(0, 0, 8, 8);
  popMatrix();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T02:41:35.253

旋转远离应用于原点 (0,0)，因此您要绘制轴以在原点旋转。或将坐标系原点移动到您的轴。这确实令人困惑。使用转换时，我倾向于始终在原点绘制。试试这个，看看它是否让事情更清楚......或者更少:) 还有 push/popMatrix() 来控制转换的范围......

```
public void setup() {
  size(300, 380);
  smooth();
}
public void draw() {
  background(0);
  stroke(255);
  //use push/pop Matrix to control scope of translate and rotate
  pushMatrix();
  //move coordinates system origin to center of screen
  translate(width/2, height/2);
  // rotate with origin as axis
  rotate(radians(mouseY));
  //draw at origin (now temp moved to center of screen)
  // white line 
  line(0, 0, 150, 0);
  // here all coordinate system is back to normal
  popMatrix();

  //draw with normal system red line at origin
  stroke(255, 0, 0);
  line(0, 0, 150, 0);

    //draw with normal system blue line at centre
  stroke(0, 0, 255);
  line(width/2, height/2, width/2 + 150, height/2);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-22T13:27:31.703

> 在我的特定示例中，知道如何在不更改矩形坐标的情况下平移和旋转以获得图片中的结果？

好吧，你需要在原点绘制才能正确使用旋转，所以你只是在处理矩形的原点......因为它在你的代码中，默认的原点是左上角，所以你做了一个关闭设置（从（0,0））在坐标（0,0）处绘制它的中心，而不是角，然后旋转中间。做得好。您找到的值是负半矩形宽度（-20）和负半矩形高度（-40）并非巧合。如果更改为 rectMode(CENTER)，则只能在 (0,0) 处绘制。这同样适用于平移，您可以只平移到所需的点，即屏幕的中心，那里有椭圆。使用半宽和半高做什么...

看：

```
public void setup() {
  size(300, 200);
  smooth();
  ellipseMode(CENTER);
  rectMode(CENTER);
  noFill();
  // here converting the coordinates to work with CENTER mode
  //could have changed the rect mode just after this
  // but i kept as an illustration
  int rwidth = 40;
  int rheight = 80;
  int xpos = 100 + rwidth/2;
  int ypos = height/2 - rheight/2 ;

  rect(xpos, ypos, rwidth, rheight);

  fill(#000000);
  ellipse(width/2, height/2, 5, 5);

  noFill();
  pushMatrix();

  translate(width/2, height/2);

  //draw at origin gray
  stroke(150);
  rect(0, 0, 40, 80);
  // then rotate
  rotate(radians(65));
  // draw again black
  stroke(0);
  rect(0, 0, 40, 80);

  popMatrix();

  // here using the cordinates calculated before as a translate value 
  // we draw at origin, but it appears at same place
  stroke(230,230,100);
  // a bit to the left...
  translate(xpos-2, ypos-2);

  rect(0, 0, 40, 80); 
```

}

# python - 如何将列表转换为生成器？

> ID：13464123
> 
> 赞同：1
> 
> 时间：2012-11-19T23:16:42.970
> 
> 标签：python, numpy, generator

我有一个返回元组列表的函数，我想遍历它：

```
def get_parameter_product(num_parameters, lower_range, upper_range):
    param_lists = [ xrange(lower_range, upper_range) for _ in xrange(num_parameters)]   
    return list(itertools.product(*param_lists))

for p in get_parameter_product(3, 0, 5):
    print p,

(0, 0, 0), (0, 0, 1), (0, 0, 2), (0, 0, 3), (0, 0, 4), ... , (4, 4, 2), (4, 4, 3), (4, 4, 4) 
```

但是，对于较大的 num_parameters 值，需要分配大量内存。是否可以将其转换为生成器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:18:57.910

`itertools.product`已经是生成器了。您可以只返回它而不是将其转换为列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:33:33.193

您的方法是添加一个不需要的无关步骤。

```
prod_list = get_parameter_product(3, 0, 5) 
```

可以替换为

```
prod_genr = product(range(0, 5), repeat=3) 
```

任何 in`itertools`返回一个生成器而不是`list`or `tuple`。您可能希望查看[文档](http://docs.python.org/2/library/itertools.html)以检查您真正想要`product`的，而不是`combinations`or `permutations`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:18:16.550

您不需要将列表转换为生成器——只是不要将生成器转换为列表。

首先，要构建`param_lists`，使用生成器表达式而不是列表推导式，您将使用迭代器而不是列表。

其次，不要`list`在`return`声明中调用。

```
>>> def get_parameter_product(num_parameters, lower_range, upper_range):
...     param_lists = (xrange(lower_range, upper_range) for _ in xrange(num_parameters))
...     return itertools.product(*param_lists)
>>> p = get_parameter_product(3, 0, 5)
>>> print(p)
<generator object <genexpr> at 0x101d650f0>
>>> print(list(p))
[(0, 0, 0), (0, 0, 1), (0, 0, 2), (0, 0, 3), (0, 0, 4), ... , (4, 4, 2), (4, 4, 3), (4, 4, 4)] 
```

# windows - 从 Windows 应用程序获取输入

> ID：13464124
> 
> 赞同：0
> 
> 时间：2012-11-19T23:16:44.067
> 
> 标签：windows, opengl, mfc, windows-applications

我正在开发一个 Windows 应用程序来使用 OpenGL 渲染场景。我的申请属于那种类型

```
int WINAPI  WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd) 
```

我在程序的某个地方调用opengl渲染函数。我很难在应用程序的框架内渲染我的 openGL 场景，但我非常痛苦地将我的 WinMain 应用程序更改为类似 GUI 应用程序的形式。我知道人们如何经常这样做，但我的程序有不同的结构，它使用不同的相机类等等，所以你不能简单地使用类似结构的 glut。我什至使用了 QT，但问题是我的库使用 MultiByteCharacterSet 而 Qt 使用默认情况下是 unicode 并且有问题。

最后，我决定不将我的程序更改为具有 GUI 的程序，并继续使用全屏窗口（如游戏）或没有按钮或菜单的窗口（我什至尝试过 MFC）。

但现在我需要从用户那里获取一些文本输入，假设我想为我要保存的“文件”获取名称。我没有用于此的窗口或文本框，也没有控制台窗口。怎么可能做到这一点？可以使用控制台吗？（这是窗口应用程序，但我看到一些应用程序虽然它们正在渲染到一个窗口中，但它们也有控制台窗口）。或者当用户点击键盘上的 R（记录）按钮时，我怎样才能有一个用于输入的文本框。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:39:05.277

您可以使用通用对话框进行输入，例如[`Save As`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646928%28v=vs.85%29.aspx)对话框。

# wordpress - 需要自定义 WP 插件帮助

> ID：13464134
> 
> 赞同：1
> 
> 时间：2012-11-19T23:17:42.433
> 
> 标签：wordpress, plugins

我在创建自定义 wordpress 插件时遇到了一些问题，该插件允许我在侧边栏中显示我是否有空或离开一段时间。

现在我已经在管理面板中显示了菜单，并且日期选择器可以正常工作。现在在这里我可以使用一些帮助。我应该提一下，无论如何我都不是专业的编码员，所以一些更详细的帮助会很友好:)

我有 2 个选项，A 是具有固定值的单选按钮，B 是 2 个用户输入的组合（我在 X 之前不可用），其中 X 和 Y 是在日期字段中选择的日期。我想根据表格显示选项 A 或 B，并且可以在需要时进行更改。

我不确定我是否以正确的方式进行，任何帮助将不胜感激。

问候，

SJ

这是我的文件：

**afwezigplugin.php** [http://pastebin.com/REbkvQzr](http://pastebin.com/REbkvQzr)

**opties.php** [http://pastebin.com/McHkmcsN](http://pastebin.com/McHkmcsN)

**包括（我认为我需要？）

```
$aanwezig = $_POST['groep'];
$van = $_POST['datevan'];
$tot = $_POST['datetot'];

    if ($aanwezig == "geen-afwezigheid") {
        echo 'Geen afwezigheid';
    }

    else {
                echo "Afwezig van ". $van . " tot en met " . $tot . ".";
    }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T08:11:05.300

好的，使用这样的东西：

```
 $("#geenafwezig").click(function() {
    if($('#geenafwezig').is(':checked')) 
    {
            $('#geenafwezig').attr('checked','checked');
            $('#data').show();

    }
    else
    {
            $('#geenafwezig').removeAttr('checked','checked');
            $('#data').hide();

    }   
   });

    $(function () {
            $('#data').hide();
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:23:30.203

您的意思是您需要在可能的值输入之间切换吗？单击“A”单选按钮，在这种情况下，2个“B”字段无关紧要，否则“A”单选按钮未单击，然后应该使用2个“B”字段？如果是这样，请使用 JavaScript 在选中 A 时动态隐藏和重置 B 字段的值，并在未选中 A 时动态显示 B 字段...如果我理解您的要求...我不确定

# java - while 循环中的线程是否会将 CPU 时间分配给另一个相同类型的线程？

> ID：13464135
> 
> 赞同：2
> 
> 时间：2012-11-19T23:17:46.980
> 
> 标签：java, multithreading, while-loop

如果我有以下虚拟代码：

```
public static void main(String[] args) {
  TestRunnable test1 = new TestRunnable();
  TestRunnable test2 = new TestRunnable();
  Thread thread1 = new Thread(test1);
  Thread thread2 = new Thread(test2);
  thread1.start();
  thread2.start();
}

public static class TestRunnable implements Runnable {
  @Override
  public void run() {
    while(true) {
      //bla bla
    }
  }
} 
```

在我当前的程序中，我有一个类似的结构，即两个线程执行相同的 Run() 方法。但是由于某种原因，只有线程 1 获得了 CPU 时间，即线程 2 永远没有机会运行。这是因为线程 1 在其 while 循环中，线程 2 等待吗？

我不太确定，如果一个线程处于一个while循环中，它是否会“阻塞”其他线程？我会这么认为，但不是 100% 肯定，所以很高兴知道是否有人可以告诉我这里实际发生的事情。

**编辑** 好的，只是再次尝试制作一个非常简单的示例，现在两个线程都在获取 CPU 时间。但是，在我的原始程序中并非如此。一定是某个地方的一些错误。现在正在调查。感谢大家清理它，至少我得到了那个知识。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-19T23:21:27.653

JVM 不能保证它会停止一个繁忙的线程来给其他线程一些 CPU。

call 是一个很好的做法`Thread.yield();`，或者如果这不起作用 call `Thread.sleep(100);`，在你的忙循环中让其他线程拥有一些 CPU。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:39:34.480

在某些时候，现代操作系统会[*抢占*](http://en.wikipedia.org/wiki/Preemption_%28computing%29)当前上下文并切换到另一个线程 - 但是，它*也会*（总体上是一个相当愚蠢的事情）将 CPU 变成烤面包机：这个小的“繁忙循环”可能正在计算校验和，让它运行缓慢将是一种耻辱！

出于这个原因，通常建议`sleep/yield`手动 - 甚至是`sleep(0)`¹ - 这将在操作系统决定控制之前产生线程*的**执行*。在实践中，对于给定的空循环代码，这将导致手动让步时 CPU 使用率从 99% 变为 0%。（实际数字将根据每个循环完成的“工作”等而有所不同。）

 ** * *

¹产生线程/上下文的最短时间因操作系统和配置而异，这就是为什么并不总是希望产生 - 但是 Java 和“实时”通常不会出现在同一个句子中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:22:46.777

实际的线程调度应该由操作系统而不是 Java 处理。这意味着每个线程应该被赋予相同的运行时间（尽管不是按可预测的顺序）。在您的示例中，每个线程将在其处于活动状态时旋转并且不执行任何操作。如果您在 while 循环中执行此操作，您实际上可以看到这种情况发生`System.out.println(this.toString())`。您应该看到每个线程都可以打印出来。

为什么你认为一个线程占主导地位？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T23:27:08.153

操作系统负责调度线程。这在几年前发生了变化。它在不同的操作系统（Windows/Linux 等）之间有所不同，并且很大程度上取决于 CPU 的数量和运行的代码。如果代码不包含一些等待功能，如 Thread.yield() 或监视器上带有 wait() 方法的同步块，CPU 很可能会让线程长时间运行。
拥有具有多个 CPU 的机器将提高应用程序的并行性，但是在不允许其他线程在多线程环境中运行的线程的 run() 方法中编写代码是一种糟糕的编程。*

# kml - 让线路在 Google 地球上工作

> ID：13464137
> 
> 赞同：0
> 
> 时间：2012-11-19T23:18:07.453
> 
> 标签：kml, google-earth

因此，我一直在筛选 GE 的文档，并找到了如何使用 LineStyle 和 LineString 来设置和显示线条的样式，但实际上我无法让它发挥作用。这是我的 KML：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2"><Document><Style id="thisStyle">
<LineStyle>
<color>500078F0</color>
<colorMode>Normal</colorMode>
<width>5</width>
</LineStyle>
</Style>
<Placemark>
<name>502-2012-11-19 05:27:03</name>
<description>Speed:0</description>
<Point>
<coordinates>-76.0513,42.0894,247</coordinates>
</Point>
</Placemark>
<Placemark>
<name>502-2012-11-19 05:26:46</name>
<description>Speed:0</description>
<Point>
<coordinates>-76.0517,42.0886,287</coordinates>
</Point>
</Placemark>
....
<Placemark>
<name>525-2012-11-19 04:38:25</name>
<description>Speed:0</description>
<Point>
<coordinates>-76.0512,42.0894,178</coordinates>
</Point>
</Placemark>
<styleUrl>#thisStyle</styleUrl>
<LineString>
<tessellate>1</tessellate>
<altitudeMode>clampToGround</altitudeMode>
<coordinates>
-76.0513,42.0894,247 
-76.0517,42.0886,287 
....
-76.0512,42.0894,178 
</coordinates></LineString></Document></kml> 
```

注意：上面出现“...”的地方还有大约 50 个坐标集，为了简洁起见，我删除了它们，但由于所有坐标都是由脚本生成的，如果一个作品我知道它们都会生成。任何人都可以将我推向正确的方向，为什么我的地标都出现了，但没有线条？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:53:30.180

您必须在地标中内联样式或使用*styleUrl*元素引用地标中的样式。

您的示例中的最后一个 Placemark 需要像这样重写：

```
<Placemark>
    <name>525-2012-11-19 04:38:25</name>
    <description>Speed:0</description>
    <styleUrl>#thisStyle</styleUrl>
    <LineString>
        <tessellate>1</tessellate>
        <altitudeMode>clampToGround</altitudeMode>
        <coordinates>
            -76.0513,42.0894,247 
            -76.0517,42.0886,287
             ...
            -76.0512,42.0894,178 
        </coordinates>
    </LineString>
</Placemark> 
```

如果您的 KML 无法正确查看，那么验证 KML 通常会有所帮助。您可以使用[KML 验证器](http://kmlvalidator.com/home.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T01:50:23.423

[LineString](https://developers.google.com/kml/documentation/kmlreference#linestring)元素仅在 Placemark（或 Placemark 内的 MultiGeometry）内有效：

```
<Placemark>
  <LineString>
    <tessellate>1</tessellate>
    <altitudeMode>clampToGround</altitudeMode>
    <coordinates>
      -76.0513,42.0894,247 
      -76.0517,42.0886,287 
      -76.0512,42.0894,178 
    </coordinates>
  </LineString>
</Placemark> 
```

*   [使用您的 KML 在 Google 地图上的示例](https://maps.google.com/maps?q=http%3a%2F%2Fwww.geocodezip.com%2Fgeoxml3_test%2FSO_noLines_kml.xml&hl=en&sll=40.07304,-74.724323&sspn=4.287493,10.821533&t=h&z=19)
*   [谷歌地图上的示例，带有包含线串的地标](https://maps.google.com/maps?q=http%3a%2F%2Fwww.geocodezip.com%2Fgeoxml3_test%2FSO_noLinesA_kml.xml&hl=en&ll=42.088999,-76.051451&spn=0.001027,0.002642&sll=42.088993,-76.051451&sspn=0.001027,0.002642&t=h&z=19)

# c - 在像 array[i] 这样的数组中，如何创建条件来查看 [i] 的值并在其高于某个值时退出循环？

> ID：13464139
> 
> 赞同：-1
> 
> 时间：2012-11-19T23:18:16.647
> 
> 标签：c

如果我的帐户 [MAX] 的 MAX 为 10，并且循环提示用户在帐户 [MAX] 中输入帐户#s，我该如何编写代码以查看帐户数量是否超过 10，并告诉用户已输入最大帐户数且不再接受输入？

这是我的 do while 循环

```
do
{
printf ("Options Available: \n");
printf ("\n 1 - Enter a transaction");
printf ("\n 2 - View the general journal");
printf ("\n 3 - View the balance sheet");
printf ("\n q - Quit the program\n");

printf ("\nPlease enter 1, 2, 3 or q: ");

    option = validateoption();

    if (option == '1')
    {
        printf ("\nEnter an account number (between 1000 and 3999): ");
        accounts[i] = validateaccount();
        printf ("\n");

        printf ("Enter d (debit) or c (credit): ");
        debcred[i] = validatedebcred();
        printf ("\n");

        printf ("Enter transaction amount: ");
        amount[i] = validateamount();
        printf ("\n");

        printf ("\n");

        i++;
        totalinput++;
    }

    if (option == '2')
        journal(accounts, debcred, amount, &totalinput);

    if (option == '3')
        balancesheet(accounts, debcred, amount, &totalinput);

} while (option != 'q'); 
```

如果您输入 1、2、3 或 q，就可以说它有效。现在在帐户[i] 中，如果帐户数超过 10，我可以写什么来告诉用户已输入最大帐户数并且不接受更多输入？

我的验证帐户功能：

```
long validateaccount() {  // VALIDATE INPUT FOR ACCOUNT # IN TRANSACTION FUNCTION

int keeptrying = 1, rc;
 long i;
char after;

do
{
    rc = scanf ("%ld%c", &i, &after);

    if (rc == 0)
    {
        printf (" **Invalid input try again: ");
        clear();
    }
        else if (after != '\n')
        {
            printf (" **Trailing characters try again: ");
            clear();
        }
            else if (i < 1000 || i > 3999)
            {
                printf (" **Invalid input try again: ");
            }
                else
                {
                    keeptrying = 0;
                }

} while (keeptrying == 1);

return i;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:22:36.867

代替

```
if (option == '1') 
```

和

```
if (option == '1' && totalinput < MAX) 
```

当达到最大数量时，选项 1 将被禁用。

`printf()`您可能还想更早地添加检查，因此如果选项 1 已被禁用，则不要选择它。

**注意**：您同时拥有`i`和`totalinput`。我认为如果您删除`i`并仅使用`totalinput`. （因为`totalinputs`比 更具描述性`i`）

# excel - 锁定某些单元格中的编辑，但没有进一步的保护

> ID：13464141
> 
> 赞同：2
> 
> 时间：2012-11-19T23:18:32.820
> 
> 标签：excel, vba

我正在尝试以一种防止在某些单元格中进行编辑但禁用所有其他保护选项的方式来保护我的 Excel 工作表。换句话说，工作表应该只有在某些单元格中禁用单元格编辑的情况下才具有不受保护的工作表的行为。

```
ActiveSheet.Range(Cells(4, 3), Cells(OldRowCount, 7)).Locked = False
ActiveSheet.Protect Contents:=True 
```

我可能需要为 设置几个其他属性`.Protect`，或者我应该完全选择不同的方法......

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T09:57:54.743

我认为问题只是，如何在 VBA 中正确设置此行为。

快速使用`F1`提供了几乎所有必要的东西。错误在于使用`Locked`，因为它必须`true`适用于某些单元格，而对于所有其他单元格必须为 false 才能表现得像意图。

这是我的解决方案：

```
Public Sub Demo()
  With ActiveSheet
    'Deactivate lock for all cells, so they don't be blocked by protection
    .Cells.Locked = False
    'Activate lock for some cells
    'Range(Cells(4, 3), Cells(OldRowCount, 7)).Locked = True
    .Cells(6, 4).Locked = True
    If .ProtectContents Then
      .Unprotect
    Else
      'only contents:=true is really important
      .Protect _
        Password:="", _
        Contents:=True, _
        DrawingObjects:=False, _
        Scenarios:=False, _
        UserInterfaceOnly:=True, _
        AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, _
        AllowFiltering:=True, _
        AllowFormattingCells:=True, _
        AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, _
        AllowInsertingColumns:=True, _
        AllowInsertingHyperlinks:=True, _
        AllowInsertingRows:=True, _
        AllowSorting:=True, _
        AllowUsingPivotTables:=True
    End If
  End With
End Sub 
```

# twitter-bootstrap - 玩！框架和 Twitter Bootstrap 下拉菜单处于活动状态

> ID：13464142
> 
> 赞同：2
> 
> 时间：2012-11-19T23:18:36.617
> 
> 标签：twitter-bootstrap, playframework, playframework-2.0

我有一个播放框架应用程序，我正在使用 twitter bootstrap 作为前端。

在我的导航栏中，我有四个选项，如下所示。

```
 <div class="nav-collapse">
        <ul class="nav">
          <li class="@("active".when(nav == ""))"><a href="@routes.Application.index()">@Messages("playauthenticate.navigation.home")</a></li>
          <li class="@("active".when(nav == "restricted"))"><a href="@routes.Application.restricted()">@Messages("playauthenticate.navigation.restricted")</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Journey Management<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="@routes.Application.createJourney()"><i class="icon-plus-sign"></i>@Messages("journeys.dropdown.option1")</a></li>
              <li><a href="@routes.Application.Todo()"><i class="icon-calendar"></i>@Messages("journeys.dropdown.option2")</a></li>
              <li><a href="@routes.Application.Todo()"><i class="icon-star"></i>@Messages("journeys.dropdown.option3")</a></li>
            </ul>
          </li>

            @if(!Deadbolt.viewRoleHolderPresent()) {
                <li class="@("active".when(nav == "signup"))"><a href="@routes.Application.signup()">@Messages("playauthenticate.navigation.signup")</a></li>
            }
        </ul>
      </div> 
```

当我导航到“主页”或“注册”页面时，这些选项在导航栏上变为**活动状态。**我的问题是，每当我从下拉栏中选择一个选项时，“主页”按钮都会保持活动状态。我希望“旅程管理”选项**处于活动状态**，但我不确定如何使用下拉菜单执行此操作。

所以我对HTML做了以下修改。

```
 <li class="@("active".when(nav == "journeys")) dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Journey Management<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="@routes.Application.createJourney()"><i class="icon-plus-sign"></i>@Messages("journeys.dropdown.option1")</a></li>
              <li><a href="@routes.Application.Todo()"><i class="icon-calendar"></i>@Messages("journeys.dropdown.option2")</a></li>
              <li><a href="@routes.Application.Todo()"><i class="icon-star"></i>@Messages("journeys.dropdown.option3")</a></li>
            </ul>
          </li> 
```

当我从“旅程管理”下拉列表中选择一个选项时，在本例中，**“创建旅程”**页面（它是唯一具有操作的页面）本地地址是`http://localhost:9000/journeys`所以我在旅程应用程序路由中调用一个方法。但是导航栏上的主页链接保持活动状态，而导航栏上的旅程管理下拉菜单保持非活动状态。

![描述问题的屏幕截图](../Images/3ef0c735bc233d5b749221c2d917d75a.png)

这是加载页面的来源：

这是来自实际页面的 HTML

```
<div class="nav-collapse">
    <ul class="nav">
      <li class="active"><a href="/">Home</a></li>
      <li class=""><a href="/restricted">Restricted page</a></li>
      <li class=" dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Journey Management<b class="caret"></b></a>
        <ul class="dropdown-menu">
          <li><a href="/journeys"><i class="icon-plus-sign"></i>Create a Journey</a>       </li>
          <li><a href="/TODO"><i class="icon-calendar"></i>View all Journeys</a></li>
          <li><a href="/TODO"><i class="icon-star"></i>View saved Journeys</a></li>
        </ul>` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T13:38:35.727

所以我愚蠢地忽略了`@main("Journey Creator", "journeys") {`在这个问题涉及的 .scala.html 文件中包含“journeys”参数。添加此解决导航问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T11:27:51.690

标签中只能有一个`class`属性，因此必须使用：

```
<li class="@("active".when(nav == "journeys")) dropdown"> 
```

这会给你想要的结果。

# python - 在 Python 中使用范围作为字典键，我有什么选择？

> ID：13464143
> 
> 赞同：1
> 
> 时间：2012-11-19T23:18:37.833
> 
> 标签：python, loops, key, range, dictionary

这是我的第一篇文章，我对编程很陌生，所以我可能无法恰当地传达我的问题，但我会尽力而为！

```
tries_dict = {1:'first', 2:'second', 3:'third', 4:'fourth', ub_tries:'last'}

ub_tries = user input

tries = 1

input ('\nCome on make your ' + tries_dict.get(tries) + guess: ') 
```

这 3 个元素是我创建的数字猜谜游戏的一部分，我将它们包含在一个`while`循环中，`tries += 1`在每个错误答案之后。

如您所见，在我的字典中，前 4 个答案和游戏结束前的最后可能机会都有自定义值，所以这是我尝试做的：

我想找到一种方法来为“第四”和“最后”之间的每个答案/键设置“NEXT”值。

如：

```
tries = 5

Come on make your next guess

tries = 6

Come on make your next guess 
```

等等

我确实找到了一种复杂循环的方法，但作为一种好奇的类型，我想知道更有效/更实用的方法来实现这一点。

以下是我考虑过但无法开始工作的一些选项：

1.  使用范围作为键
2.  找到一种方法来生成一个值在 4 和之间的列表`ub_tries`并将该列表用作键

所以一般来说：如何创建一种方法来为字典中未指定的键提供这个一般答案（下一个或其他）？

任何反馈将不胜感激，请随时要求澄清，因为我可以告诉自己我的问题有点混乱。

我希望我在编程和提出相关问题方面都变得更加狡猾，到目前为止，我的编程几乎和我的总结技能一样混乱，叹息！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T23:27:23.983

我不确定这是否是您想要的，但[`dict.get`](http://docs.python.org/2/library/stdtypes.html#dict.get)可能是答案：

```
>>> ub_tries = 20
>>> tries_dict = {1:'first', 2:'second', 3:'third', 4:'fourth', ub_tries:'last'}
>>> tries_dict.get(1, 'next')
'first'
>>> tries_dict.get(4, 'next')
'fourth'
>>> tries_dict.get(5, 'next')
'next'
>>> tries_dict.get(20, 'next')
'last'
>>> tries_dict.get(21, 'next')
'next' 
```

当然，您可以以各种不同的方式将其包装在一个函数中。例如：

```
def name_try(try_number, ub_tries):
    tries_dict = {1:'first', 2:'second', 3:'third', 4:'fourth', ub_tries:'last'}
    return tries_dict.get(try_number, 'next') 
```

无论如何，`dict.get(key, default=None)`就像`dict[key]`，除了 if`key`不是成员，而不是提高 a `KeyError`，它返回`default`。

至于你的建议：

> 使用范围作为键？？

当然，您可以这样做（如果您使用的是 Python 2 而不是 3，请使用`xrange`for `range`），但这有什么帮助呢？

```
d = { range(1, 5): '???', 
      range(5, ub_tries): 'next', 
      range(ub_tries, ub_tries + 1): 'last' } 
```

这是完全合法的——但`d[6]`会引发 a `KeyError`，因为`6`与. 不同`range(5, ub_tries)`。

如果你想让它工作，你可以构建一个`RangeDictionary`这样的：

```
class RangeDictionary(dict):
    def __getitem__(self, key):
        for r in self.keys():
            if key in r:
                return super().__getitem__(r)
        return super().__getitem__(key) 
```

但这远远超出了“初学者的 Python”，即使对于这种低效、不完整和不健壮的实现也是如此，所以我不建议这样做。

> 找到一种方法来生成一个值在 4 和 ub_tries 之间的列表，并使用这样的列表作为键

你的意思是这样吗？

```
>>> ub_tries = 8
>>> tries_dict = {1:'first', 2:'second', 3:'third', 4:'fourth', ub_tries:'last'}
>>> tries_dict.update({i: 'next' for i in range(5, ub_tries)})
>>> tries_dict
{1: 'first', 2: 'second', 3: 'third', 4: 'fourth', 5: 'next', 6: 'next', 7: 'next', 8: 'last'}
>>> tries_dict[6]
'next' 
```

这行得通，但它可能不是一个好的解决方案。

最后，您可以使用`defaultdict`，它可以让您将默认值烘焙到字典中，而不是将其作为每次调用的一部分传递：

```
>>> from collections import defaultdict
>>> tries_dict = defaultdict(lambda: 'next', 
...                          {1:'first', 2:'second', 3:'third', 4:'fourth', ub_tries:'last'})
>>> tries_dict
defaultdict(<function <lambda> at 0x10272fef0>, {8: 'last', 1: 'first', 2: 'second', 3: 'third', 4: 'fourth'})
>>> tries_dict[5]
'next'
>>> tries_dict
defaultdict(<function <lambda> at 0x10272fef0>, {1: 'first', 2: 'second', 3: 'third', 4: 'fourth', 5: 'next', 8: 'last'}) 
```

但是，请注意，这会在您第一次请求时永久创建每个元素，并且您必须创建一个返回默认值的函数。这对于您将要更新值并且只希望以默认值作为起点的情况更有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-20T07:10:46.717

您可以使用以范围为键的字典：

```
def switch(x):
    return { 1<x<4: 'several', 5<x<40: 'lots'}[1]

x = input("enter no. of monsters ")
print switch(x) 
```

希望这可以帮助。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:47:28.233

为什么不直接使用列表？

```
MAX_TRIES = 10
tries_list = ["first", "second", "third", "fourth"]

for word in (tries_list[:MAX_TRIES-1] + 
             (["next"] * (MAX_TRIES - len(tries_list) - 1)) + ["last"]):
    result = raw_input("Come on, make your {} guess:".format(word)) 
```

请注意，此代码不会按计划工作`MAX_TRIES = 0`，但我认为这不会成为问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T23:27:38.963

我在这里捕捉到你对游戏的意图了吗？

```
max_tries = 8

tries_verbage = {
    1: 'first',
    2: 'second',
    3: 'third',
    4: 'fourth',
    max_tries: 'last'
    }

for i in xrange(1, max_tries + 1):
    raw_input('Make your %s guess:' % tries_verbage.get(i, 'next')) 
```

返回

```
Make your first guess:1
Make your second guess:2
Make your third guess:3
Make your fourth guess:4
Make your next guess:5
Make your next guess:6
Make your next guess:7
Make your last guess:8 
```

# c# - 在 MVC 3 上使用嵌套模型：如何更新表中的表？（外键）

> ID：13464149
> 
> 赞同：4
> 
> 时间：2012-11-19T23:18:56.530
> 
> 标签：c#, asp.net, asp.net-mvc-3, entity-framework, razor

所以我对 ASP.NET MVC3 编程比较陌生，特别是因为实体框架代码首先创建和管理数据库的方式。

所以，我正在研究一个完整的营养系统，它必须允许营养师评估病人。因此，首先，系统允许设置一个预约，获取营养师的 ID、患者的 ID 和日期时间。一旦预约结束，营养师必须能够更新预约网，并包括营养师评估表，其中包括允许某些患者吃多少。

所以，我的课程如下

模型： NutritionalEvaluation.cs

```
 public class NutritionalEvaluation
{
    [ScaffoldColumn (false)]
    public virtual int ID { get; set; }
    public virtual int KiloCal { get; set; }
    public virtual int Proteines { get; set; }
    public virtual int Carbs { get; set; }
    public virtual int Fiber { get; set; }
    public virtual int Fats { get; set; }
    public virtual int Cholesterol { get; set; }
    public virtual int Water { get; set; }
    public virtual int Alcohol { get; set; } 
} 
```

模型：PatientAppointment.cs

```
 public class PatientAppointment
{
    public virtual int ID { get; set; }
    public virtual int IDClient { get; set; }
    public virtual int IDNutritionist { get; set; }
    public virtual DateTime Date { get; set; }
    public virtual String Comments { get; set; }
    public virtual NutritionalEvaluation Valuation { get; set; }
} 
```

如您所见，NutritionalValuation 是 PatientAppointment 的一个字段。

查看：EvaluateAppointment.cshtml @model NutricionApp.Models.PatientAppointment

```
 @{
        ViewBag.Title = "Valuation";
    }

    <h2>Valuation</h2>

    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")"         type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

    @using (Html.BeginForm()) {
        @Html.ValidationSummary(true)
        <fieldset>
            <legend>PatientAppointment</legend>

    @Html.HiddenFor(model => model.ID)
    @Html.HiddenFor(model => model.IDClient)
    @Html.HiddenFor(model => model.IDNutritionist) 
```

（在此之前，已创建 PatientAppointment，并且 IDClient 和 IDNutritionist 字段均已填写。）

```
 <div class="editor-label">
        @Html.LabelFor(model => model.Date)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Date)
        @Html.ValidationMessageFor(model => model.Date)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Comments)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Comments)
        @Html.ValidationMessageFor(model => model.Comments)
    </div>
    <!--
    <div class="editor-label">
        @Html.LabelFor(model => model.Valuation)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Valuation)
        @Html.ValidationMessageFor(model => model.Valuation)
    </div>

    <p>
        <input type="submit" value="Save" />
    </p>
</fieldset> 
```

MVC 足够聪明，可以将 NutritionalEvaluation 呈现为另一组字段，并将该类的所有字段包含在视图中。我的问题是，当我尝试提交表单时（从技术上讲，它应该允许更改日期、添加评论，然后添加 NutritionalEvaluation 字段），但 NutritionalEvaluation 将保存到表格中。它保持为空，并且 NutritionalValue 表保持为空。我能做些什么？

编辑1：

控制器：PatientAppointmentController.cs

```
 namespace NutritionApp.Controllers
    {
        [Authorize]
        public class PatientAppointmentController : Controller
        {
            private NutritionDB db = new NutritionDB(); 
```

...

```
 public ActionResult EvaluateAppointment(int ID)
    {
        PatientAppointment appoint = db.PatientAppointment.Find(ID);
        return View(appoint);
    }

    [HttpPost]
    public ActionResult EvaluateAppointment(PatientAppointment appoint)
    {
        if (ModelState.IsValid)
        {
            db.Entry(appoint).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(appoint);
    }

    public ActionResult ViewAppointments()
    {
        return View();
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T02:12:39.357

我没有在这台电脑上安装 Visual Studio，所以我无法测试这个......

假设您使用的是实体框架代码优先方法，您的类与您的`NutritionalEvaluation`类没有外键关系`PatientAppointment`。假设存在 1-1 关系，则更`NutritionalEvaluation`改为：

```
public class NutritionalEvaluation
{
    [ScaffoldColumn (false)]
    public virtual int ID { get; set; }

    // This is the name of the navigation property defined below
    [ForeignKey("PatientAppointment")]
    public virtual int AppointmentID { get; set; }

    public virtual int KiloCal { get; set; }
    public virtual int Proteines { get; set; }
    public virtual int Carbs { get; set; }
    public virtual int Fiber { get; set; }
    public virtual int Fats { get; set; }
    public virtual int Cholesterol { get; set; }
    public virtual int Water { get; set; }
    public virtual int Alcohol { get; set; }

    // Add navigation property to PatientAppointment
    public virtual PatientAppointment PatientAppointment { get; set; }
} 
```

# c++ - 可以将 UTF-8/UTF-16 选项传递给从 C++ 调用的 JVM？

> ID：13464151
> 
> 赞同：1
> 
> 时间：2012-11-19T23:18:58.043
> 
> 标签：c++, utf-8, jvm

我有一个 Windows C++ 程序，我想在其中调用 JVM 并能够向它传递一个选项，该选项可能从 C++ 程序的命令行调用中给出（命令行选项可能不是纯文本，例如“ -Dblah=日本日本")。jni.h 中的 JavaVMOption 结构似乎只将选项字符串定义为字符，所以看起来我不能只传递一个宽字符串。

我尝试将其转换为 UTF-8 并将其存储为 C++ 端的窄字符串，然后在 Java 端将其转换回来，但似乎“日本”被实际替换为“？？” 字符，因此在转换-取消转换过程中丢失。

我想错了吗？这不会起作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:17:15.247

调用[api 文档](http://docs.oracle.com/javase/1.5.0/docs/guide/jni/spec/invocation.html)说得很清楚：

```
typedef struct JavaVMOption {
    char *optionString;  /* the option as a string in the default platform encoding */
    void *extraInfo;
} JavaVMOption; 
```

术语“默认平台编码”是明确的，这并不*意味着*Windows 上的 utf-8。它表示默认系统代码页使用的编码。如果您的机器未配置为使用日文代码页（如 932），则从 utf-16 字符串进行的转换将为无法转换的日文字符生成问号。这通常不是问题，因为日本用户会选择正确的代码页。没有解决方法有错误的。

确保您选择了正确的系统代码页、控制面板 + 区域和要更改的语言。并使用 WideCharToMultiByte() 和 CP_ACP 进行转换。

# python - TypeError: unhashable type: 'list' when using built-in set function

> ID：13464152
> 
> 赞同：62
> 
> 时间：2012-11-19T23:19:01.110
> 
> 标签：python, list, duplicates

我有一个包含多个列表作为其元素的列表

```
eg: [[1,2,3,4],[4,5,6,7]] 
```

如果我使用内置的 set 函数从此列表中删除重复项，则会收到错误消息

```
TypeError: unhashable type: 'list' 
```

我正在使用的代码是

```
TopP = sorted(set(TopP),reverse=True) 
```

其中 TopP 是一个列表，就像上面的例子一样

set() 的这种用法是错误的吗？还有其他方法可以对上述列表进行排序吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-11-19T23:21:56.497

集合要求它们的项目是可*散列*的。在 Python 预定义的类型中，只有不可变的类型（例如字符串、数字和元组）是可散列的。可变类型（例如列表和字典）不可散列，因为更改其内容会更改散列并破坏查找代码。

由于您无论如何都要对列表进行排序，因此只需在列表已排序*后放置重复删除。*这很容易实现，不会增加操作的算法复杂度，并且不需要将子列表更改为元组：

```
def uniq(lst):
    last = object()
    for item in lst:
        if item == last:
            continue
        yield item
        last = item

def sort_and_deduplicate(l):
    return list(uniq(sorted(l, reverse=True))) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-11-19T23:20:41.330

集删除重复项。为了做到这一点，该项目在集合中时不能更改。列表在创建后可以更改，并且被称为“可变”。你不能把可变的东西放在一个集合中。

列表有一个不可变的等价物，称为“元组”。这就是您编写一段代码的方式，该代码获取列表列表，删除重复列表，然后将其反向排序。

`result = sorted(set(map(tuple, my_list)), reverse=True)`

附加说明：如果一个元组包含一个列表，该元组仍然被认为是可变的。

一些例子：

```
>>> hash( tuple() )
3527539
>>> hash( dict() )

Traceback (most recent call last):
  File "<pyshell#5>", line 1, in <module>
    hash( dict() )
TypeError: unhashable type: 'dict'
>>> hash( list() )

Traceback (most recent call last):
  File "<pyshell#6>", line 1, in <module>
    hash( list() )
TypeError: unhashable type: 'list' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T14:04:51.743

```
 python 3.2

    >>>> from itertools import chain
    >>>> eg=sorted(list(set(list(chain(*eg)))), reverse=True)
        [7, 6, 5, 4, 3, 2, 1]

   ##### eg contain 2 list within a list. so if you want to use set() function
   you should flatten the list like [1, 2, 3, 4, 4, 5, 6, 7]

   >>> res= list(chain(*eg))       # [1, 2, 3, 4, 4, 5, 6, 7]                   
   >>> res1= set(res)                    #   [1, 2, 3, 4, 5, 6, 7]
   >>> res1= sorted(res1,reverse=True) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-15T03:30:38.613

绝对不是理想的解决方案，但是如果我将列表转换为元组然后对其进行排序，我会更容易理解。

```
mylist = [[1,2,3,4],[4,5,6,7]]
mylist2 = []
for thing in mylist:
    thing = tuple(thing)
    mylist2.append(thing)
set(mylist2) 
```

# python - 机械化（点击下载到自定义目录）

> ID：13464153
> 
> 赞同：1
> 
> 时间：2012-11-19T23:19:08.120
> 
> 标签：python, python-2.7

我希望能够让python中的机械化模块在页面上找到下载按钮并单击该按钮，然后将文件保存到自定义目录。这个模块甚至可以吗？如果可以，有人可以指出我正确的方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T03:01:50.347

如果您要处理 javascript，我建议您使用[PyQt4](http://zetcode.com/tutorials/pyqt4/)

# vb.net - 按钮 1 有效，按钮 2 为时过早

> ID：13464159
> 
> 赞同：0
> 
> 时间：2012-11-19T23:19:34.377
> 
> 标签：vb.net, visual-studio-2010

我有以下代码。按钮 1 工作正常并在下载完全完成后启动。然而，按钮 2 正试图在完成 50% 左右时启动。有人知道为什么吗？

```
Imports System.Net
Imports System.Threading
Imports System.ComponentModel

Public Class Form1

' Occurs when an asynchronous file download operation completes.
Private Sub _DownloadFileCompleted(ByVal sender As Object, ByVal e As AsyncCompletedEventArgs)
    ' File download completed
    Button1.Text = "Launching..."
    Shell("C:\war.exe")
End Sub

Private Sub _DownloadFileCompleted2(ByVal sender As Object, ByVal e As AsyncCompletedEventArgs)
    ' File download completed
    Button2.Text = "Launching..."
    Shell("C:\war.exe")
End Sub

' Occurs when an asynchronous download operation successfully transfers some or all of the data.
Private Sub _DownloadProgressChanged(ByVal sender As Object, ByVal e As DownloadProgressChangedEventArgs)
    ' Update progress bar
    ProgressBar1.Value = e.ProgressPercentage
End Sub

' download button click event
Private Sub download_button_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
    ' Disable download button to avoid clicking again while downloading the file
    Button1.Text = "Downloading Updates"
    Button2.Visible = False
    ' Downloads, to a local file, the resource with the specified URI. 
    ' This method does not block the calling thread.
    Dim _WebClient As New WebClient()
    AddHandler _WebClient.DownloadFileCompleted, AddressOf _DownloadFileCompleted
    AddHandler _WebClient.DownloadProgressChanged, AddressOf _DownloadProgressChanged
    _WebClient.DownloadFileAsync(New Uri("http://www.url.com"), "C:\prog.exe")
End Sub

Private Sub download_button_Click2(ByVal sender As Object, ByVal e As EventArgs) Handles Button2.Click
    ' Disable download button to avoid clicking again while downloading the file
    Button2.Text = "Downloading Updates"
    Button1.Visible = False
    ' Downloads, to a local file, the resource with the specified URI. 
    ' This method does not block the calling thread.
    Dim _WebClient2 As New WebClient()
    AddHandler _WebClient2.DownloadFileCompleted, AddressOf _DownloadFileCompleted2
    AddHandler _WebClient2.DownloadProgressChanged, AddressOf _DownloadProgressChanged
    _WebClient2.DownloadFileAsync(New Uri("http://www.url.com"), "C:\prog.exe")
End Sub

End Class 
```

提前致谢

# tsql - SQL Server 2005 查询 - 总和计数

> ID：13464160
> 
> 赞同：1
> 
> 时间：2012-11-19T23:20:01.583
> 
> 标签：tsql, sql-server-2005

我正在尝试进行计数。我正在运行以下查询。我想要 BrowserCount 的总和，但是我想返回此查询返回的数据表。我应该使用返回值吗？还是有其他方法？我意识到有很多关于此的帖子，但我无法使用它们来运行它。

```
SELECT  UA.Browser_ID
      , B.Browser_Name_NM
      , COUNT(B.Browser_Name_NM) AS BrowserCount
FROM    llc.User_Agent_TB AS UA
        LEFT JOIN llc.Browser_TB AS B ON UA.Browser_ID = B.Browser_ID
GROUP BY B.Browser_Name_NM
      , UA.Browser_ID
ORDER BY BrowserCount DESC 
```

这是sql server 2005所以我不能做一组一组。我也试图让两个查询联合起来工作，但它一直给我一个语法错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:49:49.750

这可能是你所追求的：

```
SELECT  UA.Browser_ID
  , B.Browser_Name_NM
  , COUNT(B.Browser_Name_NM) AS BrowserCount
FROM    llc.User_Agent_TB AS UA
    LEFT JOIN llc.Browser_TB AS B ON UA.Browser_ID = B.Browser_ID
GROUP BY B.Browser_Name_NM
  , UA.Browser_ID
WITH ROLLUP
ORDER BY BrowserCount DESC 
```

有关更详细的示例，请参见此处，包括如何显示更有意义的摘要行

[http://www.4guysfromrolla.com/articles/073003-1.aspx](http://www.4guysfromrolla.com/articles/073003-1.aspx)

# wordpress - 将 Wordpress 导入 Concrete5：建立数据库连接时出错

> ID：13464162
> 
> 赞同：0
> 
> 时间：2012-11-19T23:20:07.180
> 
> 标签：wordpress, database-connection, concrete5

首先，对不起，如果之前已经处理过，我花了很长时间搜索帖子无济于事。

我有一个 Wordpress 博客和一个 Concrete5 网站。我正在尝试在 Concrete5 网站上写出三个最新的 Wordpress 博客文章。我不能使用 RSS，因为两个站点都在同一个服务器上，并且内部 RSS 被禁用（有没有办法解决这个问题？）。

我已经为具体编写了一个块并将此代码放入 view.php ...

```
<?php 
   define('WP_USE_THEMES', false);
   require('path-to-wordpress/wp-blog-header.php');
?> 
```

...这会导致**“建立数据库连接时出错”**。
如果我在 Concrete 之外运行它，它工作正常*（我目前在服务器上的其他地方使用此代码，没有探测）*。
我也尝试过 wp_load.php，结果相同。

抱歉，如果这真的很明显，我已经研究了一段时间了 :(
在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T14:24:17.257

遗憾的是，这种加载 Wordpress 的简单方法无论出于何种原因、某种相互冲突的定义或其他原因，都无法具体发挥作用。如果您尝试在同一服务器上的 Concrete5 站点上加载 Wordpress 帖子，您可能会发现使用 RSS 对您不起作用，因为有时服务器会阻止内部请求以防止循环。

[这是我发现自己所处的位置，所以我决定自己访问 Wordpress 表，该表基于Concrete5 论坛](http://www.concrete5.org/community/forums/chat/using-wordpress-code-on-home-page/#71809)上的“jcrens8392”发布的代码，所以这里适用于任何发现自己处于相同位置的人。

```
// posts and stuff
$category = 3
$items = 4

// wordpress db stuff
$dbUser = 'user';
$dbPass = 'password';
$dbHost = 'localhost';
$dbName = 'name';

// connect to wordpress database
$conn = mysql_connect($dbHost, $dbUser, $dbPass);

// handle connection errors
if(!$conn) {
    $aDebug['Unable to connect to DB'] = mysql_error();
} elseif(!mysql_select_db($dbName, $conn)) {
    $aDebug['Unable to select database'] = mysql_error();
}

// make SQL query
else {
    $sQuery = "SELECT wp_posts.post_date, wp_posts.post_content , wp_posts.guid , wp_posts.post_title, wp_posts.post_excerpt, wp_posts.post_name FROM wp_posts , wp_term_relationships WHERE post_type = 'post' AND post_status = 'publish' AND wp_posts.ID = wp_term_relationships.object_id AND wp_term_relationships.term_taxonomy_id = ".$category." ORDER BY post_date DESC LIMIT ".$items;
    $rPosts = mysql_query($sQuery, $conn);
}

// plonk posts into a convinient array
$posts = array();
while($row = mysql_fetch_array($rPosts)){
        $excerpt = $controller->getExcerpt( utf8_encode( strip_tags( $row['post_content'] ) ) , 0 , 200 ) .' <a href="'.$row['guid'].'">Read More &#8594;</a>';
        $date = $controller->simplifyDate( $row['post_date'] );
        $temp = array ( 'post_title' => $row['post_title'] , 'post_excerpt' =>  $excerpt , 'post_date' => $date , 'post_link' => $row['guid'] );
        array_push( $posts , $temp );
    } 
```

我将这些函数放在 controller.php 中（摘自[phpsnaps](http://www.phpsnaps.com/snaps/view/get-excerpt-from-string/)函数）...

```
function getExcerpt($str, $startPos=0, $maxLength=100) {
    if(strlen($str) > $maxLength) {
        $excerpt   = substr($str, $startPos, $maxLength-3);
        $lastSpace = strrpos($excerpt, ' ');
        $excerpt   = substr($excerpt, 0, $lastSpace);
        $excerpt  .= '...';
    } else {
        $excerpt = $str;
    }

    return $excerpt;
}

function simplifyDate($str) {
    $months = array("January","February","March","April","May","June","July","August","September","October","November","December");
    $strs = split ( ' ' , $str );
    $date = split ( '-' , $strs[0] );
    $month = $months[ $date[1] - 1 ];
    $day =  $date[2];
    $year = $date[0];
    return $day . ' ' . $month . ' ' . $year;
} 
```

这确实不是理想的解决方案，但是，它确实具有工作的明显优势。希望这可以帮助某人。

# regex - 信用卡到期日期的正则表达式

> ID：13464166
> 
> 赞同：1
> 
> 时间：2012-11-19T23:20:20.407
> 
> 标签：regex

> **可能重复：**
> [描述信用卡到期（有效至）日期的正则表达式](https://stackoverflow.com/questions/7992477/regular-expression-to-describe-credit-card-expiry-valid-thru-date)

我正在尝试找到一个正则表达式模式来验证 4 位数的信用卡到期日期。格式是`YYMM`

我试过`[12-99]{2}[0-12]{2}` 了，但这允许 00 作为一个月

所以我想我真的需要一种方法来匹配第 3 位和第 4 位数字与 0 到 12 之间的数字，同时考虑前导零

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:22:56.487

`[12-99]`表示`1`or`2-9`或`9`，相当于`[1-9]`. 与第二个相同的`[0-12]`意思是`0-1`or `2`，相当于`[0-2]`。

你可以这样做：

```
(1[2-9]|[2-9][0-9])(0[1-9]|1[0-2]) 
```

如您所见，使用正则表达式检查[数字范围](http://www.regular-expressions.info/numericranges.html)有点麻烦。如果您在编程语言中使用它（而不是工具或 XSD 限制），您可能应该使用编程语言的整数不等式运算符检查`(\d\d)(\d\d)`并验证两个捕获的数字范围。这也将允许您使有效年份的下限取决于当前年份（因此，到 2013 年，`12`前两位数字不再允许，无需更改代码）。

# php - 如何将【Ƹ̴Ӂ̴Ʒ 等字符存储到 MySQL 数据库中？

> ID：13464179
> 
> 赞同：1
> 
> 时间：2012-11-19T23:21:08.823
> 
> 标签：php, mysql, database, character

我不太了解 UTF-8 等字符集，所以我迷失在其他帖子的术语中。

我一直在 phpMyAdmin (utf8_unicode_ci) 中使用默认排序规则的 VARCHAR，我得到了很多？，例如：???(???????)??? 安东尼

我尝试将行更改为使用 ASCII (ascii_general_ci) 无济于事。我知道我之前已经解决了这个问题并且它 100% 有效，我只是不记得我是怎么做到的。有人有想法么？

谢谢！

# c++ - 双递归结构

> ID：13464187
> 
> 赞同：2
> 
> 时间：2012-11-19T23:21:43.767
> 
> 标签：c++, recursion, struct

我对如何创建两个相互引用的结构感到困惑。我找不到任何像以前那样问过的问题。
所以，我知道这会编译得很好：

```
 struct MyStruct {
        MyStruct* p;
    }; 
```

但是，例如，

```
 struct A {
        B* pBstruct;
    };
    struct B {
        A* pAstruct;
    }; 
```

这不会编译。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T23:23:15.640

您需要前向声明以使类型为人所知：

```
struct B;
struct A {
    B* pBstruct;
};
struct B {
    A* pAstruct;
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:34:04.987

所以，我知道我问过它，但我想通了，并认为回答它可能会帮助其他人。

就像制作递归函数一样，结构也必须进行原型设计。
因此，考虑制作递归函数：

```
 int fnc_a();
    int fnc_b();

    int fnc_a()
    {
        fnc_b();
    }
    int fnc_b()
    {
        fnc_a();
    } 
```

前两行标识为函数的原型，以便在提供实际定义/声明之前可以使用它们。
现在考虑再次创建两个递归结构：

```
 struct A;
    struct B;
    struct A {
        B* pBstruct;
    };
    struct B {
        A* pAstruct;
    }; 
```

前两行声明了这两个结构的存在，以便在声明它们之前可以使用它们。（不要费心评论我只需要 B 结构原型的事实——我确实认识到这一点）

最后一点，不要忘记使用 struct 'pointer' 变量而*不是*struct 变量。这不会编译，因为它会创建一个无限大的结构：

```
 struct A;
    struct B;
    struct A {
        B pBstruct;
    };
    struct B {
        A pAstruct;
    }; 
```

# php - Jquery Ajax 返回 NaN

> ID：13464198
> 
> 赞同：2
> 
> 时间：2012-11-19T23:22:07.667
> 
> 标签：php, jquery, ajax, google-chrome, nan

我正在使用 jQuery ajax，我试图从 php 文件中返回值“5.0000”，然后将值转换为浮点数。

我确定从 PHP 文件返回的值是“5.0000”，因为我使用了 alert() 和 document.write()。但是当我使用 parseFloat(value); 转换这个值时 并在警报或document.write中使用它，它会打印“NaN”。

OBS：我刚刚在firefox中测试过，它返回正确，但在chrome中它仍然返回“NaN”，为什么！？

任何人，帮帮我？我整天都在试图解决这个问题...... :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-05T01:12:38.420

使用 INFINITY 常量来防范 NaN：

```
 parseFloat(value + Number.POSITIVE_INFINITY) 
```

如果结果是`Infinity`，`value`大概是`""`

如果结果是`NaN`，`value`大概是`undefined`

# c++ - 返回指向 const 对象的 const 共享指针的 const 向量

> ID：13464199
> 
> 赞同：4
> 
> 时间：2012-11-19T23:22:20.997
> 
> 标签：c++, stl, constants, shared-ptr

给定以下基于共享指针容器的类，

```
class Foo;

class Bar {
public:
  // ...
  const std::vector<boost::shared_ptr<const Foo> >& getFoos() const { return foos_; }
private:
  std::vector<boost::shared_ptr<Foo> > foos_;
}; 
```

这不会编译，因为

```
invalid initialization of reference of type ‘const std::vector<boost::shared_ptr<const Foo>, std::allocator<boost::shared_ptr<const Foo> > >&’ from expression of type ‘const std::vector<boost::shared_ptr<Foo>, std::allocator<boost::shared_ptr<Foo> > >’ 
```

该`foos_`成员需要指向可变`Foo`对象以供对象内部使用`Bar`，但我不希望客户端代码调用`getFoos()`能够修改任何内容。

从返回类型中删除限定符可以解决此问题`const`。但是，我知道虽然将它的常量传播到它的元素，但它（自然地）指向的对象并没有做这样的事情。因此，在我看来，它不再遵守它的限定符（即使编译器没有抱怨），因为客户端代码可以修改返回的共享指针指向的对象。`Foo``getFoos()``std::vector``boost::shared_ptr``getFoos()``const``Foo`

我对么？如果是这样，是否有某种方法可以编写`getFoos()`，以便它将 const 引用的 const 向量返回到 const 对象而无需复制？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:36:08.083

我可能是错的，但我真的不认为你能做到这一点。

`shared_ptr<Foo>``shared_ptr<const Foo>`只有通过构造一个新实例才能成为`shared_ptr<const Foo>`

对 的引用`shared_ptr<Foo>`不能成为对 的引用`shared_ptr<const Foo>`，仅仅因为它们是两种**不同**的类型。

在这里，您试图获得`vector<shared_ptr<Foo>>`对`const vector<shared_ptr<const Foo>>`.

第一个`const`完全没问题。因为可以使用 const 限定符将引用分配给相同的引用类型。

但第二个`const`不是，因为您实际上是在尝试将对向量的引用转换为对向量的`Type A`引用`Type B`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T18:14:51.957

与其返回 a `std::vector<...> const&`，不如返回一个范围呢？范围是某种`pair`迭代器的一个。在这种情况下，您的迭代器将是 to `std::shared_ptr<const foo>`。您可以通过编写一个快速迭代器适配器来做到这一点，该适配器在内部迭代`const_iterator`到`std::shared_ptr<foo>`，但将它们返回为`std::shared_ptr<const foo>`.

您想要在 a 上执行的大多数操作`const` `vector`都可以在 a `range`of random-access上执行`const_iterator`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:00:23.827

您可以返回`const shared_ptr<Foo>*`指针而不是向量，并使用显式丑陋的 C 样式转换转换`foos_.data()`为您想要的任何内容。

由于您对返回 const 向量感兴趣，因此返回指针不会损失太多，当然，大小信息除外。您始终可以将新指针包装在旨在提供此大小信息的类中，就像在创建时提供的那样。

# .net - 手动添加对 csproj 的服务引用

> ID：13464207
> 
> 赞同：1
> 
> 时间：2012-11-19T23:22:41.230
> 
> 标签：.net

设置：在过去的一年中，我创建了大约 20 个常见的 WCF 服务，用于处理我公司内的特定任务。开发人员已经开始在他们的应用程序中轻松使用这些服务来执行这些特定任务。问题是因为公司目前没有强制使用这些公共服务的职位（小公司，我们只是没有资源或带宽来强制执行标准，我希望在它得到之前解决这个问题更糟糕或难以管理）一些团队倾向于编写自己的服务，这些服务在功能上反映了现有公共服务已经完成的功能。

为了解决这个问题，我正在构建一个基本的 Web 应用程序，它只是构建一个“服务层”类库，其中包含执行特定功能的公共服务引用（包括一些公开的帮助方法）。例如，如果应用程序需要允许部分保存和文件上传，那么我会将服务引用添加到我们的文件上传服务和我们的表单保存服务到这个服务层类库。

问题：
有没有办法动态/以编程方式检索 WCF 服务引用的文件（与 VS 2010 在“添加服务引用”时所做的非常相似）并将它们附加到 csproj 文件？我知道如何构建通用构建文件 (csproj)，但我不确定需要什么或将服务引用附加到该项目的最佳方法是什么。

任何帮助将不胜感激，我提前感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:44:13.227

您不需要生成这些文件来访问 WCF 服务 - VS2010 正在为您做的*是生成合同和数据对象的客户端镜像。例如，如果您`Foo`在服务器上定义了一个，那么您将获得该创建的客户端版本，并且生成的代理将反序列化为该客户端版本的`Foo`.

如果您确实想生成这些文件，请参阅[这个先前的 SO 答案](https://stackoverflow.com/a/5662450/109702)，了解如何使用 svcutil.exe 将代理文件生成到特定目录的示例。请注意，您确实应该将合同和数据对象放在单独的程序集中，如果这样做，那么您将能够实现客户端和服务器之间的重用 - 换句话说，svcutil 不需要生成客户端副本那些数据对象。

*请记住，这是 VS 的默认行为，可以更改。

# c# - 实体框架深度查询多对多

> ID：13464209
> 
> 赞同：0
> 
> 时间：2012-11-19T23:22:50.617
> 
> 标签：c#, .net, entity-framework

实体框架的新手，试图找出一些东西。我有如下表格：

```
Users
---------
UserID
UserName

Roles
---------
RoleID
RoleName

UserRoles
---------
UserRoleID
UserID
RoleID 
```

我正在使用存储库模式。这是一个存储库的示例（它们本质上都是相同的）

```
public class RoleRepository : IRoleRepository
{
    private AuthorizationContext context = new AuthorizationContext();
    public IQueryable<Role> Roles
    {
        get
        {
            return this.context.Roles;
        }
    }
    public bool Save(Role pRole)
    {
        if (pRole.RoleID == 0 || pRole.RoleID == null)
        {
            context.Roles.Add(pRole);
        }
        context.SaveChanges();
        return true;
    }
    public bool Delete(Role pRole)
    {
        context.Roles.Remove(pRole);
        context.SaveChanges();
        return true;
    }
} 
```

现在，我想测试一个用户（通过 UserName）是否属于一个角色（通过 RoleName）。如何查询？我希望它是这样的，但它不起作用：

```
public bool IsUserInRole(string username, string roleName)
{
    var repo = new UserRepository();
    var user = repo.Users.FirstOrDefault(u => u.NetID == username && u.UserRoles.FirstOrDefault(r => r.Role.Name == roleName));
} 
```

如何查询用户是否属于该角色？如果可能的话，我更喜欢使用谓词。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:22:39.207

我会使用这样的 .Any 函数：

```
public static bool IsUserInRole(string username, string roleName)
{
  using(var roleRepository = new RoleRepository())
  {
    return roleRepository.Roles.Any(r => r.RoleName == roleName && r.UserRoles.Any(ur => ur.User.UserName == username));
  }
} 
```

这是一个示例控制台应用程序：

```
class Program
{
  static void Main(string[] args)
  {
    var users = new List<string> { "A", "B", "C", "D" };
    var roles = new List<string> { "User", "Admin", "Superuser"};

    //User A has roles: User, Admin, Superuser
    Debug.Assert(IsUserInRole(users[0], roles[0]) == true);
    Debug.Assert(IsUserInRole(users[0], roles[1]) == true);
    Debug.Assert(IsUserInRole(users[0], roles[2]) == true);

    //User B has roles: User, Admin
    Debug.Assert(IsUserInRole(users[1], roles[0]) == true);
    Debug.Assert(IsUserInRole(users[1], roles[1]) == true);
    Debug.Assert(IsUserInRole(users[1], roles[2]) == false);

    //User C has roles: User
    Debug.Assert(IsUserInRole(users[2], roles[0]) == true);
    Debug.Assert(IsUserInRole(users[2], roles[1]) == false);
    Debug.Assert(IsUserInRole(users[2], roles[2]) == false);

    //User D has no roles
    Debug.Assert(IsUserInRole(users[3], roles[0]) == false);
    Debug.Assert(IsUserInRole(users[3], roles[1]) == false);
    Debug.Assert(IsUserInRole(users[3], roles[2]) == false);

    Debugger.Break();
  }

  public static bool IsUserInRole(string username, string roleName)
  {
    using(var roleRepository = new RoleRepository())
    {
      return roleRepository.Roles.Any(r => r.RoleName == roleName && r.UserRoles.Any(ur => ur.User.UserName == username));
    }
  }
}

public interface IRoleRepository : IDisposable
{

}

public class RoleRepository : IRoleRepository
{
  private Context context = new Context();
  public IQueryable<Role> Roles
  {
    get
    {
      return this.context.Roles.AsQueryable<Role>();
    }
  }

  public void Dispose()
  {
      //Do nothing
  }
}

public class Context : IDisposable
{
  public IList<User> Users { get; set; }
  public IList<Role> Roles { get; set; }
  public IList<UserRole> UserRoles { get; set; }

  public Context()
  {
    //Generate Some Fake Data
    Users = new List<User>();
    Users.Add(new User { UserID = 1, UserName = "A" });
    Users.Add(new User { UserID = 2, UserName = "B" });
    Users.Add(new User { UserID = 3, UserName = "C" });
    Users.Add(new User { UserID = 4, UserName = "D" });

    Roles = new List<Role>();
    Roles.Add(new Role { RoleID = 1, RoleName = "User" });
    Roles.Add(new Role { RoleID = 2, RoleName = "Admin" });
    Roles.Add(new Role { RoleID = 3, RoleName = "Superuser" });

    UserRoles = new List<UserRole>();
    UserRoles.Add(new UserRole(1, Users[0], Roles[0]));
    UserRoles.Add(new UserRole(1, Users[0], Roles[1]));
    UserRoles.Add(new UserRole(1, Users[0], Roles[2]));
    UserRoles.Add(new UserRole(1, Users[1], Roles[0]));
    UserRoles.Add(new UserRole(1, Users[1], Roles[1]));
    UserRoles.Add(new UserRole(1, Users[2], Roles[0]));

    //User A has roles: User, Admin, Superuser
    //User B has roles: User, Admin
    //User C has roles: User
    //User D has no roles
  }

  public void Dispose()
  {
    //Do nothing
  }
}

public class User
{
  public int UserID { get; set; }
  public string UserName { get; set; }

  public IList<UserRole> UserRoles { get; set; }

  public User()
  {
    UserRoles = new List<UserRole>();
  }
}

public class Role
{
  public int RoleID { get; set; }
  public string RoleName { get; set; }

  public IList<UserRole> UserRoles { get; set; }

  public Role()
  {
    UserRoles = new List<UserRole>();
  }
}

public class UserRole
{
  public int UserRoleID { get; set; }

  public int UserId { get; set; }
  public User User { get; set; }

  public int RoleId { get; set; }
  public Role Role { get; set; }

  public UserRole(int id, User user, Role role)
  {
    UserRoleID = id;

    UserId = user.UserID;
    User = user;
    user.UserRoles.Add(this);

    RoleId = role.RoleID;
    Role = role;
    role.UserRoles.Add(this);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:43:04.723

这是您已经创建的修改后的“IsUserInRole”API：

```
 public bool IsUserInRole(string username, string roleName)
    {
        var repo = new UserRepository();
        return repo.Users.Any(u => u.UserName == username && u.UserRoles.Any(userrole => userrole.Role.RoleName == roleName));
    } 
```

您的 API 的问题是 FirstOrDefault，它限制了导航属性。

# c# - 如何在 XML 中将子节点设置为父节点？

> ID：13464213
> 
> 赞同：0
> 
> 时间：2012-11-19T23:23:04.560
> 
> 标签：c#, xml

我有一个这种格式的 XML 文档：

```
<EX>
    <file filename="File1">
        <form name="form1"/>
        <form name="form2"/>
        <form name="form3"/>
    </file>
    <file filename="File2">
        <form name="form2"/>
        <form name="form3"/>
    </file>
</EX> 
```

...我需要转换成这种格式：

```
<EX>
    <form name = "form1">
        <file filename="File1"/>
    </form>
    <form name = "form2">
        <file filename="File1"/>
        <file filename="File2"/>
    </form>
    <form name = "form3">
        <file filename="File1"/>
        <file filename="File2"/>
    </form>
</EX> 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:25:42.453

这是您可以做到的一种方法：

遍历您的原始 xml 文档并为原始文档中的每个子节点创建一个新文档。然后再次遍历原始文档，在新文档中创建相应的子文档。

# cuda - Cuda中两个不同内核之间的计算

> ID：13464214
> 
> 赞同：2
> 
> 时间：2012-11-19T23:23:08.570
> 
> 标签：cuda, kernel

这是我编写的两个内核函数——完整的代码没有编译错误，但有警告。

该程序是关于生物学序列比对的。在内核一中，矩阵`s0`是使用`gpu_sample`和计算的`gpu_data`，在内核二中，与内核一`gpu_s0`中的相同`gpu_s0`。`gpu_s`由`gpu_s0`和 自己计算。这是代码和警告：

```
__global__ void myKernel1( char** gpu_sample, char** gpu_data, float **gpu_s0)   
{
    dim3 dimGrid1;
    dim3 dimBlock1;
    dimBlock1.x = dimBlock1.y = BLOCK_SIZE;
    dimGrid1.x = dimGrid1.y = GRID_SIZE;

    int i1 = threadIdx.x + blockIdx.x * dimBlock1.x;
    int j1 = threadIdx.y + blockIdx.y * dimBlock1.y;

    if( i1 > N || j1 > M ) return;
    while ( j1 < (M+1) && i1 < (N+1) )
    {
        if(gpu_sample[0][j1] == gpu_data[i1][0])    // here is the warning part.
        {

            gpu_s0[i1+1][j1+1] = 5;
        }
        else 

            gpu_s0[i1+1][j1+1] = -3;

    i1 += blockDim.x * gridDim.x;
    j1 += blockDim.y * gridDim.y;
    }
}

__global__ void myKernel2( float **gpu_s0, float **gpu_s )
{
    dim3 dimGrid2;
    dim3 dimBlock2;
    dimBlock2.x = dimBlock2.y = BLOCK_SIZE;
    dimGrid2.x = dimGrid2.y = GRID_SIZE;

    float w = -4;                                   
    float zero = 0;

    __shared__ float shared[ threadsPerBlock ][threadsPerBlock]; 
    int i2 = threadIdx.x + blockIdx.x * dimBlock2.x;
    int j2 = threadIdx.y + blockIdx.y * dimBlock2.y;

    while( j2 < (M+1) && i2 < (N+1) )
    {
      shared[threadIdx.x][threadIdx.y] = gpu_s0[i2][j2];      // here is the warning.

      i2 += blockDim.x * gridDim.x;
      j2 += blockDim.y * gridDim.y;
    }

    __syncthreads();

    if( j2 < (M+1) && i2 < (N+1) )
    gpu_s[i2][0] = gpu_s[0][j2] = 0;

    /*if ( j2 < (M+1) && i2 < (N+1) )
    sTemp0[threadIdx.x][threadIdx.y] = gpu_s0[i2][j2]; //????????
    __syncthreads();*/

    if( i2 > N || j2 > M ) return;
    while ( j2 < (M+1) && i2 < (N+1) )
    {

        gpu_s[i2][j2] = max(gpu_s[i2-1][(j2-1)] + shared[threadIdx.x][threadIdx.y], //?????????
                          gpu_s[i2][(j2-1)] + w, 
                          gpu_s[(i2-1)][j2] + w, 
                          zero);     // here is the warning.
        i2 += blockDim.x * gridDim.x;
        j2 += blockDim.y * gridDim.y;
    }

} 
```

警告：

```
./test_10_15_2012.cu(155): Warning: Cannot tell what pointer points to, assuming global memory space
./test_10_15_2012.cu(155): Warning: Cannot tell what pointer points to, assuming global memory space
./test_10_15_2012.cu(155): Warning: Cannot tell what pointer points to, assuming global memory space
./test_10_15_2012.cu(186): Warning: Cannot tell what pointer points to, assuming global memory space
./test_10_15_2012.cu(208): Warning: Cannot tell what pointer points to, assuming global memory space
./test_10_15_2012.cu(208): Warning: Cannot tell what pointer points to, assuming global memory space
./test_10_15_2012.cu(208): Warning: Cannot tell what pointer points to, assuming global memory space
./test_10_15_2012.cu(208): Warning: Cannot tell what pointer points to, assuming global memory space 
```

有人可以帮我解决这个问题，或者给我一些建议吗？

# c# - 如何使用 UNC 路径创建位图对象？

> ID：13464220
> 
> 赞同：0
> 
> 时间：2012-11-19T23:23:39.683
> 
> 标签：c#, asp.net, bitmap, unc

我正在尝试做这样的事情

```
Bitmap img = new Bitmap("\\\\server\\folder\\picture.jpg"); 
```

每次都失败。

我知道我有权读取该文件，因为我可以手动访问它。

一般来说，我想知道如何在 C# 中使用 UNC 路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:32:11.050

在您的 ASP.Net 服务器上运行代码的帐户似乎没有读取此文件的权限。一些可能的原因：

*   单跳身份验证（如果您使用模拟运行代码）
*   匿名帐户对“\server”没有权限

在采取后续步骤授予对它的访问权限之前，您需要弄清楚在哪个帐户代码下运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:34:14.907

该路径是有效的。此外，使用 C# 中的字符串文字，您可以像这样声明它们 @".\MyPath\Doesn'tNeed\DoubleSlashes\Because\IUsed@\file.txt"

本教程将向您展示如何使用凭据（您可能需要）访问 UNC 路径[http://www.codeproject.com/Articles/43091/Connect-to-a-UNC-Path-with-Credentials](http://www.codeproject.com/Articles/43091/Connect-to-a-UNC-Path-with-Credentials)

请记住，仅仅因为机器 A 上的用户有权访问机器 B 上的文件并不意味着他们可以在不输入凭据的情况下这样做。

# css - 为什么我不能在 div 中覆盖 img？

> ID：13464227
> 
> 赞同：2
> 
> 时间：2012-11-19T23:24:33.277
> 
> 标签：css, html

我已经花了几个小时，似乎无法弄清楚这一点。我有一个与此类似的 html 树：

```
<div class="region">
  <div class="area" id="one">
    <img src="..." />
    <span>...</span>
... 
```

然后我的CSS有：

```
.region {
  margin-left: auto;
  margin-right: auto;
  padding: 0;
  width: 80%;
}

.area {
  display: inline-block;
  text-align: center;
  width: 25%;
}​

.area img {
  border: 1px solid green;
  margin: 0;
} 
```

问题是由于某种原因我似乎无法覆盖区域类中的 img 。当我查看萤火虫时，我只看到一个全局 img 被应用（显示：内联块），没有别的。

有趣的是，在 css 中将“img”替换为“span”确实会覆盖它！这怎么可能发生？测试错别字等，但我似乎无法弄清楚。

非常感谢任何提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:53:40.680

我在 Firefox 16.02 以及最新的 Safari 和 Chrome 中看到了同样的问题。但是，向图像添加一个类可以修复它：

```
<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
    .region {
      margin-left: auto;
      margin-right: auto;
      padding: 0;
      width: 80%;
    }
    .area {
      display: inline-block;
      text-align: center;
      width: 25%;
    }​
    .area img {
      border: 1px solid green;
      margin: 0;
    }    
    .area .place {
        border: 1px solid purple;
    }
    </style>
    <title>Hello Dolly!</title>
</head>
<body>
    <div class="region">
        <div class="area" id="one">
            <img src="../Pictures/TheBridge.jpg" class="place">
            <span>Span This</span>
        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:54:43.940

我发现了导致它的问题，但我不明白为什么会这样。我原来的 CSS 选择器是这样的：

```
.area {
  display: inline-block;
  text-align: center;
  width: 25%;
}​

.area img {
  border: 1px solid green;
  margin: 0;
}

.area span {
  vertical-align: middle !important;
} 
```

使用这个顺序，代码不起作用并且 img 被完全忽略，但 span 不是。

现在，如果我将 img 与 span 交换，留下 .area、.area span、.area img 的顺序，那么 span 会被忽略，但 img 不会！

有人知道是什么原因造成的吗？我从来没有遇到过这种问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:42:01.600

有人可以在真正的浏览器上试试这个[http://jsfiddle.net/UxLuJ/1/](http://jsfiddle.net/UxLuJ/1/)看看你是否可以重现这个问题？

就我而言，使用 Chrome 版本 23.0.1271.64 和 Firefox 16.0.2 无法正确解析 img 标签。解决问题的一种方法是执行以下操作：在 .country 和 .country img 之间添加一个虚拟选择器，如下所示：

```
.country .foo {} 
```

这样，img 标签就被正确识别了。

这似乎与 Carl 报告的错误相同，尽管我使用了稍微不同的解决方法。

我很感激其他人确认这一点。

# java - 无法为 JSP 编译类：无法解析 BooksWorker

> ID：13464231
> 
> 赞同：0
> 
> 时间：2012-11-19T23:25:05.503
> 
> 标签：java, jakarta-ee, tomcat

我有一个包含三个文件的 Java EE 项目`delete.jsp`，`index.jsp`并且`BooksWorker.java`.

在这里我无法运行`index.jsp`，即使我放置`BooksWorker.class`在 WEB-IN/classes 中。我得到的错误：

```
 type Exception report

message Unable to compile class for JSP:

description The server encountered an internal error that prevented it from fulfilling this request.

exception

org.apache.jasper.JasperException: Unable to compile class for JSP: 

An error occurred at line: 24 in the jsp file: /index.jsp
BooksWorker cannot be resolved
21:   String remark = request.getParameter("remark");
22:   if (author != null && title != null 
23:           && year != null && remark!= null) {
24:      BooksWorker.Insert(author, title, year, remark);
25:   }
26: %>
27: 

Stacktrace:
    org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:92)
    org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)
    org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:439)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:356)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:334)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:321)
    org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:592)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:328)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)

note The full stack trace of the root cause is available in the Apache Tomcat/6.0.36 logs. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:55:39.450

尝试将`BooksWorker`类从未[命名包](http://docs.oracle.com/javase/specs/jls/se7/html/jls-7.html#jls-7.4.2)移动到[命名包](http://docs.oracle.com/javase/specs/jls/se7/html/jls-7.html#jls-7.4.1)。JSP 编译器无法访问 [未命名包] 中的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:03:38.140

该错误很可能是由于未在 jsp 中导入 BooksWorker。

```
<%@page import="<package name>.BooksWorker"%> 
```

# python - 如何在 MongoDB 中打印最小结果

> ID：13464232
> 
> 赞同：0
> 
> 时间：2012-11-19T23:25:07.743
> 
> 标签：python, mongodb

MongoDB新手在这里...

所以，我试图在一个看起来像这样的集合中打印出最小值分数......

```
 > db.students.find({'_id': 1}).pretty()
        {
                "_id" : 1,
                "name" : "Aurelia Menendez",
                "scores" : [
                        {
                                "type" : "exam",
                                "score" : 60.06045071030959
                        },
                        {
                                "type" : "quiz",
                                "score" : 52.79790691903873
                        },
                        {
                                "type" : "homework",
                                "score" : 71.76133439165544
                        },
                        {
                                "type" : "homework",
                                "score" : 34.85718117893772
                        }
                ]
        } 
```

我使用的咒语是这样的......

```
db.students.aggregate(
    // Initial document match (uses index, if a suitable one is available)
    { $match: {
        _id : 1
    }},

    // Expand the scores array into a stream of documents
    { $unwind: '$scores' },

    // Filter to 'homework' scores 
    { $match: {
        'scores.type': 'homework'
    }},

    // grab the minimum value score
    { $match: {
        'scores.min.score': 1
    }}
) 
```

我得到的输出是这个......

```
{ "result" : [ ], "ok" : 1 } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:10:47.947

您的想法是正确的，但是在聚合的最后一步中，您要做的是按学生对所有分数进行分组并找到 $min 值。

将最后一个管道操作更改为：

```
{ $group: {
        _id: "$_id",
        minScore: {$min: "$scores.score"}
    }} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:01:17.430

```
> db.students.aggregate(     
{ $unwind:  "$scores" },`
{ $match:{"scores.type":"homework"} }, 
{ $group: { 
    _id : "$_id", 
   maxScore : { $max : "$scores.score"}, 
   minScore: { $min:"$scores.score"} 
  }
}); 
```

[如何聚合MongoDB中集合中的每个项目](https://stackoverflow.com/questions/13465062/how-to-aggregate-on-each-item-in-collection-in-mongodb/13465287#comment18425674_13465287)

# sql - 使用 Cacti 监控 Microsoft SQL 服务器

> ID：13464233
> 
> 赞同：2
> 
> 时间：2012-11-19T23:25:15.507
> 
> 标签：sql, sql-server

是否有人使用 Cacti 来监控 SQL 服务器计数器（磁盘队列长度、i/o 请求等）。如果是，你是如何做到这一点的？基本上，我在我的 SQL Server 上收集了许多性能计数器。我需要一种方法来创建图表并对我收集的数据进行切片和切块？如果您知道任何其他图形解决方案，请告诉我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-16T16:41:18.513

是的，做了几次：

[http://docs.cacti.net/usertemplate:host:microsoft:sqlserver](http://docs.cacti.net/usertemplate:host:microsoft:sqlserver)

它真的很好用。您需要访问权限才能创建登录名。这是您运行的非侵入性脚本：

```
/*  SQL 2005/2008 */
USE [master]
GO
CREATE LOGIN [cactistats] WITH PASSWORD=SomePassword, DEFAULT_DATABASE=[master], DEFAULT_LANGUAGE=[us_english], CHECK_EXPIRATION=OFF, CHECK_POLICY=OFF
GO
EXEC sys.sp_addsrvrolemember @loginame = N'cactistats', @rolename = N'processadmin'
GO
CREATE USER [cactistats] FOR LOGIN [cactistats] WITH DEFAULT_SCHEMA=[dbo]
GO
GRANT SELECT ON [sys].[dm_os_performance_counters] TO [cactistats]
GO
/* END */ 
```

一旦它运行并且您根据安装文档添加了脚本，您将能够绘制 SQL 指标图表。

麦克风

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-28T16:07:37.627

此答案是对正确标记答案的补充。

如果你需要监控一个特定的**sql server 实例**，那么你需要编辑这个脚本文件

```
/usr/share/cacti/site/scripts/ss_win_mssql.php 
```

并更改行：

```
if (! $link = mssql_connect($host.':'.$port, $username, $password) ) 
```

到

```
$host = ($port == '1433' ? $host : $host.':'.$port);
if (! $link = mssql_connect($host, $username, $password) )
     return; 
```

并在创建图表时设置主机名和实例，如下所示：

[![设置sql实例名称](../Images/e45d34c7db6ee7f8afcd50c3e57757af.png)](https://i.stack.imgur.com/hmvs8.png)

# rapidminer - 是否可以从命令行将 CSV 导入 RapidMiner 存储库？

> ID：13464234
> 
> 赞同：1
> 
> 时间：2012-11-19T23:25:15.847
> 
> 标签：rapidminer

我正在考虑使用 RapidMiner 来存储和分析由脚本过程收集的数据集合。有没有办法从命令行脚本将 CSV 文件导入 RapidMiner 存储库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T08:29:49.043

不是直接的。但是您可以使用连接到“存储”操作员的“读取 CSV”操作员创建一个流程，并将此流程存储在存储库中。可以从命令行调用此过程。如果文件和存储库位置是静态的并且不会更改，那么这就是您需要做的一切。

但是要动态指定输入文件和存储库位置，您需要宏。这些宏可以在命令行中设置，但遗憾的是仅在 RapidMiner 5.3 版中可用，目前尚未发布（但将在几周内发布）。[同时，您可以使用来自sourceforge SVN 存储库（Unuk 分支）](http://sourceforge.net/scm/?type=svn&group_id=114160)的最新版本。

在存储库中存储 CSV 的过程：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<process version="5.3.000">
  <context>
    <input/>
    <output/>
    <macros/>
  </context>
  <operator activated="true" class="process" compatibility="5.3.000" expanded="true" name="Process">
    <process expanded="true" height="190" width="413">
      <operator activated="true" class="read_csv" compatibility="5.3.000" expanded="true" height="60" name="Read CSV" width="90" x="45" y="30">
        <parameter key="csv_file" value="%{csv-file}"/>
        <list key="annotations"/>
        <list key="data_set_meta_data_information"/>
      </operator>
      <operator activated="true" class="store" compatibility="5.3.000" expanded="true" height="60" name="Store" width="90" x="179" y="30">
        <parameter key="repository_entry" value="%{repository-location}"/>
      </operator>
      <connect from_op="Read CSV" from_port="output" to_op="Store" to_port="input"/>
      <portSpacing port="source_input 1" spacing="0"/>
      <portSpacing port="sink_result 1" spacing="0"/>
    </process>
  </operator>
</process> 
```

假设您已将此过程保存在*//home/steve/csv-to-repository*并且您的当前目录是 RapidMiner 目录，您可以通过以下方式从命令行调用它：

```
./script/rapidminer //home/steve/csv-to-repository "-Mcsv-file=/path/to/your/csv/file" "-Mrepository-location=//repository/path/to/store/csv" 
```

# php - 在 header() 中包含 php 变量

> ID：13464235
> 
> 赞同：0
> 
> 时间：2012-11-19T23:25:19.347
> 
> 标签：php, variables, header

我还在学习 php，但我还没有弄清楚何时使用 ' 或 "。我猜这就是这段代码的问题。它将我重定向到正确的页面，但 $loc 变量没有被继承。

```
 <?php header("Location: roomdata.php?loc=$loc"); ?> 
```

在有 header() commaned 的页面上，我还有一个包含命令...

```
<?php  include 'include/globalscripts.php';  ?> 
```

在 globalscripts.php 中是...

```
<?php if( isset($_GET['loc']))?>

<?php $loc = $_GET["loc"];?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:29:00.843

我个人会使用：

```
<?php
    header('Location: roomdata.php?loc='.$loc);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:32:17.273

```
<?php if( isset($_GET['loc']))?>

<?php $loc = $_GET["loc"];?>

TRY

<?php
    if( isset($_GET['loc'])){
        $loc = $_GET["loc"];
    }
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:28:28.990

您的代码应该可以工作，您确定`$loc`此时已定义吗？

关于`'`和`"`：

```
$value = "derp";
echo "the value is:\t$value";
//output: the value is:     derp

echo 'the value is:\t$value';
//output: the value is:\t$value 
```

# ruby-on-rails - Rails 可以充当在 mysite 上托管域的反向代理吗？

> ID：13464237
> 
> 赞同：5
> 
> 时间：2012-11-19T23:25:24.293
> 
> 标签：ruby-on-rails, ruby-on-rails-3, tumblr, reverse-proxy

我有 mysite.com。目前我的博客是 blog.mysite.com

我希望我的博客是：mysite.com/blog - 这将指向一个 tumblr 博客。

是否可以将 Rails 用作反向代理，在 mysite.com/blog 上主要 URL 结构并显示 tumblr 内容，维护 mysite.com/blog url 和文章 url... 不重定向到 tumblr 的 URL？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:32:10.883

是的，这是可能的，但解决方案非常繁重。您需要做的是在控制器上定义将获取远程内容并呈现它的方法。

```
require 'net/http'

class TunblrController<ApplicationController
  def index
    uri = URI('http://tumlbr.com/myblog')
    html = Net::HTTP.get(uri)
    render :html=>html
  end
end 
```

话虽如此，你最好使用 Nginx、HAProxy 或其他类似的解决方案

# jquery - JQuery中ajax调用的一些疑惑

> ID：13464239
> 
> 赞同：0
> 
> 时间：2012-11-19T23:25:32.327
> 
> 标签：jquery, ajax, json

我对 JQuery 脚本有一些疑问（我是 JQuery 世界的新手）：

在视图页面中，我有以下链接：

```
 <li>
            <a id="byHeader" href="<c:url value="/mapping/header" />">By presence of header</a>
        </li> 
```

因此，单击此链接我会生成一个指向“/mapping/header”文件夹的 HTTP 请求。

现在在视图页面中，我还有以下与先前链接相关的 JQuery 代码：

```
$("#byHeader").click(function(){    // Select the link having id="byHeader" and  assign to it the following callback function executed on the click event
    var link = $(this);             // Variable refered to the link tag that triggered the event

    /* La chiamata AJAX non viene invocata su un oggetto particolare (quindi direttamente su $)
       I parametri di input sono: 1) L'URL del link selezionato 2) Il tipo di risposta previso (una stringa)
    */
    $.ajax({ url: this.href, dataType: "text", 
        // Before sending the HTTP Request: execute a function that add an Header to this HTTP Request
        beforeSend: function(req) { req.setRequestHeader("FooHeader", "foo"); }, 
        // Success case:
        success: function(form) { 
            MvcUtil.showSuccessResponse(form, link); 
        }, 
        // Error case:
        error: function(xhr) { 
            MvcUtil.showErrorResponse(xhr.responseText, link); 
        }
    });
    return false;
}); 
```

可能我的怀疑是微不足道的，取决于我对 JQuery 缺乏了解......

1）第一个不考虑这行代码中的req变量：

```
 beforeSend: function(req) { req.setRequestHeader("FooHeader", "foo"); }, 
```

通过这行代码，我认为我正在向我的 HTTP 请求添加一个标头以将其发送到服务器。

我的问题是了解它指向名为“req”的变量。我认为这是指我的 HTTP 请求，但我的问题是我之前从未声明过它......我正在使用它（并且它运行良好）而之前从未在代码中声明过它！为什么它起作用？

我在想，当我使用 beforeSend 时，它会自动创建一个参数变量，其中包含对我的函数的 HTTP 请求的引用......但是......最后我不知道它是否正确......

2）关于这些代码行的第二个疑问：

```
 success: function(form) { 
            MvcUtil.showSuccessResponse(form, link); 
        }, 
```

这些代码行处理成功的情况（脚本能够将标头附加到 HTTP 请求的情况）...

阅读 JQuery succes api 文档我了解成功方法（它是一种方法吗？对吗？）接受从服务器返回的数据作为参数...

正如您在代码中看到的那样，服务器向客户端返回一个文本字符串（实际上我有：dataType：“text”）......所以......为什么在前面的代码行中参数被命名为“form”？

服务器向客户端返回文本，而不是“表单”......我错过了什么？

而且......也在这种情况下：我没有创建表单变量，它是一个包含服务器返回的数据的“通用”变量，我可以使用它，因为在前一行中我使用了 JSON 格式阿贾克斯调用？

非常感谢你

安德烈亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:34:48.270

1.  jQuery ajax 系统`req`为您创建并将其作为参数传递给您的回调。

2.  不知道，只是一个奇怪的变量名称......你是对的，如果你的`dataType`is `text`，结果将作为一个纯字符串出现。

    至于您不创建变量，返回的数据（在本例中为字符串）再次由 jQuery 创建，并作为回调的参数传递。

您似乎对“变量”和“函数参数”的概念感到困惑。我建议阅读更多关于“全局变量”和“变量范围”的信息。简而言之，`req`并且`form`只能从这些函数**内部**获得，它们之外的代码将无法访问它。OTOH，如果您在`var x`某处声明变量，则同一范围内的每个代码都可以访问它（如果您在任何函数之外声明它，它将是全局的，因此您的所有代码都可以访问它）。

# magento - 需要在结帐模块内复制单页结帐

> ID：13464240
> 
> 赞同：1
> 
> 时间：2012-11-19T23:25:37.337
> 
> 标签：magento, magento-1.3

我需要复制 CE 1.3.3 中的单页结帐功能，并希望能够通过 domain.com/index.php/checkout/onepage-variant 访问它，以便能够在不干扰核心单页结帐文件的情况下自定义单页. 这已经在开发环境中，创建另一个商店不是一种选择。

解决这个问题的最佳方法是什么？

建议将不胜感激！

编辑：只是为了进一步澄清，我需要的是 2 个单页结帐的功能实例。我们将根据 2 种不同的自定义进行测试，看看哪一种效果最好。

# tomcat - 在 IntelliJ IDEA 中将项目添加到 Tomcat 的类路径

> ID：13464242
> 
> 赞同：4
> 
> 时间：2012-11-19T23:26:12.333
> 
> 标签：tomcat, intellij-idea

在 Eclipse 中，我添加了一个 Tomcat 服务器。我单击*Open launch configuration*，然后在**Edit Configuration**对话框中的选项卡**Classpath**中，我可以将 Eclipse 项目添加到“User Entries”类路径中。

现在我想在 IntelliJ Idea 中实现同样的目标。该项目具有许多 WAR servlet 共享的属性文件（配置文件）。

到目前为止我已经尝试过：

在 IDEA 中，服务器是在**Application Servers**对话框下配置的。我在*Libraries*下看到了 Tomcat 的 jar ，您可以*Attach Files 或 Directories*。我已经尝试在项目中添加我的属性文件夹。我还将项目打包到一个 JAR 中（我正在使用 Maven）并添加了该存档。遗憾的是我没有取得任何成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:34:42.413

这是一个详细的教程 [http://wiki.jetbrains.net/intellij/Creating_a_simple_Web_application_and_deploying_it_to_Tomcat](http://wiki.jetbrains.net/intellij/Creating_a_simple_Web_application_and_deploying_it_to_Tomcat)

此外，Idea 帮助页面可能很有用 [http://www.jetbrains.com/idea/webhelp/run-debug-configuration-tomcat.html](http://www.jetbrains.com/idea/webhelp/run-debug-configuration-tomcat.html)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-20T16:09:30.757

您还可以在为您的应用程序生成的部署工件（war/exploded war）中添加配置和属性文件/文件夹。当可部署的工件被清理时，这些文件/文件夹将被删除。但是如果只使用 intellij IDE 来自动执行此操作，那就太好了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-21T23:36:24.147

我有一个类似的问题。我无法以类似于 Eclipse 的方式解决它，但我确实找到了解决方案。

我发现的唯一解决方案是在您的 pom 文件中包含对项目/资源的引用。这可以包括构建标签内的资源标签。

```
<build>
...
<resources>
    <resource>                    
        <directory>path/to/resources</directory>
        <filtering>false</filtering>
    </resource>
</resources> 
```

如果您需要测试资源，则可以执行以下操作：

```
... 
<build> 
    <plugins> 
        <plugin> 
            <groupId>org.apache.maven.plugins</groupId> 
            <artifactId>maven-surefire-plugin</artifactId> 
            <version>2.9</version> 
            <configuration> 
                <additionalClasspathElements>
                    <additionalClasspathElement>path/to/additional/resources</additionalClasspathElement>
                    <additionalClasspathElement>path/to/additional/jar</additionalClasspathElement> 
                </additionalClasspathElements> 
            </configuration> 
        </plugin> 
    </plugins> 
</build> 
... 
```

我在此解决方案中看到的问题是我必须添加资源路径并在 pom.xml 中提交该更改。任何其他可能在单独文件夹中拥有这些资源的开发人员都必须更改 pom 以指向其资源的位置。

顺便说一句，我从以下对话中得到了一些解决方案。

[http://maven.40175.n5.nabble.com/How-to-add-a-folder-to-the-classpath-used-during-maven-build-td4754387.html](http://maven.40175.n5.nabble.com/How-to-add-a-folder-to-the-classpath-used-during-maven-build-td4754387.html)

# c - 为什么主要功能会出现“控制到达非无效功能结束”的警告？

> ID：13464243
> 
> 赞同：24
> 
> 时间：2012-11-19T23:26:25.973
> 
> 标签：c

我运行以下 C 代码并收到警告：控制到达非无效函数的结尾

```
int main(void) {} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-19T23:28:32.490

只需放入`return 0`您的`main()`. 您的函数 main 返回一个 int ( `int main(void)`) 因此您应该在它的末尾添加一个 return 。

控制到达非空函数的末尾

```
Problem: I received the following warning: 
```

**警告**：控制到达非无效函数的结尾

解决方案：此警告类似于 Return with no value 中描述的警告。如果控制到达函数的末尾并且没有遇到返回，则 GCC 假定返回没有返回值。但是，为此，该函数需要一个返回值。在函数的末尾，添加一个 return 语句，该语句返回一个合适的返回值，即使控制永远不会到达那里。

[来源](http://publib.boulder.ibm.com/infocenter/tpfhelp/current/index.jsp?topic=/com.ibm.ztpf-ztpfdf.doc_put.cur/gtpm1/m1rhnvf.html)

**解决方案**：

```
int main(void)
{
    my_strcpy(strB, strA);
    puts(strB);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-19T23:32:35.243

作为向 中添加`return`语句的明显解决方案的替代方案`main()`，您可以使用 C99 编译器（“gcc -std=c99”，如果您使用的是 GCC）。

`main()`在 C99 中，没有语句是合法的`return`，然后 final`}`隐式返回 0。

```
$ gcc -c -Wall t.c
t.c: In function ‘main’:
t.c:20: warning: control reaches end of non-void function
$ gcc -c -Wall -std=c99 t.c
$ 
```

* * *

纯粹主义者认为重要的注意事项：您不应该**通过**声明`main()`为返回类型来修复警告`void`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-19T23:28:31.383

主函数的返回类型为 int，如

```
int main(void) 
```

但是您的 main 函数不返回任何内容，它会在之后关闭

```
puts(strB); 
```

添加

```
return 0; 
```

之后，它将起作用。

# c# - 不需要的背景图像刷新

> ID：13464245
> 
> 赞同：0
> 
> 时间：2012-11-19T23:26:32.287
> 
> 标签：c#, winforms, timer, refresh, transparency

我有一个带有背景图像集的表单和一个用作计时器输出的标签。标签位于透明的表格布局面板中。不幸的是，随着计时器的每一次滴答，背景都会明显刷新。我怎样才能防止这种情况？

这是每个刻度调用的函数。

```
 private void DisplayCountry()
    {
        if (sel.Count == 1) 
        {
            country_out.Text = "No countries chosen.\nPlease select some.";
            timer_out.Visible = false;
        }
        else{
        timer_out.Text = String.Format("{0:00}", (sel[i].elapsed / 60)) + ":" + String.Format("{0:00}", (sel[i].elapsed % 60));
        if (sel[i] == "sent")
        {
            country_out.Text = "No countries left.";
            timer_out.Visible = false;
        }
        else
        {
            timer_out.Visible = true;
            country_out.ForeColor = Color.RoyalBlue;
            country_out.Text = sel[i].name;
            if (sel[i].elapsed > REDTIME)
                timer_out.ForeColor = Color.SteelBlue;
            else
                timer_out.ForeColor = Color.Tomato;
        }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:18:39.667

设置 ForeColor 将刷新图像，即使它已经是该颜色。在设置之前检查它是否已经是那个颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:45:33.927

最终，我摆脱了 TableLayoutPanel，牺牲了一些对齐，并使用 PictureBox 作为背景。PictureBox 不会引起刷新问题，我想它已为此目的进行了优化。感谢您的回复。

# servicestack - 为什么 ServiceStack 使用此配置返回 404？

> ID：13464247
> 
> 赞同：6
> 
> 时间：2012-11-19T23:26:47.340
> 
> 标签：servicestack

我有以下配置。

```
<location path="services">
  <system.web>
    <httpHandlers>
      <add path="*" type="ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory, ServiceStack" verb="*" />
    </httpHandlers>
    <authorization>
      <allow users="*"/>
    </authorization>
  </system.web>
  <!-- Required for IIS 7.0 -->
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true" />
    <validation validateIntegratedModeConfiguration="false" />
    <handlers>
      <add path="*" name="ServiceStack.Factory" type="ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory, ServiceStack" verb="*" preCondition="integratedMode" resourceType="Unspecified" allowPathInfo="true" />
    </handlers>
  </system.webServer>
</location> 
```

如果我添加另一个`<system.webServer />`部分，而不是在`location`元素内，ServiceStack 会为所有请求返回 404。删除它，一切都会重新开始。

这是一个示例响应：

```
HTTP/1.1 404 未找到
缓存控制：私有
内容类型：文本/纯文本；字符集=utf-8
服务器：Microsoft-IIS/7.5
X-Powered-By：ServiceStack/3.926 Win32NT/.NET
X-AspNet-版本：4.0.30319
X-Powered-By: ASP.NET
日期：2012 年 11 月 19 日星期一 23:15:46 GMT
内容长度：1528

未找到请求的处理程序：

Request.ApplicationPath: /MyWebApp.Web.UI
Request.CurrentExecutionFilePath：/MyWebApp.Web.UI/services/echo/
Request.FilePath：/MyWebApp.Web.UI/services/echo/
请求.HttpMethod: GET
Request.MapPath('~'): D:\Lib\MyWebApp\2013\MyWebApp\MyWebApp.Web.UI
请求路径：/MyWebApp.Web.UI/services/echo/
请求路径信息：
Request.ResolvedPathInfo: /services/echo
Request.PhysicalPath：D:\Lib\MyWebApp\2013\MyWebApp\MyWebApp.Web.UI\services\echo\
Request.PhysicalApplicationPath：D:\Lib\MyWebApp\2013\MyWebApp\MyWebApp.Web.UI\
请求.查询字符串：
Request.RawUrl：/MyWebApp.Web.UI/services/echo/
Request.Url.AbsoluteUri：http://localhost/MyWebApp.Web.UI/services/echo/
Request.Url.AbsolutePath: /MyWebApp.Web.UI/services/echo/
Request.Url.Fragment：
Request.Url.Host：本地主机
Request.Url.LocalPath: /MyWebApp.Web.UI/services/echo/
Request.Url.Port：80
Request.Url.Query：
Request.Url.Scheme：http
Request.Url.Segments：System.String[]
App.IsIntegratedPipeline：真
App.WebHostPhysicalPath：D:\Lib\MyWebApp\2013\MyWebApp\MyWebApp.Web.UI
App.WebHostRootFileNames：[global.asax,global.asax.cs,header.html,list.html,login.html,MyWebApp.web.ui.csproj,MyWebApp.web.ui.csproj.user,packages.config,web .config、bin、人力资源、js、obj、属性、样式、_sgbak]
App.DefaultHandler: DefaultHttpHandler
App.DebugLastHandlerArgs: GET|/MyWebApp.Web.UI/services/echo/|D:\Lib\MyWebApp\2013\MyWebApp\MyWebApp.Web.UI\services\echo\

```

不能有另一个`system.webServer`部分吗？我想在那里添加 IIS url 重写规则。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T23:32:30.590

额外的`system.webServer`声明可能会干扰 ServiceStack 从您的 Web.Config 中自动推断托管路径。

您可以尝试手动设置路径以查看是否有帮助，例如在您的 AppHost.Configure() 中：

```
SetConfig(new HostConfig {
    HandlerFactoryPath = "services",
}); 
```

# windows-phone-8 - WP8 动态磁贴中的计数是否有最大字符数限制？

> ID：13464249
> 
> 赞同：4
> 
> 时间：2012-11-19T10:35:32.700
> 
> 标签：windows-phone-8

我正在尝试确定要使用的活动磁贴模板，并且需要知道这三个模板是否对显示的最大计数施加了限制。这似乎不在设计指南中：有人知道吗？

这可能是一个问题，因为我们当前的服务有一个巨大的最大值（5 位数！）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T00:32:13.660

**99**之后会显示**99+**

我想这是我们忘记放入公共文档的另一个细节。

# java - Android 自定义列表视图点击 - 如何在不崩溃的情况下调用意图？

> ID：13464250
> 
> 赞同：0
> 
> 时间：2012-11-19T23:27:04.163
> 
> 标签：java, android, listview, android-intent, clickable

好的，所以我已经在这上面做了几个小时，但无法让它工作。基本上，我想从可点击的列表视图中调用一个意图。我正在显示汽车型号，它是列表中的代码，当您单击时，您应该被带到另一个屏幕来编辑汽车的属性，但是，我开始认为这是不可能的

```
listAdapter = new ArrayAdapter<String>(this, R.layout.simplerow, arrayListCarros);  
    mainListView.setAdapter( listAdapter );      
    db.close();

    mainListView.setClickable(true);
    mainListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
        public void onItemClick(AdapterView<?> arg0, View arg1, int position, long arg3) {

            Intent i = new Intent(listagemcarro.this,com.example.trabalhosql.edicao.class);  
            startActivity(i);

      }
    }); 
```

其余代码：

```
 public class listagemcarro extends Activity {
Button buttonCadastro;
Button buttonListagem;
Button buttonBusca;
Button button1;

Intent itListagem = new Intent();
Intent itCadastro = new Intent();
Intent itBusca = new Intent();
//Intent itEdicao = new Intent();
Intent itEdicao2 = new Intent();

String id="";   

public SQLiteDatabase db;
public String BANCO = "banco.db";
public String TABELA = "carro";
int posicao=123123;

private ListView mainListView ;  
private ArrayAdapter<String> listAdapter ;  

public void toast(int position){
    Context context = getApplicationContext();
    Toast toast = Toast.makeText(context, position, Toast.LENGTH_SHORT);
    toast.show(); 

}
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.listagemcarro);

    Intent itRecebeParametros = getIntent();
    if(itRecebeParametros != null){
        id = itRecebeParametros.getStringExtra("id");
    }

    db = openOrCreateDatabase(BANCO, Context.MODE_PRIVATE, null);
    Cursor linhas = db.query(TABELA, new String[] {"ID_PESSOA, MODELO"},"id_pessoa = '"+id+"'", null, null, null, null);

    mainListView = (ListView) findViewById( R.id.mainListView );  

    ArrayList <String>arrayListCarros = new ArrayList<String> ();  

    if(linhas.moveToFirst()){ 
        do{
            arrayListCarros.add(linhas.getString(0) +" " + linhas.getString(1));
        }
    while(linhas.moveToNext()); 
    }

    listAdapter = new ArrayAdapter<String>(this, R.layout.simplerow, arrayListCarros);  
    mainListView.setAdapter( listAdapter );      
    db.close();

    mainListView.setClickable(true);
    mainListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
        public void onItemClick(AdapterView<?> arg0, View arg1, int position, long arg3) {

            Intent i = new Intent(listagemcarro.this,com.example.trabalhosql.edicao.class);  
            startActivity(i);

      }
    });

} 
```

错误

```
11-19 23:18:09.136: W/dalvikvm(1784): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
11-19 23:18:09.136: E/AndroidRuntime(1784): Uncaught handler: thread main exiting due to uncaught exception
11-19 23:18:09.147: E/AndroidRuntime(1784): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.trabalhosql/com.example.trabalhosql.edicao}: java.lang.NullPointerException
11-19 23:18:09.147: E/AndroidRuntime(1784):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)

11-19 23:18:09.147: E/AndroidRuntime(1784):     at android.app.ActivityThread.access$2200(ActivityThread.java:119)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at android.os.Looper.loop(Looper.java:123)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at android.app.ActivityThread.main(ActivityThread.java:4363)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at java.lang.reflect.Method.invokeNative(Native Method)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at java.lang.reflect.Method.invoke(Method.java:521)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at dalvik.system.NativeStart.main(Native Method)
11-19 23:18:09.147: E/AndroidRuntime(1784): Caused by: java.lang.NullPointerException
11-19 23:18:09.147: E/AndroidRuntime(1784):     at com.example.trabalhosql.edicao.onCreate(edicao.java:42)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
11-19 23:18:09.147: E/AndroidRuntime(1784):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
11-19 23:18:09.147: E/AndroidRuntime(1784):     ... 11 more 
```

edicao.class

```
package com.example.trabalhosql;

import java.util.ArrayList;

import android.os.Bundle;
import android.app.Activity;
import android.content.ContentValues;
import android.content.Context;
import android.content.Intent;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;

public class edicao extends Activity {

String id="";   
String modeloCarro = "";
TextView textViewCarroEscolhido;

public SQLiteDatabase db;
public String BANCO = "banco.db";
public String TABELA = "carro";

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.listagemcarro);

    Intent itRecebeParametros = getIntent();
    if(itRecebeParametros != null){
        id = itRecebeParametros.getStringExtra("id");
        modeloCarro = itRecebeParametros.getStringExtra("modeloCarro");
    }

    textViewCarroEscolhido = (TextView) findViewById(R.id.textViewCarroEscolhido);
    textViewCarroEscolhido.setText(modeloCarro);
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:32:07.723

**编辑**

我猜 edicao 课程的这一部分是不正确的：

```
setContentView(R.layout.listagemcarro); 
```

这本身可能不会引发错误，但尝试在其中查找不存在的视图（如您的 textView）会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:47:27.713

textViewCarroEscolhido 为空。确保它存在于 listagemcarro.xml

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-23T21:26:18.127

万一有人来这里是为了在画布等绘图情况下调用意图。确保您没有多次调用意图。在我的情况下，该`invalidate()`方法不断被调用并进行了许多意图调用。确保使用某种翻转机制来停止`invalidate()`被调用。会像魅力一样工作。

# ruby-on-rails - 将 Rails 3 测试装置加载到开发数据库中

> ID：13464257
> 
> 赞同：0
> 
> 时间：2012-11-19T23:27:34.327
> 
> 标签：ruby-on-rails, testing, fixtures

我有一套很好的夹具用于测试。当请求测试失败时，可以很方便地在加载了测试装置的情况下以交互方式运行应用程序。但是，如果我使用 -e test 运行完整的服务器，我会遇到各种疯狂的错误，可能与管道有关。

- 编辑 -

当我访问主页时，我在浏览器中得到了这个：

![在此处输入图像描述](../Images/5ed70646715015b54dc0604f96ce2a7b.png)

我说这太疯狂了，因为我不懂我如何一起使用它们（或者 gem twitter-bootstrap-rails 有一些错误。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:22:01.217

啊，更好的问题:-)。

gem 使用 LESS，它的`twitter-bootstrap-rails`作用类似于 SASS，但*又不*一样。SASS 是 Rails 的默认设置，也是一个不错的选择。如果你想使用 SASS，（并且根据错误，你似乎是），然后使用[Bootstrap SASS gem，链接在这里](https://github.com/thomas-mcdonald/bootstrap-sass)。可以同时使用 LESS 和 SASS，但这对我来说似乎是个坏主意。

查看[Ryan Bates 的优秀 RailsCast](http://railscasts.com/episodes/328-twitter-bootstrap-basics)，其中介绍了在 Rails 中使用 Twitter Bootstrap。它涵盖了这两种选择。然后花 9 美元让 Pro 访问他继续 RailsCast 的更多细节。

# c++ - 如何使用 llvm 生成机器码

> ID：13464259
> 
> 赞同：25
> 
> 时间：2012-11-19T23:27:38.430
> 
> 标签：c++, llvm, machine-code

我目前正在使用 llvm 进行编译器项目。我遵循了各种教程，直到我有一个解析器来创建语法树，然后使用提供的 IRBuilder 将树转换为 llvm 模块。

我的目标是创建一个可执行文件，但我对下一步该做什么感到困惑。我找到的所有教程都只是创建 llvm 模块并使用 Module.dump() 打印出程序集。此外，我能找到的唯一文档是针对 llvm 开发人员的，而不是针对项目的最终用户的。

如果我想生成机器码，接下来的步骤是什么？llvm-mc 项目看起来可以做我想做的事，但我找不到任何类型的文档。

也许我期待 llvm 做一些它没有做的事情。我的期望是我可以构建一个模块，然后会有一个我可以用模块调用的 API，一个目标三元组和一个目标文件将被生成。我找到了有关生成 JIT 的文档和示例，但我对此不感兴趣。我正在寻找如何生成已编译的二进制文件。

我正在开发 OS X，如果这有任何影响的话。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-22T13:41:54.117

用于`llc -filetype=obj`从您的 IR 发出可链接的目标文件。您可以查看代码`llc`以查看它发出此类代码的 LLVM API 调用。至少对于 Mac OS X 和 Linux，以这种方式发出的对象应该是相当不错的（即，现在这不是“alpha 质量”选项）。

但是，LLVM 不包含链接器（还没有！）。因此，要将这个目标文件实际链接到某个可执行文件或共享库中，您需要使用系统链接器。请注意，即使您有一个由单个目标文件组成的可执行文件，也必须链接后者。LLVM 社区的开发人员正在为 LLVM 开发一个真正的链接器，称为`lld`. 您可以访问[其页面](http://lld.llvm.org/)或搜索邮件列表档案以跟踪其进度。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-11-21T11:28:55.747

正如您[在 llc 指南](http://llvm.org/docs/CommandGuide/llc.html)中所读到的那样，它确实只是为了生成程序集，然后“然后可以将汇编语言输出通过本机汇编程序和链接器传递以生成本机可执行文件” - 例如 gnu 汇编程序（`as`）和链接器 ( `ld`)。

所以这里的主要答案是**使用本地工具进行组装和链接**。

但是，通过以下方式直接从 IR 文件生成本机对象有实验性支持`llc`：

```
-filetype      - Choose a file type (not all types are supported by all targets):
    =asm         -   Emit an assembly ('.s') file
    =obj         -   Emit a native object ('.o') file [experimental] 
```

或者您可以使用`llvm-mc`从`.s`文件中组装它：

```
-filetype      - Choose an output file type:
    =asm         -   Emit an assembly ('.s') file
    =null        -   Don't emit anything (for timing purposes)
    =obj         -   Emit a native object ('.o') file 
```

不过，我不知道链接器。

此外，我建议查看该`tools/bugpoint/ToolRunner.h`文件，该文件公开了一个包装器组合`llc`和平台的本机 C 工具链，用于生成机器代码。从它的标题评论中：

> 该文件公开了围绕平台 C 编译器的抽象，用于编译 C 和汇编代码。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-11-24T18:13:14.003

查看以下功能`llvm-c/TargetMachine.h`：

```
/** Emits an asm or object file for the given module to the filename. This
  wraps several c++ only classes (among them a file stream). Returns any
  error in ErrorMessage. Use LLVMDisposeMessage to dispose the message. */
LLVMBool LLVMTargetMachineEmitToFile(LLVMTargetMachineRef T, LLVMModuleRef M,
  char *Filename, LLVMCodeGenFileType codegen, char **ErrorMessage);

/** Compile the LLVM IR stored in \p M and store the result in \p OutMemBuf. */
LLVMBool LLVMTargetMachineEmitToMemoryBuffer(LLVMTargetMachineRef T, LLVMModuleRef M,
  LLVMCodeGenFileType codegen, char** ErrorMessage, LLVMMemoryBufferRef *OutMemBuf); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-23T19:59:33.863

要运行示例`BrainF`程序，请编译并运行：

```
echo ,. > test.bf
./BrainF test.bf -o test.bc
llc -filetype=obj test.bc
gcc test.o -o a.out
./a.out 
```

然后键入一个字母并按 Enter。它应该把那封信回馈给你。（就是`,.`这样。）

以上是使用 LLVM 版本 3.5.0 测试的。

# iphone - iPhone检测蓝牙设备

> ID：13464260
> 
> 赞同：1
> 
> 时间：2012-11-19T23:27:42.477
> 
> 标签：iphone, bluetooth, core-bluetooth, bluetooth-lowenergy

我在 iPhone 5 上使用 CoreBluetooth 的 HeartMonitor 示例。

现在我有一个蓝牙 4.0 加密狗（从 ebay 购买），在加密狗设置中我将它设置为耳机。我可以在 iPhone 的 iPhone 蓝牙设置中看到/配对它。但是使用 HeartMonitor 示例代码（将 UUID 选项调整为 Nil），但我无法看到扫描的任何设备。我也尝试过 UUID 180A（广播配置文件）、1108（耳机）和其他各种但没有运气。

```
- (void) startScanningForUUIDString:(NSString *)uuidString
{
    [centralManager scanForPeripheralsWithServices:nil options:nil];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T13:15:47.423

我没有把选项归零。我确实使用了 NSDictionnary：`NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithBool:FALSE], CBCentralManagerScanOptionAllowDuplicatesKey, nil];` 不要忘记使用`CentralManager`.

# java - Java TicTacToe 游戏无法正确显示

> ID：13464263
> 
> 赞同：0
> 
> 时间：2012-11-19T23:28:05.870
> 
> 标签：java, arrays, tic-tac-toe

好的，所以我正在写一个井字游戏。我已经编写了整个程序，但我不明白为什么它不能正确显示？

```
import java.util.Scanner;

public class TicTacToeGame {

        //constants for game options
        static final int STANDARD_GAME = 0;
    static final int QUIT = -1;

    //constants for the number of rows and columns in a standard TicTacToe grid
    static final int STANDARD_GRID_ROWS = 3;
    static final int STANDARD_GRID_COLUMNS = 3;

    //two dimensional array to represent a TicTacToe grid
    static char[][]grid = new char[STANDARD_GRID_ROWS][STANDARD_GRID_COLUMNS];

    //Scanner for input
    static Scanner keyboard = new Scanner(System.in);

//***RUN STANDARD GAME******************************************************

    static void runStandardGame() {

        int position = QUIT;
        char playerChar = 'X';
        boolean isGameOver = false;

        fillPosition();

        System.out.println("Choose a position to play.\n");

        displayGrid();

        do {
            System.out.print("Player " + playerChar +
             " (Enter a position or " + QUIT + " to resign): ");
            position = keyboard.nextInt();

            System.out.println("Choose a position to play.\n");

            displayGrid();

            if(isWin()) {
                System.out.print("\nPlayer " + playerChar +"WINS!!!\n");
                isGameOver = true;
            }
            else if (isTie()) {
                System.out.print("\nTIE.\n");
                isGameOver = true;
            }
            else {
                //switch players because one of the players has just played
                //and not won;, so, it is the other player's turn
                if (playerChar == 'X') {
                    playerChar = 'O';
                }
                else{
                    playerChar = 'X';
                }
            }
           }while(!isGameOver && position != QUIT);

    }//end of runStandardGame

//***PLAY*******************************************************************    

    static void play(int cell, char playerChar) {
        //the player has entered a number 1 through 9 for the position they want
        //to play, so, figure out which row and which column of the array this     is
        //For example, if the player wants to play 'X' in position 7, this means
        //the 'X' must go into row 2, column 0 of the array
        int row = 0;
        int column = 0;

        if (cell > 0 && cell <= (STANDARD_GRID_ROWS * STANDARD_GRID_COLUMNS)){
            row = (cell - 1) / STANDARD_GRID_ROWS;
            column = (cell - 1) % STANDARD_GRID_COLUMNS;
            grid[row][column] = playerChar;
        }
    }

//***IS WIN*****************************************************************    

    static boolean isWin() {
        boolean isWin = false;

        if (isRowWin() || isColumnWin() || isDiagonalWin()){
            isWin = true;
        }

        return isWin;
    }

//***IS TIE*****************************************************************

    static boolean isTie() {
        boolean isTie = false;

                if(!isRowWin() || !isColumnWin() || !isDiagonalWin()){

        int count = 9;                   

        for (int row = 0; row < 3; row ++){

            for (int column = 0; column < 3; column ++){
                if (grid[row][column] == 0)
                    count --;
                }
        }

        if (count == 0)
            {
            System.out.println("\nSorry, this game is tied.  Better luck next time!");
            return true;                
            }
        }
        return isTie;
    }

//***IS ROW WIN**********************************************************

    static boolean isRowWin() {

        boolean isRowWin = false;
        int column = 0 ;

        for (int row = 0;row < STANDARD_GRID_ROWS && !isRowWin; row++) {

            //if the three array elements on the same row are equal, 
            //then one of the players has either three 'X's on that
            //row, or three 'O's, and therefore, has won
            if (grid[row][column] == grid[row][column+1] &&
                grid[row][column+1] == grid[row][column+2]){
                    isRowWin = true;
                }
        }

        return isRowWin;

    }

//***IS COLUMN WIN**********************************************************

    static boolean isColumnWin() {

        boolean isColumnWin = false;

        int row = 0 ;

        for (int column = 0;column < STANDARD_GRID_COLUMNS && !isColumnWin;      column++) {

            //if the three array elements on the same row are equal, 
            //then one of the players has either three 'X's on that
            //row, or three 'O's, and therefore, has won
            if (grid[row][column] == grid[row+1][column] &&
                grid[row+1][column] == grid[row+2][column]){
                    isColumnWin = true;
                }
        }

        return isColumnWin;

    }

//***IS DIAGONAL WIN********************************************************

    static boolean isDiagonalWin() {

        boolean isDiagonalWin = false;
        int row = 0;
        int column = 0;
        if(
                (grid[row][column] == grid[row+1][column+1] &&
            grid[row+1][column+1] == grid[row+2][column+2])||
            (grid[row][column+2] == grid[row+1][column+1] &&
            grid[row+1][column+1] == grid[row+2][column])){
                isDiagonalWin = true;
            }

        return isDiagonalWin;

    }

//***GET USER CHOICE********************************************************

    static int getUserChoice() {
        int choice;

        System.out.print("Please enter your choice: ");
        choice = keyboard.nextInt();

        return choice;

    }

//***FILL POSITIONS*********************************************************

    static void fillPosition(){

        char position = '1';

                for (int row = 0; row < STANDARD_GRID_ROWS; row++) {
                    for (int column = 0; column < STANDARD_GRID_COLUMNS; column++) {
                         grid[row][column] = (char) ('1' + row*STANDARD_GRID_COLUMNS + column);
                    }
                }

        }

//***DISPLAY GRID***********************************************************

    static void displayGrid() {

    System.out.println((grid[0][0]) + " | " + (grid[0][1]) + " | " + (grid[0][2]));
    System.out.println("---------");
    System.out.println((grid[1][0]) + " | " + (grid[1][1]) + " | " + (grid[1][2]));
    System.out.println("---------");
    System.out.println((grid[2][0]) + " | " + (grid[2][1]) + " | " + (grid[2][2]));

    }

//***END********************************************************************

}//end of class 
```

在游戏中，我希望它显示板为：

```
 1 | 2 | 3
-----------
 4 | 5 | 6
-----------
 7 | 8 | 9 
```

无论我选择什么，无论在哪里，它都会反复要求我做出选择......即使我会故意赢一场，或者让他们打成平局以结束它，它是永无止境的......这是一个逻辑错误吗？

另外，我删除了一些我知道是正确的代码，这样更容易阅读和理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:38:13.110

do-while 循环`fillPosition`只执行一次。在条件下`row<4 && column<4 && position<10`，布尔值`position<10`最初将是`false`. 因为`position`是一个**`char`**，

```
position < 10 
```

被解释为

```
(int)position < 10 
```

`(int)position = (int)'2' = 49`(`position`在`'2'`第一次循环迭代之后)，它不小于`10`，所以这个条件是`false`，意味着*整个*循环条件也是`false`- 并且因此循环结束。

因此，`'1'`正确放置了，但没有其他操作（这是一个 do-while 循环，因此无论其条件如何，它都至少执行*一次）。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:35:31.960

您正在尝试将 char（列）与数字 10 进行比较，字符 '1' 的 ascii 数字大于那时，因此循环中断

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:38:29.013

你`fillPosition` `do-loop`的退出条件是错误的......

我还建议不要使用字符算术，最好使用 int and `Interger.toString(int)`，但这只是我。

例如，在使用复合`for`循环填充`grid`数组时使用循环，外部开始用于行，内部用于列

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T23:34:21.207

你的`fillPosition()`方法不对。它应该看起来像这样：

```
 static void fillPosition(){
        for (int row = 0; row < STANDARD_GRID_ROWS; row++) {
            for (int column = 0; column < STANDARD_GRID_COLUMNS; column++) {
                grid[row][column] = (char) ('1' + row*STANDARD_GRID_COLUMNS + column);
            }
        }

    } 
```

# python - 我怎样才能以有效的方式进行这个 numpy 数组操作？

> ID：13464274
> 
> 赞同：3
> 
> 时间：2012-11-19T23:29:17.353
> 
> 标签：python, numpy

我是 python 新手。

如果我有一个（mxn）数组，我如何找到哪一列具有特定值的最大重复次数，例如。1 ? 是否有任何简单的操作，而不是编写迭代循环来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:43:54.507

欢迎使用 python 和 numpy。您可以通过首先检查数组中的哪些值是 1，然后沿每一列计数，最后取 argmax 来获得具有最多 1 的列。在代码中，它看起来像这样：

```
>>> import numpy as np
>>> (m, n) = (4, 5)
>>> a = np.zeros((m, n))
>>> a[2, 3] = 1.
>>>
>>> a_eq_1 = a == 1
>>> repetitions = a_eq_1.sum(axis=0)
>>> np.argmax(repetitions)
3 
```

或者更简洁：

```
>>> np.argmax((a == 1).sum(axis=0))
3 
```

# javascript - 在 div 外滚动会滚动内容

> ID：13464276
> 
> 赞同：5
> 
> 时间：2012-11-19T23:29:23.720
> 
> 标签：javascript, jquery, html, css, scroll

我如何才能在 div 之外滚动，并且在我的情况下，动作将被分配给具有隐藏溢出的固定 div 是#scrollable_content。

**HTML**

```
<div id="container">
<div id="header">Header</div>        
    <div id="scrollable_content">
        Very long content<br />
        Very long content<br />
        ...
        Very long content<br />
        Very long content<br />        
    </div>
<div id="footer">Footer</div> 
```

​</p>

**CSS**

```
html, body {
    height:100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
}
div { margin: 0; padding: 0;}
div#header{position:absolute;top:0;width:100%;border:1px solid black;}
div#footer{position:absolute; bottom:0; width:100%; border:1px solid black;}

div#scrollable_content {
    height: 300px;
    overflow-y:auto;
    position: static;
    border: 1px solid green;
    margin: 150px;
} 
```

​</p>

这是示例[http://jsfiddle.net/gtyBn/](http://jsfiddle.net/gtyBn/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:57:56.143

这段代码可以解决问题，尽管您可能需要稍微调整处理程序的工作方式。大部分代码来自[http://www.adomas.org/javascript-mouse-wheel/](http://www.adomas.org/javascript-mouse-wheel/)，尽管我确实修改了句柄函数以满足您的需要。

```
/** This is high-level function.
 * It must react to delta being more/less than zero.
 */
function handle(delta) {
    var target = $('#scrollable_content');
    var top = target.scrollTop() - delta;
    target.scrollTop(top);
}

/** Event handler for mouse wheel event.
 */
function wheel(event){
    var delta = 0;
    if (!event) /* For IE. */
            event = window.event;
    if (event.wheelDelta) { /* IE/Opera. */
            delta = event.wheelDelta/120;
    } else if (event.detail) { /** Mozilla case. */
            /** In Mozilla, sign of delta is different than in IE.
             * Also, delta is multiple of 3.
             */
            delta = -event.detail/3;
    }

    /** If delta is nonzero, handle it.
     * Basically, delta is now positive if wheel was scrolled up,
     * and negative, if wheel was scrolled down.
     */
    if (delta) handle(delta);

    /** Prevent default actions caused by mouse wheel.
     * That might be ugly, but we handle scrolls somehow
     * anyway, so don't bother here..
     */
    if (event.preventDefault) event.preventDefault();
    event.returnValue = false;
}

if (window.addEventListener) window.addEventListener('DOMMouseScroll', wheel, false);
window.onmousewheel = document.onmousewheel = wheel; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:49:40.020

尝试使用鼠标滚轮插件[http://brandonaaron.net/code/mousewheel/demos](http://brandonaaron.net/code/mousewheel/demos)，或者您可能会找到其他的，甚至创建自己的解决方案，但它看起来像工作方向

# ruby-on-rails - Rails：如何在表单中使用带有 select_tag 的语言列表 gem？

> ID：13464277
> 
> 赞同：3
> 
> 时间：2012-11-19T23:29:42.407
> 
> 标签：ruby-on-rails

我正在尝试创建一个表单，其中一个问题是选择一种特定的语言。我正在尝试在这里使用语言列表宝石：[https](https://github.com/scsmith/language_list) ://github.com/scsmith/language_list 。但是，文档并没有真正向我展示如何将列表与 select_tag 结合起来。

```
<%= form_for users_path, :method => "get" do %>

    <%= label_tag "Select Country" %> <br>
    <%= country_select(:user, :country, [], :include_blank => true) %> <br>

    <%= label_tag "Language spoken" %>
    <%= select_tag "Language", options_from_collection_for_select(LanguageList::COMMON_LANGUAGES, "id", "name") %>

    <%= label_tag "City" %> <br>
    <%= text_field_tag(:city) %>

<% end %> 
```

给我错误

`undefined method 'id' for afr (af) - Afrikaans:LanguageList::LanguageInfo`

在线上

`<%= select_tag "Language", options_from_collection_for_select(LanguageList::COMMON_LANGUAGES, "id", "name") %>`

谁能帮我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T00:21:25.043

不要使用`"id"`. 文档说你应该使用`iso_639_1`（或者`iso_639_3`如果你想要 3 个字母的代码）

```
<%= select_tag "Language", options_from_collection_for_select(LanguageList::COMMON_LANGUAGES, "iso_639_1", "name") %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:34:26.380

LanguageList 类似乎返回 LanguageInfo 实例的散列，具有名称、类型和代码等属性——“options_from_collection_for_select”期望它的第一个参数是集合（在这种情况下是散列），第二个是返回值的方法您要识别的项目，第三个是显示字符串。

那么当有人选择一种语言时，你打算在数据库中存储什么？可能是其中一个代码，对吧？因此，如果这是真的，您可以将第二个参数设为集合实例将响应的方法，该方法（读取 gem 的源代码）是`iso_639_1`or `iso_639_3`。 `name`应该已经工作了。

因此，如果您替换`id`为这两个 iso_nnn_n 值之一，则应显示该表单。要实际将语言代码保存在数据库中，您需要在数据库中为其创建一个列，您可能已经将其作为`language`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-06T23:49:54.223

有时将 gem 的数据转储存储在数据库中很有意义。

这是 postgresql 和 rails 的示例[https://github.com/serghei-topor/import-language-list-into-db-rails-sample](https://github.com/serghei-topor/import-language-list-into-db-rails-sample)

这是 gem 数据转储的 csv 文件[https://github.com/serghei-topor/language-list-csv](https://github.com/serghei-topor/language-list-csv)

select_tag 看起来像：

```
<%= select_tag "Language", options_from_collection_for_select(Language.where(is_common:true).order(:name), "id", "name") %> 
```

# sql - 多个日期范围之间的分钟总和

> ID：13464281
> 
> 赞同：7
> 
> 时间：2012-11-19T23:30:26.107
> 
> 标签：sql, sql-server, sql-server-2008, function, date

场景是**用户**指定他们何时**可用**，这些指定的时间可以**相互重叠**。我正在尝试获取他们可用的总时间。SQL Fiddle 示例：

```
--Available--
ID  userID  availStart          availEnd
1   456     '2012-11-19 16:00'  '2012-11-19 17:00'
2   456     '2012-11-19 16:00'  '2012-11-19 16:50'
3   456     '2012-11-19 18:00'  '2012-11-19 18:30'
4   456     '2012-11-19 17:30'  '2012-11-19 18:10'
5   456     '2012-11-19 16:00'  '2012-11-19 17:10'
6   456     '2012-11-19 16:00'  '2012-11-19 16:50' 
```

输出应该是 130 分钟：

```
1: 60
2: 0 as falls inside 1
3: 30
4: 30 as the last 10 mins is covered by 3
5: 10 as first 60 mins is covered by 1
6: 0 as falls inside 1 
```

我可以获得总重叠分钟数，但这比可用分钟数的总和还要多：

[**SQL小提琴**](http://sqlfiddle.com/#!3/32dce/2)

有什么想法可以实现这一目标吗？

12 月 21 日编辑：到目前为止，感谢大家的解决方案——在某种程度上，我很高兴看到这不是一个“简单”的查询。

**12 年 11 月 23 日编辑**：这都是很棒的工作。在内部，我们认为最好确保用户不能输入重叠时间（例如，强制他们修改现有条目）！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T16:28:29.197

[Gordon Linoff](https://stackoverflow.com/users/1144035/gordon-linoff)有一个[基于 CTE 的答案](https://stackoverflow.com/a/13483625/167935)

我已经对所有工作算法进行了一些[性能分析](https://docs.google.com/spreadsheet/ccc?key=0Ar3ZD6o7Zd8_dGZXdW1QWmhKTWhiZV9BOVZZUEtKQXc)空白值意味着它花费了太长时间。这是在单个 Core i7 X920 @2GHz 芯片上测试的，由几个 SSD 支持。创建的唯一索引是 UserID 上的集群 AvailStart。如果您认为可以提高任何性能，请告诉我。

这个 CTE 版本比线性差，SQL Server 不能以有效的方式进行 RN = RN + 1 连接。我用下面的混合方法纠正了这个问题，我将第一个 CTE 保存并索引到一个表变量中。这仍然需要十倍于基于游标的方法的 IO。

```
With OrderedRanges as (
  Select
    Row_Number() Over (Partition By UserID Order By AvailStart) AS RN,
    AvailStart,
    AvailEnd
  From
    dbo.Available
  Where
    UserID = 456
),
AccumulateMinutes (RN, Accum, CurStart, CurEnd) as (
  Select
    RN, 0, AvailStart, AvailEnd
  From
    OrderedRanges
  Where 
    RN = 1
  Union All
  Select
    o.RN, 
    a.Accum + Case When o.AvailStart <= a.CurEnd Then
        0
      Else 
        DateDiff(Minute, a.CurStart, a.CurEnd)
      End,
    Case When o.AvailStart <= a.CurEnd Then 
        a.CurStart
      Else
        o.AvailStart
      End,
    Case When o.AvailStart <= a.CurEnd Then
        Case When a.CurEnd > o.AvailEnd Then a.CurEnd Else o.AvailEnd End
      Else
        o.AvailEnd
      End
  From
    AccumulateMinutes a
        Inner Join 
    OrderedRanges o On 
        a.RN = o.RN - 1
)

Select Max(Accum + datediff(Minute, CurStart, CurEnd)) From AccumulateMinutes 
```

[http://sqlfiddle.com/#!6/ac021/2](http://sqlfiddle.com/#!6/ac021/2)

在做了一些性能分析之后，这是一个混合 CTE/表变量版本，它的性能比基于游标的方法更好

```
Create Function dbo.AvailMinutesHybrid(@UserID int) Returns Int As
Begin

Declare @UserRanges Table (
  RN int not null primary key, 
  AvailStart datetime, 
  AvailEnd datetime
)
Declare @Ret int = Null

;With OrderedRanges as (
  Select
    Row_Number() Over (Partition By UserID Order By AvailStart) AS RN,
    AvailStart,
    AvailEnd
  From
    dbo.Available
  Where
    UserID = @UserID
)
Insert Into @UserRanges Select * From OrderedRanges

;With AccumulateMinutes (RN,Accum, CurStart, CurEnd) as (
  Select
    RN, 0, AvailStart, AvailEnd
  From
    @UserRanges
  Where 
    RN = 1
  Union All
  Select
    o.RN, 
    a.Accum + Case When o.AvailStart <= a.CurEnd Then
        0
      Else 
        DateDiff(Minute, a.CurStart, a.CurEnd)
      End,
    Case When o.AvailStart <= a.CurEnd Then 
        a.CurStart
      Else
        o.AvailStart
      End,
    Case When o.AvailStart <= a.CurEnd Then
        Case When a.CurEnd > o.AvailEnd Then a.CurEnd Else o.AvailEnd End
      Else
        o.AvailEnd
      End
  From
    AccumulateMinutes a
        Inner Join 
    @UserRanges o On 
        a.RN + 1 = o.RN
)

Select 
  @Ret = Max(Accum + datediff(Minute, CurStart, CurEnd)) 
From 
  AccumulateMinutes 
Option
  (MaxRecursion 0)

Return @Ret

End 
```

[http://sqlfiddle.com/#!6/bfd94](http://sqlfiddle.com/#!6/bfd94)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T03:28:40.260

主要问题是您可以拥有重叠条目链，因此您需要组合无限次以删除所有重叠 - 这比 SQL 更适合程序方法。但是，如果您不想使用临时表，这里有一个 CTE 方法 - 请记住，CTE 只能递归给定次数，因此如果您有任何特别长的链，它将失败。

```
WITH MergedAvailable
AS
(
  SELECT Available.UserID, Available.AvailStart, MAX(Available.AvailEnd) AS AvailEnd
    FROM Available
   WHERE (
           SELECT COUNT(*)
             FROM Available AS InnerAvailable
            WHERE InnerAvailable.AvailStart < Available.AvailStart
                  AND
                  InnerAvailable.AvailEnd >= Available.AvailStart
         ) = 0
   GROUP BY Available.UserID, Available.AvailStart
  UNION ALL
  SELECT MergedAvailable.UserID, MergedAvailable.AvailStart,
         LongestExtensionToAvailableInterval.NewIntervalEnd
    FROM MergedAvailable
   CROSS APPLY GetLongestExtensionToAvailableInterval(MergedAvailable.UserID,
               MergedAvailable.AvailStart,
               MergedAvailable.AvailEnd) AS LongestExtensionToAvailableInterval
   WHERE LongestExtensionToAvailableInterval.NewIntervalEnd IS NOT NULL
)

SELECT SUM(DATEDIFF(MINUTE,
                    FinalAvailable.AvailStart,
                    FinalAvailable.AvailEnd)) AS MinsAvailable
  FROM (
         SELECT MergedAvailable.UserID, MergedAvailable.AvailStart,
                MAX(MergedAvailable.AvailEnd) AS AvailEnd
           FROM MergedAvailable
          GROUP BY MergedAvailable.UserID, MergedAvailable.AvailStart
       ) AS FinalAvailable 
```

此表函数是必需的：

```
CREATE FUNCTION GetLongestExtensionToAvailableInterval
(
  @UserID int,
  @CurrentIntervalStart datetime,
  @CurrentIntervalEnd datetime
)
RETURNS TABLE
AS
RETURN 
  SELECT MAX(Available.AvailEnd) AS NewIntervalEnd
    FROM Available
   WHERE Available.UserID = @UserID
         AND
         Available.AvailStart > @CurrentIntervalStart
         AND
         Available.AvailStart <= @CurrentIntervalEnd
         AND
         Available.AvailEnd > @CurrentIntervalEnd 
```

一般的想法是，它从范围开始不重叠任何东西的所有范围开始，然后随着每次递归，它将当前范围扩展到当前重叠范围的最远范围。需要 table 函数来确定最远范围，因为 CTE 的递归部分不允许包含普通聚合。

使用您提供的数据，起始行是：

```
456 2012-11-19 16:00 2012-11-19 17:10
456 2012-11-19 17:30 2012-11-19 18:10 
```

最终通过递归添加的唯一行是：

```
456 2012-11-19 17:30 2012-11-19 18:30 
```

举例来说，假设您有一行 ID 为 7，从 18:20 到 19:20。然后会有第二次递归，它带回了行：

```
456 2012-11-19 17:30 2012-11-19 19:20 
```

因此，虽然查询将到达每个重叠范围的开始和结束，但它也将带回所有中间阶段。这就是为什么我们需要为 CTE 之后的每个开始日期取最大结束日期的总和，以删除它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T21:44:09.353

这是另一种使用光标的方法。我觉得这种技术应该适用于 CTE，但我不知道该怎么做

方法是按开始时间排列每个范围然后我们构建一个按顺序合并范围的范围，直到找到一个不与我们合并的范围重叠的范围。然后我们计算在合并范围内有多少分钟，并记住这一点 我们继续下一个范围，再次合并任何重叠的范围。每次我们得到一个不重叠的起点时，我们都会累积分钟最后我们将累积的分钟添加到最后一个范围的长度上

很容易看出，由于顺序的原因，一旦一个范围与之前的范围不同，那么没有更多的范围可以与之前的范围重叠，因为它们的开始日期都更大。

```
Declare
  @UserID int = 456,
  @CurStart datetime, -- our current coalesced range start
  @CurEnd datetime, -- our current coalsced range end
  @AvailStart datetime, -- start or range for our next row of data
  @AvailEnd datetime, -- end of range for our next row of data
  @AccumMinutes int = 0 -- how many minutes so far accumulated by distinct ranges

Declare MinCursor Cursor Fast_Forward For
Select
  AvailStart, AvailEnd
From
  dbo.Available
Where
  UserID = @UserID
Order By
  AvailStart

Open MinCursor

Fetch Next From MinCursor Into @AvailStart, @AvailEnd
Set @CurStart = @AvailStart
Set @CurEnd = @AvailEnd

While @@Fetch_Status = 0
Begin
  If @AvailStart <= @CurEnd -- Ranges Overlap, so coalesce and continue
    Begin
    If @AvailEnd > @CurEnd 
      Set @CurEnd = @AvailEnd
    End
  Else -- Distinct range, coalesce minutes from previous range
  Begin
    Set @AccumMinutes = @AccumMinutes + DateDiff(Minute, @CurStart, @CurEnd)
    Set @CurStart = @AvailStart -- Start coalescing a new range
    Set @CurEnd = @AvailEnd
  End
  Fetch Next From MinCursor Into @AvailStart, @AvailEnd
End

Select @AccumMinutes + DateDiff(Minute, @CurStart, @CurEnd) As TotalMinutes

Close MinCursor
Deallocate MinCursor; 
```

[http://sqlfiddle.com/#!6/3483c/15](http://sqlfiddle.com/#!6/3483c/15)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-21T09:47:51.057

条件**t1.availStart > t2.availEnd 或 t1.availEnd < t2.availStart**永远不会跨越的检查周期。如果超过，则最小availStart 或最大availEnd esleavailStart 或availEnd。

```
Probably more than one crossing period.
In your case it 
16:00:00 - 17:10:00 includes the ranges:16:00:00 - 16:50:00,
                                        16:00:00 - 16:50:00,
                                        16:00:00 - 17:00:00,
                                        16:00:00 - 17:10:00
17:30:00 - 18:30:00 includes the ranges:17:30:00 - 18:10:00,
                                        18:00:00 - 18:30:00 
```

2012 年 11 月 21 日更新；2012 年 11 月 30 日；04.01.2013

```
CREATE FUNCTION dbo.Overlap
 (
  @availStart datetime,
  @availEnd datetime,
  @availStart2 datetime,
  @availEnd2 datetime
  )
RETURNS TABLE
RETURN
  SELECT CASE WHEN @availStart >= @availEnd2 OR @availEnd <= @availStart2
              THEN @availStart ELSE
                               CASE WHEN @availStart > @availStart2 THEN @availStart2 ELSE @availStart END
                               END AS availStart,
         CASE WHEN @availStart >= @availEnd2 OR @availEnd <= @availStart2
              THEN @availEnd ELSE
                             CASE WHEN @availEnd > @availEnd2 THEN @availEnd ELSE @availEnd2 END
                             END AS availEnd

;WITH cte AS
 (
  SELECT userID, availStart, availEnd, ROW_NUMBER() OVER (PARTITION BY UserID ORDER BY AvailStart) AS Id
  FROM dbo.test53
  ), cte2 AS
 (
  SELECT Id, availStart, availEnd
  FROM cte
  WHERE Id = 1
  UNION ALL
  SELECT c.Id, o.availStart, o.availEnd
  FROM cte c JOIN cte2 ct ON c.Id = ct.Id + 1
             CROSS APPLY dbo.Overlap(c.availStart, c.availEnd, ct.availStart, ct.availEnd) AS o
  )
  SELECT TOP 1 SUM(DATEDIFF(minute, availStart, MAX(availEnd))) OVER()
  FROM cte2
  GROUP BY availStart 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/1627e/1/0)上的演示[](http://sqlfiddle.com/#!3/1627e/1/0)

 *** * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-20T00:02:08.327

```
Create Table #Available (
  ID int not null primary key,
  UserID int not null,
  AvailStart datetime not null,
  AvailEnd datetime not null
)

Insert Into #Available (ID,UserID, AvailStart, AvailEnd) Values
  (1,456, '2012-11-19 16:00', '2012-11-19 17:00'),
  (2,456, '2012-11-19 16:00', '2012-11-19 16:50'),
  (3,456, '2012-11-19 18:00', '2012-11-19 18:30'),
  (4,456, '2012-11-19 17:30', '2012-11-19 18:10'),
  (5,456, '2012-11-19 16:00', '2012-11-19 17:10'),
  (6,456, '2012-11-19 16:00', '2012-11-19 16:50'),
  (7,457, '2012-11-19 16:00', '2012-11-19 17:10'),
  (8,457, '2012-11-19 16:00', '2012-11-19 16:50');  
Select Distinct UserID 
into #users
from #Available

Create Table #mins(UserID int,atime datetime,aset tinyint )
Declare @start Datetime
Declare @end Datetime

Select @start=min(AvailStart),@end=max(AvailEnd) from #Available 
While @start<@end
    begin
     insert into #mins(UserID,atime) 
     Select UserID ,@Start from #users
     Select @start=DateAdd(mi,1,@start)
    end

update #mins set aset=1
from #Available
where atime>=AvailStart and atime<Availend and #mins.UserID = #Available.UserID

select UserID,SUM(aset) as [Minutes] 
from #mins
Group by UserID 
Drop table #Available
Drop table #mins
Drop table #users 
```**

# grails - 事务不会在使用 autoFlush 的 IntregrationSpecs 上回滚

> ID：13464283
> 
> 赞同：1
> 
> 时间：2012-11-19T23:30:33.023
> 
> 标签：grails, spock, integration-testing

我正在使用Grails。我所有的 Spock 集成测试都在工作。

但是当我将 autoFlush 属性设置为 true 时，一些测试开始失败，因为数据没有被回滚。

有任何想法吗？

*我正在使用 grails 2.1.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T00:19:48.073

我的一项测试是扩展规范而不是集成规范。当我扩展 IntegrationSpec 时，所有数据在每次测试后都会回滚。

# linux-kernel - Linux 内核转储：如何获取自旋锁的所有者

> ID：13464284
> 
> 赞同：3
> 
> 时间：2012-11-19T23:30:33.947
> 
> 标签：linux-kernel, crash-dumps, spinlock

我有一个在 24 核系统上生成的 linux 内核转储。大多数任务都卡在自旋锁上。有没有办法获得自旋锁的所有者？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T13:07:14.630

自旋锁没有“所有者”的概念，互斥锁有。

所以实际上你想知道的是哪个进程持有一个特定的自旋锁。这种信息通常在 lockdep backtrace 中可用。所以如果你启用了lockdep，你可以只读取内核日志，如果没有，你需要检查所有进程的回溯，类似于Sysrq-t。假设您已经拥有 vmcore，您可以使用 crash 实用程序来获取每个进程的回溯。

# c++ - 对数组/文件 I/O 进行排序

> ID：13464286
> 
> 赞同：0
> 
> 时间：2012-11-19T23:30:42.277
> 
> 标签：c++, arrays, sorting

我一直在做一个从文件中取出一个句子并输出文件中出现的字符数并将其从高到低排序的作业。文件中的句子是“奥利弗是一只金毛猎犬，它的毛又长又金。”。文件中的句点用作标记值。对于将排序功能放在哪里，我有点迷茫。该程序编译虽然它只显示一个空白屏幕。谁能给我一些关于如何调试这些问题的提示？

```
#include <iostream>
#include <fstream>

using namespace std;

void swap_values(int& v1, int& v2);
int index_of_smallest(int list[],int start_index, int number_used);
void initialize(int list[]);
void Sort(int list[],int&number_used);
void characterCount(char ch, int list[]);
void readText(ifstream& intext, char& ch, int list[]);
void totalCount(int list[]);

int main()
{
    int letterCount[26], number_used;
    char ch;
    ifstream inFile;

    inFile.open("Data_Chapter_7_8.txt");

    if (!inFile)
    {
       cout << " Cannot open file." <<endl;
    }
    initialize(letterCount);

    while (inFile.get(ch))
    {
        readText(inFile,ch,letterCount);
    }

    totalCount(letterCount);

    inFile.close();

    system("PAUSE");
    return 0;
}

void initialize(int list[])
{
    for(int x = 0;x<26;x++)
    list[x] = 0;
}

void characterCount (char ch, int list[])
{
    ch = tolower(ch);
    if(static_cast<int>(ch)>=97&&(static_cast<int>(ch)<=122))
    list[static_cast<int>(ch)-97]++;
}

void readText(ifstream& intext, char& ch, int list[])
{ 
    if (ch != '.')
    {
        characterCount (ch,list);
    }
}

void totalCount(int letterCount[])
{
    for(int x=0;x<26;x++)
        if(letterCount[x]>0)
            cout<<static_cast<char>(x+97)<<" "<<letterCount[x]<<endl;
}

void Sort(int list[], int number_used)
{
    int index_of_next_smallest;
    int index;
    for(index= 0; index<number_used -1; index++)
        index_of_next_smallest = index_of_smallest(list, index,number_used);
    swap_values(list[index],list[index_of_next_smallest]);
}

int index_of_smallest(int list[], int start_index, int number_used)
{
    int index_of_min;
    int min = list[start_index];
    index_of_min = start_index;
    for (int index= start_index + 1; index < number_used; index++)
        if (list[index]>min)
        {
            min = list[index];
            index_of_min = index;
        }
    return index_of_min;
}

void swap_values(int& v1, int& v2)
{
    int temp;
    temp = v1;
    v1 = v2;
    v2 = temp;
} 
```

# android - 动画后背景消失

> ID：13464287
> 
> 赞同：2
> 
> 时间：2012-11-19T23:30:43.233
> 
> 标签：android, android-layout, animation, background

我在三星 GIII 上看到了这个错误，并且能够在我的 vd 上复制它。

我的操作栏的背景在左侧菜单动画后消失。发生了什么让这种情况发生？

**图片：**
![在此处输入图像描述](../Images/ba49a2e8b0437ff861d110a2da8de83f.png)
![在此处输入图像描述](../Images/04fe712f8d3e42e192d20d4e13dc4bea.png)
![在此处输入图像描述](../Images/505b38cfc0a21daa2b67cd89766bda24.png)

**布局文件：**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:padding="0dp">
    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="50dp"
        android:padding="0dp"
        android:background="@drawable/actionbar">
        <RelativeLayout
            android:id="@+id/actionbarMenuBtn"
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:layout_alignParentLeft="true"
            android:layout_alignParentTop="true"
            android:background="@drawable/actionbar_button"
            android:clickable="true">
            <ImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerHorizontal="true"
                android:layout_centerVertical="true"
                android:src="@drawable/actionbar_menu"/>
        </RelativeLayout>
        <ImageView
            android:id="@+id/div1"
            android:layout_width="1px"
            android:layout_height="50dp"
            android:layout_toRightOf="@id/actionbarMenuBtn"
            android:src="@drawable/actionbar_divider"/>
        <RelativeLayout
            android:id="@+id/actionbarUpdatesBtn"
            android:layout_width="wrap_content"
            android:minWidth="50dp"
            android:layout_height="50dp"
            android:layout_alignParentRight="true"
            android:paddingLeft="10dp"
            android:paddingRight="10dp"
            android:background="@drawable/actionbar_button"
            android:clickable="true">
            <TextView
                android:id="@+id/actionbarUpdatesText"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerVertical="true"
                android:layout_centerHorizontal="true"
                android:paddingLeft="5dp"
                android:paddingRight="5dp"
                android:text="111"
                android:textColor="#8CFFFFFF"
                android:textSize="14dp"
                android:textStyle="bold"
                android:gravity="center"
                android:background="@drawable/actionbar_notify"/>
        </RelativeLayout>
        <ImageView
            android:id="@+id/div2"
            android:layout_width="1px"
            android:layout_height="50dp"
            android:layout_alignLeft="@+id/actionbarUpdatesBtn"
            android:src="@drawable/actionbar_divider"/>
    </RelativeLayout>
</RelativeLayout> 
```

# java - Java - 从反射中排除超类字段

> ID：13464288
> 
> 赞同：1
> 
> 时间：2012-11-19T23:30:49.923
> 
> 标签：java, class, reflection, field, superclass

我正在使用此代码来获取与对象关联的所有字段。有问题的对象有三个超类，其他类从这个对象扩展而来。

```
for (Field f : this.getClass().getFields()){
    try{
        fieldName = f.getName();
        fieldType = f.getType().toString();
        //Do more stuf
    } 
```

我不想获取与超类关联的字段，但我想要当前类中的所有字段以及所有可能从它扩展的字段。

如何筛选出我需要的字段？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T23:32:56.443

> 我不想获取与超类关联的字段，但我想要当前类中的所有字段以及所有可能从它扩展的字段。

你不能得到“所有可能从它扩展的东西”——但如果你使用[`Class.getDeclaredFields()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getDeclaredFields%28%29)而不是`getFields()`then 你只会得到该类中声明的字段。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-19T23:38:52.693

对于每一个`Field`你可以`getDeclaringClass()`用来确定声明字段的类，所以如果你有一个像这样的层次结构

```
A
|
B
|
C
|\
D E 
```

`C`并且您只想要在,`D`或中声明的字段`E`，那么您可以说

```
for (Field f : this.getClass().getFields()){
  if(C.class.isAssignableFrom(f.getDeclaringClass())) {
    // f was declared by C or one of its subclasses 
```

If `this`is an instance `C`you'll get just public fields of `C`， if `this`is a `D`you'll get public fields of `C`and `D`， if `this`is an `A`or`B`你将一无所获。

# ruby-on-rails - 使用 Unicorn + Rack 进行带外垃圾收集

> ID：13464290
> 
> 赞同：7
> 
> 时间：2012-11-19T23:31:09.210
> 
> 标签：ruby-on-rails, ruby, performance, garbage-collection, unicorn

我正在尝试在我的 Ruby on Rails 应用程序中运行带外垃圾收集（一旦请求完成了其响应）。我在 config.ru 中添加了以下内容：

```
# This file is used by Rack-based servers to start the application.
require ::File.expand_path('../config/environment',  __FILE__)
begin
  require 'unicorn/oob_gc'
rescue LoadError, NameError
end
# Out-of-band GC, runs GC after every 10th request and after the response
# has been delivered.
begin
  use Unicorn::OobGC, interval=10
rescue NameError
end

run MyApp::Application

GC.start 
```

然而，我正在查看我的 NewRelic 门户，大多数 Web 事务确实表明平均至少花费 110-150 毫秒进行垃圾收集。Unicorn::OoobGC 是否应该超出实际请求的范围？如果是，为什么这会出现在网络交易中？如何让垃圾收集所花费的时间发生在 Web 请求的上下文之外，以便感知的客户端响应时间更快？花费的 CPU 时间仍然是相同的，因为它需要在后台发生，但是，在后台比保持请求管道更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:43:19.310

如果单个请求分配了足够多的对象来触发 GC，尽管使用 unicorn 中间件移动了最终的 GC OOB，您仍然会看到为该请求报告的 gc 时间。

使用 ruby​​ 1.9.3 和 REE，您可以旋转各种 GC 旋钮来帮助控制触发 gc 的频率。有关设置 RUBY_HEAP_MIN_SLOTS、RUBY_GC_MALLOC_LIMIT 和 RUBY_FREE_MIN 的示例，请参阅[在 Ruby 1.9.3 中调整 GC，以便在长时间运行的服务应用程序中获得更好的行为。](http://www.web-l.nl/posts/15-tuning-ruby-s-garbage-collector-with-rvm-and-passenger)

# android - myEditText.setText 不在页面上刷新

> ID：13464294
> 
> 赞同：1
> 
> 时间：2012-11-19T23:32:03.073
> 
> 标签：android, eclipse

我有一个简单的活动，需要使用自定义密码键盘（屏幕上的按钮）接受 4 位 PIN 码。数字存储在四个 EditText 中。

当我单击一个按钮时，按钮中的文本存储在 a `char[]`(`myEditText.getText()`表明正在发生这种情况)，焦点`EditText`通过 an移动到下一个`onFocusListener()`，并且`Log`输出显示这一切都正确发生。

```
11-20 10:19:56.969: I/DebugA(17742): Pin1 更新为：1 // Pin1 是 ID
11-20 10:19:58.289: I/DebugA(17742): Pin2 更新为: 2 // '2' is Pin2.getText()
11-20 10:19:58.849：I/DebugA(17742)：Pin3 更新为：3
11-20 10:19:59.659：I/DebugA(17742)：Pin4 更新为：4

```

屏幕本身根本没有更新。EditTexts 都显示为空，即使代码执行得很好。

我已经查看了关于 SO 的一大堆答案，并尝试了许多完全没有运气的建议，所以我发布了这个问题，希望有人能对此有所了解！这事发生在别人身上过吗？

这是一些布局文件：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:id="@+id/layout1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentTop="true"
android:layout_centerHorizontal="true"
android:layout_marginTop="42dp" >

<EditText
    android:id="@+id/Pin1"
    android:tag="Pin1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:ems="2"
    android:gravity="center_vertical|center_horizontal"
    android:nextFocusDown="@+id/Pin2"
    android:maxLength="1"
    android:inputType="textPassword" />

...
...
...

</RelativeLayout> 
```

...按钮是：

```
<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:id="@+id/layout2"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_centerHorizontal="true"
android:layout_marginTop="21dp"
android:layout_below="@+id/layout1" >

<Button
    android:id="@+id/Button01"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:onClick="btnPinClick"
    android:text="1" />

<Button
    android:id="@+id/Button02"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:onClick="btnPinClick"
    android:layout_marginLeft="21dp"
    android:text="2" />

<Button
    android:id="@+id/Button03"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:onClick="btnPinClick"
    android:layout_marginLeft="21dp"
    android:text="3" />

</LinearLayout> 
```

该活动是标准活动 ( `MyActivity extends Activity`)。

有什么想法吗？

**更新**
这里是一些要求的java：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_login);

    LayoutInflater inflater = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    RelativeLayout layout = (RelativeLayout)inflater.inflate(R.layout.activity_login, null);

    EditText Pin1 = (EditText) layout.findViewById(R.id.Pin1);
    Pin1.setOnFocusChangeListener(focusListener);
    Pin1.setText("1");                 // <--THIS HAS NO EFFECT
    EditText Pin2 = (EditText) layout.findViewById(R.id.Pin2);
    Pin2.setOnFocusChangeListener(focusListener);
    EditText Pin3 = (EditText) layout.findViewById(R.id.Pin3);
    Pin3.setOnFocusChangeListener(focusListener);
    EditText Pin4 = (EditText) layout.findViewById(R.id.Pin4);
    Pin4.setOnFocusChangeListener(focusListener);
...
...
...
} 
```

`Onclick`方法是：

```
public void btnPinClick(View btnPin) {
    String PinNumber = ((Button)btnPin).getText().toString();
    RelativeLayout layout = (RelativeLayout)getLayoutInflater().inflate(R.layout.activity_login, null);

    ArrayList<View> views = (ArrayList<View>) layout.getFocusables(View.FOCUS_DOWN);
    EditText nextItem = null;

    for (int i = 0; i < views.size(); i++) {
                    // THIS IS THE CORRECT EditText FOR EACH OF THESE
        EditText textBox = (EditText) views.get(i);
        if (textBox.getTag().toString().equals(currentText)) {
            textBox.setText(PinNumber);
            pin[i] = PinNumber.toCharArray()[0];
            Log.i("DebugA", textBox.getTag().toString() + " updated to: " + textBox.getText().toString());
            textBox.invalidate();
            textBox.refreshDrawableState();
            if(i+1 < views.size()) {
                nextItem = (EditText) views.get(i+1);
            }
            else {
                doCheckPin();
            }
            break;
        }
    }
    if(nextItem != null){
        nextItem.requestFocus();
        currentText = nextItem.getTag().toString();
    }
} 
```

**更新 2**
以下是 OnFocusChangeListener 请求的代码：

```
protected OnFocusChangeListener focusListener = new OnFocusChangeListener() {

    @Override
    public void onFocusChange(View v, boolean hasFocus) {
        if(hasFocus) {
                            //THIS SIMPLY SETS A VARIABLE STRING TO SAY WHICH 
                            //EditText HAS FOCUS.
            currentText = v.getTag().toString();
        }

    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T05:36:40.920

看起来您除了在活动中使用 setContentView 之外还使用了布局充气器。并影响充气机引用的编辑文本。尝试删除充气器的使用，并完全依赖 setContentView 来完成这部分活动。您可能在不正确的视图层次结构中执行。

# ruby-on-rails - SQLite3::ConstraintException: xxxxx.created_at 可能不是 NULL

> ID：13464299
> 
> 赞同：2
> 
> 时间：2012-11-19T23:32:09.937
> 
> 标签：ruby-on-rails, activerecord, has-and-belongs-to-many

我有一个重新创建艺术家并将其与用户相关联的工作。用户 has_and_belongs_to_many :artists 和 Artist has_and_belongs_to_many :users。

```
def self.perform(itunes_id, user_id=nil)
  artist = Artist.find_by_itunes_id(itunes_id) || lookup_and_create_artist(itunes_id)
  if user_id && user = User.find(user_id)
    user.artists << artist
    user.save!
  end
end 
```

`user.artists << artist`引发此异常：

```
ActiveRecord::StatementInvalid: SQLite3::ConstraintException: artists_users.created_at may not be NULL: INSERT INTO "artists_users" ("artist_id", "user_id") 
```

我还看到了 Artists_genres 的创建（Artist 和 Genre 也有互惠的 HABTM 关系）

```
ActiveRecord::StatementInvalid: SQLite3::ConstraintException: artists_genres.created_at may not be NULL: INSERT INTO "artists_genres" ("artist_id", "genre_id") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T20:26:47.113

事实证明，这在 Rails 中是有目的的，但在许多问题中都被提出：

*   [https://github.com/rails/rails/issues/7732](https://github.com/rails/rails/issues/7732)
*   [https://github.com/rails/rails/issues/7735](https://github.com/rails/rails/issues/7735)
*   [https://github.com/rails/rails/issues/4653](https://github.com/rails/rails/issues/4653)
*   [https://github.com/rails/rails/pull/4682](https://github.com/rails/rails/pull/4682)

HABTM 关系不会自动设置时间戳，因此我可以删除它们或使用`has_many :artists, :through => :artists_genres`关系

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:45:07.447

听起来您的时间戳设置不正确。

如果您想用创可贴摆脱它，请将这两个字段重新定义为`NULL`able（而不是`NOT NULL`）。

当应用程序配置错误时，*通常*会出现问题。

确保

```
config.active_record.record_timestamps = true 
```

如果它是假的，那么时间戳将不会被设置，你会得到你所看到的约束错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:46:01.177

听起来您的迁移没有正确设置时间戳字段。这应该是这样的：

```
create_table :artists_users, :id => false do |t|
  t.references :artist
  t.references :user
  t.timestamps
end

create_table :artists_genres, :id => false do |t|
  t.references :artist
  t.references :genre
  t.timestamps
end 
```

# c# - 在 Windows 8 应用商店应用程序中使用命名空间读取 XML

> ID：13464303
> 
> 赞同：1
> 
> 时间：2012-11-19T23:32:22.060
> 
> 标签：c#, xml, windows-8, windows-runtime

我正在开发一个 WinRT 应用程序，我应该准备一些带有命名空间的 XML。现在这对旧的 .NET 没问题，但现在不再有 XmlDocument.NameTable。那么如何创建一个 XmlNamespaceManager？

```
var XmlDoc = new XmlDocument();

XmlDoc.Load(new FileStream("XMLFile1.xml",FileMode.Open,FileAccess.Read));
var nsm = new XmlNamespaceManager(XmlDoc.NameTable);
nsm.AddNamespace("s", "http://api.facebook.com/1.0/"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:36:49.390

*使用 LINQ to XML 处理命名空间要容易得多*，我相信您可以在 Windows 8 中使用它：

```
XDocument doc = XDocument.Load(...);
XNamespace ns = "http://api.facebook.com/1.0/";
XElement element = doc.Root.Element(ns + "foo"); 
```

阅读一篇好的 LINQ to XML 介绍或教程，您应该了解如何处理名称空间 - 但它确实比使用`XmlDocument`. 您根本不再需要命名空间管理器！（可能在*某些*情况下它们仍然有用 - 我不确定 - 但我当然不记得自己在 LINQ to XML 中使用过它们。）

# matlab - 如何在 Matlab 中绘制 3D 平面？

> ID：13464304
> 
> 赞同：22
> 
> 时间：2012-11-19T23:32:24.300
> 
> 标签：matlab, plot

我想使用从 3 个点计算得出的向量来绘制平面，其中：

```
pointA = [0,0,0];
pointB = [-10,-20,10];
pointC = [10,20,10];

plane1 = cross(pointA-pointB, pointA-pointC) 
```

如何在 3D 中绘制“plane1”？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-20T00:40:53.187

这是使用以下方法绘制平面的简单方法`fill3`：

```
points=[pointA' pointB' pointC']; % using the data given in the question
fill3(points(1,:),points(2,:),points(3,:),'r')
grid on
alpha(0.3) 
```

![在此处输入图像描述](../Images/9939e611a9ea9ff1928fc6409f7cbaa9.png)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-11-20T12:15:40.093

您已经计算了法线向量。现在你应该决定你的平面的限制是什么，`x`并`z`创建一个矩形补丁。

*解释*： 每个平面都可以用它的法向量`(A,B,C)`和另一个系数来表征`D`。平面方程为`AX+BY+CZ+D=0`。两个点之间的差异之间的叉积，`cross(P3-P1,P2-P1)`允许找到`(A,B,C)`. 为了找到`D`，只需将任意一点放入上述等式中：

```
 D = -Ax-By-Cz; 
```

一旦你有了平面的方程，你就可以在这个平面上取 4 个点，并在它们之间绘制补丁。

![在此处输入图像描述](../Images/a0ccfa255ee28627aa1cbbda1a2c7c5f.png)

```
normal = cross(pointA-pointB, pointA-pointC); %# Calculate plane normal
%# Transform points to x,y,z
x = [pointA(1) pointB(1) pointC(1)];  
y = [pointA(2) pointB(2) pointC(2)];
z = [pointA(3) pointB(3) pointC(3)];

%Find all coefficients of plane equation    
A = normal(1); B = normal(2); C = normal(3);
D = -dot(normal,pointA);
%Decide on a suitable showing range
xLim = [min(x) max(x)];
zLim = [min(z) max(z)];
[X,Z] = meshgrid(xLim,zLim);
Y = (A * X + C * Z + D)/ (-B);
reOrder = [1 2  4 3];
figure();patch(X(reOrder),Y(reOrder),Z(reOrder),'b');
grid on;
alpha(0.3); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-15T17:14:19.957

这是我想出的：

```
function [x, y, z] = plane_surf(normal, dist, size)

normal = normal / norm(normal);
center = normal * dist;

tangents = null(normal') * size;

res(1,1,:) = center + tangents * [-1;-1]; 
res(1,2,:) = center + tangents * [-1;1]; 
res(2,2,:) = center + tangents * [1;1]; 
res(2,1,:) = center + tangents * [1;-1];

x = squeeze(res(:,:,1));
y = squeeze(res(:,:,2));
z = squeeze(res(:,:,3));

end 
```

您将用作：

```
normal = cross(pointA-pointB, pointA-pointC);
dist = dot(normal, pointA)

[x, y, z] = plane_surf(normal, dist, 30);
surf(x, y, z); 
```

在相关平面上绘制边长为 60 的正方形

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-28T14:16:02.460

我想补充一下 Andrey Rubshtein 给出的答案，除了 B=0 之外，他的代码运行良好。这是他的代码的编辑版本

**下面的代码在 A 不为 0 时有效**

```
normal = cross(pointA-pointB, pointA-pointC); 
x = [pointA(1) pointB(1) pointC(1)];  
y = [pointA(2) pointB(2) pointC(2)];
z = [pointA(3) pointB(3) pointC(3)];  
A = normal(1); B = normal(2); C = normal(3);
D = -dot(normal,pointA);
zLim = [min(z) max(z)];
yLim = [min(y) max(y)];
[Y,Z] = meshgrid(yLim,zLim);
X = (C * Z + B * Y + D)/ (-A);
reOrder = [1 2  4 3];
figure();patch(X(reOrder),Y(reOrder),Z(reOrder),'r');
grid on;
alpha(0.3); 
```

**下面的代码在 C 不为 0 时有效**

```
normal = cross(pointA-pointB, pointA-pointC); 
x = [pointA(1) pointB(1) pointC(1)];  
y = [pointA(2) pointB(2) pointC(2)];
z = [pointA(3) pointB(3) pointC(3)];  
A = normal(1); B = normal(2); C = normal(3);
D = -dot(normal,pointA);
xLim = [min(x) max(x)];
yLim = [min(y) max(y)];
[Y,X] = meshgrid(yLim,xLim);
Z = (A * X + B * Y + D)/ (-C);
reOrder = [1 2  4 3];
figure();patch(X(reOrder),Y(reOrder),Z(reOrder),'r');
grid on;
alpha(0.3); 
```

# java - 使用 Huffman 树解码消息

> ID：13464305
> 
> 赞同：1
> 
> 时间：2012-11-19T23:32:26.177
> 
> 标签：java, huffman-code

当我发送一串要解码的位时，似乎需要一个额外的位才能正确解码。我已经预先打印出这棵树，我已经在纸上画了这棵树，以确保我没有遗漏任何东西。预购和我绘制的树匹配，但生成正确字母所需的位已关闭。

```
public void decode(String code){
    String result = "";
    TreeNode current = root;
    current.preOrder();
    for(int i = 0;i < code.length();i++){
        //left--0
        if(Character.getNumericValue(code.charAt(i))==0){
            if(current.getLeft() == null){
                result += current.getWeight().getLetter();
                current = root;
                i--;
            }else
                current=current.getLeft();
        }
        //right--1
        else if(Character.getNumericValue(code.charAt(i))==1){
            if(current.getRight() == null){
                result += current.getWeight().getLetter();
                current = root;
                i--;
            }else
                current=current.getRight();
        }
    }
    System.out.println(result);
} 
```

我的树每次都正确构建，这让我相信错误出在解码方法中。但是，我似乎无法弄清楚为什么它需要额外的位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:59:07.523

没有看到你的节点是如何布置的，我只能猜测。当向左/向右遍历时，您可能需要检查您是否已降落在叶节点上，如果是，则发出其字符。

```
if (current.getLeft() == null) {
    ...
}
else {
    current = current.getLeft();
    if (current.isLeaf()) {
        result += current.getWeight().getLetter();
        current = root;
    }
} 
```

右侧也是如此。

**不要重复自己**

为了避免重复附加字符的两行并将当前节点重置为根四次，您可以设置一个标志并在`for`块的末尾检查它。

```
boolean append = false;
if (Character.getNumericValue(code.charAt(i)) == 0) {
    if (current.getLeft() == null) {
        append = true;
        i--;
    }
    else {
        current = current.getLeft();
        if (current.isLeaf()) {
            append = true;
        }
    }
}
// same for right side ...
if (append) {
    result += current.getWeight().getLetter();
    current = root;
} 
```

**其他提示**

*   从两个`if`检查`0`或切换`1`到一个`switch`抛出`default`一个`IllegalArgumentException`.
*   `for`将循环切换到 a`while`以避免预先递减`i`只是让它再次递增并避免停止循环。
*   `append`从设置为开始，`true`因为六个案例中有四个附加。

# node.js - Node.js | 禁用nagle算法

> ID：13464310
> 
> 赞同：3
> 
> 时间：2012-11-19T23:32:43.167
> 
> 标签：node.js

我想测量通过 tcp 连接发送 x 数量的 pkts 和 n 字节所需的时间。唯一的问题是我的数据包正在合并。我知道 TCP 默认情况下会这样做，但我如何让它立即发送它们，甚至合并数据包。

客户：

```
var net = require('net');

var HOST = '127.0.0.1';
var PORT = 6969;
var number_packets = 2500;
var packet_size = 200;
var client = new net.Socket();

client.connect(PORT, HOST, function() {
    client.setNoDelay(true);
    for (var i = 0; i <= 100; i++) {
        var message = new Buffer(packet_size);
        console.log('Sending message #: '+i);
        client.write(message);
    }
});

client.on('data', function(data) {    
    console.log('DATA: ' + data);
    // Close the client socket completely
    client.destroy();
});

client.on('close', function() {
    console.log('Connection closed');
}); 
```

服务器：

```
var net = require('net');

var HOST = '127.0.0.1';
var PORT = 6969;
var count = 1;

net.createServer(function(sock) {
    sock.on('data', function(data) {
        var size = data.length;
        console.log('pkt: '+count+' size: '+size);
        //sock.write(data+'-');
        count++;
    });

    sock.on('close', function(data) {
        console.log('CLOSED: ' + sock.remoteAddress +' '+ sock.remotePort);
    });
}).listen(PORT, HOST);

//console.log('Server listening on ' + HOST +':'+ PORT); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T05:07:33.480

`setNoDelay`通过设置为 true ，您已经在代码中禁用了 Nagle 算法。你面临的问题是不同的。您面临的问题是 TCP 协议没有数据包的概念。

底层协议 IP 处理数据包。TCP 是在 IP 之上实现的更高级别的基于流的协议，它允许软件假装它正在读取和写入文件描述符。因此，隐含在 TCP 协议设计的意图中，它忽略了数据包边界并将所有消息合并到单个流中。

请注意，您的问题不仅在于合并小消息，还在于拆分大消息。它可能发生在传输端，可能发生在接收端，甚至可能发生在路由器和代理中。您实际上无法控制 TCP 消息在何处拆分和合并。

如果你想知道你的消息到底在哪里结束，你需要在 TCP 之上使用另一个协议。一个简单的例子是 HTTP：

HTTP 1.0 和更早的版本实现了一个非常简单的条件来表示数据包的结束：只需关闭连接。HTTP 1.0 数据包具有以下结构：

```
HTTP/version status (200 for OK) comment (human readable meaning of status code)
headers (note, commands and headers are separated by newlines (\n)) 
headers
headers
two newlines (\n) indicates end of headers:

data
data
data
connection closed indicating end of data 
```

HTTP 1.1 通过添加`Content-Length`标头改进了这一点。这允许 HTTP 1.1 每个连接发送多个“数据包”（html 文件、gif 图像等）。所以 HTTP 1.1 看起来像这样：

```
HTTP/version status comment
headers
Content-length: number of bytes in the data section
headers

data
data
end of data
HTTP/version status comment (beginning of second packet)
headers
Content-length: number of bytes in the data section
headers

data
data
end of data 
```

现在这是在 TCP 之上运行的最简单的协议之一。但是内容长度的概念来自更古老的协议。IP 本身有一个长度字段。以太网帧也是如此。您可以使用相同的想法为您的任务实现一个简单的协议：

```
[  len   ][  len   ][  data  ][  data  ][  data  ] ...
     \________/         \____________________/
         |                        |
         |                        |
         |                "length" bytes of data
         |
   two bytes indicating length of packet 
```

或者您也可以借鉴 HTTP 使用换行符作为分隔符的想法。这样做的好处是该协议更容易在 javascript 中处理，因为它主要是基于文本的：

```
data data data data data data\n
   \___________________/      |
             |                |
             |           end of packet
             |
  data section (must not contain newlines) 
```

如果数据必须包含换行符，那么您可以按照 JSON 中的处理方式处理它：发送“\”，后跟“n”（即实现“\n”转义序列）。请注意，您可以选择任何内容作为分隔符，它不必是换行符。

你甚至可以混合概念。这是我几年前开发的一个协议，它是基于文本的，但使用了二进制协议中的长度前缀思想：

```
12345;data data data data ...
  |  |
  |  |____ semicolon indicates start of data section
  |
  |
 length of data section sent as an ASCII string 
```

当然，最好的方法是使用其他人已经在 node.js 中发明和实现的协议。这样可以避免重新发明轮子。Node 甚至内置了 HTTP。虽然我知道为了您的目的，HTTP 在标头中增加了数百字节的开销，这很难解释。如果你想要一个低开销的协议，总会有 FTP。在 npm 上有几个实现。

# c# - 加载 EditorForModel/DisplayForModel 比在 TempData 中存储指标更好的方法？

> ID：13464312
> 
> 赞同：1
> 
> 时间：2012-11-19T23:32:49.437
> 
> 标签：c#, asp.net-mvc-3

我有一个想要加载视图的控制器。视图的模型有时应该处于编辑模式。因此，我有以下代码：

```
public ActionResult ExistingOrderDetails(int orderID, bool isEditMode)
{
    TempData["isEditMode"] = isEditMode;

    Order order = WorkflowManager.GetOrderByID(orderID);
    OrderDetailsModel orderDetailsModel = new OrderDetailsModel(order);
    return View("OrderDetails", orderDetailsModel);
} 
```

在 OrderDetails.ascx 中，我有以下内容：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<CableSolve.Web.Models.Orders.OrderDetailsModel>" %>

<%
if((bool)TempData["isEditMode"])
{
    %><%=Html.EditorForModel()%><%
}
else
{
    %><%=Html.DisplayForModel()%><%
}
%> 
```

这对我来说似乎有点骇人听闻。我是否应该将我的 OrderDetails.ascx 拆分为两个单独的 ViewModel，一个 EditableOrderDetails.ascx 和一个 ReadOnlyOrderDetails.ascx？只是好奇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:37:55.253

`TempData`在这种情况下可能最好避免。我会制作两个单独的视图并在操作中写入：

```
return View(isEditMode ? "OrderDetailsEdit" : "OrderDetailsDisplay", orderDetailsModel); 
```

# iphone - 如何按整数属性对 CoreData 对象数组进行排序？

> ID：13464316
> 
> 赞同：4
> 
> 时间：2012-11-19T23:33:18.137
> 
> 标签：iphone, objective-c, sorting, nsarray

我有一个 CoreData 对象数组，每个对象都是`Person`并且每个对象`Person`都有一个`age`Integer32 类型的属性。

我的数组充满了`Person`对象。我想按他们的`age`属性对我的数组进行排序。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T00:24:22.790

它应该很简单：

```
NSArray *sortDescriptors = @[
  [NSSortDescriptor sortDescriptorWithKey:@"age" ascending:YES]
];

NSArray *sortedPeople = [people sortedArrayUsingDescriptors:sortDescriptors];
NSLog(@"%@", sortedPeople); 
```

无论您在创建`NSManagedObject`子类时是否选择“对原始数据类型使用标量属性”（如果您决定创建它们） ，这都将起作用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:00:36.200

说“人”是您要排序的 Person 对象数组...

```
NSArray *sortedPeople = [people sortedArrayUsingComparator:^NSComparisonResult(Person *p1, Person *p2) {
    if (p1.age > p2.age) return NSOrderedDescending;
    else if (p1.age < p2.age) return NSOrderedAscending;
    else return NSOrderedSame;
} 
```

# php - CI DataMapper：查找没有相关对象

> ID：13464321
> 
> 赞同：0
> 
> 时间：2012-11-19T23:33:59.653
> 
> 标签：php, codeigniter, orm

我的 CodeIgniter/DataMapper 站点需要显示`categories`. 对于多个父母/孩子，每个`category`人都与自己有多对多的关系。我想最初只选择***没有 parents****的类别***，或者换句话说，没有通过指定关系连接的对象。**

 **我已经经历了几种可能性（比如在选择中包括相关的对象计数并将其添加到 where 子句中，这不起作用，因为在 SQL 中生成列值之前评估了 WHERE），但无济于事。

建议？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:35:46.007

找到解决方案：将相关对象 ID 与`NULL`. 如果它是一个整数自增列，实际上没有值是`NULL`，但如果连接中没有相关的行，它会输出为`NULL`。

```
$c = new Category();

$top_level_categories = $c
    ->where_related_parents('id IS NULL')
    ->get(); 
```**

# mysql - 使用外部列的唯一多列键

> ID：13464322
> 
> 赞同：2
> 
> 时间：2012-11-19T23:34:02.907
> 
> 标签：mysql, unique-constraint

假设我有以下表，它们实现了部件和对象之间的多对多关系，其中链接表具有唯一的密钥对 (object_id,part_id)，因此没有重复的行：

零件表：

```
part_id | 零件名 | 部分区域
--------+------------+----------  
0 | 部分1.0 | 最佳  
1 | 第 2 部分 | 底部  
2 | 第 1.1 部分 | 最佳
3 | 第 3 部分 | 最佳

```

对象表：

```
object_id | 对象名
---- ----+-----------
0 | 对象1
1 | 对象2
2 | 对象3
3 | 对象4

```

链接表：

```
object_id | part_id
------ --+---------
0 | 0
0 | 1
1 | 1
1 | 2

```

还有一个进一步的限制是，一个对象中的每个 part_zone 应该只有一个。因此，如果将 part_zone 列移动到链接表并将键更改为唯一对 (object_id,part_zone)，那么这将得到满足。但是我不想这样做，因为 part_zone 应该在零件表中。在我的脑海中，我希望保持表格原样，但使用 (object_id,part_zone) 唯一键，其中 part_zone 通过 part_id 上的连接从零件表中提取。

希望我的意图很明确，但我不太确定这是否一定是最好的实现，或者我正在使用正确的术语来表达我所追求的。

提前感谢任何可以提供任何见解的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:59:58.310

您可以在表中添加`part_zone`级联复合`Link`外键约束引用；这样，您可以按照建议定义一个约束，同时仍然能够从表中维护：`(part_zone, part_id)``Part``UNIQUE``(object_id, part_zone)``part_zone``Part`

```
ALTER TABLE Link ADD part_zone varchar(10);  -- should be same size as in Part
ALTER TABLE Part ADD INDEX (part_zone, part_id);

UPDATE Link JOIN Part USING (part_id) SET Link.part_zone = Part.part_zone;

ALTER TABLE Link
  ADD FOREIGN KEY (part_zone, part_id) REFERENCES Part (part_zone, part_id)
    ON UPDATE CASCADE,
  ADD UNIQUE INDEX (object_id, part_zone)
; 
```

您甚至可以定义触发器`INSERT`并`UPDATE`填充值，`Link`这样您就不需要手动执行它：

```
CREATE TRIGGER link_insert BEFORE INSERT ON Link FOR EACH ROW
  SET NEW.part_zone = (SELECT part_zone FROM Part WHERE part_id = NEW.part_id);

CREATE TRIGGER link_update BEFORE UPDATE ON Link FOR EACH ROW
  SET NEW.part_zone = (SELECT part_zone FROM Part WHERE part_id = NEW.part_id); 
```

# c++ - 静态地图初始化

> ID：13464325
> 
> 赞同：22
> 
> 时间：2012-11-19T23:34:14.060
> 
> 标签：c++, static, stdmap

我有以下代码：

```
//MyClass.h
class MyClass {
public:
    typedef std::map<std::string, int> OpMap;
    static OpMap opMap_;     
    // (more methods)
};

//MyClass.cpp
//Init opMap_
MyClass::opMap_["x"] = 1; //compilation error 
```

我怎样才能（静态）初始化`opMap_`？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-19T23:37:57.750

如果您使用的是 C++11，则可以使用初始化列表：

```
//MyClass.h
class MyClass {
public:
      typedef std::map<std::string, int> OpMap;
      static OpMap opMap_;
};

//MyClass.cpp
MyClass::OpMap MyClass::opMap_ = { 
    { "x", 1 }
}; 
```

如果您无权访问支持 C++11 标准的编译器，则可以执行以下操作：

```
//MyClass.h
class MyClass {
public:
      typedef std::map<std::string, int> OpMap;
      static OpMap opMap_;
private:
      static OpMap init_map() {
          OpMap some_map;
          some_map["x"] = 1;
          return some_map;
      }
};

//MyClass.cpp
MyClass::OpMap MyClass::opMap_ = init_map(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-19T23:42:47.090

当您使用 VS2010 时，您需要在 MyClass.cpp 中初始化您的静态成员，在任何其他成员函数定义之前。`MyClass::InitMap()`如果要初始化，请调用`opMap_`.

我的类.h

```
class MyClass
{
public:
  MyClass(void);
  ~MyClass(void);
public:
   typedef std::map<std::string, int> OpMap;
   static OpMap opMap_;    
   static void InitMap();
}; 
```

我的类.cpp

```
std::map<std::string, int> MyClass::opMap_;
MyClass::MyClass(void)
{
   InitMap(); // just sample if you want to initialize opMap_ inside MyClass constructor
}

void InitMap()
{
  MyClass::opMap_["x"] = 1;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-10-21T09:24:53.487

在 C++ 17 中，您可以添加内联

```
//MyClass.h
class MyClass {
public:
    typedef std::map<std::string, int> OpMap;
    inline static OpMap opMap_;     
    // (more methods)
}; 
```

# oop - 我应该如何命名一个唯一目的是程序的类？

> ID：13464327
> 
> 赞同：0
> 
> 时间：2012-11-19T23:34:22.080
> 
> 标签：oop, design-patterns, 3d, modeling

我在 OO 模式方面有很多东西要学习，这是我多年来遇到的一个问题。我最终会遇到我的课程的唯一目的是程序性的情况，基本上只是将一个程序包装在一个类中。这似乎不是正确的 OO 做事方式，我想知道是否有人对这个问题有足够的经验来帮助我以不同的方式考虑它。我在当前应用程序中的具体示例如下。

在我的应用程序中，我从工程测量设备中获取一组点并将它们标准化以在程序的其他地方使用。“规范化”是指整个数据集的一组转换，直到达到目标方向。

每个转换过程都将输入一个点数组（即形式为`class point { float x; float y; float z; }`）并返回一个长度相同但值不同的数组。例如，像`point[] RotateXY(point[] inList, float angle)`. 另一种过程是分析类型的，用于补充规范化过程并决定下一步要进行什么转换。这种类型的过程接受与参数相同的点，但返回不同类型的数据集。

我的问题是，在这种情况下使用什么好的模式？我要编写的代码是一个 Normalization 类，它继承了 RotationXY 的类类型。但是 RotationXY 的唯一目的是旋转点，所以它基本上是实现一个功能。但是，由于我在第一段中提到的原因，这似乎不太好。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T12:00:01.093

在您的问题域中查找候选类的最常见/最自然的方法是[查找名词](http://archive.eiffel.com/doc/manuals/technology/oosc/finding/page.html)，然后扫描与这些名词相关的动词/动作，以找到每个类应该实现的行为。虽然这通常是一个很好的建议，但这并不意味着您的对象只能代表具体元素。当流程（通常被建模为方法）开始增长并变得复杂时，最好将它们建模为对象。因此，如果您的转换本身具有权重，则可以将其建模为对象并执行以下操作：

```
class RotateXY
{
public function apply(point p)
{
//Apply the transformation
}
}

t = new RotateXY();
newPoint = t->apply(oldPoint); 
```

如果您有许多转换，您可以创建一个多态层次结构，甚至可以将一个转换一个接一个地链接起来。如果您想更深入地挖掘，您还可以查看与此密切相关的[命令设计模式。](http://www.oodesign.com/command-pattern.html)

最后的一些评论：

*   如果适合您的情况，最好在点级别对转换进行建模，然后将其应用于点集合。这样你就可以正确地隔离转换概念，也更容易编写测试用例。如果需要，您以后甚至可以创建转换[组合](http://www.oodesign.com/composite-pattern.html)。
*   我通常不喜欢`Utils`具有一堆静态方法的（或类似的）类，因为在大多数情况下，这意味着您的模型缺少应该承载该行为的抽象。

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:46:32.877

通常，当涉及到只包含静态方法的类时，我将它们命名为 Util，例如 DbUtil 用于外观 DB 访问，FileUtil 用于文件 I/O 等。因此，找到一个所有方法共有的术语并将其命名为 Util。也许在你的情况下 GeometryUtil 或类似的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:51:13.150

由于您应用的转换的细节似乎是针对问题的临时性的，并且将来可能容易更改，您可以将它们编码在配置文件中。

该点的客户端将从文件中读取并知道要做什么。至于旋转或任何其他变换方法，它们可以很好地作为 Point 类的一部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T23:52:01.333

我认为只有一个成员的类/接口没有什么特别的问题。

在您的情况下，该成员是“具有返回相同类型的一种类型的某些参数的操作”-对于某些数学/功能问题很常见。您可能会发现拥有将多个转换类组合在一起以形成更复杂的转换的接口/基类和辅助方法很方便。

替代方法：如果您的语言支持它只是完全采用功能样式（类似于 C# 中的 LINQ）。

关于功能风格建议：我从以下基本功能开始（可能只是在该语言的标准库中找到它们）

*   `collection = map(collection, perItemFunction)`转换集合中的所有项目（`Select`在 C# 中）
*   `item = reduce (collection, agregateFunction)`将所有项目减少为单个实体（`Aggregate`在 C# 中）
*   在 item 上结合 2 个功能`funcOnItem = combine(funcFirst, funcSecond)`。在 C# 中可以表示为 lambda `Func<T,T> combined = x => second(first(x))`。
*   “绑定”/[咖喱](http://en.wikipedia.org/wiki/Currying)- 修复函数的参数之一`functionOfOneArg = curry(funcOfArgs, fixedFirstArg)`。可以在 C# 中表示为 lambda `Func<T,T> curried = x => funcOfTwoArg(fixedFirstArg, x)`。

此列表将让您执行类似“将 X 轴上的集合中的所有点旋转 10 并将 Y 移动 15”之类的操作：`map(points, combine(curry(rotateX, 10), curry(shiftY(15)))`。

语法将取决于语言。即在 JavaScript 中，您只需传递函数（并且 map/reduce 已经是语言的一部分），C# - lambda 和`Func`类（如参数函数 - `Func<T,R>`）是一种选择。在某些语言中，您必须明确使用类/接口来表示“函数”对象。

替代方法：如果您实际处理点和转换，另一种传统方法是使用 Matrix 表示所有线性运算（如果您的语言支持自定义运算符，您将获得看起来非常自然的代码）。

# google-apps-script - 我可以在另一个服务器处理程序中更改处理程序回调函数吗

> ID：13464328
> 
> 赞同：0
> 
> 时间：2012-11-19T23:34:30.303
> 
> 标签：google-apps-script

我想在另一个服务器处理程序中更改回调函数。我收到响应“无法在对象 Generic 中找到函数 setCallbackFunction。” 由于 app.getElementById('treeHandler').setCallbackFunction('noSelection'); 而处理程序在主线中定义为 var handler = app.createServerHandler('nameSelected').setId('treeHandler'); 所以看起来我们无法在服务器处理程序中获取 ServerHandler 类型的元素。

这是预期的行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:35:58.590

那是对的; 您无法将它们取回并对其进行任何处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T22:50:21.680

这并不完全正确，您可以向应用程序添加隐藏元素。只需通过使用 createHidden 而不是 createTextBox 来采用下面的 axmaple。

```
function doGet() {
   var app = UiApp.createApplication();
   var textBox1 = app.createTextBox().setName("textBox1");
   var textBox2 = app.createTextBox().setId("textBox2");
   app.add(textBox1);
   app.add(textBox2);
   var textBox3 = app.createTextBox().setName("textBox3");
   var panel = app.createFlowPanel();
   panel.add(textBox3);
   app.add(panel);
   var button = app.createButton("a button");
   var handler = app.createServerHandler("handlerFunction");
   handler.addCallbackElement(textBox1)
       .addCallbackElement(textBox2)
       .addCallbackElement(panel)
   button.addClickHandler(handler);
   app.add(button);
   return app;
 }

 function handlerFunction(eventInfo) {
   var parameter = eventInfo.parameter;
   // There's a lot of information in 'parameter' about the event too, but we'll focus here
   // only on the callback elements.
   var textBox1 = parameter.textBox1;  // the value of textBox1
   var textBox2 = parameter.textBox2;  // undefined! setId is not the same as setName
   var textBox3 = parameter.textBox3;  // works! the parent "panel" was a callback element
 } 
```

来源：[https ://developers.google.com/apps-script/class_serverhandler#addCallbackElement](https://developers.google.com/apps-script/class_serverhandler#addCallbackElement)

# .htaccess - 我是否必须为每个页面单独指定缓存标头？

> ID：13464329
> 
> 赞同：0
> 
> 时间：2012-11-19T23:34:33.263
> 
> 标签：.htaccess, caching

这是我指定缓存过期的代码：

```
# Expires
ExpiresActive On
ExpiresDefault "access plus 1 year"
Header unset Last-Modified
Header set Cache-Control "public"

<FilesMatch "\.(pl|php|cgi|spl|scgi|fcgi|html?)$">
Header set Cache-Control "private, must-revalidate, proxy-revalidate"
ExpiresDefault A0
ExpiresActive Off
</FilesMatch> 
```

-我在 mediatemple 上运行 APACHE。- 我是否必须在每个目录中包含一个带有此代码的 .htaccess 文件，或者有没有办法让它适用于整个站点？

# php - 对数组进行排序 - 总是在顶部有一个项目？

> ID：13464330
> 
> 赞同：0
> 
> 时间：2012-11-19T23:34:37.317
> 
> 标签：php, arrays

我有一个这样的数组：

```
$sub = array(
   'add' => 'Add New',
   'default' => 'Home Page',
   'remove' => 'Remove Old'
); 
```

这是在其他地方建造的，但它是按字母顺序进行的。无论如何可以轻松地对此进行排序，因此默认值始终位于首位？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:40:24.890

我不认为你是在排序之后

```
$sub = array(
   'add' => 'Add New',
   'default' => 'Home Page',
   'remove' => 'Remove Old'
);
$default = array('default' => $sub['default']);

unset($sub['default']);
$sub = $default + $sub;
print_r($sub); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T23:48:09.783

试试这个

```
$sub = array(
   'add' => 'Add New',
   'default' => 'Home Page',
   'remove' => 'Remove Old'
);

function defaultSort($a, $b){
    if ($a == $b) {
        return 0;
    }
    return ($a == 'default') ? -1 : 1;
}

uksort($sub, 'defaultSort');

var_dump($sub); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-19T23:40:02.700

删除它然后重新添加

```
$v = $sub['default'];
unset($sub['default']);
$sub['default'] = $v; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-19T23:40:37.760

```
$default = $sub['default'];
unset($sub['default']);
$sub = array_reverse($sub);
$sub['default'] = $default;
$sub = array_reverse($sub); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-19T23:38:23.903

[uksort](http://php.net/manual/en/function.uksort.php)应该是你所追求的

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-19T23:49:14.963

你不需要排序 - 它已经排序。只需移动您想要的元素。

```
$tmp = array('default' => $sub['default']) ;
unset( $sub['default']) ;
array_unshift($sub, $tmp); 
```

# emacs - localrepo 在我尝试使用它时抛出“Could not locate ...”错误

> ID：13464335
> 
> 赞同：0
> 
> 时间：2012-11-19T23:34:52.547
> 
> 标签：emacs, clojure, leiningen

我在 ubuntu 机器上使用 lein 1.7.1。我已经添加`localrepo`到 `:dev-dependencies [[lein-localrepo "0.3"]]` 我的 project.clj 文件中。`lein deps`运行良好，但使用`localrepo`like in`lein localrepo coords example.jar`会给我一个讨厌的错误：

```
Exception in thread "main" java.io.FileNotFoundException: Could not locate leiningen/core/main__init.class or leiningen/core/main.clj on classpath:  (localrepo.clj:1)
at clojure.lang.Compiler.eval(Compiler.java:5441)
at clojure.lang.Compiler.eval(Compiler.java:5416)
at clojure.lang.Compiler.load(Compiler.java:5858)
at clojure.lang.RT.loadResourceScript(RT.java:340)
at clojure.lang.RT.loadResourceScript(RT.java:331)
at clojure.lang.RT.load(RT.java:409)
at clojure.lang.RT.load(RT.java:381)
at clojure.core$load$fn__4519.invoke(core.clj:4915)
at clojure.core$load.doInvoke(core.clj:4914)
at clojure.lang.RestFn.invoke(RestFn.java:408)
at clojure.core$load_one.invoke(core.clj:4729)
at clojure.core$load_lib.doInvoke(core.clj:4766)
at clojure.lang.RestFn.applyTo(RestFn.java:142)
at clojure.core$apply.invoke(core.clj:542)
at clojure.core$load_libs.doInvoke(core.clj:4800)
at clojure.lang.RestFn.applyTo(RestFn.java:137)
at clojure.core$apply.invoke(core.clj:542)
at clojure.core$require.doInvoke(core.clj:4881)
at clojure.lang.RestFn.invoke(RestFn.java:408)
at leiningen.core$resolve_task.invoke(core.clj:208)
at leiningen.core$apply_task.invoke(core.clj:258)
at leiningen.core$_main.doInvoke(core.clj:329)
at clojure.lang.RestFn.applyTo(RestFn.java:139)
at clojure.core$apply.invoke(core.clj:542)
at leiningen.core$_main.invoke(core.clj:332)
at user$eval42.invoke(NO_SOURCE_FILE:1)
at clojure.lang.Compiler.eval(Compiler.java:5425)
at clojure.lang.Compiler.eval(Compiler.java:5392)
at clojure.core$eval.invoke(core.clj:2382)
at clojure.main$eval_opt.invoke(main.clj:235)
at clojure.main$initialize.invoke(main.clj:254)
at clojure.main$script_opt.invoke(main.clj:270)
at clojure.main$main.doInvoke(main.clj:354)
at clojure.lang.RestFn.invoke(RestFn.java:512)
at clojure.lang.Var.invoke(Var.java:385)
at clojure.lang.AFn.applyToHelper(AFn.java:185)
at clojure.lang.Var.applyTo(Var.java:482)
at clojure.main.main(main.java:37)
Caused by: java.io.FileNotFoundException: Could not locate leiningen/core/main__init.class or leiningen/core/main.clj on classpath: 
at clojure.lang.RT.load(RT.java:412)
at clojure.lang.RT.load(RT.java:381)
at clojure.core$load$fn__4519.invoke(core.clj:4915)
at clojure.core$load.doInvoke(core.clj:4914)
at clojure.lang.RestFn.invoke(RestFn.java:408)
at clojure.core$load_one.invoke(core.clj:4729)
at clojure.core$load_lib.doInvoke(core.clj:4766)
at clojure.lang.RestFn.applyTo(RestFn.java:142)
at clojure.core$apply.invoke(core.clj:542)
at clojure.core$load_libs.doInvoke(core.clj:4800)
at clojure.lang.RestFn.applyTo(RestFn.java:137)
at clojure.core$apply.invoke(core.clj:542)
at clojure.core$require.doInvoke(core.clj:4881)
at clojure.lang.RestFn.invoke(RestFn.java:551)
at leiningen.localrepo$eval68$loading__4414__auto____69.invoke(localrepo.clj:1)
at leiningen.localrepo$eval68.invoke(localrepo.clj:1)
at clojure.lang.Compiler.eval(Compiler.java:5425)
... 37 more 
```

我在网上搜索了这个错误，但找不到任何参考或任何可行的解决方案。如何解决此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T10:13:13.783

我不相信您使用的是 lein-localrepo 插件的 0.3 版。我怀疑正在获取更新的版本。版本 0.3[没有引用](https://github.com/kumarshantanu/lein-localrepo/blob/v0.3/src/leiningen/localrepo.clj)，`leiningen.core.main`而[0.4 或更高](https://github.com/kumarshantanu/lein-localrepo/blob/master/src/leiningen/localrepo.clj#L3)版本则引用. 如果您设法安装了正确的插件，我敢打赌它会正常工作。

# objective-c - 如何创建可拖动的蒙版？

> ID：13464337
> 
> 赞同：3
> 
> 时间：2012-11-19T23:34:57.580
> 
> 标签：objective-c, ios, xcode

假设我有一个 UIView 和一个图像蒙版。我们必须能够拖动遮罩，以便每次用户拖动它时它的位置都会更新。我知道如何屏蔽图像，我也知道如何拖动图像，但我无法将两者结合起来。谁能给我看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T14:29:04.167

您是否考虑过使用容器 uiview 来保存您的其他 uiview、蒙版和图像？然后用户只需拖动容器。

# r - 如何使用ggplot围绕一条线绘制阴影区域

> ID：13464353
> 
> 赞同：0
> 
> 时间：2012-11-19T23:37:09.313
> 
> 标签：r, ggplot2

我希望使用 ggplot 围绕一条线绘制一个阴影区域。这两个数据集没有直接关系，我正在对两者进行一些比较。基本上，我希望绘制下面代码产生的输出，以及在变量“lower_region_values”和“upper_region_values”中输入的具有最小和最大y轴值的阴影区域。

请帮我解决这个问题。

可重现的代码从这里开始

```
library("ggplot2")
plotName <- 'Comparison of latitudinal averages'

xlims <- c(65,80) # x axis extent

input_df <- structure(list(flux = c(0.08733913, 0.1015934, 
      0.1244135, 0.1390303,0.08417182,   0.02371609), 
      model = structure(c(1L, 1L, 1L,1L, 1L, 1L),.Label = 
      c("CASA_GFED_Optimized"),  class = "factor"), lat = 
      c(79, 77, 75, 73, 71, 69)), .Names = c("flux","model",  
      "lat"),row.names = c(NA, -6L), class = "data.frame")

 lower_region_values<-c(-0.002157493,-0.004465291,-0.376925852,
     -0.312737571,-0.327533801,  -0.299551351)

 upper_region_values<-c(1.943331e-06,1.758454e-04,3.183347e-01,
      2.442368e-01,1.206353e-  01,1.572531e-02)

 sd_input_lower$model <- factor(sd_input_lower$model, 
      levels=levels(input_df$model))
 sd_input_upper$model <- factor(sd_input_upper$model, 
      levels=levels(input_df$model)) 
```

需要使用两个向量中的值的阴影区域：lower_region_values 和 upper_region_values

```
 chart <- ggplot(input_df, aes(x=lat, group=model, 
      colour=model, fill=model)) +

# geom_ribbon(data = sd_input_upper, aes(ymin = -sd, ymax=sd), alpha=0.5) +

 geom_line(aes(y=flux), size=1.0) + 
      opts(title=plotName,legend.position='bottom') +
      scale_x_continuous('Latitude',limits=xlims) +   
      scale_y_continuous(expression(paste('Latitudinal average of NEE ', 
      (g~C~m^{-2}/day)))) +
      scale_colour_discrete(name='Model') +
      scale_fill_discrete(name='Model')

 print(chart) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:09:01.543

我会将用于着色的区域添加到同一个 data.frame 中，因为如果它们都在同一个对象中，那么做 ggplots 会更容易。我的结果图对我来说看起来有点有趣，所以我认为我们需要确保当我们添加这些区域时，它们在它们的行中正确匹配 x 轴值。

```
input_df$lower_region_values<-c(-0.002157493,-0.004465291,-0.376925852,
     -0.312737571,-0.327533801,  -0.299551351)

input_df$upper_region_values<-c(1.943331e-06,1.758454e-04,3.183347e-01,
      2.442368e-01,1.206353e-01,1.572531e-02) 
```

如果我正确理解了您的目标，我基本上会做您正在做的事情，但是将 aes() 稍微移动一下：

```
chart<-
      ggplot(input_df, aes(x=lat, y=flux,group=model)) +
      geom_line(size=1.0,colour="red") + 
      opts(title=plotName,legend.position='bottom') +
      scale_x_continuous('Latitude',limits=xlims) +   
      scale_y_continuous(expression(paste('Latitudinal average of NEE ', 
      (g~C~m^{-2}/day)))) +
      geom_ribbon(aes(ymin = lower_region_values, 
      ymax=upper_region_values), colour="blue", fill="blue",alpha=0.5)

 print(chart) 
```

您似乎使用的是旧版本的 ggplot2，所以如果您仍在学习 ggplot，我会更新并学习新版本，它有一些重大变化。

# extjs - 如何正确取消商店过滤请求

> ID：13464358
> 
> 赞同：3
> 
> 时间：2012-11-19T23:37:31.160
> 
> 标签：extjs, combobox, extjs4

我有一个具有以下配置的组合框（extjs4.1.2）：

```
 xtype:'combo',         
  store: 'MyItems',
  queryParam:'itemNumber',
  displayField:'itemNumber',
  hideTrigger:true,
  typeAhead:true,
  minChars:7,
  lastQuery: '',
  queryDelay:500 
```

一切都按预期工作，并且 store 在第 7 个字符上触发远程查询。但是，如果用户继续输入第 8 个字符，则会触发另一个查询。第二个查询比第一个返回更快，然后第一个查询返回并弄乱下拉。有没有办法在运行后续查询时取消第一个查询？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T03:58:26.510

您可以使用`Ext.Ajax.abort()`或`Ext.Ajax.abortAll()`（ExtJS 4）。请参阅 API 文档：[http ://docs.sencha.com/ext-js/4-1/#!/api/Ext.Ajax](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.Ajax)

您可以通过拦截`onTypeAhead`组合框的功能来使用它：

```
comboObj.onTypeAhead = Ext.Function.createInterceptor(comboObj.onTypeAhead, function() {
    Ext.Ajax.abort(); //aborts the last Ajax request
    return true; //runs the onTypeAhead function
}); 
```

或者您可以使用该`autoAbort`属性，`Ext.data.Connection`但没有太多关于此的文档。我将尝试为您提供一个可行的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T00:36:26.293

这是我结束做的事情：

```
listeners:{
  beforequery:function(queryEvent){
    Ext.Ajax.abortAll(); //cancel any previous requests
    return true;
  }
} 
```

# javascript - 根据单元格内容获取 ID

> ID：13464359
> 
> 赞同：0
> 
> 时间：2012-11-19T23:37:41.090
> 
> 标签：javascript, jquery, html

我正在尝试根据单元格的内容获取行的 ID。

```
$("tr td:contains(+data.id+)").parent().attr('id')); 
```

data.id 是来自 json 的响应，如果我控制台日志`data.id`它有一个值。如果我在 chrome 控制台中使用此代码并手动输入`data.id`诸如 ..

```
alert($("tr td:contains(1717)").parent().attr('id'))); 
```

我得到了正确的响应，但在运行时结果未定义。为什么是这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:38:57.233

将字符串连接在一起：

```
$("tr td:contains(" + data.id + ")").parent().attr('id')); 
```

`"tr td:contains(+data.id+)"`从字面上看，javascript 不会自动找到`+`并替换`data.id`.

# linux - Lazarus Indy SSL IdHTTP

> ID：13464361
> 
> 赞同：0
> 
> 时间：2012-11-19T23:37:53.507
> 
> 标签：linux, ubuntu, openssl, indy, lazarus

我正在尝试让 Indy 使用安装在 Ubuntu 11 上的 Lazarus 中的 SSL 和 IdHTTP 组件。我知道我的代码适用于 http 帖子，因为如果我删除 https 并将其保留为只有 http 它可以工作。所以我认为这是 SSL 和 indy 的组件缺少 Linux 库。对于windows，我习惯于只包含两个DLL，`libeay32.dll`并且`ssleay32.dll`效果很好。

但在 linux 中，这似乎是另一回事。我唯一的代码是邮政编码：

```
IdHttp1.Post('url', StringList, ReturnStreamList); 
```

就像我说的它在没有 https 的情况下工作得很好，但是当我尝试 SSL 时什么都没有发生。没有错误，因为我有`try`并且`except`可以捕捉，但我没有对捕捉做任何事情。

我确实安装了 OpenSSL，我还通过以下方式安装了以下内容`apt`：

```
libcrypto++8
libcrypto++-dev
libssl-dev
libssl0.9.8 
```

我去了`/usr/lib`两个文件`libcrypto.so`，`libssl.so`都在那里。

有什么想法可以让 SSL 与 Lazarus 和 Indy 一起用于 IdHTTP 后期操作吗？

编辑：好的，在遵循以下建议后，我添加了异常：

```
on E: EIdHTTPProtocolException do
       showmessage(htp1.ResponseText); 
```

这给了我错误`Error creating SSL context`。

EDIT2：我运行了一个 strace，并在此处粘贴了打开 SSL 库的输出区域：http: [//pastebin.com/fL6tTSGg](http://pastebin.com/fL6tTSGg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T13:44:40.187

这太容易了，它让我失望了！哈哈

似乎我对 SSL 使用了错误的方法。我必须设置`TidSSLioHandlerSocketOpenSSL.SSLOptions.Method`为`sslvSSLv23`，它是开着的`sslvSSLv2`。

现在一切正常:)

# c++ - IP 地址重叠/在 CIDR 范围内

> ID：13464364
> 
> 赞同：0
> 
> 时间：2012-11-19T23:37:59.387
> 
> 标签：c++, c, network-programming, ip

我有一个无符号长格式的 IP 地址，用 C++ 编码 我有一个 CIDR 表示法 IP 地址范围，例如“10.2.3.98/24”

如何检查我的 IP 地址是否与上述范围重叠？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T03:25:24.603

为了尽可能简单，斜线后面的部分基本上是要保留的位。因此，例如 /24 表示保留最重要的 3 个字节（24 位）。因此，您可以通过屏蔽地址并检查是否相等来查看地址是否合适。地址和掩码本身就是最小值；如果您正在寻找最大值，则可以或使用掩码的反面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T06:32:15.410

如果您已经知道 IP 地址为无符号长整数和数字，这应该可以工作：

```
bool cidr_overlap(uint32_t ip1, int n1,
                  uint32_t ip2, int n2)
{
    return (ip1 <= (ip2 | ((1ul << (32-n2))-1)))
        || (ip2 <= (ip1 | ((1ul << (32-n1))-1)));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-05T05:00:59.607

让我们假设您的 IP 地址和掩码如下，并且 IP 地址是整数形式。

示例 3232235896/30 ==>（实际 IP 192.168.1.120/30）

假设您需要找出 (ip_one , mask_one) 和 (ip_two , mask_two) 的重叠

```
uint32_t mask_one_max = ((1ul << (32 - mask_one)) - 1);
uint32_t mask_one_min = ~mask_one_max;

uint32_t mask_two_max = ((1ul << (32 - mask_two)) - 1);
uint32_t mask_two_min = ~mask_two_max;

return (((ip_one & mask_one_min) <= (ip_two | mask_two_max)) && ((ip_two & mask_two_min) <= (ip_one | mask_one_max))); 
```

如果发生重叠，这将返回 true。

该解决方案是基于查找两个整数范围重叠的通用方法提出的。正如您在解决方案中看到的那样，我首先将 CIDR 范围转换为整数范围并使用它们来查找重叠。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-18T10:00:30.913

此函数检查两个网络是否重叠。

```
#include <arpa/inet.h>
#include <netinet/in.h>

static inline bool cidr_overlap(struct in_addr ip1, int n1, 
                                struct in_addr ip2, int n2)
{
    uint32_t mask1 = ~(((uint32_t)1 << (32 - n1)) - 1);
    uint32_t mask2 = ~(((uint32_t)1 << (32 - n2)) - 1);

    return (htonl(ip1.s_addr) & mask1 & mask2) == 
           (htonl(ip2.s_addr) & mask1 & mask2);
} 
```

# c# - 从单个嵌套的 XElement 中检索值的正确方法是什么？

> ID：13464368
> 
> 赞同：2
> 
> 时间：2012-11-19T23:38:28.630
> 
> 标签：c#, winforms, linq-to-xml, xelement

要检索嵌套 XElement 的值，我的代码中有以下内容：

```
XElement xml = new XElement("UserDefinedSettings", new XElement("RootFolder", new XElement("FolderName", "User Input Goes Here")));

xml.Save("UserDefinedSettings.xml"); 
```

这让我把它保存到了硬盘上：

```
<?xml version="1.0" encoding="utf-8"?>
<UserDefinedSettings>
  <RootFolder>
    <FolderName>User Input Goes Here</FolderName>
  </RootFolder>
</UserDefinedSettings> 
```

稍后，要检索用户选择的文件夹的名称，我正在使用：

```
XDocument xdoc = XDocument.Load("UserDefinedSettings.xml");

var myVar = xdoc.Descendants("FolderName").Single();

textBox1.Text = myVar.Value; 
```

我是 Linq-XML 的新手，我想知道我所做的是否是正确的方法？

最初我一直在使用以下代码行来获取文件夹的名称，但我知道必须有更好的方法，并且在 SO 上搜索示例后，我改用上面的代码。

```
string s =xdoc.Element("UserDefinedSettings").Element("RootFolder").Element("FolderName").Value; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:44:24.550

只要您确定这些元素存在，您所拥有的就应该没问题（较新的方式）。但是，如果它们中的任何一个不存在，它就有抛出空引用异常的风险。我通常使用 Elements() 而不是 Element() 进行查询。Elements() 返回一个 IEnumerable，您可以安全地将其与更多 Elements() 查询（或其他）链接在一起。例如，您可能会考虑：

```
var folder = (string)xdoc.Elements("UserDefinedSettings").Elements("RootFolder").Elements("FolderName").FirstOrDefault(); 
```

当我想要一个属性或元素的值时，我通常会做的另一件事是像上面那样用字符串转换我的 XElements 和 XAttributes。转换为字符串的空值将返回空字符串，从而防止您在调用 .Value 时遇到空引用异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T00:08:54.163

也可以工作：

`xdoc.XPathSelectElement("/UserDefinedSettings/RootFolder/FolderName").Value`

我更喜欢使用 XPath，因为它简洁，但它是您的选择。

# python - 两个 Amazon S3 Python Boto 上传问题

> ID：13464371
> 
> 赞同：4
> 
> 时间：2012-11-19T23:38:38.553
> 
> 标签：python, amazon-s3, boto

我目前正在使用此代码：

```
#!/usr/bin/env python

import boto
import boto.s3
from boto.s3.key import Key

AWS_ACCESS_KEY_ID = ''
AWS_SECRET_ACCESS_KEY = ''

filename = 'test.zip'    
bucket_name = AWS_ACCESS_KEY_ID.lower() + '-mah-bucket'
conn = boto.connect_s3(AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY)

bucket = conn.create_bucket(bucket_name, location=boto.s3.connection.Location.DEFAULT)

k = Key(bucket)
k.key = 'my test file'
k.set_contents_from_filename(filename) 
```

我有两个问题。首先，我相信这段代码会创建一个存储桶并进行上传。事情是我不想创建一个桶，因为我已经有了一个。为了做到这一点，我只需将其更改为：

```
k = Key(bucket_name) 
```

并摆脱这个：

```
bucket = conn.create_bucket(bucket_name, location=boto.s3.connection.Location.DEFAULT) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T23:44:23.240

实际上，而不是 conn.create_bucket(...)，只需执行以下操作：

```
bucket = conn.get_bucket(bucket_name)
k = Key(bucket) 
```

另外，我可能应该指出，根据 AWS_ACCESS_KEY_ID 命名您的存储桶对我来说似乎很愚蠢，因为这并不是真正需要的。

# actionscript-3 - 在 Web 浏览器上测试时，.fla 文件中的 stage==null

> ID：13464372
> 
> 赞同：1
> 
> 时间：2012-11-19T23:38:40.457
> 
> 标签：actionscript-3, flash

我在使用 Flash 时遇到了一个可怕的问题，昨晚开始发生这种情况，如果我在 Flash CS5.5 中创建一个文件并在第一帧中添加此代码：

跟踪（阶段）；

当我在 Flash IDE 中对其进行测试时，它会跟踪到：[object Stage]

但是当我在网络浏览器中运行相同的 swf 文件时，它会跟踪到：null

它似乎从未将应用程序添加到舞台上，为什么会这样？我以前从来没有发生过，我是唯一的人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:58:34.643

```
addEventListener(Event.ADDED_TO_STAGE, onAddToStage);
private function onAddToStage(e:Event){
    trace(stage);
} 
```

如果从不调用跟踪，您的浏览器是什么，您的 Flash 播放器版本是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-04T19:33:50.313

自从我检查了这篇文章以来已经有一段时间了。只是为了回答这个问题，这只是一个在以后的版本中得到修复的播放器错误。

# sdk - Monodevelop 中的“在指定位置找不到 SDK”错误

> ID：13464378
> 
> 赞同：1
> 
> 时间：2012-11-19T23:39:05.517
> 
> 标签：sdk, xamarin.ios, monodevelop

我安装了 Mac OS X 版本 10.8.2。

之后，我要么先安装 Monodevelop，要么先安装 XCode。但是当我收到此错误时，我将两者都删除了。然后，安装 XCode 4.5.2，然后再次安装 MonoDevelop，但它使用的是较旧的 SDK。

所以我`iPhoneOS6.0.sdk`从

```
 Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/ 
```

文件夹并将其放入我机器上的单独文件夹中

```
 /SDKs/ 
```

然后我在 MonoDevelop 中设置路径以使用 /SDKs 文件夹中的 SDK。但我仍然收到此错误-

```
"No SDK found at specified location" 
```

这非常令人沮丧。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:22:53.607

这些都不应该是必需的。MonoDevelop 应该会自动找到 SDK。

*   尝试将 SDK 位置留空，这样 MD 会说“使用默认位置”。
*   如果你想将它指向一个特定的 SDK，让它指向 Xcode.app 文件。应用程序文件只不过是一个文件夹。MonoDevelop 会在其中找到 SDK。不需要复制任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:25:43.587

首先不要**复制**文件/目录。主要是因为这**不是**必需的，还因为您可能会破坏您的安装并难以诊断错误。

MonoDevelop 的 Apple SDK 位置（在首选项中）必须指向`Xcode.app`，默认情况下是`/Applications/Xcode.app`（如果未指定，MonoDevelop 将在该位置查找）。

您可以将它指向其他地方，例如，`/Volumes/Xcode/XcodeXX-DPX.app`如果您想使用特定版本的 Xcode 安装磁盘映像。

笔记：

*   当 MonoDevelop 找到它正在寻找的内容时，您将获得一个绿色复选标记（因此您知道它已正确配置）；

*   您可能必须先运行 Xcode，以便安装它的命令行工具和设备支持库。没有它们，构建/安装可能会失败（但错误消息与您提到的不同）

# c - C使用字符串获取输入，并将其中的一部分转换为整数

> ID：13464380
> 
> 赞同：0
> 
> 时间：2012-11-19T23:39:11.920
> 
> 标签：c, string, int, atoi

所以我正在用这段代码做标题所说的

```
else if(input[0] == 'i'){
        printf("This works");
        if(isspace(input[1])){
            x = 2;
            while(input[x] != '\0'){
                tempS[x - 2] = input[x];
            }
            inp = atoi(tempS);
            for(x = x-2; x >= 0; x--){
                tempS[x] == NULL;
            }
            insert(&linkedList, inp);
            printf("%i %s %c", inp, " sucessfully inserted.", '\n');
        }
    } 
```

您可以忽略插入，基本上我得到的用户输入应该是 i 和一些数字。

例如：我 27

然后程序应该在 else if 中识别出它是 i，并取 i 后面的数字。

变量初始化如下。

```
char *input;
int inp = 0;
int x = 0;
char *tempS[255]; 
```

提前致谢。

编辑：问题是我什至在 printf 之前就遇到了分段错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:55:38.410

while 循环的问题：它永远不会结束，因为它不会增加 x。它不会复制`'\0'`，因此`atoi`可能会崩溃。`input`是 char 数组，但是`tempS`是 char 指针数组。

我不会立即看到崩溃的原因，除非`input[2]`实际上是`'\0'`并且 while 循环结束，在这种情况下`atoi`，当你给它无意义的指针数组而不是字符串时，它就是崩溃的原因。考虑到您显示的此代码的损坏程度，崩溃可能出现在您未显示的代码中...

在打开警告后，首先修复编译器警告。要打开它们，您需要编译器的 comppand 行开关，因为 gcc 只是`-W`一个好的开始......虽然真正的男人至少可以编译`-W -Wall -pedantic -std=c11`（替换`c11`为您想要使用的任何 C 标准版本）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:46:19.767

你陷入了一个无限循环。

```
 while(input[x] != '\0')
 {
          tempS[x - 2] = input[x];
 } 
```

添加指令`x++;`这样你就可以读取数组输入中的下一个元素，否则，你会卡在 x = 2 的位置。

这个`char *input`；它只是一个指针，您必须像当前使用的那样分配内存才能使用它。请执行下列操作：

```
input = malloc(sizeof(char) * N); 
```

N 是您希望在输入数组中包含的元素数。

你得到`segmentation fault`是因为你试图访问以前没有分配的内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:46:32.853

您必须使用 malloc 为输入指针分配内存（保留内存）。就像是：

```
char *input = malloc( sizeof(char) * 128 ); //If you needs 128 positions 
```

看一看：

```
//  *---*---*---*---*------*
//  | i |   | 2 | 1 | \'0' |
//  *---*---*---*---*------*
//            ^----- You stay here.

while(input[x] != '\0'){
    tempS[x - 2] = input[x];
} 
```

你声明`x = 2`了 ，所以你从第三个位置开始 char '2' （Char 因为你输入它作为一个字符串），它不是空终止符 '\0' 所以 while 循环将`tempS[x - 2] = input[x];`永远执行内部语句。所以要解决这个问题，你应该添加一个 x 修改类型：

```
while(input[x] != '\0'){
    tempS[x - 2] = input[x];
    x++;
} 
```

# c++ - 提升属性 write_json 不正确的行为

> ID：13464383
> 
> 赞同：4
> 
> 时间：2012-11-19T23:39:24.310
> 
> 标签：c++, json, boost, boost-propertytree

我正在为 Boost 属性树编写一个 JSON 包装器。目前的重点是将生成的 JSON 写入字符串或文件。

使用 boost::property_tree::json_parser::write_json(ss, *pt) 将生成的属性树写入字符串。

但是这个方法不明白什么是真、假、空或数字。一切都转换为字符串。

阅读 Boost 文档，这是该库的一个限制。有没有办法修改这种行为？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-20T14:39:56.503

[链接](https://stackoverflow.com/questions/2855741/why-boost-property-tree-write-json-saves-everything-as-string-is-it-possible-to)在此链接中是解决问题的方法。

它涉及更改 boost 代码，因此我尝试了另一种选择。我的解决方案涉及正则表达式：

```
std::string JSONObject::toString() const
{
    boost::regex exp("\"(null|true|false|[0-9]+(\\.[0-9]+)?)\"");
    std::stringstream ss;
    boost::property_tree::json_parser::write_json(ss, *pt);
    std::string rv = boost::regex_replace(ss.str(), exp, "$1");

    return rv;
} 
```

基本上我会搜索关键字：true、false、null 和任何类型的数字。匹配项被替换为不带引号的相同内容。

# jquery - jquery加载元素属性href

> ID：13464386
> 
> 赞同：0
> 
> 时间：2012-11-19T23:39:56.683
> 
> 标签：jquery, jquery-load

我有以下

```
$('.quickview-dialog-left').load('/productlargetest .productlargeimage a'); 
```

这个 a 标签的 href 是一个图像。我想使用该 url 并在 quickview-dialog-left 中添加一个图像，但上面只引入了整个 a 标签。

我将如何引入 a 标签的 href？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:46:45.373

```
$('.quickview-dialog-left').load('/productlargetest .productlargeimage a');
$('.quickview-dialog-left').html("<img src='"+$('.quickview-dialog-left a').attr("href")+"'/>"); 
```

旁注：加载整个页面似乎只是获取图像的过度杀伤力......

# c++ - 新的类型安全枚举是否定义为从 0 开始？

> ID：13464387
> 
> 赞同：2
> 
> 时间：2012-11-19T23:39:56.730
> 
> 标签：c++, enums, c++11

给定以下 C++11 代码

```
enum class Foods {
  Apple,
  Pear,
  Banana
}; 
```

将要

```
std::cout << (unsigned int)Foods::Apple << std::endl; 
```

输出0？

这对于 MSVC 2012 和 gcc 4.7.0 是正确的，但是我对 C++11 标准指定我们可能依赖的内容更感兴趣。也就是说，可移植代码是否可以依赖于默认为 0 的枚举作为第一项的值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T23:49:47.707

当涉及到第一个未指定初始化程序的枚举数的值时，该标准没有区分作用域枚举和非作用域枚举。

从§7.2/2 **[dcl.enum]**

> 用only的*枚举键*声明的枚举类型`enum`是一个无作用域的枚举，它的*枚举*器是无*作用域的枚举*器。*枚举键* `enum class`和在`enum struct`语义上是等价的；用其中之一声明的枚举类型是*作用域枚举*，它的*枚举*器是*作用域枚举*器。[...]**如果第一个*枚举*器没有*初始化器*，则相应常量的值为零**。[...]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-19T23:48:01.243

枚举值的初始化没有改变：除非您给出不同的初始值，否则它们将从零开始并从前一个值开始计数。相关部分在 7.2 [dcl.enum] 第 2 段中：

> 如果第一个枚举器没有初始化器，则相应常量的值为零。没有初始化器的枚举器定义为枚举器提供了通过将前一个枚举器的值增加一而获得的值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-19T23:49:54.447

是的，他们是。它在第 7.2/2 节中：

> [...]如果第一个枚举器没有初始化器，则相应常量的值为零。没有初始化器的枚举器定义为枚举器提供了通过将前一个枚举器的值增加一而获得的值。

本节涵盖`enum class`声明和常规`enum`声明

# php - 使用 DOMDocument 和 DOMXPath 如何忽略匹配的某些字符？

> ID：13464392
> 
> 赞同：3
> 
> 时间：2012-11-19T23:40:25.480
> 
> 标签：php, domdocument, domxpath

我正在使用[DOMDocument](http://php.net/manual/en/class.domdocument.php)和[DOMXPath](http://php.net/manual/en/class.domxpath.php)来确定我的 HTML 内容中是否存在某些短语（关键字短语），例如搜索关键字是否为粗体。我使用以下代码并且工作正常，只是在搜索关键字时我需要“忽略”一些字符。使用以下代码：

```
$characters_to_ignore = array(':','(',')','/');
$keyword = 'keyword AAA';
$content = "Some HTML content for example <b>keyword: AAA</b> and other HTML";
$exp = '//b[contains(., "' . $keyword . '")]|//strong[contains(., "' . $keyword . '")]|//span[contains(@style, "bold") and contains(., "' .  $keyword . '")]';

$doc = new DOMDocument();
$doc->loadHTML(strtolower($content));
$xpath = new DOMXPath($doc);
$elements = $xpath->query($exp); 
```

我需要识别“关键字：AAA”以及“关键字 AAA”，因此我需要指定 DOMXPath 查询以在搜索关键字词组时忽略变量 $characters_to_ignore 中的字符。

前面的代码适用于“关键字 AAA”，我怎样才能将其更改为匹配“关键字：AAA”？（以及 $characters_to_ignore 中的任何字符）

新信息：也许使用[这个](http://www.w3schools.com/xpath/xpath_functions.asp#string)？

> fn：包含（字符串 1，字符串 2）

但我找不到一个可行的例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-06T02:50:35.960

好吧，您可能已经以某种方式解决了它，但这是解决方案......

使用 XPath 2.0 方法会很简单`matches()`，但 PHP`DOMXPath`类目前只支持 XPath 1.0。

但是从 PHP 5.3 开始，`DOMXPath`类具有[registerPHPFunctions()](http://www.php.net/manual/en/domxpath.registerphpfunctions.php)方法，它允许我们将 PHP 函数用作 XPath 函数。:)

使其工作：

```
$keyword = 'AAA';
$regex = "|keyword[:()/]? $keyword|";
$content = "Some HTML content for example <b>keyword: AAA</b> and other HTML";
$exp = "//b[php:functionString('preg_match', '$regex', .)]|//strong[php:functionString('preg_match', '$regex', .)]|//span[contains(@style, 'bold') and php:functionString('preg_match', '$regex', .)]";

$doc = new DOMDocument();
$doc->loadHTML($content);
$xpath = new DOMXPath($doc);
$xpath->registerNamespace('php', 'http://php.net/xpath');
$xpath->registerPHPFunctions();
$elements = $xpath->query($exp); 
```

# events - wxPython 输入按钮事件

> ID：13464394
> 
> 赞同：0
> 
> 时间：2012-11-19T23:40:30.670
> 
> 标签：events, wxpython, enter

我已经看到了很多关于这个主题的信息，但并不是这个问题的确切答案。我有大多数相反的问题。我想阻止 Enter 按钮在按钮具有焦点时单击按钮。为此，我不想简单地禁用按钮接受 Enter 按钮按下，而是我想有条件地在回调方法中捕获 Enter 按钮按下。现在，我已将以下事件绑定到我的 python 程序中的所有小部件：

```
parent.Bind(wx.EVT_CHAR, self.CharInputCallback) 
```

EVT_CHAR 事件实际上是在按下回车按钮时引发的，我能够在我的回调方法中获取回调。我的问题是，尽管故意不跳过事件（这将在事件上转发），但输入按钮的虚拟单击按钮的功能仍然可以通过。由于发生这种情况，并且我确定我的回调方法没有转发事件（我已经通过捕获进入文本框的字符来测试了这一点）我怀疑输入按钮引发了一个我没有捕获的附加事件. 我已经尝试绑定和捕获其他以下事件，以防止来自输入按钮的“虚拟点击”：

```
parent.Bind(wx.EVT_TEXT_ENTER, self.CharInputCallback)
parent.Bind(wx.EVT_KEY_UP, self.CharInputCallback)
parent.Bind(wx.EVT_KEY_DOWN, self.CharInputCallback) 
```

然而，当我按下回车键时，仍单击焦点按钮。总而言之，当我按下回车按钮时是否会引发额外的事件？如果是这样，特别是哪个事件是“虚拟点击”按钮？我发现的大多数论坛都讨论了如何识别何时按下回车按钮，但我想识别它并在按钮处于焦点时禁用它的默认操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:49:28.643

导致 enter 单击按钮的事件是 key up 事件。我的回调代码有点混乱。捕获 key up 事件并且不跳过它会阻止 enter 按钮单击焦点按钮。无论如何，在 Windows 7 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:33:24.887

我尝试将所有这些事件绑定到不同的处理程序，并且我还绑定了 EVT_BUTTON。似乎 EVT_BUTTON 总是在 key 和 char 事件之前触发。如果您不希望您的按钮被点击，那么您可能不得不禁用它，使用不同的小部件（可能是通用按钮之一）或创建自己的小部件。我还会在 wxPython 邮件列表上询问他们是否有任何建议。

我知道在 wxPython 中对事件进行排序的唯一方法是使用 wx.CallAfter 或 wx.CallLater。不过，我不确定您将如何在这种情况下使用它。

# php - PHP 不可编辑的 pdf/文件导出选项

> ID：13464398
> 
> 赞同：0
> 
> 时间：2012-11-19T23:40:52.050
> 
> 标签：php, pdf, export, kohana

我正在 Kohana PHP 框架中开发一个评估性能的应用程序。该过程的最终结果是一个网页，列出了总体得分和一个颜色编码的 div 和结果列表。

最初的想法是可以选择将其保存为不可编辑的 PDF 文件并通过电子邮件发送给用户。经过进一步研究，我发现这并不像我希望的那样直截了当。

最好的解决方案似乎是安装 unix 应用程序[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)，但由于目标是共享主机，我无法在服务器上安装它。

我的问题是，将评估的不可编辑评论保存给用户的最佳选择是什么？

感谢您对此的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:50:31.557

我想生成快照或查看您如何调用它的唯一方法是将其存储在服务器端并且仅通过只读协议授予访问权限。因此，基本上是通过将其作为“网页”提供。

仍然每个人都可以保存和修改标记。但无论文件类型如何，您生成的每个文件都是如此。好的，也许除了 DRM 感染的文件。但你不想那样做，相信我。

哦，你也可以打印文件。打印输出很难编辑。虽然这也不是不可能……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T09:09:20.857

我发现了一个预先构建为 Kohana 模块的 PHP 版本 - github.com/ryross/pdfview

# .net - 如何将 Int 数据库字段映射到布尔实体框架模型字段？

> ID：13464400
> 
> 赞同：3
> 
> 时间：2012-11-19T23:40:55.660
> 
> 标签：.net, entity-framework, ado.net

使用`Int`字段（为了与其他 DBMS 和编程语言兼容）`Boolean`在数据库中存储值。我如何自定义数据库首先生成的实体框架模型（默认情况下将`Int`字段映射到`Int32`）以确保它在使用`Boolean`type on时生成的 SQL 查询中使用 1/0（而不是“true”/“false”）应用方面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T06:15:28.503

一种解决方法是在模型中使用另一个未映射到数据库的布尔属性。在该属性设置方法中，您可以将整数值设置为 int 属性。

```
//EF Generated/Poco Do not Modify
public partial MyTable
{
  public int MyField { get; set; }
} 
```

由于这些是部分类创建另一个文件

```
public partial MyTable
{
  public bool MyBoolField
  {
    get
    {
      return this.MyField != 0;
    }
    set
    {
      if (value)
      {
        this.MyField = 1;
      }
      else 
      {
        this.MyField = 0;
      }

    }
  }
} 
```

# git - git diff 未显示所有更改

> ID：13464403
> 
> 赞同：3
> 
> 时间：2012-11-19T23:41:24.713
> 
> 标签：git, git-diff

我几乎不好意思问，但是当我`git diff`在特定文件上运行时，它只显示前 26 行左右的更改。

是否有一个向下翻页命令将显示其余的更改？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-19T23:43:04.063

默认情况下，该`git diff`命令通过管道传输其输出`less`。按空格键。该`h`命令显示一个帮助屏幕。

# python - Python/Django/MySQL“不正确的字符串值”错误

> ID：13464405
> 
> 赞同：2
> 
> 时间：2012-11-19T23:41:31.360
> 
> 标签：python, mysql, django, unicode

我正在运行一个 Django 1.4.2/Python 2.7.3/MySQL 5.5.28 站点。该站点的一个特点是管理员可以向服务器发送一封电子邮件，该服务器通过 procmail 调用 Python 脚本，该脚本解析电子邮件并将其扔到数据库中。我维护该站点的两个版本——一个开发站点和一个生产站点。两个站点都使用不同但相同的 vitualenvs（我什至都​​删除了它们并重新安装了所有软件包以确保）。

我遇到了一个奇怪的问题。*完全相同的*脚本在开发服务器上成功，在生产服务器上失败。它失败并出现此错误：

```
...django/db/backends/mysql/base.py:114: Warning: Incorrect string value: '\x92t kno...' for column 'message' at row 1 
```

我很清楚 Django 的 unicode 问题，我知道这里有很多关于这个错误的问题，但我确保从一开始就将数据库设置为 UTF-8：

```
mysql> show variables like "character_set_database";
+------------------------+-------+
| Variable_name          | Value |
+------------------------+-------+
| character_set_database | utf8  |
+------------------------+-------+
1 row in set (0.00 sec)

mysql> show variables like "collation_database";
+--------------------+-----------------+
| Variable_name      | Value           |
+--------------------+-----------------+
| collation_database | utf8_general_ci |
+--------------------+-----------------+
1 row in set (0.00 sec) 
```

此外，我知道每一列都可以有自己的字符集，但该`message`列确实是 UTF-8：

```
mysql> show full columns in listserv_post;
+------------+--------------+-----------------+------+-----+---------+----------------+---------------------------------+---------+
| Field      | Type         | Collation       | Null | Key | Default | Extra          | Privileges                      | Comment |
+------------+--------------+-----------------+------+-----+---------+----------------+---------------------------------+---------+
| id         | int(11)      | NULL            | NO   | PRI | NULL    | auto_increment | select,insert,update,references |         |
| thread_id  | int(11)      | NULL            | NO   | MUL | NULL    |                | select,insert,update,references |         |
| timestamp  | datetime     | NULL            | NO   |     | NULL    |                | select,insert,update,references |         |
| from_name  | varchar(100) | utf8_general_ci | NO   |     | NULL    |                | select,insert,update,references |         |
| from_email | varchar(75)  | utf8_general_ci | NO   |     | NULL    |                | select,insert,update,references |         |
| message    | longtext     | utf8_general_ci | NO   |     | NULL    |                | select,insert,update,references |         |
+------------+--------------+-----------------+------+-----+---------+----------------+---------------------------------+---------+
6 rows in set (0.00 sec) 
```

有谁知道我为什么会收到这个错误？为什么它发生在生产配置而不是开发配置下？

谢谢！

[编辑 1]
需要明确的是，数据也是相同的。我向服务器发送一封电子邮件，然后 procmail 将其发送出去。这是 .procmailrc 的样子：

```
VERBOSE=off
:0
{
    :0c
    | <path>/dev/ein/scripts/process_new_mail.py dev > outputdev

    :0
    | <path>/prd/ein/scripts/process_new_mail.py prd > outputprd
} 
```

process_new_mail.py 有 2 个副本，但这只是因为它是受版本控制的，因此我可以维护两个独立的环境。如果我区分两个输出文件（包含收到的消息），它们是相同的。

[编辑 2] 实际上我刚刚发现 dev 和 prd 配置都失败了。不同之处在于开发配置会静默失败（可能与`DEBUG`设置有关？）。问题是其中一条消息中有一些 unicode 字符，Django 出于某种原因对它们感到窒息。我在进步……

我尝试编辑代码以将消息显式编码为 ASCII 和 UTF-8，但它仍然无法正常工作。不过，我越来越近了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:15:02.637

我修好了它！问题是我没有正确解析关于字符集的电子邮件。我的固定电子邮件解析代码来自[这篇文章](https://stackoverflow.com/questions/7166922/extracting-the-body-of-an-email-from-mbox-file-decoding-it-to-plain-text-regard)和[这篇文章](http://ginstrom.com/scribbles/2007/11/19/parsing-multilingual-email-with-python/)：

```
#get the charset of an email
#courtesy http://ginstrom.com/scribbles/2007/11/19/parsing-multilingual-email-with-python/
def get_charset(message, default='ascii'):
    if message.get_content_charset():
        return message.get_content_charset()

    if message.get_charset():
        return message.get_charset()

    return default

#courtesy https://stackoverflow.com/questions/7166922/extracting-the-body-of-an-email-from-mbox-file-decoding-it-to-plain-text-regard
def get_body(message):
    body = None

    #Walk through the parts of the email to find the text body.
    if message.is_multipart():
        for part in message.walk():
            #If part is multipart, walk through the subparts.
            if part.is_multipart():
                for subpart in part.walk():
                    if subpart.get_content_type() == 'text/plain':
                        #Get the subpart payload (i.e., the message body).
                        charset = get_charset(subpart, get_charset(message))
                        body = unicode(subpart.get_payload(decode=True), charset)
            #Part isn't multipart so get the email body.
            elif part.get_content_type() == 'text/plain':
                charset = get_charset(subpart, get_charset(message))
                body = unicode(part.get_payload(decode=True), charset)
    #If this isn't a multi-part message then get the payload (i.e., the message body).
    elif message.get_content_type() == 'text/plain':
        charset = get_charset(subpart, get_charset(message))
        body = unicode(message.get_payload(decode=True), charset)

    return body 
```

非常感谢您的帮助！

# asp.net-mvc - 在 Html.TextBoxFor 中看不到帖子操作中的模型更改？

> ID：13464407
> 
> 赞同：5
> 
> 时间：2012-11-19T23:42:05.330
> 
> 标签：asp.net-mvc, asp.net-mvc-4

这一定是很明显的事情，但对我来说它看起来很奇怪。我有简单的控制器、具有一个属性的模型和显示属性值并呈现该属性的编辑器的视图。当我单击按钮时，会发布表单并将感叹号附加到属性。这个感叹号在我看来是可见的，但只在`p`标签中可见，而不是在`input`由`Html.TextBoxFor()`.

为什么`Html.TextBoxFor()`忽略我在后期操作中更新了我的模型？

有没有办法改变这种行为`Html.TextBoxFor()`？

看法

```
@model ModelChangeInPostActionNotVisible.Models.IndexModel

@using (Html.BeginForm())
{
    <p>@Model.MyProperty</p>
    @Html.TextBoxFor(m => m.MyProperty)
    <input type="submit" />
} 
```

模型

```
namespace ModelChangeInPostActionNotVisible.Models
{
    public class IndexModel
    {
        public string MyProperty { get; set; }
    }
} 
```

控制器

```
namespace ModelChangeInPostActionNotVisible.Controllers
{
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            return View(new IndexModel { MyProperty = "hi" });
        }

        [HttpPost]
        public ActionResult Index(IndexModel model)
        {
            model.MyProperty += "!";
            return View(model);
        }
    }
} 
```

点击提交按钮后的 HTML

```
<form action="/" method="post">    <p>hi!</p>
<input id="MyProperty" name="MyProperty" type="text" value="hi" />    <input type="submit" />
</form> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T01:52:14.027

这是设计使然。

辅助方法使用 ModelState，因此如果您的请求的响应使用相同的模型，它将显示发布的值。

这是为了允许您在验证失败的情况下呈现相同的视图。

为确保您显示新信息`ModelState.Clear();`，请在返回之前添加：。

在这里阅读更多：http: [//blogs.msdn.com/b/simonince/archive/2010/05/05/asp-net-mvc-s-html-helpers-render-the-wrong-value.aspx](http://blogs.msdn.com/b/simonince/archive/2010/05/05/asp-net-mvc-s-html-helpers-render-the-wrong-value.aspx)

```
namespace ModelChangeInPostActionNotVisible.Controllers
{
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            return View(new IndexModel { MyProperty = "hi" });
        }

        [HttpPost]
        public ActionResult Index(IndexModel model)
        {
            model.MyProperty += "!";
            ModelState.Clear();
            return View(model);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-13T15:36:48.117

Yan Brunet 是绝对正确的，该变量需要从 ModelState 中删除才能在控制器中进行修改。不过，您不必清除整个 ModelState。您可以执行以下操作以仅删除要修改的变量：

```
 ModelState.Remove("MyProperty"); 
```

如果您想保留用户输入的其他值，这将很有用。

# php - PHP中的未知语法错误

> ID：13464409
> 
> 赞同：0
> 
> 时间：2012-11-19T23:42:31.293
> 
> 标签：php, database, class

我正在尝试从程序切换到 OOP php，我可以连接到数据库并在程序中很好地使用它，但是经过几个小时的挠头、谷歌搜索和一些小的调整/更改后，我承认失败并得出结论，我一定错过了一些东西.

我有两个文件，我的 IDE 标记语法问题显然与第一个文件（test.php）的“函数”部分有关，但我就是不知道是什么，有没有人有任何想法？这两个文件在下面。抱歉格式化，但由于某种原因，我无法在此文本区域中进行选项卡。

我假设它与缺乏构造函数有关。我试图添加一个而不是配置函数，但我仍然有语法问题。在文档/教程中，我可以找到 php 中的构造函数和 html 中的函数，但似乎没有任何内容可以解释它们如何与示例一起工作。

免责声明：这两个文件都被标签包围`<?php ?>`，我目前没有解决安全措施。在你可以跑步之前先走路等等。我还尝试在 test.php 的开头抛出一个 doctype 并在适当的地方用标签填充它，`<html>` `<head>`但`<body>`无济于事。使用 Apache 2.2.22 和 PHP 5.3.13。

```
// ------- Test.php start -------
include 'obj_lib.php';

$db = new database;
$db = function config('test', 'root', '', 'localhost');
$db = function connect();
$db = function test_database();
// ------- Test.php end -------

// ------- obj_lib.php start -------
class database
{
  private $username;
  private $password;
  private $database;
  private $server;
  private $db_handle;
  private $db_found;

   public function config($indatabase=null, $inusername=null, $inpassword=null, $inserver=null)
   {
   $this->username = $inusername;
   $this->password = $inpassword;
   $this->database = $indatabase;
   $this->server   = $inserver;
   }

   public function connect()
   {
   $this->db_handle = mysql_connect($this->server, $this->username, $this->password);
   $this->db_found = mysql_select_db($this->database, $this->db_handle);
   }

   public function test_database()
   {
   echo "$this->username"."$this->password"."$this->database"."$this->server"."$this->db_handle"."$this->db_found";
   }
 }
// ------- obj_lib.php end ------- 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:44:54.800

```
$db = new database;
$db = function config('test', 'root', '', 'localhost');
$db = function connect();
$db = function test_database(); 
```

应该

```
$db = new database;
$db->config('test', 'root', '', 'localhost');
$db->connect();
$db->test_database(); 
```

# iphone - 被调用的方法没有响应 - Xcode 4 / Objective-C c

> ID：13464410
> 
> 赞同：2
> 
> 时间：2012-11-19T23:42:33.590
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我在导入到项目中的外部文件中调用方法时遇到问题。这些方法由于某种原因没有被调用，即使项目编译正常。并且控制台中没有错误消息/输出。

有人可以帮忙吗？？这是完整的问题：

[（1）我下载了本教程作者](http://www.raywenderlich.com/22324/beginning-uicollectionview-in-ios-6-part-12)编写的Flickr API（4个文件）并拖放到Xcode文件管理器中，指定将这4个文件复制并链接到我的项目中。

```
* Flickr.h
* Flickr.m
* FlickrPhoto.h
* FlickrPhoto.m 
```

(2)在主视图控制器中，我先导入外部文件

```
#import "Flickr.h"
#import "FlickrPhoto.h" 
```

(3) 然后我在@interface 部分定义一个属性来保存对象：

```
@property (weak, nonatomic) Flickr *flickr; 
```

(4) 在viewDidLoad中，我分配了一个新的对象实例：

```
self.flickr = [[Flickr alloc] init]; 
```

(5) 然后在后面的方法中，我调用了API中的一个方法：

```
[self.flickr searchFlickrForTerm:textField.text completionBlock:^(...) { ... }]; 
```

但是，该方法没有被调用：我在该方法调用之前放置了一个 NSLog 行，它打印到控制台。我还在方法的第一行放了一个 NSLog：

```
- (void)searchFlickrForTerm:(...) term completionBlock: ... 
```

它没有打印任何东西。

为什么不调用这个方法？？？！！！以前从未遇到过这个问题。它真的很烦人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T23:45:08.700

尝试将您的属性更改为强而不是弱，看看是否可以解决您的问题：

```
@property (strong, nonatomic) Flickr *flickr; 
```

如果这样可以解决问题，那么问题是您的财产在您能够使用它之前就被释放了。您不会看到任何错误，因为“弱”属性可确保在对象被释放后将指针设置为 nil（并且 Objective-C 在向 nil 发送消息时不会抛出错误）。

# codeigniter - 在 opencart 中加载和使用模型

> ID：13464415
> 
> 赞同：4
> 
> 时间：2012-11-19T23:42:47.723
> 
> 标签：codeigniter, opencart

据我了解，打开购物车基于 CodeIgniter，但在 CodeIgniter 中加载和使用模型，您可以执行以下操作

```
$this->load->model('Model_name');

$this->Model_name->function(); 
```

在 OpenCart 你做这样的事情

```
$this->load->model('catalog/product');
$this->model_catalog_product->getTotalProducts() 
```

这是如何工作的，“model_catalog_product”来自哪里？

除了论坛之外，他们似乎还有 0 个开发人员文档。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T01:28:56.230

OpenCart 的 loader 类[似乎受到](http://forum.opencart.com/viewtopic.php?f=10&t=5204&start=0)了 CodeIgniter 的启发，但并不是基于它。您可以查看 OpenCart 的源代码，请参阅文件`system/engine/loader.php`（第 39 行）。

```
public function model($model) {
    $file  = DIR_APPLICATION . 'model/' . $model . '.php';
    $class = 'Model' . preg_replace('/[^a-zA-Z0-9]/', '', $model);                      

    if (file_exists($file)) {
        include_once($file);

        // Right here. Replaces slash by underscore.
        $this->registry->set('model_' . str_replace('/', '_', $model), new $class($this->registry));
    } else {
        trigger_error('Error: Could not load model ' . $model . '!');
        exit();                 
    }
} 
```

您可以清楚地看到它用下划线替换了斜线并附加`'model_'`在模型名称之前。这就是为什么你最终得到`model_catalog_product`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T01:44:02.607

`model_catalog_product`来自模型文件夹中的路径文件夹结构和文件名，文件也是如此，`model_catalog_product`删除`model/catalog/product.php`了扩展名，斜杠更改为下划线。另外，请注意模型类名称也指类似的结构，即`ModelCatalogProduct`. 至于文档，有*一些*针对开发人员的文档，但只是简单地检查了一下，似乎出于某种原因它已被删除。不幸的是，我没有从大量的试验和错误中学到东西，大多数开发人员都在使用它

# c# - 方法'Write'没有重载需要0个参数，MVC3 Razor

> ID：13464416
> 
> 赞同：0
> 
> 时间：2012-11-19T23:42:50.500
> 
> 标签：c#, html, asp.net-mvc-3, razor

以下循环是在我的 MVC 项目的视图中。

```
 @{for (int i=1;i <= 5;i++){
           @{foreach(Infographic.Category item in (Model.CatList as List<Infographic.Category>)){
          <div id="cat-name-@i">
                @item.Name
            </div>
            <div id="cat-image-@i">
                @item.Image
            </div>
            <div id="cat-percent-savings-@i">
                @item.PercentSavings
            </div>
            <div id="cat-total-spending-@i">
                @item.PercentTotalSpending
            </div>
            <div id="cat-avg-savings-same-store-@i">
                @item.AvgPercentSavingsSameStoreShopper
            </div>             
             }
          } 
       }  
    } 
```

当我运行时，我收到错误：“方法'Write'没有重载需要0个参数”在我的`foreach`循环周围突出显示。

当我将 for 循环放在 foreach 中时，它可以工作，但在继续下一个之前循环每个类别列表 5 次，并在我只需要 25 个时给我 125 个项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:11:10.933

您似乎在`{`这里有不必要的 s 数量。以下似乎适用于我的机器：

```
@for (int i = 1; i <= 5; i++)
{
    foreach (Consumerology.Models.Infographic.Category item in (Model.CatList as List<Consumerology.Models.Infographic.Category>))
    {
        <div id="cat-name-@i">
            @item.Name
        </div>
        <div id="cat-image-@i">
            @item.Image
        </div>
        <div id="cat-percent-savings-@i">
            @item.PercentSavings
        </div>
        <div id="cat-total-spending-@i">
            @item.PercentTotalSpending
        </div>
        <div id="cat-avg-savings-same-store-@i">
            @item.AvgPercentSavingsSameStoreShopper
        </div>             
    }
} 
```

# javascript - 防止特殊字符 - jQuery 表单验证

> ID：13464418
> 
> 赞同：1
> 
> 时间：2012-11-19T23:42:55.087
> 
> 标签：javascript, jquery, regex

所以我在文本输入上有这个简单的表单验证。

一直在做一些谷歌搜索，但找不到如何限制任何特殊字符——这意味着我想阻止使用除字母数字字符之外的任何东西。

我想将它包含在此功能中...有人吗？

```
if (!campaign_name || !'^[a-zA-Z 0-9]+$'){
    //alert('Please enter campaign name');
    // Do nothing
    return false;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:46:17.947

```
if (/[^a-zA-Z 0-9]+/.test(campaign_name)){
    // error...
} 
```

# c# - 将类型设置为电子邮件地址

> ID：13464421
> 
> 赞同：1
> 
> 时间：2012-11-19T23:43:13.770
> 
> 标签：c#, entity-framework, visual-studio-2012, visual-studio-lightswitch

我开始在 VS2012 中使用 EF 5 和 Lightswitch。

我在 EF 5 中对数据库进行建模，然后创建数据库并将新数据源添加到 Lightswitch。我有一个联系人表，其中有一个电子邮件字段，它是 EF 中的字符串类型，我知道我可以在 Lightswitch 中将验证类型设置为电子邮件地址，但它似乎不想让我这样做。这是它的图片：

![在此处输入图像描述](../Images/c2f12fbc6222548de9d7f8ff6c76f68e.png)

如何将类型设置为电子邮件地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T08:57:37.133

缺少“业务类型”（如*电子邮件地址*、*图像*等）是由于未为项目选择包含这些类型的扩展。此扩展程序默认勾选，但有时人们取消勾选它，不知道它的用途。

要为您的项目解决此问题：

1.  在解决方案资源管理器中右键单击您的 LightSwitch 项目
2.  选择属性
3.  单击*扩展*选项卡
4.  确保勾选了名为*Microsoft LightSwitch Extensions的扩展*

*您可以通过勾选“在新项目中使用”*来帮助确保未来项目不会再次发生这种情况。

# javascript - 如果用户名在 mvc3 中有效，我如何显示消息

> ID：13464422
> 
> 赞同：0
> 
> 时间：2012-11-19T23:43:13.507
> 
> 标签：javascript, jquery, ajax, asp.net-mvc-3

我正在数据库中检查用户名，输入的用户名是否被接受或该用户名已经被使用。如果用户输入的用户名被接受，我想显示消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T15:08:16.823

我猜你使用的标签意味着你想用 jQuery 来做这件事，所以这里是：

在您看来，您将拥有一个允许用户输入用户名的文本框：

```
<input id="username-txt" type="text" /> 
```

您还将有一个链接或按钮，允许用户检查他们的用户名是否已被使用：

```
<a id="username-check" href="#"> 
```

然后，您将获得一些在单击链接时调用的 javascript。js 将获取用户名并通过 ajax 调用您的 MVC 操作，并根据结果显示警报：

```
<script type="text/javascript" charset="utf-8">
        $(document).ready(function () {
    $("#username-check").click(function (e) {
    e.preventDefault();
    var name-to-check = $("username-txt").val();
    $.ajax({
          url: 'MyController/CheckUserName,
          type: 'POST',
          data: { username : name-to-check },
          success: function (data) {
             if (data.error != null) {
                alert(data.error_detail);
              } else {
                if(existingNames == 'true'){
                   alert('that username is taken');
                 }else{
                    alert('that username is available');
                 }
              }
          },
            error: function () {
                alert("error");
             }
         });
    });
});
</script> 
```

此 javascript 可以在视图、_Layout 文件或单独的 .js 文件中。您需要包含 jQuery 才能完成这项工作：

```
<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script> 
```

这是您的控制器代码：

```
[HttpPost]
public ActionResult CheckUserName(string username)
{
   // here you'd make a database call to check if the username existed
   bool existingNames = MyService.UserNameExists(username);

return new JsonResult
 {
     Data = existingNames,
     JsonRequestBehavior = JsonRequestBehavior.AllowGet
 };
} 
```

这显然是一个简化的解决方案，但它应该让你开始。假设这实际上是你想要的！

# python - JsonProperty 是否仅在访问时反序列化？

> ID：13464423
> 
> 赞同：1
> 
> 时间：2012-11-19T23:43:14.353
> 
> 标签：python, google-app-engine

在 Google App Engine NDB 中，有一种属性类型`JsonProperty`，它采用 Python`list`或字典并自动对其进行序列化。

我的模型的结构取决于这个问题的答案，所以我想知道一个对象何时被反序列化？例如：

```
# a User model has a property "dictionary" which is of type JsonProperty

# will the following deserialize the dictionary?

object = User.get_by_id(someid)

# or will it not get deserialized until I actually access the dictionary?

val = object.dictionary['value'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:08:15.143

`ndb.JsonProperty`遵循[文档](https://developers.google.com/appengine/docs/python/datastore/propertyclass#Property_make_value_from_datastore)并以与定义自定义属性时相同的方式执行操作：它定义`make_value_from_datastore`和`get_value_for_datastore`方法。

文档没有告诉您何时调用这些方法，因为由应用引擎中的 db 实现来决定何时调用这些方法。

然而，每当模型必须访问数据库时，它们很可能会被调用。例如，从文档中`get_value_for_datastore`：

> 属性类可以覆盖它以对数据存储使用与模型实例不同的数据类型，或者在存储模型实例之前执行其他数据转换。

如果你真的需要验证发生了什么，你可以像这样提供你自己的 JsonProperty 子类：

```
class LoggingJsonProperty(ndb.JsonProperty):
    def make_value_from_datastore(self, value):
        with open('~/test.log', 'a') as logfile:
            logfile.write('make_value_from_datastore called\n')
        return super(LoggingJson, self).make_value_from_datastore(value) 
```

如果需要，您可以记录 JSON 字符串、回溯等。显然，您可以使用标准的日志记录功能，而不是将内容粘贴在单独的日志中。但这应该足以了解正在发生的事情。

当然，另一种选择是阅读代码，我相信它位于`appengine/ext/db/__init__.py`.

由于没有记录，详细信息可能会从一个版本更改为下一个版本，因此如果您需要 100% 确定，则每次升级时都必须重新运行测试或重新阅读代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T01:38:22.370

正确的答案是它确实在访问时延迟加载该项目：

[https://groups.google.com/forum/?fromgroups=#!topic/appengine-ndb-discuss/GaUSM7y4XhQ](https://groups.google.com/forum/?fromgroups=#!topic/appengine-ndb-discuss/GaUSM7y4XhQ)

# c# - DataTemplate 中的 VisualBrush 不会重绘

> ID：13464424
> 
> 赞同：2
> 
> 时间：2012-11-19T23:43:22.647
> 
> 标签：c#, wpf, xaml, datatemplate, visualbrush

我有一个 ListView 来显示附件，每个附件都有一个删除按钮。当我更改列表的 ItemSource 时（即查看具有不同附件的另一个项目时），删除按钮的图标不再绘制。

这是模板

```
 <DataTemplate x:Key="attachmentListData">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>

                </Grid.ColumnDefinitions>
                <Label Grid.Column="0">
                    <TextBlock TextTrimming="CharacterEllipsis" Text="{Binding Path=filename}" TextDecorations="{Binding Path=deleted, Converter={StaticResource deletedStrikethroughConverter}}"  />
                </Label>
                <Button Grid.Column="1" Visibility="{Binding Path=deleted, Converter={StaticResource attachmentDeleteButtonVisibilityConverter}}" Style="{DynamicResource MetroCircleButtonStyle}" Width="40" Height="40" Click="onDeleteAttachmentClicked">
                    <Rectangle Fill="Black" Width="15" Height="15">
                        <Rectangle.OpacityMask>
                            <VisualBrush Visual="{StaticResource appbar_close}" Stretch="Fill" />
                        </Rectangle.OpacityMask>
                    </Rectangle>
                </Button>
            </Grid>
        </DataTemplate> 
```

通过将 appbar_close 图标绘制在屏幕的其他位置，但将可见性设置为隐藏，我已经能够解决此问题。如果图标不在屏幕的其他位置，则在我更改 ItemSource 后，图标将停止绘制。

显然，这种解决方法很麻烦，但是确保图标仍然显示的更好方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T02:12:21.650

您可以在 appbar_close 中设置 x:Shared=False 并且还应该使用[PresentationOptions:Freeze](http://msdn.microsoft.com/en-us/library/aa970057.aspx)、[RenderOptions](http://msdn.microsoft.com/en-us/library/system.windows.media.renderoptions.aspx)来提高性能。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T02:22:30.337

我认为您缺少 DataTemplate 上的 DataType 属性。[http://msdn.microsoft.com/en-us/library/system.windows.datatemplate.datatype.aspx](http://msdn.microsoft.com/en-us/library/system.windows.datatemplate.datatype.aspx)。如果这没有在您绑定按钮可见性的行上给您一个绑定错误，我会感到惊讶。

# objective-c - 索引到数组字典时出现无法识别的选择器错误

> ID：13464433
> 
> 赞同：1
> 
> 时间：2012-11-19T23:43:57.457
> 
> 标签：objective-c, ios, json, nsdictionary

我有一个导致`__NSCFDictionary objectAtIndex:`错误的数组字典。

有人能告诉我为什么吗？发生错误时，字典显然至少有 1 个数组。

```
 NSError *error;
 responseString = [[NSString alloc] initWithData:self.responseData2 encoding:NSUTF8StringEncoding];

/* response string contains this:
   {"words":
     {
    "word": {"rowsreturned":0,"id":"-1","date":"","word":"","term":"","definition":"","updated_on":""}
     },
    "status":"",
    "rowsreturned":""
  }
*/

 NSDictionary *json = [NSJSONSerialization JSONObjectWithData:self.responseData2 options:kNilOptions error:&error];

 NSArray *todaysWord = [[json objectForKey:@"words"] objectForKey:@"word"];

 //error here -[__NSCFDictionary objectAtIndex:]: unrecognized selector sent to instance
 NSDictionary *word = [todaysWord objectAtIndex:0]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:53:24.783

在您的情况下`[[json objectForKey:@"words"] objectForKey:@"word"];`，返回的是字典而不是数组。尝试执行以下操作，

```
id wordParam = [[json objectForKey:@"words"] objectForKey:@"word"];

if ([wordParam isKindOfClass:[NSArray class]]) {
  NSDictionary *word = [(NSArray *)wordParam objectAtIndex:0];
} else if ([wordParam isKindOfClass:[NSDictionary class]]) {
  NSDictionary *word = (NSDictionary *)wordParam;
} else {
  NSLog(@"error. %@ is not an array or dictionary", wordParam);
} 
```

您的响应字符串还显示的值`word`是，

```
{"rowsreturned":0,"id":"-1","date":"","word":"","term":"","definition":"","updated_on":""} 
```

这是一个具有键值对的字典`rowsreturned:0`，`id:-1`等等。

# javascript - HTML5 地理位置 - 错误回调并不总是触发

> ID：13464444
> 
> 赞同：0
> 
> 时间：2012-11-19T23:45:14.160
> 
> 标签：javascript, html, geolocation

我以这种相当简单的方式使用 Geolocation API：

```
if (navigator && navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position){
        console.log("gettingPosition: " + position);
        myFunction(position(;
    }, function(error){
        console.log('did not get position');
        console.log(error);
    });     

} 
```

在某些情况下（Firefox 12.0 是我面前的浏览器），如果用户单击“Not Now”，则不会触发回调，甚至不会触发错误。这是预期的吗？如果是这样，我唯一的选择是在接受请求并设置自己的超时时遵循[地理定位反馈中的技术吗？](https://stackoverflow.com/questions/4736057/geolocation-feedback-while-accepting-the-request)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:05:28.767

这似乎是设计使然（对于 Firefox）。请参阅 Josh 在[https://bugzilla.mozilla.org/show_bug.cgi?id=635175中的评论](https://bugzilla.mozilla.org/show_bug.cgi?id=635175)

逻辑是，单击“现在不”是用户关闭权限对话框而无需决定是否允许地理定位权限的一种方式。

看起来 FF16 和 Chrome-Latest 都是这样操作的。

（PS 不要射击信使。：p）

# sql - 具有两个唯一 IDS 的最新日期行

> ID：13464445
> 
> 赞同：1
> 
> 时间：2012-11-19T23:45:17.983
> 
> 标签：sql, date, greatest-n-per-group

我正在尝试创建一个查询，该查询将为状态和 tier3ID 组合提取最新行，同时还显示其他三列。

```
EFFECTIVE_DATE|STATE|ELIGIBLE|INTONLY|AOPELIGIBLE|TIER3ID
01-JAN-05     | AK  | Yes    | No    | No        |1101
15-NOV-12     | IN  | Yes    | No    | No        |1101
01-JAN-05     | AZ  | Yes    | No    | No        |1101 
```

我所尝试的一切都让我得到了数据组合，但除非我也按它们分组，否则我无法显示其他三行。

我基本上想要：

```
select state, tier3id, eligible,
max(effective_date)
from thirdtiereligibilityeq
group by state, tier3id, eligible 
```

在符合条件的情况下，仅限`AOPeligible`于这些行并显示这些行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-05T09:32:34.000

这是您要查找的查询：

```
SELECT T.*
FROM thirdtiereligibilityeq T
INNER JOIN (SELECT T2.state
                  ,T2.tier3id
                  ,MAX(T2.effective_date) AS [last_effective_date]
            FROM thirdtiereligibilityeq T2
            GROUP BY T2.state, T2.tier3id) L ON L.state = T.state
                                               AND L.tier3id = T.tier3id
                                               AND L.last_effective_date = T.effective_date 
```

希望这会帮助你。

# python - ubuntu 12.04中的python库访问

> ID：13464456
> 
> 赞同：0
> 
> 时间：2012-11-19T23:46:19.673
> 
> 标签：python, installation, ubuntu-12.04

我正在从 learnpythonthehardway 学习 python。在 Windows 中，我通过大量练习没有问题，因为设置更容易，但我也想学习 linux，而 ubuntu 在我看来是最好的选择。

现在我在设置时遇到了麻烦。我可以访问终端，然后访问 usr/lib/python.2.7 但我不知道是否将脚本保存在此目录中？如果我尝试通过 mkdir 在其中创建一个目录，我不能因为权限被拒绝。我也尝试过 chmod 但不知道如何或是否要这样做。

关于如何将我的脚本保存在什么库中的任何帮助？怎么做？以及如何在终端中运行它：user@user$ python sampleexcercise.py

使用 ubuntu 12.04 lts 技能 = 新手

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:53:40.037

作为一个绝对的初学者，现在不用担心在哪里安装库。您出于学习目的而尝试的简单示例脚本不属于安装在任何 lib 目录中，例如`/usr/lib/python`.'

在 Linux 上，您希望在主目录中完成大部分工作，因此只需`cd ~`确保您在那里并使用您选择的编辑器在那里创建文件。您可能还想分层组织文件。例如，使用您的主目录`src/`中的`mkdir`命令创建一个名为的目录。然后`mdkir src/lpthw`，例如，作为存储“Learn Python the Hard Way”中所有示例的地方。然后简单`python <path/to/py/file>`地执行脚本。或者您可以`cd ~/src/lpthw`仅按文件名运行脚本。

# html - 奇怪的 CSS div - 需要帮助

> ID：13464465
> 
> 赞同：0
> 
> 时间：2012-11-19T23:47:42.273
> 
> 标签：html, css

我正在寻找有关如何实现这样的事情的帮助：

[img http://img1.firenex.net/ssFan8c00f9Ul1QnQzGt.png](http://img1.firenex.net/ssFan8c00f9Ul1QnQzGt.png)

困难在于功能区图像是此 DIV 的标题，而我希望整个包装器的高度是自动的，这取决于我在其中写了多少文本。

我找不到出路。有什么帮助吗？

这是我现在必须的代码。

```
<div id="sidebar">
<div class="sidebarElementWrapper"><div class="sidebarElement"></div></div>
</div> 
```

CSS（考虑这是一个侧边栏）：

```
#sidebar {
width: 225px;
height: auto;
margin-top: 10px;
margin-left: 20px;
min-height: 100px;
float: left;
}

.sidebarElement {
width: 244px;
min-height: 100px;
margin-top: 10px;
background: url(img/ribbon.png) no-repeat top center;
}

.sidebarElementWrapper {
width: 244px;
height: auto;
min-height: 20px;
background: url(img/SidebarElementWrapper.png) repeat-y;
} 
```

它可以工作，但是当我在其中输入一些文本并设置一些填充时，它就会爆发..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:24:12.303

我认为使用绝对定位会使事情变得更容易。

JS 小提琴：http: [//jsfiddle.net/qf49w/59/](http://jsfiddle.net/qf49w/59/)

**HTML**

```
<div id="sidebar">
    <div id="ribbon"></div>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam eget tellus at elit sagittis ultrices non nec sem. Curabitur sit amet nibh elit, vitae rhoncus velit. Sed ac nisl ut felis pretium fermentum. Donec sodales lorem ut nibh dapibus id tempus dui tincidunt.
</div> 
```

**CSS**

```
 #sidebar { 
        width: 160px; 
        height: auto;  
        background: white; 
        position:relative; 
        padding:40px 10px 10px 10px; 
        margin:40px auto; 
    }  

    #ribbon {
        position:absolute;
        top: -25px;;
        left:-60px;  
        height:60px;
        width:290px;
        background:url(http://www.clker.com/cliparts/e/e/R/Z/Y/n/red-white-ribbon-md.png) no-repeat 0 0;  
    } 
```

我简化了您的结构，您只需要一个用于内容的侧边栏容器和一个包含图像的功能区 div。

我使用绝对定位来相对于侧边栏 ( position:relative ) 定位功能区，然后将侧边栏顶部填充设置为与功能区容器大致相同的高度，使文本仅在功能区下方开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:16:05.723

没有足够的信息让我离开，但是类似的东西呢：

HTML

```
<div id="sidebar">
<div class="sidebarElementWrapper"><div class="sidebarHeader">Header</div><div class="sidebarBody">Content</div></div>
</div> 
```

CSS

```
#sidebar {
width: 225px;
height: auto;
margin-top: 10px;
margin-left: 20px;
min-height: 100px;
float: left;
}

.sidebarHeader {
width: 244px;
height: 45px;
margin-top: 10px;
background: url(img/ribbon.png) no-repeat top center;
}

.sidebarBody {
width: 225px;
margin-left: 10px;
background-color: #ffffff;
}

.sidebarElementWrapper {
width: 244px;
height: auto;
min-height: 20px;
} 
```

需要注意的几点：
1\. 这是假设 'ribbon.png' 为 244 x 45 像素。
2\. 我添加了另一个带有类的 div 并重`sidebarBody`命名`sidebarElement`为`sidebarHeader`

这个解决方案仍然需要做一些工作，但希望能给你足够的洞察力来解决你的问题。

# ruby-on-rails - 复杂的 Rails 3 嵌套路线

> ID：13464466
> 
> 赞同：0
> 
> 时间：2012-11-19T23:47:42.233
> 
> 标签：ruby-on-rails, routing

当我单击“创建参与者”按钮时，我收到了这个奇怪的路由错误。显然，我误解了溃败的工作原理。如果您能澄清一下，将不胜感激！

```
No route matches {:action=>"present_survey", :controller=>"rounds", :program_id=>#
<Program id: 1, name: "JBS 2012", description: "Summer of 2012", open: false, 
locked: true, suppress_hidden_participants: false, created_at: "2012-11-19 22:35:06", 
updated_at: "2012-11-19 22:35:06">, :participant_id=>nil, :round_id=>#<Round id: 9, 
program_id: 1, number: 8, start: 86, fin: 95, status: nil, open: true, open_date: nil, 
created_at: "2012-11-19 22:35:07", updated_at: "2012-11-19 22:35:07">} 
```

这是相关的 routes.rb 行：

```
new_program_participant GET /programs/:program_id/participants/new(.:format)  participants#new 
```

以下是相关的控制器行：

```
class ParticipantsController < ApplicationController
  respond_to :html
  def index
    @program_id = params[:program_id]
    @program = Program.find(@program_id)
    @participants = @program.participants.paginate(page: params[:page])
    respond_with @participants do |format|
      format.html {
        render layout: 'layouts/progtabs'
      }
    end
  end 
```

这是相关的视图行：

```
<%= link_to "Create a new Participant", new_program_participant_path(@program_id) %> 
```

这是生成的网址：

```
http://0.0.0.0:3000/programs/1/participants/new 
```

# 由原始海报编辑：

针对以下问题和评论：

*   该链接出现在索引页面上，应该将我带到指定的 URL，因此该链接对我来说似乎是正确的。
*   您可以在下面的 routes.rb 中看到，确实我有一个名为 present_survey 的操作，但我不明白为什么它在起作用

这是整个路线文件：

```
 root to: 'programs#index'
  resources :programs do
    resources :participants do
      resources :rounds do
        get 'survey' => 'rounds#present_survey'
        put 'survey' => 'rounds#store_survey'
      end
    end
    resources :questions
    resources :rounds
    member do
      get 'report' => 'reports#report'
    end
  end 
```

最后是 rake 路由的完整输出：

```
root        /                                                                                    programs#index
program_participant_round_survey GET    /programs/:program_id/participants/:participant_id/rounds/:round_id/survey(.:format) rounds#present_survey
                                 PUT    /programs/:program_id/participants/:participant_id/rounds/:round_id/survey(.:format) rounds#store_survey
      program_participant_rounds GET    /programs/:program_id/participants/:participant_id/rounds(.:format)                  rounds#index
                                 POST   /programs/:program_id/participants/:participant_id/rounds(.:format)                  rounds#create
   new_program_participant_round GET    /programs/:program_id/participants/:participant_id/rounds/new(.:format)              rounds#new
  edit_program_participant_round GET    /programs/:program_id/participants/:participant_id/rounds/:id/edit(.:format)         rounds#edit
       program_participant_round GET    /programs/:program_id/participants/:participant_id/rounds/:id(.:format)              rounds#show
                                 PUT    /programs/:program_id/participants/:participant_id/rounds/:id(.:format)              rounds#update
                                 DELETE /programs/:program_id/participants/:participant_id/rounds/:id(.:format)              rounds#destroy
            program_participants GET    /programs/:program_id/participants(.:format)                                         participants#index
                                 POST   /programs/:program_id/participants(.:format)                                         participants#create
         new_program_participant GET    /programs/:program_id/participants/new(.:format)                                     participants#new
        edit_program_participant GET    /programs/:program_id/participants/:id/edit(.:format)                                participants#edit
             program_participant GET    /programs/:program_id/participants/:id(.:format)                                     participants#show
                                 PUT    /programs/:program_id/participants/:id(.:format)                                     participants#update
                                 DELETE /programs/:program_id/participants/:id(.:format)                                     participants#destroy
               program_questions GET    /programs/:program_id/questions(.:format)                                            questions#index
                                 POST   /programs/:program_id/questions(.:format)                                            questions#create
            new_program_question GET    /programs/:program_id/questions/new(.:format)                                        questions#new
           edit_program_question GET    /programs/:program_id/questions/:id/edit(.:format)                                   questions#edit
                program_question GET    /programs/:program_id/questions/:id(.:format)                                        questions#show
                                 PUT    /programs/:program_id/questions/:id(.:format)                                        questions#update
                                 DELETE /programs/:program_id/questions/:id(.:format)                                        questions#destroy
                  program_rounds GET    /programs/:program_id/rounds(.:format)                                               rounds#index
                                 POST   /programs/:program_id/rounds(.:format)                                               rounds#create
               new_program_round GET    /programs/:program_id/rounds/new(.:format)                                           rounds#new
              edit_program_round GET    /programs/:program_id/rounds/:id/edit(.:format)                                      rounds#edit
                   program_round GET    /programs/:program_id/rounds/:id(.:format)                                           rounds#show
                                 PUT    /programs/:program_id/rounds/:id(.:format)                                           rounds#update
                                 DELETE /programs/:program_id/rounds/:id(.:format)                                           rounds#destroy
                  report_program GET    /programs/:id/report(.:format)                                                       reports#report
                        programs GET    /programs(.:format)                                                                  programs#index
                                 POST   /programs(.:format)                                                                  programs#create
                     new_program GET    /programs/new(.:format)                                                              programs#new
                    edit_program GET    /programs/:id/edit(.:format)                                                         programs#edit
                         program GET    /programs/:id(.:format)                                                              programs#show
                                 PUT    /programs/:id(.:format)                                                              programs#update
                                 DELETE /programs/:id(.:format)                                                              programs#destroy 
```

# OP的更多编辑

```
 def new
    @program = Program.find(params[:program_id])
    @participant = @program.participants.new
    respond_with @participant do |format|
      format.html {
        render layout: 'layouts/progtabs'
      }
    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:01:06.633

Route 正在寻找映射到 ParticipantsController 中的方法的动作“present_survey”。没有路线匹配 {:action=>"present_survey" ......}

ParticipantsController 中没有名为 present_survey 的方法

运行命令“rake routes”以按顺序获取所有路由的列表。

您的 URL 正在 ParticipantsController 中寻找新方法，您有吗？

new_program_participant GET /programs/:program_id/participants/new(.:format) **参与者#new**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:05:36.537

感谢@joofsh，我发现了我的问题。实际上，ParticipantController 上的新方法启动的“新参与者”表单包括：

```
link_to("Current survey form", program_participant_round_survey_path(prog, part.guid, round)) 
```

对于新参与者，part.guid 为零。

教训：当您要求 Rails 为您生成路径时，您也可能会遇到路由错误，而不仅仅是在您实际调度路由时。

# c# - 如何重构一系列 if-then 语句？

> ID：13464471
> 
> 赞同：2
> 
> 时间：2012-11-19T23:48:28.433
> 
> 标签：c#, excel

我正在编写一个脚本来检查一堆 Excel 电子表格中的某些值，我最终得到的代码如下所示：

```
 public bool checkContents(Excel._Worksheet sht, string address, string cellValue)
    {
        Excel.Range tempRange = sht.get_Range(address);
        return Convert.ToString(tempRange.Value) == cellValue;
    }

    public string getVersion(Excel._Worksheet sht)
    {
        if (checkContents(sht,"a4","Changes for Version 24"))
        {
            return "24";
        }
        else if (checkContents(sht,"a1","Changes for Version 23 (Official)"))
        {
            return "23";
        }
        else if (checkContents(sht,"a2","Changes for Version 22"))
        {
            return "22";
        }

       //and so on for another 10 if-else blocks 
    } 
```

我知道对于给定的工作表，只有一个`if`陈述是正确的。

`if`除了长序列的s之外，还有更简洁的方法来编写这个函数吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T00:00:22.313

你可以尝试这样的事情（未经测试，所以可能有一些语法错误）

```
 private class VersionSpec
    {
        public string Address { get; private set; }
        public string CellValue { get; private set; }
        public string Version { get; private set; }

        public VersionSpec (string address, string cellValue, string version)
        {
            Address = address;
            CellValue = cellValue;
            Version = version;
        }
    }

    public string getVersion(Excel._Worksheet sht)
    {
        VersionSpec[] versionSpecs = new []
        {
            new VersionSpec("a4", "Changes for Version 24", "24"),
            new VersionSpec("a1", "Changes for Version 23 (Official)", "23"),
            new VersionSpec("a2", "Changes for Version 22", "22"),
            // other versions...
        }

        foreach(VersionSpec versionSpec in versionSpecs)
        {
            if(checkContents(sht, versionSpec.Address, versionSpec.CellValue))
            {
                return versionSpec.Version;
            }
        } 
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:01:03.077

由于您的单元格值似乎不一致，您可以将所有参数放入自定义对象列表中，类似于以下内容。

```
public class Version
{
    public string CellAddress { get; set; }
    public string CellValue { get; set; }
    public string ReturnValue { get; set; }
} 
```

Then load up a `List<Version>` with your various versions. Afterwards you can use a `foreach` loop on the list and react when you get a hit with one of them.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:57:13.763

使用 .Net 4.0 Excel Interop，您不需要使用下划线 _Types，而是使用方括号。

```
public bool checkContentsStartsWith(Worksheet sht, string address, string cellValue)
{
   Range tempRange = sht.Range[address];
  return cellValue.StartsWith(tempRange.Value2);
}

public string getVersion(Worksheet sht)
{
    for (int j = 1; j < 4;j++)
    {
        for (int i = 24; i > 0; i--)
        {
            if (checkContentsStartsWith(sht, "A" + j.ToString(), "Changes for Version " + i))
            {
                return i;
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T00:05:41.650

If the rest of your if-blocks are the same structure as the sample posted, there's a clear pattern here; couldn't you check a larger range (e.g; "a1:a4") for the existence of the string "Changes for Version", return that string, and parse out the integer you want to return. You should be able to knock that down to 2-3 LOC if you adjust your thinking a little?

Some code to elucidate;

```
 public static string getVersion(Worksheet sht)
    {
        Range range = sht.Range["A1:A10"];
        foreach (Range c in range.Cells)
        {
            if (null == c.Value2) continue;
            string val = c.Value.ToString();
            if (val.Contains("Changes for Version "))
            {
                int startIndex = ("Changes for Version ").Length;
                return val.Substring(startIndex, 2).Trim(); 
            }
        }

        return null;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T00:13:11.913

I have another answer:

```
using (var usedRange = sheet.UsedRange.WithComCleanup())
{
    string firstAddress = string.Empty;
    string nextAddress = string.Empty;
    using (var firstCell = usedRange.Resource.Find("Changes for Version", LookIn: XlFindLookIn.xlValues).WithComCleanup())
    {    
        if (firstCell.Resource != null)
        {
            firstAddress = firstCell.Resource.Address;
            AppendListOfVersion(sheet.Name, firstCell.Resource);
            nextAddress = firstAddress;
        }
    }
}
if (firstAddress != "") // the first Find attempt was successful, so keep looking (FindNext)
{
    var keepLooking = true;
    while (keepLooking)
    {
        using (var prevCellToFindNextFrom = sheet.Range[nextAddress].WithComCleanup())
        using (var nextCell = usedRange.Resource.FindNext(prevCellToFindNextFrom.Resource).WithComCleanup())
        {
            if (nextCell.Resource == null)
                keepLooking = false;
            else
            {
                nextAddress = nextCell.Resource.Address;
                if (nextAddress == firstAddress)
                    keepLooking = false;
                else
                    AppendListOfVersion(sheet.Name, nextCell.Resource);
            }
        }
    }
} 
```

You can learn about the WithComCleanUp() here: [http://jake.ginnivan.net/vsto-com-interop](http://jake.ginnivan.net/vsto-com-interop)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-20T00:21:35.747

Here's a couple of options:

```
 public string getVersion(Excel._Worksheet sht)
    {
        if (checkContents(sht, "a4", "Changes for Version 24"))
            return "24";
        if (checkContents(sht, "a1", "Changes for Version 23 (Official)"))
            return "23";
        if (checkContents(sht, "a2", "Changes for Version 22"))
            return "22";
        //and so on for another 10 if-else blocks 
    }

    public string getVersion(Excel._Worksheet sht)
    {
        string[][] values = new string[3][]{
                            new string[3]{"a4","Changes for Version 24","24"}
                            ,new string[3]{"a1", "Changes for Version 23 (Official)","23"}
                            ,new string[3]{"a2", "Changes for Version 22","22"}
                          };
        foreach (string[] strings in values)
        {
            if (checkContents(sht, strings[0], strings[1])) return strings[2];
        }
        return null; //or throw not found error 
    } 
```

# sql - 几个表中的主键和外键关系

> ID：13464475
> 
> 赞同：1
> 
> 时间：2012-11-19T23:48:55.680
> 
> 标签：sql, foreign-keys, primary-key, constraints

我有一个关于 SQL 的问题。我有以下 SQL 表（为便于理解而简化）：

客户端（clientId INT PRIMARY KEY）

产品（productId 主键）

订单（orderId PRIMARY，clientId 是 Client 的外键，productId 是 Product 的外键）

我还有一个名为 Inventory 的表，它应该包含每种产品的库存商品数量。Inventory 的主键称为 productId（主键），它引用 Order 中的外键。不幸的是，当我尝试添加到 Inventory 表时，它给了我以下错误：

```
"The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Order_Iventory1". The conflict occurred in database "GestionInventaire", table "dbo.Inventory", column 'productId'." 
```

我希望 Inventory 表的主 ID (productId) 是 Order (productId) 中的外键，它来自 Product 表。

任何帮助表示赞赏！如果需要任何进一步的解释，我将尝试进一步详细说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:59:56.467

基于上面列出的 SQL 示例（SQL Server）：

```
create table client (
  clientid int not null primary key
)
create table product (
  productid int not null primary key
)
create table [order] (
  orderid int not null primary key,
  clientid int not null foreign key references client (clientid),
  productid int not null foreign key references product (productid)
)

insert into client values (1)
insert into product values (1)

insert into [order] values (1,1,1)  -- should work
insert into [order] values (2,1,2)  -- should fail

create table inventory (
    productid int not null foreign key references product (productid),
    stock int not null default 0
)

insert into inventory values (1,10)  -- worked with no problems 
```

外键引用检查它们的值是否存在于父表中 - 当您看到外键约束错误时，这意味着您尝试插入具有外键约束的列中的值在它引用的父表中不存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:10:02.683

> Inventory 的主键称为 productId（主键），它引用 Order 中的外键。

为什么？`Inventory`对我来说，如果主键 in引用主键 in会更有意义`Product`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T00:32:50.267

这取决于每种产品的库存信息有多复杂：

**仅存储每个产品的最新库存编号集**

If you are simply storing the current stock number(s) for each product (e.g. a one-to-one mapping of Product to Inventory), then there's no need for Inventory to have it's own table, it would make more sense to store the number in stock directly in the Product table.

Whilst there may be a logical division in your code model between the product information and the inventory data, that doesnt necessarily mean its a good idea to store the data in multiple tables unless you're handling huge amounts of data and performance is becoming an issue. Even if it's stored in a single table, you can still seperate the data into multiple objects as and when you query it and build your model objects.

(That's not to say there aren't legitimate situations where it might be a good idea to do this, but I wouldn't consider it unless there were no better alternatives)

**Storing multiple sets of stock numbers for each product**

If on the other hand you're wanting to store a history of the stock levels (a one-to-many mapping from Product to Inventory) then it would make sense to have an Inventory table, but I'd suggest giving it it's own primary key and having a foreign key from productID to the Product table.

e.g. Inventory table containing "InventoryID" (primary key), "ProductID" (foreign key to Product.ProductID) and whatever columns you need to store the stock numbers.

**Why Foreign key to Order table?**

Either way it doesn't really make any sense for Inventory.productID to be a foreign key to Order.productID, since the stock is related to a product, not an order (unless you're doing live calculations based on the quantities in and out in which case the structure would be a bit more complex).

# jquery - jQuery 图像滑块，为每个图像定义 href

> ID：13464483
> 
> 赞同：1
> 
> 时间：2012-11-19T23:49:47.807
> 
> 标签：jquery, slider, image, href

我为 www.edietty.com 的每个请求添加了一个特定的滑块，但它没有为每个图像分配 href 的变量。我的第一个想法是尝试单击以定向到确切的 URL，但是每当我尝试添加 href 时，它都会导致滑块不显示。我试图通过 $('#main_image').attr('src','image1.jpg') 进行设计，但是当整个滑块停止显示时，我决定崩溃并寻求帮助。

滑块来自 John Polacek [http://johnpolacek.github.com/ResponsiveThumbnailGallery/](http://johnpolacek.github.com/ResponsiveThumbnailGallery/)

html是：

```
<article><div id="gallery"></div></article> 
```

JQuery 是：

```
(function($) {

    $.ThumbnailGallery = function(el, options) {

        var isUnderBreakpoint,
            currImageNumber,
            imagesPath,
            imageWidth,
            imageHeight,
            thumbWidth,
            thumbHeight,
            gallery,
            view,
            mainImage,
            nav,
            thumbnails,
            buttons;

        var defaults = {
            thumbImages: 'img/thumbs/thumb',
            smallImages: 'img/small/image',
            largeImages: 'img/large/image',
            count: 5,
            thumbImageType: 'jpg',
            breakpoint: 600,
            imageType: 'jpg',
            shadowStrength: 1
        }

        var plugin = this;
        plugin.settings = {}

        var init = function() {
            plugin.settings = $.extend({}, defaults, options);
            this.el = el;

            gallery = $(el).empty();

            view = $('<div id="gallery-view"></div>');
            view.css('margin','0 auto -1px');

            nav = $('<div id="gallery-nav"></div>');
            nav
                .css('margin','0 auto')
                .css('position','relative')
                .css('background-color','#222');

            thumbnails = $('<div id="nav-thumbnails"></div>');
            buttons = $('<div id="nav-buttons"></div>');
            buttons
                .css('position','absolute')
                .css('top','0');

            gallery.append(view, nav);
            nav.append(thumbnails, buttons);

            isUnderBreakpoint = $(window).width() < plugin.settings.breakpoint;
            imagesPath = isUnderBreakpoint ?
                plugin.settings.smallImages : plugin.settings.largeImages;

            updateMainImage(1);

            for (var i=0; i<plugin.settings.count; i++) {

                var button = $('<a href="#" class="gallery-button"></a>');
                button
                    .css('display','block')
                    .css('float','left');

                var thumbImage = $('<img class="thumbnail-image" src="'+(plugin.settings.thumbImages)+(i+1)+'.'+plugin.settings.thumbImageType+'" />');
                thumbImage
                    .css('display','block')
                    .css('float','left');

                if (i===0) {
                    thumbImage.load(function() {
                        thumbWidth = this.width;
                        thumbHeight = this.height;
                        $('.gallery-button')
                            .css('width',this.width)
                            .css('height',this.height);
                        nav.css('height',thumbHeight);
                        thumbnails.css('height',thumbHeight);
                        updateSize();
                    });
                } else {
                    button
                        .css('box-shadow','0px 4px 8px rgba(0,0,0,'+ plugin.settings.shadowStrength +') inset')
                        .css('background-color','rgba(0,0,0,'+ plugin.settings.shadowStrength/2 +')');
                }

                thumbnails.append(thumbImage);
                buttons.append(button);
            }           

            buttons.delegate('.gallery-button', 'click', function(e){
                e.preventDefault();
                $('.gallery-button')
                    .css('box-shadow','0px 4px 8px rgba(0,0,0,'+ plugin.settings.shadowStrength +') inset')
                    .css('background-color','rgba(0,0,0,'+ plugin.settings.shadowStrength/2 +')');
                $(this)
                    .css('box-shadow','none')
                    .css('background','none');

                updateMainImage($(this).index()+1);
            });

            $(window).resize(function(e) {

                updateSize();
            });
        }

        function updateMainImage(imageNumber) {
            currImageNumber = imageNumber;
            mainImage = $('<img src="'+imagesPath+imageNumber+'.'+plugin.settings.imageType+'" id="main-image" />');
            mainImage.load(function() {
                view.empty().append(mainImage);
                updateSize();
            });
            $("<img/>") // Make in memory copy of image to avoid css issues
                .attr("src", $(mainImage).attr("src"))
                .load(function() {
                    imageWidth = this.width;
                    imageHeight = this.height;
                });

        }

        function updateSize() {
            if (thumbWidth && imageWidth) {
                var galleryWidth = gallery.width();

                // check breakpoint
                if (isUnderBreakpoint != $(window).width() < plugin.settings.breakpoint) {
                    // update main image
                    isUnderBreakpoint = $(window).width() < plugin.settings.breakpoint;
                    imagesPath = isUnderBreakpoint ?
                        plugin.settings.smallImages : plugin.settings.largeImages;
                    updateMainImage(currImageNumber);
                }

                // set main image size
                if (galleryWidth < imageWidth) {
                    mainImage
                        .css('width', galleryWidth)
                        .css('height','');
                } else {
                    galleryWidth = imageWidth;
                    mainImage
                        .css('width',imageWidth)
                        .css('height','');
                }

                // calculate number of rows
                var numThumbs = plugin.settings.count;
                var thumbSize = galleryWidth / numThumbs;
                var numRows = 1;
                var thumbScale = thumbSize / thumbWidth;
                var imageScale = galleryWidth / imageWidth;

                // if thumb is below scale threshold, add new row
                while (thumbScale < .5) {
                    numRows++;
                    thumbSize = (galleryWidth * numRows) / numThumbs;
                    thumbScale = thumbSize / thumbWidth;
                }

                // set thumbnail sizes
                var thumbsRemainder = numThumbs;        // tracks thumbs left to scale
                var thumbIndex = 0;                   // tracks thumb index to be scaled
                for (var i=0; i<numRows; i++) {

                    var numThumbsInRow = Math.ceil(thumbsRemainder / (numRows-i));
                    // scale thumbs in row
                    for (var j=0; j<numThumbsInRow; j++) {
                        thumbScale = (galleryWidth / numThumbsInRow) / thumbWidth;
                        var newWidth = thumbWidth * thumbScale;
                        var newHeight = thumbHeight * thumbScale;
                        $('.thumbnail-image:eq('+thumbIndex+')')
                            .css('width',newWidth)
                            .css('height',newHeight);
                        $('.thumbnail-image:eq('+thumbIndex+') img')
                            .css('width',newWidth)
                            .css('height',newHeight);
                        $('.gallery-button:eq('+thumbIndex+')')
                            .css('width',newWidth)
                            .css('height',newHeight);
                        $('.gallery-button:eq('+thumbIndex+') img')
                            .css('width',newWidth)
                            .css('height',newHeight);
                        thumbIndex++;
                    }
                    thumbsRemainder -= numThumbsInRow;
                }

            }

            // update view size
            view.width(galleryWidth);
            view.height(mainImage.height());

            // update nav size
            nav.width(galleryWidth);
            nav.height(thumbHeight * thumbScale * numRows);            
        }

        init();

    }

})(jQuery); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:00:41.053

该插件使用`thumbImages`,`smallImages`和`largeImages`路径，并附加了一个数字 from `1`to`count`和 the `imageType`or 。`thumbImageType`使用您的设置，您最终会得到以下拇指路径：

```
img/thumbs/thumb + count + .jpg:

img/thumbs/thumb1.jpg
img/thumbs/thumb2.jpg
img/thumbs/thumb3.jpg
img/thumbs/thumb4.jpg
img/thumbs/thumb5.jpg 
```

以及相应的小或大图像路径：

```
img/small/image1.jpg
img/large/image1.jpg 
```

如果您不希望缩略图和图像路径遵循类似的设置，则可以使用不同的插件为您提供更好的服务。

# c++ - 使用 fftw 和 opencv 进行 fft 可视化

> ID：13464485
> 
> 赞同：0
> 
> 时间：2012-11-19T23:49:53.907
> 
> 标签：c++, opencv, fftw

我使用以下代码使用 FFTW 和 OpenCV 生成傅立叶变换的可视化。但是，我只能正确获取图像的上半部分。任何人都可以解释代码是否有问题？

fft 存储 fftw_execute 数据。

```
int nl= fftvis->height; // number of lines
// total number of element per line
int nc= fftvis->width * fftvis->nChannels;

// get the pointer to the image buffer
unsigned char *data= reinterpret_cast<unsigned char *>
(fftvis->imageData);
k =0;
for (int x=1; x<nl; x++) {
    for (int y=0; y<nc; y+= fftvis->nChannels) {
        data[y] = 10*log(sqrt((pow(fft[k++][0],2) + pow(fft[k++][1],2))));
        //k+=1;
    } // end of line

    data+= step;
    // next line
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:57:23.160

您需要填充每个通道的 RGB，但是在`y+= fftvis->nChannels`执行时您正在跨通道数据。
此外，`data+= step;`会跳过`step`数据的字节，如果您正确对齐处理，这不是必需的。

# dataframe - OHLC 聚合器不适用于 Pandas 上的数据框？

> ID：13464492
> 
> 赞同：1
> 
> 时间：2012-11-19T23:50:13.883
> 
> 标签：dataframe, time-series, pandas

我不确定这是一个错误还是设计使然——也许我遗漏了一些东西，并且 ohlc 聚合器不应该与数据帧一起使用。也许这种行为是设计使然，因为除了索引列和价格列之外的数据框可能会产生奇怪的结果？其他聚合器（mean、stdev 等）使用数据框。无论如何，我正在尝试从这些数据中获取 OHLC，并且转换为时间序列似乎也不起作用。

这是一个例子：

```
import pandas as pd
rng = pd.date_range('1/1/2012', periods=1000, freq='S')

ts = pd.Series(randint(0, 500, len(rng)), index=rng)
df = pd.DataFrame(randint(0,500, len(rng)), index=rng)

ts.resample('5Min', how='ohlc') # works great
df.resample('5Min', how='ohlc') # throws a "NotImplementedError"

newts = pd.TimeSeries(df) #am I missing an index command in this line?
# the above line yields this error "TypeError: Only valid with DatetimeIndex or
  PeriodIndex" 
```

* * *

```
Full NotImplementedError paste:

NotImplementedError                       Traceback (most recent call last)
/home/jeff/<ipython-input-7-85a274cc0d8c> in <module>()
----> 1 df.resample('5Min', how='ohlc')

/usr/local/lib/python2.7/dist-packages/pandas-0.9.2.dev-py2.7-linux-x86_64.egg/pandas/core/generic.pyc in resample(self, rule, how, axis, fill_method, closed, label, convention, kind, loffset, limit, base)
    231                               fill_method=fill_method, convention=convention,
    232                               limit=limit, base=base)
--> 233         return sampler.resample(self)
    234 
    235     def first(self, offset):

/usr/local/lib/python2.7/dist-packages/pandas-0.9.2.dev-py2.7-linux-x86_64.egg/pandas/tseries/resample.pyc in resample(self, obj)
     66 
     67         if isinstance(axis, DatetimeIndex):
---> 68             rs = self._resample_timestamps(obj)
     69         elif isinstance(axis, PeriodIndex):
     70             offset = to_offset(self.freq)

/usr/local/lib/python2.7/dist-packages/pandas-0.9.2.dev-py2.7-linux-x86_64.egg/pandas/tseries/resample.pyc in _resample_timestamps(self, obj)
    189             if len(grouper.binlabels) < len(axlabels) or self.how is not None:
    190                 grouped = obj.groupby(grouper, axis=self.axis)
--> 191                 result = grouped.aggregate(self._agg_method)
    192             else:
    193                 # upsampling shortcut

/usr/local/lib/python2.7/dist-packages/pandas-0.9.2.dev-py2.7-linux-x86_64.egg/pandas/core/groupby.pyc in aggregate(self, arg, *args, **kwargs)
   1538         """
   1539         if isinstance(arg, basestring):
-> 1540             return getattr(self, arg)(*args, **kwargs)
   1541 
   1542         result = {}

/usr/local/lib/python2.7/dist-packages/pandas-0.9.2.dev-py2.7-linux-x86_64.egg/pandas/core/groupby.pyc in ohlc(self)
    384         For multiple groupings, the result index will be a MultiIndex
    385         """
--> 386         return self._cython_agg_general('ohlc')
    387 
    388     def nth(self, n):

/usr/local/lib/python2.7/dist-packages/pandas-0.9.2.dev-py2.7-linux-x86_64.egg/pandas/core/groupby.pyc in _cython_agg_general(self, how, numeric_only)
   1452 
   1453     def _cython_agg_general(self, how, numeric_only=True):
-> 1454         new_blocks = self._cython_agg_blocks(how, numeric_only=numeric_only)
   1455         return self._wrap_agged_blocks(new_blocks)
   1456 

/usr/local/lib/python2.7/dist-packages/pandas-0.9.2.dev-py2.7-linux-x86_64.egg/pandas/core/groupby.pyc in _cython_agg_blocks(self, how, numeric_only)
   1490                 values = com.ensure_float(values)
   1491 
-> 1492             result, _ = self.grouper.aggregate(values, how, axis=agg_axis)
   1493             newb = make_block(result, block.items, block.ref_items)
   1494             new_blocks.append(newb)

/usr/local/lib/python2.7/dist-packages/pandas-0.9.2.dev-py2.7-linux-x86_64.egg/pandas/core/groupby.pyc in aggregate(self, values, how, axis)
    730                 values = values.swapaxes(0, axis)
    731             if arity > 1:
--> 732                 raise NotImplementedError
    733             out_shape = (self.ngroups,) + values.shape[1:]
    734 

NotImplementedError: 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T10:48:15.670

您可以对单个列重新采样（因为每个列都是时间序列）：

```
In [9]: df[0].resample('5Min', how='ohlc')
Out[9]: 
                     open  high  low  close
2012-01-01 00:00:00   136   136  136    136
2012-01-01 00:05:00   462   499    0    451
2012-01-01 00:10:00   209   499    0    495
2012-01-01 00:15:00    25   499    0    344
2012-01-01 00:20:00   200   498    0    199

In [10]: type(df[0])
Out[10]: pandas.core.series.TimeSeries 
```

我不清楚这应该如何为更大的 DataFrames（多列）输出，但也许你可以制作一个面板：

```
In [11]: newts = Panel(dict((col, df[col].resample('5Min', how='ohlc'))
                                for col in df.columns))

In [12]: newts[0]
Out[12]: 
                     open  high  low  close
2012-01-01 00:00:00   136   136  136    136
2012-01-01 00:05:00   462   499    0    451
2012-01-01 00:10:00   209   499    0    495
2012-01-01 00:15:00    25   499    0    344
2012-01-01 00:20:00   200   498    0    199 
```

*注意：也许有一个用于重新采样 DataFrame 的规范输出，但它*尚未*实现？*

# json - 我应该使用什么格式在android中保存JSON数据

> ID：13464499
> 
> 赞同：1
> 
> 时间：2012-11-19T23:50:45.877
> 
> 标签：json

我应该以什么格式保存从服务器获取的 JSON 数据，以便稍后在 ListView 中填充它们？

二维数组是否足够或有更好的解决方案？

每个 JSON 对象都像：

```
 {"id":"1","title":"London"} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-19T09:42:24.120

您可以使用：

`Arraylist<ClassName> jsondata=new ArrayList<ClassName>`

这是一个例子：

```
public Class ClassName 
{

  string fname;
  string lname;

public void setfname(String fname)
{
  this.fname=fname;
}

public void setlname(String lname)
{
  this.lname=lname;
}

public String getlname(String lname)
{
  return lname;
}
public String getfname(String fname)
{
  return fname;
} 
```

可以这样保存。。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:53:39.943

您要将数据保存在哪里？如果它在首选项对象中，那么 JSON 本身就是一个不错的选择。否则 a`HashMap`将是合适的，并且比二维数组更好：更快、更合乎逻辑、更适合。

# grails - 相当于 SQL 的 Gorm

> ID：13464500
> 
> 赞同：1
> 
> 时间：2012-11-19T23:51:01.037
> 
> 标签：grails, grails-orm

简单的一个 - 在 Grails/Gorm 中获得与此 SQL 查询相同效果的最佳方法是什么：

SELECT YEAR(date) as SalesYear, MONTH(date) as SalesMonth, SUM(Price) AS TotalSales FROM Sales GROUP BY YEAR(date), MONTH(date) ORDER BY YEAR(date), MONTH(date)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T02:09:48.620

域类的[executeQuery方法允许您运行](http://grails.org/doc/latest/ref/Domain%20Classes/executeQuery.html)[HQL](http://grails.org/doc/latest/guide/single.html#hql)查询。

如果您查看一些示例，您会注意到[Hibernate 查询语言](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/queryhql.html)会记住很多 SQL，但它是面向对象的。

来自 Grails 文档：

> executeQuery 方法允许执行任意 HQL 查询。当查询选择单个字段或计算值时，HQL 查询可以返回域类实例或指定数据的数组。

因此，在您的情况下，查询将返回指定数据的数组，因为不匹配域类，但您将能够迭代此数据。

假设您将销售表映射为销售域类：

```
class Sales {
  Date date
  BigDecimal price
  ...
  static mapping = {
    ...
  }
}

def result = Sales.executeQuery("SELECT YEAR(date) as SalesYear, MONTH(date) as SalesMonth, SUM(Price) AS TotalSales FROM Sales GROUP BY YEAR(date), MONTH(date) ORDER BY YEAR(date), MONTH(date)")

//iterate over the result
result.each { sales ->
  println sales[0] //year
  println sales[1] //month
  println sales[2] //total
} 
```

# internet-explorer - AngularJS 数据绑定/模板在 IE 8 中不起作用

> ID：13464501
> 
> 赞同：0
> 
> 时间：2012-11-19T23:51:02.447
> 
> 标签：internet-explorer, angularjs

**更新：**

因此，这似乎是 IE 和 javascript 更新标题元素的问题。考虑到这一点，有谁知道如何解决这个问题？截至目前，我没有接受这个问题的答案，所以不妨深入了解一下。

**原始问题：**

我最近真的一直在深入研究 AngularJS 并喜欢它。但是，我遇到了一个重大问题。数据绑定/模板在 IE 8 中不起作用。我正在设置一个`$scope.pageTitle`在 my中调用的变量`MainController`，它适用于 Chrome 和 Firefox。在 IE 8 中，它显示`{{pageTitle}}`在标题栏中，我找不到任何有关如何解决此问题的信息。它让我发疯。任何人都可以帮助或指出我可能忽略的资源吗？如果真的需要，我可以做一个 jsfiddle 作为例子。

这是我的顶部`index.html`：

```
<!DOCTYPE html>
<html lang="en" ng-app="App" ng-controller="MainController">
    <head>
        <!-- Vendor JS Libraries -->
        <script type="text/javascript" src="lib/angular.js"></script>
        <script type="text/javascript" src="lib/underscore-min.js"></script>
        <script type="text/javascript" src="lib/jquery.js"></script>
        <!-- Bootstrap JS & CSS -->
        <script type="text/javascript" src="lib/bootstrap/js/bootstrap.js"></script>
        <link rel="stylesheet" type="text/css" href="lib/bootstrap/css/bootstrap.css">
        <!-- Lightbox  JS & CSS-->
        <script type="text/javascript" src="lib/lightbox/js/lightbox.js"></script>
        <link rel="stylesheet" type="text/css" href="lib/lightbox/css/lightbox.css">
        <!-- Application resources -->
        <script src="static/app.js"></script>
        <link rel="stylesheet" type="text/css" href="static/app.css">

        <title>{{pageTitle}} &ndash; Site Name</title>
    </head> 
```

我的`app.js`：

```
//AngularJS stuff
angular.module('App', []).
    config(function($routeProvider)
    {
        $routeProvider.
            when('/home', {templateUrl:'templates/home.html', controller:HomeController}).
            otherwise({redirectTo:'/home'})
    });

function MainController($scope){
    $scope.pageTitle = 'Default';

    $scope.setPageTitle = function(pageTitle){
        $scope.pageTitle = pageTitle;
    }
}

function HomeController($scope){
    $scope.setPageTitle('Home');
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:22:49.077

以为我会发布并回答，因为它以评论的形式出现。这似乎是 IE 和用 Javascript 修改标题标签的问题。我通过使用 IE 条件解决了这个问题

```
<!--[if !IE]> -->
<title>{{pageTitle}} &ndash; Site Title</title>
<!-- <![endif]-->

<!--[if IE]>
<title>Site Title</title>
<![endif]--> 
```

不理想，但它有效。

# c# - 使用包含动态 SQL 的存储过程在 C# 中创建报表（报表查看器）

> ID：13464503
> 
> 赞同：1
> 
> 时间：2012-11-19T23:51:09.933
> 
> 标签：c#, sql-server, stored-procedures, sql-server-2008-r2, reportviewer

我有一个 SQL Server 存储过程，我想用它在我的应用程序 (c#) 中创建报告。

因为过程中的表格是动态创建的，所以我无法使用它来创建报告。

如何使用此过程在我的应用程序中创建报告？

我正在使用 VS2010、SQL Server 2008 R2

我在 VS 中创建了一个数据集，但不知道如何从那里使用它。报表向导无法使用我创建的数据集。

我考虑过以某种方式使用它来创建一个视图，然后从中生成一个数据集，但无法弄清楚。

我希望我已经为某人提供了足够的信息来给我一些指导。

```
PROCEDURE sp_RD_Reporting_View_ExportedData_For_Period    
(   
@StartDate date,   
@EndDate date   
)  
AS  
CREATE TABLE #tmp  
(  
    StartDate DATETIME,  
    EndDate DATETIME,  
    FomatedDate VARCHAR(20)  
)  
--Calculate the date ranges   
;WITH Nbrs ( n ) AS (  
        SELECT 0 UNION ALL  
        SELECT 1+n FROM Nbrs WHERE n < 6 )  
INSERT INTO #tmp  
SELECT  
    DATEADD(DAY,-n,@StartDate),  
    DATEADD(DAY,-n,@EndDate),  
    convert(varchar, DATEADD(DAY,-n,@EndDate), 110)  
FROM  
    Nbrs  
ORDER BY  
    -n  
--The date columns for the pivot  
DECLARE @cols VARCHAR(MAX)  
SELECT  @cols = COALESCE(@cols + ','+QUOTENAME(FomatedDate),  
                     QUOTENAME(FomatedDate))    
FROM   
    #tmp  
--Declaring some dynamic sql and executing it  
DECLARE @query NVARCHAR(4000)=  
N'SELECT  
    *  
FROM  
(  
    SELECT   ExportData.EmployeeID AS EmpID,  
            ABRAempInfo.EmpFullName AS Name,  
            ExportData.PayType AS PayType,   
            tmp.FomatedDate,   
            SUM(ExportData.Quantity) AS Hours   
    FROM ExportData   
    JOIN ABRAempInfo    
    ON ExportData.EmployeeID = ABRAempInfo.EmpID  
    JOIN #tmp AS tmp  
    ON ExportData.ChargeDate = tmp.FomatedDate  
    WHERE ChargeDate BETWEEN tmp.StartDate AND tmp.EndDate  
    GROUP BY ExportData.EmployeeID, ExportData.PayType, tmp.FomatedDate,   ABRAempInfo.EmpFullName  

) AS p  
PIVOT  
(  
    SUM(Hours)  
    FOR FomatedDate IN ('+@cols+')  
) AS pvt'  

EXECUTE(@query)  
DROP TABLE #tmp 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:59:41.353

我遇到了一些我认为类似的事情——试图让 Linq to Sql 从使用动态 SQL 选择结果的存储过程中构建我的结果集。以下是我解决问题的方法......这是一个非常有效的解决方法，但您将无法真正让向导来处理动态结果集。另请注意，如果您的动态 sql 返回不同的列，则它不太可能工作。

1.  运行你的动态语句并只输出 SQL 语句（打印语句，不要执行它）
2.  修改您的存储过程以通过您从 #1 获得的 sql 语句返回输出
3.  您现在有一个标准的存储过程 - 使用它来构建您的报告。
4.  在您的报告经过测试并正常工作后，再次修改您的存储过程并重新插入动态 sql。

# ios - UIScrollview 第二次无法正确显示

> ID：13464506
> 
> 赞同：1
> 
> 时间：2012-11-19T23:51:28.657
> 
> 标签：ios, uiviewcontroller, uiscrollview

我有一个 UIScrollview 加载良好，显示良好，一切都很好。然后我推送另一个视图控制器，称之为 VC2，它也可以正常工作。从 VC2 我弹出回到 UIScrollview，这是奇怪的行为......当 UIScrollview 回来时，从顶部开始的第一个（我猜）300 像素被切断。如果我拉下页面，我仍然可以看到内容，但显然这对我不起作用。有人有什么想法吗？

这是代码：

这是创建 ScrollView：

```
-(IBAction)startNewSearch:(id)sender
{
NewSearch *VCscrollView = [[NewSearch alloc] init];
[[self navigationController] pushViewController:VCscrollView animated:YES];
} 
```

滚动视图

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    // Custom initialization
}
return self;
}

- (void)viewDidLoad
{
[super viewDidLoad];
scrollView.contentSize = CGSizeMake(320, 890);
[scrollView setContentOffset:CGPointMake(0, 0) animated:NO];
[scrollView flashScrollIndicators];
}

-(void)viewWillAppear:(BOOL)animated
{
scrollView.frame = CGRectMake(0, 0, 320, 890);
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
} 
```

从 ScrollView 中调用 VC2 的 IBAction：

```
-(IBAction)previewSearch:(id)sender
{   
VCcontactServer *VC2 = [[VCcontactServer alloc] init];
[[self navigationController] pushViewController:VC2 animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:40:52.050

正确答案的功劳归安德烈·索洛维耶夫所有，但不幸的是他没有发帖让我给他功劳。添加代码：

```
-(void)viewWillAppear:(BOOL)animated
{
scrollView.frame = CGRectMake(0, 0, 320, 890);
} 
```

fixed the problem as described. The root of the problem ended up being a little more complex and outside of the scope of my question.

# c++ - 如何在输出参数中使用基类

> ID：13464507
> 
> 赞同：0
> 
> 时间：2012-11-19T23:51:47.067
> 
> 标签：c++, inheritance, output-parameter

假设我有这样的代码：

```
class B {}
class D : class B {}

void MakeD(int params, D** out, int* status_out); 
```

今天我这样称呼它：

```
B* b;
if (use_d) {
  D* d;
  MakeD(params, &d, &status)
  b = d;
} else... 
```

有没有一种更简洁的方法来避免单独的“d”对象，但又不会失去现有的类型安全性（即没有 reinterpret_cast）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:58:47.170

有什么理由你不能只修改你的 MakeD() 方法来返回一个新的 D 而不是传递一个指向 D 的指针？

IE。

```
D* MakeD(int params, int* status_out);

...

b = MakeD(params, &status); 
```

还是 MakeD() 方法是其他人 API 的一部分？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:04:10.993

就像是

```
B *b = use_d ? new D(params) : new <something else>; 
```

应该管用。我假设*其他东西*可能是一个`B`对象（可能是使用不同的参数构造的？）。它需要是`B`或派生自`B`代码的类才能工作。

而且，一如既往，不要使用 raw `B*`，而是使用

```
std::unique_ptr<B> ptr( use_d ? new D(params) : new <something else> ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:00:26.707

为什么不使用基本的 C++ 特性，例如类构造函数和多态性：`B* b = new D(params);`

# sql - 将两个表的结果合并成一个没有公共数据的统一表

> ID：13464511
> 
> 赞同：0
> 
> 时间：2012-11-19T23:52:27.493
> 
> 标签：sql, join, insert, create-table

我已经阅读了很多关于合并表的示例，但大多数人都有可连接的内容。除了使用 FULL JOIN 之外，我没有任何可以连接的数据，这会留下多个具有相同名称的列和对应查询中没有数据的 NULL。

```
CREATE TABLE #tmpBus
(
id varchar(50),
partnumber varchar(400),
attributecname nvarchar(255),
attributevalue nvarchar(1700),
assetfilename varchar(85),
orderby varchar(10)
)

CREATE TABLE #tmpBus1
(
id varchar(50),
name varchar(500),
url varchar(2550),
assetfilename varchar(850),
orderby varchar(10)
)

CREATE TABLE #tmpBus2
(
partnumber varchar(400),
attributecname varchar(255),
attributevale varchar(1700),
orderby varchar(10),
assetfilename varchar(850),
name varchar(500),
url varchar(2550)
)

INSERT INTO #tmpBus exec getSectionNewData 5665976;

INSERT INTO #tmpBus1 exec getSectionFeaturedData 5665976;

SELECT DISTINCT * FROM #tmpBus tb
FULL JOIN #tmpBus1 tb1
ON tb.partnumber=tb1.name

DROP TABLE #tmpBus
DROP TABLE #tmpBus1
DROP TABLE #tmpBus2 
```

我的目标是从我创建的 2 个临时表 (#tmpBus & #tmpBus1) 中获取数据到一个统一表 (#tmpBus2) 中。我尝试了我能想到的所有类型的加入和分组方法。这是上述代码输出的屏幕截图。注意 NULL。我正在尝试使用每个表中的相应值将一个平面表放入#tmpBus2。因此，id、assetfilename 和 orderby 字段将统一，而不是 2 个单独的列以及按 orderby 列排序的能力。

![在此处输入图像描述](../Images/0c6f069a2c4dc1169d1a4a0ec51e3d50.png)

任何让我朝着正确方向前进的帮助都会非常有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T11:58:08.650

使用简单的 UNION 连接

```
SELECT id, partnernumber, attributecname, attributevalue, assetfilename, orderby, NULL AS url
FROM #tmpBus tb
UNION
SELECT id, name, NULL, NULL, assetfilename, orderby, url
FROM #tmpBus1 tb1
ORDER BY orderby 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:11:50.417

如果您只是想将多个列合并为单个列，则可能需要尝试以下操作：

```
SELECT 
--isnull(tb.id, tb1.id)                         Id
  isnull(tb.partnumber, tb1.name)               PartNumber
, tb.attributecname                             AttributeCName
, tb.attributevalue                             AttributeValue
, isnull(tb.orderby, tb1.orderby)               OrderBy
, isnull(tb.assetfilename, tb1.assetfilename)   AssetFilename
, isnull(tb1.name, tb.partnumber)               Name
, tb1.url                                       URL
FROM #tmpBus tb
FULL JOIN #tmpBus1 tb1
ON tb.partnumber=tb1.name 
```

在不了解您的数据/要求的情况下，我无能为力 - 如果您可以提供一些示例输入数据和预期输出，尽管我（或这里的某人）可以调整查询以满足您的需求。

# android - 阻止应用在 bluestacks、youwave 和其他模拟器中运行

> ID：13464517
> 
> 赞同：4
> 
> 时间：2012-11-19T23:53:33.693
> 
> 标签：android, android-emulator, blocking, bluestacks

我想阻止我的应用程序在 bluestacks/youwave 等模拟器中运行。无论如何我可以阻止甚至识别用户是否在 bluestacks/youwave 中运行？我的应用程序具有登录功能。所以它也使用服务器，所以我不介意在客户端/服务器端阻止用户，只要他被阻止。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-09T15:51:19.190

# 1：检查 SIM 号码并拒绝任何没有 SIM 号码的人访问。这包括平板电脑，因为您声明要阻止它们。

爪哇：

```
TelephonyManager telemamanger = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);
String getSimSerialNumber = telemamanger.getSimSerialNumber();
String getSimNumber = telemamanger.getLine1Number(); 
```

清单.xml：

```
<uses-permission android:name="android.permission.READ_PHONE_STATE"/> 
```

# 2.模拟器内核检查。

如果 #1 由于用户修改其模拟器而失败，请检查是否 (ro.kernel.qemu == 1)。此属性是只读的，对于模拟器将始终返回 1。

# php - 贝宝 - 成功 - 重定向不起作用

> ID：13464522
> 
> 赞同：0
> 
> 时间：2012-11-19T23:54:06.560
> 
> 标签：php, paypal, payment

我创建了一个沙盒 paypal 帐户并使用教程[http://www.micahcarrick.com/paypal-ipn-with-php.html](http://www.micahcarrick.com/paypal-ipn-with-php.html)中的 IPNListener 。在我的代码中，在验证贝宝响应后，尝试重定向到动态 url。paypal支付成功后，没有重定向到动态url

```
 include('ipnlistener.php');
    $listener = new IpnListener();
    $listener->use_sandbox = true;
    $listener->use_ssl = false;

    try {
        $listener->requirePostMethod();
        $verified = $listener->processIpn();
     } catch (Exception $e) {
     error_log($e->getMessage());
     exit(0);
     }
    $url1="http://www.google.com";
    $url2="http://www.ayond.se";
     if ($verified) {
      header('Location: '.$url1);
     }
     else
     {
           header('Location: '.$url2);
      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:14:02.917

听起来您混淆了 IPN 和 PDT。

IPN 与您的结帐页面完全分开，它是服务器到服务器的通信。PayPal 只是将数据发布到此 URL，您可以相应地处理该数据。这允许您自动执行数据库更新、电子邮件通知等任务。

但是，这不是在浏览器会话中发生的事情，因此重定向在这里不起作用。

为了设置用户完成付款后的去向，您需要在 API 调用中设置 ReturnURL，或在标准按钮表单代码中设置返回字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:10:37.563

确保标题之前没有任何内容（'Location: '.$url2); 称呼。（在您重定向之前，应该只是 php 代码）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:55:39.413

正确检查您的代码，成功时您将重定向到 $url，您没有 $url 您有 $url1

好的，不，您编辑了代码，它有效吗？

# ios - 在 UIWebView 中查看 PDF

> ID：13464525
> 
> 赞同：0
> 
> 时间：2012-11-19T23:54:37.653
> 
> 标签：ios, pdf, uiwebview

我的应用程序的“支持文件”文件夹包含一个名为`test.pdf`. 尝试使用以下代码查看 pdf 文件`ViewDidLoad`会显示一个空的 UIWebView：

```
NSString *testPath = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"pdf"];
NSURL *testURL = [NSURL URLWithString:testPath];
NSURLRequest *testRequest = [NSURLRequest requestWithURL:testURL];

UIWebView *documentWebView;

documentWebView = [[UIWebView alloc] initWithFrame:CGRectMake(10, 24, 300, 400)];

[documentWebView loadRequest:testRequest];

[self.view addSubview:documentWebView]; 
```

谁能告诉我为什么 PDF 没有显示在 Web 视图中？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:30:20.700

这一行：

```
NSURL *testURL = [NSURL URLWithString:testPath]; 
```

需要是：

```
NSURL *testURL = [NSURL fileURLWithPath:testPath]; 
```

# windows - 有没有办法在 SVN repo 中设置文件。结帐时自动忽略？

> ID：13464526
> 
> 赞同：4
> 
> 时间：2012-11-19T23:54:42.850
> 
> 标签：windows, svn, tortoisesvn, project

我想在我的 SVN 存储库中包含我的项目文件和其他配置文件。但不希望将更改提交回 repo。那么有没有办法在服务器/存储库上设置文件。结束，以便在签出时会自动忽略它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T23:56:49.577

解决这个问题的常用方法是不要将*真正的*配置文件放在存储库中。而不是拥有

```
config/whatever.cfg 
```

在您的存储库中，存储

```
config/whatever.cfg.example 
```

然后在您签出存储库并为您的本地环境设置它时手动复制`config/whatever.cfg.example`到。`config/whatever.cfg`

# json - 记录的数据验证

> ID：13464536
> 
> 赞同：2
> 
> 时间：2012-11-19T23:56:49.053
> 
> 标签：json, haskell, record, aeson, lenses

您是否知道任何 Haskell 库

1.  为记录**验证**和（！）提供了一些简化
2.  与**Aeson 合作**？

我知道我可以编写一些构造函数，但我想删除样板而不重新发明轮子。

我正在寻找的是以下内容：

我想为每个字段定义“合同”。例如：

```
data Person = Person {
     age   :: Integer
    ,email :: Text
    ,projects :: [Project]} 
```

现在，我想保证在我将 JSON 解析到记录中之后，以下内容成立：

1.  [0,Inf) 中的年龄
2.  电子邮件匹配“^[A-Z0-9._%+-]+@[A-Z0-9.-]+.[AZ]{2,6}$”
3.  项目至少包含 2 个项目

如果我尝试创建年龄 < 0 的记录，我将收到一条错误消息，例如“age=0 no in [0,inf)”。我认为应该可以通过模板 Haskell 派生这样的东西。

此外，我想将其集成到解析器阶段。因此，我不想收到一条错误消息，例如“当预期是一个 Integral，而是遇到了 String”，我想收到一条错误消息，

1.  显示错误的位置（不确定 attoparsec 是否可行）
2.  描述错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T22:51:23.263

看起来 ocharles 正是创造了这样一个包！[http://hackage.haskell.org/package/digestive-functors-aeson](http://hackage.haskell.org/package/digestive-functors-aeson)

# python - 搜索长的连续重复子串

> ID：13464539
> 
> 赞同：1
> 
> 时间：2012-11-19T23:56:56.550
> 
> 标签：python, algorithm, substring

我有一串0和1。将“连续双精度”定义为立即重复的子字符串。例如，字符串“011101010101110”可以分解为“011 1010 1010 1110”，可以压缩为“011(1010)1110”。

是否有一个很好的算法来查找字符串中的所有连续双精度数？我能想到的最好的结果是关于字符串长度的二次方：

```
def all_contiguous_doubles(s):
    for j in range(len(s)):
        for i in range(j):
            if s[i:j] == s[j:2*j - i]:
                print "%s(%s)%s" % (s[:i], s[i:j], s[2*j - i:]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T02:20:48.187

在这里，我提出了我的动态编程解决方案，它的时间复杂度为**O(n^2)**，空间复杂度为 O(n^2)，其中 n 是原始字符串的长度。

下面我递归地定义函数 dl(r,c)。如果你把 dl(r,c) 做成一个表格并**按照正确的顺序填写**，你将在 O(n^2) 中完成它。

定义：

> char(i) = 位置 i 处的字符
> 
> substr(i) = 从位置 i 开始到原始字符串末尾的子字符串。
> 
> dl(r,c) = substr(r) 和 substr(c) 的公共、非重叠前缀的长度。

dl(r,c) 的递归定义：

> 由于 dl(r,c) 是对称的，我们只考虑 r <= c。
> 
> 当 r == c 时，dl(r,c) = 0。因为如果子字符串从同一点开始，它将始终重叠。
> 
> 当 char(r) != char(c) 时，dl(r,c) = 0。因为前缀不一样。
> 
> ```
> if char(r) == char(c),
>     if dl(r+1,c+1) + 1 < c-r
>         dl(r,c) = dl(r+1,c+1) + 1
>     else
>         dl(r,c) = dl(r+1,c+1) 
> ```

其中最大的`dl(r,c)`将`dl(r,c) == c-r`是你的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T01:12:42.777

我会使用正则表达式 jan 提到`/(.+)$1/`

这是一个简单的算法，否则可能会起作用：

创建一个函数

```
get_largest(string, i, j) 
```

它返回 i 和 j 之间的最大双精度。

我会使用 min(20, (ji)//2) 的 hash_size

现在说你的 hash_size 是 20，找到长度为 20 的最不常见的子串以及它出现的所有位置。（这可以通过哈希表快速完成）

现在假设它被发现的位置是 [10, 110, 320, 500, ..] 看看 string[10:110], string[110, 320], string[320, 500].. 等等。如果有的话这些子字符串出现多次，找到这些子字符串的所有位置，并使用上面的技术或修改版本检查是否有双精度。

如果您仍然没有找到包含长度为 20 的最不频繁子串的双精度数，我们现在可以递归地分治来搜索所有不包含最不频繁子串的最长子串。

希望在大多数情况下，这应该很快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T06:39:32.453

如果压缩确实是您的最终目标：

为什么不使用大小为 16 的查找表将字符串“0000”“0001”、“1010”等映射到它们各自的十六进制数“0-F”？

存储表示时：将二进制字符串转换为十六进制字符串序列？

您可能还想查找[格雷码](http://en.wikipedia.org/wiki/Gray_code)。其中在二进制序列中，前一个数字和当前数字恰好相差 1 位。

如果我们在表中有 0-F 的格雷码表示，则：

对于十六进制字符串中的字母：检查前一个或当前字母是否是“格雷码”顺序中的对应字母。如果是这样，您可以进一步压缩它。（不同的位也可以在中间 - 有些情况必须妥善处理'）

# git - 跳到 git diff 中的下一个修改文件？

> ID：13464540
> 
> 赞同：55
> 
> 时间：2012-11-19T23:57:00.230
> 
> 标签：git

我犯了一个错误，将 Visual Studio 项目从 2008 年升级到 2010 年，而没有先检查我以前的更改。因此，我有一个巨大的系统生成文件（10k+ 行），每 4 行就更改一次。

我通常很擅长经常检查东西，所以我通常只会使用向下键来滚动浏览我的更改。在这种情况下，滚动浏览系统生成文件的更改将需要几个生命周期。

有没有办法在你完成之后跳到下一个修改过的文件，`git diff`这样你就不必滚动浏览每个文件的每一个更改？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-11-19T23:59:16.060

默认情况下，`git diff`它的输出通过`less`. 因此，您可以使用`less`命令来搜索下一个标题。键入`/^diff`并按下`Enter`以跳到下一个文件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-04-17T14:41:35.267

在 中时`git diff`，只需点击`n`即可直接进入下一个文件，然后再次进入下一个文件，依此类推。

您也可以使用`N`返回文件。

（要使这些命令起作用，您需要先键入`/^diff`并按`Enter`，如[本答案](https://stackoverflow.com/a/13464561/738675)中所述。）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-08-13T18:20:32.523

对于其他有用的命令，请键入`h`寻求帮助（在 中`git diff`，即在 中`less`）。

尤其：

```
 JUMPING

  g  <  ESC-<       *  Go to first line in file (or line N).
  G  >  ESC->       *  Go to last line in file (or line N).
  p  %              *  Go to beginning of file (or N percent into file).
  t                 *  Go to the (N-th) next tag.
  T                 *  Go to the (N-th) previous tag.
  {  (  [           *  Find close bracket } ) ].
  }  )  ]           *  Find open bracket { ( [.
  ESC-^F <c1> <c2>  *  Find close bracket <c2>.
  ESC-^B <c1> <c2>  *  Find open bracket <c1> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-20T04:18:04.310

我建议你使用[`tig`](http://jonas.nitro.dk/tig/ "老虎主页"). 这是一个诅咒界面`git`，而且是一个非常好的界面。

您可以查看索引状态，并且通过`tig status`按下`Enter`任何文件，您会看到它的差异。`h`向您显示帮助菜单，但它是基于 vi 快捷方式的界面。

我认为在任何基于 debian 的发行版中，您都可以`apt-get install`使用它，或者您可以从链接的站点制作它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T00:14:08.400

另一种选择是调用[`update-index`](http://www.kernel.org/pub/software/scm/git/docs/git-update-index.html)命令并告诉它假装一个巨大的文件没有改变。[这里](http://gitready.com/intermediate/2009/02/18/temporarily-ignoring-files.html)有一个更完整的例子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-16T17:03:29.590

我想你想要：

```
:n                *  Examine the (N-th) next file from the command line. 
```

请在 的帮助中查看此内容`less`。

```
 CHANGING FILES
:e [file]            Examine a new file.
^X^V                 Same as :e.
:n                *  Examine the (N-th) next file from the command line.
:p                *  Examine the (N-th) previous file from the command line.
:x                *  Examine the first (or N-th) file from the command line.
:d                   Delete the current file from the command line list.
=  ^G  :f            Print current file name. 
```

# php - 在 html 中使用 javascript 和 php。大规模混乱

> ID：13464543
> 
> 赞同：0
> 
> 时间：2012-11-19T23:57:34.320
> 
> 标签：php, javascript, html

我正在尝试制作一个可以在移动设备上运行的 php 文档。我们有一些 javascript 在应用程序顶部显示导航按钮。我的 php 文档应该显示在按钮的正下方。它应该是一个相当简单的页面，但我挣扎得很厉害。我试图简单地调用一个设置变量的函数。我想使用这个变量来显示使用该应用程序的人拥有的金额。我遇到了函数和变量的问题。我被告知 html 不能使用变量或函数，所以我需要闯入 php 并使用 "echo functionName(); 所以：声明函数，调用函数来设置变量，在 div 内的页面上显示变量。任何帮助将不胜感激。这是我的代码。：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<?php

?>
<html>
<head>

    <script type="text/javascript">
    //int $availableBal;
    //int $currentHoldings;
    function int getBalance();
    {

        int $availableBal = 500;
        //alert("you have " + $availableBal + " dollars to spend");
        return $availableBal;
    }

    function void getHoldings()
    {
        int $MSFT_Shares = 5;
        int $MFST_Price= 100;
        int $currentHoldings = $MSFT_Shares * $MSFT_Price;
        return $currentHoldings;
    }
    </script>   
    <style>
html {text-align:center}
</style>
</head>
<body>
    <div id="totalMoney" align="center" style= "border:1px solid grey">         
            You have a current balance of: $ <?php 'echo getBalance();' ?> 
            <br>
            <!--The total worth of your current stocks is: $ <script type="text/javascript"> document.write(getHoldings();)</script> -->
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:14:23.930

您将两种语言混合在一起。Javascript 是客户端应用程序，而 PHP 是服务器端应用程序。

所有这一切都可以通过两者来实现，我已经模拟了一个在 javascript 中为您工作的模型，并带有一些 jquery 用于显示。 [http://jsfiddle.net/Nj3ce/](http://jsfiddle.net/Nj3ce/)

```
<!DOCTYPE >
<html>
<head>
    <script text="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
           //on document load this function will be fired
           //automatically runs getHoldings();
           var holdings = getHoldings();
            $('#totalMoney span').text(holdings);
        });

        function getBalance(){
            var availableBal = 500;
            return availableBal;
        }

        function getHoldings(){
            var MFST_Shares = 5;
            var MFST_Price = 100;
            var currentHoldings = MFST_Shares * MFST_Price;
            return currentHoldings;
        }​
    </script>
    <style type="text/css">
        html {text-align:center}​
    </style>
</head>
<body>
    <div id="totalMoney" align="center" style= "border:1px solid grey">         
            You have a current balance of: $<span></span>
            <br>
    </div>
</body>
</html>​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:22:31.297

您不在 javascript 中声明数据类型。（即`function int`，`int $availableBal`）。这一切都可以在 PHP 中完成。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<?php
    // Should really put this in an external file
    function getBalance()
    {
        $iAvailableBal = 500;
        return $iAvailableBal;
    }

    function getHoldings()
    {
        $iMSFTShares = 5;
        $iMSFTPrice = 100;
        $iCurrentHoldings = $iMSFTShares * $iMSFTPrice;
        return $iCurrentHoldings;
    }
?>
<style type="text/css">
/* Should really put this in an external file */
html {text-align:center}
</style>
</head>
<body>
    <div id="totalMoney" align="center" style= "border:1px solid grey">         
            You have a current balance of: $ <?php echo getBalance(); ?> 
    </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:03:03.483

在这种情况下，您应该尝试在每种语言中单独声明函数。所有你想做的事情都可以只用 php 来完成。为了清洁起见，请在 php.ini`<!DOCTYPE>`上方移动。另外，包含一个包含所有代码的单独文件，并让 html 使用更少的 css/javascript/php

# javascript - jshint 输出在文件中看起来错误，但在控制台中正确

> ID：13464544
> 
> 赞同：1
> 
> 时间：2012-11-19T23:57:40.063
> 
> 标签：javascript, jslint, jshint

我在一个非常简单的文件上运行 jshint，看起来像

```
if ( 1 == 2 ) {
} 
```

输出看起来有点奇怪。我将文本输出到日志文件，这就是日志的样子

```
^[[4mRunning "lint:files" (lint) task^[[24m
Linting src/bad.js...^[[31mERROR^[[39m
^[[31m[^[[39m^[[33mL1^[[39m^[[31m:^[[39m^[[33mC8^[[39m^[[31m]^[[39m ^[[33mExpected '===' and instead saw '=='.^[[39m
if ( 1 ^[[31m^[[7m=^[[27m^[[39m= 2 ) { 
```

但是如果我将它打印到控制台它看起来像

```
Linting src/bad.js...ERROR
[L1:C8] Expected '===' and instead saw '=='.
if ( 1 == 2 ) { 
```

任何想法为什么文件版本看起来很奇怪？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-24T06:30:17.313

Grunt 可以`--no-color`选择移除着色，因此：

```
grunt --no-color myJSHintTask 
```

将输出没有 ANSI 彩色代码；）

[**在这里**](https://github.com/gruntjs/grunt/issues/510)了解更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:01:43.637

这些是控制台颜色命令。

看看[这个答案](https://stackoverflow.com/questions/2616906/how-do-i-output-coloured-text-to-a-linux-terminal)作为参考

# jquery - 我无法在日期选择器中显示最后选择的日期

> ID：13464546
> 
> 赞同：2
> 
> 时间：2012-11-19T23:57:50.080
> 
> 标签：jquery, datepicker

我有这个脚本

> var day_name = $("#d_day_name").val(); var month_name = $("#d_month_name").val(); day_name = day_name.split(","); 月名 = 月名.split(",");

```
 $(".datepick").datepicker({
            dateFormat: 'yy-mm-dd',
            dayNamesMin: [day_name[0],day_name[1],day_name[2],day_name[3],day_name[4],day_name[5],day_name[6]],
            monthNames: [month_name[0],month_name[1],month_name[2],month_name[3],month_name[4],month_name[5],month_name[6],month_name[7],month_name[8],month_name[9],month_name[10],month_name[11]],
            closeText: $("#d_close_text").val(),
            prevText: $("#d_prev_text").val(),
            nextText: $("#d_next_text").val(),
            currentText: $("#d_current_text").val()
        });
        $("#btnAddPrice").click(function () {
            var $tbody = $("#tblPrices tbody"),
                h = $tbody.find("tr:last").find("td:first").html(),
                i = (h === null) ? 0 : parseInt(h);
            $tbody.append('<tr id="tr_' + (i + 1) + '"><td>' + (i + 1) + '</td><td><input type="text" name="date_from[]" class="text w80 pointer datepick" readonly="readonly" /></td><td><input type="text" name="date_to[]" class="text w80 pointer datepick" readonly="readonly" /></td><td><input type="text" name="price[]" class="text_small align_right" /></td><td><input type="text" name="weekprice[]" class="text_small align_right" /></td><td><a class="icon icon_delete" href="#" onclick="$(\'#tr_' + (i + 1) + '\').remove(); return false;">delete</a></td></tr>'); 
```

$tbody.find("tr:last").find(".datepick").datepicker({dateFormat:"yy-mm-dd"}); });

我试图把 new Date(+1) 所以日期选择器将从最后选择的日期开始，放入日期选择器而不是 dateFormat 但那不起作用。而且我似乎无法弄清楚我能做些什么来完成这项工作。我查遍了整个网络，但没有找到答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T02:51:27.867

您正在引用表格单元格 ( `td`) 而不是日期选择器 ( `input`)。这意味着您需要使用`.val()`. 如果您引用`td`并使用`.html()`，它将返回，`<input class='datepick' />`因为您正在获取单元格的内容。

要在日期选择器中查找当前值，您需要执行以下操作：

```
 $tbody.find("tr:last").find("td:first").find(".datepick").val() 
```

要设置另一个日期选择器的值，请使用：

```
$tbody.find("tr:last").find(".datepick").datepicker({dateFormat:"yy-mm-dd"}).val('PUT DATE HERE'); 
```

希望这可以帮助！

***编辑：***

参考这个：http : [//api.jqueryui.com/datepicker/#option-defaultDate](http://api.jqueryui.com/datepicker/#option-defaultDate)

要更改默认日期，请执行以下操作：

`$tbody.find("tr:last").find("td:first").find(".datepick").datepicker({ defaultDate: +1 });`

# node.js - node.js - coffeescript 编译器的奇怪行为

> ID：13464552
> 
> 赞同：3
> 
> 时间：2012-11-19T23:58:16.130
> 
> 标签：node.js, coffeescript

我注意到咖啡脚本编译器对我来说有一个无法解释的行为:)

例如：

```
getImage: (req, res) =>
    realty_id = req.query.id

    if (realty_id?) 
```

结果

```
ImageController.prototype.getImage = function(req, res) {
    var realty_id,
        _this = this;
      realty_id = req.query.id;
      if ((realty_id != null) 
```

但实际上最后一行应该是： if ((typeof realty_id !== "undefined" && realty_id !== null))

当我注释掉“realty_id = req.query.id”时，它运行良好。有没有人对此作出解释？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T01:26:46.470

**tldr;** *本地*JavaScript 变量`typeof x !== "undefined"`不需要。

 *SO问题[CoffeeScript Existential Operator，这](https://stackoverflow.com/questions/9992620/coffeescript-existential-operator-and-this)有关于*为什么*CoffeeScript会进行这种优化的信息。

现在，看看为什么它在本例中是*有效*的代码生成：

```
-> x         x != null   typeof x !== "undefined" && x !== null
----------   ---------   -------------------------------------
ANY_TRUE     true        true
0            true        true
null         false       false
undefined    false       false 
```

因此，根据逻辑表，它们在语义上是等价的。操作员的“非严格”性质`==`决定了这种比较的结果——也许令人惊讶——：关于这个主题的问题比比皆是。

`typeof x !== "undefined"`但是，有时使用when/why 的重要区别在于：它*不会*导致`ReferenceError`. 如果`x`已知是*局部变量*，则无需考虑，`!=`可以安全地使用较短的 ( ) JavaScript 表达式。

在 CoffeeScript 中的赋值被注释掉的情况下，*没有*局部变量/名称绑定`reality_id`——注意`var`语句也不同——CoffeeScript 会根据需要插入额外的保护。*

# php - 当您将数据存储到 mysql 中的 VARCHAR 时，它是否考虑返回？还是只存储一段文本？

> ID：13464556
> 
> 赞同：1
> 
> 时间：2012-11-19T23:58:49.843
> 
> 标签：php, html, mysql

我正在使用 VARCHAR 为博客文章存储文本，我想知道它是否会考虑文本中的返回，或者只是将信息存储为一大块文本？

旁注：我没有使用所见即所得，因为我不希望博客用户能够为他们的文章设置样式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:00:17.313

是的，'return' 仍然是一个换行符，因此将被存储。它本质上存储为 \n （新行）

但是，如果您要存储大量文本，则应该考虑使用“TEXT”或“BLOB”格式，而不是 VARCHAR

有关这些类型的更多信息，请参阅文档：[http ://dev.mysql.com/doc/refman/5.0/en/blob.html](http://dev.mysql.com/doc/refman/5.0/en/blob.html)

# zooming - 在 Flash 中缩放、平移和拖动符号

> ID：13464557
> 
> 赞同：1
> 
> 时间：2012-11-19T23:59:00.493
> 
> 标签：zooming, flash-cs5, drag, symbols, pan

我正在尝试修改此脚本[http://www.flashandmath.com/howtos/zoom/](http://www.flashandmath.com/howtos/zoom/)以使用符号而不是位图图像。也接受加载 .swf 文件。请指教，如何实现。

我还需要使用鼠标滚轮进行缩放，但我认为我可以处理这部分。

任何帮助将不胜感激！

谢谢，戴安娜

# java - DynamoDB 中的一对多与 Java 对象持久性模型

> ID：13464560
> 
> 赞同：3
> 
> 时间：2012-11-19T23:59:11.007
> 
> 标签：java, nosql, amazon, amazon-dynamodb

是否可以使用 DynamoDB Java 持久性模型在两个表之间创建关系？

我有一个帖子到很多评论的关注关系

```
@DynamoDBTable(tableName="Post_MyApp")
public class Post {

private String id;
private String title;
private Set <Comment> comments;
//... Getters and setters and dynamo annotations
} 
```

我有一个单独的评论表，该评论是另一个发电机表/实体。我的想法是创建一个 post_comments 表，就像在 SQL 中一样，其中包含帖子的所有评论。这是使用 Dynamo 执行此操作的正确方法，还是有其他方法可以做得更好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-11T13:53:01.077

一篇文章多评论。您只需要以下表格：1\. Post 表：post-id（Hash Key），2\. Comment 表：post-id（Hash Key），comment-id（Range Key）

要获取帖子的所有评论，只需提供 HashKey（post-id）即可查询评论表。

在 Java 方面，您将使用 Dynamo DB Mapper 映射 2 个类（Post、Comments）。

DynamoDBMapper（AW​​S SDK for Java - 1.7.1）：[http ://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/dynamodb/datamodeling/DynamoDBMapper.html](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/dynamodb/datamodeling/DynamoDBMapper.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T14:45:01.043

我根本不了解 Java SDK，但从设计的角度来看，我可以建议您采用“DynamoDBier”方法吗？

### 桌子`Post_MyApp`

*   article_id 为`hash_key`
*   标题
*   ...

### 桌子`Comments_MyApp`

*   article_id 为`hash_key`
*   日期时间为`range_key`
*   文本
*   ...

这使您可以在一篇文章中获取所有评论，`Query`甚至可以使用`limit`和进行分页`ExclusiveStartKey`

顺便说一句，我在 DynamoDb 文档的附录中找到了很好的示例：http: [//docs.amazonwebservices.com/amazondynamodb/latest/developerguide/SampleTablesAndData.html](http://docs.amazonwebservices.com/amazondynamodb/latest/developerguide/SampleTablesAndData.html)

# database - EtherPad 是否为大文件发送所有变更集？

> ID：13464565
> 
> 赞同：1
> 
> 时间：2012-11-19T23:59:44.417
> 
> 标签：database, real-time, etherpad

假设有一个巨大的文件，其中更改的数量是巨大的，因此变更集的集合是巨大的。EtherPad 是否发送所有变更集？还是它会定期对文件进行快照，以避免发送真正旧的变更集？这一切是如何在后端数据库中实现的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T05:18:10.783

重新发送变更集请参阅：[https ://github.com/ether/etherpad-lite/tree/master/doc/easysync](https://github.com/ether/etherpad-lite/tree/master/doc/easysync)

没有文件可以拍摄快照，所以我假设您的意思是填充内容？如果是这样，不，Etherpad Lite 还没有保存元文本，但这是 Etherpad 可能需要实现的东西，以便时间滑块可以处理大内容的 pad（请参阅讨论此问题的相关问题）。旧的 Etherpad 确实有这个功能，但它是有代价的（可怕的数据库模式）。

Etherpad 数据库是通过称为 UeberDB [https://github.com/Pita/ueberDB](https://github.com/Pita/ueberDB)的东西抽象出来的。UeberDB 给 Etherpad 带来的最大胜利是在写入和可移植性之前的缓存层。UeberDB 使 Etherpad 能够将填充内容保存在内存中，并且不需要持续数据库写入的开销，写入排队以减少服务器负载。UeberDB 还允许站点管理员使用他们最喜欢的数据库，但代价是必须存储 KV。

RE 点 2 和 3，因为 Ueber 只会存储键值，您最终会在执行诸如全文索引之类的任务时遇到困难，这是 MySQL 的一个关键特性，尽管使用 MySQL 作为后端数据库。然而，最近已经克服了这一问题，并在 Mozilla 和其他各种 Etherpad 项目贡献者部分维护的分支中。MySQL 还提供了它自己的缓存功能，但这对 Etherpad 没有用，因为数据处于不断变化的状态。

我们应该清楚我一直在谈论 Etherpad Lite，因为不再维护“旧 Etherpad”，因此应该避免使用。所有 Etherpad 文档都应参考[http://etherpad.org的权威来源](http://etherpad.org)

# ruby - 延迟作业未在开发机器中运行

> ID：13464569
> 
> 赞同：3
> 
> 时间：2012-11-20T00:00:14.843
> 
> 标签：ruby, ruby-on-rails-3, delayed-job

我试图在我的开发环境中运行`rake jobs:work`或从控制台`Delayed::Worker.new.start`启动 DelayedJob 进程，但我遇到了这个奇怪的错误：

```
Loading development environment (Rails 3.2.8)
1.9.3-head :001 > Delayed::Worker.new.start
Moped::Errors::OperationFailure: The operation: #<Moped::Protocol::Command
  @length=410
  @request_id=2
  @response_to=0
  @op_code=2004
  @flags=[]
  @full_collection_name="hapievents.$cmd"
  @skip=0
  @limit=-1
  @selector={:findAndModify=>"delayed_backend_mongoid_jobs", :query=>{"run_at"=>{"$lte"=>2012-11-19 23:52:23 UTC}, "failed_at"=>nil, "$or"=>[{"locked_by"=>"host:Nunix-Netbook pid:11867"}, {"locked_at"=>nil}, {"locked_at"=>{"$lt"=>2012-11-19 19:52:23 UTC}}]}, :new=>true, :sort=>{"locked_by"=>-1, "priority"=>1, "run_at"=>1}, :update=>{"$set"=>{:locked_at=>2012-11-19 23:52:23 UTC, :locked_by=>"host:Nunix-Netbook pid:11867"}}}
  @fields=nil>
failed with error "no such cmd" 
```

我认为问题出在Mongo上。我正在使用 gem `delayed_job_mongoid`。一开始我以为是某个工作的问题，但现在我的工作列表是空的，我无法启动 DelayedJob*服务器*。

# javascript - 如何使用映射函数在淘汰赛中访问可观察数组

> ID：13464577
> 
> 赞同：0
> 
> 时间：2012-11-20T00:00:39.073
> 
> 标签：javascript, knockout.js, knockout-mapping-plugin

我正在使用 knockout.js 的映射函数来映射我从服务器端 asp.net 应用程序接收到的 json 对象。使用 Chrome 的调试器，我可以看到接收到的 json 对象很好，但是当我使用 ko.mapping.fromJS 创建一个可观察对象时，所有内部可观察数组都显示为长度 0。在 QCTest 中有多个数组。

```
var testDefJSON = getTestDefJSON();
var ViewModel = function () {
    var self = this;
    self.QCtest = ko.mapping.fromJS(testDefJSON);
    self.hasBuiltNewGroup = ko.observable(false);
    self.selectedOp = ko.observable();
    self.selectedUom = ko.observable();
    self.addTestGroup = function () {
        show_modal("createGroupModal");
    };
    self.saveTest = function () {
        var jsData = ko.toJS(ViewModel);
        var json = JSON.stringify(jsData);
        $.ajax({
            type: 'POST',
            url: '/Test/SaveTest',
            async: false,
            data: json,
            contentType: "application/json",
            success: function (result) { alert(result) },
            error: function () { alert("failed to post test data"); }
        });
    };
    self.delItems = function () {
        alert(self.QCtest.QCTestGroups.length);
    };
    self.closeItemModal = function () {
        ViewModel.hasBuiltNewGroup(false);
        close_modal();
    };
    self.createNewGroup = function () {
        ViewModel.hasBuiltNewGroup(true);
    };
    self.addNewTestItem = function () {
        alert("Adding new test item button works");
    };
};
var viewModel = new ViewModel();
ko.applyBindings(viewModel); 
```

当在内部数组上使用 foreach/template 时，我的所有 UI 元素都会显示出来。然而，当我单击我的 delItems 按钮时，会弹出警报并指出内部数组 QCTestItems 的长度为 0，而它应该至少为 1（但是数组中有许多测试项目）。

当您按下 delItems 按钮时，我需要能够删除检查的项目。为此，我需要访问该数组中的元素，并且由于它的长度为 0，因此很难做到这一点。

任何帮助将非常感激

编辑：

改为`self.delItems = function () { alert(self.QCtest.QCTestGroups.length); };` _`self.delItems = function () { alert(self.QCtest.QCTestGroups().length); };`

现在它可以工作了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:23:04.887

映射插件会将您的 JSON 转换为 Observables。Observable（包括 ObservableArray）是一个函数，因此请确保使用 () 形式访问实际值：

```
alert(self.QCtest().QCTestGroups().length); 
```

这是一个要演示的小提琴：http: [//jsfiddle.net/jearles/cH7h3/](http://jsfiddle.net/jearles/cH7h3/)

加载选项后单击按钮。显示的警报显示了两个长度值，一个直接访问数组（将显示长度为`0`），另一个访问内部数组（显示实际长度为`2`）。

# java - 加载 .dat 文件并读取

> ID：13464578
> 
> 赞同：1
> 
> 时间：2012-11-20T00:00:42.580
> 
> 标签：java, datareader, lua-loadfile

我有文本 .dat 文件，我从我的主类加载这个文件并读入我的 DataReader 类。但我收到错误，我必须将修饰符更改为静态。我不能这样做，因为它必须是非静态的。

我被困在这里，不起诉我的问题是在这里还是其他地方。你会检查我的代码并让我知道它是否可以吗？下一行也不存储在车辆中并显示为空！！

此代码得到错误：

```
if(DataReader.loadData(args[0])) {   // i get errors here 
```

并要求我将其更改为：（`public static boolean loadData(String VehicleData) { /// but this code has to be non-static...`我的教授要求）

主类：

```
public class Project3 {

private static Vehicle[] vehicles;
static int x;

public static void main(String[] args) {
    // Display program information

    DataReader reader = new DataReader(); // The reader is used to read data from a file

    // Load data from the file
    **if(DataReader.loadData(args[0]))** {   // i get errors here

        vehicles= reader.getVehicleData(); // this line also shows null

        // Display how many shapes were read from the file
        System.out.println("Successfully loaded " + vehicles[0].getCount() + 
                           " vehicles from the selected data file!");
        displayMenu();
    }
} 
```

数据读取器类：

```
ublic boolean loadData(String VehicleData) {
    boolean validData = false;
    String line;

try{
// Open the file
    BufferedReader reader = new BufferedReader(new FileReader("VehicleData.dat"));
//Read File Line by line

        while((line=reader.readLine()) !=null) {
            addVehicle(line.split(","));
        }
        reader.close();
        vehicles = Array.resizeArray(vehicles, vehicleCount);
        validData = true;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:02:40.583

您可能应该使用之前创建该行的`DataReader`实例 ( )：`reader`

```
 DataReader reader = new DataReader(); // The reader is used to read data from a file

    // Load data from the file
    if(reader.loadData(args[0])) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:03:26.893

作为`loadData`一个实例方法，您应该使用：

```
if (reader.loadData(args[0])) { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T00:05:51.410

您已经创建了阅读器的实例，但随后选择不使用它...

```
DataReader reader = new DataReader(); // The reader is used to read data from a file
if(DataReader.loadData(args[0])) 
```

您应该只使用可用的实例

```
DataReader reader = new DataReader(); // The reader is used to read data from a file
if(reader.loadData(args[0])) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T00:06:37.927

是的，更改`DataReader`为`reader`. 您已经创建了`DataReader`名为的对象`reader`，但您`loadData()`在类`DataReader`而不是对象上调用方法`reader`。如果您没有对象的实例并且正在调用该方法，则它必须是静态方法。您可以随时调用静态方法，它们不必位于特定对象上。

# foreach - XSLT1，Muenchian 分组，在 foreach 循环中列出分组节点

> ID：13464579
> 
> 赞同：1
> 
> 时间：2012-11-20T00:00:47.530
> 
> 标签：foreach, xslt-1.0, xslt-grouping, muenchian-grouping

给定xml代码

```
<z>
<f hit="1">
<g>hola1</g>
</f>
<f hit="2">
<g>hola2</g>
</f>
<f hit="3">
<g>hola1</g>
</f>
</z> 
```

我想要xml输出

```
<z>
hola1
hola2
</z> 
```

使用 xslt1。然后，一个简单的解决方案是 muenchian 分组

```
<xsl:key name="thisone" match="/z/f/g" use="." />
<z>
<xsl:for-each select="/z/f[generate-id(g)=generate-id(key('thisone',g)[1])]">
<xsl:value-of select="g" />
</xsl:for-each>
</z> 
```

但是，当我将其应用于大型数据集时，系统（firefox）一直在思考。我认为这是由于数据集非常大。但是，“g”的不同值的数量确实很少。

我的问题是：有没有办法对 Muenchian 分组的节点进行 for-each 循环？就像是

```
<xsl:for-each select="nodes_of_key('thisone')"> 
```

这将避免比较所有“g”节点的所有值，这需要永远？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T01:33:10.350

**不需要任何`<xsl:for-each>`指令来解决这个问题**（最好避免使用该指令）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kFByG" match="f" use="g"/>

 <xsl:template match="/*">
     <z>
      <xsl:apply-templates/>
      <xsl:text>&#xA;</xsl:text>
     </z>
 </xsl:template>

 <xsl:template match="f[generate-id()=generate-id(key('kFByG',g)[1])]">
     <xsl:text>&#xA;</xsl:text>
     <xsl:value-of select="g"/>
 </xsl:template>
 <xsl:template match="text()"/>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<z>
    <f hit="1">
        <g>hola1</g>
    </f>
    <f hit="2">
        <g>hola2</g>
    </f>
    <f hit="3">
        <g>hola1</g>
    </f>
</z> 
```

**产生了想要的正确结果：**

```
<z>
hola1
hola2
</z> 
```

# asp.net-mvc - 带有模型的 MVC 3 表单回发

> ID：13464581
> 
> 赞同：3
> 
> 时间：2012-11-20T00:00:53.390
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我正在尝试将我的模型发布回控制器，但 FormCollection 中的结果不是我所期望的。

我从自定义 XML 服务收到 TeamModel 的 IEnumerable。每个 TeamModel 都包含一个字符串和一个布尔值。字符串是团队的名称，bool 表示用户是否要将其插入数据库。

**控制器：**

```
public ActionResult ImportTeams()
    {
        var xmlService = new XmlSoccerService();
        const string league = "Scottish Premier League";

        var model = xmlService.GetAllTeamsByLeagueAndSeason(league, "1112");
        ViewBag.League = league; 
        return View("~/Views/Admin/Database/ImportTeams.cshtml", model);
    }

    [HttpPost]
    public ActionResult ImportTeams(FormCollection collection , string league)
    {
        return RedirectToAction("ImportTeams");
    } 
```

**团队模型：**

```
public class TeamModel
{
    public string Name { get; set; }
    public bool Import { get; set; }
} 
```

**看法：**

```
@model IEnumerable<TopTipFootball.XmlSoccer.Models.TeamModel>

@{
    ViewBag.Title = "Import Teams";
}

<h2>Select the teams to import into: @ViewBag.League</h2>

@using (Html.BeginForm())
{
    var league = ViewBag.League;

    @Html.HiddenFor(l => league)

    foreach (var team in Model)
    {
        <div class="editor-field">
            @Html.EditorFor(model => team.Import)
            @Html.DisplayFor(m => team.Name)      
        </div>
    }
    <p>
        <input type="submit" value="Import teams" />
    </p>
} 
```

**视图呈现的 html 中的一个元素：**

```
<input checked="checked" class="check-box" data-val="true" data-val-required="The Import field is required." id="team_Import" name="team.Import" type="checkbox" value="true" />
<input name="team.Import" type="hidden" value="false" />
        Aberdeen 
```

**一些问题：**

1.  如何确保我在帖子中将 TeamModel 的 IEnumerable 返回到控制器？
2.  我是否要以正确的方式将联盟传回给控制器？（通过隐藏字段）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:10:51.353

尝试使用 for 循环而不是循环，即

```
for(int i = 0; i < Model.Count; i++) 
{
   @Html.EditorFor(model => Model[i].Import)
   @Html.DisplayFor(m => Model[i].Name)  
} 
```

我相信这应该创建 id 和名称，例如 Model_ *0* _Import 等，希望这将使它正确绑定在您的帖子上。

是的，我以这种方式使用了隐藏字段。我当然假设联赛发布正确，而这只是不正确的项目列表？

**编辑**：您总是可以使用 viewModel 而不是使用 viewBag 和 Model 的组合？

这是一种可能会提供帮助的解决方案？

```
public ActionResult ImportTeams()
{
    const string league = "Scottish Premier League";

    var viewModel = new LeagueTeamViewModel
    {
       League = league;
    }

    var xmlService = new XmlSoccerService();        
    var model = xmlService.GetAllTeamsByLeagueAndSeason(league, "1112");

    viewModel.Teams.AddRange(xmlService.GetAllTeamsByLeagueAndSeason(league, "1112").Select(p => new TeamViewModel
    {
       Name = p.Name,
       Import = p.Import
    };

    return View("ImportTeams", viewModel);
}

[HttpPost]
public ActionResult ImportTeams(LeagueTeamViewModel viewModel)
{
}

public class LeagueTeamViewModel 
{
   public string League { get; set; }

   private List<TeamViewModel> _teams = new List<TeamViewModel>();

   public List<TeamViewModel> Teams
   {
      get { return _teams; }
      set { _teams = value; }
   }
}

public class TeamViewModel
{
   [DisplayName("Name")]
   public string Name { get; set; |

   [DisplayName("Imported")]
   public string Import { get; set; |
} 
```

还有你的看法

```
@model IEnumerable<LeagueTeamViewModel>
@{
    ViewBag.Title = "Import Teams";
}

<h2>Select the teams to import into: @Model.League</h2>

@using (Html.BeginForm())
{
    @Html.HiddenFor(model => model.League)

    for(int i = 0; i < Model.Teams.Count; i++) 
    {
        <div class="editor-field">
            @Html.EditorFor(model => model.Teams[i].Import)
            @Html.HiddenFor(m => model.Teams[i].Name)      
        </div>
    }
    <p>
        <input type="submit" value="Import teams" />
    </p>
} 
```

# email - log4net 中的 SMTP 记录器不发送很长的电子邮件

> ID：13464589
> 
> 赞同：0
> 
> 时间：2012-11-20T00:01:21.487
> 
> 标签：email, smtp, log4net

我在我的配置中配置了 SMTP 记录器，如下所示：

```
<appender name="SmtpEndUserAppender" type="log4net.Appender.SmtpAppender">
                     <to value="someReciever@sjm.com"/>
                     <from value="serviceAccount@sjm.com"/>
                     <subject value="Error occured in the XML Conversion Utility"/>
                     <smtpHost value="smtp server name"/>
                     <bufferSize value="1024"/>
                     <lossy value="false"/>
                     <layout type="log4net.Layout.PatternLayout">
                           <conversionPattern value="%date{MM-dd-yyyy HH:mm:ss.ff} [%thread] %-5level %logger - %message%newline"/>
                     </layout>
              </appender> 
```

问题是，如果消息很小，它可以很好地发送，但如果 appender 发现一条消息太长，它只会通过代码块而不会在收件箱中收到任何电子邮件。

```
var log = LogManager.GetLogger(Constants.ENDUSEREMAILLOGGER);
log.Info(string.Format(Constants.EMAILERRORMESSAGETEMPLATE, unprocessedFile, ex.Message)); 
```

ex.message 有时会变得很长（比如 2000 行或其他内容），因为我在循环超过 5000 行并收集所有错误时使用字符串生成器。

我们需要增加缓冲区大小吗？为什么会有这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:05:22.510

您的短邮件是否有可能通过 log.Error 发送，而您的大邮件使用 log.Info？

bufferSize 是在通过电子邮件发送之前缓冲的非错误事件的数量。换句话说，如果您没有使用 log.Error，那么在您调用 log.info 1024 次之后您将不会收到任何电子邮件，然后您会收到一封包含所有 1024 条消息的电子邮件。

但是 log.Error 将刷新缓冲区，该缓冲区将立即发送电子邮件。

另一种可能性是包含所有 1024 条消息的电子邮件因太大而被拒绝。

# github - 在 Jekyll 中突出显示 Github 风格的 Markdown 和 pygments

> ID：13464590
> 
> 赞同：31
> 
> 时间：2012-11-20T00:01:25.573
> 
> 标签：github, markdown, jekyll, pygments

我已经在 VPS 上部署了我的 Jekyll 博客。我现在想添加 Github 风格的 Markdown，使用 Pygments 突出显示，但我不知道我必须编辑哪些文件以及如何编辑。

到目前为止，我配置的唯一文件是`_config.yml`这样的：

```
 1 safe:        false
  2 auto:        false
  3 server:      false
  4 server_port: 4000
  5 baseurl:    /
  6 url: http://localhost:4000
  7 
  8 source:      .
  9 destination: ./_site
 10 plugins:     ./_plugins
 11 
 12 future:      true
 13 lsi:         false
 14 pygments:    false
 15 markdown:    maruku
 16 permalink:   date
 17 
 18 maruku:
 19   use_tex:    false
 20   use_divs:   false
 21   png_engine: blahtex
 22   png_dir:    images/latex
 23   png_url:    /images/latex
 24 
 25 rdiscount:
 26   extensions: []
 27 
 28 kramdown:
 29   auto_ids: true,
 30   footnote_nr: 1
 31   entity_output: as_char
 32   toc_levels: 1..6 
 33   use_coderay: false
 34 
 35 coderay:
 36   coderay_wrap: div
 37   coderay_line_numbers: inline
 38   coderay_line_numbers_start: 1
 39   coderay_tab_width: 4
 40   coderay_bold_every: 10
 41   coderay_css: style 
```

如何正确配置 Jekyll 以使用 Github 风格的 Markdown 和 Pygments 突出显示？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-11-28T20:42:38.423

## 编辑：现在更容易了

从 Jekyll >= 0.12.1 起，redcarpet2 由 Jekyll 原生支持，因此您只需将配置设置为`markdown: redcarpet`，您就可以很好地使用 GFM / 围栏代码块，而无需其他的这个 mumbojumbo ......

## 原始答案

您明确要求 Github 风格的降价，所以我认为您不是在寻找使用非降价液体格式创建代码块的答案：

```
{% highlight python %}
def yourfunction():
     print "Hello World!"
{% endhighlight %} 
```

但宁愿能够用围栏代码块编写一些东西：

```
```python
def yourfunction():
     print "Hello World!"
``` 
```

等等。为此，您将需要使用**redcarpet** markdown 解析器。

Github 风格的降价使用名为“Redcarpet” [1](https://github.com/blog/832-rolling-out-the-redcarpet)的降价解析器。具有讽刺意味的是，尽管 Github 风格的 markdown 使用[redcarpet2](https://github.com/vmg/redcarpet)，但 Jekyll 默认不支持这个 markdown 解析器。相反，您可以通过安装该 ruby​​ gem 将其添加为插件

```
gem install redcarpet 
```

然后添加[redcarpet2 Jekyll 插件](https://github.com/nono/Jekyll-plugins)。（在 Jekyll 中安装插件相当于`.rb`将该存储库中提供的 ruby​​ 脚本放入您的`_plugins`目录中。也可以在 的子目录中`_plugins`）。

然后，如那里的文档所述，编辑您`_config.yml`以使用 redcarpet2：

```
markdown: redcarpet2
redcarpet:
  extensions: ["no_intra_emphasis", "fenced_code_blocks", "autolink", "strikethrough", "superscript"] 
```

它添加了 github-flavored-markdown aka redcarpet2 提供的通用扩展（嗯，差不多。这不会做 github 特定的 markdown 事情，比如通过数字识别问题，或者通过哈希提交，所以它们在技术上并不相同）。

拥有该插件意味着，目前，如果您在那里托管您的网站，您将不得不在本地构建您的网站并将其复制`_site`到 github，因为在 jekyll 引擎的 Github 版本上不提供 redcarpet2（请参阅这个[开放](https://github.com/mojombo/jekyll/issues/200)问题杰基尔）

**注意**：顺便说一下，您不需要您指定的所有降价编辑器`_config.yml`。对于使用 redcarpet2 的基本示例，您可能希望查看此[配置](https://github.com/cboettig/labnotebook/blob/a52ec003d4a55c87b1284da60558831458ca5be8/_config.yml)以及与之相关的 jekyll 目录。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-24T21:23:49.930

Jekyll 最好的部分是，正如[这里](https://github.com/mojombo/jekyll)所说，

> ...它需要一个模板目录（代表网站的原始形式），通过 Textile 或 Markdown 和 Liquid 转换器运行它，并吐出一个完整的静态网站...

这意味着，默认情况下，您会得到 Markdown 和 pygments 突出显示。

您可以*放弃*或使用默认的 _config.yaml 进行此设置。使用现有配置，您可能希望将 pygments 设置为 true: `pygments: true`。

这就是你所做的

*   **Markdown**：例如，只需将您的文件命名为 *.markdown`2012-12-01-my-post.markdown`并将其放在根目录内的任何位置。通常，您会将其放在 _posts 中。

    当 jekyll 解析这个文件时，它会通过 markdown 过滤器传递它。作为额外的奖励，您可以保存为 *.textile 并使用 Textile[解析](http://redcloth.org/hobix.com/textile/)。而且，当然，您可以将其保留为 .html，这样就不会对 markdown 进行解析。

*   **pygments**：只需使用您的代码执行此操作：

    ```
    {% highlight python %}
    def yourfunction():
         print "Hello World!"
    {% endhighlight %} 
    ```

    您还可以通过以下方式获得行号：

    ```
    {% highlight python linenos %}   
    {% endhighlight %} 
    ```

编辑：另外，**您需要**使用命令生成语法样式表

```
pygmentize -S default -f html > style.css 
```

正如[这里](http://pygments.org/docs/quickstart/)和@joshuahornby10 所提到的。显然，在您的 html 中包含 style.css。然后，您的代码将使用 pygments 进行语法高亮显示。

哦，您无需更改 _config.yaml 中的任何设置即可使用。只需运行您的网站`jekyll --server --auto`，看看它是否看起来不错。旁注，在编辑 _config 文件时，您需要停止自动运行并重新运行 jekyll 以进行任何更改。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-27T23:52:40.070

在配置文件更改

```
 pygments:    false 
```

至

```
 pygments:    true 
```

这意味着当您在 markdown 文件中编写代码部分时（很棒的资源[http://daringfireball.net/projects/markdown/](http://daringfireball.net/projects/markdown/)），他们将使用 pygments 样式。确保您已安装，这是我犯的错误。此外，一旦安装，您将需要创建一个 CSS 文件以进行样式设置（听起来很明显，但我犯了这个错误）

```
 pygmentize -S default -f html > stylesheets/pygments.css 
```

您可以将默认更改为此处找到的任何主题：

[http://pygments.org/demo/35195/](http://pygments.org/demo/35195/)

关于降价，我已经读过，为了让 pygments 工作，你需要降价为你已经在配置文件中设置的 maruku。

希望这会有所帮助，我发现 Jekyll 是一个出色的博客平台，但文档很少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-23T02:04:54.590

自从[cboettig](https://stackoverflow.com/users/258662/cboettig)发布他的答案后，GitHub 已经停止支持`redcarpet`. 如果你想要 GitHub Flavored Markdown，你现在可以直接`markdown: GFM`在`_config.yml`.

# java - 跟踪 Swing 组件的正确方法是什么？

> ID：13464599
> 
> 赞同：0
> 
> 时间：2012-11-20T00:02:40.940
> 
> 标签：java, swing, model-view-controller, oop

这就是我所拥有的。

在这段代码中，我创建了一个包含 7 个滑块和一个组合框的面板。

```
public JPanel createOscPanel(final Osc o)
{
      //create a panel of 2 rows, 4 columns*/
    JPanel panel = gc.createComponentPanel(o.NAME, 2, 4);                   

    /*set up combobox panel*/
    JPanel cbPanel = new JPanel(); 
    cbPanel.setLayout(new BoxLayout(cbPanel, BoxLayout.Y_AXIS));

        /*label*/
    JPanel lbPanel = new JPanel();
    lbPanel.setLayout(new BoxLayout(lbPanel, BoxLayout.X_AXIS)); 
    lbPanel.setAlignmentY(LEFT_ALIGNMENT); 
    JLabel cbLabel = new JLabel("Wave Type:");
    lbPanel.add(cbLabel);
    cbPanel.add(lbPanel);

        /*combobox*/
    final String[] comboItems = {"Sine", "Custom", "FSaw", "FSquare"};
    JComboBox cb = new JComboBox(comboItems);
    cb.setMaximumSize(new Dimension (100, 20)); 

    cbPanel.add(cb); 

    /*add sliders*/
    panel.add(gc.createSliderPanel(o.getAmp(), DEFAULT_SLIDER_GRAINS)); 
    panel.add(gc.createSliderPanel(o.getFreq(), DEFAULT_SLIDER_GRAINS)); 
    panel.add(gc.createSliderPanel(o.getPhase(), DEFAULT_SLIDER_GRAINS));
    panel.add(cbPanel);
    panel.add(gc.createSliderPanel(o.getWidth(), DEFAULT_SLIDER_GRAINS));
    panel.add(gc.createSliderPanel(o.getSlope(), DEFAULT_SLIDER_GRAINS));
    panel.add(gc.createSliderPanel(o.getCurve(), DEFAULT_SLIDER_GRAINS));   
    panel.add(gc.createSliderPanel(o.getFourier(), (o.getFourier().MAX - o.getFourier().MIN))); 

    final Runnable disableCustomSliders = new Runnable() /*this is how do a method-in-method in Java*/
    {
        public void run()
        {
                  //I need to disable sliders here.                     

        }
    };

    final Runnable enableCustomSliders = new Runnable() /*this is how do a method-in-method in Java*/
    {
        public void run()
        {

               //I need to enable sliders here. 
        }
    };

    cb.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            JComboBox cb = (JComboBox)e.getSource();
            int value = cb.getSelectedIndex();

            switch(value)
            {
            case 0: {o.setWaveShape(Osc.WaveShape.SINE); disableCustomSliders.run();} break;
            case 1: {o.setWaveShape(Osc.WaveShape.CUSTOM); enableCustomSliders.run();} break;
            case 2: {o.setWaveShape(Osc.WaveShape.FSAW); disableCustomSliders.run();} break;
            case 3: {o.setWaveShape(Osc.WaveShape.FSQUARE);disableCustomSliders.run();} break;

            }

            refresh();
        }
    });

    return panel; 

} 
```

当您在组合框中选择 Sine、Fsaw、FSquare 项目时，您需要禁用 Curve、Width 和 Slope 滑块，而当您选择 Custom 项目时，您需要重新启用它们。

这是`createSliderPanel`代码。

```
public JPanel createSliderPanel(
        final Parameter parameter,
        final int grains)
{       
    /*create and assign components*/ 
    final JPanel panel = new JPanel();
    panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS)); 
    panel.setBorder(BorderFactory.createRaisedBevelBorder()); 

    final JLabel label = new JLabel(parameter.NAME); 
    final JLabel valueLabel = new JLabel();

    /*set up slider*/
    int curr = valueToSlider(parameter.MIN.doubleValue(), parameter.MAX.doubleValue(),
            parameter.getValue().doubleValue(), parameter.SCALETYPE, parameter.Q, grains);
    final JSlider slider = new JSlider(JSlider.VERTICAL, 0, grains, curr);

    slider.setPreferredSize(new Dimension(SLIDER_WIDTH, SLIDER_HEIGHT));

    slider.setAlignmentX(Component.LEFT_ALIGNMENT);

    panel.add(valueLabel); 
    panel.add(slider);
    panel.add(label);

    /*slider move event*/
    slider.addChangeListener(new ChangeListener() {
        /* (non-Javadoc)
         * @see javax.swing.event.ChangeListener#stateChanged(javax.swing.event.ChangeEvent)
         */
        public void stateChanged(ChangeEvent event) {

            double value = sliderToValue(parameter.MIN.doubleValue(), parameter.MAX.doubleValue(),slider.getValue(), parameter.SCALETYPE, parameter.Q, grains); 

            updateSliderLabel(parameter, valueLabel, parameter.getValue());  

            /*set the parameter value*/
            if (parameter.CLASSTYPE.equals(Double.class))
                     parameter.setValue(value);
            else if (parameter.CLASSTYPE.equals((Integer.class)))
                    parameter.setValue((int)value); 

            gui.refresh(); 
        }

    });

    /*need to reset the valueLabel to it's correct format*/
    updateSliderLabel(parameter, valueLabel, parameter.getValue()); 

    return panel; 
} 
```

所以问题是 - 我如何引用这些滑块以便对它们执行 .setEnabled(false) ？

我能想到的直接且相当简单的解决方案是重构`createSliderPanel`，例如传入父面板，并将滑块面板添加​​到方法内的父级，然后返回滑块。

有没有更好的遵循 OO 和 MVC 的概念？

最后一个问题是：Stack Overflow 上的有效性和礼仪 - 发布这些大块代码是否礼貌且有效？还是让回答问题变得更加困难？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:15:06.037

我个人会创建一个自定义组件，而不是从头开始构建滑块面板。这将使您有机会提供可用于更改整个组件的启用状态的“控制”方法，并提供可用于根据需要检索滑块值的 getter 和 setter

# php - 使用 PHP 包括在导航栏中突出显示当前页面？

> ID：13464605
> 
> 赞同：0
> 
> 时间：2012-11-20T00:03:18.670
> 
> 标签：php, highlight, navbar

我有一个 index.php 页面，其中包含一个 navBar.inc 页面来呈现顶部导航栏。我也有一个外部样式表。我的目标是通过 PHP 突出显示该导航栏中的当前页面。

我试图实现它，但它没有像我预期的那样工作。

我将 PHP 代码放在 index.php 页面的顶部：`<?php $thisPage="About"; ?>`

然后在`li`navBar.inc 文件中的 each 中，我有应该更改 each 的 id 的代码，`li`例如：`<li><?php if ($thisPage=="About") echo " id=\"currentPage\""; ?>><a href="index.php">ABOUT</a></li>`

当然，在我的外部 CSS 中，我有：`#currentPage {color:black;}`

但是当我将文件上传到服务器并试用时，它实际上将 id="currentPage" 写入页面而不是为其分配该 id。此外，每个菜单项之间都有 >。请参阅下面的图片链接。

[图片](http://cl.ly/image/0g011Y0A2s3m)

你能帮我搞定这个工作吗？我想我快到了！谢谢！

注意：这是我第一次接触 PHP。语法有点混乱，但看起来很有趣！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:09:02.500

您当前正在`<li>`回显变量之前关闭标记，这意味着它正在呈现`id`属性和`>`to 屏幕：

```
<li><?php if ($thisPage=="About") echo " id=\"currentPage\""; ?>>
   ^                                                            ^
<a href="index.php">ABOUT</a></li> 
```

您需要将 id 属性放在`<li>`元素中，如下所示：

```
<li<?php if ($thisPage=="About") echo " id=\"currentPage\""; ?>>
<a href="index.php">ABOUT</a></li> 
```

如前所述，您可以使用 javascript/jQuery 完成此操作，但这会起作用。

**编辑：**

尝试：

```
#currentPage a { color: black !important; } 
```

这会覆盖您在 .CSS 文件中设置的先前样式。

# python - 记住字典的值

> ID：13464608
> 
> 赞同：0
> 
> 时间：2012-11-20T00:03:28.077
> 
> 标签：python, function, dictionary, add, updates

我是 Python 的新手，但可以执行以下操作吗？我想创建一个字典，test_tube，它显示里面有什么液体和它的数量。使用 add_liquid 函数，我想在试管中添加一种新液体或更多以前使用过的液体，而不使用 defaultdicts。

```
Def add_liquid(test_tube,liquid,milliliters=0):
     test_tube[liquid] = milliters
     return test_tube 
     #update of previous test tube and memorize new test tube           

>>>add_liquid(test_tube,'water',10) 
{'water':10}
>>>more_water=add_liquid(test_tube,'water',5)
>>>more_water
{'water':15}
>>>add_liquid(test_tube,'ethanol',1)
{'ethanol':1, 'water':15} 
```

Python 必须以某种方式记住 test_tube 中先前的液体量。任何意见，将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T00:09:57.343

如果我正确理解你的问题，你只需要检查液体是否已经在那里，如果是，添加数量。

```
if liquid in test_tube:
    test_tube[liquid] += milliliters
else: 
    test_tube[liquid] = milliliters 
```

另一种表述方式是将值设置为当前值的总和或 0 （不存在）和毫升：

```
test_tube[liquid] = test_tube.get(liquid, 0) + milliliters 
```

请注意，您需要定义您的函数，以便它修改您传入的字典（然后您不应该真正返回任何内容），或者它返回它的修改副本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T00:10:06.883

您想将 test_tube 存储为传递给 add_liquid() 的变量。此外，如果它已经存在，您希望它添加到液体值。

```
def add_liquid(test_tube,liquid,milliliters=0):
    test_tube[liquid] = test_tube.setdefault(liquid, 0) + milliters
    return test_tube

test_tube = add_liquid(test_tube,'water',10)
more_water = add_liquid(test_tube,'water',5) 
```

等等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T00:10:51.897

你会想要这样的东西：

```
if liquid not in test_tube.keys():
    test_tube.update({liquid:milliliters})
else:
    test_tube[liquid] += milliliters 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T01:40:01.433

如果您只进行计数，并且您不喜欢`defaultdict()`，则可以使用`Counter()`集合中的对象：

```
>>> from collections import Counter
>>> test_tube = Counter()
>>> test_tube["water"] = 10
>>>
>>> # more water
>>> test_tube["water"] += 5
>>> test_tube["water"]
15
>>> test_tube["ethanol"] = 1
>>> test_tube
Counter({'water': 15, 'ethanol': 1})
>>> 
```

# php - 在 iOS 上使用 PHP 下载 BLOB

> ID：13464611
> 
> 赞同：0
> 
> 时间：2012-11-20T00:03:53.243
> 
> 标签：php, blob

我有一个非常简单直接的问题要做。我需要从我的 MySQL 服务器下载 3 种不同类型的数据：

：图像、音频、视频

所以我正在经历一些深入的 PHP 事情，我发现了这两段代码：

声音的：

```
<?php
    // Connect to database
    @mysql_connect("mysql.server.com.br","user","pass01");
    @mysql_select_db("database01") or die( "Unable to select database");

    // Find out about latest image

    $gotten = @mysql_query("SELECT audio_content AS audio_in_blob FROM database01.audio_content WHERE content_id = 'id01';");
    if ($row = @mysql_fetch_assoc($gotten)) {
        $bytes = $row[ "audio_in_blob" ];
    } 
    else {
        echo "hoe!";
        $errmsg = 'Could not run query: ' . mysql_error();
        $title = "no database image available";
    }

    // If this is the image request, send out the image

    header("Content-type: audio/mp3");
    echo $bytes;
    exit ();
?> 
```

视频：

```
<?php

    // Connect to database

    @mysql_connect("mysql.server.com.br","user","pass01");
    @mysql_select_db("database01") or die( "Unable to select database");

    // Find out about latest image

    $gotten = @mysql_query("SELECT video_content AS video_in_blob FROM database01.video_content WHERE content_id = 'id01';");
    if ($row = @mysql_fetch_assoc($gotten)) {
        $bytes = $row[ "video_in_blob" ];
    } 
    else {
        echo "hoe!";
        $errmsg = 'Could not run query: ' . mysql_error();
        $title = "no database image available";
    }

    // If this is the image request, send out the image

    header("Content-type: video/mpeg");
    echo $bytes;
    exit ();
?> 
```

但是这些方法只是在浏览器中显示 blob 而不会下载它们。我能做些什么？我需要下载这些 blob 并使其可用于视频/照片/音频显示。

干杯。

# java - 如何使用可变子数组填充 Java 数组？

> ID：13464612
> 
> 赞同：0
> 
> 时间：2012-11-20T00:03:57.813
> 
> 标签：java, multidimensional-array, populate

我想编写一个 Java 方法来操作如下：

```
输入 1，输出 { {0}，{1} }
输入 2，输出 { {0, 0}, {0, 1}, {1, 0}, {1, 1} }
输入 3，输出 { {0, 0, 0}, {0, 0, 1}, {0, 1, 0}, ... {1, 1, 1} }
...

```

（为了简洁，我在示例中使用 0 和 1；最低级别的子元素可能是 HIGH 和 LOW、'A' 和 'Z'，或任何其他两个不同的值。）

这感觉像是一个很好的递归候选者，但这只是一种感觉。到目前为止，我所有的努力似乎都不是最理想的。* 除了使用不同的语言之外，还有什么好的方法吗？

^(* 例如：循环 0 到 (2^input)-1；将数字解释为 [输入] 位二进制值；使用二进制数字生成子数组。呸。)

**编辑：提出广义迭代解决方案**

```
公共枚举项{

   第 1 项，第 2 项，...；// 需要多少

   私有静态最终 int ITEM_COUNT = values().length;

   公共静态项目[][] allCombinationsOfSize(int comboSize) {

      int arraySize = (int) Math.pow(ITEM_COUNT, comboSize);
      项目数组[][] = 新项目[arraySize][];

      for (int n = 0 ; n < arraySize ; ++n ) {
         数组[n] = nthSubarray(n, comboSize);
      }

      返回数组；
   }

   私有静态项目 [] nthSubarray(int n, int comboSize) {

      项目组合[] = 新项目[comboSize];

      for (int i = comboSize - 1 ; i >= 0 ; --i ) {
         组合[i] = Item.values()[n % ITEM_COUNT];
         n /= ITEM_COUNT;
      }

      返回组合；
   }
}

```

我相信 allCombinationsOfSize 是我正在寻找的方法。我仍然有一个偷偷摸摸的怀疑，我错过了一些更优雅的东西。尽管如此，以上内容允许我在我的 JUnit 测试中编写它......

```
对于（信号信号[]：Signal.allCombinationsOfSize（pinCount））{
   断言等于（
      cls.getSimpleName() + "结果",
      预期结果（cls，信号），
      actualResultFor(cls, 信号)
   );
}

```

...这很简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:56:20.667

这是一个递归解决方案：

```
class Test {
  private static Object[][] createArray(int n, Object[] values)
  {
    Object[][] result = null;
    int m = values.length;
    if (n == 1)
    {
      result = new Object[m][1];
      for (int i = 0; i < m; ++i)
        result[i][0] = values[i];
    }
    else
    {
      Object[][] array = createArray(n - 1, values);
      int l = array.length;
      result = new Object[m * l][n];
      for (int i1 = 0; i1 < m; ++i1)
      {
        for (int i2 = 0; i2 < l; ++i2)
        {
          int i = i1 * l + i2;
          for (int j = 0; j < n; ++j)
            result[i][j] = j == 0 ? values[i1] : array[i2][j - 1];
        }
      }
    }
    return result;
  }

  private static void printArray(Object[][] array)
  {
    System.out.println("{");
    for (int i = 0; i < array.length; ++i)
    {
      System.out.print("  {");
      for (int j = 0; j < array[0].length; ++j)
        System.out.printf(" %s", array[i][j].toString());
      System.out.println(" }");
    }
    System.out.println("}");
  }

  public static void main(String[] args) {
    Object[] values = {'a', 'b', 'c'};
    for (int n = 1; n <= 3; ++n)
    {
      System.out.printf("n = %d:\n", n);
      Object[][] array = createArray(n, values);
      printArray(array);
      System.out.println();
    }
  }
} 
```

输出：

```
n = 1:
{
  { a }
  { b }
  { c }
}

n = 2:
{
  { a a }
  { a b }
  { a c }
  { b a }
  { b b }
  { b c }
  { c a }
  { c b }
  { c c }
}

n = 3:
{
  { a a a }
  { a a b }
  { a a c }
  { a b a }
  { a b b }
  { a b c }
  { a c a }
  { a c b }
  { a c c }
  { b a a }
  { b a b }
  { b a c }
  { b b a }
  { b b b }
  { b b c }
  { b c a }
  { b c b }
  { b c c }
  { c a a }
  { c a b }
  { c a c }
  { c b a }
  { c b b }
  { c b c }
  { c c a }
  { c c b }
  { c c c }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:19:39.103

递归方法应该有效。这应该给你一个粗略的想法。

```
 public class Main {     

        public static void main(String[] args) throws Exception {
            final int input = 6;

            final byte[] array = new byte[input];

            final List<byte[]> arrays = recurse (array, input - 1);

            for (final byte[] a : arrays) {
                print(a);
            }
        }

        private static void print(final byte[] array) {
            final StringBuilder buf = new StringBuilder ("{");

            for(final byte b : array) {
                if (buf.length() > 1) {
                    buf.append (", ");                  
                }
                buf.append (b);
            }

            buf.append ("}");

            System.out.println(buf);
        }

        private static List<byte[]> recurse(byte[] array, int input) {
            if (input > 0) {                
                final List<byte[]> subArr1 = recurse (array, input - 1);
                array[array.length - input - 1] = 1;
                final List<byte[]> subArr2 = recurse (array, input - 1);

                return sumList (subArr1, subArr2);
            }
            else {
                final byte[] arr1 = Arrays.copyOf(array, array.length);
                final byte[] arr2 = Arrays.copyOf(array, array.length);
                arr2[array.length - 1] = 1;

                return Arrays.asList(arr1, arr2);
            }           
        }

        private static List<byte[]> sumList(List<byte[]> subArr1,
                List<byte[]> subArr2) {
            final List<byte[]> result = new ArrayList<byte[]> (subArr1.size() + subArr2.size());

            result.addAll(subArr1);
            result.addAll(subArr2);

            return result;
        }
    } 
```

和一个[小提琴](http://ideone.com/FeWViw)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:32:18.617

该决定基于代码 - [Java 中数字的所有二进制组合的列表](https://stackoverflow.com/questions/6463372/list-of-all-binary-combinations-for-a-number-in-java)

```
public static void main(String args[]) throws Exception {
    int value = 4;
    populate(value);
}
public static List<List<Integer>> populate(int value) {
    List<List<Integer>> ret = new ArrayList<List<Integer>>();
    for (int i = 0; i < Math.pow(2, value); i++) {
        List<Integer> intermediate = new ArrayList<Integer>();
        StringBuilder binary = new StringBuilder(Integer.toBinaryString(i));
        for (int j = binary.length(); j < value; j++) {
            binary.insert(0, '0');
        }
        System.out.println(binary);
        for (int k=0; k<binary.length(); k++)
        {
            intermediate.add(Integer.valueOf("" + binary.charAt(k)));
        }
        ret.add(intermediate);
    }
    System.out.println(ret);
    return ret;
} 
```

# php - 用 twilio 发起语音通话？

> ID：13464618
> 
> 赞同：3
> 
> 时间：2012-11-20T00:04:55.860
> 
> 标签：php, twilio

目标：

通过文字转语音发起呼叫并阅读动态消息。

问题：

文档说： `TwiML is a set of instructions you can use to tell Twilio what to do when you receive an incoming call or SMS.`

是否有解决方案可以进行文本转语音但我发起呼叫？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:02:46.620

如果您在触发出站 API 调用时知道文本，则可以将 URL 设置为[Echo Twimlet](https://www.twilio.com/labs/twimlets/echo)，即文本。这个网址：

```
http://twimlets.com/echo?Twiml=%3CResponse%3E%3CSay%3EThis%20is%20an%20example.%3C%2FSay%3E%3C%2FResponse%3E 
```

将产生这个 TwiML：

```
<Response>
    <Say>This is an example</Say>
</Response> 
```

当由 Twilio 获取时。在您的情况下，您将 url-escape 您想说的消息并将其插入 URL。

如果您在拨打电话时不知道，我假设您将文本存储在数据库或类似数据库中。然后，当 Twilio 向您的服务器发出请求时，您从数据库中检索文本并将其插入到 XML 字符串中。这是 PHP 中的一个示例：

```
<?php
$text = fetch_text_from_db();
header('Content-Type: text/xml');
?>
<Response>
<Say><?php echo htmlentities($text); ?></Say>
</Response> 
```

# javascript - 如果 jQuery 认为它正在接收 JSONP 请求，我该如何解释 JSON？

> ID：13464619
> 
> 赞同：4
> 
> 时间：2012-11-20T00:05:09.453
> 
> 标签：javascript, jquery, ajax, json, jsonp

我正在尝试从网站（特别是 Yummly）获取一些 API 数据，看起来当我尝试执行 JSONP 请求时，我收到了 JSON 数据。这会导致“Uncaught SyntaxError: UnexpectedToken:”。

尝试执行此操作的代码是：

```
var keywords = $('#input-text').val();
var url = "http://www.yummly.com/api/recipesq="+keywords+"&_app_id=<snipped-app-id>&_app_key=<snipped-api-key>&";
 $.ajax({                                                                            
      type: 'GET',
       url: url,
       dataType: 'jsonp',
       //dataType: 'jsonp json'
       success: function() { console.log('Success!'); },
       error: function(data, data2) { console.log(data); },
       //jsonp: false,
       //jsonpCallback: 'recipeGet'                                          
  });
}); 
```

我试图通过重载 dataType 从 JSONP 转换为 JSON，但这并没有导致与上述结果不同的结果。我也尝试过更改回调函数，但是当我收到语法错误时，它并没有转到该函数。当我不使用 JSONP 而只使用 JSON 时，我会收到“XMLHttpRequest cannot load Origin is not allowed by Access-Control-Allow-Origin.”。

任何帮助将不胜感激，我一直在努力解决这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T01:12:37.870

我是负责 Yummly API 的开发人员之一。

Yummly API 支持 JSONP（[文档](https://developer.yummly.com/intro)解释了如何），但您的请求存在几个问题。

1.  API url 应该是

    http://api.yummly.com/v1/api/recipes（去掉http后面的空格）

2.  应该有一个“？” /recipes 和 q 之间（q 是参数，/v1/api/recipes 是路径）

3.  然后，您可以像往常一样使用 JSONP 调用传递回调参数（$.ajax with dataType: 'JSONP' like you are using above should work）

最后，您的 app_key 是秘密的。请不要在 Stack Overflow 等公共网站上发布。我已经撤销了，请到[https://developer.yummly.com](https://developer.yummly.com)生成一个新的。

# qt - Qt：空透明QImage有噪点

> ID：13464627
> 
> 赞同：3
> 
> 时间：2012-11-20T00:06:01.493
> 
> 标签：qt, qimage, jambi

我正在尝试在 QImage 上进行一些屏幕外渲染（没什么特别的，只是一些合成的缩略图）并且遇到了一个问题，即使是新的和据称是空白的 QImage 也会有一些非常严重的噪音：

![截屏](../Images/1746e1d28133bc732c59d7a3e388fe39.png)

重现的代码相当简单：

```
QImage image = new QImage(
        (int) b.width(), (int) b.height(),
        QImage.Format.Format_ARGB32);
painter.drawImage(0, 0, image); 
```

（`b`只是一个`QRectF`包含我正在绘制的 QGraphicsItem 的边界）

填充新图像似乎没有任何效果：

```
QPainter p = new QPainter(image);
p.fillRect(b, QColor.transparent);
p.end(); 
```

用任何纯色（例如白色）填充它可以消除噪音，但不幸的是我需要这个特定的图像是透明的。有什么办法可以消除噪音吗？

我正在使用 Qt Jambi（4.7.1-beta），但我认为这不会有很大的不同。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T02:13:42.247

从文档中[`QImage::QImage(int width, int height, Format format)`](http://doc.qt.nokia.com/qt/qimage.html#QImage-3)：

> 警告：这将创建一个带有未初始化数据的 QImage。在使用 QPainter 绘制图像之前，调用 fill() 以使用适当的像素值填充图像。

所以`QImage::fill(uint pixelValue)`在构建它之后调用你的图像。

# vb.net - VB.NET 代码在私有类别下添加 Windows 防火墙异常，而不是公共

> ID：13464630
> 
> 赞同：1
> 
> 时间：2012-11-20T00:06:34.923
> 
> 标签：vb.net, windows-firewall-api

我有一个可以添加防火墙异常的 VB.NET 例程，问题是我必须在所有类型的网络下添加一个异常，无论是私有的还是公共的。但是这个例程在 Windows 防火墙的私有类别下添加了一个例外。

我的代码：

```
Private Sub AddApp()
        Dim appType As Type = Type.GetTypeFromProgID("HnetCfg.FwAuthorizedApplication")
        Dim app As INetFwAuthorizedApplication
        app = DirectCast(Activator.CreateInstance(appType), INetFwAuthorizedApplication)

        ' Set the application properties
        app.Name = "My App"
        app.ProcessImageFileName = "C:\Users\klein\AppData\Roaming\Microsoft\Windows\MyApp.exe"
        app.Enabled = True

        ' Get the firewall manager, so we can get the list of authorized apps
        Dim fwMgrType As Type = Type.GetTypeFromProgID("HnetCfg.FwMgr")
        Dim fwMgr As INetFwMgr
        fwMgr = DirectCast(Activator.CreateInstance(fwMgrType), INetFwMgr)

        ' Get the list of authorized applications from the Firewall Manager, so we can add our app to that list
        Dim apps As INetFwAuthorizedApplications
        apps = fwMgr.LocalPolicy.CurrentProfile.AuthorizedApplications
        apps.Add(app)
    End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T17:53:12.603

您是否尝试过修改规则的范围？

类似的东西；

```
app.Scope = 0; 
```

应该将范围定义为 ALL

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-08T09:13:21.260

而不是将应用程序添加到`CurrentProfile`尝试使用`GetProfileByType`

```
 apps = fwMgr.LocalPolicy.GetProfileByType(NET_FW_PROFILE_TYPE_.NET_FW_PROFILE_CURRENT).AuthorizedApplications   ' PUBLIC
    apps = fwMgr.LocalPolicy.GetProfileByType(NET_FW_PROFILE_TYPE_.NET_FW_PROFILE_DOMAIN).AuthorizedApplications    ' DOMAIN
    apps = fwMgr.LocalPolicy.GetProfileByType(NET_FW_PROFILE_TYPE_.NET_FW_PROFILE_STANDARD).AuthorizedApplications  ' PRIVATE 
```

我使用以下代码，它工作正常。

```
Imports NetFwTypeLib
Module modMain

    Sub Main()

        AddApp(NET_FW_PROFILE_TYPE_.NET_FW_PROFILE_CURRENT)  'public
        AddApp(NET_FW_PROFILE_TYPE_.NET_FW_PROFILE_STANDARD) 'private

    End Sub

    Private Sub AddApp(ProfileType As NET_FW_PROFILE_TYPE_)

        Dim app As INetFwAuthorizedApplication = DirectCast(Activator.CreateInstance(Type.GetTypeFromProgID("HnetCfg.FwAuthorizedApplication")), INetFwAuthorizedApplication)
        app.Name = Application.ProductName
        app.ProcessImageFileName = Application.ExecutablePath
        app.Enabled = True
        Dim fwMgr As INetFwMgr = DirectCast(Activator.CreateInstance(Type.GetTypeFromProgID("HnetCfg.FwMgr")), INetFwMgr)
        fwMgr.LocalPolicy.GetProfileByType(ProfileType).AuthorizedApplications.Add(app)

    End Sub 
End Module 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-14T09:12:54.017

使用 INetFwPolicy2 接口。代码是 c#，但移植起来应该不难。

```
public class Firewall
{
    public enum ProtocolType
    {
        Tcp = 6,
        Udp = 17, 
        Any = 256
    }

    public static bool CheckAddPortRule(String FwRuleTitle, string Ports, ProtocolType Protcol, NET_FW_PROFILE_TYPE2_ Profile2Types)
    {
        try
        {
            Type Tpolicy2Class = Type.GetTypeFromProgID("HNetCfg.FwPolicy2");
            INetFwPolicy2 policy2Class = (INetFwPolicy2)Activator.CreateInstance(Tpolicy2Class);
            foreach (INetFwRule itm in policy2Class.Rules)
            {
                try
                {
                    if (itm.Name.ToLower() == FwRuleTitle.ToLower())
                    {
                        itm.Profiles = (int)Profile2Types;
                        itm.Protocol = (int)Protcol;
                        itm.LocalPorts = Ports;
                        return true;
                    }
                }
                catch (Exception ex)
                {
                }
            }
            INetFwRule fwRule = (INetFwRule)Activator.CreateInstance(Type.GetTypeFromProgID("HNetCfg.FWRule"));
            fwRule.Action = NET_FW_ACTION_.NET_FW_ACTION_ALLOW;
            fwRule.Name = FwRuleTitle;
            fwRule.Profiles = (int)Profile2Types;
            fwRule.Protocol = (int)Protcol;
            fwRule.LocalPorts = Ports;
            fwRule.Enabled = true;
            fwRule.InterfaceTypes = "All"; //Acceptable values for this property are "RemoteAccess", "Wireless", "Lan", and "All". 
            policy2Class.Rules.Add(fwRule);
            return true;
        }
        catch (Exception ex)
        {
        }
        return false;
    }
} 
```

你可以这样称呼它。

```
 NET_FW_PROFILE_TYPE2_ Profile2Types = NET_FW_PROFILE_TYPE2_.NET_FW_PROFILE2_DOMAIN | NET_FW_PROFILE_TYPE2_.NET_FW_PROFILE2_PUBLIC;
Firewall.CheckAddPortRule("Rule title", "1234", Firewall.ProtocolType.Tcp, Profile2Types); 
```

# iphone - Cocos2d 2.0 黑屏 ccscene

> ID：13464635
> 
> 赞同：1
> 
> 时间：2012-11-20T00:07:10.480
> 
> 标签：iphone, cocos2d-iphone

我在使用 Cocos2d 2.0 版本时遇到了大麻烦 =(

问题：启动应用程序后，我的游戏场景没有出现在屏幕上，无论我做什么，都有一个地狱般的黑屏。

从我的代码开始。

如果你们能帮助我，我将不胜感激 =D 谢谢！

```
//AppDelegate from cocos2d basic template, I change this line
[director_ pushScene:[GameScene node]];

//my GameScene class implementation
- (id)init
{
   if(self != nil)
    {
        BackgroundLayer *backgroundLayer = [BackgroundLayer node];
        [self addChild:backgroundLayer z:0];
    }

    return self;
}

//then, my BackgroundLayer class implementation
- (id)init
{
    if(self != nil)
    {
        CCSprite *backgroundImage = [CCSprite spriteWithFile:@"backgroundiPhone.png"];

        CGSize screenSize = [[CCDirector sharedDirector] winSize];
        [backgroundImage setPosition:CGPointMake(screenSize.width / 2, screenSize.height / 2)];
        //yea the image is in the project, maybe if I add some color at the sprite to be sure?

        [self addChild:backgroundImage z:0 tag:0];
    }

    return self;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T04:31:55.540

你为什么不在你的方法中调用`init`父母`init`？将此行添加到 init 方法的开头。

```
self = [super init]; 
```

# git - Git 克隆仅显示“在 what/ever/.git/ 中初始化空 Git 存储库”

> ID：13464638
> 
> 赞同：3
> 
> 时间：2012-11-20T00:07:39.173
> 
> 标签：git, web-applications

我在远程机器上创建了一个 git 裸存储库，但是当我尝试将它克隆到`/var/www/my_web_project`远程机器中的任何其他部分时，它会说：

> 在 what/ever/.git/ 中初始化空的 Git 存储库

所以没有克隆存储库。如果您初始化 git repo: `branches/`, `config/`,.... ，它只会创建典型文件夹

我试图将它克隆到我的本地机器只是为了看看问题是否相同，但我克隆了整个项目而没有问题。

任何想法？

# c# - FileStream c# 并尝试捕获

> ID：13464640
> 
> 赞同：1
> 
> 时间：2012-11-20T00:07:57.540
> 
> 标签：c#

```
public  static StringBuilder odczyt(string nazwa)
    {
        FileStream plik;
        StringBuilder dane = new StringBuilder("");
        try
        {
            plik = new FileStream(nazwa,FileMode.Open);
        }
        catch(FileNotFoundException)
        {
            Console.WriteLine ("Brak pliku {0}", nazwa);
        }
        int w;
        do
        {
            w = plik.ReadByte();
            if(w != -1)
                dane.Append((char)w);
        }
        while( (w > 0) );
        plik.Close();
        return dane;
    }
} 
```

它是我的简单功能，它正在工作，但现在我不知道它是如何发生的。Monodevelop 说 plik 没有赋值？有人可以解释为什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T00:12:04.507

您正在分配块`plik`内部`try catch`，这意味着如果您在分配期间抛出异常，那么您将尝试使用它而无需先分配它。将块之后的代码移动`try catch`到块中：

```
 public static StringBuilder odczyt(string nazwa)
    {
        FileStream plik;
        StringBuilder dane = new StringBuilder("");
        try
        {
            plik = new FileStream(nazwa, FileMode.Open);

            int w;
            do
            {
                w = plik.ReadByte();
                if (w != -1)
                    dane.Append((char)w);
            }
            while ((w > 0));
        }
        catch (FileNotFoundException)
        {
            Console.WriteLine("Brak pliku {0}", nazwa);
        }
        finally
        {
            if (plik != null)
            {
                plik.Close();
            }
        }

        return dane;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:20:46.557

我建议： 1\. 首先使用 FileExist(filename) 检查文件是否存在；2\. 使用：使用 (plik = new FileStream(nazwa, FileMode.Open)) 读取文件

```
if (File.Exist(nazwa))
{
  using (FileStream  plik = new FileStream(nazwa, FileMode.Open))
  {
      ..... do other stuff
  }
}
else
{
 // file not exist
} 
```

在我直接键入时检查语法。

弹出异常是因为它可能会因为 try catch 而关闭 plik 而没有对其进行初始化。

# c# - C# 预定义类型与原始类型？

> ID：13464641
> 
> 赞同：5
> 
> 时间：2012-11-20T00:08:08.403
> 
> 标签：c#

我最近一直在学习 C#，有一个东西叫做“预定义类型”。我认为它是原始类型的另一个名称。但我的朋友告诉我，它们彼此完全不同。刚弄糊涂了。

这两个名字是同一个东西，还是完全不同？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T00:25:17.103

在[Type.IsPrimitive 文档页面](http://msdn.microsoft.com/en-us/library/system.type.isprimitive.aspx)中有原始类型的完整列表：

> 基本类型是 Boolean、Byte、SByte、Int16、UInt16、Int32、UInt32、Int64、UInt64、IntPtr、UIntPtr、Char、Double 和 Single。

第 1.2.1 节（[预定义类型](http://msdn.microsoft.com/en-us/library/aa664635%28v=vs.71%29.aspx)）清楚地区分了这些和预定义的引用类型：

> 预定义的引用类型是`object`和`string`。该类型`object` 是所有其他类型的最终基本类型。该类型`string`用于表示 Unicode 字符串值。

所以我想很明显它们是不同的——至少在 .NET 术语中是这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-10-21T18:28:00.647

预定义是编译器特别支持的类型。***它们在System***命名空间中为 .NET 框架类型起别名。它们也称为内置类型。

编译器如何支持它们？他们有自己的关键字。例如***int***关键字用于预定义***System.Int32***类型。这意味着当您在 C# 中定义整数变量时，您可以通过键入：

`int myIntVar = 3;`

代替

`System.Int32 myIntVar = 3;`

不过，这只是句法上的差异。

原始类型都是预定义的***值***类型减去***十进制***类型。我做了一个草图来证明这一点：

[![在此处输入图像描述](../Images/2ca836d930dfb19e7a0026f0c2c82862.png)](https://i.stack.imgur.com/FKCGw.png)

希望这可以帮助。

# jquery - 检查 Django 中选定的表单选项并更新页面

> ID：13464646
> 
> 赞同：0
> 
> 时间：2012-11-20T00:09:01.117
> 
> 标签：jquery, django, database-connection

所以我正在使用 django，我有一个看起来像的页面/模板（简化为仅相关部分）

```
<select id="printerSelect" name="printer_id">
<option>Select Printer</option>                             
<option>printer1</option>                           
<option>printer2</option>                           
</select> 
```

后来我有类似的东西

```
<div id="printerInfo">
No printer Selected
</div> 
```

因此，printerSelect 列表是通过查询 mongodb 数据库、查找打印机名称并通过 django 模板/上下文内容在页面加载时动态地将它们放入列表中来填充的。是否可以知道用户何时选择该列表中的选项并让它更改printerInfo div的内容？

如果有帮助，我也知道 jquery。我认为主要的问题是：

1.  如何判断用户何时更改列表中的选择（可能可以使用绑定的 jquery 侦听器来完成？）
2.  如何根据所选选项查询数据库以获取其他信息

**编辑**

所以我实际上想出了一种使用 Sushanth 建议的 hacky 方法。基本上，在 django 模板中，您创建了一堆 div，这些 div 包含从数据库请求的附加信息，最终将进入打印机信息。

然后使用 jquery，您有一个函数可以将该信息保存到变量中，使用“printer1”、“printer2”作为该信息的映射键。然后删除这些 div。因为这一切都是在页面加载时完成的，所以用户永远不会看到任何这些。

然后，无论何时选择一个项目，您都使用选择文本作为映射的键，该映射包含将在 printerInfo div 中的值/文本。然后只需将其文本字段更改为任何内容即可

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:10:45.557

您可以使用`.change()`事件来获取第一个需求

```
$('#printerSelect').on('change' , function() {
     // Code here
     var $this = $(this);
    var text = "No Printer Selected";
    if($this.find('option:selected').index() !== 0){
        text = $this.find('option:selected').text() + ' Selected';
    }     
    $('#printerInfo').html(text);
}).change();​​​​ 
```

**[检查演示](http://jsfiddle.net/sushanth009/TKmRZ/)**

If you want to get the Data from the server , then send in an AJAX request for a paricular option.

# java - 未实现的接口有什么用？

> ID：13464650
> 
> 赞同：2
> 
> 时间：2012-11-20T00:09:19.517
> 
> 标签：java, interface, abstract-class

我真的很想知道[这样的接口](http://code.google.com/p/hamcrest/source/browse/tags/hamcrest-java-1.1/hamcrest-core/src/main/java/org/hamcrest/Matcher.java)可以用来做什么。调用方法的目的

```
_dont_implement_Matcher___instead_extend_BaseMatcher_ 
```

很清楚，但是界面的目的是什么？

*如果我不希望人们实现一个接口，我根本不会提供任何接口*——抽象类可以完成这项工作。除非有一些我看不到的隐藏原因。有人可以吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T00:15:42.970

在我看来，Matcher 是一个旧接口，已被 BaseMatcher 取代，但尚未删除以保持与旧版本的兼容性。

编辑：

修订历史似乎支持这一点：[http ://code.google.com/p/hamcrest/source/diff?spec=svn46&r=46&format=side&path=/trunk/hamcrest-java/src/api/org/hamcrest/ Matcher.java](http://code.google.com/p/hamcrest/source/diff?spec=svn46&r=46&format=side&path=/trunk/hamcrest-java/src/api/org/hamcrest/Matcher.java)

# javascript - 使用 setTimeout 进行 Javascript 打印

> ID：13464652
> 
> 赞同：1
> 
> 时间：2012-11-20T00:09:37.273
> 
> 标签：javascript

我正在尝试在打开 pdf 和在 pdf 文件上调用打印功能之间设置延迟。目前什么都没有发生，但是如果我将打印功能移到 setTimeout 之外，它将调用打印功能，但这不是我想要的，因为它太快了，而且还没有加载 pdf。当我在 setTimeout 内放置警报时，它们会在指定的 3 秒内正常调用。

```
var pdfWin = window.open(docPath);
setTimeout(function() {
   pdfWin.print();
},3000) 
```

我的问题是：为什么不调用 print 函数？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T00:13:39.783

```
var pdfWin = window.open(docPath);
pdfWin.onload = function() {
    pdfWin.print();
}; 
```

在 chrome 中对我来说效果很好。

由于[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，您只能调用`.print()`与父窗口位于同一域的窗口。否则我可以在我的页面上打开你的 Facebook 并在那里提交一些表格；p

# java - 使用 java 将 XML 创建的按钮居中

> ID：13464653
> 
> 赞同：1
> 
> 时间：2012-11-20T00:09:41.600
> 
> 标签：java, android, xml, android-activity

是否可以使用 java 将使用 XML 创建的按钮居中？

我知道它们可以设置为不可见：

```
button1.setVisibility(View.GONE); 
```

基本上，我有一个 if 语句，我希望它这样做：

```
If (possibility == true) {
     //center button horizontally and stay the same vertically
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:04:31.697

看起来你应该能够做一些事情来达到这个效果：

```
RelativeLayout.Layoutparams params = (RelativeLayout.LayoutParams)button.getLayoutParams();
params.addRule(RelativeLayout.CENTER_HORIZONTAL);
params.addRule(RelativeLayout.BELOW, R.id.id_to_be_below);

button.setLayoutParams(params); //causes layout update 
```

相对布局有时很有趣，所以你可能不得不玩弄这些规则，直到你完全按照你想要的方式得到它，但这会让你走上正轨！

# mysql - 从两个现有表创建一个新表

> ID：13464654
> 
> 赞同：0
> 
> 时间：2012-11-20T00:09:42.657
> 
> 标签：mysql, join, left-join, inner-join, create-table

我需要在使用 JOIN创建新表时`cover_art`引用的表中添加一个新列，但我不记得我是如何做到的。`news``newsdetails`

这是包含表中`artistid`引用的 id 的`artists`表：

```
CREATE TABLE `news` (
`post_id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
`artistid` smallint(5) unsigned NOT NULL,
`title` varchar(150) NOT NULL,
`cover_art` varchar(150) NOT NULL,
`blog_entry` text NOT NULL,
`updated` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
`rating` varchar(150) NOT NULL,
PRIMARY KEY (`post_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=76 ;

INSERT INTO `news` (`post_id`, `artistid`, `title`, `cover_art`, `blog_entry`,     `updated`, `rating`) VALUES
(1, 1, 'Ultra', 'images/temp_cover.jpg', 'The very first track Barrel Of A Gun is blah blah.', '2012-11-19 16:23:19', '990,568'),
(2, 13, 'Mish Mash', 'images/temp_cover.jpg', 'A train pulls into a station and etc etc ad infinitum.', '2012-11-19 16:23:44', '831,880'), 
```

这`artists`是具有我包含在其中的 id 的表`news`：

```
CREATE TABLE `artists` (
`id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
`artists_name` varchar(150) NOT NULL,
PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=170 ;

INSERT INTO `artists` (`id`, `artists_name`) VALUES
(1, 'Depeche Mode'),
(2, 'Amon Tobin'),
Etc. 
```

我已经考虑过进行内连接和左连接，但我一生都记不起我为创建这个变成的`newsdata`表所做的事情：`artistid``artists_name`

1 post_id smallint(5) UNSIGNED No 0
2 title varchar(150) latin1_swedish_ci No None
3 blog_entry text latin1_swedish_ci No None
4 updated timestamp No 0000-00-00 00:00:00
5 rating varchar(150) latin1_swedish_ci No None
6 Artist_name varchar (150) latin1_swedish_ci 无 无

感谢 eggyal 让我知道外键是什么 - 即不这样做:-(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:21:05.400

```
SELECT news.post_id,
       news.title,
       news.blog_entry,
       news.updated,
       news.rating,
       artists.artists_name
FROM   news JOIN artists ON artists.id = news.artistid 
```

# android - Android在View里面获取手机屏幕尺寸

> ID：13464663
> 
> 赞同：3
> 
> 时间：2012-11-20T00:10:15.260
> 
> 标签：android

我正在尝试绘制 x 和 y 轴线，但我无法获取用户的手机尺寸。这是如何在视图中完成的？我试过这个：

```
DisplayMetrics dm = new DisplayMetrics();
int width = dm.widthPixels;
int height = dm.heightPixels; 
```

整个Android类代码如下： http: [//pastebin.com/J02irHd8](http://pastebin.com/J02irHd8)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-20T00:14:36.277

在 Activity 或 Context 中运行以下代码：

```
getResources().getDisplayMetrics().widthPixels 
```

如果您在视图中，请尝试

```
getContext().getResources().getDisplayMetrics().widthPixels 
```

# jquery - jQuery on（）不起作用

> ID：13464665
> 
> 赞同：1
> 
> 时间：2012-11-20T00:10:36.587
> 
> 标签：jquery

我有下面的代码动画 div (#feedback-form-container) 滑入和滑出，当点击它跳到屏幕的中心，然后这些幻灯片动画被关闭。一旦提交了 div 中的表单并且表单返回到原来的位置，我想再次打开这些动画，但这不起作用。我试图为此使用 on() ，但没有成功。有人能发现问题吗？我难住了。

```
/////////////////////feedback form animation//////////////////////
jQuery(document).ready(function($) {
  //find center of screen
  var $screenwidth = $(window).width();
  var $screencenter = $screenwidth / 2 - 177;
  var $startpos = $screencenter + 260;
  var overlay = jQuery('<div id="simpleoverlay"> </div>');

  //hover to slide functions
  $('div#feedback-form-container').hover(function() {
    $('div#feedback-form-container').animate({
      left: '+=260px'
    },
    '2000');
  },

  function() {
    $('div#feedback-form-container').animate({
      left: '-=260px'
    },
    '6000');

  });
  //click to slide to center of screen
  $('div#feedback-form-container').click(function() {
    $('div#feedback-form-container').animate({
      left: '+=' + $screencenter
    },
    {
      duration: '2000',
      easing: 'swing',
      complete: setTimeout(function() {
        overlay.appendTo(document.body)
      },
      500)
    });

    //unbind functions
    if ($('div#feedback-form-container').is(':animated')) $('div#feedback-form-container').off('click').off('hover');
    //set cursor back to default
    $('div#feedback-form-container').css('cursor', 'default');

  });

  $('#wpcf7-f52-t1-o1').submit(function() {

    $('div#feedback-form-container').animate({
      left: '-=' + $startpos
    },
    '6000');

    $('div#feedback-form-container').on('hover').on('click');
  }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T00:18:01.423

和方法不用于打开`on`和`off`关闭事件，尽管名称有些混乱。该`on`方法用于绑定事件，该`off`方法用于取消绑定事件。

当您取消绑定事件时，它会从元素中消失。要再次使用该事件，您必须再次绑定它，为此您必须指定要为其使用的事件处理程序。仅仅指定事件是不够的，因为元素不记得之前的事件处理程序。

using与 using`.click(func)`具有相同的效果`.on('click', func)`。

# version - 在较低版本的 JRE 中运行 java 程序

> ID：13464666
> 
> 赞同：1
> 
> 时间：2012-11-20T00:10:37.123
> 
> 标签：version, java

在 JRE X 中设计和编译的程序在 JRE Y, Y 中运行时将如何运行

它会根本不运行，一启动就终止，还是会一直运行直到遇到 JRE Y 中不存在的方法或类然后崩溃？

如果是后者，我可以在启动时进行版本检查并通知用户他需要更新他的 Java 才能运行程序（如果他有 JRE Y）。

如果这不起作用，还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T01:57:45.387

如果一个程序是用 Java X 构建的，并以 Java > X 运行，那么它将毫无问题地运行。

如果一个程序是用 Java X 构建并在 Java < X 下运行的，那么当加载不兼容的程序类时，该程序可能会在执行期间的任何时候正常运行或意外终止。

程序类不兼容可能有两个原因：

1.  它引用了以前版本的 Java 中不可用的系统类。在这种情况下，您将看到 NoClassDefError。

2.  它使用了以前版本的 Java 中没有的语言特性。在这种情况下，您将看到 ClassFormatError。

您可以通过引用[System.getProperty("java.version")](http://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html)返回的数据来实现 Java 版本检查器。为确保检查器本身不会运行失败，您应该使用您期望遇到的最低 Java 版本对其进行编译。您必须进一步确保在对应用程序的其余部分进行任何代码引用之前尽早进行检查。这可能意味着在检查器中使用[Java 反射](http://docs.oracle.com/javase/tutorial/reflect/index.html)在成功检查时调用主程序类。

# amazon-ec2 - 如何访问与密钥对无关的ec2实例

> ID：13464674
> 
> 赞同：0
> 
> 时间：2012-11-20T00:10:58.237
> 
> 标签：amazon-ec2, amazon-web-services, key-pair

我有一个通过自动缩放自动启动的 ec2 实例。它没有与之关联的密钥对。我可以将现有的密钥分配给它吗？如果不是，我如何登录实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:55:31.313

如果你现在想通过 SSH 登录，我认为你不走运。密钥需要作为*as-create-launch-config*命令的一部分进行分配。

# scala - Scalaquery在加入同一张表时生成无效的sql

> ID：13464677
> 
> 赞同：0
> 
> 时间：2012-11-20T00:11:25.507
> 
> 标签：scala, scalaquery

我有一个查询需要左连接到同一个表上才能找到帐户的最新行。

```
val all = for { 
  Join(s,s1) <- Subscriptions leftJoin Subscriptions 
                  on ((a,b) => a.account === b.account &&  a.id < b.id)  
                  if s1.id.?.isNull
} yield s 
```

这会生成以下 SQL

```
SELECT `t2`.`ACCOUNT`,`t2`.`PLAN`,`t2`.`CALLBACK`,`t2`.`DELETED`,`t2`.`HIBERNATED`,`t2`.`CREATED`,`t2`.`UPDATED` FROM {oj `SUBSCRIPTION` `t2` left outer join `SUBSCRIPTION` `t2` on ((`t2`.`ID`=`t2`.`ID`) and (`t2`.`ID` < `t2`.`ID`))} WHERE (`t2`.`ID` is null) 
```

问题出在`Subscription t2 left join Subscription t2`. 这些表需要有不同的别名。

我通过将对象复制并粘贴到`Subscriptions`并将查询更改为

```
val all = for { 
  Join(s,s1) <- Subscriptions leftJoin Subscriptions1 
                  on ((a,b) => a.account === b.account &&  a.id < b.id)  
                  if s1.id.?.isNull
} yield s 
```

此查询生成有效的 SQL，但不太理想。

有没有解决的办法？如果它固定在 SLICK 中，那么将跳转到 scala 2.10。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T09:32:10.637

SLICK 0.11.2 适用于此用例。为此，我将我的项目迁移到 scala 2.10/play 2.1

# ajax - 如何调试不呈现 HTML 或运行 javascript 的冷融合脚本？

> ID：13464680
> 
> 赞同：4
> 
> 时间：2012-11-20T00:11:49.670
> 
> 标签：ajax, debugging, coldfusion, server-side

我正在使用 JavaScript 插件将文件上传到 ColdFusion 应用程序。它使用 AJAX 与服务器通信，并期望 JSON 作为回报。（相当标准）我有两个 cfm 脚本。

第一个包含插件的表单。

第二个处理实际的上传、删除、返回文件列表等。

第二个脚本将 JSON 作为纯文本返回，供插件处理。

第二个脚本不呈现 HTML，发送回第一个脚本的 JSON 直接输入 js 插件。

实际上一切都很完美。我已经得到它来上传文件并返回文件列表。

我的问题：随着第二个脚本的代码变得越来越复杂，调试变得越来越困难。

它不渲染任何代码，所以 cfdump 没用。

我在黑暗中四处闲逛，没有错误消息或其他信息让我知道为什么某些东西不起作用。

我的限制：插件又大又复杂，如果我不需要的话，我不想弄乱它。而且我不应该弄乱它，因为它可以完美运行，问题出在我的 cf 代码上。

我也无权访问该项目的管理区域。

但我需要一些方法来记录或调试这段代码。

我的解决方案：我一直在对第三个文件执行 cfdump，但这是一个不太理想的解决方案，因为我花了一半时间编码和一半时间更改 cfdump 解决方案以满足新的需求。并且还改进了我的 cfdump 记录器以处理不同的情况。不过，我不想通过编写自己的记录器来重新发明轮子，我只想编写代码。我让我的管理员安装 AJAX 记录器，但没有意识到它是用来记录 JavaScript，而不是 ColdFusion。所以这也行不通。

我知道人们已经为 AJAX 使用过 ColdFusion。我不可能是唯一一个遇到这个问题的人。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T13:47:07.060

不要忘记简单而强大的`<cflog>`标签。您可以在代码中的任何位置转储变量，如果要转储结构，您可以使用`serializeJSON(someStruct)`在日志中查看整个结构（或转换为结构的对象）。将它与 Eclipse/CFBuilder 中的尾部视图结合起来，您就可以实时了解非 HTML 生成代码的内部工作方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T07:49:56.920

如果您使用的是 Firefox，请在其上安装 Firebug。在控制台选项卡中，您可以看到所有 Ajax 请求，展开请求转到“HTML”选项卡。在“HTML”选项卡中，您将能够看到由服务器页面（您的第二个脚本）创建的 Html 模板，您还可以在那里找到冷融合错误。Firebug 是使用 Ajax 的一个很好的工具，希望这对你也有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T11:22:18.933

我建议使用`<cftry>`并邮寄错误`<cfmail type="html" ...><cfdump ...`以深入了解您的脚本。

例子：

```
<CFTRY>
    <CFSET thingsmightgowronghere &= "foo" />
    <CFCATCH type="any">
        <CFMAIL from="debug@example.com" to="you@yours.com" subject="#cfcatch.Message#" type="html"><CFDUMP var="#cfcatch#" /></CFMAIL>
    </CFCATCH>
</CFTRY> 
```

也可以使用 firebug 进行调试，但是如果您 cfdump 某些东西并在 firebug 中查看它，那么爬过 cfdump 创建的 css/js 就不太舒服了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T17:56:52.083

我很好奇由于缺少 html 标签而导致 cfdump 不可用的信念。我只使用以下代码创建了一个页面：

```
<cfsetting showdebugoutput="no">
<cfset foo = "bar">
<cfdump var="#foo#"> 
```

而当我浏览它时，浏览器中出现了“bar”这个词。

# php - 如何将图片上传到 Amazon s3 存储桶和子文件夹并使用 php foreach 显示

> ID：13464684
> 
> 赞同：0
> 
> 时间：2012-11-20T00:12:27.127
> 
> 标签：php, amazon-s3

我在这里使用代码：http: [//net.tutsplus.com/tutorials/php/how-to-use-amazon-s3-php-to-dynamically-store-and-manage-files-with-ease/](http://net.tutsplus.com/tutorials/php/how-to-use-amazon-s3-php-to-dynamically-store-and-manage-files-with-ease/)

...为登录时上传图片供个人使用的用户创建存储桶和子目录。

将图片成功上传到s3服务器后，它们会以列表的形式显示在html文件中，如下所示：

```
 <ul id="sortable-list">

    <?php
    $i = 0;
    $contents = $s3->getBucket("bucket_name");

    foreach($contents as $file)
    {

    $fname = $file['name'];                 
    $furl = "http://bucket_name.s3.amazonaws.com/".$fname;  

        echo "<li class=\"default\"><img src=\"$furl\" width=\"100\"></li>";

        {
            $i = 0;
        }

    }
    ?>
 </ul> 
```

出于某种原因，子文件夹被识别为存储桶内的文件并填充`$contents`as的第一个元素`http://bucket_name.s3.amazonaws.com/subfolder/`，但在没有引用文件名的情况下当然是空的。

我使用的 php 是上面引用的 tutsplus.com 教程中 page.php 的修改形式。与创建存储桶和子目录有关的代码在这里：

```
 if(isset($_POST['Submit'])){

        $fileName = $_FILES['theFile']['name'];
        $fileTempName = $_FILES['theFile']['tmp_name'];
        $folderName = "subfolder/$fileName";

        $s3->putBucket("unique_id", S3::ACL_PUBLIC_READ);

        if ($s3->putObjectFile($fileTempName, "unique_id", $folderName, S3::ACL_PUBLIC_READ)) {
            echo "<strong>We successfully uploaded your file.</strong>";
        }else{
            echo "<strong>Something went wrong while uploading your file... sorry.</strong>";
        }
    } 
```

需要帮助弄清楚如何防止子文件夹被识别为文件并在显示中创建元素。非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-04T13:04:31.803

使用`putbucket()`函数后使用`$folder`这样的名称：

```
$s3->putBucket("file_bucket", S3::ACL_PUBLIC_READ);
            $foldername = "anirudh/$fileName"; 
```

然后使用这些功能

```
if ($s3->putObjectFile($fileTempName, "file_bucket",
           $foldername, S3::ACL_PUBLIC_READ)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T01:47:10.773

几种解决方案：

1.  （最简单）如果它以斜线结尾，它就是一个文件夹。即检查 substr($fname,-1) == '/' 你有一个文件夹

2.  （更整洁）您可以使用带有 PCRE 的[get_object_list](http://docs.amazonwebservices.com/AWSSDKforPHP/latest/index.html#m=amazons3/get_object_list)调用来仅获取文件夹名称后包含某些内容的文件。如果您知道文件夹名称，这很有效。

3.  （可能的，未经测试）检查 $file['size'] - 如果为零，则它是文件夹或空文件。由于您无论如何都不想要空文件，因此这可能是一种选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-24T06:23:18.227

[第 1 步：从https://github.com/tpyo/amazon-s3-php-class/blob/master/S3.php](https://github.com/tpyo/amazon-s3-php-class/blob/master/S3.php)下载库

第 2 步：在您的项目中配置它

第3步：按照以下代码

```
 $fileTempName= $_FILES["file"]['tmp_name'];

            $bucket_name = "your_bucket_name";

            $upload_folder ="foldername" (which is created by you (folder) in aws  )

            $companyId = "subfolder name";

           $s3 = new S3("your access_key", "your secret_key"));
           $s3->putObject($fileTempName,$bucket_name,$upload_folder.'/'.$companyId); 
```

# php - PHP文件上传文件错误

> ID：13464686
> 
> 赞同：4
> 
> 时间：2012-11-20T00:12:54.653
> 
> 标签：php

我正在尝试使用 php 上传图像文件。我正在使用一个简单的文件上传代码，例如 www.w3schools.com/php/php_file_upload.asp，但是有时 php 文件无法上传图片，

图像不是那么大。一个只有 130kb 大小，上传过程可以正常上载 48%，然后在很长一段时间后减慢到 72%，并给我一个错误“请求不完整”。有什么办法可以解决这个谢谢。

**编辑**

代码 ：

```
$allowedExts = array("jpg", "jpeg", "gif", "png");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/png")
|| ($_FILES["file"]["type"] == "image/pjpeg"))
&& ($_FILES["file"]["size"] < 2000000)
&& in_array($extension, $allowedExts))
  {
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
    }
  else
    {
    echo "Upload: " . $_FILES["file"]["name"] . "<br />";
    echo "Type: " . $_FILES["file"]["type"] . "<br />";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
    echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br />";

    if (file_exists("upload/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],
      "upload/" . $_FILES["file"]["name"]);
      echo "Stored in: " . "upload/" . $_FILES["file"]["name"];
      }
    }
  }
else
  {
  echo "Invalid file";
  } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-05-02T15:37:29.640

我觉得你应该先试试

```
$foo = explode('.', $_FILES['file']['name']);
$extension = end($foo);

move_uploaded_file($_FILES["file"]["tmp_name"],
                   "upload/" . $_FILES["file"]["name"]);
echo "Stored in: " . "upload/" . $_FILES["file"]["name"]; 
```

然后：

*   增加要上传的图片数量
*   然后在所有内容所在的文件中，使用您希望存储图片的位置创建文件夹，该文件夹应命名为`upload`

# java - HashMap containsKey 方法

> ID：13464688
> 
> 赞同：0
> 
> 时间：2012-11-20T00:13:02.240
> 
> 标签：java, hash, hashtable

我正在用 java 编写 HashMap 的实现，并且在 containsKey 方法中定位正确的存储桶时遇到了一些问题

```
public class MyHashMap<K, V> {

LinkedList<MyEntry>[] table;
int size;
float maxLoadFactor;

public boolean containsKey(K key) {

    if(this.isEmpty())
        return false;
    if(table[table.length % key.hashCode()].isEmpty())
        return false;
    else {
    for(int i = 0; i < table[table.length % key.hashCode()].size(); i++) { 
        if(table[table.length % key.hashCode()].get(i).key == key)
            return true;
        }
    }
    return false;
} 
```

我遇到的问题主要是 table[table.length % key.hashCode()]。我认为这不是为哈希表找到正确存储桶的正确方法，但我不确定是什么。任何帮助表示赞赏。如果您有任何问题，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T01:49:13.927

在您使用的每个地方`table.length % key.hashCode()`，它都应该是`key.hashCode() % table.length`。这意味着如果 hashCode 大于表的大小，它将“环绕”到开头。或者更确切地说，它计算 key.hashCode()/table.length 的剩余部分并将其放在那里。希望有帮助！

# c++ - Berkelium 渲染纹理

> ID：13464690
> 
> 赞同：1
> 
> 时间：2012-11-20T00:13:09.743
> 
> 标签：c++, opengl, berkelium

我有一个使用 berkelium 的 OpenGL 应用程序。它编译得很好。我已经将图像加载/纹理添加到应用程序中，并且可以在 OpenGL 中将纹理绘制到 3d 对象上。

但是，当我从`glut_input`示例中导入 berkelium 代码（包含在 berkelium 中）时，来自的代码`mapOnPaintToTexture(..)`似乎没有获取图像并将其正确加载到 OpenGL 纹理中……至少，我无法让它工作。它在 berkelium 提供的示例中确实有效，所以我确定这是我正在做的事情。

如果我从示例中复制代码`ppmrender`（此示例获取网页并将其“渲染”为图像，然后将其保存到磁盘），我可以让它毫无问题地将 .ppm 文件保存到 /tmp 中（我也可以加载那些图像并将它们渲染为 3d 对象）。

我`onPaint(..)`的委托中的方法正在被调用，`mapOnPaintToTexture(..)`方法也是如此。

这是我的onPaint：

```
// gets called when berkelium has stuff we need to paint
onPaint(Berkelium::Window* wini,
    const unsigned char *bitmap_in, const Berkelium::Rect &bitmap_rect,
    size_t num_copy_rects, const Berkelium::Rect* copy_rects,
    int dx, int dy, const Berkelium::Rect& scroll_rect) {
        bool updated = mapOnPaintToTexture(
            wini, bitmap_in, bitmap_rect, num_copy_rects, copy_rects,
            dx, dy, scroll_rect,
            web_texture, width, height, false, scroll_buffer
        );
} 
```

和我的 mapOnPaintToTexture：

```
mapOnPaintToTexture(
    Berkelium::Window *wini,
    const unsigned char* bitmap_in, const Berkelium::Rect& bitmap_rect,
    size_t num_copy_rects, const Berkelium::Rect *copy_rects,
    int dx, int dy,
    const Berkelium::Rect& scroll_rect,
    unsigned int dest_texture,
    unsigned int dest_texture_width,
    unsigned int dest_texture_height,
    bool ignore_partial,
    char* scroll_buffer) {

    BOOST_LOG_TRIVIAL(debug) << "mapOnPaintToTexture: " << dest_texture_width << "x" << dest_texture_width << " dest_texture: " << dest_texture;

    glBindTexture(GL_TEXTURE_2D, dest_texture);

    const int kBytesPerPixel = 4;

    // If we've reloaded the page and need a full update, ignore updates
    // until a full one comes in.  This handles out of date updates due to
    // delays in event processing.
    if (ignore_partial) {
        if (bitmap_rect.left() != 0 ||
            bitmap_rect.top() != 0 ||
            bitmap_rect.right() != dest_texture_width ||
            bitmap_rect.bottom() != dest_texture_height) {
            return false;
        }

        glTexImage2D(GL_TEXTURE_2D, 0, kBytesPerPixel, dest_texture_width, dest_texture_height, 0,
            GL_BGRA, GL_UNSIGNED_BYTE, bitmap_in);
        ignore_partial = false;
        return true;
    }

    BOOST_LOG_TRIVIAL(debug) << "mapOnPaintToTexture: here 1";

    // Now, we first handle scrolling. We need to do this first since it
    // requires shifting existing data, some of which will be overwritten by
    // the regular dirty rect update.
    if (dx != 0 || dy != 0) {
        // scroll_rect contains the Rect we need to move
        // First we figure out where the the data is moved to by translating it
        Berkelium::Rect scrolled_rect = scroll_rect.translate(-dx, -dy);
        // Next we figure out where they intersect, giving the scrolled
        // region
        Berkelium::Rect scrolled_shared_rect = scroll_rect.intersect(scrolled_rect);
        // Only do scrolling if they have non-zero intersection
        if (scrolled_shared_rect.width() > 0 && scrolled_shared_rect.height() > 0) {
            // And the scroll is performed by moving shared_rect by (dx,dy)
            Berkelium::Rect shared_rect = scrolled_shared_rect.translate(dx, dy);

            int wid = scrolled_shared_rect.width();
            int hig = scrolled_shared_rect.height();

            if (DEBUG_PAINT) {
              std::cout << "Scroll rect: w=" << wid << ", h=" << hig << ", ("
                        << scrolled_shared_rect.left() << "," << scrolled_shared_rect.top()
                        << ") by (" << dx << "," << dy << ")" << std::endl;
            }

            int inc = 1;
            char *outputBuffer = scroll_buffer;
            // source data is offset by 1 line to prevent memcpy aliasing
            // In this case, it can happen if dy==0 and dx!=0.
            char *inputBuffer = scroll_buffer+(dest_texture_width*1*kBytesPerPixel);
            int jj = 0;
            if (dy > 0) {
                // Here, we need to shift the buffer around so that we start in the
                // extra row at the end, and then copy in reverse so that we
                // don't clobber source data before copying it.
                outputBuffer = scroll_buffer+(
                    (scrolled_shared_rect.top()+hig+1)*dest_texture_width
                    - hig*wid)*kBytesPerPixel;
                inputBuffer = scroll_buffer;
                inc = -1;
                jj = hig-1;
            }

            // Copy the data out of the texture
            glGetTexImage(
                GL_TEXTURE_2D, 0,
                GL_BGRA, GL_UNSIGNED_BYTE,
                inputBuffer
            );

            // Annoyingly, OpenGL doesn't provide convenient primitives, so
            // we manually copy out the region to the beginning of the
            // buffer
            for(; jj < hig && jj >= 0; jj+=inc) {
                memcpy(
                    outputBuffer + (jj*wid) * kBytesPerPixel,
//scroll_buffer + (jj*wid * kBytesPerPixel),
                    inputBuffer + (
                        (scrolled_shared_rect.top()+jj)*dest_texture_width
                        + scrolled_shared_rect.left()) * kBytesPerPixel,
                    wid*kBytesPerPixel
                );
            }

            // And finally, we push it back into the texture in the right
            // location
            glTexSubImage2D(GL_TEXTURE_2D, 0,
                shared_rect.left(), shared_rect.top(),
                shared_rect.width(), shared_rect.height(),
                GL_BGRA, GL_UNSIGNED_BYTE, outputBuffer
            );
        }
    }

    BOOST_LOG_TRIVIAL(debug) << "mapOnPaintToTexture: here 2";
    if (DEBUG_PAINT) {
      std::cout << (void*)wini << " Bitmap rect: w="
                << bitmap_rect.width()<<", h="<<bitmap_rect.height()
                <<", ("<<bitmap_rect.top()<<","<<bitmap_rect.left()
                <<") tex size "<<dest_texture_width<<"x"<<dest_texture_height
                <<std::endl;
    }

    for (size_t i = 0; i < num_copy_rects; i++) {
        int wid = copy_rects[i].width();
        int hig = copy_rects[i].height();
        int top = copy_rects[i].top() - bitmap_rect.top();
        int left = copy_rects[i].left() - bitmap_rect.left();

        if (DEBUG_PAINT) {
            std::cout << (void*)wini << " Copy rect: w=" << wid << ", h=" << hig << ", ("
                      << top << "," << left << ")" << std::endl;
        }

        for(int jj = 0; jj < hig; jj++) {
            memcpy(
                scroll_buffer + jj*wid*kBytesPerPixel,
                bitmap_in + (left + (jj+top)*bitmap_rect.width())*kBytesPerPixel,
                wid*kBytesPerPixel
                );
        }

        // Finally, we perform the main update, just copying the rect that is
        // marked as dirty but not from scrolled data.
        glTexSubImage2D(GL_TEXTURE_2D, 0,
                        copy_rects[i].left(), copy_rects[i].top(),
                        wid, hig,
                        GL_BGRA, GL_UNSIGNED_BYTE, scroll_buffer
            );
    }
    BOOST_LOG_TRIVIAL(debug) << "mapOnPaintToTexture: here 3";

    glBindTexture(GL_TEXTURE_2D, 0);

    return true;
} 
```

我的渲染代码如下所示：

```
testDrawTestBerkelium() {
    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
    glEnable( GL_TEXTURE_2D );
    glBindTexture(GL_TEXTURE_2D, web_texture);

    // display   
    glBegin(GL_QUADS);
        glTexCoord2f(0.f, 0.f); glVertex3f(-10.f, -10.f, 0.f);
        glTexCoord2f(0.f, 1.f); glVertex3f(-10.f,  10.f, 0.f);
        glTexCoord2f(1.f, 1.f); glVertex3f( 10.f,  10.f, 0.f);
        glTexCoord2f(1.f, 0.f); glVertex3f( 10.f, -10.f, 0.f);
    glEnd();

    Berkelium::update();
} 
```

我的初始化函数如下所示：

```
initialize() {
    if (!Berkelium::init(Berkelium::FileString::empty())) {
        BOOST_LOG_TRIVIAL(debug) << "Failed to initialize berkelium!";
        return -1;
    }

    scroll_buffer = new char[width*(height+1)*4];

    // Create texture to hold rendered view
    glGenTextures(1, &web_texture);
    glBindTexture(GL_TEXTURE_2D, web_texture);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);

    Berkelium::Context* context = Berkelium::Context::create();
    Berkelium::Window* window = Berkelium::Window::create(context);
    delete context;

    width = 600;
    height = 600;

    //MyDelegate* delegate = new MyDelegate();
    window->setDelegate(this);
    window->resize(width, height);
    std::string url = "http://yahoo.ca";
    window->navigateTo(Berkelium::URLString::point_to(url.data(), url.length()));
} 
```

我认为这就是所有相关的部分。当我加载程序时，我只在屏幕上看到一个灰色方块。

有没有人看到我做错了什么明显的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:46:57.413

看起来我没有调用`glTexImage2D(..)`网页的纹理。

我需要`onPaint(..)`像这样修改：

```
bool updated = mapOnPaintToTexture(
            wini, bitmap_in, bitmap_rect, num_copy_rects, copy_rects,
            dx, dy, scroll_rect,
            web_texture, width, height, true, scroll_buffer
        ); 
```

`true`为`ignore_partial`参数添加。为了更健壮，我可以`glut_input`更密切地遵循 berkelium 示例并实现部分更新。

感谢所有阅读我帖子的人。

干杯

# c++ - 在运行时获取/设置模板结构的静态成员

> ID：13464692
> 
> 赞同：1
> 
> 时间：2012-11-20T00:13:15.970
> 
> 标签：c++, templates, static

我试图在运行时使用带有静态成员的模板结构存储有关类的信息，但是我无法获取或设置静态成员而不会出现错误。

为什么这段代码不起作用？

```
template <typename T>
struct InfoHolder
{
    static const char* name;    
};

int main()
{
    InfoHolder<int>::name = "This is an integer";
    cout << InfoHolder<int>::name << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:22:53.240

如果您收到链接器错误。您必须在`name`某处定义变量。（在类中声明它不会在任何地方分配它，因为它不是对象的一部分）

在课后和 main 之前写下：

```
template <typename T>
const char *InfoHolder<T>::name; 
```

这是静态数据成员的一个小不便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:28:04.130

我看到它在其他地方被使用；

由于未分配结构中的静态成员，因此我可以使用函数中的静态成员，并返回变量的指针。

```
template <typename T>
struct InfoHolder
{
    static const char** getName()
    {
        static const char* name;
        return &name;
    }
};

int main()
{
    *InfoHolder<int>::getName() = "This is an integer";
    *InfoHolder<MyClass>::getName() = "This is an MyClass";
    *InfoHolder<OtherClass>::getName() = "This is an OtherClass";
    cout << *InfoHolder<int>::getName() << endl;
    cout << *InfoHolder<MyClass>::getName() << endl;
    cout << *InfoHolder<OtherClass>::getName() << endl;
} 
```

# java - 如何在Java中获取参数的变量名

> ID：13464695
> 
> 赞同：2
> 
> 时间：2012-11-20T00:13:35.547
> 
> 标签：java, parameters

我将一个对象作为参数传递给一个方法。我想知道那个对象的名称——我一直用来将对象传递给方法的特定引用变量。有没有办法找到这个？

或者，一般来说，有没有办法找出调用方法用来将该值传递给被调用方法的变量名称？提前致谢。

**注意**- 关于上面的第一个 Q：我知道一个对象可以有许多指向它的句柄。这是一个参数名称是否在方法中得到某种“特别关注”的问题，或者一旦它们传递了值就没有任何问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:21:21.567

我相信您所要求的不仅仅是 Java 放在堆栈上的信息。JVM在获取变量持有的句柄并将其放入堆栈以调用方法时，没有理由记录变量的名称。事实上，通常没有真正的理由在编译后保留该名称。如果你能提供更多关于你为什么想做这样的事情的信息，你可能会得到更合理的回应。

如果您想要的东西是可能的，那将是通过[StackTraceElement](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StackTraceElement.html)，但看看 API，没有什么像您所要求的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T00:30:06.217

这样做行不通的原因不止一个。最重要的是：

函数的参数不必是变量。您可以请求表达式的文本表示，但这需要与程序一起存储大量未使用的数据。甚至变量名都没有与程序一起存储。编译保留的唯一变量名称是静态和实例字段和方法。即使那样，也没有办法（除了试图反编译调用者）来访问调用表达式。

如果您需要一个函数来获取此类数据，则需要将其作为单独的参数提供：

```
doLog(foo, "foo");
doLog(new Foo(), "new Foo()");
/*or*/ doLog(new Foo(), null); 
```

# hex-editors - 以这种方式使用十六进制编辑器修改文件是否安全？

> ID：13464697
> 
> 赞同：3
> 
> 时间：2012-11-20T00:13:40.127
> 
> 标签：hex-editors

我想用十六进制编辑器修改一个文件（添加一些新代码/功能），但我不确定我是否会在程序中为新材料找到足够的空白空间。所以我有几个关于什么是安全的问题：

1.  该文件在结尾处有大量的 00 序列，这几乎肯定就足够了。写这个安全吗，还是我必须担心该区域保留给程序在正常操作过程中写入？
2.  如果我必须增加文件大小，是否存在通过覆盖其他文件而损坏其他文件的危险（如果这很重要，我正在使用 HxD）？我有更大文件的空间，我只是不想损坏其他文件。
3.  如果我确实更改了文件大小，是否还有其他需要更改以匹配的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:16:46.193

您不能只在程序末尾添加字节并期望它知道如何处理它们。

# sql - 检测到评论的 SQL 已读取

> ID：13464698
> 
> 赞同：0
> 
> 时间：2012-11-20T00:13:59.447
> 
> 标签：sql, codeigniter-2

我有一个我正在尝试解决的问题。

我正在尝试将更多逻辑放入我的 sql 调用中，以减少 php 必须执行的操作。一个这样的地方是确定用户是否已阅读某条消息的逻辑。它可以工作，但效果太好了，这是 SQL：

```
SELECT t.* FROM comment c
LEFT JOIN read_message rm ON c.id-rm.cid
WHERE c.author!=2 AND rm.User=2 AND c.tid=17 AND rm.Topic=17 AND c.Original_Date >=  UNIX_TIMESTAMP()-3600*24*30 OR c.last_update >= UNIX_TIMESTAMP()-3600*24*30 
```

问题是无论输入什么消息 ID，它总是会显示每条被认为是新的记录，但我希望它仅在 id 匹配时才显示。

简化我想要的：

根据消息 ID，我们可以查看用户是否已经阅读了此消息，但如果该消息超过 30 天，则自动将其视为旧消息。

问题是 30 天的数学，如果我把那部分拿出来它可以正常工作，但我希望它忽略任何超过 30 天的东西。

我在标签中列出了 codeigniter，因为这是我正在使用的框架，以防你需要知道这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:30:06.580

如果您使用的是 mysql，您应该能够使用以下 SQL 来获取最近 30 天内的消息。

```
SELECT t.* FROM comment c
LEFT JOIN read_message rm ON c.id-rm.cid
WHERE c.author!=2 AND rm.User=2 AND c.tid=17 AND rm.Topic=17 AND
(c.Original_Date BETWEEN DATE_SUB(NOW(), INTERVAL 30 DAY) AND NOW())
OR (c.last_update BETWEEN DATE_SUB(NOW(), INTERVAL 30 DAY) AND NOW()) 
```

与此类似的东西应该适用于您的示例。

# php - Google Drive SDK：从 generateAssertion() 获取令牌后的下一步

> ID：13464702
> 
> 赞同：0
> 
> 时间：2012-11-20T00:14:18.370
> 
> 标签：php, google-drive-api, service-accounts

好的，我正在尝试使用 Google Drive SDK 设置我的应用程序。我将其用作服务帐户，因此设置略有不同。这就是我做事的方式：

包括所需文件：

```
require_once 'google-api-php-client/src/Google_Client.php';
require_once 'google-api-php-client/src/auth/Google_AssertionCredentials.php';
require_once "google-api-php-client/src/contrib/Google_Oauth2Service.php"; 
```

定义常量：

```
DEFINE("TRUE_PATH",$_SERVER["DOCUMENT_ROOT"].'path/to/file');
DEFINE("SERVICE_ACCOUNT_EMAIL","somecode@developer.gserviceaccount.com");
DEFINE("DRIVE_SCOPE","https://www.googleapis.com/auth/drive"); 
```

功能：

```
function generateAssertion() {

    $assertionCredentials = new Google_AssertionCredentials();

    $assertionCredentials->serviceAccountName='somecode@developer.gserviceaccount.com';

    $assertionCredentials->privateKey=
    TRUE_PATH.'9e01fd1414aa082fadeec316161eb7028558fbde-privatekey.p12';

    $assertionCredentials->privateKeyPassword = 'notasecret';
    $p12cert = array();
    $file = TRUE_PATH.'9e01fd1414aa082fadeec316161eb7028558fbde-privatekey.p12';
    if (file_exists($file)) {
        try {
            $assertion = $assertionCredentials->generateAssertion();
            return $assertion;
        } catch (Exception $e) {
            d($assertionCredentials);
            return 'Caught exception: ' . $e->getMessage() . "\n";
        }
    } else {
        return "no p12 privatekey file";
    }
} 
```

行 $assertion = $assertionCredentials->generateAssertion(); 给了我一个看起来像这样的代码：

eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiJodHRwczpcL1wvYWNjb3VudHMuZ29vZ2xlLmNvbVwvb1wvb2F1dGgyXC90b2tlbiIsInNjb3BlIjpudWxsLCJpYXQiOjEzNTMzNjk3NzUsImV4cCI6MTM1MzM3MzM3NSwiaXNzIjoiMjY5Mjg1NDU2NjY0QGRldmVsb3Blci5nc2VydmljZWFjY291bnQuY29tIn0.KMBTsGZkhLhddBFtc0PB1qZgtdQYyirhWtYixCYx1zo5Otv9pCUBfvrCXOg3JzR-mzE6zHuCZdmGOD7w_LRwYHJpoo0rdpxDXLjtNCgFZdu1d21cVAnqTkIhMGvdS_K7JP_KioXyi-nBdvZt9IXKaApIdDKhRp-T5HByIeO2ijU

我的问题是，我该如何处理从 generateAssertion() 返回的代码/令牌，以便我可以访问我的驱动器帐户？我尝试将其用作访问令牌和刷新令牌，但没有成功。

如果这是一个愚蠢的问题，我深表歉意，但我是 sdk 的新手，任何帮助将不胜感激。

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:12:34.347

您不需要调用 generateAssertion()。相反，只需将凭据提供给客户端实例并让它完成生成断言的工作

```
$client = new Google_Client();
$client->setAssertionCredentials($assertionCredentials); 
```

有关其他详细信息，请参阅[http://code.google.com/p/google-api-php-client/wiki/OAuth2](http://code.google.com/p/google-api-php-client/wiki/OAuth2)。

# testng - 嵌套列表作为数据提供者？

> ID：13464703
> 
> 赞同：1
> 
> 时间：2012-11-20T00:14:21.927
> 
> 标签：testng

有没有一种相对简单的方法来创建一个 DataProvider 方法，该方法提供给一个将 List> 或 List 作为参数的测试方法？我们的混合框架将输入数据分解为动态块，只有一步的输入数量保持不变。我对如何按摩该方法感到有些困惑，以便我可以将这些输入到测试中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T14:21:00.963

我不确定我是否理解这个问题，你只是想将列表传递给你的测试方法吗？这个怎么样：

```
@DataProvider
public Object[][] dp() {
  return new Object[][] {
      new Object[] { ImmutableList.of(1, 2, 3) },
      new Object[] { ImmutableList.of(4, 5) },
  }
}

@Test(dataProvider = "dp")
public void test(List<Integer> l) {
  // ...
} 
```

# android - 如何获取在用户主屏幕上处于活动状态的应用程序小部件的列表？

> ID：13464706
> 
> 赞同：1
> 
> 时间：2012-11-20T00:14:39.267
> 
> 标签：android

从文档：

AppWidgetManager.getAppWidgetIds(ComponentName provider) 获取已绑定到给定 AppWidget 提供者的 appWidgetIds 列表。

这将返回一个小部件 ID 列表，其中包括已从主屏幕删除的小部件。除了跟踪添加/删除事件并将我自己的列表主线以检索此信息之外，还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-14T17:20:12.633

这是我的一些代码，如果您仍然需要它，它可以工作。

```
private void updateWidget() {
    // We want to make sure the widget is always up to date.
    AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(this.getApplicationContext());

    int[] appWidgetIds = appWidgetManager.getAppWidgetIds(new ComponentName(this, Widget.class));
    if(appWidgetIds.length > 0) {
        new Widget().onUpdate(this, appWidgetManager, appWidgetIds);
    }
} 
```

你可以在那里看到我如何能够获得我需要的所有 id。然后在这里我从一个活动更新我的小部件。

# c# - 如何为我的 AdomdConnection 设置连接超时？

> ID：13464715
> 
> 赞同：2
> 
> 时间：2012-11-20T00:15:45.900
> 
> 标签：c#, connection, connection-string, adomd.net

我已经彻底阅读了有关 AdomdConnection 的内容，但找不到如何在我的连接字符串中设置连接超时。我当前的连接字符串如下：

```
Data Source=MySSAS;Initial Catalog=MyCatalog 
```

但无论我做什么，任何变化，`Connection Timeout`或似乎都不会改变我的连接（[MSDN）](http://msdn.microsoft.com/en-us/library/microsoft.analysisservices.adomdclient.adomdconnection.connectionstring.aspx)`ConnectionTimeout``Connect Timeout``ConnectTimeout`

我在调试器中观察连接属性，并且总是将 getter 值`ConnectionTimeout`视为 0：

![在此处输入图像描述](../Images/28feef6855603cffc0def3a9521d9797.png)

不用说，该属性没有设置器。

有谁知道如何设置它？我只对连接超时感兴趣，而不是命令超时。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-20T04:37:41.720

我在[MSDN - SSAS Client Connection Timeout](http://social.msdn.microsoft.com/Forums/en-US/sqlanalysisservices/thread/6127a95e-fe12-4781-bee1-296651468baa/)找到了答案：

在 msmdsrv.ini 中：<InitialConnectTimeout>10</InitialConnectTimeout>

也许您可以通过在连接时运行跟踪来验证 SQL 的作用：

![在此处输入图像描述](../Images/d9eb5c48bd6c0390558147d7f8ae78e3.png)

*或者，即使您`Connection Timeout = 0`在客户端的 Visual Studio 中看到，服务器上的值也可能不同。*

另外不要忘记您可以使用 ping 服务器一分钟作为连接超时设置的替代方法。

# c# - “加载格式保存数据”的设计模式

> ID：13464716
> 
> 赞同：1
> 
> 时间：2012-11-20T00:15:51.063
> 
> 标签：c#, oop, design-patterns, design-principles

我需要完成一些事情，比如从 xls 源（ole db）加载数据，根据输出文件的规范对其进行格式化，合并已处理的字段，然后将其保存到 csv。

如何处理必须属于某种类型的多个数据字段？以某种方式格式化 - 等等。

我很难为这个问题抽象类结构。

哪种设计模式最适合我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:25:28.477

我最初不会去考虑设计模式，而是将你的问题分解成更小的部分，至少一开始是这样。

现在，您的描述可能有点含糊，无法真正深入了解实际处理的细节，但我可以从中确定至少三个部分：

*   数据阅读器
*   数据处理器
*   数据写手

你可能想把你的读者和作者都想成类似于你处理文件或流的方式。例如，您的读者可能有：

*   `Open`
*   `Read`（只读一项）
*   `Close`

作家也是如此，但`Write`.

抽象两个接口 an`IDataReader`和 an `IDataWriter`，并让您`IDataProcessor`与 reader 和 writer 进行交互，但只能通过接口。

拥有这些合同意味着您可以为阅读器（例如`XLSReader : IDataReader`和编写器）提供一个实现`CSVWriter : IDataWriter`，而处理器不必担心解决每个问题的内部方法。

有了这些抽象，您就可以为每个部分单独编写干净且独立的**单元测试**（通过模拟其他部分），这将使您可以在开发过程中测试每一步。

此外，这些类型的合同让您可以处理小数据包中的数据，而不是一大块数据（比如大数据之类的数据`DataTable`）、衡量进度等。

现在，根据您的实际要求，您可以拥有读者提供的数据类型的模式或定义，对于可以更改传入数据和构建输出等的输出、格式化程序和转换器也是如此。

# c++ - 无法在编辑控件上设置字体

> ID：13464717
> 
> 赞同：2
> 
> 时间：2012-11-20T00:15:57.997
> 
> 标签：c++, winapi

我很难为编辑控件设置字体。我用过`SendMessage(hwnd, WM_FONT, args)`，但是好像没什么效果。我添加了`EM_SETMODIFY`消息，但这也没有效果。这是我一直在使用的代码：

```
 class EditBox : public Wide::OS::EditBox {
        HWND box;
        std::unique_ptr<std::decay<decltype(*HFONT())>::type, decltype(&DeleteObject)> font; 
        Math::AbsolutePoint curr_pos;
        Math::AbsolutePoint curr_dim;
    public:
        void SetFont(std::shared_ptr<Render::Font> f) {
            font = decltype(this->font)(CreateFontIndirect(&dynamic_cast<Wide::Direct3D9::Font*>(f.get())->GetLogFont()), &DeleteObject);
            SendMessage(box, WM_SETFONT, reinterpret_cast<WPARAM>(font.get()), true);
            SendMessage(box, EM_SETMODIFY, true, 0);
        }
        EditBox(std::shared_ptr<Render::Font> font, HWND owner, Math::AbsolutePoint position, Math::AbsolutePoint dimensions, HINSTANCE hinst) 
        : curr_pos(position), curr_dim(dimensions), font(CreateFontIndirect(&dynamic_cast<Wide::Direct3D9::Font*>(font.get())->GetLogFont()), &DeleteObject){
            box = CreateWindowEx(
                0, 
                L"EDIT", 
                L"Type here", 
                WS_VISIBLE | WS_CHILD | WS_TABSTOP | ES_LEFT,
                position.x,
                position.y,
                dimensions.x,
                dimensions.y,
                owner,
                0,
                hinst,
                0);
            /*SetWindowSubclass(box, [](HWND hwnd, UINT msg, WPARAM wparam, LPARAM lparam, UINT_PTR, DWORD_PTR) -> LRESULT {
                if (msg != WM_PAINT)
                    return DefSubclassProc(hwnd, msg, wparam, lparam);
                PAINTSTRUCT paint;
                BeginPaint(hwnd, &paint);

                EndPaint(hwnd, &paint);
                return 0;
            }, 0, 0);*/
            SendMessage(box, WM_SETFONT, reinterpret_cast<WPARAM>(font.get()), true);
            SendMessage(box, EM_SETMODIFY, true, 0);
        }
        ~EditBox() { DestroyWindow(box); }
    }; 
```

我检查了我要返回的 LOGFONT 上的值，它们非常合理，但我可以根据要求显示它们。

关于为什么字体没有被改变的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T11:13:27.167

构造函数中该死的变量阴影。传递的指针实际上是 a `Render::Font*`，而不是`HFONT`来自存储的变量。当然，我没有正确测试是`SetFont`哪个不起作用，还是构造函数不起作用。如果只有 Windows 使用实际函数而不是那些令人讨厌的消息，所以我不必这样做`reinterpret_cast`，就会有一个很好的编译器错误。

# c - 将结构作为 void 指针传递给函数

> ID：13464721
> 
> 赞同：5
> 
> 时间：2012-11-20T00:16:12.000
> 
> 标签：c, memory, struct

我正在尝试将结构的指针传递给函数，但是当我尝试访问结构时，结构内的最后一个变量在其内存地址中缺少 1 个字节，导致使用该变量的任何内容出现段错误。

```
typedef struct
{
  pthread_t tID;
  int tType;
}sThread;

sThread threads[MAX_THREADS];

typedef struct
{
  int tID;
  int sock;
  int arg_count;
  char *from_p, **arg_p;
}command_struct;

pthread_t Thread_Start(void *function, void *param)
{
  pthread_t tHandle;

  pthread_create(&tHandle, NULL, function, (void*)param);

  return tHandle;
}

void cmd_test(int sock, char *from_p, char **arg_p, int arg_count)
{ 
  if(thread_check(1))
  {
    send_line(sock, "%s :test thread already running", from_p);
    return;
  }

  command_struct test;

  test.tID = thread_add(1);
  test.arg_count = arg_count;
  test.arg_p = arg_p;

  threads[test.tID].tID = Thread_Start(test_cmd, &test);
}

void *test_cmd(void *param)
{ 
  command_struct test = *((command_struct *)param);

  int i = 0;

  for(i = 1; i < test.arg_count; i++)
  {
    printf("%s", test.arg_p[i]);
  }

  thread_clear(test.tID);
  return NULL;
} 
```

发生的事情是在 cmd_test （产生线程的函数）中，结构被正确初始化并且所有变量都是正确的。

```
$1 = {tID = 0, sock = 5, arg_count = 5, from_p = 0xbffff254 "test", arg_p = 0xbfffec48} 
```

但是从运行线程内的 test_cmd 开始，structre 缺少 arg_p 地址的 1 个字节，导致：

```
$1 = {tID = 0, sock = 5, arg_count = 5, from_p = 0xbffff254 "test", arg_p = 0xffec48} 
```

如果我在我的 command_struct arg_p 地址的末尾添加了一个无用的变量，那么它就变得正确，并且 command_struct 中的最后一个变量在它的内存地址中丢失了 1 个字节。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T02:34:03.157

您正在将一个指向局部变量的指针传递给您的线程——当线程访问它时，内存已被重新用于其他用途。

试试这个：

```
void cmd_test(int sock, char *from_p, char **arg_p, int arg_count)
{ 
    if(thread_check(1))
    {
        send_line(sock, "%s :test thread already running", from_p);
        return;
    }

    // === begin modified code in cmd_test():
    command_struct* test = malloc(sizeof(command_struct));

    test->tID = thread_add(1);
    test->arg_count = arg_count;
    test->arg_p = arg_p;

    threads[test.tID].tID = Thread_Start(test_cmd, test);
    // === end modified code
}

void *test_cmd(void *param)
{ 
    command_struct test = *((command_struct *)param);
    free(param);    // <-- new line of code

    // remainder is the same...
    // ...
} 
```

# java - 如何在Java中的列中打印双精度数组

> ID：13464728
> 
> 赞同：-2
> 
> 时间：2012-11-20T00:16:51.943
> 
> 标签：java, string-formatting

我有3个这样的数组：

```
String[] monthName = { "January", "February", "March",  
                       "April", "May", "June", "July",  
                       "August", "September", "October",  
                       "November", "December" };  

Double[] temperature = {68.1,69.1,72.4,75.7,79.6,82.4,83.7,83.6,82.4,78.8,74.4,69.9};
Double[] precipitation = {1.9,2.1,2.6,3.4,5.5,8.5,5.8,8.6,8.4,6.2,3.4,2.2}; 
```

我怎么能像这样打印这个值：

```
 Climate Data
           Location:

Month      Temperature (F)    Precipitation (in.)
*************************************************
 Jan.          51.8                  5.4
 Feb.          54.8                  4.6
 Mar.          61.1                  6.5
 Apr.          66.4                  3.6
 May           74.4                  5.0
 Jun.          80.4                  6.9
 Jul.          82.4                  8.0
 Aug.          82.1                  7.0
 Sep.          78.9                  5.0
 Oct.          69.1                  3.3
 Nov.          60.4                  3.9
 Dec.          53.7                  4.1
************************************************* 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:29:05.227

查看[String.format()](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#format%28java.lang.String,%20java.lang.Object...%29)方法。

这是一个填充两个字符串的示例，使它们占据 12 列并左对齐：

```
String paddedOne = String.format("%-12s", "Hello");
String paddedTwo = String.format("%-12s", "Goodbye");
System.out.println(paddedOne + paddedTwo); 
```

输出：

```
Hello       Goodbye 
```

# javascript - 将鼠标悬停在图像顶部的图像锚上时出现 jQuery 问题

> ID：13464729
> 
> 赞同：3
> 
> 时间：2012-11-20T00:16:55.647
> 
> 标签：javascript, jquery, css, jquery-animate

我遇到了一些 HTML/CSS/jQuery 的问题。

```
<div class="project-thumbnail">
        <a href="http://www.google.com/">
            <span class="project-thumbnail-overlay overlay-color">Random Title</span>
            <img width="270" height="180" src="http://i45.tinypic.com/34fgner.jpg" />
        </a>
    </div>
    <div class="zoom-button">
        <a href="http://www.yahoo.com/">
            <img src="http://i46.tinypic.com/wme8ev.png" />
        </a>
    </div> 
```

你可以在这里看到我想要实现的目标：http: [//jsfiddle.net/NrtvK/1/](http://jsfiddle.net/NrtvK/1/)

基本上，大部分功能都有效。但是，当您将鼠标悬停在加号图标锚上时，它会使图像像疯了一样断断续续，并且会删除悬停的缩略图状态。

我希望这两种效果能够协同工作，但是加号图标指向一个单独的 URL，同时保持悬停状态，即使悬停在它上面也是如此。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:31:03.813

这是因为您的加号图标`.project-thumbnail`在鼠标离开时触发的外部。试着把它放在里面`.project-thumbnail`然后调整你的js和css。

像这样[http://jsfiddle.net/bondythegreat/Em4wh/](http://jsfiddle.net/bondythegreat/Em4wh/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:34:26.487

像这样试试 - [**DEMO**](http://jsfiddle.net/NrtvK/3/)

```
$('.portfolio-project').mouseenter(function(e) {    
    $(this).find('.project-thumbnail').children('a')
        .children('img').stop().animate({ height: imgHeight, left: '0', top: '0', width: imgWidth}, 100).end()
        .children('span').stop().fadeIn(200);
    $(this).find('.project-thumbnail').next('.zoom-button').show();
}).mouseleave(function(e) {
    $(this).find('.project-thumbnail').children('a')
        .children('img').stop().animate({ height: imgHeight + 33, left: '-20', top: '-20', width: imgWidth + 50}, 100).end()
        .children('span').stop().fadeOut(200);
    $(this).find('.project-thumbnail').next('.zoom-button').hide();
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:34:17.537

我认为问题在于，当您将鼠标移到触发`project-thumbnail`鼠标离开处理程序的加号图标上时，该处理程序隐藏了加号图标，这反过来又触发`project-thumbnail`鼠标进入处理程序再次显示加号图标 - 但您的鼠标已经在加号上方这样就会再次触发鼠标离开处理程序，等等等等。当然，口吃是因为动画反复开始和停止。

您也许可以修改您的 html 结构，将加号链接放在`project-thumbnail`div 内 - bondythegreat's 已经覆盖了那里。

或者你可以尝试这样的破解：

```
var projectThumbnail = $('.project-thumbnail'),
        imgWidth = projectThumbnail.width(),
        imgHeight = projectThumbnail.height(),
        timeoutID; // <-- new variable

    projectThumbnail.mouseenter(function(e) {    
        $(this).children('a').children('img').stop().animate({ height: imgHeight, left: '0', top: '0', width: imgWidth}, 100);
        $(this).children('a').children('span').stop().fadeIn(200);
        $(this).next('.zoom-button').show();
    }).mouseleave(function(e) {
        // move original functionality into a timeout, saving a reference
        // to this for use within the timeout
        var $this = $(this);
        timeoutID = setTimeout(function() {
           $this.children('a').children('img').stop().animate({ height: imgHeight + 33, left: '-20', top: '-20', width: imgWidth + 50}, 100);
           $this.children('a').children('span').stop().fadeOut(200);
           $this.next('.zoom-button').hide();
        }, 5);
    });

    // cancel the timeout when entering the plus button
    $(".zoom-button").mouseenter(function(e) {
        clearTimeout(timeoutID);
    }); 
```

演示：http: [//jsfiddle.net/NrtvK/2/](http://jsfiddle.net/NrtvK/2/)

（我知道这很狡猾，但我出于好奇尝试了它，当它起作用时，我想我不妨发布它。）

# php - 运行其他不应该运行的代码的脚本

> ID：13464730
> 
> 赞同：0
> 
> 时间：2012-11-20T00:17:15.803
> 
> 标签：php

我花了最后几个小时试图让我的会话正常工作，我遇到的问题是我有这个会话检查，它在页面打开时运行，一切正常等等......
但是，当用户点击提交时在页面上，它也运行相同的会话检查，导致页面抛出错误。

这是会话检查：

```
$estate_id="";

if (isset($_SESSION['addon_estate_id'])) {
    $estate_id = $_SESSION['addon_estate_id'];
    unset($_SESSION['addon_estate_id']);
} else {         
    $reg_error = "You need to select a house first.";
    $_SESSION['error'] = $reg_error;
    header("Location: addons.php");
    exit;    
} 
```

这是在用户单击提交按钮时运行的代码：

```
if (isset($_POST['add_browse_submit'])) {        
    $addon_selected_id = $_POST['addon_hidden_id'];
    $addon_hidden_estate_id = $_POST['addon_hidden_estate_id'];

    $_SESSION['addon_sess_id'] = $addon_selected_id;
    $_SESSION['addon_estate_detail_id'] = $addon_hidden_estate_id;

    header('Location: addon_detail.php');
    exit;
} 
```

基本上发生的事情是当用户单击提交按钮时，它也会运行`session check`代码，导致`reg_error`. 如果我在会话检查中注释掉代码`else`，那么一切都很好，脚本会按`addon_detail.php`原样执行。

有什么理由这样做吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:23:34.710

我假设您的后期处理代码低于会话检查。如果您将 post check 移到上面，然后确保代码实际上正在设置，`$_SESSION['addon_estate_id']`那么它就不会出错。

假设这是您的目标。我会假设您会`$_SESSION['addon_estate_id']`在示例中设置，但谁能告诉？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:23:21.167

第一次访问页面（假设用户已经`$_SESSION['addon_estate_id']`设置，将清除该变量并将其存储在 中`$estate_id`。第二次访问（提交表单后）看到`$_SESSION['addon_estate_id']`未设置，因此会引发错误。

您没有`$estate_id`在第二个块中引用，所以也许您不需要它？您在第一页访问时取消设置它有什么原因吗？

# java - 国际象棋 AI：关于对象实现的 MinMax

> ID：13464731
> 
> 赞同：1
> 
> 时间：2012-11-20T00:17:18.843
> 
> 标签：java, algorithm, artificial-intelligence, chess

我正在为类似于国际象棋的游戏编写人工智能。棋盘为 10x10，每边 15 个棋子，所有棋子都有类似的棋步。

游戏中的一切都组织在对象中。瓦片[][]瓦片；10x10，每个 Tile 都有一个指向一块或空的块指针。

到目前为止，我已经实现了一个没有修剪的 MinMax 算法。每轮可能的移动平均是国际象棋游戏的两倍。

该算法有效，但速度很慢。平均而言，它可以检查 40000 次移动/pr 秒。因此，深度为 4 时，我的游戏使用大约 4-5 秒来计算所有可能的移动。我稍后会实施修剪，但可能需要先对我的实施提供一些反馈。

**问题：我是否必须转换为 char-arrays/bit-board 或类似的格式来加快计算速度，还是我做错了什么？**

实现：(sudo) 为了避免大量的双 for 循环，我在 Tiles 列表中跟踪 myPieces 和对手Pieces。棋盘评估也只进行一次，然后仅更新，并且仅通过添加和减去移动的值来更新。在我的 minMax 算法的实现中，我使用了一个保存当前游戏状态的 GameState 类。

```
GameState {
 Tile[][] board
 List<Tile> myPieces;
 List<Tile> otherPieces;
 int[][] evaluatedBoard
 int evaluatedValue
 Piece moveFrom, moveTo //used to save pointer when applying move
 int moveFromValue, moveToValue //used to save evaluationValue when applying move

 void applyMove(Tile from, Tile to)
 void undoMove(Tile from, Tile to)
 GameState createCopy()
} 
```

ApplyMove 只更新evaluateValue 而不会遍历整个数组。myPieces 和otherPieces 也通过apply/undo 更新。

最小值最大值：

```
maxMove(GameState state, int depth) {
 for(Tile from : state.getMyPieces().clone()) { //list will be changed
   for(Tile to : from.getPiece().getPossibleMoves()) {
       if(depth == 0)
         //find best move and so forth
       else {
        state.applyMove(from, to);
        minMove(state.createCopy(), depth - 1) //similar to maxMove except it uses otherPieces
        state.undoMove(from, to)
       }
   }
 }
 //return best move
} 
```

编辑：添加了有关 applyMove 和 Profiler 的信息

```
Profiler:          instructions
applyMove()     3200ms  11 430 000 
undoMove()      1800ms  11 430 000
evaluateTile()  1400ms  22 400 000
minMove()       1700ms  315 493 
```

applyMove 和 undoMove 只存储/反向指向旧值的指针，并用移动中的新值替换它们。然后调用evaluateTile，它根据一个枚举类型返回一个1-10 的数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T05:02:06.757

您选择的表示将花费您很多 - 您考虑的每一步都需要您复制大量状态。在我看来，你有两个选择：

(1) 使您的状态表示非常小（在国际象棋中，您可以使用 64 x 4 位或 .NET 中的 4 个 Int64 来执行此操作），因此复制它非常便宜；或者

(2) 使用增量使您的状态表示不可变，因此创建更新的状态很便宜。

我会先尝试选项（1），然后看看你的情况。

以下是一些您可能会觉得有用的链接： [http://en.wikipedia.org/wiki/Board_representation_(chess](http://en.wikipedia.org/wiki/Board_representation_(chess) ) [http://www.cis.uab.edu/hyatt/boardrep.html](http://www.cis.uab.edu/hyatt/boardrep.html)

# eclipse - Bugzilla 的激活/停用任务

> ID：13464732
> 
> 赞同：0
> 
> 时间：2012-11-20T00:17:20.280
> 
> 标签：eclipse, task, tracking, bugzilla, mylyn

我正在使用 Eclipse，当我创建错误时，顶部的数字 [O Bug XX] 旁边有一个按钮。当我单击“O”区域时，它会激活任务。似乎一次只能激活一项任务。我假设当一项任务处于活动状态时，它会向在您的项目中工作的其他人展示这就是您正在从事的工作？请寻找有关此功能的深入解释。

我查看了文档，除了激活/停用它的快捷键外，没有看到任何关于它的信息。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T04:30:49.520

激活任务是 Mylyns 的核心功能`task-focused UI`。

正如 Mylyn 的常见问题中所描述的那样：

> 当您激活任务时，Mylyn 通过监控您的交互来自动维护任务上下文。任务上下文为您使用的元素和关系与手头任务的相关性提供了可预测的兴趣度加权（如[软件工程基础会议论文](http://kerstens.org/mik/publications/2006-11-mylar-fse.pdf)中所述）。以任务为中心的 UI 是 Mylyn 向 Mylyn 呈现任务上下文模型的机制，以减少信息过载并自动化 UI 元素（如编辑器和更改集）的手动管理。例子：
> 
> *   视图中的过滤、修饰和扩展管理
> *   编辑器中的自动折叠
> *   内容辅助排名
> *   编辑管理
> *   透视管理
> *   变更集管理

要了解如何在您的开发工作流程中使用 Mylyn 的上下文管理，我建议阅读 IBM 文章[Mylyn 2.0，第 2 部分：自动上下文管理](http://www.ibm.com/developerworks/java/library/j-mylyn2/)。

# wpf - DataTrigger 不会在 Button 的派生类上触发

> ID：13464735
> 
> 赞同：0
> 
> 时间：2012-11-20T00:17:25.957
> 
> 标签：wpf, button, dependency-properties, multidatatrigger

我们在整个应用程序中有大量带有图标和文本的按钮，我正在尝试为所有按钮提取通用样式。我想出了这个从 Button 派生的想法，并且有几个依赖属性。这个自定义按钮类具有我们应用程序中所有按钮共有的样式。

**我的自定义按钮定义：**

```
<Button x:Class="UIElements.Controls.CustomToolBarButton"
               xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
               xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
               xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
               xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
               xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation" mc:Ignorable="d"
               >
<!--Style="{StaticResource ResourceKey=ToolBarButtonStyle}"-->
<StackPanel Orientation="Horizontal">
    <Image Source="{Binding Icon, Mode=TwoWay}" Style="{StaticResource ResourceKey=ToolBarButtonIconStyle}" />
    <TextBlock Text="{Binding DisplayText, Mode=TwoWay}" Style="{StaticResource ResourceKey=ToolBarButtonDisplayTextStyle}" />
</StackPanel> 
```

```
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media.Imaging;
//using Telerik.Windows.Controls;

namespace UIElements.Controls
{
    public partial class CustomToolBarButton : Button
    {
        public CustomToolBarButton()
        {
            InitializeComponent();
            this.DataContext = this;
        }

        public static readonly DependencyProperty IconProperty =
            DependencyProperty.Register("Icon", typeof(BitmapImage), typeof(Button), new PropertyMetadata(default(BitmapImage)));

        public BitmapImage Icon
        {
            get { return (BitmapImage)GetValue(IconProperty); }
            set { SetValue(IconProperty, value); }
        }

        public static readonly DependencyProperty DisplayTextProperty =
            DependencyProperty.Register("DisplayText", typeof(string), typeof(Button), new PropertyMetadata(default(string)));

        public string DisplayText
        {
            get { return (string) GetValue(DisplayTextProperty); }
            set { SetValue(DisplayTextProperty, value); }
        }
    }
} 
```

**我使用这个控件如下：**

```
<Controls1:CustomToolBarButton Icon="{DynamicResource ImageSave}"
                        DisplayText="Test Display">
<Controls1:CustomToolBarButton.Style>
    <Style TargetType="Controls1:CustomToolBarButton">
        <Style.Triggers>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding SelectedListItem.ListId}" Value="0" />
                </MultiDataTrigger.Conditions>
                <!--<Setter Property="Button.IsEnabled" Value="False" />-->
                <Setter Property="Background" Value="BurlyWood" />
            </MultiDataTrigger>
        </Style.Triggers>
    </Style>
</Controls1:CustomToolBarButton.Style> 
```

事情看起来不错，但是当有界数据更改时触发器没有触发。如果我将相同的触发器应用于常规按钮，它似乎工作正常。

如果我遗漏了什么，你能告诉我吗？

**编辑：** 找到了一个[优雅的解决方案](http://www.hardcodet.net/2009/01/create-wpf-image-button-through-attached-properties)。使用附加属性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:08:54.430

首先，你[永远不应该使用`this.DataContext = this;`](https://stackoverflow.com/questions/7572005/setting-datacontext-within-usercontrol-is-affecting-bindings-in-parent/7573570#7573570), 永远。

其次，如果您从按钮继承，则不应创建 XAML 文件，而是在`Themes/Generic.xaml`资源字典中创建默认样式（如果您从`UserControl`这样的文件继承就可以了）。

这也意味着您需要[`Control.Template`](http://msdn.microsoft.com/en-us/library/system.windows.controls.control.template.aspx)在样式中定义 a ，因此应该使用[`TemplateBindings`](http://msdn.microsoft.com/en-us/library/system.windows.templatebindingextension.aspx)而不是普通的（或使用[`RelativeSource`](http://msdn.microsoft.com/en-us/library/system.windows.data.relativesource.aspx)）。

如[另一个答案](https://stackoverflow.com/a/13465617/546730)中所述，您可能需要覆盖元数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T02:11:28.803

将这行代码添加到您的静态构造函数中

```
DefaultStyleKeyProperty.OverrideMetadata(typeof(CustomToolBarButton), new FrameworkPropertyMetadata(typeof(CustomToolBarButton))); 
```

[http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.defaultstylekey.aspx](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.defaultstylekey.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T11:00:57.190

在您的`CustomToolBarButton`中，您将其设置`DataContext`为按钮本身（`this.DataContext = this;`）。通过这样做，您已停止将父级（按钮的父控件，例如网格或 UserControl）数据上下文传播到您的按钮（包含`SelectedListItem`属性）。

如果您只想解决此问题，请尝试使用`RelativeSource`或`ElementName`Binding 来访问按钮父控件，然后使用它`DataContext`来访问`SelectedListItem`.

```
<Grid x:Name="ParentGrid">

    <Controls1:CustomToolBarButton Icon="{DynamicResource ImageSave}"
                            DisplayText="Test Display">
    <Controls1:CustomToolBarButton.Style>
        <Style TargetType="Controls1:CustomToolBarButton">
            <Style.Triggers>
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding ElementName=ParentGrid,
                           Path=DataContext.SelectedListItem.ListId}" Value="0" />
                    </MultiDataTrigger.Conditions>
                    <!--<Setter Property="Button.IsEnabled" Value="False" />-->
                    <Setter Property="Background" Value="BurlyWood" />
                </MultiDataTrigger>
            </Style.Triggers>
        </Style>
    </Controls1:CustomToolBarButton.Style>
</Grid> 
```

当您使用 UserControl 扩展 Button 时，问题正在发生；正如您所说，您有很多按钮，我建议您创建一个`CustomControl`带有模板的模板，如下[所示](http://www.codeproject.com/Articles/17830/Creating-and-consuming-a-custom-WPF-control)；这样您就不必弄乱 DataContext 传播。

这是一个博客，解释了完全按照您的意愿进行操作的不同方法-

[http://blogs.msdn.com/b/knom/archive/2007/10/31/wpf-control-development-3-ways-to-build-an-imagebutton.aspx](http://blogs.msdn.com/b/knom/archive/2007/10/31/wpf-control-development-3-ways-to-build-an-imagebutton.aspx)

# java - Java中的十进制到二进制转换器

> ID：13464739
> 
> 赞同：0
> 
> 时间：2012-11-20T00:17:50.743
> 
> 标签：java, binary, decimal, converter

我需要用 Java 做一个十进制到二进制的转换器。我不能使用 Integer.toBinaryString() 并且我看到的每个答案都使用它。我需要实际制作算法。我想将输入保留为 int，将输出保留为 String，因为如果我更改该程序的其余部分，这将变得一团糟。如果可以的话，保持它非常基本。这是我经过数小时的起草和报废后得到的结果，它有很多问题，比如它甚至没有组合一个二进制数。拜托，请帮助，我很困惑，我的大脑是一团糟。

```
public static String decToBin(int dec)
  {
    String bin = "";
    int exp = 0;

    for(int expLevel = 0; Math.pow(2, expLevel) <= dec; expLevel++)
    {
      if(dec - Math.pow(2, expLevel) >= 0)
      {
        dec -= Math.pow(2, expLevel-1);
      }
    }
    return bin;
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:26:12.827

看起来你需要复习你的数学笔记。这是基本算法的一个很好的解释：[如何从十进制转换为二进制](http://www.wikihow.com/Convert-from-Decimal-to-Binary)。

如果您检查提供的链接，您会发现您只需要获得除以 2 的数字的其余部分。作为一个简短的算法：

```
int n <- user input (or other source)
String binaryForm <- empty string
while (n > 0) {
    int res <- n % 2;
    n <- n / 2;
    binaryForm <- res + binaryForm
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:26:24.183

两件相当明显的事情：

*   声明后你没有改变`bin`任何地方（`exp`也没有使用）。
*   中的条件`if(dec - Math.pow(2, expLevel) >= 0)`等价于循环不变量，因此始终为真。

这种方法可以工作，但循环必须走另一条路，即从 2 的较高幂到较低的幂（这意味着您首先必须找到小于输入的 2 的最高幂，除非您是前导零很好）。此外，它可能有助于避免重新分配方法参数 ( `dec`)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:27:24.337

您可以将参数移动 1 位并将其添加到字符串中。最后，您可以将其反转，如下所示：

```
public class Main {
    public static void main(String[] args) throws Exception {
        System.out.println(decToBin(0));
        System.out.println(decToBin(1));
        System.out.println(decToBin(2));
        System.out.println(decToBin(127));
    }

    public static String decToBin(int dec) {
        if (dec == 0) {
            return "0"; // special case
        }

        final StringBuilder result = new StringBuilder();
        int current = dec;

        while (current != 0) {
            result.append(current & 0x1);
            current = current >> 1;
        }

        return result.reverse().toString();
    }
} 
```

和一个[小提琴](http://ideone.com/tx4L0F)。但它适用于正整数。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-09-28T05:56:23.513

```
import java.util.Scanner;

public class DecimalToBinary {

public String toBinary(int n) {
   if (n == 0) {
       return "0";
   }
   String binary = "";
   while (n > 0) {
       int rem = n % 2;
       binary = rem + binary;
       n = n / 2;
   }
   return binary;
}

public static void main(String[] args) {
   Scanner scanner = new Scanner(System.in);
   System.out.print("Enter a number: ");
   int decimal = scanner.nextInt();
   DecimalToBinary decimalToBinary = new DecimalToBinary();
   String binary = decimalToBinary.toBinary(decimal);
   System.out.println("The binary representation is " + binary);

}
} 
```

# javascript - 带有预检请求的 CORS 发布

> ID：13464742
> 
> 赞同：6
> 
> 时间：2012-11-20T00:18:20.040
> 
> 标签：javascript, ajax, cors

我正在尝试使用 CORS 将文件上传到不同域上的服务，但由于来源被拒绝，它们一直失败。据我所见，正在使用正确的标题来允许这样做。

Javascript 请求：

```
 var xhr = new XMLHttpRequest();
  xhr.open('POST', "https://files.example.com", true);                                                                                                                            
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.onreadystatechange = function () {
    if (this.status == 200 && this.readyState == 4) {
      console.log('response: ' + this.responseText);
    }
  };

  xhr.send(); 
```

来自预检 OPTIONS 请求的响应：

```
Access-Control-Allow-Headers:Origin, Authorization, Content-Type
Access-Control-Allow-Methods:POST, OPTIONS
Access-Control-Allow-Origin:*
Content-Length:0
Content-Type:application/json
Date:Mon, 19 Nov 2012 23:30:21 GMT 
```

POST 请求的标头：

```
Cache-Control:no-cache
Content-Type:application/json
Origin:https://www.example.com
Pragma:no-cache
Referer:https://www.example.com
User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_0) AppleWebKit/537.19 (KHTML, like     Gecko) Chrome/25.0.1325.0 Safari/537.19 
```

导致错误：

```
XMLHttpRequest cannot load https://files.example.com. Origin https://www.example.com is not allowed by Access-Control-Allow-Origin. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-05T14:11:21.110

不幸的是，发布到您页面以外的域会引发 CORS。这还包括不同的子域、端口和协议 (http/https)。

当请求“不简单”时完成预检，这意味着内容类型标头设置为“text/plain”以外的内容。您的“应用程序/json”使浏览器害怕预检。

如果这 50-200 毫秒对您很重要，那么您可以重写您的 Web 服务以了解“简单”内容类型。如果不是，那么您应该让您的 Web 服务在执行 OPTIONS（http 方法）任务时返回 HTTP 状态 204（无内容）。

处理 wcf 时：

```
WebOperationContext.Current.OutgoingResponse.StatusCode = System.Net.HttpStatusCode.NoContent; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-07T19:18:46.920

子域不同。就 CORS 而言，子域、协议和端口在 Origin 和 Access-Control-Allow-Origin 中必须相同。

在您的示例中，来源看起来是：[https](https://www.example.com) ://www.example.com ，而 Access-Control-Allow-Origin 是：[https ://files.example.com](https://files.example.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T02:28:41.010

尝试将 Cache-Control 和 Pragma 添加到预检中允许的标头列表中。完整的标题应如下所示：

```
Access-Control-Allow-Headers: Cache-Control, Pragma, Origin, Authorization, Content-Type 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-06T09:55:04.813

有点晚了，但是查看您的信息，它显示飞行前 CORS 检查工作正常，这只是响应被浏览器阻止的实际（第二次）CORS 请求。

很遗憾，您没有包含实际（第二次）CORS 请求的响应，因为这可能包含响应拒绝的线索。我的怀疑是，尽管飞行前响应正确包含标题：

```
Access-Control-Allow-Origin:* 
```

...您的实际（第二次）响应可能不包含该标头，在这种情况下，浏览器会正确拒绝响应。如果我的假设是正确的，那么解决方案就是将该标头也包含在实际（非飞行前）响应中。

# c# - 在链接中使用 Guid 失败

> ID：13464743
> 
> 赞同：1
> 
> 时间：2012-11-20T00:18:24.757
> 
> 标签：c#, asp.net-mvc, guid, uuid, uniqueidentifier

我正在使用剃须刀引擎构建一个 MVC4 项目，尽管我不知道这是否与我的问题有关。我有一个带有 Submit(String poId) ActionResult 的 VendorBillController。我的链接如下所示：example.com/VendorBill/Submit?poId=790a2e76-5186-42c1-8087-c13b18d22023

但是，当尝试转到此页面时，我收到此错误：

> 未找到视图“722884”或其主视图，或者没有视图引擎支持搜索到的位置。

为什么要寻找视图 722884？尽管我很确定 html 链接中的数字、字母和破折号都可以，但我也尝试了对链接进行 html 编码，但没有任何变化。

如果我输入

> example.com/VendorBill/Submit?poId=asdf

它进入函数，但随后失败，因为 poId 被传递到 new Guid() 并且 asdf 不是 guid。

为什么 URL 中的 guid 会失败？当 guid 是需要传递的 ID 时，是否有“正常”的解决方法？

编辑：

这是我的整个控制器的代码：

它也不适用于 guid，这是我的整个控制器，但是我认为它甚至没有到达那里，所以我不确定这是问题所在：

```
 public class VendorBillsController : Controller
    {
        public ActionResult Submit(Guid poId)
        {

            var purchaseOrderId = new Models.Entities().TempLinks.AsQueryable().Single(x => x.Guid == poId).PurchaseOrderId;

            return View(purchaseOrderId.ToString());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:24:29.680

如果您将签名更改为`Submit`to ，它会起作用`Submit(Guid poId)`吗？

在 MVC 中本机使用 GUID 没有问题，它会为您转换它们。

如果上述方法不起作用，您能否将控制器方法的代码包含在内，以便我们查看一下？

**更新**：不，你的问题是这样的：

`return View(purchaseOrderId.ToString());`

如果您将一个字符串传递给 View，它假定您传递的是视图的名称（[请参阅 MSDN 上的此内容）](http://msdn.microsoft.com/en-us/library/dd460352%28v=vs.98%29.aspx)，如果您希望您的视图模型是类型，`string`那么您将不得不传递视图name in 作为第一个参数，然后是主视图名称，然后是字符串值（[此重载](http://msdn.microsoft.com/en-us/library/dd492244%28v=vs.98%29.aspx)）。声明具有单个属性的显式视图模型`PurchaseOrderId`然后将其传递给视图方法要容易得多。设置方法重载的方式`View`可以使用*除*字符串之外的任何视图模型类型。

如果它是 GUID，您可以将其传入，但您必须将其作为 GUID 传入，不要调用`ToString()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:44:17.323

当您只想将字符串传递给强类型视图时，就会出现问题。当您传入一个字符串时，MVC 期望的是您要加载的视图的名称。这就是为什么它根据您传入的 Guid 字符串寻找但找不到视图的原因。

MSDN：[Controller.View（字符串视图名称）](http://msdn.microsoft.com/en-us/library/dd460352%28v=vs.98%29.aspx)

Glenn Slaven 是正确的，如果您将类型从字符串更改为 Guid，那么您将不会遇到此问题。

# c++ - 有没有办法为 unsigned long long A 和 B 做 (A*B) mod M 而不会溢出？

> ID：13464745
> 
> 赞同：7
> 
> 时间：2012-11-20T00:18:40.853
> 
> 标签：c++, numbers, overflow

我不想在 Windows 上安装 GMP 的噩梦。

我有两个数字 A 和 B，`unsigned long long`s，数量级最多为 10^10 左右，但即使这样做`((A%M)*(B%M))%M`，我也会得到整数溢出。

是否有用于计算`(A*B)%M`更大数字的自制函数？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T00:41:40.883

如果模数`M`足够小`ULLONG_MAX`（如果它在 10 ^ 10 区域内就是这种情况），您可以通过将其中一个因子分成两部分来分三步完成。我假设`A < M`和`B < M`，和`M < 2^42`。

```
// split A into to parts
unsigned long long a1 = (A >> 21), a2 = A & ((1ull << 21) - 1);
unsigned long long temp = (a1 * B) % M;   // doesn't overflow under the assumptions
temp = (temp << 21) % M;                  // this neither
temp += (a2*B) % M;                       // nor this
return temp % M; 
```

对于较大的值，您可以将因子分成三部分，但如果模数变得非常接近，`ULLONG_MAX`它就会变得难看。

# emacs - 如何让 ediff 模式停止突出显示仅因空格不同的行？

> ID：13464749
> 
> 赞同：7
> 
> 时间：2012-11-20T00:19:03.893
> 
> 标签：emacs, whitespace, emacs-ediff

我想仔细比较 C++ 中有两个类似的函数。我正在使用 emacs 函数`ediff-regions-linewise`逐行比较它们。许多行在它们的空白处有细微的差别，例如：

```
//Line from first function
somefunc(i,j);
//Line from second function
somefunc(i, j); 
```

Ediff-mode 足够聪明，可以知道哪些部分仅因空格不同：该命令`##`名义上的意思是“忽略空格”。它只会使光标跳过不同的部分，但仍会突出显示仅由空格不同的行，就像突出显示在某些重要方面不同的行一样。

**有没有办法让 ediff-mode 停止突出显示仅因空格而不同的行？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T09:29:15.670

我在我的 Emacs 配置中有以下设置来禁用差异时的空格（查看`man diff`它的作用）：

```
(setq ediff-diff-options "-w") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:45:56.540

我有这两个设置，它们具有执行您所要求的净效果：

```
(setq-default ediff-ignore-similar-regions t)
(setq-default ediff-highlight-all-diffs nil) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-09T21:53:42.443

虽然`(setq ediff-diff-options "-w")`可能会一针见血，但其他日子可能会隐藏错误。

`ediff`菜单建议用于`#``#`切换空白差异。

启用空白忽略移动命令 ( `n`/ `p`) 会跳过只有空白差异的大块。

`C-c C-b`Emacs 具有通过不同面（或）突出显示非空白差异的命令`M-x diff-refine-hunk`。它放置与差异案例相同颜色的叠加层：

```
diff-removed-face
diff-added-face
diff-indicator-added-face
diff-indicator-removed-face 
```

要使差异可见，请使用以下内容：

```
(set-face-foreground 'diff-refine-added "DarkGreen")
(set-face-foreground 'diff-refine-removed "DarkRed")
(set-face-background 'diff-refine-change "LightBlue1") 
```

`h`还可以在 ediff 控制缓冲区中尝试命令。

这并不能回答您的直接问题，而是使其毫无意义。

# java - xslt 节点集示例

> ID：13464750
> 
> 赞同：0
> 
> 时间：2012-11-20T00:19:16.653
> 
> 标签：java, xslt-1.0, node-set

如何使用 java 和 xslt 1.0 将节点集作为参数传递？

我有兴趣了解如何在 java 端形成节点集。`

```
node-set() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T01:39:13.827

**您不需要`xxx:node-set()`扩展函数即可将节点集作为外部/全局参数传递给转换，然后在转换内部访问它**。

只需阅读特定 XSLT 处理器的文档以获取示例。

一个合适的地方是 Saxon XSLT 处理器的示例，它与它的 API/Code 一起出现。

例如，这个：

[http://www.saxonica.com/documentation/samples/jdom.xml](http://www.saxonica.com/documentation/samples/jdom.xml)

# ios - 我们可以使用安装在 VMWare 上的 MacOS 将应用程序发布到 AppStore (iOS) 吗？

> ID：13464751
> 
> 赞同：1
> 
> 时间：2012-11-20T00:19:23.737
> 
> 标签：ios, app-store, vmware, iphone-developer-program

我一直在使用 VMware 为 iphone 构建一个应用程序。所以我的问题是：我可以从安装在 VMware 工作站上的 MacOS 发布我的应用程序吗？而且，如果我第一次登录并从真正的 Mac 发布应用程序，然后从 VMware 工作怎么办？它会起作用吗？还有其他方法可以发布我的应用程序吗？没有真正的Mac？（这里的成本是 2500 美元，太多了）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T17:17:47.897

据报道，您还可以在“云端”的远程 Mac 上按小时租用时间，并通过 VNC 或远程桌面访问它。确保租用 Xcode 并已安装所需的 SDK 以供用户帐户使用。

# java - 如何从 java 代码将图像添加到 Android 应用程序

> ID：13464754
> 
> 赞同：1
> 
> 时间：2012-11-20T00:19:35.773
> 
> 标签：java, android, xml, tabs

我和我的朋友正在为我们的班级项目制作一个 android 应用程序。我们正在制作带有标签的应用程序。我们想知道是否有一种方法可以为选项卡使用一个 xml 文件，以及我们是否可以直接从 java 代码中添加图片，或者我们是否需要为每个单独的选项卡制作一个 xml 文件。如果我们这样做，我们将如何为所有选项卡保持相同的格式。

我提供的代码是我们在其中附加了一些图片的 main.xml。tab.xml 是我们格式化标签的 xml 布局。SalesExecutiveDashboard.java 是调用其他选项卡活动的主要活动。最后 HomeTab.java 是我们标签代码的示例。

感谢您提供的所有帮助

主要的.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<LinearLayout
 android:layout_height="fill_parent"
 android:layout_width="fill_parent"
 android:orientation="vertical"
 xmlns:android="http://schemas.android.com/apk/res/android">
<TextView 
 android:layout_height="wrap_content"
 android:layout_width="wrap_content"
 android:layout_margin="1dp" 
 android:text="@string/overall_sales"
 android:id="@+id/pieChartView"/>
<ImageView 
 android:layout_height="fill_parent"
 android:layout_width="fill_parent" 
 android:id="@+id/pie_chart" 
 android:src="@drawable/piechartsmall"/>
</LinearLayout> 
```

选项卡.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<TabHost
 android:id="@android:id/tabhost" 
 xmlns:android="http://schemas.android.com/apk/res/android" 
 android:layout_height="fill_parent" 
 android:layout_width="fill_parent"> 

<ScrollView 
 xmlns:android="http://schemas.android.com/apk/res/android"    
 android:layout_height="fill_parent"
 android:layout_width="fill_parent">

<LinearLayout android:id="@+id/LinearLayout01"
 android:layout_height="wrap_content" 
 android:layout_width="fill_parent" 
 android:orientation="vertical">

<HorizontalScrollView 
 android:layout_height="wrap_content"
 android:layout_width="wrap_content" 
 android:scrollbars="none"
 android:fillViewport="true">

<TabWidget android:id="@android:id/tabs"
 android:layout_height="40dp" 
 android:layout_width="wrap_content"
 android:layout_gravity="bottom"
 android:gravity="bottom">

</TabWidget>
</HorizontalScrollView>

<FrameLayout
 android:id="@android:id/tabcontent"
 android:layout_height="fill_parent"
 android:layout_width="fill_parent">
</FrameLayout>
</LinearLayout>
</ScrollView>
</TabHost> 
```

SaleExecutiveDashboard.java

```
package com.androidpeople.tab;

import android.app.TabActivity;
import android.content.Intent;
import android.os.Bundle;
import android.widget.TabHost;
import android.widget.TabHost.TabSpec;

public class SalesExecutiveDashboard extends TabActivity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.tab);

        /* TabHost will have Tabs */
        //TabHost tabHost = (TabHost)findViewById(android.R.id.tabhost);

        TabHost tabHost=getTabHost();

        /* TabSpec used to create a new tab. 
         * By using TabSpec only we can able to setContent to the tab.
         * By using TabSpec setIndicator() we can set name to tab. */

        /* tid1 is firstTabSpec Id. Its used to access outside. */
        TabSpec HomeTabSpec = tabHost.newTabSpec("Tab1");
        TabSpec RevExpTabSpec = tabHost.newTabSpec("Tab2");
        TabSpec AccountTabSpec = tabHost.newTabSpec("Tab3");
        TabSpec DistroTabSpec = tabHost.newTabSpec("Tab4");
        TabSpec SBPTabSpec = tabHost.newTabSpec("Tab5");
        TabSpec AlertTabSpec = tabHost.newTabSpec("Tab6");

        /* TabSpec setIndicator() is used to set name for the tab. */
        /* TabSpec setContent() is used to set content for a particular tab. */
        HomeTabSpec.setIndicator("  Home  ").setContent(new Intent(this,HomeTab.class));

        RevExpTabSpec.setIndicator("  Rev/Exp  ").setContent(new Intent(this,RevExpTab.class));
        AccountTabSpec.setIndicator("  Accounts  ").setContent(new Intent(this,AccountsTab.class));
        DistroTabSpec.setIndicator("  Distribution  ").setContent(new Intent(this,DistroTab.class));
        SBPTabSpec.setIndicator("  Sales by Product  ").setContent(new Intent(this,SBPTab.class));
        AlertTabSpec.setIndicator("  Alerts  ").setContent(new Intent(this,AlertTab.class));

        /* Add tabSpec to the TabHost to display. */
        tabHost.addTab(HomeTabSpec);
        tabHost.addTab(RevExpTabSpec);
        tabHost.addTab(AccountTabSpec);
        tabHost.addTab(DistroTabSpec);
        tabHost.addTab(SBPTabSpec);
        tabHost.addTab(AlertTabSpec);

    }
} 
```

HomeTab.java

```
package com.androidpeople.tab;

import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Matrix;
import android.os.Bundle;
import android.widget.ImageView;

public class HomeTab extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        /* First Tab Content */
        ImageView image = (ImageView) findViewById(R.id.pie_chart);

        //TextView textView = new TextView(this);
        //textView.setText("This is the Home Tab");
        //setContentView(textView);
        setContentView(R.layout.main);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:16:56.530

是的，您可以多次使用一个布局资源。它只指定外观。至于图像，只要它们在您的可绘制资源中，您只需按照您的意愿将它们分配给您的 ImageView。

```
//hold the integer resource id of your image
Integer img = R.drawable.<<imageid>>;

//get your ImageView
ImageView iView = (ImageView) findViewById(R.id.<<viewname>>);

//assign your image
iView.setImageResource(img); 
```

另一个选项是在可绘制目录中，您可以创建 xml“选择器”来告诉您的应用程序根据某些条件使用哪个图像。例如，假设您有一个 ImageButton 并希望在它被禁用时显示不同的图像。您可以在 drawable 目录中使用如下选择器来使用 drawable-h/l/mdpi 目录中的图像：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/aps/res/android">
    <item android:state_enabled="false" android:drawable="@drawable/<<disabledImage>>"/>
    <item android:drawable="@drawable/<<defaultImage>>"?>
</selector> 
```

然后，您可以在布局中使用此选择器。

```
<Button android:layout_width="fill_parent" android:id="@+id/btn1" android:text="btn1" android:textSize="20dp" android:textColor="@android:color/transparent" android:background="@drawable/<<selectorName>>" android:layout_height="fill_parent" android:onClick="<<clickevent>>" /> 
```

我知道这是一个老问题，但希望这对某人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-05T05:27:52.487

首先，您需要编辑 HomeTab Activity onCreate 方法，例如：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        /* First Tab Content */
        ImageView image = (ImageView) findViewById(R.id.pie_chart);

        //TextView textView = new TextView(this);
        //textView.setText("This is the Home Tab");
        //setContentView(textView);

    }
```

我们可以在设置布局文件后投射任何控件，你不能先投射:)

然后在您的 MainActivity 内容 TabHost 之后，您可以在Build Listner 中设置它，例如：

```
tabHost.setOnTabChangedListener(new OnTabChangeListener() {
                @Override
                public void onTabChanged(String arg0) {     

    int pos=tabHost.getCurrentTab();  Toast.makeText(this,""+pos,Toast.LENGTH_SHORT).show();

                    SharedPreferences pref=getSharedPreferences(YOUR_PREFERENC,0);

  SharedPreferences.Editor et = pref.edit();
  et.putInt(YOUR_POS_KEY,pos);
  et.commit();
                }       
            });
```

您可以在子 Activity 中使用此 SharedPreferences 值并检查位置条件以在您的一个布局中或仅在一个 Java 文件中设置动态图像

我希望它有效

快乐的编码...

# django - list_display - 布尔图标不适用于 BooleanField

> ID：13464756
> 
> 赞同：2
> 
> 时间：2012-11-20T00:19:39.447
> 
> 标签：django, django-models, django-admin

简单情况，型号：

```
class Manufacturer(models.Model):
    name = models.CharField(max_length=200)
    slug = models.SlugField(max_length=200, null=True)
    active = models.BooleanField()
    ... 
```

和模型管理员：

```
class ManufacturerAdmin(admin.ModelAdmin):
    search_fields = ['name']
    list_filter = ['assortment_type', 'active']
    ordering = ('priority',)
    prepopulated_fields = {'slug':('name',),}
    list_display = ('name', 'active') 
```

仍在 Admin 活动列中显示为 True/False 而不是图标。我可以创建方法并设置 Boolean = True 属性，但我失去了对列的排序能力。很明显，我在这里遗漏了一些东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T01:44:10.537

创建一个自定义方法，然后设置`admin_order_field`为字段名称并设置`boolean`为 True

```
def my_function(self):
    # your stuff goes here
my_function.boolean = True
my_function.admin_order_field = 'active' 
```

这应该使它可排序（[doc](https://docs.djangoproject.com/en/dev/ref/contrib/admin/)）

# tfs - 我如何只运行批处理文件而不使用 tfs 构建服务器中的 .sln/.proj 文件？

> ID：13464757
> 
> 赞同：1
> 
> 时间：2012-11-20T00:19:45.530
> 
> 标签：tfs

我有一个适用于我的项目的 nant 脚本，我尝试将其用作 tfs 中的构建脚本。是否可以？？如果有可能，那我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:02:40.660

您可以使用包含“InvokePowerShellCommand”和“InvokeRemoteStropt”的[社区 TFS 构建扩展](http://tfsbuildextensions.codeplex.com/)，我确信我错过了一些。

# iphone - didUnhighlightRowAtIndexPath 发送 NSNotFound iOS6

> ID：13464758
> 
> 赞同：0
> 
> 时间：2012-11-20T00:19:55.690
> 
> 标签：iphone, objective-c, ios6

当 tableview 发送委托事件时，我的应用程序发生了崩溃：

```
- (void)tableView:(UITableView *)tableView didUnhighlightRowAtIndexPath:(NSIndexPath *)indexPath 
```

并且传递的 indexPath 是`NSNotFound`. 似乎存在于 iOS 6.0 和 6.0.1 中，但在 6.1 中已修复。如果我找到一个，我会发布一个解决方法。

似乎它不应该使用包含 NSNotFound 的 indexPath 发送事件。无论哪种方式，它都固定在 6.1 中。主要发帖帮助其他遇到这个问题的人

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T07:15:44.927

看起来像 iOS 6 和 6.0.1 SDK 中的错误。这在 6.1 版中不会发生。一种可能的解决方法是保留对您的单元格的引用

```
- (void)tableView:(UITableView *)tableView didHighlightRowAtIndexPath:(NSIndexPath *)indexPath 
```

并检查

`indexPath.row == NSNotFound`

# python - pexpect setecho 不工作

> ID：13464759
> 
> 赞同：7
> 
> 时间：2012-11-20T00:19:59.730
> 
> 标签：python, cisco, pexpect

我正在尝试远程登录到 Cisco 路由器并使用 pexpect 发出命令。它的工作，但 sendline() 在输出中重复。即使在使用 setecho 为 False 之后。代码是：

```
'''
Created on Nov 19, 2012

@author: Amit Barik
'''

import pexpect

hostname = 'hostname'
login_cmd = 'telnet ' + hostname + '.net'
username = 'username'
password = 'pwd'
prompt = hostname + '#'

p = pexpect.spawn(login_cmd)
p.setecho(False)
p.logfile = open('Log.log', 'w+')

p.expect('Username:')
print '1',repr(p.before)

p.sendline(username)
p.expect('Password:')
print '2',repr(p.before)

p.sendline(password)
p.expect(prompt)
print '3',repr(p.before)

cmd = 'show clock'
p.sendline(cmd)
p.expect(prompt)
print 'Output for {0}'.format(cmd), repr(p.before) 
```

输出是：

```
# On Python Console
Output for show clock 'show clock\r\n00:16:40.692 UTC Tue Nov 20 2012\r\n'

# On Log File
Username: username
username
Password: pwd

My Cisco Banner

hostname#show clock
show clock
00:16:40.692 UTC Tue Nov 20 2012
hostname# 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-11-25T00:12:40.777

在与网络设备（不是 *nix 终端）交互时，我遇到了同样的问题。

Pexpect 有 3 种日志记录方法（1\. `logfile_send()`, 2\. `logfile_read()`3\. `logfile()`）。

使用上面原始海报中的输出示例，每个日志记录方法的输出如下所示：

1.)`p.logfile()`将记录网络设备的回显输出，并将记录使用`send()`&发送的文本`sendline()`。这是原始海报不希望发生的事情。

在脚本中：

```
p.logfile = open('Log.log', 'w+') 
```

输出：

```
# On Python Console
Output for show clock 'show clock\r\n00:16:40.692 UTC Tue Nov 20 2012\r\n'

# On Log File
Username: username   #This is the `sendline()` output
username             #This is echo from the network device
Password: pwd        #This is `sendline()` output
                     #Notice, pwd only echo's once.  There is no echo from the network device since it doesn't echo passwords

My Cisco Banner

hostname#show clock  #This is the `sendline()` output
show clock           #This is echo from the network device
00:16:40.692 UTC Tue Nov 20 2012
hostname# 
```

2.)`p.logfile_read()`只会记录网络设备的回显输出。它不会记录`p.sendline()`字符。这是原始海报正在寻找的预期结果。

在脚本中：

```
p.logfile_read = open('Log.log', 'w+') 
```

输出：

```
# On Python Console
Output for show clock 'show clock\r\n00:16:40.692 UTC Tue Nov 20 2012\r\n'

# On Log File
Username: username   #This is echo from the network device
Password:            #There is no echo from the network device since it doesn't echo passwords

My Cisco Banner

hostname#show clock  #This is echo from the network device
00:16:40.692 UTC Tue Nov 20 2012
hostname# 
```

3.)`p.logfile_send`只会将`p.sendline()`字符发送到日志，这在大多数情况下可能不是很有用。我将跳过这个例子，因为现在每个人都可能有这个想法。

因此，使用`logfile_read()`将解决与网络设备交互时在日志输出中显示密码的问题。这也将解决 pexpect 在日志输出中显示双重回声的问题，我已经看到一些人也在网上提出问题。

关于`setecho(False)`，根据 pexpect [docs](http://pexpect.sourceforge.net/pexpect.html#spawn-sendeof)，这设置了“终端回声模式打开或关闭”。该功能并不`sendline()`像人们希望的那样抑制输出（包括我自己）。而且由于我正在处理网络设备（cisco、juniper、mrv 等），因此尝试关闭 tty echo 并没有用。

希望这对将来的人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T05:08:20.633

所以，我发现的是...

*   setecho 似乎不起作用（在 pexpect.before 输出中，存在 pexpect.sendline 文本）。唯一的解决方案是进行字符串剥离。类似伪代码的东西`pexpect.before.strip(pexpect.sendline)`
*   此外，在记录时，logfile_read 不包含回声，但 logfile 包含（与 setecho 值无关）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T10:10:10.167

即使关闭了回声，我也曾经遇到过同样的回声问题。

但我可能已经找到了解决方案：

```
commandToRun = 'bash -c "less /readfile | tail -4"'
yourConnection.sendLine("stty -echo")
commandResult = yourConnection.sendLine(commandToRun)
self.sendLine("stty echo") 
```

所以基本上，使用' `bash -c`'在shell中运行你的命令，然后`echo`在bash中打开。

# amazon-web-services - AWS Elastic Load Balancing，如何将子文件夹指向博客？

> ID：13464761
> 
> 赞同：0
> 
> 时间：2012-11-20T00:20:18.743
> 
> 标签：amazon-web-services, load-balancing, amazon-elb

我正在使用亚马逊的 ELB 指向两个应用服务器。我想知道，我可以使用 ELB 来指出：

**mysite.com/blog**以反向代理类型的方式到 tumblr 博客，以允许我在我的域下托管所有博客内容？

亚马逊的 ELB 可以做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:48:09.480

不，抱歉 - 只有 EC2 实例可以添加到弹性负载均衡器。

# ios - 第一次绘制时，pageViewController 中的 ios 子视图定位不正确

> ID：13464762
> 
> 赞同：1
> 
> 时间：2012-11-20T00:20:21.890
> 
> 标签：ios, view, positioning, subview

我有一个嵌套在 pageviewcontroller 中的 viewcontroller，我想将其细分为两个部分（顶部 + 底部）。我正确地为各个视图分配了框架（下面的代码），但是第一次渲染是不正确的。当我滑开然后再次返回时，渲染的屏幕是正确的。知道发生了什么吗？

![在此处输入图像描述](../Images/962b84638d4e697990a23d563c7e4a11.png)

![在此处输入图像描述](../Images/ddaa462cbbc61b5d61b663b42b4c034a.png)

```
-(void) viewDidLoad 
{

self.controller1 = [self.storyboard    
    instantiateViewControllerWithIdentifier: @"controller1"];
self.controller2 = [self.storyboard 
    instantiateViewControllerWithIdentifier:@"controller2"];

[self.view addSubview:self.controller1.view];
[self.view addSubview:self.controller2.view];

[self addChildViewController:self.controller1];
[self addChildViewController:self.controller2];
}

- (void)viewWillAppear 
{
UIInterfaceOrientation orientation = self.interfaceOrientation;
BOOL navigationBarHidden = [self.navigationController isNavigationBarHidden];
CGRect navigationBarFrame = self.navigationController.navigationBar.frame;
CGRect screenBounds = [[UIScreen mainScreen] bounds];
CGRect applicationFrame = [[UIScreen mainScreen] applicationFrame];
CGRect viewSize = self.view.frame;    

self.controller1.view.frame = 
     CGRectMake(0, 0, screenBounds.size.width, screenBounds.size.width);

self.controller2.view.frame = 
     CGRectMake(0, screenBounds.size.width,
                             screenBounds.size.width, applicationFrame.size.height - screenBounds.size.width);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:50:17.403

想通了问题。问题不在于显示分屏的视图控制器，而是我的自定义 pageviewcontroller。

我在 -viewDidLoad 而不是 -viewDidAppear 中添加了 pageviewcontroller 子级。不同之处在于 -viewDidLoad 没有正确的父视图尺寸，因此所有子视图的计算都不正确。

# ruby-on-rails-3 - Rails 表单仅针对一个字段进行远程操作

> ID：13464764
> 
> 赞同：1
> 
> 时间：2012-11-20T00:20:28.417
> 
> 标签：ruby-on-rails-3, unobtrusive-javascript

我在 Rails 3 中有一个表单，必须使用**普通帖子**提交，就像这样

```
<%= form_for @seller, :as => :seller_user, :url => save_seller_url do |f| %> 
```

但是里面的一个字段需要执行一个远程ajax调用来更新一些值，比如这个

```
<%= f.select( ... ) %> => on change please make a remote call to fill new data here 
```

我没有在网上找到任何文档来将**:remote => true**选项添加到选择助手中，我错过了什么吗？
处理这个的正确方法是什么？
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T04:52:05.050

我也为此挣扎了一段时间。我认为最好的“rails方式”是这样的：

```
<%= form_tag(controller: "sellers", action: "your_controller_action") do %>
    OTHER FORM STUFF HERE
    <select name="some_select" id="some_select" onchange="your_javascript_function">
        <option> ... </option>
    </select>
    OTHER FORM STUFF HERE
    <%= submit_tag("Submit") %>
<% end %> 
```

然后在你的控制器中处理提交，你可以像往常一样引用这个字段，如`params[:some_select]`

这假设您的控制器称为 Sellers_controller。更多关于 form_tag[和](http://apidock.com/rails/ActionView/Helpers/FormTagHelper/form_tag)form_tag 助手[的信息](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html)

# c# - DataGridView 选择特定行并检索其值

> ID：13464766
> 
> 赞同：1
> 
> 时间：2012-11-20T00:20:57.730
> 
> 标签：c#, datagridview

`DataGridView`考虑到`DataGridView`充满数据并且当我自动单击一行数据时我想检索所有数据时，我应该使用什么事件。我尝试使用该事件`CellContentClick`，但它仅在我选择列数据而不是行时才被激活

```
private void dtSearch_CellContentClick(object sender, DataGridViewCellEventArgs e)
{

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:49:37.557

[怎么样](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.rowheadermouseclick.aspx)RowHeaderMouseClick 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T01:25:56.583

尝试使用 CellClick 事件，并遍历检索您想要的行值的列：

```
 private void Form1_Load(object sender, EventArgs e)
    {
        this.dataGridView1.CellClick += new DataGridViewCellEventHandler(dataGridView1_CellClick);
    }

    public void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
    {
        List<object> values = new List<object>();

        int cols = this.dataGridView1.Columns.Count;

        for (int col = 0; col < cols; col++)
        {               

            values.Add(this.dataGridView1[col, e.RowIndex].Value);
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T00:36:19.387

我已经使用了以下效果。我处理`MouseDown`事件`DataGridView`并将整行设置为突出显示，以便很明显它已被选中（当然，除非您已经选择了整行）。

```
 private void dtSearch_MouseDown(object sender, MouseEventArgs e)
    {
        // Get the cell that was clicked from the location of the mouse pointer

        DataGridView.HitTestInfo htiSelectedCell = dtSearch.HitTest(e.X, e.Y);

        if (e.Button == MouseButtons.Left)
        {
            // Make sure that a cell was clicked, and not the column or row headers
            // or the empty area outside the cells. If it is a cell,
            // then select the entire row, set the current cell (to move the arrow to
            // the current row)

            //if (htiSelectedCell.Type == DataGridViewHitTestType.Cell)
            if (htiSelectedCell.Type == DataGridViewHitTestType.RowHeader)
            {
                // do stuff here
            }
        }
    } 
```

# javascript - 当输入包含数字数据时隐藏页面上的元素

> ID：13464767
> 
> 赞同：1
> 
> 时间：2012-11-20T00:20:59.877
> 
> 标签：javascript, forms

如果表单输入字段仅包含数字，我将如何使 div（在本例中为提交按钮）消失。例如，我有一个这样的表格：

```
<form action="submit.php" method="POST">
<input id="email" name="email" />
<input type="submit" class="btn btn-blue" id="email_btn" value="Send" />
<input type="submit" class="btn btn-blue" id="number_btn" value="Send To Number" />
</form> 
```

如果 ID 为“email”的输入只包含数字（一个不带破折号的 7 位电话号码，“3245556347”），而不是其他内容（一个电子邮件地址），则发送按钮消失，发送至号码仍然存在。

希望我能正确解释。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:29:26.890

这是一种可能性：**[jsFiddle example](http://jsfiddle.net/j08691/HKkyT/2)**

```
var email = document.getElementById('email');
email.onkeyup = function() {
    document.getElementById('email2').style.display = (this.value.search(/^\s*\d+\s*$/) != -1) ? 'none' : '';
}​ 
```

# numpy - numpy 自定义数组元素检索

> ID：13464769
> 
> 赞同：2
> 
> 时间：2012-11-20T00:21:05.687
> 
> 标签：numpy

我有一个关于如何从 2D numpy 数组中提取某些值的问题

```
Foo = 
array([[ 1,  2,  3],
       [ 4,  5,  6],
       [ 7,  8,  9],
       [10, 11, 12]])

Bar =
array([[0, 0, 1],
       [1, 2, 3]]) 
```

我想使用 Bar 的值作为索引从 Foo 中提取元素，这样我最终得到一个`Baz`与`Bar`. 对应的`i`第 th 列`Baz`是`Foo[(np.array(each j in Bar[:,i]),np.array(i,i,i,i ...))]`

```
Baz =
array([[ 1,  2,  6],
       [ 4,  8, 12]]) 
```

我可以做几个嵌套的 for 循环，但我想知道是否有更优雅、更 numpy-ish 的方式来做到这一点。

对不起，如果这有点令人费解。让我知道是否需要进一步解释。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:27:44.653

您可以将`Bar`其用作行索引，将数组`[0, 1, 2]`用作列索引：

```
# for easy copy-pasting
import numpy as np
Foo = np.array([[ 1,  2,  3], [ 4,  5,  6], [ 7,  8,  9],  [10, 11, 12]])
Bar = np.array([[0, 0, 1], [1, 2, 3]])

# now use Bar as the `i` coordinate and 0, 1, 2 as the `j` coordinate:

Foo[Bar, [0, 1, 2]]
# array([[ 1,  2,  6],
#        [ 4,  8, 12]])

# OR, to automatically generate the [0, 1, 2]

Foo[Bar, xrange(Bar.shape[1])] 
```

# .htaccess - 审计说“资源是不可缓存的”，但标题说它们是

> ID：13464775
> 
> 赞同：1
> 
> 时间：2012-11-20T00:21:39.600
> 
> 标签：.htaccess, caching, http-headers

当我在 Chrome 中运行审核时，我收到这个警告，说一些文件，如 style.css 是明确不可缓存的：

![审计](../Images/ec9a5b839be599f4cb02f869d9961c11.png) 但是响应标头返回缓存控制：公共。

![标题](../Images/fc84cd9e0d0f1609ae608f46052cae71.png) 我不太了解缓存配置，但标题并没有显示它是公开的。如果不是，我应该看什么线？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:34:57.980

我想你正在寻找`Cache-Control: max-age`.

来自[RFC 2616](http://www.ietf.org/rfc/rfc2616.txt)：

> public：表示响应可以被任何缓存缓存，即使它通常是不可缓存的或只能在非共享缓存中缓存。

另请参阅[此页面](http://palizine.plynt.com/issues/2008Jul/cache-control-attributes/)和[Yahoo 对缓存的建议](http://developer.yahoo.com/performance/rules.html#expires)。

# java - 为什么这是一个数组越界异常？

> ID：13464776
> 
> 赞同：1
> 
> 时间：2012-11-20T00:21:47.897
> 
> 标签：java, arrays, multidimensional-array, indexoutofboundsexception

为什么这会导致数组越界异常？

```
 x[10][2] = 5; 
```

如果这是分配第 11 个数组的第 3 个位置，则值 5

我以矩形的方式思考它。就像我们必须计算 11 行（代表 10 个数组）然后我们必须转到第 3 列，即 2

或者

我应该将其视为一个数组，在实际上不存在的大小为 2 的数组中寻找第 11 个位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T04:26:33.647

为什么这会导致数组越界异常？

```
 x[10][2] = 5; 
```

只有当您尝试访问超出您为数组定义的范围的位置时，才会发生这种情况。例如

```
int x[20][20]; 
```

你可以使 x[10][2] = 5; 没有问题，因为 10 < 20 和 2 < 20。但如果你这样做了：

```
x[30][20] = 5; 
```

您将遇到越界异常，因为您正在尝试访问 2D 数组的位置 (30,20)，该位置超过了 2D 数组的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T04:36:37.923

**x**的第 11 个元素是数组吗？如果是，它的长度是多少？
您收到该错误是因为该元素的长度可能小于 3。
通过尝试对其进行测试

```
 System.out.printf(x[10].length); 

```

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-01T16:27:50.910

那是因为`x[10][2]`不存在。

它可能是因为`x[10]`不是有效元素（即`x.length`等于或大于 10），或者`x[10][2]`不是有效元素（即`x[10].length`等于或大于 2）。异常消息会告诉您哪个索引失败（如果它们不同）。

请注意，多维数组不一定是矩阵。这称为[锯齿状数组](https://en.wikipedia.org/wiki/Jagged_array)。

例如，考虑以下代码（来自 Wikipedia）：

```
int[][] arr = new int[2][]; // creates 2 rows
arr[0] = new int[3]; // 3 columns for row 0
arr[1] = new int[5]; // create 5 columns for row 1 
```

引用`arr[0][4]`会抛出一个`ArrayIndexOutOfBoundsException`，而引用`arr[1][4]`不会。

* * *

*正如马克史蒂文斯在评论中已经提到的，哪一个是行，哪一个是列，是主观的。与 jazzbassrob 在评论中所说的相反，Java 既没有行优先也没有列优先。事实上，在 Java 中，并没有二维数组这种东西，相反，它实际上是一个数组的数组。*

# linq - 返回列表 来自 XDocument

> ID：13464777
> 
> 赞同：1
> 
> 时间：2012-11-20T00:21:53.053
> 
> 标签：linq, c#-4.0

```
<dataList xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
 <headers>
  <header>Template name</header> 
  </headers>
 <rows>
 <row>
  <data>Template1</data> 
  </row>
 <row>
  <data>Template2</data> 
  </row>
  </rows>
</dataList>

        XDocument xml = new XDocument();
        xml = XDocument.Parse(xmlstringFromAbove);
        List<string> list = (from c in xml.Elements("data")
                             select c.Value).ToList(); 
```

此代码返回一个空列表。

如何获取包含 Template1 和 Template2 的字符串列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:23:38.543

该`Elements`方法仅返回直接子级，请`Descendants`改用：

```
var xml = XDocument.Parse(xmlstringFromAbove);
var list = (from c in xml.Descendants("data") select c.Value).ToList(); 
```

# j - 排名如何运作？

> ID：13464779
> 
> 赞同：4
> 
> 时间：2012-11-20T00:22:09.463
> 
> 标签：j

我理解 J 的最好方法是模仿解释器。由于语言紧凑且规则很少，因此很容易......除了等级如何影响函数评估。

我希望能够看到一个表达式，并一步一步地知道 J 做了什么来得到结果。

是否有文档，或者有人可以给我一个算法，这样我就可以自己计算如何`a f " n m b`评估？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T18:16:40.783

要了解 Rank，最容易理解的文本可能[是 J for C Programmers 的第 6 章](http://www.jsoftware.com/help/jforc/loopless_code_i_verbs_have_r.htm#_Toc191734331)。Eric Iverson 的[入门](http://www.jsoftware.com/help/primer/contents.htm)书从[Atom](http://www.jsoftware.com/help/primer/atom.htm)开始并经过[检查点 E](http://www.jsoftware.com/help/primer/checkpoint_e.htm)的部分更简洁地涵盖了该主题。[学习 J 的第 7 章](http://www.jsoftware.com/help/learning/07.htm)是介绍 Rank 的另一个地方。都是有价值的。

Rank 最深入的考查是 Roger Hui 的文章[Rank and Uniformity](http://www.jsoftware.com/papers/rank.htm)。在你学习了关于这个主题的其他文本之后，Hui 的论文会更好地阅读。如果归结为想要实现的细节，您可以深入[研究解释器源代码](http://www.jsoftware.com/source.htm)。就个人而言，我不会做最后一个。如果我想查看实现算法，我会构建一个小模型，并根据 J 解释器的结果检查它，以确保我对 Rank 的理解匹配。

在我看来，等级是 J 中最重要的概念。它非常抽象，因为它适用于名词可以采用的所有形式。相关的概念对于学习很重要。这些包括形状、框架、单元格和协议。这些在 Primer 中单独解释，但每次深入处理该主题时都会以某种方式进行解释。

您对 Rank 连词的理解越好，以及它所应用的名词 Rank 和动词 Rank 的更广泛世界，您会发现词汇表中处理该连词的三个部分就越有用。（这些部分是[m"n](http://www.jsoftware.com/help/dictionary/d600n.htm)、[u"n](http://www.jsoftware.com/help/dictionary/d600v.htm)和[m"v u"v](http://www.jsoftware.com/help/dictionary/d600xv.htm)。）

如果您确实来编写任何算法来帮助您以逐步的方式检查事物，那么其他 J 程序员会喜欢看到它们，我敢肯定。除了实际的解释器源代码之外，我对这些方面一无所知。

# java - Java、menuBar、JMenuitems 焦点

> ID：13464784
> 
> 赞同：0
> 
> 时间：2012-11-20T00:22:57.540
> 
> 标签：java, swing

我已经使用键加速器创建了 JMenuItems，然后我将它们直接添加到菜单栏中，而无需添加到 JMenu，因此它们看起来像 JButtons，一切正常，但我注意到 JMenuItem 在单击或键时永远不会获得焦点按下，这给我带来了一些问题，例如：其中一个 JMenuItems 用于保存，我也有一个 JTextField，它在失去焦点时进行一些验证，但是当按下 Save 时，它​​不起作用，焦点保持在 JTextField 上。

有任何想法吗 ？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:48:26.643

我建议使用`JToolBar`并利用 Action API

这是一个非常简短的示例，说明您如何能够实现对工具栏（或任何）按钮的加速器支持。

```
public class MenuTest {

    public static void main(String[] args) {
        new MenuTest();
    }

    public MenuTest() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JToolBar tb = new JToolBar();
                tb.add(new FastButton(new OpenAction()));

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(tb, BorderLayout.NORTH);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class FastButton extends JButton {

        private FastButton(Action action) {
            super(action);
            setHideActionText(true);
        }

        @Override
        protected void configurePropertiesFromAction(Action a) {
            super.configurePropertiesFromAction(a);
            if (a != null) {
                KeyStroke ks = (KeyStroke) a.getValue(Action.ACCELERATOR_KEY);
                InputMap inputMap = getInputMap(WHEN_IN_FOCUSED_WINDOW);
                ActionMap actionMap = getActionMap();
                inputMap.put(ks, "Action.accelerator");
                actionMap.put("Action.accelerator", a);
            }
        }

    }

    public class OpenAction extends AbstractAction {

        public OpenAction() {
            putValue(NAME, "Open");
            putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_O, InputEvent.CTRL_DOWN_MASK));
            putValue(SMALL_ICON, new ImageIcon(getClass().getResource("/folder_document.png")));
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            System.out.println("Open");
        }

    }

} 
```

# javascript - 当我在书签栏中单击此书签时，为什么它不起作用？

> ID：13464786
> 
> 赞同：0
> 
> 时间：2012-11-20T00:23:07.313
> 
> 标签：javascript, bookmarklet

我想制作一个小书签，将当前的 YouTube URL 更改为在 listenonrepeat.com 上的等效 URL，这样我就可以重复视频了。我的书签栏中有一个带有以下 javascript 的书签：

```
javascript:window.location=window.location.href.replace("youtube","listenonrepeat"); 
```

但是除非我将其复制并粘贴到 URL 栏中，否则它不会更改它。野生动物园 6.

可以在这里看到： http: [//christianselig.com/youtubefix.html](http://christianselig.com/youtubefix.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-03-13T19:36:11.060

替换 url 并将其嵌入到函数中，如下面的代码，使其直接打开一个新窗口`listenonrepeat`：

```
javascript:(function(win){win.open(win.location.href.replace("youtube","listenonrepeat"));})(window) 
```

# cordova - 如何在本地设置 Sencha Touch 2 以构建 Phone Gap 云服务？

> ID：13464790
> 
> 赞同：1
> 
> 时间：2012-11-20T00:23:35.253
> 
> 标签：cordova, mobile, sencha-touch

我想使用 Phone Gap Cloud 服务来避免管理原生 SDK、为 Android、iOS 等创建单独的构建，但我对如何为 Sencha 进行设置感到困惑。

我知道如何在 Eclipse 中为 Android 设置 PhoneGap，但如果我打算使用 Cloud Build 服务，我该如何编写应用程序代码？有几件事让我感到困惑：

1.  我是否从某处下载“phonegap.js”并将其包含在我的 index.html 中？或者如果我引用它，它是否只是由构建服务自动包含？

2.  如果所有的 phonegap 魔法都是通过云发生的，我如何在本地进行测试？

3.  云构建服务提供了一些插件，例如 ChildBrowser、Analytics、Barcode Scanner。同样，我是否也必须下载这些插件或仅引用它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T20:10:55.193

1.  只需包括`phonegap.js`. PhoneGap Build 会自动将此文件添加到您的构建中。
2.  PhoneGap Build Service 用于构建自动化过程。如果您需要在本地测试某些东西，那么您必须在云服务完成应用程序构建后安装和配置本地环境或仅在真实设备或模拟器上进行功能测试。
3.  要使用 PhoneGap Build 插件，您必须：
    *   包含插件 JS 文件。同样，所有文件都将自动添加。
    *   包含插件本机代码，将类似内容添加`<gap:plugin name="Example" />`到`config.xml`文件中

# c - 算法 c 将 2 和 5 的倍数相加

> ID：13464802
> 
> 赞同：1
> 
> 时间：2012-11-20T00:25:03.580
> 
> 标签：c, performance, algorithm

几天前我有一个工作面试，他们问我如何使用 c 语言计算从 1 到 10000 的所有 2 或 5 的倍数的总和。我这样做了：

```
int mult2_5()
{
     int i, sum=0;
     for(i = 1; i <= 10000; i++)
        if(i % 2 == 0 || i % 5 == 0)
          sum += i;
     return sum;  
} 
```

我想知道是否有比这个更快的实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T00:28:30.573

模运算符效率低下。一个更快的实现将是这样的：

```
int multiply2_5(int max)
{
  int i, x2 = 0,x5 = 0,x10 = 0;

  for(i = 2; i < max; i+=2)    x2 += i;    // Store all multiples of 2   O(max/2)
  for(i = 5; i < max; i+=5)    x5 += i;    //  Store all multiples of 3  O(max/5)
  for(i = 10; i < max; i+=10)  x10 += i;   //   Store all multiples 10;  O(max/10)

  return x2+x5-x10;
} 
```

在这个解决方案中，我必须取出 10 的倍数，因为 2 和 5 的倍数是 10，所以在第二个循环中，它将添加已经在第一个循环中添加的 10 的倍数；三个循环组合有 O(8/10 max)。

另一个更好的解决方案是采用数学方法。

您正在尝试对所有数字求和，例如 2 + 4 + 6 + 8 ... 10000 和 5 + 10 + 15 +20 + ... 10000 这与 2 * (1 + 2 + 3 + 4 + ... + 5000) 和 5 * ( 1 + 2 + 3 + 4 + ... + 2000)，'n' 自然数之和是 (n * (n + 1)) ( [source](http://www.9math.com/book/sum-first-n-natural-numbers) ) 所以你可以计算恒定时间，如下：

```
int multiply2_5(int max)
{
    // x = 2 + 4 + 6 + ... = 2 * (1 + 2 + 3 +...)
    // y = 5 + 10 + 15 + ... = 5 * (1 + 2 + 3 +...)
    // The sun of n natural numbers is sn = (n (n + 1)) / 2
   int x2 = max/ 2;                      // 2 * ( 1 +2 + 3 … max/2)
   int x5 = max /5;                      // 5 * ( 1 +2 + 3 … max/5)
   int x10 = max/ 10;                  
   int sn2 = 0.5 * (x2 * (x2+1));        // (n * (n + 1)) / 2
   int sn5 = 0.5 * (x5 * (x5+1)); 
   int sn10 = 0.5 * (x10 * (x10+1));
   return (2*sn2) + (5 *sn5) - (10*sn10);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T01:15:44.050

如果这就是您所说的“更快”的意思，请先在纸上解决。

$2\sum_{1<=2k<=10000}k + 5\sum_{1<=5k<=10000} - 10\sum_{1<=10k<=10000}k$

对不起，我的 SO equation-fu 很弱......无论如何，这条路线会给你一些你几乎可以在纸上处理的东西：减少几个步骤后的 5000*6001

```
int
mult2_5(void)
{
    return 5000*6001;
} 
```

[Project Euler 问题 1](http://projecteuler.net/problem=1)非常相似。有很多人已经发布了他们的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T01:26:41.070

正如前面的回答中提到的，明确地循环遍历相关的倍数比在每个循环中测试余数要好。但不必计算 10 的倍数并减去。只需从 5 点开始，然后按 10 点逐步跳过它们。

```
int multiply2_5b(int max)
{
  int i, x2 = 0,x5 = 0;

  for (i = 2; i < max; i += 2)    x2 += i;    // Sum all multiples of 2   
  for (i = 5; i < max; i += 10)   x5 += i;    // Sum all odd multiples of 5

  return x2 + x5;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T04:00:10.450

这可以使用数学来完成。像`2 * sum(1 to 5000) + 5 * sum(1 to 2000) - 10 * sum(1 to 1000).` 一个错误的错误作为练习留下了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T03:57:14.140

通过执行一个以 35（2 + 4 + 5 + 6 + 8 + 10 的总和）开始，步长为 60 的简单循环，我几乎得到了一个纯粹而简单的乘法，因为这就是你的结果将增加多少取下一批，例如 12 + 14 + 15 + 16 + 18 + 20 等 for(int i=35;i<5976;i=i+60) { sum=sum+i } 5976 来自 5975 是最后一个以 1000 结尾的数字行，即 992 + 994 + 995 + 996 + 998 + 1000。所以事实证明，这个循环运行了 100 次，第一轮总和增加 35，其余 99 次增加 60。现在可以简化为简单的乘法等。

# c++ - 如何为面向对象的层次结构重载 operator<？

> ID：13464804
> 
> 赞同：0
> 
> 时间：2012-11-20T00:25:19.537
> 
> 标签：c++, object, polymorphism, overloading, oop

我有以下课程

```
class A{
    operator<(A & object);  //how do i make it so hat B < C?
};

class B: public A{
    operator<(A & object);
};

class C: public A {
    operator<(A & object);
};
A * ptr = new B();
A * ptr2 = new C();

if (*ptr < *ptr2)   //how do I overload this? 
```

如何重载 < 函数以使其知道 B 类小于 C 类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T01:13:56.917

正如 Mooing Duck 所说，当您需要在运行时动态绑定两个对象时，您需要使用双重调度。在这种情况下，我们可以简单地做到这一点，因为涉及的类型很少。

首先将呼叫设为虚拟：

```
class B;
class C;

class A{
public:
    virtual bool operator<(const A & object) const = 0; // I assume you only care about B and C
    virtual bool operator<(const B & object) const = 0;
    virtual bool operator<(const C & object) const = 0;
}; 
```

然后做这样的事情：

```
class B: public A{
public:
    virtual bool operator<(const A & object) const
    {
        // do a second bind, now that we know 'this' is type B. Negate cause we
        // are switching the operands.
        return !object.operator<( (const B&)*this);
    }
    virtual bool operator<(const B & object) const
    {
        //<do your logic>; // here you can assume both will be type B
    }
    virtual bool operator<(const C & object) const
    {
        return true; // B is always < than C right?
    }
};

class C: public A{
public:
    virtual bool operator<(const A & object) const
    {
        // do a second bind, now that we know 'this' is type C. Negate cause we
        // are switching the operands.
        return !object.operator<( (const C&)*this);
    }
    virtual bool operator<(const B & object) const
    {
        return false; // C is always > then B right?
    }
    virtual bool operator<(const C & object) const
    {
        //<do your logic>; // here you can assume both will be type C
    }
}; 
```

我们在这里为每个对象做一个动态绑定，因此在运行时知道这两种类型。

更新：我稍微更改了代码以防止无限递归。

# r - 对于 NA 或 "" 条目，grep 行为很奇怪

> ID：13464807
> 
> 赞同：4
> 
> 时间：2012-11-20T00:26:09.490
> 
> 标签：r

我对 R 相当陌生，并且正在使用一个带有空条目的向量，并注意到 grep 对我的数据的行为违反直觉。我只是举一个例子，因为我不是 100% 确定如何解释它。假设我有三个向量：

```
A<-c("","","","","","","a")
B<-c(NA,NA,NA,NA,NA,NA,"a") 
```

`A`是最初存储数据的方式，`B`也是 R 读取我的数据的方式。运行`> vec[grep("",vec, invert=TRUE)]`- 据我了解 - 搜索`vec`所有空单元格，返回它们的索引，然后填充并显示具有非空数据条目的结果向量。但是，当我运行它时`vec=A`，`vec=B`我得到：

**vec = A：**

```
> A[grep("",A, invert=FALSE)]
[1] "" "" "" "" "" "" "" "a" 
> A[grep("",A, invert=TRUE)]
character(0) 
```

**vec = B：**

```
> B[grep("",B, invert=FALSE)]
[1] "a"
> B[grep("",B, invert=TRUE)]
[1] NA NA NA NA NA NA 
```

因为我认为我的数据被读取就像案例 BI 被反直觉的结果难住了。我意识到这可能只是一个变量类型的问题，但是我想知道是否有人可以对正在发生的事情有更多的了解。

*快速编辑*案例 A 是有道理的：因为 grep 找不到“”，因为变量类型已关闭，所以它返回所有内容。反转，它返回字符（0）作为“无”的默认值。仍然对案例 B 感到困惑。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T00:34:14.227

请注意，`grep`执行**正则表达式**搜索（不是字符串匹配）。

您输入的正则表达式`""`是**空**的，因此运行会`grep`询问它匹配的任何字符串是否*包含* `""`，而不是字符串是否*完全匹配*“”。

例如，

```
grepl("a","bananas") 
```

返回`TRUE`是因为“a”*在*“bananas”中。

如果要将*整个字符串*与匹配`""`，可以在正则表达式中使用 '^' 和 '$' （'^' 表示字符串的开头，'$' 表示字符串的结尾）：

```
grepl("^$", "") # returns TRUE
grepl("^$", "a") # returns FALSE 
```

但是，如果您想要的只是空单元格，那么您最好不要使用正则表达式：

```
A[A != ""] # returns "a"
B[!is.na(B)] # returns "a" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T00:32:16.307

对于你的第一个问题：

```
> A[grep("^$", A)]
[1] "" "" "" "" "" ""
> A[grep("^$", A, invert=TRUE)]
[1] "a" 
```

您`""`用作模式的用途是拾取任何字符元素。的用途`"^$"`是拾取开始和结束之间没有字符的字符元素的位置。

就像 NA什么都不做`"=="`（甚至它自己）一样，所以 NA not match 也是如此`""`。

# angularjs - angular.js 过滤器的反极性

> ID：13464809
> 
> 赞同：31
> 
> 时间：2012-11-20T00:26:19.440
> 
> 标签：angularjs

给定一个在满足某些条件时返回 true 的过滤器方法，是否可以在 HTML 中调用其相反的方法，例如使用：

```
"item in items | filter:!AllDay" 
```

代替

```
"item in items | filter:AllDay" 
```

? 或者您是否必须维护两种单独的过滤方法（一种为假，一种为真）？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-11-21T17:33:32.210

正如[ENDOH](https://stackoverflow.com/questions/13278371/angularjs-filter-negated/13450568#13450568)所指出的（这个 SO 问题在技术上是重复的），您可以通过在前面加上“！”来否定过滤器。到过滤器字符串，如下所示：

```
filter:'!'+myFilter 
```

请注意“！” 被引用。[文档](http://docs.angularjs.org/api/ng.filter:filter)对此并不十分清楚，并且有一个示例会有所帮助。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-07-23T13:28:19.907

shacker 的回答不适用于 angular 1.0.7，所以这里有另一种方法：

```
// You can register this in your AppCtrl if you like, otherwise just use $scope.
$rootScope.not = function(func) {
    return function (item) { 
        return !func(item); 
    }
}; 
```

然后你会这样做：

```
filter:not(myFilterMethod) 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-11-20T10:22:52.080

```
filter:({day: '!'+AllDay.day}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-14T13:23:55.657

另一种选择是创建一个新的否定过滤器并将其管道化：

```
 .filter('not', function() {
    return function(input) {
      return !input;
    }
  }) 
```

```
"item in items | filter:AllDay | filter:not" 
```

# ajax - 是否可以使用带有延迟对象的 Jsonp 进行多次调用？

> ID：13464815
> 
> 赞同：0
> 
> 时间：2012-11-20T00:26:54.277
> 
> 标签：ajax, jquery, jsonp

如果可能的话，我正在尝试同时提出两个或更多请求？我担心速度，因为在发出第一个请求后，我想将该信息显示到网页上，然后对每个额外的 url 执行相同的操作。

我一直在阅读有关延迟对象的信息并尝试了一些示例，到目前为止，我已经尝试过这样做，

```
<!DOCTYPE html>
<html>
<head>
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script >
$(document).ready(function($) {
// - 1st link in chain - var url = 'https://www.sciencebase.gov/
catalog/items?parentId=504108e5e4b07a90c5ec62d4&max=60&offset=0&format=jsonp';
// - 2nd link in chain - var url = 'https://www.sciencebase.gov/
catalog/itemLink/504216b6e4b04b508bfd333b?format=jsonp&max=10';
// - 3rd (and last) link in chain - var url = 'https://www.sciencebase.gov/
catalog/item/4f4e4b19e4b07f02db6a7f04?format=jsonp';

// parentId url
function parentId() {

//var url = 'https://www.sciencebase.gov/catalog/items?parentId=
504108e5e4b07a90c5ec62d4&max=3&offset=0&format=jsonp';

    return $.ajax({
        type: 'GET',
        url: 'https://www.sciencebase.gov/catalog/items?parentId=
        504108e5e4b07a90c5ec62d4&max=3&offset=0&format=jsonp',
        jsonpCallback: 'getSBJSON',
        contentType: "application/json",
        dataType: 'jsonp',
        success: function(json) {},
        error: function(e) {
            console.log(e.message);
        }
    });
}

// itemLink url
function itemLink() {

    //var url = 'https://www.sciencebase.gov/catalog/itemLink
    /504216b6e4b04b508bfd333b?format=jsonp&max=10';

    return $.ajax({
        type: 'GET',
        url: 'https://www.sciencebase.gov/catalog/itemLink
        /504216b6e4b04b508bfd333b?format=jsonp&max=10',
        jsonpCallback: 'getSBJSON',
        contentType: "application/json",
        dataType: 'jsonp',
        success: function(json) {},
        error: function(e) {
            console.log(e.message);
        }
    });
}

// Multiple Ajax Requests 
$.when( parentId(), itemLink()).done(function(parentId_data, itemLink_data) {
    console.log("parentId_data.items[0].title");

});

}); 
```

但这些功能似乎没有发挥作用。我希望能够在函数内的 .when() 方法之后放置一些东西来告诉我的程序该做什么，但我没有得到任何显示？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T04:07:19.163

部分问题是在 $.when 的 done 处理程序中，传递给回调的参数是每个请求的参数数组，而不仅仅是您要使用的数据。您可以通过使用[.pipe](http://api.jquery.com/deferred.pipe/)来解决此问题，如下例所示。

另外，除非你有充分的理由，否则不要指定 jsonpCallback，大多数时候你想让 jQuery 在内部为你管理它。

[这是一个在JSFiddle](http://jsfiddle.net/xZzmF/)上测试的工作示例

```
jQuery(function($) {

    function parentId() {
        return $.ajax({
            url: 'https://www.sciencebase.gov/catalog/items?parentId=504108e5e4b07a90c5ec62d4&max=3&offset=0&format=jsonp',
            dataType: 'jsonp',
            error: function(e) {
                console.log(e.message);
            }
        // We'll use pipe here so that rather than the value being passed to our $.when handler
        // is simply our data rather than an array in the form of [ data, statusText, jqXHR ]
        }).pipe(function( data, statusText, jqXHR ) {
            return data;
        });
    }

    function itemLink() {
        return $.ajax({
            url: 'https://www.sciencebase.gov/catalog/itemLink/504216b6e4b04b508bfd333b?format=jsonp&max=10',
            dataType: 'jsonp',
            error: function(e) {
                console.log(e.message);
            }
        }).pipe(function(data) {
            return data;
        });
    }

    // Multiple Ajax Requests 
    $.when( parentId(), itemLink()).done(function(parentId_data, itemLink_data) {
        console.log( parentId_data, itemLink_data );
    });
}); 
```

# java - 如何减少 Elasticsearch 滚动响应时间？

> ID：13464821
> 
> 赞同：6
> 
> 时间：2012-11-20T00:27:36.923
> 
> 标签：java, elasticsearch

我有一个查询返回来自分布在我们集群中的 7 个不同索引的约 20 万次点击。我将我的结果处理为：

```
while (true) {
    scrollResp = client.prepareSearchScroll(scrollResp.getScrollId()).setScroll(new TimeValue(600000)).execute().actionGet();

    for (SearchHit hit : scrollResp.getHits()){
            //process hit}

    //Break condition: No hits are returned
    if (scrollResp.hits().hits().length == 0) {
        break;
    }
} 
```

我注意到在返回下一组搜索命中之前，client.prepareSearchScroll 行可能会挂起相当长的时间。我运行代码的时间越长，这似乎越糟。

我的搜索设置是：

```
SearchRequestBuilder searchBuilder = client.prepareSearch( index_names )
    .setSearchType(SearchType.SCAN)
    .setScroll(new TimeValue(60000)) //TimeValue?
    .setQuery( qb )
    .setFrom(0) //?
    .setSize(5000); //number of jsons to get in each search, what should it be? I have no idea.
    SearchResponse scrollResp = searchBuilder.execute().actionGet(); 
```

在检查许多结果时，是否预计扫描和滚动只需要很长时间？我对 Elastic Search 很陌生，所以请记住，我可能遗漏了一些非常明显的东西。

我的查询：

```
QueryBuilder qb = QueryBuilders.boolQuery().must(QueryBuilders.termsQuery("tweet", interesting_words)); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T20:17:09.220

`.setSize(5000)`意味着每次`client.prepareSearchScroll`调用将检索每个分片 5000 条记录。您正在请求回溯源，如果您的记录很大，在内存中组装 5000 条记录可能需要一段时间。我建议尝试一个较小的数字。尝试 100 和 10 看看您是否获得了更好的性能。

`.setFrom(0)`没有必要。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-07-22T20:42:11.720

我将在这里添加另一个答案，因为我对这种行为感到非常困惑，我花了很长时间才在@AaronM 的评论中找到答案

这适用于 ES 1.7.2，使用 java API。

我正在滚动/扫描 500m 记录的索引，但查询返回大约 400k 行。

我开始时滚动大小为 1,000，在我看来，这在网络与 CPU 方面是一个合理的权衡。

这个查询运行得非常慢，大约需要 30 分钟才能完成，在从游标提取之间有很长的停顿。

我担心这可能只是我正在运行的查询，并且不相信减小滚动大小会有所帮助，因为 1000 看起来很小。

但是，看到上面 AaronM 的评论，我尝试了 10 的滚动大小。

整个工作在 30 秒内完成（这是我是否重新启动了 ES，所以大概与缓存无关） - 加速约 60 倍！

因此，如果您在滚动/扫描方面遇到性能问题，我强烈建议您尝试减小滚动大小。我在互联网上找不到太多关于这个的信息，所以在这里发布了这个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-13T12:43:03.977

*   查询数据节点不是客户端节点或主节点
*   选择您需要的`filter_path`属性字段
*   根据您的文档大小设置滚动大小，没有神奇的规则，您必须设置值并尝试，等等
*   监控您的网络带宽
*   如果这还不够，让我们去找一些多线程的东西：

认为elasticsearch索引是由多个分片组成的。这种设计意味着您可以并行化操作。

假设您的索引有 3 个分片，并且您的集群有 3 个节点（按索引拥有比分片更多的节点的好习惯）。

您可以在每个单独的线程中运行 3 个 Java“工作者”，它们将搜索滚动不同的分片和节点，并使用队列来“集中”结果。

这样，您将有一个很好的表现！

这就是 elasticsearch-hadoop 库的作用。

要检索有关索引的分片/节点详细信息，请使用[https://www.elastic.co/guide/en/elasticsearch/reference/current/search-shards.html](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-shards.html) API。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-09-11T09:12:17.043

## 你可以在这里阅读文档

[搜索滚动请求生成器](http://javadoc.kyubu.de/elasticsearch/v1.2.0/org/elasticsearch/action/search/SearchScrollRequestBuilder.html)！

> 我认为 Timevalue 是时候让滚动保持活力了

```
setScroll(TimeValue keepAlive) 
```

如果设置，将启用指定超时的搜索请求滚动。

## 你可以在这里阅读更多 ：

[滚动](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-scroll.html#scroll-search-context)

# c++ - 契约式设计和 C++ 中的单元测试

> ID：13464823
> 
> 赞同：2
> 
> 时间：2012-11-20T00:27:52.793
> 
> 标签：c++, unit-testing, c++builder, googletest, design-by-contract

我正在尝试在应用程序中结合基本的按合同设计（由使用内置断言函数的宏实现）和 Google 测试单元测试。

因此，例如，我有以下代码：

```
AppFavorite* AppFavorites::Add(const UnicodeString& link)
{
    REQUIRE(!link.IsEmpty());

    ...
} 
```

现在，我的单元测试中不能进行以下测试，因为 IDE 在到达断言时中止 (REQUIRE(!link.IsEmpty());)：

```
TEST(AppFavoritesTest, AddEmpty)
{
    AppFavorites favorites;
    ASSERT_THROW(favorites.Add(L""), std::invalid_argument);
} 
```

所以，我的问题是我应该：

1.  切勿测试合同涵盖的条件，或
2.  在单元测试期间以某种方式禁用合同检查？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T00:38:55.490

您需要确定将空字符串传递给该函数是否是*未定义的行为*，或者如果传递一个空字符串，它的合同是否保证它会引发异常。

听起来你的意图是让它成为未定义的行为，即合同没有说明如果传递一个空字符串会发生什么。在这种情况下，测试合同验证的最简单方法是将用于负面测试的单元测试构建为特殊构建，并`REQUIRE`修改为抛出一些“违反前提条件”异常，然后您将使用`ASSERT_THROW`

我强烈推荐观看[John Lakos 在 ACCU 2011 上关于防御性编程的演讲](http://skillsmatter.com/podcast/home/defensive-programming-done-right)，它正好涵盖了这个问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T08:46:20.520

合同设计定义了法律。每次使用您的软件都必须遵守这些法律——包括其单元测试。单元测试测试，*只要*软件符合法律，它也可以做你想让它做的事情。

所以你应该只在满足前提条件的情况下测试你的软件。

在任何用户可能以错误方式使用的公共层中，最好激活前置条件检查，或者使用特殊的输入验证层保护您的输入，然后使用各种可能的输入数据进行测试，包括您的内部逻辑将视为违反先决条件 - 但您将测试的是保护层。

从长远来看，我发现遵循这种策略的软件构建更加健壮和可维护。

# java - MentaContainer 上的自动接线不起作用？

> ID：13464824
> 
> 赞同：1
> 
> 时间：2012-11-20T00:28:01.737
> 
> 标签：java, dependency-injection, inversion-of-control, ioc-container, autowired

我试图弄清楚为什么自动接线不适用于我下面的情况。有人可以在这里帮助我吗？

```
public interface UserDAO {
    // ..
}

public class DBUserDAO implements UserDAO {
    private Connection conn;

    public void setConn(Connection conn) {
        this.conn = conn;
    }

    public Connection getConn() {
        return conn;
    }

    // ..
}

Container container = new MentaContainer();

c.ioc(Connection.class, connFactory);
c.ioc(UserDAO.class, DBUserDAO.class);
c.autowire(Connection.class);

Connection conn = c.get(Connection.class); // not NULL !!! good!
UserDAO userDAO = c.get(UserDAO.class);

System.out.println("CONN: " + ((DBUserDAO) userDAO).getConn()); // prints "CONN: null" 
```

我不知道为什么 DBUserDAO 中的连接总是为空！:(

编辑：我正在使用[MentaContainer](http://mentacontainer.soliveirajr.com)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T01:24:59.817

这里发生的事情是容器无法知道您的 bean 属性是“conn”。因为您没有定义任何内容，所以必须假定它是“连接”。`c.autowire(Connection.class)`从到的简单更改将解决问题。或者，您可以像@Sérgio Michels 所说的那样将您的属性更改为“连接”，这不仅有效，而且在我看来也是一个更好的命名约定。`c.autowire(Connection.class, **"conn"**)`

实际上，我最喜欢的解决方法是使用构造函数注入而不是 setter 注入。然后你不必弄乱属性名称：

```
public interface UserDAO {
    // ..
}

public class DBUserDAO implements UserDAO {

    private final Connection conn;

    public DBUserDAO(Connection conn) {
        this.conn = conn;
    }

    // ..
}

Container container = new MentaContainer();

c.ioc(Connection.class, connFactory);
c.ioc(UserDAO.class, DBUserDAO.class);
c.autowire(Connection.class); 
```

因为 Java 中的构造函数（*或任何方法*）参数没有名称，所以容器只会尝试匹配类型，并且会成功匹配自动装配`Connection.class`的构造函数参数。而且你不可能有一个没有连接的 DBUserDAO。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:45:17.820

永远不要使用它，但是查看文档，您的自动装配将不起作用，因为您已经将 UserDAO 放在了上下文中。所以我认为正确的是：

```
c.ioc(Connection.class, connFactory);
c.autowire(Connection.class); //from now, every object that have connection will be autowired.
c.ioc(UserDAO.class, DBUserDAO.class); 
```

# seam2 - 在 Seam 中离开页面时结束对话

> ID：13464828
> 
> 赞同：0
> 
> 时间：2012-11-20T00:28:12.713
> 
> 标签：seam2

我的 Seam 项目中有一个向导，它有四个页面。当用户通过进入第一页*（wizard1.xhtml）*启动向导时，我开始对话。为此，`pages.xml`我有以下代码。

```
<page view-id="/pages/wizard1.xhtml">
  <begin-conversation join="true"/>
</page> 
```

在向导的最后一页*（wizard4.xhtml）*我有一个保存按钮，我通过使用`@End`注释来结束对话。

```
@End
public String save() {} 
```

但是，在浏览向导时，用户可以通过单击链接重定向到向导之外的页面。请注意，如果发生这种情况，对话尚未结束。
我想要的是一旦用户不再在向导页面*（wizard1.xhtml、wizard2.xhtml、wizard3.xhtml 或wizard4.xhtml）上，立即结束对话。*
我找到[了这篇](https://stackoverflow.com/questions/7599288/end-conversation-in-seam-when-the-user-leaves-the-page)文章，但就我而言，**超时**不是一个好选择，因为我想立即结束对话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T15:39:47.980

我认为您的问题最直接和自然的解决方案是使您的可点击链接如下所示：

```
 <s:link value="here is the link" view="/expectedView.xhtml"  
         action ="#{targetBean.endingConversation()}"/> 
```

您的endingConversation() 方法可以是这样的：

```
 @End
  public void endingConversation(){
       //do cleanup code

  } 
```

**这个想法很简单，你应该在每个可能的出口点都配备一名警卫。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:03:22.543

不确定它是否会起作用，只是一个想法。

创建一些 javascript 函数，使用`a4j:jsFunction`它调用一个用`@End`.

然后，您将其`jsFunction`作为`onClick`处理程序添加到您的所有链接。（虽然不确定是否`onClick`是最好的处理程序）。

当用户离开您的向导时，调用该方法并且应该结束对话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T01:25:55.943

如果您使用 pages.xml（或每页 page.xml 文件）在应用程序中实现页面导航，那么您必须根据操作字符串为每个页面指定重定向行为。在不继续您的向导对话的每个重定向的导航规则中，您可以添加`<end-conversation />`. 这与其他建议类似，但结果将是导航规则文件，这些文件说明了您的应用程序页面流程，包括您的长期对话的划分。

# arrays - Go：用现有数组的类型和值定义多维数组？

> ID：13464838
> 
> 赞同：4
> 
> 时间：2012-11-20T00:29:30.553
> 
> 标签：arrays, go, multidimensional-array

是否可以 a) 定义 b) 使用现有数组初始化一个新的多维数组，就像在下面的代码中而不是`var b [2][3]int`，只是说类似`var b [2]a`？
使用 a 的类型，而不是对其进行硬编码（这忽略了使用 [...] 作为 a 的意义）。
也许同时处理初始化=复制值？

```
package main

func main () {
        a := [...]int{4,5,6}
        var b [2][3]int
        b[0],b[1] = a,a 
} 
```

（我知道切片的易用性和便利性，但这个问题是关于理解数组。）

编辑：不敢相信我忘记了`var b [2][len(a)]int`，初学者的大脑冻结。一条线的答案是`var b = [2][len(a)]int{a,a}`。那是类型转换，对吧？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T00:38:18.733

下面的代码也可以。你的例子和我的例子都做同样的事情，而且都不应该比另一个快得多。

除非您使用反射来制作您的切片（而不是数组）`[3]int`，否则不可能`[3]int`在您的新类型中不重复。即使在当前版本中也是不可能的。它处于提示状态，将在 Go 1.1 中发布。

```
package main

import "fmt"

func main() {
    a := [...]int{4,5,6}
    var b = [2][3]int{a, a}
    fmt.Println(b)
} 
```

# codeigniter - 如何清理过期的 codeigniter 会话？

> ID：13464840
> 
> 赞同：11
> 
> 时间：2012-11-20T00:29:40.523
> 
> 标签：codeigniter, session

专家们，

我试图了解如何在 Codeigniter 中清理会话，以防应用程序配置为将会话存储在数据库表中。

在我的例子中，我在该会话表中有三个过期的会话和一个用于同一用户的活动会话。手册指出：“注意：Session 类具有内置的垃圾收集功能，可以清除过期的会话，因此您无需编写自己的例程来执行此操作。”

嗯，那么我在数据库会话表中的“旧”会话何时被清除或者我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-20T01:00:40.077

下面是 Session 类的相关源码：

```
/**
 * Garbage collection
 *
 * This deletes expired session rows from database
 * if the probability percentage is met
 *
 * @access  public
 * @return  void
 */
function _sess_gc()
{
    if ($this->sess_use_database != TRUE)
    {
        return;
    }

    srand(time());
    if ((rand() % 100) < $this->gc_probability)
    {
        $expire = $this->now - $this->sess_expiration;

        $this->CI->db->where("last_activity < {$expire}");
        $this->CI->db->delete($this->sess_table_name);

        log_message('debug', 'Session garbage collection performed.');
    }
} 
```

这个函数在一个地方调用，在 Session 类的构造函数中（几乎是最后一行），所以在正常情况下每个请求一次。

`$this->gc_probability`被硬编码到`5`类的顶部，并且似乎无法更改它。我不确定，但我相信这意味着 5% 的时间（随机）垃圾收集将运行，从会话数据库表中清除旧条目。

请注意，这些旧条目没有任何意义或危害，清理只是为了让您的数据库表不会因旧的、无用的记录而过载。

# php - PHP 读取受保护页面的 HTML 源代码

> ID：13464845
> 
> 赞同：-3
> 
> 时间：2012-11-20T00:30:15.327
> 
> 标签：php, download, session-cookies

> **可能重复：**
> [使用 HTTP-Basic 身份验证发出 HTTP GET 请求](https://stackoverflow.com/questions/7732634/making-a-http-get-request-with-http-basic-authentication)

我想获取受密码保护的页面的 HTML 源代码。我通常使用此代码来获取未受保护页面的 html 源代码。

```
$handle = @fopen("http://www.webmasterworld.com", "rt");
$source_code = fread($handle,9000); 
```

如何使用用户名和密码获取受密码保护的页面的来源？它不受基本身份验证的保护。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T01:17:10.957

由于这不是 BASIC AUTH（例如，在 apache 中通过 .htaccess 保护），而是似乎基于会话/cookie，因此您需要首先提交用户名/密码，就像普通浏览器通过 POST 请求一样。成功后，Web 应用程序将向您返回一个 cookie 名称/值对，您需要将其用于下一个请求（即请求您要阅读的页面）。

您可以使用服务器希望您设置的所有 cookie 键/值对，也可以找出重要的会话 cookie 是什么。这取决于 Web 应用程序的工作方式。要弄清楚会话 cookie 名称应该是什么以及通常的值是什么样的，请尝试通过诸如 firebug 或 chrome 的开发工具之类的工具查看 HTTP 请求。一旦你弄清楚了重要的 cookie 名称/值是什么，请确保在下一个请求中尝试读取页面时发送它。

在 PHP 中完成这一切的最简单方法是使用[cURL](http://php.net/curl)。粗略的想法有两个部分：

1) 将用户名/密码发布到表单的 action="" 处理器并返回 cookie 值对。请参阅[`curl_init()`](http://www.php.net/manual/en/function.curl-init.php)、[`curl_setopt()`](http://www.php.net/manual/en/function.curl-setopt.php)和[`curl_exec()`](http://www.php.net/manual/en/function.curl-exec.php)了解如何初始化请求，设置其选项（例如，将其类型设置为 POST，设置浏览器代理字符串以防处理脚本仅响应真实浏览器，将请求设置为仅标头请求等）然后执行。有关如何执行此操作和获取 cookie 值的更多详细信息，请参见[此处的类似帖子](https://stackoverflow.com/questions/895786/how-to-get-the-cookies-from-a-php-curl-into-a-variable)。

2) 获得会话 cookie 键/值对后，通过提供 cookie/值对来读取页面，以便网站知道您之前已通过身份验证。在设置第二个请求并提供 cookie=value 对时，您需要使用`CURLOPT_COOKIE`选项 with 。`curl_setopt()`有关如何通过 cURL 发送 cookie 的更多详细信息，请参见[此处的相关帖子](https://stackoverflow.com/questions/1857377/php-using-curl-is-there-a-way-to-emulate-a-cookie-instead-of-saving-it-to-a-fil)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:53:47.973

尝试对用户名和密码进行 url 编码并将它们添加到 URL。

```
$encUser = urlencode($username);
$encPass = urlencode($password);
$handle = @fopen("http://{$encUser}:{$encPass}@www.webmasterworld.com", "rt"); 
```

几乎任何将通过 HTTP 为您获取文档的库都了解 URL 中的基本凭据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T00:34:55.853

什么样的保护？如果是 BASIC AUTH，请改用 curl。如果它落后于会话会变得更加复杂。

# twitter-bootstrap - 使用 Require.js 从 CDN 加载 Bootstrap

> ID：13464846
> 
> 赞同：53
> 
> 时间：2012-11-20T00:30:17.197
> 
> 标签：twitter-bootstrap, requirejs, cdn

Bootstrap 分布在 CDN 中

[http://www.bootstrapcdn.com/](http://www.bootstrapcdn.com/)

*   是否可以使用 Require.JS 2.x（垫片或原生 AMD）加载引导程序？

*   如何使用 Require.js 直接从 CDN URL 加载 Bootstrap 或任何缩小的 JS

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-11-21T17:33:08.320

```
requirejs.config({
    appDir: ".",
    baseUrl: "js",
    paths: { 
        /* Load jquery from google cdn. On fail, load local file. */
        'jquery': ['//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min', 'libs/jquery-min'],
        /* Load bootstrap from cdn. On fail, load local file. */
        'bootstrap': ['//netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.', 'libs/bootstrap-min']
    },
    shim: {
        /* Set bootstrap dependencies (just jQuery) */
        'bootstrap' : ['jquery']
    }
});

require(['jquery', 'bootstrap'], function($) {
    console.log("Loaded :)");    
    return {};
}); 
```

# javascript - 使用 casperjs 处理 jquery 事件

> ID：13464851
> 
> 赞同：3
> 
> 时间：2012-11-20T00:30:37.320
> 
> 标签：javascript, phantomjs, casperjs

我有一个网页，在加载 dom 后，javascript 继续在页面上运行并将元素添加到页面上。在运行完所有 javascript 之后，我会触发一个 jquery 事件 page.loaded，以便页面上在我的所有 javascript 运行后有兴趣做某事的组件可以这样做。

我正在尝试使用 casperjs/phantomjs 自动测试此网页，并且我想仅在触发 jQuery 页面加载事件后检查页面上的元素。我该怎么做呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T07:38:07.380

查看[waitFor](http://casperjs.org/api.html#casper.waitFor)系列函数，以便在页面环境中等待某些事情发生。您可以等待[某些元素](http://casperjs.org/api.html#casper.waitForSelector)或[文本](http://casperjs.org/api.html#casper.waitForText)在 DOM 中可用，或者直接添加特定的 jQuery 侦听器以处理进一步的步骤：

```
casper.start('test.html', function() {
    this.evaluate(function() {
        $(document).on('site:loaded', function() {
            window.siteLoaded = true;
        });
    });
});

casper.waitFor(function() {
    return this.evaluate(function() {
        return window.siteLoaded === true;
    });
});

casper.then(function() {
    // process further
}); 
```

**注意：**这是事实伪代码，目的只是为了描绘概念。

# css - 除非价值很高，否则 margin-top 不会移动

> ID：13464853
> 
> 赞同：0
> 
> 时间：2012-11-20T00:31:00.127
> 
> 标签：css, html, margin

可能是对此的一个非常简单的修复，现在一直在看它，但无法弄清楚..这是我的代码：

```
 margin-top:10px;
    width:998px;
    min-height:100px;
    max-height:300px;
    border:1px solid #CCC;
    -moz-border-radius: 10px;
    border-radius: 10px;
    background-image:url(../images/default/page.png);
    overflow:hidden; 
```

当 margin-top 设置为 10px 时，div 根本不会移动。如果我将 margin-top 设置为 200px 则 div 不会移动。但是，如果我将其设置为 500px，那么它会按预期向下移动 500。

我已经尝试删除单个设置高度的最小和最大高度，但这并不能解决问题。并不是说它应该首先引起问题。

谁能看到我的错误？我确信我的编码相对健全，并且真的不知道如何研究解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:35:07.860

检查其他元素的`margin`和`float`。我没有看到您提供的代码有任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:41:27.533

在 CSS 中，相邻的垂直边距折叠，等待某些条件。

所以说你有 2 个 div 堆叠 1 在另一个之上。顶部 div 的底部边距为 30px，底部 div 的顶部边距为 20px。在这种情况下，边距“折叠”成最大值，即顶部 div 上的 30px 边距底部。

更多信息可以在[这里找到](http://reference.sitepoint.com/css/collapsingmargins)

在您的情况下，我会查看周围元素的 CSS，看看更改这些值是否会达到您想要的效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:48:11.353

我已经设法解决了这个问题，方法是将上面的 div 放在另一个容器 Div 中，并对其应用 margin-bottom:10px。

它并不完全理想，因为它需要更长的时间来编写代码并添加另一个我并不真正想要的 div，但假设它现在必须这样做，直到我有更多时间来完全阅读这个问题。

感谢大家的帮助和潜在的解决方案。

# c++ - SIGABRT C++，抛出异常

> ID：13464855
> 
> 赞同：2
> 
> 时间：2012-11-20T00:31:20.123
> 
> 标签：c++, sigabrt

对不起，如果帖子是新的，我主要是一个数学人。

我正在为我的运筹学课程之一编写一个小的 C++ 命令行工具。

我有类似的东西：

```
try {
   if( *some condition* ) {
      throw MY_ENUM;
   }
   ...
}
catch (int e) {
   if (e == MY_ENUM) {
      // output some diagnostics and exit
   }
   ...
} 
```

但是我不断收到一个 SIGABRT 而不是 MY_ENUM。我知道它是我忘记的基本内容，但无法确定。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T00:55:29.500

我发布了这个答案，所以这不再显示为未回答。@Mankarse 作为评论正确而及时地回答了这个问题，所以如果他们发布一个答案，请接受他们的答案而不是我的答案。

* * *

这里的异常没有被捕获，因为被抛出的对象是某种枚举类型，并且上面的代码捕获了`int`s。

要捕获抛出的枚举值，请`catch (MyEnumType e) { if (e == MY_ENUM) ... }`改用

# android - 自定义 FragmentTabHost 的实现

> ID：13464858
> 
> 赞同：3
> 
> 时间：2012-11-20T00:31:41.840
> 
> 标签：android, android-fragments, android-tabhost

我正在使用新的 API 17 在我的应用程序中实现嵌套片段，它`FragmentTabHost`为此提供了一个。但是，对于父片段中的简单 2 个选项卡片段，我遇到了一些基本问题：

1.  我希望嵌套选项卡位于底部（View1 和 View2 选项卡）
2.  我想自定义实际的标签，使其看起来与标准不同

![问题截图](../Images/ebd7a74f732afc29480173a019cb1f62.png)

有没有人以前使用过这些并知道如何实现这一点？这是我启动并运行的示例代码：

```
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentTabHost;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

public class FragmentTabsFragmentSupport extends Fragment {
private FragmentTabHost mTabHost;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    mTabHost = new FragmentTabHost(getActivity());
    mTabHost.setup(getActivity(), getChildFragmentManager(), R.id.fragment1);

    mTabHost.addTab(mTabHost.newTabSpec("Tab1").setIndicator("Simple"),
            NestedFragment1.class, null);
    mTabHost.addTab(mTabHost.newTabSpec("Tab2").setIndicator("Contacts"),
            NestedFragment2.class, null);

    return mTabHost;
}

@Override
public void onDestroyView() {
    super.onDestroyView();
    mTabHost = null;
}
} 
```

我尝试了以下方法来底部对齐标签，但没有运气：

```
TabWidget mTabWidget = mTabHost.getTabWidget();
mTabWidget.setGravity(Gravity.BOTTOM);
mTabWidget.setVerticalGravity(Gravity.BOTTOM); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T15:14:45.233

我终于明白了这一点。FragmentTabHost.java 存在一个问题，它总是会为您创建一个 TabHost 元素，无论您在 XML 中定义什么并预先膨胀。

因此，我在编写自己的 FragmentTabHost.java 版本时注释掉了那部分代码。

确保在您的 XML 布局中使用您的新版本，`<com.example.app.MyFragmentTabHost`

当然还有充气：

片段1.java：

```
mTabHost = (MyFragmentTabHost) view.findViewById(android.R.id.tabhost);
mTabHost.setup(getActivity(), getChildFragmentManager(), android.R.id.tabcontent); 
```

MyFragmentTabHost.java：

```
package com.example.app;

import java.util.ArrayList;

import android.content.Context;
import android.content.res.TypedArray;
import android.os.Bundle;
import android.os.Parcel;
import android.os.Parcelable;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentTransaction;
import android.util.AttributeSet;
import android.view.View;
import android.widget.FrameLayout;
import android.widget.TabHost;

/**
 * Special TabHost that allows the use of {@link Fragment} objects for
 * its tab content.  When placing this in a view hierarchy, after inflating
 * the hierarchy you must call {@link #setup(Context, FragmentManager, int)}
 * to complete the initialization of the tab host.
 *
 */
public class MyFragmentTabHost extends TabHost
    implements TabHost.OnTabChangeListener {
private final ArrayList<TabInfo> mTabs = new ArrayList<TabInfo>();
private FrameLayout mRealTabContent;
private Context mContext;
private FragmentManager mFragmentManager;
private int mContainerId;
private TabHost.OnTabChangeListener mOnTabChangeListener;
private TabInfo mLastTab;
private boolean mAttached;

static final class TabInfo {
    private final String tag;
    private final Class<?> clss;
    private final Bundle args;
    private Fragment fragment;

    TabInfo(String _tag, Class<?> _class, Bundle _args) {
        tag = _tag;
        clss = _class;
        args = _args;
    }
}

static class DummyTabFactory implements TabHost.TabContentFactory {
    private final Context mContext;

    public DummyTabFactory(Context context) {
        mContext = context;
    }

    @Override
    public View createTabContent(String tag) {
        View v = new View(mContext);
        v.setMinimumWidth(0);
        v.setMinimumHeight(0);
        return v;
    }
}

static class SavedState extends BaseSavedState {
    String curTab;

    SavedState(Parcelable superState) {
        super(superState);
    }

    private SavedState(Parcel in) {
        super(in);
        curTab = in.readString();
    }

    @Override
    public void writeToParcel(Parcel out, int flags) {
        super.writeToParcel(out, flags);
        out.writeString(curTab);
    }

    @Override
    public String toString() {
        return "FragmentTabHost.SavedState{"
                + Integer.toHexString(System.identityHashCode(this))
                + " curTab=" + curTab + "}";
    }

    public static final Parcelable.Creator<SavedState> CREATOR
            = new Parcelable.Creator<SavedState>() {
        public SavedState createFromParcel(Parcel in) {
            return new SavedState(in);
        }

        public SavedState[] newArray(int size) {
            return new SavedState[size];
        }
    };
}

public MyFragmentTabHost(Context context) {
    // Note that we call through to the version that takes an AttributeSet,
    // because the simple Context construct can result in a broken object!
    super(context, null);
    initFragmentTabHost(context, null);
}

public MyFragmentTabHost(Context context, AttributeSet attrs) {
    super(context, attrs);
    initFragmentTabHost(context, attrs);
}

private void initFragmentTabHost(Context context, AttributeSet attrs) {
    TypedArray a = context.obtainStyledAttributes(attrs,
            new int[] { android.R.attr.inflatedId }, 0, 0);
    mContainerId = a.getResourceId(0, 0);
    a.recycle();

    super.setOnTabChangedListener(this);

    /*** REMOVE THE REST OF THIS FUNCTION ***/
    /*** findViewById(android.R.id.tabs) IS NULL EVERY TIME ***/
}

/**
 * @deprecated Don't call the original TabHost setup, you must instead
 * call {@link #setup(Context, FragmentManager)} or
 * {@link #setup(Context, FragmentManager, int)}.
 */
@Override @Deprecated
public void setup() {
    throw new IllegalStateException(
            "Must call setup() that takes a Context and FragmentManager");
}

public void setup(Context context, FragmentManager manager) {
    super.setup();
    mContext = context;
    mFragmentManager = manager;
    ensureContent();
}

public void setup(Context context, FragmentManager manager, int containerId) {
    super.setup();
    mContext = context;
    mFragmentManager = manager;
    mContainerId = containerId;
    ensureContent();
    mRealTabContent.setId(containerId);

    // We must have an ID to be able to save/restore our state.  If
    // the owner hasn't set one at this point, we will set it ourself.
    if (getId() == View.NO_ID) {
        setId(android.R.id.tabhost);
    }
}

private void ensureContent() {
    if (mRealTabContent == null) {
        mRealTabContent = (FrameLayout)findViewById(mContainerId);
        if (mRealTabContent == null) {
            throw new IllegalStateException(
                    "No tab content FrameLayout found for id " + mContainerId);
        }
    }
}

@Override
public void setOnTabChangedListener(OnTabChangeListener l) {
    mOnTabChangeListener = l;
}

public void addTab(TabHost.TabSpec tabSpec, Class<?> clss, Bundle args) {
    tabSpec.setContent(new DummyTabFactory(mContext));
    String tag = tabSpec.getTag();

    TabInfo info = new TabInfo(tag, clss, args);

    if (mAttached) {
        // If we are already attached to the window, then check to make
        // sure this tab's fragment is inactive if it exists.  This shouldn't
        // normally happen.
        info.fragment = mFragmentManager.findFragmentByTag(tag);
        if (info.fragment != null && !info.fragment.isDetached()) {
            FragmentTransaction ft = mFragmentManager.beginTransaction();
            ft.detach(info.fragment);
            ft.commit();
        }
    }

    mTabs.add(info);
    addTab(tabSpec);
}

@Override
protected void onAttachedToWindow() {
    super.onAttachedToWindow();

    String currentTab = getCurrentTabTag();

    // Go through all tabs and make sure their fragments match
    // the correct state.
    FragmentTransaction ft = null;
    for (int i=0; i<mTabs.size(); i++) {
        TabInfo tab = mTabs.get(i);
        tab.fragment = mFragmentManager.findFragmentByTag(tab.tag);
        if (tab.fragment != null && !tab.fragment.isDetached()) {
            if (tab.tag.equals(currentTab)) {
                // The fragment for this tab is already there and
                // active, and it is what we really want to have
                // as the current tab.  Nothing to do.
                mLastTab = tab;
            } else {
                // This fragment was restored in the active state,
                // but is not the current tab.  Deactivate it.
                if (ft == null) {
                    ft = mFragmentManager.beginTransaction();
                }
                ft.detach(tab.fragment);
            }
        }
    }

    // We are now ready to go.  Make sure we are switched to the
    // correct tab.
    mAttached = true;
    ft = doTabChanged(currentTab, ft);
    if (ft != null) {
        ft.commit();
        mFragmentManager.executePendingTransactions();
    }
}

@Override
protected void onDetachedFromWindow() {
    super.onDetachedFromWindow();
    mAttached = false;
}

@Override
protected Parcelable onSaveInstanceState() {
    Parcelable superState = super.onSaveInstanceState();
    SavedState ss = new SavedState(superState);
    ss.curTab = getCurrentTabTag();
    return ss;
}

@Override
protected void onRestoreInstanceState(Parcelable state) {
    SavedState ss = (SavedState)state;
    super.onRestoreInstanceState(ss.getSuperState());
    setCurrentTabByTag(ss.curTab);
}

@Override
public void onTabChanged(String tabId) {
    if (mAttached) {
        FragmentTransaction ft = doTabChanged(tabId, null);
        if (ft != null) {
            ft.commit();
        }
    }
    if (mOnTabChangeListener != null) {
        mOnTabChangeListener.onTabChanged(tabId);
    }
}

private FragmentTransaction doTabChanged(String tabId, FragmentTransaction ft) {
    TabInfo newTab = null;
    for (int i=0; i<mTabs.size(); i++) {
        TabInfo tab = mTabs.get(i);
        if (tab.tag.equals(tabId)) {
            newTab = tab;
        }
    }
    if (newTab == null) {
        throw new IllegalStateException("No tab known for tag " + tabId);
    }
    if (mLastTab != newTab) {
        if (ft == null) {
            ft = mFragmentManager.beginTransaction();
        }
        if (mLastTab != null) {
            if (mLastTab.fragment != null) {
                ft.detach(mLastTab.fragment);
            }
        }
        if (newTab != null) {
            if (newTab.fragment == null) {
                newTab.fragment = Fragment.instantiate(mContext,
                        newTab.clss.getName(), newTab.args);
                ft.add(mContainerId, newTab.fragment, newTab.tag);
            } else {
                ft.attach(newTab.fragment);
            }
        }

        mLastTab = newTab;
    }
    return ft;
}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-14T04:15:24.590

在您的代码中

```
mTabHost.setup(getActivity(), getChildFragmentManager(), R.id.fragment1); 
```

我想知道R.id.fragment1的值，即xml文件。如果您向我提供完整的项目，它将对我非常有帮助。我想在导航抽屉中使用这个嵌套选项卡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:46:22.293

[在此处](https://stackoverflow.com/a/5804436/288072)查看答案以获取有关选项卡自定义的信息，并在[此答案](https://stackoverflow.com/a/2710404/288072)中查看有关将选项卡放在底部的信息。

# c - sizeof int 数组显示的不是预期的

> ID：13464859
> 
> 赞同：0
> 
> 时间：2012-11-20T00:31:40.990
> 
> 标签：c, arrays

> **可能重复：**
> [如何找到 sizeof（指向数组的指针）](https://stackoverflow.com/questions/492384/how-to-find-the-sizeofa-pointer-pointing-to-an-array)

我有以下程序计算数组中位置之间的最大差异，但是 sizeof 函数没有打印出预期的结果。当传递 10 个整数的大数组时，我用 sizeof 测量它打印出它是 8 个整数长，怎么会？

```
#include <stdlib.h>
#include <stdio.h>

int *
measure(int *arr)
{
    int *answer=malloc(sizeof(int)*10);
    answer[0]=0;
    answer[1]=0;
    int size=sizeof(arr)+1;
    printf("%d\n", size);
    int i;
    for(i=0; i<size; i++)
    {
        signed int dif=arr[i]-arr[i+1];
        if(dif<0)
            dif*=-1;
        if(dif>answer[1])
        {
            answer[1]=dif;
            answer[0]=i;
        }
    }  
    return answer;
}

int
main (void)
{
    int arr[10]={77, 3, 89, 198, 47, 62, 308, 709, 109, 932};
    int *ans=measure(arr);
    printf("the biggest dif is %d between nrs %d and %d\n", ans[1], ans[0], ans[0]+1);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T00:34:42.463

当传递给函数时，数组衰减为指针。所以当你使用`sizeof`它时，它会给你指针的大小，而不是你传递的原始数组的大小。

您可以通过另一个参数与大小或使用数组的第一个或最后一个元素来存储大小信息。

# jquery-datatables - dataTables 插件：如何最初对数据进行排序（服务器端处理）

> ID：13464863
> 
> 赞同：1
> 
> 时间：2012-11-20T00:32:12.913
> 
> 标签：jquery-datatables

我无法使其正常工作。

我需要在初始加载时让我的表按“desc”中的 0-index 列排序。我试过了：

```
$(function() {
    ordersTable = $('#orders').dataTable({
        "sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
        "sPaginationType": 'full_numbers',
        "bDestroy": true,
        "bProcessing": true,
        "bServerSide": true, 
        "sAjaxSource": "{% url get_orders %}",
        "aoColumnDefs":[
                         {"aTargets":[0], "asSorting": ["decs", "asc"]}
                                 ]
    }); 
```

它所做的是发送“sSortDir_0 :'asc'”并在此之后显示“asc”处于活动状态。

它如何使它工作？（不假装点击列重新发送ajax）谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T03:44:46.700

好的，我想我找到了：`aaSorting`并`aaSortingFixed`设置了初始排序。（参考[这里](http://datatables.net/ref#aaSorting)）

# php - 试图在 Codeigniter 中进行 AJAX 编辑 .. 失败

> ID：13464865
> 
> 赞同：0
> 
> 时间：2012-11-20T00:32:16.980
> 
> 标签：php, codeigniter

我正在进行我的第一个 CI 项目，并且我正在尝试基本上进行 AJAX“就地编辑”。

我有一个包含多个字段的用户个人资料页面。基本上用户正在查看他自己的数据，我想给他一个选项来逐个字段地编辑他的信息。我有大约20个这样的领域..

```
<div id="desc_short">
<div class="old_info"><p><?php echo $the_user->desc_short; ?></p></div>
<div class="edit_buttons">
    <button type="button" class="btn_edit">Edit Field</button>
    <button type="button" class="btn_submit">Submit Change</button>
    <button type="button" class="btn_cancel">Cancel</button>
</div> 
```

提交和取消按钮以 display:none 开头。单击“编辑”按钮会在 div 中附加一个表单，其中包含一些隐藏字段信息，并“显示”以及“提交”和“取消”按钮。所以现在用户在原始信息下有一个文本字段，还有两个新按钮。

```
$('.btn_edit').on('click', function(){
    var this_field_id = $(this).parent().parent().attr('id');
    var form_HTML = "<form action='edit_profile' method='post'><input type='text' class='new_info' name='new_info'/><input type='hidden' class='edit_field' name='edit_field' value='"+this_field_id+"'/></form>";
    $("#"+this_field_id).append(form_HTML).hide().show(500);
    $(this).siblings().fadeIn(1000);
}); 
```

所以我动态地将表单添加到适当的 div 中，并给它一个隐藏字段，其中包含正在编辑的数据字​​段的名称。我还展示了“提交”和“取消”按钮（尽管请注意提交按钮不在表单元素中）。

我将省略“取消按钮”功能，但这里是提交按钮 jquery。如您所见，我正在尝试通过“远程控制”提交表单，在距离提交按钮很远的表单上触发提交事件。然后在提交事件上，我 preventDefault 然后尝试 $.post 信息到 AJAX 控制器..

```
$('.btn_submit').on('click', function(){
    var this_field_id = $(this).parent().parent().attr('id');
    var new_info =  $("#"+this_field_id+" .new_info").val();
    alert(this_button);
    $("#"+this_field_id+" form").trigger('submit');
    $("#"+this_field_id+" form").submit(function(e){
        e.preventDefault(); 
        alert(this_field_id); // alerting correctly
        $.post('../ajax/profileEdit', { edit_field: this_field_id , new_info: new_info },
            function(data){
                if(data = 'true')
                {
                    alert(data);   // <<<< alerts "true"
                }
                else
                {
                    alert("bad");
                }
            }
        );   
    });
}); 
```

这是ajax控制器

```
public function profileEdit()
{
    $ID = $this->the_user->ID;
    $field = $this->input->post('edit_field');
    $new_info = $this->input->post('new_info');
    $this->load->model('Member_model');
    $result = $this->Member_model->edit_profile( $ID, $field, $new_info );
    echo $result;
} 
```

还有模特。。

```
public function edit_profile($ID, $field, $new_info)
{
    $statement = "UPDATE users SET $field=$new_info WHERE UID=$ID"
    $query = $this->db->query($statement);
    return $query;
} 
```

我实际上将“TRUE”返回给 Jquery 以提醒......但没有任何内容被编辑。信息没有变化。坦率地说，我很惊讶我什至得到了“真实”的回复（整个远程提交的事情......我认为“这不可能”）......但这使得很难看出出了什么问题。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:45:35.510

除了 if(data = 'true) 错误之外，我看不出另一个错误可能在哪里。当您提醒数据时，它会向您显示什么？在模型中试试这个；

```
public function edit_profile($ID, $field, $new_info)
{
  $data = array('field_table' => $field, 'new_info_table' => $new_info);
  return ($this->db->where('UID',$ID)->update('tabel_name',$data)) ? TRUE : FALSE; 
} 
```

并且在

```
public function profileEdit()
{
$ID = $this->the_user->ID;
$field = $this->input->post('edit_field');
$new_info = $this->input->post('new_info');
$this->load->model('Member_model');
if($this->Member_model->edit_profile( $ID, $field, $new_info )){
 echo 'success';
}else{
  echo 'error';
}
} 
```

然后

```
$('.btn_submit').on('click', function(){
var this_field_id = $(this).parent().parent().attr('id');
var new_info =  $("#"+this_field_id+" .new_info").val();
alert(this_button);
$("#"+this_field_id+" form").trigger('submit');
$("#"+this_field_id+" form").submit(function(e){
    e.preventDefault(); 
    alert(this_field_id); // alerting correctly
    $.post('../ajax/profileEdit', { edit_field: this_field_id , new_info: new_info },
        function(data){
            if(data == 'success')
            {
                alert(data);   // <<<< alerts "true"
            }
            else if(data == 'error')
            {
                alert('Database error');
            }
            else{
                alert('');
            }
        }
    );   
}); 
```

});

只是写在这里，所以我没有测试它。但是试一试，至少你也许能够知道错误来自哪里。如果您仍然遇到相同的错误，请在 if(data == 'sucess') 之前尝试警报数据，以查看配置文件编辑函数返回的内容。

# objective-c - 简单的 addObject 到 NSMutableArray 方法给出 lldb 错误

> ID：13464868
> 
> 赞同：0
> 
> 时间：2012-11-20T00:32:33.453
> 
> 标签：objective-c, ios, nsmutablearray

我正在向模型中的 NSMutableArray 堆栈添加对象。这是界面：

```
@interface calcModel ()
@property (nonatomic, strong) NSMutableArray *operandStack;

@end 
```

和实施：

```
@implementation calcModel
@synthesize operandStack = _operandStack;

- (NSMutableArray *)operandStack;
{
if (_operandStack == nil) _operandStack = [[NSMutableArray alloc]init];
return _operandStack;
} 
```

这个 addobject 方法工作正常：

```
- (void)pushValue:(double)number;
{
[self.operandStack addObject:[NSNumber numberWithDouble:number]];
NSLog(@"Array: %@", self.operandStack);
} 
```

但这一个使应用程序崩溃，并在日志中显示“lldb”：

```
- (void)pushOperator:(NSString *)operator;
{
[self.operandStack addObject:operator];
NSLog(@"Array: %@", self.operandStack);
} 
```

是什么导致了这个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:38:56.157

`NSString`您要添加的可能是`nil`. 做这个：

```
- (void)pushOperator:(NSString *)operator {
    if (operator) {
        [self.operandStack addObject:operator];
        NSLog(@"Array: %@", self.operandStack);
    } else {
        NSLog(@"Oh no, it's nil.");
    }
} 
```

如果是这种情况，请找出原因`nil`并解决它。或者在添加之前检查它。

第一种方法不崩溃的原因是，因为没有不能用来初始化an的double值`NSNumber`，所以永远不会`nil`。

# php - 带有标记的sql表值变成数字？

> ID：13464871
> 
> 赞同：0
> 
> 时间：2012-11-20T00:32:59.410
> 
> 标签：php, sql, substr, strpos

我有一个看起来像的数据库价格条目

```
<b>14.75€&lt;/b> 
```

我需要 php 将其返回为：1）14.75 2）14 和 75 分别（我想出的另一个函数将前十进制数转换为单词）

我认为美分可以被这样的东西分开

```
$final1 = substr($vtotal, strpos($vtotal, '.')+3); 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:41:51.260

`$final1 = explode('.', $vtotal);`

`$final1`现在是一个数组。

`$final[0] = 14`

`$final[1] = 75`

最后...

货币不是整数，它们是浮点数，因此我们将其转换为浮点数，然后替换欧元符号的出现。

`$clean = (float)preg_replace('/[^0-9\.]/ui','',$vtotal);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:45:05.657

```
$money = (float) '14.75€'; //To 14.75
list($int, $cent) = explode('.', (string)$money);

print (int)$cent; //int 75 
```

# ruby-on-rails - 用回复填充帖子 (sample_data.rake)？

> ID：13464872
> 
> 赞同：0
> 
> 时间：2012-11-20T00:33:23.180
> 
> 标签：ruby-on-rails, rake

我有三个模型`Post`：`Replies`和`User`。`Reply`sa 的嵌套资源`Post`：

**回复.rb：**

```
class Reply < ActiveRecord::Base
  attr_accessible :content
  belongs_to :user
  belongs_to :post, :counter_cache => true
  .
  .
  . 
```

**邮政。RB：**

```
class Post < ActiveRecord::Base
  include ActionView::Helpers

  attr_accessible :title, :content

  belongs_to :user

  has_many :replies, dependent: :destroy
  .
  .
  . 
```

这是我的`sample_data.rake`文件中的内容：

sample_data.rake：

```
def make_users
  admin = User.create!(name:     "Example User",
                       email:    "example@railstutorial.org",
                       password: "foobar",
                       password_confirmation: "foobar")
  admin.toggle!(:admin)
  99.times do |n|
    name  = Faker::Name.name
    email = "example-#{n+1}@railstutorial.org"
    password  = "password"
    User.create!(name:     name,
                 email:    email,
                 password: password,
                 password_confirmation: password)
  end
end

def make_posts
  users = User.all(limit: 6)
  50.times do
    title = Faker::Lorem.sentence(1)
    content = Faker::Lorem.sentence(5)
    users.each { |user| user.posts.create!(title: title,
                                           content: content) }
  end
end 
```

这就是我创建回复的方式：

```
 def create
    @post = Post.find(params[:post_id])
    @reply = @post.replies.build(params[:reply])
    @reply.user_id = current_user.id
    if @reply.save
     # do this
    else
     # do this
    end
  end 
```

如何用回复填充一定数量的帖子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:52:52.907

为什么不直接`make_reply`在. 也许你可以有一些条件来决定有多少回复，或者其他什么，但它本质上是一样的。关键是需要保存父级（帖子）才能拥有一个 id。但这几乎正是您的创建控制器方法所做的，对吧？`50.times``make_posts`

所以像

```
def make_posts
  users = User.all(limit: 6)
  50.times do
    title = Faker::Lorem.sentence(1)
    content = Faker::Lorem.sentence(5)
    users.each do |user| 
      user.posts.create!(title: title, content: content)
      # 1 post is now saved, get it, then make reply
      post = user.posts.first  # maybe you already have this as a return from create?
      make_reply(post)
    end
  end
end

def make_reply(post)
  # find a random user to be the replier
  replier = User.find method_that_returns_random_user
  content = Faker::Lorem.sentence(10)  # or whatever
  post.replies.create!(user: replier.id, content: content)
end 
```

您需要一种方法来提供有效的用户 ID 作为回复者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T05:22:29.707

rand 方法返回一个随机整数，直到传入的值，因此您可以执行以下操作：

```
def make_reply(post)
  # So we dont query the database for the size of the users table each time
  @user_count ||= User.count
  replier = User.find(rand(@user_count))
  content = Faker::Lorem.sentence(10)  # or whatever
  post.replies.create!(user: replier.id, content: content)
end 
```

# javascript - 在 Internet Explorer 中离线创建 csv 文件（客户端）

> ID：13464878
> 
> 赞同：3
> 
> 时间：2012-11-20T00:34:31.467
> 
> 标签：javascript, internet-explorer, csv

有没有办法使用纯 JavaScript（离线，本地）创建 CSV 文件并将该文件下载到本地文件系统？该方法应该适用于 IE9 或更低版本。

我尝试过 downloadify，但跨域问题阻止了我在本地使用它。我还尝试创建一个 Base64 编码的字符串并发出一个 text/csv 数据 URI，但 IE 似乎不支持该特定情况的数据 URI。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-06-18T12:23:51.810

如果您想使用正确的 utf8 在 excel 2013 中打开 csv，您应该将 utf8 bom 添加到 dinesh ygv 代码中，如下所示：

```
<a id="export" class="myButton" download="" href="#">export</a>
<script>
    function createDownloadLink(anchorSelector, str, fileName){
        if(window.navigator.msSaveOrOpenBlob) {
            var fileData = ['\ufeff'+str];
            blobObject = new Blob(fileData);
            $(anchorSelector).click(function(){
                window.navigator.msSaveOrOpenBlob(blobObject, fileName);
            });
        } else {
            var url = "data:text/plain;charset=utf-8,%EF%BB%BF" + encodeURIComponent(str);
            $(anchorSelector).attr("download", fileName);
            $(anchorSelector).attr("href", url);
        }
    }

    $(function () {
        var str = "hi,file";
        createDownloadLink("#export",str,"file.txt");
    });

</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-27T06:52:49.153

以下方法适用于 IE11+、Firefox 25+ 和 Chrome 30+：

```
<a id="export" class="myButton" download="" href="#">export</a>
<script>
    function createDownloadLink(anchorSelector, str, fileName){
        if(window.navigator.msSaveOrOpenBlob) {
            var fileData = [str];
            blobObject = new Blob(fileData);
            $(anchorSelector).click(function(){
                window.navigator.msSaveOrOpenBlob(blobObject, fileName);
            });
        } else {
            var url = "data:text/plain;charset=utf-8," + encodeURIComponent(str);
            $(anchorSelector).attr("download", fileName);
            $(anchorSelector).attr("href", url);
        }
    }

    $(function () {
        var str = "hi,file";
        createDownloadLink("#export",str,"file.txt");
    });

</script> 
```

看看这个：[JS Fiddle](http://jsfiddle.net/Kg7eA/)

Firefox 和 Chrome 支持导航的数据 URI，它允许我们通过导航到数据 URI 来创建文件，而 IE 出于安全目的不支持它。

另一方面，IE 有用于保存 blob 的 API，可用于创建和下载文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:38:46.483

出于安全原因，不，不可能在本地创建文件并将其保存到用户的文件系统。JavaScript 根本不允许这样做。该文件需要在服务器端创建，用户需要下载它。

编辑：实际上，您可以使用[HTML5](http://www.html5rocks.com/en/tutorials/file/dndfiles/)访问本地文件系统，但似乎[IE9 不支持 File API](https://stackoverflow.com/questions/4349144/will-ie9-support-the-html5-file-api)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-23T20:17:08.343

您可以将`data`链接用于非 IE 浏览器，然后回退到用于 Internet Explorer的`IFrame`with 。`document.execCommand`

我在这里有更多详细信息： [https ://stackoverflow.com/a/26003382/378151](https://stackoverflow.com/a/26003382/378151)

我已经在 IE9-IE11 上测试过了。我不知道下面的兼容性是什么，而且似乎[没有其他人真正知道](http://www.quirksmode.org/dom/execCommand.html)。如果我猜的话，我敢打赌 IE 8 支持这一点，而 IE 6 和 7 就是它变得脆弱的地方。

# arrays - 向右旋转二维数组

> ID：13464888
> 
> 赞同：2
> 
> 时间：2012-11-20T00:35:31.050
> 
> 标签：arrays, c#-4.0

我有以下代码似乎将矩阵向左旋转 90 度......但我所追求的是向右而不是向左旋转：D 尝试修改它但继续搞砸......

```
 public static int[,] RotateMatrix(int[,] matrix, int n)
    {
        int[,] ret = new int[n, n];

        for (int i = 0; i < n; ++i)
        {
            for (int j = 0; j < n; ++j)
            {
                ret[i, j] = matrix[n - j - 1, i];
            }
        }

        return ret;
    } 
```

如何正确旋转它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T00:51:07.407

好吧，显示的片段实际上是顺时针旋转的（即向右）......但如果你想朝另一个方向走，只需交换坐标：

```
ret[i, j] = matrix[j, n - i - 1]; 
```

如果您想一想，这实际上很容易。假设您有这个 4x4 矩阵：

```
===========================>
| 0,0 | 0,1 | 0,2 | 0,3 | J
| 1,0 | 1,1 | 1,2 | 1,3 |
| 2,0 | 2,1 | 2,2 | 2,3 |
| 3,0 | 3,1 | 3,2 | 3,3 |
=========================
| I
V 
```

现在，不是旋转矩阵，而是围绕它旋转轴：

```
<===========================
 I | 0,0 | 0,1 | 0,2 | 0,3 |
   | 1,0 | 1,1 | 1,2 | 1,3 |
   | 2,0 | 2,1 | 2,2 | 2,3 |
   | 3,0 | 3,1 | 3,2 | 3,3 |
   =========================
                         J |
                           V 
```

走着瞧吧？垂直的保持不变，它只是改变了它的名字（从 I 到 J）。而横的不仅改名了，还去了另一边：这正是`n - j - 1`公式所表达的。)

完全相同的思维技巧将帮助您了解逆时针旋转矩阵的公式。)

# css - 如何在不移除 Bootstrap Twitter 中的滑动效果的情况下修改模态高度？

> ID：13464889
> 
> 赞同：1
> 
> 时间：2012-11-20T00:35:55.480
> 
> 标签：css, twitter-bootstrap

我已经修改了模态的向下距离，但现在添加`fade`类的向下滑动效果不再起作用。有没有办法通过改变顶部距离来获得滑动效果？

html:

```
<div id='test-modal' class='modal fade hide'>
  <div>Stuff</div>
</div> 
```

CSS：

```
#test-modal.modal {
  top:35%;
} 
```

jsfiddle：http: [//jsfiddle.net/Kcnq4/](http://jsfiddle.net/Kcnq4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T06:05:24.533

如果您`.fade.in`与您的班级一起添加，那么淡入效果将保留在那里。

```
#test-modal.modal.fade.in {
    top:35%;
}​ 
```

[你可以在这里](http://jsfiddle.net/mbilal/Kcnq4/3/)测试它。

# c - 在循环中提示 4 个选项，选项 1 获取数组的输入

> ID：13464892
> 
> 赞同：0
> 
> 时间：2012-11-20T00:36:01.227
> 
> 标签：c, arrays, input

这个问题太长太复杂，无法放在标题中，所以我会在这里尝试描述它：

循环提示输入 4 个选项 (1,2,3,q)，如果输入 1，则在 accounts[MAX] 数组中输入帐户 #。如果帐户的总索引 # 大于 10，则它不再接受输入，但如果帐户 [5] 和帐户 [11] 具有相同的帐户 #（均为 1400），则它继续接受它。如何检查两个帐户是否相同以及是否允许输入输入？

到目前为止我的代码：

```
do
{
    printf ("Options Available: \n");
    printf ("\n 1 - Enter a transaction");
    printf ("\n 2 - View the general journal");
    printf ("\n 3 - View the balance sheet");
    printf ("\n q - Quit the program\n");

    printf ("\nPlease enter 1, 2, 3 or q: ");

    option = validateoption();

    if (option == '1' && totalinput >= MAXtrans)
        printf (" **Maximum number of transactions have been entered\n\n");

    if (option == '1')
    {
        printf ("\nEnter an account number (between 1000 and 3999): ");
        accounts[i] = validateaccount();
        printf ("\n");

        printf ("Enter d (debit) or c (credit): ");
        debcred[i] = validatedebcred();
        printf ("\n");

        printf ("Enter transaction amount: ");
        amount[i] = validateamount();
        printf ("\n");

        printf ("\n");

        i++;
        totalinput++;

    }

    if (option == '2')
        journal(accounts, debcred, amount, &totalinput);

    if (option == '3')
        balancesheet(accounts, debcred, amount, &totalinput);

} while (option != 'q'); 
```

因此，在 accounts[i] 中，如果输入了 10 个帐户，则它不再接受更多帐户，但如果我输入 account # 1400 和 account[3] 或者我们也有 account # of 1400，那么它会接受该输入，因为它们是相同的帐户和帐户总数仍然相同。

我的验证帐户功能：

```
long validateaccount() {  // VALIDATE INPUT FOR ACCOUNT # IN TRANSACTION FUNCTION

    int keeptrying = 1, rc;
    long i;
    char after;

    do
    {
        rc = scanf ("%ld%c", &i, &after);

        if (rc == 0)
        {
            printf (" **Invalid input try again: ");
            clear();
        }
        else if (after != '\n')
        {
            printf (" **Trailing characters try again: ");
            clear();
        }
        else if (i < 1000 || i > 3999)
        {
            printf (" **Invalid input try again: ");
        }
        else
        {
                keeptrying = 0;
        }

    } while (keeptrying == 1);

    return i;

} 
```

编辑：这是它应该显示的示例输出，希望那更清楚？

可用选项：

1 - 输入交易 2 - 查看一般日记帐 3 - 查看资产负债表 q - 退出程序

请输入 1、2、3 或 q：1

输入帐号（介于 1000 和 3999 之间）：3999

输入 d（借方）或 c（贷方）：d

输入交易金额：10000

可用选项：

1 - 输入交易 2 - 查看一般日记帐 3 - 查看资产负债表 q - 退出程序

请输入 1、2、3 或 q：1

输入帐号（介于 1000 和 3999 之间）：3998 **已输入最大帐号数

可用选项：

1 - 输入交易 2 - 查看一般日记帐 3 - 查看资产负债表 q - 退出程序

请输入 1、2、3 或 q：1

输入帐号（介于 1000 和 3999 之间）：3999

输入 d（借方）或 c（贷方）：c

输入交易金额：1000

* * *

所以发生的情况是先输入 3999 帐户 #，然后在输入 3999 之后输入 3998，但在输入 3999 之后，已填满最大帐户数（10 个帐户或帐户 [10]），但在输入 3998 之后，帐户 # 3999 是再次输入并且程序接受了该输入。如果仍然不清楚，我会尝试解释更多！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T02:58:08.077

if`i`表示输入的账户数（注意我不知道你是否正确管理了错误的状态），`j`表示元素的位置，认为`long int`变量存储在数组`account`中，我会假设你要添加一个状态更新。

> 因此，在 accounts[i] 中，如果输入了 10 个帐户，则它不再接受更多帐户，但如果我输入 account # 1400 和 account[3] 或者我们也有 account # of 1400，那么它会接受该输入，因为它们是相同的帐户和帐户总数仍然相同。

```
if ( option == '1' )
{
    long int j;

    /* k represents position */
    int k;

    printf ("\nEnter an account number (between 1000 and 3999): ");

    /* If is the last try and the account is inside the array let's update it. */
    /* Pass by reference k. */
    if( ( i == 10 ) && ( isAccount( validateaccount(), &k ) == 1 ) ){ 
        accounts[ k ] = validateaccount();
        printf ("\n");

        printf ("Enter d (debit) or c (credit): ");
        debcred[ k ] = validatedebcred();
        printf ("\n");

        printf ("Enter transaction amount: ");
        amount[ k ] = validateamount();
        printf ("\n");
        printf ("\n");

        i++;
    }

    /* Pass by reference k. */
    else if( ( i == 10 ) && ( isAccount( validateaccount(), &k ) == 0 ) ){

        printf (" Your input isn't allowed cause the account is not in the list. \n");

    }

    else{
        accounts[ i ] = validateaccount();
        printf ("\n");

        printf ("Enter d (debit) or c (credit): ");
        debcred[ i ] = validatedebcred();
        printf ("\n");

        printf ("Enter transaction amount: ");
        amount[ i ] = validateamount();
        printf ("\n");
        printf ("\n");

        i++;
    }
}

/* I will think your array is a global variable, let's use a pass by reference function. */
int isAccount( long int a, int * k )
{
    int result = 0;
    int counter, j;

    for( counter = 0; counter < 11; counter++ ){
        if( accounts[ counter ] == a ){
            * k = counter;
            return 1;
        } 
    }
    return 0;
} 
```

PD：你可以使用`structs`它会容易 10 倍。

# django - 用于 PostgreSQL 中全文搜索的 Django 模型架构

> ID：13464895
> 
> 赞同：4
> 
> 时间：2012-11-20T00:36:44.663
> 
> 标签：django, postgresql, database-design, full-text-search

我正在建立一个基于线程的特定主题的社交互动网站，想想gmail，只有公共的。词汇表中也会有一些静态信息，还有博客、how-tos、知识库等。就是django+postgres。

最重要的要求之一是对所有信息进行全文搜索，无论模型的类型如何。如果确切的搜索短语出现在博客中，并且其扭曲的姐妹出现在消息中，那么博客条目的片段应该首先出现在搜索结果中，然后是消息的片段。所以，我需要一个包含所有文本索引的表，以及 db 中 _any_other_table_ 的链接。

我的第一个想法是创建一个带有“松散参考”的单独模型，例如：

```
class Content(models.Model):
    obj_id= CharField() # An id of the object of a given model.
    model= CharField(choices=("Message", "BlogEntry", "HowTo", "EntityProfile",))
    content_type= CharField(choices=("subject", "body", "description", "tags",))
    body= TextField() 
```

但这感觉有点不对劲……这会在创建和重新链接实例时为引用的完整性带来不必要的麻烦。

所以，问题是 - django 会提供任何优雅的解决方案吗？解决问题的最有效架构可能是什么？

我不是要直接回答，而是要一个提示。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T08:01:14.423

我在使用 PostgreSQL 的 tsearch2 的[这个片段上取得了很大的成功。](http://djangosnippets.org/snippets/1328/)我已经以各种不同的方式针对各种不同的目的对其进行了调整，但基本上它工作得很好，并且很容易实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T12:38:10.537

非常感谢您的提示！

虽然 contenttypes 是此类任务的理想选择，但独立于 DB 确实很诱人

从我目前所读到的，Solr 是一个可靠的搜索引擎，但我想，我会去尝试通过 Haystack 的 ElasticSearch

再次感谢！

# java - 如何根据对象值对不同类的对象进行排序

> ID：13464897
> 
> 赞同：1
> 
> 时间：2012-11-20T00:37:15.867
> 
> 标签：java, arrays, sorting, comparable

我设置了多个对象，都实现了同一个类。所有这些对象都有一个共同的方法，“getRatio”。我想根据“getRatio”方法的值按数字升序对这些对象进行排序，并且让对象按顺序调用它们的 toString 方法。我试图应用这个想法，但我只是订购数字本身。

```
 List shapeList = new ArrayList();
    shapeList.add(rectangle);
    shapeList.add(triangle_right);
    shapeList.add(isosceles);
    shapeList.add(triangle);
    shapeList.add(triangle2);
    shapeList.add(triangle3);
    Collections.sort(shapeList);
    for (Shape shape : shapeList) {
        System.out.println(shape.toString());
    } 
```

没有找到适合 add(RightTriangle) shapeList.add(triangle_right) 的方法；

错误：找不到符号 Comparable.sort(shapeList);

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:40:07.717

您可以为 Arrays.sort() 方法提供一个[比较](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Arrays.html#sort%28T%5b%5d,%20java.util.Comparator%29)器[。](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Comparator.html)在您的情况下，它看起来像这样（我假设该方法在一个公共类/接口中）：`getRatio``Shape`

```
public class ShapeComparator implements Comparator<Shape> { 
    int compareTo (final Shape shape1, final Shape shape2) {
        return (int) Math.signum (shape1.getRatio () - shape2.getRatio ());
    }
} 
```

您还可以使您的公共类实现[Comparable](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Comparable.html)接口，如下所示：

```
public class Shape implements Comparable<Shape> {
    int compareTo (final Shape other) {
        return (int) Math.signum (getRatio () - other.getRatio ());
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T00:44:04.097

扩展其他答案，您可以`Comparator`按如下方式定义和排序数组：

```
Arrays.sort(myArray, new Comparator<MyClass>() {
    @Override
    public int compare(MyClass c1, MyClass c2) {
        return (new Double(c1.getRatio())).compareTo(c2.getRatio());
    }
}); 
```

如果您计划像这样对多个数组进行排序，那么`MyClass`实现`Comparable`接口是明智的。

* * *

***编辑***`List`：要对s（例如进行排序`ArrayList`您可以使用类似的概念，但使用`Collections.sort`：

```
Collections.sort(shapeList, new Comparator<MyClass>() {
    @Override
    public int compare(MyClass c1, MyClass c2) {
        return (new Double(c1.getRatio())).compareTo(c2.getRatio());
    }
}); 
```

* * *

相关文件：

*   [`Comparator`](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)
*   [`Comparable`](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html)
*   [`Arrays.sort`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort%28T%5B%5D,%20java.util.Comparator%29)
*   [`Collections.sort`](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:40:50.483

你应该让你的 Object 实现*Comparable*。

[更多信息在这里](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html)

您需要实现*compareTo()*以便比较两个对象的比率。

您可以这样做：

```
class Foo implements Comparable<Foo> {

    private double ratio;

    public double getRatio() {
        return ratio;
    }

    public int compareTo(Foo otherFoo) {
        if (otherFoo == null) {
            return -1;
        }
        return ratio - otherFoo.ratio;
    }

} 
```

* * *

以下是对 Foo 对象的集合进行排序的方法：

```
List<Foo> fooList = createFooList();
Collections.sort(fooList);

// print the Foos in order

for (Foo f : fooList) {
    System.out.println(f.toString());
} 
```

# wpf - Touch和Stylus WPF有什么区别

> ID：13464898
> 
> 赞同：2
> 
> 时间：2012-11-20T00:37:19.663
> 
> 标签：wpf, touch

我想在我的 wpf api 中添加触摸功能。我对如何使用感到困惑。有手势，触摸和手写笔。

我找不到 Stylus 和 Touch 的不同之处。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-11-14T09:31:10.540

触碰：

> *“提供应用程序级服务，处理来自操作系统的多点触控输入并引发 FrameReported 事件。”*

手写笔：

> *“提供对有关平板笔的一般信息的访问。”*

但是，如果您开发一个支持触摸屏的应用程序，您将意识到它们的事件并没有完全隔离和分离，因为冒泡事件（见附图）。

![在此处输入图像描述](../Images/bf33d63660b4af24827baae07d2bdd0b.png)

[您可以在此处](http://msdn.microsoft.com/en-us/library/ms754010%28v=vs.110%29.aspx)和[此处](http://nui.joshland.org/2010/04/why-wont-wpf-controls-work-with-touch.html)阅读有关操作的信息。

# mysql - MySQL为每个有效用户循环一行

> ID：13464899
> 
> 赞同：1
> 
> 时间：2012-11-20T00:37:28.277
> 
> 标签：mysql, group-by, sql-order-by, cycle

这是背景，我有一个`object`包含以下内容的表格：

*   ID
*   用户（来自用户表的 ID）
*   日期（日期）
*   状态 (0|1)

另一个表`user`包含：

*   ID
*   状态 (0|1)

前任。：

```
Object
    ID  |  USER  |  DATE  |  STATE
    1      1      2012-10-01 1
    2      2      2012-08-01 1
    3      3      2012-10-01 1
    4      3      2012-10-02 1
    5      3      2012-09-01 1
    6      3      2012-10-01 1
    7      1      2012-10-02 1
    8      2      2012-10-02 0
    9      2      2012-10-02 1
    10     1      2012-10-01 1
    11     2      2012-10-01 1
    12     3      2012-10-01 0
    13     4      2012-11-11 1

Users
    ID  |  STATE
    1   |  1
    2   |  1
    3   |  1
    4   |  0 
```

我会请求**循环显示每个有效状态用户的一个对象**，如果对象状态处于活动状态，则按日期 DESC 排序。
前任。结果 ：

```
ID  |  USER  |  DATE  |  STATE
10     1      2012-11-01 1
9      2      2012-10-02 1
4      3      2012-10-02 1
7      1      2012-10-02 1
11     2      2012-10-01 1
3      3      2012-10-01 1
1      1      2012-10-01 1
2      2      2012-08-01 1
6      3      2012-10-01 1
5      3      2012-09-01 1 
```

我可以做简单的查询，但我承认不知道该怎么做。

**编辑 2012-11-22：** 让我们尝试另一种方法......通过这个查询（感谢 Michiel van Vaardegem），我有一个用户列表，以便我想要......顶部有新鲜度对象的用户。

```
SELECT o.user
FROM object o
INNER JOIN users ON user.id = o.user
WHERE o.state=1 AND users.state=1
GROUP BY o.user
ORDER BY o.date DESC 
```

结果是：

```
USER
1
2
3 
```

新问题方法：有了这个 id 列表、可能计算的行数和用户定义的变量，你认为可以做些什么吗？
例子：

1.  假设这个列表，**SELECT * FROM object WHERE user IN ($thislist) AND state=1 ORDER BY date DESC**

2.  对于每个对象行，取决于用户（这里我不知道如何在 mysql 中解释） **用 userposition(in cycle) + usercount 增加一个 rank var**

3.  **ORDER BY rank LIMIT n,x**结果

我想在用户周期中对我的对象进行排名，例如：

```
object from user 1,2,3,1,2,3,1,3,3,1,1,1,1,1,1,1,1,etc... if exist 
```

这种新的方法算法是否可以在 mysql 查询中实现，如果可能的话，如何......这是个好问题？

任何人都只能在 MySQL 中看到解决方案吗？
提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:13:04.967

就像是：

```
SELECT o.id, o.user, o.date, 1 AS state
FROM object o
INNER JOIN user ON u.id = o.user
WHERE o.state = 1 AND u.state = 1
GROUP BY o.user, o.date
ORDER BY o.user, o.date DESC 
```

我不确定，但如果我没看错，你只需要两个表中的状态都是“1”的记录，对吗？你想先按用户排序，然后按日期排序？

# sqlite - 无法使 ServiceStack.OrmLite.Sqlite64 示例正常工作

> ID：13464900
> 
> 赞同：3
> 
> 时间：2012-11-20T00:37:31.660
> 
> 标签：sqlite, servicestack, ormlite-servicestack

我在 .NET 4.5 下运行 VS 2012 Desktop Express。通过 NuGet，我获得了 ServiceStack 和 ServiceStack.OrmLite.Sqlite64。然后，我使用位于[http://code.google.com/p/servicestack/wiki/OrmLite](http://code.google.com/p/servicestack/wiki/OrmLite)的非常简单的示例来编写以下内容。

```
class Program {
    static void Main(string[] args) {
        OrmLiteConfig.DialectProvider = new SqliteOrmLiteDialectProvider();
        using (IDbConnection db = @"C:\test.s3db".OpenDbConnection()) {
            db.CreateTable<Example>(true);
            db.Insert(new Example { Id = 1, Text = "An example" });

            var items = db.Select<Example>();

            items.ForEach(x => Console.WriteLine(x.Id + "\t" + x.Text));
        }
    }
}

public class Example {
    public int Id { get; set; }
    public string Text { get; set; }
} 
```

上面的代码可以编译，但是我得到一个运行时异常，这似乎表明我使用的 System.Data.Sqlite 版本与编译 ServiceStack.OrmLite.SqliteNET 的版本不同。NuGet 提供给我的版本是 1.0.81.0，而运行时异常似乎正在寻找版本 1.0.65.0。

我是使用 NuGet 的新手，所以我可能做错了什么，但是我无法确定我做错了什么。协助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:12:21.093

我注意到今天更新了 NuGet 包 ServiceStack.OrmLite.Sqlite64。安装最新软件包后，示例按预期工作。导致我的问题的包提供的 System.Data.Sqlite 似乎是不正确的版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T16:25:55.317

我在使用 ServiceStack 和 SQLite 时也有过同样的经历，当 SQLite 版本被列为 ServiceStack.OrmLite.Sqlite* 的依赖项（通过 packages.config）在 NuGet 上不再可用时（因为 SQLite 人员似乎删除了添加新版本时的旧版本）。我已经向 ServiceStack 提交了过去的拉取请求以保持更新，但也能够通过程序集绑定重定向在本地解决它：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Data.SQLite"
                      publicKeyToken="db937bc2d44ff139"
                      culture="neutral" />
        <bindingRedirect oldVersion="1.0.82.0" newVersion="1.0.84.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration> 
```

以上，在 App.config 文件中，让我的单元测试程序集将 ServiceStack 对 SQLite 1.0.82（它所期望的）的运行时绑定请求重定向到 1.0.84（这是 NuGet 上可用的版本），因此它运行时没有即使 1.0.84 是我系统上唯一可用的版本，也会出错。

# r - 如何在 Mac 上安装多个版本的 R 而不会覆盖旧版本？

> ID：13464907
> 
> 赞同：6
> 
> 时间：2012-11-20T00:38:09.523
> 
> 标签：r, macos, installation

如何在 Mac 上安装多个版本的 R 而不会覆盖旧版本？安装它们的合适位置在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T00:56:02.023

最合适的位置是`R.framework`目录中。我在这台机器上有可以追溯到 R 2.7 的版本。从二进制安装包安装新版本不会覆盖早期版本。这是将符号链接“当前版本”文件夹拖放到当前控制台窗口中时给出的内容：

```
/Library/Frameworks/R.framework/Versions/Current 
```

它实际上是对以下内容的引用：

```
/Library/Frameworks/R.framework/Versions/2.15 
```

（如果您在安装过程中对所有对话框单击“确定”，CRAN 的二进制安装程序将默认放置连续版本。）

# ruby-on-rails - 无法在 CoffeScript 文件中呈现部分轨道

> ID：13464914
> 
> 赞同：3
> 
> 时间：2012-11-20T00:38:56.683
> 
> 标签：ruby-on-rails, coffeescript

我在位于资产管道的 CoffeScript 文件上尝试了类似的操作。

```
<%= escape_javascript(render partial: "shared/mypartial")%> 
```

但我收到以下错误

```
throw Error("NoMethodError: undefined method `render' for #<#    <Class:0x007fb68f801a40>:0x007fb68d3c3fe8>\n  (in /Users/user/Sites/app/app/assets/javascripts/application/app.js.coffee.erb)") 
```

知道为什么没有得到渲染方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T04:12:13.077

Coffeescript 文件不会在请求的上下文中处理，因此您将无法访问 render 方法。

# javascript - 如何将多个标签/字符串添加到 rel="value"

> ID：13464917
> 
> 赞同：0
> 
> 时间：2012-11-20T00:39:17.843
> 
> 标签：javascript, jquery, html, fancybox

我正在使用fancybox 画廊模板。当您单击标题中的导航元素时，与 rel="value" 匹配的缩略图会亮起。如何为多个标签点亮相同的缩略图？基本上，类似： rel="value1 value2" 我在下面列出的代码不起作用。每当按下任何导航按钮时，任何具有多个 rel="" 值的元素都会亮起。我应该怎么办？我很感激任何帮助。

HTML：

```
<!-- .nav -->
  <ul class="nav">
    <li><a href="#" class="produce">Producing</a></li>
    <li><a href="#" class="design">Design</a></li>
    <li><a href="#" class="puppet">Puppetry</a></li>
    <li><a href="#" class="multimedia">Multimedia</a></li>
  </ul>
  <!-- /.nav -->
</div>
<!-- content -->
<div id="content">
    <!-- .thumbs -->
    <ul class="thumbs">
    <li class="first"><a href="images/images/h-slide4.jpg" rel="empty"><img src="images/images/h-thumb4.jpg" alt="description" /></a></li>
    <li></li>
    <li><a href="images/images/standin-slide1.jpg" rel="produce"><img src="images/images/sus-thumb7.jpg" alt="description" /></a></li>
    <li><a href="images/images/sus-slide1.jpg" rel="produce puppet"><img src="images/images/sus-thumb1.jpg" alt="description" /></a></li>
    <li><a href="images/images/sus-slide2.jpg" rel="puppet design"><img src="images/images/sus-thumb2.jpg" alt="description" /></a></li>
    <li><a href="images/images/sus-slide4.jpg" rel="multimedia"><img src="images/images/sus-thumb4.jpg" alt="description" /></a></li>
    <li><a href="images/images/sus-slide6.jpg" rel="produce multimedia puppet"><img src="images/images/sus-thumb6.jpg" alt="description" /></a></li>
    <li></li> 
```

***对于第一个列表元素，其中 rel="empty" 我不希望该缩略图永远亮起。我尝试离开 rel=""，但随后任何点击都会亮起缩略图。其他列表元素显示了我尝试多个标签的示例。

画廊.js：

```
$(".nav li a.produce").click(function(){

$("ul.thumbs").find("span").hide();
$(".nav li a").removeClass("current");
$("ul.thumbs a").css("opacity", "1");
$(this).addClass("current");
$("ul.thumbs a[rel=design], ul.thumbs a[rel=puppet], ul.thumbs a[rel=multimedia]").animate({opacity: ".2"}, "slow").parent().append("<span></span>");
        return false;
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:46:45.880

我不明白你为什么要使用`rel`这个。使用该`class`属性似乎会更好。你有理由需要使用`rel`吗？我不确定您使用它的方式是否有效。

如果您改用类，则可以按照您提到的相同方式添加倍数（`class = "puppet design"`可行）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T03:50:08.523

@Chrissi 是对的（+1）。您应该改用*类*，这样您就可以将匹配项中的哪些*类*与所选项目的类进行比较。`content``class``nav`

你基本上需要两个功能：

第一个 ：

*   捕获对`nav`项目的点击
*   验证哪些*类*从`content`
*   将`rel`属性设置为这些项目，以便它们属于该`nav`项目选择的同一个画廊

... 所以 ：

```
$('.nav a').on("click", function() {
    var className = $(this).attr("class"); // get class name of nav item
    var thisClass = "." + className; // builds a class selector from class name
    // get content items that matches the selector class and set the same rel attribute
    $(".thumbs a").filter(thisClass).attr({
        "rel": className,
        "title": className // optional
    }).first().trigger("click"); // fires gallery from first item
}); // on 
```

第二个 ：

*   将所有选择器从内容绑定到花式框
*   过滤，`class="empty"`所以它不会在 fancybox 中打开（什么都不做）
*   关闭后删除属性`rel`（由第一个函数设置）

... 所以 ：

```
$(".thumbs a").fancybox({
    beforeLoad: function() {
        if ($(this.element).hasClass("empty")) {
            return false; // ignores item with class="empty"
        }
    },
    afterClose: function() {
        $(this.element).removeAttr("rel title"); // remove rel after close
    }
});​ 
```

由于最后一个函数将所有内容的项目绑定到fancybox，如果单独单击它们，它们将在任何画廊之外的fancybox中打开，除了`class="empty"`

见**[JSFIDDLE](http://jsfiddle.net/N38xj/)**

**注意事项**：

*   `.on()`需要 jQuery v1.7+
*   本演示使用 fancybox v2.1.3+

# twitter-bootstrap - 引导选项卡不隐藏非活动 div

> ID：13464918
> 
> 赞同：3
> 
> 时间：2012-11-20T00:39:34.527
> 
> 标签：twitter-bootstrap, tabs

我不知道如何将 *(MSV, HOF, TOES) 下面的三个 div 中的每一个分隔到它们各自受尊重的选项卡中。选项卡工作，并正确显示。我只是无法显示标签痛苦。

这是代码：

```
<p><i class="icon-heart"></i>&nbsp;Progression</p>

<ul class="nav nav-tabs" id="myTab" data-tabs="tabs">
  <li class="active"><a data-toggle="tab" href="#MSV">MSV</a></li>
  <li><a data-toggle="tab" href="#TOES">ToES</a></li>
  <li><a data-toggle="tab" href="#HoF">HoF</a></li>
</ul>

<div class="tab-content">
<ul class="nav nav-list">

<div class="tab-pain active" id="MSV">
    <li>Mogu'shan Vaults</li>
        <a rel="tooltip" title="Normal">
        <li>
        <div class="progress progress-striped active">
        <div class="bar" style="width: 100%;">6/6</div>
        </div>
        </li>
        </a>

        <a rel="tooltip" title="Heroic">
        <li>
        <div class="progress">
        <div class="bar bar-active" style="width: 3%;"></div>
        <div class="bar bar-danger" style="width: 97%;">0/6</div>
        </div>
        </li>
        </a>
</div>

<div class="tab-pain" id="HOF">
    <li>Heart of Fear</li>
        <a rel="tooltip" title="Normal">
        <li>
        <div class="progress progress-striped active">
        <div class="bar" style="width: 20%;">1/6</div>
        </div>
        </li>
        </a>
</div>      

<div class="tab-pain" id="TOES">        
    <li>Terrace of Endless Spring</li>
        <a rel="tooltip" title="Heroic"><li>
        <div class="progress">
        <div class="bar bar-active" style="width: 3%;"></div>
        <div class="bar bar-danger" style="width: 97%;">0/6</div>
        </div>
        </li>
        </a>
</div>
</div>
</ul>

<script>
$('#myTab a').click(function (e) {
  e.preventDefault();
  $(this).tab('show');
})
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T00:52:10.177

请尝试以下代码。您需要做的就是删除`<Ul>`内部`<div class="tab-content">`并使用`<div class="tab-pane">`而不是`<div class="tab-pain">`. 还将href从href="#HoF"更改为href="#HOF"。

```
<p>
    <i class="icon-heart"></i>&nbsp;Progression</p>
<ul class="nav nav-tabs" id="myTab" data-tabs="tabs">
    <li class="active"><a data-toggle="tab" href="#MSV">MSV</a></li>
    <li><a data-toggle="tab" href="#TOES">ToES</a></li>
    <li><a data-toggle="tab" href="#HOF">HoF</a></li>
</ul>
<div class="tab-content">
    <div class="tab-pane active" id="MSV">
        <li>Mogu'shan Vaults</li>
        <a rel="tooltip" title="Normal">
            <li>
                <div class="progress progress-striped active">
                    <div class="bar" style="width: 100%;">
                        6/6</div>
                </div>
            </li>
        </a><a rel="tooltip" title="Heroic">
            <li>
                <div class="progress">
                    <div class="bar bar-active" style="width: 3%;">
                    </div>
                    <div class="bar bar-danger" style="width: 97%;">
                        0/6</div>
                </div>
            </li>
        </a>
    </div>
    <div class="tab-pane" id="HOF">
        <li>Heart of Fear</li>
        <a rel="tooltip" title="Normal">
            <li>
                <div class="progress progress-striped active">
                    <div class="bar" style="width: 20%;">
                        1/6</div>
                </div>
            </li>
        </a>
    </div>
    <div class="tab-pane" id="TOES">
        <li>Terrace of Endless Spring</li>
        <a rel="tooltip" title="Heroic">
            <li>
                <div class="progress">
                    <div class="bar bar-active" style="width: 3%;">
                    </div>
                    <div class="bar bar-danger" style="width: 97%;">
                        0/6</div>
                </div>
            </li>
        </a>
    </div>
</div>
<script>
    $('#myTab a').click(function (e) {
        e.preventDefault();
        $(this).tab('show');
    })
</script> 
```

# jquery - 如何使用 jQuery 定位除 1 个元素之外的所有内容？

> ID：13464919
> 
> 赞同：0
> 
> 时间：2012-11-20T00:39:36.087
> 
> 标签：jquery

我有一个href，它在屏幕中间打开一张照片（把它想象成fancybox/lightbox/lytebox），当用户点击网站上的任何地方时，我想关闭它，除了带有照片的div。

如何使用 jQuery 来定位它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:42:00.013

使用 jQuery`.not()`方法。

```
$(".elements").not(".this-element").on("click", function() {
  $(".this-element").hide();
});​ 
```

[http://jsfiddle.net/6McAF/](http://jsfiddle.net/6McAF/)

**更新**

正如[@nnnnnn](https://stackoverflow.com/users/615754/nnnnnn)所指出的，这样做时会遇到一些复杂的传播问题。更好的方法是使用覆盖 div（z-index 小于您要隐藏的元素，如[@j08691 所述](https://stackoverflow.com/users/616443/j08691)），并绑定到它。

或者添加另一个处理程序（我不推荐）：

```
$(".this-element").on("click", function(e) {
  e.stopPropagation(); // ugly boilerplate to fix thoughtless bindings
); 
```

# javascript - 跨域 XHR 失败

> ID：13464921
> 
> 赞同：6
> 
> 时间：2012-11-20T00:39:45.487
> 
> 标签：javascript, backbone.js, xmlhttprequest, cors

我有一个托管在一个域上的 API，该域启用了具有以下标头的 CORS：

```
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: POST, GET, OPTIONS
Access-Control-Max-Age: 1728000 
```

我可以从 hackst.com 发出 GET 或 POST 请求，并且工作正常。链接：[http ://hackst.com/#w3SbV](http://hackst.com/#w3SbV)

从我托管在另一个域上的主干应用程序中，GET 请求工作正常。但是当我尝试创建和保存新模型（即发出 POST 请求）时，它会失败并出现以下错误：

```
Failed to load resource: the server responded with a status of 501 (Not Implemented) http://projectwhatup.us:5000/api/posts
XMLHttpRequest cannot load http://projectwhatup.us:5000/api/posts. Origin http://ayush.projectwhatup.us is not allowed by Access-Control-Allow-Origin. 
```

我的相关主干代码：

```
var newPostData = {
    topic : "New Post",
    body : "new body",          
    user_id : 1,
};  

var newPostModel = new Post(newPostData);
this.model.create(newPostModel); 
```

我什至尝试过覆盖该`create`方法并像这样手动发出 POST 请求：

```
create : function(data) {
    console.log('overriden create');

    $.ajax({
        "url" : this.url,
        "async" : true,
        "beforeSend" : function(obj){
            console.log(obj);
        },
        "contentType" : 'application/json',
        //"crossDomain" : true,  // uncommenting this doesnt help either
        "headers" : {

        },
        "dataType" : 'json',
        "type" : 'POST',
        "data" : JSON.stringify(data),
        "error" : function(err){
            console.log('new post creation failed');
            console.log(err);
        },
        "success" : function(resp){
            console.log('new post created');
            console.log(resp);
        }
    });
} 
```

同样的错误。

我也在 JSFiddle (http://jsfiddle.net/X9cqh/5/) 上尝试了一个独立的 GET 请求，但是即使我的主干应用程序可以使 GET 请求正常，它也会失败。

在这一点上我完全一无所知。任何提示，指针，解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T02:30:59.787

服务器还应使用以下标头回复预检：

```
Access-Control-Allow-Headers: Content-Type 
```

这是必要的，因为内容类型是 application/json，它超出了 CORS 规范 (http://www.w3.org/TR/cors/) 中定义的可接受值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T12:07:38.377

添加“Content-Type”标头使您的 CORS 请求失败的原因是您的服务器设置错误。

如果客户端希望指定特定的标头或使用不寻常的 http 方法动词（例如 PUT），则浏览器将首先执行“预检”OPTIONS 调用以确保允许设置这些标头。您的服务器需要使用适当的标头响应此 OPTIONS 调用。如果您想确认这是问题所在，您会在 Chrome 开发人员工具或 firebug 的网络选项卡中看到选项调用。

您可能对我[在这里](https://stackoverflow.com/questions/9015018/jersey-content-type-customization/13894742#13894742)更详细的回答感兴趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T02:07:12.313

您的服务器设置有效。JSFiddle 显然不会发出 ajax 请求，但是您可以通过在 Chrome 控制台或 Safari 开发者控制台中输入以下四行来快速测试它是否有效：

```
var xhr = new XMLHttpRequest();
xhr.open('GET', 'http://projectwhatup.us:5000/api/posts', false);
xhr.send();
xhr.responseText; 
```

![在此处输入图像描述](../Images/e98cb28549d0f1663952ba67f2412819.png)

如果您使用不允许 CORS 的域尝试此操作，则会出错。

# php - PHP显示文本输入内容

> ID：13464923
> 
> 赞同：-1
> 
> 时间：2012-11-20T00:40:09.753
> 
> 标签：php

我想在用户单击提交按钮后显示用户在页面下方的文本框中键入的内容。

我是 PHP 新手，到目前为止我有这个：

```
<?php if(isset($_POST['submit'])) {echo 'You entered: ', ($_POST['name']);}?> 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T01:11:30.393

尝试这个：

```
<form action="" method="post">
<input type="text" name="name" />
<input type="submit" name="submit" />
</form>
<?php if(isset($_POST['submit'])) {echo 'You entered: '.$_POST['name'];}?> 
```

# r - 使用列中的值向现有绘图添加误差线

> ID：13464928
> 
> 赞同：1
> 
> 时间：2012-11-20T00:40:43.040
> 
> 标签：r, plot, add, confidence-interval

我在尝试使用矩阵中两列的值将 95% CI（下/上）添加到现有绘图时遇到问题。使用此信息添加误差线的最佳方法是什么？

这是我的数据示例：

> ```
> option<-read.table(text="
> distance p.move id option   mean lower95%CI upper95%CI
> 1      close   0.05  1    10% 13.682     11.306     15.768
> 2      close   0.10  2    10% 10.886      9.336     12.270
> 3      close   0.15  3    10%  8.402      7.262      9.580
> 4      close   0.20  4    10%  7.240      6.132      8.350
> 5      close   0.25  5    10%  6.322      5.288      7.370
> 6      close   0.30  6    10%  5.850      4.920      6.714
> 7      close   0.35  7    10%  3.838      3.084      4.648
> 8      close   0.40  8    10%  3.600      2.936      4.200
> 9      close   0.45  9    10%  3.380      2.702      4.016
> 10     close   0.50 10    10%  3.152      2.462      3.720
> 11     close   0.55 11    10%  2.772      2.214      3.286
> 12     close   0.60 12    10%  3.072      2.458      3.596
> 13     close   0.65 13    10%  2.670      2.134      3.212
> 14     close   0.70 14    10%  2.194      1.724      2.634
> 15     close   0.75 15    10%  1.980      1.612      2.336
> 16     close   0.80 16    10%  2.028      1.594      2.466
> 17     close   0.85 17    10%  1.650      1.294      1.974
> 18     close   0.90 18    10%  1.916      1.564      2.254",header=T)
> 
> option 
> ```

这是我的情节：

> ```
> plot(option$mean~option$p.move,xlim=c(0,1),type="o",ylim=c(0,20),
> xlab="Probability",ylab="% time",col=1,lwd=1.85) 
> ```

非常感谢提前，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:51:46.697

您可以添加额外的列，`lines`其中类似于`plot`但在现有图上绘制。（见`?lines`，`?points`）。

此外，当您`plot`使用数据框时，您可以`option$`通过`option`输入`dat`参数来跳过所有内容（请参阅 参考资料`?plot`）：

```
# draw original plot
plot(mean ~ p.move, dat=option, xlim=c(0,1), type="o", ylim=c(0,20),
     xlab="Probability",ylab="% time",col=1,lwd=1.85)

# draw extra lines (the '%' in the column names gets converted to '.' by R)
# note you can put your usual `plot` arguments into `lines` like lwd, type etc
# if you want
lines(upper95.CI ~ p.move, option)
lines(lower95.CI ~ p.move, option) 
```

![在此处输入图像描述](../Images/2a65fba496c3607a2015a4db85919d9d.png)

# asp.net-mvc-3 - ASP.NET MVC 3 RedirectToRouteResult

> ID：13464929
> 
> 赞同：2
> 
> 时间：2012-11-20T00:40:49.170
> 
> 标签：asp.net-mvc-3

`RedirectToRouteResult`不重定向到指定的控制器动作对。

```
public class CustAuthorizeAttribute : AuthorizeAttribute, IAuthorizationFilter
{
  ...
  public override void OnAuthorization(AuthorizationContext filterContext)
  {
     base.OnAuthorization(filterContext);
     ...
     if (...) {
        var routeDictionary = new RouteValueDictionary { { "action", "Forbidden" }, { "controller", "Error" } };
        filterContext.Result = new RedirectToRouteResult(routeDictionary);                    
     }
  }
} 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T01:25:05.257

也许您可以尝试以下方法：

```
UrlHelper urlHelper = new UrlHelper(filterContext.HttpContext.Request.RequestContext);
filterContext.Result = urlHelper.Action("Forbidden" , "Error"); 
```

# unix - 在模式之后提取字符串

> ID：13464932
> 
> 赞同：7
> 
> 时间：2012-11-20T00:41:13.130
> 
> 标签：unix, sed, awk, pattern-matching

我想提取 client_id 和 id 后面的数字，并将每行中的 client_id 和 id 配对。

例如，对于以下日志行，

```
User(client_id:03)) results:[RelatedUser(id:204, weight:10),_RelatedUser(id:491,_weight:10),_RelatedUser(id:29, weight: 20)

User(client_id:04)) results:[RelatedUser(id:209, weight:10),_RelatedUser(id:301,_weight:10)

User(client_id:05)) results:[RelatedUser(id:20, weight: 10) 
```

我要输出

```
03 204
03 491
03 29
04 209
04 301
05 20 
```

我知道我需要使用 sed 或 awk。但我不知道具体如何。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T00:55:07.413

这可能对您有用：

```
awk -F "[):,]" '{ for (i=2; i<=NF; i++) if ($i ~ /id/) print $2, $(i+1) }' file 
```

结果：

```
03 204
03 491
03 29
04 209
04 301
05 20 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T01:03:45.190

这是一个`awk`有效的脚本（我把它放在多行上，让它更详细一点，这样你就可以看到发生了什么）：

```
#!/bin/bash

awk 'BEGIN{FS="[\(\):,]"}
/client_id/ {
cid="no_client_id"
for (i=1; i<NF; i++) {
    if ($i == "client_id") {
        cid = $(i+1)
    } else if ($i == "id") {
        id = $(i+1);
        print cid OFS id;
    }
 }
}' input_file_name 
```

**输出：**

```
03 204
03 491
03 29
04 209
04 301
05 20 
```

**解释：**

*   `awk 'BEGIN{FS="[\(\):,]"}`: 调用`awk`，使用`(` `)` `:`和`,`作为分隔符来分隔你的字段
*   `/client_id/ {`：仅对包含的行执行以下操作`client_id`：
*   `for (i=1; i<NF; i++) {`: 遍历每一行的字段，一次一个字段
*   `if ($i == "client_id") { cid = $(i+1) }`: 如果我们当前所在的字段是`client_id`，那么它的值就是按顺序排列的下一个字段。
*   `else if ($i == "id") { id = $(i+1); print cid OFS id;}`: 否则，如果我们当前所在的字段是`id`，则将这对打印`client_id : id`到`stdout`
*   `input_file_name`：提供输入文件的名称作为`awk`脚本的第一个参数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T11:03:48.550

这可能对您有用（GNU sed）：

```
sed -r '/.*(\(client_id:([0-9]+))[^(]*\(id:([0-9]+)/!d;s//\2 \3\n\1/;P;D' file 
```

*   `/.*(\(client_id:([0-9]+))[^(]*\(id:([0-9]+)/!d`如果该行没有预期的字符串，请将其删除。
*   `s//\2 \3\n\1/``client_id`通过复制并向前移动第一个来重新排列线，`id`从而减少连续迭代的线。
*   `P`打印到引入的换行符。
*   `D`删除到引入的换行符。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-20T08:46:04.277

为此我更喜欢 awk，但如果您想知道如何使用 sed 执行此操作，这里有一种适用于 GNU sed 的方法。

*解析.sed*

```
/client_id/ {
  :a
  s/(client_id:([0-9]+))[^(]+\(id:([0-9]+)([^\n]+)(.*)/\1 \4\5\n\2 \3/
  ta
  s/^[^\n]+\n//
} 
```

像这样运行它：

```
sed -rf parse.sed infile 
```

或作为单行：

```
<infile sed '/client_id/ { :a; s/(client_id:([0-9]+))[^(]+\(id:([0-9]+)([^\n]+)(.*)/\1 \4\5\n\2 \3/; ta; s/^[^\n]+\n//; }' 
```

输出：

```
03 204
03 491
03 29

04 209
04 301

05 20 
```

### 解释：

这个想法是重复匹配`client_id:([0-9]+)`和`id:([0-9]+)`配对并将它们放在模式空间的末尾。在每次通过时，`id:([0-9]+)`都会删除。

最后的替换从循环中删除剩余部分。

# visual-c++ - 将 Arduino 代码集成到 C++ 中

> ID：13464939
> 
> 赞同：2
> 
> 时间：2012-11-20T00:41:29.747
> 
> 标签：visual-c++, dll, serial-port, arduino, led

为了从我的桌面 Visual C++ 应用程序与 Arduino 通信，我需要添加哪些库/库？在这一点上，我真正想做的就是让 LED 闪烁（将高/低写入引脚）。我已经有桌面应用程序，但希望它与 Arduino 交互。不，Arduino Uno 不适合我的情况。

**编辑 1**另外：我正在使用串行 USB COM 端口连接到 Arduino。

**编辑 2**当我在 Windows 中编程时，该应用程序将针对 Windows 或 Android 设计。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T09:42:13.920

将 arduino 作为串行设备连接后，您可以在中间安装软件，将其连接到网络套接字。

如果你用谷歌搜索，你会发现几个免费的程序可以做到这一点。

您甚至可以自己用高级编程语言（python、perl、php 等）非常轻松地编写它，只需几行代码。

然后连接到 arduino，无论是 c++ 还是 javascript，都非常轻松。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T09:34:08.967

在 Arduino 端，您可以只使用内置的 Serial 来发送和接收数据。

在桌面端，参考这个[问题](https://stackoverflow.com/questions/7385228/serial-port-rs232-communication-with-visual-c-2010)，它告诉你如何在 Visual C++ 中与串行端口通信

**编辑**：

如果您打算使用 Java，那么您可以使用 Java 串行端口库，而无需对 Arduino 代码进行任何更改。

如果您想创建 Android 应用程序，我还建议您使用 Android API。使用 NDK 真的很痛苦，除非你知道自己在做什么，否则会非常困难。

# ruby-on-rails - Multibutton Rails Forms 适用于 New 但不适用于 Edit

> ID：13464948
> 
> 赞同：0
> 
> 时间：2012-11-20T00:42:13.300
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, railscasts

按照 Railscasts #38 [http://railscasts.com/episodes/38-multibutton-form](http://railscasts.com/episodes/38-multibutton-form)中的有用教程，我为我的“新建”/“创建”控制器操作设置了一个“预览”按钮。

但是当我对“编辑”/“更新”使用相同的方法时，似乎出现了问题。

我似乎无法让我的表格持续存在。

这是我的控制器的样子：

```
def update
    stylesheets << 'feature'

    @feature = Feature.find(params[:id])

    case params[:submit]
        when "Preview" 
            render :action => "edit"
        return

        when "Update" 
            respond_to do |format|
                if @feature.update_attributes(params[:feature])
                    flash[:notice] = 'Feature was successfully updated.'
                    format.html { redirect_to(features_path) }
                    format.xml  { head :ok }
                else
                    format.html { render :action => "edit" }
                    format.xml  { render :xml => @feature.errors, :status => :unprocessable_entity }
                end
            end
        return
    end

end 
```

当我点击预览按钮时，我按预期返回到编辑屏幕，但我的编辑不会持续存在。有小费吗？很好奇，因为这适用于预览新对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:59:17.447

这里发生的情况是，在渲染视图之前，您实际上并没有将用户对内存模型所做的更改应用到内存模型中，因此更改会丢失。

尝试像这样更改您的“预览”案例：

```
when "Preview"
  @feature.attributes = params[:feature]
  render :action => "edit"
  return 
```

我要说的一件事是，我还会考虑将该方法拆分一下，以使其更易于阅读和测试。像这样的东西：

```
before_filter :set_stylesheets

def set_stylesheets
  stylesheets << 'feature'
end

def update
  @feature = Feature.find(params[:id])
  preview if params[:submit] == 'Preview'
  apply_update if params[:submit] == 'Update'
end

def preview
  @feature.attributes = params[:feature]
  render :action => "edit"
  return
end

def apply_update
  # Rest of update action here.
end 
```

这可以帮助您保持测试简单并一次只专注于一种方法，并且应该使代码更易于维护。

# javascript - jquery重新排列页面元素

> ID：13464951
> 
> 赞同：1
> 
> 时间：2012-11-20T00:42:40.010
> 
> 标签：javascript, jquery, jquery-selectors, coffeescript

我有一段大约 12 段长的文本......在文本里面有几个块引用，我想在整个文档中自动突出显示和重新排列（每 3 段），然后删除块引用以便文本出现两次。一次作为自动排序位置的突出显示片段，第二次在没有块的原始位置...

它有点工作，但我觉得我错过了一些东西，因为它不遵循顺序。我认为它会是（3,6,9等），但它似乎被什么东西抛弃了？

```
jQuery ->
    content = $('article.city-review div')
    content.find('blockquote').each (index) ->
        line_space = (index+1)*3
        quote_tag = '<span class=\"quote_left\">'+$(this).text()+'</span>'
        content.find('p:nth-child('+line_space+')').prepend(quote_tag)
        $(this).contents().unwrap().wrap('<p></p>') 
```

更新：

输入看起来像：

```
<p>Text</p>
<p>More Text</p>
<p>Text</p>
<p>More Text</p>
<blockquote>Text</blockquote>
<p>Text</p>
<p>More Text</p>
<blockquote><p>Sometimes these appear</p></blockquote> 
```

输出给了我空的 p 标签`<p></p>`和嵌套的 p 标签`<p><p>Something</p></p>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:25:31.377

```
jQuery ->
    content = $('article.city-review div')
    content.find('blockquote').each (index) ->
        position = [2,6,10]
        line_space = position[index]
        text = $(this).text()
        quote_tag = '<span class=\"quote_left\">'+text+'</span>'
        content.find('p:nth-child('+line_space+')').after(quote_tag)
        $(this).replaceWith('<p>'+text+'</p>') 
```

制作数组是测试间距的一种简单方法，除非您需要无限长度，否则可以工作。删除 unwrap 和 use `replacewith`，这对您来说可能更简单，而`after`不是`prepend`除非您希望在另一个标签中使用新引号。

# sql - 如何使用 sql 查询有效地计算注册和取消（postgresql 9.0）

> ID：13464952
> 
> 赞同：3
> 
> 时间：2012-11-20T00:42:47.267
> 
> 标签：sql, postgresql

想象一个如下所示的帐户表：

```
 Column   |            Type             | Modifiers 
------------+-----------------------------+-----------
 id         | bigint                      | not null
 signupdate | timestamp without time zone | not null
 canceldate | timestamp without time zone | 
```

我想按月获取注册和取消数量的报告。

在两个查询中执行此操作非常简单，一个用于按月注册，另一个用于按月取消。有没有一种有效的方法可以在单个查询中完成？某些月份的注册和取消可能为零，结果应该显示为零。

使用这样的源数据：

```
id    signupDate     cancelDate
 1    2012-01-13     
 2    2012-01-15     2012-02-05
 3    2012-03-01     2012-03-20 
```

我们应该得到以下结果：

```
Date      signups    cancellations    
2012-01         2                0
2012-02         0                1
2012-03         1                1 
```

我正在使用 postgresql 9.0

## 第一个答案后更新：

Craig Ringer 在下面提供了一个很好的答案。在我的大约 75k 条记录的数据集中，第一个和第三个示例的表现相似。第二个示例似乎在某处有错误，它返回了不正确的结果。

查看解释分析的结果（我的表确实在 signup_date 上有一个索引），第一个查询返回：

```
Sort  (cost=2086062.39..2086062.89 rows=200 width=24) (actual time=863.831..863.833 rows=20 loops=1)
  Sort Key: m.m
  Sort Method:  quicksort  Memory: 26kB
  InitPlan 2 (returns $1)
    ->  Result  (cost=0.12..0.13 rows=1 width=0) (actual time=0.063..0.064 rows=1 loops=1)
          InitPlan 1 (returns $0)
            ->  Limit  (cost=0.00..0.12 rows=1 width=8) (actual time=0.040..0.040 rows=1 loops=1)
                  ->  Index Scan using account_created_idx on account  (cost=0.00..8986.92 rows=75759 width=8) (actual time=0.039..0.039 rows=1 loops=1)
                        Index Cond: (created IS NOT NULL)
  InitPlan 3 (returns $2)
    ->  Aggregate  (cost=2991.39..2991.40 rows=1 width=16) (actual time=37.108..37.108 rows=1 loops=1)
          ->  Seq Scan on account  (cost=0.00..2612.59 rows=75759 width=16) (actual time=0.008..14.102 rows=75759 loops=1)
  ->  HashAggregate  (cost=2083057.21..2083063.21 rows=200 width=24) (actual time=863.801..863.806 rows=20 loops=1)
        ->  Nested Loop  (cost=0.00..2077389.49 rows=755696 width=24) (actual time=37.238..805.333 rows=94685 loops=1)
              Join Filter: ((date_trunc('month'::text, a.created) = m.m) OR (date_trunc('month'::text, a.terminateddate) = m.m))
              ->  Function Scan on generate_series m  (cost=0.00..10.00 rows=1000 width=8) (actual time=37.193..37.197 rows=20 loops=1)
              ->  Materialize  (cost=0.00..3361.39 rows=75759 width=16) (actual time=0.004..11.916 rows=75759 loops=20)
                    ->  Seq Scan on account a  (cost=0.00..2612.59 rows=75759 width=16) (actual time=0.003..24.019 rows=75759 loops=1)
Total runtime: 872.183 ms 
```

第三个查询返回：

```
Sort  (cost=1199951.68..1199952.18 rows=200 width=8) (actual time=732.354..732.355 rows=20 loops=1)
  Sort Key: m.m
  Sort Method:  quicksort  Memory: 26kB
  InitPlan 4 (returns $2)
    ->  Result  (cost=0.12..0.13 rows=1 width=0) (actual time=0.030..0.030 rows=1 loops=1)
          InitPlan 3 (returns $1)
            ->  Limit  (cost=0.00..0.12 rows=1 width=8) (actual time=0.022..0.022 rows=1 loops=1)
                  ->  Index Scan using account_created_idx on account  (cost=0.00..8986.92 rows=75759 width=8) (actual time=0.022..0.022 rows=1 loops=1)
                        Index Cond: (created IS NOT NULL)
  InitPlan 5 (returns $3)
    ->  Aggregate  (cost=2991.39..2991.40 rows=1 width=16) (actual time=30.212..30.212 rows=1 loops=1)
          ->  Seq Scan on account  (cost=0.00..2612.59 rows=75759 width=16) (actual time=0.004..8.276 rows=75759 loops=1)
  ->  HashAggregate  (cost=12.50..1196952.50 rows=200 width=8) (actual time=65.226..732.321 rows=20 loops=1)
        ->  Function Scan on generate_series m  (cost=0.00..10.00 rows=1000 width=8) (actual time=30.262..30.264 rows=20 loops=1)
        SubPlan 1
          ->  Aggregate  (cost=2992.34..2992.35 rows=1 width=8) (actual time=21.098..21.098 rows=1 loops=20)
                ->  Seq Scan on account  (cost=0.00..2991.39 rows=379 width=8) (actual time=0.265..20.720 rows=3788 loops=20)
                      Filter: (date_trunc('month'::text, created) = $0)
        SubPlan 2
          ->  Aggregate  (cost=2992.34..2992.35 rows=1 width=8) (actual time=13.994..13.994 rows=1 loops=20)
                ->  Seq Scan on account  (cost=0.00..2991.39 rows=379 width=8) (actual time=2.363..13.887 rows=998 loops=20)
                      Filter: (date_trunc('month'::text, terminateddate) = $0)
Total runtime: 732.487 ms 
```

这无疑使第三个查询看起来更快，但是当我使用“时间”命令从命令行运行查询时，第一个查询始终更快，尽管只有几毫秒。

令我惊讶的是，运行两个单独的查询（一个用于计算注册，一个用于计算取消）的速度要快得多。运行时间不到一半，~300ms vs ~730ms。当然，这留下了更多的工作要在外部完成，但就我的目的而言，它仍然可能是最好的解决方案。以下是单个查询：

```
select 
    m,
    count(a.id) as "signups"
from
    generate_series(
        (SELECT date_trunc('month',min(signup_date)) FROM accounts), 
        (SELECT date_trunc('month',greatest(max(signup_date),max(cancel_date))) FROM accounts), 
        interval '1 month') as m
INNER JOIN accounts a ON (date_trunc('month',a.signup_date) = m)
group by m
order by m 
;

select 
    m,
    count(a.id) as "cancellations"
from
    generate_series(
        (SELECT date_trunc('month',min(signup_date)) FROM accounts), 
        (SELECT date_trunc('month',greatest(max(signup_date),max(cancel_date))) FROM accounts), 
        interval '1 month') as m
INNER JOIN accounts a ON (date_trunc('month',a.cancel_date) = m)
group by m
order by m 
; 
```

我已将克雷格的答案标记为正确，但如果你能让它更快，我很想听听

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:54:49.660

以下是三种不同的方法。所有这些都依赖于生成时间序列然后对其进行扫描。一个使用子查询来聚合每个月的数据。一个人根据具有不同标准的系列两次加入表格。另一种形式对时间序列进行单一连接，保留与开始日期或结束日期匹配的行*，*然后在计数中使用谓词来进一步过滤结果。

`EXPLAIN ANALYZE`将帮助您选择最适合您的数据的方法。

[http://sqlfiddle.com/#!12/99c2a/9](http://sqlfiddle.com/#!12/99c2a/9)

测试设置：

```
CREATE TABLE accounts
    ("id" int, "signup_date" timestamp, "cancel_date" timestamp);

INSERT INTO accounts
    ("id", "signup_date", "cancel_date")
VALUES
    (1, '2012-01-13 00:00:00', NULL),
    (2, '2012-01-15 00:00:00', '2012-02-05'),
    (3, '2012-03-01 00:00:00', '2012-03-20')
; 
```

通过单连接和过滤计数：

```
SELECT m, 
  count(nullif(date_trunc('month',a.signup_date) = m,'f')), 
  count(nullif(date_trunc('month',a.cancel_date) = m,'f'))
FROM generate_series(
  (SELECT date_trunc('month',min(signup_date)) FROM accounts),
  (SELECT date_trunc('month',greatest(max(signup_date),max(cancel_date))) FROM accounts),
  INTERVAL '1' MONTH
) AS m
INNER JOIN accounts a ON (date_trunc('month',a.signup_date) = m OR date_trunc('month',a.cancel_date) = m)
GROUP BY m
ORDER BY m; 
```

通过加入`accounts`表格两次：

```
SELECT m, count(s.signup_date) AS n_signups, count(c.cancel_date) AS n_cancels 
FROM generate_series( 
  (SELECT date_trunc('month',min(signup_date)) FROM accounts),
  (SELECT date_trunc('month',greatest(max(signup_date),max(cancel_date))) FROM accounts),
  INTERVAL '1' MONTH
) AS m LEFT OUTER JOIN accounts s ON (date_trunc('month',s.signup_date) = m) LEFT OUTER JOIN accounts c ON (date_trunc('month',c.cancel_date) = m)
GROUP BY m
ORDER BY m; 
```

或者，使用子查询：

```
SELECT m, (
  SELECT count(signup_date) 
  FROM accounts 
  WHERE date_trunc('month',signup_date) = m
) AS n_signups, (
  SELECT count(signup_date)
  FROM accounts
  WHERE date_trunc('month',cancel_date) = m
)AS n_cancels 
FROM generate_series( 
  (SELECT date_trunc('month',min(signup_date)) FROM accounts),
  (SELECT date_trunc('month',greatest(max(signup_date),max(cancel_date))) FROM accounts),
  INTERVAL '1' MONTH
) AS m
GROUP BY m
ORDER BY m; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:03:37.800

更新后的新答案。

从两个更简单的查询中获得更好的结果，我并不感到震惊；有时以这种方式做事更有效。但是，我的原始答案存在一个问题，该问题将显着影响性能。

[Erwin 在另一个答案中准确指出 Pg 不能在日期上使用简单的 b-tree 索引`date_trunc`](https://stackoverflow.com/a/13414130/398670)，因此最好使用范围。它可以使用在表达式上创建的索引，`date_trunc('month',colname)`但最好避免创建另一个不必要的索引。

将单扫描和过滤查询改写为使用范围会产生：

```
SELECT m, 
  count(nullif(date_trunc('month',a.signup_date) = m,'f')), 
  count(nullif(date_trunc('month',a.cancel_date) = m,'f'))
FROM generate_series(
  (SELECT date_trunc('month',min(signup_date)) FROM accounts),
  (SELECT date_trunc('month',greatest(max(signup_date),max(cancel_date))) FROM accounts),
  INTERVAL '1' MONTH
) AS m
INNER JOIN accounts a ON (
  (a.signup_date >= m AND a.signup_date < m + INTERVAL '1' MONTH) 
  OR (a.cancel_date >= m AND a.cancel_date < m + INTERVAL '1' MONTH))
GROUP BY m
ORDER BY m; 
```

在不可索引的条件下没有必要避免`date_trunc`，所以我只更改为在连接条件中使用区间范围。

原始查询使用 seq 扫描和物化，如果 和 上有索引，现在使用位图索引`signup_date`扫描`cancel_date`。

在 PostgreSQL 9.2 中，通过添加以下内容可能会获得更好的性能：

```
CREATE INDEX account_signup_or_cancel ON accounts(signup_date,cancel_date); 
```

并且可能：

```
CREATE INDEX account_signup_date_nonnull 
ON accounts(signup_date) WHERE (signup_date IS NOT NULL);

CREATE INDEX account_cancel_date_desc_nonnull 
ON accounts(cancel_date DESC) WHERE (cancel_date IS NOT NULL); 
```

允许仅索引扫描。如果没有要测试的实际数据，很难做出可靠的索引建议。

或者，具有改进的可索引过滤条件的基于子查询的方法：

```
SELECT m, (
  SELECT count(signup_date) 
  FROM accounts 
  WHERE signup_date >= m AND signup_date < m + INTERVAL '1' MONTH
) AS n_signups, (
  SELECT count(cancel_date)
  FROM accounts
  WHERE cancel_date >= m AND cancel_date < m + INTERVAL '1' MONTH
) AS n_cancels 
FROM generate_series( 
  (SELECT date_trunc('month',min(signup_date)) FROM accounts),
  (SELECT date_trunc('month',greatest(max(signup_date),max(cancel_date))) FROM accounts),
  INTERVAL '1' MONTH
) AS m
GROUP BY m
ORDER BY m; 
```

将受益于 and 上的普通 b-tree 索引`signup_date`，`cancel_date`或者来自：

```
CREATE INDEX account_signup_date_nonnull 
ON accounts(signup_date) WHERE (signup_date IS NOT NULL);

CREATE INDEX account_cancel_date_nonnull 
ON accounts(cancel_date) WHERE (cancel_date IS NOT NULL); 
```

请记住，您创建的每个索引都会对性能`INSERT`和`UPDATE`性能造成不利影响，并且会与其他索引竞争并帮助数据获得缓存空间。尝试只创建对其他查询有很大影响并且对其他查询有用的索引。

# java - 如何按换行符拆分字符串？

> ID：13464954
> 
> 赞同：25
> 
> 时间：2012-11-20T00:42:52.443
> 
> 标签：java, android

我是android开发的菜鸟，我试图通过它的多个换行符多次拆分一个字符串。我试图拆分的字符串是从数据库查询中提取的，并且构造如下：

```
public String getCoin() {
    // TODO Auto-generated method stub
    String[] columns = new String[]{ KEY_ROWID, KEY_NAME, KEY_QUANTITY, KEY_OUNCES, KEY_VALUE };
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, null, null, null, null, null);
    String result = "";

    int iRow = c.getColumnIndex(KEY_ROWID);
    int iName = c.getColumnIndex(KEY_NAME);
    int iQuantity = c.getColumnIndex(KEY_QUANTITY);
    int iOunces = c.getColumnIndex(KEY_OUNCES);
    int iValue = c.getColumnIndex(KEY_VALUE);

    for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()){
        result = result + /*c.getString(iRow) + " " +*/ c.getString(iName).substring(0, Math.min(18, c.getString(iName).length())) + "\n";
    }
    c.close();
    return result; 
```

result.getCoin 是这样写的：

```
alphabravocharlie 
```

我想在换行符处拆分字符串并将每个子字符串放入字符串数组中。这是我当前的代码：

```
String[] separated = result.split("\n");
      for (int i = 0; i < separated.length; i++) {
           chartnames.add("$." + separated[i] + " some text" ); 
           } 
```

这给了我一个输出：

```
"$.alpha
bravo
charlie some text" 
```

而不是我想要的输出：

```
"$.alpha some text, $.bravo some text, $.charlie some text" 
```

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-11-20T00:46:14.060

您可以使用以下语句按换行符拆分字符串：

```
 String textStr[] = yourString.split("\\r\\n|\\n|\\r"); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-11-20T00:51:08.817

这有点矫枉过正，但您可以使用标准 I/O 类：

```
BufferedReader rdr = new BufferedReader(new StringReader(result));
List<String> lines = new ArrayList<String>();
for (String line = rdr.readLine(); line != null; line = rdr.readLine()) {
    lines.add(line);
}
rdr.close(); // good form to close streams, but unnecessary for StringReader

// lines now contains all the strings between line breaks of any type 
```

这样做的好处是，`BufferedReader.readLine()`为检测各种线路终结器制定了所有逻辑。

从 Java 8 开始，`BufferedReader`有一个`lines()`方法，所以有一个更简单的方法（感谢 @jaco0646）：

```
List<String> lines = new BufferedReader(new StringReader(result))
                         .lines()
                         .collect(Collectors.toList(); 
```

或者，如果需要一个数组：

```
String[] lines = new BufferedReader(new StringReader(result))
                     .lines()
                     .toArray(String[]::new); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-11-06T20:21:16.800

使用 Apache 公共辅助类 StringUtils。

平台无关方式：

`String[] lines = StringUtils.split(string, "\r\n");`

平台依赖方式。也许一些 CPU 周期更快。但我不认为这很重要。

`String[] lines = StringUtils.split(string, System.lineSeparator());`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-20T01:02:18.353

如果可能的话，我建议使用 Guava Splitter 和 Joiner 类而不是 String.split。但即便如此，确保在声明正则表达式时正确转义它们也很重要。我不确定 Java 中的正则表达式编译器不会正确解释“\n”，但我也不确定它是否会正确解释。

覆盖所有可能的行尾很棘手，因为多个连续的 EOL 标记可能会弄乱您的匹配。我会建议

```
String [] separated = result.replaceAll("\\r", "").split("\\n"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-18T08:45:44.247

```
Matcher m = Pattern.compile("(^.+$)+", Pattern.MULTILINE).matcher(fieldContents);

while (m.find()) {
    System.out.println("whole group " + m.group())
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-03T11:12:43.770

我建议使用以下代码段，它与 PC 和 Mac 端线样式都兼容。

```
String [] separated = result.replaceAll("\\r", "\\n")
   .replaceAll("\\n{2,}", "\\n")
   .split("\\n"); 
```

# stanford-nlp - 卡雷尔系列版本

> ID：13464955
> 
> 赞同：0
> 
> 时间：2012-11-20T00:43:00.203
> 
> 标签：stanford-nlp, karel

我最近开始通过 iTunes U 学习编程，在斯坦福的 CS106A 通过视频。我现在正在和 Karel 一起写作。

我按照关于将所有内容下载到信中的说明进行操作，但是当我开始编写一组方法时，系统告诉我它找不到我正在使用的版本，并且在我查看 Eclipse 时，在 Assignment1 包中， Assignment1 的每个子部分都有一个警告三角形。

```
public class *CollectNewspaperKarel* extends SuperKarel {

public void run() { 
```

*collectnewspaperKarel 带有*黄色下划线。

每个程序都用黄色下划线。当我尝试通过生成软件版本来进行更改时，它仍然无法运行它。我该怎么办，因为我什至无法尝试我创建的任何组合？卡雷尔在所有给定的世界中仍然静止不动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T09:57:48.157

因为您只需要执行一次此任务，请在三角形上左键并尝试其他解决方案 - 禁止警告或添加默认序列版本 ID，对我有用。

# actionscript-3 - Actionsript 3.0 使用单个函数控制一个类的多个实例

> ID：13464956
> 
> 赞同：1
> 
> 时间：2012-11-20T00:42:59.637
> 
> 标签：actionscript-3, flash, class, addchild

嘿，我是 Flash AS 3.0 的新手，我在创建类实例时遇到了麻烦，我想对它们使用一个函数来控制它们。

```
import flash.display.MovieClip;
import flash.events.*;
stage.addEventListener (KeyboardEvent.KEY_DOWN, movestuff);

var newsymbol:MovieClip;
newsymbol = new Symbol1;
addChild(newsymbol);
newsymbol.x = 200
newsymbol.y = 200
addChild(newsymbol);

function movestuff (event:KeyboardEvent):void
{

newsymbol.x + 100
} 
```

Symbol1 是我试图移动的库中的一个类，我想添加它的多个实例，但使用函数 movestuff 控制所有实例

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:55:53.010

将实例保存在数组中：

```
var penguinArray:Array = [];

function addPenguin(){
    var newPenguin:Penguin = new Penguin();
    //do stuff
    penguinArray.push(newPenguin);
}

function moveStuff(){
    for(var i in penguinArray){
        penguinArray[i].x += 10;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T01:02:14.270

你的运动在它们之间是否一致（你想用相同的 x 和 y 移动它们吗）？如果是这样，请将它们全部放在一个父影片剪辑中，然后只移动它。

# python - 解析 xml 文件以创建超链接

> ID：13464962
> 
> 赞同：0
> 
> 时间：2012-11-20T00:43:29.027
> 
> 标签：python

1.我正在尝试读取标签“sanity_results”之间的xml文件（查看输入[http://pastebin.com/p9H8GQt4](http://pastebin.com/p9H8GQt4)）并打印输出

2.对于具有 http:// 或 // 的任何行或行的一部分，我希望它在链接上附加“a href”超链接标签，以便当我发布到电子邮件时，它们在电子邮件中显示为超链接

```
Input file(results.xml)
http://pastebin.com/p9H8GQt4

def getsanityresults(xmlfile):
    srstart=xmlfile.find('<Sanity_Results>')
    srend=xmlfile.find('</Sanity_Results>')
    sanity_results=xmlfile[srstart+16:srend].strip()
    sanity_results = sanity_results.replace('\n','<br>\n')
    return sanity_results

def main ():
xmlfile = open('results.xml','r')
contents = xmlfile.read()
testresults=getsanityresults(contents)
print testresults
for line in testresults:
        line = line.strip()
        //How to find if the line contains "http" or "\\" or "//" and append "a href"attribute
        resultslis.append(link) 
```

如果**名称**== '**主要**': main()

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:57:04.750

看看你的错误信息：

```
AttributeError: 'file' object has no attribute 'find' 
```

然后看看`main()`：你正在`open('results.xml', 'r')`输入 into的结果`getsanityresults`。但`open(...)`返回一个*文件对象*，而`getsanityresults`期望`xmlfile`是一个*字符串*。

您需要提取inti 的内容并提供给*它*。`xmlfile``getsanityresults`

要获取文件的内容，请阅读 [this bit of the python documentation]9http://docs.python.org/2/tutorial/inputoutput.html#methods-of-file-objects）。

特别是，尝试：

```
xmlfile = open('results.xml', 'r')
contents = xmlfile.read() # <-- this is a string
testresults = getsanityresults(contents) # <-- feed a string into getsanityresults
# ... rest of code 
```

# installscript - 您如何比较 InstallScript 中的版本？

> ID：13464963
> 
> 赞同：2
> 
> 时间：2012-11-20T00:43:33.847
> 
> 标签：installscript

看起来有一个内置函数，`VerCompare`但它需要包含所有四个组件的字符串，例如 1.2.3.4。我没有尝试在 InstallScript 中进行字符串操作，并且希望有人已经拥有获取版本字符串并根据需要添加 .0 的代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T15:34:55.693

需要一些错误检查，但这里是一般的想法：

```
prototype NUMBER CompareVersions(STRING, STRING);
prototype STRING FormatVersion(STRING);

function NUMBER CompareVersions(leftVersion, rightVersion)
    STRING formattedLeftVersion, formattedRightVersion;
begin
    formattedLeftVersion = FormatVersion(leftVersion);
    formattedRightVersion = FormatVersion(rightVersion);

    return VerCompare(formattedLeftVersion, formattedRightVersion, VERSION);
end;

function STRING FormatVersion(version)
    STRING formattedVersion;
    LIST tokens;
    NUMBER count;
begin
    tokens = ListCreate(STRINGLIST);
    StrGetTokens(tokens, version, ".");
    count = ListCount(tokens);
    ListSetIndex(tokens, LISTLAST);
    while (count < 4)
        ListAddString(tokens, "0", AFTER);
        count = count + 1;
    endwhile;
    StrPutTokens(tokens, formattedVersion, ".", FALSE);
    ListDestroy(tokens);
    return formattedVersion;
 end; 
```

# wordpress - 限制对特定 URL 的 Web 文件夹访问

> ID：13464967
> 
> 赞同：0
> 
> 时间：2012-11-20T00:44:16.593
> 
> 标签：wordpress, .htaccess, web, blogs

我使用一个托管包托管两个不同的网站。

我的初始网站是自建的，从我主机的 public_html 目录运行，我们称之为“http://www.website1.co.uk”

我还有一个 Word Press 博客在 public_html 下的文件夹中运行 - 所以是“/folder_2”，我们称之为“http://www.website2.co.uk”——这个 URL 当前指向“/folder_2”并将加载进入浏览器时的博客。

目前，也可以通过输入“http://www.website1.co.uk/folder_2/”访问该博客。

我希望能够将对“folder_2”的访问限制为“website2.co.uk”——防止有人在“website1.co.uk/folder_2”路径中输入并能够查看博客。

实现这一目标的最佳方法是什么，请记住有问题的文件夹正在运行 Word Press 博客。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T00:54:32.230

尝试将其添加到 folder_2 中的 .htaccess 文件中

```
RewriteEngine On
RewriteCond %{http_host} !website2.co.uk
RewriteRule .* http://website2.co.uk 
```

这会将访问 website1.co.uk/folder_2 的任何人重定向到 website2.co.uk，但如果您只想让他们点击 404，请将其放在 .htaccess 中

```
RewriteEngine On
RewriteCond %{http_host} !website2.co.uk
RewriteRule .* - [R=404,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:55:10.613

1# 将 folder_2 移出 public_html（你真的应该这样做）。

2#在htaccess中将' [http://www.website1.co.uk/folder_2/](http://www.website1.co.uk/folder_2/) '的所有请求重写为404

检查以下链接：

[重定向子文件夹 Htaccess](https://stackoverflow.com/questions/8273798/redirection-subfolder-htaccess)

# java - Guava 的 TypeToken 可以获取泛型字段的具体类型吗？

> ID：13464975
> 
> 赞同：7
> 
> 时间：2012-11-20T00:45:21.093
> 
> 标签：java, guava

我为称为 ASN.1 的文件格式编写了一个解析器，它使用 Guice`TypeLiteral.getFieldType(Field)`将通用字段转换为特定的 Java 类型，以便我可以构造正确的类型（类似于 Jackson 或 GS​​ON 数据绑定）。但由于我已经依赖 Guava 并且它似乎有一个新的 TypeLiteral 替代品，我想`TypeToken`改用它。根据[Guave TypeToken 文档](https://code.google.com/p/guava-libraries/wiki/ReflectionExplained)：

> `TypeToken`类似于 Guice 的`TypeLiteral`类，但有一个重要区别：它支持非具体类型，例如`T`,`List<T>`甚至`List<? extends Number>`; 而`TypeLiteral`没有。`TypeToken`也是可序列化的，并提供了许多额外的实用方法。

您可以使用 获得字段的具体类型`TypeToken`吗？换句话说，如何在 Guava 中执行以下操作？

```
import org.junit.Test;
import com.google.inject.TypeLiteral;
public class FieldTypeTest {
    public static class A<T> {
        T a;
    }
    public static class B {
        A<String> b;
    }

    @Test
    public void testTypeToken() throws SecurityException, NoSuchFieldException {
        TypeLiteral<?> reifiedA = TypeLiteral.get(B.class).getFieldType(B.class.getDeclaredField("b"));
        assertEquals(String.class, reifiedA.getFieldType(reifiedA.getRawType().getDeclaredField("a")).getRawType());
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T05:16:30.643

从我的头，未验证

```
Type t = B.class.getDeclaredField("b").getGenericType();
Class<?> p = TypeToken.of(t).resolve(
        /* T */  A.getTypeParameters()[0]).getRawType();
// p should be String.class 
```

# ruby - 将制表符分隔文件中的选择性列连接成键值对

> ID：13464981
> 
> 赞同：0
> 
> 时间：2012-11-20T00:46:04.780
> 
> 标签：ruby, csv

我有一个制表符分隔的文件，我需要将选择性列连接成一个键值对。假设我的前三列保持不变，但在那之后，我可以期待任意数量的列。第三个之后的所有列都应该连接成一个键值对。

这是我的数据集：

> col1 col2 col3 col4 col5
> 
> 1 2 3 4 5

结果

> col1 col2 col3 col4|col5
> 
> 1 2 3 col4 => 4 | col5 => 5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:54:02.030

如果您有以下输入文件：

```
col1,col2,col3,col4,col5
1,2,3,this,that
2,3,4,some,more
3,4,5,a,b 
```

然后拉下标题，拆分和解构每一行可以通过以下方式完成：

```
header, *lines = File.readlines('var.txt')
header = header.split(',')
header[-1].chomp!
rest_fields = header.slice(3..-1)
recs = lines.map do |line|
  line.chomp!
  f1, f2, f3, *rest = line.split(',')
  pairs = {}
  rest_fields.each do |f|
    pairs[f] = rest.shift
  end
  [f1, f2, f3, pairs]
end

recs.each do |rec|
  puts rec.inspect
end 
```

运行给出：

```
["1", "2", "3", {"col4"=>"this", "col5"=>"that"}]
["2", "3", "4", {"col4"=>"some", "col5"=>"more"}]
["3", "4", "5", {"col4"=>"a", "col5"=>"b"}] 
```

这就是你所追求的吗？

# python - Python根据模式查找和替换数字

> ID：13464982
> 
> 赞同：1
> 
> 时间：2012-11-20T00:46:07.537
> 
> 标签：python, parsing

我有一个字符串，我想查找并替换其中的一些数字。即，其中有多个重复的“v = 324\n”，具有不同的值。现在我想将所有这些数字除以`n`（四舍五入到最接近的整数）并将其保存为新字符串。

目前我正在使用解析包：

```
n = 10
s = "this is v = 2342\n and another v = 231\n and some stuff..."
for r in findall("v = {:d}\\n", s):
    print r 
```

这给了我结果列表，但我不知道如何更改字符串。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:54:11.110

您可以将一个函数传递给[re.sub](http://docs.python.org/2/library/re.html#re.sub)以获取匹配的模式`samples = {:d}\\n`（我必须更新）并以某种方式计算它。这是一个演示：

```
import re

def sampleRounder(match):
    return str(int(float(match.group(1)))) #base=10

s = "this is v = 2342.2\n and another v = 231.003\n and some stuff..."

print(re.sub("v = ([0-9]*\.[0-9]+|[0-9]+)\\n", sampleRounder, s)) 
```

# javascript - 同步数据库和 Javascript

> ID：13464985
> 
> 赞同：2
> 
> 时间：2012-11-20T00:46:39.967
> 
> 标签：javascript, mysql, sync

我正在开发一个实时 JavaScript 应用程序，该应用程序需要对数据库的所有更改都**立即**反映在 JavaScript 中，反之亦然。

现在，当在 JavaScript 中进行更改时，我对我的 API 进行 ajax 调用并对 DOM 进行相应的更改。在服务器上，API 处理请求并通过使用 PubNub 向其他当前 JavaScript 用户发送已进行更改的推送来完成。我还包括一个与 JavaScript 连续的 changeID，如果它错过了推送，它可以重新同步整个数据集。这是该推送的示例：

```
{
    "changeID":"2857693",
    "type":"update",
    "table":"users",
    "where":{ 
        "id":"32"
    },
    "set":{
        "first_name":"Johnny",
        "last_name":"Applesead"
    }
} 
```

当 JavaScript 获得此更改时，它会更新本地存储并根据正在更改的表进行相应的 DOM 更改。**请记住，我的问题不在于更新 DOM，而是将数据从数据库快速无缝地同步到 JavaScript。**

通过这个，我不禁认为这是一个非常复杂的解决方案，应该相当简单。我错过了一个问题吗？**您如何将多个 JavaScript 客户端与 MySQL 数据库无缝同步？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:12:33.963

只是为了在几个月后更新这个问题 - 我最终坚持使用这种方法并且效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-02T18:52:27.910

我知道这是一个老问题，但我花了很多时间来解决这个完全相同的问题，尽管背景完全不同。我正在创建一个 Phonegap 应用程序，它必须离线工作并稍后同步。

对我来说最大的启示是，我真正需要的是浏览器和服务器之间的版本控制，所以这就是我所做的。将数据单独存储在这些集合和版本中`sets`。`keys`当出现问题时，您可以使用冲突解决回调来解决它。

我只是把项目放在 GitHub 上，它的 URL 是[https://github.com/forbesmyester/SyncIt](https://github.com/forbesmyester/SyncIt)

# jquery - 将 div 左上角的一组图像与 css 对齐

> ID：13464987
> 
> 赞同：0
> 
> 时间：2012-11-20T00:46:46.710
> 
> 标签：jquery, css, html, alignment

我使用这段代码：

```
.photocontents {
    position: relative;
    display: inline-block;
    padding: 20px;
    margin: 0px;
    width: 100%;
    height: auto;
}
.photo {
    position: relative;
    float: left;
    display: inline;
    padding: 0px;
    margin: 10px;
    width: auto;
    height: auto;
} 
```

制作具有图像（a）结果的照片库。

我想要的是将这些照片也对齐在顶部，如图 (b) 所示。这怎么可能？

![左上对齐](../Images/c546c18d99bef62a527c653a6da22e50.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:49:19.477

纯 CSS 是不可能的。你必须使用一些Javascript。

这些 jQuery 插件完全符合您的要求：

1.  [jQuery 同位素](http://isotope.metafizzy.co/)
2.  [jQuery砌体](http://masonry.desandro.com/)

# iphone - 如何从 iOS 应用程序发送 POST XML？

> ID：13464990
> 
> 赞同：2
> 
> 时间：2012-11-20T00:47:07.363
> 
> 标签：iphone, ios, xml, post, kissxml

因此，我在网上一遍又一遍地搜索有关从 iPhone 应用程序使用 POST 发送 XML 的任何信息 - 到目前为止没有运气，没有！

我在我的应用程序 KissXML 中使用它，当涉及到使 XML 失去响应时，我发现它非常简单和有用 - 但在将 XML 发送到服务器时则完全相反......这是我连接和接收 XML 的方法。我试图将仅包含我的 XML 请求的 NSString 放入 POST 请求的正文中，但它没有按计划工作。

```
-(void)prepareTransaction{
    NSLog(@"FXSecondVC: preparing transaction...");
    NSString *login = [[NSUserDefaults standardUserDefaults] stringForKey:@"kUsername"];
    NSString *password = [[NSUserDefaults standardUserDefaults] stringForKey:@"kPassword"];
    NSString *host = [[NSUserDefaults standardUserDefaults] stringForKey:@"kURLServer"];

    NSURL *url = [[NSURL alloc] initWithString:host];

    AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];
    [httpClient setAuthorizationHeaderWithUsername:login password:password];
    [httpClient registerHTTPOperationClass:[AFKissXMLRequestOperation class]];

    NSString *xmlString = @"<RootEl xmlns=\"http://some.url/goes/here\">"
                                "<Element1>12678967.543233</Element1>"
                                "<Element2>"
                                    "<string xmlns=\"bla.bla/url\">"
                                            "String content</string>"
                                    "<string xmlns=\"bla.bla/url\">"
                                            "String content</string>"
                                "</Element2>"
                                "<Element3>true</Element3>"
                                "<Element4>String content</Element4>"
                                "<Element5>1999-05-31T11:20:00</Element5>"
                                "<Element6>true</Element6>"
                            "</RootEl>";

    NSMutableURLRequest *request = [httpClient requestWithMethod:@"POST" path:kServerRequestURL parameters:nil];
    [request setHTTPBody:[xmlString dataUsingEncoding:NSUTF8StringEncoding]];

    AFKissXMLRequestOperation *operation = [AFKissXMLRequestOperation XMLDocumentRequestOperationWithRequest:request success:^(NSURLRequest *req, NSHTTPURLResponse *resp, DDXMLDocument *XMLDocument){
        NSLog(@"[SUCCESS]: XMLDocument: %@", XMLDocument);
    }failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, DDXMLDocument *XMLDocument) {
        NSLog(@"error parsing: %@", [error localizedDescription]);
    }];
    [operation start];
} 
```

这就是我要进入的`response`：

```
2012-11-21 19:40:09.884 FXApp[19662:707] FXSecondVC: preparing transaction...
2012-11-21 19:40:10.011 FXApp[19662:707] error parsing: Expected status code in (200-299), got 400 
```

我在这里错过了什么吗？我想使用 KissXML，因为它是使用已经准备好的 XML 文档成功响应的最简单方法（至少我知道），但是如果解决方案需要更改框架 - 不要犹豫。首要任务是让它工作。我走到了死胡同——这让我发疯，尤其是这件事真的很紧急。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T20:06:45.777

谜团解开了：
看来我所要做的就是为 xml 设置 Content-Type - 我没有这样做。解决方案[在这里](https://stackoverflow.com/a/2071825/1015049)
找到 ：

```
[request setValue:@"application/xml; charset=utf-8" forHTTPHeaderField:@"Content-Type"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-02T23:37:22.093

就我而言，我不得不使用`setValue:@"text/xml"`从服务器（PHP 服务器）获取所需的 JSON 响应。

即我使用了以下内容：

```
[request addValue:@"text/xml" forHTTPHeaderField:@"Content-Type"]; 
```

# google-app-engine - 没有可用于“事务可选”的持久性提供程序

> ID：13464991
> 
> 赞同：0
> 
> 时间：2012-11-20T00:47:30.310
> 
> 标签：google-app-engine, jpa, jdo, datanucleus

我的 AppEngine 项目中出现此错误：

```
javax.persistence.PersistenceException: No persistence providers available for "transactions-optional" after trying the following discovered implementations: org.datanucleus.api.jpa.PersistenceProviderImpl
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:180)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:70) 
```

**jdoconfig.xml**

```
<jdoconfig xmlns="http://java.sun.com/xml/ns/jdo/jdoconfig"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/jdo/jdoconfig http://java.sun.com/xml/ns/jdo/jdoconfig_3_0.xsd">

    <persistence-manager-factory name="transactions-optional">
        <property name="javax.jdo.PersistenceManagerFactoryClass"
            value="org.datanucleus.api.jdo.PersistenceManagerFactoryClass"/>
        <property name="javax.jdo.option.ConnectionURL" value="appengine"/>
        <property name="javax.jdo.option.NontransactionalRead" value="true"/>
        <property name="javax.jdo.option.NontransactionalWrite" value="true"/>
        <property name="javax.jdo.option.RetainValues" value="true"/>
        <property name="datanucleus.appengine.autoCreateDatastoreTxns" value="true"/>
        <property name="datanucleus.appengine.singletonPMFForName" value="true"/>
    </persistence-manager-factory>
</jdoconfig> 
```

这真的很奇怪，因为在我的 jdoconfig.xml 中有这个“事务可选”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T06:14:26.680

显然，JPA（用于获取 EMF）不使用“jdoconfig.xml”（由 JDO 使用）。JPA 使用“persistence.xml”。建议您在继续之前确定您正在使用的 API

# mysql - 存储过程中的循环执行语句

> ID：13464995
> 
> 赞同：0
> 
> 时间：2012-11-20T00:47:55.397
> 
> 标签：mysql, stored-procedures, insert, execute

我有以下场景：

```
CREATE DEFINER=`test`@`%` PROCEDURE `prTest`()
BEGIN
     SET @prepared_sql = 'select field1, field2 from table_data1');

     PREPARE stmt FROM @prepared_sql;
     EXECUTE stmt;
     DEALLOCATE PREPARE stmt;
END 
```

我必须循环打开“stmt”。如何读取这个循环和每一行，获取“field1”和“field2”的值并将值插入另一个表中？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-20T22:34:13.660

解决：

```
CREATE DEFINER=`test`@`%` PROCEDURE `prTest`()
BEGIN
     SET @prepared_sql = 'insert into table_data2
                          select field1, field2 from table_data1');

     PREPARE stmt FROM @prepared_sql;
     EXECUTE stmt;
     DEALLOCATE PREPARE stmt;
END 
```

# grails - grails spring security facebook登录错误

> ID：13464996
> 
> 赞同：1
> 
> 时间：2012-11-20T00:48:01.680
> 
> 标签：grails, facebook-login, google-openid

不知道为什么会发生这种情况，它在两周前起作用。这是异常日志：

```
No signature of method: xxxxx.UserInfo.findAllByEmail() is applicable for argument        types: () values: []
Possible solutions: findAllByEmail([Ljava.lang.Object;). Stacktrace follows:
groovy.lang.MissingMethodException: 
No signature of method: xxxxxx.UserInfo.findAllByEmail() is applicable for argument types: () values: []
Possible solutions: findAllByEmail([Ljava.lang.Object;)
                at org.grails.datastore.gorm.GormStaticApi$_methodMissing_closure2.doCall(GormStaticApi.groovy:105)
                at xxxxxx.FacebookController.checkEmail(FacebookController.groovy:87)
                at xcompare.FacebookController$_closure2.doCall(FacebookController.groovy:49)
                at xxxxxxx.OpenIDFilter.doFilter(OpenIDFilter.groovy:64)
                at java.lang.Thread.run(Thread.java:662) 
```

这是代码`FacebookController.groovy`：

```
private boolean checkEmail(String email){
    def users = UserInfo.findAllByEmail(email)
    if(users){
        // email is not available
        return false;
    }
    return true;
 } 
```

这是来自的代码`UserInfo`：

```
class UserInfo extends SecUser {
Provider provider
String activationCode
String firstName
String lastName
String email
Boolean active
UserType type
Date dateCreated
Date lastUpdated
Category category

static constraints = {
    email unique:true, nullable:true, email:true
    provider nullable:true
    activationCode nullable:true
    firstName blank:true, nullable:true
    lastName blank:true, nullable:true
    category nullable:true      
}

String toString() {
    // normal user
    if(!openIds){
        return username
    }
    // openid user
    String name = "";
    if(firstName){
        name += firstName;
        if(lastName){
            name += " "+lastName;
        }
    }else{
        name = email;
    }
    return name;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T04:37:31.737

我不确定，但也许是因为`email`是空的。所以试试：

```
private boolean checkEmail(String email){
    if (!email) {
        //TODO don't think that it's what you want
        return true
    }
    int count = UserInfo.countByEmail(email)
    return count == 0
} 
```