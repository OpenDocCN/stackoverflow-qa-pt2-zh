# StackOverflow 问答 14096000-14096999

# java - 渐变色画布上的 Java 挑战

> ID：14096002
> 
> 赞同：0
> 
> 时间：2012-12-31T00:02:02.777
> 
> 标签：java, graphics, gradient, shapes

这大概是个初级问题。但是，我已经阅读了面向绝对初学者的 Java 编程的第 9 章，并进入了挑战部分。我不能完全让程序显示从暗到亮的渐变。

问题问：

> “创建一个画布，在一侧绘制一个深色的渐变，然后在向另一侧移动时逐渐变亮。”

我看过[Java Challenge on Creating a Canvas](https://stackoverflow.com/questions/14093303/java-challenge-on-creating-a-canvas) page（我之前问过这个问题），并且对创建颜色渐变画布有了更好的理解，但是我仍然遇到了很大的困难。

我认为我的主要问题是如何在程序显示一个完全黑色的正方形或仅使用第一个 for 循环运行时，一个完全白色的正方形之间获得灰色。我认为我的 for 循环有问题，并且没有正确识别变量。

这个问题的答案可能有助于许多新的 Java 程序员理解图形和画布。

我不知道 JFrame、Swing、Points、JPanels、BufferedImage 或 GradientPaint。

非常感谢您在此问题上的时间和合作。

这是代码：

```
import java.awt.*;

public class RandomColorSquare extends GUIFrame {
    Canvas slight;
    public final static int MIN = 0,
        MAX = 225;

    public RandomColorSquare(int r, int g, int b) {
        super("Random Color Square");
        r = r >= MIN && r <= MAX ? r : MIN;
        g = g >= MIN && g <= MAX ? g : MIN;
        b = r >= MIN && b <= MAX ? b : MIN;
        slight = new Canvas();
        slight.setBackground(new Color(r,g, b));
        slight.setSize(200, 150);
        add(slight, BorderLayout.CENTER);

        for(r=0; r<225; r++) {
            Color c = slight.getBackground().brighter();
            slight.setBackground(c);
        }

        for (g=0; g<225; g++) {
            Color d = slight.getBackground().darker();
            slight.setBackground(d);
        }
        for (b=0; b<225; b++) {
             Color e = slight.getBackground().darker();
             slight.setBackground(e);
        }

        pack();
        setVisible(true);
    }

    public static void main(String args[]) {
        if (args.length != 3) {
            new RandomColorSquare(0, 0, 0);
        }
        else {
            new RandomColorSquare(Integer.parseInt(args[0]),                                     Integer.parseInt(args[1]),
                   Integer.parseInt(args[2]));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T02:05:21.670

首先，正如我在评论中提到的，当你`setBackground`改变背景时`Canvas`，而不是添加它。因此，无论您将其设置为什么，都是您所看到的。在您的情况下，这是最深的蓝色形式，也就是黑色。如果你注释掉最后两个循环，你会得到一个白色的背景（最亮的红色）。

然而。只使用你所知道的这是我能想到的最好的。它涉及创建您自己的自定义`Canvas`，我称之为`CustomCanvas`。在那里，您可以覆盖paint 方法并继续在屏幕上绘制逐渐变亮的填充矩形。这是一个小示例，可帮助您理解我的意思：

```
class CustomeCanvas extends Canvas{
    public void paint(Graphics g){
        Color background = new Color(30,30,120); //Set this accordingly
        for(int i=0;i<getWidth();i++){
            g.setColor(background);
            background = getBrighter(background);
            g.fillRect(i,0, 1, getHeight());
        }
    }

    private Color getBrighter(Color c) {
        int r = c.getRed();
        int g = c.getGreen();
        int b = c.getBlue();

        if(r< MAX) r+=1;
        if(g< MAX) g+=1;
        if(b< MAX) b+=1;

        return new Color(r,g,b);
    }
} 
```

这产生了这个背景：

![在此处输入图像描述](../Images/30735c46f2ad93269fc914cb6efdc648.png)

我仍然推荐阅读[GradientPaint](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/GradientPaint.html)，它使这个过程变得更容易和更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T00:20:21.980

`paint()`您可以`Canvas`以类似于此[示例](https://stackoverflow.com/a/3538251/230513)对`Panel`. 在您的实现中，用于`drawImage()`渲染`BufferedImage`您用来`setRGB()`构建渐变的 a。

附录：下面的示例通过创建随机图像来说明该方法。您可以类似地创建渐变。

![图片]](../Images/df65f7a81f2ce0f94a3ec88ede565ebb.png)

```
import java.awt.Canvas;
import java.awt.Dimension;
import java.awt.Frame;
import java.awt.Graphics;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.util.Random;

/** @see https://stackoverflow.com/a/14096121/230513 */
public class AWTImage {

    public static void main(String[] args) throws IOException {
        Frame frame = new Frame();
        frame.add(new ImageCanvas());
        frame.addWindowListener(new WindowAdapter() {

            @Override
            public void windowClosing(WindowEvent e) {
                System.exit(0);
            }
        });
        frame.pack();
        frame.setVisible(true);
    }

    private static class ImageCanvas extends Canvas {

        private static final Random r = new Random();
        private BufferedImage image;

        public ImageCanvas() {
            image = new BufferedImage(256, 256, BufferedImage.TYPE_INT_ARGB);
            for (int row = 0; row < image.getHeight(); row++) {
                for (int col = 0; col < image.getWidth(); col++) {
                    image.setRGB(col, row, r.nextInt());
                }
            }
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(image.getWidth(), image.getHeight());
        }

        @Override
        public void paint(Graphics g) {
            g.drawImage(image, 0, 0, this);
        }
    }
} 
```

# html - CSS - 如何设置标题图像作为使用，例如。Facebook？

> ID：14096004
> 
> 赞同：0
> 
> 时间：2012-12-31T00:02:32.300
> 
> 标签：html, css, image, resolution

我想知道如何在我的网站上设置标题图像。基本问题 - 假设我在我的笔记本电脑上 - 宽度分辨率约为 1280 像素。我有一个宽度为 2000 像素的标题图像。

我想要实现的是，在我的笔记本电脑上将这个标题图像调整为 1280 像素，在我的液晶显示器（宽度分辨率如 ±1900 像素）上将显示 1900 像素的图像 - 我的意思是，在这两种情况下都适合展示。

我当前的 CSS 设置是`width: 100%;`-> 这导致 2000 像素宽度的图像将在我的笔记本电脑上被裁剪 - 仅显示图像的 2/3。

有什么方法可以将图像设置为始终适合显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:07:07.430

您正在寻找以下 CSS：

```
.headerimage{
    background-image: url(...);
    background-size: contain;
} 
```

这会调整背景图像的大小以与容器大小相对应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T00:08:31.443

您可以应用[媒体查询](https://developer.mozilla.org/en-US/docs/CSS/Media_queries)：

浏览器窗口宽度小于 1280px

```
@media (max-width: 1280px) {
   #myHeader {
      width: 50% // resize it to 50% when the browser screen is **LESS** than 1280px
   }
} 
```

浏览器窗口宽度大于 1280 像素但小于 2000 像素：

```
@media (min-width: 1280px) and (max-width: 2000px) {
   #myHeader {
      width: 75% // resize image at 75% when the browser screen is **BETWEEN** 1280px and 2000px    
   }
} 
```

浏览器窗口宽度大于 2000px：

```
@media (min-width: 2000px) {
  #myHeader {
      width: 100% // resize header to 100% when screen is **LARGER** than 2000px
  }
} 
```

所以..根据需要自定义断点和宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T00:08:58.727

是的，可以使用 javascript：

```
<script>
// first set viewport width and viewport height to vpw and vph
var w=window,d=document,e=d.documentElement,g=d.getElementsByTagName('body')[0],vpw=w.innerWidth||e.clientWidth||g.clientWidth,vph=w.innerHeight||e.clientHeight||g.clientHeight;

d.getElementById( "your_image_id" ).style.width( vpw+"px" );
</script> 
```

# c# - 如何将弱类型 JSON 转换为 C# 可读对象

> ID：14096005
> 
> 赞同：3
> 
> 时间：2012-12-31T00:02:45.617
> 
> 标签：c#, json, wcf, serialization

我有一个从非 .NET HTTP 请求读取 JSON 的 WCF 服务。我想使用 JSON.NET 或其他一些工具将该 JSON 转换为可以在 C# 的服务器端读取的弱类型对象。我希望不必为此过程创建 WCF 数据联系人。我不知道返回的 JSON 的完整架构。此外，它可能会有所不同。我正在寻找通用的东西。有关此任务的可用工具的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:41:25.430

它可能会有所不同，但您有一些固定的类型，对吗？你有适用于大多数情况的类型吗？

否则，也许您可​​以使用 DeserializeAnonymousType()

# ruby-on-rails - has_many 通过但具有唯一来源和多个关联

> ID：14096008
> 
> 赞同：1
> 
> 时间：2012-12-31T00:03:08.873
> 
> 标签：ruby-on-rails, ruby-on-rails-3, has-many-through

*   作为用户，我可以将我最喜欢的书添加到我的书单中。
*   另一个用户将同一本书添加到他们的书单中。
*   数据库中应该只有一个图书实例，但有 2 个用户/图书关联。

    ```
    class User
      has_many :bookReferences
      has_many :books, through: :bookReferences

    class Book
      validates_uniqueness_of :title
      has_many :bookReferences
      has_many :users, through: :bookReferences

    class BookReference
      belongs_to :user
      belongs_to :book 
    ```

**第一个问题是，如果这本书已经在系统中，则不会为第二个用户创建 bookReference，因为这本书不是唯一的。**

所以，如果这本书已经在系统中，我只想在 bookReference 表中创建关联记录。

**第二个问题，当用户删除一本书时，我只希望它删除对该书的引用，除非他们是唯一引用该书的用户。**

基本上，这是我试图实现的用法的完整概述：

```
 user1.books.first
      => id: 1, title: "Moby Dick"
    user2.books.first
      => id: 1, title: "Moby Dick"
    books.all
      => id: 1, title: "Moby Dick"

    user1.books.first.destroy
    user1.books.first
      => nil
    books.all
      => id: 1, title: "Moby Dick"
    user2.books.first
      => id: 1, title: "Moby Dick"
    user2.books.first.destroy
      => nil
    books.all
      => nil 
```

***更新***

基于这些答案，也许我不是很清楚。让我再试一次... book 控制器有一个基本的 CRUD 创建方法：

```
 def create
      current_user.books.create(name: params[:book][:title]) 
```

通过目前设置 has_many through 关联的方式，只有当它是唯一的时才会创建这本书。如果它已经在系统中，它将返回 false。我想要它做的是创建与现有书籍的关联，就好像它是一个新记录一样。这是我目前在我的应用程序中为实现此目的所做的，但感觉不对：

```
 def create
     book = Book.where(name: params[:book][:title]).first_or_create!
     BookReference.where(book_id: book.id, user_id: current_user.id).first_or_create! 
```

然后第二个问题是当用户从他们的帐户中删除一本书时。执行传统的 CRUD 销毁将从所有帐户中删除它：

```
 def destroy
      book = current_user.books.find(params[:id])
      book.destroy 
```

所以为了解决这个问题，我目前正在做以下事情。再一次，这感觉不“正确”：

```
 def destroy
      book = current_user.books.find(params[:id])
      # if book was unique to user
      if BookReference.where(book_id: book.id).count == 1
        # remove book from system
        book.destroy  
      else
        # remove book reference but not book
        current_user.books.delete(book)
      end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T19:43:15.737

当您通过关联使用 has_many 时，rails 会自动为您创建参考书目。

有很多通过在您的用户模型中创建一个名为 :book_ids 的“隐藏列”

因此，在您想要将一本书“保存”给您将使用的用户的表单中

```
<%= form_for (@user) do |f| %>
.
.
.
<%= f.label :book_ids %>
<%= f.select :book_ids, Book.all.collect {|x| [x.name, x.id]}, {}, :multiple => true %> 
```

您的 bookreference 应该会自动填充，并且您可以在视图中显示它。编辑和销毁也会自动为您完成。当您删除或编辑时，它将只是 bookreference 表。

如果您想了解有关协会的更多信息，可以访问

[http://api.rubyonrails.org/](http://api.rubyonrails.org/)

并搜索 ActiveRecord::Associations

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T03:09:39.483

我对 Rails 还是有点陌生​​，但这就是我想出的。

```
book = user1.books.first
if book.users.size > 1 
  user1.books.first.destroy
else
  book.destroy 
end
# in order to delete the book's dependency, you will need
class Book
has_many :bookReferences, :dependent => :destroy 
```

希望这可以帮助。

注意：当您有一个名为 like 的模型时`BookReference`，您将模型称为`:book_reference` 在您的情况下，您需要更改为

```
class User
  has_many :book_references
  has_many :books, through: :book_references

class Book
  validates_uniqueness_of :title
  has_many :book_references
  has_many :users, through: :book_references

class BookReference
  belongs_to :user
  belongs_to :book 
```

更新：

由于您希望在数据库中不存在新书时创建它，因此您可以利用的一种 rails 方法是`Book.find_or_create()`. 我不会详细介绍，但我觉得稍后你会想要一个自动完成功能来查找书籍。看看这个关于[Autocomplete](http://railscasts.com/episodes/102-auto-complete-association)的 railscast 。Ryan Bates 在设置自动完成并在未找到时创建新条目方面做得很好，这正是您所寻找的。

此外，如果您需要一种更简单的方法来允许用户添加多本书籍，这里还有一个 railscast 可以教您有关[Token Fields的知识](http://railscasts.com/episodes/258-token-fields)

# ios - 在不知道当前视图状态的情况下实现 openURL

> ID：14096009
> 
> 赞同：2
> 
> 时间：2012-12-31T00:03:23.593
> 
> 标签：ios, cocoa-touch, uiviewcontroller, url-scheme, appdelegate

我正在实现一个自定义 URL 方案，它将向我的数据模型添加实体。实体的详细信息包含在 URL 中。基本思想是电子邮件链接（或来自另一个应用程序的链接）将打开我的应用程序并添加新实体。

问题是，我永远无法确定我的应用在响应时会处于哪种状态。任何数量的视图控制器都可能在视图中。如果实体列表在视图中，我需要为该实体插入一个新行。如果屏幕上有其他视图，我需要做出不同的反应。一些视图也可能是模态的。

当这种情况发生时，我会对一个简单的模式感到满意——中止用户当前正在做的任何事情，然后弹出到根视图控制器。从这里我可能会推送到一个控制器，在那里我将显示正在添加的新实体。

我尝试总是关闭任何显示的模式并弹出到根目录，这样做的好处是不需要知道到底显示了什么：

```
[(UINavigationController *)self.window.rootViewController dismissViewControllerAnimated:NO completion:nil];
[(UINavigationController *)self.window.rootViewController popToRootViewControllerAnimated:NO]; 
```

这工作得相当好，但至少有两种情况是不够的：

1.  如果在显示模式时创建了某个对象（然后使用模式来修改新对象），并且如果用户取消，则委托负责删除该对象，则实体将保持活动状态。
2.  如果`UIActionSheet`显示 a，则所有赌注都关闭。如果不知道显示它的控制器，可以访问该控制器并向其发送消息以关闭操作表，我就无法关闭它。如果不这样做，将弹出根视图控制器，但操作表仍保留在屏幕上。操作表上的后续点击当然会导致崩溃，因为显示它的控制器已经消失。

我该如何稳健地处理这个问题？我是否应该尝试具体找出当前呈现的视图控制器，并依次处理每个场景？或者是否有一个更具可扩展性的解决方案，每次我添加控制器或更改应用程序的流程时都不需要更新？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T02:03:33.383

听起来您正在尝试做几件事：

1.  当用户点击您的自定义 url 时，您希望将“实体”添加到您的模型中。
2.  你想以某种形式显示这个新实体`EntityListViewController`，它可能在也可能不在 ViewController 堆栈上。
3.  您（可能）想要弹出`EntityListViewController`.
4.  您希望用户知道添加了一个新实体（可能只是通过执行第 2 项）。
5.  您想要推送某种`EntityViewController`，或者如果`EntityViewController`视图控制器堆栈中当前有 ，您想要重新加载新实体的数据。

听起来您已经准备好第 1 项，因为您没有明确询问有关处理 url 点击和插入新模型对象的问题。

剩下的，一个灵活的 MVC 模式将是使用 NSNotificationCenter。

插入新模型对象的代码将“发布”通知：

```
[[NSNotifcationCenter defaultCenter] postNotificationName:@"entity_added" object:myNewEntity]; 
```

然后，您的各种 UI 元素（例如，UIAlertView 和 UIViewController 子类）将侦听此通知并采取一些有用的操作（例如关闭它们自己，或者在 or 的情况下`EntityListViewController`，`EntityViewController`重新加载它们自己）。

例如，`UIViewController`子类可能会这样做：

```
-(void) viewDidLoad
{
  [super viewDidLoad];
  [[NSNoticationCenter defaultCenter] addObserver:self selector:@selector(onNewEntity:) name:@"entity_added" object:nil];

-(void) onNewEntity:(MyEntity*)entity
{
   // close, or redraw or...
}

-(void) dealloc
{
  [[NSNoticationCenter defaultCenter] removeObserver:self];
  // if not using ARC, also call [super dealloc];
} 
```

为了让你的生活保持简单（并且不要太担心所有不同的 UI 状态），我会考虑在通知发生时这样做：

1.  重绘本身（如果上面有`EntityListViewController`东西也没关系）。
2.  在导航栏中（或您​​知道始终可见的其他地方）显示某种短暂的指示器，或播放声音以便用户知道添加了实体。
3.  就这样。

如果您采用这种方法，那么对用户正在/正在做的事情的影响最小，但是当他们确实导航回时，`EntityListViewController`它已经显示了所有新实体。

显然，如果单击自定义 URL 可能会删除现有实体，那么弹出与该实体相关的任何视图控制器会更重要。但这也是你可以使用相同的模式来做的事情——让模型或控制器发布通知，然后让各种 UI 元素监听它并采取适当的行动。

# ormlite-servicestack - 是否可以使用 ServiceStack 和 OrmLite 进行模型优先的 ORM 映射？

> ID：14096012
> 
> 赞同：5
> 
> 时间：2012-12-31T00:04:03.183
> 
> 标签：ormlite-servicestack

这个周末我才第一次发现 ServiceStack，我觉得它非常棒。因此，我已经在将所有项目转换为它。然后我遇到了一个小障碍。

我找不到任何提到使用 OrmLite 首先从数据库开始然后将现有模式映射到 POCO 的文档。

我发现了大量关于代码优先的材料，但没有找到关于模型优先的材料。

有没有办法使用 OrmLiite 采取模型优先的方法？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T07:25:28.163

OrmLite 主要是代码优先的 ORM，但如果您想从现有数据库开始，您只需创建一个 POCO，其属性将 1:1 映射到现有表和列。

手动推断 POCO 很简单，但如果您需要一些代码生成工具来帮助执行此操作，OrmLite 包含[几个您可以使用的 T4 脚本](https://github.com/ServiceStack/ServiceStack.OrmLite/tree/master/src/T4)。

# java - 使用 keySet() 方法然后将 Set 更改为字符串数组？爪哇

> ID：14096019
> 
> 赞同：8
> 
> 时间：2012-12-31T00:05:07.340
> 
> 标签：java, set, treemap, arrays

所以这应该很简单，因为我知道这是可能的（我只是不太了解'Set'）。

所以基本上就有了这个TreeMap，我们就叫它aTree吧。所以我需要做类似的事情：

```
somethingHereProbably = aTree.keySet();
somethingHereProbably.toStringArray(); 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-12-31T00:15:12.393

你可以做

```
Map<String, Object> map = ...
String[] strings = map.keySet().toArray(new String[map.size()]); 
```

这适用于任何类型的地图，包括 TreeMap

# matlab - 如何将单元格的Matlab字符串CSV转换为矩阵的单独列？

> ID：14096022
> 
> 赞同：0
> 
> 时间：2012-12-31T00:05:22.233
> 
> 标签：matlab, csv, matrix, cell

如果我有一个用逗号分隔的字符串字符的 Matlab CELL 行，例如：

```
12/28/2012,00:00:01,0.99458,1,10518,0.99458,0.99483,0,0,0,0,-,-,-,b,-,C 
```

如何在矩阵中将每一个分隔成自己的列？这样做最有效的方法是什么？这可以做到吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T04:44:40.567

**更新：**刚刚意识到这个问题[与matlab中的how-to-convert-comma-separated-string-to-cell-array-of-strings-in-matlab](https://stackoverflow.com/questions/10535821/how-to-convert-comma-separated-string-to-cell-array-of-strings-in-matlab)重复，并且我的答案与@Jonas提供的答案重复。我将其标记为重复。

这是我知道的最有效的方法：

```
%# Build your string
Input = '12/28/2012,00:00:01,0.99458,1,10518,0.99458,0.99483,0,0,0,0,-,-,-,b,-,C';

%# Convert to cell array of strings
Output = regexp(Input, '([^,]*)', 'tokens');
Output = cat(2, Output{:}); 
```

需要注意的几点：

1）注意，无论`Input`是字符数组（即字符串）还是包含字符数组的单元格，这都将起作用。

2）我假设您希望输出是字符串的单元格数组。顺便说一句，我想不出另一种方法来使用 Matlab 将不同长度的字符串分组到单独的列中，而无需构建自己的自定义类。

3）@IlyaKobelevskiy 提供的解决方案会将字符串分组到单独的行（而不是列）中，因此基本上将您限制在单个观察范围内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T04:16:37.347

假设 str 是您的细胞系：

```
str ={'12/28/2012,00:00:01,0.99458,1,10518,0.99458,0.99483,0,0,0,0,-,-,-,b,-,C'};
ind=strfind(str{1},',');
len=diff([0 ind]);
sz=max(len);
A=zeros(length(ind),sz);
prev=1;
for i=1:length(ind)
    A(i,1:len(i)-1)=str{1}(prev:(ind(i)-1));
    prev=ind(i)+1;
end;
A=char(A); 
```

不确定这是否是最有效的方法，但应该可以...

# java - 双重抽象类继承和创建会话工厂失败（休眠）

> ID：14096024
> 
> 赞同：0
> 
> 时间：2012-12-31T00:05:26.353
> 
> 标签：java, hibernate, inheritance, sessionfactory

我正在研究 Hibernate，我需要两个抽象类。第一个，`Product`是主要的，数据库上应该没有名为`product`. 第二个抽象类是`ComPart`（继承自`Product`），并且一些计算机部件（如 gpu 和 cpu）是从此类继承的。应该只有一个名为的表`com_part`，并且 CPU 和 GPU 都应该在这个表中（每个层次结构的表）。

```
@MappedSuperclass
public abstract class Product{

    private long pID;
    protected String manufacturer;

    @Id
    @GeneratedValue(strategy = IDENTITY)
    @Column(name = "PID", unique = true, nullable = false)
    public int getPID() {
        return pID;
    }

    @Column(name = "Manufacturer")
    public String getManufacturer() {
        return manufacturer;
    }

}

// computer part abstract class inherited from Product
@Entity
@Table(name = "com_part")
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(
    name="disc",
    discriminatorType=DiscriminatorType.STRING
)
@AttributeOverrides({
    @AttributeOverride(name="manufacturer", column=@Column(name="Manufacturer"))
})
public abstract class ComPart extends Product {

    private String platform;

    @Column(name = "PLATFORM", length = 10)
    public String getPlatform() {
        return platform;
    }
}

// Various computer hardwares inherited from ComPart
@Entity
@Table(name="com_part")
@DiscriminatorValue("CPU")
public class Processor extends comPart {
    private String socketType;
    private String chipset;

    //getters setters...
}

@Entity
@Table(name="com_part")
@DiscriminatorValue("GPU")
public class GraphicsCard extends comPart {
    private double memory;

    //getters setters...
} 
```

我如何映射所有这些功能？上面的代码甚至不能创建会话工厂？！它会产生这些错误：

```
Failed to create sessionFactory object.java.lang.NullPointerException
Exception in thread "main" java.lang.ExceptionInInitializerError
    at com.bts.core.hb.HibernateUtil.<clinit>(HibernateUtil.java:35) 
```

和

```
Caused by: java.lang.NullPointerException
    at org.hibernate.cfg.Configuration.processFkSecondPassInOrder(Configuration.java:1424)
    at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1351)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1733)
    at com.bts.core.hb.HibernateUtil.<clinit>(HibernateUtil.java:32) 
```

# c++ - C++ 十进制数据类型

> ID：14096026
> 
> 赞同：40
> 
> 时间：2012-12-31T00:05:37.190
> 
> 标签：c++, types, floating-point, double, decimal

有没有办法在我的 C++ 程序中使用十进制数据类型，例如`decimal32`,`decimal64`或？`decimal128`

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-31T00:12:30.133

并非所有编译器都实现了[Decimal TR](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2009/n2849.pdf)中的类。一些编译器，例如[gcc](http://gcc.gnu.org)，实现了[C Decimal TR](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1312.pdf)并在 C++ 中提供了相应的扩展。过去有一个可用的 C++ Decimal TR 的开源实现，但我找不到它。如果您的编译器不支持小数类型，那么您最好的选择可能是为 IBM 的[decNumber library](http://speleotrove.com/decimal/decnumber.html)创建一个包装器。

为了改善 C++ 未来的情况，我[制定了更新 TR 的计划，](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2012/n3407.html)我将把当前的 TR 变成一个完整的提案，为下一次 C++ 委员会会议（4 月在布里斯托尔）准备，试图获得它被纳入 C++ 标准，可能会被纳入 2014 年计划的修订版。我的实现是我日常工作的一部分，我无法决定它是否可以公开提供，尽管有一些希望可以在某个时候开源。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-06-22T18:10:39.050

您可以使用易于使用的带有模板的 C++ 仅标头解决方案： [https ://github.com/vpiotr/decimal_for_cpp](https://github.com/vpiotr/decimal_for_cpp)

请注意，这不是**Big* *Decimal 类；它仅限于 64 位的“尾数”数字。

[取自链接]

```
 #include "decimal.h"

  using namespace dec;

  // the following declares currency variable with 2 decimal points
  // initialized with integer value (can be also floating-point)
  decimal<2> value(143125);

  // to use non-decimal constants you need to convert them to decimal
  value = value / decimal_cast<2>(333.0);

  // output values
  cout << "Result is: " << value << endl;
  // this should display something like "429.80"

  // to mix decimals with different precision use decimal_cast
  decimal<6> exchangeRate(12.1234);
  value = decimal_cast<2>(decimal_cast<6>(value) * exchangeRate);

  cout << "Result 2 is: " << value << endl;
  // this should display something like "5210.64"

  cout << "Result 2<6> is: " << decimal_cast<6>(value) << endl;
  // this should display something like "5210.640000" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-31T00:27:33.870

使用 int32 或 int64，并（手动）将小数点移动到您想要的位置。例如，如果您正在测量美元，只需测量美分并以不同的方式显示值。简单的！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-27T18:40:23.340

Boost 也有 cpp_dec_float。在标准被采用之前，这可能是最好的解决方案。

[https://www.boost.org/doc/libs/1_68_0/libs/multiprecision/doc/html/boost_multiprecision/tut/floats/cpp_dec_float.html](https://www.boost.org/doc/libs/1_68_0/libs/multiprecision/doc/html/boost_multiprecision/tut/floats/cpp_dec_float.html)

编辑：该库在实现中使用浮点值，因此不是真正的十进制数学库 IMO。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-08T05:13:36.490

gcc/clang（通常）带有它们自己的浮点十进制实现，如果您的发行版决定将它们编译成它们提供的任何 gcc/clang 版本（对于我尝试过的某些 arm 发行版来说不是这种情况）。这就是您有时需要自定义十进制类型实现的原因。试试[我](https://github.com/user1095108/fxl)的想法（在 i586 上一直测试到 aarch64）。

# c# - C# WPF 更新/删除按钮不起作用

> ID：14096031
> 
> 赞同：1
> 
> 时间：2012-12-31T00:06:50.190
> 
> 标签：c#, sql-server, wpf

我有一项任务是根据客户类别在 Northwind 数据库中执行插入、更新和删除操作。我设法完成了插入部分并认为这一切都完成了，因为代码应该是相似的，但是......我通过基本上复制插入并只是更改对存储过程的引用来编写更新，但是当我按下按钮时，什么也没有发生。代码 ：

```
 private void buttonUpdate_Click(object sender, RoutedEventArgs e)
    {
        SqlConnection cn = new SqlConnection(@"Integrated Security=SSPI;Initial Catalog=Northwind;Data Source=(local)");
        SqlCommand cmd = new SqlCommand("UpdateCustomer", cn);
        cmd.CommandType = CommandType.StoredProcedure;

        cmd.Parameters.AddWithValue("@CustomerID", "");
        cmd.Parameters.AddWithValue("@CompanyName", companyName);
        cmd.Parameters.AddWithValue("@ContactName", contactName);
        cmd.Parameters.AddWithValue("@ContactTitle", contactTitle);
        cmd.Parameters.AddWithValue("@Address", address);
        cmd.Parameters.AddWithValue("@City", city);
        cmd.Parameters.AddWithValue("@PostalCode", zip);
        cmd.Parameters.AddWithValue("@Phone", phone);

        cmd.Parameters.AddWithValue("@Region", "");
        cmd.Parameters.AddWithValue("@Country", "");
        cmd.Parameters.AddWithValue("@Fax", "");

        cn.Open();
        cmd.ExecuteNonQuery();
        cn.Close();
    } 
```

我的存储过程取自 MSDN：

```
 CREATE PROCEDURE [dbo].[UpdateCustomer]
    @CustomerID nchar(5),
    @CompanyName nvarchar(40),
    @ContactName nvarchar(30),
    @ContactTitle nvarchar(30),
    @Address nvarchar(60),
    @City nvarchar(15),
    @Region nvarchar(15),
    @PostalCode nvarchar(10),
    @Country nvarchar(15),
    @Phone nvarchar(24),
    @Fax nvarchar(24)
AS
UPDATE [dbo].[Customers]
   SET [CompanyName] = @CompanyName
      ,[ContactName] = @ContactName
      ,[ContactTitle] = @ContactTitle
      ,[Address] = @Address
      ,[City] = @City
      ,[Region] = @Region
      ,[PostalCode] = @PostalCode
      ,[Country] = @Country
      ,[Phone] = @Phone
      ,[Fax] = @Fax
 WHERE CustomerID=@CustomerID 
```

但没有任何改变。我究竟做错了什么？另外，我是否需要对级联做一些事情才能删除客户，因为这些表是组合在一起的。

这是一个基本项目，我不知道任何数据集和东西，所以在搜索了 1000 个网站后，我仍然无法弄清楚这个.. :( 任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:10:22.910

为了执行`UPDATE`特定客户的操作，您需要传递一个`CustomerID`：

```
 cmd.Parameters.AddWithValue("@CustomerID", "");  <- Don't pass an empty string here.. 
```

[不是问题的原因，但我会调查为什么您将`CustomerID`列定义为`nchar(5)`]

# android - ListView OnClickListener

> ID：14096042
> 
> 赞同：0
> 
> 时间：2012-12-31T00:08:27.057
> 
> 标签：android, listview, onclick, listener

这是我的问题：

我有一个聊天应用程序，消息显示在 ListView 中。ListView 填充屏幕的特定部分。如果用户单击 ListView，则应显示一个输入对话框。我的问题是我只能通过 onItemClickListener 识别对 ListView 的点击，但是当应用程序启动时，ListView 中没有可点击的项目。

我想到了 ListView 上的一个按钮：

```
<FrameLayout
android:layout_height="fill_parent"
android:layout_width="fill_parent"
android:orientation="vertical"
android:layout_marginTop="10dip"
>

  <ListView 
  android:layout_height="fill_parent" 
  android:layout_width="fill_parent" 
  android:id="@+id/ver_list" 
  android:stackFromBottom="true"
  android:cacheColorHint="#00000000"
  android:transcriptMode="alwaysScroll">
  </ListView>

  <Button 
   android:layout_height="fill_parent" 
   android:layout_width="fill_parent" 
   android:id="@+id/ver_listbutton" 
   android:background="@null"></Button> </FrameLayout> 
```

现在我可以识别对 ListView 空间的点击，上面有 Button。

但是使用 FrameLayout 我无法再滚动 ListView，因为它位于 Button 下方。

有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T00:30:29.077

您可以通过将按钮设置为列表视图的空视图，

```
public void setEmptyView(View emptyView) 
```

当listview为空时，会显示空view并处理click事件，当listview中有item时，空view会消失，然后listview可以处理click事件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-24T15:54:55.287

listView.setOnTouchListener(new OnTouchListener() {

```
 @Override
        public boolean onTouch(View v, MotionEvent event) {
            ListView list = (ListView) v;
            View child = list.getChildAt(list.getLastVisiblePosition());
            if (child != null) {
                int[] coords = new int[2];
                child.getLocationOnScreen(coords);
                if (event.getRawY() > coords[1] + child.getHeight()+20) {
                    //DO YOU STUFF
                    Toast.makeText(activity, "Outsize", Toast.LENGTH_SHORT).show();
                    return true;//you have handled the click, listview will not handle it
                }
            }

            return false; // listView handles click
        }
    }); 
```

# android - 列表已更新和绘制后，如何为单个项目（条目）设置动画？

> ID：14096044
> 
> 赞同：1
> 
> 时间：2012-12-31T00:08:31.840
> 
> 标签：android, android-listview, android-activity, android-animation

我`this.getListView()`在从 SQLite 数据库正确填充的 ListActivity 中有这个主 ListView（使用 检索）。单击其中一个项目（条目）调用另一个活动 A2，使用`startActivityForResult()`. 当用户返回 ListActivity 时，我想为 SINGLE 条目设置动画。（所以我想我需要覆盖该`onActivityResult()`方法）

一旦窗口获得焦点并使用更新列表后，如何为单个条目设置动画`notifyDataSetChanged()`？

我设法使用动画整个 ListView

```
getListView().setAnimation(anim) 
```

并且工作正常。但是，当我这样做时：

```
getListView().getChildAt(position).setAnimation(anim) 
```

什么都没发生。

**编辑**：这是我的 onActivityResult 代码

```
protected void onActivityResult(final int requestCode, final int resultCode, final Intent intent) {

    super.onActivityResult(requestCode, resultCode, intent);

    if(resultCode==RESULT_OK && requestCode==SOME_REQUEST_CODE){

        Animation anim = new AlphaAnimation(1.0f,0.0f);  
        anim.setFillAfter(true);  
        anim.setDuration(400); 
        anim.setRepeatMode(Animation.REVERSE);
        anim.setRepeatCount(7);
        // Just for testing, I chose the first item of the ListView (position=0)
        tr_adapter.getView(0, getListView().getChildAt(0), getListView()).setAnimation(anim);

        tr_adapter.notifyDataSetChanged(); //Nothing happens

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:37:26.893

在您的表格中设置一个标志并调用`notifyDataSetChanged()`您的列表适配器。`getView()`在您的列表适配器中根据表格中的标志确定要做什么（动画或不动画）。我会发布一些示例代码，但我是移动的。

编辑

* * *

在您的`onActivityResult()`, 标记（带有一些值、布尔值、1/0 等）中您想要动画的数据集中的数据点。然后调用`notifyDataSetChanged()`适配器。假设您有一个自定义列表适配器，让您的`getView()`函数打开或关闭动画（或默认为关闭并在给定标志的情况下将其打开）。

```
public View getView (int position, View convertView, ViewGroup parent){

    // All the standard getView() stuff

    if (listitem.shouldAnimate())
        // animate
} 
```

# ruby-on-rails - US-ASCII 数组中的无效字节序列

> ID：14096049
> 
> 赞同：0
> 
> 时间：2012-12-31T00:09:18.283
> 
> 标签：ruby-on-rails

我正在尝试将字符串放入rails中的数组中。我的问题是当这个数组中的元素不是英文时，它会给我这个奇怪的页面并说这个错误-ArgumentError in UsersController#my_profile

US-ASCII 中的无效字节序列

你知道我该怎么办吗？？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-10-22T07:13:42.370

如果你在 macOS 或 Linux 上，你可以通过这种方式启动 Middleman 来强制它使用 UTF-8：

```
LANG=en_US.UTF-8 LANGUAGE=en_US.UTF-8 LC_ALL=en_US.UTF-8 
```

不过，不确定Windows。

# c# - 在 C# 中模拟一个局部变量

> ID：14096050
> 
> 赞同：2
> 
> 时间：2012-12-31T00:09:29.493
> 
> 标签：c#, unit-testing, dependency-injection, mocking, moq

我有一个 C# 类，它自己实例化一个`NetworkCommunicator`类。我想`NetworkCommunicator`为我的单元测试模拟这个类，并用一个非常简单的存根替换它。

但是`NetworkCommunicator`永远不会作为参数传递。它是由正在测试的类创建的。

在 Ruby 中，这很容易模拟出来。在 Java 中，这就是你需要依赖注入的原因，这对于这个项目来说太重了。有没有一种简单的方法可以在 C# 中模拟它，也许使用`Moq`或类似的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T00:20:46.487

您提到 DI 对于这个项目来说太重了，为什么不尝试一些 Truck Driver 的 DI，因此：

```
public interface IDependency
{
    void DoSomeStuff();
}

public class ClassUnderTest
{
    private IDependency _dependency;

    public ClassUnderTest(IDependency dependency)
    {
        _dependency = dependency;
    }

    public ClassUnderTest() : this(new Dependency())
    {}

    public void ImportantStuff()
    {
        _dependency.DoSomeStuff();
    }
} 
```

使用这种构造函数链接技术，您现在可以随心所欲地模拟 IDependency，而不必担心连接 DI 或 IoC。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T00:16:10.673

您应该重构您的代码并传递依赖项。您还可以使用[typemock](http://www.typemock.com/)作为Visual Studio 2012 中更容易使用的替代品[。](http://msdn.microsoft.com/en-us/library/hh549175.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-31T00:26:12.470

创建一个继承自被测类的“TestClass”。用模拟实例覆盖该参数 在被测类上创建一个返回新实例的属性

```
public class ClassUnderTest {

public string MethodYouAreTesting(int someInput) {

var networkCommunicator = GetNetworkCommunicator();
// Do some stuff that I might want to test
return "foo";

}

public virtual NetworkCommunicator GetNetworkCommunicator {
    return new NetworkCommunicator();
}

}

[TestFixture]
public class ClassUnderTestTests {
public void GivenSomeCondition_MethodYouAreTesting_ReturnsFooString() {

var classToTest = new TestClassUnderTest();
var result = classToTest.MethodYouAreTesting(1);
Assert.That(result, Is.EqualTo("foo");

}
}

public class TestClassUnderTest : ClassUnderTest {

public override GetNetworkCommunicator {
return MockedNetworkCommunicator;
}

} 
```

我在“单元测试的艺术”中读到了这种技术，并在重构为完全 DI 没有意义或我正在测试的类不是我可以改变的东西时经常使用它。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T00:20:25.883

[有内置的 Fakes 系统，在http://msdn.microsoft.com/en-us/library/hh549175.aspx](http://msdn.microsoft.com/en-us/library/hh549175.aspx)中有很好的描述

如果这对您的用例来说太重了，您可能会发现[PrivateObject](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.privateobject.aspx)类更有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-31T12:06:59.467

> 我有一个 C# 类，它自己实例化一个 NetworkCommunicator 类。

正如您所注意到的，当您想模拟这个东西时，这是 C# 中的一个展示停止器。解决方案很简单，取决于实例化类的上下文/目的：

*   如果它是可重用组件，则将其作为依赖项注入
*   如果每次有需求时都应该创建它，则通过工厂提供它

无论哪种方式，**您都需要 DI**（第二个示例中的工厂也是自然注入的）。

> 在 Java 中，这就是你需要依赖注入的原因，这对于这个项目来说太重了。

依赖注入太重了吗？[DI是设计模式，只是在](http://en.wikipedia.org/wiki/Dependency_injection)*不需要*的时候使用它太重了。你的问题清楚地表明你需要它。也许您的意思是**DI 容器**对您的项目来说太重了？这可能是真的，因为根据项目的复杂性，您应该选择[适当的方式来应用 DI](http://blog.ploeh.dk/2012/11/06/WhenToUseADIContainer.aspx)。

[在应用像Greg Smith's](https://stackoverflow.com/a/14096127/343266) answer中提出的解决方案时，我想再提一点需要注意。本质上，您的 API 以构造函数结束：

```
public TestedClass() : this(new Dependency()) ...
public TestedClass(IDependency) ... 
```

乍一看很吸引人，但如果考虑到长远的眼光，就会出现几个问题：

*   `TestedClass` *必须有* 还是没有`IDependency`它可以做得很好？
*   什么*默认值*（无参数构造函数）默认为（正确使用它需要*实现细节级别的知识）？*
*   它创建了紧密耦合的组件（`TestedClass`组件可能必须引用其他组件 -`Dependency`的组件，即使它可能与它无关）

这是一个使用不同名称的反模式，例如[Bastard Injection](https://stackoverflow.com/questions/7099406/what-is-the-real-difference-between-bastard-injection-and-poor-mans-injectio)。当然，其中一些问题可能会得到缓解（例如使构造函数受保护/内部或在同一程序集中具有默认实现），但反模式及其长期后果仍然存在。另请注意，它绝不比常规 DI 更简单、更快或更少代码。

您将不得不问自己**什么是不那么繁重的**- 应用适当的 DI，或者使用反模式和/或 3rd 方框架（MS Fakes）来解决问题。

# javascript - 私有方法和特权方法的区别

> ID：14096054
> 
> 赞同：1
> 
> 时间：2012-12-31T00:10:09.383
> 
> 标签：javascript

假设我有这样的课程。

```
function kevin(name){
   this.name = name;
   this.methodKevin = function(){
        console.log(this.name);
   };
   var kevin = function(){
        console.log(this.name); 
   }
   function newKevin(){
        console.log(this.name);
   }
} 
```

1.  它们在javascript中有什么区别？
2.  我的班级是否完美，我的构造函数中可以有一个函数表达式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:15:41.853

这取决于它们是如何被调用的，并且由于有两个函数名为：`kevin`.

1.  `methodKevin`除非由 调用，否则将绑定到窗口对象`new kevin`，在这种情况下，它将绑定到顶级`kevin`函数对象。`this.name`只有在被实例化的函数调用时才会按预期工作`new`。
2.  `var kevin`是作用于父函数的函数`kevin`，因此它可能永远不会在该函数之外被调用。从这个意义上说，它是私人的。`this.name`会起作用，但`name`只有一个人就足够了。
3.  与 2 相同

# c - 2.4.20 版本的新编译内核在 sched.c 中初始化全局结构后无法启动

> ID：14096055
> 
> 赞同：0
> 
> 时间：2012-12-31T00:10:19.653
> 
> 标签：c, memory-management, linux-kernel, kernel, scheduler

您好，我正在尝试从内核版本 2.4.20 编译我的新内核。此外，我有一个头文件，其中包括结构的定义（一个用于定义链表和列表结构使用的节点）和两个在我的新系统调用文件中定义的函数原型`sample.c`。但是，当我在全局范围内定义一个列表并尝试`sched.c`在函数中进行分配时，`sched_init()`我的新内核版本没有打开。它在开始之前就卡住了。在这里你可以看到我的头文件和系统调用文件。

```
/* project_header.h */

#ifndef __LINUX_PROJECT_HEADER_H

#define __LINUX_PROJECT_HEADER_H

#include <linux/linkage.h>
#include <linux/vmalloc.h>

#endif

typedef struct node{

        struct node* next;
    struct node* prev;
        long project_pid;
    long project_ticket_number;

}PROJECT_NODE;

typedef struct{

        PROJECT_NODE* head;
        PROJECT_NODE* tail;
        int list_size;

}PROJECT_LIST;

PROJECT_LIST* project_init_list(void);
void project_add_node(PROJECT_LIST*, long); 
```

这是我实现的系统调用`sample`。如您所见，我必须在这里定义函数，原型在`project_header.h`其中，由两个 system_call 文件调用，它们是`fork.c`和`sched.c`

```
/* sample.c */

#include <linux/sample.h>
#include <linux/project_header.h>

long int maximum_ticket_number=0;
extern PROJECT_LIST* project_list;

PROJECT_LIST* project_init_list(void){

    PROJECT_LIST* list = vmalloc(sizeof(*list));

        list->list_size=0;
        list->head = NULL;
        list->tail = NULL;

    return list;
}

void project_add_node(PROJECT_LIST* list, long id){

     PROJECT_NODE* pnew;

     pnew = vmalloc(sizeof(*pnew));

     pnew->project_pid=id;

    maximum_ticket_number++;
    pnew->project_ticket_number=maximum_ticket_number;

    if(list->list_size==0){ // Assume list is empty

                   list->head = pnew;
                   list->tail = pnew;

                   list->list_size++;
    }
    else {

         list->tail->next = pnew;
         pnew->prev = list->tail;
         list->tail = pnew;

         list->list_size++;
         }

}

asmlinkage void sys_sample(void){ //System call does print the inital list size

        printk("LIST->SIZE = %d\n", project_list->list_size);

    return;
} 
```

这是添加到的部分`sched.c`

```
/* sched.c */
.
.

#include <linux/project_header.h>
#include <linux/sample.h>

PROJECT_LIST* project_list; // Create a list globally

extern PROJECT_LIST* project_init_list(void); // Provide to call project_init_list function which returns a list properly

.
.

void __init sched_init(void){

.
.
project_list = vmalloc(sizeof(*project_list)); //Allocate space and initialize the variables of main list
.
. 
```

这是内核启动之前我当前情况的快照

![在此处输入图像描述](../Images/7205016a06932c09c3aa431ab77bcd1e.png)

我确定问题出在`sched_init()`功能上，但我找不到。如果您能提供帮助和感谢，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T08:03:22.807

这不是一个真正的答案，因为这不是一个可以用给出的信息回答的问题。但它是“关于如何找出内核不启动原因的指导，以及关于内核如何启动的一些指导”。

printk() 是内核外 printf() 对应的内核函数。在你认为你要到达的地方添加它，以及你认为它可能失败的地方，例如，如果你有“myptr = vmalloc(...);”，那么

显然，如果您太早以至于内核还没有启动并且 printk 可能不可用，那么您将需要使用 out 的串行端口将是调试的方式 -

```
 mov $0x3fc, dx
  mov $65, al
  out al, dx 
```

将打印一个“A”（ascii 代码 65）到串行端口。不要一次敲出超过 16 个字符，它们只会以 9600 bps 或类似的速度输出。

顺便说一句，内核中唯一不处于保护模式的部分是几十条左右的指令。

但是，虚拟内存处理不会立即开始，事实上，您可能会发现它直到 AFTER THE SCHEDULING 并且“kswapper”进程开始后才起作用 - 这意味着您不能在调度程序中使用 vmalloc -我不确定，因为这不是我熟悉的 Linux 内核的一部分——但可能值得看一下 kmalloc，它是一个较低级别的内核功能。请注意，它们不是精确的替代品，因此您需要查看参数及其含义以及如何翻译。我不认为我曾经在内核中使用过 vmalloc() - 你确定这是正确的函数吗？

# python - 尝试将 sqlite 与 python shell 一起使用

> ID：14096057
> 
> 赞同：1
> 
> 时间：2012-12-31T00:10:25.157
> 
> 标签：python, sqlite

我刚得到python并输入：

sqlite test.db

..进入外壳，但出现语法错误..我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T00:20:33.497

我猜你做了以下？

```
$ python
Python 2.7.3 (default, Sep 26 2012, 21:51:14) 
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> sqlite test.db
  File "<stdin>", line 1
    sqlite test.db
              ^
SyntaxError: invalid syntax 
```

试试这个：

```
import sqlite3
conn = sqlite3.connect('test.db')
cursor = conn.cursor()
cursor.execute('''Your query goes here''') 
```

有关更多详细信息，请查看[python2](https://docs.python.org/2/library/sqlite3.html)或[python3的 sqlite 文档](https://docs.python.org/3/library/sqlite3.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-20T18:33:29.103

Python 不提供此命令行实用程序，因此请确保[sqlite3](https://www.sqlite.org/download.html)在您的路径中。然后你可以执行：

```
$ sqlite3 mydb.db 
```

或者，如果您在 settings.py 中输入了**设置**：

```
./manage.py dbshell 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T00:20:02.023

验证 PATH 中是否存在 sqlite 以及文件 test.db 的权限是什么

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T00:25:35.043

我想你想使用 sqlite3 命令行工具来创建一个新的数据库。为此，您应该使用系统终端而不是 python 控制台。所以命令应该看起来像这样（在 linux 系统上）：

```
$ sqlite3 test.db 
```

# android - Android setBackgroundResource 导致内存不足异常

> ID：14096061
> 
> 赞同：21
> 
> 时间：2012-12-31T00:11:06.407
> 
> 标签：android, exception, memory, android-viewpager, android-drawable

我正在开发一个在 ViewPager 中显示 12 个视图的游戏本应用程序。这是我的自定义 PagerAdapter ：

```
private class ImagePagerAdapter extends PagerAdapter {

    private int[] mImages = new int[] { R.drawable.copertinai,
            R.drawable.blui, R.drawable.azzurroi, R.drawable.rossoi,
            R.drawable.gialloi, R.drawable.verdei, R.drawable.rosai,
            R.drawable.grigioi, R.drawable.neroi, R.drawable.arancionei,
            R.drawable.marronei, R.drawable.violai, R.drawable.ulm };

    @Override
    public int getCount() {
        return mImages.length;
    }

    @Override
    public boolean isViewFromObject(View view, Object object) {
        return view == ((RelativeLayout) object);
    }

    @Override
    public Object instantiateItem(ViewGroup container, int position) {
        Context context = MainActivity.this;
        RelativeLayout relLayImageView = new RelativeLayout(context);
        relLayImageView.setBackgroundResource(mImages[position]);

        ((ViewPager) container).addView(relLayImageView, new LayoutParams(
                LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
        return relLayImageView;
    }

    @Override
    public void destroyItem(ViewGroup container, int position, Object object) {
        ((ViewPager) container).removeView((RelativeLayout) object);
        object=null; 
        System.gc();
    }
} 
```

在某些设备中，当调用这行代码时，它会随机导致内存不足异常

```
relLayImageView.setBackgroundResource(mImages[position]); 
```

但是在所有设备中，当我翻页时，我会在 logcat 中看到类似的内容：

```
12-31 00:25:31.655: I/dalvikvm-heap(9767): Grow heap (frag case) to 50.875MB for 10384016-byte allocation 
```

当在另一个 Activity 中我根据用户操作为主布局设置不同的背景资源时，该应用程序也会在某些设备中因同样的问题而崩溃。这里的代码：

```
 btn.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                colorButtons.get(indiceColoreAttuale).setBackgroundResource(
                                unSelectedColorsRes[indiceColoreAttuale]);

                switch (index) {
                case 0:
                    mainLayout.setBackgroundResource(R.drawable.blus);
                    break;
                case 1:
                    mainLayout
                            .setBackgroundResource(R.drawable.azzurros); 
                    break;
                case 2:
                    mainLayout
                            .setBackgroundResource(R.drawable.rossos);
                    break;
                case 3:
                    mainLayout
                            .setBackgroundResource(R.drawable.giallos);
                    break;
                case 4:
                    mainLayout
                            .setBackgroundResource(R.drawable.verdes);
                    break;
                case 5:
                    mainLayout
                            .setBackgroundResource(R.drawable.rosas);
                    break;
                case 6:                     
                    mainLayout
                            .setBackgroundResource(R.drawable.grigios);
                    break;
                case 7:
                    mainLayout
                            .setBackgroundResource(R.drawable.neros);
                    break;
                case 8:
                    mainLayout
                            .setBackgroundResource(R.drawable.arancios);
                    break;
                case 9:
                    mainLayout
                            .setBackgroundResource(R.drawable.marrones);
                    break;
                case 10:
                    mainLayout
                            .setBackgroundResource(R.drawable.violas);
                    break;
                }

                mainLayout.startAnimation(animationShowTextColor);
                mainLayout.setGravity(Gravity.CENTER_HORIZONTAL);
                indiceColoreAttuale = index;
                colorButtons.get(index).setBackgroundResource(
                        selectedColorsRes[index]);

            }
        }); 
```

当我在 mainLayout 上调用 setBackgroundResource() 时，它再次运行异常。

我希望你能帮助我解决这个问题，在此先感谢！

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-01-05T20:24:17.860

我解决了！你所有的提示都很好，但真正的问题是“/drawable”文件夹！我将所有图片都放在系统认为的“/drawable/mdpi”之类的“/drawable”通用文件夹中，所以当我在具有hdpi或更多的设备中运行时，图像被调整大小，并且变得太大导致OutOfMemoryException！

现在我正在使用“/drawable-nodpi”来存储我的图像。此文件夹的工作方式类似于“/drawable”，但图像永远不会调整大小！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-31T11:41:48.560

每个 Android 应用程序都有有限的内存（堆）可供 Dalvik VM 使用。在某些设备上是 32 MB，它是 64 MB。当您设置后台资源时，您将该资源加载到堆上。该资源作为位图加载 - 它的大小是宽度 * 高度 * 像素大小。通常位图作为 ARGB 图像加载，每个像素有 4 个字节。这意味着加载 1024x768 图像在堆上占用 1024*768*4 = 3145728 B = 3072 kB = 3 MB。当您加载大量大图像时，它会消耗所有可用的堆内存并导致内存不足异常。

要解决此问题，最好尽可能小地加载图像 - 当您显示图像的缩略图时，以不大于显示的具体部分的分辨率的分辨率加载它就足够了。这意味着当您在 800x600 显示器上显示图像时，加载 1024x768 图像是不够的。您可以使用 BitmapFactory 以较小的分辨率加载图像。

使用方法*decodeResource(activity.getResources(), R.drawable.imageId, opts)*。BitmapFactory.Options opts 具有参数[inSampleSize](http://developer.android.com/reference/android/graphics/BitmapFactory.Options.html#inSampleSize)，您可以在其中设置图像的子采样。在不需要透明度的情况下，参数[inPreferredConfig也可用于设置 RGB_565 而不是 ARGB_8888。](http://developer.android.com/reference/android/graphics/BitmapFactory.Options.html#inPreferredConfig)

# ruby-on-rails-3 - Rails - 创建一个之前的过滤器来检查它是否已经 7 天，然后添加新项目

> ID：14096063
> 
> 赞同：1
> 
> 时间：2012-12-31T00:11:19.570
> 
> 标签：ruby-on-rails-3, before-filter

我承认我不完全知道为什么前置过滤器是（或者即使它是）处理我的问题的最佳方法，但我被一位开发人员告诉过，他对 Rails 的了解比我多得多编程就是这样。所以我要努力让它发挥作用！

所以我要做的是检查数据库中的最新一本书是否是在 7 天或更早之前创建的，如果是，则创建一个新的。

这是我的图书控制器目前的样子：

```
class BooksController < ApplicationController
  before_filter :check_seven_days, :only => [:create]

...

def create
    @book = Book.new(params[:book])

    respond_to do |format|
      if @book.save
        format.html { redirect_to user_url(@book.user), notice: 'Book was successfully added to your queue.' }
        format.json { render json: @book, status: :created, location: @book }
      else
        format.html { render action: "new" }
        format.json { render json: @book.errors, status: :unprocessable_entity }
      end
    end
  end

...

protected
        def check_seven_days
            @user = User.find(params[:id])

            @not_queued_books = @user.books.not_queued

            @not_queued_books.each do |book|
                Book.new if book.created_at >= 7.days.ago
            end
        end

end 
```

然而，这并不完全有效......根本。before 过滤器中的代码或多或少是伪代码。我们会这样称呼它，因为我还在学习如何正确地编写 Ruby！但希望你能明白我想要做的事情:)

而且，你可以看到这是从哪里来的，我在模型中使用范围来检查一本书是否在 25 秒前被添加：

```
scope :queued, lambda { where('created_at > ?', 25.seconds.ago) }
  scope :not_queued, lambda { where('created_at <= ?', 25.seconds.ago) }
  scope :date_desc, order("created_at DESC") 
```

此外，视图循环（在用户显示视图中）如下所示：

```
<% @not_queued_books.date_desc.each do |book| %>
    <%= book.title %>
    <%= book.author %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:19:40.477

Book.new 只是实例化一个新的 Book 对象，不保存也不带任何参数；你的意思：

```
Book.create(params[:book]) 
```

?

# php - PHP将图像按比例调整为更大的尺寸

> ID：14096065
> 
> 赞同：2
> 
> 时间：2012-12-31T00:11:28.230
> 
> 标签：php, image-processing, resize, gd, scale

我目前正在编写一个在移动应用程序上显示网站缩略图的脚本，但我遇到了“视网膜显示”问题。如果原始图像足够大，我会以所需尺寸的两倍显示缩略图，如果不是，我会以所需尺寸显示。现在，我的函数检查它是否可以按比例调整大小，如果不能，我将其调整为“最小宽度”或“最小高度”并从中心裁剪它。

这是问题所在：如果它检测到图像无法以两倍大小显示，则“放大”裁剪后的大小，直到达到原始大小的限制，而我找不到缩放它的方法正确的。（我的主要问题是我不太擅长数学：P）。

对于更简单的讲座：

*   这是图像的原始尺寸：**600 x 301**
*   这是所需/裁剪尺寸：**320 x 180**
*   这是我想要得到的尺寸：**535 x 301**。我从 Photoshop 中得到它，它是放大 320x180 直到找到原始大小的限制的结果。

PS：我知道GD，所以只需要公式计算大小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T00:16:28.050

缩小规模的相同算法也可以扩大规模。这是未经测试的代码，它仅设计为按比例缩小，但如果您删除“按比例缩小”测试，它可能会为您解决问题。

```
<?php // RAY_image_resize_and_crop.php
error_reporting(E_ALL);

// RESIZE AN IMAGE PROPORTIONALLY AND CROP TO THE CENTER

function resize_and_crop($original_image_url, $thumb_image_url, $thumb_w, $thumb_h, $quality=75)
{
    // ACQUIRE THE ORIGINAL IMAGE: http://php.net/manual/en/function.imagecreatefromjpeg.php
    $original = imagecreatefromjpeg($original_image_url);
    if (!$original) return FALSE;

    // GET ORIGINAL IMAGE DIMENSIONS
    list($original_w, $original_h) = getimagesize($original_image_url);

    // RESIZE IMAGE AND PRESERVE PROPORTIONS
    $thumb_w_resize = $thumb_w;
    $thumb_h_resize = $thumb_h;
    if ($original_w > $original_h)
    {
        $thumb_h_ratio  = $thumb_h / $original_h;
        $thumb_w_resize = (int)round($original_w * $thumb_h_ratio);
    }
    else
    {
        $thumb_w_ratio  = $thumb_w / $original_w;
        $thumb_h_resize = (int)round($original_h * $thumb_w_ratio);
    }
    if ($thumb_w_resize < $thumb_w)
    {
        $thumb_h_ratio  = $thumb_w / $thumb_w_resize;
        $thumb_h_resize = (int)round($thumb_h * $thumb_h_ratio);
        $thumb_w_resize = $thumb_w;
    }

    // CREATE THE PROPORTIONAL IMAGE RESOURCE
    $thumb = imagecreatetruecolor($thumb_w_resize, $thumb_h_resize);
    if (!imagecopyresampled($thumb, $original, 0,0,0,0, $thumb_w_resize, $thumb_h_resize, $original_w, $original_h)) return FALSE;

    // ACTIVATE THIS TO STORE THE INTERMEDIATE IMAGE
    // imagejpeg($thumb, 'RAY_temp_' . $thumb_w_resize . 'x' . $thumb_h_resize . '.jpg', 100);

    // CREATE THE CENTERED CROPPED IMAGE TO THE SPECIFIED DIMENSIONS
    $final = imagecreatetruecolor($thumb_w, $thumb_h);

    $thumb_w_offset = 0;
    $thumb_h_offset = 0;
    if ($thumb_w < $thumb_w_resize)
    {
        $thumb_w_offset = (int)round(($thumb_w_resize - $thumb_w) / 2);
    }
    else
    {
        $thumb_h_offset = (int)round(($thumb_h_resize - $thumb_h) / 2);
    }

    if (!imagecopy($final, $thumb, 0,0, $thumb_w_offset, $thumb_h_offset, $thumb_w_resize, $thumb_h_resize)) return FALSE;

    // STORE THE FINAL IMAGE - WILL OVERWRITE $thumb_image_url
    if (!imagejpeg($final, $thumb_image_url, $quality)) return FALSE;
    return TRUE;
}

// USE CASE
echo '<a target="_blank" href="RAY_orig_600x374.jpg">Original 600x374</a><br/>';

resize_and_crop('RAY_orig_600x374.jpg', 'RAY_temp_100x100.jpg', 100, 100);
echo '<a target="_blank" href="RAY_temp_100x100.jpg">100x100</a><br/>';

resize_and_crop('RAY_orig_600x374.jpg', 'RAY_temp_200x100.jpg', 200, 100);
echo '<a target="_blank" href="RAY_temp_200x100.jpg">200x100</a><br/>';

resize_and_crop('RAY_orig_600x374.jpg', 'RAY_temp_200x300.jpg', 200, 300);
echo '<a target="_blank" href="RAY_temp_200x300.jpg">200x300</a><br/>'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T11:06:26.503

*（代表 OP 发布）：*

感谢Ray Paseur，我得到了这个功能：

```
function getAppropriateDimensionsForRetina($originalWidth,$originalHeight,$width,$height){
    $newWidth = $originalWidth;
    $newHeigth = $originalHeight;
    if($originalWidth > $originalHeight){
        $heightRatio = $originalHeight / $height;
        $newWidth = (int)floor($width * $heightRatio);
    }else{
        $widthRatio = $originalWidth / $width;
        $newHeigth = (int)floor($height * $widthRatio);
    }
    return array('width' => $newWidth,'height' => $newHeigth);
} 
```

# php - JQuery AJAX 发布和刷新页面内容而不重新加载页面

> ID：14096066
> 
> 赞同：2
> 
> 时间：2012-12-31T00:11:33.407
> 
> 标签：php, jquery, ajax, forms, wordpress

现在我知道我在这里有提出重复问题的风险，但是我真的不知道要搜索什么，因为我是一个完整的 AJAX jQuery 菜鸟。相信我，我已经尝试搜索我认为显而易见的东西，但没有运气，所以请放轻松。

我有一个 php wordpress 网站，默认以英镑显示价格。顶部是一个选择框`onchange="this.form.submit()"`，允许用户更改所有报价的默认货币。

```
<form method="post" action="">
    <select name="ChangeCurrency" onChange="this.form.submit()">
        <option value="GBP">GBP</option>
        <option value="USD">USD</option>
        <option value="EUR">EUR</option>
    </select>
</form> 
```

在主页上，有几个，我称之为**“简码小部件”**，每个都包含产品和价格表。如果您愿意，可以使用仪表板。

它目前是如何工作的（效率低下）：

1.  用户更改选择。
2.  提交的表格
3.  主页重新加载了所选货币的更新价格。

这不好，因为每当有人更改货币时，整个页面都会重新加载（这需要时间，在没有缓存的情况下传输大约 1mb，更不用说服务器上不必要的负载）。

我想要的（更高效）：

1.  更改选择框时，我希望异步发布更改货币会话变量的表单。
2.  每个“简码小部件”都会一一更新，而无需重新加载整个页面。

这是jquery可以做的事情吗？我从哪说起呢？

以防万一它有什么不同，以便您明白我的意思，这里是 URL，以便您可以看到我在说什么...... [http://bit.ly/10ChZys](http://bit.ly/10ChZys)

**第 2 部分：** 我使用 jQuery 和 ajax 来更新 fixTable，这要归功于以下答案的混搭...我使用会话变量来存储用户的选择，这样，如果他们返回站点，将保存该选项。

我的代码有问题，因为存储在[http://goldealers.co.uk/wp-content/plugins/gd/tables.php?currency=GBP&table=fixTable](http://goldealers.co.uk/wp-content/plugins/gd/tables.php?currency=GBP&table=fixTable)中的会话变量似乎与用户会话有不同的 session_id id 因为不再存储该选项。

有没有办法告诉服务器它们是同一个会话？

**解决方案** 我使用 Ribot 的解决方案开始，它工作并解决了最初的问题，然后扩展了 NomikOS 的解决方案......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:38:52.187

注意：这个答案显示了关于 AJAX 进程的 php 后端的一些想法。它是关于前端过程的其他答案的补充。

1.- 在 WP 中管理 AJAX 请求的模型，只是一些想法，好吗？

```
add_action('init', 'process_ajax_callback');

function process_ajax_callback()
{
    if ( ! $_REQUEST['go_ajax'])
    {
        return;
    }

    try
    {
        if (isset($_REQUEST['nonce_my_ajax']))
        {
            $nonce   = $_REQUEST['nonce_my_ajax'];
            if ( ! wp_verify_nonce($nonce    = $_REQUEST['nonce_my_ajax'], 'nonce_my_ajax'))
            {
                throw new Exception("Nonce token invalid."); // security
            }
        }
    }
    catch (Exception $e)
    {
        $output['result']    = false;
        $output['message']   = $e->getMessage();

        echo json_encode($output);
        exit;
    }

    $result  = true;
    $message = '';

    switch ($_REQUEST['action'])
    {
        case 'update_price':
        try
        {
            // update price
            // price value comes in $_REQUEST['price']
        }
        catch (Exception $e)
        {
            $result              = false;
            $message             = $e->getMessage();
        }
        break;      

        case 'other_actions':
        break;      
    }

    $output['result']    = $result ? true : false;
    $output['message']   = $message;

    echo json_encode($output);
    exit;
} 
```

2.-不要忘记安全

```
// nonce_my_ajax is passed to javascript like this:
wp_localize_script('my_js_admin', 'myJsVars', array(
    'nonce_my_ajax'  => wp_create_nonce('nonce_my_ajax')
)); 
```

3.- 一般来说，前端所需的（与上面显示的后端模型一起使用）是这样的：

```
$("select[name='ChangeCurrency']").live("change", function() {
    var price = $(this).val();
    $.post(
            window.location.href,
            {
                go_ajax : 1, // parse ajax
                action : 'update_price', // what to do
                price : price, // vars to use in backend
                nonce_my_ajax : myJsVars.nonce_my_ajax // security
            },
            function(output) {
            if ( output.result == true )
                // update widgets or whatever
                // $("#my_div").html("we happy, yabadabadoo!");
                // or do nothing (AJAX action was successful)
            else
                alert(output.message)
            }, 'json');
}); 
```

4.- 您可以使用`$.get()`or`$.post()`将数据发送/处理到服务器/服务器中，但`.load()`在更新数据库时效果不佳，因为您无法以`json`响应的精度管理返回的失败消息（例如：多重验证错误消息）。仅用于`.load()`加载 HTML 视图。

**更新：**

设置`session_id()`正常请求和ajax请求都可以执行的位置，并尽可能在早期阶段执行。我希望你使用一个类来包装你的插件，如果不是现在是时候做它......例如：

```
class my_plugin {

    function __construct()
    {
        if ( ! session_id())
        {
            session_start();
        }

        add_action('init', array($this, 'process_ajax_callback'));

        // ...
    }   

    function process_ajax_callback()
    {
        // ...
    }
} 
```

**更新 2：**

关于基于 nonce 的安全性：

> WordPress 中可用的安全功能是“nonce”。通常，“nonce”是一种只能使用一次的令牌，通常用于防止未经授权的人代表他人提交数据。
> 
> 参考： http: [//myatus.com/p/wordpress-caching-and-nonce-lifespan/](http://myatus.com/p/wordpress-caching-and-nonce-lifespan/)

在这个模型`nonce_my_ajax`中只是一个例子，确实它应该更独特，比如`nonce_{my_plugin_name}`，甚至更好`nonce_{my_plugin_name}_{what_action}`的地方`what_action`代表`updating user`，或`inserting new book`，等等......

有关它的更多信息：[WP Codex：WordPress](http://codex.wordpress.org/WordPress_Nonces) Nonce ，[WPtuts+：功能和 Nonce](http://wp.tutsplus.com/tutorials/creative-coding/capabilities-and-nonces/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:25:56.210

是的，jQuery 可以使用 ajax 来实现。

首先，在使用ajax时，你不必发布表单来获取数据。jQuery 中的 Ajax 将加载 url 的文本数据。

您可以先给您的选择一个 id（此处为 id="changeCurrency"），然后：

```
$("#changeCurrency").change(function(){
    currency = $('#changeCurrency option:selected').val() // get the selected option's value
    $("#some_div").load("someurl.php?currency=" + currency);
}); 
```

现在阅读 jQuery 和 ajax，了解您需要执行哪种 ajax 调用来最适合您的需求。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-31T00:20:49.347

删除 onchange 并添加一个 ID

```
<select name="ChangeCurrency" id="ChangeCurrency">... 
```

在页面上以您的基础货币为您的所有价格提供价格并输出它们

```
<span class="price" data-base="0.12">&pound;0.12</span> 
```

在你的 JS 中有一个转换表

```
// base currency is GBP
// each currency has 0: currency symbol, 1: conversion rate
var currency={"GBP":["&pound;", 1], "USD":["&dollar;", 0.67]};
var usercurrency=currency['GBP']; 
```

并将事件绑定到更改

```
$('#ChangeCurrency').on('change', function(){
    // post to the server to update it
    $.post(...);
    // set locally on the page
    usercurrency=currency[$(this).val()];
    // and change all the values
    $('.price').each(function(){
        $(this).html(usercurrency[0] + (usercurrency[1] * $(this).data('base')).toFixed(2) );
    });
}).trigger('change'); // trigger this to run on page load if you want. 
```

我没有检查任何这段代码

# git - Github 被拒绝

> ID：14096067
> 
> 赞同：0
> 
> 时间：2012-12-31T00:11:52.303
> 
> 标签：git, github

> **可能重复：**
> [为什么我不能将我的代码推送到 github？](https://stackoverflow.com/questions/8775399/why-i-cannot-push-my-code-to-github)

我正在尝试将 origin master 推送到 git hub，但我一直被拒绝，它提示我输入用户名和密码，我确信它是正确的。

这是我得到的错误

```
To https://github.com/anderskitson/omrails.git
 ! [rejected]        master -> master (non-fast-forward)
error: failed to push some refs to 'https://github.com/anderskitson/omrails.git'
To prevent you from losing history, non-fast-forward updates were rejected
Merge the remote changes (e.g. 'git pull') before pushing again.  See the
'Note about fast-forwards' section of 'git push --help' for details. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:13:05.797

先做

```
git pull 
```

那么你可以做

```
git push 
```

你被拒绝的原因是因为在服务器上有你本地没有的提交，所以你需要在推送之前合并它们。

颠覆也会发生同样的事情：你需要`svn up`在做`svn commit`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:13:34.847

拉一下。您的远程分支位于本地分支之前。

`git pull`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T00:18:57.940

github 上有一些您在本地存储库中没有的提交。推送您的更改将替换 github 上已经存在的更改，并且这些提交将丢失。

解决方案是拉入 github 更改并将它们合并到本地存储库中，然后您可以将更改推送到 github 而不必担心丢失这些更改。

你解决这个问题的方法是运行：

```
git pull 
```

如果该命令通知您任何冲突，请修复它们，然后添加并提交合并的文件。大多数时候你不会遇到任何冲突，所以你不必在这里做任何事情。

然后再次尝试推送：

```
git push 
```

# php - 如何获取 webroot 上方文件的内容（位于主目录）

> ID：14096077
> 
> 赞同：-2
> 
> 时间：2012-12-31T00:13:24.423
> 
> 标签：php, mysql, passwords

我想将我的数据库的密码存储到一个文件中，而不是按照许多回复者对此处相关答案的指示存储到 webroot 中。

我想从目录“~/”中读取文件。
怎么做？

我试过了`$file_content = file_get_contents("~/pass", true);`，但是当我`echo $file_content`什么也没打印出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T11:24:16.750

执行此操作的经典方法是在 Web 应用程序子目录中使用 config.php，设置数据库访问变量，如 $password。就安全性而言，“配置”太明显了。

此外，所有传递文件的 php 脚本都应该被限制性地编程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:05:38.917

如果您要上传到 FTP 服务器，请使用 FileZilla 之类的东西，您应该会看到您的文档根目录。

对我来说，它是 /home/myusername/public_html。如果您在 web 根目录上方的 myfolder 中有一个文件，假设它是 /home/myusername/myfolder/file。

然后做`file_get_contents(thingimentionedabove);`。

尽管我建议将您的文档放在 Web 根目录中，并通过 .htaccess 文件中的权限授予/禁止访问。

# jquery - jQuery-ui 选项卡：清除缓存

> ID：14096080
> 
> 赞同：1
> 
> 时间：2012-12-31T00:13:38.760
> 
> 标签：jquery, jquery-ui, jquery-ui-tabs

我需要清除已加载选项卡的缓存，以便在下一个选项卡上单击它会重新加载。[JQuery UI Tabs - Clear Cached Tab](https://stackoverflow.com/questions/8797486/jquery-ui-tabs-clear-cached-tab)的解决方案对我不起作用，我不知道出了什么问题。问题/答案未显示使用的实际代码，因此设置可能与我的略有不同。

有关我的用例，请参见[http://jsfiddle.net/A3SHj/](http://jsfiddle.net/A3SHj/)。

我的设置代码：

```
$(function() {
  $( "#tabs" ).tabs({
    //see http://docs.jquery.com/UI/Tabs#option-cache
    cache:true, //make click only load page once
    ajaxOptions: { cache: false }, //but don't cache the ajax request!
    active:0 //first tab is active
  });
}); 
```

我的清除缓存功能：

```
function clearTabsCache() {
  //see https://stackoverflow.com/questions/8797486/jquery-ui-tabs-clear-cached-tab
  $("#tabs .ui-tabs-nav a").removeData("cache.tabs");
} 
```

例如，使用 Chrome 的开发人员工具，您可以在网络面板中观察到“远程页面”选项卡中的 PNG 仅获取一次，在“清除选项卡缓存”后不会重新获取。（浏览器显示图像字节流的事实在这里并不重要。）

js代码`$("#tabs .ui-tabs-nav a")`正确选择了2个tab，removeData()方法成功，但是没有任何变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T06:26:30.960

正如这里提到的答案

[JQuery UI 选项卡缓存](https://stackoverflow.com/questions/2624228/jquery-ui-tabs-caching/3623807#3623807)

这将为您解决问题。您可以控制单个选项卡的缓存

在您使用上述答案的情况下，只需使用

```
$("#tabs").tabs({
cache: true,
itemOptions: [
    { cache: true },
    { cache: false }
]
}); 
```

# iphone - 运动应用程序的 CoreData

> ID：14096084
> 
> 赞同：0
> 
> 时间：2012-12-31T00:14:55.860
> 
> 标签：iphone, ios, core-data

我正在创建我的第一个 iPhone 应用程序。这是一个锻炼日志，允许用户使用 GPS 跟踪跑步，然后能够保存路线图以及时间/距离并将其上传到网站。本地运行列表也将保存在设备上。我的问题是，实现地图保存和检索的最佳方式是什么？我记得在某处读过，这样做的方法是拥有具有纬度和经度属性的实体，然后在绘制地图时按时间反向获取这些实体。这意味着每个实体都是运行期间的一个点。有没有办法将所有坐标存储在一个实体的数组中，以便一个实体代表整个运行？

自从我是应用程序开发的新手以来，我并没有真正研究过关系，但似乎我可以使用关系来存储运行？如中，让父实体成为运行，并让目的地之一成为该运行的所有坐标实体。这听起来正确吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:57:19.460

作为一个实体运行是有道理的。对于沿途的路点，建议采用 1 对多基数的关系（即，一次运行有多个路点）。运行的属性可能包括开始时间/日期、结束时间/日期。航路点属性可能是纬度、经度、高度、日期/时间。您可能希望尝试在运行期间决定如何记录航路点。也许每分钟收集一次，或者基于从最后一个航路点移动一定距离。

日期/时间最早的航点为起点，日期/时间最晚的航点为终点。

有了上面的内容，您可以在地图上绘制路线，计算航点之间的速度、平均速度、总距离，以及可能基于高度变化的某种难度因素。

# node.js - Node.js 应用程序在注册模块时抛出错误

> ID：14096085
> 
> 赞同：0
> 
> 时间：2012-12-31T00:15:02.797
> 
> 标签：node.js, webmatrix

我在[这里](http://blog.stevensanderson.com/2012/07/10/node-js-development-with-webmatrix-2-express-part-2/)关注 Steven Sanderson 的视频以开始使用 NodeJS。我已经安装`EJS`和`ejs-middleware`模块。server.js 如下所示：

```
var express=require('express'),
app = express(),
ejsMiddleware = require('ejs-middleware');

app.use(ejsMiddleware(__dirname + '/static', 'html', app)); 
```

但它会抛出异常，例如：

```
app.use(ejsMiddleware(__dirname + '/static', 'html', app)); 
```

例外是：

```
Application has thrown an uncaught exception and is terminated:
TypeError: Object function app(req, res){ app.handle(req, res); } has no method 'register'
    at C:\Users\...Inventify\node_modules\ejs-middleware\ejs-middleware.js:9:23
    at Object.<anonymous> (C:\Users\...Inventify\server.js:8:9)
    at Module._compile (module.js:446:26)
    at Object..js (module.js:464:10)
    at Module.load (module.js:353:31)
    at Function._load (module.js:311:12)
    at Module.require (module.js:359:17)
    at require (module.js:375:17)
    at Object.<anonymous> (C:\Program Files (x86)\iisnode-dev\release\x86\interceptor.js:211:1)
    at Module._compile (module.js:446:26) 
```

我无法得到它的任何头部或尾部。请帮我。

编辑：-根据@Peter Lyons的[这个答案](https://stackoverflow.com/a/14096857/13198)进行了以下更改：

**老的**

```
registerInApp.register('.' + extension, ejs); 
```

**新的**

```
registerInApp.engine('.' + extension, require(ejs)); 
```

但现在得到以下异常：

```
TypeError: Object #<Object> has no method 'substring'
    at Function._resolveLookupPaths (module.js:235:23)
    at Function._resolveFilename (module.js:327:31)
    at Function._load (module.js:279:25)
    at Module.require (module.js:359:17)
    at require (module.js:375:17)
    at C:\Users\...Inventify\node_modules\ejs-middleware\ejs-middleware.js:10:47
    at Object.<anonymous> (C:\Users\...Inventify\server.js:12:9)
    at Module._compile (module.js:446:26)
    at Object..js (module.js:464:10)
    at Module.load (module.js:353:31) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:40:23.680

It looks like `ejs-middleware` needs to be updated to call `app.engine` instead of `app.register` to work with express 3.0\. As a workaround, don't pass the `app` argument to the ejsMiddleware function and instead manually register it yourself:

```
app.engine('.html', require('ejs').renderFile); 
```

I updated that. It's actually straight from the [express.js documentation for app.engine](http://expressjs.com/api.html#app.engine). From what I can tell (I don't use ejs personally), it looks like you don't need `ejs-middleware` at all and can just use `visionmedia/ejs` and be done with it.

# objective-c - 带有多个 OR / Objective-C 的“if-else”

> ID：14096089
> 
> 赞同：2
> 
> 时间：2012-12-31T00:15:52.980
> 
> 标签：objective-c, if-statement, operators, conditional

我有一个问题，但我无法找到答案。有什么办法可以减少Objective-C中的以下表达式？

```
if ((r != 1) && (r != 5) && (r != 7) && (r != 12)) {
   // The condition is satisfied
}else{
   // The condition isn't satisfied
} 
```

例如（不工作）：

```
if (r != (1 || 5 || 7 || 12)) {
   // The condition is satisfied
}else{
   // The condition isn't satisfied
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T00:20:25.410

您可以使用`NSSet`，如下所示：

```
NSSet *prohibited = [NSSet setWithArray:@[@1, @5, @7, @12]];
if (![prohibited containsObject:[NSNumber numberWithInt:r]]) {
    // The condition is satisfied
} else {
    // The condition isn't satisfied
} 
```

如果一组数字包含一组固定的数字，例如在您的示例中，您可以创建`NSSet *prohobited`一个静态变量，并对其进行一次初始化，而不是像我上面的示例中那样每次都进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T06:18:09.940

你也可以`switch`像这样使用

```
switch (r)
{
    case 1:
    case 5:
    case 7:
    case 12:
        // r is having 1,5,7 or 12
        break;
    default:
        // r is having other values
} 
```

# android - 获取在运行时确定的片段页面标题

> ID：14096095
> 
> 赞同：0
> 
> 时间：2012-12-31T00:16:40.090
> 
> 标签：android, android-fragments

我正在使用`FragmentPagerAdapter`包含两个片段。两个片段从扩展片段的抽象片段扩展。我无法在创建片段时获取片段的页面标题，因为标题作为参数传递给片段：
FragmentActivity 的内部类：

```
ArrayList<AbstractFragment> fragments = new ArrayList<AbstractFragment >();
public class SectionsPagerAdapter extends FragmentPagerAdapter {

        public SectionsPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int position) {

            return fragments.get(position);

        }

        @Override
        public int getCount() {

            return fragments.size();

    }

            @Override
            public CharSequence getPageTitle(int position) {

                return fragments.get(position).getTitle();

            }

        } 
```

抽象片段：

```
protected Bundle data;
    protected String title;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        data=this.getArguments();
        numberSetData=data.getParcelableArrayList(KEY_CHART_DATA);
        title=data.getString(KEY_CHART_TITLE);
        //Title should is determined here.
    }
public abstract String getTitle(); 
```

具体片段：

```
@Override
    public String getTitle(){
        return title;
    } 
```

![在此处输入图像描述](../Images/4ae430ad951118dda3f5fb0460072662.png)

如果我滑动到下一个片段，问题就解决了，标题会出现，但在创建时不会出现。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:22:29.220

你在一个尚未被要求的`getTitle`地方打电话。一个已知的解决方法是检查是否已被调用，如果没有则返回。`onCreate``Fragment``onCreate``data.getString(KEY_CHART_TITLE)`

```
public String getTitle()
{
    if( title == null )
    {
        title = getArguments().getString(KEY_CHART_TITLE);
    }
    return title;
} 
```

# c++ - 遍历 taglib 属性映射

> ID：14096096
> 
> 赞同：3
> 
> 时间：2012-12-31T00:16:46.580
> 
> 标签：c++, dictionary, taglib

晚上好，

最近我发现了[taglib](http://taglib.github.com/)库。这是一个非常好的方法，但我找不到在属性映射中获取未知键的键和值的可能性（换句话说，迭代映射）。

此代码用于获取地图：

```
TagLib::FileRef file(file_path);
TagLib::PropertyMap map = file.tag()->properties(); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T00:26:41.917

您可以像迭代标准容器一样进行迭代：

```
for (auto it = map.begin(); it != map.end(); it++) {
    // Do something with it.
} 
```

文档显示[`PropertyMap`](http://taglib.github.com/api/classTagLib_1_1PropertyMap.html)extends [`List<T>`](http://taglib.github.com/api/classTagLib_1_1List.html#a5461a9c274eec6f5c2a628b9a077b4e6)，这似乎满足所有容器要求。

# php - open_basedir 限制生效 第 0 行未知？

> ID：14096097
> 
> 赞同：4
> 
> 时间：2012-12-31T00:16:46.073
> 
> 标签：php, file, testing, host, open-basedir

我不断在不同时间为每一页收到这些消息。第0行是什么意思？现在我正在使用来自主机（子域）的免费域名，并且我正在使用免费托管来测试我的网站。出于私人原因，我将这个标志->..放在下面以替换真实姓名。我的主人甚至无法解决这个问题。我只访问帐户中的文件和文件夹。我想我的托管类型不好？谢谢

> 警告：未知：open_basedir 限制生效。文件（/home/v1/sweet/123/htdocs/subscribe.php）不在允许的路径内：（/php_sessions:/tmp:/var/www/errors:/home/v1/bill/t/ htdocs) 在第 0 行的未知中
> 
> 警告：未知：无法打开流：第 0 行的未知中不允许操作
> 
> 致命错误：未知：在第 0 行的未知中打开所需的 '/home/v1/sweet/123/htdocs/subscribe.php' (include_path='.') 失败

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T00:28:56.610

`open_basedir restriction in effect [...] on line 0`意味着`open_basedir`PHP 本身打开脚本的限制太大。

你可以看到那`/home/v1/sweet`不在你的`open_basedir`里面，在下面`/home/v1/bill/`。

# android - Android 上的 GPS 检查器未启动对话框

> ID：14096099
> 
> 赞同：0
> 
> 时间：2012-12-31T00:17:03.977
> 
> 标签：android, error-handling, gps

因此，我了解如果未启用 GPS，如何在 Android 上启动 GPS 窗口，但是在我的情况下，代码没有启动（尽管我班级中的所有其他 gps 功能都运行良好）我正在执行以下操作：

```
 // CHECK GPS!
    gps = new gpstracker(MainActivity.this);
    if (gps.canGetLocation()) {
    } else {
        final ComponentName toLaunch = new ComponentName("com.android.settings","com.android.settings.SecuritySettings");
        final Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
        startActivity(intent);

            } 
```

当我在 if 语句之外运行以下内容时，它运行良好：

```
 final ComponentName toLaunch = new ComponentName("com.android.settings","com.android.settings.SecuritySettings");
        final Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
        startActivity(intent); 
```

我只是不知道为什么 gps 知道它无法获取位置但未能触发语句的 else 部分。我附上了我正在使用的 GPS 类。

gps 类 [https://gist.github.com/4416280](https://gist.github.com/4416280)

# android - Android - ListView 未更新

> ID：14096104
> 
> 赞同：0
> 
> 时间：2012-12-31T00:17:37.237
> 
> 标签：android, android-layout, android-listview

有人请解释为什么当我在对话框（AlertDialog）之后保存应用程序设置（SharedPreferences），并以以下方式更新ListAdapter项目中的数据`mListItems.get(viewPosition).setValue(prefsIntValue);`（`mListItems`- 是主要活动的成员）。关闭对话框窗口后**，ListView 中的视图被更新**，当我尝试在方法中执行相同的操作`onActivityResult`（在其他活动完成时更新数据）时，什么也没有发生，换句话说，**视图没有更新。**一种答案在这里是[notifyDataSetChanged 示例](https://stackoverflow.com/questions/3669325/notifydatasetchanged-example)，但是为什么第一种情况（在对话框之后）起作用！？

**UPD：**`notifyDataSetChanged`在我更改方法中的列表数据后调用有`onActivityResult`帮助！但是请有人解释一下为什么在第一种情况下，在保存首选项时，它起作用了？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:06:42.567

找到了答案，因为在我关闭 AlertDialog 窗口后调用了方法`onWindowFocusChanged` [http://androidxref.com/4.2_r1/xref/frameworks/base/core/java/android/widget/AbsListView.java#2646](http://androidxref.com/4.2_r1/xref/frameworks/base/core/java/android/widget/AbsListView.java#2646)，布局​​列表视图正在重绘通过调用`layoutChildren`上面的方法，所有的魔法都会发生。

# html - 绝对位置不适用于 Firefox 12+ 中的伪元素

> ID：14096105
> 
> 赞同：2
> 
> 时间：2012-12-31T00:17:39.720
> 
> 标签：html, css, firefox

我在 Firefox 12+（可能更早）中的伪元素上的定位有问题。该元素看起来好像相对于页面但是我`position:relative`在锚标记上确实有。有什么建议么 ？

**HTML**

```
<a href="http://localhost:8888/wordpress/test-file/Test-File/" rel="attachment wp-att-150">Test File</a> 
```

**CSS**

```
a[rel~="attachment"] {
  display: inline-block;
  position: relative;
  background: #EAE3EA;
  height: 64px;
  border-radius: 7px;
  -moz-border-radius: 7px;
  -webkit-border-radius: 7px;
  border-radius: 7px;
  -khtml-border-radius: 7px;
  border: 3px solid #515151;
  display: table-cell;
  text-align: center;
  vertical-align: middle;
  padding: 0 5px 0 47px;
  font-weight: 400;
}

a[rel~="attachment"]::before {
  content: '';
  background: url(img/file.png) no-repeat;
  width: 37px;
  height: 48px;
  top: 5px;
  left: 5px;
  position: absolute;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T00:38:22.343

除了使用相对定位，您可以使用边距来定位`a::before`请记住，您可以使用负边距，这样您就可以充分控制元素的定位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:27:35.033

你覆盖了

```
display: inline-block; 
```

和

```
display: table-cell 
```

也许使用显示内联块可以解决问题

# python - Python ElementTree - 打印出命名空间定义？

> ID：14096106
> 
> 赞同：1
> 
> 时间：2012-12-31T00:17:40.903
> 
> 标签：python, xml, elementtree

我正在使用 Python 的 elementtree 来解析一些 XML 配置文件。

在文件的顶部，我有一个像这样的根元素：

```
<?xml version="1.0" encoding="utf-8"?>
<sgx:FooConfig
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:foo="http://ns.au.firm.com/foo.xsd"
  xmlns:bar="http://ns.au.firm.com/bar.xsd"
  > 
```

问题是，`bar`命名空间可以设置为两个不同的 XSD 之一，具体取决于配置文件的版本。

我正在寻找一种使用 ElementTree 打印命名空间映射的方法，这样我就可以检查正在使用两个 XSD 中的哪一个 - 然后我可以让我的代码来处理正确的情况。

有没有办法使用 Python 打印出所有的命名空间定义？

干杯，维克多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T00:46:34.740

你所拥有的是无效的 xml（未定义的前缀），我认为你不能这样做，`xml.etree`但你应该能够使用`lxml`.

```
import lxml.etree as et
tree = et.XML(yourxml)
print tree.nsmap 
```

# jquery - jQuery - 有没有更简单的方法来写这个？

> ID：14096107
> 
> 赞同：8
> 
> 时间：2012-12-31T00:17:56.700
> 
> 标签：jquery, wizard

我是一个新程序员，所以如果这个业余爱好者......我正在寻找一些方向，或者可能是一些想法。我的目标是让我学习，所以任何朝着正确方向的推动都会受到重视。

好的.. 我挑战自己为使用 jQuery 的简单注册表单创建一个类似“向导”的控件。我可以很好地完成这些步骤，但是我正在查看我的代码，我忍不住想；“必须有更好、更容易和正确的方法来做到这一点”。这就是我所拥有的。

```
function toggleStep(){
        $("#nextButton").click(function(){
            if($("#nextButton").name = "step1"){
                $("#nextButton").attr("name", "step2");

                $("#backButton").attr("name", "step1").css("display", "inline");

                $("#step1").hide();
                $("#step2").show("fade", 250);
            }
            $("#nextButton").click(function(){
                if($("#nextButton").name = "step2"){
                    $("#nextButton").attr("name", "step3");

                    $("#backButton").attr("name", "step2");

                    $("#step2").hide();
                    $("#step3").show("fade", 250);
                }
                    $("#nextButton").click(function(){
                        if($("#nextButton").name = "step3"){
                            $("#nextButton").attr("name", "step4");
                            $("#nextButton").css("display", "none");

                            $("#backButton").attr("name", "step3");

                            $("#step3").hide();
                            $("#step4").show("fade", 250);
                        }
                });
            });
        }); 
    } 
```

此外，在创建“后退按钮”功能时，我似乎把自己搞砸了。这段代码根本不够好。你会如何处理这个问题？谢谢！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T00:20:53.417

我只会使用 jquery 来切换一个 class="activeStep" 并用 css 完成其余的（隐藏、显示、褪色）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T00:37:11.650

您可能想研究 jQuery 的[prev()](http://api.jquery.com/prev/)和[next()](http://api.jquery.com/next/)方法。结合基于步骤类名（而不是 DOM id）的逻辑，这些方法可以很容易地缩短和简化您的代码。

一个粗略的详细示例：

```
$('#nextButton').click(
    function() {
        var current_step = $('#steps_container').find('.step:visible');
        var next_step    = current_step.next();
        if (next_step.length) {
            current_step.hide();
            next_step.fadeIn(250);
        }
    }
);

$('#prevButton').click(
    function() {
        var current_step = $('#steps_container').find('.step:visible');
        var prev_step    = current_step.prev();
        if (prev_step.length) {
            current_step.hide();
            prev_step.fadeIn(250);
        }

    }
); 
```

这应该可以很好地处理以下标记中的任意数量的步骤：

```
<div id="steps_container">
    <div class="step">Step 1</div>
    <div class="step">Step 2</div>
    <div class="step">Step 3</div>
    <div class="step">Step 4</div>
    <div class="step">Step 5</div>
    <div class="step">Step 6</div>
    ...
</div> 
```

* * *

只要@stefanz 对我的代码进行改进，一个更简单、更通用的方法也可以将导航按钮的处理程序绑定到一个类，如下所示：

```
$('.steps_nav_buttons_bar .steps_nav_button').click(
    function() {
        var current_step = $('#steps_container').find('.step:visible'),
            new_step     = $(this).hasClass('next') ? current_step.next() : current_step.prev();

        if (new_step.length) {
            current_step.fadeOut('fast',function() { new_step.fadeIn('fast') })
        }
     }
); 
```

这样做的好处是它允许您添加一组以上的导航按钮，例如，如果您希望导航栏位于顶部和底部：

```
<div class="steps_nav_buttons_bar top_bar">
    <div class="steps_nav_button prev">Prev</div>
    <div class="steps_nav_button next">Next</div>
</div>

<div id="steps_container">
    <div class="step">Step 1</div>
    <div class="step">Step 2</div>
    <div class="step">Step 3</div>
    <div class="step">Step 4</div>
    <div class="step">Step 5</div>
    <div class="step">Step 6</div>
    ...
</div>

<div class="steps_nav_buttons_bar bottom_bar">
    <div class="steps_nav_button prev">Prev</div>
    <div class="steps_nav_button next">Next</div>
</div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T01:05:08.370

我编辑了@Boaz 代码，现在[你得到](http://jsfiddle.net/stefanz/3T8Ff/1/)了一些干净的东西，我想这也可以帮助你更好地理解。我还添加了一些评论。

jQuery代码变成

```
 $('#next, #prev').click(function(){
    var t = $(this),
        current = $('#steps_container').find( '.step:visible' ),
        stepGo = ( t.attr( 'id' ) == 'next' ? current.next() : current.prev() );

    if ( stepGo.length ) {
      current.fadeOut( 'slow', function(){

        stepGo.fadeIn( 'slow' );
      });
    };
    return false;
  }); 
```

# objective-c - Objective-c 计时器不会失效

> ID：14096108
> 
> 赞同：0
> 
> 时间：2012-12-31T00:18:02.463
> 
> 标签：objective-c, timer, nstimer, invalidation

这是我的情况：我正在制作一个倒计时应用程序，它运行良好，但在我打电话时似乎没有停止，`[stopWatchTimer invalidate];`我不知道为什么。这是我的代码：

```
- (IBAction)btnStartPressed:(id)sender {
//Start countdown with the time on the Date Picker.

    timeLeft = [pkrTime countDownDuration];

    [self currentCount];

    lblTimer.text = time; //sets the label to the time set above

    pkrTime.hidden = YES;
    btnStart.hidden = YES;
    btnStop.hidden = NO;

    //Fire this timer every second.
    stopWatchTimer = [NSTimer scheduledTimerWithTimeInterval:1.0/1.0
                                                  target:self
                                                selector:@selector(reduceTimeLeft:)
                                                userInfo:nil
                                                 repeats:YES];
}
- (void)reduceTimeLeft:(NSTimer *)timer {
    //Countown timeleft by a second each time this function is called
    timeLeft--;
    // Get the system calendar
    NSCalendar *sysCalendar = [NSCalendar currentCalendar];

    // Create the NSDates
    NSDate *date1 = [[NSDate alloc] init];
    NSDate *date2 = [[NSDate alloc] initWithTimeInterval:timeLeft sinceDate:date1];

    // Get conversion to months, days, hours, minutes
    unsigned int unitFlags = NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit;

    NSDateComponents *conversionInfo = [sysCalendar components:unitFlags fromDate:date1  toDate:date2  options:0];

    int sec = [conversionInfo second];
    int min = [conversionInfo minute];
    int hour = [conversionInfo hour];

    NSString *seconds = [NSString stringWithFormat:@"%d",sec];
    NSString *minutes = [NSString stringWithFormat:@"%d",min];

    if (sec <= 9)
        seconds = [NSString stringWithFormat:@"0%d", sec];
    if (min <= 9)
        minutes = [NSString stringWithFormat:@"0%d", min];

    if ([conversionInfo hour] == 0)
        time = [NSString stringWithFormat:@"%@:%@", minutes, seconds];
    else
        time = [NSString stringWithFormat:@"%d:%@:%@", hour, minutes, seconds];

    lblTimer.text = time; //sets the label to the time set above

    NSLog(@"%d", timeLeft);

    if (timeLeft == 0) {
        [self timerDone];
        [stopWatchTimer invalidate];
        stopWatchTimer = nil;
    }
}

-(void)timerDone {

    pkrTime.hidden = NO;
    btnStart.hidden = NO;
    btnStop.hidden = YES;

    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Timer Done" message:nil delegate:self cancelButtonTitle:nil otherButtonTitles:@"Ok", nil];
    [alert show];

    [self playAlert];
} 
```

请让我知道问题出在哪里......我在任何地方都找不到我的代码的问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:49:25.337

在您的`btnStartPressed:`方法中，您没有什么可以阻止将一秒`NSTimer`分配和分配给`stopWatchTimer`. 如果您按两次按钮，您将得到两个计时器，但只有一个会失效。

添加类似：

```
 if (stopWatchTimer) return; 
```

到开头`btnStartPressed:`。如果这不能解决问题，那么除了推测`timeLeft`为零之外，没有足够的上下文来确定发生了什么？

* * *

Nate 说了什么，但这里有另一种解释。

想象一下，如果您这样做（其中 stopWatchTimer 是全局变量或实例变量，没关系）：

```
 stopWatchTimer = [NSTimer scheduledTimerWithTimeInterval:....]; 
```

现在，这样做：

```
 stopWatchTimer = nil;
 [stopWatchTimer invalidate]; 
```

计时器不会失效，但仍会触发。 `stopWatchTimer`是对对象的*引用*。它不是对象本身。因此，当您将*第二个*计时器分配给 时`stopWatchTimer`，您将覆盖对第一个计时器的引用，但该计时器仍会触发！

# ios - iOS推送通知将相同令牌分配给同一设备上的不同应用程序/目标

> ID：14096113
> 
> 赞同：0
> 
> 时间：2012-12-31T00:19:11.653
> 
> 标签：ios, push-notification, apple-push-notifications

我有一个有多个不同目标的应用程序。每个 Target 都有自己的 App Identifier (com.sample.app1, com.sample.app2 ...)

我发现当我在同一设备上安装不同目标的 Ad Hoc / App Store 版本时，每个目标都被分配了相同的推送通知令牌。我可以将此令牌与每个目标的推送通知证书结合使用，并且它可以正常工作（推送到指定的目标），但是我做错了什么吗？我曾期望为每个目标分配一个不同的推送通知令牌。

# c# - 如何通过 C# 使用 VirtualAlloc 分配和使用本机内存？

> ID：14096116
> 
> 赞同：1
> 
> 时间：2012-12-31T00:20:00.033
> 
> 标签：c#, performance, pinvoke

为了最大化关键方法的性能，[在另一个问题中，有人建议](https://stackoverflow.com/questions/14054557/speeding-up-array-lookup-after-traversing)我本地分配和使用数组的内存，而不是修复它。

我在 C# 中工作，没有使用不安全代码和使用 P/invoke 的经验。我在谷歌上没有找到任何相关的例子，[关于 VirtualAlloc 的 MSDN 文章](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366887(v=vs.85).aspx)也没有帮助。

这是一种被称为数十亿次的方法，并且每一点性能都是可取的。

```
 public static readonly int[] HR = new int[32487834];
    public unsafe int eval(int c1, int c2, int c3, int c4, int c5, int c6, int c7)
    {
        fixed (int* HR = Evaluator.HR)
        {
            int p = HR[53 + c1];
            p = HR[p + c2];
            p = HR[p + c3];
            p = HR[p + c4];
            p = HR[p + c5];
            p = HR[p + c6];
            return (HR[p + c7]);
        }
    } 
```

如果您有兴趣，它是[TwoPlusTwo-Evaluator](http://www.codingthewheel.com/archives/poker-hand-evaluator-roundup#2p2)的 C# 端口，它使用 123mb 查找表返回随机 7 张扑克手牌的排名以进行比较。在我的机器上，我以随机顺序平均大约 80M 评估/秒，以连续顺序平均 500M 评估/秒（c1=0，c2=1，循环将每个变量增加到 52）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T23:54:52.690

您的示例的主要问题是您必须使用循环代码***外部***`fixed`的指令。在这个嵌套函数中使用它并没有真正的帮助，而且可能会使事情变得更糟，因为它会使 C# 在内部调用其 GC 内存固定 API。所以一个更好的解决方案应该有这样的代码：

 *```
public unsafe int eval(int* HR, int c1, int c2, int c3, int c4, int c5, int c6, int c7)
{
    int p = HR[53 + c1];
    p = HR[p + c2];
    p = HR[p + c3];
    p = HR[p + c4];
    p = HR[p + c5];
    p = HR[p + c6];
    return (HR[p + c7]);
} 
```

`fixed`本质上是[GCHandle.AddrOfPinnedObject](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.gchandle.addrofpinnedobject.aspx "GCHandle.AddrOfPinnedObject")的语言构造同义词。在您的情况下，忽略对八个数组进行的边界检查超过了每次输入该函数时通过 GC 固定和取消固定内存的成本......但可能不会太多。

使用 P/Invoke 通常并非易事，除非您想花几天时间熟悉该领域，否则我建议您不要使用它。如果您还不熟悉通过 C++ 进行的 Win32/WinAPI 编程，则更具挑战性。最好重新编写您的代码，以便您可以将内存固定在链上尽可能高的位置。出于这个特定目的，您甚至可以为该数组创建一个 GCHandle 作为对象构造函数的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:07:07.890

尝试使用 C++/Cli：

```
ref class Evaluator
{
public:
  static Int32* HR;
  static Evaluator()
  {
    int size = 32487834;
    HR = (INT*)malloc(size * 4);
  }

  static Int32 Eval(Int32 c1, Int32 c2, Int32 c3, Int32 c4, Int32 c5, Int32 c6, Int32 c7)
  {
      Int32 p = HR[53 + c1];
      p = HR[p + c2];
      p = HR[p + c3];
      p = HR[p + c4];
      p = HR[p + c5];
      p = HR[p + c6];
      return (HR[p + c7]);

  }
}; 
```*

# encoding - 这个变长整数编 码是什么？

> ID：14096119
> 
> 赞同：2
> 
> 时间：2012-12-31T00:20:06.360
> 
> 标签：encoding, integer, variable-length, 8-bit

我正在记录一种旧的文件格式，并且遇到了以下问题。

似乎整数是可变长度编码的，数字 <=`0x7F`编码为单个字节，但 >=`0x80`编码为两个字节。一组示例整数及其编码对应项：

*   `0x390`被编码为`0x9007`
*   `0x150`被编码为`0xD002`
*   `0x82`被编码为`0x8201`
*   `0x89`被编码为`0x8901`

我还没有遇到任何大于 的数字`0xFFFF`，所以我不能确定它们是否/如何编码。对于我的生活，我无法在这里找出模式。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T00:26:39.080

乍一看，这些数字似乎被分成 7 位块，每个块都被编码为输出字节的 7 个最低有效位，而最高有效位表示在此之后是否还有更多字节（即最后一个编码整数的字节的 MSB 为 0）。

输入的最低有效位首先出现，所以我想你可以称之为“小端”。

编辑：参见[https://en.wikipedia.org/wiki/Variable-length_quantity](https://en.wikipedia.org/wiki/Variable-length_quantity)（这用于 MIDI 和 Google 协议缓冲区）

# prawn - 硬编码字符串和分配字符串的行为不同

> ID：14096120
> 
> 赞同：1
> 
> 时间：2012-12-31T00:20:20.250
> 
> 标签：prawn

使用 ruby​​ 1.9.3 --> 渲染文本 pdf.text "Hello \n World" 时，它会像宣传的那样工作。

但是，如果我将它作为 ARGV 的参数传递，“\n”只是显示为文本而不是 CR。

检查编码。都是 US-ASCII。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-07T18:03:02.700

“Hello '\n' World” - 希望这会有所帮助）

# javascript - 在Nodejs中将流解析为对象

> ID：14096124
> 
> 赞同：31
> 
> 时间：2012-12-31T00:20:25.550
> 
> 标签：javascript, node.js, stream, amazon-web-services, amazon-s3

我正在尝试从Node.Js 中**的 Amazon S3 存储中获取对象。**

**当我将它保存到文件时**，这非常有效。

```
amazon.getObject = function () {

    var options = {
        BucketName : 'mybucket',
        ObjectName : 'path/to/my.json',
        ResponseContentType : 'application/json'
    };

    s3.GetObject(options, function(err, data) {
        var fs = require('fs');
        var fd = fs.openSync('helloaa.json', 'w+');
        fs.writeSync(fd, data.Body, 0, data.Body.length, 0);
        fs.closeSync(fd);
    });

}; 
```

在。helloaa.json 是：

```
{
    "hello": 1,
    "world": 3
} 
```

但。我不想将数据写入磁盘上的文件。

**我想用 JSON.parse() 解析这个 json 对象；**

当我在那里打印对象时：

```
 s3.GetObject(options, function(err, data) {
        console.log(JSON.stringify(data));
    }); 
```

在控制台中是这样的：

```
{"StatusCode":200,"Headers":{"x-amz-id-2":"N1gDLPam+fDCLWd9Q2NI62hizH7eXAjg
61oLYOkanLoSlqUlDl6tqasbfdQXZ","x-amz-request-id":"C53957DAF635D3FD","date"
:"Mon, 31 Dec 2012 00:11:48 GMT","last-modified":"Sun, 30 Dec 2012 23:22:57        "etag":"\"8677a54c9b693bb6fc040ede8cc6a\"","accept-ranges":"bytes","co
ntent-type":"application/json","content-length":"176","server":"AmazonS3"},
"Body":{"0":123,"1":10,"2":32,"3":32,"4":32,"5":32,"6":34,"7":105,"8":100,"
9":34,"10":58,"11":32,"12":49,"13":44,"14":10,"15":32,"16":32,"17":32,"18": 
```

它是什么？

我该如何解析它？

是流吗？

我可以将流保存到 NodeJs 中的对象吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-12-31T03:21:35.230

你试过`data.Body.toString()`吗？

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2016-03-15T23:49:39.607

转换为字符串后，我必须解析 JSON：

```
 var fileContents = data.Body.toString();
    var json = JSON.parse(fileContents);
    console.log(json); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-01T18:30:37.830

将解析后的响应转换为base64，然后可以直接用作HTML的图像标签中的源。可以通过 Amazon REST API 进行 Lambda 调用

```
const AWS = require('aws-sdk');
//*/ get reference to S3 client 
var s3 = new AWS.S3();
exports.handler = (event, context, callback) => {
    var params = {
  "Bucket": "bucket-name",
  "Key": "object-name"  
    };
    s3.getObject(params, function(err, data){
       if(err) {
           callback(err, null);
       } else {
           let image = new Buffer(data.Body).toString('base64');
           image = "data:"+data.ContentType+";base64,"+image;
           let response = {
        "statusCode": 200,
        "headers": {
            "Access-Control-Allow-Origin": "*",
            'Content-Type': data.ContentType
        },
        "body":image,
        "isBase64Encoded": true
    };
           callback(null, response);
    }
    });

}; 
```

# ruby-on-rails - 如何使用散列数组填充 select_tag？

> ID：14096126
> 
> 赞同：23
> 
> 时间：2012-12-31T00:20:34.350
> 
> 标签：ruby-on-rails

在 Rails 3.2 应用程序中，我试图添加一个选择字段，该字段从外部 API 调用中获取其数据。此数据以哈希数组的形式返回：

```
[{"name"=>"NameA", "id"=>"001"}, {"name"=>"NameB", "id"=>"002"}] 
```

我怎样才能使用这些数据来构造一个看起来像这样的选择字段：

```
<select>
  <option value="001"> NameA </option>
  <option value="002"> NameB </option>
</select> 
```

编辑：

感谢以下建议，我尝试了以下方法：

A：

```
<%= select_tag 'model[field]', options_from_collection_for_select(@hash, :id, :name) %> 
```

给出一个错误：

```
undefined method `name' for {"name"=>"NameA", "id"=>"001"}:Hash 
```

乙：

```
<%= select_tag 'model[field]', options_from_collection_for_select(@hash) %> 
```

修复错误但生成错误的标记

```
<option value="{"name"=>"NameA", "id"=>"001"}"> {"name"=>"NameA", "id"=>"001"}</option> 
```

所以我认为我的问题是正确格式化散列数组，而我对操作散列数组的了解还不够，无法弄清楚如何做到这一点。

除非我完全按照磨损的方向寻找，否则我认为这个问题的关键是重新格式化这个问题顶部的数组以给出：

```
{"NameA" =>"001", "NameB" =>"002"} 
```

这甚至可能吗？如果是这样，怎么办？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-11-11T10:43:13.937

如果你有这样的哈希数组：

```
@people = [{"name"=>"NameA", "id"=>"001"}, {"name"=>"NameB", "id"=>"002"}] 
```

您可以通过以下方法使用[`options_for_select`](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-options_for_select)助手[`collect`](http://www.ruby-doc.org/core-2.1.2/Array.html#method-i-collect)：

```
= select_tag "people", options_for_select(@people.collect {|p| [ p['name'], p['id'] ] }) 
```

它完成了:-)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-07-31T06:54:12.197

仅在一个命令中执行此操作的更好方法：

```
<%= select_tag "model[field]", options_for_select(@array_of_hashes.map { |obj| [obj['name'], obj['id']] }) %> 
```

使用您的示例哈希：

```
irb> @array_of_hashes = [{"name"=>"NameA", "id"=>"001"}, {"name"=>"NameB", "id"=>"002"}]
=> [{"name"=>"NameA", "id"=>"001"}, {"name"=>"NameB", "id"=>"002"}]
irb> @array_of_hashes.map { |obj| [obj['name'], obj['id']] }
=> [["NameA", "001"], ["NameB", "002"]] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-08T16:11:37.443

对我来说，在选择中使用哈希的最简单方法是：

哈希：

```
REVISION_TYPES={"S"=>"Stock", "T"=>"Traducción"} 
```

在表格中：

```
select_tag(:revision_type,options_for_select(REVISION_TYPES.invert.to_a)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T01:11:00.967

您可以`options_for_select`用于此目的。它需要一个二维数组。你可以像这样转换你的哈希：

```
data = [{"name"=>"NameA", "id"=>"001"}, {"name"=>"NameB", "id"=>"002"}]
data_for_select = data.each { |hash| [hash['name'], hash['id']] }
options_for_select(data_for_select) 
```

作为 的旁注`options_from_collection_for_select`，它与对象结合使用。它遍历对象并为标签发送一条消息，为id发送一条消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T15:30:25.753

好的，我最终想出了一个可行的解决方案，尽管它可能不是最好的。

```
$ @array_of_hashes = [{"name"=>"NameA", "id"=>"001"}, {"name"=>"NameB", "id"=>"002"}]
=> [{"name"=>"NameA", "id"=>"001"}, {"name"=>"NameB", "id"=>"002"}]
$ @formatted_array_of_hashes = @array_of_hashes.each.map{ |h| { h["name"] => h["id"] }}
=> [{"NameA" => "001"}, {"NameB" => "002"}]
$ @merged_hash = Hash[*@formatted_array_of_hashes.map(&:to_a).flatten]
=> {"NameA" => "001", "NameB" => "002"} 
```

然后我能够创建一个选择字段

```
<%= select_tag 'model[field]', options_for_select(@merged_hash) %> 
```

生成正确的标记

```
<select>
  <option value="001">NameA</option>
  <option value="002">NameB</option>
</select> 
```

有点令人费解，但它的工作。我欢迎任何改进。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-18T22:00:51.137

我不太确定为什么，但没有一个答案对我有用。也许是因为 Rails 5，所以我自己想出来了，我很乐意分享。它现在很漂亮，但效果很好。

这是我想与用户表关联的来自外部 API（管道驱动器）的哈希数组：

这是我的形式：

```
<%= form.collection_select(:id_user_pipedrive, Owner.all_id_name, :id, :name, :include_blank => '') %> 
```

这是在我的假模型中：

```
UserPipedrive = Struct.new(:id, :name)
def self.all_id_name
  all["data"].map { |d| UserPipedrive.new(d["id"],d["name"]) }
end 
```

希望它可以帮助某人。

# php - 在 Ubuntu PHP 中启用 PCNTL - 测试失败

> ID：14096130
> 
> 赞同：12
> 
> 时间：2012-12-31T00:20:55.700
> 
> 标签：php, ubuntu, pcntl

我需要有关如何：在 Ubuntu PHP 中启用 PCNTL 的帮助。

```
$ mkdir /tmp/phpsource
$ cd /tmp/phpsource

$ wget http://museum.php.net/php5/php-5.3.2.tar.gz
$ tar xvf php-5.3.2.tar.gz
$ cd php-5.3.2/ext/pcntl

$ phpize   -bash: phpize: command not found 
```

一切都很顺利，直到我尝试运行 phpize！然后我得到错误'-bash：phpize：找不到命令'？？有任何想法吗？

更新运行：

```
$ sudo apt-get update 
```

然后跑：

```
$ sudo apt-get install php5-dev 
```

在尼克的帮助下，我设法完成了这个程序。但是'make test'失败了？？？

```
$ phpize
$ ./configure
$ make

$ cp modules/pcntl.so /usr/lib/php5/20090626/
$ echo "extension=pcntl.so" > /etc/php5/conf.d/pcntl.ini

$ make test - FAILED! 
```

帮助：我输入了 'echo "extension=pcntl.so > /etc/php5/conf.d/pcntl.ini' 而不是 'echo "extension=pcntl.so" > /etc/php5/conf.d/pcntl.ini ' 我第一次运行这个。那很糟糕吗？

--------------------------------- 制作测试错误信息 ------------- -------------------------

```
PHP Deprecated: Comments starting with '#' are deprecated in /tmp/phpsource/php-5.3.2/ext/pcntl/tmp-php.ini on line 1850 in Unknown on line 0
PHP Deprecated: Comments starting with '#' are deprecated in /tmp/phpsource/php-5.3.2/ext/pcntl/tmp-php.ini on line 1852 in Unknown on line 0
PHP Deprecated: Comments starting with '#' are deprecated in /tmp/phpsource/php-5.3.2/ext/pcntl/tmp-php.ini on line 1850 in Unknown on line 0
PHP Deprecated: Comments starting with '#' are deprecated in /tmp/phpsource/php-5.3.2/ext/pcntl/tmp-php.ini on line 1852 in Unknown on line 0
PHP Warning: Module 'pcntl' already loaded in Unknown on line 0

Warning: Module 'pcntl' already loaded in Unknown on line 0
PHP Deprecated: Comments starting with '#' are deprecated in /tmp/phpsource/php-5.3.2/ext/pcntl/tmp-php.ini on line 1850 in Unknown on line 0
PHP Deprecated: Comments starting with '#' are deprecated in /tmp/phpsource/php-5.3.2/ext/pcntl/tmp-php.ini on line 1852 in Unknown on line 0
PHP Warning: Module 'pcntl' already loaded in Unknown on line 0

Warning: Module 'pcntl' already loaded in Unknown on line 0

=====================================================================
PHP : /usr/bin/php
PHP_SAPI : cli
PHP_VERSION : 5.3.2-1ubuntu4.18
ZEND_VERSION: 2.3.0
PHP_OS : Linux - Linux lvps217-8-253-63.vps.webfusion.co.uk 2.6.32-042stab068.8 #1 SMP Fri Dec 7 17:06:14 MSK 2012 x86_64
INI actual : /tmp/phpsource/php-5.3.2/ext/pcntl/tmp-php.ini
More .INIs :
CWD : /tmp/phpsource/php-5.3.2/ext/pcntl
Extra dirs :
VALGRIND : Not used
=====================================================================
TIME START 2013-01-02 23:05:56
=====================================================================
FAIL Test pcntl wait functionality [tests/001.phpt]
FAIL pcntl: pcntl_sigprocmask(), pcntl_sigwaitinfo(), pcntl_sigtimedwait() [tests/002.phpt]
FAIL pcntl: SIG_BLOCK, SIG_UNBLOCK, SIG_SETMASK [tests/003.phpt]
FAIL Bug #47566 (return value of pcntl_wexitstatus()) [tests/bug47566.phpt]
FAIL pcntl_alarm() [tests/pcntl_alarm.phpt]
FAIL pcntl_exec() [tests/pcntl_exec.phpt]
FAIL pcntl_exec() 2 [tests/pcntl_exec_2.phpt]
FAIL pcntl_exec() 3 [tests/pcntl_exec_3.phpt]
FAIL Test function pcntl_fork() by calling it with its expected arguments [tests/pcntl_fork_basic.phpt]
FAIL Test function pcntl_fork() by testing the process isolation in the forking hierarchy father -> son -> grandson where father can not knows his grandson [tests/pcntl_fork_variation.phpt]
FAIL pcntl_signal() [tests/pcntl_signal.phpt]
FAIL pcnt_signal_dispatch() [tests/pcntl_signal_dispatch.phpt]
FAIL pcntl_wait() [tests/pcntl_wait.phpt]
FAIL Closures as a signal handler [tests/signal_closure_handler.phpt]
=====================================================================
TIME END 2013-01-02 23:05:59

=====================================================================
TEST RESULT SUMMARY
---------------------------------------------------------------------
Exts skipped : 0
Exts tested : 44
---------------------------------------------------------------------

Number of tests : 14 14
Tests skipped : 0 ( 0.0%) --------
Tests warned : 0 ( 0.0%) ( 0.0%)
Tests failed : 14 (100.0%) (100.0%)
Expected fail : 0 ( 0.0%) ( 0.0%)
Tests passed : 0 ( 0.0%) ( 0.0%)
---------------------------------------------------------------------
Time taken : 3 seconds
=====================================================================

=====================================================================
FAILED TEST SUMMARY
---------------------------------------------------------------------
Test pcntl wait functionality [tests/001.phpt]
pcntl: pcntl_sigprocmask(), pcntl_sigwaitinfo(), pcntl_sigtimedwait() [tests/002.phpt]
pcntl: SIG_BLOCK, SIG_UNBLOCK, SIG_SETMASK [tests/003.phpt]
Bug #47566 (return value of pcntl_wexitstatus()) [tests/bug47566.phpt]
pcntl_alarm() [tests/pcntl_alarm.phpt]
pcntl_exec() [tests/pcntl_exec.phpt]
pcntl_exec() 2 [tests/pcntl_exec_2.phpt]
pcntl_exec() 3 [tests/pcntl_exec_3.phpt]
Test function pcntl_fork() by calling it with its expected arguments [tests/pcntl_fork_basic.phpt]
Test function pcntl_fork() by testing the process isolation in the forking hierarchy father -> son -> grandson where father can not knows his grandson [tests/pcntl_fork_variation.phpt]
pcntl_signal() [tests/pcntl_signal.phpt]
pcnt_signal_dispatch() [tests/pcntl_signal_dispatch.phpt]
pcntl_wait() [tests/pcntl_wait.phpt]
Closures as a signal handler [tests/signal_closure_handler.phpt] 
```

有任何想法吗！？！卡尔

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-06T20:09:01.740

这是我在 Ubuntu 12.04 中发现的：

*   检查您的 PHP.ini 是否有被禁用的 pnctl 函数。

    ```
    disable_functions =     pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority 
    ```

*   phpinfo 报告该函数已加载，但如果不将 pcntl.ini 文件放入 /etc/php5/conf.d，它将无法实际工作。

可悲的是，每次 /etc/cron.d 中的 PHP 会话清理 cron 启动时，这都会导致“模块已加载”错误，但是如果没有这两个部分，PCNTL 将无法运行，到目前为止我还没有找到一个好的禁用“已加载”错误的解决方案。它凌乱，丑陋，并且向我的根邮件发送垃圾邮件，当我找到解决方案时，我会发布它。到目前为止，我只在 12.04 中遇到过这个问题。

*更新*

我破解了我的 /usr/lib/php5/maxlifetime 脚本文件以停止发送带有 pnctl 错误的垃圾邮件（*PHP 警告：模块 'pcntl' 已加载到第 0 行的未知中*）。这是我的编辑 - 我专门在“E_DEPRECATED”行中添加了以使消息静音。

第 8 行：

```
 cur=$(php5 -c /etc/php5/${sapi}/php.ini -d "error_reporting='E_ALL & ~E_DEPRECATED'" -r 'print ini_get("session.gc_maxlifetime");' 2> /dev/null) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-18T04:46:22.653

有一些这样的步骤：（我的操作系统是debian7.2 xfce x86）。

1：我这样安装 pcntl

```
#mkdir php
#cd php 
#apt-get source php5 
#cd php5-5.4.4/ext/pcntl
#phpize
#./configure
#make
#echo "extension=pcntl.so" > /etc/php5/mods-available/pcntl.ini
#ln -s /etc/php5/mods-available/pcntl.ini /etc/php5/conf.d/pcntl.ini 
```

2：重启nginx或apache2时，php得到一个警告。

> “PHP 警告：模块 'pcntl' 已在第 0 行的未知中加载”

3：所以我

> “rm -rf /etc/php5/mods-available/pcntl.ini 和 /etc/php5/conf.d/pcntl.ini”

4：编辑“php.ini”文件。

> ```
> a.apache2, it's in "/etc/php5/apache2/php.ini"
> b.cgi like nginx,it's in "/etc/php5/cgi/php.ini" 
> ```

使

```
"disable_functions = pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited..."
comments, add  " ; "  in front of "disable_functions". 
```

重新启动你的服务器，警告消失了。祝你好运。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-02T23:21:06.623

在我的带有 ubuntu 12.10（以及更早版本）的开发机器上，pcntl 已启用/已启用。

```
$ php -m | grep pcntl
pcntl 
```

我想这就是问题所在：

> PHP 警告：模块 'pcntl' 已加载到第 0 行的未知中

所以不要再次安装它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-03T00:03:53.920

我需要重新启动服务器！现在它起作用了！Doh .. 感谢大家的意见。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-01T22:49:00.667

在 Ubuntu 15.04 中，pcntl 安装在 php CLI 中，但默认禁用。要启用，请编辑 /etc/php5/cli/php.ini 并注释掉该行：

```
disable_functions = pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority, 
```

如果您希望在 apache2 中启用这些，则编辑文件 /etc/php5/apache2/php.ini 并进行相同的更改。

建议只删除您需要使用的功能，以尽可能多地保留安全限制。

# r - 没有 as.matrix 通用函数

> ID：14096134
> 
> 赞同：-1
> 
> 时间：2012-12-31T00:22:00.467
> 
> 标签：r, class, instantiation

在 R 终端我可以发出

```
> as.matrix
function (x, ...) 
UseMethod("as.matrix")
<bytecode: 0x7ffd5430a898>
<environment: namespace:base> 
```

我正在尝试使用 as.matrix 方法实现一个类。在我的 R 包中，我有

```
as.matrix.pdist = function(x, ...) { do stuff ... } 
```

当我安装我的包时，我看到

```
Creating a generic function for ‘as.matrix’ from package ‘base’ in package ‘pdist’ 
```

当我实例化 pdist 和 call 的实例时`as.matrix`，我的`as.matrix.pdist`方法不会被调用。这是否意味着 as.matrix 不是通用函数？为什么我在检查源代码时会看到 UseMethod 调用`as.matrix`？我该如何正确实施`as.matrix`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T01:24:27.300

啊，必须将 S3method(as.matrix, pdist) 添加到 NAMESPACE 文件中

# jquery - 更改 Jquery Mobile 可折叠集中的标题

> ID：14096137
> 
> 赞同：1
> 
> 时间：2012-12-31T00:22:49.627
> 
> 标签：jquery, jquery-mobile

所以我正在尝试为手风琴创建一个自定义可折叠标题 [http://jquerymobile.com/demos/1.0b3/docs/content/content-collapsible-set.html](http://jquerymobile.com/demos/1.0b3/docs/content/content-collapsible-set.html) 我希望标题看起来像什么

```
<div data-role="collapsible-set">

    <div data-role="collapsible" data-collapsed="false">
    <div id="header">
<h3>Section 1</h3>
    <p>I am Part of a Header</p>
    </div>
    </div>

</div> 
```

现在看起来只有当 h3 是第一个孩子时它才会起作用。有没有办法可以做我想做的事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:59:55.783

尝试这样的事情：

```
<div data-role="collapsible-set">
  <div data-role="collapsible" data-collapsed="false">
    <h3>
       <div class="header">Section 1</div>
       <div class="subheader">I am Part of a Header</div>
    </h3>
  </div>
</div> 
```

你将无法绕过 h3 不能被包装的事实，除非你做一些 js 黑客。这可能是个坏主意。

# c# - 在给定中心点、半径和度数的圆上找到点

> ID：14096138
> 
> 赞同：94
> 
> 时间：2012-12-31T00:23:13.387
> 
> 标签：c#, geometry

自从我做这样的数学运算以来已经 10 年了……我正在编写 2D 游戏并移动玩家。当我移动玩家时，我试图计算距离玩家位置 200 像素的圆上的点，给定 -360 到 360 之间的正或负角度（度）。屏幕为 1280x720，0,0 为中心点的屏幕。玩家在整个笛卡尔坐标系中移动。我试图找到的点可能不在屏幕上。

我尝试了文章[Find the point with radius and angle](https://stackoverflow.com/questions/2887513/find-the-point-with-radius-and-angle?rq=1)上的公式，但我不相信我理解“角度”是什么，因为当我将角度作为 -360 到 360 传递给 Cos(angle) 或 Sin 时，我得到了奇怪的结果（角度）。

**所以例如我有...**

*   1280x720 在笛卡尔平面上
*   中心点（球员的位置）：
    *   让 x = 最小值 -640 到最大值 640 之间的数字
    *   让 y = 最小值 -360 到最大值 360 之间的数字
*   玩家周围的圆半径：让 r 始终 = 200
*   角度：让 a = 一个介于 -360 到 360 之间的数字（允许负数表示向下或正数表示向上，因此 -10 和 350 会给出相同的答案）

**在圆上返回 X 的公式是什么？**

**在圆上返回 Y 的公式是什么？**

![在此处输入图像描述](../Images/a7fef854f96edf22f006a4a2544c6318.png) ![在此处输入图像描述](../Images/816b904eb25c81bcdd094da0fbbf94fe.png)

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-12-31T00:28:31.687

*链接中的简单方程给出了圆上点相对于*圆心的 X 和 Y 坐标。

```
X = r * cosine(angle)  
Y = r * sine(angle) 
```

这告诉您该点偏离圆心的距离。由于您有中心的坐标（Cx，Cy），因此只需添加计算出的偏移量。

圆上点的坐标为：

```
X = Cx + (r * cosine(angle))  
Y = Cy + (r * sine(angle)) 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-12-31T00:27:48.190

您应该发布您正在使用的代码。这将有助于准确识别问题。

但是，由于您提到用 -360 到 360 来测量角度，因此您的数学库可能使用了不正确的单位。大多数三角函数的实现都使用弧度作为输入。如果你改用度数......你的答案将是奇怪的错误。

```
x_oncircle = x_origin + 200 * cos (degrees * pi / 180)
y_oncircle = y_origin + 200 * sin (degrees * pi / 180) 
```

请注意，您可能还会遇到象限不是您所期望的情况。这可以通过仔细选择角度零的位置来解决，或者通过手动检查您期望的象限并将您自己的符号应用于结果值来解决。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-02T18:34:12.797

我强烈建议使用矩阵进行此类操作。这是最通用的方法，请参见下面的示例：

```
// The center point of rotation
var centerPoint = new Point(0, 0);
// Factory method creating the matrix                                        
var matrix = new RotateTransform(angleInDegrees, centerPoint.X, centerPoint.Y).Value;
// The point to rotate
var point = new Point(100, 0);
// Applying the transform that results in a rotated point                                      
Point rotated = Point.Multiply(point, matrix); 
```

*   旁注，惯例是逆时针测量角度起始形式（正）X轴

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-12-14T06:45:50.327

我还需要它来形成代码中时钟指针的运动。我尝试了几个公式，但它们都不起作用，所以这就是我想出的：

*   运动 - 顺时针
*   积分 - 每 6 度（因为 360 度除以 60 分钟是 6 度）
*   手长 - 65 像素
*   中心 - x=75,y=75

所以公式是

```
x=Cx+(r*cos(d/(180/PI))
y=Cy+(r*sin(d/(180/PI)) 
```

其中 x 和 y 是圆周上的点，Cx 和 Cy 是圆心的 x,y 坐标，r 是半径，d 是度数。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-12-31T00:28:41.213

> 当我将角度作为 -360 到 360 传递给 Cos（角度）或 Sin（角度）时，我得到了奇怪的结果。

我认为您的尝试无效的原因是您以度数传递角度。`sin`和`cos`三角函数期望以弧度表示的角度，所以数字应该是从`0`到`2*M_PI`。对于`d`你通过的学位`M_PI*d/180.0`。是在header 中`M_PI`定义的常量。`math.h`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-04-19T05:17:04.977

这是c#实现。该方法将返回以 和 作为参数的`radius`圆形点`center`。`angle interval`角度以弧度传递。

```
public static List<PointF> getCircularPoints(double radius, PointF center, double angleInterval)
        {
            List<PointF> points = new List<PointF>();

            for (double interval = angleInterval; interval < 2 * Math.PI; interval += angleInterval)
            {
                double X = center.X + (radius * Math.Cos(interval));
                double Y = center.Y + (radius * Math.Sin(interval));

                points.Add(new PointF((float)X, (float)Y));
            }

            return points;
        } 
```

和调用示例：

```
List<PointF> LEPoints = getCircularPoints(10.0f, new PointF(100.0f, 100.0f), Math.PI / 6.0f); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-12-30T19:54:04.577

我想分享您的上述贡献如何帮助我制作 Arduino LCD 指南针。我希望这是正确的礼仪......我刚刚加入了stackoverflow，所以我要感谢你们这些好人。

当我站在几何巨人的肩膀上时，我能够制作出这个指南针样本： [Arduino TFT compass with multiple bearing](https://i.stack.imgur.com/8th0l.jpg)

我反复调用的函数的代码（对于您在黄色小文本中看到的不同方位）是用 Arduino 编写的（有点像“C”）......并且非常易于翻译：

```
void PaintCompassNeedle( int pBearingInDegrees, int pRadius, TSPoint pCentrePt ) {
    // ******************************************************************************
    // * Formula for finding pointX on the circle based on degrees around the circle:
    // * x_oncircle = x_origin + radius * cos (degrees * pi / 180)  
    // * y_oncircle = y_origin - radius * sin (degrees * pi / 180) //minus explained
    // * Thanks to folks at stackoverflow...standing on the shoulders of giants. :) 

    float bearingInRads = (pBearingInDegrees) * PI / 180; 
    // Degrees vs Rads...The math folks use Rads in their formulas

    // *******************************************************************
    // * bearingPt is the point on the circle that we are trying to find
    TSPoint bearingPt;
    // Find the X on the circle starting with orgin (centre)
    bearingPt.x = pCentrePt.x + pRadius * sin(bearingInRads); 
    // Notice the "minus" R * cos()...because TFT the y is upside down bearingPt.y = 
    pCentrePt.y - pRadius * cos(bearingInRads); 
    // * Extra Explanation: The TFT is the graphical display I'm using and it
    // * calculates x & y from the top left of screen (portrait mode) as (0,0)
    // * ...so by Subtracting from the Y orgin...I flip it vertically
    // * Other folks using x,y as increasing to the right and up respectively
    // * would keep the plus sign after the pCentrePt.y
    // *************************************************************************

    // ***************************************************************
    // * This part will change for the final product...but leaving
    // * it because when call numerous times it shows it working for
    // * a number of different quadrants (displaying yellow degrees text)
    tft.fillCircle( bearingPt.x, bearingPt.y, 5, RED); 
    tft.setCursor( bearingPt.x, bearingPt.y );
    tft.setTextSize( 1 );
    tft.setTextColor( YELLOW );
    tft.print( pBearingInDegrees );

    TSPoint innerPt;
    innerPt.x = pCentrePt.x + pRadius/2 * sin(bearingInRads);
    innerPt.y = pCentrePt.y - pRadius/2 * cos(bearingInRads);
    tft.drawLine(innerPt.x, innerPt.y, bearingPt.x, bearingPt.y, RED);

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-15T06:25:13.873

推荐：

```
 public static Vector3 RotatePointAroundPivot(Vector3 point, Vector3 
pivot, Vector3 angles)
    {
	    return Quaternion.Euler(angles) * (point - pivot) + pivot;
    }
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-01-08T03:57:14.000

答案应该正好相反。

X = Xc + rSin(角度)

Y = Yc + rCos(角度)

其中 Xc 和 Yc 是圆的中心坐标，r 是半径。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2019-08-18T22:57:59.593

你可以使用这个：

圆方程

> (xk) ² +(yv) ² =R ²

其中 k 和 v 是常数，R 是半径

# php - PHP 路由 - 禁用 404？

> ID：14096139
> 
> 赞同：-1
> 
> 时间：2012-12-31T00:23:29.500
> 
> 标签：php, url, routing

我正在创建一个基本的路由系统，所以我的 URL 看起来像这样：

> www.domain.com/index.php/controller

唯一的问题是，当我转到那个地址时，我得到一个 404。有没有办法用 PHP 覆盖它（不使用 .htaccess）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T00:30:29.877

index.php 文件需要是您的引导文件，该文件将根据请求的内容加载控制器，但不使用 mod rewrite 的 url 将类似于：

```
www.domain.com/index.php?url=controller 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-31T00:31:11.093

我之前设置过类似的东西 - 在我的情况下，我必须让 apache 使用 mod_rewrite 进行重定向：我的发送 www.domain.com/controller 到 www.domain.com/index.php？*route* =controller - 应该与我想的类似。

```
RewriteEngine on
RewriteBase /
RewriteRule ^(.*)\?*$ index.php?_route_=$1 [L,QSA] 
```

希望有帮助。

# java - 如何在 JOptionPane 中设置默认输入字段

> ID：14096140
> 
> 赞同：1
> 
> 时间：2012-12-31T00:23:34.010
> 
> 标签：java, joptionpane

我有以下代码：

```
JTextField uname = new JTextField(defaultUser);
JPasswordField passwd = new JPasswordField();
JTextField serverAddress = new JTextField(defaultServer);
JTextField port = new JTextField(Integer.toString(defaultPort));
final JComponent[] inputs = new JComponent[]{new JLabel("Username"), uname, new JLabel("Password"), passwd, new JLabel("Server Address"), serverAddress, new JLabel("Server Port"), port};

int var = JOptionPane.showConfirmDialog(parent, inputs, "Enter Connection Details", JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE);
if (var != 0) {
    return;
}
.... 
```

这将创建一个对话框，提示输入一些详细信息以连接到服务器。我想要的是使密码字段成为默认选择。也就是说，光标默认在那里，因此您可以在窗格出现后立即开始输入，而不必先选择密码框 - 默认情况下，确定按钮具有焦点。

我已经尝试使用 passwd.requestFocusInWindow() 但它不起作用（因为我认为在调用它之前该框必须是可见的）。我还尝试用各种内容覆盖 passwd 的 requestFocus 方法，但它也没有飞起来（可能是因为它没有被调用......）

注意：我知道其他一些 JOptionPane 方法具有默认值参数，但是它们在布局输入框时存在问题，所以它们对我没有好处。

有人有什么想法吗？这不是交易破坏者，所以如果不能轻松完成，我不会太沮丧。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T00:44:29.263

尝试将 ComponentListener 添加到密码字段，当它变得可见时调用 #requestFocusInWindow

**更新：** `JOptionPane`使对话框中的 [OK] 按钮默认，并在显示对话框时将其聚焦。所以解决方案不是那么明显......我们必须添加 a`HierarchyListener`并等到密码字段添加到对话框中，然后检查对话框是否`JRootPane`有默认按钮，如果有，添加 a `FocusListener`，最后当按钮获得永久焦点时切换焦点到密码字段：

```
import static javax.swing.JOptionPane.OK_CANCEL_OPTION;
import static javax.swing.JOptionPane.PLAIN_MESSAGE;

import java.awt.event.FocusAdapter;
import java.awt.event.FocusEvent;
import java.awt.event.HierarchyEvent;
import java.awt.event.HierarchyListener;

import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPasswordField;
import javax.swing.JRootPane;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;

public class FocusPasswordFieldInOptionPaneDemo implements Runnable
{
    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new FocusPasswordFieldInOptionPaneDemo());
    }

    @Override
    public void run()
    {
        JTextField uname = new JTextField("user");
        JPasswordField passwd = new JPasswordField();
        JTextField serverAddress = new JTextField("server");
        JTextField port = new JTextField(Integer.toString(1337));
        final JComponent[] inputs = new JComponent[] {new JLabel("Username"), uname, new JLabel("Password"), passwd,
                new JLabel("Server Address"), serverAddress, new JLabel("Server Port"), port};

        makeSurePasswordFieldGetsFocus(passwd);

        int answer = JOptionPane.showConfirmDialog(null, inputs, "Enter Connection Details", OK_CANCEL_OPTION, PLAIN_MESSAGE);
        System.out.println(answer);
    }

    /**
     * {@link JOptionPane} makes the [OK] button default in the dialog and makes it focused.
     * <p>
     * So via a couple of listeners we can wait until the button gets permanent focus and then switch focus to the password field.
     */
    private void makeSurePasswordFieldGetsFocus(final JPasswordField passwd)
    {
        passwd.addHierarchyListener(new HierarchyListener()
        {
            HierarchyListener hierarchyListener = this;

            @Override
            public void hierarchyChanged(HierarchyEvent e)
            {
                JRootPane rootPane = SwingUtilities.getRootPane(passwd);
                if (rootPane != null)
                {
                    final JButton okButton = rootPane.getDefaultButton();
                    if (okButton != null)
                    {
                        okButton.addFocusListener(new FocusAdapter()
                        {
                            @Override
                            public void focusGained(FocusEvent e)
                            {
                                if (!e.isTemporary())
                                {
                                    passwd.requestFocusInWindow();
                                    passwd.removeHierarchyListener(hierarchyListener);
                                    okButton.removeFocusListener(this);
                                }
                            }
                        });
                    }
                }
            }
        });
    }
} 
```

这个解决方案有效，但它有点老套......另一种方法是创建一个自定义的“DatabaseConnectionDialog”，类似于@syb0rg 的答案。

# javascript - 循环无法正常工作

> ID：14096146
> 
> 赞同：0
> 
> 时间：2012-12-31T00:25:15.903
> 
> 标签：javascript, html

我创建了一个 javascript 来在音频结束后更改音频。

```
var songlist = new Array("a.mp3", "b.mp3", "c.mp3", "d.mp3", "e.mp3", "f.mp3");
var dir = "music/";
var curr_track = 0;
var isfirstrun;

function start()
{
    if(curr_track == songlist.length)
        curr_track = 0;
    var track = document.getElementById('track');
    track.innerHTML = curr_track;
    var audio = document.getElementById('audio');
    isfirstrun = true;
    audio.src = dir+songlist[curr_track];
    audio.load();
    audio.play();
    if(isfirstrun == true)
    {
        audio.addEventListener('ended', function(){ curr_track++; start();}, false); 
        isfirstrun = false;
    }
} 
```

在 HTML 内部，

```
<body onload="start();"> 
```

代码中`track`使用的是显示当前轨道号是什么，我发现输出是

```
0    then    1    then     3     then    7 
```

因此，它缺少`c.mp3`，`e.mp3`并且`f.mp3`来自`songlist`。

如何解决循环问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T00:28:10.213

每次歌曲结束时，您都在添加另一个事件处理程序。这就是为什么您会看到 +1、+2、+4 等，因为事件处理程序的数量每次都会翻倍。

这是我喜欢使用的主要原因`audio.onended = function() {curr_track++; start();};`

但无论如何，要解决这个问题，您所要做的就是拥有一个“isfirstrun”变量，从 开始`true`，然后仅在它为 true 时添加事件侦听器并将其设置为 false。

# jquery - 具有固定宽度和高度的砌体？

> ID：14096150
> 
> 赞同：4
> 
> 时间：2012-12-31T00:25:32.143
> 
> 标签：jquery, algorithm, jquery-masonry, jquery-isotope

我想要这样的东西

![在此处输入图像描述](../Images/f9f0341bbf39a4831cea0f100980aec8.png)

容器盒的宽度和高度是固定的

盒子尺寸不同，如 1 * 1 或 2 * 1 或 3 * 3 和...但不大于 4 宽和 3 高

盒子上的数字是加载时盒子的索引

我试图写一个算法宽度这些条件

first - 将 item1 放在第一个位置 (0,0)

第二个 - 第一个框创建 2 个位置：(0,1) 和 (1,0)

第三 - item2 应在 2 个新位置之间做出决定，并适合最佳位置以减少差距

并且每个项目在放置时会在其左上角和右下角产生 2 个新位置

我还必须检查容器和盒子区域的剩余区域，以检查容器是否已满

如果容器已满，则创建新容器并将其余物品放在那里

我发现了一些我的算法失败的例子，但我应该找到解决方案

也许按区域和空间对这些框进行排序是最简单的解决方案

但我不喜欢它，因为它破坏了设计我的意思是顶部的大盒子和底部的小盒子:(这不好，而且我想将这些盒子加载到无限滚动然后我不知道我的下一个盒子尺寸是多少所以我不能根据区域放置它们

放弃后，我检查了所有关于这种设计的插件

像同位素和砖石和香草砖石和网格和......

我试图定制同位素

JSfiddle 链接显示了我的尝试 [链接](http://jsfiddle.net/jEQA3/86/)

```
<a href="#" id="good">Shuffle</a> |
<a href="#" id="bad">Original order (broken)</a>
<div id="container">
   <div class="item w1 h1">1</div>    
   <div class="item w2 h1">2</div>
   <div class="item w1 h2">3</div>
   <div class="item w1 h1">4</div>
   <div class="item w2 h2">5</div>
   <div class="item w2 h1">6</div>
   <div class="item w1 h1">7</div>
   <div class="item w1 h1">8</div>
   <div class="item w1 h2">9</div>
   <div class="item w2 h2">10</div>
   <div class="item w2 h1">11</div>
 </div>​

 #container {
   margin: 0 auto;
   border: 2px solid black;
   height: 430px;
   margin: 20px 0 0 0;}

 .item {
  float: right;
  background: #CCC;
  width: 100px;
  height: 100px;
  margin: 10px;}

 .item.w1 {
   width: 100px;}

 .item.w2 {
   width: 200px;}

 .item.h1 {
   height: 100px;}

 .item.h2 {
   height: 200px}

 .isotope,
   .isotope .isotope-item {
   -webkit-transition-duration: 0.8s;
    -moz-transition-duration: 0.8s;
      transition-duration: 0.8s;}

  .isotope {
    -webkit-transition-property: height, width;
     -moz-transition-property: height, width;
      transition-property: height, width;}

  .isotope .isotope-item {
    -webkit-transition-property: -webkit-transform, opacity;
    -moz-transition-property:    -moz-transform, opacity;
      transition-property:         transform, opacity;}​

$(function(){

$("#good").click(function() {
    $("#container").isotope('shuffle');
    return false;
});

$("#bad").click(function() {
    $("#container").isotope({'sortBy':'original-order'});
    return false;
});

$("#container").isotope({
  layoutMode: 'masonryHorizontal',
  masonryHorizontal: {
    rowHeight: 60
  }
});  });​ 
```

但似乎不能同时具有固定的宽度和高度

这对我很重要，因为我想在盒子之间保持相等的边距而不是改变

我还想检测浏览器高度并仅使用这 3 个状态而不是可变高度来更改高度

5排、4排和3排

**我的问题：**

首先 - 我很高兴自己编写这个算法，所以请帮我详细找到这个算法的最佳解决方案？？

在过去的两天里我尝试了很多方法

第二 - 我们可以按照我的预期定制其中一个插件吗？如何定制？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T00:33:54.163

最简单的是使用kd-tree将树细分为垂直和水平的euklidian 2d空间。然后您可以将矩形打包到创建的空间之一中并递归地细分树。在线提供了一个 Jquery treemap 插件示例。jquery plugin masonry 可以做同样的事情，但它更像是一个 1d bin-packing 求解器。2d bin-packing 要复杂得多，也可能意味着旋转矩形。这是打包光照贴图的示例：http: [//www.blackpawn.com/texts/lightmaps/default.html](http://www.blackpawn.com/texts/lightmaps/default.html)。为了实现更好的打包，您可以按某种顺序对大小进行排序，desc、asc、random 等。这也会创建不同的树形图。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T17:56:41.750

我遇到了类似的问题，并最终为这个确切的东西编写了一个 jQuery 插件。可能会进行一些改进，但它会为您指明正确的方向 -

插件 - [https://github.com/DrewDahlman/Mason](https://github.com/DrewDahlman/Mason)

关于该理论的博客文章 - [http://www.drewdahlman.com/meusLabs/?p=218](http://www.drewdahlman.com/meusLabs/?p=218)

# mysql - GROUP CONCAT 由于某种原因无法正常工作

> ID：14096153
> 
> 赞同：18
> 
> 时间：2012-12-31T00:25:41.903
> 
> 标签：mysql, sql, select, group-concat

我正在形成一个选择语句并收到此错误。

> FUNCTION GROUP_CONCAT 不存在。检查参考手册中的“函数名称解析和解析”部分

我不明白这一点，因为组 concats 使用了有人给我的代码，我从中构建了我的新代码。这是它的外观

```
SELECT
`shirts`.`shirt_name`,
`shirts`.`men` AS `main_photo`,
GROUP_CONCAT (`shirt_sizes`.`size_name`) AS `sizes`
FROM
`shirts`
JOIN
`shirts_link` ON `shirts_link`.`shirt_id`=`shirts`.`id`
JOIN
`shirt_sizes` ON `shirt_sizes`.`id`=`shirts_link`.`size_id`
JOIN
`shirt_prices` ON `shirt_prices`.`id`=`shirts_link`.`price_id`
WHERE `men`!=''
GROUP BY
`shirt_prices`.`price_cat` 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-12-31T00:32:22.973

函数名和括号之间不能有空格。改变

```
GROUP_CONCAT (`shirt_sizes`.`size_name`) AS `sizes` 
```

到

```
GROUP_CONCAT(`shirt_sizes`.`size_name`) AS `sizes` 
```

# linux - OpenCV 错误：图像步骤错误

> ID：14096157
> 
> 赞同：0
> 
> 时间：2012-12-31T00:26:21.030
> 
> 标签：linux, opencv

我正在阅读本教程：[http ://docs.opencv.org/trunk/modules/contrib/doc/facerec/tutorial/facerec_video_recognition.html#creating-the-csv-file](http://docs.opencv.org/trunk/modules/contrib/doc/facerec/tutorial/facerec_video_recognition.html#creating-the-csv-file)

一切顺利，但运行人脸识别脚本会出现以下错误：

```
OpenCV Error: Image step is wrong (The matrix is not continuous, thus its number of rows can not be changed) 
```

我正在使用 Ubuntu，所以我不确定如何实施此处找到的解决方案： [在 Fisherfaces.train() 方法中获取 OpenCV 错误“图像步骤错误”](https://stackoverflow.com/questions/10961586/getting-opencv-error-image-step-is-wrong-in-fisherfaces-train-method/11036304#11036304)

我在调试模式下重建，但没有效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T09:02:54.693

最近我在这个人脸识别示例中遇到了同样的错误。我通过提供相同的比例（1:1）图像消除了错误。

使用此脚本裁剪图像（另请参阅[命令行批量图像裁剪工具](https://stackoverflow.com/questions/1893244/command-line-batch-image-cropping-tool)）

```
#!/bin/bash
width=92;
height=92;
x_offset=0;
y_offset=10;
filelist=`ls | grep '.pgm'`
for image_file in $filelist
do
  convert -crop ${width}x${height}+${x_offset}+${y_offset} \
    $image_file $image_file
done 
```

这将裁剪文件夹中的图像，因此您需要将此脚本放在图像所在的同一目录中。

此外，您应该在 csv 文件中提供绝对路径。

# css - CSS 盒子模型拼图 - 我一定错过了什么

> ID：14096165
> 
> 赞同：0
> 
> 时间：2012-12-31T00:27:38.923
> 
> 标签：css, layout

我在这里创建了我的流体布局的简化版本：http: [//jsfiddle.net/persianturtle/8UZjz/5/](http://jsfiddle.net/persianturtle/8UZjz/5/)我试图弄清楚为什么右列与上面的标题不完全对齐。有零填充。边界是一样的。我一定是错过了一些东西，但我一生都无法弄清楚是什么导致了流离失所。

需要明确的是：我不想让三列之间的空间均匀。即使右列会像上面的标题一样排列在屏幕的右边缘，它们也会如此。

html代码如下：

```
 <div id="pagewidth"> 
```

```
<div class="twocols">
  <div class="box content">
  <ul>
   <li>two</li>
   <li>two</li>
   <li>two</li>
   <li>two</li>
   <li>two</li>
   <li>two</li>
  </ul>
  </div>  <!--Closes Content-->

<div class="box rightcol">
<ul>
   <li>three</li>
   <li>three</li>
   <li>three</li>
   <li>three</li>
   <li>three</li>
   <li>three</li>
 </ul>
 </div>   <!--Closes rightcol-->
 </div>   <!--Closes twocols-->

 <div class="box leftcol">
 <ul>
   <li>one</li>
   <li>one</li>
   <li>one</li>
   <li>one</li>
   <li>one</li>
   <li>one</li>
 </ul>
 </div>   <!--Closes leftcol--> 
```

​</p>

和CSS：

```
body{
    background-color:#e8f1c4;  
}

header{
    height:245px;
    width:100%;
}

#pagewidth{
    position:relative;
    margin:0 auto;
    width:95%;  
    min-width:980px;
    max-width:1450px;
}

.box{
    background:#ffffff;
    border:2px solid #bcd78d;
    border-radius:15px;
    -moz-border-radius:15px; /* Old Firefox */
    -webkit-border-radius: 15px;
    margin-top:5px;
}

.leftcol{
    width:24.5%; 
    float:left; 
    position:relative;
}

.twocols{
    width:74.5%; 
    float:right; 
    position:relative;
}

.rightcol{
    width:31.65772%; 
    float:right; 
    position:relative; 
}

.content{  
    float:left; 
    display:inline; 
    position:relative; 
    width:67%; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:52:11.557

边界*不*一样。您的标题是 100% 宽的边框。其他容器位于没有边界的容器内。该`box-sizing`物业可以在这里为您提供帮助：

[http://jsfiddle.net/8UZjz/12/](http://jsfiddle.net/8UZjz/12/)

```
.box{
    background:#ffffff;
    border:2px solid #bcd78d;
    border-radius:15px;
    -moz-border-radius:15px; /* Old Firefox */
    -webkit-border-radius: 15px;
    margin-top:5px;
    box-sizing: border-box; /* needs prefixes for webkit/moz */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T00:48:23.370

问题在于标题的边框，它增加了标题的整体宽度，但仅在右侧。您可以尝试用 a 包装标题`div`并应用`box`该类：（[jsfiddle](http://jsfiddle.net/8UZjz/7/)）

```
 <div class="box">
     <header>
     </header>
 </div> 
```

# c# - WinRT 中 ListView 的项插入动画

> ID：14096168
> 
> 赞同：4
> 
> 时间：2012-12-31T00:28:09.313
> 
> 标签：c#, xaml, windows-runtime, winrt-xaml, windows-store-apps

最近我开始构建自己的大型 Windows 8 应用商店应用程序。在 UI 上工作，我开始复制一些好的 UI。

我遇到了一个非常有趣的动画，即在标准邮件应用程序的列表视图中插入新元素。当您单击链时，它会展开并显示链中的所有消息。

[这](http://www.youtube.com/watch?v=gwnp7E9OBhY)是捕获的视频。

我不知道他们使用什么技术来实现这个动画和行为。

任何人都可以帮助我，解释或举例我如何实现这种行为？谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-31T06:53:45.880

邮件应用程序是用 JavaScript 编写的，因此了解它是如何完成的对您没有多大帮助，因为此 UI 堆栈与 XAML 堆栈完全不同。但问题是列表控件可能以相同的方式进行动画处理，因此您只需要添加/删除列表中的一些项目即可获得展开/折叠效果。

我玩了一会儿，这就是我想出的，它使用 ListView 的 ItemTemplateSelector 属性来定义几个不同的项目模板。

![在此处输入图像描述](../Images/da1e38b8d68d91519a134ee8c83fd6b2.png)

```
<Page
    x:Class="App82.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:App82"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Page.Resources>
        <local:CollapsibleListItemTemplateSelector
            x:Key="collapsibleListItemTemplateSelector">
            <local:CollapsibleListItemTemplateSelector.BasicItemTemplate>
                <DataTemplate>
                    <Border
                        Margin="5"
                        Height="50"
                        VerticalAlignment="Stretch"
                        BorderBrush="ForestGreen"
                        BorderThickness="2,0,0,0">
                        <StackPanel
                            Margin="10,0,0,0">
                            <TextBlock
                                FontWeight="Bold"
                                Text="{Binding Title}" />
                            <TextBlock
                                Text="{Binding Gist}" />
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </local:CollapsibleListItemTemplateSelector.BasicItemTemplate>
            <local:CollapsibleListItemTemplateSelector.ExpandedItemTemplate>
                <DataTemplate>
                    <Border
                        Margin="15,5,5,5"
                        Height="50"
                        VerticalAlignment="Stretch"
                        BorderBrush="Yellow"
                        BorderThickness="2,0,0,0">
                        <StackPanel
                            Margin="10,0,0,0">
                            <TextBlock
                                FontWeight="Bold"
                                Text="{Binding Title}" />
                            <TextBlock
                                Text="{Binding Gist}" />
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </local:CollapsibleListItemTemplateSelector.ExpandedItemTemplate>
            <local:CollapsibleListItemTemplateSelector.CollapsibleItemTemplate>
                <DataTemplate>
                    <Border
                        Margin="5"
                        Height="50"
                        VerticalAlignment="Stretch"
                        BorderBrush="DodgerBlue"
                        BorderThickness="2,0,0,0">
                        <StackPanel
                            Margin="10,0,0,0"
                            Orientation="Horizontal">
                            <TextBlock
                                FontWeight="Bold"
                                Text="{Binding ChildItems.Count}" />
                            <TextBlock
                                FontWeight="Bold"
                                Text="&#160;Items" />
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </local:CollapsibleListItemTemplateSelector.CollapsibleItemTemplate>
        </local:CollapsibleListItemTemplateSelector>
    </Page.Resources>
    <Grid
        Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
        <ListView
            x:Name="ListView"
            ItemTemplateSelector="{StaticResource collapsibleListItemTemplateSelector}"
            ItemClick="OnItemClick"
            IsItemClickEnabled="True" />
    </Grid>
</Page> 
```

后面的代码：

```
using System.Collections;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using App82.Common;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;

namespace App82
{
    public sealed partial class MainPage : Page
    {
        public MainPage()
        {
            this.InitializeComponent();

            var items = new ObservableCollection<BindableBase>();
            var item1 = new BasicItem { Title = "Item 1", Gist = "This item has some content that is not fully shown..." };
            var item2 = new ExpandedItem { Title = "Item 2", Gist = "This item has some content that is not fully shown..." };
            var item3 = new ExpandedItem { Title = "Item 3", Gist = "This item has some content that is not fully shown..." };
            var item4 = new ExpandedItem { Title = "Item 4", Gist = "This item has some content that is not fully shown..." };
            var item5 = new BasicItem { Title = "Item 5", Gist = "This item has some content that is not fully shown..." };

            var itemGroup1 = new CollapsibleItem(items, new[] { item2, item3, item4 });
            items.Add(item1);
            items.Add(itemGroup1);
            items.Add(item5);
            this.ListView.ItemsSource = items;
        }

        private void OnItemClick(object sender, ItemClickEventArgs e)
        {
            var collapsibleItem = e.ClickedItem as CollapsibleItem;
            if (collapsibleItem != null)
                collapsibleItem.ToggleCollapse();
        }
    }

    public class CollapsibleListItemTemplateSelector : DataTemplateSelector
    {
        public DataTemplate BasicItemTemplate { get; set; }
        public DataTemplate CollapsibleItemTemplate { get; set; }
        public DataTemplate ExpandedItemTemplate { get; set; }

        protected override Windows.UI.Xaml.DataTemplate SelectTemplateCore(object item, Windows.UI.Xaml.DependencyObject container)
        {
            if (item is ExpandedItem)
                return ExpandedItemTemplate;
            if (item is BasicItem)
                return BasicItemTemplate;
            //if (item is CollapsibleItem)
                return CollapsibleItemTemplate;
        }
    }

    public class BasicItem : BindableBase
    {
        #region Title
        private string _title;
        public string Title
        {
            get { return _title; }
            set { this.SetProperty(ref _title, value); }
        }
        #endregion

        #region Gist
        private string _gist;
        public string Gist
        {
            get { return _gist; }
            set { this.SetProperty(ref _gist, value); }
        }
        #endregion
    }

    public class ExpandedItem : BasicItem
    {

    }

    public class CollapsibleItem : BindableBase
    {
        private readonly IList _hostCollection;

        #region IsExpanded
        private bool _isExpanded;
        public bool IsExpanded
        {
            get { return _isExpanded; }
            set
            {
                if (this.SetProperty(ref _isExpanded, value))
                {
                    if (_isExpanded)
                        Expand();
                    else
                        Collapse();
                }
            }
        }
        #endregion

        #region ChildItems
        private ObservableCollection<BasicItem> _childItems;
        public ObservableCollection<BasicItem> ChildItems
        {
            get { return _childItems; }
            set { this.SetProperty(ref _childItems, value); }
        }
        #endregion

        public CollapsibleItem(
            IList hostCollection,
            IEnumerable<BasicItem> childItems)
        {
            _hostCollection = hostCollection;
            _childItems = new ObservableCollection<BasicItem>(childItems);
        }

        public void ToggleCollapse()
        {
            IsExpanded = !IsExpanded;
        }

        private void Expand()
        {
            int i = _hostCollection.IndexOf(this) + 1;

            foreach (var childItem in ChildItems)
            {
                _hostCollection.Insert(i++, childItem);
            }
        }

        private void Collapse()
        {
            int i = _hostCollection.IndexOf(this) + 1;

            for (int index = 0; index < ChildItems.Count; index++)
            {
                _hostCollection.RemoveAt(i);
            }
        }
    }
} 
```

# asp.net - 如何将 html 表格转换为可下载的 excel 文件 ASP.NET C#

> ID：14096171
> 
> 赞同：0
> 
> 时间：2012-12-31T00:28:33.590
> 
> 标签：asp.net

我需要一个函数来将任何 HTML 表格转换为 excel 文件！

我喜欢在我的页面上添加一个按钮，一旦单击该按钮，我就会将一个完整的 HTML 表传递给这样的函数，该函数将生成一个 excel 文件并将 html 表传递到具有相同布局和设计的文件中！

感谢您对此请求的任何帮助。

我正在使用 c# 和 asp.net

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:42:53.350

这是一个讨厌的技巧，但它适用于最新版本的 excel。

您只需将 html 表保存为普通的 html 文件，然后将其重命名为 xls。如果您的应用程序是 Web 应用程序，请使用 response.setHeader("Content-Disposition", "attachment; filename=order.xls")。

最近版本的 excel 支持[Microsoft Office XML 格式](http://en.wikipedia.org/wiki/Microsoft_Office_XML_formats)，所以如果以前的解决方案不起作用，您可能需要尝试从 html 表生成 xml。请参阅[XML 电子表格参考](http://msdn.microsoft.com/en-us/library/aa140066%28office.10%29.aspx)。

我所做的是从 xml 格式的 excel 生成 xml，然后破解它。您还可以实现自动过滤器和酷布局等高级功能。我使用模板引擎生成 xml（Freemarker，它是 Java 的东西，但我确信也有用于 .NET 的模板引擎）

# kineticjs - 以黑色背景出现的图层

> ID：14096173
> 
> 赞同：1
> 
> 时间：2012-12-31T00:28:45.563
> 
> 标签：kineticjs

我正在做一个游戏，我发现添加了最后一层，虽然它在 Chrome 或 Firefox 中看起来正确，但出现了问题，因为该层显示为黑色背景。如果我禁用任何其他图层，它可以正常工作，所以屏幕中有多少对象一定是个问题。实际上六边形和文字之间只有70-90，所以它一定不是问题。代码是从其他块复制和粘贴的，所以它之前应该已经坏了......

```
var rect=new Kinetic.Rect({
    x: 0,
    y: 0,
    width: rectW,
    height: rectH,
    fill: color,
    stroke: 'black',
    strokeWidth: 1,
});
player.add(rect);

var texto=new Kinetic.Text({
    x: 40,
    y: 5,
    textFill: 'black',
    text: name,
    fontSize: 12,
    align: 'left',
    width: rectW/2,
});
player.add(texto); 
```

谁能告诉我是否出了问题？

# javascript - node.js 仅将填写的值传递给 mongodb

> ID：14096176
> 
> 赞同：1
> 
> 时间：2012-12-31T00:29:14.417
> 
> 标签：javascript, node.js, mongodb, database

我正在 node.js、mongodb 和 express 中处理一个必须处理事务的项目。我可以硬编码要放入 mongodb 的变量，但如果没有填写所有字段（并非所有字段都是必需的），那么我只是将空数据放入数据库中。

此代码有效：

```
 var d = new Date();
    var n = d.toJSON();

    var date               = n;
    var address            = req.body.property_address;
    var client_name        = req.body.client_name;
    var sales_price        = req.body.sales_price;
    var commission_percent = req.body.commission_percent;
    var referral           = req.body.referral;
    var donation           = req.body.donation;
    var client_source      = req.body.client_source;
    var client_type        = req.body.client_type;
    var notes              = req.body.notes;

    Transaction.findOne({ name: { $regex: new RegExp(date, "i") } },
        function(err, doc){
            if(!err && !doc) {
                console.log("there is no error, and this does not already exist");
                var newTransaction = new Transaction();

                newTransaction.date               = date;
                newTransaction.address            = address;
                newTransaction.client_name        = client_name;
                newTransaction.sales_price        = sales_price;
                newTransaction.commission_percent = commission_percent;
                newTransaction.referral           = referral;
                newTransaction.donation           = donation;
                newTransaction.client_source      = client_source;
                newTransaction.client_type        = client_type;
                newTransaction.notes              = notes;

                newTransaction.save(function(err) {
                    if(!err){
                        console.log("successfully saved");
                        res.json(200, {message: newTransaction.date});
                    } else {
                        res.json(500, {message: "Could not create transaction. Error: " + err})
                    }
                });
            }
    }); 
```

但是将一个不存在的值放入 mongodb 有什么意义呢？这不是应该很棒的事情之一吗？我的想法是，它消除了我将来可能做的可能的查询。

有可能做更多这样的事情吗？

```
Transaction.findOne({ name: { $regex: new RegExp(date, 'i' ) } },
    function(err, doc){
        if(!err && !doc){
            var newTransaction = new Transaction();

            for(var key in req.body){
                newTransaction.key = req.body[key];
            }
        }
    }
}); 
```

## 更新

这是我最终使用的代码。

```
Transaction.findOne({ name: { $regex: new RegExp(date, "i") } },
    function(err, doc){
        if(!err && !doc){
            var newTransaction = new Transaction();
            for(var key in req.body){
                if(req.body[key] != ''){
                    newTransaction[key] = req.body[key];
                }
            }
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:45:02.317

这是非常好的行为。您仍然可以查询所有文档中不存在的字段，因为不存在的字段与不相等相同。

这意味着仍然保留了文档的松散定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T06:13:30.920

对我来说看起来不错，但我可能不想只信任任何客户端数据作为密钥，具体取决于您的部署方式。

也许：

```
['date', 'address', 'client_name'/*,...*/].forEach(function(key)
{
    /* ... */
    if (key in req.body) newTransaction[key] = req.body[key];
}); 
```

# c# - ASP.NET 中的表单身份验证-> 无法重定向到远程服务器上 Webkit 浏览器上的受保护页面

> ID：14096179
> 
> 赞同：0
> 
> 时间：2012-12-31T00:29:30.107
> 
> 标签：c#, webforms

我已经通过使用一些自定义代码来设置 cookie 来实现表单身份验证。在我的开发服务器上的所有浏览器上正确登录后，我能够将用户重定向到正确的 ReturnUrl。我正在使用 ASP.NET 3.5 Web 窗体。

在我用于部署的远程服务器上，登录页面只是重新加载，而不是重定向到 ReturnUrl。奇怪的是，这只发生在 Webkit 浏览器上。Gecko 浏览器工作正常。我已经广泛搜索了一个解决方案，但找不到像这样的任何东西。

Web.config（我想从 Login.aspx 重定向到 Admin.aspx）：

```
 <appSettings>
    <add key="ValidationSettings:UnobtrusiveValidationMode" value="none"/>
    <add key="loginUrl" value="Login.aspx"  />

</appSettings>
<system.web>
    <authentication mode="Forms">
        <forms name=".ASPXAUTH" loginUrl="Login.aspx" defaultUrl="Admin.aspx" protection="All" timeout="2880" cookieless="UseCookies" />
    </authentication>
...
    <system.web>

    <authorization>
        <deny users="?" />
    </authorization>

</system.web>
<location path ="Default.aspx">
    <system.web>
        <authorization>
            <allow users ="*"/>
        </authorization>
    </system.web>
</location>

<location path="Resources">
    <system.web>
        <authorization>
            <allow users="*" />
        </authorization>
    </system.web>
</location>
<location path="Admin.aspx">
    <system.web>
        <authorization>
            <deny users ="?"/>
        </authorization>
    </system.web>
</location> 
```

登录.aspx.cs：

```
 protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void Submit_Click(object sender, EventArgs e)
    {
       DatabaseCommands c = new DatabaseCommands();

        if (c.CheckCredentials(txtUsername.Text, txtPassword.Text))
        {
            FormsAuthenticationTicket ticket;
            string cookieString;
            HttpCookie cookie;
            ticket = new FormsAuthenticationTicket(1, txtUsername.Text, DateTime.Now, DateTime.Now.AddMinutes(1), true, "This is one kickass ticket, yo");
            cookieString = FormsAuthentication.Encrypt(ticket);
            cookie = new HttpCookie(FormsAuthentication.FormsCookieName, cookieString);
            cookie.Expires = ticket.Expiration;
            cookie.Path = FormsAuthentication.FormsCookiePath;
            Response.Cookies.Add(cookie);
            string strRedirect = Request["ReturnUrl"];
            if (strRedirect == null)
                strRedirect = "Admin.aspx";
            Response.Redirect(strRedirect, true);
        }
        else
        {
            lblError.InnerText = "Invalid Credentials";
            lblError.Visible = true;
        }
    } 
```

登录.aspx：

```
 <form id="form1" runat="server">
<div style="text-align:center">
    <h1>Login</h1>
        <table style="margin-right:auto;margin-left:auto;" id="loginForm">
        <tr><td><label id="username">User:</label></td><td><asp:TextBox ID="txtUsername" runat="server" Width="200px"></asp:TextBox></td></tr>
        <tr><td><label id="password">Password:</label></td><td><asp:TextBox runat="server" TextMode="Password" ID="txtPassword"  Width="200px"></asp:TextBox></td></tr>
        <tr><td><label id="lblError" runat="server" visible="false"></label></td><td><asp:Button ID="submit" Text="Submit" OnClick="Submit_Click" runat="server"  align="right" PostBackUrl="/Admin.aspx" OnClientClick="Submit_Click" /></td></tr>
        </table>
        </div>            
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T19:58:28.560

事实证明，答案是注释掉行

```
 cookie.Path = ...
  cookie.Expires = ... 
```

很高兴这有帮助。

# c# - WP8 上的 HttpWebRequest

> ID：14096181
> 
> 赞同：0
> 
> 时间：2012-12-31T00:30:09.273
> 
> 标签：c#, .net, windows-phone-8

我一直在尝试`HTTPRequest`在我的 C# 项目中工作以获取`GET`请求，但我无法让它正常工作。下面是我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Net;
using System.IO;
using System.Windows;
using System.Diagnostics;
using System.Threading;

class MyClass 
{
    const string URL_PREFIX = "http://mycompany.com/";
    private HttpWebRequest objRequest = null;
    private static string myRequestData = string.Empty;
    private string urlAddress;

    public MyClass()
    {
        int member = 1;
        int startLoc = 1;
        int endLoc = 1;
        string starttime = "2012-01-01 00:00:00";
        string endtime = "2012-01-01 00:00:00";
        int rt = 1;
        string cmt = "Hello World";

        this.urlAddress = URL_PREFIX + string.Format(
        "createtrip.php?member={0}&startLoc={1}&endLoc={2}&starttime={3}&endtime={4}&rt={5}&cmt={6}"
        , member, startLoc, endLoc, starttime, endtime, rt, cmt);

        StringBuilder completeUrl = new StringBuilder(urlAddress);
        objRequest = (HttpWebRequest)WebRequest.Create(urlAddress);
        objRequest.ContentType = "application/x-www-form-urlencoded";

        objRequest.BeginGetRequestStream(new AsyncCallback(httpComplete), objRequest);
    }
    private static void httpComplete(IAsyncResult asyncResult)
    {
        HttpWebRequest objHttpWebRequest = (HttpWebRequest)asyncResult.AsyncState;
        // End the operation
        Stream postStream = objHttpWebRequest.EndGetRequestStream(asyncResult);
        // Convert the string into a byte array.
        byte[] byteArray = Encoding.UTF8.GetBytes(myRequestData);
        // Write to the request stream.
        postStream.Write(byteArray, 0, myRequestData.Length);
        postStream.Close();

        // Start the asynchronous operation to get the response
        objHttpWebRequest.BeginGetResponse(new AsyncCallback(GetResponseCallback), objHttpWebRequest);

    }
    private static void GetResponseCallback(IAsyncResult asyncResult)
    {
        HttpWebRequest objHttpWebRequest = (HttpWebRequest)asyncResult.AsyncState;
        HttpWebResponse objHttpWebResponse = (HttpWebResponse)objHttpWebRequest.EndGetResponse(asyncResult);
        Stream objStreamResponse = objHttpWebResponse .GetResponseStream();
        StreamReader objStreamReader = new StreamReader(objStreamResponse );
        string responseString = objStreamReader.ReadToEnd();            // Got response here
         MessageBox.Show("RESPONSE :" + responseString);
        // Close the stream object
        objStreamResponse .Close();
        objStreamReader.Close();
        objHttpWebResponse.Close();
    }

} 
```

我目前得到的错误是：

`An exception of type 'System.Collections.Generic.KeyNotFoundException' occurred in mscorlib.ni.dll and wasn't handled before a managed/native boundary A first chance exception of type 'System.Net.ProtocolViolationException' occurred in System.Windows.ni.dll Operation is not valid due to the current state of the object.`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-22T11:52:11.553

我建议您使用功能强大的库“Microsoft HTTP 客户端库”，它需要 .NET 4 并与 WP7、WP8、Silverlight 4-5、Windows Store 应用程序、便携式类库一起使用。

您可以简单地从 NuGet 中添加它，并且非常简单地使用它。

这是 HTTP GET 的示例。

```
 private async Task PerformGet()
        {
            HttpClient client = new HttpClient();
            HttpResponseMessage response = await client.GetAsync(myUrlGet);
            if (response.IsSuccessStatusCode)
            {
                // if the response content is a byte array
                byte[] contentBytes = await response.Content.ReadAsByteArrayAsync();

                // if the response content is a stream
                Stream contentStream = await response.Content.ReadAsStreamAsync();

                // if the response content is a string (JSON or XML)
                string json = await response.Content.ReadAsStringAsync();

                // your stuff..
            }
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T15:09:56.517

[http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetrequeststream.aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetrequeststream.aspx)

您不能将“BeginGetRequestStream”方法与 GET 或 HEAD 请求一起使用（GET 是默认请求，也是您在第一个 HTTP 请求中执行的请求）。

正如您在代码的第二部分中所做的那样，更改为使用“BeginGetResponse”。

# symfony - Symfony2 Avalanche_Imagine 捆绑链

> ID：14096188
> 
> 赞同：0
> 
> 时间：2012-12-31T00:31:37.873
> 
> 标签：symfony

我创建了一个继承 LoaderInterface 的新类。我的目标是应用水印，然后将图像调整为缩略图......有人知道怎么做吗？问题是我的类返回加载一个过滤器类型并且不能返回超过1个过滤器类型......那么如何创建一个链？

非常感谢。

这是我的示例代码

```
namespace Avalanche\Bundle\ImagineBundle\Imagine\Filter\Loader;

use Imagine\Image\Box;
use Imagine\Image\ManipulatorInterface;
use Imagine\Filter\Basic\Thumbnail;
use \Imagine\Filter\Basic\Paste;

class ThumbnailWatermarkFilterLoader implements LoaderInterface
{
    const WATERMARK_IMAGE_PATH = "watermark_image";
    const WATERMARK_FONT_PATH = "font";

    public function load(array $options = array())
    {
        $mode = $options['mode'] === 'inset' ?
            ManipulatorInterface::THUMBNAIL_INSET :
           ManipulatorInterface::THUMBNAIL_OUTBOUND;

           list($width, $height) = $options['size'];

           $watermark = new \Imagine\Gd\Image(imagecreatefrompng($options[self::WATERMARK_IMAGE_PATH]));
           $point = new \Imagine\Image\Point($width / 2  , $height /2);

           $thumb = new Paste($watermark, $point);

          return $thumb;

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T13:40:29.990

我正在寻找完全相同的内容，但没有找到有用的来源。所以我去创建了自己的水印过滤器。如果你愿意，你可以使用它。

我有一个示例配置，向您展示如何将水印与缩略图过滤器结合使用。

[https://github.com/SimonSimCity/WatermarkFilterBundle](https://github.com/SimonSimCity/WatermarkFilterBundle)

# python - 在动态体和移动的静态体之间在 pymunk 中创建 DampedRotarySpring

> ID：14096189
> 
> 赞同：2
> 
> 时间：2012-12-31T00:31:40.460
> 
> 标签：python, pygame, physics, chipmunk, pymunk

我正在努力按照标题所说的去做。我有一个手持枪的角色，我试图让枪指向光标。我认为 DampedRotarySpring 会是一个不错的方法，但事实证明并不是那么简单。枪是一个具有 Segment 形状的动态体，对于光标，我创建了一个静态体，我在每一步都使用 pygame 将其位置设置为鼠标位置。

当我运行程序时，除了重力或碰撞的影响之外，枪根本不动。

以下是相关代码：

```
# add crosshairs at the location of the mouse
pointer_body = pymunk.Body()
pointer_shape1 = pymunk.Segment(pointer_body, (0,CROSSHAIRS_SIZE), (0,-CROSSHAIRS_SIZE), 1) # vertical segment
pointer_shape2 = pymunk.Segment(pointer_body, (-CROSSHAIRS_SIZE,0), (CROSSHAIRS_SIZE,0), 1) # horizontal segment

# add a spring that will angle the gun toward the mouse
spring = pymunk.DampedRotarySpring(me.gun.body, pointer_body, 0, 0.01, 1)

space.add(pointer_shape1, pointer_shape2, spring)

while True:
    # handle event queue
    for event in pygame.event.get():
        if event.type == pygame.MOUSEMOTION:
            from math import atan2
            # update location of pointer
            pointer_body.position = flipy(pygame.mouse.get_pos())
            pointer_body.angle = atan2( (pointer_body.position.y - me.gun.body.position.y), (pointer_body.position.x - me.gun.body.position.x) ) 
```

编辑：

这是我所有代码的 Gist 存储库：[https](https://gist.github.com/4470807) ://gist.github.com/4470807 。主循环在 ragdoll.py 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:06:32.443

要点中的代码的问题在于，您使用两个关节将枪连接到手上，以使它们保持在相同的位置和相同的旋转。但是，手是胭脂体，不会转动。因此，当它被它和光标之间的弹簧拉动时，枪不会旋转，因为另一个关节更坚固。

我不确定你想要如何设置，但如果你从枪手上移除 RotaryLimitJoint，你会看到一切正常。

查看代码的固定分支以获取确切的详细信息：[https ://gist.github.com/4505219](https://gist.github.com/4505219)

我为找到问题所做的一些未来故障排除提示：

1.  将所有内容放大 10 倍，以便轻松查看发生了什么。我知道 pymunk 只绘制一种尺寸，但很容易在代码中所有尺寸的末尾添加一个 0。
2.  让手不动，以便更容易看到它是如何旋转的（删除了 update_hand_position 方法中的所有内容）
3.  禁用场景中所有形状之间的碰撞，以使旋转的枪不受身体某些部位的阻碍。（做了一个简单的 space.shapes 循环并运行 shape.group=1）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T09:24:40.463

也许您的问题出在弹簧参数上？除非枪非常轻，否则刚度和阻尼看起来非常低。

查看我昨天添加到 pymunk 的代码示例：[http ://code.google.com/p/pymunk/source/browse/trunk/examples/damped_rotary_spring_pointer.py](http://code.google.com/p/pymunk/source/browse/trunk/examples/damped_rotary_spring_pointer.py)

（当旋转在正圆周率和负圆周率之间翻转时，旋转会发生一件事，我会看看）

# javascript - 访问命名空间内的全局变量

> ID：14096190
> 
> 赞同：1
> 
> 时间：2012-12-31T00:31:52.740
> 
> 标签：javascript, function, scope

尝试在 var 命名空间中声明变量时遇到问题 ..
jsFiddle .. [http://jsfiddle.net/bobbyrne01/jeh7Y/](http://jsfiddle.net/bobbyrne01/jeh7Y/)

`Error: SyntaxError: missing : after property id`
`Line: 23, Column: 8 Source Code: var startTime = null;`

```
var Utils = {

    var startTime = null;

    getStartTime: function(){

        return startTime;
    },

    setStartTime: function(startTimeTemp){
        startTime = startTimeTemp;
    },
}

Utils.setStartTime(new Date());
alert(Utils.getStartTime()); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T00:33:42.100

您正在尝试在对象文字中声明一个变量。这是不允许的。

而是使用这个成语：

```
var Utils = function(startTime) {
    this.getStartTime = function(){
        return startTime;
    };

    this.setStartTime = function(startTimeTemp){
        startTime = startTimeTemp;
    };
}
u = new Utils(new Date());
alert(u.getStartTime()); 
```

如果 javascript 不是您的第一语言，则可能很难理解 startTime 与 Utils 的实例“保持一致”。这是因为 javascript 有闭包。[这](http://javascript.crockford.com/private.html)可能值得一读。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T00:35:50.113

您需要声明`startTime`为对象属性，如图所示，然后使用`this`来引用该属性：

```
var Utils = {

    startTime: 'test',

    getStartTime: function() {    
        return this.startTime;
    },

    setStartTime: function(startTimeTemp) {
        this.startTime = startTimeTemp;
    },
}

alert(Utils.getStartTime());    
Utils.setStartTime(new Date());
alert(Utils.getStartTime());​ 
```

# java - 无法在 OSX 上使用 eclipse for android 链接到 cocos2dx

> ID：14096191
> 
> 赞同：7
> 
> 时间：2012-12-31T00:32:00.440
> 
> 标签：java, android, eclipse, macos, cocos2d-x

我以前从未在开发环境的初始设置上花费过这么多时间，这有点荒谬。

我正在尝试运行 cocos2dx 附带的演示代码。我正在使用：

*   ADK 附带的 Eclipse 风味。
*   cocos2d-2.1beta3-x-2.1.0
*   ndk-r8c

我尝试使用 create-android-project.sh 构建应用程序模板，但我遇到了同样的问题，但对于这个问题，我将参考 hello.cpp 示例应用程序。

我运行 build_native.sh 脚本，然后在 eclipse 中导入它。接下来是我尝试过的所有不同教程的不同之处。有人说“转换为 C++ 项目”，有人说此时您已经可以“作为 android 项目运行”。

对我来说，android java 项目似乎无法链接到 cocos2dx 项目。

我得到：

```
The import org.cocos2dx.lib cannot be resolved 
```

为了

```
import org.cocos2dx.lib.Cocos2dxActivity 
```

没有教程真正提到必须构建 cocos2dx 库，除了一个说你现在必须将 cocos 库作为项目导入到 eclipse 工作区中。所以我已经这样做并构建了它们，但是在构建之后它们存在一些错误。

我还尝试在项目中添加要链接到的文件夹路径，对我来说，该路径位于 /cocos2d-2.1beta3-x-2.1.0/cocos2dx/platform/android/java/src/org/cocos2dx/lib 但没有没救

知道为什么即使按照 cocos2dx 网站上的构建说明到 T，我也无法构建/运行 cocos2dx 附带的示例？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-13T07:19:06.510

我现在也在 OSX 上这样做，这为我修复了它：

运行 android 脚本 create-android-project.sh 然后将该新项目导入 Eclipse

1.  在新的 Eclipse 项目中右键单击 src 文件夹 > 左键单击“导入”
2.  在 Import 窗口中选择 Android > Existing Android Code Into Workspace > Next >>
3.  浏览到'/cocos2dx/platform/android/java'（'/cocos2dx/'应该是新项目目录的上一级）
4.  单击完成。如果错误仍然存​​在，请尝试 Project > Clean

# perl - 这看起来如何？

> ID：14096196
> 
> 赞同：-1
> 
> 时间：2012-12-31T00:32:25.937
> 
> 标签：perl

像这样的东西应该如何写成单行？

我很想把所有东西都放在`while`-loop 和`perl -e '...' data`中，但是有没有更好的方法，然后有`if`-statements？

```
open(F, '<', 'data') or die $!;

while (my $line = <F>) {

    if ($line =~ m/test /) {
        my @a = split / /, $line;
        printf("%2s %4s %4s\n", substr($a[1], 1), $a[2], substr($a[5], 0, -1));
    } else {
        print $line;
    }

}

close F; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T00:59:30.073

首先，让我们清理一下实际的程序。

```
while (<>) {
   if (/test/) {
      my @a = split;
      $_ = sprintf("%2s %4s %4s\n", substr($a[1], 1), $a[2], substr($a[5], 0, -1));
   }

   print;
} 
```

然后，很容易利用`-p`and `-a`（“制作单线”）。

```
perl -pale'$_ = sprintf("%2s %4s %4s", substr($F[1], 1), $F[2], substr($F[5], 0, -1)) if /test/' data 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:42:27.167

像这样丑陋的东西：

```
perl -anle 'printf("%2s %4s %4s", substr($F[1], 1), $F[2], substr($F[5], 0, -1)),next if grep /test/, @F;print' 
```

也许？但是为什么要使用单线呢？

# xcode - 为什么没有可见的输出？

> ID：14096197
> 
> 赞同：0
> 
> 时间：2012-12-31T00:32:49.727
> 
> 标签：xcode, unix

**更新 1**

好消息是，现在我通过更正如下调用来查看输出`mat()`。

但是，有一个问题“问题”。

“问题”如下

```
Implicit declaration of function 'mat' is invalid in C99

//
//  main.m
//  MultRosetta
//
//  Created by Brian Schott on 12/30/12.
//  Copyright (c) 2012 Brian Schott. All rights reserved.
//

#import <Cocoa/Cocoa.h>
// #include "code.m"
/*
int main(int argc, char *argv[])
{
    int mat();
    return NSApplicationMain(argc, (const char **)argv);
}
*/

int main(int argc, const char * argv[])
{
    return( (int) mat() );
} 
```

**更新 1**

**更新 0**

我的目录列表如下。如何从终端（控制台）运行应用程序？我什至不认识要运行的可执行文件。

```
server:MultRosetta brian$ ls -al 
total 32
-rw-r--r--   1 brian  staff   449 Dec 30 19:31 inline
-rw-r--r--   1 brian  staff  1441 Dec 30 08:52 code.m
drwxr-xr-x   5 brian  staff   170 Dec 30 15:40 MultRosetta.xcodeproj
drwxr-xr-x   9 brian  staff   306 Dec 30 16:11 MultRosetta
-rw-r--r--@  1 brian  staff  6148 Dec 31 08:26 .DS_Store
drwxr-xr-x  13 brian  staff   442 Dec 30 08:43 ..
drwxr-xr-x   7 brian  staff   238 Dec 31 08:26 .
server:MultRosetta brian$ ls -al MultRosetta.xcodeproj/
total 24
drwxr-xr-x  5 brian  staff    170 Dec 30 15:40 .
drwxr-xr-x  7 brian  staff    238 Dec 31 08:26 ..
-rw-r--r--  1 brian  staff  12197 Dec 30 15:40 project.pbxproj
drwxr-xr-x  4 brian  staff    136 Dec 30 08:43 project.xcworkspace
drwxr-xr-x  3 brian  staff    102 Dec 30 08:43 xcuserdata
server:MultRosetta brian$ ls -al MultRosetta
total 48
drwxr-xr-x  9 brian  staff   306 Dec 30 16:11 .
drwxr-xr-x  7 brian  staff   238 Dec 31 08:26 ..
-rw-r--r--@ 1 brian  staff   283 Dec 30 08:43 BSAppDelegate.h
-rw-r--r--@ 1 brian  staff   380 Dec 30 08:43 BSAppDelegate.m
-rw-r--r--  1 brian  staff  1098 Dec 30 08:43 MultRosetta-Info.plist
-rw-r--r--@ 1 brian  staff   153 Dec 30 08:43 MultRosetta-Prefix.pch
-rw-r--r--@ 1 brian  staff  1531 Dec 30 16:11 code.m
drwxr-xr-x  5 brian  staff   170 Dec 30 08:43 en.lproj
-rw-r--r--@ 1 brian  staff   289 Dec 30 10:39 main.m
server:MultRosetta brian$ 
```

**更新 0**

[这是一个后续问题](https://stackoverflow.com/questions/14091592/xcode-does-not-compile-c-source)。在最初的问题中，我终于能够毫无错误地编译，但问题仍然存在。

我在下面的代码中看不到矩阵结果的任何输出。

（代码仅与原始代码略有不同。按照建议，我在“inline”语句中添加了“static”，我#imported了两个Xcode内容，并将主函数名称从“main()”更改为“mat( )”并从`main.m`.)中调用“mat()”

```
#import <Foundation/Foundation.h>
#import <Cocoa/Cocoa.h>
#include <stdio.h>
#include <stdlib.h>

/* Make the data structure self-contained.  Element at row i and col j
   is x[i * w + j].  More often than not, though,  you might want
   to represent a matrix some other way */
typedef struct { int h, w; double *x;} matrix_t, *matrix;

static inline double dot(double *a, double *b, int len, int step)
{
    double r = 0;
    while (len--) {
        r += *a++ * *b;
        b += step;
    }
    return r;
}

matrix mat_new(int h, int w)
{
    matrix r = malloc(sizeof(matrix) + sizeof(double) * w * h);
    r->h = h, r->w = w;
    r->x = (double*)(r + 1);
    return r;
}

matrix mat_mul(matrix a, matrix b)
{
    matrix r;
    double *p, *pa;
    int i, j;
    if (a->w != b->h) return 0;

    r = mat_new(a->h, b->w);
    p = r->x;
    for (pa = a->x, i = 0; i < a->h; i++, pa += a->w)
        for (j = 0; j < b->w; j++)
            *p++ = dot(pa, b->x + j, a->w, b->w);
    return r;
}

void mat_show(matrix a)
{
    int i, j;
    double *p = a->x;
    for (i = 0; i < a->h; i++, putchar('\n'))
        for (j = 0; j < a->w; j++)
            printf("\t%7.3f", *p++);
    putchar('\n');
}

int mat()
{

    double da[] = { 1, 1,  1,   1,
            2, 4,  8,  16,
            3, 9, 27,  81,
            4,16, 64, 256   };
    double db[] = {     4.0,   -3.0,  4.0/3,
            -13.0/3, 19.0/4, -7.0/3,
              3.0/2,   -2.0,  7.0/6,
             -1.0/6,  1.0/4, -1.0/6};

    matrix_t a = { 4, 4, da }, b = { 4, 3, db };
    matrix c = mat_mul(&a, &b);

    /* mat_show(&a), mat_show(&b); */
    mat_show(c);
    /* free(c) */
        // NSLog (@"Here is some amazing text! %@",c);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:08:27.880

如果您打开 Xcode 控制台，您应该能够看到此输出（您可以这样做，而在 Xcode 4 中，（`Shift`++激活控制台和++`Command`切换查看和隐藏调试区域）。`C``Shift``Command``Y`

或者，您可以从命令行运行可执行文件（已编译的二进制应用程序），您可以在那里看到输出。

编辑：

这是我的 Xcode 窗口的屏幕截图，您可以在其中看到我创建了一个测试项目并将您的代码放入其中（假设您将其设置为“Foundation”命令行工具）。

![两种查看输出的方法](../Images/64138e9efc4ef3a91739c6c24ccda59c.png)

方法 #1 在 Xcode 窗口的“输出”部分演示。

方法 # 2 是“在 Finder 中显示”编译后的产品，然后将该应用程序拖放到终端窗口中，您只需`Return`在显示路径后点击即可启动它。

我刚刚意识到的另一个想法......可能是您的代码根本没有运行。为了让我运行您的代码，我必须将此函数添加到我的 .m 文件中：

```
int main(int argc, const char * argv[])
{
    return( mat() );
} 
```

你在测试时真的调用了“ `mat()`”函数吗？

# javascript - jQuery - 加法

> ID：14096199
> 
> 赞同：0
> 
> 时间：2012-12-31T00:33:15.437
> 
> 标签：javascript, jquery, jquery-mobile

我在进行简单加法并将值保存在变量中时遇到问题。

基本上我有以下代码：

```
 var accsen;
    var lowsev = parseInt(accsen);
    var hisev = parseInt(accsen) + parseInt(0.65);

    console.log('Lowsev: ' + lowsev);
    console.log('Hisev: '  + hisev + ' Type: ' + typeof(hisev));
    console.log('Accsen: ' + accsen); 
```

变量 accsen 正在从数据库中获得一个值。Lowsev 被赋予与 accsen 相同的值，而 hisev 被赋予 accsen + 0.65 的值。

但是我遇到的问题是 lowsev 和 hisev 都保持为 0。在执行 console.log 时，我得到了这些值：

Lowsev：0 Hisev：0 类型：未定义 Accsen：0.75

谁能告诉我我在加法中做错了什么？我是否使用了正确的运算符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:38:40.377

听起来你想使用`parseFloat`而不是`parseInt`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:35:38.887

“Lowsev 被赋予与 accsen 相同的值” 不是，您将其四舍五入为整数。

但`parseInt()`不正确地四舍五入。0.75 输出为 0，所以它工作正常。假设您实际上想要四舍五入这些值，请尝试

```
var accsen;
var lowsev = Math.round(accsen);
var hisev = Math.round(accsen) + Math.round(0.65); 
```

**编辑**给出的回应

您的 JS 将 accsen 视为字符串，您需要转换为数字

```
var accsen = '0.75'; // as other people have noted this val in your code is missing.
var lowsev = parseFloat(accsen);
var hisev = parseFloat(accsen) + 0.65; 
```

# android - BasicAdapter排序上的Android动画重置

> ID：14096200
> 
> 赞同：0
> 
> 时间：2012-12-31T00:33:32.570
> 
> 标签：android, android-layout, android-animation

这几天一直困扰着我。我有一个`FrameLayout`布局内的元素之一移动以显示一个菜单。如果需要，我可以粘贴代码，它有点长，因为它是我的播放代码并且我没有使用任何样式。我离题了...

当用户按下一个特定的按钮时，它会调用位于另一个股票顶部的自`startAnimation`定义按钮。再次按下按钮会将自定义按钮放回其原始位置，从而隐藏菜单。`LinearLayout``LinearLayout.``LinearLayout`

我必须创建一个自定义`LinearLayout`来覆盖`onAnimationEnd`，以便布局会停止并停留在最终的动画位置（我发现这是基于 StackOverflow 上提出的其他一些问题）。

当用户实际按下可见菜单项之一时，就会出现问题。例如，其中一项对显示的列表进行排序或反向排序。似乎在我打电话后`notifyDataSetChanged`，`BasicAdapter`屏幕会自行重绘并且我的菜单被隐藏了。我没有关闭菜单的代码，当列表被告知重绘时，几乎就像整个 Activity 被重新创建或重置一样。

我还应该指出，我正在扩展一个`Activity`不是`ListActivity.`我的目标 API 10（Gingerbread，2.3）及更高版本。

如果有人有任何指示，我将不胜感激。我已经为此绞尽脑汁好几天了，这让我发疯了。如果我可以提供更多信息，请告诉我。

编辑：这是关于覆盖该`onAnimationEnd`方法的 SO 帖子。 [Android TranslateAnimation 在动画后重置](https://stackoverflow.com/questions/2650351/android-translateanimation-resets-after-animation)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:54:49.490

您是否记录自己打开了哪个项目的菜单？如果不是，则意味着您让 UI 系统为您进行记忆，这意味着此信息将丢失或变得无用（因为您已更改项目顺序），因此所有项目都恢复为初始状态。解决方法是将菜单打开/关闭状态与列表中的每个数据关联起来，然后在调用适配器的getView方法时，可以重建正确的UI状态。

# garbage-collection - Lua __gc 元方法现在是否适用于表 (Lua 5.2.1) ？

> ID：14096204
> 
> 赞同：2
> 
> 时间：2012-12-31T00:33:59.323
> 
> 标签：garbage-collection, lua, destructor, metatable

我有点惊讶，因为我以前读过，`__gc`元方法只对用户数据调用，从不对表调用。（[LuaFAQ ：为什么 __gc 和 __len 元方法不能在表上工作？](http://lua-users.org/wiki/LuaFaq)）

但是，最近，我尝试了它，发现它确实有效！用 Lua 5.2.1 试试这个代码：

```
do
  local b = setmetatable({a = 1}, {__gc = function(self) print(self.a); end});
end
collectgarbage(); 
```

但是我在任何地方都找不到此更改日志，所以我有点沮丧并且害怕使用它。

也许，有人可以证明我的建议？或者这是一种无证行为？对我来说，有一个常规的方法来创建表析构函数会很好，如果我的观察是正确的，我会很高兴。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T00:39:28.530

[Lua 5.2 参考手册](http://www.lua.org/manual/5.2/manual.html)第[2.5.1](http://www.lua.org/manual/5.2/manual.html#2.5.1)节指出表确实支持元`__gc`方法。具体来说，它说

> 对于要在收集时完成的对象（表或用户数据），您必须将其标记为完成。当您设置它的元表并且元表具有由字符串“__gc”索引的字段时，您将对象标记为完成。

[5.1 参考手册](http://www.lua.org/manual/5.1/manual.html#2.10.1)中的类似文档说

> 使用 C API，您可以为用户数据设置垃圾收集器元方法

很明显 Lua 5.2 现在明确支持`__gc`表的元方法。

# javascript - javascript 正则表达式用链接替换一些单词，但不在现有链接中

> ID：14096207
> 
> 赞同：1
> 
> 时间：2012-12-31T00:35:05.310
> 
> 标签：javascript, regex, replace

试图用相同的词替换 HTML 页面中的某些词，但作为链接到该资源的 URL。例如，将单词“MySQL”替换为`<a href="http://mysql.com">MySQL</a>`

使用带有正则表达式的 JS 替换函数，它的替换效果很好。

**但它也替换了已经是 URL 一部分的单词……这就是问题所在。**

对于 MySQL 示例，它同时替换了已经链接的“MySQL”文本和指向 mysql.com 的 URL，因此破坏了已经存在的链接。

有没有办法更新内联正则表达式（在 .replace 调用中）以不在现有链接（即元素）中进行替换？

这是替换代码：

```
var NewHTML = OriginalHTML
.replace(/\bJavaScript\b/gi, "<a href=\"http://js.com/\">$&</a>")
.replace(/\bMySQL\b/gi, "<a href=\"http://www.mysql.com/\">$&</a>")
; 
```

这是完整的示例代码（试图将其粘贴到内联，但反引号看起来不正确）： http: [//pastie.org/private/v4l2s2c42aqduqlopurpw](http://pastie.org/private/v4l2s2c42aqduqlopurpw)

浏览了 JS 正则表达式参考（[此处](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp)），并在正则表达式匹配中尝试了各种其他排列，如下所示，但所有这些都使它与页面上的任何单词都不匹配...... `.replace(/\b(\<a\>*!\>)JavaScript\b/i,xxxxx`

以下正则表达式确实会阻止匹配发生在单词实际上触及斜杠或破折号的任何地方......但这不是解决方案（并且它不能修复上面的 mysql 示例）：

```
.replace(/\b(?!\>)(?!\-)(?!\/)MySQL\b(?!\-)(?!\/)/gi, "<a href=\"http://www.mysql.com/\">$&</a>")` 
```

我已经阅读了 stackoverflow 和其他地方的相关线程，但似乎找不到这个特定的场景，无论如何都不是在 JavaScript 中。

任何帮助将不胜感激。:-)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T00:50:36.070

您可以更改您的正则表达式以排除结束锚标记之前的关键字，`</a>`：

```
.replace(/\bMySQL\b(?![^<]*?<\/a>)/gi, "<a href=\"http://www.mysql.com/\">$&</a>") 
```

例如，参见[jsfiddle](http://jsfiddle.net/bozdoz/PMCAE/7/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:46:27.987

负前瞻应该就足够了：

```
.replace(/\bMySQL(?!\.com)\b/gi, "<a href=\"http://www.mysql.com/\">$&</a>") 
```

# css - 如何在 CSS 中获得无限垂直滚动的图像？

> ID：14096209
> 
> 赞同：2
> 
> 时间：2012-12-31T00:35:10.733
> 
> 标签：css, css-animations

我正在尝试添加一个无限垂直滚动的图像，就像 Adam Whitcroft 的精彩[登陆页面](http://adamwhitcroft.com/batch/)一样。我看过他的源代码，但我不知道他是如何做到的。这个想法是“我是科学家”文本将出现在图像上。

我目前的代码是：

```
<div class="ani">
    <div class="container">
            <img src="img/Gene.png" alt="Scrolling Genes" />
        </div> 
<h3> I'm a scientist. </h3>
    <p> I worked at.... </p> 
```

“ani”类的 CSS 是：

```
.ani {
background: url(img/Gene.png);
color:#ecf2f9;
text-align:center;
-webkit-animation:bgscroll 20s infinite linear;
} 
```

对于“容器”：

```
 .header .container {
    max-width:400px;
} 
```

该代码（可耻地）取自我上面提到的网站。对于我的生活，我*无法*弄清楚如何在文本上方创建滚动图像。

*非常*感谢提前。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T00:50:03.233

你的代码很好。您只是忘记定义动画。

```
@-webkit-keyframes bgscroll {
    from {background-position:0 0;}
    to {background-position:0 -520px;}
} 
```

这是您想要的示例： http: [//codepen.io/joe/pen/hdoIk](http://codepen.io/joe/pen/hdoIk)

显然，您必须用您的图片更改图片并为动画定义好​​的高度。

要获得完整的浏览器支持，请不要忘记添加所有 CSS 前缀供应商。更多信息在这里：[http](http://www.w3schools.com/css3/css3_animations.asp) ://www.w3schools.com/css3/css3_animations.asp （-wekbit -moz -o）

您只需将代码粘贴到以下位置即可轻松完成：http: [//prefixr.com](http://prefixr.com)

希望能帮助到你。

# ruby-on-rails - Mongoid 排除所有带有 :state of "this" OR "that" 的记录？

> ID：14096213
> 
> 赞同：0
> 
> 时间：2012-12-31T00:35:56.620
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, mongoid

`Model.excludes(state: "this).excludes(state: "that")`

产生：

`"state"=>{"$ne"=>"that"}`

但我真正想要的是排除所有具有“this”或“that”的记录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T16:10:52.703

这是一个使用 Model.not_in 的工作测试

[http://two.mongoid.org/docs/querying/criteria.html#not_in](http://two.mongoid.org/docs/querying/criteria.html#not_in)

应用程序/模型/model.rb

```
class Model
  include Mongoid::Document
  field :state, type: String
end 
```

测试/单元/model_test.rb：

```
require 'test_helper'

class ModelTest < ActiveSupport::TestCase
  def setup
    Model.delete_all
  end

  test "not_in" do
    Model.create({ state: 'this' })
    Model.create({ state: 'that' })
    Model.create({ state: 'not this or that'})
    assert_equal(3, Model.count)
    p Model.not_in(state: ['this', 'that']).to_a
    assert_equal(1, Model.not_in(state: ['this', 'that']).to_a.count)
  end
end 
```

耙式测试：

```
Run options:

# Running tests:

[#<Model _id: 50e6fdef29daeb27e5000003, _type: nil, state: "not this or that">]
.

Finished tests in 0.021175s, 47.2255 tests/s, 94.4510 assertions/s.

1 tests, 2 assertions, 0 failures, 0 errors, 0 skips 
```

# c++ - C++ - CreateRemoteThread DLL 注入 [Windows 7]

> ID：14096215
> 
> 赞同：2
> 
> 时间：2012-12-31T00:36:32.687
> 
> 标签：c++, windows, dll, process, code-injection

无论我在哪里查看通过 CreateRemoteThread 注入的方法都是相同的，但是获取进程 ID 的方法不是......我的函数将返回正确的进程 ID，我对任何帮助不感兴趣，所以我将 void那部分只包括实际注射。

我只是在学习 DLL 注入并尝试在 notepad.exe 上进行。如果注入成功，记事本的标题将从“Untitled - Notepad”变为“Hooked”。

```
#define DLL_NAME "injectme.dll"

.....

BOOL InjectRemoteThread(DWORD ProcessID)
{
    HANDLE RemoteProc;
    char buf[50]        =   {0};
    LPVOID MemAlloc;
    LPVOID LoadLibAddress;

    // Process ID does show correctly!
    WCHAR id[100];
    StringCbPrintf(id, 100, L"%d", ProcessID); // id contains the process ID... is confirmed in comparing ID shown in tasklist and the messagebox.
    MessageBox(NULL, id, L"Process ID", MB_ICONINFORMATION);
    // Process ID does show correctly!

    if ( !ProcessID )
    {
        MessageBox(NULL, (LPCWSTR)GetLastError(), L"An error occured", NULL);
        return 0;
    }
    RemoteProc          =   OpenProcess(PROCESS_VM_OPERATION | PROCESS_VM_WRITE | PROCESS_CREATE_THREAD | PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, FALSE, ProcessID);
    if ( !RemoteProc )
    {
        MessageBox(NULL, (LPCWSTR)GetLastError(), L"An error occured", NULL);
        return 0;
    }
    LoadLibAddress      =   (LPVOID)GetProcAddress(GetModuleHandleA("kernel32.dll"), "LoadLibraryA");
    MemAlloc            =   (LPVOID)VirtualAllocEx(RemoteProc, NULL, strlen(DLL_NAME)+1, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE);
    WriteProcessMemory(RemoteProc, (LPVOID)MemAlloc, DLL_NAME, strlen(DLL_NAME)+1, NULL);
    CreateRemoteThread(RemoteProc, NULL, NULL, (LPTHREAD_START_ROUTINE)LoadLibAddress, (LPVOID)MemAlloc, NULL, NULL);

    CloseHandle(RemoteProc);
    VirtualFreeEx(RemoteProc, (LPVOID)MemAlloc, 0, MEM_RELEASE | MEM_DECOMMIT);
    return 1;
} 
```

DLL 适用于使用另一个人的注入器，但我不明白为什么......它确实与注入器位于同一目录中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T01:38:58.763

我发现了问题......我觉得自己很愚蠢。任何有类似问题的人：不要使用相对路径，而是使用绝对路径。

我变了

```
#define DLL_NAME "injectme.dll" 
```

至

```
#define DLL_NAME "C:\\Users\\Raikazu\\Documents\\Visual Studio 2012\\Projects\\Hooking\\Release\\injectme.dll" 
```

# silverstripe - $Pos 从底部 <% loop DataObjects %>

> ID：14096216
> 
> 赞同：1
> 
> 时间：2012-12-31T00:36:45.940
> 
> 标签：silverstripe

可以在模板中的循环内通过 DataObject 以某种方式告诉您是否处于 $Pos 24 但从底部开始计数 - 例如：

```
<% if Pos = "-24" %>do stuff<% end_if %>
or like
<% if TotalItems - 24 = Pos %>do stuff<% end_if %>
or like
<% if Last(24) %>do stuff<% end_if %> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T01:02:21.970

在 Silverstripe 3 中，能够做到：

```
<% if FromBottom(24) %>
  Hello
<% end_if %> 
```

您必须将`MyCustomIteratorFunctions.php`以下内容添加到您的 /code 文件夹中：

```
<?php
class MyCustomIteratorFunctions implements TemplateIteratorProvider
{

  protected $iteratorPos;
  protected $iteratorTotalItems;

  public static function get_template_iterator_variables()
  {
    return array('FromBottom');
  }

  public function iteratorProperties($pos, $totalItems)
  {
    $this->iteratorPos = $pos;
    $this->iteratorTotalItems = $totalItems;
  }

  function FromBottom($num)
  {
    return (($this->iteratorTotalItems - $this->iteratorPos) == $num);
  }
} 
```

如此处所示：[https ://groups.google.com/forum/#!msg/silverstripe-dev/DVBtzkblZqA/PWxanKGKDYIJ](https://groups.google.com/forum/#!msg/silverstripe-dev/DVBtzkblZqA/PWxanKGKDYIJ)

# javascript - Persisting knockout ViewModel between ASP.NET WebForms server side posts ...

> ID：14096219
> 
> 赞同：5
> 
> 时间：2012-12-31T00:37:24.170
> 
> 标签：javascript, asp.net, knockout.js, webforms

Using this article posted on CodeProject.com, "[Using KnockoutJS in your ASP.NET applications](http://www.codeproject.com/Articles/153735/Using-KnockoutJS-in-your-ASP-NET-applications)" as a guide I am attempting to create a reusable, data-loaded drop down list using ASP.NET 3.5 Web Forms, but that leverages KnockoutJS for client-side data-binding. Multiple, independent instances of this drop down should be able to live independently in the same page.

So far the CodeProject.com post has been invaluable in directing me on how to set things up and I am successfully passing the updated ViewModel data back and forth between the server and client as a JSON string and converting it to and from an object (both on the server and client). What I am hanging up on is what should be the simple part; binding the ViewModel to the drop down list!

So I begin by loading the JSON string into a hidden field. It includes a list of Regions and a single SelectedRegion.

```
<input type="hidden" id="ddlRegionKO_hdnRegionListVMStorage" value="{&quot;Regions&quot;:[{&quot;RegionName&quot;:&quot;Mid Atlantic USA&quot;,&quot;RegionId&quot;:2},{&quot;RegionName&quot;:&quot;Mid West USA&quot;,&quot;RegionId&quot;:10},{&quot;RegionName&quot;:&quot;North Central USA&quot;,&quot;RegionId&quot;:5},{&quot;RegionName&quot;:&quot;North East USA&quot;,&quot;RegionId&quot;:1},{&quot;RegionName&quot;:&quot;North West USA&quot;,&quot;RegionId&quot;:7},{&quot;RegionName&quot;:&quot;Other&quot;,&quot;RegionId&quot;:9},{&quot;RegionName&quot;:&quot;South Central USA&quot;,&quot;RegionId&quot;:6},{&quot;RegionName&quot;:&quot;South East USA&quot;,&quot;RegionId&quot;:3},{&quot;RegionName&quot;:&quot;South West USA&quot;,&quot;RegionId&quot;:8}],&quot;SelectedRegion&quot;:{&quot;RegionName&quot;:&quot;North Central USA&quot;,&quot;RegionId&quot;:5}}" /> 
```

I then run convert this string into a Javascript Object using the `ko.utils.parseJson()` function.

```
var stringViewModel = document.getElementById("ddlRegionKO_hdnRegionListVMStorage").value;
var ddlRegionKO_pnlRegionDDLContainer_ViewModel = ko.utils.parseJson(stringViewModel); 
```

Then I convert the property definitions into `ko.observable` and `ko.observableArray` methods (this is one of those sections that will be need to be refactored, but as a proof of concept it suffices).

```
//
// Convert all the model properties to KO Propety/Methods
for (var propertyName in ddlRegionKO_pnlRegionDDLContainer_ViewModel) {
    switch(propertyName.toUpperCase())
    {
        //
        // Multiple Region objects are stored as an array in the regions property.
        case "REGIONS":
            ddlRegionKO_pnlRegionDDLContainer_ViewModel[propertyName] = ko.observableArray(ddlRegionKO_pnlRegionDDLContainer_ViewModel[propertyName]);
            break;
        //
        // Only a single region may be selected at any time.
        case "SELECTEDREGION":
            ddlRegionKO_pnlRegionDDLContainer_ViewModel[propertyName] = ko.observable(ddlRegionKO_pnlRegionDDLContainer_ViewModel[propertyName]);
        break;
    };
}; 
```

Given this, I would expect the drop down list to be populated and the SelectedRegion selected when the `applyBindings` method is called ...

```
ko.applyBindings(ddlRegionKO_pnlRegionDDLContainer_ViewModel); 
```

I have put this all together at JSFiddle ... [here](http://jsfiddle.net/fV2Az/7/) ... I suspect that I may be overlooking something but I cannot see what it might be. Everything looks right to me.

If anybody can see something that I am overlooking I would be extremely grateful!

Thanks,

-g

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:49:39.720

You don't need to specify the model name in your bindings. Instead of `options:ddlRegionKO_pnlRegionDDLContainer_ViewModel.Regions`, just use `options:Regions`, etc.

```
<select id="ddlRegionKO_ddlRegionList" 
    data-bind="options:Regions, 
        optionsText:'RegionName', 
        optionsValue:'RegionId',
        value:SelectedRegion, 
        optionsCaption:'Choose Region ...'">
</select> 
```

[Working fiddle](http://jsfiddle.net/Ds44T/2/)

Edit: You were also missing an optionsValue binding that specified which property you want to be bound to the value of each option. I updated the fiddle to include this change.

Edit 2: Well, your selected region in your json is an object. I looked over the knockout [documentation](http://knockoutjs.com/documentation/options-binding.html) about binding and I didn't see a way to bind a selected value to an object, so if it's possible for you to modify the json, you can just specify the id of the selected value.

```
<input type="hidden" 
    id=".."
    data-bind="..a bunch of array stuff...  ,&quot;SelectedRegion&quot;:5}" 
/> 
```

See what I did there? I replaced the object

```
'SelectedRegion':{'RegionName':'North Central USA','RegionId':5} 
```

with just:

```
'SelectedRegion':5 
```

[Updated fiddle is here](http://jsfiddle.net/Ds44T/4/). But this won't help with your textbox situation because it will show the ID instead of the text in your textbox. It's a bit late here so I'm not really sure how to fix that off hand, but you might look [here](https://stackoverflow.com/questions/6962532/knockout-js-bind-text-to-property-of-child-object) for some inspiration. Good luck.

# php - Datetime 的 NOW() 函数不适用于 PDO-MYSQL 准备好的语句？

> ID：14096220
> 
> 赞同：5
> 
> 时间：2012-12-31T00:37:35.417
> 
> 标签：php, mysql, pdo, prepared-statement

我有一个数据库表`timetable`，其中有一个`DATETIME`名为`created_on`.

```
created_on DATETIME,
notes VARCHAR(255) NOT NULL 
```

我使用该`NOW()`函数通过 PDO 准备语句插入当前时间。

```
INSERT INTO timetable(created_on, note)
VALUES(?, ?); 
```

所以在绑定值并执行准备好的语句之后......

```
$notes ="This is a note...";
$values =array("NOW()", $notes);
$stm->execute($values); 
```

... `notes`MySQL 表中的列写入预期数据，但`created_on`列产生...

```
0000-00-00 00:00:00 
```

我不想使用 Unix 纪元时间戳。那么我如何让`DATETIME`函数 `NOW()`工作呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T00:41:55.780

不要`NOW()`作为参数传递，

```
INSERT INTO timetable(created_on, note) VALUES(NOW(), ?); 
```

所以你只需要绑定笔记。

```
$values =array($notes); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T00:41:16.557

您`NOW()`作为字符串传递，而不是 mysql 表达式。

像这样使用：

```
INSERT INTO timetable(created_on, note)
VALUES(now(), ?); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-28T03:30:47.517

The keyword NOW() is a MySQL reserved variable and needs to go into the SQL definition, can not be bind. All the SQL keywords (SELECT, FROM, WHERE, Columns names, etc) can not be bind, needs to go into the SQL declaration.

# file-upload - Wicket：FileUploadPage 不刷新文件路径

> ID：14096221
> 
> 赞同：1
> 
> 时间：2012-12-31T00:37:41.137
> 
> 标签：file-upload, wicket

再次，我遇到了检票口问题。我正在尝试使用我的类“FileUploadPanel”上传数据，该类在另一个页面“A 类”上实现：

**A级**

```
...
/* uploadfields for Picture and Video */
ArrayList<String> picExt = new ArrayList<String>();
ArrayList<String> videoExt = new ArrayList<String>();
picExt.add("jpg");
videoExt.add("mp4");
final FileUploadPanel picUpload = new FileUploadPanel("picUpload", "C:\\", picExt);
final FileUploadPanel videoUpload = new FileUploadPanel("videoUpload", "C:\\", videoExt);

final Form form = new Form("form"){
      protected void onSubmit() {
      ...
      // Save the path of Video and Picture into Database
      table.setVideo(videoUpload.getFilepath());
      table.setPicture(picUpload.getFilepath());
      ...
}
... 
```

**类 FileUploadPanel**

```
public class FileUploadPanel extends Panel {

private static final long serialVersionUID = -2059476447949908649L;
private FileUploadField fileUpload;
private String UPLOAD_FOLDER = "C:\\";
private String filepath = "";
private List<String> fileExtensions;

/**
 * Constructor of this Class
 * @param id the wicket-id
 * @param uploadFolder the folder, in which the File will be uploaded 
 * @param fileExtensions List of Strings
 */
public FileUploadPanel(String id, String uploadFolder, List<String> fileExtensions) {
    super(id);
    this.UPLOAD_FOLDER = uploadFolder;
    this.fileExtensions = fileExtensions;
    add(fileUpload = new FileUploadField("fileUpload"));
}

@Override
public void onComponentTag(ComponentTag tag){
    // If no file is selected on startup
    if(fileUpload.getFileUpload() == null){
        return;
    }
    final FileUpload uploadedFile = fileUpload.getFileUpload();
    if (uploadedFile != null) {

        // write to a new file, 
        File newFile = new File(UPLOAD_FOLDER
            + uploadedFile.getClientFileName());
        filepath = UPLOAD_FOLDER + uploadedFile.getClientFileName();

        // if file in upload-folder already exists -> delete it
        if (newFile.exists()) {
            newFile.delete();
        }

        try {
            newFile.createNewFile();
            uploadedFile.writeTo(newFile);

            info("saved file: " + uploadedFile.getClientFileName());
        } catch (Exception e) {
            throw new IllegalStateException("Error");
        }
     }
}

public String getFilepath() {
    return filepath;
} 
```

}

好吧，如果我在“A 类”上使用提交按钮，图片和视频会保存在 C:\ 上，这到目前为止非常好。我以为我终于和检票口相处了，但我欢呼得太快了……

问题：数据库中没有保存正确的路径，以“A类”的形式处理我真的不明白，因为我的FileUploadPanel的onComponentTag（...）必须在使用提交按钮时执行。那是因为我在 onComponentTag(...) 中添加了一些验证，例如“图片必须是 JPG 或不会被保存” - 这很有效。所以我确定，使用表单的提交按钮时会执行 onComponentTag(...) ，这也意味着文件路径应该是最新的。

这次我做错了什么？

预先感谢！

问候 V1nc3nt

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T06:49:15.047

您正在使用

> 文件 newFile = new File(UPLOAD_FOLDER + uploadFile.getClientFileName());

此代码创建一个新文件。

**而不是**它，你可以试试这个：

> 文件文件 = 新文件（UPLOAD_FOLDER，uploadFile.getClientFileName());

然后获取**绝对路径**并**保存**：

> newFile.getAbsolutePath();

# smalltalk - #isolate 方法在 Pharo-1.4-14557-OneClick 中的 Seaside 中不存在

> ID：14096223
> 
> 赞同：0
> 
> 时间：2012-12-31T00:38:04.600
> 
> 标签：smalltalk, pharo, seaside

我已经使用了查找器并查看了 WAComponent 以及子类和超类，但它绝对不存在。我已经完成了软件更新。

如果它已被故意删除，我该如何复制逻辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T08:03:31.997

`isolate:`不再是当前版本的 Seaside 的一部分。请参阅此[错误报告](http://code.google.com/p/seaside/issues/detail?id=553)以获得非常技术性的解释。

# kml - 控制地标上的标签可见性

> ID：14096226
> 
> 赞同：2
> 
> 时间：2012-12-31T00:38:21.410
> 
> 标签：kml, google-earth

我有一个 kml 文件，其中包含许多简单的点地标，每个地标的名称都涵盖美国。我试图找到一种方法来控制他们的标签显示，以便视图在更高的高度不会混乱。我已经看到提到使用区域，但似乎这必须应用于每个地标。我知道必须为此提供一些东西，因为 GE 正在默认图层（即 Populated Places）上执行此操作。此外，当我将标签缩小到足够远时，似乎有一些默认值在起作用，而我的 kml 上没有任何输入。

任何意见表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T18:44:21.463

要控制 KML 中标签的显示，您可以使用您提到的 Regions 和/或带有正常和突出显示的 LabelStyle 的 StyleMap。

如果您捕获到 Google Earth 的 HTTP 流量，您会注意到*Borders 和 Labels*默认层（以及其他）是使用 Regions 和嵌套 NetworkLinks 实现的 KML 文件。

**地区**

如果您不想在每个地标上创建一个[区域](https://developers.google.com/kml/documentation/kmlreference#latlonaltbox)，那么您可以将地标分组到文件夹中，并在文件夹上设置一个区域来控制地标何时可见。正确创建区域需要反复试验。您甚至可能不需要指定最小/最大高度 - 区域尺寸的适当*minLodPixels*值可能就足够了。

可以在此处找到有关区域的教程。
[https://developers.google.com/kml/documentation/regions](https://developers.google.com/kml/documentation/regions)

**样式图**

您可能希望创建一个[StyleMap](https://developers.google.com/kml/documentation/kmlreference#stylemap)，其中普通 Style 的 LabelStyle 的比例为 0 以完全抑制标签或较小的值以简单地减少混乱。

```
 <Style id="sn_style">
        <LabelStyle>
            <scale>0</scale>
        </LabelStyle>
    </Style>

    <Style id="sh_style">
        <LabelStyle>
            <scale>1.1</scale>
        </LabelStyle>
    </Style>

   <StyleMap id="msn_style">
        <Pair>
            <key>normal</key>
            <styleUrl>#sn_style</styleUrl>
        </Pair>
        <Pair>
            <key>highlight</key>
            <styleUrl>#sh_style</styleUrl>
        </Pair>
    </StyleMap> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-14T09:55:04.803

有同样的问题，我找不到任何快速解决方案，因为我的 .kml 包含近 10k POI。所以我所做的是添加常见问题解答提供的代码，所以我的标题看起来像这样：

```
<?xml version="1.0" encoding="utf-8" ?>
<kml xmlns="http://www.opengis.net/kml/2.2">
<Document><Folder><name>name</name><Style id="hideLabel"><LabelStyle><scale>0</scale></LabelStyle></Style> 
```

我将第一个地标更改为：

```
Placemark>
    <name>name</name>
    <styleUrl>#hideLabel</styleUrl>
    <ExtendedData><SchemaData schemaUrl="#name">
        <SimpleData name="Name">name</SimpleData>
        <SimpleData name="Latitude">xxxx</SimpleData>
        <SimpleData name="Longitude">yyyy</SimpleData>
    </SchemaData></ExtendedData>
      <Point><coordinates>xxxx,yyyy</coordinates></Point>
  </Placemark> 
```

之后，我将 .kml 加载到 Google 地球并右键单击它以选择属性。选择“样式，颜色”选项卡，它应该说明以下内容：

> 此文件夹的后代不共享相同的样式。如果要强制所有后代共享相同的样式，请单击下面的按钮

单击“共享样式”下方的按钮，它将暂时隐藏所有标签。

亲切的问候，

托马斯

# mod-rewrite - 需要一个 Nginx 重写规则

> ID：14096228
> 
> 赞同：0
> 
> 时间：2012-12-31T00:38:23.073
> 
> 标签：mod-rewrite, url-rewriting, nginx

我在我的网站上遇到了一个损坏的 nginx 重写规则，这是我修复它的最后一线希望。

阿帕奇规则是这样的：

```
RewriteRule ^file/([0-9]+)?/([0-9]+)x([0-9]+)/([^/\.]+) image.php?id=$1&width=$2&height=$3&cropratio=$4 [L] 
```

我已经做到了这一点，但它仍然无法正常工作

```
rewrite ^/file/([0-9]+)?/([0-9]+)x([0-9]+)/([^/.]+) /image.php?id=$1&width=$2&height=$3&cropratio=$4 last; 
```

甚至这个：

```
rewrite ^/file/([0-9]+)?/([0-9]+)x([0-9]+)/([^/\.]+) /image.php?id=$1&width=$2&height=$3&cropratio=$4 last; 
```

我的图片都没有出现，所以如果有人有一个很棒的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:21:36.957

请试试

```
location /file/ {
    rewrite ^/file/([0-9]+)?/([0-9]+)x([0-9]+)/([^/\.]+) /image.php?id=$1&width=$2&height=$3&cropratio=$4 break;
} 
```

# ruby-on-rails-3 - Rails 教程 - 不理解第 11 章中关注/取消关注用户的实现

> ID：14096232
> 
> 赞同：0
> 
> 时间：2012-12-31T00:39:17.820
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2, railstutorial.org

我的主要困难来自于理解 the `_follow`and `_unfollow`partials 与第 11.2.3 章中定义的and[方法](http://ruby.railstutorial.org/chapters/following-users#sec-following_and_followers_pages)`create`之间`destroy`的关系。我现在只关注**取消关注**用户的行为（因为关注的行为大多是类似的）。`RelationshipsController`

 **Hartl 将部分 for 定义`unfollow`为：

```
<%= form_for(current_user.relationships.find_by_followed_id(@user), html: { method: :delete }) do |f| %> 
    <%= f.submit "Unfollow", class: "btn btn-large" %>
<% end %> 
```

以及相应的`destroy`操作：

```
def destroy
    @user = Relationship.find(params[:id]).followed
    current_user.unfollow!(@user)
    redirect_to @user
end 
```

我难以理解的是：

1.  部分 ..`@user`第一行中的变量是**a)**在当前显示页面的操作中定义的，*还是***b)**在操作中定义的？看来helper 已经找到要销毁的了，那为什么action 还需要在控制器中重新找到要销毁的呢？`unfollow`**`show` ***`destroy``form_for``@user``destroy``@user`*****
******   在该`destroy`方法中，`@user`首先找到Relationship id。我没有看到关系 id 首先是如何传递到 URI 中的（因为看到要取消关注的特定用户显示为`/users/2`），更不用说它是如何用于查找`@user`要销毁的了。我知道每个关系表都有一个 id、一个 follower_id 和一个 follower_id，但看不到 id 元素本身是如何在这里发挥作用的。*****

 *****感谢您阅读并回答我的问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:57:39.747

1.) 如果在操作中呈现部分内容`show`，则必须在该操作中定义变量 @user。Rails 不会执行该`destroy`方法，因此其中的变量定义将永远不会被执行。

由于 HTTP 是无状态协议，服务器需要为每个请求创建必要的状态。这就是为什么必须在每个操作中定义@user。

2.) 你在哪里检查 url 是“/users/2”？由于我没有看到整个代码，我只能猜测，但以下行`current_user.relationships.find_by_followed_id(@user)`应该返回一个`Relationship`对象。它将被翻译成类似“/relationships/8”的东西，其中 8 是`Relationship`. 因为您指定了 `method: :delete，所以将调用销毁操作。

我认为 url "/users/2" 是在执行销毁操作之后执行删除。销毁操作中可能存在重定向。（例如。`redirect_to current_user`）。您可以在日志文件中看到所有调用的操作。尝试滚动浏览日志，看看是否可以找到`RelationshipsController#destroy`. 您将在那里看到调用的 url。您还可以检查 HTML 以查看`<form>`标记的“动作”属性指向的位置。*******

# javascript - 检查 ul 中是否存在特定的 li 元素

> ID：14096233
> 
> 赞同：2
> 
> 时间：2012-12-31T00:39:21.540
> 
> 标签：javascript

我有一个脚本，它将 li 元素添加到 ul 并根据用户在 select 元素中的选择为其分配一些属性。但是，我认为有必要确保 li 元素不存在于 ul 中。但是，我不确定，但我认为要么数组没有为它分配变量，要么我比较数组的 if 语句有问题。当然，我可能完全不在了。我难住了。

```
function anotherCounty(){    
  var newCounty = document.forms['newForm'].county.value;
  var ul = document.getElementById("counties"); 
  var items = ul.getElementsByTagName("li");
  var itemArray = new Array();
  for (var i = 0; i < items.length; i++){
    itemArray.push(items[i]);
  }

  if (itemArray.indexOf(newCounty)<'0'){//I've also tried ==-1 and <0
    var new_item = document.createElement("li");
    new_item.id = "addCounty[]";
    new_item.innerHTML = newCounty;
    ul.insertBefore(new_item, ul.firstChild);
  }  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:51:59.867

而不是使用 indexOf，您最好使用这种方法：

```
function anotherCounty() {

    var newCounty = document.forms['newForm'].county.value;
    var ul = document.getElementById("counties");   
    var items = ul.getElementsByTagName("li");
    for (var i = 0; i < items.length; i++){
        if(items[i].value == newCounty) return;
    }

    var new_item = document.createElement("li");
    new_item.id = "addCounty[]";
    new_item.innerHTML = newCounty;
    ul.insertBefore(new_item, ul.firstChild);

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:43:43.537

您正在将字符串与 DOM 元素进行比较。我认为这是你真正需要的：

```
itemArray.push(items[i].value); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-21T17:41:03.080

我知道这个线程很旧，但我遇到了同样的问题，对我有用的是

```
itemArray.push(items[i].innerHTML); 
```

# php - 如何在php中调用函数/方法将函数返回值插入mysql

> ID：14096236
> 
> 赞同：1
> 
> 时间：2012-12-31T00:39:34.260
> 
> 标签：php, mysql

```
<?php
$fname = $_POST['fname'];
$lname = $_POST['lname'];
$email = $_POST['email'];

function random_string($length) {
    $key = '';
    $keys = array_merge(range(0, 9), range('a', 'z'));

    for ($i = 0; $i < $length; $i++) {
        $key .= $keys[array_rand($keys)];
    }

    return $key;
}

if($email)
{

$connect = mysql_connect(" HOST ", " USERNAME ", " PASSWORD") or die("Couldn't Connect");

mysql_select_db("CiniCraftData") or die ("Couldn't Find Database"); 

            $query = "INSERT INTO customers (fname, lname, email, alphanum) VALUES ('$fname', '$lname', '$email', 'random_string(10)')";
            $result = mysql_query($query) or die("Some kind of error occured.");

            echo ("Welcome " + $username + ", you are now in my database!");

}
else die("You did not fill out the fields correctly, please try again.");

?> 
```

我需要帮助以 $query = "INSER ... 'random_string(10)')"; 开头的中间行

我需要一个随机字母数字字符串插入到名为“customers”的表中，但不是调用函数“random_string()”，而是将“random_string(10)”插入到我的表中，这为我的表提供了 6 个字段：

```
5   John    Smith   Jogsz@CiniCraft.com random_string(10)   0 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T00:42:34.333

```
$query = "INSERT INTO customers (fname, lname, email, alphanum) VALUES ('$fname', '$lname', '$email', '" . random_string(10) . "')"; 
```

这应该工作！我认为即使双引号会解析变量，它们也不会解析函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T00:43:43.440

连接函数和你的字符串，

```
$query = "INSERT INTO customers (fname, lname, email, alphanum) VALUES ('$fname', '$lname', '$email', '" . random_string(10) ."')"; 
```

作为旁注，`SQL Injection`如果变量的值来自外部，则查询很容易受到攻击。请看下面的文章，了解如何预防。通过使用 PreparedStatements，您可以摆脱在值周围使用单引号。

*   [如何*防止*PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T00:43:58.417

做两个陈述。在第一条语句中，您调用函数并将值分配给变量，然后在`INSERT...`语句中使用该变量

# grammar - 有人可以举一个上下文相关语法的简单但非玩具示例吗？

> ID：14096237
> 
> 赞同：6
> 
> 时间：2012-12-31T00:39:35.390
> 
> 标签：grammar, automata, computation-theory, language-theory, context-sensitive-grammar

我正在尝试理解上下文相关的语法，并且我理解为什么语言喜欢

> 1.  {ww | w 是一个字符串}
> 2.  {一个^n b ^n c ^n | a,b,c 是符号}

不是上下文无关的，但我想知道类似于无类型 lambda 演算的语言是否对上下文敏感。我想看一个简单但非玩具的示例（我考虑上面的玩具示例），上下文相关语法的示例，对于某些生产规则，例如，判断是否有一些符号字符串当前在范围内（例如，在生成函数体时）。上下文相关的语法是否足够强大，可以使未定义/未声明/未绑定的变量成为语法（而不是语义）错误？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T08:39:44.517

是的，上下文相关语法 (CSG) 足够强大，可以检查未定义/未声明/未绑定的变量，但不幸的是，我们不知道任何有效的算法来解析 CSG 字符串。

上下文相关语言的一个真实例子是 C 编程语言。像先声明变量然后再使用它们这样的特性使 C 语言成为一种[上下文敏感语言](http://en.wikipedia.org/wiki/Context-sensitive_language)(CSL)。（*我不知道无类型的 lambda 演算*）。

而且因为我们不知道 CSL（或 CSG）的任何线性解析算法。这就是编译器设计中的原因，我们使用 CFG（及其解析算法）进行语法检查，因为我们知道解析 CFG 的有效算法（如果它是受限形式）。编译器首先解析上下文无关特征，然后以有问题的方式处理上下文相关特征（例如，检查符号表中是否已定义任何使用的变量。否则，它会产生错误）。

[在自然语言处理](http://en.wikipedia.org/wiki/Natural_language_processing)(NLP)中也使用上下文相关语法。大多数自然语言都是上下文相关语言的例子。（我不确定[梵文](http://en.wikipedia.org/wiki/Sanskrit)）。

我将尝试用一个*愚蠢*但简单的例子来解释它（这只是一个想法，你可以完善它）：

```
NOUN     -->  { BlueBomber, Grijesh, I, We}
TENSE    -->  { am, was, is, were}
VERB     -->  { going, eating, working}

SENTENCE --> <NOUN> <TENSE> <VERB> 
```

现在，使用这个语法，我们可以生成一些正确的语句，但也有一些是错误的。例如，

```
SENTENCE --> <NOUN>   <TENSE>   <VERB>
             Grijesh    is       working       [Correct statement] 
```

但

```
 Grijesh    am       working       [wrong statement] 
```

原因：<TENSE> 的值取决于值 <NOUN>（例如，`I <TENSE> --> I am`），因此语法不会生成正确的英语语句。

实际上，我们不能为完整的英语编写上下文无关的语法！

[您可能已经注意到，任何自然语言翻译器或语法检查器都无法正常工作（尝试使用长语句）。因为这个问题属于上下文相关的解析算法。]

* * *

**参考**：您可以观看[Arun Kumar 博士的讲座](http://www.youtube.com/watch?v=_5HPxRnOVCQ)。 [在某些讲座中，他准确地解释了您感兴趣的内容。]

# git - 为什么 git-cherrypick 什么也没说

> ID：14096244
> 
> 赞同：47
> 
> 时间：2012-12-31T00:41:38.120
> 
> 标签：git, github, gerrit, git-cherry-pick

我为以下问题搜索了很多，但无法获得任何实质性信息...请帮助我，创建了一个临时分支 202116 并尝试对 gerrit 202116 进行挑选，我收到以下消息，为什么我没有能够挑选这个 gerrit，为什么我会收到这个错误？请提供您的输入

```
<>git fetch ssh://company@company.com:29418/platform/vendor/company-proprietary/radio refs/changes/25/202116/1 && git cherry-pick FETCH_HEAD
From ssh://company.com:29418/platform/vendor/company-proprietary/radio
 * branch            refs/changes/25/206025/1 -> FETCH_HEAD
# On branch 202116
# You are currently cherry-picking.
#   (all conflicts fixed: run "git commit")
#
nothing to commit, working directory clean
The previous cherry-pick is now empty, possibly due to conflict resolution.
If you wish to commit it anyway, use:

    git commit --allow-empty 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-12-31T04:55:00.927

这正是它所说的：您尝试挑选的更改已经完全包含在您所在的分支中。即樱桃采摘的结果是没有变化。您可以创建一个带有`--allow-empty`标志的空提交，以指示您尝试挑选，但没有任何更改可以拉入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-10-10T14:34:18.057

这可能是由于尝试挑选已经集成/挑选到当前分支中的提交造成的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T02:44:03.767

我不知道你为什么要做一个`cherry-pick`after `fetch`，因为你可能会用你的`HEAD`.

是`git checkout`你真正想要的吗？我猜。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-11-04T15:13:39.497

当我误读了我的 Bitbucket 差异页面时，我收到了这条消息，将*父提交*误认为是我想要的提交。因此，我试图挑选已经在我的工作分支上的父提交 - 所以确实“没有什么可以提交”。

# css - 您如何将布局的特定 div 或部分视为它自己的独立视口？

> ID：14096245
> 
> 赞同：0
> 
> 时间：2012-12-31T00:41:39.780
> 
> 标签：css, twitter-bootstrap, responsive-design, media-queries

我正在使用下图中绘制的响应式 Web 布局。红色区域固定在屏幕上，绿色区域是可独立滚动的部分（蓝色 = 滚动条）。

![布局](../Images/a533d5b7bede1d3a9b3947d6990b36b5.png)

**我想知道 - 有没有办法（没有 iframe）获取这个布局的主要内容部分（右侧的绿色区域）并将其视为视口本身，以便内容和样式可以像是自己独立的全面屏吗？**

我尝试这样做的原因是因为我希望**尽可能简单地将第二个网站的内容直接放入这个主要内容部分，而不必调整所有页面**以适应更窄的部分的网站。

第二**个站点是使用 twitter bootstrap 构建的脚手架**，并且由于容器都是相对于某人的视口大小创建的，因此它们**不能整齐地放入稍窄的内容区域**（给定左侧边栏），而无需调整所有脚手架. 我宁愿不必调整许多页面上的所有内容，因此，我正在寻找一个技巧，看看我是否可以让它适合（交叉手指，有些东西存在！）

此外，**左侧边栏是可折叠**的——因此在某些情况下，主要内容部分会占据视口的整个宽度。因此，我希望它能够动态调整。

好像我有3个选择：

1.  浏览第二个站点的每个页面并**重新设计每个页面中的所有脚手架，**以确保它们使用稍窄的部分，基本上将左侧边栏视为第一个跨度列，然后调整整个站点以在剩余宽度。 **这个选项实际上不起作用**，因为如果侧边栏被折叠，那么主要内容区域会占据整个宽度并且现在会更窄。
2.  使用 iFrames - 由于所有影响，我不考虑这个。
3.  **不知何故，将主要内容区域视为自己的视口，以便所有脚手架都调整到它的大小，就好像它是视口本身或全屏一样。**

这有可能吗？

是否有可能更好的替代解决方案？

谢谢！

# ios - 动画约束更改 layoutIfNeeded 缓慢

> ID：14096249
> 
> 赞同：0
> 
> 时间：2012-12-31T00:42:07.323
> 
> 标签：ios, ios6, uiviewanimation, autolayout

我正在尝试使用自动布局为我`ADBannerView`的开屏和关屏设置动画。预自动布局（设置框架和动画）一切正常。现在我有以下代码，它会继续运行`viewDidLoad`以确保广告横幅不在屏幕上。

```
[UIView animateWithDuration:kADAnimationDuration
                 animations:^{
                     _addBannerDistanceFromBottomConstraint.constant = 32;
                     [self.view layoutIfNeeded];    
}]; 
```

此代码有效，但速度很*慢*。`layoutIfNeeded`需要很长时间（相对）并导致性能不佳。删除线使一切变得又好又快，但动画不起作用。

问题是......为什么这么慢/我该如何加快速度？

**编辑：**我的 UI 相当重要，我认为布置所有内容可能是原因，所以我尝试创建一个简单`UIView`的横幅并将我的`subview`横幅`layoutIfNeeded`作为`subview`. 不过性能没有变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T16:21:00.743

我创建了一个应用程序，仅此`ADBannerView`而已。存在同样的问题。我作为一个错误提交给 Apple 并得到了“重复”，所以我想这是一个已知问题。

作为一种解决方法，我从屏幕上的广告横幅开始，仅当我获得有效广告时才在屏幕上移动。虽然在情节提要中使用起来稍微有点烦人，但用户不会注意到差异，并且可以防止速度变慢。

**编辑：**我一直在更多地使用自动布局，我得出了一个不幸的结论，我似乎与 Matt Neuburg 分享了这个结论。他在一篇题为“ [iOS 上的自动布局缓慢](http://www.cocoabuilder.com/archive/cocoa/323960-auto-layout-slow-on-ios.html)”的文章中写道：

> 很遗憾，但 iOS 上的自动布局很慢。

它几乎总结了我在将我的一个应用程序转换为自动布局时遇到的几个问题。性能根本不存在。Matt 在他的帖子中给出的示例具有自动布局需要 5 倍的时间才能完成相同的任务。

现在，我想我会避免任何复杂到足以使自动布局有用的自动布局。

**编辑：** `iOS 8`处于测试阶段，约束变得更快。仍然有很多（50+）使用时，尤其是在旧设备上，但从测试到目前为止，我得到的以前的 2 秒延迟已减少到大约 0.4 秒。通过这种更改，约束可能已经被加速到足以用于一些约束繁重的视图工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T04:31:51.720

一个问题可能是在 viewDidLoad 中执行此操作，其中尚未设置视图参数，但是，我不知道为什么会使其变慢。您可以改为在 viewDidAppear 中尝试。此外，根据我在 WWDC 2012 自动布局会话中看到的内容，您应该在动画块外部而不是内部添加约束（或修改常量）。尝试将其移动到动画块上方。

# symfony - 教义 - 如何保持多对一同步？

> ID：14096250
> 
> 赞同：0
> 
> 时间：2012-12-31T00:42:08.497
> 
> 标签：symfony, orm, doctrine, mapping, associations

在阅读了 Doctrine 参考和 Symfony 教程之后，我开始将它集成到一个项目中。我遇到了一个我认为学说可以解决的问题：

我想拥有`Libraries`many `Collections`，我认为这是一个“ManytoOne”关系，因为 Collection 将保留外键。

一些片段：

在图书馆：

```
/**
*
* @var ArrayCollection
*
* @ORM\OneToMany(targetEntity="Collection", mappedBy="library")
*/
private $collections; 
```

收藏中：

```
 /**
 * @var Library
 *
 * @ORM\ManyToOne(targetEntity="Library", inversedBy="collections")
 * @ORM\JoinColumn(name="library_id", referencedColumnName="id")
 */
private $library; 
```

由于大多数注释是默认的，可以省略，这是一个非常基本的设置。

示例控制器代码：

```
 $library = new Library();
    $library->setName("Holiday");
    $library->setDescription("Our holiday photos");

    $collection = new Collection();
    $collection->setName("Spain 2011");
    $collection->setDescription("Peniscola");

    $library->addCollection($collection);

    $em=$this->getDoctrine()->getManager();
    $em->persist($collection);
    $em->persist($library);        
    $em->flush(); 
```

上面的代码不会设置表`library_id`中的列`Collection`，我认为这是因为`Library`不是所有者。

```
 $library = new Library();
    $library->setName("Holiday");
    $library->setDescription("Our holiday photos");

    $collection = new Collection();
    $collection->setName("Spain 2011");
    $collection->setDescription("Peniscola");

    $collection->setLibrary($library); <--- DIFFERENCE HERE

    $em = $this->getDoctrine()->getManager();
    $em->persist($collection);
    $em->persist($library);
    $em->flush(); 
```

作品。但我希望能够使用库添加和删除方法。

更改这些添加和删除方法来调用该`setLibrary`方法是否很常见？

```
public function addCollection(\MediaBox\AppBundle\Entity\Collection $collections)
{
    $this->collections[] = $collections;
    $collections->setLibrary($this);
    return $this;
} 
```

和

```
public function removeCollection(\MediaBox\AppBundle\Entity\Collection $collections)
{
    $this->collections->removeElement($collections);
    $collections->setLibrary(null);
} 
```

我不认为这很好。

它是学说中的最佳实践还是一般的 ORM？

提前致以诚挚的问候和感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T00:59:29.300

显然，这是要走的路。

对于有人需要它的情况：

[http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/working-with-associations.html#association-management-methods](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/working-with-associations.html#association-management-methods)

解释了这个问题。

# assembly - 以 16 位寄存器为偏移量的有效地址计算

> ID：14096257
> 
> 赞同：1
> 
> 时间：2012-12-31T00:43:03.270
> 
> 标签：assembly, nasm, intel-syntax

使用以下代码，我尝试将 ebx 的低两个字节“存储”在两个高字节中，然后使用低阶 bx 作为访问“池”偏移量的临时变量。最后，我通过右移数据来恢复原始值（它最初只使用低两个字节）。

```
rol ebx, 16

mov bl, dl
;(other operations involving bx)    
mov [pool+bx], dword esi

shr ebx, 16 
```

这与 nasm 组装得很好，但是我得到了错误

> 重定位被截断以适应：R_386_16 针对“.data”

链接时。有关如何绕过此错误的任何建议？简单地使用另一个寄存器不是一种选择，因为实际上每个寄存器都保存 esp 并且正在使用段寄存器。

编辑：我想有人会问，所以我使用的是 32 位程序集

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T01:40:46.127

因为您使用`bx`了有效地址，所以汇编器认为您想要一个 16 位地址，因此生成了链接器不满意的 16 位重定位。无论如何，它可能无法在 32 位模式下工作，因为您的变量不太可能位于地址空间的底部 64k 中。

如果您没有任何空闲寄存器，也许您可​​以使用堆栈：

```
push ebx
mov bl, dl
;(other operations involving bx)
movzx ebx, bx
mov [pool+ebx], esi
pop ebx 
```

你说只使用了低 16 位`ebx`。如果也是这种情况`edx`，您可以保存`dx`在 的前 16 位中`ebx`，例如：

```
shl ebx, 16
mov bx, dx
;(other operations involving dx)
movzx edx, dx
mov [pool+edx], esi
mov dx, bx
shr ebx, 16 
```

不，您不能在段寄存器中保存任意值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:18:58.937

用和 movzx ebx,bx 截断 bx 然后将其用作表 mov [pool+ebx],esi 的索引 :)

# php - 使用 JSON 从 MYSql 获取数据到我的 iOS 应用程序

> ID：14096258
> 
> 赞同：2
> 
> 时间：2012-12-31T00:43:18.760
> 
> 标签：php, mysql, objective-c, ios, json

好的，我发现了一些关于如何将数据从 MYSql 数据库获取到 iOS 应用程序的问题，但我只是在这里询问一些最佳实践。我知道这些都可以是单独的问题，但我希望可以以相互关联的方式回答它们。

我是否正确理解能够将数据输入 iOS 应用程序 - 我需要首先生成一个 JSON 文件，将其存储在服务器上，然后让应用程序下载这个文件？

如果之前的答案是否定的，那么这是否意味着我可以即时提取数据？

最后我看到了创建 JSON 文件的 PHP 示例，但 iOS 是在 Objective-c 中的。这是否意味着我需要加载 UIWebView 才能加载生成文件的 PHP 页面？

我有的：

我有一个 MYSql 数据库 - 它是通过 PHPMyAdmin 设置的，所以我对数据库的创建过程还不够熟悉。我会调查的。

我也可以从 PHPMyAdmin 导出 JSON 文件，但这在 iOS 应用程序中对我没有好处。

我还对从 JSON 文件到 iOS 应用程序的解析进行了排序，但我希望能够即时执行此操作，而不是创建潜在的数百个文件。

我希望有人可以在这里帮助我:-)

我不一定要代码，但会很生气地忽略它:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T01:08:34.647

问题是没有任何 iOS 库可以直接连接到 MySQL 服务器；无论如何，你真的不想那样做。因此，您需要一个能够以您的 iOS 应用程序可以理解的格式发送数据的中间服务器。请注意，这*并不*意味着数据必须是 JSON 格式。但是使用 JSON 作为数据格式非常容易。大多数语言都支持从其本机对象格式生成 JSON。

一旦你有一个能够以你喜欢的格式发送数据的服务器，你就需要为你的 iOS 应用程序编写一些方法来检索它。您不必为此使用 UIWebView。如前所述，该`NSURLConnection`框架很容易用于提出这样的请求。但是，在发出网络请求时还有很多其他因素需要考虑，其他人已经为您完成了大部分工作。我喜欢将[AFNetworking](https://github.com/AFNetworking/AFNetworking)框架与[JSONKit](https://github.com/johnezang/JSONKit)结合使用。AFNetworking 使对远程 Web 服务的异步调用非常容易，而且 JSONKit 比`NSJSONSerialization`我认为的要好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T00:57:24.490

我将数据从 MySQL 检索到我的 iOS 应用程序的方法是：

1.  在您的服务器上创建一个 PHP 文件并为 GET 方法准备它（您将从 iOS 应用程序发送数据）
2.  从您的 iOS 应用程序向您的 php 文件发送请求，例如：“www.yourdomain.com/data.php?name=...”
3.  处理有关您的 php 文件和`echo`json 输出的信息。
4.  当使用. `connectionDidFinishLoading:`_`NSData``NSJSONSerialization`
5.  对输出信息做任何你喜欢的事情

我就是这样做的。我不熟悉其他方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T00:52:50.977

PHP（和任何其他服务器端语言）可以从 MySQL 数据库中获取数据，并将其作为 JSON 即时输出到任何客户端。无需事先将 JSON 保存到磁盘。当然，从客户的角度来看，实际上没有*根本*区别（除了数据将始终是数据库中内容的最新表示）。

您也不必使用 UIWebView。有很多方法可以使用 Objective-C 发出 HTTP 请求，但您可能希望查看与`NSURLConnection`'s`sendSynchronousRequest:returningResponse:error:`方法类似的东西（我更喜欢在异步块中使用同步方法，但这不是唯一的方法） . 你可以找到很多关于如何做类似事情的教程，以及更高级别的库来简化这个过程。

# asp.net-mvc - POST 后重定向不会更改 URL

> ID：14096264
> 
> 赞同：5
> 
> 时间：2012-12-31T00:44:25.407
> 
> 标签：asp.net-mvc, asp.net-mvc-4, routes

我正在使用“发布后重定向”（http://en.wikipedia.org/wiki/Post/Redirect/Get）模式来解决它所解决的刷新问题，但之后我没有看到 URL 更改POST 和随后的 GET。

这是我的设置：

我有一个带有一些相当广泛的客户端验证的表单，然后提交。

```
@using (Html.BeginForm("AddItem", "Order", FormMethod.Post, new { Id = "addItemForm" })) 
{
    // form stuff
} 
```

客户端验证：

```
$('#addToOrder').click(function () {
    // do a bunch of validation stuff.
}

if (criteriaMet) {
    $('#addItemForm').submit();
} 
```

“添加项目”控制器：

```
public class OrderController {

[HttpPost]
public ActionResult AddItem(long? orderId, long menuItemId) 
{
    if (oneConditionIsTrue)
    {
        return RedirectToRoute("NamedRoute1", new { RouteValueDictionary values });
    }
    else
    { 
        return RedirectToRoute("NamedRoute2", new { RouteValueDictionary values });
    }
}

public class NamedRouteController
{
    public ActionResult NamedRouteAction
    {
        // do some stuff
        if (mobile)
        {
            return View("MobileView", model);
        }
        else
        {
            return View("RegularView", model);
        }
} 
```

从 POST 操作 (AddItem) 重定向后，我可以通过 GET 操作逐步返回（其中一个）。在所有这些之后，我希望浏览器中的 URL 是[http://mydomain.com/NamedRoute/NamedRouteAction](http://mydomain.com/NamedRoute/NamedRouteAction)但它是[http://mydomain.com/Order/AddItem](http://mydomain.com/Order/AddItem)。为什么是这样？RedirectToRoute 不应该更改 URL 吗？

我错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T10:08:00.467

我怀疑控制器操作是通过 AJAX 请求以某种方式调用的。例如，如果您使用 jQuery Mobile 或其他东西，这可能会发生。或者您可能编写了其他一些脚本来执行此操作 - 它劫持表单提交并发送 AJAX 请求。由于它是一个 AJAX 请求，因此您不可能期望客户端浏览器中的 url 会发生变化——这就是 AJAX 的全部意义——保持在同一页面上。

这可以通过使用 javascript 调试工具（例如 FireBug）很容易地验证。只需查看 Network 选项卡并查看 POST 请求是否是 AJAX 请求。在`Net`选项卡中找到请求并查看是否有以下请求标头：

```
X-Requested-With: XMLHttpRequest 
```

jQuery 将此 HTTP 标头附加到它发送的所有 AJAX 请求中。

因此，基本上如果您希望在 POST 请求之后发生重定向，则不应使用 AJAX 提交表单。或者更准确地说：重定向发生在服务器端（再次，您将能够在 FireBug 中看到它 - 302 状态代码），然后 XMLHttpRequest 只是遵循此重定向，但客户端浏览器不会更改其当前位置。

# objective-c - NSWindow 失去焦点时没有收到任何通知

> ID：14096270
> 
> 赞同：9
> 
> 时间：2012-12-31T00:45:52.523
> 
> 标签：objective-c, macos, cocoa, nswindow, nsnotifications

我有一个自定义的 NSWindow 类，它具有以下方法：

```
- (void)setupWindowForEvents{
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(windowDidResignKey:) name:NSWindowDidResignMainNotification object:self];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(windowDidResignKey:) name:NSWindowDidResignKeyNotification object:self];
}

-(void)windowDidResignKey:(NSNotification *)note {
    NSLog(@"notification");
    [self close];
} 
```

我打电话`[_window setupWindowForEvents];`，但`windowDidResignKey`从来没有被叫过。
这就是我调用 NSWindow 的方式：当单击状态栏项目时，我会在状态栏项目`makeKeyAndOrderFront`的正下方显示窗口，如下所示：![在此处输入图像描述](../Images/80a8627e5e2547bbf3216517c70c0cbe.png)

任何想法为什么当窗口失去焦点时我没有收到任何通知？我已经使用了这两种方法`NSWindowDidResignMainNotification`，`NSWindowDidResignKeyNotification`看看它们中的任何一个是否有效，但没有一个有效。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-31T01:15:15.017

您可能没有收到通知，因为您实际上从一开始就不是关键。您的窗口似乎是无边框的，默认情况下，无边框窗口不会获取关键窗口状态。

在您的窗口子类中，请务必在以下方法上返回 YES：

```
- (BOOL)canBecomeKeyWindow { 
    return YES; 
}

- (BOOL)canBecomeMainWindow { 
    return YES; 
} 
```

# php - CodeIgniter：无法命中控制器特定方法

> ID：14096271
> 
> 赞同：0
> 
> 时间：2012-12-31T00:45:55.533
> 
> 标签：php, codeigniter

我是 Codeigniter 的新手。在尝试访问控制器特定方法时，我收到“ `Object Not found`”异常。

在点击网址之前，我做了以下更改：

*   base_url 设置为`http://localhost/test/`config.php
*   default_controller 设置为`main`
*   在 main.php 类中定义索引和登录方法

如果我尝试点击 just `http://localhost/test/`，它会从 index 方法返回 echo。但是，如果我直接给出`http://localhost/test/main/login`，那么它会引发`Object not found`异常。
奇怪的是，如果我`$this->login();`进入主控制器类的索引方法，就会`http://localhost/test/`点击登录方法。我试图将登录方法更改为`public`但没有运气。我在这里缺少什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:47:59.420

这似乎是一个普遍的`index.php`问题

这应该这样做：[http ://ellislab.com/codeigniter/user-guide/general/urls.html](http://ellislab.com/codeigniter/user-guide/general/urls.html)

但是请通过尝试访问带有`index.php`in 的控制器来确认它，如下所示：

```
http://localhost/test/index.php/main/login 
```

# objective-c - 从 CCMenuItem 位置开始触摸时，CCScrollLayer 不滚动

> ID：14096274
> 
> 赞同：0
> 
> 时间：2012-12-31T00:46:31.683
> 
> 标签：objective-c, xcode, cocos2d-iphone

所以我正在使用 cocos2d 并设法使 CCScrollLayer 水平和垂直工作。然后我将（相当大的）CCMenuItemImage/Sprite 添加到 CCLayer，然后将 CCLayers 传递给滚动层。它工作正常，但问题是当我开始从任何 CCMenuItem 的位置移动手指时，CCScrollLayer 没有读取任何触摸，因此我无法以直观的方式滚动视图。我该如何解决这个问题？先感谢您 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-23T10:32:03.357

试试这个方法：

```
CCLayer *pageSeventhScroll = [[CCLayer alloc] init];
CCSprite * bgDonts= [CCSprite spriteWithFile:@"donts~ipad.jpg"];
bgDonts.tag = 102;
bgDonts.position=CGPointMake(512,384);
[pageSeventhScroll addChild:bgDonts];
currentBackground = bgDonts;
CCScrollLayer *scroller = [[CCScrollLayer alloc] initWithLayers:[NSMutableArray arrayWithObjects: pageSeventhScroll,nil] widthOffset: 0];

// finally add the scroller to your scene
[self addChild:scroller]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T11:14:59.063

当我使用 时`CCScrollLayer`，我`CCMENU`在图层上添加 ，然后将图层添加到`CCScrollLayer`类似的位置：

```
CCLayer *page1 = [[CCLayer alloc] init]; 
```

然后是一些菜单：

```
Menu= [CCMenu menuWithItems: item1, nil]; 
```

然后图层上的菜单：

```
 [page1 addChild:Menu z:0 ]; 
```

然后图层到滚动条：

```
scroller = [[CCScrollLayer alloc] initWithLayers:[NSArray arrayWithObjects:page1,page2,page3,nil] widthOffset:0]; 
```

所以你可以用 menus 添加很多这样的页面。

它确实很好用。希望它有所帮助。

# php - 按数字键对数组进行排序

> ID：14096277
> 
> 赞同：2
> 
> 时间：2012-12-31T00:47:08.143
> 
> 标签：php, arrays, array-key, ksort

我想对数组进行数字排序，即 188、188-1、188-2、222、222-1、222、-2 等。这是数组当前的样子：

```
[188-1] => Array
    (
        [time] => 1
    )

[188-2] => Array
    (
        [time] => 2
    )

[188-3] => Array
    (
        [time] => 3
    )

[188] => Array
    (
        [notes] => frog stand notes
    )

[489] => Array
    (
        [notes] => notes
    )

[489-1] => Array
    (
        [weight] => 10
        [reps] => 30
    )

[489-2] => Array
    (
        [weight] => 20
        [reps] => 30
    )

[489-3] => Array
    (
        [weight] => 30
        [reps] => 30
    )

[492-1] => Array
    (
        [weight] => 500
        [distance] => 100000
    )

[492] => Array
    (
        [notes] => more notes
    ) 
```

我已经尝试过 ksort，`ksort($sorted, SORT_DESC);`但它对连字符键的效果不太好，除非我做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T00:51:00.190

您可以使用[`uksort()`](http://php.net/uksort)with[`strnatcmp()`](http://php.net/manual/en/function.strnatcmp.php)作为比较功能：

```
uksort($array, 'strnatcmp'); 
```

# django - 什么_really_缓存了Django QuerySet？

> ID：14096279
> 
> 赞同：2
> 
> 时间：2012-12-31T00:48:01.747
> 
> 标签：django, django-models, django-queryset

根据（我的阅读）官方dox here：

[https://docs.djangoproject.com/en/dev/ref/models/querysets/#when-querysets-are-evaluated](https://docs.djangoproject.com/en/dev/ref/models/querysets/#when-querysets-are-evaluated)

评估时应缓存 Django QuerySet。但情况似乎并非如此。在下面的示例中，TrackingImport 是一个模型，其后面有一个非常大的表。（为简洁起见，稍微编辑了输出。）

```
recs = TrackingImport.objects.filter(...stuff...)

In [102]: time(recs[0])
Wall time: 1.84 s

In [103]: time(recs[0])
Wall time: 1.84 s 
```

调用 len() 似乎像宣传的那样工作：

```
In [104]: len(recs)
Out[104]: 1823

In [105]: time(recs[0])
Wall time: 0.00 s 
```

我不明白为什么取消引用数组没有缓存 QuerySet 结果。它必须评估它，对吗？那么我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T01:08:34.997

你可以去看看源码（django.db.model.query），然后就清楚了，这里是django 1.3.4的query.py，

```
def __getitem__(self, k):
    """
    Retrieves an item or slice from the set of results.
    """
    if not isinstance(k, (slice, int, long)):
        raise TypeError
    assert ((not isinstance(k, slice) and (k >= 0))
            or (isinstance(k, slice) and (k.start is None or k.start >= 0)
                and (k.stop is None or k.stop >= 0))), \
            "Negative indexing is not supported."

    if self._result_cache is not None:
        if self._iter is not None:
            # The result cache has only been partially populated, so we may
            # need to fill it out a bit more.
            if isinstance(k, slice):
                if k.stop is not None:
                    # Some people insist on passing in strings here.
                    bound = int(k.stop)
                else:
                    bound = None
            else:
                bound = k + 1
            if len(self._result_cache) < bound:
                self._fill_cache(bound - len(self._result_cache))
        return self._result_cache[k]

    if isinstance(k, slice):
        qs = self._clone()
        if k.start is not None:
            start = int(k.start)
        else:
            start = None
        if k.stop is not None:
            stop = int(k.stop)
        else:
            stop = None
        qs.query.set_limits(start, stop)
        return k.step and list(qs)[::k.step] or qs
    try:
        qs = self._clone()
        qs.query.set_limits(k, k + 1)
        return list(qs)[0]
    except self.model.DoesNotExist, e:
        raise IndexError(e.args) 
```

当您不遍历查询集时，_result_cache 为 None，然后当您调用 resc[0] 时，它只会跳到以下几行，

```
try:
   qs = self._clone()
   qs.query.set_limits(k, k + 1)
   return list(qs)[0]
except self.model.DoesNotExist, e:
   raise IndexError(e.args) 
```

您会发现，在这种情况下，_result_cache 没有被设置。这就是为什么多个 resc[0] 的持续时间成本相同的原因。

调用 len(resc) 后，可以找到源代码，

```
def __len__(self):
    # Since __len__ is called quite frequently (for example, as part of
    # list(qs), we make some effort here to be as efficient as possible
    # whilst not messing up any existing iterators against the QuerySet.
    if self._result_cache is None:
        if self._iter:
            self._result_cache = list(self._iter)
        else:
            self._result_cache = list(self.iterator())
    elif self._iter:
        self._result_cache.extend(self._iter)
    return len(self._result_cache) 
```

你可以看到 _result_cache 有值，然后你调用 recs[0]，它只会使用缓存，

```
 if self._result_cache is not None:
         ....
     return self._result_cache[k] 
```

源代码永远不会说谎，因此当您在文档中找不到答案时，最好阅读源代码。

# python - 如何在 Pygame 中以网格状结构显示文本？

> ID：14096280
> 
> 赞同：3
> 
> 时间：2012-12-31T00:48:07.473
> 
> 标签：python, pygame

我是 pygame 的新手，目前我正在创建一个记忆游戏，其中计算机在随机位置显示框大约一秒钟，然后用户必须单击他/她认为这些框所在的位置。有点像[这个游戏](http://www.lumosity.com/brain-games/memory-games/memory-matrix)：

![截屏](../Images/41b0be103b44f91af7044403edc7742e.png)

但是，我不确定如何让计算机显示带有字母或符号的框，例如“T”或“%”。（我已经制作了网格）。有人可以帮忙吗？这将不胜感激。

```
import pygame
size=[500,500]
pygame.init()
screen=pygame.display.set_mode(size)

# Colours
LIME = (0,255,0) 
RED = (255, 0, 0)
BLACK = (0,0,0)
PINK = (255,102,178)
SALMON = (255,192,203)
WHITE = (255,255,255)
LIGHT_PINK = (255, 181, 197)
SKY_BLUE = (176, 226, 255)
screen.fill(BLACK)

# Width and Height of game box
width=50
height=50

# Margin between each cell
margin = 5

# Create a 2 dimensional array. A two dimesional
# array is simply a list of lists.
grid=[]
for row in range(20):
    # Add an empty array that will hold each cell
    # in this row
    grid.append([])
    for column in range(20):
        grid[row].append(0) # Append a cell

# Set row 1, cell 5 to one. (Remember rows and
# column numbers start at zero.)
grid[1][5] = 1  

# Set title of screen
pygame.display.set_caption("Spatial Recall")

#Loop until the user clicks the close button.
done=False

# Used to manage how fast the screen updates
clock=pygame.time.Clock()

# -------- Main Program Loop -----------
while done==False:
    for event in pygame.event.get(): # User did something
        if event.type == pygame.QUIT: # If user clicked close
            done=True # Flag that we are done so we exit this loop
      if event.type == pygame.MOUSEBUTTONDOWN:
        # User clicks the mouse. Get the position
        pos = pygame.mouse.get_pos()
        # Change the x/y screen coordinates to grid coordinates
        column=pos[0] // (width+margin)
        row=pos[1] // (height+margin)
        # Sete t hat location to zero
        grid[row][column]=1
        print("Click ",pos,"Grid coordinates: ",row,column)

# Draw the grid
for row in range(10):
    for column in range(10):
        color = LIGHT_PINK
        if grid[row][column] == 1:
            color = RED
        pygame.draw.rect(screen,color,[(margin+width)*column+margin,(margin+height)*row+margin,width,height])

# Limit to 20 frames per second
clock.tick(20)

# Go ahead and update the screen with what we've drawn.
pygame.display.flip()

pygame.quit () 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T17:25:17.587

为了显示文本，您必须经过一系列步骤。首先，您需要使用命令 `pygame.font.Font(font name, size) 来获取字体。例如：

```
arialfont=pygame.font.Font('arial', 12) 
```

所有可用的字体都可以从命令中获取`pygame.font.get_fonts()`。`pygame.init()`请记住在任何此操作之前初始化 pygame ( )。

接下来，您将不得不使用`Font.render(text, antialias, color, background=None)`. 例如：

```
text=arialfont.render('Hello World!', True, (0, 0, 0)) 
```

这将返回一个表面。您可以像使用任何其他表面一样使用它。用于`text.get_rect()`获取其矩形，然后重新定位矩形以将其放置在您想要的位置，然后将其传送到窗口。如果您对表面物体一无所知，请问我。

这是一个工作代码。

```
import pygame, sys
pygame.init()#never forget this line
window=pygame.display.set_mode((100, 100))
font=pygame.font.SysFont('arial', 40)
text=font.render('@', True, (0, 0, 0))
rect=text.get_rect()
window.fill((255, 255, 255))
window.blit(text, rect)
pygame.display.update()
while True:
    for event in pygame.event.get():
        if event.type==pygame.QUIT:
            pygame.quit()
            sys.exit() 
```

# php - 按相关搜索结果排序数组

> ID：14096281
> 
> 赞同：1
> 
> 时间：2012-12-31T00:48:13.787
> 
> 标签：php, search

我知道某处必须有一个库，但我想做的是传入一个字符串数组和一个搜索字符串，并让它按照与搜索字符串的相关程度对数组进行排序。

我一直很难弄清楚要谷歌来解决这个问题，有人指出我正确的方向吗？

最好使用 php 或其他服务器端语言

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:04:46.377

我真的不知道你所说的'revelant'是什么意思..

但是，如果您想根据搜索字符串找到最佳字符串，则可以使用 Levenshtein 算法。它计算两个字符串之间的“距离”。

更多信息在这里： http: [//php.net/manual/fr/function.levenshtein.php](http://php.net/manual/fr/function.levenshtein.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-04T08:47:09.007

这有点棘手，我无法用英语真正解释，所以我只需要向您展示一个工作代码。如果你有问题，你可以问。

```
<!DOCTYPE html>
   <head>
      <title>Search Array</title>
      <script>
      //so let's set an array of values we will be searching

    function searchArray(dis) {

        var bigContent = new Array('Jesus loves you','Angle','God in Heaven','Bala','Overcomer','Be born again','Adesuwa','Heaven is real','James','Apple','John the baptist');//this is the array that serves as your database

        var searchi = dis.value, result = Array();
        searchi = searchi.toLowerCase();

        //order the array alphabetically
        bigContent = bigContent.sort();

        var content;

        if(searchi !='') {
            //Define the arrays for initial pre-storage
            var keys = new Array(), contentArray = new Array();

            //Loop through the content array to search for all occurence of string
            for(var i=0;i<bigContent.length;i++) {
                content = bigContent[i].toLowerCase();
                if(content.indexOf(searchi) > -1) {//found the search in this value
                    //get the position of the search string in content
                    var pos = content.indexOf(searchi);

                    //make position the key for your content array
                    if(contentArray[pos]) {//check if this position has already been assigned to a content
                        //if yes, append this content.
                        contentArray[pos] += '[]'+bigContent[i];
                    } else {//else, set the content
                        contentArray[pos] = bigContent[i];
                        //only save the position the first time you find it, to avoid duplication
                        keys[keys.length] = pos;
                    }
                }
            }
            //sort the key so it can order the values in ascending order(relevance)
            keys = keys.sort();

            //loop thru the key
            for(var i=0;i<keys.length;i++) {
                var key = keys[i];//remember the value of "var key" is the key for contentArray value
                if(contentArray[key]) {//just to be sure it's ther
                    var thisContent = contentArray[key];
                    //check if the content has more than 1 value
                    if(thisContent.indexOf('[]') < 0) {//if it doesn't
                        result[result.length] = contentArray[key];
                    } else {//if it does
                        //convert content into array
                        var thisContentAr = thisContent.split('[]');
                        //Loop thru the array
                        for(var j=0;j<thisContentAr.length;j++) {
                            result[result.length] = thisContentAr[j];
                        }
                    }
                }
            }
        }
        document.getElementById('ov').innerHTML = '';
        for(var i = 0; i<result.length;i++) {
            document.getElementById('ov').innerHTML += '<div>'+result[i]+'</div>';
        }
    }

</script>
</head>
<body>
    <div><input type="text" onkeyup="searchArray(this);" autofocus="autofocus" /></div>
    <div id="ov"></div>
 </body>
</html> 
```

# jquery - 通过注入javascript来欺骗referer

> ID：14096283
> 
> 赞同：0
> 
> 时间：2012-12-31T00:48:21.157
> 
> 标签：jquery

作为脑筋急转弯，我的一个朋友问了我一个问题，是否可以通过注入链接然后模拟点击来欺骗引用者？所以我决定试一试，我用 gmail.com 试了一下，然后通过 firebug javascript 控制台运行了它。

```
var headID = document.getElementsByTagName("head")[0];         
var newScript = document.createElement('script');
newScript.type = 'text/javascript';
newScript.src = 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js';
headID.appendChild(newScript);

$("#signIn").html('<a href="http://google.com" id="testing">Hmm</a>');
$("#testing").click(); 
```

有趣的是，首先我收到一个错误，因为 jquery 似乎没有快速加载，但主要重要的是元素实际上没有被点击，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:57:16.043

jQuery 的`click`事件实际上并没有模拟真正的点击事件。它只是在对象上调用 click 事件。超链接（默认情况下）没有点击事件。`.click`尝试使用原生 javascript 函数，而不是使用 jQuery`.click`函数。

这有效：

```
document.getElementById("link").click(); 
```

这也有效：

```
$("#link")[0].click(); 
```

这将不起作用：

```
$("#link").click(); 
```

[在这个 jsfiddle](http://jsfiddle.net/RfS82/)演示它

# php - 你能看到 Cpanel 中哪些脚本使用最多的 CPU 吗？

> ID：14096289
> 
> 赞同：2
> 
> 时间：2012-12-31T00:49:10.873
> 
> 标签：php, wordpress, cpanel, cpu-usage, litespeed

我运行一个相当活跃的 Wordpress 博客，在过去的 24 小时左右，我的 CPU 使用率一直在 60-100% 左右。我的主机声称无法告诉我是什么导致了这些峰值，但他们告诉我只是尝试卸载各种插件。

有没有办法可以看到导致这种情况的脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:27:51.380

我认为您需要[P3（插件性能分析器）](http://wordpress.org/extend/plugins/p3-profiler/)插件来查看哪些插件会降低您的 WordPress 网站的速度。

# html - 如何在html中的同一行有两个标题

> ID：14096292
> 
> 赞同：28
> 
> 时间：2012-12-31T00:49:45.353
> 
> 标签：html, css, html-heading

我想在同一水平规则上有两个标题 h2 和 h3 一个在左边，另一个在右边。他们下面有一个 HR，我希望他们与这个 HR 保持相同的距离。

我试着让它们都内联，一个浮动，另一个浮动。这样做的问题在于 h3，因为它垂直小于 h2，它以 h2 长度的一半为中心。

h2有点像坐在hr上，h3有点像漂浮在半空中。

我有点希望他们都像坐在 hr 上一样。

```
h2{
display:inline;
float:left;
}
h3{
display:inline;
float:right;
} 
```

我说的是视觉上描述情况。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-31T00:53:13.397

您需要将两个标题包装在一个`div`标签中，并让该 div 标签使用`clear: both`. 例如：

```
<div style="clear: both">
    <h2 style="float: left">Heading 1</h2>
    <h3 style="float: right">Heading 2</h3>
</div>
<hr /> 
```

拥有`hr` **after**标签将`div`确保它被推到两个标题下方。

或与此非常相似的东西。希望这可以帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-31T00:52:37.167

您只需要执行以下操作之一：

*   使它们都`inline`（或`inline-block`）
*   将它们设置为`float`左侧或右侧

您应该能够调整较小标题的`height`、`padding`或`margin`属性以补偿其定位。我建议将两个标题设置为相同的`height`.

有关示例，请参[见此实时 jsFiddle](http://jsfiddle.net/HwWkz/)。

（jsFiddle的代码）：

**CSS**

```
h2 {
  font-size: 50px;
}

h3 {
  font-size: 30px;
}

h2, h3 {
  width: 50%;
  height: 60px;
  margin: 0;
  padding: 0;
  display: inline;
}​ 
```

**HTML**

```
<h2>Big Heading</h2>
<h3>Small(er) Heading</h3>
<hr />​ 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-12-31T01:26:34.617

显示属性“inline-block”会将两个标题彼此相邻放置。您可以运行此代码段来查看它

```
<h1 style="display: inline-block" >Text 1</h1>
<h1 style="display: inline-block" >Text 2</h1>
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-31T00:54:26.093

Css vertical-align 属性应该可以帮助你：

```
vertical-align: bottom; 
```

是您较小的标题所需要的:)

[垂直对齐](http://www.w3schools.com/cssref/pr_pos_vertical-align.asp)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-05-23T10:00:46.483

检查我的示例解决方案

```
<h5 style="float: left; width: 50%;">Employee: Employee Name</h5>
<h5 style="float: right; width: 50%; text-align: right;">Employee: Employee Name</h5> 
```

这会将您的页面分成两部分，并将两个标题元素平等地插入到右侧和左侧部分。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-02-18T05:57:00.167

下面的代码将允许您在同一行上有两个标题，第一个左对齐，第二个右对齐，并具有将两个标题保持在同一基线上的额外优势。

HTML部分：

```
<h1 class="text-left-right">
    <span class="left-text">Heading Goes Here</span>
    <span class="byline">Byline here</span>
</h1> 
```

和CSS：

```
.text-left-right {
    text-align: right;
    position: relative;
}
.left-text {
    left: 0;
    position: absolute;
}
.byline {
    font-size: 16px;
    color: rgba(140, 140, 140, 1);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-01-08T16:37:31.927

`span`在`style="float: right"`元素内添加一个`h1`元素。因此，您可以添加一个带有 unicode 箭头链接按钮的“转到页面顶部”链接。

```
<h1 id="myAnchor">Headline Text
<span style="float: right"><a href="#top" aria-hidden="true">↥&lt;/a></span>
</h1> 
```

# requirejs - 使用 require.js 创建 AMD 模块

> ID：14096296
> 
> 赞同：4
> 
> 时间：2012-12-31T00:50:21.260
> 
> 标签：requirejs, amd

我有以下功能：

```
function(){
    add: function(x, y){
        return console.log(x + y);
    }
} 
```

`define()`作为 AMD（异步模块定义）兼容模块，我如何`require.js`使用它，然后在浏览器中使用它？

我正在寻找一个专门用于`jsfiddle`显示它直接在浏览器中工作的示例。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-31T16:20:41.823

如果没有依赖：

**测试.js：**

```
define(function(){
    return {
       add: function(x, y){
           return console.log(x + y);
       }
    };
}); 
```

有依赖关系

```
define(['dep1', 'dep2'], function(dep1, dep2) {
    return {
       add: function(x, y){
           return console.log(x + y);
       }
    };
}); 
```

这是一个[require](http://jsfiddle.net/asgoth/tHkHw/)的例子。

要引用该模块，请使用 require：

**bootstrap.js：**

```
/*global define, require */

require.config({
    baseUrl: 'js'
});
require(['test'], function (test) {
    'use strict';

    test.add(4, 5);
}); 
```

我的文件夹结构：

*   根（又名公共）
    *   js
        *   引导程序.js
        *   测试.js
    *   库
        *   要求
            *   需要.js
    *   索引.html

在html页面中（jade中，html中类似）：

```
<body>
    ...
    <script type="text/javascript" src="lib/require/require.js" data-main="js/bootstrap"></script>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T10:49:08.127

在浏览器中直接定义 AMD 模块时，模块不能是匿名的，必须有名字，否则`require.js`会报错`Uncaught Error: Mismatched anonymous define() module`。

如果您使用 r.js 优化器，您**可以**定义匿名 AMD 模块，并且 r.js 将处理模块名称。这是为了避免模块名称冲突。

```
// Define a module (export)
define('a', {
    add: function(x, y){
         return console.log(x + y);
     }
});

// Use the module (import)
require(['a'], function(a){
    a.add(1, 2);
});

require(['a'], function(a){
    a.add(4, 6);
}); 
```

这是[jsfiddle 示例](http://jsfiddle.net/jasdeepkhalsa/NssGv/)。

# java - 使用 Eclipse 更改应用程序主题？

> ID：14096300
> 
> 赞同：1
> 
> 时间：2012-12-31T00:51:06.587
> 
> 标签：java, android, eclipse

我无法更改我的应用程序主题。我试着去

> /res/values/styles.xml

并将资源 AppBaseTheme 更改为`android:Theme.DeviceDefault.NoActionBar`. 我重新安装了应用程序并尝试了，但它仍然具有带有操作栏的浅色主题。

如何单独更改应用程序的主题或至少每个活动的主题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:02:34.803

我猜在每个活动中，您都没有引用`style.xml`应用自定义主题的特定文件。

但正如 MH 在评论部分所说，请参阅 Android 开发站点：http: [//developer.android.com/guide/topics/ui/themes.html#ApplyATheme](http://developer.android.com/guide/topics/ui/themes.html#ApplyATheme)

至于将主题应用于活动，请看这里：http: [//developer.android.com/guide/topics/ui/themes.html](http://developer.android.com/guide/topics/ui/themes.html)

（它们必须在清单中声明）

![看这里](../Images/70f835905dac315c72e726102c301819.png)

*如果您愿意提供代码，我相信您的问题可以被查明。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-06T22:39:29.110

当使用 Eclipse 创建项目时，您有一个 v11 styles.xml 和 v14 styles.xml。

AppBaseTheme 实际上继承自其中之一，而不是您正在寻找的“正常”styles.xml。

# ruby-on-rails - 如何在 Ruby on Rails 中创建项目范围内可用的 javascript 函数？

> ID：14096301
> 
> 赞同：19
> 
> 时间：2012-12-31T00:51:19.327
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我将以下函数放在我的 application.js 中：

```
function test() {
  alert("See Me")
} 
```

教室/_new_small.html.haml：

```
:javascript
  alert('test');
  test(); 
```

在我的 application.html.haml 我使用以下内容：

```
= javascript_include_tag 'application' 
```

我的`test is not defined`萤火虫控制台出现错误。测试功能不应该在项目范围内可用，因为它在 application.js 文件中吗？谢谢

编辑：我正在通过 javascript 呈现页面。那会影响它吗？

```
$('#test_container').html("<%= escape_javascript(render :partial => 'classrooms/new_small') %>"); 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-08T18:37:17.753

假设您正在使用资产管道和咖啡脚本：**不要在 application.js 中编写代码**

为了保持干净的结构，创建一个文件夹（例如`application`：）`app/assets/javascripts`

然后在你的需要它`application.js`

```
//= require jquery
//= require jquery_ujs

//= require_tree ./application 
```

创建一个咖啡文件（例如：`app/assets/javascripts/application/my_feature.js.coffee`

```
@test = ->
  alert('Hello world') 
```

咖啡输出：

```
(function() {

  this.test = function() {
    return alert('Hello world');
  };

}).call(this); 
```

最好使用命名空间：

```
@myGreatFeature =
  test: ->
    alert('Hello world') 
```

或者根据coffeescript FAQ，你可以写

```
namespace = (target, name, block) ->
  [target, name, block] = [(if typeof exports isnt 'undefined' then exports else window), arguments...] if arguments.length < 3
  top    = target
  target = target[item] or= {} for item in name.split '.'
  block target, top

namespace 'myGreatFeature', (exports) ->
  exports.test = ->
    alert('Hello world') 
```

然后你可以`myGreatFeature.test()`到处打电话

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T07:55:53.607

我试过这个没有问题。这就是我的做法。

// 应用程序.js

```
var test=function(){
  alert("hello");
} 
```

// 在视图中，无论哪一个，我都有一个 content_for :additional_javascripts

```
<% content_for :additional_javascripts do %>
  <%= javascript_tag do %>
    test();
  <% end %>
<% end %> 
```

// 在应用程序布局中

```
<%= javascript_include_tag "application" %>
<%= yeild(:additional_javascripts) %> 
```

此外，如果我想稍后动态地发出警报，我可以将它附加到页面然后调用它，或者将它放在点击侦听器或其他东西中。

我喜欢语法 var functionName = function(){...} 因为它正确地限定了方法的范围。此外，由于通过资产管道编译 javascripts 的方式，添加 ; 在每一个执行的行的末尾是非常重要的。

就动态加载脚本并从页面中的任何位置调用它而言，这也对我有用：

```
$("#click_me").live("click", function(){
  $("<script />").text("test();").appendTo("body");
}); 
```

在页面中我有一个简单的链接。

```
<a href="#" id="click_me">click</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T10:20:27.880

简单的解决方案， remove `escape_javascript`，但很**危险**请参阅[Why escape_javascript before rendering a partial？](https://stackoverflow.com/questions/1620113/why-escape-javascript-before-rendering-a-partial). 当前您要执行

```
$('#test_container').html("<script>
//<![CDATA[
 alert('test');
 test();
//]]>
</script> 
```

这被转换成

```
$('#test_container').html("<script>\n  //<![CDATA[\n    alert(\'test\');\n    test();\n  //]]>\n<\/script>\n"); 
```

## 我该如何解决这个问题？

我将在 app/assets/javascripts/ 中包含 project_wide.js，然后告诉`application.js`包含我的文件。

```
//= require project_wide 
```

一定要把上面的行放在后面

```
//= require jquery
//= require jquery_ujs 
```

现在，我放入的任何`app/assets/javascripts/project_wide.js`内容都会无耻地出现在整个项目中，**除了文件夹中的`public/`文件**。在这个文件中，我将放置我想要执行的所有内容。

### 遵循惯例

目前，您正在直接在 `classrooms/_new_small.html.haml`其中添加 javascript，这并不常见。大多数情况下，rails 开发人员将这些东西放入`assets/javascripts/*.js`或调用`content_for :javascript_custom`视图中的块，这是通过在布局文件中添加的`yield :javascript_custom`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T03:35:27.300

尝试使用：

```
<%= javascript_include_tag :all %> 
```

在你的`application.html.erb`文件中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T12:55:04.407

将所有这些 javascript 函数放在*application.js*文件中，并包含`<%= javascript_include_tag 'application' %>`在布局文件的*head 标记中*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-02T03:45:51.303

我注意到你的函数`test()`是缩进的，这表明它是嵌套的。如果您在另一个函数的范围内定义一个函数，则它在它之外将不可用。

例如，这应该工作，使用 jQuery：

```
function test() { /* do something */ }

// another file or inline script

$(function() {
   test();
}); 
```

但这不会

```
(function() {
   function test() {}
})();

// another file

test(); // undefined 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-31T00:57:22.317

你可能在想这条线

```
= javascript_include_tag "application" 
```

而不是

```
= stylesheet_link_tag 'application', :media => 'all' 
```

如果缺少前者，则不会包含您的 javascript。

# c++ - CUDA 中的系统时间和文件时间

> ID：14096308
> 
> 赞同：0
> 
> 时间：2012-12-31T00:52:13.757
> 
> 标签：c++, visual-c++, cuda

我正在使用以下代码来计算 C++ coce 中的时间

```
SYSTEMTIME sm;
FILETIME fm;

GetSystemTime(&sm);
SystemTimeToFileTime(&sm,&fm);

*time =  (double)(fm.dwLowDateTime / 10000000.0); 
```

现在我想计算当我实现 CUDA 版本时，这个函数在 CUDA 内核函数之间被调用。任何想法或帮助我如何做到这一点。我对 cuda 编程很陌生，对它了解不多。也有人能告诉我如何在`__device__`我尝试过的函数中使用 new 运算符

```
maxY = new int[m_imgWidth*m_imgHeight]; 

cudaMalloc((void **)&m_labelBuf , m_imgWidth*m_imgHeight); 
```

但它给了我错误

```
 calling a __host__ function("cudaMalloc") from a __global__ function("kernel_Labeling") is not allowed 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T04:02:25.930

您可以通过寄存器（每个线程私有）和共享内存（每个块私有）进行一些动态或伪动态内存分配，但看起来这不是您想要做的。

要从设备端代码在堆上分配内存，可以使用 C++ new 运算符，也可以使用[设备端 malloc](http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#dynamic-global-memory-allocation-and-operations)。这仅适用于 Fermi 和更新的 GPU。

使用[cudaEvent API](https://stackoverflow.com/questions/13676102/strategies-for-timing-cuda-kernels-pros-and-cons)是计时 cuda 代码最无故障的方法。

**编辑：** *我已将 Robert Crovella 的评论合并到这个答案中。如果他发布他的评论作为答案，请投票给他而不是这个。*

# objective-c - 是否有更少重复的方式将动作消息转发到另一个对象？

> ID：14096309
> 
> 赞同：2
> 
> 时间：2012-12-31T00:52:28.687
> 
> 标签：objective-c, ios, model-view-controller, uiviewcontroller, messaging

我正在制作一个计算器应用程序来学习 Objective-C 并且可能会提高我的 OO 设计技能。为了做更多类似 MVC 的事情，我将实际的计算器代码与视图控制器分开。对于每个动作，视图控制器所做的几乎所有事情都是告诉“模型”执行针对该动作的操作。

问题是，这给了我一堆方法，这些方法基本上什么都不做，只是将动作转发给模型，如下所示：

```
- (IBAction)clearAll:(id)sender {
    [self.model clearAll];
}

- (IBAction)clearDisplay:(id)sender {
    [self.model clearDisplay];
}

- (IBAction)clearMemory:(id)sender {
    [self.model clearMemory];
}

- (IBAction)storeMemory:(id)sender {
    [self.model storeMemory];
}

- (IBAction)addMemory:(id)sender {
    [self.model addMemory];
}

- (IBAction) subtractMemory:(id)sender {
    [self.model subtractFromMemory];
}

- (IBAction)recallMemory:(id)sender {
    [self.model recallMemory];
} 
```

到目前为止，Objective-C 在动态转发消息方面似乎非常灵活，而且这些方法非常相似，看起来很容易自动化。他们真的必须在那里吗？还是有一种不那么重复的方法来告诉控制器只将某些消息传递给模型（理想情况下，同时剥离`sender`arg）？

我一直在寻找并尝试使用选择器和 的一些东西，但是通过删除所有让我将按钮连接到操作`NSInvocation`的标记，这似乎会使 Interface Builder 混乱。`(IBAction)`（在这些情况下，如果视图不必知道或关心控制器只是转发到模型，我会更喜欢。）

那么，有没有更少重复和/或骇人听闻的方式？还是不值得麻烦？（或者这首先是一个坏主意？或者这是试图让模型做太多事情？或者......）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T01:00:04.300

您可以使用语言的动态特性。

来自 Objective-C 运行时编程[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtForwarding.html)

> 当一个对象因为没有与消息中的选择器匹配的方法而无法响应消息时，运行时系统会通过发送一个`forwardInvocation`.

因此，在您的情况下，您可以按如下方式实现前向调用方法

```
- (void)forwardInvocation:(NSInvocation *)anInvocation {
    if ([self.model respondsToSelector:[anInvocation selector]])
        [anInvocation invokeWithTarget:self.model];
    else
        [super forwardInvocation:anInvocation];
} 
```

**注意** 您还必须统一您的方法签名。删除`sender`参数或将其添加到模型的方法中，否则`respondsToSelector`将返回`NO`并且不会调用该方法。

在这种情况下`forwardInvocation`，它将充当调度程序，它将尝试将您的控制器未实现的每条消息发送到`self.model`对象。如果这没有响应选择器，它将调用`super`，很可能导致无法识别的选择器异常。

我个人觉得它非常优雅，即使您最好确切地知道自己在做什么并且绝对不要过度使用此类功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T01:30:46.527

您可以按照 Gabriele 的建议进行操作，这无疑是 ObjC 的动态示例，但您最好避免使用它。正如 Gabriele 所说，**您最好确切地知道自己在做什么，并且绝对不要过度使用此类功能**。这通常*表明*这样的功能可能比它的价值更麻烦。

现实情况是，您的计算器应用程序是一个非常人为的设计，目的是为了将模型-视图-控制器模式固有的分离带回家。正如您所说，这是一个学习应用程序。

实际上，没有任何应用程序如此简单。如果有的话，您很少会拥有一个按钮字段，控制层会在其中盲目地将所述功能转发给模型。

取而代之的是，该控制层中将存在各种业务逻辑方式，这些逻辑可以完成从自动化各种操作到验证（可能通过查询模型）到更新 UI 状态以响应各种操作的所有事情。

很可能此代码将在项目的早期出现，因此通用转发机制将很快变得完全未使用。

同样，当涉及到调试时，这样的转发机制会变成充满痛苦的漏斗。您不再有一个具体的点来放置断点，但现在必须添加条件。您也没有一种简单的方法可以找到所有可能调用或实现特定方法的位置。同样，它使跟踪控制流变得更加困难。

如果您确实发现自己有大量重复的样板代码，那么这更像是您的架构可能存在缺陷的迹象，而不是您需要注入一个漂亮的动态机制来减少重复性的迹象。

同样，如果您要继续充实您的计算器应用程序，与应用程序中的所有其他功能相比，您将花费多少编码时间来执行这些重复的方法？可能非常少，并且由于它们的简单性和调试方便，所述重复方法不太可能会产生任何重大的维护成本，而一些巧妙的动态技巧（这非常酷，我鼓励你在其他情况下探索）几乎可以保证需要“嗯。我在想什么？！” 片刻之后。

# javascript - setTimeout 后的 setInterval 不断执行

> ID：14096310
> 
> 赞同：0
> 
> 时间：2012-12-31T00:52:33.623
> 
> 标签：javascript, settimeout, setinterval

我有代码可以检查某些元素右上角的当前位置：

```
function checkContentPos(e) {
    var positionLeft = 0,
    checkTabPos = null,
    pos;

    e = $(e).filter('li');
    alert($(e).attr('class'));
    //alert($(e).attr('class'));
    checkTabPos = setInterval(
        function () {
            ii++;
            debug(ii);
            pos = $(e).offset(); 
            pos['left'] += parseInt($(e).css('width'));
            positionLeft = pos.left;
            debug(positionLeft);
        }, 40);
    function stopCheckTabPos() {
        debug('stopCheckTabPos invoked')
        clearInterval('checkTabPos');
    }
    setTimeout(stopCheckTabPos, 400);
    return(positionLeft);
    }; 
```

但我看起来像它循环到瞬间。在 setTimeout 之后，它仍然会不断被调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:53:56.810

```
 clearInterval('checkTabPos'); 
```

不要在这里使用引号。那怎么行？您需要传入由返回的标识符`setInterval`，而不是任意字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:54:00.053

当您应该将[`clearInterval`](https://developer.mozilla.org/en-US/docs/DOM/window.clearInterval)字符串与变量一起使用时，您正在调用它`'checkTabPos'`

```
function stopCheckTabPos() {
    debug('stopCheckTabPos invoked')
    clearInterval(checkTabPos);
} 
```

# image - IE9（自己的网站）中的图像出现黑线问题

> ID：14096314
> 
> 赞同：0
> 
> 时间：2012-12-31T00:53:04.287
> 
> 标签：image, web, internet-explorer-9

我在通过我在 IE 9 中工作的网站上显示奇怪的黑线时遇到问题。我尝试关闭压缩，但我不知道该怎么做。有没有人看到这个或者你能给我一些建议吗？

网页：http: [//3dprinterhub.com](http://3dprinterhub.com)

IE9截图：http: [//i.imgur.com/mLaOB.png](http://i.imgur.com/mLaOB.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:34:09.710

那些“奇怪的黑线”来自您菜单中的 A 链接。

您已经通过使用“span.help”和“visibility: hidden”隐藏了菜单中的实际文本，但实际的 A 链接本身仍然可见（因此可见行）。

如果在“a.nav_button”和“a.nav_buttons”CSS 规则中添加“visibility: hidden”或“text-decoration: none”，则下划线将消失。

# c# - 如何实现一个对象[]，其中顶级对象始终是最新的？

> ID：14096316
> 
> 赞同：0
> 
> 时间：2012-12-31T00:53:13.273
> 
> 标签：c#, arrays, xna

我正在编写一个应用程序，我想在其中实现一个对象数组，该数组将定期添加一个新项目。

我总是想知道添加的最后一个对象是哪个并且正在考虑将该对象放置在位置 0。（因此将每个项目向下推一个索引到最多 130 个项目）

这很容易使用 List 来实现

```
items.Insert(0,new item());
items.RemoveAt(130); 
```

然后它将自动将每个项目向下推并在 130 处删除该项目，但这对于数组来说并不是那么简单

我最初的想法在某个地方

```
for(int i = 129; i>0;i--)
{
 items[i] = items[i-1]; 
}
items[0] = new item(); 
```

然后，这允许我简单地访问最新的项目（通过索引 [0]），以及按创建顺序（1 -> 129）的每个前面的项目；

现在这本身很简单，我想知道是否还有其他方法可以执行此操作。

编辑：感谢您的快速回复，

我已经对此进行了一些测试（使用 100 万次迭代），似乎队列方法在这里是最快的，但仅比列表略高，然后是数组，处理 100 万个项目的时间长了大约 50%

我想我会探索~~队列~~堆栈选项

再次感谢;

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T01:03:35.253

> 我总是想知道添加的最后一个对象是哪个并且正在考虑将该对象放置在位置 0。（因此将每个项目向下推一个索引到最多 130 个项目）
> ......
> 现在这本身就很简单我想知道但是，如果有任何其他方式来执行此操作。

是的，有一种更简单的方法可以通过使用已经构建的结构来执行此操作，即[队列](http://msdn.microsoft.com/en-us/library/system.collections.queue.aspx)（First Input First Output）。您主要需要三种方法：

*   [`Enqueue()`](http://msdn.microsoft.com/en-us/library/system.collections.queue.enqueue.aspx)将对象添加到*队列*的末尾。

*   [`Dequeue()`](http://msdn.microsoft.com/en-us/library/system.collections.queue.dequeue.aspx)*返回队列* 开头的对象，将其**删除**。

*   [`Peek()`](http://msdn.microsoft.com/en-us/library/system.collections.queue.peek.aspx)*返回队列* 开头的对象**而不删除它**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:01:48.000

您的循环是不必要的， Array.Insert 将为您“向下移动”元素。

但是，如果您真的想始终在开头添加新元素，则 LinkedList 出于性能原因会更好，因为无论您在何处插入元素，它都不需要移动元素。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-31T01:05:06.920

我认为这将尽可能简单。就我个人而言，我会将其设为通用扩展方法。

```
public static void Insert<T>(this T[] array, int position, T item)
{
    for ( int i = array.Length-1; i > position; i-- )
        array[i] = array[i-1];

    array[position] = item;
} 
```

所以你可以像这样使用它

```
string[] lolCats = { "ceiling cat", "invisible bike cat", "lime cat" };

lolCats.Insert(0, "monorailcat"); 
```

# javascript - 将带有隐藏样式属性行的动态表列复制到textarea jQuery

> ID：14096317
> 
> 赞同：2
> 
> 时间：2012-12-31T00:53:48.150
> 
> 标签：javascript, jquery, css, html-table

我对 jQuery 很陌生，在完成我想要的表的特定功能时遇到了一些麻烦。

我有一个动态排序的数据库列表，我希望能够在单击列标题时创建一个包含来自特定列的文本的文本区域。我从这个[http://jsfiddle.net/4BwGG/3/](http://jsfiddle.net/4BwGG/3/)使用的代码中有一些功能，但这里有一些我无法弄清楚的事情：

我使用标签中`style="display: none"`的属性隐藏了表中的一些行`<tr>`，当脚本解析所有内容时，这些隐藏行的信息也被包含在内。如何进行检查以便仅将显示的行复制到文本区域？

这是一行条目的样子：

```
<tr filtermatch="false" style="display: none;">
  <td>< a href="http://example.edu">Tommy Trojan< /a>< /td>   
  < td>123-555-1231< /td>
  < td>Statue Man< /td>
  < td>[LTS1] [LTS2] [PM] [PM2] [TA1] [TA2] < /td>
  < td>tommy@example.edu< /td>
< /tr>` 
```

这是功能：

```
function SelectColumn(index, tableId) {
    var columnText = 'You selected:\n\n';
    var columnSelector = '#' + tableId + ' tbody > tr > td:nth-child(' + (index + 1) + ')';
    var cells = $(columnSelector);

    // clear existing selections
    if (window.getSelection) { // all browsers, except IE before version 9
        window.getSelection().removeAllRanges();
    }

    if (document.createRange) {
        cells.each(function(i, cell) {
            var rangeObj = document.createRange();
            rangeObj.selectNodeContents(cell);
            window.getSelection().addRange(rangeObj);
            columnText = columnText + '\n' + rangeObj.toString();
        });
    }
    else { // Internet Explorer before version 9
        cells.each(function(i, cell) {
            var rangeObj = document.body.createTextRange();
            rangeObj.moveToElementText(cell);
            rangeObj.select();
            columnText = columnText + '\n' + rangeObj.toString();
        });
    }

    alert(columnText);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T09:01:45.913

如果您使用的是 jquery，它将使事情变得非常容易。要仅选择可见元素，您可以在 jquery 中使用 :visible。

```
$(document).ready(function(){
    var textAreaContent=[];
    $('tr:visible').each(function(){
        var content=$('<div />').append($(this).clone()).html();
        textAreaContent.push(content);
    });
    $('.textarea').val(textAreaContent.join(''));
}); 
```

检查 jsfiddle [http://jsfiddle.net/sudhanshu414/9YeLm/](http://jsfiddle.net/sudhanshu414/9YeLm/1)

选择的其他选项是使用过滤器。如果您想根据其他条件进行过滤，这也很有用。

```
$(document).ready(function(){
    var textAreaContent=[]; 
    $('tr').filter(function(){ return $(this).css('display')!='none';}).each(function(){
        var content=$('<div />').append($(this).clone()).html();
        textAreaContent.push(content);
    });
    $('.textarea').val(textAreaContent.join(''));
}); 
```

jsfiddle：http: [//jsfiddle.net/sudhanshu414/3GfqN/](http://jsfiddle.net/sudhanshu414/3GfqN/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T08:38:35.267

尝试将代码包装在检查`tr`.

例如：

```
if (document.createRange) {
    cells.each(function(i, cell) {
        if ($(cell).closest('tr').is(':visible')) {
            var rangeObj = document.createRange();
            rangeObj.selectNodeContents(cell);
            window.getSelection().addRange(rangeObj);
            columnText = columnText + '\n' + rangeObj.toString();
        }
    });
} 
```

当然，你也想在 else 块中做同样的事情。但作为记录，该 jsFiddle 在 IE7 中对我不起作用（它会引发有关不支持的属性或方法的错误）。

我知道您没有问，但除非您需要实际*选择*该列，否则我会重构代码。如果您希望该列*显示*为选中状态，我可能会添加一些 CSS。

其他人可能会进一步改进代码。但这是我的建议。我添加了评论来解释我做了什么以及为什么。

```
function SelectColumn(index, tableId) {
    // cache the table selector in a local variable
    // because we are going to use it more than once
    var columnText = 'You selected:\n\n',
        table = $('#' + tableId),
        cells = table.find('td:nth-child(' + (index + 1) + ')');

    // reset the background color of all cells
    table.find('td').css('background-color', '#fff');

    cells.each(function(i, cell) {
        // turn cell into a jQuery object and cache it
        // because we are going to use it more than once
        cell = $(cell);

        if (cell.closest('tr').is(':visible')) {
            // get the cell text and trim it
            // because different browsers treat newlines differently
            columnText += $.trim(cell.text()) + '\n';

            // set a background color on the selected cells
            cell.css('background-color', '#ccc');
        }
    });

    alert(columnText);
} 
```

# android - SimpleExpandableListAdapter 中的参数是如何使用的？

> ID：14096323
> 
> 赞同：4
> 
> 时间：2012-12-31T00:54:41.227
> 
> 标签：android, android-layout, drop-down-menu, expandablelistview, expandablelistadapter

我正在尝试在Android平台上制作一个Expandable List，我发现我不了解构造函数中的参数。

我查阅了[文档](http://developer.android.com/reference/android/widget/SimpleExpandableListAdapter.html)，构造函数如下所示：

```
SimpleExpandableListAdapter(Context context, List<? extends Map<String, ?>> groupData, int groupLayout, String[] groupFrom, int[] groupTo, List<? extends List<? extends Map<String, ?>>> childData, int childLayout, String[] childFrom, int[] childTo) 
```

构造函数

对于`groupData`and `childData`， Maps 中的键和值到底对应什么？

[这个先前的 SO 问题](https://stackoverflow.com/questions/7485402/use-of-simpleexpandablelistadapter)仅解决了参数的一般用途——我想具体了解构造函数中的键和值与最终应该在我的列表中的内容相对应的内容。

**附录：**

我应该澄清一下 - 我的意思是键值对与列表有什么关系？例如，假设我有一个类别列表 - {Percussion, Woodwind} - 和一个子项目列表：{Piano, Marimba} for Percussion 和 {Flute, Piccolo, Bassoon} for Woodwind。如何设置地图的键值对以使 ExpandableList 像下面的模型示例一样显示？

-打击乐器：

```
 -Piano
 -Marimba 
```

- 木管乐器：

```
 -Flute
 -Piccolo
 -Bassoon 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T08:00:01.703

这是一个例子：[http ://www.edumobile.org/android/android-game-programming/simple-expandable-list-example/](http://www.edumobile.org/android/android-game-programming/simple-expandable-list-example/)

`BaseExpandableListAdapter`顺便说一句，通过从;扩展来简单地创建自己的适配器会更容易。有关示例，请参见 [http://about-android.blogspot.ca/2010/04/steps-to-implement-expandablelistview.html 。](http://about-android.blogspot.ca/2010/04/steps-to-implement-expandablelistview.html)

这个例子有一个问题`getChildView()`and `getGroupView()`：它总是创建一个新的视图，而不是`convertView`在它不为空时重用参数提供的视图。有关更正确的示例以及如何从线程填充适配器，请参见[http://androidword.blogspot.ca/2012/01/how-to-use-expandablelistview.html 。](http://androidword.blogspot.ca/2012/01/how-to-use-expandablelistview.html)

# python - json如何确定写入/输出顺序

> ID：14096324
> 
> 赞同：-1
> 
> 时间：2012-12-31T00:54:48.387
> 
> 标签：python, json

在 Python 的 STL 中使用 json 并想出了这个..

```
import json as j

cred = j.dumps({'Name': 'John Doe', 'Occupation': 'Programmer'},
            sort_keys = True,
            indent = 4,
            separators = (',', ': '))

_f = open('credentials', 'w')
_f.write(cred)
_f.close() 
```

输出如下，一切都很好..

> {
> 
> ```
>  "Name": "John Doe",
>   "Occupation": "Programmer" 
> ```
> 
> }

*但是*，我不小心这样输入了小写的名称..

```
cred = j.dumps({'name': 'John Doe', 'Occupation': 'Programmer'},
            sort_keys = True,
            indent = 4,
            separators = (',', ': ')) 
```

结果是这样的..

> {
> 
> ```
>  "Occupation": "Programmer",
>   "name": "John Doe" 
> ```
> 
> }

json如何确定传递给它的值的写入/输出顺序，大写字母优先于小写字母，反之亦然，有没有办法保持顺序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:57:32.600

Python 字典以及 JSON 对象没有顺序。您可能看到的任何顺序都是任意的，并且可能随时更改。如果要在 JSON 中存储订单，则需要使用数组而不是对象。

`sort_keys`似乎可以保证某种输出顺序，但这可能只会使其对人类更具可读性。读取 JSON 的计算机不应该关心字段顺序。

# php - 断言文件未验证

> ID：14096325
> 
> 赞同：1
> 
> 时间：2012-12-31T00:54:59.803
> 
> 标签：php, file, symfony, mime-types, assert

我已按照文档中的说明操作，了解如何使用 Doctrine 处理文件上传。

图片上传工作正常，但是当我上传其他文件类型时，即使我已经正确设置了 $file 属性上的注释，它也只会让文件上传，如下所示：

```
/**
 * @Assert\File(
 *     maxSizeMessage = "L'image ne doit pas dépasser 5Mb.",
 *     maxSize = "5000k",
 *     mimeTypes = {"image/jpg", "image/jpeg", "image/gif", "image/png"},
 *     mimeTypesMessage = "Les images doivent être au format JPG, GIF ou PNG."
 * )
 */
public $file; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T13:11:33.033

我刚刚发现问题来自 Product 实体。我在 Product 表单中添加了多个图像，但忘记将 Valid 断言放在 Product 实体上的 $images 属性中，如下所示：

```
/**
 * @ORM\ManyToMany(targetEntity="PS\StockBundle\Entity\Image", cascade={"persist"})
 * @Assert\Valid()
 */
private $images; 
```

我在我的博客上写了一篇关于这里的文章[https://web.archive.org/web/20141004165731/http://www.ennazk.com:80/validate-subforms-in-symfony2/#.Wdt9mBNSwnU](https://web.archive.org/web/20141004165731/http://www.ennazk.com:80/validate-subforms-in-symfony2/#.Wdt9mBNSwnU)

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:42:53.573

是`{"image/jpg", "image/jpeg", "image/gif", "image/png"},`有效的json吗？因为这对我来说看起来不像是一个有效的 json（json 中的对象由 key=>value 对组成。）。如果 json 解码失败，则可能整个断言没有得到应用。我对教义了解不多，所以我可能错了。

# c++ - 在 VTK 中绘制一个球体数组

> ID：14096329
> 
> 赞同：3
> 
> 时间：2012-12-31T00:55:45.127
> 
> 标签：c++, vtk

我想在 C++ 中使用 VTK 并在 3D 中绘制一个分子。我有一个代表原子位置的向量和另一个代表每个原子大小的向量。我怎么能做到这一点？我需要为每个原子制作一个新的 sphere_source 吗？

```
vector< vector <double> > Positions;
vector< double > Sizes; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T18:39:46.127

看看 vtkGlyph3D，这个例子： [http](http://www.vtk.org/Wiki/VTK/Examples/Cxx/Filtering/Glyph3D) ://www.vtk.org/Wiki/VTK/Examples/Cxx/Filtering/Glyph3D 然而，你需要为每个原子大小单独的球体源，所有具有相同大小的原子可以使用相同的球体源...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T22:56:08.707

```
void VTK_Plotter::Add_Point(vector<double> Position, double Size)
{

    Size = floor((log10(Size) + 0.2) * 100.0) / 100.0;

    vtkSmartPointer<vtkSphereSource> Current_Sphere_Source;
    // Different atomi number have different set of points
    vtkSmartPointer<vtkPoints> Current_Point_Group;
    // If the point has a size not in the list create a new sphere source with different size
    if (Table_Size_Source.find(Size) == Table_Size_Source.end()) {
        // Create new source
        Current_Sphere_Source = vtkSmartPointer<vtkSphereSource>::New();
        Current_Sphere_Source->SetRadius(Size);
        Table_Size_Source[Size] = Current_Sphere_Source;
        // Create new points
        Current_Point_Group = vtkSmartPointer<vtkPoints>::New();
        Table_Points_VTK[Size] = Current_Point_Group;
    }
    else
    {
        Current_Sphere_Source = Table_Size_Source[Size];
        Current_Point_Group = Table_Points_VTK[Size];
    }
} 
```

# objective-c - 在同一个 viewController 上调用带有 childViewControllers 的方法

> ID：14096330
> 
> 赞同：0
> 
> 时间：2012-12-31T00:55:56.203
> 
> 标签：objective-c

我想知道如何从 childViewController02 调用 childViewController01 中的方法。这些 ViewController 在 parentViewController 上声明，如下所示。

○ParentViewController.m：

```
ChildViewController01 *childViewController01 = [[ChildViewController01 alloc] init];
[self.view addSubView:childViewController01];

ChildViewController02 *childViewController02 = [[ChildViewController02 alloc] init];
[self.view addSubView:childViewController02]; 
```

我知道从 childViewController01 调用 parentViewController 方法的方法。

○ParentViewController.m：

```
childrenViewController01.childDelegate01 = self; 
```

○ChildrenViewController01.h：

```
@property (nonatomic, retain) id childDelegate01; 
```

○ChildrenViewController01.m：

```
[childDelegate01 performSelector:@selector(parentMethod:) withObject:hogeObj]; 
```

所以，我可以从 parentViewController 调用 childViewControllers 的方法

○ParentViewController.m：

```
- (void) parentMethod:(id)hogeObj {
    [childViewController02 childMethod02];
} 
```

这太累了。我想直接从 childViewController01 调用 childMethod02 。如果你知道怎么做，请告诉我一个好方法。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:05:57.807

您使用视图控制器的部分原因是为了保持独立和整洁。一个视图控制器不应该真正了解它的兄弟姐妹。它唯一的职责是管理它的视图和子视图控制器。父视图控制器应该负责管理兄弟视图控制器。您的选择是告诉父视图控制器您想要发生什么，并让父视图控制器将消息发送到另一个视图控制器，“污染”视图控制器的状态，如 Metabble 建议的那样相互引用，或使用通知模式。

为此，我经常使用 NSNotificationCenter。在每个视图控制器中注册通知，然后发布通知以触发其他视图控制器中的方法调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:04:10.557

当您创建控制器时，给它们相互引用并存储它们。

# javascript - javascript在弹出窗口上附加代码

> ID：14096334
> 
> 赞同：1
> 
> 时间：2012-12-31T00:56:56.390
> 
> 标签：javascript, popup, append

我只是想问一个小问题所以..

我的主窗口上有这段代码：

```
function popupURL(URL) {
    var popup = window.open(URL, URL,"status = 1, height = 500, width = 500, resizable = 1");
} 
```

好的，因此用户单击如下链接：

```
<a href="javascript:void(0);" onclick="popupURL('www.google.gr')">Link</a> 
```

它可以工作，但是当用户单击该页面中的特定元素时，我想检查一下，我知道这可以通过以下代码完成：

```
<script type="text/javascript">
    document.getElementById("submit").onclick = function() { 
        alert("you clicked submit");
    }​;​ 
</script> 
```

我想将该代码附加到我已经拥有的弹出窗口中

```
var tmp = popup.document;
tmp.write(myJsCodeHereFromAbove); 
```

但它不起作用，因为文档被重写并且没有附加我的代码。

有人对这个有了解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T03:46:37.997

如果您在服务器上编写一个代理并获取该页面，然后将 HTML 传递到您的页面（您可以调用 AJAX 请求来获取页面的内容），那么您可以附加任何您想要的内容并将其填充到您的窗户。但是，请记住，现在如果页面中有打算在其本地域上运行的代码，它现在将像在您的域上一样运行，因此它会受到与您感受到的相同的安全限制现在，您加载的页面可能会损坏。但是，如果您正在加载的页面上没有 AJAX 驱动的内容，那么这对于您的问题来说是一个完全可行的解决方案。

# c# - 使用 Bindingsource 创建 datacontext VS 的新实例

> ID：14096335
> 
> 赞同：0
> 
> 时间：2012-12-31T00:57:04.580
> 
> 标签：c#, linq-to-sql

插入到 linq to sql 后，我需要引用绑定源

我有两个解决方案，但我需要真正的专业意见来确定哪一个在性能方面更好

1.  创建一个创建数据上下文的新实例并绑定到这个新实例的方法（新实例的目的是避免缓存）
2.  创建一个 bindingsource 对象并将其作为 linq 列表的数据源并基于此 bindingsource 绑定我的 gridview）并在此 bindingsource 上进行插入。

请帮忙做一个决定

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:24:00.187

只要您发送内容更改的通知，绑定应该能够自动更新。您根本不应该尝试调用 Refresh()。

这一切都归结为您处理数据源的方式以及如何更新它。如果您使用 an`ObservableCollection`作为数据源，向其中添加项目将使用您的新行自动更新您的 UI。如果您使用自定义对象，则需要在它们上实现 INotifyPropertyChanged 并自己抛出绑定将捕获的通知。

也许将绑定模式设置为`TwoWay`也会有所帮助，尽管我认为这是默认设置。确保您没有使用 OneWayToSource 和 OneWay，或 Once。

这是一个带有一些示例的简单教程：http: [//www.codeproject.com/Articles/26031/Simple-WPF-databinding-with-some-additional-WPF-go](http://www.codeproject.com/Articles/26031/Simple-WPF-databinding-with-some-additional-WPF-go)

如果您需要更多帮助，粘贴您如何设置绑定以及如何创建数据源将有助于解决您的问题。

# android - 使 ScrollView 的内容在具有透明背景的 LinearLayout 后面滚动

> ID：14096342
> 
> 赞同：1
> 
> 时间：2012-12-31T00:58:11.273
> 
> 标签：android, scrollview, android-linearlayout, footer, transparent

我有一个带有一些 ImageView 的垂直 ScrollView，我可以上下滚动。在我的应用程序的底部，我有一个由带有部分透明背景图像 (png) 的 LinearLayout 组成的页脚。如何实现以下行为？

![在此处输入图像描述](../Images/ed9f08f4fcfcda02768ad0c56cffa30b.png)

考虑以下布局

```
<LinearLayout blah blah... >

<RelativeLayout
    android:id="@+id/guesses_scroll_view_holder"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ScrollView
        android:id="@+id/guesses_scroll_view"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@drawable/bgrepeat"
        android:scrollbarStyle="outsideOverlay"
        android:layout_above="@+id/footer" >

        <LinearLayout
            android:id="@+id/guesses"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="@drawable/bgrepeat"
            android:orientation="vertical" >
        </LinearLayout>
    </ScrollView>

    <LinearLayout
        android:id="@+id/footer"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:background="@drawable/peg_picker_bgrepeat"
        android:orientation="vertical" >
        < some footer content />
    </LinearLayout>
</RelativeLayout></LinearLayout> 
```

我现在得到的是看起来像这样的东西

![在此处输入图像描述](../Images/7e46aa9ab082d2ddbcef75f33f046044.png)

由于我的背景图像 peg_picker_bgrepeat 不是矩形的，所以我在 ScrollView 上方得到了一个丑陋的边框。如何使内容“滚动到”页脚后面？

# ruby-on-rails-3 - 在哪里放置影响多个模型的代码

> ID：14096344
> 
> 赞同：0
> 
> 时间：2012-12-31T00:58:21.700
> 
> 标签：ruby-on-rails-3

每天下午 5 点，我想为过去 24 小时内生成的所有新订单模型生成一个发票模型。

该方法应该驻留的位置有哪些选择？

将其作为 Order 模型本身的方法有什么问题吗？例如

```
class Order < ActiveRecord::Base
  def generate_invoice
    invoice = Invoice.new
    ...
    return invoice
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T04:53:00.957

我认为您应该创建一个模块并将其包含在您的模型中

前任：

```
module Invoice
  def generate_invoice
    invoice = Invoice.new
    ...
    return invoice
  end
end 
```

在你的模型中

```
class Order < ActiveRecord::Base
  include Invoice
end 
```

高温高压

# php - 将 recusion 代码移至 Zend 框架后，无法正常工作

> ID：14096346
> 
> 赞同：0
> 
> 时间：2012-12-31T00:58:41.157
> 
> 标签：php, mysql, zend-framework

首先是一些代码，我的帖子末尾的问题。我的代码从 DB 生成列表 li ul：

示例 SQL：

```
 CREATE TABLE IF NOT EXISTS  `gallery` (
  `idgallery` int(11) NOT NULL,
  `name` varchar(45) NOT NULL,
  `parent` varchar(45) DEFAULT '0',
  `type` varchar(45) DEFAULT 'category',
  `menu` varchar(45) NOT NULL,
  PRIMARY KEY (`idgallery`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

INSERT INTO `gallery` (`idgallery`, `name`, `parent`, `type`, `menu`) VALUES
(1, 'Gallery', '0', 'Gallery', ''),
(2, 'Name', '1', 'category', ''),
(3, 'Name2', '0', 'category', ''),
(4, 'Name3', '3', 'category', ''),
(5, 'qwerty', '4', 'category', ''),
(6, 'child', '3', 'category', ''),
(7, 'child', '1', 'category', ''); 
```

此代码在迁移到 ZendFW 之前运行良好：

```
$ro=mysql_query("SELECT * FROM gallery");
$rows=array();

while($rowek=mysql_fetch_object($ro))
{
 $rows[]=$rowek;
} 

echo mapTree($rows,0,"category");

function children($rows, $id) {
foreach ($rows as $row) {
if ($row->parent == $id)
return true;
}
return false;
}

function mapTree($rows, $parent = 0, $class = "none") {
$result = "<ul>";
foreach ($rows as $row) {
    if ($row->parent == $parent) {
    $result.= "<li class='$class'>$row->name";
        if (children($rows, $row->idgallery))
        $result.= mapTree($rows, $row->idgallery, "category");
    $result.= "</li> ";
    }
}
$result.= "</ul>";

return $result;
} 
```

在 Zend FW 中，我使用的是 Action Helper。*所有对象数据库都传递给我的助手（error_log），但它只显示：*

```
Gallery
      Name 
```

两条记录良好的秩序/样式......但是另外 5 条在哪里？

**索引操作：**

```
 //preDispatch()
    Zend_Controller_Action_HelperBroker::addPath(APPLICATION_PATH .'/controllers/helpers');
    //IndexAction()
    $gallery = new Application_Model_DbTable_Gallery;

    $request = $gallery->fetchAll($gallery->select()->order("parent"));

    $helper = $this->_helper->gallery->index($request);

    $this->view->gallery = $helper; 
```

**动作助手**

```
class Zend_Controller_Action_Helper_Gallery extends Zend_Controller_Action_Helper_Abstract{

function index($rows){
    echo $this->mapTree($rows,0,"");
}

function children($rows, $id) {
foreach ($rows as $row) {
if ($row->parent == $id)
return true;
}
return false;
}

function mapTree($rows, $parent = 0, $class = "brak") {
$result = "<ul>";
foreach ($rows as $row) {
    if ($row->parent == $parent) {
    $result.= "<li class='$class'>$row->name";
        if ($this->children($rows, $row->idgallery))
        $result.= $this->mapTree($rows, $row->idgallery, "category");
    $result.= "</li> ";
    }
}
$result.= "</ul>";

return $result;
}

} 
```

**并且还查看...**

```
<?php $this->gallery;?> 
```

**我的问题是 - 为什么我在 ZF 中的代码无法完成？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:07:13.287

> 两条记录良好的秩序/样式......但是另外 5 条在哪里？

你的函数做了你告诉它的事情，只处理了父级为“0”的那些行：
`if ($row->parent == $parent)`和`echo $this->mapTree($rows,0,"");`

如果您打算将“0”表示为 false 或 null，就像您所做的那样，您可能希望重新考虑如何实现该功能。

与Zend Framework 中的[View 助手一样，](http://framework.zend.com/manual/1.12/en/zend.view.helpers.html) [Action 助手](http://framework.zend.com/manual/1.12/en/zend.controller.actionhelpers.html#zend.controller.actionhelper.writingyourown)似乎在返回值时工作得最好。在这种情况下，您可能还希望实现`direct()`这样您就不必`->index()`每次都调用：

```
class Zend_Controller_Action_Helper_Gallery extends Zend_Controller_Action_Helper_Abstract
{    
    //we're using php 5, visibility matters
    public function direct($rows){
        return $this->mapTree($rows,0,"");
    }
    protected function children($rows, $id) {
    //truncated
    }
    protected function mapTree($rows, $parent = 0, $class = "brak") {
    //truncated
    }
} 
```

现在，当您调用此操作助手时：

```
 $helper = $this->_helper->gallery($request); 
```

您的视图也需要修复：

```
<!-- remember to 'echo' everything in the view -->
<?php echo $this->gallery;?> 
```

至于为什么您的旧代码有效而 ZF 无效，我不能说。然而，我怀疑大部分问题在于旧代码中的*Mysql函数与 Zend Framework 中的**Mysqli*或*PDO*数据库适配器之间的差异。

# batch-file - 如何从批处理文件（.bat）的基本目录安装 inf 文件？

> ID：14096347
> 
> 赞同：1
> 
> 时间：2012-12-31T00:58:47.030
> 
> 标签：batch-file, cmd, inf

我想制作一个批处理文件 ( `.bat`) 来安装`.inf`位于文件基目录中的`.bat`文件。我设法安装了`.inf`，但前提是我指定了完整目录。如何在`.inf`不指定完整目录的情况下安装文件？

这是我到目前为止所拥有的：

```
%SystemRoot%\System32\InfDefaultInstall.exe "DroidInstaller.inf" 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T11:40:21.797

你的问题很模糊。如果两个文件（您`installer.bat`的文件和`inf`文件）都在同一个目录中，那么您可以`pushd "%~dp0"`在批处理脚本的开头添加：

```
@echo off
pushd "%~dp0"
%SystemRoot%\System32\InfDefaultInstall.exe "DroidInstaller.inf" 
```

这会将工作目录设置为运行批处理脚本的目录。如果此目录与`inf`文件目录相同，那么您可以调用`DroidInstaller.inf`您在问题中所做的方式。

# java - 一个数字的百分比

> ID：14096350
> 
> 赞同：0
> 
> 时间：2012-12-31T00:59:29.167
> 
> 标签：java

所以我对我尝试了多少次感到有点沮丧。我在这里使用# / 100 = % * Balance = Fine，但由于某种原因总是结果为0。请注意，这使用了外部API。

```
double fine = (getConfig().getBoolean("fineispercentage") == true ? getConfig().getInt("fine") / 100 * count * econ.getBalance(event.getPlayer().getName()) : econ.getBalance(event.getPlayer().getName()) - (econ.getBalance(event.getPlayer().getName()) - count * getConfig().getInt("fine"))); 
```

当为真时，结果总是为 0。当为假时，它会按照预期的方式进行，即根据计数减去一个数量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T01:01:49.543

试试这个（未测试）：

```
double fine = (getConfig().getBoolean("fineispercentage") == true ? getConfig().getInt("fine") / 100.0 * count * econ.getBalance(event.getPlayer().getName()) : econ.getBalance(event.getPlayer().getName()) - (econ.getBalance(event.getPlayer().getName()) - count * getConfig().getInt("fine"))); 
```

诀窍是除以`100.0`(double)，而不是`100`(int)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T01:02:23.927

假设`getInt`确实返回一个整数，看起来你正在做整数除法，给你`0`.

除以代替：`getConfig().getInt("fine")`_`100d``100`

```
double fine = (getConfig().getBoolean("fineispercentage") == true ? getConfig().getInt("fine") / 100.0 * count * econ.getBalance(event.getPlayer().getName()) : econ.getBalance(event.getPlayer().getName()) - (econ.getBalance(event.getPlayer().getName()) - count * getConfig().getInt("fine"))); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T01:05:41.070

假设`getConfig().getInt()`返回一个`int`，这个java部门：

```
getConfig().getInt("fine) / 100 
```

将进行整数除法并产生一个`int`结果，该结果将截断任何小数部分，因此“精细”0-99 的任何值都将导致零。修复是这样的：

```
getConfig().getInt("fine) / 100d 
```

将“d”添加到 100 使 100 成为一个`double`值，这将执行双除法，保留小数部分。

# ios - Core Data (SQLite) 手动迁移是事务性的吗？

> ID：14096352
> 
> 赞同：0
> 
> 时间：2012-12-31T00:59:38.840
> 
> 标签：ios, core-data-migration

更改代码并发布。现在应用程序在启动时超时，同时将持久存储协调器更新为新模型。想知道迁移是否是事务性的，这样我就可以弄清楚如何修复。迁移将在超时之前通过迁移获得 x%。

如果是事务性的，我只需要先启动应用程序然后迁移。如果不是事务性的，我担心用户将拥有仅部分迁移的架构。

**背景**

用于调用的代码

```
persistentStoreCoordinator_ = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]]; 
```

正如预期的那样，当存在较新的数据库模型时，它会失败。以前会提示用户通过`UIAlertView`. 然后将调用以下语句。

```
[persistentStoreCoordinator_ addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:optionsDictionary error:&error] 
```

`initWithManagedObjectModel`如果失败，我决定运行第二行代码。除了这个语句在 `- (NSPersistentStoreCoordinator *)persistentStoreCoordinator ' 方法中运行之外，它并没有那么愚蠢，因此应用程序现在有时会在启动时超时。

在这个阶段我不知道该怎么做。数据库是半映射到新模型还是仍然代表以前的模型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T06:22:34.697

Core Data 迁移是事务性的，因为迁移是在内存中完成的，一旦完成，旧数据库就会在内存中被新版本替换。

因此，当从方法中删除迁移过程时，我在启动时尝试迁移的超时问题得到了解决`didFinishLaunchingWithOptions`。新更新解决了之前升级超时的问题。

# java - + 在 Java 中是如何实现的？

> ID：14096356
> 
> 赞同：4
> 
> 时间：2012-12-31T01:00:12.773
> 
> 标签：java

> **可能重复：**
> [java字符串连接](https://stackoverflow.com/questions/47605/java-string-concatenation)

消息来源告诉我们，`concat`实现如下：

```
 public String concat(String str) {
        int otherLen = str.length();
        if (otherLen == 0) {
            return this;
        }
        int len = value.length;
        char buf[] = Arrays.copyOf(value, len + otherLen);
        str.getChars(buf, len);
        return new String(buf, true);
    } 
```

`+`字符串的实现是否不同？如何？`+`和之间是否存在性能差异`concat`。什么时候应该选择一个而不是另一个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T01:11:59.543

这是我刚刚做的一个测试：

我用这 3 个指令创建了一个类：

```
 String s1 = "foo";
    String s2 = "bar";
    String s3 = s1 + s2; 
```

然后我获取生成的 .class 文件并使用 JAD 反编译器进行反编译。这就是代码在重新生成的源代码中的显示方式：

```
 String s = "foo";
    String s1 = "bar";
    String s2 = (new StringBuilder()).append(s).append(s1).toString(); 
```

所以：这就是 + 和 concat 之间的区别。

我猜 concat() 总是比 StringBuilder 好，因为它需要创建的对象更少。如果要在循环中重复追加字符串，可以选择 StringBuilder；在这种情况下， concat 可能每次都创建一个新的 String ，而 StringBuilder 可能只是扩展内部缓冲区。但是，如果 StringBuilder 在最后一个场景中是最好的，我们可以说 concat() 在循环中仍然比 +, 更好。

# javascript - js setTimeout 同步

> ID：14096361
> 
> 赞同：0
> 
> 时间：2012-12-31T01:01:07.687
> 
> 标签：javascript, jquery, settimeout

事实上，当我使用

```
setTimeout(a(),60);
setTimeout(a(),120);
setTimeout(a(),180);
setTimeout(a(),240); 
```

函数调用之间应该有 60 毫秒的间隔。

但它不是，尤其是当它在页面加载或动画元素期间被触发时。事实上，当浏览器“有艰苦的工作要做”时，差距甚至会长 2 倍。在某些情况下，它可以很容易地看到。

问题的关键是 - 还有其他方法可以在 javascript 中及时同步事件或函数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T01:14:43.457

简单来说，时间`setTimeout(a(),60)`转换为`I will run this function no earlier than 60ms, but if I get busy it could be later than that`。

因此，`setTimeout`不承诺*何时*执行，只承诺在给定时间之后的某个时间（以毫秒为单位）。

因此，要回答您的问题，没有办法**保证**执行时间，`setTimeout`但是您可以在 DOM 加载后加载脚本，这样 JavaScript 就不再忙于加载其他内容了。在 jQuery 中，您可以`$(document).ready()`为此目的使用该函数。

阅读 John Resig 的这篇文章，了解更多关于 JavaScript 计时的信息：http: [//ejohn.org/blog/how-javascript-timers-work/](http://ejohn.org/blog/how-javascript-timers-work/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T01:04:24.113

尝试这个：

```
setTimeout(a,60);
setTimeout(a,120);
setTimeout(a,180);
setTimeout(a,240); 
```

请注意，该函数没有`()`s。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T01:23:25.157

在您的特定情况下，[setInterval()](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)可能会起作用：

```
var count = 0, interval = setInterval(function() {
    count += 1;
    if (count > 4) {
        clearInterval(interval);
    } else {
        a();
    }
}, 60); 
```

请注意，jQuery 有一个内置的[动画功能](http://api.jquery.com/animate/)，它使用不同的更好的方法，将动画简单地视为时间的函数并经常[检查时钟](http://api.jquery.com/jQuery.now/)，因此意外的延迟只会使动画不太流畅。

# ruby - 如何将较长的字符串匹配到较短的单词或字符串

> ID：14096363
> 
> 赞同：1
> 
> 时间：2012-12-31T01:01:25.427
> 
> 标签：ruby, string, full-text-search

我有一个带有标签的项目数据库，例如：

*   `item1`被标记为`"pork with apple sauce"`
*   `item2`被标记为`"pork"`,
*   `item3`标记为`"apple sauce"`。

如果我匹配字符串：

> “今天我想吃苹果酱猪肉，它会填饱我的”

对照标签，我会得到三个结果。但是，我只想获得最具体的，在这种情况下是`item1`.

这只是一个例子，我没有使用特定的数据库。只需在 ruby​​ 中进行字符串和映射。我想出了“模糊搜索”。我不确定这是否正确。有人可以建议如何解决这个特定问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:09:27.113

是的，您需要进行模糊匹配（又名近似匹配）。这是一个众所周知的问题，手动实现一个近似匹配算法并不是一件容易的事（但我相信它非常有趣！=D）。有很多因素会影响两个字符串 A 和 B 的“相似”程度，具体取决于您认为重要的事情，例如 A 在 B 中出现的次数，或者 A 中单词之间的顺序和距离有多近出现在 B 中，或者如果 A 中的“重要”词出现在 B 中，等等。

如果您可以使用现有的库，似乎有几个 Ruby gem 可以完成工作。例如，使用这个名为[blur](http://en.wikipedia.org/wiki/Jaro%E2%80%93Winkler_distance) [-string-match 的](https://github.com/kiyoka/fuzzy-string-match)方法，它使用从 Lucene （一个 Java 库...

```
require 'fuzzystringmatch'

matcher = FuzzyStringMatch::JaroWinkler.create(:pure)

tags = ["pork with apple sauce", "pork", "apple sauce"]
input = "Today I would like to eat pork with apple sauce, it would fill me up"

# Select the tag by distance to the input string (distance == 1 means perfect 
# match)
best_tag = tags.max_by { |tag| matcher.getDistance(tag, input) }

p best_tag 
```

会正确选择`"pork with apple sauce"`。

还有一个叫做[amatch](https://github.com/flori/amatch)的 gem ，它有许多其他的近似匹配算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T02:32:54.760

根据您的具体用例，您可能不需要模糊搜索。

也许像这样一个非常基本的实现对你来说就足够了：

```
class Search
  attr_reader :items, :string

  def initialize(items, string)
    @items  = items
    @string = string.downcase
  end

  def best_match
    items.max_by { |item| rate(item) }
  end

  private

  def rate(item)
    tag_list(item).count { |tag| string.include?(tag) }
  end

  def tag_list(item)
    item[:tags].split(" ")
  end
end 
```

```
items = [
  { id: :item1, tags: "pork with apple sauce" },
  { id: :item2, tags: "pork" },
  { id: :item3, tags: "apple sauce" }
]

string = "Today I would like to eat pork with apple sauce, it would fill me up"

Search.new(items, string).best_match
#=> {:id=>:item1, :tags=>"pork with apple sauce"} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T03:58:05.183

数据库中项目之间的顺序或特殊性是在将它们与字符串匹配之前确定的。你没有在问题中说清楚，但我想你想到的是长度。因此，假设您将数据作为哈希：

```
h = {
  item1: "pork with apple sauce",
  item2: "pork",
  item3: "apple sauce",
} 
```

然后，您可以按标签的长度对其进行排序，以便较长的标签出现在列表中。同时，您可以将标签转换为正则表达式，这样您就无需担心空间的变化。然后，您将有一个这样的数组：

```
a =
h
.sort_by{|_, s| s.length}.reverse
.map{|k, s| [k, Regexp.new("\\b#{s.gsub(/\s+/, '\\s+')}\\b")]}
# =>
# [
#   [
#     :item1,
#     /\bpork\s+with\s+apple\s+sauce\b/
#   ],
#   [
#     :item3,
#     /\bapple\s+sauce\b/
#   ],
#   [
#     :item2,
#     /\bpork\b/
#   ]
# ] 
```

一旦你有了这个，你只需要在列表中找到与字符串匹配的第一个项目。

```
s = "Today I would like to eat pork with apple sauce, it would fill me up"

a.find{|_, r| s =~ r}[0]
# => :item1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T01:30:11.050

这将适用于一般编程，而不是特别适用于 Ruby。

我会标记两个字符串，即针和干草堆，然后在计算发生次数的同时循环遍历它们。然后最后比较分数。

一些须藤代码：

```
needle[] = array of tokens from keysentence
haystack[] array of tokens from search string
int score = 0

do {
  haystackToken = haystack's next token

  do {
    needleToken = needle's next token

    if (haystackToken equals needleToken)
      score += 1

   } while(needle has more token)

} while (haystack has more tokens) 
```

# css - 将 ul 对齐到水平 CSS 菜单的中间

> ID：14096365
> 
> 赞同：1
> 
> 时间：2012-12-31T01:01:43.240
> 
> 标签：css, menu, alignment, html-lists

我试图有一个水平菜单，但 ul 向右而不是在中间对齐。

这是我的 CSS 和 HTML：

CSS：

```
#menu
{
    clear: both;
    float: left;
    width: 830px;
    display: inline;
    position: relative;
    z-index: 1;
    border-top: 1px solid #e9e6d9;
    border-bottom: 1px solid #e9e6d9; 
    margin: 0 auto;
    background-color:#FFFFFF;
    padding: 0;
}
#menu ul {
    margin: 0;
    display: block;
    text-align: center;
    padding: 0;
    float: right;
}
#menu li {
    /*font-family: Georgia, "Times New Roman", Times, serif;*/
    font-family: sans-serif, Helvetica, Arial;
    font-size: 13px;
    font-weight: normal;
    float: left;
    position: relative;
    list-style: none;
    margin: 0;
    display: inline-block;
    padding: 0;
} 
```

HTML：

```
<div id="menu">
    <ul>
        <li>
            <a href="http://www.tahara.es/">
                <span>HOME</span>
            </a>
        </li>
        <li>
            <a href="http://www.tahara.es/shop/">
                <span>SHOP</span>
            </a>
        </li>
    </ul>   
</div> 
```

提前感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:07:22.103

改变`#menu ul`- 使用`float: left`而不是`float: right`

```
#menu ul {
margin: 0;
display: block;
text-align: center;
padding: 0;
float: left;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T01:24:11.367

我解决了你的问题。html代码没问题，我更改了css代码：

```
#menu
{
clear: both;
width: 830px;
display: inline;
position: relative;
z-index: 1;
border-top: 1px solid #e9e6d9;
border-bottom: 1px solid #e9e6d9; 
margin: 0 auto;
background-color:#FFFFFF;
padding: 0;
}
#menu ul {
margin: 0;
display: block;
text-align: center;
padding: 0;
}
#menu li {
    /*font-family: Georgia, "Times New Roman", Times, serif;*/
    font-family: sans-serif, Helvetica, Arial;
    font-size: 13px;
    font-weight: normal;
    position: relative;
    list-style: none;
    margin: 0;
    display: inline-block;
    padding: 0;​ 
```

我基本上删除了`float:right;`. 解决您的问题就这么简单。

这是一个[演示](http://jsfiddle.net/NrFae/)。

如果您需要进一步的帮助，我可以帮助您。

我还建议你一些链接，你可以找到对构建 css 菜单有用的链接：

[http://csswizardry.com/2011/02/creating-a-pure-css-dropdown-menu/](http://csswizardry.com/2011/02/creating-a-pure-css-dropdown-menu/)

[http://net.tutsplus.com/tutorials/html-css-techniques/how-to-create-a-drop-down-nav-menu-with-html5-css3-and-jquery/](http://net.tutsplus.com/tutorials/html-css-techniques/how-to-create-a-drop-down-nav-menu-with-html5-css3-and-jquery/)

[http://net.tutsplus.com/tutorials/html-css-techniques/how-to-build-a-kick-butt-css3-mega-drop-down-menu/](http://net.tutsplus.com/tutorials/html-css-techniques/how-to-build-a-kick-butt-css3-mega-drop-down-menu/)

[http://net.tutsplus.com/tutorials/design-tutorials/how-to-build-and-enhance-a-3-level-navigation-menu/](http://net.tutsplus.com/tutorials/design-tutorials/how-to-build-and-enhance-a-3-level-navigation-menu/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T01:24:23.460

您可以删除浮动属性。只需在#menu ul 中添加宽度并添加边距：0 auto; 使其居中。

例子 ：

```
#menu ul {
    width: 300px;
    margin: 0 auto;
} 
```

现场演示：http: [//codepen.io/joe/pen/uAaHo](http://codepen.io/joe/pen/uAaHo)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-16T14:52:19.663

定位菜单的最简单代码非常简单。

此代码工作正常，在最新的 Safari、Chrome、Opera、Firefox 上测试。也在 IE11 和 IE8 上。

[http://jsfiddle.net/5ZrEx/](http://jsfiddle.net/5ZrEx/)

```
#menu
{
  width: 830px; 
  margin: 0 auto;
  display: inline;
}
  #menu ul {    
  text-align: center;
}
#menu li {     
  display: inline-block;    
} 
```

# jquery - 字体随着 CSS/jQuery 动画闪烁……这是什么原因？

> ID：14096375
> 
> 赞同：1
> 
> 时间：2012-12-31T01:03:36.220
> 
> 标签：jquery, css, animation, browser

这是我正在开发的网站的开发位置：[http ://www.plasticmonument.com/biomechaniks/index.html](http://www.plasticmonument.com/biomechaniks/index.html)

每次发生任何 jQuery 滑块动画时，页面上的所有字体都会闪烁，或者会立即增加字体粗细。这到底是什么原因造成的？快把我逼疯了！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T01:13:40.730

一种解决方案是将其添加到 CSS

```
html {-webkit-font-smoothing: antialiased} 
```

但我只是环顾四周，显然给出了动画元素`position:relative`，页面上的最高点`z-index`阻止了这种情况的发生。

# objective-c - 无法从 UIButton 获取 UITouch 事件

> ID：14096379
> 
> 赞同：1
> 
> 时间：2012-12-31T01:04:09.263
> 
> 标签：objective-c, ios, xcode, cocoa-touch, user-interface

问题：

我无法让我的 UIButton 向我的班级发送事件调用

这是我首先尝试的：

我做了一个扩展 UIViewController 的类，叫做 Viewer

```
#import "Viewer.h"
#import "MainScreen.h"

@implementation Viewer

- (void)viewDidLoad
{
    MainScreen* main = [[MainScreen alloc]init: self];
    [main show];

    [super viewDidLoad];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

@end 
```

然后：

*   我创建了一个名为 MainScreen、2 IBOutlets 的类 - singlePlayerButton 和视图
*   Viewer 是 UIViewController 的一个实例
*   buttonPressed 的返回类型为 IBAction

主屏幕：

```
#import "MainScreen.h"
#import "Viewer.h"

@implementation MainScreen
{
    IBOutlet UIButton* singlePlayerButton;
    IBOutlet UIView* view;

    Viewer* viewer;
}

- (id)init:(Viewer*) theViewer
{
    self = [super init];
    viewer = theViewer;
    return self;
}

- (void)show
{
    [[NSBundle mainBundle] loadNibNamed:@"MainScreenLayout" owner:self options:nil];
    [viewer.view addSubview:view];
}

- (IBAction)buttonPressed:(id)sender
{
    NSLog(@"A button was pressed!");
}

@end 
```

然后我创建了一个名为`MainScreenLayout.xib`

这是它的样子：

![我的 NIB 文件的屏幕截图](../Images/709ba36009fb61b088b50cb789848ecf.png)

如您所见，我有四个按钮，但唯一连接到任何东西的是单人按钮我也有 UIView 连接到视图。

现在，我将动作链接到单人游戏按钮，如下所示：

![将操作连接到按钮的屏幕截图](../Images/0cb869a6dee9464bd36df2c79bc0e5de.png)

`buttonPressed`是我想要在按下按钮时调用的方法，所以我按住 ctrl 键单击 First Responder，然后单击旁边的圆圈`buttonPressed`，然后将其拖到 Single-Player 按钮的顶部。然后弹出下一个对话框窗口，我点击了 Touch up Inside。以下是 Received Actions 窗口的外观：

![第一响应者窗口的屏幕截图](../Images/b92051f255106286e9bb89ac7501146c.png)

现在，我认为此时它应该可以工作。我在我的 iPhone 模拟器上运行它并按下按钮。

就这样不存在我是否有能力的问题，这是我实际单击按钮的照片：

![截屏](../Images/94c2358cab465972555b750de982b993.png)

我没有任何输出。然后我去了我的代码并查看了方法。这是它的样子：

![方法截图](../Images/5b8235c32d619d0a8739ce9c5500eacc.png)

如您所见，椭圆未填充，这意味着该方法未配对。所以很自然地，我认为它被另一种方法覆盖了。所以这里是这个方法现在的样子：

```
- (IBAction)aVerySpecificMethodNameForMyButtonListener:(id)sender
{
    NSLog(@"A button was pressed!");
} 
```

然后我回到我的 NIB 窗口，取消配对我的单人游戏按钮，然后将其修复为`aVerySpecificMethodNameForMyButtonListener`. 现在这就是它的样子：

![可笑的方法名称的屏幕截图](../Images/8acd410c9480e65457c740022818ef30.png)

然后我再次运行它，当我按下按钮时仍然没有。然后我回到代码：

![截屏](../Images/6a7efd32aac4a8fcc1cf70ce5c5c7721.png)

（在这里插入沮丧）

此时我重新启动了 Xcode 和模拟器并再次查看了所有内容，但它仍然无法正常工作。

这就是我接下来尝试的方法，它看起来简单了十亿倍：

```
- (void)show
{
    [[NSBundle mainBundle] loadNibNamed:@"MainScreenLayout" owner:self options:nil];
    [viewer.view addSubview:view];

    [singlePlayerButton addTarget:self action:@selector(aVerySpecificMethodNameForMyButtonListener:) forControlEvents:UIControlEventTouchUpInside];
} 
```

我用`show`上面的方法替换了我的方法。唯一不同的是最后一行。我断开了我的方法与 NIB 中的 Single-Player 按钮的连接。然后我运行它，我兴奋了一秒钟，因为我得到了一些输出。这是我得到的：

```
(lldb) 
```

非常有用的输出 C 调试器，一如既往。我花了接下来的几个小时试图找出我做错了什么。我尝试了无数的例子，但没有一个有效。

有人看到我在这里做错了吗？只是 Xcode 很脆弱吗？

谢谢阅读！！欢迎所有相关答案！

* * *

更新：

我还尝试将 UIButton 的声明更改为 Header 文件中的属性：

```
#import <Foundation/Foundation.h>
#import "Viewer.h"

@interface MainScreen : NSObject
{
    IBOutlet UIView* view;

    Viewer* viewer;
}

@property (weak, nonatomic) IBOutlet UIButton* singlePlayerButton;

- (id)init:(Viewer*) theViewer;
- (void)show;
- (IBAction)aVerySpecificMethodNameForMyButtonListener:(id)sender;

@end 
```

因此，这是我在 MainScreen.m 中更改的内容：

```
#import "MainScreen.h"
#import "Viewer.h"

@implementation MainScreen

- (id)init:(Viewer*) theViewer
{
    self = [super init];
    viewer = theViewer;
    return self;
}

@synthesize singlePlayerButton;

- (void)show
{
    [[NSBundle mainBundle] loadNibNamed:@"MainScreenLayout" owner:self options:nil];
    [viewer.view addSubview:view];

    [singlePlayerButton addTarget:self action:@selector(aVerySpecificMethodNameForMyButtonListener:) forControlEvents:UIControlEventTouchUpInside];
}

- (IBAction)aVerySpecificMethodNameForMyButtonListener:(id)sender
{
    NSLog(@"A button was pressed!");
}

@end 
```

现在 MainScreen.m 文件中没有变量声明，我将它们全部移到了 Header 中。`singlePlayerButton`和旁边的圆圈`view`仍然填充，但方法旁边的气泡没有。我再次运行代码并得到相同的输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:21:05.117

所以我会把它放在评论中，因为它实际上只是一个建议，但是我没有代表很抱歉让你寄予厚望，但我相信触摸事件的范围仅在它发生的 UIView 内。当触发触摸事件时，它不会传递给 UIView 的处理程序（MainScreen 类），因此不会调用事件的侦听器方法......但是您可以在界面构建器中将其链接到按钮是对我来说莫名其妙，所以我可能会离开。

无论如何，我认为你下一步应该做的是让你的 MainScreen 成为 UIView 对象，看看它对视图中按钮的事件处理有什么作用。

# java - 从球衣响应中强制 json

> ID：14096383
> 
> 赞同：0
> 
> 时间：2012-12-31T01:04:39.980
> 
> 标签：java, jersey

我正在尝试实现这个[例子](https://github.com/blueimp/jQuery-File-Upload/issues/425)。FileResource 中的第一个方法应该返回一个 json 响应，但响应是作为 XML 来的。我以前从未使用过球衣。我尝试添加@produces 产生这个：

```
@GET @Produces("application/json")
@Path("/url")
public Response getCallbackUrl() {
    String url = blobstoreService.createUploadUrl("/rest/file");
    return Response.ok(new FileUrl(url)).build();
} 
```

现在我得到

```
A message body writer for Java class FileUrl, and Java type class FileUrl, and MIME media type application/json was not found 
```

我怎样才能解决这个问题？谢谢你的帮助。如果您需要更多信息，请告诉我。我不太了解球衣术语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:17:16.697

您需要更多的依赖项才能生成 JSON 输出。

看看：http: [//jersey.java.net/nonav/documentation/latest/chapter_deps.html](http://jersey.java.net/nonav/documentation/latest/chapter_deps.html)

向下滚动至：

> **11.4.1.2。MOXy** Maven 开发人员在使用 MIME 媒体类型 application/json 时使用 JAXB bean 的 JSON 序列化支持需要对 jersey-json 模块的依赖（需要对 org.eclipse.persistence.moxy 的显式依赖）。

* * *

您可能感兴趣的“香草”泽西岛的替代品是[Dropwizard](http://dropwizard.codahale.com/)。他们的简介是：

> Dropwizard 对复杂的配置、应用程序指标、日志记录、操作工具等提供开箱即用的支持，使您和您的团队能够在尽可能短的时间内交付生产质量的 HTTP+JSON Web 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T12:08:20.920

是的，你需要一些 jersey / json 依赖项：

```
<dependency>
<groupId>com.sun.jersey</groupId>
<artifactId>jersey-json</artifactId>
<version>1.2</version>
</dependency> 
```

当然是你的球衣版本。

# solr - Solr中每个查询词的模糊匹配

> ID：14096393
> 
> 赞同：0
> 
> 时间：2012-12-31T01:05:55.787
> 
> 标签：solr, lucene, levenshtein-distance, fuzzy-search

Lucene 4 的 Levenshtein 实现声称比以前快 100 倍（[http://blog.mikemccandless.com/2011/03/lucenes-fuzzyquery-is-100-times-faster.html](http://blog.mikemccandless.com/2011/03/lucenes-fuzzyquery-is-100-times-faster.html)）我想做模糊匹配查询中的所有术语。这个想法是搜索“gren hook”应该能够找到文档“greenhouse”（此时我并不真正关心短语，引号只是为了使其更具可读性）。

我正在使用 Lucene 4 + Solr 4。当我在做一些预处理和后处理时，Solr 周围有一个小的包装 servlet，servlet 使用 SolrJ 最终访问 Solr

我目前对实现这一目标的正确方法有点迷茫。我的基本方法是将搜索查询分解为术语并将波浪号/模糊运算符附加到每个术语。因此 'gren hook' 会变成 'gren~hose~' 。现在的问题是如何正确地做到这一点。我可以看到几种方法：

1.  蛮力：假设术语由空格分隔，因此只需解析查询并在每个空格之前附加一个波浪号（即在每个术语之后）
2.  两个步骤： 将查询发送到 Solr 并打开查询调试。这将给我一个由 Solr 解析的查询术语列表。然后我可以从调试输出中提取术语，附加波浪号运算符并使用添加的波浪号运算符重新运行查询
3.  在内部：挂钩到搜索请求处理程序并在查询被解析为术语后附加波浪号运算符

方法 1 很臭，因为它完全绕过了 Solr 的查询解析，所以我宁愿不这样做。如果两次解析查询的成本不太高，方法 2 听起来很可行。方法 3 听起来不错，但我还没有弄清楚我必须在哪里连接到处理链。

也许有一种完全不同的方式来实现我想做的事情，或者这只是我的一个愚蠢的想法。无论如何，我真的很感激一些指点，也许其他人已经做过这样的事情。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T06:00:39.547

我会提出以下方法：

1.  在您的应用程序中实现一个查询处理程序模块，您可以在其中从输入用户查询构建 solr 查询。这样，SOLR 端没有任何变化，您的应用程序可以完全控制进入 SOLR 的内容。

2.  实现您自己的查询解析器，您可以从标准 SOLR 查询解析器 (org.apache.solr.search.QParser) 开始并进行更改。您的应用程序只需要选择您的自定义查询解析器，然后您的实现应该小心。

我更喜欢方法 1，因为这使系统对 SOLR 升级完全不可知，任何新版本的 Solr 都不需要我更新自定义 qparser，您不必在新版本中更新/构建和设置自定义 qparser。

如果您对应用程序没有任何控制权并且不想通过 q​​parser 路由，那么您可以实现一个 Servlet 过滤器，该过滤器在将 solr 查询分派到 solr 请求过滤器之前对其进行转换。

# iphone - 在应用程序问题内拨打电话号码

> ID：14096402
> 
> 赞同：1
> 
> 时间：2012-12-31T01:08:43.477
> 
> 标签：iphone, objective-c, ios

我有以下代码：

```
phoneNumber = (NSString*)CFBridgingRelease(ABMultiValueCopyValueAtIndex(phones, i));
NSString *phoneNumberURLString = [[NSString alloc] initWithFormat:@"tel://%@", phoneNumber];
            NSURL *phoneURL = [[NSURL alloc] initWithString:phoneNumberURLString];
            [[UIApplication sharedApplication] openURL:phoneURL]; 
```

但是，问题在于，有时某个电话号码不会被呼叫：例如，如果 phoneNumber 是 (520) 123-1232，那么这不会呼叫电话。关于如何标准化电话号码格式以使此方法适用于所有情况的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:29:11.750

它是数字中的空格。空格不是有效的 URL 字符。它必须被编码为`%20`.

# android - 使用 Android SDK 3.0 登录 Facebook 会导致 ANR 或根本无法工作

> ID：14096403
> 
> 赞同：10
> 
> 时间：2012-12-31T01:08:49.920
> 
> 标签：android, facebook-android-sdk

**为了让用户在 Android 应用程序中登录 Facebook，我正在尝试使用以下代码。用户登录后，应该获取他们所有朋友的位置。**

不幸的是，此代码有时会导致 ANR（如 Google Play 开发者控制台中所述），有时它只是不起作用。如果我删除 Facebook 内的应用程序（撤销权限），权限对话框会在下次启动 Android 应用程序时再次显示。但是如果应用程序已经拥有权限，它会导致那些 ANR 或者只是退出而没有成功。

似乎零件工作正常，零件错了，不是吗？以下代码是登录和获取数据的正确方法吗？

```
package com.my.application;

import java.util.Arrays;
import java.util.List;
import org.json.JSONArray;
import org.json.JSONObject;
import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.os.Bundle;
import android.preference.PreferenceManager;
import com.facebook.*;
import com.facebook.Session.OpenRequest;
import com.facebook.Session.StatusCallback;

public class FBLocations extends Activity {

    private Session.StatusCallback fbStatusCallback = new Session.StatusCallback() {
        @Override
        public void call(Session session, SessionState state, Exception exception) { // callback for session state changes
            if (state.isOpened()) {
                Request.executeGraphPathRequestAsync(session, "me/friends/?access_token="+session.getAccessToken()+"&fields=id,name,location&limit=500", new Request.Callback() {
                    @Override
                    public void onCompleted(Response response) {
                        if (response != null) {
                            // do something with <response> now
                        }
                    }
                });
            }
        }
    };

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        try {
            openActiveSession(this, true, fbStatusCallback, Arrays.asList("friends_location"));
        }
        catch (Exception e) {
            e.printStackTrace();
        }
    }

    private static Session openActiveSession(Activity activity, boolean allowLoginUI, StatusCallback callback, List<String> permissions) {
        OpenRequest openRequest = new OpenRequest(activity).setPermissions(permissions).setLoginBehavior(SessionLoginBehavior.SSO_WITH_FALLBACK).setCallback(callback).setDefaultAudience(SessionDefaultAudience.FRIENDS);
        Session session = new Session.Builder(activity).build();
        if (SessionState.CREATED_TOKEN_LOADED.equals(session.getState()) || allowLoginUI) {
            Session.setActiveSession(session);
            session.openForRead(openRequest);
            return session;
        }
        return null;
    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        Session.getActiveSession().onActivityResult(this, requestCode, resultCode, data);
    }

} 
```

我还在 Facebook 中添加了应用程序的密钥哈希，包括调试和生产。不确定是否`=`也必须编写填充。

![在此处输入图像描述](../Images/3af06e92d93a227d71c688f130f61551.png)

我无法遵循 Facebook 的官方教程，因为我不会使用 SDK 的登录按钮，也不会在 Android 中使用片段。

**编辑（2013 年 1 月 7 日）：**

在[Hartok](https://stackoverflow.com/users/1489493/hartok)建议在回调方法中替换`session.isOpened()`by之后，现在 50% 的测试运行都可以正常工作。尽管如此，还是有一些问题。在某些情况下，一切正常，在其他一些情况下（没有我做任何不同的事情），LogCat 中有以下错误：`state.isOpened()``call()`

```
01-07 01:55:29.882: W/System.err(30572): com.facebook.FacebookException: Log in attempt aborted.
at com.facebook.Session.close(Session.java:572)
at com.facebook.Session.setActiveSession(Session.java:755)
at my.app.package.FBImport.openActiveSession(FBImport.java:145) // this is: Session.setActiveSession(session);
at my.app.package.FBImport.access$5(FBImport.java:139)
at my.app.package.FBImport$4.run(FBImport.java:124) 
```

是什么导致了这个错误？客户端问题还是服务器问题？顺便说一句，在那之后应用程序似乎冻结（ANR）。

如果我尝试按顺序连接两次，我会看到以下 LogCat 输出：

```
java.lang.IllegalStateException: Cannot execute task: the task is already running.
at android.os.AsyncTask.executeOnExecutor(AsyncTask.java:550)
at android.os.AsyncTask.execute(AsyncTask.java:511)
at com.facebook.RequestAsyncTask.executeOnSettingsExecutor(RequestAsyncTask.java:186)
at com.facebook.Request.executeBatchAsync(Request.java:1094)
at com.facebook.Request.executeBatchAsync(Request.java:1073)
at com.facebook.Request.executeBatchAsync(Request.java:1055)
at com.facebook.Request.executeAsync(Request.java:852) 
```

这是为什么？为什么任务还在运行？

**ANR 描述（ANR keyDispatchingTimedOut）：**

```
DALVIK THREADS:
(mutexes: tll=0 tsl=0 tscl=0 ghl=0)

"main" prio=5 tid=1 NATIVE
  | group="main" sCount=1 dsCount=0 obj=0x4184e9a0 self=0x40011010
  | sysTid=19301 nice=0 sched=0/0 cgrp=apps handle=1074414556
  | state=S schedstat=( 906984000 397085000 2526 ) utm=66 stm=24 core=0
  #00 pc 00017ee4 /system/lib/libc.so (epoll_wait+12)
  #01 pc 00014b09 /system/lib/libutils.so (android::Looper::pollInner(int)+96)
  #02 pc 00014d71 /system/lib/libutils.so (android::Looper::pollOnce(int, int*, int*, void**)+104)
  #03 pc 0005ed53 /system/lib/libandroid_runtime.so (android::NativeMessageQueue::pollOnce(_JNIEnv*, int)+22)
  #04 pc 0001e290 /system/lib/libdvm.so (dvmPlatformInvoke+112)
  #05 pc 0004d411 /system/lib/libdvm.so (dvmCallJNIMethod(unsigned int const*, JValue*, Method const*, Thread*)+396)
  #06 pc 000276a0 /system/lib/libdvm.so
  #07 pc 0002b57c /system/lib/libdvm.so (dvmInterpret(Thread*, Method const*, JValue*)+184)
  #08 pc 0005ff07 /system/lib/libdvm.so (dvmInvokeMethod(Object*, Method const*, ArrayObject*, ArrayObject*, ClassObject*, bool)+374)
  #09 pc 000677e1 /system/lib/libdvm.so
  #10 pc 000276a0 /system/lib/libdvm.so
  #11 pc 0002b57c /system/lib/libdvm.so (dvmInterpret(Thread*, Method const*, JValue*)+184)
  #12 pc 0005fc31 /system/lib/libdvm.so (dvmCallMethodV(Thread*, Method const*, Object*, bool, JValue*, std::__va_list)+272)
  #13 pc 000499fb /system/lib/libdvm.so
  #14 pc 00046871 /system/lib/libandroid_runtime.so
  #15 pc 00047533 /system/lib/libandroid_runtime.so (android::AndroidRuntime::start(char const*, char const*)+390)
  #16 pc 00000db7 /system/bin/app_process
  #17 pc 0001271f /system/lib/libc.so (__libc_init+38)
  #18 pc 00000ae8 /system/bin/app_process
  at android.os.MessageQueue.nativePollOnce(Native Method)
  at android.os.MessageQueue.next(MessageQueue.java:125)
  at android.os.Looper.loop(Looper.java:124)
  at android.app.ActivityThread.main(ActivityThread.java:5039)
  at java.lang.reflect.Method.invokeNative(Native Method)
  at java.lang.reflect.Method.invoke(Method.java:511)
  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
  at dalvik.system.NativeStart.main(Native Method)

"AsyncTask #2" prio=5 tid=17 WAIT
  | group="main" sCount=1 dsCount=0 obj=0x4205f6d0 self=0x6742f940
  | sysTid=19354 nice=10 sched=0/0 cgrp=apps/bg_non_interactive handle=1732251672
  | state=S schedstat=( 82839000 103493000 646 ) utm=5 stm=3 core=0
  at java.lang.Object.wait(Native Method)
  - waiting on <0x4205f7f0> (a java.lang.VMThread) held by tid=17 (AsyncTask #2)
  at java.lang.Thread.parkFor(Thread.java:1231)
  at sun.misc.Unsafe.park(Unsafe.java:323)
  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:159)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2019)
  at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:413)
  at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1013)
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1073)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
  at java.lang.Thread.run(Thread.java:856)

"Binder_3" prio=5 tid=16 NATIVE
  | group="main" sCount=1 dsCount=0 obj=0x41fed668 self=0x41838008
  | sysTid=19330 nice=0 sched=0/0 cgrp=apps handle=1742766600
  | state=S schedstat=( 1078000 818000 10 ) utm=0 stm=0 core=0
  #00 pc 00016fe4 /system/lib/libc.so (__ioctl+8)
  #01 pc 0002a97d /system/lib/libc.so (ioctl+16)
  #02 pc 00016ba1 /system/lib/libbinder.so (android::IPCThreadState::talkWithDriver(bool)+132)
  #03 pc 00017363 /system/lib/libbinder.so (android::IPCThreadState::joinThreadPool(bool)+154)
  #04 pc 0001b15d /system/lib/libbinder.so
  #05 pc 00011267 /system/lib/libutils.so (android::Thread::_threadLoop(void*)+114)
  #06 pc 0004679f /system/lib/libandroid_runtime.so (android::AndroidRuntime::javaThreadShell(void*)+66)
  #07 pc 00010dcd /system/lib/libutils.so
  #08 pc 0000e3d8 /system/lib/libc.so (__thread_entry+72)
  #09 pc 0000dac4 /system/lib/libc.so (pthread_create+160)
  at dalvik.system.NativeStart.run(Native Method)

"pool-1-thread-5" prio=5 tid=15 WAIT
  | group="main" sCount=1 dsCount=0 obj=0x420423d0 self=0x673d8ab8
  | sysTid=19329 nice=0 sched=0/0 cgrp=apps handle=1732087560
  | state=S schedstat=( 6292000 7083000 36 ) utm=0 stm=0 core=2
  at java.lang.Object.wait(Native Method)
  - waiting on <0x42042528> (a java.lang.VMThread) held by tid=15 (pool-1-thread-5)
  at java.lang.Thread.parkFor(Thread.java:1231)
  at sun.misc.Unsafe.park(Unsafe.java:323)
  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:159)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2019)
  at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:413)
  at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1013)
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1073)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
  at java.lang.Thread.run(Thread.java:856)

"pool-1-thread-4" prio=5 tid=14 WAIT
  | group="main" sCount=1 dsCount=0 obj=0x42039040 self=0x673cb248
  | sysTid=19328 nice=0 sched=0/0 cgrp=apps handle=1732032152
  | state=S schedstat=( 8178000 7047000 32 ) utm=0 stm=0 core=3
  at java.lang.Object.wait(Native Method)
  - waiting on <0x42039160> (a java.lang.VMThread) held by tid=14 (pool-1-thread-4)
  at java.lang.Thread.parkFor(Thread.java:1231)
  at sun.misc.Unsafe.park(Unsafe.java:323)
  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:159)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2019)
  at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:413)
  at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1013)
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1073)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
  at java.lang.Thread.run(Thread.java:856)

"pool-1-thread-3" prio=5 tid=13 WAIT
  | group="main" sCount=1 dsCount=0 obj=0x42027140 self=0x673c95f8
  | sysTid=19327 nice=0 sched=0/0 cgrp=apps handle=1698808232
  | state=S schedstat=( 10642000 19156000 34 ) utm=1 stm=0 core=1
  at java.lang.Object.wait(Native Method)
  - waiting on <0x42027260> (a java.lang.VMThread) held by tid=13 (pool-1-thread-3)
  at java.lang.Thread.parkFor(Thread.java:1231)
  at sun.misc.Unsafe.park(Unsafe.java:323)
  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:159)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2019)
  at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:413)
  at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1013)
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1073)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
  at java.lang.Thread.run(Thread.java:856)

"pool-1-thread-2" prio=5 tid=12 WAIT
  | group="main" sCount=1 dsCount=0 obj=0x4201d958 self=0x672cd008
  | sysTid=19326 nice=0 sched=0/0 cgrp=apps handle=1731988480
  | state=S schedstat=( 17725000 16571000 59 ) utm=1 stm=0 core=3
  at java.lang.Object.wait(Native Method)
  - waiting on <0x4201da78> (a java.lang.VMThread) held by tid=12 (pool-1-thread-2)
  at java.lang.Thread.parkFor(Thread.java:1231)
  at sun.misc.Unsafe.park(Unsafe.java:323)
  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:159)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2019)
  at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:413)
  at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1013)
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1073)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
  at java.lang.Thread.run(Thread.java:856)

"pool-1-thread-1" prio=5 tid=11 WAIT
  | group="main" sCount=1 dsCount=0 obj=0x420156c8 self=0x65dc8818
  | sysTid=19325 nice=0 sched=0/0 cgrp=apps handle=1728232912
  | state=S schedstat=( 11166000 9311000 77 ) utm=0 stm=1 core=2
  at java.lang.Object.wait(Native Method)
  - waiting on <0x42015810> (a java.lang.VMThread) held by tid=11 (pool-1-thread-1)
  at java.lang.Thread.parkFor(Thread.java:1231)
  at sun.misc.Unsafe.park(Unsafe.java:323)
  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:159)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2019)
  at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:413)
  at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1013)
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1073)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
  at java.lang.Thread.run(Thread.java:856)

"AsyncTask #1" prio=5 tid=10 WAIT
  | group="main" sCount=1 dsCount=0 obj=0x41fb5990 self=0x63bd3008
  | sysTid=19318 nice=10 sched=0/0 cgrp=apps/bg_non_interactive handle=1748684416
  | state=S schedstat=( 24263000 18668000 33 ) utm=1 stm=1 core=1
  at java.lang.Object.wait(Native Method)
  - waiting on <0x41fd07d0> (a java.lang.VMThread) held by tid=10 (AsyncTask #1)
  at java.lang.Thread.parkFor(Thread.java:1231)
  at sun.misc.Unsafe.park(Unsafe.java:323)
  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:159)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2019)
  at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:413)
  at java.util.concurrent.ThreadPoolExecutor... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T04:49:48.423

`Log in attempt aborted`被触发是因为`Session.setActiveSession()`在前一个会话当前打开时被调用。

可以打`Session.setActiveSession()`两次吗？

你可以试试这段代码。它没有经过测试，但它部分来自 SessionLoginSample。

```
private static Session openActiveSession(Activity activity, boolean allowLoginUI, StatusCallback callback, List<String> permissions, Bundle savedInstanceState) {

    OpenRequest openRequest = new OpenRequest(activity).setPermissions(permissions).setLoginBehavior(SessionLoginBehavior.SSO_WITH_FALLBACK).setCallback(callback).setDefaultAudience(SessionDefaultAudience.FRIENDS);

    Session session = Session.getActiveSession();
    if (session == null) {
        if (savedInstanceState != null) {
            session = Session.restoreSession(this, null, fbStatusCallback, savedInstanceState);
        }
        if (session == null) {
            session = new Session(this);
        }
        Session.setActiveSession(session);
        if (session.getState().equals(SessionState.CREATED_TOKEN_LOADED) || allowLoginUI) {
            session.openForRead(openRequest);
            return session;
        }
    }

    return null;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T17:08:13.927

如果在用户已经授权权限的情况下挂断，请尝试检查权限并根据权限是否存在排除代码。就像是：

```
if(!session.getReadPermissions.contains("friends_location"){
    //restore or start the session and ask for the permission
}
else{
    //do stuff that would happen after the permission is already granted
} 
```

我不在我的工作站，所以该方法可能有点偏离，但这是我会尝试的一般想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T03:07:49.993

用下面的代码替换您的 openActiveSession 调用。

```
new Thread()
        {

            @Override
            public void run()
            {

openActiveSession(this, true, fbStatusCallback, Arrays.asList("friends_location"));

            }
        }.start(); 
```

# ruby-on-rails - Rails 生成错误的复数形式

> ID：14096407
> 
> 赞同：4
> 
> 时间：2012-12-31T01:09:10.547
> 
> 标签：ruby-on-rails

当我在 rails 控制台中执行以下操作时，我使用 Ruby 1.9.3 和 Rails 3.2.9：

1.9.3p125 :003 > "foot".pluralize => "foots" # 不应该是 "feet" 吗？

1.9.3p125 :004 > "tooth".pluralize => "tooths" # 不应该是 "teeth" 吗？

1.9.3p125 :009 > "goose".pluralize => "gooses" # 不应该是 "geese" 吗？

这是rails中的错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T01:14:46.320

您可以配置 rails 变形器。您的应用程序中应该有一个初始化文件来执行此操作：`config/initializers/inflections.rb`

然后，您可以添加一个调用来“教授”新规则：

```
ActiveSupport::Inflector.inflections do |inflect|
 inflect.irregular 'tooth', 'teeth'
end 
```

重新启动服务器/控制台后，新的复数形式应该就位。

# c# - Windows Phone 8，覆盖旧应用程序？

> ID：14096408
> 
> 赞同：3
> 
> 时间：2012-12-31T01:09:21.637
> 
> 标签：c#, windows

每当您部署应用程序时，我都可以在 WP7 中宣誓，它会覆盖以前的版本。然而，它似乎不再这样做了？是否有设置可以重新打开它，或者我必须在部署之前继续删除应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T00:39:04.963

以我的经验，部署到手机将进行就地更新（保留所有隔离存储，与实际的商店更新非常相似），除非它检测到已执行干净重建或其他一些元数据已更改（例如应用程序ID）。

因此，如果您看到它进行增量部署，那是正常的。如果您希望它进行全新的重新安装，请从 Visual Studio 进行全新的重新构建（或者在再次部署之前将其从手机中卸载）。

# c# - 字符串的按位运算 - 1440 个字符长度

> ID：14096409
> 
> 赞同：3
> 
> 时间：2012-12-31T01:09:23.920
> 
> 标签：c#, string, bit-manipulation, logical-operators, operation

如何在 c# 中对字符串进行按位运算

例子

```
string sr1="0101110";
string sr2="1101110";

sr1 & sr2="0101110"; 
```

或者

```
sr1 | sr2="1101110"; 
```

我怎么能做这样的比较？

**注意字符串长度固定为 1440 个字符**

这是我的肮脏解决方案

```
 private string compareBitWiseAnd(string sr1, string sr2)
    {
        char[] crArray1 = sr1.ToCharArray();
        char[] crArray2 = sr2.ToCharArray();
        StringBuilder srResult = new StringBuilder();

        for (int i = 0; i < crArray1.Length; i++)
        {
            if (crArray1[i] == crArray2[i])
            {
                srResult.Append(crArray1[i]);
            }
            else
            {
                srResult.Append('0');
            }
        }

        return srResult.ToString();
    }

    private string compareBitWiseOr(string sr1, string sr2)
    {
        char[] crArray1 = sr1.ToCharArray();
        char[] crArray2 = sr2.ToCharArray();
        StringBuilder srResult = new StringBuilder();

        for (int i = 0; i < crArray1.Length; i++)
        {
            if (crArray1[i] == '1' || crArray2[i] == '1')
            {
                srResult.Append("1");
            }
            else
            {
                srResult.Append('0');
            }
        }

        return srResult.ToString();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T01:18:10.230

[首先转换](http://msdn.microsoft.com/en-us/library/1k20k614.aspx)为实际位，然后进行按位比较。

```
int num1 = Convert.ToInt32(sr1, 2);
int num2 = Convert.ToInt32(sr2, 2);

int result = num1 & num2; 
```

如果您[想](https://stackoverflow.com/q/3702216/102937)从`result`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T01:20:54.893

您必须先将字符串转换为数字，您可以使用“Convert.ToInt32(String, Int32)”，第二个参数让您指定基数：

```
string sr1 = "0101110";
string sr2 = "1101110";

int one = Convert.ToInt32(sr1, 2);
int two = Convert.ToInt32(sr2, 2);

int result = one & two; 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T01:45:11.510

`BigInteger`是您正在寻找的类型。它也有[BitwiseOr](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.op_bitwiseor.aspx)。

如果你真的需要坚持使用字符串，那么逐个字符地计算按位运算并不是很困难......但如果可能的话，我会避免这样做。

这是一个关于如何`BigInteger`从任何基数的字符串构造的问题 - [BigInteger Parse Octal String？](https://stackoverflow.com/questions/14040483/biginteger-parse-octal-string/14040916)

```
var bitString = "10101";
BigInteger value = bitString.Aggregate(new BigInteger(), (b, c) => b * 2 + c - '0'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T04:46:55.730

我喜欢 Alexei 的`BigInteger`解决方案，但它确实需要至少 .NET 4.0。如果由于某种原因您不能使用它，那么另一种选择是使用`BitArray`自 .NET 1.1 起就可用的类。不幸的是，没有内置方法`BitArray`来解析二进制字符串，因此您必须手动执行此操作，类似于 Alexei 的解决方案。

另一种选择是我写的一个类`BoolArray`，它做很多与 相同的事情`BitArray`，但确实有一个解析二进制字符串的方法 - 使用静态`BoolArray.FromBinaryString`方法：

```
BoolArray bin = BoolArray.FromBinaryString("1001011000111010101");   // etc 
```

这是[BoolArray 源代码](http://pastebin.com/mrjND8Wv)。但是请注意，它还不是很完整，也没有经过全面测试，但我没有立即意识到任何错误。

**编辑**：粘贴原始链接后，我注意到代码使用了我的“Utils”库的不同类中提供的函数，并且不会直接编译。我已经更新了链接以在代码中提供此类......希望这是唯一的情况，但如果没有让我知道，我可以修复。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-31T01:19:37.830

您不能以您想要的方式对字符串进行按位运算。您可以通过对具有其他目标的字符串进行按位操作来做一些有趣的事情，比如改变它们的大小写，但我认为这就是您想要的：

```
// Convert the string to an integer

int foo = Convert.ToInt32(sr1, 2);
int bar = Convert.ToInt32(sr2, 2);

// Perform binary styff
int result = foo & bar;

// Convert back to a string, if you want
string resultStr = result.ToString(); 
```

# wordpress - WordPress 博客信息功能

> ID：14096411
> 
> 赞同：0
> 
> 时间：2012-12-31T01:09:41.890
> 
> 标签：wordpress

我只是想知道如果我们用静态数据替换 wordpress 安装中的所有 bloginfo 函数会提高多少性能 - 例如代替 bloginfo('template_url') 使用[http://blog.com/wp-content/themes/theme](http://blog.com/wp-content/themes/theme)，等等。

第二个问题是：有没有办法自动通过插件和主题目录中的所有文件，并将我们要替换的所有 bloginfo 函数替换为静态字符串？

感谢您的时间和最好的问候？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T04:47:41.940

对于您的第一个问题，Wordpress 总是在每次加载时执行一些基本查询，其中一个会读取 bloginfo 调用使用的数据。因此，在模板中使用 then 确实会增加函数调用的非常轻微的开销，但不会增加任何额外的查询开销。除非您每天提供数百万次点击，否则几乎可以忽略不计。

第二个问题：编写一个进行这种替换的脚本将非常简单。我真的不认为这是必要的或必要的，但是是的，它可以做到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:28:29.687

第一个问题。理论上..对性能会有一点提升..但很少..从Web开发来看.以后不方便.

第二个问题。据我所知。唯一的方法是通过 ftp 连接您的主机。然后在 localhost 中修改这些文件。然后在远程主机中更新这些文件。

如何自动修改本地主机中的文件。有一些工具你可以使用。就像这个网站介绍的一样。

25-text-batch-processing-tools-reviewed： [http ://www.smashingmagazine.com/2009/04/10/25-text-batch-processing-tools-reviewed/](http://www.smashingmagazine.com/2009/04/10/25-text-batch-processing-tools-reviewed/)

如果你擅长 windows 中的 bat 工具。你可以通过一个bat文件自己做。

# c# - 在 WPF 中刷新 ListBox 的简单方法？

> ID：14096414
> 
> 赞同：7
> 
> 时间：2012-12-31T01:09:48.363
> 
> 标签：c#, sql, wpf, listbox, refresh

我创建了一个简单的表单，用于插入/更新/删除 Northwind 客户的值。一切正常，除了为了看到结果，我必须关闭它，然后重新打开。我的表格如下所示：

![在此处输入图像描述](../Images/56e05efe591d5efec0d681ecd87ff9e4.png)

我已经搜索了数十篇关于如何刷新的文章`ListBox`，但所有这些都使用接口实现，或者使用 DataSets，以及我从未听说过也无法实现的东西。这是一个非常简单的项目，使用简单的程序。有没有一种无需添加多行代码即可轻松刷新客户列表的方法？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2017-02-23T21:21:02.390

简单的答案是：`myListBox.Items.Refresh();`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-31T02:01:28.473

您是否正在使用`ObservableCollection`并且您的模型是否实现`INotifyPropertyChanged`了这两件事，如果有任何更改，ListBox 会自动更新。无需显式刷新列表。

这是一个使用`ObservableCollection`and的小例子`INotifyPropertyChanged`，显然您将从`SQL`数据库中填充 ObservableCollection。

窗户：

```
public partial class MainWindow : Window,  INotifyPropertyChanged
{
    private ObservableCollection<MyModel> _list = new ObservableCollection<MyModel>();
    private MyModel _selectedModel;

    public MainWindow()
    {
        InitializeComponent();
        List.Add(new MyModel { Name = "James", CompanyName = "StackOverflow"});
        List.Add(new MyModel { Name = "Adam", CompanyName = "StackOverflow" });
        List.Add(new MyModel { Name = "Chris", CompanyName = "StackOverflow" });
        List.Add(new MyModel { Name = "Steve", CompanyName = "StackOverflow" });
        List.Add(new MyModel { Name = "Brent", CompanyName = "StackOverflow" });
    }

    public ObservableCollection<MyModel> List 
    {
        get { return _list; }
        set { _list = value; }
    }

    public MyModel SelectedModel
    {
        get { return _selectedModel; }
        set { _selectedModel = value; NotifyPropertyChanged("SelectedModel"); }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }
} 
```

Xaml

```
<Window x:Class="WpfApplication11.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525" Name="UI">
    <Grid>
        <ListBox ItemsSource="{Binding ElementName=UI, Path=List}" SelectedItem="{Binding ElementName=UI, Path=SelectedModel}" Margin="0,0,200,0" DisplayMemberPath="DisplayMember" SelectedIndex="0" />
        <StackPanel HorizontalAlignment="Left" Height="100" Margin="322,10,0,0" VerticalAlignment="Top" Width="185">
            <TextBlock Text="Name" />
            <TextBox Height="23" TextWrapping="Wrap" Text="{Binding ElementName=UI, Path=SelectedModel.Name, UpdateSourceTrigger=PropertyChanged}" />
            <TextBlock Text="Company Name" />
            <TextBox Height="23" TextWrapping="Wrap" Text="{Binding ElementName=UI, Path=SelectedModel.CompanyName, UpdateSourceTrigger=PropertyChanged}" />
        </StackPanel>
    </Grid>
</Window> 
```

模型

```
public class MyModel : INotifyPropertyChanged
{
    private string _name;
    private string _companyName;

    public string Name
    {
        get { return _name; }
        set { _name = value; NotifyPropertyChanged("Name"); }
    }

    public string CompanyName
    {
        get { return _companyName; }
        set { _companyName = value; NotifyPropertyChanged("CompanyName"); }
    }

    public string DisplayMember
    {
        get { return string.Format("{0} ({1})", Name, CompanyName); }

    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
            PropertyChanged(this, new PropertyChangedEventArgs("DisplayMember"));
        }
    }
} 
```

在这种情况下，对属性的任何编辑都会立即更新您的列表，也会在添加/删除新项目时更新。

![在此处输入图像描述](../Images/4da1421885abe6911fabf3cf5e4d5d90.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-31T01:15:40.817

调用 ListBox.UpdateLayout 怎么样？

当然，您还需要更新特定项目，以便它从 ToString 方法返回更新后的字符串。

**更新：**我认为您还需要在调用 ListBox.UpdateLayout 之前调用 ListBox.InvalidateArrange。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-07T10:02:01.217

使用**INotifyPropertyChanged**是最好的方法，刷新整个列表不是一个好主意。
主要入口：

```
public partial class MainWindow : Window
{
    private BindingList<FoodModel> foodList = new BindingList<FoodModel>();

    public MainWindow()
    {
        InitializeComponent();
    }

    private void Button1_Click(object sender, RoutedEventArgs e)
    {
        foodList.Add(new FoodModel { foodName = "apple1" });
        foodList.Add(new FoodModel { foodName = "apple2" });
        foodList.Add(new FoodModel { foodName = "apple3" });
        FoodListBox.ItemsSource = foodList;
    }

    private void Button2_Click(object sender, RoutedEventArgs e)
    {
        foodList[0].foodName = "orange";
    }

    private void RefreshButton_Click(object sender, RoutedEventArgs e)
    {
        FoodListBox.Items.Refresh();
    }
} 
```

模型：

```
public class FoodModel: INotifyPropertyChanged
{
    private string _foodName;

    public string foodName
    {
        get { return _foodName; }
        set
        {
            if (_foodName != value)
            {
                _foodName = value;
                PropertyChanged(this, new PropertyChangedEventArgs("foodName"));
            }
        }
    }
    public event PropertyChangedEventHandler PropertyChanged = delegate { };
} 
```

XAML：

```
 <ListBox HorizontalAlignment="Center" Name="FoodListBox" VerticalAlignment="Top" Width="194" Height="150">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding foodName}" />
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox> 
```

# ios - 向 NSMutableArray 添加对象时抛出 EXC_BAD_ACCESS

> ID：14096421
> 
> 赞同：1
> 
> 时间：2012-12-31T01:10:44.597
> 
> 标签：ios, nsmutablearray, exc-bad-access

尝试将对象添加到数组时出现 EXC_BAD_ACCESS 错误。我知道这可能意味着我指向内存中不存在的东西，或者对象包含 nil 值。

代码：

```
- (void)fadeInPlayer:(AVAudioPlayer *)player withMaxVolume:(float)maxVolume {

NSLog(@"player: %@", player);
NSLog(@"maxVolume: %f", maxVolume);

NSMutableArray *playerAndVolume = [NSMutableArray arrayWithObjects: player, maxVolume, nil];

if (player.volume <= maxVolume) {
    player.volume = player.volume + 0.1;
    NSLog(@"%@ Fading In", player);
    NSLog(@"Volume %f", player.volume);
    [self performSelector:@selector(fadeInPlayer:withMaxVolume:) withObject:playerAndVolume afterDelay:0.5];
    //playerAndVolume array used here because performSelector can only accept one argument with a delay and I am using two...
    }

} 
```

奇怪的是，当我打印要添加到控制台的对象时（如上面的 NSLogs 所示），它们返回数据：

```
player: <AVAudioPlayer: 0x913f030>
maxVolume: 0.900000 
```

该应用程序在 NSLogs 之后立即崩溃。其余代码在没有数组的情况下工作正常，但我需要使用它来调用方法上的 performselector:withObject:AfterDelay。

因此，我如何初始化数组或对象类型肯定有问题，但我无法弄清楚。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T01:17:41.050

您不能将 a 添加`float`到`NSArray`. 您必须将其包装在`NSNumber`.

*但*

真正的问题是传入的第一个参数是`NSArray`您创建的，传递给您的函数的第二个参数是`NSTimer`支持`performSelector:afterDelay:...`方法的。它不会分散数组中的对象，它只是将数组作为第一个参数传递。如果您坚持使用这种`API`设计，那么您需要测试第一个参数的类以查看它是 an`NSArray`还是 an `AVAudioPlayer`。你可以像这样实现这个函数：

```
-(void)fadeInPlayer:(AVAudioPlayer *)player withMaxVolume:(NSNumber *)maxVolume {
    if ([player isKindOfClass:[NSArray class]]){
        // This is a redundant self call, and the player and max volume are in the array.
        // So let's unpack them.
        NSArray *context = (NSArray *)player;
        player = [context objectAtIndex:0];
        maxVolume = [context objectAtIndex:1];
    } 

    NSLog(@"fading in player:%@ at volume:%f to volume:%f",player,player.volume,maxVolume.floatValue);

    if (maxVolume.floatValue == player.volume || maxVolume.floatValue > 1.0) return;

    float newVolume =  player.volume + 0.1;
    if (newVolume > 1.0) newVolume = 1.0;
    player.volume = newVolume;

    if (newVolume < maxVolume.floatValue){
        NSArray *playerAndVolume = [NSArray arrayWithObjects: player, maxVolume, nil];
        [self performSelector:@selector(fadeInPlayer:withMaxVolume:) withObject:playerAndVolume afterDelay:0.5];
    }
} 
```

您将使用它，将 包装在`float`中`NSNumber`，如下所示：

```
[self fadeInPlayer:player withMaxVolume:[NSNumber numberWithFloat:1.0]]; 
```

请注意，这将被认为是一个非常奇怪的函数，但此代码确实可以运行。

# ffmpeg - ffmpeg - avcodec_decode_video2 如何工作？

> ID：14096423
> 
> 赞同：1
> 
> 时间：2012-12-31T01:10:59.657
> 
> 标签：ffmpeg

我们知道，一个**AVPacket**包含一个**AVFrame**，我们可以使用

```
int avcodec_decode_audio4(AVCodecContext *avctx, AVFrame *frame,
                          int *got_frame_ptr, const AVPacket *avpkt) 
```

将数据包解码为帧，如果有效，`got_frame_ptr`将设置为非零，否则为零。

```
int len = avcodec_decode_video2(pCodecCtx, pFrame, &frameFinished, &packet);
if ( len < 0 )
{
    fprintf(stderr, "Problems decoding frame\n");
    return 1;
}

fprintf(stderr, "len = %d\n", len );

// Did we get a video frame?
if(frameFinished) {
    dosomething();
} 
```

它怎么会失败（`got_frame_ptr`为0）？是我们损坏的**AVPacket还是其他什么？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T03:27:30.840

有两个主要原因（除了错误）

1.  当前帧是未来的 P 帧，因此现在不能返回（显示）。这发生在序列中的 B 帧的情况下。

2.  当前数据包不是完整的可解码帧。

# haskell - 应用参数可以是 Ints 或 Doubles 的函数

> ID：14096424
> 
> 赞同：6
> 
> 时间：2012-12-31T01:11:01.357
> 
> 标签：haskell, types

我对 Haskell 很陌生，所以我希望这不是一个愚蠢的问题。我有这个数据类型：

```
data N = I Int | D Double deriving (Show, Eq) 
```

我正在尝试编写一个带有签名`(Num a) => (a -> a -> a) -> N -> N -> N`的函数，该函数将该函数应用于`N`s 中的数字并返回 N 和结果。如果`N`s 都是`D`s，它应该只应用函数并返回 a `D`; 如果一个是 an`I`另一个是 a `D`，它应该将`Int`in转换`I`为 a `Double`，将函数应用于两个`Double`s，并返回 a `D`；如果两者都是`I`s，它应该应用该函数并返回一个`I`. 这是我到目前为止的（损坏的）代码：

```
widen :: N -> N -> (N, N)
widen (I i) d@(D _) = (D (fromIntegral i), d)
widen d@(D _) i@(I _) = widen i d
widen x y = (x, y)

numOp :: (Num a) => (a -> a -> a) -> N -> N -> N
numOp op x y = case widen x y of (D x', D y') -> D $ x' `op` y'
                                 (I x', I y') -> I $ x' `op` y' 
```

不过，我在两行都收到错误`numOp`。第一个是：

```
Could not deduce (a ~ Double)
from the context (Num a)
  bound by the type signature for
             numOp :: Num a => (a -> a -> a) -> N -> N -> N
  at <line num>
In the second argument of `($)', namely x' `op` y'
In the expression: D $ x' `op` y'
In a case alternative: (D x', D y') -> D $ x' `op` y' 
```

第二个：

```
Couldn't match type `Double' with `Int'
Expected type: Int
  Actual type: a
In the second argument of `($), namely x' `op` y'
In the expression: I $ x' `op` y'
In a case alternative: (I x', I y') -> I $ x' `op` y' 
```

我很确定我理解这两个错误的含义；我认为第一个是说我的类型签名中的信息不足以让 GHC 假设`op`返回 a `Double`，这是`D`值构造函数所必需的，第二个是说由于第一行暗示`a`是`Double`，所以line 不能使用 type 的值，`a`就好像它是一个`Int`. 不过，我不知道从哪里开始寻找正确的方法。

如果它有帮助，我试图让它工作的原因是我正在跟随[Write Yourself a Scheme 教程](http://en.wikibooks.org/wiki/Write_Yourself_a_Scheme_in_48_Hours)；本教程中的所有示例（特别是在[评估部分](http://en.wikibooks.org/wiki/Write_Yourself_a_Scheme_in_48_Hours/Evaluation,_Part_1)中）仅处理整数，但作为练习，我想添加支持整数和浮点数的能力，以便例如`(+ 1 2.5 2.5)`返回`6.0`和`(+ 1 2 3)`返回`6`。如果我认为这是错误的方式或者有更简单的方法来完成它，我很想听听建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T01:29:13.020

签名

```
numOp :: (Num a) => (a -> a -> a) -> N -> N -> N 
```

表示对于and 两个s的每个特定实例都`numOp`采用任何类型的*单态*函数，并从中计算出一个. 例如，一个类型的函数`a -> a -> a``Num``N``N`

```
Complex Float -> Complex Float -> Complex Float 
```

或者

```
approxRational :: RealFrac a => a -> a -> Rational 
```

（专门用于`a = Rational`）将是合法的第一个参数。

您需要的是一个多态函数，可以将所有`Num`实例作为第一个参数处理，即 rank 2 类型

```
numOp :: (forall a. Num a => a -> a -> a) -> N -> N -> N 
```

（你需要`RankNTypes`语言扩展）。

# mysql - 如何在一定时间后删除 MySQL 记录

> ID：14096429
> 
> 赞同：20
> 
> 时间：2012-12-31T01:12:06.640
> 
> 标签：mysql

我想在 7 天后从我的 MySQL 数据库中删除一些消息。

我的消息表行具有以下格式：id | 留言 | 日期

日期是正常格式的时间戳；2012-12-29 17:14:53

我在想一个 MySQL 事件将是要走的路，而不是一个 cron 工作。

我想对于有经验的 SQL 人员来说这是一个简单的问题，我如何在下面的括号中对删除消息部分进行编码？

一个例子将不胜感激，谢谢。

```
 DELIMITER $$
   CREATE EVENT delete_event
   ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 1 DAY
   ON COMPLETION PRESERVE
  DO
    BEGIN
      DELETE messages WHERE date >= (the current date - 7 days);
    END;
$$; 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-31T01:24:22.307

您可以尝试使用此条件：

```
WHERE date < DATE_SUB(NOW(), INTERVAL 7 DAY) 
```

使整个 SQL 脚本看起来像这样：

```
CREATE EVENT delete_event
ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 1 DAY
ON COMPLETION PRESERVE

DO BEGIN
      DELETE messages WHERE date < DATE_SUB(NOW(), INTERVAL 7 DAY);
END; 
```

但是，在您的位置上，我将使用简单的 cron 脚本解决给定的问题。这样做的原因很简单：更容易维护代码，没有丑陋的 SQL 变通方法，与您的系统顺利集成。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-31T01:21:08.260

这应该可以解决问题。

```
DELETE FROM messages WHERE date < (CURDATE() - INTERVAL 7 DAY); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-15T14:29:55.140

对于那些在共享主机上的人，比如 1and1，并且不能创建事件，另一种方法是使用[webcron](http://webcron.org)

你只需要告诉 webcron 你想运行的 php 脚本的 url，他们会在你想要的时间间隔为你触发它

# xaml - 用于可见性问题的 Windows RT XAML 切换开关

> ID：14096430
> 
> 赞同：1
> 
> 时间：2012-12-31T01:12:23.997
> 
> 标签：xaml, winrt-xaml

我从 Visual Studio 中的一个空白 Windows RT 应用程序开始。我已经实现了 BooleanToVisibility 转换器：http: [//blogs.u2u.be/diederik/post/2011/11/14/null.aspx](http://blogs.u2u.be/diederik/post/2011/11/14/null.aspx)

我的 App.xaml 中有这个：

```
<Pathfinder:BooleanToVisibilityConverter x:Key="VisibleToInvisibleConverter" />
<Pathfinder:BooleanToVisibilityConverter x:Key="InvisibleToVisibleConverter" IsReversed="True" /> 
```

我添加了一个切换开关和一个文本框，我试图切换可见性以进行概念验证。这是拨动开关：

```
<ToggleSwitch IsOn="{Binding IsEditing, Mode=TwoWay}"
              Margin="10"
              HorizontalAlignment="Left"
              VerticalAlignment="Top"
              OffContent=""
              OnContent=""
              BorderThickness="0"
              Width="80"
              /> 
```

这是文本框：

```
<TextBlock x:Name="pageTitle" Grid.Column="1" Text="{StaticResource AppName}"
 Style="{StaticResource PageHeaderTextStyle}" 
Visibility="{Binding IsEditing, Converter={StaticResource InvisibleToVisibleConverter}}"/> 
```

我试图做到这一点，所以当开关关闭时，文本框是可见的，而当开关打开时，文本框是不可见的。我注意到，当我将文本框上的转换器设置为“BooleanToVisibilityConverter”或“VisibleToInvisibleConverter”时，它确实消失了（使用“InvisibleToVisibleConverter”可见）。我已将开关上的 IsOn 变量绑定到 IsEditing，因此它应该关闭/打开该变量，然后关闭/打开可见性。

这是我的通知程序类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Windows.UI.Xaml.Data;
using System.ComponentModel;

namespace Pathfinder
{
    class Notifier
    {
        private bool isEditing;
        public event PropertyChangedEventHandler PropertyChanged;
        public bool IsEditing
        {
            get { return isEditing; }
            set
            {
                isEditing = value;
                if (PropertyChanged != null)
                    PropertyChanged(this, new PropertyChangedEventArgs("IsEditing"));
            }
        }
    }
} 
```

我在 MainPage.Xaml.CS 中创建它的一个实例：

```
public MainPage()
{
    this.InitializeComponent();
    this.DataContext = new Notifier();

} 
```

有人对设置此切换可能会忽略什么有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:46:35.877

我终于明白了。我在某个时候已经放弃了 Notifier 类上 INotifyPropertyChanged 的​​继承，看起来我没有两分钟就拥有了我需要的一切。

以上仅通过更改单行来工作：

```
 class Notifier 
```

至：

```
 class Notifier : INotifyPropertyChanged 
```

# php - 检查管理员是否登录

> ID：14096431
> 
> 赞同：0
> 
> 时间：2012-12-31T01:12:40.657
> 
> 标签：php, codeigniter

如果有人登录，这段代码会检查会话，我可以成功查看页面，但现在我想检查用户是否是管理员。我尝试通过以下方式检查模型，这是我尝试过的，但它不起作用。

检查会话以及是否为管理员的方法

```
public function index()
{
    $this->load->library('authlib');
    $loggedin = $this->authlib->is_loggedin();
    ///$admin = $this->auth->admin();

    if ($loggedin === false) {
    $this->load->helper('url');
    redirect('/auth/login');
    }
    if ($this->auth->admin() === false) {
    $message ['msg'] = "You are not an admin!";
    $this->load->view('homeview', $message);
    }
    else
    {
    $this->load->view('add_view');
    }
} 
```

认证控制器

```
public function authenticate()
{
$username = $this->input->post('uname');
$password = $this->input->post('pword');
$user = $this->authlib->login($username,$password);
**>> $this->admin($username,$password); << passes the posted in values**
if ($user !== false) {
    $this->load->view('homeview',array('name' => $user['name']));

}
else {
    $data['errmsg'] = 'Unable to login - please try again';
    $this->load->view('login_view',$data);
}   
}

public function admin($username,$password){
//$this->load-model('usermodel');
$admin = $this->authlib->adminlib($username,$password);
if ($admin == false){
return false;
//if ($res->num_rows() != 1){
//return false;
}
} 
```

库 authlib

```
public function adminlib($user,$pwd) 
{
return $this->ci->usermodel->chkadmn($user,$pwd);
} 
```

该模型

```
function chkadmn($username,$password)
{
$this->db-where(array('username' => $username,'password' => sha1($password)));
$res = $this->db->get('users',array('type'));
if ($res->num_rows() != 1) {
return false;
}
} 
```

做了一些更改，现在我得到“在第 54 行调用 C:\xampp\htdocs\ecwm604\application\models\usermodel.php 中的未定义函数 where()”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:33:21.330

就个人而言，我将替换您的所有 if 语句，并按如下所示对其进行测试：

```
 public function index()
    {
        $this->load->library('authlib');
        $loggedin = $this->authlib->is_loggedin();
        ///$admin = $this->auth->admin();

        if (!$loggedin) {
        $this->load->helper('url');
        redirect('/auth/login');
        }

        if (!$this->auth->admin()) {
        $message ['msg'] = "You are not an admin!";
        $this->load->view('homeview', $message);
        }
        else
        {
        $this->load->view('add_view');
        }

    }

    public function admin(){
    $this->load-model('usermodel');
    $admin = $this->usermodel->chkadmn($username,$password);
    if (!$admin){
    return false;
    //if ($res->num_rows() !== 1){
    //return false;
    }
    }

    function chkadmn($username,$password)
    {
    $this->db-where(array('username' => $username,'password' => sha1($password)));
    $res = $this->db->get('users',array('type'));
    if ($res->num_rows() !== 1) {
    return false;
    }
    } 
```

# jquery - Django jQuery AJAX 自我替换脚本

> ID：14096432
> 
> 赞同：1
> 
> 时间：2012-12-31T01:12:52.170
> 
> 标签：jquery, django

我在实现自我替换脚本时遇到了麻烦。我承认我非常困惑。

我正在尝试实现两个按钮，这样如果您单击一个按钮，则会将 POST 请求发送到服务器；服务器验证您确实访问了该网页并将 HttpResponseRedirect 发送回包含不完整网页的页面/单击按钮后仅包含我想要更新的部分的页面。一旦我的原始 jQuery 请求收到该新页面，它将用刚刚收到的新页面替换当前页面上的元素。

我的 jQuery 看起来像：

```
<script id="self_replacing">
$(document).ready(function() {  
  $('#button1').click(function(){
    $.post("/", { 
      unique_id : "{{ unique_id }}",
      csrfmiddlewaretoken: '{{ csrf_token }}'
    },
    function(data){
       var js_portion = $('<div/>').html(data).find('self_replacing')
       var html_portion = $('<div/>').html(data).find('pic_content')
       $('#pic_content').replaceWith(html_portion)
       $('#self_replacing').replaceWith(js_portion)
    });
  });
});
</script> 
```

不完整的页面：

```
<script id="self_replacing">
$(document).ready(function() {  
  $('#button1').click(function(){
    $.post("/", { 
      unique_id : "{{ unique_id }}",
      csrfmiddlewaretoken: '{{ csrf_token }}'
    },
    function(data){
       var js_portion = $('<div/>').html(data).find('self_replacing')
       var html_portion = $('<div/>').html(data).find('pic_content')
       $('#pic_content').replaceWith(html_portion)
       $('#self_replacing').replaceWith(js_portion)
    });
  });
});
</script>
<div id="pic_content">
      .
      .

</div> 
```

我有正确的想法吗？当我通过 FireBug 控制台查看我的请求时，每次单击按钮时流量都会开始向上扩展。

例如，在开始时，1 点击 = 1 POST，然后 1 点击 = 2POST，然后 1 点击 = 3 POST。我不太确定为什么会这样。我的 jQuery 脚本有问题吗？

注意：jQuery 脚本也需要在每次 POST 后更新。

# javascript - 使用动态命名分配动态创建的 Jquery 选项卡

> ID：14096433
> 
> 赞同：0
> 
> 时间：2012-12-31T01:12:54.820
> 
> 标签：javascript, jquery, jquery-ui, tabs

我正在使用 jquery ui 选项卡动态创建动态选项卡，该选项卡将在没有任何内容的情况下开始。据我所知，我的代码正在构建所有内容并将其放在适当的位置，但 jquery 没有将它们识别为选项卡。我如何让它识别页面加载后创建的新标签？

html代码：

```
 <div class="main">
    <div>
        <button id="new">button</button>
    </div>
    <div id="tabs">
        <ul>
            <li><a href="#tabs-1">View1</a></li>
            <li><a href="#tabs-2">View2</a></li>
            <li id="createView"><a href="null">Create New</a></li>
        </ul>
        <div id="tabs-1">
            <p>something on this page</p>   
        </div>
        <div id="tabs-2">
            <div>
                <p>something else on this page</p>
            </div>
        </div>
    </div>
</div>​​​​​​​​ 
```

Javascript：

```
//Tabs functionality
    $('#tabs').tabs();

    //Create new view

    var tabNum = 3;

    $('#new').click(function() {

        $('#tabs ul').append('<li>' + '<a href="' + '#tabs-' + tabNum + '">' + 'newitem' + '</a>' + '</li>');
        $('#tabs').append('<div id="' + 'tabs-' + tabNum + '">' + '<div>new</div>' + '</div>');
        var NewViewNum = 'tabs-' + tabNum;
        $(NewViewNum).focus();

        tabNum++;

    });​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T01:21:07.253

jQuery UI 选项卡有一个`refresh`您可以[按照文档](http://api.jqueryui.com/tabs/#method-refresh)使用的方法。

尝试调用：

```
$("#tabs").tabs("refresh"); 
```

# ruby-on-rails - Rails 超级用户资源上下文

> ID：14096436
> 
> 赞同：0
> 
> 时间：2012-12-31T01:14:14.897
> 
> 标签：ruby-on-rails, devise, cancan

我正在开发的应用程序围绕属于组织的用户展开，并且只能访问这些组织中的资源。这很好，而且非常简单。

该系统还拥有任何组织之外的用户，他们能够查看系统内的任何内容。当其中一个用户登录时，他们会得到一份他们想要查看的组织列表。选择一个应该会给他们一个系统视图，就像他们作为标准用户登录一样，但保留他们的超级用户权限。

有没有一种好方法可以让系统知道已选择特定组织，而不必为每条路径都有嵌套资源？

因此，例如，我想以超级用户身份登录，并查看 organizationA。我希望能够选择组织，然后简单地去

```
/subjects 
```

而不必去

```
/organisations/1/subjects 
```

有什么好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:18:47.307

如果您不通过 url 传递上下文，则可以将所选组织存储在会话中。会话方法的问题在于，您无法直接链接到这些页面，因为您依赖于会话中存储的数据。

# ember.js - 在 Ember.js 中渲染嵌套对象

> ID：14096441
> 
> 赞同：3
> 
> 时间：2012-12-31T01:14:46.893
> 
> 标签：ember.js, ember-data

Ember 新手，我无法弄清楚如何通过关联的 ember 数据模型或简单地作为 json 对象呈现嵌套选项。

JSON 看起来像这样：

```
 contact: {
        first_name,
        last_name,
        emails: [{email1...}, {email2...}]
 } 
```

寻找最简单的解决方案，我在车把模板中尝试了这个：

```
{{#each emails}}
     ...
{{/each}} 
```

尝试更高级的解决方案，最终将需要它，我创建了以下 ember-data 模型：

```
App.Contact = DS.Model.extend({
  first_name: DS.attr('string'),
  last_name: DS.attr('string'),
  company: DS.attr('string'),
  emails: DS.hasMany('Rainmaker.Email')
});

App.Email = DS.Model.extend({
  contact_id: DS.attr('number'),
  email_address: DS.attr('string'),
  emails: DS.belongsTo('Rainmaker.Contact')
}); 
```

这似乎有点工作（App.Email:ember517 在屏幕上呈现）但它看起来仍在尝试 ping 服务器以获取电子邮件地址，并且我已经将它们延迟加载。

我不知道下一步该去哪里，非常感谢我忽略的任何指导或文档链接。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:21:22.507

12 月 28 日，Ember 团队包含了对嵌入式记录的支持。如果您查看页面大约 1/3 处的[https://github.com/emberjs/data ，它会为您提供一些指导。](https://github.com/emberjs/data)

在您的情况下，只需根据文档更改`emails: DS.hasMany('Rainmaker.Email')`为即可。`emails: DS.hasMany('Rainmaker.Email',{embedded:true})`

# html - 离线网站的 HTML5 localStorage

> ID：14096444
> 
> 赞同：3
> 
> 时间：2012-12-31T01:15:15.157
> 
> 标签：html, local-storage, offline

我正在创建一个简单的应用程序，用户将其下载到他/她的计算机上，然后使用硬盘驱动器上的浏览器打开它。我需要它能够使用任何标准浏览器来存储数据。（尽管数据不必在浏览器之间访问）。

[如此链接](http://www.linuxforu.com/2012/04/html5-localstorage-offline-web-applications/)所述，如果使用 HTML5 的本地存储，如果站点的 url 类似于`file:///C:/Web/mylocaltodo.html`. 它说它可以通过使用'localhost'来完成，但它提供的示例应用程序并没有说明如何做到这一点。

是否可以在用户在本地主机上安装 Web 服务器的情况下为离线站点本地保存数据？它是否适用于任何现代浏览器，包括 Internet Explorer？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-02T16:03:52.727

尽管问题仍然很老，但在创建应在多个窗口之间同步的应用程序时，我遇到了类似的问题。

所以我只想和其他开发者分享我的经验，这样可以避免长时间寻找问题。

事实上，由于[同源策略](https://developer.mozilla.org/en-US/docs/Same-origin_policy_for_file%3a_URIs)（通过 本地文件访问`XMLHttpRequest`），访问被拒绝读取`localStorage`，因此更改不会在窗口之间同步。

简而言之：如果您使用`file:///`as URL，它将无法同步 localStorage。使用一个简单的网络服务器和`http://localhost/`作为 URL，它会。

奇怪的行为，遗憾的是，javascript 控制台中没有错误消息。在离线尝试一些实验时请记住这一点`localStorage`，不要疯狂地在代码中搜索问题；-)

# c++ - 将 C 数组文字转换为在 C++ 构造函数中工作？

> ID：14096446
> 
> 赞同：0
> 
> 时间：2012-12-31T01:15:23.317
> 
> 标签：c++, c

我有一些 C 代码，我正在尝试将它们转换/包装成 C++ 类。我遇到了一些 C 文字数组（如果我叫错了，请纠正我），我不确定如何在 C++ 构造函数中初始化它们，因为我认为你不能做文字，我认为这是编译时特定的, 到特定于运行时的东西。

我是否应该明确地将数组定义为特定大小，然后对构造函数中的数组执行 strcpy 或类似的文字处理？

```
char sysUpTime[] = {1,3,6,1,2,1,1,3,0}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T01:44:51.683

作为初始化列表或字符串操作的替代方案，您可以使用类似以下的内容（如果您真的想要）：

```
struct Wrapper
{
    template <size_t N>
    Wrapper(const char(&arr)[N]) : vec(arr, arr+N) { }

    vector<char> vec;
}; 
```

由于我的长期懒惰，我已经公开了所有内容:)。然后你可以像这样初始化：

```
 char foo[] = { 1, 2, 3, 4, 5 };
    Wrapper bar(foo);

    copy(bar.vec.begin(), bar.vec.end(), ostream_iterator<int>(cout, ", ")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T01:20:19.193

可以只使用 std::string 来存储 OID 然后初始化它，`member initializer list`例如：

```
#include <string>
class Wrapper
{
public:
  Wrapper() : sysUpTime("1.3.6.1.2.1.1.3.0") { }
private:
  std::string sysUpTime;
}; 
```

或者使用 C++11 [std::array](http://en.cppreference.com/w/cpp/container/array)

```
class Wrapper
{
public:
  Wrapper() : sysUpTime{{1,3,6,1,2,1,1,3,0}} { }

public:
  std::array<char, 10> sysUpTime;
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T01:47:19.127

将不同大小的 c 样式数组传递给构造函数时的主要问题是您必须同时传递大小。这是将数组放入成员向量的示例：

```
#include <vector>
#include <iostream>

struct Test
{
  std::vector<char> sysUpTime;

  Test(const char sysUpTime[], size_t size) :
    sysUpTime(sysUpTime, sysUpTime + size)
  { }
};

int main()
{
  const char sysUpTime[] = {1,2,3,4,5};

  Test test(sysUpTime, sizeof(sysUpTime) / sizeof(char));
} 
```

不幸的是，除了使用模板之外，我知道不使用动态数组（向量）就无法做到这一点，这意味着您将为数组大小的每一次变化都实例化一个单独的类。

# ruby-on-rails - 是否可以在使用 peperclip 上传图像时将字符放在图像上？

> ID：14096454
> 
> 赞同：0
> 
> 时间：2012-12-31T01:17:53.087
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip

我正在使用名为**回形针**
的 gem 现在用户可以使用其功能上传图像。
当它被保存到公共目录时，是否可以将网站的网址放在上传的这张图片上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T06:58:44.073

它可以在 ImageMagick 的帮助下完成

1.  这个[railscasts 视频](http://railscasts.com/episodes/374-image-manipulation)展示了如何使用 ImageMagick。

2.  之后，您可以查看[此文档](http://www.imagemagick.org/Usage/annotating/)以了解如何使用文本值注释图像。

使用 ImageMagick 的注释示例

```
 convert dragon.gif   -background Khaki  label:'Faerie Dragon' \
          -gravity Center -append    anno_label.jpg 
```

![在此处输入图像描述](../Images/679b06db4af40890d349dde27db8476c.png)

# javascript - 如何在 JavaScript 中创建字符串的有向图？

> ID：14096455
> 
> 赞同：1
> 
> 时间：2012-12-31T01:18:01.517
> 
> 标签：javascript

我正在尝试在 JavaScript 中创建有向图数据结构。我希望图中的每个节点都是双向链接的，这样我就可以获得每个节点指向的链接列表，以及指向该节点的链接。每个节点都是一个包含 3 个元素的数组，如下所示：`[["node that links to node a"], "node a", ["node that node a links to"]]`

```
//The functions linkNodes and unlinkNodes should add and remove nodes links from the directed graph, respectively.
var nodes = new Object();

function linkNodes(a, b){
    //a should be a string, and b should be a string as well
    //create the node a, if it doesn't exist yet
    //create the node b, if it doesn't exist yet
    //link the node a to the node b
}

function unlinkNodes(){
    //unlink the nodes a and b, if a and b exist
    //create the node a, if it doesn't exist yet
}

function getNode(string){
    //get the node that corresponds to the string
    //if the string doesn't exist, then return false
} 
```

jsfiddle： http: [//jsfiddle.net/NTKZ9/1/](http://jsfiddle.net/NTKZ9/1/) ​</p>

除了我在这里提出的方法之外，还有一种更简洁的方法可以在 JavaScript 中实现有向图吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:02:47.133

一种简洁的方法是将[邻接矩阵](http://en.wikipedia.org/wiki/Adjacency_matrix)存储在二维数组中。

# vbscript - 禁用消息框上的 X 按钮

> ID：14096458
> 
> 赞同：1
> 
> 时间：2012-12-31T01:18:27.080
> 
> 标签：vbscript

我正在开发一个 VBScript 程序，但我不知道如何禁用消息框上的 X 按钮。你能帮我么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T02:01:51.867

简短的回答：你基本上不能。然而...

如果您使用 VbOkOnly 选项或 Popup 函数代替 MsgBox，当用户单击 X 时，这应该被解释为单击 OK。脚本的执行将继续。

[点击这里获取更多信息..](http://www.visualbasicscript.com/Disable-the-39X39-button-on-MsgBox-m74120.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-30T22:27:56.303

正如@Daniel Cook 所说，您可以将 HTA 作为您的消息框。（尽管我有一段时间没有使用 HTA）。

# ruby-on-rails-3 - 让用户在 Rails 中创建自己的模型

> ID：14096462
> 
> 赞同：0
> 
> 时间：2012-12-31T01:18:49.353
> 
> 标签：ruby-on-rails-3, database-design

在我的 Rails 项目中，我有两个相似的模型`SafetyTest`和`TeamDue`. 它们的字段完全相同，只是名称不同。每个实例`belongs_to`一个`Student`.

我想添加创建遵循上述两个结构的*新模型的能力。*所以也许我想添加`MedicalForm`. 作为开发人员，我不想通过 CLI 执行此操作，而是在视图中提供一个界面，以便管理员可以添加自己的界面。

假设`SafetyTest`,`TeamDue`和`MedicalForm`都可以用名字来描述`SeasonalRequirement`。实现我的想法的最佳和最可维护的方式是什么？

我在 Rails 方面没有经验，但我的想法是将上述模型合并到一个名为 的综合模型中，并为每种类型`SeasonalRequirement`添加一列。`type`问题在于：用户如何创建一种新的季节性需求（例如`MedicalForm`）？当我尝试为每个部分显示单独的部分时，我什至如何确定存在哪些类型的季节性要求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:33:03.500

我会为此考虑多态或 STI 关系。

在以下位置查看更多详细信息：[http ://code.alexreisner.com/articles/single-table-inheritance-in-rails.html](http://code.alexreisner.com/articles/single-table-inheritance-in-rails.html)

我会使用 STI 对此进行建模。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:25:42.420

没有太多使用 RoR，但是让用户更改数据库的结构似乎是个坏主意。

可能的工作是这样的：

```
additional_student_columns
--------------------------
id
name 
```

并添加另一个表：

```
additional_student_values
--------------------------
student_id
column_id
value (string) 
```

这样做的缺点是它只能使用字符串值

# python - 如何更改或删除 Tkinter 的 OptionMenu 小部件的子菜单边框？

> ID：14096468
> 
> 赞同：3
> 
> 时间：2012-12-31T01:20:03.877
> 
> 标签：python, tkinter, submenu, optionmenu

当我更改选项菜单和子菜单背景和前景色时，我试图摆脱出现的粗边框。

我确实设法通过使用以下方法摆脱或修改父选项菜单边框：

optmenu.configure(hilightthickness=0)

这里有一个参考改变子菜单的背景颜色：

[如何更改 Tkinter 的 OptionMenu 小部件的菜单背景颜色？](https://stackoverflow.com/questions/6178153/how-to-change-menu-background-color-of-tkinters-optionmenu-widget)

..但我似乎无法找到删除子菜单上显示的外边框的方法。试过 hilighthickness=0 但这不好。

我正在使用 Windows 7 和 Python 2.7。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-03T07:13:06.123

应该有一个 bd 选项，只需执行以下操作：

```
bd=0 
```

只需在为它定义所有选项时添加它。

# asp.net - ASP.NET 大数据分页推荐策略，可选排序

> ID：14096469
> 
> 赞同：1
> 
> 时间：2012-12-31T01:20:07.693
> 
> 标签：asp.net, ado.net, paging

我目前正在做的项目需要从大量数据中检索/搜索，流程如下：-

1.  输入关键字并从大约 500,000 名成员中搜索
2.  仅检索前 6 个成员。
3.  允许根据成员国或性别进行排序。要求：使用EF5.0

数据当前使用 UserControl 显示，DataBinded 使用 Repeater，将通过带有下一个、上一个按钮等的 UpdatePanel 进行更新。最好但不限于使用 EF5.0，我对其他选项开放（例如 SqlDataReader）并手动将其转换回成员对象。

我当前的解决方案通过使用页码调用带有跳过的实体，即

members = context.Members.Where(这里的条件).Skip(页码* size).Take(size);

我的问题是：我的策略是工业/通用的方法吗？有类似经验的朋友可以和我分享一下性能/优化方面，有没有其他更好的方法呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:16:44.913

我使用存储过程而不是 LINQ 查询获得了非常好的性能。由于查询元数据生成/sql 翻译，这可以节省性能。如果您要返回大型结果集，禁用更改跟踪也是一个不错的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T10:45:46.797

我正在使用使用 ROWCOUNT 的数据库分页，请在此处查看[http://www.4guysfromrolla.com/webtech/042606-1.shtml](http://www.4guysfromrolla.com/webtech/042606-1.shtml)，它提供了非常好的性能，包括排序和分页在内的 200000 条记录。

# javascript - Javascript（比较对象的功能）

> ID：14096472
> 
> 赞同：-1
> 
> 时间：2012-12-31T01:20:46.810
> 
> 标签：javascript, function, object

我正在尝试创建一个函数，它将一个音乐专辑与另一个专辑进行比较，但我的代码没有运行。我想知道为什么，因为我真的看不出问题出在哪里以及为什么会出现问题。非常感谢。

```
/********* GLOBAL VARIABLES *********/
var BR = "<br />";
var ES = " ";
/********* FUNCTIONS *********/

function compare(album[0], album[1]) {
    var sameAlbums = false;

    //There has to be an easier way to do all this...
    if (album[0].artistName === album[1].artistName && album[0].albumTitle === album[1].albumTitle && album[0].releaseYear === album[1].releaseYear && album[0].ifHQ === album[1].ifHQ && album[0].tracks[0] === album[1].tracks[0] && album[0].tracks[1] === album[1].tracks[1] && album[0].tracks[2] === album[1].tracks[2] && album[0].tracks[3] === album[1].tracks[3] && album[0].tracks[4] === album[1].tracks[4] && album[0].tracks[5] === album[1].tracks[5] && album[0].tracks[6] === album[1].tracks[6] && album[0].tracks[7] === album[1].tracks[7] && album[0].tracks[8] === album[1].tracks[8] && album[0].tracks[9] === album[1].tracks[9] && album[0].tracks[10] === album[1].tracks[10])

    {
        sameAlbums = true;
    }
    return sameAlbums;
}

/********* MAIN *********/

function main() {

    var alb = new album(2);

    for (var i = 0; i < album.length; i++) {
        album[i] = {
            artistName: "",
            albumTitle: "",
            releaseYear: 0,
            ifHQ: "",
            tracks: undefined //tracks here
        };
        album[i].artistName = prompt("What is the artist's name?");
        album[i].albumTitle = prompt("What is the album title?");
        album[i].releaseYear = parseFloat(prompt("What is the album's release year"));
        album[i].ifHQ = prompt("Is the album high quality? Y/N");

        while (!(album[i].ifHQ === "Y" || album[i].ifHQ === "N" || album[i].ifHQ === "YES" || album[i].ifHQ === "NO")) {
            album[i].ifHQ = prompt("You have entered an invalid response. Is " + album[i].title + " a ifHQ album, Y/N?");
            album[i].ifHQ = album[i].ifHQ.toUpperCase();
        }

        if (album[i].ifHQ === "Y") {
            album[i].ifHQ = true;
        }
        else {
            album[i].ifHQ = false;
        }
        album[i].tracks = new albumay(10);

        for (var j = 0 + 1; j < album[i].tracks.length; j++) {
            album[i].tracks[j] = prompt("Enter track" + (j + 1));

        }
    }
    for (var key in album[0]) {
        document.write(key + ": " + album[0][key] + " ");
        document.write(BR);
    }
    for (var key in album[1]) {
        document.write(key + ": " + album[1][key] + " ");
        document.write(BR);
    }

}

var same = compare(album[0], album[1]);
document.write(same);

// This line calls main, don't change it:
main(); 
```

编辑代码：

```
<script type="text/javascript">
            /********* GLOBAL VARIABLES *********/
            var BR = "<br />";
            var ES = " ";
            var album = [];

            /********* FUNCTIONS *********/
            function compare(album1, album2)
            {
                for (var i in album1)
                {
                    if (album1[i] !== album2[i]) return false;
                }
                return true;
            }

            /********* MAIN *********/
            function main()
            {

                var album = [];
                var numAlbums = 3;

                for (var i = 0; i < numAlbums; i++) {

                    album[i] = {
                        artistName: "",
                        albumTitle: "",
                        releaseYear: 0,
                        ifHQ: "",
                        tracks: undefined //tracks here
                    };
                    album[i].artistName = prompt("What is the artist's name?");
                    album[i].albumTitle = prompt("What is the album title?");
                    album[i].releaseYear = parseFloat(prompt("What is the album's release year"));
                    album[i].ifHQ = prompt("Is the album high quality? Y/N");

                    while (!(album[i].ifHQ === "Y" || album[i].ifHQ === "N" || album[i].ifHQ === "YES" || album[i].ifHQ === "NO"))
                    {
                        album[i].ifHQ = prompt("You have entered an invalid response. Is " + album[i].title + " a ifHQ album, Y/N?");
                        album[i].ifHQ = album[i].ifHQ.toUpperCase();
                    }

                    if (album[i].ifHQ === "Y")
                    {
                        album[i].ifHQ = true;
                    }
                    else
                    {
                        album[i].ifHQ = false;
                    }
                    album[i].tracks = new album(10);

                    for (var j = 0 + 1; j < album[i].tracks.length; j++)
                    {
                        album[i].tracks[j] = prompt("Enter track" + (j + 1));

                    }
                }
                for (var key in album[1])
                {
                    document.write(key + ": " + album[1][key] + " ");
                    document.write(BR);
                }
                for (var key in album[2])
                {
                    document.write(key + ": " + album[2][key] + " ");
                    document.write(BR);
                }
            }

            var same = compare(album1, album2);
            document.write(same);

            // This line calls main, don't change it:
            main();
        </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:30:28.477

如果您在代码上运行调试器，您会发现问题出在`compare`函数中。特别是，参数名称不能包含方括号。

我建议更改您的比较功能：

```
function compare (album1, album2) {
    for (var i in album1) {
        if (album1[i] !== album2[i]) return false;
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:50:07.910

## 根据您的更新

好的，这段代码仍然存在很多问题。

首先也是最重要的，在比较之前没有定义专辑 1 和专辑 2，原因有两个。

1.  Main() 直到它们运行后才会执行，因此尚未定义专辑 []
2.  专辑 [1] 与专辑 1 不同

## 还有一些需要考虑的事情：

1.  数组索引在 javascript 中从 0 开始。跳过第一个索引以使您的数组从 1 开始被认为是不好的做法。
2.  而不是您现在正在执行的 24 个提示，您可能应该考虑输入表单。连续 24 个提示对用户来说非常烦人。
3.  您可能需要一个用于 HQ 验证的模式窗口。像[这样的东西](https://stackoverflow.com/questions/11478441/modal-window-instead-alert)

## 清理代码的尝试

我认为您可能应该重新考虑这里的一些选择，但这是至少运行的代码的清理版本：

[jsfiddle](http://jsfiddle.net/qjST6/)

```
<script type="text/javascript">

    /********* FUNCTIONS *********/
    function compare(album1, album2)
    {
        for (var i in album1)
        {
            if (album1[i] !== album2[i]) return false;
        }
        return true;
    }

    /********* MAIN *********/
    function main()
    {

        var album = [];
        var numAlbums = 2;

        for (var i = 0; i < numAlbums; i++) {

            album[i] = {};
            album[i].artistName = prompt("What is the artist's name?");
            album[i].albumTitle = prompt("What is the album title?");
            album[i].releaseYear = parseFloat(prompt("What is the album's release year"));
            var hq = prompt("Is the album high quality? Y/N")
            if(!hq)
            {
                hq = "";
            }

            while (true)
            {
                hq = hq.toUpperCase();
                if( hq==="Y" || hq === "YES" )
                {
                    album[i].ifHQ = true;
                    break;
                }
                else if( hq ==="N" || hq === "NO" )
                {
                    album[i].ifHQ = false;
                    break;
                }
                else
                {
                hq = prompt(
                    "You have entered an invalid response. Is " + 
                    album[i].title + " a ifHQ album, Y/N?");
                }
            }
            album[i].tracks = [];

            for (var j = 0; j < 10; j++)
            {
                album[i].tracks[j] = prompt("Enter track" + (j + 1));
            }
        }

        var same = compare(album[0], album[1]);
        document.write(same);
    }
    // This line calls main, don't change it:
    main();
</script> 
```

# mysql - 替换mysql用户定义变量

> ID：14096477
> 
> 赞同：0
> 
> 时间：2012-12-31T01:21:23.723
> 
> 标签：mysql

鉴于结果只有一个数字，我有一个很好用的查询，但现在我需要允许返回多行并且查询无法处理，因为它使用用户定义变量......这是原始过程

```
CREATE DEFINER=`root`@`%` PROCEDURE `MapRank`(pTankID bigint,pMapID int, pColor int(2))
BEGIN
SET @RankNumber:=0; 
select RankNumber 
from 
(select 
    TankID,
    @RankNumber:=@RankNumber+1 as RankNumber,
    MapID,
    Color 
 from MAPDATA WHERE MapID = pMapID order by Rank DESC, TotalPP DESC) Query1 where TankID = pTankID AND COLOR = pColor ;
END 
```

这将返回一个数字，本质上是计算它的记录数，给我“行”位置。

现在我需要更改它以给我所有行，而不是 mapid 和 color 的位置，这样我就可以看到所有 mapid/color 组合的所有等级

这是我目前无法使用的

```
SET @RankNumber:=0;
select 
    RankNumber,MapID,COlor
from
    (select 
        TankID,
            @RankNumber:=@RankNumber + 1 as RankNumber,
            MapID,
            Color
    from
        MAPDATA

    order by TotalPP DESC) Query1
where
    TankID = 18209 ORDER BY RankNumber 
```

产生的查询结果如下所示：

```
1062    3   1
3544    3   0
6717    17  1
6752    17  3
7453    3   2
7860    17  0
7984    17  2
9220    3   3 
```

如果我手动运行，可以说，地图 id 3 和颜色 3 表示排名号是 9220，第一个查询我得到这个

```
6022 
```

我需要能够通过多个 MySQL 连接来完成此操作，因此最好在不使用临时变量的情况下完成，因为它可能会有另一个人进来并使用它......任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:37:03.190

在挖掘和弄乱更多之后，我发现解决方案是从外部选择中将变量设置回零......并且由于用户定义的变量是连接级别并且我利用池，我们应该永远不会有问题。

```
SET @RankNumber:=0;
select 
    RankNumber,MapID,COlor, @RankNumber:=0
from
    (select 
        TankID,
            @RankNumber:=@RankNumber + 1 as RankNumber,
            MapID,
            Color
    from
        MAPDATA

    order by MapID, Rank DESC, TotalPP DESC ) Query1
where
    TankID = pTankID ORDER BY RankNumber; 
```

# java - NoSuchMethodError 当方法明显存在时

> ID：14096479
> 
> 赞同：0
> 
> 时间：2012-12-31T01:22:04.443
> 
> 标签：java, mysql, bukkit

```
20:15:43 [INFO] macintosh264 issued server command: /sell hand
20:15:43 [INFO] [XYZShop] MacCommand sell executed
20:15:43 [SEVERE] null
org.bukkit.command.CommandException: Unhandled exception executing command 'sell' in plugin XYZShop v0.1.3
        at org.bukkit.command.PluginCommand.execute(PluginCommand.java:46)
        at org.bukkit.command.SimpleCommandMap.dispatch(SimpleCommandMap.java:186)
        at org.bukkit.craftbukkit.v1_4_6.CraftServer.dispatchCommand(CraftServer.java:510)
        at net.minecraft.server.v1_4_6.PlayerConnection.handleCommand(PlayerConnection.java:979)
        at net.minecraft.server.v1_4_6.PlayerConnection.chat(PlayerConnection.java:897)
        at net.minecraft.server.v1_4_6.PlayerConnection.a(PlayerConnection.java:852)
        at net.minecraft.server.v1_4_6.Packet3Chat.handle(Packet3Chat.java:44)
        at net.minecraft.server.v1_4_6.NetworkManager.b(NetworkManager.java:290)
        at net.minecraft.server.v1_4_6.PlayerConnection.d(PlayerConnection.java:112)
        at net.minecraft.server.v1_4_6.ServerConnection.b(SourceFile:39)
        at net.minecraft.server.v1_4_6.DedicatedServerConnection.b(SourceFile:30)
        at net.minecraft.server.v1_4_6.MinecraftServer.r(MinecraftServer.java:598)
        at net.minecraft.server.v1_4_6.DedicatedServer.r(DedicatedServer.java:224)
        at net.minecraft.server.v1_4_6.MinecraftServer.q(MinecraftServer.java:494)
        at net.minecraft.server.v1_4_6.MinecraftServer.run(MinecraftServer.java:427)
        at net.minecraft.server.v1_4_6.ThreadServerApplication.run(SourceFile:849)
Caused by: java.lang.NoSuchMethodError: dev.xyzcraft.net.database.DatabaseHandler.getItem(IS)Ldev/xyzcraft/net/xyzshop/dataObject/MSItem;
        at dev.xyzcraft.net.xyzshop.commands.SellCommand.onCommand(SellCommand.java:63)
        at dev.xyzcraft.net.xyzshop.util.MacCommand.onCommand(MacCommand.java:44)
        at org.bukkit.command.PluginCommand.execute(PluginCommand.java:44)
        ... 15 more 
```

我得到了那个例外

这是代码： [https ://github.com/macintosh264/XYZShop](https://github.com/macintosh264/XYZShop)

最后，我将 Mod API 用于流行的视频游戏 Minecraft，名为 Bukkit。这是JavaDoc和库

[http://dl.bukkit.org/downloads/bukkit/](http://dl.bukkit.org/downloads/bukkit/)

[http://jd.bukkit.org](http://jd.bukkit.org)

“我在另一个使用 MySQL 的项目中也遇到了这个问题，并且在使用 mysql 类时会出现堆栈跟踪。”

*   Macintosh264

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:13:03.827

似乎您尝试执行的任何内容（即保存命令的方法）都没有正确读取它。尝试重新打包您的项目，这在我身上发生了很多次，这通常很容易解决。

# ruby-on-rails - 在 erb 类中显示变量

> ID：14096480
> 
> 赞同：1
> 
> 时间：2012-12-31T01:22:18.777
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试基于与项目 id 的 id 命名相同的 css 类呈现不同的背景图像，但我无法让它实际工作......这是我目前所拥有的视图：

```
<div class= "<% @city.id %>" style="background-color:white;"> 
```

这是它在浏览器中呈现的内容：

```
<div class style="background-color:white;"> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T01:34:07.510

你忘记了“=”，就像这样：

```
<%= @city.id %> 
```

# ruby-on-rails - 如何在 .map 块中使用 rails link_to 帮助器，以便输出是实际链接，而不是 HTML 的文本表示

> ID：14096484
> 
> 赞同：6
> 
> 时间：2012-12-31T01:23:12.900
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有这个：

```
listed in <%= @product.categories.map{ |cat| raw(link_to(cat.name, category_path(cat))) }.join(', ') + "." %> 
```

这是输出：

```
listed in <a href="/categories/1">Men</a>, <a href="/categories/2">Women</a>. 
```

它实际上并没有将其转换为实际链接。它将其作为网页上的文本吐出。

如何`link_to`从该块中将该帮助程序显示为链接而不是 HTML？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-31T01:29:45.963

你需要`map`用`raw`. 这样你就可以告诉 rails 字符串应该直接输出到模板中。

```
listed in <%= raw(@product.categories.map{ |cat| raw(link_to(cat.name, category_path(cat))) }.join(', ') + ".") %> 
```

# ios - 无法在 iPad iOS5 中为通用应用程序保留横向（iOS6 可以）

> ID：14096490
> 
> 赞同：0
> 
> 时间：2012-12-31T01:24:09.560
> 
> 标签：ios, xcode, landscape

我正在使用 xcode4.5.1 中的 Master-detail 模板来创建一个通用应用程序。为了在 iPad 中保持横向，我有以下设置。它适用于 iOS6，但在 iOS5 中始终保持纵向。我该如何解决这个问题？（项目链接：[https](https://www.dropbox.com/s/7wm9l8kxhan6kp1/itstest.zip) ://www.dropbox.com/s/7wm9l8kxhan6kp1/itstest.zip ）</p>

1.  列表

    ```
    <key>UISupportedInterfaceOrientations~ipad</key>

    <array>
    <string>UIInterfaceOrientationLandscapeLeft</string>
    <string>UIInterfaceOrientationLandscapeRight</string>

    </array>

    <key>UISupportedInterfaceOrientations~iphone</key>

    <array>
    <string>UIInterfaceOrientationPortrait</string>
    <string>UIInterfaceOrientationPortraitUpsideDown</string>

    </array> 
    ```

2.  甚至在 Appdelegate.m 中添加以下内容

    ```
    - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
        return UIInterfaceOrientationIsLandscape(interfaceOrientation);
    } 
    ```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:43:15.680

The method `shouldAutorotateToInterfaceOrientation` does not get called in your AppDelegate, only in your View Controllers ([docs](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instm/UIViewController/shouldAutorotateToInterfaceOrientation%3a)). Place the following code inside your view controllers (Although for your particular project I think it would be enough to place it only inside your `MasterViewController`):

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone)
        return UIInterfaceOrientationIsPortrait(interfaceOrientation);
    else
        return UIInterfaceOrientationIsLandscape(interfaceOrientation);
} 
```

# java - 如何避免在数组（Java）中引用相同的索引？

> ID：14096495
> 
> 赞同：1
> 
> 时间：2012-12-31T01:24:23.767
> 
> 标签：java, arrays, initialization, element

我在 Java 中的数组有问题。我在类中使用数组作为类字段，因为我没有实例化类，所以它们都是静态的。我这样称呼一个数组（顺便说一句，这是一个对象数组，“客户”是它自己的类）：

```
 public static Customer[] cDatabase = new Customer[MAX_DATABASE]; 
```

其中 MAX_DATABASE 是一个常量，表示最大条目数。但是当我输入时会发生什么：

```
 className.cDatabase[0].firstName = "John"; 
```

（为了简单起见避免使用方法）该值已调整，但数组中每个其他单元格中的每个 firstName 字段也会更改。我确信这与我调用数组的方式有关，但是当我这样做时：

```
 for(int i = 0; i<className.MAX_DATABASE; i++){
      className.cDatabase[i] = new Customer();
 } 
```

像这样声明字段后：

```
 public static Customer[] cDatabase; 
```

但后来我得到空指针异常。使该数组正常工作以使元素不指向数组的相同索引的最佳方法是什么？我敢肯定，正确的答案也可以避免 NPE ...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T01:32:30.877

你需要两者都做。创建一个新数组并将新对象放入该数组。

```
public static Customer[] cDatabase = new Customer[MAX_DATABASE];
for(int i = 0; i<className.MAX_DATABASE; i++){
      className.cDatabase[i] = new Customer();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T01:27:12.370

确保您的`firstName`字段本身未`static`在您的`Customer`类中声明，否则它将只包含一个可能的值。

```
class Customer {
  private String firstName;
  ...

} 
```

一般来说，使用公共领域也不是好的设计。考虑对这些字段使用 getter 和 setter。这同样适用于`cDatabase`数组字段本身。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T01:36:01.033

如果`firstName`每个单元格都发生变化，那么事情可能是两个：

*   您在课堂上声明`firstName`并忽略了声明您应该以静态方式访问它的警告`static``Customer`
*   您正在将相同的 Customer 实例分配给数组的所有元素

例如

```
Customer[] array = new Customer[MAX];
Customer c = new Customer();
for (int i = 0; i < MAX; ++i)
  array[i] = c; 
```

这里数组的所有元素都指向相同的元素，`Customer`因此您始终修改并从每个单元格中获取相同的元素。

你应该做的是：

```
Customer[] array = new Customer[MAX];
for (int i = 0; i < MAX; ++i)
  array[i] = new Customer(); 
```

通过这种方式，您可以创建`MAX`不同的`Customer`. 修改一个不会影响其他的。

# python - 有没有办法根据需要借用硬盘内存？

> ID：14096503
> 
> 赞同：2
> 
> 时间：2012-12-31T01:26:07.107
> 
> 标签：python, memory, computer-science

这可能是一个愚蠢的问题，但是，例如，如果我正在使用非常大的阵列，在我的 2GB 计算机上占用 2.1GB 的 RAM，有没有办法根据需要从我的硬盘中*借用额外的 0.1GB？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T01:31:06.293

您的操作系统已经这样做了（Windows、*nix）。它被称为[虚拟内存](http://en.wikipedia.org/wiki/Virtual_memory)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:33:52.467

是的。它是[虚拟内存](http://en.wikipedia.org/wiki/Virtual_memory)的一部分，特别是交换。大多数现代操作系统都可以做到这一点，而程序员不必担心。

当物理 RAM 耗尽时，硬盘将用作额外内存。这*非常*慢，因为硬盘的访问时间（毫秒）比 DRAM 的访问时间（纳秒）慢一百万倍。

如果可能，建议增加 RAM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T01:45:38.750

正如其他人所说，是的，系统已经有了虚拟内存。

**但是，您可以通过另一种方式利用这一点。您可以使用[内存映射文件](http://en.wikipedia.org/wiki/Memory-mapped_file)让系统直接将数组映射到磁盘。**

在写入内存（数组）时以这种方式使用它，系统将使用它的虚拟内存管理系统来使用磁盘。您可能会问，这与操作系统将执行的标准 VMM 有何不同？好处是它不会使用标准交换空间（Windows 中的页面文件），因此空间是“内存”，可供系统的其余部分使用。

你仍然有大量的资源使用，但你可以通过释放交换空间来获得收益，实际上，你可以借用更多的虚拟内存。您获得的另一个优点是没有数据重复。IE。如果您正在加载大型数据集，那么您只需将磁盘空间映射到内存，反之亦然以进行写入。

# javascript - 如何存储和禁用另一个元素临时的事件

> ID：14096504
> 
> 赞同：2
> 
> 时间：2012-12-31T01:26:24.900
> 
> 标签：javascript, jquery, hover, click, jquery-data

我正在寻找一种管理事件的方法。我有元素 A 的悬停功能，元素 B 的单击功能。我想在第二次单击 B 时暂时禁用 A 的悬停功能。

我正在寻找一种不需要在 B 内部重写 A 的孔函数的方法。非常简单，就像“存储和禁用事件，调用存储函数”

我发现了一些像 .data('events') 和 console.log 这样的技术。我累了但失败了，或者我写错了。

请帮助和建议！

```
$(A).hover();

$(b).click( 

     if($.hasData($(A)[0])){   // if A has event,
             //STORE all the event A has, and disable
     }else{
            //ENABLE the stored event for A
     }
 ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T01:41:05.143

尝试这个

```
 var hoverme = function() {
    alert('Hover Event Fired');
};

$('.A').hover(hoverme);

var i = 0;

$('.B').on('click', function(){
    if(i%2 === 0){
        // Unbind event
        $('.A').off('hover');
    }
    else{
        // Else bind the event
        $('.A').hover(hoverme);
    }
    i++;
}); 
```

**[检查小提琴](http://jsfiddle.net/tmLRH/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T01:35:05.770

您可以尝试使用函数 a 和 b 范围之外的变量，并使用该变量触发函数 b 对函数 a 执行的操作。

```
var state;
var a = function() {
    if(!state) {
        state = true; 
        // Add hover action and other prep. I'd create a third function to handle this.
    console.log(state);
};
var b = function() {
    if(state) {
        state = false;
        // Do unbinding of hover code with third function.
    } else {
        state = true;
        // Do whatever else you needed to do
    }
} 
```

在不了解您要做什么的情况下，我会尝试类似的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T01:42:22.253

可以证明有更好的方法可以做到这一点，但这工作正常，在准备好文档时这样做：

```
$("#a")[0].active=false;

$("#b").click(function(){
    $("#a")[0].active = ($("#a")[0].active)==false;
    if($("#a")[0].active){
        $("#a").hover(function(){alert("test")});
    }else{
        $("#a").off('hover');
    }
}); 
```

[JSFiddle 示例](http://jsfiddle.net/pQQYj/6/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T01:42:34.983

如果单击 B，听起来您想禁用 A 的单击悬停事件。

```
$("body").on("hover", "#a", function(){
    alert("hovering");
});

$("#b").click( function(){
    $("body").off("hover", "#a", function() {
        alert("removed hovering");
    });
}); 
```

你可以使用 jQuery off 方法，看看这个 fiddle。[http://jsfiddle.net/nKLwK/1/](http://jsfiddle.net/nKLwK/1/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-31T01:45:00.493

定义一个函数以分配给悬停在 A 元素上，因此在 b 单击时，为 A 元素调用 unbind('hover') 并在第二次单击 b 元素时再次定义要悬停的函数，如下所示：

```
function aHover(eventObject) {
    // Todo when the mouse enter object. You can use $(this) here
}

function aHoverOut(eventObject) {
    // Todo when the mouse leave the object. You can use $(this) here
}

$(A).hover(aHover, aHoverOut);
// ...
$(b).click(function(eventObject) {
    if($.hasData($(A)[0])){   // if A has event,
         $(A).unbind('mouseenter mouseleave'); // This is because not a event hover, jQuery convert the element.hover(hoverIn, hoverOut) in element.bind('mouseenter', hoverIn) and element.bind('mouseleave', hoverOut)
    }else{
        $(A).hover(aHover, aHoverOut);
    }
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-31T01:52:39.817

您可以使用 jQuery 中的 .off 函数来解除悬停在“a”元素上的绑定。

```
 function hoverA() {
  alert('I\'m on hover');  
}

$('#a').hover( hoverA );

var active = true;

$('#b').on('click', function(){
    if(active){
        $('#a').off('hover');
        active = false;
    } else{
        $('#a').hover(hoverA);
        active = true;
    }
}); 
```

现场演示：http: [//codepen.io/joe/pen/wblpC](http://codepen.io/joe/pen/wblpC)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-31T03:37:49.420

我认为您想要做的是这样[的（JQuery 1.7.2 的示例](http://jsfiddle.net/ynxKG/)）：

```
$("#a").hover(function(){alert("test")});
$("#a")[0].active=true;

$("#b").click(function(){
    if($("#a")[0].active){
        $("#a")[0].storedEvents = [];
        var hoverEvents = $("#a").data("events").mouseover;
        jQuery.each(hoverEvents , function(key,handlerObj) {
            $("#a")[0].storedEvents.push(handlerObj.handler);
        });
        $("#a").off('hover');
    }else{
        for(var i=0;i<$("#a")[0].storedEvents.length;i++){
            $("#a").hover($("#a")[0].storedEvents[i]);
        }
    }
    $("#a")[0].active = ($("#a")[0].active)==false;
});​ 
```

[JSFiddle 示例](http://jsfiddle.net/ynxKG/)

但是您必须考虑以下几点：

*   这仅在您使用 JQuery 添加事件时才有效，因为 JQuery 会在内部跟踪已添加的事件处理程序。
*   每个版本的 JQuery 处理`data("events")`方式不同，这意味着此代码可能不适用于其他版本的 JQuery。

我希望这个对你有用。

**编辑：**

`data("events")`是用于 JQuery 1.6 和 JQUery 1.7 的内部未记录数据结构，但[已在 JQuery 1.8 中删除](http://blog.jquery.com/2012/08/09/jquery-1-8-released/)。所以在 JQuery 1.8 中访问事件数据的唯一方法是通过：`$._data(element, "events")`. 但请记住 JQuery 文档中的建议：**这不是受支持的公共接口；实际数据结构可能因版本而异**。

# javascript - 无限拖放

> ID：14096509
> 
> 赞同：0
> 
> 时间：2012-12-31T01:27:48.043
> 
> 标签：javascript, jquery, html, web

我正在使用 JQuery，我想知道如何创建拖放，但是，拖动元素就像无限供应一样。我可以继续一遍又一遍地拖出拖动元素的副本。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:32:54.047

你是说克隆吗？然后试试这个：[http ://www.placona.co.uk/166/javascript/a-more-elaborated-jquery-drag-drop-cloning/](http://www.placona.co.uk/166/javascript/a-more-elaborated-jquery-drag-drop-cloning/)

# scala - 如果找不到元素，为什么 Scala 的索引方法返回 -1 而不是 None？

> ID：14096518
> 
> 赞同：9
> 
> 时间：2012-12-31T01:29:31.953
> 
> 标签：scala

我一直想知道为什么在 Scala 中用于确定集合中元素位置的各种索引方法（例如`List.indexOf`, `List.indexWhere`）返回`-1`以指示集合中不存在给定元素，而不是更惯用的`Option[Int]`. 返回`-1`而不是返回是否有一些特别的优势`None`，或者这只是出于历史原因？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T14:22:35.560

只是出于历史原因，但后来人们想知道历史原因是什么：历史是什么，为什么会变成这样？

直接历史是`java.lang.String.indexOf`返回索引的方法，如果没有找到匹配的字符，则返回 -1。但这并不新鲜。如果在字符串中找不到任何字符，Fortran SCAN 函数将返回 0，这与 Fortran 使用 1 索引相同。

这样做的原因是字符串只有正长度，因此任何负长度都可以用作`None`值，而无需任何装箱开销。 `-1`是最方便的负数，就是这样。

如果编译器不够聪明，无法意识到所有装箱和拆箱以及一切都无关紧要，这可能会加起来。特别是，创建一个对象往往需要 5-10 ns，而函数调用或比较通常需要 1-2 ns，所以如果集合很短，创建一个新对象可能会有相当大的分数损失（如果你的内存已经被征税了，GC 有很多工作要做）。

如果 Scala 最初有一个了不起的优化器，那么选择可能会有所不同，因为人们只会用选项编写东西，这样更安全且不是特殊情况，然后相信编译器会将其转换为适当的高性能代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T01:46:19.053

速度？（没有把握）

```
def a(): Option[Int] = Some(Math.random().toInt)
def b(): Int = Math.random().toInt
val t0 = System.nanoTime; (0 to 1000000).foreach(_ => a()); println("" + (System.nanoTime - t0))
// 53988000
val t0 = System.nanoTime; (0 to 1000000).foreach(_ => b()); println("" + (System.nanoTime - t0))
// 49273000 
```

而且您还应该始终检查 index < 0 in`Some(index)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T09:47:09.753

还有一个好处是只返回一个`Int`可以使用Java的内置类型，而`Option[Int]`需要将整数包装在一个`Object`. 这意味着更差的速度（如@idonnie 所示）但也意味着更多的内存使用。

虽然`Option`作为通用工具很棒（我经常使用它），但其他非值表示 sa`Double.NaN`或空字符串也是完全有效且有用的。

使用的好处之一是能够将其作为集合`Option`传递给循环等。`for`如果您不太可能这样做，请检查 -1 或者`NaN`可能比为`None`/进行匹配更简洁`Some`。

# r - 将 R 脚本编译成独立的 .exe 文件？

> ID：14096520
> 
> 赞同：94
> 
> 时间：2012-12-31T01:29:48.040
> 
> 标签：r

有没有一种简单的方法可以像 matlab 那样将我的`R`脚本编译成独立文件？`.exe`

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2015-01-29T11:51:35.033

事实上，有一种方法可以实现满足您要求的解决方案。在 R-Bloggers 上查看有关使用 R 部署[桌面应用程序的文章。](http://www.r-bloggers.com/deploying-desktop-apps-with-r/)如文章中所述，您最终将使用比单个 exe 文件更多的东西。

另外，我想通过使用[RGtk2来提请您注意](http://www.ggobi.org/rgtk2/)[RGtk2](http://www.ggobi.org/rgtk2/) ，您可以尝试在 R 中开发自己的界面。如果迫在眉睫，我相信您可以将您的 R 代码与 R 的可移植版本打包在一起，并且依赖于一个安装程序并从中生成和应用程序，这会产生单个 exe 文件的错觉。

在您的问题中，您询问开发解释 R 代码的独立可执行文件是否*容易。*我不会说这很容易。如果您强烈希望从应用程序中运行 R 代码，您可以使用[RCaller](https://github.com/jbytecode/rcaller) for Java 或[R.NET](https://rdotnet.codeplex.com/)以更简单的方式执行此操作。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-31T09:52:03.873

回应您的评论：

> 实际上我想分发它但保持脚本和算法的秘密，有没有办法加密它或任何其他方式来实现这个目的？

您可以（在某种程度上）通过使用`save()`. 例如，这是`f()`您要保密的函数：

```
f <- function(x, y) {
  return(x + y)
} 
```

将其保存在任何地方：

```
save(f, file = 'C:\\Users\\Joyce\\Documents\\R\\Secret.rda') 
```

当您想使用该功能时：

```
load("C:\\Users\\Joyce\\Documents\\R\\Secret.rda") 
```

我会将我的所有函数保存在单独的文件中，将它们放在一个文件夹中，并使用一个普通的旧 .R 脚本将它们全部加载并执行任何操作。把整个东西拉上拉链，然后分发给任何人。甚至可能将其编译成一个包。实际上，整个事情将是只读的。

这个解决方案虽然不是很好。您仍然可以通过键入函数的名称在 R 中看到该函数，因此它不会在这个意义上隐藏。但是如果你打开 .rda 文件，它们的内容都是乱码。这完全取决于代码的接收者对 R 的体验程度。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-31T19:03:31.100

`petals`在 TeachingDemos 包中的函数中实现了一种具有加密代码的形式。

请注意，查找隐藏代码只需要中级编程技能，但是确实需要刻意努力，并且用户不能声称自己偶然看到了代码。然后，您将需要某种类型的许可协议来执行任何禁止偷看协议。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-31T01:34:29.143

那么您将需要在部署机器上安装 R。至于制作可执行文件，我不确定这是可能的。但是您可以创建另一个调用您的 R 脚本的程序。R 是一种解释型语言。这不可能。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-10-10T16:19:04.967

我对这个问题进行了一些研究，并在过去几年中实施了一些解决方案。

1.  一个选项是将您的应用程序与便携式 R 一起包装到像 Electron 这样的容器应用程序中。[电子快速启动](https://github.com/COVAIL/electron-quick-start)项目尝试了这一点。
2.  [RInno 包](https://www.r-bloggers.com/2017/03/rinno-how-to-install-local-shiny-apps/)提供了将您的应用程序和 R 可移植到安装程序应用程序的功能。每个用户在他们的系统上运行一次安装程序，它将安装您的应用程序、包和代码。但最终用户可能看不到与其他应用程序的区别。他们在开始菜单中获得一个链接，仅此而已。我成功地做到了。但它并没有开箱即用。我不得不在几个地方手动调整输出。
3.  第二个容器解决方案适用于 docker。这就是[ShinyProxy](https://www.shinyproxy.io/documentation/getting-started/)所做的。另请参阅此[博客](https://www.databentobox.com/2019/11/05/deploy-r-app-with-shinyproxy/)。
4.  包[shinyShortcut](https://cran.r-project.org/web/packages/shinyShortcut/README.html)（我引用）“将生成一个可执行文件，直接在用户的默认浏览器中运行闪亮的应用程序”。

需要注意的重要一点：我没有测试过它们中的大多数。通过查看解决方案，我经常感觉到这些解决方案可能会使发布变得有些复杂，因为总是涉及手动步骤。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-09-25T08:31:12.640

如果 Python 可以做到，我不明白为什么不能编译 R。Python 在技术上是解释性的，但它们是编译器，将解释器与代码捆绑在一起并编译成 exe。

# meteor - 在 Meteor 环境中运行其他节点进程？

> ID：14096527
> 
> 赞同：3
> 
> 时间：2012-12-31T01:31:00.600
> 
> 标签：meteor

我玩 Meteor（和 Meteorite）已经有一段时间了，我很喜欢我可以轻松启动和运行。现在我想向应用程序添加一些测试，发现主要障碍是在测试脚本中包含对 Meteor 使用的包的引用/要求。

例如，我编写了一个简单的类，它在内部使用了一些下划线方法。然后我写了一个简单的 mocha 脚本来测试它。

当我跑

```
mocha my_test.js 
```

它抱怨 _ 未定义。如果我添加

```
var _ = require('underscore')._ 
```

对于我的测试代码，它找不到下划线库，因为这些包都包裹在一个紧凑的小包中，而该包*不在*mocha 的 NODE_PATH 上。我可以指定该路径，但这种硬编码路径似乎是个坏主意。

有没有办法在 Meteor 环境中运行节点进程/脚本（如 mocha）？我正在寻找类似于 ruby​​-land 的“bundle exec”的东西。我研究过 Meteorite，它似乎几乎可以将命令直接传递给 Meteor，所以我希望你们可能想要使用这个。

更新：

写完这篇，我开始看流星源代码。我能够写出一些*主要*做我想做的事情，并且认为 Meteor 团队可能会评论这是否看起来是一条好路。从流星外壳脚本（/usr/local/meteor/bin/meteor）开始，我在底部添加了一个 case 语句，它根据命令名称切换模式。该文件可以替换当前的流星启动脚本，然后添加从流星执行到流星的链接，瞧。使用这个替换脚本，我可以正常运行流星。我也可以跑

```
meteor-exec `which mocha` tests/mocha_test.coffee --compilers coffee:coffee-script 
```

我得到了我期望的结果。我可以 require('underscore') ，它是从 Meteor 的第三方库中提取的。我可以在我的 npm 全局包空间中包含“mocha”和“chai”。

如果这看起来是正确的心态，并且代码与你们可能进行的方式一致，我可以提交适当的拉取请求。

替换流星 shell 脚本在这个要点[https://gist.github.com/4416913](https://gist.github.com/4416913)中。我在下面添加了差异。

提前致谢

罗杰斯先生

附言。保持良好的工作。我真的很喜欢流星。

```
diff meteor meteor.orig 
105,116c105,106
< NPM_GLOBAL_PATH=$(npm root -g)
< METEOR_THIRD_PARTY="$DEV_BUNDLE/app/lib/third"
< case $(basename $0) in
<   meteor)
<     export NODE_PATH="$DEV_BUNDLE/lib/node_modules"
<     exec "$DEV_BUNDLE/bin/node" "$METEOR" "$@"
<     ;;
<   meteor-exec)
<     export NODE_PATH="$DEV_BUNDLE/lib/node_modules:$METEOR_THIRD_PARTY:$DEV_BUNDLE/packages:$NPM_GLOBAL_PATH"
<     exec "$DEV_BUNDLE/bin/node" "$@"
<     ;;
< esac
---
> export NODE_PATH="$DEV_BUNDLE/lib/node_modules"
> exec "$DEV_BUNDLE/bin/node" "$METEOR" "$@" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T01:40:10.663

没错，这使您可以访问下划线和节点模块，但正如您所说，您将无法以这种方式访问​​流星包（即您将无法使用 Meteor.Collection）。还值得指出的是，我们 Git 存储库中的 admin/node.sh 与您的`meteor-exec`.

如果您想尝试构建更完整的解决方案，请查看 app/server/server.js 以了解我们如何加载包。您需要执行类似的操作才能测试依赖 Meteor 本身的代码。另一种方法是创建一个智能包包装 mocha。目前没有简单的方法可以直接从 Meteor 包中依赖 NPM 模块（这正在开发中），但是您可以将 mocha 源代码复制到您的包中。然后你就可以`meteor`在你的应用程序中运行你的 mocha 测试（尽管仍然运行一个监听端口 3000 的 web 服务器等）

# java - Guice @Transactional 不启动事务

> ID：14096529
> 
> 赞同：9
> 
> 时间：2012-12-31T01:31:50.003
> 
> 标签：java, guice

[我已经开始使用这里](http://code.google.com/p/google-guice/wiki/Transactions)描述的 Guice 方法级事务。我有一条消息

```
@Inject
private EntityManager entityManager;

@Transactional
public UserSession createSession(User user, String browser) {
    UserSession session = new UserSession(user, browser);
    entityManager.persist(session);
} 
```

从简短的描述来看，我认为应该足够了。但我收到一个错误，因为没有开始交易。只有当我自己开始并提交它时它才有效。

该对象是由 Guice 在我的应用程序开始时在初始化程序中创建的。每个请求使用相同的实例。

为什么它不起作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T07:20:10.983

`@Transactional`方法注释通过[`AOP`](http://code.google.com/p/google-guice/wiki/AOP)，其中 Guice 通过创建一个代理对象来满足请求，`Foo`该对象拦截那些带注释的方法调用并（可选）将它们转发到实际对象。确保满足以下条件：

1.  您已经通过 Guice 使用该方法创建了对象，`@Transactional`否则 Guice 将没有机会提供代理。

2.  类和方法都没有被标记`final`，因为 AOP 不能轻易地覆盖它们。

3.  您已经安装了[JpaPersistModule](http://code.google.com/p/google-guice/wiki/JPA)或其他形式的[PersistModule](http://code.google.com/p/google-guice/source/browse/extensions/persist/src/com/google/inject/persist/PersistModule.java)。从该源代码中请注意，此模块实际上是将 绑定`MethodInterceptor`到`@Transactional`注释的。

如果这不能完全满足您的需求，请记住，您始终可以使用[AOP 文档](http://code.google.com/p/google-guice/wiki/AOP)来编写自己的方法拦截器。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-04T13:28:42.887

我遇到了与您类似的问题，通过从@javax.transaction.Transactional 切换到@com.google.inject.persist.Transactional 解决了这个问题。显然 Guice-Persist 不支持来自 Java Transaction API 的 @Transactional 注释。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-01T14:15:41.940

再次检查一切后，它没有工作。有趣的是，它在两者之间起作用，但只有一百次。

经过一些额外的测试后，我发现我需要在每个请求上重新创建类。在我刚刚在应用程序启动时创建它们之前。现在它似乎工作得很好。

感谢您的提示帮助我进一步调查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-29T09:05:07.067

我在以下情况下遇到了这个问题，所以我想我也会在这里发布我的解决方案：

`BusinessLogic`需要两个构造函数参数：`MyDao`，理论上我可以从 guice 获得，以及我无法*从*guice 获得的其他一些对象。
所以我创建了一个`BusinessLogicProvider`( `extends AbstactProvider`)，但它不与`bind(BusinessLogic.class).toProvider(BusinessLogicProvider)`) 一起使用。现在我只是绑定`BusinessLogicProvider`任何 guice-served 类型：`bind(BusinessLogicProvider.class);`

在我的`BusinessLogicProvider`课堂上，我现在可以`@Inject`使用`private Provider<MyDao> daoProvider;`

稍后，在`BusinessLogicProvider`'`public BusinessLogic get()`方法中，我可以`BusinessLogic`使用所需的两个参数调用 ' 构造函数：`daoProvider.get()`另一个我无法从 guice 获取的对象。

**陷阱：**当my的`@Inject`ed不是类型（但 simpy 的类型）时，它将不起作用。 即使ed来自 guice，guice*也*需要在每次实例化时创建一个新的。`private Provider<MyDao> daoProvider;``BusinessLogicProvider``Provider<MyDao>``MyDao`
`@Inject``MyDao` *`BusinessLogic`*

 ** * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-14T12:58:46.357

除了其他答案，特别是 Jeff Bowman 和 uldall 的答案：

## 确保您的 Guice 版本与您的 JDK/JRE 运行时一致

我刚刚遇到了这个问题，因为我使用的是 Java 17 运行时和不支持它的 Guice (5.0.1) 版本；它[至少需要 5.1.0](https://github.com/google/guice/wiki/Guice510)！

### 如果您认为您使用的是正确的 Guice 版本，但它仍然会损坏......

您可能需要调试您的 CLASSPATH。如果您使用的是依赖项管理器：

1.  确保您的 CLASSPATH 不会碰巧插入“寄生虫”过时版本作为传递依赖项。使用 Gradle，该`:dependencies`任务将有助于调试。
2.  您的 IDE 可能有一个错误，它的 CLASSPATH 冲突解决方案（应该用新版本覆盖旧版本的传递依赖项）可能无法按预期工作。这在 Eclipse Buildship 中发生在我身上，我必须明确阻止项目引入过时的依赖项：

    ```
    implementation("another-dependency:x.y.z") {
        exclude group: 'com.google.inject', module: 'guice'
    } 
    ```

### 奖励：验证 Guice 的仪器是否正常工作

当 Guice 未能正确检测代码时没有反馈，这有点烦人，除了随后抛出的异常（例如`javax.persistence.TransactionRequiredException`）。

为了验证它是否实际工作，检查`@Transactional`方法中的调用堆栈可能很有用，如下所示：

```
@Transactional
void myTransactionalMethod() {
  StackWalker.getInstance().forEach(System.out::println);
  // rest of method
} 
```

如果 Guice 的检测工作正常，您会`com.google.inject.persist.jpa.JpaLocalTxnInterceptor`在标准输出的调用堆栈中找到。

您还可以使用 IDE 的调试器；只需在方法的开头放置一个断点`@Transactional`并检查调用堆栈。

`javax.transaction.Transactional`根据 uldall 的回答，这允许验证即使在当前版本的 Guice (5.1.0) 中，Guice 仍然不支持注释。*

# c# - Handler.ashx C# 到 Java，基于 ExtJs 的 TinyMCE 文件和图像管理器插件

> ID：14096530
> 
> 赞同：2
> 
> 时间：2012-12-31T01:31:54.127
> 
> 标签：c#, spring, extjs, tinymce

我正在使用由 Rahul Singla [http://www.rahulsingla.com/blog/2011/05/extjsfilemanager-extjs-based-file-and-image-manager-plugin-for-tinymce开发的 ExtJsFileManager](http://www.rahulsingla.com/blog/2011/05/extjsfilemanager-extjs-based-file-and-image-manager-plugin-for-tinymce)

这里是 Php 和 C# 示例，并且有它的文件处理程序。我在我的项目中使用 Java SpringSource，我对这些技术不熟悉。我试图将 C# 转换为 Java，但我不明白 C# 返回给客户端的确切内容。

这是工作 C# 代码

```
<%@ WebHandler Language="C#" Class="BrowserHandler" %>

using System;
using System.Web;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Security;
using MyCompany;

public class BrowserHandler : IHttpHandler
{

#region Private Members
private HttpContext context;
#endregion

#region IHttpHandler Methods
public void ProcessRequest (HttpContext context)
{
    this.context = context;
    string op=context.Request["op"];
    string path=this.context.Request["path"];
    context.Response.ContentType = "text/javascript";

    //These are extra parameters you can pass to the server in each request by specifying extjsfilemanager_extraparams option in init.
    string param1=context.Request["param1"];
    string param2=context.Request["param2"];

    switch (op)
    {
        case "getFolders":
            this.getFolders(path);
            break;

        case "getFiles":
            this.getFiles(path);
            break;

        case "createFolder":
            this.createFolder(path);
            break;

        case "uploadFiles":
            this.uploadFiles(path);
            break;
    }
}

public bool IsReusable
{
    get
    {
        return false;
    }
}
#endregion

#region Private Methods
private void getFolders (string path)
{
    path = this.validatePath(path);

    List<object> l=new List<object>();
    foreach (string dir in Directory.GetDirectories(path))
    {
        l.Add(new
        {
            text = Path.GetFileName(dir),
            path = dir,
            leaf = false,
            singleClickExpand = true
        });
    }

    this.context.Response.Write(Globals.serializer.Serialize(l));
}

private void getFiles (string path)
{
    path = this.validatePath(path);

    List<object> l=new List<object>();
    foreach (string file in Directory.GetFiles(path))
    {
        l.Add(new
        {
            text = Path.GetFileName(file),
            virtualPath = Globals.resolveUrl(Globals.resolveVirtual(file))
        });
    }

    this.context.Response.Write(Globals.serializer.Serialize(l));
}

private void createFolder (string path)
{
    path = this.validatePath(path);

    string name=this.context.Request["name"];
    Directory.CreateDirectory(Path.Combine(path, name));

    this.context.Response.Write(Globals.serializer.Serialize(new object()));
}

private void uploadFiles (string path)
{
    context.Response.ContentType = "text/html";
    path = this.validatePath(path);

    string successFiles="";
    string errorFiles="";

    for (int i=0; i < this.context.Request.Files.Count; i++)
    {
        HttpPostedFile file=this.context.Request.Files[i];

        if (file.ContentLength > 0)
        {
            string fileName=file.FileName;
            string extension=Path.GetExtension(fileName);
            //Remove .
            if (extension.Length > 0) extension = extension.Substring(1);

            if (Config.allowedUploadExtensions.Contains(extension, StringComparer.InvariantCultureIgnoreCase))
            {
                file.SaveAs(Path.Combine(path, fileName));
            }
            else
            {
                errorFiles += string.Format("Extension for {0} is not allowed.<br />", fileName);
            }
        }
    }

    string s=Globals.serializer.Serialize(new
    {
        success = true,
        successFiles,
        errorFiles
    });
    byte[] b=this.context.Response.ContentEncoding.GetBytes(s);
    this.context.Response.AddHeader("Content-Length", b.Length.ToString());

    this.context.Response.BinaryWrite(b);

    try
    {
        this.context.Response.Flush();
        this.context.Response.End();
        this.context.Response.Close();
    }
    catch (Exception) { }
}

private string validatePath (string path)
{
    if (string.IsNullOrEmpty(path))
    {
        path = Config.baseUploadDirPhysical;
    }

    if (!path.StartsWith(Config.baseUploadDirPhysical, StringComparison.InvariantCultureIgnoreCase) || (path.IndexOf("..") != -1))
    {
        throw new SecurityException("Invalid path.");
    }

    return (path);
}
#endregion} 
```

这是我的代码

```
@RequestMapping(value = "/filehandler", method = RequestMethod.POST)
public @ResponseBody byte[] filehandler(HttpServletRequest request, HttpServletResponse response) {
    String op = request.getParameter("op");
    String path = uploadDataFolder; // || request.getParameter("path");
    String jsondata = "{root:";
    String datastr = "";

    File folder = new File(path);

    if (op.equals( "getFolders")){
        // FOLDERS
        for (File fileEntry : folder.listFiles() ) {
            //File fileEntry;
            if (fileEntry.isDirectory()) {
                datastr += "{\"text\":\"" + fileEntry.getName() +
                            "\",\"path\":\"" + fileEntry.getPath() +
                            "\",\"leaf\":\"false\"" +
                            ",\"singleClickExpand\":\"true\"}";
            }
        }
    }
    else if (op == "getFiles"){
        // FILES
        for (File fileEntry : folder.listFiles()) {
            //File fileEntry;
            if (fileEntry.isFile()) {
                datastr += "{\"text\":\"" + fileEntry.getName() +
                            "\",\"virtualPath\":\"" + fileEntry.getPath() + "\"";
            } else {
                System.out.println(fileEntry.getName());
            }
        }
    }
    else if (op == "createFolder"){
        // create folder function is not supported in our project

    }
    else if (op == "uploadFiles"){
        // upload images
        request.getAttribute("Files");
    }
    datastr = datastr.equals("") ? "null" :  "[" + datastr + "]";
    jsondata += datastr + "}";

    return getBytes(jsondata);
} 
```

对于 getFolders 操作，它返回 JSON 数据，例如

```
{root:[{"text":"blog","path":"C:\workspace\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps\NetaCommerceFrameworkAdmin\META-INF\static\images\blog","leaf":"false","singleClickExpand":"true"}{"text":"photos","path":"C:\workspace\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps\NetaCommerceFrameworkAdmin\META-INF\static\images\photos","leaf":"false","singleClickExpand":"true"}]} 
```

我无法弄清楚 C# 代码返回什么，所以我无法用 Java 编写它。它不允许“getFolders”操作返回我的 JSON。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T09:19:02.560

AC# 'HTTPHandler' 可以返回它想要的东西，例如它可以返回一个图像（一种常见用途），或者它可以返回二进制文件数据，让客户端下载一个文件。

它们很灵活，可以配置为“返回”任何内容，因为它们经常直接写入 HTTPResponse 对象。

为了弄清楚您的处理程序返回的内容，您需要寻找任何触及 HTTPResponse 的内容。

例如`context.Response.ContentType = "text/javascript";`

这是在 Http 响应上设置内容类型标头。

那里的几个私有方法似乎会生成列表，并将那些序列化的列表返回给客户端，看起来就像 JSON 数据。

这里的例外是`uploadFiles()`似乎接受发布请求的方法（您可以知道它正在尝试访问请求对象以在此处检索上传的文件：

```
HttpPostedFile file=this.context.Request.Files[i]; 
```

经过一些检查后，这似乎将文件保存到服务器。

如果我是你，我会在 Java API 中寻找他们自己的序列化器选项，看看你是否可以挂钩，而不是编写自己的方法来将字符串粘在一起。

# python - python urllib脚本中的简单错误

> ID：14096531
> 
> 赞同：-1
> 
> 时间：2012-12-31T01:32:02.767
> 
> 标签：python, centos, urllib2

我已经从另一个 SO 问题中复制了这段代码，但我无法解决我遇到的错误

这是我的代码

```
import os
import urllib2
import sys
d = urllib2.urlopen("http://www.google.com.au/logos/2012/new_years_eve_2012_-_english_only-1049005-hp.jpg")
o = open('image.%s' % d.info().gettype(), 'w')
o.write(d.read()) 
```

错误是

> 回溯（最后一次调用）：文件“./image_test.py”，第 6 行，在 o = open('image.%s' % d.info().gettype(), 'w') IOError: [Errno 2]没有这样的文件或目录：'image.image/jpeg'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T01:35:38.947

它告诉你错误......没有这样的文件或目录：'image.image/jpeg'......所以很明显gettype返回类似“image/jpg”......你可以拆分它以获得扩展名（可能并不总是有效...）

```
o = open('image.%s' % d.info().gettype().split("/")[-1], 'w') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T01:39:30.353

这是因为 HTML MIME 类型通常包含斜杠，例如`image/jpeg`. 这会导致混淆`open`，因为斜杠是文件系统路由中使用的特殊字符。

您只需要避免在文件名中使用斜杠，例如 Joran 建议的方式。

**更新**为了使它在所有情况下都能正常工作，您必须获得一个映射 MIME 类型 -> 文件扩展名。Apache 有一个：http: [//svn.apache.org/viewvc/httpd/httpd/trunk/docs/conf/mime.types](http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/conf/mime.types?view=markup) ?view=markup 。一旦你像这样将它解析为python字典：

```
import re

mimetypes = {}
with open('mime.types') as mimedata:
    for line in [line.strip() for line in mimedata.readlines()]:
        if line[0] == '#':
            continue

        # This pattern will only get the first extension in the list
        pattern = re.compile(r'([^\s]+)\s+([^\s]+)')
        result  = pattern.match(line)
        mime    = result.group(1)
        ext     = result.group(2)
        mimetypes[mime] = ext 
```

您将通过以下方式使用它：

```
mime = d.info().gettype()
ext = ''
if mime in mimetypes:
    ext = mimetypes[mime]

o = open('data' + ext, 'w')
o.write(d.read()) 
```

# c# - 紧凑框架中的数据网格只显示大约一半的总行数？

> ID：14096534
> 
> 赞同：0
> 
> 时间：2012-12-31T01:32:27.350
> 
> 标签：c#, datagrid, windows-mobile, compact-framework

我通过数据源绑定，VisibleRowCount 被固定为 27，但应该有 50 个条目（datatable.rowcount 返回 50）。

任何想法我做错了什么或可以尝试做些什么来使所有行可见？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T18:23:14.030

VisibleRowCount 是一次在屏幕上容纳多少行，而不是总行数。

看这里：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagrid.visiblerowcount(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagrid.visiblerowcount(v=vs.90).aspx)

摘录：

> **视口中可见**的行数。视口是网格可见的矩形区域。视口的大小取决于 System.Windows.Forms.DataGrid 控件的大小；如果您允许用户调整控件的大小，视口也会受到影响。

# memory-management - 组件的 ColdFusion 内存使用情况

> ID：14096536
> 
> 赞同：6
> 
> 时间：2012-12-31T01:32:36.980
> 
> 标签：memory-management, coldfusion, javabeans

我正在使用 VMC 创建一个站点，并使用 bean 将数据从模型传输到控制器/视图。

我计划实现一些基本且非常简单的缓存，如果 bean 没有更改，它们会将它们存储在一个简单的结构中（随着使用量的增长，我们将在 1.3 版左右实现一个更好的缓存系统）。

所以问题在于我们的 bean 中有什么。

一种类型的 bean 只保存基本数据，并依赖一些外部服务来完成其余的工作（联系 DAO 以获取查询，解析查询以加载 bean 值）。这是我同事反复告诉我的“贫血豆”模型:-)。

另一种类型的 bean 会更加独立。它会知道 DAO 在哪里，因此会直接调用 DAO 来获取数据查询。它将包含解析查询和设置属性的必要函数。它基本上将大部分“服务”层与 bean 结合起来，将直接数据库留在 DAO 层中。

当然，对于控制器/视图，两个 bean 的外观和行为都相同。

但问题是内存以及 ColdFusion/Java 如何处理它。

使用贫血模型，bean 将有足够的内存来保存属性变量，只需轻轻一点，让它在需要时指向服务。

第二种bean的功能比较重，会不会占用缓存更多的内存？？？bean 的每个副本都会有方法的完整副本吗？

我倾向于认为第二个模型不会有更多的内存，因为它们会“共享”方法并且只需要属性变量的内存。

恕我直言，第二种方法将简化代码库，因为 bean 需要的代码更接近 bean，而不是分散在 DAO 和服务之间。并且它会减少服务中的简单函数，这些函数仅传递对 bean 的 DAO 的调用，可以在需要时直接转到 DAO...

这个问题有意义吗？？或者至少我是怎么问的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T10:22:39.230

所有内存管理都在 Java 级别进行，因此遵循相同的规则。在 Java 中，创建对象实例时分配的唯一“新”内存是为其成员变量分配的；组件/类本身的方法没有内存占用：这些东西只存储在内存中一次，并带有对它的引用。

一个可能的考虑是 CFC 的每个方法都编译为它自己的离散类（为什么？我不知道），所以每个方法都是它自己的类。与 Java 类的使用相比，这可能意味着 CFC 使用的内存占用略大，但这仍然不会随着对象实例化而扩展：对象的每个实例仍然只会为其成员变量消耗内存，而不是方法定义对象的 CFC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T02:06:16.220

默认情况下，所有 cfm 页面都编译到内存中，CFC 需要隐式存储在内存中（例如应用程序范围）以避免每次都实例化它，但是您这样做需要相同组件的相同内存，任何其他用途将取决于您在组件或 bean 中存储的任何数据。你看过冷泉吗？

# objective-c - 在 Cocoa 框架的 ViewController 中调用的 NSSpeechSynthesizer 类没有产生所需的输出

> ID：14096539
> 
> 赞同：0
> 
> 时间：2012-12-31T01:33:41.643
> 
> 标签：objective-c, ios, cocoa

我有一个带有 ViewController 的 Mac OS X 应用程序，它调用 NSSpeechSynthesizer 类，如下所示 -

```
- (IBAction)speakButtonTapped:(id)sender
{
    NSString *mystring = [self.textFieldTextInput stringValue];

    self.speechSynth = [[NSSpeechSynthesizer alloc] initWithVoice:nil];

    if ([mystring length] ==0)
    {
        NSLog(@"string from %@ is of zero length", self.textFieldTextInput);

    }
    [self.speechSynth startSpeakingString:mystring];
    NSLog(@"Speech output end");

} 
```

textFieldInput 和 speakButtonTapped 在 Xcode 4.5.2 中使用 IB 进行连接

但是，我没有得到想要的输出（也就是语音）。

# c# - 取消通过 System.Diagnostics.Process.Start() 启动的进程

> ID：14096545
> 
> 赞同：5
> 
> 时间：2012-12-31T01:34:17.287
> 
> 标签：c#

我正在编写一个应用程序，其中我有一个进程在`BackgroundWorker`. 我想支持从用户界面取消，但我没有看到一个简单的方法来做到这一点。

这`Process`实际上是一个运行时间相当长的命令行 exe。输出通过事件异步重定向`Progress.OutputDataReceived`，并用于向 GUI 报告进度。

```
private void worker_DoWork(object sender, DoWorkEventArgs e)
{
    using (var process = new Process())
    {
        //...

        process.Start()

        //...

        process.WaitForExit();
    }
}

private void CancelWorker()
{
    worker.CancelAsync();
    // where to actually listen for the cancellation???
} 
```

似乎没有办法让进程“侦听”除 之外的主线程的任何输入`StandardInput`，但除非应用程序本身响应特定输入以中止，否则这将不起作用。

有没有办法根据来自主线程的取消请求来取消进程？

出于我在进程中运行的 EXE 的目的，我可以只调用`Process.Close()`退出而没有任何副作用，但该`Process`对象仅对该`worker_DoWork()`方法已知，因此我需要跟踪`Process`实例以用于取消目的。 ..这就是为什么我希望可能有更好的方法。

（如果重要的话，我的目标是 .NET 3.5 以解决兼容性问题。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T03:30:48.673

对于合作取消，您需要 在[BackgroundWorker.DoWork](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.dowork.aspx) 事件中监听[BackgroundWorker.CancellationPending 。](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancellationpending.aspx)

[如何：使用后台工作者](http://msdn.microsoft.com/en-us/library/cc221403%28v=vs.95%29.aspx)

```
private void worker_DoWork(object sender, DoWorkEventArgs e)
{
    using (var process = new Process())
    {
        //...

        process.Start()

        //...
        while(true)
        { 
            if ((sender as BackgroundWorker).CancellationPending && !process.HasExited)
            {
              process.Kill();
              break;
            }
            Thread.Sleep(100);
         }

        process.WaitForExit();
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-31T01:52:30.953

试试这个，这可能对你有帮助，很简单

```
private System.Threading.TimerCallback worker;
private System.Threading.Timer workertimer ;
private void worker_DoWork()
{
   //You codes
}
private void StartWorker()
{
   worker = new System.Threading.TimerCallback(worker_DoWork);
   workertimer = new System.Threading.Timer(worker, null, 1000, 1000);
}

private void CancelWorker()
{
    worker.Dispose();
} 
```

# asp.net - RoleManager Cookie 即将过期

> ID：14096550
> 
> 赞同：1
> 
> 时间：2012-12-31T01:35:00.337
> 
> 标签：asp.net, asp.net-mvc

这曾经有效，但是我最近发现 ASP.NET 不再在 cookie 中缓存用户角色。我运行了一个提琴手跟踪，看起来 cookie 的值是空白的，并且过期日期是过去设置的。因此，cookie 不会在后续请求中发送，并且每次往返都会命中数据库。

我似乎找不到任何关于此的帖子。任何帮助都会很棒。谢谢！

**网络配置**：

```
<roleManager enabled="true" defaultProvider="MyRoleProvider" cacheRolesInCookie="true" cookieName=".ASPXROLES" cookieTimeout="30" cookiePath="/" cookieRequireSSL="false" cookieSlidingExpiration="true" cookieProtection="All" createPersistentCookie="false">
  <providers>
    <clear />
    <add name="MyRoleProvider" type="MyCompany.Core.Web.Providers.MyRoleProvider" connectionStringName="MainConnect" applicationName="MyApplication" />
  </providers>
</roleManager> 
```

**提琴手响应（标题）**：

```
HTTP/1.1 200 OK
Cache-Control: private, s-maxage=0
Content-Type: text/html; charset=utf-8
Content-Encoding: gzip
Vary: Accept-Encoding
Server: Microsoft-IIS/8.0
X-AspNetMvc-Version: 4.0
X-AspNet-Version: 4.0.30319
Set-Cookie: .ASPXROLES=; expires=Tue, 12-Oct-1999 05:00:00 GMT; path=/; HttpOnly
X-Powered-By: ASP.NET
Date: Mon, 31 Dec 2012 01:14:19 GMT
Content-Length: 1381 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-24T04:36:44.920

看看[这个答案](https://stackoverflow.com/a/3687937/2170958)。似乎表明只有提供者的 IsUserInRole 成员才会以这种方式缓存结果。检查用户角色时，ASP .NET MVC 似乎专门使用 GetRolesForUser。不久前我遇到了同样的限制——这是我添加到我的角色提供程序中的一些代码，以提供一个简单的缓存机制。

```
 public class MyRoleProvider : RoleProvider
 {
    private readonly string userRoleCacheKeyFormat;

    public MyRoleProvider()
    {
        userRoleCacheKeyFormat = this.Name + "_{0}";
    }

    public override string[] GetRolesForUser(string username)
    {
        return GetUserRoles(username);
    }

    private string[] GetUserRoles(string username)
    {
        string[] roleNames = null;

        if (!TryGetCachedUserRoles(username, out roleNames))
        {
            //cache miss
            roleNames = GetUserRolesFromStore(username);
        }

        return roleNames;
    }

    private bool TryGetCachedUserRoles(string username, out string[] userRoles)
    {
        string cacheKey = string.Format(userRoleCacheKeyFormat, username);
        HttpContext httpContext = HttpContext.Current;
        if (httpContext != null)
        {
            userRoles = (string[])httpContext.Cache.Get(cacheKey);
        }
        else { userRoles = null; }

        return (userRoles != null);
    }

    private void CacheUserRoles(string username, string[] userRoles)
    {
        string cacheKey = string.Format(userRoleCacheKeyFormat, username);
        HttpContext httpContext = HttpContext.Current;
        if (httpContext != null)
        {
            httpContext.Cache.Insert(cacheKey, userRoles, null, DateTime.UtcNow.AddMinutes(15), Cache.NoSlidingExpiration);
        }
    }

    private string[] GetUserRolesFromStore(string username)
    {
        MyDbContext db = MvcApplication.IoC.Resolve<MyDbContext>();

        string[] roleNames = db.Users
            .Single(u => u.Username == username)
            .UserRoles
            .Select(r => r.Name)
            .ToArray();

        CacheUserRoles(username, roleNames);

        return roleNames;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T21:36:40.180

我认为。该会话没有任何角色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-24T03:36:47.100

尝试 `createPersistentCookie="true"`

# z3 - Z3 返回未知

> ID：14096554
> 
> 赞同：1
> 
> 时间：2012-12-31T01:36:00.923
> 
> 标签：z3, smt

我有一组 Z3 无法应对的简单约束：

[http://pastebin.com/3eaLQ9wx](http://pastebin.com/3eaLQ9wx)

有没有办法调整约束以获得结果？这是一组更大的约束（数千个）的一个简单示例，但我不知何故感到困扰，即使在这样简单的示例上它也不起作用

提前致谢 ！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:09:55.610

您的问题具有非线性约束。虽然 Z3 在大多数情况下都可以处理它们，但`Int`s 和`Real`'s 的混合似乎使其超出了当前的能力。如果您只是将`Real`s 用于您的`s_0_1`等`s_0_2`变量，我相信 Z3 将能够解决问题。（你似乎有足够的价值约束，所以我相信不会有建模问题。）

我认为莱昂纳多多次表示，即将发布的版本将在存在非线性约束的情况下更好地支持组合理论。

# c# - C# 下载文件但端口不同

> ID：14096555
> 
> 赞同：0
> 
> 时间：2012-12-31T01:36:07.247
> 
> 标签：c#, webclient

在这里需要帮助，即使我搜索了解决方案，也遇到了这个错误，但仍然无法帮助我..

我想用HTTP协议下载文件，但使用不同的PORT，这意味着不使用端口80，而是使用5151等其他端口。代码在C#中运行良好，编译没有任何错误。在调试过程中，它说无法找到路径/URL，但路径/URL 在我的浏览器中使用端口 5151 工作正常（`http://localhost:5151`，工作得很好）..

有什么想法吗？

以下是代码，我应该添加任何遗漏吗？

```
client = new WebClient();
            try
            {
                client.DownloadFile(@""+httpAddr + ":5151/factionusers.log", "factionusers.log");
            }
            catch
            {
                client.DownloadFile(@""+httpAddr2 + ":5151/factionusers.log", "factionusers.log");
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T01:47:17.880

也许您在 httpAddr 变量中添加一个“/”。

```
static void Main()
    {
        string httpAddr = "http://192.168.56.101";
         var  client = new WebClient();
        try
        {
            client.DownloadFile(@"" + httpAddr + ":5151/readme.txt", "readme.txt");
        }
        catch
        {
            client.DownloadFile(@"" + httpAddr + ":5151/readme.txt", "readme.txt");
        }
    } 
```

在我的电脑中。进展顺利。

# vim - Vim 脚本意外行为

> ID：14096556
> 
> 赞同：3
> 
> 时间：2012-12-31T01:36:55.277
> 
> 标签：vim

我的 Vim 函数中有以下代码：

```
:$
set nomodified
:wincmd k 
```

它必须将光标移动到当前缓冲区的末尾，使其不可修改，然后将光标移动到另一个拆分。问题是它不会将光标移动到当前缓冲区的末尾。

当我评论最后一行时，它会移动光标。如何解决这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:43:30.493

```
:call cursor('$', 0)
:set nomodifiable
:wincmd k 
```

# api - 测试自动交易的平台？

> ID：14096561
> 
> 赞同：3
> 
> 时间：2012-12-31T01:37:49.793
> 
> 标签：api, platform, stock

a.) 是否有任何网站、工具等作为测试股票交易应用程序的平台？b.) 是否有任何平台 API 等允许自动交易？

有什么想法吗？

另外，我特别喜欢用 python 编码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T17:00:06.940

[Quantopian](https://www.quantopian.com/)是一个很好的解决方案。它允许您在大型数据集上上传和测试您的算法，同时保持它们的私密性或与社区共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T01:47:48.507

[RTS Realtime Systems](http://www.rtsgroup.net/trading)是一个著名的交易平台。不过，它是用 Java 编写的。

在搜索测试工具时，请尝试搜索术语回测和算法交易。我想出了这个结果：[PyAlgoTrader](http://gbeced.github.com/pyalgotrade/)

# android - 为什么MediaPlayer的onCompletionListener这么不靠谱？

> ID：14096563
> 
> 赞同：1
> 
> 时间：2012-12-31T01:38:22.863
> 
> 标签：android

我使用 MediaOnCompletionListener 来释放对象，所以它相当重要。但是，正如您从下面的 logcat 片段中看到的那样，它并不总是被触发！

```
12-30 17:24:41.448: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:24:41.638: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:24:41.818: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:24:49.866: I/myApp(5117): MediaOnCompletionListener triggered
12-30 17:24:50.136: I/myApp(5117): MediaOnCompletionListener triggered
12-30 17:24:50.186: I/myApp(5117): MediaOnCompletionListener triggered
12-30 17:24:55.902: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:24:56.152: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:24:56.322: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:24:56.552: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:25:04.340: I/myApp(5117): MediaOnCompletionListener triggered
12-30 17:25:04.560: I/myApp(5117): MediaOnCompletionListener triggered
12-30 17:25:04.670: I/myApp(5117): MediaOnCompletionListener triggered
12-30 17:25:04.910: I/myApp(5117): MediaOnCompletionListener triggered
12-30 17:25:37.312: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:25:37.592: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:25:37.773: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:25:37.953: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:25:46.161: I/myApp(5117): MediaOnCompletionListener triggered
12-30 17:25:46.351: I/myApp(5117): MediaOnCompletionListener triggered
12-30 17:26:09.423: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:26:35.108: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:26:42.215: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:26:50.594: I/myApp(5117): MediaOnCompletionListener triggered
12-30 17:27:17.059: I/myApp(5117): playSound(/mnt/sdcard/audio/clong-1.mp3 VolumePercent:100)
12-30 17:27:25.448: I/myApp(5117): MediaOnCompletionListener triggered 
```

我正在 Android 2.3.5 上测试这是一个已知问题吗？MediaPlayer 的可靠性是否在更高版本的 Android 上有所提高？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T05:51:53.283

不确定，但可能 [是垃圾收集原因：MediaPlayer finalized without being released](https://stackoverflow.com/questions/15023037/garbage-collection-causes-mediaplayer-finalized-without-being-released) 将提供线索。

人们发现，在某些情况下，玩家在发布之前会被垃圾收集。也许，已经收集垃圾的玩家不会调用 onCompletionListener 。

# apache - 释放这些端口好不好？

> ID：14096568
> 
> 赞同：-1
> 
> 时间：2012-12-31T01:39:44.707
> 
> 标签：apache, port

当我尝试从 Eclipse 启动 Apache 服务器时，我收到以下消息：

> 本地主机上的 Tomcat v6.0 服务器所需的几个端口（8085、8009）已在使用中。服务器可能已经在另一个进程中运行，或者系统进程可能正在使用该端口。要启动此服务器，您需要停止其他进程或更改端口号。

我发现端口是由操作系统使用“ `netstat -an`”打开的任何进程

我发现以下数据作为收听。

```
TCP    0.0.0.0:8009           0.0.0.0:0              LISTENING
TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING
TCP    0.0.0.0:8085           0.0.0.0:0              LISTENING
TCP    [::]:8009              [::]:0                 LISTENING
TCP    [::]:8080              [::]:0                 LISTENING
TCP    [::]:8085              [::]:0                 LISTENING 
```

我不知道这是否有用，或者我可以释放这个端口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:46:53.973

如果 tomcat 已经在运行，eclipse 会报告这个。如果 eclipse 崩溃，这可能会发生。

## 如果您的机器上只有一个 tomcat 实例

尝试停止它

```
bin/shutdown.sh 
```

或在窗户上

```
bin/shutdown.bat 
```

然后从eclipse重新启动tomcat。

## 在 Linux 上

您可以验证这些端口是否被另一个 tomcat（或已经在运行的相同）使用

```
netstat -anp #running as the superuser the -p option will say what the process is 
```

然后您可以检查进程表以交叉引用端口

```
ps aux | grep java 
```

或者

```
ps aux | grep 1234 #replacing 1234 with the PID reported by netstat 
```

如果它是tomcat，并且运行后不会关闭，`bin/shutdown.sh`则可以使用命令将其杀死`kill`。

## 如果您确实有其他东西正在使用这些端口

*   编辑 conf/server.xml
*   更改tomcat将使用的端口，尝试6080、6005等
*   再次从eclipse启动tomcat

# clojure - 评估这一行时，repl 中的 clojure 输出的含义是什么：(class (byte-array [(byte 0) (byte 1) (byte 2)]))？

> ID：14096575
> 
> 赞同：2
> 
> 时间：2012-12-31T01:41:42.390
> 
> 标签：clojure, bytearray

它只打印以下内容：[B

这是垃圾还是应该意味着什么？我意识到字节数组正在创建一个原始数组，所以可能会出现垃圾，因为本身没有类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T01:55:27.483

JVM用来`[`表示一个数组，后面是组件类型的类。对于原始类型`byte`，表示为单个字母`B`。有关此主题的一个（许多）讨论，请参阅[检索数组类名称。](https://stackoverflow.com/questions/7011067/retrieving-array-class-name)

# plugins - 在斐济的 jython 中将图像与 boxcar 内核进行卷积

> ID：14096576
> 
> 赞同：0
> 
> 时间：2012-12-31T01:41:42.847
> 
> 标签：plugins, jython, imagej

我正在尝试使用 jython 在斐济进行一些图像处理，但遇到了麻烦。我正在尝试开发一个插件，其中图像由 boxcar 内核卷积。通过录制宏，我得到以下可以粘贴到 jython 脚本中的内容：

运行（“卷积...”，“text1 = [0.04 0.04 0.04 0.04 0.04\n0.04 0.04 0.04 0.04 0.04\n0.04 0.04 0.04 0.04 0.04\n0.04 0.04 0.04 0.04 0.04.04\n0.04 0.04.0.04.0 \n]");

其中 text1 是用于卷积的字符串。但是，问题在于插件要求用户可以定义 boxcar 内核的大小。因此，我无法将其硬编码到脚本中。有谁知道如何进行。只要最终结果是 boxcar 卷积，我对替代方法持开放态度。

非常感谢您提前

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T10:58:49.560

[您可以在jython](/questions/tagged/jython "显示标记为“jython”的问题")中为给定的动态构造表示内核的字符串，`size`并将其作为参数传递给[imagej](/questions/tagged/imagej "显示标记为“imagej”的问题")。

```
args=split(getArgument);
kernel = args[0];
run("Convolve...", "text1=&kernel"); 
```

或者，`size`作为参数传递并使用[imagej](/questions/tagged/imagej "显示标记为“imagej”的问题")宏语言本身构造字符串。

```
args=split(getArgument);
size = args[0];
// for loop to create kernel
run("Convolve...", "text1=&kernel"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-16T14:51:47.380

多年后，但为了后代：

查看 ImageJ [API](https://imagej.nih.gov/ij/developer/api/ij/plugin/filter/Convolver.html)，您实际上可以使用必要的参数调用 Convolver() 类。

例如：

```
from ij import IJ
from ij import ImagePlus
from ij.plugin.filter import Convolver

imp = IJ.openImage("http://imagej.nih.gov/ij/images/blobs.gif")
ip = imp.getProcessor()
kernel = [1.0, 2.0, 1.0, 
          0.0, 0.0, 0.0, 
          -1.0, -2.0, -1.0]

Convolver().convolve(ip, kernel, 3, 3)

out = ImagePlus("convolved", ip)
out.show() 
```

从那里向用户询问输入内核列表应该是任意的。

# objective-c - NSXML Parser 和加载关卡 cocos2D

> ID：14096577
> 
> 赞同：0
> 
> 时间：2012-12-31T01:42:04.520
> 
> 标签：objective-c, cocos2d-iphone, xml-parsing

我正在尝试通过xml在objective-c中加载我的关卡。

这是我的关卡编辑器输出的 xml 样式。

```
 <level>
  <entity>
    <name>grey</name>
    <id>5</id>
    <body>false</body>
    <x>0.0</x>
    <y>0.0</y>
    <rotation>0.0</rotation>
  </entity>
 <entity>
    <name>grey</name>
    <id>5</id>
    <body>false</body>
    <x>0.0</x>
    <y>0.0</y>
    <rotation>0.0</rotation>
  </entity>
 </level> 
```

每个游戏对象在 XML 中被识别为自己的实体（在游戏中加载时的 Sprite）。因此，当解析发生时，每个实体或 CCSprite 都应该有自己的 x 和 y。

我希望解析器遍历 xml 文档，以便每个实体都有一个名称、x 和 y 以及旋转。其他元素我还不关心。

我已经尝试了几个小时来使用 NSXML 解析器启动和运行，但到目前为止还没有运气。这是我到目前为止所尝试的。

```
 NSString* currentElement;

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{

currentElement = elementName;

}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{

 if([currentElement isEqualToString:@"name"]){
     NSLog(@"Name found: %@", string);

 }

 } 
```

这适用于某些元素，但问题是发现字符被多次调用，有时名称字符串返回空白。

我想要做的是当找到一个元素“名称”时，我想调用一个方法，将当前实体添加到场景中，将“名称”、“X”和“Y”元素作为参数。

# php - 使用 swfupload 指定上传路径

> ID：14096583
> 
> 赞同：0
> 
> 时间：2012-12-31T01:42:53.907
> 
> 标签：php, swfupload

我正在使用 SwfUpload，我希望能够指定目标文件夹。现在我已经硬编码了最终目的地，但我希望能够即时控制它。有没有办法让 SwfUpload 将其提交到我的上传脚本？我尝试将它作为隐藏变量添加到显示上传器的表单中，但它没有添加到我的脚本中：

这是显示上传者的表单。页面的其余部分非常标准，所以我没有包括它。寻找隐藏字段“destinationpath”

```
<form id="form1" action="nowhere.html" method="post" enctype="multipart/form-data">
    <p>Select file to upload for program.
    </p>

        <div class="fieldset flash" id="fsUploadProgress">
        <span class="legend">Upload Queue</span>
        </div>
    <div id="divStatus">0 Files Uploaded</div>
        <div>
            <span id="spanButtonPlaceHolder"></span>
            <input id="btnCancel" type="button" value="Cancel All Uploads" onclick="swfu.cancelQueue();" disabled="disabled" style="margin-left: 2px; font-size: 8pt; height: 29px;" />
        </div>
    <input name="destinationpath" type="hidden" value="c:/DigitalMediaFiles/">
</form> 
```

然后在 upload.php 我检查它：

```
if (isset($_REQUEST["destinationpath"]))
    $save_path  = $_REQUEST["destinationpath"]; 
```

但它没有设置。我怀疑swf上传不提交表格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:27:34.803

如果您的目标文件夹与上传程序（客户端）无关，您可以在您的 php 脚本中执行此操作，而无需从客户端脚本中获取该变量。那就是通过 php 脚本将文件保存在目标目录中。

如果目标文件夹与每个客户端不同，您仍然可以将它们保存在同一目录中并使用您的 .htaccess 文件为每个客户端重写 url（使用客户端 ID）。在这种情况下，您需要保存在文件名的一部分中保留客户端 ID 的文件。您可以使用分隔符分解文件名。

如果您仍然需要按照您在问题中提到的方式执行此操作，只需在为 swfupload.js 文件编码的配置 js 文件中使用 post_params: {} 函数。在这种情况下 post_params: {} 函数将如下所示：

```
post_poarams: { 'your-variable-name-in-php-goes-here': 'value of this variable at this time goes here' }, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T17:53:54.960

方法是在 SWFSettings 对象的 post_params 中指定参数

post_params: { "destinationpath" : "C:\DigitalMediaFiles" },

我尝试使用 addPostParam() 但这对我不起作用。把它放在设置的 post_params 中。

# php - PHP中对象的破坏顺序是什么？

> ID：14096588
> 
> 赞同：28
> 
> 时间：2012-12-31T01:44:11.417
> 
> 标签：php, php-internals

对象解构的确切顺序是什么？

通过测试，我有一个想法：当前范围的 FIFO。

```
class test1
{
    public function __destruct()
    {
        echo "test1\n";
    }
}

class test2
{
    public function __destruct()
    {
        echo "test2\n";
    }
}

$a = new test1();
$b = new test2(); 
```

一次又一次产生相同的结果：

```
test1
test2 
```

[PHP 手册](http://php.net/manual/en/language.oop5.decon.php)含糊不清（强调我的以突出不确定性）：“只要**在关闭序列期间没有对特定对象的其他引用或以任何顺序**调用析构函数方法。”

解构的确切顺序是什么？谁能详细描述PHP使用的销毁命令的实现？而且，如果这个顺序在所有 PHP 版本之间不一致，任何人都可以查明哪些 PHP 版本按这个顺序更改？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-31T12:43:26.073

首先，这里介绍了一些关于一般对象销毁顺序的内容：[https ://stackoverflow.com/a/8565887/385378](https://stackoverflow.com/a/8565887/385378)

在这个答案中，我只关心在请求关闭期间对象仍然存在时会发生什么，即如果它们之前没有通过引用计数机制或循环垃圾收集器被销毁。

PHP 请求关闭在[`php_request_shutdown`](http://lxr.php.net/xref/PHP_TRUNK/main/main.c#1709)函数中处理。关机期间的第一步是调用已注册的关机函数并随后释放它们。如果其中一个关闭函数持有对某个对象的最后引用（或者如果关闭函数本身是一个对象，例如闭包），这显然也会导致对象被破坏。

关闭函数运行后，下一步是您感兴趣的：PHP 将运行[`zend_call_destructors`](http://lxr.php.net/xref/PHP_TRUNK/Zend/zend.c#919)，然后调用[`shutdown_destructors`](http://lxr.php.net/xref/PHP_TRUNK/Zend/zend_execute_API.c#211). 此函数将（尝试）分三个步骤调用所有析构函数：

1.  首先 PHP 会尝试销毁全局符号表中的对象。发生这种情况的方式很有趣，所以我复制了下面的代码：

    ```
    int symbols;
    do {
        symbols = zend_hash_num_elements(&EG(symbol_table));
        zend_hash_reverse_apply(&EG(symbol_table), (apply_func_t) zval_call_destructor TSRMLS_CC);
    } while (symbols != zend_hash_num_elements(&EG(symbol_table))); 
    ```

    该函数将*向后*`zend_hash_reverse_apply`遍历符号表，即从最后创建的变量开始，然后朝着最先创建的变量前进。在行走时，它将销毁所有引用计数为 1 的对象。执行此迭代，直到没有其他对象被它销毁。

     *所以这基本上做的是a）删除全局符号表中所有未使用的对象b）如果有新的未使用对象，也将它们删除c）等等。使用这种破坏方式，以便对象可以依赖于析构函数中的其他对象。这通常可以正常工作，除非全局范围内的对象具有复杂的（例如循环）相互关系。

    全局符号表的销毁与所有其他符号表的销毁有很大不同。通常，符号表会通过*向前*移动并删除所有对象的引用计数来破坏。另一方面，对于全局符号表，PHP 使用一种更智能的算法来尝试尊重对象依赖关系。* 
**   第二步是调用所有剩余的析构函数：

    ```
    zend_objects_store_call_destructors(&EG(objects_store) TSRMLS_CC); 
    ```

    这将遍历所有对象（按创建顺序）并调用它们的析构函数。请注意，这只调用“dtor”处理程序，而不是“free”处理程序。这种区别在内部很重要，基本上意味着 PHP 只会调用`__destruct`，但不会真正销毁对象（甚至更改其引用计数）。因此，如果其他对象引用了 dtored 对象，它仍然可用（即使已经调用了析构函数）。从某种意义上说，他们将使用某种“半毁”的对象（参见下面的示例）。

    *   如果在调用析构函数时停止执行（例如由于 a ），则**不会**调用`die`剩余的析构函数。相反，PHP 将标记对象已被破坏：

     **```
    zend_objects_store_mark_destructed(&EG(objects_store) TSRMLS_CC); 
    ```

    *这里的重要教训是，在 PHP中不一定要调用*析构函数。发生这种情况的情况相当罕见，但它可能会发生。此外，这意味着在此之后*将不再调用析构函数*，因此（相当复杂的）关闭过程的其余部分不再重要。在关闭期间的某个时刻，所有对象都将被释放，但由于已经调用了析构函数，这对于用户空间来说并不明显。*** 

 ***我应该指出，这是目前的关闭命令。这在过去发生了变化，将来可能会发生变化。这不是你应该依赖的东西。

### 使用已破坏对象的示例

这是一个示例，显示有时可以使用已调用其析构函数的对象：

```
<?php

class A {
    public $state = 'not destructed';

    public function __destruct() { $this->state = 'destructed'; }
}

class B {
    protected $a;

    public function __construct(A $a) { $this->a = $a; }

    public function __destruct() { var_dump($this->a->state); }
}

$a = new A;
$b = new B($a);

// prevent early destruction by binding to an error handler (one of the last things that is freed)
set_error_handler(function() use($b) {}); 
```

上面的脚本[将输出`destructed`](https://3v4l.org/VREes).

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-31T08:01:13.393

> 解构的确切顺序是什么？谁能详细描述PHP使用的销毁命令的实现？而且，如果这个顺序在任何和所有 PHP 版本之间不一致，任何人都可以确定这个顺序在哪些 PHP 版本中发生变化？

我可以以一种有点迂回的方式为你回答其中三个。

销毁的确切顺序并不总是很清楚，但在给定单个脚本和 PHP 版本的情况下始终是一致的。也就是说，使用相同参数运行并以相同顺序创建对象的相同脚本，只要它在相同 PHP 版本上运行，基本上将始终获得相同的销毁顺序。

关闭过程 - 当脚本执行停止时触发对象销毁的事情 -在*最近*发生了变化，至少两次以间接影响销毁顺序的方式发生了变化。这两个中的一个在我必须维护的一些旧代码中引入了错误。

大的又回到了 5.1。在 5.1 之前，用户的会话在关闭序列的最开始，在对象销毁之前被写入磁盘。这意味着会话处理程序可以访问对象方面留下的任何内容，例如自定义数据库访问对象。在 5.1 中，会话是在一次对象销毁*之后编写的。*为了保留以前的行为，如果写例程需要一个（全局）对象，您必须手动注册一个关闭函数（在销毁*之前*在关闭开始时按定义顺序运行）以便成功写入会话数据。

目前尚不清楚 5.1 的更改是有意的还是错误的。我见过两者都声称。

下一个变化是在 5.3 中，引入[了新的垃圾收集系统](http://php.net/manual/en/features.gc.php)。虽然关闭时的操作顺序保持不变，但*精确*的破坏顺序现在可以根据参考计数和其他令人愉快的恐怖而改变。

[NikiC 的答案](https://stackoverflow.com/a/14101767/168868)详细介绍了*当前*（在撰写本文时）关闭过程的内部实现。

再一次，这在任何地方都无法保证，并且*文档非常明确地告诉您永远不要承担销毁命令*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-18T13:22:06.813

对于任何有兴趣的人 - 如 PHP 8.0：

```
class A {

  function __destruct() {
    print get_class();
  }
}

class B {
  private $child;

  function __construct() {
    $this->child = new A();
  }

  function __destruct() {
    print get_class();
  }
}

class C {
  private $child;

  function __construct() {
    $this->child = new B();
  }

  function __destruct() {
    print get_class();
  }
}

new C; 
```

导致输出

```
CBA 
```

IE。包含对象析构函数在包含对象析构函数之前触发。

如果需要，可以颠倒顺序，即。为 ABC，将除 A（最内层）之外的所有析构函数更改为：

```
function __destruct() {
  unset($this->child);
  print get_class();
} 
```***

# java - 当父节点发生转换时拖动节点会导致节点消失

> ID：14096594
> 
> 赞同：6
> 
> 时间：2012-12-31T01:45:21.300
> 
> 标签：java, javafx-2

非常奇怪的问题，我终于设法将其提炼成一小段代码来演示该问题。我有一个窗格，其中包含 1 个组，该组包含一个包含一些省略号的组。顶部组应用了旋转变换。椭圆是可拖动的。

试试下面的例子，向下拖动一些椭圆（在组的范围之外），你会看到它们消失了。如果您最大化窗口，它们会再次出现，但您不能再拖动它们，它们不再接收任何事件。

现在对于真正奇怪的部分，我可以通过三种方法解决问题：

1.  不要应用变换
2.  删除一个椭圆（！？）（我尝试得到这个数字，11）
3.  在旁边启动 ScenicView**并**选择包含椭圆的组，这样您就可以看到该组的边界

我在这里完全不知所措，完全惊呆了。请问，有谁知道为什么会出现这个问题以及如何解决它？

代码（JavaFX 2.2.3 和 java 1.7.0_09 64 位 Windows 7）：

```
import javafx.application.Application;
import javafx.event.EventHandler;
import javafx.geometry.Point2D;
import javafx.scene.Group;
import javafx.scene.GroupBuilder;
import javafx.scene.Node;
import javafx.scene.Scene;
import javafx.scene.SceneBuilder;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.Pane;
import javafx.scene.shape.Ellipse;
import javafx.scene.shape.EllipseBuilder;
import javafx.scene.transform.Rotate;
import javafx.scene.transform.RotateBuilder;
import javafx.stage.Stage;

public class DragProblem extends Application {
public static void main(String[] args) {
    launch(args);
}

@Override
public void start(Stage primaryStage) {
    DrawingPane drawingPane = new DrawingPane();
    drawingPane.setStyle("-fx-background-color: darkgrey;");

    Scene scene = SceneBuilder.create().root(drawingPane).width(1280d).height(1024d).build();

    primaryStage.setScene(scene);
    primaryStage.show();
}

public class DrawingPane extends Pane {
    private Group transformedGroup;
    private Group splinePoints;

    public DrawingPane() {
        transformedGroup = GroupBuilder.create().id("transformedGroup").build();

        getChildren().add(transformedGroup);

        addPoints();
        makePointsDraggable();
    }

    public void addPoints() {
        double[] coords = new double[] {
                // comment any one the below x,y coordinates and the problem doesn't occur..
                239.28353881835938, 488.2192687988281,
                245.04466247558594, 505.30169677734375,
                258.56671142578125, 539.49462890625,
                267.2294006347656, 563.618408203125,
                282.89141845703125, 587.84033203125,
                309.6925048828125, 602.2174072265625,
                327.4945068359375, 616.4683227539062,
                345.25445556640625, 633.718994140625,
                371.0416259765625, 649.0819702148438,
                393.78704833984375, 667.402587890625,
                442.67010498046875, 676.0886840820312 };

        splinePoints = GroupBuilder.create().build();
        for (int i = 0; i < coords.length; i += 2) {
            Ellipse ellipse = EllipseBuilder.create().radiusX(3).radiusY(3).centerX(coords[i]).centerY(coords[i + 1]).build();
            splinePoints.getChildren().add(ellipse);
        }

        transformedGroup.getChildren().add(splinePoints);

        Rotate rotateTransform = RotateBuilder.create().build();
        rotateTransform.setPivotX(224);
        rotateTransform.setPivotY(437);
        rotateTransform.setAngle(15);

        // ..or comment this line to prevent the problem occuring
        transformedGroup.getTransforms().add(rotateTransform);
    }

    public void makePointsDraggable() {
        for (final Node n : splinePoints.getChildren()) {
            Ellipse e = (Ellipse) n;
            final NodeDragHandler ellipseDragHandler = new NodeDragHandler(e, transformedGroup);

            e.setOnMousePressed(ellipseDragHandler);
            e.setOnMouseDragged(ellipseDragHandler);
        }
    }
}

public class NodeDragHandler implements EventHandler<MouseEvent> {
    protected final Ellipse node;
    private final Node transformedGroup;

    private double initialX;
    private double initialY;
    private Point2D initial;
    private boolean dragStarted = false;

    public NodeDragHandler(Ellipse node, Group transformedGroup) {
        this.node = node;
        this.transformedGroup = transformedGroup;
    }

    @Override
    public void handle(MouseEvent event) {
        if (!dragStarted) {
            initialX = event.getScreenX();
            initialY = event.getScreenY();

            initial = transformedGroup.localToParent(new Point2D(node.getCenterX(), node.getCenterY()));

            dragStarted = true;
        } else {
            double xDragged = event.getScreenX() - initialX;
            double yDragged = event.getScreenY() - initialY;

            Point2D newPos = new Point2D(initial.getX() + xDragged, initial.getY() + yDragged);

            Point2D p = transformedGroup.parentToLocal(newPos.getX(), newPos.getY());

            node.setCenterX(p.getX());
            node.setCenterY(p.getY());
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:46:42.113

它已被确认为 JavaFX 中的一个错误，将在 2.2.6 中解决，请参见[此处](http://javafx-jira.kenai.com/browse/RT-27501)。我已经使用早期访问版本对其进行了测试，我可以确认它已经解决。

# javascript - 在一行中按 ID 选择多个元素

> ID：14096600
> 
> 赞同：4
> 
> 时间：2012-12-31T01:46:59.377
> 
> 标签：javascript

我想知道是否有更好/更清洁的方法来完成我在下面的代码中所做的事情。

```
var updateJob = function(){
    document.getElementById("jobDescription").style.display = "block";
    document.getElementById("updateButton").style.display = "block";
    document.getElementById("equipmentList").style.display = "block";
    document.getElementById("jobDesc").style.display = "block";
    document.getElementById("equipRan").style.display = "block";
} 
```

如果可能的话，我希望只有一行可以取消隐藏所有元素，但我已经尝试过`document.getElementById("jobDescription" + "updateButton" + etc...).style.display = "block";`了，但它不起作用。我是 JavaScript 新手。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T01:50:58.427

给所有需要的元素一个类并通过`getElementsByClassName(..)`.

（也许使用 jQuery 做同样的事情，痛苦少得多）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-31T01:50:08.103

你可以使用一个循环：

```
var elements = ['jobDescription', 'updateButton', 'equipmentList', 'jobDesc', 'equipRan'];

for(i = 0; i < elements.length; i++) {
   document.getElementById(elements[i]).style.display = "block";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-28T15:15:48.240

试试这个，我相信它适用于所有现代浏览器：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>For Loop Element</title>
</head>
<body>

    <div id="divOne">

        <p id="paraOne">It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
        <p id="paraTwo">Many desktop publishing packages and web page editors now use Lorem Ipsum as their default model text, and a search for 'lorem ipsum' will uncover many web sites still in their infancy. Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like).</p>
        <p id="paraTre">It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>

    </div>

    <div id="divTwo">Many desktop publishing packages and web page editors now use Lorem Ipsum as their default model text, and a search for 'lorem ipsum' will uncover many web sites still in their infancy. Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like).</div>

    <script>
            var allElem = document.querySelectorAll('#divOne, #paraOne, #paraTwo, #paraTre,#divTwo');
            console.log(allElem);

            for(var i = 0; i < allElem.length; i += 1)
            {
                allElem[i].style.border= '1px solid #002D55';
            }
    </script>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T01:50:38.113

试试这个：

```
var toggle = ["jobDescription","updateButton","equipmentList","jobDesc","equipRan"],
    l = toggle.length, i;
for( i=0; i<l; i++) document.getElementById(toggle[i]).style.display = "block"; 
```

或者，将所有这些元素放在一个容器中，然后切换它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T01:51:51.627

这不是一行可以完成的事情。然而，使用 jQuery 可以给元素一个类并使用一个漂亮的 jQuery 方法来操作它的样式。但是对于纯 JS，您可以使用字符串数组（id），对其进行迭代并使用这些 id 设置元素的样式。

```
[ 'jobDescription', 'updateButton', 'equipmentList',
  'jobDesc', 'equipRan' ].forEach(function( iden ) {

    document.getElementById( iden ).style.display = "block";

}); 
```

# android - Android 编程：在窗格上方添加 TextView

> ID：14096606
> 
> 赞同：1
> 
> 时间：2012-12-31T01:47:49.253
> 
> 标签：android

直到 12 小时前，我从未接触过 Android 编程甚至 XML。因此，我的问题可能显得非常愚蠢。

基本上我的“应用程序”（如果你可以这么称呼它的话）由一个选项卡式片段组成，紧挨着我的应用程序的“app_name”下方放置。

我想做的是在 app_name 正下方和（同时）在选项卡片段上方添加一些 STATIC 文本——我们正在谈论一个单一的文本“元素”，只是要清楚。到目前为止，我所尝试的一直是……不成功。基本上，我认为它会如下所示：

我的 main.xml 目前看起来像这样：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_width="fill_parent"
 android:layout_height="fill_parent"
 android:orientation="vertical" >

<TextView android:id="@+id/TextView01"
          android:layout_below="@+id/AnalogClock01"
          android:layout_width="wrap_content"
          android:text="@+id/TextView01" android:layout_height="wrap_content">
</TextView>
</LinearLayout> 
```

我相信 TextView 组件将是添加我想要的静态文本字段所需的所有 XML。随后我补充说：

```
TextView tv1 = (TextView) findViewById(R.id.TextView01);
tv1.setText("Additional information"); 
```

在调用 super.onCreate(savedInstanceState) 后立即到我的 MainActivity.java 文件，我的天真让我相信它应该工作，但显然它没有（实际上应用程序在加载到模拟器时崩溃）。

由于这不起作用，我的帖子的目的是希望让你们中的一个或多个提供解决方案来“解决”这个问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:53:50.827

您应该尝试使活动在一个活动中具有多个布局。

这可能会有所帮助：http: [//developer.android.com/guide/topics/ui/declaring-layout.html#Position](http://developer.android.com/guide/topics/ui/declaring-layout.html#Position)

也可以尝试 .onStart() 方法，虽然我不知道它是否会改变任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:57:15.503

> 随后我添加： ... MainActivity.java 文件在调用 super.onCreate(savedInstanceState) 后立即

如果你这样做，你就会有问题。

你需要添加

```
TextView tv1 = (TextView) findViewById(R.id.TextView01);
tv1.setText("Additional information"); 
```

**后** `setContentView(R.layout.main);`

首先，您需要提供`Activity`要显示的内容（UI）*，然后*您可以修改构成该 UI 的组件。

否则`findViewById()`会返回 null 并且你会得到`NullPointerException`s

其他一些需要注意的事项：

```
android:layout_below="@+id/AnalogClock01" 
```

1.  您没有在该布局中定义 AnalogClock01。如果它是在其他地方定义的，您*可能*不会使您的应用程序崩溃，但事情可能不会按预期工作。
2.  即使您在该布局中确实有 AnalogClock01，您也不会使用它来访问它，`@+id/`因为您没有分配 id，而是访问它。改为使用`@id/`。

和

```
android:text="@+id/TextView01" 
```

也是一个问题。

要从您的`res/values/strings.xml`文件中引用字符串，请使用`@string/string_name`No `+`，绝对不要使用`id`.

# javascript - 如何使用正则表达式提取三个文本字段？

> ID：14096607
> 
> 赞同：0
> 
> 时间：2012-12-31T01:47:55.070
> 
> 标签：javascript, regex

我需要从一段文本中提取 3 个字段。我有一个正则表达式，可以提取其中的 2 个字段 - 文件和扩展名。我不知道如何提取内容文本，也没有匹配除“非模式”之外的所有字符的策略。

模式是：`var regex_file = /<!--<\|(.*)\.(.*)\|>-->/g,`

另外，我不确定正则表达式是最好的方法。我考虑了字符串方法拆分：`split(regex_file)`

但我认为没有办法让分隔符保持分裂。它只是返回分隔符之间的内容。另外，我认为没有办法`split()`像我在`exec()`下面那样循环。

从以下结构中的文本中提取这 3 个字段的最佳方法是什么。下面是我到目前为止所拥有的。

**文本结构**

```
<!--<|file.extension|>-->

// 1-10k of content text

<!--<|file.extension|>-->

// 1-10k of content text

<!--<|file.extension|>-->

// 1-10k of content text 
```

**第一次尝试**

```
 /*addNodes
    **
    **
    **
    */
    function addNodes(text) {
        var regex_file = /<!--<\|(.*)\.(.*)\|>-->/g,
            arr_file;

        while ((arr_file = regex_file.exec(text)) !== null) {
            arr_file[1] // holds file 
            arr_file[2] // holds extension
            arr_file[3] // need content here
        }
    } 
```

**附加标准：**

IE10+、FF10+、Safari5+、Chrome20+...主要的现代浏览器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:41:29.503

是的，有一种方法可以循环`split()`。

使用java你可以这样做：

```
public static void main(String[] args) {
    String text = "<!--<|file.extension|>--> \n 1-10k of content text \n<!--<|file.extension|>--> \n 1-10k of content text \n<!--<|file.extension|>--> \n 1-10k of content text";
    String reg = "(?=\\n<!--<\\|[^<]*\\.[^>]*\\|>-->)";
    String[] split = text.split(reg);
    System.out.println(Arrays.toString(split));
} 
```

输出

```
[<!--<|file.extension|>--> 
 1-10k of content text , 
<!--<|file.extension|>--> 
 1-10k of content text , 
<!--<|file.extension|>--> 
 1-10k of content text] 
```

* * *

java脚本：

```
<html>
<body>
    <button onclick="myFunction()">Try it</button>
    <script>

    function myFunction(){
        var reg = /(?=\n<!--<\|[^<]*\.[^>]*\|>-->)/;
        var text = "<!--<|file.extension|>--> \n 1-10k of content text \n<!--<|file.extension|>--> \n 1-10k of content text \n<!--<|file.extension|>--> \n 1-10k of content text";
        var n= text.split(reg);
        alert(n);
    }
    </script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T03:15:05.707

你非常接近。分隔符可以用正则表达式保存：

```
s = "<!--<|file.extension|>--> // 1-10k of content text <!--<|file.extension|>--> // 1-10k of content text <!--<|file.extension|>--> // 1-10k of content text"
a = s.split(/<!--<\|([^.]*)(\.[^|]*)\|>-->/g)
for (i = 1; i < a.length; i += 3) {
  console.log('result:');
  console.log('  "'+a[i]  +'"');
  console.log('  "'+a[i+1]+'"');
  console.log('  "'+a[i+2]+'"');
} 
```

输出：

```
result:
  "file"
  ".extension"
  " // 1-10k of content text "
result:
  "file"
  ".extension"
  " // 1-10k of content text "
result:
  "file"
  ".extension"
  " // 1-10k of content text" 
```

我能够在 Windows 上成功手动测试 ie9、chrome23 和 osx10 上的 chrome23、safari6、ff6。

我还把它扔到了 browsershots.org 上，这些版本的执行成功了：

火狐：3.6.27 4.0.1 5.0.1 1.5.0.12 10.0.2 6.0.1 11.0 11.0 12.0 13.0 14.0.1 17.0 7.0.1 15.0 16.0 2.0.0.20 8.0.1 9.0.1 18.0 172.0 18.0 172.0 1.6.6 .1 10.0.2 17.0 6.0.2 7.0.1 8.0 12.0 14.0.1 13.0.1 4.0.1 15.0 5.0.1 3.0.10 19.0 18.0

微星：10.0

野生动物园：3.2.3 5.1.7 5.1.7 6.0 5.0

CHROME：7.0.517.44 23.0.1271.101 17.0.963.56 8.0.552.224 17.0.963.56 22.0.1229.26 23.0.1251.2 22.0.1312.45 9.0.597.45 9.0.597.107 11.0.696.77 10.0.612.1 12.0.742.112 13.0.782.18 14.0.835.202 15.0.874.106 18.0.874.106 18.0.835.202 15.0.835.202 15.0.874.106 18.0.835.202 15.0.874.191112 19.0.1041.0 20.0.1132.57 21.0.1180.89 24.0.1312.45 23.0.1271.97 16.0.912.77 2.0.172.31 6.0.472.63

它不成功： chrome 20.0.1132.47 on ubuntu-12.04-lts

或 msie < 10 的版本

# css - 如何使用 CSS 将字体颜色从 li:hover 应用到内部链接文本

> ID：14096613
> 
> 赞同：0
> 
> 时间：2012-12-31T01:49:37.933
> 
> 标签：css, html, unobtrusive-javascript

```
<!DOCTYPE html>
<html lang="fr">
<head>
    <style>
        aside#_left{
            width:239px;
            margin-left:0px;
            margin-right:1px;
            display:inline;
            position:fixed;
        }
        #content{
            padding-top:70px;
            padding-left:225px;
        }

        .menu01{
            background-color:#827F80;
            width:80%;
        }

        ul#nav{
            color:#6E7377;
            list-style-type:none;
            line-height:200%;
            padding-top:5px;
            padding-bottom:10px;
            margin:0px;
            padding:0px;
            text-align:center;
        }

            ul#nav li:hover{
                cursor:pointer;
                border-top:1px solid #7a9bb6;
                border-bottom:1px solid #7a9bb6;
                background:#5482a0;
            }

            #nav a:link{
                color:#6E7377;
                text-decoration:none;
                font-weight:bolder;
            }

            #nav a:hover{
                color:#78C6FF;
            }

            #nav li * {
                color: inherit;
            }

            #nav li:hover * {
                color: inherit;
                color:#78C6FF;
            }
    </style>
</head>
<body>
    <aside id="_left">
        <img src="images/logo.png" />
        <nav class="menu01">
            <ul id="nav">
                <li><a href="#">Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit...</a></li>
                <li><a href="#">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</a></li>
                <li><a href="#">Etiam interdum egestas nulla, ac dignissim urna suscipit non.</a></li>
            </ul>
        </nav>
    </aside>
    <div id="content">
        <p>
            Cras at dapibus mi. Vestibulum quis odio odio, a scelerisque mauris. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; 
            Ut ornare convallis elementum. Vivamus tincidunt malesuada lacus nec lacinia. Vestibulum lorem tortor, gravida sed convallis nec, dapibus ut leo. Donec id posuere leo. 
            Cras quis ante et dolor dictum euismod.
        </p>
    </div>
</body>
</html> 
```

我想要的只是从 li:hover 填充链接字体颜色。我怀疑我太疯狂了...

基本上，当鼠标移到旁边的导航面板上时，我希望它里面的文本发生变化，不管里面有什么元素，比如`<a>`.

更新：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：：： ::::::::::::::::::: 状态：已完成，代码已更新

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:56:55.850

这取决于元素内部的`li`元素，但假设您知道它们是什么（在这种情况下`a`）：

```
#nav li:hover a {
     color: inherit;
} 
```

尽管取决于`a:link`,和states 的定义方式，其他选择器的特殊性可能会覆盖此声明`a:visited`。`a:hover``a:active`

为了不那么精确，您可以使用`*`通配符选择器：

```
#nav li:hover * {
     color: inherit;
} 
```

但是，同样，这可能会被其他地方定义的其他更具体的选择器否决（尤其是在使用 an 时`id`）。

# .net - 使用 TPL 数据流创建消息总线

> ID：14096614
> 
> 赞同：5
> 
> 时间：2012-12-31T01:49:45.447
> 
> 标签：.net, task-parallel-library, tpl-dataflow

我一直在寻找一个轻量级的、进程中的异步消息总线，并遇到了 TPL 数据流。

我当前的实现如下（完整示例位于[https://gist.github.com/4416655](https://gist.github.com/4416655)）。

```
public class Bus
{
    private readonly BroadcastBlock<object> broadcast =
        new BroadcastBlock<object>(message => message);

    private readonly ConcurrentDictionary<Guid, IDisposable> subscriptions
        = new ConcurrentDictionary<Guid, IDisposable>();

    public Task SendAsync<TMessage>(TMessage message)
    {
        return SendAsync<TMessage>(message, CancellationToken.None);
    }

    public Task SendAsync<TMessage>(TMessage message, CancellationToken cancellationToken)
    {
        return broadcast.SendAsync(message, cancellationToken);
    }

    public Guid Subscribe<TMessage>(Action<TMessage> handlerAction)
    {
        var handler = new ActionBlock<object>(message => handlerAction((TMessage)message));

        var subscription = broadcast.LinkTo(handler, 
            new DataflowLinkOptions { PropagateCompletion = true }, 
            message => message is TMessage);

        return AddSubscription(subscription);
    }

    public void Unsubscribe(Guid subscriptionId)
    {
        IDisposable subscription;
        if (subscriptions.TryRemove(subscriptionId, out subscription))
        {
            subscription.Dispose();
        }
    }

    private Guid AddSubscription(IDisposable subscription)
    {
        var subscriptionId = Guid.NewGuid();
        subscriptions.TryAdd(subscriptionId, subscription);
        return subscriptionId;
    }
} 
```

我有一些关于在消息传递场景中使用 TPL 数据流的一般性问题。

*   是否`BroadcastBlock<T>`推荐同时向多个处理程序发送消息的来源？这是我根据[这篇文章](http://weblogs.asp.net/mjarguello/archive/2011/03/14/asynchronous-in-c-5-part-ii.aspx)得出的结论。
*   在我的实现中，我对所有消息类型使用单个`BroadcastBlock<T>`实例。在处理大量消息时这会导致问题吗？我应该为每种消息类型创建一个单独的实例吗？
*   `BroadcastBlock<T>`始终存储最后发送的项目。这意味着任何新的订阅（链接）都将自动传递此消息。有可能改变这种行为（新订阅应该只接收*新消息*）。
*   在我的测试应用程序中，我在第一个处理程序中引入了延迟：

    ```
     // Subscribe to Message type
        var subscription1 = bus.Subscribe<Message>(async m => { 
            await Task.Delay(2000);
            Console.WriteLine("{0} Handler 1: {1}.", m.TimeStamp, m.Content);
        }); 
    ```

    ~~发送消息时，我希望看到每条消息一一输出到控制台，增量为 2s。相反，在 2 秒后，所有消息都立即输出。我假设这是由于底层调度程序执行的并行性，但我很好奇如何更改这些设置（设置`MaxDegreeOfParallelism = 1`没有区别）。~~

*   最后，虽然`SendAsync`允许我等待消息的*发送*，但它不允许我等待目标（的`ActionBlock<T>`）完成。我认为这是`PropagateCompletion`会做的，但似乎并非如此。理想情况下，我想知道消息的所有处理程序何时执行。

### 更新

我没有得到预期行为的原因`Task.Delay`是这延迟了*每个*处理程序的执行，而不是*所有*处理程序的处理。`Thread.Sleep`是我需要的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T16:44:50.697

在回答了您的问题（见下文）后，我意识到使用 TPL 数据流块对您的设计进行建模可能不是一个好主意。TDF 有利于通过很大程度上独立的块来处理消息，而没有内置的方法来跟踪单个消息。但这似乎是您想要的：由处理程序*按顺序*处理消息，并跟踪每条消息的完成情况。

因此，我认为您不应该创建一个完整的数据流网络，而应使用单个`ActionBlock`作为异步消息处理器：

```
public class Bus
{
    class Subscription
    {
        public Guid Id { get; private set; }
        public Func<object, Task> HandlerAction { get; private set; }

        public Subscription(Guid id, Func<object, Task> handlerAction)
        {
            Id = id;
            HandlerAction = handlerAction;
        }
    }

    private readonly ConcurrentQueue<Subscription> m_handlersToSubscribe = new ConcurrentQueue<Subscription>();
    private readonly ConcurrentQueue<Guid> m_idsToUnsubscribe = new ConcurrentQueue<Guid>();

    private readonly ActionBlock<Tuple<object, Action>> m_messageProcessor;

    public Bus()
    {
        // subscriptions is accessed only from the (single-threaded) ActionBlock, so it is thread-safe
        var subscriptions = new List<Subscription>();

        m_messageProcessor = new ActionBlock<Tuple<object, Action>>(
            async tuple =>
            {
                var message = tuple.Item1;
                var completedAction = tuple.Item2;

                // could be made more efficient, probably doesn't matter
                Guid idToUnsubscribe;
                while (m_idsToUnsubscribe.TryDequeue(out idToUnsubscribe))
                {
                    subscriptions.RemoveAll(s => s.Id == idToUnsubscribe);
                }

                Subscription handlerToSubscribe;
                while (m_handlersToSubscribe.TryDequeue(out handlerToSubscribe))
                {
                    subscriptions.Add(handlerToSubscribe);
                }

                foreach (var subscription in subscriptions)
                {
                    await subscription.HandlerAction(message);
                }

                completedAction();
            });
    }

    public Task SendAsync<TMessage>(TMessage message)
    {
        var tcs = new TaskCompletionSource<bool>();
        Action completedAction = () => tcs.SetResult(true);

        m_messageProcessor.Post(new Tuple<object, Action>(message, completedAction));

        return tcs.Task;
    }

    public Guid Subscribe<TMessage>(Action<TMessage> handlerAction)
    {
        return Subscribe<TMessage>(
            message =>
            {
                handlerAction(message);
                // we need a completed non-generic Task; this is a simple, efficient way to get it
                // another option would be to use async lambda with no await,
                // but that's less efficient and produces a warning
                return Task.FromResult(false);
            });
    }

    public Guid Subscribe<TMessage>(Func<TMessage, Task> handlerAction)
    {
        Func<object, Task> actionWithCheck = async message =>
        {
            if (message is TMessage)
                await handlerAction((TMessage)message);
        };

        var id = Guid.NewGuid();
        m_handlersToSubscribe.Enqueue(new Subscription(id, actionWithCheck));
        return id;
    }

    public void Unsubscribe(Guid subscriptionId)
    {
        m_idsToUnsubscribe.Enqueue(subscriptionId);
    }
} 
```

（我决定使用队列来订阅和取消订阅，以便处理消息时处理程序列表不会改变。）

## 回答您的问题

> 是否`BroadcastBlock<T>`推荐同时向多个处理程序发送消息的来源？

是的，乍一看，这听起来像是`BroadcastBlock<T>`你想要的。在 TPL 数据流中肯定没有任何类似的块。

> 在我的实现中，我对所有消息类型使用单个 BroadcastBlock 实例。在处理大量消息时这会导致问题吗？我应该为每种消息类型创建一个单独的实例吗？

对于所有消息类型使用单个块，您可以在单个线程上完成更多工作（发送到所有处理程序）。对于每种消息类型使用一个块，您将做更少的工作（仅发送到正确的处理程序），这些工作可以在多个线程上执行。因此，我认为假设后者会更快是合理的。

但不要忘记应用程序性能优化的规则：首先，编写简单易读的代码。仅当事实证明它实际上很慢时，才尝试对其进行优化。并且在比较两种替代方案时，始终使用分析来确定哪个实际上更快，不要只是猜测哪个应该更快。

> `BroadcastBlock<T>`始终存储最后发送的项目。这意味着任何新的订阅（链接）都将自动传递此消息。是否可以改变这种行为（新订阅应该只接收*新消息*）？

不，没有办法配置`BroadcastBlock<T>`来做到这一点。如果您不需要`BroadcastBlock<T>`（发送到容量有限的块，可能暂时已满，支持非贪婪块作为目标）的所有功能，您可能需要编写一个自定义版本`BroadcastBlock<T>`来执行此操作。

> 发送消息时，我希望看到每条消息一一输出到控制台，增量为 2s。相反，在 2 秒后，所有消息都立即输出。我假设这是由于底层调度程序执行的并行性，但我很好奇如何更改这些设置（设置`MaxDegreeOfParallelism = 1`没有区别）。

TDF的一个特点就是每个block都是独立的，所以多个block可以在多个线程上执行。如果这不是您想要的，那么可能`ActionBlock<T>`为每个处理程序单独使用可能不是最佳解决方案。事实上，TDF 可能根本不是最好的解决方案。

此外，`Subscribe()`接受`Action<TMessage>`，这意味着您的 lambda 将被编译为`async void`方法。这些应该只在特定（且相对罕见）的情况下使用，在这种情况下您没有其他选择。如果你想支持`async`处理程序，你应该接受`async Task`方法，即`Func<TMessage, Task>`.

> 我没有得到预期行为的原因`Task.Delay`是这延迟了*每个*处理程序的执行，而不是*所有*处理程序的处理。`Thread.Sleep`是我需要的。

使用`Thread.Sleep()`与异步的整个想法背道而驰，如果可能的话，你不应该使用它。另外，我认为它实际上并没有按照您想要的方式工作：它为每个线程引入了延迟，但是 TPL Dataflow 将使用多个线程，因此这不会像您预期的那样运行。

> 最后，虽然`SendAsync`允许我等待消息的发送，但它不允许我等待目标（的`ActionBlock<T>`）完成。我认为这是`PropagateCompletion`会做的，但似乎并非如此。理想情况下，我想知道消息的所有处理程序何时执行。

`PropagateCompletion``Complete()`,和一起`Completion`用于处理整个块的完成，而不是处理单个消息。原因之一是更复杂的数据流网络，可能不清楚何时处理消息。例如，如果一条消息已经发送到 a 的所有当前目标`BroadcastBlock<T>`，但也将发送到所有新添加的目标，那么它是否应该被认为是完整的？

如果你想这样做，你将不得不以某种方式手动进行，可能使用[`TaskCompletionSource`](http://msdn.microsoft.com/en-us/library/dd449174.aspx).

# c# - 保留已处理的记录

> ID：14096615
> 
> 赞同：0
> 
> 时间：2012-12-31T01:49:46.997
> 
> 标签：c#, sqlite, persistence

我有一个 ac# 进程，它使用 TPL 对队列进行并行处理。在处理完每条记录后，我想为每条处理的记录 ID 建立一个物理记录，这样如果处理失败或中断，我可以确保不再处理该记录。*必须只处理一次记录。*

我尝试将记录 ID 序列化为一个简单的文本文件和一个 Sqlite 表。在这两种情况下，保存这些小记录 ID（Guid）的时间占记录本身总处理时间的 50%。我什至尝试过使用开放的 Sqlite 连接和参数化的插入查询来进行插入，所以我没有打开/关闭数据库文件，也没有更好的办法。

我的问题是，我怎样才能以持久的方式维护一个 Guid 列表（可能是 1000-2000 个），这样如果我的进程死了，我会保存它们，以便我可以从中断的地方继续？只要速度快，我愿意尝试任何事情，并且如果服务器重新启动或进程被终止，我仍然会在那里。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:59:00.313

任何持久性足以在重新启动后幸存下来的东西都必须迟早（最好更早）写入磁盘。

这意味着您已经几乎枚举了您的选择。

您必须问的下一个问题是验证记录是否已被处理的费用是多少，以及最终用户无意中删除跟踪机制的危险级别是多少。

如果您只是将信息写入文本文件，它应该是快速写入，但读取速度较慢（除非您缓存信息）并且用户删除文件的可能性相当高。

如果您使用任何类型的数据库，写入应该仍然相当快，检索应该比文本文件更快，并且用户删除存储机制的可能性要低得多。

基于这些因素，我强烈推荐某种数据库。我会对几个不同的数据库进行建模（或研究）以提高性能，看看哪个数据库性价比最高，这应该包括实施、部署和维护的成本。

# ftp - ftp客户端，恢复中断传输

> ID：14096629
> 
> 赞同：1
> 
> 时间：2012-12-31T01:53:24.257
> 
> 标签：ftp, erlang

谁能告诉我默认的 erlang ftp 模块是否`erlang/lib/inets-5.9.1/src/ftp/ftp.erl`支持恢复中断传输？

如果没有，我自己修改是否困难，或者现在是否有人进行修改工作？

# c++ - 使用 C++ 库时如何避免包含相同的代码？

> ID：14096631
> 
> 赞同：7
> 
> 时间：2012-12-31T01:53:49.250
> 
> 标签：c++, linker, include, static-libraries

*编辑：我知道包含警卫，但包含文件**不是**这里的问题。我说的是实际编译并已链接到静态库中的代码。*

我正在用 C++ 为自己创建一个通用实用程序库。

我正在创建的函数之一，`printFile`， requires `string`，`cout`以及标准库的其他此类成员。

我担心当库被编译，然后链接到另一个也使用`string`and的项目时，和`cout`的代码将被复制：它都将在程序链接的库二进制文件中预先链接，并且它将是再次与使用它们本身的项目相关联。`string``cout`

该库的结构如下：

1.  `libname.hpp`使用该库的程序员应该`#include`在他的项目中使用一个文件。
2.  `fname`对于在 中声明的每个函数`libname.hpp`，都有一个`fname.cpp`实现它的文件。
3.  所有`fname.cpp`文件也`#include "libname.hpp"`.
4.  库本身编译成`libname.a`复制到`/usr/lib/`.

这甚至会发生吗？
如果是，这是否有问题？
如果是，那么我该如何避免这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:05:22.013

> 我担心当编译库，然后链接到另一个也使用字符串和 cout 的项目时，字符串和 cout 的代码会重复

别担心：没有现代编译系统可以做到这一点。模板函数的代码被发送到目标文件中，但链接器会丢弃重复的条目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T02:10:36.620

标准 C++ 库的库定义不会出现在您自己的静态库中，除非您在其中明确包含它们（即，您从标准 C++ 库中提取目标文件并将它们包含到您的库中）。静态库根本没有链接，只会对其他库有未定义的引用。静态库只是定义库提供的符号的目标文件的集合。来自标题的定义，例如内联函数和模板实例化，将以这样一种方式定义，即多个翻译单元中的多个定义不会发生冲突。如果代码实际上没有内联，它将定义“弱”符号，导致在链接时忽略或删除重复项。

唯一真正关心的是链接到可执行文件的库需要使用兼容的库定义。由于头文件中有大量代码，因此 C++ 头文件的更改相对频繁，包括标准 C++ 库头文件（相对于包含更少代码的 C 库头文件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T02:03:43.933

是的，标准库的代码将被复制。例如，如果您返回 std::string 或在其中一种方法中将其作为参数，则可能会出现问题。它在您的标准库实现中的布局可能与用户的不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T03:54:57.533

这在实践中很少出现问题。

对于`static`头文件中定义的函数和内联模板函数，无需担心：每个编译单元都有自己的副本（例如，在`.a`库中可能已经有许多匿名副本）。这没关系，因为这些定义没有被导出，所以链接器不需要担心它们。

对于使用非静态链接声明的函数，是否有问题取决于链接`.a`库的方式。

构建库时，通常*不会*在标准 C++ 库中进行链接。创建的库将包含对标准 C++ 库的未定义引用。这些必须在构建最终的可执行二进制文件之前解决。这通常在以默认方式链接最终二进制文件时自动完成（取决于编译器）。

There are times when people do link in the standard C++ library into a static library. If you're linking against multiple static libraries that each embed another library (like the standard C++ library), then expect trouble if there are any differences in those embedded libraries. Fortunately, this is a rare problem, at least with the `gcc` toolchain. It's a [more frequent problem](https://stackoverflow.com/a/757537/25050) with Microsoft's tools.

In some cases, a workaround is to make one or more conflicting static libraries into a dynamic library. This way each of these dynamic libraries can statically link its own copy of the problematic library. As long as the dynamic library doesn't export the symbols from the problematic library and there are no memory layout incompatibilities, there generally isn't any trouble.

# jquery - 更改为 davis.js 路由库

> ID：14096633
> 
> 赞同：-1
> 
> 时间：2012-12-31T01:54:17.597
> 
> 标签：jquery

我使用 pushstate/popstate 构建了一个演示，但我想知道**Davis.js js 路由库如何在这里使用，有人可以帮我看看下面的例子吗？**
谢谢！！

**使用 davis.js** index.php

```
print"<a class=\"a\" href=\"$result[id]\"></a>";
if($_GET['id']){
    if(isset($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest'){
        print"
            <div class=\"wrapb\">
                <div class=\"b\"></div>
                <div class=\"close\"></div>
            </div>
        ";
    }
} 
```

js

```
var app = Davis(function(){
    this.get('?id=:name', function(req){
        var b = $(req).filter('.wrapb').html();
            $('.a').before(b);
            $('.close').click(function(){
                history.back();
            });
    })
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T13:31:07.520

我认为这应该做你想要达到的目标：

```
var app = Davis(function () {
  this.get('/', function (req) {
    var xhr = $.ajax('/', {
      data: { id: req.params.id },
      dataType: 'html'
    })

    xhr.then(function (data) {
      var html = $(data)

      html.find('.close').on('click', function () {
        history.back()
      })

      $('.a').before(html)
    })
  })
}) 
```

产生给路由处理程序的`req`对象不是 ajax 请求，它是表示对路径的“请求”的对象，在这种情况下`/`，更多来自[docs](http://olivernn.github.com/davis.js/docs/#Request)。

当在路由回调中单击链接时，您必须做任何您希望发生的工作，在您的情况下，您似乎想向服务器发出请求，该服务器将以一段 html 响应（我不是PHP 开发人员，所以这可能是错误的）。然后，您希望将此 html 附加到当前文档中的链接之后。

Davis 的设计不允许基于查询参数进行路由，因此您不应在路径定义中使用它们，因此我将其更改为`/`.

# android - SearchView 的可搜索配置返回 Null

> ID：14096641
> 
> 赞同：4
> 
> 时间：2012-12-31T01:56:51.930
> 
> 标签：android, searchable, searchview, oncreateoptionsmenu

我创建了一个搜索界面，但似乎无法将其连接`SearchView`到`ActionBar`我的可搜索配置文件。当我尝试在我的`onCreateOptionsMenu`方法中检索它时`SearchManager.getSearchableInfo(getComponentName()`返回 null。有人可以帮我解决这个问题吗？

**Settings.onCreateOptionsMenu(菜单)**

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.activity_main, menu);

    SearchManager sm = (SearchManager) getSystemService(Context.SEARCH_SERVICE);
    SearchView sv = (SearchView) menu.findItem(R.id.menu_search).getActionView();
    SearchableInfo info = sm.getSearchableInfo(getComponentName()); //This variable is returned as null                                                      
    sv.setSearchableInfo(info);
    sv.setIconifiedByDefault(false);
    sv.setSubmitButtonEnabled(true);
    return true;
} 
```

**AndroidManifest.xml 中的设置活动**

```
<activity
        android:name=".Settings"
        android:label="@string/app_name"
        android:screenOrientation="portrait" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>

        <meta-data
            android:name="android.app.searchable"
            android:resource="@xml/searchable" />
    </activity> 
```

**AndroidManifest.xml 中的可搜索活动**

```
 <activity
        android:name=".ImageSearch"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.SEARCH" />
        </intent-filter>
    </activity> 
```

我的菜单 xml 文件中有标题`<?xml version="1.0" encoding="utf-8"?>`，我尝试清理项目。他们似乎都没有成功。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-01T00:19:20.643

好吧，那算了。经过一番研究，我发现用于创建搜索界面的 android 文档并不完整：有些东西被遗漏了，比如

1) 在可搜索的配置中不应硬编码任何字符串

2）我应该在`<activity>`搜索中包含此代码：

```
 <meta-data
            android:name="android.app.searchable"
            android:resource="@xml/your search configuration file's name" /> 
```

`<activity>`3）我也应该在我希望出现的地方`SearchView`有这个代码`ActionBar`

```
 <meta-data
            android:name="android.app.default_searchable"
            android:value=".ActivityWhichCarriesOutTheSearch" /> 
```

为了完成：这是我的清单文件，它有效：

```
<application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:supportsRtl="false"
        android:theme="@style/AppTheme">
    <activity
            android:name=".MainActivity"
            android:label="@string/app_name"
            android:theme="@style/AppTheme.NoActionBar">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
        <meta-data
                android:name="android.app.default_searchable"
                android:value=".SearchActivity" />
    </activity>
    <activity android:name=".SearchActivity"
            android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.SEARCH" />
        </intent-filter>
        <meta-data android:name="android.app.searchable"
                android:resource="@xml/searchable"/>
    </activity>
</application> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-10T05:53:40.090

如果您在 mainactivity 中扩展ActionBarActivity ，那么在您的**menu_item****中**，您必须将您的 searchview 类型转换为

 **```
"android.support.v7.widget.SearchView" 
```

我也遇到了同样的错误，我解决了：谢谢....

```
<item android:id="@+id/search"
android:title="Search for coupons,deals,stores,etc....."
android:icon="@drawable/ic_search"
app:showAsAction="always"
app:actionViewClass="android.support.v7.widget.SearchView" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-03T14:47:56.400

当我没有执行搜索的活动时，我使用 android:launchMode="singleTop" 属性。元数据如下所示：

```
<activity android:name=".Activities.Account" android:label="Личный кабинет абонента"
          android:screenOrientation="portrait"
          android:launchMode="singleTop"
        >
    <meta-data android:name="android.app.searchable"
               android:resource="@xml/searchable"/>
    <intent-filter>
        <action android:name="android.intent.action.SEARCH" />
    </intent-filter>
</activity> 
```**

# c# - 我怎样才能让我的通用方法起作用？

> ID：14096643
> 
> 赞同：1
> 
> 时间：2012-12-31T01:56:58.023
> 
> 标签：c#, generics, lambda, expression, extension-methods

我正在为我的 WPF viewModel 基类编写一个小扩展，它允许我以比在 getter 中引发多个`PropertyChanged`事件的标准方法更简洁的方式定义属性之间的依赖关系：

所以而不是：

```
public int ThisProperty
{  
    get
    {
        thisProperty = value;
        RaisePropertyChangedEvent("ThisProperty");
        RaisePropertyChangedEvent("FirstDependentProperty");
        RaisePropertyChangedEvent("SecondDependentProperty");
    }
} 
```

我希望能够在我的 ViewModels 构造函数中做这样的事情：

```
RegisterDependencies("This Property", 
    "FirstDependentProperty", "SecondDependentProperty"); 
```

我在 viewModel 中定义了以下方法（删除了错误检查以减少代码量）：

```
public void RegisterDependencies(string property, params string[] dependencies)
{
    foreach (string item in dependencies)
    {
        IList<string> deps;
        if (dependenciesList.TryGetValue(item, out deps))
        {
            if (!deps.Contains(property))
            {
                deps.Add(property);
            }
        }
        else
        {
            deps = new List<string>();
            deps.Add(property);
            dependenciesList[item] = deps;
        }
    }
} 
```

`PropertyChanged`我的视图模型使用以下方法订阅事件：

```
void ViewModel_PropertyChanged(object sender, PropertyChangedEventArgs e)
{
    IList<string> dependencies;
    if (dependenciesList.TryGetValue(e.PropertyName, out dependencies))
    {
        foreach (string item in dependencies)
        {
            RaisePropertyChangedEvent(item);
        }
    }
} 
```

这只是检查属性是否有任何依赖关系，如果有，`PropertyChanged`也会为这些属性引发事件。这一切都很好，到目前为止一切都很好。

我真正想要的是使用 lambda 表达式而不是字符串，以便我获得自动完成和更好的重构支持。我所追求的是这样的：

```
RegisterDependencies<ViewModelType>(p => p.Property, 
    p => p.FirstDependency,
    p => p.SecondDependency); //and so on... 
```

我重新定义了方法签名，如下所示：

```
public void RegisterDependencies<T>(Expression<Func<T, object>> property, 
    prams Expression<Func<T, object>>[] dependencies)
    {
    } 
```

目前，该方法只是尝试将表达式转换为字符串，这就是我要解决的问题。我不确定如何从表达式中获取属性的名称并将其转换为字符串。

Josh Smith 的 MVVM Foundation 包含一个名为的类`PropertyChangedObserver`，它有一段代码可以做到这一点，我试图对其进行调整以适应我的示例：

```
private static string GetPropertyName<T>(Expression<Func<T, object>> expression)
{
    var lambda = expression as LambdaExpression;

    MemberExpression memberExpression;
    if (lambda.Body is UnaryExpression)
    {
        var unaryExpression = lambda.Body as UnaryExpression;
        memberExpression = unaryExpression.Operand as MemberExpression;
    }
    else
    {
        memberExpression = lambda.Body as MemberExpression;
    }

    return memberExpression != null ? ((PropertyInfo)memberExpression.Member).Name : null;
} 
```

这是在我更新`RegisterDependencies`的方法中调用的（这实际上是目前该方法的整个代码）：

```
string propertyName = GetPropertyName(property);

foreach (Expression<Func<T, object>> expr in dependencies)
{
    string dependencyName = GetPropertyName(expr);
} 
```

当它运行时，它会产生一个`XamlParseException`. 这很难调试，因为它不会抛出标准异常窗口。Visual Studio 的输出窗口提供了更多信息，似乎最初的异常是 a`InvalidCastException`虽然我不确定为什么因为两个表达式属于同一类型。

任何人都可以阐明并帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:33:11.533

按照 Matti Virkkunen 的评论，Member 属性返回一个可以表示属性或字段的 MemberInfo 对象。如果这是您的问题，请不要担心；Name 属性实际上是 MemberInfo 类的成员，因此无需强制转换为 PropertyInfo。

如果发生其他事情，我们需要更多信息来提供帮助；你能用你传递的实际 lambda 表达式发布调用站点吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T04:11:33.990

似乎问题在于将表达式传递给`RegisterDependencies`.

以下（稍微改编的代码）成功运行。

```
 public static void Test()
    {
        var deps = RegisterDependencies((KeyValuePair<string,string> p) => p.Key, (KeyValuePair<string,string> p) => p.Value);
        foreach(var d in deps)
        {
            Console.WriteLine(d); // Prints Key, Then Value
        }
    }
    public static IEnumerable<string> RegisterDependencies<T>(Expression<Func<T, object>> property,    params Expression<Func<T, object>>[] dependencies)
    {
        var deps = new List<string>();
        deps.Add(GetPropertyName(property));
        foreach (var d in dependencies)
        {
            deps.Add(GetPropertyName(d));
        }
        return deps;
    }

    public static string GetPropertyName<T>(Expression<Func<T, object>> expression)
    {
        var lambda = expression as LambdaExpression;

        MemberExpression memberExpression;
        if (lambda.Body is UnaryExpression)
        {
            var unaryExpression = lambda.Body as UnaryExpression;
            memberExpression = unaryExpression.Operand as MemberExpression;
        }
        else
        {
            memberExpression = lambda.Body as MemberExpression;
        }

        return memberExpression != null ? ((PropertyInfo)memberExpression.Member).Name : null;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T11:42:57.290

事实证明，不知何故，我设法输入了错误的属性名称，例如我想要的位置：

```
p => p.Quantity 
```

我实际上输入了：

```
p => p.quantity 
```

*注意小写的 q*。由于我在构造函数中调用它的事实，我还可以访问我的所有私有成员（所以我的类型有一个名为 的字段`quantity`），这就是为什么这不会导致编译器抱怨而是`InvalidCastException`在运行时生成它是显然不是财产。

@Phoog & Tilak - 谢谢你的帮助。您的两个答案都帮助我隔离了问题，这就是为什么我对您的两个答案都投了赞成票，尽管这是“正确”的答案。

# c# - 级联删除客户的存储过程？

> ID：14096645
> 
> 赞同：0
> 
> 时间：2012-12-31T01:57:18.593
> 
> 标签：c#, sql, wpf, cascade

我有一个项目来实现一个`Customers`从`Northwind -> Customers`. 我设法在每次操作后进行插入、更新和刷新，但删除不起作用并引发 FK 异常。我需要级联删除，但我不知道如何..

我的表格如下所示：

![在此处输入图像描述](../Images/bf356a6b9d52cca87ae4a7d7b2efa889.png)

和我的删除程序（到目前为止，没有级联）：

```
CREATE Procedure [dbo].[DeleteCustomer]
(
    @Original_CustomerID nchar(5)
)
AS
  SET NOCOUNT OFF; 

  DELETE FROM [dbo].[Customers]
  WHERE 
  (
    (
        [CustomerID] = @Original_CustomerID
    )
) 
```

这在某些情况下有效，但在其他情况下我得到一个错误：

> *DELETE 语句与 REFERENCE 约束“FK_Orders_Customers”冲突。冲突发生在数据库“Northwind”、表“dbo.Orders”、列“CustomerID”中。该语句已终止。*

任何人都可以通过在删除时添加级联来帮助我完成这个项目吗？

这是 Northwind Traders 数据库，`Customer`表格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:06:00.197

处理此问题的一种简单方法是在 SQL 企业管理器（或您选择的 ISQLW 解释器）中将约束作为级联删除约束删除并读取：

```
USE Northwind
GO
ALTER TABLE Orders
  DROP CONSTRAINT
    FK_Orders_Customers
GO
ALTER TABLE Orders
  ADD 
    CONSTRAINT FK_Orders_Customers FOREIGN KEY
    (
        CustomerID
     ) REFERENCES Customers
        CustomerID
     ) ON CASCADE DELETE
GO 
```

如果你想有一个严格的存储过程解决方案，你可以使用原始存储过程的这个版本：

```
CREATE Procedure [dbo].[DeleteCustomer] (
    @Original_CustomerID nchar(5)
)
AS

SET NOCOUNT OFF; 

  DELETE 
    FROM [dbo].[Orders]
   WHERE [CustomerID] = @Original_CustomerID

  DELETE 
    FROM [dbo].[Customers]
   WHERE [CustomerID] = @Original_CustomerID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T03:05:51.100

我把你的代码放在哪里？我是否保存/运行为存储过程？它仍然抛出异常..：/我的删除：

```
private void buttonDelete_Click(object sender, RoutedEventArgs e)
{            
    SqlConnection cn = new SqlConnection(@"Integrated Security=SSPI;Initial Catalog=Northwind;Data Source=(local)");
    SqlCommand cmd = new SqlCommand("DeleteCustomer", cn);
    cmd.CommandType = CommandType.StoredProcedure;

    cmd.Parameters.AddWithValue("@Original_CustomerID", textBox_CompanyID.Text);

    cn.Open();
    cmd.ExecuteNonQuery();
    cn.Close();

    lbxCustomers.Items.Clear();
    this.init();
} 
```

我的`DeleteCustomer`程序：

```
CREATE Procedure [dbo].[DeleteCustomer]
(
    @Original_CustomerID nchar(5)
)
AS

SET NOCOUNT OFF; 

DELETE FROM [dbo].[Customers]
WHERE 
(
    (
        [CustomerID] = @Original_CustomerID
    )
) 
```

我有你的代码，但不知道如何将它添加到我的项目中以使其工作。因此，当我重新启动应用程序或切换计算机时，它仍然可以工作。请帮忙..我认为这是新错误。似乎连接了 3 个表：

```
The DELETE statement conflicted with the REFERENCE constraint "FK_Order_Details_Orders". The conflict occurred in database "Northwind", table "dbo.Order Details", column 'OrderID'.
The statement has been terminated. 
```

# c# - Gtk# 中是否有文件夹浏览器小部件？

> ID：14096647
> 
> 赞同：3
> 
> 时间：2012-12-31T01:57:27.653
> 
> 标签：c#, mono, monodevelop, gtk#

我用 MonoDevelop 的 Gtk# UI 生成器构建了 UI，找到了文件选择器小部件，但没有找到目录/文件夹选择器小部件。有这样的事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:07:16.977

查看文件选择器属性，您可以从操作属性中选择“选择文件夹”。

# backbone.js - 模型在主干集合中消失

> ID：14096648
> 
> 赞同：0
> 
> 时间：2012-12-31T01:57:33.063
> 
> 标签：backbone.js

我有这样做的代码

```
class MyCollection extends Backbone.Collection

  initialize: ({some_id}) ->

    super
    @reset $.jStorage.get "mycollection:#{some_id}" # instant fetch
    console.log @length  # THE MODELS ARE THERE

my_collection = new MyCollection [], some_id: 123

console.log my_collection.length # THE MODELS ARE GONE 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:58:09.960

因此，骨干网的初始化函数接受任何参数并将其作为模型提供，使用`null`而不是，`[]`除非你明确说，“这个空白数组绝对是你应该使用的真实数据”，或者如果你以某种方式有一个即时获取，它会休息

```
new MyCollection null, some_id: 123 
```

# roslyn - 在罗斯林重命名项目

> ID：14096652
> 
> 赞同：1
> 
> 时间：2012-12-31T01:58:58.550
> 
> 标签：roslyn

如何更改`IProject`Roslyn 中 ( ) 的名称？我只找到了扩展方法`UpdateAssemblyName()`，但它做了其他事情（当然）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:28:21.267

Roslyn 目前不提供重命名项目的方法，抱歉。

# php - 如何在并行运行的脚本之间传递变量

> ID：14096654
> 
> 赞同：0
> 
> 时间：2012-12-31T01:59:04.900
> 
> 标签：php, parallel-processing

我在带有 PHP 5.3 的 Windows Server 上运行 IIS。我有两个脚本；我们称它们为initiator.php 和worker.php。用户调用initiator.php，在这个脚本中定义了一个变量；我们称它为 $input。我想把这个 $input 变量传递给 worker.php，如下所示：

```
$oShell = new COM('Wscript.Shell');
$oShell->Run("\"C:/Program Files (x86)/PHP/v5.3/php/worker.php -a $input",0,False); 
```

在worker.php 中，我有以下内容来获取从initiator.php 传递的$input 变量。

```
$aCliOpts = getopt('a:');
$input_from_initiator = $aCliOpts['a']; 
```

这很好用。启动器.php 的 $input 变量成功传递给 worker.php，它拾取它并且启动器.php 不断地跳动。然而，worker.php 然后使用它自己的 $input_from_initiator 变量，运行它自己的一些快速代码并创建第三个变量，称为 $output_from_worker。正是这个变量，我需要initiator.php 来读取它的处理过程。这就是我要挂断电话的地方。

我已经尝试将变量从worker.php 传递回initiator.php，就像它在开始时传递的变量一样，但这不起作用。我也尝试过使用：

```
header('Location: initiator.php?var=value') 
```

使用 HTTP GET 参数但无济于事。

我最后的办法是让 worker.php 将此变量的值写入磁盘，然后从磁盘读取initiator.php。由于潜在的磁盘 I/O，我讨厌这样做。速度对于这个脚本非常重要。

有没有办法两个 PHP 进程可以在内存中相互传递变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T22:42:12.837

感谢您的帮助，尽管我最终做了一些与我原来的问题有点不同的事情。我试图运行不同的 cURL 请求。curl_multi_exec() 最终对我很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T02:07:05.463

查看`file_get_contents()` [http://php.net/file_get_contents](http://php.net/file_get_contents)，您可以将 URL 传递给它。所以你可以像这样使用查询字符串：

```
 $var = file_get_contents('http://site.tld/worker.php?input='.$input); 
```

在 中`worker.php`，简单地回显您的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T02:08:05.393

很遗憾你在 Windows 上运行，因为 *nix 上的[sys5 扩展](http://us3.php.net/manual/en/book.sem.php)非常棒！

您始终可以使用文件或数据库等进行通信。

# prolog - 我应该避免在 Prolog 和一般情况下进行尾递归吗？

> ID：14096656
> 
> 赞同：13
> 
> 时间：2012-12-31T02:00:05.623
> 
> 标签：prolog, tail-recursion, accumulator, tailrecursion-modulo-cons

我正在通过“Learn Prolog now”在线书籍来寻找乐趣。

我正在尝试使用累加器编写一个谓词，该谓词遍历列表的每个成员并向其添加一个。我已经很容易做到了，没有尾递归。

```
addone([],[]).
addone([X|Xs],[Y|Ys]) :- Y is X+1, addone(Xs,Ys). 
```

但我读过，出于性能原因，最好避免这种类型的递归。这是真的？总是使用尾递归是否被认为是“好习惯”？使用蓄能器来养成一个好习惯值得吗？

我试图将此示例更改为使用累加器，但它反转了列表。我怎样才能避免这种情况？

```
accAddOne([X|Xs],Acc,Result) :- Xnew is X+1, accAddOne(Xs,[Xnew|Acc],Result).
accAddOne([],A,A).
addone(List,Result) :- accAddOne(List,[],Result). 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-31T10:33:15.123

简短的回答：尾递归是可取的，但不要过分强调它。

您的原始程序与 Prolog 中的尾递归程序一样。但还有更重要的问题：正确性和终止。

事实上，许多实现更愿意为他们认为更重要的其他属性牺牲尾递归。例如[坚定不移](https://stackoverflow.com/q/13100364/772868)。

但是您尝试的优化有一定的意义。至少从历史的角度来看。

早在 1970 年代，主要的 AI 语言是 LISP。相应的定义是

```
(defun 插件 (xs)
  (cond ((null xs) nil)
    (t (cons (+ 1 (car xs)))
         （添加（cdr xs））））））

```

这不是直接的尾递归：原因是`cons`：在那个时候的实现中，它的参数首先被评估，然后才`cons`可以执行。因此，按照您的指示重写（并反转结果列表）是一种可能的优化技术。

然而，在 Prolog 中，由于逻辑变量，您可以在知道实际值之前创建缺点。这么多在 LISP 中不是尾递归的程序，在 Prolog 中被翻译成尾递归程序。

在许多 Prolog 教科书中仍然可以找到这种影响。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-31T07:12:51.200

您的 addOne 过程已经**是**尾递归的。

在头和最后一个递归调用之间没有选择点，因为 is/2 是确定性的。

有时会添加累加器以允许尾递归，我能想到的更简单的例子是 reverse/2。这是一个朴素的反向（nreverse/2），非尾递归

```
nreverse([], []).
nreverse([X|Xs], R) :- nreverse(Xs, Rs), append(Rs, [X], R). 
```

如果我们添加一个累加器

```
reverse(L, R) :- reverse(L, [], R).
reverse([], R, R).
reverse([X|Xs], A, R) :- reverse(Xs, [X|A], R). 
```

现在 reverse/3 是尾递归：递归调用是最后一个，没有选择点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-31T18:20:05.203

OP 说：

> 但是我已经读过，出于性能原因，最好避免 [tail] 递归。这是真的？总是使用尾递归是否被认为是“好习惯”？使用蓄能器来养成一个好习惯值得吗？

将尾递归构造转换为迭代（循环）是一种相当简单的优化。由于尾部（递归）调用是最后完成的事情，因此堆栈帧可以在递归调用中重用，通过简单地跳转到谓词/函数/方法的开头，就所有意图和目的而言，使递归成为一个循环/子程序。因此，尾递归谓词不会溢出堆栈。应用了优化的尾递归构造具有以下优点：

*   由于不需要分配/释放新的堆栈帧，因此执行速度稍快；此外，您可以获得更好的参考位置，因此可以说分页更少。
*   递归深度没有上限。
*   没有堆栈溢出。

可能的缺点？

*   有用的堆栈跟踪丢失。如果 TRO 仅应用于发布/优化版本而不是调试版本，则不是问题，但是...
*   开发人员将编写依赖于 TRO 的代码，这意味着应用 TRO 的代码将运行良好，如果不应用 TRO，代码将失败。这意味着在上述情况下（TRO 仅在发布/优化构建中），发布和调试构建之间存在功能更改，本质上意味着一个人选择的编译器选项会从相同的源代码生成两个不同的程序。

当语言标准要求尾递归优化时，这当然不是问题。

引用维基百科：

> 尾调用很重要，因为它们可以在不向调用堆栈添加新堆栈帧的情况下实现。当前过程的大部分框架都不再需要了，可以用尾调用的框架代替，并酌情修改（类似于进程的覆盖，但用于函数调用）。然后程序可以跳转到被调用的子程序。生成这样的代码而不是标准调用序列称为尾调用消除或尾调用优化。

也可以看看：

*   [什么是尾调用优化？](https://stackoverflow.com/questions/310974/what-is-tail-call-optimization)
*   [关于此事的波特兰模式存储库](http://c2.com/cgi/wiki?TailCallOptimization)
*   甚至[微软的 MSDN](http://blogs.msdn.com/b/chrsmith/archive/2008/08/07/understanding-tail-recursion.aspx)

我一直不明白为什么更多的语言不实现尾递归优化

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-31T02:36:28.193

我不认为第一个版本会`addone`导致代码效率降低。它也更具可读性，所以我认为没有理由避免它是一种好的做法。

在更复杂的示例中，编译器可能无法自动将代码转换为尾递归。那么将其重写为优化可能是合理的，但前提是确实有必要。

那么，如何实现一个有效的尾递归版本`addone`？它可能是作弊，但假设它`reverse`是通过尾递归实现的（例如，请参见[此处](https://stackoverflow.com/questions/6442750/recursive-prolog-predicate-for-reverse-and-palindrome/6448096#6448096)），那么它可以用来解决您的问题：

```
accAddOne([X|Xs],Acc,Result) :- Xnew is X+1, accAddOne(Xs,[Xnew|Acc],Result).
accAddOne([],Acc,Result) :- reverse(Acc, Result).
addone(List,Result) :- accAddOne(List,[],Result). 
```

不过，这非常笨拙。:-)

顺便说一句，我找不到更简单的解决方案。可能由于与 Haskell 中相同的原因，`foldr`通常不使用尾递归定义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-17T11:52:06.740

与其他一些编程语言相比，某些 Prolog 实现非常适合尾递归程序。尾递归可以作为最后调用优化 (LCO) 的一种特殊情况来处理。例如，这里在 Java 中不起作用：

```
public static boolean count(int n) {
    if (n == 0) {
        return true;
    } else {
        return count(n-1);
    }
}

public static void main(String[] args) {
    System.out.println("count(1000)="+count(1000));
    System.out.println("count(1000000)="+count(1000000));
} 
```

结果将是：

```
count(1000)=true
Exception in thread "main" java.lang.StackOverflowError
    at protect.Count.count(Count.java:9)
    at protect.Count.count(Count.java:9) 
```

另一方面，主要的 Prolog 实现对此没有任何问题：

```
 ?- [user].
 count(0) :- !.
 count(N) :- M is N-1, count(M).
 ^D 
```

结果将是：

```
?- count(1000).
true.
?- count(1000000).
true. 
```

Prolog 系统可以做到这一点的原因是，它们的执行通常是蹦床式的，最后调用优化是选择点消除和环境修剪的问题。[早期的WAM](https://en.wikipedia.org/wiki/Warren_Abstract_Machine)中已经记录了环境修整。

但是，是的，调试可能是个问题。

# html - 如何使用 Capybara 找到未命名的 iframe

> ID：14096661
> 
> 赞同：3
> 
> 时间：2012-12-31T02:01:07.723
> 
> 标签：html, ruby, iframe, cucumber, capybara

我尝试访问的 iframe 深度为 3 个 iframe，并且启动模糊

```
<iframe frameborder="0" style="height: 100%; width: 100%;" src="javascript:void(0)"></iframe> 
```

没有 ID、名称或值。

我能不能...

```
within_frame(iframe) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T09:03:35.380

[Capybara::Selenium::Driver.within_frame](https://github.com/jnicklas/capybara/blob/master/lib/capybara/selenium/driver.rb#L77)传递`frame_id`给 webdriver：

```
browser.switch_to.frame(frame_id) 
```

Webdriver的[frame](http://selenium.googlecode.com/svn/trunk/docs/api/rb/Selenium/WebDriver/TargetLocator.html#frame-instance_method)方法调用[switchToFrame](http://selenium.googlecode.com/svn/trunk/docs/api/rb/Selenium/WebDriver/Remote/Bridge.html#switchToFrame-instance_method)方法，接受[index、name或id](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriver.TargetLocator.html)

因此，要访问 3 个 iframe 深度 iframe，您可以执行以下操作：

```
within_frame 0 do
  within_frame 0 do
    within_frame 0 do
      # do something
    end
  end
end 
```

# coordinates - 获得精灵的“真实空间”高度

> ID：14096663
> 
> 赞同：0
> 
> 时间：2012-12-31T02:01:28.550
> 
> 标签：coordinates, sprite, scaling, coordinate-systems, timedelta

我的 Android 游戏使用基于真实空间坐标的屏幕坐标，我的转换如下：所有这些都是伪代码，但我已将其突出显示为代码

```
Real-space=(position/480);   (so for example 240/480 would be halfway across the screen)
Velocity = 1/Time;        (Time = seconds)
Real-space= Real-space+ (Velocity * delta time);
Screen Coordinates = Real-space* screen width / length 
```

现在我遇到的问题是，在我的游戏中，我需要匹配 2 个精灵的屏幕坐标，所以它们一起移动（一个在另一个之上，所以我只是使用类似的东西

```
Sprite1_Screen_Coords = (Sprite_2_Screen_Coords-Sprite1 Height) 
```

（所有高度都按比例缩放，因此相对于应用程序当前运行的屏幕尺寸）

这工作正常，但我需要匹配“真实空间”坐标。

显然我可以做类似的事情：

```
Sprite1-Real-Co-ordinates = Sprite2-Real-Co-ordinates 
```

这意味着它们将是相同的，但我会从中减去什么值，以便它完美地“坐”在另一个精灵之上？我如何从/为我拥有的精灵导出这个缺失值？所以要总结一下，我需要类似的东西：

```
Sprite1-Real-Co-ordinates = (Sprite2-Real-Co-ordinates - something representing the sprites height) 
```

谢谢大家！:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T23:40:26.933

答案是我只是将精灵的缩放高度除以当前屏幕高度并使用该值 - 似乎适用于我测试过的 3 种分辨率。

# database - 存储频繁温度样本的最有效工具

> ID：14096666
> 
> 赞同：1
> 
> 时间：2012-12-31T02:02:02.607
> 
> 标签：database, temperature

我正在开发一个需要存储大量温度数据的系统。我可能每秒存储 5 个或更多样本。

我过去使用相对简单的 mysql 数据库完成了此操作，性能变得难以忍受。插入物并不算太糟糕，但有明显的负荷。但是，查询可能需要几分钟。

那时，我有大约 50 GB 的数据，这太荒谬了。我可以想出很多方法来压缩或丢弃数据而不会丢失关键信息，但这是一个完全不同的问题。

我想选择一个针对此类数据进行了优化的工具/数据库，最好是跨平台的（至少是 linux/c++）。

RRD（Round Robin Database）似乎是为这种事情而构建的，但它似乎更多地是为处理数据而不是存储数据而设计的。

还有哪些可用的工具？

编辑：更多信息...

这将在嵌入式系统（Raspberry Pi）上运行，因此理想的工具具有低计算开销、低内存占用和很少的库依赖关系。

存储可能不一定在同一设备上。

我想在一个人为的极端情况下，增长可以达到每小时 50 万个样本。更有可能的是每小时大约 20k 个样本。

不应假定可以访问 Internet。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:05:09.533

看起来您正在寻找时间序列数据库。

我知道有两个候选人：

*   [http://tempo-db.com/](http://tempo-db.com/)
*   [http://opentsdb.net/](http://opentsdb.net/)

如果您可以更具体地了解您的要求（req/s、每日数据增长、API 类型、自托管或完全托管的解决方案等），我将能够详细介绍或推荐其他解决方案。

祝你好运。

# javascript - 构建一个跨 node.js 和客户端共享的 javascript 应用程序

> ID：14096667
> 
> 赞同：0
> 
> 时间：2012-12-31T02:02:22.797
> 
> 标签：javascript, node.js, code-reuse

我习惯于跨平台开发。在 C/C++ 方面它很简单，但是在使用 javascript 时我遇到了一个问题。我希望能够在客户端重用我的网络服务中的代码。目前 node.js 要求我以最不愉快的方式编写我的程序，但我可以处理它：

```
//MyClass.js
function MyClass()
{
    this.test = function(){}
}

module.exports.MyClass = MyClass; 
```

```
//server.js

var m = new require('MyClass.js').MyClass();
m.test(); 
```

```
//client.js
$.getScript("MyClass.js", function(){
    var m = new MyClass();
    m.test();
}); 
```

到那时一切都很好，但是当我需要从`MyClass.js`. 我怎样才能让它在所有平台上工作？有没有办法在不处理文件的情况下实现可重用性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:05:55.683

Node 要求你什么都不做。如果您不喜欢 Node 模块系统的工作方式，请不要使用它。

```
//MyClass.js
MyClass = function ()
{
    this.test = function(){}
}

//server.js
require('./MyClass.js');
var m = new MyClass();
m.test(); 
```

现在您的应用程序与您在客户端进行的操作兼容。请记住，您现在正在全局命名空间中创建类，这是使用 Node 模块布局的原因之一。

我建议还研究一些`require`在客户端上使用 Node 样式的方法。有许多可用的脚本，例如[RequireJS](http://requirejs.org/)或[Browserify](https://github.com/substack/node-browserify)。

# html - Bootstrap Carousel 在最后一项上消失

> ID：14096669
> 
> 赞同：3
> 
> 时间：2012-12-31T02:02:42.687
> 
> 标签：html, twitter-bootstrap

此轮播中共有 2 个项目/图像。加载第二个图像后，Carousel 尝试移动到第三个项目（没有），并且 carousel 就消失了。在 intervel 之后，轮播返回第一张图像。

旋转木马幻灯片就像..

```
Item 1 > Item 2 > Disappear > Item 1 > ... 
```

版本是 Bootstrap 2.1 和 jQuery 1.8.1。下面是代码。

```
<script type="text/javascript" src="media/jui/js/jquery.min.js"></script>
<script type="text/javascript" src="media/jui/js/bootstrap.min.js"></script>

<div id="homeCarousel" class="carousel">
        <div class="carousel-inner">
            <div class="item active">
                <img src="images/hawk2.jpg" alt="" >
            </div>
            <div class="item">
                <img src="images/hawk5.jpg" alt="" >
            </div>

            <div class="carousel-caption">
                    <ul class="nav nav-tabs">
                    <li class="active"><a href="#home" data-toggle="tab">
                            <h1>**</h1>
                            <h4>Business Applications</h4>
                    </a></li>
                    <li><a href="#profile" data-toggle="tab"><h1>**</h1>
                            <h4>IT Infrastructure</h4></a></li>
                    <li><a href="#messages" data-toggle="tab"><h1>**</h1>
                            <h4>Web & Content</h4></a></li>
                </ul>

            </div>
            <a class="carousel-control right" href="#homeCarousel" data-slide="next">&rsaquo;</a>
            <a class="carousel-control left" href="#homeCarousel" data-slide="prev">&lsaquo;</a>

        </div>
    </div> 
```

这里有什么问题？

-更新：我尝试将 jQuery 更新到 1.8.3 并将 Bootstrap 更新到 2.2.2 - 没有变化

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-02-11T13:57:11.430

有同样的问题，你必须把下一个和上一个按钮放在`.carousel-inner`div 之外。

您的代码在该 div 中有下一个和上一个按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T12:35:57.893

carousel-caption 应该在任何项目类中：

```
<script type="text/javascript" src="media/jui/js/jquery.min.js"></script>
<script type="text/javascript" src="media/jui/js/bootstrap.min.js"></script>

<div id="homeCarousel" class="carousel">
<div class="carousel-inner">
    <div class="item active">
        <img src="images/hawk2.jpg" alt="" >
        <div class="carousel-caption"> <!-- carousel-caption begin -->
            <ul class="nav nav-tabs">
                <li class="active"><a href="#home" data-toggle="tab">
                        <h1>**</h1>
                        <h4>Business Applications</h4>
                </a></li>
                <li><a href="#profile" data-toggle="tab">
                    <h1>**</h1>
                    <h4>IT Infrastructure</h4>
                </a></li>
                <li><a href="#messages" data-toggle="tab">
                    <h1>**</h1>
                    <h4>Web & Content</h4>
                </a></li>
            </ul>
        </div> <!-- carousel-caption end -->
    </div>
    <div class="item">
        <img src="images/hawk5.jpg" alt="" >
        <div class="carousel-caption"> <!-- carousel-caption begin -->
            <ul class="nav nav-tabs">
                <li class="active"><a href="#home" data-toggle="tab">
                        <h1>**</h1>
                        <h4>Business Applications</h4>
                </a></li>
                <li><a href="#profile" data-toggle="tab">
                    <h1>**</h1>
                    <h4>IT Infrastructure</h4>
                </a></li>
                <li><a href="#messages" data-toggle="tab">
                    <h1>**</h1>
                    <h4>Web & Content</h4>
                </a></li>
            </ul>
        </div> <!-- carousel-caption end -->
    </div>
    </div>
    <a class="carousel-control right" href="#homeCarousel" data-slide="next">&rsaquo;</a>
    <a class="carousel-control left" href="#homeCarousel" data-slide="prev">&lsaquo;</a>
</div> 
```

# ios - NSUrlConnection 何时锁定 屏幕？

> ID：14096674
> 
> 赞同：4
> 
> 时间：2012-12-31T02:04:56.327
> 
> 标签：ios, background, nsurlconnection

我已经尝试了一些在锁定屏幕时执行 NSURLConnection 的方法，但都不起作用。

我试过如下：

```
[self performSelectorInBackground:@selector(startConnection) withObject:nil]; 
```

我也试过：

```
dispatch_queue_t request_queue = dispatch_queue_create("com.app.download", NULL);
dispatch_async(request_queue, ^{
  [self startConnection];
}); 
```

在开始连接中：

```
- (void)startConnection{
  ... some URL processing

  responseData_ = [[NSMutableData alloc] init];
  connection_ =
  [[NSURLConnection alloc] initWithRequest:urlRequest delegate:self];
} 
```

NSURLConnection 委托方法不是通过这种方式调用的。使它工作的真正代码是什么？谢谢！

**一个可能有帮助的小更新**：

它只调用这个委托方法：

```
- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error 
```

带有消息：

> 找不到具有指定主机名的服务器。

我很确定我的 wi-fi 已连接，但仍然不知道为什么叫它:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T04:43:04.367

如果您锁定屏幕，您的应用程序将进入后台模式，**而不是后台运行模式。** 如果你想在用户锁定屏幕时下载，你应该检查这个方法 [UIApplication -beginBackgroundTaskWithExpirationHandler:]

# jquery - JQuery 可排序的 portlet 清除内部的格式

> ID：14096675
> 
> 赞同：0
> 
> 时间：2012-12-31T02:04:59.367
> 
> 标签：jquery, portlet

我正在使用[http://jqueryui.com/sortable/#portlets找到的 jQuery 可排序 portlet](http://jqueryui.com/sortable/#portlets)

div 类“portlet-content”显然包含真正搞乱我的布局的格式。有没有办法清除 portlet 容器内的格式？

# c++ - SDLNet：如何定义服务器 IP 地址

> ID：14096684
> 
> 赞同：0
> 
> 时间：2012-12-31T02:06:38.357
> 
> 标签：c++, networking, sdl

尝试将客户端连接到服务器时，我已经成功了。但服务器使用的是环回 IP 地址。如何使用 SDLNet 制作服务器，以便我可以从连接到任何网络的任何计算机访问它？

问题在于代码，因为我找不到任何可以为服务器定义另一个 IP 地址的地方......

这是服务器的代码：

```
#include "Link\SDL\include\SDL.h"
#include "Link\SDL\include\SDL_net.h"
#include <iostream>
#include <vector>

int main(int argc, char *argv[])
{
SDL_Init(SDL_INIT_EVERYTHING);
SDLNet_Init();

int curid=2;
int playernum = 0;
char data[1400];
bool running=true;

SDL_Event event;
IPaddress ip;
SDLNet_ResolveHost(&ip,NULL,1234);
SDLNet_SocketSet sockets=SDLNet_AllocSocketSet(30);     //max player
std::vector<TCPsocket> socketsvector;
TCPsocket server=SDLNet_TCP_Open(&ip);

while(running)
{
    while(SDL_PollEvent(&event))
    {
        if(event.type==SDL_QUIT || event.type==SDL_KEYDOWN && event.key.keysym.sym==SDLK_ESCAPE)
        {
            running=false;
            break;
        }
    }
    TCPsocket tmpsocket=SDLNet_TCP_Accept(server);
    if(tmpsocket)
    {
        if(playernum<30)
        {
            SDLNet_TCP_AddSocket(sockets,tmpsocket);
            socketsvector.push_back(tmpsocket);
            sprintf(data,"0 %d \n",curid);
            curid++;
            playernum++;
            std::cout << "new connection. ID: " << curid << std::endl;
        }
        else
        {
            sprintf(data,"3 \n");   //server is full    
        }
        SDLNet_TCP_Send(tmpsocket,data,strlen(data)+1);
    }

    while(SDLNet_CheckSockets(sockets,0) > 0)
    {
        for(int i=0;i<socketsvector.size();i++)
        {
            if(SDLNet_SocketReady(socketsvector[i])==1)
            {
                SDLNet_TCP_Recv(socketsvector[i],data,1400);
                int num=data[0]-'0';
                int j=1;
                while(data[j]>='0' && data[j]<='9')
                {
                    num*=10;
                    num+=data[j]-'0';
                    j++;
                }

                if(num==1)
                {
                    for(int k=0;k<socketsvector.size();k++)
                    {
                        if(k==i)
                            continue;
                        SDLNet_TCP_Send(socketsvector[k],data,strlen(data)+1);
                    }
                }else if(num==2)
                {
                    for(int k=0;k<socketsvector.size();k++)
                    {
                        if(k==i)
                            continue;
                        SDLNet_TCP_Send(socketsvector[k],data,strlen(data)+1);
                    }

                    SDLNet_TCP_DelSocket(sockets,socketsvector[i]);
                    SDLNet_TCP_Close(socketsvector[i]);
                    socketsvector.erase(socketsvector.begin()+i);
                    playernum--;
                    std::cout << "connection closed..." << std::endl;
                    std::cout << playernum << " players in server" << std::endl;
                }
            }
        }
    }
    //SDL_Delay(30);
}
SDLNet_TCP_Close(server);

SDLNet_FreeSocketSet(sockets);

SDLNet_Quit();
SDL_Quit();
return 0;
} 
```

好的，这是客户端的代码...

```
class network{
private:
    SDLNet_SocketSet sockets;
    TCPsocket connection;
    char data[1400];
public:
    network(const char* ip);
    ~network();
    void send(Player* p);
    void receive(std::vector<Enemy*>& enemies, Player* p); //std::vector<unsigned int>& f,std::vector<enemy*>& enemies,std::vector<weapon*> weapons,player* p
    void closeConnection();
};

network::network(const char* ipaddress)
{
    SDLNet_Init();
    IPaddress ip;
    if(SDLNet_ResolveHost(&ip,ipaddress,1234)==-1)
        std::cout << "error while resolving the host (bad ip?)" << std::endl;
    connection=SDLNet_TCP_Open(&ip);
    sockets=SDLNet_AllocSocketSet(1);
    if(sockets==NULL)
        std::cout << "error while connecting (bad ip?)" << std::endl;
    SDLNet_TCP_AddSocket(sockets,connection);
}

void network::closeConnection()
{
    SDLNet_TCP_Send(connection,"2 \n",4);   //close with the server
}

network::~network()
{
    SDLNet_TCP_Close(connection);
    SDLNet_FreeSocketSet(sockets);
    SDLNet_Quit();
}

void network::send(Player* p)
{
    vector3d vec=p->cam.getVector();
    //1 curframe position rotation lookdirection health curweaponnum 
    sprintf(data,"1 %d %f %f %f %f %f %f \n",p->id, p->cam.getLocation().x,p->cam.getLocation().y,p->cam.getLocation().z,vec.x,vec.y,vec.z);
    int size=0;
    int len=strlen(data)+1;

    //SDLNet_TCP_Send(connection,data,len);
    while(size<len)
    {
        size+=SDLNet_TCP_Send(connection,data+size,len-size);
    }
}

void network::receive(std::vector<Enemy*>& enemies, Player* p) //std::vector<unsigned int>& f,std::vector<enemy*>& enemies,std::vector<weapon*> weapons,player* p
{
    SDLNet_CheckSockets(sockets,10);
    if(SDLNet_SocketReady(connection))
    {
        int tmp,num;
        int offset=0;
        do
        {
            offset=SDLNet_TCP_Recv(connection,(char*)data+(offset),1400);
            if(offset<=0)
                return;
        }while(data[strlen(data)-1]!='\n');

        sscanf(data,"%d %d",&num,&tmp);

        //cout << num << " " << tmp << endl;
        cout << data << endl;

        int i=0;
        if(num == 0)
        {
            p->setId(tmp);
        }
        else if(num==1)
        {
            bool NewEnemy = true;
            for(i=0;i<enemies.size();i++)
            {
                if(enemies[i]->id == tmp)
                {
                    int nothing;
                    sscanf(data,"1 %d %f %f %f %f %f %f \n",&nothing, &(enemies[i]->position.x),&(enemies[i]->position.y),&(enemies[i]->position.z),&(enemies[i]->rotation.x),&(enemies[i]->rotation.y),&(enemies[i]->rotation.z));
                    NewEnemy = false;
                    break;
                }
            }
            if(NewEnemy == true && tmp != 0)
            {
                std::cout << "pusing new enemy" << std::endl;
                enemies.push_back(new Enemy(tmp));
            }
        }
        else if(num == 2)
        {
            for(int k = 0; k < enemies.size(); k++)
            {
                if(enemies[k]->id == tmp)
                {
                    enemies.erase(enemies.begin() + k);
                }
            }
        }
        else if(num == 3)
        {
            std::cout << "Could not connect. Server is full." << std::endl;
        }
    }
} 
```

如果你能看到，我在程序启动时键入客户端的 IP 地址。但唯一有效的值是环回地址。

# r - 将 lmer 输出到 word/excel

> ID：14096692
> 
> 赞同：2
> 
> 时间：2012-12-31T02:08:17.587
> 
> 标签：r, lme4

我正在`R`使用一个名为`lme4`.

执行模型：

```
lmer.rasch <- lmer(Response ~ item -1 + (1|STIDSTD),family=binomial, data=exampledata) 
```

让我在控制台中输出，如帖子末尾所示。我想复制这个看起来像表格的东西，以便 Excel 或最终单词，识别单独的列和行。Ctrl-C/Ctrl-V to excel 确实可以识别行，但不能识别列。

使用`write.csv(lmer.rasch)`给出错误：

> as.data.frame.default(x[[i]], optional = TRUE) 中的错误：无法将类 'structure("mer", package = "lme4")' 强制转换为 data.frame

这是包内的问题，还是我错误地使用 write 函数的一般问题，或者 R 实际上没有将此输出分成列？

```
 Fixed effects:
                        Estimate Std. Error z value Pr(>|z|)    
    variableamoeba       -2.7529     0.3000  -9.175  < 2e-16 ***
    variablebacterium    -2.3937     0.2244 -10.668  < 2e-16 ***
    variableleech         0.5578     0.1693   3.294 0.000987 ***
    variablecentipede     1.7012     0.1909   8.911  < 2e-16 ***
    variablelizard       -4.1836     0.4090 -10.229  < 2e-16 ***
    variabletapeworm     -1.3697     0.1841  -7.439 1.01e-13 ***
    variablehead lice     1.1803     0.1777   6.643 3.07e-11 ***
    variablemaggot        0.8819     0.1740   5.068 4.03e-07 ***
    variableant           2.5971     0.2332  11.137  < 2e-16 ***
    variablemoth          2.5389     0.2305  11.016  < 2e-16 ***
    variablemosquito      4.1270     0.3984  10.359  < 2e-16 ***
    variableearthworm    -0.3113     0.1675  -1.858 0.063106 .  
    variablecaterpillar   0.7278     0.1706   4.265 2.00e-05 ***
    variablescorpion     -3.1011     0.2748 -11.286  < 2e-16 ***
    variablesnail        -1.4499     0.1861  -7.791 6.66e-15 ***
    variablespider        0.4913     0.1681   2.923 0.003469 ** 
    variablegrasshopper   1.9167     0.1986   9.650  < 2e-16 ***
    variabledust mite     0.5767     0.1701   3.391 0.000696 ***
    variabletarantula    -0.7640     0.1734  -4.406 1.05e-05 ***
    variabletermite       1.8333     0.2007   9.136  < 2e-16 ***
    variablebat          -5.2427     0.6486  -8.083 6.33e-16 ***
    variablewasp          3.0696     0.2687  11.423  < 2e-16 ***
    variablesilkworm      1.1310     0.1792   6.313 2.74e-10 ***
    ---
    Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T02:41:39.650

这是一种方法：

```
 x <- rnorm(100)
 y <- 1:100
 g <- c(rep("a",50),rep("b",50))

library(lme4)
mod1 <- glmer(y ~ x  + (1|g) )
summary(mod1)

library(memisc)
getSummary.mer(mod1)$coef
write.csv(getSummary.mer(mod1)$coef,"answer.csv") 
```

这应该给出我认为您正在寻找的东西，但是您的模型属于类`mer`而不是 a `matrix`or `data.frame`：

```
 class(mod1)
[1] "mer"
attr(,"package")
[1] "lme4"

class(getSummary.mer(mod1)$coef)
[1] "matrix" 
```

这就是为什么您不能随心所欲地写入文件的原因。

* * *

编辑

* * *

现在也是：

```
summary(mod1)$coefficients  
write.csv( summary(mod1)$coefficients ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T09:28:18.033

我按照三个简单的步骤从 R-studio 控制台复制和粘贴到 Excel 并维护/恢复列结构：

1.  从 R-Studio 控制台复制文本。

2.  将内容粘贴到 Excel 中的单元格中。

3.  单击我将数据粘贴到的（单个）单元格，然后从数据选项卡（或 Alt+D+E）中选择“文本到列”选项。这会启动文本导入向导，我发现它可以很好地根据文本宽度从 R-Studio 粘贴中找出列（单击“下一步”很多）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-04T08:08:36.480

这适用于我（使用 lme4）：

```
 coeffs <- coef(summary(your.model)) # get estimates, etc...
    p <- pnorm(abs(coeffs[, "t value"]), lower.tail = FALSE) * 2 # add the much disputed p-values

    coeffsp <- cbind(coeffs, "p value" = round(p,3)) # combine it into one object
    write.csv(coeffsp, "coeffsp.csv") # export 
```

# java - ResourceBundle - 无法确定文件系统中不存在属性文件时如何读取它

> ID：14096698
> 
> 赞同：2
> 
> 时间：2012-12-31T02:09:46.447
> 
> 标签：java, properties, configuration, configuration-files, resourcebundle

我有一个 EJB 2.1 应用程序，它引用一个属性文件来读取一个值。属性文件的文件名定义为

```
private static final String CONFIG_DIRECTORY = "config.";
private static final String PROPERTIES_FILE = CONFIG_DIRECTORY + "myapp"; 
```

要从属性文件加载和读取属性，请进行以下调用，将 PROPERTIES_FILE 作为 propertyFileName 的名称传递

```
this.getProperties(PROPERTIES_FILE); 
```

该`getProperties`方法使用 ResourceBundle 加载属性文件，如下所示。

```
public Properties getProperties (String propertyFileName) {
        Properties properties = new Properties();
        ResourceBundle resourceBundle = ResourceBundle.getBundle(propertyFileName);
        Enumeration<String> keys = resourceBundle.getKeys();

        while (keys.hasMoreElements()) {
            String key = (String)keys.nextElement();
            String value = resourceBundle.getString(key);
            properties.put(key, value);
        }
        return properties;
    } 
```

现在我花了很长时间试图在应用程序的文件系统中的任何地方找到一个名为 config.myapp 的文件，但它不存在。我什至在整个文件系统中搜索了该文件，但它不存在。我查看了所有文件夹、jar 文件等，但找不到名为 config.myapp 的文件

在应用程序的根目录中有一个名为“config”的文件夹，在该文件夹中有一个名为的文件，该文件`myapp.properties`具有应用程序正在读取的属性。可能`config.myapp`是实际上指的是`config/myapp.properties`文件吗？如果是这样，那是如何工作的？不知何故`ResourceBundle`翻译`config.myapp`成？`config/myapp.properties`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:26:18.893

用斜杠替换点并附加 .properties 是预期的行为。从[文档](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html#getBundle%28java.lang.String,%20java.util.Locale%29)中`ResourceBundle.getBundle`：

> 否则，getBundle 会尝试定位属性资源文件。它通过替换所有“。”从候选包名称生成路径名称。带有“/”的字符并附加字符串“.properties”。它尝试使用 ClassLoader.getResource 查找具有此名称的“资源”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T02:26:54.307

是的，当您使用时

```
ResourceBundle resourceBundle = ResourceBundle.getBundle(propertyFileName) 
```

无需通过扩展名，也可以将路径作为“文件夹名.文件名”传递

ResourceBundle 将负责这些转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T02:34:02.157

ResourceBundle.getBundle() 从您的类路径加载，它执行[复杂的逻辑](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html#getBundle%28java.lang.String,%20java.util.Locale,%20java.lang.ClassLoader,%20java.util.ResourceBundle.Control%29)来解析文件（资源）属性名称。是的，它在最后添加了 .properties 并使用了一个包

简而言之，您传递给 getBundle() 的字符串被调用`basename`，逻辑是：

> baseName 参数应该是一个完全限定的类名。但是，为了与早期版本兼容，Sun 的 Java SE 运行时环境不验证这一点，因此可以通过指定路径名（使用“/”）而不是完全限定的类名（使用“.”）来访问 PropertyResourceBundles .

因此，在您的情况下，如果您传递字符串“config.Myapp”，ResourceBundle 将尝试从您的类路径加载这些资源之一（假设您具有 en_US 语言环境）：

1.  config.MyResources.class
2.  /config/Myapp.properties"
3.  /config/Myapp_en.properties
4.  config.Myapp_en_US.class
5.  /config/Myapp_en_US.properties

这是因为 ResourceBundle 旨在用于国际化 (i18n)，而不是用于配置。

如果可以的话，我建议你看看我的小库以使用 java 属性：[owner API](http://lviggiano.github.com/owner/)。（希望这不会被视为垃圾邮件）

# jquery - SetTimeout 和延迟不起作用

> ID：14096701
> 
> 赞同：0
> 
> 时间：2012-12-31T02:10:09.503
> 
> 标签：jquery, settimeout, delay

我有以下代码：

```
var wait = 500;
$(document).on("click",".new_game_list_row",function(event){
        var self = $(this);
        //As the element clicked on has it's data attributes defined
        //Retrieves it when the element is clicked on
        var id_quiz_list = self.data('quizlistId'),
            difficult = self.data('difficult');
            userid = $("#new_game_list_wrap").data('userid');
                setTimeout(function(){
                    $.post("new_game_add.php","userid="+userid+"&id_quiz_list="+id_quiz_list+"&difficult="+difficult,function(data){
                        $answer = data;
                        $("#new_game_list_wrap").fadeOut("slow",function(){
                            self.remove();
                            $("#quiz_list_wrap").append('<div class="quiz_list_row" data-quizlist-id="'+id_quiz_list+'" data-quizlevel-reached="0" '+
                            '><div class="inline list_cell" id="quiz_list_cell_rownew_id1">Quiz '+id_quiz_list+'</div><div '+
                            'class="inline list_cell" id="quiz_list_cell_rownew_id2">Current level: 1</div>');
                            showtrick(id_quiz_list,1);
                        }); 
                    }, "html");  
                }, wait);
    }); 
```

我试图用来`setTimeout()`避免在行上多次点击。我的桌子上满是幽灵条目。

我尝试过延迟，但没有奏效。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:18:13.747

乍一看，我没有看到任何地方都定义了“等待”，它需要是一个毫秒整数值。除此之外，可能还有更好的方法，例如当点击事件立即关闭绑定，然后使用您的 setTimeout 在 n 毫秒内重新打开它。

您可以使用 cookie 或窗口变量来存储“isClickable”标志，并且仅在可点击时执行您的逻辑。根据需要打开和关闭 isClickable。也许在按钮上显示一个半透明的 div 以使其变灰并使其无法被鼠标点击。

似乎没有充分的理由从 dom 中删除该元素，然后稍后再将其附加回来。长话短说，我看到的唯一问题是超时可能没有设置。jQuery 我只是认为你最好走一条不同的路线而不是实际操纵 dom 本身。（隐藏、重叠或只是停止处理点击）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T02:21:56.997

如果您只想让 click 事件在 x 秒内忽略任何操作，您可以编写如下内容：

**HTML**

```
​&lt;button>Click Me</button>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**jQuery**

```
​$("button").click(function(){
    var $this = $(this);
    if(!$this.data("disabled")){
        alert("You clicked the button.  You won't be able to click it again for 5 seconds.");

        $this.data("disabled", true);
        setTimeout(function(){
            $this.data("disabled", false);
        }, 5000);
    }
});​​​​ 
```

[jsfiddle 中的演示](http://jsfiddle.net/FszWw/)

如果按钮的`disabled`数据设置为`true`，它将跳过点击事件的内容。

如果不是`disabled`，它将运行其代码，然后禁用自身。使用`setTimeout`它可以在 x 秒内重新启用自身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T03:18:50.003

我解决了这个问题：

```
var isClickable=true, wait = 500;
$(document).on("click",".new_game_list_row",function(event){

    if(isClickable) {
        isClickable = false;
        var self = $(this);
        //As the element clicked on has it's data attributes defined
        //Retrieves it when the element is clicked on
        var id_quiz_list = self.data('quizlistId'),
            difficult = self.data('difficult');
            userid = $("#new_game_list_wrap").data('userid');
            $("#new_game_list_wrap").fadeOut("slow");
            $.post("new_game_add.php","userid="+userid+"&id_quiz_list="+id_quiz_list+"&difficult="+difficult,function(data){
                $answer = data;
                    self.remove();
                    $("#quiz_list_wrap").append('<div class="quiz_list_row" data-quizlist-id="'+id_quiz_list+'" data-quizlevel-reached="0" '+
                    '><div class="inline list_cell" id="quiz_list_cell_rownew_id1">Quiz '+id_quiz_list+'</div><div '+
                    'class="inline list_cell" id="quiz_list_cell_rownew_id2">Current level: 1</div>');
                    showtrick(id_quiz_list,1);
            }, "html"); 
                setTimeout(function(){
                    isClickable = true;
                }, wait);
    }
}); 
```

**问题解决了。**

# windows-runtime - IOutputStream.FlushAsync的返回值是什么意思

> ID：14096704
> 
> 赞同：4
> 
> 时间：2012-12-31T02:10:36.323
> 
> 标签：windows-runtime

该[`IOutputStream.FlushAsync`](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.storage.streams.ioutputstream.flushasync)方法返回一个可等待的布尔值。返回值的文档说：

> 流刷新操作。

这似乎，呃，模糊。有人可以阐明这真正意味着什么的细节吗？我目前的假设是它是一个是/否值，表示刷新是否有效，例如，因为实现不支持刷新。

那是对的吗？我看到的大多数示例只是在 FlushAsync 上等待并丢弃结果。我是否应该注意返回值并以某种方式处理它，即使我知道流将指向文件系统上的文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T16:00:00.020

这只是语言摩擦，你不能声明一个`IAsyncOperation<void>`. GetResults() 方法必须返回*一些东西*。你只对 Completed 感兴趣，你不关心虚假的返回值。

# c++ - 运行时检查失败 #2 - 变量“id”周围的堆栈已损坏

> ID：14096705
> 
> 赞同：-2
> 
> 时间：2012-12-31T02:10:50.053
> 
> 标签：c++, runtime

我`"Run-Time Check Failure #2 - Stack around the variable 'id' was corrupted."`上车`while condition`。我不知道！是什么导致了这个错误？

```
void Term::set_id()
{
    char id[Term::ID_LENGTH];
    do
    {
        cout << "\n\nEnter the term id(like 90911): ";
        cin >> id;
    }while(valid_id(id) != true);
}

bool Term::valid_id(char *id)
{
    //counting how many chars id has got:
    int n=0;
    for(char* str=id; *(str+n)!=0; n++);

    if(n!=Term::ID_LENGTH)
        return false;

    //checking that id consist of digits only
    int i=0;
    for( char* str=id; (*(str+i)>=48 && *(str+i)<=57) && i<Term::ID_LENGTH; i++);
    if(i<Term::ID_LENGTH)
        return false;

    int fy= (*(id) - 48) * 10 + (*(id+1) - 48);//former year
    int ly= (*(id+2) - 48) * 10 + (*(id+3) - 48);//latter year
    int t= *(id+4) - 48;//term number
    if(ly - fy != 1)//any difference other than 1
        return false;
    if(!(t==1 || t==2 || t==0))//t==0 is for summer term
        return false;

    return true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:26:08.487

这段代码看起来像一个简单的数组溢出。如果您没有设置流来限制要读取的字符数，`std::cin >> str`则`str`作为`char`数组或指向的指针`char`是 C 的 C++ 版本：`gets()``width()`

```
char id[Term::ID_LENGTH];
std::cin.width(Term::ID_LENGTH); // <-- without this you are prone to array overrun!
if (std::cin >> id) {
    // deal with a successful read
} 
```

您应该考虑将`std::string`其用于字符串的输入：

```
std::string id;
if (std::cin >> id) {
    // deal with a successful read
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T03:54:19.857

`Term::ID_LENGTH`忘记计算'\0'的问题的根源。

# c++ - 这三种调用方法的语法有什么区别？

> ID：14096706
> 
> 赞同：1
> 
> 时间：2012-12-31T02:11:01.807
> 
> 标签：c++

以下都调用`T::f`object 上的函数`t`。

```
1\. t.f();
2\. t.T::f();
3\. (t.*&T::f)(); 
```

我见过第二个在另一个没有的地方使用过。这两者有什么区别，在什么情况下应该首选一个？

谢谢。

**编辑**：对不起，我忘了第二个`t.T::f()`。我把那个加进去了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T02:18:56.987

调用`t.f()`和`(t.*&T::f)()`语义相同，是调用成员函数的“正常”方式。即使是被覆盖的虚函数，该`t.T::f()`调用也会调用。`T::f()``f()`

表达式`(t.*&T::f)()`通过获取指向成员函数的指针来调用成员函数。此表达式可能具有的唯一潜在影响是它可能会抑制某些编译器的内联函数。使用从获得的变量`&T::f`来调用成员函数将是一个自定义点，但直接调用该函数仅仅是混淆和潜在的悲观（如果编译器无法进行足够的 const 传播以检测地址不能更改） .

我能*想象*的是有人*试图*禁止对`t`. 当然，这样是行不通的，因为指向成员的指针仍然会调用正确的虚函数。要禁止虚拟调度，您可以使用`t.T::f()`.

你应该更`t.f()`喜欢`(t.*&T::f)()`. 如果你想禁止虚拟调度，你会使用，`t.T::f()`否则你会使用`t.f()`. 禁止虚拟分派的主要用途是从覆盖函数中调用函数的基类版本。否则它很少有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T02:13:04.603

第一个是常规的，这是您应该喜欢的。第二个接受一个指向 的*成员函数指针*，取消对`f`的引用`t`，然后调用它。

如果那次额外的旅行有实际的好处，我不知道。`*&f()`这是调用*自由函数*时的成员版本。

您稍后添加的`t.T::f()`, 是*静态分派*的，因此即使`f`of`T`是虚拟的并且`t`是`T`具有自己实现的派生类，也会调用 of。它有效地抑制了虚调用机制。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-31T02:24:15.600

第二个是没有意义的，它只是混淆的代码。不，它不会禁用虚拟调度或内联。在每种情况下，他们都做完全相同的事情。

# javascript - 两位小数的正则表达式在 JavaScript 中不起作用。我错过了什么吗？

> ID：14096707
> 
> 赞同：2
> 
> 时间：2012-12-31T02:11:06.980
> 
> 标签：javascript, regex

我正在使用正则表达式来验证来自文本字段的输入以仅允许整数或最多两位小数的数字（例如：10、10.4、10.45、100.45），但是当我输入一个具有 3 或更多的数字时小数位仍然会验证它。代码如下所示。

```
var loanAmount = document.getElementById("loan_amount");

var loanRE = /\d+(\.\d{1,2})?/;

if (!(loanRE.test(loanAmount.value))){
alert("Not a valid input for the loan amount");
return false;
} 
```

一切对我来说都很好。我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T02:13:28.067

锚定你的正则表达式。`loadRE = /^\d+(\.\d{1,2})?$/`

否则它只会说“好的，有一些数字。它通过了！”

# php - 需要二维码协助才能获得入场二维码门票

> ID：14096708
> 
> 赞同：1
> 
> 时间：2012-12-31T02:11:15.810
> 
> 标签：php, mysql, qr-code

我几乎已经完成了一个想要使用二维码验证的俱乐部的原型注册页面。

所以这是我的原型： [http ://cinicraft.com/ticket/newcustomer.php](http://cinicraft.com/ticket/newcustomer.php)

原型由售票员运行，售票员在客户支付入场费后将客户信息输入表格。完成后，需要将售票员带到一个页面，该页面仅提供确认消息，例如：

```
Welcome James Raynor, thank you for purchasing a ticket. Here is your QR Code, use it to gain entry to the event: 
```

所以为了保持这个线程简单，我需要帮助获取一个用简单文本打印的二维码（二维码格式的 10 个字符的字母数字字符串）。

这是用于“http://cinicraft.com/ticket/add.php”的代码，在填写“http://cinicraft.com/ticket/newcustomer.php”中的表格后出现。

```
<?php
$fname = $_POST['fname'];
$lname = $_POST['lname'];
$email = $_POST['email'];

function random_string($length) {
    $key = '';
    $keys = array_merge(range(0, 9), range('a', 'z'));

    for ($i = 0; $i < $length; $i++) {
        $key .= $keys[array_rand($keys)];
    }

    return $key;
}

if($email)
{

$connect = mysql_connect("HOST", "DATABASE", "PASSWORD") or die("Couldn't Connect");

mysql_select_db("CiniCraftData") or die ("Couldn't Find Database"); 

            $query = "INSERT INTO customers (fname, lname, email, alphanum) VALUES ('$fname', '$lname', '$email', '" . random_string(10) . "')";

            $result = mysql_query($query) or die("Some kind of error occured.");

}
else die("You did not fill out the fields correctly, please try again.");
?>

<?php 
echo ("Welcome ");
echo ($fname);
echo (" ");
echo ($lname);
echo (", thank you for purchasing a ticket. Here is your QR Code, use it to gain entry to the event.");
?> 
```

好的，那么在您看到上面的所有代码之后，我怎么能打印出一个包含 10 个字符的字母数字字符串的二维码？

PS：我非常感谢到目前为止我从这个了不起的社区获得的所有帮助 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:54:13.137

查看[此](http://phpqrcode.sourceforge.net/#demo)二维码库。请参阅有关其用法的文档：

```
QRcode::png(random_string(10)); 
```

请记住，您不应输出任何其他内容，因为此代码将输出原始图像，并且在同一页面上输出的任何其他文本都会导致其损坏。所以对于这个例子，把它放在一个名为 'qr_png.php' 的文件中，然后显示图像，`<img src='qr_png.php' />`如果你愿意，你可以通过 $_GET 查询传递随机字符串。

# uiscrollview - UIScrollView 内的 UIImageView 流血在下一页

> ID：14096709
> 
> 赞同：0
> 
> 时间：2012-12-31T02:11:16.103
> 
> 标签：uiscrollview, uiimageview, uipagecontrol

我有一个 UIScrollView 和一个有 5 页的 UIPageControl。每页设置为不同的背景颜色。每页1024 x 768，仅支持横向模式，内容大小设置为：scrollView.contentSize = CGSizeMake(1024 * 5, 768);

每页显示正确的背景颜色和正确的大小。

我在每个可以移动的页面上放置一个 UIImageView。从第 2 页开始（或索引 1），如果图像被移动到左边的年龄并继续流血到上一页，您实际上可以转到前一页并在那里看到部分图像。

然而，右边缘不会发生同样的情况。如果图像移过可视区域，您将看不到下一页上的图像。

我的问题是这怎么可能，我能做些什么来防止它？

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T05:25:15.090

在玩了很多之后，为了帮助可能遇到相同情况的其他人，这个问题的答案是设置：

self.view.clipsToBounds = TRUE;

在您的 UIImageView(s) 添加为子视图的视图上。对我来说，每个页面都是 UIViewController 类的实例化，视图设置为窗口的边界。

# python - virtualenv + apt-get 混淆

> ID：14096713
> 
> 赞同：0
> 
> 时间：2012-12-31T02:12:37.117
> 
> 标签：python, virtualenv

我已经开始使用 virtualenv 并且我有疑问，欢迎任何提示。

这是我的场景：

1.  我激活了 virtualenv 并安装了一个包 XXX（使用 apt-get），它在我的 virtualenv/site-packages 中部署了一些 python 东西。

2.  停用虚拟环境

3.  运行 apt-get upgrade XXX

在这种情况下，XXX 的 python 东西会发生什么？它安装在全局站点包中吗？东西能坏吗？

对不起，如果这是一个愚蠢的问题，但是 python 包的部署对我来说有点模糊：/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T02:20:40.497

使用`apt-get`，包将始终在系统范围内安装，而不是在 virtualenv 中。这与 virtualenv 当前是否处于活动状态无关。

在您的情况下，这意味着该软件包在 1 中安装在系统范围内，并且该安装在 3 中升级。

如果你想在 virtualenv 中安装一些东西，你可以更接近`apt-get`使用[`pip`](http://pypi.python.org/pypi/pip)：

* * *

例子：

```
virtualenv ENV
source ENV/bin/activate
pip install django 
```

Django 现在安装在 virtualenv 中`./ENV`，但不是系统范围的。

相反，doing:`apt-get install python-django`将在系统范围内安装它，但不在 virtualenv 中。

# android - 将字符串从 PC 键盘发送到 android 输入视图

> ID：14096718
> 
> 赞同：0
> 
> 时间：2012-12-31T02:13:09.377
> 
> 标签：android, keyboard

我想开发一个工具来将字符串从 PC 键盘发送到 android 输入视图。当打开设备中的任何应用程序并按下输入视图时，我可以获得焦点视图。使用 hierachyviewer 这样的方式我可以获得焦点视图，使用 UIAutomator 我可以将字符串发送到视图。但是有什么方法可以像从软键盘输入一样，将字符串从 PC 键盘实时输入到视图中？任何人都可以提供一些帮助？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:20:59.633

你看过[MonkeyRunner](http://developer.android.com/tools/help/MonkeyRunner.html)吗？

可以使用jython，如下：

```
from com.android.monkeyrunner import MonkeyRunner, MonkeyDevice

dev = MonkeyRunner.waitForConnection()
dev.type( 'This is sent to the connected devices.' ) 
```

您只需要一些基本的 jython 来读取 pc 的键盘并使用 MonkeyDevice.type() 发送字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-25T05:18:19.923

我也在寻找类似的东西，所以我出于完全相同的原因制作了这个工具。它是高度可定制的。您也可以提供自己的自定义键映射工具或使用默认键映射。

[https://github.com/aakashsigdel/android-shell-input](https://github.com/aakashsigdel/android-shell-input)

如果您有任何问题，请告诉我

# git - 如何将文件添加到以前的提交中？

> ID：14096721
> 
> 赞同：129
> 
> 时间：2012-12-31T02:13:37.037
> 
> 标签：git

在过去的一个小时左右，我修改了文件

```
A
ATest
B
BTest 
```

为了确保我的提交消息与实际更改一致，提交`A`了描述。不幸的是，我没有包含`ATest`在该提交中。

同时，仍然没有承诺是`B`和`BTest`。

在这一点上进行的最佳方法是什么？我想：

1.  恢复以前的提交而不影响我当前未提交的文件？
2.  将相同描述下的另一个文件添加到上一个提交中？

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2012-12-31T02:17:58.980

要将新文件添加到上一个提交：

```
$ git add new-file
$ git commit --amend 
```

`git commit --amend --no-edit`如果您不想更改提交消息，则可以使用。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2012-12-31T02:24:14.633

这是一个有趣的流程图¹，它也非常方便：它为原始问题和修改后的“如果它不是最后一次提交怎么办？”提供了正确的建议。问题。

[![Git-漂亮的流程图](../Images/269cbf90f277efddee4532fb64ae4eb8.png)](https://i.stack.imgur.com/TsDYW.png)

¹取自[http://justinhileman.info/article/git-pretty/](http://justinhileman.info/article/git-pretty/)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2017-01-07T03:47:35.280

**将文件添加到先前的提交**

如果您已经推送了您正在处理的分支，请先查看[手册页](https://git-scm.com/docs/git-rebase#_recovering_from_upstream_rebase)。请特别注意：

> Rebase（或任何其他形式的重写）其他人基于其工作的分支是一个坏主意：它下游的任何人都被迫手动修复他们的历史记录。

但是，如果您还没有推动您的分支，请准备进入*危险区域*。

**查找提交哈希**

首先，您需要知道要添加到的提交的提交哈希。这由 显示`git log`。您实际上想在要添加的提交*之前*指定提交。（您可以将其视为要更改的提交片段的起始索引。）您可以通过运行`git log -1 HEAD~n`. 其中 'n' 是一个整数，你递增直到你有正确的提交。或者你可以数数，真的没有。

但是，如果你计算，至少确认你有正确的提交`git log -1 HEAD~5`或任何你的计数。您不应该看到要添加的提交。

**危险**，嘿嘿

现在您可以运行`git rebase -i HEAD~5`了，或者改用提交哈希`git rebase -i hash^`。这将打开您最喜欢的文本编辑器和要编辑的文件。该文件是 rebase 命令的待办事项列表。文件中的注释告诉您有哪些选项。只需找到要添加的提交所在的行，然后在该行上将“pick”更改为“edit”。现在保存并关闭文件。

一旦达到您告诉它编辑的提交，rebase 将停止。运行 a`git status`以查看它提供的额外信息。`git add .`暂存您的文件以使用或任何文件名添加到提交中。

然后，执行`git commit --amend`or `git commit --amend --no-edit`（如果您不想编辑提交消息）。这将修改您选择编辑的提交。

最后，运行`git rebase --continue`。

如果有疑问，在 Linux 上，您可以通过阅读`man git-rebase`或的文档输出来了解更多信息`git --help rebase`。

# mysql - 多用户偏好的数据库设计？

> ID：14096724
> 
> 赞同：2
> 
> 时间：2012-12-31T02:14:19.267
> 
> 标签：mysql, database, postgresql, database-design

我正在为一个约会网站设计一个数据库，该网站需要用户选择合作伙伴的偏好，这反过来又推动了匹配过程。本质上，我想要的是用户能够为每个偏好设置单个或多个选项。例如，合作伙伴位置可以是仅限纽约或纽约、波士顿、迈阿密、洛杉矶等。我想知道我的想法是否是首选的做事方式。

这就是我想做的事情。

```
Users Table |    User_Options Table    |    Options Table    | Preferences Table
            |                          |                     |           
ID | Name   | ID | User_id | Option_ID | ID | Name | Pref_id | ID | Name 
1\. | John   | 1\. |  1\.     |   1\.      | 1\. |  NY  |   1     | 1\. | Location
            |                          |                     | 
```

这样，每个选项都有很多选项，每个选项都有很多用户。我已将选项表链接到首选项，以便我可以根据首选项类别调用用户。我希望`user.location`或类似的东西会给我用户选择的所有位置选项。我的偏好表将包括宗教、位置、饮食、饮酒习惯等。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T03:28:22.767

我非常喜欢首先从[领域驱动设计](http://en.wikipedia.org/wiki/Domain-driven_design)的角度来看待这个问题。这是一个相当深入的主题，但总的来说，您希望对关键概念进行建模并确保您将编写的代码是合理的。这假设您计划以面向对象的方式解决此问题。

如果您根据具有状态和行为的对象来考虑您的项目，那么您将（希望）最终得到可以更好地处理更改的更健壮的代码。

在实体方面，我首先定义“用户”及其个人属性（“姓名”、“宗教”、“位置”）。

然后，我将仔细研究您计划用来生成“匹配”的每个首选项。您可能会发现很多需要考虑添加到模型中的东西（即“位置”是一组纬度/经度和半径或一组邮政编码）。

我的感觉是，最初在选项和偏好方面变得通用会适得其反。您至少需要定义其中的一些，看看有什么共同点，并将共同点提升到父类或接口中。

对于数据持久性，请在代码中保持职责分离。您的实体不应该为自救负责。您应该创建其他对象，将您的实体映射到您选择的任何数据库（文档，任何）结构。这将使您可以更改底层持久层，而不会直接影响站点的功能。说 PHP 的一个例子是[Doctrine ORM](http://www.doctrine-project.org/)。

最后，熟悉单元测试。您没有提及您的实现语言，因此这里列出了您用作参考[的单元测试框架。](http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks)

我知道这并不能直接回答您的问题，因此可以为您提供更多有关主题的答案；

*   保持数据库规范化（除非您*需要*非规范化以提高性能）
*   使用外键来维护参照完整性
*   在需要时重构您的数据库结构

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T04:46:04.980

查看您的解释，我建议拆分两个实体，即：偏好和位置。如果您将位置包含在首选项表中，您可能需要标记列，或者此首选项是否是位置。我假设系统应该找到具有相同偏好的匹配项，即爱好、宗教**和**居住在理想的地区，没有相同的偏好**或**居住在某个地区。因此，我建议稍微更改架构。

![在此处输入图像描述](../Images/191e2bc4ed15830652818811a4a1b5d1.png)

然后，您可以简单地查询另一个用户偏爱的某个特定位置中的匹配项以及他选择的偏好（如果我们正在寻找 user_id 为 1 的用户的匹配项，遵循他/她的偏好位置和偏好）：

```
select r.user_id
from
(select uu.user_id from users u
right join user_location ul using (user_id)
right join users uu on uu.location_id = ul.location_id
where u.user_id = 1) r
inner join user_preference up on up.user_id = r.user_id
inner join user_preference up1 on up1.preference_id = up.preference_id and 
       up1.user_id = 1
group by r.user_id; 
```

另一个问题：如果您在考试中使用像 User_Options 这样的联结表 - 不需要创建人工密钥。在这种情况下，复合主键（user_id 和 option_id）将更加合理。（查看我的示例中的 2 个联结表 - user_locations 和 user_preferences）。

# java - JTree：为各个组设置自定义打开/关闭图标

> ID：14096725
> 
> 赞同：2
> 
> 时间：2012-12-31T02:14:21.737
> 
> 标签：java, swing, icons, jtree, treecellrenderer

1.  我知道如何在 JTree 中设置自定义叶子图标
2.  我知道如何为所有组节点设置自定义关闭/打开图标

但是我不能根据组节点名称设置自定义打开/关闭图标，例如节点可以称为电子邮件（所以有一个信封图标很好）或者一组可以称为任务等等。

我试图通过覆盖`getTreeCellRendererComponent`类的方法来做到这一点`DefaultTreeCellRenderer`

但是改变`icon`当前`node`节点只会影响下一个节点！

如何为各个组设置自定义打开/关闭图标？

请看一下我的代码：

***雇员.java***

```
package com.ehsunbehravesh.swing;

import java.util.Random;

public class Employee {

  public String name;
  public int id;
  public boolean isBoss;
  public Employee[] employees;

  public Employee(String name, boolean isBoss) {
    this.name = name;
    this.isBoss = isBoss;
    this.id = new Random(System.currentTimeMillis()).nextInt(Integer.MAX_VALUE);
  }  

  @Override
  public String toString() {
    return this.name;
  }

    static String randomName() {
    String chars = "abcdefghijklmnopqrstuvwxyz";
    StringBuilder builder = new StringBuilder();
    Random r = new Random(System.currentTimeMillis());
    int length = r.nextInt(10) + 1;
    for (int i = 0; i < length; i++) {
      builder.append(chars.charAt(r.nextInt(chars.length())));
    }

    return builder.toString();
  }
} 
```

***CustomTreeNode.java***

```
package com.ehsunbehravesh.swing;

import javax.swing.ImageIcon;
import javax.swing.tree.DefaultMutableTreeNode;

public class CustomTreeNode extends DefaultMutableTreeNode {

  /**
   * The icon which is displayed on the JTree object. open, close, leaf icon.
   */
  private ImageIcon icon;

  public CustomTreeNode(ImageIcon icon) {
    this.icon = icon;
  }

  public CustomTreeNode(ImageIcon icon, Object userObject) {
    super(userObject);
    this.icon = icon;
  }

  public CustomTreeNode(ImageIcon icon, Object userObject, boolean allowsChildren) {
    super(userObject, allowsChildren);
    this.icon = icon;
  }

  public ImageIcon getIcon() {
    return icon;
  }

  public void setIcon(ImageIcon icon) {
    this.icon = icon;
  }    
} 
```

***CustomeTreeCellRenderer.java***

```
package com.ehsunbehravesh.swing;

import java.awt.Component;
import javax.swing.JTree;
import javax.swing.tree.DefaultTreeCellRenderer;

class CustomeTreeCellRenderer extends DefaultTreeCellRenderer {

  public CustomeTreeCellRenderer() {
  }

  @Override
  public Component getTreeCellRendererComponent(JTree tree, Object value, boolean selected, boolean expanded, boolean leaf, int row, boolean hasFocus) {
    super.getTreeCellRendererComponent(tree, value, leaf, expanded, leaf, row, hasFocus);

    if (!leaf) {
      CustomTreeNode node = (CustomTreeNode) value;
      System.out.println(((Employee) node.getUserObject()).name);

      if (node.getIcon() != null) {
        System.out.println(node.getIcon().toString());
        setClosedIcon(node.getIcon());
        setOpenIcon(node.getIcon());
      } else {
        setClosedIcon(getDefaultClosedIcon());
        setClosedIcon(getDefaultOpenIcon());
        setOpenIcon(getDefaultOpenIcon());
      }
    }

    return this;
  }
} 
```

***测试1.java***

```
package com.ehsunbehravesh.swing;

import java.awt.BorderLayout;
import java.awt.Color;
import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTree;
import javax.swing.tree.DefaultTreeModel;

class TreeSample {
  public static void main(String args[]) {
    JFrame f = new JFrame("JTree Sample");
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JPanel pnlMain = new JPanel(new BorderLayout());
    pnlMain.setBackground(Color.white);

    createTree(pnlMain);

    f.setContentPane(pnlMain);

    f.setSize(300, 200);
    f.setVisible(true);
  }

  private static void createTree(JPanel pnlMain) {
    Employee bigBoss = new Employee(Employee.randomName(), true);
    Employee[] level1 = new Employee[5];    
    bigBoss.employees = level1;

    for (int i = 0; i < level1.length; i++) {
      level1[i] = new Employee(Employee.randomName(), true);      
    }

    for (int i = 0; i < level1.length; i++) {
      Employee employee = level1[i];
      if (employee.isBoss) {
        int count = 5;
        employee.employees = new Employee[count];

        for (int j = 0; j < employee.employees.length; j++) {
          employee.employees[j] = new Employee(Employee.randomName(), false);          
        }
      }
    }

    CustomTreeNode root = new CustomTreeNode(new ImageIcon("images/Circle_3.gif"), bigBoss);           
    DefaultTreeModel model = new DefaultTreeModel(root);

    for (Employee employee : bigBoss.employees) {
      CustomTreeNode boss = new CustomTreeNode(new ImageIcon("images/Circle_2.gif"), employee);
      root.add(boss);
      if (employee.isBoss) {                
        for (Employee employee1 : employee.employees) {
          CustomTreeNode emp = new CustomTreeNode(new ImageIcon("images/Circle_1.gif"), employee1);
          boss.add(emp);
        }
      }
    }

    JTree tree = new JTree(model);
    tree.setCellRenderer(new CustomeTreeCellRenderer());            
    pnlMain.add(tree, BorderLayout.CENTER);
  }  
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T03:59:01.660

在您的`TreeCellRenderer`中，您可以根据需要将`setOpenIcon()`和`setClosedIcon()`与与您的模型相关的已定义参数和谓词一起使用。给定具有默认`JTree`模型的树，`TreeRenderer`下面将使用`closed`和`open`图标作为`sports`节点：

![图像](../Images/46ce54e2ad94119105dc12ab64707e0d.png)

```
private static class TreeRenderer extends DefaultTreeCellRenderer {

    private static final Icon closed =
        (Icon) UIManager.get("InternalFrame.maximizeIcon");
    private static final Icon open =
        (Icon) UIManager.get("InternalFrame.minimizeIcon");

    @Override
    public Component getTreeCellRendererComponent(JTree tree, Object value,
        boolean sel, boolean exp, boolean leaf, int row, boolean hasFocus) {
        DefaultMutableTreeNode node = (DefaultMutableTreeNode) value;
        String s = node.getUserObject().toString();
        if ("sports".equals(s)) {
            setOpenIcon(open);
            setClosedIcon(closed);
        } else {
            setOpenIcon(getDefaultOpenIcon());
            setClosedIcon(getDefaultClosedIcon());
        }
        super.getTreeCellRendererComponent(
            tree, value, sel, exp, leaf, row, hasFocus);
        return this;
    }
} 
```

另请参阅此相关[示例](https://stackoverflow.com/a/8351850/230513)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-31T07:05:16.683

运行代码后，您尝试加载的图像似乎“意味着”嵌入到您的应用程序中（也就是说，它们不驻留在应用程序上下文之外的磁盘上的某个位置）。

因此，与其这样做...

```
CustomTreeNode root = new CustomTreeNode(new ImageIcon("images/Circle_3.gif"), bigBoss); 
```

尝试做这样的事情......

```
CustomTreeNode root = new CustomTreeNode(new ImageIcon(ImageIO.read(getClass().getResource("/images/Circle_3.gif"))), bigBoss); 
```

反而。这将导致 Java 在其类路径（包括任何 JAR 资源）中查找图像。

当我在没有此修复的情况下运行您的代码时，没有任何效果，当我更新它以使用此功能时，它运行良好。

注意：`ImageIO#read`抛出一个`IOException`所以要小心

**更新**

经过多次挠头......我将单元格渲染器更改为如下所示......

```
class CustomeTreeCellRenderer extends DefaultTreeCellRenderer {

    public CustomeTreeCellRenderer() {
    }

    @Override
    public Component getTreeCellRendererComponent(JTree tree, Object value, boolean selected, boolean expanded, boolean leaf, int row, boolean hasFocus) {

//            if (!leaf) {
        CustomTreeNode node = (CustomTreeNode) value;

        if (node.getIcon() != null) {
            System.out.println(node + " - " + node.getIcon());
            setClosedIcon(node.getIcon());
            setOpenIcon(node.getIcon());
            setLeafIcon(node.getIcon());
        } else {
            System.out.println(node + " - default");
            setClosedIcon(getDefaultClosedIcon());
            setLeafIcon(getDefaultLeafIcon());
            setOpenIcon(getDefaultOpenIcon());
        }
//            }

        super.getTreeCellRendererComponent(tree, value, selected, expanded, leaf, row, hasFocus);

        return this;
    }
} 
```

它清除了一切...

![在此处输入图像描述](../Images/c9380e9b50be7b187d71d2156b7df576.png)

调用`setXxxIcon`不会影响当前的渲染器，但会影响未来的渲染器。那是。如果你在调用`setOpenIcon`之后调用`super.getTreeCellRendererComponent`，它不会影响当前的渲染器，但它会影响下一次调用，`super.getTreeCellRendererComponent`因为 set 方法只是设置类变量的值。

**额外的**

Trashgod 对依赖实施及其现在的工作方式发表了有价值的评论。

`DefaultTreeCellRenderer#setXxxIcon`而不是在方法中调用`getTreeCellRendererComponent`，您实际上应该简单地调用`DefaultTreeCellRenderer#setIcon`，使用基于传递给它的参数的所需图标。

这意味着您可以`super.getTreeCellRendererComponent`先调用，然后覆盖其后图标的行为。

您还可以获取对`Object`value 的引用并覆盖`DefaultTreeCellRenderer#getXxxIcon`方法，并根据 value 更改这些方法的返回值。我个人不会鼓励这样做，因为它会改变渲染器的记录行为

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-31T05:28:39.900

如果我们需要组件（因此我们需要在第一步调用超级渲染器），设置所有树图标（打开、关闭、叶子）以使其正常工作很重要。

```
public java.awt.Component getTreeCellRendererComponent(javax.swing.JTree tree, Object value, boolean selected, boolean expanded, boolean isLeaf, int row, boolean focused) {
    Component c = super.getTreeCellRendererComponent(tree, value, selected, expanded, isLeaf, row, focused);

    DefaultMutableTreeNode node = (DefaultMutableTreeNode) value;
    MyTreeNodeWrapper treeNodeWrapper = (MyTreeNodeWrapper) node.getUserObject();
    Icon icon = treeNodeWrapper .getIcon();

    setOpenIcon(icon);
    setClosedIcon(icon);
    setLeafIcon(icon);

    if (!tree.isEnabled()) {
        if (isLeaf) {
            setDisabledIcon(getLeafIcon());
        } else if (expanded) {
            setDisabledIcon(getOpenIcon());
        } else {
            setDisabledIcon(getClosedIcon());
        }
    }
    else {
        if (isLeaf) {
            setIcon(getLeafIcon());
        } else if (expanded) {
            setIcon(getOpenIcon());
        } else {
            setIcon(getClosedIcon());
        }
    }

return c;

} 
```

如果没有，如上所述，我们只需要设置 3 种图标类型：

```
public java.awt.Component getTreeCellRendererComponent(javax.swing.JTree tree, Object value, boolean selected, boolean expanded, boolean isLeaf, int row, boolean focused) {

    DefaultMutableTreeNode node = (DefaultMutableTreeNode) value;
    MyTreeNodeWrapper treeNodeWrapper = (MyTreeNodeWrapper ) node.getUserObject();
    Icon icon = treeNodeWrapper .getIcon();

    setOpenIcon(icon);
    setClosedIcon(icon);
    setLeafIcon(icon);

Component c = super.getTreeCellRendererComponent(tree, value, selected, expanded, isLeaf, row, focused);

return c;

} 
```

# mysql - 在 MySQL 中左排除 JOIN

> ID：14096726
> 
> 赞同：0
> 
> 时间：2012-12-31T02:14:27.507
> 
> 标签：mysql, sql, join

我有这个工作 MySQL 查询（它被剥离以仅显示相关行）：

```
SELECT
  c.id AS id_comment
, bl.id_user AS block
FROM comments AS c
LEFT JOIN user_blocked AS bl ON 
  (c.id_user = bl.id_user AND :uid = bl.id_user_blocked) 
  OR (c.id_user = bl.id_user_blocked AND :uid = bl.id_user)
WHERE (c.id_title = :idt) 
```

有用！但我只想得到结果，`block IS NULL`所以我在其中添加了一个新条件`WHERE`：

```
SELECT
  c.id AS id_comment
, bl.id_user AS block
FROM comments AS c
LEFT JOIN user_blocked AS bl ON 
  (c.id_user = bl.id_user AND :uid = bl.id_user_blocked) 
  OR (c.id_user = bl.id_user_blocked AND :uid = bl.id_user)
WHERE (c.id_title = :idt) AND (block IS NULL) 
```

但我得到这个错误：

```
SQL ERROR: SQLSTATE[42S22]: Column not found: 1054
Unknown column 'block' in 'where clause' 
```

为什么？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:16:34.413

`block`是一个`ALIAS`，你应该使用列的名称来代替

```
SELECT...
FROM...
WHERE (c.id_title = :idt) AND (bl.id_user IS NULL) 
```

之所以没有找到是因为操作顺序如下：

*   FROM 子句
*   WHERE 子句
*   GROUP BY 子句
*   HAVING 子句
*   选择子句
*   ORDER BY 子句

如果要`block`使用列名来代替，则需要将整个查询放在一个`SubQuery`. 例如

```
SELECT  * 
FROM
(
    SELECT  c.id AS id_comment, 
            bl.id_user AS block
    FROM    comments AS c
            LEFT JOIN user_blocked AS bl 
                ON  (c.id_user = bl.id_user AND :uid = bl.id_user_blocked) OR 
                (c.id_user = bl.id_user_blocked AND :uid = bl.id_user)
    WHERE   c.id_title = :idt
) s
WHERE block IS NULL 
```

*但我更喜欢第一个解决方案而不是使用子查询*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T02:16:56.150

您不能引用列别名；改为引用 true 列：

```
WHERE (c.id_title = :idt) AND (bl.id_user IS NULL) 
```

# maven - 将工件提交到 Maven 中央存储库的程序和要求是什么？

> ID：14096729
> 
> 赞同：6
> 
> 时间：2012-12-31T02:15:19.383
> 
> 标签：maven, open-source, repository, artifacts, maven-central

我想需要一些通行证才能将工件提交到 Maven 中央存储库。

我想详细了解有什么要求，要遵循的程序是什么，以及在此过程中是否有教程或指南可以提供帮助。

我听说您还需要对工件进行数字签名（gpg），有关此的一些详细信息也将受到欢迎。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T08:50:12.407

如果您的代码是 OSS，则有一个通过 Sonatype 发布的“快速通道”流程。

# 简短的回答：

请参阅[Sonatype OSS Maven 存储库使用指南](https://docs.sonatype.org/display/Repository/Sonatype+OSS+Maven+Repository+Usage+Guide)

# 长答案：

基本上，这是我不久前为[beanstalk-maven-plugin](http://beanstalker.ingenieux.com.br/beanstalk-maven-plugin/)所做的：

1.  我已经在 HKP Keyservers 中为我的电子邮件生成并注册了一个新的 GPG 密钥（很简单）。确保你有你的密钥备份（实际上，我建议你在一个完全独立的机器上创建你的密钥，这样你就可以知道你的备份/导出程序正在运行）

2.  在 Sonatype OSS 项目 Jira Tracker 中打开了一个指向 groupId、源 SCM url 和其他详细信息的问题。批准大约需要 48 小时。

3.  将my 配置`pom.xml`为使用 sonatype-parent pom 作为父级。这增加了许多额外的信息和验证。

4.  为标记/发布设置 SCM。

5.  设置 jenkins，这样我的`-SNAPSHOT`版本也将发布到 oss.sonatype.org。

现在，通过 Sonatype 的发布过程本身非常简单：

*   调用`release:prepare`并`release:perform`进入OSS Staging。您的新版本将进入 Sonatype Staging
*   登录 OSS Staging，然后“关闭”Staging Repository - 如果有任何验证错误（例如没有源的工件），它会发出警告，并且您可能会发出“Drop”。
*   如果一切顺利，您可以改为调用“Release”，它会在几个小时内同步到中央。

# 引擎盖下

如果您使用的是 Maven，那么大多数更改只需要使用相关细节（组、邮件列表、主页，尤其是`<scm/>`）装饰您的 POM。（[查看其源代码](https://github.com/sonatype/oss-parents/blob/master/oss-parent/pom.xml)`sonatype-oss-parent`）pom 完成所有剩余的工作，其中包括：

*   `<distributionManagement/>`标签_
*   `maven-enforcer-plugin`配置（特别是为了避免来自 的一些错误签名`maven-gpg-plugin`）
*   `maven-release-plugin`在 OSS 上发布时要调用的特殊构建配置文件的 设置，其中包括以下调用：
    *   `source:jar`
    *   `javadoc:jar`
    *   `gpg:sign`

当然，您可以手动完成所有操作 - 只需将 sonatype-oss-parent 的内容复制到您自己的内容中即可。但是，我认为它有点可避免的麻烦。:)

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T07:12:25.697

[好吧，您可以在此处](http://maven.apache.org/guides/mini/guide-central-repository-upload.html)阅读有关如何在 Maven Central Repo(s) 上上传包的完整分步详细指南。

[此外，您可以在此处](http://maven.apache.org/guides/introduction/introduction-to-repositories.html)阅读有关存储库的信息

# php - 增量控制器变量

> ID：14096730
> 
> 赞同：-1
> 
> 时间：2012-12-31T02:15:32.530
> 
> 标签：php, codeigniter, variables, increment, laravel

拥有如下控制器：

```
Class Upload extends Controller{
        private $up_count = 0;
        public function action_tmpupload()
        {
                if($this->up_count == 0)
                {
                        //empty a session variable
                }

                //some more coding to save data into a session variable

                $this->up_count++;
                return true;
        }
} 
```

我一直想知道我做错了什么，因为`$up_count`变量不会增加它的值，它总是保持为 0。

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T07:38:41.577

问题是您将变量设置为0。

然后下次运行控制器时...再次将变量设置为 0！

您需要在用户会话中保存 up_count 变量 - 并从同一会话中检索 up_count

# data-structures - 为什么我们不在红黑树插入中添加一个黑色节点而不是一个红色节点？

> ID：14096732
> 
> 赞同：2
> 
> 时间：2012-12-31T02:15:39.227
> 
> 标签：data-structures, tree, red-black-tree, clrs

在红黑树插入中，我们总是选择将新节点添加为红色，这样我们就可以避免改变树的黑色高度。为什么这比添加黑色节点更可取？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T03:33:04.560

我认为这是由于红黑树的规则......

```
1\. A node is either red or black.
2\. The root is black.
3\. All leaves (NIL) are black.
4\. Both children of every red node are black.
5\. Every simple path from a given node to any of its descendant leaves contains the same number of black nodes. 
```

在树的底部添加了一个插入，将一个叶子（黑色 nil）节点替换为一个具有值和 2 个黑色 nil 子节点的节点。规则 5 规定每条路径上的黑色节点数必须相同。如果您添加了一个黑色节点，您将违反此规则。我将尝试说明。

```
 B(10)
             R(5)                    B(15) 
    B(1)              B(6)       B(NIL)   B(NIL)
B(NIL) B(NIL)    B(NIL) B(NIL) 
```

您会注意到，在每条路径上都有 3 个黑色节点。如果您尝试在 15 下插入一个新节点 16 作为黑色节点（请记住，您正在添加的节点下添加 2 个黑色 nil 节点），该路径将变得更长 (4)。像这样是不正确的：

```
 B(10)
             R(5)                     B(15) 
    B(1)              B(6)       B(NIL)     B(16)
B(NIL) B(NIL)    B(NIL) B(NIL)          B(NIL) B(NIL) 
```

为了满足所有规则，您需要插入一个红色节点，并且每条路径上的黑色节点数将保持相等。

```
 B(10)
             R(5)                     B(15) 
    B(1)              B(6)       B(NIL)     R(16)
B(NIL) B(NIL)    B(NIL) B(NIL)          B(NIL) B(NIL) 
```

# php - 将表单操作设置为外部 php 文件中的函数

> ID：14096733
> 
> 赞同：6
> 
> 时间：2012-12-31T02:16:22.137
> 
> 标签：php, html, forms

我是 PHP 新手（有点），我环顾四周，找不到任何完全符合我的问题的信息，所以就在这里；

假设我声明了一个表单，有 2 个字段和一个提交按钮；

```
<form name = "tryLogin" action = "logIn()" method = "post">
            Username: <input type = "text" name = "username" placeholder = "username.."><br>
            Password: <input type = "text" name = "password" placeholder = "password.."><br>
            <input type = "submit" value = "Submit">
</form> 
```

在这里你可以看到我已经尝试将操作设置为函数“logIn()”，我已经包含在这个文件的标题中。

在一个外部 php 文件中，我有以下内容；

```
function logIn()
{
if($_POST['username'] == "shane" && $_POST['password'] == "shane")
{
    $_SESSION['loggedIn'] = '1';
    $_SESSION['user'] = $_POST['username'];
}

header ("Location: /index.php");
}

function logOut()
{
$_SESSION['loggedIn'] = '0';
header ("Location: /index.php");
} 
```

（忽略任何“你不应该这样做，那样做”，我只是在这里画一张照片）。

所以基本上我希望表单提交给那个特定的功能，这可能吗？我在这里做一些根本错误的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T02:26:38.380

正如其他人所说，您不能自动将帖子定向到函数，但您可以根据使用 PHP 代码提交的表单动态决定在 PHP 端做什么。一种方法是使用隐藏输入定义逻辑，以便您可以在同一页面上处理不同的操作，如下所示：

```
<form name="tryLogin" action="index.php" method="post">
            <input type="hidden" name="action" value="login" />
            Username: <input type="text" name="username" placeholder="username.."><br />
            Password: <input type="text" name="password" placeholder="password.."><br />
            <input type="submit" value="Submit">
</form>

<form name="otherform" action="index.php" method="post">
            <input type="hidden" name="action" value="otheraction" />
            Type something: <input type="text" name="something"><br />
            <input type="submit" value="Submit">
</form> 
```

然后在你的 PHP 中：

```
if (isset($_POST['action'])) {
    switch($_POST['action']) {
    case 'login':
        login();
        break;
    case 'otheraction':
        dosomethingelse();
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T02:24:19.530

直接回答你的问题，*是*的，你做错了什么。但是，它很容易修复。

表单上的*操作*是它提交表单的地方——即发送请求的页面。正如您所说，您的代码位于“页面顶部”，您需要将表单提交回它所在的页面。因此，您可以将页面的完整 URL 放入操作中，也可以将其留空：

```
<form name = "tryLogin" action = "" method = "post"> 
```

为了处理提交，PHP 没有办法直接从客户端代码调用函数，但是，您可以通过发送带有当前“任务”的隐藏字段以更具请求处理的方式处理请求。

例如，在 HTML 表单中，尝试添加：

```
<input type="hidden" name="task" value="logIn" /> 
```

然后，在 PHP 代码中，尝试添加：

```
if (isset($_POST['task'])) {
    if ($_POST['task'] == 'logIn') {
        // the user is trying to log in; call the logIn() function
        logIn();
    } else if ($_POST['task'] == 'logOut') {
        // the user is trying to log out; call the logOut() function
        logOut();
    }
} 
```

此代码将通过检查`task`字段是否已发布来检查表单是否已提交。然后，它将检查该值。如果是`logIn`，`logIn()`将调用该函数。或者，如果它是`logOut`，`logOut()`则将调用该函数。

要创建注销表单，您将相应地调整操作并像上面一样向该表单添加一个隐藏字段，但值为`logOut`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T02:20:49.367

不，您将表单提交到页面并在提交表单时运行您的函数：

html:

```
<form action="index.php" method="post"> 
```

PHP（索引.php）：

```
if ($_SERVER['REQUEST_METHOD'] == "POST"){
    // Run your function
    login();
} 
```

# windows-7-x64 - 你能让一个目录表现得像“Program Files”/“Program Files(x86)”吗？

> ID：14096737
> 
> 赞同：1
> 
> 时间：2012-12-31T02:16:57.673
> 
> 标签：windows-7-x64

`C:\Program Files (x86)`除了Windows 7 Pro 上的 Program Files 目录（例如）之外，某些应用程序无法从任何地方运行。

如果我想将某些东西安装到另一个驱动器（例如`I:\OtherPrograms`），这些程序根本不起作用。有没有办法让其他目录表现得像两个 Program Files 目录？

仅供参考：“以管理员身份运行”不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:27:19.877

**限制权限**

这听起来更像是导致这些问题的问题或错误安装，而不是安全行为。简而言之，windows 将根据您的用户级别决定您在何处以及对哪些内容具有执行权限。当您以管理员身份运行时，您可以完全访问做任何您想做的事情（事实上他们不以管理员身份运行更可能意味着出现问题）。

综上所述，您可以调整用户权限并阻止用户执行已知目录中的程序。因此，如果您让您的用户安装后台服务或以管理员身份运行您的程序，您可以更改 Windows 权限并阻止他们在可接受的目录之外执行任何操作。

如果您是您只想在特定目录中运行的程序的作者，该目录将成为您编码的一部分。您可能想要获取应用程序路径目录，可能会将其与您当前的工作目录等进行比较，以判断用户是否从接受的路径启动了程序。然后，您可以编写程序以警告用户并关闭。

至于只是告诉windows（如果它存在于这个路径中，你只能运行这个程序）可以通过权限来完成，但它不一定会影响未来的变化。例如，您可以将其设置为用户不能在 C:\Apps 中执行。但是在您的程序操作权限并从那里执行后，用户可能会创建 C:\Apps\Haha。你运行的越多，你在他们自己的系统上为用户提供的功能越少，他们使用你的产品的可能性就越小，所以除非你有一个非常好的理由，否则这并不是你真正想做的事情。

**如果安装在其他位置会失败的程序**

在对此进行了更多讨论之后，最初的问题似乎是，如果您将程序安装在 Program Files 目录之外的某个位置，您将如何修复该程序失败。简而言之，答案是你没有，这不是窗户或你的错。“程序文件”或“程序文件（x86）”目录只是世界认为它们的“特殊”。就计算机而言，它们只是硬盘驱动器上的路径。就 Windows 而言，它们只是硬盘驱动器上的一条路径。

唯一真正开始有所不同的是Windows将“环境变量”暴露给程序（在代码级别）。这些环境变量在注册表中存储和编辑。在另一篇文章中指出的其中一个可以让您告诉窗口您的“程序文件”目录在哪里。更改此路径可能会导致许多已安装程序开始出现问题，因此出于任何原因通常不建议这样做。

关于“程序文件”目录的另一件事是程序可以向窗口询问它的“程序文件”路径。Windows 将检查注册表并告诉您的程序当前的“程序文件”路径是什么。这更有可能是您的程序存在问题，而不是它们安装在程序文件目录之外的某个位置。编码人员可能认为您将安装在程序文件目录中，因此当您尝试运行程序时，它正在程序文件目录中寻找资源，但您将其安装在任何自定义目录中。解决此问题的唯一方法是进行自定义安装，并在它要求您提供路径时密切注意。您需要为每个程序寻找文档来修复它。

**关于权限的更多信息**

也只是为了进一步说明 UAC（用户访问控制或权限）。它们基本上是基于操作系统上的用户帐户的规则集。（在这种情况下是 Windows 和 PC 用户）。当您使用计算机时，您将登录到这些 PC 用户帐户之一。然后，Windows 将根据为您的用户帐户设置的规则授予您对目录和文件的访问权限。

当你分解它们时，这些规则实际上是非常基本的。规则可以应用于目录或文件，系统上的每个目录和文件都有为其设置的规则。在大多数情况下，这些规则都是在幕后设置和处理的，因此您可能不知道它们。这些规则基于 3 个条件分离访问权限，即文件或目录的所有者、目录或文件的关联组以及其他所有人。这意味着每个目录或文件的每个“规则”都包含 3 个条件。规则的这些条件中的每一个都会告诉我们用户是否可以读取、写入、执行或这三者的任意组合。

因此，话虽如此，并将其应用于问题，当您安装程序时，您首先执行安装程序。然后，该安装程序可能会尝试以管理员身份运行，或者可能会要求您让它成为管理员。安装程序从这里开始在您的系统上放置文件（无论您告诉它到哪里，在大多数情况下它都不会触及您的权限）。一旦所有文件就位，安装程序就会退出，您可以开始使用您的程序。在这一点上，假设程序可以运行并且没有错误，并且安装程序安装了你需要的所有东西，你准备好了。现在唯一可能妨碍您的是您的用户权限不允许您在刚刚安装的目录中执行程序。很可能虽然这不会发生，但如果您已经写了您

现在，当您（从任何地方）运行程序时，您会告诉 Windows“启动此程序”Windows 检查权限，如果您可以在该路径中执行该文件或文件，那么它将运行该程序。如果不是，它会告诉你你不能，并告诉你为什么。该程序启动，它拥有与您启动它时完全相同的所有权限。如果您以管理员身份运行，该程序肯定会启动，并且将获得对所有内容的完全权限（在大多数情况下是个坏主意）。就是这样，没有什么会说“如果您从 Program Files 启动让自己成为管理员”或“如果您在程序文件中可以编辑系统注册表项”。这一切都基于用户的权限和“谁”启动程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T02:24:25.333

我所知 。有一种方法你可以试试。有一些风险，所以要小心。

启动“运行”对话框。输入“regedit”，然后打开 regedit 编辑器。找到这个值。

```
"HKEY_LOCAL_MACHINE\Software\ Microsoft\Windows\CurrentVersion" 
```

在右侧窗口中，找到“ProgramFilesDir”双击它，然后将其值修改为您的位置。然后输入。关闭 regedit editor.reboot 你的电脑..

# ruby-on-rails - 编辑显示所有 ID 的路径 URL？

> ID：14096739
> 
> 赞同：0
> 
> 时间：2012-12-31T02:17:20.357
> 
> 标签：ruby-on-rails

所以作为一个rails新手，我无法解决这个问题。我有一个学生模型，其中包含许多拘留、在校和停学。我希望能够在学生展示页面中创建、展示和链接到编辑。如果学生只有一次拘留，那不是问题。但如果有多个，edit_student_detention_path 会将学生的所有detention_id 放在url 中。可能是一个简单的修复，但我错过了它。

学生控制器：

```
def show
@student = Student.find(params[:id])
@detention = @student.detentions.new
@detentions = @student.detentions.all
@inschool = @student.inschools.new
@inschools = @student.inschools.all
@suspension = @student.suspensions.new
@suspensions = @student.suspensions.all

respond_to do |format|
  format.html # show.html.erb
  format.json { render json: @student }
end
end 
```

学生展示视图：

```
<% @student.detentions.each do |detention|%>

  <tr>
 <td><%= detention.detention_date %></td>
 <td><%= detention.administrator %></td>
 <td><%= link_to "Edit", edit_student_detention_path(@student, @detentions) %></td>
 <td><%= link_to "Letter", student_detention_path(@student, @detentions) %></td>
 </tr>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:29:53.093

不太确定你真正想要什么，但如果你试图链接到拘留的编辑视图，只需将你的 link_to 更改为：

```
<%= link_to "Edit", edit_student_detention_path(@student, @detentions) %> 
```

至 ：

```
<%= link_to "Edit", edit_detention_path(detention) %> 
```

# haskell - 从序列中提取随机项

> ID：14096742
> 
> 赞同：1
> 
> 时间：2012-12-31T02:17:58.083
> 
> 标签：haskell, random, sequence, monads

我一直在尝试从序列中提取随机元素。我试图定义的功能如下：

```
getRandomInts :: Seq Int -> PureMT -> ((Seq Int, Int), PureMT)
getRandomInts ints gen = sampleState (fromJust $ choiceExtractSeq ints) gen 
```

这是我得到的错误：

```
Overlapping instances for Data.Random.Lift.Lift
      transformers-0.3.0.0:Data.Functor.Identity.Identity
      (StateT PureMT transformers-0.3.0.0:Data.Functor.Identity.Identity)
  arising from a use of `sampleState'
Matching instances:
  instance [incoherent] (Monad m, MonadTrans t) =>
                        Data.Random.Lift.Lift m (t m)
    -- Defined in `Data.Random.Lift'
  instance [incoherent] Monad m =>
                        Data.Random.Lift.Lift
                          transformers-0.3.0.0:Data.Functor.Identity.Identity m
    -- Defined in `Data.Random.Lift'
In the expression:
  sampleState (fromJust $ choiceExtractSeq ints) gen
In an equation for `getRandomInt':
    getRandomInt ints gen
      = sampleState (fromJust $ choiceExtractSeq ints) gen 
```

有谁知道如何解决这个问题，或者，有一种从序列中获取随机元素（无需替换）的有效方法的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T13:54:27.437

我对这个程序有类似的问题：

```
sampleState (uniform (1 :: Int) 100 :: RVar Int) (mkStdGen 1) 
```

这导致几乎相同的错误消息。这里的问题是 中存在重叠的实例`Data.Random.Lift`，但没有最具体的实例，因此 ghc 拒绝该程序（在[用户指南](http://www.haskell.org/ghc/docs/latest/html/users_guide/type-class-extensions.html#instance-overlap)中有描述）。

我解决这个问题的方法是提供一个比其他实例更具体的实例，因此只需删除以下实例就可以让我一切都编译好（我已经包含了完整的语言编译指示和导入）：

```
{-# LANGUAGE OverlappingInstances, 
             IncoherentInstances, 
             FlexibleInstances, 
             MultiParamTypeClasses #-}

import Data.Random
import Data.Random.Distribution.Uniform
import System.Random

import Data.Random.Lift
import Data.Functor.Identity
import Control.Monad.Trans.Class as T

main = print test

test :: (Int, StdGen)
test = sampleState (uniform (1 :: Int) 100 :: RVar Int) (mkStdGen 1)

instance MonadTrans t => Lift Identity (t Identity) where
  lift = T.lift 
```

简而言之，尝试通过为`Data.Random.Lift.Lift`.

**更新**

我已经向 random-fu 作者创建了一个[拉取请求](https://github.com/mokus0/random-fu/pull/11)，其中包含一个在库中修复此问题的补丁。在被接受之前，您可以从我的[fork](https://github.com/zenzike/random-fu)中拉出，并使用`cabal install`为您完成这项工作。

# php - 这个 PHP 和/或 MySQL 查询有什么问题？

> ID：14096749
> 
> 赞同：0
> 
> 时间：2012-12-31T02:19:37.627
> 
> 标签：php, mysql

我现在正在学习 PHP 和 MySQL。我正在尝试一个简单的页面，我可以在其中提交一条短消息，并从服务器检索一条消息（对于这种特殊情况只是一个随机数）。

```
<?php

$success = false;

require_once '../../../phpIncludes/mysqlIncludes.php';
require_once '../../../phpIncludes/iphandler.php';
$creds = new MySQLLoginCredentials;
$con = $creds->ConnectToDB();

mysql_select_db("testDB", $con);

$userMsg = trim($_POST['msg']);
//The simple version for 128 Characters from the beginning of the string
$userMsg = substr($userMsg,0,128);
$userMsg = filter_var($userMsg, FILTER_SANITIZE_STRING,!FILTER_FLAG_STRIP_LOW);

$ip = encode_ip( $_SERVER['REMOTE_ADDR'] );

$time = time();

$returnMsg = "". rand() . "";

$userAgent = mysql_real_escape_string($_SERVER['HTTP_USER_AGENT']);
//Trim to 256 since that is largest db can hold
$userAgent = substr($userAgent,0,256);
$userAgent = filter_var($userAgent, FILTER_SANITIZE_STRING);

//Debug 
echo "Time : " . $time . "<br>"
. " IP: " . $ip . " | " . decode_ip($ip) . "<br>"
. " UserAgent: " . $userAgent . "<br>"
. " Msg: " . $userMsg . "<br>"
. " Return: " . $returnMsg . "<br>";

$sql = "INSERT INTO TestMessageTbl (TimeStamp, IPAddress, ClientInfo, IncMsg, OutMsg)
VALUES ('" . $time . "', " . $ip . ", " . $userAgent . ", " . $userMsg . ", " . $returnMsg .")";

$success = mysql_query($sql, $con);

if($success == false)
{
    echo "Error: " . mysql_error();
}

echo $returnMsg;

mysql_close($con);
?> 
```

输出是：

```
<i>Time : 1356919336
IP: * | *
UserAgent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko)     Chrome/23.0.1271.97 Safari/537.11
Msg: 
Return: 743166102
Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.' at line 2743166102</i> 
```

该表如下所示：

```
UID bigint(20) unsigned, AUTO_INCREMENT
TimeStamp bigint(20) unsigned
IPAddress varchar(32) utf8_general_ci
ClientInfo varchar(256) utf8_general_ci
IncMsg varchar(128) utf8_general_ci
OutMsg varchar(128) utf8_general_ci 
```

我从mysql手动转录，以防有错别字......

让我立即感到奇怪的是错误的非常大的行号。那是怎么回事？

PS 我知道就目前而言，$msg 将是空白的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:21:35.367

用简单的报价包装你的所有价值观

```
$sql = "INSERT INTO TestMessageTbl (TimeStamp, IPAddress, ClientInfo, IncMsg, OutMsg)
VALUES ('" . $time . "', '" . $ip . "', '" . $userAgent . "', '" . $userMsg . "', '" . $returnMsg ."')"; 
```

# java - 显示一年中每一天的字符串

> ID：14096757
> 
> 赞同：0
> 
> 时间：2012-12-31T02:21:16.107
> 
> 标签：java, android

我想尝试制作一个显示当天名言的 Android 应用程序。所以我将有 365 个报价，并且每天都会显示一个新报价。关于如何做到这一点的任何想法？我的`string.xml`文件中需要 365 个@strings 吗？有没有办法通过索引访问字符串数组（或其他数据结构）来完成此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:26:21.903

如果要使用资源：

```
Resources res = getResources();
String[] quoteTexts = res.getStringArray(R.array.quotes_array);
quoteTexts[dayNumber]..<---- gives you your text 
```

在资源文件中：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
<string-array name="quotes_array">
    <item>I am rich</item>
    <item>Quote 2</item>
    <item>Quote 3</item>
     ....365 .... times....
 </string-array>
</resources> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T03:05:24.500

您可以使用具有 2 列的 SQLite DB

```
Day|Quote 
1  |Your Quote day 1
2  |Your Quote day 2 
```

ETC...

您可以使用 SQLite 编辑器编译您的数据库，然后将编译后的数据库放入您的应用程序中。

如果你想定义一个 365 行的字符串数组`string.xml`，你可以添加代码

```
<string-array name="my_quotes_array">
    <item>Live or exist</item>
    <item>Quote 2</item>
    <item>Quote 3</item>
    <item>Quote 4</item>
    <item>Quote 5</item>
     ....etc., one line per day....
 </string-array> 
```

在`strings.xml`

但我认为这不是一个好的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T02:52:30.033

各种方法都可以，如果这组字符串以后不改的话，还是存成静态类比较好。因为 XML 解析器需要一些额外的（比静态类更多的）时间和资源（内存、cpu）来解析，而 SQLite 需要额外的时间、资源来创建连接等。

但是 XML 中的有机数据看起来更好（更合乎逻辑，更通畅）。

还要查看 [原始资源与 SQLite 数据库](https://stackoverflow.com/questions/5213550/raw-resources-versus-sqlite-database/5213569#5213569)

# java - 在图像中嵌入代码

> ID：14096760
> 
> 赞同：0
> 
> 时间：2012-12-31T02:21:38.973
> 
> 标签：java, c++, png, jpeg

有没有办法在图像中嵌入可执行代码？例如，如果我的桌面上有一个图像文件（jpeg、png 等），我想单击该图像并在后台运行一些嵌入式源代码（Java、c++ 等）。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:23:26.627

不，那将构成一个可怕的安全漏洞。

也就是说，有许多“图像”格式可能包含可执行代码。PostScript 文件就是一个著名的例子，例如，没有什么能阻止您将一些 JavaScript 嵌入到 SVG 文件中。它是否运行是另一回事。并且（希望）没有一个人能够像 Java/C++/friends 那样完全访问您的系统。

# iphone - 来自 UIImagePickerViewController 的人脸检测

> ID：14096764
> 
> 赞同：0
> 
> 时间：2012-12-31T02:22:51.080
> 
> 标签：iphone, objective-c, xcode, uiimagepickercontroller, face-detection

*****编辑******

我只是在做一些测试，看看我是否遗漏了一些东西，结果发现 imgHolder.image 返回 null 但它正在显示图像。我在 [void viewDidLoad] 上调用它。

*****编辑******

我正在创建一个简单的应用程序，您可以用它拍照，然后将该图像传递给另一个视图控制器并尝试在图像中检测您的脸。我尝试使用许多教程，并在谷歌上搜索问题，但我没有找到解决方案。问题是无论我更改代码多少次或尝试另一张图片，它都不会检测到任何功能。下面列出了我尝试过的一些教程以及我的代码。

```
CIImage* image = [CIImage imageWithCGImage:imgHolder.image.CGImage];
CIDetector* detector = [CIDetector detectorOfType:CIDetectorTypeFace context:nil options:[NSDictionary dictionaryWithObject:CIDetectorAccuracyHigh forKey:CIDetectorAccuracy]];
NSDictionary *imageOptions = [NSDictionary dictionaryWithObject:[NSNumber numberWithInt:6]
                                                         forKey:CIDetectorImageOrientation];
NSArray* features = [detector featuresInImage:image options:imageOptions];
for(CIFaceFeature* feature in features)
{
    UIView* face = [[UIView alloc] initWithFrame:feature.bounds];
    [face setBackgroundColor:[[UIColor yellowColor] colorWithAlphaComponent:0.4]];
    [self.view.window addSubview:face];

    if(feature.hasLeftEyePosition)
    {
        UIView* eye = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 15, 15)];
        [eye setBackgroundColor:[[UIColor blueColor] colorWithAlphaComponent:0.2]];
        [eye setCenter:feature.leftEyePosition];
        [self.view.window addSubview:eye];
    }

    if(feature.hasRightEyePosition)
    {
        UIView* eye = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 15, 15)];
        [eye setBackgroundColor:[[UIColor redColor] colorWithAlphaComponent:0.2]];
        [eye setCenter:feature.rightEyePosition];
        [self.view.window addSubview:eye];
    }

    if(feature.hasMouthPosition)
    {
        UIView* mouth = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 15, 15)];
        [mouth setBackgroundColor:[[UIColor greenColor] colorWithAlphaComponent:0.2]];
        [mouth setCenter:feature.mouthPosition];
        [self.view.window addSubview:mouth];
    }
}
NSLog(@"%d", features.count); 
```

[http://www.tokbox.com/blog/fun-with-core-graphics-in-ios/](http://www.tokbox.com/blog/fun-with-core-graphics-in-ios/) [http://b2cloud.com.au/how-to-guides/face-detection-in-ios-5](http://b2cloud.com.au/how-to-guides/face-detection-in-ios-5) [CIDetector和 UIImagePickerController](https://stackoverflow.com/questions/10746212/cidetector-and-uiimagepickercontroller)

# ruby-on-rails - Rails - 任何人都可以添加项目。不好

> ID：14096765
> 
> 赞同：0
> 
> 时间：2012-12-31T02:23:02.043
> 
> 标签：ruby-on-rails

如何防止任何人提交表单？现在，任何用户都可以在任何其他用户的个人资料上更新表单，而他们应该只能触摸自己的个人资料。

如果表单不在当前用户的个人资料中，我应该隐藏表单，还是在控制器内做一些更安全的事情？

例如，我有一个创建新书的表单。实际上，表单应该显示的唯一时间是在登录用户的个人资料页面上。该表格应隐藏在其他人的个人资料页面上。

**形式：**

```
<%= form_for @book do |f| %>
    <%= f.hidden_field :user_id, :value => @user.id %>
    <%= f.hidden_field :status, :value => "f" %>
    <%= f.text_field :title, :placeholder => "Title" %>
    <%= f.text_field :author, :placeholder => "Author" %>
    <%= f.submit 'Add Book', :value => "" %>
<% end %> 
```

**编辑：**

我开始使用 CanCan，但仍然无法限制在其他用户的个人资料上创建书籍的访问权限。

我的新技能.rb：

```
class Ability
    include CanCan::Ability

    def initialize(user)
        can :read, :all
        can :create, Book
    end
end 
```

**在应用程序控制器中过滤之前：**

```
class ApplicationController < ActionController::Base
  before_filter :current_user

  def current_user
    User.current = current_user
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:30:34.480

隐藏表单，并将 user_id 作为字段删除。在控制器中，如果用户有很多/一本书，则利用该关联：

```
def create
   @book = current_user.books.new(params[:book])
   ...
end 
```

如果由于某种原因表单被意外显示，当前用户将只能添加他们自己的书籍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T02:34:09.143

您正在寻找授权方案。控制器逻辑是重要的部分（实际上是允许或禁止该操作），但视图是用户看到的，因此您应该同时实现两者。

虽然您可以自己滚动，但[CanCan](https://github.com/ryanb/cancan)是一种相对轻松的方式。

CanCan 使实现视图逻辑变得容易（您仍然必须这样做），如下所示：

```
<% if can? :create, Book %>
<%= render '/books/form'%>
<% end %> 
```

gem 创建者 Ryan Bates 也是 RailsCasts 的创建者。方便的是，有一个[涵盖 CanCan](http://railscasts.com/episodes/192-authorization-with-cancan)。

对于您的用例，我会定义这样的能力：

```
can :create, Book do |book|
  book.user = User.current
end 
```

您需要在应用程序控制器中添加一个 before_filter 以将当前用户放入`User.current`变量中以使其工作（访问模型中的当前用户）。并将这两种方法添加到您的`User`模型中：

```
 def self.current
    Thread.current[:user]
  end
  def self.current=(user)
    Thread.current[:user] = user
  end 
```

# python - 简单的 Python 随机模块

> ID：14096766
> 
> 赞同：0
> 
> 时间：2012-12-31T02:23:18.263
> 
> 标签：python

我需要生成一个介于 0 和 7 之间的随机数。但它必须包含最多 8 位左右的小数。例如：3.54367334 或 6.3464357。我在随机模块中没有找到任何可以给我类似的东西。一切都只有整数，或者从 0 到 1（这是 random.random）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T02:25:07.897

如您所见，[`random.random`](http://docs.python.org/3.3/library/random.html#random.random)返回一个范围为 [0.0, 1.0) 的值。如果将其返回值乘以 7，则结果将在 [0.0, 7.0) 范围内。

还有一个函数 ，[`random.uniform`](http://docs.python.org/3.3/library/random.html#random.uniform)在给定范围的情况下，它将为您执行此操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T02:28:44.473

虽然你可以rescale `random.random`，但为什么不使用[random.uniform](http://docs.python.org/2/library/random.html#random.uniform)呢？

```
>>> import random
>>> [random.uniform(0, 7) for i in range(4)]
[3.36879678022553, 1.3262017420571945, 2.961415926838038, 6.409486371437773] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-03T06:26:51.407

您可以使用以下代码：

```
random.random() * 7 
```

As`random.random`给出 0 到 1.0 之间的数字，`* 7`将给出 (0, 7.0)

# javascript - 为什么我的 scrapy 下载器中间件无法正确呈现 javascript？

> ID：14096768
> 
> 赞同：2
> 
> 时间：2012-12-31T02:23:28.080
> 
> 标签：javascript, webkit, web-scraping, web-crawler, scrapy

我正在使用[这个scrapy代码片段](http://snipplr.com/view/66996/renderedinteractive-javascript-with-gtkwebkitjswebkit/)来呈现我想要从中抓取数据的网站的javascript代码。该网站是一个视频搜索引擎，搜索结果由 javascript 呈现。我想点击下一页链接并废弃整个搜索项目。以下是我的蜘蛛代码：

```
class VideoSpider(BaseSpider):
    name = "VideoSpider"
    allowed_domains = ["domain.com"]
    start_urls = ['video search results link']

    def parse(self, response):
        hxs = HtmlXPathSelector(response)
        video_items = hxs.select("//ul[@id='results-list']/li[@class='result']")
        #items = []
        for vi in video_items:
            item = VideoItem()
            link = vi.select("a[@class='result-link']/@href").extract()[0]
            title = vi.select("a[@class='result-link']/@title").extract()[0]
            #print title,link
            item['title'] = title
            item['url'] = link
            yield item

        next_page = hxs.select("//div[@id='page']/a")
        for np in next_page:
            next_url = np.select("@href").extract()
            if next_url:
                url = urlparse.urljoin(response.url, next_url[0])
                #url = response.url, str(next_page)
                self.log("find next page url: %s"%url, log.INFO)
                yield Request(url, callback=self.parse) 
```

我发现中的链接`start_urls`已正确下载并正确呈现，如下所示：

```
<ul id="results-list" class="clearfix" static="bl=normal">
    <li class="result" href="" </li>
     <li class="result" href="" </li>
     <li class="result" href="" </li>
    .... 
```

因此，在第一页上提取成功，而在获取下一页链接时，javascript 不会像这样呈现：

```
<ul id="results-list" class="clearfix" static="bl=normal"></ul>
    <div id="loading">trying to load page for you, please be patient</div> 
```

所以抓取停止了，因为它无法提取链接，因为`results-list`没有呈现。为什么第一页正确呈现而第二页没有？我应该使用`selenium`而不是`webkit and jswebkit`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T03:50:47.430

我不是专家，但我最近爱上了 Scrapy 和 Selenium。我过去主要使用 urllib2/beautifulsoup/regex/mechanize 使用 perl 和 python 来抓取硬核，但遇到了我认为无法处理的站点，这些站点广泛使用 ajax，没有从源中提取数据。甚至无法通过屏蔽帖子请求参数来破坏的网站，所以有一段时间我放弃了我的希望和梦想。

我花了一点时间，但现在我将 Selenium 与 Webkit 一起使用，这太棒了。我觉得自己像个职业黑客。

事实上，我非常有信心大多数网站都无法阻止我。它完美地模拟了使用浏览器的用户，我只是使用 sleep 来确保我允许页面 ajax 正确加载。对于像亚马逊这样的困难网站，不要贪心，让你的点击随机间隔。我已经连续几天运行硒，没有任何问题。

我绝对会建议您研究硒。现在一切都在使用 Ajax。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T05:19:40.423

最后我找出了问题所在。某些 url 格式不正确。

# c# - GroupBox 扩展属性

> ID：14096771
> 
> 赞同：0
> 
> 时间：2012-12-31T02:23:53.977
> 
> 标签：c#, wpf, wpf-controls

*   在我的 C# WPF windows 应用程序中，我使用了带有一些标签和文本框的组框来插入一些数据
*   我在该组框中的一个文本框旁边创建了一个名为（添加）的按钮
*   当我按下（添加）按钮时，我想要：
    *   Group Box 扩大尺寸和
    *   第一个文本框下方出现一个新文本框以插入更多数据
    *   （添加）按钮出现在新文本框旁边
*   我希望你能帮助我..谢谢

![在此处输入图像描述](../Images/45be4bc9d500af36ad0e7b17373e59ea.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T04:16:18.330

看看这是否是您想要的，我使用`StackPanel's`了`DockPanel`，并且随着内容的添加会增长，我还添加了 5 个额外的`TextBox's`并且`TextBlock's`具有折叠的可见性，这意味着它们在不可见时不会占用任何空间。我将它们添加到列表中，然后在您单击按钮时检查可见性，使相应的控件在那时可见。

**主窗口.xaml**

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="214" Width="525" SizeToContent="WidthAndHeight">
    <Grid>
        <GroupBox Header="General Information"   HorizontalAlignment="Left"  Name="groupBox1" VerticalAlignment="Top">
            <Grid >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="4*"/>
                    <ColumnDefinition Width="3*"/>
                </Grid.ColumnDefinitions>
                <DockPanel Grid.Column="0" HorizontalAlignment="Left" >
                   <Button VerticalAlignment="Bottom"  Height="25"   Click="Button_Click" >Add</Button>
                </DockPanel>
                <StackPanel Name="stackpanelTB" Grid.Column="1"  Orientation="Vertical"  >
                    <StackPanel.Resources>
                        <Style TargetType="{x:Type TextBox}">
                            <Setter Property="Margin" Value="0,4,0,0"/>
                        </Style>
                    </StackPanel.Resources>
                    <TextBox  Name="textBox1" Width="240" Height="25"></TextBox>
                    <TextBox Name="textBox2" Width="240" Height="25"></TextBox>
                    <TextBox Name="textBox3" Width="240" Height="25"></TextBox>
                    <TextBox Name="textBox4" Width="240" Height="25"></TextBox>
                    <TextBox Name="textBox5" Width="240" Visibility="Collapsed" Height="25"></TextBox>
                    <TextBox Name="textBox6" Width="240" Visibility="Collapsed" Height="25"></TextBox>
                    <TextBox Name="textBox7" Width="240" Visibility="Collapsed" Height="25"></TextBox>
                    <TextBox Name="textBox8" Width="240" Visibility="Collapsed" Height="25"></TextBox>
                    <TextBox Name="textBox9" Width="240" Visibility="Collapsed" Height="25"></TextBox>
                </StackPanel>
                <StackPanel Name ="stackpanelCaption" Grid.Column="2" Orientation="Vertical">
                    <StackPanel.Resources>
                        <Style TargetType="{x:Type TextBlock}">
                            <Setter Property="Margin" Value="0,4,0,0"/>
                        </Style>
                    </StackPanel.Resources>
                    <TextBlock Name="textBlock1" HorizontalAlignment="Right" Height="25">Ingredient ID</TextBlock>
                    <TextBlock Name="textBlock2" HorizontalAlignment="Right" Height="25">Ingredient Name</TextBlock>
                    <TextBlock Name="textBlock3" HorizontalAlignment="Right" Height="25">Chemical Str</TextBlock>
                    <TextBlock Name="textBlock4" HorizontalAlignment="Right" Height="25">Ingredient Salts</TextBlock>
                    <TextBlock Name="textBlock5" HorizontalAlignment="Right" Visibility="Collapsed" Height="25"></TextBlock>
                    <TextBlock Name="textBlock6" HorizontalAlignment="Right" Visibility="Collapsed" Height="25"></TextBlock>
                    <TextBlock Name="textBlock7" HorizontalAlignment="Right" Visibility="Collapsed" Height="25"></TextBlock>
                    <TextBlock Name="textBlock8" HorizontalAlignment="Right" Visibility="Collapsed" Height="25"></TextBlock>
                    <TextBlock Name="textBlock9" HorizontalAlignment="Right" Visibility="Collapsed" Height="25"></TextBlock>
                </StackPanel>
            </Grid>
       </GroupBox>
    </Grid>
</Window> 
```

**主窗口.xaml.cs**

```
using System;
using System.Collections.Generic; 
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        List<TextBox> tboxList = new List<TextBox>();
        List<TextBlock> tblockList = new List<TextBlock>();
        public MainWindow()
        {
            InitializeComponent();

            tblockList.Add(textBlock1);
            tblockList.Add(textBlock2);
            tblockList.Add(textBlock3);
            tblockList.Add(textBlock4);
            tblockList.Add(textBlock5);
            tblockList.Add(textBlock6);
            tblockList.Add(textBlock7);
            tblockList.Add(textBlock8);
            tblockList.Add(textBlock9);
            tboxList.Add(textBox1);
            tboxList.Add(textBox2);
            tboxList.Add(textBox3);
            tboxList.Add(textBox4);
            tboxList.Add(textBox5);
            tboxList.Add(textBox6);
            tboxList.Add(textBox7);
            tboxList.Add(textBox8);
            tboxList.Add(textBox9);
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            for (int i = 0; i < 9; i++)
            {
                if (tboxList[i].Visibility == Visibility.Collapsed)
                {
                    tboxList[i].Visibility = Visibility.Visible;
                    tblockList[i].Visibility = Visibility.Visible;
                    break;
                }
            }
        }

    }
} 
```

# javascript - 为什么我的 JavaScript 代码没有成功上传我的文件？

> ID：14096778
> 
> 赞同：0
> 
> 时间：2012-12-31T02:24:35.027
> 
> 标签：javascript, jquery, filereader

好的，所以我有这个 JavaScript 代码。它使用 FileReader 对象上传文件。但是，每当我尝试上传包含 + 字节的 MID 文件时，它都会将其更改为空格！我知道错误不在服务器端脚本中，因为我在 FileReader 读取我的 MID 文件后立即在客户端检查了数据，它与上传的最终结果相同。我也尝试将文件作为文本读取，但这也不起作用。请忽略代码注释，我将它们放入以尝试某些代码的不同版本，而不必删除以前的代码。我相当确定错误在上传功能的某个地方。

**注意：由于某种原因，StackOverflow 无法正确显示我的代码。转到此 url 以获取完整的 HTML 代码：http: [//uploadfilez.tommy3244.com/cgi-bin/index.cgi](http://uploadfilez.tommy3244.com/cgi-bin/index.cgi)**

我尝试了几个小时，但一些字符（+，但可能还有其他一些字符）不断变成空格！我无法弄清楚问题是什么！如果我应该上传原始和最终结果的 MID 文件，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:00:44.380

快速查看源代码表明您在`escape`不想使用时使用了 javascript 函数。

查看源代码中的第 80-90 行，然后查看文档，`escape`问题应该很清楚：

[http://www.w3schools.com/jsref/jsref_escape.asp](http://www.w3schools.com/jsref/jsref_escape.asp)

## 编辑：2013 年 1 月 2 日

我对此进行了更多研究，我认为我上面的答案不是问题。我能够使用断点验证传递给您的上传函数的参数是否正确（即，我尝试使用包含“+”字符的文件名）。

我无法在上传功能中使用断点进行测试，因为我没有你的 u/p。但是，我仍然相信您会在上传功能中发现错误。具体来说，我将停止尝试手动构造查询字符串，就像您在此处所做的那样：

```
 var data = "";
    //data.append("filename", document.getElementById("filename0").value);
    data += "filename="+escape(document.getElementById("filename0").value);
    //data.append("username", document.getElementById("username").value);
    data += "&username="+escape(document.getElementById("username").value);
    //data.append("password", document.getElementById("password").value);
    data += "&password="+escape(document.getElementById("password").value);
    //data.append("public", document.getElementById("public").value);
    data += "&public="+escape(document.getElementById("public").value);
    //data.append("filebytes", escape(e.target.result));
    data += "&filebytes="+escape(e.target.result);
    //stdlog("Got result! Res: '''"+e.target.result+"'''"); 
```

相反，使用 JSON 来构造数据，如下所示：

```
var data = {};
data.filename = escape(document.getElementById("filename0").value);//fixed coding error
// and so on for the other properties 
```

试试看，让我知道它是否能解决您的问题。

# c# - 有没有办法使用 WebClient 从受密码保护的位置而不是 Httprequest 获取登录 cookie？

> ID：14096782
> 
> 赞同：2
> 
> 时间：2012-12-31T02:25:37.630
> 
> 标签：c#, webclient

我目前正在使用以下代码来获取网站的 cookie：

```
 bool IsLoginSuccessful = false;
  try
  {
    //Get Token and Authorization URL
    HttpWebRequest wr = (HttpWebRequest)HttpWebRequest.Create("https://updates.site.com/download");
    wr.AllowAutoRedirect = true;
    WebResponse response = wr.GetResponse();
    response.Close();
    string data = response.ResponseUri.OriginalString;
    string ssoToken = data.Split('=')[1];
    string authData = String.Format("ssousername={0}&password={1}&site2pstoretoken={2}", username, password, ssoToken);
    string ssoServer = response.ResponseUri.Scheme + "://" + response.ResponseUri.Host;
    string ssoAuthUrl = "sso/auth";

    // now let's get our cookie for the download
    byte[] dataBytes = Encoding.UTF8.GetBytes(authData);
    string url = ssoServer + "/" + ssoAuthUrl;
    wr = (HttpWebRequest)HttpWebRequest.Create(url);

    //MyCookies is a CookieContainer I use to store the login cookies
    wr.CookieContainer = MyCookies;
    wr.Method = "POST";
    wr.ContentLength = dataBytes.Length;
    wr.ContentType = "application/x-www-form-urlencoded";
    Stream dataStream = wr.GetRequestStream();
    dataStream.Write(dataBytes, 0, dataBytes.Length);
    dataStream.Close();
    response = wr.GetResponse();
    response.Close();

    if (wr.CookieContainer.Count > 0)
    {
      IsLoginSuccessful = true;
    }
  } 
```

我想知道是否有办法使用 WebClient 或从它继承的类来获取 cookie 而不是使用 HttpRequest？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:52:30.573

> 获取cookie而不是使用HttpRequest？

Cookies 是[HttpRequest](http://msdn.microsoft.com/en-us/library/system.web.httprequest.cookies.aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-2)的一个属性：

```
int loop1, loop2;
HttpCookieCollection MyCookieColl;
HttpCookie MyCookie;

MyCookieColl = Request.Cookies;

// Capture all cookie names into a string array.
String[] arr1 = MyCookieColl.AllKeys;

// Grab individual cookie objects by cookie name. 
for (loop1 = 0; loop1 < arr1.Length; loop1++) 
{
   MyCookie = MyCookieColl[arr1[loop1]];
   Response.Write("Cookie: " + MyCookie.Name + "<br>");
   Response.Write ("Secure:" + MyCookie.Secure + "<br>");

   //Grab all values for single cookie into an object array.
   String[] arr2 = MyCookie.Values.AllKeys;

   //Loop through cookie Value collection and print all values. 
   for (loop2 = 0; loop2 < arr2.Length; loop2++) 
   {
      Response.Write("Value" + loop2 + ": " + Server.HtmlEncode(arr2[loop2]) + "<br>");
   }
} 
```

# node.js - Meteor 有 REPL 吗？

> ID：14096785
> 
> 赞同：16
> 
> 时间：2012-12-31T02:25:53.370
> 
> 标签：node.js, meteor, read-eval-print-loop

Meteor 框架是否带有 REPL 或某种控制台？如果没有，知道如何以引导 Meteor 环境的方式使用[Node.js REPL ？](http://nodejs.org/api/repl.html)

我本质上是在寻找类似 rails 控制台或 Web 浏览器中的 javascript 控制台之类的东西：使应用程序的完整上下文可用的命令行界面，因此我可以任意检查对象`Meteor`和`Template`.

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2015-05-16T13:50:24.443

是的，[从 1.0.2 版开始，Meteor 有一个 REPL](https://www.meteor.com/blog/2014/12/19/meteor-102-meteor-shell)。

只需使用`meteor shell`to 被拖放到 REPL 中，这与 Node 的非常相似。

```
$ meteor shell

Welcome to the server-side interactive shell!

Tab completion is enabled for global variables.

Type .reload to restart the server and the shell.
Type .exit to disconnect from the server and leave the shell.
Type .help for additional help.

> Meteor.isServer
true
> 
```

您将可以访问完整的 Meteor 环境，并且代码将像服务器端代码一样运行。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-04T23:25:31.570

Meteor 目前没有 REPL，但它在他们的路线图上。在此期间，您可以在浏览器的 javascript 控制台中访问应用程序的面向客户端的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-18T20:33:39.180

您可以键入`meteor mongo`以在本地开发数据库上打开 MongoDB shell。见[http://docs.meteor.com/#meteormongo](http://docs.meteor.com/#meteormongo)

您还可以在浏览器中打开控制台（在 chrome 中，键入`alt+command+i`），选项卡控制台。在这里，您可以像在客户端一样键入 javascript 命令。

要直接向服务器发出命令，你可以试试这个项目：[meteor-server-console](https://github.com/gandev/meteor-server-console)：

> 连接到流星服务器，评估表达式或执行自定义帮助函数并浏览结果/日志输出。

# ruby - 我的 Ruby 编程代码有什么问题？

> ID：14096787
> 
> 赞同：0
> 
> 时间：2012-12-31T02:26:10.887
> 
> 标签：ruby, syntax, syntax-error

这段代码应该可以工作。但是每次我在 Ruby 上打开它时，Ruby 几乎都会立即关闭，因为它无法读取代码中的某些内容。所以很明显代码中有一个错误，但我查看了所有内容，似乎找不到它。我需要一些帮助才能使此代码正常工作。非常感谢您！

```
puts 'Enter the number of the current month using the 12 months per year scale. Ex. January would be 1, February would be 2, March would be 3, etc...'
month=gets.chomp
case month
when '1'..'3'
fee='$45'
when'4'..'5'
fee='$55'
when'7'..'8'
fee='$65'
else
fee='$0.00'
end
puts'The fee to apply for the competition is ' + fee + '.00 when you apply on the date of today, ' + Time.now.to_s +'.'
puts 'If your fee came up as $0.00, then that is because the competition has ended. But do not worry, there is always next year!'
sleep 20 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T02:28:47.703

这就是 Ruby 告诉我的语法错误：

```
temp.rb:13: syntax error, unexpected tUPLUS, expecting $end
... of today, ' + Time.now.to_s +'.' 
```

`+`在和之间添加空格`'.'`可修复语法错误。

* * *

您可以通过从命令行运行 Ruby 自己解决这个问题。我假设您正在运行 Windows。要进入命令提示符，您可以按`Windows key`和`R`打开运行对话框。从那里，您可以输入`cmd`并按下`enter`以打开命令提示符。然后，您可以使用`cd`更改当前目录并`ruby`运行您的 Ruby 脚本（假设 Ruby 在 中`PATH`）。您的会话可能如下所示：

```
C:\Documents and Settings\Madelyn Grewal> cd Desktop

C:\Documents and Settings\Madelyn Grewal\Desktop> ruby myscript.rb
myscript.rb:13: syntax error, unexpected tUPLUS, expecting $end
... of today, ' + Time.now.to_s +'.'

C:\Documents and Settings\Madelyn Grewal\Desktop> 
```

# ios6 - 通过故事板 segue 传递的属性中的空值

> ID：14096788
> 
> 赞同：3
> 
> 时间：2012-12-31T02:26:13.353
> 
> 标签：ios6, null, storyboard, segue

所以有点历史。这是我发布的应用程序中的工作代码。它在 iOS 6 之前完美运行，现在无法运行。我想出了一个可行但并不理想的总黑客，所以我转向 Stackoverflow 寻求一些答案。

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{

    if ([segue.identifier isEqualToString:@"GoogleSegue"])
    {
        Band *thisBand = self.band;
        NSString *googleSearchString = thisBand.bandLinks.googleSearchLink;
        NSURL *googleSearchUrl = [NSURL URLWithString:googleSearchString];
        WebViewController *webViewController = segue.destinationViewController;
        webViewController.delegate = (id)self;
        webViewController.url = googleSearchUrl;
        webViewController.navigationItem.title = @"Google";

    } else if ([segue.identifier isEqualToString:@"YouTubeSegue"])
    {

        Band *thisBand = self.band;
        NSString *youTubeString = thisBand.bandLinks.youTubeLink;
        NSURL *youTubeUrl = [NSURL URLWithString:youTubeString];

        WebViewController *webViewController = segue.destinationViewController;
        webViewController.delegate = (id)self;
        webViewController.url = youTubeUrl;

/*This is the magic line, if I comment this out, the values showing up in the 
destination view controller's properties are null.  If I have this NSLog uncommented 
everything works flawlessly.  Does anyone have an explanation? */

    NSLog(@"%@%@", webViewController.url, youTubeUrl);
        webViewController.navigationItem.title = @"You Tube";
} 
```

# forms - Symfony2 csrf 表单，令牌无效

> ID：14096795
> 
> 赞同：0
> 
> 时间：2012-12-31T02:26:48.957
> 
> 标签：forms, symfony, twig, csrf

编辑：最后有一个 Tl;Dr ...

在使用 symfony2 和自动生成的表单时，我不断收到 CSRF 错误。

这是我的控制器：（调用 new 以显示表单，调用 create 提交）

```
public function newAction($guru)
{

    //Make the Entity Manager
    $em = $this->getDoctrine()
            ->getEntityManager();
    $guru = $em->getRepository('TSNStatsBundle:Guru')
            ->findOneById($guru);
    //If the guru id exists        
    if ($guru)
    {
        $alert = new Alert();
        //Create default values
        $time = new \DateTime(2012-12-30);
        $time->setTime(23,59);

        //Set default times to "none available (23:59)"
        $alert->setText($time)
        ->setEmail($time)
        ->setTwitter($time)
        ->setChat($time)
        ->setGuru($guru);

        //Make the form, set types, 
        $formBuilder = $this->createFormBuilder($alert);

         $formBuilder->add('buy', 'checkbox', array(
                    'required' => false
                ))
                ->add('date', 'date', array(
                    'input' => 'datetime',
                    'widget' => 'single_text'
                ))
                ->add('stock', new StockType());
        if ($guru->getInstantAlerts() ==1)
        {
            if ($guru->getText() == 1)
            {
                $formBuilder->add('text', 'time', array(
                       'input' => 'datetime',
                       'widget' => 'text',

                   ));
            }
            if ($guru->getEmail() == 1)
            {
                $formBuilder->add('email', 'time', array(
                       'input' => 'datetime',
                       'widget' => 'text',

                   ));
            }
            if ($guru->getTwitter() == 1)
            {
                $formBuilder->add('twitter', 'time', array(
                       'input' => 'datetime',
                       'widget' => 'text',

                   ));
            }
            if ($guru->getChat() == 1)
            {
                $formBuilder->add('chat', 'time', array(
                       'input' => 'datetime',
                       'widget' => 'text',

                   ));
            }
        }
        $formBuilder->add('size')
                ->add('short', 'checkbox', array(
                    'required' => false
                ))
                ->add('his')
                ->add('guru');
         $form = $formBuilder->getForm();

        return $this->render('TSNStatsBundle:Buy:new.html.twig', array(
            'form' => $form->createView(),
            'guru' => $guru
        ));

    }
    else
    {
        //your guru ain't real bro!
    }
    return $this->render('TSNStatsBundle:Buy:new.html.twig', array(
        'alert' => $alert,
        'form' => $form->createView(),
        'guru' => $guru->getName()

     ));
}

public function createAction()
{
    $alert = new Alert();

    $form = $this->createForm(new AlertType(), $alert);
    $request = $this->getRequest();
    if ($this->getRequest()->getMethod() == 'POST') {
        $form ->bind($request);

        if ($form->isValid())
        {
            $em = $this->getDoctrine()
                    ->getEntityManager();
            $em->persist($alert);
            $em->flush();

            return $this->redirect($this->generateUrl('new_alert', array(
                'guru' => 2
            ) ));

        }
    }

    return $this->render('TSNStatsBundle:Buy:errors.html.twig', array(
          'errors' => $form->getErrors()
    ));

} 
```

这是我的模板：

```
Adding entry for {{ guru }}
<form action="{{ path('create_alert' ) }}" method="post" {{ form_enctype(form) }} class="alert">
{{ form_widget(form) }}
<p>
    <input type="submit" value="Submit">
</p>
</form> 
```

据我所知，一切都在书本上。每次我刷新时，每个表单都有一个 _token 值，它被调用的小部件，所以所有部分都应该在那里......

谢谢，

编辑：当我将整个表单创建过程替换为：

```
$form = $this->createForm(new AlertType(), $alert); 
```

然后它再次工作。问题是我想要的逻辑不属于“类型”类。那以及我这样做的方式应该正确的事实？它与我在表单中添加元素的方式有什么关系吗？这是我认为我的构建与 createForm() 构建的唯一不同之处。

Tl; Dr：使用带有 *entity*Type 调用的 createForm 调用可以正常工作，使用 createFormBuilder() 创建我自己的表单在每次提交时都会遇到 CSRF 错误.... 两者都使用相同的 _token。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T13:48:40.860

也许使用它会帮助你：

```
{{form_widget(form._token)}} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T02:36:18.537

尝试替换

```
{{ form_widget(form) }}
{{ form_rest(form) }} 
```

为了

```
{{ form_widget(form) }} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-27T16:10:38.283

您可以将与表单类型中相同的 $options 数组传递给 FormBuilder，并且可以通过以下方式关闭 csrf 保护：

```
$this->createFormBuilder($object, $options = array(
    'csrf_protection' => false,
)); 
```

原始示例： [http ://symfony.com/doc/current/book/forms.html#csrf-protection](http://symfony.com/doc/current/book/forms.html#csrf-protection)

# android - iOS 与 Android 位置跟踪与精确和电池消耗

> ID：14096800
> 
> 赞同：0
> 
> 时间：2012-12-31T02:27:27.007
> 
> 标签：android, iphone, gps, triangulation

我尝试了一个关闭 GPS 模块的 Android 设备。我开着车，水平精度在**50-300 米之间**，这对我来说是可以接受的精度。（三角测量+无线网络）

我正在尝试构建一个使用尽可能少电池的 iPhone 应用程序（应用程序将在开课日进行）。

这就是为什么我不想使用 GPS。百米精度会使用 GPS 还是与三角测量一起使用？

```
locationManager.desiredAccuracy = kCLLocationAccuracyHundredMeters; 
```

我也想知道 distanceFilter 对电池消耗有多重要？如果设置为`300m`or会有很大的不同`1000m`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T04:11:13.833

> 我正在尝试构建一个使用尽可能少电池的 iPhone 应用程序（应用程序将在 [整个] 天运行）。

然后，如果可能，您应该利用[显着更改位置服务](http://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html#//apple_ref/doc/uid/TP40009497-CH2-SW8)，因为这是在您的应用程序中获取长期位置数据的最省电的方法。这也是在后台将位置更新到您的应用程序的最有效方法（您可能在 Android 上认为这是理所当然的）。

同样来自 iOS Core Location 文档：

> **使用较低分辨率的值以获得所需的精度，除非这样做会损害您的应用程序。**...请记住，指定 kCLLocationAccuracyThreeKilometers 的值不会阻止位置服务返回更好的数据。大多数情况下，Core Location 可以使用 Wi-FI 和蜂窝信号以百米左右的精度返回位置数据。

可能基于此，该常量`kCLLocationAccuracyHundredMeters`通常不需要打开 GPS，但您可能会降低您要求的精度以**确保**GPS 如果关闭，iOS 可能仍会向您提供范围内准确的数据你比较喜欢。

> 我也想知道 distanceFilter 对电池消耗有多重要？

此过滤器更多地涉及实际向您的应用程序交付更新的频率，准确性更多地涉及获得修复所需的硬件。过滤器将减少打开无线电的频率，但当涉及 GPS 时，这是一个更大的省电工具。但是，如果您使用的是重大变化服务，则这部分问题是无关紧要的。

# java - 狮身人面像 4 大楼。阿帕奇蚂蚁

> ID：14096801
> 
> 赞同：0
> 
> 时间：2012-12-31T02:28:09.990
> 
> 标签：java, ant, speech-recognition, cmusphinx, sphinx4

我正在尝试在我的电脑上构建 sphinx-4 程序，但我被困在这一步。

> 要构建 Sphinx-4，在命令提示符处切换到安装 Sphinx-4 的目录（通常，一个简单的“cd sphinx4”就可以了）。设置所需的环境变量。JAVA_HOME 指向 JDK 的位置，ANT_HOME 指向 ant 的位置，PATH 包括 JDK 的 bin 子文件夹和 ant 变量的 bin 子文件夹。

有人可以告诉我该怎么做吗？

# apache-karaf - Karaf OSGI Aries Blueprint ClassCastException：Impl 无法转换为接口

> ID：14096802
> 
> 赞同：3
> 
> 时间：2012-12-31T02:28:17.400
> 
> 标签：apache-karaf, blueprint-osgi, aries

Karaf v2.3.0，org.apache.aries.blueprint.core:1.0.1，在从另一个包导入的服务上调用接口方法时抛出 ClassCastException。接口方法定义在接口上，由实现类实现。我无法弄清楚服务代理如何认为它是 Impl (TicketServiceImpl) 而不是接口 (TicketService)。我很感激有关如何解决此问题的任何建议或建议。

例外：

```
 Caused by: java.lang.ClassCastException: 
    org.abc.TicketServiceImpl cannot be cast to
    org.abc.TicketService at 
    Proxy3ac85313_c60c_42db_8def_ea7bd3d7411c.add(Unknown Source)
    ...
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)[:1.6.0_37]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)[:1.6.0_37]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)[:1.6.0_37]
    at java.lang.reflect.Method.invoke(Method.java:597)[:1.6.0_37]
    at org.apache.aries.blueprint.utils.ReflectionUtils.invoke(ReflectionUtils.java:297)[7:org.apache.aries.blueprint.core:1.0.1]
    at org.apache.aries.blueprint.container.BeanRecipe.invoke(BeanRecipe.java:958)[7:org.apache.aries.blueprint.core:1.0.1]
    ... 
```

奇怪的是，在异常之前，我打印了代理 .getInterfaces()，这意味着代理是 TicketService，而不是 TicketServiceImpl。

```
 MyTicketServer proxy interfaces: org.abc.TicketService, 
    org.apache.aries.proxy.weaving.WovenProxy 
    MyTicketServer Proxy class name: Proxy3ac85313_c60c_42db_8def_ea7bd3d7411c 
```

我还尝试在代理上强制进行 Class 测试：

```
 if (myTicketService instanceof TicketService) { <-- you'd think this would help
        myTicketService.add(ticket); //<-- Throws proxy ClassCastException!!
    } // implies problem is in the return path through proxy back to method 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:59:26.310

几乎明白了... TicketService 上的 classCastException 已通过删除客户端 blueprint.xml 中客户端 bean 上的“init-method”来修复。现在，doProcess() 不是从 init 方法启动，而是由 driver.onRegisterService() 启动，它调用 client.doProcess()，它调用 TicketService.add() 没有问题，没有异常。

```
<bean id="driver" class="org.xyz.RetrieveDriver"></bean>
<service id="ticketRetriever" interface="org.xyz.TicketRetriever"
    ref="ticketRetrieverRT">
    <registration-listener ref="driver"
        registration-method="onRegisterService" 
        unregistration-method="onUnregisterService" />
</service> 
```

这让我觉得客户端在服务代理完成构建之前一直在尝试使用服务（在它的 init-method="doProcess" 中）。我认为等待客户正式注册的第三类（驱动程序）将确保代理已准备好供客户使用。

但是，然后我向客户端添加了第二个服务属性。第二个服务在调用其方法时间歇性地抛出 ClassCastException。现在我认为这可能是一个普通的旧比赛条件；我通过添加驱动程序稍微减慢了客户端的速度，但速度不足以阻止第二个服务在它准备好之前被使用。这也可能是错误的。我很感激任何想法。

如果问题没有神奇地消失，我将为 ClassCastException 添加一个捕获，假设服务尚未准备好。

# javascript - JQuery/CSS：使用鼠标坐标和位置附加 div：绝对

> ID：14096806
> 
> 赞同：4
> 
> 时间：2012-12-31T02:28:53.553
> 
> 标签：javascript, jquery, css, position

好的复杂的 - 我创建了一些代码来在包装器 div 中附加一个 div：

```
$("#container").click(function(e){
   var parentOffset = $(this).parent().offset(); 
   var relX = e.pageX - parentOffset.left;
   var relY = e.pageY - parentOffset.top;

 $('#container').append('<div class="placeddiv" style="left:' + relX + '; top:' + relY +';"></div>'); 
```

如果`placeddiv`设置为`position: absolute;`

但是，我的`container`div 故意很大（10,000 像素 x 10,000 像素），因此我的包装 div 具有`overflow:scroll`.

问题是`placeddivs`不要停留在相对于`container`. 它们仅相对于`wrapper`.

我尝试过使用`position:relative`，但随后将放置的div“堆叠”在彼此之上（即，您不能在第一个上方添加第二个放置的div）。

有谁知道解决这个问题的方法？

（PS：我试图创建一个 Fiddle [http://jsfiddle.net/7WQ5Q/20/](http://jsfiddle.net/7WQ5Q/20/)但即使我已经从本地逐字复制（只是更改了 div 的名称以更有意义）它不会工作。从未使用过 JSFiddle之前所以我可能做错了什么）

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T02:37:57.393

几件事：

1.  有一个 JS 错字
2.  如果要设置这样的位置，则需要指定 px 。
3.  您的容器需要有位置：相对
4.  你需要自己考虑滚动

看看这个从你那里分叉的工作小提琴（用更干净的代码更新）：http: [//jsfiddle.net/wWEqP/5/](http://jsfiddle.net/wWEqP/5/)

```
$("#container").click(function(e){
    var wrapper = $(this).parent();
    var parentOffset = wrapper.offset(); 
    var relX = e.pageX - parentOffset.left + wrapper.scrollLeft();
    var relY = e.pageY - parentOffset.top + wrapper.scrollTop();

    $(this).append($('<div/>').addClass('placeddiv').css({
        left: relX,
        top: relY
    }));    
}); 
```

这是否涵盖了您试图完成的所有事情？

# php - 检查 PDO 中的会话 ID ISSET

> ID：14096808
> 
> 赞同：5
> 
> 时间：2012-12-31T02:30:04.877
> 
> 标签：php, pdo, sessionid, isset

我正在切换到 PDO 准备好的语句，但我的代码在获取和使用会话 ID 时遇到了问题。

当客户注册时 session_id 设置为等于 user_id（自动递增），并且 session_id 在用户返回时以相同的方式设置。这在切换到 PDO 之前工作正常，但现在在任何后续页面上都无法识别 session_id（它正在查看 'user_id' 为空）

我是否需要切换到使用 PDO 会话处理程序，或者有没有办法继续使用我熟悉的方法？

**mysql - 这是我用来设置会话 ID 的代码（这工作正常）：**

```
// Statements defining $user_name, $password and $hashedPassword (as shown below), and mysql_real_escape_string
// Insert statement
if($result) { 
$qry="SELECT * FROM customer_info WHERE user_name='$user_name' AND password='".sha1($salt + $_POST['password'])."'";
$result=mysql_query($qry);
if($result) {
    if(mysql_num_rows($result) == 1) {
    session_regenerate_id();
    $member = mysql_fetch_assoc($result);
    $_SESSION['SESS_USER_ID'] = $member['user_id'];
    session_write_close();
    exit();
    } } } 
```

**PDO - 这是我尝试过的代码（未设置会话 ID）：**

```
$user_name = $_POST['user_name'];
$password = $_POST['password'];  
$hashedPassword = sha1($salt . $password); 
$stmt = $conn->prepare('INSERT INTO customer_info (...) VALUES(...)');
$stmt->bindParam(':user_id', $user_id); 
...  
$insertResult = $stmt->execute();  
if ($insertResult) {
    $qry="SELECT * FROM customer_info WHERE user_name = $user_name AND password=$hashedPassword";
    if($qry) {
        $affected_rows = $stmt->rowCount();
        if ($affected_rows == 1)  {   
            session_regenerate_id();
            $member = $stmt->fetch();
            $_SESSION['SESS_USER_ID'] = $member['user_id'];   
        } 
```

**允许我在后续页面上引用会话 ID 的附加代码**

**此代码位于每个后续页面的顶部：**

```
<?php
  //Starts session and checks if the session variable SESS_USER_ID is present or not
  require_once('auth.php');  
  //Database connection and Open database
  require_once('config.php');  
  $user_id = $_SESSION['SESS_USER_ID']; 
?> 
```

**auth.php 文件**

```
<?php
session_start();
if(!isset($_SESSION['SESS_USER_ID']) || (trim($_SESSION['SESS_USER_ID']) == '')) {
    header("location: login_failed.html");
    exit();
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T19:25:55.323

调用`$stmt->fetch()`失败，因为此时，`$stmt`仍然引用`INSERT`您无法从中获取行的 SQL。

因此，您需要做的是执行一条`SELECT`语句来检索新输入的用户详细信息，并`fetch()`从中取而代之。`customer_info`假设您在表中有一个自动增量列，请`PDO::lastInsertId()`用于获取新行的 id 并在您的`SELECT`查询中使用它。

```
$user_name = $_POST['user_name'];
$password = $_POST['password'];  
$hashedPassword = sha1($salt . $password); 
$stmt = $conn->prepare('INSERT INTO customer_info (...) VALUES(...)');
$stmt->bindParam(':user_id', $user_id); 
...  
$insertResult = $stmt->execute();  
if ($insertResult && $stmt->rowCount() == 1) {
  // Ok, the INSERT was successful, so now SELECT the row back
  // Use lastInsertId() to get the new row's id
  // Assuming the id column is `user_id`...
  $stmt_user = $conn->prepare("SELECT * FROM customer_info WHERE user_id = :user_id");
  $stmt_user->bindValue(":user_id", $conn->lastInsertId());
  $stmt_user->execute();

  session_regenerate_id();
  // Fetch from the SELECT query
  $member = $stmt_user->fetch();
  $_SESSION['SESS_USER_ID'] = $member['user_id'];   
} 
```

如果没有我假设的自动增量列`user_id`，您可以使用`user_name`并`password`通过绑定输入来进行查询`$_POST['user_name']`，`$hashedpassword`就像您在原始`mysql_*()`代码中所做的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T19:54:22.050

非常具体的问题

> PDO - 这是我尝试过的代码（未设置会话 ID）：

```
$user_name = $_POST['user_name'];
$password = $_POST['password'];  
$hashedPassword = sha1($salt . $password); 
$stmt = $conn->prepare('INSERT INTO customer_info (...) VALUES(...)');
$stmt->bindParam(':user_id', $user_id); 
...  
$insertResult = $stmt->execute();  
if ($insertResult) {
    $qry="SELECT * FROM customer_info WHERE user_name = $user_name AND password=$hashedPassword";
    if($qry) {
        $affected_rows = $stmt->rowCount();
        if ($affected_rows == 1)  {   
            session_regenerate_id();
            $member = $stmt->fetch();
            $_SESSION['SESS_USER_ID'] = $member['user_id'];   
        } 
```

现在仔细查看代码并回答自己什么时候应该设置会话ID？
这应该在以下情况下进行：

1)`$insertResult`不是`FALSE`

哦，您的代码中有一个明显的错误，所以让我在这里停下来解释一下-

`$qry="SELECT * FROM customer_info WHERE user_name = $user_name AND password=$hashedPassword";`

在这种情况下，这只是一个哑字符串。所以你的指令本身归结为：

```
if ($insertResult) { //Which always will be TRUE regarding result as the string isn't empty!!! 

if ($affected_rows == 1)  {   //if the number of affected rows == 1 
```

然后插入会话 ID

**你到底做错了什么**

1）您不跟踪错误，因此您无法捕捉到错误的确切性质
2）您不执行 SQL 语句并从中获取结果
3）在行计数“失败”的情况下，您不跟踪这个，但请忽略这一点

**你应该做什么**

1）执行语句：`$qry="SELECT * FROM customer_info WHERE user_name = $user_name AND password=$hashedPassword";`（SQL语句也包含变量，好像你从旧`mysql_*`函数中得到了这个）喜欢

```
$stmt->prepare("SELECT * FROM customer_info WHERE user_name = :user_name AND password=:hashedPassword LIMIT 1;"); 
$stmt->execute(array(':user_name' => $username, ':hashedPassword' => $hashedPassword))); 
$result = $stmt->fetchAll(PDO::FETCH_ASSOC)

//now check $result if it found the row, like

if ( $result ){
   // found
} else {
   // not found, do track an error here
} 
```

2）再次 - 保持错误跟踪。我可以建议你实现一个自定义错误处理程序，但为了举例，你可以使用一个数组。
它看起来像这样：

```
<?php

//at the bottom of the script
$errors = array();

...
...

if ( $result ){
  // do next stuff
  ...
} else {
  //add an error
  array_push('Incorrect data', $errors);
} 
```

然后在某个地方，您可以简单地打印该错误，例如，

```
//We won't use a global keyword
function print_errors(array $errors){

   if ( !empty($errors) ){
        foreach($errors as $error){
           print '<p><li>' . $error . '</li></p>';
        }

   }
}

//Use like this:
print_errors($errors); 
```

这会让你有信心它到底卡在哪里

# php - 如何在下拉菜单中设置默认值

> ID：14096813
> 
> 赞同：2
> 
> 时间：2012-12-31T02:31:23.077
> 
> 标签：php, atk4, agiletoolkit

我有一个带有下拉列表的表单，其中包含这样设置的状态列表。

```
$this->addfield('State','state')->setValueList(array('Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware', 'Florida', 'Georgia', 'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada', 'New Hampshire', 'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington', 'West Virginia', 'Wisconsin', 'Wyoming')); 
```

我希望下拉菜单默认为纽约。如何在敏捷工具包中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:47:21.790

你试过链接吗

```
->defaultValue('New York') 
```

?

[http://agiletoolkit.org/doc/modeltable/fields](http://agiletoolkit.org/doc/modeltable/fields)

# r - 合并很多data.frames

> ID：14096814
> 
> 赞同：84
> 
> 时间：2012-12-31T02:31:32.457
> 
> 标签：r, dataframe, merge

> **可能重复：**
> [同时合并列表中的多个数据框](https://stackoverflow.com/questions/8091303/merge-multiple-data-frames-in-a-list-simultaneously)

示例`data.frames`：

```
 df1 = data.frame(id=c('1','73','2','10','43'),v1=c(1,2,3,4,5)) <br>
 df2 = data.frame(id=c('7','23','57','2','62','96'),v2=c(1,2,3,4,5,6)) <br>
 df3 = data.frame(id=c('23','62'),v3=c(1,2)) <br> 
```

注意：`id`对于每个 data.frame 都是唯一的。我希望得到的矩阵看起来像

```
1      1 NA NA 
2      3  4 NA 
7      NA 1 NA 
10     4 NA NA 
23     NA 2  1 
43     5 NA NA 
57     NA 3 NA 
62     NA 5  2 
73     2 NA NA 
96     NA 6 NA 
```

在这种情况下，我只显示 3 个数据集，实际上我至少有 22 个，所以最后我想要一个 nx(22+1) 的矩阵，其中 n 是所有 22 个数据集的 id 数。

给定 2 个数据集，我需要`ids`在第一列中获取它们，并且在第二列和第三列中填充值，如果不存在值，则`NA`改为输入。

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2012-12-31T02:40:00.767

Put them into a `list` and use `merge` with `Reduce`

```
Reduce(function(x, y) merge(x, y, all=TRUE), list(df1, df2, df3))
#    id v1 v2 v3
# 1   1  1 NA NA
# 2  10  4 NA NA
# 3   2  3  4 NA
# 4  43  5 NA NA
# 5  73  2 NA NA
# 6  23 NA  2  1
# 7  57 NA  3 NA
# 8  62 NA  5  2
# 9   7 NA  1 NA
# 10 96 NA  6 NA 
```

You can also use this more concise version:

```
Reduce(function(...) merge(..., all=TRUE), list(df1, df2, df3)) 
```

# javascript - 自定义 Google 搜索不会出现在 IE8 和 IE9 上

> ID：14096815
> 
> 赞同：0
> 
> 时间：2012-12-31T02:31:57.383
> 
> 标签：javascript, html

我们最近将 Google 上的搜索引擎更新为自定义搜索。它在 Chrome、Firefox 和 Safari 上运行良好，但搜索字段窗口不会出现在 IE8 和 IE9 中。我检查了 CSS 看看这是否是问题，但似乎不是问题。

这是他们希望我们使用的脚本，没有人看到为什么它不会出现在 IE 中的问题吗？

```
<!-- The following javascript appears before the closing </head> tag. -->
<script>
(function() {
var cx = '012938749785999463601:bae5a4ajf2q';
var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
    '//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
})();
</script>
<!-- This tag is inserted where the search box should render -->
 <gcse:searchbox-only></gcse:searchbox-only> 
```

这是一个网站页面：[http ://amazingribs.com/tips_and_technique/index2.html](http://amazingribs.com/tips_and_technique/index2.html)

此代码适用于所有其他浏览器。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T03:14:57.693

您可以尝试将代码移动到`<body>`标签内的某处吗？

您在`<head>`标签中有它，但它指的是`document`，在脚本执行时它可能还没有“准备好”。通过将其放置在 中`<body>`，`document`应该可用。

另外，我会尝试改变这个：

> var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);

仅此：

> document.body.appendChild(gcse);

# c# - 如何知道远程访问结束

> ID：14096819
> 
> 赞同：0
> 
> 时间：2012-12-31T02:33:03.590
> 
> 标签：c#, windows-7, remote-desktop

我使用属性[SystemInformation.TerminalServerSession](http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.terminalserversession.aspx)可以知道 destop 是否通过远程访问。
但是当远程访问结束时，用户可能会关闭远程连接。当用户关闭远程连接时，我可以获得日期时间吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T01:58:36.430

是的 - 使用[Cassia 库](http://code.google.com/p/cassia/)，就是这样`new TerminalServicesManager().CurrentSession.DisconnectTime`。

# php - 如何引用 localhost 之外的网站？Apache 想在服务器上找到 /website.com

> ID：14096820
> 
> 赞同：0
> 
> 时间：2012-12-31T02:33:07.463
> 
> 标签：php, apache, localhost

我正在我的本地主机上进行开发，`<iframe>`出于调试原因，我想显示一个，但 Apache 一直在目录中搜索我提供 Iframe 的源代码。

PHP：

```
echo "<iframe src= http://newyork.craigslist.com</frame>" 
```

结果是：

> 在此服务器上未找到请求的 URL /newyork.craigslist.org。

如何指定目标 URL 不在服务器上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:34:49.143

使用有效的 HTML。

```
echo '<iframe src="http://newyork.craigslist.com"></frame>'; 
```

如果您决定对`"`字符串文字使用双引号，请确保使用 . 转义属性引号`\`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T02:35:40.283

`src=`您应该删除and之间的空格，并在之前`http://`添加：`>``</frame>`

```
echo "<iframe src='http://newyork.craigslist.com'></frame>" 
```

# c++ - c++ 检测用户是否输入了字符串而不是 Int

> ID：14096821
> 
> 赞同：0
> 
> 时间：2012-12-31T02:33:09.243
> 
> 标签：c++, string, int

我正在制作一个程序，用户必须通过输入 1,2 或 3 来选择一个选项。我能够检测他们输入的数字，如果他们使用切换语句。每次我输入一个字母，程序每秒都会不断重复提示数百次。在继续之前，如何检查变量以确保它包含一个 int。我有一种感觉，它会涉及使用一个字符串，然后检查它以确保它包含一个 int 然后转换它，如果我可以有这个代码的一个例子，那就太好了。谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T02:38:30.080

您应该**始终**验证您是否已成功读取所需的输入。如果输入失败，您可能希望删除有问题的字符并重试：

```
int value(0);
while (!(std::cin >> value)) {
    std::cout << "you entered a non-digit character\n";
    std::cin.clear();   // make sure that std::cin is happy to do something
    std::cin.ignore();  // ignore the offending character
} 
```

当输入失败时，`std::ios_base::failbit`在流上设置 并且流不会转换为`true`（或`!`应用于流的 not 运算符返回`true`）。一旦`std::ios_base::failbit`设置，流将拒绝取得任何进展，直到该位再次被清除。使用`clear()`您可以重置错误位。然而，一旦这些位被重置，违规字符仍然在输入中。要摆脱下一个字符，您可以使用`ignore()`. 如果你觉得你想忽略整行输入，你会使用类似的东西

```
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n'); 
```

# jquery - 让 jQuery html 重新出现

> ID：14096823
> 
> 赞同：0
> 
> 时间：2012-12-31T02:33:38.023
> 
> 标签：jquery, html, timer, count, warnings

感谢您提前阅读本文。

我正在尝试显示一条消息，向我的用户发出警告。我已成功完成此操作，但是当我重复我的函数使用的操作时，该消息不再出现。

任何帮助，将不胜感激！

```
//take 5 seconds off the timer
                var count = parseInt($('.timerCount').html());
                $('.timerCount').html(count - 5);
                $('.timerWarnings').html("5 seconds has been deducted from the timer");
                $('.timerWarnings').fadeOut("slow"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:35:16.417

如果你淡出一个元素，它会一直隐藏，直到你告诉它不要。确保`.show().fadeOut()`元素开始可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T02:38:58.863

您应该首先让消息重新出现，以防它在之前的迭代中被隐藏：

```
var count = parseInt($('.timerCount').html());
$('.timerCount').html(count - 5);
$('.timerWarnings')
 .show()
 .html("5 seconds has been deducted from the timer")
 .fadeOut("slow"); 
```

# visual-studio-2010 - 找不到目标 .NET Framework 4.0

> ID：14096827
> 
> 赞同：2
> 
> 时间：2012-12-31T02:34:10.190
> 
> 标签：visual-studio-2010, .net-framework-version

我正在尝试使用 mvcMusicStore 进行项目，并安装了框架 v4.0 客户端。

当我试图从项目中将框架定位到 v4.0 时，找不到它，问题出在哪里？

![在此处输入图像描述](../Images/43442011e6f3b4d9a663085b9011d8cd.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:42:40.023

I think you will need to download the [complete .Net 4.0 Framework](http://www.microsoft.com/en-us/download/details.aspx?id=17851) in order to get the environment needed to be used in Visual Studio. The client profile from what I can find does not have what is necessary for development.

If the above doesn't work I would suggest trying a repair of Visual Studio as suggested by this [SO question](https://stackoverflow.com/questions/6389368/visual-studio-2010-not-recognizing-net-framework-4-0).

The Full Framework:

> The Microsoft .NET Framework 4 web installer package downloads and installs the .NET Framework components required to run on the target machine architecture and OS. An Internet connection is required during the installation. .NET Framework 4 is required to run and develop applications to target the .NET Framework 4.

Tne Client Profile:

> The Microsoft .NET Framework 4 Client Profile redistributable package installs the .NET Framework runtime and associated files that are required to run most client applications.

# python - 使用 Python zipfile 模块删除 zip 文件中的文件夹

> ID：14096829
> 
> 赞同：0
> 
> 时间：2012-12-31T02:34:47.513
> 
> 标签：python, zipfile

是否可以使用 Python 中的 ZipFile 模块从文件中删除文件夹？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:41:24.697

No. Read out the rest of the archive and write it to a new zip file.

# java - Java 垃圾收集和图形处理方法

> ID：14096836
> 
> 赞同：4
> 
> 时间：2012-12-31T02:35:54.263
> 
> 标签：java, graphics, sync, dispose, toolkit

我正在创建一个游戏（蛇克隆）作为一种爱好。我正在查看 Java API 中 Graphics 类的 dispose 方法。当我注释掉 dispose 方法时，无论有没有它，我的动画都可以正常工作。在 Java API 中， dispose 方法执行此操作 - 释放图形上下文正在使用的系统资源。Java 垃圾回收不是像 dispose 那样管理程序的内存吗？我应该保留 dispose 方法吗？

API 在解释同步方法方面没有多大帮助。但是从我在其他论坛上看到的内容来看，ToolKit 类中的同步方法是为了确保绘图操作（如我想的 paintComponent 方法）刷新到显卡。那么图形卡的工作是清理程序先前图形上下文的任何残留物吗？

这是代码：

```
 public void paintComponent(Graphics g) {
            super.paintComponent(g);
            Toolkit.getDefaultToolkit().sync();
            g.dispose();

     } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T02:53:15.963

说到`Graphics`这里，有一个简单的原则。

如果你明确地创建它（例如`BuffereImage.createGraphics()`）然后处理它。

`paintComponent(Graphics g)`实例中的OTOH`g`由工具包提供，并在需要时/在需要时处理。在您自己的代码中这样做会导致“不可预测”的渲染。

# emacs - 如何获取Package安装的插件版本？

> ID：14096840
> 
> 赞同：2
> 
> 时间：2012-12-31T02:36:38.053
> 
> 标签：emacs, package, version

使用elisp，如何获取Emacs包管理工具-Package安装的包的版本？必须有某种方法可以做到这一点，因为版本信息*在*由`list-packages`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T03:40:57.630

```
(defun get-package-version (name)
  (when (member name package-activated-list)
    (package-desc-vers (cdr (assoc name package-alist))))) 
```

大多数软件包版本都存储为`[major-version minor-version]`. 从 GitHub 构建的 Melpa 包使用时间格式`[YYYYMMDD hhmm]`如果您想要这些列表中的字符串，您可以执行以下操作：

```
(defun* package-version-string ((major minor))
  (format "%s.%s" major minor))

(package-version-string (get-package-version 'pep8))  ; => "1.2" 
```

**更新**：要获取未安装的软件包，我们可以测试 的成员资格`package-archive-contents`，如下所示：

```
(defun get-not-installed-packages ()
  (remove-if (lambda (x) (assoc (car x) package-alist)) package-archive-contents))

(defun get-not-installed-package-version (name)
  (let ((pkg (assoc name (get-not-installed-packages))))
    (when pkg
      (package-desc-vers (cdr pkg))))) 
```

# emacs - 如何防止emacs在没有警告的情况下覆盖文件？

> ID：14096843
> 
> 赞同：1
> 
> 时间：2012-12-31T02:37:31.203
> 
> 标签：emacs

在两个不同的场合，我用 emacs 覆盖了重要文件，直到后来才意识到。发生这种情况是因为各种命令（特别是`org-agenda-write`and `org-export`）将简单地替换现有文件，而不会警告该名称的文件已经存在。有没有办法配置emacs，这样就不会发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T02:53:16.730

`org-agenda-write`用于`write-file`保存您的议程。当从程序调用此函数时，将覆盖现有文件而无需确认。`write-file`深埋在里面`org-agenda-write`，直接修改它可能会在 Emacs 的其他地方引起令人惊讶的错误。但是，您可以包含`org-agenda-write`一个环绕建议。这是添加检查文件是否存在并在覆盖之前提醒用户的一种巧妙方法。

```
(defadvice org-agenda-write (around my-file-check)
  "Check if a file exists before writing the agenda to it."
  (if (file-exists-p file)
      (if (y-or-n-p (format "Overwrite %s?" file))
          ad-do-it)
    ad-do-it))

(ad-activate 'org-agenda-write) 
```

这可能是 中的一个错误`org-agenda-write`，如果您在 orgmode 邮件列表中很好地询问，他们可能会被说服将此检查作为默认行为。

文件的写入行为`org-export`看起来比较复杂，可能需要借助外部程序来完成。不过，如果您愿意，您可能可以使用类似的包装器。

# ruby - 要求范围/宝石超出范围？

> ID：14096844
> 
> 赞同：1
> 
> 时间：2012-12-31T02:37:34.887
> 
> 标签：ruby, gem, twitter

好的，我在加载特定库或更多库可能超出范围时遇到了一些麻烦。这就是在这种情况下发生的事情吗？

**主要问题：**需要函数中的库，以便它们可以在全局范围内使用。例子：

```
 class Foo
      def bar
         require 'twitter_oauth'
         #....
      end
      def bar_2
         TwitterOAuth::Client.new(
            :consumer_key => 'asdasdasd',
            :consumer_secret => 'sadasdasdasdasd'
            )
      end
    end 

   temp = Foo.new
   temp.bar_2 
```

现在要解决我的问题，我正在尝试运行 eval 将其绑定到全局范围......就像这样

```
 $Global_Binding = binding
   class Foo
      def bar
         eval "require 'twitter_oauth'", $Global_Binding
         #....
      end
      def bar_2
         TwitterOAuth::Client.new(
            :consumer_key => 'asdasdasd',
            :consumer_secret => 'sadasdasdasdasd'
            )
      end
    end 

   temp = Foo.new
   temp.bar_2 
```

但这似乎并没有奏效……有什么想法吗？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T04:10:20.163

**A.**
文件 test_top_level.rb ：

```
puts '    (in TestTopLevel ...)'
class TestTopLevel
end 
```

使用 RSpec 测试文件 ttl.rb ：

```
# This test ensures that an included module is always processed at the top level,
# even if the include statement is deep inside a nesting of classes/modules.

describe 'require inside nested classes/modules' do
#        =======================================

    it 'is always evaluated at the top level' do
        module Inner
            class Inner
                require 'test_top_level'
            end
        end

        if RUBY_VERSION[0..2] == '1.8'
        then
            Module.constants.should include('TestTopLevel')
        else
            Module.constants.should include(:TestTopLevel)
        end
    end
end 
```

执行 ：

```
$ rspec --format nested ttl.rb 

require inside nested classes/modules
    (in TestTopLevel ...)
  is always evaluated at the top level

Finished in 0.0196 seconds
1 example, 0 failures 
```

**B.**
如果不想处理不必要的 require 语句，可以使用 autoload 代替。`autoload( name, file_name )`在第一次访问模块名称时注册要加载的文件名（使用 Object#require）。

文件 twitter_oauth.rb ：

```
module TwitterOAuth
    class Client
        def initialize
            puts "hello from #{self}"
        end
    end
end 
```

文件 t.rb ：

```
p Module.constants.sort.grep(/^T/)

class Foo
    puts "in class #{self.name}"

    autoload :TwitterOAuth, 'twitter_oauth'

    def bar_2
        puts 'in bar2'
        TwitterOAuth::Client.new
    end
end 

temp = Foo.new
puts 'about to send bar_2'
temp.bar_2

p Module.constants.sort.grep(/^T/) 
```

在 Ruby 1.8.6 中执行：

```
$ ruby -w t.rb 
["TOPLEVEL_BINDING", "TRUE", "Thread", "ThreadError", "ThreadGroup", "Time", "TrueClass", "TypeError"]
in class Foo
about to send bar_2
in bar2
hello from #<TwitterOAuth::Client:0x10806d700>
["TOPLEVEL_BINDING", "TRUE", "Thread", "ThreadError", "ThreadGroup", "Time", "TrueClass", "TwitterOAuth", "TypeError"] 
```

# php - 解析错误：语法错误，意外的 ';' （类 timer.php）

> ID：14096846
> 
> 赞同：-1
> 
> 时间：2012-12-31T02:38:15.380
> 
> 标签：php, syntax-error

我在该行有一个语法错误：`return (double) + (double);`

```
 public function getMicroTime( )
    {
        list( $usec, $sec ) = explode( " ", microtime( ) );
        return (double) + (double);
    } 
```

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:42:38.010

The `(double)` type cast behaves much like a unary operator and thus requires an argument next to it. You should return the following instead:

```
return (double)$usec + (double)$sec; 
```

However, since 5.0, your whole function can be replaced by simply this:

```
microtime(true); 
```

By passing `true` as the first argument, it returns the time as a float with ms accuracy.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T02:44:37.837

google finds this, based on your vars, you may be missing something in your copy and paste skills :-)

```
function getmicrotime($t) {  
 list($usec, $sec) = explode(" ",$t);  
 return ((float)$usec + (float)$sec);  
} 
```

# jquery - 从 async false 到 async true

> ID：14096848
> 
> 赞同：1
> 
> 时间：2012-12-31T02:38:29.483
> 
> 标签：jquery, ajax, jquery-mobile

嗨，我有一段代码运行了好几次

Loader.load('data/map.json')

我的想法是我可以传入任何 json 文件，加载器会处理它

所以这是异步错误格式的加载器

```
 var Loader = {
    basePath: '',
    cache: {},
    load: function(name) {
        if(typeof this.cache[name] == 'undefined') {
            var loadUrl = (this.basePath == '') ? name : this.basePath + '/' + name;
            var parameters = {

                url: loadUrl,
                dataType: 'json',
                async: false,
                context: this,
                success: function(data) {
                    this.cache[name] = data;
                }
            };

            $.ajax(parameters);
        }
        return this.cache[name];
   }
};
return Loader; 
```

但这是异步错误格式，我需要将其设置为异步真实格式，以便更好地与 jQuerymobile 一起使用，所以在这里有一些帮助，我设法让它达到异步的程度

```
var data = AsyncLoader.load('data/map.json').done(function(data, textStatus, jqXHR) {
            console.log("complete");

        }).fail(function(jqXHR, textStatus, errorThrown) {

            console.log("an error has occurred");

        }).always(function(jqXHR, textStatus) {
            console.log("running");
        }); 
```

这调用了 asynloader

```
function($) {
var AsyncLoader = {
    basePath: '',
    cache: {},
    load: function(name) {
        if(typeof this.cache[name] == 'undefined') {
            var loadUrl = (this.basePath == '') ? name : this.basePath + '/' + name;
            var parameters = {
                beforeSend: function() { $.mobile.showPageLoadingMsg(); },
                complete: function() {$.mobile.hidePageLoadingMsg(); },
                url: loadUrl,
                dataType: 'json',
                async: true,
                context: this,
                success: function(data) {
                    this.cache[name] = data;
                }
            };

            $.ajax(parameters);
        }

        return this.cache[name];
    }
};

return AsyncLoader; 
```

问题是要使这项工作我需要返回 $.ajax(parameters) 而不是返回 this.cache[name]; 否则我会收到一个javascript错误..问题是如果我在第二次加载maps.json时将其更改为获取$.ajax(parameters)，它不会从this.cache获取数据，它将加载json文件再次没有用

谁能帮忙

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:07:24.010

`$.ajax`返回[一个`Deferred`对象](http://api.jquery.com/category/deferred-object/)。你也可以返回你自己的`Deferred`对象。您的新代码可能看起来像这样：

```
load: function(name) {
    // Is the object already in the cache?
    if(Object.prototype.hasOwnProperty.call(this.cache, name)) {
        // Yes! Return a Deferred that's already been resolved.
        return jQuery.Deferred().resolve(this.cache[name]);
    }else{
        // No! We have to load it. Let's still use our own Deferred, though:
        var deferred = jQuery.Deferred();

        // There's our Deferred. Now let's load it.
        jQuery.ajax({
            // ...
        }).done(function(data) {
            // We loaded it successfully!
            // Add it to our cache and resolve the Deferred.
            this.cache[name] = data;
            deferred.resolve(data);
        }).fail(function() {
            // Fail! Pass the failure on to our deferred.
            deferred.reject.apply(deferred, arguments);
        });

        // We've started the AJAX request. Now return our Deferred.
        return deferred;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T23:59:51.923

两个建议：

*   避免`this`参考`AsyncLoader`

*   `Object.hasOwnProperty()`用而不是测试对象属性的存在`typeof .... == 'undefined'`。

JS：

```
function($) {
    var AsyncLoader = {
        basePath: '',
        cache: {},
        load: function(name) {
            var dfrd = $.Deferred();
            if(!AsyncLoader.cache.hasOwnProperty(name)) {
                var loadUrl = (AsyncLoader.basePath == '') ? name : AsyncLoader.basePath + '/' + name;
                $.ajax({
                    beforeSend: function() { console.log("d"); },
                    url: loadUrl,
                    dataType: 'json',
                    async: true,
                    success: function(data) {
                        AsyncLoader.cache[name] = data;
                        dfrd.resolve(data);
                    }
                });
            }
            else {
                return dfrd.resolve(AsyncLoader.cache[name]);
            }
            return dfrd.promise();
        }
    };
    return AsyncLoader;
...
}(jQuery); 
```

**笔记**

数据已经缓存后可以`AsyncLoader.load()`直接返回，但需要从服务器获取数据时就不行了；原因是服务器响应是异步的。需要一种机制，通过该机制，任何调用 的表达式`AsyncLoader.load()`都可以以完全相同的方式接收数据，而不管是`AsyncLoader.load()`从缓存中获取数据还是从服务器获取数据。

所以在上面的代码中，`AsyncLoader.load()`不会尝试返回数据，至少不是传统意义上的；相反，它返回一个“承诺”，如果所需的数据已经从缓存中可用，则立即解决，或者稍后在服务器响应时解决。

在这两种情况下，传递给的值在被调用`dfrd.resolve(...)`的范围内变得可用，作为在（或）方法`AsyncLoader.load()`中指定的函数的参数，在返回的 Promise 上调用（通常通过方法链接）。`.done()``.always()``.then()`

例如 ：

```
AsyncLoader.load('myName').done(function(data) {
    console.log(data);
    //do wheatever else is necessary with `data` here.
}); 
```

这样，目的就达到了。通过返回一个承诺（在 内创建`AsyncLoader.load()`），所需的数据在 的范围之外可用`AsyncLoader.load()`，以完全相同的方式，无论它是从缓存中提取还是从服务器新接收的。

调用`AsyncLoader.load()`的表达式完全不知道数据是否来自缓存，但必须始终以正确的方式编写以通过返回的 Promise 接收数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T04:30:18.507

嗯，这不是很有效..

如果我用这个

收藏

```
var data = AsyncLoader.load('data/map.json').done(function(data) {

    var models = [];
    $.each(data.data.locations, function() {
        // RESERVED WORDS YO
        if(this['delete'] == 1) {
            return;
        }

        models.push(new MapLocationModel(this));

    });
    $t.reset(models);

}); 
```

异步加载器

```
function($) {
var AsyncLoader = {
    basePath: '',
    cache: {},
    load: function(name) {
        if(typeof this.cache[name] == 'undefined') {

            console.log("not cached");

            var deferred = jQuery.Deferred();
            var loadUrl = (this.basePath == '') ? name : this.basePath + '/' + name;
            var parameters = {
                beforeSend: function() { console.log("d"); },
                url: loadUrl,
                dataType: 'json',
                async: true,
                context: this,
                success: function(data) {
                    this.cache[name] = data;
                    deferred.resolve(data);
                }
            };

            $.ajax(parameters);
            return deferred;

        } else {

        console.log("cached");

        return jQuery.Deferred().resolve(this.cache[name]);

        }

    }
};

return AsyncLoader; 
```

我将多次加载地图数据，并且永远不会从缓存中获取它..

但是，如果我在上面更改为 async false 它工作正常，但我需要 async 为 true

谢谢

# matlab - 代码中未定义的 x

> ID：14096850
> 
> 赞同：1
> 
> 时间：2012-12-31T02:39:11.513
> 
> 标签：matlab, optimization

我是 MATLAB 新手，我正在尝试运行优化工具箱。在运行代码时，

```
function f = objfun(x)
f = exp(x(1))*(4*(x(1)^2)+2*x(2)^2);

x0 = [-1,1];
options = optimset('LargeScale','off');
[x,fval,exitflag,output] = fminunc(@objfun,x0,options); 
```

我收到以下错误，

> ？？？输入参数“x”未定义。
> 
> ==> 平方在 2 处的错误
> f = exp(x(1)) *(4* (x(1)^2)+2*x(2)^2);

请帮我指出我所缺少的..

提前谢谢了 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T04:04:10.990

我无法重现该错误。也许它与您设置代码或将其写入函数的方式有关？

当我将以下内容放入文件并将其保存为“testJugeshOptimization.m”时：

```
function x = testJugeshOptimization

x0 = [-1,1];
options = optimset('LargeScale','off');
[x,fval,exitflag,output] = fminunc(@objfun,x0,options);

%% subfunction objfun
function f = objfun(x)
f = exp(x(1))*(4*(x(1)^2)+2*x(2)^2); 
```

并将函数运行为

```
x = testJugeshOptimization 
```

我得到结果

```
Local minimum found.

Optimization completed because the size of the gradient is less than
the default value of the function tolerance.

<stopping criteria details>

ans =

   1.0e-07 *

   -0.1679    0.0773 
```

# css - Styling DIV Arrow Outlines - Making hollow triangles

> ID：14096855
> 
> 赞同：2
> 
> 时间：2012-12-31T02:40:09.517
> 
> 标签：css, html, transparency

thank you for all the years that I've never had to post a question and simply just searched!

Now, I'm trying to draw an arrow with a DIV. Example: [http://i.imgur.com/wZBgv.png](http://i.imgur.com/wZBgv.png)

So far code such as that below will draw a triangle: [http://i.imgur.com/9nr3b.png](http://i.imgur.com/9nr3b.png)

```
.arrow-small {
position: absolute;
bottom: 0;
left: 0;
width: 0; 
height: 0;
border-style: solid;
border-width: 80px 600px 50px 600px; 
border-color: transparent transparent blue transparent;
} 
```

One method I've tried has been to create a smaller filled triangle to place on top of the large one which would create the arrow outline that I'm looking for, however I can not find a way to make the top div show the page background to complete the effect.

For clarity, my questions:

1) How does one create a backgroundless arrow with a div?

2) Or, how does one show the body background in a div ontop of another div that is not transparent?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T04:34:48.497

[**jsFiddle 演示：荧光绿箭头**](http://jsfiddle.net/f6LAN/)

我认为这行不通，因为您正在用其他不透明的东西覆盖不透明的东西。如果您能够使用 CSS3，以下内容可能适合您的需求：

```
<html>
  <head>
    <style>
      .chevron {
        position: absolute;
        width: 50px;
        height: 10px;
        top: 20px;
        background-color:red;
      }
      .left
      {
        left: 0px;
        -webkit-transform: rotate(340deg);
        -moz-transform: rotate(340deg);
        -o-transform: rotate(340deg);
        -ms-transform: rotate(340deg);
        transform: rotate(340deg);
      }
      .right
      {
        left: 43px;
        -webkit-transform: rotate(20deg);
        -moz-transform: rotate(20deg);
        -o-transform: rotate(20deg);
        -ms-transform: rotate(20deg);
        transform: rotate(20deg);
      }
    </style>
  </head>
  <body>
    <div class='chevron left'></div>
    <div class='chevron right'></div>
  </body>
</html> 
```

[我在这个页面](http://www.red-team-design.com/how-to-create-slick-effects-with-css3-box-shadow)上发现了转换，这是在回答[这个问题](https://stackoverflow.com/questions/9635545/box-shadow-with-triangle-shaped-border-to-create-chevron-shaped-div)时给出的，听起来很接近你的问题。

# javascript - 使用 jQuery 级联 z-index

> ID：14096859
> 
> 赞同：1
> 
> 时间：2012-12-31T02:40:30.983
> 
> 标签：javascript, jquery, z-index

所以我有一个这样的清单；

```
<ul>
  <li>Sausage</li>
  <li>Egg</li>
  <li>Parsnip</li>
  <li>Sarsaparilla</li>
  <li>Burger</li>
  <li>Cilantro</li>
</ul> 
```

我需要将“级联`z-index`”动态添加到特定的 li，以便我可以指定 a`li`为顶部，而所有其他`li`s 逐渐减少。

例如，如果我有一个 jQuery`click()`事件绑定到一个函数，该函数会以我想要的方式动态计算`z-index`es，然后我单击“Parsnip”，列表现在看起来像这样；

```
<ul>
  <li style="z-index: 2;">Sausage</li>
  <li style="z-index: 3;">Egg</li>
  <li style="z-index: 4;">Parsnip</li>
  <li style="z-index: 3;">Sarsaparilla</li>
  <li style="z-index: 2;">Burger</li>
  <li style="z-index: 1;">Cilantro</li>
</ul> 
```

单击“香菜”将使列表如下所示；

```
<ul>
  <li style="z-index: 1;">Sausage</li>
  <li style="z-index: 2;">Egg</li>
  <li style="z-index: 3;">Parsnip</li>
  <li style="z-index: 4;">Sarsaparilla</li>
  <li style="z-index: 5;">Burger</li>
  <li style="z-index: 6;">Cilantro</li>
</ul> 
```

换句话说，被点击的`li`将有最高的`z-index`必要带到前面（需要计算，因为`li`s 的数量可以是任何东西），它的直接兄弟姐妹会低一个，他们的兄弟姐妹会低一个，等等。

我怎么可能做到这一点？列表项不一定需要分配与`z-index`图示完全相同的数字，只要实现“级联”元素的视觉效果，点击次数最高即可。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:55:37.277

怎么样

```
$('li').click(function(){
    var prev = $(this).prevAll();
    var next = $(this).nextAll();
    var count = prev.length;
    if (next.length > count){
        count = next.length;
    }
    $(this).css({zIndex: count+1});
    prev.each(setIndex);
    next.each(setIndex);
    function setIndex(i){
        $(this).css({zIndex: count-i})
    }
});​ 
```

[http://jsfiddle.net/UaaNn/](http://jsfiddle.net/UaaNn/)

# jquery - Jquery在滚动上加载更多

> ID：14096863
> 
> 赞同：0
> 
> 时间：2012-12-31T02:42:18.337
> 
> 标签：jquery

我正在尝试将 load_second.php 中的数据加载到结果 div 中。但是，当我第一次向下滚动时，它会从 load_second.php 加载数据，但是，我想保留该数据，并且当我再次滚动时，它应该加载更多数据。任何帮助将不胜感激。

```
<script type='text/javascript'>$(window).scroll(function(){ 
    if ($(window).scrollTop() == $(document).height() - $(window).height()){

        $('#result').load('load_second.php');

    }
});
</script>

<div id='result'></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:51:40.220

您不能使用`load()`方法附加内容。用于`get()`检索数据并将其附加到`div`.

```
$.get('load_second.php', function(data) {
    $('#result').append(data);
}); 
```

# batch-file - stoping and starting IIS 6.0 or my application pool on IIS using a batch file

> ID：14096864
> 
> 赞同：0
> 
> 时间：2012-12-31T02:42:24.590
> 
> 标签：batch-file, batch-processing

I have two windows boxes. one is windows xp(local computer) where i need to write a batch file and the other is windows server 2003 where my IIS is located. Now i need to write a batch file in windows Xp that needs to do these below mentioned operations in it.

1.  Stop the IIS or my application pool on that IIS.
2.  Start the IIS or my application pool on that IIS.

    These stop and start need to be performed in two different lines. The windows Server 2003 box has a different user id and password to my windows xp(local computer). As i am new to writing the batch files, after my one day of struggle i am just able to kill the process of my application pool(w3wp.exe) on IIS which is located in the windows server 2003 and i am still not sure what i have written is correct or not. Please help me how to stop and start the IIS which is on server 2003 box, as the batch file should be on the xp box. Thanks in advance for your help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:55:57.853

有一个用于启动/停止/重新启动 IIS 的内置程序 - iisreset.exe

单独调用此程序将停止然后重新启动 IIS。如果您只想停止 IIS 而不重新启动它，请使用以下命令：

> iisreset.exe /停止

然后你可以像这样再次启动它：

> iisreset.exe /开始

这应该适用于所有版本的 IIS，无论操作系统版本如何。请记住，您需要以管理员身份执行它。

**编辑：**刚刚注意到您想从 XP 框中运行命令以在 W2K3 框上重新启动 IIS - 有一个可选参数来指定目标计算机：

> iisreset.exe 服务器名称或Ip /停止

和：

> iisreset.exe 服务器名称或Ip /START

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:51:40.970

最后经过长时间的努力，我通过“从具有不同 ID 和密码的远程框启动和停止 iis”使其工作。我最初尝试了 runas 命令，但它不起作用，然后我转到 ps 工具并使用下面提到的命令。

psexec \COMPUTER_NAME -u USERID -p PASSWORD iisreset.exe /START ----> 用于启动 iis psexec \COMPUTER_NAME -u USERID -p PASSWORD iisreset.exe /STOP ----> 用于停止 iis

@djhayman --- 感谢您的帮助。

# javascript - forms and javascript

> ID：14096871
> 
> 赞同：0
> 
> 时间：2012-12-31T02:44:19.470
> 
> 标签：javascript

I have a form button and I want 2 lines of text. In the form I have this

```
value='".$row['item'].'&#10;$'.$row['price']."' 
```

and I get

```
Hot Dog
$1.00 
```

I want to update this in JavaScript and tried this

```
sBtn = itm + "&#10;$" + prc;
document.getElementById(conbtn).value = sBtn; 
```

and

```
sBtn = itm + "<br>$" + prc;
document.getElementById(conbtn).value = sBtn; 
```

without success. The first gives

```
Hot Dog&#10;$1.00 
```

and the second

```
Hot Dog<br>$1.00 
```

Any idea how to write 2 lines from JS?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:50:20.033

我知道了。用过的

```
sBtn = itm + "\r\n$" + prc; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T02:52:18.963

如果您有表单输入按钮，请在`value`属性中使用转义换行符。

```
document.getElementById(conbtn).value = "Test 1\nTest 2"; 
```

如果您有按钮标记元素，请在`innerHTML`属性中使用中断元素。

```
document.getElementById(conbtn).innerHTML = "Test 1<br/>Test 2"; 
```

# iphone - When releasing an App update, can my data in the bundle path change or get deleted?

> ID：14096873
> 
> 赞同：1
> 
> 时间：2012-12-31T02:44:30.037
> 
> 标签：iphone, ios, nsbundle

I'm getting ready to release a new update for my app which stores data in the local bundle path and I want to ensure the data stored in this path isn't deleted when they update. Can this happen and what should I watch out for?

This is the code I'm using to get the path to store data:

```
// Temporary method variables
NSError *error;

// Create a list of paths
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

// Get the path to the apps documents directory from the array
NSString *documentsDirectory = [paths objectAtIndex:0];

// Create a full path to the file
NSString *path = [documentsDirectory stringByAppendingPathComponent:@"FFUserPrefs.plist"];

// Access the file manager
NSFileManager *fileManager = [NSFileManager defaultManager];

// Check if the file exists and if not, copy from the bundle path to the documents path
if (![fileManager fileExistsAtPath:path])
{
    // Get path to file from bundle directory
    NSString *pathBundle = [[NSBundle mainBundle] pathForResource:@"FFUserPrefs" ofType:@"plist"];

    // Copy pref file to app documents folder
    [fileManager copyItemAtPath:pathBundle toPath:path error:&error];
} 
```

I'm just afraid that the data my users have stored in this directory could be lost and want to make sure it is still there after updating. The only reason I ask is because after running my new build via xCode on my phone that had the release application installed, it wiped out the data and started fresh. What am I missing? Does the app bundle path change between Xcode and release. Any info would be greatly appreciated!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:53:36.090

应用程序更新期间不会删除存储在文档目录中的文件。`FFUserPrefs.plist`存储在文档目录中，因此更新后它仍然存在。但是，存储在 app bundle ( `[NSBundle mainBundle]`) 中的文件将被新的 bundle 替换。

# terminal - PEAR 包含在 MAMP 中：如何通过终端访问？

> ID：14096876
> 
> 赞同：0
> 
> 时间：2012-12-31T02:44:44.840
> 
> 标签：terminal, pear, mamp

我正在尝试运行一个命令，该命令使用安装了 MAMP 的 PEAR 下载一些软件。

这是我在终端中运行的命令：

```
pear channel-discover pear.phpdoc.org 
```

终端响应：

*-bash：梨：找不到命令*

有人可以建议如何访问预装 MAMP 的 PEAR 吗？

我的 Mac 上 MAMP 的路径是 /Applications/MAMP/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T20:47:36.683

我不使用 mamp 但我想你可以在这里找到梨：

```
/Applications/MAMP/bin/php5.3/bin/pear 
```

您可以简单地添加一些别名以使其更短，例如

```
alias mamppear="/Applications/MAMP/bin/php5.3/bin/pear" 
```

# xml - XSLT：如何使用参数调用 xs:boolean() 构造函数？

> ID：14096878
> 
> 赞同：0
> 
> 时间：2012-12-31T02:45:00.380
> 
> 标签：xml, xslt

我尝试了下面的表达式，但收到了解析错误：

> 错误：“非静态 Java 函数 'boolean' 的第一个参数不是有效的对象引用。”

```
<xsl:variable name="elemVal">
    <xsl:value-of select="."/>
</xsl:variable>

<xsl:variable name="boolVal" as="xs:boolean" select="xs:boolean($elemVal)"/> 
```

# python - 如何减少查询次数？

> ID：14096880
> 
> 赞同：7
> 
> 时间：2012-12-31T02:45:49.283
> 
> 标签：python, django

此代码当前正在执行大约 50 个 SQL 查询：

```
c = Category.objects.all()

categories_w_rand_books = []

for category in c:
    r = Book.objects.filter(author__category=category).order_by('?')[:5]

    categories_w_rand_books.append((category, r)) 
```

我需要将使用的查询数量减少到最低限度以加快速度并且不会导致服务器负载。

基本上，我有三个模型：类别、作者、书籍。作者属于类别（不是书籍），我需要获取所有类别的列表，每个类别下有 5 本书。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T16:20:06.150

如果您更喜欢单个查询并且正在使用`MySQL`，请查看@Crazyshezy 在他的评论中提供[的出色链接。](http://www.xaprb.com/blog/2006/12/07/how-to-select-the-firstleastmax-row-per-group-in-sql/)
对于后端，可能的查询是（假设从to和 from to`PostgreSQL`有不可为空的`FK`关系）：`Book``Author``Author``Category`

```
SELECT * FROM (
    SELECT book_table.*, row_number() OVER (PARTITION BY category_id ORDER BY RANDOM()) AS rn 
    FROM book_table INNER JOIN author_table ON book_table.author_id = author_table.id
) AS sq 
WHERE rn <= 5 
```

然后，您可以将其包装在 a`RawQuerySet`中以获取`Book`实例

```
from collections import defaultdict
qs = Book.objects.raw("""The above sql suited for your tables...""")
collection = defaultdict(list)
for obj in qs:
    collection[obj.category_id].append(obj)

categories_w_rand_books = []
for category in c:
    categories_w_rand_books.append((category, collection[category.id])) 
```

您可能不想在没有缓存的情况下直接为每个请求运行此查询。

此外，您的代码最多随机生成 50*5=250`Book`秒，我只是想知道为什么，因为单页看起来太多了。项目是否显示为选项卡或其他内容？也许您可以通过执行 Ajax 来减少 SQL 的数量，或者简化需求？

*更新*

要使用`book.author`w/o 触发多于另一个查询，请尝试`prefetch_related_objects`

```
from django.db.models.query import prefetch_related_objects
qs = list(qs) # have to evaluate at first
prefetch_related_objects(qs, ['author'])
# now instances inside qs already contain cached author instances, and
qs[0].author # will not trigger an extra query 
```

上面的代码批量预取作者并将它们填充到`qs`. 这只是添加了另一个查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:31:10.367

我不确定这是否会对您有所帮助，因为我不知道您的问题的详细信息和上下文，但是使用`order_by('?')`效率非常低，特别是对于某些数据库后端。

为了显示具有一点随机性的实体，我使用这种方法，使用自定义过滤器：

```
@register.filter
def random_iterator(list, k):
    import random
    class MyIterator:
        def __init__(self, obj, order):
            self.obj=obj
            self.cnt=0
            self.order = order

        def __iter__(self):
            return self

        def next(self):
            try:
                result=self.obj.__getitem__(self.order[self.cnt])
                self.cnt+=1
                return result
            except IndexError:
                raise StopIteration

    if list is None:
        list = []
    n = len(list)
    k = min(n, k)
    return MyIterator(list, random.sample(range(n), k)) 
```

我的 Django 视图中的代码是这样的：

```
RAND_BOUND = 50    
categories = Category.objects.filter(......)[RAND_BOUND] 
```

而且，我以这种方式在我的模板中使用它：

```
{% for cat in categories|random_iterator:5 %}
 <li>{{ cat }}</li>             
{% endfor %} 
```

此代码将选择 5 个随机类别的（减少的）集合`RAND_BOUND`。这不是完美的解决方案，但希望它有所帮助。

# java - Android中的循环、文字和图像

> ID：14096881
> 
> 赞同：-2
> 
> 时间：2012-12-31T02:46:03.347
> 
> 标签：java, android, eclipse, android-intent, for-loop

我的问题是：我在 EditText 中输入文本，然后显示每个单独的字母，但可以使用 2 ImageView 显示。我对 ImageView 没有任何问题，问题是当您在 for 中输入单词时，尝试延迟显示第一个字母并继续显示其他字母，但它不起作用，只需将单词的最后一个字母发送给我你输入

编码：

```
public class deletreo extends Activity {

    TextView tv;
    EditText etxt;
    ImageView img,img2;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setContentView(R.layout.deletreo);

        tv = new TextView(this);
        etxt = (EditText)findViewById(R.id.text);
        Button btn = (Button)findViewById(R.id.btn7);

        btn.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

                letra();

            }   
        });

    }//fin bundle

     public void letra()  {

         String t = "";

        t = etxt.getText().toString();
        String l = t.toLowerCase();
        int p = l.length();

            try{
                for( int j = 0 ; j < p ; j++){

                    if(l.charAt(j) == 'a' || l.charAt(j) == 'A'){
                        img = (ImageView)findViewById(R.id.img);
                        img.setImageResource(R.drawable.aa);
                        img2 = (ImageView)findViewById(R.id.img2);
                        img2.setImageResource(R.drawable.image_1);

                    }

                        if(l.charAt(j) == 'b' || l.charAt(j) == 'B'){
                            img = (ImageView)findViewById(R.id.img);
                            img.setImageResource(R.drawable.bb);
                            img2 = (ImageView)findViewById(R.id.img2);
                            img2.setImageResource(R.drawable.image_2);

                        }
                            if(l.charAt(j) == 'c' || l.charAt(j) == 'C'){
                                img = (ImageView)findViewById(R.id.img);
                                img.setImageResource(R.drawable.cc);
                                img2 = (ImageView)findViewById(R.id.img2);
                                img2.setImageResource(R.drawable.image_3);

                            }
                                if(l.charAt(j) == 'd' || l.charAt(j) == 'D'){
                                    img = (ImageView)findViewById(R.id.img);
                                    img.setImageResource(R.drawable.dd);
                                    img2 = (ImageView)findViewById(R.id.img2);
                                    img2.setImageResource(R.drawable.image_4);
                                }
                                    if(t.charAt(j) == 'e' || t.charAt(j) == 'E'){
                                        img = (ImageView)findViewById(R.id.img);
                                        img.setImageResource(R.drawable.ee);
                                        img2 = (ImageView)findViewById(R.id.img2);
                                        img2.setImageResource(R.drawable.image_5);
                                    }
                                        if(t.charAt(j) == 'f' || t.charAt(j) == 'F'){
                                            img = (ImageView)findViewById(R.id.img);
                                            img.setImageResource(R.drawable.ff);
                                            img2 = (ImageView)findViewById(R.id.img2);
                                            img2.setImageResource(R.drawable.image_6);
                                        }
                                            if(t.charAt(j) == 'g' || t.charAt(j) == 'G'){
                                                img = (ImageView)findViewById(R.id.img);
                                                img.setImageResource(R.drawable.gg);
                                                img2 = (ImageView)findViewById(R.id.img2);
                                                img2.setImageResource(R.drawable.image_7);
                                            }
                                                if(t.charAt(j) == 'h' || t.charAt(j) == 'H'){
                                                    img = (ImageView)findViewById(R.id.img);
                                                    img.setImageResource(R.drawable.hh);
                                                    img2 = (ImageView)findViewById(R.id.img2);
                                                    img2.setImageResource(R.drawable.image_8);
                                                }
                                                    if(t.charAt(j) == 'i' || t.charAt(j) == 'I'){
                                                        img = (ImageView)findViewById(R.id.img);
                                                        img.setImageResource(R.drawable.ii);
                                                        img2 = (ImageView)findViewById(R.id.img2);
                                                        img2.setImageResource(R.drawable.image_9);
                                                    }
                                                        if(t.charAt(j) == 'j' || t.charAt(j) == 'J'){
                                                            img = (ImageView)findViewById(R.id.img);
                                                            img.setImageResource(R.drawable.jj);
                                                            img2 = (ImageView)findViewById(R.id.img2);
                                                            img2.setImageResource(R.drawable.image_10);
                                                        }
                                                            if(t.charAt(j) == 'k' || t.charAt(j) == 'K'){
                                                                img = (ImageView)findViewById(R.id.img);
                                                                img.setImageResource(R.drawable.kk);
                                                                img2 = (ImageView)findViewById(R.id.img2);
                                                                img2.setImageResource(R.drawable.image_11);
                                                            }
                                                                if(t.charAt(j) == 'l' || t.charAt(j) == 'L'){
                                                                    img = (ImageView)findViewById(R.id.img);
                                                                    img.setImageResource(R.drawable.ll);
                                                                    img2 = (ImageView)findViewById(R.id.img2);
                                                                    img2.setImageResource(R.drawable.image_12);
                                                                }
                                                                    if(t.charAt(j) == 'm' || t.charAt(j) == 'M'){
                                                                        img = (ImageView)findViewById(R.id.img);
                                                                        img.setImageResource(R.drawable.mm);
                                                                        img2 = (ImageView)findViewById(R.id.img2);
                                                                        img2.setImageResource(R.drawable.image_13);
                                                                    }
                                                                        if(t.charAt(j) == 'n' || t.charAt(j) == 'N'){
                                                                            img = (ImageView)findViewById(R.id.img);
                                                                            img.setImageResource(R.drawable.nn);
                                                                            img2 = (ImageView)findViewById(R.id.img2);
                                                                            img2.setImageResource(R.drawable.image_14);
                                                                        }
                                                                            if(t.charAt(j) == 'ñ' || t.charAt(j) == 'Ñ'){
                                                                                img = (ImageView)findViewById(R.id.img);
                                                                                img.setImageResource(R.drawable.nini);
                                                                                img2 = (ImageView)findViewById(R.id.img2);
                                                                                img2.setImageResource(R.drawable.image_15);
                                                                            }
                                                                                if(t.charAt(j) == 'o' || t.charAt(j) == 'O'){
                                                                                    img = (ImageView)findViewById(R.id.img);
                                                                                    img.setImageResource(R.drawable.oo);
                                                                                    img2 = (ImageView)findViewById(R.id.img2);
                                                                                    img2.setImageResource(R.drawable.image_16);
                                                                                }
                                                                                    if(t.charAt(j) == 'p' || t.charAt(j) == 'P'){
                                                                                        img = (ImageView)findViewById(R.id.img);
                                                                                        img.setImageResource(R.drawable.pp);
                                                                                        img2 = (ImageView)findViewById(R.id.img2);
                                                                                        img2.setImageResource(R.drawable.image_17);
                                                                                    }
                                                                                        if(t.charAt(j) == 'q' || t.charAt(j) == 'Q'){
                                                                                            img = (ImageView)findViewById(R.id.img);
                                                                                            img.setImageResource(R.drawable.qq);
                                                                                            img2 = (ImageView)findViewById(R.id.img2);
                                                                                            img2.setImageResource(R.drawable.image_18);
                                                                                        }
                                                                                            if(t.charAt(j) == 'r' || t.charAt(j) == 'R'){
                                                                                                img = (ImageView)findViewById(R.id.img);
                                                                                                img.setImageResource(R.drawable.rr);
                                                                                                img2 = (ImageView)findViewById(R.id.img2);
                                                                                                img2.setImageResource(R.drawable.image_19);
                                                                                            }
                                                                                                if(t.charAt(j) == 's' || t.charAt(j) == 'S'){
                                                                                                    img = (ImageView)findViewById(R.id.img);
                                                                                                    img.setImageResource(R.drawable.ss);
                                                                                                    img2 = (ImageView)findViewById(R.id.img2);
                                                                                                    img2.setImageResource(R.drawable.image_20);
                                                                                                }
                                                                                                    if(t.charAt(j) == 't' || t.charAt(j) == 'T'){
                                                                                                        img = (ImageView)findViewById(R.id.img);
                                                                                                        img.setImageResource(R.drawable.tt);
                                                                                                        img2 = (ImageView)findViewById(R.id.img2);
                                                                                                        img2.setImageResource(R.drawable.image_21);
                                                                                                    }
                                                                                                        if(t.charAt(j) == 'u' || t.charAt(j) == 'U'){
                                                                                                            img = (ImageView)findViewById(R.id.img);
                                                                                                            img.setImageResource(R.drawable.uu);
                                                                                                            img2 = (ImageView)findViewById(R.id.img2);
                                                                                                            img2.setImageResource(R.drawable.image_22);
                                                                                                        }
                                                                                                            if(t.charAt(j) == 'v' || t.charAt(j) == 'V'){
                                                                                                                img = (ImageView)findViewById(R.id.img);
                                                                                                                img.setImageResource(R.drawable.vv);
                                                                                                                img2 = (ImageView)findViewById(R.id.img2);
                                                                                                                img2.setImageResource(R.drawable.image_23);
                                                                                                            }
                                                                                                                if(t.charAt(j) == 'w' || t.charAt(j) == 'W'){
                                                                                                                    img = (ImageView)findViewById(R.id.img);
                                                                                                                    img.setImageResource(R.drawable.ww);
                                                                                                                    img2 = (ImageView)findViewById(R.id.img2);
                                                                                                                    img2.setImageResource(R.drawable.image_24);
                                                                                                                }
                                                                                                                    if(t.charAt(j) == 'x' || t.charAt(j) == 'X'){
                                                                                                                        img = (ImageView)findViewById(R.id.img);
                                                                                                                        img.setImageResource(R.drawable.xx);
                                                                                                                        img2 = (ImageView)findViewById(R.id.img2);
                                                                                                                        img2.setImageResource(R.drawable.image_25);
                                                                                                                    }
                                                                                                                        if(t.charAt(j) == 'y' || t.charAt(j) == 'Y'){
                                                                                                                            img = (ImageView)findViewById(R.id.img);
                                                                                                                            img.setImageResource(R.drawable.yy);
                                                                                                                            img2 = (ImageView)findViewById(R.id.img2);
                                                                                                                            img2.setImageResource(R.drawable.image_26);
                                                                                                                        }
                                                                                                                            if(t.charAt(j) == 'z' || t.charAt(j) == 'Z'){
                                                                                                                                img = (ImageView)findViewById(R.id.img);
                                                                                                                                img.setImageResource(R.drawable.zz);
                                                                                                                                img2 = (ImageView)findViewById(R.id.img2);
                                                                                                                                img2.setImageResource(R.drawable.image_27);

                                                                                                                            }

                            Thread.sleep(2000);                                                                                                                                                                                                 
                }//fin del for

            }//fin try

            catch (InterruptedException e) {
                e.printStackTrace();
            }
            finally{}

     }//fin letra();

}//fin 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:03:44.760

`for`在您调用的循环底部：

```
Thread.sleep(2000); 
```

这只会阻塞 UI 线程 2 秒。由于 UI 线程基本上是应用程序的生命线，因此上述语句将停止*所有*代码的执行。如果您阻塞主线程，则循环外的代码无法神奇地继续运行，这就是为什么您的 UI 在每次迭代后都不会更新的原因。

与其直接与线程交互，不如将延迟发布`Runnable`到 a`Handler`或使用其他一些模拟“滴答声”的机制（例如`Timer`，`TimerTask`并`CountDownTimer`想到）可能更容易。对于每个刻度，您可以显示下一个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T03:01:08.653

您将要将此操作放在单独的线程中，然后使用 a`Handler`暂停和恢复您刚刚创建的新线程。这样做是为了不冻结主 UI 线程，这是 Android 上默认运行的东西。

我在谷歌上搜索了“android add delay inbetween changes”并得到了一堆结果，其中一个是：[Add a delay to Progress Dialog](https://stackoverflow.com/questions/4209270/add-a-delay-to-progress-dialog)

此外，使用`switch`语句而不是巨大的级联`if/else`语句。它会让你的代码变得更干净、更高效。

# tcl - 注释语法历史

> ID：14096885
> 
> 赞同：1
> 
> 时间：2012-12-31T02:46:56.313
> 
> 标签：tcl

在早期的 Tcl 版本中，注释命令`#anything`（所以你可以这样做...

```
% # {
  comment
} 
```

...但不是这个：

```
% # remember to initialize $width here
can't read "width": no such variable
% # a comment [with brackets] here
invalid command name "with" 
```

它在哪个版本中更改为完全忽略 # 字符之后到行尾的所有内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T03:11:56.390

sourceforge 上最早发布的 Tcl 版本是[2.1](http://sourceforge.net/projects/tcl/files/Tcl/Tcl%202.1/)。从该 tarball 中的联机帮助页：

> ### 注释
> 
> 如果命令中的第一个非空白字符是`#`，则从上到下`#`一个换行符的所有内容都被视为注释并被忽略。

所以; 不，出于所有实际目的，注释一直是特殊语法，而不是常规的 tcl 命令。

**编辑，**重新评论一些评论（元评论？）

*注释不是*常规命令的原因之一是，当您*不*希望花括号匹配时，它为匹配花括号提供了一种简单的方法。假设您想编写一个打印单个右括号的 proc。

```
proc writeBrace {} {
    puts "}"
} 
```

不幸的是，大括号不再匹配，tcl 将其视为 proc 的主体`puts "`，因为这就是左大括号和*匹配*的右大括号之间的内容。修复很简单：

```
proc writeBrace {} {
    # match the brace below: {
    puts "}"
} 
```

现在，打开和关闭大括号的数量在 proc 主体中匹配。请记住，在tcl 尝试解析 proc 主体*之前*匹配大括号，在参数解析期间它只是一个字符串，而不是 tcl 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T04:10:23.847

规则并没有说明 # 之后的每个字符都被忽略，它比这更棘手。

Tcl'ers wiki 上的这个页面深入解释了注释语法的缺陷，所以我不会在这里重复所有这些： [http ://wiki.tcl.tk/462](http://wiki.tcl.tk/462)

基本上它是一个评估问题的顺序，大括号首先用于分组，然后再查看命令。

# python - 简单的 Python 列表连接

> ID：14096887
> 
> 赞同：0
> 
> 时间：2012-12-31T02:47:09.603
> 
> 标签：python

我有一个字符串列表，每个字符串作为一个字符。它们是按单词顺序排列的。如何将每个字符放在一个字符串中。例子：

```
list_characters = ['H', 'e', 'l', 'l', 'o'] 
```

成为：

```
'Hello' 
```

请帮忙，谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-31T02:48:08.127

```
In [1]: s = ['H', 'e', 'l', 'l', 'o']

In [2]: ''.join(s)
Out[2]: 'Hello' 
```

该`join`方法与您可能熟悉的其他方法有些不同，因为您首先将要使用的元素“连接”在一起，然后在其上调用该方法。以下是更多示例：

```
In [4]: print '\n'.join(s)
H
e
l
l
o

In [5]: ' '.join(s)
Out[5]: 'H e l l o'

In [6]: 'GOODBYE'.join(s)
Out[6]: 'HGOODBYEeGOODBYElGOODBYElGOODBYEo' 
```

该`join`方法接受任何“可迭代”，这是您可以“迭代”的任何内容（例如列表，如您的示例中所示）。字符串本身也是可迭代的，所以你甚至可以这样做：

```
In [7]: s = 'Hello'

In [8]: 'Z'.join(s)
Out[8]: 'HZeZlZlZo' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T03:50:02.990

虽然我强烈推荐上面 RocketDonkey 提到的 join() 方法，但另一种方法是：

```
reduce(lambda acc,x:acc+x,['H', 'e', 'l', 'l', 'o']) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T03:21:30.080

您需要使用`join()`将列表的所有元素连接成这样的字符串：

```
test = ['H', 'e', 'l' 'l', 'o']
''.join(test) 
```

如果您想在它们之间加入“-”字符，请使用以下命令：

```
 test = ['H', 'e', 'l' 'l', 'o']
   '-'.join(test) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-21T23:26:31.210

您可以通过各种方法将列表的元素连接成一个字符串：

1.  通过遍历列表

```
str=""
for i in list:
    str+=i
print(str)      #hello 
```

2.  使用内置函数“join()”

```
list = ['h', 'e', 'l', 'l', 'o']
str=""
print("".join(list))       #hello 
```

3.  使用列表理解

```
str = "".join([str(elem) for elem in list]) 
print(str)       #hello 
```

4.  使用 map() 函数

```
str = ''.join(map(str, list)) 
print(str)       #hello 
```

#注意：如果您也有 int 元素，可以使用最后两种方法，因为 Python 不允许连接具有不同数据类型的元素。

# iphone - 选择 tabbaritem 时重置为第一个视图控制器

> ID：14096889
> 
> 赞同：4
> 
> 时间：2012-12-31T02:47:19.837
> 
> 标签：iphone

我有一个包含 3 个项目的标签栏。每个指向一个`UINavigationController`. 每个下面`UINavigationController`都有几个`viewControllers`。当按下任何标签栏项目时，我想重置回导航中的第一个控制器。

我已将我的`TabBarController`实现指定为`delegate`

`self.delegate = self`和我下面的方法（在我的`TabBarController`实现中运行返回`UINavigationControllers`.

```
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController
{
    NSLog(@"%@", viewController);
} 
```

日志文件显示例如

```
UINavigationController: 0x8a31a90>2012-12-31 02:16:40.035 Demo[6142:c07] 
```

当我尝试`popToRootViewController`或`popViewController`使用此方法时，它似乎不起作用。我没有收到任何错误，但我`viewControllers`没有重置。似乎我在这里犯了一个非常基本的错误，但我不知道是什么。

```
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController
{
    NSLog(@"%@", viewController);
    [self.navigationController  popToRootViewControllerAnimated:YES];
    [[self navigationController] popViewControllerAnimated:YES];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T03:21:24.023

您需要在 navigationController (viewcontroller) 上 popToRootViewController - 而不是 TabViewController (self)。

```
[viewController  popToRootViewControllerAnimated:YES]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-26T06:05:01.893

我不确定这是否会有所帮助。我在让它工作时遇到了很多麻烦，发现我需要执行以下操作：

在根视图控制器（第一个视图应用程序）中，在 .h 文件中添加一个委托。

```
@interface MGMProductsViewController : UIViewController <UITabBarControllerDelegate> 
```

将以下代码添加到根视图控制器（.m 文件）中的 viewDidLoad 中。

```
[self.tabBarController setDelegate:self]; 
```

使用以下内容覆盖根视图控制器（.m 文件）中的方法。

```
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController  
{  
    if ([viewController isKindOfClass:[UINavigationController class]])
    {
        [(UINavigationController*)viewController popToRootViewControllerAnimated:NO];
    }
} 
```

我不能将其归因于任何人，因为我再也找不到合适的代码了。我想我是从几个地方拼凑起来的，尽管 '[self.tabBarController setDelegate:self]' 看起来是它为我工作的关键。

祝你好运。

# cocoa - 如何使 NSURL 指向本地目录？

> ID：14096893
> 
> 赞同：1
> 
> 时间：2012-12-31T02:48:02.423
> 
> 标签：cocoa, nsurlconnection, nsurlprotocol

今天阅读 Adium 代码，发现了一个有趣的 NSURL 用法：

```
NSURL *baseURL = [NSURL URLWithString:[NSString stringWithFormat:@"adium://%@/adium", [messageStyle.bundle bundleIdentifier]]];
[[webView mainFrame] loadHTMLString:[messageStyle baseTemplateForChat:chat] baseURL:baseURL]; 
```

我试图记录 url 并得到这个*adium://im.adium.Smooth Operator.style/adium*，然后我创建了一个空白项目来查看如何创建这样的 NSURL 但失败了。当我向项目中的 webview 框架发送 loadHTMLString 消息时，如果 baseURL 为 nil，一切都很好，如果不是，我在视图中得到一个空白页面。

这是我的代码，项目名称是 webkit

```
NSURL *baseURL = [NSURL URLWithString:@"webkit://resource"];
//if baseURL is nil or [[NSBundle mainBundle] bundleURL], everything is fine
[[webView mainFrame] loadHTMLString:@"<html><head></head><body><div>helloworld</div></body></html>" 
                     baseURL: baseURL];
[frameView setDocumentView:webView];
[[frameView documentView] setFrame:[frameView visibleRect]]; 
```

问题是如何制作自定义协议而不是 http://？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T06:59:12.817

**adium://%@/adium**，第一部分称为协议，您也可以注册您的协议 webkit：看看[如何将自定义协议映射到 Mac 上的应用程序？](https://stackoverflow.com/questions/471581/how-to-map-a-custom-protocol-to-an-application-on-the-mac)和[从网页链接启动脚本](http://www.macosxautomation.com/applescript/linktrigger/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T11:39:35.580

```
[NSURLProtocol registerClass:[AIAdiumURLProtocol class]];
[ESWebView registerURLSchemeAsLocal:@"adium"]; 
```

我试图找到 adium 在 info.plist 中定义 adium 模式的位置，不幸的是，那里什么都没有，只有一些 irc/xmpp 协议。

于是我终于启动了调试器，在AIWebKitDelegate的init方法中找到了上面的代码，反正这是另一种注册自定义协议的方式~

# jquery - jquery - 如何选择特定的表行

> ID：14096894
> 
> 赞同：0
> 
> 时间：2012-12-31T02:48:05.037
> 
> 标签：jquery, tablerow

我有个问题。我可以动态创建多行。每行有 2 个`<td>`。每个`<td>`都有类，`tdDebit`并且`tdCredit`.

```
<table id="tblAcctForm">
 <tr>
  <td class="tdDebit"><input type="text" /></td>
  <td class="tdCredit"><input type="text" /></td>
 </tr>
</table> 
```

我想要发生的是，当我在一个`<td>`类中输入一个输入时，`tdDebit`或者`tdCredit`同一行上的另一个输入将被禁用。发生的情况是，当我在`<td>`with 类中的输入上键入某些内容`tdDebit`或`tdCredit`所有输入都被禁用时。我只想要在我输入的同一行上输入。

```
$(document).ready(function () {
  $("tr .tdDebit input").live("keyup", function()  {
    checkContent(this, "tr .tdCredit input");
  });

  $("tr .tdCredit input").live("keyup", function()  {
    checkContent(this, "tr .tdDebit input");
  });
});

function checkContent (activeElem, otherElem) {
  if ($.trim($(activeElem).val()) != "")
    $(otherElem).attr("disabled", "disabled");
   else
    $(otherElem).removeAttr("disabled");
} 
```

请在此处查看我的工作代码：http: [//jsfiddle.net/pcmwg/](http://jsfiddle.net/pcmwg/)

PS：在测试之前创建多行。

请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:58:31.073

您传递给`otherElem`参数的值过于笼统：它选择页面上所有 tr 中所有 .tdDebit/.tdCredit 中的所有输入。

相反，将相对于输入元素的直接值传递给它：

```
$(document).ready(function () {
  $("tr .tdDebit input").live("keyup", function()  {
    var toDisable = $(this).closest('tr').find('.tdCredit input');
    checkContent(this, toDisable);
  });

  $("tr .tdCredit input").live("keyup", function()  {
    var toDisable = $(this).closest('tr').find('.tdDebit input');
    checkContent(this, toDisable);
  });
}); 
```

更好的是，让它更通用：

```
$(document).ready(function () {
    $("tr input").live("keyup", function()  {
    var toDisable = $(this).closest('tr').find('input').not(this);
    checkContent(this, toDisable);
  });
}); 
```

[http://jsfiddle.net/7jdfM/1/](http://jsfiddle.net/7jdfM/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T02:58:54.897

```
checkContent(this, $(this).siblings(".tdCredit input"));
checkContent(this, $(this).siblings(".tdDebit input")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T03:06:08.367

这样就可以了..不再需要第二个参数

```
function checkContent (activeElem, otherElem) {
    var $input=$(activeElem), $otherInput=$input.parent().next().find('input');
        if ($.trim($input.val()) != "")
            $otherInput.attr("disabled", "disabled");
        else
           $otherInput.removeAttr("disabled");
} 
```

演示：http://jsfiddle.net/pcmwg/1/

# ruby-on-rails - 迭代模型属性并检查错误消息

> ID：14096896
> 
> 赞同：3
> 
> 时间：2012-12-31T02:48:22.463
> 
> 标签：ruby-on-rails, ruby, rspec, attributes, bdd

我正在尝试迭代一个对象并在使用 rspec 进行测试时更改其属性。这个想法是测试字符串是否太长（最多 255 个字符）。由于有这么多，我想避免重复代码并迭代对象的属性。

由于[这个问题](https://stackoverflow.com/questions/3669801/dry-way-to-assign-hash-values-to-an-object)，我提出了以下几点：

```
[ :city, :email, :first_name, :last_name, :office_name, :street ].each do |attr|
    c.send("#{attr}=", long_string)
    c.errors[attr].should include "is too long (maximum is 255 characters)"
end 
```

但是，控制台说

```
expected [] to include "is too long (maximum is 255 characters)" 
```

long_string 实际上是 1000 个字符长，所以这不是问题。在相应的模型中，我已经确保上述每个属性的最大长度为 255。我不确定我在分配时是否做错了，或者是否是测试不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:53:38.987

挤在`c.valid?`你的`c.send`和`c.errors`陈述之间。

即*在*访问之前`c.errors`

`errors`在您的模型得到验证之前，该数组为空。通过检查`valid?`或尝试保存它。

[您可以在Validations Rails Guide](http://guides.rubyonrails.org/active_record_validations_callbacks.html#valid-and-invalid)中找到有关`errors`数组和验证的更多信息

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T02:53:42.173

我相信，如果您使用`ActiveRecord`的`errors`是在触发验证之前不会被填充。

```
[ :city, :email, :first_name, :last_name, :office_name, :street ].each do |attr|
    c.send("#{attr}=", long_string)
    c.valid? # Run validations by asking is the record is valid
    c.errors[attr].should include "is too long (maximum is 255 characters)"
end 
```

# php - 使用 PDO 进行多条件查询

> ID：14096898
> 
> 赞同：1
> 
> 时间：2012-12-31T02:49:10.760
> 
> 标签：php, pdo

[我在http://codereview.stackexchange.com](http://codereview.stackexchange.com)上问了这个问题，他们想让我把它贴在这里。我根本无法让这段代码工作。我从常规 mysql 切换到更安全的 pdo。有人可以告诉我我在这里缺少什么。我已经为此苦苦挣扎了几天，当我第一次搜索这个网站时，我可以找到确切的答案。

```
 $input = $_POST['input'];
 $categories = $_POST['category'];
 $state = $_POST['state'];
 $zipcode = $_POST['zipcode']; 

$qq = $db->prepare(" SELECT * FROM classified  ")or die(print_r($qq->errorInfo(), true));
    /*** execute the prepared statement ***/
    $qq->execute();

    /*** echo number of columns ***/
    $rows = $qq->fetch(PDO::FETCH_NUM);
    if ($rows>0){
      $query = (" SELECT * FROM classified ");
   $cond = array();
   $params = array();

   if (!empty($input)) {
   $cond[] = "title = ?";
       $params[] = $input;
    }

   if (!empty($categories)) {
    $cond[] = "id_cat = ?";
    $params[] = $categories;
     }

    if (!empty($state)) {
    $cond[] = "id_state = ?";
    $params[] = $state;
    }    

   if (!empty($zipcode)) {
     $cond[] = "zipcode = ?";
     $params[] = $zipcode;
   }

  if (count($cond)) {
  $query .= ' WHERE  ' . implode(' AND ', $cond)or 
  die(print_r($query->errorInfo(),true));
 }

$stmt = $db->prepare($query);
 $stmt->execute($params);
 $ro = $stmt->fetch(PDO::FETCH_NUM);
   }
     if ($ro > 0) {
  foreach ($stmt->fetchAll(PDO::FETCH_ASSOC) as $row) 
   {
     echo  $row['title'];
   echo  $row['categories'];
   echo  $row['state'];
   echo  $row['zipcode'];
  }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:39:07.170

I think it's a good idea to post an answer here rather than posting a link. I'm sure it will be useful for some people.

```
 $input = $_POST['input'];
    $categories = $_POST['category'];
    $state = $_POST['state'];
    $zipcode = $_POST['zipcode'];

    $qq = $db->prepare(" SELECT * FROM classified  ")or die(print_r($qq->errorInfo(),
    true));
    /*** execute the prepared statement ***/
    $qq->execute();

/*** echo number of columns ***/
$rows = $qq->fetch(PDO::FETCH_NUM);
if ($rows>0){

 $query = " SELECT * FROM classified where confirm='0' ";  
 if(!empty( $_POST['input'])) {

 $query .= "AND title LIKE '%".$input."%' ";
 }

if (!empty($_POST['category']) )
   {
  $query .= "AND id_cat = ".$categories." ";

 }

  if (!empty($_POST['state']) )
  {
  $query .= "AND id_state = ".$state." ";

  }

  if(!empty($_POST['zipcode'])) {

  $query .= "AND zipcode = ".$zipcode." ";
  }
   $query .= "ORDER BY date ";

    }

   $stmt = $db->prepare($query);
  $stmt->execute($params);
   $result = $stmt->fetchAll();
 //  $ro = $stmt->fetch(PDO::FETCH_NUM);

  // it didn't work when I tried to count rows
 if ($result > 0) {
foreach ($result as $row)
 {
 echo  $row['title'];
 echo  $row['categories'];
 echo  $row['state'];
 echo  $row['zipcode'];
 }
 }else{
 echo " No data available";
   } 
```

# javascript - 平滑滚动插件在 Chrome 中不起作用

> ID：14096904
> 
> 赞同：1
> 
> 时间：2012-12-31T02:51:28.043
> 
> 标签：javascript, jquery, google-chrome, scroll, smooth

所以我已经完成了我的网站，并且刚刚发现我使用的平滑滚动 JS 在 Chrome 中不起作用。它在 Safari、Firefox 和我尝试过其他人时完美运行，但我似乎无法让他们识别我的锚点，或保持突出显示的导航。

这是我的导航：

```
<ul id="menu"><!-- BEGIN MENU -->
    <li><img class="valigner"><a href="#home">home</a></li>
    <li><img class="valigner"><a href="#about">about</a></li>
    <li><img class="valigner"><a href="#headshots">headshots</a></li>
    <li><img class="valigner"><a href="#fashion">fashion</a></li>
    <li><img class="valigner"><a href="#editorial">editorial</a></li>
    <li><a href="#home"><img src="img/logo.jpg" class="logo"/></a></li>
    <li><img class="valigner"><a href="#live">live</a></li>
    <li><img class="valigner"><a href="#events">events</a></li>
    <li><img class="valigner"><a href="#outside">outside</a></li>
    <li><img class="valigner"><a href="#product">product</a></li>
    <li><img class="valigner"><a href="#contact">contact</a></li>
</ul><!-- END MENU --> 
```

这是JS：

```
;(function( $ ){

var $scrollTo = $.scrollTo = function( target, duration, settings ){
    $(window).scrollTo( target, duration, settings );
};

$scrollTo.defaults = {
    axis:'xy',
    duration: parseFloat($.fn.jquery) >= 1.3 ? 0 : 1
};

// Returns the element that needs to be animated to scroll the window.
// Kept for backwards compatibility (specially for localScroll & serialScroll)
$scrollTo.window = function( scope ){
    return $(window)._scrollable();
};

// Hack, hack, hack :)
// Returns the real elements to scroll (supports window/iframes, documents and regular nodes)
$.fn._scrollable = function(){
    return this.map(function(){
        var elem = this,
            isWin = !elem.nodeName || $.inArray( elem.nodeName.toLowerCase(), ['iframe','#document','html','body'] ) != -1;

            if( !isWin )
                return elem;

        var doc = (elem.contentWindow || elem).document || elem.ownerDocument || elem;

        return $.browser.safari || doc.compatMode == 'BackCompat' ?
            doc.body : 
            doc.documentElement;
    });
};

$.fn.scrollTo = function( target, duration, settings ){
    if( typeof duration == 'object' ){
        settings = duration;
        duration = 0;
    }
    if( typeof settings == 'function' )
        settings = { onAfter:settings };

    if( target == 'max' )
        target = 9e9;

    settings = $.extend( {}, $scrollTo.defaults, settings );
    // Speed is still recognized for backwards compatibility
    duration = duration || settings.speed || settings.duration;
    // Make sure the settings are given right
    settings.queue = settings.queue && settings.axis.length > 1;

    if( settings.queue )
        // Let's keep the overall duration
        duration /= 60000;
    settings.offset = both( settings.offset );
    settings.over = both( settings.over );

    return this._scrollable().each(function(){
        var elem = this,
            $elem = $(elem),
            targ = target, toff, attr = {},
            win = $elem.is('html,body');

        switch( typeof targ ){
            // A number will pass the regex
            case 'number':
            case 'string':
                if( /^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(targ) ){
                    targ = both( targ );
                    // We are done
                    break;
                }
                // Relative selector, no break!
                targ = $(targ,this);
            case 'object':
                // DOMElement / jQuery
                if( targ.is || targ.style )
                    // Get the real position of the target 
                    toff = (targ = $(targ)).offset();
        }
        $.each( settings.axis.split(''), function( i, axis ){
            var Pos = axis == 'x' ? 'Left' : 'Top',
                pos = Pos.toLowerCase(),
                key = 'scroll' + Pos,
                old = elem[key],
                max = $scrollTo.max(elem, axis);

            if( toff ){// jQuery / DOMElement
                attr[key] = toff[pos] + ( win ? 0 : old - $elem.offset()[pos] );

                // If it's a dom element, reduce the margin
                if( settings.margin ){
                    attr[key] -= parseInt(targ.css('margin'+Pos)) || 0;
                    attr[key] -= parseInt(targ.css('border'+Pos+'Width')) || 0;
                }

                attr[key] += settings.offset[pos] || 0;

                if( settings.over[pos] )
                    // Scroll to a fraction of its width/height
                    attr[key] += targ[axis=='x'?'width':'height']() * settings.over[pos];
            }else{ 
                var val = targ[pos];
                // Handle percentage values
                attr[key] = val.slice && val.slice(-1) == '%' ? 
                    parseFloat(val) / 100 * max
                    : val;
            }

            // Number or 'number'
            if( /^\d+$/.test(attr[key]) )
                // Check the limits
                attr[key] = attr[key] <= 0 ? 0 : Math.min( attr[key], max );

            // Queueing axes
            if( !i && settings.queue ){
                // Don't waste time animating, if there's no need.
                if( old != attr[key] )
                    // Intermediate animation
                    animate( settings.onAfterFirst );
                // Don't animate this axis again in the next iteration.
                delete attr[key];
            }
        });

        animate( settings.onAfter );            

        function animate( callback ){
            $elem.animate( attr, duration, settings.easing, callback && function(){
                callback.call(this, target, settings);
            });
        };

    }).end();
};

// Max scrolling position, works on quirks mode
// It only fails (not too badly) on IE, quirks mode.
$scrollTo.max = function( elem, axis ){
    var Dim = axis == 'x' ? 'Width' : 'Height',
        scroll = 'scroll'+Dim;

    if( !$(elem).is('html,body') )
        return elem[scroll] - $(elem)[Dim.toLowerCase()]();

    var size = 'client' + Dim,
        html = elem.ownerDocument.documentElement,
        body = elem.ownerDocument.body;

    return Math.max( html[scroll], body[scroll] ) 
         - Math.min( html[size]  , body[size]   );

};

function both( val ){
    return typeof val == 'object' ? val : { top:val, left:val };
};

})( jQuery ); 
```

我相信它来自 Ariel Flesler，但他的演示页面和文档让我更加困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T10:50:17.403

这适用于所有浏览器，

```
$(document).ready(function () {
        //run once
        var el = $('#Container');
        var originalelpos = el.offset().top; // take it where it originally is on the page

        //run on scroll
        $(window).scroll(function () {
            var el = $('#Container'); // important! (local)
            var elpos = el.offset().top; // take current situation
            var windowpos = $(window).scrollTop();
            var finaldestination = windowpos + originalelpos;
            el.css('top', finaldestination);
            //el.stop().animate({ 'top': finaldestination }, 1000);
        });

    }); 
```

我希望这会有所帮助，您可以使用 animate 进行动画制作或使用 .css 更改样式的顶部属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T22:04:46.923

这更简洁一点：

```
$(document).ready(function() {
    $('#menu a').bind("click", function(e) {
        var target = $(this).attr("href"); // Get the target element
        var scrollToPosition = $(target).offset().top; // Position to scroll to
        $('html /* For FF & IE */,body /* For Chrome */').animate({
            'scrollTop': scrollToPosition 
        }, 500, function(target){
            window.location.hash = target;
        });
        e.preventDefault();
    });
}); 
```

[在行动中看到它！](http://jsfiddle.net/trojansdestroy/gQDsC/)

# c# - 图片上传和图片滑块

> ID：14096905
> 
> 赞同：4
> 
> 时间：2012-12-31T02:51:30.103
> 
> 标签：c#, wpf, wpf-controls

*   在我的 C# WPF windows 应用程序中，我想在 web 应用程序中创建一个类似于 File-Upload 的控件......当然 windows 应用程序中不会有服务器来保存上传的图像
*   我使用了文本框和 2 个按钮（浏览）和（上传）：
    *   我想当我按下（浏览）按钮时...打开文件对话框以在我的计算机中搜索我的图像
    *   当我选择图像时......它的路径出现在文本框中
    *   当我按下（上传）按钮时..图像保存在我的数据库中并显示在图像滑块中
*   我还问如何制作那个图像滑块
*   如果我在同一个窗口中有 3 个上传控件，但每个都与某些内容相关.. 并且 3 个上传控件上传的所有图像都显示在图像滑块中.. 当我尝试预览时，我可以将每个图像与其自己的内容链接吗？我的工作总结？？
*   注意：我在这里寻找了许多与我想要的相关的问题..但是没有正确代码的明确答案..所以我希望你能帮助我..谢谢

![在此处输入图像描述](../Images/6acdbe1327260da066cbaf74bd548f2f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T10:20:16.690

首先，当对象包含图像路径和摘要时，您需要一个绑定到对象列表的水平 ListView。

你可以从这里得到方向：

[wpf-bind-images-horizo​​ntally-to-listview](https://stackoverflow.com/questions/10457872/wpf-bind-images-horizontally-to-listview)

每当您单击上传按钮时，您只需将具有所选路径的新对象添加到有界列表即可。

关于两个箭头按钮 - 你必须看看如何更改 listview 水平滚动条控件模板。

[样式化-A-ScrollViewer-Scrollbar-In-WPF](http://www.codeproject.com/Articles/37366/Styling-A-ScrollViewer-Scrollbar-In-WPF)

# grails - Geb + Cucumber：在场景之间重启浏览器

> ID：14096907
> 
> 赞同：1
> 
> 时间：2012-12-31T02:51:34.220
> 
> 标签：grails, cucumber, geb, cucumber-jvm

我将 Grails 2.1.1 与 Cucumber 和 Geb 一起使用。我有一个包含 2 个场景的 Auth.feature。一种用于成功验证，另一种用于测试无效凭据。

我认为我必须解决这个问题的方法是让 geb 从第一个场景中注销用户，然后它才能运行第二个场景。这是因为我的 Given 步骤检查以确保我在登录页面。场景 1 执行后，我在仪表板页面上。

我想我的问题是（a）在完成场景之前使用 geb 注销有效用户还是（b）有没有办法让它在场景之间重新开始？

现在，我已经实现了 (a) 并且它工作得很好。只是想知道这是否是最佳的。

这是我的功能

```
Feature: login to system
  As a user of the system
  I want to log in to the application
  so that I can use it

  Scenario: login
    Given I access the login page
    When I enter valid credentials
    Then I see the dashboard

  Scenario: auth fail
    Given I access the login page
    When I enter invalid credentials
    Then I see appropriate error messages 
```

这是我的 Geb 步骤

```
Given(~'^I access the login page$') {->
  to LoginPage
  at LoginPage
}

When(~'^I enter valid credentials$') {
  page.add('user_10001@test.com', '10001')
}

Then(~'^I see the dashboard$') {->
  at DashboardPage
}

Then(~'^I see an error message on the login page$') { ->
  at LoginPage
}

When(~'^I enter invalid credentials$') { ->
  page.add('baduser', 'paddpassword')
}

Then(~'^I see appropriate error messages$') { ->
  at LoginPage
  // check for error message
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:00:31.917

根据我所做的更多研究，看起来有几种方法可以处理这个问题：

*   就像我已经在做一样，通过在场景结束时注销（或者你可以在开始时这样做）
*   注销自己的场景
*   在 env.groovy 钩子之前，添加`to LogoutPage`
*   使用背景注销

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T10:59:31.483

将以下行添加到 env.groovy 中的 After 挂钩：

```
bindingUpdater.browser.clearCookies() 
```

# java - Java + GTK 你好世界

> ID：14096909
> 
> 赞同：-1
> 
> 时间：2012-12-31T02:52:03.553
> 
> 标签：java, gtk

任何人都可以用 java 和 gtk 给出一个简单的 hello world 示例，我所知道的就是如何将 swing 工具包与 awt 一起使用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T03:09:08.360

来自[http://www.linuxjournal.com/article/8111?page=0,1](http://www.linuxjournal.com/article/8111?page=0,1)

```
public class ExampleGNOME {
 private LibGlade libglade;
 private static final String GLADE_FILE =
                               "ExampleGNOME.glade";

 public ExampleGNOME () throws IOException {
  libglade = new LibGlade(GLADE_FILE, this);
 }

 public void on_noButton_released(GtkEvent event) {
  Gtk.mainQuit();
  System.exit(1);
 }

 public void on_yesButton_released(GtkEvent event) {
  Gtk.mainQuit();
  System.exit(0);
 }

 public static void main(String args[]) {
  ExampleGNOME gui;

  Gtk.init(args);
  try {
   gui = new ExampleGNOME();
  } catch (IOException e) {
   System.err.println(e);
   System.exit(1);
  }
 Gtk.main();
 }
} 
```

# ruby - Ruby 代码不起作用。Ruby 无法读取我的代码。

> ID：14096910
> 
> 赞同：-5
> 
> 时间：2012-12-31T02:52:11.277
> 
> 标签：ruby, syntax, syntax-error

每次我在 Ruby 上打开它时，Ruby 几乎都会立即关闭，因为它无法读取代码中的某些内容。所以代码中有一个错误，但我查看了所有内容，但似乎找不到它。我需要一些帮助才能使此代码正常工作。非常感谢您！

```
Time.now=apply_time
if apply_time.month <=3
price=45 
elsif apply_time.month <=5
price=55 
elsif apply_time.month <=7
price=65 
else 
price=0 
end
puts 'The fee to apply for the competition is $ ' + price.to_s + '.00 when you apply on the date of today, ' + Time.now.to_s +'.'
puts 'If your fee came up as $0.00, then that is because the competition has ended. But do not worry, there is always next year!'
Sleep 20 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:56:27.403

您的第一行正在尝试分配`apply_time`给`Time.now`

反过来试试：

```
apply_time = Time.now 
```

顺便说一句，如果你从 irb 运行它，你会看到错误：

```
NameError: undefined local variable or method `apply_time' for main:Object 
```

但即使你提前定义了 apply_time，你也会得到：

```
NoMethodError: undefined method `now=' for Time:Class 
```

因为你不能在不破坏 Time 类的情况下为当前时间赋值。

# javascript - javascript IDE 或 Visual Studio 替代品可保持编码体验和质量

> ID：14096915
> 
> 赞同：2
> 
> 时间：2012-12-31T02:52:59.687
> 
> 标签：javascript

我是 asp.net 的初学者，在这个阶段，我的大部分方法/实现越来越多地转向使用`javascript`和`jQuery`......`ajax`所有这些 J 的家庭成员，而不是编码服务器端 C#（我真的很喜欢工作和）

正如我最近了解到的那样，如果您不经常使用 JavaScript，那么在您的应用程序中，这意味着您并没有真正构建应用程序（Web）..至少不是一个好的应用程序，因为客户端编码有一种简单的方式来做几乎迷人的事情我以前用 c# 做的每一件事。它从整**页回**发问题开始，我学会了如何通过使用来避免`$ajax`，然后了解了 jQuery +jQueryUI ...等

`IDE`我的问题是，除了使用 Notepad++（在我询问该问题时在聊天中提到）之外，我还可以使用什么来替代 Vs，这是一种合适的或开发应用程序的方法，但是`IDE`，这将更好地关注例如，像 Css 这样的 javascript`ExpressionWeb` 做得更好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T03:05:21.020

如果您愿意为商业 IDE 付费，我会选择[WebStorm](http://www.jetbrains.com/webstorm/)。根据我的经验，它具有非常好的自动完成功能和完整的功能集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T03:01:31.857

看看Activestate 的[Komodo Edit](http://www.activestate.com/komodo-edit)。它实际上会解析您的 javascript 文件以生成工具提示、自动完成等内容。最重要的是，它实际上带有可以理解 jQuery 和其他流行 javascript 库的内置数据库。

它也是混合语言文件（如 html 和 shell 脚本）的最佳编辑器之一。商业 Komodo IDE 具有更多功能，但免费的 Komodo Edit 通常可以满足 Web 开发人员的所有需求。

# php - 使用 JQuery 将变量值输出到 innerHTML，然后将其存储在 PHP 变量中

> ID：14096925
> 
> 赞同：0
> 
> 时间：2012-12-31T02:54:09.600
> 
> 标签：php, jquery

本质上，我试图捕获 HTML 下拉菜单的值并使用用户选择的行调用 php 函数（即 print_wp_cart_button_for_product）。我创建了一个名为 onchange 的 JQuery 函数，但遇到了几个问题。通过使用警报，我确定该函数已被调用并且该值存储在 currentrow 中。此外，通过使用 firefox Web 控制台，我知道 order.php 是使用适当的参数调用的。本来我用的是ajax成功方法，但是函数没有被调用，所以我改用了complete方法，至少解决了第一个问题。我正在处理的第二个问题涉及将变量 currentrow 存储在 test 的 innerHTML 中。当我将 $('#test').html(currentrow) 更改为 $('#test').html("Complete" ）字符串被输出到屏幕上，正如我所期望的那样，但我无法使用当前行的值动态地这样做。我发现的最后一个问题涉及将测试 div 标记的值保存到 php 变量中。我尝试使用 $_GET 来捕获该值并随后调用我的 php 函数，但没有运气。

```
 <div id="test">
  </div>

  <script type = "text/javascript">
  function productchange() 
  {
      var currentrow = $('#productcategory1').val();
      //alert(currentrow);

      $.ajax({
        type: "GET",
        url: "http://www.example.com/wp-content/themes/themeX/order.php",
        data: {'rownum': currentrow},
        complete: function(currentrow){
            //alert('COMPLETE');
            $('#test').html(currentrow);
            //$('#test').html("Complete");
            }});      
      return false;
  }
  </script>

 <?php $rownum = $_GET['test']; ?>
 <?php echo print_wp_cart_button_for_product($products[$rownum]["Product"], $products[$rownum]["Price"]); ?> 
```

订单.php

```
<?php
$rownum= $_GET['rownum'];
echo "Row number = $rownum";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T05:12:18.370

这是一段代码，它将向 PHP 页面提交一个隐藏的表单字段，允许您将值存储在 PHP 变量中。首先，在包含您的 javascript 的主页上执行类似的操作。

```
<form method="post" action="storevar.php">
    <input type="hidden" name="jsvar" id="jsvar" value="" />
</form> 
```

然后，在您计算出该变量应在 javascript 中的值后，使用 Javascript/JQuery 更新此隐藏表单字段的值，如下所示：

```
function productchange() {
  var currentrow = $('#productcategory1').val();
  $("#jsvar").val(currentrow);

   $.post('storevar.php', {jsvar: currentrow}, function(data) {
             // do any additional coding with the result if need be  
         }

    });  

  return false;
} 
```

然后你可以在 storevar.php 中做这样的事情。请注意，我将它存储在会话中，以便在需要时也可以在其他页面中检索它。

```
session_start();
$currentrow = $_POST['jsvar'];
$_SESSION['currentrow'] = $currentrow; 
```

我希望这对你有帮助。如果您需要任何其他帮助，或者如果我误解了某些内容，请告诉我，我很乐意提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T04:24:35.617

看起来你`<div id="test"></div>`真的应该`<input type="hidden" id="test" name="test"/>`在一个`<form>`

使用某种形式的元素是您可以在提交时将值本地传递回服务器的唯一方法。

在任何情况下，HTML 之后的内联 PHP 代码只会在提交表单后工作。

# parsing - 当链接多个定义（如从 INT 派生的 FLOAT）构建 AST 时如何使 setParseAction 工作

> ID：14096929
> 
> 赞同：2
> 
> 时间：2012-12-31T02:54:27.620
> 
> 标签：parsing, python-2.7, abstract-syntax-tree, pyparsing

我在继承定义时努力工作`setParseAction`（我不知道如何用英语表达，所以举个例子）：

```
from __future__ import division
from decimal import Decimal

from pyparsing import Word, alphas, ParseException, Literal, CaselessLiteral \
        , Combine, Optional, nums, Or, Forward, ZeroOrMore, StringEnd, alphanums, Suppress \
        , sglQuotedString, dblQuotedString, Group \
        , restOfLine, Regex, stringEnd

class ASTNode(object):
    def __init__(self, tokens):
        self.tokens = tokens
        self.assignFields()

    def __str__(self):
        return self.__class__.__name__ + ':' + str(self.__dict__)
    __repr__ = __str__

class ConstantNode(ASTNode):
    def assignFields(self):
        #print "  ", self.tokens
        self.setValue(self.tokens[0])

    def transform(self, value):
        return value

    def setValue(self, value):
        self.constant = self.transform(value)
        del self.tokens

class StringNode(ConstantNode):
    pass

class BoolNode(ConstantNode):
    def transform(self, value):
        return bool(value)

class IntNode(ConstantNode):
    def transform(self, value):
        return int(value)

class FloatNode(ConstantNode):
    def transform(self, value):
        print value
        return Decimal(value)

class AssignmentNode(ASTNode):
    def assignFields(self):
        #print self.tokens
        self.lhs, self.rhs = self.tokens
        del self.tokens

LPAR, RPAR, LBRACK, RBRACK, LBRACE, RBRACE, SEMI, COMMA = map(Suppress, "()[]{};,")

PLUS = Literal("+")
MINUS = Literal("-")
MULT = Literal("*")
DIV = Literal("/")

ASSIGN = Literal("=")
POINT = Literal('.')

TRUE = Literal('True')
FALSE = Literal('False')

SEP = Literal(':').suppress()

NAME = Word(alphas + '_?', alphanums + '_?')
TYPE = SEP + NAME
COMMENT = "#" + restOfLine

BOOLEANS = TRUE | FALSE
BOOLEANS.setParseAction(BoolNode)

EXPR = Forward()

ADDOP = PLUS | MINUS
MULTOP = MULT | DIV
PLUSORMINUS = PLUS | MINUS

#Strings
STR = dblQuotedString.setParseAction(ConstantNode) | sglQuotedString.setParseAction(ConstantNode)

STRINGS = STR

#Numbers
NUMBER = Word(nums)
INTEGER = Combine(Optional(PLUSORMINUS) + NUMBER)
FLOATNUMBER = Combine(INTEGER.copy() +
                       Optional(POINT + Optional(NUMBER)) +
                       Optional(INTEGER.copy())
                )

MONEY = Combine(FLOATNUMBER.copy() + Word("$").suppress())
TYPED_FLOATNUMBER = Combine(FLOATNUMBER + Word(alphas))

INTEGER.setParseAction(IntNode)
FLOATNUMBER.setParseAction(FloatNode)

NUMBERS = MONEY | TYPED_FLOATNUMBER | FLOATNUMBER

TEST_GRAMMAR = """
#Single values
True
False
1 #Int32
1.0 #Float
1$ #MONEY
25.3mt #Typed number""" 
```

一切都解析，但不调用布尔和整数节点，只调用浮点数。

```
['True']
['False']
1
[FloatNode:{'constant': Decimal('1')}]
1.0
[FloatNode:{'constant': Decimal('1.0')}]
['1']
['25.3mt']
[ConstantNode:{'constant': "'hello world'"}]
[ConstantNode:{'constant': '"hello world"'}]
['2002-08-10']
['100000']
['2002-08-10-100000']
1
[AssignmentNode:{'rhs': FloatNode:{'constant': Decimal('1')}, 'lhs': 'x'}]
1.0
[AssignmentNode:{'rhs': FloatNode:{'constant': Decimal('1.0')}, 'lhs': 'x'}]
[AssignmentNode:{'rhs': '1', 'lhs': 'x'}]
[AssignmentNode:{'rhs': '12.2mt', 'lhs': 'x'}] 
```

我知道 setParseAction 与部分语法的定义有关。但是，我发现如果 chain 之类`FLOATNUMBER`的因为是基于`INTEGER`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T06:06:26.137

您遗漏了执行实际解析的代码，因此我添加了以下代码：

```
for line in TEST_GRAMMAR.splitlines():
    if not line or line[0] == '#': continue
    print (BOOLEANS^INTEGER^NUMBERS).parseString(line) 
```

给出这个输出：

```
[BoolNode:{'constant': True}]
[BoolNode:{'constant': False}]
[IntNode:{'constant': 1}]
1.0
[FloatNode:{'constant': Decimal('1.0')}]
['1']
['25.3mt'] 
```

我还必须修复 BoolNode 中的一个小错误：

```
class BoolNode(ConstantNode):
    def transform(self, value):
        return value.lower()=='true' #bool(value) 
```

在`transform`中，value 将是字符串 "True" 或 "False" 之一，但这`bool`两个字符串的值都是 True - 只有空字符串 "" 将返回 False 布尔值。

您遇到的问题之一是您对 FLOAT 的定义也将匹配 INTEGER，因此您可能会考虑重新定义 FLOAT 以要求前导、尾随或嵌入的小数点。我通过使用 '^' 而不是 '|' 解决了这个问题 作为“或”运算符。'^' 将测试*所有*给定的备选方案并选择*最长*的匹配项，'|' 将短路并选择第*一个*匹配项。

# java - Java 网络客户端小程序

> ID：14096935
> 
> 赞同：0
> 
> 时间：2012-12-31T02:55:45.940
> 
> 标签：java, http, applet, port

对不起，如果这是一个愚蠢的问题。我正在关注[http://docs.oracle.com/javase/tutorial/deployment/applet/clientExample.html](http://docs.oracle.com/javase/tutorial/deployment/applet/clientExample.html)上的“网络客户端 Applet 示例” 。但是，我无法弄清楚如何实施第 7 步：

*7。通过输入网页的 URL，在浏览器中打开包含您的小程序的网页。URL 中的主机名应与运行服务器端应用程序的主机名相同。

例如，如果服务器端应用程序在名为 JohnDoeMachine 的机器上运行，您应该输入类似的 URL。确切的端口号和路径将根据您的 Web 服务器设置而有所不同。

“http://JohnDoeMachine:8080/quoteApplet/quoteApplet.html”

QuoteClientApplet 将显示在网页上。*

我们被要求通过输入网页的 URL 打开包含小程序的网页。我知道 quoteApplet 来自哪里，但我应该如何找出网页的 http 地址和端口号？它说端口号和路径将根据我的 Web 服务器设置而有所不同。我该如何设置？我必须使用像 apache 这样的主机网络服务器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:00:09.500

它在该页面上说：

> 2\. 在网页中包含以下 HTML 代码以部署 QuoteClientApplet。

```
 <script src="http://www.java.com/js/deployJava.js"></script>
 <script> 
    var attributes =
      { code:'QuoteClientApplet.class',  width:500, height:100} ; 
    var parameters =
      {codebase_lookup:'true'};
    deployJava.runApplet(attributes, parameters, '1.6'); 
</script> 
```

您可以在任何您喜欢的网络服务器中托管该网页，此小程序将在浏览器中运行，而不是在服务器端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T04:03:28.830

是的，他们要求您将文件放在某处的网络服务器上。如果您有托管帐户，则可以将其上传到那里。否则，您可以在自己的计算机上安装类似 apache 的 Web 服务器（推荐用于测试）。

每个 web 服务器都有不同的安装说明，但通常你安装它并让它监听端口 80，这可能是大多数 web 服务器的默认配置。他们是假设您有网络服务器在端口 8080 上侦听的示例

如果您让网络服务器在端口 80 上侦听，那么在您的浏览器中使用的 url 将类似于 http:// `localhost`/quoteApplet/quoteApplet.html

`localhost`如果端口 80.是一个始终指向您自己的计算机的特殊地址，则您可以省略 url 中的端口。

他们要求您安装 Web 服务器的原因与 javas 安全模型有关 - 如果您使用浏览器从文件系统而不是从 url 加载网页，java 不会让您打开到其他域的套接字连接，除非您编辑java 策略文件 - 这变得更加复杂。

# php - 何时在 Zend Lucene 中创建索引和更新文档？

> ID：14096938
> 
> 赞同：1
> 
> 时间：2012-12-31T02:56:02.550
> 
> 标签：php, zend-search-lucene

我摆弄 Zend Lucene，我有一个问题。您什么时候在 Zend Lucene 中创建索引和更新文档？

您是否在添加新记录/行时创建索引并在更新现有记录/行时更新文档？

谢谢。

# .net - 在 IIS 中托管的 WCF 服务中使用非托管线程不安全库

> ID：14096940
> 
> 赞同：3
> 
> 时间：2012-12-31T02:56:17.347
> 
> 标签：.net, wcf, iis, thread-safety, unmanaged

我有一个托管在 IIS 中的 WCF 服务，它调用线程不安全的非托管库。

我需要以某种方式设置 IIS，以便它保留一个进程池并为每个进程分配一个请求。

我该怎么做？

**线程不安全性质的解释**：非托管库包含进程范围的共享静态数组，该数组在操作开始时归零，然后在操作期间缓慢（30s-3m）填充结果，然后将最终结果返回给我。调用不是 CPU 密集型的，数据是从外部来源收集的。进行顺序调用是安全的，但任何并行调用都会导致数组中的数据损坏，并且两个调用都返回错误的结果。我无法控制这个库。

我需要能够并行处理 30-100 个请求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T09:12:38.977

由于您有一个单个进程资源，因此您需要手动启动进程，因为我不知道有任何方法可以自动执行此操作。您仍然可以使用 WCF 执行进程间通信，并为所有进程提供一个面向公众的入口点。

您需要一个主管服务来接受请求，启动工作进程，向其发送数据并等待其完成，然后接收数据并将其转发给原始请求者。每个工作进程都可以使用[`ServiceHost`](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost.aspx)该类托管一个 WCF 服务器（使用起来非常简单）。您可以让工作进程在返回结果时终止，也可以执行自己的池化。如果你想合并，只需在工人合同上有两种方法：`DoWork`和`Shutdown`. 串行调用每个工作人员的 DoWork，或者您可以通过将以下属性应用于工作人员服务类来让 WCF 本身阻止并发请求：

```
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single,
                 ConcurrencyMode = ConcurrencyMode.Single)] 
```

这将确保在单个工作进程上运行两个并行操作的任何尝试都会阻塞并将请求排队，因此您可以简单地以循环方式调用所有工作线程来处理和排队超过您的峰值负载处理能力。

您的主管将有一个简单的面向客户的合同，该合同只是将工作分配给工作进程。如果您正在汇集工作人员，您可以在负载减少并且不再需要它们时关闭其中的一些（如果需要的话）。主管可以使用 WCF 的异步模式几乎不使用任何资源（因为它实际上并没有做任何工作），而不是每个请求都阻塞并占用一个线程。对于 WCF 异步，我建议使用 .NET 4.5，因为`Task<T>`与在 .NET 4.0 及更低版本中跳过 WCF 所需的异步箍相比，这更容易实现（只需返回 a ）。

底线是，由于你奇怪的限制，你必须做一些腿部工作才能实现你想要的目标。尽管如此，大部分管道仍然可以由 WCF 处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T03:09:48.610

您可以使用[ServiceThrotttlingBehavior](http://msdn.microsoft.com/en-us/library/vstudio/ms735114%28v=vs.90%29.aspx)来配置进程池，并使用[Concurrency Mode](http://msdn.microsoft.com/en-us/library/system.servicemodel.concurrencymode.aspx)来指定服务类是支持单线程还是多线程操作模式。

[实例上下文模式](http://msdn.microsoft.com/en-us/library/system.servicemodel.instancecontextmode.aspx)指定可用于处理传入消息中包含的调用的服务实例数。

对于您的情况，
1.`ConcurrencyMode`应该是`ConcurrencyMode.Single`or `ConcurrencyMode.Reentrant`。
2.`InstanceContextMode`应该是`PerCall`或`PerSession`。

[会话、实例化和并发](http://msdn.microsoft.com/en-us/library/ms731193.aspx)

[WCF 并发（单、多和可重入）和限制](http://www.codeproject.com/Articles/89858/WCF-Concurrency-Single-Multiple-and-Reentrant-and)

# javascript - 如何限制仅访问 ajax 请求？

> ID：14096941
> 
> 赞同：3
> 
> 时间：2012-12-31T02:56:19.563
> 
> 标签：javascript, ajax, node.js, express

我用 ajax req 加载 inicio.jade

```
$.ajax(
{
    url:'/inicio',
    cache: false,
    type: 'GET',
}).done(function(web)
{
    $('#contenido_nav_principal').fadeOut(600,function()
    {
        $('#contenido_nav_principal').empty();
        $('#contenido_nav_principal').html(web);
        $('#navegacion').animate({height:'600px'},200);
        $('#contenido_nav_principal').fadeIn(600);
    });
}); 
```

从服务器中的这个地址

```
app.get('/inicio',routes.inicio.inicio); 
```

问题是我可以通过[http://www.mypage.com/inicio访问该页面](http://www.mypage.com/inicio)

如果不是 ajax 请求，我如何限制仅访问 ajax 请求并重定向到 404 错误页面

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T03:12:14.483

使用 expressjs，您只能像这样响应 xhr 请求：

```
function handleOnlyXhr(req, res, next) {
  if (!req.xhr) return next();
  res.send({ "answer": "only is sent with xhr requests"});
} 
```

（在您的示例中，`routes.inicio.inicio`将通过检查使用上面的模式`req.xhr`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T03:09:12.293

`HTTP_X_REQUESTED_WITH`您可以通过检查header来检测它是否是服务器端的Ajax请求。如果是 Ajax 请求，header 的值`HTTP_X_REQUESTED_WITH`应该是。`XmlHttpRequest`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T03:07:46.613

您可以覆盖通话中的`beforeSend`事件`.ajax()`。根据[文档](http://api.jquery.com/jQuery.ajax/)，您可以向请求添加自定义标头。 [这篇文章](https://stackoverflow.com/questions/7686827/how-to-add-a-custom-http-header)给出了一个例子。

然后，您可以让您的页面检查该自定义标题的存在。

# backbone.js - 如何避免使用 Backbone-relational，这是一个简单的博客主干应用程序，其中包含与帖子相关的评论

> ID：14096947
> 
> 赞同：0
> 
> 时间：2012-12-31T02:58:02.167
> 
> 标签：backbone.js, coffeescript, underscore.js, backbone-relational, backbone.js-collections

骨干关系对我来说太乱了，我似乎无法调试它。我试图避免使用此资产。

我的 Backbone 应用程序中有两个集合。

`Voice.Collections.Posts`和`Voice.Collections.Comments`

这是我的路由器：

```
class Voice.Routers.Posts extends Backbone.Router
        routes:
                '': 'index'
        initialize: ->
                @collection = new Voice.Collections.Posts()
                @collection.reset($('#container').data('posts').reverse())
        index: ->
                view = new Voice.Views.PostsIndex(collection: @collection)
                $('#container').html(view.render().el) 
```

我希望我的路由器有一个方法可以根据带有帖子 ID 的 url 过滤我的评论集合（作为我的评论 - 发布关系键，post_id），所以基本上“posts/12”（posts/:id）将调用一个函数 showComments : (id) -> 它将获取 id 并初始化评论集合，其中仅包含“post_id”等于 12（“id”）的评论。

我可以对我的路由器中的集合进行排序吗？像这样的东西？（这不起作用）

```
class Voice.Routers.Posts extends Backbone.Router
        routes:
                '': 'index'
                'post/:id/': 'showComments'
        initialize: ->
                @collection = new Voice.Collections.Posts()
                @collection.reset($('#container').data('posts').reverse())
        index: ->
                view = new Voice.Views.PostsIndex(collection: @collection)
                $('#container').html(view.render().el)
        showComments: (id) ->
                @comCollection = new Voice.Views.Collections.Comments()
                @comCollection = @comCollection.where ->
                      @model.get('post_id') = id
                comview = new Voice.Views.CommentsIndex(collection: @comCollection)
                $('#comContainer').html(comview.render().el) 
```

但这不起作用，因为需要初始化 @comCollection。我只是不确定我应该怎么做。我还将满足于将评论集合呈现为来自另一个视图事件触发器的视图。感谢您的帮助。

编辑：

我必须使用 Backbone.navigate 吗？Backbone.navigate 会产生难闻的气味。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:52:25.930

我的 CoffeeScript 有点生疏了，所以我不记得具体是什么了：

```
@comCollection = @comCollection.where ->
                  @model.get('post_id') = id 
```

翻译为普通的 Javascript。但是，如果使用得当，它绝对应该可以工作，所以如果您尝试使用更简单的语法：

```
this.comCollection = this.comCollection.where({post_id: id}); 
```

你可能有更好的成功？如果没有，您可能需要进入调试器并`@comCollection`在调用后检查其中实际包含的内容。

# java - 为什么我必须为二叉树的递归插入显式设置左/右子节点？

> ID：14096951
> 
> 赞同：2
> 
> 时间：2012-12-31T02:59:29.843
> 
> 标签：java, recursion, parameter-passing, binary-tree

我只是在玩一棵二叉树，我很好奇为什么第一个实现有效，而第二个却没有。我在看什么？我认为这是微不足道的，但我仍然想念它。

# 1：

```
//just a wrapper around the insertTree method.
public void insertKey(int key){

    if(root==null) //a private 'Node' variable.
        root = new Node(key);
    else
        insertTree(key, root);
}

//recursive insert - working
private void insertTree(int key, Node node)
{
    if(key <= node.getKey())
    {
        if(node.left!=null)
            insertTree(key, node.left);
        else
            node.left = new Node(key); //explicitly setting left child
    }
    else
    {
        if(node.right!=null)
            insertTree(key, node.right);
        else
            node.right = new Node(key); //explicitly setting right child
    }

} 
```

*不工作*的变体：

# 2：

```
private void insertTree(int key, Node node)
{  //if node is null, create a new node. Can be either node.left or node.right
       if(node==null)
       {
           node = new Node(key);
           return;
       }
       else
          if(key <= node.getKey())
             insertTree(key, node.left);
          else
             insertTree(key, node.right);

} 
```

Node 只是一个具有公共`left, right`成员和单个`int key`数据成员的简单类。没有什么花哨。所以#1 工作得很好，中序遍历产生了一个排序的输出。现在，#2 似乎不起作用。根是唯一被初始化的，它的左/右子节点继续为空。所以如果我确实`node.left`作为参数传递，为什么递归方法调用不为其分配一个新节点？我在这里想念什么？Java 是通过引用传递的（即引用值），所以我猜这应该可行，但也许我在这里遗漏了一些菜鸟。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T03:02:49.470

它不起作用的原因是因为`node`最后一次递归调用中的变量实际上并没有引用与它之前的调用`insertTree`相同的内存位置。`node.left`调用函数（/方法）有效地为堆栈上的所有参数创建新的存储位置，并将参数值复制到那里。

因此，`insertTree`在您的第二个变体中，只需创建一个新`Node`变量并将其分配给`node`该函数中的局部变量。该分配不影响其他内存位置。然后它又回来了，新`Node`的永远消失了。

您声明“Java 是通过引用传递”，但事实并非如此。Java 按值传递引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T17:55:54.010

您不应该使用递归将元素添加到二叉树。递归涉及昂贵的隐式堆栈。您应该简单地迭代以找到添加节点的正确位置。另外，当您使用迭代时，您不需要两种方法来完成这项工作——一个就足够了。看下面很简单的代码：[http ://www.geekviewpoint.com/java/bst/add](http://www.geekviewpoint.com/java/bst/add)

# r - 如何在 R 中每个变量名的末尾添加“1”？

> ID：14096952
> 
> 赞同：3
> 
> 时间：2012-12-31T02:59:49.033
> 
> 标签：r, variables, rename

我有一个包含 50 个变量的数据框“数据”。出于分析目的，我想通过在每个变量的末尾添加 1 来重命名所有这些变量。以下是我遵循的过程（对于 10 个变量的数据框“数据样本”）：

```
names(datasample)
# original colnames for 10 variables
names(datasample)
  [1] "a"    "z"   "y"  "b"  "bb" "ca"   "a3"   
  [8] "b2" "as" "ask"
#rename 10 variables
names(datasample)<-c("a1","z1","y1","b1","bb1","ca1","a31","b21","as1","ask1") 
```

我想知道是否有重命名这些多个变量的有效方法。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T03:02:12.030

```
names(datasample) <- paste(names(datasample), "1", sep="") 
```

或者，等效地，

```
names(datasample) <- paste0(names(datasample), "1") 
```

# php - 将日期字符串转换为日期格式

> ID：14096953
> 
> 赞同：4
> 
> 时间：2012-12-31T02:59:53.353
> 
> 标签：php, date, datetime, time

> **可能重复：**
> [获取日期格式的 PHP 函数？](https://stackoverflow.com/questions/1929339/php-function-to-get-the-date-format)

例如：

```
$date = date_parse('2010-09-17 14:00:00'); 
```

得到我：

```
year    =>  2010
month   =>  9
day     =>  17
hour    =>  14
minute  =>  0
second  =>  0 
```

根据 PHP 如何解释字符串，它对应于这种格式：

`Y-m-d H:i:s`

给定任何日期字符串，如何获取 date_parse / strtotime 所理解的格式字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T03:02:40.087

### 使用这种方式：

```
date("Y-m-d H:i:s", strtotime('2010-09-17 14:00:00')); 
```

* * *

### 猜测日期格式：

我在 StackOverflow的一个[答案中看到：](https://stackoverflow.com/a/1929401)

> 不，没有这样的功能来猜测日期格式。您需要编写一组正则表达式匹配来表达所有可能的变化，例如

```
$variations = array (
    '^([0-9]{4})/[0-9]{2}/[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{4}2$' => 'Y/m/d H:i:s',
    // more here
);

foreach ($dateFromDatabase as $date) {
    foreach ($variations as $regexp => $dateFormat) {
        if (preg_match ('|' . $regexp . '|', $date)) {
            $matches[$dateFromDatabase] = $dateFormat;
            break;
        }
    }
}

// $matches now consists of an array of dates => format 
```

# haskell - 初始化后返回 TVar

> ID：14096954
> 
> 赞同：1
> 
> 时间：2012-12-31T02:59:57.037
> 
> 标签：haskell, concurrency

是否可以在 do 块中返回新创建的 TVar？我尝试使用以下代码来实现这一点：

```
type Buffer a = TVar [[(a,a)]]

newBuffer :: STM (Buffer a)
newBuffer = newTVar [[]]

launchGhosts :: [[(String,String)]] -> Buffer String
launchGhosts unblocked = do buff <- atomically newBuffer
                            atomically $ put buff unblocked
                            return buff

computeBlock :: Buffer String -> IO()
computeBlock buff = do i <- atomically $ get buff
                       putStrLn $ show i

put :: Buffer a -> [[(a,a)]] -> STM ()
put buff x = do writeTVar buff x

get :: Buffer a -> STM [[(a,a)]]
get buff = do x <- readTVar buff
              return x 
```

这应该允许我初始化共享内存并在程序的另一个地方使用它。我想分离内存初始化的主要原因是多次调用并发函数，而不是一次又一次地初始化内存。

类型检查器会引发以下两个错误：

```
pacman.hs:65:29:
No instance for (Monad TVar)
  arising from a do statement
Possible fix: add an instance declaration for (Monad TVar)
In a stmt of a 'do' block: buff <- atomically newBuffer
In the expression:
  do { buff <- atomically newBuffer;
       atomically $ put buff unblocked;
       computeBlock buff;
       return buff }
In an equation for `launchGhosts':
    launchGhosts unblocked
      = do { buff <- atomically newBuffer;
             atomically $ put buff unblocked;
             computeBlock buff;
             .... }

pacman.hs:65:37:
    Couldn't match expected type `TVar t0' with actual type `IO a0'
    In the return type of a call of `atomically'
    In a stmt of a 'do' block: buff <- atomically newBuffer
    In the expression:
      do { buff <- atomically newBuffer;
           atomically $ put buff unblocked;
           computeBlock buff;
           return buff } 
```

有谁知道问题出在哪里，或者可能是另一种实现此代码背后的想法的方法？

更新：

```
launchGhosts :: [[(String,String)]] -> IO(Buffer String)
launchGhosts unblocked = do buff <- atomically newBuffer
                            atomically $ put buff unblocked
                            return buff

computeBlock :: IO(Buffer String) -> IO()
computeBlock buff = do i <- atomically $ get buff
                       putStrLn $ show i 
```

更新：

```
pacman.hs:71:46:
Couldn't match expected type `Buffer a0'
            with actual type `IO (Buffer String)'
In the first argument of `get', namely `buff'
In the second argument of `($)', namely `get buff'
In a stmt of a 'do' block: i <- atomically $ get buff 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:05:16.230

解决方案是声明`launchGhosts`为

```
launchGhosts :: [[(String,String)]] -> IO (Buffer String) 
```

问题是您声明`launchGhosts`为返回 a `Buffer String`，即 a `TVar [[(String, String)]]`。由于`launchGhosts`使用了一个`do`块，因此它的结果类型需要一个`Monad`实例，根据您的签名，它是`TVar`. 这就是第一个错误的含义。

另一个问题是`atomically`具有 type `STM a -> IO a`，因此`atomically newBuffer`是 an `IO something`（实际类型）。但是您在`do`声明为具有`Buffer`(ie `TVar`) 类型的块中使用它，因此它也应该具有该类型（预期类型）。这就是第二个错误。

*编辑：*

为什么要更改 的类型签名`computeBlock`？我从来没有说过任何关于`computeBlock`.

# java - JSP 和 servlet 中页面路径的概念

> ID：14096956
> 
> 赞同：3
> 
> 时间：2012-12-31T03:00:20.313
> 
> 标签：java, jsp, servlets

这两者有什么区别？

**在 JSP 中：**

```
${pageContext.request.contextPath} 
```

如果在没有表达式语言和 servlet 的情况下进行编码，如何获得相同的结果？

**在小服务程序中：**

```
request.getServletPath() 
```

如果用 JSP 编码，如何获得相同的结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T09:14:00.927

**${pageContext.request.contextPath} ：**返回请求 URI 中指示请求上下文的部分。事实上，它与 相同`request.getContextPath()`，因为`${pageContext.request}`是指`HttpServletRequest`当前请求的 。

例如：

`http://localhost:80/myapplication/path/servlet`

*   `${pageContext.request.contextPath}`返回`/myapplication`

*   `request.getServletPath()`返回此请求的 URL 中调用 servlet 的部分，例如`/path/servlet`

*   `${pageContext.request.servletPath}`返回`/path/servlet`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T22:41:39.000

作为对问题第二部分的回答：

> `request.getServletPath()`如果使用表达式语言在 JSP 中编码，如何获得相同的结果？

* * *

这里**相当于**使用`request.getServletPath()`表达式语言：

`${pageContext.request.servletPath}`

如果您想通过表达式语言使用其他 ServletRequest/HttpServletRequest 方法，只需使用`${pageContext.request.method}`，其中*method*是适当的方法之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-20T20:47:19.367

对于由 JSP 处理的视图，则`${pageContext.request.servletPath}`返回 jsp 的路径，而不是来自`web.xml`.

为了得到我使用的：`${requestScope['javax.servlet.forward.servlet_path']}`

# java - 优化 Java 对象以提高 CPU 缓存线效率

> ID：14096960
> 
> 赞同：14
> 
> 时间：2012-12-31T03:01:30.057
> 
> 标签：java, performance, optimization, cpu-cache

我正在写一个库，其中：

*   它将需要在**各种不同的平台**/Java 实现上运行（常见的情况可能是带有 Windows 或 Linux 的 Intel 64 位机器上的 OpenJDK 或 Oracle Java）
*   在我关心对象访问中的 CPU 缓存线效率的情况下，实现**高性能是一个优先事项**
*   在某些区域，将遍历/处理相当**大的小对象图**（假设大约 1GB 规模）
*   主要工作量**几乎完全是读取**
*   **读取将分散**在对象图中，但不是完全随机的（即会有明显的热点，偶尔读取访问频率较低的区域）
*   对象图将被多个线程**同时访问**（但不修改）。假设不会发生并发修改，则没有锁定。

是否有一些设计小对象的经验法则/指南，以便它们在这种环境中有效地利用 CPU 缓存线？

我对正确调整对象的大小和结构特别感兴趣，以便例如最常访问的字段适合第一个缓存行等。

**注意：**我*完全意识到*这取决于实现，我需要进行基准测试，以及过早优化的一般风险。无需浪费任何进一步的带宽来指出这一点。:-)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-31T03:31:04.287

实现高速缓存行效率的第一步是提供参考局部性（即保持数据彼此靠近）。这在几乎所有东西都是系统分配和通过引用访问的 JAVA 中很难做到。

为了避免引用，以下内容可能很明显：

1.  将非引用类型（即 int、char 等）作为对象中的字段
2.  将对象保存在数组中
3.  保持你的小物件

在处理单个对象和遍历对象图中的对象引用时，这些规则至少会确保一些引用局部性。

另一种方法可能是根本不为您的数据使用对象，而是为每个通常是类中的字段的项目使用全局非引用类型数组（大小相同），然后每个实例将由一个公共索引标识到这些数组中。

然后，为了优化数组或其块的大小，您必须了解 MMU 特性（页面/缓存大小、缓存行数等）。我不知道 JAVA 是否在 System 或 Runtime 类中提供此信息，但您可以在启动时将此信息作为系统属性传递。

当然，这与您通常应该在 JAVA 中执行的操作完全正交 :)

此致

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-12T17:26:42.290

您可能需要有关 CPU 的各种缓存的信息，您可以使用[Cachesize](https://code.google.com/p/cachesize/)（当前支持 Intel CPU）从 Java 访问它。这有助于开发缓存感知算法。

免责声明：lib 的作者。

# linux - iptables 可以只允许对某个域名进行 DNS 查询吗？

> ID：14096966
> 
> 赞同：16
> 
> 时间：2012-12-31T03:02:24.493
> 
> 标签：linux, dns, iptables

我目前有 iptables 阻止所有 UDP 流量，但是我只想允许某些 DNS 查询通过。

让我们以 google.com 为例。

我正在尝试使用字符串匹配来查找请求中的域名，并允许它。这就是我想出的。

`iptables -A OUTPUT -o eth0 -p udp --sport 53 -m string --string "google.com" --algo bm -j ACCEP`吨

我也试过`--dport 53`代替`--sport`. 没有骰子。

如果有人知道如何做到这一点或看到我出错的地方，我们将不胜感激！

谢谢， 杰瑞德

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-06-19T06:24:48.867

我知道这有点晚了，但既然你还没有结束这个问题......

如果您在wireshark 或类似软件中查看DNS 请求数据包的内容，您会发现没有使用点字符。域名的每一部分都是一个计数字符串，因此请求的实际字节数`google.com`将是：

```
06 67 6f 6f 67 6c 65 03 63 6f 6d 
```

第一个字节 (06) 是 的长度`google`，然后是 6 个 ASCII 字符，然后是计数字节 (03) 的长度，`com`然后是......你明白了。

要在 iptables 中匹配它，请使用以下命令：

```
iptables -A OUTPUT -o eth0 -p udp --port 53 -m string --hex-string "|06|google|03|com" -algo bm -j ACCEPT 
```

该`--hex-string`参数解析提供的字符串以查找由垂直条对分隔的十六进制值。竖线之外的任何内容都被解释为 ASCII 文本。

如果您在添加条目后列出 OUTPUT 表，您会发现以下内容：

```
ACCEPT     udp  --  anywhere             anywhere             udp dpt:domain STRING match  "|06676f6f676c6503636f6d|" ALGO name bm TO 65535 
```

`--from`您可以通过使用和`--to`参数限制搜索范围来稍微调整规则并加快速度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-08T14:07:37.793

我发现带点的字符串不可靠。

这将起作用：

```
iptables -A OUTPUT -o eth0 -p udp --port 53 -m string --string google --algo bm -j ACCEPT 
```

# hadoop - HiveQL UNION ALL

> ID：14096968
> 
> 赞同：16
> 
> 时间：2012-12-31T03:02:43.877
> 
> 标签：hadoop, union, hive, hiveql

我有表_A：

```
id var1 var2
1   a    b
2   c    d 
```

表_B：

```
id var1 var2  
3   e    f
4   g    h 
```

我想要的只是表格，结合起来：

```
id var1 var2
1   a    b
2   c    d
3   e    f
4   g    h 
```

这是我的 .hql：

```
CREATE TABLE combined AS
SELECT all.id, all.var1, all.var2
FROM (
  SELECT a.id, a.var1, a.var2  
  FROM table_A a  
  UNION ALL  
  SELECT b.id, b.var1, b.var2  
  FROM table_B b
) all; 
```

我直接从 Edward Capriolo 等人的 Programming Hive 第 112 页编写代码。

我得到的错误，无论我尝试上述的表面上合理的变化，是

> `cannot recognize input near '.' 'id' ',' in select expression.`

我尝试`AS`在表名和别名之间使用星号，因为我想要两个表中的所有内容。同样的错误。我尝试了其他事情并得到了其他错误......我想要做的只是`UNION`两张桌子。（我试过`UNION`而不是`UNION ALL`- 同样的错误）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-31T13:52:49.203

只需用另一个词替换所有内容。它似乎是一个保留关键字。例如：

```
CREATE TABLE combined AS
SELECT unioned.id, unioned.var1, unioned.var2
FROM (
  SELECT a.id, a.var1, a.var2  
  FROM table_A a  
  UNION ALL  
  SELECT b.id, b.var1, b.var2  
  from table_B b
) unioned; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-11-07T09:18:24.407

我有类似的查询工作。只需更改表名和列名。尝试这个。希望这对您有所帮助。

```
create table new_table as
select
distinct
id, name
FROM
table1
union all
select
distinct
id,name
from
table2 
; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-14T17:54:50.230

试试这个，它对我有用。

```
CREATE TABLE combined AS
SELECT id, var1, var2
FROM (
  SELECT id, var1, var2  
  FROM table_A
  UNION ALL  
  SELECT id, var1, var2  
  from table_B
) a; 
```

# facebook - HTTP/1.0 400 Bad Request

> ID：14096975
> 
> 赞同：-1
> 
> 时间：2012-12-31T03:03:45.697
> 
> 标签：facebook, http, login, error-handling

My question is simple: How do i hide the warning message below so that users don't see it? It appears at the top of my site from time to time.

```
Warning: file_get_contents(https://graph.facebook.com/oauth/access_token?client_id=*****************&redirect_uri=&client_secret=******&code=*************************************************************************************) [function.file-get-contents]: failed to open stream: HTTP request failed! HTTP/1.0 400 Bad Request in /home/content/**/*******/php/facebook/facebook-login.php on line 17 
```

I am not worried about the warning as it doesn't seem to affect the functionality of my site and it only happens because the facebook token has expired.

I have tried for hours to resolve it properly by auto-renewing the expired token but had no luck.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:17:49.660

Well, if you only need to hide it, you can go to the php file (/home/content/**/*******/php/facebook/facebook-login.php) and add the @ to line 17 to supress any errors from that function call. See: [http://php.net/manual/en/language.operators.errorcontrol.php](http://php.net/manual/en/language.operators.errorcontrol.php)

Please consider the warning there, too.

Also be advised, that proper error handling with supressing (but logging) errors for the user and showing them if you visit your site as admin will be even better.

# java - primefaes 子菜单和布局

> ID：14096978
> 
> 赞同：3
> 
> 时间：2012-12-31T03:04:15.963
> 
> 标签：java, primefaces

I have a layout and I need to show a JSF page in the center position when a menu item is selected, and if I select other menu item it must change to this and so on. 我不知道该怎么做，所有页面必须根据菜单中的选择出现在中心位置（左侧位置）

```
<p:layoutUnit position="south" size="50"  resizable="true" closable="false" collapsible="false">  
    <h:outputText value="South unit content." />  
</p:layoutUnit>  

<p:layoutUnit position="west" size="280" header="start" resizable="true" closable="false" collapsible="false">
        <p:panelMenu style="width:100%"> 
            <p:submenu label="clinet maneger" id="panelMenu" >  

                <p:menuitem value="basic"   
                url="/pages/basicInfo.jsf" icon="ui-icon-document" /> 

                <p:menuitem value="clinets information"  
                url="/pages/clinets.jsf" icon="ui-icon-document"/>
                <p:menuitem value="ernterprises Information"  
                url="/pages/enterprises.jsf" icon="ui-icon-document"/>
            </p:submenu>  
            <p:separator />  
        </p:panelMenu>  
</p:layoutUnit>

<p:layoutUnit id="center" position="center" resizable="true">
        <ui:insert name="center"></ui:insert>
        <ui:include src="/pages/clinetsList.xhtml"></ui:include>
</p:layoutUnit> 
```

# json - 节点服务器接收 XmlHttpRequest

> ID：14096979
> 
> 赞同：3
> 
> 时间：2012-12-31T03:04:27.103
> 
> 标签：json, node.js, xmlhttprequest, webrtc

我正在使用以下代码发送会话描述（微小的 JSON 代码 - [http://www.ietf.org/rfc/rfc2327.txt](http://www.ietf.org/rfc/rfc2327.txt)）。

```
function sendMessage(message) {
  var msgString = JSON.stringify(message);
  console.log('C->S: ' + msgString);
  path = '/message?r=67987409' + '&u=57188688';
  var xhr = new XMLHttpRequest();
  xhr.open('POST', path, true);
  xhr.send(msgString);
} 
```

我不确定如何在我的 Node.js 服务器上检索 JSON。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T03:22:36.163

这是一个可以处理`POST`node.js 中的请求的代码。

```
var http = require('http');

var server = http.createServer(function (request, response) {
    if (request.method == 'POST') {
        var body = '';
        request.on('data', function (data) {
            body += data;
        });
        request.on('end', function () {

            var POST = JSON.parse(body);
            // POST is the post data

        });
    }
});
server.listen(80); 
```

希望这可以帮到你。

# c - 通过地址访问结构成员

> ID：14096987
> 
> 赞同：4
> 
> 时间：2012-12-31T03:05:28.273
> 
> 标签：c, pointers, struct

考虑一个具有两个整数类型成员的结构。我想通过地址获取两个成员。我可以成功获得第一个，但第二个我得到了错误的值。我相信这是垃圾价值。这是我的代码：

```
#include <stdio.h>

typedef struct { int a; int b; } foo_t;

int main(int argc, char **argv)
{

  foo_t f;
  f.a = 2;
  f.b = 4;
  int a = ((int)(*(int*) &f));
  int b = ((int)(*(((int*)(&f + sizeof(int)))))); 
  printf("%d ..%d\n", a, b);
  return 0;
} 
```

我越来越：

> 2 ..1

有人可以解释我哪里出错了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T03:12:54.623

按照 C 标准，第一个成员的偏移量必须始终为零；这就是为什么你的第一个演员有效。然而，由于填充，第二个成员的偏移量可能不一定等于结构的第一个成员的大小。

此外，向指针添加数字不会将字节数添加到地址：相反，添加了所指向事物的大小。因此，当您添加`sizeof(int)`到时`&f`，`sizeof(int)*sizeof(foo_t)`会添加。

[`offsetof`](http://en.wikipedia.org/wiki/Offsetof)如果你想自己做数学，你可以使用运算符，像这样

```
int b = *((int*)(((char*)&f)+offsetof(foo_t, b))); 
```

这样做的原因是它`sizeof(char)`始终是*一个*，正如 C 标准所要求的那样。

当然，您可以使用`&f.b`来避免手动进行数学运算。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T03:13:30.867

你的问题是`&f + sizeof(int)`。如果`A`是一个指针，并且`B`是一个整数，那么`A + B`在 C 中并不意味着`A`加`B`字节。相反，它表示`A`加`B`元素，其中元素的大小由 的指针类型定义`A`。因此，如果`sizeof(int)`在您的体系结构上为 4，则`&f + sizeof(int)`表示“将 4 个`foo_t`s 放入`&f`，或 4 * 8 = 32 个字节放入`&f`”。

试试`((char *)&f) + sizeof(int)`吧。

或者，当然，`&f.a`而是`&f.b`非常简单。后者不仅会为您提供方便`int`的指示并让您摆脱所有这些强制转换，而且还可以定义明确且易于理解。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T03:14:06.440

该表达式`&f + sizeof(int)`将一个数字添加到一个类型的指针`foo_t*`。指针算术始终假定指针指向数组的元素，并且该数字被视为元素的计数。

因此，如果`sizeof(int)`是 4，则指向过去的`&f + sizeof(int)`四个结构，或之后的字节。`foo_t``f``4*sizeof(foo_t)``&f`

如果你必须使用字节数，这样的事情可能会起作用：

```
int b = *(int*)((char*)(&f) + sizeof(int)); 
```

...假设成员`a`和`b`.

但是有什么理由你不只是得到值`f.b`或指针`&f.b`吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T03:12:43.607

你可以做`&f.b`，并跳过实际的指针数学。

以下是我将如何更改您的`int b`线路：

```
int b = (int)(*(((int*)(&(f.b))))); 
```

顺便说一句，当我按原样运行您的程序时，我得到`2 ..0`了输出。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-31T03:13:06.557

这有效：

```
 int b = ((int)(*(int*)((int)&f + sizeof(int)))); 
```

您将 &f 解释为指针，当您向其添加 4（int 大小）时，它将其解释为添加 4 个指针，即 16 或 32 字节，具体取决于 32 与 64 拱。如果您将指针转换为 int ，它将正确添加 4 个字节。

这是对正在发生的事情的解释。我不确定你在做什么，但你肯定不应该那样做。这会让你在对齐等方面遇到麻烦。找出结构元素偏移的安全方法是：

```
 printf("%d\n", &(((foo_t *)NULL)->b)); 
```

# cloudbees - 从 Maven 发布的存储库部署到应用程序

> ID：14096988
> 
> 赞同：2
> 
> 时间：2012-12-31T03:05:35.257
> 
> 标签：cloudbees

我刚刚想通了，如何发布到 CB 托管的 maven “发布”存储库。我想弄清楚如何将标记版本部署到 CB 应用程序。我了解，我可以手动上传 WAR 文件，但是否有任何脚本。据我所知，用于 CB 的 maven 插件不支持它。

我有一个应用服务器正在运行来自 jenkins 的快照构建。我有其他应用服务器，我只想部署标记/发布的工件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T19:20:23.160

有四种方法可以将应用程序部署到 CloudBees RUN@cloud 服务：

1.  使用`bees`SDK 提供的命令

2.  使用`bees-maven-plugin`

3.  通过 Web GUI 使用手动上传

4.  为 Jenkins 使用 CloudBees Deployer 插件

您选择哪个选项取决于部署将从何处进行……我所说的来自哪*台机器*正在执行部署，而不是文件的来源。

如果从 Jenkins 作业运行，最好的选择是 Jenkins 插件。

如果从您自己的笔记本电脑上运行，则 web ui 或`bees`命令是最简单的。

如果作为 maven 构建的一部分运行，则 maven 插件是最简单的......（尽管我应该警告 maven 插件（暂时移除我的 cloudbees 帽子并戴上我的 maven PMC 帽子）很糟糕，而且一切都是愚蠢的;-) )

您最好的选择是设置一个使用依赖项的 Jenkins 作业：get 从 repo 中提取工件，然后添加一个 cloudbees 部署程序构建步骤以推送到 RUN@cloud

好消息是，在我们的路线图上将 maven 插件打造成更像 maven 的东西......希望这将启用像您可以使用 ship-maven-plugin@mojo 实现的操作，您可以在其中为“shipping”指定特定的发布版本“到生产。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T18:07:37.827

您是从 Jenkins 构建中创建标签/发布吗？如果是这样，您可能可以使用 Deploy to CloudBees 构建后步骤和`target/checkout/something.war`.

更一般地说，我猜你会想要编写一个脚本来使用`mvn dependency:get`，然后使用 Bees SDK 来获取最新发布的工件并部署它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T03:11:34.730

我想，您想要做的是将发布工件部署到您的存储库。

看看[maven-release-plugin](http://maven.apache.org/maven-release/maven-release-plugin/)。

简而言之，您需要做的是：

```
$ mvn release:prepare
$ mvn release:perform 
```

这不是那么简单，因为您需要适当地配置您的 pom.xml 以使其正常工作。查看[maven-release-plugin](http://maven.apache.org/maven-release/maven-release-plugin/)示例和使用页面。

# iphone - 核心图形仅在真实设备上抛出 EXC_BAD_ACCESS

> ID：14096989
> 
> 赞同：2
> 
> 时间：2012-12-31T03:05:42.003
> 
> 标签：iphone, objective-c, ios, uitableview, exc-bad-access

晚上好，

我刚刚完成了我制作的这个新应用程序，并且在将它提交到应用程序商店之前我正在对其进行一些最终测试，但出现了一些让我非常难过的事情。对于我的一个视图控制器，我使用的是 UITableView，所以我实现了

```
 -(UIView*) tableView:(UITableView*) tableView viewForHeaderInSection:(NSInteger) section 
```

UITableViewDelegate 协议的方法，以便我可以为标题提供自己的自定义视图。（是的，我确实也符合 UITableViewDataSource 协议并为其提供了所有必要的方法）

所以我编写了自己的 UIView 类并实现了 drawRect: 方法来绘制我自己的自定义视图。当我在 iPad 6.0 和 iPhone 6.0 模拟器中运行它时，它运行得非常好。

但是，当我插入自己的 iOS 设备（运行 iOS 6）时，它会崩溃并抛出 EXC_BAD_ACCESS。

我做了一些断点，发现在我的真实设备上运行应用程序时，代码只执行到这里：

```
 // This code is the beginning of my drawRect method for my custom view
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGColorRef lightBlue = [UIColor colorWithRed:72.0/255.0
                                      green:121.0/255.0      
                                      blue:201.0/255.0 alpha:1].CGColor;

    CGColorRef cream = [UIColor colorWithRed:235.0/255.0 
                            green:235.0/255.0
                            blue:235.0/255.0 alpha:1].CGColor;
    CGContextSetFillColorWithColor(context,cream);
    CGContextFillRect(context, _paperBox); 
     // the _paperBox variable was defined earlier as CGRect _paperBox
     // the _paperBox variable was given a value in the -(void)layoutSubviews method

    CGColorRef shadow = [UIColor colorWithWhite:.5 alpha:.5].CGColor;
    CGContextSetShadowWithColor(context, CGSizeMake(0,3), 2, shadow);
    CGContextSetFillColorWithColor(context, lightBlue);

    // and later on I setup some code to draw a linear gradient:

    NSArray colors = [NSArray arrayWithObjects:(__bridge id) lightBlue,
                                                 (__bridge id) cream,
                                                 nil]; 
```

EXC_BAD_ACCESS 发生在最后一行。为什么只有在真正的 iOS 设备上运行而不是在模拟器上运行时才会发生这种情况？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:48:41.523

我找到了我的问题的答案，希望其他阅读本文遇到同样问题的人会发现此回复很有帮助。由于 ARC 和新的 __bridge 修饰符的发布，我的旧转换为：

```
 (__bridge id) 
```

在每个 CGColorRef 上，新的 ARC 术语在技术上并不“正确”，而且我对新的 __bridge 概念不太熟悉，所以我所做的修复不是为每个 UIColor 制作一个 CGColorRef，而是投射 CGColor每个 UIColor 的属性到数组中的 id，如下所示：

```
 NSArray* array = [NSArray arrayWithObjects:
    (id)[UIColor whiteColor]CGColor],
    (id)[[UIColor colorWithRed:235.0/255.0 
    green:235.0/255.0 blue:235.0/255.0]CGColor],nil]; 
```

这似乎对我有用。但是，我建议所有不熟悉新的 __bridge 修饰符的人在使用 ARC 时学习它们（包括我自己）。

谢谢大家！

# generics - Vala 接口泛型编译器错误

> ID：14096999
> 
> 赞同：3
> 
> 时间：2012-12-31T03:07:49.947
> 
> 标签：generics, interface, compiler-errors, vala

我有以下小例子（vala 0.18.1）：

```
namespace Learning
{
   public interface IExample<T>
   {
      public abstract void set_to(T val);
      public abstract T get_to();
   }

   public class Example : Object, IExample<double>
   {
      private double to;

      public void set_to(double val)
      {
         to = val;
      }

      public double get_to()
      {
         return to;
      }

      public string to_string()
      {
         return "Example: %.5f".printf(to);
      }
   }

   public class Test
   {
      public static void main(string[] args)
      {
         stdout.printf("Start test\n");

         Example ex = new Example();

         stdout.printf("%s\n", ex.to_string());
         ex.set_to(5.0);
         stdout.printf("%s\n", ex.to_string());

         stdout.printf("End test\n");
      }
   }
} 
```

这会引发错误：

```
/src/Test.vala.c: In function ‘learning_test_main’:
/src/Test.vala.c:253:2: error: incompatible type for argument 2 of ‘learning_iexample_set_to’
/src/Test.vala.c:117:6: note: expected ‘gconstpointer’ but argument is of type ‘double’
error: cc exited with status 256
Compilation failed: 1 error(s), 0 warning(s) 
```

现在，从我能够在 Vala 中找到的关于泛型接口的少量文档[http://www.vala-project.org/doc/vala-draft/generics.html#genericsexamples](http://www.vala-project.org/doc/vala-draft/generics.html#genericsexamples)中，这应该可以工作。当我检查生成的 C 代码时，它显示示例的 set_to 函数采用双精度，而 IExample 的 set_to 函数采用 gconstpointer。

那么为什么 main 函数使用 gconstpointer 版本而不是 double 版本呢？有人可以向我解释为什么它不起作用以及解决它的方法吗？

感谢您的帮助。

PS 是的，我知道找到的文档是草稿。

答案代码：根据下面选择的答案，这就是我将代码更改为的内容。

```
namespace Learning
{
   public interface IExample<T>
   {
      public abstract void set_to(T val);
      public abstract T get_to();
   }

   public class Example : Object, IExample<double?>
   {
      private double? to;

      public void set_to(double? val)
      {
         to = val;
      }

      public double? get_to()
      {
         return to;
      }

      public string to_string()
      {
         return (to == null) ? "NULL" : "Example: %.5f".printf(to);
      }
   }

   public class Test
   {
      public static void main(string[] args)
      {
         stdout.printf("Start test\n");

         Example ex = new Example();

         stdout.printf("%s\n", ex.to_string());
         ex.set_to(5.0);
         stdout.printf("%s\n", ex.to_string());

         stdout.printf("End test\n");
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:38:18.373

`IExample<double>`与其使用，不如使用`IExample<double?>`来装箱，`double`以便可以将其作为指针传递。通常，这对于`struct`Vala 中的任何类型都是必要的。类和紧凑类不需要这种处理，因为它们已经是指针。此外，`struct`小于 32 位的类型（即使在 64 位平台上）`uint8`也`char`可以直接使用，无需装箱。如有疑问，请框。