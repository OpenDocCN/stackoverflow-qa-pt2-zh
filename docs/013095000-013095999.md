# StackOverflow 问答 13095000-13095999

# javascript - 无需下载即可知道图片是否启用了 CORS

> ID：13095006
> 
> 赞同：2
> 
> 时间：2012-10-26T21:59:30.580
> 
> 标签：javascript, canvas, cors

我有兴趣在画布中加载图片以读取像素值。这需要图像启用 CORS。给定一个图像 URL，是否可以知道相应图像是否启用了 CORS，而无需下载它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T02:59:44.893

无代码解决方案是[http://www.corsproxy.com/](http://www.corsproxy.com/)另一个就是上面提到的那个。只需使用此处描述的方法发出一个简短的 HEAD 请求：[HTTP HEAD Request in Javascript/Ajax?](https://stackoverflow.com/questions/333634/http-head-request-in-javascript-ajax) 并检查 responseHeaders。

# ios - ios AVFoundation 点击 聚焦

> ID：13095007
> 
> 赞同：26
> 
> 时间：2012-10-26T21:59:39.957
> 
> 标签：ios, camera, avfoundation

我正在尝试创建一个相机应用程序，它或多或少会像默认的相机应用程序一样。目前对我不起作用的事情是点击聚焦。我希望相机聚焦并在我的触摸点上做任何事情，就像真正的相机应用程序一样。

这是我的 viewDidLoad

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // Session
    _session = [[AVCaptureSession alloc] init];
    _session.sessionPreset = AVCaptureSessionPresetPhoto;

    // Input
    _videoDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
    _videoInput = [AVCaptureDeviceInput deviceInputWithDevice:_videoDevice error:nil];

    // Output
    _frameOutput = [[AVCaptureVideoDataOutput alloc] init];
    _frameOutput.videoSettings = [NSDictionary dictionaryWithObject:AVVideoCodecJPEG forKey:AVVideoCodecKey];

    [_frameOutput setSampleBufferDelegate:self queue:dispatch_get_main_queue()];
    [_session addInput:_videoInput];
    [_session addOutput:_frameOutput];
    [_session startRunning];
}; 
```

这是让我的相机在点击时聚焦的方法。

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

    [touches enumerateObjectsUsingBlock:^(id obj, BOOL *stop) {
        UITouch *touch = obj;
        CGPoint touchPoint = [touch locationInView:touch.view];
        focusLayer.frame = CGRectMake((touchPoint.x-25), (touchPoint.y-25), 50, 50);

        if ([_videoDevice isFocusPointOfInterestSupported]) {
            NSError *error;
            if ([_videoDevice lockForConfiguration:&error]) {
                [_videoDevice setFocusPointOfInterest:touchPoint];
                [_videoDevice setExposurePointOfInterest:touchPoint];

                [_videoDevice setFocusMode:AVCaptureFocusModeAutoFocus];
                if ([_videoDevice isExposureModeSupported:AVCaptureExposureModeAutoExpose]){
                    [_videoDevice setExposureMode:AVCaptureExposureModeAutoExpose];
                }
                [_videoDevice unlockForConfiguration];
            }
        }

        // NSLog(@"x = %f, y = %f", touchPoint.x, touchPoint.y);
    }];
} 
```

一旦我点击屏幕，什么都没有发生。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-27T17:37:10.560

您必须使用以下代码将 touchPoint 调整为 [0,1] 的范围：

```
 CGRect screenRect = [[UIScreen mainScreen] bounds];
    screenWidth = screenRect.size.width;
    screenHeight = screenRect.size.height;  
    double focus_x = thisFocusPoint.center.x/screenWidth;
    double focus_y = thisFocusPoint.center.y/screenHeight;

    [[self captureManager].videoDevice lockForConfiguration:&error];
    [[self captureManager].videoDevice setFocusPointOfInterest:CGPointMake(focus_x,focus_y)];
    [[self captureManager].videoDevice unlockForConfiguration]; 
```

这方面的文档可以在[**Apple - AV Foundation Programming Guidelines**中找到- 请参阅**媒体捕获**部分，您将在其中找到有关**焦点模式**](https://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/04_MediaCapture.html)的信息：

> 如果支持，您可以使用 focusPointOfInterest 设置焦点。您传递一个 CGPoint，其中 {0,0} 代表图片区域的左上角，{1,1} 代表横向模式下的右下角，主页按钮位于右侧——即使设备处于纵向模式也适用.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-10-31T21:30:29.877

```
UITapGestureRecognizer *shortTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTapToFocus:)];
shortTap.numberOfTapsRequired=1;
shortTap.numberOfTouchesRequired=1;
[viewCanvasRecording addGestureRecognizer:shortTap]; 
```

然后这个：

```
- (void)handleTapToFocus:(UITapGestureRecognizer *)tapGesture
{
    AVCaptureDevice *acd=!currentFrontCamera ? captureBackInput.device : captureFrontInput.device;

    if (tapGesture.state == UIGestureRecognizerStateEnded)
    {
        CGPoint thisFocusPoint = [tapGesture locationInView:viewCanvasRecording];

        double focus_x = thisFocusPoint.x/viewCanvasRecording.frame.size.width;
        double focus_y = thisFocusPoint.y/viewCanvasRecording.frame.size.height;

        if ([acd isFocusModeSupported:AVCaptureFocusModeAutoFocus] && [acd isFocusPointOfInterestSupported])
        {
            if ([acd lockForConfiguration:nil])
            {
                [acd setFocusMode:AVCaptureFocusModeAutoFocus];
                [acd setFocusPointOfInterest:CGPointMake(focus_x, focus_y)];

                /*
                if ([acd isExposureModeSupported:AVCaptureExposureModeAutoExpose] && [acd isExposurePointOfInterestSupported])
                {
                    [acd setExposureMode:AVCaptureExposureModeAutoExpose];
                    [acd setExposurePointOfInterest:CGPointMake(focus_x, focus_y)];
                }*/

                [acd unlockForConfiguration];
            }
        }
    }
} 
```

斯威夫特版本：

```
@IBAction func tapToFocus(_ sender: UITapGestureRecognizer) {
    if (sender.state == .ended) {
        let thisFocusPoint = sender.location(in: previewView)

        print("touch to focus ", thisFocusPoint)

        let focus_x = thisFocusPoint.x / previewView.frame.size.width
        let focus_y = thisFocusPoint.y / previewView.frame.size.height

        if (captureDevice!.isFocusModeSupported(.autoFocus) && captureDevice!.isFocusPointOfInterestSupported) {
            do {
                try captureDevice?.lockForConfiguration()
                captureDevice?.focusMode = .autoFocus
                captureDevice?.focusPointOfInterest = CGPoint(x: focus_x, y: focus_y)

                if (captureDevice!.isExposureModeSupported(.autoExpose) && captureDevice!.isExposurePointOfInterestSupported) {
                    captureDevice?.exposureMode = .autoExpose;
                    captureDevice?.exposurePointOfInterest = CGPoint(x: focus_x, y: focus_y);
                 }

                captureDevice?.unlockForConfiguration()
            } catch {
                print(error)
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-30T20:43:24.433

所以这就是我如何处理我的 AV 摄像机预览的手势。首先设置您的 UITapGestureRecognizer，然后使用 captureDevicePointOfInterestForPoint 获取点。

```
- (void)setupGestures
{
  UITapGestureRecognizer *tapToFocusRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self
                                          action:@selector(handleTapToFocusAndExposureRecognizer:)];
  [self addGestureRecognizer:tapToFocusRecognizer];
}

- (void)handleTapToFocusAndExposureRecognizer:(UITapGestureRecognizer*)tabRecognizer {
  CGPoint touchPoint = [tabRecognizer locationInView:self];
  CGPoint point = [self.previewLayer captureDevicePointOfInterestForPoint:touchPoint];
  AVCaptureDevice *device = [self.videoCaptureDeviceInput device];
  NSError *error = nil;

  if (tabRecognizer.state == UIGestureRecognizerStateEnded) {
    if (![device lockForConfiguration:&error]) {
      if (error) {
        RCTLogError(@"%s: %@", __func__, error);
      }
      return;
    }

    [device setFocusPointOfInterest:CGPointMake(point.x, point.y)];
    [device setFocusMode:AVCaptureFocusModeContinuousAutoFocus];

    [device setExposurePointOfInterest:CGPointMake(point.x, point.y)];
    [device setExposureMode:AVCaptureExposureModeContinuousAutoExposure];

    [device unlockForConfiguration];
  }
} 
```

我正在使用 AVCaptureVideoPreviewLayer 来获取接触点。但是如果你使用 GLKView 而不是 AVCaptureVideoPreviewLayer 来渲染预览，你不能直接得到要点，而必须像之前的答案那样得到要点。

ios开发的新编码器。希望这能有所帮助。

# php - 如何在 PHP 中缩短 HTML 文本

> ID：13095011
> 
> 赞同：0
> 
> 时间：2012-10-26T21:59:52.167
> 
> 标签：php, html

> **可能重复：**
> [PHP：截断 HTML，忽略标签](https://stackoverflow.com/questions/1193500/php-truncate-html-ignoring-tags)

我将 html 数据保存在 db 中。我想将 html 显示为缩短。我尝试使用`mb_strstr`这样的功能；

```
$str = mb_strstr($this->htmlData, "</p>",true);
echo $str."</p>"; 
```

它呼应了 html 的第一段。但问题是管理面板中填充了 html，有时第一段没有足够的文本。我也不想使用固定字符位置，`substr`因为有时可以说 200 个字符可以是 html 标记，因此它会产生无效格式的 html 格式输出。

所以我想学习这类问题的最佳实践。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:22:33.067

在您的所见即所得编辑器中添加一些自定义标签或代码（例如：`<separator>`或`...`）。您可以使用它将介绍部分与文章的其余部分分开。这将帮助您避免在介绍部分未封闭的 PHP 标记混乱。它还为作者提供了手动决定文本的哪一部分适合介绍的选项。

另一个明智的做法是在数据库中为介绍部分创建一个单独的字段。是的，它会花费更多的内存，但它会给作者一个选项来写多汁的介绍文本，让更多的人打开全文......

# c++ - 错误向量迭代器不兼容 - opencv

> ID：13095019
> 
> 赞同：1
> 
> 时间：2012-10-26T22:00:35.887
> 
> 标签：c++, exception, opencv, vector, iterator

我正在尝试使用 opencv 校准我的相机。我找到[了本](http://www.aishack.in/2010/07/calibrating-undistorting-with-opencv-in-c-oh-yeah/)教程，但我遇到了“错误向量迭代器不兼容”异常。

我将 image_points 声明如下：

```
vector<vector<Point2f>> image_points; 
```

角落如下：

```
vector<Point2f> corners; 
```

在以下 3 个 OpenCV 调用中使用了角点：

```
 bool found = findChessboardCorners(image, board_sz, corners, CV_CALIB_CB_ADAPTIVE_THRESH | CV_CALIB_CB_FILTER_QUADS);

    if(found)
    {
        cornerSubPix(gray_image, corners, Size(11, 11), Size(-1, -1), TermCriteria(CV_TERMCRIT_EPS | CV_TERMCRIT_ITER, 30, 0.1));
        drawChessboardCorners(gray_image, board_sz, corners, found);
    } 
```

并在尝试像这样推动 image_points 上的角时出现异常：

```
if ( key == ' ' && found != 0 )
    image_points.push_back(corners); 
```

谁能暗示什么是错的？

**编辑**：发布完整代码

```
#include <opencv\cv.h>
#include <opencv\highgui.h>

using namespace cv;
using namespace std;

int main()
{
    int numBoards = 3;
    int numCornersHor = 9;
    int numCornersVer = 6;

    int numSquares = numCornersHor * numCornersVer;
    Size board_sz = Size(numCornersHor, numCornersVer);

    VideoCapture capture = VideoCapture(0);

    vector<vector<Point3f>> object_points;
    vector<vector<Point2f>> image_points;

    vector<Point2f> corners;
    int successes=0;

    Mat image;
    Mat gray_image;
    capture >> image;

    vector<Point3f> obj;
    for(int j=0;j<numSquares;j++)
        obj.push_back( Point3f( (j * 1.0f) / numCornersHor, ( j % numCornersHor ) * 1.0f, 0.0f ) );

    while(successes < numBoards)
    {
        cvtColor(image, gray_image, CV_BGR2GRAY);

        bool found = findChessboardCorners(image, board_sz, corners, CV_CALIB_CB_ADAPTIVE_THRESH | CV_CALIB_CB_FILTER_QUADS);

        if(found)
        {
            cornerSubPix(gray_image, corners, Size(11, 11), Size(-1, -1), TermCriteria(CV_TERMCRIT_EPS | CV_TERMCRIT_ITER, 30, 0.1));
            drawChessboardCorners(gray_image, board_sz, corners, found);
        }

        imshow("win2", gray_image);

        capture >> image;

        int key = waitKey(1);
        if(key==27)
            return 0;

        if(key==' ' && found!=0)
        {
            // the next line throws the exception.
            image_points.push_back(corners);
            object_points.push_back(obj);
            printf("Snap stored!\n");

            successes++;

            if(successes>=numBoards)
                break;
        }
    }
    // the program never reaches this point

    // do more stuff .....
} 
```

以下是我遇到的异常。 ![遇到异常](../Images/94f83fc923f18d537f8c4d92ed36d4c5.png)

# javascript - NVD3 不处理大值

> ID：13095023
> 
> 赞同：1
> 
> 时间：2012-10-26T22:00:42.240
> 
> 标签：javascript, graph, d3.js, stacked-area-chart, nvd3.js

我在 NVD3 中实现了一个图表，但我遇到了严重的问题。NVD3 似乎无法处理包含大值的数据集。该图位于此处：[http](http://brad.kizer.com.ng/) ://brad.kizer.com.ng/ 。该图的代码如下：

```
nv.addGraph(function() {
    // Get maximum and minimum Y values
    var minY = 2 >> 30,
        maxY = 0;

    data.forEach(function (d) {
        d.values.forEach(function (s) {
            minY = Math.min(minY, s.y);
            maxY = Math.max(maxY, s.y);
        });
    });

    var chart = nv.models.stackedArea()
        .forceY([0, 20])
        .height($(container).closest('.chart').height())
        .width($(container).closest('.chart').width());

    (Object.prototype.toString.call(data) === '[object Array]') || (data = [data]);

      d3.select(container)
          .attr('width', $(container).closest('.chart').width())
          .attr('height', 250)
          .datum(data)
        .transition().duration(500)
          .call(chart);

    nv.utils.windowResize(chart.update);
    return chart;
}); 
```

我将非常感谢任何帮助，因为这让我好几天摸不着头脑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:22:07.197

解决了我的问题。问题是为 Y 轴提供的数据是字符串，这使得所谓的数字加法变成了字符串连接：

```
"123" + "902" + "384" + "382" == "123902384382"; // (instead of 1791) 
```

我所做的是遍历数据并将字符串转换为数字。

# networking - 请启用 TCP/IP 协议。Unity3D

> ID：13095031
> 
> 赞同：3
> 
> 时间：2012-10-26T22:01:27.467
> 
> 标签：networking, tcp, protocols, unity3d

我正在尝试连接到 MS SQL 数据库。这是我的代码：

```
void Start ()
    {
        string connectionString =
            "Server=MyServer;" +
            "Database=Data;" +
            "User ID=User;" +
            "Password=psd;" +
            "Integrated Security=SSPI";
               Debug.Log("conn string");

    List<int> result = new List<int>();

        string sql = "SELECT RecordCount FROM MainDB";
        IDbConnection dbcon;
        dbcon = new SqlConnection (connectionString);
        dbcon.Open ();
        IDbCommand dbcmd = dbcon.CreateCommand ();
              dbcmd.CommandText = sql;
        IDataReader rdr = dbcmd.ExecuteReader ();

        while (rdr.Read()) {
            result.Add ((int)rdr.GetValue(0));
        }

        Debug.Log("get"); 
        // clean up
        rdr.Close ();
        rdr = null;
        dbcmd.Dispose ();
        dbcmd = null;
        dbcon.Close ();
    dbcon = null;
    } 
```

我从 mono-project 复制了大部分代码。我在防火墙规则中允许了 UDP 端口 1434 和 mono.exe。我仍然收到消息：

> NotImplementedException：Mono 不支持连接到 SQL Server 的名称管道或共享内存。请启用 TCP/IP 协议。System.Data.SqlClient.SqlConnection+SqlMonitorSocket.DiscoverTcpPort (Int32 timeoutSeconds) System.Data.SqlClient.SqlConnection.DiscoverTcpPortViaSqlMonitor (System.String ServerName, System.String InstanceName) System.Data.SqlClient.SqlConnection.ParseDataSource (System.String theDataSource, System.Int32& thePort, System.String& theServerName) System.Data.SqlClient.SqlConnection.Open () ConnectToDB.Start () (在 Assets/ConnectToDB.cs:33)

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:49:58.883

如果您需要帮助建立 TCP/IP 套接字，您可以使用流行的第三方解决方案，例如[SmartFox Server](http://www.smartfoxserver.com/)或[Photon 。](http://www.exitgames.com/)

# ios - 临时同步不适用于重置设备

> ID：13095036
> 
> 赞同：1
> 
> 时间：2012-10-26T22:02:08.040
> 
> 标签：ios, restore, adhoc, udid

我不知道是否有人可以帮助我，我们以前的首席开发人员已经离开，现在我们需要将与许多 IOS 设备关联的 Apple ID 更改为更通用的公司 ID。

他的帐户因我们的开发人员计划成员资格而被撤销，因此我生成了一个新的配置文件和证书，以便继续我们的临时测试。

一切似乎都很好；但是，与他的帐户关联的 3 台设备将不再通过 iTunes 同步。

对于这些，我已通过 iTunes 将它们恢复到原始设置，重命名设备并将其与我们新的通用公司 Apple ID 相关联。

它们的 UDID 与以前保持一致，并且 .ipa 为与不同 Apple ID 关联的其他设备生成的工作。所以新证书似乎是有效的。

以前的帐户会以某种方式挥之不去吗？

设备的 UDID 是否也与 Apple ID 相关联？

为了真正擦除 IOS 设备，我需要执行一些特定的程序吗？

我是否必须重新注册这些设备的 UDID？

如果有人知道问题可能是什么，我将非常感谢一些线索

# path - 开发和实时服务器的路径

> ID：13095041
> 
> 赞同：0
> 
> 时间：2012-10-26T22:02:43.500
> 
> 标签：path, live, development-environment, mamp, absolute

我正在寻找一些建议，我目前在 locahost 上使用 MAMP，并且我的所有网站都在 htdocs 文件夹中。我主要使用 Codenighter，因此在添加链接、图像等路径时，我使用`<?php echo base_url(); ?>`它非常适合在实时和开发中使用相同的代码。

我想知道如何从 javascript 文件中链接到文件并在将站点连接到实时服务器时保留路径？

我无法输入绝对路径，例如`/controller/`这在 MAMP htdocs 文件夹中不起作用 - 我必须`/mysite/controller/`改用。

在两台服务器上工作时，有没有一种很好的方法来保留路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T08:30:11.270

您应该在 Apache 中设置虚拟主机。到目前为止，最简单的方法是获取 MAMP pro 或获取 VirtualHost X，后者是我使用的。您当然可以在 Apache 配置中设置虚拟主机，但 VirtualHost X 增加了便利因素。

因此，例如，如果我的实时站点是 example.com，那么我会在本地设置一个名为 example.local 的虚拟主机。

# java - Java XML UTF-8 不一致

> ID：13095042
> 
> 赞同：3
> 
> 时间：2012-10-26T22:02:44.360
> 
> 标签：java, utf-8

我在将 UTF-8 文档正确转换为 HTML 时遇到问题。

当代码在 Solaris 上的 glassfish 服务器中运行时，会产生无效结果。

在我的 Windows 测试环境上运行时，结果是有效的。

两种环境都使用 Java 1.6.0_27

我包括两者的代码 - 我没有看到任何相关的区别。

应用服务器测试的输出如下（如果 UTF-8 经过此过程）：

```
<CityName>Ð Ð¾Ð²Ð¾Ñ Ð¸Ð±Ð¸Ñ€Ñ Ðº</CityName>

<CityName>Ð&#157;Ð¾Ð²Ð¾Ñ&#129;Ð¸Ð±Ð¸Ñ&#128;Ñ&#129;Ðº</CityName> 
```

请注意，第二个有几个实体编码，而第一个是纯 UTF-8。编码错误。

首先 - 应用服务器代码（记录器是一个 log4j 记录器 - 它在 test13 上显示良好的结果，在 test14 上显示不好）：

```
logger.info("===test13:"+descr+req);

DocumentBuilderFactory domFactory = DocumentBuilderFactory .newInstance();
domFactory.setNamespaceAware(true);
DocumentBuilder domBuilder = domFactory.newDocumentBuilder();
Document doc = domBuilder.parse(new InputSource(new StringReader(req)));

logger.info("===test14:"+XmlHelper.domToString(doc)); 
```

然后，测试代码 - “out”在两种情况下都显示了良好的数据：

```
PrintStream out = new PrintStream(System.out, true, "UTF-8");
String inmsg = TestRvcMessage.readUtfFile(fname);
inmsg = inmsg.trim();
out.println("INPUT:"+inmsg);

DocumentBuilderFactory domFactory = DocumentBuilderFactory.newInstance();
domFactory.setNamespaceAware(true);
DocumentBuilder domBuilder = domFactory.newDocumentBuilder();
Document doc = domBuilder.parse(new InputSource(new StringReader(inmsg)));

out.println("OUTPUT:"+xmlHelper.domToString(doc); 
```

# facebook - 使用 fql -facebook C# sdk 获取friend_count

> ID：13095043
> 
> 赞同：1
> 
> 时间：2012-10-26T22:02:45.263
> 
> 标签：facebook

我正在使用 facebook 和 C# sdk 开发一个 windows phone 7 应用程序，用于从 facebook 朋友那里获取信息。我被困在某个地方...

我可以用这个在 foreach 循环中获得朋友计数，但是当我从另一个函数调用该函数时，它返回 0。为什么？

```
 private object GetFriendsCount() {
        var fb = new FacebookClient(_accessToken);
        var query = string.Format("SELECT friend_count FROM user WHERE uid={0}", "me()");
        // var query1 = string.Format("SELECT uid,name,pic_square FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1={0})", "me()");
        fb.GetAsync("fql", new { q = query });
        object returnVal = 0;
        fb.GetCompleted += (o, e) =>
        {
            if (e.Error != null)
            {
                Dispatcher.BeginInvoke(() => MessageBox.Show(e.Error.Message));
                return;
            }

            var result = (IDictionary<string, object>)e.GetResultData();
            var data = (IList<object>)result["data"];
            foreach (var comment in data.Cast<IDictionary<string, object>>())
            {
                returnVal = comment["friend_count"];
               // Dispatcher.BeginInvoke(() => MessageBox.Show(returnVal.ToString()));
            }

        };

        return returnVal;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T05:35:15.247

`SELECT friend_count, name FROM user WHERE uid = me()`

应该给你你正在寻找的东西。但是，根据我的经验，如果您想汇总数据，则最好使用循环。该`friend_count`列将为您提供一个总数，但也包括非活动、禁用或放弃的帐户。

# r - 从 R markdown 内部输出 HTML 代码

> ID：13095045
> 
> 赞同：5
> 
> 时间：2012-10-26T22:02:47.777
> 
> 标签：r, markdown, knitr

在我的代码中，我正在检查一个条件，并且我希望 R markdown 在该条件为 TRUE 时显示图像。这是我所拥有的

```
```{r}
if (LOGICAL.Condition)
  {
     cat("<img src='http://imgc.allpostersimages.com/images/P-473-488-90/60/6071/B4XD100Z/posters/now-stop-and-hammer-time.jpg'>")
  }
``` 
```

在我的 HTML 页面上显示的 R 的输出是如下文本，但我希望它是图像

```
## <img src='http://imgc.allpostersimages.com/images/P-473-488-90/60/6071/B4XD100Z/posters/now-stop-and-hammer-time.jpg'> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-26T22:09:08.207

选项`asis`将简单地将 R 的原始结果写入输出文档（这是您想要的）。否则它会把它扔到`##`前面。

```
```{r results="asis"}
if (LOGICAL.Condition)
  {
     cat("<img src='http://imgc.allpostersimages.com/images/P-473-488-90/60/6071/B4XD100Z/posters/now-stop-and-hammer-time.jpg'>")
  }
``` 
```

# ruby - Ruby Prawn 将元数据添加到模板

> ID：13095055
> 
> 赞同：2
> 
> 时间：2012-10-26T22:03:47.653
> 
> 标签：ruby, metadata, prawn

我似乎无法将 METADATA 设置为基于模板生成的 pdf。这是不允许的还是我做错了什么。

这是代码

```
pdf = Prawn::Document.new(:template => "sample.pdf",
                          :info => {
                            :Title        => "Sample METADATA",
                            :Author       => "Me",
                            :Subject      => "Not Working",
                            :CreationDate => Time.now,
                          }) 
```

谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:37:23.917

也许这是因为这个问题而发生的： [https ://github.com/prawnpdf/prawn/issues/417](https://github.com/prawnpdf/prawn/issues/417)

我认为它已在22天前解决并合并到master。

# xcode - UICollectionViewCell 将找不到自定义单元来加载图像

> ID：13095058
> 
> 赞同：1
> 
> 时间：2012-10-26T22:03:52.567
> 
> 标签：xcode, xcode4, xcode4.5, uicollectionview, uicollectionviewcell

我正在使用带有自定义单元格的 UICollectionView，其中包含一个图像和一个标签。我通过 XML 加载数据，但我使用多线程来绑定单元格中的图像数据。我没有将图像设置为在 cellForItemAtIndexPath 上加载，而是从这里加载描述。

我的问题是图像最初没有加载。当我滚动时，它会加载，因为我在 scrollView 中有一个方法：

```
- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate { 
if (!decelerate)
{
    [self loadImagesForOnscreenCells];
}}
- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView
{      
    [self loadImagesForOnscreenCells];   
} 
```

我使用以下内容加载描述：

```
- (UICollectionViewCell *)collectionView:(UICollectionView *)cv cellForItemAtIndexPath:(NSIndexPath *)indexPath; { 
Cell *cell = [cv dequeueReusableCellWithReuseIdentifier:kCellID forIndexPath:indexPath];
cell.label.text = xmlPhotosVideosRecordPointer.title; 
```

这是 loadImagesForOnscreenCells：

```
- (void)loadImagesForOnscreenCells
{
if ([xmlPhotosVideosRecords count] > 0)
{
    NSArray *visiblePaths = [newsTable indexPathsForVisibleItems];
    for (NSIndexPath *indexPath in visiblePaths)
    {            
        xmlPhotosVideosRecord *xmlPhotosVideosRecordPointer = [self.xmlPhotosVideosRecords objectAtIndex:indexPath.row];

        if (!xmlPhotosVideosRecordPointer.thumbImage)
        {
            [self startIconDownload:xmlPhotosVideosRecordPointer forIndexPath:indexPath];
        }
    }  
}
} 
```

话虽这么说，有没有办法在 UICollectionView didLoad 时委托？这样，我可以使用 [self loadImagesForOnscreenCells]; 刷新屏幕上的图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T21:56:10.720

我想通了，它的工作原理！利用：

```
- (void)collectionView:(UICollectionView *)collectionView didEndDisplayingCell:(UICollectionViewCell *)cell forItemAtIndexPath:(NSIndexPath *)indexPath 
```

# c++ - 向量 作为返回值和参数

> ID：13095062
> 
> 赞同：0
> 
> 时间：2012-10-26T22:04:22.050
> 
> 标签：c++, function, vector

我想为我的程序创建一些模块。我想调用一个函数并将一个向量作为参数传递。返回值也应该是一个向量。

我的代码看起来像这样

```
main.cpp
//BlueSmart.cpp : Definiert den Einstiegspunkt für die Konsolenanwendung.
#include "stdafx.h"

#define WIN32_LEAN_AND_MEAN

using namespace std;

#pragma comment(lib, "Irprops.lib")

BLUETOOTH_FIND_RADIO_PARAMS m_bt_find_radio = {
sizeof(BLUETOOTH_FIND_RADIO_PARAMS)
};

BLUETOOTH_RADIO_INFO m_bt_info = {
sizeof(BLUETOOTH_RADIO_INFO),
0,
};

BLUETOOTH_DEVICE_SEARCH_PARAMS m_search_params = {
sizeof(BLUETOOTH_DEVICE_SEARCH_PARAMS),
1,
0,
1,
1,
1,
15,
NULL
};

BLUETOOTH_DEVICE_INFO m_device_info = {
sizeof(BLUETOOTH_DEVICE_INFO),
0,
};

HANDLE m_radio = NULL;
HBLUETOOTH_RADIO_FIND m_bt = NULL;
HBLUETOOTH_DEVICE_FIND m_bt_dev = NULL;

int wmain(int argc, wchar_t **args) {

while(true) {
m_bt = BluetoothFindFirstRadio(&m_bt_find_radio, &m_radio);

do {
  localBluetoothDevices ();

  m_search_params.hRadio = m_radio;
  ::ZeroMemory(&m_device_info, sizeof(BLUETOOTH_DEVICE_INFO));
  m_device_info.dwSize = sizeof(BLUETOOTH_DEVICE_INFO);
  m_bt_dev = BluetoothFindFirstDevice(&m_search_params, &m_device_info);

  vector<wstring> vec;
  int m_device_id = 0;
  do {
   wostringstream tmp;
   ++m_device_id;
   //Something like this <----------------------------------------
   externBluetoothDevices (vec);
   //Something like this <----------------------------------------

      wprintf(L"********************************************************************** \n");
   wprintf(L"\tDevice %d:\r\n", m_device_id);
   wprintf(L"\t\tName: %s\r\n", m_device_info.szName);
   wprintf(L"\t\tAddress: %02x:%02x:%02x:%02x:%02x:%02x\r\n", m_device_info.Address.rgBytes[0], m_device_info.Address.rgBytes[1], m_device_info.Address.rgBytes[2], m_device_info.Address.rgBytes[3], m_device_info.Address.rgBytes[4], m_device_info.Address.rgBytes[5]);
   wprintf(L"====================================================================== \n");

   for (int i = 0; i < 6; i++) {
    tmp << hex << m_device_info.Address.rgBytes [i];
    if (i < 5)
     tmp << L':';
   }

   vec.push_back(tmp.str());

  } while(BluetoothFindNextDevice(m_bt_dev, &m_device_info));

  BluetoothFindDeviceClose(m_bt_dev);
  //Sleep(10*1000*60);
  Sleep(10000);

} while(BluetoothFindNextRadio(&m_bt_find_radio, &m_radio));
BluetoothFindRadioClose(m_bt);
}
return 0;
}

//Lokal verfügbare bzw. angeschlossene Bluetooth-Devices
void localBluetoothDevices (){
  int m_radio_id = 0;
  m_radio_id++;
  BluetoothGetRadioInfo(m_radio, &m_bt_info);      
  //Lokaler Bluetoothadapter
  wprintf(L"====================================================================== \n");
  wprintf(L"Local Device Nr. %d\n", m_radio_id);
  wprintf(L"\tName: %s\r\n", m_bt_info.szName);
  wprintf(L"\tAddress: %02x:%02x:%02x:%02x:%02x:%02x\r\n",      m_bt_info.address.rgBytes[0], m_bt_info.address.rgBytes[1], m_bt_info.address.rgBytes[2], m_bt_info.address.rgBytes[3], m_bt_info.address.rgBytes[4], m_bt_info.address.rgBytes[5]);

 }

//Extern verfügbare bzw. Bluetooth-Devices
 vector<wstring> externBluetoothDevices (vector<wstring> &vec){
return vec;
 } 
```

标准数据文件

```
 #pragma once

 #include "targetver.h"

 #include <stdio.h>
 #include <tchar.h>
 #include <winsock2.h>
 #include <windows.h>
 #include <stdlib.h>
 #include <bthdef.h>
 #include <BluetoothAPIs.h>
 #include <iostream>
 #include <vector>
 #include <algorithm>
 #include <string>
 #include <sstream>
 #include <iomanip>
 #include <conio.h>

 void localBluetoothDevices ();
 vector<wstring> externBluetoothDevices (vector<wstring>); 
```

它说向量不是已知类型。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:25:46.747

在 stdafx.h 中替换

```
vector<wstring> externBluetoothDevices (vector<wstring>); 
```

和

```
std::vector<std::wstring> externBluetoothDevices (std::vector<std::wstring>); 
```

基本上问题在于，尽管您`using namespace std;`在看到 using 声明之前放入了不计入头文件的 cpp 文件。

另请注意，您在 cpp 文件中的定义是不同的。在 cpp 文件中，您有一个参考

```
vector<wstring> externBluetoothDevices (vector<wstring>&); 
```

决定你真正想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T00:50:11.990

你应该传递一个向量的指针。

# javascript - 我的可观察数组没有更新，我这样做正确吗？

> ID：13095067
> 
> 赞同：0
> 
> 时间：2012-10-26T22:05:17.200
> 
> 标签：javascript, knockout.js

```
function AppViewModel() {
self.tagbuttons=ko.observableArray([
    {shotbar:false, frozendrinks: false, livemusic: false, patio:false, food:false}
    ]);

self.toggleTag = function(data,event) {
    var id = event.target.id;

    self.tagbuttons()[0][id] = !self.tagbuttons()[0][id];
    console.log(self.tagbuttons()[0][id]);
    if(self.tagbuttons()[0][id] == true)
    {
        $(event.target).closest('li').addClass("active");
        console.log(event.target.id+":"+"active");
    }
    else
    {
        $(event.target).closest('li').removeClass("active");
        console.log(event.target.id+":"+"inactive");}
    }
}

ko.applyBindings(new AppViewModel()); 
```

我的 console.log(self.tagbuttons()[0][id]) 输出正确的 bool 值，但我的数组中的值没有更新。这是我的html：

```
 <div data-bind="text: tagbuttons()[0].shotbar"></di> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T07:43:58.530

这是来自 ko 文档的引用：

> **关键点：一个 observableArray 跟踪数组中有哪些对象，而不是那些对象的状态**
> 
> 简单地将一个对象放入 observableArray 并不能使该对象的所有属性本身都可观察。当然，如果您愿意，您可以使这些属性可观察，但这是一个独立的选择。observableArray 只跟踪它持有的对象，并在添加或删除对象时通知侦听器。

因此，当您更改数组项的值时，不会通知剔除。您可以使用`valueHasMutated`函数手动通知订阅者：

```
self.tagbuttons()[0][id] = !self.tagbuttons()[0][id];
self.tagbuttons.valueHasMutated(); 
```

或使用以下方法将项目包装在数组中`observalbe`：

```
self.tagbuttons = ko.observableArray([
ko.observable({
    shotbar:false, 
    frozendrinks: false, 
    livemusic: false, 
    patio:false, 
    food:false})
    ]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:23:24.000

在声明 MyAppViewModel 和加载 UI 之后，您需要应用 KO 绑定：

```
$(document).ready(function(){
    ko.ApplyBindings(new MyAppViewModel())?  
}); 
```

除非您应用 KO 绑定，否则在视图模型之外不会发生任何事情。

# google-apps-script - 如何使用 google-spreadsheet-api 在 google 电子表格中隐藏单个工作表？

> ID：13095071
> 
> 赞同：1
> 
> 时间：2012-10-26T22:05:38.107
> 
> 标签：google-apps-script, google-sheets, google-spreadsheet-api

我希望能够以编程方式隐藏我的 Google 电子表格中的某些工作表。因此，当共享用户登录电子表格时，某些数据范围、工作表可能会从他们的视图中隐藏。通过这种方式，我可以根据查看者的电子邮件地址显示所有、部分或不显示电子表格数据。

使用 SpreadsheetApp 类和方法保护工作表并根据查看者的电子邮件地址保护某些工作表，我对此毫无问题。但似乎找不到任何支持工作表隐藏方法或属性的类或方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T03:28:31.617

有一个隐藏/显示工作表的[开放增强请求](http://code.google.com/p/google-apps-script-issues/issues/detail?id=995&q=hide%20sheet&colspec=Stars%20Opened%20ID%20Type%20Status%20Summary%20Component%20Owner)；您可能想给它加星标以保持更新。

# asp.net - 网站访问者无法访问保存到文件系统的上传图像 (404)

> ID：13095072
> 
> 赞同：0
> 
> 时间：2012-10-26T22:05:47.540
> 
> 标签：asp.net, iis, file-upload, http-status-code-404

所以我使用 ASP.Net 的 FileUpload 控件将图像上传并保存到我的 Web 应用程序中的文件系统。最初不允许保存图像，因为 IIS 无权访问该文件夹，通过右键单击该文件夹，转到安全选项卡，选择 IIS 用户并授权写入和修改来解决此问题。

网站用户现在可以上传图像，并且该图像已成功保存在文件夹中。同一个网站也显示相同的图像，但只要浏览器请求图像，服务器就会响应 404（未找到）错误。我可以远程桌面进入服务器，导航到 Windows 资源管理器中的文件夹，右键单击上传的图像，然后在浏览器中打开它们。然后图像完美显示。

因此，它们只是无法通过外部网站访问者访问。

我猜我需要对 IIS 中的权限或设置进行一些更改，但我想检查的唯一一件事是 IIS 用户在该文件夹中具有读取权限，确实如此。

还有其他想法吗？谢谢！

# facebook-like - Facebook Like 按钮不显示

> ID：13095074
> 
> 赞同：-1
> 
> 时间：2012-10-26T22:05:56.240
> 
> 标签：facebook-like

我正在开发一个 RPG 页面，我们的 Like 按钮消失了。

我使用生成器创建代码，并尝试了不同的版本，但它们都不起作用。我还使用了 LINTER，它没有显示任何错误。我问过我的供应商，他们找不到任何错误。

该页面是[http://www.wodgotham.com/](http://www.wodgotham.com/)并且在 Twitter 链接上方的 Facebook 主页链接旁边应该是 Like 按钮。

我查看了代码并盯着自己瞎了眼......我不知道该怎么办

建议和帮助将受到高度评价

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:13:31.330

您没有使用生成器中的代码 - 您正在尝试加载

`http://connect.facebook.net/us_US/all.js`- us_US 不是有效的语言环境

我浏览器上的 Javascript 控制台将错误显示为来自该 URL 的 500 错误，单击该 URL 时会显示 /* Not a valid locale。*/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:16:53.917

我相信伊吉是正确的。“en_US”将是有效的语言环境。

# php - Yii 将上传的文件保存为 base64 字符串

> ID：13095075
> 
> 赞同：4
> 
> 时间：2012-10-26T22:05:59.380
> 
> 标签：php, yii

我正在尝试使用 base64 将上传的照片保存在我的数据库中，但我无法获取数据：

形式：

```
<?php $form=$this->beginWidget('CActiveForm',
            array(
                    'id' => 'upload-form',
                    'enableAjaxValidation' => false,
                    'htmlOptions' => array('enctype' => 'multipart/form-data'),
            ));?>
<?php echo $form->fileField($model, 'attachment');?> 
```

控制器：

```
$model->attributes=$_POST['Post'];
                    //gives me the filename
        $model->attachment=CUploadedFile::getInstance($model,'attachment'); 
```

如何获取内容以便进行编码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T22:12:05.243

像这样做：

```
$model->attributes=$_POST['Post'];

//gives me the filename
$tmpfile = CUploadedFile::getInstance($model,'attachment');

$tmpfile_contents = file_get_contents( $tmpfile->tempName );

$model->attachment = base64_encode($tmpfile_contents); 
```

# java - 哈希映射 , 为 ArrayList 添加基于 Key 的新值

> ID：13095076
> 
> 赞同：1
> 
> 时间：2012-10-26T22:06:13.767
> 
> 标签：java, arraylist, hashmap

我已经得到了一个测试驱动的开发问题（我需要根据提供的 junit 方法使其工作）基于实现一个使用字符串作为键和 ArrayLists 作为值的 HashMap。密钥需要能够支持一个或多个对应的值。我需要以一种可以从散列中添加或减去值的方式设置我的方法，然后查看散列的更新内容。我的斗争是从下面显示的单元方法（执行 myClass 及其 addMethod 方法）中获取信息，并将其正确放入哈希中。

```
void add() {
    myClass = new MyClass("key1", "value1");
    myClass.addingMethod("blargh", "blarghvalue");
    myClass.addingMethod("blargh2", "uglystring");
    myClass.addingMethod("blargh", "anotherstring");
    //and so on and so on............ 
```

对于我的最终结果，当我打印出 myClass 的结果时，我需要看到类似：{blargh=[blarghvalue, anotherstring], blargh2=uglystring}

我需要能够添加到这个，以及删除值。

我对 java 集合很陌生（显然）。如果它们只有 1 对 1 的关系，并且哈希图是 1:1，我可以让它们工作。所以像这样一个非常简单的addingMethod：

```
public void addingMethod(String key, String value) {
    hashMap.put(key, value); 
```

将得到一个字符串字符串哈希图，但当然，如果我用一个新的键值对重用一个键，原来的键值就会被踩上并消失。但是，当涉及到动态处理哈希映射和数组列表时，并且超出了 1:1 的键：值关系，我迷失了方向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:08:33.177

您需要的是`Map<String, List<String>>`在里面放置检查条目是否存在，如果是，则添加到列表中。

像下面这样声明你的地图

```
Map<String, List<String>> map = new HashMap<String, List<String>>(); 
```

请注意，的语法`adding Method`应该与`put`

```
public List<String> put(String key, String value) {
    if (!map.containsKey(key)) {
        return map.put(key, new ArrayList<String>());
    }
    List<String> list = map.get(key);
    list.add(value);
    return map.put(key, list);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T22:08:39.113

听起来您需要一个[`MultiMap`](https://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multimap)，这是由 Google 的 great 提供的[`Guava libraries`](http://code.google.com/p/guava-libraries/)：

> *类似于 Map 的集合，但可以将多个值与单个键相关联。如果您使用相同的键但值不同的两次调用 put(K, V)，则多重映射包含从键到两个值的映射。*

# user-interface - 来自另一个类的java空指针

> ID：13095078
> 
> 赞同：0
> 
> 时间：2012-10-26T22:06:20.613
> 
> 标签：user-interface, null, nullpointerexception

我有 2 个类，一个叫 Gui，一个叫 Listener。

侦听器的代码是：

```
 package app.assignment.u0961036.core;

import net.jini.space.JavaSpace;

public class Listener extends Thread {

private JavaSpace space;
private Gui list;

    public void run() {
        space = SpaceUtils.getSpace("localhost");
        System.out.println("In Listener");
        int i = 0;
        while(true){
            i++;
            try{
                Message mTemplate = new Message();
                System.out.println("Listner: template created");
                Message nextMessage = (Message)space.take(mTemplate,null,Long.MAX_VALUE);
                System.out.println("Listner: Message created");
                String message = nextMessage.message;
                System.out.println("Listner: message= "+message);
                list.newMessage(message);
                }  catch ( Exception e) {
                e.printStackTrace();
                }
            if(i % 10 == 0){
                System.out.println("I = "+i);
            }
        }
    }

    public static void listen() {

        (new Listener()).start();

    } 
```

Gui中的相关代码是：

```
 public void newMessage(String message){
    System.out.println("in new message");
    chatTextArea.append(" Someone Says: " + message + "\n" );

} 
```

当侦听器中的代码运行时，我从以下行得到一个空指针：

```
list.newMessage(message); 
```

我不确定为什么，因为创建了对象。如果您还没有猜到，GUI 也会在 Gui 类中创建。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:14:57.260

```
package app.assignment.u0961036.core;

import net.jini.space.JavaSpace;

public class Listener extends Thread {

private JavaSpace space;
space = new JavaSpace();
private Gui list; 
list = new Gui(); 

public void run() {
    space = SpaceUtils.getSpace("localhost");
    System.out.println("In Listener");
    int i = 0;
    while(true){
        i++;
        try{
            Message mTemplate = new Message();
            System.out.println("Listner: template created");
            Message nextMessage = (Message)space.take(mTemplate,null,Long.MAX_VALUE);
            System.out.println("Listner: Message created");
            String message = nextMessage.message;
            System.out.println("Listner: message= "+message);
            list.newMessage(message);
            }  catch ( Exception e) {
            e.printStackTrace();
            }
        if(i % 10 == 0){
            System.out.println("I = "+i);
        }
    }
}

public static void listen() {

    (new Listener()).start();

} 
```

我认为上面的代码应该可以解决您的问题。在 Java 中，您通过声明、实例化和初始化对象来创建对象。阅读[此处](http://docs.oracle.com/javase/tutorial/java/javaOO/objectcreation.html)了解更多信息。

# symfony - 刷新实体管理器时 Symfony2 / Doctrine2 抛出索引错误

> ID：13095083
> 
> 赞同：14
> 
> 时间：2012-10-26T22:07:13.757
> 
> 标签：symfony, orm, doctrine-orm, unit-of-work

这里涉及三个实体：**Deployment**、**DeploymentStep**和**DeploymentStatusLog**。我将从粘贴这些类的相关定义开始

**src/My/Bundle/Entity/Deployment.php**

```
<?php

namespace My\Bundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;
use Doctrine\ORM\PersistentCollection;

/**
 * @ORM\Table(name="deployment")
 * @ORM\Entity()
 */
class Deployment
{
  /**
   * Status Log Entries for this deployment
   *
   * @var \Doctrine\ORM\PersistentCollection
   *
   * @ORM\OneToMany(targetEntity="DeploymentStatusLog", mappedBy="deployment", cascade={"persist","remove"})
   * @ORM\OrderBy({"created_at"="DESC"})
   */
  protected $status_logs;

  /**
   * @var \Doctrine\ORM\PersistentCollection
   *
   * @ORM\OneToMany(targetEntity="DeploymentStep", mappedBy="deployment", cascade={"persist","remove"})
   * @ORM\OrderBy({"sequence" = "ASC"})
   */
  protected $steps;

  public function __construct()
  {
    $this->status_logs     = new ArrayCollection();
    $this->steps           = new ArrayCollection();
  }

  /**
   * Add status_logs
   *
   * @param DeploymentStatusLog $statusLogs
   */
  public function addDeploymentStatusLog(DeploymentStatusLog $statusLogs)
  {
      $this->status_logs[] = $statusLogs;
  }

  /**
   * Add steps
   *
   * @param DeploymentStep $steps
   */
  public function addDeploymentStep(DeploymentStep $steps)
  {
    $this->steps[] = $steps;
  }

  // ... 
} 
```

**src/My/Bundle/Entity/DeploymentStep.php**

```
<?php

namespace My\Bundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Table(name="deployment_step")
 * @ORM\Entity()
 */
class DeploymentStep
{
  /**
   * @var Deployment
   *
   * @ORM\ManyToOne(targetEntity="Deployment", cascade={"all"})
   * @ORM\JoinColumn(name="deployment_id", referencedColumnName="id")
   * @Gedmo\SortableGroup
   */
  private $deployment;

  /**
   * Set deployment
   *
   * @param Deployment $deployment
   */
  public function setDeployment(Deployment $deployment)
  {
    $this->deployment = $deployment;
  }

  // ...
} 
```

**src/My/Bundle/Entity/DeploymentStatusLog.php**

```
<?php

namespace My\Bundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Table(name="deployment_status_log")
 * @ORM\Entity()
 */
class DeploymentStatusLog
{
  /**
   * @var Deployment
   *
   * @ORM\ManyToOne(targetEntity="Deployment", cascade={"all"})
   * @ORM\JoinColumn(name="deployment_id", referencedColumnName="id", nullable=false)
   */
  protected $deployment;

  /**
   * Set deployment
   *
   * @param Deployment $deployment
   */
  public function setDeployment( Deployment $deployment)
  {
      $this->deployment = $deployment;
  }

  // ...
} 
```

现在，当我尝试同时为所有这三个实体创建全新的记录时，问题就出现了。在控制器中：

```
$em = $this->getDoctrine()->getEntityManager();

$deployment = new Deployment();

$form = $this->createForm(new DeploymentType($em), $deployment);

if ($request->getMethod() == 'POST')
{
  $form->bindRequest($request);

  if ($form->isValid())
  {
    $codeStep = new DeploymentStep();
    $codeStep->setDeployment( $deployment );
    // Other setters on DeploymentStep

    $deploymentStatusLog = new DeploymentStatusLog();
    $deploymentStatusLog->setDeployment( $deployment );
    // Other setters on DeploymentStatusLog

    $deployment->addDeploymentStep( $codeStep );
    $deployment->addDeploymentStatusLog( $deploymentStatusLog );

    $em->persist( $deployment );
    $em->flush();
  }
} 
```

当 UnitOfWork 处理时会发生什么，它会抛出一个看起来很奇怪的异常，抱怨未定义的索引：

> /project/vendor/doctrine/lib/Doctrine/ORM/UnitOfWork.php 第 2252 行中的 /project/vendor/symfony/src/Symfony/Component/HttpKernel/Debug /ErrorHandler.php:67

现在，如果我先持久化/刷新**部署**实体，*然后*持久化/刷新关联，它就会成功。

因此，虽然我*可以*这样做以使应用程序的这一部分功能化，但感觉有点*不对*，因为这个过程应该是原子的，而且这就是事务查询的重点。

有什么线索吗？

*   Symfony 2.0.15
*   教义 2.1.7
*   PHP 5.3.3
*   MySQL 5.1.52
*   阿帕奇 2.2.15

## 编辑

请求的完整堆栈跟踪

```
 exception 'ErrorException' with message 'Notice: Undefined index: 000000004081f5f9000000005f1dbbfc in /project/vendor/doctrine/lib/Doctrine/ORM/UnitOfWork.php line 2252' in /project/vendor/symfony/src/Symfony/Component/HttpKernel/Debug/ErrorHandler.php:67
Stack trace:
#0 /project/vendor/doctrine/lib/Doctrine/ORM/UnitOfWork.php(2252): Symfony\Component\HttpKernel\Debug\ErrorHandler->handle(8, 'Undefined index...', '/mnt/hgfs/mount...', 2252, Array)
#1 /project/vendor/doctrine/lib/Doctrine/ORM/Query.php(321): Doctrine\ORM\UnitOfWork->getEntityIdentifier(Object(My\Bundle\Entity\Deployment))
#2 /project/vendor/doctrine/lib/Doctrine/ORM/Query.php(274): Doctrine\ORM\Query->processParameterValue(Object(My\Bundle\Entity\Deployment))
#3 /project/vendor/doctrine/lib/Doctrine/ORM/Query.php(243): Doctrine\ORM\Query->processParameterMappings(Array)
#4 /project/vendor/doctrine/lib/Doctrine/ORM/AbstractQuery.php(607): Doctrine\ORM\Query->_doExecute()
#5 /project/vendor/doctrine/lib/Doctrine/ORM/AbstractQuery.php(413): Doctrine\ORM\AbstractQuery->execute(Array, 1)
#6 /project/vendor/gedmo-doctrine-extensions/lib/Gedmo/Sortable/SortableListener.php(344): Doctrine\ORM\AbstractQuery->getResult()
#7 /project/vendor/gedmo-doctrine-extensions/lib/Gedmo/Sortable/SortableListener.php(133): Gedmo\Sortable\SortableListener->getMaxPosition(Object(Doctrine\ORM\EntityManager), Object(Doctrine\ORM\Mapping\ClassMetadata), Array, Object(My\Bundle\Entity\DeploymentStep))
#8 /project/vendor/gedmo-doctrine-extensions/lib/Gedmo/Sortable/SortableListener.php(100): Gedmo\Sortable\SortableListener->processInsert(Object(Doctrine\ORM\EntityManager), Array, Object(Doctrine\ORM\Mapping\ClassMetadata), Object(My\Bundle\Entity\DeploymentStep))
#9 /project/vendor/doctrine-common/lib/Doctrine/Common/EventManager.php(64): Gedmo\Sortable\SortableListener->onFlush(Object(Doctrine\ORM\Event\OnFlushEventArgs))
#10 /project/vendor/doctrine/lib/Doctrine/ORM/UnitOfWork.php(280): Doctrine\Common\EventManager->dispatchEvent('onFlush', Object(Doctrine\ORM\Event\OnFlushEventArgs))
#11 /project/vendor/doctrine/lib/Doctrine/ORM/EntityManager.php(334): Doctrine\ORM\UnitOfWork->commit()
#12 /project/src/My/Bundle/Controller/DeploymentController.php(214): Doctrine\ORM\EntityManager->flush()
#13 [internal function]: My\Bundle\Controller\DeploymentController->createAction(Object(My\Bundle\Entity\Release), Object(Symfony\Component\HttpFoundation\Request))
#14 /project/vendor/bundles/JMS/SecurityExtraBundle/Security/Authorization/Interception/MethodSecurityInterceptor.php(73): ReflectionMethod->invokeArgs(Object(My\Bundle\Controller\DeploymentController), Array)
#15 /project/app/cache/dev/classes.php(9391) : eval()'d code(1): JMS\SecurityExtraBundle\Security\Authorization\Interception\MethodSecurityInterceptor->invoke(Object(JMS\SecurityExtraBundle\Security\Authorization\Interception\MethodInvocation), Array)
#16 [internal function]: {closure}(Object(My\Bundle\Entity\Release), Object(Symfony\Component\HttpFoundation\Request))
#17 /project/app/cache/dev/classes.php(3925): call_user_func_array(Object(Closure), Array)
#18 /project/app/cache/dev/classes.php(3895): Symfony\Component\HttpKernel\HttpKernel->handleRaw(Object(Symfony\Component\HttpFoundation\Request), 1)
#19 /project/app/cache/dev/classes.php(4899): Symfony\Component\HttpKernel\HttpKernel->handle(Object(Symfony\Component\HttpFoundation\Request), 1, true)
#20 /project/app/bootstrap.php.cache(551): Symfony\Bundle\FrameworkBundle\HttpKernel->handle(Object(Symfony\Component\HttpFoundation\Request), 1, true)
#21 /project/web/app_dev.php(18): Symfony\Component\HttpKernel\Kernel->handle(Object(Symfony\Component\HttpFoundation\Request))
#22 {main} 
```

## 编辑 2

根据要求创建操作的完整代码

```
/**
 * @Route("/create/{id}", name="deployment_create_id")
 * @ParamConverter("release", class="MyBundle:Release")
 * @Method({"POST","GET"})
 * @Secure(roles="ROLE_DEPLOYMENT_PLANNER")
 * @Template()
 */
public function createAction( Release $release, Request $request )
{
  $em           = $this->getDoctrine()->getEntityManager();
  $sessionUser = $this->get('security.context')->getToken()->getUser();

  $deployment = new Deployment();
  $deployment->setRelease( $release );
  $deployment->setAuthor( $sessionUser );

  $form = $this->createForm(new DeploymentType($em), $deployment);

  if ($request->getMethod() == 'POST')
  {
    $form->bindRequest($request);

    if ($form->isValid())
    {
      $codeStep = new DeploymentStep();
      $codeStep->setDeployment( $deployment );
      $codeStep->setSequence( 0 );
      $codeStep->setTitle( "Update Code" );
      $codeStep->setDetails( "Update codebase per the plan's specifications" );
      $codeStep->setDeploymentStepType(
          $em->getRepository('MyBundle:DeploymentStepType')->findOneBy(
              array( 'name' => DeploymentStepType::TYPE_OTHER )
          )
      );

      $deploymentStatusLog = new DeploymentStatusLog();
      $deploymentStatusLog->setDeployment( $deployment );
      $deploymentStatusLog->setUser( $sessionUser );
      $deploymentStatusLog->setNotes( 'New Deployment Created' );
      $deploymentStatusLog->setDeploymentStatus(
          $em->getRepository('MyBundle:DeploymentStatus')->findOneBy(
              array( 'title' => DeploymentStatus::STATUS_NEW )
          )
      );

      $deployment->addDeploymentStep( $codeStep );
      $deployment->addDeploymentStatusLog( $deploymentStatusLog );

      try {
        $em->persist( $deployment );
           $em->persist( $codeStep );
           $em->persist( $deploymentStatusLog );
        $em->flush();

        return $this->redirectSuccess(
            'Deployment created.'
          , $release->getRouteName()
          , $release->getRouteParameters()
        );
      }
      catch ( \Exception $e )
      {
        $this->setFlashErrorMessage( 'Error saving deployment.' );
      }
    }
  }

  return array(
      'release' => $release
    , 'form'    => $form->createView()
  );
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-11-19T23:46:49.883

*这不是一个“解决方案”，但我希望它为其他人提供更多故障排除信息。*

[在遵循Doctrine 对批量处理批量插入的建议](http://doctrine-orm.readthedocs.org/en/latest/reference/batch-processing.html)时，我遇到了同样的错误。仅供参考，这是来自控制器（不是像其他答案提到的生命周期事件）。

## 教义推荐的方法

```
$batchSize = 20;
for ($i = 1; $i <= 10000; ++$i) {
    $user = new CmsUser;
    $user->setStatus('user');
    $user->setUsername('user' . $i);
    $user->setName('Mr.Smith-' . $i);
    $em->persist($user);
    if (($i % $batchSize) === 0) {
        $em->flush();
        $em->clear(); // Detaches all objects from Doctrine!
    }
}
$em->flush(); //Persist objects that did not make up an entire batch
$em->clear(); 
```

当我使用类似于上面推荐的代码时，它会在大约 2000 次插入后失败并出现相同的错误。

## 更改持久化顺序

我坚持 10,000 个实体的顺序没有任何区别。如果我坚持、刷新和清除每个循环（不理想，但我尝试过），这没有什么区别。

## 删除清除

如果我只是`$em->clear()`在 $batchSize 检查中注释掉并仅在循环完成后才明确，那么它就会超时：

```
Fatal error: Maximum execution time of 30 seconds exceeded in /var/www/core/cms/vendor/doctrine/orm/lib/Doctrine/ORM/UnitOfWork.php on line 541 
```

所以我`set_time_limit(3600)`在脚本上放了一个以防止超时，它不再给出错误，但内存不足：P

这表明`$em->clear()`在循环内执行时会出现问题。这[与其他问题是一致的](https://stackoverflow.com/questions/11392931/undefined-index-error-upon-em-clear-in-symfony2)。不幸的是，如果没有`$em->clear()`，您会很快耗尽内存。

## 禁用事件监听器

另一个答案提到事件侦听器可能会导致此问题，因此我按照建议禁用了它们：

```
foreach ($em->getEventManager()->getListeners() as $event => $listeners) {
    foreach ($listeners as $listener) {
        $em->getEventManager()->removeEventListener($event, $listener);
    }
} 
```

但这也不起作用......虽然看起来这可能是问题，不知何故，这实际上并没有成功地禁用它们。

## 验证架构

我还验证了我的架构：

```
php app/console doctrine:schema:validate 
```

并且没有错误报告。

```
[Mapping]  OK - The mapping files are correct.
[Database] OK - The database schema is in sync with the mapping files. 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-05-22T20:50:47.473

我遇到了同样的问题，就我而言，这是因为我在生命周期事件中做一个实体`remove`。根据我在 UnitOfWork 逻辑中的理解，您不能在该事件中调用 flush 。这样做将刷新任何从第一次调用刷新时仍待刷新的操作，这些动作已经被事件中的刷新调用删除。在弄清楚这一点后，我找到了 Doctrine 手册的这一部分，证实了我的怀疑：`flush``postRemove`

[http://docs.doctrine-project.org/en/latest/reference/events.html#postupdate-postremove-postpersist](http://docs.doctrine-project.org/en/latest/reference/events.html#postupdate-postremove-postpersist)

您认为单独刷新每个步骤是一种不好的方法是正确的，但是如果您不使用 LifeCycle 事件，那么我不确定是什么导致了您的特定问题。我能够通过`$oid`在`executeDeletions`. `UnitOfWork.php`我注意到同一个 id 被反复删除，一旦从 取消设置`$this->entityIdentifiers`，后续删除将失败。

我的解决方案是简单地对事件中的每个 ID 进行编目`postRemove`，然后实际删除`postFlush`事件中的实体，这不是生命周期事件，因此可以进行后续持久化操作：

[http://docs.doctrine-project.org/en/latest/reference/events.html#lifecycle-events](http://docs.doctrine-project.org/en/latest/reference/events.html#lifecycle-events)

我相信你已经继续前进了，但万一其他人遇到这个问题......

# javascript - 在 mouseleave 上停止动画

> ID：13095087
> 
> 赞同：0
> 
> 时间：2012-10-26T22:07:37.593
> 
> 标签：javascript, jquery

我环顾四周**，**找不到一个好的具体答案。我的问题是，当它`.mouseenter(function(){ })`被触发并且`.mouseleave(function(){ })`在它完成两个动画后立即被触发时，我希望`.mouseleave(function(){ })`阻止`.mouseenter(function(){ })`它完成它的动画。

这是我目前拥有它的一个[jsfiddle 。](http://jsfiddle.net/6nyEZ/1/)

**html:**

```
<div id="header">
  <div id="header-align">

  </div>
</div>​ 
```

**CSS：**

```
#header {
  width: 100%;
  height: 200px;
  position: fixed;
  top: -170px;
}

#header #header-align {
  width: 400px;
  height: 100%;
  border: 1px dotted #000;  
  margin: 0 auto 0;   
} 
```

**jQuery**

```
​$("#header").mouseenter(function(){

  $(this).animate({ top: -20 }, {
    duration: 'slow',
    easing: 'easeOutBack'
  })

});

$("#header").mouseleave(function(){

  $(this).animate({ top: -170 }, {
     duration: 'slow',
     easing: 'easeOutBack'
  })

}); 
```

我在想类似`bind(function(){ })`或类似的东西，`.stopPropagation()`但找不到好的答案

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T22:10:15.500

您是否尝试添加一个`.stop()`？

```
$(this).stop().animate({ top: -170 }, {
     duration: 'slow',
     easing: 'easeOutBack'
  }) 
```

[jsFiddle](http://jsfiddle.net/TheJoeFletch/JWurE/)

您也可以考虑使用`.hover()`.

```
​$("#header").hover(function(){
  $(this).stop().animate({ top: -20 }, {
    duration: 'slow',
    easing: 'easeOutBack'
  })
},
function(){
  $(this).stop().animate({ top: -170 }, {
     duration: 'slow',
     easing: 'easeOutBack'
  })
}); 
```

# css - Jquery Div快速加载

> ID：13095088
> 
> 赞同：0
> 
> 时间：2012-10-26T22:07:52.747
> 
> 标签：css

我正在使用 javascript 加载一个 div，我的问题是它正在瞬间扩展。我正在尝试在似乎逐帧移动的地方进行平滑扩展。我打开了 Jquery，在其中我将我的信息更改为 Jquery 问题是我回到了添加 display:none 后刚刚出现的内容之一；符合我的风格。如果我删除 display:none ，那么我的所有内容都会显示在页面加载上，而不是在点击之后。如果有人有解决方案，将不胜感激。谢谢。我的代码如下

```
 <style>
  j { width:150px;
      display:none;
       }
  </style>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>
  <button>Toggle</button>
  <br />

  <j>
My Content Goes here.

  </j>
<script>
    $("button").click(function () {
      $("j").slideToggle("slow");
    });
</script> 
```

# ruby-on-rails - 使用 Gerrit 部署 Ruby on Rails 数据库

> ID：13095090
> 
> 赞同：7
> 
> 时间：2012-10-26T22:07:59.410
> 
> 标签：ruby-on-rails, ruby, database, version-control

我正在考虑在我的下一个项目中使用 Ruby on Rails。了解 Rails 网站的部署很容易理解（听起来我将使用[Phusion Passenger](https://www.phusionpassenger.com/)）

但现在我正在尝试找出数据库。我看到很多关于“数据库迁移”的信息，它允许我*使用 ruby​​ 代码更新数据库*。我还看到我被允许创建这些迁移的**up**和**down变体。**

但是，我只能理解这如何在一个方向上干净利落地工作。想象一下，如果我突然说*“颜色列不能为空”*。因此，**up**将使其成为必需并为所有 NULL 条目提供默认值。但是**下跌**会怎么做呢？如果您关心它与它的启动方式相同，则不能只将默认值设置回 NULL。

这对于发布到生产来说并不重要。这可能只是在一个方向（**向上**方向）完成。*但是，我想在允许签入之前使用 Gerrit 进行代码审查以及设置一个机器人来运行构建......*

那怎么可能呢？从一个代码审查到下一个，构建服务器将检查新的代码集并运行迁移？但是当这种情况发生时，它甚至不会保留以前的迁移代码，那么它如何运行**向下**的步骤呢？作为一个更简单的示例，我看不到如何检查旧版本的代码并向后“db migrate”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:29:28.100

是的，您不能签出旧版本的代码，然后从新版本的代码运行向下迁移。在回滚到旧代码之前，您需要运行向下迁移。

在很多很多情况下，向下迁移是不切实际或不可能的。这不一定是坏事。这只是意味着您已经定义了一个“不归路”，您将无法将数据库恢复到更早的状态。

通过简单地破坏该表或删除该列，可以轻松地逆转创建表或添加列等迁移。但是，如果您正在做一些更复杂的事情，例如添加默认值或移动数据，那么您可以告诉 Rails 无法逆转这种迁移：

```
def down
  raise ActiveRecord::IrreversibleMigration
end 
```

我建议 Gerrit 永远不要对数据库做任何假设。每次部署新版本时，它都应该从一个新数据库开始，并运行`db:migrate`以运行所有迁移。您可以使用像[factory_girl](https://github.com/thoughtbot/factory_girl)这样的 gem来使用演示数据填充您的应用程序以进行测试。

# linker - Compaq Visual Fortran - 链接 .LIB 文件期间崩溃

> ID：13095093
> 
> 赞同：0
> 
> 时间：2012-10-26T22:08:09.050
> 
> 标签：linker, fortran, intel-fortran

当我使用 Compaq Visual Fortran 编译时，我得到了这些错误（当它启动链接器进程时），这些错误应该位于我认为我添加到工作区的 .lib 文件中：

```
X30XFULL.OBJ : error LNK2001: unresolved external symbol _BCON@4
X30XFULL.OBJ : error LNK2001: unresolved external symbol _RCON@16 
```

根据我在哪里搜索过，看起来 Compaq Visual Fortran（版本 6，仅供参考）找不到库文件......

我的主要问题是，我该如何使用它们？可能还有其他丢失的文件吗？这是我尝试过的：

*   右键单击->在 FileView 窗口中添加文件
*   在项目->设置下，单击链接选项卡，在输入类别下，在对象/库模块 (bprop.lib rprop.lib) 下添加库文件，并让附加库路径指向文件所在的位置。我也在“资源”选项卡下进行了此操作，并且它显示“其他资源包含目录”，我放置了这些文件所在的目录。
*   为了覆盖我的基础，我还将这些文件放在项目工作区文件的位置，将生成编译的可执行文件的位置，以及几乎任何我能想到的 CVF 可能会查找这些文件的位置。

**一点背景：**

我有这个在 90 年代最后一次编译的 Fortran 可执行文件。根据我的研究，它是 16 位编译的，无法在 64 位机器上运行。

至少从我们可以收集到的情况来看，原始代码具有 16 位编译库。如果没有原始编译器，我们无法弄清楚如何查看或使用它们。我们还有一个（半）等效的库文件，它实际上是一个 .FOR 文件。就我们所知，BPROP.FOR 和 BPROP.LIB 可能是同一个文件（它们位于同一个源代码区域）。如果我们使用 BPROP.FOR 文件，该程序可以编译，但我们会遇到问题，我们已经追溯到该文件中使用/收集/处理的信息的结果。

但是，我们确实有 32 位版本（我们认为）是相同的 .lib 文件。因此，我们正在尝试使用它，这是用于编译 Fortran 可执行文件的内容，这会导致上述错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T13:41:15.327

至少对我来说找到了答案。我不知道如果其他人找到这些答案会很容易推断，但这就是我解决它的方法。

对于旧的 Fortran 库，我所要做的就是将它们添加到包含所有不同 fortran 文件（.FOR 等）的 FileList 视图中。我不必像我提到的那样在设置中添加这些库，但这也可以。除此之外，我不需要添加任何额外的声明或类似的东西。

我们确实发现调用这些 .LIB 文件的有问题的函数（BCON 和 RCON）需要一个额外的参数。我发现这一点的唯一方法是检查使用这些库的其他源代码，所以如果有人像我一样被卡住，那将是一个很好的起点。或者，如果您可以在十六进制编辑器中阅读 .lib 文件，您可以制作函数及其参数。

当然，如果您有上述参数的原始源代码，那就更好了。:)

# java - ViewStub - 显示具有动态内容的视图

> ID：13095094
> 
> 赞同：1
> 
> 时间：2012-10-26T22:08:12.280
> 
> 标签：java, android, android-layout

这可能是一个愚蠢的问题，如果是这样，我很抱歉；我对Android相当陌生。

但无论如何 - 我有一个工作的 ViewStub，它会根据不同的情况被不同的布局所取代。当我调用 setLayoutResource() 方法，然后将 setVisibility 设置为 VISIBLE 时，它可以正常显示正确的布局。但是，我现在需要在这个视图中显示为动态的一些内容（即，我需要通过代码设置它，而不仅仅是显示静态布局）。

这甚至可能吗？setLayoutResource() 方法只需要一个静态布局资源 ID，但我需要该布局 XML 文件才能使其 TextViews 包含来自我已准备好使用的某些代码的非静态文本。如果可能，应该如何处理？我理解拥有一个 Java 类并膨胀 XML 以将其自身附加到它以更新字段的概念，但我看不出这与我手头的代码有什么关系，因为它只是我需要设置的布局资源 int对于 ViewStub 中的 setLayoutResource() 方法。

如果需要，我可以发布现有代码，但我不确定它是否能做更多的事情，而不是把帖子弄得乱七八糟。供参考 - 我只有一个带有一些 TextView 的简单布局 XML 文件，然后是包含 ViewStub 的主 XML，它是自定义对话框的一部分。用户能够实例化 Dialog 并设置布局，进而设置 ViewStub 的布局。这是我需要使用动态内容的布局。

任何建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T19:05:41.650

事实证明，这并不太难实现。我只需要在对 ViewStub 进行膨胀后使用 TextView 布局的 ID 来获取实际 TextView 的副本，然后我就可以轻松地将它们的文本设置为我想要的任何类型的动态/自定义文本。

我还需要注释掉通过 .VISIBLE 调用显示它的代码，而是执行以下操作（.inflate() 代码行完成与将其设置为 VISIBLE 相同的事情）：

```
 View inflatedView = dialog.myStubView.inflate();
 TextView myTextView = (TextView) inflatedView.findViewById(R.id.my_text_view);
 myTextView.setText("Dynamic/Custom Text"); 
```

# java - java将未知长度的字符串分成每3部分

> ID：13095097
> 
> 赞同：-1
> 
> 时间：2012-10-26T22:08:31.943
> 
> 标签：java, string, split

```
public static void main(String[] args) {
    String brandmodel="VolkswagenGolf";
    String [] splitedstring=new String[13]
        //how to insert every 3 letters in splitedstring array 
```

}

我想要的是将上面的字符串分成每 3 个字母。例如，我想从上面的字符串中保存下一个 Vol，ksw，age，nGo，如果我在这里阅读了一些疯狂的代码，但我不理解它们，我想要最简单的方法。我还没学过正则表达式

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T22:14:02.507

1.  计算您将拥有的零件数量并创建一个数组：

    ```
    int parts = (string.length() + 2) / 3;
    String splitted[] = new String[parts]; 
    ```

2.  填充数组，使用[`String.substring(int, int)`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#substring%28int,%20int%29)：

    ```
    for (int i = 0; i < parts; ++i)
    {
        int x = i * 3;
        splitted[i] = string.substring(x, Math.min(string.length(), x + 3));
    } 
    ```

Substring 使用索引从另一个字符串中取出一个字符串。问题是如果你取一个超出字符串的范围，就会抛出异常。所以我所做的是通过使用将 endIndex 限制为字符串长度`Math.min(int, int)`。它总是返回两个传递值中的最小值。

这个出错的例子，没有 Math.min()：

```
String str = "test";
String substr = str.substring(2, 9); 
```

这失败（异常），因为 9 超出了`str`. `str`仅 4 个字符长。因此，有效的 startIndices 是：{0, 1, 2, 3}，有效的 endIndices 在这种情况下是：{0, 1, 2, 3, 4}。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T22:15:31.097

您可以使用正则表达式后视匹配最后一个匹配加上任何 3 个字符：

```
String[] splitString = brandmodel.split("(?<=\\G...)"); 
```

正则表达式`(?<=\G...)`匹配一个空字符串，该字符串具有最后一个匹配项，`(\G)`后跟三个字符`(...)``((?<= ))`

输出：

```
[Vol, ksw, age, nGo, lf] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T22:14:54.623

不需要“疯狂的代码”，这是一个相对简单的：

```
String[] res = new String[(s.length()+2)/3];
for (int i = 0 ; i != res.length ; i++) {
    res[i] = s.substring(3*i, Math.min(3*i+3, s.length()));
} 
```

在 ideone：[链接](http://ideone.com/J6QhRp)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T22:24:36.877

它适用于所有长度的字符串

```
 String brandmodel="VolkswagenGolf";
       List <String> splitedstring = new ArrayList<String>();
       int i = 0;
       while(brandmodel.length() > 2 )
       {
           splitedstring.add(brandmodel.substring(0,3));
           brandmodel = brandmodel.substring(3);
       }
       if(brandmodel.length() > 0)
           splitedstring.add(brandmodel); 
```

# javascript - JS：跨浏览器兼容性 - 我的 JS 在 chrome 中工作，而不是在 FF 中

> ID：13095105
> 
> 赞同：2
> 
> 时间：2012-10-26T22:08:58.140
> 
> 标签：javascript, ajax, firefox, jquery

我有一些 JS 可以在 Chrome 中运行，但不能在 FireFox 中运行，而且我在 JS 方面经验不足，无法在没有帮助的情况下解决此问题。

我`localhost`在我的开发机器上***和***它的部署位置（在我们的内部 Intranet 上）对其进行了测试......两种情况下的结果相同。

在 chrome 中，它完全符合我的期望。它从 API 中异步捕获一个 JSON 对象，并将其飞溅给用户。
在 FF 中，它将用户带到目标 API URL。没有*“异步”*。

我还可以做哪些调整来支持 FF？
（幸运的是，FF & Chm 是我唯一***需要***编写代码的两个）。

任何和所有的帮助将不胜感激。

```
var submit_map_url = 'blahblah';  // dynamically generated by PHP
$('#mapper_form').submit(function() { 
    event.preventDefault();
    $.ajax({
        type:'POST',
        url: submit_map_url, 
        data:$('#mapper_form').serialize(),
        success: function(response) {
            var response = $.parseJSON(response);

            if(response.status == 'failure'){
                alert(response.message); 
            }else{
                var doRedirect = true;

                $('#splash').fadeIn(800, function() {  // fade in
                    window.setTimeout ( function() {  // start a timer for auto redirect
                        $('#splash').fadeOut(1000, function() {  // fade out
                            if(doRedirect) window.location = redirect_target;  // then redirect
                        }) }
                    , 4000);  // 
                 });

                $('#splash').click(function(){  // on click
                    doRedirect = false;  // cancel the redirect request
                     $(this).fadeOut(700,function() {});  // and fade out
                 });

                 $('#countdown').countdown({until: +5, format: 'S'});

            }  // end IF/ELSE
        }  // end success:
    });  // ajax
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:11:01.287

将`event`参数添加到您的提交功能。`$('#mapper_form').submit(function(event) {`

`window.event`当您在事件处理程序中时，Chrome 有一个全局事件对象。

# ruby-on-rails - 默认情况下显示嵌套属性的表单字段

> ID：13095106
> 
> 赞同：2
> 
> 时间：2012-10-26T22:08:58.713
> 
> 标签：ruby-on-rails, ruby, nested-forms, nested-attributes

我正在尝试构建一个具有嵌套属性的表单，在我看来，`views/pedidos/new.html.erb`我想默认显示一组字段到**pessoa**和一个到**produto**。在我使用过的**PedidosController**中，它运行良好，我的表单呈现**pessoa**字段，但对于**我**尝试过的产品，它说****`pessoa = @pedido.build_pessoa`****`produto = @pedido.build_produtos``undefined method 'build_produtos' for #<Pedido id: nil, created_at: nil, updated_at: nil>`********

 ******这是我的模型和控制器（使用脚手架生成）

```
class Pedido < ActiveRecord::Base
  attr_accessible :pessoa_attributes, :produtos_attributes

  has_one :pessoa
  has_many :produtos

  accepts_nested_attributes_for :pessoa, :produtos, allow_destroy: true
end

class Pessoa < ActiveRecord::Base
  attr_accessible :email, :nome, :telefone

  belongs_to :pedido
end

class Produto < ActiveRecord::Base
  attr_accessible :nome, :quantidade

  belongs_to :pedido
end

class PedidosController < ApplicationController

  def new
    @pedido = Pedido.new
    1.times do
      pessoa = @pedido.build_pessoa
      produto = @pedido.build_produtos
    end

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @pedido }
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:13:24.713

如果关系是`has_many`，您可以像这样构建它：`@pedido.produtos.build`

对于 a`has_one`前缀，就像你所做的那样，带有`build_[association]`.

有点棘手，但一旦你知道发生了什么就很简单。******

# android - Android 从家庭启动器启动主要活动

> ID：13095108
> 
> 赞同：0
> 
> 时间：2012-10-26T22:09:32.053
> 
> 标签：android, android-activity, launch

在我的应用程序中，我有一个从应用程序抽屉启动应用程序时启动的主要活动。在应用程序中有另一个可以从主要活动启动的活动 B。

如果我在活动 B 中按主页返回主页，如果我再次通过应用程序抽屉启动我的应用程序，则将启动活动 B 而不是主活动。

即使用户在活动 B 中按下主页而不使用 noHistory，有没有办法只启动主要活动？

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T00:04:48.360

我为活动 B 设置了一个单独的 android:taskAffinity

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:19:03.857

您只是不想在 B 中保持状态，在 Activity B 的 onStop 方法上，只需调用 finish();

# objective-c - 可达性飞行模式 (3G) 与 Wifi

> ID：13095109
> 
> 赞同：0
> 
> 时间：2012-10-26T22:09:47.803
> 
> 标签：objective-c, ios, 3g, reachability

我知道如果手机可以访问 Wifi 或 3G 网络，将提供可达性代码。

但是，如果手机有 3G 和 Wifi，则可达性代码默认显示手机有 Wifi，我无法检测到 3G 网络是否启用（飞行模式打开或关闭）。

我需要特别了解当 Wifi 也打开时 3G 模式是打开还是关闭。

这是代码：

```
Reachability *reachability = [Reachability reachabilityForInternetConnection];
[reachability startNotifier];

NetworkStatus status = [reachability currentReachabilityStatus];

NSLog(@"status: %u", status);

if(status == NotReachable)  //status = 0
{
    //No internet
    NSLog(@"nothing is reachable");
}
if (status == ReachableViaWiFi) //status = 1
{
    //WiFi
    NSLog(@"Wifi is available");
}
if (status == ReachableViaWWAN) //status = 2
{
    //3G
    NSLog(@"3G is available");
}
NSLog(@"%@", s); 
```

即使 3G 和 Wifi 都打开，基本上状态也会返回 1。

这可能吗？

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:37:46.903

**更新：**目前看来这是不可能的。但是，您可以尝试以下代码，以防万一。

**Code1：**只是一个想法。这个没试过。

```
if (status == ReachableViaWiFi) //status = 1
{
    if ([[UIApplication sharedApplication] canOpenURL:[NSURL URLWithString:@"tel://"]]) {
        NSLog(@"Wifi and 3G are available");
    } else {
        NSLog(@"Wifi is available, but 3G is not available");
    }
} 
```

**代码 2：**

对于内部应用程序，您可以使用[这里提到的这种方法，](https://stackoverflow.com/a/10588802/1730272)

**注意：**这使用私有API，因此如果您在应用商店应用程序中使用它，您的应用程序将被拒绝。

复制粘贴以下内容到`RadioPreferences.h`

```
@protocol RadiosPreferencesDelegate
-(void)airplaneModeChanged;
@end

@interface RadiosPreferences : NSObject
{
    struct __SCPreferences *_prefs;
    int _applySkipCount;
    id <RadiosPreferencesDelegate> _delegate;
    BOOL _isCachedAirplaneModeValid;
    BOOL _cachedAirplaneMode;
    BOOL notifyForExternalChangeOnly;
}

- (id)init;
- (void)dealloc;
@property(nonatomic) BOOL airplaneMode;
- (void)refresh;
- (void)initializeSCPrefs:(id)arg1;
- (void)notifyTarget:(unsigned int)arg1;
- (void)synchronize;
- (void *)getValueForKey:(id)arg1;
- (void)setValue:(void *)arg1 forKey:(id)arg2;
@property(nonatomic) BOOL notifyForExternalChangeOnly; // @synthesize notifyForExternalChangeOnly;
@property(nonatomic) id <RadiosPreferencesDelegate> delegate; // @synthesize delegate=_delegate;

@end 
```

然后尝试如下。

```
id rp = [[RadiosPreferences alloc] init];
BOOL status = [rp airplaneMode];
return status; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T23:02:58.460

目前没有办法在 iPhone 上按照 Apple 指导方针并且不使用其私有 API 来执行此操作。

# if-statement - Mathematica If-then 与蕴含

> ID：13095112
> 
> 赞同：7
> 
> 时间：2012-10-26T22:09:59.150
> 
> 标签：if-statement, wolfram-mathematica, boolean-logic

我是 Mathematica(v8) 的新手，正在用它来编程命题逻辑。

我想知道 the`If`和`Implies`运营商之间有什么区别。例如，
both `If[p,q]`and `Implies[p,q]`return `q`for `p=True`（如预期的那样）。

但是当我尝试获取 SatisfiabilityInstances 时，我得到以下信息：

```
SatisfiabilityInstances[If[p, q], {p, q}]
(*
  {{True, True}}
*) 
```

除非我要求更多实例：

```
SatisfiabilityInstances[If[p, q], {p, q}, All] 
```

> SatisfiabilityInstances::boolv: "If[p,q] 不是布尔值 {False,True}。

然而：

```
SatisfiabilityInstances[Implies[p, q], {p, q}, All] 
```

返回预期的：

```
(* {{True, True}, {False, True}, {False, False}} *) 
```

是什么导致输出出现这种差异？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T22:25:45.217

这就是它所说的——`If`不是布尔值，即它不仅返回真或假。试试看`If[False,True]`，你不会看到任何结果。 `If[a,b,c,d]`可以返回任何 b、c 和 d，不仅是布尔值，例如`If[True,2]`返回 2。因此，`If`它是用于分支（甚至是功能性的），而`Implies`它是一个普通的布尔函数。

PS啊，`Implies`还可以退货`2`。所以不同的是`If[False,True]`什么都不返回，所以`SatisfiabilityInstances`函数找不到真正的区域。

PPS 更准确地说，如果 is 的第一个参数`If[]`则`False`返回它的第三个参数。当它不存在时，它什么也不返回。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T22:31:16.967

你可以试试：

```
SatisfiabilityInstances[If[p, q, Not[q]], {p, q}, All] 
```

# java - 如何获取字符串的一部分？

> ID：13095117
> 
> 赞同：-1
> 
> 时间：2012-10-26T22:10:40.207
> 
> 标签：java, directory, substring, parent

我正在尝试返回文件/目录的目录及其目录。

例如，我有`"this/iss/the/root/assets/images/icons/parent"`哪个是`"this/iss/the/root/assets/images/icons/parent/child`.

这将是根路径`this/iss/the/root`，我想获取根路径之后的所有内容：`assets/images/icons/examples'`即给定根，我如何提取根之后但子之前的所有目录？

我努力了：

```
parent.lastIndexOf(root) 
```

但它给了我整个父路径。

抱歉，这很啰嗦。我已经花了很长时间盯着我的代码不停地盯着我的代码，现在已经快午夜了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:22:47.970

尝试这个：

```
 String str = "this/iss/the/root/assets/images/icons/parent/child";
    String root = "this/iss/the/root/";
    String rootRegex = root.replace("/", "\\/"); //escape fwd slashes
    String ptrnStr = "^" + rootRegex + "(.+)child\\Z";
    java.util.regex.Pattern ptrn = Pattern.compile(ptrnStr); 

    java.util.regex.Matcher mtchr = ptrn.matcher(str);

    if(mtchr.find())
    {
        String between = mtchr.group(1);
        System.out.println("FOUND:  " + between);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:15:13.763

一种方法可能是这样，[`#lastIndexOf()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#lastIndexOf%28java.lang.String%29)结合[`#substring()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#substring%28int%29)：

```
String parent = "this/iss/the/root/assets/images/icons/parent";
if (parent.lastIndexOf("root/") != -1) {
    child = parent.substring(parent.lastIndexOf("root/") + 5);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T22:17:44.063

我会推荐你​​使用 Java 7 中的[Path](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html)类。

您只需打电话`path.getParent()`或打电话`iterator()`并工作，直到您到达目的地。

# python - 从 excel 中阅读专栏并做特定的数学运算

> ID：13095120
> 
> 赞同：0
> 
> 时间：2012-10-26T22:10:50.067
> 
> 标签：python, excel, testing

我有一个 27 列的 excel 文件。我想编写一个 python 代码，它逐列读取并将最后 5 个值存储在 coloum 中，这将对它们进行数学方程。

到目前为止我有这个：

```
from math import tan

#Write Header
#outFile.write('Test Name,X+ avg,X+ std,X+ count,X- avg,X- std,X- count,X angle,Y+ avg,Y+ std,Y+ count,Y- avg,Y- std,Y- count,Y angle\n')

#for line in inFile:

if 1==1:

    line = [1,2,38.702,37.867,35.821, 44, 49,55,65,20,25,28,89.]

    line0= len(line)
    print "the list size"
    print line0

    line1 = len(line) -5  #takes the overall line and subtracts 5\. 
    print "the is the start of the 5 #'s we need"
    print line1 #prints the line

    d= line[line1:line0]       #pops all the values from in the line (..)
    print "these are the 5 #'s we need"
    print d

    lo=min(d)
    hi=max(d)

    print "the lowest value is"
    print lo

    print "the highest value is"
    print hi

    average1 = float (sum(d))/ len(d)   #sum
    print "the average of the values is"
    print average1 
```

“line = [1,2,38.702,37.867,35.821, 44, 49,55,65,20,25,28,89.]”部分我希望 python 自动读取列，存储最后 5 个值和做上面的数学分析。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:21:20.490

您可能想要使用[openpyxl](http://packages.python.org/openpyxl/)之类的库，这是文档中有关如何访问某些单元格的示例。

```
columnOffset = 2 # column offset is (the letter as a number - 1), a = (1-1), b = (2-1)
rowOffset = 35 # row offset is row number - 1

wb = load_workbook('test.xlsx')
ws = wb.get_active_sheet()
for column in ws.columns[columnOffset:27]: #because you have 27 columns to parse through
    for rowIndex, cell in enumerate(column[-5:]):
        if rowIndex >= rowOffset:
            print cell.value 
```

不幸的是，openpyxl 对列的支持并不好，因此您必须使用索引来获取列。

**基于 xlrd**

```
import xlrd

wb = xlrd.open_workbook("C:\Users\Asus\Desktop\herp.xls")
sh = wb.sheet_by_name(u'A Snazzy Title')

for index in xrange(2, 4):
    lastFive = sh.col_values(index, start_rowx=59, end_rowx=64)
    print lastFive 
```

看起来 xlrd 将整个电子表格视为 2D 列表，因此请记住从 0 开始索引。是的，xlrd 完全基于 python。

*感谢[Alexis](https://stackoverflow.com/users/699305/alexis)指出了这个模块。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T23:06:33.700

仅供参考，还有`xlrd`/ `xlwt`，来自 python-excel 项目（[http://www.python-excel.org/](http://www.python-excel.org/)）。不过，您还需要下载它。我从来没有使用过openpyxl，所以我不能说哪个更好。

# ruby-on-rails - 一个 select_tag 和多个 button_to 提交按钮

> ID：13095126
> 
> 赞同：1
> 
> 时间：2012-10-26T22:11:19.177
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我在同一页面上有一个 select_tag 和多个 button_to 按钮。我希望将 select_tag 中的参数用于几个按钮，是否有非表单方式来执行此操作？

我不想使用表单的原因有两个：1.按钮的数量是动态的2.按钮的定位不遵循表单结构（对象在顶部，提交在底部）

- 这是链接到其中一个按钮的创建方法之一

```
def create
  params[:options].each do |x|
    @connector = Connector.find_or_create_by_options_id_and_follow_id(x.id, current_user.follow(@product).id)
    @connector.save
  end
end 
```

我检查了，无论我在测试时选择了什么，这个 params[:options] 总是为零

```
<%= select_tag :options, options_for_select(@current_user_options.map {|p| [p.name, p.id] }), {:multiple => true} %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T07:15:45.640

button_to 方法实际上创建了一个具有提交按钮的表单，表单操作是您在 button_to 中提到的 url。因此，当您点击提交按钮时，显然选项参数将为 nil，因为 button_to 表单中没有数据

您可以使用表单本身，并且表单不强制，顶部有一个对象，下面有一个提交按钮。提交按钮只是提交表单而不管它在表单中的位置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:27:49.550

听起来您实际上需要表单中的第二个字段，即选择字段或单选按钮来选择您的操作。然后你有一个提交表单的按钮，然后在你的控制器中你可以解析这个新的操作字段并决定将用户重定向到哪里。

# ruby-on-rails - 单击按钮时如何在 Rails 中存储新条目？

> ID：13095127
> 
> 赞同：0
> 
> 时间：2012-10-26T22:11:30.023
> 
> 标签：ruby-on-rails

我的一个模型中有一个方法，当被调用时，它使用 twitter gem 获取一条推文并存储它的某些部分。我希望能够从 Web 界面触发该操作到我的应用程序。什么是 Rails 方式来实现这一点？我已经看到一些关于不从视图调用模型方法的引用，所以我应该以某种方式从控制器中执行此操作吗？

我的方法（相关模型是 Sponsor 和 Sponsortweet（所以我的模型名称不会与 Tweet 冲突，来自 gem）：

```
def create_tweet                                                                  
    tweet = Twitter.user_timeline(self.twitter).first                               
    self.sponsortweets.create!(content: tweet.text,                                 
                               tweet_id: tweet.id,                                  
                               tweet_created_at: tweet.created_at,                  
                               profile_image_url: tweet.user.profile_image_url,     
                               from_user: tweet.from_user,)                         
end 
```

编辑：

`tweet`我在赞助商控制器中创建了一个方法：

```
def tweet
  @sponsor = Sponsor.find(params[:id])
  @sponsor.create_tweet
end 
```

并将以下内容添加到我的 config/routes.rb:`match 'tweet', to: 'sponsors#tweet', via: :post`中。

以及我认为的以下代码（我正在使用haml）：

`= button_to :tweet, tweet_path(@sponsor)`

但是，单击该按钮会导致以下错误：

`Couldn't find Sponsor without an ID`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:21:20.673

您的视图应该有一个发布到控制器中特定路由的按钮。然后，该控制器将调用模型中的方法。不知道您的应用程序实际上是什么样子，这里有一个示例：

**编辑**包括更好的例子

视图（假设它是赞助商视图）：

```
<%= button_to :submit, tweet_path %> 
```

控制器：

```
def tweet
    Sponsor.create_tweet
end 
```

并且您的模型将保持不变，除非您将方法更改为类方法，如下所示：

```
def self.create_tweet
    ...your code here...
end 
```

由于这似乎与任何特定的赞助商无关，因此您将使用类方法，因此不需要类的实例来调用您的方法。也就是说，您似乎在某个时候想要一个类的实例......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:20:20.943

我很想听听其他人的回答，因为我现在想知道是否有这样一种方法可以完全绕过控制器。

但是，我对此的看法是，由于 Rails 是一个 MVC（模型视图控制器）框架，我认为 Rails 完成您正在考虑的事情的方式可能是简单地正常处理操作；通过**控制器**给**模型**。

如果我正确地假设您有一个按钮或链接，或者可能是一些 AJAX，它正在启动服务器端 Twitter 处理，那么我将为该 URL 设置您的路由以指向一个控制器操作方法，然后调用你的模型方法`myModel.create_tweet`。

# c# - Windows Presentation Foundation (WPF) 项目不支持网格

> ID：13095131
> 
> 赞同：20
> 
> 时间：2012-10-26T22:11:41.007
> 
> 标签：c#, .net, wpf, visual-studio

我正在学习如何创建`Class Library (Windows Store apps)`并使用`UserControl`模板向其中添加用户控件。

然后我`Grid`在随附的 XAML 中添加了一个标签。但是，标签带有蓝色曲线下划线，当我将鼠标悬停在标签上时

> Windows Presentation Foundation (WPF) 项目不支持网格

工具提示出现。

该库似乎构建没有错误。我已将该库添加到应用程序并在其代码中使用该控件。该应用程序也构建得很好。但是，当我运行应用程序时，我得到了`XamlParseException`异常。

我正在使用 Visual Studio 2012 RTM。库和应用程序都只引用两个标准程序集（`.NET for Windows Store apps`和`Windows`）。

我可能做错了什么，我应该如何修复图书馆？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2014-01-21T09:42:49.263

转到**“构建 > 配置管理器...”**并为您的所有项目创建一个新的**x86平台。**
它不必是活动的，您可以将其保留为**Any CPU**。

希望它适用于我的...

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2020-02-21T22:51:52.970

在我的情况下，我从调试切换到发布，然后返回，错误消失了。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-06-26T15:43:02.483

我最近遇到了同样的错误，在输出窗口中发现了以下内容：

`10>C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.WinFX.targets(268,9): error MC6000: Project file must include the .NET Framework assembly 'WindowsBase, PresentationCore, PresentationFramework' in the reference list.`

我的解决方案是将缺少的引用添加到我的项目中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-26T14:43:34.473

对我来说，它有助于将应用程序属性中的“目标框架”设置为 .NET 4.0

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-16T00:55:40.730

对于许多 XAML 资源错误，这似乎有点“包罗万象”。到目前为止，我发现了两个原因：

1.  在适当的上下文之外声明资源 - 例如直接在 UserControl 标记中，而不是在 UserControl.Resources 中。
2.  忘记为“不受支持的”类包含正确的命名空间。基本 ResourceDictionary 中的示例，未定义 sys 命名空间：

    ```
    <ResourceDictionary> 
        <sys:string>I'm not supported</sys:string>
    </ResourceDictionary> 
    ```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-02-24T04:42:54.690

我能够解决我的类似问题..

`UserControl is not supported in a Windows Presentation Foundation (WPF) project`

.. 通过删除 PresentationFramework 引用并通过 nuget 重新添加它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-28T13:28:59.337

[转发评论作为答案]

我能够毫无问题地完成这些步骤，而且您似乎也能够做到。也许还有其他一些无意的修改/设置？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-28T11:28:14.157

这是 xaml 让自己感到困惑。我有一个项目的错误，而不是另一个项目。在网格错误之前查看 xaml 的顶部，看看是否有对其他控件的引用。尝试进行会导致错误的修改并重建其中一个控件。然后将其放回成功构建的方式，看看这是否会使网格错误消失。（它对我有用）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-13T18:50:27.233

就像[Felix Ds answer](/questions/13095131/grid-is-not-supported-in-a-windows-presentation-foundation-wpf-project#answer-28745328)一样，我从 .csproj 文件中发现一个引用已被删除。显然用您需要的框架替换 3，或者使用项目属性来设置版本（我认为添加了这个参考）

[Evil Dog Pie](/questions/13095131/grid-is-not-supported-in-a-windows-presentation-foundation-wpf-project#answer-28745328)对我来说是第一步，因为出现了其他一些问题。输出日志中总是有一堆信息

```
<Reference Include="PresentationFramework">
  <RequiredTargetFramework>3.0</RequiredTargetFramework>
</Reference> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-09T17:54:54.397

此问题是由于您在项目中选择的 .NET 版本较低。

要解决此问题，请从向上菜单中选择项目，然后选择您的项目属性，然后从目标框架部分选择更高版本的 .NET Framework！

我希望你的问题得到解决。此致

# django - django 文件夹模型

> ID：13095132
> 
> 赞同：1
> 
> 时间：2012-10-26T22:11:48.510
> 
> 标签：django, file, model, directory

我想知道如何为用户、文件夹、文件创建 django 关系模型

一个用户可以有多个文件和文件夹。

一个文件夹可以有很多文件，但不能有文件夹 int 文件夹。

我尝试过类似的方法（我一天前开始学习 django）。

我从 djangobook 阅读了一些关于 ForeignKey 和 ManytoMany 关系的文档，但我不确定我是否理解所有这些。

## 用户模型

```
class User_t(models.Model):
    username = models.CharField(max_length=30)
    user_id = models.CharField(max_length=30)
    pcw = models.CharField(max_length=30)
    name = models.CharField(max_length=30)
    surname = models.CharField(max_length=30)
    mail = models.EmailField(max_length=50)
    validateMail =  models.BooleanField()
    birthday = models.DateTimeField(max_length=60)
    premium = models.BooleanField()
    premiumEnd = models.DateTimeField(max_length=10)
    totalUpload = models.CharField(max_length=15)
    avatar = models.URLField() 
```

## 档案模型

```
class FileItem(models.Model):
    file_id = models.CharField(max_length=30)
    file_name = models.CharField(max_length=75)
    date_upload = models.DateTimeField(max_length=10)
    data_size = models.CharField(max_length=75)
    key = models.CharField(max_length=75)
    owner_id = models.OneToManyField(User_t)
    login_accept = models.ManyToManyField(User_t)
    file_i = models.FileField(/mnt/test/) 
```

## 文件夹型号

```
class FolderItem(models.Model):
    folder_id = models.CharField(max_length=30)
    folder_name = models.CharField(max_length=75)
    data_size = models.CharField(max_length=75)
    key = models.CharField(max_length=75)
    owner_id = models.ForeignKey(User_t)
    login_accept = models.ManyToManyField(User_t)
    files = models.ForeignKey(FileItem) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:42:47.817

对于这种事情，您需要使用一对多的关系。所以这个想法是用户可以有很多文件夹，每个文件夹里面可以有很多文件。从您的示例代码中，您误解了如何对这些类型的关系进行编码。在我解释之前，让我们退后一步，弄清楚所有这些理想情况下应该如何存储在数据库中。

您将必须拥有三个表 - 用户、文件夹和文件。每个表里面会有很多行，使每一行独一无二的是我们称之为主键的东西。通常这是一个整数。因此，每个用户、文件夹和文件都将在自己的表中拥有自己唯一的主键。

为了将文件包含到文件夹中，每个文件都必须存储它所属的文件夹。这是使用外键的地方。在文件表中，将有一列`folder`使用外键指定该文件属于哪个文件夹。例如，考虑以下行：

```
id | folder | name | ...
---+--------+------+----
1  | 5      | foo  | ... 
```

这告诉您该文件属于具有主键的文件夹`5`。

因此，在一对多关系中，子表必须指定它属于哪个表，而不是像示例代码中那样指定父表/模型。

以下是您的代码的修复（除非我不知道它`logic_accept`的用途）：

```
class User_t(models.Model):
    username = models.CharField(max_length=30)
    user_id = models.CharField(max_length=30)
    pcw = models.CharField(max_length=30)
    name = models.CharField(max_length=30)
    surname = models.CharField(max_length=30)
    mail = models.EmailField(max_length=50)
    validateMail =  models.BooleanField()
    birthday = models.DateTimeField(max_length=60)
    premium = models.BooleanField()
    premiumEnd = models.DateTimeField(max_length=10)
    totalUpload = models.CharField(max_length=15)
    avatar = models.URLField()

class FileItem(models.Model):
    file_id = models.CharField(max_length=30)
    file_name = models.CharField(max_length=75)
    date_upload = models.DateTimeField(max_length=10)
    data_size = models.CharField(max_length=75)
    key = models.CharField(max_length=75)
    # Django will automatically create owner_id field
    owner = models.ForeignKey(User_t, related_name='files')
    folder = models.ForeignKey('FolderItem', related_name='files')
    # not sure what this (login_accept) is for...
    # login_accept = models.ManyToManyField(User_t)
    file_i = models.FileField(/mnt/test/)

class FolderItem(models.Model):
    folder_id = models.CharField(max_length=30)
    folder_name = models.CharField(max_length=75)
    data_size = models.CharField(max_length=75)
    key = models.CharField(max_length=75)
    owner = models.ForeignKey(User_t, related_name='folders')
    # again, not sure what this is for
    # login_accept = models.ManyToManyField(User_t) 
```

# jquery - jquery上传文件错误-消息-windows

> ID：13095137
> 
> 赞同：1
> 
> 时间：2012-10-26T22:12:00.053
> 
> 标签：jquery, ruby-on-rails, jquery-validate

我正在更改/改进[此示例](https://github.com/tors/jquery-fileupload-rails-paperclip-example)，现在我停留在错误消息上。

我在[index.html.erb](https://github.com/tors/jquery-fileupload-rails-paperclip-example/blob/master/app/views/uploads/index.html.erb)中发现了一些错误变量，我想知道如何将它们与我的验证联系起来，以便在文件太大或太小时时出现消息窗口

如果有人帮助我，我将不胜感激。

这是 index.html.erb 的小截断：

```
<script>
  var fileUploadErrors = {
  maxFileSize: 'File is too big',
  minFileSize: 'File is too small',
  acceptFileTypes: 'Filetype not allowed',
  maxNumberOfFiles: 'Max number of files exceeded',
  uploadedBytes: 'Uploaded bytes exceed file size',
  emptyResult: 'Empty file upload result'
  };
</script>

<!-- The template to display files available for upload -->
<script id="template-upload" type="text/x-tmpl">
  {% for (var i=0, file; file=o.files[i]; i++) { %}
  <tr class="template-upload fade">
    <td class="preview"><span class="fade"></span></td>
    <td class="name"><span>{%=file.name%}</span></td>
    <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
    {% if (file.error) { %}
    <td class="error" colspan="2"><span class="label label-important">{%=locale.fileupload.error%}</span> {%=locale.fileupload.errors[file.error] || file.error%}</td>
    {% } else if (o.files.valid && !i) { %}

    <td class="start">{% if (!o.options.autoUpload) { %}
      <button class="btn btn-mini btn-primary">
        <i class="icon-upload icon-white"></i>
        <span>{%=locale.fileupload.start%}</span>
      </button>
      {% } %}</td>
    {% } else { %}
    <td colspan="2"></td>
    {% } %}
    <td class="cancel">{% if (!i) { %}
      <button class="btn btn-mini btn-warning">
        <i class="icon-ban-circle icon-white"></i>
        <span>{%=locale.fileupload.cancel%}</span>
      </button>
      {% } %}</td>
  </tr>
  {% } %}
</script>
<!-- The template to display files available for download -->
<script id="template-download" type="text/x-tmpl">
  {% for (var i=0, file; file=o.files[i]; i++) { %}
    <tr class="template-download fade">
      {% if (file.error) { %}
        <td></td>
        <td class="name"><span>{%=file.name%}</span></td>
        <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
        <td class="error" colspan="2"><span class="label label-important">{%=locale.fileupload.error%}</span> {%=locale.fileupload.errors[file.error] || file.error%}</td>
        {% } else { %}
        <td class="preview">{% if (file.thumbnail_url) { %}
          <a href="{%=file.url%}" title="{%=file.name%}" rel="gallery" download="{%=file.name%}"><img src="{%=file.thumbnail_url%}"></a>
          {% } %}</td>
        <td class="name">
          <a href="{%=file.url%}" title="{%=file.name%}" rel="{%=file.thumbnail_url&&'gallery'%}" download="{%=file.name%}">{%=file.name%}</a>
        </td>
        <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
        <td colspan="2"></td>
        {% } %}
      <td class="delete">
        <button class="btn btn-mini btn-danger" data-type="{%=file.delete_type%}" data-url="{%=file.delete_url%}">
          <i class="icon-trash icon-white"></i>
          <span>{%=locale.fileupload.destroy%}</span>
        </button>
        <input type="checkbox" name="delete" value="1">
      </td>
    </tr>
    {% } %}
</script> 
```

我的验证：

```
class Upload < ActiveRecord::Base
  attr_accessible :upload, :upload_file_name, :upload_file_size
  has_attached_file :upload

  include Rails.application.routes.url_helpers

  validates :upload_file_name,  :presence   => true,
                                #:uniqueness =>{:case_sensitive => false},
                                :format     =>{:with => %r{\.(cel)$}i}
  # validates_presence_of :upload_file_name
  validates_uniqueness_of :upload_file_name, :message => "blabla"
  #validates_attachment_size :upload, :in =>1.megabytes..20.megabytes
  validates :upload_file_size,  :inclusion  => {:in =>10.megabytes..20.megabytes}

  def to_jq_upload
    {
      "name" => read_attribute(:upload_file_name),
      "size" => read_attribute(:upload_file_size),
      "url" => upload.url(:original),
      "delete_url" => upload_path(self),
      "delete_type" => "DELETE" 
    }
  end

end 
```

和 uploads.controller：

```
 def create
    p_attr=params[:upload]
    p_attr[:upload] = params[:upload][:upload].first if params[:upload][:upload].class == Array
    @upload = Upload.new(p_attr)

    respond_to do |format|
      if @upload.save
        format.html {
          render :json => [@upload.to_jq_upload].to_json,
          :content_type => 'text/html',
          :layout => false
        }
        format.json { render json: [@upload.to_jq_upload].to_json, status: :created, location: @upload }
      else
        format.html { render action: "new" }
        format.json { render json: @upload.errors, status: :unprocessable_entity }
      end
    end
  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:37:06.013

这可能会帮助您进行一些与文件相关的验证：

`$('#fileupload').fileupload`在你的中找到这个`index.html.erb`并更改为这样的内容：

```
$('#fileupload').fileupload({
            maxFileSize: 100000000,
            acceptFileTypes: '/^image\/(gif|jpeg|png)$/',
            previewSourceFileTypes: '/^image\/(gif|jpeg|png)$/',
        }); 
```

您应该查看“blueimp / jQuery-File-Upload”wiki 页面以了解更多错误类型。

# ruby-on-rails - Rails、Heroku、S3 和静态资源

> ID：13095139
> 
> 赞同：1
> 
> 时间：2012-10-26T22:12:05.427
> 
> 标签：ruby-on-rails, heroku, amazon-s3

我正在开发一个运行在 Heroku 堆栈上的 Rails Web 应用程序，该应用程序处理一些附加到 Rails 数据库对象的文档。即假设我们有一个名为`product_i`class/table的对象`Product/products`，并且`product_i_prospectus.pdf`是关联的产品说明书，其中每个产品都有一个说明书。

由于我正在研究 Heroku，因此没有 root 访问权限，因此我计划使用 Amazon S3 来存储与`product_i`. 到目前为止，一切都很好。

现在假设这`product_i_attributes.txt`也是我要上传的一个文件，并且我确实想根据文件中的信息实际填写`product_i`对象中的信息（即表中对应的行`product_i`）`product_i_attributes.txt`。

一句话：我想根据上传到我的 S3 存储桶的静态文本文件的内容来创建或更改数据库对象。

严格来说，一旦它们在存储桶中，我实际上不必能够访问它们，我只需要从文本文件中创建一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T02:25:32.637

I have done something similar with csv files. I would not try to process the file directly at upload as it can be resource intensive.

My solution was to upload the file to s3 and then call a background job method(delayed_job, resque, etc.) that processed the csv after upload. You could then call a delete after the job processed to remove the file from s3 if you no longer needed it after processing.

For Heroku this will require that you add a worker (if you don't already have one) to process the background jobs that will process the text files.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:17:37.273

看看[aws-sdk-for-ruby](https://github.com/amazonwebservices/aws-sdk-for-ruby) gem。这将允许您访问您的 S3 存储桶。

# html - 网站在 Safari 中没有响应 float:left 和 float:right（在 Firefox 和 Chrome 中正常）

> ID：13095140
> 
> 赞同：0
> 
> 时间：2012-10-26T22:12:26.373
> 
> 标签：html, css, firefox, google-chrome, safari

我有一个[网站](http://zoparealty.com/about/zopa-vendors/)，它应该有一个左侧栏和一个右侧栏 - 它在 FF 和 Chrome 中确实如此，但是在 Safari 中有些地方不太正确。任何想法是什么导致了这个问题/为什么它只在 Safari 中搞砸了？

[pastebin - 代码](http://pastebin.com/Sf6rFSit)

![苹果浏览器](../Images/32107f0569c2799f5fff135ec8d02dc4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T08:04:29.820

我在 Safari 中检查了您的网址。它工作正常。

# asp.net - ASP.net 页面中的 DropDownList 两次触发 OnSelectedIndexChanged

> ID：13095141
> 
> 赞同：1
> 
> 时间：2012-10-26T22:12:26.740
> 
> 标签：asp.net, drop-down-menu, viewstate, autopostback

html

```
 <asp:DropDownList ID="ddlOffice" runat="server" Rows="10" Width="300px" AutoPostBack="true" OnSelectedIndexChanged="ddlOffice_SelectedIndexChanged" EnableViewState="true"   /> 
```

即使根据 MSDN，我所做的一切都是正确的。SelectedIndexChanged 仍然触发两次。有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:21:10.357

一个可能的原因：如果您还在代码隐藏中注册了事件处理程序（`Handles`VB.NET 或`+=`C# 中的 fe via 子句），它将导致事件被触发两次。

然后你只需要删除其中一个，例如在 aspx 上：

```
<asp:DropDownList ID="ddlOffice" 
    runat="server" Rows="10" Width="300px"
    AutoPostBack="true" 
    EnableViewState="true"   /> 
```

# android - 如何在 android 应用程序中重复播放歌曲？

> ID：13095148
> 
> 赞同：4
> 
> 时间：2012-10-26T22:13:39.067
> 
> 标签：android, android-music-player

我在我的 android 应用程序的背景中放了一首歌。我不知道应用程序打开了多少时间。我想把这首歌重复一遍。我的代码是：

```
 MediaPlayer mySong;

    mySong = MediaPlayer.create(X_0Activity.this, R.raw.tj);
    mySong.start(); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-06T13:06:18.807

```
Uri mediaUri = createUri(context, R.raw.media); // Audiofile in raw folder
Mediaplayer mPlayer = new MediaPlayer();
mPlayer.setDataSource(context, mediaUri);
mPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
mPlayer.prepare();

mPlayer.setLooping(true);  // for repeat song 

mPlayer.start(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-31T05:48:24.360

mySong.setLooping(true) // *重复歌曲*

mySong.start(),

现在您已准备好开启重复模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T22:31:07.307

使用 SoundPool，您可以随时轻松循环播放！这是一个很好的例子：[使用 SoundPool 播放声音](https://stackoverflow.com/questions/6396711/play-sound-with-soundpool?rq=1)

在里面

```
spool.play(soundID, volume, volume, 1, 0, 1f); 
```

数字 0 代表您想要重复歌曲的数字。对于无限循环，合适的值为-1。

# javascript - 日期和时间项目的未知 JavaScript 参考错误

> ID：13095154
> 
> 赞同：0
> 
> 时间：2012-10-26T22:14:48.760
> 
> 标签：javascript, google-chrome, date, time

我正在编写一个快捷方式 JavaScript 文件来制作`$date`和`$time`变量。据我所知，它应该可以工作，但它不会显示并且 Google Chrome 的调试器会显示`[Uncaught TypeError: Cannot Read 'firstChild' of null]`

这是我的代码：

```
function mdy(){

    var
        h = new Date(),
        year = h.getFullYear(),
        month = h.getMonth() + 1,
        day = h.getDate();

        if(month < 10) { month = "0" + month; }

        if(day < 10) { month = "0" + month; }

        var string = month + "/" + day + "/" + year;

        document.getElementById('mdy').firstChild.nodeValue = string;

}

function ymd(){

    var
        h = new Date(),
        year = h.getFullYear(),
        month = h.getMonth() + 1,
        day = h.getDate();

        if(month < 10) { month = "0" + month; }

        if(day < 10) { month = "0" + month; }

        var string = year + "/" + month + "/" + day;

        document.getElementById('ymd').firstChild.nodeValue = string;

}

var $date = {

    mdy: '<span id="mdy">&nbsp;</span>',
    ymd: '<span id="ymd">&nbsp;</span>'

}

/* $time module */
// this comes in two formats, standard and military. 
// type $time.standard for standard time and $time.military
// for military time
function tstandard(){

    var
        h = new Date(),
        hours = h.getHours(),
        minutes = h.getMinutes();

        minutes = ( minutes < 10 ? "0" : "" ) + minutes;

        var diem = ( hours < 12 ) ? "am" : "pm";

        hours = ( hours > 12 ) ? hours - 12 : hours;

        hours = ( hours == 0 ) ? 12 : hours;

        var string = hours + ":" + minutes + " " + diem;

        document.getElementById("tstandard").firstChild.nodeValue = string;

}

function tmilitary() {

    var
        h = new Date(),
        hours = h.getHours(),
        minutes = h.getMinutes();

        minutes = ( minutes < 10 ? "0" : "" ) + minutes;

        hours = ( hours == 0 ) ? 12 : hours;

        if(hours < 10) { hours = "0" + hours }

        var string = hours + ":" + minutes;

        document.getElementById("tmilitary").firstChild.nodeValue = string;

}

var $time = {

    standard: "<span id='tstandard'>&nbsp;</span>",
    military: "<span id='tmilitary'>&nbsp;</span>"

}

/*! universal body onload function !*/
window.onload = function(){

    mdy(); setInterval('mdy()', 1000);
            ymd(); setInterval('ymd()', 1000);

    tstandard(); setInterval('tstandard()', 1000);
    tmilitary(); setInterval('tmilitary()', 1000);

} 
```

在我的 HTML 中，我正在做：

```
<script>document.write($date.mdy + " - " + $time.standard);</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:19:24.587

我想你可能想要这个：

```
document.getElementById('mdy').innerHTML = string; 
```

或这个：

```
document.getElementById('mdy').nodeValue = string; 
```

而不是这个：

```
document.getElementById('mdy').firstChild.nodeValue = string; 
```

那应该注意错误。（不需要`firstChild`从`getElementById`调用中获取，默认情况下它已经返回了一个节点。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:44:40.343

您正在向 DOM 添加两个占位符元素 -`<span id="ymd"></span>`和`<span id="tstandard">`.

然后，在`window.onload`处理程序中，您不仅尝试更新这两个占位符的内容，而且还尝试更新不在 DOM 中的其他两个元素（`id="ymd"`和`id="tmilitary"`）的内容。由于这个事实， `document.getElementById('ymd')`(and `'tmilitary'`) 调用正确返回。`undefined`

您想删除对`ymd`and`tmilitary`函数的调用。

```
window.onload = function(){
  mdy();
  setInterval(mdy, 1000);

  tstandard();
  setInterval(tstandard, 1000);
}; 
```

我还更改了调用`setInterval`以简化事情。传递引用更加有效和清晰。

# android - 通知管理器崩溃 android aacplayer 应用程序

> ID：13095157
> 
> 赞同：0
> 
> 时间：2012-10-26T22:15:07.427
> 
> 标签：android

嗨，我的应用程序 aacplayer 在我的 Galaxy s3 中运行良好，但在具有 android 2.3.4 的 Galaxy ace 中，我的应用程序崩溃了，但是如果我从代码中删除通知管理器，那么它可以完美运行。

这是我的通知管理器代码：

```
public void playerMetadata(final String key, final String value) {
        TextView tv = null;

        if ("StreamTitle".equals(key) || "icy-name".equals(key)
                || "icy-description".equals(key)) {
            tv = txtMetaTitle;
        } else if ("icy-url".equals(key)) {
            tv = txtMetaUrl;
        } else
            return;

        final TextView ftv = tv;

        uiHandler.post(new Runnable() {
            public void run() {
                ftv.setText(value);
                int NOTIFICATION_ID = 1;
                String ns = Context.NOTIFICATION_SERVICE;
                Context context = getApplicationContext();

                NotificationManager mNotificationManager = (NotificationManager) getSystemService(ns);
                int icon = R.drawable.notificacion;
                long when = System.currentTimeMillis();
                CharSequence tickerText = "Reproduciendo...";
                Notification notification = new Notification(icon, tickerText,
                        when);
                RemoteViews contentView = new RemoteViews(getPackageName(),
                        R.layout.notification);
                contentView.setImageViewResource(R.id.icon, R.drawable.notificacion);
                contentView.setTextViewText(R.id.title_text, txtMetaTitle
                        .getText().toString());

                contentView.setTextViewText(R.id.message_text, txtMetaUrl
                        .getText().toString());

                notification.contentView = contentView;
                Intent notificationIntent = new Intent(AACPlayerActivity.this,
                        Principal.class);

                // Intent notificationIntent = new Intent(this,
                // Principal.class);
                PendingIntent contentIntent = PendingIntent.getActivity(
                        context, 0, notificationIntent, 0);

                // PendingIntent contentIntent = PendingIntent.getActivity(this,
                // 0, notificationIntent, 0);
                notification.contentIntent = contentIntent;
                notification.flags |= Notification.FLAG_ONGOING_EVENT;
                mNotificationManager.notify(NOTIFICATION_ID, notification);
            }
        });
    } 
```

我不知道为什么在galaxy s3中效果很好，但在galaxy ace中效果不佳，我该如何解决。

非常感谢您。

编辑：

日志猫：

```
E/AndroidRuntime(16846): android.app.RemoteServiceException: Bad notification posted from package com.spoledge.aacplayer: Couldn't expand RemoteViews for: StatusBarNotification(package=com.spoledge.aacplayer id=1 tag=null notification=Notification(vibrate=null,sound=null,defaults=0x0,flags=0x2)) 
```

如果我在我的代码中添加这个：

```
notification.setLatestEventInfo(context, 
txtMetaTitle.getText().toString(), 
txtMetaUrl.getText().toString(), contentIntent); 
```

通知效果很好，没有问题，但我需要显示通知：

```
contentView.setTextViewText(R.id.title_text, txtMetaTitle
                        .getText().toString());

                contentView.setTextViewText(R.id.message_text, txtMetaUrl
                        .getText().toString()); 
```

该 txtmetatitle 字段有一个选取框，但如果添加在 notification.setLatestEvent 之前发布的那条行，则不会崩溃，但我无法使选取框正确运行

# android - Android SimpleAdapter 中的多个对象

> ID：13095159
> 
> 赞同：0
> 
> 时间：2012-10-26T22:15:12.453
> 
> 标签：android, listview, simpleadapter

我需要（除非您能想到更好的方法）将多个对象传递给自定义列表适配器。我知道我在这里叫错了树，如果有人让我走上正确的道路，我将不胜感激！

谢谢

```
playlistadapter = new MyPlaylistAdapter(MyApplication.getAppContext(),
                                        songsList,
                                        retained_songsList,
                                        folderMode,
                                        R.layout.file_view, 
                                        new String[] { "songTitle","songAlbum", "songPath" }, 
                                        new int[] { R.id.checkTextView, R.id.text2, R.id.text3 }); 
```

还有我的适配器类：

```
public class MyPlaylistAdapter extends SimpleAdapter{
        private ArrayList <Song> songsList = new ArrayList<Song>();
        private ArrayList <Song> retained_songsList = new ArrayList<Song>();
        private ArrayList<Song> playlistcheck = new ArrayList<Song>();
        private String folderMode;
        private String TAG = "AndroidMediaCenter";
          public MyPlaylistAdapter(Context context,List<Song> SongsList, List<Song> Retained_songsList, String FolderMode,int resource, String[] from, int[] to) {
            super(context, null, resource, from, to);

            songsList.clear();
            songsList.addAll(SongsList);

            Log.i(TAG, "MyPlayListAdapter Songslist = " + songsList.size());
            retained_songsList.clear();
            retained_songsList.addAll(Retained_songsList);
            folderMode = FolderMode;

        }
        public View getView(int position, View convertView, ViewGroup parent) {
              //PlayListViewHolder holder;
              CheckedTextView checkTextView; 
              TextView text2; 
              TextView text3;
              if (convertView == null) {

              LayoutInflater inflater = (LayoutInflater) MyApplication.getAppContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
              //LayoutInflater inflater=getLayoutInflater();
              convertView=inflater.inflate(R.layout.file_view, parent, false);
              //convertView.setBackgroundColor(0xFF00FF00 );
              //holder = new PlayListViewHolder();
              checkTextView = (CheckedTextView) convertView.findViewById(R.id.checkTextView);
              text2 = (TextView) convertView.findViewById(R.id.text2);
              text3 = (TextView) convertView.findViewById(R.id.text3);
              //convertView.setTag(holder);
              } else {
                  //holder = (PlayListViewHolder) convertView.getTag();
              }
              //put something into textviews
              String tracks = null;
              String tracks_Details = null;
              String trackspath = null;

              tracks = songsList.get(position).getSongTitle();
              tracks_Details = songsList.get(position).getAlbum() + " (" + songsList.get(position).getArtist() + ")";
              trackspath = songsList.get(position).getSongPath();                  

              checkTextView = (CheckedTextView) convertView.findViewById(R.id.checkTextView);
              text2 = (TextView) convertView.findViewById(R.id.text2);
              text3 = (TextView) convertView.findViewById(R.id.text3);

              checkTextView.setText(tracks);

             if(folderMode.equals("Playlists")){
                 checkTextView.setBackgroundColor(Color.GREEN); 
                 checkTextView.setChecked(false);

             try {

                 int listsize_rs = retained_songsList.size();

                     for (int j = 0; j<listsize_rs;j++){
                         if((retained_songsList.get(j).getSongPath()).equals(songsList.get(position).getSongPath())){
                            checkTextView.setBackgroundColor(Color.TRANSPARENT);
                             //Need to check here whether the checkedtextview is ticked or not
                            checkTextView.setChecked(true);
                            playlistcheck.add(songsList.get(position));
                            break;
                        }

                     }
                  } catch (Exception e) {
                 e.printStackTrace();
             }

             }else
             {
                 //Need to check here whether the checkedtextview is ticked or not

                 try {
                     if (songsList.get(position).getSongCheckedStatus()==true){

                         checkTextView.setChecked(true);
                         }else{
                         checkTextView.setChecked(false); 
                         }

                 } catch (Exception e) {
                     e.printStackTrace();
                 }
             }

             text2.setText(tracks_Details);
             text3.setText(trackspath);

             Log.i(TAG, "MyPlayListAdapter Songslist = " + songsList.size());

             return convertView;
             }

      } 
```

但是，这不会膨胀，会引发以下错误：

```
10-26 23:11:09.464: E/AndroidRuntime(2826): FATAL EXCEPTION: main
10-26 23:11:09.464: E/AndroidRuntime(2826): java.lang.RuntimeException: Error receiving broadcast Intent { act=android.intent.action.GetMusicComplete flg=0x10 } in com.Nmidia.AMC.MusicActivity$18@414c5770
10-26 23:11:09.464: E/AndroidRuntime(2826):     at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:765)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at android.os.Handler.handleCallback(Handler.java:615)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at android.os.Handler.dispatchMessage(Handler.java:92)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at android.os.Looper.loop(Looper.java:137)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at android.app.ActivityThread.main(ActivityThread.java:4745)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at java.lang.reflect.Method.invokeNative(Native Method)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at java.lang.reflect.Method.invoke(Method.java:511)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at dalvik.system.NativeStart.main(Native Method)
10-26 23:11:09.464: E/AndroidRuntime(2826): Caused by: java.lang.NullPointerException
10-26 23:11:09.464: E/AndroidRuntime(2826):     at android.widget.SimpleAdapter.getCount(SimpleAdapter.java:93)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at android.widget.ListView.setAdapter(ListView.java:460)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at com.Nmidia.AMC.MusicActivity.setFilterMusic(MusicActivity.java:1230)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at com.Nmidia.AMC.MusicActivity$18.onReceive(MusicActivity.java:996)
10-26 23:11:09.464: E/AndroidRuntime(2826):     at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:755)
10-26 23:11:09.464: E/AndroidRuntime(2826):     ... 9 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:48:56.520

1）第一行说您需要将对象传递给适配器。您的代码表明您正在这样做。所以你*隐含*的问题是模棱两可的。

2）它不起作用，因为您在构造函数中传递了 null （而不是列表）。

```
super(context, null, resource, from, to); 
```

这是预期的：[`super(Context, List<Map<String, ?>>, int, String[], int[])`](http://developer.android.com/reference/android/widget/SimpleAdapter.html#SimpleAdapter)

3) 您在适配器的构造函数中传递的 null 会导致简单适配器的内部 List 为 null。它为 null 意味着 SimpleAdapter.getCount() 没有对象（列表）来获取数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T08:36:15.777

AedonEtLIRA，感谢您的帮助。最后我选择更改`SimpleAdapter`为`ArrayAdapter`.

```
public class MyPlayListAdapter extends ArrayAdapter<Song> {

private ArrayList<Song> songsList;
private ArrayList<Song> playlistcheck = new ArrayList<Song>();
private ArrayList <Song> retained_songsList = new ArrayList<Song>();
private String folderMode;
private String TAG = "AndroidMediaCenter";

public MyPlayListAdapter(Context context, int textViewResourceId, ArrayList<Song> songsList, ArrayList<Song> retained_songsList, String folderMode) {
        super(context, textViewResourceId, songsList);
        this.songsList = songsList;
        this.retained_songsList = retained_songsList;
        this.folderMode = folderMode;
} 
```

从我的主要活动中调用：

```
playlistadapter = new MyPlayListAdapter(MyApplication.getAppContext(),
                                        R.layout.file_view, 
                                        songsList, 
                                        retained_songsList, 
                                        folderMode); 
```

# ant - 使用密码从 ant 脚本通过 SSH 进行 Rsync

> ID：13095165
> 
> 赞同：2
> 
> 时间：2012-10-26T22:15:33.467
> 
> 标签：ant, ssh, build-automation, development-environment, rsync

我的开发人员机器上运行了一个虚拟机，我需要通过 SSH 通过 ant 构建脚本将文件同步到它以“部署”。在生产中，安全性是一个问题，但在与本地计算机上的开发 VM 通信时，我真的不关心安全 SSH 实践。

我本可以创建一个证书并将其安装在我的 SSH 密钥中，但这有点烦人。我宁愿通过 ant 脚本将我的密码发送到 rsync 并收工。

（编辑 - 如果你真的无法在没有示例的情况下处理这个问题，假设这台服务器不在我的控制范围内，他们邪恶的系统管理员出于任何原因拒绝让我使用 SSH 密钥登录。谁知道？他只是疯了男人！）

有什么方法可以在不编辑 ssh 配置的情况下调用 SSH，或者更具体地说，在非交互模式下调用 rsync？换句话说，只需提供密码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T22:18:16.587

我碰巧已经想出了一个解决方案，但这并不是很容易，所以我想分享一下。

基本上，我使用了一个名为“expect”的命令行程序来将我的密码填充到 rsync 的交互模式中。我也不想把它写成脚本，所以我把它浓缩成一个命令。如果出于某种原因需要，这也适用于 ssh 和 rsync。

也许有更好的方法，但这似乎工作正常。

下面的 192.168.64.131 显然是我本地虚拟机的 ip。用您的 ssh 登录名和密码替换 login_name 和 login_password。

```
expect -c 'spawn rsync -avz -e ssh ./ login_name@192.168.64.131:/var/www/auth/; expect "*?assword:*" {send "login_password\r"; interact};' 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-26T23:51:24.883

使用 SSH 密钥更容易、更安全。以下答案中给出了一个示例：

*   [Ant，从远程机器下载文件集](https://stackoverflow.com/questions/12191713/ant-download-fileset-from-remote-machine/12206460#12206460)

# objective-c - 编译器警告“可能无法响应”

> ID：13095166
> 
> 赞同：1
> 
> 时间：2012-10-26T22:15:40.443
> 
> 标签：objective-c

我是新手，请见谅。

我正在使用 zbar 的条形码阅读器示例程序。我想添加一个 sqlite3 数据库来查找扫描的条形码。但是当我尝试从 ViewController 实例化 sql 控件时，出现以下错误。

```
MySQL *MS =[[MySQL alloc ] init];

[ MS viewDidLoad];
  ^^   MySQL may not respond to viewDidLoad 
```

有任何想法吗？谢谢

PS 一旦遇到违规行，程序就会崩溃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:26:49.877

“可能不回应”有两个可能的原因。任何一个：

1.  您忘记包含适当类的头文件导入。
2.  该方法在您调用它的类上不存在。

在你的情况下，2 号看起来更有可能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T22:26:13.733

“可能不响应”意味着您的对象可能没有实现您要调用的方法。您的程序崩溃是因为它本质上是在调用一个不存在的方法。

我不太确定您要做什么，但我认为对象“MySQL”不会有 viewDidLoad 方法。

# javascript - 触发控制器显示视图

> ID：13095167
> 
> 赞同：1
> 
> 时间：2012-10-26T22:15:45.827
> 
> 标签：javascript, ruby, ruby-on-rails-3

我在视图中有一个使用 js 的下拉列表我将所选项目从下拉列表传递到控制器，在控制器内部我使用下拉列表中的所选项目运行查询以提取一些记录。现在的问题是我无法显示要查看的查询结果。基本上我无法触发控制器显示在视图中。非常感谢任何帮助。

这是将数据传递给控制器​​的js：

```
<script type="text/JavaScript">
$(function(){
    $('.defined_call').bind('change', function(){
        alert($(this).val());
        $.ajax({
            url: "<%= changeowner_path %>",
            data: { my_str: $(this).val() }
        });
    });
});
</script>

<%= select_tag "dropdown_cases", options_for_select(@ownerlist),{:id=>"defined_Id",:class 
=> "defined_call'}  %> 
```

这是控制器：

```
class ReassignsController < ApplicationController
  def changeowner
    i=0
    $myarr=[]
    ownerl = Transaction.owner#declaredin model
    @ownerlist=ownerl.collect { |c| [ c, c ] }#make it for dropdown
    value=params[:my_str]#return value from dropdown
    $value1=value.to_s#make it for owner table
    @owner_records=Transaction.where(:owner => $value1) 

    ===> I would like to display to the view?
  end
end 
```

这是我正在使用的视图：

```
<table class="table table-condensed" id="sortTableExample">
<tr>
<th style="text-align:center">Book Name</th>
<th style="text-align:center">Owner</th>

</tr>

<% @owner_records.each do |arr_data| %>
<tr>
<td style="text-align:center"><%= arr_data.book%></td>
<td style="text-align:center"><%= arr_data.owner%></td>
</tr>
<% end %>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:05:05.253

乔，尝试类似：

```
 $('.defined_call').change(function() {
        $.ajax({
            url: "<%= changeowner_path %>", type: 'get', 
            data: { my_str: $(this).val() },
            dataType: 'json',
            processData: false,
            success: function(data) {
              if (data == "") {
                alert('No Results');
              }
              else {
                var jsonObj = eval( data );
                var count = jsonObj.transactions.length;
                for (var i = 0; i<count; i=i+1) {
                  $('#sortTableExample').append('<td style="text-align:center">' + jsonObj.transactions[i].book + '</td><td style="text-align:center">' + jsonObj.transactions[i].owner + '</td>');
                }
              }
            }
        });
  }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T23:02:43.057

Rails 正在呈现您的视图，您只是在客户端（在 javascript 中）没有对它做任何事情。

在您的 ajax 调用中，您想对成功做一些事情：

```
$.ajax({
   url: "<%= changeowner_path %>",
   data: { my_str: $(this).val() },
   success: function(data) {
       $('#myDiv').html(data); // This is writing the returned view from rails to myDiv
   }
}); 
```

# android - 服务正在启动，但未调用 OnCreate 或 OnStart

> ID：13095169
> 
> 赞同：6
> 
> 时间：2012-10-26T22:16:09.163
> 
> 标签：android, service

我目前正在开发一个android项目，我正在尝试启动一个服务，当服务开始运行一些代码来初始化一些东西时。

下面是我用于服务的代码。

```
Context context;
    PowerManager.WakeLock wakeLock;

    public PowerDetectionService(Context context)
    {
        this.context = context;
    }

    public PowerDetectionService()
    {}

    public void onCreate()
    {
        super.onCreate();
        PowerManager pm = (PowerManager)getApplication().getApplicationContext().getSystemService(Context.POWER_SERVICE);
        wakeLock = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "ScreenStay");
    }

    public void onStart(Intent intent, int startId)
    {
        super.onStart(intent, startId);
        PowerManager pm = (PowerManager)getApplication().getApplicationContext().getSystemService(Context.POWER_SERVICE);
        wakeLock = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "ScreenStay");
    }

    @Override
    public IBinder onBind(Intent intent) {

        return null;
    }

    public void receivedPowerConnected()
    {
        try
        {
            Toast.makeText(context, "Power connected", Toast.LENGTH_LONG).show();
            wakeLock.acquire();
        }
        catch (Exception ex)
        {
            Toast.makeText(context, ex.toString(), Toast.LENGTH_LONG).show();
        }
    }

    public void receivedPowerDisconnected()
    {
        try
        {
            Toast.makeText(context, "Power disconnected", Toast.LENGTH_LONG).show();
            wakeLock.release();
        }
        catch (Exception ex)
        {
            Toast.makeText(context, ex.toString(), Toast.LENGTH_LONG).show();
        }
    } 
```

唤醒锁始终为空，因为那段代码永远不会在 oncreate 或 onstart 中执行。我试过把它放在绑定函数中，但仍然没有乐趣。

当我进入 android 设置时，我可以看到我的应用程序正在运行该服务，但我需要先初始化该代码，然后才能正常工作。

感谢您的任何帮助，您可以提供。

**更新** 由于前面的评论，我发现正在调用这些函数。由于某种原因，调试器没有被触发。

下面是显示如何根据请求创建服务器的代码。

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    startService(this);
}

public void onResume()
{
    super.onResume();
    startService(this);
}

private void startService(Context context)
{
    Intent service = new Intent(context, PowerDetectionService.class);
    context.startService(service);
} 
```

**更新 2** 如下要求是启动服务并执行唤醒锁的所有代码。

下面是启动服务的主要活动

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        StartPowerService(this);
        //getActionBar().setDisplayHomeAsUpEnabled(true);
    }

    public void onResume()
    {
        super.onResume();
        StartPowerService(this);
    }

    private void StartPowerService(Context context)
    {
        Intent service = new Intent(context, PowerDetectionService.class);
        startService(service);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            //case android.R.id.home:
            //    NavUtils.navigateUpFromSameTask(this);
            //    return true;
        }
        return super.onOptionsItemSelected(item);
    }

} 
```

下面是服务类

```
public class PowerDetectionService extends Service {

    Context context;
    PowerManager.WakeLock wakeLock;

    public PowerDetectionService(Context context)
    {
        this.context = context;
    }

    public PowerDetectionService()
    {}

    public void onCreate()
    {
        super.onCreate();
        Log.d("SERVICE", "ON CREATE CALLED");
        PowerManager pm = (PowerManager)getApplication().getApplicationContext().getSystemService(Context.POWER_SERVICE);
        wakeLock = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "ScreenStay");
    }

    public int OnStartCommand(Intent intent, int flags, int startId)
    {
        Log.d("SERVICE", "ONSTARTCOMMAND Called");
        PowerManager pm = (PowerManager)getApplication().getApplicationContext().getSystemService(Context.POWER_SERVICE);
        wakeLock = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "ScreenStay");
        return START_STICKY;
    }

    public void onStart(Intent intent, int startId)
    {
        super.onStart(intent, startId);
        Log.d("SERVICE", "ON START CALLED");
        PowerManager pm = (PowerManager)getApplication().getApplicationContext().getSystemService(Context.POWER_SERVICE);
        wakeLock = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "ScreenStay");
    }

    @Override
    public IBinder onBind(Intent intent) {

        return null;
    }

    public void receivedPowerConnected()
    {
        try
        {
            Toast.makeText(context, "Power connected", Toast.LENGTH_LONG).show();
            wakeLock.acquire();
        }
        catch (Exception ex)
        {
            Toast.makeText(context, ex.toString(), Toast.LENGTH_LONG).show();
        }
    }

    public void receivedPowerDisconnected()
    {
        try
        {
            Toast.makeText(context, "Power disconnected", Toast.LENGTH_LONG).show();
            wakeLock.release();
        }
        catch (Exception ex)
        {
            Toast.makeText(context, ex.toString(), Toast.LENGTH_LONG).show();
        }
    }
} 
```

下面是 mainfest 文件。

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.BoardiesITSolutions.ScreeenStay"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <service android:name="PowerDetectionService"
            android:process=":ScreenStay"
            android:icon="@drawable/ic_launcher"
            android:label="Screen Stay">
        </service>
        <receiver android:name="BroadcastReceiveDetection">
            <intent-filter>
                <action android:name="android.intent.action.BOOT_COMPLETED" />
                <action android:name="android.intent.action.ACTION_POWER_CONNECTED" />
                <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED" />
            </intent-filter>
        </receiver>
    </application>
</manifest> 
```

希望这可以帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-21T12:58:52.850

您正在不同的过程中开始服务。

```
 <service android:name="PowerDetectionService"
        android:process=":ScreenStay"
        android:icon="@drawable/ic_launcher"
        android:label="Screen Stay"> 
```

调试器附加到您的主进程。当新的启动时，它没有附加调试器，所以它会忽略你的断点。如果你想调试远程进程，你可以在 DDMS 透视图中通过 Eclipse 来完成。在设备下，您可以看到其进程。然后您可以选择一个并按调试选定的进程（绿色错误图标）。当您只想在某个时候开始调试您的应用程序时，这也很有用。

至于调试`onCreate()`，您必须在进程启动之后附加调试器，但在`onCreate()`调用之前。例如，您可以`Thread.sleep()`在开头`onCreate()`放置几秒钟，以便您可以附加调试器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T22:33:34.777

Which class are you extending? Service?

The method `onStart()` is only used for old Android versions (<2.0). For more recent versions you should use `onStartCommand()` as bellow:

```
@Override
public int onStartCommand(Intent intent, int flags, int startId) 
```

And you need to return `START_STICKY` from the method above if you want the service to keeps running after executing the code. If service is not kept alive the `PowerManager.FULL_WAKE_LOCK` will be released. Probably you can also get away making `wakeLock` static.

To start service use:

```
 Intent i=new Intent(this, PowerDetectionService.class);
    startService(i); 
```

--EDITED--

As per the topic here: [getApplication() vs. getApplicationContext()](https://stackoverflow.com/questions/5018545/getapplication-vs-getapplicationcontext) you may get different `Context` object when getting the context using `getApplicationContext()`. Try change the following line:

```
 PowerManager pm = (PowerManager)getApplication().getApplicationContext().getSystemService(Context.POWER_SERVICE); 
```

by:

```
 PowerManager pm = (PowerManager)this.getSystemService(Context.POWER_SERVICE); 
```

regrads.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T22:37:33.513

只是一个说明：

`onStart()`方法已弃用，您应该`onStartCommand()`改用（仅当您使用`Context.startService()`.

但是，`onCreate()`如果您的服务确实运行（但只运行一次），则应该调用。

# javascript - jQuery elemet 的偏移量在第二次点击后返回不同的值

> ID：13095170
> 
> 赞同：0
> 
> 时间：2012-10-26T22:16:08.863
> 
> 标签：javascript, jquery

我试图在单击第一次单击时起作用的按钮后创建一个飞行效果，但是如果您再次单击它，则转到位置以某种方式离开：15 和顶部 15 或左侧：0，顶部：0

我认为问题出在 .clone() 和 .prependTo() 的某个地方，因为克隆复制了图像的 id，但我不知道如何在动画完成后删除克隆的图像。

所以我需要一些帮助来完成这项工作。

html 看起来像这样：

```
<div class="container">
 <div class="Pic" id="PiC_111"><a href="#"><img id="imG_111" src="img0.jpg"></a></div>
 <div class="Cont">
  <div class="desc"><!-- some text here --></div>
  <form method="POST" action="func.php">
    <!-- some form stuf -->
    <input type="submit" class="send" name="send" value="send" id="111" />
  </form>
 </div>
</div>
<div class="container">
 <div class="Pic" id="PiC_123"><a href="#"><img id="imG_123" src="img1.jpg"></a></div>
 <div class="Cont">
  <div class="desc"><!-- some text here --></div>
  <form method="POST" action="func.php">
    <!-- some form stuf -->
    <input type="submit" class="send" name="send" value="send" id="123" />
  </form>
 </div>
</div>
<!-- lot more of this --> 
```

JS看起来像这样

```
jQuery(document).ready(function($){
  $('input.send').click(function(){
    var imgID = (this.id);
    var posX = $('#imG_' + imgID).offset().left;
    var posY = $('#imG_' + imgID).offset().top;
    if($('#flytoID_' + imgID).length > 0) {
        var targetX = $('#flytoID_' + imgID).offset().left;
        var targetY = $('#flytoID_' + imgID).offset().top;
    } else {
        var targetX = $('#flytoTitleWrap').offset().left;
        var targetY = $('#flytoTitleWrap').offset().top;
    }
    var gotoX = targetX - posX + 20;
    var gotoY = targetY - posY + 20;
    var newImageWidth = $('#PiC_' + imgID).width() / 3;
    var newImageHeight = $('#PiC_' + imgID).height() / 3;

    $('#PiC_' + imgID + ' a img')
    .clone()
    .prependTo('#PiC_' + imgID +' a')
    .css({'position' : 'absolute', 'z-index' : '999999'})
    .animate({opacity: 0.4}, 100)
    .animate({opacity: 0.1, marginLeft: gotoX, marginTop: gotoY, width: newImageWidth, height: newImageHeight}, 1200, function(){
        $('#notificationsLoader').html('<img src=\"images/loader.gif\" />');
        $('#imglist').css({'background-position' : '-50px 0'}); 
    });
  });
}); 
```

提前致谢

我上传到 jsfiddle：http: [//jsfiddle.net/Piszi/vD256/12/](http://jsfiddle.net/Piszi/vD256/12/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:38:56.637

这真的取决于你想用这个来完成什么。如果您想在产品图片动画到购物篮后删除它，您可以将部分代码替换为以下内容：

```
var clone = $('#PiC_' + imgID + ' a img') //UPDATE
.clone(true)
.prependTo('#PiC_' + imgID +' a')
.css({'position' : 'absolute', 'z-index' : '999999'})
.animate({opacity: 0.4}, 100)
.animate({opacity: 0.1, marginLeft: gotoX, marginTop: gotoY, width: newImageWidth, height: newImageHeight}, 1200, function(){
        $('#notificationsLoader').html('<img src=\"images/loader.gif\" />');
        $('#imglist').css({'background-position' : '-50px 0'}); 
        $(clone).remove(); //UPDATE new line
    }); 
```

请注意， var`clone`保持对克隆对象的引用，因此您可以使用它做任何您想做的事情。示例您可以在动画完成后更改它的 id 并替换`$(clone).remove();`为`clone.attr('id', 'myNewID');`etc...更新 jsFiddle 链接：http: [//jsfiddle.net/salih0vicX/vD256/13/](http://jsfiddle.net/salih0vicX/vD256/13/)

我还注意到缺少一些 HTML 元素 - 例如：jQuery 正在引用 id="imglist"; 的元素。提供的 HTML 中没有这样的元素，导致没有加载 loader.gif；等等。无论如何，我希望这能回答你的问题。

# java - Java+MongoDB 托管

> ID：13095173
> 
> 赞同：0
> 
> 时间：2012-10-26T22:16:30.677
> 
> 标签：java, mongodb, cloud-hosting, mongodb-java

我有一个移动应用程序，我需要在后端支持 java/mongodb。我正在考虑使用各种组合。我不想花很多钱，因为它只是一个“爱好”应用程序，现在。

这些是我想到的各种选择：

在 EC2 上托管 Java 和 MogoDB -> 我必须管理从创建副本集到备份的所有 mongoDB 管理工作（我不是 mongo DB 大师）

在某个地方托管 Java（有什么建议吗？）和 mongolab.com 或 mongohq.com 上的 MongoDB -> 他们为我管理 mongodb，我只编写 Java 层并处理我的数据库设计。

那里有便宜的选择吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T22:53:35.657

我建议你试试[Heroku](http://www.heroku.com)。它支持很多插件，包括 MongoLab。我在那里托管了一个应用程序，使用一个 dyno*，它是完全免费的。

如果你想尝试一个简单的 java 应用，使用 mongodb 作为存储系统，看看这里： [https ://github.com/cartagena/heroku-vraptor-mongodb](https://github.com/cartagena/heroku-vraptor-mongodb)

> dyno 是 Heroku 上的基本组成单元，是运行单个用户指定命令的轻量级容器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T20:18:58.483

另一种选择是使用 MongoDB 作为 ObjectRocket 的服务。该服务负责运行 Mongo 的许多管理任务，您可以将 Java 应用程序保留在当前位置。

# javascript - 结合2个jsons对象

> ID：13095174
> 
> 赞同：3
> 
> 时间：2012-10-26T22:16:31.827
> 
> 标签：javascript, json

我有 2 个想要组合的 json 对象。我尝试使用`concat`和`merge`功能，但结果不是我想要的。任何帮助，将不胜感激。

```
var jason1 = 
{
  "book1": {
    "price": 10,
    "weight": 30
  },
  "book2": {
    "price": 40,
    "weight": 60
  }
}; 
```

这是另一个对象

```
var jason2 =
{
  "book3": {
    "price": 70,
    "weight": 100
  },
  "book4": {
    "price": 110,
    "weight": 130
  }
}; 
```

这就是我要的：

```
var jasons =
{
  "book1": {
    "price": 10,
    "weight": 30
  },
  "book2": {
    "price": 40,
    "weight": 60
  }
  "book3": {
    "price": 70,
    "weight": 100
  },
  "book4": {
    "price": 110,
    "weight": 130
  }
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:20:00.597

`Object.extend`从 Prototype.js 框架中查看方法的来源：

[https://github.com/sstephenson/prototype/blob/master/src/prototype/lang/object.js#L88](https://github.com/sstephenson/prototype/blob/master/src/prototype/lang/object.js#L88)

```
function extend(destination, source) {
  for (var property in source) {
    destination[property] = source[property];
  }
} 
```

那么用法就是……</p>

```
extend(jason1, jason2); 
```

该对象`jason1`现在包含您想要的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:22:34.927

您只需要手动迭代它们：

```
var both = [json1, json2],
    jasons = {};

for (var i=0; i < both.length; i++) {
  for (var k in both[i]) {
    if(both[i].hasOwnProperty(k)) {
       jasons[k] = both[i][k];
    }
  }
} 
```

这是一个工作[小提琴](http://jsfiddle.net/sc3TP/)。您可能想考虑如果存在重复键会发生什么 - 例如，如果`book3`两个 json 对象中都存在会发生什么。使用我提供的代码，第二个中的值总是获胜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T22:24:25.477

这是一种方法，尽管我确信还有更优雅的解决方案。

```
var jason1 = {
    "book1": {
        "price": 10,
        "weight": 30
    },
    "book2": {
        "price": 40,
        "weight": 60
    }
};
var jason2 = {
    "book3": {
        "price": 70,
        "weight": 100
    },
    "book4": {
        "price": 110,
        "weight": 130
    }
};
var jasons = {};
var key;
for (key in jason1) {
    if (jason1.hasOwnProperty(key) && !(jasons.hasOwnProperty(key))) {
        jasons[key] = jason1[key];
    }
}
for (key in jason2) {
    if (jason2.hasOwnProperty(key) && !(jasons.hasOwnProperty(key))) {
        jasons[key] = jason2[key];
    }
}
console.log(jasons); 
```

# c - 创建 convert_line_endings 函数

> ID：13095181
> 
> 赞同：0
> 
> 时间：2012-10-26T22:17:26.037
> 
> 标签：c, file-io, line-endings

我有一个应该具有 \r\n 行尾样式的配置文件，并且我想在我的程序中包含代码以检查和更正格式。现有代码：

```
int convert_line_endings(FILE *fp)
{
    char c = 0, lastc = 0, cnt = 0;
    while((c = fgetc(fp)) != EOF)
    {
        if((c == '\n') && (lastc != '\r'))
        {
            cnt++;
        //somehow "insert" a '\r' in here, after the previous char and before the '\n'
        }
        lastc = c;
    }
    return cnt;
} 
```

在 C 编程中，你不能“插入”一个字符（或者你可以吗？！），只是覆盖一个或另一个。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:21:03.017

不，您不能删除或插入。您可以做的是通过复制除`\r\n`序列之外的所有内容来写入新的临时文件，然后用它覆盖原始文件。

# xslt - XSLT v1.0 根据前一个节点的属性更新节点集中的属性

> ID：13095190
> 
> 赞同：0
> 
> 时间：2012-10-26T22:18:09.920
> 
> 标签：xslt, node-set

我有以下 XML 文件。

```
<Record 
  Name="My_Record"
  <Fields
    StartingBit="0"
    Size="3"
    Name="Field_1">
  </Fields>
  <Fields 
    StartingBit="1"
    Size="5"
    Name="Field_2">
  </Fields>
  <Fields
    StartingBit="2"
    Size="8"
    Name="Field_3">
  </Fields>
  <Fields
    StartingBit="3"
    Size="4"
    Name="Field_4"
  </Fields>
</Record> 
```

我想使用 XSLT 从前一个节点的 @StartingBit + @Size 正确更新 @StartingBit 属性 - 这将是当前节点的 @StartingBit 值。生成的 XML 应如下所示：

```
<Record 
  Name="My_Record"
  <Fields
    StartingBit="0"
    Size="3"
    Name="Field_1">
  </Fields>
  <Fields 
    StartingBit="3"
    Size="5"
    Name="Field_2">
  </Fields>
  <Fields
    StartingBit="8"
    Size="8"
    Name="Field_3">
  </Fields>
  <Fields
    StartingBit="16"
    Size="4"
    Name="Field_4"
  </Fields>
</Record> 
```

到目前为止，我对 XSLT 的最新尝试如下：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>
  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>
  <xsl:template match ="Fields/@StartingBit">
    <xsl:value-of select ="(preceding-sibling::Fields[1]/@StartingBit + preceding-sibling::Fields[1]/@Size)"/>
  </xsl:template>
</xsl:stylesheet> 
```

上面的转换不会产生我想要的 - 基本上 @StartingBit 不会改变。我不精通节点导航以获得我喜欢的结果 - 有人可以协助我进行转换吗？先感谢您。

*   洛伦兹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:54:22.593

**当这个简单的 XSLT**：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
version="1.0">
  <xsl:output omit-xml-declaration="no" indent="yes" />
  <xsl:strip-space elements="*" />

  <xsl:variable name="vStartingBit" select="/*/Fields[1]/@StartingBit" />

  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="Fields[position() &gt; 1]">
    <xsl:copy>
      <xsl:attribute name="StartingBit">
        <xsl:value-of
          select="$vStartingBit + sum(preceding-sibling::Fields/@Size)" />
      </xsl:attribute>
      <xsl:apply-templates select="@*[not(name() = 'StartingBit')]" />
    </xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

**...应用于原始 XML（更正为格式正确）：**

```
<?xml version="1.0" encoding="utf-8"?>
<Record Name="My_Record">
  <Fields StartingBit="0" Size="3" Name="Field_1" />
  <Fields StartingBit="1" Size="5" Name="Field_2" />
  <Fields StartingBit="2" Size="8" Name="Field_3" />
  <Fields StartingBit="3" Size="4" Name="Field_4" />
</Record> 
```

**...产生了预期的结果：**

```
<?xml version="1.0"?>
<Record Name="My_Record">
  <Fields StartingBit="0" Size="3" Name="Field_1" />
  <Fields StartingBit="3" Size="5" Name="Field_2" />
  <Fields StartingBit="8" Size="8" Name="Field_3" />
  <Fields StartingBit="16" Size="4" Name="Field_4" />
</Record> 
```

**解释：**

*   第一个模板是[`Identity Template`](http://www.dpawson.co.uk/xsl/sect2/identity.html). 其目的是将源文档中的所有节点和属性原样复制到结果文档中。
*   一个模板覆盖了身份模板。其目的是将原始起始位添加到正确的`@Size`属性（当前元素之前的那些`<Fields>`），从而形成每个后续`<Fields>`元素`@StartingBit`属性的值。

# python - 使用 ASP 的自动填写表格

> ID：13095194
> 
> 赞同：1
> 
> 时间：2012-10-26T22:18:29.500
> 
> 标签：python, web-scraping

我正在尝试编写一些代码来自动填写此网络表单：

[http://scoweb.sco.ca.gov/UCP/](http://scoweb.sco.ca.gov/UCP/)

然后读取返回的结果。当我有 UCP 时，我会查找我的姓名并通知自己。

我曾尝试用 C#(System.Net)、curl（结合 formfind）、Ruby（Mechanize）和 Python（Scrapy，urllib2）编写程序。我的所有脚本都适用于与数据库通信的常规 HTML 表单，但这个脚本什么也不返回。

我的理论是因为该站点使用 ASP，而我没有采取任何措施来解决这个问题？

任何工作代码，尽管首选 python，填写表格并返回结果将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:28:16.887

我认为问题是因为表单使用了 javascript。你可以使用 selenium 来做这样的事情[http://seleniumhq.org/](http://seleniumhq.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T10:45:31.947

```
#!/usr/bin/env python

from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import Select
from selenium.common.exceptions import NoSuchElementException
import unittest, time, re

class Shiply(unittest.TestCase):
    def setUp(self):
        self.driver = webdriver.Firefox()
        self.driver.implicitly_wait(30)
        self.base_url = "http://scoweb.sco.ca.gov/"  #California UCP
        self.verificationErrors = []

    def test_shiply(self):
        driver = self.driver
        driver.get(self.base_url + "/UCP/")
        driver.find_element_by_id("ctl00_ContentPlaceHolder1_txtLastName").clear()
        driver.find_element_by_id("ctl00_ContentPlaceHolder1_txtLastName").send_keys("YOUR_NAME")
        driver.find_element_by_id("ctl00_ContentPlaceHolder1_btnSearch").click()

    def is_element_present(self, how, what):
        try: self.driver.find_element(by=how, value=what)
        except NoSuchElementException, e: return False
        return True

    def tearDown(self):
        self.driver.quit()
        self.assertEqual([], self.verificationErrors)

if __name__ == "__main__":
    unittest.main() 
```

# logging - CXF：无法记录肥皂消息

> ID：13095196
> 
> 赞同：0
> 
> 时间：2012-10-26T22:18:54.750
> 
> 标签：logging, soap, cxf, config

在标准的 eclipse java 项目中，cxf.xml 配置文件的正确位置在哪里？我正在尝试启用在独立 jar 格式客户端 ws 消费者上记录的肥皂消息。使用 wsdltojava 实用程序生成的工件并使用自动生成的起点测试客户端，它工作得非常好。我根据文档创建了配置文件，但在我的控制台中我没有看到任何事情发生。这是我的 cxf.xml 文件内容：

```
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:cxf="http://cxf.apache.org/core"
      xsi:schemaLocation=" 
http://cxf.apache.org/core http://cxf.apache.org/schemas/core.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

<bean id="abstractLoggingInterceptor" abstract="true">
    <property name="prettyLogging" value="true"/>
</bean>
<bean id="loggingInInterceptor" class="org.apache.cxf.interceptor.LoggingInInterceptor" parent="abstractLoggingInterceptor"/>
<bean id="loggingOutInterceptor" class="org.apache.cxf.interceptor.LoggingOutInterceptor" parent="abstractLoggingInterceptor"/>

<cxf:bus>
    <cxf:inInterceptors>
        <ref bean="loggingInInterceptor"/>
    </cxf:inInterceptors>
    <cxf:outInterceptors>
        <ref bean="loggingOutInterceptor"/>
    </cxf:outInterceptors>
    <cxf:outFaultInterceptors>
        <ref bean="loggingOutInterceptor"/>
    </cxf:outFaultInterceptors>
    <cxf:inFaultInterceptors>
        <ref bean="loggingInInterceptor"/>
    </cxf:inFaultInterceptors>
</cxf:bus>  

</beans> 
```

我试图把它放在项目根目录和 src 下，但没有。我错过了什么？

我的客户端代码是这样的：

公共最终类 ClientMHttps {

```
private static final QName SERVICE_NAME = new       QName("http://thecompany/service-b", "myendpoint-v1");

private  myendpointPortType port ;

public ClientMHttps() throws java.lang.Exception {
    URL wsdlURL = myendpointV1.WSDL_LOCATION;

    myendpointV1 ss = new myendpointV1(wsdlURL, SERVICE_NAME);
    port = ss.getmyendpointPortTypeEndpointHttpsM(); 

}

    public DeleteMarkedStatusResponse do_DeleteMarkedStatus(DeleteMarkedStatusRequest  _deleteMarkedStatus_body) throws java.lang.Exception
    {
    System.out.println("Invoking deleteMarkedStatus...");
    javax.xml.ws.Holder<HeaderType> _header =  this.HeaderFarm();
    DeleteMarkedStatusResponse _deleteMarkedStatus__return = port.deleteMarkedStatus(_deleteMarkedStatus_body, _header);
    System.out.println("deleteMarkedStatus.result=" + _deleteMarkedStatus__return);
    return _deleteMarkedStatus__return;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-10T21:12:06.033

`<jaxws:client>`应将一个元素添加到将创建 CXF Web 服务客户端的 Spring 配置文件 (cxf.xml)。然后，您将需要在代码中使用此客户端 bean 来调用 Web 服务。

根据您要使用的日志框架，您可能需要按照[此处](https://cxf.apache.org/docs/debugging-and-logging.html#DebuggingandLogging-UsingLog4jInsteadofjava.util.logging)`META-INF/cxf/org.apache.cxf.Logger`所述进行配置。

我创建了博客文章，更详细地解释了如何为[log4j](http://www.source4code.info/2015/01/jaxws-cxf-logging-request-response-soap-messages-log4j.html)、[logback](http://www.source4code.info/2014/09/jaxws-cxf-logging-inbound-outbound-soap-messages-logback.html)或[log4j2配置 CXF。](http://www.source4code.info/2015/01/jaxws-cxf-logging-request-response-soap-messages-log4j2.html)

*请注意，您还可以使用不那么冗长的 CXF 日志记录功能。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T15:35:01.120

我相信只是需要修复的 bean 名称和 cxf.xml 位置。

在 src/main/resources/cxf.xml 中，您可以使用这样的 cxf.xml 文件来记录所有 CXF 消息：

```
<beans xmlns="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:cxf="http://cxf.apache.org/core"
      xsi:schemaLocation="
http://cxf.apache.org/core http://cxf.apache.org/schemas/core.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

    <bean id="logInbound" class="org.apache.cxf.interceptor.LoggingInInterceptor"/>
    <bean id="logOutbound" class="org.apache.cxf.interceptor.LoggingOutInterceptor"/>

    <cxf:bus>
        <cxf:inInterceptors>
            <ref bean="logInbound"/>
        </cxf:inInterceptors>
        <cxf:outInterceptors>
            <ref bean="logOutbound"/>
        </cxf:outInterceptors>
        <cxf:outFaultInterceptors>
            <ref bean="logOutbound"/>
        </cxf:outFaultInterceptors>
        <cxf:inFaultInterceptors>
            <ref bean="logInbound"/>
        </cxf:inFaultInterceptors>
    </cxf:bus> 
</beans> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-24T14:18:07.833

尝试为“org.apache.cxf.services”添加过滤器。

```
<logger level="INFO" name="org.apache.cxf.services"/> 
```

日志不会为实现服务类的包生成，而是在自定义位置生成。

# c# - Spinner.js 不在我的 asp.net 页面中旋转？

> ID：13095197
> 
> 赞同：1
> 
> 时间：2012-10-26T22:18:58.890
> 
> 标签：c#, asp.net, spinner

我不能发布我的所有代码，但我会展示其中的大部分。

因此，这些是我处理微调器功能的代码片段。它让我看到微调器，但它不旋转。我有一些代码也可以停止微调器，但我已经把它拿出来了，它仍然没有旋转它只是显示微调器冻结。有任何想法吗？我一直在看这个，我无法确定我的问题出在哪里。也许它与在 asp.net 中使用它有关。我的文件中也有 spinmin.js 的脚本，但这里没有显示。

```
//aspx
<div id="waitDiv" class="divWait" ></div>

//css
.divWait { text-align: center; width: 950px; height: 190px; }

//javascript
var spinner;

function doSpinner() {
            var opts = createSpinnerOpts();
            var target = document.getElementById('waitDiv');
            if (typeof(spinner) == 'undefined') {
                spinner = new Spinner(opts).spin(target);
            }

}

function createSpinnerOpts() {
            var opts = {
                lines: 13, // The number of lines to draw
                length: 7, // The length of each line
                width: 8, // The line thickness
                radius: 40, // The radius of the inner circle
                corners: 1, // Corner roundness (0..1)
                rotate: 89, // The rotation offset
                color: '#000', // #rgb or #rrggbb
                speed: 0.5, // Rounds per second
                trail: 100, // Afterglow percentage
                shadow: true, // Whether to render a shadow
                hwaccel: true, // Whether to use hardware acceleration
                className: 'spinner', // The CSS class to assign to the spinner
                zIndex: 2e9, // The z-index (defaults to 2000000000)
                top: 'auto', // Top position relative to parent in px
                left: 'auto' // Left position relative to parent in px
            };
            return opts;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:23:48.790

好吧，我是今天的傻瓜。将微调器添加为类，它将旋转....

```
<div id="waitDiv" class="spinner" ></div> 
```

# perl - 使用 mod_perl 捕获异常的堆栈跟踪

> ID：13095203
> 
> 赞同：1
> 
> 时间：2012-10-26T22:19:33.847
> 
> 标签：perl, apache, cgi, mod-perl

我正在将一些 cgi 脚本转换为 mod_perl。在 cgi 下，每当有未捕获的异常时，我使用 sig DIE 来捕获堆栈跟踪，并记录它们。这很好用：每当脚本中出现问题时，我都会在我的应用程序日志中得到一个很好的堆栈跟踪。代码是：

```
BEGIN {
  $SIG{__DIE__} = \&sigDie;
}

sub sigDie {
  return 1 if $^S; # we are in an eval block

  my ($error) = @_;
  cluck("Caught fatal error: $error"); # put a stack trace in the logs via warn
  local $Log::Log4perl::caller_depth = $Log::Log4perl::caller_depth + 1;
  FATAL @_; # call log4perl's fatal

  return 1;
} 
```

然而，在 Apache2::Registry 下，我的代码不再被调用，它只是在它死时停止记录。我认为这是因为我的代码正在被 mod_perl 评估，但我在上面的例程中取消了评估检查，但我仍然没有被调用。

有什么办法可以在 mod_perl 下得到我想要的东西？我发现这些自动记录堆栈跟踪非常有用，如果我不得不放弃它们，我会错过它们。到目前为止，我对如何获得它一无所知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:43:59.157

我不知道答案，但可以想到一些可能性和方法来检查。

*   log4perl 出了点问题。

调用是否`FATAL`仍然在`__DIE__`处理程序之外工作？

*   根本没有记录错误。

移除模具处理程序，是否记录异常？

*   某些东西正在取代您的`$SIG{__DIE__}`处理程序。

由于您正在设置它`BEGIN`，因此 Apache2::Registry 或其他程序中的某些东西可能正在替换它。我会通过`$SIG{__DIE__}`在抛出错误之前验证其中的内容来找出答案。也许使用可以处理代码引用的[Data::Dump::Streamer](https://metacpan.org/module/Data%3a%3aDump%3a%3aStreamer)将其转储出来，您也许能够弄清楚是什么设置了它。

注册模具处理程序的一种更安全、更有礼貌的方法是……

```
local $SIG{__DIE__} = ...;

...the rest of your program... 
```

这将在每个请求上重新注册您的处理程序，并且不会超出其范围之外的全局处理程序。

希望这有助于弄清楚发生了什么。

# fancybox - 如何从 v2.x 升级到 FancyBox v3？

> ID：13095207
> 
> 赞同：2
> 
> 时间：2012-10-26T22:20:00.337
> 
> 标签：fancybox

大约一个月前，我在 2012 年 9 月 20 日购买了 Fancyapps FancyBox-v2.1.0-0，以便在多个域上使用它。现在，第三版已经出来了。我怎样才能升级到它？我必须再次支付全价吗？

# javascript - 设置描述元标记

> ID：13095209
> 
> 赞同：2
> 
> 时间：2012-10-26T22:20:06.697
> 
> 标签：javascript, getelementbyid, getelementsbyclassname

我最近在我网站上的几个页面中添加了以下 Javascript 代码行，以便从 CSS 类为“Category-H1”的 H1 元素中提取标题标签。

```
document.title = document.getElementsByClassName("Category-H1")[0].innerHTML; 
```

我很好奇，我可以做类似的事情来使用 JS 从我的 H2 元素中提取描述标签吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T22:23:03.587

这是可行的，但我不确定它是否能实现你所希望的。大多数人将元描述标签用于 SEO 目的，但如果描述是在页面加载后由 JavaScript 设置的，许多（大多数？）搜索引擎将无法识别描述*。不过，如果你想这样做：

```
var meta=document.getElementsByTagName("meta");
for (var i=0; i<meta.length; i++) {
    if (meta[i].name.toLowerCase()=="description") {
        meta[i].content=document.getElementsByClassName("Category-H1")[0].innerHTML;
    }
} 
```

希望这可以帮助！

* * *

*坦率地说，我不是根据*经验*说话，只是常识。元信息是动态的确实没有意义，所以即使蜘蛛足够聪明地运行 JavaScript，为什么它会在这样做之后重新检查元信息？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:22:40.497

您可以使用该[`getAttribute()`](http://www.w3schools.com/jsref/met_element_getattribute.asp)功能来执行此操作：

```
document.title = document.getElementsByClassName("Category-H1")[0].getAttribute("yourDescriptionMetaTag"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-26T22:26:47.223

我不认为这对SEO有好处。虽然它可能有效，但我不认为蜘蛛期望这些标签是动态的。但是，如果 SEO 不是重点，那么这里有另一个答案，它显示了 jquery 的方式。

[Javascript动态更改元数据/元标记](https://stackoverflow.com/questions/9231845/javascript-to-change-metadata-metatags-dynamically)

# entity-framework - 在 ADO.NET 实体框架中保存导航属性

> ID：13095215
> 
> 赞同：0
> 
> 时间：2012-10-26T22:20:35.830
> 
> 标签：entity-framework, ado.net, navigation-properties

我正在使用 ADO.NET 实体框架。我使用以下代码在数据库中添加了一个“用户”实体：

```
user new_user = new user();
novus_daedalus_dbEntities dbEntity = new novus_daedalus_dbEntities();

new_user.CF = "xyz";
new_user.username = "peter";
new_user.password = "pw";

dbEntity.user.Add(new_user);
dbEntity.SaveChanges(); 
```

'user' 类的 CF 属性是 'people' 类属性的外键。数据库表 'people' 有一条 CF='xyz' 的记录。当方法'dbEntity.SaveChanges();' 执行时，在“用户”数据库表中创建新记录没有问题。问题是导航属性“new_user.people”为“null”，即使在执行“dbEntity.SaveChanges();”之后也是如此。正常吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:38:52.050

这是正常的，`SaveChanges`用数据库生成的 id 填充 Id 属性，但不进行查询以加载您可能不需要的导航属性，这没有任何意义。

# sql - SQL 引用表中没有主键或候选键

> ID：13095216
> 
> 赞同：2
> 
> 时间：2012-10-26T22:20:38.703
> 
> 标签：sql, sql-server, sql-server-2008

这是我编写 SQLSever 表达式时的问题：

> *引用表 'Room' 中没有与外键 'FK_ Booking* _RoomNo__4E298478'
> 中的引用列列表匹配的主键或候选键。

 *还有我的程序的一些快照：

```
CREATE TABLE Booking(
   HotelNo  NVARCHAR(4)     not null,
   GuestNo      SMALLINT,  
   DateFrom DATETIME    not null,
   DateTo       DATETIME,
   RoomNo       SMALLINT    not null,

   PRIMARY KEY (HotelNo,DateFrom,RoomNo), 
   FOREIGN KEY (HotelNo) REFERENCES Hotel(HotelNo),
   FOREIGN KEY (GuestNo) REFERENCES Guest(GuestNo),
   FOREIGN KEY (RoomNo) REFERENCES Room(RoomNo));  <---trouble on this line

CREATE TABLE Room(
   RoomNo       SMALLINT    not null, 
   HotelNo  NVARCHAR(4)     not null, 
   RoomType     NVARCHAR(25),
   Price        DECIMAL(5,2),

   PRIMARY KEY (RoomNo,HotelNo), 
   CONSTRAINT fk_Room FOREIGN KEY (HotelNo) REFERENCES Hotel(HotelNo)); 
```

这是旅馆的桌子

```
CREATE TABLE Hotel(
   HotelNo  NVARCHAR(4)     not null,
   HotelName    NVARCHAR(25),
   City     NVARCHAR(25),

   PRIMARY KEY (HotelNo) ); 
```

我尝试对这个问题进行一些搜索，它说这可能是由于表 Room 中没有定义主键导致的，但如上所述，它已定义。

有人可以帮我解决这个问题吗？

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:34:21.410

Any reference to composite key must also include both columns.

```
FOREIGN KEY (RoomNo, HotelNo) REFERENCES Room(RoomNo, HotelNo)) 
```*

# crash - timeIntervalSince1970 与 NSUserDefaults 崩溃

> ID：13095217
> 
> 赞同：0
> 
> 时间：2012-10-26T22:20:39.407
> 
> 标签：crash, nsstring, nsdate, nsuserdefaults, nstimeinterval

我试图每 4 天显示一次 UIALertView。但是因为：

```
NSInvalidArgumentException', reason: '-[__NSCFString timeIntervalSince1970]: 
```

我在这里尝试使用不同的方法，例如以下代码：[https](https://stackoverflow.com/a/4278151/1014564) ://stackoverflow.com/a/4278151/1014564导致相同的崩溃。

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSDate *firstLaunchDate = [defaults objectForKey:@"timeStamp"];
NSDate *dateNow = [[NSDate alloc] init];

if (!firstLaunchDate){

    NSString *nowTimestamp = [NSString stringWithFormat:@"%f", [[NSDate date] timeIntervalSince1970]];

    [defaults setObject:nowTimestamp            forKey:@"timeStamp"];
    [defaults synchronize];

} else if (([dateNow timeIntervalSince1970] - [firstLaunchDate timeIntervalSince1970]) > 86400*4){

 ///UIAlertView Here..

} 
```

答案表示赞赏并将被接受。我知道这可能是一个简单的错误，我已经过了昏昏欲睡的地步。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:27:27.993

```
nowTimestamp = [NSString stringWithFormat:...];
[defaults setObject:nowTimestamp forKey:@"timeStamp"]; 
```

然后

```
NSDate *firstLaunchDate = [defaults objectForKey:@"timeStamp"]; 
```

所以你基本上是`NSString`在用户默认值中设置一个，但你希望得到一个`NSDate`. 既然`NSUserDefaults`不是魔法，那就不会发生。如果要存储日期，请使用

```
[defaults setObject:[NSDate date] forKey:@"timeStamp"]; 
```

只有**这样**你才能`timeIntervalSince1970`在你从`NSUserDefaults`.

# quicksort - QuickSort 中的 Media-of-3 分区

> ID：13095224
> 
> 赞同：0
> 
> 时间：2012-10-26T22:21:12.530
> 
> 标签：quicksort

我试图用 3 分区中位数来理解快速排序。在找到数组中第一个、中间和最后一个元素的中值后，一种常见的做法是将中值与数组中倒数第二个元素（第 n-1 个索引）交换。我们这样做有什么特别的原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T18:53:38.207

原因是该算法不仅找到中位数，还对低、中、高元素进行排序。在三个排列之后，您知道 a[middle]<=a[high]。所以只需要对high之前的元素进行分区，因为a[high]大于等于pivot。

让我们看一个例子：low=0，middle=4，high=8。你的数组是这样的：

lowerOrEqualToPivot XXX 枢轴 XXX GreaterOrEqualToPivot

如果将中间与高交换，则需要在括号之间划分 8 个元素：

[ lowerOrEqualToPivot XXX 更大OrEqualToPivot XXX ] 枢轴

如果将 middle 与 high-1 交换，则只需要拆分 7 个元素：

[ lowerOrEqualToPivot XXXXXX ] 枢轴更大OrEqualToPivot

顺便说一句，第一行有一个错误：

int 中间 = ( 低 + 高 ) / 2; //错误的int middle = ( low + high ) >>> 1; //正确的

原因是如果 (low + high) 大于 Integer.MAX_VALUE 您将有溢出，而中间将是一个负数。第二行总是会给你一个积极的结果。

# joomla - 不同页面侧边栏中的 Joomla 更改模块

> ID：13095228
> 
> 赞同：2
> 
> 时间：2012-10-26T22:21:58.473
> 
> 标签：joomla, joomla2.5, joomla-extensions

我正在使用**Joomla 2.5.7**并想问，当我更改为另一个页面时，如何更改侧边栏中的一堆模块。一个澄清我的问题的例子：

我在导航栏上有 3 个链接：

**活动
商店
博客**
*和主页作为 index.html（逻辑）。*

现在，我想在**事件**中显示侧边栏中的模块“*去哪里*”和“*关于位置*”。

在**商店**中，我想在侧边栏中显示模块“*关于经销商*”、“*运输*”和“*图像*”，而没有“去哪里”和“关于位置”模块。

在**博客**中，我想在侧边栏中显示模块“*关于作者*”，而没有上面的模块（去哪里，关于位置......）。

所以，**我知道**我可以这样做（或类似的）：

`<?php if ($this->countModules('sidebar-a and sidebar-b and sidebar-c')): ?>`
`<jdoc:include type="modules" name="sidebar-a" />`
`<jdoc:include type="modules" name="sidebar-b" />`
`<jdoc:include type="modules" name="sidebar-c" />`
`<?php endif; ?>`

SIDEBAR-A：*“去哪里”*和*“关于位置”* SIDEBAR-B：*“关于经销商”、“运输”*和*“图片”* SIDEBAR-C：*“关于作者”*

**但这不是我的计划！**

我只想要位置“sidebar-a”并且如果模块不用于此页面，则模块会被隐藏（如在 countModules 中）。
我在赠款框架上看到了这种方法：

`<?php /** Begin Main Body **/ ?>`
`<?php echo $gantry->displayMainbody 'mainbody','sidebar','standard','standard','standard','standard','standard'); ?>`
`<?php /** End Main Body **/ ?>`

你看到的只是简单的代码，但还有其他变量。在 index.html 中非常简单，但是如果我复制和粘贴，这将不起作用；）（逻辑）
我不知道该怎么做。我不喜欢获得这个框架，只是为了这个单一的侧边栏。但是肯定有这种granty framework之类的方式，但是我对代码不是很了解……我只是一个php的业余爱好者。我想一定有一个 JavaScript 文件，它隐藏和显示这些不同的模块。

您可以在此处看到带有许多模块的单个侧边栏的现场演示，这些模块被隐藏并显示在每个页面上： http: [//app.ohanah.com/demo-v2/rt/index.php](http://app.ohanah.com/demo-v2/rt/index.php)

有人知道如何运行这个侧边栏吗？

感谢阅读和帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T19:43:39.610

为了更好地处理，您可以使用 Module Everywhere 扩展，在 JED 中查找它。它不仅可以帮助您将模块分配给菜单链接，甚至可以分配给文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T01:12:03.487

在 Joomla 后端，进入模块管理器，打开您要更改的模块，在左下角，您可以将模块分配到特定页面。这应该是您正在寻找的内容，它将使您不必对其进行硬编码。

# c# - 'fixed' 的要求在 C# 中似乎不一致

> ID：13095238
> 
> 赞同：3
> 
> 时间：2012-10-26T22:22:51.270
> 
> 标签：c#, pointers, fixed

我有一个包含字段的有序结构..

```
[StructLayout(LayoutKind.Explicit)]
public unsafe struct RunBlock_t {
    [System.Runtime.InteropServices.FieldOffset(0)]  public fixed byte raw[512];
} 
```

如果我在函数中声明它并想使用指针，它可以正常工作..

```
{
  RunBlock_t r = new RunBlock_t();
  for (int i=0; i<512; i++) r.raw[i]=0;
} 
```

但是如果我在范围之外声明变量，它需要一个固定的实现

```
RunBlock_t r;
{
  r = new RunBlock_t();
  fixed (byte* ptr = r.raw) for (int i=0; i<510; i++) ptr[i]=0;
} 
```

为什么会有这种行为差异？

--- 已编辑 -----

只想再次声明任何其他排列都不起作用。

```
 unsafe void foo() {
        RunBlock_t r = new RunBlock_t();
        fixed (byte* ptr = r.raw) for (int i = 0; i < 512; i++) ptr[i] = 0;
    } 
```

生成***您不能使用固定语句来获取已经固定表达式的地址***并且不会编译。

```
 RunBlock_t r;
    unsafe void foo() {
      r = new RunBlock_t();
      for (int i=0; i<512; i++) r.raw[i]=0;
    } 
```

生成***您不能使用包含在未固定表达式中的固定大小的缓冲区。尝试使用固定语句。***并且不编译。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T22:45:40.007

你的问题没有任何意义。您将数组与指针混淆了，可能是因为在 C 和 C++ 中，数组在大多数情况下会迅速降级为指针，包括`[]`下标运算符。

但这是 C#。数组和指针是完全独立的野兽（尽管您可以将数组强制转换为指针，但您必须在`fixed`语句中这样做，以确保指针保持有效）。你应该比较

```
{
  RunBlock_t r = new RunBlock_t();
  for (int i=0; i<512; i++) r.raw[i]=0;
} 
```

到

```
RunBlock_t r;
{
  r = new RunBlock_t();
  for (int i=0; i<512; i++) r.raw[i]=0;
} 
```

两者都使用数组。要不然

```
{
  RunBlock r = new RunBlock_t();
  fixed (byte* ptr = r.raw) for (int i=0; i<512; i++) ptr[i]=0;
} 
```

到

```
RunBlock_t r;
{
  r = new RunBlock_t();
  fixed (byte* ptr = r.raw) for (int i=0; i<512; i++) ptr[i]=0;
} 
```

两者都使用指针。

然后你会看到声明变量的作用域与 needing 完全没有关系`fixed`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-27T18:39:43.823

不幸的是，你稍微混淆了这个问题。**如果我完全**从问题中复制，那么这很好：

```
 {
        RunBlock_t r = new RunBlock_t();
        for (int i = 0; i < 512; i++) r.raw[i] = 0;
    } 
```

还有这个：

```
 RunBlock_t r;
    {
        r = new RunBlock_t();
        fixed (byte* ptr = r.raw) for (int i = 0; i < 510; i++) ptr[i] = 0;
    } 
```

提出：

> 您不能使用固定语句来获取已固定表达式的地址

如果我们删除`fixed`，它可以工作。

你应该展示的是函数签名，即

```
RunBlock_t r;
unsafe void Bar()
{
    {
        r = new RunBlock_t();
        fixed (byte* ptr = r.raw) for (int i = 0; i < 510; i++) ptr[i] = 0;
    }
} 
```

现在意思更清楚了。你看，当你`fixed`用来访问一个值中的固定缓冲区时，你实际上并没有修复*缓冲区*，也没有修复*值*；您*实际*修复的是包含对象，即具有该`r`字段的对象。这是为了防止 GC 在堆栈上移动它，如果我们当时将它作为指针访问，这将是不好的。在我们上面的例子中，我们的表达式是真的`fixed (byte* ptr = this.r.raw)`，被固定的东西是：`this`。

如果我们**只有**一个结构体作为本地结构，情况就不同了。本地人在*堆栈*上；它们（正如前面的消息所暗示的）*已经修复*；堆栈永远不会被 GC 重定位。

所以：

*   如果您有一个结构作为局部变量，则不需要使用`fixed`-您只是直接将其作为指针访问（通过`ldloca`）
*   如果您有一个结构**是对象中的一个字段**，则需要使用`fixed`, 在操作期间将对象固定到位
*   如果您传递对结构的*引用*（即`ref RunBlock_t`参数），那么您必须使用它`fixed` **以防万一**它是对象上的字段；如果引用最终解析为堆栈，那么它不需要做任何事情
*   请注意，这里关于“对象上的字段”的所有内容也同样适用于“数组中的值”，即如果我们正在谈论`someArray[8]`（因为您可以就地操作数组的内容）

# jquery - jQuery animate() 与多个函数调用冲突

> ID：13095241
> 
> 赞同：3
> 
> 时间：2012-10-26T22:23:03.273
> 
> 标签：jquery, jquery-animate

似乎当我使用单独的 div ID 对函数 stockTicker() 进行两次调用时 - 这两个代码不会顺利运行并跳来跳去：http: [//jsfiddle.net/Tb6VY/](http://jsfiddle.net/Tb6VY/)

但是，如果我只有一个代码，它就可以正常工作：http: [//jsfiddle.net/39JJ4/](http://jsfiddle.net/39JJ4/)

关于如何让第一个工作的任何想法？

功能：

```
( function($) {
    $.fn.stockTicker = function(options) {

        if (typeof (options) == 'undefined') {
            options = {};
        }

        var settings = $.extend( {}, $.fn.stockTicker.defaults, options);
        var $ticker = $(this);

        function startTicker() {
            //stopTicker();
            $firstElem = $ticker.children(":first");
            var $width = $firstElem.width();
            $ticker.stop().animate({
                "right": "+="+$width+"px"
            }, {
                duration: settings.speed*200,
                easing: 'linear',
                complete: function() {
                    $ticker.css({"right": "-="+($width)+"px"});
                    $firstElem.clone().appendTo($ticker);
                    $firstElem.remove();
                    startTicker();
                }
            });
        }

        function stopTicker() {
            $ticker.stop();
        }

        $ticker.hover(stopTicker, startTicker);
        startTicker();
    };

    $.fn.stockTicker.settings = {};
    $.fn.stockTicker.defaults = {
        tickerID :null,
        speed :1,
    };
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:25:40.190

您忘记声明`$firstElem` `var`，导致它被视为“全局”变量（因此与其他股票代码发生冲突）。

声明后`var $firstElem = $ticker.children(":first");`，自动收报机工作正常。小提琴：http: [//jsfiddle.net/Tb6VY/2/](http://jsfiddle.net/Tb6VY/2/)

# ios - 在 NSUserDefaults 中存储一组 UIViews

> ID：13095243
> 
> 赞同：0
> 
> 时间：2012-10-26T22:23:17.143
> 
> 标签：ios, arrays, uiview, store, nsuserdefaults

我正在尝试向 NSDefault 添加一个 uiviews 数组，但它似乎并没有保留该数组。有谁知道为什么？我还尝试将每个视图存储在 nsvalue 中，然后将其存储在 nsdefault 中，但这仍然不起作用。

```
NSArray *arr = [[NSArray alloc] initWithObjects:[NSValue valueWithNonretainedObject:myView], nil]];
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setObject:arr forKey:@"myKey"];

NSArray *resultArray = [defaults objectForKey:@"myKey"]; 
```

结果数组为零！

谢谢

我之所以尝试这样做是因为这些是我的 uitableview 的标题视图。由于创建它们需要时间，我只想创建一次并存储它们以供将来访问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:28:19.417

来自 NSUserDefaults 的文档：

> NSUserDefaults 类提供方便的方法来访问常见类型，例如浮点数、双精度数、整数、布尔值和 URL。默认对象必须是一个属性列表，即以下实例（或集合实例的组合）：NSData、NSString、NSNumber、NSDate、NSArray 或 NSDictionary。如果要存储任何其他类型的对象，通常应该将其归档以创建 NSData 的实例。有关更多详细信息，请参阅首选项和设置编程指南。

如果你想在 NSUserDefaults 中放置一个 UIView（为什么？），你需要先将它归档到一个 NSData 对象中。

但是你需要问自己为什么要在 NSUserDefaults 中放置一个视图。您应该只在 NSUserDefaults 中放置一些数据。视图显示数据。获取数据后，很容易重新显示视图。考虑将一些需要的数据放在 NSUserDefaults 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T22:29:05.763

你确定要这样做吗？最好将模型数组存储到数据库或某个文件中，并在需要时从它们重新创建视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T22:57:03.533

啊哈！你不是第一个面对这个问题的人。我自己没有遇到过此类问题，但在下面的链接中，是一个包含代码的博客，可让您缓存和重用您的视图。然后，您只需要在启动时重新创建视图。示例代码：

[缓存 UIView 以在 tableview 中重用](http://www.dimzzy.com/blog/2010/02/uiviews-cache-for-reuse/)

# mysql - 如何查询 1 个包含 6 列的表，其中 3 列有条件

> ID：13095244
> 
> 赞同：0
> 
> 时间：2012-10-26T22:23:18.777
> 
> 标签：mysql, sql, database, sqlite

我要做的只是查询我的表，其中包含 6 列，其中 3 列必须满足条件

我的表的信息表名 My_table 列 a1、a2、a3、a4、a5、a6

我尝试过的代码如下，当然不起作用

```
$myquery = "SELECT * FROM My_table WHERE a2='$variable1' AND a3='$variable2' AND a6='$variable3' ORDER BY a2 ASC";
$myresult = mysql_query($myquery); 
```

我的结果必须包含满足上述条件的行。

这样做的正确方法是什么？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:29:07.630

失踪：

```
$result = mysql_fetch_array($myresult); 
```

您可以使用以下命名约定来避免此类错误：

```
$my_sql = "SELECT * FROM My_table WHERE a2='$variable1' AND a3='$variable2' AND a6='$variable3' ORDER BY a2 ASC";
$my_query = mysql_query($my_sql);
$my_result = mysql_fetch_array($my_query); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T19:18:16.037

好的，这就是我让它工作的方式，它对我很有用，所以它也可以帮助你。

由于我正在将表的 3 列与 3 个变量进行比较，并且我知道它们是固定的，并且必须按顺序准确地满足这些条件，因此我制作了一个字符串，其中包含我正在搜索的 3 列的字符串，然后做了与我的变量相同，然后将它们相互比较，这给了我想要的结果。

这是我的问题的解决方案代码：

```
$myquery = "SELECT a2 a3 a6 FROM My_table WHERE concat(UPPER(a2), UPPER(a3), UPPER(a6)) LIKE concat(UPPER('$variable1'), UPPER('$variable2'), UPPER('$variable3')) ORDER BY a2 ASC"; 
```

$myresult = mysql_query($myquery);

希望它也对其他人有所帮助。

# c++ - 计算小数点后的小数位数

> ID：13095247
> 
> 赞同：0
> 
> 时间：2012-10-26T22:23:27.467
> 
> 标签：c++, double

我想计算浮点数的小数点后的小数位数。当实数在二进制系统中没有表示时，问题显然会出现，例如`3.5689113`.

我想知道 - 例如，如果有人在源代码中写这个实数 - 是否有可能得到数字 7，即小数点后的位数

例如，以下天真的代码不起作用：

```
int main()
{  
    double num = 3.5689113;

    int count = 0;
    num = abs(num);
    num = num - int(num);

    while ( abs(num) >
        0.0000001 )
    {
        num = num * 10;
        count = count + 1;
        num = num - int(num);
    }

    std::cout << count; //48
    std::cin.ignore();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:54:06.493

为了防止浮点近似引入的错误，请尽早将数字转换为整数并使用它。

```
double num = 3.5689113;

int count = 7;  // a maximum of 7 places
num = abs(num);
int remainder = int(0.5 + 10000000 * (num - int(num)));

while ( remainder % 10 == 0 )
{
    remainder = remainder / 10;
    --count;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T22:34:07.130

When something like that doesn't work, you try to print the numbers.

I did so [here](http://ideone.com/gATI6Z), and I found you had some floating number precision issues. I changed the `int` rounding to `ceil` rounding and it worked like a charm.

Try putting the `int`s back and you'll see :)

**EDIT:** a better strategy than using `ceil`s (which can give the same rounding problems) is to just round the numbers to the nearest integer. You can do that with `floor(myNumber+0.5)`.

Here's the modified code

```
int main()
{  
    double num = 3.56891132326923333;

    // Limit to 7 digits
    num  = floor(num*10000000 + 0.5)/10000000;

    int count = 0;
    num = abs(num);
    num = num - floor(num+0.5);

    while ( abs(num) >
        0.0000001 )
    {
        cout << num << endl;
        num = num * 10;
        count = count + 1;
        num = num - floor(num+0.5);
    }

    std::cout << count; //48
    std::cin.ignore();

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-27T01:48:03.783

对于浮点类型`T`，您最多可以`std::numeric_limits<T>::digits10`精确恢复数字。因此，要确定最后一个非零小数位的位置，您可以使用此值作为精度并格式化数字。为避免使用指数表示法输出，您需要将格式化标志设置为`std::ios_base::fixed`并考虑非小数位数：

```
std::ostringstream out;
int non_fraction(std::abs(value) < std::numeric_limits<double>::epsilon()
                 ? 1: (1 + std::log(std::abs(value)) / std::log(10)));
out << std::setprecision(std::numeric_limits<double>::digits10 - non_fraction)
    << std::fixed
    << value; 
```

如果有小数点，您只需要计算直到尾随零序列的位数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T22:31:22.397

我建议转换为字符串，然后循环遍历它并计算在您达到句点后出现的字符数。下面是一个示例（可能需要一些小的修补，因为我已经在 C++ 中完成了这个工作）；

```
bool passedRadix = false
int i = 0; // for counting decimals
std::ostringstream strs;
strs << dbl; // dbl is 3.415 or whatever you're counting
std::string str = strs.str();

for(char& c : str) {
   if (passedRadix == true)
       i++; 
   if (c == '.')
       passedRadix = true;

} 
```

# soapui - SoapUI 属性转移

> ID：13095257
> 
> 赞同：4
> 
> 时间：2012-10-26T22:25:31.363
> 
> 标签：soapui

对我的 SOAP 请求的响应是：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <ns2:deliveries nextSequence="492hi" xmlns:ns2="http://blahblahblah"/>
   </soap:Body>
</soap:Envelope> 
```

如何使用soapui 属性转移获得nextSequence 值？我试过这个，但我得到了整个回应：

```
declare namespace ns2='http://blahblahblah';
//ns2:deliveries 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T11:24:14.900

请试试，

```
 declare namespace ns2='http://blahblahblah';
     //ns2:deliveries[1]/@nextSequence 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T09:14:00.083

使用 firstObject 工具生成 Xpath 或者您可以使用 //ns2:deliveries[@nextSequence] ..它将打印交付节点内的所有 nextSequences。通过：http://www.w3schools.com/xpath/xpath_syntax.asp

# ms-access - 在 MS Access 中过滤数据表的文本框（查找与您键入的每个键击匹配的记录）

> ID：13095258
> 
> 赞同：4
> 
> 时间：2012-10-26T22:25:36.377
> 
> 标签：ms-access

有人可以帮我理解为什么这段代码没有产生预期的结果吗？我有一个带有名为 TxtVendorSearch 的文本框的表单。

当用户开始在此文本框中输入内容时，我希望它开始过滤表单子数据表中的结果。

我从一个完全填充的数据表开始，我不确定为什么一旦我开始输入一个应该留下结果的有效过滤器，过滤器就会把整个事情都清空。

```
Private Sub TxtVendorSearch_KeyPress(KeyAscii As Integer)

Dim str1 As String

str1 = "[VendorID] LIKE '*" & Me.TxtVendorSearch.Value & "*' "

Me!subOrderDS1.Form.Filter = str1
Me!subOrderDS1.Form.FilterOn = True

End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:38:00.163

我有一个类似的问题，我在互联网上搜索关键字“find as you type”和“ms access”

我发现了这篇[很棒的文章](http://allenbrowne.com/appfindasutype.html)。希望它能解决你的问题。

注意本文还包含要使用的源代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-27T09:31:12.543

不要使用该`KeyPress`事件，您将无法从事件处理程序本身中轻松地重建实际输入数据（触发事件时，刚刚按下的键尚未添加到文本框的文本中，这意味着你总是缺少最后一次击键）。

相反，使用`KeyDown`事件，并使用文本框的`.Text`属性而不是`.Value`.
`.Value`仅在焦点离开框后设置。

因此，您的代码可以简单地重写为（确保您的 KeyDown 事件设置在表单上的文本框事件中）：

```
Private Sub TxtVendorSearch_KeyDown(KeyCode As Integer, Shift As Integer)

    ' If there is no filter criteria, disable filtering '
    If Len(Trim(TxtVendorSearch.Text)) = 0 Then 
       subOrderDS1.Form.FilterOn = False
       Exit Sub
    End If

    ' Do nothing if user hits RETURN or TAB '
    If KeyAscii < 32 Then
       KeyCode = 0
       Exit Sub
    End If

    Dim str1 As String

    str1 = "[VendorID] LIKE '*" & Trim$(TxtVendorSearch.Text) & "*'"

    subOrderDS1.Form.Filter = str1
    subOrderDS1.Form.FilterOn = True

End Sub 
```

我曾经`Trim()`删除用户可能键入的任何前导和尾随空格。

最后一件事：您不需要在表单代码本身中使用`Me.`或使用。 如果你这样做并没有什么坏处，但它会使事情变得不那么清晰，而无需向代码添加任何内容。`Me!`

# linux - Unix shell 脚本错误

> ID：13095259
> 
> 赞同：-1
> 
> 时间：2012-10-26T22:25:38.820
> 
> 标签：linux, shell, unix

下面的脚本是通过 sftp 将文件推送到远程位置，我在编写下面的代码时遇到了很多问题。但我仍然面临一些问题，请指导我解决问题。它不适用于 sh。它仅适用于 ksh .

```
#test script 
#-------------------------------------------------------------------
#!/bin/sh
#------------------------------------------------------------------------
# sftp_file_uploads.sh 
#------------------------------------------------------------------------
export REMOTE_SERVER_PROD='192.168.0.1'
export REMOTE_SERVER_FAILOVER='192.168.0.2'
export SFTP_PORT='0001'
export SOURCE_FUNCTIONAL_ID='testusr'
export SOURCE_FILE_DIRECTORY='/var/temp/files/'
export SOURCE_ARCHIVE_DIRECTORY='/var/temp/files/archive'
export DATE_FORMAT=`date "+%Y%m%d"`
export LOG_DIRECTORY='/var/temp/logs'
export DESTINATION_FILE_DIRECTORY='/dest'
export LOG_FILE='$LOG_DIRECTORY/test_$DATE_FORMAT.log'
export SFTP_BATCH_FILE='/var/tmp/SFTP_BATCH_FILE'
#------------------------------------------------------------------------
# Find if the files are available at the source directory.
#------------------------------------------------------------------------
cd $SOURCE_FILE_DIRECTORY 
export FILE_TO_UPLOAD_TESTD=`ls -lrt TESTD$DATE_FORMAT.csv  | awk '/TESTD/{ f=$NF };END{ print f }'`
export FILE_TO_UPLOAD_TESTDF=`ls -lrt TESTDF$DATE_FORMAT.csv  | awk '/TESTDF/{ f=$NF };END{ print f }'`
#------------------------------------------------------------------------
# Try 2 times and Sleep for 5 mins if either of the files is not present
#------------------------------------------------------------------------
counter=0
flag_file_found_TESTD=0
flag_file_found_TESTDF=0
while [ $counter –lt 2 ]
do
#---------------------------
# Check TESTD file arrived
#---------------------------
if [ -z $FILE_TO_UPLOAD_TESTD ] then
      echo “No TESTD file to transfer. Sleeping for 5 mins” >> $LOG_FILE
 sleep 300
else
 echo “TESTD file found to transfer.” >> $LOG_FILE
 flag_file_found_TESTD=1
fi
#---------------------------
# Check TESTDF file arrived
#---------------------------
if [ -z $FILE_TO_UPLOAD_TESTDF ] then
      echo “No TESTDF file to transfer. Sleeping for 5 mins” >> $LOG_FILE
 sleep 300
else
 echo “TESTDF file found to transfer.” >> $LOG_FILE
flag_file_found_TESTDF =1
fi
if [[ flag_file_found_TESTD == 1 &&
      flag_file_found_TESTDF == 1 ]] then
 echo “Both files are found.” >> $LOG_FILE
 break
else

 echo “At least one of the files is not found. Retrying now.” >> $LOG_FILE
fi
counter=`expr $counter + 1`
done
if [[ flag_file_found_TESTD == 1 &&
      flag_file_found_TESTDF == 1 ]] then
 echo “Both files are found.”
 break
else
 if [ flag_file_found_TESTD == 0 ] then
    echo “test file is not found and two attempts completed. Cannot transfer the file for today.” >> $LOG_FILE
 fi

if [flag_file_found_TESTDF == 0 ] then
 echo “test1 file is not found and two attempts completed. Cannot transfer the file for today.” >> $LOG_FILE
 fi
fi
#------------------------------------------------------------------------
# Create sftp script
#------------------------------------------------------------------------
rm -f $SFTP_BATCH_FILE
echo "lcd $SOURCE_FILE_DIRECTORY " > $SFTP_BATCH_FILE
echo "cd $DESTINATION_FILE_DIRECTORY " >> $SFTP_BATCH_FILE
if [ -z $FILE_TO_UPLOAD_TESTD ] then
echo "put $FILE_TO_UPLOAD_TESTD " >> $SFTP_BATCH_FILE
fi
if [ -z $FILE_TO_UPLOAD_TESTDF ] then
echo "put $FILE_TO_UPLOAD_TESTDF " >> $SFTP_BATCH_FILE
fi
echo "bye" >> $SFTP_BATCH_FILE

#------------------------------------------------------------------------
# Do sftp
#------------------------------------------------------------------------
echo " Before SFTP " >> $LOG_FILE
if [[ -z $ FILE_TO_UPLOAD && -z $ FILE_TO_UPLOAD1 ]] then
 echo “No files to transfer” >> $LOG_FILE
       mv $LOG_FILE $LOG_DIRECTORY
 exit 1
else 
echo “Attempting to connect to  Remote Server $REMOTE_SERVER_PROD” >> $LOG_FILE
/usr/bin/sftp –v -oPort=$SFTP_PORT -b $SFTP_BATCH_FILE $SOURCE_FUNCTIONAL_ID@$REMOTE_SERVER_PROD >> $LOG_FILE 2 >> $LOG_FILE
fi
result=$?
errorConnectToProd=0
if [ $result -eq 0 ]
then
  echo "SFTP completed successfully to Prod Remote Server" >> $LOG_FILE
else
    errorConnectToProd=1
   if [[ $result -eq 4 || $result -eq 5 ]]
  echo "FAILED to connect to Server. " >> $LOG_FILE

   else
 echo "FAILED to SFTP to  Remote Server. " >> $LOG_FILE
   fi
fi
if [ errorConnectToProd == 1 ] then
echo “Attempting to connect to FAILOVER Remote Server $REMOTE_SERVER_FAILOVER” >> $LOG_FILE
/usr/bin/sftp –v -oPort=$SFTP_PORT -b $SFTP_BATCH_FILE $SOURCE_FUNCTIONAL_ID@$REMOTE_SERVER_FAILOVER >> $LOG_FILE 2 >> $LOG_FILE
fi
result=$?
if [ $result -eq 0 ]
then
  echo "SFTP completed successfully to Failover Remote Server" >> $LOG_FILE
else
   echo "FAILED to SFTP to Failover Remote Server. " >> $LOG_FILE
   mv $LOG_FILE $LOG_DIRECTORY
   exit 1
   fi
fi
cd $SOURCE_FILE_DIRECTORY
mv $FILE_TO_UPLOAD_TESTD $SOURCE_ARCHIVE_DIRECTORY
echo “Moved $FILE_TO_UPLOAD_TESTD to archive direcotry.” >> $LOG_FILE
mv $FILE_TO_UPLOAD_TESTDF $SOURCE_ARCHIVE_DIRECTORY
echo “Moved $FILE_TO_UPLOAD_TESTDF to archive direcotry.” >> $LOG_FILE

rm -f $SFTP_BATCH_FILE
echo “Deleted the SFTP Batch file.” >> $LOG_FILE
echo “Upload completed.” >> $LOG_FILE
mv $LOG_FILE $LOG_DIRECTORY
exit 0 
```

得到以下错误：

```
test.ksh[41]: $LOG_DIRECTORY/test_$DATE_FORMAT.log: cannot create

test.ksh[55]: $LOG_DIRECTORY/test_$DATE_FORMAT.log: cannot create

test.ksh[56]: flag_file_found_TESTDF:  not found

test.ksh[65]: $LOG_DIRECTORY/test_$DATE_FORMAT.log: cannot create

test.ksh[41]: $LOG_DIRECTORY/test_$DATE_FORMAT.log: cannot create

test.ksh[55]: $LOG_DIRECTORY/test_$DATE_FORMAT.log: cannot create

test.ksh[56]: flag_file_found_TESTNDF:  not found

test.ksh[65]: $LOG_DIRECTORY/test_$DATE_FORMAT.log: cannot create

test.ksh[79]: [flag_file_found_TESTDF:  not found

rm: /var/tmp/SFTP_BATCH_FILE is a directory

test.ksh[89]: /var/tmp/SFTP_BATCH_FILE: cannot create

test.ksh[90]: /var/tmp/SFTP_BATCH_FILE: cannot create

test.ksh[97]: B:  not found

test.ksh[98]: B:  not found

test.ksh[99]: B:  not found

test.ksh[100]: B:  not found

test.ksh[101]: B:  not found

test.ksh[102]: B:  not found

test.ksh[106]: /var/tmp/SFTP_BATCH_FILE: cannot create

test.ksh[113]: $LOG_DIRECTORY/test_$DATE_FORMAT.log: cannot create

test.ksh[114]: syntax error at line 114 : `FILE_TO_UPLOAD' unexpected 
```

问候，

柴

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T22:38:02.283

这一行是错误的：

```
export LOG_FILE='$LOG_DIRECTORY/test_$DATE_FORMAT.log' 
```

它应该使用双引号，以便扩展变量：

```
export LOG_FILE="$LOG_DIRECTORY/test_$DATE_FORMAT.log" 
```

另一个错误：

```
if [flag_file_found_TESTDF == 0 ] then 
```

之后需要一个空格`[`。`[`是一个命令（它是 的同义词`test`），所有命令都用空格与其参数隔开。

标有“创建 sftp 脚本”的整个部分都失败了，因为 /var/tmp/SFTP_BATCH_FILE 已经存在并且是一个目录；`rm -f`不会删除目录，您需要使用`rm -rf`.

```
if [[ flag_file_found_TESTD == 1 &&
  flag_file_found_TESTDF == 1 ]] then 
```

缺少`$`变量名之前的。

```
if [[ -z $ FILE_TO_UPLOAD && -z $ FILE_TO_UPLOAD1 ]] then 
```

摆脱之后的空间`$`。

更新 2：

在您的所有`if`陈述中，您都缺少`;`before （或换行符）`then`。

我不确定是什么导致了所有“B：未找到”错误。但是在你修复所有其他错误之后，它可能会消失或者更容易找到。

# excel - 在 Excel 中计算足球比分

> ID：13095262
> 
> 赞同：-3
> 
> 时间：2012-10-26T22:25:47.057
> 
> 标签：excel, formula, worksheet-function

希望有人可以提供帮助。我正在工作中运行一个预测联盟。为了帮助我计算分数，我想我会使用 Excel。
这些是我联盟的条件

*   准确分数 = 3 分
*   正确净胜球得分 = 2 分，即如果预测得分为 2-2，实际得分为 1-1，则两种情况的净胜球得分 = 0 球，因此应奖励 2 分
*   结果正确但得分错误= 1分（主场或客场获胜）

无法发布图片，所以这是一个快速模型

```
- HOME HOME AWAY AWAY Home Away Pts
- 诺维奇 0 0 西汉姆联 1 1 2
- 阿森纳 3 1 南安普顿 7 2 1
- 阿斯顿维拉 2 0 斯旺西 0 1 0
- 富勒姆 3 0 西布朗 1 1 0
- 曼联 4 0 维冈 2 0 1
- QPR 0 0 切尔西 0 0 3
- 斯托克城 1 1 曼城 1 3 0
- 桑德兰 1 2 利物浦 1 2 3
- 阅读 1 3 热刺 0 2 2
- 埃弗顿 2 0 纽卡斯尔 4 1 1
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:33:16.833

像这样的东西应该工作。假设一组结果在 A1:B1 中，另一组在 C1:D1 中。主队像往常一样在英国足球赛程中排名第一。

`=IF(AND(A1=C1,B1=D1),3,IF((A1-B1)=(C1-D1),2,IF(SIGN(A1-B1)=SIGN(C1-D1),1,0)))`

# java - 如何为 Rest Client 处理不受支持/未实现的方法

> ID：13095263
> 
> 赞同：2
> 
> 时间：2012-10-26T22:25:50.247
> 
> 标签：java, web-services, rest, jersey

所以可以说，我正在听 URL `v1/shop/{PATH_PARAM}/status.xml`。每当发出请求时`v1/shop/some_value/status.xml`，它将被重定向到我的方法。

但是可以说，用户在这条路径上犯了错误？泽西岛本身会发送“错误请求”或“未实施”方法或类似的响应。有没有办法代替球衣发送此响应，而我可以处理这些响应？假设我将创建一个新函数，它将监听*除*我为商业案例实现的那些之外的所有内容。因此，任何结构不正确的请求或某些不受支持的媒体请求都会转到此方法，以便我可以向用户发送更合理的响应

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:36:04.250

您可以制作一个[Servlet Filter](http://docs.oracle.com/javaee/6/api/javax/servlet/Filter.html)，将其配置为拦截与您的 Web 服务根 URL 匹配的所有 URL（甚至是部署 Web 服务的 Web 服务器的根 URL），让它将请求传递给 Web 服务，然后当响应到达过滤器，如果是某种 Web 服务错误，您可以将响应更改为您想要的任何内容，使其重定向到某个自定义错误页面等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-28T19:58:19.347

我只是使用“异常映射器”来做到这一点。这是有关如何使用 resteasy 进行操作的教程： [https ://community.jboss.org/wiki/RESTEasyExceptionHandlingWithExceptionMapper?_sscc=t](https://community.jboss.org/wiki/RESTEasyExceptionHandlingWithExceptionMapper?_sscc=t)

一位同事告诉我，泽西岛也有类似的东西。

这是我用来确保我不会得到空内容的代码，因为有时我会忘记，而且我相信其他人会忘记查看标头/HTTP 状态。

```
import org.jboss.resteasy.spi.Failure;

import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;
import javax.ws.rs.ext.ExceptionMapper;
import javax.ws.rs.ext.Provider;

@Provider
public class PipelineMgrExceptionMapper implements ExceptionMapper<Exception> {

    @Override
    public Response toResponse(Exception e) {
        if (e instanceof Failure) {
            Failure f = (Failure) e;
            return Response.fromResponse(f.getResponse()).entity(f.getMessage()).type(MediaType.TEXT_PLAIN).build();
        } else {
            return Response.status(500).entity(e.getMessage()).type(MediaType.TEXT_PLAIN).build();
        }
    }
} 
```

# android - 如何以编程方式在任务堆栈顶部显示活动？

> ID：13095271
> 
> 赞同：1
> 
> 时间：2012-10-26T22:26:31.953
> 
> 标签：android, android-activity, notifications, android-pendingintent

我的应用程序启动前台服务女巫保持与服务器的连接。它是带有pendingIntent 女巫显示MainActivity 的显示通知。当我（用户）点击应用程序图标（在桌面或应用程序列表上）时，它会显示“任务堆栈”。我的意思是如果午餐 MainActivity 它显示它，如果用户去活动 B 或 C（或午餐一些其他活动）它显示它（我的意思是来自任务堆栈的顶级活动）。有一个问题 - 如果用户点击通知，他会再次看到 MainActivity（在堆栈顶部），但我希望在堆栈顶部（活动 B、C 或其他女巫最后被用户午餐）。

当我为 MainActivity“singleTask”设置属性时，一半解决了，现在它始终是任务堆栈的根，但是正在失去所有活动（B、C 和其他用户午餐）。类似[Reuse Activity on Top of Stack](https://stackoverflow.com/questions/3057031/how-to-reuse-activity-on-top-of-stack) simular 中的解决方案，但我只需要根目录下的一项活动。

也许我的逻辑是错误的，我需要另一种方法来解决这个问题。但我想知道如何像应用程序图标一样以编程方式显示任务堆栈（顶部活动）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:52:54.977

文档[Tasks and Back Stack](http://developer.android.com/guide/components/tasks-and-back-stack.html)描述了如何正确处理导航。

简而言之，如果用户点击您的导航并且您将他们带到您应用中的一个活动，当他们点击返回时，他们应该在您的应用的活动层次结构中向上，直到他们到达主屏幕。他们*永远*不应该在另一个任务中进入堆栈。也就是说，如果他们在您的应用程序中的 Activity C 中，并且您发送一个通知，他们单击该通知将他们带到 Activity A，然后单击 Back 应该将他们带到*A 的父级*，而不是 C。如果他们想要去C，他们可以使用Recents。

在旧平台上，Recents 不可用。

这是设计使然。

要构造正确的合成后堆栈，请使用[TaskStackBuilder](http://developer.android.com/reference/android/app/TaskStackBuilder.html)

# javascript - JavaScript/jQuery：成功时使用“this”对象

> ID：13095272
> 
> 赞同：2
> 
> 时间：2012-10-26T22:26:40.283
> 
> 标签：javascript, jquery, ajax

在向服务器发送 Ajax 请求，然后在 JavaScript 对象中的成功函数上返回数据时，我遇到了一个有点烦人的问题。我搜索了类似的问题，但没有一个与我的方式相同。

例如，我有以下代码用于在对象中发送请求：

```
function SomeObject ( someVar )
{
    var someVar = someVar;
}

SomeObject.prototype.sendRequest = function ()
{
    $.ajax(
    {
        url  : "somePage.php",
        type : "POST",
        data :
        {
            someVar : someVar
        },
        success : this.parseSuccess
    } );
};

SomeObject.prototype.parseSuccess = function ( data )
{
    if ( data === "success" )
    {
        this.proceed();  // Error
    }
    else
    {
        alert( "Server failed request." );
        this.proceed();
    }
};

SomeObject.prototype.proceed = function ()
{
    // Do something else
}; 
```

我知道这`this.proceed()`会失败，因为`this`不是`SomeObject`实例。

不过，在请求完成后，如何有效地引用该对象？我发现我可以执行以下操作来实现我想要的，但感觉不合适，我想要一种更好的方式来处理 Ajax 调用：

```
SomeObject.prototype.sendRequest = function ()
{
    var me = this;

    $.ajax(
    {
        url  : "somePage.php",
        type : "POST",
        data :
        {
            someVar : someVar
        },
        success : function ( data )
        {
            me.parseSuccess( data );  // Will work
        }
    } );
}; 
```

感谢您对此事的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T22:28:22.397

你总是可以这样做：

```
success : function ( data )
    {
        parseSuccess.apply(this, [data]); // or parseSuccess.call(this, data);
    } 
```

基本上，使用`apply()`，您可以传入`this`要在函数内部使用的上下文，在本例中就是`SomeObject`上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-27T11:33:43.107

您可以使用 的`context`选项`$.ajax`。具体来说， using`context: this`会将`this`里面的值设置`parseSuccess`为当前`this`值，这就是你想要的。

```
$.ajax({
  // ...
  context: this,
  success: this.parseSuccess
}); 
```

# python - 如何在 Hangman (Python) 中初始化字母猜测提示错误

> ID：13095276
> 
> 赞同：0
> 
> 时间：2012-10-26T22:26:53.997
> 
> 标签：python

我正在编写一个刽子手代码，并且无法为无效的字母猜测设置错误（即猜测应该在 az、没有数字或多个字母字符串之间）。这可能是一个相当简单的解决方案，但我无法将代码形式化。这是我实现代码的方式：

```
while ((count < 6) and win):
   guess = input("Please enter the letter you guess: ")
   if guess:
      try:
         guess = guess.lower()
         lettersCorrect += 1
      if (guess not in letterList): #SYNTAX ERROR
         print ("You need to input a single alphabetic character!")
         continue 
```

我注意到我在哪里得到语法错误。letterList 是我创建的包含所有可接受的字母 (az) 的列表。我的编码是关闭的，还是有一种更简单的方法可以说“如果不在 letterList 中”。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:31:10.703

你的`try`块是没有意义的。此外，`letterList`您可以使用`string.lowercase`

```
import string

while count < 6 and win:
   guess = input("Please enter the letter you guess: ")
   if guess:
      guess = guess.lower()
      if guess not in string.lowercase:
         print("You need to input a single alphabetic character!")
         continue
      lettersCorrect += 1 
```

# android - Android - 带有布尔错误的 ContentValue 数据库？

> ID：13095277
> 
> 赞同：5
> 
> 时间：2012-10-26T22:27:02.643
> 
> 标签：android, sqlite, boolean

我在我的 android 应用程序中创建了数据库表。我使用了这个查询：

```
CREATE TABLE foo (_id INTEGER PRIMARY KEY AUTOINCREMENT, mybool BOOLEAN) 
```

比我在表中添加的行，值`mybool`将是`true`.
我运行 sqlite3 命令查看表中的值，我看到：

```
 _id    |    mybool
----------------------
   1     |      1 
```

没错，`true`值变成了 1。

奇怪的是在阅读中。我是这样读表的：

```
ContentValues values = new ContentValues();
Cursor cursor = db.rawQuery("SELECT * FROM foo", null);
DatabaseUtils.cursorRowToContentValues(cursor, values); 
```

然后我得到奇怪的结果：

```
values.getAsBoolean("mybool"); // return false - WRONG
values.getAsInteger("mybool"); // return 1 = true - CORRECT 
```

我使用这样的代码来获取布尔值：

```
values.getAsInteger("mybool") != 0; 
```

但这很奇怪。

为什么我总是`false`在`getAsBoolean`函数中？课堂上是否有任何错误`ContentValues`？还有其他人有这个问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T23:51:34.677

*DatabaseUtils.cursorRowToContentValues()*将所有内容存储为字符串（blob 除外）。*ContentValues.getAsBoolean()*将尝试将字符串转换为布尔值（使用 Boolean.valueOf()），但这仅在字符串等于“true”而不是“1”时才有效。

对我来说，这看起来像是一个 Android 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T23:46:50.903

你在这里跳过了一些代码。

你有什么证据证明 values.getAsBoolean("mybool") 返回假？你必须返回一个布尔值。你是怎么检查的？

如果可以找到键，则 ContentValues.getAs 返回一个值，如果找不到或无法转换该值，则返回 null。确保你正在做一个完整的测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:02:42.113

I don't know if it's the best solution for this problem, but this code below works for me:

```
Integer result = contentValues.getAsInteger(attributeName);
            if(result ==  null || result == 0) {
                parameter = false;
            } else {
                parameter = true;
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-27T09:40:10.857

`getAsBoolean`不返回 a`boolean`而是一个`Boolean`包装对象，可以是`null`、`Boolean.FALSE`或`Boolean.TRUE`. 如果可以确保没有`NULL`s，则使用`values.getAsBoolean("mybool").booleanValue()`获取实际值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-29T14:02:35.623

得到如下布尔结果：

`boolean result = values.getAsInteger("mybool") == 1;`

# jquery - jquery禁用按钮，直到选择了两个选择字段

> ID：13095278
> 
> 赞同：1
> 
> 时间：2012-10-26T22:27:15.797
> 
> 标签：jquery

我有一个表单，其中有多个字段，但必须至少选择两个下拉列表，直到它们被选中，我禁用并重新标记提交按钮

我在其中一个字段中使用以下内容，有没有办法加倍，其他字段的 id 是#list_name

所以，#category 和 #list_name 必须在启用提交之前选择一个值

```
$(document).ready(
function(){
    $('#category').change(
        function(){
            if ($(this).val()) {
                $('input:submit').attr('disabled',false);
                $('#btn_show').addClass('button green');
                $("#btn_show").attr('value', 'Add To My List');

            } else { 
                $('#btn_show').removeClass('button green'); 
                $('input:submit').attr('disabled',true); 
                $("#btn_show").attr('value', 'Choose a category and list for your item');
            }
        });

}); 
```

我尝试过使用普通的 jquery 多个：

```
$('#category', '#list_name').change( 
```

但它没有用

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T22:29:00.867

这将是

```
$('#category, #list_name').change() 
```

这个在 list_name 的上下文中查找 category 元素

```
$('#category', '#list_name').change() 
```

整个代码看起来像这样

```
$('#category, #list_name').change(
        function(){
            if ($('#category').val() && $('#list_name').val()  ) {
                $('input:submit').attr('disabled',false);
                $('#btn_show').addClass('button green');
                $("#btn_show").attr('value', 'Add To My List');

            } else { 
                $('#btn_show').removeClass('button green'); 
                $('input:submit').attr('disabled',true); 
                $("#btn_show").attr('value', 'Choose a category and list for your item');
            }
        }); 
```

# mysql - 如何在不牺牲良好性能的情况下搜索 playframework JPA 实体？

> ID：13095283
> 
> 赞同：1
> 
> 时间：2012-10-26T22:27:50.987
> 
> 标签：mysql, hibernate, jpa, playframework, full-text-search

我正在使用 playframework 1.2.4 和 JPA 进行持久存储。在[playframework 文档](http://www.playframework.org/documentation/1.2.4/jpa#Findusingasimplifiedquery)中，有很多关于使用“like”运算符来查找实体的参考。我可以看到将它用于搜索操作，但是因为“like”运算符会进行全表扫描，所以这会非常慢，因为我有越来越多的实体。换句话说，它不会扩展。什么是有效搜索实体的可扩展方式？我知道 Mysql 有一个全文功能来解决这个问题，但是如何在 playframework 中使用 JPA 访问这个功能呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T18:16:45.410

试试 elasticsearch 模块，它很好地支持 JPA。 [http://www.playframework.org/modules/elasticsearch](http://www.playframework.org/modules/elasticsearch)

# javascript - 获取视图模型的“类型”

> ID：13095286
> 
> 赞同：0
> 
> 时间：2012-10-26T22:28:15.767
> 
> 标签：javascript, backbone.js, backbone-views, backbone.js-collections, backbone-model

您可以从 View 方法访问 View 的模型 - 就像`render()`（通过它的`model`属性）。但是假设您有许多不同的模型，并将它们与相同类型的视图一起使用，并在`model`需要时更改视图的属性。

如何从 View 中确定它使用的是什么类型的模型？

```
var Model1 = Backbone.Model.extend();
var Model2 = Backbone.Model.extend();

var MyView = Backbone.View.extend({
  render:function(){
    console.log(" you're using: "+ model); // how to determine here is it using Model1 or Model2
  }
})

var mv1 = new MyView({model: new Model1()})
var mv2 = new MyView({model: new Model2()}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:56:07.057

**对象有身份，而不是名称。** 如果您想知道创建对象的构造函数的名称（可以将其视为对象的类型；请参阅[ECMAScript 规范](http://ecma-international.org/ecma-262/5.1/#sec-15)），防弹方法是使该信息成为构造对象的一部分：

```
var Model1 = Backbone.Model.extend({type: "Model1"});
var Model2 = Backbone.Model.extend({type: "Model2"});

var MyView = Backbone.View.extend({
  render: function () {
    console.log("You are using " + this.model.type);
  }
});

var mv1 = new MyView({model: new Model1()});
var mv2 = new MyView({model: new Model2()}); 
```

这样，模型对象`type`通过原型链继承属性。另请参阅[http://backbonejs.org/#View-render](http://backbonejs.org/#View-render)。

替代的、效率较低且不太可靠的解决方案包括：

*   给构造函数一个名字并访问它：

    ```
    var Model1 = Backbone.Model.extend();
    Model1.name = "Model1";

    var MyView = Backbone.View.extend({
      render: function () {
        console.log("You are using " + this.model.constructor.name);
      }
    });

    var mv1 = new MyView({model: new Model1()});
    var mv2 = new MyView({model: new Model2()}); 
    ```

    （`name`如果构造函数是

    ```
    var Model1 = function Model1 () {
      // …
    }; 
    ```

    或者

    ```
    function Model1 ()
    {
      // … 
    } 
    ```

    但那是——不幸的是——不是 Backbone.js 的方式。）

*   解析命名实例的字符串表示，`Function`例如构造函数。但这取决于实现：

    ```
    var Model1 = function Model1 () {
      // …
    };

    var MyView = Backbone.View.extend({
      getModelName: function () {
        var aFunction = this.model.constructor;
        return (aFunction != null && typeof aFunction.name != "undefined" && aFunction.name)
          || (String(aFunction).match(/\s*function\s+([A-Za-z_]\w*)/) || [, ""])[1];
      },

      render: function () {
        console.log("You are using " + this.getModelName());
      }
    }); 
    ```

    （实现为[jsx.object.getFunctionName()](http://pointedears.de/websvn/filedetails.php?repname=JSX&path=%2Ftrunk%2Fobject.js)。但同样，Backbone.js 不能完全实现 AIUI。）

*   `instanceof`按照 DashK 的回答中的建议使用。但这并不能立即或可靠地为您提供信息。因为你必须把原型链中最重要的名字放在最前面，并且每当你改变原型链时都要改变方法，否则你会得到误报和漏报：

    ```
    var MyView = Backbone.View.extend({
      render: function () {
        var modelName = "an unknown model";

        if (this.model instanceof Model1)
        {
          modelName = "Model1";
        }
        else if (this.model instanceof Model2)
        {
          modelName = "Model2";
        }
        else if (this.model instanceof Supermodel)
        {
          modelName = "Supermodel";
        }

        console.log("You are using " + modelName);
      }
    }); 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T00:10:01.207

保持这个简单...

```
var Model1 = Backbone.Model.extend();
var Model2 = Backbone.Model.extend();

var MyView = Backbone.View.extend({
  render:function(){
    if (this.model instanceof Model1) {
      alert("You're using model1");
    }
    else if (this.model instanceof Model2) {
      alert("You're using model2");
    }
    else {
      alert("I've no idea what you're using");
    }
  }
})

var mv1 = new MyView({model: new Model1()});
var mv2 = new MyView({model: new Model2()});
mv1.render();
mv2.render(); 
```

# javascript - 在 ASP.NET MVC 项目中为 javascript 调用设置公共路由

> ID：13095292
> 
> 赞同：0
> 
> 时间：2012-10-26T22:28:35.063
> 
> 标签：javascript, asp.net-mvc, deployment, asp.net-mvc-routing, url-routing

我的 ASP.NET MVC 项目有一个奇怪的路由问题，希望你们能帮助我。

总体而言，当我在本地主机上运行项目或在服务器上运行项目时一切正常，而它直接部署在`http://myServerName`. 当我将应用程序部署到位于不同虚拟目录下的服务器上的各种环境时，问题就开始了。例如：`http://myServerName/QaEnviornment`或`http://myServerName/TestEnviornment`

问题是对应用程序 URL 的所有 Javascript 调用都会忽略我的环境虚拟目录并失败。例如，在我的 QA 服务器上，每当我必须进行 Ajax 调用时，我都会采用标准方法，例如：

```
var myUrl = '/ControllerName/ActionMethodName/'
$.ajax({url:myUrl,success:function(){Do stuff} }) 
```

因为我的应用程序部署在 上`http://myServerName/QaEnviornment`，所以在呈现时我希望 myUrl 是`http://myServerName/QaEnviornment/ControllerName/ActionMethodName`. 相反，它回来了`as http://myServerName/ControllerName/ActionMethodName`，当然失败了。

为了暂时解决这个问题，我声明了一个包含环境文件夹名称的全局 Javascript 变量，当我为 javascript 调用构建 URL 时，我必须记住始终将它们构造为 var`myUrl = myGlobalFolderVar + '/ControllerName/ActionMethodName/'`

使用全局 JavaScript 变量来解决这个问题对我来说似乎是一个糟糕的解决方案。我可以做些什么来使路由正常工作，以便每当进行 JavaScript 调用时，应用程序在其下运行的任何子文件夹始终包含在 URL 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:35:28.627

不必总是记住正确构造它们，而是创建一个您调用的辅助函数来创建您的 URL

```
function CreateUrl(string path){
    return myGlobalFolderVar + path;
} 
```

回答你的第二个问题，不是真的。路由不知道是什么发出了请求，您不能总是依赖`X-Http-RequestedWith`标头来做出决定。此外，您的站点应用程序根不在域根目录中，因此路由只会在访问您的应用程序时启动。我知道的唯一另一种方法是让 MVC 实际为您生成 Url ( `var url = '@Url.RouteUrl(params)';`)，但是当您将 JavaScript 放在单个或几个 .js 文件中时，这根本没有帮助。

**编辑**

上面的函数是一个 JavaScript 函数，可以放在应用程序中的任何位置，包括外部 JS 文件。至于设置你的 myGlobalFolderVar，有几种方法可以设置它。

1.实际上硬编码外部JS文件中的变量。

```
var myGlobalFolderVar = 'TestEnviornment'; 
```

但是，如果您要部署到多个不同的测试服务器，这很难。

2.如果您使用 web.config 转换，您可以根据构建类型在 web.config 转换中添加 AppSettings 键/值对。然后，使用该值，在母版页布局/视图中设置全局 Javascript 变量。

```
 <appSettings xdt:Transform="Replace">
    <add key="folderLocation" value="TestEnvironment" />
  </appSettings> 
```

在您的外部 JS 文件中

```
//this makes it a site wide/global variable in any place you 
//include your external JS file
    var myGlobalFolderVar = ''; 
```

在您的主视图中

```
<script type="text/javascript">
   myGlobalFolderVar = '@ConfigurationManager.AppSettings["folderLocation"]'
</script> 
```

3.与第二个相同，但使用 URL 帮助程序来确定应用程序在主视图中的路径，而不是使用 web.config 转换

```
<script type="text/javascript">
    myGlobalFolderVar = '@Url.Content("~/")'
</script> 
```

基本思想是使用 .NET 找出它所在的位置并使用该路径信息设置一个全局 JavaScript 变量。然后，结合此答案顶部提供的辅助 JavaScript 函数，您可以在整个应用程序中根据需要正确生成路径 - 无论路径深度、部署位置或任何其他部署类型问题如何。

```
var myUrl = CreateUrl('/ControllerName/ActionMethodName/');
$.ajax({url:myUrl,success:function(){Do stuff} }); 
```

# ruby-on-rails - 关注 ActiveSupport::关注

> ID：13095295
> 
> 赞同：1
> 
> 时间：2012-10-26T22:29:05.080
> 
> 标签：ruby-on-rails

我需要向现有模型添加一组通用方法。我找到了这个教程：

[http://chris-schmitz.com/extending-activemodel-via-activesupportconcern/](http://chris-schmitz.com/extending-activemodel-via-activesupportconcern/)

在我看来，这就是我的目标（我想要一个模块，该模块将被添加到模型中以向其添加一些方法 - 一种混合）。

现在，即使我从教程中进行简单的复制粘贴，我也会遇到以下错误（没有进一步的解释）：

```
undefined method `key?' for nil:NilClass 
```

这是我的模型的样子：

```
class Folder < ActiveRecord::Base  
  attr_accessible :name, :parent_id  

  has_default

  validates :name, presence: true
end 
```

我删除**has_default**的那一刻，一切都恢复正常

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-27T13:42:03.113

再次检查您的代码...

模块结构可能如下所示（取自我的一个绝对有效的项目）：

```
# lib/taggable.rb

require 'active_support/concern'

module Taggable
  extend ActiveSupport::Concern

  module ClassMethods
    def taggable
      include TaggableMethods # includes the instance methods specified in the TaggableMethods module
      # class methods, validations and other class stuff...
    end
  end

  module TaggableMethods
    # instance methods...
  end
end 
```

缺少的是你应该告诉 Rails 从`lib`目录加载模块：

```
# config/application.rb

module AppName
  class Application < Rails::Application
    # Custom directories with classes and modules you want to be autoloadable.
    # config.autoload_paths += %W(#{config.root}/extras)
    config.autoload_paths += %W(#{config.root}/lib)

    # rest ommited... 
```

现在应该包含模块。

```
# model.rb

class Model
  taggable

end 
```

这就是基本插件的工作方式。您的问题中提到的教程的作者编写了一个插件，该插件仅适用于继承自的模型，`ActiveRecord::Base`因为他正在使用其特定方法（例如`update_column`）。

如果您的模块不依赖 ActiveRecord 方法，则无需扩展它（该模块也可能被 Mongoid 模型使用）。但这绝对**不是**正确的方法：

```
class ActiveRecord::Base
  include HasDefault
end 
```

如果你真的需要扩展 ActiveRecord，这样做：

```
ActiveRecord::Base.extend ModuleName 
```

当然，根据您的需要，还有很多其他编写插件的方法，以各种 Rails`gems`作为一个很好的灵感。

# jquery - jQuery TableSorter 没有正确排序，我不知道怎么做

> ID：13095298
> 
> 赞同：0
> 
> 时间：2012-10-26T22:29:14.620
> 
> 标签：jquery, tablesorter

我有七列，我想让它们正确排序，

第一列有数字，但它没有按照我希望的方式对它们进行排序：

```
Example:
5016
502
5020
5023 
```

我希望它像这样排序：

```
Example:
502
5016
5020
5023 
```

现在第二列有数字和字母的组合示例如上所示，但在每个数字前面都有一个字母我想按数字排序，然后按字母

```
Example:
441
B441
821
822
823
C823 
```

甚至像这样也可以

```
Example:
441
821
822
823
B441
C823 
```

最后，第 3 列更复杂，它在单词示例之前有一个图像：Billy Jones Anna Walters Bob Smith Tom Henderson

我希望它按（名称）字母排序......

```
Example:
<img src="img_tr122.png">&nbsp;Anna Walters
<img src="img_tr122.png">&nbsp;Billy Jones
<img src="img_tr122.png">&nbsp;Bob Smith
<img src="img_tr122.png">&nbsp;Tom Henderson 
```

到目前为止，这是我在 JavaScript 中所拥有的，但我不知道如何让一切正常工作..

```
<script type="text/javascript">
$(document).ready(function() { 
$.tablesorter.defaults.widgets = ['zebra']; 
    $("table").tablesorter({ 
        // pass the headers argument and assing a object 
        headers: { 
            // assign the third column (we start counting zero) 
            2: { 
                // disable sort because I don't know how to sort it correctly.
                sorter: false 
            },
            6: { 
                // disable sort for this (last) column because it is a menu only.
                sorter: false 
            } 
        } 
    }); 
});
</script> 
```

请帮忙....

谢谢！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T13:48:52.383

原始的 tablesorter (v2.0.5) 不进行字母数字排序。但是您可以使用我[的 tablesorter fork](http://mottie.github.com/tablesorter/docs/)使用以下代码对数据进行排序：

```
$('table').tablesorter({

    // Add a theme
    theme : 'blue',

    // extract text from the table
    textExtraction: {
        2: function(node) {
            // move swap first and last name
            return $.trim($(node).text() || '').replace(/(\w+)\s(\w+)/g,'$2 $1');
        }
    },

    // include zebra and any other widgets:
    widgets: ['zebra', 'columns']

}); 
```

我不确定你想如何对最后一列进行排序。该`textExtraction`选项包含首先按姓氏对最后一列进行排序的代码。如果要按名字排序，则只需删除整个选项。

这是该代码的实际[演示](http://jsfiddle.net/Mottie/abkNM/53/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T13:57:52.133

您可以使用[http://tablesorter.openwerk.de/](http://tablesorter.openwerk.de/)，它具有您需要的功能，并且它具有语言环境支持、UI 主题支持、对德语日期格式和小数点的支持。

# c# - 如何根据类型列表检查对象的类型？

> ID：13095299
> 
> 赞同：2
> 
> 时间：2012-10-26T22:29:25.963
> 
> 标签：c#, linq, lambda

给定一个集合

```
IEnumerable<Type> supportedTypes 
```

检查给定对象是否是这些类型之一（或派生类型）的最佳方法是什么？

我的第一个直觉是做类似的事情：

```
// object target is a parameter passed to the method in which I'm doing this.
if (supportedTypes.Count( supportedType => target is supportedType ) > 0)
{
    // Yay my object is of a supported type!!!
} 
```

..但这似乎不起作用。我不能在这样的 lambda 表达式中使用“is”关键字吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:29:25.963

好的，所以在输入问题并进行更多实验以确保我没有问一些非常愚蠢的问题的过程中，我意识到了一个简单的解决方案。在这里发帖以防其他人做过同样愚蠢的事情。;-)

您不能在 lambda 表达式中使用“is”关键字，但可以使用：

```
supportedType => supportedType.IsInstanceOfType(target) 
```

产生：

 ~~~~```
if (supportedTypes.Count( supportedType => 
supportedType.IsInstanceOfType(target)) > 0) 
```~~  ~~```
if (supportedTypes.Any( supportedType => 
                              supportedType.IsInstanceOfType(target)))
// object target is a parameter passed to the method in which I'm doing this.
{
    // Yay my object is of a supported type!!!
} 
```

向 Bob Vale 致敬，因为他在下面的评论中指出我应该使用 .Any(...) 而不是 .Count(...) > 0

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T22:38:39.757

Why don't you use `Contains` and `target.GetType`?

```
bool ar isSupported = supportedTypes.Contains(target.GetType()); 
```

or `Any`

```
bool isSupported = supportedTypes.Any(t => t == target.GetType()); 
```

(don't use `Enumerable.Count` if you just want to know if a sequence contains a matching element, that is rather inefficient if the sequnce is large or the predicate is expensive)

**Edit**: If you want to take inheritance into account you can use [`Type.IsAssignableFrom`](http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom.aspx):

```
var isSupported = supportedTypes.Any(t => target.GetType().IsAssignableFrom(t)); 
```

*   The `is` operator is used to check whether an instance is compatible to a given type.
*   The `IsAssignableFrom` method is used to check whether a Type is compatible with a given type.

> Determines whether an instance of the current Type can be assigned from an instance of the specified Type.~~~~

# python - python从外部文件添加到字典

> ID：13095303
> 
> 赞同：0
> 
> 时间：2012-10-26T22:29:33.283
> 
> 标签：python, file-io, dictionary

我有一个需要放入字典的外部文件。每篇文章都以 开头`<NEW DOCUMENT>`，我不知道如何从文件中提取所有信息，从下面的行开始，`<newdoc>`在到达另一行之前结束`<newdoc>`。这是我到目前为止所拥有的。

```
for line in file2:
    line = line.strip()
    line_list = line.split()
    if "NEW DOCUMENT" in line:
        doc_num+=1
        new_dict[doc_num] = line
        print(new_dict) 
```

该文件看起来像这样。

```
<NEW DOCUMENT>
Look on the bright 
side of Life.
<NEW DOCUMENT>
look on the very, dark
side of the Moon 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:34:24.370

这是对您的解决方案的修改：

```
docs = []
document = []
for line in file2:
    line = line.strip()
    if line == "<NEW DOCUMENT>":
        # start a new document
        document = []
        docs.append(document)
    else:
        # append to the current one
        document.append(line)

# convert lists of lines into a string
docs = ['\n'.join(document) for document in docs] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:34:27.707

这将为您完成：

```
docs = file2.read().split("<NEW DOCUMENT>\n") 
```

它给你一个列表，而不是字典，因为你为什么想要一个键是序号的字典？但是，如果您必须有字典，请使用：

```
new_dict = dict(enumerate(docs)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T22:35:44.970

像这样的东西：

```
In [7]: with open("data1.txt") as f:
    data=f.read()
    dic=dict((i,x.strip()) for i,x in enumerate(data.split("<NEW DOCUMENT>")[1:]))
    print dic
   ....:     
   ....:     
{0: 'Look on the bright \nside of Life.', 1: 'look on the very, dark\nside of the Moon'} 
```

# javascript - 列出 IE8 中的所有 Array.prototype 函数-

> ID：13095305
> 
> 赞同：3
> 
> 时间：2012-10-26T22:30:49.627
> 
> 标签：javascript, arrays, loops, internet-explorer-8, prototype

`Array.prototype`是否可以以跨浏览器友好的方式遍历所有 JavaScript函数名称？我知道这适用于 IE9+ 和现代浏览器：

```
var names = Object.getOwnPropertyNames(Array.prototype);
names.forEach(function(name) {
    console.log(name); // function name
}); 
```

有没有办法在 IE8 和 IE7 中获得相同的列表？我试过了：

```
for(var key in Array.prototype) {
    console.log(key); // undefined
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T04:19:30.287

如果您试图查找版本 9 之前的 IE 浏览器中支持的内容，您可以假设它是 IE9 列表的子集并筛选出不支持的内容。

这是您在 #9 之前在 IE 中获得的列表：

**连接、构造函数、连接、长度、弹出、推送、反向、移位、切片、排序、拼接、toLocaleString、toString、unshift**

你可以测试一下——

```
<!doctype html>
<html lang="en">
<head>
<meta charset= "utf-8">
<title>Small Page</title>
<style>
</style>
<script>
onload= function(){
var testnames= ['concat', 'constructor', 'every', 'filter', 'forEach',
'indexOf', 'join', 'lastIndexOf', 'length', 'map', 'pop', 'push', 'reduce',
'reduceRight', 'reverse', 'shift', 'slice', 'some', 'sort', 'splice',
'toLocaleString', 'toString', 'unshift'],
    L= 23;
    while(L){
        if(!(testnames[--L]in Array.prototype)) testnames.splice(L, 1);
    }
    document.getElementsByTagName('textarea')[0].value= testnames;
}
</script>

</head>
<body>

<p>   <textarea rows="8" cols="60"> </textarea>     </p>

</body>
</html> 
```

# java - getExtras() 返回 null

> ID：13095306
> 
> 赞同：0
> 
> 时间：2012-10-26T22:30:49.827
> 
> 标签：java, android, android-intent, android-activity

这是我的代码。

在我的主要 .java 文件中。

```
public void showQuiz (View view){
        Username = (EditText) findViewById(R.id.Username);
        String userId = Username.getText().toString();
        String deviceId = Secure.getString(this.getContentResolver(),
                Secure.ANDROID_ID);
       //this intent is used to open other activity wich contains another webView
         Intent intent = new Intent(this, Quiz.class);

         Bundle bun = new Bundle();
         bun.putString("userid",userId);
         bun.putString("deviceid", deviceId);

         intent.putExtras(bun);
         startActivity(intent); 
    } 
```

这就是 Activity 的 .java 文件中的内容。

```
package com.earn.egpt;

import android.app.Activity;
import android.os.Bundle;
import android.webkit.WebView;

public class Quiz extends Activity {
    private static final String url = "http://www.m.s-w-family.com/?subid=";
    private static final String url2 = "&deid=";

     @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_quiz);
            Bundle extras=getIntent().getExtras();
            String userId=extras.getString("userId");
            String deviceId=extras.getString("deviceId");
         WebView webview;
        webview = (WebView) findViewById(R.id.webView1);
        webview.getSettings().setJavaScriptEnabled(true);
        webview.loadUrl(url+userId+url2+deviceId);
        }
    } 
```

出于某种原因，它将字符串作为空值传递，但我不知道为什么。我对这种编程非常陌生，所以我什至不知道在哪里。我查看了与我类似的其他问题并尝试了修复它们，但值仍然为空。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T23:25:24.883

注意变量的大小写。您正在插入“userid”并检索“userId”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T22:33:01.463

您不小心使用了额外的 Bundle。而是将附加内容直接放入 Intent 中：

```
intent.putExtra("userid", userId);
intent.putExtra("deviceid", deviceId);

startActivity(intent); 
```

现在，您的`getString()`方法将返回您在测验中想要的内容。

# windows - 循环变量的批处理脚本多字母

> ID：13095307
> 
> 赞同：-1
> 
> 时间：2012-10-26T22:31:02.800
> 
> 标签：windows, variables, batch-file

所以我有一个基本的批处理脚本，它遍历目录并打印出每个目录名称：

```
for /R /D %%d in (.\*) do (
    echo %%d
) 
```

但我不喜欢单个字符变量 d，我希望它更具描述性，例如“目录”

对于 /R /D %%directory in (.*) do ( echo %%directory )

现在我收到错误“%directory 在这个时候是意外的”

为什么它接受单字母变量，而不接受多字母变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:46:18.973

这就是该语言的工作方式，并且从 DOS 早期就一直如此。

但是，没有什么能阻止您将该变量分配给*另一个*名称更长的变量 - 请参阅`set`.

我不会担心像这样的简短示例，但是当您的循环体变得更加充实时，它会派上用场。

# ruby - iCalendar 的正则表达式解析（Ruby 正则表达式）

> ID：13095310
> 
> 赞同：4
> 
> 时间：2012-10-26T22:31:13.823
> 
> 标签：ruby, regex, icalendar, rfc2445, rfc5545

我正在尝试使用正则表达式解析 iCalendar (RFC2445) 输入。

这是输入的 [简化] 示例：

```
BEGIN:VEVENT
abc:123
def:456
END:VEVENT
BEGIN:VEVENT
ghi:789
END:VEVENT 
```

我想得到一个匹配数组：“外部”匹配是每个 VEVENT 块，内部匹配是每个字段：值对。

我试过这个的变种：

```
BEGIN:VEVENT\n((?<field>(?<name>\S+):\s*(?<value>\S+)\n)+?)END:VEVENT 
```

但是考虑到上面的输入，结果似乎每个匹配的 VEVENT 只有一个字段，尽管 +? 在捕获组上：

```
**Match 1**
field   def:456
name    def
value   456

**Match 2**
field   ghi:789
name    ghi
value   789 
```

在第一场比赛中，我会期待两个字段： abc:123 和 def:456 匹配......

我确定这是一个新手错误（因为在正则表达式方面我似乎永远是新手......） - 但也许你可以指出我正确的方向？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:37:29.487

使用[icalendar](https://github.com/sdague/icalendar)宝石。有关更多信息，请参阅[解析 iCalendars](https://github.com/sdague/icalendar#parsing-icalendars)部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-27T10:33:30.960

您需要将正则表达式拆分为一个匹配 a`VEVENT`和一个匹配名称/值对。然后，您可以使用嵌套`scan`来查找所有出现的情况，例如

```
str.scan(/BEGIN:VEVENT((?<vevent>.+?))END:VEVENT/m) do
  $~[:vevent].scan(/(?<field>(?<name>\S+?):\s*(?<value>\S+?))/) do
    p $~[:field], $~[:name], $~[:value]
  end
end 
```

`str`你的输入在哪里。这输出：

```
"abc:1"
"abc"
"1"
"def:4"
"def"
"4"
"ghi:7"
"ghi"
"7" 
```

如果您想让代码更具可读性，我建议您`require 'english'`替换`$~`为`$LAST_MATCH_INFO`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T23:52:39.433

你需要一个嵌套的`scan`.

```
string.scan(/^BEGIN:VEVENT\n(.*?)\nEND:VEVENT$/m).each.with_index do |item, i|
  puts
  puts "**Match #{i+1}**"
  item.first.scan(/^(.*?):(.*)$/) do |k, v|
    puts "field".ljust(7)+"#{k}:#{v}"
    puts "name".ljust(7)+"#{k}"
    puts "value".ljust(7)+"#{v}"
  end
end 
```

会给：

```
**Match 1**
field   abc:123
name    abc
value   123
field   def:456
name    def
value   456

**Match 2**
field   ghi:789
name    ghi
value   789 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T23:01:06.433

我认为问题在于，`MatchData`正则表达式返回其结果的 ruby​​ 对象没有提供多个具有相同名称的值的任何规定。所以你的第二场比赛会覆盖第一场比赛。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-27T01:08:07.153

Ruby 有一个很少使用的方法[`slice_before`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-slice_before)很适合这种需求：

```
'BEGIN:VEVENT
abc:123
def:456
END:VEVENT
BEGIN:VEVENT
ghi:789
END:VEVENT'.split("\n").slice_before(/^BEGIN:VEVENT/).to_a 
```

结果是：

```
[["BEGIN:VEVENT", "abc:123", "def:456", "END:VEVENT"],
 ["BEGIN:VEVENT", "ghi:789", "END:VEVENT"]] 
```

从那里获取内部数组元素很简单：

```
'BEGIN:VEVENT
abc:123
def:456
END:VEVENT
BEGIN:VEVENT
ghi:789
END:VEVENT'.split("\n").slice_before(/^BEGIN:VEVENT/).map{ |a| a[1 .. -2] } 
```

这是：

```
[["abc:123", "def:456"], ["ghi:789"]] 
```

`map`而且，从那里使用and分解每个结果字符串是微不足道的`split(':')`。

不要被正则表达式的警报声所诱惑，试图做任何事情。它们在特定的地方非常强大和方便，但通常有更简单、更易于维护的解决方案。

# python - bs4 文档有什么问题？我无法运行 unwrap() 示例代码

> ID：13095316
> 
> 赞同：1
> 
> 时间：2012-10-26T22:32:21.730
> 
> 标签：python, web-scraping, beautifulsoup, scraperwiki

我试图从这样的页面中删除一些繁琐的[文本](http://www.bicyclepaintings.com/studio10/johnny/studioindex.html)。我想保留锚定链接但丢失中断和 a.intro。我以为我可以使用[unwrap()](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#unwrap)之类的东西来剥离图层，但出现错误：`TypeError: 'NoneType' object is not callable`

为了好玩，我尝试运行文档示例代码本身，因为我看不出我的版本有何不同。

```
markup = '<a href="http://example.com/">I linked to <i>example.com</i></a>'
soup = BeautifulSoup(markup)
a_tag = soup.a

a_tag.i.unwrap()
a_tag
# <a href="http://example.com/">I linked to example.com</a> 
```

我得到了完全相同的错误。我在这里想念什么？我在 Scraperwiki 工作，fwiw。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T02:09:41.167

似乎是一个scraperwiki问题。在 ipython 控制台中工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T22:37:38.710

我也得到这个错误。

```
In [27]: type(a_tag.i.unwrap)
Out[27]: NoneType

In [28]: 'unwrap' in dir(a_tag.i)
Out[28]: False 
```

FWIW，`replace_with_children`产生相同的结果：

```
In [29]: type(a_tag.i.replace_with_children)
Out[29]: NoneType 
```

对我来说似乎是一个错误。

```
In [13]: import BeautifulSoup as Bs

In [16]: Bs.__version__
Out[16]: '3.2.1' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T17:39:20.197

我有同样的错误信息`soup.select()`。原因是 BeautifulSoup4 库的旧版本。ScraperWiki 的某个人修复了它（请参阅ScraperWiki Google Group 上的[此对话](https://groups.google.com/forum/?fromgroups=#!topic/scraperwiki/SJqDr-Jg1MA)）。

# android - 设置适配器（适配器）；？

> ID：13095317
> 
> 赞同：0
> 
> 时间：2012-10-26T22:32:38.337
> 
> 标签：android, android-viewpager

大家好，我正在设置 ViewPager，但我一直收到 Set Adapter 错误。此代码链接到 PagerAdapter。有人可以帮忙吗？

```
package com.test.viewpager;

import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.os.Parcelable;
import android.support.v4.view.ViewPager;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.Toast;

public class  PagerAdapter extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        MyPagerAdapter adapter = new MyPagerAdapter();    
        ViewPager myPager = (ViewPager) findViewById(R.id.myfivepanelpager);    
        myPager.setAdapter(adapter);    
        myPager.setCurrentItem(2);
    }
} 
```

这是我需要运行的 mypageradapter

```
 package com.test.viewpager;

  import android.content.Context;
  import android.os.Parcelable;
  import android.support.v4.view.ViewPager;
  import android.view.LayoutInflater;
  import android.view.View;

   class MyPagerAdapter extends PagerAdapter { 

public int getCount() {        
    return 5;      
    }     
public Object instantiateItem(View collection, int position) {     
    LayoutInflater inflater = (LayoutInflater) collection.getContext()        
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);       
    int resId = 0;       
    switch (position) {        
    case 0:                resId = R.layout.page1;         
    break;         
    case 1:                resId = R.layout.page2;           
    break;       
    case 2:                resId = R.layout.page3;     
    break;        
    case 3:                resId = R.layout.page4;          
    break;       
    case 4:                resId = R.layout.page5;   
    break;            }      
    View view = inflater.inflate(resId, null);    
    ((ViewPager) collection).addView(view, 0);        
    return view;        }   
public void destroyItem(View arg0, int arg1, Object arg2) {      
    ((ViewPager) arg0).removeView((View) arg2);        }    
public boolean isViewFromObject(View arg0, Object arg1) {         
    return arg0 == ((View) arg1);        }        
public Parcelable saveState() {        
    return null;        }} 
```

这是我使用的主要 xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >
<android.support.v4.view.ViewPager    
    android:layout_width="match_parent"   
     android:layout_height="match_parent"   
      android:id="@+id/myfivepanelpager"/>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T03:06:05.240

您命名了您的活动类`PagerAdapter`，这也是`android.support.v4.view.PagerAdapter`.

以其他方式命名它，您会发现真正的错误，您忘记`import android.support.v4.view.PagerAdapter;`在 MyPagerAdapter.java 中

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-26T23:39:26.710

如果您发布一些有关您遇到的错误的信息，例如 LogCat 或堆栈跟踪甚至错误消息，这也会有所帮助。

尽管有些错误很突出，但*我们*在没有所有信息的情况下猜测您的问题是错误的。您可能会遇到与您的代码无关的问题。

# python - How to remove certain lists from a list of lists using python?

> ID：13095323
> 
> 赞同：0
> 
> 时间：2012-10-26T22:33:21.197
> 
> 标签：python, list

I can not figure out why my code does not filter out lists from a predefined list. I am trying to remove specific list using the following code.

```
data = [[1,1,1],[1,1,2],[1,2,1],[1,2,2],[2,1,1],[2,1,2],[2,2,1],[2,2,2]]
data = [x for x in data if x[0] != 1 and x[1] != 1]

print data 
```

My result:

```
data = [[2, 2, 1], [2, 2, 2]] 
```

Expected result:

```
data = [[1,2,1],[1,2,2],[2,1,1],[2,1,2],[2,2,1],[2,2,2]] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:35:27.283

`and` is wrong, use `or`

```
data = [x for x in data if x[0] != 1 or x[1] != 1] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T22:35:43.237

`and`仅当双方都是真值时才为真。也许你想要...

```
data = [x for x in data if x[0] != 1 or x[1] != 1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T22:45:30.250

我认为这就是OP想要的。

```
data = [[1,1,1],[1,1,2],[1,2,1],[1,2,2],[2,1,1],[2,1,2],[2,2,1],[2,2,2]]

data = [x for x in data if x[:2] != [1,1]]
print data

data = [x for x in data if ((x[0],x[1]) != (1,1))]   
print data 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T22:57:47.793

你有一个小的逻辑错误。要匹配您对问题的思考方式，请使用：

```
if not (x[0] == 1 and x[1] == 1) 
```

请注意，这在逻辑上等同于 using `or`，正如其他人所建议的那样：

```
not (A and B) == (not A) or (not B) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-22T16:44:02.100

在您的代码中，应使用“或”代替“和”。如果您想执行这两个值，则使用“and”。例子：

```
data = [x for x in data if x[0] != 1 or x[1] != 1] 
```

# python - Global list doesn't contain value at another function

> ID：13095326
> 
> 赞同：0
> 
> 时间：2012-10-26T21:55:39.280
> 
> 标签：python

I want to make a global list and I saved a value in my global list (`def rand()`).

Whatever I save, my saved value doesnt include at another function except `rand()`.

What am I missing?

```
sayi = []

def rand():

    global sayi
    initial = 1000
    for i in range(1000,10000):
        initial +=1
        sayi.append(initial)
    print sayi[43]

def main():

    rand()
    print len(sayi) # Shows 0 but I have added value at rand funct. with append funct.
main() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:45:38.977

我假设您是 python 新手。**压痕问题**。不想刻薄，但我注意到这会让很多人感到沮丧。这是您修改后的代码。

```
sayi = []

def rand():

    global sayi
    initial = 1000
    for i in range(1000,10000):
        initial +=1
        sayi.append(initial)
    print sayi[43]

def main():

    rand()
    print len(sayi) # Shows 0 but I have added value at rand funct. with append funct.

main() 
```

你一切正常，你的缩进只是一点点。

# coffeescript - 浏览器中的 Coffeescript 语法高亮

> ID：13095328
> 
> 赞同：2
> 
> 时间：2012-10-26T22:33:55.560
> 
> 标签：coffeescript, syntax-highlighting, markdown, iced-coffeescript

我希望为 CoffeeScript 创建一个非常简单的浏览器内 IDE。现在基本上是一个文本框和一个提交按钮。然后将所有代码提交给服务器执行。

我确实想要的一件事是在浏览器中突出显示人员类型的语法。有些东西喜欢 Sublime Text 的冰咖啡。有没有办法做这种语法高亮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T01:18:11.427

您可以尝试在您的页面中嵌入[ACE 编辑器。](http://ace.ajax.org/)它有许多漂亮的语法高亮颜色主题，并且似乎支持 CoffeeScript（在他们的[厨房水槽演示](http://ace.ajax.org/build/kitchen-sink.html)中尝试 CoffeeScript 文档和模式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-16T06:19:37.203

我知道这篇文章很旧，但你总是可以使用 CodeMirror，这是 jsfiddle 使用的。

# jquery - 如何将 ZeroClipboard 剪辑粘到新插入的元素上？

> ID：13095337
> 
> 赞同：5
> 
> 时间：2012-10-26T22:34:29.633
> 
> 标签：jquery, flash, copy-paste, zeroclipboard

我正在尝试编写一个基本的博客平台，我想为用户提供将 pre 块中的代码复制到剪贴板的能力。

我正在使用[ZeroClipboard](https://github.com/jonrohan/ZeroClipboard/)来实现这一点。文档准备好后，我循环浏览`pre`页面上的每个内容，向其中添加一个剪贴板项目，如下所示：

```
 $(document).ready(function() {

        ZeroClipboard.setMoviePath( 'ZeroClipboard/ZeroClipboard.swf' );
        var preNum = 1

        $('pre').each(function() {
            // Get a unique id for the element I will be inserting
            var id = 'copy-btn-' + preNum++
            // Capture the text to be copied to the clipboard
            var text = $(this).text()
            // Insert the element, just before this
            $('<div class="copy-btn" id="' + id + '-cont"><i class="icon-file icon-white" id="' + id + '"></i></div>').insertBefore(this)
            // Capture the newly inserted element
            var elem = $(this).prev()

            // Create the clip, and glue it to the element
            var clip = new ZeroClipboard.Client();
            clip.setText(text)
            clip.glue(elem)
       })
   }); 
```

当我尝试这样做时，javascript 控制台报告：`Uncaught TypeError: Cannot read property 'zIndex' of undefined`

我目前对该问题的理解是，当我尝试将剪辑粘贴到 dom 时，插入的元素在 dom 中尚不可用，这就是没有发生粘合的原因。

有人知道我怎么能做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:27:02.350

从[粘合说明](https://github.com/jonrohan/ZeroClipboard/blob/master/docs/instructions.md#gluing)：

> 您可以传入一个 DOM 元素 ID（如上所示），或对实际 DOM 元素对象本身的引用。

您的代码不起作用，因为您将 jQuery 对象传递给它。

您可以传递 ID：

```
clip.glue(id + '-cont') 
```

或者一个实际的 DOM 元素引用：

```
clip.glue(elem[0]) 
```

上面的示例使用[`.get()`](http://api.jquery.com/get/)jQuery 对象方法的简写。

# sql - Compare 3 Consecutive rows in a table

> ID：13095338
> 
> 赞同：4
> 
> 时间：2012-10-26T22:34:50.957
> 
> 标签：sql, teradata

Hi I have an interesting problem. I Have an Employee Table AS Follows

```
CREATE TABLE EMPLOYEE(
EMPLOYEE_ID INTEGER,
SALARY DECIMAL(18,2),
PAY_PERIOD DATE) 
```

Now the tables have employees some of whom get paid monthly,some weekly, some biweekly and some daily. What we want is to find an Indicator saying 'Y' if the salary of three consecutive Pay Periods is equal. Lets take the following example.

```
Employee   Pay_Period     Salary

  1         01/01/2012    $500
  1         08/01/2012    $200
  1         15/01/2012    $200
  1         22/01/2012    $200
  1         29/01/2012    $700 
```

In this case the indicator should be Yes because 3 consecutive pay periods have a salary of $200.

Since the number of pay periods is not constant I am unsure of how to write this code because I do not know from before hand how many left joins I will need.Since I am writing this in Teradata I tried using the RECURSIVE Function but got stumped. Any general ideas on how to proceed with this?I would prefer not creating a stored procedure or having PL/SQL logic.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-28T15:57:01.587

Teradata 可能不像 Oracle 和 SQL Server 现在支持的方式支持 LEAD 和 LAG，但这些功能的前提是为您的窗口聚合函数选择正确的窗口。在 Teradata 中，可以通过在窗口聚合函数中使用 ROWS BETWEEN 子句来完成 LEAD 和 LAG。

以下是您如何使用 ROWS BETWEEN 和在桌上的单次通过来完成您想要做的事情：

```
CREATE VOLATILE TABLE myTable
( myID SMALLINT NOT NULL,
  PayPeriod DATE NOT NULL,
  PayAmount DECIMAL(5,2) NOT NULL)
PRIMARY INDEX (myID) 
ON COMMIT PRESERVE ROWS;

INSERT INTO myTable VALUES (1, DATE '2012-01-01', 500);
INSERT INTO myTable VALUES (1, DATE '2012-01-08', 200);
INSERT INTO myTable VALUES (1, DATE '2012-01-15', 200);
INSERT INTO myTable VALUES (1, DATE '2012-01-22', 200);
INSERT INTO myTable VALUES (1, DATE '2012-01-29', 700);

SELECT myID
     , PayPeriod
     , PayAmount
     , MAX(PayAmount) OVER (PARTITION BY myID 
                                ORDER BY PayPeriod 
                            ROWS BETWEEN 1 FOLLOWING 
                                     AND 1 FOLLOWING) AS NextPayAmount_
     , MAX(PayAmount) OVER (PARTITION BY myID 
                                ORDER BY PayPeriod 
                            ROWS BETWEEN 2 FOLLOWING 
                                     AND 2 FOLLOWING) AS NextPayAmount2_
     , CASE WHEN NextPayAmount_ = PayAmount
             AND NextPayAmount2_ = PayAmount
            THEN 'Y'
            ELSE 'N'
       END PayIndicator_
  FROM myTable; 
```

**结果**

```
1   2012-01-01  500 200 200 N
1   2012-01-08  200 200 200 Y
1   2012-01-15  200 200 700 N
1   2012-01-22  200 700   ? N
1   2012-01-29  700   ?   ? N 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-27T00:03:23.413

Teradata 没有领先/落后。但是，它确实有`row_number()`. 所以，你可以做你想做的事：

```
with  as (
    select e.*,
           row_number() over (partition by employee_id order by pay_period) as seqnum
    from employee
)
select <whatever you want>
from emp e join
     emp e1 join
     on e.employee_id = e1.employee_id and
        e.seqnum = e1.seqnum+1
     emp e2
     on e.employee_id = e2.employee_id and
        e.seqnum = e2.seqnum+2
where e.salary = e1.salary and e.salary = e2.salary 
```

除此之外，我确实有一些建议。首先，您的`employee`表应该有每个员工一行，主键为`employee_id`. 该表应称为`EmployeeSalary`. 其次，您的支付期应该有两个日期，开始日期和结束日期。

# android - Android - 将位图保存到文件时的工件

> ID：13095344
> 
> 赞同：1
> 
> 时间：2012-10-26T22:35:34.660
> 
> 标签：android, graphics

我有一个视图，我希望将其内容保存为图库中的图像。我正在使用以下代码：

```
 MediaStore.Images.Media.insertImage(getContentResolver(), view.getDrawingCache(), filename, "desc"); 
```

当我在图库中打开图像时，我看到图像中的文本区域周围有很多伪影。

任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T06:51:50.753

我找到了答案：

而不是**getContentResolver()** 使用**this.getContentResolver()**

这是您活动的上下文。

# joomla - 网站仅在某些页面上显示 502

> ID：13095345
> 
> 赞同：1
> 
> 时间：2012-10-26T22:35:40.287
> 
> 标签：joomla, virtuemart

在这个网站上：

[http://www.seleconlight.com](http://www.seleconlight.com)

一切安好

在这个网址上：

[http://www.seleconlight.com/index.php?option=com_virtuemart&page=shop.product_details&flypage=shop.flypage.p3&category_id=8&product_id=21](http://www.seleconlight.com/index.php?option=com_virtuemart&page=shop.product_details&flypage=shop.flypage.p3&category_id=8&product_id=21)

大多数人收到错误 502 错误请求。- 我的家庭 DSL 连接没有收到该错误，并且该站点位于数据中心中 - 我在智能手机、webpagetest.org 和 websitepulse.com 上收到错误 - 这些客户端均未出现在 Web 服务器的 apache 日志中。

通常一个 Bad gateway 错误表示中间有一个网络？这怎么可能适用于某些页面，而不适用于其他页面？

在进一步调查中，我发现了一个可以复制的页面，即使删除了有问题的代码：

```
http://www.seleconlight.com//index.php?option=com_virtuemart&page=shop.product_details&flypage=flypage.p1&category_id=121&product_id=74 
```

我对 Webpagetest 有以下测试详细信息：

[http://www.webpagetest.org/result/130122_BZ_12S8/1/details/](http://www.webpagetest.org/result/130122_BZ_12S8/1/details/)显示 502 错误

详情展示：

```
URL: http://www.seleconlight.com//index.php?option=com_virtuemart&page=shop.product_details&flypage=flypage.p1&category_id=121&product_id=74
Host: www.seleconlight.com
IP: 23.62.236.155
Error/Status Code: 502
Initiated By: 
Start Offset: 0.214 s
DNS Lookup: 159 ms
Initial Connection: 54 ms
Time to First Byte: 1675 ms
Bytes In (downloaded): 0.2 KB
Bytes Out (uploaded): 0.5 KB
Request Headers:

GET //index.php?option=com_virtuemart&page=shop.product_details&flypage=flypage.p1&category_id=121&product_id=74 HTTP/1.1
Accept: image/jpeg, application/x-ms-application, image/gif, application/xaml+xml, image/pjpeg, application/x-ms-xbap, */*
Accept-Language: en-US
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; PTST 2.345)
Accept-Encoding: gzip, deflate
Host: www.seleconlight.com
Connection: Keep-Alive
Response Headers:

HTTP/1.1 502 Bad Gateway
Content-Length: 0
Expires: Tue, 22 Jan 2013 23:15:58 GMT
Cache-Control: max-age=0, no-cache, no-store
Pragma: no-cache
Date: Tue, 22 Jan 2013 23:15:58 GMT
Connection: keep-alive

Note the IP address is 23.62.236.155, reverse DNS: a23-62-236-155.deploy.akamaitechnologies.com whereas the domain is actually on 120.138.27.252 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-20T23:50:47.083

尽管已经接受了另一个答案，但我的答案可能对某人仍然有用。我看到 Akamai 在以下情况下返回 502 错误： 1\. 标头的总大小超过 8K 2\. 单个标头（通常是 cookie）的大小超过 4K。

首先尝试减小 cookie 的大小。这是一个更好的选择。您可以要求 Akamai 增加支持的标头大小，但我建议不要这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T22:38:00.993

您的服务器和客户端之间的组件似乎有一些问题，例如负载平衡器。顺便说一句，我也得到一个`502 Bad Gateway`没有任何数据的 http 错误。

这个特殊的 url 或 joomla 插件可能会造成一些麻烦。但我无法想象如果您的 apache 日志中没有任何错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:29:29.713

经过长时间的搜索，我发现该网站确实在单个请求中设置了大约 20 次相同的 cookie。关闭此功能可解决 Akamai 代理的问题。

# java - Slick 2D for Java 中的碰撞检测

> ID：13095348
> 
> 赞同：0
> 
> 时间：2012-10-26T22:35:51.467
> 
> 标签：java, collision-detection, game-physics, slick2d

我是 Java 游戏开发以及 Slick 2D 的新手，我正在制作一款像马里奥或索尼克这样的平台游戏。无论如何，我在碰撞检测方面遇到了麻烦。我已经设置了代码，但我的播放器一直在浏览地图。我正在使用平铺地图编辑器制作地图。这是运动和碰撞检测的代码

变量

```
 private float marioX = 12;
   private float marioY = 590;
   boolean jumping = false;        
   float verticalSpeed = 0.0f;     
   private Polygon playerPoly;
   public BlockMap map2;

Input input = gc.getInput();

if (input.isKeyDown(Input.KEY_LEFT)){
    mario = marioLeft;
    marioX-=5;
    playerPoly.setX(marioX);
    if (entityCollisionWith()){
        marioX+=5;
        playerPoly.setX(marioX);
    }

}   
if (input.isKeyDown(Input.KEY_RIGHT)){
    mario = marioRight;
    marioX+=5;
    playerPoly.setX(marioX);
    if (entityCollisionWith()){
        marioX-=5;
        playerPoly.setX(marioX);
    }
}

if (input.isKeyDown(Input.KEY_SPACE) && !jumping) {
    mario = marioJumpRight;
    verticalSpeed = -.4f * delta;
    jumping = true;
}
if (jumping){
    verticalSpeed += .01f * delta;
}

marioY += verticalSpeed;
playerPoly.setY(marioY);

if (entityCollisionWith()){
    jumping = false;
    verticalSpeed = 0;
}
entityCollisionWith()

public boolean entityCollisionWith() throws SlickException {
for (int i = 0; i < BlockMap.entities.size(); i++) {
    Blocks entity1 = (Blocks) BlockMap.entities.get(i);
    if (playerPoly.intersects(entity1.poly)) {
        return true;
    }       
}       
return false;
} 
```

块映射类

```
import java.util.ArrayList;
import org.newdawn.slick.SlickException;
import org.newdawn.slick.tiled.TiledMap;

public class BlockMap {
public static TiledMap tmap;
public static int mapWidth;
public static int mapHeight;
private int square[] = {1,1,15,1,15,15,1,15}; //square shaped tile
public static ArrayList<Object> entities;

public BlockMap(String ref) throws SlickException {
entities = new ArrayList<Object>();
tmap = new TiledMap(ref, "res");
mapWidth = tmap.getWidth() * tmap.getTileWidth();
mapHeight = tmap.getHeight() * tmap.getTileHeight();

for (int x = 0; x < tmap.getWidth(); x++) {
    for (int y = 0; y < tmap.getHeight(); y++) {
        int tileID = tmap.getTileId(x, y, 0);
        if (tileID == 1) {
            entities.add(
                                new Blocks(x * 16, y * 16, square, "square")
                                );
        }
    }
   }
 }
} 
```

块类

```
import org.newdawn.slick.Graphics;
import org.newdawn.slick.geom.Polygon;

public class Blocks  {
public Polygon poly;
public Blocks(int x, int y, int test[],String type) {
poly = new Polygon(new float[]{
        x+test[0], y+test[1],
        x+test[2], y+test[3],
        x+test[4], y+test[5],
        x+test[6], y+test[7],
 });   
 }

public void update(int delta) {
}

public void draw(Graphics g) {
   g.draw(poly);
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-28T18:03:05.633

您确定要从正确的图层中获取图块吗？与您的代码一样，您从图层 ID '0' 获取图块：

```
for (int x = 0; x < tmap.getWidth(); x++) {
    for (int y = 0; y < tmap.getHeight(); y++) {
        int tileID = tmap.getTileId(x, y, 0);
        if (tileID == 1) {
            entities.add(
               new Blocks(x * 16, y * 16, square, "square")
               );
        }
    }
} 
```

您可以尝试更改此行：

```
int tileID = tmap.getTileId(x, y, 0); 
```

...对此：

```
int layerID = tmap.getLayerIndex( "CollisionLayer" ); // Or w/e your layer is called
int tileID = tmap.getTileId( x, y, layerID ); 
```

希望这可以帮助！

# javascript - 如何确定带有图层的页面在touchend上触摸的元素

> ID：13095352
> 
> 赞同：0
> 
> 时间：2012-10-26T22:36:22.120
> 
> 标签：javascript, touch-event

到目前为止，我还不能提供一个后续问题来[Get the element under a touchend](https://stackoverflow.com/questions/12596121/get-the-element-under-a-touchend)，所以我要开一个新问题。我想在与 touchstart 不同的 touchend 下获取元素，但我的页面具有绝对定位的元素，并且该函数`document.elementFromPoint`继续返回我的背景元素而不是它前面的每个元素。如何获得被触摸的*实际元素？*

# windows-runtime - Windows 应用商店应用程序中的音频压缩？

> ID：13095353
> 
> 赞同：1
> 
> 时间：2012-10-26T22:36:27.173
> 
> 标签：windows-runtime, windows-store-apps, mp3, ogg, wma

我正在寻找一种将 wav 文件压缩为其他格式的方法 - mp3、wma 或 ogg。有没有我可以使用的图书馆？Lame 不能在 WinStore 应用程序中工作，或者它会吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T23:37:22.973

[Windows.Media.Transcoding](http://msdn.microsoft.com/en-us/library/windows/apps/windows.media.transcoding)命名空间中有转码支持。有一个视频[示例](http://code.msdn.microsoft.com/windowsapps/Media-Transcode-Sample-f7ba5269#content)，但也应该支持音频。查看[MediaEncodingProfile](http://msdn.microsoft.com/en-us/library/windows/apps/hh701026.aspx)似乎支持 aac、wma 和 mp3。

*编辑（使用示例）

```
var profile = MediaEncodingProfile.CreateMp3(AudioEncodingQuality.High);
var transcoder = new MediaTranscoder();
var folder = ApplicationData.Current.LocalFolder;
var mp3File = await folder.CreateFileAsync(
    mp3FileName,
    CreationCollisionOption.ReplaceExisting);
var transcode = await transcoder.PrepareFileTranscodeAsync(wavFile, mp3File, profile);
await transcode.TranscodeAsync(); 
```

# c - 32 位整数掩码

> ID：13095354
> 
> 赞同：3
> 
> 时间：2012-10-26T22:36:30.710
> 
> 标签：c, binary, bit-manipulation, mask, bitwise-operators

我正在完成一些 CSE 作业，并且我有一个关于声明更大位大小的整数的快速问题。我的任务是实现一个函数，如果 x 的任何奇数位为 1（假设 x 的大小为 32 位）则返回 1，否则返回 0。

我可以用位值声明一个整数吗：

10101010101010101010101010101010

如果是这样，是否会出现任何问题？如果没有，为什么不呢？？我有什么选择？

我的功能：

```
int any_odd_one(unsigned x)
{
    int mask = 10101010101010101010101010101010
    if(x & mask)
    {
        return 1;
    }
    else
    {
        return 0;
    }
} 
```

提前感谢您的任何帮助！

-马特

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T22:38:57.963

您不能在 C 中使用二进制文字。而是使用十六进制或八进制表示法。

在您的情况下，您将使用`unsigned mask = 0xaaaaaaaa`since `10101010...`is`0xaaaaaaaa`以十六进制表示（每个`1010`都`a`以十六进制表示）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T23:47:29.263

将其实现为`return !!(x&-1u/3*2);`.

除了问题中所述的整数宽度外，它还适用于`unsigned`类型中的任何偶数位。

# c# - SQL 语句的 VS 2010 SQL 更新

> ID：13095357
> 
> 赞同：0
> 
> 时间：2012-10-26T22:37:10.110
> 
> 标签：c#, sql, vb.net

请耐心等待，因为我刚刚开始学习这些东西。

我有一个 VS 2010 Web 项目，我正在尝试了解如何进行自定义`UpdateCommand`（因为我选择编写自己的 SQL 语句，所以我没有 VS 2010 自动为我生成更新命令的选项。 ) 问题是：我不知道`UpdateCommand`应该是什么样子。这是我的选择：

```
SELECT * FROM Dbo.MainAsset, dbo.Model, dbo.Hardware WHERE MainAsset.device = Hardware.DeviceID AND MainAsset.model = Model.DeviceID 
```

其中，VS 2010 变成：

```
SELECT MainAsset.pk, MainAsset.img, MainAsset.device, MainAsset.model, MainAsset.os, MainAsset.asset, MainAsset.serial, MainAsset.inyear, MainAsset.expyear, MainAsset.site, MainAsset.room, MainAsset.teacher, MainAsset.FirstName, MainAsset.LastName, MainAsset.Notes, MainAsset.Dept, MainAsset.AccountingCode, Model.Model AS Hardware, Model.pk AS Model, Model.DeviceID, Hardware.Computer, Hardware.pk AS Expr3, Hardware.DeviceID AS Expr4 FROM MainAsset INNER JOIN Hardware ON MainAsset.device = Hardware.DeviceID INNER JOIN Model ON MainAsset.model = Model.DeviceID 
```

如果在 Gridview DDL 中发生更改，我将如何更新一列，例如“MainAsset.site”？任何帮助建设性的帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:04:13.347

我假设您希望将 UpdateCommand 与 SqlDataSource 和 GridView 一起使用。

更新命令[使用 SQL](http://www.sqlcourse.com/update.html)：

```
Update yourTable SET columnName = 'yourValue';
Update MainAsset Set site ='http://stackoverflow.com'; 
```

在[msdn 的示例中](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.updatecommand.aspx)，数据库列（字段）绑定到 gridview1。BoundField 的值可以通过使用带有@ 的DataField 的值来传递。数据库列 LastName 将绑定到网格列`<asp:BoundField HeaderText="Last Name" DataField="LastName" />`，并在更新命令中使用 @LastName 传递值：

```
 <asp:SqlDataSource
      id="SqlDataSource1"
      runat="server"
      DataSourceMode="DataSet"
      ConnectionString="<%$ ConnectionStrings:MyNorthwind%>"
      SelectCommand="SELECT EmployeeID,FirstName,LastName,Title FROM Employees"
      UpdateCommand="Update Employees SET   
         FirstName=@FirstName,LastName=@LastName,
         Title=@Title WHERE EmployeeID=@EmployeeID"
      OnUpdated="OnDSUpdatedHandler">
  </asp:SqlDataSource>

  <asp:GridView
      id="GridView1"
      runat="server"
      AutoGenerateColumns="False"
      DataKeyNames="EmployeeID"
      AutoGenerateEditButton="True"
      DataSourceID="SqlDataSource1">
      <columns>
          <asp:BoundField HeaderText="First Name" DataField="FirstName" />
          <asp:BoundField HeaderText="Last Name" DataField="LastName" />
          <asp:BoundField HeaderText="Title" DataField="Title" />
      </columns>
  </asp:GridView> 
```

## 更新以解决您的评论

您`Select * from Dbo.MainAsset, dbo.Model ...`从不同的表中加载数据并将它们显示为一个大表。这称为联接。您的 Select 使用[旧的连接语法而不是新的语法](http://www.sqlmag.com/article/sql-server/old-join-syntax-vs-new)

我不确定我是否理解您的评论：“我在询问语法应该如何查找 UpdateCommand。” 在您的更新中，您想更新所有 3 个表（MainAsset、Model 和 Hardware）中的值吗？如果是这种情况，我们需要知道网格中显示的单列。您可以查看[此问题](https://stackoverflow.com/questions/1293330/how-can-i-do-an-update-statement-with-join-in-sql)或此[更新加入说明](http://www.katieandemil.com/sql-update-statement-syntax-join-examples-using-sql-server#sqlupdatejoin)，以更好地了解加入更新。

### UpdateCommand 的更新 2 语法

1.  如何制作自定义 UpdateCommand？
2.  我将如何更新一列，比如“MainAsset.site”
3.  如果下拉列表更改，如何更新记录？

首先，您需要知道[SQL Server 中正常的更新语句是](http://www.katieandemil.com/sql-update-statement-syntax-join-examples-using-sql-server#sqlupdatejoin)怎样的：

```
UPDATE MainAsset
    SET site= NewValueForSite
        ,teacher = 'Dr. Seuss'
    WHERE rowId = FilterValue 
```

要创建自定义更新命令，您需要编写所需的 sql 并将其分配/传递给 SqlDataSource 的属性[UpdateCommand](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.updatecommand.aspx)。您可以执行以下操作（假设 pk 代表主键并标识一行）：

```
 <asp:SqlDataSource
      id="SqlDataSource1"
      // ... see above          
      UpdateCommand="Update MainAsset SET   
         site=@site
         ,teacher=@teacher,
         WHERE pk=@pk"
      OnUpdated="OnDSUpdatedHandler">
  </asp:SqlDataSource> 
```

关于您的第三个问题，我想向您指出[这个问题](https://stackoverflow.com/questions/7141277/asp-net-dropdownlist-populates-gridview)：

```
<asp:DropDownList ID="ddlSite" runat="server"  
   AutoPostBack="True" 
   OnSelectedIndexChanged="SelectionHasChanged"
   DataSourceID="SqlDataSource1" DataTextField="site"
   DataValueField="pk" AppendDataBoundItems="true"> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-07T16:12:18.647

长话短说，这就是我所做的：

有问题的 DDL：

```
 <asp:TemplateField HeaderText="site" SortExpression="site">
                <EditItemTemplate>
                    <asp:DropDownList ID="ddlSites" runat="server" AutoPostBack="True" 
                        DataSourceID="RetrieveSiteSQL" DataTextField="Sites" DataValueField="Sites" 
                        SelectedValue='<%# Bind("site") %>'>
                    </asp:DropDownList>
                </EditItemTemplate> 
```

我发现我的 RetrieveSiteSQL 不是需要更新命令的那个，而是当我单击“更新”（在编辑模板中）时更新的“主”SQL 数据源。所以，我发现UpdateCommand="UPDATE MainAsset ..." 语句必须类似于：

```
UpdateCommand="UPDATE MainAsset SET [site] = @Site WHERE [pk] = @pk"> 
```

我现在有一个不同的问题，但这是一个单独的问题，所以我会在这个网站上发布一个不同的问题。

谢谢大家的帮助。

# android - 如何拍摄像方形大小的照片一样的 Instagram

> ID：13095367
> 
> 赞同：1
> 
> 时间：2012-10-26T22:38:09.963
> 
> 标签：android, camera, android-camera

我有一个问题是如何拍摄像 Instagram 这样的方形照片。可能有这样的帖子，但我没有发现任何对我特别有帮助的帖子。这是我的问题：我尝试调用 getSupportedPictureSize() 并看到大多数支持的图片尺寸是矩形的，而那些少数方形尺寸的图片分辨率较低。另一方面，如果我将预览大小设置为矩形图片的正方形，那么预览看起来会被拉伸。任何人都知道我该怎么做？我真的很感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T04:44:10.893

不，您不能拍摄相机不支持的尺寸的照片。但是您可以裁剪您在图片回调中收到的图像。

# javascript - jQuery .css('margin-left') 在 IE7 和 IE8 中返回“auto”

> ID：13095368
> 
> 赞同：2
> 
> 时间：2012-10-26T22:38:17.307
> 
> 标签：javascript, jquery, css

我正在尝试获取元素的左边距值。这在 Chrome、FireFox 和 IE9 中运行良好，但在 IE7 和 IE8 中我得到“自动”返回：

```
alert($('#'+page+'menubuttoncontainer').css('margin-left').replace('px', '')); 
```

我怎样才能得到一个号码而不是“自动”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T22:40:51.143

`.css`返回 CSS 的值。

为了获得位置，您应该使用偏移函数：[http ://api.jquery.com/offset/](http://api.jquery.com/offset/)

或者位置函数：[http ://api.jquery.com/position/](http://api.jquery.com/position/)

# c# - 保存文化日期 Linq to SQL

> ID：13095370
> 
> 赞同：2
> 
> 时间：2012-10-26T22:38:25.950
> 
> 标签：c#, asp.net-mvc, linq-to-sql

我有一个要求选择日期的视图。然后通过创建一个对象并使用 linq 插入将其保存到数据库中：

```
Event e = new Event();
e.Date = model.DateEntered;

context.Events.InsertOnSubmit(e);
context.SubmitChanges(); 
```

在这一行上，我得到了日期格式的例外。本地情况并非如此，因为我理解这与 Web 配置文件中所需的全球化属性有关。我的问题是，有没有办法在视图中以他们所在地区的预期格式向用户显示日期，然后另存为英国日期格式？

我在哪里申报这种全球化财产，这是否意味着美国人民将无法储蓄？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:47:35.600

将其保存到数据库时将其转换回 UTC，方法是：

```
e.Date = TimeZoneInfo.ConvertTimeToUtc(model.DateEntered); 
```

# linux - 通过将其添加到 PATH 从任何地方在终端中运行命令或脚本，我做错了什么？

> ID：13095379
> 
> 赞同：0
> 
> 时间：2012-10-26T22:39:36.850
> 
> 标签：linux, macos, terminal

在 osx/linux 上，我希望能够从链接到某个程序的任何地方在终端上运行命令。

即我希望能够运行：

`alloy`

运行：

`/usr/local/share/npm/lib/node_modules/alloy/bin/alloy`

更新：猜猜添加到 .bashrc 是最好的方法？

尝试运行：导出

`PATH="$PATH:/usr/local/share/npm/lib/node_modules/alloy/bin"`

并且：

`export PATH="$PATH:/usr/local/share/npm/lib/node_modules/alloy/bin/alloy"`

然后我启动了一个新的终端窗口，但合金命令不起作用。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:40:54.433

您可以将 /usr/local/share/npm/lib/node_modules/alloy/bin 放在[PATH](http://www.cs.purdue.edu/homes/cs348/unix_path.html)中，或者您可以为合金[创建别名](http://ss64.com/bash/alias.html)。

# python - Python FTP下载 - 忽略下载目录中已经存在的文件

> ID：13095382
> 
> 赞同：2
> 
> 时间：2012-10-26T22:40:07.053
> 
> 标签：python, ftplib

我有一个脚本可以按设定的时间间隔从 FTP 目录中提取文件。但是，由于文件只是被复制而不是移动，因此最终会一遍又一遍地提取相同的文件。确保我只提取新文件的最佳方法是什么？我正在考虑将 FTP 站点上的文件与本地目录中的文件交叉引用，但不太确定该怎么做。另外，我将如何不仅检查文件名，还要检查修改日期？例如：random_file.txt 最初于 2012 年 10 月 25 日下午 2:15 放置在 FTP 站点上，并在 5 分钟后下载。然后，在 2012 年 10 月 26 日上午 11:40，FTP 站点上的 random_file.txt 被替换为更新版本。我可以从 FTP 站点下载和/或仅覆盖本地目录中的新文件吗？谢谢！

这是我现有的代码：

```
import ftplib, os

def fetch():
    server = 'ftp.example.com'
    username = 'foo'
    password = 'bar'
    directory = '/random_directory/'
    filematch = '*.txt'
    ftp = ftplib.FTP(server)
    ftp.login(username, password)
    ftp.cwd(directory)
    for filename in ftp.nlst(filematch):
        fhandle = open(os.path.join('C:my_directory', filename), 'wb')
        print 'Getting ' + filename
        ftp.retrbinary('RETR ' + filename, fhandle.write)
        fhandle.close() 
```

**更新：**所以我至少部分地使用了 Siddharth Toshniwal 的链接来解决这个问题。对于那些可能偶然发现并需要它的人，这是我到目前为止的新代码。请注意，这仅检查文件是否存在，而不是修改日期：

```
for filename in ftp.nlst(filematch):
        if os.path.exists('C:\my_directory\\' + filename) == False:
            fhandle = open(os.path.join('C:\my_directory', filename), 'wb')
            print 'Getting ' + filename
            ftp.retrbinary('RETR ' + filename, fhandle.write)
            fhandle.close()
        elif os.path.exists(('C:\my_directory\\' + filename)) == True:
            print 'File ', filename, ' Already Exists, Skipping Download' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:54:08.473

我赞同使用 rsync 之类的东西而不是在 python 中破解某些东西的观点。

但无论出于何种原因，如果这不可行，以下链接应该可以帮助您： [http](http://code.activestate.com/recipes/327141-simple-ftp-directory-synch/) ://code.activestate.com/recipes/327141-simple-ftp-directory-synch/ http://alexharvey.eu/code/python /get-a-files-last-modified-datetime-using-python/

# ruby-on-rails - 那我不应该看到（黄瓜）

> ID：13095383
> 
> 赞同：2
> 
> 时间：2012-10-26T22:40:17.163
> 
> 标签：ruby-on-rails, cucumber

我正在尝试使用 Cucumber 检查网页上的过滤器功能。如果我检查特定的电影评级，那么它应该只显示表中具有这些评级的电影。这是我的场景：

```
When I check the following ratings: 'PG', 'R'
And I press Refresh
Then I should not see /PG/ 
```

这是我的步骤定义：

```
Then /^(?:|I )should not see \/([^\/]*)\/$/ do |regexp|
  regexp = Regexp.new(regexp)
  if page.respond_to? :should
    page.should have_no_xpath('//*', :text => regexp)
  else
    assert page.has_no_xpath?('//*', :text => regexp)
  end
end 
```

但我收到“不明确的匹配”错误。

以下是一些 HTML，以防它很重要：

```
 <table id='movies'>
    <thead>
      <tr>
        <th>Movie Title</th>
        <th>Rating</th>
        <th>Release Date</th>
        <th>More Info</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Aladdin</td>
        <td>G</td>
        <td>1992-11-25 00:00:00 UTC</td>
        <td><a href="/movies/1">More about Aladdin</a></td>
      </tr> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T09:27:43.747

问题不在于您在此处定义的步骤，而在于您在其他地方定义了与其中之一冲突的步骤。如果在此处有意义，您应该重用该步骤，或者创建一个不冲突的步骤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T05:38:32.497

正如 michaeltwofish 所说。您可能定义了一个执行相同操作的步骤。尝试删除其中一个步骤。

如果您有重复的方法/定义。意思是一个带有“And”的定义和另一个带有“Then”的定义，它们做同样的事情算作同样的方法。

And/When/Then/Given 基本上是一回事。他们服务只是为了让用户故事流在一个更具可读性的庄园里

希望这些附加信息有所帮助。

# android - 在内部和外部之间进行选择（内部数据存储限制）

> ID：13095385
> 
> 赞同：2
> 
> 时间：2012-10-26T22:40:25.013
> 
> 标签：android, storage

我目前正在准备一个拼图应用程序。但是，如果我应该选择内部或外部存储（或任何其他建议），我处于两难境地。该应用程序将包含 30 张拼图图像（以及选择自己的图库图像的选项）。我不是一个非常有经验的编码人员，所以最好和最简单的选择之间的组合会很棒。

*   对于内部存储：应用程序等的设置更安全，但我害怕达到数据限制。
*   对于外部存储：“只要将外部存储安装在设备上，就不会影响应用程序的性能。” （developer.android）尤其是关于安装的最后一部分让我害怕。

在此先感谢，~Olijf

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:47:44.447

为什么不在您的清单中设置它：

```
 android:installLocation="auto" 
```

如果您声明“auto”，则表明您的应用程序可能安装在外部存储上，但您没有安装位置的偏好。系统将根据几个因素决定在哪里安装您的应用程序。用户还可以在两个位置之间移动您的应用程序。

编辑：

检查外部或内部存储是否可用：

```
boolean mExternalStorageAvailable = false;
boolean mExternalStorageWriteable = false;
String state = Environment.getExternalStorageState();

if (Environment.MEDIA_MOUNTED.equals(state)) {
    // We can read and write the media
    mExternalStorageAvailable = mExternalStorageWriteable = true;
} else if (Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) {
    // We can only read the media
    mExternalStorageAvailable = true;
    mExternalStorageWriteable = false;
} else {
    // Something else is wrong. It may be one of many other states, but all we need
    //  to know is we can neither read nor write
    mExternalStorageAvailable = mExternalStorageWriteable = false;
} 
```

# windows - 批处理文件注释不一致

> ID：13095386
> 
> 赞同：1
> 
> 时间：2012-10-26T22:40:32.017
> 
> 标签：windows, batch-file, comments

我注意到有时当我在批处理脚本中添加注释时，我会收到错误消息：

```
The syntax of the command is incorrect. 
```

其他时候，没有问题。在它有效的情况与无效的情况下，我没有看到任何模式。

例如：

```
for /R /D %%d in (.\*) do (

    echo %%d
    :: comment here  <<NO ERROR>>

    for %%f in (%%d\*) do (

        echo %%f
        :: comment here <<ERROR>>
    ) 
) 
```

顶部的评论没有问题，底部的评论没有问题。两者都在自己的行上，完全相同的文本，选项卡，并且直接在 echo 语句之后。第一个评论没有问题，第二个导致错误。

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T08:39:30.950

如果您使用 REM 而不是 :: 它适用于您...

可能是解析器错误:-)

```
for /R /D %%d in (.\*) do (

    echo %%d
    REM comment here  <<NO ERROR>>

    for %%f in (%%d\*) do (

        echo %%f
        REM comment here <<ERROR>>
    ) 
) 
```

# php - PHP 管理员帐户

> ID：13095387
> 
> 赞同：0
> 
> 时间：2012-10-26T22:40:36.583
> 
> 标签：php, jquery, html, authentication, user-accounts

在我的网站上，我希望在有人使用管理员帐户登录时启用一些选项。我的问题是关于如何尽可能保护该管理员帐户。他们在我的网站上设置登录方式是在验证登录后，我这样做`$_SESSION['status'] = 'authorized';`，然后我说这样的话：

```
<script>
$(document).ready(function(e) {
    if(<?php echo ($_SESSION['status'] == 'authorized'); ?>) {
        $('#account_window').show();
    }
});
</script>

<div id="account_window">
    //account stuff
</div> 
```

添加主帐户后，我正在考虑添加此内容`$_SESSION['master'] = 'authorized';`，然后在首页中添加以下代码：

```
<script>
$(document).ready(function(e) {
    if(<?php echo ($_SESSION['status'] == 'authorized'); ?>) {
        $('#account_window').show();
    }
});
</script>

<div id="account_window">
    //account stuff
    <?php if($_SESSION['master'] == 'authorized') { ?>
        <div id="master_account">
            //admin stuff like send users emails
        </div>
    <?php } ?>
</div> 
```

但是我觉得这太容易了，这是一种安全的方式来验证主帐户吗？如果不是，那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T22:45:11.380

It might be tempting to just "hide" the admin interface from non-admins, but that's fundamentally bypassable if someone just injects the right HTML into the page (e.g. with a GreaseMonkey script), or generates the requests manually.

You have to validate every action in PHP in order to get any actual security. Therefore, you need to check that the user is authorized when they submit any forms or commit an action, in PHP.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-03T23:08:53.970

You have to validate every action in PHP in order to get any actual security. Therefore, you need to check that the user is authorized when they submit any forms or commit an action, in PHP.

# java - 如何将分隔字符串拆分为列表

> ID：13095388
> 
> 赞同：-2
> 
> 时间：2012-10-26T22:40:45.153
> 
> 标签：java, string, split

> **可能重复：**
> [Java：如何将逗号分隔的字符串转换为 ArrayList](https://stackoverflow.com/questions/7488643/java-how-to-convert-comma-separated-string-to-arraylist)

我有一个 String `Red*Blue*Yellow*Green*White`。如何将该字符串分解`*`为一个`List<String>`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T22:42:45.227

你可以试试这个： -

```
String str = "Red*Blue*Yellow*Green";
String[] arr = str.split("\\*");
List<String> list = new ArrayList<String>(Arrays.asList(arr)); 
```

**注意**：-

**`Arrays.asList`**返回一个`unmodifiable`列表，所以如果你想要一个，你需要使用一个对象作为参数`modifiable list`来创建一个新列表。`constructor of ArrayList``Collection`

此外，since`*`是 中的一个特殊字符`Regex`，并`String.split()`采用 a`Regex`进行拆分。所以，你需要`*`用反斜杠转义。

**输出**： -

```
[Red, Blue, Yellow, Green] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T22:42:27.620

```
 String[] str ="Red*Blue*Yellow*Green*White".split("\\*");
    List<String> list = Arrays.asList(str); 
```

输出：

```
[Red, Blue, Yellow, Green, White] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T22:44:09.270

请试试这个

```
 String ss="Red*Blue*Yellow*Green*Whit";
       String sss[] = ss.split("\\*");
       List <String> ssss = Arrays.asList(sss); 
```

# javascript - 我应该如何归因于 Twitter bootstrap 的 glyphicons 组件？

> ID：13095392
> 
> 赞同：6
> 
> 时间：2012-10-26T22:41:00.937
> 
> 标签：javascript, html, twitter-bootstrap, glyphicons

在 GitHub 的 Twitter 引导页面上，[Base CSS 页面的图标部分是](http://twitter.github.com/bootstrap/base-css.html#icons)这样说的：

> Glyphicons 半身人通常不是免费提供的，但是 Bootstrap 和 Glyphicons 创作者之间的安排使这成为可能，而您作为开发人员无需支付任何费用。为了感谢您，我们要求您在可行的情况下包含一个返回 Glyphicons 的可选链接。

这种归因应该采用标准形式吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T22:41:00.937

为了回答我自己的问题，解决方案大概是按照 Twitter 在引导 GitHub 页面的页脚中所做的相同方式来归因[Glyphicons](http://glyphicons.com)，即：

```
<p>Icons from <a href="http://glyphicons.com">Glyphicons Free</a>, licensed 
under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p> 
```

这似乎掩盖了一个事实，即知识共享许可证特别*不*涵盖半身人，但我想如果它对 Twitter 来说足够好，那么对我们其他人来说应该没问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T15:00:52.047

> GLYPHICONS Halflings 字体也作为 Bootstrap www.getbootstrap.com 的扩展免费发布，并在与 Bootstrap 相同的许可下发布。**虽然您不需要在基于 Bootstrap 的项目中包含归属，但我当然会感谢任何形式的支持，即使是一个不错的推文就足够了。**当然，如果您愿意，可以通过在 GLYPHICONS.com 上购买更多图标来表示感谢并支持我。

这是来自[https://glyphicons.com/license/](https://glyphicons.com/license/)。我希望这对你有帮助。

对我来说，我将制作信用页面并将链接放回字形图标。我不想把链接放在页脚，因为这是 Apache 2.0 许可而不是 CC。我非常感谢他们的工作，但在页脚添加链接也是关于 SEO 的。

# objective-c - 使用 presentViewController:animated:completion 正确更改模态视图控制器的大小：

> ID：13095395
> 
> 赞同：0
> 
> 时间：2012-10-26T22:41:28.767
> 
> 标签：objective-c, ios5, resize, ios6, presentmodalviewcontroller

在 IOS 6 之前，我使用以下代码来呈现具有自定义大小的模态视图：

```
- (void) showModalViewWithController:(GUIViewController*) _viewController {
    [UIView beginAnimations:@"" context:nil];
    [self presentModalViewController:_viewController animated:YES];
    _viewController.view.superview.autoresizingMask = UIViewAutoresizingFlexibleHeight;
    _viewController.view.superview.frame = CGRectMake(
        _viewController.view.superview.frame.origin.x,
        _viewController.view.superview.frame.origin.y,
        700.0f,
        self.view.frame.size.height - 80.f);
    _viewController.view.superview.center = self.view.center;

    [UIView commitAnimations];
} 
```

现在我必须更改功能

```
- (void)presentModalViewController: (UIViewController *)viewControllerToPresent animated:(BOOL)flag 
```

至

```
- (void)presentViewController: (UIViewController *)viewControllerToPresent animated: (BOOL)flag completion: (void (^)(void))completion 
```

不幸的是，在这样的更改之后调整大小效果不佳：

```
- (void) showModalViewWithController:(GUIViewController*) _viewController {
    [self presentViewController:_viewController animated:YES completion:^(){
        [UIView beginAnimations:@"" context:nil];
        _viewController.view.superview.autoresizingMask = UIViewAutoresizingFlexibleHeight;
        _viewController.view.superview.frame = CGRectMake(
            _viewController.view.superview.frame.origin.x,
            _viewController.view.superview.frame.origin.y,
            700.0f,
            self.view.frame.size.height - 80.f);
        _viewController.view.superview.center = self.view.center;
        [UIView commitAnimations];
    }];
} 
```

因为模态视图在它的框架操作之前呈现并且它在调用完成块之后跳转。

如何处理？

提前致谢，

米哈乌

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T02:05:18.427

我不确定为什么完成块动画会跳转。我从来没有使用过这种`[UIView beginAnimations:context:]`方法。我通常将基于块的动画方法称为`[UIView animateWithDuration:animations:completion:]`. 这是因为在 iOS 4 及更高版本中不鼓励使用 beginAnimations 方法。

我会尝试更改您的动画以使用基于块的方法。提交动画后，可能会出现一些奇怪的线程问题。

我发现您在显示视图*后*调整视图大小而不是事先调整大小，这很有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-29T12:49:51.207

AHKNavigationController *navigationController = [[AHKNavigationController alloc] initWithRootViewController:moreOverView];

[navigationController setModalPresentationStyle:UIModalPresentationFormSheet];

```
 navigationController.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
    navigationController.navigationBarHidden=YES;
    if([[[UIDevice currentDevice] systemVersion] floatValue] < 8.0)
    {
        [self presentViewController:navigationController animated:YES completion:^{
            [UIView animateWithDuration:0.3 delay:0 options:UIViewAnimationOptionCurveEaseIn animations:^{
                    //Make the modal bigger than normal
                navigationController.view.superview.frame = CGRectMake(
                                                                       navigationController.view.superview.frame.origin.x,
                                                                       navigationController.view.superview.frame.origin.y,
                                                                       540,
                                                                       622
                                                                       );
            } completion:^(BOOL finished) {
            }];
        }];
    }
    else{
        [self presentViewController:navigationController animated:YES completion:nil];
        navigationController.preferredContentSize = CGSizeMake(540,622);
        navigationController.view.superview.center = self.view.center;
    }
    navigationController.view.superview.autoresizingMask =
    UIViewAutoresizingFlexibleTopMargin |
    UIViewAutoresizingFlexibleBottomMargin; 
```

AHKNavigationController 位于[https://github.com/fastred/AHKNavigationController](https://github.com/fastred/AHKNavigationController)

# hadoop - hadoop -libjars 和 ClassNotFoundException

> ID：13095402
> 
> 赞同：1
> 
> 时间：2012-10-26T22:42:54.700
> 
> 标签：hadoop, mapreduce, hdfs, cloudera

请帮忙，我卡住了。这是我运行作业的代码。

```
hadoop jar mrjob.jar ru.package.Main -files hdfs://0.0.0.0:8020/MyCatalog/jars/metadata.csv -libjars hdfs://0.0.0.0:8020/MyCatalog/jars/opencsv.jar,hdfs://0.0.0.0:8020/MyCatalog/jars/gson.jar,hdfs://0.0.0.0:8020/MyCatalog/jars/my-utils.jar /MyCatalog/http_requests.seq-r-00000 /MyCatalog/output/result_file 
```

我确实收到了这些警告：

```
12/10/26 18:35:50 WARN util.GenericOptionsParser: The libjars file hdfs://0.0.0.0:8020/MyCatalog/jars/opencsv.jar is not on the local filesystem. Ignoring.
12/10/26 18:35:50 WARN util.GenericOptionsParser: The libjars file hdfs://0.0.0.0:8020/MyCatalog/jars/gson.jar is not on the local filesystem. Ignoring.
12/10/26 18:35:50 WARN util.GenericOptionsParser: The libjars file hdfs://0.0.0.0:8020/MyCatalog/jars/my-utils.jar is not on the local filesystem. Ignoring. 
```

然后：**线程“main”中的异常 java.lang.NoClassDefFoundError：** 在 Main 类中在线我尝试从名为 my-utils.jar 的 jar 实例化类

1.  所有这些罐子都在 hfds 中（我通过文件浏览器看到它们）
2.  my-utils.jar 确实包含类，这是**NoClassDefFoundError的原因**

我做错了什么？

**UPD：** 我正在检查**GenericOptionsParser**的源代码：

```
/**
   * If libjars are set in the conf, parse the libjars.
   * @param conf
   * @return libjar urls
   * @throws IOException
   */
  public static URL[] getLibJars(Configuration conf) throws IOException {
    String jars = conf.get("tmpjars");
    if(jars==null) {
      return null;
    }
    String[] files = jars.split(",");
    List<URL> cp = new ArrayList<URL>();
    for (String file : files) {
      Path tmp = new Path(file);
      if (tmp.getFileSystem(conf).equals(FileSystem.getLocal(conf))) {
        cp.add(FileSystem.getLocal(conf).pathToFile(tmp).toURI().toURL());
      } else {
        LOG.warn("The libjars file " + tmp + " is not on the local " +
          "filesystem. Ignoring.");
      }
    }
    return cp.toArray(new URL[0]);
  } 
```

所以：1.逗号之间没有空格2.还是不明白...我试图指向：本地文件系统，hdfs文件系统，结果是一样的。好像没有添加类...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-27T11:00:36.920

问题解决了。正确的调用是：

```
hadoop jar my-job.jar ru.package.Main -files /home/cloudera/uploaded_jars/metadata.csv -libjars /home/cloudera/uploaded_jars/opencsv.jar,/home/cloudera/uploaded_jars/gson.jar,/home/cloudera/uploaded_jars/url-raiting-utils.jar /MyCatalog/http_requests.seq-r-00000 /MyCatalog/output/scoring_result 
```

在哪里

> /我的目录

是hdfs路径，

> /home/cloudera/uploaded_jars/

是本地 fs 路径 **问题出在作业 jar 中。** 以前我确实尝试过使用*只有三个类的简单 jar 来运行作业：Mapper、Reducer、Main class*。现在我确实提供了由 maven 生成的另一个（它生成了其中两个） **第二个作业 jar 包含所有依赖库**。在里面。结构如下： *my-job.jar*

-*库*

-- *aopalliance-1.0.jar asm-3.2.jar avro-1.5.4.jar ... commons-beanutils-1.7.0.jar commons-beanutils-core-1.8.0.jar ... zookeeper-3.4.3 -cdh4.0.0.jar*

lib 文件夹中有 76 个 jars。

它有效，但我不明白为什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T22:48:45.803

仅仅因为它们在 HDFS 上，并不意味着它们在您正在运行的作业的类路径中。

如果你真的只是想解决这个问题，我会使用 maven 来构建一个“胖 jar”，它将你所有的依赖项包含在一个 jar 中。您可以使用[shade 插件](http://maven.apache.org/plugins/maven-shade-plugin/)来做到这一点。

但是，看看你的命令，它看起来是错误的。我认为使用带有 -libjars 的“job”命令可能会更好，[这里描述](http://hadoop.apache.org/docs/r1.0.3/commands_manual.html#jar)。我不确定您是否可以使用“hadoop jar”命令指定外部 jar。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-30T15:23:38.527

原因是您的 mrjob.jar 确定了 Hadoop 客户端作业所需的 jar。您可以提供一个胖 jar，也可以将所有 jar 包含在 HADOOP_CLASSPATH 下。

另一方面，-libjars 设置 Map 和 Reduce 任务所需的额外 jar。

阅读此[http://grepalex.com/2013/02/25/hadoop-libjars/](http://grepalex.com/2013/02/25/hadoop-libjars/)

# css - 使用 display:table-cell 定位

> ID：13095403
> 
> 赞同：0
> 
> 时间：2012-10-26T22:42:57.447
> 
> 标签：css, html, css-tables, placement

我正在尝试使用标签来设置网页以分隔不同的元素：标题/横幅和菜单。后面的内容会补充的，不过现在已经够麻烦了。

我的 div 是这样排列的：

```
<!-- Header showing banner and sitename -->
<div class="header">
    pagetitle
</div>

<!-- Small space for the menu -->
<div class="menu">
    <a class="menuItem" href="google.com">Google is here!</a>
    <a class="menuItem" href="somewhere.com">Work work</a>
</div> 
```

为了正确放置它们，我使用了 CSS 样式表（我是 CSS 新手，我认为这是我的问题......）

```
/* Holds the style information for the header/banner */
div.header{
    /* Size of div/header */
    width:900px;
    height:200px;

    /* Header image, main content actually */
    background-image:url('../img/header.png');

    /* Font look */
    font-family:"Lucida Console","Curier New",Monospace;
    font-size:75px;
    color:#CCCCCC;
    text-align:right;

    /* Used for putting text in buttom right corner.
     * -->NOT<-- supported in IE8 and earlier.
     */
    display:table-cell;
    vertical-align:bottom;
}

/* Holds the style information for the menu */
div.menu{
    /* Size of div/menu */
    width:900px;
    height:50px;

    /* Background for the menu */
    background-image:url('../img/menu.png');

    /* Positioning of items */
    text-align:center;
    vertical-align:middle;
    /* FIXME: Causes the menu to jump up next to the header!
     * NOT VERY GOOD BEHAVIOUR!
     */
    display:table-cell;
} 
```

现在，“display:table-cell”和“vertical-align”部分用于垂直放置文本。并且工作正常，文本在 div 中的位置正确，但是当存在多个时，它们会跳到彼此旁边，这是他们不应该做的。

在我看来，我发现了 2 个非常肮脏的解决方案；将 div 与

```
<p></p> 
```

或者

```
</br> 
```

但我真的不认为那是方式......有没有通过CSS表解决这个问题的好方法？

对于我的问题的“现场演示”，请访问：*** *。标题是一个占位符，而真实的则呈现。希望您能够帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:51:20.353

摆脱那个`display: table-cell`。而是使用`line-height`垂直对齐您的文本并将`margin: 0 auto;`您的 div-s 在页面中居中。

```
div.header {
    background-image: url("../img/header.png");
    color: #CCCCCC;
    font-family: "Lucida Console","Curier New",Monospace;
    font-size: 75px;
    height: 200px;
    line-height: 350px;
    margin: 0 auto;
    text-align: right;
    width: 900px;
}

div.menu {
    background-image: url("../img/menu.png");
    height: 50px;
    line-height: 50px;
    margin: 0 auto;
    text-align: center;
    vertical-align: middle;
    width: 900px;
} 
```

# emacs - 如果激活 emacs，则搜索区域

> ID：13095405
> 
> 赞同：2
> 
> 时间：2012-10-26T22:43:06.667
> 
> 标签：emacs

有没有办法告诉 isearch 搜索活动区域（如果有）？否则定期提示输入字符串。

## 编辑：27.10.12

我最终使用了这些功能：

```
(defun er/isearch-word-at-point ()
  (interactive)
  (call-interactively 'isearch-forward-regexp))

(defun er/isearch-yank-word-hook ()
  (when (equal this-command 'er/isearch-word-at-point)
    (let ((string (concat "\\<"
                          (buffer-substring-no-properties
                           (progn (skip-syntax-backward "w_") (point))
                           (progn (skip-syntax-forward "w_") (point)))
                          "\\>")))
      (if (and isearch-case-fold-search
               (eq 'not-yanks search-upper-case))
          (setq string (downcase string)))
      (setq isearch-string string
            isearch-message
            (concat isearch-message
                    (mapconcat 'isearch-text-char-description
                               string ""))
            isearch-yank-flag t)
      (isearch-search-and-update))))

(defun er/isearch-yank-region ()
  (interactive)
  (isearch-yank-internal (lambda () (mark))))

(define-key isearch-mode-map (kbd "C-r") 'er/isearch-yank-region)
(define-key isearch-mode-map (kbd "C-t") 'er/isearch-word-at-point) 
```

第一个是我在网上某处找到的一个函数，将光标下的单词标记为搜索词（类似于 vim 中的 * 和 # ）并直接跳转到下一个出现，第二个是 @Oleg Pavliv 的答案。

## 编辑#2

实际上，为什么不将它们结合起来以获得超甜味呢？好的！

```
(defun er/isearch-word-or-region-at-point ()
  (interactive)
  (if (region-active-p)
      (isearch-yank-internal (lambda () (mark)))
  (call-interactively 'isearch-forward-regexp)))

(defun er/isearch-yank-word-hook ()
  (when (equal this-command 'er/isearch-word-or-region-at-point)
    (let ((string (concat "\\<"
                          (buffer-substring-no-properties
                           (progn (skip-syntax-backward "w_") (point))
                           (progn (skip-syntax-forward "w_") (point)))
                          "\\>")))
      (if (and isearch-case-fold-search
               (eq 'not-yanks search-upper-case))
          (setq string (downcase string)))
      (setq isearch-string string
            isearch-message
            (concat isearch-message
                    (mapconcat 'isearch-text-char-description
                               string ""))
            isearch-yank-flag t)
      (isearch-search-and-update))))
(add-hook 'isearch-mode-hook 'er/isearch-yank-word-hook)
(define-key isearch-mode-map (kbd "C-r") 'er/isearch-word-or-region-at-point) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T04:26:05.690

好问题。

在 Emacs 中似乎没有这种可能性。你可以自己实现

```
(defun isearch-yank-region ()
  (interactive)
  (isearch-yank-internal (lambda () (mark))))

(define-key isearch-mode-map "\C-r" 'isearch-yank-region) 
```

现在您选择一个区域，调用增量搜索`C-s`并拉出该区域`C-r`。然后您可以继续增量搜索`C-s`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T01:16:54.017

实现您想要的一个简单方法是在搜索之前将当前区域保存到 kill-ring，然后将其作为搜索词拉入 minibuffer。您可以通过执行以下键序列来执行此操作：

`M-w C-s M-y`

翻译为：

`M-w`: 像被杀死一样保存区域，但不会杀死它。

`C-s`: 向前做增量搜索。

`M-y`：拉出最后一串被杀死的文本（或者更确切地说，`M-w`之前保存的内容）。

打字有点像手指舞，但如果你经常使用它，它就会成为第二天性。这个通用解决方案的好处是它只使用 Emacs 已经内置的基本功能。无需建议任何功能。

# scala - 在 Play 2.0 应用程序中处理运行时异常

> ID：13095407
> 
> 赞同：0
> 
> 时间：2012-10-26T22:43:32.377
> 
> 标签：scala, exception-handling, playframework

在我的 Play 2.0 应用程序中，我调用了一个 Java API，它依赖于某些环境变量被设置为正常工作。但是，这只能在运行时检查，我想做的是在应用程序开始时抛出一个有意义的错误消息，但不确定如何处理它。一种可能的方法是使用 require like

```
object TemplatesController extends Controller {
  val driver = setFromEnvVars //returns None or Some(blah)
  require(!driver.isEmpty)

  def index = Action {
    Ok("Wheee")
  }
  ...
} 
```

上述方法的问题是我得到了一个`java.lang.ExceptionInInitializerError`堆栈跟踪（在开发模式下），而无法显示有意义的错误消息。有谁知道更好的方法来处理这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T02:12:10.157

您可以创建一个`object Global extends GlobalSettings`在启动期间自动调用的。请参阅[API 文档](http://www.playframework.org/documentation/api/2.0.4/scala/index.html#play.api.GlobalSettings)

# moodle - 访问穆德尔的问题库

> ID：13095410
> 
> 赞同：3
> 
> 时间：2012-10-26T22:43:59.410
> 
> 标签：moodle

我正在创建一个在线学习平台，我们使用 Moodle 输入和存储问题。我需要创建一个包装器，使用它可以从我的应用程序访问 Moodle 的问题库。最好的方法是什么：插件或网络服务？已经有这样的事情了吗？

Moodle 中已经有导出功能，但我不想一次性导出所有问题。而是通过 ID 或其他参数获取问题。任何指针都会非常有帮助。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T08:58:47.040

使用问卷模块， [http://docs.moodle.org/23/en/Questionnaire_module](http://docs.moodle.org/23/en/Questionnaire_module)

# asp.net - 会话锁和 response.flush

> ID：13095411
> 
> 赞同：0
> 
> 时间：2012-10-26T22:44:05.620
> 
> 标签：asp.net

Response.Flush 对应用程序的会话状态有任何影响吗？例如，如果响应被刷新，那么会话锁可以被移除吗？

正如我在此处的问题中所述，我遇到了似乎是偶尔的会话冲突：[ASP.NET - Accessing web page two from client](https://stackoverflow.com/questions/12980123/asp-net-accessing-web-page-twice-from-client)。会话冲突似乎发生在网页上，该网页会定期刷新响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:48:39.937

假设我理解你的问题。

不，它对会话状态没有影响。`Response.Flush`立即将输出发送给客户端。它与会话状态无关。

> MSDN Response.Flush 方法 - Flush 方法立即发送缓冲输出。

*   [MSDN - Response.Flush 方法](http://msdn.microsoft.com/en-us/library/ms525560%28v=vs.90%29.aspx)

# javascript - 运行此代码时，Javascript 正在冻结浏览器

> ID：13095413
> 
> 赞同：0
> 
> 时间：2012-10-26T22:44:10.687
> 
> 标签：javascript, hyperlink

我正在尝试获取文本输入的值并检查其中是否有任何链接，然后获取这些链接并将它们制作成标签。但是当我运行这段代码时，出现了问题，它完全冻结了页面。基本上，我希望它检查“http://”，如果存在，继续添加 substr 长度，直到字符串/链接结束。有一个更好的方法吗？

```
// the id "post" could possibly say: "Hey, check this out! http://facebook.com"
// I'd like it to just get that link and that's all I need help with, just to get the      
// value of that entire string/link.
var x = document.getElementById("post");
var m = x.value.indexOf("http://");
var a = 0;
var q = m;

if (m != -1) {
    while (x.value.substr(q, 1) != " ") {
        var h = x.value.substr(m, a);
        q++;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:46:45.443

当然是——有一个无限循环。

您可能想`q`在每次迭代中更新变量。

```
q = q + a; 
```

要不就`q += a;`

**更新：**

我看到你改变了一点代码。

我明白你想要做什么。您正在尝试从输入值中获取 URL。

你为什么不直接使用一个简单`RegExp`的而不是这个不清楚的循环呢？

```
var match = x.value.match(/(?:^|\s)(http:\/\/\S+)/i);
var url = match ? match[1] : null; 
```

# django - Django：基于相关 OneToOne 对象的多种形式

> ID：13095414
> 
> 赞同：0
> 
> 时间：2012-10-26T22:44:23.437
> 
> 标签：django, forms, view, one-to-one

我有两个模型：

```
class Question (models.Model):
    question = models.CharField(max_length=100)
    hobby = models.ForeignKey(Hobby)

    def __unicode__(self):
        return self.question

class Answer (models.Model):
    answer = models.CharField(max_length=1000)
    attach_file = models.FileField(upload_to='Attachments', blank=True)
    question = models.OneToOneField(Question)

    def __unicode__(self):
        return self.answer 
```

我正在尝试构建一个页面（类似于 Django Admin 站点视图），列出带有 Answer 表单的 Question 对象。如：

问题 1 -- 答案 1：[文本框]，[可选附件]

问题 2 -- 答案 2：[文本框]，[可选附件]

* * *

问题 n -- 答案 n：[文本框]、[可选附件]

我首先考虑是否可以使用 formset 和查询，例如：

```
query=Answer.objects.filter("all answer objects that are related to all question objects related to "hobby1") 
```

但还没有弄清楚。

# c# - Request.Querystring 会自动对字符串进行 url 解码吗？

> ID：13095416
> 
> 赞同：24
> 
> 时间：2012-10-26T22:44:32.250
> 
> 标签：c#, asp.net, c#-4.0, url, url-rewriting

我正在处理一个页面，其中有一个类似的网址：
/directory/company/manufacturer

使用一些重写规则，这会被重写

使用 /directory/company/dunkin%26donuts/ 进行测试

一些制造商的名称中有一个＆符号。所以我想我可以用`%26`. 但是，当我调试代码并将鼠标悬停在`Request.QueryString`它上面时，它会显示给我`{qq=company&manf=dunkin&donuts&cond=}`并`Request.QueryString["manf"]`给我“dunkin”

如果我使用`%24`($) 而不是 & 符号，悬停在上面`Request.QueryString`会给我 `{qs=company&manf=dunkin%24donuts&cond=}`并`Request.QueryString["manf"]`给我 'dunkin$donuts'

我不明白这里的不同行为。为什么在您实际请求特定密钥之前，似乎与符号的 url 编码值已被解码，但另一个 url 编码字符（如美元符号）仅在您实际请求该特定密钥后才被解码？

这是最近的变化吗？我一直认为`Request.QueryString[key]`在没有先解码的情况下返回实际文本。还是与 url 重写有关？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-26T22:52:36.263

`UrlDecode()`当您通过键索引（即 ( ) 访问属性时，ASP.NET 会自动调用`Request.QueryString["key"]`。

如果要对其进行编码，只需执行以下操作：

`HttpUtility.UrlEncode(Request.QueryString["key"]);`

具体而言，就＆符号而言，这是一个特殊的大小写字符，因为它已被用作查询字符串分隔符。`&`由于这个原因，URL 编码和解码 & 符号应该总是给你。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-26T23:08:44.610

将 & 号替换为`%26`应该会导致该值被转义，因此`Request.QueryString["manf"]`yield 也会被转义`dunkin&donuts`。

[这个类似问题](https://stackoverflow.com/questions/561954/asp-net-urlencode-ampersand-for-use-in-query-string)的提问者最终意识到同一页面上的其他一些代码最终预解码了他的＆符号。有没有可能发生类似的事情？也许一些 javascript`%26`在将其发送到您的服务器之前将其解码为 & 符号。尝试使用 Firebug 或 Chrome 的开发者工具查看从浏览器发送的实际 URL 字符串。

## 更新

再次查看问题后，我意识到您可能正在使用 URL 重写器。[这篇文章](https://stackoverflow.com/questions/529857/ampersands-in-urlrewriter-query-strings)描述了一个类似的问题，我不确定是否有解决方案，但您可能想尝试使用`%2526`而不是`%26`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-20T10:31:23.787

我认为一个解决方案可能是将 UrlRewrite 规则修改为类似的东西。

```
 <rule name="TagPage" stopProcessing="true">
      <match url="^(tag)/([^/]+)/?$"/>
      <conditions logicalGrouping="MatchAll">
        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true"/>
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true"/>
      </conditions>
      <action type="Rewrite" url="ListByTags.aspx?tag={UrlEncode:{R:2}}"/>
    </rule> 
```

这里重要的一行是 {UrlEncode:{R:2}}。它为我解决了问题！

# express - 如何在 express 和 socket.io 中使用护照？

> ID：13095418
> 
> 赞同：55
> 
> 时间：2012-10-26T22:44:42.593
> 
> 标签：express, socket.io, connect, passport.js

我目前正在尝试为我的 node.js 应用程序设置一个基本的身份验证系统。现在我使用 express (3.0.0rc5)、passport (0.1.12) 和 socket.io (0.9.10) 以及 Mongoose 作为会话数据的存储。我也一直在玩，`everyauth`但我不喜欢使用承诺。

现在的情况：

通过护照（facebook 策略）的身份验证成功，`session.sid`重定向后在客户端上设置了一个 cookie，我能够在我的数据库中看到一个会话文档。我可以`socket.io`通过`socket.handshake.headers.cookie`.

如果我正确理解了护照的概念，成功后`authentication passport.serializeUser`会被调用，这使我能够将信息添加到会话中。就我而言，最重要的信息是电子邮件，因此我通过以下方式设置序列化程序：

```
passport.serializeUser(function(user, done) {
  done(null, user.email);
}); 
```

现在我必须只使用我的 socket.io 事件中的 cookie 信息来从会话中提取电子邮件地址。

```
var connect = require('connect'),
    parseSignedCookie = connect.utils.parseSignedCookie,
    cookie            = require('express/node_modules/cookie');

io.on('connection', function(socket) {
    if(socket.handshake.headers.cookie) {
        var cookie = cookie.parse(socket.handshake.headers.cookie);
        var sessionID = parseSignedCookie(cookie['connect.sid'], 'secret');
    }
});

passport.deserializeUser(function(id, done) {
    // so, what is supposed to be done here?
}); 
```

所以如果我没记错的话，现在的任务是`deserializeUser`用来访问相应的电子邮件地址。

我该怎么做？任何指针都受到高度赞赏。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2014-07-21T07:14:59.213

这是使用**Socket.IO 1.0 和 Express 4.0**的解决方案。这在精神上与帕特里克的回答相似。诀窍在于，由于 Socket.IO 1.0 有一个新的中间件 API，我们可以包装 Express 的中间件并将其放入 Socket.IO 管道中，而无需深入研究会话存储的低级实现。

```
// Set up the Session middleware using a MongoDB session store
expressSession = require("express-session");
var sessionMiddleware = expressSession({
    name: "COOKIE_NAME_HERE",
    secret: "COOKIE_SECRET_HERE",
    store: new (require("connect-mongo")(expressSession))({
        url: "mongodb://localhost/DATABASE_NAME_HERE"
    })
});

// Set up the Express server
var app = require("express")()
    .use(sessionMiddleware)
    .use(passport.initialize())
    .use(passport.session())
    // ... more middleware ...
    .listen(8000);

// Set up the Socket.IO server
var io = require("socket.io")(app)
    .use(function(socket, next){
        // Wrap the express middleware
        sessionMiddleware(socket.request, {}, next);
    })
    .on("connection", function(socket){
        var userId = socket.request.session.passport.user;
        console.log("Your User ID is", userId);
    }); 
```

变量**sessionMiddleware**是一个旨在直接适合 Express 管道的函数。它只需要三个参数：请求对象、响应对象和回调。

Socket.IO 的管道希望它的中间件只接受两个参数，但是：套接字对象（在*socket.request*中包含请求对象）和一个回调。幸运的是**sessionMiddleware**不需要响应对象从存储中读取会话，因此我们只需将一个空对象作为第二个参数传递给它。

请注意，下面的一些注释观察到此代码将会话呈现为只读。这是我们因Socket.IO没有适当的*响应对象而失去的功能。*

在上面的示例中，我使用了 MongoDB 会话存储（connect-mongo）。您可以使用任何适合您的会话存储。有关会话存储的列表，请参阅[Connect wiki](https://github.com/senchalabs/connect/wiki#session-stores)。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-10-27T09:10:06.880

我让它工作。我必须做的是访问 sessionStore。这是代码，以防其他人偶然发现这个特定问题：

```
// # app.js

var express     = require('express'),
    routes      = require('./routes'),
    http        = require('http'),
    path        = require('path'),
    app         = express(),
    passport    = require('passport'),
    SessionMongoose = require("session-mongoose"),
    mongooseSessionStore = new SessionMongoose({
        url: "mongodb://localhost/login",
        interval: 120000 
    });

var config       = require('game/config.js'), // holds my whole server configuration
    server       = require('game/lib/server.js');

// save sessionStore to config for later access
config.setSessionStore(mongooseSessionStore);

// configure express to use passport and mongooseSessionStore
app.configure(function(){
    app.set('port', config.port);
    app.set('env', config.environment);
    app.set('dbPrefix', config.dbPrefix);
    app.set('views', __dirname + '/views');
    app.set('view engine', 'jade');
    app.use(express.favicon());
    app.use(express.bodyParser());
    app.use(express.cookieParser());
    app.use(express.session({secret : 'totallysecret', store : mongooseSessionStore })),
    app.use(express.methodOverride());
    app.use(passport.initialize());
    app.use(passport.session());    
    app.use(app.router);
    app.use(express['static'](path.join(__dirname, 'public')));
});

app.get('/', routes.index);

app.get('/auth/facebook', passport.authenticate('facebook', { scope: 'email' }));
app.get('/auth/facebook/callback', 
    passport.authenticate('facebook', { successRedirect: '/',
                                        failureRedirect: '/' })); 

// #### Init httpserver
var httpServer = http.createServer(app);
httpServer.listen(app.get('port'));

// #### Server startup
server.init(httpServer); 
```

我的序列化函数看起来很简单，如下所示：

```
passport.serializeUser(function(user, done) {
    // saves user.email to session.passport.user
    done(null, user.email);
});

passport.deserializeUser(function(obj, done) {
    done(null, obj);
}); 
```

最后是 socket.io 的实现：

```
var util              = require('util'),
    connect           = require('connect'),
    parseSignedCookie = connect.utils.parseSignedCookie,
    cookie            = require('express/node_modules/cookie'),
    io                = require('socket.io').listen(httpServer);

var config = require('../config.js');  

io.configure(function () {
    io.set('authorization', function (data, callback) {
        if(data.headers.cookie) {
            // save parsedSessionId to handshakeData
            data.cookie = cookie.parse(data.headers.cookie);
            data.sessionId = parseSignedCookie(data.cookie['connect.sid'], 'totallysecret');
        }
        callback(null, true);
    });

    io.on('connection', function(socket) {
        // reference to my initialized sessionStore in app.js
        var sessionStore = config.sessionStore;
        var sessionId    = socket.handshake.sessionId;

        sessionStore.get(sessionId, function(err, session) {
            if( ! err) {
                if(session.passport.user) {
                    console.log('This is the users email address %s', session.passport.user);
            }
        });
    });
}); 
```

使用 session-mongoose 模块我可以访问：

```
sessionStore.get(sessionId, callback)
sessionStore.set(sessionId, data, callback) 
sessionStore.destroy(sessionId, callback) 
sessionStore.all(callback)    // returns all available sessions
sessionStore.clear(callback)  // deletes all session data
sessionStore.length(callback) // returns number of sessions in the 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-29T04:29:50.983

您可以使用[express-socket.io-session](https://www.npmjs.com/package/express-socket.io-session)。您可以使用`socket.handshake.session.passport.user`. 它支持对会话存储的读取和写入。

**注意：适用于 express > 4.0.0 和 socket.io > 1.0.0，并且不会向后兼容**

# c# - 如何将包含作为数组的成员变量的对象转换为对象数组？

> ID：13095425
> 
> 赞同：1
> 
> 时间：2012-10-26T22:45:53.217
> 
> 标签：c#, arrays, object

我想转换这个：

```
class ObjectWithArray
{
    int iSomeValue;
    SubObject[] arrSubs;
}

ObjectWithArray objWithArr; 
```

对此：

```
class ObjectWithoutArray
{
    int iSomeValue;
    SubObject sub;
}

ObjectWithoutArray[] objNoArr; 
```

其中每个 objNoArr 将具有与 objWithArr 相同的 iSomeValue，但在 objWithArr.arrSubs 中只有一个 SubObject；

想到的第一个想法是简单地循环遍历 objWithArr.arrSubs 并使用当前的 SubObject 创建一个新的 ObjectWithoutArray 并将该新对象添加到一个数组中。但是，我想知道现有框架中是否有任何功能可以做到这一点？

* * *

此外，如何简单地将 ObjectWithArray objWithArr 分解为 ObjectWithArray[] arrObjWithArr，其中每个 arrObjectWithArr.arrSubs 将仅包含原始 objWithArr 中的一个子对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:06:46.167

这样的事情可能会奏效。

```
class ObjectWithArray
{
    int iSomeValue;
    SubObject[] arrSubs;

    ObjectWithArray(){} //whatever you do for constructor

    public ObjectWithoutArray[] toNoArray(){
        ObjectWithoutArray[] retVal = new ObjectWithoutArray[arrSubs.length];

        for(int i = 0; i < arrSubs.length;  i++){
          retVal[i] = new ObjectWithoutArray(this.iSomeValue, arrSubs[i]);
        }

       return retVal;
    }
}

class ObjectWithoutArray
{
    int iSomeValue;
    SubObject sub;

    public ObjectWithoutArray(int iSomeValue, SubObject sub){
       this.iSomeValue = iSomeValue;
       this.sub = sub;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T00:18:37.653

您可以使用 Linq 轻松完成：

```
class ObjectWithArray
{
    int iSomeValue;
    SubObject[] arrSubs;

    ObjectWithArray() { } //whatever you do for constructor

    public ObjectWithoutArray[] toNoArray()
    {
        ObjectWithoutArray[] retVal = arrSubs.Select(sub => new ObjectWithoutArray(iSomeValue, sub)).ToArray();
        return retVal;
    }
} 
```

# oracle - 只能以 sysdba 身份登录 Oracle

> ID：13095427
> 
> 赞同：1
> 
> 时间：2012-10-26T22:46:09.223
> 
> 标签：oracle

我刚刚在 Redhat 5 上安装了 11g2。我使用 sqlplus 登录如下：

```
$sqlplus sys/abcabc as sysdba 
```

我创建了一个用户如下：

```
sqlplus> create user "xyz" 
           profile "DEFAULT" 
           identified by "abcabc" 
           default tablespace "MYTAB" 
           temporary tablespace "TEMP" 
           account unlock;

sqlplus> grant dba to "xyz"

sqlplus> commit 
```

sqlplus 报告用户已创建并已授予 dba。sqlplus 没有报告任何错误。

现在，当我尝试按如下方式登录时：

```
$sqlplus xyz/abcabc 
```

我再次收到登录提示，重试 3 次后，我被踢出局。

但是，如果我按如下方式登录：

```
$sqlplus xyz/abcabc as sysdba 
```

我登录了。

可能是什么问题呢？我之前多次遵循完全相同的程序来创建用户，并且它总是有效的。这次我需要以 sysdba 身份登录有什么不同？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:23:15.850

您确定要创建区分大小写的用户名吗？那将是非常**非常**不寻常的。

当您[使用双引号将 Oracle 标识符括起来](https://stackoverflow.com/questions/563090/oracle-what-exactly-do-quotation-marks-around-the-table-name-do/563126#563126)时，您是在要求 Oracle 将其视为区分大小写的标识符。所以当你

```
create user "xyz" 
```

您要求输入区分大小写的用户名。许多工具在传递区分大小写的标识符时不会遇到问题，您必须担心在您的 shell 中正确转义双引号。

最有可能的是，您真的不想要区分大小写的标识符。您只想使用标准的不区分大小写的标识符

```
 create user xyz
     profile "DEFAULT" 
     identified by "abcabc" 
     default tablespace "MYTAB" 
     temporary tablespace "TEMP" 
     account unlock; 
```

我希望从表空间名称和配置文件名称中删除双引号，但这不会导致您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T06:40:27.650

> 但是，如果我按如下方式登录：
> 
> ```
> $sqlplus xyz/abcabc as sysdba 
> ```
> 
> 我登录了。

您还可以像这样登录：

```
$sqlplus / as sysdba 
```

这是因为`/ as sysdba`Oracle 依赖于操作系统身份验证的原因。如果您的操作系统用户是`dba`组的一部分（在 Unix 上）或具有管理员权限（在 Windows 上），那么您就在其中。

但是无论您是否指定了用户，您都是 SYS。这很危险，因为 SYS 是数据字典的所有者，因此如果您不知道自己在做什么，很容易彻底破坏数据库。

# java - 可以在 backingbean 中设置 HtmlDataTable 列宽

> ID：13095429
> 
> 赞同：1
> 
> 时间：2012-10-26T22:46:43.293
> 
> 标签：java, jsf, htmldatatable

正如标题所暗示的，我正在寻找一种在我的支持 bean 中设置列​​宽的方法。jsp 上有一个面板，对几个屏幕是通用的；根据用户当前正在查看的屏幕加载其内容。对于这个特定的屏幕，我在后台 bean 中创建了一个 HtmlDataTable，然后将其添加到面板中。

我需要为特定列更改其宽度。我可以将列作为 UIColumn 访问，但 UIColumn 没有宽度属性。也许使用 ColumnClasses 的东西，但搜索谷歌没有发现任何线索。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:22:27.600

既然你提到了列类，我发布了这个。我不知道这是否能解决你的问题。如果不是，请澄清一点。1.你应该有这样的样式类。

> `<style>`
> .first{
>        背景颜色：绿色；
>        宽度：100 像素；
>   }
> .second{
>        背景颜色：黄色；
>        宽度：200px；
>  }
> `</style>`

您的表格将如下所示

> `<h:dataTable value="" binding="#{myBean.table}">`
>       `<rich:column>First Column</rich:column>`
>       `<rich:column>Second Column</rich:column>`
> `</h:dataTable>`

你的 bean 包含一些这样的东西。

> HtmlDataTable 表 = 新 HtmlDataTable();
> 
> 公共 HtmlDataTable getTable() {
>       table.setStyle("border:solid");
>       table.setColumnClasses("第一，第二");
>       返回表；
> }
> public void setTable(HtmlDataTable table) {
>       this.table = table;
> }

# php - phpseclib - 长命令超时和 $ssh->write(); 不工作

> ID：13095434
> 
> 赞同：1
> 
> 时间：2012-10-26T22:47:08.317
> 
> 标签：php, windows, ssh, phpseclib

我正在使用 Cygwin 向 Windows 服务器发送命令。几天前我问了一个问题，但仍然没有答案。我对 phpseclib 有一个大问题，它是 $ssh->write(); 命令。我用过 $ssh->exec(); 但是发送到服务器的命令正在下载游戏服务器文件，这可能需要长达 20 分钟，一段时间后 php 页面超时，因为它超过了 FastCGI 超时设置。所以，我认为 $ssh->write(); 可以为我解决它，但我发送到服务器的命令没有得到执行。这是 exec 的命令和我尝试使用的 write：

```
$ssh->exec('C:/hldsupdatetool/hldsupdatetool -command update -game ".$game." -dir ".$dir'); 
```

并且此代码永远加载然后超时。我已经通过将 FastCGI 的超时设置更改为一小时来解决这个问题，这是最大值。此命令确实在服务器上执行。

这是我试图发送但不执行的写命令：

```
$ssh->write('C:/hldsupdatetool/hldsupdatetool -command update -game ".$game." -dir ".$dir."\r\n"); 
```

此命令不会在服务器上执行。回显它时我得到的响应是“1”。

非常感谢任何帮助！目前正在制作一个开源游戏服务器控制面板。

提前致谢！

最好的问候，汤姆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T04:15:12.130

要读取 $ssh->write() 的响应，您需要执行 $ssh->read()。例如。

[http://phpseclib.sourceforge.net/ssh/examples.html#interactive](http://phpseclib.sourceforge.net/ssh/examples.html#interactive)

$ssh->write() 正在输出 1，因为 $ssh->write() 正在返回 true。

无论如何，您可以尝试... $ssh->setTimeout(5) 或其他什么。

不知道是否可以将Windows命令发送到后台？在 Linux 中，有 nohup 和 &。

# c++ - odeint：复杂且精度更高的类型

> ID：13095441
> 
> 赞同：2
> 
> 时间：2012-10-26T22:48:25.290
> 
> 标签：c++, precision, gsl, floating-point-precision

任何人都可以为我提供一些帮助，帮助我创建一个使用复数向量的 c++ odeint 求解器的最小示例，如果可能的话，精度更高（boost.multiprecision 或 libquadmath __float128 ， __complex128 说）。

文档中有一个使用复杂标量的示例[http://headmyshoulder.github.com/odeint-v2/doc/boost_numeric_odeint/tutorial/special_topics.html](http://headmyshoulder.github.com/odeint-v2/doc/boost_numeric_odeint/tutorial/special_topics.html)

它在那里提到：

```
The fact that we have to configure a different algebra is solely due to the fact 
that we use a non-vector state type and not to the usage of complex values.
So for, e.g. vector<  complex<double> >, this would not be required. 
```

我试图通过以下更改来修改它`typedef vector<complex<double>> state_type`：

```
#include <iostream>
#include <complex>
#include <boost/array.hpp>

#include <boost/numeric/odeint.hpp>

using namespace std;
using namespace boost::numeric::odeint;

typedef vector<complex< double >> state_type;

struct stuart_landau
{
double m_eta;
double m_alpha;

stuart_landau( double eta = 1.0 , double alpha = 1.0 )
: m_eta( eta ) , m_alpha( alpha ) { }

void operator()( const state_type &x , state_type &dxdt , double t ) const
{
    const complex<double> I(0.0,1.0);
    dxdt[0] = x[1];
    dxdt[1] = (1.0+m_eta*I)*x[0]-(1.0+m_alpha*I)*x[1];
}
};

 struct streaming_observer
{
std::ostream& m_out;

streaming_observer( std::ostream &out ) : m_out( out ) { }

template< class State >
void operator()( const State &x , double t ) const
{
    m_out << t;
    m_out << "\t" << x[0].real() << "\t" << x[0].imag() ;
    m_out << "\n";*/
}
};

int main( int argc , char **argv )
{
//[ stuart_landau_integration
state_type x(2);
 x[0] = complex< double >( 1.0 , 0.0 );
 x[1] = complex< double >( 1.0 , 0.0 );

const double dt = 0.1;

typedef runge_kutta4< state_type , double , state_type , double ,
                      vector_space_algebra > stepper_type;

integrate_const( stepper_type() , stuart_landau( 2.0 , 1.0 ) , x , 0.0 , 10.0 , dt , streaming_observer( cout ) );
//]

return 0; 
```

}

但是，这会产生大量错误。

谁能给我一个复杂 ODE 的最小工作示例？甚至更好地实现高精度数据类型..看起来 odeint 可以支持相当任意的状态类型，但我在让它们工作时遇到了很多麻烦。

**更新代码**

```
#include <iostream>
#include <complex>
#include <boost/array.hpp>
#include <stdlib.h>
#include <math.h>

#include <boost/numeric/odeint.hpp>

extern "C" {
#include <quadmath.h>
}

using namespace std;
using namespace boost::numeric::odeint;

//[ stuart_landau_system_function
typedef std::vector<std::complex < __float128 > > state_type;

struct stuart_landau
{
__float128 m_eta;
__float128 m_alpha;

stuart_landau( __float128 eta = 1.0L , __float128 alpha = 1.0L )
: m_eta( eta ) , m_alpha( alpha ) { }

void operator()( const state_type &x , state_type &dxdt , double t ) const
{
    const complex< __float128 > I( 0.0 , 1.0 ); //define complex I     

    dxdt[0] = x[1];
    dxdt[1] = ( 1.0 + m_eta * I ) * x[0] - ( 1.0 + m_alpha * I )*x[1];
}
};
//]

struct streaming_observer
{
 std::ostream& m_out;

streaming_observer( std::ostream &out ) : m_out( out ) { }

template < class State >
void operator()( const State &x , double t ) const
{
    m_out << t;
  /*  m_out << "\t" << x[0].real() << "\t" << x[0].imag() ;
    m_out << "\n";*/
 }
};

int main( int argc , char **argv )
{
//[ stuart_landau_integration
state_type x(2);
 x[0] = complex< __float128 >( 1.0L , 0.0L );
 x[1] = complex< __float128 >( 1.0L , 0.0L );

const double dt = 0.1;

typedef runge_kutta4< state_type, __float128 > stepper_type;

integrate_const( stepper_type() , stuart_landau( 2.0L , 1.0L ) , x , 0.0 , 10.0 , dt    
 /*, streaming_observer( cout ) */);
 //]

 return 0;
 } 
```

**错误登录编译：**

```
vecPrec.cpp: In member function ‘void stuart_landau::operator()(const state_type&,    
state_type&, double) const’:
 vecPrec.cpp:33:35: error: no match for ‘operator+’ in ‘1.0e+0 + std::operator* [with 
 _Tp = __float128]((* &((const stuart_landau*)this)->stuart_landau::m_eta), (* & I))’
 vecPrec.cpp:33:35: note: candidates are:
 /usr/include/c++/4.6/bits/stl_iterator.h:327:5: note: template<class _Iterator>    std::reverse_iterator<_Iterator> std::operator+(typename 

 std::reverse_iterator<_Iterator>::difference_type, const   std::reverse_iterator<_Iterator>&)
 /usr/include/c++/4.6/bits/basic_string.h:2306:5: note: template<class _CharT, class  _Traits, class _Alloc> std::basic_string<_CharT, _Traits, _Alloc> std::operator+(const    std::basic_string<_CharT, _Traits, _Alloc>&, const std::basic_string<_CharT, _Traits,   _Alloc>&)
 /usr/include/c++/4.6/bits/basic_string.tcc:694:5: note: template<class _CharT, class  _Traits, class _Alloc> std::basic_string<_CharT, _Traits, _Alloc> std::operator+(const   _CharT*, const std::basic_string<_CharT, _Traits, _Alloc>&)
  /usr/include/c++/4.6/bits/basic_string.tcc:710:5: note: template<class _CharT, class _Traits, class _Alloc> std::basic_string<_CharT, _Traits, _Alloc> std::operator+(_CharT,     const std::basic_string<_CharT, _Traits, _Alloc>&)
  /usr/include/c++/4.6/bits/basic_string.h:2343:5: note: template<class _CharT, class  _Traits, class _Alloc> std::basic_string<_CharT, _Traits, _Alloc> std::operator+(const   std::basic_string<_CharT, _Traits, _Alloc>&, const _CharT*)
 /usr/include/c++/4.6/bits/basic_string.h:2359:5: note: template<class _CharT, class   _Traits, class _Alloc> std::basic_string<_CharT, _Traits, _Alloc> std::operator+(const   std::basic_string<_CharT, _Traits, _Alloc>&, _CharT)
  /usr/include/c++/4.6/complex:321:5: note: template<class _Tp> std::complex<_Tp>  std::operator+(const std::complex<_Tp>&, const std::complex<_Tp>&)
   /usr/include/c++/4.6/complex:330:5: note: template<class _Tp> std::complex<_Tp>  std::operator+(const std::complex<_Tp>&, const _Tp&)
    /usr/include/c++/4.6/complex:339:5: note: template<class _Tp> std::complex<_Tp>  std::operator+(const _Tp&, const std::complex<_Tp>&)
   /usr/include/c++/4.6/complex:440:5: note: template<class _Tp> std::complex<_Tp>  std::operator+(const std::complex<_Tp>&)
   /usr/include/c++/4.6/bits/stl_bvector.h:266:3: note: std::_Bit_iterator   std::operator+(std::ptrdiff_t, const std::_Bit_iterator&)
   /usr/include/c++/4.6/bits/stl_bvector.h:266:3: note:   no known conversion for argument 2 from ‘std::complex<__float128>’ to ‘const std::_Bit_iterator&’
    /usr/include/c++/4.6/bits/stl_bvector.h:352:3: note: std::_Bit_const_iterator std::operator+(std::ptrdiff_t, const std::_Bit_const_iterator&)
   /usr/include/c++/4.6/bits/stl_bvector.h:352:3: note:   no known conversion for   argument 2 from ‘std::complex<__float128>’ to ‘const std::_Bit_const_iterator&’
   vecPrec.cpp:33:66: error: no match for ‘operator+’ in ‘1.0e+0 + std::operator*  [with _Tp = __float128]((* &((const stuart_landau*)this)->stuart_landau::m_alpha), (* &   I))’
  vecPrec.cpp:33:66: note: candidates are:
   /usr/include/c++/4.6/bits/stl_iterator.h:327:5: note: template<class _Iterator>   std::reverse_iterator<_Iterator> std::operator+(typename    std::reverse_iterator<_Iterator>::difference_type, const std::reverse_iterator<_Iterator>&)
   /usr/include/c++/4.6/bits/basic_string.h:2306:5: note: template<class _CharT, class     _Traits, class _Alloc> std::basic_string<_CharT, _Traits, _Alloc> std::operator+   (const std::basic_string<_CharT, _Traits, _Alloc>&, const   std::basic_string<_CharT, _Traits, _Alloc>&)
  /usr/include/c++/4.6/bits/basic_string.tcc:694:5: note: template<class _CharT, class   _Traits, class _Alloc> std::basic_string<_CharT, _Traits, _Alloc> std::operator+  (const _CharT*, const std::basic_string<_CharT, _Traits, _Alloc>&)
   /usr/include/c++/4.6/bits/basic_string.tcc:710:5: note: template<class _CharT, class _Traits, class _Alloc> std::basic_string<_CharT, _Traits, _Alloc> std::operator+   (_CharT, const std::basic_string<_CharT, _Traits, _Alloc>&)
    /usr/include/c++/4.6/bits/basic_string.h:2343:5: note: template<class _CharT, class _Traits, class _Alloc> std::basic_string<_CharT, _Traits, _Alloc> std::operator+(const std::basic_string<_CharT, _Traits, _Alloc>&, const _CharT*)
   /usr/include/c++/4.6/bits/basic_string.h:2359:5: note: template<class _CharT, class _Traits, class _Alloc> std::basic_string<_CharT, _Traits, _Alloc> std::operator+(const std::basic_string<_CharT, _Traits, _Alloc>&, _CharT)
   /usr/include/c++/4.6/complex:321:5: note: template<class _Tp> std::complex<_Tp> std::operator+(const std::complex<_Tp>&, const std::complex<_Tp>&)
    /usr/include/c++/4.6/complex:330:5: note: template<class _Tp> std::complex<_Tp> std::operator+(const std::complex<_Tp>&, const _Tp&)
   /usr/include/c++/4.6/complex:339:5: note: template<class _Tp> std::complex<_Tp> std::operator+(const _Tp&, const std::complex<_Tp>&)
   /usr/include/c++/4.6/complex:440:5: note: template<class _Tp> std::complex<_Tp> std::operator+(const std::complex<_Tp>&)
   /usr/include/c++/4.6/bits/stl_bvector.h:266:3: note: std::_Bit_iterator std::operator+(std::ptrdiff_t, const std::_Bit_iterator&)
   /usr/include/c++/4.6/bits/stl_bvector.h:266:3: note:   no known conversion for argument 2 from ‘std::complex<__float128>’ to ‘const std::_Bit_iterator&’
   /usr/include/c++/4.6/bits/stl_bvector.h:352:3: note: std::_Bit_const_iterator std::operator+(std::ptrdiff_t, const std::_Bit_const_iterator&)
   /usr/include/c++/4.6/bits/stl_bvector.h:352:3: note:   no known conversion for argument 2 from ‘std::complex<__float128>’ to ‘const std::_Bit_const_iterator&’ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T11:37:42.343

为了使上面的示例正常工作，您需要使用`range_algebra`. 您正在使用`vector_space_algebra`which 期望或多或少地为`state_type`所有运算符 +*-/ 定义。情况并非如此`std::vector<>`。只需使用

```
typedef runge_kutta4< state_type > stepper_type; 
```

此 typedef 静默使用`range_algebra`.

对于另一种情况，请尝试

```
typedef vector< complex< __float128 > > state_type;
typedef runge_kutta4< state_type , __float128 > stepper_type; 
```

上述两行工作的前提是 __float128 的操作符-*/+ 已经定义。

# symfony - 如何让 Symfony 2 与学说 ORM 只保留一次相关实体

> ID：13095442
> 
> 赞同：3
> 
> 时间：2012-10-26T22:48:24.710
> 
> 标签：symfony, doctrine, one-to-many

我有一个与“城市”实体具有多对一关系的“人”实体：

这是人的关系映射：

```
/**
* @ORM\ManyToOne(targetEntity="City", inversedBy="persons", cascade={"persist"})
*/
private $city; 
```

和城市的：

```
/**
* @ORM\OneToMany(targetEntity="Person", mappedBy="city")
*/
private $persons; 
```

我使用由教义生成的基本 Symfony 2 'person' 控制器：generate:crud：

```
$entity  = new Person();
$form = $this->createForm(new PersonType(), $entity);
$form->bind($request);

if ($form->isValid()) {

        $em = $this->getDoctrine()->getManager();
        $em->persist($entity);
        $em->flush();
} 
```

PersonType 表单类型实例化了一个 CityType

```
class PersonType extends AbstractType
{
public function buildForm(FormBuilderInterface $builder, array $options)
{
        $builder
        ->add('city', new CityType())
        ->add('firstname')
        ->add('lastname')
        ->add('gender')
        ... 
```

CityType 表单类型有一个文本字段

```
class CityType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
        ->add('cityname', 'text');
     }
} 
```

当我提交表单时，会创建 Person 实体以及 City 实体，这要归功于 cascade={"persist"}。

当我用数据库中已经存在的城市名称填写表格时，问题出现了，Doctrine 创建了另一个具有相同城市名称的条目。

Doctrine 是否有一种简单的方法可以检测到这一点，并使用 Person 表中现有的 city_id ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T04:04:26.840

一种解决方案是，不要级联持久化实体。IE

```
 if ($form->isValid()) {
        $data = $form->getData();
        $em = $this->getDoctrine()->getEntityManager();

        $city = $em->getRepository('YourBundle:City')
                   ->findOneByCityname($data['cityname']);

        if($city == null){
            $city = new City();
            $city->setName($data['cityname']);
            $em->persist($city);
            $em->flush();
        }

        $entity->setCity($city);
        $em->persist($entity);
        $em->flush();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-27T17:57:22.113

正如@vadim 所说，您必须使用datatransformer。一开始可能会令人困惑，但大约 30 分钟后你就会学会它。请记住，在世界各地，您将拥有许多同名的城市。

最好的解决方案是这样；在该文本字段中，用户将键入一个名称，如`Belgrade, Montana, Usa`（顺便说一句；贝尔格莱德是塞尔维亚的首都，只是给你一个同名城市的例子）。Datatransformer 将读取 DB 并找到您可以链接的正确的贝尔格莱德城市。

完成此操作后（非常简单），您可以为该字段构建自动完成功能。@artworkad 的建议过于复杂，以后会带来更多的问题。

# ruby-on-rails - 我在哪里可以将 Swagger-UI 放在带有 Grape 的 Rails 应用程序中？

> ID：13095449
> 
> 赞同：3
> 
> 时间：2012-10-26T22:48:55.610
> 
> 标签：ruby-on-rails, json, api, swagger, grape-api

我正在重写（是的，我知道！）一个主要由 API 驱动的 Rails 应用程序，使用 Intridea 的 Grape 和grape-swagger gem 来启用 Swagger UI 进行文档。

所以我有一个简单的 hello world 应用程序正在运行。似乎可以从 swagger 测试中发现，尽管它目前正在给出 JSON 解析错误（我将在接下来研究）。我想将 swagger UI 放入 Rails 应用程序中，指向 /swagger_doc.json，以便在构建时确保文档在旁边正确构建。

我将 Swagger UI 放在 rails 应用程序的什么位置？公共目录？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T23:16:38.273

好的，所以我发现了一些混乱，当我之前尝试将其全部放在公共目录中时，它们什么也没显示。

```
myapp/public/swagger-ui-1.1.1/files 
```

1）我不知道这是否应该有所作为，但我在 config.ru 中加载 rails 应用程序和葡萄应用程序的顺序似乎对路由的处理方式产生了影响......我需要了解更多这是如何工作的。但是现在路线中安装的葡萄应用程序可以满足我的期望。结果，将 swagger-ui 解压缩到公共然后就可以了

```
http://appurl/swagger-ui-1.1.1/ 
```

给了我招摇的用户界面。如果有更多细节，我会添加更多细节。

编辑：因为会有像我这样需要帮助的其他用户，我将在下面概述。这很容易：

在资产管道中创建 /swagger 子目录 - 我是在供应商下完成的。将 lib 文件从 swagger UI 复制到这些子目录。创建一个带有索引操作的基本 docs_controller（可以为空）。创建一个 views/docs 目录并将 swagger-ui index.html 复制到其中。将样式表和 javascript 调用更改为 index.html 中的资产标签。为文档添加资源路由。将调用 window.swaggerUI 的 javascript 函数中的 discoveryURL 更改为“http://my.root.url/swagger_doc.json”（最好来自 ENV 变量）。

而已。它现在可以正常工作了。当 Swagger 在 docs 子域上运行时，我遇到的一个问题是，在 api 子域下使用我的 Grape API 是 CORS。通过添加以下内容可以轻松地在 Grape 中修复：

```
before do
  header "Access-Control-Allow-Origin", "http://#{ENV["BASE_URL"]}"
  header "Access-Control-Allow-Methods", "POST, GET, OPTIONS, PUT"
  header "Access-Control-Max-Age", "1728000"
end 
```

到你的葡萄 api.rb。希望一切都对某人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-22T08:26:36.583

如果你看看这个宝石会很容易，[https://github.com/BrandyMint/grape-swagger-rails](https://github.com/BrandyMint/grape-swagger-rails)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-31T08:47:17.160

我们必须将所有 Swagger UI 放在 rails 应用程序的公共目录中。并将其与以下版本一起使用。

gem '葡萄', '~> 0.7.0' gem 'grape-swagger', '~> 0.7.2'

因为 'grape-swagger' gem 不支持最新版本。

# php - MongoDB在PHP中增加多个文档数组值

> ID：13095451
> 
> 赞同：0
> 
> 时间：2012-10-26T22:48:58.437
> 
> 标签：php, mongodb

我想增加包含给定嵌套数组值的集合中的所有文档。我的每个对象都包含一个带有 key:number 值的“order”数组。

```
{
    _id: ...,
    order : array(
        foo: 34
    )
} 
```

[但是，我无法使用 PHP MongoDB Native Driver](http://us3.php.net/manual/en/book.mongo.php)找出正确的 MongoDB 查询。

```
 // Update all existing items with an order greater than this number
    $number = 2;

    $result = $collection->update(
        array("order" => array('foo' => array('$gt' => $number))),
        array('$inc' => array('order' => array('foo' => 1))),
        array("safe" => true)
    ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T07:58:20.737

这是您的 MongoDB 查询的 PHP 版本，我另外添加了多个选项。

```
$collection->update(array('order.foo'=>array('$gt'=>2)), array('$inc' => array('order.foo'=>1)), array('multiple'=>true, 'safe'=>true)); 
```

# jquery - 颜色框和 jQuery

> ID：13095452
> 
> 赞同：1
> 
> 时间：2012-10-26T22:49:10.780
> 
> 标签：jquery, colorbox

所以，我不是 Jquery 的新手，但我是 Colorbox 的新手，我需要帮助。我一直在寻找一个 JQuery，它可以让我的图像在单击图像缩略图时像幻灯片一样播放（如 Jquery 灯箱，但带有幻灯片），我被告知要试用颜色框。它符合我的需要，但我'。得到一些..奇怪的结果。到目前为止，所有需要的文件都安装好了（我从[http://www.jacklmoore.com/colorbox下载了软件](http://www.jacklmoore.com/colorbox)并且目前已安装或至少尝试安装“示例 4”。所有文件和图像都已就位并已安装。但是，当我单击缩略图时，会显示颜色框，但没有图像，并且此特定 jquery 附带的边框/角等都被打乱了，我正在 Mozilla 中查看测试页面。我尝试发布代码..但这件事让我很难过。希望有人知道我在说什么。

感谢您的帮助，并为冗长的说明感到抱歉..只是希望尽快解决这个问题..这让我头疼。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T02:09:37.387

好吧，我想你可能想花一些时间在它的[初学者指南](http://www.jacklmoore.com/colorbox/guide)页面上，并尝试更好地理解 colorbox 插件。以下是指南页面中的示例代码。

```
<!doctype html>
<html>
    <head>
        <link rel="stylesheet" href="colorbox.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="jquery.colorbox-min.js"></script>
        <script>
            jQuery(document).ready(function () {
                jQuery('a.gallery').colorbox({ opacity:0.5 , rel:'group1' });
            });
        </script>
    </head>
    <body>
        <a class='gallery' href='image1.jpg'>Photo_1</a>
        <a class='gallery' href='image2.jpg'>Photo_2</a>
        <a class='gallery' href='image3.jpg'>Photo_3</a>
    </body>
</html> 
```

这可能是您开始时所需的全部内容，然后您可以随时修改它，例如向颜色框添加更多选项、更改 HTML 等。您可能需要更多地关注外部资源的 URL（放置 css &本例中根目录下的colorbox-min.js）

另外，既然您使用的是Firefox，为什么不安装[Firebug Add-on](https://addons.mozilla.org/en-US/firefox/addon/firebug/)进行调试。如果您看到任何错误，您可以在此处发布错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:22:47.077

我有同样的问题。原来我从旧网站复制了一些代码，所以我仍在加载 jQuery 1.4.2

最新版本的颜色框​​不适用于低于 1.4.3 的 Jquery 版本（请参阅[https://groups.google.com/forum/?fromgroups#!topic/colorbox/yFLOgvP20NI](https://groups.google.com/forum/?fromgroups#!topic/colorbox/yFLOgvP20NI)）

在我更新了我的 jQuery 库之后，一切看起来都很好了。

# asp.net - 无法从 DropDownList 中获取 SelectedValue

> ID：13095455
> 
> 赞同：0
> 
> 时间：2012-10-26T22:49:22.407
> 
> 标签：asp.net, asp.net-ajax

我在 ASP.Net AJAX 更新面板中有两个下拉列表。当用户从第一个下拉列表中选择一个值时，一个下拉列表通过回发填充第二个，这一切都很好。但是，我遇到的问题是我无法从第二个下拉列表中获取 selectedvalue，我的意思是它总是选择第一项而不是实际选择的值。

我已经研究过在页面加载时将填充第二个下拉列表移动到 If Not IsPostBack Then ，但是当 AJAX 更新面板执行部分回发时，这会停止填充该下拉列表。

那么，有远离这个吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:09:45.027

如果要根据第一个下拉列表中选择的值更改第二个下拉列表的值，则应使用第一个下拉列表的 SelectedIndexChanged 事件来设置该值。

您的代码（来自评论）：

在 Page_Load 我有以下

```
If (IsPostBack)
{ 
    ddlSite.Datasource = GetSites();
    ddlSite.Databind();
    ddlPlant.DataSource() = GetPlant(ddlSite.SelectedValue);
    ddlPlant.Databind();
} 
```

在页面加载时 ddlSite.SelectedValue 始终为零。

您需要在 ddlSite_SelectedIndexChanged 事件中绑定第二个下拉菜单。

[页面生命周期问题已回答](https://stackoverflow.com/questions/597042/what-is-the-page-lifecycle-of-an-asp-net-webform)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T00:56:39.337

这是一个示例，如果它可以帮助您..它与数据源的级联下拉列表。 [http://www.aspdotnet-suresh.com/2011/01/introduction-here-i-will-explain-how-to.html](http://www.aspdotnet-suresh.com/2011/01/introduction-here-i-will-explain-how-to.html)

# java - 初始化时jpa一对多sql错误

> ID：13095460
> 
> 赞同：1
> 
> 时间：2012-10-26T22:50:18.060
> 
> 标签：java, spring, jpa, jpql

在我的 java spring webapp 中，我有关系：一个帐户可以有多个组，一个组只能有一个帐户。

集团实体：

```
@Entity
@Table(name = "group")
@Inheritance(strategy = InheritanceType.JOINED)
public class Group {

@Id
@GeneratedValue(generator = "group_id", strategy = GenerationType.SEQUENCE)
@SequenceGenerator(name = "group_id", sequenceName = "group_group_id_seq", allocationSize = 1)
@Column(name = "group_id")
private Long id;

@Basic
@NotBlank
@Column(name = "name")
private String name;

@ManyToOne(targetEntity = Account.class, fetch = FetchType.LAZY)
@JoinColumn(name = "account_id")
private Account account;

@Basic
@NotBlank
@Column(name = "all")
private boolean all;

@ManyToMany(targetEntity = Word.class, fetch = FetchType.LAZY)
@JoinTable(name = "group_word", joinColumns = {@JoinColumn(name="group_id")}, inverseJoinColumns = {@JoinColumn(name="word_id")})
private List<Word> words;

getters/setters... 
```

账户实体：

```
@Entity
@JsonIgnoreProperties(ignoreUnknown = true)
@Table(name = "account")
@Inheritance(strategy = InheritanceType.JOINED)
public class Account  extends User implements UserDetails {

@Id
@GeneratedValue(generator = "account_id", strategy = GenerationType.SEQUENCE)
@SequenceGenerator(name = "account_id", sequenceName = "account_account_id_seq", allocationSize = 1)
@Column(name = "account_id")
private Long accountId;

@Column(name = "username")
private String username;

@Column(name = "password")
private String password;

@Transient
private String repeatedPassword;

@DateTimeFormat(iso = ISO.DATE_TIME)
@Column(name = "registration_date")
Date registrationDate = Calendar.getInstance().getTime();

@Column(name = "email")
private String email;

@ManyToMany(targetEntity = Role.class, fetch = FetchType.LAZY)
@JoinTable(name = "account_role", joinColumns = {@JoinColumn(name="account_id")}, inverseJoinColumns = {@JoinColumn(name="role_id")})
private List<Role> roles;

public List<Role> getRoles() {
    return roles;
}

public void setRoles(List<Role> roles) {
    this.roles = roles;
}

@OneToMany(mappedBy="account", fetch = FetchType.LAZY)
private List<Group> groups;

public List<Group> getGroups() {
    return groups;
}

public void setGroups(List<Group> groups) {
    this.groups = groups;

getters/setters... 
```

当我调用此服务方法时：

```
public List<Group> listUserGroups(String username) {
    try {
        Account foundAccount = accountDao.findUserByUsername(username);
        List<Group> userGroups = foundAccount.getGroups();
        userGroups.size();
        return userGroups;
    } catch (UserNotFoundException unf) {
        logger.error("User not found: " + username, unf.getMessage());
        return Collections.emptyList();
    }
} 
```

我有一个错误在线：

```
userGroups.size(); 
```

错误：

```
00:27:27,528 DEBUG [org.hibernate.engine.StatefulPersistenceContext] - initializing non-lazy collections
00:27:27,528 DEBUG [org.hibernate.loader.Loader] - loading collection: [pl.net.grodek.snd.model.Account.groups#116]
00:27:27,528 DEBUG [org.hibernate.jdbc.AbstractBatcher] - about to open PreparedStatement (open PreparedStatements: 0, globally: 0)
00:27:27,528 DEBUG [org.hibernate.SQL] - select groups0_.account_account_id as account4_20_1_, groups0_.group_id as group1_1_, groups0_.group_id as group1_19_0_, groups0_.account_account_id as account4_19_0_, groups0_.all as all19_0_, groups0_.name as name19_0_ from group groups0_ where groups0_.account_account_id=?
00:27:27,544 DEBUG [org.hibernate.jdbc.AbstractBatcher] - about to close PreparedStatement (open PreparedStatements: 1, globally: 1)
00:27:27,544 DEBUG [org.hibernate.util.JDBCExceptionReporter] - could not initialize a collection: [pl.net.grodek.snd.model.Account.groups#116] [select groups0_.account_account_id as account4_20_1_, groups0_.group_id as group1_1_, groups0_.group_id as group1_19_0_, groups0_.account_account_id as account4_19_0_, groups0_.all as all19_0_, groups0_.name as name19_0_ from group groups0_ where groups0_.account_account_id=?]
org.postgresql.util.PSQLException: ERROR: syntax error near "group"
Position: 227
at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2103)
at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1836)
at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:512)
at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:76)
at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:208)
at org.hibernate.loader.Loader.getResultSet(Loader.java:1953)
at org.hibernate.loader.Loader.doQuery(Loader.java:802)
at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:274)
at org.hibernate.loader.Loader.loadCollection(Loader.java:2166)
at org.hibernate.loader.collection.CollectionLoader.initialize(CollectionLoader.java:62)
at org.hibernate.persister.collection.AbstractCollectionPersister.initialize(AbstractCollectionPersister.java:627)
at org.hibernate.event.def.DefaultInitializeCollectionEventListener.onInitializeCollection(DefaultInitializeCollectionEventListener.java:83)
at org.hibernate.impl.SessionImpl.initializeCollection(SessionImpl.java:1863)
at org.hibernate.collection.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:369)
at org.hibernate.collection.AbstractPersistentCollection.read(AbstractPersistentCollection.java:111)
at org.hibernate.collection.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:134)
at org.hibernate.collection.PersistentBag.size(PersistentBag.java:248)
at pl.net.grodek.snd.service.GroupServiceImpl.listUserGroups(GroupServiceImpl.java:47)
at pl.net.grodek.snd.service.GroupServiceImpl.listUserGroups(GroupServiceImpl.java:1)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at 
```

我认为问题出在 jpa 生成的查询中：

```
select groups0_.account_account_id as account4_20_1_, groups0_.group_id as group1_1_, groups0_.group_id as group1_19_0_, groups0_.account_account_id as account4_19_0_, groups0_.all as all19_0_, groups0_.name as name19_0_ from group groups0_ where groups0_.account_account_id=? 
```

其中 account_id 和 group_id 加倍。但我的问题是为什么会这样。请为我澄清这个问题，因为我没有想法:(

编辑：

哦，我忘了数据库表：

```
CREATE TABLE "group"
(
    group_id bigserial NOT NULL,
    name character varying(150)[] NOT NULL,
    "all" boolean NOT NULL DEFAULT false,
    account_id bigint NOT NULL,
    CONSTRAINT group_id_pk PRIMARY KEY (group_id ),
    CONSTRAINT account_id_fk FOREIGN KEY (account_id)
    REFERENCES account (account_id) MATCH SIMPLE
    ON UPDATE NO ACTION ON DELETE NO ACTION
)

CREATE TABLE account
(
    account_id bigserial NOT NULL,
    username character varying(32),
    password character varying(64),
    email character varying(100),
    registration_date timestamp with time zone NOT NULL,
    word_for_today bigint,
    groups_on_page integer NOT NULL,
    CONSTRAINT account_pk PRIMARY KEY (account_id ),
    CONSTRAINT word_fk FOREIGN KEY (word_for_today)
  REFERENCES word (word_id) MATCH SIMPLE
  ON UPDATE NO ACTION ON DELETE NO ACTION,
    CONSTRAINT unique_mail UNIQUE (email ),
    CONSTRAINT unique_username UNIQUE (username )
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T00:17:24.567

In my experience the problem is related with the scope of the persistence context. You are using a DAO to retrive the entities so maybe you pretend to access properties of a deattached entity.
Talking light, maybe, inside the scope of the accountDao.findUserByUsername() function you intialize/instance the persistence context when you retrive a entity through the entity manager but after the object return, the scope of this function end and the instance of the persistence context (entityManager) with it. In other word, in a Java SE app enviroment, you are not referencing the entityManager in a static way to stay it alive at all of your app running scope.

Apart of this, Hibernate works with proxies. It means that, following your example, you retrive the object Account with all basic attributes loaded but on the contrary the lazy relationships (groups, roles, etc.). When invoke getGroups() doesn't force the proxy to query for the list of groups, but when you invoke size the proxy must query for them. To better undestanding of this and Hibernate behavior in general I recommend you the *chapter 13 Understanding proxies* of the book *Hibernate in Action - Java Persistence with Hibernate* (isbn 1-932394-88-5)

Regards

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:25:40.363

I changed group table name to groups and it works. but please can anyone tell me why is that. With earlier relationships i did not have such mysterious problems. I am loosing ma sanity. :(

Maybe someone sees a problem in my code? Are my account->group relationships well set?

EDIT: As @AdrianShum said group is a SQL keyword so that my mapping worked when I changed to another name

# c# - 如何强制对泛型表示失望

> ID：13095461
> 
> 赞同：5
> 
> 时间：2012-10-26T22:50:22.517
> 
> 标签：c#, generics, downcast

鉴于以下代码：

```
class Animal
{ }

class Dog : Animal
{ }

class Cage<T>
{
    private T animal;

    public Cage(T animal)
    {
        this.animal = animal;
    }

    public T Animal
    { 
        get { return animal;} 
    }
}

class Program
{
    static void Main(string[] args)
    {
        Dog dog = new Dog();
        Cage<Animal> animalCage = new Cage<Animal>(dog);
        Cage<Dog> dogCage = (Cage<Dog>)animalCage;
    }
} 
```

如何解决最后一个编译器错误（从 animalCage 转换为 dogCage）？

在我的代码**中，我知道笼子里有一只狗**，但我无法找到一种方法来施放它。*我是创建转换器并从Cage<Animal>*的值创建新的*Cage<Dog>*实例的独特替代方案吗？

 ** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T23:04:46.513

**问题#1：**你不能把一个`Cage<Animal>`实例变成一个`Cage<Dog>`实例，你需要一个`Cage<Dog>`实例（或更具体类型的实例），它的引用存储在一个不太具体类型的变量中。

改变

```
Cage<Animal> animalCage = new Cage<Animal>(dog);
Cage<Dog> dogCage = (Cage<Dog>)animalCage; 
```

至

```
Cage<Animal> animalCage = new Cage<Dog>(dog);
Cage<Dog> dogCage = (Cage<Dog>)animalCage; 
```

**问题 #2：**您不能将`Cage<Dog>`实例的引用存储在`Cage<Animal>`变量中，因为类不支持协变/逆变。

改变

```
class Cage<T>
{
    ... 
```

至

```
interface ICage<out T> 
{
    T Animal { get; }
}

class Cage<T> : ICage<T> 
{ 
```

和

```
Cage<Animal> animalCage = new Cage<Dog>(dog);
Cage<Dog> dogCage = (Cage<Dog>)animalCage; 
```

至

```
ICage<Animal> animalCage = new Cage<Dog>(dog);
ICage<Dog> dogCage = (Cage<Dog>)animalCage; 
```

然后它工作。（如果您不更改`new Cage<Animal>`为`new Cage<Dog>`，则会在运行时获得强制转换异常。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T22:59:41.867

这将是通用方差的工作，除了`T`通常应该是协变的（因为它是输出）并且您试图以逆变方式使用它。此外，方差不适用于类，仅适用于接口和委托，因此您需要定义一个`ICage<T>`.

协方差将允许在另一个方向进行转换：您可以`ICage<Dog>`转换为`ICage<Animal>`. 逆变会导致矛盾，因为您可以尝试将`Cage<Animal>`包含 a的 a 强制转换`Cat`为 a `Cage<Dog>`，从而导致`get_Animal`类型错误。

数组也是协变的：您可以将 a`Dog[]`转换为 an `Animal[]`，但不能将 an`Animal[]`转换为 a ，`Dog[]`即使您知道它只包含狗。

我想到的下一件事是定义一个显式转换运算符，但[这些不能是通用](https://stackoverflow.com/questions/1025576/)的。

最后，您需要构建一个新`Cage<Dog>`的来完成这项工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T22:52:59.927

您可以添加[通用约束](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)

```
class Cage<T> where T : Animal 
```

然后从您的方法返回基类

```
public Animal Animal
{ 
    get { return animal;} 
} 
```

*泛型约束通知编译器可以为T*提供的类型存在限制。如果你提供其他东西，例如`Cage<object>`，你会得到一个编译时错误。*

# vba - if语句在excel-vba中访问另一个工作簿中的数据

> ID：13095470
> 
> 赞同：0
> 
> 时间：2012-10-26T22:51:40.640
> 
> 标签：vba, excel

我目前正在尝试编写宏。

*   我正在一个新的黑色工作簿中编写宏（这是要求的一部分），并且我在另一个工作簿中有很多数据。
*   我需要使用宏来读取该不同工作簿中的数据并吐出每列遇到的错误并将其写入空白工作簿（我正在编写宏）。
*   因此，对于每一列，假设有行号列表遇到错误（没有别的）。我正在尝试编写一个 If 语句来执行此操作，但我不断收到一条错误消息，指出“预期然后或转到”。

这是我到目前为止所拥有的：

`If [Dataset1.xls]Data1!R2C1=53 AND [Dataset1.xls]Data1!R2C1=453 AND [Dataset1.xls]Data1!R2C1=953 Then`

dataset1.xls 是保存所有数据的工作簿，Data1 是该工作簿中包含所有数据的工作表。我可能完全错误地访问了单独的工作簿。你们能帮忙吗。非常感谢您提前。

这是大部分代码：

```
Dim numrow As Long
Dim count As Long
count = 2

With Workbooks("Dataset1.xls").Sheets("Data1")
numrow = .Range("A1", .Range("A1").End(xlDown)).Rows.count

End With
Do Until count = numrow
If [Dataset1.xls]Data1!R2C1<>53 AND [Dataset1.xls]Data1!R2C1<>453 AND [Dataset1.xls]Data1!R2C1<>953 Then  

End If
count = count + 1
Loop 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:39:37.073

你应该改变

```
If Workbooks("Dataset1.xls").Sheets("Data1").Cells(2, 1).Value <> 53 AND Workbooks("Dataset1.xls").Sheets("Data1").Cells(2, 1).Value <> 453 AND Workbooks("Dataset1.xls").Sheets("Data1").Cells(2, 1).Value <> 953 Then 
```

代替：

```
If [Dataset1.xls]Data1!R2C1<>53 AND [Dataset1.xls]Data1!R2C1<>453 AND [Dataset1.xls]Data1!R2C1<>953 Then 
```

问候

-- 完整代码：

```
range = Workbooks("Dataset1.xls").Worksheets("Data").Range("A65536").End(xlUp).Row

For i = 2 To range

If Workbooks("Dataset1.xls").Sheets("Data1").Cells(i, 1).Value <> 53 AND Workbooks("Dataset1.xls").Sheets("Data1").Cells(i, 1).Value <> 453 AND Workbooks("Dataset1.xls").Sheets("Data1").Cells(i, 1).Value <> 953 Then

End IF

Next i 
```

# android - 我的 listView 添加了我没想到的元素

> ID：13095472
> 
> 赞同：-1
> 
> 时间：2012-10-26T22:52:13.920
> 
> 标签：android, listview, layout

在我的 listView 中，我只想显示从我的 Activity 获得的树字段，并且我在我的 listView 的顶部和底部添加了一个布局，我得到了我的 listView 的正确内容，但我也得到了一些来自局外人布局的元素。

我不知道为什么那些外来元素会出现在 listView 中，这是我的布局代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="vertical" >

<LinearLayout
    android:id="@+id/bottom_control_bar"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" 
    android:layout_alignParentBottom="true" >

    <Button
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Retour" />
</LinearLayout>

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/content"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_above="@+id/bottom_control_bar"
    android:layout_below="@+id/top_control_bar"
    android:gravity="center"
    android:orientation="vertical" >

    <ListView
        android:id="@android:id/list"
        android:layout_width="wrap_content"
        android:layout_height="0dip"
        android:layout_weight="1" >
    </ListView>

    <TableRow
        android:id="@+id/tableRow3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/note"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="10dip"
            android:textColor="#000000"
            android:textSize="14dip"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/dateNote"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="10dip"
            android:textColor="#000000"
            android:textSize="14dip"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/remarqueNote"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="10dip"
            android:textColor="#000000"
            android:textSize="14dip"
            android:textStyle="bold" />
    </TableRow>
</LinearLayout>

<LinearLayout
    android:id="@+id/top_control_bar"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <TableRow
        android:id="@+id/tableRow1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <include layout="@layout/header3" />
    </TableRow>

    <TableRow
        android:id="@+id/tableRow2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/nom"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:padding="10dip"
            android:textColor="#000000"
            android:textSize="14dip"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/prenom"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:padding="10dip"
            android:textColor="#000000"
            android:textSize="14dip"
            android:textStyle="bold" />
    </TableRow>

    <TableRow
        android:id="@+id/tableRow4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/nomMatiere"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:padding="10dip"
            android:textColor="#000000"
            android:textSize="14dip"
            android:textStyle="bold" />
    </TableRow>
</LinearLayout> 
```

![图片](../Images/341268d72673de491f8f3fbe6ecc64c6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:36:09.940

好的，据我所见，您定义的是具有三个文本视图的行、具有标题的行、具有两个文本视图的行和具有一个文本视图的行。

最重要的是ListView，最重要的是一个按钮。有点像

==========================

## | |按钮| |

| 列表视图 | | |

## | ... |

## | |正文| |正文| |正文| |

## | |页眉| |

## | |正文| |正文| |

# | |正文| |

如果这不是你想要的，你将不得不重新开始。

我会用RelativeLayouts来做这一切。LinearLayouts 没有给你足够的放置控制。如果您想在 RelativeLayout 中创建“一行”TextView，请将它们封装在 RelativeLayout 中。

在您的情况下，我会将按钮和 ListView 作为 RelativeLayout 的直接子级。创建另一个RelativeLayout，把它放在第一个里面。在它的顶部，放置标题。接下来，在第二个 RL 中插入另一个 RL，并在其中放置 3 个文本视图。在此 RL 下方插入第二个 RL，其中包含两个文本视图等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T20:10:36.997

我修好了它 。错误的是我对主要活动和列表视图使用相同的布局。

# java - 编码错误导致无限循环

> ID：13095476
> 
> 赞同：1
> 
> 时间：2012-10-26T22:52:40.067
> 
> 标签：java, syntax

我正在尝试编写一个程序，该程序采用人口的出生率和死亡率并循环年人口，直到它达到 0 或翻倍。

我的问题是它不断循环无数难以辨认的数字，我无法修复它。

```
import java.util.Scanner;
public class Hwk6 {
    public static void main (String[] args) {
        int currentYear, currentPopulation;
        double birthRate, deathRate;
        Scanner stdin = new Scanner(System.in);

        System.out.println("\nPopulation Estimator\n");
        System.out.println("Enter Year");
        currentYear = stdin.nextInt();
        System.out.println("Enter Current Population");
        currentPopulation = stdin.nextInt();
        System.out.println("Enter Birthrate of Population");
        birthRate = stdin.nextDouble();
        System.out.println("Enter Deathrate of Population");
        deathRate = stdin.nextDouble();

        int counter = currentPopulation;
        System.out.println("Population: ");
        while (currentPopulation != -1)
            while (counter < currentPopulation * 2) {
                System.out.print(counter + " ");
                counter = counter + (int)(counter * birthRate - counter * deathRate);
            }
        System.exit(0);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T22:53:36.273

更新循环中`currentPopulation`某处的值`while`，否则`while (currentPopulation != -1)`将**始终**评估为真（除非`-1`是原始值），您最终将陷入无限循环。

或者你的意思是

```
if (currentPopulation != -1) 
```

代替

```
while (currentPopulation != -1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T22:56:11.310

```
while (currentPopulation != -1) 
```

您的 while 条件将始终为真，因此它将无限迭代。因为您没有在`currentPopulation`任何地方更改 while 循环内部的值。

`currentPopulation`在内部 while 循环结束后，您需要更改外部 while 循环中某处的值。

```
while (currentPopulation != -1) {
     while (counter < currentPopulation * 2) {
           System.out.print(counter + " ");
           counter = counter + (int)(counter * birthRate - counter * deathRate);
     }

    // Change your `currentPopulation` here
} 
```

# mysql - 任何库可以将 mysql 表中的大量 IP 地址解析为国家名称或大陆？

> ID：13095478
> 
> 赞同：0
> 
> 时间：2012-10-26T22:52:53.170
> 
> 标签：mysql, ip-address

每次在我的网站上处理请求时，都会在 2 列 mysql 表中插入一条记录，其中包含为请求提供服务的 IP 地址和执行的日期时间。

我想对我的用户来自哪里进行高级估计（例如，50% 来自北美，20% 来自亚洲，20% 来自欧洲，10% 其他）您是否知道任何可以解析大量 ip 的库地址到国家或大洲的名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:55:43.853

[MaxMind 的 GeoIP](http://www.maxmind.com/en/geolocation_landing)绑定了多种编程语言。

# git - git分支数量限制

> ID：13095482
> 
> 赞同：29
> 
> 时间：2012-10-26T22:53:08.003
> 
> 标签：git, branch, limit, scaling

*出于各种原因*，我正在考虑在 git 之上构建一个大型系统，但主要是为了方便。

但作为实现的一部分，我最终会创建数百万个分支，并在它们之间进行分支和合并。git 真的可以这样扩展吗？我总是听到“分支机构是免费的”，但我不得不怀疑这是否真的是 x1,000,000？git 实际上可以创建理论上无限数量的分支吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-27T00:52:08.277

是的，分支机构是免费的。分支和合并非常容易。

之前提到的可伸缩性问题只有在通过网络同步大量分支时才会出现（git fetch、git pull、git push）。在本地你应该没有任何问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-26T23:06:39.470

去年在 git 邮件列表上有一个关于这方面的可扩展性问题的线程，我记得有一些改进，但我不记得当这些更改合并到新版本中时性能如何结果。

这是该线程存档的链接：

[http://git.661346.n2.nabble.com/Git-is-not-scalable-with-too-many-refs-td6456443.html](http://git.661346.n2.nabble.com/Git-is-not-scalable-with-too-many-refs-td6456443.html)

# java - 在 JPanel 上绘制图像并将其添加到 JFrame

> ID：13095483
> 
> 赞同：4
> 
> 时间：2012-10-26T22:53:20.170
> 
> 标签：java, swing, jframe, jpanel, drawrectangle

我是一名初学 Java 的高中生，我必须制作一个简单的盒子和胡须。我无法让我在 JPanel 上绘制的内容显示在 JFrame 上。图纸只是没有显示。有人可以帮我吗？

```
public class BoxPlot extends JFrame {

public final int MIN;
public final double Q1;
public final double MEDIAN;
public final double Q3;
public final int MAX;

public BoxPlot(int[] data){
    this.setLayout(new GridBagLayout());

    this.MIN = Statistics.min(data);
    this.Q1 = Statistics.lowerQuartile(data);
    this.MEDIAN = Statistics.median(data);
    this.Q3 = Statistics.upperQuartile(data);
    this.MAX = Statistics.max(data);

    this.addBox(data);
    this.addSummary();

    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setSize(800, 600);
    this.setResizable(true);
    this.setVisible(true);
}

// Adds a panel with the boxplot
private void addBox(int[] data) {
    Box box = new Box(data);
    GridBagConstraints c = new GridBagConstraints();
    c.gridx = 0;
    c.gridy = 0;
    c.weighty = 1;
    this.add(box, c);
}

// Adds a panel with the five number summaries as JLabels
// to the bottom of the JFrame 
private void addSummary() {
    JPanel summary = new JPanel();
    summary.setLayout(new GridLayout());
    JLabel l = new JLabel("Minimum: "+this.MIN, JLabel.CENTER);
    summary.add(l);
    l = new JLabel("First Quartile: "+this.Q1, JLabel.CENTER);
    summary.add(l);
    l = new JLabel("Median: "+this.MEDIAN, JLabel.CENTER);
    summary.add(l);
    l = new JLabel("Third Quartile: "+this.Q3, JLabel.CENTER);
    summary.add(l);
    l  = new JLabel("Maximum: "+this.MAX, JLabel.CENTER);
    summary.add(l);
    GridBagConstraints c = new GridBagConstraints();
    c.gridx = 0;
    c.gridy = 1;
    c.weightx = 1;
    c.ipady = 10;
    c.fill = GridBagConstraints.HORIZONTAL;
    c.anchor = GridBagConstraints.PAGE_END;
    this.add(summary, c);
} 
```

``

```
public class Box extends JPanel{

private int min;
private double q1;
private double median;
private double q3;
private int max;

public Box(int[] data) {
    this.min = Statistics.min(data);
    this.q1 = Statistics.lowerQuartile(data);
    this.median = Statistics.median(data);
    this.q3 = Statistics.upperQuartile(data);
    this.max = Statistics.max(data);
}

// paints the box onto the JPanel
public void paintComponent(Graphics g){
    int d1 =10 * (int) (this.q1-this.min);
    int d2 =10 * (int) (this.median-this.q1);
    int d3 =10 * (int) (this.q3-this.median);
    int d4 =10 * (int) (this.max-this.q3);
    g.drawLine(100, 150, 100+d1, 150);
    g.drawLine(100+d1+d2+d3, 150, 100+d1+d2+d3+d4, 150);
    g.setColor(Color.RED);
    g.fillRect(100+d1, 100, d2, 100);
    g.setColor(Color.BLUE);
    g.fillRect(100+d1+d2, 100, d3, 100);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T23:20:41.107

您没有`GridBagConstraints`为组件设置填充值`Box`，因此组件实际上没有大小。

你可以使用：

```
c.fill = GridBagConstraints.BOTH; 
```

# php - 如何使用 php 从另一个 Web 服务调用 Web 服务？

> ID：13095484
> 
> 赞同：0
> 
> 时间：2012-10-26T22:53:23.810
> 
> 标签：php, web-services, post

所以，我是 web 编程的新手，为了我的家庭作业，我必须使用 PHP 编写一些 web 服务。但是，一些 Web 服务必须使用其他 Web 服务，而我们没有学习如何做到这一点。我的教授说我们应该在网上查一下如何做到这一点。我认为使用`GET`我只需要做的参数调用 Web 服务`file_get_contents(url)`，但我不知道如何使用`POST`. 那么，如何使用 Web 服务进行 Web 服务调用`POST`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:58:41.760

POST and GET are used for data transmission and not for fetching data. To fetch data from a webpage use [Curl](http://php.net/manual/en/book.curl.php) or [file_get_content](http://php.net/manual/en/function.file-get-contents.php)s.

# java - 命名空间如何在 ant 构建文件中工作？

> ID：13095485
> 
> 赞同：0
> 
> 时间：2012-10-26T22:53:27.817
> 
> 标签：java, ant, ant-contrib, java-compiler-api

我正在尝试使用 ant-contrib 并且我注意到有时它用于指定 ac: 命名空间，有时则不是。

我什么时候应该使用命名空间，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:48:01.450

Ant-contrib 被打包为一个[antlib](http://ant.apache.org/manual/Types/antlib.html)。这是分发 ANT 扩展的更现代的方式。

# xml - 如何使用 Groovy 的 MarkupBuilder 渲染列表

> ID：13095486
> 
> 赞同：3
> 
> 时间：2012-10-26T22:53:30.330
> 
> 标签：xml, groovy, map

我正在使用 Groovy [MarkupBuilder](http://groovy.codehaus.org/Creating+XML+using+Groovy%27s+MarkupBuilder)将 Map 转换为 XML 。此 Map 可以包含简单的键/值对、其他 Map 或 Map 列表。我从[这里](https://groovyconsole.appspot.com/script/431003)的代码捎带。

```
import groovy.xml.MarkupBuilder

def map = [
    key1:'value1',
    key2:'value2',
    nestedMap : [
        key1:'bar1',
        key2:'bar2'
    ],
    select : [
        [option:'foo1'],
        [option:'foo2']
    ]
]

Closure renderMap( Map map ){
    return { 
        for ( entry in map ){
            switch( entry.value.getClass() ){
                case Map :
                    "${entry.key}" renderMap( entry.value )
                break
                case List:
                    entry.value.collect { listEntry ->
                        "${entry.key}" renderMap( listEntry )
                    }
                    break
                default :
                     "${entry.key}"( "${entry.value}" )
                break
            }
        }
    }
}

StringWriter writer = new StringWriter()
new MarkupBuilder(writer).root renderMap(map)

println writer.toString() 
```

我关心的这部分打印出来：

```
 <select>
    <option>foo1</option>
  </select>
  <select>
    <option>foo2</option>
  </select> 
```

但是，我想知道是否有办法让 select 封装这两个选项，如下所示：

```
<select>
    <option>foo1</option>
     <option>foo2</option>
  </select> 
```

我试过玩弄钥匙的位置，但无济于事。我是不是全都错了，还是我不应该使用构建器？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-27T07:22:25.440

我认为这会做你想要的。前两个重载采用映射或集合，并返回一个组合闭包，该闭包可以传递给封闭元素的 builder 方法，以将映射或集合的内容添加到构建器。

第三个是回退，只返回它的参数，以便可以将它们传递给 builder 方法。这会处理字符串，但如果需要，您也可以将其传递给闭包。我替换了`option`您提供的地图中的第二个元素作为示例。

[`ComposedClosure`](http://groovy.codehaus.org/api/org/codehaus/groovy/runtime/ComposedClosure.html)是在 Groovy 1.8 中添加的，所以这在早期版本中不起作用。

```
import groovy.xml.MarkupBuilder

Closure buildxml(final Map map)
{
    final compose = { f, tag, content -> f >> { "$tag"(buildxml(content)) } }
    return map.inject(Closure.IDENTITY, compose)
}

Closure buildxml(final Collection col)
{
    final compose = { f, content -> f >> buildxml(content) }
    return col.inject(Closure.IDENTITY, compose)
}

def buildxml(final content)
{
    return content
}

def map = [
    key1:'value1',
    key2:'value2',
    nestedMap : [
        key1:'bar1',
        key2:'bar2'
    ],
    select : [
        [option:'foo1'],
        { option('foo2') },
    ],
]

final writer  = new StringWriter()
final builder = new MarkupBuilder(writer)

builder.root buildxml(map)

assert writer as String == '''\
<root>
  <key1>value1</key1>
  <key2>value2</key2>
  <nestedMap>
    <key1>bar1</key1>
    <key2>bar2</key2>
  </nestedMap>
  <select>
    <option>foo1</option>
    <option>foo2</option>
  </select>
</root>'''.stripIndent() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T23:02:04.770

做

```
case List:
    "${entry.key}" entry.value.collect {
        renderMap it
    }
    break 
```

带你去任何地方？虽然不是在电脑上检查atm，但感觉对吗？

# c - 如何在 C 中实现重叠检查 memcpy

> ID：13095488
> 
> 赞同：8
> 
> 时间：2012-10-26T22:53:36.583
> 
> 标签：c, unix, pointers, memory-management

这是一个学习练习。我试图通过在复制操作开始之前通知用户复制操作将通过还是失败来增加 memcpy。我最大的问题是以下。如果我分配两个每个 100 字节的 char 数组，并且有两个指针引用每个数组，我怎么知道我在复制哪个方向？如果我将所有内容从第一个数组复制到第二个数组，如何确保用户不会覆盖原始数组？

我当前的解决方案比较了指针与目标数组大小的距离。如果两者之间的大小小于我所说的将发生覆盖。但是，如果它向另一个方向复制呢？我只是有点困惑。

```
int memcpy2(void *target, void *source, size_t nbytes) {
    char * ptr1 = (char *)target;
    char * ptr2 = (char *)source;

    int i, val;

    val = abs(ptr1 - ptr2);
    printf("%d, %d\n", val, nbytes + 0);
    if (val > nbytes) {
        for (i = 0; i < val; i++){
            ptr1[i] = ptr2[i];
        }
        return 0;  /*success */
    }
    return -1; /* error */
}

int main(int argc, char **argv){

  char src [100] = "Copy this string to dst1";
  char dst [20];
  int p;
  p = memcpy2(dst, src, sizeof(dst));

    if (p == 0)
        printf("The element\n'%s'\nwas copied to \n'%s'\nSuccesfully\n", src, dst);
    else
        printf("There was an error!!\n\nWhile attempting to copy the elements:\n '%s'\nto\n'%s', \n Memory was overlapping", src, dst);
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-27T00:41:04.487

确定两个内存范围是否重叠的唯一*可移植方法是：*

```
int overlap_p(void *a, void *b, size_t n)
{
    char *x = a, *y =  b;
    for (i=0; i<n; i++) if (x+i==y || y+i==x) return 1;
    return 0;
} 
```

这是因为指针与关系运算符的比较是未定义的，除非它们指向同一个数组。实际上，比较确实适用于大多数现实世界的实现，因此您可以执行以下操作：

```
int overlap_p(void *a, void *b, size_t n)
{
    char *x = a, *y =  b;
    return (x<=y && x+n>y) || (y<=x && y+n>x);
} 
```

我希望我的逻辑是正确的；你应该检查一下。如果您想假设您可以获取任意指针的差异，您可以进一步简化它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T23:00:00.313

您要检查的是源在内存中相对于目标的位置：

如果源在目标之前（即源<目标），那么您应该从头开始。如果源在之后，则从头开始。如果它们相等，则您无需执行任何操作（小例）。

这里有一些粗略的 ASCII 绘图来可视化问题。

```
|_;_;_;_;_;_|          (source)
      |_;_;_;_;_;_|    (destination)
            >-----^    start from the end to shift the values to the right

      |_;_;_;_;_;_|    (source)
|_;_;_;_;_;_|          (destination)
^-----<                 start from the beginning to shift the values to the left 
```

在下面的非常准确的评论之后，我应该补充一点，您可以使用指针（目标 - 源）的差异，但为了安全起见，事先将这些指针转换为 char *。

在您当前的设置中，我认为您无法检查操作是否会失败。您的 memcpy 原型会阻止您进行任何形式的检查，并且使用上面给出的决定如何复制的规则，操作将成功（除了任何其他考虑因素之外，例如先前的内存损坏或无效指针）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-27T00:58:47.910

我不相信“试图通过在复制操作开始之前通知用户复制操作将通过还是失败来增加 memcpy”。是一个结构良好的概念。

首先， memcpy() 在正常意义上不会成功或失败。它只是复制数据，如果它在源数组之外读取或在目标数组之外写入，可能会导致错误/异常，并且它也可能在这些数组之一之外读取或写入，而不会导致任何错误/异常并且只是默默地破坏数据. 当我说“memcpy 执行此操作”时，我并不是在谈论 C stdlib memcpy 的实现，而是在谈论具有相同签名的任何函数——它没有足够的信息来做其他事情。

其次，如果您对“成功”的定义是“假设缓冲区足够大但可能重叠，则将数据从源复制到 dst，而不会在复制时绊倒自己”——这确实是 memmove() 所做的，而且总是可能的。同样，没有“退货失败”的情况。如果缓冲区不重叠很容易，如果源与目标的末尾重叠，那么您只需从头开始逐字节复制；如果源与目标的开头重叠，那么您只需从末尾逐字节复制。这就是 memmove() 的作用。

第三，在编写此类代码时，您必须非常小心指针运算（包括加法、减法和数组索引）的溢出情况。In `val = abs(ptr1 - ptr2)`,`ptr1 - ptr2`可能是一个非常大的数字，它是无符号的，所以`abs()`不会对它做任何事情，并且`int`是错误的类型来存储它。只是让你知道。

# java - 了解 ESB

> ID：13095489
> 
> 赞同：10
> 
> 时间：2012-10-26T22:53:42.110
> 
> 标签：java, web-services, jms, integration, soa

虽然我了解什么是系统集成，但我对所有最新方法都有些陌生。我非常熟悉 Web 服务和 JMS，但我对 ESB 的概念感到完全困惑。

我做了一些研究，但我仍然不明白。我通过例子而不是理论工作得更好。

那么有人可以举一个简单的例子来说明为什么要使用 Enterprise Service Bus 而不是 Queue 、 web service 、文件系统或其他？

我希望该示例能够增强 ESB 的功能，这是任何其他传统集成方法都无法实现的，或者至少无法以相同的效率实现。

非常感谢所有答复。

谢谢，鲍勃

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T23:47:48.923

这听起来有点刺耳，但基本上如果你需要一个 ESB，你就会知道你需要一个 ESB。

对于大多数用例，ESB 是寻找问题的解决方案。它是为大多数场景设计的软件堆栈。大多数人根本没有做足够多的处理来保证它。“企业”的“E”在这里值得注意。

在一个简单的情况下：

```
tail -F server.log | grep SEVERE >> severe.log 
```

这是 ESB 场景实例的一个简单示例。

“但这只是一个 UNIX 命令管道！”

对，就是这样。

“ESB”部分是“|” 和“>>”

ESB 是运行时，您可以在其中将模块链接在一起、监控流量、设计各种古怪的场景，如扇出和连接等。

ESB 以拥有一堆连接器来读取一堆源并写入一堆目的地而著称。它们以使用相当粗略的逻辑块编织更复杂的图形和工作流来处理而著称。

但大多数人通常做的是：

```
input -> DO_STUFF -> output 
```

使用 ESB，他们可以获得：

```
ESB[input -> DO_STUFF -> output] 
```

在野外，大多数管道根本没有那么复杂。他们往往有一个不可重用的逻辑，人们倾向于将它整合到一个单一的逻辑模块中。

好吧，哎呀，你可以用 Perl 脚本做到这一点。

ESB 中的长管道往往效率低下。有大量数据进出通用模块的编组（因为您很少使用二进制有效负载）。

因此，比如说，CSV 进入，转换为 XML，对其进行处理，输出 XML 以作为 XML 输入到另一个步骤，XML 对其进行编组、处理、将其转换回 XML 以进行又一个步骤。冲洗并重复，直到 CPU 达到 400%（多核 FTW）。

然后有人提出“嘿，如果我将这些模块拖放到一个例程中，我们将跳过所有这些 XML 垃圾！”，最终得到“输入 -> DO_STUFF -> 输出”。

对于大型系统，有很多需要进行临时、临时集成的 Web 服务，它们可以很好。如果您从事的业务很多，那么它们可以很好地工作。当您拥有数十条管道时，它们可以帮助管理它们的运营方面。

但是对于复杂的流水线，如果您有很多步骤，那么除了原型设计之外，这可能不是一个好主意，尤其是在涉及任何实际体积的情况下。请注意，您可能没有任何选择，这取决于您正在集成的系统。

如果没有，如果你有一个单一的界面，你需要站起来——那就去做吧。用 Perl、Java、C# 等任何方式来做。不要用完并积累一些奇怪的 100MB 基础设施和复杂性，您现在可以学习、掌握和维护这些基础设施。

所以，再一次，如果你需要一个 ESB，你会知道的。真的。您将拥有由不同的东西组成的任何系统，您会与之抗争，与同事谈论所有这些东西是多么痛苦，您会偶然发现一些指向某个供应商的站点的链接并阅读一份白皮书然后说“就是这样！”，但如果你还没有这样做，那么你不会错过任何东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-27T07:10:40.040

ESB is for the cases where you do have that web service and queue and file system all in the same system and need to integrate them. An ESB product usually solves the following

1.  Security
2.  Message routing
3.  Orchestration (which is advanced message routing)
4.  Protocol transformation
5.  Message transformation
6.  Monitoring
7.  Eventing

You can do all of these with other tools as well and if you just need one or two of these capabilities you can probably do without and ESB (as it introduced additional complexity) but when you need several of them an integrated solution in the form of an ESB can be a better solution.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-27T00:00:19.233

正如@WillHartung 总结的那样，ESB 倾向于在大型、复杂的情况下正确使用。这就是为什么它被命名为**企业**服务总线。

现在，要真正回答您的问题，ESB 通常会：

*   通过多种协议（例如 HTTP、消息队列等）进行通信，用于输入和输出

*   建立通用的消息格式，并经常从其他格式转换为“规范”格式

*   提供端点透明性（例如，您向总线发送消息并得到答复，但您不明确知道也连接到总线的服务处理了您的请求。

*   提供监控和管理能力

*   促进服务和消息的版本控制

*   在需要时加强安全性。

因此，正如您所看到的，这是因为当进行大量点对点通信（“就这样做”）将是一大堆难以管理的意大利面条。事实上，在我见过 SOA 实施的大多数地方，它正在取代已经存在的大量意大利面条。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-24T08:39:58.470

ESB 是一种企业服务总线，如果您喜欢面向服务的架构，它是一个基础架构背板。想象一下数百个服务愉快地重用彼此的混乱。如何管理这样的环境？您如何在服务之间提供灵活、解耦的路由？如何避免点对点的意大利面条式架构？您如何管理混合技术环境中的事务和安全性？您如何跟踪跨多个系统的复杂流中消息的位置？

您使用 ESB。

ESB 通常允许您使用 XML 配置语言设计跨多个系统的流程，为您提供大量 EIS 适配器、转换和中介插件等。有些将提供 IDE 来帮助您设计流程。有些 ESB 非常昂贵，有些是开源的。

如果您想了解 ESB，请查看 Mule 或 WSO2，它们都是优秀的开源产品，甚至是 Spring Integration，它是一种非集群解决方案，但非常适合将 Java 与底层外部接口点解耦。

# android - 如何检测左/右和上/下之间的滑动方向

> ID：13095494
> 
> 赞同：80
> 
> 时间：2012-10-26T22:54:39.650
> 
> 标签：android, user-interface, user-interaction

**我的问题：**我如何检测用户何时向上/向下和向左/向右移动手指（以及我如何知道他们的手指移动了这些组的哪个方向）？

**我的情况：**我想在他们上下移动手指时更改我的应用程序的亮度（向上 = 更亮，向下 = 更暗），并且我想根据他们的左/右滑动在活动和/或视图之间切换。

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2014-10-15T16:35:57.803

我为此写了一个简单的类：它有据可查，所以我不会在这里解释

```
public class OnSwipeListener extends GestureDetector.SimpleOnGestureListener {

    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {

        // Grab two events located on the plane at e1=(x1, y1) and e2=(x2, y2)
        // Let e1 be the initial event
        // e2 can be located at 4 different positions, consider the following diagram
        // (Assume that lines are separated by 90 degrees.)
        //
        //
        //         \ A  /
        //          \  /
        //       D   e1   B
        //          /  \
        //         / C  \
        //
        // So if (x2,y2) falls in region:
        //  A => it's an UP swipe
        //  B => it's a RIGHT swipe
        //  C => it's a DOWN swipe
        //  D => it's a LEFT swipe
        //

        float x1 = e1.getX();
        float y1 = e1.getY();

        float x2 = e2.getX();
        float y2 = e2.getY();

        Direction direction = getDirection(x1,y1,x2,y2);
        return onSwipe(direction);
    }

    /** Override this method. The Direction enum will tell you how the user swiped. */
    public boolean onSwipe(Direction direction){
        return false;
    }

    /**
     * Given two points in the plane p1=(x1, x2) and p2=(y1, y1), this method
     * returns the direction that an arrow pointing from p1 to p2 would have.
     * @param x1 the x position of the first point
     * @param y1 the y position of the first point
     * @param x2 the x position of the second point
     * @param y2 the y position of the second point
     * @return the direction
     */
    public Direction getDirection(float x1, float y1, float x2, float y2){
        double angle = getAngle(x1, y1, x2, y2);
        return Direction.fromAngle(angle);
    }

    /**
     *
     * Finds the angle between two points in the plane (x1,y1) and (x2, y2)
     * The angle is measured with 0/360 being the X-axis to the right, angles
     * increase counter clockwise.
     *
     * @param x1 the x position of the first point
     * @param y1 the y position of the first point
     * @param x2 the x position of the second point
     * @param y2 the y position of the second point
     * @return the angle between two points
     */
    public double getAngle(float x1, float y1, float x2, float y2) {

        double rad = Math.atan2(y1-y2,x2-x1) + Math.PI;
        return (rad*180/Math.PI + 180)%360;
    }

    public enum Direction{
        up,
        down,
        left,
        right;

        /**
         * Returns a direction given an angle.
         * Directions are defined as follows:
         *
         * Up: [45, 135]
         * Right: [0,45] and [315, 360]
         * Down: [225, 315]
         * Left: [135, 225]
         *
         * @param angle an angle from 0 to 360 - e
         * @return the direction of an angle
         */
        public static Direction fromAngle(double angle){
            if(inRange(angle, 45, 135)){
                return Direction.up;
            }
            else if(inRange(angle, 0,45) || inRange(angle, 315, 360)){
                return Direction.right;
            }
            else if(inRange(angle, 225, 315)){
                return Direction.down;
            }
            else{
               return Direction.left;
           }

        }

       /**
         * @param angle an angle
         * @param init the initial bound
         * @param end the final bound
         * @return returns true if the given angle is in the interval [init, end).
         */
        private static boolean inRange(double angle, float init, float end){
            return (angle >= init) && (angle < end);
        }
    }
 } 
```

要使用只需扩展`OnSwipeListener`并覆盖该`onSwipe`方法

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2012-10-26T23:00:45.163

您只需扩展 SimpleOnGestureListener 类，

在你的课堂上声明这一点，

```
private static final int SWIPE_MIN_DISTANCE = 120;
private static final int SWIPE_MAX_OFF_PATH = 250;
private static final int SWIPE_THRESHOLD_VELOCITY = 200; 
```

作为水平滑动的示例，您可以看到以下代码，

```
 class MyGestureDetector extends SimpleOnGestureListener {
    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
            float velocityY) {
        try {
            if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH){
                return false;
            }
            // right to left swipe
            if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE
                    && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                onLeftSwipe();
            } 
            // left to right swipe
            else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
                    && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                onRightSwipe();
            }
        } catch (Exception e) {

        }
        return false;
      }
   } 
```

您可以类似地执行此操作以达到垂直滑动的目的。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2017-01-04T11:58:46.267

[Fernandour](https://stackoverflow.com/a/26387629/4646227)的答案是完美的，我正在写这个关于如何使用它的答案，`Activity`并且`Fragment`很多人都在寻找它。

```
public class MyActivity extends Activity implements View.OnTouchListener{

     private RelativeLayout someLayout;
     //take any layout on which you want your gesture listener;

     @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    gestureDetector=new GestureDetector(this,new OnSwipeListener(){

        @Override
        public boolean onSwipe(Direction direction) {
            if (direction==Direction.up){
               //do your stuff
                Log.d(TAG, "onSwipe: up");

            }

            if (direction==Direction.down){
               //do your stuff
                Log.d(TAG, "onSwipe: down");
            }
            return true;
        }

    });
    someLayout.setOnTouchListener(this);
}

    @Override
    public boolean onTouch(View v, MotionEvent event) {
      Log.d(TAG, "onTouch: ");
      gestureDetector.onTouchEvent(event);
      return true;
  }

} 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2017-01-30T15:49:00.363

[上面fernandohur 答案](https://stackoverflow.com/a/26387629/3263659)的完整**用法示例**：

如果您想将 OnSwipeListener 应用于您的一个视图，那么：
无论此视图在哪里 - 为该视图设置一个触摸侦听器，如下所示：

```
myview.setOnTouchListener(this); 
```

现在在您的 Activity 的 OnCreate 或您的自定义视图构造函数中执行以下操作：

```
// Global
private GestureDetectorCompat detector; 

// In OnCreate or custome view constructor (which extends one of Android views)
detector = new GestureDetectorCompat(context, onSwipeListener); 
```

在同一个类中覆盖 onTouch 事件，如下所示：

```
@Override
public boolean onTouch(View view, MotionEvent motionEvent) {
    return detector.onTouchEvent(motionEvent);
} 
```

并且在同一个类中也有这个监听器对象：

```
OnSwipeListener onSwipeListener = new OnSwipeListener() {
    @Override
    public boolean onSwipe(Direction direction) {
        // Possible implementation 
        if(direction == Direction.left|| direction == Direction.right) {
            // Do something COOL like animation or whatever you want
            // Refer to your view if needed using a global reference
            return true;
        }
        else if(direction == Direction.up|| direction == Direction.down) {
            // Do something COOL like animation or whatever you want
            // Refer to your view if needed using a global reference
            return true;
        }
        return super.onSwipe(direction);
    }
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-08-17T10:40:52.563

我就是这样做的，最简单的方法

```
float initialX, initialY;

@Override
public boolean onTouchEvent(MotionEvent event) {

    int action = event.getActionMasked();

    switch (action) {

        case MotionEvent.ACTION_DOWN:
            initialX = event.getX();
            initialY = event.getY();

            // Log.d(TAG, "Action was DOWN");
            break;

        case MotionEvent.ACTION_MOVE:

            //Log.d(TAG, "Action was MOVE");
            break;

        case MotionEvent.ACTION_UP:
            float finalX = event.getX();
            float finalY = event.getY();

            //Log.d(TAG, "Action was UP");

            if (initialX < finalX) {
                // Log.d(TAG, "Left to Right swipe performed");
            }

            if (initialX > finalX) {
                // Log.d(TAG, "Right to Left swipe performed");
            }

            if (initialY < finalY) {
                // Log.d(TAG, "Up to Down swipe performed");
            }

            if (initialY > finalY) {
                // Log.d(TAG, "Down to Up swipe performed");
            }

            break;

        case MotionEvent.ACTION_CANCEL:
            //Log.d(TAG,"Action was CANCEL");
            break;

        case MotionEvent.ACTION_OUTSIDE:
            // Log.d(TAG, "Movement occurred outside bounds of current screen element");
            break;
    }

    return super.onTouchEvent(event);
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-02-09T15:30:15.263

我多次测试它的最佳答案，它对我有用

```
float firstX_point, firstY_point;
@Override
public boolean onTouchEvent(MotionEvent event) {

    int action = event.getAction();

    switch (action) {

        case MotionEvent.ACTION_DOWN:
            firstX_point = event.getRawX();
            firstY_point = event.getRawY();
            break;

        case MotionEvent.ACTION_UP:

            float finalX = event.getRawX();
            float finalY = event.getRawY();

            int distanceX = (int) (finalX - firstX_point);
            int distanceY = (int) (finalY - firstY_point);

            if (Math.abs(distanceX) > Math.abs(distanceY)) {
                if ((firstX_point < finalX)) {
                    Log.d("Test", "Left to Right swipe performed");
                } else {
                    Log.d("Test", "Right to Left swipe performed");
                }
            }else{
                if ((firstY_point < finalY)) {
                    Log.d("Test", "Up to Down swipe performed");
                } else {
                    Log.d("Test", "Down to Up swipe performed");
                }
            }

            break;
    }

    return true;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-01-15T13:00:56.667

您可以覆盖 SimpleGestureListener 并计算开始结束当前坐标之间的差异：

```
private class GestureListener extends SimpleOnGestureListener {

    @Override
    public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY) {

        if (e2.getY() > e1.getY()) {
            // direction up
        }else {
            // direction down
        }

        if (e2.getX() > e1.getX()) {
            // direction right
        }else {
            // direction left
        }

        return true;
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-24T08:01:42.173

我这样解决了：

```
viewPager.setOnTouchListener(new View.OnTouchListener() {
        float prevX = -1;

        @Override
        public boolean onTouch(View v, MotionEvent event) {
            if (prevX != -1) {
                if (event.getX() > prevX) {
                    if (viewPager.getCurrentItem() == 0) {
                         // Left to Right swipe
                    }
                    //Log.d("DEBUG", MotionEvent.ACTION_MOVE + ":" + event.getAction() + ":" + event.getActionMasked() + ":Left Swipe" + ":" + prevX + ":" + event.getX() + ":" + viewPager.getCurrentItem());
                } else if (prevX > event.getX()) {
                       // Right to left swipe
                    //Log.d("DEBUG", MotionEvent.ACTION_MOVE + ":" + event.getAction() + ":" + event.getActionMasked() + ":Right Swipe" + ":" + prevX + ":" + event.getX() + ":" + viewPager.getCurrentItem());
                }
            }
            if (event.getAction() == MotionEvent.ACTION_MOVE) {
                prevX = event.getX();
            } else {
                prevX = -1;
            }
            return false;
        }
    }); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-11T09:45:57.653

我在 bitbucket 上有一个开源手势库可以做到这一点。这个库中有一个“HGFling”类。这演示了如何检测投掷的方向。您可以从以下网址下载该库：[https](https://bitbucket.org/warwick/hacergestov3) ://bitbucket.org/warwick/hacergestov3 。它是开源的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-28T08:21:40.677

对于这样一个简单的问题，可用的答案太复杂了。我建议另一种方法（代码是 as3，但你可以理解）：

```
var touchDistance:Number = Point.distance(_moveTouchPoint, _startTouchPoint);
if (touchDistance >= SWIPE_MIN_DISTANCE)
{
    var xDiff:Number = _moveTouchPoint.x - _startTouchPoint.x;
    var yDiff:Number = _moveTouchPoint.y - _startTouchPoint.y;

    var yGreater:Boolean = Math.abs(yDiff) >= Math.abs(xDiff);
    if (yGreater)
    {
        // direction is up or down
        changePlayerDirectionTo(yDiff < 0 ? DIRECTION_UP : DIRECTION_DOWN);
    }
    else
    {
        // direction is left or right
        changePlayerDirectionTo(xDiff < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT)
    }
} 
```

在每种情况下，x 或 y 的绝对值都会更大，这可以解决特定的方向集。从那时起，您可以依靠坐标符号来准确检测哪个方向。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-02-13T17:53:21.287

**为@Fernandour**答案添加`Kotlin`实现。对于Java，请查看@f **arhan patel**的答案，我之所以添加这个是因为我遇到了困难，希望它可以节省某人的时间。

 ****```
class ClientFragment : Fragment(), View.OnTouchListener {

    private lateinit var gestureDetector: GestureDetector

    override fun onTouch(v: View?, event: MotionEvent?): Boolean {
        Log.d(TAG, "onTouch: ");
        gestureDetector.onTouchEvent(event);
        return true
    }

override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {

 ...

 gestureDetector = GestureDetector(activity, object : OnSwipeListener() {

            override fun onSwipe(direction: Direction): Boolean {

                when(direction){
                   Direction.up ->
                   {
                       Log.d(TAG, "onSwipe: up")
                       sendCommand("UP")
                       return true
                   }
                     Direction.down ->{
                         Log.d(TAG, "onSwipe: down")
                         sendCommand("DOWN")
                         return true
                     }

                    Direction.left ->
                    {
                        Log.d(TAG, "onSwipe: left")
                        sendCommand("LEFT")
                        return true

                    }
                    Direction.right ->{
                        Log.d(TAG, "onSwipe: right")
                        sendCommand("RIGHT")
                        return true

                    }
                    else -> {
                    }
                }
                return true
            }

        })
        dpadLayout.setOnTouchListener(this) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-09-17T10:27:26.923

**@Fernandour 答案的扩展版本**易于直接实现，只需触摸监听器即可，无需执行额外代码……触摸点，长按，双击实现……。

```
 public class OnSwipeListener implements View.OnTouchListener{
    public enum Direction{up,down,left,right;}
    private GestureDetector gestureDetector;
    private Context context;
    public OnSwipeListener(Context c) {
        this.context = c;

        gestureDetector = new GestureDetector(c, new GestureListener(c));
    }
    public boolean onTouch(final View view, final MotionEvent motionEvent) {

        return gestureDetector.onTouchEvent(motionEvent);
    }

    public void onSwipeRight() {
    }

    public void onSwipeLeft() {
    }

    public void onSwipeUp() {
    }

    public void onSwipeDown() {
    }

    public void onClick() {
    }

    public void onDoubleClick() {
    }

    public void onLongClick() {
    }
    public double getAngle(float x1, float y1, float x2, float y2) {
        double rad = Math.atan2(y1-y2,x2-x1) + Math.PI;
        return (rad*180/Math.PI + 180)%360;
    }

    private final class GestureListener extends GestureDetector.SimpleOnGestureListener {
        Context context;
        public GestureListener(Context c) {
            this.context = c;
        }

        @Override
        public boolean onDown(MotionEvent e) {
            return true;
        }

        @Override
        public boolean onSingleTapUp(MotionEvent e) {
            onClick();
            return super.onSingleTapUp(e);
        }

        @Override
        public boolean onDoubleTap(MotionEvent e) {
            onDoubleClick();
            return super.onDoubleTap(e);
        }

        @Override
        public void onLongPress(MotionEvent e) {
            onLongClick();
            super.onLongPress(e);
        }
        @Override
        public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
            float x1 = e1.getX();
            float y1 = e1.getY();

            float x2 = e2.getX();
            float y2 = e2.getY();

            Direction direction = getDirection(x1,y1,x2,y2);

            return onSwipe(direction);
        }

        public Direction getDirection(float x1, float y1, float x2, float y2){
            double angle = getAngle(x1, y1, x2, y2);
            return fromAngle(angle);
        }

        public  Direction fromAngle(double angle){
            if(inRange(angle, 45, 135)){
                onSwipeUp();
                return Direction.up;
            }
            else if(inRange(angle, 0,45) || inRange(angle, 315, 360)){
                onSwipeRight();
                return Direction.right;
            }
//            else if(inRange(angle, 225, 315)){
//                //onSwipeDown();
//
//            }
            else if(inRange(angle,135, 225)){
                onSwipeLeft();
                return Direction.left;
            }
            else {
                return Direction.down;
            }

        }
         private  boolean inRange(double angle, float init, float end){
            return (angle >= init) && (angle < end);
        }

        public boolean onSwipe(Direction direction){
            return false;
        }
    };
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-07-06T06:57:06.157

检测向左、向右、上、下滑动的最佳方法和简单方法

1.  首先制作一个Java类并实现`View.OnTouchListener`在这个类中添加以下代码：

```
 public  class OnSwipeTouchListener implements View.OnTouchListener {
        private final GestureDetector gestureDetector;
        Context context;
        OnSwipeTouchListener(Context ctx, View mainView) {
            gestureDetector = new GestureDetector(ctx, new GestureListener());
            mainView.setOnTouchListener(this);
            context = ctx;
        }
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            return gestureDetector.onTouchEvent(event);
        }
        public class GestureListener extends
                GestureDetector.SimpleOnGestureListener {
            private static final int SWIPE_THRESHOLD = 100;
            private static final int SWIPE_VELOCITY_THRESHOLD = 100;
            @Override
            public boolean onDown(MotionEvent e) {
                return true;
            }
            @Override
            public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
                boolean result = false;
                try {
                    float diffY = e2.getY() - e1.getY();
                    float diffX = e2.getX() - e1.getX();
                    if (Math.abs(diffX) > Math.abs(diffY)) {
                        if (Math.abs(diffX) > SWIPE_THRESHOLD && Math.abs(velocityX) > SWIPE_VELOCITY_THRESHOLD) {
                            if (diffX > 0) {
                                onSwipeRight();
                            } else {
                                onSwipeLeft();
                            }
                            result = true;
                        }
                    }
                    else if (Math.abs(diffY) > SWIPE_THRESHOLD && Math.abs(velocityY) > SWIPE_VELOCITY_THRESHOLD) {
                        if (diffY > 0) {
                            onSwipeBottom();
                        } else {
                            onSwipeTop();
                        }
                        result = true;
                    }
                }
                catch (Exception exception) {
                    exception.printStackTrace();
                }
                return result;
            }
        }
        void onSwipeRight() {
            Toast.makeText(context, "You Swipe Right", Toast.LENGTH_SHORT).show();
            this.onSwipe.swipeRight();
        }
        void onSwipeLeft() {
            Toast.makeText(context, "You Swipe Left", Toast.LENGTH_SHORT).show();
            this.onSwipe.swipeLeft();
        }
        void onSwipeTop() {
            Toast.makeText(context, "You Swipe Up", Toast.LENGTH_SHORT).show();
            this.onSwipe.swipeTop();
        }
        void onSwipeBottom() {
            Toast.makeText(context, "You Swipe Down", Toast.LENGTH_SHORT).show();
            this.onSwipe.swipeBottom();
        }
        interface onSwipeListener {
            void swipeRight();
            void swipeTop();
            void swipeBottom();
            void swipeLeft();
        }
        onSwipeListener onSwipe;
    } 
```

并在您的 MainActivity 类中使​​用此代码：

```
 public class MainActivity extends AppCompatActivity {
        OnSwipeTouchListener onSwipeTouchListener;
        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            onSwipeTouchListener = new OnSwipeTouchListener(this, findViewById(R.id.relativeLayout));
        }
    } 
```

在`activity_main.xml`：

```
 <RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:id="@+id/relativeLayout"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:padding="16dp"
        tools:context=".MainActivity">

    </RelativeLayout> 
```****

# android - 典型的 android cpu 在应用程序和内核之间拆分

> ID：13095496
> 
> 赞同：0
> 
> 时间：2012-10-26T22:55:13.420
> 
> 标签：android, kernel, cpu

在执行典型的 cpu-bound 应用程序时，Android 上的内核 CPU 时间和 UserMode CPU 时间之间的典型划分是什么？

典型的双核 ARM 安卓手机，在执行普通应用时，不等待用户或网络的 io

更有帮助的是，如果系统库的用户模式部分和在应用程序实际代码中花费的时间之间的 cpu 时间分配有任何数据

（我意识到这是一个非常主观的问题，由于 jvm/jit 和其他功能而变得复杂，但任何指针（哈！；）都会有所帮助。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T02:15:47.677

嗯，这真的取决于应用程序。在 I/O 绑定的应用程序中，时间将花在系统调用上，例如`read`and `write`。在计算受限的应用程序中，CPU 时间几乎是所有用户空间。在一个受 RAM 限制的应用程序中（对 RAM 中的数据进行大量操作），由于缓存未命中，CPU 将花费大部分时间等待 RAM（我认为 ARM 处理器没有非常大的缓存）。

另一方面，如果你的应用程序做了很多 UI 工作，而所有的图形处理都是在用户空间中完成的，那么仍然有很多 I/O 绑定操作等待帧缓冲区和输入设备。

# c# - 如何在 MVC 控制器的帮助器类中执行重定向？

> ID：13095498
> 
> 赞同：1
> 
> 时间：2012-10-26T22:55:28.093
> 
> 标签：c#, asp.net-mvc

我有一些在多个控制器操作开始时运行的通用代码。我想将该代码重构为一个静态类，以促进该代码块的重用。

代码检查变量，查找 cookie，如果满足条件，代码应重定向到另一个页面（控制器/操作）。

问题是一切正常（包括 cookie 查找），但重定向不会触发。代码通过重定向并且重定向永远不会发生。

在辅助类中重定向的正确方法是什么？

这是现在的代码：

此行不起作用：**myController.HttpContext.Response.Redirect(redirectURL);**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace MyProject.WebUI
{
    public static class SessionValidationHelper
    {
        // helper class to encapsulate common routines to check for missing session data
        public static void SessionIdRequired(string id, Controller myController)
        {
            if (id == null || id == "")
            {
                // check cookie
                if (myController.ControllerContext.HttpContext.Request.Cookies.AllKeys.Contains("cookiename"))
                {
                    // if a session cookie was found, send to the registration recovery page
                    string sessionGuidCookieValue = "";
                    sessionGuidCookieValue = myController.ControllerContext.HttpContext.Request.Cookies["cookiename"].Value;

                    // check if GUID/SessionID exists in persistent cache

                    // send to Session Recovery
                    //myController.HttpContext.Response.RedirectToRoute("SessionRecovery", new { Controller = "SessionRecovery", Action = "Index", id = sessionGuidCookieValue });
                    string redirectURL = @"~/SessionRecovery/Index/" + sessionGuidCookieValue;

                    // this code isn't working
                    myController.HttpContext.Response.Redirect(redirectURL);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:06:31.640

您可以创建一个作为过滤器的属性并用它来装饰操作：（ *我已将您提供的代码放在属性中）*

```
public class SessionValidationAttribute : FilterAttribute, IAuthorizationFilter
{
    public void OnAuthorization(AuthorizationContext filterContext)
    {
       if (filterContext.Result == null)
       {
          var id = filterContext.RouteData.Values["id"] as string;
          if (id == null || id == "")
          {
            // check cookie
            if (filterContext.Controller.ControllerContext
               .HttpContext.Request.Cookies.AllKeys
               .Contains("cookiename"))
            {
                // if a session cookie was found,
                // send to the registration recovery page
                string sessionGuidCookieValue = "";
                sessionGuidCookieValue = filterContext.Controller
                    .ControllerContext.HttpContext.Request
                    .Cookies["cookiename"].Value;

                // check if GUID/SessionID exists in persistent cache

                // send to Session Recovery
                string redirectURL = @"~/SessionRecovery/Index/"
                        + sessionGuidCookieValue;

                // this code isn't working
                filterContext.Result = new RedirectResult(redirectURL);
            }
          }
       }
    }

    public abstract bool CanAccessResource(User user);
} 
```

在你的行动中，你这样做：

```
[SessionValidationAttribute]
public ActionResult MyAction()
{
     // code of the action
} 
```

或者，如果您想将其应用于类中的所有操作：

```
[SessionValidationAttribute]
public class MyController : Controller
{
     // code of the class, containing all actions
} 
```

或者如果你想全局应用这个（小心这个）：在你的 Application 类（继承的那个`System.Web.HttpApplication`，你可以这样做：

```
public class MvcApplication : System.Web.HttpApplication
{
    protected void Application_Start()
    {
        GlobalFilters.Filters.Add(new SessionValidationAttribute());

        // register routes
    }
} 
```

# python - Python中的Unicode - 只是UTF-16？

> ID：13095499
> 
> 赞同：9
> 
> 时间：2012-10-26T22:55:30.317
> 
> 标签：python, unicode, character-encoding, utf-16

当我需要向用户输出某些内容时，我知道我在使用 Unicode 和编码为 UTF-8 时，我对我的 Python 世界感到很高兴。然后，我的一位同事给我发[了“The UTF-8 Everywhere' manifesto”（2012 年）](http://utf8everywhere.org/)，这让我很困惑。

*   这篇文章的作者多次声称 UCS-2（Python 使用的 Unicode 表示）是 UTF-16 的同义词。
    *   他甚至直接说 Python 使用 UTF-16 进行内部字符串表示。
*   作者还承认自己是 Windows 爱好者和开发人员，并指出 MS 多年来处理字符编码的方式导致该组最困惑，所以也许这只是他自己的困惑。我不知道...

有人可以解释一下 UTF-16 与 Unicode 在 Python 中的状态吗？它们是同义词吗？如果不是，以什么方式？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-26T23:03:33.250

Python 中 Unicode 字符串的内部表示（从 2.2 到 3.2 的版本）取决于 Python 是在*宽*模式还是*窄*模式下编译的。大多数 Python 版本都很窄（您可以检查一下`sys.maxunicode`——窄版本上是 65535，宽版本上是 1114111）。

对于宽版本，字符串是 4 字节宽字符的内部序列，即它们使用 UTF-32 编码。所有代码点的长度都是一个宽字符。

在狭窄的构建中，字符串是使用 UTF-16 的 2 字节宽字符的内部序列。BMP 以外的字符（代码点 U+10000 及以上）使用通常的 UTF-16 代理对存储：

```
>>> q = u'\U00010000'
>>> len(q)
2
>>> q[0]
u'\ud800'
>>> q[1]
u'\udc00'
>>> q
u'\U00010000' 
```

请注意，UTF-16 和 UCS-2 并不相同。UCS-2 是一种固定宽度编码：每个代码点都被编码为 2 个字节。因此，UCS-2*不能*对超出 BMP 的代码点进行编码。UTF-16 是一种*可变宽度*编码；BMP 之外的代码点使用一对字符进行编码，称为代理对。

* * *

请注意，随着[PEP 393](http://www.python.org/dev/peps/pep-0393/)的实施，这一切都在 3.3 中发生了变化。现在，Unicode 字符串使用足够宽的字符来表示，以容纳最大的代码点——ASCII 字符串为 8 位，BMP 字符串为 16 位，否则为 32 位。当使用许多纯 ASCII 字符串时，这消除了宽/窄分隔并有助于减少内存使用量。

# javascript - jQuery Cycle 未在 IE8 中加载

> ID：13095505
> 
> 赞同：0
> 
> 时间：2012-10-26T22:56:17.727
> 
> 标签：javascript, jquery, jquery-cycle

有谁知道为什么在 IE8 的这个页面上没有加载 jQuery 循环？在 IE9 和所有其他现代浏览器中运行良好。我完全被难住了。我在其他页面上以类似的方式使用了 jQuery 循环，并且在 IE8 中很好：

[http://yatestaphouse.hhdev.hothousemarketing.com](http://yatestaphouse.hhdev.hothousemarketing.com)

# vb5 - SetFocus 导致运行时错误

> ID：13095510
> 
> 赞同：1
> 
> 时间：2012-10-26T22:56:41.917
> 
> 标签：vb5

我得到：
**运行时错误'5'：**
**无效的过程调用或参数**

这似乎发生在 Text(1).SetFocus 被调用时。

但是，对于我使用 SetFocus 的所有情况，我都没有看到此运行时错误。只有 2-3 个地方会导致此错误。

```
Text(1).SelStart = 3
Text(1).SelLength = 1
Text(1).SetFocus 
```

我试过了：

```
Text(1).Enabled = True  
Text(1).Visible = True 
```

就在.SelStart之上，但它并没有解决问题。

更新：

如果我使用调试器/VB5 IDE 运行应用程序，那么我看不到任何错误。但是当我创建 exe 并运行时，我看到了这个错误。

更新：即使我在做
Text(1).Enabled = True
Text(1).Visible = True
它没有用，但是当我做

```
If Text(1).Enabled And Text(1).Visible Then  
    Text(1).SetFocus
End If 
```

它没有显示运行时错误。不知道发生了什么。

# c - C中的memcmp，strcmp和strncmp有什么区别？

> ID：13095513
> 
> 赞同：53
> 
> 时间：2012-10-26T22:57:03.687
> 
> 标签：c, string, c-strings

我用 C 编写了一小段代码来测试 C 中的`memcmp()` `strncmp()` `strcmp()`函数。

这是我写的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main() {
        char *word1="apple",*word2="atoms";

        if (strncmp(word1,word2,5)==0)
                printf("strncmp result.\n");
        if (memcmp(word1,word2,5)==0)
                printf("memcmp result.\n");
        if (strcmp(word1,word2)==0)
                printf("strcmp result.\n");
} 
```

有人可以解释我的区别，因为我对这三个功能感到困惑吗？

我的主要问题是我有一个文件，我在其中标记了它的行，问题是当我标记文件中的“原子”一词时，我必须停止标记过程。

我第一次尝试`strcmp()`，但不幸的是，当它到达文件中放置“原子”一词的位置时，它并没有停止而是继续，但是当我使用 the`memcmp()`或 the`strncmp()`时它停止了，我很高兴。

但后来我想，如果有一个字符串的前 5 个字母是 a,t,o,m,s 并且后面跟着其他字母怎么办。

不幸的是，我的想法是正确的，因为我使用上面的代码通过初始化`word1`为“atomsaaaaa”和`word2`原子并且`memcmp()`在`strncmp()`if 语句中返回 0 来测试它。另一方面`strcmp()`，它没有。看来我必须使用`strcmp()`.

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2012-10-26T23:06:10.007

简而言之：

*   [`strcmp`](http://linux.die.net/man/3/strcmp)比较以 null 结尾的 C 字符串
*   [`strncmp`](http://linux.die.net/man/3/strcmp)比较最多 N 个以 null 结尾的 C 字符串的字符
*   [`memcmp`](http://linux.die.net/man/3/memcmp)比较 N 个字节的二进制字节缓冲区

所以，如果你有这些字符串：

```
const char s1[] = "atoms\0\0\0\0";  // extra null bytes at end
const char s2[] = "atoms\0abc";     // embedded null byte
const char s3[] = "atomsaaa"; 
```

那么这些结果成立：

```
strcmp(s1, s2) == 0      // strcmp stops at null terminator
strcmp(s1, s3) != 0      // Strings are different
strncmp(s1, s3, 5) == 0  // First 5 characters of strings are the same
memcmp(s1, s3, 5) == 0   // First 5 bytes are the same
strncmp(s1, s2, 8) == 0  // Strings are the same up through the null terminator
memcmp(s1, s2, 8) != 0   // First 8 bytes are different 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-26T23:03:27.010

`memcmp`比较多个字节。 `strcmp`之类的比较*字符串*。

您在示例中有点作弊，因为您知道两个字符串都是 5 个字符长（加上空终止符）。但是，如果您不知道字符串的长度（通常是这种情况）怎么办？好吧，您使用它`strcmp`是因为*它知道如何处理字符串*，`memcmp`但不知道。

`memcmp`都是关于比较字节序列的。如果您知道每个字符串有多长，那么是的，您可以使用`memcmp`它们来比较它们，但这种情况多久发生一次？很少。您经常需要字符串比较函数，因为……他们知道字符串是什么以及如何比较它们。

至于您遇到的任何其他问题，您的问题和代码都不清楚。请放心，尽管`strcmp`在字符串比较的一般情况下，这比现在更好`memcmp`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-07T10:55:08.057

## strcmp():

*   它用于比较存储在两个变量中的两个字符串，比较它们需要一些时间。所以它减慢了这个过程。

## strncmp():

*   它与前一个非常相似，但在这个中，它只比较前 n 个字符。这也减慢了这个过程。

## memcmp():

*   此函数用于使用它们的内存比较两个变量。它不会一一比较它们，它一次比较四个字符。如果你的程序太在意速度，我推荐使用 memcmp()。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-15T23:08:37.467

对于 strcmp，您只想比较您知道将是字符串的内容，但有时情况并非总是如此，例如读取二进制文件的行，您可能希望使用 memcmp 来比较某些包含的输入行NUL 字符但匹配，您可能希望继续检查输入的进一步长度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-10T09:40:01.433

strncmp 和 memcmp 是相同的，只是前者处理 NULL 终止的字符串。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-25T16:40:54.323

总结一下：

*   strncmp() 和 strcmp() 将 0 字节视为字符串的结尾，并且不进行比较

*   对于 memcmp()，一个 0 字节没有特殊意义

# ajax - 如何在 WordPress 插件中对 XML 提要进行跨域 GET？

> ID：13095516
> 
> 赞同：1
> 
> 时间：2012-10-26T22:57:28.000
> 
> 标签：ajax, json, wordpress, cross-domain

我想使用 AJAX 通过我的 wordpress 插件显示动态内容。数据源是来自远程域（不属于我）的 xml 提要。

我曾尝试使用使用 YQL 进行跨域 Ajax 调用的 JQuery 插件；但是，它们面向 json 并且倾向于以损坏的状态返回数据。

我的问题是，有没有办法使用 ajax 从远程域获取 xml 提要？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T19:49:28.227

So it turns out my YQL code wasn't quote correct. I ended up making a YQL request in my javascript successfully.

# r - How do I transform a single column list to item matrix in R?

> ID：13095519
> 
> 赞同：4
> 
> 时间：2012-10-26T22:58:01.400
> 
> 标签：r, transformation, etl

I currently have data that is in the following format (note, this is 1 column, 4 row matrix):

```
aa|bb  
bb|cc|ee|ee  
cc  
cc|ee 
```

and I want it displayed so that the column names are: aa, bb, cc, dd, and ee. And I want there to be 4 row such that each row counts the number of times each string was present in the matching row above.

ie)

```
aa bb cc dd ee  
 1  1  0  0  0  
 0  1  1  0  2  
 0  0  1  0  0   
 0  0  1  0  1 
```

Does anyone know how to do this in R? I would post my attempt, but it is just getting ugly and complicated. Any help would be much appreciated.

Thanks in advance.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T23:19:27.427

这是一个想法：

```
# (You'll use as.vector() on your matrix to get the vector x.)
x <- c("aa|bb", "bb|cc|ee|ee", "cc", "cc|ee") 

levs <- c("aa", "bb", "cc", "dd", "ee")
ll <- strsplit(x, "\\|")
t(sapply(ll, function(X) table(c(levs, X)))) - 1
#      aa bb cc dd ee
# [1,]  1  1  0  0  0
# [2,]  0  1  1  0  2
# [3,]  0  0  1  0  0
# [4,]  0  0  1  0  1 
```

这可以澄清（至少一点）最后一行代码的作用：

```
table(c(levs, c("dd", "cc", "cc", "cc"))) - 1
# 
# aa bb cc dd ee 
#  0  0  3  1  0 
```

# python - Restricted Permutations of Strings in Python

> ID：13095520
> 
> 赞同：2
> 
> 时间：2012-10-26T22:58:14.850
> 
> 标签：python, permutation

How can I do the following in Python?

Given two strings. Print all the interleavings of the two strings. Interleaving means that the if B comes after A, it should also come after A in the interleaved string. ex- AB and CD ABCD ACBD ACDB CABD CADB CDAB

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-26T23:04:47.820

这实际上是一个树行走问题（即，是否沿着一个字符串或另一个字符串前进的决策树）。通常，处理树行走问题的最简单方法是递归解决方案。

* * *

这是一个例子：

```
def ordered_permutations(str1, str2):
    perms = []
    if len(str1) + len(str2) == 1:
        return [str1 or str2]
    if str1:
        for item in ordered_permutations(str1[1:], str2):
            perms.append(str1[0] + item)
    if str2:
        for item in ordered_permutations(str1, str2[1:]):
            perms.append(str2[0] + item)
    return perms 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T00:16:32.177

向@Amber 致敬，感谢他发现了问题并给出了非常优雅的解决方案。

这是我的两分钱（只是打印出答案）：

```
def interleave(L1, L2, answer=None):
    if answer is None:
        answer = ''
    if not L1 and not L2:
        print answer
    else:
        if L1:
            a = answer + L1[0]
            interleave(L1[1:], L2, a)
        if L2:
            ans = answer + L2[0]
            interleave(L1, L2[1:], and)

>>> interleave('ab', 'cd')
abcd
acbd
acdb
cabd
cadb
cdab 
```

希望这可以帮助

# windows - WindowsPhone App data connection FAILS in MarketPlace published App but WORKS in Visual Studio development (same XAP)

> ID：13095521
> 
> 赞同：2
> 
> 时间：2012-10-26T22:58:18.560
> 
> 标签：windows, windows-phone-7, marketplace

Tearing my hair out(!)

My last App update has been accepted and released by MarketPlace but the remote server data connection does NOT work/connect from the downloaded App (from MarketPlace).

However, the same App (the accepted XAP) when I'm running it from Visual Studio, using the same remote server address works just fine.

WHY!... Has anyone else ever run into anything like this?

Here's the remote path: [http://www.streamcommunication.com/ZenAwaken/DownloadableCollections.xml](http://www.streamcommunication.com/ZenAwaken/DownloadableCollections.xml)

*   I can load that to a browser and retrieve the XML
*   When I'm in Visual Studio I can connect via that path and retrieve the file and consume the data
*   BUT!! The exact same XAP which has been accepted and distributed by Windows Phone marketplace FAILS.

Is it possible that MarketPlace does something (encryption?) to the XAP that would corrupt the path string?

Any thoughts or experiences would be very helpful!

Tom

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T06:11:18.897

验证应用程序是否实际发送请求的最佳方法是使用调试代理来检查请求。这是一个非常简单的过程。以下是步骤-

1) 下载并安装 Fiddler 并将其设置为从 Tools->Fiddler Options->Connections 充当远程主机的代理

2) 下载 Connectify 并运行它以从您的笔记本电脑设置无线热点

3）将您的Windows手机连接到这个wifi网络并将代理设置为（您的计算机名称），端口设置为8888

4) 现在运行你的应用程序，看看你的应用程序发出了什么请求。您还可以检查给出的响应。

让我们知道您的结果，以便我们进一步帮助您。

# linux - non-blocking socket client connection

> ID：13095522
> 
> 赞同：0
> 
> 时间：2012-10-26T22:58:19.137
> 
> 标签：linux, timeout, nonblocking, winsock2, qnx

ALL, I am looking for a simple example of non-blocking socket connection that will run on Windows. I tried to Google, but all samples are either for *nix (POSIX) or blocking sockets on Windows.

Looking thru msdn I see that it is easy to make a socket non-blocking and issue a connect(), but then you need some preparation in order to put the socket back.

So, all in all I need something on a non-blocking socket that will connect and then put it back to be blocking. The read and write operation should be performed on the blocking socket.

The reason for a non-blocking socket is that I need a connection timeout and there is no other way than non-blocking socket. Or is there?

Thank you.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T13:14:27.063

使用[ACE](http://en.wikipedia.org/wiki/Adaptive_Communication_Environment) [套接字包装外观](http://www.cs.wustl.edu/~schmidt/PDF/wrapper-facade.pdf)并充分应用您的 Linux 知识。

# iphone - Button not moving on my interface

> ID：13095524
> 
> 赞同：0
> 
> 时间：2012-10-26T22:58:23.607
> 
> 标签：iphone, objective-c, xcode

I'm making an app and i'm trying to get a button to move to certain coordinates depending on the screen size of the phone (4, 4S, 5, etc). I have correct syntax but the button will not move at all. Here is the part of my .m ViewController file:

```
- (void)viewDidLoad
{
    if([[UIScreen mainScreen] respondsToSelector:NSSelectorFromString(@"scale")])
    {
        if ([[UIScreen mainScreen] scale] < 1.1) {
            CGRect frame = done.frame;
            frame.origin.x = 129; //New x coordinate
            frame.origin.y = 401; //New y coordinate
            done.frame = frame;
            [done setNeedsDisplay];
            NSLog(@"Standard Resolution");
        }
        if ([[UIScreen mainScreen] scale] > 1.9) {
            NSLog(@"High Defenition Resolution");
        }
    }

    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
} 
```

The `NSLog` is triggering in the console saying `Standard Resolution`, but the button doesn't move from where I placed it in the XIB file. This may be a small stupid mistake but hopefully you can help me anyways.

P.S. Yes, I did link my `IBOutlet` to the button.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T02:27:32.543

If you started this project in iOS 6 / Xcode 4.5, Autolayout will be on by default. See my post on this topic here: [UIButton does not move if called after addSubView](https://stackoverflow.com/questions/12925698/uibutton-does-not-move-if-called-after-addsubview/13080365#13080365)

# actionscript-3 - Load all images from internal application

> ID：13095525
> 
> 赞同：0
> 
> 时间：2012-10-26T22:58:31.500
> 
> 标签：actionscript-3, flash, flex4, adobe, flash-builder

I am trying to load all the .png files from an internal application folder into a list control and I am stuck on exactly how to do it. I have tried httpservice to get the folder and count how many images there are so I can loop through them but I just cant figure that out.

File structure

```
-src
    -(default package)
        -my application files
    -icons
        -all my .png files 
```

httpService i tried:

```
<s:HTTPService id="loadAllImages" destination="/icons" result="gotImages(event)" fault="loadAllImagesFault(event)"/> 
```

This always results in directory not found. Am I going about this completely wrong? Anyone have a suggestion?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:13:28.280

你不能这样做。要将图像存储在 Flash 应用程序（SWF 或 AIR）中，您**必须**`@Embed('')`使用MXML 或使用 [Class] 方法将其嵌入。

在 AIR 应用程序中实际显示内部文件夹的文件夹目录的唯一方法是使用 File（这是一个 AIR 专用类）。

```
var file:File = File.applicationDirectory;
file.browseForDirectory('icons'); ; //unsure if that will pull an internal folder or not, but you get the idea 
```

如果这是一个外部目录（听起来不像），我相信你会按照你在问题中显示的方式去做（虽然我从来不需要使用这种方法，所以我不知道它是否/如何工作)

# java - Eclipse 如何检测代码中的错误

> ID：13095529
> 
> 赞同：6
> 
> 时间：2012-10-26T22:59:26.337
> 
> 标签：java, eclipse

我想知道 Eclipse 在编译之前如何检测 Java 代码中的错误。

我从提到和解的 Eclipse 论坛中找到[了这个答案](http://www.eclipse.org/forums/index.php/m/645745/)。但这并不能告诉我它是如何工作的。

是否通过使用正则表达式将代码与 Java 规范进行比较来完成错误和警告检测？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T23:31:11.017

当您更改代码中的某些内容时，这些更改将表示为增量。通过创建 AST（抽象语法树）和[JDT](https://www.eclipse.org/jdt/overview.php)查找错误来分析增量。如果有，则生成错误标记。

[这](https://wiki.eclipse.org/CDT/designs/Overview_of_Parsing)是 C/C++ 的 CDT 解析器如何工作的一个很好的解释。JDT 解析器应该以同样的方式工作。

# biztalk - 在重新部署业务流程时管理暂停/脱水的实例

> ID：13095532
> 
> 赞同：1
> 
> 时间：2012-10-26T22:59:47.000
> 
> 标签：biztalk, biztalk-2010, biztalk-orchestrations

设想：

biztalk 应用程序部署有接收端口、编排和发送端口。消息正确流动。

在某个时候，在编排中发现了一个错误，导致消息挂起。必须修复和重新部署编排。

问题：

因为您无法重新部署具有暂停实例的编排，您将如何保留这些消息、终止实例​​、重新部署然后通过固定编排重新发送这些消息？有这方面的流程或工具吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T05:13:13.250

如果该错误不需要进行重大修改——即没有新的编排、没有新的模式、没有新的提升字段等，那么短期的“破解”是可能的，即只需在您的服务器上重新安装固定的 MSI（和 GAC），并重新启动主机实例（如果适用，使用 NLB）（即不将 MSI 导入 BizTalk）。

然后，您应该能够恢复任何暂停（可恢复）的 orch。然后在不那么忙的时候安排一些停机时间，让你的应用程序部分停止以防止新的 orchs 启动，等待所有正在运行的 orchs 完成，然后导入修复的 MSI（考虑使用修补程序提升有问题的 orch 程序集版本）

构建一个能够审核所有进出 Biztalk 的消息的自定义工具很有用，因此您可以重播它们。这将允许您终止 orchs，重新安装，然后重播。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T18:00:25.120

您也可以修复编排，并在构建它时增加程序集的版本。这样，您可以并行部署编排。您可以在部署较新版本的编排后取消注册现有的编排。

# javascript - Firefox 15 中的完整日历 eventDrop 触发 eventClick

> ID：13095533
> 
> 赞同：3
> 
> 时间：2012-10-26T22:59:49.900
> 
> 标签：javascript, firefox, fullcalendar

我不知道要对以下代码进行哪些更改才能使其在 Firefox 15 中运行：

```
 eventDrop: function (event, dayDelta) {
        updateCalendarEvent(event.id, dayDelta);
        //Firefox 15 fires eventClick for no good reason???
    },
    eventClick: function (event) {
        alert('event click');
        if (event.url) {
            alert(event.url);
            vUrl = '../Activities/' + event.url;
            openActivityAddEditDialog(vUrl, 'Edit Activity');
            return false;
        }
    }, 
```

我做了相当多的研究，这绝对是一个BUG。代码在 Chrome、Safari、Firefox 14 甚至 IE 中都能正常工作——但在 Firefox 15 中却不行。已经快 2 个月了，而且还没有修复的迹象。

有人在这里发布了关于解决方法的黑客攻击： [http ://code.google.com/p/fullcalendar/issues/detail?id=1523](http://code.google.com/p/fullcalendar/issues/detail?id=1523)

另一个类似的未回答的 Full Calendar Firefox SO 问题： [Full Calendar event hyperlinks automatically fire in Firefox](https://stackoverflow.com/questions/12923099/full-calendar-event-hyperlinks-automatically-fire-in-Firefox)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T11:57:30.383

当您在事件中包含“url”属性时，JSON FullCalendar 会将事件呈现为`<a>`链接而不是`<div>`.

看起来 Firefox 将拖放`<a>`视为单击并跟随 URL。这会导致 AJAX 请求被中断并返回`status=0`，如下所述： [https ://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest?redirectlocale=en-US&redirectslug=Using_XMLHttpRequest#XMLHttpRequests_being_stopped](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest?redirectlocale=en-US&redirectslug=Using_XMLHttpRequest#XMLHttpRequests_being_stopped)

就我而言（Firefox 18），这会导致“您离线！请检查您的网络”警告消息。

将“url”属性重命名为“targetUrl”会导致事件被呈现为`<div>`解决问题。然后，您需要修改 eventClick 处理程序以相应地使用新属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-27T00:24:13.100

您还将有一些这样的事件数据：

```
events: [

{id: '76',title: 'Hot Shave',data: 'Some data',start: new Date(2012,9, 17, 13 , 55),end: new     Date(2012,9,17, 13 , 115),allDay: false, url: '<someurl>'}
], 
```

将显示“url：”的事件更改为“workingurl：”并将您的 eventclick 代码更新为：

```
eventClick: function (event) {
        alert('event click');
        if (event.workingurl) {
            alert(event.workingurl);
            vUrl = '../Activities/' + event.workingurl;
            openActivityAddEditDialog(vUrl, 'Edit Activity');
            return false;
         }
    }, 
```

这应该会阻止 FF 基于 url: 属性触发点击，然后该属性不再存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T19:57:21.210

即使在 fullcalendar.js 中为所有函数设置断点后——错误仍然发生，并且在 eventDrop 完成后没有完整的日历函数被触发——但重定向仍然发生。

仅在 Firefox 15 中！

也更改为早期版本的 jquery - 但没有区别。

我最近看到了一些关于 Firefox 15 和 drop 事件错误的帖子，但没有什么特别适用于此。

有没有人有这个问题？

如果没有 - 有没有办法只为 Firefox 用户禁用拖放功能？

# php - 登录时更新数据库行

> ID：13095535
> 
> 赞同：0
> 
> 时间：2012-10-26T23:00:10.643
> 
> 标签：php

我有以下代码：它的目的非常明确=>在登录更新数据库时使用+1登录为totallogins并记录最后一次登录的时间。唯一的缺点是它不会工作。

```
<?php

date_default_timezone_set('Europe/Amsterdam'); 

if (isset($_POST['formsubmitted'])) {
$Timesloggedin = "SELECT * FROM members.Timesloggedin WHERE Email='$email'";
$time = date("Y-m-d H:i:s"); 
$query1 = "UPDATE members SET Timesloggedin = $Timesloggedin + 1, Lastloggedin = $time WHERE Email ='$email'";

$result_insert_loggedins = mysql_query($query1);
if (!$result_insert_loggedins) {
    echo 'Query failed';
}

if (mysql_affected_rows($dbc) == 1) 
{ 
    //If the Insert Query was successfull.
} 
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:03:31.187

你可以使用

```
Timesloggedin = Timesloggedin + 1 
```

而不是变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T23:03:32.640

```
$query1 = "UPDATE members SET Timesloggedin = Timesloggedin + 1, Lastloggedin = '$time' WHERE Email ='$email'"; 
```

请记住 $time 是一个字符串并且需要引号。此外， $Timesloggedin 将是一个对象（如果您实际上运行了您没有运行的查询），因此只需删除 $ 它只会增加该字段。

此外，您甚至不需要第一个查询。您也不需要日期计算。只需使用mysql的NOW() ...

```
$query1 = "UPDATE members SET Timesloggedin = Timesloggedin + 1, Lastloggedin = NOW() WHERE Email ='$email'"; 
```

# asp.net - HttpApplicationState.Lock 究竟做了什么？

> ID：13095542
> 
> 赞同：3
> 
> 时间：2012-10-26T23:01:13.617
> 
> 标签：asp.net, application-state

我的应用程序在应用程序状态中存储了两个相关的数据位。每次我读取这两个值时，我可能（取决于它们的值）都需要更新它们。

因此，为了防止在另一个线程正在读取它们时更新它们，我锁定了应用程序状态。

但是[HttpApplicationState.Lock 方法](http://msdn.microsoft.com/en-us/library/system.web.httpapplicationstate.lock%28v=vs.100%29.aspx)的文档并没有确切地告诉我它的作用。

例如：

1.  它是如何锁定的？它会阻止任何其他线程写入数据吗？

2.  它是否也阻止读取访问？如果不是，那么这个练习是没有意义的，因为这两个值可以在另一个线程读取第一个值之后但在它读取第二个值之前更新。

*除了防止多个线程同时写入数据外，还有助于防止一个线程在另一个线程正在写入时读取；否则，第一个线程可能认为它需要在不需要时刷新数据。我想限制执行刷新的次数。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:08:21.873

查看代码仅锁定写入，而不是读取。

```
public void Lock()
{
    this._lock.AcquireWrite();
}
public void UnLock()
{
    this._lock.ReleaseWrite();
}
public object this[string name]
{
    get
    {
        return this.Get(name);
    }
    set
    {
        // here is the effect on the lock
        this.Set(name, value);
    }
}
public void Set(string name, object value)
{
    this._lock.AcquireWrite();
    try
    {
        base.BaseSet(name, value);
    }
    finally
    {
        this._lock.ReleaseWrite();
    }
}

public object Get(string name)
{
    object obj2 = null;
    this._lock.AcquireRead();
    try
    {
        obj2 = base.BaseGet(name);
    }
    finally
    {
        this._lock.ReleaseRead();
    }
    return obj2;
} 
```

写入和读取是线程安全的，这意味着已准备好锁定机制。因此，如果您进行读取数据的循环，则可以将其锁定在外部以防止其他破坏列表。

阅读这个答案也很好：[Using static variables instead of Application state in ASP.NET](https://stackoverflow.com/questions/10960695/using-static-variables-instead-of-application-state-in-asp-net/10964038#10964038)

最好避免使用应用程序来存储数据，并直接使用带有锁定机制的静态成员，因为首先MS建议这样做，其次因为对应用程序静态数据的读/写是调用每次访问的锁定数据。

# c# - 重载方法..为什么基类优先？

> ID：13095544
> 
> 赞同：5
> 
> 时间：2012-10-26T23:01:36.610
> 
> 标签：c#, c#-4.0

在下面的代码中，我有一个重载方法，一个采用 ClazzA 类型的参数，另一个采用 ClazzB 类型的参数。在所示代码中，调用了第一个 GetDescription 方法（以 ClazzA 作为参数的方法）。我想我明白为什么。
我的问题是..如果底层对象的类型为 classB（无需检查每个对象并将其转换为 clazzB），是否有一种优雅的方法可以首先调用 clazzB 的方法？

```
public class ClazzA
{
    public virtual string Descr { get { return "A"; } }
}

public class ClazzB : ClazzA
{
    public override string Descr { get { return "B"; } }
}

public static class test
{
    public static void Main()
    {
        ClazzA test = new ClazzB();
        GetDecription(test);
    }

    public static void GetDecription(ClazzA someClazz)
    {
        Debug.WriteLine("I am here");
    }

    public static void GetDecription(ClazzB someClazz)
    {
        Debug.WriteLine("I want to be here");
    }
} 
```

输出：“我在这里”

我真的希望调用第二种方法，因为“测试”是 ClassB 类型。目前我仅有的两个解决方案是：

1.  if (test is ClazzB) return GetDescription( (ClazzB) test );

或者

1.  在 ClassA 中做几乎相同的事情...检查类型并委托给第二个方法

这两者都需要检查对象以确定其类型

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-27T01:50:50.847

重载是在编译时确定的。引用的编译时类型`ClazzA`是选择重载。您所要求的与多次调度有关。C# 和许多其他语言（如 C++ 和 Java）仅支持单一调度（通过`virtual`方法）。人们想出了很多方法来解决这个问题。最纯粹的 OO 方式是访问者模式。您修改类以包含一个方法 ( `Accept`)，然后将`this`引用传递给访问者 ( `Visit`) 上的方法。这是有效的，因为您覆盖了`Accept`每个子类中的方法，这样这`this`将是对象的实际类型。所有访问者需要的是您想要支持的每个子类的特定方法（有关更多详细信息，请参见[维基百科](http://en.wikipedia.org/wiki/Visitor_pattern)）。

一个样品：

```
public class ClazzA
{
   public virtual string Accept(ClassVisitor visitor)
   {
      return visitor.Visit(this);
   }
}

public class ClazzB : ClazzA
{
   public override string Accept(ClassVisitor visitor)
   {
      return visitor.Visit(this);
   }
}

public abstract class ClassVisitor
{
  public abstract string Visit(ClazzA a);
  public abstract string Visit(ClazzB b);
}

public class GetDescriptionVisitor : ClassVisitor
{
    public override string Visit(ClazzA a)
    {
       return "A";
    }

    public override string Visit(ClazzB b)
    {
       return "B";
    }
} 
```

用法：

```
ClassVisitor visitor = new GetDescriptionVisitor();
ClazzA b = new ClazzB();
Console.WriteLine(b.Accept(visitor)); // prints "B" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-27T02:17:56.553

因为方法重载决议发生在编译时。在处理这种情况方面，如果您使用的是 C# 4，那么您可以使用动态，以便将重载解决方案推迟到执行时。

```
dynamic instance = new ClazzB();
Console.WriteLine(GetDescription(instance)); 
```

或者，您可以使用类似以下的访问者模式，但这种*双重调度*方法感觉工作量很大。注意必须在每个派生类型中重新实现的重复访问方法！

```
public interface IVisitable
{
    string Visit(DescriptionVisitor visitor);
}

public class ClazzA : IVisitable
{
    public virtual string Visit(DescriptionVisitor visitor)
    {
        return visitor.Visit(this);
    }
}

public class ClazzB : ClazzA
{
    public override string Visit(DescriptionVisitor visitor)
    {
        return visitor.Visit(this);
    }
}

public class DescriptionVisitor
{
    public string Visit(ClazzA item) { return "Description A"; }
    public string Visit(ClazzB item) { return "Description B"; }
} 
```

那么下面的内容最终还是会调用DescriptionVisitor中的重载，取ClazzB。

```
var visitor = new DescriptionVisitor();
ClazzA a = new ClazzB();
Console.WriteLine(a.Visit(visitor)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T23:11:00.750

您尝试做的可能是使用多态性更好地执行，如下所示：

```
public interface IProvideDescription { 
  string GetDescription();
}

public class A : IProvideDescription {
  public string GetDescription() {
    return "I'm an A";
  }
}

public class B : IProvideDescription {
  public string GetDescription() {
    return "I'm a B";
  }
}

// to execute:

IProvideDescription x = new A();
Console.WriteLine(x.GetDescription());
x = new B();
Console.WriteLine(x.GetDescription()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T23:18:43.077

要回答标题中的问题（“...为什么优先考虑基类？”），请查看您的变量`test`声明为什么（答案：您的基类）。选择重载时，方法调用所知道的就是您将一个类型的变量传递给`ClazzA`它。当然，您已经为它分配了一个类型的对象`ClazzB`，但假设您的赋值语句更复杂：

```
ClazzA test = GiveMeSomeObject(); 
```

方法选择必须在编译时进行以提供类型安全。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-27T00:06:36.813

您可以使用 .Net 4.0 中引入的“动态”关键字来获得所需的行为。它在运行时评估类型并选择正确的重载。

```
public static class test
{
    public static void Main()
    {
        dynamic test = new ClazzB();
        GetDecription(test);
    }

    public static void GetDecription(ClazzA someClazz)
    {
        Debug.WriteLine("I am here");
    }

    public static void GetDecription(ClazzB someClazz)
    {
        Debug.WriteLine("I want to be here");
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-27T07:29:58.623

通常，识别类类型不是外部类的责任。如果您需要多态行为，只需将 GetDescription 作为虚函数放入 ClassA 中，然后在 ClassB 中覆盖 - 这在概念上是正确的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-26T23:08:28.767

正如@roken 提到的，您的示例实际上会导致`B`该`Descr`属性被覆盖。如果这就是您所做的一切，请删除`ClazzB`重载并使用您已经拥有的多态行为。`dynamic`如果您确实需要在方法中做一些不同的事情并且重载是最好的方法，您可以通过重载决议来做到这一点：

```
GetDecription((dynamic)test); 
```

但是，这有一些缺点，例如性能和缺乏`GetDescription(test)`有意义的编译时测试。我建议在以下范围内进行运行时检查`GetDecription(ClazzA)`：

```
if (someClazz is ClazzB)
{
    GetDescription((ClazzB)someClazz);
    return;
} 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-10-26T23:05:47.003

您只需一种`GetDescription()`方法即可：

```
public String GetDescription(ClassA in) {
    if (in is ClassB) {
        return (in as ClassB).Descr 
    }

    return in.Descr;
} 
```

# wpf - 数据模板绑定不正确

> ID：13095546
> 
> 赞同：0
> 
> 时间：2012-10-26T23:01:57.943
> 
> 标签：wpf, xaml

我有以下代码绑定到工具提示数据模板中的属性：

```
<Window x:Class="WpfConcepts.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       xmlns:telerikGrid="clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.GridView"
    xmlns:telerikData="clr-namespace:Telerik.Windows.Data;assembly=Telerik.Windows.Data"
    xmlns:telerikGridview="clr-namespace:Telerik.Windows.Controls.GridView;assembly=Telerik.Windows.Controls.GridView"
    xmlns:telerikInput="clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.Input" Width="200" Height="480">
    <Grid>
        <Grid.ColumnDefinitions>  
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <telerikGrid:RadGridView Grid.Column="0" Grid.Row="0" x:Name="FXRateGridView" ItemsSource="{Binding CarList}" ScrollViewer.HorizontalScrollBarVisibility="Visible" ScrollViewer.VerticalScrollBarVisibility="Visible" ColumnWidth="*" MinColumnWidth="50" AutoGenerateColumns="False">
            <telerikGrid:RadGridView.Columns>
                <telerikGrid:GridViewDataColumn>
                    <telerikGrid:GridViewDataColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Name}">
                                <TextBlock.ToolTip>
                                    <ToolTip>
                                        <DataTemplate>
                                            <StackPanel>
                                                <TextBlock Text="{Binding Path=Colour}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ToolTip>
                                </TextBlock.ToolTip>
                            </TextBlock>
                        </DataTemplate> 
                    </telerikGrid:GridViewDataColumn.CellTemplate>
                </telerikGrid:GridViewDataColumn>
            </telerikGrid:RadGridView.Columns>
        </telerikGrid:RadGridView>
    </Grid>
</Window> 
```

工具提示显示为“System.Window.DataTemplate”，这不是预期的效果，因为我期望的是 Color 属性值。如果我没有在 ToolTip 中使用数据模板，那么我会得到正确的值，我假设我的使用 DataTemplate 不正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T12:28:10.023

如果您想重用工具提示，请在其中创建一个实例并在`Window Resources`需要的任何地方使用它，使用`StaticResource`如下 -

```
<Window>
....
<Window.Resources>
   <ToolTip x:Key="ColourToolTip">
      <StackPanel>
          <TextBlock Text="{Binding Path=Colour}"/>
      </StackPanel>
   </ToolTip>
</Window.Resources> 
```

像这样在您的模板中使用此资源-

```
<TextBlock Text="{Binding Name}"
           ToolTip="{StaticResource ColourToolTip}"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T10:26:03.913

不需要DataTemplate，只需使用以下内容：

```
<ToolTip>
  <TextBlock Text="{Binding Path=Colour}"/>
</ToolTip> 
```

# python - django模型将类别添加到对象

> ID：13095548
> 
> 赞同：1
> 
> 时间：2012-10-26T23:02:19.990
> 
> 标签：python, django, web

```
class Venues(models.Model):
        ..........
        ..........
        category=models.ForeignKey(Category)

class Category(models.Model):
     club=models.CharField()
     bar=models.CharField()
     adult=models.CharField() 
```

这些是我拥有的模型。我是 django 新手，所以请原谅这个相当简单的问题。我希望每个 Venue 对象都有一个从类别列表中选择的类别（即俱乐部、酒吧或成人）。所以每个类别——俱乐部、酒吧、成人——可以有很多场地，但就像我说的每个场地都有一个类别。

所以我完全接近我想要完成的事情还是这完全错误？请帮忙。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:08:40.673

您`Category`可以有一个称为`type`该类型的字段，可以是字符串“俱乐部”、“酒吧”、“成人”。您也可以只拥有一个带有 char 字段的 Venue 并为其提供一组固定[选择](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.Field.choices)。因此，正如您所看到的，已经有几种方法可以接近您设置数据库的方式。场地可以有多个类别吗？如果是这样，您可能想使用[多对多](https://docs.djangoproject.com/en/dev/ref/models/fields/#manytomanyfield)字段。我认为现在的问题之一是，如果您想添加一个新类别，则必须在代码中手动添加它。如果您选择`Category`只提供类型字段，则用户可以从管理员添加新类别而无需更改任何代码。

如果您想知道如何将类别实际添加到 Venue，您首先需要获取类别实例。这可以通过检索数据库中已有的数据库或创建一个新数据库来完成

```
category = Category.objects.get(pk=1) 
```

接下来，您可以使用该类别创建一个新场地

```
new_venue = Venue(category=category, other_args)
new_venue.save() 
```

将使用该类别保存一个新场地。Django[文档](https://docs.djangoproject.com/en/dev/ref/models/instances/?from=olddocs)提供了很好的参考。

# ruby-on-rails - 在jquery自动完成中选择一个条目后发生了什么？

> ID：13095556
> 
> 赞同：0
> 
> 时间：2012-10-26T23:03:41.180
> 
> 标签：ruby-on-rails, jquery-ui, autocomplete

我们有一个带有 jquery 自动完成功能的 rails 3.2.8 应用程序。用户从列表中选择客户名称后，应用程序应触发事件 (#invoice_customer_name_autocomplete)。选择后，将触发 ajax 更改事件。这就是应用程序应该做的所有事情。但是下面的代码不能完成这项工作（错误：“t.item.customer is undefined”）。用户甚至无法选择。文本框不会输入客户名称并且屏幕卡住：

```
//for autocomplete
$(function() {
  return $('#invoice_customer_name_autocomplete').autocomplete({
    minLength: 1,
    source: $('#invoice_customer_name_autocomplete').data('autocomplete-source'),
    select: function(event, ui) {
        $('#invoice_customer_name_autocomplete').val(ui.item.customer.name);
    },
  });
}); 

$(document).ready(function (){
    $('#invoice_customer_name_autocomplete').change(function (){
      //ajax call
      $.get(window.location, $('form').serialize(), null, "script");
      return false;
    });
}); 
```

如果手动更改客户名称，将触发 .change 事件。但是选择后它不会触发。上面的代码有什么问题？

更新：如果选择可以触发 invoice_customer_name_autocomplete 上的更改事件，那么这就是我们想要的。尝试以下代码但未成功（未触发更改事件）：

```
select: function(event, ui) {
   $(this).trigger('change');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:59:39.837

您可能正在使用我无法确定的[jQuery Autocomplete 插件，但您调用它的方式与调用](http://docs.jquery.com/Plugins/Autocomplete)[jQuery UI autocomplete](http://jqueryui.com/demos/autocomplete/)的方式相同。

如果您使用的是第一个

建议：

1.  在 jQuery UI 中使用自动完成而不是自动完成插件。后者已弃用。

在这里使用正确的框架是它工作的一个例子： [jsFiddle](http://jsfiddle.net/felipeclopes/eRtZd/3/)

它与您的没有什么不同，所以问题是您应该记录 ui 对象以了解您访问空对象的原因，最简单的方法是登录控制台并观察整个对象。

```
console.log(ui) 
```

**编辑：**

关于 onChange 您可以查看这篇文章：[手动触发 onchange 事件](https://stackoverflow.com/questions/2856513/trigger-onchange-event-manually)

希望能帮助到你！

# c# - 给定两组数字，找出总和相等的最小集合

> ID：13095557
> 
> 赞同：9
> 
> 时间：2012-10-26T23:03:51.860
> 
> 标签：c#, algorithm, set

我正在开发一个应用程序，该应用程序需要根据各种标准匹配两组数据，包括每组中任意数量的项目的总和。我已将问题提炼为以下陈述：

给定一组项目和交易，找到总和等于最小交易集总和的最小项目集。（我忽略了这篇文章的一些复杂性，但现在我只关心匹配的总金额，而不是日期、描述、清算差异等）

或者，在数学上：给定两组数字，从每组中找出总和相等的最小集合。

我遇到的其他类似的 SO 问题假设您提前知道总和，或者知道您要购买的每组的数量。

这是一个测试，（我认为）说明了我的目标。

```
 [TestMethod]
    public void StackOverflowTest()
    {
        var seta = new[]{10, 20, 30, 40, 50};
        var setb = new[]{ 45, 45, 100, 200 };

        var result = Magic(seta, setb);

        Assert.AreEqual(new[]{40,50},result.SetA);
        Assert.AreEqual(new[] { 45, 45 }, result.SetB);
    }
    class MagicResult
    {
        public int[] SetA { get; set; }
        public int[] SetB { get; set; }

    }
    private MagicResult Magic(int[] seta, int[] setb)
    {
        throw new NotImplementedException();
    } 
```

我正在寻找一个优雅的解决方案，可以通过，但会接受任何让我到达那里的伪代码或建议；）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T23:19:36.553

蛮力：

```
 var result = (from a in seta.Subsets()
               from b in setb.Subsets()
               where a.Count() > 0 && b.Count() > 0
               where a.Sum() == b.Sum()
               orderby a.Count() + b.Count()
               select new MagicResult { SetA = a.ToArray(), SetB = b.ToArray() }
              ).First(); 
```

使用[EvenMoreLINQ 项目](http://morelinq.googlecode.com/svn/branches/EvenMoreLINQ/MoreLinq/Subsets.cs)中的 Subsets 方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T23:56:48.707

这可以使用动态规划`O(nW)`及时解决，其中 W 是最大和的大小。解决两个集合的[背包问题](https://en.wikipedia.org/wiki/Knapsack_problem)，为每个集合生成一个数组，其中包含所有可能的总和并跟踪使用的项目数量。然后，比较每个数组中的相等和以找到每个数组的最小值

未经测试，但这就是想法。

```
arr1dp = [None]*W;  arr1dp[0] = 0;
arr2dp = [None]*W;  arr2dp[0] = 0;

# knapsack arr1
for i in range(len(arr1)):
    for cur_item in arr1:
        if (arr1dp[cur_item] is not none):
             arr1dp[cur_item+i] = min(arr1dp[cur_item]+1,arr1dp[cur_item])

# do the same for arr2
# omitted for brevity

# find the smallest match
for i in range(W):
    if arr1dp[i] is not none and arr2dp[i] is not none:
         min_val = min(min_val,arr1dp[i]+arr2dp[i]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T23:19:53.213

如果两个集合包含一个共同的数字，则存在大小为 1 的解。

如果不是，请尝试所有两个数字的总和（有 N-choose-two，或`N*(N-1)/2`在每个集合中）。将它们与单数和双数和的集合进行比较。

如果不满意，尝试所有三个数字的总和，将它们与 1、2 或 3 数字的总和进行比较；依此类推，直到尝试了所有总和（对于一组大小为 N 的 2**N）。

这是工作代码，一旦找到解决方案就会停止搜索。（相同数量的和数可能会更小）。它在 python 中，但这实际上是伪代码:-)

```
from itertools import combinations

# To allow lists of different sizes: ensure list1 is never the short one
if len(list1) < len(list2):
    list1, list2 = list2, list1

def found(val, dict1, dict2):
    print "Sum:", val
    print "Sum 1", dict1[val]
    print "Sum 2", dict2[val]

def findsum(list1, list2):
    # Each dict has sums as keys and lists of summands as values.
    # We start with length 1:
    dict1 = dict()
    dict2 = dict()

    for n in range(1, max(len(list1), len(list2))+1):
        # Check all size n sums from list1 against size < n sums in list2
        for nums in combinations(list1, n):
            s = sum(nums)
            if s in dict1:  # Is this sum new for our list?
                continue

            dict1[s] = nums
            if s in dict2:   
                found(s, dict1, dict2)
                return   # If you want to look for a smallest sum, keep going

        # If list2 is too short, nothing to do
        if len(list2) < n:
            continue

        # Check all size n sums from list2 against size <= n sums in list1
        for nums in combinations(list2, n):
            s = sum(nums)
            if s in dict2:  # Is this sum new for our list?
                continue

            dict2[s] = nums
            if s in dict1:
                found(s, dict1, dict2)
                return   # If you want to look for a smallest sum, keep going

findsum(list1, list2) 
```

这旨在以最少的比较次数找到解决方案。如果您还希望总和最小，则在每个大小 n 一次生成所有 n 部分总和，对它们进行排序并按升序检查它们。

# javascript - “var links = [].slice.apply(document.getElementsByTagName('a'));”是什么意思 真的吗？

> ID：13095559
> 
> 赞同：1
> 
> 时间：2012-10-26T23:03:59.550
> 
> 标签：javascript, arrays, apply, slice, getelementsbytagname

我不明白这是如何工作的：

```
var links = [].slice.apply(document.getElementsByTagName('a')); 
```

它创建了一个空数组，但我没有完全得到其余的。在这个脚本中一起做什么`slice`和真正做什么？`apply`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:06:18.417

`document.getElementsByTagName()`和类似的 DOM 方法返回一个类似数组的结构，一个节点列表，而不是一个真正的数组。这是将其转换为真正数组的常用技巧。它也常与`arguments`特殊变量（另一种类似数组的结构）一起使用。Array 对象的`slice`方法通常需要一个数组，并返回一个数组，但是这样你可以传入一些技术上不是数组的东西。一个更易读，可以说更好的版本是这样的：

```
Array.prototype.slice.apply(document.getElementsByTagName('a')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T23:05:52.920

这基本上将从 getElementsByTagName 检索到的 nodeList 对象转换为常规 javascript 数组，以便能够在其上使用数组方法。

# simulation - 如何从未知的空间过程中生成样本？

> ID：13095562
> 
> 赞同：1
> 
> 时间：2012-10-26T23:04:31.360
> 
> 标签：simulation, spatial, montecarlo

广场上有一些未知的空间过程。如果我只有点之间的平均距离分布 - 任何通用模型或简单的想法，如何在正方形上生成点的随机样本？如果我有这种过程的一些实现的距离矩阵〜500个观察结果会有用吗（实现过程的点之间的距离矩阵）？

时间维度在这里没有用，我没有关于这个过程的任何时间数据。

# expressionengine - ExpressionEngine 插件中的未定义变量错误

> ID：13095563
> 
> 赞同：1
> 
> 时间：2012-10-26T23:04:36.297
> 
> 标签：expressionengine

我正在开发一个基于外部库进行设备检测的插件。

这是我到目前为止所拥有的：

```
class Deetector {

// public $return_data;

/**
 * Constructor
 */
public function __construct()
{
    $this->EE =& get_instance();
    $this->EE->load->add_package_path(PATH_THIRD.'/deetector');
    $this->EE->load->library('detector');
    $this->return_data = "";
}

public function deetector()
{
    return $ua->ua;
}

public function user_agent()
{
    return $ua->ua;
}

// ----------------------------------------------------------------

/**
 * Plugin Usage
 */
public static function usage()
{
    ob_start();

    $buffer = ob_get_contents();
    ob_end_clean();
    return $buffer;
}
} 
```

如果我调用 {exp:deetector} 我在模板中没有输出。如果我调用 {exp:deetector:user_agent} 我得到*Undefined variable: ua*。

最终，我不打算为 Detector 库返回的每个变量设置不同的函数，但我只是想让它现在输出一些东西。

我最初是作为一个扩展开始这样做的，它将检测器库的变量添加到全局变量数组中，并且工作正常；只是自从尝试将其作为插件进行操作后，我才遇到了问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:09:14.043

你还没有设置`$this->ua`任何东西。我假设它是您加载的检测器库的变量，因此您可能想要执行以下操作：

```
class Deetector {
    public function __construct()
    {
        $this->EE =& get_instance();

        // remove this line, it's probably not doing anything
        // $this->EE->load->add_package_path(PATH_THIRD.'/deetector');

        $this->EE->load->library('detector');

        // note you use $this->return_data instead of "return blah" in the constructor
        $this->return_data = $this->EE->detector->ua;
    }

    // remove this, you can't have both __construct() and deetector(), they mean the same thing
    // public function deetector()
    // {
    //     return $ua->ua;
    // }

    public function user_agent()
    {
        return $this->EE->detector->ua;
    }
} 
```

**更新：**

我查看了[Detector docs](https://github.com/dmolsen/Detector/wiki/Adding-&-Using-Detector-With-Your-Application)，它不遵循正常的库约定（它在包含文件时定义了 $ua 变量）。出于这个原因，您应该忽略标准的 EE 加载函数，并直接包含该文件：

```
class Deetector {
    public function __construct()
    {
        $this->EE =& get_instance();

        // manually include the detector library
        include(PATH_THIRD.'/deetector/libraries/detector.php');

        // save the local $ua variable so we can use it in other functions further down
        $this->ua = $ua;

        // output the user agent in our template
        $this->return_data = $this->ua->ua;
    }
} 
```

# facebook-graph-api - 使用 API 密钥查找应用程序的所有者

> ID：13095566
> 
> 赞同：1
> 
> 时间：2012-10-26T23:04:50.323
> 
> 标签：facebook-graph-api, api-key

有人为我工作的组织构建了一个应用程序，但没有人记得它是谁，我们需要对应用程序进行更改。我们拥有的唯一信息是 API 密钥。我们尝试通过在[http://www.facebook.com/apps/application.php?id=XXXX](http://www.facebook.com/apps/application.php?id=XXXX)添加密钥来导航到应用程序页面，但我们被重定向回我们的网站。有没有办法我们可以找出谁在管理应用程序？也许使用图形 API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:17:16.667

我几乎可以肯定你不能使用它。我会导航到应用程序本身，在页面底部的右侧，“ctrl+f”进行查找，然后单击“报告/联系此应用程序”，然后向开发人员发送消息。

# ios - AVQueuePlayer 和多个视频播放和时间范围

> ID：13095576
> 
> 赞同：0
> 
> 时间：2012-10-26T23:06:21.983
> 
> 标签：ios, video, avqueueplayer

对 ios 编程有点陌生。尝试使用 AVQueuePlayer 并在列表中播放多个视频。我已经搜索过并且没有看到我想要实现的相关示例。这是一个很容易回答的问题，如果能指出我正确的方向的话。

我想要做的是真正按顺序播放列表中的视频。因此，查看 AVQueuePlayer 和 AVPlayerItem 似乎应该符合要求。我知道如何使用它来背靠背播放多个视频，因为大多数示例都显示了这是如何完成的。我想要的是加载一个播放器项目并将其限制在文件中的某个时间。例如，我会加载一个 3 分钟长的视频文件，并且只想查看 1:20 到 1:35 的时间。我见过的所有示例都加载了整个文件。必须有一种方法可以做到这一点，而我还没有看到一个很好的例子。

我还希望 AvPlayerItems 可能是同一个视频文件，但它们播放的时间范围与视频文件不同。所以本质上我是从任意数量的视频文件中播放列表中的视频时间范围，但这些视频文件可能是列表中的相同源文件。例如：

视频列表和播放时间

```
(seq    Video            Time)

1      video 1          0-30 secs   ---
2      video 2          45-60 secs  ---
3      video 3          120-130 secs  ---
4      video 2          3-12  --- 
5      video 3          30-40 ---
6      video 1          31 - 40 
```

我已经查看了 AvQueuePlayer 的苹果开发人员参考资料，但还没有弄清楚。我敢肯定，你们当中有一些经验丰富的人已经做到了这一点，并且可以为我指出一些很好的例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T19:11:30.973

经过大量搜索和观看来自苹果的 WWDC 视频后，我的问题的答案是使用 AVComposition，它允许您使用多个视频源并将它们组合成一个轨道，您可以按照您想要的任何顺序播放。

一个很好的例子是在 iTunes 中观看 WWDC 2010 视频并观看名为 Editing Media with AVFoundation 的会议。在演示文稿中有一个很好的示例项目，他们使用称为 AVEditDemo。它将为您提供开始所需的示例代码。

# java - com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException：连接关闭后不允许操作，但没有 tcp 套接字重置

> ID：13095580
> 
> 赞同：0
> 
> 时间：2012-10-26T23:06:45.340
> 
> 标签：java, mysql, jdbc, c3p0

我的应用程序出现错误：

```
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: No operations allowed after connection closed.
        at sun.reflect.GeneratedConstructorAccessor281.newInstance(Unknown Source)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
        at com.mysql.jdbc.Util.handleNewInstance(Util.java:406)
        at com.mysql.jdbc.Util.getInstance(Util.java:381)
        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:984)
        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:956)
        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:926) 
```

当我的应用程序看到该错误时，它会自动重试该操作。但是当我做了一个 tcpdump 时，我没有看到当时创建了任何新的 tcp 连接。看起来使用了相同的 tcp 连接。那么为什么我会得到例外？我的应用程序使用 c3p0 连接池，我在签入前将 c3p0 设置为测试连接。mysql 驱动程序或 c3p0 是否有任何设置来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T14:10:52.190

单独的 testConnectionOnCheckin 不足以确保连接不会在池中超时。如果池不是很忙，连接可能会无限期地保持签入和空闲状态。testConnectionOnCheckin 应与 idleConnectionTestPeriod 结合使用，以便也定期验证空闲连接。

见[http://www.mchange.com/projects/c3p0/#configuring_connection_testing](http://www.mchange.com/projects/c3p0/#configuring_connection_testing)

祝你好运！

# iphone - 重新分配代表的影响

> ID：13095582
> 
> 赞同：0
> 
> 时间：2012-10-26T23:06:58.427
> 
> 标签：iphone, objective-c, ios, ipad, delegates

我正在寻找多次分配代表的效果（如果有的话）？考虑到我没有将委托分配给另一个视图控制器，在 viewWillAppear 中分配一个委托是不好的做法吗？

它只是我的一个类的一个简单的自定义委托。我在我的 tabBar 的一个视图中需要委托，但在另一个视图中不需要。而且由于我一直在 viewWillAppear 中分配它，并且每次更改选项卡时都会调用 viewWillAppear，我只是想知道是否有一些不需要的效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:25:50.340

不，在你描述的情况下应该没有问题。但这取决于分配委托时您的代码执行的操作。如果这是一个简单的属性分配，没有自定义实现属性的“setter”方法，那么你没有问题。但是，如果您为属性编写了自己的“setter”方法并且实现执行了其他操作，那么这些其他操作可能会成为问题。

无论哪种方式，您都可能希望考虑将分配移至`viewDidLoad`方法。好像 iOS 6 这只会被调用一次。在 iOS 5 或更早版本下，它可以被多次调用，但`viewDidUnload`在这种情况下也会被调用。

# php - 如何从某个位置填充数组

> ID：13095585
> 
> 赞同：0
> 
> 时间：2012-10-26T23:07:23.063
> 
> 标签：php

例如我有一个数组：

```
$array = array(25, 50, 75, 100); // I get an array of some numbers
$position = 50; // I get some value to start with
$limit = 3; // I need to fill another array with 3 next values from the starting position 
```

现在我需要使用什么代码来填充一个新数组，就像这样：

```
$new_array = array(75, 100, 25); // the start position is 50, but I need the next 3 
```

有任何想法吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:21:42.480

您可以使用[array_search](http://www.php.net/manual/en/function.array-search.php)来查找关键字在数组中的位置。[% 算术运算符](http://php.net/manual/en/language.operators.arithmetic.php)，用于在到达结束后转到第一个元素。休息是你的逻辑。

```
<?php
    $array = array(25, 50, 75, 100);
    $position = 10;
    $limit = sizeof($array)-1;

    $pos = array_search($position, $array);;

    if(!($pos === false))
    {
        for($i=0;$i<$limit;$i++)
        {
            $pos = (($pos+1)%sizeof($array));
            echo $array[$pos]."<br>";
        }
    }
    else
    {
        echo "Not Found";
    }
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T23:39:18.500

我喜欢有抽象逻辑的函数。所以我建议写一个函数，它接受数组、开始的位置和限制：

```
<?php
function loop_array($array,$position,$limit) {

    //find the starting position...
    $key_to_start_with = array_search($position, $array);
    $results = array();

    //if you couldn't find the position in the array - return null
    if ($key_to_start_with === false) {
        return null;
    } else {
            //else set the index to the found key and start looping the array
        $index = $key_to_start_with;
        for($i = 0; $i<$limit; $i++) {
                    //if you're at the end, start from the beginning again
            if(!isset($array[$index])) {
                $index = 0;
            }
            $results[] = $array[$index];
            $index++;
        }
    }
    return $results;
} 
```

因此，现在您可以使用所需的任何值调用该函数，例如：

```
$array = array(25, 50, 75, 100);
$position = 75;
$limit = 3;

$results = loop_array($array,$position,$limit);

if($results != null) {
    print_r($results);
} else {
    echo "The array doesn't contain '{$position}'";
} 
```

输出

```
Array
(
    [0] => 75
    [1] => 100
    [2] => 25
) 
```

或者你可以用任何其他值循环它：

```
$results = loop_array(array(1,2,3,4,5), 4, 5); 
```

这是一个工作示例：[http ://codepad.org/lji1D84J](http://codepad.org/lji1D84J)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T23:24:51.980

您可以使用[array_slice()](http://www.php.net/manual/en/function.array-slice.php)和[array_merge()](http://www.php.net/manual/en/function.array-merge.php)来实现您的目标。

假设你知道 50 的位置是 2。

那么你可以通过 -

```
array_slice(array_merge(array_slice($array, 2), array_slice($array, 0, 2)), 3); 
```

基本上，您从起始位置获得两个子数组，连接在一起，然后删除拖尾部分。

# maven - 托管私有 Maven 存储库的任何 SaaS 解决方案

> ID：13095589
> 
> 赞同：8
> 
> 时间：2012-10-26T23:07:41.887
> 
> 标签：maven, nexus, archiva

是否有任何 SaaS 解决方案来托管 Maven 存储库？

我知道我可以自己在 Nexus 或 Archiva 或 Artifactory 上托管它，只是想知道是否有负担得起的提供商允许以低成本托管一些依赖项，而无需自己安装存储库。

我正在寻找一个可以保证良好可用性并保持工件私有的在线 maven 存储库主机。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-27T09:05:39.187

我认为[CloudBees](http://www.cloudbees.com/)提供私有的 Maven 存储库。你应该试一试。

# type-inference - 具有静态、结构类型和全局类型推断的命令式语言

> ID：13095590
> 
> 赞同：4
> 
> 时间：2012-10-26T23:08:03.657
> 
> 标签：type-inference, static-typing, imperative-programming, structural-typing

我知道像 Haskell 这样的语言是静态类型的并且具有类型推断。但是是否存在具有全局类型推断的非函数式语言，相当于具有类型推断和结构类型的 C 语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:29:34.263

OCaml 不再是唯一的竞争者。近年来出现了许多结构类型的命令式语言：

*   [F#](http://fsharp.org)与[OCaml](http://ocaml.org)一样，是一种多范式语言，支持复杂的模式匹配以及命令式和函数式编程。作为 OCaml 的派生语言，这两种语言实际上非常相似，[除非存在细微的功能差异，否则它们实际上是源代码兼容的](https://stackoverflow.com/questions/179492/f-changes-to-ocaml)。主要的 [dis?] 优点是它在 .NET 上运行。
*   [Go](http://golang.org)是最初的 Unix / Plan 9 / Inferno 团队自他们进入 Google 以来的挚爱，基于他们在这些系统的编译器上数十年的工作。Go 支持结构多态性，因为对象组合是它的主要子类型机制，并且方法接口不需要显式实现。
*   [Haxe](http://haxe.org)是一种 ActionScript 衍生产品，可编译到各种令人印象深刻的平台，包括 C++ (!)。它支持完全结构化的类型和枚举（相当于 OCaml 联合）以及 C# 样式的对象层次结构，并拥有一个复杂的宏系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T06:50:45.527

**OCaml**是我所知道的唯一一个可以是命令式/面向对象的，它是静态类型的、垃圾收集的并支持全局类型推断和结构类型，尽管它本质上是一种函数式语言。

Scala 不是像 OCaml 这样的函数式语言，而是一种支持结构类型的命令式/面向对象的语言，但没有[您正在寻找的类型推断](https://stackoverflow.com/questions/4304003/what-does-no-global-type-inference-mean-regarding-scala)。不过，它仍然支持函数式构造。

如果“非功能性”是指一种根本不支持函数式编程的语言，那么我认为没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-26T16:29:09.820

还有 Crystal，但它处于 pre-alpha 阶段：

[https://github.com/manastech/水晶](https://github.com/manastech/crystal)

# php - 使用 php DOMDocument() 获取多个 span 标签值并将它们插入 mysql db

> ID：13095597
> 
> 赞同：1
> 
> 时间：2012-10-26T23:09:04.060
> 
> 标签：php, domdocument

我需要使用 php 从 span 标签中获取多个值，例如：

```
 <div>
    <span class='name'>name value</span>
    <span class='city'>city name</span>
    <span class='street'>street name</span>
    <span class='phone'>+17240000000</span>
    </div>
  <div>
   <span class='name'>name value 2</span>
   <span class='city'>city name 2</span>
   <span class='street'>street name 2</span>
   <span class='phone'>+17240000000 2</span>
  </div> 
```

我必须使用跨度类获取跨度值，我尝试使用此代码来获取该值，并且它仅适用于 1 个值，例如“名称”：

```
<?
$html = "<div>
         <span class='name'>name value</span>
         <span class='city'>city name</span>
         <span class='street'>street name</span>
         <span class='phone'>+17240000000</span>
         </div>
         <div>
         <span class='name'>name value 2</span>
         <span class='city'>city name 2</span>
         <span class='street'>street name 2</span>
         <span class='phone'>+17240000000 2</span>
         </div>";
$dom = new DOMDocument();
@$dom->loadHTML($html);
$dom_xpath = new DOMXPath($dom);

$entries = $dom_xpath->evaluate("//span[@class='name']");
foreach ($entries as $entry) {
   echo  $entry->nodeValue."<br />";
}
?> 
```

有没有人可以帮助我修改代码，以便我可以获得所有值

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:06:58.147

尝试改变

```
......
$dom = new DOMDocument();
@$dom->loadHTML($html);

foreach($dom->getElementsByTagName('span') as $span){
  echo $span->nodeValue . '<br>';
  //echo $span->getAttribute('class');
} 
```

基于上述格式，您可能想尝试一下（假设 className 永远不会改变并且始终存在）

```
......
$dom = new DOMDocument();
@$dom->loadHTML($html);

$result = array();
foreach ($dom->getElementsByTagName('div') as $div){
    $temp = array();
    foreach($div->getElementsByTagName('span') as $span){
        $temp[$span->getAttribute('class')] = $span->nodeValue; 
    }

    // db insert here
    // You may want to do some error check before inserting the data by making sure the array key exist 
    // need to escape data (SQL_injection)
    //mysql_query("INSERT INTO db (`name`,`city`,`street`,`phone`) VALUES('{$temp['name']}','{$temp['city']}','{$temp['street']}','{$temp['phone']}')");

    $result[] = $temp;

}

print_r($result); 
```

您需要在将值插入 db（sql 注入）之前对其进行转义，并且需要更有效地进行批量插入 - 阅读更多内容，[通过 php 数组将多行插入 mysql](https://stackoverflow.com/questions/779986/insert-multiple-rows-via-a-php-array-into-mysql)和[http://en.wikipedia.org/wiki /SQL_injection](http://en.wikipedia.org/wiki/SQL_injection)

**或者**

```
 $entries = $dom_xpath->evaluate("//span[@class='name']") 
```

到

```
 $entries = $dom_xpath->evaluate("//span") 
```

# xml - 站点地图中的不同语言

> ID：13095600
> 
> 赞同：0
> 
> 时间：2012-10-26T23:09:21.250
> 
> 标签：xml, sitemap

我在同一个域上有两种不同的语言，如下所示：

```
www.mydomain.com/about (english)
www.mydomain.com/se/om (swedish) 
```

可以在同一个站点地图（www.mydomain.com/sitemap.xml）中列出所有页面吗？

# ruby-on-rails - 在 Ubuntu 12.10 中为 rails 3.2.8 设置路径

> ID：13095602
> 
> 赞同：0
> 
> 时间：2012-10-26T23:09:28.537
> 
> 标签：ruby-on-rails, ruby, ubuntu, path, rvm

我对 Ubuntu 完全陌生，我正在尝试完成 Ruby On Rails 的安装，到目前为止，我已经安装了 Ruby 1.9.3 并将其设置为默认值，当我打开一个新终端时，我安装了 Rails 3.2.8无法识别我的 Rails 安装，我通过寻求帮助了解到我需要在 bashrc 文件中设置路径。

我遇到的 2 个问题是试图了解我的路径是什么以及如何将其输入到 bashrc 文件中（如何找到该文件或在终端中使用命令来设置路径）

这是我的 Ruby 和 Rails 安装位置

```
andrew@andrew-laptop:~$ sudo updatedb
[sudo] password for andrew: 
andrew@andrew-laptop:~$ locate rails|grep -e "bin/rails$"
/home/andrew/.rvm/gems/ruby-1.9.3-p286/bin/rails
/home/andrew/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/bin/rails 
```

我试过了，但没有任何改变

```
andrew@andrew-laptop:~$ export PATH=$PATH:/home/andrew/.rvm/gems/ruby-1.9.3-p286/bin 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T05:28:26.943

您在 ubuntu 上，因此这些步骤很可能应该解决：

1.  [https://rvm.io/integration/gnome-terminal/](https://rvm.io/integration/gnome-terminal/)
2.  关闭并打开新的终端窗口
3.  `rvm use 1.9.3 --default --install`
4.  `gem install rails`

访问[https://rvm.io](https://rvm.io)了解更多详情

# javascript - 小提琴作品但不在现场

> ID：13095605
> 
> 赞同：-4
> 
> 时间：2012-10-26T23:09:39.157
> 
> 标签：javascript, jquery, css

小提琴：[小提琴](https://plus.google.com/u/0/photos/115394849300833601650/albums/5803757570985447105/5803757623376512034)

代码：[图片](https://plus.google.com/u/0/photos/115394849300833601650/albums/5803757570985447105/5803757623376512034)

</body> </html>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:11:33.763

您在小提琴中使用 jQuery，但您必须确保在 HTML 代码中加载了 jQuery。这通常是代码在 jsFiddle 上运行但在您自己的站点上运行的情况。

# javascript - jQuery.each 实现不同于原生 Array.forEach

> ID：13095607
> 
> 赞同：21
> 
> 时间：2012-10-26T23:09:45.410
> 
> 标签：javascript, jquery, api, foreach, each

有谁为什么其他优秀的`jQuery.each`功能与（现在）原生的设计不同`Array.forEach`？前：

```
var arr = ['abc','def'];
arr.forEach(function(entry, index) {
    console.log(entry); // abc / def
}); 
```

这是绝对有道理的。但是 jQuery 选择将`index`第一个参数作为第一个参数：

```
$.each(arr, function(index, entry) {
   console.log(entry);
}); 
```

有谁知道这个设计决定背后的原因？我一直`$.each`广泛使用，但它总是困扰着我，索引是第一个参数，因为它很少使用。我知道 jQuery 通过实现直接引用，`this`但如果你这样做会很混乱：

```
​var arr = ['abc','def'];
$.each(arr, function() {
    console.log(this === 'abc'); // false both times, since this is a String constructor
});​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

并不是说它让我很困扰，我更喜欢使用原生 polyfills 来处理最常见的新数组函数，但我一直对设计决策感到好奇。`forEach`也许它是在浏览器实现本机和旧版支持阻止他们更改它之前在旧时代制作的，或者......？

或者，它是这样设计的，因为它也可以用于本机对象，然后在回调中将键放在值之前“有意义”......？

旁注：我知道 underscore.js（可能还有其他库）以相反的方式（更类似于本机函数）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-26T23:16:06.183

好吧，我想我们必须向雷西格先生本人寻求解释。事实上，在设计和开发 jQuery 时，*ECMAscript 262 第 5 版*并不是很普及，所以这肯定会发挥作用。而且由于它是这样设计的，他们不想在以后更改它并破坏所有现有代码。

实际上，您更可能希望访问具有更高优先级的元素，而不是在循环*Array*时访问它的索引。所以，对我来说，没有合理的解释为什么你会首先将*索引*传递给回调。

请放心，如果今天发明了 jQuery，它们将遵循本机实现行为。

另一方面，如果它给您带来太多困扰，您可以简单地创建一个快捷方式并使用本机`Array.prototype.forEach`来迭代您的 jQuery 包装集：

```
var forEach = Function.prototype.call.bind( Array.prototype.forEach );

forEach( $('div'), function( node ) {
    console.log( node );
}); 
```

..对于标准*Arrays*，只需使用其原生原型即可。

在实现条件返回假/真时，我们必须知道哪个部分以哪种方式工作。当您在 Array.prototype.forEach 中使用带有条件的 return false 时，它​​被视为继续，但是当您使用 return false 时，在 $.each 中带有条件时，它被视为 break 语句。

```
var listArray = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];
var arr1 =[];var arr2=[];
var rv = true;
listArray.forEach(function(i, item) {
  if (i == 5) {
    return rv = false;
  }
 arr1.push(i)
  return rv;
});
var listArray = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];
jQuery.each(listArray, function(i, item) {
  if (item == 5) {
    return rv = false;
  }
  arr2.push(i)
});
  console.log("forEach=>"+arr1)
  console.log("$.each=>"+arr2)
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-26T23:26:34.630

这实际上在上次 jQuery conf 中提到过；不幸的是，我不记得细节了，但是如果您从中观看了足够多的视频，我想您会找到它（我*认为*这是在主题演讲之后的问答期间，但不要引用我的话）。无论如何，有人（我不认为是 Resig 本人，而是另一位 jQuery 组织的高级成员）基本上说“jQuery 有一些我们都知道有问题的东西（“每个”都是他们给出的例子之一）但是有数百万那里的网站现在依赖于这种有问题的行为，所以我们现在无法改变它。”

所以本质上，答案是他们做出了一个错误的决定（Resig 是一个令人难以置信的程序员，但即使他也不完美）现在每个使用 jQuery 的人都必须在剩下的时间里受苦，因为该库在新版本（让我们面对现实吧，这是一件好事：您不希望每次升级 jQuery 时都必须重新编写整个站点）。

还值得一提的是，Underscore 库*确实*有一个`each`与内置的签名相同的方法`each`。事实上，Underscore 的版本实际上使用了内置版本（如果存在），为了获得更好的性能，如果浏览器不支持内置的`each`. 由于 jQuery 对象只是数组，您可以轻松地将它们与`_.each`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T23:26:45.880

好吧，我同意使用`key`第二个更有意义，但是您必须记住`$.each`，可以与对象或数组一起使用，对于对象，您可能需要键，因为它们有意义。

# java - Java：顺序排序名称并保存到随机访问文件中

> ID：13095614
> 
> 赞同：0
> 
> 时间：2012-10-26T23:11:37.793
> 
> 标签：java, file, sorting, names, sequential

我正在尝试制作一个可以添加名称的程序，并且它应该保存在`RandomAccessFile`, （按字母顺序）中。每当我添加一个名称时，它都会保存在一个文件中，它应该在末尾有下一个名称的下一个对应位置。每当我添加一个以 A 开头的名称时，我都会遇到保存问题，然后我添加一个带有 C 的名称，如果我在哪里添加一个以 B 开头的名称，它并没有按正确的字母顺序指向我。

这是程序应该做什么的一个例子：

我添加了一个以 A 开头的名称。

“左侧”的数字是下一个名称的开始位置，“右侧”的数字是指向下一个名称的指针

[0]-----A----[-1] ------------“-1”指针表示它的列表末尾

我添加了一个以 C 开头的名称。

[0]-----A----[100] --------“100”指针表示下一个名称“C”从字节100开始

[100]---C----[-1] --------- 列表指针的结尾，注意 A 不再有“-1”指针

我添加了一个以 B 开头的名称。

[0]-----A----[200] ------ "A" 不再指向 100，因为下一个字母应该是 "B"

[100]---C----[-1] -------- -1 仍然表示“C”是列表指针的结尾

[200]---B----[100] ---------“B”指向“C”，因为后面的下一个字母

到目前为止，这是我的代码，但我错过了添加属于列表中间的名称的部分。

公共布尔添加（字符串名称，字符串姓氏，字符串telf）{

```
 try {
        fileSize = file.length();
    } catch (IOException ex) {
        ex.printStackTrace();
    }
    if (fileSize == 0) { //must be a new entry

        try {

            byte entry[] = new byte[sizeEntry];  // size of each entry
            file.write(entry);
            file.seek(file.getFilePointer() - sizeEntry);

            file.writeUTF(name);   //name gets saved
            file.writeUTF(lastName);// last name gets saved
            file.writeUTF(telf);    // telf gets saved
            file.writeUTF("N");     // deleted "Y" or "N" gets saved
            file.writeUTF("-1");    // pointer gets saved

        } catch (IOException e) {
            System.out.println("Error at saving....");
            e.printStackTrace();
        }

    } else {
        pPresent= 0;     //variable for the pointer reading
        pPrevious= 0; // variable for the pointer read

        try {
            file.seek(0); //start reading at the top
            do {
                pPresent= file.getFilePointer();//saves present pointer
                file.seek(pPresent);//seeks to present pointer
                nameRead = file.readUTF();  //reads name
                file.readUTF();  //reads last name
                file.readUTF();  //reads telf
                file.readUTF();  //reads deleted?
                pNext= Long.parseLong(file.readUTF()); // reads the next pointer

                int comparison= name.compareTo(nameRead);
                if (comparison< 0) {

                    //enters here if the new entry goes before the present entry
                    if (pNext!= -1) {
                        file.seek(pNext);//enters here if pointer is not at end of list
                    } else {
                        try {// proceeds to writing a new entry 

                            file.seek(file.length()); //goes to the end of the file
                            byte entry[] = new byte[sizeEntry];
                            file.write(entry);
                            file.seek(file.getFilePointer() - sizeEntry);

                            file.writeUTF(name);
                            file.writeUTF(lastname);
                            file.writeUTF(telf);
                            file.writeUTF("N");
                            file.writeUTF(Long.toString(pPrevious));//writes the previous pointer

                            file.seek(pPrevious);//seeks to the previous entry
                            file.readUTF();//reads name
                            file.readUTF();//reads lastname
                            file.readUTF();//reads telf
                            file.readUTF();//reads deleted?
                            file.writeUTF(Long.toString(pPrevious));//overwrites the new previous

                        } catch (IOException e) {
                            System.out.println("Error at saving...");
                            e.printStackTrace();
                        }
                        break;//exits
                    }
                } else {//enteres here if the entry is bigger than the present

                    if (pNext!= -1) {
                        file.seek(pNext);
                    } else {
                        try {

                            pPresent= file.length()-sizeEntry;//saves present entry
                            file.seek(pPrevious); //seeks to previous entry
                            file.readUTF();//reads name
                            file.readUTF();//reads last name
                            file.readUTF();//reads telf
                            file.readUTF();//reads deleted
                            file.writeUTF(Long.toString(pPresent+100));//overwrites the next pointer

                            file.seek(file.length());//seeks at the end
                            byte entry[] = new byte[sizeEntry];//creates a new entry
                            file.write(entry);
                            file.seek(file.getFilePointer() - sizeEntry);

                            file.writeUTF(name);//writes name
                            file.writeUTF(lastname);//writes lastname
                            file.writeUTF(telf);//writes telf
                            file.writeUTF("N");//writes deleted
                            file.writeUTF(Long.toString(pNext));//writes next pointer

                        } catch (IOException e) {
                            System.out.println("Error at saving...");
                            e.printStackTrace();
                        }
                        break;//exits
                    }
                }
                pPresent= file.getFilePointer();//present pointer read
                pPrevious= pPresent;//present pointer becomes previous
            } while (true);

        } catch (IOException e) {

            System.out.println("Error at saving....");
            e.printStackTrace();
        }
    }
    return false;
} 
```

我希望你们现在通过源代码更好地理解程序的想法。我不知道该怎么做的部分是我添加一个属于列表中间的条目。请记住，名称的顺序不会仅更改指向下一个的指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:45:19.623

查找插入点需要遍历列表，而这又需要对每个名称进行磁盘访问。假设您有 100 万个名称，典型的磁盘访问时间为 10 毫秒，插入单个名称大约需要 3 小时。换句话说，链表是一种极其不适合在磁盘上存储数据的数据结构。

一个合理的数据结构（例如[B 树](http://en.wikipedia.org/wiki/B-tree)）将允许在 3 次磁盘访问中查找和插入 100 万个名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T23:12:04.513

哟要开发一个计算指针的方法，我前几天开发了一个代码：

```
public int getNext(String lastName){

    int auxNext=0;
    int auxActual=0;
    byte[] relleno= new byte[100];

    try{

        int Next=-1;

        while(auxNext!=-1){                                             

            auxActual=auxNext;              
            myRaf.seek(auxNext);
            String auxPreviousLastName=myRaf.readUTF();

            auxNext=Integer.valueOf(myRaf.readUTF());

            if(auxNext!=-1){

                myRaf.seek(auxNext);
                String auxApellido=myRaf.readUTF();

                String aux=myRaf.readUTF();

                if(lastName.compareTo(auxLastName)<0){                          

                    Next=auxNext;                                       
                    myRaf.seek(auxActual);                                  
                    myRaf.write(relleno);
                    myRaf.seek(auxActual);
                    myRaf.writeUTF(auxPreviousLastName);                        
                    myRaf.writeUTF(String.valueOf(myRaf.length()));
                    return Next;                                            

                }

            }else{                                                          

                updateEnds();
                return -1;                                                  

            }

        }

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return -1;

}

public void updateEnds(){       //This method search the last register, and updates that reference

    byte[] relleno= new byte[100];

    try {
        for (int i = 0; i < myRaf.length(); i+=100) {               

            myRaf.seek(i);
            String auxLastName=myRaf.readUTF();             
            String next=myRaf.readUTF();

            if (next.equals("-1")) {                                    

                myRaf.seek(i);                                          
                myRaf.write(relleno);                                   
                myRaf.seek(i);                                          
                myRaf.writeUTF(auxLastName);
                myRaf.writeUTF(String.valueOf(myRaf.length())); 

            }

        }
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

} 
```

PD，对不起，我的英文写作不如你。

# php - php字符串替换为str_replace问题

> ID：13095616
> 
> 赞同：-1
> 
> 时间：2012-10-26T23:12:10.763
> 
> 标签：php, string

我创建了一个函数，通过从数组中放入新单词来替换字符串中的单词。

这是我的代码

```
function myseo($t){
    $a = array('me','lord');
    $b = array('Mine','TheLord');    
    $theseotext = $t;
    $theseotext = str_replace($a,$b, $theseotext);
    return $theseotext;
}

echo myseo('This is me Mrlord'); 
```

输出是

> 这是我的

应该打印是错误的

> 这是我的先生

因为单词 (Mrlord) 不包含在数组中。

我希望我能很好地解释我的问题。任何帮助家伙

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:16:49.517

改为使用`str_ireplace`，它不区分大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T23:14:36.447

根据代码它是正确的，但您希望它按单词隔离。你*可以*简单地这样做：

```
function myseo($t){
    $a = array(' me ',' lord ');
    $b = array(' Mine ',' TheLord ');    
    return str_replace($a,$b, ' '.$t.' ');
}

echo myseo('This is me Mrlord'); 
```

请记住，这是一种廉价的黑客攻击，因为我用空格包围替换字符串以确保双方都得到考虑。这不适用于标点字符串。另一种方法是拆分字符串并单独替换每个单词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T23:15:03.607

`str_replace`不只查看完整的单词 - 它查看任何匹配的字符序列。

因此，`lord`匹配 的后半部分`Mrlord`。

# file-io - 使用 PrintStream (java 1.4) 在文件中获取格式化输出

> ID：13095617
> 
> 赞同：0
> 
> 时间：2012-10-26T23:12:24.463
> 
> 标签：file-io, formatting, java1.4

我必须在 java 1.4 环境中的文件中写入格式化输出（为了兼容性）。我的对象是 PrintStream out；我需要写一些类似的东西： out.format("%-5s", data); 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T10:34:08.810

您可以尝试[旧的 printf 实现，](http://www.sharkysoft.com/archive/printf/download/)它现在对于较新的 JVM 来说是多余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T08:56:06.450

我意识到使用 out.format 也可以，我需要提供缓冲区参数。

# regex - 用于在 Javascript 中的 URL 中查找井号的正则表达式？

> ID：13095618
> 
> 赞同：0
> 
> 时间：2012-10-26T23:13:09.167
> 
> 标签：regex

我想`location.pathname.match`用来查找后面的数字，`#`以便`some.domain.com/#123`我可以更改一些 Javascript 代码

`res.render('index.ejs' ...`

到

```
var pageNum = location.pathname.match(REGULAR_EXPRESSION_GOES_HERE)[1];
res.render('index' + pageNum + '.ejs' ... 
```

这样，我渲染`index123.ejs`而不是`index.ejs`.

我一直在研究如何做到这一点的正则表达式，我有点迷茫。那里有任何有用的灵魂有神奇的答案吗？

[编辑：]你们都帮了大忙！我希望我不是太新来支持你们！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T23:24:45.350

不需要所有这些手动的东西。位置对象在`hash`属性中具有您想要的数据。请参阅：[https ://developer.mozilla.org/en-US/docs/DOM/window.location](https://developer.mozilla.org/en-US/docs/DOM/window.location)

因此，只需执行以下操作：

```
var hash = window.location.hash;
if (hash.length && !isNaN(hash = parseInt(hash.substr(1)))) {
    res.render('index' + hash + '.ejs');
}
else {
    //oops, hash is not a number. Handle it.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T23:19:53.923

```
var result = location.pathname.match(/some.domain.com\/\#(.*)$/);
alert(result [1]); 
```

并且不要忘记检查是否有*结果*[1]...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T23:36:44.120

你最好的选择是

```
var pageNum = window.location.hash.replace(/\D+/g, ''); 
```

如果您想使用正则表达式，您的代码应如下所示：

```
var pageNum = location.pathname.match(/#(\d+)/)[1]; 
```

检查**[这个演示](http://jsfiddle.net/hwQkk/)**。

# jquery - 使用 jQuery 悬停指定元素后，将图像变为黑白并恢复正常

> ID：13095619
> 
> 赞同：1
> 
> 时间：2012-10-26T23:13:09.800
> 
> 标签：jquery, css, image

标题基本概括了所有内容。我使用了许多 jQuery 插件来将图像变成黑白。但是它们都没有提供我想到的功能。当指定元素悬停时，我希望图像变回彩色图像。

这是我目前使用的插件：

```
(function ($) {
$.fn.extend({
    BlackAndWhite: function (options) {
        'use strict';
        var container = this,
            self = this,
            defaults = {
                hoverEffect: true,
                webworkerPath: false,
                responsive: true,
                invertHoverEffect: false,
                speed: 500
            };
            options = $.extend(defaults, options);
        //@public vars
        var hoverEffect = options.hoverEffect,
            webworkerPath = options.webworkerPath,
            invertHoverEffect = options.invertHoverEffect,
            responsive = options.responsive,
            fadeSpeedIn = $.isPlainObject(options.speed) ? options.speed.fadeIn : options.speed,
            fadeSpeedOut = $.isPlainObject(options.speed) ? options.speed.fadeOut : options.speed;
        //@private var
        var supportsCanvas = !!document.createElement('canvas').getContext,
            $window = $(window);
        /* Check if Web Workers are supported */
        var supportWebworker = (function () {
                return (typeof (Worker) !== "undefined") ? true : false;
            }());

        var isIE7 = $.browser.msie && +$.browser.version === 7;
        //@private methods
        //convert any image into B&W using HTML5 canvas
        var greyImages = function (img, canvas, width, height) {
            var ctx = canvas.getContext('2d'),
                currImg = img,
                i = 0,
                grey;

            ctx.drawImage(img, 0, 0, width, height);

            var imageData = ctx.getImageData(0, 0, width, height),
                px = imageData.data,
                length = px.length;

            // web worker superfast implementation
            if (supportWebworker && webworkerPath) {

                var BnWWorker = new Worker(webworkerPath + "BnWWorker.js");

                BnWWorker.postMessage(imageData);

                BnWWorker.onmessage = function (event) {
                    ctx.putImageData(event.data, 0, 0);
                };
            } else {

                // no webworker slow implementation
                for (; i < length; i += 4) {
                    grey = px[i] * 0.3 + px[i + 1] * 0.59 + px[i + 2] * 0.11;
                    px[i] = px[i + 1] = px[i + 2] = grey;
                }

                ctx.putImageData(imageData, 0, 0);
            }
        };

        var injectTags = function (pic, currImageWrapper) {

            var src = pic.src;

            if (supportsCanvas && (!($.browser.msie && $.browser.version == '9.0'))) {

                var currWidth = $(currImageWrapper).find('img').width(),
                    currHeight = $(currImageWrapper).find('img').height(),
                    realWidth = pic.width,
                    realHeight = pic.height;

                //adding the canvas
                $('<canvas width="' + realWidth + '" height="' + realHeight + '"></canvas>').prependTo(currImageWrapper);
                //getting the canvas
                var currCanvas = $(currImageWrapper).find('canvas');
                //setting the canvas position on the Pics
                $(currCanvas).css({
                    'position': 'absolute',
                    top: 0,
                    left: 0,
                    width: currWidth,
                    height: currHeight,
                    display: invertHoverEffect ? 'none' : 'block'
                });

                greyImages(pic, currCanvas[0], realWidth, realHeight);

                if (hoverEffect) {
                    $(currImageWrapper).mouseenter(function () {
                        if(!invertHoverEffect) {
                            $(this).find('canvas').stop(true, true).fadeOut(fadeSpeedOut);
                        } else {
                            $(this).find('canvas').stop(true, true).fadeIn(fadeSpeedIn);
                        }
                    });
                    $(currImageWrapper).mouseleave(function () {
                        if(!invertHoverEffect) {
                            $(this).find('canvas').stop(true, true).fadeIn(fadeSpeedIn);
                        } else {
                            $(this).find('canvas').stop(true, true).fadeOut(fadeSpeedOut);
                        }
                    });
                }
            } else {

                var ieWidth = $(currImageWrapper).find('img').prop('width');
                var ieHeight = $(currImageWrapper).find('img').prop('height');

                //adding the canvas
                $('<img src=' + src + ' width="' + ieWidth + '" height="' + ieHeight + '" class="ieFix" /> ').prependTo(currImageWrapper);
                $('.ieFix').css({
                    'position': 'absolute',
                    top: 0,
                    left: 0,
                    'filter': 'progid:DXImageTransform.Microsoft.BasicImage(grayscale=1)',
                    display: invertHoverEffect ? 'none' : 'block'
                });

                if (hoverEffect) {
                    $(currImageWrapper).mouseenter(function () {
                        if(!invertHoverEffect) {
                            $(this).children('.ieFix').stop(true, true).fadeOut(fadeSpeedOut);
                        } else {
                            $(this).children('.ieFix').stop(true, true).fadeIn(fadeSpeedIn);
                        }
                    });
                    $(currImageWrapper).mouseleave(function () {
                        if(!invertHoverEffect) {
                            $(this).children('.ieFix').stop(true, true).fadeIn(fadeSpeedIn);
                        } else {
                            $(this).children('.ieFix').stop(true, true).fadeOut(fadeSpeedOut);
                        }
                    });
                }
            }
        };
        this.init = function (options) {

            $(container).each(function (index, currImageWrapper) {
                var pic = new Image();
                pic.src = $(currImageWrapper).find('img').prop("src");

                if (!pic.width) {
                    $(pic).on("load", function() {injectTags( pic, currImageWrapper);});
                } else {
                    injectTags( pic, currImageWrapper );
                }
            });

            if (responsive) {
                $window.on('resize orientationchange', container.resizeImages);
            }
        };

        this.resizeImages = function () {

            $(container).each(function (index, currImageWrapper) {
                var pic = $(currImageWrapper).find('img:not(.ieFix)');
                var currWidth,currHeight;
                if (isIE7) {
                    currWidth = $(pic).prop('width');
                    currHeight = $(pic).prop('height');
                } else {
                    currWidth = $(pic).width();
                    currHeight = $(pic).height();
                }

                $(this).find('.ieFix, canvas').css({
                    width: currWidth,
                    height: currHeight
                });

            });
        };

        return self.init(options);

    }

});
}(jQuery)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-21T10:55:36.910

我认为你也可以通过使用 CSS3 来做到这一点。为了使任何图像（假设它具有“图像”类）为黑白，您可以使用：-

```
img.Image{
-webkit-filter: grayscale(100%);
-moz-filter: grayscale(100%);
filter: grayscale(100%);
} 
```

并在悬停时将其变为彩色，您可以这样做：-

```
img.Image:hover{
-webkit-filter: grayscale(0%);
-moz-filter: grayscale(0%);
filter: grayscale(0%);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-21T11:17:23.907

通过 Jquery，可以通过这样做来实现同样的事情：-

要使图像变成黑白，请执行以下操作：-

如果你想在文件上准备好这个，那么

```
$('document').ready(function(){
 $("img.Image").css({'-webkit-filter':'grayscale(100%)','-moz- filter':'grayscale(100%)','filter': 'grayscale(100%)'});    
}); 
```

之后你需要我认为是这样的： -

```
$("img.Image").on('hover',function(){
$(this).css({'-webkit-filter':'grayscale(0%)','-moz-filter':'grayscale(0%)','filter':'grayscale(0%)'});
},function(){
$(this).css({'-webkit-filter':'grayscale(100%)','-moz-filter':'grayscale(100%)','filter': 'grayscale(100%)'});
}
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-27T00:19:47.000

[在 HTML/CSS 中将图像转换为灰度](https://stackoverflow.com/questions/609273/convert-an-image-to-grayscale-in-html-css)建议在 Firefox 中通过平均其红色、绿色和蓝色分量来对图像进行灰度化。然而，这不会产生具有相同亮度的图像。使用去饱和过滤器可以获得更好的结果：

```
<svg xmlns="http://www.w3.org/2000/svg">
  <filter id="gray">
    <feColorMatrix type="saturate" values="0"/>
  </filter>
</svg> 
```

`filter: url(grayscale.svg#grayscale);`在你的 CSS 中使用。（如果您的文档非常简单，那么您实际上可以将 HTML、CSS 和 SVG 放在同一个文档中。）

# sql-server - 使用 VB6 打开记录集时出现“类未注册”错误

> ID：13095621
> 
> 赞同：1
> 
> 时间：2012-10-26T23:13:41.017
> 
> 标签：sql-server, vb6, ado

我最近开始遇到这个问题。不知道它是如何开始的，但我知道我禁用了一些启动的 Windows 服务，并删除了一些 odbc，可能是 mysql odbc 数据源，但我使用 MS SQL 2000 进行以下操作。

尝试填充记录集时出现错误，错误详细信息是： *“运行时错误'-2147221164 (80040154)'：未注册类。”*

```
Private Sub cmdTestConnection_Click()
Dim conn As ADODB.Connection
Set conn = New ADODB.Connection
conn.ConnectionString = "Provider=SQLOLEDB.1;Initial Catalog=dbname;Data Source=mrtestpc2\sql2000pwd;Extended Properties=uid=sa;pwd=passwordhere;"
Dim rs As ADODB.Recordset
Set rs = New ADODB.Recordset
conn.Open
rs.Open "select * from tablename", conn 'ERROR here
MsgBox CStr(rs.RecordCount)
End Sub 
```

我勾选的可能与此问题相关的参考资料是：Microsoft ActiveX Data Objects 2.8 Library

我已经尝试使用上述参考的不同版本，从 2.8 到 2.5，但仍然遇到同样的问题。

编辑：我试图弄清楚这是否是 MDAC 问题。编辑：我正在运行 windows xp sp3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-20T19:06:16.357

您运行的是 Windows 7 SP1 吗？微软通过一些更改导致了这个问题。请参阅以下[文章](http://blogs.msdn.com/b/psssql/archive/2011/10/03/yes-we-made-a-mistake-and-are-finally-going-to-fix-it.aspx)。

# php - $_POST 中的 htmlspecialchars 输出

> ID：13095623
> 
> 赞同：0
> 
> 时间：2012-10-26T23:14:31.713
> 
> 标签：php, htmlspecialchars

通过 $_POST 将第 1 页的登录信息（电子邮件地址）发送到第 2 页，以便处理诸如 jim_o'brien@thing.com 之类的地址。

`echo "<input type='hidden' name='login' value='".htmlspecialchars($_GET['login'], ENT_QUOTES)."'>"`

查看第 2 页的源代码，我很高兴看到它的输出`jim_o'brien@thing.com`而不是`jim_o&#039;brien@thing.com`我预期的输出。

当我再次将数据发送到新页面（第 3 页）时，我再次将登录信息包装到`htmlspecialchars($_GET['login'], ENT_QUOTES)`... 中，它完成了我期望它做的事情。

但是谁能解释为什么它`#039;`在 POST 发送中丢失了它的编码？我可以理解它在浏览器中呼应单引号，但为什么它也在源代码中呢？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-23T06:52:20.960

实际上，原始问题是有效的。这是我在大约五分钟内编写的一些代码。它不漂亮，也不复杂，但它说明了这一点。

```
 <?php
 $posted=$_POST[posted];
 if (isset($posted)) {
 echo "POSTED: $posted<br>"; //output: You'll see a quote
 $specposted=preg_replace('/&#039/','****',$posted);
 echo "after entity replace: $specposted<br>"; //output: You'll see a quote
 }
 else{
 $phraseone="You'll see a quote";
 $phrasetest=htmlentities($phraseone, ENT_QUOTES);
 echo "phrasetest: $phrasetest<br>"; //output: You'll see a quote
 $specialphrase=preg_replace('/&#039/','****',$phrasetest); 
 echo "after entity replace: $specialphrase<br>"; //output: You****;ll see a quote
 print<<<HERE
 <form method='post'>
 <input type='hidden' name='posted' value='$phrasetest'>
 <input type='submit' value='GO!'>
 </form>
 HERE;
 }
 ?> 
```

有趣的...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T23:43:59.827

查看页面的源代码以查看，实际上它工作正常 - 在您的浏览器中您会看到“'”，因为您的浏览器使其“人性化”，但在查看源代码后您会看到，一切都很好。

以其他方式尝试：

```
echo htmlentities("jim_o'brien@thing.com", ENT_QUOTES); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-26T23:32:41.780

`jim_o'brien@thing.com`不是有效的电子邮件地址，并且不能被允许。

使用 filter_input 进行验证。

```
$login = filter_input(INPUT_GET, 'login', FILTER_VALIDATE_EMAIL); //or INPUT_POST, if method is POST
if(!$login){
   //invalid e-mail 
} 
```

参考：[http ://www.w3schools.com/php/func_filter_input.asp](http://www.w3schools.com/php/func_filter_input.asp)

# javascript - 单击按钮时 window.location 不起作用

> ID：13095624
> 
> 赞同：1
> 
> 时间：2012-10-26T23:14:32.607
> 
> 标签：javascript

查看此链接： [http ://humorjots.com/Barry/BarryWashington.htm](http://humorjots.com/Barry/BarryWashington.htm)

脚本中的部分说：

```
if(emailInput.value != '' && zipInput.value != ''){
    window.location = "sea206.html";
} 
```

由于某种原因在加载 sea206.html 时不起作用。但是，当您输入`window.location = 'sea206.html'`开发人员控制台时，它会加载页面。我不明白为什么单击按钮时它不起作用。if 语句确实有效。如果在语句中插入警报，它会在单击按钮时运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T23:21:25.040

您的代码上发生的事情是它执行按钮的默认功能，该按钮将自动提交表单。

对此的解决方案是您必须在 submitButton.onclick 函数上添加 return false 以便它不会提交表单并重定向到您想要的位置

```
if( emailInput.value != '' && zipInput.value != '')
{
    window.location = "/Barry/sea206.html";
    return false;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T23:55:04.430

按钮的默认操作是提交表单。这会覆盖您的位置更改。`<form>`如今，如果您实际上不打算提交任何内容，则不需要包含该元素。但是，如果您确实需要一个非提交按钮，那么您需要使用该`type="button"`属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T23:20:50.537

当我转到您的页面并单击两个输入字段并将它们清空时，它将自动填写您的占位符文本。所以它永远不会是空的。

当我`emailInput.value`在控制台中输入时，我会得到`"Email"`. 类似于邮政编码。

所以你应该试试

```
if (emailInput.value != 'Email' && zipInput.value != 'Zip Code') { 
  window.location.href = "sea206.html"; 
} 
```

我读了你的脚本代码，你写了`submitbutton.onclick ...`试着在你的按钮中制作 onclick 事件：

```
<button id="submitButton" onclick='javascript:submitForm();' /> 
```

在您的`<script>...</script>`部分使用此 javascript 代码：

```
function submitForm() {
  if (emailInput.value != 'Email' && zipInput.value != 'Zip Code') { 
    window.location.href = "sea206.html"; 
  }  
} 
```

它有效吗？

# python-2.7 - 在 json 对象的字符串化列表上使用 ply.lex

> ID：13095636
> 
> 赞同：1
> 
> 时间：2012-10-26T23:16:18.940
> 
> 标签：python-2.7, ply

我有一个字符串化的 json 对象的 python 列表，我已经部分地对其进行了分析。

但是我留下了诸如“u'Grimsby'”或“u'Amsterdam'”之类的标记，并且我正在努力摆脱前面的u，而不会损坏实际上应该以“u”开头的单词标记。

所以我希望有人能帮我写一个

```
 t_ignore 
```

或一个

```
def t_u(token): 
```

这将安全地摆脱这些“你”

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T10:40:52.560

如果存在非 ascii 字符，您将无法始终安全地将 unicode 转换为字符串，例如`str(u'ü')`会引发：

> UnicodeEncodeError：'ascii' 编解码器无法在位置 0 编码字符 u'\xfc'：
> 序数不在范围内（128）

但是您可以按如下方式对其进行分类并保留`u`：

```
def t_unicode(token):
    r'u\'[^\']*\'|u\"[^"]*\"' 
```

*注意：当你`print u'ü'`只显示时`ü`（所以你不是问题）。*

.

根据上下文，如果你真的想要，你可以忽略`u` *（但因为它仍然是一个 unicode 字符串，这似乎有点毫无意义）*：

```
from __future__ import unicode_literals

def t_u(token):
    r'u' 
```

然后在你的层中忽略`u`（假设`string`已经定义）：

```
def p_unicode_string(p):
    'expression : u string'
    p[0] = p[2] 
```

# javascript - 加载脚本和中断错误

> ID：13095641
> 
> 赞同：0
> 
> 时间：2012-10-26T23:16:51.313
> 
> 标签：javascript, error-handling

我编写了以下内容，让我从数组中加载脚本：

```
scriptLoader = (function(){

  var loader = function (src, handler) {
    if(!self.errorstate){
        var script = document.createElement("script");
        script.src = src;
        script.onload = script.onreadystatechange = function () {
            script.onerror = loaderror(src);
            script.onreadystatechange = script.onload = null;
        };
        var head = document.getElementsByTagName("head")[0];
        (head || document.body).appendChild(script);
    }
  };

  var loaderror = function (src) {
    self.errorstate = true;
    console.log('Error: '+src);
    return false;
  };

  var self = {};
  self.errorstate = false;
  self.files = null;
  self.callback = null;
  self.go = function(){
    if (self.files.length !== 0) {
        loader(self.files.shift(), arguments.callee);
    } else {
        if (self.callback && typeof (self.callback) === 'function' && !self.errorstate) {
            self.callback();
        }
    }
  };
  return self;

}); 
```

我打电话给：

```
var scripts = [
    'js/placeholder.js',
    'js/modal.js',
    'js/alert.js',
    'js/notafile.js'
];

loader = new scriptLoader();
loader.files = scripts;
loader.callback = alert('loaded');
loader.go(); 
```

一切似乎都正常，除了我无法让它因错误（`js/notafile.js`）而中断 - 所以停止加载更多脚本并且不允许回调触发。它在控制台中显示错误消息很好，我只是找不到阻止它的好方法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:23:47.490

使用 try / catch + throw

[http://www.w3schools.com/js/js_errors.asp](http://www.w3schools.com/js/js_errors.asp)

```
var loaderror = function (src) {
    errorstate = true;
    throw 'Error: '+src;
    return false;
}; 
```

和

```
var scripts = [
    'js/placeholder.js',
    'js/modal.js',
    'js/alert.js',
    'js/notafile.js'
];

loader = new scriptLoader();
loader.files = scripts;
loader.callback = alert('loaded');

try{
   loader.go();
}catch(err){
   console.log(err);
} 
```

# mongodb - cursor.observe 如何工作以及如何避免多个实例运行？

> ID：13095647
> 
> 赞同：4
> 
> 时间：2012-10-26T23:17:17.080
> 
> 标签：mongodb, meteor

# 观察

我试图弄清楚***cursor* .observe**如何在流星内运行，但一无所获。 [文档](http://docs.meteor.com/#observe)说

> 建立一个*实时查询*，通知回调查询结果的任何更改。

我想更好地理解*实时查询*的含义。

*   我的观察者函数将在哪里执行？通过 Meteor 还是通过 mongo？

# 多次运行

当我们不仅有订阅*观察者*的用户时，每个客户端都会运行一个实例，这会导致我们遇到性能和竞争条件问题。

*   我怎样才能实现`observe`它就像一个`singleton`？只有一个实例为所有人运行。

***编辑：****这里有第三个问题，但现在是一个单独的问题：[如何避免 cursor.observe 上的竞争条件？](https://stackoverflow.com/q/13297796/599991)*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-29T06:15:31.070

截至目前，服务器端的`observe`工作方式如下：

1.  构造与查询匹配的文档集。
2.  定期使用查询轮询数据库并获取更改的差异，将相关事件发送到回调。
3.  当匹配数据被流星本身更改/插入到 mongo 中时，发出相关事件，将上面的步骤 #2 短路。

有计划（可能在下一个版本中）自动确保共享具有相同参数的订阅调用。所以基本上会自动为你处理单例部分。

当然你可以自己实现这样的事情，但我相信这是流星团队的首要任务，所以现在可能不值得付出努力。

# ruby-on-rails - 自定义索引表行的 ActiveAdmin (Rails) 空类属性

> ID：13095650
> 
> 赞同：2
> 
> 时间：2012-10-26T23:17:28.007
> 
> 标签：ruby-on-rails, activeadmin

我正在使用 ActiveAdmin 为模型呈现索引表。

配置如下所示：

```
ActiveAdmin.register User do
  index do
    selectable_column
    column :username
    column "Email" do |u|
      raw "<span title='#{u.email}'>#{truncate(u.email, length: 14)}</span>"
    end
  end
end 
```

“电子邮件” TD 的渲染 HTML 如下所示：

```
 <td class=""><span title="useremail@example.com">useremail...</span></td> 
```

我尝试过在块之前通过 class: 'foo' 和一些类似的东西，但没有一个奏效。

所有未使用块语法创建的列都将获得与字段名称相同的类属性。

使用块渲染列时如何设置TD的类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T19:46:23.173

你必须重写 build_table_cell 方法，你可以在这里获取所需的代码[https://gist.github.com/3995962](https://gist.github.com/3995962)

将其放入初始化程序文件夹。

现在你可以像使用它一样

```
column(:status, :sortable => 'enabled', :class=>'status') do |row|
        #some logic 
     end 
```

# java - 从 Restful Web 服务异步访问数据

> ID：13095651
> 
> 赞同：0
> 
> 时间：2012-10-26T23:17:48.863
> 
> 标签：java, android, web-services

我正在编写一个 android 应用程序，其中我的所有数据都使用 Web 服务公开。我正在编写一个包装类来从名为 DataManager 的服务中获取数据。

```
public class DataManager{

public DataManager (){}

public String getValue ()
{
    HttpClient client = new DefaultHttpClient();
    HttpGet get = new HttpGet ("some url");

    try 
    {
        HttpResponse response = client.execute(get);
        if (response.getStatusLine ().getStatusCode() == 200)
        {
            HttpEntity entity = response.getEntity ();
            String result = EntityUtils.toString(entity);
            return result;
        }
    } 
    catch (ClientProtocolException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    catch (IOException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return null;
} 
```

}

当我调用此方法时，会在 UI 线程上生成 RuntimeException。如何重构此代码并从 Web 服务中获取值并异步返回这些值。[注意] 我正在为一些团队成员写这篇文章，这样他们就可以使用它从服务中获取数据，所以我希望它可以让他们轻松使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:19:23.360

使用`AsyncTask`或`IntentService`。在 UI 线程上进行联网（通常是冗长的操作）在 Android 上是不行的。

这里有[AsyncTask 基础知识](http://developer.android.com/reference/android/os/AsyncTask.html)和一些[教程](http://www.vogella.com/articles/AndroidPerformance/article.html) 这里有[IntentService 基础知识](http://developer.android.com/reference/android/app/IntentService.html)和[教程](http://www.vogella.com/articles/AndroidServices/article.html)

我自己会使用 AsyncTask（IntentService 的作业已排队），但要[注意在较新的 API 中处理它的方式发生了变化](http://commonsware.com/blog/2012/04/20/asynctask-threading-regression-confirmed.html)。不过没什么大不了的（只是多几行代码）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T23:21:34.137

我建议尝试一下 David Chandler 的Android[基本 HTTP 客户端](http://turbomanage.wordpress.com/2012/06/12/a-basic-http-client-for-android-and-more/)库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T23:23:38.847

最好的方法是使用 IntentService。这为您提供了一个后台线程和一种向其传递 URL 的方法。根据您拥有的数据量，您可以将其转储到本地文件中，也可以将其存储在数据库中。

如果你做数据库路由，你可以使用 AsyncTaskLoader 在 Activity 中异步加载数据，或者使用 AsyncTask 进行完全访问。而且，通过一些额外的开销但更简单的编码，您可以将数据粘贴在 ContentProvider 中，然后在 Activity 中使用 CursorLoader。

**最重要的是，永远不要在 UI 线程上进行网络操作或数据库操作。**将您的 Activity 用作“演示者”（智能“视图”）并将所有控制器和模型的东西放在后台。

# scala - 大写第一个字母，柯里化定义的命名约定？

> ID：13095652
> 
> 赞同：0
> 
> 时间：2012-10-26T23:17:51.500
> 
> 标签：scala, currying

在 Play2 文档中，我发现如下内容：

```
def LoggingAction(f: Request[AnyContent] => Result): Action[AnyContent] = {
  Action { request =>
    Logger.info("Calling action")
    f(request)
  }
} 
```

`{ ... }`由于 curryfication可以调用的定义使用大写首字母是 Scala的惯例吗？还是只是 Play2 的选择？

我说的是 LoggingAction 和 Action。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:44:49.343

首先，正如@pedrofurla 在他的评论中指出的那样，currying 与你在这里看到的无关。其次，虽然从 API 用户的角度来看`LoggingAction`和`Action`行为相似，但区分它们很重要。

`Action`按约定大写，因为它是类的名称和伴随对象。这在上下文中可能并不明显，因为它看起来`Action`像函数一样被调用，但真正发生的事情更加微妙。由于`Action`伴随对象定义了一个`apply`方法，

```
Action(arg) 
```

被视为简写

```
Action.apply(arg) 
```

也就是说，看起来像函数调用的东西实际上只是对`Action`对象`apply`方法的调用。在这种情况下，方法将单个函数作为参数，通常使用大括号：

```
Action apply { request =>
   // ...
} 
```

`LoggingAction`，另一方面，是一种*方法*。大写的方法名称*不是*传统的，可能会混淆 API 的用户。但是，在这种情况下它可能是合适的，因为它在整个 API 中创建了一致性。一般来说，这种用法的目的是明确调用是在*创建*一些*东西*（这里是一个日志记录操作），而不是*在做*一些事情。粗略的经验法则是，**大写字母表示名词**，而**小写字母表示动词**。

# ruby-on-rails-3 - Rails 3.2.8 远程表单不工作

> ID：13095662
> 
> 赞同：0
> 
> 时间：2012-10-26T23:19:23.730
> 
> 标签：ruby-on-rails-3

我有这个表格，它不绑定到任何模型，我想 ajaxify。我试图弄清楚如何让它通过 ajax 提交，但我一定做错了，因为它不起作用（它只是做一个常规的 POST）。

我可以确认表单标记使用“远程”属性呈现，但是表单的任何地方都没有添加 js。我还添加了 :confirm 只是为了看看它是否也能正常工作。它不是。

jquery 和 jquery_ujs 都加载在页面上。

```
 %form{ :action => "/newsletter", :confirm => "Are you sure?", :remote => true, :method => "post", :id => "newsletterForm"}
    %p
      = label_tag(:q, "Subscribe to our newsletter:")
    %p
      = text_field_tag(:q, nil, :placeholder => "Your email address")
      = button_to("Subscribe", :remote => true) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T10:01:10.607

我刚刚写了这个，用一个表格做类似的事情：

```
 = form_tag('/signup', :method => "get", :remote => true, :id=> 'signup-form') do
    %label{:id => 'signup-label', :for=> 'signup-box'}
      Enter your email address
    = text_field_tag "signup-box", params[:signup], :class => 'text', :required => true, :id => 'signup-box'
    = submit_tag "Sign Up", :id => 'signup' 
```

控制器：

```
class SignupController < ApplicationController
  def index
    puts "***************************************************"
    puts "email sign up"
    puts "***************************************************"
    render :nothing => true
  end
end 
```

# java - Eclipse 中的 COM+ 和 JAVA

> ID：13095666
> 
> 赞同：-1
> 
> 时间：2012-10-26T23:19:40.127
> 
> 标签：java, com+

我想知道这是否与用JAVA制作的代码访问COM +中可用的类有关？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T23:29:24.713

有许多库可以连接 COM 和 Java。这里只有几个

1.  [雅各布（免费）](http://sourceforge.net/projects/jacob-project/)
2.  [JavaComBridge（商业）](http://javacombridge.com/)
3.  [Com4J（免费）](http://com4j.kohsuke.org/tutorial.html)

还有更多，只需谷歌即可。

# iphone - initWithCoder 没有设置 UILabel 属性（UIFont 和文本颜色）

> ID：13095669
> 
> 赞同：0
> 
> 时间：2012-10-26T23:20:02.840
> 
> 标签：iphone, objective-c, ios, ipad

我的 UICollectionViewCell 有以下代码

```
@property (strong, nonatomic) IBOutlet UIImageView *storyImage;
@property (strong, nonatomic) IBOutlet UILabel *titleLabel;
@property (strong, nonatomic) IBOutlet UILabel *descriptionLabel;

@end

@implementation Story
@synthesize storyImage;
@synthesize titleLabel;
@synthesize descriptionLabel;

    - (id)initWithCoder:(NSCoder *)aDecoder
    {
        self = [super initWithCoder:aDecoder];
        if (self)
        {
            [self.contentView addSubview:self.titleLabel];
            [self.contentView addSubview:self.descriptionLabel];
            [self.contentView addSubview:self.storyImage];

            [self.titleLabel setFont:[UIFont fontWithName:kProximaNovaBold size:15]];
            [self.descriptionLabel setFont:[UIFont fontWithName:kProximaNova size:13]];
            [self.descriptionLabel setTextColor:[UIColor colorWithWhite:140/255.f alpha:1.0]];
            self.descriptionLabel.frame  = CGRectIntegral(self.descriptionLabel.frame);
            self.descriptionLabel.center = roundedCenterPoint(self.descriptionLabel.center);

        }
        return self;
    } 
```

但由于某种原因，它没有设置属性。我必须将它移出 init 方法并将其放在一个单独的方法中，并在调用后调用它：

```
 dequeueReusableCellWithReuseIdentifier:kCellID forIndexPath:indexPath 
```

然后它会起作用。知道为什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T23:50:38.643

您希望在`awakeFromNib:`nib 中的所有内容都已实际加载和连接时执行此操作

[来自NSObject UIKit Additions](http://developer.apple.com/library/ios/#documentation/uikit/reference/NSObject_UIKitAdditions/Introduction/Introduction.html)的文档

> **讨论**
> nib 加载基础架构向从 nib 存档重新创建的每个对象发送 awakeFromNib 消息，但前提是存档中的所有对象都已加载和初始化。

# javascript - 当表单字段发生更改并且他们不保存时提示用户

> ID：13095673
> 
> 赞同：1
> 
> 时间：2012-10-26T23:21:05.400
> 
> 标签：javascript, jquery

这里很常见的场景是，用户更改表单中的字段并离开页面而不保存。我发出警告信息。

我首先开始使用

```
$(window).bind("beforeunload", function(){ }); 
```

但我想抛出一个对话框并给用户一些选项，我选择了这个。

```
$("#myForm").change( function(){
    $("a:not(:#myForm a)").click( function(){
    $("#promptDialog").dialog("open");
        return false;
    });
}); 
```

唯一不能准确工作的情况是用户更改字段，然后将其更改回原始值（它不应该提示，但会提示）。

这个解决方案优雅吗，有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:01:27.283

恐怕onbeforeunload-part很难替换，除了点击链接，还有其他的方式离开页面，不能全部拦截。

但是可以更好地处理更改事件的问题。

在 DOMready 上，将表单的初始值存储在某处，例如在表单的数据中。

在 beforeunload 上，您可以比较存储的值和当前值以确定是否有任何更改：

```
jQuery(
  function($)
  {

    $('#myForm').data('defaultValues',$('#myForm').serialize());

    $(window)
      .on('beforeunload',
          function()
          {
            if($('#myForm').data('defaultValues')!=$('#myForm').serialize())
            {
              return 'are you sure?';
            }
          });
  }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T23:23:37.897

您不能覆盖浏览器的实现功能。您想为您的自定义对话框交换标准警报（实现定义的构造），而您无法在`onbeforeunload`函数中执行此操作。您的后一种解决方案应该足以替代。

# php - codeigniter xmlrpc 客户端 - 如何从 xmlrpc 请求中获取响应？

> ID：13095677
> 
> 赞同：2
> 
> 时间：2012-10-26T23:21:31.750
> 
> 标签：php, codeigniter, client, xml-rpc

我正在使用 codeigniter 向 wordpress 博客发送 xmlrpc 请求。

我在文档中看不到如何获得响应？

我想做文件上传，所以需要知道文件在哪里。我能看到它的唯一方法是打开调试变量，它会回显响应......我只是希望它在一个数组中

谢谢

# javascript - 网站保存到主屏幕 (ios) 强制在 Safari 中打开

> ID：13095681
> 
> 赞同：5
> 
> 时间：2012-10-26T23:21:42.610
> 
> 标签：javascript, ios, iphone-web-app

我正在开发某种 web 应用程序，客户端希望能够保存到主屏幕（默认行为），但是当最终用户打开保存到主屏幕的应用程序时，它会在 safari 中打开，而不是在“webapp”模式下打开。

espn 的移动网站就是一个例子：http: [//m.espn.go.com/](http://m.espn.go.com/)

注意保存到主屏幕，然后访问...它在 safari 中打开。

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:28:28.653

我相信 Web 应用程序将始终在 Safari 中打开，但您可以更改其打开方式的行为，因此它可能*感觉*不像在 Safari 中打开。查看这些页面，了解如何使用一些特定于苹果的元标记：

[https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html](https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html)

[https://code.tutsplus.com/tutorials/configuring-an-iphone-web-app-with-meta-tags--mobile-2133](https://code.tutsplus.com/tutorials/configuring-an-iphone-web-app-with-meta-tags--mobile-2133)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T23:41:35.207

```
<meta name="apple-mobile-web-app-capable" content="yes" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-24T11:52:58.947

IOS 为我们提供了在 StandAlone 模式下打开应用程序的功能。您使用 Safari 的 HTML5 规范，但请记住这超出了 safari 沙箱，即。它将充当本机应用程序，并在睡眠或屏幕关闭时停止 JavaScript 执行。只需添加元标记

```
<meta name="apple-mobile-web-app-capable" content="yes"   /> 
```

最新版本的 Android Chrome 也具有此功能，并且与 Chrome 环境密切相关。只需为 android chrome 添加此元标记。

```
 <meta name="mobile-web-app-capable" content="yes"> 
```

# php - 将 PNG 合并为 JPG 或其他 php

> ID：13095682
> 
> 赞同：1
> 
> 时间：2012-10-26T23:21:56.523
> 
> 标签：php, png, opacity, alphablending

我尝试了许多解决方案和真相，到了你不知道还能做什么的地步。

下图是 PNG（“cover.png”）：

![封面.png](../Images/6c491e8173ebb15a0c7aad9fdd2a5143.png)

因为你将有一个空白的椭圆形真的是完全透明的。使用 PHP，我试图将其融合到这张图片（“lapiz.jpg”）：

![lapiz.jpg](../Images/013950055d52a6ade0da85b2517682ee.png)

然而，尽管我试图让第一张图像的清晰空间不透明，而是完全空白，覆盖了应该融化的图像。

现在这是我的代码：

```
$img_user = 'fotos/lapiz.jpg';
$img_user_type = getImageInfo($img_user,'type');
$posX = 404;
$posY = 2;
$width = getImageInfo($img_user,'width');
$height = getImageInfo($img_user,'height');

$stamp = 'fotos/cover.png';

switch($img_user_type)
 {
    case 'jpeg':
        $img_user_create = imagecreatefromjpeg($img_user);
        break;
    case 'gif':
        $img_user_create = imagecreatefromgif($img_user);
        break;
    case 'png':
        $img_user_create = imagecreatefrompng($img_user);
        break;
}

$im = imagecreatefrompng($stamp);

imagealphablending($im, false);
imagesavealpha($im, true); 

imagecolortransparent($im, imagecolorallocate($im, 255, 255, 255));

imagecopymerge($img_user_create, $im, $posX, $posY, 0, 0, $width, $height, 100);

header('Content-Type: image/png');
imagepng($im);

ImageDestroy($im);
ImageDestroy($img_user_create); 
```

我可能做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:08:02.707

junihh 使用[imagemagick](http://www.imagemagick.org)库和下面的代码解决了这个问题：

```
$img1 = new Imagick('fotos/lapiz.jpg'); 
$img2 = new Imagick('fotos/cover.png'); 
$posX = 404; 
$posY = 2; 
$img2->compositeImage( $img1, imagick::COMPOSITE_DSTOVER, $posX, $posY ); 

header('Content-type: image/png'); 
echo($img2); 
```

# php - 获取 Wordpress 用户 ID 并使用表单提交

> ID：13095683
> 
> 赞同：0
> 
> 时间：2012-10-26T23:23:04.743
> 
> 标签：php, forms, wordpress

我采取了简单的方法，并使用 Mac 的 Web Form Builder 程序为我的网站创建了一个表单。它实际上在制作一个上传到 mySQL 的漂亮表单方面做得不错，但我真的希望它能够找到登录用户的用户 ID 以与表单一起上传。这样我就可以将提交的内容与数据库中的 Wordpress 用户关联起来。

我网站的用户必须登录才能访问表单，因此应该始终可以获取用户 ID。我确实在 Wordpress 上找到了这应该有所帮助，但我不确定如何正确添加代码以及将其放在何处：[http ://codex.wordpress.org/Function_Reference/get_userdata](http://codex.wordpress.org/Function_Reference/get_userdata)

我在这里附上表格的php。希望我能得到一些指导，因为这对我的网站有很大的帮助。

想法提交.php：

```
<?php

$scriptpath = substr( $_SERVER['SCRIPT_FILENAME'], 0, -4 );
$paths = explode ( DIRECTORY_SEPARATOR , $scriptpath );
$myName = end($paths);
require $scriptpath . '/fbapp/php/config.inc.php';

if( strtoupper( $_SERVER['REQUEST_METHOD'] ) == 'POST' ) {

    $ctl = new FormController();
    $ctl->Dispatch();

} else {

    if( ! isset( $_GET['action'] ) )        $myPage->ReportStats( 'NotifyFormView' );
}

ob_start();

$myPage->Show();
ob_end_flush();

?> 
```

Form.cfg.php（我已经更改了敏感材料并删除了这篇文章的一些不必要的代码）：

```
<?php exit(0); ?> { 
"settings":
{
    "data_settings" : 
    {
        "save_database" : 
        {
            "database" : "database",
            "is_present" : true,
            "password" : "password",
            "port" : 3306,
            "server" : "55.55.555.55",
            "tablename" : "Submissions",
            "username" : "username"
        },
        "save_file" : 
        {
            "filename" : "ideasubmissionform-results.csv",
            "is_present" : true
        },
        "save_sqlite" : 
        {
            "database" : "Idea Submission.dat",
            "is_present" : false,
            "tablename" : "Idea Submission"
        }
    },
    "email_settings" : 
    {
        "auto_response_message" : 
        {
            "custom" : 
            {
                "body" : "<!DOCTYPE html>\n<html dir=\"ltr\" lang=\"en\">\n<head>\n<title>RegisterYourApp has received your files!!</title>\n</head>\n<body>\nHello [FirstName] [LastName],\n<br>\n   We really appreciate you signing up for our services and our excited to tell you that your app idea submission for [Title] has been received! Within the next 24 hours you'll be receiving confirmation of your file(s) being stamped and your unique hash code for the submitted files.  If you've submitted multiple files they will be stamped in one zip file so will contain a single hash code and confirmation e-mail.</p>\n<br>\n<br>\n<br>\nHere's a copy of what you submitted for your records:\n<p>\n[_form_results_]\n</body>\n</html>\n",
                "is_present" : true,
                "subject" : "We have received your submission!!"
            },
            "from" : "Info@MyDomain.com",
            "is_present" : true,
            "to" : "[email]"
        },
        "notification_message" : 
        {
            "bcc" : "",
            "cc" : "",
            "custom" : 
            {
                "body" : "<!DOCTYPE html>\n<html dir=\"ltr\" lang=\"en\">\n<head>\n<title>You got mail!</title>\n</head>\n<body>\nHey there,\n<p>\n<b>Someone filled out your form, and here's what they said:</b>\n<p>\n[_form_results_]\n</body>\n</html>\n",
                "is_present" : false,
                "subject" : "Idea Submission"
            },
            "from" : "[email]",
            "is_present" : true,
            "replyto" : "[email]",
            "to" : "Info@MyDomain.com"
        }
    },
    "general_settings" : 
    {
        "colorboxautoenabled" : false,
        "colorboxautotime" : 3,
        "colorboxenabled" : false,
        "colorboxname" : "Default",
        "formname" : "Idea Submission",
        "is_appstore" : "0",
        "timezone" : "America/Los_Angeles"
    },
    "mailchimp" : 
    {
        "apiKey" : "0ef1f58",
        "lists" : 
        [

            {
                "action" : 
                {
                    "subscribe" : 
                    {
                        "condition" : "fields",
                        "fb_name" : "mailing_list",
                        "fb_value" : "Yes"
                    },
                    "unsubscribe" : 
                    {
                        "condition" : "never"
                    }
                },
                "is_present" : true,
                "listid" : "0bfc32032c",
                "merge_tags" : 
                [

                    {
                        "fb_name" : "email_mailing",
                        "field_type" : "email",
                        "isGrouping" : false,
                        "name" : "",
                        "req" : true,
                        "tag" : "EMAIL"
                    },

                    {
                        "fb_name" : "firstname",
                        "field_type" : "text",
                        "isGrouping" : false,
                        "name" : "",
                        "req" : false,
                        "tag" : "FNAME"
                    },

                    {
                        "fb_name" : "lastname",
                        "field_type" : "text",
                        "isGrouping" : false,
                        "name" : "",
                        "req" : false,
                        "tag" : "LNAME"
                    }
                ],
                "name" : "Updates & News",
                "subscribe" : 
                {
                    "double_optin" : true,
                    "email_address_field" : "email_mailing",
                    "email_type_field" : "html",
                    "replace_interests" : true,
                    "send_welcome" : false,
                    "update_existing" : true
                },
                "unsubscribe" : 
                {
                    "delete_member" : false,
                    "email_address_field" : "email_mailing",
                    "send_goodbye" : true,
                    "send_notify" : true
                }
            }
        ]
    },
    "payment_settings" : 
    {
        "confirmpayment" : "",
        "currencysymbol" : "",
        "decimals" : 2,
        "fixedprice" : "",
        "invoicelabel" : "",
        "is_present" : false,
        "paymenttype" : "invoice",
        "shopcurrency" : "TRY",
        "usecustomsymbol" : false
    },
    "redirect_settings" : 
    {
        "confirmpage" : "<!DOCTYPE html>\n<html dir=\"ltr\" lang=\"en\">\n<head>\n<title>Success!</title>\n<meta charset=\"utf-8\">\n<style type=\"text/css\">\nbody {background: #f9f9f9;padding-left: 110px;padding-top: 70px; padding-right: 20px;max-width:700px;font-family: Helvetica, Arial;}\np{font-size: 16px;font-weight: bold;color: #666;}\nh1{font-size: 60px; !important;color: #ccc !important;margin:0px;}\nh2{font-size: 28px !important;color: #666 ! important;margin: 0px; border-bottom: 1px dotted #00A2FF; padding-bottom:3px;}\ntd {font-size: 12px !important; line-height: 30px;  color: #666 !important; margin: 0px;border-bottom: 1px solid #e9e9e9;}\ntd:first-child {font-size: 13px !important; font-weight:bold; color: #333 !important; vertical-align:text-top; min-width:100px; padding-right:5px;}\n</style>\n</head>\n<body>\n<h1>Thanks! </h1>\n<h2>The form is on its way.</h2>\n<p>Here&rsquo;s what was sent:</p>\n<div>[_form_results_]</div>\n</body>\n</html>\n",
        "gotopage" : "http://www.MyDomain.com/success/",
        "inline" : "<center><h2>Thank you!</h2>\n<p>We received your form</p></center>",
        "type" : "gotopage"
    },
    "uid" : "a67968bef1ba64039314ab953a1ce923",
    "validation_report" : "in_line"
},
"rules":{"firstname":{"label":"Name","fieldtype":"text","required":true,"maxlength":"25"},"lastname":{"fieldtype":"text","required":true,"maxlength":"25"},"email":{"email":true,"label":"Email","fieldtype":"email","required":true,"equalTo":"email_verification","label_equal":"Confirm Email","maxlength":"254"},"form_of_id":{"label":"Social Security #, Driver&#39;s License, ID or Other","fieldtype":"text","required":true},"streetaddress":{"label":"Address","fieldtype":"text","required":true},"city":{"fieldtype":"text","required":true,"maxlength":"100"},"zip_code":{"fieldtype":"text","required":true,"maxlength":"25"},"state_province":{"fieldtype":"text","required":true,"maxlength":"50"},"country":{"fieldtype":"text","required":true},"phonenumber":{"phone":"phoneUS","label":"Phone Number (Optional)","fieldtype":"tel"},
"payment_rules":{},
"application_version":"Web Form Builder (OSX), build 2.1.4944"
} 
```

uid.php：

```
<?php

$txt = false;

if( file_exists( 'form.cfg.dat' ) )
    $txt = file_get_contents( 'form.cfg.dat' );
else if ( file_exists( 'form.cfg.php' ) )
    $txt = file_get_contents( 'form.cfg.php' );

if( $txt === false ) {
    echo 'null';
    exit(0);
}

$config = json_decode( substr( $txt, strpos( $txt, "{" ) ), true );

if( isset( $config['settings'] ) &&
    isset( $config['settings']['uid'] ) ) {

        echo $config['settings']['uid'];

} else {

    echo 'null';
}

?> 
```

Idea Submission.html（我已经更改了敏感材料并删除了这篇文章的一些不必要的代码）：

```
<!DOCTYPE HTML>
<html>

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Start of the headers for CoffeeCup Web Form Builder -->
    <script type="text/javascript" src="common/js/form_init.js" data-name=""
    id="form_init_script">
    </script>
    <link rel="stylesheet" type="text/css" href="theme/blue_pad/css/default.css?version=884"
    id="theme" />
    <!-- End of the headers for CoffeeCup Web Form Builder -->
    <title>
      Idea Submission
    </title>
  </head>

  <body>
    <!-- Start of the body content for CoffeeCup Web Form Builder -->
    <form id="docContainer" enctype="multipart/form-data" method="POST" action="../Idea%20Submission.php"
    novalidate="novalidate" class="fb-toplabel fb-100-item-column selected-object"
    style="width: 650px; " data-form="manual_iframe">
      <div id="fb-form-header1" class="fb-form-header" style="padding-bottom: 30px; padding-top: 20px; padding-left: 35px; height: 1px; ">
        <a id="fb-link-logo1" class="fb-link-logo" href="" target="_blank"><img alt="Alternative text" title="Alternative text" id="fb-logo1" class="fb-logo" src="common/images/image_default.png" style="display: none; "/></a>
      </div>
      <div id="section1" class="section">
        <div id="column1" class="column ui-sortable">
          <div style="display:none; min-height:2332px;" id="fb_confirm_inline">
          </div>
          <div style="display:none;" id="fb_error_report">
          </div>
          <div id="item13" class="fb-item fb-100-item-column" style="opacity: 1; ">
            <div class="fb-header fb-item-alignment-center">
              <h2 style="display: inline; color: rgb(8, 2, 0); ">
                Submit
              </h2>
            </div>
          </div>
          <div id="item14" class="fb-item fb-100-item-column" style="opacity: 1; padding-top: 0px; padding-bottom: 10px; padding-right: 0px; padding-left: 25px; ">
            <div class="fb-static-text fb-item-alignment-center">
              <p style="font-style: italic; ">
                Hello! Welcome to our submission page!
              </p>
            </div>
          </div>
          <div id="item50" class="fb-item fb-100-item-column" style="padding-bottom: 10px; padding-right: 0px; padding-left: 25px; opacity: 1; padding-top: 20px; ">
            <div class="fb-static-text fb-item-alignment-center">
              <p style="font-weight: bold; ">
                Please only upload submission per form.
                <BR>
              </p>
            </div>
          </div>
          <div id="item51" class="fb-item fb-100-item-column" style="padding-top: 0px; padding-bottom: 10px; padding-right: 0px; padding-left: 25px; opacity: 1; ">
            <div class="fb-static-text fb-item-alignment-center">
              <p>
                You may come back as many times as you want.
                <BR>
              </p>
            </div>
          </div>
          <div id="item1" class="fb-item fb-33-item-column" style="opacity: 1; padding-bottom: 5px; ">
            <div class="fb-grouplabel">
              <label id="item1_label_0" style="display: inline; ">Name</label>
            </div>
            <div class="fb-input-box">
              <input type="text" id="item1_text_1" maxlength="25" placeholder="First"
              autocomplete="on" data-hint="" name="FirstName" required autofocus/>
            </div>
          </div>
          <div id="item2" class="fb-item fb-66-item-column" style="padding-bottom: 0px; padding-top: 33px; ">
            <div class="fb-grouplabel">
              <label id="item2_label_0" style="display: none; "></label>
            </div>
            <div class="fb-input-box">
              <input type="text" id="item2_text_1" maxlength="25" placeholder="Last"
              autocomplete="on" data-hint="" name="LastName" required/>
            </div>
          </div>
          <div id="item9" class="fb-item fb-100-item-column" style="padding-top: 0px; padding-bottom: 0px; opacity: 1; ">
            <div class="fb-grouplabel">
              <label id="item9_label_0">Email</label>
            </div>
            <div class="fb-input-box">
              <input type="email" id="item9_email_1" maxlength="254" placeholder="you@domain.com"
              autocomplete="on" data-hint="" name="email" required/>
              <div class="fb-hint" style="color: rgb(136, 136, 136); font-weight: normal; font-style: normal; ">
                We will contact you by this email address.
              </div>
            </div>
            <div class="fb-grouplabel">
              <label style="color: rgb(0, 113, 188); ">Confirm Email</label>
            </div>
            <div class="fb-input-box">
              <input type="email" id="item9_email_1_verification" maxlength="254" placeholder=""
              autocomplete="off" data-hint="" name="email_verification" />
            </div>
          </div>
          <div id="item22" class="fb-item fb-100-item-column" style="opacity: 1; ">
            <div class="fb-grouplabel">
              <label id="item22_label_0" style="display: inline; ">Social Security #, Driver&#39;s License, ID or Other</label>
            </div>
            <div class="fb-input-box">
              <input type="text" id="item22_text_1" maxlength="254" placeholder="" autocomplete="off"
              data-hint="" name="Form_Of_ID" required/>
              <div class="fb-hint" style="color: rgb(136, 136, 136); font-weight: normal; font-style: normal; ">
                <BR>
              </div>
            </div>
          </div>
          <div id="item3" class="fb-item fb-100-item-column" style="padding-top: 0px; padding-bottom: 0px; ">
            <div class="fb-grouplabel">
              <label id="item3_label_0" style="display: inline; ">Address</label>
            </div>
            <div class="fb-input-box">
              <input type="text" id="item3_text_1" maxlength="254" placeholder="Address Line 1"
              autocomplete="on" data-hint="" name="StreetAddress" required/>
            </div>
          </div>
          <div id="item5" class="fb-item fb-33-item-column" style="padding-top: 0px; padding-right: 1px; ">
            <div class="fb-grouplabel">
              <label id="item5_label_0" style="display: none; "></label>
            </div>
            <div class="fb-input-box">
              <input type="text" id="item5_text_1" maxlength="100" placeholder="City"
              autocomplete="on" data-hint="" name="City" required/>
            </div>
          </div>
          <div id="item6" class="fb-item fb-33-item-column" style="opacity: 1; padding-top: 0px; padding-bottom: 0px; padding-right: 1px; padding-left: 2px; ">
            <div class="fb-grouplabel">
              <label id="item6_label_0" style="display: none; "></label>
            </div>
            <div class="fb-input-box">
              <input type="text" id="item6_text_1" maxlength="25" placeholder="Postal / Zip Code"
              autocomplete="on" data-hint="" name="Zip_Code" required/>
            </div>
          </div>
          <div id="item27" class="fb-item fb-33-item-column" style="opacity: 1; padding-top: 0px; padding-right: 0px; padding-left: 2px; ">
            <div class="fb-grouplabel">
              <label id="item27_label_0" style="display: none; "></label>
            </div>
            <div class="fb-input-box">
              <input type="text" id="item27_text_1" maxlength="50" placeholder="State/Province"
              autocomplete="on" data-hint="" name="State_Province" required/>
            </div>
          </div>
          <div id="item28" class="fb-item fb-50-item-column" style="opacity: 1; padding-top: 0px; padding-right: 0px; padding-left: 115px; ">
            <div class="fb-grouplabel">
              <label id="item28_label_0" style="display: none; "></label>
            </div>
            <div class="fb-input-box">
              <input type="text" id="item28_text_1" maxlength="254" placeholder="Country"
              autocomplete="on" data-hint="" name="Country" required/>
            </div>
          </div>
          <div id="item19" class="fb-item fb-66-item-column" style="padding-top: 0px; opacity: 1; padding-bottom: 10px; ">
            <div class="fb-grouplabel">
              <label id="item19_label_0" style="display: inline; ">Phone Number (Optional)</label>
            </div>
            <div class="fb-phone">
              <input type="tel" id="item19_tel_1" data-hint="" name="PhoneNumber" placeholder="890-123-4567"
              />
            </div>
          </div>

          <div id="item32" class="fb-item fb-100-item-column" style="padding-top: 0px; ">
            <div class="fb-grouplabel">
              <label id="item32_label_0" style="display: inline; ">Would You Like To Join Our Mailing List?</label>
            </div>
            <div class="fb-dropdown">
              <select id="item32_select_1" data-hint="" name="Mailing_List" required>
                <option selected id="item32_0_option" value="">
                  Choose one
                </option>
                <option id="item32_1_option" value="Yes">
                  Yes
                </option>
                <option id="item32_2_option" value="No">
                  No
                </option>
              </select>
            </div>
            <div class="fb-hint" style="color: rgb(136, 136, 136); font-weight: normal; font-style: normal; ">
              Stay caught up on all the awesome things happening with the site and company.
            </div>
          </div>
          <div id="item34" class="fb-item fb-100-item-column">
            <div class="fb-grouplabel">
              <label id="item34_label_0" style="display: inline; ">Email For Mailing List</label>
            </div>
            <div class="fb-input-box">
              <input type="email" id="item34_email_1" maxlength="25" placeholder="you@domain.com"
              autocomplete="on" data-hint="" name="email_mailing" required/>
              <div class="fb-hint" style="color: rgb(136, 136, 136); font-weight: normal; font-style: normal; ">
                The address you would like are updates sent to, if signing up for the
                mailing list. It is a required field, but if mark &quot;no&quot; above
                you will not be added to list.
              </div>
            </div>
          </div>
          <div id="item35" class="fb-item fb-100-item-column" style="opacity: 1; padding-bottom: 0px; ">
            <div class="fb-grouplabel">
              <label id="item35_label_0" style="display: inline; ">How&#39;d You Find Out About Us? (Optional)</label>
            </div>
            <div class="fb-input-box">
              <input type="text" id="item35_text_1" maxlength="254" placeholder="ie. Friend, Google Search, Blog..."
              autocomplete="off" data-hint="" name="HowFound" />
            </div>
          </div>
          <div id="item52" class="fb-item fb-100-item-column" style="padding-bottom: 10px; padding-right: 0px; padding-left: 25px; opacity: 1; padding-top: 20px; ">
            <div class="fb-static-text fb-item-alignment-center">
              <p style="font-style: italic; ">
                Thanks for being a member!
                <BR>
                <BR>
                We guarantee to keep all your info and idea materials confidential.
                <BR>
                We will never look at the content of your uploaded files until you inform
                us to do so.
                <BR>
                <BR>
              </p>
            </div>
          </div>
        </div>
      </div>
      <div id="fb-captcha_control" class="fb-captcha fb-item-alignment-center"
      style="cursor: default; display: block; ">
        <script type="text/javascript">
        var RecaptchaOptions = { theme : 'clean' };
        </script>
        <script type="text/javascript" src="https://www.google.com/recaptcha/api/challenge?k=6Lc368kSAAAAALIQElOa6ig3G3PwwicRRKHM6gUK">
        </script>
        <noscript>
          <iframe src="https://www.google.com/recaptcha/api/noscript?k=6Lc368kSAAAAALIQElOa6ig3G3PwwicRRKHM6gUK"
          height="300" width="500" style="border:none;">
          </iframe>
          <br>
          <textarea name="recaptcha_challenge_field" rows="3" cols="40"></textarea>
          <input type="hidden" name="recaptcha_response_field" value="manual_challenge">
        </noscript>
      </div>
      <div id="fb-submit-button-div" class="fb-item-alignment-left fb-footer"
      style="min-height: 1px; ">
        <input type="submit" class="fb-button-special" id="fb-submit-button" data-regular=""
        style="" value="Submit" />
      </div>
      <input type="hidden" name="fb_form_custom_html" />
      <input type="hidden" name="fb_form_embedded" />
      <input type="hidden" id="fb_js_enable" name="fb_js_enable" />
    </form>
    <!-- End of the body content for CoffeeCup Web Form Builder -->
  </body>

</html> 
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:16:43.413

您可以使用该`get_current_user_id()`函数检索 Wordpress 中的当前用户 ID，如果用户未登录，则为 0 - [http://codex.wordpress.org/Function_Reference/get_current_user_id](http://codex.wordpress.org/Function_Reference/get_current_user_id)

也就是说，您需要从 Wordpress 上下文中调用它，看起来您的代码可能没有这样做。任何[Wordpress 模板页面](http://codex.wordpress.org/Stepping_Into_Templates)都将加载必要的类和函数以使用 Wordpress 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T00:17:29.740

可能不是最安全的方法，但由于您的表单和 wordpress 是分开的，您可以在 WordPress 标头的 $_SESSION 中设置用户 ID，并在表单页面上捕获该会话。

对于 WordPress 类似：

```
global $current_user;
$current_user = wp_get_current_user();    
$_SESSION['WP']['userId'] = get_userdata( $current_user->ID); 
```

并在您的表单页面上捕获它：

```
<input type="hidden" name="fb_form_user_id" value="<?php echo $_SESSION['WP']['userId']; ?>" /> 
```

希望这可以帮助！

# jquery - 内容后面的页脚

> ID：13095684
> 
> 赞同：2
> 
> 时间：2012-10-26T23:23:08.020
> 
> 标签：jquery, css, html, footer, slideup

当滚动到网站末尾时，我正在尝试为内容后面的节目添加页脚，这很难解释，所以我做了这个 gif

[http://imageshack.us/f/687/newdw.gif/](http://imageshack.us/f/687/newdw.gif/)

我试图在网上搜索教程，但我发现的不是我想要的（我所看到的只是向上滑动和向下滑动页脚）。

如果您能指出我的教程或解释如何做，将会有很大帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T23:43:47.643

以下应该做你想要的，只使用css。

[http://jsfiddle.net/zVLrb/](http://jsfiddle.net/zVLrb/)

此解决方案依赖于具有行为的元素的`position:fixed`方式。此代码将意味着在较短的页面上 - 即不会导致出现滚动条的页面，页脚将保持固定在页面底部，而不是内容。

基本上，当用户滚动时，页脚总是附加到窗口/视口的底部，但在大多数情况下，您看不到它，因为页面的其余部分漂浮在其上方 - 这是由于使用页面内容的 z-index 高于页脚。通过使用与页脚高度相同的下边距，我们允许页脚出现空间，但仅在页面底部。:)

这应该适用于所有现代浏览器，但是您应该在 IE7 中进行测试以确保（因为我现在手头没有）。

### css

```
.rest {
    position: relative;
    z-index: 100;
    background: #fff;
    margin-bottom: 200px;
    overflow: hidden;
}

.footer {
    height: 200px;
    width: 100%;
    background: #000;
    position: fixed;
    bottom: 0;
    z-index: -1;
    color: white;
    text-align: center;
    font-size: 20pt;
}

.footer p {
    margin-top: 50px;
} 
```

### 标记

```
<div class="rest">
  <p>
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut feugiat
    euismod urna, eget interdum eros elementum in. Morbi dictum molestie
    porta. Morbi eget consectetur nibh. Etiam sed arcu ac elit dignissim
    consequat.
  </p>
  <!-- obviously this content would need to go on for longer to 
       cause the page to scroll //-->
</p>
</div>
<div class="footer">
    <p>This is the footer</p>
</div> 
```

### 更新

我不太记得了，但我认为对于较旧的 Internet Explorer，负 z-index 可能会将页脚放在`body`图层下方.. *（意味着它根本不可见）*所以最好`z-index:2`用于 .rest 和`z-index:1`页脚. 我不会有机会测试一下，但会在我可以的时候更新。

# ios - UIViewController，模态显示，在设备旋转时自行关闭

> ID：13095686
> 
> 赞同：0
> 
> 时间：2012-10-26T23:23:27.287
> 
> 标签：ios, uiviewcontroller

我有一个 UIViewController 用作登录视图，它以模态方式显示在 UISplitViewController 上方。用户成功登录后，模式视图将被关闭。拆分视图控制器中的主视图控制器有一个用于注销的左栏按钮项。一旦点击注销按钮，登录视图控制器就会再次以模态方式显示。如果此时用户旋转设备，模式登录视图将被关闭。

我不知道如何抓住这个。在登录视图控制器上的 viewWillDissappear 上设置断点时，仅调用系统 API - 我没有写任何内容。

可以在此处找到重现问题的示例应用程序：http: [//d.pr/f/c6oG](http://d.pr/f/c6oG)

重现步骤：以纵向模式启动附加的应用程序。点击登录按钮。点击主按钮。点击注销。向左或向右旋转设备。模态视图消失。

预期结果：以纵向模式启动附加的应用程序。点击登录按钮。点击主按钮。点击注销。向左或向右旋转设备。模态视图不会关闭。

实际结果：完成上述重现步骤后，模式视图会在设备旋转时消失。

我还填写了一个雷达错误 #12585564。

有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:41:53.533

您需要从拆分视图控制器呈现登录视图控制器，而不是主视图控制器或详细视图控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T17:27:15.903

虽然这不是我想要的，但我最终在 DetailViewController 中覆盖了 splitViewController:shouldHideViewController:inOrientation:。之后，问题不会发生。

我确实喜欢设备旋转时主视图控制器留在屏幕上的外观——类似于设置应用程序。

# linux - 在哪里可以找到 mmap 的源代码？

> ID：13095687
> 
> 赞同：1
> 
> 时间：2012-10-26T23:23:28.653
> 
> 标签：linux, linux-kernel

内核 2.6.24.6

我正在写一个系统调用插入器。我想插入 mmap，但需要将代码复制并粘贴到实际的系统调用中，我想。我找不到要粘贴的代码？这东西在哪里？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T03:47:43.847

[mmap(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html) C 函数只是在做一个[syscall](http://en.wikipedia.org/wiki/System_call)。您可能会发现[MUSL Libc](http://musl-libc.org/)代码在其[mmap.c](http://git.musl-libc.org/cgit/musl/tree/src/mman/mmap.c)文件中更易于阅读，该文件包装了系统调用（可能使用`mmap2`）。系统调用的实际处理是在内核内部完成的。

[Linux Assembly Howto](http://www.tldp.org/HOWTO/Assembly-HOWTO/)解释了系统调用是如何实际完成的。另请参阅[x86-64 ABI 规范](http://www.x86-64.org/documentation/abi.pdf)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T02:08:07.960

因为内核实际上不能在您的程序中提供函数，所以对应用程序 VDSO 的调用包含在您正在使用的 libc 实现中。最有可能的是，您使用的是 GNU libc，您可以在[此处](http://www.gnu.org/software/libc/)找到源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-09T09:58:16.617

您可以下载内核源并查看（内核源）/drivers/char/mem.c

在那里你可以找到一个使用原型的 mmap 的简单实现：

```
static int mmap_mem(struct file *file, struct vm_area_struct *vma) 
```

在某些时候， mmap() 应该调用 remap_pfn_range() 将内核内存重新映射到用户空间。

我认为这是驱动程序最简单的 mmap() 实现，但您也可以查看其他驱动程序代码以了解它们的 mmap() 实现。您应该在驱动程序代码中查找以下结构：

```
static const struct file_operations mem_fops = {
    .llseek     = memory_lseek,
    .read       = read_mem,
    .write      = write_mem,
    .mmap       = mmap_mem,         // Function implementing mmap
    .open       = open_mem,
    .get_unmapped_area = get_unmapped_area_mem,
}; 
```

# php - 特定帐户的 Google Latitude API 永久身份验证

> ID：13095693
> 
> 赞同：3
> 
> 时间：2012-10-26T23:24:04.760
> 
> 标签：php, oauth, google-latitude

我经常旅行，我有一个很酷的想法，那就是创建一个网站 whereiskavi.com 来展示我当时所在的城市。很简单，我用纬度！或者我是这么想的。

我的研究给我带来了挑战。oauth 需要从浏览器提示，显然我不能授权每一次点击。现在我使用的应用程序不会经常重新提示我进行授权，但到目前为止，我能够做到这一点的唯一方法是获取一个 oauth json 字符串并将其粘贴，然后等待它过期. 下面的代码有效，但仅在到期日之前有效。

我的问题 - 我如何永久授权我的应用程序始终查看我的帐户？

到目前为止，这是我成功的代码：

```
<?php
require_once '../../src/Google_Client.php';
require_once '../../src/contrib/Google_LatitudeService.php';
require_once 'gogeocode-0.2/src/GoogleGeocode.php';

$client = new Google_Client();
$client->setClientId('0000000000000.apps.googleusercontent.com');
$client->setClientSecret('abcdefghijklmnopqrstuvwxyz');
$client->setApplicationName("whereiskavi.com");
$mapsApiKey = 'mApSApIKEy';

$access_token = '{"access_token":"CENSORSHIP_YEAH","token_type":"Bearer","expires_in":3600,"refresh_token":"THIS_MIGHT_BE_SENSITIVE DATA","created":1351291247}';
$client->setAccessToken($access_token);

$service = new Google_LatitudeService($client);
$location = $service->currentLocation->get();

$geo = new GoogleGeocode($mapsApiKey);
$result = $geo->geocode( $location['latitude'].', '.$location['longitude']);
$result = $result['Placemarks'][0];

echo '<h1>'.strtoupper($result['Locality'].', '.$result['AdministrativeArea']).'</h1>';
?> 
```

我真的只需要弄清楚如何进行永久的oauth会话或其他东西！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:48:30.487

我的理解是，令牌将随您的意愿而存在（即，直到您撤销它）。

我已经在上面尝试了您的代码，但出现以下错误：

致命错误：未捕获的异常 'Google_AuthException' 带有消息“刷新 OAuth2 令牌时出错，消息：'{“error”：“invalid_grant”}'

即使我已经将我的 clientID/secret 等设置为使用 Google 配置的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T20:11:48.003

好吧，伙计们，API 似乎对我有点误导。近一个月以来，我一直在使用相同的访问令牌，并且它似乎在不断更新自己。如果有人有更多信息，我会留下这个问题 - 我们会看看它是否持续 2 个月！

# forms - Extjs 4.0 MVC 为基于Store的表单添加组件

> ID：13095695
> 
> 赞同：0
> 
> 时间：2012-10-26T23:24:31.480
> 
> 标签：forms, dynamic, extjs4, datastore

我很惭愧地说我今天大部分时间都花在这上面。我正在尝试根据数据存储的内容构建一个表单。我正在使用 Ext.js 和 MVC 架构。这是我所拥有的：

```
var myitems = Ext.create('Ext.data.Store', {
    fields: ['name', 'prompt', 'type'],
    data : 
    [
        {"name":"name", "prompt":"Your name" , "type":"textfield"},
        {"name":"addr", "prompt":"Your street address", "type":"textfield"},
        {"name":"city", "prompt":"Your city" , "type":"textfield"}
    ]
});

function genwidget(name, prompt, type)
{
    console.log("In genwidget with name=" + name + ", prompt=" + prompt + ", type=" + type + ".");

    var widget = null;
    if (type == "textfield")
    {
//      widget = Ext.create('Ext.form.field.Text', 
        widget = Ext.create('Ext.form.TextField', 
            {
                xtype     : 'textfield',
                name      : name,
                fieldLabel: prompt,
                labelWidth: 150,
                width     : 400,  // includes labelWidth
                allowBlank: false
            });
    }
    else
    {
        // will code others later
        console.log("Unrecongized type [" + type + '] in function mywidget');
    }
    return widget;
};

function genItems(myitems)
{
    console.log("Begin genItems.");

    var items = new Ext.util.MixedCollection();

    var howMany = myitems.count();
    console.log("There are " + howMany + " items.");

    for (var i = 0; i < myitems.count(); i++)
    {
        var name   = myitems.getAt(i).get('name');
        var prompt = myitems.getAt(i).get('prompt');
        var type   = myitems.getAt(i).get('type');
        var widget = genwidget(name, prompt, type) ; 
        items.add(widget);
        console.log("items.toString(): " + items.toString());
    }

    return items;
};

Ext.define('MyApp.view.dynamicform.Form' ,{
    extend: 'Ext.form.Panel',
    alias : 'widget.dynamicformform',

    // no store

    title: 'Dynamic Form',
    id: 'dynamicform.Form',
    bodyPadding: 5,
    autoScroll: true,
    layout: 'auto',

    defaults: 
    {
        anchor: '100%'
    },

    dockedItems: [ ],

    items: genItems(myitems),

    // Reset and Submit buttons
    buttons: [
        {
            text: 'Reset',
            handler: function() 
            {
                this.up('form').getForm().reset();
                console.log('Reset not coded yet');
            }
        },
        {
            text: 'Submit',
            formBind: true, //only enabled once the form is valid
            disabled: true,
            handler: function() 
            {
                var form = this.up('form').getForm();
                if (form.isValid()) 
                {
                    form.submit({
                        success: function(form, action) 
                        {
                            console.log('Success not coded yet');
                        }
                    });

                }
            }
        }   //  end submit
    ],  // end buttons

    initComponent: function() 
    {
        console.log("--> in dynamicform init");

        this.callParent(arguments);

        console.log("--> leaving dynamicform init");
    }

});  // Ext.define 
```

我得到的错误（我一整天都有很多）是“my.items.push 不是一个函数”。

提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:27:00.530

`items`预计是一个数组而不是 MixedCollection。如果我记得不错，稍后会更改为 MixedCollection。因此，要解决您的问题更改：

```
var items = new Ext.util.MixedCollection();
// ...
items.add(widget); 
```

至

```
var items = [];
// ...
items.push(widget); 
```

考虑将`items`表单定义为空数组，然后`initComponent`使用`Ext.apply`：

```
var me = this,
    items = genItems(myitems);
Ext.apply(me, {
    items:items
}); 
```

# activerecord - Activerecord 链接 2 个表

> ID：13095703
> 
> 赞同：1
> 
> 时间：2012-10-26T23:25:43.150
> 
> 标签：activerecord

我已经能够制作 2 个 ActiveRecord 表**Profile**和**Bot**。我一直无法弄清楚如何正确链接它们。

有数以千计的**配置文件，其中包含****username、gender**列。少数具有列**botname、level的****Bot**

 **当机器人访问个人资料时，需要记录两条信息。应针对该特定机器人更新已**访问**和**响应。****visited**是一个布尔值，表示一个特定的机器人已经访问了一个特定的配置文件。**响应**是一个字符串，就像**访问过**的一样，这是对一个特定配置文件发送的一个特定机器人的响应。我在想我需要一个连接这两张桌子的第三张桌子。

我需要记录每个机器人访问的每个配置文件以及它访问时发生的响应。

如何创建这种关系以及如何设置/更新列？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T03:42:36.357

我不完全确定您的要求，所以我将重申它们：

1.  Table Profile：id、username、gender（注意我把表名改成了单数）
2.  表 Bot：id、botname、级别
3.  “机器人”以某种方式“访问”个人资料。您需要跟踪机器人何时访问了个人资料。
4.  当机器人访问配置文件时，会生成一个“响应”字符串，并且需要保留该响应字符串。我假设它需要与访问记录一起保存。

我认为您对连接表的直觉很好。但是，我认为布尔“已访问”列不起作用，因为如果您有访问记录，则表明该配置文件已被访问。如果记录不存在，那么它就没有被访问过。

鉴于此，我认为您的表格如下所示：

```
profile 
---------
profile_id integer autoincrement
username varchar(255)
gender ...

bot
---------
bot_id integer autoincrement
name varchar(255)
level ...

visit
---------
visit_id integer autoincrement
bot_id integer
profile_id integer
visit_time datetime
response varchar(255) 
```

为了保持数据的完整性，您需要在此访问表与您的配置文件和机器人表之间设置外键约束。

```
alter table visit
    add constraint visit_profile_profile_id_fk 
    foreign key (profile_id) 
    references profile (profile_id);

alter table visit
    add constraint visit_bot_bot_id_fk 
    foreign key (bot_id) 
    references profile (bot_id); 
```

您需要确定给定机器人多次访问特定个人资料是否“合法”。如果不是，您应该在访问表中对 profile_id 和 bot_id 的组合设置唯一约束，并在 DBMS 向您抛出重复键错误时捕获它们（或以其他方式处理欺骗）。

我希望这会有所帮助。**

# c# - 如何调整asp.net下拉列表中的内容

> ID：13095705
> 
> 赞同：0
> 
> 时间：2012-10-26T23:25:56.063
> 
> 标签：c#, asp.net

我有一个下拉列，下拉列表包含一个值“事故”。现在我想让该值读取为大写“事故”，并且网格中有很多这样的值。一种方法是更新当前值为大写，但由于这些值在他们希望措辞为小写的应用程序中使用。如何通过代码处理这些。请告知？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:32:28.690

给你的下拉列表一个 CSS 类（比如说'my-ddl'）并将它添加到你的 CSS 文件中。

```
.my-ddl { text-transform: capitalize; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T23:34:29.887

从您的数据源执行此操作，这取决于您拥有的数据源类型

```
 List<X> newList = new List<X>();
   foreach(var item in origList)
   {
      newList.Add(new X {value = item.Value, 
                         text = Capitalize(item.Value)
                        });
   }

   dropdownlist.DataSource = newList; 
```

# objective-c - 如何替换 NSString 中出现的 \xa0 字符

> ID：13095706
> 
> 赞同：0
> 
> 时间：2012-10-26T23:26:04.703
> 
> 标签：objective-c, cocoa-touch, cocoa, nsstring

我已经看过[这个问题](https://stackoverflow.com/questions/12643955/how-to-replace-xa0-characters-in-an-nsstring)，但没有解决方案。这是问题所在。

```
po [myNumberFormatter stringFromNumber:myNumber] 
```

输出--> (id) $4 = 1.500,00

```
p (char) [(NSString *)[myNumberFormatter stringFromNumber:myNumber] characterAtIndex:1] 
```

输出--> (char) $5 = '\xa0'

```
po [(NSString *)[myNumberFormatter stringFromNumber:myNumber] stringByReplacingOccurrencesOfString:@"\xa0" withString:@" "] 
```

输出--> (id) $6 = 1.500,00

不过要注意的一件事是，在屏幕上，值**1.500,00**看起来像**1 500,00**。但是有什么方法可以将字符串中的 '\xa0' 字符转换为 @" " 吗？

以下解决方案已经有效，但存在将未包含的所有内容转换为空白字符的问题。

```
po [(NSString *)[myNumberFormatter stringFromNumber:myNumber] stringByReplacingSequenceOfCharactersInSet:(NSCharacterSet *)[[NSCharacterSet characterSetWithCharactersInString:@"0123456789,."] invertedSet] with:@" "] 
```

**编辑**--------------

我试过下面的答案，我认为这是错误的，因为

```
po [(NSString *)[numberFormatter stringFromNumber:theNumber] stringByReplacingOccurrencesOfString:@"\u00a0" withString:@" "] 
```

仍然产生相同的结果（ \xa0 字符仍未删除）。但是当我没有把它放在调试器中，而是把它放在代码中的一个 NSString 中时，正确的答案被存储了，\xa0 字符被删除了。猜猜我不应该只依赖调试器日志。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-27T00:04:38.857

```
NSString *str = // string to cleanup
str = [str stringByReplacingOccurrencesOfString:@"\u00a0" withString:@" "]; 
```

\u00a0 将在编译时替换为实际的不间断空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T09:03:27.123

在我看来，替换“\u00a0”不是一个通用的解决方案，因为 nect 时间服务器可能会发送任何其他 unicode 字符，然后代码将无法处理。“\u00a0”也不是一个字符串，它是一个字符。PFB 我用来从服务器响应中仅过滤掉数字的代码是：

```
phoneNumber= "000 \U00a0950"; 
```

因为我只想要 phoneNumber 中的数字，所以我写道：

```
self.phoneNumber = [NSMutableString stringWithCapacity:[[_storeDetails objectForKey "phone"] length]]; //which  is 000 \U00a0950

NSCharacterSet *numberCharacterSet = [NSCharacterSet decimalDigitCharacterSet]; 

 for (int i = 0; i < [[_storeDetails objectForKey "phone"] length]; i++)
 { 
 unichar characterOfPhoneNumber = [[_store objectForKey "phone"] characterAtIndex:i]; 
   if ([numberCharacterSet characterIsMember:characterOfPhoneNumber]) 
   { [self.phoneNumber appendString:[NSString stringWithFormat "%c",characterOfPhoneNumber]];
 } 
} 
```

//在上面的代码中，我解析了每个字符并检查它是否是一个数字，将它添加到一个数组中，因此该数组是免费的。PS:\U00a0 是一个字符

# sql - 嵌套语句和 CTE 的查询设计

> ID：13095711
> 
> 赞同：1
> 
> 时间：2012-10-26T23:27:24.777
> 
> 标签：sql, nested, common-table-expression

我有一个查询，它从原始数据源顺序连接 6 个表。嵌套，这是一团糟：

```
SELECT
FROM
(
    SELECT
    FROM
    (
        SELECT
        FROM
        (. . .)
        INNER JOIN
    )
    INNER JOIN
) 
```

我切换到 CTE 定义，每个定义都是前一个定义的一个连接，最后的最终查询提供结果：

```
WITH
Table1 (field1, field2) AS
(
    SELECT
    FROM 
    INNER JOIN
),

Table2 (field2, field3) AS
(
    SELECT
    FROM Table1
    INNER JOIN
), . . . 

SELECT 
FROM Table 6 
```

这更具可读性，并且依赖关系按逻辑顺序向下流动。然而，这似乎不是 CTE 的预期用途（也是我不使用视图的原因），因为每个定义实际上只按顺序引用一次。

有没有关于如何构建这样的顺序嵌套连接的指导，这种连接在结构上既可读又合乎逻辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T18:00:00.750

我认为利用 CTE 创建临时视图没有任何问题。

1.  在较大的商店中，定义了角色，将 DBA 与开发人员的职责分开。一般来说，CREATE 语句将成为这种官僚主义的牺牲品。因此，没有看法。CTE 是一个很好的折衷方案。
2.  如果视图无论如何都不是真正可重用的，那么将其与 SQL 一起保存会使其更具可读性。
3.  CTE 比子查询（即使只有一层）更具可读性和直观性。如果您的子查询不相关，我只是建议将您的所有子查询转换为 CTE。
4.  递归是 CTE 的“杀手”应用程序，但这并不意味着您不应该使用 CTE，否则。

我能想到的唯一缺点是（取决于您的数据库引擎）它可能会混淆或阻止优化器执行它应该执行的操作。优化器足够聪明，可以为您重写子查询。

现在，让我们讨论一下 CTE 的滥用，注意不要用应用程序开发人员的知识代替数据库引擎优化。有很多聪明的开发人员（比我们更聪明）设计了这个软件，尽可能多地编写不带 cte 或子查询的查询，让 DB 完成工作。例如，我经常看到开发人员在进行联接之前对子查询中的每个键进行 DISTINCT/WHERE。你可能认为你在做正确的事，但事实并非如此。

关于您的问题，大多数人打算解决问题而不是讨论理论问题。因此，你会让人们对你所追求的东西摸不着头脑。我不会说你在你的文字中没有暗示，但也许更有力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T18:19:00.277

你为什么不像这样加入你的桌子

```
select *
from Table1 as t1
    inner join Table2 as t2 on t2.<column> = t1.<column>
    inner join Table3 as t3 on t3.<column> = t2.<column>
    inner join Table4 as t4 on t4.<column> = t3.<column>
    inner join Table5 as t5 on t5.<column> = t4.<column>
    inner join Table6 as t6 on t6.<column> = t5.<column> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T23:42:57.847

可能是我不明白这个问题，但有什么问题：

```
select * from table1 t1, table2 t2, table3 t3, table4 t4, table5 t5, table6 t6 
where t1.id = t2.id and t2.id = t3.id and  t3.id = t4.id 
  and t4.id = t5.id and t5.id = t6.id 
```

或同样使用`table 1 t1 INNER JOIN table2 t2 ON t1.id = t2.id ....`

# git - GIT 存储库迁移

> ID：13095714
> 
> 赞同：1
> 
> 时间：2012-10-26T23:27:45.833
> 
> 标签：git

我提前道歉，我觉得这是一个愚蠢的问题：/

不久前我开始学习 GIT，并在一些项目中使用它。不久后，我备份了所有内容并重新格式化了我的电脑。然后我犯了一个大错误，在我的 PC 上安装 GIT 几个月，同时从事相同的项目。我决定结束我的愚蠢并重新安装 GIT。我隐藏的 .git 文件夹仍在我的项目文件夹中。但是，在我开始签出和提交更改之前，我想确保我正在正确迁移。我是否正确地说，在我的 GIT 中断期间，我在过去几个月中一直在使用的可见文件只是来自我最近签出的分支的文件？我不想签出包含旧文件的分支，结果却丢失了我在 GIT 中断期间过去几个月所做的所有工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:30:59.930

是的，您的工作副本中的文件（大概）与您备份之前的完全相同。此时，您需要做的就是安装 Git，然后`git`命令将在您的工作文件夹中运行。您可能希望从提交自上次使用 Git 以来所做的更改开始。

# android - Android模拟器图像存储在哪里？

> ID：13095718
> 
> 赞同：51
> 
> 时间：2012-10-26T23:28:38.630
> 
> 标签：android, android-emulator, android-file

在模拟器上，我从谷歌下载了一张图片。我可以在模拟器上找到图像，但我不知道图像的文件位置是什么。要调试我的应用程序，我需要知道该图像在哪里。如何获取图像的完整路径？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-10-26T23:30:50.580

从[AVD 文档](http://developer.android.com/tools/devices/managing-avds-cmdline.html)：

> 默认情况下，android 工具会在内部`~/.android/avd/`（在 Linux/Mac`C:\Documents and Settings\<user>\.android\`上）、Windows XP 以及`C:\Users\<user>\.android\`Windows 7 和 Vista 上创建 AVD 目录。

`C:\Users\<user>\.android\`更新 (2020-02-22)：此措辞不再出现在当前文档页面上，但在 Windows 8 和 10 上的位置似乎相同 ( )。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-12-06T09:45:40.527

系统镜像下载在 [ {android_version_home_dir}/sdk/system-images/{android-version-number}/system.img> ]

并且 avd 在 C:\Users\.android\avd\ (windows) 或 ~/.android/avd/ (linux/mac) 中创建

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2021-03-09T12:29:18.713

官方文档中不明显的东西

[![也许这个？](../Images/c4660a70a76ffb5d3099ee2d2bc5d41c.png)](https://i.stack.imgur.com/ucShh.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-31T21:44:46.253

这似乎对我有用：

```
String path = Environment.getExternalStorageDirectory().getPath();
String myJpgPath = path + "/Download/dog-best-friend-1.jpg"; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-27T05:39:19.827

如果您的图像存储在您的模拟器上，那么您可以使用文件 Explore 找到该图像

首先启动你的模拟器然后：

打开您的文件资源管理器并转到`mnt/sdcard/Download`您将在此处找到您的图像（如果已下载）。

在 Eclipse 中打开文件探索：`window/show view/other/File Explore`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-07-18T09:14:42.507

在 Windows 中 ---> C:\Documents and Settings<用户>.android\

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-10-10T10:45:42.947

要找到确切的路径，请打开模拟器转到照片，然后单击照片（如果有），然后单击 i（获取信息）。在那里您可以看到设备上的确切路径。要动态访问这些文件，请尝试：

```
 String path = Environment.getExternalStorageDirectory().getPath();
    String pathPhotos = path2 +"/Download";
    File[] fileArr = new File(pathPhotos).listFiles();

    for(int i = 0; i < fileArr.length; i++) {
        Log.d("fileName12", " " + fileArr[i].getPath());
    } 
```

如果 listFiles 返回 null 您必须添加：
uses-permission *android:name="android.permission.READ_EXTERNAL_STORAGE" /> 并更改 Emulator -> settings -> Apps -> App Permissions -> storage -> your应用名称 -> 开启

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-03-08T17:23:30.127

在窗户上：->`C:\Users\yourUser\Documents\AndroidStudio\DeviceExplorer\Pixel_2_API_30 [emulator-5554]\data\data\com.yourpackage\files`

在模拟器名称之后，您可以选择代码中的路径。

# iphone - 如何在 Objective-C 中解析这个 JSON

> ID：13095719
> 
> 赞同：0
> 
> 时间：2012-10-26T23:28:37.830
> 
> 标签：iphone, json

我是 iPhone 编程的新手。我必须在 Objective-C 中以 JSON 格式解析这些数据。

{"success":1,"check":[{"ChkKey":"2","ChkDeb":"Connection 1","ChkSSID":"Netgear-1111","ChkIP":"192.168.2.103", "ChkBlk":"0"}]}

我按照使用 Json 解析数据的示例进行操作。但是这个 JSON 是如此不同。它由两个Array组成。我该如何进行？谢谢 - 抗体

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T00:14:12.377

试试这样的东西怎么样...

```
//JSON string
NSString *jsonString = @"{\"success\":1,\"check\":[{\"ChkKey\":\"2\",\"ChkDeb\":\"Connection 1\",\"ChkSSID\":\"Netgear-1111\",\"ChkIP\":\"192.168.2.103\",\"ChkBlk\":\"0\"}]}";

//Parse JSON string into an NSDictionary
NSError *e = [[NSError alloc] init];
NSDictionary *jsonData = [NSJSONSerialization JSONObjectWithData:[jsonString dataUsingEncoding:NSUTF8StringEncoding] options:NSJSONReadingMutableContainers error:&e];

//Output the value of success
NSLog(@"Success:%@", [jsonData objectForKey:@"success"]);

//Get data in the check array
NSDictionary *checkData = [[jsonData objectForKey:@"check"] objectAtIndex:0];

//Output the value of ChkSSID
NSLog(@"ChkSSID:%@", [checkData objectForKey:@"ChkSSID"]); 
```

# ruby-on-rails - 如何使用 ActsAsTaggableOn 重命名标签

> ID：13095724
> 
> 赞同：1
> 
> 时间：2012-10-26T23:30:13.983
> 
> 标签：ruby-on-rails, acts-as-taggable-on

在 rails 3 应用程序中，我使用 ActsAsTaggableOn 来标记我的文章。

我希望能够使用编辑视图重命名标签。

我制作了一个 *tags_controller.rb* 和一个*view/tags/edit.html.haml*。在 tags_controller.rb

```
def edit
  @tag =  ActsAsTaggableOn::Tag.find(params[:id])
end 
```

在视图/tags/edit.html.haml

```
= form_for(@tag, :html => {:multipart => true})  do |f| 
```

给我一个错误：#<#:0x007fdd7404ee40> 的未定义方法` **acts_as_taggable_on_tag_path '**

我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T00:27:32.710

永远不要尝试这个宝石，但我认为它可以帮助你轻松地做到这一点：[https ://github.com/kryzhovnik/rails_admin_tag_list](https://github.com/kryzhovnik/rails_admin_tag_list)

# google-sheets - Google 电子表格 ImportXML 函数的问题

> ID：13095734
> 
> 赞同：1
> 
> 时间：2012-10-26T23:32:10.920
> 
> 标签：google-sheets, google-sheets-importxml

我的 Google 电子表格中的 ImportXML 存在一些问题。我目前有两张表，每张都有自己的 ImportXML，检索（基本上）相同的数据 - 提供数据的服务器已经更新了他们的提要服务，要求在 URL 中使用特定于用户的“密钥”来跟踪谁在检索什么。在此更改之前，我的 ImportXML 工作得很好。他们即将关闭非关键提要，而我的电子表格即将损坏。

在第一个（工作）表中，[这是 feed](http://atilla.hinttech.nl/fseconomy/xml?id=18649&key=M3LRG43T&query=GroupLogByMonth&month=10)。

我可以在单元格 A1 中使用以下语法成功导入数据：

```
=importXML(ʺhttp://atilla.hinttech.nl/fseconomy/xml?id=18649&key=M3LRG43T&query=GroupLogByMonth&month=10ʺ,ʺ//GroupLogByMonthʺ) 
```

在新的（非工作）表中，提要的 URL（包括我的用户特定的“键”）是[here](http://atilla.hinttech.nl/fseconomy/data?userkey=85AHFXVQIC&format=xml&query=flightlogs&search=monthyear&readaccesskey=YGTWNDAXV7&month=10&year=2012)。

我无法在此工作表上创建有效的 importXML。我尝试的 Xpath 查询都没有工作，除了“*”；但这导致所有元素都集中在一个单元格中。

我已经与这些表格中的每一个共享了我的电子表格文件（链接在下面的评论中 - 我无法发布超过 2 个链接），以便可以查看和播放上述示例。任何关于非工作表的建议都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T13:49:04.127

在新的 XML 提要中，没有标签“GroupLogByMonth”。这可以解释为什么当您查找 Xpath 查询时不会返回任何内容。

新 URL 旁边的 XML 格式是否也发生了变化？

# jquery - jQuery 省略号插件不适用于“最大高度”

> ID：13095739
> 
> 赞同：0
> 
> 时间：2012-10-26T23:32:56.990
> 
> 标签：jquery, plugins, ellipsis, css

我需要能够将这个插件与“max-height”css一起使用，现在它只有在我定义了一个确定的高度时才有效，但如果它有 max-height 则不行。有没有办法让这项工作也能奏效？

```
(function($) {
        $.fn.ellipsis = function()
        {
                return this.each(function()
                {
                        var el = $(this);

                        if(el.css("overflow") == "hidden")
                        {
                                var text = el.html();
                                var multiline = el.hasClass('multiline');
                                var t = $(this.cloneNode(true))
                                        .hide()
                                        .css('position', 'absolute')
                                        .css('overflow', 'visible')
                                        .width(multiline ? el.width() : 'auto')
                                        .height(multiline ? 'auto' : el.height())
                                        ;

                                el.after(t);

                                function height() { return t.height() > el.height(); };
                                function width() { return t.width() > el.width(); };

                                var func = multiline ? height : width;

                                while (text.length > 0 && func())
                                {
                                        text = text.substr(0, text.length - 1);
                                        t.html(text + "...");
                                }

                                el.html(t.html());
                                t.remove();
                        }
                });
        };
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:46:34.273

看起来我们可以创建一个新变量来检查 maxHeight 属性是否存在，但我们需要清理它。

```
var myHeight = (el.css('maxHeight')) ? el.css('maxHeight').split('px')[0] : el.height(); 
```

如果有一个 maxHeight，我们会得到一个类似 的值`500px`，我们不想要`px`，所以我们拆分了字符串并取了数组的第一部分，它是原始整数。

现在我们可以替换`el.height()`为`myHeight`，如果可用，您将获得 maxHeight，否则您将获得 height 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-25T06:00:12.707

问题似乎是在 jQuery 的 height() 中没有考虑最大高度。我通过更改插件以接受 max_height 参数而不是在 css 中执行 max-height 来使其工作：

```
$.fn.ellipsis = function(max_height) 
```

然后改变高度函数：

```
function height() { return t.height() > max_height; }; 
```

不是超级优雅，但它说明了问题。

顺便说一句，上面的原始代码来自这里：[https ://stackoverflow.com/a/1022672/986840](https://stackoverflow.com/a/1022672/986840)

# iphone - iOS - 块慢得要命

> ID：13095743
> 
> 赞同：1
> 
> 时间：2012-10-26T23:33:33.293
> 
> 标签：iphone, ipad, block

我在应用程序的界面上有大约 10 个对象。这些对象基本上是一个按钮，具有发光显示哪个按钮在给定时间处于活动状态。当一个按钮被选中时，它的发光被打开，而所有其他按钮的发光被关闭。

要打开和关闭发光，我有这个

```
[buttons enumerateObjectsWithOptions:NSEnumerationConcurrent
                                     usingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    if (obj == sender)
            [(myButtonClass *)obj showGlow];
    else {
            [(myButtonClass *)obj hideGlow];
    }
}]; 
```

但我被迫改成这个

```
[buttons enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {

    if (obj == sender)
            [(myButtonClass *)obj showGlow];
    else {
            [(myButtonClass *)obj hideGlow];
    }
}]; 
```

删除枚举的并发部分。问题在于，特别是对于某些按钮，发光需要 5 秒才能打开或关闭，但始终只针对相同的按钮。我的印象是它们处于一种按顺序处理的队列中（?????!!!）

showGlow/hideGlow 方法基本上是两行：设置一个变量和设置发光图像视图的隐藏属性打开和关闭。因此，这些是所有按钮的快速方法。

我不明白为什么某些按钮会出现问题，而其他按钮则不会，以及为什么当应用程序基本上空闲时处理一个块需要这么长时间。

任何线索？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T23:52:40.747

“缓慢”的 UI 更新的一个原因可能是，当使用该`NSEnumerationConcurrent`选项时，枚举发生在主线程以外的线程上。由于所有 UI 更新都应该发生在主线程上，因此您的 UI 更改不会立即反映，而是在运行循环刷新所有更改后延迟。

在您的情况下，您只有 10 个对象，这不证明使用并发选项是合理的。此外，当您可以使用易于阅读的或快速枚举时，为什么要使用块使代码复杂化，forin：

```
for (UIButton *button in buttons) {
    if (button == sender) [button showGlow];
    else [button hideGlow];
} 
```

如果您在某处启动活动指示器，然后在后台线程中停止它，您可以试验并观察相同的延迟 UI 更新。它将需要几秒钟才能真正停止。

如果你坚持使用块，你必须在主线程中调用所有 UIKit 方法：

```
[buttons enumerateObjectsWithOptions:NSEnumerationConcurrent
                                 usingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    if (obj == sender)
        // One possibility with GCD and dispatch_async on the main queue
        dispatch_async(dispatch_queue_get_main(), ^{[(myButtonClass *)obj showGlow];});
    else {
        // another possibility to call the selector on the main thread
        [(myButtonClass *)obj performSelectorOnMainThread:@selector(hideGlow)];
    }
}]; 
```

# objective-c - 从http get请求解析对象c中的json响应

> ID：13095755
> 
> 赞同：0
> 
> 时间：2012-10-26T23:35:52.403
> 
> 标签：objective-c, json, cocoa, http, nsstring

我正在尝试解析从对象 c 中的 http get 请求获得的响应，我已经这样做了：

```
 NSString *returnValue = [[NSString alloc] initWithData:oRespondeData encoding:NSUTF8StringEncoding];
    SBJsonParser *jParser = [[SBJsonParser alloc] init];
    NSDictionary *JSONresponse = [jParser objectWithString:returnValue]; 
```

然后我搜索一个特定的键：

```
NSArray *jSon1 = [JSONresponse objectForKey:@"links"]; 
```

并且在数组中只有一个元素，如果我记录它，我有这个：

```
NSLog(@"%@",[jSon1 objectAtIndex:0]); 
```

日志：

```
(
"Video.720p.X264-..",
"",
"http://video/dl/Video.720p.X264-.."
) 
```

我怎样才能用http获取url？我已经尝试了一切，我也尝试修剪字符串以删除空格，但似乎它不是 nsstring 因为我收到

```
[__NSArrayM stringByTrimmingCharactersInSet:]: unrecognized selector sent to instance 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:48:51.220

`[jSon1 objectAtIndex:0]`

正在返回一个由 3 个单独的字符串组成的数组，所以如果你想获取第三个字符串，你可以这样做：

`NSArray *links = [jSon1 objectAtIndex:0];`

`NSString *httpUrl = [links objectAtindex:2];`

希望我能正确理解你的问题。

# android - Android 模拟器不能在笔记本电脑上启动，而是在台式电脑上启动

> ID：13095760
> 
> 赞同：2
> 
> 时间：2012-10-26T23:36:45.617
> 
> 标签：android, android-emulator

我有一个奇怪的问题，或者可能是硬件相关的问题。我有一台台式电脑（英特尔酷睿 i7、nvidia GTX 470、6GB 内存）和一台笔记本电脑（酷睿 i3 380M、英特尔显卡、6GB 内存）。新安装的 Windows 7 64 位（PC 上的终极版和笔记本电脑上的家庭版）。

我安装了最新版本的 Android SDK（在默认路径上的两台机器上），模拟器在台式机上运行没有问题，但在笔记本电脑上它永远不会启动，我试图通过 AVD 管理器启动它，它永远不会启动，我的意思是它甚至没有出现，也没有错误消息。后来我尝试通过调用通过命令行运行模拟器，但`emulator.exe @myAVD`我得到了`emulator-arm.exe stopped working`异常。

我尝试制作具有不同 android 版本、不同设备内存、启用/禁用 gpu 仿真和其他所有可能选项的模拟器。它只是不能在我的笔记本电脑上运行。

我想知道是否有人有/有类似的问题。

**更新**

奇怪的是，如果我直接调用`emulator-arm.exe @myAVD`模拟器在我的笔记本电脑上启动就好了。我不知道为什么它不能从 AVD Manager 运行或调用`emulator.exe @myAVD`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T19:29:48.037

我发现这可能是英特尔 GMA 芯片的 VGA 驱动程序的问题。

我不得不通过调用`emualtor-arm.exe @myAVDNAME`而不是 AVD 管理器或`emulator.exe`命令来手动启动模拟器。

# biztalk - 错误 Biztalk 适配器“SOAP”在接收位置“发票接收位置”上接收到带有 URI 的消息被挂起

> ID：13095762
> 
> 赞同：0
> 
> 时间：2012-10-26T23:37:03.697
> 
> 标签：biztalk, biztalk-2010

任何人都可以帮助解决这个错误吗？

> 适配器“SOAP”在接收位置“发票接收位置”上使用 URI“/B2BOrchesstrations_WebService/B2BOrchesstrations_B2BProcess_ReceiveInvoice_Port.asmx”接收的消息被挂起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:26:00.123

这意味着 BizTalk 无法处理该消息，因此已将其置于挂起状态。如果您打开 BizTalk 管理控制台，然后单击“组中心”，然后刷新，您应该会看到一个指向挂起项目的链接。从这里您应该能够找到您的暂停消息以及解释暂停原因的错误消息。

暂停的一个常见原因是该消息没有活跃的订阅者。应该发布接收到的消息的发送端口是否可能已被取消登记？

# java - 循环内的扫描仪 - 为什么输入不正确的输入时它不退出循环？

> ID：13095765
> 
> 赞同：0
> 
> 时间：2012-10-26T23:37:53.370
> 
> 标签：java

编码 -

```
for(int i = 0; i < count; i++)
    {
     System.out.println("Please enter a number!");
    try{
         numbers[i] = keyboardScanner.nextInt();
    }catch(InputMismatchException ex)
    {
      System.out.println("You did not enter a number!");
    }
} 
```

如果你输入一个字符串，它会循环直到'count'。为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T23:39:07.350

当然，它会循环直到`count`：你捕获到异常并继续循环。

`break`当您遇到该异常时，您想退出循环：

```
System.out.println("You did not enter a number!");
break; 
```

# java - Eclipse 不运行我的应用程序

> ID：13095766
> 
> 赞同：0
> 
> 时间：2012-10-26T23:37:56.707
> 
> 标签：java, eclipse

这是一个奇怪的问题，我完全感到困惑。

我的应用程序运行正常。一旦我尝试重新运行它甚至不改变一行它就不再运行了。

它在控制台中没有显示任何特殊内容，但显示 HTTP 状态 404，并且消息显示“请求的资源 (/MyProject/) 不可用。”

我正在使用 Eclipse 和 tomcat 服务器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:40:18.987

我在使用 Eclipse 时遇到问题，我的程序从之前的启动中运行，并在尝试再次启动时出错。如果是这种情况，您必须停止之前的运行并启动新的运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T23:40:25.337

您是否尝试在 tomcat 服务器上清理并重新发布您的应用程序？

# c# - 使用 XNA KeyboadInput 在 C# 中进行线程化

> ID：13095770
> 
> 赞同：1
> 
> 时间：2012-10-26T23:38:17.440
> 
> 标签：c#, multithreading, xna-4.0

我对线程有点陌生（对 C# 不是新手，只是没有做太多线程）。有人可以向我解释为什么这不起作用吗？

我有一个线程调用我将调用“循环”的方法。Loop 包含一个 while 循环，它将持续运行，并且在 while 的每个循环中，我希望它检查 A 键是否已关闭（使用 XNA 框架中的 Microsoft 键盘类）。但由于某种原因，它从来没有记录任何被按下的东西。

```
static Thread thread = new Thread(Loop);
static bool abort = false;

public static void Begin()
{
    thread.Start();
}

private static void Loop()
{
    while (!abort)
    {
        if (Keyboard.GetState().IsKeyDown(Keys.A))
            Console.WriteLine("A pressed.");
    }
} 
```

可能有人知道为什么永远不会调用 Console.WriteLine() 吗？

编辑：

我想我应该稍微解释一下。我实际上想要做的是在 C# 中创建类似于 ActionScript 的事件。因此，如果在包含此线程的单独类中满足该条件，我想传递一个“条件”和一个“动作”来调用。这将允许我向对象添加“事件侦听器”，它会自动不断地检查是否触发了其中一个事件，而不是让我在代码中编写 If 语句来检查事件。

在尝试这样做时，我测试的第一件事是关于这个 XNA 键盘的东西，因为这是我最初想要构建这个系统的原因之一，但它没有工作。因此，我创建了我在上面发布的独立代码，以查看我在之前的代码中是否出错并且它仍然无法正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:57:00.060

我从不使用 XNA，所以我并不真正“知道”，但我遇到过类似的情况，您无法从工作线程获取键盘（和其他）输入。我搜索了一下，发现在 XNA 中似乎确实如此。[例如](http://social.msdn.microsoft.com/Forums/is/xnaframework/thread/0fc4492d-28d5-4f80-a97f-2ecb4c81b380)看这个

所以你需要（并且可能想要）在 GUI 线程中处理你的游戏输入。只需检查每个更新滴答的输入就可以了。我怀疑即使它确实有效，你也会获得任何性能 - 你可能会引入一些有趣的同步错误 ;-)

看起来您确实正确地创建了工作线程 - 这不是它的应用程序。

# r - R中带有knitr和markdown的自定义CSS

> ID：13095772
> 
> 赞同：9
> 
> 时间：2012-10-26T23:38:25.897
> 
> 标签：r, markdown, knitr

我找到了这篇很棒的教程，介绍了如何修改在 Rstudio 中使用 markdown 和 knitr 创建的 HTML 报告的 css 格式。帖子可以在[这里](http://nsaunders.wordpress.com/2012/08/27/custom-css-for-html-generated-using-rstudio/)找到。

我希望以此概念为基础，并通过使用相同的 css 来模仿[此处的页面布局。](http://www.seas.harvard.edu/courses/cs281/)我试图简单地复制/粘贴/组合我在查看页面源时找到的两个 css 文件。

您可以提供的任何帮助将不胜感激！这是我第一次尝试做任何 CSS。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-27T00:00:58.097

这是 RStudio 提供的方法：[http ://www.rstudio.com/ide/docs/authoring/markdown_custom_rendering](http://www.rstudio.com/ide/docs/authoring/markdown_custom_rendering)

```
options(rstudio.markdownToHTML = 
  function(inputFile, outputFile) {      
    require(markdown)
    markdownToHTML(inputFile, outputFile, stylesheet='custom.css')   
  }
) 
```

* * *

我从来没有能够让它正常工作，所以我做的有点不同：

我通过创建标准输出文件来做到这一点，然后将标题和 css 代码放在 R 的顶部：

```
tmp <- readLines("your.html") 
tmp <- tmp[-c(1:50)] # or however many lines it is before the css ends
write(tmp,"your.html") 
```

然后我使用 pandoc 在独立文件中添加我自己的 css

```
system("pandoc -s -S your.html -c your.css -o output.html") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-02T20:16:58.000

在 RStudio 之外（也可以在其中工作 - 我不确定，因为我不经常使用它），您可以使用选项“markdown.HTML.stylesheet”来设置自定义样式表。然后它会将您的 .css 文件中的所有内容导入到新创建的 html 文件中。

这是一个例子：

```
## Set file names
htmlName <- "test.html"
rmdName <- gsub("html","Rmd", htmlName) 
stylesheetName <- 'style.css'

## Generate rmd file from R
sink(file = rmdName, type='output') 
    cat('\n<textarea maxlength="3000" cols="70">') 
    cat("Hello World!") 
    cat('</textarea>\n') 
sink()

## Generate style sheet from R
sink(file = stylesheetName, type='output') 
    cat("textarea {color: #a10000; }\n")
sink()

## Set knitr options and knit html
require(knitr) 
options(markdown.HTML.stylesheet = stylesheetName)
knit2html(rmdName, output = htmlName) 
```

# git - github网站上committer的用户名不可点击

> ID：13095774
> 
> 赞同：6
> 
> 时间：2012-10-26T23:38:57.583
> 
> 标签：git, github

你们知道为什么在github的“提交历史”中committer的用户名不可点击吗？我通过调用设置我的用户名

```
git config --global user.name "myname" 
```

它与我的帐户名匹配，但仍然提交看起来像是由非 github 用户制作的（无法访问个人资料，没有个人资料图片等）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-26T23:45:08.457

GitHub 通过电子邮件匹配贡献者，因此请务必进行设置`user.email`。

# backbone.js - 带有主干.js 的 DomReady

> ID：13095780
> 
> 赞同：3
> 
> 时间：2012-10-26T23:40:07.697
> 
> 标签：backbone.js, backbone-views, domready

我正在使用backbone.js 创建一个单页应用程序。我是骨干新手，所以请原谅任何错误的语义。

我的问题是渲染视图时。

最初，我的 index.html 中有一个执行某些 dom 操作（图像滑块）的 javascript。

JS 包含在 $(window).load() 中，因此启动时一切正常。除非从 url 加载页面，否则代码显然不会执行。代码不会从主干视图或路由器运行。所以页面加载时没有 dom 操作。

我试图将我的代码插入到视图中的渲染和初始化函数中，但无济于事。我应该将此代码添加到路由器吗？这似乎有点骇人听闻。

我应该在哪里包含“dom ready”代码？和/或是否有更好的方法来管理主干中加载的视图及其 dom 元素？

编码：

**主页.js**

```
window.HomeView = Backbone.View.extend({
initialize:function () {
    this.render();
},

render:function () {
    $(this.el).html(this.template());

    this.startOrbits();
    return this;
},

startOrbits:function(){
    $(window).load(function() {
        $('#orbit-main').orbit({ fluid: '16x6', swipe:true });
        $('#orbit-news').orbit({ fluid: '8x6', bullets: true, directionalNav:false, captions:true, advanceSpeed: 9000});
    });
},

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T19:23:53.957

我能够找到解决方案。在我的路由器函数中注释掉 if 语句后，事情进展顺利。

```
 home: function () {
            // if (!this.homeView) {
                this.homeView = new HomeView();
            // }
            $('#main-content').html(this.homeView.el);
            this.homeView.startOrbits();
            this.headerView.selectMenuItem('home');
        }, 
```

我确实意识到这意味着我在每个溃败触发器上创建一个新视图。请随时提供更优化的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T00:20:15.497

> 但是当我转到另一个视图，然后返回时，代码显然不会令人兴奋

我不太确定那是什么意思。撇开“兴奋”的部分不谈，你不会“去”观点；视图只是向页面添加元素或向现有元素添加逻辑的方法。

如果我不得不猜测，我会想象您正在使用 Backbone 路由器在虚拟“页面”之间移动（并且您使用视图来制作这些页面）。如果是这种情况，您需要查看 Backbone 路由器事件：

[http://documentcloud.github.com/backbone/#Router](http://documentcloud.github.com/backbone/#Router)

[http://documentcloud.github.com/backbone/#FAQ-events](http://documentcloud.github.com/backbone/#FAQ-events)

具体来说，我认为您想将事件处理程序（在您的路由器上）绑定到“route：nameOfYourRoute”，或者只是：route”（如果您想在每个虚拟页面加载时触发您的逻辑）。

希望对您有所帮助，如果我的猜测是错误的，请编辑您的问题以澄清。

# jquery - jquery 无法从 perl 获得响应

> ID：13095782
> 
> 赞同：2
> 
> 时间：2012-10-26T23:40:20.053
> 
> 标签：jquery, ajax, perl

我想使用 jquery 来实现服务器上 perl 脚本的 ajax 响应。但是当我使用这样的代码时，我什么也没得到。我可以从浏览器中的 url 得到结果，所以我不知道哪里错了。

```
$(document).ready(function(){
$("button").click(function(){

$.ajax({
  'type': 'GET',
  'url': 'http://XXXX/cgi-bin/XXX.pl?title=dd',
  'async': true,
  'success': function(data) {
        alert(data);
  }
});

});
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T13:07:06.237

如果*url*字段包含`http://server.domain/`并且如果您尝试从位于*http://server.domain/*以外的网页访问服务器（例如在您的桌面示例中，通过 访问`file:///`），您可能需要`Access-control-allow-origin: *`在发送的标头中添加一个字段你的 perl CGI：

```
#!/usr/bin/perl -w

use CGI;
my $q=new CGI;

print $q->header(-type=>"text/plain", -Access_Control_Allow_Origin=>"*")."Answer"; 
```

注意安全考虑...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T00:20:38.310

尝试运行以下诊断：

```
$(document).ready(function(){
    $("button").click(function(){
        alert('click happened');
        $.ajax({
            'type': 'GET',
            'url': 'http://XXXX/cgi-bin/XXX.pl?title=dd',
            'async': true,
            'success': function(data, textStatus, jqXHR) {
                alert('ajax success: ' + [data, textStatus]);
            },
            'error': function(jqXHR, textStatus, errorThrown){
                alert('ajax error: ' + [textStatus, errorThrown]);
            }
        });
    });
}); 
```

在警报（或没有警报）中的某个地方，您应该知道什么是失败的。

# javascript - 如何从内容中直接调用菜单项？

> ID：13095784
> 
> 赞同：0
> 
> 时间：2012-10-26T23:41:00.397
> 
> 标签：javascript, jquery

我有这段代码，它适用于显然是 ul> li> 菜单的旋转菜单。

我想知道的是如何触发（onClick，HRef等）特定列表项的功能，例如rot7。

我想单击一行文本并触发该功能，这可能吗？

例如“点击这里去那里”，

有点像过去 - {a href="some.html"}Click Here{/a} 页面加载。

在这种情况下，我希望文本使用 JQuery 脚本的形式和功能打开第 7 个 li> 菜单项。

那里，清澈如泥。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <title>Bridgett's Electrolysis</title>
        <!-- Favorite Icon --><link rel="shortcut icon" href="images/beLogoColor3D.png" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><link rel="stylesheet" href="css/style.css" type="text/css" media="screen"/>
        <link href="css/jquery-ui.css" rel="stylesheet" type="text/css" />
        <style>
            *{
                margin:0;
                padding:0;
            }
            body{
                font-family:Arial;
            }
            #content{
                margin:150px auto 10px auto;
            }
            .reference{
                clear:both;
                width:800px;
                margin:30px auto;
            }
            .reference p a{
                text-transform:uppercase;
                text-shadow:1px 1px 1px #fff;
                color:#666;
                text-decoration:none;
                font-size:10px;
            }
            .reference p a:hover{
                color:#333;
            }
            </style>
        <script type="text/javascript">
            // EDITED 
            $(function () {
                $('#link6').click(function () {
                    $('#rotmenu li:nth-child(6)').click();
                });
            });
        </script>
    </head>
        <body>
        <div class="logoback">
            <div id="logo">
                <img src="images/beWebLogoColor3D.png" height="250">
            </div>
        </div>
        <div id="content">
            <div class="rotator">
                <div class="myh">STOP  TWEEZING  UNWANTED  HAIR.....FOREVER!!!</div>
                <ul id="rotmenu">
                    <li>
                        <a href="rot1" class="mytabs">Home</a>
                        <div style="display:none;">
                            <div class="info_image">1.jpg</div>
                            <div class="info_heading">Relax</div>
                            <div class="info_description">
                                <div class="myh1">Eliminate Unwanted Hair</div><br />
                                <div class="col2"><img src="images/page1_img1.png" alt="" width="90%"></div>
                                <div class="col2">
                                    <span class="myh2">Safe, Permanent Hair Removal<br />
                                        <br />
                                        Electrolysis is:</span><br />
                                    <span class="myh3home">• Still the only true permanent hair removal method and the only
                                        permanent treatment recognized by the FDA<br />
                                        • An excellent solution for those discouraged by the unsuccessful results of temporary
                                        hair removal methods<br />
                                        • For everyone<br />
                                        • The preferred treatment for combating folliculitis<br />
                                        <br />
                                    </span> 
                                </div>   
                                <div id="mycenter" class="myh2"><a id="link6" href="javascript:;">Book now to schedule your Complimentary Consultation</a>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <a href="rot2" class="mytabs">News</a>
                        <div style="display: none;">
                            <div class="info_image">2.jpg</div>
                            <div class="info_heading">The Scoop</div>
                            <div class="info_description">
                                <div class="col1">
                                    <img src="images/page2_img1.jpg" alt="" />
                                    <img src="images/appointment-request1.png" width="60%" alt="" />
                                    <img src="images/page2_img3.jpg" alt="" />
                                </div>
                                <div class="col3">
                                <div class="mytabs">Open at our new Location!</div>
                                    <span class="myh3">See our Location Section for a Map or Directions.</span><br /><br /><br /><br />
                                    <div class="mytabs">Online Appointment Booking is Now Available!</div>
                                    <span class="myh3">Go to our Appointments Section and schedule your appointment today.</span><br /><br /><br /><br />
                                    <div class="mytabs">All New Equipment!</div>
                                    <span class="myh3">The latest and greatest equipment has been installed to offer you the most comfortable Electrolysis experience.</span>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <a href="rot3" class="mytabs">Services</a>
                        <div style="display:none;">
                            <div class="info_image">3.jpg</div>
                            <div class="info_heading">Here to Serve You</div>
                            <div class="info_description">
                                    <span class="mytabs">Electrolysis</span><br />
                                    <span class="myh3">These are the areas that Electrolysis can be performed on.</span><br />
                                    <img src="images/areas.png" / width="100%" height="350">
                            </div>
                        </div>
                    </li>
                    <li>
                        <a href="rot4" class="mytabs">Location</a>
                        <div style="display:none;">
                            <div class="info_image">4.jpg</div>
                            <div class="info_heading">Come and Visit</div>
                            <div class="info_description">
                                <span class="mytabs">1003 E. Broad St. Mansfield TX 76063</span>
                                <iframe width="100%" height="355px" seamless="seamless" frameborder="0" scrolling="no" marginheight="0"
                                    marginwidth="0" src="http://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q=1003+E+Broad+St,+Mansfield,+TX&amp;aq=2&amp;oq=1003+E+Broad&amp;sll=32.800447,-97.289319&amp;sspn=0.966172,1.783905&amp;t=m&amp;ie=UTF8&amp;hq=&amp;hnear=1003+E+Broad+St,+Mansfield,+Texas+76063&amp;ll=32.565228,-97.130527&amp;spn=0.007568,0.013937&amp;z=14&amp;output=embed">
                                </iframe>
                                <br />
                            </div>
                        </div>
                    </li>
                    <li>
                        <a href="rot5" class="mytabs">Contact Us</a>
                        <div style="display:none;">
                            <div class="info_image">5.png</div>
                            <div class="info_heading">Get in Touch</div>
                            <div class="info_description">
                                <div class="col1">
                                    <span class="mytabs">Contact Info:</span><br />
                                    <span class="myh3">Bridgett's Electrolysis<br />
                                        1003 E. Broad St<br />
                                        Mansfield, TX. 76063<br />
                                        Phone:(817)879-7817<br />
                                        email: <a href="mailto:bridgettselectro@gmail.com?subject=Info Request from your site">
                                            bridgettselectro@gmail.com</a><br />
                                    </span>
                                </div>
                                <div class="col3">
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <a href="rot6" class="mytabs">FAQ</a>
                        <div style="display:none;">
                            <div class="info_image">6.png</div>
                            <div class="info_heading">Electrolysis Questions?</div>
                            <div class="info_description">
                                <Iframe src="faq/faq.htm" width="100%" height="400" frameborder="0" marginheight="0"></Iframe>
                            </div>
                        </div>
                    </li>
                    <li>
                        <a href="rot7" class="mytabs">Appointment</a>
                        <div style="display:none;">
                            <div class="info_image">book.jpg</div>
                            <div class="info_heading">Book It</div>
                            <div class="info_description">
                                <Iframe src="webappt/index.php" width="100%" height="405" frameborder="0" marginheight="0"></Iframe>
                            </div>
                        </div>
                    </li>
                    <li>
                        <a href="rot8" class="mytabs">FaceBook</a>
                        <div style="display:none;">
                            <div class="info_image">like.png</div>
                            <div class="info_heading">Coment or Like Us</div>
                            <div class="info_description">
                                <div class="mycenter"><span class="myh2">Be Sure to Visit our <a href="javascript: void(0)" onclick="window.open('https://www.facebook.com/bridgettselectro', 'FanPage');">FaceBook FanPage</a> for deals and coupons!</span></div>
                                <div class="col2">
                                    <div class="fb-like", data-href="http://www.bridgettselectro.com" data-send="false" data-width="450" data-show-faces="true" data-colorscheme="dark" data-font="arial"></div>
                                </div>
                                <div class="col2">
                                    <div class="fb-comments" data-href="https://www.facebook.com/BridgettsElectrolysis?fref=ts" data-num-posts="10" data-width="350"  data-colorscheme="dark"></div>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
                <div id="rot1">
                    <img src="" width="800" height="300" class="bg" alt=""/>
                    <div class="heading">
                        <h1></h1>
                    </div>
                    <div class="description">
                        <p></p>
                    </div>    
                </div>
            </div>
        </div>
         <!-- The JavaScript -->
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery.easing.1.3.js"></script>
        <script src="js/atooltip.jquery.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function () {
                var current = 1;

                var iterate = function () {
                    var i = parseInt(current + 1);
                    var lis = $('#rotmenu').children('li').size();
                    if (i > lis) i = 1;
                    display($('#rotmenu li:nth-child(' + i + ')'));
                }
                display($('#rotmenu li:first'));
                var slidetime = setInterval(iterate, 3000000);

                $('#rotmenu li').bind('click', function (e) {
                    clearTimeout(slidetime);
                    display($(this));
                    e.preventDefault();
                });

                function display(elem) {
                    var $this = elem;
                    var repeat = false;
                    if (current == parseInt($this.index() + 1))
                        repeat = true;

                    if (!repeat)
                        $this.parent().find('li:nth-child(' + current + ') a').stop(true, true).animate({ 'marginRight': '-20px' }, 300, function () {
                            $(this).animate({ 'opacity': '0.7' }, 700);
                        });

                    current = parseInt($this.index() + 1);

                    var elem = $('a', $this);

                    elem.stop(true, true).animate({ 'marginRight': '0px', 'opacity': '1.0' }, 300);

                    var info_elem = elem.next();
                    $('#rot1 .heading').animate({ 'left': '-420px' }, 500, 'easeOutCirc', function () {
                        $('h1', $(this)).html(info_elem.find('.info_heading').html());
                        $(this).animate({ 'left': '0px' }, 400, 'easeInOutQuad');
                    });

                    $('#rot1 .description').animate({ 'bottom': '-425px' }, 500, 'easeOutCirc', function () {
                        $('p', $(this)).html(info_elem.find('.info_description').html());
                        $(this).animate({ 'bottom': '0px' }, 400, 'easeInOutQuad');
                    })
                    $('#rot1').prepend(
                    $('<img/>', {
                        style: 'opacity:0',
                        className: 'bg'
                    }).load(
                    function () {
                        $(this).animate({ 'opacity': '1' }, 600);
                        $('#rot1 img:first').next().animate({ 'opacity': '0' }, 700, function () {
                            $(this).remove();
                        });
                    }
                ).attr('src', 'images/' + info_elem.find('.info_image').html()).attr('width', '1200').attr('height', '500')
                );
                }
            });
            (function (d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s); js.id = id;
                js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
                fjs.parentNode.insertBefore(js, fjs);
            } (document, 'script', 'facebook-jssdk'));
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T00:05:36.347

```
 <a id="link6" href="javascript:;">click to open menu 6</a>

  <script>
  // EDITED 
  $(function() {   
    $('#link6').click(function(){
       $('#rotmenu li:nth-child(6)').click(); 
    });
   });
  </script> 
```

编辑：

上面的代码将不起作用，因为每次菜单更改页面`.description`时都会在初始化时使用原始标签设置容器（）内容，因此包含我们`a`标签的页面内容被与前一个相同的原始内容覆盖，但是覆盖旧的，这就是点击处理程序不起作用的原因 - 因为它是在被覆盖的项目上设置的。

要在每次菜单更改页面时不设置点击处理程序，应该将其绑定到链接中，就像 taht: 一样简单`<a onclick="$('#rotmenu li:nth-child(6)').click();" href="javascript:;">Book now to schedule your Complimentary Consultation</a>`。就是这样 - 工作正常。

# flashdevelop - 在 FlashDevelop 中，如何让它停止使用包名自动限定类型？

> ID：13095790
> 
> 赞同：0
> 
> 时间：2012-10-26T23:42:15.897
> 
> 标签：flashdevelop

假设您在 com.something1.something2 包中创建了一个名为“Entity”的类。现在假设您在 com.something1.something3 包中输入以下代码：

```
var e:Entity = new Entity(); 
```

除了 FlashDevelop 进来并把它变成这样：

```
var e:Entity = new com.something1.something2.Entity(); 
```

你怎么能让它停止这样做？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:46:59.450

这种行为通常发生在 2 种情况下：

*   您导入 2 个具有相同名称但来自不同包的类（例如：com.foo.Entity、bar.baz.Entity），
*   您的代码包含隐藏类的根包的本地或实例声明（即 var com:SomeType 从 com.foo.Entity 隐藏“com”）。

# python - 为什么 numpy 矢量化函数显然被称为额外时间？

> ID：13095792
> 
> 赞同：7
> 
> 时间：2012-10-26T23:42:57.627
> 
> 标签：python, numpy, vectorization

我有一个 numpy 对象数组，其中包含几个索引号列表：

```
>>> idxLsts = np.array([[1], [0, 2]], dtype=object) 
```

我定义了一个向量化函数来为每个列表附加一个值：

```
>>> idx = 99  
>>> f = np.vectorize(lambda idxLst: idxLst.append(idx)) 
```

我调用该函数。我不关心返回值，只关心副作用。

```
>>> f(idxLsts)  
array([None, None], dtype=object) 
```

索引 99 被两次添加到第一个列表中。为什么？我难住了。

```
>>> idxLsts
array([[1, 99, 99], [0, 2, 99]], dtype=object) 
```

对于 idxLsts 的其他值，它不会发生：

```
>>> idxLsts = np.array([[1, 2], [0, 2, 4]], dtype=object)
>>> f(idxLsts)
array([None, None], dtype=object)
>>> idxLsts
array([[1, 2, 99], [0, 2, 4, 99]], dtype=object) 
```

我的怀疑是它与文档有关：“定义一个向量化函数，它将***嵌套***的对象序列或 numpy 数组作为输入并返回一个 numpy 数组作为输出。向量化函数在输入数组的连续元组上评估 pyfunc，例如python map 函数，除了它使用 numpy 的广播规则。"

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-27T01:05:57.777

从`vectorize`文档字符串：

> ```
> The data type of the output of `vectorized` is determined by calling
> the function with the first element of the input.  This can be avoided
> by specifying the `otypes` argument. 
> ```

从代码中：

```
 theout = self.thefunc(*newargs) 
```

这是对 的额外调用`thefunc`，用于确定输出类型。这就是为什么第一个元素要`99`附加两个 s 的原因。

这种行为也发生在您的第二种情况下：

```
import numpy as np
idxLsts = np.array([[1, 2], [0,2,4]], dtype = object)
idx = 99
f = np.vectorize(lambda x: x.append(idx))
f(idxLsts)
print(idxLsts) 
```

产量

```
[[1, 2, 99, 99] [0, 2, 4, 99]] 
```

* * *

您可以使用`np.frompyfunc`而不是`np.vectorize`：

```
import numpy as np
idxLsts = np.array([[1, 2], [0,2,4]], dtype = object)
idx = 99
f = np.frompyfunc(lambda x: x.append(idx), 1, 1)
f(idxLsts)
print(idxLsts) 
```

产量

```
[[1, 2, 99] [0, 2, 4, 99]] 
```

# java - 如何检索“标准”Android 联系人

> ID：13095793
> 
> 赞同：1
> 
> 时间：2012-10-26T23:43:03.517
> 
> 标签：java, android, android-contacts

当我以编程方式查询 ContactsContract.Contact 时，结果包含的联系人比标准 Google/Android 联系人应用程序（名为 People）中显示的要多。Google 应用程序中未显示的联系人通常没有姓名或电子邮件地址作为姓名。是否有标准查询可用于获取与 Google 应用相同的列表？

我目前的代码是：

```
 ContentResolver cr = getContentResolver();
    Cursor c = cr.query(ContactsContract.Contacts.CONTENT_URI, null, null, null, null);
    if(c.getCount() > 0) {
        while(c.moveToNext()) {
            name = c.getString(c.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
            names.add(name);
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T00:03:35.350

人脉应用程序可能会根据用户控制的设置过滤掉联系人。例如，您可以告诉“人脉”应用隐藏不在群组中的联系人。此外，人脉应用程序的设计者可能已经决定隐藏没有有用名称的联系人。

您准确地模仿 People 应用程序的用例是什么？

# objective-c - 目标 c 中的科学记数法（与 e 基计算混淆）

> ID：13095794
> 
> 赞同：0
> 
> 时间：2012-10-26T23:43:35.920
> 
> 标签：objective-c, ios, math

我已经有一段时间没有进行任何基本的 e 计算了。我似乎不记得如何做到这一点：-5e-6

在我的代码中，我有`double x = -5*M_E-6`，它等于`(-5*M_E) - 6`，大致等于 -19.6。但是，这不等于 -5e-6。

如何以编程方式表示 -5e-6？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T23:50:31.107

如果你愿意，你可以使用. 这与在计算中使用数学常数（2.71828-ish）不同，这与.`-5 x 10^(-6)``-5e-6``e``M_E`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T23:46:21.340

那不是基础数学，那是[科学记数法](http://en.wikipedia.org/wiki/Scientific_notation#E_notation)。键入它，如图所示。

> 请注意，在这种用法中，字符*e*与数学常数*e*或指数函数*e ^x* ...无关。

# c++ - 函子作为 C++ 中的基类

> ID：13095800
> 
> 赞同：1
> 
> 时间：2012-10-26T23:44:14.043
> 
> 标签：c++, functor

我有一个仿函数基类和一个仿函数派生类，如下所示：

```
class ReadSensor
{
public:
    ReadSensor();
    virtual ~ReadSensor(void){}
    virtual int operator()(void) = 0;
};

class ReadSensorDummy : public ReadSensor
{
public:
    ReadSensorDummy() : x(0) {}
    ReadSensorDummy(int x): x(x) {}
    ~ReadSensorDummy(void) {}
    int operator() (void) { return x;}
private:
    int x;
}; 
```

我正在创建它：

```
ReadSensor *rs =  new ReadSensorDummy(5); 
```

它编译，但我收到以下链接错误：

```
Error   2   error LNK2019: unresolved external symbol "public: __cdecl ReadSensor::ReadSensor(void)" (??0ReadSensor@@QEAA@XZ) referenced in function "public: __cdecl ReadSensorDummy::ReadSensorDummy(int)" (??0ReadSensorDummy@@QEAA@H@Z) W:\SafetySystemTest.obj 
```

怎么了？不需要 dynamic_cast，但我确实尝试过，但没有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T23:46:53.557

您已声明打算为 定义构造函数`ReadSensor`，但编译器未在您的任何源文件中找到定义的构造函数。您可以尝试定义一个空的，或删除声明。

# webserver - 在不重新启动 G-WAN 的情况下更改站点配置

> ID：13095801
> 
> 赞同：3
> 
> 时间：2012-10-26T23:44:19.193
> 
> 标签：webserver, g-wan

我正在考虑托管一些小型静态网站，并且一直在寻找一些替代方案，包括 G-WAN。目前，我只是想在选择一台服务器之前先了解一下每台服务器是否适合我的需求。

G-WAN 似乎完全符合我的要求，尽管我在服务器启动后更新配置（通过添加新文件夹）时遇到了问题。我在文档或网上找不到任何关于此的内容，所以我不知道我是否在做任何愚蠢的事情，运行不受支持的配置，或者它是否是 G-WAN 中不存在的功能。

**这是我的设置：**

Ubuntu 12.04.1 LTS 上的 G-WAN 3.3.28 64 位。

我有我认为所需的最小文件夹结构：

```
0.0.0.0_80
  #0.0.0.0
    www
  $site.com
    www
  $othersite.com
    www 
```

我通过以下方式启动 gwan（我还在搞砸，所以希望如此）：

```
sudo .\gwan -d 
```

一切都很出色。我添加了 $thirdsite.com/、$thirdsite.com/www/ 和 $thirdsite.com/www/index.html；然后，当我尝试访问thirdsite.com 时，它给了我根主机（即它似乎没有接收到更改）。

要重新加载修改后的配置，我必须这样做：

```
sudo .\gwan -k; sudo .\gwan -d 
```

或杀死非天使进程（kill -s 15）以重新启动子进程。

G-WAN 能否以另一种方式重新加载主机定义？如果是这样，它是开箱即用的东西，还是有一个命令可以循环服务器而不丢弃对其他主机的请求（/在非天使进程上杀死 -s 15 是否安全+如果是，是有可靠的方法来识别过程）？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T16:17:59.070

G-WAN 在启动时加载主机定义，并且不会随着时间的推移动态重新加载它们。

要强制重新加载，您必须停止子进程（在守护程序模式下）并且 v3.9+ 使旧子进程保持活动状态，以便在新子进程接受新连接时处理任何待处理的请求。

由于停止子进程也可以从`maintenance`脚本或从 a`handler`或从 a`servlet`完成，只需运行即可`exit(0)`，因此不需要专用命令。

请注意，当您使用时，`kill`您可以`pid`从`gwan`目录中选择文件：

*   该`parent`过程以大写字母开头：`G`wan_xxxx.pid
*   进程以`child`小写字母开头：`g`wan_xxxx.pid

这将使您的生活更轻松。

# jquery - 调用 fnSort 会破坏 jQuery UI 选项卡样式

> ID：13095804
> 
> 赞同：2
> 
> 时间：2012-10-26T23:44:49.017
> 
> 标签：jquery, jquery-ui, coffeescript, datatables, jquery-ui-tabs

我在一页上使用 jQuery UI 选项卡，在几页上使用 jQuery DataTables。创建选项卡的咖啡脚本如下所示：

```
$(document).ready ->
    $('#tabs').tabs() 
```

创建 DataTables 的咖啡脚本如下所示：

```
$(document).ready ->
    table = $('#table').dataTable()
    table.fnSort([[2,'desc']]) 
```

它们位于两个单独的文件中。由于我添加了对 fnSort 的调用，因此选项卡不再正确显示。如果 .tabs() 根本没有被调用，它看起来会这样。如果我删除 fnSort 行，一切正常。

知道会发生什么吗？我不是在寻求解决问题的方法；我已经找到了解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T21:58:17.777

是否与 CoffeeScript 无意中创建了一个 jQuery 响应的 return 语句有关？尝试在回调中添加明确的“return”语句。

# php - 重复出现 htaccess 命令

> ID：13095805
> 
> 赞同：0
> 
> 时间：2012-10-26T23:44:49.907
> 
> 标签：php, .htaccess, mod-rewrite

我需要无限长地继续这个，而不是每次都写出来。有没有办法做到这一点？

```
RewriteRule   ^(\w+)/?$   index.php?page=$1 [QSA]
RewriteRule   ^(\w+)/(\w+)/?$   index.php?page=$1&$1=$2 [QSA,L]
RewriteRule   ^(\w+)/(\w+)/(\w+)/?$   index.php?page=$1&$1=$2&$2=$3 [QSA,L] 
```

所以一直到 $1=$2 然后 $2=$3 所以 page=blog&blog=article&article=date&date=2012

然后我的 PHP 会对此进行分析。所以可能是 $1 -> $11 我知道的长 URL 意味着我仍然可以启用添加。

```
AAA.com/blog/article/date/2012/?colour=blue 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:52:31.590

不是这样的。要获得替换`$5`占位符，您确实需要一个匹配组。

当然可以按组对其进行选择：

```
RewriteRule  ^(\w+)(?:/(\w+))?(?:/(\w+))?(?:/(\w+))?(?:/(\w+))?(?:/(\w+))?(?:/(\w+))?/?$   index.php?page=$1&$1=$2&$2=$3&$3=$4&$4=$5&$5=$6  [QSA,L] 
```

但后来你有一些`&=&=&=`缺席条目的尾随。通常它应该导致一个空的`$_GET[""]`，但 PHP 甚至会忽略它。所以，可能是一个选择。我不觉得它是一个更具可读性或更简洁的 RewriteRule。

# google-maps - jQuery mobile .html() 函数——旧值的任何重用？

> ID：13095807
> 
> 赞同：0
> 
> 时间：2012-10-26T23:45:04.743
> 
> 标签：google-maps, jquery-mobile

我们正在使用谷歌地图，并希望将访问该站点的流量保持在最低限度。目前，我们有一个`<li>`包含`href`生成 maps.google.com URL 的元素。该链接可以根据设备的方向改变——相同的地图地址，但我们使用调整大小的地图来适当地适应屏幕。

我们正在存储纵向和横向谷歌地图的`<href>`值，以防止每次设备重新定向时重新生成它们。`<li>`然后，在每次方向更改时，我们使用 jQuery翻转html 属性，如下所示：

```
//on an orientation change...
if (window.orientation == "portrait") {
   $(#mapLi).html(portraitMapHref);
}
else {
   $(#mapLi).html(landscapeMapHref);
} 
```

google API 在页面加载时为我们生成`hrefs`和嵌入`<img>`标签，并且在第一次发生方向更改时。这当然会导致与 maps.google.com 的连接。

`.html`当我们使用带有缓存的函数来回交换时，`hrefs`似乎没有同时调用 maps.google.com，这就是我们所追求的，但我想知道这是由于浏览器缓存还是性质`.html`jqm中的功能？我认为交换该元素中的 html 值会触发对 maps.google.com 地址的调用。不应该，还是我们对浏览器缓存很幸运？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:22:50.703

目前尚不清楚您在 PortraitMapHref 和 LandscapeMapHref 中究竟存储了什么，但我猜您存储节点。

在这种情况下，当你使用 时`$.html()`，新的内容将替换当前的内容，但旧的内容（节点）不会被删除，它仍然是一个节点，不管它是否附加到 DOM 上。

当您重新使用被替换的节点时，没有什么可加载的。

# iphone - 背景图像未在 iPhone 上调整大小

> ID：13095808
> 
> 赞同：0
> 
> 时间：2012-10-26T23:45:07.567
> 
> 标签：iphone, ios, css

背景图像[在这里](http://fadedpaperfigures.com/matter)调整大小很好，但不是在 iPhone 上（尚未检查 iPad）。

图像为 1393 x 1098 像素。

这是我的CSS：

```
.slider-wrap-blue { 
background:transparent url(/images/fpfbg.jpg) no-repeat center center fixed; 
min-width: 980px;
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T03:03:02.563

不确定这是不是答案，但我注意到您的标记中没有“元视口”标签。没有它，缩放与桌面相同，可能会抛弃它。我没有 iPhone 可以看。Android中也存在这个问题吗？

编辑：我看到你在其中一条评论中提到了它。这是完整的元标记：
`<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">`

一些观察。您在文档类型之前有一个广告/评论。这会使 IE 进入怪癖模式。删除 doctype 之前的任何内容以消除该问题。

此外，您正在使用 XHTML1.1 文档类型。这仅适用于 XML 应用程序，并且您将页面作为 HTML 提供。使用 HTML 文档类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T00:33:18.790

我在旧设备上遇到了类似的问题。我将图像从 jpg 更改为 png 并修复了背景大小问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T23:51:36.770

我遇到了图像无法缩小到初始尺寸以下的问题。也许它正在缩小到 1393 x 1098，但不会变小。我为手机使用较小版本的图像，为平板电脑和台式设备使用较大版本的图像。我使用用户代理来确定网页正在运行的设备并显示正确的图像。

我会将其归类为评论而不是答案，但还没有发表评论的声誉:)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-27T01:31:13.837

或许可以试试[Backstretch 之](http://srobbin.com/jquery-plugins/backstretch/)类的 jQuery 插件。它应该是一个更好的跨平台答案。

# java - 如何将 Android 应用程序项目合并到 Java 项目中 - Eclipse

> ID：13095815
> 
> 赞同：0
> 
> 时间：2012-10-26T23:45:49.740
> 
> 标签：java, android, eclipse, selenium, robotium

我是 Java 和 Eclipse 的初学者。我正在尝试使用 Selenium（Web 应用程序）和 Robotium（Android 应用程序）创建一个自动化框架。我已经完成了两个项目，一个是使用JDK编译器运行Junit测试用例的Java项目（Selenium），另一个是使用Android编译器运行android测试用例的Android测试项目。

我的问题是：有没有办法将 Android 项目结合到 Java 项目中？

我尝试将 android 项目的基本文件/更改添加到 java 项目中，但是当我运行每个测试时，它会失败，因为它使用不同的编译器。

有没有解决的办法？我愿意接受任何建议。

提前谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T10:16:11.410

阅读您的评论后，我相信我可以说您应该将它们分开。如果您想在它们之间共享一些功能（我无法想象您可以在所有 3、android 和 selenium 之间共享所有功能，因为它们至少使用相同的语言），那么您可以创建另一个项目并将其用作两者之间共享源文件夹。您会发现将它们分开更有意义。最明显的例子是版本控制你的测试，你会发现当你发布实际应用程序时你会想要制作标签，对于一个项目，你将标记你的个人项目，以便在三个应用程序中的任何一个发布时进行。不反映实际发布状态。希望这是有道理的。我很累。

# ruby - 在 Mac OS X 10.6.8 上安装 Ruby 1.9.3

> ID：13095817
> 
> 赞同：1
> 
> 时间：2012-10-26T23:45:59.657
> 
> 标签：ruby, macos, installation, rvm

我在安装 Ruby 1.9.3（或 1.8.7 之后的任何版本）时遇到了一些问题。

请参阅下面的错误日志：

```
[2012-10-26 19:26:24] make
    CC = clang
    LD = ld
    LDSHARED = clang -dynamiclib
    CFLAGS = -O3 -ggdb -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wno-long-long -Wno-missing-field-initializers -Werror=pointer-arith -Werror=write-strings -Werror=declaration-after-statement -Werror=shorten-64-to-32 -Werror=implicit-function-declaration -I/Users/username/.rvm/usr/include -fno-common -pipe 
    XCFLAGS = -include ruby/config.h -include ruby/missing.h -fvisibility=hidden -DRUBY_EXPORT
    CPPFLAGS = -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -I. -I.ext/include/x86_64-darwin10.8.0 -I./include -I.
    DLDFLAGS = -Wl,-undefined,dynamic_lookup -Wl,-multiply_defined,suppress -Wl,-flat_namespace -install_name /Users/username/.rvm/rubies/ruby-1.9.3-p286/lib/libruby.1.9.1.dylib -current_version 1.9.1 -compatibility_version 1.9.1 -Wl,-unexported_symbol,_Init_* -Wl,-unexported_symbol,*_threadptr_*  -Wl,-u,_objc_msgSend   
    SOLIBS = 
compiling main.c
compiling dmydln.c
compiling dmyencoding.c
compiling version.c
compiling dmyversion.c
compiling miniprelude.c
compiling array.c
compiling bignum.c
compiling class.c
compiling compar.c
compiling complex.c
compiling dir.c
compiling dln_find.c
compiling enum.c
compiling enumerator.c
compiling error.c
compiling eval.c
compiling load.c
compiling proc.c
compiling file.c
compiling gc.c
compiling hash.c
compiling inits.c
compiling io.c
compiling marshal.c
compiling math.c
compiling node.c
compiling numeric.c
compiling object.c
compiling pack.c
compiling parse.c
compiling process.c
compiling random.c
compiling range.c
compiling rational.c
compiling re.c
compiling regcomp.c
compiling regenc.c
compiling regerror.c
compiling regexec.c
compiling regparse.c
compiling regsyntax.c
compiling ruby.c
compiling safe.c
compiling signal.c
compiling sprintf.c
compiling st.c
compiling strftime.c
compiling string.c
compiling struct.c
compiling time.c
compiling transcode.c
compiling util.c
compiling variable.c
compiling compile.c
compiling debug.c
compiling iseq.c
compiling vm.c
In file included from vm.c:25:
In file included from ./vm_exec.c:106:
insns.def:634:9: warning: explicitly assigning a variable of type 'VALUE' (aka 'unsigned long') to itself [-Wself-assign]
    val = val;
    ~~~ ^ ~~~
In file included from vm.c:27:
./vm_method.c:102:85: warning: unused variable 'prev_ume' [-Wunused-variable]
    struct unlinked_method_entry_list_entry *ume = vm->unlinked_method_entry_list, *prev_ume = 0, *curr_ume;
                                                                                    ^
./vm_method.c:102:100: warning: unused variable 'curr_ume' [-Wunused-variable]
    struct unlinked_method_entry_list_entry *ume = vm->unlinked_method_entry_list, *prev_ume = 0, *curr_ume;
                                                                                                   ^
3 warnings generated.
compiling vm_dump.c
compiling thread.c
compiling cont.c
compiling ./enc/ascii.c
compiling ./enc/us_ascii.c
compiling ./enc/unicode.c
compiling ./enc/utf_8.c
compiling newline.c
compiling ./missing/setproctitle.c
linking miniruby
rbconfig.rb updated
generating enc.mk
compiling dln.c
compiling encoding.c
generating prelude.c
compiling prelude.c
linking static-library libruby.1.9.1-static.a
linking shared-library libruby.1.9.1.dylib
generating encdb.h
encdb.h unchanged
making enc
compiling ./enc/encdb.c
linking encoding encdb.bundle
compiling ./enc/big5.c
linking encoding big5.bundle
compiling ./enc/cp949.c
linking encoding cp949.bundle
compiling ./enc/emacs_mule.c
linking encoding emacs_mule.bundle
compiling ./enc/euc_jp.c
linking encoding euc_jp.bundle
compiling ./enc/euc_kr.c
linking encoding euc_kr.bundle
compiling ./enc/euc_tw.c
linking encoding euc_tw.bundle
compiling ./enc/gb2312.c
linking encoding gb2312.bundle
compiling ./enc/gb18030.c
linking encoding gb18030.bundle
compiling ./enc/gbk.c
linking encoding gbk.bundle
compiling ./enc/iso_8859_1.c
linking encoding iso_8859_1.bundle
compiling ./enc/iso_8859_2.c
linking encoding iso_8859_2.bundle
compiling ./enc/iso_8859_3.c
linking encoding iso_8859_3.bundle
compiling ./enc/iso_8859_4.c
linking encoding iso_8859_4.bundle
compiling ./enc/iso_8859_5.c
linking encoding iso_8859_5.bundle
compiling ./enc/iso_8859_6.c
linking encoding iso_8859_6.bundle
compiling ./enc/iso_8859_7.c
linking encoding iso_8859_7.bundle
compiling ./enc/iso_8859_8.c
linking encoding iso_8859_8.bundle
compiling ./enc/iso_8859_9.c
linking encoding iso_8859_9.bundle
compiling ./enc/iso_8859_10.c
linking encoding iso_8859_10.bundle
compiling ./enc/iso_8859_11.c
linking encoding iso_8859_11.bundle
compiling ./enc/iso_8859_13.c
linking encoding iso_8859_13.bundle
compiling ./enc/iso_8859_14.c
linking encoding iso_8859_14.bundle
compiling ./enc/iso_8859_15.c
linking encoding iso_8859_15.bundle
compiling ./enc/iso_8859_16.c
linking encoding iso_8859_16.bundle
compiling ./enc/koi8_r.c
linking encoding koi8_r.bundle
compiling ./enc/koi8_u.c
linking encoding koi8_u.bundle
compiling ./enc/shift_jis.c
linking encoding shift_jis.bundle
compiling ./enc/utf_16be.c
linking encoding utf_16be.bundle
compiling ./enc/utf_16le.c
linking encoding utf_16le.bundle
compiling ./enc/utf_32be.c
linking encoding utf_32be.bundle
compiling ./enc/utf_32le.c
linking encoding utf_32le.bundle
compiling ./enc/windows_1251.c
linking encoding windows_1251.bundle
making srcs under enc
make[1]: Nothing to be done for `srcs'.
generating transdb.h
transdb.h unchanged
making trans
compiling ./enc/trans/transdb.c
linking transcoder transdb.bundle
compiling ./enc/trans/big5.c
linking transcoder big5.bundle
compiling ./enc/trans/chinese.c
linking transcoder chinese.bundle
compiling ./enc/trans/emoji.c
linking transcoder emoji.bundle
compiling ./enc/trans/emoji_iso2022_kddi.c
linking transcoder emoji_iso2022_kddi.bundle
compiling ./enc/trans/emoji_sjis_docomo.c
linking transcoder emoji_sjis_docomo.bundle
compiling ./enc/trans/emoji_sjis_kddi.c
linking transcoder emoji_sjis_kddi.bundle
compiling ./enc/trans/emoji_sjis_softbank.c
linking transcoder emoji_sjis_softbank.bundle
compiling ./enc/trans/escape.c
linking transcoder escape.bundle
compiling ./enc/trans/gb18030.c
linking transcoder gb18030.bundle
compiling ./enc/trans/gbk.c
linking transcoder gbk.bundle
compiling ./enc/trans/iso2022.c
linking transcoder iso2022.bundle
compiling ./enc/trans/japanese.c
linking transcoder japanese.bundle
compiling ./enc/trans/japanese_euc.c
linking transcoder japanese_euc.bundle
compiling ./enc/trans/japanese_sjis.c
linking transcoder japanese_sjis.bundle
compiling ./enc/trans/korean.c
linking transcoder korean.bundle
compiling ./enc/trans/single_byte.c
linking transcoder single_byte.bundle
compiling ./enc/trans/utf8_mac.c
linking transcoder utf8_mac.bundle
compiling ./enc/trans/utf_16_32.c
linking transcoder utf_16_32.bundle
making encs
configuring -test-/add_suffix
configuring -test-/array/resize
configuring -test-/bug-3571
configuring -test-/bug-3662
configuring -test-/funcall
configuring -test-/load/dot.dot
configuring -test-/old_thread_select
configuring -test-/st/numhash
configuring -test-/string
configuring -test-/wait_for_single_fd
configuring -test-/win32/dln
Failed to configure -test-/win32/dln. It will not be installed.
configuring -test-/win32/fd_setsize
Failed to configure -test-/win32/fd_setsize. It will not be installed.
configuring bigdecimal
configuring continuation
configuring coverage
configuring curses
configuring date
configuring dbm
configuring digest
configuring digest/bubblebabble
configuring digest/md5
configuring digest/rmd160
configuring digest/sha1
configuring digest/sha2
configuring dl
configuring dl/callback
configuring dl/win32
Failed to configure dl/win32\. It will not be installed.
configuring etc
configuring fcntl
configuring fiber
configuring fiddle
configuring gdbm
Failed to configure gdbm. It will not be installed.
configuring iconv
configuring io/console
configuring io/nonblock
configuring io/wait
configuring json
configuring json/generator
configuring json/parser
configuring mathn/complex
configuring mathn/rational
configuring nkf
configuring objspace
configuring openssl
configuring pathname
configuring psych
configuring pty
configuring racc/cparse
configuring readline
configuring ripper
configuring sdbm
configuring socket
configuring stringio
configuring strscan
configuring syck
configuring syslog
configuring tk
check functions.........
check struct members..
check libraries....
Use ActiveTcl libraries (if available).
Search tclConfig.sh and tkConfig.sh....................................
Valid [tclConfig.sh, tkConfig.sh] are found in [["/System/Library/Frameworks/Tcl.framework", "/System/Library/Frameworks/Tk.framework"], ["/usr/lib", "/usr/lib"], ["/System/Library/Frameworks/Tcl.framework/Versions/Current", "/System/Library/Frameworks/Tk.framework/Versions/Current"], ["/System/Library/Frameworks/Tcl.framework/Versions/8.5", "/System/Library/Frameworks/Tk.framework/Versions/8.5"], ["/System/Library/Frameworks/Tcl.framework/Versions/8.4", "/System/Library/Frameworks/Tk.framework/Versions/8.4"]]
Use [tclConfig.sh, tkConfig.sh] == ["/System/Library/Frameworks/Tcl.framework/tclConfig.sh", "/System/Library/Frameworks/Tk.framework/tkConfig.sh"]
Use MacOS X Frameworks.

Find Tcl/Tk libraries. Make tcltklib.so which is required by Ruby/Tk.
configuring tk/tkutil
configuring win32ole
Failed to configure win32ole. It will not be installed.
configuring zlib
Failed to configure zlib. It will not be installed.
linking shared-object -test-/add_suffix/bug.bundle
installing default bug libraries
compiling resize.c
linking shared-object -test-/array/resize.bundle
installing default resize libraries
compiling bug.c
linking shared-object -test-/bug-3571/bug.bundle
installing default bug libraries
compiling bug.c
linking shared-object -test-/bug-3662/bug.bundle
installing default bug libraries
compiling passing_block.c
linking shared-object -test-/funcall/funcall.bundle
installing default funcall libraries
compiling dot.dot.c
linking shared-object -test-/load/dot.dot/dot.dot.bundle
installing default dot.dot libraries
linking shared-object -test-/old_thread_select/old_thread_select.bundle
installing default old_thread_select libraries
compiling numhash.c
linking shared-object -test-/st/numhash.bundle
installing default numhash libraries
compiling cstr.c
compiling ellipsize.c
compiling enc_associate.c
compiling init.c
compiling modify.c
compiling set_len.c
linking shared-object -test-/string/string.bundle
installing default string libraries
linking shared-object -test-/wait_for_single_fd/wait_for_single_fd.bundle
installing default wait_for_single_fd libraries
make[2]: Nothing to be done for `all'.
make[2]: Nothing to be done for `all'.
linking shared-object bigdecimal.bundle
installing default bigdecimal libraries
compiling continuation.c
linking shared-object continuation.bundle
installing default continuation libraries
compiling coverage.c
linking shared-object coverage.bundle
installing default coverage libraries
compiling curses.c
linking shared-object curses.bundle
installing default curses libraries
linking shared-object date_core.bundle
installing default date_core libraries
compiling dbm.c
dbm.c:818:16: warning: comparison of integers of different signs: 'size_t' (aka 'unsigned long') and 'int' [-Wsign-compare]
        if (val.dsize == (int)RSTRING_LEN(valstr) &&
            ~~~~~~~~~ ^  ~~~~~~~~~~~~~~~~
1 warning generated.
linking shared-object dbm.bundle
installing default dbm libraries
compiling digest.c
linking shared-object digest.bundle
installing digest libraries
installing default digest libraries
compiling bubblebabble.c
linking shared-object digest/bubblebabble.bundle
installing default bubblebabble libraries
compiling md5init.c
linking shared-object digest/md5.bundle
ld: warning: ignoring file /usr/local/lib/libz.dylib, file was built for unsupported file format which is not the architecture being linked (x86_64)
ld: in /usr/local/lib/libz.1.dylib, file was built for unsupported file format which is not the architecture being linked (x86_64) for architecture 
x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[2]: *** [../../../.ext/x86_64-darwin10.8.0/digest/md5.bundle] Error 1
make[1]: *** [ext/digest/md5/all] Error 2
make: *** [build-ext] Error 2 
```

我正在尝试通过 RVM 安装，但仅从源代码安装 Ruby 并没有帮助。我似乎无法弄清楚发生了什么。我尝试附加`--with-gcc=clang`和`env ARCHFLAGS="-arch x86_64"`

非常感谢任何建议！谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:08:46.577

你有一个不兼容的`libz`安装版本`/usr/local/lib`，可能来自 Homebrew，可能只有 32 位版本，现在你需要 64 位或通用版本。您可以删除它，但可能会破坏您已安装的其他内容，或者您​​可以更新它。更安全的选择：在安装 ruby​​ 之前暂时将其 mv 到另一个位置，然后再将其 mv 回去。你不应该需要它，因为 OS X 提供了`libz`.

# azure - 如何使用 F# 将 Web 应用程序部署到 Azure 网站

> ID：13095818
> 
> 赞同：5
> 
> 时间：2012-10-26T23:46:01.810
> 
> 标签：azure, f#, asp.net-mvc-4

当我将 Web 应用程序部署到 Azure 网站时，我收到以下错误：

无法加载文件或程序集 'FSharp.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' 或其依赖项之一。该系统找不到指定的文件。

我过去在部署到 IIS 服务器时遇到过这个问题，并通过安装 F# 可再发行组件[http://www.microsoft.com/en-us/download/details.aspx?id=13450来修复它](http://www.microsoft.com/en-us/download/details.aspx?id=13450)

有谁知道我可以做些什么来让它在 Azure 网站（而不是 Azure Web 角色）上运行？

此外，我确实将引用它的 FSharp.Core 库的 Copy Local 设置为 true。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-27T03:53:56.107

[从评论转发：]

根据我的经验，为了在 Azure 中使用 C# 项目中的 F# 库，必须`FSharp.Core`直接从 C# 项目中引用才能上传正确的程序集。对于 C#-to-C# 项目引用，“复制本地”属性似乎可以正确传播，而对于 C#-to-F# 引用，则不能正确传播。

[`--standalone`我认为使用标志](http://msdn.microsoft.com/en-us/library/dd233171.aspx)编译可能也可以，但我没有亲自尝试过。

# java - 如何在没有数组的情况下在 java 中拆分字符串？

> ID：13095820
> 
> 赞同：0
> 
> 时间：2012-10-26T23:46:26.397
> 
> 标签：java, string, split, calculator

我有一个家庭作业，我需要创建一个计算器，以这种形式 [1+2/3*5-4] 接受用户输入。我不应该使用数组来存储字符串中的值。相反，我应该一次取 3 个数字和 2 个运算符。我的问题是如何存储数字和运算符，一旦我存储它们并计算值，就可以从原始字符串中获取 q 个新数字和一个新运算符。到目前为止，我不确定我是否朝着正确的方向前进。

```
public class ExpresionEvaluation {

    private static String expresion;
    static double o1;
    static double o2;
    private static double o3;
    private static char operator1;
    private static char operator2;

    public static double getO1(String s){
        s=s.trim();
        String r ="";
        while (s.length()>0 && s.charAt(0)>='0' && s.charAt(0)<='9'){

            r = r + s.charAt(0);
            s = s.substring(1);

        }
        o1 = Double.parseDouble(r);
        return(o1);
    }

    public static char getOperator1(String s){
        s=s.trim();
        char r;
        while (s.length()>0 && s.charAt(0)>='0' && s.charAt(0)<='9'){

            r = s.charAt(1);
            s = s.substring(2);

        }
        r = operator1;
        return(r);
    }

    public static double getO2(String s){

        s=s.trim();
        String r ="";
        while (s.length()>0 && s.charAt(0)>='0' && s.charAt(0)<='9'){

            r = r + s.charAt(2);
            s = s.substring(3);

        }
        o2 = Double.parseDouble(r);

        return(o2);
    }

    public static char getOperator2(String s){
        s=s.trim();
        char r;
        while (s.length()>0 && s.charAt(0)>='0' && s.charAt(0)<='9'){

            r = s.charAt(3);
            s = s.substring(4);

        }
        r = operator2;
        return(operator2);
    }

    public static double getO3(String s){

        s=s.trim();
        String r ="";
        while (s.length()>0 && s.charAt(0)>='0' && s.charAt(0)<='9'){

            r = r + s.charAt(4);
            s = s.substring(5);

        }
        o3 = Double.parseDouble(r);

        return(o3);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T19:01:12.953

从技术上讲，您可以通过使用集合类来规避它。在 java.util 包中，有许多类可以模拟数组的行为，但可以重新调整大小并提供更多功能。其中包括 java.util.ArrayList、java.util.LinkedList、java.util.Vector（不要使用那个）和 java.util.Stack。Java 集合框架非常广泛，我建议阅读以下文档

[http://docs.oracle.com/javase/tutorial/collections/implementations/index.html](http://docs.oracle.com/javase/tutorial/collections/implementations/index.html)

如果您也不允许使用集合，我唯一能想到的是使用一个大字符串并在单独的部分之间插入某种特殊字符或序列，然后使用 indexOf(char, fromIndex) 和子字符串遍历各个部分，如下所示：

```
 final int maxwords = 5;
   String strlist = "this@should@be@an@array@";
   int lastindex = 0, index = 0;
   for(int n= 0; n < maxwords; n ++){

             index = strlist.indexOf("@",lastindex);
             String substr = strlist.substring(lastindex,index);
             //process substring here
             System.out.println(substr);
             lastindex = index + 1;
      } 
```

这是一种非常丑陋的做事方式，但这是我唯一能想到的。希望这可以帮助。

# jquery - 使用jQuery扩展个人 位于页面右边缘的元素？

> ID：13095822
> 
> 赞同：4
> 
> 时间：2012-10-26T23:46:43.930
> 
> 标签：jquery, css

我在使用 jQuery 扩展一些列表元素时遇到了一些问题。这些列表是我想在鼠标悬停时展开的一系列社交媒体图标链接。问题是，当扩大li的宽度时，ul也扩大了，由于li中的图像是向左浮动的，它们看起来远离屏幕的右边缘。我设法让文本和图像很好地坐在一起的唯一方法是浮动图像。我的 a 元素的设置宽度为 30px，jQuery 将宽度扩展为 200px。

这张图片应该更好地解释它。

[![视觉解释](../Images/ad04f94cd3f1b41a58cb76aad16e3844.png)](https://i.stack.imgur.com/xTHMp.jpg)

有什么方法可以单独扩展列表元素并将图像保持在屏幕的右边缘？

这是我的代码：

HTML

```
 <ul id="social">
      <li> <a href="#"><img src="images/iconFacebook.jpg" />Like me on Facebook</a></li>
      <li><a href="#"><img src="images/iconTwitter.jpg" />Follow me on Twitter</a></li>
      <li><a href="#"><img src="images/iconGoogle.jpg" />Add me to Google+</a></li>
      <li><a href="#"><img src="images/iconBlog.jpg" />Check out my blog</a></li>
     </ul> 
```

CSS

```
 ul#social {
      display: block;
      list-style: none;
      position: absolute;
      right: 0px;
      top: 283px;
      z-index: 1600;
    }

    ul#social li {
      margin-top: 10px;
    }

    ul#social li img {
  float: left;
    }

    ul#social li a {
      display: block;
      height: 30px;
      width: 30px;
      line-height: 30px;
      vertical-align: middle;
      text-decoration: none;
      display: block;
      color: #FFFFFF;
      background: #f47920;
    } 
```

jQuery

```
 $(document).ready(function(){

    $('ul#social li a').mouseover(function() {
      $(this).stop().animate({
        width: '200px'
        }, 300);
    });

    $('ul#social li a').mouseout(function() {
      $(this).stop().animate({
        width: '30px'
        }, 300);
    });

    }); 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:55:32.620

这是为你做的

```
ul#social li {
    clear: both;
    float: right;
} 
```

关键是`clear: both`在浮动元素时，确保它们清除任何可能在其行上的东西。

见演示：http: [//jsfiddle.net/kcGZJ/17/](http://jsfiddle.net/kcGZJ/17/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T00:05:42.543

这是一个修复 - 它不是最漂亮的，但效果很好 - [jsFiddle](http://jsfiddle.net/kcGZJ/11/)

```
ul#social {   
      display: block;
      list-style: none;
    position: absolute;
      right: 0px;
      top: 283px;
      z-index: 1600;
    }

    ul#social li {
     position:relative;;
    right: 0px;

    }

    ul#social li img {
position: relative;
    right:0px;
    }

    ul#social li a {
      height: 30px;
      width: 30px;
      line-height: 30px;
      vertical-align: middle;
      text-decoration: none;
      display: block;
      color: #FFFFFF;
      background: #f47920;
    position: absolute;
    right: 0px;
    }​ 
```

使用绝对定位 - 必须在列表中放置换行符 - 有效

```
 <ul id="social">
  <li> <a href="#"><img src="images/iconFacebook.jpg" />Like me on Facebook</a></li><br /><br />
  <li><a href="#"><img src="images/iconTwitter.jpg" />Follow me on Twitter</a></li><br /><br />
  <li><a href="#"><img src="images/iconGoogle.jpg" />Add me to Google+</a></li><br /><br />
  <li><a href="#"><img src="images/iconBlog.jpg" />Check out my blog</a></li>
 </ul>​ 
```

# python - 尝试在 Python 2.7 中使用 SUDS

> ID：13095824
> 
> 赞同：1
> 
> 时间：2012-10-26T23:46:53.213
> 
> 标签：python, suds

我有一个 SUDS 程序，我在 2.5.4 下成功运行，但我确信我想要 2.7 的一些功能（如有序字典）。

以下示例在 2.5.4 下运行良好，但在 2.7 下失败：

```
#------------------------------------------------------------------------------
# Imports
#------------------------------------------------------------------------------

import sys
import os
# The Suds SOAP library.
from suds.plugin import MessagePlugin

print "This is a test" 
```

在 2.7 下，我收到错误消息：

```
Traceback (most recent call last):
File "test.py", line 8, in <module>
  from suds.plugin import MessagePlugin
ImportError: No module named plugin 
```

有人愿意推测为什么这会发生在我身上吗？

# python - python 2.7 中的 string_builder 装饰器 - 我应该怎么做？

> ID：13095826
> 
> 赞同：2
> 
> 时间：2012-10-26T23:47:13.467
> 
> 标签：python, python-2.7, decorator, stringbuilder

因此，Python 没有提供显式的 C# 或 Java 风格的 StringBuilder 类。请注意，我对 Python 有点陌生，所以我不确定我的想法是否好。

假设我想要一个装饰器（如果可能的话）将可迭代对象连接在一起。这个特定的例子可以用不同的方式实现，但我可以想到其他用例。所以 ...

```
@string_builder
def build_insert_statement(table_name, col_names, values, where_clause):
    yield 'insert into '
    yield table_name
    yield ' ( '
    yield ', '.join(col_names)
    yield ' ) values ( '
    yield ', '.join(values)
    yield ' ) where '
    yield where_clause
    yield ';' 
```

同样，我知道有其他方法可以做到这一点。然而，这能做到吗？装饰器可以始终尊重原始函数的签名，还是有时或根本不尊重？如果这是可能的，那么它是异端吗？为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:50:12.980

以下定义`string_builder`应该有效：

```
from functools import wraps

def string_builder(func):
    @wraps(func)
    def wrapped(*args, **kwargs):
        return ''.join(func(*args, **kwargs))
    return wrapped 
```

将问题中定义的函数`string_builder`用作装饰器：

```
>>> build_insert_statement('foo', ['bar'], ['1'], 'baz')
'insert into foo ( bar ) values ( 1 ) where baz;' 
```

请注意，使用 [ `functools.wraps`][1] 不是必需的，但这是一种很好的做法，因为没有它，`build_insert_statement.__name__`修饰后的函数 ( ) 的名称将被“包装”而不是“build_insert_statement”。

**所以有可能，这是个好主意吗？**

不是为了你的例子，但你说你还有其他用例。像这样的装饰器不是异端，但你不应该过度使用装饰器，因为它会掩盖实现。

如果您只是担心行长，请考虑以下替代方案之一：

*   `''.join()`在列表中使用：

    ```
    def build_insert_statement(table_name, col_names, values, where_clause):
        return ''.join(['insert into ',
                        table_name,
                        ' ( ',
                        ', '.join(col_names),
                        ' ) values ( ',
                        ', '.join(values),
                        ' ) where ',
                        where_clause,
                        ';']) 
    ```

*   将字符串与`+`：

    ```
    def build_insert_statement(table_name, col_names, values, where_clause):
        return ('insert into ' +
                table_name +
                ' ( ' +
                ', '.join(col_names) +
                ' ) values ( ' +
                ', '.join(values) +
                ' ) where ' +
                where_clause +
                ';') 
    ```

# mysql - 如何捕获并重新抛出 MySQL 中的所有错误

> ID：13095832
> 
> 赞同：26
> 
> 时间：2012-10-26T23:48:15.753
> 
> 标签：mysql, stored-procedures, handler

我似乎无法在任何地方找到如何捕获和重新抛出过程中可能发生的任何错误或警告。

我想要的是执行以下操作的语法：

```
create procedure myProcedure()
  begin

      declare exit handler for ANYTHING_WRONG_THAT_CAN_BE_CAUGHT_WARNINGS_INCLUDED
      begin
          rollback;
          RE_THROW THE_THING_THAT_WAS_CAUGHT;
      end;

      start transaction;
         -- do some stuff
      commit;
  end; // 
```

原因是我想强制回滚错误或警告，但让客户端决定如何处理特定错误。

全大写区域是我不知道该放什么的部分。

谢谢你的帮助！

编辑 - - - -

从那以后，我了解到不可能按照我的要求做:'(。

相反，我对任何出错的地方都有一个错误，并使用了以下代码：

```
declare exit handler for sqlwarning, sqlexception begin
    rollback;
    call error();
end; 
```

（错误（）不存在）

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-09-18T06:37:38.677

要捕获所有 SQL 异常，请使用：

```
DECLARE EXIT HANDLER FOR SQLEXCEPTION 
```

`SQLWARNINGS`也可以用来捕捉警告。

在异常处理程序中，要引发刚刚捕获的错误或警告，请使用：

```
RESIGNAL 
```

请参阅 RESIGNAL 语句的文档：

[http://dev.mysql.com/doc/refman/5.5/en/resignal.html](http://dev.mysql.com/doc/refman/5.5/en/resignal.html)

这从 MySQL 5.5 开始可用

# c++ - 使用 QTcpSocket 和 QTcpServer 进行控制台聊天

> ID：13095834
> 
> 赞同：0
> 
> 时间：2012-10-26T23:48:29.330
> 
> 标签：c++, qt, qtcpsocket, qtnetwork, qtcpserver

我想在qt框架中编写一个控制台聊天程序。发送消息有问题。

客户端向服务器发送消息，但服务器在客户端程序关闭之前不会接收消息。当客户端关闭时，服务器会显示所有消息。我不希望这样。我希望服务器在我发送给它时获取我的消息。

我在下面编写了代码。如果您查看客户端的主要功能，您将看到我想要做什么。

```
 /*

    Created BY : 
    Creation DATE : 26/10/2012

    Client interface

    */

    #ifndef CLIENT_H
    #define CLIENT_H

    #include <QtNetwork>
    #include <QObject>
    #include <QtNetwork/QTcpSocket>

    namespace NetworkArdic
    {

    class Client : public QObject
    {
        Q_OBJECT
        public:

            Client(QObject * obj = 0,QString add="localhost", quint16 port = 4000);

            void SendData(QString data);

            virtual ~Client();

        private slots:

            void ReadData();

            void connected();

        private:

            QTcpSocket *socket;
    };

    }

    #endif

 /*

    Created BY : 
    Creation DATE : 26/10/2012

    Client source file

    */

    #include "Client.h"
    #include <QHostAddress>
    #include <iostream>
    using namespace std;

    namespace NetworkArdic{

    Client::Client(QObject * obj, QString add, quint16 port) : QObject(obj)
    {

        socket = new QTcpSocket(this);

        connect(socket, SIGNAL(readyRead()), this, SLOT(ReadData()));
        connect(socket, SIGNAL(connected()), this, SLOT(connected()));

        socket->connectToHost(QHostAddress(add), port);
    }

    Client::~Client(){
        socket->close();
        delete socket;
    }

    void Client::SendData(QString data)
    {
        if(!data.isEmpty())
        {
            socket->write(QString(data + "\n").toUtf8());
        }
    }

    void Client::ReadData()
    {
        while(socket->canReadLine())
        {

            QString line = QString::fromUtf8(socket->readLine()).trimmed();
            qDebug() << line;
        }
    }

    void Client::connected()
    {
        socket->write(QString("Client : Server connection has been made (: \n").toUtf8());
    }

    }

    int main(int argc, char *argv[])
    {
        QCoreApplication a(argc, argv);

        Client cli(0,"127.0.0.1",4000);

        string line;
        while(line!="exit"){
            cout << "Message : ";
            cin >> line;
            cli.SendData(QString(line.c_str()));
        }

        return a.exec();
    }

     /*

    Created BY : 
    Creation DATE : 26/10/2012

    Server interface

    */

    #ifndef SERVER_H
    #define SERVER_H

    #include <QtNetwork>
    #include <QObject>
    #include <QtNetwork/QTcpServer>
    #include <QtNetwork/QTcpSocket>

    namespace NetworkArdic
    {

        class Server: public QTcpServer
        {

            Q_OBJECT
            public:

              Server(QObject * parent = 0 , quint16 port = 4000);
              virtual  ~Server();

            private slots:

              void acceptConnection();
              void startRead();
              void disconnected();

            private:

              QTcpSocket * client;

        };

    }

    #endif // SERVER_H

   /*

    Created BY : 
    Creation DATE : 26/10/2012

    Server source file

    */

    #include "Server.h"
    #include <iostream>
    using namespace std;

    namespace NetworkArdic{

    Server::Server(QObject* parent , quint16 port): QTcpServer(parent)
    {
      connect(this, SIGNAL(newConnection()),this, SLOT(acceptConnection()));

      listen(QHostAddress::Any, port );
    }

    Server::~Server()
    {
      delete client;
      close();
    }

    void Server::acceptConnection()
    {
      client = nextPendingConnection();

      connect(client, SIGNAL(readyRead()), this, SLOT(startRead()));
      connect(client, SIGNAL(disconnected()), this, SLOT(disconnected()));

      qDebug() << "New client from:" << client->peerAddress().toString();
    }

    void Server::startRead()
    { 
        while(client->canReadLine())
        {
            QString line = QString::fromUtf8(client->readLine()).trimmed();
            qDebug() << "Client :" << line;

            client->write(QString("Server : I've taken your message (:\n").toUtf8());
        }

    }

    void Server::disconnected()
    {

        qDebug() << "Client disconnected:" << client->peerAddress().toString();

        client->write(QString("Server : I wish you didn't leave ):\n").toUtf8());

    }

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T23:53:51.280

写入数据后尝试使用 socket->flush() 。

[http://doc.qt.digia.com/qt/qabstractsocket.html#flush](http://doc.qt.digia.com/qt/qabstractsocket.html#flush)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-04T17:58:04.930

您使用下面的代码来读取套接字数据。

```
void Server::startRead()
{ 
    while(client->canReadLine())
    {
        QString line = QString::fromUtf8(client->readLine()).trimmed();
        qDebug() << "Client :" << line;

        client->write(QString("Server : I've taken your message (:\n").toUtf8());
    }

} 
```

我建议采用以下我测试过的代码

```
 while (tcp_server->hasPendingConnections()) {
        client = tcp_server->nextPendingConnection();
        client->waitForReadyRead(100);

        QByteArray  byteArray = client->readAll();
        QString s_data = byteArray.data();

        // Process s_data

        client->close();
        client->abort();
    } 
```

# java - 在集合中查找编辑

> ID：13095837
> 
> 赞同：0
> 
> 时间：2012-10-26T23:49:07.547
> 
> 标签：java, collections, arraylist

我对这个问题感到非常厌倦，我不知道该怎么办。

```
import ... 
class ...

private ArrayList <Operation> operationList = new ArrayList<Operation>();

@Override
public Collection<String> lineList() {
    Set <String> groupOperation = new HashSet<String>();
    Operace newOperation= null;

    LogFileReader reader = new LogFileReader(nameFile);
    LogEntry line = reader.nextLine();

    while(reader.existsLine()) {
        for(Operation whatever2: operationList) {
            if(line.getOperation().equals(whatever2.getName())) {
                whatever2.setAmmount(whatever2.getAmmount()+1);
                line = reader.nextLine();
            }
        }
        newOperation = new Operation(line.getOperation());
        newOperation.setAmmount(1);
        groupOperation .add(newOperation);
        line = reader.nextLine();
    }
    ....
    return groupOperation;
} 
```

*   问题出在**WITH FOR(xy: z) IF ()**时，其他事情都有效。
*   （如果我要删除整个 FOR，它似乎可以工作，但我需要数数。）

*   在类操作中只有“name”和“ammount”的 GETTER 和 SETTER。

    1.  解释
    2.  我读了一个文件。
    3.  我只从文件中读取主题。
    4.  我像操作一样加载它（名称=标题，数量=文件中有多少次相同）
    5.  我把它给 ArrayList = 它工作得很好！
    6.  从ArrayList到Set，就是接口。
    7.  与 GUI 的接口。

*EDIT1：“线程中的异常“AWT-EventQueue-0”java.lang.NullPointerException”*

希望大家明白，

感谢大家，

嗯...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:38:43.117

在你的`for`循环中，你有这一行：

```
 line = reader.nextLine(); 
```

正如您在 while 条件 -> 中所做的那样，这没有任何在线存在检查`reader.existsLine()`。这使它可以读取行`while`，如果没有更多行要读取，可能会在此处或中的最后一条语句失败。

我不确定，您是否真的想阅读`for`循环中的行。如果是，则将 if 条件包装为：

```
 if(reader.existsLine()){
          line = reader.nextLine();
       } 
```

# c - 将 4 个字节数复制到字符数组

> ID：13095839
> 
> 赞同：0
> 
> 时间：2012-10-26T23:49:31.700
> 
> 标签：c

我想将一个 4 字节的数字存储到一个字符数组中。

```
uint32 u32_gen;

u32_gen = func(X,Y,Z);

u32_gen is 4 bytes. For example it's value is 65DA929D. I want to store this as:

char buf[100] = {'\0'};
buffer[7]=65;
buffer[8]=DA;
buffer[9]=92;
buffer[10]9D; 
```

我在做什么并卡住了：

```
int num = 0;

num = ((u32_gen & 0xFF000000) >> 24) ;  num value is 101
num = ((u32_gen & 0x00FF0000) >> 16) ;  num value is 218
num = ((u32_gen & 0x0000FF00) >> 8) ;   num value is 146
num = (u32_gen & 0x000000FF) ;          num value is 157 
```

我需要在每次计算之间将这个十进制值复制到 buffer[7]..buffer[10] 中。我已经阅读了 Stackoverflow 和其他书籍中的几篇相关文章。我是否必须编写一个程序来将此数字从十进制转换为十六进制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T00:01:45.600

你有没有尝试过：

```
buffer[7] = (char)num;
... 
```

另一种选择是像这样声明一个联合：

```
union data
{
    char s[4];
    uint32 u32_gen;
} myData; 
```

然后做类似的事情：

```
myData.u32_gen = func(X,Y,Z);
buffer[7] = myData.s[0];
buffer[8] = myData.s[1];
buffer[9] = myData.s[2];
buffer[10] = myData.s[3]; 
```

# java - Java中泛型的未知编译错误

> ID：13095840
> 
> 赞同：3
> 
> 时间：2012-10-26T23:49:37.723
> 
> 标签：java, eclipse, compiler-errors, eclipse-indigo

以下编译错误对我来说毫无意义，我希望有人能够阐明：

```
static public void main(String args[]) throws ZipException, IOException
{
    File file = new File("C:\\temp");
    ZipFile zip_file = new ZipFile(file);
    Enumeration<ZipEntry> entries = zip_file.entries();
} 
```

我收到以下错误：`Type mismatch: cannot convert from Enumeration<capture#1-of ? extends ZipEntry> to Enumeration<ZipEntry>`

为了编译上面的代码，我不得不替换`entries`声明以使用泛型`<? extends ZipEntry>`。为什么我必须这样做？ZipEntry 不扩展 ZipEntry 吗？（这不是空洞的吗？）为什么编译器会抱怨呢？

如果有帮助，我将使用 Java 7.03 和 Eclipse Indigo 64 位。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T23:51:28.353

`ZipFile.entries()`返回扩展`ZipEntry`类型的枚举，但不限于`ZipEntry`自身，因此您需要使用：

```
Enumeration<? extends ZipEntry> entries = zip_file.entries(); 
```

这允许在枚举中使用其他类型，例如`JarEntry`对象。`ZipEntry`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-27T00:10:51.123

**如果你仔细看（源代码）**，它只返回`Enumeration<ZipEntry>`如下：

```
 return new Enumeration<ZipEntry>() {
            private int i = 0;
            public boolean hasMoreElements() {
            .....
            ..... 
```

但是声明返回类型是`public Enumeration<? extends ZipEntry> entries() {`为了**放宽**对返回类型的限制。如果您希望`entries()`通过自定义子类覆盖方法`Zipfile`，您可能希望使用相同方法的作为返回类型**的子类之一，即`ZipEntry`**`ZipEntry`

如果你不想使用泛型，你可能想写成：

```
 @SuppressWarnings("rawtypes")
  Enumeration entries = zip_file.entries(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-27T00:03:43.383

```
Make sure that the file exists and is accessible, you can also try this 

Enumeration<ZipEntry> entries = (Enumeration<ZipEntry>) zip_file.entries(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-27T00:04:21.853

使用`<Z extends ZipEntry>`并替换`?`方法中的所有实例（如果有），使用`Z`. 你不限于`Z`，你可以使用任何你喜欢的字母。

# loops - 如何使 for 循环彩票语句起作用？

> ID：13095842
> 
> 赞同：1
> 
> 时间：2012-10-26T23:50:10.853
> 
> 标签：loops

> **可能重复：**
> [JavaScript 中的 For 循环 - 彩票网站](https://stackoverflow.com/questions/13093050/for-loop-in-javascript-lottery-website)
> [代码 javascript 快速解答](https://stackoverflow.com/questions/13093832/code-javascript-quick-answer)

```
var firstInput = document.luckForm.numberBox.value;
var secondInput = document.luckForm.numberBox2.value;
var thirdInput = document.luckForm.numberBox3.value;

for (firstInput = 0; firstInput <= 10; firstInput++) 
{
    if (firstInput = luckyNumber) 
    {
        if (secondInput = luckyNumber2) 
        {
            if (thirdInput = luckyNumber3) 
            {
                alert('Congratulations! You got all 3 numbers correct. You\'ve won £1000!');
            }
        }
    }
} 
```

我试图将此代码（见下文）更改为 for 循环代码（见上文），非常简单，没有数组。我不确定我该怎么做。它应该是彩票，你可以输入三个数字，如果它们是正确的，你会得到你中了 1000 英镑的信息。我用谷歌搜索了很多，但我无法理解 for 循环语句:(

```
if (firstInput == luckyNumber && secondInput == luckyNumber2 && thirdInput == luckyNumber3 || firstInput == luckyNumber && secondInput == luckyNumber3 && thirdInput == luckyNumber2 || firstInput == luckyNumber2 && secondInput == luckyNumber3 && thirdInput == luckyNumber || firstInput == luckyNumber2 && secondInput == luckyNumber && thirdInput == luckyNumber3 || firstInput == luckyNumber3 && secondInput == luckyNumber && thirdInput == luckyNumber2 || firstInput == luckyNumber3 && secondInput == luckyNumber2 && thirdInput == luckyNumber)
{
    alert('Congratulations! You got all 3 numbers correct. You\'ve won £1000!');
} 
```

# php - 读取特定的行或列 - phpExcel

> ID：13095844
> 
> 赞同：4
> 
> 时间：2012-10-26T23:50:13.230
> 
> 标签：php, excel, codeigniter

使用 phpExcel，我设法阅读了整个工作表。有没有办法我只能从单元格 C15:C18 中读取某些值，然后将它们插入数据库？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-27T00:07:25.807

方法很多：

```
$cellValue = $objPHPExcel->getActiveSheet()->getCell('C15')->getValue(); 
```

将特定单元格（在本例中为 C15）的值读入变量 $cellValue

或者

```
$cellValues = $objPHPExcel->getActiveSheet()->rangeToArray('C15:C18'); 
```

将一系列值读取到数组中。

一旦您将单元格的内容检索到一个普通的 PHP 变量，就很容易将它们插入到数据库中，就像您将任何数据值插入到数据库中一样。

# hibernate - 带有关联表的 JPA 注释

> ID：13095850
> 
> 赞同：3
> 
> 时间：2012-10-26T23:51:15.297
> 
> 标签：hibernate, jpa, annotations, many-to-many, associations

我在 Hibernate 中使用 JPA 注释，但我真的不知道如何管理*关联表*。

## 实体关系

这是我的数据库模式作为实体关系（ER）图：

```
 COUNTRY          COUNTRY_MOVIE        
|---------|*    *|---------------|      | MOVIE   |
| COU_ID  |<---->| COUNTRY_ID    |*    *|---------|
| LABEL   |      | MOVIE_ID      |<---->| MO_ID   |
|---------|      |---------------|      | LABEL   |
                                        |---------| 
```

该表`COUNTRY_MOVIE`是多对多关联之间和具有多对多关联的*关联表*（由上面的箭头线表示，其中多对多由 表示）。`COUNTRY``MOVIE``* *`

## 使用 JPA 在代码中建模的实体

在我的 JPA 对象中，我没有创建一个`CountryMovie.java`类。

### 国家

但我`@JoinTable`在`Country.java`下面的代码中使用：

```
//Package, Import...

@Entity
@Table(name="COUNTRY")
public class Country implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    @Column(name="COU_ID")
    private Integer couID;

    @Column(name="LABEL")
    private String label;

    //bi-directional many-to-many association to TFilmFil
    @ManyToMany
    @JoinTable(
        name="COUNTRY_MOVIE"
        , joinColumns={
            @JoinColumn(name="COU_ID")
            }
        , inverseJoinColumns={
            @JoinColumn(name="MO_ID")
            }
        )
    private List<Movie> movies;

    public Country() {
        super();
    }

    // Other constructor, Getter & Setter, and "toString" method...
} 
```

### 电影

在`Movie.java`我只使用一个`@ManyToMany`注释：

```
//Package, Import...

@Entity
@Table(name="MOVIE")
public class Movie implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    @Column(name="MO_ID")
    private Integer moId;

    @Column(name="LABEL")
    private String label;

    //bi-directional many-to-many association to TrPaysPay
    @ManyToMany(mappedBy="movies")
    private List<Country> countries;

    public Film() {
        super();
    }

    // Other constructor, Getter & Setter, and "toString" method...
} 
```

* * *

### 问题一：`LazyInitializationException`

我不知道这是否是管理这种*关联表*的最佳方式，即使它看起来不错。

但是当我尝试获取一部电影的所有国家/地区时，我`LazyInitializationException`从 Hibernate 获得了一个。

### 问题2：我试过之后`FetchType.EAGER`

所以我尝试为每个多对多注释添加一个 fetch EAGER：

在`Country`：

```
@ManyToMany(fetch=FetchType.EAGER)
@JoinTable( 
```

在`Movie`：

```
@ManyToMany(mappedBy="movies",fetch=FetchType.EAGER) 
```

然后我得到这个：

> org.springframework.beans.factory.support.DefaultSingletonBeanRegistry destroySingletons

## 问题

1.  我是否必须创建另一个 java 类来映射`COUNTRY_MOVIE`？
2.  或者有没有办法通过使用与现在相同的java类来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T05:36:26.753

您的映射没问题（您不需要第三类）。你也不需要让它急切地获取。问题在于查询代码。您应该确保在访问集合时会话仍处于打开状态。

用您的查询代码更新问题，我可以告诉您如何解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-14T12:36:29.613

首先在 joinTable 中，连接列必须是国家/地区的外键和电影的外键反转：

```
 @ManyToMany()
    @JoinTable(
        name="COUNTRY_MOVIE"
        , joinColumns={
                @JoinColumn(name="COUNTRY_ID")
            }
        , inverseJoinColumns={
            @JoinColumn(name="MOVIE_ID")
            }
        )

    private List<Movie> movies; 
```

您可以为这样的电影获得所有国家/地区：

```
public List<Country> getAllCountriesOfMovie(Integer id){
        Query query=null;
        query = session.createQuery("from Country as c  left join"
                + "  fetch c.movies as movie where movie.moId=:movieId");
        query.setInteger("movieId", id);
      return query.list();
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-27T09:11:43.843

这是我`MyDao.java`获取所有国家和相关电影的查询。

```
@Transactional
public class myDao implements IMyDao, Serializable {

  private static final long serialVersionUID = 1L;
  @PersistenceContext
  private EntityManager em;

    public List<Country> getAllCountries() {
        try {
            return em.createQuery("select cou from Country cou").getResultList();
        } catch (Throwable th) {
            // Throw Exception
        }
    }
} 
```

我假设我需要使用连接显式检索电影列表。

# google-app-engine - 在几分钟内使用 pending_ms 处理 AppEngine 中断

> ID：13095858
> 
> 赞同：2
> 
> 时间：2012-10-26T23:52:25.780
> 
> 标签：google-app-engine

今天AppEngine宕机了一段时间： [http ://code.google.com/status/appengine/detail/serving/2012/10/26#ae-trust-detail-helloworld-get-latency](http://code.google.com/status/appengine/detail/serving/2012/10/26#ae-trust-detail-helloworld-get-latency)

结果是所有请求都保持为待处理状态，有些请求长达 24*分钟*。这是我的服务器日志的摘录。这些请求通常在 200 毫秒内得到处理。

[https://www.evernote.com/shard/s8/sh/ad3b58bf-9338-4cf7-aa35-a255d96aebbc/4b90815ba1c8cd2080b157a54d714ae0](https://www.evernote.com/shard/s8/sh/ad3b58bf-9338-4cf7-aa35-a255d96aebbc/4b90815ba1c8cd2080b157a54d714ae0)

我的配额（每天 8 美元）在几分钟内就爆炸了，而之前的配额是每天 2 美元左右。

即使我的实际请求仍然响应非常快，如何防止pending_ms 吃掉我的所有配额？我有从 300 毫秒到自动的未决延迟。将最大值限制为 10 秒是否可以防止这种类型的爆发？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T15:07:48.553

二十一点75，

*   没错，将待定延迟提高到 10 秒左右将有助于减少启动的实例数量。

看起来长时间运行的请求会占用您的实例。发生这种情况时，应用引擎会启动新实例来处理新请求，当然实例会花钱。

*   [将您的最小和最大空闲实例降低](https://developers.google.com/appengine/docs/adminconsole/performancesettings)到较小的数字也应该有所帮助。

在您的仪表板上，您可以查看您的实例图，以了解在请求加载完成后实例爆发空闲多长时间。您可以查看您的典型用法以帮助估计安全最大值。当合法流量需要启动新实例时，降低它们可能会导致速度变慢，尤其是在突发流量的情况下，因此您需要调整它以匹配您的预算。作为比较，在将最小值和最大值设置为 1 的非生产应用程序点上可以正常工作。

除此之外，减少应用引擎资源使用的[一般技术也会有所帮助。](https://developers.google.com/appengine/articles/managing-resources)听起来您已经经历了这些，因为您的典型请求时间很短。如果您的代码将正确处理线程（无全局变量等）并且您的实例有足够的可用内存来处理多个请求，则启用并发请求可能会有所帮助。

# c# - 自定义类框架/结构

> ID：13095863
> 
> 赞同：1
> 
> 时间：2012-10-26T23:53:14.843
> 
> 标签：c#, class, structure

我正在尝试获得以下结构：

```
Game.Player.Position.setPos(X,Y,Z) 
```

这是我到目前为止的框架：

```
public partial class Game
{
    public class Player
    {
        private class Position
        {
            public float setPos(float X, float Y, float Z)
            {
                //this code not included
            }
        }
    }
} 
```

这并不能完全满足我的需求。我想要得到的是以下内容：

```
Player player1 = new Player();
player1.Position.setPos(player1_X, player1_Y, player1_Z); 
```

但是，每当我声明 player1- 时，我得到的唯一选项是本地选项（player1.Equals、player1.GetHashCode、player1.ToString 等）；不是 player1.Position.setPos() 之类的。

我不知道这叫什么 - 所以如果有人知道我可以在哪里获得更多关于这方面的信息，这也会有所帮助。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T23:58:54.460

你已经宣布你的`Position`班级没问题，这就是描述职位的内容。你缺少的是你`Player`班级的一个属性 - 即说 a`Player`可以有一个职位：

```
public partial class Game
{
    public class Player
    {
        public class PositionClass
        {
            public float setPos(float X, float Y, float Z)
            {
                //this code not included
            }
        }

        public PositionClass Position {get; set;}

        public Player() {
            Position = new PositionClass();
        }
    }
} 
```

另一件事是您需要将`Position`类设置为`Public`，因为您的属性将在类范围之外公开它`Player`。

最后，您需要`Position`在构造函数中实例化您的属性，以便您可以`setPos`在声明 new 后直接调用，`Player`正如您所说的那样。

注意：为简洁起见，我假设了一个 VS2010 属性声明。另外，我将您的`Position`课程更改为被称为`PositionClass`，只是为了让您可以看到示例中的内容-您通常不会这样做，尽管您想查看您的命名，以免它们太混乱。

# nosql - 弹性搜索 - 标记强度（嵌套/子文档提升）

> ID：13095866
> 
> 赞同：3
> 
> 时间：2012-10-26T23:54:13.773
> 
> 标签：nosql, elasticsearch

给定具有标签集合的帖子的流行示例，假设我们希望每个标签不仅仅是一个字符串，而是一个字符串的元组和一个表示所述标签强度的双精度数。

一个查询帖子如何根据标签强度的总和对其进行评分（假设我们正在搜索标签名称中的确切术语）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-27T01:17:00.947

可以通过将标签作为[嵌套文档](http://www.elasticsearch.org/guide/reference/mapping/nested-type.html)进行索引，然后将[嵌套](http://www.elasticsearch.org/guide/reference/query-dsl/nested-query.html)查询与[自定义分数](http://www.elasticsearch.org/guide/reference/query-dsl/custom-score-query.html)查询结合使用来完成。在下面的示例中，terms 查询找到匹配的标签，自定义分数查询使用“tags”文档的“wight”字段的值作为分数，嵌套查询使用这些分数的总和作为顶级文档的最终分数.

```
curl -XDELETE 'http://localhost:9200/test-idx'
echo
curl -XPUT 'http://localhost:9200/test-idx' -d '{
    "mappings": {
        "doc": {
            "properties": {
                "title": { "type": "string" },
                "tags": {
                    "type": "nested",
                    "properties": {
                        "tag": { "type": "string", "index": "not_analyzed" },
                        "weight": { "type": "float" }
                    }
                }
            }
        }
    }
}'
echo
curl -XPUT 'http://localhost:9200/test-idx/doc/1' -d '{
    "title": "1",
    "tags": [{
        "tag": "A",
        "weight": 1
    }, {
        "tag": "B",
        "weight": 2
    }, {
        "tag": "C",
        "weight": 4
    }]
}
'
echo
curl -XPUT 'http://localhost:9200/test-idx/doc/2' -d '{
    "title": "2",
    "tags": [{
        "tag": "B",
        "weight": 2
    }, {
        "tag": "C",
        "weight": 3
    }]
}
'
echo
curl -XPUT 'http://localhost:9200/test-idx/doc/3' -d '{
    "title": "3",
    "tags": [{
        "tag": "B",
        "weight": 2
    }, {
        "tag": "D",
        "weight": 4
    }]
}
'
echo
curl -XPOST 'http://localhost:9200/test-idx/_refresh'
echo
# Example with custom script (slower but more flexable)
curl -XGET 'http://localhost:9200/test-idx/doc/_search?pretty=true' -d '{
    "query" : { 
        "nested": {
            "path": "tags",
            "score_mode": "total",
            "query": {
                "custom_score": {
                    "query": {
                        "terms": {
                            "tag": ["A", "B", "D"],
                            "minimum_match" : 1
                        }
                    },
                    "script" : "doc['\''weight'\''].value"
                }
            }
        }
    },
    "fields": []
}'
echo 
```

# android - 基本的 AndroidPlot 条形图？

> ID：13095868
> 
> 赞同：1
> 
> 时间：2012-10-26T23:54:31.010
> 
> 标签：android, graph, charts, plot, androidplot

寻找一个基本的“ [AndroidPlot](http://androidplot.com/wiki/Home) ”条形图示例。

一些人通过网站论坛联系了开发人员，但他提到他仍在编写该教程。

但是，他确实链接到了一个更[深入的示例](https://androidplot.jira.com/source/browse/ANDROIDPLOT/trunk/Examples/DemoApp/src/com/androidplot/demos/OrientationSensorExampleActivity.java?hb=true)以供现在查看。

问题是我无法弄清楚哪些部分呈现条形图与其他功能，因为我显然不熟悉库中更复杂的部分。

任何人都可以帮助我了解条形图的基本代码结构，请使用 AndroidPlot 吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T08:54:04.623

我用 AChartEngine 让它像这样工作（设置，我使用一个渲染器，一个数据集，它是一个活跃的变化图）：

```
LinearLayout layout = (LinearLayout)findViewById(R.id.chart);

// setup dataset and renderer
dataset = new XYMultipleSeriesDataset();
renderer = new XYMultipleSeriesRenderer();

// configure renderer
renderer.setZoomEnabled(false, false);
renderer.setPanEnabled(false, false);
renderer.setYAxisMax(90);
renderer.setYAxisMin(0);
renderer.setXAxisMin(-1);
renderer.setBarSpacing(0.5);
renderer.setShowLegend(false);
renderer.setXLabels(0);             // hides the default labels
renderer.setLabelsTextSize(15);

// create chart
mChartView = ChartFactory.getBarChartView(this, dataset, renderer, BarChart.Type.DEFAULT);
layout.addView(mChartView, new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));

// add some data, so the chart shows
XYSeriesRenderer r = new XYSeriesRenderer();
r.setColor(Color.rgb(192, 192, 192));
renderer.addSeriesRenderer(r);
XYSeries c = new XYSeries("");
c.add(0,0);
dataset.addSeries(c); 
```

然后，再次渲染它以使其活跃起来（注意我从自己的代码中删除了一些部分，它可能不完整）：

```
// remove any bars that already exist
if (theAct.dataset.getSeriesCount() > 0) {
    theAct.dataset.removeSeries(0);
}

XYSeries c = new XYSeries("");

// for some reason, the bar is very narrow, when only one bar is shown,
// when we use a negative spacing, the bar will be bigger
// i is the number of bars
if (i == 1) {
    theAct.renderer.setBarSpacing(-0.8);
} else {
    theAct.renderer.setBarSpacing(0.5);
}

// finish up and render!
theAct.renderer.setXAxisMax(i);
theAct.dataset.addSeries(c);
theAct.mChartView.zoomReset();
theAct.mChartView.repaint(); 
```

# gcc - GCC中的stdcall有什么等价物吗？

> ID：13095869
> 
> 赞同：12
> 
> 时间：2012-10-26T23:54:35.803
> 
> 标签：gcc, assembly, kernel, stdcall

我正在使用 GCC 开发自己的内核，当从 asm 代码调用 C 函数时，我必须`add esp,xx`自己做。经过一番搜索，我发现这`stdcall`是微软的发明，不能在 GCC 中使用。有什么方便的方法来完成这项工作吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-27T00:09:21.040

> linux中的stdcall有什么等价的吗？
> 
> 我在linux环境中的内核

等等，这是你自己的内核，还是 Linux 内核？因为如果它是你自己的内核，它就不再是 Linux。

1.  如果你在 Linux 上工作，你会想要坚持常规的调用约定并编写你的程序集来匹配。

2.  如果你在自己的内核上工作，你可以做任何你想做的事情。GCC 和 Clang 都支持`stdcall`ix86 处理器上的调用约定，例如，

    ```
     #define stdcall __attribute__((stdcall)) 
    ```

    请参阅：[函数属性（GCC 手册）](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/Function-Attributes.html)

# sql-server-2008 - 合并不插入。没有错误

> ID：13095871
> 
> 赞同：1
> 
> 时间：2012-10-26T23:54:59.677
> 
> 标签：sql-server-2008

有人能告诉我为什么这个插入失败但也没有给我错误吗？我该如何解决？

```
merge table1 as T1
using(select p.1,p.2,p.3,p.4,p.5 from @parameters p
inner join table1 t2
on p.1 = t2.1
and p.2 = t2.2
and p.3 = t2.3
and p.4 = t2.4) as SRC on SRC.2 = T1.2
when not matched then insert (p.1,p.2,p.3,p.4,p.5) 
values (SRC.1,SRC.2,SRC.3,SRC.4,SRC.5)
when matched then update set t1.5 = SRC.5; 
```

T1 表目前是空的，所以没有什么可以匹配的。参数表中确实有数据。我只需要修改这个合并，以便在决定做什么之前检查所有 4 个字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T00:05:54.023

您不能从变量中进行选择：`from @parameters`

请参阅以下帖子：[在 SQL Server 2008 的“From”子句中为表名使用变量](https://stackoverflow.com/questions/988610/using-a-variable-for-table-name-in-from-clause-in-sql-server-2008)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T18:34:36.380

实际上，您可以使用变量表。一探究竟：

```
 MERGE Target_table AS [Target]
  USING @parameters AS [Source]
  ON (

        [Target].col1 = [Source].col1
        AND [Target].col2 = [Source].col2
        AND [Target].col3 = [Source].col3
        AND [Target].col4 = [Source].col4
        )
  WHEN NOT MATCHED BY TARGET
  THEN INSERT (col1,col2,col3,col4,col5)
  VALUES (
              [Source].col1
              ,[Source].col2
              ,[Source].col3
              ,[Source].col4
              ,[Source].col5
                  )
  WHEN MATCHED
  THEN UPDATE SET [Target].col5 = [Source].col5; 
```

# php - 用haversine和float计算距离......有点工作

> ID：13095872
> 
> 赞同：0
> 
> 时间：2012-10-26T23:55:02.557
> 
> 标签：php, floating-point, distance, haversine

我正在使用 hasrsine 查询来提取最接近移动应用程序提供的纬度/经度的位置。

查询如下所示：

```
SELECT *,(((acos(sin(($latitude *pi()/180)) * sin((`lat`*pi()/180))+cos(($latitude *pi()/180)) * cos((`lat`*pi()/180))* cos((($longitude - `lon`)*pi()/180))))*180/pi())*60*1.1515) AS dist_x 
FROM `work_places`
HAVING dist_x <= '1'
ORDER BY dist_x ASC
LIMIT 10 
```

这工作得很好，我得到的正是我应该得到的位置。

问题在于将 dist_x 转换为用户可读的内容。现在，假设 dist_x 读取为：0.00996273036944（floatval 和字符串显示相同，因此可以正确转换）

由于查询是在 1 英里范围内搜索，因此我试图将其转换为英尺，因此我将 dist_x 除以 5280。

```
 $distance = (float)( $dist_x / 5280 ); 
```

我得到的是 $distance = 1.88688075179E-6

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:18:07.727

我可能遗漏了一些东西，但是如果您想将英里转换为英尺，您不想乘以 5280 而不是除以吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-27T00:37:55.977

一英里是5280英尺，所以应该是

```
$distance = (float)( $dist_x * 5280 ); 
```

# java - 当我的模块文件夹中有罐子时，Webapp 没有部署在 glassfish 中

> ID：13095875
> 
> 赞同：2
> 
> 时间：2012-10-26T23:55:15.713
> 
> 标签：java, jakarta-ee, glassfish, osgi, glassfish-3

我有一个在 Glassfish 3.1.2 中运行的 Spring webapp。我刚刚开始将 webapp 转换为 OSGi。我取消部署现有的 webapp，并将 spring 和 gemini OSGi jar 复制到 Glassfish 安装中的 modules 目录中。然后我使用 Glassfish OSGi Web 控制台（我理解为某种定制的 Felix Web 控制台）安装并激活了它们，一切都很好。它什么也没做，但我可以在我想要测试的 Web 控制台中安装和激活它们。

然后，我开始使用 Glassfish 应用程序控制台重新部署现有 web 应用程序的**非 OSGi** jar，以查看这两种类型的 jar 是否可以共存，鉴于我对 OSGi 的理解，我认为它们应该能够共存。此时`NoClassDefFoundErrors`开始抱怨无法`org.apache.commons.logging`在其他类中找到。这些类作为已安装的 OSGi jar 存在于 Module 目录和应用程序类路径中。然后，我在控制台中停用了 jar，但没有删除 OSGi jar，但继续抛出异常。

我打印了一个类加载器，发现`WEB-INF`我的 web 应用程序中的 jar 没有被加载，但我不确定这是问题还是症状。

然后，我从已卸载的 OSGi jar 中删除了这些 jar，一切都重新开始工作，并且可以部署 webapp。

谁能想到为什么会发生这种情况？我猜模块目录的内容在类路径上，但如果是这样，为什么？如果我希望 OSGi 和非 OSGi jar 一起工作，我将如何防止这引起问题？

**旁注**

*   当我查看类加载器加载的类时，我看不到模块文件夹中的内容正在加载。
*   我可以在部署非 OSGi jar 后安装和激活 OSGi jar，但反之则不行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T07:51:13.997

（免责声明：我没有 glassfish 的具体经验，但 JBoss 和其他奇怪的环境具有类加载器层次结构）

您必须小心 java 中的类加载器层次结构 - 如果来自另一个类加载器，相同的字节码相等类将不相等或不可分配，并且在加载类时，通过加载类加载器或其父项来查找依赖项很重要。

要解决您的情况，您必须仔细检查此层次结构并检查委派和类解析的设置（例如 parent first / self first ）。

JBoss 试图通过引入统一的类加载器来解决这个问题，这导致一大堆各种各样的类以及默认设置下上下文/webapps 之间的资源泄漏。

# python - 故意在python中创建一个孤儿进程

> ID：13095878
> 
> 赞同：2
> 
> 时间：2012-10-26T23:55:45.510
> 
> 标签：python, parallel-processing, python-2.7, subprocess, multiprocessing

我有一个名为 MyScript 的 Python 脚本（类似 unix，基于 RHEL），它有两个函数，分别称为 A 和 B。我希望它们在不同的独立进程中运行（分离 B 和 A）：

*   启动脚本 MyScript
*   执行功能 A
*   生成一个新进程，将数据从函数 A 传递到 B
*   当函数 B 运行时，继续函数 A
*   当函数 A 完成时，即使 B 仍在运行，也要退出 MyScript

我认为我应该使用多处理来创建一个守护进程，但[文档](http://docs.python.org/library/multiprocessing.html#multiprocessing.Process)表明这不是正确的用例。所以，我决定生成一个子进程和 child^2 进程（孩子的孩子），然后强制孩子终止。虽然这种解决方法似乎有效，但看起来真的很难看。

你能帮我让它更pythonic吗？subprocess 模块是否有可以对函数进行操作的方法？下面的示例代码。

```
import multiprocessing
import time
import sys
import os

def parent_child():
    p = multiprocessing.current_process()
    print 'Starting parent child:', p.name, p.pid
    sys.stdout.flush()
    cc = multiprocessing.Process(name='childchild', target=child_child)
    cc.daemon = False
    cc.start()
    print 'Exiting parent child:', p.name, p.pid
    sys.stdout.flush()

def child_child():
    p = multiprocessing.current_process()
    print 'Starting child child:', p.name, p.pid
    sys.stdout.flush()
    time.sleep(30)
    print 'Exiting child child:', p.name, p.pid
    sys.stdout.flush()

def main():
    print 'starting main', os.getpid()
    d = multiprocessing.Process(name='parentchild', target=parent_child)
    d.daemon = False
    d.start()
    time.sleep(5)
    d.terminate()
    print 'exiting main', os.getpid()

main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T02:13:51.177

这里只是将功能移动到单个调用中的原始代码的随机版本`spawn_detached(callable)`。即使在程序退出后，它也会保持分离的进程运行：

```
import time
import os
from multiprocessing import Process, current_process

def spawn_detached(callable):
    p = _spawn_detached(0, callable)
    # give the process a moment to set up
    # and then kill the first child to detach
    # the second.
    time.sleep(.001)
    p.terminate()

def _spawn_detached(count, callable):
    count += 1
    p = current_process()
    print 'Process #%d: %s (%d)' % (count, p.name, p.pid)

    if count < 2:
        name = 'child'
    elif count == 2:
        name = callable.func_name
    else:
        # we should now be inside of our detached process
        # so just call the function
        return callable()

    # otherwise, spawn another process, passing the counter as well
    p = Process(name=name, target=_spawn_detached, args=(count, callable)) 
    p.daemon = False 
    p.start()
    return p

def operation():
    """ Just some arbitrary function """
    print "Entered detached process"
    time.sleep(15)
    print "Exiting detached process"

if __name__ == "__main__":
    print 'starting main', os.getpid()
    p = spawn_detached(operation)
    print 'exiting main', os.getpid() 
```

# java - Netbeans 生成 .jar 文件

> ID：13095879
> 
> 赞同：0
> 
> 时间：2012-10-26T23:56:09.983
> 
> 标签：java, netbeans, jar

当我清理和构建时，Netbeans 为我的 Java 项目生成一个 .jar 文件，它使用一个“lib”文件夹，其中包含我使用的所有外部 Jar 文件。我可以以某种方式告诉 Netbeans 将这些 Jar 文件打包到它制作的 .jar 中吗？这样我就可以将我的项目作为独立的 .jar 文件运行？

我在 Mac OSX 上使用 Netbeans 7.1.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:49:48.490

简短的答案是否定的，长答案很复杂。

首先，Java 不支持嵌入式 Jar（即，您不能简单地将依赖的 Jar 添加到主 Jar 中）。

其次，解压缩所有 Jar 并将它们合并为一个将覆盖任何共享相同路径/名称的资源/类。这在小型项目中可能不是问题，但在大型项目中是一个主要问题（我们在工作中从事的项目存在这个问题）。

一种解决方案是使用类似[One-Jar 的](http://one-jar.sourceforge.net/)东西，它基本上使用它自己的引导类加载器来向所有你引用嵌入在单个 Jar 中的 Jars。

我在使用我们自己的自定义类加载器时遇到了这个问题，但除此之外它似乎运行良好。

它包含 Ant 支持，因此您可以将它包含在您的项目 Ant 构建脚本中，如果您不使用 Maven，否则，您需要设计自己的构建过程

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T00:41:00.727

netbeans 中没有选项可以做到这一点。

还有一些其他选项可以快速搜索，但需要手动干预。

# javascript - JS上获取函数的父对象

> ID：13095882
> 
> 赞同：2
> 
> 时间：2012-10-26T23:56:33.010
> 
> 标签：javascript, html

有没有办法获取函数的父对象？比如哪个对象激活了这个功能？这是JS

```
var ua=false
function toggleUA() {

if (ua==false)

{document.getElementById("ua").src="http://i805.photobucket.com/albums/yy331/NatFan/uamap.png";ua=true;}
else
{document.getElementById("ua").src="http://upload.wikimedia.org/wikipedia/commons/8/8c/Transparent.png";ua=false;} } 
```

这是HTML

```
<img class="airline" id="ua" src="http://upload.wikimedia.org/wikipedia/commons/8/8c/Transparent.png" width="1500" height="744">
<table class="nav">

<tr>

<td class="star" onclick='toggleUA();'>United Airlines</td>

</tr>

</table> 
```

因此，如果我想让表格单元格在单击时更改颜色，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:00:02.043

我认为更安全的方法是将`this`函数调用作为第一个参数传递，然后使用它来操作它。如：

```
<td class="star" onclick='toggleUA(this);'>United Airlines</td> 
```

然后 Javascript 函数将被声明为：

```
function toggleUA(obj) { 
```

单击`obj`的在哪里（如果您在多个元素上使用它）。`<td>``<td>`

现在，通常事件侦听器的工作方式是您通常可以`this`在函数中自动引用而不必将其作为参数传递，但**内联**事件处理程序的工作方式不一样，您需要通过`this`.

更新：

要修改背景颜色或其他样式属性，可以使用`.style`元素的属性。有了这个，您应该能够修改任何 CSS 属性，并且对于背景颜色，使用：

```
this.style.backgroundColor = "#fff"; 
```

[https://developer.mozilla.org/en-US/docs/DOM/element.style](https://developer.mozilla.org/en-US/docs/DOM/element.style)

# z3 - Z3 中的链式（数据记录）程序

> ID：13095889
> 
> 赞同：0
> 
> 时间：2012-10-26T23:57:34.903
> 
> 标签：z3

某些程序分析可以编码为链程序（对应于上下文无关语言），属于 Datalog 程序的一种受限形式。链式程序中的每条规则都具有以下格式：

p(X,Y) :- q0(X,Z1), q1(Z1,Z2), q2(Z2,Z3)..., qn(Zn,Y)

我的问题是，与评估任意数据记录程序相比，Z3 是否可以利用链程序的结构并在评估链程序时更有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:16:02.860

Z3 的有限状态数据记录引擎使用自下而上的评估。它包括一个可以启用的执行魔术集转换的选项。这种转变在某些涉及链式程序的情况下确实会产生奇迹。您可以通过将 ":magic-sets-for-queries" 设置为 "true" 来启用该选项。希望这可以帮助

# windows-phone-7 - 关闭硬件按钮灯？

> ID：13095891
> 
> 赞同：0
> 
> 时间：2012-10-26T23:57:57.797
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone

我正在使用以下代码：

```
PhoneApplicationService.Current.UserIdleDetectionMode = 
    IdleDetectionMode.Disabled; 
```

以防止我的夜间时钟应用程序关闭。

但是，返回、主页、搜索按钮上的灯永远不会熄灭。这些对于床头柜时钟应用程序来说太亮了。

问题 - 有什么办法可以关闭这些？

谢谢！猪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T07:11:30.583

You can't manage the light of hardware buttons. :(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T09:17:40.480

考虑到早期版本的 Windows Phone 7 并没有让硬件按钮一直亮着，只有在使用它们时才会亮，这很烦人。但是现在它们在手机使用时不会关闭，并且似乎没有任何方法可以关闭它们或配置它们何时打开或类似的东西。希望微软不会放弃 Windows Phone 7 转而专注于 Windows Phone 8，但如果他们仍然进行更新，我希望硬件背光配置将成为其中之一。

# java - 如何为 javascript 结合这些正则表达式

> ID：13095892
> 
> 赞同：2
> 
> 时间：2012-10-26T23:57:58.220
> 
> 标签：java, javascript, regex, jakarta-ee

您好我正在尝试在 JS 中使用 regEx 来识别 3 个相同的连续字符（可以是字母、数字以及所有非字母数字字符）

这标识了 3 个相同的连续字母和数字：'(([0-9a-zA-Z])\1\1)'
这标识了 3 个相同的连续非字母数字：'(([^0-9a-zA-Z]) \1\1)'

我正在尝试将两者结合起来，如下所示：'(([0-9a-zA-Z])\1\1)|(([^0-9a-zA-Z])\1\1)'

但我做错了什么并且它不起作用..（为'88aa3BBdd99@@'返回true）

编辑：要找到 NO 3 个相同的字符，这似乎是错误的 /(^([0-9a-zA-Z]|[^0-9a-zA-Z])\1\1)/ --> [RegEx在JS中找到没有3个相同的连续字符](https://stackoverflow.com/questions/13101480/regex-in-js-to-find-no-3-identical-consecutive-characters)

感谢 Nohsib

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-27T00:02:41.013

问题是在整个正则表达式中，反向引用是从左到右计算的。因此，如果将它们结合起来，您的数字会发生变化：

```
(([0-9a-zA-Z])\2\2)|(([^0-9a-zA-Z])\4\4) 
```

您还可以删除外部括号：

```
([0-9a-zA-Z])\1\1|([^0-9a-zA-Z])\2\2 
```

或者，您可以一起捕获一组括号中的备选方案，并将一个反向引用附加到末尾：

```
([0-9a-zA-Z]|[^0-9a-zA-Z])\1\1 
```

但是由于您的字符类无论如何都匹配**所有**字符，因此您也可以像这样：

```
([\s\S])\1\1 
```

如果您激活 DOTALL 或 SINGLELINE 选项，您可以使用 a`.`代替：

```
(.)\1\1 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-27T00:01:57.863

它实际上要简单得多：

`(.)\1\1`

`(.)`匹配任何字符，每个字符`\1`都是与第一个捕获组匹配的确切字符串匹配的反向引用。您应该知道`.`实际匹配的内容，然后修改组（在括号中）以满足您的确切需求。

# bash - bash比较两个tar.gz

> ID：13095893
> 
> 赞同：0
> 
> 时间：2012-10-26T23:58:02.400
> 
> 标签：bash, compare, tar, gzip

我需要比较两个档案 tar.gz，而不是解压缩它们，列出第一个拱门中不在第二个拱门中的文件名。

我尝试了几种方法，但每一种都失败了。我是 bash 的新手。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-27T00:00:43.727

```
comm -23 <(tar -tzf 1.tar.gz | sort) <(tar -tzf 2.tar.gz | sort) 
```

# ios - 以编程方式添加插座

> ID：13095897
> 
> 赞同：0
> 
> 时间：2012-10-26T23:58:22.313
> 
> 标签：ios, xcode, nsarray, iboutlet

在 Interface Builder 中，很容易将 NIB 中的对象连接到 File's Owner 中的插座

我有一个 UIImage 数组
我需要以编程方式为数组的每个图像创建一个插座？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:24:27.987

您只需要`IBOutlet`您在 IB、Interface Builder 中创建的那些控件的条目。如果您以编程方式创建控件，这听起来像是您想做的那样，您可以继续以编程方式创建您的`UIImageView`对象，但您不会没有相应的`IBOutlet`语句。

谷歌“UIImageView create programmatically”获取一些示例。

# ruby - Ruby 可枚举不保持同一个类

> ID：13095900
> 
> 赞同：5
> 
> 时间：2012-10-26T23:58:28.850
> 
> 标签：ruby, enumerable

我有一个代表集合的类。我将`Enumerable`模块包含在其中并定义了方法`#each`，以便获得它的所有方法。

但问题是`Enumerable`'s 方法不保持同一个类。因此，例如，如果我的班级名为`Collection`，如果我这样做`Collection#select`了，我希望结果的班级也是`Collection`（而不是`Array`）。有没有办法实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-27T00:04:18.593

由于`Enumerable#select`旨在返回一个数组，因此您需要在某处告诉如何将其映射到`Collection`实例。这意味着，您明确需要定义`Collection#select`. 否则 Ruby 将不知道从原始数组结果`Enumerable#select`到`Collection`实例的映射规则。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-27T03:26:26.730

不幸的是，Ruby 的集合操作不是类型保留的。每个收集操作总是返回一个`Array`.

`Set`对于像s 或s 这样的集合`Tree`，这只是烦人的，因为您需要始终将它们转换回您想要的类型。但例如对于所有素数的无限惰性流，这是灾难性的：您的程序将挂起或内存不足，试图构造一个无限大的`Array`.

大多数 Collection API 要么消除重复代码，要么保持类型，但不能同时使用两者。例如，.NET 的 Collection API 主要消除了重复代码，但它总是返回相同的类型：（`IEnumerable`相当于 Ruby 的`Enumerator`）。Smalltalk 的 Collection API 是类型保留的，但它通过在每个 Collection 类型中复制所有 Collection 操作来实现这一点。

唯一保留类型但消除重复的 Collection API 是 Scala 的。它通过引入*Collection Builders*的新概念来实现这一点，它知道如何有效地构造特定类型的 Collection。集合操作是根据集合构建器实现的，只有集合构建器需要复制……但无论如何，这些操作都是特定于每个集合的。

如果您想在 Ruby 中保留类型的集合操作，您需要在您自己的集合中复制所有集合操作（​​这将仅限于您自己的代码），或者重新设计整个集合 API 以使用构建器（这需要重新设计不仅包括您自己的代码，还包括现有的集合，包括曾经编写的每个第三方集合）。

很明显，第二种方法如果不是不可能的话，至少是不切实际的。但是，第一种方法也有其问题：集合操作*应*返回`Array`s，违反该预期可能会破坏其他人的代码！

您可以采用类似于 Ruby 2.0 的惰性集合操作的方法：您可以`preserve_type`向 API 添加一个新方法，该方法返回一个具有类型保留集合操作的代理对象。这样，与标准 API 的背离就在代码中清楚地标明：

```
c.select …               # always returns an Array

c.preserve_type.select … # returns whatever the type of c is 
```

就像是：

```
class Hash
  def preserve_type
    TypePreservingHash.new(self)
  end
end

class TypePreservingHash
  def initialize(original)
    @original = original
  end

  def map(*args, &block)
    Hash[@original.map(*args, &block)
    # You may want to do something more efficient
  end
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-27T02:04:16.540

另一种方法是让 Collection 成为底层数组的代理：

```
class Collection
  def initialize( items= nil )
    @items = items || []
  end

  def respond_to_missing?(method_name, include_private = false)
    Enumerable.instance_methods.include? method_name
  end

  def method_missing name, *args, &block
    if @items.respond_to? name
      res = @items.send name, *args, &block
      res.kind_of?( Array ) ? Collection.new(res) : res
    else
      super
    end
  end
end 
```

在 IRB 中：

```
col = Collection.new [1,2,3]
=> #<Collection:0x0000010102d5d0 @items=[1, 2, 3]>
col.respond_to? :map
=> true
col.map{|x| x * 2 }
=> #<Collection:0x000001009bff18 @items=[2, 4, 6]> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-05-15T15:35:17.227

以下对我有用。我发现只有过滤方法需要重新定义。如果我们重新定义所有返回的方法`Array`，这包括`collect`不应该重新定义的方法。

```
 include Enumerable

  def select(&block)
    self.class.new(super.select(&block))
  end

  def reject(&block)
    self.class.new(super.reject(&block))
  end 
```

# asp.net - 在 Web.config 之外存储 Paypal Payments Pro 帐户信息

> ID：13095904
> 
> 赞同：0
> 
> 时间：2012-10-26T23:59:15.863
> 
> 标签：asp.net, web-config, paypal

我正在[为 Paypal Payments Pro 使用 .NET SDK](https://www.x.com/developers/paypal/documentation-tools/paypal-sdk-index)。示例应用程序将 API 帐户凭证存储在网站的`Web.config`文件中。相反，我希望能够从数据库中提取这些凭据。

一些搜索出现了这个条目，它提出了同样的问题：[在 web.config 中编辑设置](https://stackoverflow.com/questions/12985068/edit-settings-in-web-config)。不幸的是，接受的答案没有解决如何将凭据存储在其他地方。相反，它展示了如何以编程方式修改`Web.config`文件。

有没有办法以编程方式指定 Paypal Payments Pro API 凭据？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T00:30:01.150

**UDPATE**

您应该能够重写`ConfigManager`类和`SDKConfigHandler`类以从数据库中检索值（不是`web.config`）。

`ConfigManager`检索数据并使用`SDKConfigHandler`类来构造数据，以便其他方法和类可以使用它。

您将在`\PayPal_Merchant_SDK\Manager\`.

**ORIGINAL** 在查看[SDK](https://www.x.com/sites/default/files/Payflow_dotNET_v4.50RC.zip)之后，看起来您所要做的就是使用新`UserInfo`对象指定凭据：

```
UserInfo User = new UserInfo("<user>", "<vendor>", "<partner>", "<password>"); 
```

您只需要填充`user`、`vendor`、`partner`和`password`，因此我认为没有理由不能将它们存储在数据库中并在必要时检索它们。

该`UserInfo`对象作为参数传递给`SaleTransaction`构造函数。

```
SaleTransaction Trans = new SaleTransaction(User, Connection, Inv, Card, RequestID); 
```

似乎只要在切换凭据后重新实例化`UserInfo`对象和`SaleTransaction`对象，就可以了。

`PayflowUtility.AppSettings`似乎只是从 中检索值的辅助方法`app.config`。从第 87 行开始`DOSaleComplete.cs`：

```
Should you choose to store the login information (Vendor, User, Partner and Password) in
app.config, you can retrieve the data using PayflowUtility.AppSettings. 

For Example:

    App.Config Entry: <add key="PayflowPartner" value="PayPal"/>

    String mUser = PayflowUtility.AppSettings("PayflowUser"); 
    String mVendor = PayflowUtility.AppSettings("PayflowVendor");
    String mPartner = PayflowUtility.AppSettings("PayflowPartner");
    String mPassword = PayflowUtility.AppSettings("PayflowPassword");

    UserInfo User = new UserInfo (mUser, mVendor, mPartner, mPassword); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T13:13:57.443

目前，PayPal .NET SDK 旨在仅从配置文件中选择 API 帐户凭据。也许，未来的版本将支持动态认证。

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T17:36:32.717

有人在 github 上分叉项目以使用哈希表而不是 web.config [https://github.com/paypal/sdk-core-dotnet/pull/2](https://github.com/paypal/sdk-core-dotnet/pull/2)

> 此变更集允许以哈希表形式将 PayPal 配置传递给 PayPalAPIInterfaceServiceService。这允许将配置数据存储在外部配置文件或数据库中，而不是强制使用 app/web.config 文件。这对于执行多个调用应用程序使用的 PayPal SDK 操作的共享类库特别有用；将大量帐户存储在数据库而不是配置文件中的能力也是有利的。支持现有 app/web.config 配置的向后兼容性。

# gawk - gawk 中的二进制数

> ID：13095906
> 
> 赞同：2
> 
> 时间：2012-10-26T23:59:46.730
> 
> 标签：gawk, radix

如何将一个数字指定为二进制`gawk`？

根据[手册](http://www.gnu.org/software/gawk/manual/html_node/Nondecimal_002dnumbers.html)，`gawk`将所有数字解释为十进制，除非它们前面有`0`（八进制）或`0x`（十六进制）。与某些其他语言不同，`0b`它不会起作用。

例如，以下行没有给出所需的输出 (`010000`或`10000`)，因为这些值分别被解释为八进制/十进制或十进制/十进制：

```
gawk '{print and(010000,110000)}'
0

gawk '{print and(10000,110000)}'
9488 
```

我怀疑它`gawk`可能不支持base-2，并且需要用户定义的函数来生成二进制表示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T04:27:47.310

你是对的，gawk 中没有对二进制转换的内部支持。令人难以置信的是，在`printf()`. 所以你被功能困住了。

请记住，awk 是[*弱类型*](http://en.wikipedia.org/wiki/Weak_typing)的。这就是为什么函数有一些疯狂的行为，比如识别字符串开头的“0x”意味着它是一个十六进制数。在这样的语言中，最好控制自己的类型。

这是我多年来一直坐在那里的几个功能......

```
#!/usr/local/bin/gawk -f

function bin2dec(n) {
  result = 0;
  if (n~/[^01]/) {
    return n;
  }
  for (i=length(n); i; i--) {
    result += 2^(length(n)-i) * substr(n,i,1);
  }
  return result;
}

function dec2bin(n) {
  result = "";
  while (n) {
    if (n%2) {
      result = "1" result;
    } else {
      result = "0" result;
    }
    n = int(n/2);
  }
  return result;
}

{
  print dec2bin( and(bin2dec($1),bin2dec($2)) );
} 
```

结果：

```
$ echo "1101 1011" | ./doit.awk
1001
$ echo "11110 10011" | ./doit.awk
10010
$ 
```

# c++ - 在 C++ 中将 UpdateResource 与 StringTables 一起使用

> ID：13095907
> 
> 赞同：1
> 
> 时间：2012-10-26T23:59:56.550
> 
> 标签：c++, embedded-resource

我需要使用 UpdateResource() 在 C++ 中编辑文件的资源，但是我不确定如何获取第 5 个参数 (lpData) 的数据。

我不知道如何创建需要为功能和数据结构提供的数据，有人可以提供有关如何获取/创建数据的指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:33:47.440

您可以简单地使用：

```
wchar_t wszMyText[] = L"Some text";
HANDLE hUpdate = BeginUpdateResourceW( L"/path/to/file", FALSE );
// test return value.
BOOL res = UpdateResourceW( hUpdate, RT_STRING, L"MyResource", wszMyText,
    sizeof(wszMyText) - sizeof(wchar_t);
// check return value
EndUpdateResource( hUpdate, FALSE ); 
```

# linux - 使用 netcat 进行两个端口之间的外部环回测试

> ID：13095909
> 
> 赞同：2
> 
> 时间：2012-10-27T00:00:11.840
> 
> 标签：linux, networking, iptables, netcat

我正在编写一个测试脚本来在制造过程中锻炼处理器板的老化周期。我想使用 netcat 将文件从一个进程传输到一个以太网端口并返回到另一个以太网端口到接收进程。看起来**netcat**将是一个简单的工具。

问题是，如果我在不同的 IP 子网上设置带有 IP 地址的以太网端口并尝试将数据从一个传输到另一个，内核的协议栈会检测到内部路由，尽管数据传输按预期完成，但它不会走出电线。数据包在内部路由。

这对网络优化非常有用，但它挫败了我想做的测试。

有没有简单的方法来完成这项工作？**iptables**有一个可以工作的技巧吗？或者你可以对**路由**表做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T12:50:15.537

首选内部路由，因为在默认路由行为中，您将所有内部路由标记为`scope link`表`local`中。看看这个：

```
ip rule show
ip route show table local 
```

如果你的内核支持多个路由表，你可以简单地改变`local`表来实现你的目标。你不需要`iptables`。

假设 192.168.1.1 是您的目标 IP 地址，而 eth0 是您要将数据包发送到网络的接口。

```
ip route add 192.168.1.1/32 dev eth0 table local 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-03T02:10:42.113

我使用网络名称空间来做这种事情。对于不同命名空间中的每个适配器，数据流量肯定会通过线路而不是反映在网络堆栈中。单独的命名空间还可以防止反向数据包过滤器等阻碍。

所以假设 eth0 和 eth1，以 iperf3 作为反射代理（ping 服务器或其他）。[免责声明：文字来自记忆，所有错别字都是错别字，YMMV]

```
ip netns add target
ip link set dev eth1 up netns target
ip netns exec target ip address add dev eth1 xxx.xxx.xxx.xxx/y 
ip netns exec target iperf3 --server 
```

所以现在您已经创建了命名空间“目标”，将您的一个适配器移动到该命名空间中。设置它的IP地址。最后在该目标命名空间中运行您的应用程序。

您现在可以在本机命名空间中运行任何（兼容的）程序，如果它引用 xxx.xxx.xxx.xxx IP 地址（显然必须可以通过某些路由访问）将导致在线流量环回路径，将在另一个名称空间中找到适配器，就好像它是不同的计算机一样。

完成后，您终止守护程序服务器并按名称删除命名空间，然后命名空间成员恢复，您将返回原版。

```
killall iperf3
ip netns delete target 
```

这也适用于单个接口的“虚拟功能”，但该示例需要梳理出一个或多个虚拟功能——例如 SR-IOV 类型适配器——并分发本地 MAC 地址。所以我做的还不够，没有准备好示例代码花絮。

# ios - 如何调整区域以适应刚刚出现的自定义注释标注？

> ID：13095911
> 
> 赞同：3
> 
> 时间：2012-10-27T00:00:24.990
> 
> 标签：ios, mkmapview, mkannotationview, mapkit

我使用我的自定义子类 MKAnnotationView。在我的 Map 委托的*mapView:didSelectAnnotationView:*方法中，我调用了这个类的方法，它将带有图像的 UIImageView 添加为子视图 - 它用作我的自定义注释标注。

当使用默认的 MKPinAnnotationView 地图时，地图会自动调整地图区域以显示刚刚出现的注释标注。如何使用自定义 MKAnnotationView 子类实现此行为？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T03:03:11.550

**当前解决方案**

> 我制作了演示项目，实现了下面讨论的内容：请参阅 [AdjustRegionToFitAnnotationCallout](https://github.com/stanislaw/Examples/tree/20140114-adjust-region-to-fit-annotation-callout)项目。

Map Kit 的 MKMapView 如何呈现地图注释的最新 iOS7 更改让我重新审视了这个问题。我对此进行了更准确的思考，并提出了非常非常好的解决方案。我将把以前的解决方案留在这个答案的底部，但请记住 - 当我这样做时我错了。

首先，我们需要一个帮助器`CGRectTransformToContainRect()`来扩展一个给定`CGRect`的以包含另一个`CGRect`。

注意：它的行为与它的行为不同`CGRectUnion()`-只返回包含两者`CGRectUnion()`的最小的，而下面的助手允许平行移动，即等于而不是喜欢它。*当我们只想使用平行移动进行调整并希望避免地图的缩放*时，这种行为正是我们所需要的。`CGRect``CGRects``CGRectTransformToContainRect(CGRectMake(0, 0, 100, 100), CGRectMake(50, 50, 100, 100))``(CGRect){50, 50, 100, 100}``(CGRect){0, 0, 150, 150}``CGRectUnion()`

 *```
static inline CGRect CGRectTransformToContainRect(CGRect rectToTransform, CGRect rectToContain) {
    CGFloat diff;
    CGRect transformedRect = rectToTransform;

    // Transformed rect dimensions should encompass the dimensions of both rects
    transformedRect.size.width = MAX(CGRectGetWidth(rectToTransform), CGRectGetWidth(rectToContain));
    transformedRect.size.height = MAX(CGRectGetHeight(rectToTransform), CGRectGetHeight(rectToContain));

    // Comparing max X borders of both rects, adjust if
    if ((diff = CGRectGetMaxX(rectToContain) - CGRectGetMaxX(transformedRect)) > 0) {
        transformedRect.origin.x += diff;
    }
    // Comparing min X borders of both rects, adjust if
    else if ((diff = CGRectGetMinX(transformedRect) - CGRectGetMinX(rectToContain)) > 0) {
        transformedRect.origin.x -= diff;
    }

    // Comparing max Y borders of both rects, adjust if
    if ((diff = CGRectGetMaxY(rectToContain) - CGRectGetMaxY(transformedRect)) > 0) {
        transformedRect.origin.y += diff;
    }
    // Comparing min Y borders of both rects, adjust if
    else if ((diff = CGRectGetMinY(transformedRect) - CGRectGetMinY(rectToContain)) > 0) {
        transformedRect.origin.y -= diff;
    }

    return transformedRect;
}

Adjust method wrapped into an Objective-C category MKMapView(Extensions):

@implementation MKMapView (Extensions)

- (void)adjustToContainRect:(CGRect)rect usingReferenceView:(UIView *)referenceView  animated:(BOOL)animated {
    // I just like this assert here
    NSParameterAssert(referenceView);

    CGRect visibleRect = [self convertRegion:self.region toRectToView:self];

    // We convert our annotation from its own coordinate system to a coodinate system of a map's top view, so we can compare it with the bounds of the map itself
    CGRect annotationRect = [self convertRect:rect fromView:referenceView.superview];

    // Fatten the area occupied by your annotation if you want to have a margin after adjustment
    CGFloat additionalMargin = 2;
    adjustedRect.origin.x -= additionalMargin;
    adjustedRect.origin.y -= additionalMargin;
    adjustedRect.size.width += additionalMargin * 2;
    adjustedRect.size.height += additionalMargin * 2;

    // This is the magic: if the map must expand its bounds to contain annotation, it will do this 
    CGRect adjustedRect = CGRectTransformToContainRect(visibleRect, annotationRect);

    // Now we just convert adjusted rect to a coordinate region
    MKCoordinateRegion adjustedRegion = [self convertRect:adjustedRect toRegionFromView:self];

    // Trivial regionThatFits: sugar and final setRegion:animated: call
    [self setRegion:[self regionThatFits:adjustedRegion] animated:animated];
}

@end 
```

现在控制器和视图：

```
@interface AnnotationView : MKAnnotationView
@property AnnotationCalloutView *calloutView;
@property (readonly) CGRect annotationViewWithCalloutViewFrame;
@end

@implementation AnnotationView 

- (void)showCalloutBubble {
    // This is a code where you create your custom annotation callout view
    // add add it using -[self addSubview:]
    // At the end of this method a callout view should be displayed.
}

- (CGRect)annotationViewWithCalloutViewFrame {
    // Here you should adjust your annotation frame so it match itself in the moment when annotation callout is displayed and ...

    return CGRectOfAdjustedAnnotation; // ...
}

@end 
```

当在地图上选择 AnnotationView 类注解时，会将其*calloutView*添加为子视图，从而显示自定义注解标注视图。它是使用 MKMapViewDelegate 的方法完成的：

```
- (void)mapView:(MapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view {
    // AnnotationPresenter is just a class that contains information to be displayed on callout annotation view
    if ([view.annotation isKindOfClass:[AnnotationPresenter class]]) {
        // Hide another annotation if it is shown
        if (mapView.selectedAnnotationView != nil && [mapView.selectedAnnotationView isKindOfClass:[AnnotationView class]] && mapView.selectedAnnotationView != view) {
            [mapView.selectedAnnotationView hideCalloutBubble];
        }
        mapView.selectedAnnotationView = view;

        annotationView *annotationView = (annotationView *)view;

        // This just adds *calloutView* as a subview    
        [annotationView showCalloutBubble];

        [mapView adjustToContainRect:annotationView.annotationViewWithCalloutViewFrame usingReferenceView:annotationView animated:NO];
    }
} 
```

* * *

当然，您的实现可能与我在这里描述的不同（我的是！）。上面代码中最重要的部分当然是`[MKMapView adjustToContainRect:usingReferenceView:animated:`方法。现在我对当前的解决方案以及我对这个（以及一些相关）问题的理解感到非常满意。如果您需要对上述解决方案有任何意见，请随时与我联系（参见个人资料）。

以下 Apple 文档对于了解 -[MKMapView convertRect:fromView:] 等方法中发生的情况非常有用：

[http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKMapView_Class/MKMapView/MKMapView.html](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKMapView_Class/MKMapView/MKMapView.html)

[http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MapKitDataTypesReference/Reference/reference.html](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MapKitDataTypesReference/Reference/reference.html)

[http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MapKitFunctionsReference/Reference/reference.html](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MapKitFunctionsReference/Reference/reference.html)

此外，WWDC 2013 会议的前 10-15 分钟“Map Kit 中的新功能”（#304）非常值得观看，以观看由 Apple 工程师完成的整个“带注释的地图”设置的出色快速演示。

* * *

**初步解决方案（iOS7下不行，不要用，改用上面的方案）**

不知怎的，我一次忘了回答我的问题。这是我现在使用的完整解决方案（为了便于阅读，稍作编辑）：

首先，将一些地图逻辑封装在帮助文件（如 MapKit+Helpers.h）中的某个位置

```
typedef struct {
    CLLocationDegrees top;
    CLLocationDegrees bottom;
} MKLatitudeEdgedSpan;

typedef struct {
    CLLocationDegrees left;
    CLLocationDegrees right;
} MKLongitudeEdgedSpan;

typedef struct {
    MKLatitudeEdgedSpan latitude;
    MKLongitudeEdgedSpan longitude;
} MKEdgedRegion;

MKEdgedRegion MKEdgedRegionFromCoordinateRegion(MKCoordinateRegion region) {
    MKEdgedRegion edgedRegion;

    float latitude = region.center.latitude;
    float longitude = region.center.longitude;
    float latitudeDelta = region.span.latitudeDelta;
    float longitudeDelta = region.span.longitudeDelta;

    edgedRegion.longitude.left = longitude - longitudeDelta / 2;
    edgedRegion.longitude.right = longitude + longitudeDelta / 2;
    edgedRegion.latitude.top = latitude + latitudeDelta / 2;
    edgedRegion.latitude.bottom = latitude - latitudeDelta / 2;

    return edgedRegion;
} 
```

与 MKCoordinateRegion（中心坐标 + 跨度）一样，MKEdgedRegion 只是一种定义区域的方法，但使用的是其边缘的坐标。

MKEdgedRegionFromCoordinateRegion() 是一种不言自明的转换器方法。

假设我们的注释有以下类，包含它的标注作为子视图。

```
@interface AnnotationView : MKAnnotationView
@property AnnotationCalloutView *calloutView;
@end 
```

当在地图上选择 AnnotationView 类注解时，会将其*calloutView*添加为子视图，从而显示自定义注解标注视图。它是使用 MKMapViewDelegate 的方法完成的：

```
- (void)mapView:(MapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view {
    // AnnotationPresenter is just a class that contains information to be displayed on callout annotation view
    if ([view.annotation isKindOfClass:[AnnotationPresenter class]]) {
        // Hide another annotation if it is shown
        if (mapView.selectedAnnotationView != nil && [mapView.selectedAnnotationView isKindOfClass:[AnnotationView class]] && mapView.selectedAnnotationView != view) {
            [mapView.selectedAnnotationView hideCalloutBubble];
        }
        mapView.selectedAnnotationView = view;

        annotationView *annotationView = (annotationView *)view;

        // This just adds *calloutView* as a subview    
        [annotationView showCalloutBubble];

        /* Here the trickiest piece of code goes */

        /* 1\. We capture _annotation's (not callout's)_ frame in its superview's (map's!) coordinate system resulting in something like (CGRect){4910547.000000, 2967852.000000, 23.000000, 28.000000} The .origin.x and .origin.y are especially important! */
        CGRect annotationFrame = annotationView.frame;

        /* 2\. Now we need to perform an adjustment, so our frame would correspond to the annotation view's _callout view subview_ that it holds. */
        annotationFrame.origin.x = annotationFrame.origin.x + ANNOTATION_CALLOUT_TRIANLE_HALF; // Mine callout view has small x offset - you should choose yours!
        annotationFrame.origin.y = annotationFrame.origin.y - ANNOTATION_CALLOUT_HEIGHT / 2; // Again my custom offset.
        annotationFrame.size = placeAnnotationView.calloutView.frame.size; // We can grab calloutView size directly because in its case we don't care about the coordinate system.

        MKCoordinateRegion mapRegion = mapView.region;

        /* 3\. This was a long run before I did stop to try to pass mapView.view as an argument to _toRegionFromView_. */
        /* annotationView.superView is very important - it gives us the same coordinate system that annotationFrame.origin is based. */
        MKCoordinateRegion annotationRegion = [mapView convertRect:annotationFrame toRegionFromView:annotationView.superview];

        /* I hope that the following MKEdgedRegion magic is self-explanatory */
        MKEdgedRegion mapEdgedRegion = MKEdgedRegionFromCoordinateRegion(mapRegion);
        MKEdgedRegion annotationEdgedRegion = MKEdgedRegionFromCoordinateRegion(annotationRegion);

        float diff;

        if ((diff = (annotationEdgedRegion.longitude.left - mapEdgedRegion.longitude.left)) < 0 ||
            (diff = (annotationEdgedRegion.longitude.right - mapEdgedRegion.longitude.right)) > 0)
            mapRegion.center.longitude += diff;

        if ((diff = (annotationEdgedRegion.latitude.bottom - mapEdgedRegion.latitude.bottom)) < 0 ||
            (diff = (annotationEdgedRegion.latitude.top - mapEdgedRegion.latitude.top)) > 0)
            mapRegion.center.latitude += diff;

        mapView.region = mapRegion;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-15T09:49:11.757

我一直在寻找类似的解决方案，以在屏幕的可见矩形中适应路线和标注。我尝试了一些解决方案，但最终只设置了足够的填充`setVisibleMapRect:edgePadding:animated:`。可能没有那么复杂，但基本上可以满足我的需要。

```
MKMapRect routeMapRect = myRoute.polyline.boundingMapRect;
CGFloat padding = myCallout.bounds.width / 2.0;
[myMapView setVisibleMapRect: routeMapRect edgePadding:UIEdgeInsetsMake(padding, padding, padding, padding) animated:YES]; 
```

当然，这可以更加优化，例如通过检测您实际需要填充的一侧并在另一侧设置较小的填充。但你明白了。*

# c++ - Linux - 从不同位置编译 c++ 项目文件

> ID：13095912
> 
> 赞同：0
> 
> 时间：2012-10-27T00:00:31.637
> 
> 标签：c++, c, linux

> **可能重复：**
> [如何在 linux 中为 gcc 添加默认包含路径？](https://stackoverflow.com/questions/558803/how-to-add-a-default-include-path-for-gcc-in-linux)

我想知道如果它们包含在代码本身中，是否可以将来自不同位置的文件编译在一起？假设头文件位于另一个位置，但 cpp 文件中有 #include "header.h"。我在网站上寻找答案，但我发现的唯一一件事是如何从同一位置编译多个文件。

编辑：我在 linux 上使用 g++ 编译器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:21:09.450

你可以把

```
#include "adress" 
```

地址就像 C:/Users/Files.../header.h

# php - 从 AJAX 发布表单自动更新数据

> ID：13095914
> 
> 赞同：0
> 
> 时间：2012-10-27T00:00:39.917
> 
> 标签：php, ajax

我正在使用 AJAX 脚本从表单发布数据并从 php 文件返回处理后的数据。脚本如下。

```
 function loadXmlDoc(hashtag){
    var xmlhttp;
    if (window.XMLHttpRequest){
        xmlhttp = new XMLHttpRequest();
    }
    else{
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange = function(){
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
            document.getElementById("ajaxify").innerHTML = xmlhttp.responseText;
        }
    }
    xmlhttp.open("POST", "demo_ajax3.php", true);
    xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xmlhttp.send("hashtag=" + hashtag);
    } 
```

但是我想自动更新结果。我如何让它自动更新，以便检查更多数据？或者最好的方法是什么？

从我所看到的情况来看，让 AJAX 表单自动刷新似乎没什么，所以任何帮助都会受到极大的赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T01:41:35.793

试试这个方法。它应该每 10 秒自动更新一次结果。

```
var xmlhttp;
if (window.XMLHttpRequest){
    xmlhttp = new XMLHttpRequest();
}
else{
    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.onreadystatechange = function(){
  if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
    document.getElementById("ajaxify").innerHTML = xmlhttp.responseText;
  }
}
function loadXmlDoc(hashtag){
  var repeat = function () {
    xmlhttp.open("POST", "demo_ajax3.php", true);
    xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xmlhttp.send("hashtag=" + hashtag);
  };
  repeat.hashtag = hashtag;
  setInterval(function() { repeat(); },10000);
} 
```

# c++ - 是否可以将整个枚举集作为参数传递？

> ID：13095921
> 
> 赞同：3
> 
> 时间：2012-10-27T00:01:50.557
> 
> 标签：c++, enums

我知道您可以将枚举的一部分用作函数的参数。我的问题是你可以使用整个枚举作为参数吗？

对于枚举：

```
enum exampleEnum {ONE,TWO,THREE} 
```

通过部分枚举，我指的是：

```
function example(exampleEnum value){}

function example(ONE); 
```

整个枚举是：

```
function example(enum value){}

function example(exampleEnum); 
```

我想我要问的是我可以像传递数组一样传递枚举。至少这是我想我要问的。

*编辑*

我想要达到的效果是在多个类和子类之间共享一个枚举，而不是在我希望使用它的每个类/子类中重新定义它。我希望传递这些值而不是使用某种形式的全局变量。

*编辑的编辑*

更具体地说...我将枚举值用作关联数组的一种形式。

```
enum attribute{STR,DEX,CON,INT,WIS,CHA};
short int charAttributes[6];

charAttributes[STR] = sumValue;
charAttributes[DEX] = sumValue;
charAttributes[CON] = sumValue;
charAttributes[INT] = sumValue;
charAttributes[WIS] = sumValue;
charAttributes[CHA] = sumValue; 
```

我想要的是传递枚举的完整名称、值以及要作为参数传递的所有内容。我想传递枚举以保留枚举名称和值以继续使用它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-27T00:17:05.613

exampleEnum 是一个类型，而不是一个值。将类型传递给函数的 C++ 方法是使用模板：

```
#include <iostream>
#include <ostream>
#include <typeinfo>
using namespace std;

enum exampleEnum {ONE,TWO,THREE};

template<typename T>
void example()
{
    cout << typeid(T).name() << endl;
}

int main()
{
    example<exampleEnum>();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T00:13:48.050

如果您正确构造枚举值，则可以将值与按`|`位`or`运算符组合。

```
enum exampleEnum {One=0x01, TWO=0x02, THREE=0x04, FOUR=0x08}; // one bit set in each

example(ONE | TWO | FOUR); 
```

在您的函数中，您需要单独测试每个值：

```
if (value & ONE) // ONE was passed
if (value & TWO) // TWO was passed, etc. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-27T00:18:35.130

如果您的枚举是连续的（或者，如果您从未在枚举的定义中使用 =），那么有一个简单的技巧就是遍历枚举。

从这个开始：

```
enum /*class*/ Bob // class optional
{
  BeginBob,
  ONE = BeginBob, // the first entry needs an = Begin clause.
  TWO,
  THREE,
  EndBob
}; 
```

现在，您可以以与传递迭代器范围类似的方式传递一系列枚举值。

```
void doWork( Bob b );
void doWork( Bob begin, Bob end )
{
  for (Bob i = begin; i != end; i=ststic_cast<Bob>(i+1) )
    doWork( i );
} 
```

开始和结束枚举值描述了一个半开范围，就像迭代器一样。因此，您可以像这样在整个枚举范围内调用 doWork：

```
void doWork( BeginBob, EndBob ); 
```

或者，您可以在所有内容上调用它，但不包括这样的三个：

```
void doWork( BeginBob, THREE ); 
```

它在 ONE 和 TWO 上调用 doWork。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-27T02:31:21.437

> 我想要达到的效果是在多个类和子类之间共享一个枚举，而不是在我希望使用它的每个类/子类中重新定义它。我希望传递这些值而不是使用某种形式的全局变量。

嗯，你不必重新定义它。只需将枚举定义放在这些类之外。当你想在某个类中使用枚举值时，只需在该枚举中包含标题。

```
enum exampleEnum {ONE,TWO,THREE};

class Class1
{
   void foo()
   {
       exampleEnum t=TWO; // use enum values here
   }
};

class Class2
{
   void bar()
   {
       exampleEnum t=ONE; // and here
   }
};

class Class3
{
   void some()
   {
       exampleEnum t=THREE; // and even here
   }
}; 
```

**编辑：**

> 通过这样做，我将在我的类中添加一个我试图避免的依赖项。最好给班级一些东西，然后让班级接受一些东西。虽然我不能完全摆脱依赖，但我希望我能做到。

在这种情况下，您可以使用模板：

```
enum exampleEnum {ONE,TWO,THREE};
enum exampleEnumOther {RAZ,DVA,TRI};

template<typename Enum>
class Class1
{
   Enum member;
public:
   void foo(Enum p)
   {
       member=p;
   }
   template<typename OtherEnum>
   void bar(OtherEnum val)
   {
        OtherEnum use=val;
   }
};

int main()
{
    Class1<exampleEnum> t;
    t.foo(ONE);
    t.bar(TWO);
    t.bar(RAZ);
} 
```

Class1 不依赖于任何特定的枚举。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-27T00:17:46.293

您可以`template <typename T> example`在几个不同的枚举上制作和专门化它，允许您`example(ONE)`调用特定于`exampleEnum`然后的代码（假设`enum otherEnum { EINS, ZWEI, DREI }`您可以调用`example(EINS)`以获取特定于`otherEnum`.

# iphone - 更改视图后 UIMenuController 未出现

> ID：13095923
> 
> 赞同：0
> 
> 时间：2012-10-27T00:02:18.000
> 
> 标签：iphone, ios, uimenucontroller

我有一个 UIMenuController，它在点击 UIView 时出现。我已经实现了 canPerformAction 和 canBecomeFirstResponder 方法，它在第一次加载视图时工作。该应用程序由选项卡视图导航，如果用户要切换到另一个视图然后返回到第一个视图（尽管如果从第一个视图呈现模态视图也会出现同样的问题），UIMenuController 将不再显示. 关于为什么会这样的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:14:21.057

我刚刚得出了答案：我必须在我的视图上手动调用 becomeFirstResponder 才能使其工作。

# algorithm - 遍历大型词典的最佳方法是什么？

> ID：13095924
> 
> 赞同：0
> 
> 时间：2012-10-27T00:02:31.777
> 
> 标签：algorithm

假设我正在寻找一个可能在或不在 95k 单词的字典中的单词 - 我无法使用单词长度来促进搜索。我的问题是关于在不进行 O(n) 查找的情况下找到单词的最快方法。

以下是我的两个想法：

首先，将单词存储在一个 hast 表中，查找单词是 O(1)，这似乎是我认为最好的方案，但也有人建议使用 Trie 浏览不同的网站，我对此的问题是*它是否实用有一个包含这么多单词的 Trie。* 在这种情况下，查找将是 O(k)。

那么在大字典中查找单词的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:13:05.677

最优性取决于您的用例——您关心查找时间还是空间？（另外，你关心插入新词吗？）。

您可以在时间上做的最好的事情是使用哈希表，但对于字典来说，它的空间效率很低。trie 压缩了空间要求，因为它存储前缀，而不是整个单词，但查找时间更长。因此，要回答您的问题，使用包含大量单词的 trie 比哈希表更节省空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T01:56:01.097

如果您只是搜索一个单词，那么设置哈希表或树结构的成本将超过线性搜索。当这些结构的成本在（非常）许多用途中摊销时，这些结构变得（非常）有效。

如果字典已排序（为什么字典不排序？），那么您可以`log(n)`通过对文件进行二进制搜索及时查找单个单词，而无需额外的结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-27T02:45:33.320

我认为在字典中查找单词的最佳方法是 B+ 树。让我解释一下原因。

假设您有一个由 10 个字符串组成的根块。块中的字符串已排序。这 10 个字符串后跟一个指向另一个 10 个字符串单元格的指针，然后就是一个。所以您唯一要做的就是字符串比较你的关键字从第一个开始，直到你找到一个比较小的单词（StringCompare）。

如果我们以每个字符串旁边都有一个指针为标准，该指针显示一个单元格中的单词比较小，那么您将需要 5 步和 5 次比较才能结束可能或可能的最终数据括号不包含您的关键字。

在 5 次比较 + 最后括号中的比较中，您正在搜索 10*10*10*10*10 单词的字典。

该算法是对数速度 Log 100000，以单元格中的字符串数为基础。如果每个单元格有 10 个单词，则需要 5 个步骤。

我必须提到，只有树的根必须存储在 RAM 内存中。所有其他块都可以存储在硬盘中，而不会因为几个步骤而显着降低性能。

希望我解释正确 :D 至少我试过了！玩得开心

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T08:17:17.927

Trie 更可取，因为这种数据结构可以比哈希表更快。哈希表`O(1)`仅在理想情况下，在现实世界的应用程序中可能会发生冲突。不同类型的 trie 数据结构不受此影响。

另一种情况是压缩。Trie 比哈希表更紧凑。哈希表需要一些空间来进行高效的插入操作。如果哈希表的负载因子接近 100%，则插入操作需要很长时间。

使用哈希表，您必须将您的密钥与字典中的至少一个密钥进行比较，在这种情况下，密钥比较需要`O(k)`密钥长度为 k。使用 trie 您正在做同样的事情，您的查找操作是`O(k)`.

尝试允许有序遍历、哈希表——不要。

那里有许多类型的尝试，例如三元搜索尝试在这种特殊情况下非常好。与常规哈希表相比，数组映射的 trie 也非常快。

# .htaccess - 多部分 htaccess 重定向

> ID：13095934
> 
> 赞同：0
> 
> 时间：2012-10-27T00:04:06.707
> 
> 标签：.htaccess, redirect, http-redirect

嘿伙计们，我在让我的 htaccess 正确重定向时遇到了一些麻烦，希望能得到一些帮助。

我期待`DEV-domain.com?CampID=AB12345`重定向到 `http://DEV-www.domain.com/landing/external-marketing/direct-mail/AB?CampId=AB12345`

```
RewriteCond %{HTTP_HOST} ^DEV-(www\.)?domain\.com [NC]
RewriteCond %{QUERY_STRING} ^CampID=
RewriteRule (\w{2})(\w{5})$ http://DEV-www\.domain\.com/landing/external-marketing/direct-mail/$1?CampId=$1$2 [R=301,L] 
```

不幸的是，由于某种原因我无法让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:35:22.263

因为 RewriteRule 匹配用于 url 路径，而不是查询字符串。试试这个：

```
RewriteCond %{HTTP_HOST} ^DEV-(www\.)?domain\.com [NC]
RewriteCond %{QUERY_STRING} ^CampID=(\w{2})(\w{5})
RewriteRule .* http://DEV-www.domain.com/landing/external-marketing/direct-mail/%1?CampId=%1%2 [R=301,L] 
```

您也不需要`.`在目标网址中转义点，只需在匹配模式中。请注意，如果您决定使用目标 url`CampID`而不是`CampId`，则需要设置另一个条件：

```
RewriteCond %{REQUEST_URI} !^/landing/external-marketing/direct-mail/ 
```

避免无限重定向作为目标`CampID`将匹配您的 RewriteCond 规则...

# algorithm - 有人可以向我解释反向传播算法吗？

> ID：13095938
> 
> 赞同：10
> 
> 时间：2012-10-27T00:04:20.187
> 
> 标签：algorithm, neural-network, backpropagation

我最近在 Coursera 上完成了 Ng 教授的机器学习课程，虽然我喜欢整个课程，但我从来没有真正理解过用于训练神经网络的反向传播算法。

我理解它的问题是，他只教过它的矢量化实现，用于完全连接的前馈网络。我的线性代数生疏了，如果有人能教我通用算法，我认为会更容易理解。也许以面向节点的方式。

我将尝试简单地表述问题，但我可能误解了反向传播的工作原理，所以如果这没有意义，请忽略它：

对于任何给定的节点 N，给定输入权重/值、输出权重/值以及 N 输出到的所有节点的错误/成本，我如何计算 N 的“成本”并使用它来更新输入重量？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-04T17:28:57.857

让我们考虑一个反向传播 (BP) 网络中的节点。它有多个输入，并产生一个输出值。我们希望使用纠错进行训练，因此它还将根据节点的错误估计更新权重。

每个节点都有一个偏差值 θ。您可以将其视为对内部恒定 1.0 值输入的权重。

激活是加权输入和偏差值的总和。让我们将我们感兴趣的节点称为 j，前一层的节点的值为 i，而后一层的节点的值为 k。我们的节点 j 的激活是：

> 净[j] = ∑<sub>i (o [i] × w [ij] ) + θ [j]

也就是说，j 的激活值是节点 i 的输出与连接节点 i 和 j 的相应权重的乘积之和，再加上偏差值。

我们节点 j 的输出是激活的传递函数：

> o [j] = f(净[j] )

f 通常是 sigmoid 函数。

> f(净[j] ) = 1 / (1 + e -^(净[j]) )

sigmoid 函数有一个易于指定的一阶导数：

> f'(净[j] ) = f(净[j] ) × (1.0 - f(净[j] ))

无论我们使用什么传递函数，我们都需要知道如何计算它的一阶导数。BP 通过链式法则通过梯度下降工作，所以这很重要。上面的方程会随着不同的传递函数而不同。

到目前为止，我们知道如何获取输入值、计算激活、计算输出以及计算激活的一阶导数。现在我们需要处理错误和权重调整。

BP 中用于节点误差估计的值称为 δ。节点的 δ 与节点激活的一阶导数和它接收的误差项成正比。接收到的误差项有两种公式，一种用于输出节点，一种用于隐藏节点。

一般来说，

> δ = f'(net) × (接收误差)

对于输出节点，

> δ[输出]= f'(net) × (t - o)

其中 t 是该输出节点的期望值，o 是该输出节点的实际输出值。

对于我们的隐藏节点 j，它是这样的：

> δ [j] = f'(net [j] ) × ∑<sub>k (δ [k] × w [jk] )

我们节点 j 的 δ δ [j]是给定激活函数的传递函数的一阶导数乘以下一层（更接近输出）中的增量之和乘以连接权重的值的乘积。有了这个，我们可以计算如何调整前一层节点（更接近输入）的权重。

> dw [ij] = L × o [i] × δ [j]

这里的 dw 代表“权重变化”，所以方程的意思是，从节点 i 到我们的节点 j 的权重变化等于学习参数 L 的乘积（通常网络中所有节点的值相同） ，节点 i 的输出值，以及节点 j 的 δ（误差项）。

调整偏差值类似于调整权重。

> dθ [j] = L × f(θ [j] ) × δ [j]

这里的dθ表示“θ的变化”。我们必须将传递函数应用于偏置值 θ [j]以获得类似于节点输出的术语。否则，它看起来就像另一个等式。

我应该注意，计算权重变化应该在整个网络范围内完成，然后在计算完所有这些变化后应用这些变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-03T02:06:38.403

> 对于任何给定的节点 N，给定输入权重/值、输出权重/值以及 N 输出到的所有节点的错误/成本，我如何计算 N 的“成本”并使用它来更新输入重量？

你永远不会真正对单个神经元的中间成本函数感兴趣。相反，您对最终产出的成本感兴趣；总是。然后用它来将后面层中的神经元所需的变化率一直传播到前面。

# linux - 将 ELF 共享库和自定义 binfmt 可执行文件加载到相同的 Linux 地址空间

> ID：13095941
> 
> 赞同：3
> 
> 时间：2012-10-27T00:04:48.513
> 
> 标签：linux, memory-management, process, shared-libraries, elf

我正在开发一个项目，以在 Linux 平台上加载和运行自定义二进制格式的可执行文件（在我的例子中是 PE）。到目前为止，我已经非常成功地完成了这项工作，首先加载可执行文件，然后加载一个小型 ELF 共享库，该库调用可执行文件的起始地址，然后安全退出。

不过，出于几个原因，我真的不想自己加载 ELF。首先，我使用的共享库是用汇编编写的（我不能使用其他任何东西，因为我没有链接到`libc`等），这将是非常特定于平台的，我想摆脱它并且使用 C，所以我可以为任何平台编译。此外，使用 Linux 的本机 ELF 加载程序而不是我自己的简化版本会更容易、更安全。

我想知道是否有一种方法可以使用我的 binfmt 处理程序（一个已安装的内核模块）来加载我的可执行文件，*然后*要求 Linux 将我的共享库（及其依赖项）加载到相同的地址空间而不覆盖我的可执行代码。我首先认为`uselib`系统调用可能有用，但手册页上的描述不清楚这是否符合我的目的：

> 从 libc 4.4.4 开始，仅加载库“/lib/ld.so”，以便此动态库可以加载所需的其余库（再次使用此调用）。这也是 libc5 的现状。
> 
> glibc2 不使用这个调用。

我也从未见过使用它的例子，而且我总是对使用我不理解的系统调用保持警惕。

有没有实现我所描述的好方法？我是否可以使用 Linux 的现有功能将共享库（用 C 编写）加载到已经包含可执行代码的地址空间中，如果可以，我如何在不知道加载位置的情况下使用该库？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-03T05:09:49.210

已经有一个像这样的项目，叫做 binfmt_pe（由我！），它是一个内核模块，将有它自己的链接器（类似于 /lib/ld）。 [在这里查看](https://sourceforge.net/projects/binfmtpe/)。

至于你关于制作模块和加载器/链接器的问题，下面有链接。我还包含有关 ELF 和 PE 可执行文件的信息的链接。

我希望这有帮助。:)

**制作 Linux 内核模块的有用信息**

*   [Linux 内核模块编程指南](http://www.tldp.org/LDP/lkmpg/2.6/html/index.html)
*   [编写自己的可加载内核模块](http://tldp.org/HOWTO/Module-HOWTO/x839.html)
*   [Linux 数据结构](http://tldp.org/LDP/tlk/ds/ds.html)
*   [Linux 内核：内核源代码](http://www.win.tue.nl/~aeb/linux/lk/lk-2.html)
*   [对各种二进制格式的内核支持](http://www.kernel.org/doc/Documentation/binfmt_misc.txt)
*   [binfmt_elf.c](http://lxr.linux.no/linux+v2.6.33/fs/binfmt_elf.c)
*   [binfmt_misc.c](http://stuff.mit.edu/afs/sipb/contrib/linux/fs/binfmt_misc.c)

**关于动态加载/链接的信息**

*   [了解 ld-linux.so.2](http://www.cs.virginia.edu/~dww4s/articles/ld_linux.html)
*   [ld.so ：动态链接库支持](http://cs.nyu.edu/~xiaojian/bookmark/linux/ld_so%20%20Dynamic-Link%20Library%20support.htm)
*   [如何编写共享库 - PDF](http://www.akkadia.org/drepper/dsohowto.pdf)
*   [ld-linux(8) - Linux 手册页](http://linux.die.net/man/8/ld-linux)
*   [路径](http://en.wikipedia.org/wiki/Rpath)
*   [列出共享库依赖项](http://books.google.com/books?id=wOGUuoHUyAEC&pg=PA169&dq=linux%20ld%20lib&ei=bw7lUJeNJYa7UeiYgMgO&cd=1)

**关于 ELF 和 PE 格式的信息**

*   [OSRC：可执行文件格式](http://www.nondot.org/sabre/os/articles/ExecutableFileFormats/)
*   [可执行文件格式](http://www.delorie.com/djgpp/doc/exe/)
*   [Windows NT 如何识别基于 MS-DOS 的应用程序](http://support.microsoft.com/default.aspx?scid=kb;en-us;102057)
*   [通用对象文件格式 (COFF)](http://support.microsoft.com/kb/121460)
*   [窥视 PE：Win32 可移植可执行文件格式之旅](http://msdn.microsoft.com/en-us/library/ms809762.aspx)
*   [可执行和可链接格式](http://en.wikipedia.org/wiki/Executable_and_Linkable_Format)
*   [深入了解 Win32 可移植可执行文件格式](http://msdn.microsoft.com/en-us/magazine/cc301805.aspx)
*   [深入了解 Win32 可移植可执行文件格式，第 2 部分](http://msdn.microsoft.com/en-us/magazine/cc301808.aspx)
*   [导入表中的内射代码](http://www.ntcore.com/files/inject2it.htm)
*   [PE 格式 | 黑客图书馆](http://www.thehackerslibrary.com/?p=377)
*   [IMAGE_NT_HEADERS 结构（Windows）](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680336%28v=vs.85%29.aspx)
*   [x86 反汇编/Windows 可执行文件](http://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files)
*   [Windows 上的可移植可执行格式](http://code.google.com/p/corkami/wiki/PE)

# android - 安卓服务网络连接

> ID：13095942
> 
> 赞同：-1
> 
> 时间：2012-10-27T00:04:55.607
> 
> 标签：android, service, inputstream

在我的应用程序中，我有一个用于从服务器获取数据的类。它适用于`Activity`我所做的每一个工作，但这次我想在`Service`子类中使用它，这对我来说是 100% 新的（服务）。

我在这一行中发现了一个问题：

```
InputStream inputStream = urlConnection.getInputStream(); 
```

这是我的网络课程触发异常的地方：

```
android.os.NetworkOnMainThreadException 
```

在活动和服务中使用它有什么主要区别吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:49:20.993

该错误`android.os.NetworkOnMainThreadException`意味着您正在主线程“UI Thread”上运行面向网络的任务。Android 现在禁止这样做，因为它会在网络调用期间呈现 UI 无响应。

要解决这个问题，您需要在另一个线程中进行网络调用。[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)非常适合这个。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-27T00:48:08.660

好的，我想通了，[这](https://stackoverflow.com/questions/6343166/android-os-networkonmainthreadexception?answertab=active#tab-top)就是问题所在。我在我的中使用了 AsyncTask，`Service`它现在运行良好。

# internet-explorer - GAE 从 blobstore 下载文件扩展名

> ID：13095944
> 
> 赞同：5
> 
> 时间：2012-10-27T00:05:10.560
> 
> 标签：internet-explorer, google-app-engine, google-chrome, http-headers, blobstore

我目前在 GAE Blobstore 中存储了一堆 .docx 文件。我最近注意到这些文件在某些​​计算机（Windows 7 的 IE 9）上没有文件扩展名的情况下下载，但在其他计算机（IE 8、Windows 7 的 Chrome）上运行良好。

以下是文件在 blobstore 中的存储方式：

```
f = files.blobstore.create(mime_type='application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                           _blobinfo_uploaded_filename=filename)
## then some code to write data and save ## 
```

这是来自 Chrome 检查器的文件的响应标头：

```
Cache-Control:no-cache
Content-Disposition:attachment; filename="causes_of_ww1_emanresu"
Content-Length:12120
Content-Type:application/vnd.openxmlformats-officedocument.wordprocessingml.document
Date:Fri, 26 Oct 2012 23:54:09 GMT
Server:Google Frontend
X-AppEngine-Estimated-CPM-US-Dollars:$0.000033
X-AppEngine-Resource-Usage:ms=15 cpu_ms=0 
```

这是我为 blob 提供服务的方式：

```
self.send_blob(blob_info, save_as=blob_info.filename, content_type=blob_info.content_type) 
```

我什`content_type='application/vnd.openxmlformats-officedocument.wordprocessingml.document'`至尝试硬编码无济于事。

关于发生了什么以及如何解决它的任何想法？

* * *

根据要求，这是我在最初保存 blob 时获取文件信息的方式。我很确定这个级别没有发生错误，但这是问题的前兆：

```
# get the file from a file_url with urlfetch
result = urlfetch.fetch(file_url)
headers = result.headers

# some custom functions to return a filename
username = self.get_username()
filename = get_filename(title, username)

# write the file to blobstore
f = files.blobstore.create(mime_type=headers['content-type'], 
                           _blobinfo_uploaded_filename=filename)
with files.open(f, 'a') as data:
    data.write(result.content)
files.finalize(f)
blob_key = files.blobstore.get_blob_key(f) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T19:42:11.247

啊，根据顶部的评论，解决方案是将文件扩展名添加到 BlobInfo 中的文件名属性中。我最初并没有意识到这是必要的，因为 Chrome 在下载时自动添加了文件扩展名。

# xml - 使用 powershell 更新 xml 元素

> ID：13095945
> 
> 赞同：2
> 
> 时间：2012-10-27T00:05:28.123
> 
> 标签：xml, xslt, powershell

我有一个 XSL 文件，它充当我的应用程序的配置文件。事实上，它是一个 XML 文件，其中包含`<xsl:Stylesheet>`围绕它的元素。这个文件叫做 `Config.xsl`：

```
 <?xml version="1.0" encoding="UTF-8"?>
     <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"           xmlns="http://www.example.org/Config">
     <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"               standalone="yes" />
     <xsl:template match="/">
     <Config>
          <Test>somevalue</Test>
          <Test1>someothervalue</Test1>
     </Config>
     </xsl:template>
</xsl:stylesheet> 
```

现在我想更改动态传递的元素的值。意思是，我有另一个 XML 文件，其中包含 XPATH 和作为键名/值对的值。下面是 XML 文件的内容`Properties.xml`。

```
<?xml version="1.0" encoding="utf-8" ?>
<ConfigFiles>
<ConfigFile>
    <FileName>Config.xsl</FileName>
    <Keys>
        <Key Name="Config.Test" Value="newvalue" />
        <Key Name="Config.Test1" Value="newvalue1" />
    </Keys>
</ConfigFile>   
</ConfigFiles> 
```

下面是我的 powershell 代码，它不更新元素的值。

```
$properties = [xml] (Get-Content Properties.xml)
$lstfiles = $properties.ConfigFiles.ConfigFile
foreach($file in $lstfiles)
{
  $configfilename = $file.FileName
  $filename = "C:\configs\configfilename"
  $testconfigfile = [xml] (Get-Content $filename)

  $lstKeys = $file.Keys.Key
  foreach($key in $lstKeys)
  {
    #When I debug the code, I was able to assign the value using the below code (Commented). However this is not dynamic
    #$testconfigfile.DocumentElement.LastChild.Config.Test = "newvalue"

    #Now if I try to pass the same values dynamically by reading them from properties.xml and assigning it using the below code it does not work
    $testconfigfile.DocumentElement.LastChild.$key.Name = $key.Value            
  }
  $testconfigfile.Save($filename)               
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T23:51:23.207

这应该适合你。将 properties.xml 更改为

```
<?xml version="1.0" encoding="utf-8" ?>
<ConfigFiles>
<ConfigFile>
    <FileName>Config.xsl</FileName>
    <Keys>
        <Key Name="Test" Value="newvalue" />
        <Key Name="Test1" Value="newvalue1" />
    </Keys>
</ConfigFile>   
</ConfigFiles> 
```

并在您的 shell 脚本中尝试以下行，

```
$testconfigfile.DocumentElement.LastChild.Config.($key.Name) = $key.Value 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T23:56:40.147

```
Alternatively...

<?xml version="1.0" encoding="utf-8" ?>
<ConfigFiles>
<ConfigFile>
    <FileName>Config.xsl</FileName>
    <Keys>
        <Key Name1="Config"  Name2='Test' Value="newvalue" />
        <Key Name1="Config"  Name2='Test1' Value="newvalue1" />
    </Keys>
</ConfigFile>   
</ConfigFiles>

$testconfigfile.DocumentElement.LastChild.($key.Name1).($key.Name2) = $key.Value 
```

# javascript - 从方法名称数组中定义循环中的方法

> ID：13095948
> 
> 赞同：1
> 
> 时间：2012-10-27T00:05:48.400
> 
> 标签：javascript

我想从一组方法名称中定义几个方法，如下所示：

```
var methodNames = ['foo', 'bar', 'baz'],
    randomObject = {}, method;

for( var i = methodNames.length - 1; i >= 0; --i ){
  method = methodNames[ i ];

  randomObject[ method ] = function(){
    console.log( method );
  }
} 
```

这样我就得到了一个 object `randomObject`，它定义了所有方法，做着完全相同的事情。问题是，每个方法都记录“foo”而不是被调用方法的名称。`method`调用方法时如何使变量保持不变？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-27T00:11:42.977

我不知道这是否是使用闭包的**最佳**方式，但我认为这是有效的......

更新：

[http://jsfiddle.net/ZDrCK/1/](http://jsfiddle.net/ZDrCK/1/)

```
var methodNames = ['foo', 'bar', 'baz'],
    randomObject = {},
    method;

for (var i = methodNames.length - 1; i >= 0; --i) {
    method = methodNames[i];

    randomObject[method] = (function(met){
        return function () {
            console.log(met);
        }
    })(method);
}

randomObject.baz();
randomObject.bar();
randomObject.foo(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T00:07:56.003

您应该将其包装在一个自动执行的闭包中：

```
for (var i = methodNames.length - 1; i >= 0; --i) {
    (function(method) {
        randomObject[method] = function() {
            console.log(method);
        };
    })(methodNames[i]);
}​ 
```

# ruby-on-rails - Carrierwave yml 夹具上传文件

> ID：13095955
> 
> 赞同：2
> 
> 时间：2012-10-27T00:06:02.213
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, carrierwave

我有载波设置。它的工作没有任何问题。现在，下面是 deal_images 固定装置：

```
d1_image1:
  image: app_images/img1.png
  usage_tag: thumbnail
  deal: first_deal
d1_image2:
  image: app_images/img2.png
  usage_tag: thumbnail
  deal: second_deal 
```

现在，它所做的只是在图像中输入字符串，而 image.url 并没有指向任何地方。`rake db:fixtures:load`当我遇到上传目录时，我想使用 app_image/img1.png 中的图像来上传。

这是正确的做法吗？

# javascript - Google Maps v3 markerclusterer InfoWindow 数据

> ID：13095962
> 
> 赞同：3
> 
> 时间：2012-10-27T00:06:42.143
> 
> 标签：javascript, google-maps, maps, infowindow, markerclusterer

我有一个使用markerclusterer的数据库驱动的谷歌地图v3，一切正常，但我想显示额外的数据，而不是仅仅能够显示来自数据库的一个直接结果（如ID或名称等）。在使用markerclusterer 到具有超链接的级别之前，我已经让它工作了，并且希望获得类似的结果。

我目前拥有的代码是

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<script src="JS/markerclusterer.js" type="text/javascript"></script>

<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?   sensor=false"></script>

 </head>
 <body onload="load()" onunload="GUnload()">
 <div id="body">

<script type="text/javascript">
//<![CDATA[

var customIcons = {
  restaurant: {
    icon: 'http://labs.google.com/ridefinder/images/mm_20_blue.png',
    shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
  },
  bar: {
    icon: 'http://labs.google.com/ridefinder/images/mm_20_red.png',
    shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
  }
};

function load() {
  var cluster = [];
  var map = new google.maps.Map(document.getElementById("map"), {
    center: new google.maps.LatLng(53.4788, -3.9551),
    zoom: 6,
    mapTypeId: 'roadmap'
  });
var infowindow = new google.maps.InfoWindow();
var min = .999999;
var max = 1.000001;

  // Change this depending on the name of your PHP file
  downloadUrl("gmapxml.php ", function(data) {
    var xml = data.responseXML;
    var markers = xml.documentElement.getElementsByTagName("marker");
    for (var i = 0; i < markers.length; i++) {
      var name = markers[i].getAttribute("name");
      var address = markers[i].getAttribute("id");
      var type = markers[i].getAttribute("town");

      var point = new google.maps.LatLng(
          parseFloat(markers[i].getAttribute("lat")),
          parseFloat(markers[i].getAttribute("longitude")));
      var html = "<a href = 'profile.php?id="+address+"'>Visit "+ name +" </a></br><b>"+type;
      var icon = customIcons[type] || {};
      var marker = new google.maps.Marker({
        map: map,
        position: point,
        icon: icon.icon,
        shadow: icon.shadow
      });
      google.maps.event.addListener(marker, 'click', (function(marker, i) {
                    return function() {
                          infowindow.setContent(markers[i].getAttribute("id"));
                        infowindow.open(map, marker);
                    }
                })(marker, i));
      cluster.push(marker);
    }
    var mc = new MarkerClusterer(map,cluster);
  });
}

function bindInfoWindow(marker, map, infoWindow, html) {
  google.maps.event.addListener(marker, 'click', function() {
    infoWindow.setContent(html);
    infoWindow.open(map, marker);
  });
}

function downloadUrl(url, callback) {
  var request = window.ActiveXObject ?
      new ActiveXObject('Microsoft.XMLHTTP') :
      new XMLHttpRequest;

  request.onreadystatechange = function() {
    if (request.readyState == 4) {
      request.onreadystatechange = doNothing;
      callback(request, request.status);
    }
  };

  request.open('GET', url, true);
  request.send(null);
}

function doNothing() {}

//]]>
</script>

    <div id="map" style="width: 800px; height: 600px"></div>
</div>

</div>
</body></html> 
```

任何帮助将非常感激。

# ruby - erb 习惯用法来处理未定义的变量

> ID：13095963
> 
> 赞同：3
> 
> 时间：2012-10-27T00:06:45.350
> 
> 标签：ruby, erb

我正在尝试编写一些 puppet .erb，如果它是，我想处理这个“环境”变量：

*   不明确的
*   带有换行符的字符串
*   数组。

我已经做到了：

```
<% Array(environment).join("\n").split(%r{\n}).each do |f| %>
one line: <%= f %>
<% end %> 
```

但是还没有解决未定义的情况。我试过这个

```
<% if (defined?(environment)).nil? %?
<% Array(environment).join("\n").split(%r{\n}).each do |f| %>
one line: <%= f %>
<% end %>
<% end %> 
```

但是当尝试像这样测试它时，我仍然得到“（erb）：11：未定义的局部变量或方法`environment' for main：Object（NameError）”：

```
ruby -rerb -e "environmentUNDEFINEME= [ 'cronvar=cronval', 'var2=val2' ]; 
puts ERB.new(File.read('templates/job.erb')).result" 
```

抱歉，这太基本了，但有人必须问一些简单的问题。有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T00:13:21.183

我会这样做：

```
<% if defined?(environment) %>
  <% Array(environment).each do |f| %>
  one line: <%= f %>
  <% end %>
<% end %> 
```

我不明白你为什么要加入新线路然后再次拆分它们，所以我从示例中删除了它。

# vbscript - Windows 8 不喜欢的这段代码有什么问题，但 Windows 7 运行良好？

> ID：13095965
> 
> 赞同：0
> 
> 时间：2012-10-27T00:06:57.603
> 
> 标签：vbscript, windows-8

在第 59 行，字符 1 上出现错误......“接口未知”

目的是弹出一个简单的用户输入框并将结果捕获到一个变量中，然后到一个文本文件中，以便第 3 方应用程序可以读取它。我不太擅长编写 VBS，但我在 Windows 7 中完美地完成了这项工作。

我也想让这个（VBscript）在 Windows 8 中工作。但我不想学习如何用另一种语言编写脚本或编码。我不想用 Javascript 或 .NET 或其他方式重写整个内容。

请让我知道 Windows 8 与 Windows 7 sp1 的不同之处。谢谢。

```
'=======================[ ASK Password ]========================================'
Option Explicit
Dim strUserID, strPassword

AskPassword

Sub AskPassword()
Dim htmlPwdCode, objCodeFile, objFileSysObj, objBrowser, strButton
Const FOR_WRITING = 2

Set objFileSysObj = CreateObject("Scripting.FileSystemObject")

htmlPwdCode = "<SCRIPT LANGUAGE=" & Chr(34) & "VBScript" & Chr(34) & ">" & Chr(13) & _
"Sub RunScript" & Chr(13) & _
"    OKClicked.Value = " & Chr(34) & "OK"& Chr(34) & Chr(13) & _
"End Sub" & Chr(13) & _
"Sub CancelScript" & Chr(13) & _
"    OKClicked.Value = " & Chr(34) & "Cancelled" & Chr(34) & Chr(13) & _
"End Sub" & Chr(13) & _
"Sub Default_Buttons" & Chr(13) & _
"   If Window.Event.KeyCode = 13 Then" & Chr(13) & _
"       btnOK.Click" & Chr(13) & _
"   End If" & Chr(13) & _
"End Sub" & Chr(13) & _
"</SCRIPT>" & Chr(13) & _
"<BODY onkeypress='vbs:Default_Buttons'><center><font size=" & Chr(34) & "2" & Chr(34) & " face=" & Chr(34) & "Arial" & Chr(34) & ">" & Chr(13) & _
"User name:&nbsp;&nbsp;&nbsp;" & Chr(13) & _
"<input type=" & Chr(34) & "text" & Chr(34) & " name=" & Chr(34) & "UserName" & Chr(34) & " size=" & Chr(34) & "30" & Chr(34) & "><br>" & Chr(13) & _
"Password :&nbsp;&nbsp;&nbsp; </font><font face=" & Chr(34) & "Arial" & Chr(34) & ">" & Chr(13) & _
"<input type=" & Chr(34) & "password" & Chr(34) & " name=" & Chr(34) & "UserPassword" & Chr(34) & _
" size=" & Chr(34) & "30" & Chr(34) & "></font></p>" & Chr(13) & _
"<input type=" & Chr(34) & "hidden" & Chr(34) & " name=" & Chr(34) & "OKClicked" & Chr(34) & " size = " & Chr(34) & "20" & Chr(34) & ">" & Chr(13) & _
"<input id=" & Chr(34) & "btnOK" & Chr(34) & " class=" & Chr(34) & "button" & Chr(34) & _
" type=" & Chr(34) & "button" & Chr(34) & " value=" & Chr(34) & " OK " & Chr(34) & _
" name=" & Chr(34) & "ok_button" & Chr(34) & " onClick=" & Chr(34) & "RunScript" & Chr(34) & ">" & Chr(13) & _
"<input id=" & Chr(34) & "btnCancel" & Chr(34) & " class=" & Chr(34) & "button" & Chr(34) & _
" type=" & Chr(34) & "button" & Chr(34) & " value=" & Chr(34) & "Cancel" & Chr(34) & _
" name=" & Chr(34) & "cancel_button" & Chr(34) & " onClick=" & Chr(34) & "CancelScript" & Chr(34) & "></center></BODY>"

Set objCodeFile = objFileSysObj.CreateTextFile("LoginPrompt.html", True)
objCodeFile.Write htmlPwdCode
objCodeFile.Close
Set objCodeFile = Nothing

Set objBrowser = CreateObject("InternetExplorer.Application")

With objBrowser
    .Height = 200
    .Width = 400
    .Top = 200
    .Left = 300
    .StatusBar = True
    .Toolbar = False
    .Resizable = False
    .Navigate CreateObject("Scripting.FileSystemObject").GetParentFolderName(Wscript.ScriptFullName) & "\LoginPrompt.html"
    .Visible = True
End With

Do Until objBrowser.ReadyState = 4
'wait till page loads'
Loop

Do While objBrowser.Document.Body.All.OKClicked.Value = ""
    Wscript.Sleep 50                 
Loop 

strUserID = objBrowser.Document.Body.All.UserName.Value
strPassword = objBrowser.Document.Body.All.UserPassword.Value
strButton = objBrowser.Document.Body.All.OKClicked.Value

'''''''''''''''''''''''
Dim objFSO, strFile, objFile

Const ForWriting = 2
Const OpenAsASCII = 0
Const CreateIfNotExist = True

' Specify output file.
strFile = "C:\TEMP\MEX\UN.txt"

' Open the file.
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.OpenTextFile(strFile, _
ForWriting, CreateIfNotExist, OpenAsASCII)

' write to file.
objFile.WriteLine strUserID

' Clean up.
objFile.Close
'''''''''''''''''''''''''''

Dim objFSO2, strFile2, objFile2

Const ForWriting2 = 2
Const OpenAsASCII2 = 0
Const CreateIfNotExist2 = True

' Specify output file.
strFile2 = "C:\TEMP\MEX\PW.txt"

' Open the file.
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objFile2 = objFSO2.OpenTextFile(strFile2, _
ForWriting2, CreateIfNotExist2, OpenAsASCII2)

' write to file.
objFile2.WriteLine strPassword

' Clean up.
objFile2.Close
'''''''''''''''''''''''''''

objBrowser.Quit

If strButton = "Cancelled" Then
    MsgBox "Operation cancelled, script will now exit!"
    Wscript.Quit
Else
    'Credentials accepted for further processing
End If
objFileSysObj.DeleteFile "LoginPrompt.html", True

Set objBrowser = Nothing
Set objFileSysObj = Nothing
End Sub

'=======================[ GOT Password ]========================================' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T13:24:19.630

第 59 行： `Do Until objBrowser.ReadyState = 4`

根据 MSDN：[ReadyState Property Example (VBScript)](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681026%28v=vs.85%29.aspx)，问题在于“ReadyState”功能已被删除。

# iphone - UINavigationController - 在所有视图中保留背景图像

> ID：13095968
> 
> 赞同：23
> 
> 时间：2012-10-27T00:07:47.083
> 
> 标签：iphone, ios, uinavigationcontroller

有没有办法让背景图像在导航控制器的所有视图中保持不变？目前我在每个视图的`viewDidLoad`方法中加载相同的背景，但这显示了在视图之间导航时背景图像的移动。我宁愿只是背景“幻灯片”开/关屏幕前的视图内容*，*但背景保持静止。这是我当前的背景图片加载代码：

```
UIImageView *background = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 320, 460)];
background.image = [UIImage imageNamed:@"InfoBackground.png"];
[self.view addSubview:background];
[self.view sendSubviewToBack:background];
[background release]; 
```

谢谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-27T03:13:38.353

嗯，也许如果您查看[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html)（向下滚动到图 2），您将了解您正在处理的内容。因为您正在为每个被推送到 UINavigationController 的视图控制器设置背景图像，所以您将获得该动画。您需要做的是将背景图像设置到导航控制器本身。

我相信`myNavController.view insertSubview:myImageView atIndex:0`应该工作。如果您的图像需要准确地填充在内容视图后面，您可以根据导航栏和工具栏的坐标和/或高度设置框架坐标，可以通过导航控制器的属性访问。如果没有，只需将框架设置为超级视图的边界。

让我知道事情的后续。

编辑：哦，请注意，您需要确保每个视图控制器都具有透明背景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T11:01:17.233

如果你想要静态背景图像，那么只有一种方法，但我不知道这是否可能，如果我们将图像放在窗口中并使导航控制器透明，那么无论你做什么它都保持静态。因为我们在推送或弹出时不会更改窗口。

我只是建议尝试这种方式，我没有尝试过这样的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-27T03:48:27.860

我认为更好的主意是将背景图像放在窗口上并将所有视图（所有视图控制器的视图）的背景颜色设置为清除颜色**[UIColor clearColor]**。

# emacs - 如果区域不活动，则在线切换评论

> ID：13095971
> 
> 赞同：0
> 
> 时间：2012-10-27T00:08:08.490
> 
> 标签：emacs

我以此作为参考： [Emacs 注释/取消注释当前行](https://stackoverflow.com/questions/9688748/emacs-comment-uncomment-current-line/13095935#13095935)

我的问题是我是否可以使用 defadvice 执行相同的任务（这对我来说似乎更合适）？类似的东西

```
(defadvice comment-or-uncomment-region (before mark-whole-line (arg beg end) activate)
  (unless (region-active-p)
    (setq beg (line-beginning-position) end (line-end-position))))
(ad-activate 'comment-or-uncomment-region) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T14:35:52.153

这个答案是基于我上面的评论。

`defadvice`并不比另一种解决方案更合适。它永远不会比另一种解决方案更合适。

* * *

`defadvice`**当您无法以任何其他方式解决问题时，这**是最后的手段。

**时期。**

* * *

请记住，无论何时使用`defadvice`，您都在从根本上修改包开发人员所依赖的 Emacs API。

当你巧妙地改变这些行为时，当你报告“错误”时，你会给你带来很多问题，最终给包开发者带来很多问题，因为你的 Emacs API 被`defadvice`.

因此，当您想在本地更改功能时，方法是使用现有功能定义一个新命令并重新映射到它。

也就是说（根据您提到的[答案）：](https://stackoverflow.com/a/9697222/903943)

```
(defun comment-or-uncomment-region-or-line ()
    "Comments or uncomments the region or the current line if there's no active region."
    (interactive)
    (let (beg end)
        (if (region-active-p)
            (setq beg (region-beginning) end (region-end))
            (setq beg (line-beginning-position) end (line-end-position)))
        (comment-or-uncomment-region beg end)
        (next-line)))

(global-set-key [remap comment-dwim] 'comment-or-uncomment-region-or-line) 
```

# javascript - 是否可以将“setInterval”设置得太快？

> ID：13095972
> 
> 赞同：4
> 
> 时间：2012-10-27T00:08:09.463
> 
> 标签：javascript, performance, setinterval

我的 javascript 中有一个 setinterval 函数，我希望它尽可能快，即每 1 毫秒检查一次事件的状态。这是否可能对用户的浏览器提出太多要求？它似乎工作得很好，但我想知道它是否是一种不好的做法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-27T00:14:34.023

这不仅是可能的，而且很常见。就其本质而言，这是一种竞争条件。如果您依赖回调中的代码在下一个间隔之前执行，请改用递归`setTimeout`。

此外，除非您的间隔被调用，否则`lockUpBrowser`回调之间的持续时间可能太短，无法进行实际的性能处理。

```
(function myRecursiveTask() {
    // Do your task here
    myTask();

    if (!someConditionToAllowABailOut) {
        setTimeout(myRecursiveTask, 100); // 100ms loop
    }
}()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-27T00:12:06.193

`setInterval`不能保证在指定的时间间隔内精确执行。它将尽快执行，但由于 javasript 是单线程的，并且此时可能会执行一些其他代码，因此您的回调可能会延迟。

如果您使用`setInterval`1ms，那么您可能试图以错误的方式解决您的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-27T00:12:16.540

是的，如果传递给的函数引用`setInterval`的执行时间比间隔时间长，则对该函数的调用将排队并阻塞浏览器。如果您正在尝试执行动画并希望尽可能快地更改每个步骤，那么有一个[`requestAnimationFrame`](https://developer.mozilla.org/en-US/docs/DOM/window.requestAnimationFrame)功能应该用于现代浏览器。就个人而言，我从来不需要比每个`15ms`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-27T00:13:26.860

我当然会质疑这种方法的必要性。您需要每 1 毫秒检查哪些您无法每 10 毫秒、100 毫秒或每秒检查一次的内容？

您是否 100% 确定您将每次运行的检查功能将始终在 < 1 毫秒内执行，这样您就不会有多个检查进程叠加运行。

该过程需要多少内存和 CPU，您是否可能会降低用户浏览器的速度，以至于滚动等简单的操作对用户来说变得很痛苦？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T06:07:25.753

一个while循环对你来说太慢了吗？

```
while (condition)
  {
  //code block to be executed
  } 
```

我知道我不是在回答你的问题，但我认为没有更好的方法来做这样的事情......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-09T01:59:57.323

Ben Cherry 对此有一篇[很好的文章](http://www.adequatelygood.com/Minimum-Timer-Intervals-in-JavaScript.html)，他在其中测试了不同的浏览器，以了解`setInterval`在它变得不可靠之前可以多快。`setInterval`a or触发的速度`setTimout`取决于浏览器。

> 特别是，如果您正在寻找跨浏览器的一致计时器间隔，则必须使用 >15ms 的时间。

因此，如果您可以将时间设置为大于 15 毫秒，您将不会遇到问题。

# iphone - IOS社交框架和图片贴

> ID：13095977
> 
> 赞同：0
> 
> 时间：2012-10-27T00:08:50.433
> 
> 标签：iphone, objective-c, ios, uiimagepickercontroller, social-framework

我正在试验社会框架。我想知道是否有任何可能的方法可以使用我的应用程序中的此实现附加上一张拍摄并当前保存在相机胶卷中的照片：

```
 - (IBAction)shareByActivity:(id)sender {
    NSArray *activityItems;

    if (self.sharingImage != nil) {
        activityItems = @[self.sharingImage, self.sharingText, self.addURL];
    } else {
        activityItems = @[self.sharingText, self.addURL];
    }

    UIActivityViewController *activityController =
    [[UIActivityViewController alloc] initWithActivityItems:activityItems
                                      applicationActivities:nil];

    [self presentViewController:activityController
                       animated:YES completion:nil];
} 
```

如果是这样，我该如何修改我的`shareImage`特定部分中的名称`-(void)viewDidLoad`？

```
self.sharingImage = [UIImage imageNamed:@"notSureWhatToPutHere"]; 
```

一切正常，社交面板打开并提供所有需要的服务。我唯一的要求是找出如何从相机胶卷中调用最新图像。我不确定我是否需要图像真实姓名，或者是否有任何其他方式来实现我想要的：附有图片的帖子（相机胶卷中的最新图片）。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T04:18:11.660

您可以使用资产库框架轻松获取相机胶卷中的最后一张图像。试试这个：

```
#import <AssetsLibrary/AssetsLibrary.h> 
```

然后获取图像：

```
ALAssetsLibrary *cameraRoll = [[ALAssetsLibrary alloc] init];
[cameraRoll enumerateGroupsWithTypes:ALAssetsGroupSavedPhotos usingBlock:^(ALAssetsGroup *images, BOOL *stop) {
    [images setAssetsFilter:[ALAssetsFilter allPhotos]];
    [images enumerateAssetsAtIndexes:[NSIndexSet indexSetWithIndex:[images numberOfAssets] - 1] options:0 usingBlock:^(ALAsset *result, NSUInteger index, BOOL *stop){
        if (result) {
            ALAssetRepresentation *rep = [result defaultRepresentation];
            self.sharingImage = [UIImage imageWithCGImage:[rep fullScreenImage]];
        }
    }];

}
                        failureBlock: ^(NSError *error) {
                            NSLog(@"An error occured: %@",error);
                        }]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T00:41:42.757

感谢 NSPostWhenIdle 的大力帮助！

通过将我`ALAssettsLibrary`的代码块移开`viewDidLoad`并创建一个`refreshAlbum`

```
 - (void) refreshAlbum
{
ALAssetsLibrary *cameraRoll = [[ALAssetsLibrary alloc] init];
[cameraRoll enumerateGroupsWithTypes:ALAssetsGroupSavedPhotos usingBlock:^(ALAssetsGroup *images, BOOL *stop) {
    [images setAssetsFilter:[ALAssetsFilter allPhotos]];
    [images enumerateAssetsAtIndexes:[NSIndexSet indexSetWithIndex:[images numberOfAssets] - 1] options:0 usingBlock:^(ALAsset *result, NSUInteger index, BOOL *stop)
     {
         if (result) {

             ALAssetRepresentation *rep = [result defaultRepresentation];
             self.sharingImage = [UIImage imageWithCGImage:[rep fullScreenImage]];
         }
     }];
}
                        failureBlock: ^(NSError *error) {
                            NSLog(@"An error occured: %@",error);
                        }];
} 
```

然后我从启用 shareByActivity 的同一个按钮调用新创建的 refreshAlbum

```
- (IBAction)refreshButton:(id)sender {
    [self refreshAlbum];
} 
```

这项工作特别好，因为我的应用程序在启动时没有任何图片要分享。第一次`imageShare`可用是在激活`shareByActivity`现在也带有该`refreshButton`功能的按钮之后！

再次感谢，这真的有效。

# c - 自定义 C Shell 中的段错误

> ID：13095978
> 
> 赞同：0
> 
> 时间：2012-10-27T00:08:51.767
> 
> 标签：c, shell, segmentation-fault

我正在 Unix 命令环境中编写 C shell。到目前为止，一切正常，但是以下命令将导致我的代码正确执行，但会以 seg 错误终止

```
1\. ls | ls | ls
2\. ls -al | ls -al > output.txt 
```

底线：我相信分段错误来自“XXXX 从这里开始”和“XXXX 从这里结束”之间的行。我也相信这与第一个 while 循环中的 getchar 测试有关，尽管我可能弄错了。如果您编译并运行此代码，您将在输入“ls -al | ls -al > output.txt”时看到所有内容都将执行，然后打印 shhh> AAAAA，然后是 seg 错误。谁能证实或否认我最初的观察？

```
#include <stdio.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <stdlib.h>
#include <fcntl.h>

main()
{
   char *path, *argv[20], buf[80], n, *p;
   int m, status, inword, continu;
   int inFlag, outFlag, bgFlag, k, count, j, pipes, pid, aCount, dirCount,
      hCount;
   int r_tube[2], l_tube[2];
   char *hist;
   char *h1[20] = { 0 };
   aCount = 0;
   dirCount = 0;

   while (1)
   {
      inword = 0;
      p = buf;
      m = 0;
      continu = 0;
      inFlag = outFlag = bgFlag = k = count = j = pipes = pid = 0;
      hCount = 0;
      int loc[20] = { 0 };
      char currD[50];

      printf("\nshhh> ");

      while ((n = getchar()) != '\n' || continu)   //XXXXXXXXX Starts here
      {
         if (n == ' ')
         {
            if (inword)
            {
               inword = 0;
               *p++ = 0;
            }
         }
         else if (n == '\n')
            continu = 0;
         else if (n == '\\' && !inword)
            continu = 1;
         else
         {
            if (!inword)
            {
               inword = 1;
               argv[m++] = p;
               *p++ = n;
            }
            else
               *p++ = n;
         }
      }                                    //XXXXXXXX Ends here

      *p++ = 0;
      argv[m] = 0;

      getcwd(currD, 50);

      while (argv[k] != 0)
      {                         //stores all entered commands into history array
         h1[aCount] = strdup(argv[k]);
         aCount++;
         k++;
      }
      k = 0;

      if ((strcmp(argv[0], "history") == 0) ||
         (strcmp(argv[0], "History") == 0))
      {                         //tests to see if history is asked for
         printf("History: \n");
         for (k = 0; k < aCount; k++)
            printf("%s\n", h1[k]);
      }

      if (strcmp(argv[0], "cd") == 0)
      {                         //tests to see if CD is needed
         if (strcmp(argv[1], "..") == 0)
            chdir(currD);
         else
         {
            while (argv[dirCount] != 0)
            {
               getcwd(currD, 50);
               chdir(argv[dirCount]);
               dirCount++;
            }
         }
      }

      char *outFile = NULL;
      char *inFile = NULL;
      loc[0] = 0;

      while (argv[count] != 0)
      {  //while loop sets the flags for input redirection, 
         // output redirection, background operator, and piping
         if (strcmp(argv[count], "<") == 0)
         {
            inFile = strdup(argv[count + 1]);
            argv[count] = argv[count + 1] = 0;
            inFlag = 1;
         }
         else if (strcmp(argv[count], ">") == 0)
         {
            outFile = strdup(argv[count + 1]);
            argv[count] = argv[count + 1] = 0;
            outFlag = 1;
         }
         else if (strcmp(argv[count], "&") == 0)
         {
            argv[count] = 0;
            bgFlag = 1;
         }
         else if (strcmp(argv[count], "|") == 0)
         {
            argv[count] = 0;
            loc[pipes + 1] = count + 1;
            pipes++;
            printf("LOC0: %d ", loc[0]);
            printf("LOC1: %d ", loc[1]);
            printf("LOC2: %d ", loc[2]);
            printf("DONE WITH IF\n");
         }
         else
            loc[count] = count;

         count++;
      }

      for (k = 0; k <= pipes; k++)
      {                         //actual execution of commands
         printf("IN FOR\n");
         if (k < pipes)
         {
            pipe(r_tube);
            j++;
         }

         pid = fork();          //fork child every time to exec

         if (pid > 0)
         {
            if (j > 0)
            {
               close(l_tube[0]);
               close(l_tube[1]);
            }
            l_tube[0] = r_tube[0];
            l_tube[1] = r_tube[1];
         }
         else if (pid == 0)
         {
            if ((k == 0) && (inFlag == 1))
            {
               int n = open(inFile, O_RDONLY | O_CREAT);
               if (n == -1)
               {
                  printf("Couldn't open inFile!\n");
                  exit(1);
               }
               close(0);
               dup(n);
               close(n);
            }
            else if ((k == pipes) && (outFlag == 1))
            {
               int out = open(outFile, O_WRONLY | O_CREAT, 0666);
               if (out < 0)
               {
                  printf("Could'nt open outFile!\n");
                  exit(1);
               }
               close(1);
               dup(out);
               close(out);
            }
            printf("K: %d ", k);
            printf("PIPES: %d ", pipes);
            printf("PID: %d\n", pid);
            execvp(argv[loc[k]], &argv[loc[k]]);
         }
         printf("ONE\n");
         if (bgFlag == 0)
            wait(NULL);
      }
      printf("TWO\n");
      if (strcmp(argv[0], "quit") == 0)
         exit(0);               //tests for exit/quit to end program
      if (strcmp(argv[0], "exit") == 0)
         exit(0);
      printf("THREE\n");
      for (k = 0; k < 20; k++)  //reset all of argv to NULL
         argv[k] = 0;
      printf("FOUR\n");

      wait(&status);
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T06:21:49.027

处理分段错误的最简单方法是分析保存到内核生成的 coredump 中的堆栈跟踪。大多数发行版都禁用了 coredump 保存，因此可以启用它

```
ulimit -c unlimited 
```

Proc 文件系统有几个文件来配置 corudump 生产。最重要的是[核心模式](http://linux.die.net/man/5/core) `/proc/sys/kernel/core_pattern`，它指定核心转储名称和可选的后处理命令。

当进程接收到分段错误信号时，内核会将其状态保存在 coredump 文件中，以后可以使用[dgb](http://linux.die.net/man/1/gdb)检查该文件：

```
gdb -c core ./binary_which_produced_the_core
bt 
```

这将打印出程序在发生分段错误时所做的事情的回溯。

例如，对于您的程序

```
Program terminated with signal 11, Segmentation fault.
#0  main () at main.c:58
58                 *p++ = n;
(gdb) bt
#0  main () at main.c:58
(gdb) 
```

注意，我必须添加缺少的标题，所以行号是 +2。

请使用`-Wall -Wextra`编译器选项报告所有警告并始终修复它们。例如，您有未初始化的 l_tube 数组。

# google-analytics - 来自转发域的谷歌分析跟踪？

> ID：13095980
> 
> 赞同：0
> 
> 时间：2012-10-27T00:09:07.173
> 
> 标签：google-analytics, analytics

我想在 www.soundclick.com/bands/default.cfm?bandid=976533 的音乐页面上应用谷歌分析

但我无法将该 URL 用作分析的默认 URL，因为它包含一个查询。

我在 www.SilentNoizeMusic.com 有一个域 URL，它转发到上述地址，但我怀疑使用 www.SilentNoizeMusic.com url 作为我在 Analytics 上的默认值是否会实际跟踪真实站点的统计信息。

我的怀疑正确吗？

如果是这样，是否有任何解决方法，例如对原始 URL 的修改可以绕过查询错误但仍直接指向要跟踪的同一页面？

*（作为旁注，我不确定它与任何潜在答案的相关性如何，但我使用的音乐托管网站不允许使用 javascript，这是最初阻止我使用分析的原因，因为我无法粘贴跟踪代码。我找到了一个我想测试的解决方法，但我只需要解决上述问题即可。）*

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T00:27:35.193

如果您使用 DNS 服务器提供的域转发，那么不，Google Analytics 将无法跟踪通过您的 SilentNoizeMusic.com URL 访问您的 soundclick.com 页面的访问者的统计信息。

一些 DNS 提供商提供“域隐藏”选项，使目标页面出现在浏览器中的 SilentNoizeMusic.com URL。所有这一切都是返回一个 HTML 页面，其中包含一个加载目标页面的 iframe。伪装是一种可怕的黑客攻击，而且不是很可靠，因为在目标页面（iframe 内）中单击的任何链接都会导致浏览器导航到目标页面。

另一种方法可能是尝试在目标页面中嵌入可跟踪项目。您说 soundclick.com 不允许您嵌入 javascript；他们允许你嵌入 HTML 吗？

选项 1：查看是否可以在 soundclick.com 页面的 html 中嵌入 iframe。将 iframe 指向您可以控制的其他 Web 服务器上的 html 页面，并将您的 javascript 和 google 分析存根放在那里。javascript 不会违反 soundclick.com 的“无 javascript”要求，因为它不会在 soundclick.com 的上下文中执行 - 它将被隔离在 iframe 中。iframe 甚至不必大到足以显示在您的 soundclick.com 页面上。只要有它就足以让隔离页面加载，这就是谷歌分析真正需要的。您不会在 soundclick.com 页面上获得有关用户在做什么的任何统计信息，而且您不会

选项 2：如果 soundclick.com 不允许您在页面上放置 iframe HTML 元素，他们是否允许您引用另一台服务器上的图像？同样，在您可以控制的服务器上设置一个图像文件（最好是小的），并在 soundclick.com 页面上放置一个链接，以引用其他服务器上的图像。然后，您可以收集图像文件上的请求统计信息，这将为您提供一定程度的流量测量。这就是老式的计数器所做的，基本上。

# java - 从标准输入获取输入

> ID：13095983
> 
> 赞同：14
> 
> 时间：2012-10-27T00:09:34.810
> 
> 标签：java, io, stdin

我想在 for 中从 stdin 获取输入

```
3
10 20 30 
```

第一个数字是第二行中数字的数量。这是我得到的，但它卡在了while循环中......所以我相信。我在调试模式下运行并且数组没有分配任何值......

```
import java.util.*;

public class Tester {   

   public static void main (String[] args)
   {

       int testNum;
       int[] testCases;

       Scanner in = new Scanner(System.in);

       System.out.println("Enter test number");
       testNum = in.nextInt();

       testCases = new int[testNum];

       int i = 0;

       while(in.hasNextInt()) {
           testCases[i] = in.nextInt();
           i++;
       }

       for(Integer t : testCases) {
           if(t != null)
               System.out.println(t.toString());               
       }

   } 

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-27T00:21:42.923

这与条件有关。

```
in.hasNextInt() 
```

它可以让您继续循环，然后在三次迭代后“i”值等于 4，并且 testCases[4] 抛出 ArrayIndexOutOfBoundException。

这样做的解决方案可能是

```
for (int i = 0; i < testNum; i++) {
 *//do something*
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-27T00:22:04.103

更新您的 while 以仅读取所需的数字，如下所示：

```
 while(i < testNum && in.hasNextInt()) { 
```

`&& i < testNum`一旦您读取了与您的数组大小相等的数字，添加的附加条件`while`将停止读取数字，否则它将变得无限，`ArrayIndexOutOfBoundException`当数字数组`testCases`已满时您将得到，即您已完成`testNum`数字阅读。

# selenium - 如果元素不存在，是否可以跳过测试？

> ID：13095984
> 
> 赞同：0
> 
> 时间：2012-10-27T00:09:41.010
> 
> 标签：selenium, phpunit

我正在为网站编写测试脚本。该网站有标签（导航链接）。

假设该选项卡的元素是 id=email。

如果不存在，是否可以跳过整个测试。所有测试用例都基于该选项卡（id=email）。

现在，我有：

```
if($this->isElementPresent("id=email") == true) {
    perform these steps
} 
```

而所有的测试脚本都是这样的，所以它只是打开浏览器然后关闭它而不测试任何东西。它正在通过它们。如果该元素不存在，是否可以跳过测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T14:48:38.860

我会将测试配置为使用相同的设置来查看字段是否存在，而不是跳过测试。模拟您的配置，并设置为禁用，然后测试应该寻找缺少的字段，并进行相应的测试。然后，将配置设置为启用，并测试该字段是否存在并进行相应测试。

当该字段设置为禁用时，您还可以使用 $this->markTestSkipped()。它记录在 PHPUnit 帮助[第 9 章。不完整和跳过的测试中](http://www.phpunit.de/manual/3.7/en/incomplete-and-skipped-tests.html#incomplete-and-skipped-tests.skipping-tests)。

样本：

```
public function testEmailIdAbsent()
{
    if($this->MockConfiguration['Email'] == 'disabled')  // Or however your configuration looks
    {
         $this->assertFalse($Foo->IsElementPresent("id=email", "Email ID is present when disabled.");
        ...
    }
}

public function testEmailIdPresent()
{
    if($this->MockConfiguration['Email'] == 'enabled')  // Or however your configuration looks
    {
         $this->assertTrue($Foo->IsElementPresent("id=email", "Email ID is not present when enabled.");
        ...
    }
}

public function testEmailId()
{
    if($this->MockConfiguration['Email'] == 'disabled') // Or however your configuration looks
    {
        $this->markTestSkipped('Email configuration is disabled.');
    }
} 
```

# java - 无法更新 R.java 文件以添加新对象？

> ID：13095989
> 
> 赞同：0
> 
> 时间：2012-10-27T00:10:40.197
> 
> 标签：java, android, eclipse, oop, ide

Eclipse + Android 插件。

修改正确运行的示例代码。

在现有代码中创建新对象时，错误：

```
newObj cannot be resolved or is not a field 
```

第一个“建议修复”将其添加到 R.java 文件中。（我还看到那里列出了第一个原始对象并带有一个值。）

但是，保存文件后，IDE 显示：

```
R.java was modified manually! Reverting to generated version! 
```

如何将此新对象添加到代码中？我应该只准备一个新的 R.java 文件吗？

非常感谢您在正确方向上的任何帮助？

[请在此处查看代码](http://jsfiddle.net/GregMcNulty/CxGsw/4/)。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T00:15:40.897

您永远不应该手动修改 R.java。这是从 res 的子文件夹中的 xml 文件生成的。您应该查看您所遵循的示例，其中存在 newObj 的声明。您得到的错误 newObj 无法解决可能意味着它尚未被声明。发布您正在使用的示例代码的链接，如何解决这个问题会更清楚。

**编辑**

查看评论中链接的代码示例后，您缺少在 res/layout/main_activity.xml 文件中删除的 XYPlot 对象。为了能够使用 R.id.newObj 来引用活动布局中的视图，它必须作为布局中的控件存在。并且强制转换意味着这个控件应该是 XYPlot 类型（在 xml 布局中使用时完全符合命名空间）。

**编辑 2**

为了使用 findViewById 方法来解析 View 对象，它需要在布局的 xml 中。如果你想在代码中将它插入到你的布局中，你需要一些其他的方法来实例化这个对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T00:15:55.597

确保您没有在其中一个 xml 视图中进行错误更改。尝试清理项目。实际上R文件是自动生成的。我们不需要手动编辑它。

# python - 在启动时运行 Python 应用程序

> ID：13095994
> 
> 赞同：1
> 
> 时间：2012-10-27T00:11:36.580
> 
> 标签：python, linux

我正在尝试使用 Python 3 为 linux 系统编写自定义登录程序。让应用程序在启动时自动运行的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T03:48:28.167

您应该使用 System V Init 脚本，或者像 upstart 这样的更现代的解决方案之一。

[Linux Standard Base 详细描述了 init 脚本的](http://refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic/iniscrptact.html)质量。

通常最容易从现有脚本之一开始`/etc/init.d`并对其进行调整以匹配您的用例。

您还可以选择重载/覆盖特定运行级别的行为。为此，您应该更详细地查看`/etc/inittab`and [`inittab(5)`](http://unixhelp.ed.ac.uk/CGI/man-cgi?inittab%205)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T04:33:55.340

如果是X11的登录程序，可以放到~/.xinitrc。它是 X 会话启动脚本。

# python - NoReverseMatch 命名 urls Django

> ID：13095999
> 
> 赞同：1
> 
> 时间：2012-10-27T00:12:13.410
> 
> 标签：python, django, match, django-urls, reverse

任何想法为什么这会返回`NoReverseMatch`错误？来自一个名为[updown的](https://github.com/weluse/django-updown)[djano-ratings](https://github.com/dcramer/django-ratings)分支。

网址.py：

```
url(r'^(?P<object_id>\d+)/rate/(?P<score>[\d\-]+)/$', AddRatingFromModel(), {
    'app_label': 'appname',
    'model': 'Thing',
    'field_name': 'rating',
}, name='thing_rating'), 
```

模板：

```
<div id='vote'><a href='{% url thing_rating %}'>Up</a></div> 
```

感谢您的任何想法！

* * *

编辑：为清楚起见添加了视图

```
def index(request):
    thing_list = Thing.objects.all()
    return render_to_response('index.html',
                         {'thing_list':thing_list},
                         context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:20:43.037

您需要为 url 的参数传递参数（我在这里使用关键字 args，但位置也可以）。

在列表视图中，您可能正在迭代您的项目，所以这样的事情有效：

```
{% for thing in thing_list %}
    ...
    <div id='vote'><a href='{% url "thing_rating" object_id=thing.id score=5 %}'>Up</a></div>
    ...
{% endfor %} 
```

我认为您还需要在 url 名称周围加上引号。

这里有更多关于 url 标签：[https ://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#url](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#url)