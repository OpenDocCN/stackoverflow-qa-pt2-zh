# StackOverflow 问答 13148000-13148999

# java - 虚假唤醒，wait() 和 notifyAll()

> ID：13148001
> 
> 赞同：3
> 
> 时间：2012-10-30T21:43:00.807
> 
> 标签：java, multithreading, synchronization

我有 N 个线程在循环中执行这些操作：增加共享变量，检查共享变量值是否为 N（如果是，则将值放入队列）并执行 wait()。我还有一个检查 q 变量的威胁。如果 queue 为真，它会执行 notifyAll()。在那之后，N 个线程应该被唤醒，并进行另一次循环运行。但似乎有些线程在没有通知的情况下被唤醒。我读过关于虚假唤醒的文章，但我不知道应该对 while() 设置什么条件来检查它是否是虚假唤醒。

贝娄是我的代码示例（不一样，但含义非常相似）：

共享类在所有线程之间共享：

```
class Shared {
    volatile int v = 0;
} 
```

我创建了 10 个线程并运行它们。

```
class NThreads implements Runnable {
    private Shared shared;
    private QThread q;
    static int N = 0; /* N - number of threads */

    public NThreads(QThread q, Shared shared) {
        this.q = q;
        this.shared = shared;
        ++N;
    }

    @Override
    public void run() {
        for (int i=0;i<1048575;++i) {
            doSomeCalculations();
            loop();
        }
    }

    private void loop() {
        synchronized (shared) {
            if (++shared.v == N) {
                shared.v = 0;
                synchronized (Q) {
                    q.q = true;
                }
                shared.wait();
            } else {
                shared.wait();
            }
        }
    }
} 
```

只有一个 QThread 等待修改 q 然后调用 notifyAll();

```
class QThread implements Runnable {
    private Shared shared;
    volatile boolean q = false;

    public QThread(Shared shared) {
        this.shared = shared;
    }

    @Override
    public void run() {
        for (;;) {
            if (q) {
                synchronized (this) {
                    q = false;
                }
                synchronized (shared) {
                    shared.notifyAll();
                }
            }
            doSomethingElse();
            // or even: Thread.yield();
        }
    }
} 
```

运行一切的主类：

```
class Main {
    public static void main(String[] args) {
        Shared shared = new Shared();
        QThread qt = new QThread(shared);
        NThread[] nt = new NThread[10];
        for (int i=0; i<nt.length; ++i) {
            nt[i] = new NThread(qt, shared);
        }
        Thread[] threads = new Thread[nt.length+1];
        threads[0] = new Thread(qt);
        for (int i=0; i<nt.length; ++i) {
            threads[1+i] = new Thread(nt[i]);
        }

        for (int i=0; i<threads.length; ++i) {
            threads[i].start();
        }

        for (int i=0; i<threads.length; ++i) {
            threads[i].join();
        }
    }
} 
```

有时有线程（来自 NThreads）完成了它们的循环，但其他线程没有。我认为这是因为虚假唤醒。如何编写条件以获取虚假唤醒的蛋糕并确保所有线程都可以继续工作？

也许 java.util.concurrent 中有有用的类？但我没有看到任何有趣的东西...... :(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:55:36.340

[Object.wait()](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#wait%28%29)的 JavaDocs讨论了虚假唤醒的可能性。它还提到您应该在离开等待循环之前检查外部条件的循环中使用 wait() 。

您需要稍微重构 loop() 方法来完成此操作

```
private void loop() {
    synchronized (shared) {
        shared.v++;
        while(shared.v < N) {
            shared.wait();
        }

        shared.v = 0;
        synchronized (Q) {
            q.q = true;
        } 
    } 
```

最后，您可能应该找到一个内置的并发库，因为这些类型的东西很容易出错。我会以 Google 的 Guava、java.util.concurrency 或众多 Apache Commons 库之一作为起点。

# sql-server-2005 - mssql 另一种使用 IN 编写查询的方法？

> ID：13148003
> 
> 赞同：2
> 
> 时间：2012-10-30T21:43:25.587
> 
> 标签：sql-server-2005, coldfusion

我正在更新网页搜索表单。用户选择他们想要搜索的组名。在操作页面上，为了简单起见，我最终得到以下查询：

```
select GroupName
from    groupTable 
where groupName in ('Motley Crue','Alvin and the Chipmunks') 
```

通常，这对我来说不是问题，但在这种情况下，数据库字段还可能包含一串名称，例如：

```
Big Dog's Chair,Purple Dragon,Just Johnny,Johnny Faster,Van Halen 
```

我相信我将不得不用逗号分隔列表中的每个项目遍历数据库字段中的每个项目。如果是这种情况，我不知道该怎么做，也不知道在 SO 或 google 中使用什么搜索词。我可以使用一些帮助。

数据库：MSSQL 2005 Coldfusion：CF9

我在中部标准时间 5:00 下班，所以如果你回复，我可能要到明天才能看到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T13:16:22.617

马特在正确的轨道上，但是：

如果组名是组的子字符串，则该解决方案可能会产生意外结果。例如，假设用户选择了“粉红色”。该查询还将匹配“Pink Floyd”或“Big Pink”或任何其他包含 Pink 的乐队。

我假设您的表单变量的名称是“selectedGroups”。将其更改为实际情况，它应该可以工作。

```
select
    groupName
from
    groupTable
where
    <!--- I thought I knew a more graceful way of doing this but it isn't coming to me --->
    <cfloop list = '#form.selectedGroups#' index = "i">
        groupName = '#i#' <!--- match the group if the column only contains one value --->
    or  groupName like '#i#,%' <!--- match the group if it is the first group in the list --->
    or  groupName like '%,#i#,%' <!--- match the group name if it is in the middle of the list --->
    or  groupName like '%,#i#' <!--- match the group name if it is the last group in the list --->
    #i neq listLast(form.selectedGroups) ? ' or ' : ''# <!--- add an or for the next value to search --->
    </cfloop> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:49:07.537

这不像将它们分成多列那样理想，但你可以这样做

```
select GroupName
from groupTable 
where (groupName like '%Motley Crue%'
 or groupname like '%Alvin and the Chipmunks%'
) 
```

# vb.net - 在 vb.net 中创建动态二维数组时出错

> ID：13148008
> 
> 赞同：1
> 
> 时间：2012-10-30T21:43:38.373
> 
> 标签：vb.net

我正在尝试增加二维数组的 x 值，但我一直收到此错误。

```
'ReDim' can only change the rightmost dimension 
```

我需要在维护数组数据的同时执行此操作。这是我的代码。

```
 Dim x As Integer = 0
            Dim y As Integer = 0
            While reader.Read()
                ReDim Preserve catagoryInfo(x, 2)
                catagoryInfo(x, y) = reader.GetString(0)
                y += 1
                catagoryInfo(x, y) = reader.GetString(1)
                x += 1
                y = 0
            End While 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:07:36.833

在多维数组中，使用 Preserve 时只能更改最后一个维度。如果您尝试更改任何其他维度，则会发生运行时错误。您的代码的一部分确实不是最理想的，因为您计划在每个循环中重新调整您的数组。使用 preserve 进行重新调整更糟糕，因为运行时不仅分配了一个新数组，而且还应该从旧数组复制到新数组。

在您的情况下，最好声明一个像这样的简单类

```
Public Class CategoryInfo
    Public info1 As String
    Public info2 As String
End Class 
```

然后使用 List(Of CategoryInfo)

```
Dim infos as List(Of CategoryInfo) = new List(Of CategoryInfo)()
While reader.Read()
    Dim nf As CategoryInfo = new CategoryInfo() 
    nf.info1 = reader.GetString(0)
    nf.info2 = reader.GetString(1)
    infos.Add(nf)
    ' if you like the all-in-one-line coding style you could also write the above in this way
    ' infos.Add(New CategoryInfo With {.info1=reader.GetString(0), .info2=reader.GetString(1)} )
End While 
```

现在，如果您真的需要将数据放在字符串数组中，您可以编写

```
Dim categoryInfo(infos.Count, 2) as String
for x = 0 to infos.Count -1
    categoryInfo(x,0) = infos(x).info1
    categoryInfo(x,1) = infos(x).info2
next 
```

这仍然不是很理想，因为您在数据上循环了两次，但至少它会根据需要获取数据。

# netty - netty 4.0.0 中的 HTTPS 客户端

> ID：13148010
> 
> 赞同：1
> 
> 时间：2012-10-30T21:43:46.877
> 
> 标签：netty

我无法使 netty 4.0.0alpha6 HttpSnoopClient 示例与 SSL 一起使用。在 HttpSnoopClientInitializer 中启用 ssl 后（通过取消注释 SslEngine 初始化并将 SslHandler 添加到管道中）SSL 握手完成，但客户端没有发送数据/http 请求。最终客户端失败

```
javax.net.ssl.SSLException: SSLEngine already closed
    at io.netty.handler.ssl.SslHandler.flush(SslHandler.java:434)
    at io.netty.handler.ssl.SslHandler.inboundBufferUpdated(SslHandler.java:819) 
```

服务器端是常规的 apache+mod_ssl。SslHandler 是否应该与 4.0.0 中的 Http* 管道一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T07:43:50.740

我今天有机会测试了这个`HttpSnoopClient`例子，发现了一个错误，`SslHandler`它阻止了 HTTP 请求的发送。我刚刚将修复推送到 master，并确认该示例已成功从[https://www.google.com/检索数据。](https://www.google.com/)

但是，即使在修复之前，我也没有看到这样的异常`SslHandler`，因此您遇到的问题可能与我的无关。如果您仍然对主快照有同样的问题，请随时告诉我。

# sql-server - 我可以创建一个虚拟的 INSTEAD OF UPDATE、INSERT 触发器，以便可以将 MERGE 与 INSTEAD OF DELETE 一起使用吗？

> ID：13148011
> 
> 赞同：1
> 
> 时间：2012-10-30T21:44:04.840
> 
> 标签：sql-server

我正在尝试利用 SQL Server 2008R MERGE 功能来管理连接表中的父子关系记录。

连接表表示多对多关系，因此它有两个外键对应同一个主键。因此，`ON DELETE CASCADE`不能使用。在它的地方，我使用触发器`INSTEAD OF DELETE`并删除连接记录，从而删除约束，以便我可以完成最初预期的删除操作。

不幸的是，当我尝试在这种情况下使用 MERGE 时，我收到以下错误。

```
The target 'Content' of the MERGE statement has an INSTEAD OF trigger on some,
but not all, of the actions specified in the MERGE statement. In a MERGE statement,
if any action has an enabled INSTEAD OF trigger on the target, then all actions
must have enabled INSTEAD OF triggers. 
```

这是用于重现此问题的 T-SQL。为方便起见，我已将注释掉的 drop 和 select 语句包括在内。

```
CREATE DATABASE [TestDatabase]
GO

USE [TestDatabase]
GO

CREATE TABLE dbo.[Content] (
    ContentID int NOT NULL IDENTITY (1, 1),
    Title varchar(255)
)
ALTER TABLE dbo.[Content]
    ADD CONSTRAINT PK_Content
    PRIMARY KEY CLUSTERED (ContentID)

CREATE TABLE dbo.[Attachment] (
    ParentContentID int NOT NULL,
    ChildContentID int NOT NULL
)

ALTER TABLE [dbo].[Attachment]
    ADD CONSTRAINT [PK_Attachment]
    PRIMARY KEY CLUSTERED (
        [ParentContentID] ASC,
        [ChildContentID] ASC
    )

ALTER TABLE dbo.Attachment
    ADD CONSTRAINT FK_Attachment_ParentContent
    FOREIGN KEY (ParentContentID)
    REFERENCES dbo.[Content] (ContentID)
    ON UPDATE NO ACTION
    ON DELETE NO ACTION 

ALTER TABLE dbo.Attachment
    ADD CONSTRAINT FK_Attachment_ChildContent
    FOREIGN KEY (ChildContentID)
    REFERENCES dbo.[Content] (ContentID)
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
GO

CREATE TRIGGER trContentInsteadOfDelete
    ON dbo.[Content]
    INSTEAD OF DELETE
AS

    SET NOCOUNT ON;

    DELETE FROM dbo.[Attachment]
    WHERE [ParentContentID] IN (SELECT [ContentID] FROM deleted)
    OR [ChildContentID] IN (SELECT [ContentID] FROM deleted)

    DELETE FROM dbo.[Content]
    WHERE [ContentID] IN (SELECT [ContentID] FROM deleted)
GO

INSERT INTO [Content] ([Title]) VALUES ('a'), ('a'), ('a'), ('b')
GO

INSERT INTO [Attachment] ([ParentContentID], [ChildContentID])
    VALUES (1, 2), (1, 4), (3, 4)
GO

MERGE [Content] AS target
USING (VALUES (1, 'a'), (2, 'b'), (NULL, 'b')) AS source ([ContentID], [Title])
ON target.[ContentID] = source.[ContentID]
WHEN MATCHED AND target.[Title] != source.[Title] THEN
    UPDATE SET target.[Title] = source.[Title]
WHEN NOT MATCHED BY TARGET THEN
    INSERT ([Title]) VALUES (source.[Title])
WHEN NOT MATCHED BY source THEN
    DELETE;

/*
USE master
DROP DATABASE [TestDatabase]

SELECT * FROM [Content]
SELECT * FROM [Attachment]
*/; 
```

~~在从 Content 表中删除记录之前，是否有任何替代方法可以添加触发器`INSTEAD OF INSERT`并且`INSTEAD OF UPDATE`不必显式删除 Attachment 表中的任何约束记录？~~

我可以暂时禁用触发器，但随后我必须明确删除附件表中的约束记录。

~~我担心添加额外的触发器只是为了适应 MERGE 语句会破坏使用 MERGE 语句的目的。~~

更新：有没有办法创建一个虚拟 INSTEAD OF INSERT, UPDATE 触发器以使我能够继续使用 MERGE？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:36:06.550

这似乎可以解决问题，但我想知道对性能的影响。

```
CREATE TRIGGER trContentInsteadOfDelete
    ON dbo.[Content]
    INSTEAD OF DELETE
AS

    SET NOCOUNT ON;

    DELETE FROM dbo.[Attachment]
    WHERE [ParentContentID] IN (SELECT [ContentID] FROM deleted)
    OR [ChildContentID] IN (SELECT [ContentID] FROM deleted)

    DELETE FROM dbo.[Content]
    WHERE [ContentID] IN (SELECT [ContentID] FROM deleted)

GO

CREATE TRIGGER trContentInsteadOfInsertUpdate
    ON dbo.[Content]
    INSTEAD OF INSERT, UPDATE
AS

    SET NOCOUNT ON;

    INSERT INTO dbo.[Content] (
        [Title]
    )
    SELECT
        i.[Title]
    FROM inserted i
    LEFT JOIN dbo.[Content] c ON i.[ContentID] = c.[ContentID]
    WHERE c.[ContentID] IS NULL

    UPDATE c
    SET
        c.[Title] = i.[Title]
    FROM dbo.[Content] c
    JOIN inserted i ON c.[ContentID] = i.[ContentID]
GO 
```

# asp.net - Microsoft Ajax 中的假 __EVENTVALIDATION

> ID：13148013
> 
> 赞同：5
> 
> 时间：2012-10-30T21:44:09.973
> 
> 标签：asp.net, microsoft-ajax

我正在为网站制作移动应用程序以查看您的日程安排。他们不提供任何 API，也无意制作一个。

该网站只能使用 Ajax 运行，但是要伪造这些请求并抓取网站，我需要伪造`__EVENTVALIDATION`post 字段。

我无法控制网站，也从未使用 ASP.NET 或 Microsoft Ajax 构建过任何东西。

有人做过吗？

我发现该`__EVENTVALIDATION`字段具有这种模式（`...`表示根据请求更改的字节，base64 解码版本的 hexdump）：

```
d8 01 16 13 02 4f 0a
...
f6 e0 84 d4 05 02 a0 3f
e2 3f 03 02 3f d8 d1 d5 0c 02 bb 82 cf ec 08 02
b4 b5 99 f8 0b 02 3f 89 3f eb 04 02 d5 83 90 88
0a 02 8a 分贝 94 90 03 02 8b cf 3f 85 08 02 93 3f
b1 3f 06 02 9b 3f 8f a5 02 02 b5 b4 af 85 01 02
d1 fc ae 9c 0e 02 b4 e2 94 9e 0a 02 3f e2 94 9e
0a 02 3f e2 94 9e 0a 02 bb 92 80 a5 06
...                                  

```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-13T18:23:10.397

在为 ASP.NET 网站构建爬虫程序之前，我已经处理过这个问题。您需要请求浏览器用户通常登陆的初始页面，提取`__VIEWSTATE`和`__EVENTVALIDATION`散列，然后使用它们对您实际需要的数据进行第二次请求。

例如，如果您要从表单提交中抓取响应：

1.  对表单所在的页面发出 AJAX 请求
2.  从响应中提取视图状态和事件验证哈希
3.  发出一个模拟表单提交的新 AJAX 请求，将哈希值作为参数传递

如果您正在寻找 JavaScript 函数来从标记中提取哈希值，我已经在 GitHub 上发布了我用作[ms-viewstate的函数。](https://github.com/mattcg/ms-viewstate)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:39:27.437

`__EVENT`**`VALIDATION`**是一种**安全措施**。

> 该功能可防止潜在恶意用户从客户端发送未经授权的请求。为了确保每个回发和回调事件都源自预期的用户界面元素，页面添加了额外的事件验证层。该页面基本上将请求的内容与 __EVENTVALIDATION 字段中的信息相匹配，以验证客户端上没有添加额外的输入字段，并且在服务器上已知的列表中选择了该值。页面在呈现期间生成事件验证字段 - 这是在信息可用的最后可能时刻。与视图状态一样，事件验证字段包含一个**哈希值**以防止客户端篡改。

*哈希值*基于服务器级别的键。所以你不能复制那个哈希——或者更确切地说，如果你这样做了，没有访问服务器，我猜你发现了一个安全漏洞。

参考：[MSDN](http://msdn.microsoft.com/en-us/magazine/cc163512.aspx)

# javascript - Adobe Edge 运行时中的时间线事件错误停止 javascript 执行

> ID：13148014
> 
> 赞同：2
> 
> 时间：2012-10-30T21:44:09.850
> 
> 标签：javascript, html, onerror, adobe-edge

我正在为一家教育公司创建一个学习模块，我在其中创建 25 个动物精灵（带有图像的画布）并将它们放在农场中（带有背景图像的 div）。为了打开动画，在 Adob​​e Edge 中创建了背景，在 Edge 的最后一帧中，我在我的 Javascript 代码中调用了一个 init 函数来构建测试并创建精灵。某些动画通过 Edge 代码在背景（太阳和云）中无限期地出现。

问题是屏幕有时会正确加载，有时会在执行过程中停止。通过console.log，我发现Edge中有时会出现一个错误事件，向控制台发送消息：

> 事件处理程序中的 Javascript 错误！事件类型 = 时间线

之后，所有 Javascript 代码都停止，屏幕变得无用。

我尝试通过将以下代码添加到索引文件的头部部分来捕获错误事件并清除它：

```
function noError(){return true;}
window.onerror = noError; 
```

但它没有用。

我进入 Adob​​e Edge **edge.0.1.7.min.js**文件并添加了***return true;*** 但这也没有用。

Adobe Edge 问题上没有太多帮助，但似乎有很多...

该项目可以在以下位置看到：

[http://www.totalliberty.com/cet/farm/](http://www.totalliberty.com/cet/farm/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-08T13:58:40.477

我遇到了同样的问题，这是一个 jQuery 冲突，我将它加载到索引中，然后 edge 将它加载到 edgePreload.js 中。所以解决方案是从 edgePreload.js 加载所有 js 脚本，如下所示：

```
 aLoader = [
{ load: "js/jquery-1.9.1.min.js"},
{ load: "js/jquery.flexslider-min.js"},
{ load: "js/jquery.foundation.reveal.js"},
{ load: "edge_includes/edge.1.5.0.min.js"},
{ load: "Untitled-1_edge.js"},
{ load: "Untitled-1_edgeActions.js"}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-19T23:34:19.723

在 Adob​​e Edge Animate 2015 中，只需添加 (+) 您的 JavaScript 链接/链接到您的项目库。

（例如[https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js](https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js)）

[![在此处输入图像描述](../Images/42fadc4e68e482b23c894658d5497834.png)](https://i.stack.imgur.com/MSB8h.png)

# jquery - 使用 jQuery 在表单上启用输入按钮或单击事件

> ID：13148020
> 
> 赞同：0
> 
> 时间：2012-10-30T21:44:30.830
> 
> 标签：jquery, ajax, forms

尝试简化此过程时遇到了麻烦。对 jQuery 来说还是有些新意，所以如果我遗漏了一些简单的东西，请原谅我。

我已经在通过点击事件发送表单时设置了 AJAX 请求。但是，我需要“输入”键才能正常工作，而不是在发送时重新加载页面。

这就是我正在使用的：

```
$('#submit').click(function() {
     //Do AJAX Stuff
});

$('#submit').keydown(function (e){
if(e.keyCode == 13){
     //Do AJAX Stuff
}
}) 
```

那么我想说的是，我可以将这两个函数结合起来用于同一个 AJAX 请求吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T21:47:24.707

只需将`submit`处理程序绑定到您的表单（*而不是*提交按钮）。它处理所有这些情况：

```
$('#your_form').submit(function(e) {
    var $this = $(this);
    e.preventDefault(); // Prevents the form from submitting regularly

    $.ajax({            // Sends the appropriate AJAX request instead
        url: $this.attr('action'),
        type: $this.attr('method'),
        data: $this.serialize(),
        success: function(response) {
            alert(response);
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:47:17.857

您可以使用[`on()`](http://api.jquery.com/on/)事件绑定器：

```
$('#submit').on("click keydown", function(e){
    if(e.keyCode == 13 || e.type == "click"){
         //Do AJAX Stuff
    }        
}) 
```

# silverlight - 合并 2 个 Silverlight 解决方案的最佳方法？

> ID：13148026
> 
> 赞同：0
> 
> 时间：2012-10-30T21:45:07.953
> 
> 标签：silverlight, merge, branching-and-merging

我有一个 Silverlight 5 解决方案的两个分支。它们都建立在同一个基础项目之上。我将把一个合并到另一个。有些文件可以简单地复制过来，而另一些则需要在代码级别逐行合并。

对于像这样大规模的合并过程的最佳实践的想法？

可能有用的工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T12:40:40.560

过去对我有用的是将一个分支签入源代码控制系统。然后将源代码控制指向另一个分支目录并尝试将其签入。通常，它会发现容易签入的差异并向您显示要手动合并的文件。我使用 WinMerge 作为基于文件的合并工具，因为它是免费的。对于源代码控制，我编写了自己的代码，这样我就可以轻松地进行大规模重构，而不必与源代码控制发生争执。

# sockets - Gadgeteer 设备可以记录并发送其位置吗？

> ID：13148031
> 
> 赞同：0
> 
> 时间：2012-10-30T21:45:23.980
> 
> 标签：sockets, geolocation, embedded, coordinates, .net-gadgeteer

是否可以（通过 C# 代码）将位置自我意识灌输到一小块“Gadgeteer”（http://gadgeteer.codeplex.com/）硬件中？

IOW，我想知道是否可以编写 C# 代码下载到一个小部件（嵌入式设备）中，该小部件（嵌入式设备）将能够使用 Geolocation 类（或其他）来知道它自己的坐标，然后发送无线信号（使用套接字，例如）到在平板电脑上运行的 Windows 8 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T22:55:20.100

是的。您可以使用[GPS 模块](http://www.seeedstudio.com/depot/gps-module-net-gadgeteer-compatible-p-971.html?cPath=203)收集位置（至少在室外）和[Wi-Fi 模块](http://www.ghielectronics.com/catalog/product/282)（或任何[连接模块](http://www.gadgeteering.net/hardware?type%5B%5D=mainboard&type%5B%5D=module&field_module_type_tid=11&field_hi_manufacturer_nid=All&=Apply)）以促进与服务器的连接并发布结果。然后 Win8 磁贴应用程序可以从同一 Web 服务器读取 Gadgeteer 模块的位置。

# grails - 将旧版 Neo4j 数据库与 Grails 一起使用

> ID：13148032
> 
> 赞同：1
> 
> 时间：2012-10-30T21:45:29.080
> 
> 标签：grails, neo4j, grails-2.0, grails-domain-class

我想使用加载到 Neo4j 中的[ENRON GraphML 数据集](http://www.infochimps.com/datasets/enron-email-data-with-manager-subordinate-relationship-metadata)作为我的 Grails 2.0 应用程序的数据库。数据的用例是只读的。我在独立应用程序中加载数据集和创建数据库没有问题，现在想使用 Grails 插件来管理对数据库的访问。

查看有关映射域类的[Neo4J 插件文档](http://springsource.github.com/grails-data-mapping/neo4j/manual/guide/mapping.html)，我发现它需要为每种类型的顶点提供子引用节点。我的数据没有。我可以看到几种前进的方式，但不确定要追求哪种方式：

1.  转储插件，创建服务，并自己管理读取数据库。优点：我可以轻松实现这一点。缺点：潜在的性能问题、错误。

2.  编写一个程序来创建插件所需的缺失顶点和边，然后将数据库加载到插件中。优点：插件将管理访问。缺点：可能需要进行几次迭代才能准确确定需要添加哪些内容以使其与插件创建的数据库保持一致。

3.  通过插件创建一个空数据库，并通过从不同的数据库中读取数据来执行一系列插入操作。优点：插件将管理访问。缺点：引导数据库可能需要很长时间；需要编写代码来遍历、序列化数据库；等等

有什么好方法？我在看什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:38:46.410

作为 Grails Neo4j 插件的作者，我或许可以在这里给出一个合格的答案。插件中当前使用的子引用结构并不总是最好的方法。我有一些计划通过以可配置的方式索引来替换它，但现在没有 ETA。由于您可能需要更短期的解决方案，我建议在只读数据库的情况下在 1) 和 2) 之间进行选择。使用域类的主要优点之一是使用脚手架。由于您是只读的，因此恕我直言，此论点在这里不算数。

1) 还有一个很好的优势：如果您使用例如 cypher 来查询图形，即使使用 REST 风格的数据库，性能也会非常好。一般来说，如果性能很重要，您应该使用 cypher 来支持 Grails 标准查询/动态查找器。

2）如果您采用这种方法，我可以提供一些支持。基本上，您需要创建域类并为每个域类创建一个子引用节点，并将所有实例连接到该节点。这里的优势：您可以使用例如动态查找器或标准条件查询。创建子引用节点和与实例节点的连接可以通过一两个密码语句轻松完成。

# android - 获取单选按钮值 Android

> ID：13148034
> 
> 赞同：1
> 
> 时间：2012-10-30T21:45:36.393
> 
> 标签：android, forms, android-intent, radio-button

我正在尝试制作一个简单的表单活动，以了解如何使用 Eclipse 提供的各种组件。在我到达单选按钮之前，我做得很好。

该应用程序允许用户填写整个表格，然后单击发送按钮。单击发送按钮时，我创建一个新意图，将所有表单数据传递到该意图并启动一个新活动以充当一种确认/摘要页面。

如何检索用户单击了哪个单选按钮？我一共有五个。下面是我的 onCreate 方法的代码。

```
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.feedback_scroll);

    //References to XML
    name = (EditText)findViewById(R.id.nameEntryBox);
    county = (Spinner)findViewById(R.id.countySpinner);

    //Set array adapter
    county.setAdapter(fillCountySpinner());
    submitBtn = (Button)findViewById(R.id.submitFormBtn);

    atmo1 = (RadioButton)findViewById(R.id.arad1);
    atmo2 = (RadioButton)findViewById(R.id.arad2);
    atmo3 = (RadioButton)findViewById(R.id.arad3);
    atmo4 = (RadioButton)findViewById(R.id.arad4);
    atmo5 = (RadioButton)findViewById(R.id.arad5);

    ser1 = (RadioButton)findViewById(R.id.srad1);
    ser2 = (RadioButton)findViewById(R.id.srad2);
    ser3 = (RadioButton)findViewById(R.id.srad3);
    ser4 = (RadioButton)findViewById(R.id.srad4);
    ser5 = (RadioButton)findViewById(R.id.srad5);

    rating = (RatingBar)findViewById(R.id.ratingBar1);

    //Add a listener to the submit button - Anonymous inner class
    submitBtn.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // Create a new Intent
            Intent i = new Intent(v.getContext(), FeedbackResults.class);

            choice = (String)county.getSelectedItem();
            //Add extra parameters

            //Name
            i.putExtra("name", name.getText());
            //County
            i.putExtra("county", choice);
            //Dob
            //Atmosphere
            i.putExtra("atmosphere", atmos);
            //Service
            i.putExtra("service", serv);
            //Rating
            i.putExtra("rating", rating.getRating());

            //Start new Activity that will display a review of the customers feedback
            startActivity(i);

            //Toast message
            Toast.makeText(v.getContext(), "Thank you for your feedback!", Toast.LENGTH_SHORT).show();

        }
    });
} 
```

我在这个网站上查看与我的问题有关的另一个主题。他们说要使用 switch 语句。我了解它的逻辑并在方法中编写了执行此操作的方法，但我不知道如何将 View 变量传递给它..这个视图变量与什么有关？这是我写的方法。

```
 public void onRadioButtonClicked1(View v){

    switch(v.getId()){
    case R.id.arad1:
        atmos = "1";
        break;
    case R.id.arad2:
        atmos = "2";
        break;
    case R.id.arad3:
        atmos = "3";
         break;
    case R.id.arad4:
        atmos = "4";
        break;
    case R.id.arad5:
        atmos = "5";
        break;
    }

} 
```

非常感谢任何反馈！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T21:50:31.297

每组单选按钮都应该在一个组中，我假设您已经在 XML 文件中这样做了。

假设，那么您通过执行以下操作获得选中的单选按钮的 ID：

```
int id = ((RadioGroup)findViewById( R.id.radio_group )).getCheckedRadioButtonId(); 
```

您可以在 a 中的任何位置执行此操作`Activity`，或者如果您正在使用 a `Fragment`，则只需将 a`getView()`放入其中：

```
int id = ((RadioGroup)getView().findViewById( R.id.radio_group )).getCheckedRadioButtonId(); 
```

所以我会改变你的`onClick`：

```
public void onClick(View v) {
    // Create a new Intent
    Intent i = new Intent(v.getContext(), FeedbackResults.class);

    choice = (String)county.getSelectedItem();
    int id = ((RadioGroup)findViewById( R.id.radio_group )).getCheckedRadioButtonId();
    atmos = getAtmos( id );
    ...
}

private int getAtmos( int id ) {
    switch( id ) {
        case R.id.arad1:
            atmos = "1";
            break;
        case R.id.arad2:
            atmos = "2";
            break;
        case R.id.arad3:
            atmos = "3";
             break;
        case R.id.arad4:
            atmos = "4";
        break;
        case R.id.arad5:
            atmos = "5";
            break;
    }

    return atmos;
} 
```

# asp.net-mvc-3 - 无法一对一解析属性 Fluent nhibernate

> ID：13148035
> 
> 赞同：1
> 
> 时间：2012-10-30T21:45:37.017
> 
> 标签：asp.net-mvc-3, fluent-nhibernate

```
class CASE
{
   public virtual int ID
   public virtual CASE_BUDGET Case_Budget
}

class CASE_BUDGET
{
   public virtual int Case_Id;
}

class CASE_MAP
{
   Id(x=>x.ID).GeneratedBy.Custom("trigger-identity");
   HasOne<CASE_BUDGET>(x=>x.Case_Budget).Cascade.All();
}

class CASE_BUDGET_MAP
{
   Id(x => x.Case_Id,"CASE_ID").GeneratedBy.Foreign("CASE");
} 
```

当我尝试保存包含案例预算的案例时，我收到了**无法解析属性：案例作为我的错误消息。**

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T15:14:16.907

`HasOne`映射始终需要相应的属性和映射`Reference`在另一侧（在您的情况下，CASE_BUDGET 必须具有引用案例的属性）。您必须指定它，`.PropertyRef()`否则 FNH 将使用类型为映射类的第一个属性。

# python - 在 Python 中从纬度/经度多边形计算面积

> ID：13148037
> 
> 赞同：3
> 
> 时间：2012-10-30T21:45:41.793
> 
> 标签：python, numpy, scipy, gis, geospatial

基本上，我想知道 0.25°lat x 0.25°lon 补丁在世界各地的各种多边形中拟合了多少次。后者的尺寸约为 3°lat x 10°lon 或 2°lat x 4°lon。

我有多边形角的纬度/经度值，我正在计算它们的面积，如下所示：

```
from pyproj import Proj
from shapely.geometry import shape

def getArea(coords):
    c = {"type": "Polygon",
    "coordinates": [[ (coords[0], coords[2]), (coords[1], coords[2]),
                      (coords[0], coords[3]), (coords[1], coords[3]) ]]}
    lon, lat = zip(*c['coordinates'][0])
    pro = Proj("+proj=aea")
    x, y = pro(lon, lat)
    poly = {"type": "Polygon", "coordinates": [zip(x, y)]}
    return shape(cop).area 
```

我从这里采用了方法：[如何使用 python 计算地球表面多边形的面积？](https://stackoverflow.com/questions/4681737/how-to-calculate-the-area-of-a-polygon-on-the-earths-surface-using-python)

现在的问题是，我应该选择哪个等面积投影以使多边形具有可比较的面积大小。在这样的投影中，无论它位于地球上的哪个位置，小斑块的面积总是相同的。

采用阿尔伯斯等面积投影 (aea) 可得出三个多边形的这些区域：

1.  240993868.90978813
2.  699931593.1047173
3.  212092562.5238676

采用 Lambert 方位角等面积投影 (laea) 得到相同多边形的这些区域：

1.  148709452.69292444
2.  409253749.5468254
3.  106218747.36092758

为什么两个投影中的面积关系不同？前 1:3 = 0.344；第二个 1:3 = 0.363；它们应该是相同的，因为它们都是相等的面积投影？！

这让我想知道将小补丁与任一投影中的多边形区域进行比较是否合法。你有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T09:34:32.430

如果您关心实际的相对面积，计算瓷砖不会给您正确的答案。如果您需要实际的表面积，请使用椭球或球面几何，或下面的想法。

蛮力矢量方法：将全球 0.25 度网格生成为多边形，与多边形相交，计算结果。每个多边形可以是笛卡尔正方形或实际的椭圆正方形。为每个图块创建自定义理想投影，然后计算面积并将其存储为每个图块的属性。你只需要这样做一次:)

# python - 枚举python中的麻烦

> ID：13148041
> 
> 赞同：0
> 
> 时间：2012-10-30T21:46:06.503
> 
> 标签：python

该计划的一些背景知识。它设置了一个带有 2 张候选人图片、一些说明和一个输入框的图形窗口，然后用户将缩写词放入输入框并单击其中一个候选人，它会显示票数等于然后输入的任何状态. 如果用户进入不在我的列表中的状态，我无法编写应该打印错误消息的异常处理程序。这是我遇到问题的代码部分：

```
 while True:
      vote = win.getMouse()
      voteX = vote.getX()
      voteY = vote.getY()
#Romney
      if voteX >= 163 and voteX <= 237 and voteY <= 100:
         enteredtext = entrybox.getText()
         enteredtextu = enteredtext.upper()
         for i, s in enumerate(STATE_LIST):
            if enteredtextu != s:
                print('Not a state')

            else:
                totalvotesr += STATE_VOTES[enteredtextu]
                votesnumr = ('VOTES:' ,totalvotesr)
                displayvotesr.setText(votesnumr)
                entrybox = Entry(Point(WINDOW_WIDTH/2, WINDOW_HEIGHT/1.1), 10)
                entrybox.draw(win)
                if totalvotesr >= 270:
                    circle_winner(win, Point(WINDOW_WIDTH/4, WINDOW_HEIGHT/12))
                    cross_out_loser(win, Point(WINDOW_WIDTH/(4/3), WINDOW_HEIGHT/12)) 
```

STATE_LIST 是所有 50 个状态的缩写列表。我试图做的是使用枚举并让它检查列表中所有项目的entereredtextu，如果它不存在，它将打印“不是状态”。我遇到的问题是，当我进入不在我列表中的状态时，它会打印 50 次“不是状态”，当我进入列表中的状态时，它会显示它应该显示的票数，而且打印“Not a state”50 次

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:49:44.417

您检查每个状态的名称是否与输入的文本匹配，因为该检查位于 for 循环内。所以你得到 'Not a state' 50（或 49）次是有道理的。

请尝试下面的代码。它只检查一次是否`enteredtextu`在状态列表中，并且只有在状态列表中时才进入查找投票数的循环。

```
...
enteredtext = entrybox.getText()
enteredtextu = enteredtext.upper()
if not enteredtextu in STATE_LIST:
    print 'Not a state'
else:
    for i, s in enumerate(STATE_LIST):
        # ... etc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:52:58.423

这是正在发生的事情。假设用户输入`AR`：

让我们开始“枚举”状态列表：

```
AK != AR ? Yup! print 'Not a state'
AL != AR ? Yup! print 'Not a state'
AR != AR ? Oh these are the same! Print the number of votes!
AZ != AR ? Yup! print 'Not a state'
... so on ... 
```

# javascript - clearRect 不会删除最后一行

> ID：13148042
> 
> 赞同：0
> 
> 时间：2012-10-30T21:46:10.767
> 
> 标签：javascript, html5-canvas, drawing

我画了两张图。一个说“1x10”，另一个说“10x10”。基本上，当用户点击图像时，我只是画一个正方形除以 9 条垂直线或同一个正方形除以 9 条水平线和 9 条垂直线。代码如下：

```
canvas.addEventListener('click',ProcessClick,false);
function ProcessClick(toi){
    var posx = toi.layerX;
    var posy = toi.layerY;
    if(toi.layerX == undefined || toi.layerY == undefined){
        posx = toi.offsetX;
        posy = toi.offsetY;
    }
    if(posx>170 && posx<320 && posy>320 && posy<370){
        rect1x10();
    }
    if(posx>470 && posx<620 && posy>320 && posy<370){
        rect10x10();
    }
}//ProcessClick

rect1x10 = function(){
    ctx.strokeStyle = "blue";
    ctx.fillStyle = "white";
    ctx.clearRect(200, 375, 355, 325);
    ctx.rect(240, 390, 300, 300);
    ctx.fill();
    ctx.lineWidth = 2;
    ctx.stroke();
    ctx.lineWidth = 1;
    var lineX = 270.5;
    for (i = 0; i <= 8; i++){
        ctx.beginPath();
        ctx.moveTo(lineX, 390);
        ctx.lineTo(lineX, 690);
        ctx.stroke();
        lineX += 30;
    }
}//rect1x10

rect10x10 = function(){
    ctx.strokeStyle = "blue";
    ctx.fillStyle = "white";
    ctx.clearRect(200, 375, 355, 325);
    ctx.rect(240, 390, 300, 300);
    ctx.fill();
    ctx.lineWidth = 2;
    ctx.stroke();
    ctx.lineWidth = 1;
    var lineX = 270.5;
    for (i = 0; i <= 8; i++){
        ctx.beginPath();
        ctx.moveTo(lineX, 390);
        ctx.lineTo(lineX, 690);
        ctx.stroke();
        lineX += 30;
    }
    var lineY = 420.5;
    for (i = 0; i <= 8; i++){
        ctx.beginPath();
        ctx.moveTo(240, lineY);
        ctx.lineTo(540, lineY);
        ctx.stroke();
        lineY += 30;
    }
}//rect10x10 
```

第一次单击任一图像时一切正常（细线，间隔良好），问题是绘制任一矩形时，下一个出现。例如： 1) 当先调用 1x10 再调用 10x10 时，最后一条垂直线较粗。2）当先调用 10x10 然后调用 1x10 时，最后一条水平线根本不会被擦除。如果我再次调用 1x10，最后一条水平线现在会被删除，但最后一条垂直线会变粗。

所有这些都只是一个图形参考，所以我可以轻松地显示一个正方形的图像，划分为 1x10 或 10x10 并解决问题。但是，我真的很想了解我做错了什么以供将来参考。提前感谢大家的支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:21:35.520

当你`stroke`使用矩形时，你会得到一条路径的残余。

先打电话`ctx.beginPath();`再打电话`rect`。

或者，或者，跳过所有这些并使用`strokeRect`

```
ctx.beginPath();
ctx.rect(240, 390, 300, 300);
ctx.lineWidth = 2;
ctx.stroke();
ctx.lineWidth = 1; 
```

或者

```
ctx.clearRect(200, 375, 355, 325);
ctx.lineWidth = 2;    
ctx.strokeRect(240, 390, 300, 300);   
ctx.lineWidth = 1; 
```

# python - 检测python / pygame中图像之间的差异

> ID：13148044
> 
> 赞同：2
> 
> 时间：2012-10-30T21:46:22.070
> 
> 标签：python, image-processing, pygame, raspberry-pi

我正在使用 Raspberry Pi（Running Rasbian Wheezy）进行艺术项目。我正在制作一个游戏中时光倒流，其中只有已更改的图像区域被替换。

当使用 alpha 通道从两个不同阵列的像素创建 PixelArray 以确定使用哪个像素时，处理器会被最大化并且运行速度非常慢：

```
 alphachannelarray = basearray.compare(imgarray, distance=0.08, weights=(0.01, 0.01, 0.01))

  alphachannel = alphachannelarray.make_surface()    

  for col in range (0, 800):
    for cell in range (0, 600):
      if alphachannelarray[col, cell] == alphachannel.map_rgb ((0,0,0)):
            imgarray[col, cell] = imgoldarray[col,cell] #if alpha channel is black use imgold pixel

      elif alphachannelarray[col, cell] == alphachannel.map_rgb ((255,255,255)):
            imgarray[col, cell] = imgarray[col][cell] #il alpha channel is white use img pixel 
```

pygame 中有没有办法比 for 循环更快地访问图像中的所有像素？

谢谢！-汤米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T01:08:45.817

我不知道完整的答案，但有一些想法/注释：

1.  我不确定你在用 alpha blitting 做什么。如果不需要 alpha，最好对图像的子矩形进行 blitting。我认为您正在保存一个“差异”的外部图像，让其他像素透明？

2.  尝试使用切片表示法来访问 PixelArray 而不是元组。`imgarray[x:y] = (255,255,0)`vs `imgarray[x, y] = (255, 255, 0)`incase 阻止使用 numpy 数组。更多示例： http: [//www.pygame.org/docs/ref/pixelarray.html#pygame.PixelArray](http://www.pygame.org/docs/ref/pixelarray.html#pygame.PixelArray)

3.  [PixelArray.compare (docs)](http://www.pygame.org/docs/ref/pixelarray.html#PixelArray.compare)使用阈值。您可能正在寻找没有阈值比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T20:47:34.577

You could just loop through the pixels and only change those that dont match, you dont have to keep redrawing transparent pixels over the other ones.

# objective-c - 在 iOS 上打开 App Store 和 iTunes 并转到默认页面，而不是特定的应用程序或项目

> ID：13148046
> 
> 赞同：0
> 
> 时间：2012-10-30T21:46:30.813
> 
> 标签：objective-c, ios, app-store, itunes

我正在尝试在 iOS 上打开 iTunes 和 App Store，但我不想转到特定应用程序的典型愿望，而是转到允许您兑换代码的部分。

首先，我希望能够只打开应用程序，而无需将它们定向到任一商店中的特定商品，即定向到特色页面、前 25 名等。

我得到的最接近的是使用 itms: 或 itms-apps: 没有任何额外的信息。这会提示用户一个错误，说商店不可访问，并将它们留在应用程序中的空白页面。这不是真正的错误，因为他们可以单击应用程序中的任何按钮，它只会加载fin。

链接的奖励积分可让他们直接从链接获取的位置输入兑换代码。

编辑：澄清，我没有让他们输入促销代码，用户将输入相当于他们提供的 iTunes 礼品卡代码的金额。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:54:29.387

可以链接到应用商店以及特殊应用和开发人员，但我找不到任何适合您的解决方案。特定促销代码的链接可能会对您有所帮助。无论如何，看看： [http ://bjango.com/articles/ituneslinks](http://bjango.com/articles/ituneslinks)

如果您有任何问题，请在下面写下评论。

# python - 如何在 python 中将 CSV 转换为更结构化的字典？

> ID：13148047
> 
> 赞同：0
> 
> 时间：2012-10-30T21:46:39.260
> 
> 标签：python

假设我有以下 CSV：

```
Type   Name        Application  

Vegetable   Lettuce    StoreA
Fruit       Apple      StoreB
Vegetable   Orange     StoreB
Fruit       Pear       StoreC
Dairy       Milk       StoreA
Fruit       Plum       StoreB
Fruit       Plum       StoreA 
```

python中是否有一些简单的方法可以让我根据我希望“折叠”的某些字段生成结构化的字典？例如，通过依次指定“类型”、“应用程序”、“名称”……它会创建一个只有三个键“蔬菜”、“水果”、“乳制品”的字典……

蔬菜只会有“StoreA”和“StoreB” Fruit 会有“Store B”和“Store C”（即使 Plum 在 Store B 中也没有重复的 Store B）

并且钻到字典的最深层次将是结果。实现这一目标的最佳方法是什么？语法受到赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:27:10.900

由于这似乎不是解析 CSV 的问题，我假设您可以使用[`csv.DictReader`](http://docs.python.org/2/library/csv.html#csv.DictReader)或其他方法将数据转换为以下格式：

```
rows = [{'Type': 'Vegetable', 'Name': 'Lettuce', 'Application': 'StoreA'},
        {'Type': 'Fruit', 'Name': 'Apple', 'Application': 'StoreB'},
        {'Type': 'Vegetable', 'Name': 'Orange', 'Application': 'StoreB'},
        {'Type': 'Fruit', 'Name': 'Pear', 'Application': 'StoreC'},
        {'Type': 'Dairy', 'Name': 'Milk', 'Application': 'StoreA'},
        {'Type': 'Fruit', 'Name': 'Plum', 'Application': 'StoreB'},
        {'Type': 'Fruit', 'Name': 'Plum', 'Application': 'StoreA'}] 
```

一旦你有了它，这里是创建你正在寻找的嵌套字典的一个选项：

```
result = {}
for row in rows:
    stores = result.setdefault(row['Type'], {})
    names = stores.setdefault(row['Application'], [])
    names.append(row['Name'])

>>> pprint.pprint(result)
{'Dairy': {'StoreA': ['Milk']},
 'Fruit': {'StoreA': ['Plum'],
           'StoreB': ['Apple', 'Plum'],
           'StoreC': ['Pear']},
 'Vegetable': {'StoreA': ['Lettuce'],
               'StoreB': ['Orange']}} 
```

您当然可以将`for`循环的内容放在一行中：

```
for row in rows:
    result.setdefault(row['Type'], {}).setdefault(row['Application'], []).append(row['Name']) 
```

# c# - Windows 8 App，将文本插入搜索魅力？

> ID：13148049
> 
> 赞同：1
> 
> 时间：2012-10-30T21:46:44.143
> 
> 标签：c#, windows-8, charms-bar

我想启用的用例是：

1.  用户在我的应用程序中突出显示了一些文本。
2.  用户单击搜索魅力。
3.  搜索魅力由突出显示的文本填充。
4.  用户点击 Bing 应用程序，由于搜索魅力魔法，该应用程序会自动显示第 1 步中的文本结果。

因此，我的应用程序方面唯一的工作是用一些文本填充“搜索”魅力框。有没有人找到办法做到这一点？或者有没有人发现这不能完成？

提前感谢您的任何建议，如果我能让这个问题更清楚，请告诉我！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T00:35:48.547

此代码将设置默认搜索文本：

```
Windows.ApplicationModel.Search.SearchPane searchPane =
     Windows.ApplicationModel.Search.SearchPane.GetForCurrentView();
searchPane.TrySetQueryText("default text"); 
```

您只需要将其连接到应用程序中的任何“文本选择”逻辑即可。

# java - Android ksoap嵌套soap对象给出无法读取请求错误

> ID：13148051
> 
> 赞同：2
> 
> 时间：2012-10-30T21:46:58.327
> 
> 标签：java, android, soap, ksoap2, android-ksoap2

我正在尝试使用 KSOAP 在 Android 上执行以下肥皂请求。它包含一个嵌套的肥皂对象列表。但是，当我收到错误消息时，我一定是做错了什么。

我试图生成的请求如下：

```
 <?xml version="1.0" encoding="utf-8"?>
<soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
  <soap12:Body>
    <SetAttendanceMarks xmlns="http://hostname.net/">
      <strSessionToken>string</strSessionToken>
      <LessonMarks>
        <Count>int</Count>
        <LessonMarks>
          <LessonMark>
            <StudentId>int</StudentId>
            <EventInstanceId>int</EventInstanceId>
            <Mark>string</Mark>
          </LessonMark>
          <LessonMark>
            <StudentId>int</StudentId>
            <EventInstanceId>int</EventInstanceId>
            <Mark>string</Mark>
          </LessonMark>
        </LessonMarks>
      </LessonMarks>
    </SetAttendanceMarks>
  </soap12:Body>
</soap12:Envelope> 
```

我的代码如下：

```
public boolean setAttendanceMarks(List<Mark> list) throws Exception
{
    boolean result = false;

    String methodName = "SetAttendanceMarks";
    String soapAction = getHost() + "SetAttendanceMarks";

    SoapObject lessMarksN = new SoapObject(getHost(), "LessonMarks");

    for (Mark m : list)
    {
        PropertyInfo smProp =new PropertyInfo();
        smProp.setName("LessonMark");
        smProp.setValue(m);
        smProp.setType(Mark.class);

        lessMarksN.addProperty(smProp);
    }

    PropertyInfo cProp =new PropertyInfo();
    cProp.setName("Count");
    cProp.setValue(list.size());
    cProp.setType(Integer.class);

    SoapObject lessMarks = new SoapObject(getHost(), "LessonMarks");
    lessMarks.addProperty(cProp);
    lessMarks.addSoapObject(lessMarksN);

    PropertyInfo sProp =new PropertyInfo();
    sProp.setName("strSessionToken");
    sProp.setValue(mSession);
    sProp.setType(String.class);

    SoapObject request = new SoapObject(getHost(), methodName); 
    request.addProperty(sProp);
    request.addSoapObject(lessMarks);

    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER12);
    envelope.dotNet = true;
    envelope.setOutputSoapObject(request);

    HttpTransportSE androidHttpTransport = new HttpTransportSE(getURL());
    androidHttpTransport.debug = true;

    androidHttpTransport.call(soapAction, envelope);

    String a = androidHttpTransport.requestDump;
    String b = androidHttpTransport.responseDump;

    SoapObject resultsRequestSOAP = (SoapObject) envelope.bodyIn; 

    SoapObject res = (SoapObject) resultsRequestSOAP.getProperty(0);

    String resultStr = res.getPropertyAsString("Result");

    if (resultStr.contentEquals("OK"))
    {
        result = true;
    }

    return result;
} 
```

我得到的错误如下：

```
 <?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<soap:Body>
<soap:Fault>
<soap:Code>
<soap:Value>soap:Sender</soap:Value>
</soap:Code>
<soap:Reason>
<soap:Text xml:lang="en">Server was unable to read request. ---&gt; There is an error in XML document (1, 383). ---&gt; The specified type was not recognized: name='LessonMarks', namespace='http://gsdregapp.net/', at &lt;LessonMarks xmlns='http://gsdregapp.net/'&gt;.</soap:Text>
</soap:Reason>
<soap:Detail />
</soap:Fault>
</soap:Body>
</soap:Envelope> 
```

谁能告诉我我做错了什么？我将不胜感激任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T13:44:56.113

您的 ws 服务器无法识别您正在使用的名称空间。

```
SoapObject request = new SoapObject(getHost(), methodName); 
```

看起来应该是这样的：

```
SoapObject request = new SoapObject("http://hostname.net/", methodName); 
```

确保 getHost() 和 getURL() 正在检索相同的主机名，因为主机在 getURL() 上期望的命名空间与 getHost() 发送的不同。

如果您不确定要使用哪个命名空间，请使用 SoapUI 轻松读取 wsdl 并找到正确的命名空间

# python - 具有非常大矩阵的 NumPy 中的线性回归 - 如何节省内存？

> ID：13148052
> 
> 赞同：4
> 
> 时间：2012-10-30T21:47:10.313
> 
> 标签：python, numpy

所以我有这些巨大的矩阵 X 和 Y。X 和 Y 都有 1 亿行，X 有 10 列。我正在尝试用这些矩阵实现线性回归，我需要数量`(X^T*X)^-1 * X^T * Y`。我怎样才能尽可能节省空间地计算它？

现在我有

```
X = readMatrix("fileX.txt")
Y = readMatrix("fileY.txt")
return (X.getT() * X).getI() * X.getT() * Y 
```

这里有多少矩阵存储在内存中？是否同时存储两个以上的矩阵？有更好的方法吗？

我有大约 1.5 GB 的内存用于这个项目。如果我关闭所有其他程序，我可能可以将其拉伸到 2 或 2.5。理想情况下，该过程也会在很短的时间内运行，但内存限制更加严格。

我尝试过的另一种方法是将计算的中间步骤保存为文本文件，并在每一步后重新加载它们。但这很慢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T00:42:50.963

X 的大小是 100e6 x 10 Y 的大小是 100e6 x 1

所以最终大小`(X^T*X)^-1 * X^T * Y`是 10 x 1

您可以通过以下步骤计算它：

1.  计算`a = X^T*X`-> 10 x 10
2.  计算`b = X^T*Y`-> 10 x 1
3.  计算`a^-1 * b`

第 3 步中的矩阵非常小，因此您只需要执行一些中间步骤即可计算 1 和 2。

例如，您可以读取 X 和 Y 的第 0 列，并通过`numpy.dot(X0, Y)`.

对于 float64 dtype，X0 和 Y 的大小约为 1600M，如果无法容纳内存，您可以分别调用 numpy.dot 两次 X0 & Y 的前半部分和后半部分。

所以计算`X^T*Y`你需要调用 numpy.dot 20 次，计算`X^T*X`你需要调用 numpy.dot 200 次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-12T21:07:53.127

普通最小二乘回归的一个简洁属性是，如果您有两个数据集 X1、Y1 和 X2、Y2，并且您已经计算了所有

*   X1' * X1
*   X1' * Y1
*   X2' * X2
*   X2' * Y2

你现在想要对组合数据集 X = [X1; 进行回归。X2] 和 Y = [Y1; Y2]，您实际上不必重新计算太多。关系

*   X' * X = X1' * X1 + X2' * X2
*   X' * Y = X1' * Y1 + X2' * Y2

持有，所以有了这些计算，你只需计算

*   β = inv(X' * X) * (X' * Y)

你就完成了。这导致了一个在非常大的数据集上用于 OLS 的简单算法：

*   加载部分数据集（例如，前一百万行）并计算 X' * X 和 X' * Y（它们是非常小的矩阵）并存储它们。
*   继续对接下来的一百万行执行此操作，直到处理完整个数据集。
*   将您存储的所有 X' * Xs 和 X' * Ys 加在一起
*   计算 beta = inv(X' * X) \ (X' * Y)

这并不比一次加载整个数据集慢得多，而且它使用的内存要少得多。

*最后一点：*你不应该通过首先计算 (X' * X) 并找到它的逆来计算 beta（有两个原因 - 1\. 它很慢，2\. 它容易出现数值错误）。

相反，您应该解决线性系统 -

*   (X' * X) * 贝塔 = X' * Y

在 MATLAB 中，这是一个简单的单行

```
beta = (X' * X) \ (X' * Y); 
```

我希望 numpy 具有类似的解决线性系统的方法，而无需反转矩阵。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T22:11:17.520

RAM 相当便宜——你应该考虑投资。具有 24 Gig RAM 的系统不再需要花费一臂之力 - 戴尔的低端服务器之一可以容纳这么多。

如果矩阵是稀疏的（很多零），请使用稀疏矩阵类来节省大量 RAM。

如果矩阵不是稀疏的，您要么需要更多 RAM（或至少更多虚拟内存），要么使用磁盘文件进行矩阵运算。

磁盘文件当然比 RAM 慢一个数量级，并且根据您的访问模式，颠簸您的虚拟内存系统实际上可能比这更糟。

# c++ - 结构 C++ 的深拷贝

> ID：13148053
> 
> 赞同：1
> 
> 时间：2012-10-30T21:47:15.037
> 
> 标签：c++, struct

假设我有一个结构：

```
struct TrieNode {
const NumChars = 26;
bool isWord;
int letterCount;
TrieNode *letters[NumChars];

TrieNode() {
    isWord = false;
    for ( int i = 0; i < NumChars; i += 1 ) {
        letters[i] = NULL;
    } // for
    letterCount = 0;
 }
}; 
```

我在堆上创建了一个 TrieNode，如下所示：

```
TrieNode *root = new TrieNode(); 
```

现在如何创建不同的根副本？（深拷贝）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T21:50:30.540

在 C++ 中，您可以定义一个自定义的“复制构造函数”。它将是以下形式：

```
TrieNode(const TrieNode& copyFrom){
  //Do the copying here
} 
```

然后，您可以随心所欲地使用它：

```
TrieNode example;
TrieNode deep(example);
TrieNode deep2 = example; 
```

如果您想定义一个复制构造函数，您可能还想定义一个析构函数和一个赋值运算符。这被称为[3 法则](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)。

如果您实现了赋值运算符 ( `=`)，那么您还可以编写如下代码：

```
TrieNode example;
TrieNode deep;
//Do stuff
deep = example; //Still a deep copy. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T22:08:44.773

```
struct TrieNode {
   static const NumChars = 26;
   bool isWord;
   int letterCount;
   TrieNode *letters[NumChars];

   TrieNode() : isWord(false), letterCount(0) {
      for ( int i = 0; i < NumChars; i += 1 ) {
         letters[i] = NULL;
      } // for
   }
   TrieNode(const TrieNode &other)
       : isWord(other.isWord), letterCount(other.letterCount)
   {
      for ( int i = 0; i < NumChars; ++i ) {
         if (other.letters[i]) {
            letters[i] = new TrieNode(other.letters[i]);
         } else {
            letters[i] = NULL;
         }
      }
   }
};

TrieNode *root = new TrieNode();
TrieNode *deepcopy = new TrieNode(*root); 
```

这是一个递归数据结构，所以你需要一个递归复制算法。请注意我创建的复制构造函数如何调用自身来创建子节点？

恕我直言，这东西有几个设计缺陷。但是您并没有要求修复它们，您只是询问如何对其进行深层复制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T21:53:59.290

您编写一个递归例程来进行复制。即一个例程，它复制`isWord`然后`letterCount`在每个非 NULL 元素上递归调用自身`letters`。您可以将此例程设置为复制构造函数，也可以不设置。任何对您的其余代码最有意义的东西。

# ruby - 在抽象层中使用 Test::Unit

> ID：13148057
> 
> 赞同：0
> 
> 时间：2012-10-30T21:47:24.253
> 
> 标签：ruby, selenium-webdriver, testunit, pageobjects

有没有办法从对象内部调用断言？我正在编写 Selenium 测试并使用测试单元进行断言和轻松报告。我在顶级测试（扩展 Test::Unit::TestCase 的类）和 selenium webdriver 之间有一个抽象层。我有我的抽象层负责页面上的所有项目，如果抽象层发现的东西与预期不同，我需要一种方法让顶层测试停止。如果我可以从这个抽象层内部调用一个 Test::Unit 断言，那将是理想的。如果有任何关于如何更好地实现这一点的建议，我愿意接受建议。谢谢，扎克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:56:26.823

`Test::Unit::Assertions`您可以通过包含模块从抽象层中调用 Test::Unit 断言。

所以你的代码可能看起来像：

```
require 'test/unit'

class MyPageObject
    include Test::Unit::Assertions

    def initialize()
        assert(false, 'abstraction layer found something wrong')
    end
end

class MyTest < Test::Unit::TestCase
    def test_1()
        page = MyPageObject.new
        assert(false, 'test found something wrong')
    end
end 
```

该`include Test::Unit::Assertions`行将使您的 MyPageObject 类（我相信这就是您所称的抽象层）访问 Test::Unit 断言。

在上面的示例中，MyPageObject 类中的断言将失败，导致 test_1 失败。

使用此解决方案时我遇到的唯一问题是报告完成的断言数量（见 Test::Unit 报告的末尾）。该数字不包括在抽象层中所做的断言。但是，我还没有看到这个数字有足够的价值值得研究。

# r - Gnu R绘图标题中的化学公式+文本

> ID：13148059
> 
> 赞同：1
> 
> 时间：2012-10-30T21:47:47.187
> 
> 标签：r, symbols

如何在情节标题中写 H2o？

多亏了这个[提示](https://stackoverflow.com/q/13147591/1749675)，我可以在标题中包含一个简单的化学式

```
plot(main=expression(H[2]*O),0) 
```

这里的真正公式要复杂一些，我想将它们缩写并在需要的地方添加到文本中。但这失败了：

```
h2o <- expression(H[2]*O)
plot(main=paste(h2o, "in the air"),0) # paste fails here :( 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T00:36:35.507

这是一种方法，可让您将化学式包含在变量中。

```
# note that .formula is either an expression or a character
# string that would define a valid expression
maketitle <- function(.formula, .other){
  .expression <- sprintf('%s ~ "%s"',as.character(.formula), .other)
  evalq(parse(text = .expression))
}

f <- expression(H[2]*O)
o <- 'blah blah'

plot(1:10, main = maketitle(f, o)) 
```

牢记危险`eval(parse(text = ...))`，

> 就我个人而言，我从不后悔试图不低估自己未来的愚蠢。-- Greg Snow（解释为什么 eval(parse(...)) 经常不是最理想的，回答一个由臭名昭著的 fortune(106) 引发的问题）R-help（2007 年 1 月）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:52:30.663

你要

```
plot(1:10, main = expression(H[2] * O ~ "in the air")) 
```

或者

```
plot(1:10, main = expression(H[2] * O ~ "in" ~ the ~ air)) 
```

（`in`需要引用，因为它是解析器首先捕获的 R 语法的一部分，如`for(i in 1:10)`.）

重要的一点是`x ~ y`符号的位置`x`和`y`彼此相邻的分隔。**请**阅读`?plotmath`！

重点是，您在此处提供的任何内容都必须是由`expression()`. 通常，您不需要`paste()` *在*表达式中，因为您可以在 plotmath 表达式中包含字符串。

# mysql - 根据左连接中的列值计算行数

> ID：13148060
> 
> 赞同：0
> 
> 时间：2012-10-30T21:47:54.003
> 
> 标签：mysql, join, if-statement, group-by, having-clause

对于一个网站（旅行社），我正在努力提高性能。目前我正在优化搜索模块。除其他外，我想优化一个包含目的地的选择框。系统中有多个目的地，但并非所有目的地都有可预订的住宿。所以我想要至少有 1 个住宿的目的地列表。目的地表（表名：geodata）包含 4 种类型：Country、Area、Region 和 City。由于（某种*）开发不当，住宿表包含 4 个外键（fk_country、fk_area、fk_region 和 fk_city）。* 由于每次开发功能时的增长和传入需求。

我已经尝试了以下基于 IF 语句的左连接。但是这个查询只完成了一半的工作。我最感兴趣的是给定国家、地区、地区或城市的住宿数量。此时我只得到住宿的总数。如何调整此查询以正确获取给定位置类型的住宿数量。

我的查询：

```
SELECT      geodata.id, 
            geodata.type,
            COUNT(accommodation.id) AS count_accommodations
FROM        geodata
LEFT JOIN   accommodation
ON          IF(geodata.type = 'Country', accommodation.fk_country,
                IF(geodata.type = 'Area', accommodation.fk_area,
                    IF(geodata.type = 'Region', accommodation.fk_region, accommodation.fk_city)
                )
            )
GROUP BY    geodata.id
HAVING      count_accommodations > 0 
```

电流输出：

```
|id|type   |count_accommodations|
---------------------------------
| 1|Country|                   2|
| 2|Area   |                   2|
| 3|Area   |                   2| 
```

预期产出

```
|id|type   |count_accommodations|
---------------------------------
| 1|Country|                   2|
| 2|Area   |                   1|
| 3|Area   |                   1| 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:10:22.510

它不起作用，因为您没有加入条件。你所做的是，评估一个外键（fk_country，fk_area，...），但你不在任何地方使用它。

```
...
left join accommodation
on (... fk_...) = geodata.???
group by geodata.id
... 
```

# c - 编写循环的更简单方法

> ID：13148061
> 
> 赞同：3
> 
> 时间：2012-10-30T21:47:59.027
> 
> 标签：c, loops, while-loop

你好写了一个程序，比这个要好；

0

01

012

0123

01234

012345

01234

0123

012

01

0

我很确定我的方法又长又愚蠢，这就是它的样子

```
#include <stdio.h>

int main(void)
{

int first = -1, second = -1, third = -1, fourth = -1, fifth = -1, sixth = -1, seventh = -1, eight = -1, nine = -1, ten = -1, elleven = -1;

while(first < 0){
first += 1; 
printf("%d\n", first);

while(second < 1){
second += 1;
printf("%d", second);
}
printf("\n");
while(third < 2 ){
third += 1;
printf("%d", third);
}
printf("\n");
while(fourth < 3){
fourth += 1;
printf("%d", fourth);
}
printf("\n");
while(fifth < 4){
fifth += 1;
printf("%d", fifth);
}
printf("\n");
while(sixth < 5){
sixth += 1;
printf("%d", sixth);
}
printf("\n");
while(seventh < 4){
seventh += 1;
printf("%d", seventh);
}
printf("\n");
while(eight < 3){
eight += 1;
printf("%d", eight);
}
printf("\n");
while(nine < 2) {
nine += 1;
printf("%d", nine);
}
printf("\n");
while(ten < 1){
ten += 1;
printf("%d", ten);
}
printf("\n");
while(elleven < 0){
elleven += 1;
printf("%d", elleven); 
}
}

return 0;
} 
```

如果有人愿意告诉我如何更容易地做到这一点？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:05:23.447

这些产生三角形输出的问题在数学上接近它们时总是最简单的。考虑绝对值函数（例如：`|x|`或`abs(x)`）。

```
#include <stdio.h>
#include <stdlib.h>
#define LARGEST_NUMBER (5)
#define MAX_VAL (LARGEST_NUMBER+1)

int main(void) {
   int i,j;
   for(i=0; i<2*MAX_VAL; i++) {
      for(j=0; j<MAX_VAL-abs(MAX_VAL-i); j++) {
         printf("%d",j);
      }
      printf("\n");
   }
   return 0;
} 
```

输出：

```
0
01
012
0123
01234
012345
01234
0123
012
01
0 
```

我觉得这是解决这类问题在数学上最简洁的方法。我过去曾为学生提供过这个确切的问题，并坚持使用该`abs()`函数的解决方案使该函数`factored`尽可能重（即：最少数量的循环、变量、代码行和函数调用）。

这是关于数学函数本身的维基文章：

[http://en.wikipedia.org/wiki/Absolute_value#Absolute_value_function](http://en.wikipedia.org/wiki/Absolute_value#Absolute_value_function)

享受！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:54:43.443

好吧，我注意到您有一个字符串，其长度从 1 到 6 不等，然后返回，其中包含从 0 到其长度被排除的符号。

所以我们可以用两个循环来做到这一点，一个升序，一个降序，都嵌套以获取所有符号。

```
 int i, j;

    for (i = 0; i < 6; i++)
    {
            for (j = 0; j <= i; j++)
                    printf("%d", j);
            printf("\n");
    }
    for (i = 5; i > 0; i--)
    {
            for (j = 0; j < i; j++)
                    printf("%d", j);
            printf("\n");
    } 
```

第二个`for`可以替换为`while(--i)`, 因为`i`从上一个周期的末尾开始。

输出：

```
0
01
012
0123
01234
012345
01234
0123
012
01
0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:55:47.450

这是我的尝试：

```
int main()
{
    int i, j;
    for (i = 0; i <= 5; ++i) {
        for (j = 0; j <= i; ++j)
            printf("%d", j);

        printf("\n");
    }

    for (i = 4; i >= 0; --i) {
        for (j = 0; j <= i; ++j)
            printf("%d", j);

        printf("\n");
    }

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T22:34:21.600

这是使用**while 循环**的版本。

```
#include <stdio.h>
#define MAX 5

int main()
{
    int j=0, m=0, dec=0;
    while( m>=0 && m<=MAX)
    {
        for (j = 0; j <= m; j++)
             printf("%d", j);
        printf("\n");

        if (m==MAX)
            dec = 1; // once hit MAX, chg inc to dec

        (dec)? m--: m++;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T21:54:34.190

代替 N 循环使用单个循环，一旦最后一个计数器运行超过其限制，该循环将重置其计数器和限制。当一个旧循环结束时，插入一个换行符，将计数器设置回 -1，并增加限制（您要测试计数器的变量）。

# android - 使用 AlarmClock 类的重复报警

> ID：13148062
> 
> 赞同：1
> 
> 时间：2012-10-30T21:48:00.217
> 
> 标签：android, clock, alarm, repeatingalarm

我们可以使用 AlarmClock 类在默认时钟应用程序中设置闹钟。有没有办法使用此 AlarmClock 类设置每天或特定日期重复的重复闹钟？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:57:57.207

不幸的是没有。正如您在文档中看到[的`AlarmClock`那样](http://developer.android.com/reference/android/provider/AlarmClock.html)，它只允许您指定（一组）`EXTRA_HOUR`、、`EXTRA_MESSAGE`和`EXTRA_MINUTES`（您可以使用 跳过默认 UI `EXTRA_SKIP_UI`）。

是的，这对我来说似乎也很愚蠢。我的建议是注册某种广播接收器或意图在您的警报响起后的某个时间被触发，然后根据需要重新设置。虽然这是一个不太理想的答案，但我认为这是你能做到的最好的。

您可能希望将其作为一项功能进行请求（请阅读[Life of a Bug](http://source.android.com/source/life-of-a-bug.html)及其链接文章了解更多信息），尽管这只会将其添加到未来的版本中，而不是过去的版本中。

# c++ - 我可以从 Windows SEH 异常中解码 C++ 异常吗？（如果是这样，怎么做？）

> ID：13148065
> 
> 赞同：16
> 
> 时间：2012-10-30T21:48:14.633
> 
> 标签：c++, winapi, visual-c++, exception

如果发生未处理的 C++ 异常，我想打印：

1.  `what()`C++ 异常的消息 ( )
2.  堆栈跟踪。

为了获取堆栈跟踪，我`SetUnhandledExceptionFilter`结合使用[StackWalker](http://www.codeproject.com/Articles/11132/Walking-the-callstack)库：

```
struct FooStackWalker : StackWalker
{
    virtual void OnCallstackEntry(CallstackEntryType, CallstackEntry &entry) override
    {
        std::cerr << entry.lineFileName << " (" << entry.lineNumber << "): " << entry.undFullName << std::endl;
    }
};

LONG WINAPI UnhandledExceptionHandler(LPEXCEPTION_POINTERS pointers)
{
    FooStackWalker walker;
    walker.ShowCallstack(::GetCurrentThread(), pointers->ContextRecord);
    ::TerminateProcess(::GetCurrentProcess(), 1);
}

int main()
{
    ::SetUnhandledExceptionFilter(UnhandledExceptionHandler);
} 
```

我已经让堆栈跟踪打印得很好，但现在`what`很难。

有什么方法可以将 SEH 异常解码为 C++ 异常，以便在终止之前调用此成员函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-04T20:15:51.240

为什么不使用已经为您提供异常详细信息的 C++ 机制？它不是 SEH 过滤器独有的（尽管它*是*独有的`SetUnhandledExceptionFilter`）。您只需要正确嵌套处理程序：

```
int main()
{
    try {
        return cppexcept_main();
    }
    catch (const std::exception& e)
    {
        //use e.what()
    }
}

int cppexcept_main()
{
    __try {
        return application_main();
    }
    __except(GrabStackTrace(GetExceptionInformation()), EXCEPTION_CONTINUE_SEARCH) {
         /* never reached due to EXCEPTION_CONTINUE_SEARCH */
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T22:38:17.757

**编辑**：我误解了你的问题。我不能确定 C++ 异常的答案是什么，但我有理由确定答案是“否”。我不相信有任何方法可以区分由 SEH 引起的未处理异常（例如访问冲突）和未捕获的 C++ 异常，也没有任何方法可以区分不同类型的 C++ 异常。那匹马已经在那匹马上离开了谷仓。

原答案如下：

* * *

不，因为 SEH 异常没有`what`. 它不是一个`std::exception`. [这个 MSDN 示例](http://msdn.microsoft.com/en-us/library/de5awhsw%28v=vs.100%29.aspx)说，当您尝试将 SEH 异常作为 C++ 异常捕获时，只能使用省略号 ( `...`)`catch`处理程序来捕获它。您可以使用[`_set_se_translator`](http://msdn.microsoft.com/en-us/library/5z4bw5h5%28v=vs.100%29.aspx)定义自己的函数将 SEH 异常转换为 C++ 异常，但此时您只是`what`从不同位置的相同信息生成自己的函数（即使那样，我也不知道它是否会是可以从`UnhandledExceptionFilter`) 得到它。

您拥有[`LPEXCEPTION_POINTERS`结构](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363082%28v=vs.85%29.aspx)中所需的所有信息。如果发生访问冲突，`pointers->ExceptionRecord->ExceptionCode`则为`EXCEPTION_ACCESS_VIOLATION`(0xC0000005)。如果发生这种情况，那么您可以检查`NumberParameters`和`ExceptionInformation`变量以确定它是读取还是写入违规以及尝试访问的地址。

# git - 警告：push.default 未设置；它的隐含价值在 Git 2.0 中正在发生变化

> ID：13148066
> 
> 赞同：1648
> 
> 时间：2012-10-30T21:48:16.023
> 
> 标签：git, version-control, git-push

我使用 Git 已经有一段时间了，最​​近下载了一个更新，但当我尝试`push`.

```
warning: push.default is unset; its implicit value is changing in 
Git 2.0 from 'matching' to 'simple'. To squelch this message 
and maintain the current behavior after the default changes, use: 

  git config --global push.default matching

To squelch this message and adopt the new behavior now, use: 

  git config --global push.default simple 
```

我显然可以将其设置为提到的值之一，但它们是什么意思？`simple`和有什么区别`matching`？

如果我在一个客户上更改它，我是否需要在与我共享 repos 的其他客户上做任何事情？

* * *

## 回答 #1

> 赞同：2163
> 
> 时间：2012-10-30T22:11:49.733

[文档](https://git-scm.com/docs/git-config.html#git-config-pushdefault)中对此进行了非常详细的解释，但我将尝试总结一下：

*   `matching`意味着`git push`会将**您所有的本地分支推**送到远程上具有相同名称的分支。这使得意外推送您不打算的分支很容易。

*   `simple`意味着`git push`只会**将当前分支推送到`git pull`将从中拉出**的分支，并检查它们的名称是否匹配。这是一种更直观的行为，这就是为什么将默认值更改为此的原因。

此设置仅影响本地客户端的行为，并且可以通过在命令行上明确指定要推送的分支来覆盖。其他客户端可以有不同的设置，**它只会影响当你没有指定要推送的分支时发生的情况**。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-10-26T17:00:05.747

我意识到这是一篇旧帖子，但是当我遇到同样的问题并且找不到答案时，我想我会补充一点。

所以@hammar 的回答是正确的。在某种程度上，使用`push.default simple`is，就像在您的分支上配置跟踪一样，因此您在推拉时不需要指定遥控器和分支。该`matching`选项会将所有分支推送到默认远程上的相应对应部分（这是第一个设置的分支，除非您已另外配置存储库）。

我希望其他人在未来发现有用的一件事是我在 OS X Mountain Lion 上运行 Git 1.8 并且从未见过这个错误。升级到 Mavericks 是它突然出现的原因（运行`git --version`将显示`git version 1.8.3.4 (Apple Git-47)`在更新操作系统之前我从未见过的东西。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-01-31T15:35:00.327

如果您从 git 收到一条消息，抱怨配置中的值 'simple'，请检查您的 git 版本。

升级 Xcode（在运行 Mountain Lion 的 Mac 上）后，也将 git 从 1.7.4.4 升级到 1.8.3.4，升级前启动的 shell 仍在运行 git 1.7.4.4 并抱怨 push.default 的值“简单”全局配置。

解决方案是关闭运行旧版本 git 的 shell 并使用新版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-03-19T13:10:12.760

我想知道为什么我在 Ubuntu 16.04（Git 2.7.4 附带）上收到了这么大的警告消息，但在 Arch Linux 上却没有。[原因是在Git 2.8](https://github.com/git/git/blob/v2.8.0/Documentation/RelNotes/2.8.0.txt)（2016 年 3 月）中删除了警告：

> 在 Git 2.0 版左右的过渡期间，用户在没有设置 push.default 配置变量的情况下运行“git push”时会收到非常响亮的警告。我们不再发出警告，因为过渡已在很久以前完成。

因此，如果您有 Git 2.8 及更高版本并且不需要设置`push.default`，除非您想更改默认`'simple'`行为，否则您不会看到警告。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-27T14:01:11.533

**从其他可能重复关闭的线程中带来了我的答案...**

来自 GIT 文档：[Git Docs](http://git-scm.com/docs/git-config)

下面给出了完整的信息。简而言之，只有当它在遥控器上也有相同的名称时`simple`才会推送。`current working branch`这对初学者来说是一个很好的设置，并将成为默认设置`GIT 2.0`

而`matching`将在本地推送*所有*在远程具有相同名称的分支。（不考虑您当前的工作分支）。这意味着可能会推送许多不同的分支，包括那些您甚至可能不想共享的分支。

在我个人的使用中，我通常使用不同的选项：`current`推送当前的工作分支，（因为我总是分支以进行任何更改）。但对于初学者，我建议`simple`

> push.default
> 定义如果没有明确给出 refspec，git push 应该采取的行动。不同的值非常适合特定的工作流程；例如，在纯粹的中央工作流程中（即获取源等于推送目标），上游可能是您想要的。可能的值为：
> 
> nothing - 除非明确给出 refspec，否则不要推送任何内容（错误输出）。这主要适用于希望通过始终明确来避免错误的人。
> 
> current - 推送当前分支以更新接收端同名的分支。适用于中央和非中央工作流程。
> 
> 上游 - 将当前分支推回其更改通常集成到当前分支中的分支（称为@{upstream}）。此模式仅在您推送到通常会从中提取的同一存储库（即中央工作流程）时才有意义。
> 
> 简单 - 在集中式工作流程中，如果上游分支的名称与本地分支的名称不同，则可以像上游一样工作，并增加安全性以拒绝推送。
> 
> 当推送到与您通常从中拉出的遥控器不同的遥控器时，作为当前工作。这是最安全的选择，适合初学者。
> 
> 此模式将成为 Git 2.0 中的默认模式。
> 
> 匹配 - 在两端推送所有具有相同名称的分支。这使您推送的存储库记住将被推出的一组分支（例如，如果您总是将 maint 和 master 推送到那里而没有其他分支，那么您推送到的存储库将具有这两个分支，以及您的本地 maint 和 master将被推到那里）。
> 
> 要有效地使用此模式，您必须确保在运行 git push 之前您将推出的所有分支都准备好推出，因为此模式的重点是允许您一次推送所有分支。如果您通常只在一个分支上完成工作并推出结果，而其他分支未完成，则此模式不适合您。此外，此模式不适合推送到共享的中央存储库，因为其他人可能会在那里添加新分支，或者更新您无法控制的现有分支的尖端。
> 
> 这是目前的默认设置，但 Git 2.0 会将默认设置更改为简单。

# javascript - 将Javascript代码放在字符串中？

> ID：13148067
> 
> 赞同：2
> 
> 时间：2012-10-30T21:48:16.283
> 
> 标签：javascript, string, module

我正在尝试能够将 Javascript 代码放在字符串中（在 Javascript 中）。我正在使用自己的 gruntjs 任务来读取所有 javascript 文件并将其放在字符串中。

`var modules = []; modules['filename.js'] = "code here...."`

这适用于简单的 Javascript 类，但是当以这种格式（JQuery、Ember.js、Underscore）放置外部库时，它将失败。我`"`将代码中的每个替换为`\"`. 但我仍然遇到语法错误。我认为这可能与某些 RegEx 有关，或者在某些部分他们可能已经转义了一些双引号。

**编辑：**代码在这里找到：[https](https://github.com/TheHydroImpulse/resolve.js) ://github.com/TheHydroImpulse/resolve.js 但具体构建脚本（gruntjs）在这里：[https ://github.com/TheHydroImpulse/resolve.js/blob/master/示例/基本/grunt.js](https://github.com/TheHydroImpulse/resolve.js/blob/master/examples/basic/grunt.js)

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:59:05.870

为了保持 JS 代码的完整性，您必须在将其存储为字符串之前对其进行编码，并在使用之前对字符串进行解码。

这两种操作都可以使用内置的 JavaScript 函数[encodeURIComponent()](http://www.w3schools.com/jsref/jsref_encodeuricomponent.asp)和[decodeURIComponent()来执行](http://www.w3schools.com/jsref/jsref_decodeuricomponent.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:54:48.887

这里黑暗中的狂野刺伤（一个小时前刚刚成为万圣节）但也许你没有把它全部放在一行中，因此没有正确处理多行字符串......

或者，也许您将文件压缩成一行，而不是在必要时添加分号。

我建议您使用缩小工具，如 uglify，然后将库作为单行缩小的 javascript 进行尝试。

# java - 限制线程访问给定的块代码

> ID：13148070
> 
> 赞同：1
> 
> 时间：2012-10-30T21:48:25.900
> 
> 标签：java, multithreading

我最近正在使用`Java Threads`并且我正在尝试实现一种能够限制代码块只能由一个线程执行的方法，我们称之为“单线程”。

我已经实现的一个天真的解决方案如下：

```
if(readFlag())
{
  synchronized(this)
  {
  flag = false;  
  // do some work
  }
} 
```

在哪里 ：

```
public Boolean synchronized readFlag() {return flag;} 
```

这种幼稚的解决方案仅适用于一个“单个”块，但是当我尝试使用多个“单个”代码块时会出现问题。由于我不能使用相同的标志，因为不同的线程可能会同时输入不同的“单个”代码块。

另一种解决方案可能是为每个“单个”使用一个标志变量数组，但是该解决方案在循环内执行“单个”代码块时会出现问题（或需要使用障碍），而且不是很灵活。

我的问题是：

我如何改进此解决方案以允许执行各种“单个”代码块并允许多次执行相同的单个代码块（例如循环内的单个代码块）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T21:51:29.177

您可以更改同步对象。`this`除非您需要，否则无需在 上同步。如果您有两个需要同步但可以同时执行的块（每个块只能由一个线程执行），您可以执行类似的操作

```
private final Object lock1 = new Object();
private final Object lock2 = new Object();
...
synchronized(lock1) { // do stuff. the code in lock2 can be executed while another thread is executing this }
synchronized(lock2) { // do stuff. the code in lock1 can be executed while another thread is executing this } 
```

另请查看[ReentrantReadWriteLock](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html)以获得更复杂的锁定（以允许多个读取器但只允许一个写入器）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T22:20:21.200

在过去的几天里，我遇到了类似的问题。在我的情况下，我必须在 ConcurrentMap 中执行清理任务，并且每 10 分钟只有一个线程应该执行该任务。我不需要同步，因为 ConcurrentMap 迭代器保证不会抛出 ConcurrentModificationException。为了确保只有一个线程会执行清理任务，我使用了 AtomicBoolean：

```
AtomicBoolean flag = new AtomicBoolean(false);
...

boolean proceed = flag.compareAndSet(false , true);
if(proceed){
   doStuff();
   flag.set(false);
} 
```

所以这避免了在布尔标志上同步。根据要同步的不同代码段，我同意 Jeff 的观点。你可以在不同的对象上同步。

# objective-c - Mac 编程：在应用程序中获得突出显示的文本？

> ID：13148075
> 
> 赞同：0
> 
> 时间：2012-10-30T21:48:47.263
> 
> 标签：objective-c, macos

我想通过制作一个简单的后台应用程序来尝试一些 Mac 编程，该应用程序记录用户在其他应用程序中突出显示的文本的所有历史记录，无论是 PDF、word 文档还是网页（听起来很傻，但对我来说非常有用）。是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:16:11.950

在一般情况下这是不可能的，即使一次考虑一个应用程序也非常棘手。对于某些使用代码注入的应用程序可以实现（但这非常脆弱），并且对于使用 AppleScript 的某些应用程序理论上可以实现（但前提是该应用程序可以帮助您）。

更常见的是创建[服务](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/SysServices/Articles/menu.html)，它允许您与其他应用粘贴板集成（通过用户干预）。但几乎没有应用程序将 API 暴露给它们的突出显示。

* * *

@nielsbot 提出了一个有趣的问题，也许这是一种方法。您将调用`AXUIElementCreateSystemWide`创建一个系统范围的可访问性对象，然后将自己添加为等待的观察者`kAXSelectedTextChangedNotification`。这可能适用于可访问的应用程序（大多数使用标准小部件的应用程序）。所以值得研究。

# c# - 将命名空间导入 XAML 文件时出错

> ID：13148076
> 
> 赞同：0
> 
> 时间：2012-10-30T21:48:58.853
> 
> 标签：c#, wpf, xaml

当我尝试将特定命名空间导入自定义用户控件时出现此错误。导致此错误的行是导入：'xmlns:c="clr-namespace:Wifi.Toolbar'。如果我删除此行，错误就会消失。

WifiCollaborateToolbarView.xaml(1,1)：错误 MC3000：'根级别的数据无效。第 1 行，位置 1。XML 无效。

视窗 7
Visual Studio 2010 SP1
.NET 4.0

这是 XAML 文件：

```
<UserControl x:Class="Wifi.Toolbar.WifiCollaborateToolbarView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:c="clr-namespace:Wifi.Toolbar">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="CollaborateStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid x:Name="GridTopLevel" SnapsToDevicePixels="True">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <c:CollaborateButton x:Name="ButtonName"
                             Grid.Column="0" 
                             Style="{StaticResource MpCollaborateButtonStyle}"/>

    </Grid>
</UserControl> 
```

这是我要导入此文件的类。它与 XAML 文件存在于同一程序集中。

```
using System;
using System.Windows;
using System.Windows.Controls;

namespace Wifi.Toolbar
{
    [TemplatePart(Name="PART_Icon", Type=typeof(Image))]
    [TemplatePart(Name="PART_Caption", Type=typeof(TextBlock))]
    public class CollaborateButton : Button
    {
        private Image part_icon;
        private TextBlock part_caption;

        public CollaborateButton()
        {

        }

        public override void OnApplyTemplate()
        {
            ...
        }

        protected override Size MeasureOverride(Size availableSize)
        {
            ...
        }

        protected override Size ArrangeOverride(Size finalSize)
        {
            ...            
        }
    }   
} 
```

按钮模板

```
<Style x:Key="MpCollaborateButtonStyle" TargetType="{x:Type c:CollaborateButton}">
        <Setter Property="Height" Value="24" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="BorderBrush" Value="{StaticResource MpCollaborateButtonNormalStrokeBrush}" />
        <Setter Property="Background" Value="{StaticResource MpButtonNormalFillBrush}" />
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border x:Name="Bd"
                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                            MinWidth="{TemplateBinding MinWidth}"
                            Height="{TemplateBinding Height}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            Background="{TemplateBinding Background}">

                        <Grid Margin="6,0,12,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Image x:Name="PART_Icon"
                                   Grid.Column="0"
                                   Margin="0,0,7,0" 
                                   Width="16" 
                                   Height="16" 
                                   Source="Images/Collaboration_MeetingName_16x16.png" />

                            <TextBlock x:Name="PART_Caption"
                                       Grid.Column="2"
                                       Text="This is some really long text that is only for testing purposes. Isn't this fun?"
                                       Style="{StaticResource MpCollaborateTextBlock}"/>

                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="{StaticResource MpButtonDownFillBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>

                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:41:15.233

在您的根级别 UserControl 声明之前，您一定有一些垃圾。也许它被标记在你没有看到它的地方。例如，这会导致有问题的错误......

```
 Junk
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>

    </Grid>
</Window> 
```

与此相同：

```
Junk
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>

    </Grid>
</Window> 
```

# android - 从最终的应用布局中删除活动名称 - android

> ID：13148082
> 
> 赞同：0
> 
> 时间：2012-10-30T21:49:27.670
> 
> 标签：android, android-activity, xml-namespaces

> **可能重复：**
> [如何使用现有自定义主题在 XML 中隐藏 Activity 的标题栏](https://stackoverflow.com/questions/2591036/how-to-hide-the-title-bar-for-an-activity-in-xml-with-existing-custom-theme)

当我在我的设备或模拟器上运行我的应用程序时，我可以在屏幕顶部看到活动名称，例如 MainActivity 或 Hello World 之类的，我想删除它，但我不知道如何。我应该在 xml 文件中写些什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:54:56.590

活动标题栏（因为这就是您所指的）可以通过在活动声明中添加适当的主题来从清单中隐藏：

```
android:theme="@android:style/Theme.NoTitleBar" 
```

或从代码中，通过调用

```
requestWindowFeature(Window.FEATURE_NO_TITLE); 
```

在活动的`onCreate()`

# architecture - iPhone/iPod Touch：应用程序可执行文件包含不受支持的架构：armv7s

> ID：13148083
> 
> 赞同：8
> 
> 时间：2012-10-30T21:49:29.167
> 
> 标签：architecture, frameworks, executable, armv7

我看到在 AppStore 上发布我的应用时出现问题！验证过程说：“iPhone/iPod Touch：应用程序可执行文件包含不受支持的架构：armv7s”

这是我链接的库： CoreLocation（必需） Twitter（可选） QuartzCore（必需） MapKit（必需） UIKit（必需） Foundation（必需） CoreGraphics（必需） libGoogleAnalytics.a（必需） libsqlite3.dylib（必需） CFNetwork（必需）

我也尝试删除 GoogleAnalytics Library，但问题是一样的！你有什么主意吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T18:20:05.827

根据 Apple 开发论坛 ( [https://devforums.apple.com/message/749949](https://devforums.apple.com/message/749949) ) 上的讨论，这似乎是一个影响很多人的错误。可能是由于 Apple 的验证服务器发生了变化。

我能够通过将构建设置中的构建架构从 Standard(armv7,armv7s) 更改为 armv7 并重建来解决它。这只应该是编译后的代码没有针对 iPhone 5 进行优化。它仍然会运行，但可能不如为 armv7s 编译的那么快。我怀疑在大多数情况下性能差异可以忽略不计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-01T06:07:56.323

这帮助了我：

> 项目 -> 构建设置 -> 从“有效架构”中删除架构，并在项目中将“仅构建活动架构”设置为“是”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T12:47:00.627

我今天遇到了同样的问题。我的应用没有第三方库。

12 天前，我从 Xcode 4.5.1 提交了一个构建，随后经过审查并发布到 App Store。今天我尝试提交一个新的构建，突然收到这个错误。

然后，我尝试在 Xcode 中验证我 12 天前提交并且已通过验证并且现在可以在 App Store 中下载的相同可执行文件（不是重建），但这次验证失败并出现上述错误。

执行上面的第 4 步允许我提交新版本。但是即使我添加了少量代码和三个小的 png/jpeg，可执行文件也更小。这让我觉得档案中缺少 armv7s 代码。

怎么了？为什么上面的第 4 步应该“工作”？为什么之前提交 OK 突然发布的可执行文件不再通过验证？

注意：这不是我在 15 小时前找到的任何先前帖子的副本。这是我第一次看到有人提到在提交到 iTunes Connect 时看到此错误，而不是收到编译器警告。所以请不要将此标记为重复。它不是。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-28T10:33:07.977

我的问题是我使用的是旧版本的 Application Loader。

我的解决方案是下载最新版本的 Application Loader iTunes Connect > Manage Your Applications > Download Application Loader，然后重试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-02T06:23:41.707

这里的大多数答案都是我认为不理想的答案，主要是因为它们本质上建议您从应用程序中删除对 armv7s 的支持。虽然这会让你的应用程序通过验证，但这可能会使你的应用程序在 iPhone 5 上运行得更慢。

这是我正在使用的解决方法（不过，我必须说我不会将此称为解决方案）。

我没有使用 XCode Organizer，而是使用 Application Loader 上传二进制文件。

使用 Application Loader 上传二进制文件

打开管理器>右键单击存档>在Finder中显示。

右键单击存档文件 > 显示存档内容

转到产品 > 应用程序 > YourAPP.app

压缩 YourAPP.app 并使用 Application Loader 上传。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-31T11:31:17.573

尝试这个：

1.在 Xcode 中选择您的项目（带有蓝色图标）

2.选择构建设置

3.将视图设置为全部/组合

4.将“仅构建活动架构”设置为是

# asp.net - 两个不同服务器上的标准链接 - 不同的行为

> ID：13148084
> 
> 赞同：0
> 
> 时间：2012-10-30T21:49:31.740
> 
> 标签：asp.net, html, iis, hyperlink, relative-path

我找不到更好的标题，但我希望它是有意义的。

我有两个 Windows 服务器：

1.  共享主机，将我的测试站点托管在子域 (test.domain.com) 上。视窗服务器 2008 R2
2.  带有 Windows Server 2008 的云服务器。我有 IIS 访问权限

在我的第一个案例中，我刚刚使用 FTP 上传了应用程序。在我的第二种情况下，我“像往常一样”设置了 IIS。

在我的内容中，我有几个链接，它们的格式如下：

```
<a href="Mylink/">Text</a> 
```

MyLink 指向使用 URL 路由的页面。但是，假设链接在某个子页面上，例如 domain.com/MySubpage，就会发生这种情况：

服务器 2 的行为：

```
domain.com/MySubpage/MyLink/ 
```

服务器 1 的行为：

```
domain.com/MyLink/ 
```

问题是，我需要我的云服务器上服务器 1 的行为。我的数据库中有很多文章，我不能轻易更改链接，所以必须有一些简单的方法来设置行为 1？

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:30:18.167

看来，正如[URL Anri 发布](https://stackoverflow.com/questions/4415716/relative-links-with-extension-less-urls)的那样，问题在于如何处理 url。服务器#1 认为它不是字典，而#2 认为它是字典。

我将此代码添加到我的 web.config 中，一切都解决了：

```
 <rewrite>
      <rules>

        <!--To always remove trailing slash from the URL-->
        <rule name="Remove trailing slash" stopProcessing="true">
          <match url="(.*)/$"/>
          <conditions>
            <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true"/>
            <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true"/>
          </conditions>
          <action type="Redirect" redirectType="Permanent" url="{R:1}"/>
        </rule>
      </rules>
    </rewrite> 
```

由于我出于搜索引擎优化的原因想要这种行为，它没有任何不幸的问题。

# javascript - 在 Chrome IOS 上加载 PDF 时出现问题

> ID：13148089
> 
> 赞同：20
> 
> 时间：2012-10-30T21:50:02.123
> 
> 标签：javascript, ios, google-chrome, pdf

在我们的移动 Web 应用程序中下载（或尝试下载）pdf 时，我们从 Chrome 收到以下消息。

> “警告：这里有问题！...您尝试访问的网站运行异常，Chrome 无法验证 URL 是否正确。”

这在 Safari 中运行良好，基本上我们正在这样做。

1.  在加载时调用以验证我们要显示的文档是否正常。
    *   如果文档不正确，请向用户发送消息，然后关闭选项卡
2.  指向选项卡以导航到下载 PDF 的地址。

在不发布太多代码的情况下，Javascript 是这样的：

```
DoRequest ("print_report",
           "VALIDATE",
           mycallback);

function mycallback (data,error) {

    var h_href = "";
    var h_widget = "";

    if(error == true) {
        window.close(); 
        return;
    }    

    h_href = GenerateHREF( "print_report", "PRINT" );

    window.location.href = h_href;        
} 
```

GenerateHREF 提供的 URL 用于相同的原始站点，并且与原始站点相关。
mime 类型设置为 application/pdf。内容处置设置为内联。我也尝试过设置 content-size 标头，但似乎没有任何效果。

```
Content-Disposition: attachment; filename="pp66.26.pdf"
Content-Length: 31706
Content-Type: application/pdf 
```

我错过了一些东西......只是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-02T15:08:26.783

尝试将文档解析为 base64 并添加到您的文档或 iframe。

```
 function getAsyncBase64(fileName, callBack){
        var xhr = new XMLHttpRequest();
        xhr.open('GET', fileName, true);
        xhr.responseType = 'arraybuffer';
        xhr.onload = function (e) {
        if (this.status == 200) {
            var uInt8Array = new Uint8Array(this.response || this.responseText);
            var i = uInt8Array.length;
            var binaryString = new Array(i);
            while (i--) {
                binaryString[i] = String.fromCharCode(uInt8Array[i]);
            }
            var dataBinary = binaryString.join('');
            var data64 = window.btoa(dataBinary);
            callback(data64);                
        }
        xhr.send();
    };
    function callback(base64){
        window.open(base64, "_blank");
        //or
        iframe.src = "data:application/pdf;base64,"+ base64;
    };

    getAsyncBase64(url,callback); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-09T19:05:44.843

我还认为弹出窗口行为可能在嫌疑人列表中居高不下（特别是 window.close(); 行似乎非常可疑，尤其是在弹出窗口被用户阻止的情况下）。

但是，由于最终目标是下载文件，您可以尝试将响应标头更改为

```
Content-Disposition: attachment; filename="pp66.26.pdf"
Content-Length: 31706
Content-Type: applicaton/octet-stream 
```

或者您可以尝试强制特定文件夹中的所有 pdf 文件通过 .htaccess 文件强制下载，然后通过您正在使用的 location.href 链接到它们：

```
<FilesMatch "\.pdf$">
ForceType applicaton/octet-stream
Header set Content-Disposition attachment
</FilesMatch> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-22T22:18:08.733

如果是弹出/下载问题，您可以使用 iframe 显示它吗？

```
<iframe src="downloads/report.pdf"></iframe> 
```

# objective-c - UITableView 使用 UIImage 缓慢滚动

> ID：13148091
> 
> 赞同：2
> 
> 时间：2012-10-30T21:50:19.407
> 
> 标签：objective-c, ios, xcode, uitableview

当我将图像添加到 UITableView 时，我注意到第一次将它们添加到单元格时，我得到了一个生涩的滚动。

我没有远程加载它们，而是我的代码如下所示：

```
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [self.tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

MyObject *object = [self.myObjects objectAtIndex:indexPath.row]; 
cell.imageView.image = [UIImage imageNamed:object.imageName];

return cell; 
```

（没有 if (cell == nil) 行，因为我在视图中注册单元类确实加载了）

这是一种不好的做法吗？如果是这样，我应该如何将主包中的图像添加到我的单元格的 imageView 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T01:46:59.020

1.  尝试减小图像的大小

2.  如果由于任何原因无法减小大小，请尝试以下代码（operationQueue 是 NSOperationQueue 实例的 ivar）

    ```
    - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"identifier"];
        [operationQueue addOperationWithBlock:^{
            NSString *imagePath = [[NSBundle mainBundle] pathForResource:@"name" ofType:@"jpg"];
            UIImage *image = [[UIImage alloc] initWithContentsOfFile:imagePath];
            [[NSOperationQueue mainQueue] addOperationWithBlock:^{
                UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
                cell.imageView.image = image;
            }];
        }];
        return cell;
    } 
    ```

# javascript - 在jquery中切换按钮文本

> ID：13148093
> 
> 赞同：2
> 
> 时间：2012-10-30T21:50:23.160
> 
> 标签：javascript, jquery, html, button

我创建了一个 HTML 按钮，我想使用 Javascript/JQuery 在两个文本之间切换按钮中显示的文本。我该怎么做呢？

目前，我有：

```
<button onclick="showAll();" class="collapse-classes">
    <span class="button-text">Show</span>
</button> 
```

该按钮从显示“显示”开始，然后在单击时切换到“隐藏”，然后在再次单击时切换到“显示”并继续。我尝试更改标签的值，但它不会更改显示的文本。任何人都可以帮助编写脚本吗？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T21:53:09.190

不要使用`onclick`. 只需绑定一个事件处理程序。

这是您可以使用的东西：

```
$('.collapse-classes').click(function() {
    var $this = $(this);

    $this.toggleClass('show');

    if ($this.hasClass('show')) {
        $this.text('Show');
    } else {
        $this.text('Hide');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:13:44.603

跟随你的 DOM 树

```
$('.collapse-classes').click(function() {

    var span = $(this).find('span');

    if(span.text() == "Show"){
        span.text("Hide");
    } else {
        span.text("Show");
    }

}); 
```

# java - JBoss AS 7.1.1 新的缺失/不满足的依赖项

> ID：13148097
> 
> 赞同：3
> 
> 时间：2012-10-30T21:50:42.677
> 
> 标签：java, jboss, jboss7.x

我正在将 EAR 部署到 JBoss AS 7.1.1，其结构如下：

```
GrahamsProj.EAR
    GrahamsProjClient.WAR
        app/GrahamsProjClient.jar
    GrahamsProjServer.EAR
        GrahamsProjServer.jar 
```

每次我部署 EAR 并启动 JBoss 时，我都会收到此错误：

```
JBAS014775:    New missing/unsatisfied dependencies:service jboss.deployment.unit."GrahamsProjServer.ear".PARSE (missing) dependents: [service jboss.deployment.subunit."GrahamsProjServer.ear"."GrahamsProjServer.jar".PARSE]

17:19:10,129 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) {"JBAS014653: Composite operation failed and was rolled back. Steps that failed:" => {"Operation step-2" => {"JBAS014771: Services with missing/unavailable dependencies" => ["jboss.deployment.subunit.\"GrahamsProjServer.ear\".\"GrahamsProjServer.jar\".PARSEjboss.deployment.unit.\"GrahamsProjServer.ear\".PARSEMissing[jboss.deployment.subunit.\"GrahamsProjServer.ear\".\"GrahamsProjServer.jar\".PARSEjboss.deployment.unit.\"GrahamsProjServer.ear\".PARSE]"]}}} 
```

如您所见，错误是说我的服务器（GrahamsProjServer.ear）找不到依赖项。

我通过谷歌搜索“新的缺失/不满足的依赖项 jboss 为 7”查找了错误，我得到了广泛的答案。两个常见的问题似乎是standalone.xml 中的数据源问题和jboss-deployment-structure.xml 中的问题。

这是我来自standalone.xml的数据源：

```
<datasources>
    <datasource jta="true" jndi-name="java:jboss/datasources/WorkCenterDS" pool-name="OracleDS" enabled="true" use-java-context="true" use-ccm="true">
        <connection-url>jdbc:oracle:thin:@MCOSRVORCL001:1521:support</connection-url>
        <driver>oracle</driver>
        <transaction-isolation>TRANSACTION_READ_COMMITTED</transaction-isolation>
        <pool>
            <prefill>true</prefill>
            <use-strict-min>false</use-strict-min>
            <flush-strategy>FailingConnectionOnly</flush-strategy>
        </pool>
        <security>
            <user-name>grahamsproj</user-name>
            <password>airit</password>
        </security>
    </datasource>
    <drivers>
        <driver name="oracle" module="com.oracle.ojdbc14">
            <xa-datasource-class>oracle.jdbc.OracleDriver</xa-datasource-class>
        </driver>
    </drivers>
</datasources> 
```

这是`jboss-deployment-structure.xml`位于我的 WAR 文件的 WEB-INF 文件夹中的那个。

```
<jboss-deployment-structure>
    <ear-subdeployments-isolated>false</ear-subdeployments-isolated>
    <deployment>
        <dependencies>
            <module name="GrahamsProjServer.GrahamsProjServer.jar"/>
        </dependencies>
    </deployment>
</jboss-deployment-structure> 
```

如果我摆脱`jboss-deployment-structure.xml`了同样的错误，就会出现。所以它似乎没有什么不同。我的问题可能与这些事情中的任何一个都不相关。有人看到发生了什么吗？

这是我`application.xml`在服务器上的：

```
<application>
    <display-name>GrahamsProj</display-name>
    <description>GrahamsProj</description>
        <application-name>GrahamsProjServer</application-name>
    <module>
        <ejb>GrahamsProjServer.jar</ejb>
    </module>
</application> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:28:56.623

这种依赖看起来是假的。将其修复为

```
<jboss-deployment-structure>
    <ear-subdeployments-isolated>false</ear-subdeployments-isolated>  
</jboss-deployment-structure> 
```

您正在向您自己的依赖项的子模块添加依赖项。可能您想要实现模块互相看到，ear-subdeployments-isolated 标志使您能够看到。

这应该会导致一些不同的错误。把那个贴在这里，这样我们就可以找出可能还有什么问题。

有关 AS7 中的类加载以及 jboss-deployment-structure.xml 提供的所有选项的更多信息，请参阅[https://docs.jboss.org/author/display/AS71/Class+Loading+in+AS7](https://docs.jboss.org/author/display/AS71/Class+Loading+in+AS7)

鉴于您提供的 application.xml，您缺少 web 模块。只有 jar 模块。但是例外应该是不同的。你也可以发布输出

```
jar tf <name-of-ear> 
```

它将让我们了解您的应用程序结构。如果您尝试使用最新的夜间构建，异常会发生任何变化吗？ [https://community.jboss.org/thread/167590](https://community.jboss.org/thread/167590)

# php - 使用 jquery 产品配置器添加和删除文本行的最佳方法

> ID：13148101
> 
> 赞同：0
> 
> 时间：2012-10-30T21:51:09.237
> 
> 标签：php, javascript, jquery, codeigniter

我正在使用 Jquery 创建一个产品配置器。我的用户可以向他们的产品添加自定义文本行。所以你可以创建说... 4 个带有自定义文本的文本行。

我需要知道添加和删除这些行的最佳方法是什么。目前我有以下用于添加行的代码......

```
 //Add Text Button
$('a#addText').live('click', function(event) {
    event.preventDefault();

    //Scroll up the text editor
    $('.textOptions').slideUp();
    $('#customText').val('');

    //count how many items are in the ul textList
    var textItems = $('ul#textList li').size();
    var nextNumber = textItems + 1;

    if(textItems <= 5) {

        //Change input to reflect current text being changed
        $('input#currentTextNumber').val(nextNumber);

        //Append a UL Item to the textList
        $('ul#textList').append('<li id="textItem'+nextNumber+'">Text Line. +$5.00 <a class="deleteTextItem" href="'+nextNumber+'">Delete</a></li>');

        //Scroll down the text editor
        $('.textOptions').slideDown();

    }else {

        alert('you can have a maximum of 6 textual inputs!');   

    }
}); 
```

我可能不是这样做的最好方法，但基本上我有一个空的 UL 列表开始。因此，当他们单击“添加文本行”时，它会找出无序列表中有多少列表元素，将值添加 1 并放置一个新的列表元素，其 id 为 TextItem1 或 TextItem2 或我们所在的任何数字。

我遇到的问题是，当您单击删除项目时，一切都搞砸了，因为当您再次添加项目时，所有数字都不正确。我考虑过编写某种逻辑，说明要删除的所有数字之上的所有数字都从它们的值中减去 1，并且下面的所有数字保持不变。但我认为我只是以错误的方式解决这个问题。

任何有关添加和删除这些文本行的最简单方法的建议都值得赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:34:44.743

尝试在您将添加和删除随机 ID 或类的情况下增加 ID 或类通常比它值得更令人头疼

将项目更改为单个类

```
<li class="textItem"> 
```

您的删除看起来像

```
$('#textList').on('click','.textItem a', function(){/* note that live() is deprecated*/
      $(this).parent().remove();
      $('input#currentTextNumber').val( $('#textList li').length );/* note that size() is deprecated*/
      return false;
}); 
```

如果您在此过程中的任何一个过程中与服务器一起使用任何其他动态数据存储或 AJAX，则可能有简单的方法来配置它们以及使用元素的公共类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:17:21.957

这应该有帮助

编辑：显然参考是我应该考虑的。代码正在运行，但没有想要的参考。嗯，那就用这个...

```
var currentIdx = $('ul#textList li').size();

$('a#addText').click(function(event) { 
    event.preventDefault();

    //Scroll up the text editor
    $('.textOptions').slideUp();

    //count how many items are in the ul textList
    var nextNumber = currentIdx++;

    if($('ul#textList li').size() <= 5) {

        //Change input to reflect current text being changed
        $('input#currentTextNumber').val(nextNumber);

        var newLi = $('<li class="textItem' + nextNumber + '">' + 
            $('#customText').val() +
            '<a class="deleteTextItem" href="#">Delete</a></li>');

        newLi.find('a.deleteTextItem').click(function() {
            $(this).parent('li').remove();
        })

        //Append a UL Item to the textList
        $('ul#textList').append(newLi);

        $('#customText').val('');

        //Scroll down the text editor
        $('.textOptions').slideDown();

    } else {
        alert('you can have a maximum of 6 textual inputs!');   
    }
});​ 
```

这是[小提琴](http://jsfiddle.net/ozrentk/JFagb/3/)。

# osb - OSB 替换操作更新变量“正文”失败：解析 XML 时出错：{err}FORG0005：预期正好一项，得到 0 项

> ID：13148103
> 
> 赞同：2
> 
> 时间：2012-10-30T21:51:25.117
> 
> 标签：osb

我在 Eclipse 中以调试模式测试了代理服务，它工作正常，但是当我在 Sb 控制台中测试它时，我遇到了上述错误。

下面是我的 Xquery

```
(:: pragma bea:global-element-parameter parameter="$lookupTradeInRequest1" element="ns2:lookupTradeInRequest" location="../../../../../Interfaces/Schemas/DeviceTradeInService.xsd" ::)
(:: pragma bea:global-element-return element="ns0:InputParameters" location="../../../../../../TargetEER/Resources/DBAdapter/LookupTradeIn/xsd/LookupTradeIn_sp.xsd" ::)

declare namespace ns2 = "http://esp.t-mobile.com/mo";
declare namespace ns1 = "http://esp.t-mobile.com/2012/eo";
declare namespace ns0 = "http://xmlns.oracle.com/pcbpel/adapter/db/sp/lookupTradeIn";
declare namespace xf = "http://tempuri.org/ProductManagement/Transformation/DeviceTradeInService/lookupTradeIn/Request/lookupTradeInRequest_To_cancelTradeInDbRequest/";

declare function xf:lookupTradeInRequest_To_cancelTradeInDbRequest($lookupTradeInRequest1 as element(ns2:lookupTradeInRequest))
as element(ns0:InputParameters) {
    <ns0:InputParameters>
        <ns0:POFFERID>{ data($lookupTradeInRequest1/offerId) }</ns0:POFFERID>
        <ns0:PRMAID>{ data($lookupTradeInRequest1/RMANumber) }</ns0:PRMAID>
        <ns0:PACCOUNTNUMBER>{ data($lookupTradeInRequest1/accountNumber) }</ns0:PACCOUNTNUMBER>
        <ns0:PMSISDN>{ data($lookupTradeInRequest1/MSISDN) }</ns0:PMSISDN>
        <ns0:PSERIALNUMBER>{ data($lookupTradeInRequest1/serialNumber) }</ns0:PSERIALNUMBER>
        <ns0:PHIST>{ data($lookupTradeInRequest1/includeHistory) }</ns0:PHIST>
    </ns0:InputParameters>
};

declare variable $lookupTradeInRequest1 as element(ns2:lookupTradeInRequest) external;

xf:lookupTradeInRequest_To_cancelTradeInDbRequest($lookupTradeInRequest1) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T14:02:46.077

问题是 $lookupTradeInRequest1 里面没有任何东西。检查是否正确提取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-06T07:53:11.023

大多数时候命名空间可能没有正确添加。请确保在 osb 中添加了 lookupTradeInRequest1 命名空间的来源。

# sql - SQL Server 使用更新“Where”子句值代替更新触发器

> ID：13148106
> 
> 赞同：0
> 
> 时间：2012-10-30T21:51:28.783
> 
> 标签：sql, sql-server, triggers

我想我已经接近这个了，我似乎无法做到这一点。我也浏览了很多问题和答案，要么我找不到答案，要么我不明白其他人的问题，所以如果这是重新发布，请原谅。

就“代替”触发器的想法而言，我想做的似乎非常基本。我在 SQL Server 2008 中工作。我有一个无法直接更新的视图，因此我需要一个替代更新触发器来更新其中一个基础表。问题中表的主键不会包含在 Update 语句中，因此我必须使用外键进行选择。

我正在尝试获取 Update 语句的 Where 子句中提供的外键，但我必须使用错误的语法。我很确定我必须能够获得“Where”值，因为它们似乎很可能被用作基础表的键。所以，鉴于声明...

```
UPDATE table1 SET field1 = 'value1' WHERE key_field = 'key_value' 
```

如何访问获取触发器定义中的“key_value”？我试过以下...

```
DECLARE @pk INT
SELECT @pk = p_key
  FROM dbo.ptable p, UPDATED u
 WHERE p.f_key = u.key_field 
```

而这也是...

```
DECLARE @pk INT
 SELECT @pk = p_key
   FROM dbo.ptable
  WHERE f_key = (SELECT key_field
                   FROM UPDATED) 
```

但这些似乎都不适合我。我很确定我使用...正确获取更新值

```
DECLARE @uValue VARCHAR
SELECT @uValue = field1
  FROM UPDATED 
```

我希望能够使用派生的主键进行这样的插入或更新......

```
INSERT INTO dbo.xtable (fieldx) VALUES (@uValue) WHERE p_key = @pk; 
```

或者

```
UPDATE dbo.xtable SET fieldx = @uValue WHERE p_key = @pk; 
```

希望我说得通，而且我离得太远了。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:57:00.033

在 MSSQL 触发器中，您有两个伪表： INSERTED（新记录）和 DELETED（旧记录）。您的问题是您试图从 UPDATED 中读取一个值（不存在），而且它们可能是多条记录而不是一条。您应该使用 UPDATE FROM (MSSQL specific) ，即类似

```
UPDATE MyOtherTable
SET ...
FROM INSERTED INNER JOIN TableToFindPk ON  INSERTED.FK = ...
INNER JOIN MyOtherTable ON ... 
```

没有解释或很少的sql代码很难说更多

# scheme - 球拍/方案中的加法如何工作？

> ID：13148110
> 
> 赞同：3
> 
> 时间：2012-10-30T21:51:43.753
> 
> 标签：scheme, racket

例如，如果你尝试`(+ 3 4)`，它是如何在源中分解和计算的，具体来说？它使用递归`add1`吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T23:00:10.373

的实现`+`实际上比你想象的要复杂得多，因为算术在 Racket 中是通用的：它适用于整数、有理数、复数等。你甚至可以混合和匹配这些类型的数字，它会做正确的事情。最后，它最终将使用 C 中的算术，这是编写运行时系统的内容。

如果你好奇，你可以在这里找到更多关于数字塔的内容：[https ://github.com/plt/racket/blob/master/src/racket/src/numarith.c](https://github.com/plt/racket/blob/master/src/racket/src/numarith.c)

其他指针：[Bignum 算术](http://en.wikipedia.org/wiki/Bignum)、Scheme[数字塔](http://www.r6rs.org/final/html/r6rs/r6rs-Z-H-6.html#node_chap_3)、Racket 对[数字](http://docs.racket-lang.org/reference/numbers.html)的引用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-30T21:55:46.180

`+`操作符是一种原始操作，是核心语言的一部分。出于效率原因，将其实现为递归过程没有多大意义。

# 3d - 四元数对3d模型的加减除运算

> ID：13148113
> 
> 赞同：5
> 
> 时间：2012-10-30T21:52:13.213
> 
> 标签：3d, quaternions, graphics3d

我只是更深入地研究了 3D 游戏编程中四元数的使用（是的，我知道矩阵，它们没问题，但我们总是要学习一些新东西），所以，我们可以像这样旋转一些对象`Pout = q*Pin*conjug(q)`，q是四元数，Pin 是 Vector3 类的一个对象（假设我们正在使用某个框架，其中为我们定义了这个类），`conjug(q)`它是共轭后的 q 四元数，最后`Pout`是新 Vector3 的对象，我们得到了在将初始 Vector3 的对象旋转`Pin`某个角度 alfa（或 theta，无论你喜欢什么）之后。另外，我知道有一种组合旋转的方法，如下所示：`q_final = q2*q1`（这表示先旋转 alfa1 再旋转 alfa2 角度）。最后，点积表示球体中 2 个四元数之间的角度。这对我来说很清楚。我的问题将涉及诸如除法，加法和减法之类的事情。

**我的问题是**：谁能告诉我，它们（四元数的除法、加法、减法运算）在 3D 编程中代表什么？它们将如何影响 3D 模型？

预先感谢您的回答。

**ps**如果你（***DarenW、bensiu、Dharmendra、Uwe Keim、Jennis***）不能理解这个问题，请离开这个话题。有人可能会给出答案。谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-30T22:07:33.537

如您所知，四元数可以用 4x4 实矩阵来识别。此标识保留了四元数乘法、标量乘法和加法（参见[http://en.wikipedia.org/wiki/Quaternion#Matrix_representations](http://en.wikipedia.org/wiki/Quaternion#Matrix_representations)）。因此，将两个四元数转换为 4x4 矩阵，将它们相加，然后再将它们转换回来与仅将它们相加相同。乘法也是如此。

四元数 A 除以四元数 B 无非就是将 A 乘以 B 的乘法逆。这相当于 A 的矩阵形式乘以 B 的矩阵形式的逆。

请注意，刚体旋转（无剪切或缩放）由**单位长度**四元数表示。因此，您可以通过乘以单位四元数来累积旋转。在这种情况下，加法没有那么有用。

最后，我们在图形中使用四元数的主要原因是插值关键帧（例如[*Eberly* 1999](http://www.geometrictools.com/Documentation/KeyframeAnimation.pdf)）。也就是说，如果我们知道在*k*个位置的期望旋转，我们可以对四元数进行插值，例如使用样条，得到四元数值曲线。每个值 C(t) 是一个单位四元数，因此它代表一个中间旋转。齐次矩阵的关键帧插值更难，因为并非所有 4x4 矩阵都表示齐次变换：插值过程可能会添加缩放、剪切等。

# content-management-system - 如何在 Drupal 7 中获取搜索表单值

> ID：13148118
> 
> 赞同：0
> 
> 时间：2012-10-30T21:52:33.823
> 
> 标签：content-management-system, drupal-7, search-form

我尝试实现一个新模块，该模块捕获默认搜索表单中编写的键并显示默认搜索结果页面以外的其他结果。使用这些其他结果，我将进行一个外部查询，该查询放在一个特殊的块中。

关于如何做到这一点的任何想法？

我尝试使用自定义模块制作“hook_alter_form”但没有成功。

换句话说 ：

我有这样的功能：

```
 function my_function_name_form_alter(&$form,&$form_state,$form_id){ 
     switch($form_id){ 
      case 'search-block-form':
     //Here i want to catch the text that i wrote in the search box 
     break; 
    } 
  } 
```

感谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T13:22:11.447

您可以更改搜索查询以显示其他结果：

```
function mymodule_query_alter(QueryAlterableInterface $query){
  $is_search = FALSE;
  foreach ($query->getTables() as $table) {
    if ($table['table'] == 'search_index') {
      $is_search = TRUE;
    }
  }

 if ($is_search) {
    global $language; 

    $db_or = db_or();
    $db_or->condition('n.type', 'event', '=');
    $db_or->condition('n.type', 'real_sitio', '=');
    $query->condition($db_or);

    $query->condition('n.language' , $language->language, '=');
 } 
} 
```

[这是一个性能杀手，所以http://drupal.org/node/1435834](http://drupal.org/node/1435834)上有一个 drupal 补丁，它添加了一个挂钩，可以直接在搜索查询中进行更改：

所以最后它看起来像：

```
function mymodule_search_query_search_node_alter(&$query) {
  $query->condition('n.type', 'article', '=');
} 
```

# c - “被释放的指针没有被分配”到底是什么意思？

> ID：13148119
> 
> 赞同：21
> 
> 时间：2012-10-30T21:52:35.820
> 
> 标签：c

我在尝试将字符串复制到 c 中的 structs 字符串变量的程序时遇到问题。复制字符串后，我试图释放复制到结构字符串变量的临时字符串变量。但是当我尝试释放字符串时，程序会打开我并说“未分配被释放的指针”。我不明白到底发生了什么。

```
char str[]="       ";           //temporary string to copy to structs string
str[3]=s;                       //putting a char s in middle
strcpy(matrix[i-1][j].c, str);  //copying the string
free(str);                      //freeing str that now is useless when copied 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-30T21:54:05.070

只有调用返回的指针`malloc()`，`realloc()`或`calloc()`可以传递给`free()`（在堆上动态分配的内存）。从第*7.20.3.2*节C99 标准的自由功能：

> free 函数会导致 ptr 指向的空间被释放，也就是说，可用于进一步分配。如果 ptr 是空指针，则不会发生任何操作。**否则，如果参数与 calloc、malloc 或 realloc 函数先前返回的指针不匹配，或者如果空间已通过调用 free 或 realloc 被释放，则行为未定义。**

贴出的代码中，`str`不是动态分配的，而是在栈上分配的，超出范围自动释放，不需要`free()`d。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-30T22:04:27.270

当心。这段代码显示了两件事的混淆：

1.  栈内存和堆内存的区别
2.  的操作`strcpy`

**第 1 点**

这已经在某种程度上得到了回答，但我会扩展一点：

*堆*是为您的进程提供动态内存的地方。当您调用`malloc`（和相关函数）时，内存会在堆上返回。当你完成它时，你必须`free`拥有这个记忆。

*堆栈*是进程运行状态的一部分。它是存储普通变量的地方。当你调用一个函数时，它的变量被压入堆栈并在函数退出时自动弹出。您的`str`变量是堆栈上的某个示例。

**第 2 点**

我想知道`c`你的矩阵数组的那个成员是什么。如果它是一个指针，那么您可能会对它的作用感到困惑`strcpy`。该函数仅将字符串的字节从内存的一部分复制到另一部分。所以内存必须可用。

如果`c`是一个`char`数组（有足够数量的元素来保存字符串），这没关系。但是如果`c`是一个指针，如果你想使用它，你*必须*已经为它分配了内存`strcpy`。有一个替代函数`strdup`可以为字符串分配足够的内存，复制它，然后返回一个指针。`free`当您不再需要该指针时，您有责任处理该指针。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-30T22:35:38.260

它使用`free`而不使用`malloc`. 您无法释放尚未分配的内存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T21:56:53.427

您的代码没有为字符串分配任何内存。它只是将一个字符串从一个字符串复制到另一个字符串使用的内存（一串空格）。

`malloc()`使用,等函数分配内存`realloc()`，然后使用`free()`. 由于该内存不是以这种方式分配的，因此将地址传递给会`free()`导致错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-30T21:58:18.620

您没有使用`malloc()`在堆中为`str`. 因此，`str`在堆栈上分配，不能用 释放`free()`，但会在`str`超出范围时释放，即在包含声明的函数返回之后。

# r - 为新版本更新 ggplot2 代码

> ID：13148121
> 
> 赞同：11
> 
> 时间：2012-10-30T21:52:52.753
> 
> 标签：r, ggplot2

自从安装最新版本的 ggplot2 (0.9.1) 以来，我一直从我的旧代码中收到消息，包括：

```
> warnings()
Warning messages:
1: 'opts' is deprecated.
Use 'theme' instead.
See help("Deprecated")
2: 'theme_text' is deprecated.
Use 'element_text' instead.
See help("Deprecated")
8: In opts(title = trait axis.text.x = theme_text(size = fontsize$axis),  ... :
  Setting the plot title with opts(title="...") is deprecated. Use labs(title="...") or ggtitle("...") instead.
9: 'opts' is deprecated. 
```

我有几个问题：

1.  help("Depreciated") 返回`"no documentation for 'Depreciated' in specified packages and libraries"`；这是一个错误吗？
2.  是否有一段时间'Depreciated' 会变成'Obsolete' 并且我的代码会开始抛出错误？
3.  如何更新我的代码（以解决这些特定问题并防止其他人仍在等待被发现）？
4.  我可以加载两个版本的 ggplot2 并指定我使用的每个函数的版本吗？
5.  更新的语法在什么时间范围内可能会过时？

我承认这是软件的常见问题，但也许 SO 的一些贡献者对包作者的长期计划和基本原理有具体的见解。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-01-16T21:57:19.923

从[Winston 的 github wiki](https://github.com/wch/ggplot2/wiki/New-theme-system)中，关键的变化是：

1.  `theme_xx()`功能改为`element_xx()`

    `theme_segment()`纳入`theme_line()`

2.  `opts()`变成`theme()`

3.  `opts(title = "mytitle")`变成`labs(title = "mytitle")`

4.  使编程更容易的新功能，例如`ggtitle("mytitle")`与 #3 相同

这是[我更新的一些功能的差异：](https://github.com/PecanProject/pecan/commit/0dde7f07757b82196c83a9b3d0634dd5cf56bebe)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-30T21:56:45.403

对于其中许多事情，我会开始关注[ggplot2-dev 邮件列表](https://groups.google.com/forum/?fromgroups=#!forum/ggplot2-dev)和/或包[github 存储库](https://github.com/hadley/ggplot2)。

你没有找到任何东西的原因仅仅是因为你拼错了“deprecated”。

要升级您的代码，请参阅此[转换指南](https://05154779709936255585.googlegroups.com/attach/5aa16afece3d5bc6/theme0.html?gda=9XgBzEYAAABCncUW0npTUN_veVgl3inYi0oNsf4Sjxsz8g3AimkTHy2Q5nwgitdzQrQMmMK7aytx40jamwa1UURqDcgHarKEE-Ea7GxYMt0t6nY0uV5FIQ&view=1&part=4)或[此](https://github.com/wch/ggplot2/wiki/New-theme-system)。我的理解是，弃用是完全删除的第一步，这通常会在下一个“主要”版本中发生。由于 0.9.2 刚刚发布，我猜下一个至少需要 6-8 个月，但这只是一个猜测。

可以加载不同版本的包[。](https://stackoverflow.com/q/2988559/324364)

（小点：最新版本是0.9.2.1！）

# javascript - PDF 中的 JavaScript 会运行 IOS WebView

> ID：13148122
> 
> 赞同：0
> 
> 时间：2012-10-30T21:52:53.863
> 
> 标签：javascript, ios, pdf, uiwebview

我有一个 PDF 文件，其中包含用于验证 PDF 中输入的数据的 JavaScript 代码。这将运行 Adob​​e Reader。我想在我的 iPad 应用程序中包含相同的功能。

如果我在 UIWebView 中加载此 PDF，JS 代码会运行还是 JS 仅在 Adob​​e Reader 中运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:58:39.477

您不能在 UIWebView 的 PDF 中执行 JavaScript，但您可以在外部实现这些功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T12:24:23.840

如果您只需要一个 UI 并且您愿意重新开发验证逻辑，则以下内容可能会有所帮助。Mozilla 的 pdf.js 在[https://github.com/mozilla/pdf.js/tree/master/examples/acroforms](https://github.com/mozilla/pdf.js/tree/master/examples/acroforms)有一个示例，该示例使用画布显示使用 HTML/JS 的 PDF 内容并覆盖 HTML 输入元素。然而，还没有嵌入 PDF JavaScript 的执行。

# ruby-on-rails - if_attribute 不适用于 declarative_authorization 上的多个哈希

> ID：13148125
> 
> 赞同：0
> 
> 时间：2012-10-30T21:52:58.613
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, declarative-authorization

我在 Ruby on rails 3.1 上使用 declarative_authorization。

一个组有许多专辑（groupalbum），一个组由一个用户创建（组表外键中的user_id）。只有群组的所有者才能创建相册。

这是我的 authorization_rules.rb ：

```
has_permission_on [:group_albums], :to => [:create] do
    if_attribute :group =>  { :user => is_in { user.groups } }
end 
```

这是我的 GroupAlbumsControler ：

```
class GroupAlbumsController < ApplicationController
    before_filter :set_group_album_from_params, :only => :show
    before_filter :set_group_album_new, :only => [:index, :new]
    filter_access_to :all, :attribute_check => true
    (...)
end 
```

但它不起作用：

```
You are not allowed to access this action. 
```

即使我与组的所有者登录。

我的错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T13:32:44.500

这不起作用的原因可能有很多。

您是否已将 :index 和 :new 添加到您的权限中？

```
privileges do
  privilege :manage, :includes => [:create, :read, :update, :delete]
  privilege :read, :includes => [:index, :show]
  privilege :create, :includes => :new
  privilege :update, :includes => :edit
  privilege :delete, :includes => :destroy
end 
```

您对当前用户的 :group_albums 有读取权限吗？

```
has_permission_on [:group_albums], :to => [:create, :read] do
    if_attribute :group =>  { :user => is_in { user.groups } }
end 
```

你叫哪个动作？

# r - 使用 R 中的匹配矩阵数据对提取数据

> ID：13148128
> 
> 赞同：4
> 
> 时间：2012-10-30T21:53:16.380
> 
> 标签：r, extract, match, subset

我有两个包含纬度、经度和温度数据的数据集。一个数据集对应于一个感兴趣的地理区域，对应的纬度/经度对构成该区域的边界和内容（矩阵维度 = 4518x2）

另一个数据集包含包含感兴趣区域的较大区域的纬度/经度和温度数据（矩阵维度 = 10875x3）。

我的问题是：如何从与第一个数据集的纬度/经度数据匹配的第二个数据集中提取适当的行数据（纬度、经度、温度）？

我尝试了各种“for loops”、“subset”和“unique”命令，但无法获得匹配的温度数据。

提前致谢！

* * *

10/31 编辑：我忘了提到我正在使用“R”来处理这些数据。

感兴趣区域的纬度/经度数据以 4,518 个文件的列表形式提供，每个文件的名称中包含纬度/经度坐标：

```
x<- dir()

lenx<- length(x)

g <- strsplit(x, "_")

coord1 <- matrix(NA,nrow=lenx, ncol=1)  
coord2 <- matrix(NA,nrow=lenx, ncol=1)

for(i in 1:lenx) {  
coord1[i,1] <- unlist(g)[2+3*(i-1)]  
coord2[i,1] <- unlist(g)[3+3*(i-1)]     
} 

coord1<-as.numeric(coord1)  
coord2<-as.numeric(coord2)

coord<- cbind(coord1, coord2) 
```

纬度/经度和温度数据是从 NCDF 文件中获得的，其中包含 10,875 个纬度/经度对的温度数据：

```
long<- tempcd$var[["Temp"]]$size[1]   
lat<- tempcd$var[["Temp"]]$size[2]   
time<- tempcd$var[["Temp"]]$size[3]  
proj<- tempcd$var[["Temp"]]$size[4]  

temp<- matrix(NA, nrow=lat*long, ncol = time)  
lat_c<- matrix(NA, nrow=lat*long, ncol=1)  
long_c<- matrix(NA, nrow=lat*long, ncol =1)  

counter<- 1  

for(i in 1:lat){  
    for(j in 1:long){  
        temp[counter,]<-get.var.ncdf(precipcd, varid= "Prcp", count = c(1,1,time,1), start=c(j,i,1,1))  
        counter<- counter+1  
    }  
}  

temp_gcm <- cbind(lat_c, long_c, temp)` 
```

所以现在的问题是如何从“temp_gcm”中删除与“coord”中的纬度/经度数据对相对应的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T22:50:30.053

不，

我可以想到很多方法可以做到这一点。最简单但不是最有效的方法是使用 R 的`which()`函数，该函数接受一个逻辑参数，同时迭代要应用匹配的数据帧。当然，这是假设在更大的数据集中*最多*只能有一个匹配项。根据您的数据集，我会做这样的事情：

```
attach(temp_gcm)    # adds the temp_gcm column names to the global namespace
attach(coord)    # adds the coord column names to the global namespace

matched.temp = vector(length = nrow(coord)) # To store matching results
for (i in seq(coord)) {

   matched.temp[i] = temp[which(lat_c == coord1[i] & long_c == coord2[i])]
}

# Now add the results column to the coord data frame (indexes match)
coord$temperature = matched.temp 
```

该函数返回数据帧中满足和匹配`which(lat_c == coord1[i] & long_c == coord2[i])`的所有行的向量，并且分别来自迭代中的行（注意：我假设这个向量的长度只有 1，即只有 1 个可能的匹配项）。然后将从满足逻辑条件的数据框中的列中分配值。请注意，这样做的目标是我们创建一个向量，该向量具有通过索引对应于数据帧行的匹配值。`temp_gcm``lat_c``long_c``coord1``coord2``i``matched.temp[i]``temp``temp_gcm``coord`

我希望这有帮助。请注意，这是一种基本方法，我建议您查找函数`merge()`并`apply()`以更简洁的方式执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T23:27:43.950

我添加了一个充满零的附加列，用作 IF 语句的结果。“x”是 temp_gcm 中的行数。“y”是列数（代表时间步长）。“temp_s”是标准化的温度数据

```
indicator<- matrix(0, nrow = x, ncol = 1)

precip_s<- cbind(precip_s, indicator)

temp_s<- cbind(temp_s, indicator)

for(aa in 1:x){

    current_lat<-latitudes[aa,1] #Latitudes corresponding to larger area

    current_long<- longitudes[aa,1] #Longitudes corresponding to larger area

    for(ab in 1:lenx){ #Lenx coresponds to nrow(coord)

        if(current_lat == coord[ab,1] & current_long == coord[ab,2]) {
            precip_s[aa,(y/12+1)]<-1 #y/12+1 corresponds to "indicator column"
            temp_s[aa,(y/12+1)]<-1
        } 
    }
}

precip_s<- precip_s[precip_s[,(y/12+1)]>0,] #Removes rows with "0"s remaining in "indcator" column

temp_s<- temp_s[temp_s[,(y/12+1)]>0,]

precip_s<- precip_s[,-(y/12+1)] #Removes "indicator column

temp_s<- temp_s[,-(y/12+1)] 
```

# jquery - 如果 AJAX 请求失败，则使用 Firefox 附加 sdk

> ID：13148130
> 
> 赞同：3
> 
> 时间：2012-10-30T21:53:21.513
> 
> 标签：jquery, firefox-addon-sdk

请注意以下代码：

```
 $.ajax({
     type: "POST",
     url: loginURL,
     data: jsonArray,
     async: true,
     success: function(data, status){
         alert(status);
     },
     error: function(data, status){
         alert(status + " 1");
     }
}); 
```

每次都会抛出错误案例，但我打开了提琴手，并且我从服务器接收数据就好了。我正在将面板附加到小部件。在面板中加载的 HTML 中，我包含了最新的 jquery 和登录 javascript 文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-10-01T13:53:25.063

其实你可以在 Firefox 扩展的内容脚本中进行跨域请求。检查此链接：

[https://developer.mozilla.org/en-US/Add-ons/SDK/Guides/Content_Scripts/Cross_Domain_Content_Scripts](https://developer.mozilla.org/en-US/Add-ons/SDK/Guides/Content_Scripts/Cross_Domain_Content_Scripts)

您需要在 package.json 中明确域权限，如下所示：

```
"permissions": {
  "cross-domain-content": ["http://datapoint.metoffice.gov.uk"]
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T04:02:13.110

*[编辑：我更新了链接]*

这是在内容脚本中吗？内容脚本目前无法发出跨域请求（我认为可以使用 chrome 扩展）。您*可以*做的是使用请求模块在 main.js 中发出请求：

[https://addons.mozilla.org/en-US/developers/docs/sdk/latest/modules/sdk/request.html](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/modules/sdk/request.html)

从 SDK 版本 1.12（将在 6 周内发布）开始，您*将*能够在内容脚本中发出跨域请求，从而使此类功能更易于实现。

# php - 如何将图像作为 blob 存储在数据库中？

> ID：13148140
> 
> 赞同：0
> 
> 时间：2012-10-30T21:54:04.723
> 
> 标签：php, mysql, blobs

我正在尝试编写一个函数来处理 mySQL / PHP 中的图像，但无法弄清楚如何存储结果。我已经包含了一个精简版本的代码来演示这个问题。

image.image_o 中的 blob 均已正确存储，可用于将图像输出到网页。该函数运行没有错误，但之后 image.image_r 中的 blob 只有几个字节长，并且包含诸如“Resource id #5”之类的文本

我确信我在做一些愚蠢的事情——只是看不到它是什么。

```
function process_images(){
    global $mysql
    $sql = "select id, image_o from image";
    $res = mysqli_query($mysqli, $sql);
    if ($res){
        while ($ay = mysqli_fetch_array($res, MYSQLI_ASSOC)){
             $id = $ay['id'];
             $im = imagecreatefromstring($ay['image_o']);
             // do something useful with the image
             $sql2 = "update image set image_r = '{$im}' where id = $id";
             $res2 = mysqli_query($mysqli, $sql2);
             if ($res2){
                 // blah blah
             }else{
                 echo mysqli_error($mysqli)." in res2";
             }
         }
    }else{
        echo mysqli_error($mysqli)." in res"; 
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:15:37.650

我同意上面的评论，认为这通常是不可取的。但是，这是一篇很棒的文章，介绍了为什么要这样做以及如何做。它还强调了在数据库中存储图像的一些缺点。

[http://forum.codecall.net/topic/40286-tutorial-storing-images-in-mysql-with-php/](http://forum.codecall.net/topic/40286-tutorial-storing-images-in-mysql-with-php/)

您需要确保将数据读入该字段。不仅仅是文件指针：

```
// Temporary file name stored on the server
$tmpName  = $_FILES['image']['tmp_name'];  

// Read the file 
$fp     = fopen($tmpName, 'r');
$data = fread($fp, filesize($tmpName));
$data = addslashes($data);
fclose($fp);

// Now take the contents of data and store THAT 
```

简而言之，imagecreatefromstring 返回“成功时将返回图像资源”，而不是文件本身的内容。您需要先阅读该资源的内容，然后才能存储它。使用您的代码，进行以下更改：

```
function process_images(){
    global $mysql
    $sql = "select id, image_o from image";
    $res = mysqli_query($mysqli, $sql);
    if ($res){
        while ($ay = mysqli_fetch_array($res, MYSQLI_ASSOC)){
             $id = $ay['id'];
             $im = imagecreatefromstring($ay['image_o']);
             $tempFileName = '/tmp/' . $id . 'jpg';
             $imTempFile = imagegd($im, $tempFileName); 
             $fh = fopen($tempFileName, "r");
             $data = fread($fh, filesize($tempFileName));

             // do something useful with the image
             $sql2 = "update image set image_r = '{$data}' where id = $id";
             $res2 = mysqli_query($mysqli, $sql2);
             if ($res2){
                 // blah blah
             }else{
                 echo mysqli_error($mysqli)." in res2";
             }
             //delete the temp file
             unlink($tempFileName);
         }
    }else{
        echo mysqli_error($mysqli)." in res"; 
    }
} 
```

# javascript - 开发所见即所得编辑器 - Javascript/HTML5 contenteditable

> ID：13148143
> 
> 赞同：1
> 
> 时间：2012-10-30T21:54:26.733
> 
> 标签：javascript, html, wysiwyg, contenteditable

这里的代码：http: [//pastebin.com/pukt7TQv](http://pastebin.com/pukt7TQv) （html/javascript/css 都是内联的，为了简单起见，包括完整的源代码）

我可以在 pastebin 中插入标签但不能插入属性、详细信息，但只需插入标签调用一个名为 insertTag(tag) 的函数，然后插入一个属性（例如 font size="3"）调用 insertAttr(tag, attr) where tag将是 'font' 和 attr 将是 'size="3"'。insertTag() 使用了环绕内容()，但是环绕内容() 不支持属性，我想不出另一种插入带有属性的标签的方法。

也可以出于自己的目的随意撕掉这段代码，它既简单又有点实用！:D

# powershell - 带有 ComputerName 的 powershell Get-Process 缺少路径

> ID：13148144
> 
> 赞同：3
> 
> 时间：2012-10-30T21:54:27.543
> 
> 标签：powershell

我想获取某个远程机器上特定文件夹下的进程列表并杀死它们。但是，如果我添加 -ComputerName，Get-Process 不会根据需要返回 Path，因此我无法使用 Path。有没有办法在特定路径下的远程机器上获取进程/停止进程？

```
// Paths are filled
PS C:\> Get-Process | Format-Table Name, Path
Name                                                        Path
----                                                        ----
firefox                                                     C:\Program Files (x86)\Mozilla Firefox\firefox.exe

// Paths are empty
PS C:\> Get-Process -ComputerName localhost | Format-Table Name, Path
Name                                                        Path
----                                                        ----
firefox 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:36:19.067

如果远程服务器上启用了 Remoting，您可以使用[Invoke-Command ，并在命令的脚本块中执行您的操作：](http://technet.microsoft.com/en-us/library/hh849719.aspx)

```
Invoke-Command -ComputerName remoteComputer -Script { param($pathFilter) Get-Process | ?{$_.Path -like $pathFilter} | Format-Table Name, Path } -Args "somefilter*" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-18T17:43:45.140

我有一个类似的案例，我通过使用 x64 版本的 powershell 解决了。

# html - display:table-cell 添加图像时的奇怪行为

> ID：13148152
> 
> 赞同：0
> 
> 时间：2012-10-30T21:54:53.953
> 
> 标签：html, css

我有带有 display:table-cell 的列（以确保它们具有相同的高度。）每个列内都有一些文本。当我将图像添加到其中一个单元格（在文本顶部）时，所有列中的文本都被向下推，而不仅仅是带有图像的列中。有没有办法防止其他列中的文本移动？

```
<div class = 'column'>
  <h1>Some text</h1>
</div>
<div class = 'column'>
  <img src='image.png'/>
  <h1>Some other text</h1>
</div>

.column {display:table-cell} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:57:18.943

这是未经测试的，但你有没有试过

```
.column {
  display: table-cell;
  vertical-align: top;
 } 
```

老实说，我会避免使用`display: table-cell`. `height`改为使用 css设置属性。

# ruby - Ruby on Rails - 通过操作重定向/渲染不起作用

> ID：13148160
> 
> 赞同：0
> 
> 时间：2012-10-30T21:55:52.817
> 
> 标签：ruby, redirect, action, render

我有以下代码：

```
def isLoggedIn
    if session[:username].nil?
      puts "Not logged in!"
      return render :controller=>"admin", :action=>"login"
    end
  end 
```

以下代码在顶部调用此操作以检查用户的状态。

```
def view_gallery
    isLoggedIn
       .
       .
       .
       .
      \/
    return render "view_gallery"
  end 
```

我遇到的问题是代码在 isLoggedIn 之后继续执行，尽管控制台正在记录“未登录！” 因为正如预期的那样，用户没有登录。这应该呈现一个它不做的替代布局。如果我拼错了动作（比如“logib”），那么它会抱怨缺少模板 - 所以我可以看到它正在运行渲染功能。

如果我将 render 更改为 redirect_to 和/或如果我将 return 语句移动到行尾，也会发生同样的情况。

有任何想法吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:44:19.370

Rails 指南说按以下方式执行此操作：

`render :controller=>"admin", :action=>"login" and return`

# javascript - 3个不同数字范围的百分比

> ID：13148162
> 
> 赞同：0
> 
> 时间：2012-10-30T21:56:29.897
> 
> 标签：javascript, jquery, algorithm, math, percentage

我有 3 个数字 113、6、1

这些数字中的每一个都代表一个数据。所以我需要以图形方式显示数据。因此，113 将具有最大数据，然后 6 将具有更少的数据，而 1 是最少的。

![在此处输入图像描述](../Images/64005fd590061796b75746b77b3f93a7.png)

像这样的东西。因此，如果我使用百分比方法，它会给我最后一个数字最少的数据为 0%，因此我无法在图像中显示它。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:04:07.383

要么你增加气球的数量，使它等于你的数字之和除以最少（在这种情况下，最少是 1，所以你需要 113+6+1 = 120 个气球），或者你“调整”百分比所以你得到的气球的最小数量是1。

在这种情况下，c = 1 表示 1/120 的百分比，您需要少于一个气球。因此，您从 33 个气球中取出 1 个气球并将其分配给 1。然后 6+113 必须除以 32 个气球，而 6 得到 32*6/(6+113) = 1.6 个气球。您可以为其分配 2 个气球，剩下的 30 为 113。

绘制的百分比将是 1/33、2/33 和 30/33，即大约 3%、6% 和 90%，而不是您无法表示的“实际”值 0.83%、5% 和 94.16%。是否足够接近？你必须判断。

如果可能的话，另一种可能性是研究如何生成“混合颜色”气球。

# wcf - 在 WCF 中修改 Soap 消息

> ID：13148165
> 
> 赞同：1
> 
> 时间：2012-10-30T21:56:47.153
> 
> 标签：wcf

我有有趣的任务。我有两个 wcf 端点。每个端点位于不同的地址。端点不暴露给客户端。我有额外的主要端点暴露给客户端，只有通过这个端点，其他两个端点才能被调用。基于一些输入类，我需要决定我应该调用哪个端点，作为响应，我需要将 return XML 转换为 response XML 。

我的解决方案是创建空操作合约并实现将在结束请求事件中触发的 Http 模块。根据输入参数，我将向两个端点之一创建soap 请求，并将结果传输到结果XML。

可能相反，我应该使用消息检查器？你遇到过类似的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T17:26:03.053

我开始在 Http 模块中实现。问题是当 WCF 方法返回复杂类型时，会引发反序列化错误。因此我实现了 IoperationInvoker 属性。在行为中添加。基于输入参数，我自己调用加工服务和取消对象。

# hibernate - 如何在不更改父类的情况下让休眠状态持久化 MappedSuperclass 的一对多子类？

> ID：13148166
> 
> 赞同：2
> 
> 时间：2012-10-30T21:56:46.950
> 
> 标签：hibernate, jpa, polymorphism

我有一个抽象`@MappedSuperclass`的`Vehicle`, 和一个具体的实现`Car`。

```
@MappedSuperclass
public abstract class Vehicle { ... }

@Entity
@Table(schema = "Dealer", name = "Cars")
public class Car {
    ...
    // you can have any color you like, as long as it's black...
    private final String color = "Black";  

    public String getColor() { return "Black"; }
} 
```

但是，这些实现不在我的控制之下，所以我不能更改`Vehicle`or `Car`，我也不能更改数据库。`Car`假设在经销商的模式中有一个我可以访问的只读列表。当然，里面也有很多其他的方法，还有其他`Car`的`Vehicles`，，，`Bike`等等`Skateboard`。

我经营一家油漆店，所以我提供`PaintedCar`了`getColor()`. 在所有其他方面，此类与以下内容相同`Car`：

```
public class PaintedCar extends Car {
    ...
    private String customColor;

    @Override
    public String getColor() { return customColor; }

} 
```

相同的`Car`可以多次绘制，或者不同的`Car`所有者可以以不同的方式绘制不同的实例，因此存在`Car`一对多`PaintedCar`的可能性。

从理论上讲，我应该能够将表示 a 所需的所有信息存储`PaintedCar`在带有字段的表中：

```
int paintedCarId;
int carId;  /* FK to Car */
varchar color; 
```

请注意，它`PaintedCar`必须是 的实例`Car`，而不仅仅是`Vehicle`. 但是，我不太清楚如何让 Hibernate 保持这种关系。有什么诀窍？

# r - 有没有办法计算每个矩阵列之间的 Spearman 相关性？

> ID：13148168
> 
> 赞同：-3
> 
> 时间：2012-10-30T21:56:53.993
> 
> 标签：r, matrix

试图计算列之间的相关性，但 cor() 函数一次只允许在两列之间进行比较。

```
> mat <- matrix(c(45,34,1,3,4325,23,1,2,5,7,3,4,32,734,2,53),ncol=4)
> mat
     [,1] [,2] [,3] [,4]
[1,]   45 4325    5   32
[2,]   34   23    7  734
[3,]    1    1    3    2
[4,]    3    2    4   53 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T22:01:42.303

```
cor(mat, method = "spearman") 
```

该`cor`函数默认计算列之间的相关性。我不知道您从哪里获得该`corr`功能，但似乎`cor`应该满足您的需求。

# wso2 - 将 wso2 变成一个 pep，身份服务器充当 pdp

> ID：13148170
> 
> 赞同：1
> 
> 时间：2012-10-30T21:57:05.857
> 
> 标签：wso2, wso2esb, wso2carbon, wso2is

我正在尝试将 wso2 ESB 服务器用作 PEP，我已经将 wso2 身份服务器用作 PDP，并且在 wso2 应用程序服务器上托管了一个应用程序。我已将策略上传到身份服务器，我想知道是否有任何教程可以显示和解释如何实现这一点。我已经尝试过博客[http://wso2.org/library/articles/2011/08/finegrained-authorization-restful-services-xacml](http://wso2.org/library/articles/2011/08/finegrained-authorization-restful-services-xacml)但它没有奏效。任何关于如何将 esb 变成 pep 的方向都将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T08:06:28.050

您可以使用 wso2 esb Entitlement mediator。请查看以下指南，该指南解释了我们如何向代理服务添加细粒度授权。

[http://docs.wso2.org/wiki/display/IS400/Adding+Fine-grained+Authorization+for+Proxy+Services+in+ESB](http://docs.wso2.org/wiki/display/IS400/Adding+Fine-grained+Authorization+for+Proxy+Services+in+ESB)

# python - Python：充满 BOM 的 Youtube HTML

> ID：13148171
> 
> 赞同：1
> 
> 时间：2012-10-30T21:57:06.250
> 
> 标签：python, html, beautifulsoup, byte-order-mark

我正在尝试使用 Python 2.7 中的 BeautifulSoup 4 解析 youtube 评论。当我尝试任何 youtube 视频时，我会收到充满 BOM 的文本，而不仅仅是在文件开头：

```
<p> thank you kind sirï»¿ :)</p> 
```

几乎每条评论中都会出现一个。其他网站 (guardian.co.uk) 并非如此。我正在使用的代码：

```
# Source (should be taken from file to allow updating but not during wip):
source_url = 'https://www.youtube.com/watch?v=aiYzrCjS02k&feature=related'

# Get html from source:
response = urllib2.urlopen(source_url)
html = response.read()

# html comes with BOM everywhere, which is real ***, get rid of it!
html = html.decode("utf-8-sig")

soup = BeautifulSoup(html)

strings = soup.findAll("div", {"class" : "comment-body"})
print strings 
```

正如你所看到的，我已经尝试过解码，但只要我喝汤，它就会带回 BOM 字符。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:05:09.813

这在 YouTube 方面似乎是无效的，但你不能只是告诉他们修复它，你需要一个解决方法。

所以，这里有一个简单的解决方法：

```
# html comes with BOM everywhere, which is real ***, get rid of it!
html = html.replace(b'\xEF\xBB\xBF', b'')
html = html.decode("utf-8") 
```

（`b`前缀对于 Python 2.7 来说是不必要但无害的，但它们会让你的代码在 Python 3 中工作……另一方面，它们会在 Python 2.5 中破坏它，所以如果这对你更重要，请摆脱它们。 )

Alternatively, you can first decode and then `replace(u'\uFEFF', u'')`. This should have the exact same effect (decoding extra BOMs should work harmlessly). But I think it makes more sense to fix the UTF-8 then decode it, rather than trying to decode and then fixing the result.

# c# - 我应该使用哪种设计模式？

> ID：13148172
> 
> 赞同：0
> 
> 时间：2012-10-30T21:57:06.887
> 
> 标签：c#, .net, design-patterns

我有以下代码按顺序执行，一个接一个的方法。

我加载请求，执行一些检查，例如检查该请求是否已经存在响应，如果不存在，我调用服务并接收我保存到数据库的响应。

我一直在寻找一种可以在这种情况下使用的设计模式，我想在这里发布这个并获得一些想法。

```
public class Manager
    {

        public void PutRequest()
        {
            //Do Something

            if (loadRequest())
            {
                  callService(); 

                  //Do Something
                  saveResponse();
            }

        }

        private bool loadRequest()
        {            
             bool isExist = checkIfResponseExists();

             if (!isExist)
             {
              // If false, load request from DB
             } 

             return !isExist;

        }

        private bool checkIfDataExists()
        {
            //Check if a response already exists in the DB for this request
        }

        private void callService()
        {
            //Call the service and receive the response
        }    

        private void saveResponse()
        {
            //Store the response in the DB
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:59:23.713

模式用于解决一些问题。您当前的代码有什么问题？除了方法名称之外，我没有看到任何重复的代码。没有模式，它修复了方法命名问题。

是的，您的代码需要一些重构，但不是模式。更好的类和方法命名是第一步。另外，我删除了 field `isExist`。

```
public class Manager
{
   public void PutRequest()
   {
       //Do Something
       if (!CheckIfResponseExists()) // returns boolean value
            LoadRequestFromDB()

        CallService(); 
        //Do Something
        SaveResponse();
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:02:26.363

检查称为策略的设计模式，它定义了所有支持的算法通用的接口，并且每个具体策略都实现了一个算法

[http://www.oodesign.com/strategy-pattern.html](http://www.oodesign.com/strategy-pattern.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T22:06:15.410

似乎将这些方法中的几个作为函数会更有用。因此，不是让一个方法负责检查条件并执行一些其他操作，而是有一个检查条件的函数，然后调用它的方法根据结果执行一些操作。（适用于方法的[SRP类型...）](http://c2.com/cgi/wiki?SingleResponsibilityPrinciple)

```
public void DoAllTheThings!() // Oops, Ruby syntax creeping in :P
{
   if(!WeCanDoIt())
   {
     MakeItSo(); // So that we can do it...
   }

   NowWeCanDoAllTheThings();
}

private bool WeCanDoIt() {}
private void MakeItSo() {}
private void NowWeCanDoAllTheThings() {} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T09:11:52.203

在选择模式时，您应该考虑应用程序的可伸缩性

您可以应用的模式之一是**状态**模式

会有两种状态。

1.  响应已经存在
2.  需要处理新的响应

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T07:59:53.260

命令+复合。

有些人认为在复合中使用 if/then 命令（在您的情况下是 putRequest）是一种责任链。

# mysql - 无法将 myisam sql 添加到服务器 5.5

> ID：13148173
> 
> 赞同：0
> 
> 时间：2012-10-30T21:57:07.133
> 
> 标签：mysql

一个用户向我发送他的 *.frm 文件，我无法将此数据库添加到 mysql 服务器 5.5。

我将服务器变量设置为默认引擎 = MISAM

我将文件放入`C:\Program Files\MySQL\MySQL Server 5.5\data`目录

我停止服务并再次启动它，希望在新数据库启动时看到它。

我是使用 mysql 的新手，但没有任何线索？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:36:05.563

frm 文件可能还不够——它们[只包含有关表的元信息。](http://dev.mysql.com/doc/internals/en/frm-file-format.html)

据我所知，对于完整的数据库，您绝对还需要 .MYD（数据）和 .MYI（索引）文件，但是您可以尝试运行[myisamchk](http://dev.mysql.com/doc/refman/5.0/en/myisamchk.html)并查看会发生什么。也许它可以为您重新创建新的空文件。

# iphone - 如何在 iOS6 中获取 Facebook、Twitter 个人资料（姓名、图片）

> ID：13148177
> 
> 赞同：0
> 
> 时间：2012-10-30T21:57:24.320
> 
> 标签：iphone, ipad, ios6

我已经为 ios6 实现了 facebook 和 twitter，但我没有获得用户详细信息，如姓名、电子邮件、图像。有人会帮助我吗？下面是我的代码：

```
-(IBAction)facebook
{   
    SLComposeViewController *fbController=[SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook];

    if([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook])
    {
        SLComposeViewControllerCompletionHandler __block completionHandler=^(SLComposeViewControllerResult result){

            [fbController dismissViewControllerAnimated:YES completion:nil];

        switch(result){
            case SLComposeViewControllerResultCancelled:
            default:
            {
                NSLog(@"Cancelled.....facebook");

            }
                break;
            case SLComposeViewControllerResultDone:
            {
                NSLog(@"Posted....facebook");
            }
                break;
        }};

    [fbController addImage:[UIImage imageNamed:@"ipadicon_72x72.png"]];
    [fbController setInitialText:@"Check out this article."];

    //[fbController addURL:[NSURL URLWithString:@"http://soulwithmobiletechnology.blogspot.com/"]];
    [fbController setCompletionHandler:completionHandler];
    [self presentViewController:fbController animated:YES completion:nil];
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T19:55:45.217

请参阅有关使用 Twitter 框架以及如何从 Twitter 获取信息的信息，具体而言，请参阅**步骤 7**。

[http://mobile.tutsplus.com/tutorials/iphone/ios-sdk_twitter-framework_twrequest/](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk_twitter-framework_twrequest/)

# java - 运算符 * 未定义

> ID：13148180
> 
> 赞同：0
> 
> 时间：2012-10-30T21:57:39.633
> 
> 标签：java, android, undefined, operator-keyword

我正在尝试制作一个简单的乘数计算器。我已经完成了大部分工作，但我不断收到相同的错误：对于参数类型 Double、EditText，运算符 * 未定义。

我搜索了其他人提出的问题，但唯一简单的问题处理的不是双打。有谁知道如何修理它？

```
package com.deitel.multiplicationtables;

import android.os.Bundle;
import android.app.Activity;
import android.widget.Button;
import android.widget.TextView;
import android.widget.EditText;
import android.view.View;

//Implements the listener for an onclick event (implements View.onClickListener)
public abstract class Main extends Activity implements View.OnClickListener{
   // creates a button 
    private Button one, two, three, four, five, six, seven, eight, nine;

    // Called when the activity is first created.
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

      //assigns the resource id of 1 - 9 to each button.
        one = (Button) findViewById(R.id.button1);
        two = (Button) findViewById(R.id.button2);
        three = (Button) findViewById(R.id.button3);
        four = (Button) findViewById(R.id.button4);
        five = (Button) findViewById(R.id.button5);
        six = (Button) findViewById(R.id.button6);
        seven = (Button) findViewById(R.id.button7);
        eight = (Button) findViewById(R.id.button8);
        nine = (Button) findViewById(R.id.button9);

        //Adds the buttons to the onclicklistener
        one.setOnClickListener(this);
        two.setOnClickListener(this);
        three.setOnClickListener(this);
        four.setOnClickListener(this);
        five.setOnClickListener(this);
        six.setOnClickListener(this);
        seven.setOnClickListener(this);
        eight.setOnClickListener(this);
        nine.setOnClickListener(this);

    }

  //creates a method (or action) for when the button is clicked.
    public void onclick(View view)
    {
        //Makes a variable for the entered number
        Double amount;
        Double product;
        Double variable;

        // constants
        final double one = 1; 
        final double two = 2;
        final double three = 3;

        if (view.getId() == R.id.button1)
        {
          variable = one;
        }
        if (view.getId() == R.id.button2)
        {
            variable = two;
        }
        if (view.getId()== R.id.button3)
        {
            variable = three;
        }

        //creates an editext and assigns the resource id of the xml edittext.
        EditText number = (EditText)findViewById(R.id.editText1);

        //Receives the input from the edittext, converts it to a double (number).
        amount = Double.parseDouble(number.getText().toString());
        //Calculates the product
        product = variable * number;

        //Creates a textview object, assigns the xml r.id, and then changes the text to report the amount.
         TextView t = (TextView)findViewById(R.id.textView2); 
            t.setText("Your product is: " + product);

    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T22:00:14.080

```
 EditText number = (EditText)findViewById(R.id.editText1);

 product = variable * number; 
```

`number`是类型`EditText`。你不能申请加倍`*`。`EditText`

您的产品计算应为：

```
 product = variable * amount; 
```

`amount`是您从中获得的价值`EditText`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T22:00:19.233

您已将文本转换为名为 的值`amount`，但您忘记使用它。

线

```
product = variable * number; 
```

应该

```
product = variable * amount; 
```

这应该可以解决问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-30T22:03:02.107

```
 //creates an editext and assigns the resource id of the xml edittext.
        EditText number = (EditText)findViewById(R.id.editText1);

        //Calculates the product
        product = variable * number; 
```

您正在尝试将 a`double (variable)`与`EditText (number)`类型相乘，因此`Error`

**编辑您的局部变量错误：**

`local variables`不要获取它们的`default`值，`initialize`在方法中使用它们之前必须先获取它们

```
 public void onclick(View view)
    {
        //Makes a variable for the entered number
        Double amount=0.0; //initialize this
        Double product=0.0;//initialize this
        Double variable=0.0;//initialize this 
```

# android - EditText 选择锚点

> ID：13148186
> 
> 赞同：5
> 
> 时间：2012-10-30T21:58:20.830
> 
> 标签：android

我有一个列表视图，其中每一行都是一个 EditText，带有一些文本。当我点击一行时，EditText 获得焦点，显示闪烁的光标和选择锚点（您知道拖动以选择一系列文本的蓝色/灰色外观手柄）。

**问题**是，当我从一行移动到另一行（edittext 到另一行）时，没有输入新文本，前一个 edittext 中的选择锚点仍然可见一段时间。如果编辑文本没有焦点，我想立即隐藏这个锚点。

有任何想法吗？

**ClearFocus 不起作用**

```
 editText.setOnFocusChangeListener(new OnFocusChangeListener() {             
            public void onFocusChange(View v, boolean hasFocus) {
                if(hasFocus) {

                } else {
                    editText.clearFocus();
                    //editText.clearComposingText();                        
                }
            }
        }); 
```

**截屏**

![问题](../Images/3266fe57ccf70a018e6d673bc87ecb5d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T00:10:15.303

我终于明白了！首先，我从`ListView`. 然后我写了一个自定义`OnFocusChangeListener`，从失去焦点的视图中删除选择。此侦听器通过自定义适配器应用于视图（我包装了`ArrayAdapter`，但您也可以包装 a `SimpleCursorAdapter`）。

附件是一个演示（在带有 Eclair 的模拟器上测试）：

```
public class ListOfEditViews extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        ListView list = new ListView(this);
        list.setAdapter(getAdapter());
        list.setFocusable(false);
        list.setFocusableInTouchMode(false);

        setContentView(list);
    }

    private ListAdapter getAdapter() {
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.edit_text, R.id.text) {

            @Override
            public View getView (int position, View convertView, ViewGroup parent) {
                View view = super.getView(position, convertView, parent);
                view.setFocusable(true);
                view.setFocusableInTouchMode(true);
                view.setOnFocusChangeListener(listener);
                return view;
            }
        };

        String words = "Lorem ipsum dolor sit amen";

        for (String word: words.split(" "))
            adapter.add(word);

        return adapter;
    }

    private OnFocusChangeListener listener = new OnFocusChangeListener() {

        public void onFocusChange(View view, boolean hasFocus) {
            view.dispatchWindowFocusChanged(hasFocus);
        }
    };
} 
```

# loading - 分区表中的 Hive 加载

> ID：13148187
> 
> 赞同：17
> 
> 时间：2012-10-30T21:58:30.310
> 
> 标签：loading, hive

我在 HDFS 中有一个日志文件，值用逗号分隔。例如：

`2012-10-11 12:00,opened_browser,userid111,deviceid222`

现在我想将此文件加载到具有列“timestamp”、“action”并按“userid”、“deviceid”分区的 Hive 表中。如何要求 Hive 将日志文件中的最后 2 列作为表的分区？所有示例`e.g. "hive> LOAD DATA INPATH '/user/myname/kv2.txt' OVERWRITE INTO TABLE invites PARTITION (ds='2008-08-15');"`都需要在脚本中定义分区，但我希望从 HDFS 文件自动设置分区。

一种解决方案是创建包含所有 4 列的中间非分区表，从文件中填充它，然后创建一个`INSERT into first_table PARTITION (userid,deviceid) select from intermediate_table timestamp,action,userid,deviceid;`但那是额外的任务，我们将有 2 个非常相似的表。或者我们应该创建外部表作为中间表。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-05T00:45:56.070

Ning Zhang 在[http://grokbase.com/t/hive/user/114frbfg0y/can-i-use-hive-dynamic-partition-while-loading-data-into-tables](http://grokbase.com/t/hive/user/114frbfg0y/can-i-use-hive-dynamic-partition-while-loading-data-into-tables)对此话题有很好的回应。

快速的上下文是：

1.  加载数据只是复制数据，它不读取数据，因此无法确定要分区的内容
2.  建议您首先将数据加载到中间表中（或使用指向所有文件的外部表），然后让分区动态插入启动以将其加载到分区表中

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-04-23T13:48:37.077

1.  正如@Denny Lee 的回答中提到的，我们需要涉及一个托管或外部的临时表（invites_stg），然后从临时表插入到分区表（在这种情况下为邀请）。

2.  确保我们将这两个属性设置为：

    ```
    SET hive.exec.dynamic.partition=true;
    SET hive.exec.dynamic.partition.mode=nonstrict; 
    ```

3.  最后插入邀请，

    ```
    INSERT OVERWRITE TABLE India PARTITION (STATE) SELECT COL's FROM invites_stg; 
    ```

请参阅此链接以获取帮助：[http ://www.eduristine.com/blog/hive-partitions-example](http://www.edupristine.com/blog/hive-partitions-example)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-11T14:59:34.863

我处理了同样的场景，但是我们所做的是为您需要加载的每个分区创建单独的 HDFS 数据文件。

由于我们的数据来自 MapReduce 作业，因此我们在 Reducer 类中使用[MultipleOutputs](http://hadoop.apache.org/docs/mapreduce/r0.21.0/api/org/apache/hadoop/mapreduce/lib/output/MultipleOutputs.html)将数据多路复用到相应的分区文件中。之后，只需使用 HDFS 文件名中的分区构建脚本即可。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-11-23T10:48:43.567

怎么样

`LOAD DATA INPATH '/path/to/HDFS/dir/file.csv' OVERWRITE INTO TABLE DB.EXAMPLE_TABLE PARTITION (PARTITION_COL_NAME='PARTITION_VALUE');`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-09-12T07:34:18.177

```
CREATE TABLE India (

OFFICE_NAME STRING,

OFFICE_STATUS     STRING,

PINCODE           INT,

TELEPHONE   BIGINT,

TALUK       STRING,

DISTRICT    STRING,

POSTAL_DIVISION   STRING,

POSTAL_REGION     STRING,

POSTAL_CIRCLE     STRING

)

PARTITIONED BY (STATE   STRING)

ROW FORMAT DELIMITED

FIELDS TERMINATED BY ','

STORED AS TEXTFILE; 
```

5.指示hive动态加载分区

```
SET hive.exec.dynamic.partition = true;

SET hive.exec.dynamic.partition.mode = nonstrict; 
```

# jquery - 可访问键盘的滑动面板

> ID：13148189
> 
> 赞同：2
> 
> 时间：2012-10-30T21:58:41.357
> 
> 标签：jquery, jpanel, accessibility, jquery-events, slidetoggle

在以下代码中，如何使我的滑动面板键盘可访问？如果面板是打开的，我可以看到它通过链接标签，但它没有打开面板。我尝试将 .hover 更改为 .click、.keypress 等，甚至将其绑定到两个事件（悬停和单击）均无济于事。不幸的是，我的脚本天赋很少。任何帮助，将不胜感激！

**CSS：**

```
/* slide panel */

#sidePanel {width:550px; position:fixed; left:-485px; top:30%;}

    #panelHandle {background-color:#176233; border:solid 1px #fbfbfb; background-image:-webkit-linear-gradient(bottom, #297847, #176233); 
        background-image:-moz-linear-gradient(bottom, #297847, #176233); background-image:-o-linear-gradient(bottom, #297847, #176233); 
        background-image:-ms-linear-gradient(bottom, #297847, #176233); background-image:linear-gradient(to top, #297847, #176233); height:150px; width:50px; 
        border-radius:0 5px 5px 0; float:left; cursor:pointer;}

        #panelHandle p {-moz-transform:rotate(90deg); -webkit-transform:rotate(90deg); color:#fff; font-size:24px; font-weight:bold; left:-50px; margin:0; padding:0;
            position:relative; top:55%; width:150px;}

    #panelContent{float:left; border:1px solid #333333; width:480px; height:400px; background-color:#fff;} 
```

**脚本：**

```
jQuery(function($) {
    $(document).ready(function() {
        $('#panelHandle').hover (function () {
            $('#sidePanel').stop(true, false).animate({
                'left': '0px'
            }, 900);
        }, function() {
            jQuery.noConflict();
        });

        jQuery('#sidePanel').hover (function () {
            // Do nothing
        }, function() {

            jQuery.noConflict();
            jQuery('#sidePanel').animate({

                left: '-485px'
            }, 800);

        });
    });
}); 
```

**HTML：**

```
<div id="sidePanel">
            <div id="panelContent">

                <div class="col1 left20" id="taskPane">
                    <br class="clear" />

                    <table title="My Tasks" class="rounded-corners bottom40 cal">
                        <thead>
                            <tr>
                                <th id="reqNum1" title="Request Number" class="left40">Request #</th>
                                <th id="taskid1" title="Task">Task</th>
                                <th id="dueDat1" title="Due Date">Due</th>
                            </tr>
                        </thead>

                        <tbody>            
                            <tr>
                                <td headers="reqNum1" class="left40"><a href="#" accesskey="c">12345678</a></td>
                                <td headers="taskid1">Task Name</td>
                                <td headers="taskCat">09/03/12</td>
                            </tr>

                            <tr>
                                <td headers="reqNum1" class="left40"><a href="#">12345678</a></td>
                                <td headers="taskid1">Task Name</td>
                                <td headers="taskCat">09/03/12</td>
                            </tr>

                            <tr>
                                <td headers="reqNum1" class="left40"><a href="#">12345678</a></td>
                                <td headers="taskid1">Task Name</td>
                                <td headers="taskCat">09/03/12</td>
                            </tr>

                            <tr>
                                <td headers="reqNum1" class="left40"><a href="#">12345678</a></td>
                                <td headers="taskid1">Task Name</td>
                                <td headers="taskCat">09/03/12</td>
                            </tr>

                            <tr>
                                <td headers="reqNum1" class="left40"><a href="#">12345678</a></td>
                                <td headers="taskid1">Task Name</td>
                                <td headers="taskCat">09/03/12</td>
                            </tr>

                            <tr>
                                <td headers="reqNum1" class="left40"><a href="#">12345678</a></td>
                                <td headers="taskid1">Task Name</td>
                                <td headers="taskCat">09/03/12</td>
                            </tr>

                            <tr>
                                <td headers="reqNum1" class="left40"><a href="#">12345678</a></td>
                                <td headers="taskid1">Task Name</td>
                                <td headers="taskCat">09/03/12</td>
                            </tr>

                            <tr>
                                <td headers="reqNum1" class="left40"><a href="#">12345678</a></td>
                                <td headers="taskid1">Task Name</td>
                                <td headers="taskCat">09/03/12</td>
                            </tr>
                        </tbody>
                    </table>
                <br class="clear" />

                    <div class="col6 small centerText top60">
                        <a href="#"><span class="icon-previous-2 iconsMedL" title="First Record"></span></a> 
                        <a href="#"><span class="icon-previous left60 iconsMedL" title="Page Back"></span></a></div>
                    <div class="centerText pagination">
                                        <a href="#" class="endPipesm">1 </a>
                                        <a href="#" class="endPipesm">2 </a>
                                        <a href="#" class="endPipesm">3 </a>
                                        <a href="#" class="endPipesm">4 </a>
                                        <a href="#">5 </a>
                                    </div>
                    <div class="col6 small centerText"> 
                        <a href="#"><span class="icon-next-2 iconsMedR rightText" title="Last Record"></span></a> 
                        <a href="#"><span class="icon-next iconsMedR right60 rightText" title="Next Page"></span></a></div>

                </div><!-- end tasks and pending requests -->

            </div>

            <div id="panelHandle"><p>My Tasks</p></div>
      </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T15:00:30.650

你遗漏了一些代码吗？除非我遗漏了什么，否则我看不到你在哪里制作绿色任务按钮/东西。据我所知，没有任何焦点，所以你需要允许有焦点。

完成此操作后，您需要在 taskPane ID 上放置一个事件侦听器，以便当焦点移至按钮时，会显示 taskPane。您必须以某种方式将其锁定，因此当您再次点击选项卡以打开请求 # 时，您将需要使用`focus()`,`focusin()`和`focusout()`.

# tsql - T-SQL 游标中的无限循环

> ID：13148192
> 
> 赞同：2
> 
> 时间：2012-10-30T21:59:13.917
> 
> 标签：tsql, cursor

下面是 T-SQL 游标的代码。它在第一次迭代中工作正常，但是之后陷入在 FETCH NEXT 语句和 IF NOT EXISTS 语句之间的无限循环中（基本上它会插入第一条记录，但是之后光标不会移动到下一条记录所以 IF NOT EXISTS 永远是错误的）。这是我第一次使用光标，所以希望有人能解释发生了什么/如何使这件事起作用！

```
 DECLARE prod_cursor CURSOR FOR
    SELECT ProductCode 
    FROM CourseToProduct 
    WHERE CourseCode = @courseCode and (TerminationDate >= @expDate OR TerminationDate IS NULL)

    OPEN prod_cursor

    FETCH NEXT FROM prod_cursor
    INTO @productCode

    WHILE @@FETCH_STATUS = 0
    BEGIN
        IF NOT EXISTS
        (
        SELECT sNumber
        FROM AgentProductTraining
        WHERE @sNumber = sNumber and 
              @courseCode = CourseCode and 
              @productCode = ProductCode and 
              @dateTaken = DateTaken
        )
        BEGIN
            IF @sNumber IS NOT NULL
            BEGIN
                INSERT INTO AgentProductTraining
                            (
                             sNumber,
                             CourseCode,
                             ProductCode,
                             DateTaken,
                             DateExpired,
                             LastChangeOperator,
                             LastChangeDate
                            ) 
                VALUES      (
                             @sNumber,
                             @courseCode,
                             @productCode,
                             @dateTaken,
                             COALESCE(@expDate, 'NULL'),
                             @lastChangeOperator,
                             @lastChangeDate
                           )    
            END
        END
    END
    CLOSE prod_cursor;
    DEALLOCATE prod_cursor; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-30T22:04:08.923

您必须获取中的下一行，`while..end`否则它将永远不会移动到下一条记录。像这样：

```
DECLARE prod_cursor CURSOR FOR
SELECT ProductCode 
FROM CourseToProduct 
WHERE CourseCode = @courseCode and (TerminationDate >= @expDate OR TerminationDate IS NULL)

OPEN prod_cursor

FETCH NEXT FROM prod_cursor
INTO @productCode

WHILE @@FETCH_STATUS = 0
BEGIN
    IF NOT EXISTS
    (
    SELECT SymetraNumber
    FROM AgentProductTraining
    WHERE @symetraNumber = SymetraNumber and 
          @courseCode = CourseCode and 
          @productCode = ProductCode and 
          @dateTaken = DateTaken
    )
    BEGIN
        IF @symetraNumber IS NOT NULL
        BEGIN
            INSERT INTO AgentProductTraining
                        (
                         sNumber,
                         CourseCode,
                         ProductCode,
                         DateTaken,
                         DateExpired,
                         LastChangeOperator,
                         LastChangeDate
                        ) 
            VALUES      (
                         @sNumber,
                         @courseCode,
                         @productCode,
                         @dateTaken,
                         COALESCE(@expDate, 'NULL'),
                         @lastChangeOperator,
                         @lastChangeDate
                       )    
        END
    END

    FETCH NEXT FROM prod_cursor
    INTO @productCode
END
CLOSE prod_cursor;
DEALLOCATE prod_cursor; 
```

# iphone - 动态改变 UITableViewController 的 scrollEnabled 属性

> ID：13148198
> 
> 赞同：0
> 
> 时间：2012-10-30T21:59:55.927
> 
> 标签：iphone, ios, uitableview, uiscrollview

我有一个应用程序，它有 UITableViewController，默认情况下有 scrollEnabled。但在某些情况下，我想禁用滚动。所以我添加方法

```
- (void)scrollEnable:(BOOL)enable
{
    self.tableView.scrollEnabled = enable
    NSLog(enable ? @"Yes" : @"No");
} 
```

当我想切换滚动时，我会触发该方法，因为我登录了控制台。但它不会对滚动产生任何影响。如果我在 viewDidLoad 中将此属性设置为 NO，则滚动将被禁用。但是在这种方法中，这个属性不会改变任何东西。我确保这个方法被调用但不会改变任何东西。有没有办法动态改变这个属性。

因此，当我使用您的建议时，它没有帮助。self.tableView 不是 nil 并且该方法被正常调用。这是方法：

```
- (void)scrollEnable:(BOOL)enable
{
    if (_enable)
    {
        NSLog(@"ENABLE");
        [self.tableView setScrollEnabled:YES];
    }
    else
    {
        NSLog(@"DISABLE");
        [self.tableView setScrollEnabled:NO];
    }
} 
```

# c - 定义函数并传递结构值

> ID：13148204
> 
> 赞同：0
> 
> 时间：2012-10-30T22:00:23.223
> 
> 标签：c, function, struct, declare

我是 C 新手，我有几个关于将结构值放入函数以及声明函数的正确方法的问题。

在我的 common.h 我已经定义

```
extern struct ddrautocal;
int get_eeprom_vals(uchar); // is this the correct declare the function? 
```

在calibration.c中，我定义了我的结构并更改了一些设置一些值（未显示）

```
#include <common.h>
struct ddrautocal {
    u32 wdtr;
    u32 clkp;
    u32 rdcc;
}; 
```

在proc.c中

```
#include <common.h>
int get_eeprom_vals(struct ddrautocal *cal){
// I'd like to access cal.wdtr and cal.clkp
} 
```

我是一个彻头彻尾的呆子，我知道，但我正在努力变得更好。我一整天都在努力让它工作，并想知道我是否在 common.h 中正确声明了该函数，以及在位于 proc.c 的 get_eeprom_vals 函数中访问 ddrautocal 结构的正确方法是什么任何帮助都会不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:06:03.650

`int get_eeprom_vals(uchar);`签名错误..应该是：

`int get_eeprom_vals(struct ddrautocal *cal);`所以前向声明和函数定义的签名匹配。

要访问成员，您需要：`cal->wdtr`，`cal->clkp`或`(*cal).wdtr (*cal).clkp`

-> 使用指针间接运算符。* 是间接运算符和句点（点）的组合，用于访问该字段。

我也认为你需要`#include "common.h"`而不是`#include <common.h>`common.h 不是系统头文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:28:50.237

首先要知道的是，我们必须确保函数的声明和它的定义相互匹配。在您的情况下，定义具有签名：

`int get_eeprom_vals(struct ddrautocal *cal)`

（函数的签名包括其名称和参数列表）。

您需要将声明替换为：

```
int get_eeprom_vals(struct ddrautocal *cal); 
```

此外，如果您想使用句点来取消引用结构的成员，您可以如下声明您的函数，然后您可以将其成员引用为您所显示的

```
int get_eeprom_vals(struct ddrautocal cal);
{
     // you can use cal.wdtr etc
} 
```

# javascript - 用 f 替换 js 函数关键字

> ID：13148207
> 
> 赞同：2
> 
> 时间：2012-10-30T22:00:37.250
> 
> 标签：javascript, jquery

我想知道是否可以执行以下操作：

```
var f = function; 
```

而不是`f`像使用 js`function`关键字一样使用

*如果这样的事情是可能的，我会用它来最小化 js 代码，因为我的代码中有很多功能*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:12:22.297

与 Pointy 在评论中指出的类似，您可以做的是使用函数构造函数创建一个新函数并将其作为字符串传递。换句话说：

```
function f(s) { return new Function(s) };
var foo = f('var s = "hello"; return s');
alert(foo()); //=> "hello" 
```

但同样，我认为这是不必要的。

**编辑：**要添加参数，您将使用该`arguments`对象。

```
function f() {
  var args = Array.prototype.slice.call(arguments);
  var func = args.pop();
  return new Function(args.join(','), func);
}

var add = f('a,b', 'return a + b'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T22:05:46.863

不可能按照你描述的那样做。

我能想到的最接近的是制作一个用于生成函数的函数，使用 eval 来解析传递的字符串。然而，使用 eval 通常是邪恶的，应该避免。总的来说，我不建议做这样的事情。

此外，值得注意的是，做你想做的事没有什么意义，因为通过网络发送的 javascript 应该首先被压缩，所以无论单词有多长，单词 function 都将由一个标记表示。

如果您希望您的源代码更具可读性和简洁性，我会推荐可编译为 javascript 的咖啡脚本，并允许您在不使用函数的第一个字母的情况下定义函数。Chuck Norris 会同意的！

## 结论和建议摘要

*   使用咖啡脚本来获取免费源代码
*   将其编译为您从未看过的详细 javascript
*   缩小那个javascript（uglify是一个很棒的压缩器，或者google的关闭）
*   gzip 它（将很好地压缩重复的字符串）
*   发送

这里的关键问题是压缩后，单词的大小`function`变得无关紧要，因此唯一剩下的问题是源代码的可读性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T22:07:57.213

是的...老实说，我不会担心尝试将函数关键字缩短为“f”，这会给您的工作带来很少的回报，而且还会损害代码的可读性。而且，除非你有类似一百万个函数，否则我不会专注于此。正如@prodigitalson 所说 - 通过缩小器运行它。这应该考虑到代码中可能的真正缩小，并且仍然保持代码库的可读性（这比节省几个字节更重要）。

另外，根据我的评论，有一些东西（可能）正在取代长的“功能”关键字（布伦丹·艾希（Brendan Eich）说过他会考虑改变 - 你必须记住他在 10 天左右设计了语言） . 在这里阅读更多相关信息：[Fat Arrow Syntax](http://javascriptweblog.wordpress.com/2012/04/09/javascript-fat-city/)当然，这类事情总是可以改变的……但是标准定义机构正在研究它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T22:15:09.600

[您可以使用http://sweetjs.org/](http://sweetjs.org/)的卫生宏功能来做到这一点

# java - JNA回调函数作为参数

> ID：13148208
> 
> 赞同：1
> 
> 时间：2012-10-30T22:01:05.563
> 
> 标签：java, callback, jna

我正在尝试使用 JNA 使用来自 Java 的本机 dll。我是 Java 和 JNA 的新手。我在使用回调函数作为 dll 导出方法的函数参数时遇到问题。

这是本机函数的外观，

```
RegisterCallback(UNUM32 hMod, UNUM32 hCLL, CALLBACKFNC EventCallbackFunction) 
```

这个方法基本上告诉 DLL 在 DLL 检测到某些事件时使用这个 java 方法作为回调。

这是回调函数原型，

```
EventCallbackFunction(UNUM32 eventType, UNUM32 hMod, UNUM32 hCLL, void *pCTag,   void *pTag) 
```

这是java端的实现，

```
Library.INSTANCE.RegisterCallback(hMod, hCLL, eventCallbackFunction); 
```

eventCallbackFunction 看起来像这样，

```
public interface EventCallbackInterface extends Callback {

public void callback(int eventType, int hMod,  int hCll, Pointer clltag, Pointer apiTag); 
```

}

```
 public class Bridge{
public static EventCallbackInterface eventCallbackFunction = new EventCallbackInterface(){

    public void callback(int eventType, int hMod,  int hCll, Pointer clltag, Pointer apiTag) { System.out.println("Into the callback function: ");} 
```

} }

我没有看到任何崩溃，但即使 DLL 识别出正确的事件，它也无法正常工作。有人可以在这方面帮助我吗？提前谢谢了 ！

# c# - XNA 不响应代码更改

> ID：13148217
> 
> 赞同：1
> 
> 时间：2012-10-30T22:02:18.890
> 
> 标签：c#, xna

最简单的解释是，当我在我的 XNA 项目中编辑、删除或添加代码时，它没有响应。这就是说我可以注释掉我游戏的整个 Update 方法，它会照常运行。这也意味着游戏在开发中被卡在了某个时间，无法编辑。我试过重新打开我的项目，但没有帮助。我以前遇到过这个问题，这令人难以置信的愤怒和沮丧。

[http://puu.sh/1kD6P](http://puu.sh/1kD6P) 这是一张我已经注释掉 Update 方法的图像，并且通常永远无法运行 66 错误。但它确实运行。

在过去，我不得不创建新项目并将我所有的艺术资产和代码副本拖过来。这是我知道修复它的唯一方法，但我的每个项目都发生了这种情况（甚至以前在不同的计算机上）。

有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:05:10.147

您是否尝试过从构建菜单重新构建它，而不仅仅是单击调试按钮？

# objective-c - 使用objective-c获取coldfusion生成的JSON

> ID：13148221
> 
> 赞同：0
> 
> 时间：2012-10-30T22:02:29.607
> 
> 标签：objective-c, json, coldfusion, nsurlrequest

通过访问 url test.com/test.cfm，我可以输出以下内容：

```
{"COLUMNS":["OBJID","USERNAME","USERPASSWORD","USERFNAME","USERMI","USERLNAME","COMPANY","TBLCOMPANYID","TBLTITLE","USERADDRESS1","USERADDRESS2","USERCITY","USERSTATE","USERZIP","USERSIGNATUREFILE","USERBUSINESSNUMBER","USERBUSINESSEXT","USERFAXNUMBER","USERCELLNUMBER","USEROTHERNUMBER","USEREMAIL1","USEREMAIL2","USEREMAIL3","DEFAULTPROJECTID","SIGNATURE","SIGNATUREUPLOADBY","SORTORDER","DISABLESTATUS","UUID","SITEID","PROGRAMID"],
"DATA":[[1,"test",11214.0,"admin","","admin","adf Inc.",1,1,"admin","","","California","","","",null,"","","","admin@test.com","","",0,null,null,0,false,"468373c5-1234-1234-1234-3133a2bb1679",62,1]]} 
```

要遍历这个，我首先需要使用这个来获取数据？

```
NSMutableData *receivedData;
    NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL     URLWithString:@"test.com/test.cfm"]
                                          cachePolicy:NSURLRequestUseProtocolCachePolicy
                                      timeoutInterval:60.0];
// create the connection with the request
// and start loading the data
NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:receivedData];
if (theConnection) {
    // Create the NSMutableData to hold the received data.
    // receivedData is an instance variable declared elsewhere.        
    NSLog(@"test = %@",receivedData);
} else {
    // Inform the user that the connection failed.
} 
```

我在正确的轨道上吗？输出显示为空...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:33:05.813

你没有分配任何东西给`receivedData`; 它要么是`nil`（在 ARC 下），要么是一个未定义的值，可能是也可能不是`nil`（在非 ARC 下）。您创建了一个可用于启动 URL 连接的对象，但没有对其进行任何操作。您也可能没有得到有效的`NSURL`，因为您没有指定 URI 方案（即 http://）。

可能最简单的事情（假设至少 iOS 5 和/或 OS X v10.7）是使用`NSURLConnection`'s`+sendAsynchronousRequest:queue:completionHandler:`然后`NSJSONSerialization`解析结果。例如

```
NSURLRequest *theRequest = 
            [NSURLRequest 
                 requestWithURL:[NSURL URLWithString:@"http://test.com/test.cfm"]
                    cachePolicy:NSURLRequestUseProtocolCachePolicy
                timeoutInterval:60.0];

// or just use [NSURLRequest requestWithURL:[NSURL ...]], since the
// protocol cache policy and a 60s timeout are the default values anyway

[NSURLConnection
   sendAsynchronousRequest:theRequest
   queue:[NSOperationQueue mainQueue]
   completionHandler:
        ^(NSHTTPURLResponse *urlResponse, NSData *data, NSError *error)
        {
            // catch all for connection errors...
            if(
                (urlResponse.statusCode < 200) ||
                (urlResponse.statusCode >= 300) || // bad status code, e.g. 404
                error || // error is non-nil would imply some other error
                ![data length] // data returned was empty
             )
             {
                  // report some sort of connection error
                 return;
             }

             NSError *jsonError = nil;
             id <NSObject> returnedJSONObject =
                [NSJSONSerialization
                          JSONObjectWithData:data options:0 error:&jsonError];
             if(jsonError)
             {
                   // server returned unintelligible JSON...
                   return;
             }

             NSLog(@"Got object %@", returnedJSONObject);

             // then, e.g.
             if(![jsonObject isKindOfClass:[NSDictionary class]])
             {
                 // server didn't return a dictionary
                 return;
             }

             NSArray *columns = [jsonObject objectForKey:@"COLUMNS"];
             if(![columns isKindOfClass:[NSArray class]])
             {
                  // server returned no COLUMNS object, or that
                  // object wasn't an array
                  return;
             }

             NSLog(@"columns are %@", columns);

             /* etc, etc */
        }]; 
```

如果您找不到自动化的方法，那么类类型检查的内容很快就会变得非常乏味，但这都是与您的问题没有直接关系的验证内容。

上面实现的是它发送一个对URL内容的异步（即非阻塞）请求。结果累积在主队列中（即，您通常进行用户交互的同一位置）。一旦整个 HTTP 操作完成，您在底部指定的代码就会被调用，并验证和解析响应。它是同步进行的，因此会阻塞，但除非分析表明值得担心，否则这不值得担心。

内置解析器用于 JSON，直到“得到对象”的所有内容实际上只是确保获取和解析成功。它可能不完整——如果你能想到任何其他可能出错的地方，那么不要以为我故意忽略了它。

那时你只有一个未知类型的对象，但由于 JSON 的基本原理，它通常是字典或数组。因此，示例代码测试它确实是一个字典，然后使用普通`NSDictionary`接口获取“COLUMNS”键的对象。如果您尝试调用`objectForKey:`数组，则会引发异常，因为数组不实现该方法。

然后它相当死记硬背——代码检查存储为“COLUMNS”的对象是一个数组。根据 JSON 规则，它可能是另一个字典或字符串或其他一些东西之一。可能有趣的是代码调用`isKindOfClass:`以测试是否找到了一个对象，并且它是一个单一调用中的数组；之所以有效，是因为明确允许向其发送任何消息，`nil`并且结果将始终为`nil`，看起来与 BOOL NO 相同。

# asp.net - 在 Nancy 模块中访问 IIS 服务器变量

> ID：13148226
> 
> 赞同：0
> 
> 时间：2012-10-30T22:03:22.830
> 
> 标签：asp.net, nancy

Nancy.Request 对象替换了 System.Web.HttpRequest 对象，您通常可以在其中找到 ServerVariables 集合。还有其他方法可以获取这些信息吗？具体来说，我需要 LOGON_USER 对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T23:35:02.417

从模块内部，您可以调用

```
Context.CurrentUser.UserName 
```

这是 Nancy 特定的调用，并[假定某些容器填充它](https://groups.google.com/forum/?fromgroups=#!topic/nancy-web-framework/n9X6yg5pI0w)。否则，上下文将为空。

如果您在常规 ASP.NET 环境中托管 Nancy，您仍然可以尝试

```
System.Web.HttpContext.Current.Request.ServerVariables["LOGON_USER"] 
```

# image-processing - 检测多模态灰度图像上的模糊矩形

> ID：13148228
> 
> 赞同：5
> 
> 时间：2012-10-30T22:03:56.380
> 
> 标签：image-processing, opencv, feature-detection

我有以下图片![矩形图案板](../Images/78835b07f879ff2dd883d0de3d4bebff.png)

我正在尝试查找主矩形（白线之间的那些）的像素坐标。我尝试了几件事，但我无法获得足够好的解决方案。解决方案不一定是完美的，如果不是所有矩形都被检测到（尤其是那些非常小的矩形），那也没关系。虽然角落的位置必须尽可能准确，尤其是那些更大的模糊（我正在尝试编写一些简单的 AR 引擎）。

我可以澄清一下，只有 4 级灰度：0、110、180 和 255（打印时，没有屏幕会因为闪电和阴影而变化）

到目前为止，我尝试了几件事：

1.  手动多级阈值（因为阴影和不同的闪电它不起作用）
2.  自适应阈值：2个问题：
    *   它将 180 和 255 色组合成白色，将 0、110 组合成黑色
    *   模糊（较大）矩形的边缘/角位置不准确（它会为矩形区域添加模糊）
3.  sobel 边缘检测（模糊矩形的角更清晰，但它也检测矩形中的内边缘，这些边缘轮廓也不总是闭合的

看起来将这两者结合起来会以某种方式产生更好的结果。或者也许有人有不同的想法？

我也在考虑做floodfill，但是很难自动找到确定好的种子点和阈值（背景中可能还有一些其他的白色物体）。此外，我稍后将要针对 GPU 进行优化，而洪水填充算法并不适合此。

以下是我到目前为止尝试的一些示例代码：

```
image = cv2.imread('data/image.jpg');
gray  = cv2.cvtColor(image,cv2.COLOR_BGR2GRAY)
cv2.imshow('image', gray) 

adaptive = cv2.adaptiveThreshold(gray, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY, 601, 0)
cv2.imshow('adaptive', adaptive)

gradx = cv2.Sobel(gray, ddepth=cv2.CV_32F, dx=1, dy=0, ksize=3)
grady = cv2.Sobel(gray, ddepth=cv2.CV_32F, dx=0, dy=1, ksize=3)
abs_gradx = cv2.convertScaleAbs(grady)
abs_grady = cv2.convertScaleAbs(grady)
grad = cv2.addWeighted(abs_gradx, 0.5, abs_grady, 0.5, 0)

kernel = cv2.getStructuringElement(cv2.MORPH_CROSS,(5,5))
grad = cv2.morphologyEx(grad, cv2.MORPH_OPEN, kernel)
grad = cv2.morphologyEx(grad, cv2.MORPH_CLOSE, kernel)
cv2.imshow('sobel',grad)

#kernel = cv2.getStructuringElement(cv2.MORPH_CROSS,(7,7))
#grad = cv2.morphologyEx(grad, cv2.MORPH_OPEN, kernel)
retval, grad = cv2.threshold(grad, 10, 255, cv2.THRESH_BINARY)
cv2.imshow('sobel+morph+thrs',grad)

cv2.waitKey() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T09:16:21.380

我相信您的答案在于使用霍夫变换来检测线条，将这些线条延伸到较暗方块之间的中断处，然后寻找相交标记出角落。我在 Matlab 中进行了快速操作，并提出了以下建议，它并不完美，但应该显示出潜力：

```
% Open image
i = imread('http://i.stack.imgur.com/kwcXm.jpg');

% Use a sharpening filter to enhance some of the edges
H = fspecial('unsharp');
i = imfilter(i, H, 'replicate');
% Detect edge segments using canny
BW = edge(i, 'canny');

% Apply hough transform to edges
[H, T, R] = hough(BW, 'RhoResolution', 0.5, 'Theta', -90:0.5:89.5);
% Find peaks in hough transform
P = houghpeaks(H, 5, 'threshold', ceil(0.1*max(H(:))));
% Extract lines from peaks, extending partial lines
lines = houghlines(BW, T, R, P, 'FillGap', 100, 'MinLength', 5);

% Plot detected lines on image
imshow(i); hold on;
for k = 1:length(lines)
   xy = [lines(k).point1; lines(k).point2];
   plot(xy(:,1),xy(:,2),'LineWidth',2,'Color','green');
end 
```

最终结果：

![最后结果](../Images/d69174c729b16553999ccf391ee52df9.png)

显然还有改进的余地，仍有许多线条需要检测，但如果调整各种参数不起作用，您可以获取初始结果并搜索更多具有相似角度的线条以获得更完整的集合。然后可以从相交中找到角点，这些角应该足够简单以便提取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:13:32.393

我会尝试以下方法：

*   [霍夫变换](http://en.wikipedia.org/wiki/Hough_transform)检测所有直线
*   寻找一组平行线，它们是：
    *   有足够的距离
    *   由浅色隔开

有几件事会使您的问题变得比实际需要的更棘手：

*   透视失真
*   光照变化，轻微阴影

如果您可以将上述内容最小化，它可能有助于解决问题。

# php - 无法理解 JSend 中 LZW 解压的 php 函数

> ID：13148230
> 
> 赞同：0
> 
> 时间：2012-10-30T22:04:05.690
> 
> 标签：php, javascript, compression, lzw

我正在尝试将 LZW 解压缩器从php 中的[JSend](http://jsend.org/)转换为 javascript，并且我得到了一个我不太理解的函数。

```
 private static function decompressLZW($aCodes) 
  {
    $sData = '';
    $oDictionary = range("\x0000", "\xff");
    foreach ($aCodes as $sKey => $iCode) 
    {
      $sElement = $oDictionary[$iCode]; 
      if (!isset($sElement))
          $sElement = $sWord . $sWord[0];
      $sData .= $sElement;
      if ($sKey)
          $oDictionary[] = $sWord . $sElement[0];
      $sWord = $sElement;
    }
    return $sData;
  } 
```

到目前为止，这是我在 javascript 中所拥有的，但是当我在 javascript 中运行它时，它抱怨`sWord`没有定义并查看 php 函数，我看不出这不会产生错误？

到目前为止，这是我在 javscript 中的内容：

```
function decompressLZW(aCodes) {
  var sData = '';
  var oDictionary = [];

  for (var i = 0; i < 256; i++) {
    oDictionary[String.fromCharCode(i)] = i; 
  }

  for(var i=0, iLn = aCodes.length; i < iLn; i++) {
    var sElement = oDictionary[aCodes[i]];

    if(!sElement) {
      sElement = sWord + sWord[0];
    }

    //some magic needs to happen here
  }

  return sData;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:12:33.227

好吧，它是一种糟糕的 IMO，但是....`$sWord`本质`$sElement`上是在迭代结束时定义的。他们指望前两个 if 语句仅在至少一次循环运行后才为真，在这种情况下`$sWord`，与前一次迭代的`$sElement`.

我不确定这个假设的意义是什么，但如果是我，我仍然会测试是否存在`$sWord`并在发生这种情况时抛出异常（即使理论上它不应该发生）......

所以你需要弄清楚为什么不`sElement = oDictionary[aCodes[i]];`评估真实的东西。它可能就像测试 angainst `undefined`（更像是做`isset()`）而不是做松散的虚假检查一样简单。

```
if(sElement === undefined) {
  sElement = sWord + sWord[0];
} 
```

# python - Python：不按顺序使用查找函数

> ID：13148233
> 
> 赞同：0
> 
> 时间：2012-10-30T22:04:12.840
> 
> 标签：python, operator-keyword, operator-precedence

因此，下面的代码采用一串输入信息（数学表达式），并使用 find 函数在 "*/+-" 中找到一个运算符并相应地分隔字符串。

```
def splitting1(z):
    for operators in "*/+-":
        if operators in z:
            position1= z.find(operators)
            position2= z.rfind(operators)
            text_before_operators= (z[:position1]).strip()
            text_after_operators= (z[(position1+1):(position2)]).strip()
            return text_before_operators,text_after_operators 
```

我的问题是，如果我有一个输入表达式，例如`3/5*7`then`position1`会在 find`*`之前先找到`/`。我希望代码将“position1”与最左边的运算符相关联。使用 for/in 函数时有没有办法省略运算符优先级？如果没有，是否有更好的字符串操纵器可以省略优先顺序。

注意 z 是输入。并且输入仅限于两个运算符，以防产生歧义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:11:43.577

您正在迭代`*/+-`，因此找到的第一个字符是返回的第一个字符。

您基本上想找到所有这些运算符的索引，然后找到最大或最小的。尝试重写此函数以适用于字符串的另一端：

```
def find_operator_right(text):
    position = -1

    for oper in '*/+-':
        index = text.rfind(oper)

        if index > position:
            position = index

    return position 
```

一个稍微更 Pythonic 的解决方案是这样的：

```
right_index = max(map(text.rfind, '+-/*')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:27:38.750

看起来您正在尝试 lex，所以我建议您查看专门为此目的设计的模块，例如[`ply`](http://www.dabeaz.com/ply/ply.html).

.

这么说，我认为你在这个例子中是正确的，但是你错过了一些**递归**（为这些做一个更通用的词法分析器）：

```
def splitting1(z):
    for char in "*/+-":
        if char in z:
            position = z.find(char)
            text_before_operator= (z[:position]).strip()
            text_after_operator= (z[position+1:]).strip()
            return (char, splitting1(text_before_operator), splitting1(text_after_operator))
    return ("number", z) 
```

无论优先级如何，查找最左边的运算符的一种方法，即省略运算符优先级，是重新排列您迭代的内容：

```
def splitting2(z):
    for char in z:
        if char in "*/+-":
            position = z.find(char)
            text_before_operator= (z[:position]).strip()
            text_after_operator= (z[position+1:]).strip()
            return (char, splitting2(text_before_operator), splitting2(text_after_operator))
    return ("number", z) 
```

*请注意，这些函数会返回与原始函数不同的结果。*

# php - 排序多维数组 PHP

> ID：13148243
> 
> 赞同：-2
> 
> 时间：2012-10-30T22:05:10.060
> 
> 标签：php, sorting, multidimensional-array

如何对以下数组进行排序，以便将房屋排序为红色、绿色和蓝色（乔治：位置 0，史蒂夫：位置 [1]，弗雷德：位置 [2]）？

```
Array
(
    [catOne] => Array
        (
            [0] => Array
                (
                    [Opponent] => Steve
                    [House_Colour] => Green
                )

            [1] => Array
                (
                    [Opponent] => Fred 
                    [House_Colour] => Blue
                )

            [2] => Array
                (
                    [Opponent] => George 
                    [House_Colour] => Red
                )
        )

    [catTwo] => Array
        (
            [0] => Array
                (
                    [Opponent] => Peter 
                    [House Colour] => Green
                )

        )

) 
```

我尝试过使用 sort()、asort() 和 usort()，但没有什么能满足我的需要？

**编辑：**排序需要能够轻松更改。它可以是房屋颜色的任何顺序。使用的顺序只是一个例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:07:05.230

你可能想试试[`usort`](http://de.php.net/manual/en/function.usort.php)。它允许您对指定自定义回调函数的数组进行排序。由于您没有明确说明您要按照什么标准对物品进行排序，因此我无法真正帮助您使用该功能。（我的猜测是按字母顺序颠倒的，`House_Colour`但`Red > Green > Blue`我不确定你是否没有我忽略的另一个标准。）

这个简单的比较功能按照您指定的顺序按房屋颜色对条目进行排序，并且很容易修改为您真正想要的。每种颜色都有一个等级，您可以自行分配（您也可以轻松添加新颜色），您也可以通过翻转部件中的比较运算符轻松更改顺序`else if`。

```
function cmp($a, $b) {
    $colors = Array('RED' => 3, 'GREEN' => 2, 'BLUE' => 1);
    // A is ranked same as B
    if ($colors[$a['House_Colour']] == $colors[$b['House_Colour']]) {
        return 0;
    }
    // A is ranked above B
    else if ($colors[$a['House_Colour']] > $colors[$b['House_Colour']]) {
        return 1;
    }
    // A is ranked below B
    else {
        return -1;
    }
} 
```

[您可以在此处](http://codepad.viper-7.com/aEXIj6)查看一个正在运行的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:29:57.840

如果我了解您需要做什么，您可以使用[usort](http://www.php.net/usort)：

```
usort($array, function($a, $b) {
    $sort = array('Red', 'Green', 'Blue');
    if (array_search($a['House_Colour'], $sort) > array_search($b['House_Colour'], $sort)) return 1;
    if (array_search($a['House_Colour'], $sort) < array_search($b['House_Colour'], $sort)) return -1;
    return 0;
}); 
```

如果您可以利用定义而不是依赖字符串作为房屋颜色，则解决方案将更加简单和高效。

您应该在静态类中定义房屋颜色（以模拟枚举类型）

```
Class HouseColour {
    const Red = 0;
    const Green = 1;
    const Blue = 2;
} 
```

在这种情况下，您必须声明对手/玩家

```
 $opponent = array ( 'Opponent'=>'Steve', 'House_Colour'=>HouseColour::Green); 
```

如果您对类和静态常量不满意（您应该对它们感到满意，因为它们的好处真的很棒）您可以诉诸一系列定义

```
define ('HC_Red',0);
define ('HC_Green', 1);
define ('HC_Blue', 2); 
```

对手成为

```
 $opponent = array ( 'Opponent'=>'Steve', 'House_Colour'=>HC_Green); 
```

在这两种情况下，usort 函数是相同的：

```
usort($array, function($a, $b) {
    if ($a['House_Colour'] > $b['House_Colour']) return 1;
    if ($a['House_Colour'] < $b['House_Colour']) return -1;
    return 0;
}); 
```

# c++ - Arduino SoftwareSerial类的C++继承

> ID：13148257
> 
> 赞同：1
> 
> 时间：2012-10-30T22:05:56.647
> 
> 标签：c++, class, inheritance, arduino

我正在尝试创建一个将从类继承的新`SoftwareSerial`类（如下代码段所示）。当我将新类声明为`class SerialGSM : public Stream`时，它会编译。但是在使用时`class SerialGSM : public SoftwareSerial`，它会失败并显示消息

> '{' 标记之前的预期类名

以下是相关的代码段：

```
#ifndef _SerialGSM_H
#define _SerialGSM_H
#include "Arduino.h"
#include <SoftwareSerial.h>
class SerialGSM : public SoftwareSerial {
public:
    SerialGSM(int RXPin,int TXPin);
protected:
    float payRate;
};
#endif /* not defined _SerialGSM_H */ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T18:06:35.420

解决了。

添加

```
 #include <SoftwareSerial.h> 
```

在 pde 上也是如此。

```
#include <SerialGSM.h>
#include <SoftwareSerial.h>
SerialGSM cell(2,3);
void setup(){  
 cell.begin(9600);
} 
```

# android - Android服务和主线程CPU使用率

> ID：13148261
> 
> 赞同：0
> 
> 时间：2012-10-30T22:06:29.750
> 
> 标签：android, multithreading, service, cpu

在Android中，与Service相比，主线程在CPU的使用上更受青睐吗？如果是，我可以在一段时间内将 CPU 的完全控制权交给 android 服务吗？或者更一般地给予不同的优先级？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:44:52.930

如果您的问题与数据库访问问题有关，您应该重新审视您的数据库访问模式，因为这就是您的问题所在。否则，您可能会使用优先级和处理器关联性和服务以及所有这些东西，导致系统无响应并在一小时内耗尽电池，并且仍然会遇到数据库访问问题。

当有一项服务需要对数据库进行持续的 RW 访问，而您尝试从另一个地方打开同一个数据库时，它肯定会失败。因此，不要尝试访问 db 中的 db `onClick()`，而是让您的服务准备必要的数据并将其保存在某个位置以便在单击按钮而不访问 db 时加载。

抱歉，除非您详细说明您使用的数据类型以及您希望如何处理这些数据，否则无法告诉您更多信息。

# javascript - 多个 AJAX 请求 - 麻烦？

> ID：13148262
> 
> 赞同：0
> 
> 时间：2012-10-30T22:06:38.360
> 
> 标签：javascript, ajax, streaming

现在我正在使用 AJAX 来拉入活动流列表（TwitchTV），它是观众，我每秒都在请求这个。有时要检查的流列表可能会变得很长，因此我计划将 ajax 请求分成 2 或 3 个部分：

1) 获取当前流的观看者数量（每 1 秒检查一次）

2) 将流分成两半并检查活动流媒体列表的第一半（每 5 秒检查一次）

3) 检查第二半的活动主播列表（每 5 秒检查一次）

所以我会同时运行 3 个请求，但我担心加载时间会降到多少。由于它不断地提取数据，它会使页面变慢吗？用户可能会注意到吗？对大量数据保留 1 个 ajax 请求更好还是对较小数据使用多个 ajax 请求更好？ajax 真的是获取不断变化的实时数据的最佳选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:43:57.273

您的各种问题的答案可能是“视情况而定”：

1.  ajax 请求本身不应该使任何事情变慢。这些是异步请求，因此它们实际上只会在请求完成时给用户的浏览器带来任何显着（并且可能仍然不明显）的负载。

2.  可能会减慢您的应用程序速度（或导致用户以不愉快的方式注意到）的一件事是请求完成时的 DOM 操作。就地更改您当前的流用户数量可能不会受到伤害，但取决于流的数量/您在列表中显示它们的方式，重绘这可能非常昂贵/导致重绘等事情的滞后。

3.  使用 Ajax 的替代方法（取决于您希望支持的浏览器）是使用 websockets。这样，您可以保持连接打开，并且服务器可以告诉应用程序何时需要更改数据，而不是需要轮询它。

4.  为什么你需要把你的清单分成前半部分和后半部分？

5.  减少来回发送的数据量的一种方法可能是发送某种信号，指示您收到的最后一位数据。例如，当您在 twitter.com 上的时间线每隔几秒更新一次时，ajax 请求会发送它收到的最新推文的 id，以便服务器知道不要浪费时间发送任何比此更早的数据。根据您的用例，这可能是有效的。

# asp.net-mvc - 实体框架 DbSet.Find 抛出异常

> ID：13148263
> 
> 赞同：4
> 
> 时间：2012-10-30T22:06:56.447
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first

我正在关注 ASP.NET MVC 4 中代码优先实体框架（4.1 版）的一个非常基本的示例（使用 O'Reilly 的 Programming ASP.NET MVC 4 中的 EBuy 示例）。我一直在寻找解决方案，到目前为止还一片空白。基本问题是我的控制器中的这段代码：

```
public ActionResult Details(long id)
    {
        using (var db = new EbuyDataContext())
        {
            var rep = db.Auctions;
            var auction = rep.Find(id);
            return View(auction);
        }
    } 
```

引发**ArgumentNullException 值不能为空。参数名称：key。**当它到达 rep.Find(id) 调用时。有趣的是，当它闯入代码时，db.Auctions 属性具有“扩展结果视图将枚举 IEnumerable”，如果单击它，它会显示我预期的两个刚刚从数据库中检索到的实体。然而，rep 对象在检查时确实有“无法评估儿童”。

非常相似的“创建”代码可以正常工作：

```
[HttpPost]
    public ActionResult Create(Auction auction)
    {
        var db = new EbuyDataContext();
        db.Auctions.Add(auction);
        db.SaveChanges();

        return View(auction);
    } 
```

这是我的数据库上下文：

```
namespace Ebuy.DataAccess
{
    public class EbuyDataContext : DbContext
    {
        public DbSet<Auction> Auctions { get; set; } 
    }
} 
```

这是我的模型课：

```
namespace Ebuy.DomainModel
{
    public class Auction
    {
        public long Id { get; set; }
        public string Title { get; set; }
        public string Description { get; set; }
        public decimal StartPrice { get; set; }
        public decimal CurrentPrice { get; set; }
        public DateTime StartTime { get; set; }
        public DateTime EndTime { get; set; }
    }
} 
```

我确实找到了一篇关于 POCO 和 dbcontext 位于不同名称空间或程序集中的参考资料。有谁知道为什么 Create 代码有效而 Find 无效？

**编辑：**堆栈跟踪是：

> System.ArgumentNullException 未由用户代码处理
> Message=Value 不能为空。参数名称：key Source=mscorlib
> ParamName=key StackTrace：位于 System.Collections.Generic.Dictionary `2.FindEntry(TKey key) at System.Collections.Generic.Dictionary`2.ContainsKey(TKey key) at System.Data.Entity.Internal.InternalContext.TryUpdateEntitySetMappingsForType(Type entityType) 在 System.Data.Entity。 System.Data.Entity.Internal.Linq.InternalSet 处的 Internal.InternalContext.IsEntityTypeMapped(Type entityType)`1.Find(Object[] keyValues) at System.Data.Entity.DbSet`1.在 C:\Users\John\Documents\Visual Studio 2010\Projects\Ebuy.Website\Ebuy.Website\Controllers\AuctionsController 中的 Ebuy.Website.Controllers.AuctionsController.Details(Int64 id) 中查找(Object[] keyValues) .cs: lambda_method(Closure , ControllerBase , Object[] ) at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary) 的第 26 行`2 parameters) at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 个参数）在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<> *c_DisplayClass42.b* _41() 在 System.Web.Mvc.Async.AsyncResultWrapper.<> *c_DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End() 在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult) 在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c* _DisplayClass37.<> *c_DisplayClass39.b* _33() 在 System.Web .Mvc.Async.AsyncControllerActionInvoker.<>c_ *DisplayClass4f.b* _49() InnerException:

**编辑 2：**该表确实将 Id 列作为主键。 **更新：**根据 nemesv 的评论，我检查了版本。我正在使用 .NET Framework v 4.0。MVC Web 应用在创建时使用 Nuget 获取 EF 版本 5.0（尽管实际引用的是 EF 运行时 4.0.30319 v4.4.0.0）。我添加了 DataAccess 项目并为其提供了对**不同**EF（运行时 4.0.30319 v4.1.0.0）的引用。我已将 DataAccess 项目的引用更改为与 Web 应用程序相同的 EF，现在我得到一个不同的异常： InvalidOperationException 在创建模型时无法使用上下文。在跨 N 层应用程序使用 EF 时，这似乎是一个问题，因此我将跟进此线程并报告回来。

**修复：**我阅读了一些关于 EF 中的 LazyLoading 设置以及访问实体属性时如何进行加载的内容。由于在尝试查找实体属性并认为可能 LazyLoading 是 EF 5.0 中的默认值之前，我并没有真正访问实体属性，因此我向我的 EbuyDataContext 类添加了一个默认构造函数，如下所示：

```
public class EbuyDataContext : DbContext
{
    public EbuyDataContext()
    {
        //Configuration.LazyLoadingEnabled = false;
    }

    public DbSet<Auction> Auctions { get; set; } 
} 
```

我还将 LazyLoadingEnabled 参数设置为 false，然后运行它，瞧！成功！但是，我想我会仔细检查一下，所以我注释掉了 LazyLoadingEnabled 参数，进行了干净的重建，它仍然有效。我注释掉了默认构造函数，现在它仍然可以工作 - 当我使用 LazyLoadingEnabled 参数运行它时，是否有其他变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:52:42.600

在 EF（至少 4 和 5）中延迟加载是默认配置。此外，尝试使用 KeyAttribute 装饰将您的 Id 显式标记为 Key。

```
public class Auction
{
    [Key]
    public long Id { get; set; }
    public string Title { get; set; }
    public string Description { get; set; }
    public decimal StartPrice { get; set; }
    public decimal CurrentPrice { get; set; }
    public DateTime StartTime { get; set; }
    public DateTime EndTime { get; set; }
} 
```

# javascript - HTML5 Javascript 音频在本地工作但不在服务器上

> ID：13148265
> 
> 赞同：1
> 
> 时间：2012-10-30T22:07:08.653
> 
> 标签：javascript, html, audio

在我的项目中，我使用音频和 Javascript，因此：

我加载了一个带有音频文件的数组：

```
var audio = new Array();
for (i=0; i<6; i++) {
    audio[i] = new Audio('sounds/sound_' + i + audioExt);
    audio[i].load();
} 
```

然后我调用音频（在拖动的开始事件上），如下：

```
audio[i].play(); 
```

它可以在本地的所有浏览器（Firefox、Chrome、Safari、IE9、IE8）中运行，从 Wamp2.2 运行 Apache，但是一旦我将它上传到 GoDaddy 上的服务器，它就不会在任何浏览器上运行（当你将动物拖到背景农场上）：

[http://www.totalliberty.com/cet/farm/](http://www.totalliberty.com/cet/farm/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:36:54.357

您的音频文件路径可能是错误的。现在它们相对于我假设位于下的脚本路径`js/foo.js`，`scripts/foo.js`或类似的东西。因此，要么找出实际路径，要么以`new Audio('../sounds/sound_' + i + audioExt);`.

# sql - sql文件错误信息

> ID：13148270
> 
> 赞同：-2
> 
> 时间：2012-10-30T22:07:41.840
> 
> 标签：sql

> **可能重复：**
> [SQL 错误我想不通](https://stackoverflow.com/questions/13147356/sql-error-i-cant-figure-this-out)

```
#
# Table structure for table `pa_adclicks`
#
CREATE TABLE pa_adclicks(
bannerid mediumint( 9 ) NOT NULL default '0',
zoneid mediumint( 9 ) NOT NULL default '0',
t_stamptimestamp( 14 ) NOT NULL ,
host varchar( 255 ) NOT NULL default '',
source varchar( 50 ) NOT NULL default '',
countrychar( 2 ) NOT NULL default '',
KEY bannerid_date( bannerid, t_stamp ) ,
KEY date( t_stamp ) ,
KEY zoneid( zoneid )
) ENGINE = 'MyISAM'; 
```

MySQL 说：文档

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 14 行的 '(14) NOT NULL, host varchar(255) NOT NULL default '', source varchar(50) NOT' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:11:30.403

以下行似乎有两个错误。

```
t_stamptimestamp( 14 ) NOT NULL , 
```

你也许可以像这样纠正它。

```
t_stamp timestamp NOT NULL , 
```

如果您对 MySQL 不是很熟悉，您可能应该略读一下[数据类型 datetime 和 timestamp](http://dev.mysql.com/doc/refman/5.6/en/datetime.html)的详细信息。

更远的地方也有类似的错误。我相信你能找到它。

# active-directory - 活动目录的领域配置

> ID：13148271
> 
> 赞同：2
> 
> 时间：2012-10-30T22:07:47.187
> 
> 标签：active-directory, glassfish, forms-authentication, realm

我想对希望通过 Active Directory 访问特定资源的用户进行身份验证。我使用 JSF 2.1 和 Glassfish 3.1.2。我试试 [这个](http://blog.gascoyne.de/archives/5)，[这个](http://www.webdavsystem.com/javaserver/doc/authentication/ldap_glassfish)，[这个](https://stackoverflow.com/questions/6418055/getting-active-directory-realm-with-glassfish-3-1)，但它对我不起作用。用户无法登录。始终将我重定向到错误页面。

## **domain.xml 片段：**

```
<auth-realm name="ADREALM" classname="com.sun.enterprise.security.auth.realm.ldap.LDAPRealm">
      <property name="directory" value="LDAP://WIN-AK5HJBX4R4G.my.com/"></property>
      <property name="search-filter" value="(&amp;(objectClass=user)(sAMAccountName=%s))"></property>
      <property name="base-dn" value="DC=my,DC=com"></property>
      <property name="group-search-filter" value="(&amp;(objectClass=group)(member=%d))"></property>
      <property name="jaas-context" value="ldapRealm"></property>
      <property name="assign-groups" value="Domain Users"></property>
      <property name="search-bind-dn" value="WIN-AK5HJBX4R4G.my.com\Administrator"></property>
      <property name="search-bind-password" value="Qwerty123"></property>
</auth-realm> 
```

WIN-AK5HJBX4R4G - 它是我的虚拟服务器的默认名称（可以是 192.168.56.101 或只是 localhost。因为 webapp 部署在此服务器上并不意味着它的命名方式，AD 也在此服务器上）。

我尝试了某些形式的 search-bind-dn，例如：

```
WIN-AK5HJBX4R4G.my.com\Administrator <- it works for asp.net so I think it is good form , maybe I'm wrong?
Administrator@my.com
CN=Administrator,CN=Users,DC=my,DC=com 
```

没有任何工作。用户仍然无法登录。

## **web.xml 片段：**

```
<login-config>
    <auth-method>FORM</auth-method>
    <realm-name>ADREALM</realm-name>
    <form-login-config>
      <form-login-page>/login.xhtml</form-login-page>
      <form-error-page>/loginError.xhtml</form-error-page>
    </form-login-config>
</login-config> 

<security-constraint>
    <display-name>Example Security Constraint</display-name>
    <web-resource-collection>
      <web-resource-name>Protected Pages</web-resource-name>
      <url-pattern>/faces/*</url-pattern>
      <http-method>GET</http-method>
      <http-method>POST</http-method>
    </web-resource-collection>
    <auth-constraint>
      <role-name>user</role-name>
    </auth-constraint>
</security-constraint>

<security-role>
  <description>A Funky User</description>
  <role-name>user</role-name>
</security-role> 
```

## **glassfish-web.xml 片段：**

```
<security-role-mapping>
    <role-name>user</role-name>
    <group-name>Domain Users</group-name>
</security-role-mapping> 
```

我还添加`-Djava.naming.referral=follow`了 JVM 选项。

1.  如果可能的话，我在哪里可以检查任何异常或错误等“连接到服务器失败”或“密码或登录错误”？有日志文件吗？或者是其他东西？
2.  我错过了配置文件中的某些内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T17:34:03.143

解决。

将属性添加`java.naming.referral=follow`到 domain.xml。

# ios - FlashBuilder 4.6 或 4.7：如何提高 IPA (ios) 包的生成速度

> ID：13148274
> 
> 赞同：7
> 
> 时间：2012-10-30T22:08:02.303
> 
> 标签：ios, apache-flex, mobile, flash-builder, ipa

使用 FlashBuilder 4.6 或 4.7，我从 Flex Mobile Project 生成一个 IPA 文件。

我的问题是生成 IOS 包需要 15 到 30 分钟才能生成 20 个 Mo 包，而 AIR 和 Android 包最多需要 1 分钟。

我知道 IOS 包是不同的，因为 LLVM 用于生成 IPA 并嵌入包使用的 AIR 方法，但是有没有办法提高这个速度？

我尝试增加 Eclipse 内存，但没有帮助。进一步分析我注意到它是单线程的工具。

我尝试过使用 AIR 3.1、AIR 3.3 和 AIR 3.4，生成时间仍然相同。

除此之外，请注意我对 Flex Mobile 非常满意，因为我目前有一个在 Flex 中开发的应用程序，它可以在 Windows、Mac OSX、Android 平板电脑和 iPad 上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T14:51:19.673

在另一个 SO 帖子中有一个很好的答案，关于当你为 IOS 构建时实际发生的事情以及为什么与 android 相比它需要这么长时间。 [https://stackoverflow.com/a/6906392/731880](https://stackoverflow.com/a/6906392/731880)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:13:32.137

目前，没有办法加快速度。如果您只是在调试，则应使用注释中提到的快速构建设置。我还喜欢绕过 iTunes，使用较新的 AIR 版本在设备上安装/卸载应用程序`adt -installApp -platform ios`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-15T12:42:19.633

我注意到两件事，如何加快速度：

1.  关闭超线程，有时有助于节省 3%-5% 的时间。

2.  超频 CPU。它有很大帮助！我有 2600K，我已将时钟速度从 3.4 Ghz 提高到 4.8 Ghz，并且速度提高了 30%-40%。

还有一件事，关闭所有可能占用 CPU 时间的后台进程。

# python - 用不同大小的行读取python文件

> ID：13148277
> 
> 赞同：0
> 
> 时间：2012-10-30T22:08:11.107
> 
> 标签：python, file

我尝试读取文件，例如

```
1 1 2 3 4 5 6 6 7\n 
2 3 4 5 2 3 4 7 8 2 3\n 
3 1 2 4 2 1 4 5 6 2 
```

类似的东西，我想重写文件，例如

```
1 1
1 2
1 3
1 4
...
3 2 
```

但是，我不知道如何存储不同大小的行。基本代码如下，但必须更改 dst[] 部分。

```
while 1:
        line = file1.readline()
    if not line:
        break
    src, tmp, dst[] = line.split(' ') 
    # rewrite part will be here 
```

请帮帮我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:13:25.240

这应该这样做：

```
In [1]: with open("data1.txt") as f:
   ...:     for line in f:
   ...:         spl=line.split()
   ...:         first,rest=spl[0],spl[1:]
   ...:         for x in rest:
   ...:             print first,x  # instead of printing write 
                                   # it to a file using 
                                   # write("{0} {1}\n".format(first,x)
   ...:             
   ...:             
1 1
1 2
1 3
1 4
1 5
...
...
3 6
3 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:14:11.930

你要写的那行是这样的：

```
src, tmp, dst[] = line.split(' ') 
```

没有直接的方法可以做到这一点。您正在寻找所谓的模式匹配分配，这是一些语言（如 Haskell）提供的，但不是 Python。

获得相同效果的最简单方法是显式：

```
bits = line.split(' ')
src, tmp, dst = bits[0], bits[1], bits[2:] 
```

如果你真的想要，你可以通过将参数传递给函数来间接使用模式匹配：

```
def doStuff(src, tmp, *dst):
  # do stuff

doStuff(*line.split(' ')) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T22:15:41.893

使用`itertools.product`（只是因为我在写作时不确定是否应该有一个或两个参数）：

```
from itertools import product

with open('testing2.txt') as fin:
    for line in fin:
        items = line.split()
        first, rest = items[0], items[1:]
        for i, j in product(first, rest):
            print i, j 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T22:35:50.617

```
 while (1):
    line = file1.readline()
    if not line:
        break
    tokens = line.split();
    for (count, token) in enumerate(tokens,start=1):
        print str(tokens[0]) + " " + str(token) 
```

# ios - Soundcloud 下载超时

> ID：13148279
> 
> 赞同：2
> 
> 时间：2012-10-30T22:08:37.450
> 
> 标签：ios, http, download, titanium, soundcloud

soundcloud的人在看这个吗？为什么我收到一个有效请求的 403？

我目前正在使用 Titanium 构建一个 iOS 应用程序。

我包含一个新功能，允许用户下载 Soundcloud .mp3 文件并从应用程序播放它们（保存到应用程序目录）

我编写的代码在某些轨道上运行良好，但不适用于其他轨道。客户端可以无限下载所有曲目，并且我已经大大增加了最大超时时间，但它仍然只下载了大约 170 字节，然后在某些曲目上失败了。在其他人身上，它可以毫无问题地下载整个曲目。真的被这个难住了，有人有什么想法吗？

下面是代码，也是一个轨道工作的例子，如果有人能看出区别，一个不工作？

谢谢

贾斯汀

```
//Download code

var newDir = Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory,'scDownloads');

    newDir.createDirectory();

    var id = fStripped;

    var dlXhr = Titanium.Network.createHTTPClient({
        timeout : 500000});

    dlXhr.onload = function(){
        var file = Ti.Filesystem.getFile(newDir.resolve(),id +'.mp3');

        Ti.API.warn('file is: ' + file);

        file.createFile();

        file.write(this.responseData);

    }

    dlXhr.open('GET',dlURL + '?client_id=' + soundcloudClientID);

    dlXhr.send(); 
```

这里有几首曲目（带有客户 ID）

这个有效：[https ://api.soundcloud.com/tracks/60943956/download?client_id=7a0984726d0eefbb310771c4c02116a8](https://api.soundcloud.com/tracks/60943956/download?client_id=7a0984726d0eefbb310771c4c02116a8)

这个没有：[https ://api.soundcloud.com/tracks/63980557/download?client_id=7a0984726d0eefbb310771c4c02116a8](https://api.soundcloud.com/tracks/63980557/download?client_id=7a0984726d0eefbb310771c4c02116a8)

我已经在 Soundcloud 的 API 控制台 (http://developers.soundcloud.com/console) 上对此进行了测试，得到了以下结果：

HTTP/1.1 302 临时移动 Access-Control-Expose-Headers: Date X-Runtime: 20 Age: 0 Content-Length: 28 X-Cacheable: NO:Cache-Control=no-cache Location: gda=1351783496_b465064be1b41027a7a0bf6067d83169">http: //ak-media.soundcloud.com/kw7JNYi7HtCq?AWSAccessKeyId=AKIAJ4IAZE5EOI7PA7VQ&Expires=1351783496&Signature=UNtBsSfBh1XNvXPLSLNVzTQEclY%3D& **gda** =1351783496_b465064be1b41027a7a0bf6067d83169 Access-Control-Allow-Methods: GET, PUT, POST, DELETE Con​​nection: close Server: nginx X-Cache: MISS Cache-Control: no-cache X-Varnish: 1398398080 Access-Control-Allow-Headers: Accept, Authorization, Content-Type, Origin Date: Thu, 01 Nov 2012 15:24:36 GMT Access-Control-Allow-Origin: * 通过：1.1 varnish 内容类型：application/xml；charset=utf-8

302 - 找到

我还添加了一个 Ti.API.debug(e.error); 到我创建的 dlXhr.onerror 函数，这只是返回

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T15:01:30.267

我得到一个“不”的403。您应该监听 onerror 事件，并适当地处理它。此外，您应该流式传输文件，而不是将其保存在内存中，而不是一次全部写出。利用 iOS 上 Ti.Network.HTTPClient 上可用的“文件”属性来简单地做到这一点。另外，显示进度，因为您正在下载一个巨大的文件。下面的示例演示了所有这些：

```
var win = Ti.UI.createWindow({
    backgroundColor: 'white'
});
var progressBar = Ti.UI.createProgressBar({
    max: 1, min: 0, value: 0,
    left: 20, right: 20,
    height: 20,
    visible: true
});
win.add(progressBar);
win.open();

var fileName = 'file.mp3';
var link = 'https://api.soundcloud.com/tracks/63980557/download?client_id=7a0984726d0eefbb310771c4c02116a8';
var file = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, fileName);

var client = Ti.Network.createHTTPClient({
    ondatastream: function (e) {
        progressBar.value = e.progress;
    },
    onload: function () {
        alert('Download Complete: ' + file.size);
    },
    onerror: function (e) {
        alert(client.status);
    }
});
client.open('GET', link);
client.file = file;
client.send(); 
```

# wso2 - WSO2 ESB 4.5.1 错误创建仅使用 https 传输的代理服务

> ID：13148282
> 
> 赞同：0
> 
> 时间：2012-10-30T22:08:51.487
> 
> 标签：wso2, wso2esb

当我尝试创建仅使用 https 传输的代理服务时，出现以下错误：警告：EPR 为 NULL。传输配置可能不正确

如果我重新添加 http 传输，错误就会消失。

我做错了什么还是与[https://wso2.org/jira/browse/ESBJAVA-1624](https://wso2.org/jira/browse/ESBJAVA-1624)有关？

# html - 将 HTML 表头与表数据行对齐

> ID：13148289
> 
> 赞同：3
> 
> 时间：2012-10-30T22:09:42.603
> 
> 标签：html, css, html-table

我有一些 HTML 代码可以生成带有标题和数据行的 HTML 表。标题列与数据列不对齐。

我从网上找到的一个例子中得到了这段代码。我希望标题单元格宽度与表格的数据单元格宽度相匹配。

下面是 jsfiddle 的代码：http: [//jsfiddle.net/tee3n/](http://jsfiddle.net/tee3n/)。

HTML

```
<div class="scrollableContainer">
  <div class="scrollingArea">
   <table class="cruises scrollable">
     <thead>
        <tr>
         <th><div class="name">Name</div></th>
         <th><div class="operator">Operator</div></th>
         <th><div class="began">Began operation</div></th>
         <th><div class="tonnage">Tonnage</div></th>
         <th><div class="status">Status</div></th>
     </tr>
    </thead>
    <tbody>
        <tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr>
        <tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr>
        <tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr>
        <tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr>
        <tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr><tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr>
        <tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr></tr><tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr>
        <tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr>
        </tr><tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr>
        <tr>
          <td><div class="name">Name of ship</div></td>
          <td><div class="operator">Who operates</div></td>
          <td><div class="began">Began service when</div></td>
          <td><div class="tonnage">How big</div></td>
          <td><div class="status">Current status</div></td>                        
        </tr>
      </tbody>
   </table>
 </div>
</div> 
```

CSS：

```
table.cruises { 
    font-family: verdana, arial, helvetica, sans-serif;
    font-size: 11px;
    cellspacing: 0; 
    border-collapse: collapse; 
    width: 99.9%;    
    }
  table.cruises th, table.cruises td { 
    border-right: 1px solid #999; 
    border-bottom: 1px solid #999; 
    width: 20%;
    }
  table.cruises th { background: #aab; }
  table.cruises td { background: #eee; }

  div.scrollableContainer { 
    position: relative; 
    width: 80%; 
    padding-top: 1.7em; 
    margin: 40px;    
    border: 1px solid #999;
    background: black;
    }
  div.scrollingArea { 
    width: 100%;
    height: 240px; 
    overflow: auto; 
    }
  table.scrollable thead tr {
    left: 0; top: 0;
    position: absolute;
    width: auto;
    }

  table.cruises .name     { width: 20%; }
  table.cruises .operator { width: 20%; }
  table.cruises .began    { width: 20%; text-align:center; }
  table.cruises .tonnage  { width: 20%; text-align:center; }
  table.cruises .status   { width: 20%; } 
```

为什么标题与下面的数据列不对齐？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:28:40.193

检查你的 CSS：

```
 table.scrollable thead th tr {
    left: 0; top: 0;
    position: absolute;
    width: auto;
    } 
```

我添加了`th`.

此外，`padding-top: 1.7em;`从

```
 div.scrollableContainer { 
    position: relative; 
    width: 80%; 
    padding-top: 1.7em; 
    margin: 40px;    
    border: 1px solid #999;
    background: black;
    } 
```

删除顶部的黑色空间。它应该可以工作（在 Chrome 中测试）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-10T19:15:49.353

我最终使用了数据表插件（datatables.net）。

# python - python - argparse一个参数而不是其他几个

> ID：13148290
> 
> 赞同：4
> 
> 时间：2012-10-30T22:09:43.110
> 
> 标签：python, argparse

例如我有选择：

```
parser.add_argument('-b', action="store_true")
parser.add_argument('-c', action="store_true")
parser.add_argument('-d', action="store_true") 
```

我想使用同义词选项“-a”启用所有这些。是否可以？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T22:20:06.157

我认为这样做最简单`parse_args()`：

```
import argparse
parser = argparse.ArgumentParser()
parser.add_argument('-b', action="store_true")
parser.add_argument('-c', action="store_true")
parser.add_argument('-d', action="store_true")
parser.add_argument('-a', action="store_true")
args = parser.parse_args()
if args.a: args.b = args.c = args.d = True 
```

或者，您可以使用自定义操作来执行此操作，但我认为这太过分了：

```
import argparse
class AllAction(argparse.Action):
    def __call__(self, parser, args, values, option_string = None):
        # print '{n} {v} {o}'.format(n = args, v = values, o = option_string)
        for param in ['a', 'b', 'c', 'd']:
            setattr(args, param, True)

parser = argparse.ArgumentParser()
parser.add_argument('-b', action="store_true")
parser.add_argument('-c', action="store_true")
parser.add_argument('-d', action="store_true")
parser.add_argument('-a', action = AllAction, nargs = '?')
args = parser.parse_args()
print(args) 
```

# testing - 如何使用 Surefire + Maven 获得超过 2 个线程来执行？

> ID：13148294
> 
> 赞同：4
> 
> 时间：2012-10-30T22:09:57.990
> 
> 标签：testing, parallel-processing, maven-3, maven-surefire-plugin

使用 Maven + Surefire 组合，我不能同时执行两个以上的线程。我已经尝试了许多 threadCount、perCoreThreadCount 和 useUnlimitedThreads 设置的组合，但永远不会比两个线程做得更好。见附上的截图：将有大约 12 个 Firefox 窗口，但一次只有两个“驱动”。

![在此处输入图像描述](../Images/099574780beaebc6264fb9fb29291e90.png)

我的机器有 4 个 2.6 Ghz i7 内核，所以我还没有达到硬件限制。

以下是其中一种 Surefire 配置的示例：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.7.2</version>
            <configuration>
                <includes>
                    <include>**/*Test*.*</include>
                </includes>
                <threadCount>10</threadCount>
                <perCoreThreadCount>true</perCoreThreadCount>
                <parallel>classes</parallel>
            </configuration>
        </plugin> 
```

对于我的测试，我使用的是包装在 JUnit 运行器中的 Scala。每个测试都在自己的类中。我认为我的 JUnit 是 4.10，Maven 3.04。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-17T19:54:26.920

尝试将 MAVEN_OPTS=-Dmaven.artifact.threads=10 定义到 Maven 环境变量中。

或者在执行 mvn 时使用参数“-T”。

例子：

mvn -T 4 clean install # 使用 4 个线程构建

mvn -T 1C clean install # 每个 cpu 核心 1 个线程

mvn -T 1.5C clean install #1.5 thread per cpu core

请注意，您可以指定线程数甚至内核数，因为您使用的是 Maven 3.x。

有关更多详细信息，请查看此链接：[https ://cwiki.apache.org/confluence/display/MAVEN/Parallel+builds+in+Maven+3](https://cwiki.apache.org/confluence/display/MAVEN/Parallel+builds+in+Maven+3)

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-18T06:43:01.793

FWIW我有一个类似的问题。原来我试图从不同的 JUnit 类别运行测试类，但设置为与*classes*并行。

每个类别中的类确实是并行执行的，但类别是串行执行的。

我最终将故障安全配置更新为

```
<configuration>
    <parallel>suitesAndClasses</parallel>                        
    <useUnlimitedThreads>true</useUnlimitedThreads>
   <threadCountClasses>4</threadCountClasses>
</configuration> 
```

# iphone - ios解析问题nstimer教程

> ID：13148299
> 
> 赞同：2
> 
> 时间：2012-10-30T22:10:34.323
> 
> 标签：iphone, objective-c, ios

我已按照教程进行操作：

[www.edumobile.org/iphone/iphone-programming-tutorials/a-simple-stopwatch-for-iphone](http://www.edumobile.org/iphone/iphone-programming-tutorials/a-simple-stopwatch-for-iphone/)

我得到 1 个错误和 1 个警告，都在同一行 71

```
for (int i = [timeArray count] – 1; i >= 0; i–) { 
```

**错误 – 预期的解析问题 ) 警告 – 未使用的实体问题 未使用的表达式结果**

有什么想法有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:12:48.187

改变这个，

```
for (int i = [timeArray count] – 1; i >= 0; i–) { 
```

到，

```
for (int i = [timeArray count] – 1; i >= 0; i--) { 
```

编译器说它无法解析字符“-”。如果它无法识别 for 循环语法并对其进行解析，则会抛出此错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:56:24.733

正如 ACB 所提到的，表达式需要是 i-- 而不是 i-。

只是几个注意事项 - Douglas Crawford 实际上建议避免使用 -- 和 ++ 来支持 i -= 1。虽然有点冗长，但毫无疑问它实际上做了什么而不是类似的东西

```
int example = --i + b; 
```

可能会使一些人对表达式结束后的 i 值感到困惑。

此外，作为次要优化，您应该将数组的大小放在本地值中，而不是在每次循环迭代时调用 [timeArray count]

```
int timeArraySize = [timeArray count] - 1;
for (int i = timeArraySize; i >= 0; i -= 1) { 
```

希望有帮助！

# php - 创建触发器时的语法错误

> ID：13148300
> 
> 赞同：0
> 
> 时间：2012-10-30T22:10:33.837
> 
> 标签：php, postgresql, triggers, postgresql-9.1, upsert

我知道这个问题已经以各种形式在这里提出，但我已经经历了所有这些并且无法解决我的问题。我不明白为什么我在这个脚本上不断收到这种语言错误。我已经按照我在这里看到的两个不同的例子来接近它，但它似乎一遍又一遍地给我同样的错误。我真的很难让这个触发器功能工作，请在这里感谢 PostgreSQL 专家的任何积极帮助。

```
 <?php
      include ("connection.php");
    $query = 'select * from fieldtally order by pipeno asc'; 
$result = pg_query($db_handle,$query); 
while ($row = pg_fetch_row($result))
{
    // Creates Arrays to use in dropdowns
    $pipeno_array[] = $row[0];
   } 
 // This function creates dropdowns that can be used in your forms
function dropdown($field_name, $num){
    // Creates the Dropdown
    echo "<select name=\"".$field_name."\" id=\"".$field_name.$num."\"\n";
    echo "<option value=\"\"> --- Select --- </option>\n";
    // Chooses which array to use for Dropdown options
   global $pipeno_array;
     $name_array = ($field_name == 'pipeno') ? $pipeno_array : $wthick;
    // Creates the Dropdown options based off the array above
    foreach($name_array as $k){
        echo "<option value=\"$k\">$k</option> \n"; }
    // Ends the Dropdown
    echo "</select>\n";
}
?>

<html>
<head><title>UG Pipeline Fiedl Data Capture</title></head>
<body>
<form action="fieldtally.php" method="post">
<table width="800" cellpadding= "10" cellspacing="1" border="1">
<tr align="center" align="top">
<td align="center" colspan="1" rowspan="1" bgcolor="#64b1ff">
<h3>Input Field Tally Information</h3>
Select Wall Thickness:<select name="wthick" id="wthick">
   <option value=""> --Select-- </option> 
  <option value="9.80">  9.80  </option>
  <option value="13.50"> 13.50 </option>
  <option value="15.90"> 15.90 </option>
  </Select> 
Select Pipe No:<?php dropdown('pipeno', 1); ?>   Select Pipe Manufacturer:<select name="manufacturer" id="manufacturer">
 <!-- #7.1 -->
  <option value=""> --Select-- </option> 
  <option value="KWH Pipe">KWH Pipe </option>
  <option value="Atlas Tube">Atlas Tube</option>
  <option value="Imperial Steel">Imperial Steel</option>
  <option value="Lakeside">Lakeside</option>
  <option value="Spiralco">Spiralco</option>
  <option value="Muri metals">Muri metals</option>
  <option value="WestLake">WestLake</option>
  <option value="Westman Steel">Westman Steel</option>
     <option value="Lockerbie & Hole">Lockerbie & Hole</option>
      <option value="Nardei">Nardei</option>
  </Select><br /><br />  
Joint No: <input type="text" name="djointno"> Input measured Length: <input type="text" name="measuredlength"><br><br>
Input Serial No: <input type="text" name="serialno"><br><br> 
<input type="Submit" name="submit" value="Submit">
</td></tr></table></form><p></p>
</form>
</body>
</html> 
```

> 字段tally.php脚本如下图

```
<?php
 $PGHOST = "localhost:25376";
 $PGDATABASE = "Pipeline";
 $PGUSER = "postgres";
 $PGPASSWORD = "Casa2009";
 $PGPORT = 5432;
 $db_handle = pg_connect("dbname=$PGDATABASE user=$PGUSER
 password=$PGPASSWORD");
 if ($db_handle) {
 echo 'Connection attempt succeeded.';
 } else {
 echo 'Connection attempt failed.';
 }
 $pipeno = pg_escape_string( $_POST['pipeno']);  
 $wthick = pg_escape_string($_POST['wthick']);
 $djointno = pg_escape_string($_POST['djointno']);
 $manufacturer = pg_escape_string($_POST['manufacturer']);
 $measuredlength = pg_escape_string($_POST['measuredlength']);
 $serialno = pg_escape_string($_POST['serialno']); 
  $query = "CREATE FUNCTION upsert (sql_update TEXT, sql_insert TEXT)
                 RETURNS VOID
                 LANGUAGE plpgsql
            AS $$
            BEGIN
               LOOP
                  EXECUTE sql_update;
                  IF FOUND THEN
                     RETURN;
                  END IF;
                  BEGIN
                     EXECUTE sql_insert;
                     RETURN;
                     EXCEPTION WHEN unique_violation THEN
                  END;
              END LOOP;
            END;
            $$";

   $result = pg_query($query);
 if (!$result) {
 $errormessage = pg_last_error();
 $message = "Error with query: " . $errormessage;
 }
 $message = sprintf ("These values were inserted into the pipeline database - %s %s %s %s %s %s",$wthick,$pipeno,$manufacturer,$djointno,$measuredlength,$serialno);
 pg_close();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T12:37:30.293

这两种说法都相当乱码。您需要阅读[PL/PgSQL 触发器文档](http://www.postgresql.org/docs/current/static/plpgsql-trigger.html)，包括那里给出的示例，以了解语法。

本质上，您首先：

```
CREATE OR REPLACE FUNCTION func_name() RETURNS trigger AS $$
BEGIN
   -- Trigger body here
END;
$$ LANGUAGE plpgsql; 
```

然后在表上使用该触发器功能：

```
CREATE TRIGGER trigger_name
BEFORE INSERT OR UPDATE OR DELETE ON tablename
FOR EACH STATEMENT EXECUTE PROCEDURE func_name(); 
```

此外，代码中的触发器主体将永远无法工作。PostgreSQL 不支持`ON DUPLICATE KEY UPDATE`. 那是 MySQL 主义。您正在寻找`MERGE`或`UPSERT`喜欢行为，不幸的是，这在 PostgreSQL 中很难做好。看到[这个问题](https://stackoverflow.com/q/1109061/398670)。

# android - android中的按钮样式

> ID：13148301
> 
> 赞同：1
> 
> 时间：2012-10-30T22:11:04.213
> 
> 标签：android, css, xml, styling

我是 Android 开发的新手，我想学习如何设置按钮元素的样式。我熟悉 HTML 中的样式（CSS 和 HTML 样式）。例如，我如何将这种 css 样式转换并实现到 Android 中（我假设 XML 样式）：

```
.buttonClass{
     background-color: #fff;
     color: #000;
     border-radius: 10px;
     opacity: 0.5
 ...
} 
```

我在 Eclipse 上为我创建的图形布局有这个按钮元素代码：

```
<Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Camera" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:31:41.420

您可以这样做：对于背景颜色：

```
android:background="#ARGB" //alpha, red, green, blue or a drawable 
```

如果你想要一个圆形按钮：

```
android:background="@drawable/myBtnWithColor" 
```

“myBtnWithColor” XML 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
     android:shape="rectangle">

     <gradient android:startColor="#yourColor" android:endColor="#yourColor"
     <corners android:bottomRightRadius="7dp" android:bottomLeftRadius="7dp"
     android:topLeftRadius="7dp" android:topRightRadius="7dp"/>
</shape> 
```

您可以在 Backgroundcolor 中设置按钮的不透明度。如前所述，您可以在颜色中设置 alpha 值。

# javascript - Javascript/AJAX ReferenceError: x 未定义

> ID：13148302
> 
> 赞同：3
> 
> 时间：2012-10-30T22:11:10.110
> 
> 标签：javascript, ajax

我有一个 jQuery 函数，它从 PHP 生成的复选框中获取值并通过 AJAX 发送它。顺便说一句，该值始终是一个单词，只有字母。下面是脚本。

```
<script type="text/javascript">
    $(document).ready(function() {
        $("input:checkbox").on("click", function () {
            step = this.value;
            //document.getElementById("test").innerHTML = step;
            responseArray = [];

            xmlhttp=new XMLHttpRequest();
            xmlhttp.onreadystatechange=function() {
                if (xmlhttp.readyState==4 && xmlhttp.status==200) {
                    responseArray = eval("(" + xmlhttp.responseText + ")");
                    document.getElementById("test").innerHTML = responseArray;
                }
            }

            xmlhttp.open("GET", "checkbox.php?step="+step, true);
            xmlhttp.send();
        });
    });
</script> 
```

上面的代码导致“ReferenceError: [this.value] is not defined”。[this.value] 是实际值，但会根据选中的框而变化。如果您注意到上面代码中的第 5 行，当我不注释该行时，它会在“test”中为 step 变量显示正确的值，所以它是在那之后的东西。下面是 checkbox.php 文件完全简化为基本上没有，它仍然会导致错误。

```
<?php       
    $step = $_GET["step"];
    echo "[" . $step . "]";
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T14:25:50.160

我可以看到您使用 Jquery，您应该使用 JQuery 的 AJAX 对象。它大大简化了请求：

```
$.ajax({
  url: 'checkbox.php?step=',
  success: function(data) {
    alert(data);
  }
}); 
```

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

现在您的问题似乎是您没有正确通过复选框的值。复选框处于打开或关闭状态。以下是获取各种参数的方法：

```
$(document).ready(function () {
    $("input:checkbox").on("click", function () {
        var checkboxID = $(this).attr("ID");        // Returns the ID of the checkbox
        var isChecked = $(this).is(':checked');     // Returns true or false

        alert($(this).attr("ID") + " is " + isChecked);
    });
}); 
```

所以你的最终代码可能看起来像：

```
$(document).ready(function () {
    $("input:checkbox").on("click", function () {
        var checkboxID = $(this).attr("ID");        // Returns the ID of the checkbox
        var isChecked = $(this).is(':checked');     // Returns true or false

        $.ajax({
           url: 'checkbox.php?step=' + isChecked ,
           success: function(data) {
             alert(data);
           }
         });
    });
}); 
```

（未经测试的代码），它将向 url 发送请求`checkbox.php?step=true`

来自 2+2 的你好 :D

# java - 仅检测何时单击鼠标右键

> ID：13148315
> 
> 赞同：1
> 
> 时间：2012-10-30T22:12:00.607
> 
> 标签：java, jtable

我的表有 4 列，我只希望允许单击第 1 列。此外，此代码还允许使用鼠标左键，我只想要右键。

```
 private void jTable1MouseClicked(java.awt.event.MouseEvent evt) {
    // TODO add your handling code here:
    int iCol = jTable1.getSelectedColumn();

    if(iCol == 1 && evt.getModifiers() == InputEvent.BUTTON3_MASK)
    {
        if(evt.getClickCount() == 2)
        {
            int iRow = jTable1.getSelectedRow();

            File iFile = new File(jTable1.getValueAt(iRow, iCol).toString());

            String iPath = iFile.getAbsolutePath();
            File iDir = new File(iPath.substring(0, iPath.lastIndexOf(File.separator)));

            if(Desktop.isDesktopSupported()) {
                try {
                    Desktop.getDesktop().open(iDir);
                } catch (IOException ex) {
                    Logger.getLogger(NewJFrame.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        }
    }
} 
```

如果这个问题变成了 2，我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:26:44.550

让我们从左键开始，通常用 表示`MouseEvent.BUTTON1`，然后移动到`MouseEvent#getModifiers`通常用于提供有关当前按下的键的信息，我们开始看到主要问题。

你真正想要的方法是`MouseEvent#getButton`

尝试运行以下示例以获得一些想法；）

```
public class TestMouseClicked {

    public static void main(String[] args) {
        new TestMouseClicked();
    }

    public TestMouseClicked() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new MousePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class MousePane extends JPanel {

        private JToggleButton leftButton;
        private JToggleButton middleButton;
        private JToggleButton rightButton;

        public MousePane() {
            setLayout(new GridBagLayout());

            leftButton = new JToggleButton("Left");
            middleButton = new JToggleButton("Middle");
            rightButton = new JToggleButton("Right");

            add(leftButton);
            add(middleButton);
            add(rightButton);

            ButtonGroup bg = new ButtonGroup();
            bg.add(leftButton);
            bg.add(middleButton);
            bg.add(rightButton);

            addMouseListener(new MouseAdapter() {
                @Override
                public void mouseClicked(MouseEvent e) {
                    System.out.println(e.getButton());
                    if (e.getButton() == MouseEvent.BUTTON1) {
                        leftButton.setSelected(true);
                    } else if (e.getButton() == MouseEvent.BUTTON2) {
                        middleButton.setSelected(true);
                    } else if (e.getButton() == MouseEvent.BUTTON3) {
                        rightButton.setSelected(true);
                    }
                }
            });

        }

    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:29:26.297

关于仅单击特定列：

1\. 使用您自己的模型创建表格。

```
final JTable table = new JTable( new MyTableModel(data, columnNames)); 
```

2.创建覆盖你需要的函数的新模型（即isCellEditable）

```
public class MyTableModel extends DefaultTableModel {

    private static final long serialVersionUID = -8422360723278074044L;

    MyTableModel(Object[][] data, Object[] columnNames )    
    {
      super(data,columnNames);
    }

    public boolean isCellEditable(int row,int cols)
     {
       if(cols==1 ){return true;}
          return false;                                                                                    
     } 
} 
```

# asp.net - ListView 的项目有 DropDownList：选择更改时如何获取 DataItem？

> ID：13148320
> 
> 赞同：1
> 
> 时间：2012-10-30T22:12:22.810
> 
> 标签：asp.net, listview, data-binding, dataitem

所以我有这样的事情：

![我的 ListView 设置](../Images/d8cea5a1acd33c8846ff1472be1dd70c.png)

在“产品”组合框下有一个 ListView，它显示当用户单击“添加”按钮添加所选产品时添加的新项目。

当用户为产品选择产品描述符时，我需要更改关联数据绑定对象的属性。如何访问该对象？我有一个给定产品描述符组合框的 SelectedIndexChanged 事件的处理程序，但是如何获取包含已更改其选择的组合框的行的 DataItem？

我考虑过 ListView 的 ItemCommand 事件，但我看不出在这种情况下我将如何使用它。

我还看到了这篇文章，其中一个答案提到在隐藏字段中存储 id： [DropDownList inside Repeater: How to handle SelectedIndexChange and get DataItem?](https://stackoverflow.com/questions/9509834/dropdownlist-inside-repeater-how-to-handle-selectedindexchange-and-get-dataitem)

但在那种情况下，我将如何从那些隐藏字段中获取 ID？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:20:24.927

你只需要强制[`NamingContainer`](http://msdn.microsoft.com/en-us/library/system.web.ui.control.namingcontainer.aspx)转换`DropDownList`：

```
var ddl      = (DropDownList) sender;
var item     = (ListViewItem) ddl.NamingContainer;
var rowView  = (DataRowView)  item.DataItem; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T19:03:27.980

蒂姆施梅尔特的回答让我得到了这个答案：

```
 Dim comboBox = CType(sender, RadComboBox)
            Dim item = CType(comboBox.NamingContainer, ListViewItem)
            Dim myListItem = myCollection(item.DataItemIndex) 
```

# javascript - 使用两个属性合并点击处理程序

> ID：13148322
> 
> 赞同：0
> 
> 时间：2012-10-30T22:12:34.257
> 
> 标签：javascript, jquery

我有一个接受一个参数的函数：

```
function magic(el){
 ...
} 
```

我在混合元素/类调用函数上有一堆点击处理程序：

```
$('#div1').click(function(){ magic('#other-div'); });
$('.crazy-div').click(function(){ magic('.mystery-div'); });
$('#doomed-divv').click(function(){ magic('#shady-div'); });
$('#secret-div').click(function(){ magic('form'); });
$('#div2').click(function(){ magic('p'); });
... 
```

有没有很好的方法来巩固这些？也许使用关联数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:24:31.103

只需创建一个包含键值分配的对象（单击特定 ID 时将作为参数传递的 ID），然后用于`$.each`遍历键并为每个键分配一个单击函数就足够了。

```
var a = {
   '#div1' : '#other-div',
   '#doomed-divv' : '#shady-div'
};
$.each(a,function(key,value){
    $(key).click(function(){
        magic(value);
    });
});​ 
```

[JSfiddle](http://jsfiddle.net/NKJR3/11/)。

# php - 在从数据库中获取类别期间按类别过滤器计算行数

> ID：13148325
> 
> 赞同：0
> 
> 时间：2012-10-30T22:12:46.957
> 
> 标签：php, mysql, pdo, count

我的数据库中有两个表

```
table: products                   table: companies
+-----------+------------+        +------+------------+
| name      | company_id |        | id   | name       |
+-----------+------------+        +------+------------+
|Product 1  | 1          |        | 1    | Company 1  |
|Product 2  | 1          |        | 2    | Company 2  |   
|Product 3  | 3          |        | 3    | Company 3  |
|Product 4  | 1          |        | 4    | Company 4  |
|Product 5  | 1          |        | ...               |
|Product 6  | 3          |        +------+------------+
|Product 7  | 2          |
|...                     |
+-----------+------------+ 
```

现在我必须使用 HTML元素制作**公司选择器**（按公司过滤产品） ，其中包含表中所有公司的名称以及列表中公司名称之后的产品。`SELECT``companies``COUNT`

所以，我的目标是获得`SELECT`这样的选项：

*   公司 1 (4)
*   公司 2 (1)
*   公司 3 (2)
*   公司 4 (0)

*（注意：括号内的计数来自上面的示例）*

## 到目前为止我尝试了什么？

我之前使用的是`mysql_*`函数，后来它是`mysqli`程序模型。我可以手动执行此操作，一个查询公司，另一个查询`while`块内`COUNT`的元素（按循环中当前公司的 id 过滤）。现在我正在尝试使用`PDO object`这对我来说是新事物，但我对它不是很熟悉。

## 问题

是否有可能`COUNT`通过一个查询（使用`JOINs`或其他东西）获得？如果没有，我如何使用我的`$dbPDO`对象在循环内进行查询（旧方式）？还是有什么其他方式？

我在这里查看了一些示例，但没有什么可以适应我的要求。也许我错过了一些东西，但使用 PDO 对我来说仍然很痛苦（我必须尽快学习）。

看着我自己的问题，我认为这并不难，但最糟糕的是，我自己**找不到解决方案**。

最后，我有解决方案`mysqli`，只是我不太喜欢它，并认为有更简单的方法可以完成这项任务！

我认为这个[**问题**](https://stackoverflow.com/questions/1803905/counting-all-the-posts-belonging-to-a-category-and-its-subcategories)是我需要的，但仍然不明白答案中的查询。

到目前为止，我有这段代码，但不知道如何让它计算产品：

```
 $dbPDO = new PDO('mysql:dbname=comixdb;host=localhost', 'root', '');
  $sel_cat = ''; # selector HTML
  $sql = "SELECT * FROM categories ORDER BY name";
  foreach ($dbPDO->query($sql) as $row) {
    $sel_cat .= "<option value=\"{$row['id']}\">{$row['name']}</option>";
    }
  $sel_cat = "<select><option value=\"*\">All categories</option>$sel_cat</select>";

  echo $sel_cat; 
```

希望我已经澄清了足够的问题。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:23:38.630

您需要的可以在 SQL 中完成：

```
SELECT companies.name, SUM(IF(company_id IS NULL, 0, 1)) AS products
    FROM companies
    LEFT JOIN products ON (companies.id = products.company_id)
    GROUP BY companies.id; 
```

`LEFT JOIN`确保所有公司都被选中，并确保`SUM`计数正确（`COUNT`对于没有产品的公司，简单将返回 1）。

# mod-rewrite - 在 lighttpd 中为 opencart 重写 Mod

> ID：13148327
> 
> 赞同：1
> 
> 时间：2012-10-30T22:12:48.453
> 
> 标签：mod-rewrite, opencart, lighttpd

这些是 lighttpd.conf 中的规则

```
$HTTP["host"] =~ "^(www\.)?mysite.com" {
url.rewrite-once = ( "^/$" => "/index.php?route=common/home" )
url.rewrite-if-not-file = ( "^/(.*)" => "/index.php?_route_=$1" )
url.access-deny = ( ".tpl", ".ini", ".log" )
server.error-handler-404  = "/index.php?route=error/not_found"
index-file.names = ( "index.php" )
} 
```

一切正常。当我打开 www.mysite.com/adidas 时，它可以工作，但是当我尝试打开 www.mysite.com/adidas?page=2 时，它给了我 error404。

当我尝试打开 www.mysite.com/admin 它再次给我error404，但是当我打开 www.mysite.com/admin/index.php 它工作...

我该如何解决它..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:21:08.683

发现[这篇文章](http://redmine.lighttpd.net/boards/2/topics/4569)似乎回答了你的第一个问题。对于管理问题，我假设您至少需要使用`/admin/`包括第二个正斜杠

# c# - 有没有办法在剃刀（MVC3）视图中执行“外部别名”？

> ID：13148333
> 
> 赞同：9
> 
> 时间：2012-10-30T22:13:21.073
> 
> 标签：c#, razor, alias, extern

有没有办法做`extern alias`一个剃刀内部（MVC3）视图？

我有同一个程序集的两个版本（即 1.0 和 2.0），它们的类型具有相同的名称和命名空间，我需要一种方法来在 razor 视图中指定较新的程序集。

我试过了：

```
@extern 
```

和：

```
@{ extern alias MyAlias; } 
```

但这些都不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-01T07:37:32.533

在你项目的“Views”目录下的“web.config”文件中。找到这个部分。

```
<system.web.webPages.razor>
  <pages pageBaseType="System.Web.Mvc.WebViewPage">
    <namespaces>
      <add namespace="System.Web.Mvc" />
      <add namespace="System.Web.Mvc.Ajax" />
      .
      .
      <!-- etc -->
    </namespaces>
  </pages>
</system.web.webPages.razor> 
```

您可以像这样添加自定义命名空间：

```
<add namespace="My.Custom" /> 
```

这会将命名空间添加到所有 Razor（.cshtml 或 .vbhtml）文件。

# javascript - jQuery动画偏移/位置

> ID：13148335
> 
> 赞同：0
> 
> 时间：2012-10-30T22:13:25.197
> 
> 标签：javascript, jquery

我正在使用 jQuery animate 来更改元素的位置：

`$('#item').animate({'top' : '-50'}, 0);`

我不需要动画，我只想设置位置。我尝试了两者`offset`和`position`，但似乎都没有正常工作。

应该如何更新它以不使用动画？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T22:14:26.547

你可以试试：

```
$('#item').css({'top' : '-50'}); 
```

# html - 在matlab中读/写一个在线.wav文件？

> ID：13148344
> 
> 赞同：3
> 
> 时间：2012-10-30T22:13:59.900
> 
> 标签：html, matlab, url

我目前正在学校的信号处理实验室工作，需要我下载和分析 .wav 文件。我想知道是否有方法`wavread()`或`wavwrite()`URL，这样我就不必每次移动到新计算机或将代码发送给我的小组成员时都重新下载音频文件？

所有文件都可以在[这里](http://www.soe.uoguelph.ca/webfiles/sgregori/signal.html)找到。
这是 .wav 文件之一的网址：http: [//www.soe.uoguelph.ca/webfiles/sgregori/Audio/speech.wav](http://www.soe.uoguelph.ca/webfiles/sgregori/Audio/speech.wav)

我已经尝试过 `urlread()`，`urlwrite()`但老实说，我不太明白如何处理 html 编码。我也试过：

```
[x,fs]=wavread('http://www.soe.uoguelph.ca/webfiles/sgregori/Audio/speech.wav'); 
```

但最终出现错误：

> 使用 wavread 时出错（第 67 行）
> 无效的波形文件。原因：无法打开文件。

我也在使用学生版的 Matlab，所以也许这就是问题所在？

任何帮助将不胜感激！

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T23:05:48.483

这应该有效：

```
urlwrite('http://www.soe.uoguelph.ca/webfiles/sgregori/Audio/speech.wav','s1.wav'); 
```

这会将文件保存`s1.wav`到您处理的目录中。然后线

```
[x,fs]=wavread('s1'); 
```

应该可以正常工作

# testing - Selenium：无法点击类和图像

> ID：13148345
> 
> 赞同：0
> 
> 时间：2012-10-30T22:14:09.360
> 
> 标签：testing, selenium, selenium-webdriver, xpath

我正在使用 Selenium 网络驱动程序并尝试单击搜索图像，但无法单击它。我不确定出了什么问题。我努力了

xpath 选项

```
driver.findElement(By.xpath("//form/div/div/div/div/div[2]/table/tbody/tr/td[2][@class='icon-button combo-button']")).click(); 
```

还尝试了图像

```
driver.findElement(By.xpath("//form/div/div/div/div/div[2]/table/tbody/tr/td[2]/img[contains(@src,'iconActionSearch.png')]")).click(); 
```

我已经从 Selenium IDE 尝试过完全相同的方法

```
driver.findElement(By.xpath("//div[@id='divToolbar']/div[2]/table/tbody/tr/td[2]/img")).click(); 
```

这是上面的代码应该起作用的地方

```
 <td class="icon-button combo-button" title="Search">
    <img src="../common/images/iconActionSearch.png"> 
```

这是我的 html 片段

```
<!DOCTYPE html>
<html>
<head>
<body class="navigator" onbeforeunload="closeAllChildWindows()" onload="initializeSlideIns()">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<div class="mmenu" style="display: none;">
<form name="navigatorForm">
<div id="pageHeadDiv">
<div class="toolbars">
<div class="toolbar-container">
<div id="divToolbar" class="toolbar-frame">
<div class="toolbar">
<div class="toolbar functions">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="icon-button" nowrap="" itemid="emx567127522162.935" title="Home">
<td class="icon-button combo-button" title="Search">
<img src="../common/images/iconActionSearch.png">
</td>
<td class="menu-arrow" title="Search">
<td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="breadcrumbs">
<script src="./scripts/emxBreadcrumbs.js" type="text/javascript">
<script src="./scripts/emxQuery.js" type="text/javascript">
<script type="text/javascript">
<div id="pageContentDiv" style="top: 62px;">
<div id="layerOverlay" style="display: none;"></div>
<div id="panelSlideIn" class="dialog viewer" style="top: 62px; display: none;">
<div id="windowshadeMask" style="z-index: 50; display: none;">
</form>
<div id="checkoutdiv">
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:53:25.830

尝试使用 css 选择器替代：

```
String cssSelector="td[class='icon-button combo-button']>img"
driver.findElement(By.cssSelector(cssSelector)).click(); 
```

一条建议：使用 firebug、firefox 扩展来验证您正确定位元素 ![在此处输入图像描述](../Images/70491baca91eb98d4bd6d8f7c3771882.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T16:15:13.233

就像 eugene 的不同解决方案一样（顺便说一句，这是一种更好的方法，因为 CSS 选择器会更快），如果您必须使用 XPath：

```
//td[@class='icon-button combo-button']/img 
```

您原来的 XPath 解决方案永远不会起作用，它们非常局限于特定的位置。你在某处添加了一个额外的 div，你的整个 XPath 就会崩溃。所以选择一些不那么脆弱的东西。

# r - 如何在for循环中的数据框中创建变量？

> ID：13148348
> 
> 赞同：4
> 
> 时间：2012-10-30T22:14:22.277
> 
> 标签：r, variables, for-loop

我有一个 R 数据框`mydata`，其中包含特定年龄和特定身高的人数。因此*，在*数据框中，我有变量`mydata$ageto10`（= 10 岁以下的人数）、`mydata$ageto20`（= 20 岁以下的人数）等等，年龄分别为 35、42 和 65 岁。同样如此对于高度（以及其他几个变量）。

我想创建新变量，这些变量指的是年龄范围 10 到 25、年龄范围 25 到 35、35 到 42 和 42 到 65 内的人数。所以对于第一种情况，我想做：

```
mydata$age10to25 <- mydata$ageto25 - mydata$ageto10 
```

这可行，但我想在所有范围内执行此操作，并对高度和其他变量执行相同操作。一定有比复制粘贴这 40 次并手动更改变量名更简单的方法！:)

我认为它应该是这样的：

```
for (i in c("age", "height"))
{
  for (k in c(10,20,35,42, 65))
  {
  assign(paste("mydata$", i, k, "to", <<next k here>>, sep=""), get(paste("mydata$", i, <<next k here>>, , sep="")) - get(paste("mydata$", i, k, , sep=""))
  }
} 
```

但显然这不起作用（即使我手动填写 k ，似乎该`assign`命令也不适用于将变量名称分配给当前数据。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T22:25:43.603

我假设您是来自另一个统计数据包的难民（`stata`也许是 或`SAS`）。您不能使用 assign 分配给使用`$`and的列`paste`。一般来说，如果您正在使用`assign`标准任务，您正在做一些不习惯的事情`R`，或者有更好的解决方案。

就像是

```
lower <- c(10,25,35,42)
upper <- c(25,35,42,65)

# create the differences
newData <-   myData[,paste0('ageto',upper)] - myData[, paste0('ageto',lower)]
# name them with valid names (not starting with numbers
names(newData) <- paste0('from',lower,'to',upper)
# add as columns to the original
myData <- cbind(myData, newData) 
```

无需循环！

# c++ - 静态演员和新演员之间的区别

> ID：13148352
> 
> 赞同：0
> 
> 时间：2012-10-30T22:14:31.883
> 
> 标签：c++, memory, pointers, memory-management, dynamic

我知道动态分配内存的两种方法。我了解“新”是如何工作的，但我不明白“静态演员”是如何工作的：

```
double* A1;
double** A2;

//1D array
A_1 = new double[size];

A_1 = static_cast <double*> (new double[c]);

//2D array
A_2 = reinterpret_cast <double**> (new double[r]);
for(i = 0; i < r; i++)
    A_2[i] = static_cast <double*> (new double[c]); 
```

我不明白 static 和 reinterpret 是如何工作的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:53:03.623

虽然 new 是分配新对象的关键字，但 static_cast 和 reinterpret_cast 用于不同的目的，并且正如其他人现在所指出的那样，不要分配内存。

一个简短的解释是 static_cast 在指向兼容类的指针或兼容的非指针类型之间转换。因此，您可以将 Vehicle 指针转换为 Car 指针或以其他方式转换，但是在运行时不会检查您的 Vehicle 在您转换时实际上是 Car。另一方面，dynamic_cast 具有运行时检查功能。

即使类型不兼容，reinterpret_cast 也会简单地转换指针。

有很多资源可以找到更深入的解释，例如[http://www.cplusplus.com/doc/tutorial/typecasting/](http://www.cplusplus.com/doc/tutorial/typecasting/)

# image - 使一个 JLabel 成为另一个 JLabel

> ID：13148353
> 
> 赞同：0
> 
> 时间：2012-10-30T22:14:39.570
> 
> 标签：image, jlabel

所以，这是我的问题。我有一个 JPanel，上面有一个 JLabel，我想要的是一旦单击 JLabel，它应该调整大小，（理想情况下它会随着它的比例而改变，但现在我使用的是一个常量值）。我已经返回了图像，现在我可以缩放它，但我无法让原来的 JLabel 变成新尺寸的。

所以这就是理想情况下应该发生的事情，e.getSource 应该成为新增加的 JLabel 大小。

我知道我已经很接近了，我做了一个 JOptionPane 作为调试语句，看看我是否可以增加大小，我可以。

为什么不能 ((JLabel)me.getSource = a; 我的新 JLabel 在哪里？

无论如何，这是我的代码：

请帮帮我。

```
public void mousePressed(MouseEvent me) {
        //GreetingCard.setBackground.findComponentAt(me.getX(), me.getY());
        //GreetingCard.setBackground.findComponentAt(me.getX(), me.getY)

      JLabel a= (JLabel) me.getSource();
      Icon icon = a.getIcon();

        int scale = 4;

        BufferedImage bi = new BufferedImage(
            scale*icon.getIconWidth(),
            scale*icon.getIconHeight(),
            BufferedImage.TYPE_INT_ARGB);
            Graphics2D g = bi.createGraphics();
            g.scale(scale,scale);
            icon.paintIcon(null,g,0,0);
            g.dispose();
            JLabel temp = new JLabel(new ImageIcon(bi));
            ((JLabel)me.getSource())= temp;

        JOptionPane.showMessageDialog(
            null,
            new JLabel(new ImageIcon(bi)));

      System.out.println("The size of the image is" + b.getIconWidth());
      initiateEvent = me;
        me.consume();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:30:45.337

me.getSource() 返回一个 JLabel，它不返回可以分配新值的变量。

可能最好的方法不是创建新的 JLabel，而只是将新的 ImageIcon 分配给旧的 JLabel。

((JLabel)me.getSource()).setIcon(new ImageIcon(bi));

您还需要调用标签或面板 updateUI() 来强制“硬”重绘并调整大小。

# unit-testing - 如何使用 Jasmine 和/或 Sinon 正确地对 jQuery 的 .ajax() 承诺进行单元测试？

> ID：13148356
> 
> 赞同：55
> 
> 时间：2012-10-30T22:15:14.240
> 
> 标签：unit-testing, jquery, jasmine, sinon

我有一个相当简单的函数，它返回一个 jQuery .ajax() 承诺，如下所示：

```
CLAW.controls.validateLocation = function(val, $inputEl) {
    return $.ajax({
        url: locationServiceUrl + 'ValidateLocation/',
        data: {
            'locationName': val
        },
        beforeSend: function() {
            $inputEl.addClass('busy');
        }
    }).done(function(result) {
        // some success clauses
    }).fail(function(result) {
        // some failure clauses
    }).always(function() {
        // some always clauses
    });
} 
```

在大多数情况下，这个新的 Promise 接口就像做梦一样工作，并且在使用 jQuery 的 .ajax() 时消除回调金字塔非常棒。但是，我终生无法弄清楚如何使用 Jasmine 和/或 Sinon 正确测试这些 Promise：

1.  所有 Sinon 的文档都假设您使用的是老式回调；我没有看到一个如何将它与 promises/deferreds 一起使用的示例

2.  当试图使用 Jasmine 或 Sinon spy 来监视 $.ajax 时，spy 有效地覆盖了 Promise，因此ajax 函数中不再存在其 、 和 子句，因此 Promise 永远不会解决并`done`抛出`fail`错误`always`

我真的很喜欢一两个如何使用上述测试库来测试这些新的 jQuery .ajax() 承诺的例子。我已经相当激烈地搜索了网络，并没有真正挖掘出任何东西。我确实找到的一个资源提到了使用 Jasmine.ajax，但如果可能的话，我想避免这种情况，因为 Sinon 提供了开箱即用的大部分相同功能。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-10-31T19:07:28.707

实际上并没有那么复杂。根据您的情况返回一个承诺并解决它就足够了。

例如：

```
spyOn($, 'ajax').andCallFake(function (req) {
    var d = $.Deferred();
    d.resolve(data_you_expect);
    return d.promise();
}); 
```

为了成功，或

```
spyOn($, 'ajax').andCallFake(function (req) {
    var d = $.Deferred();
    d.reject(fail_result);
    return d.promise();
}); 
```

失败。

Jasmine 2.0 的语法略有变化：

```
spyOn($, 'ajax').and.callFake(function (req) {}); 
```

Jasmine 2.0 中不存在 .andCallFake() 方法

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-18T17:45:44.117

沿着这些思路 / 使用 sinon 和 jQuery 延迟

```
ajaxStub = sinon.stub($, "ajax");

function okResponse() {
  var d = $.Deferred();
  d.resolve( { username: "testuser", userid: "userid", success: true } );
  return d.promise();
};

function errorResponse() {
 var d = $.Deferred();
 d.reject({},{},"could not complete");
 return d.promise();
};

ajaxStub.returns(okResponse());
ajaxStub.returns(errorResponse()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T12:14:49.807

这是一种仅使用 javascript 的更简单的方法。

```
quoteSnapshots: function (symbol, streamId) {
                var FakeDeferred = function () {
                    this.error = function (fn) {
                        if (symbol.toLowerCase() === 'bad-symbol') {
                            fn({Error: 'test'});
                        }
                        return this;
                    };
                    this.data = function (fn) {
                        if (symbol.toLowerCase() !== 'bad-symbol') {
                            fn({});
                        }
                        return this;
                    };
                };

                return new FakeDeferred();
            } 
```

每个回调中的 if 语句是我在测试中用来驱动成功或错误执行的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-21T01:57:17.020

如果您使用诸如`.complete()`.

但是，万岁，茉莉花做了一个插件来做到这一点：http: [//jasmine.github.io/2.0/ajax.html](http://jasmine.github.io/2.0/ajax.html)

```
beforeEach(function() {
  jasmine.Ajax.install();
});

afterEach(function() {
  jasmine.Ajax.uninstall();
});

//in your tests
expect(jasmine.Ajax.requests.mostRecent().url).toBe('/some/cool/url'); 
```

# hash - 为什么要使用河豚作为密码？

> ID：13148366
> 
> 赞同：1
> 
> 时间：2012-10-30T22:16:13.430
> 
> 标签：hash, passwords, blowfish

我对密码安全保存有点困惑。假设我有带有用户帐户表的数据库。这是我保存密码的地方。此时我正在使用盐渍sha1。

我读过基于 Blowfish 的函数比 sha1 更好，因为它们需要更多时间来处理请求。

是否有任何理由不使用盐渍 sha1 并将登录尝试次数限制在某个合理的数字（例如每小时 50 次）作为暴力攻击的“防火墙”？

使用这个数据库的人不需要暴力破解任何东西，因为他可以通过查询更改记录。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T08:07:08.133

使用基于河豚的函数，您肯定是指**BCrypt**哈希函数。正如您已经说过的那样，BCrypt 的设计速度很慢（需要一些计算时间），这是与其他快速哈希函数相比的唯一优势，但这是至关重要的。

使用现成的 GPU，您可以每秒计算大约[3 个 Giga哈希值，因此您可以在不到](http://hashcat.net/oclhashcat-lite/#performance)**2 毫秒**的时间内暴力破解包含 5'000'000 个单词的整个英语词典。即使 SHA-1 是一个安全的散列函数，它也不适合散列密码。

BCrypt 有一个**成本因素**，可以适应未来的硬件，因此速度更快。成本因素决定了执行多少次散列迭代。最近我写了一篇[关于散列密码的教程](http://www.martinstoeckli.ch/hash/hash.html)，我会邀请你看看它。

您关于限制登录尝试的观点是有道理的，但散列应该保护密码，以防攻击者访问数据库（SQL 注入）。当然，您可以限制登录尝试，但这与散列无关，您甚至可以在这种情况下存储密码明文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:55:04.877

将密码存储在 Blowfish 中比 SHA-1 更安全，因为到目前为止，还没有报道过获取 Blowfish 加密字符串值的方法。另一方面，SHA-1 确实报告了从加密字符串中获取数据的方法。**您不能相信 SHA-1 会阻止某人获取其数据。**

如果您愿意接受建议，我认为在存储密码时根本不需要使用双向加密。使用加盐**SHA-256**方法散列您的用户密码可能是一种选择。允许您的用户通过电子邮件重置自己的密码通常被认为是一个好的策略，它会导致数据集不容易被破解。

如果出于任何原因*确实*需要双向加密，除了 Blowfish，**AES-256** (Rijndael) 或**Twofish**目前也足够安全，可以处理敏感数据。不要忘记您可以自由地使用多种算法来存储加密数据。

关于暴力破解，它与加密数据库存储几乎没有关系。当您提到攻击方法时，您正在查看完整的安全模型。使用已弃用的算法并通过实施策略来“弥补”以防止易受攻击**并不**被认为是一种成熟的安全方法。

**简而言之**

*   使用一种方式散列来存储密码，允许用户通过电子邮件重置
*   不要害怕使用多种方法存储加密数据
*   如果您必须使用加密/解密方案，请确保您的密钥安全并仅使用经过验证的算法
*   防止暴力攻击是一种很好的心态，但它只会减慢某人的速度或鼓励他们寻找其他入口点

不要把这当作信条：当谈到安全性时，每个人都有不同的要求，你做的研究越多，你的方法就会变得越好。如果您没有使用全面的安全策略完全封装您的敏感数据，您可能会在跟踪过程中遇到令人讨厌的意外。

资料来源：维基百科，[http ://eprint.iacr.org/2005/010](http://eprint.iacr.org/2005/010)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T22:25:40.180

> 是否有任何理由不使用加盐 sha1 并将登录尝试次数限制在某个合理的数字（例如每小时 50 次）作为暴力攻击的“防火墙”？

如果您不使用任何体面的算法加密您的密码，那么您就没有采取基本的安全预防措施。

**为什么“只是”阻止登录尝试不安全？**

除了您需要阻止所有可能的入口之外，例如*：*

*   SSH
*   网络服务（您的网络应用程序、phpmyadmin、openpanel 等）
*   ftp
*   *更多*

您还需要信任每个有权访问数据库和服务器的用户，我不希望人们阅读我的密码，但我更不喜欢的是，从元学上讲，您是为我决定的 :-)

也许其他人可以阐明 Blowfish 与 SHA 的讨论，尽管我怀疑那部分是一个可堆叠的格式化问题

# html - 为什么我的标题中的这个标志偏离中心，我该如何解决？

> ID：13148368
> 
> 赞同：0
> 
> 时间：2012-10-30T22:16:35.247
> 
> 标签：html, css, joomla

这是我的网站： http: [//mylifeiscode.com/studentprintz/](http://mylifeiscode.com/studentprintz/)

在 Chrome 中，徽标加载居中，但在 Firefox 和 IE 中，它位于右侧。我已经在其中摆弄了一个小时的 CSS，但我不明白为什么它在其他两个浏览器中被推到右侧。

有谁知道 CSS 属性在做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:25:11.233

你是绝对定位，但不告诉定位在哪里。将边距更改为位置。所以，而不是：

```
a#logo, #logo-text { position: absolute; margin-top: 25px; margin-left: 5px; } 
```

尝试

```
a#logo, #logo-text { position: absolute; top: 25px; left: 5px; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:20:53.707

在第 40 行的 template.css 中，更改：

```
margin-left: 5px; 
```

对此：

```
left: 5px; 
```

顺便说一句，如果您使用 Firefox，我建议您将 Firebug 下载到您可以乱用 CSS，以防发生这种情况。

# javascript - 我可以在 .js 文件中使用 window.top

> ID：13148369
> 
> 赞同：1
> 
> 时间：2012-10-30T22:16:42.190
> 
> 标签：javascript, jquery, html

我将一些变量从我的 gwt 代码传递到 jsp 文件。是这样的

```
 <html>
  <head>
  <script type="text/javascript">
   alert("Inside the jsp file");
   var criticalPath = window.top.criticalPath;

   </script>
   </head>
   <body>
   <script type="text/javascript" src="./js/flow.js"></script>          
   </body>
   </html> 
```

我想要的是将criticalPath 变量传递给flow.js 文件。我知道 flow.js 是否是一种我可以传递变量的方法，但我不想那样做。有什么方法可以避免该方法并将变量传递给 flow.js 或者我可以在 flow.js 中调用 window.top.criticalPath 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:41:30.847

您没有将变量`criticalPath`放在任何特定范围内，这意味着它是一个全局变量，因此可以从任何 js 文件访问它（只要在`criticalPath`声明后加载它们。

# android - 来自服务器的 Android Spinner

> ID：13148370
> 
> 赞同：0
> 
> 时间：2012-10-30T22:16:56.567
> 
> 标签：android, json, android-arrayadapter, android-spinner

我的应用程序中有一个微调器。该微调器将填充来自服务器的一些数据。在我的 logcat 中，我成功解析了 JSON 数据，但我不知道为什么当我尝试设置适配器时出现`java.lang.NullPointerException`错误，这是我的日志：

```
10-31 04:59:01.607: E/AndroidRuntime(28692): FATAL EXCEPTION: main
10-31 04:59:01.607: E/AndroidRuntime(28692): java.lang.NullPointerException
10-31 04:59:01.607: E/AndroidRuntime(28692):    at java.util.Arrays$ArrayList.<init>(Arrays.java:47)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at java.util.Arrays.asList(Arrays.java:169)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at android.widget.ArrayAdapter.<init>(ArrayAdapter.java:125)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at com.example.androidsql.NewProductActivity$getCity$1.run(NewProductActivity.java:437)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at android.app.Activity.runOnUiThread(Activity.java:3743)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at com.example.androidsql.NewProductActivity$getCity.onPostExecute(NewProductActivity.java:433)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at com.example.androidsql.NewProductActivity$getCity.onPostExecute(NewProductActivity.java:1)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at android.os.AsyncTask.finish(AsyncTask.java:417)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at android.os.AsyncTask.access$300(AsyncTask.java:127)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at android.os.Handler.dispatchMessage(Handler.java:99)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at android.os.Looper.loop(Looper.java:130)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at android.app.ActivityThread.main(ActivityThread.java:3691)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at java.lang.reflect.Method.invokeNative(Native Method)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at java.lang.reflect.Method.invoke(Method.java:507)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:907)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:665)
10-31 04:59:01.607: E/AndroidRuntime(28692):    at dalvik.system.NativeStart.main(Native Method) 
```

这是我的java类：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.add_product);
        ctx = this;

        //define all input text
        longitude = (EditText)findViewById(R.id.et_longitude);
        latitude = (EditText)findViewById(R.id.et_latitude);
        merchant = (EditText)findViewById(R.id.et_merchant);
        alamat = (EditText)findViewById(R.id.et_alamat);
        telp = (EditText)findViewById(R.id.et_telpon);
        hp = (EditText)findViewById(R.id.et_hape);
        bb = (EditText)findViewById(R.id.et_bb);
        email = (EditText)findViewById(R.id.et_email);

        //spinner
        spinCategory = (Spinner)findViewById(R.id.spin_category);

        dataAdapter1 = new ArrayAdapter<String>(getApplicationContext(),
                android.R.layout.simple_spinner_item);
        dataAdapter1.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinCategory.setAdapter(dataAdapter1);

        new getCity().execute();

        spinCategoryDetail = (Spinner)findViewById(R.id.spin_category_detail);

        //define path directory
        et_uploadlogo = (EditText)findViewById(R.id.et_path_uploadlogo);
        et_uploadfoto_f = (EditText)findViewById(R.id.et_path_uploadfoto_f);
        et_uploadfoto_s = (EditText)findViewById(R.id.et_path_uploadfoto_s);

        //define image
        img_logo = (ImageView)findViewById(R.id.imgview_logo);
        img_foto_f = (ImageView)findViewById(R.id.imgview_foto_f);
        img_foto_s = (ImageView)findViewById(R.id.imgview_foto_s);

        //OK button
        imgbtn_ok = (ImageButton)findViewById(R.id.imgbtn_ok);
        //refresh button
        btn_refresh = (Button)findViewById(R.id.btn_refreshlonglat);

        //button browse
        btn_browse_ulogo = (Button)findViewById(R.id.btn_browse_uploadlogo);
        btn_browse_ufoto_f = (Button)findViewById(R.id.btn_browse_uploadfoto_f);
        btn_browse_ufoto_s = (Button)findViewById(R.id.btn_browse_uploadfoto_s);

        //location service
        locManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        locManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 1, 1000, this.locationListener);

        //get CurretLocation
        showCurrentLocation();

        //action click buttton browse image logo
        btn_browse_ulogo.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent ig = new Intent();
                    ig.setType("image/*");
                    ig.setAction(Intent.ACTION_GET_CONTENT);
                startActivityForResult(Intent.createChooser(ig, "Select Picture"), IMAGE_GALLERY_LOGO);
            }
        });

      //action click buttton browse image foto1
        btn_browse_ufoto_f.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
            Intent ig = new Intent();
                ig.setType("image/*");
                ig.setAction(Intent.ACTION_GET_CONTENT);
            startActivityForResult(Intent.createChooser(ig, "Select Picture"), IMAGE_GALLERY_FOTO_F);
            }
        });

      //action click buttton browse image foto2
        btn_browse_ufoto_s.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
            Intent ig = new Intent();
                ig.setType("image/*");
                ig.setAction(Intent.ACTION_GET_CONTENT);
            startActivityForResult(Intent.createChooser(ig, "Select Picture"), IMAGE_GALLERY_FOTO_S);
            }
        });

      //refresh longitude,latitude
        btn_refresh.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                showCurrentLocation();
            }
        });

        imgbtn_ok = (ImageButton)findViewById(R.id.imgbtn_ok);
        imgbtn_ok.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                //post data
                new CreateNewProduct().execute();
            }
        });
    }

    private final LocationListener locationListener = new LocationListener() {

        @Override
        public void onLocationChanged(Location arg0) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onProviderDisabled(String provider) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onProviderEnabled(String provider) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onStatusChanged(String provider, int status, Bundle extras) {
            // TODO Auto-generated method stub

        }
    };

    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (requestCode == IMAGE_GALLERY_LOGO) {
            if (resultCode == RESULT_OK) {
                fileUri_logo = data.getData();
                selectedImagePath = getPath(fileUri_logo);
                et_uploadlogo.setText(selectedImagePath); 
                img_logo.setImageURI(fileUri_logo);
            }   
        } else {
            if (requestCode == IMAGE_GALLERY_FOTO_F) {
                fileUri_foto_f = data.getData();
                selectedImagePath = getPath(fileUri_foto_f);
                et_uploadfoto_f.setText(selectedImagePath);
                img_foto_f.setImageURI(fileUri_foto_f);
            } else {
                if (requestCode == IMAGE_GALLERY_FOTO_S) {
                    fileUri_foto_s = data.getData();
                    selectedImagePath = getPath(fileUri_foto_s);
                    et_uploadfoto_s.setText(selectedImagePath);
                    img_foto_s.setImageURI(fileUri_foto_s);
                }
            }
        } 
    }

    public String getPath(Uri uri) {
        String[] projection = { MediaStore.Images.Media.DATA };
        Cursor cursor = managedQuery(uri, projection, null, null, null);
        int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
        cursor.moveToFirst();
        return cursor.getString(column_index);
    }

    protected void showCurrentLocation() {
        Location location = locManager.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
        if (location != null) {
            String lat = String.valueOf(location.getLatitude());
            String lon = String.valueOf(location.getLongitude());
            latitude.setText(lat);
            longitude.setText(lon);
        }
    }

    /**
     * Background Async Task to Create new product
     * */
    class CreateNewProduct extends AsyncTask<String, String, String> {

        /**
         * Before starting background thread Show Progress Dialog
         * */
        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            pDialog = new ProgressDialog(NewProductActivity.this);
            pDialog.setMessage("Loading, saving data...");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(true);
            pDialog.show();
        }

        /**
         * Creating data
         * */
        protected String doInBackground(String... args) {
            slongitude = longitude.getText().toString();
            slatitude = latitude.getText().toString();
            smerchant = merchant.getText().toString();
            salamat = alamat.getText().toString();
            stelp = telp.getText().toString();
            shp = hp.getText().toString();
            sbb = bb.getText().toString();
            semail = email.getText().toString();

            // Building Parameters
            List<NameValuePair> params = new ArrayList<NameValuePair>();
                params.add(new BasicNameValuePair("Pk_Merchant_ID", ""));
                params.add(new BasicNameValuePair("Fk_Ms_DataLevel2_ID", "2"));
                params.add(new BasicNameValuePair("Fk_Ms_City_ID", "2"));
                params.add(new BasicNameValuePair("Fk_Ms_Sales_ID_CreatedBy", "1"));
                params.add(new BasicNameValuePair("FK_Ms_Sales_ID_LastUpdateBy", "1"));
                params.add(new BasicNameValuePair("CreatedDated", ""));
                params.add(new BasicNameValuePair("LastUpdateDated", ""));
                params.add(new BasicNameValuePair("merchant", smerchant));
                params.add(new BasicNameValuePair("alamat", salamat));
                params.add(new BasicNameValuePair("telp", stelp));
                params.add(new BasicNameValuePair("hp", shp));
                params.add(new BasicNameValuePair("bb", sbb));
                params.add(new BasicNameValuePair("email", semail));
                params.add(new BasicNameValuePair("longitude", slongitude));
                params.add(new BasicNameValuePair("latitude", slatitude));
                params.add(new BasicNameValuePair("Is_Deleted", ""));

            // getting JSON Object
            // Note that create product url accepts POST method
            JSONObject json = jsonParser.makeHttpRequest(url_create_merchant,
                    "POST", params);

            // check log cat fro response
            Log.d("Create Response", json.toString());

            // check for success tag
            try {
                int success = json.getInt(TAG_SUCCESS);

                if (success == 1) {
                    // successfully created product
                    Log.d("Berhasil", "Good");

                    Intent i = new Intent(getApplicationContext(), PreviewActivity.class);
                        i.putExtra("lon", slongitude);
                        i.putExtra("lat", slatitude);
                        i.putExtra("mer", smerchant);
                        i.putExtra("ala", salamat);
                        i.putExtra("tel", stelp);
                        i.putExtra("hp", shp);
                        i.putExtra("pbb", sbb);
                        i.putExtra("ema", semail);
                    startActivity(i);

                    // closing this screen
                    finish();
                } else {
                    // failed to create product
                }
            } catch (JSONException e) {
                e.printStackTrace();
                Log.d("Gagal", e.toString());
            }
            return null;
        }

        /**
         * After completing background task Dismiss the progress dialog
         * **/
        protected void onPostExecute(String file_url) {
            // dismiss the dialog once done
            pDialog.dismiss();
        }
    }

    class getCity extends AsyncTask<String, String, String> {

        @Override
        protected String doInBackground(String... params) {
            List<NameValuePair> param = new ArrayList<NameValuePair>();

            JSONObject json = jsonParser.makeHttpRequest(url_spincategory, "GET", param);
            Log.d("Get List Spinner Category :", json.toString());

            try {
                int success = json.getInt(TAG_SUCCESS);
                if (success == 1) {
                    data = json.getJSONArray(TAG_Ms_DataLevel1);
                    for (int i=0; i<data.length(); i++) {
                        JSONObject j = data.getJSONObject(i);
                        Pk_Ms_DataLevel1_ID[i] = j.getString(TAG_Pk_Ms_DataLevel1_ID);
                        Descriptions[i] = j.getString(TAG_Descriptions);

                        list_category = new ArrayList<String>();
                        list_category.add(Descriptions[i]);
                    }

                }
            } catch (Exception e) {
                e.printStackTrace();
            }
            return null;
        }

        @Override
        protected void onPostExecute(String s) {
            runOnUiThread(new Runnable() {
                @Override
                public void run() {
                    // TODO Auto-generated method stub
                    ArrayAdapter<String> dataAdapter1 = new ArrayAdapter<String>(ctx,
                            android.R.layout.simple_spinner_item, Descriptions);
                    dataAdapter1.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
                    spinCategory.setAdapter(dataAdapter1);
                }
            });
        }
    }
} 
```

我需要您的建议、评论和您的所有帮助。感谢提前。

# mysql-workbench - 我可以使用 MySQL Workbench 连接到 Microsoft SQL Server

> ID：13148374
> 
> 赞同：34
> 
> 时间：2012-10-30T22:17:38.343
> 
> 标签：mysql-workbench

我可以使用 MySQL Workbench 连接到 MSSQL 数据库服务器吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2016-05-18T21:48:02.190

您不能将 MySQL Workbench 用作 Microsoft SQL Server 客户端。

但从技术上讲，是的，如果您使用数据库迁移向导，您可以使用 ODBC 连接到 Microsoft SQL Server 数据库。

来源：[https ://dev.mysql.com/doc/workbench/en/wb-migration-wizard-connection.html](https://dev.mysql.com/doc/workbench/en/wb-migration-wizard-connection.html)

# c++ - 包含 Linked List 的 Linked List 会出现堆损坏错误：为什么？

> ID：13148375
> 
> 赞同：1
> 
> 时间：2012-10-30T22:17:48.607
> 
> 标签：c++, list, memory, linked-list, heap-memory

*长话短说：我制作了一个模板双链表，将列表放在其他列表中会导致问题。这个问题已经解决了。*

我正在测试作为模板的双链表，我遇到了一个问题，将一个链表放在另一个链表中会出现以下错误：

（微软 Visual Studio 2010 速成版）

> Windows 已在 linkListTesting.exe 中触发断点。这可能是由于堆损坏，这表明 linkListTesting.exe 或其已加载的任何 DLL 中存在错误。这也可能是由于用户在 linkListTesting.exe 获得焦点时按 F12。输出窗口可能有更多诊断信息。

搜索此特定错误会产生类似于“确保您不使用未初始化的变量”的结果 - 在这种情况下，当我将列表告诉 push_back / push_front 等时，它应该为我初始化列表。（不按 F12，这样场景就结束了。）

这是我的主要 cpp->

```
#include "vcLLMK2.h"

int main(int argc, char *argv[])
{
    vcList<vcList<int>> a;
    vcList<int> b;
    b.push_back(1);
    a.push_back(b);
    //ERROR HAPPENS HERE APPARENTLY
    return 0;
} 
```

将新条目（在本例中为“1”）向后（或前面，也尝试过）推入“b”效果很好。没有崩溃，没有愚蠢。将 'b' 推入 'a' 会导致应用程序吐出上述错误，触发断点，然后死掉。

我最近开始使用 SDL，并打算使用列表作为 16 层的容器，这些层基本上是要渲染的精灵/瓷砖/等列表。思维模式是程序将遍历包含层列表中的每个条目，然后渲染包含层中的每个对象，然后再继续下一个。

“为什么不直接使用 std::list？” -因为那是**作弊**。

虽然很可能那些在这个线程中回答的人将能够指出我非常不知道的列表结构和实现中的每一个明显缺陷，但我最关心的是特别是什么导致这个特殊错误以及如何解决它。也就是说，我对你们的问题是**我构建的链接列表设置有什么问题导致上述 cpp 在运行时出错？**

下面的链接列表结构是阅读以下页面的高潮：
[http://www.codeproject.com/Articles/26631/Using-C-templates-for-functions-and-operators](http://www.codeproject.com/Articles/26631/Using-C-templates-for-functions-and-operators)
[http://www.cprogramming.com /tutorial/lesson15.html](http://www.cprogramming.com/tutorial/lesson15.html)
[http://geekswithblogs.net/MarkPearl/archive/2010/02/20/linked-lists-in-c.aspx](http://geekswithblogs.net/MarkPearl/archive/2010/02/20/linked-lists-in-c.aspx%29)
把它变成一个模板，主要是对这个页面的创造性解释的结果：
[http ://www.cplusplus.com/doc/tutorial/templates/](http://www.cplusplus.com/doc/tutorial/templates/)

这是我的链接列表模板类，有很多评论->

```
#pragma once
#ifndef vcLLMK2_H_INCLUDED
#define vcLLMK2_H_INCLUDED
#define NULL 0

//THIS IS ALL OUR NODE SHOULD EVER NEED
template <class T>
struct vcListNode
{
    public:
    T data;
    vcListNode<T> *next;
    vcListNode<T> *prev;
};

template <class T>
struct vcList
{
    public:
    vcListNode<T> *root;//the list's "start"
    vcListNode<T> *end;//the list's "end"
    vcListNode<T> *cur;//used to bounce around amongst entries

    int size();//returns number of non-null entries
    int count;//because keeping track of these is easier than iterating through every time

    void setAt(T,int);//sets data in a node
    void push_front(T);//inserts a new node at the beginning of the list
    void push_back(T);//same thing but back of list
    void removeAt(int);//kills a node at an arbitrary spot in the list
    void clear();//deletes all of the nodes in the list
    T getAt(int);//returns data from a node in the list
    vcList<T>& operator = (const vcList<T>&);//used for setting list a's contents to list b
    //EDIT COPYCONSTRUCTOR
    vcList<T>(const vcList<T>&);//copyconstructor

    vcList();// : root(NULL),end(root),cur(NULL),count(0){};
    ~vcList();
};

//constructor - sets everything to null and count to zero on init
template <class T>
vcList<T>::vcList()
{
    root=NULL;
    cur=NULL;
    end=NULL;
    count=0;
}

//destructor - deletes all nodes
template <class T>
vcList<T>::~vcList()
{
    clear();
}

//deletes all nodes from root to end
template <class T>
void vcList<T>::clear()
{
    if(root==NULL)//assume list has nothing in it, abort
    return;

    //set current targeted entry to root
    cur = root;
    //as long as we have somewhere to go...
    while(cur->next!=NULL)
    {
        //go there
        cur=cur->next;
        //and destroy where we were
        delete cur->prev;
    }
    //then destroy ourselves because nihilism is good for memory
    delete cur;
}

//used to set the contents of a list equal to those of another
template <class T>
vcList<T>& vcList<T>::operator= (const vcList<T> &fays)
{
    //for starters, clear ourselves of any unwanted garbagedata
    clear();

    //check the import list's root entry
    cur = fays.root;

    //if the list containing the values we are importing is empty, we're done, move along
    if(cur==NULL)
    return *this;

    //otherwise, make a new node - it's our new root
    vcListNode<T> *newEntry = new vcListNode<T>;
    newEntry->data = fays.root->data;
    newEntry->prev = NULL;
    newEntry->next = NULL;
    //set root/end to the new entry
    root = newEntry;
    end = newEntry;
    //update our count
    count=1;

    //fire through the import-list's entries
    //cur starts at root
    while(cur->next!=NULL)//(count<fays.count)
    {
        //move to next entry
        cur=cur->next;
        //add it to our list, push_back should update the location of 'end' for us
        push_back(cur->data);
    }
    //we should be done here, so go ahead and return everything
    return *this;
}

//this is mostly for convenience
template <class T>
int vcList<T>::size()
{
    return count;
}

//adds a new entry to the front of our linked list
template <class T> 
void vcList<T>::push_front(T info)
{
    //eat some memory
    vcListNode<T> *newEntry;
    newEntry = new vcListNode<T>;

    //set our memory and all that neat stuff
    newEntry->data = info;
    newEntry->next = root;
    newEntry->prev = NULL;

    //if our linked list is not empty
    if(root!=NULL)
        //set root's previous link to point at our new entry
        root->prev = newEntry;

    //if our linked list does not have an assigned end yet
    if(end==NULL)
        //assume it's empty and set end to our entry
        end=newEntry;

    //update the position of our root in the list, the beginning now begins at the beginning again
    root = newEntry;

    //and since we added something to the list, we should probably update our count of things in the list
    count++;
}

//this finds an element in the pointer-chain and sets its information
template <class T> 
void vcList<T>::setAt(T info,int index)
{
    //set our target to the root
    cur=root;

    //run through the list's entries until we're where we're supposed to be
    while(index>0)
    {
        cur=cur->next;
        index--;
    }

    //set the data in the cell/node/whatever to our input
    cur->data=info;
}

//returns the data contained in a node at a position in the list
template <class T> 
T vcList<T>::getAt(int meBro)
{
    //set target to root
    cur=root;
    //progress through the list
    while(meBro>0)
    {
        cur=cur->next;
        meBro--;
    }
    //dig the data out of the entry and return it
    return cur->data;
}

//adds an element-containing node to the end of the list-chain
template <class T> 
void vcList<T>::push_back(T info)
{
    //if our list already has entries, end shouldn't be null
    if(end!=NULL)
    //so just target our end slot
    cur=end;

    //if our list is empty, however
    else
        //target the root instead
        cur=root;

    //create our new node, put stuff in it, etc
    vcListNode<T> *newEntry;
    newEntry = new vcListNode<T>;
    newEntry->data = info;
    //we're adding to the END of the list so make next null
    newEntry->next = NULL;

    //if cur is NOT null, then theoretically we're pointed at the end of the list
    if(cur!=NULL)
        //set our new entry's previous pointer to the end
        newEntry->prev = cur;

    //cur IS null, which means the list is empty
    else
        //set our entry's previous pointer to be null, duh
        newEntry->prev = NULL;

    //if the end of our list exists
    if(end!=NULL)
    {
        //set the next entry in the list to point at our new entry
        end->next = newEntry;
        //then set end to target the new entry
        end=newEntry;
    }
    //and if our list does not have an end yet for some reason (read as: it's empty)
    else
    {
        //set the root to our new entry
        root = newEntry;
        //set the end to our new entry as well, since there's only one entry in the list
        end = newEntry;
    }

    //update count of number of objects in list
    count++;
}

//this deletes/removes/destroys/obliterates a node at a location in the list
template <class T> 
void vcList<T>::removeAt(int index)
{
    //for starters - is what we're trying to kill even here?
    if(index>=count)
        //NOPE GET OUT
        return;

    //later on it might speed things up to check whether the distance from end or root is shorter
    //for now, just start at the beginning

    //target the root
    cur=root;

    //move through the list to the specified entry
    while(index>0)
    {
        index--;
        cur=cur->next;
    }

    //if the previous entry exists
    if(cur->prev!=NULL)
        //point its next at the entry after this one
        cur->prev->next=cur->next;

    //if the previous entry is NULL, it means we're at the root
    //so tell root to scoot forward one entry
    //if there's a forward to scoot to
    else if(cur->next != NULL)
    root = cur->next;

    //if the next entry exists
    if(cur->next!=NULL)
        //set the next entry's previous pointer to point at the entry before the targeted one
        cur->next->prev=cur->prev;

    //if the next entry does not exist, we must be at the end of the list
    //so tell the end of the list to scoot back one slot
    //if there's a back-one-slot to go to
    else if(cur->prev!=NULL)
    end = cur->prev;

    //remove the entry at the targeted location
    delete cur;

    //decrement our count
    count--;
}
//EDIT -> Copy Constructor
//copy constructor, similar as suggested to the operator=
template <class T>
vcList<T>::vcList(const vcList<T>& fays)
{
    //might not be completely necessary, but we're not hurting anything by making sure
    clear();

//check the import list's root entry
cur = fays.root;

    //if the list containing the values we are importing is empty, we're done, move along
    if(cur==NULL)
    return;//just return, constructors don't get return types

    //otherwise, make a new node - it's our new root
    vcListNode<T> *newEntry = new vcListNode<T>;
    newEntry->data = fays.root->data;
    newEntry->prev = NULL;
    newEntry->next = NULL;
    //set root/end to the new entry
    root = newEntry;
    end = newEntry;
    //update our count
    count=1;

    //fire through the import-list's entries
    //cur starts at root
    while(cur->next!=NULL)//(count<fays.count)
    {
        //move to next entry
        cur=cur->next;
        //add it to our list, push_back should update the location of 'end' for us
        push_back(cur->data);
    }
    //we should be done here, so go ahead and return everything
    //return *this;
}
#endif 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:17:04.080

我认为您应该看一下 C++ 中最重要的概念之一，即通过引用传递。push_back 方法作为一个名为 info 的参数，它是您用来调用该方法的对象的*副本。*由于您没有明确告诉编译器如何创建 vsList 对象的副本，因此它将创建一个默认的副本构造函数，但它不会按预期工作。

因此，当调用存储在对象“a”中的对象的析构函数时，代码上的问题确实发生了。由于它没有有效的指针，它会崩溃。您可以通过两种方式解决您的问题，将 push_back （和所有其他方法）更改为通过“const 引用”而不是通过值接收 T 或实现复制构造函数。

# database - Firebird 数据库的部分/选择性备份/副本

> ID：13148376
> 
> 赞同：2
> 
> 时间：2012-10-30T22:18:02.563
> 
> 标签：database, backup, firebird

我想备份一个 Firebird 数据库，但从备份中排除某些表，这可能吗？

如果没有，我想在 Firebird 数据库运行时制作一份副本（不进行备份和还原）

gbak 和 nbackup 似乎都不支持这样的事情，但是我们公司有一个可以进行选择性备份的软件，我只是不知道它是如何工作的。我想复制它的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T07:21:54.943

您可以使用 fbexport [http://fbexport.sourceforge.net导出表和查询](http://fbexport.sourceforge.net)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:31:21.140

gbak 只能做一个完整的数据库，但可以在 Firebird 在线时运行。

在不备份的情况下使用 gbak 最接近的方法是通过管道 gbak -B 到 gbak -R 来跳过中间备份文件。这也应该节省一些时间，因为这两个操作同时发生。例如，

```
gbak -B dbhost:mydb stdout -user SYSDBA -password masterkey | gbak -R stdin /firebird/mydbcopy.fdb -user SYSDBA -password masterkey 
```

否则，如果您只是想移动数据，您正在查看第 3 方工具。您还可以编写一个过程来利用[ON EXTERNAL DATA SOURCE](http://www.firebirdfaq.org/faq16/)在本地刷新您选择的表。（仅限火鸟 2.5）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-13T19:13:58.450

Firebird 版本 3 的 gbak 中有一个名为 skip_d 的新参数，您可以将正则表达式赋予此参数。

[你可以在这里](http://tracker.firebirdsql.org/browse/CORE-2208 "here")找到详细信息

例如：gbak -b -skip_d '(table1|table2|table3)' -user ...

# routes - Rails 3.2 如何制作作用域资源

> ID：13148379
> 
> 赞同：0
> 
> 时间：2012-10-30T22:18:43.767
> 
> 标签：routes, ruby-on-rails-3.2, nested-resources

我正在使用 Rails 3.2 并试图创建一个范围内的嵌套资源（不确定这是否是正确的术语）。我有几个组，我希望每个组都有自己的一组页面，如下所示：

```
/groups/1/pages/1
/groups/1/pages/2
/groups/1/pages/3
/groups/2/pages/1
/groups/2/pages/2
/groups/3/pages/1
/groups/3/pages/2
/groups/4/pages/1
etc. 
```

首先，我创建了一个`groups`控制器和一个`pages`控制器并将它们嵌套起来

```
resources :groups do
  resources :pages
end 
```

`:group_id`我遇到的问题是我可以通过更改URL 中的2、3 和 4 组来查看组 1 的页面。此外，页面 ID 在所有组中都是唯一的，而不仅限于单个组。

接下来我尝试通过做一个嵌套控制器，`rails g controller groups/pages index show new create edit update destroy`但我也无法让它工作。我不知道足够的 Rails 术语来弄清楚谷歌的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T04:53:09.473

我认为您要完成的是[关联](http://guides.rubyonrails.org/association_basics.html)。而不是生成控制器，您可能应该生成脚手架（包括模型、控制器和默认视图）。至少，您将需要组和页面模型。

然后添加`has_many :pages`您的组模型。并添加`belongs_to :group`您的页面模型。然后，您需要在`group_id`页面模型/数据库中添加一列。

但是，如果我错了并且您要做的只是对组进行分页，那么请使用[will_paginate](https://github.com/mislav/will_paginate/wiki) gem。

我还建议您阅读[Mike Hartl 的教程](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)。它会给你一个很好的背景，你将学习 Rails 术语和基本技术。

# android - 使用 ArrayAdapter 强制关闭 ListView

> ID：13148386
> 
> 赞同：1
> 
> 时间：2012-10-30T22:19:37.247
> 
> 标签：android, listview, crash, android-2.2-froyo

我正在尝试使用以下代码使用预定义的字符串数组填充 ListView：

```
String[] schedule_names = getResources().getStringArray(R.array.test_schedules);

// Populate the ListView using the array of schedule names
ArrayList<String> als = new ArrayList<String>(Arrays.asList(schedule_names));
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.id.listView, als);

adapter.add("Test");

ListView listView = (ListView) findViewById(R.id.listView);
listView.setAdapter(adapter); 
```

但它强制关闭，除非我注释掉`listView.setAdapter(adapter);`（这显然意味着 ListView 根本没有填充）。原因似乎是一个`NullPointerException`。

为什么是这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:49:41.780

这条线是错误的...

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.id.listView, als); 
```

...构造函数的第二个参数不应该是你的`ListView`，它应该是一个布局`TextView`。

尝试替换`R.id.listView`为`android.R.layout.simple_list_item_1`

# iphone - UISearchDisplayController 和自定义单元格

> ID：13148389
> 
> 赞同：5
> 
> 时间：2012-10-30T22:19:39.990
> 
> 标签：iphone, objective-c, ios, xcode

我在 UITableViewController 中实现了一个 UISearchDisplayController。搜索工作正常，但 UISearhDisplayController 使用标准单元格创建了一个新的 tableView，而我的 tableView 正在使用自定义单元格。另一个问题是我使用了segue：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender { 
```

并且 searchResultsTableView 中的单元格没有触发 segue..

如何使用自定义单元格和 segue 显示搜索结果？

这是代码：

```
...

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
if (tableView == self.searchDisplayController.searchResultsTableView){ 
return [nameFilteredObj count];
} else {
return [sortedObj count];
}}

- (CustomCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"customCell";

CustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
cell = [[CustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
if (tableView == self.searchDisplayController.searchResultsTableView)
{
cell.textLabel.text = [[sortedObj objectAtIndex:indexPath.row] valueForKey:@"Name"];
 } else {
cell.nameLabel.text = [[sortedObj objectAtIndex:indexPath.row] valueForKey:@"Name"];
cell.countryLabel.text = [[sortedObj objectAtIndex:indexPath.row] valueForKey:@"Country"];
cell.bottleImageView.image = [UIImage imageNamed:[[sortedObj objectAtIndex:indexPath.row] valueForKey:@"Image"]];
} 
return cell; 
}

//The codes for filtering the results and update of searchResultsTableView (not necessary for this question I think):

- (void)filterContentForSearchText:(NSString*)searchText scope:(NSString*)scope
{
[nameFilteredObj removeAllObjects];

for(NSDictionary *obj in sortedObj)
{
NSString *objName = [obj objectForKey:@"Name"];
NSRange range = [objName rangeOfString:searchText options:NSCaseInsensitiveSearch];
if (range.location != NSNotFound) {
    [nameFilteredObj addObject:obj];
}}}

- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString
{
[self filterContentForSearchText:searchString scope:
 [[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:[self.searchDisplayController.searchBar selectedScopeButtonIndex]]];
return YES;}

- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchScope:(NSInteger)searchOption
{
[self filterContentForSearchText:[self.searchDisplayController.searchBar text] scope:
 [[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:searchOption]];
return NO;}
... 
```

我使用 Storyboard 作为界面。

* * *

## 回答 #1

> 赞同：-8
> 
> 时间：2012-11-04T20:48:31.613

实际上很容易做到，但我在途中发现了许多复杂的半工作解决方案。使用这个简单的部分，SearchResultsTableView 就消失了：

```
- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString
{
...
self.searchDisplayController.searchResultsTableView.hidden=YES;
return YES;
} 
```

# node.js - 如何在 Windows 上使用 Mongo 运行 Geddy？

> ID：13148391
> 
> 赞同：0
> 
> 时间：2012-10-30T22:20:00.303
> 
> 标签：node.js, mongodb, geddy

我对 Windows 下的 Geddy 和 Mongo 有一个奇怪的问题。我对 Node.js 和所有这些东西都是全新的，并尝试他们的示例应用程序，在 mongo 附加之前它很好。然后它在数据保存上抛出类似这样的东西：

```
c:\www\__node\wartex\node_modules\mongodb-wrapper\node_modules\mongodb\lib\mongo
db\connection\server.js:359
        throw err;
              ^
ReferenceError: model is not defined
    at utils.mixin.insert.insert (C:\Users\Alex\AppData\Roaming\npm\node_modules
\geddy\node_modules\model\lib\adapters\mongo\index.js:309:29)
    at utils.mixin.insert.insert (C:\Users\Alex\AppData\Roaming\npm\node_modules
\geddy\node_modules\model\lib\adapters\mongo\index.js:304:13)
    at exports.Collection.self.insert (c:\www\__node\wartex\node_modules\mongodb
-wrapper\lib\mongodb-wrapper.js:303:17)
    at insertAll (c:\www\__node\wartex\node_modules\mongodb-wrapper\node_modules
\mongodb\lib\mongodb\collection.js:315:12)
    at Collection.insert (c:\www\__node\wartex\node_modules\mongodb-wrapper\node
_modules\mongodb\lib\mongodb\collection.js:90:3)
    at exports.Collection.self.insert (c:\www\__node\wartex\node_modules\mongodb
-wrapper\lib\mongodb-wrapper.js:301:24)
    at exports.Collection.self.ensureIndex.cb (c:\www\__node\wartex\node_modules
\mongodb-wrapper\lib\mongodb-wrapper.js:201:17)
    at Db.collection (c:\www\__node\wartex\node_modules\mongodb-wrapper\node_mod
ules\mongodb\lib\mongodb\db.js:449:44)
    at EventEmitter.exports.Collection.self.ensureIndex.cb (c:\www\__node\wartex
\node_modules\mongodb-wrapper\lib\mongodb-wrapper.js:193:16)
    at EventEmitter.emit (events.js:99:17)
[Tue, 30 Oct 2012 22:05:21 GMT] ERROR Worker 10576 died. 
```

这不太酷。它在每次保存（创建或更新）时崩溃，但它仍然会创建数据，并且在重新运行 geddy 应用程序后可供读取。删除也可以。

这怎么可能解决？

* * *

另外，作为一个附带问题，也许它是一些更好的 node.js 框架，它有更好的文档和崩溃报告，并且不应该在每次意外错误后手动重新运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T06:26:37.027

看起来您是受最近模型错误影响的少数人之一。如果你重新安装 Geddy，你应该很高兴。

`$ npm install -g geddy`

另外，就您的附带问题而言，很抱歉您遇到了一些问题-您是否尝试过在 geddy 邮件列表上提问？如果你还没有看到 Geddy 的文档，你可以在这里查看它们：http: [//geddyjs.org/documentation](http://geddyjs.org/documentation)

如果您发现任何遗漏，请随时在 github 上打开一个问题。

# iphone - 创建一个 plist 文件 iOS 不工作

> ID：13148396
> 
> 赞同：0
> 
> 时间：2012-10-30T22:20:11.793
> 
> 标签：iphone, ios, plist

我正在尝试创建一个 plist 文件，稍后将在我的应用程序中写入该文件。在第一个 viewDidLoad 我调用以下方法

```
-(void)createFavoritesFile{
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSError *error;
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *documentDBFolderPath = [documentsDirectory stringByAppendingPathComponent:@"data.plist"];

    if (![fileManager fileExistsAtPath:documentDBFolderPath])
    {
        NSLog(@"file doesnt exist");
        NSString *resourceDBFolderPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"data.plist"];
        [fileManager copyItemAtPath:resourceDBFolderPath toPath:documentDBFolderPath error:&error];
    }
    else{
        NSLog(@"file exists");
    }
} 
```

但是，每次我运行应用程序时，我都找不到创建的文件，如果我关闭应用程序并重新打开，NSLog 会显示该文件不再存在。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:24:17.367

您忽略了来自`-copyItemAtPath:toPath:error:`. 我愿意打赌电话正在返回`NO`并填充一些错误。您应该检查它的返回值，如果它返回则打印出错误`NO`。

失败的一个可能原因是，由于某种原因，您实际上可能还没有 Documents 文件夹。您可以要求`NSFileManager`为您创建它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:27:16.750

打印您的资源路径并查看该文件是否存在其中。如果是这样，但不工作检查这个问题：[Working with paths from [[NSBundle mainBundle] resourcePath]](https://stackoverflow.com/questions/1949992/working-with-paths-from-nsbundle-mainbundle-resourcepath)

无论如何，如果你的资源在你的主包中，你总是可以使用：

```
- (NSString *)pathForResource:(NSString *)name ofType:(NSString *)extension 
```

# javascript - Javascript - 想要在滚动事件中跳转到新的 div

> ID：13148397
> 
> 赞同：-1
> 
> 时间：2012-10-30T22:20:12.417
> 
> 标签：javascript, jquery

我正在构建一个单页网站，其内容区域是堆叠在页面下方的大型内容框。

[http://salondoreen.com/lowercasemenu.html](http://salondoreen.com/lowercasemenu.html)

我正在寻找有关使用 javascript 跳转到每个内容框的方法的想法。对于像这样的单页网站，需要大量滚动才能到达底部。

我的想法是以某种方式使这更容易。如果您在一个框中，并且只需单击一下即可向下滚动，我希望下一个框可以一次跳转到页面上滚动。这样，内容就保持简单易读，并且盒子永远不会在页面上半开半开。理论上，您可以在不到十次点击中滚动到页面底部。

那有意义吗？我正在考虑类似于 android 手机上的主屏幕的东西。无论您轻扫多少屏幕，它都会在屏幕之间水平跳跃。页面上一次只会有一个框。

免责声明：我是一个菜鸟网络开发人员，感谢任何和所有帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:25:05.827

我会指出您使用[jquery .scroll()](http://api.jquery.com/scroll/)`scroll`绑定事件，并通过链接样式使用 ID 或使用[jquery.ScrollTo 插件](http://archive.plugins.jquery.com/project/ScrollTo)`http://myurl.com/derp#scrollhere`

# math - 计算相交三角形集的面积

> ID：13148403
> 
> 赞同：1
> 
> 时间：2012-10-30T22:20:35.267
> 
> 标签：math, geometry, area, scripting-language

给定两组三角形，其中每组中的三角形不重叠但可能共享 1 或 2 个点，计算两个三角形组相交的面积（图像中的紫色区域）的最佳方法是什么？

![相交三角形集](../Images/8c0687d3ab0949f26a0898c235454d02.png)

这是一个困难的问题还是微不足道的问题？是否有现有的库可以为我计算面积（最好使用 Python、Ruby 或 JavaScript 等脚本语言）？如果没有图书馆，它背后的数学原理是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T06:28:58.410

免费的[Clipper 库](http://www.angusj.com/delphi/clipper.php)值得一提。它相当快速和稳定。

有第三方 Perl、Ruby 和 Haskell 模块的链接（在分发包内）

# r - 在 ggplot2 图例中使用图像而不是标签

> ID：13148404
> 
> 赞同：15
> 
> 时间：2012-10-30T22:20:37.467
> 
> 标签：r, ggplot2, graphing

我在 ggplot2 中有一个情节，比如 2 行，在传说中我有“鲨鱼”和“老虎”。有没有办法让鲨鱼/老虎图像出现在图例中而不是文本中？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-10-30T22:54:02.110

您最好使用`ggsave`将图形保存为`eps`or `svg`，然后在 Illustrator（或开源等效项）中打开它并用图像替换图例。如果你真的不喜欢在 R 中做这一切，你可以`annotation_raster`在 current中使用`ggplot2`并在它旁边添加一些文本，使用`geom_text`. 这是一个粗略的尝试：

```
set.seed(10)
library(ggplot2) 
library(RCurl)
library(png)
df <- data.frame(animal = sample(c("sharks", "tigers"),20, rep=T), time=1:20, 
                 scariness = rnorm(20)*-20)

shark <- readPNG(getURLContent("http://i.imgur.com/EOc2V.png"))
tiger <- readPNG(getURLContent("http://i.imgur.com/zjIh5.png"))

ggplot(df, aes(time, scariness, group = animal, color = animal)) + 
geom_line(show_guide = FALSE) +
 annotation_raster(tiger, xmin = nrow(df)-1, xmax = nrow(df), 
    ymin = max(df$scariness)-(.05*max(df$scariness)), 
    ymax = max(df$scariness), interpolate = T) +
 annotation_raster(shark, xmin = nrow(df)-1, xmax = nrow(df), 
    ymin = max(df$scariness)-(.1*max(df$scariness)), 
    ymax = max(df$scariness)-(.05*max(df$scariness)), interpolate = T) 
```

![鲨鱼老虎可怕的数字](../Images/ba1508c7b9c0dfe2dcc93762adafd572.png)

# ms-access - 使用存储过程的查询表达式中的语法错误（缺少运算符）

> ID：13148405
> 
> 赞同：1
> 
> 时间：2012-10-30T22:20:37.720
> 
> 标签：ms-access, stored-procedures, asp-classic, vbscript, syntax-error

尝试从经典的 asp 页面运行存储过程时，我基本上遇到了这个错误，我看不出问题出在哪里。

我的日志文件中的错误是

```
72|80040e14|Syntax_error_(missing_operator)_in_query_expression_'1_'17470329'_#30/10/2012#_94' 
```

第 72 行的代码如下

```
rs.open "UpdateTransaction 1 '" & Request.Form("TXID") & "' #" & String2Date & "# " & Request.Form("pageID"), conn, adOpenStatic, adLockReadOnly, adCmdStoredProc 
```

第 72 行的字符串生成版本是：

`UpdateTransaction 1 '17470312' #30/10/2012# 93`

Access 中的存储过程是

```
UPDATE [TRANSACTIONS] SET Status = [param1], TransactionID = [param2], TransactionDate = [param3]
WHERE pageID = [param4]; 
```

表结构如下

```
Status : Number
TransactionID : Text
TransactionDate : Date
pageID : Number 
```

从我所见，我的参数和类型是正确的，但我只是看得太难看不出问题！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:38:24.530

试试这个。

```
UpdateTransaction 1, '17470312', #30/10/2012#, 93 
```

[http://www.codeproject.com/Articles/15222/How-to-Use-Stored-Procedures-in-VB6](http://www.codeproject.com/Articles/15222/How-to-Use-Stored-Procedures-in-VB6)

# ruby-on-rails - 由于产生了奇怪的查询，Solr 无法重新索引

> ID：13148407
> 
> 赞同：0
> 
> 时间：2012-10-30T22:20:45.563
> 
> 标签：ruby-on-rails, solr, sunspot

我正在编写一个使用 solr 进行全文搜索的 Rails 应用程序

在开发模式下，我使用了非常方便的 sunpost solr gem。我在开发中使用了 sqlite3 数据库，一切都很顺利。

现在是转移到生产服务器的时候了，我安装了 solr-tomcat 包并转移到了我的生产数据库，即 Mysql。我将 solr 的 conf 文件从我的应用程序文件夹移动到 /usr/share/solr/conf

突然，我无法重新索引，并且 solr 返回了这个

```
rake RAILS_ENV=production sunspot:solr:reindex
[#                                 ] [  50/7312] [  0.68%] [00:00] [00:41] [ 175.82/s]rake aborted!
Mysql::Error: Unknown column 'barangs.' in 'where clause': SELECT  `barangs`.* FROM `barangs`  WHERE (`barangs`.`` >= 0) ORDER BY `barangs`.`` ASC LIMIT 50 
```

很好奇，我尝试用开发数据库重新索引，一切都很好，可以重新索引。这种行为让我很困惑

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:34:09.680

我有问题。这是由于我鲁莽地删除和恢复表，它丢失了一些关系定义。

因此，表“barangs”上的“缺失”列。**MISSING** ' solr 找不到指定的列。

对于其他面临问题的人，我建议先检查模型之间的关系

# class - 忽略 jaxb schemagen 生成的类

> ID：13148411
> 
> 赞同：2
> 
> 时间：2012-10-30T22:20:57.077
> 
> 标签：class, jaxb, schemagen

我有两组课程。AI 组中的人想使用 schemagen 生成 XML 模式，而 BI 组中的人只是想忽略模式生成。我怎样才能做到这一点？我只注释了 groupA jaxb 相关的类。当尝试生成模式时，我得到组 B 的类的“没有无参数默认构造函数”。

# javascript - 谷歌地图 API 地理编码不返回结果

> ID：13148417
> 
> 赞同：0
> 
> 时间：2012-10-30T22:21:26.877
> 
> 标签：javascript, google-maps

我不确定为什么以下不起作用。它根本不进入 geocoder.geocode 段。我想要的只是能够接收我输入的地址的地理编码，而无需将其绘制在任何地图上。

```
var geocoder;
function codeAddress() {
var address = document.getElementById("address").value;
geocoder.geocode( { 'address': address}, function(results, status) {
  if (status == google.maps.GeocoderStatus.OK) {
    alert(results[0].geometry.location);

  } else {
    alert("Geocode was not successful for the following reason: " + status);
  }
}); 
```

}

html代码：

```
<div>
<input id="address" type="textbox" value="Sydney, NSW">
<input type="button" value="Encode" onclick="codeAddress()">
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T00:51:36.930

没有初始化地理编码器。地理编码器 = 新的 google.maps.Geocoder();

# wpf - 向应用程序用户提供受限权限的方法

> ID：13148419
> 
> 赞同：4
> 
> 时间：2012-10-30T22:21:39.557
> 
> 标签：wpf, desktop-application, privileges, user-accounts, restriction

我有一个在 WPF 中开发的桌面应用程序，它有几个视图显示为 Shell 的 MDI 子项。它不是以复合/模块化方法开发的。当应用程序打开时，所有视图都可以访问了。该应用程序有一个管理员用户和几个操作员。

要求是管理员用户将为操作员分配一些受限制的权限，这些权限将指定 -

1.  哪些操作员可以访问/打开哪些视图，以及
2.  哪些操作员可以在允许的视图中执行哪些操作

到目前为止，我的想法是——

1.  在数据库中存储操作员权限信息
2.  加载时，将当前登录用户的权限信息存储在某个应用程序级别
3.  对于Shell，在应用程序级别检查权限信息并根据信息将可见性绑定设置到不同的View-access按钮
4.  对于单个视图，在 ViewModel 级别检查权限信息并根据信息设置操作按钮的可见性绑定

有没有更好的方法来实现这种场景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:33:05.213

你的方法对我来说听起来很不错，除了隐藏几个 UI 元素（如按钮）之外，我还会在实际执行操作之前检查 ViewModel 层中的当前用户是否可以执行操作。

这意味着您`Commands`应该有一个`CanExecute()`通过您的权限验证逻辑并返回 true 或 false 的方法。这是一项重要的安全措施，IMO，因为 UIElements 可以在运行时使用 Snoop 等工具轻松更改。看看这个答案[如何窥探你的 wpf 应用程序？](https://stackoverflow.com/questions/3981959/how-to-snoop-proof-your-wpf-application)

# c - 什么时候应该在现代机器上使用预取？

> ID：13148420
> 
> 赞同：2
> 
> 时间：2012-10-30T22:21:42.053
> 
> 标签：c, performance, optimization, x86, avx

> **可能重复：**
> [预取示例？](https://stackoverflow.com/questions/7327994/prefetching-examples)

在许多情况下，预取指令似乎会降低现代机器的性能，因为通常有几个不同的硬件预取单元。

是否有任何特殊情况总是有助于使用预取指令？

# linux - 自旋锁真的需要 DMB 吗？

> ID：13148421
> 
> 赞同：6
> 
> 时间：2012-10-30T22:21:45.657
> 
> 标签：linux, synchronization, locking, arm, memory-barriers

我正在使用双 Cortex-A9 系统，我一直在尝试准确了解为什么自旋锁功能需要使用 DMB。似乎只要合并存储缓冲区被刷新，锁定值就应该在解锁核心的 L1 中结束，并且 SCU 应该使另一个核心的 L1 中的值无效或更新。这足以保持一致性和安全锁定对吗？STREX 不会跳过合并存储缓冲区，这意味着我们甚至不需要刷新吗？

DMB 似乎是一把钝锤，特别是因为它默认为系统域，这可能意味着一直写入主内存，这可能很昂贵。

锁中的 DMB 是否可以作为未正确使用 smp_mb 的驱动程序的解决方法？

根据性能计数器，我目前看到大约 5% 的系统周期在由 DMB 引起的停顿中消失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:59:12.597

在 SMP 情况下需要 DMB，因为如果没有它，其他处理器可能会看到内存访问以不同的顺序发生，即从临界区内部的访问可能发生在从第二个核心的角度获取锁之前.

因此，第二个核心可以看到自己持有锁，并且还可以看到来自关键部分内部的更新在另一个核心上运行，从而破坏了一致性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:09:07.643

我发现这些文章可能会回答你的问题：

*   [锁、SWP 和两个吸烟屏障](http://blogs.arm.com/software-enablement/169-locks-swps-and-two-smoking-barriers/)
*   [锁、SWP 和两个吸烟屏障（第 2 部分）](http://blogs.arm.com/software-enablement/188-locks-swps-and-two-smoking-barriers-part-2/)

尤其：

> 您会注意到一旦获得锁定就会发出数据存储器屏障 (DMB) 指令。DMB 保证在内存屏障之后的所有内存访问之前，系统中的所有其他 CPU 都将观察到内存屏障之前的所有内存访问。如果您考虑到一旦获得锁，程序就会访问被锁锁定的数据结构，这就更有意义了。上面lock函数中的DMB保证了对锁的访问，在访问锁之后，可以观察到对锁定的数据结构的访问。

# ruby-on-rails-3 - 创建失败后避免使用索引 url

> ID：13148425
> 
> 赞同：0
> 
> 时间：2012-10-30T22:22:30.307
> 
> 标签：ruby-on-rails-3, rails-routing

当您通过 create 操作在 rails 中创建用户时，url 更改为

```
http://myapplication.com/users with POST 
```

在被重定向到其他地方之前。如果验证失败，则似乎保留了上述 URL。如果然后刷新，您最终会进入索引页面（因为它现在是 GET）。

我希望如果验证失败，网址将保持为

```
http://myapplication.com/users/new 
```

由于我没有索引页面，这给我带来了问题。请问有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:04:53.190

这取决于`respond_to`控制器中块中的逻辑。

这是一个典型的*create*动作示例`users_controller.rb`：

```
 def create
   @user = User.new(params[:user])

   respond_to do |format|
     if @user.save
       format.html { redirect_to @user, notice: 'User was successfully created.' }
       format.json { render json: @user, status: :created, location: @user }
     else
       format.html { render action: "new" }
       format.json { render json: @user.errors, status: :unprocessable_entity }
     end
   end
 end 
```

因此，如果保存失败，`new`则再次呈现该操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T06:50:14.023

在您的 UsersController 中，执行以下操作：

```
def new
 @user =  User.new
end

def create
 @user = User.new(params[:user])

 if @user.save
   redirect_to root_url # save success will return to root page
 else
   render 'new'
 end
end 
```

# python - 如何更改 DataFrame 列的顺序？

> ID：13148429
> 
> 赞同：1304
> 
> 时间：2012-10-30T22:22:59.293
> 
> 标签：python, pandas, dataframe

我有以下`DataFrame`（`df`）：

```
import numpy as np
import pandas as pd

df = pd.DataFrame(np.random.rand(10, 5)) 
```

我通过分配添加更多列：

```
df['mean'] = df.mean(1) 
```

如何将列`mean`移到前面，即将其设置为第一列，而其他列的顺序保持不变？

* * *

## 回答 #1

> 赞同：1161
> 
> 时间：2012-10-30T22:38:49.910

一种简单的方法是使用列列表重新分配数据框，并根据需要重新排列。

这就是你现在所拥有的：

```
In [6]: df
Out[6]:
          0         1         2         3         4      mean
0  0.445598  0.173835  0.343415  0.682252  0.582616  0.445543
1  0.881592  0.696942  0.702232  0.696724  0.373551  0.670208
2  0.662527  0.955193  0.131016  0.609548  0.804694  0.632596
3  0.260919  0.783467  0.593433  0.033426  0.512019  0.436653
4  0.131842  0.799367  0.182828  0.683330  0.019485  0.363371
5  0.498784  0.873495  0.383811  0.699289  0.480447  0.587165
6  0.388771  0.395757  0.745237  0.628406  0.784473  0.588529
7  0.147986  0.459451  0.310961  0.706435  0.100914  0.345149
8  0.394947  0.863494  0.585030  0.565944  0.356561  0.553195
9  0.689260  0.865243  0.136481  0.386582  0.730399  0.561593

In [7]: cols = df.columns.tolist()

In [8]: cols
Out[8]: [0L, 1L, 2L, 3L, 4L, 'mean'] 
```

以您想要的任何方式重新排列`cols`。这就是我将最后一个元素移动到第一个位置的方式：

```
In [12]: cols = cols[-1:] + cols[:-1]

In [13]: cols
Out[13]: ['mean', 0L, 1L, 2L, 3L, 4L] 
```

然后像这样重新排序数据框：

```
In [16]: df = df[cols]  #    OR    df = df.ix[:, cols]

In [17]: df
Out[17]:
       mean         0         1         2         3         4
0  0.445543  0.445598  0.173835  0.343415  0.682252  0.582616
1  0.670208  0.881592  0.696942  0.702232  0.696724  0.373551
2  0.632596  0.662527  0.955193  0.131016  0.609548  0.804694
3  0.436653  0.260919  0.783467  0.593433  0.033426  0.512019
4  0.363371  0.131842  0.799367  0.182828  0.683330  0.019485
5  0.587165  0.498784  0.873495  0.383811  0.699289  0.480447
6  0.588529  0.388771  0.395757  0.745237  0.628406  0.784473
7  0.345149  0.147986  0.459451  0.310961  0.706435  0.100914
8  0.553195  0.394947  0.863494  0.585030  0.565944  0.356561
9  0.561593  0.689260  0.865243  0.136481  0.386582  0.730399 
```

* * *

## 回答 #2

> 赞同：693
> 
> 时间：2014-05-19T15:20:33.217

你也可以这样做：

```
df = df[['mean', '0', '1', '2', '3']] 
```

您可以通过以下方式获取列列表：

```
cols = list(df.columns.values) 
```

输出将产生：

```
['0', '1', '2', '3', 'mean'] 
```

...然后很容易在将其放入第一个函数之前手动重新排列

* * *

## 回答 #3

> 赞同：372
> 
> 时间：2015-04-28T14:19:49.323

只需按照您想要的顺序分配列名：

```
In [39]: df
Out[39]: 
          0         1         2         3         4  mean
0  0.172742  0.915661  0.043387  0.712833  0.190717     1
1  0.128186  0.424771  0.590779  0.771080  0.617472     1
2  0.125709  0.085894  0.989798  0.829491  0.155563     1
3  0.742578  0.104061  0.299708  0.616751  0.951802     1
4  0.721118  0.528156  0.421360  0.105886  0.322311     1
5  0.900878  0.082047  0.224656  0.195162  0.736652     1
6  0.897832  0.558108  0.318016  0.586563  0.507564     1
7  0.027178  0.375183  0.930248  0.921786  0.337060     1
8  0.763028  0.182905  0.931756  0.110675  0.423398     1
9  0.848996  0.310562  0.140873  0.304561  0.417808     1

In [40]: df = df[['mean', 4,3,2,1]] 
```

现在，“平均”列出现在前面：

```
In [41]: df
Out[41]: 
   mean         4         3         2         1
0     1  0.190717  0.712833  0.043387  0.915661
1     1  0.617472  0.771080  0.590779  0.424771
2     1  0.155563  0.829491  0.989798  0.085894
3     1  0.951802  0.616751  0.299708  0.104061
4     1  0.322311  0.105886  0.421360  0.528156
5     1  0.736652  0.195162  0.224656  0.082047
6     1  0.507564  0.586563  0.318016  0.558108
7     1  0.337060  0.921786  0.930248  0.375183
8     1  0.423398  0.110675  0.931756  0.182905
9     1  0.417808  0.304561  0.140873  0.310562 
```

* * *

## 回答 #4

> 赞同：215
> 
> 时间：2012-11-09T21:04:03.803

对于 pandas >= 1.3（2022 年编辑）：

```
df.insert(0, 'mean', df.pop('mean')) 
```

怎么样（对于 Pandas < 1.3，原始答案）

```
df.insert(0, 'mean', df['mean']) 
```

[https://pandas.pydata.org/pandas-docs/stable/user_guide/dsintro.html#column-selection-addition-deletion](https://pandas.pydata.org/pandas-docs/stable/user_guide/dsintro.html#column-selection-addition-deletion)

* * *

## 回答 #5

> 赞同：178
> 
> 时间：2016-08-30T21:57:36.780

在你的情况下，

```
df = df.reindex(columns=['mean',0,1,2,3,4]) 
```

会做你想做的事。

**就我而言（一般形式）：**

```
df = df.reindex(columns=sorted(df.columns))
df = df.reindex(columns=(['opened'] + list([a for a in df.columns if a != 'opened']) )) 
```

* * *

## 回答 #6

> 赞同：93
> 
> 时间：2019-11-09T06:24:12.290

```
import numpy as np
import pandas as pd
df = pd.DataFrame()
column_names = ['x','y','z','mean']
for col in column_names: 
    df[col] = np.random.randint(0,100, size=10000) 
```

您可以尝试以下解决方案：

**解决方案1：**

```
df = df[ ['mean'] + [ col for col in df.columns if col != 'mean' ] ] 
```

**解决方案2：**

* * *

```
df = df[['mean', 'x', 'y', 'z']] 
```

* * *

**解决方案3：**

```
col = df.pop("mean")
df = df.insert(0, col.name, col) 
```

* * *

**解决方案4：**

```
df.set_index(df.columns[-1], inplace=True)
df.reset_index(inplace=True) 
```

* * *

**解决方案 5：**

```
cols = list(df)
cols = [cols[-1]] + cols[:-1]
df = df[cols] 
```

* * *

**解决方案6：**

```
order = [1,2,3,0] # setting column's order
df = df[[df.columns[i] for i in order]] 
```

## 时间比较：

**解决方案1：**

> CPU 时间：用户 1.05 毫秒，系统：35 微秒，总计：1.08 毫秒 挂壁时间：995 微秒

**解决方案 2**：

> CPU 时间：用户 933 µs，系统：0 ns，总计：933 µs 挂壁时间：800 µs

**解决方案 3**：

> CPU 时间：用户 0 ns，sys：1.35 ms，总计：1.35 ms Wall time：1.08 ms

**解决方案 4**：

> CPU 时间：用户 1.23 毫秒，系统：45 微秒，总计：1.27 毫秒 挂壁时间：986 微秒

**解决方案 5**：

> CPU 时间：用户 1.09 毫秒，系统：19 微秒，总计：1.11 毫秒挂壁时间：949 微秒

**解决方案 6**：

> CPU 时间：用户 955 µs，系统：34 µs，总计：989 µs 挂壁时间：859 µs

* * *

## 回答 #7

> 赞同：80
> 
> 时间：2015-08-21T02:18:52.887

您需要按所需顺序创建一个新的列列表，然后使用`df = df[cols]`此新顺序重新排列列。

```
cols = ['mean']  + [col for col in df if col != 'mean']
df = df[cols] 
```

您还可以使用更通用的方法。在此示例中，最后一列（由 -1 表示）作为第一列插入。

```
cols = [df.columns[-1]] + [col for col in df if col != df.columns[-1]]
df = df[cols] 
```

如果 DataFrame 中存在列，您还可以使用此方法按所需顺序对列进行重新排序。

```
inserted_cols = ['a', 'b', 'c']
cols = ([col for col in inserted_cols if col in df] 
        + [col for col in df if col not in inserted_cols])
df = df[cols] 
```

* * *

## 回答 #8

> 赞同：63
> 
> 时间：2020-05-30T05:12:36.563

假设您有`df`with columns `A` `B` `C`。

最简单的方法是：

```
df = df.reindex(['B','C','A'], axis=1) 
```

* * *

## 回答 #9

> 赞同：58
> 
> 时间：2018-08-20T17:35:46.743

如果您的列名太长而无法键入，那么您可以通过具有位置的整数列表指定新顺序：

数据：

```
 0         1         2         3         4      mean
0  0.397312  0.361846  0.719802  0.575223  0.449205  0.500678
1  0.287256  0.522337  0.992154  0.584221  0.042739  0.485741
2  0.884812  0.464172  0.149296  0.167698  0.793634  0.491923
3  0.656891  0.500179  0.046006  0.862769  0.651065  0.543382
4  0.673702  0.223489  0.438760  0.468954  0.308509  0.422683
5  0.764020  0.093050  0.100932  0.572475  0.416471  0.389390
6  0.259181  0.248186  0.626101  0.556980  0.559413  0.449972
7  0.400591  0.075461  0.096072  0.308755  0.157078  0.207592
8  0.639745  0.368987  0.340573  0.997547  0.011892  0.471749
9  0.050582  0.714160  0.168839  0.899230  0.359690  0.438500 
```

通用示例：

```
new_order = [3,2,1,4,5,0]
print(df[df.columns[new_order]])  

          3         2         1         4      mean         0
0  0.575223  0.719802  0.361846  0.449205  0.500678  0.397312
1  0.584221  0.992154  0.522337  0.042739  0.485741  0.287256
2  0.167698  0.149296  0.464172  0.793634  0.491923  0.884812
3  0.862769  0.046006  0.500179  0.651065  0.543382  0.656891
4  0.468954  0.438760  0.223489  0.308509  0.422683  0.673702
5  0.572475  0.100932  0.093050  0.416471  0.389390  0.764020
6  0.556980  0.626101  0.248186  0.559413  0.449972  0.259181
7  0.308755  0.096072  0.075461  0.157078  0.207592  0.400591
8  0.997547  0.340573  0.368987  0.011892  0.471749  0.639745
9  0.899230  0.168839  0.714160  0.359690  0.438500  0.050582 
```

虽然看起来我只是以不同的顺序显式地输入列名，但有一个“平均值”列的事实应该清楚地表明它`new_order`与实际位置而不是列名有关。

对于OP问题的具体情况：

```
new_order = [-1,0,1,2,3,4]
df = df[df.columns[new_order]]
print(df)

       mean         0         1         2         3         4
0  0.500678  0.397312  0.361846  0.719802  0.575223  0.449205
1  0.485741  0.287256  0.522337  0.992154  0.584221  0.042739
2  0.491923  0.884812  0.464172  0.149296  0.167698  0.793634
3  0.543382  0.656891  0.500179  0.046006  0.862769  0.651065
4  0.422683  0.673702  0.223489  0.438760  0.468954  0.308509
5  0.389390  0.764020  0.093050  0.100932  0.572475  0.416471
6  0.449972  0.259181  0.248186  0.626101  0.556980  0.559413
7  0.207592  0.400591  0.075461  0.096072  0.308755  0.157078
8  0.471749  0.639745  0.368987  0.340573  0.997547  0.011892
9  0.438500  0.050582  0.714160  0.168839  0.899230  0.359690 
```

这种方法的主要问题是多次调用相同的代码每次都会产生不同的结果，所以需要小心:)

* * *

## 回答 #10

> 赞同：48
> 
> 时间：2013-01-04T06:04:46.777

这个问题之前已经回答[过，](https://stackoverflow.com/questions/11067027/python-pandas-re-ordering-columns-in-a-dataframe-based-on-column-name)但`reindex_axis`现在已弃用，所以我建议使用：

```
df = df.reindex(sorted(df.columns), axis=1) 
```

对于那些想要指定他们想要的顺序而不是仅仅对它们进行排序的人，这里给出了解决方案：

```
df = df.reindex(['the','order','you','want'], axis=1) 
```

现在，您想如何对列名列表进行排序实际上不是一个`pandas`问题，这是一个 Python 列表操作问题。有很多方法可以做到这一点，我认为[这个答案](https://stackoverflow.com/a/51935892/1479269)有一种非常简洁的方法。

* * *

## 回答 #11

> 赞同：27
> 
> 时间：2019-11-05T16:33:40.967

我认为这是一个稍微整洁的解决方案：

```
df.insert(0, 'mean', df.pop("mean")) 
```

这个解决方案有点类似于@JoeHeffer 的解决方案，但这是一个衬里。

在这里，我们从数据框中删除列`"mean"`并将其附加到`0`具有相同列名的索引。

* * *

## 回答 #12

> 赞同：21
> 
> 时间：2014-08-27T19:49:31.997

我自己也遇到了类似的问题，只是想补充一下我确定的内容。我喜欢`reindex_axis() method`更改列顺序。这有效：

```
df = df.reindex_axis(['mean'] + list(df.columns[:-1]), axis=1) 
```

基于@Jorge 评论的替代方法：

```
df = df.reindex(columns=['mean'] + list(df.columns[:-1])) 
```

虽然`reindex_axis`在微基准测试中似乎比 略快`reindex`，但我认为我更喜欢后者，因为它的直接性。

* * *

## 回答 #13

> 赞同：19
> 
> 时间：2014-07-29T19:30:18.293

此功能避免了您必须列出数据集中的每个变量来订购其中的几个。

```
def order(frame,var):
    if type(var) is str:
        var = [var] #let the command take a string or list
    varlist =[w for w in frame.columns if w not in var]
    frame = frame[var+varlist]
    return frame 
```

它有两个参数，第一个是数据集，第二个是数据集中要放在前面的列。

所以在我的例子中，我有一个名为 Frame 的数据集，其中包含变量 A1、A2、B1、B2、Total 和 Date。如果我想把 Total 带到前面，那么我所要做的就是：

```
frame = order(frame,['Total']) 
```

如果我想把 Total 和 Date 放在前面，那么我会这样做：

```
frame = order(frame,['Total','Date']) 
```

编辑：

另一个有用的使用方法是，如果您有一个不熟悉的表，并且您正在查看其中包含特定术语的变量，例如 VAR1、VAR2...，您可以执行以下操作：

```
frame = order(frame,[v for v in frame.columns if "VAR" in v]) 
```

* * *

## 回答 #14

> 赞同：18
> 
> 时间：2021-04-13T13:36:15.773

您可以使用名称列表重新排序数据框列：

`df = df.filter(list_of_col_names)`

* * *

## 回答 #15

> 赞同：17
> 
> 时间：2015-04-28T09:50:19.167

简单地做，

```
df = df[['mean'] + df.columns[:-1].tolist()] 
```

* * *

## 回答 #16

> 赞同：13
> 
> 时间：2018-01-04T13:25:54.617

这是一种移动现有列的方法，该列将修改现有数据框。

```
my_column = df.pop('column name')
df.insert(3, my_column.name, my_column)  # Is in-place 
```

* * *

## 回答 #17

> 赞同：12
> 
> 时间：2016-12-08T15:22:39.870

您可以执行以下操作（从 Aman 的答案中借用部分内容）：

```
cols = df.columns.tolist()
cols.insert(0, cols.pop(-1))

cols
>>>['mean', 0L, 1L, 2L, 3L, 4L]

df = df[cols] 
```

* * *

## 回答 #18

> 赞同：10
> 
> 时间：2018-02-27T14:05:01.220

将任意列移动到任意位置：

```
import pandas as pd
df = pd.DataFrame({"A": [1,2,3], 
                   "B": [2,4,8], 
                   "C": [5,5,5]})

cols = df.columns.tolist()
column_to_move = "C"
new_position = 1

cols.insert(new_position, cols.pop(cols.index(column_to_move)))
df = df[cols] 
```

* * *

## 回答 #19

> 赞同：10
> 
> 时间：2016-05-06T11:39:33.950

只需键入要更改的列名，然后为新位置设置索引。

```
def change_column_order(df, col_name, index):
    cols = df.columns.tolist()
    cols.remove(col_name)
    cols.insert(index, col_name)
    return df[cols] 
```

对于您的情况，这将是：

```
df = change_column_order(df, 'mean', 0) 
```

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2017-07-27T09:21:39.810

我想从我不确切知道所有列的名称的数据框中将两列放在前面，因为它们是从之前的数据透视语句生成的。因此，如果您处于相同的情况：要将知道名称的列放在前面，然后让它们跟在“所有其他列”之后，我想出了以下通用解决方案：

```
df = df.reindex_axis(['Col1','Col2'] + list(df.columns.drop(['Col1','Col2'])), axis=1) 
```

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2020-06-18T19:30:21.213

### 这是一个非常简单的答案（只有一行）。

您可以在将“n”列添加到 df 后执行此操作，如下所示。

```
import numpy as np
import pandas as pd

df = pd.DataFrame(np.random.rand(10, 5))
df['mean'] = df.mean(1)
df
           0           1           2           3           4        mean
0   0.929616    0.316376    0.183919    0.204560    0.567725    0.440439
1   0.595545    0.964515    0.653177    0.748907    0.653570    0.723143
2   0.747715    0.961307    0.008388    0.106444    0.298704    0.424512
3   0.656411    0.809813    0.872176    0.964648    0.723685    0.805347
4   0.642475    0.717454    0.467599    0.325585    0.439645    0.518551
5   0.729689    0.994015    0.676874    0.790823    0.170914    0.672463
6   0.026849    0.800370    0.903723    0.024676    0.491747    0.449473
7   0.526255    0.596366    0.051958    0.895090    0.728266    0.559587
8   0.818350    0.500223    0.810189    0.095969    0.218950    0.488736
9   0.258719    0.468106    0.459373    0.709510    0.178053    0.414752

### here you can add below line and it should work 
# Don't forget the two (()) 'brackets' around columns names.Otherwise, it'll give you an error.

df = df[list(('mean',0, 1, 2,3,4))]
df

        mean           0           1           2           3           4
0   0.440439    0.929616    0.316376    0.183919    0.204560    0.567725
1   0.723143    0.595545    0.964515    0.653177    0.748907    0.653570
2   0.424512    0.747715    0.961307    0.008388    0.106444    0.298704
3   0.805347    0.656411    0.809813    0.872176    0.964648    0.723685
4   0.518551    0.642475    0.717454    0.467599    0.325585    0.439645
5   0.672463    0.729689    0.994015    0.676874    0.790823    0.170914
6   0.449473    0.026849    0.800370    0.903723    0.024676    0.491747
7   0.559587    0.526255    0.596366    0.051958    0.895090    0.728266
8   0.488736    0.818350    0.500223    0.810189    0.095969    0.218950
9   0.414752    0.258719    0.468106    0.459373    0.709510    0.178053 
```

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2020-07-04T10:19:40.690

您可以使用一组*独特元素的无序集合*来保持“其他列的顺序不变”：

```
other_columns = list(set(df.columns).difference(["mean"])) #[0, 1, 2, 3, 4] 
```

然后，您可以使用 lambda 通过以下方式将特定列移到前面：

```
In [1]: import numpy as np                                                                               

In [2]: import pandas as pd                                                                              

In [3]: df = pd.DataFrame(np.random.rand(10, 5))                                                         

In [4]: df["mean"] = df.mean(1)                                                                          

In [5]: move_col_to_front = lambda df, col: df[[col]+list(set(df.columns).difference([col]))]            

In [6]: move_col_to_front(df, "mean")                                                                    
Out[6]: 
       mean         0         1         2         3         4
0  0.697253  0.600377  0.464852  0.938360  0.945293  0.537384
1  0.609213  0.703387  0.096176  0.971407  0.955666  0.319429
2  0.561261  0.791842  0.302573  0.662365  0.728368  0.321158
3  0.518720  0.710443  0.504060  0.663423  0.208756  0.506916
4  0.616316  0.665932  0.794385  0.163000  0.664265  0.793995
5  0.519757  0.585462  0.653995  0.338893  0.714782  0.305654
6  0.532584  0.434472  0.283501  0.633156  0.317520  0.994271
7  0.640571  0.732680  0.187151  0.937983  0.921097  0.423945
8  0.562447  0.790987  0.200080  0.317812  0.641340  0.862018
9  0.563092  0.811533  0.662709  0.396048  0.596528  0.348642

In [7]: move_col_to_front(df, 2)                                                                         
Out[7]: 
          2         0         1         3         4      mean
0  0.938360  0.600377  0.464852  0.945293  0.537384  0.697253
1  0.971407  0.703387  0.096176  0.955666  0.319429  0.609213
2  0.662365  0.791842  0.302573  0.728368  0.321158  0.561261
3  0.663423  0.710443  0.504060  0.208756  0.506916  0.518720
4  0.163000  0.665932  0.794385  0.664265  0.793995  0.616316
5  0.338893  0.585462  0.653995  0.714782  0.305654  0.519757
6  0.633156  0.434472  0.283501  0.317520  0.994271  0.532584
7  0.937983  0.732680  0.187151  0.921097  0.423945  0.640571
8  0.317812  0.790987  0.200080  0.641340  0.862018  0.562447
9  0.396048  0.811533  0.662709  0.596528  0.348642  0.563092 
```

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2020-04-10T11:39:16.690

只是翻转经常有帮助。

```
df[df.columns[::-1]] 
```

或者只是洗牌看看。

```
import random
cols = list(df.columns)
random.shuffle(cols)
df[cols] 
```

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2020-05-08T15:42:13.477

A pretty straightforward solution that worked for me is to use `.reindex` on `df.columns`:

```
df = df[df.columns.reindex(['mean', 0, 1, 2, 3, 4])[0]] 
```

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2017-12-18T15:24:07.760

您可以使用`reindex`which 可用于两个轴：

```
df
#           0         1         2         3         4      mean
# 0  0.943825  0.202490  0.071908  0.452985  0.678397  0.469921
# 1  0.745569  0.103029  0.268984  0.663710  0.037813  0.363821
# 2  0.693016  0.621525  0.031589  0.956703  0.118434  0.484254
# 3  0.284922  0.527293  0.791596  0.243768  0.629102  0.495336
# 4  0.354870  0.113014  0.326395  0.656415  0.172445  0.324628
# 5  0.815584  0.532382  0.195437  0.829670  0.019001  0.478415
# 6  0.944587  0.068690  0.811771  0.006846  0.698785  0.506136
# 7  0.595077  0.437571  0.023520  0.772187  0.862554  0.538182
# 8  0.700771  0.413958  0.097996  0.355228  0.656919  0.444974
# 9  0.263138  0.906283  0.121386  0.624336  0.859904  0.555009

df.reindex(['mean', *range(5)], axis=1)

#        mean         0         1         2         3         4
# 0  0.469921  0.943825  0.202490  0.071908  0.452985  0.678397
# 1  0.363821  0.745569  0.103029  0.268984  0.663710  0.037813
# 2  0.484254  0.693016  0.621525  0.031589  0.956703  0.118434
# 3  0.495336  0.284922  0.527293  0.791596  0.243768  0.629102
# 4  0.324628  0.354870  0.113014  0.326395  0.656415  0.172445
# 5  0.478415  0.815584  0.532382  0.195437  0.829670  0.019001
# 6  0.506136  0.944587  0.068690  0.811771  0.006846  0.698785
# 7  0.538182  0.595077  0.437571  0.023520  0.772187  0.862554
# 8  0.444974  0.700771  0.413958  0.097996  0.355228  0.656919
# 9  0.555009  0.263138  0.906283  0.121386  0.624336  0.859904 
```

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2019-04-11T17:58:48.893

书中最黑客的方法

```
df.insert(0, "test", df["mean"])
df = df.drop(columns=["mean"]).rename(columns={"test": "mean"}) 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2017-09-12T02:06:24.057

一种简单的方法是使用**`set()`**，特别是当您有很长的列列表并且不想手动处理它们时：

```
cols = list(set(df.columns.tolist()) - set(['mean']))
cols.insert(0, 'mean')
df = df[cols] 
```

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2016-06-26T23:46:28.867

怎么用`T`？

```
df = df.T.reindex(['mean', 0, 1, 2, 3, 4]).T 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2015-03-22T14:43:03.000

如果您知道另一列的位置，我相信[@Aman 的答案是最好的。](https://stackoverflow.com/a/13148611/1082349)

如果你不知道它的位置`mean`，而只有它的名字，你不能直接求助于`cols = cols[-1:] + cols[:-1]`。以下是我能想到的下一个最好的事情：

```
meanDf = pd.DataFrame(df.pop('mean'))
# now df doesn't contain "mean" anymore. Order of join will move it to left or right:
meanDf.join(df) # has mean as first column
df.join(meanDf) # has mean as last column 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2019-10-25T20:08:02.050

大多数答案都不够概括，pandas reindex_axis 方法有点乏味，因此我提供了一个简单的函数，可以使用字典将任意数量的列移动到任何位置，其中键 = 列名，值 = 要移动到的位置。如果您的数据框很大，则将 True 传递给“big_data”，则该函数将返回有序列列表。你可以使用这个列表来分割你的数据。

```
def order_column(df, columns, big_data = False):

    """Re-Orders dataFrame column(s)
       Parameters : 
       df      -- dataframe
       columns -- a dictionary:
                  key   = current column position/index or column name
                  value = position to move it to  
       big_data -- boolean 
                  True = returns only the ordered columns as a list
                          the user user can then slice the data using this
                          ordered column
                  False = default - return a copy of the dataframe
    """
    ordered_col = df.columns.tolist()

    for key, value in columns.items():

        ordered_col.remove(key)
        ordered_col.insert(value, key)

    if big_data:

        return ordered_col

    return df[ordered_col]

# e.g.
df = pd.DataFrame({'chicken wings': np.random.rand(10, 1).flatten(), 'taco': np.random.rand(10,1).flatten(),
                          'coffee': np.random.rand(10, 1).flatten()})
df['mean'] = df.mean(1)

df = order_column(df, {'mean': 0, 'coffee':1 })

>>> 
```

[![输出](../Images/9cec636fbf433922d5be8d7a73a2b2ac.png)](https://i.stack.imgur.com/uqZWm.png)

```
col = order_column(df, {'mean': 0, 'coffee':1 }, True)

col
>>>
['mean', 'coffee', 'chicken wings', 'taco']

# you could grab it by doing this

df = df[col] 
```

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2017-12-09T04:14:45.383

我喜欢[Shoresh 的回答](https://stackoverflow.com/a/46166838/9075180)，即在您不知道位置时使用 set 功能删除列，但这对我的目的不起作用，因为我需要保持原始列顺序（具有任意列标签）。

我通过使用[boltons](http://boltons.readthedocs.io/en/latest/setutils.html#)包中的 IndexedSet 来实现这一点。

我还需要重新添加多个列标签，因此对于更一般的情况，我使用了以下代码：

```
from boltons.setutils import IndexedSet
cols = list(IndexedSet(df.columns.tolist()) - set(['mean', 'std']))
cols[0:0] =['mean', 'std']
df = df[cols] 
```

希望这对任何在此线程中搜索通用解决方案的人有用。

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2018-01-29T18:57:18.680

这是一个对任意数量的列执行此操作的函数。

```
def mean_first(df):
    ncols = df.shape[1]        # Get the number of columns
    index = list(range(ncols)) # Create an index to reorder the columns
    index.insert(0,ncols)      # This puts the last column at the front
    return(df.assign(mean=df.mean(1)).iloc[:,index]) # new df with last column (mean) first 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2021-03-26T14:10:47.200

与最佳答案类似，还有一种使用 deque() 及其 rotate() 方法的替代方法。rotate 方法获取列表中的最后一个元素并将其插入到开头：

```
from collections import deque

columns = deque(df.columns.tolist())
columns.rotate()

df = df[columns] 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2021-11-06T04:42:23.123

这是一个超级简单的方法示例。如果您要从 excel 中复制标题，请使用`.split('\t')`

```
df = df['FILE_NAME DISPLAY_PATH SHAREPOINT_PATH RETAILER LAST_UPDATE'.split()] 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2020-03-26T16:32:57.120

我认为这个功能更简单。您只需要在开头或结尾或两者都指定列的子集：

```
def reorder_df_columns(df, start=None, end=None):
    """
        This function reorder columns of a DataFrame.
        It takes columns given in the list `start` and move them to the left.
        Its also takes columns in `end` and move them to the right.
    """
    if start is None:
        start = []
    if end is None:
        end = []
    assert isinstance(start, list) and isinstance(end, list)
    cols = list(df.columns)
    for c in start:
        if c not in cols:
            start.remove(c)
    for c in end:
        if c not in cols or c in start:
            end.remove(c)
    for c in start + end:
        cols.remove(c)
    cols = start + cols + end
    return df[cols] 
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2021-12-08T14:05:16.537

排序并不能确保保留正确的顺序。通过将 ['mean'] 与列列表连接起来。

```
cols_list = ['mean'] + df.columns.tolist()
df['mean'] = df.mean(1)
df = df[cols_list] 
```

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2019-12-11T23:42:04.333

我有一个非常具体的用例，用于在 pandas 中重新排序列名。有时我会在基于现有列的数据框中创建一个新列。默认情况下，pandas 将在末尾插入我的新列，但我希望将新列插入到它派生的现有列旁边。

[![在此处输入图像描述](../Images/ac14a4c90ffa623682031a12df060ab8.png)](https://i.stack.imgur.com/EenQB.png)

```
def rearrange_list(input_list, input_item_to_move, input_item_insert_here):
    '''
    Helper function to re-arrange the order of items in a list.
    Useful for moving column in pandas dataframe.

    Inputs:
        input_list - list
        input_item_to_move - item in list to move
        input_item_insert_here - item in list, insert before 

    returns:
        output_list
    '''
    # make copy for output, make sure it's a list
    output_list = list(input_list)

    # index of item to move
    idx_move = output_list.index(input_item_to_move)

    # pop off the item to move
    itm_move = output_list.pop(idx_move)

    # index of item to insert here
    idx_insert = output_list.index(input_item_insert_here)

    # insert item to move into here
    output_list.insert(idx_insert, itm_move)

    return output_list

import pandas as pd

# step 1: create sample dataframe
df = pd.DataFrame({
    'motorcycle': ['motorcycle1', 'motorcycle2', 'motorcycle3'],
    'initial_odometer': [101, 500, 322],
    'final_odometer': [201, 515, 463],
    'other_col_1': ['blah', 'blah', 'blah'],
    'other_col_2': ['blah', 'blah', 'blah']
})
print('Step 1: create sample dataframe')
display(df)
print()

# step 2: add new column that is difference between final and initial
df['change_odometer'] = df['final_odometer']-df['initial_odometer']
print('Step 2: add new column')
display(df)
print()

# step 3: rearrange columns
ls_cols = df.columns
ls_cols = rearrange_list(ls_cols, 'change_odometer', 'final_odometer')
df=df[ls_cols]
print('Step 3: rearrange columns')
display(df) 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2020-12-10T16:32:44.087

根据名称设置另一个现有列的右/左：

```
def df_move_column(df, col_to_move, col_left_of_destiny="", right_of_col_bool=True):
    cols = list(df.columns.values)
    index_max = len(cols) - 1

    if not right_of_col_bool:
        # set left of a column "c", is like putting right of column previous to "c"
        # ... except if left of 1st column, then recursive call to set rest right to it
        aux = cols.index(col_left_of_destiny)
        if not aux:
            for g in [x for x in cols[::-1] if x != col_to_move]:
                df = df_move_column(
                        df, 
                        col_to_move=g, 
                        col_left_of_destiny=col_to_move
                        )
            return df
        col_left_of_destiny = cols[aux - 1]

    index_old = cols.index(col_to_move)
    index_new = 0
    if len(col_left_of_destiny):
        index_new = cols.index(col_left_of_destiny) + 1

    if index_old == index_new:
        return df

    if index_new < index_old:
        index_new = np.min([index_new, index_max])
        cols = (
            cols[:index_new]
            + [cols[index_old]]
            + cols[index_new:index_old]
            + cols[index_old + 1 :]
        )
    else:
        cols = (
            cols[:index_old]
            + cols[index_old + 1 : index_new]
            + [cols[index_old]]
            + cols[index_new:]
        )

    df = df[cols]
    return df 
```

例如

```
cols = list("ABCD")
df2 = pd.DataFrame(np.arange(4)[np.newaxis, :], columns=cols)
for k in cols:
    print(30 * "-")
    for g in [x for x in cols if x != k]:
        df_new = df_move_column(df2, k, g)
        print(f"{k} after {g}:  {df_new.columns.values}")
for k in cols:
    print(30 * "-")
    for g in [x for x in cols if x != k]:
        df_new = df_move_column(df2, k, g, right_of_col_bool=False)
        print(f"{k} before {g}:  {df_new.columns.values}") 
```

输出：

[![在此处输入图像描述](../Images/8e620c5a81fe55a2bd65c756daa858c0.png)](https://i.stack.imgur.com/LieHi.png)

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2021-08-15T22:41:00.890

另一种选择是使用[`set_index()`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.set_index.html)方法后跟一个[`reset_index()`](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.reset_index.html). 请注意，我们首先`pop()`要将我们打算移动到数据框前面的列，以便在重置索引时避免名称冲突：

```
df.set_index(df.pop('column_name'), inplace=True)
df.reset_index(inplace=True) 
```

* * *

有关更多详细信息，请参阅[如何更改 pandas 中数据框列的顺序](https://towardsdatascience.com/how-to-change-the-order-of-dataframe-columns-in-pandas-c91370326053)。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2021-05-05T09:49:51.010

我想到的和 Dmitriy Work 一样，显然是最简单的答案：

```
df["mean"] = df.mean(1)
l =  list(np.arange(0,len(df.columns) -1 ))
l.insert(0,-1)
df.iloc[:,l] 
```

* * *

## 回答 #41

> 赞同：-1
> 
> 时间：2017-08-23T12:12:57.013

`DataFrame.sort_index(axis=1)`很干净。[在这里查看文档](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.sort_index.html)。接着`concat`

* * *

## 回答 #42

> 赞同：-1
> 
> 时间：2021-07-21T05:07:43.337

我尝试制作一个订单功能，您可以参考 Stata 的订单命令重新排序/移动列。最好是制作一个py文件（其名称可能是order.py）并将其保存在一个目录中并调用它的函数

```
def order(dataframe,cols,f_or_l=None,before=None, after=None):

#만든이: 김완석, Stata로 뚝딱뚝딱 저자, blog.naver.com/sanzo213 운영
# 갖다 쓰시거나 수정을 하셔도 되지만 출처는 꼭 밝혀주세요
# cols옵션 및 befor/after옵션에 튜플이 가능하게끔 수정했으며, 오류문구 수정함(2021.07.12,1)
# 칼럼이 멀티인덱스인 상태에서 reset_index()메소드 사용했을 시 적용안되는 걸 수정함(2021.07.12,2) 

import pandas as pd
if (type(cols)==str) or (type(cols)==int) or (type(cols)==float) or (type(cols)==bool) or type(cols)==tuple:    
    cols=[cols]

dd=list(dataframe.columns)
for i in cols:
    i
    dd.remove(i) #cols요소를 제거함

if (f_or_l==None) & ((before==None) & (after==None)):
    print('f_or_l옵션을 쓰시거나 아니면 before옵션/after옵션 쓰셔야되요')

if ((f_or_l=='first') or (f_or_l=='last')) & ~((before==None) & (after==None)):
    print('f_or_l옵션 사용시 before after 옵션 사용불가입니다.')

if (f_or_l=='first') & (before==None) & (after==None):
    new_order=cols+dd
    dataframe=dataframe[new_order]
    return dataframe

if (f_or_l=='last') & (before==None) & (after==None):   
    new_order=dd+cols
    dataframe=dataframe[new_order]
    return dataframe

if (before!=None) & (after!=None):
    print('before옵션 after옵션 둘다 쓸 수 없습니다.')

if (before!=None) & (after==None) & (f_or_l==None):

    if not((type(before)==str) or (type(before)==int) or (type(before)==float) or
       (type(before)==bool) or ((type(before)!=list)) or 
       ((type(before)==tuple))):
        print('before옵션은 칼럼 하나만 입력가능하며 리스트 형태로도 입력하지 마세요.')

    else:
        b=dd[:dd.index(before)]
        a=dd[dd.index(before):]

        new_order=b+cols+a
        dataframe=dataframe[new_order]  
        return dataframe

if (after!=None) & (before==None) & (f_or_l==None):

    if not((type(after)==str) or (type(after)==int) or (type(after)==float) or
       (type(after)==bool) or ((type(after)!=list)) or 
       ((type(after)==tuple))):

        print('after옵션은 칼럼 하나만 입력가능하며 리스트 형태로도 입력하지 마세요.')  

    else:
        b=dd[:dd.index(after)+1]
        a=dd[dd.index(after)+1:]

        new_order=b+cols+a
        dataframe=dataframe[new_order]
        return dataframe 
```

下面的python代码是我制作的订单函数的一个例子。我希望您可以使用我的排序功能轻松地重新排序列:)

```
# module

import pandas as pd
import numpy as np
from order import order # call order function from order.py file

# make a dataset

columns='a b c d e f g h i j k'.split()
dic={}

n=-1
for i in columns:

    n+=1
    dic[i]=list(range(1+n,10+1+n))
data=pd.DataFrame(dic)
print(data)

# use order function (1) : order column e in the first

data2=order(data,'e',f_or_l='first')
print(data2)

# use order function (2): order column e in the last , "data" dataframe

print(order(data,'e',f_or_l='last'))

# use order function (3) : order column i before column c in "data" dataframe

print(order(data,'i',before='c'))

# use order function (4) : order column g after column b in "data" dataframe

print(order(data,'g',after='b'))

# use order function (4) : order columns ['c', 'd', 'e'] after column i in "data" dataframe

print(order(data,['c', 'd', 'e'],after='i')) 
```

# javascript - 如果我在将页面发送到服务器后立即重新加载或关闭页面，是否会完成异步 Ajax 请求？

> ID：13148431
> 
> 赞同：1
> 
> 时间：2012-10-30T22:23:23.020
> 
> 标签：javascript, jquery, ajax, asynchronous

例如，如果我使用 jQuery 的 Ajax 执行此请求：

```
$(document).ready(function() {
    $('#some_button').click(function() {
        $.ajax({
            url: '/some/request',
            type: 'POST',
            data: [{my: 'dummy', data: 'lata'}],
            dataType: 'json',
            async: true,
        });

        window.location.href = '/my/parent/location';
    });
}); 
```

所以我很感兴趣：

> **如果我在发送初始请求后立即刷新页面，我的操作是否会在服务器上完成？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:32:39.183

Ajax 是同步的。所以无论请求如何，它都会立即重定向。

您可以在您的**成功回调**中调用它`Ajax Request`而不是..

```
$(document).ready(function() {
    $('#some_button').click(function() {
        $.ajax({
            url: '/some/request',
            type: 'POST',
            data: {my: 'dummy', data: 'lata'},
            dataType: 'json',
            success : function() {
                window.location.href = '/my/parent/location';
            }
        });

    });
}); 
```

# java - 错误：在 Android 中找不到源

> ID：13148434
> 
> 赞同：0
> 
> 时间：2012-10-30T22:23:36.947
> 
> 标签：java, android, eclipse, debugging

我正在开发一个我最初使用 API 14 编译的 android 应用程序，现在我正在将 API 版本更新到最新版本。当我调试代码时，我得到了错误`"Source not found"`。我正在使用 Eclipse 经典并在 Windows 7 上进行开发。我进行了很多搜索，但没有找到好的解决方案，因此我可以摆脱这个问题。请帮助我或指导我如何使用 Windows 7 下载正确的源代码。我已经浏览了不同的链接，例如[android.opensourceror.org](http://android.opensourceror.org/2010/01/18/android-source/) ，但它已经过时了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:30:59.430

您可以从 Android SDK 管理器附加 android 源代码。只需检查选项`Source for Android SDK`选项或将此插件用于 Eclipse [adt-addons](http://code.google.com/p/adt-addons/)

![在此处输入图像描述](../Images/cb84e568e85c18f23a8f96b3139b4290.png)

# android - 在 SQLite Android 中删除具有多个 WHERE 的行

> ID：13148436
> 
> 赞同：3
> 
> 时间：2012-10-30T22:23:44.610
> 
> 标签：android, sqlite, where, delete-row

这是删除具有多个 WHERE 参数的行的正确方法吗？我正在努力使其对数据库查询尽可能安全。

```
db.delete(TABLE, NAME + "=? and " + ID + "=? and " + ARG3 + "=?", new String[] { myName, x, argument3 }); 
```

ID是整数也可以吗？我还可以在里面使用它`String[]`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:40:10.550

你的方法看起来不错。

* * *

> ID是整数也可以吗？我仍然可以在 String[] 中使用它吗？

您的编译器是回答这个问题的最佳方式。

但是，如果`x`（例如）是一个整数，您可以使用以下任何一种：

```
new String[] { x + "" };
new String[] { String.valueOf(x) }; 
```

如果您担心`ID`in`"=? and " + ID + "=? and "`会给您一个错误，请不要担心它不会。

# django - 使用 Django 模型表单上传图像

> ID：13148437
> 
> 赞同：5
> 
> 时间：2012-10-30T22:23:59.043
> 
> 标签：django, django-models, django-forms, django-file-upload

我在使用模型表单上传以下模型时遇到困难。我可以在管理员中正常上传，但这对于限制管理员访问的项目来说并不是那么有用。

```
#Models.py
class Profile(models.Model):
    name = models.CharField(max_length=128)
    user = models.ForeignKey(User)
    profile_pic = models.ImageField(upload_to='img/profile/%Y/%m/')

#views.py
def create_profile(request):
    try: 
        profile = Profile.objects.get(user=request.user)
    except:
        pass
    form = CreateProfileForm(request.POST or None, instance=profile)

    if form.is_valid():
       new = form.save(commit=False)
       new.user = request.user
       new.save()

return render_to_response('profile.html', locals(), context_instance=RequestContext(request))

#Profile.html
<form enctype="multipart/form-data" method="post">{% csrf_token %}
<tr><td>{{ form.as_p }}</td></tr>
<tr><td><button type="submit" class="btn">Submit</button></td></tr>
</form> 
```

注意：表格中的所有其他数据都保存得很好，照片根本没有上传。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T22:57:48.953

您需要传递`request.FILES`给您的表格：

```
form = CreateProfileForm(request.POST, request.FILES, instance=profile) 
```

参考：[使用模型处理上传的文件](https://docs.djangoproject.com/en/1.10/topics/http/file-uploads/#handling-uploaded-files-with-a-model)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-10T14:28:20.250

表单初始化代码必须是这样的：

```
form = MemberSettingsForm(request.POST or None, request.FILES or None, instance=user) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T19:28:21.757

我想到了。这是我的views.py的问题。您需要设置 request.method == POST 以确保您仍然可以将实例作为表单的一部分。不过效果很好。

```
#Views.py

def create_profile(request):
    try: 
        profile = Profile.objects.get(user=request.user)
    except:
        pass
if request.method == 'POST':
    form = CreateProfileForm(request.POST, request.FILES)

    if form.is_valid():
       new = form.save(commit=False)
       new.user = profile.user
       new.save()

else:
     form = CreateProfileForm(request.POST or None, instance=profile)

return render_to_response('profile.html', locals(), context_instance=RequestContext(request)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-04T13:45:13.093

在保存模型实例之前添加：

```
 new.profile_pic = request.FILES.get('profile_pic') 
```

# linux - 如何查看 root 的 bash_history？

> ID：13148438
> 
> 赞同：7
> 
> 时间：2012-10-30T22:24:03.617
> 
> 标签：linux, bash, unix, amazon-ec2

我在亚马逊的 aws EC2 上有一个 linux 盒子。我可以在这里查看用户的 bash_history：

```
/home/ec2-user/.bash_history 
```

但是，当我扎根：

```
sudo -s 
```

我没有得到根的 bash_history。如何查看/查找管理员用户的 bash_history？

谢谢，布雷特

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-30T22:31:52.557

这是快速方法：

```
sudo less /root/.bash_history 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T22:30:49.237

您可以运行 history 命令来查看当前用户的历史记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T22:30:36.767

当你“sudo -s”时，你显然得到了源帐户的 .bash_history，因为 $HOME 没有改变。

在 sudo -s 之前尝试将 $HOME 设置为 ~root。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T16:17:05.883

通过使用 visudo 插入，在 sudo 中启用日志记录

```
Defaults logfile=/var/log/sudo.log 
```

# java - Hibernate 不必要地更新连接的表

> ID：13148446
> 
> 赞同：0
> 
> 时间：2012-10-30T22:24:47.407
> 
> 标签：java, hibernate, join, sql-update

基本上，我有 2 个类 P 和 M，以及它们对应的表 T_P 和 T_M，它们以一对多的关系连接，一个 P 有一组 Ms。像这样：

```
<class name="P" table="T_P">
    <set name="ms" cascade="all" lazy="false" inverse="true">
        <key column="P_ID" not-null="true" foreign-key="FK_M_P"/>
        <one-to-many class="M"/>
    </set>
</class>
<class name="M" table="T_M">
    <many-to-one name="p" column="P_ID" foreign-key="FK_M_P" class="P"
                 update="false" not-null="true" cascade="none"/>
</class> 
```

现在，当我对 P 进行更改并要求 Hibernate 更新数据库时。Hibernate 很可能会做一批更新，一个到 T_P，几个到 T_M，我知道后面的部分没有必要，因为我没有更改那些 Ms。但我认为因为我的对象是分离的，所以 hibernate 必须更新一切。

所以我的问题是，在我的情况下，我可以要求 Hibernate 只更新部分，而不是进行过多的 DB 命中吗？或其他优化这一点的建议也值得赞赏。但这是一个遗留程序，我可能无法做出重大改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T12:16:46.870

**就`inverser="true"`映射而言，它仅适用于双向关联。** 在您的配置中，您没有提到 M 中的 P 映射。

```
<class name="P" table="T_P">
<set name="ms" cascade="all" lazy="false" inverse="true">
    <key column="P_ID" not-null="true" foreign-key="FK_M_P"/>
    <one-to-many class="M"/>
</set>
</class>
<class name="M" table="T_M">
     /*mention mapping for P here, if you want to use inverse property properly*/
</class> 
```

问题可能是由于`cascade="all"`映射。尝试`cascade="save-update"`在映射中设置集合。

您通过以下[链接](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/example-parentchild.html)，其中包含父子关系的简单/基本示例。

父子关系的示例映射如下。

```
/*parent contain set of child entity*/
<set name="children" inverse="true">
<key column="parent_id"/>
<one-to-many class="Child"/>
</set>

/*child has reference of parent*/
<many-to-one name="parent" column="parent_id" not-null="true"/> 
```

我希望这可以帮助您解决问题。

# android - setContentView() 后返回视频

> ID：13148447
> 
> 赞同：1
> 
> 时间：2012-10-30T22:24:51.187
> 
> 标签：android, media-player, surfaceview

我使用 SurfaceView 在我的应用程序中显示视频，当我将内容视图更改为其他位置时它会被释放。我的问题很简单（我猜）：当我想用视频切换回视图时，我必须向播放器提供一个新的 SurfaceView，因为错误消息告诉我该表面已被释放。

我可以以某种方式简单地重新启动我在 layout.xml 中定义的 SurfaceView 以重用它吗？或者有人有更好的主意来暂停 MediaPlayer 中的视频，显示图像，然后切换回视频而不破坏 SurfaceView？

干杯!

# mysql - 由于 imagemagick 导致的 rake 失败

> ID：13148448
> 
> 赞同：0
> 
> 时间：2012-10-30T22:24:53.863
> 
> 标签：mysql, ruby-on-rails-3, activerecord, imagemagick, rake

我正在使用`rake db:seed`Rails 3 播种开发数据库（mysql）。 rake 任务失败，说明，

> 验证失败：“识别”命令无法识别徽标 /var/folders/.../logo.png。

当我运行时`which identify`，我得到了预期的路径`/usr/local/bin/identify`。ImageMagick 确实已安装（通过 Homebrew），并且*似乎*可以从命令行很好地处理 png 图像。

我什至在另一台机器上重建了应用程序，认为我的环境很糟糕，我得到了同样的错误。

我的终端会话中是否有恶作剧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:25:04.757

您是否尝试过在 rake 之前运行 bundle exec。在过去，这经常为我解决这些问题。它将确保在运行 rake 任务之前加载您的 rails 环境。

```
bundle exec rake db:seed 
```

希望有帮助！

// 添加

您是否也在使用 Paperclip gem 进行此导入？我确实记得我需要确保在我的 development.rb 文件中设置了 ImageMagick 的路径，以确保它被选中。

例如。

```
Paperclip.options[:command_path] = "/usr/local/bin" 
```

# algorithm - 切割矩形纸的矩形片并最大限度地减少浪费。

> ID：13148452
> 
> 赞同：0
> 
> 时间：2012-10-30T22:25:12.407
> 
> 标签：algorithm

给定一张长方形纸 W*H(widht * height)。一个应该从中切出矩形块。给出了碎片大小的列表（具有“k”个元素）。碎片的大小由 w*h 给出。所有的数字都是整数。

切口必须从一端到另一端。

可以有任意数量的所列尺寸的件（包括没有件）。

目的是尽可能多地使用纸张，即尽量减少浪费。

谁能建议我如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:30:51.857

这是典型的背包问题。我将在这里为您省去详细信息，但您可以在此处获得有关如何处理它的更多信息和想法

[http://en.wikipedia.org/wiki/Knapsack_problem](http://en.wikipedia.org/wiki/Knapsack_problem)

# c# - 带有 DotNetZip 的 Visual Studio 构建版本

> ID：13148453
> 
> 赞同：1
> 
> 时间：2012-10-30T22:25:14.270
> 
> 标签：c#, visual-studio-2010, dotnetzip

我用 C# 编写了一个使用 DotNetZip 的程序，但是当我在 Release 配置中构建 exe 时找不到 Ionic。

我按照以下说明操作： [http ://dotnetzip.codeplex.com/wikipage?title=Getting-Started&referringTitle=Home](http://dotnetzip.codeplex.com/wikipage?title=Getting-Started&referringTitle=Home)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T17:21:59.827

我最终使用 ILMerge 和 ILMergeGui 将 Ionic.Zip.dll 与我的 .exe 合并

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:29:05.273

确保您在引用中添加了对 Ionic.Zip.dll 的引用。

# javascript - 画布：消除小弧之间的间隙

> ID：13148455
> 
> 赞同：1
> 
> 时间：2012-10-30T22:25:24.020
> 
> 标签：javascript, math, canvas

这是示例：http: [//jsfiddle.net/pcNzb/9/](http://jsfiddle.net/pcNzb/9/)

我只是学习，所以我一定是错过了什么或做错了什么。:)

看到弧之间的间隙了吗？我正在用小弧线构建完整的圆圈。我知道如何解决它，但我想最好避免在每一步都重新绘制完整的弧线，否则我错了？

我找到了另一个解决方案，带有偏移量。设置偏移量 moveToRad+0.009

```
ctx.arc(x(),y(),radius,-moveFromRad,-moveToRad-0.009,antiClockwise); 
```

将一个弧形部分重叠在另一个弧形部分上，但如果我使用 rgba alpha 到 0.5 则这变得可见。

除了在每个步骤上重绘整个圆圈之外，还有其他解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:37:49.057

> 除了在每个步骤上重绘整个圆圈之外，还有其他解决方法吗？

简而言之，不，如果您希望它可以跨浏览器工作并且使用半透明颜色看起来不错，则不会。

这意味着，修改您的代码以清除每次绘制并消除起始角度步骤：http: [//jsfiddle.net/pcNzb/10/](http://jsfiddle.net/pcNzb/10/)

看到两个 !!! 标记的评论：

```
var interval=setInterval(function(){
    if(stop) {
        return;
    }
    // Log current state
    log.prepend('<tr><td>We are at PIradians '+moveToRad/Math.PI+'</td><td>, radians '+moveToRad+'</td><td>, degrees '+Math.round(moveToRad*180/Math.PI)+'</td></tr>');

    // console.log('We are at PIradians',moveToRad/Math.PI,', radians',moveToRad,', degrees',Math.round(moveToRad*180/Math.PI));

    // Clear after full cycle
    if(moveToRad>=fullCycle){
        cycle();
    }
    clear(); // !!! gotta clear!

    // Create arc
    // 0.01 fix offset, to remove that gap between arc parts
    ctx.arc(x(),y(),radius,-moveFromRad,-moveToRad,antiClockwise);

    // Draw arc line
    ctx.stroke();

    // Recalculate text width
    txtsizes=ctx.measureText(cycles);
    // Text width/2 and font-size / 3 to ~center the text in circle
    ctx.fillText(cycles, x(-txtsizes.width/2), y(font_height/3));

    // Don't redraw full arc from the start, draw from the last point
    //moveFromRad+=step; // !!! no more me!
    // Increment radian for the next step
    moveToRad+=step;

    ctx.beginPath();                
},period); 
```

# ruby-on-rails - 新部署后，独角兽无法正确断开数据库连接

> ID：13148456
> 
> 赞同：3
> 
> 时间：2012-10-30T22:25:33.557
> 
> 标签：ruby-on-rails, capistrano, unicorn, octopus

我目前在部署 Capistrano 后遇到数据库连接问题。在数据库服务器上，似乎独角兽并没有切断以前的连接，它只是不断地在旧连接之上添加。我正在做一个预加载，如果这很重要，我也安装了章鱼 gem。我不太确定这应该归咎于谁。我已经为重要的部分粘贴了我的独角兽配置。任何帮助表示赞赏！

```
before_fork do |server, worker|
  if defined?(ActiveRecord::Base)
    ActiveRecord::Base.connection.disconnect!
  end
  old_pid = "/tmp/unicorn.my_app_name.pid.oldbin"
  if File.exists?(old_pid) && server.pid != old_pid
    begin
      Process.kill("QUIT", File.read(old_pid).to_i)
    rescue Errno::ENOENT, Errno::ESRCH
    end
  end
end

after_fork do |server, worker|

  ActiveRecord::Base.connection_proxy.instance_variable_get(:@shards).each {|k,v| v.clear_reloadable_connections! }
  if defined?(ActiveRecord::Base)
    ActiveRecord::Base.establish_connection
  end

  if Process.ppid > 1 # Not the daemon
  child_pid = server.config[:pid].sub(".pid", ".#{worker.nr}.pid")
  File.open(child_pid, "wb") {|f| f << Process.pid }
  end
end 
```

![1](../Images/ca845a6c31305c5a02af68b950835b9e.png)“ps辅助”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T22:03:59.980

你的“新理论”是正确的。5 个连接的 2 个工作人员将导致总共 10 个。答案就在这里——[独角兽不关闭数据库连接](https://stackoverflow.com/questions/15661482/unicorn-do-not-close-db-connections)

# mysql - 这可以将流量分配到我的 RDS 只读副本吗？

> ID：13148457
> 
> 赞同：0
> 
> 时间：2012-10-30T22:25:35.610
> 
> 标签：mysql, amazon-web-services, amazon-rds

我将 Amazon RDS 用于我的数据库服务，并希望使用只读副本功能在我的只读副本卷之间分配流量。我目前将我的数据库的连接信息存储在一个配置文件中。所以我的想法是，只要我的应用程序执行读取，我就可以创建一个从配置文件中的只读副本端点/地址列表中随机选择的函数。

只要我不在写入时执行它，这个想法是否有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T06:36:14.840

我的猜测是，如果您的服务有足够的流量到达您想要平衡负载的多个 rds 只读副本的位置，那么您前面还有多个应用程序服务器在负载平衡器后面运行。

因此，您最好让某些应用服务器实例集群，每个集群都指向一个特定的只读副本。也许您可以通过可用区来执行此操作。

这里的想法是，您的负载均衡器将用作正确分配最终导致数据库读取的传入请求的机制。如果您在不同的副本之间随机读取数据库，您可能会遇到意外的峰值，其中太多的流量恰好被定向到一个数据库副本，从而导致您的服务出现延迟峰值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T19:45:59.687

最大的挑战是无法保证只读副本与主副本或在进行更新时彼此保持最新。如果您每次执行读取时都选择不同的只读副本，如果其中一个只读副本落后，您可能会看到一些奇怪的情况：N 次读取中的一个将获得陈旧数据，从而提供不一致的系统视图。

从一致性的角度来看，为每个事务或会话选择一个随机只读副本可能更容易处理。

# xna - Windows Phone 8 SDK 博客公告和 XNA 混淆

> ID：13148458
> 
> 赞同：3
> 
> 时间：2012-10-30T22:25:36.517
> 
> 标签：xna, windows-phone, windows-phone-8

在[Windows Phone 8 SDK 公告博客文章](http://blogs.msdn.com/b/visualstudio/archive/2012/10/30/introducing-windows-phone-sdk-8-0.aspx)中，我看到了这个：

> XNA Game Studio – 使您能够继续为现有的 Windows Phone 7.1 设备以及台式机和 Xbox 360 开发游戏。

但是，针对 XNA 配置文件定位 Windows Phone 以外的任何设备将导致 Visual Studio 2012 错误“Windows/Xbox 不是此版本的 XNA Game Studio 支持的平台”。

那么，我是否错误地阅读了博客文章？如博客文章所示，是否可以使用与 Windows 8 SDK 一起打包的 XNA Game Studio 来定位 Windows 和 Xbox？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T23:36:35.623

我不确定我是否在关注。Windows Phone SDK 仅随 XNA for Windows Phone 一起提供。

如果您想针对 Windows PC 或 Xbox，您必须下载完整的[Microsoft XNA Game Studio 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=23714)，其中包含适用于其余平台的 SDK。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T11:46:43.993

刚刚从 Aaron Stebner（微软员工）那里得到了这个回复：

[http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/4a608bd0-e8a1-42ba-a1c9-d68f828604a7](http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/4a608bd0-e8a1-42ba-a1c9-d68f828604a7)

> 博文不正确。Windows Phone SDK 8.0 支持构建使用 XNA 框架的 Windows Phone 游戏，但不支持构建使用 XNA 框架的 Windows 或 Xbox 360 游戏。
> 
> 如果您正在开发使用 XNA 框架的 Windows 游戏或 Xbox 360 游戏，则必须继续使用 Visual Studio 2010 版本以及 Windows Phone SDK 7.1 或 XNA Game Studio 4.0 Refresh。这两种产品都可以与 Windows Phone SDK 8.0 一起安装。
> 
> 谢谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T06:19:24.933

您可能必须安装完整的 XNA Game Studio。
[http://www.microsoft.com/en-us/download/details.aspx?id=23714](http://www.microsoft.com/en-us/download/details.aspx?id=23714)
另外，由于公共 WP8 SDK 现在可用，我可以确认您不能直接为 WP8 平台开发 XNA 应用程序。您的 XNA 应用程序只能针对 WP7.1 平台，它们可以在 WP8 设备上正常运行。

# c++ - 编译 32 位二进制文 件：在 '__int128' 之前预期的 unqualified-id

> ID：13148463
> 
> 赞同：4
> 
> 时间：2012-10-30T22:26:27.187
> 
> 标签：c++, macos, gcc, stl

我正在将我的代码移植到 Mac 上，它可以在我的 64 位 Windows 机器上正常编译。显然我正在使用的库之一（Awesomium）没有编译为 64 位代码，所以我必须将我的代码编译为 32 位二进制文​​件。

尝试使用 GCC 4.8 编译 32 位二进制文​​件时出现错误。

```
In file included from /opt/local/include/gcc48/c++/random:50:0,
                 from /opt/local/include/gcc48/c++/bits/stl_algo.h:67,
                 from /opt/local/include/gcc48/c++/algorithm:63,
                 from /Library/Frameworks/SFML.framework/Headers/System/Utf.hpp:32,
                 from /Library/Frameworks/SFML.framework/Headers/System.hpp:43,
                 from /Library/Frameworks/SFML.framework/Headers/Window.hpp:32,
                 from /Users/ryan/projects/ArchaicEngine/ArchaicEngine/includes/ArchaicEngine/Graphics/RenderWindow.h:4,
                 from /Users/ryan/projects/ArchaicEngine/ArchaicEngine/src/Graphics/RenderWindow.cpp:1:
/opt/local/include/gcc48/c++/bits/random.h:106:26: error: expected unqualified-id before '__int128'
       { typedef unsigned __int128 type; }; 
```

基本上 SFML 包括`<algorithm>`哪些然后包括`<random>`哪些使用 __int128 对 32 位二进制文​​件不可用。我怎样才能让它编译？

# c# - 从 WCF 服务流式传输文件

> ID：13148464
> 
> 赞同：3
> 
> 时间：2012-10-30T22:26:28.233
> 
> 标签：c#, asp.net, wcf, httpresponse

我试图弄清楚如何从典型网站前端的 Web 服务流式传输文件（通常是 PDF）。PDF 并不实际存在，而是由报表生成器动态创建的（想想 Crystal、Telerik Reporting 等）

我今天可以直接从网站上执行此操作，方法`Response.Clear()`是先设置 ContentType 并添加适当的`Content-Disposition`标题，最后再添加`Response.BinaryWrite(...)`.

但是，WCF 服务（在这种情况下托管的 IIS）没有 Response 对象。我尝试`Response`从网页中将对象作为参数传递，但我什至无法启动 WCF 服务，因为 HttpResponse 无法序列化。

我在吠叫错误的树吗？有没有更好的方法来看待这个？我们希望它在一个通用的 Web 服务中，因为我们的更多网站都需要这样做，而且我们不想维护多个代码副本来执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T09:16:22.210

您可以将文件作为 byte[] 数组发送。

或者您可以将此文件作为 Stream 参数发送（使用 Streamed 模式）

# c# - 通过 InstanceContextMode = PerSession 将 Autofac 与 WCF 服务一起使用

> ID：13148468
> 
> 赞同：1
> 
> 时间：2012-10-30T22:27:03.023
> 
> 标签：c#, .net, wcf, autofac

我有一个 WCF 服务`ServiceBehavior.InstanceContextMode = InstanceContextMode.PerSession`。

我如何需要向 Autofac 注册服务才能为每个新会话获取一个新实例，但在会话中使用相同的实例？我目前正在使用以下配置，它会导致如下行为`PerCall`：

```
builder.Register(c => new ChannelFactory<IUserService>()).SingleInstance();
builder.Register(c => c.Resolve<ChannelFactory<IUserService>>().CreateChannel())
       .UseWcfSafeRelease();
builder.RegisterType<UserService>().AsImplementedInterfaces(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:55:03.003

正如我们在评论中发现的那样，您使用的是 basicHttpBinding。basicHttpBinding 不支持`ServiceBehavior.InstanceContextMode = InstanceContextMode.PerSession`会话行为。有关绑定的更多详细信息，请查看[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms730879.aspx)

我还想补充的是，WCF 会自动跟踪其会话，如果您关闭代理并再次重新打开，您将获得相同的会话。（如果您的绑定当然支持它）。只有当客户端关闭时，您的会话才会在 WCF 中自动终止。

# sql - SQL Azure - 与 localhost 数据库相比非常慢

> ID：13148473
> 
> 赞同：2
> 
> 时间：2012-10-30T22:27:24.267
> 
> 标签：sql, performance, azure, azure-sql-database

我决定尝试 Microsoft SQL Azure，因为很多人都高度评价它。它应该是快速、灵活、便宜和许多其他的东西。

我启动并运行它，将我的数据迁移到 Azure 并连接了连接字符串。我试图在数据库上运行一些查询，并且对即使是简单的查询也如此缓慢感到震惊。从 700 行的表中执行“SELECT *”需要 7 秒。与我在共享主机上使用本地管理工作室或数据库时相比，我的页面似乎也非常慢。

现在，当我设置服务器时，我无法选择物理位置。但是，我住在丹麦，我可以看到服务器是“美国中南部”。这可能是问题所在。

我不使用任何存储过程（所以我猜没有参数嗅探）。我还可以看到我的索引已成功传输。

关于做什么的任何想法？我缺少任何性能方面的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-03T20:16:14.787

最近几天我遇到了这个问题。将您的数据库层从基本更改为标准，您将看到性能的巨大提升。我目前正在研究一个查询密集型仪表板，它需要 20 秒的响应时间到 2 秒的响应时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-03-04T11:52:12.830

过去很多年我一直在使用 Azure，我最初的问题已经基本解决了。

在处理 Azure 数据库一段时间后，我的主要收获：

*   将您的应用程序和数据库放置在同一区域中非常重要。如果没有，那么您的应用程序将很慢。最近我有一个 API 和应用程序在两个不同的区域上运行 - 每个响应需要大约 1 秒.. 将它移到相同的位置后，它是即时的
*   如果您的应用程序负载很高，那么升级通常是个好主意。这比您预期的要早发生
*   选择最近的地区——这真的很重要

# core-data - 将 CoreData 对象导出到 NSDictionary 或 NS Array

> ID：13148477
> 
> 赞同：0
> 
> 时间：2012-10-30T22:27:38.433
> 
> 标签：core-data, nsmutablearray, nsarray, nsdictionary

我有一个核心数据对象，它由不同类型的 NSString、Float、NSDATA、...组成。

```
 <Shoplog: 0x9c78d20> (entity: Shoplog; id: 0x9c77050 <x-coredata://828289C5-E1B8-48A6-B2A0-F68B7DF21F2E/Shoplog/p5> ; data: {
    categoryname = Ines;
    comments = nil;
    date = nil;
    email = "iloveyou@gmail.com";
    image = <ffd8ffe0 00104a46 49460001 01000001 00010000 ffe10058 45786966 00004d4d 002a0000 00080002 01120003 00000001 0001>;
    phone = 800;
    price = 9988;
    shop = "";
    websiteurl = "http://www.google.com";
}) 
```

问题是我想将此 NSManaged 对象导出到 NSArray 或 NSDictionary 中，以便将其写入文件，以便通过邮件将其发送给另一个用户，并从他的应用程序中打开它。

所以每当我尝试使用此代码时

```
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *filePath = [documentsDirectory stringByAppendingPathComponent:@"Shoplog.slog"];
[savedData writeToFile:filePath atomically:YES]; 
```

无论 Selected NSManagedObject 有多大，它都会给我一个非常小的文件 135bytes 我得到相同的 Size 。

我需要帮助来了解发生了什么问题？我想到了 1 个解决方案： 1- 使用 KVC 方法将 NsManagedObject 转移到 NSMutableArray

虽然我仍然相信这个问题有一个更聪明的解决方案，所以如果有人可以帮助我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T11:13:24.210

我在下面的链接中有我的答案，它很容易实现，只需按照步骤 [序列化（归档/取消归档）NSManagedObject Graph](http://vladimir.zardina.org/2010/03/serializing-archivingunarchiving-an-nsmanagedobject-graph/)

# python - 将字符串从一个点拆分到另一个点（不同的分隔符）

> ID：13148480
> 
> 赞同：0
> 
> 时间：2012-10-30T22:27:49.107
> 
> 标签：python, regex, split

我想拆分这个字符串`def Hello(self,event):`，以便只剩`Hello`下分隔符`def`，然后我猜是`():`. 我怎样才能在python中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T22:31:53.627

你在寻找类似的东西

```
re.findall('^def ([^(]+)', 'def Hello(self, asdf):') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T22:32:01.443

使用正则表达式模式

```
^def\s+(\w+)\((.*?)\) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T22:37:59.463

我建议对此类使用正则表达式（请参阅其他示例），但要在这里回答您的问题是使用以下解决方案`split`：

```
In [1]: str = "def Hello(self,event):"
In [2]: str.split(' ')[1].split('(')[0] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T22:35:02.520

这是使用正则表达式的一种选择：

```
import re
re.search(r'def\s+([^)\s]*)\s*\(', your_string).group(1) 
```

例子：

```
>>> re.search(r'def\s+([^)\s]*)\s*\(', 'def Hello(self, asdf):').group(1)
'Hello'
>>> re.search(r'def\s+([^)\s]*)\s*\(', 'def  Hello  (self, asdf):').group(1)
'Hello' 
```

解释：

```
def         # literal string 'def'
\s+         # one or more whitespace characters
(           # start capture group 1
  [^)\s]*     # any number of characters that are not whitespace or '('
)           # end of capture group 1
\s*         # zero or more whitespace characters
\(          # opening parentheses 
```

# ajax - Ajax 帖子被 firefox 中止（在 Chrome 或 IE 中看不到）

> ID：13148483
> 
> 赞同：19
> 
> 时间：2012-10-30T22:27:55.783
> 
> 标签：ajax, firefox, post, fiddler

使用 firefox 时，我的 ajax 发布请求在 firebug 中被报告为中止。ajax 帖子在 IE 和 Chrome 中运行良好。这不是跨域请求。我尝试使用 fiddler 查看问题，并且当 fiddler 捕获网络流量（设置为解密 https 的选项）时，该帖子有效。无法在我的本地开发环境中创建发布问题，因为所有 Firefox 尝试成功发布我通过 ajax 发送的数据。知道为什么在提琴手运行时帖子有效吗？它可能会让我知道如何让它工作。

```
$.ajax({
            type: 'POST',
            url: '/Save',
            data: JSON.stringify(dataset),
            datatype: "html",
            contentType: "application/json",
            success: function (data, textStatus, jqXHR) {
                //alert("success");
            },
            error: function (jqXHR, textStatus, errorThrown) {
                //alert("error");
            }
        }); 
```

此外，这个 ajax 请求由许多方法调用，并且只有在发送最大的数据集时才会失败。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-09T12:47:28.983

只试

```
async: false 
```

在 ajax 选项中，我遇到了同样的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-02T14:03:17.423

我将从显式设置（和更改）一些基本的 ajax 选项开始：

```
 cache: false,
 timeout: 60000,
 async: false 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-08T19:27:35.850

您的服务器返回什么类型的内容。JSON 或 HTML 内容。您是否在服务器内容中使用**charset=utf-8 。**确保您的服务器响应必须是 JSON contentType。另一个猜测从您的代码中删除*数据类型：“html” 。*试试你的运气。

如果您的服务器返回 json 表示，请在下面尝试

```
$.ajax({
            type: 'POST',
            url: '/Save',
            data: JSON.stringify(dataset),
            datatype: "json",
            contentType: "application/json",
            success: function (data, textStatus, jqXHR) {
                //alert("success");
            },
            error: function (jqXHR, textStatus, errorThrown) {
                //alert("error");
            }
        }); 
```

**datatype: "json", contentType: "application/json"**有意义

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-13T14:17:35.537

如果您从事件处理程序发送此 AJAX 请求（例如：单击提交按钮），请确保阻止浏览器的默认行为（提交表单），直到您将触发 2 个 HTTP 请求，第一个被中止。

您可以使用`e.preventDefault()`来实现这一点。

我刚刚在 IE8 上遇到了这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-09T13:56:28.227

我也有类似的问题，并尝试了上面描述的一些想法。我终于通过以下方式修复了“中止”状态：

1.  添加`e.preventDefault();`和`return false;`按钮事件处理程序
2.  添加`datatype: "json", contentType: "application/json",`到`jQuery.ajax`方法参数。

感谢大家提供线索。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-08T14:54:28.797

检查服务器上的最大帖子大小设置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-01-28T17:48:26.877

这要么是跨域问题，要么是 Firefox 中止您的请求的问题，因为请求是异步的。对于跨域，您可以检查请求的来源以及网络服务允许的内容。您可能需要阅读 CORS。

如果它不是跨域的，那么肯定是请求异步的问题。只需将其更改为同步即可。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-13T21:13:09.390

如果您在 CORS 请求上使用 2-way SSL 身份验证，Firefox 将默认中止您的 jQuery ajax 请求。这是由于 Firefox 和 Chrome 中 CORS 的不同实现。`withCredentials: true`您可以通过添加到您的 XHR 实例在您的客户端代码中解决此问题。在 jQuery 中，您可以将其添加到`ajax`调用中：

```
xhrFields: {
  withCredentials: true
} 
```

查看这些错误报告以获取更多详细信息：

*   [Chrome 在 CORS 预检中发送 TLS 客户端证书，违反规范要求](https://bugs.chromium.org/p/chromium/issues/detail?id=775438)
*   [TLS 握手在 CORS 请求上失败，因为没有发送证书](https://bugzilla.mozilla.org/show_bug.cgi?id=1019603)

我还注意到 Firefox 仍然绝对拒绝在 OPTIONS 预检请求上发送凭据，因此您需要将服务器配置为不需要它们（这在 2 路 SSL 场景中对我来说似乎很疯狂）。

# cocos2d-iphone - 有没有办法将 CCSprite 孩子转移给另一个父母？

> ID：13148485
> 
> 赞同：0
> 
> 时间：2012-10-30T22:28:06.047
> 
> 标签：cocos2d-iphone

如果我有一个之前添加到父 CCNode 或 CCLayer 的 CCSprite，有没有办法更改其父对象？

我试着做：

```
[self setParent:newParent]; 
```

...

接着：

```
[parent removeChild:self cleanup:YES];
[newParent addChild:self]; 
```

两者都不起作用......后者实际上会导致崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T12:42:01.493

我假设在第二种情况下，您将自动释放的对象添加到父级。在这种情况下，精灵会在从父级移除后被删除，因此您将无法将其添加到另一个父级。尝试这个

```
[self retain];
[self removeFromParentWithCleanup:YES];
[newParent addChild: self];
[self release]; 
```

如果发生错误崩溃，请在以后发布崩溃消息。它可以帮助找出问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:48:20.897

我认为如果你先删除（不清理），然后添加到新的父级，它应该可以工作。

# firefox-addon-sdk - FF 扩展中引发的参数不足异常

> ID：13148486
> 
> 赞同：-1
> 
> 时间：2012-10-30T22:28:09.807
> 
> 标签：firefox-addon-sdk

如果您想与附加脚本进行通信，文档明确指出使用内容脚本中的 self.postMessage(message) 。我正在这样做，并传入一个字符串用于测试目的，但我得到了标题中详细说明的异常。为什么是这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:11:13.750

这是消息传递如何工作的一个工作示例：

[https://builder.addons.mozilla.org/package/60173/latest/](https://builder.addons.mozilla.org/package/60173/latest/)

从示例中可以看出，使用 self.port.emit 和 self.port.on 进行消息传递会产生更具可读性的代码。

# c++ - 空滚动区域 QT C++

> ID：13148487
> 
> 赞同：0
> 
> 时间：2012-10-30T22:28:11.973
> 
> 标签：c++, qt

我正在从计时器执行的 xml 加载数据。xml 被解析并填充到实体对象中。在一个循环中，我从实体对象中获取数据并填充 QCommandLinkBut​​ton。最后将一批按钮设置为verticalLayout，然后设置为scrollArea。

但是每次加载数据时，它都会附加到旧数据中。如何在重新填充 scrollArea 之前清空 srollArea 的内容。

```
MainWindow::methodExecudedByTimer(){

    foreach(int i, map.keys()){ 
        QCommandLinkButton* buttonEmail = new QCommandLinkButton(this);
        Email em = map[i];
        buttonEmail->setText(em.__toString());

        ui->verticalLayout->addWidget(buttonEmail);
    }
    ui->scrollArea->setLayout(ui->verticalLayout);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T01:52:55.213

您可以使用**setWidget**替换**setLayout** 。然后新数据来了，您可以调用**takeWidget**来删除旧数据。MainWindow::methodExecudedByTimer(){

```
foreach(int i, map.keys()){ 
    QCommandLinkButton* buttonEmail = new QCommandLinkButton(this);
    Email em = map[i];
    buttonEmail->setText(em.__toString());

    ui->verticalLayout->addWidget(buttonEmail);
}
ui->scrollArea->takeWidget();
QWidget *widget = new QWidget();
QSize size = ui->scrollArea->size();
widget->setMinimumSize(size.width(),size.height());
widget->setLayout(ui->verticalLayout);
ui->scrollArea->setWidget(widget); 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:35:21.307

我在互联网的深处找到了答案。

在`foreach`我添加这个之前：

```
qDebug() << "check if layout filled";
if(ui->verticalLayout->count() > 0){
   qDebug() << "empty layout";
   QLayoutItem *item = NULL;
   while ((item = ui->verticalLayout->takeAt(0)) != 0) {
      delete item->widget();
   }
}else{
   // on app first run
   qDebug() << "layout empty";
} 
```

# java - 使用准备好的语句从表中删除问题

> ID：13148493
> 
> 赞同：0
> 
> 时间：2012-10-30T22:28:36.123
> 
> 标签：java, jdbc

我试图从数据库中删除一行，但控件总是进入下面的 else 部分。我试图在数据库上执行相同的删除语句，它在那里工作。我已经验证了所有的列名和表名是正确的。

如果我在这里做错了什么，有人可以指导吗？

谢谢。

```
public String delAd(String x, String y, String z){

    String result = ""; 
    int rowcount = 0;

    try{

        PreparedStatement ps = con.prepareStatement("DELETE FROM dbname.tablename WHERE iname = ? AND idesc = ? AND seller = ?");
        ps.setString(1,x);
        ps.setString(2,y);
        ps.setString(3,z);

        rowcount = ps.executeUpdate();

        if(rowcount > 0){
            result = "true";
            System.out.println("Delete Successful");
        }else{
            result = "false: Value could not be deleted from the database";
        }

    }catch(Exception e){
        e.printStackTrace();
    }

    return result;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:43:51.570

如果有任何行满足查询，请检查您的表。简单的测试方法是使用下面的值执行选择语句。

```
 SELECT * FROM TABLENAME WHERE INAME='WATEVER' AND IDESC='WATEVER'; 
```

从输出中可以明显看出，没有任何行可以满足您的查询，这就是控制跳转到其他位置的原因。

# zend-framework - 奇怪的 Zend 框架行为 - 找不到索引控制器操作

> ID：13148505
> 
> 赞同：0
> 
> 时间：2012-10-30T22:29:35.813
> 
> 标签：zend-framework

我最近开始了一个新的 zend 框架项目。我通过 ZF 工具创建了所有 db-table 模型、模型、控制器、操作、表单和启用的布局。我创建的所有项目都显示在 .zf-project.xml 中。

然后我开始为默认布局设置第一个页眉和页脚。此布局的底部是页脚导航部分，其中包含多个链接，例如：

```
 <a href="/howitworks">How it Works</a> 
```

单击它时，它应该导航到索引控制器/howitworksAction，但它没有。相反，我收到一条错误消息：

```
 Message: Invalid controller specified (howitworks)

    **Stack trace:**

    #0 /usr/share/php/Zend/Controller/Front.php(954): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
    #1 /usr/share/php/Zend/Application/Bootstrap/Bootstrap.php(97): Zend_Controller_Front->dispatch()
    #2 /usr/share/php/Zend/Application.php(366): Zend_Application_Bootstrap_Bootstrap->run()
    #3 /var/www/vhosts/lokals.mediagiantdesign.com/httpdocs/public/index.php(26): Zend_Application->run()
    #4 {main}  
    Request Parameters:

    array (
      'controller' => 'howitworks',
      'action' => 'index',
      'module' => 'default',
    ) 
```

如果我将 URL 强制为 /index/howitworks，它可以正常工作。我完全被这个抛弃了，因为这是我在曾经发生过这种情况的地方构建的第一个 Zend 应用程序。在以前的应用程序中，这种链接开箱即用。我还没有设置自定义路由器，引导程序是准系统。所以我不知道为什么这不起作用。

我认为zend首先寻找一个匹配控制器的控制器，如果没有找到它会在索引中寻找一个匹配的动作，如果没有找到，它会假设它是/public中的一个文件。如果是这样，那么我在这里缺少什么？

提前致谢。瑞克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T00:30:06.720

Zend Framework 的默认 URL 结构是：http: [//yourdomain.com/controller/action/params](http://yourdomain.com/controller/action/params)。每当 Zend Framework 默认路由 URL 时，形式为“http://yourdomain/howitworks”，它会将 howitworks 视为控制器，并且由于未指定任何操作，因此将假定 indexAction。使用 Zend url view helper 来避免混淆总是有帮助的。

```
 <a href="<?php  echo $this->url(array('controller' => 'index', 'action' => 'howitworks'), null, true); ?>" 
```

If you want to use "/howitworks" point to howitworksAction in the IndexController, you will need to set up a custom route in the bootstrap.php.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:21:18.057

默认情况下，URL domain.com/howitworks 将引用 howitworksController 中的 indexAction。如果没有找到，Zend 将继续向错误控制器查找如何处理错误。默认情况下，它不会转到 indexcontroller，除非您在 errorController 中有一个路由或一些错误处理，告诉 Zend 使用这个回退

# php - php 爆炸并强制数组键从 1 而不是 0 开始

> ID：13148506
> 
> 赞同：2
> 
> 时间：2012-10-30T22:29:42.510
> 
> 标签：php, arrays, explode, array-key

我有一个字符串，它将被分解以获得一个数组，正如我们所知，输出数组键将从 0 作为第一个元素的键开始，1 表示第二个元素，依此类推。

现在如何强制该数组从 1 而不是 0 开始？

对于类型化数组来说非常简单，因为我们可以这样写：

```
array('1'=>'value', 'another value', 'and another one'); 
```

但是对于使用explode动态创建的数组，该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-30T22:34:21.920

```
$exploded = explode('.', 'a.string.to.explode');
$exploded = array_combine(range(1, count($exploded)), $exploded);
var_dump($exploded); 
```

完毕！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T22:46:31.043

只需使用分隔符在数组头部创建一个虚拟元素，然后将其删除。这应该是完成这项工作的最有效方法：

```
function explode_from_1($separator, $string) {
    $x = explode($separator, $separator.$string);
    unset($x[0]);
    return $x;
} 
```

更通用的方法：

```
function explode_from_x($separator, $string, $offset=1) {
    $x = explode($separator, str_repeat($separator, $offset).$string);
    return array_slice($x,$offset,null,true);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T22:32:32.057

```
$somearray = explode(",",$somestring);

foreach($somearray as $key=>$value)
{
   $otherarray[$key+1] = $value;
} 
```

好吧，它很脏，但这不是php的用途...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T22:33:56.453

Nate 几乎拥有它，但需要一个临时变量：

```
$someArray = explode(",",$myString);
$tempArray = array();

foreach($someArray as $key=>$value) {
   $tempArray[$key+1] = $value;
}
$someArray = $tempArray; 
```

[键盘示例](http://codepad.org/28qYgol0)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-30T22:34:53.877

```
$array = array('a', 'b', 'c', 'd');

$flip = array_flip($array);
foreach($flip as &$element) {
    $element++;
}
$normal = array_flip($flip);
print_r($normal); 
```

试试这个，一个相当时髦的解决方案：P

编辑：改用这个。

```
$array = array('a', 'b', 'b', 'd');
$new_array = array();

$keys = array_keys($array);
for($i=0; $i<count($array); $i++) {
    $new_array[$i+1] = $array[$i];
}
print_r($new_array); 
```

# perl - Perl WWW::Mechanize Web Spider。如何找到所有链接

> ID：13148509
> 
> 赞同：4
> 
> 时间：2012-10-30T22:29:47.507
> 
> 标签：perl, hyperlink, mechanize, web-crawler

我目前正在尝试**使用 WWW::Mechanize 创建一个 Perl webspider。**

我要做的是创建一个网络蜘蛛，它将**抓取整个网站**的 URL（由用户输入）并**从网站上的每个页面中提取所有链接**。

**到目前为止我所拥有的：**

```
use strict;
use WWW::Mechanize;

my $mech = WWW::Mechanize->new();

my $urlToSpider = $ARGV[0];
$mech->get($urlToSpider);

print "\nThe url that will be spidered is $urlToSpider\n";

print "\nThe links found on the url's starting page\n";

my @foundLinks = $mech->find_all_links();

foreach my $linkList(@foundLinks) {

    unless ($linkList->[0] =~ /^http?:\/\//i || $linkList->[0] =~ /^https?:\/\//i) {

        $linkList->[0] = "$urlToSpider" . $linkList->[0];
    }

    print "$linkList->[0]";
    print "\n";
} 
```

**它能做什么：**

**1.**目前会提取并列出起始页的所有链接

**2.**如果找到的链接是 /contact-us 或 /help 格式，它将在其前面添加“http://www.thestartingurl.com”，因此它变为“http://www.thestartingurl.com/contact -我们'。

**问题：**

目前它还可以找到我不希望它做的外部站点的链接，例如，如果我想爬取'http://www.tree.com'，它会找到诸如[http://www.tree 之类的链接。 com/找到我们](http://www.tree.com/find-us)。但是，它也会找到指向其他站点的链接，例如[http://www.hotwire.com](http://www.hotwire.com)。

**如何阻止它找到这些外部网址？**

在页面上找到所有 url 之后，我还想将这个新的内部链接列表保存到一个名为 @internalLinks 的新数组中，但似乎无法让它工作。

**非常感谢任何帮助，在此先感谢。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T07:27:21.703

这应该可以解决问题：

```
my @internalLinks = $mech->find_all_links(url_abs_regex => qr/^\Q$urlToSpider\E/); 
```

如果您不想要 css 链接，请尝试：

```
my @internalLinks = $mech->find_all_links(url_abs_regex => qr/^\Q$urlToSpider\E/, tag => 'a'); 
```

此外，您用于将域添加到任何相关链接的正则表达式可以替换为：

```
print $linkList->url_abs(); 
```

# sql - 在没有原始数据库的情况下向多维数据集添加属性并重新处理

> ID：13148511
> 
> 赞同：1
> 
> 时间：2012-10-30T22:29:59.157
> 
> 标签：sql, sql-server, ssas, sql-server-2012, xmla

每年我们都会保留一个我们的立方体的历史副本。今年有人决定他们想付钱给我们为立方体添加一个以前不存在的属性。好吧，我喜欢钱，但问题是我们没有建立这个立方体的数据库的备份。

所以我的脑海中出现了一个问题，我们是否需要那个原始数据库来为这个多维数据集添加一个新属性？我们是否可以向多维数据集添加新属性并仅处理此属性而无需多维数据集原始数据源？

当我将属性添加到 SSAS 多维数据集和进程时，我对幕后发生的事情没有很好的理解，我不能说这是否可能。我可以想象，多维数据集可能在它可以工作的数据源的内存中有一个快照。我也可以想象这将是非常低效的，所以这有可能是不可能的

编辑：至少添加一个使用多维数据集中现有数据的计算成员似乎是可行的。

我还应该提到，我尝试向这样的多维数据集添加属性并收到错误：

> "Dimension [Partner] cannot be saved File system error failed to copy file C:\\MYSQLSERVER\OLAP\DATA\2013_Cube.db\\.dim\.dstore 到 C:\\MYSQLSERVER\OLAP\DATA\2013_Cube.db\ \.dim\.dstore 文件存在”

抱歉，我稍微伪造了这些文件路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T02:14:42.843

这项任务非常艰巨。我能想象的唯一方法是根据数据源视图手动重建原始数据库（它具有缓存的元数据），然后尝试使用 SSAS 查询工具（例如 Excel、SSRS、OLE DB）生成数据以填充它分析服务提供商）。

如果您想在一个维度中添加一个属性，您可以将这项工作限制在相关维度的源数据上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T15:09:32.950

首先让我根据流程的步骤来解释立方体是如何存储数据的！！！

1.  获取数据源 - 数据！！！那就是访问原始数据库/文件等。此时所有数据都在主要来源。所有数据都以一种或另一种方式标准化。
2.  构建数据仓库。ELT 过程。此时，您将所有数据组合在一个非规范化的仓库中，没有外键或任何约束。所有数据现在都处于非规范化 sql 数据库中的中间状态，并准备好在多维数据集中使用。
3.  构造 OLAP 多维数据集。数据仓库现在是您的数据源。现在，所有数据都在多维数据集中的行中与其对应的值聚合在一起。冗余是巨大的，数据是 100% 非规范化的，它们几乎不遵循模式（当然它们这样做，但并不总是容易理解）。

这种状态的一个例子是这样的一行

```
Company -> Department -> Room | Value(Employees)
ET LTD  -> IT -> Room 4 -> | 4 
```

Value(Revenue) 将存在完全相同的行。所以本质上所有数据都存在于 SSAS 数据库（多维数据集）中。重建数据库意味着大量的**逆向**工程。

您可以创建一个新的 C# 程序，使用 MDX 连接器和查询来获取数据，并使用 MSsql 连接器将它们保存在 OLTP 数据库中。MDX 的学习曲线陡峭，网站上的引用很少，因此不建议使用上述方法。

我不知道如何从 excel 中获取数据，因为 excel 以动态方式从 DataConnection 中获取数据透视表数据。

# python - Appengine SDK 1.7.3 未检测到更新的文件

> ID：13148512
> 
> 赞同：3
> 
> 时间：2012-10-30T22:29:59.727
> 
> 标签：python, google-app-engine

我刚刚更新到在 Linux 上运行的 SDK 1.7.3。同时，我根据折旧消息的建议切换到 SQLite 数据存储存根。

在此之后，并不总是检测到对源文件的编辑，并且我必须在更新后停止并重新启动 SDK，大概十分之一。还有人看到这个吗？关于如何防止它的任何想法？

更新：未检测到对*python源文件的更改。*我没有对yaml文件进行任何修改，我相信jinja2模板文件修改被正确检测到。

更新：我向开发应用服务器添加了一些日志记录，发现我正在编辑的文件没有被监控。继续追踪正在发生的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T02:36:06.213

SDK 1.73 中的 appcfg.py 也会出现类似的问题，它有时会跳过上传一些文件。看起来只有当 appcfg.py 在 python 2.7 下运行时才会发生这种情况。解决方法是在 python 2.5 下简单地运行 appcfg.py。然后上传工作可靠。上传的代码仍然可以是 2.7 特定的 - 只需在 appcfg.py 中运行上传器功能的步骤中恢复 2.5。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T10:17:52.150

在 1.7.3 更新之后，我在 Mac 上也看到了这一点。我没有对数据存储进行任何更改。我会说十分之一是正确的。

编辑：

这里有一个解决方案，涉及将“self._dirty = True”添加到 google/appengine/tools/dev_appserver.py

[http://code.google.com/p/googleappengine/issues/detail?id=8383](http://code.google.com/p/googleappengine/issues/detail?id=8383)

似乎对某些人有用，从那以后就没有看到问题了。

# c++ - std::map 是否要求比较器的 operator() 为 const？

> ID：13148513
> 
> 赞同：15
> 
> 时间：2012-10-30T22:30:00.753
> 
> 标签：c++, libc++

在 OS X 10.8 上使用 libc++ 时，以下代码无法使用 XCode 4.5 的 clang++ 编译：

```
#include <map>
#include <string>

class Foo {
public:
  explicit Foo(int val_) : val(val_) {}
  int val;
};

struct FooComparator {
  bool operator()(const Foo& left, const Foo& right) {
    return left.val < right.val;
  }
};

int main(int argc, char* argv[]) {

  std::map<Foo, std::string, FooComparator> m;

  Foo f(4);
  m[f] = std::string("four");

  return 0;
} 
```

错误：

> broken.cpp:11:8：注意：候选函数不可行：“this”参数的类型为“const FooComparator”，但方法未标记为 const bool operator()(const Foo& left, const Foo& right) {

如果我关闭 libc++ 并使用 libstdc++ 构建，那么一切都很好。显然，我可以通过将 FooComparator::operator() 设为 const 来解决这个问题，但我想了解这是否是 libc++ 过于严格的问题，或者标准（C++03 和 C++11 ) 实际上确实要求比较器的 operator() 是 const （在这种情况下，它与 libstdc++ 一起工作的事实是一个幸运的意外）。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-30T22:36:27.023

嗯，是的：比较器是映射本身的子对象，以某种方式或另一种方式（可能是成员；通常是某个内部实现类的基类）。如果您对地图有一个常量引用，则比较器仍然需要可用于查找，因此运算符需要是`const`.

# html - 如何实现悬停时滚动内容的固定宽度div？

> ID：13148522
> 
> 赞同：0
> 
> 时间：2012-10-30T22:30:51.087
> 
> 标签：html, firefox, css, overflow, css-transitions

我正在尝试创建一个包含 2 个 div 的 div：一个用于封面 img，另一个 div 带有一些文本。我很想只显示图像并在悬停时将其移开以显示文本。我使用绝对定位和 css 转换编写了这段代码，但出现了问题。

它在 Chrome 中运行良好，但在 Firefox 中却不行。

[http://jsfiddle.net/5NHh2/4/](http://jsfiddle.net/5NHh2/4/)

有人可以帮助我吗？我认为问题是溢出：隐藏设置为主 div。

非常感谢

这是html代码：

```
<div class="container">
<div class="info-box">
    <a href="#" title="">
        <div class="cover">
            <img src="http://placehold.it/180x267" />
        </div>
        <div class="info">
            <h5>A Title</h5>
            <p>Some text</p>
        </div>
    </a>
</div>
<div>​ 
```

这是CSS：

```
 .container {
        background:#000;
        text-align:center;
        padding:10px;
    }
    .info-box{
        text-align:left;
        overflow:hidden;
        position:relative;
        background:#ddd;
        display:inline-table;
        margin:0 10px 10px;
    }
    .info-box,
    .info-box img,
    .info-box .cover {
        width:180px;
        height:267px;
    }
    .info-box a {
        text-decoration:none;
        color:#333;
        display:block;
        position:absolute;
        top:0;
        left:0;
        width:180px;
        height:534px;
        -webkit-transition: all 0.3s ease-out;
        -moz-transition: all 0.3s ease-out;
        -o-transition: all 0.3s ease-out;
        transition: all 0.3s ease-out;
    }
    .info-box .info {
        box-shadow:inset 0 0 2px #000;
    }
    .info-box a:hover{
        top:-267px;
    }
    .info-box .info {
        width:160px;
        height:247px;
        padding:10px;
        position:relative;
    }
    .info {
        text-shadow:0 1px 0 #fff;
    }
    .info-box .info h5 {
        font-family:'Trebuchet MS',Arial,sans-serif;
        overflow:hidden;
        white-space:nowrap;
        text-overflow:ellipsis;
        margin-bottom:10px;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:38:53.393

补充`.container, .info-box {overflow:hidden;}`到最后。

在这里为我在 Firefox 中工作：http: [//jsfiddle.net/5NHh2/5/](http://jsfiddle.net/5NHh2/5/)

# jquery - 用jquery隐藏元素

> ID：13148524
> 
> 赞同：1
> 
> 时间：2012-10-30T22:31:00.260
> 
> 标签：jquery

有人可以告诉我这个 jquery 代码是否有意义。我把它包装在一个文档就绪块中。如果条件集为真，我试图隐藏一个元素，但是当我单击提交按钮时，知道确实选中了一个复选框，该元素出现而不是被隐藏。下面的代码有什么明显的我遗漏的地方：

```
 $('#submit').on('click', function() {
            if ($('#Option1').not(':checked') &&
            $('#Option2').not(':checked') &&
            $('#Option3').not(':checked') &&
            $('#Option4').not(':checked') &&
            $('#Option5').not(':checked')) {
                $("form").submit(function () {
                    return false;
                });
                $('#selectOption').show();
            } else {
                $('#selectOption').hide();
            }
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:34:20.883

提交表单时隐藏或显示任何内容确实没有用，因为它无论如何都会重定向页面。我会做这样的事情并检查是否选中了 ID 以 Option 开头的任何框，然后如果没有选中任何框等，则阻止单击：

```
$('#submit').on('click', function(e) {
    if (!$('[id^="Option"]').is(':checked')) {
         e.preventDefault();
         $('#selectOption').show();
    }
}); 
```

# javascript - localStorage.getItem('foo') 和 localStorage['foo'] 有区别吗

> ID：13148528
> 
> 赞同：3
> 
> 时间：2012-10-30T22:31:30.157
> 
> 标签：javascript, html

> **可能重复：**
> [localStorage.getItem('item') 是否优于 localStorage.item 或 localStorage['item']？](https://stackoverflow.com/questions/12632463/is-localstorage-getitemitem-better-than-localstorage-item-or-localstoragei)

在学习 localStorage 时，我注意到可以使用数组访问器表示法从 localStorage 设置和检索值。对于以这种方式使用 localStorage 是不好的还是可以接受的做法，我还没有找到任何超级结论。

```
var foo = localStorage.getItem('Foo'); 
```

或者

```
var foo = localStorage['Foo']; 
```

相似地，

```
localStorage.setItem('Foo', foo); 
```

或者

```
localStorage['Foo'] = foo; 
```

有什么陷阱吗？还是我可以自由使用较短的语法？

# https - 让 GraphicsMagick 从 https url 打开文件？

> ID：13148536
> 
> 赞同：4
> 
> 时间：2012-10-30T22:32:30.837
> 
> 标签：https, graphicsmagick

我可以使用 GraphicsMagick 下载给定 URL 的图像，但是当 URL 以 https 开头时，我收到以下错误（对于[https://example.com/image.png](https://example.com/image.png)）：

```
Unable to open file (//example.com/image.png) [No such file or directory]. 
```

我正在使用`gm`node.js 的驱动程序，代码如下：

```
gm = require('gm');
gm(url).write(name); 
```

但也曾`gm`直接从命令行尝试过同样的问题。

如前所述，它适用于 http URL，我可以让它适用于 https 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T03:10:40.330

GraphicsMagick 使用 libxml2 的 HTTP 支持，目前不支持 HTTPS。尝试使用诸如“wget”或“curl”（使用 OpenSSL 支持 HTTPS）之类的外部程序来检索文件。然后您可以将返回的文件传递给 GraphicsMagick。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-24T02:18:38.350

正如 Bob 所说，HTTPS 仍然不受支持，但是：

使用 https 模块，您可以创建一个缓冲区并将其直接输入到 GraphicsMagick。

```
https.get('https://www.eff.org/files/https-everywhere2.jpg', function(response) {

    gm(response, 'image.jpg')
        .write('test.jpg', function(err) {
            if (err) return handle(err);
            console.log('Created an image from a Buffer!');
        });
}); 
```

# .net - SOAP 存根未序列化

> ID：13148540
> 
> 赞同：0
> 
> 时间：2012-10-30T22:33:00.150
> 
> 标签：.net, soap, cisco

我正在尝试将名为 numOfResults 的`SOAP`属性序列化为消息属性，但是当我在`Wireshark`. 我已经更改了名称并且它做得很好，我什至重新创建了它，重新命名它为其他名称并序列化，但是一旦我称它为“numOfResults”它就没有。请注意，这是在生成的存根中，该存根是前一段时间从 WSDL 生成的（在 .NET 2 中），我无法访问架构或 .wsdl 来生成新的存根。

不幸的是，该服务正在与一个封闭的盒子进行通信，因此我无法更改另一端的属性名称。我已经重建了项目`.NET 2.0`并`.NET 4.5`得到了相同的结果。该程序也已在`Windows 8`和上运行`Winserver 2008`，结果也相同。

我想知道“numOfResults”是否是框架内部某处的保留字。

否则对我下一步应该尝试什么或问题可能是什么有任何想法？

问候

标记

# javascript - JavaScript - 打开新页面并在其中搜索

> ID：13148543
> 
> 赞同：2
> 
> 时间：2012-10-30T22:33:24.457
> 
> 标签：javascript, search, window, find, window.open

我没有在 JavaScript 中做过任何编程，所以我什至不确定我是否走在正确的轨道上。理想情况下，我想要的是打开多个窗口，在它们中搜索特定字符串，然后关闭那些找不到该字符串的窗口。

此功能只是在一个新窗口中处理一页。它打开的页面确实包含我正在寻找的单词，但是当我运行它时，返回找不到字符串。

```
function open_win() {
    var wnd = window.open("http://www.bartleby.com/123/32.html");

    if (wnd.find("morning")){
        alert("string found");
    }
    else{
        alert("string not found");
    }
} 
```

我修改了这段代码以包含延迟以让页面加载，但现在搜索功能似乎不起作用。警报永远不会出现。

```
function open_win() {
var wnd = window.open("http://www.bartleby.com/123/32.html");

setTimeout(function(){

    if (wnd.find("morning"))
    {
        alert("string found");
    }
    else
    {
        alert("string not found");
    }
},3000);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:40:19.590

窗口在打开时不包含任何内容。您需要等待它加载。类似的东西

```
function open_win() {
  var wnd = window.open("http://www.bartleby.com/123/32.html");

  wnd.addEventListener("load",function(){
    if (wnd.find("morning")){
      alert("string found");
    }
    else{
      alert("string not found");
    }
  }
} 
```

# java - Java JVM 是否执行任何专业化或部分评估类型优化？

> ID：13148544
> 
> 赞同：2
> 
> 时间：2012-10-30T22:33:24.533
> 
> 标签：java, performance, optimization

是否有任何 Java JVM 实现了专门化或部分评估类型优化？

final 关键字是否用于这些优化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:42:17.380

在运行时是的。事实上，所有已知的 JVM 风格都可以做到这一点。[即时 (JIT) 编译器有什么作用？](https://stackoverflow.com/questions/95635/what-does-a-just-in-time-jit-compiler-do)

在最终关键字上

[java final 是否有助于编译器创建更高效​​的字节码？](https://stackoverflow.com/questions/8354412/do-java-finals-help-the-compiler-create-more-efficient-bytecode)

希望我的问题是正确的。

# c# - .Net 中位的表示及其序列化

> ID：13148546
> 
> 赞同：0
> 
> 时间：2012-10-30T22:33:40.000
> 
> 标签：c#, serialization, deserialization, ntp, osi

我正在练习实现一些基本的第 7 层协议，但我不确定在 .Net 框架中序列化和反序列化位的最佳方式。

根据[MSDN Data Type Summary](http://msdn.microsoft.com/en-us/library/47zceaw7%28v=vs.71%29.aspx)，没有位数据类型。我不知道如何创建这样的数据类型，或者即使有可能，所以我只剩下序列化/反序列化为字节/字节数组。

给定以下来自 NTP 数据包顶部的示例：

```
 0-1         LeapIndicator (LI)      2 bits
     2-4         VersionNumber (VN)      3 bits
     5-7         Mode                    3 bits
     8-15        Stratum                 8 bits 
```

我想编码成 2 个字节，这样我就可以通过套接字发送。

另外，我目前正在使用整数来表示枚举中的位，是否可以使用位/十六进制或比整数更好的东西？例如模式枚举定义如下：

```
public enum Mode
{
    /*
     +-------+--------------------------+
     | Value | Meaning                  |
     +-------+--------------------------+
     | 0     | reserved                 |
     | 1     | symmetric active         |
     | 2     | symmetric passive        |
     | 3     | client                   |
     | 4     | server                   |
     | 5     | broadcast                |
     | 6     | NTP control message      |
     | 7     | reserved for private use |
     +-------+--------------------------+
     */

    Resevered = 0,
    SymmetricActive = 1,
    SymmetricPassive = 2,
    Client = 3,
    Server = 4,
    Broadcast = 5,
    ControlMessage = 6,
    PrivateUse = 7
} 
```

旁注：该项目的代码最终将开源，如果您回答，请记住。如果您不希望共享代码，请说 :) 将在代码中放置一个指向此问题的链接。

提前致谢 ：）

更新：如果人们想知道 NTP 数据包结构是什么样的，直接取自[RFC 5905，第 18 页](http://www.ietf.org/rfc/rfc5905.txt)

```
 0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |LI | VN  |Mode |    Stratum     |     Poll      |  Precision   |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                         Root Delay                            |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                         Root Dispersion                       |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                          Reference ID                         |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                                                               |
        +                     Reference Timestamp (64)                  +
        |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                                                               |
        +                      Origin Timestamp (64)                    +
        |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                                                               |
        +                      Receive Timestamp (64)                   +
        |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                                                               |
        +                      Transmit Timestamp (64)                  +
        |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                                                               |
        .                                                               .
        .                    Extension Field 1 (variable)               .
        .                                                               .
        |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                                                               |
        .                                                               .
        .                    Extension Field 2 (variable)               .
        .                                                               .
        |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                          Key Identifier                       |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                                                               |
        |                            dgst (128)                         |
        |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T07:01:53.580

我认为我根本不会在这里使用枚举。我可能会创建一个结构来表示数据包头，将数据存储在`ushort`（16 位）中：

```
public struct NtpHeader
{
    private readonly ushort bits;

    // Creates a header from a portion of a byte array, e.g
    // given a complete packet and the index within it
    public NtpHeader(byte[] data, int index)
    {
        bits = (ushort) (data[index] + (data[index] << 8));
    }

    public NtpHeader(int leapIndicator, int versionNumber,
                     int mode, int stratum)
    {
        // TODO: Validation
        bits = (ushort) (leapIndicator |
                         (versionNumber << 2) |
                         (mode << 5) |
                         (stratum << 8));
    }

    public int LeapIndicator { get { return bits & 3; } }

    public int VersionNumber { get { return (bits >> 2) & 7; } }

    public int Mode { get { return (bits >> 5) & 7; } }

    public int Stratum { get { return bits >> 8; } }
} 
```

不过，您需要检查一下 - 目前尚不清楚 RFC 中真正表示的位排列。如果您有具有预期值的样本数据包，那会让事情变得更加清晰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T23:33:10.150

仅供参考，在 .NET 中有一个代表位的结构，它是`System.Boolean`. 正如 Marc 所提到的，该协议以偶数字节为单位，因此您可以使用 int（每个 int 保存 32 位），或使用位掩码样式的枚举。无论哪种方式，您都可以使用`System.BitConverter`的静态方法与字节数组进行转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T02:25:50.883

您是否考虑过使用 Flags 属性？它允许您将枚举类型值视为位而不是整数：http: [//msdn.microsoft.com/en-us/library/system.flagsattribute.aspx](http://msdn.microsoft.com/en-us/library/system.flagsattribute.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T07:26:05.593

c# 中枚举的最小类型是字节（其他可用类型在此处解释[http://msdn.microsoft.com/en-us/library/sbbt4032.aspx](http://msdn.microsoft.com/en-us/library/sbbt4032.aspx)）。定义一个字节类型的枚举：

```
enum Name:byte{} 
```

在你的例子中：

```
public enum Mode:byte
{
    /*
     +-------+--------------------------+
     | Value | Meaning                  |
     +-------+--------------------------+
     | 0     | reserved                 |
     | 1     | symmetric active         |
     | 2     | symmetric passive        |
     | 3     | client                   |
     | 4     | server                   |
     | 5     | broadcast                |
     | 6     | NTP control message      |
     | 7     | reserved for private use |
     +-------+--------------------------+
     */

    Resevered = 0,
    SymmetricActive = 1,
    SymmetricPassive = 2,
    Client = 3,
    Server = 4,
    Broadcast = 5,
    ControlMessage = 6,
    PrivateUse = 7
} 
```

如果我们希望节省空间但可读性较差，我们可以看到 sizeof(LeapIndicator) + sizeof(VersionNumber) + sizeof(Mode) = 8 bits = 1 byte。还有 sizeof(Sratum) = 8 bits = 1 byte。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-08T17:52:49.103

序列化：要将您的数据包字段放入结果中，只需将 2（左移）乘以适当的位数，然后与到目前为止的累积结果相乘。

反序列化：要从结果中提取数据包字段，只需使用 AND 位掩码，然后除以 2（右移）除以适当的位数。

# maven - Maven 和依赖项

> ID：13148547
> 
> 赞同：1
> 
> 时间：2012-10-30T22:33:49.387
> 
> 标签：maven

我有一个像这样的简单 POM：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

<modelVersion>4.0.0</modelVersion>
<groupId>com.sim</groupId>
<artifactId>log4j</artifactId>
<version>0.0.1-SNAPSHOT</version>
<packaging>jar</packaging>

<parent>
    <groupId>com.sim</groupId>
    <artifactId>sim-java</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <relativePath>../sim-java/pom.xml</relativePath>
</parent>

<name>log4j</name>

<dependencies>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.17</version>
        <scope>compile</scope>
    </dependency>       
</dependencies> 
```

我`mvn clean package`在这个项目上运行，并按预期创建了一个 JAR。

当我导航到这个 JAR 时，我以为我会在其中看到一个名为 log4j-1.2.17.jar 的 JAR，但事实并非如此。

使用具有编译范围的依赖项不会将 JAR 包含到项目的打包版本中？

谢谢你的澄清

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T22:51:23.350

maven的`jar:jar`插件只是编译你的源代码并将其捆绑到一个 jar 中。就像用 ant 或徒手构建 jar 一样，jar 中不会捆绑任何依赖 jar。jar 不能在其中捆绑依赖的 jar，即使有，它们也不能被默认的类加载器加载。

如果您正在寻找构建一个 ejb-jar，那么您可能需要考虑一个[EJB 插件](http://maven.apache.org/plugins/maven-ejb-plugin/ejb-mojo.html)

检查[此](http://maven.apache.org/plugins/index.html)链接以获取您可以利用的各种插件。

# php - 具有多个分隔符的 PHP 数组

> ID：13148555
> 
> 赞同：1
> 
> 时间：2012-10-30T22:34:22.317
> 
> 标签：php, arrays, explode

> **可能的重复：**
> [使用 PHP 进行 JSON 解析](https://stackoverflow.com/questions/7889738/json-parsing-with-php)

我希望能在这方面提供一点帮助。我试图获取`$data`变量中的内容：

```
[{"Product":"Internal",
  "Rank":"1",
  "Number":"1234"},
 {"Product":"External",
 "Rank":"1",
 "Number":"5678"}] 
```

并将其转换为如下所示的关联数组：

```
Product[0] => Internal,
Rank[0] => 1,
Number[0] => 1234,
Product[1] => External,
Rank[1]  => 1,
Number[1] => 5678 
```

我能得到的最接近的是使用以下代码：

```
$del='/[{: ,}]/';
$data = preg_split($del,$data);
print_r($data); 
```

这给了我这样的东西：

> 数组 ( [0] => [ [1] => "产品" [2] => "1 [3] => 1" [4] => "排名" [5] => "1"

任何建议将不胜感激。谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:37:38.490

首先，使用`json_decode($data,TRUE)`，这会让你的生活更轻松，给你很好的数组来转换你想要的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:37:51.737

如果你知道它`$data`是 JSON 格式，你可以这样做：

```
$data = json_decode($data); 
```

然后你想遍历对象数组并变形它们：

```
$output = array();
foreach($data as $index=>$object) {
    foreach($object as $name=>$value) {
        $output[$name][$index] = $value;
    }
} 
```

# ckeditor - 单击 CKEditor 中的链接按钮时，CKFinder 将默认视图设置更改为列表

> ID：13148556
> 
> 赞同：1
> 
> 时间：2012-10-30T22:34:31.513
> 
> 标签：ckeditor, ckfinder

当有人单击CKEditor上的链接时，我正在尝试将默认视图设置为列表。我已经用 CKEditor 配置了 CKFinder。所以现在当我在 CKEditor 中单击链接时，我会看到一个浏览按钮和`onclick`浏览按钮，它会将我带到文件列表。但它在那里将图像显示为缩略图。我想将其显示为“列表”。只有当我单击 CKEditor 中的链接时，我才应该这样做。如果我单击图像，它应该向我显示缩略图。

以下是我创建 CKEditor 并将其与我的 CKFinder 关联的方式。

```
function createCkEditor(textAreaId, width, height) {
    var editor = CKEDITOR.replace( textAreaId,
        {
            customConfig : 'suConfig.js',
            width : width,
            height : height
        });

    CKFinder.setupCKEditor( editor, { basePath : '/CKFinderJava/ckfinder/', id:'123', startupPath : varStartupDir, startupFolderExpanded : true, rememberLastFolder : false} ) ;
}

CKEDITOR.on( 'dialogDefinition', function( ev ) {
    // Take the dialog name and its definition from the event data.
    var dialogName = ev.data.name;
    var dialogDefinition = ev.data.definition;

    // If "Link" dialog
    if ( dialogName == 'link' ) {
        alert('link dialog clicked');
        // Remove extraneous tabs
        dialogDefinition.removeContents( 'target' );
        dialogDefinition.removeContents( 'advanced' );

        // Set default URL
        var infoTab = dialogDefinition.getContents( 'info' );
        var urlField = infoTab.get( 'url' );
        urlField['default'] = contentUrl;
    }

    // If "Image" dialog
    if ( dialogName == 'image' ) {
        // Remove extraneous tabs
        dialogDefinition.removeContents( 'Link' );
        dialogDefinition.removeContents( 'advanced' );

        // Set default URL
        var infoTab = dialogDefinition.getContents( 'info' );
        var urlField = infoTab.get( 'txtUrl' );
        urlField['default'] = contentUrl;
    }
}); 
```

`CKEditor.on`如果您单击 CKEditor 中的选项，将调用。我不确定如何获取与当前编辑器关联的 CKFinder 实例并将默认视图设置为列表。我正在使用 JavaScript 和 JSP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T23:40:27.383

我确实找到了解决方案。

在 CKFinderJava.war/ckfinder 目录下的 config.js 中进行必要的配置。config.defaultViewType_Images = '缩略图'; config.defaultViewType_Files = '列表'; 这是来自 ckeditor 的图像和链接的设置。如果您希望所有显示都作为列表，那么 config.defaultViewType = 'list';

# ios - 我会发布一个未完成的应用程序吗？

> ID：13148557
> 
> 赞同：0
> 
> 时间：2012-10-30T22:34:34.440
> 
> 标签：ios

所以我要做一个应用程序。它将有大约 100 个食谱，到目前为止我只做了 4 个。我需要明天将它提交到 App Store。

我的问题是，如果我到那时还没有完成，我可以只抛光我拥有的然后提交它吗？Apple 或我的客户会讨厌我的客户吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:40:03.730

在软件开发中，发布没有几个已知缺陷的应用程序是非常罕见的，只要这些缺陷对应用程序本身的功能不是至关重要的。这就是存在版本化版本的原因。话虽如此，除非您通过客户声明清楚地了解客户的需求，否则可能很难确定您的客户是否会以积极的方式做出回应。

如果你正处于紧缩状态，那就擦亮你所拥有的东西，确保它有效，然后交叉手指。您的另一个选择是请求推迟发布日期。

100 人中有 4 人可能不会削减它。:P

# knockout.js - KnockoutJs - 模板中的子 observableArray

> ID：13148559
> 
> 赞同：1
> 
> 时间：2012-10-30T22:34:50.290
> 
> 标签：knockout.js

我是 KnockoutJs 的新手，我试图理解错误“**无法解析绑定。消息：ReferenceError：未定义项目；绑定值：foreach：项目**”推送到 observableArray 时。

下面是 jsFiddle 中的相同代码：http: [//jsfiddle.net/TheMetalDog/yYAFJ/](http://jsfiddle.net/TheMetalDog/yYAFJ/)

`viewModel.items()[0].childItems.push(newItem);`单击“添加子项”按钮时会发生错误。

html:

```
<div data-bind="template: { name: 'tmpl-item-list' }"></div>
<button type="button" class="add">Add</button>
<button type="button" class="addChild">Add Child</button>

<div class="error"></div>
<script type="text/html" id="tmpl-item-list">
    <ul data-bind="foreach: items">
        <li>
            <span data-bind="text: name"></span>
            <div data-bind="template: {foreach: childItems, name: 'tmpl-item-list'}">    </div>
        </li>
    </ul>
</script>​ 
```

JS：

```
var viewModel = {}, i = 5;

viewModel.items = ko.observableArray([]);
viewModel.items.push({name: '1', childItems: ko.observableArray([])});
viewModel.items.push({name: '2', childItems: ko.observableArray([])});
viewModel.items.push({name: '3', childItems: ko.observableArray([])});
viewModel.items.push({name: '4', childItems: ko.observableArray([])});

$('button.add').click(function(){
    var newItem = {name: i, childItems: ko.observableArray([])};
    viewModel.items.push(newItem);
    i++;
});

$('button.addChild').click(function(){
    try{
        var newItem = {name: i, childItems: ko.observableArray([])};
        viewModel.items()[0].childItems.push(newItem); 
        i++;
    }catch(e){
        console.log('error', e);
        $('.error').append(e.message + '<br />');
    }
});

ko.applyBindings(viewModel); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:55:08.537

问题是您的模板正在循环，并且您正在通过该模板`items`发送每个项目。`childItems`

另一种方法是`foreach`在您最初调用模板而不是`items`在模板内执行循环时使用。

因此，您的原始绑定可能如下所示：

```
<div>
   <ul data-bind="template: { name: 'tmpl-item-list', foreach: items }">
    </ul>
</div> 
```

您的模板如下所示：

```
<script type="text/html" id="tmpl-item-list">
        <li>
            <span data-bind="text: name"></span>
            <div data-bind="template: {foreach: childItems, name: 'tmpl-item-list'}"></div>
        </li>
</script>​ 
```

示例：http: [//jsfiddle.net/rniemeyer/yYAFJ/7/](http://jsfiddle.net/rniemeyer/yYAFJ/7/)

# ajax - 无效的 ssl 证书会导致某些帖子在 Firefox 中通过 ajax 失败吗？

> ID：13148561
> 
> 赞同：0
> 
> 时间：2012-10-30T22:34:58.113
> 
> 标签：ajax, firefox, ssl

我想知道无效或过期的 SSL 证书是否会导致通过 Firefox 的一些 ajax 帖子失败（不是所有的 ajax 帖子，有些是成功的）？我正在尝试确定我通过 firefox 的 ajax 请求被中止的原因（并且在其他浏览器中看不到）。如果我使用 Fiddler，该帖子也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T01:40:06.913

是的，尝试使用 XHR 请求连接到具有无效证书（无论出于何种原因）的 HTTPS 站点将使该请求失败。与直接请求不同，它将无法显示通常的证书警告消息来询问您是否要继续。

# python - 在 Python 中删除列表的最后一个元素失败

> ID：13148565
> 
> 赞同：4
> 
> 时间：2012-10-30T22:35:06.467
> 
> 标签：python, list, dictionary

我正在尝试删除 Python 中列表的最后一个元素：

```
di = {"a": 3, "children": [{"b": 5}, {"c": 6}]}
for el in di['children']:
  di['children'].remove(el) 
```

我期望的是

```
print di
{'a': 3, 'children: []} 
```

但我得到的是

```
print di
{'a': 3, 'children': [{'c': 6}]} 
```

有人知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-30T22:42:56.753

正如其他人所解释的那样，您不能在迭代列表时修改它。

您可以在迭代列表的副本时修改列表，但最好只生成一个新的过滤列表：

```
di = {"a": 3, "children": [{"b": 5}, {"c": 6}]}
di['children'] = [el for el in di['children'] if el not in di['children']] 
```

为什么这样更好？好吧，这意味着您正在避免更改列表，这使您的代码更易于推理，更易于跟踪，通常更易于编写，并且通常更快且更节省空间。您不必担心迭代时变异问题的事实是“更容易推理”部分的完美示例。

在某些情况下，它确实变得更难编写，或者速度更慢，或者空间效率更低，这就是为什么这只是一个指导而不是硬性规则。但至少总是值得思考“我可以将其重写为不可变过滤器而不是突变器吗”，即使答案有时可能会变成“否”。

真的，你的算法不能保证等同于清空整个东西吗？在这种情况下：

```
di = {"a": 3, "children": [{"b": 5}, {"c": 6}]}
di['children'] = [] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-30T22:37:29.087

您不应该在迭代列表时修改它。相反，您应该迭代副本。请参阅[python 文档](http://docs.python.org/2/tutorial/controlflow.html#for-statements)。

试试这个...

```
di = {"a": 3, "children": [{"b": 5}, {"c": 6}]}
for el in di['children'][:]:
    di['children'].remove(el) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-30T22:40:08.820

您在迭代列表时正在修改列表 - 当您删除第一个条目时，第二个条目将成为第一个条目并且已到达列表的末尾。相反，使用：

```
del di["children"][:] 
```

这将保留原始列表（与 不同`di["children"] = []`），因此如果您对它们有其他引用，它们也会反映截断。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-30T22:44:02.170

当您向后浏览列表时，您只能删除循环中的元素。

所以我认为只需像这样将 di['children'] 包装在 reversed() 迭代器中

```
for el in reversed(di['children']): 
```

这是因为删除元素会导致元素的编号发生变化，并且所有后续元素的数字都会减1。但是，如果您向后退，则不应该关心后续元素的索引，而只关心删除之前的元素。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-30T22:38:06.573

您在迭代列表时正在修改列表，这是一个坏主意。

尝试迭代列表的副本，同时从原始列表中删除元素。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-01T21:06:32.727

```
del di['children'][1] 
```

删除列表中的最后一个元素。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-31T14:21:16.300

```
 for i in di:
    if type(di[i])==list:
       di[i]=[] 
```

# jsf - 在验证错误的情况下取消按钮不起作用

> ID：13148566
> 
> 赞同：0
> 
> 时间：2012-10-30T22:35:15.280
> 
> 标签：jsf, jsf-2

我有一个表单，其中包含一些具有验证的输入（必需 = true），当我在出现验证错误的情况下单击取消按钮时，取消按钮不会导航到上一页，而是删除验证错误（我认为它回到验证错误之前的一步？）

这是我的代码：

```
<h:form>

<h:inputText value="#{myBean.nickName}" id="nickname" required="true"
requiredMessage="nickname should be specified" />

<h:commandLink immediate="true" id="cancel_link" onclick="history.back(); return false" style="float: left;margin: 118px 189px 0 0;">
 <h:graphicImage width="90" height="28" value="#{resource['images:blu_btnCancel.png']}" />
</h:commandLink>

</h:form> 
```

请告知如何解决。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T00:19:45.480

JavaScript`history.back()`函数将您带到上一个同步请求，而不是您似乎期望的上一个视图。

尽管`history.back()`这种方式很糟糕（不可靠、可破解等），但快速解决方法是在表单提交时发送 ajax 请求而不是同步请求。

```
<h:form>
    ...
    <h:commandButton value="submit">
        <f:ajax execute="@form" render="@form" />
    </h:commandButton>
</h:form> 
```

Ajax 请求不计入浏览器历史记录。

更健壮的方法是在导航期间仅传递前一个视图的标识符，然后用于`<h:link>`链接回它。例如

```
<h:link value="Go to next view" outcome="nextview">
    <f:param name="from" value="#{view.viewId}" />
<h:link> 
```

然后在`nextview.xhtml`

```
<f:metadata>
    <f:viewParam name="from" />
</f:metadata>

...

<h:link ... outcome="#{from}" rendered="#{not empty from}">
    <h:graphicImage ... />
</h:link> 
```

如果您通过 POST 导航，您可能会考虑使用 flash 范围来记住初始视图。

* * *

**与具体问题**无关**`<h:graphicImage>`，使用JSF2 资源的正确方法是只使用它的`name`属性而不是它的`value`属性，`#{resource}`这很笨拙。**

 **代替

```
<h:graphicImage width="90" height="28" value="#{resource['images:blu_btnCancel.png']}" /> 
```

经过

```
<h:graphicImage name="images/blu_btnCancel.png" width="90" height="28" /> 
```

请注意，`images`这里的库名只是被路径名替换了。使用名称“图像”作为库名称是非常值得怀疑的。另请参阅[JSF 资源库的用途是什么以及应该如何使用它？](https://stackoverflow.com/questions/11988415/what-is-the-jsf-resource-library-for-and-how-should-it-be-used)**

# php - 为什么将值传递给 PHP 函数然后转义并返回它是不安全的

> ID：13148569
> 
> 赞同：1
> 
> 时间：2012-10-30T22:35:35.727
> 
> 标签：php, mysql, mysqli

我不知道这是否是一个好问题，但今天让我产生了很多疑问。所以我使用了一个 PHP 函数来基本上节省时间和转义值，就像我们`mysql_real_escape()`以前使用的那样，但我被告知这样做实际上很危险，这就是我正在做的事情：

```
function mysql_string_safe($stringtoclean)
{
    $safestring = mysqli_real_escape_string($GLOBALS['confDBLink'],$stringtoclean);
    return $safestring;
} 
```

我现在有疑问..怎么做这些实际上是不安全的？由于我所做的只是向函数发送一个值，然后将其转义到`mysqli_real_escape_string`? （然后当然返回）所以当我真的想转义一个值时，我会做以下事情： `mysql_string_safe($valuetoescape);` 我真的很想知道，不仅因为怀疑，而且还想知道，因为如果这真的像我被告知的那样危险，然后我也会从我的应用程序中删除它。非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T22:40:10.463

本身没有什么不安全的，但是使用准备好的语句/绑定值比显式转义输入更可取。由于以下几个原因，后者可能不安全：

*   您可能忘记转义输入
*   您可能会不小心将相同的输入转义两次

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:41:16.447

我愿意成为告诉你这一切的人并不是指你有一个调用的函数，`mysql_real_escape_string()`而是指你完全在使用这些`mysql_*`函数的事实。您可能已经看到此消息的变体，它解释了为什么您不应该使用这些函数：

[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护，并且已经开始[弃用过程。](http://news.php.net/php.internals/53799)看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T22:49:26.230

根据您的系统中有多少已经在使用 mysqli，我会切换到 PDO：

```
$stmt = $pdo->prepare('SELECT * FROM users WHERE username = :username');
$stmt->bindValue(':username', $_POST['username']);
$stmt->execute();

$row = $stmt->fetch(); 
```

通过绑定如图所示的值，PDO 会为您处理字符转义。这通常被认为是使用 PHP 与数据库交互的改进方式，您可以在此处阅读：http: [//php.net/manual/en/book.pdo.php](http://php.net/manual/en/book.pdo.php)

我知道这并不能严格回答您的问题，我认为这是一个完全不同的解决方案可能有用的情况。

# c# - ASP.NET MVC 3 未显示适当的视图，使用 jquery 调用的操作

> ID：13148577
> 
> 赞同：3
> 
> 时间：2012-10-30T22:36:10.567
> 
> 标签：c#, jquery, asp.net-mvc, entity-framework

我有一个小问题。

我的行动是：

```
 public ViewResult SearchForRooms(int HotelDDL) 
    {

        List<Room> roomsInHotel = bl.ReturnRoomsPerHotel(HotelDDL);

        return View(roomsInHotel);
    } 
```

这是调用该操作的 jquery：

```
<script type="text/javascript" language="javascript">
    $(document).ready(function () {
        $("#HotelDDL").change(function () {

            var text = $("#HotelDDL option:selected").text();
            var value = $("#HotelDDL option:selected").val();
            alert("Selected text=" + text + " Selected value= " + value);

            $.post("/Home/SearchForRooms",
            {
                HotelDDL: $("#HotelDDL option:selected").val() 
            });
        });
    });
</script> 
```

最后，这是应该调用的视图：

```
@model IEnumerable<RoomReservation.Entities.Entities.Room>

@{
    ViewBag.Title = "Search";
}

<h2>Result</h2>

<table>
    <tr>
        <th>
            City
        </th>
        <th>
            Hotel
        </th>
        <th>
            Room label
        </th>
        <th>
            Number of beds
        </th>
        <th>
            Price per night
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelitem=>item.Hotel.City.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Hotel.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.NumberOfBeds)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.PricePerNight)
        </td>
    </tr>
}
</table> 
```

除最终视图渲染外，一切正常（数据库正确返回所有房间）。我试过菲尔的工具，但它没有给我任何可疑的提示：

```
RouteDebug.RouteDebugger.RewriteRoutesForTesting(RouteTable.Routes); 
```

那么，为什么在 jscript 发送它的 post 方法后它没有显示`SearchForRooms()`呢？谢谢

PS如果您需要任何其他代码，请直接说出来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:47:21.543

请注意，执行 ajax 帖子不会像经典帖子那样刷新或重定向页面。

该视图未显示，因为没有放置它的位置。您成功发布，并成功返回视图，但随后什么也不做。如果要显示返回的视图，则必须以某种方式将其附加到 dom。下面是一个常用的方法：

```
<div id="successDiv"></div>
<script type="text/javascript" language="javascript">
 $(document).ready(function () {
    $("#HotelDDL").change(function () {

        var text = $("#HotelDDL option:selected").text();
        var value = $("#HotelDDL option:selected").val();
        alert("Selected text=" + text + " Selected value= " + value);

        $.post("/Home/SearchForRooms",
         {
            HotelDDL: $("#HotelDDL option:selected").val() 
         }, function(result){//add callback for success - result is the returned view
            $("#successDiv").html(result);//place the view inside of the div
        });
    });
 });
</script> 
```

 `* * *

**评论回复**

@TunAntun - 如果您希望视图拥有自己的页面，您应该使用经典帖子。没有办法从 ajax 实现这一点。你可以用javascript做到这一点

```
 $.post("/Home/SearchForRooms",
         {
            HotelDDL: $("#HotelDDL option:selected").val() 
         }, function(result){//add callback for success - result is the returned view
            $("#successDiv").html(result);//place the view inside of the div
        }); 
```

会成为

```
 var postForm = document.createElement("form");
        postForm.setAttribute("method","post");
        postForm.setAttribute("action","/Home/SearchForRooms");
        var postVal = document.createElement("input");
        postVal.setAttribute("type","hidden");
        postVal.setAttribute("name","HotelDDL");
        postVal.setAttribute("value",$("#HotelDDL option:selected").val() );
        postForm.appendChild(postVal);
        document.body.appendChild(postForm);
        $(postForm).submit(); 
```

这将动态发布您想要的帖子。然后在您的控制器中，它将正确重定向或返回视图。强烈建议从`[HttpPost]`您使用`RedirectToAction`的视图返回视图，然后从`[HttpGet]`方法返回视图，以防止刷新重新发布旧数据。`

# django - Django sweetpie 多对多关系 - 在 json 输出中隐藏中间关系

> ID：13148578
> 
> 赞同：4
> 
> 时间：2012-10-30T22:36:12.410
> 
> 标签：django, tastypie

我刚刚开始使用 Tastypie 并试图弄清楚如何按照我的意愿格式化输出（我只对 GET 方法感兴趣）。我有一个可能有多个问题的测验对象，每个问题可能在多个测验中（因此是多对多，而不是一对多） - 但是当有人通过 API 请求测验对象时，我只想返回一个 ( json) 问题数组，我不想/不需要显示中间关系表数据。

一些代码：

模型.py：

```
class Question(models.Model):
    owner = models.ForeignKey(User)
    created_date = models.DateTimeField('date created',default=datetime.now)
    lastupdated_date = models.DateTimeField('date updated',default=datetime.now)
    title = models.CharField(max_length=500)   
    def __unicode__(self):
        return self.title

class Quiz(models.Model):
    owner = models.ForeignKey(User)
    created_date = models.DateTimeField('date created',default=datetime.now)
    lastupdated_date = models.DateTimeField('date updated',default=datetime.now)
    title = models.CharField(max_length=200)
    description = models.TextField(blank=True)
    props = models.TextField(blank=True)
    questions = models.ManyToManyField(Question, through='QuizQuestion')

    def __unicode__(self):
        return self.title

class QuizQuestion(models.Model):
    quiz = models.ForeignKey(Quiz)
    question = models.ForeignKey(Question)
    order = models.IntegerField(default=1) 
```

和资源.py：

```
class QuizResource(ModelResource):
    q = fields.ToManyField('mquiz.api.resources.QuizQuestionResource', 'quizquestion_set', related_name='quiz', full=True)
    class Meta:
        queryset = Quiz.objects.all()
        allowed_methods = ['get']
        fields = ['title', 'id']
        resource_name = 'quiz'
        include_resource_uri = False

class QuizQuestionResource(ModelResource):
    question = fields.ToOneField('mquiz.api.resources.QuestionResource', 'question', full=True)
    class Meta:
        queryset = QuizQuestion.objects.all()
        allowed_methods = ['get']
        include_resource_uri = False

class QuestionResource(ModelResource): 
    class Meta:
        queryset = Question.objects.all()
        allowed_methods = ['get']
        fields = ['title']
        resource_name = 'question'
        include_resource_uri = False 
```

这功能足够好，但不能完全给出我想要的输出。它给了我输出：

```
{
  "id": "1",
  "q": [
    {
      "id": "1",
      "order": 1,
      "question": {
        "title": "What is the capital of Latvia?"
      }
    },
    {
      "id": "2",
      "order": 2,
      "question": {
        "title": "What is the capital of Ethiopia?"
      }
    }
  ],
  "title": "Capitals"
} 
```

但是，我真正想要的是这种格式的输出，因为我不需要显示所有中间表 id/order 字段：

```
{
  "id": "1",
  "q": [
    {
        "title": "What is the capital of Latvia?"
    },
    {
        "title": "What is the capital of Ethiopia?"
    }
  ],
  "title": "Capitals"
} 
```

有没有办法做到这一点？非常感谢任何帮助/指针。

更新：使用这样的自定义序列化程序似乎有效：

```
class QuizJSONSerializer(Serializer):
    json_indent = 2

    def to_json(self, data, options=None):
        options = options or {}
        data = self.to_simple(data, options)
        for question in data['q']:
            del question['id']
            del question['order']
            for qkey, qvalue in question['question'].items():
                question[qkey] = qvalue
            del question['question']
        return simplejson.dumps(data, cls=json.DjangoJSONEncoder,
                sort_keys=True, ensure_ascii=False, indent=self.json_indent) 
```

当然，可能有更通用的编码方式 - 但现在有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:43:35.107

用您自己的代码覆盖资源对象的序列化函数将是一个好方法，但在脱水方法中重构数据包将是一个快速修复

# ios - 在比实际目标更快的设备上测试 iOS 应用程序？

> ID：13148582
> 
> 赞同：0
> 
> 时间：2012-10-30T22:36:23.000
> 
> 标签：ios, testing

我计划拥有第四代 iPad，我不想去寻找第三代，因为它已经停产了 afaik。

是否有框架或类似的东西可以降低软件级别的性能，以便我可以模糊地了解应用程序在功能较弱的设备上的运行速度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:42:25.670

如果有（我认为没有），我不会将它用于现实世界的性能测试。事实上，iPhone / iPad 模拟器根本就不是性能测试的正确工具。它没有相同的处理器、内存等。在测试性能时，您应该使用真实设备进行测试。

# dart - Dart Web Components 教程或示例

> ID：13148584
> 
> 赞同：2
> 
> 时间：2012-10-30T22:36:31.237
> 
> 标签：dart

我真的很喜欢我在 Dart 中看到的 Web 组件。我查看了包含不同示例的网页，并很想尝试一下。

但是，如果我尝试页面上的任何示例（例如 helloworld 示例），只需将其粘贴到我的 dart 编辑器中，它就不起作用。TodoMVC 应用程序可以运行，但所有这些文件似乎很混乱，只是为了运行一个单页应用程序，虽然可以作为一个完全工作的应用程序的一个很好的例子，但它不是一个好的学习起点。

作为 dart 的新手，我不太清楚如何开始自己使用 Web 组件。如果在 Web Components 页面上有一个非常简单的教程，那将更好，向您展示如何从头开始使用 Web 组件创建一个非常简单的应用程序。

即使是 Hello World 应用程序也适用于此目的。

有人有一个很好的例子来说明如何在 dart 中使用 Web 组件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:55:25.963

你读过吗：[http ://www.dartlang.org/articles/dart-web-components/](http://www.dartlang.org/articles/dart-web-components/)

另见：[http ://www.dartlang.org/articles/dart-web-components/tools.html](http://www.dartlang.org/articles/dart-web-components/tools.html)

您可以在此处找到示例代码：[https ://github.com/dart-lang/dart-web-components](https://github.com/dart-lang/dart-web-components)

**更新**：赛斯在这里写了一篇不错的博文：http: [//blog.sethladd.com/2012/11/your-first-web-component-with-dart.html](http://blog.sethladd.com/2012/11/your-first-web-component-with-dart.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T18:19:55.140

我认为您缺少的链接是 build.dart。[请参阅http://www.dartlang.org/articles/dart-web-components/tools.html](http://www.dartlang.org/articles/dart-web-components/tools.html)上标有“编辑器后台编译”的部分。如该页面所述，有几个选项可以编译您的 Web 组件，但我发现 build.dart 是最直接的。

此 build.dart 脚本与一些 SDK 组件交互，因此您需要确保已将路径添加到系统中。在我的 OS X 机器上，我将它添加到我的 ~/.profile 文件中：

```
export PATH=$PATH:/Users/dave/dart/bin 
```

！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T05:04:25.757

我写了一篇关于使用 Dart Web UI 库开始使用 Web 组件的教程。它是相当基础的，如果您之前没有太多使用 Web 组件的经验，它是一个很好的起点。该教程可以在以下位置阅读：

```
http://shailen.github.com/blog/2012/12/31/a-first-app-with-web-components-using-dart/ 
```

您应该下载并运行的代码位于：

```
https://github.com/shailen/bookstore 
```

希望这可以帮助。

# entity-framework - 实体框架 - 添加子实体

> ID：13148585
> 
> 赞同：10
> 
> 时间：2012-10-30T22:36:53.767
> 
> 标签：entity-framework, parent-child

Entity Framework 5.0 代码优先与现有数据库。使用电动工具对课程进行逆向工程。一切都很好。数据库有两个表。一个父母和一个孩子，外键回到父母ID。ID 都是具有自动增量的 int。我添加了许多父记录，现在想将子记录添加到特定的父记录。我能看到的唯一方法是通过在 Parent 表中搜索名称或其他属性并返回 ID 来找到适当的父 ID。然后在添加子项时在外键属性中使用该 ID。我不想创建新的父母，这是将孩子添加到现有父母的唯一方法吗？所有互联网示例似乎都在添加新父级的同时添加了一个子级，而不是向现有父级添加了一个子级。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-31T08:40:25.687

谈到英孚，“朱莉”（勒曼）恰好是我们的一位老师。正如她在*DbContext*一书中解释的那样，父子关联中可能涉及三个属性，两个导航属性（parent.Children、child.Parent）和一个外键属性（child.ParentId）。您可以在代码中设置其中之一或它们的任意组合。

当 EF 被触发以检测更改时（例如，何时`SaveChanges`被调用），它会启动一个称为*关系修复*的过程，以确保三个属性将同步。

因此，您可以通过三个选项将子实体添加到父实体：

1.  `child.Parent = parentObject`. 应首先从数据库中获取父对象。
2.  `parentObject.Children.Add(child)`. 还需要数据库中预先存在的父对象。
3.  `child.ParentId = parentId`, 你只需要知道 id。您可以按照建议的方式获取 Id，但同样，对于您知道不会被删除的对象，您可以将其保存在某个变量中，以便在事务中重用它。

使用前两个选项，子对象不需要手动添加到上下文中。EF 足够了解它是新的。对于第三个选项，它确实必须添加到`context.Children`before `SaveChanges`。

# c# - 随机测试 i 个可枚举，按顺序测试 j 次

> ID：13148589
> 
> 赞同：3
> 
> 时间：2012-10-30T22:37:18.073
> 
> 标签：c#, loops, .net-4.0

我有一个带有 i 个项目的 IEnumerable，我需要遍历并测试另一个带有 j 个项目的 IEnumerable。但是，i 应该随机迭代，并且在 j 的每次迭代中，可能会测试与 i 不同的项目：

```
list_of_is = [ a, b, c, d, e, f, g ]
list_of_js = [ x, y, z ] 
```

让我们假设随机化 i 是微不足道的，所以我们可以很容易地生成这样的东西：

```
random_is[x] = [ e, b, f, g, d, a, c ]
random_is[y] = [ f, b, g, c, a, d, e ]
random_is[z] = [ d, g, f, c, b, e, a ] 
```

现在我们需要的基本上是：

```
for (int i = 0; i < list_of_is.Count(); i++)
{
   foreach (var j in list_of_js)
   {
      yield return j.DoSomething(random_is[j][i]);
   }
} 
```

输出将是：

   e [x] , f [y] , d [z] , b [x] , b [y] , g [z] , ...

现在，有没有办法在不存储`random_is`变量的情况下做到这一点？这两个列表都非常大，这会消耗大量内存。

**编辑：** 澄清一下，顺序很重要。j 的每次传递都应该只“处理”它的 random_i 中的下一个项目。总体而言，应按以下顺序完成处理：

![在此处输入图像描述](../Images/a1b34337f1f0f29ab2008064612e7eae.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:09:13.187

解决这个问题的一种方法是交换你的循环。那是：

```
foreach (var j in list_of_js)
{
    random_i = generateRandom(j);
    for (int i = 0; i < list_of_is.Count(); ++i)
    {
        return j.DoSomething(random_i[i]);
    }
} 
```

尽管查看代码，但这`return`会杀死循环。也许你的意思是`yield return`？

无论如何，这使得每个随机列表只需要生成一次，并且您一次只需要`random_is`在内存中收集一个集合。然而，它确实改变了事物的生成顺序。如果您可以保存中间值并在生成所有值后重新排列，那不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:59:39.197

除非您首先将 Enumerable 转换为数组，否则您无法真正随机化它，因为根据定义，枚举数一次获得 1 个值，一个令牌一个令牌。

所以，如果我理解正确，我会做这样的事情......

1.  将 list_of_is 转换为数组
2.  对于 list_of_js 中的每个 j
3.  循环通过 list_of_is 执行 Fisher-Yates shuffle
4.  遍历 list_of_is 并执行 f(j,i) 其中 i 是 shuffle 中的当前索引

这是一个简单的例子，我希望这会有所帮助（抱歉修复了一些错误）

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;

namespace ConsoleApplication1
{
    class Program
    {

        static IEnumerable<char> list_of_is = new char[] {'a', 'b', 'c', 'd', 'e', 'f', 'g'};
        static IEnumerable<char> list_of_js = new char[] { 'x', 'y', 'z' };

        static void Main(string[] args)
        {
            foreach (string result in Randomize())
                Debug.Write(result);
        }

        public static IEnumerable<String> Randomize()
        {
            char[] random_is = list_of_is.ToArray();
            int jCount = list_of_js.Count();

            Random r = new Random();

            // foreach j
            foreach(char j in list_of_js)
            {
                // create a random ordering of is
                for (int i = random_is.Length - 1; i >= 0; i--)
                {
                    int x = r.Next(0, i);

                    // swap
                    char temp = random_is[x];
                    random_is[x] = random_is[i];
                    random_is[i] = temp;
                }

                // now evaluate the random pairs
                foreach(Char i in random_is)
                    yield return String.Format("{0}{1} ", Char.ToUpper(i), j);
            }
        }
    }
} 
```

输出

```
Gx Cx Ex Bx Fx Ax Dx Dy By Fy Ay Cy Gy Ey Bz Az Gz Cz Fz Ez Dz 
```

**编辑：** 实际上，我只是觉得你的伪代码看起来不太正确。您正在生成 3 个包含 7 个值的随机数组。然后想要为每个随机数组输出 X、Y、Z 对。看来你需要 3 * 7 * 3 = 63 输出然后..

因此，这可能更准确：

```
public static IEnumerable<String> Randomize()
{
    char[] random_is = list_of_is.ToArray();
    int jCount = list_of_js.Count();

    Random r = new Random();

    // foreach j
    for (int random = 0; random < jCount; random++)
    {
        // create a random ordering of is
        for (int i = random_is.Length - 1; i >= 0; i--)
        {
            int x = r.Next(0, i);

            // swap
            char temp = random_is[x];
            random_is[x] = random_is[i];
            random_is[i] = temp;
        }

        // now evaluate the random pairs
        foreach (Char i in random_is)
            foreach(Char j in list_of_js)
                yield return String.Format("{0}{1} ", Char.ToUpper(i), j);
    }
} 
```

它输出：

```
Cx Cy Cz Gx Gy Gz Dx Dy Dz Bx By Bz Fx Fy Fz Ax Ay Az Ex Ey Ez Bx By Bz Cx Cy Cz Fx Fy Fz Ax Ay Az Ex Ey Ez Dx Dy Dz Gx Gy Gz Cx Cy Cz Ax Ay Az Bx By Bz Gx Gy Gz Fx Fy Fz Ex Ey Ez Dx Dy Dz 
```

# c++ - 用 tr1::shared_ptr 类型实现 std::equal

> ID：13148593
> 
> 赞同：0
> 
> 时间：2012-10-30T22:37:39.553
> 
> 标签：c++, stl, shared-ptr, tr1

网上没办法轻易找到解决办法...

我有类似以下的东西。

```
class Color {
  public:
    Color(std::string n) : name(n) {}
    typedef std::tr1::shared_ptr<Color> Ptr;
    std::string name;
 }; 
```

同时在别处...

```
void Function()
{
    std::vector<Color::Ptr> myVector;
    Color::Ptr p1 = Color::Ptr(new Color("BLUE") );
    Color::Ptr p2 = Color::Ptr(new Color("BLUE") );

    // Note: p2 not added.
    myVector.push_back( p1 );

    // This is where my predicament comes in..
    std::find( myVector.begin(), myVector.end(), p2 );
} 
```

我将如何编写它，以便我的 std::find 实际上尊重 smart_pointers 并比较对象字符串而不是它们的内存地址？我的第一种方法是编写一个自定义的 std::equal 函数，但是它不接受模板作为自己的模板类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:42:14.453

最简单的可能是使用`find_if`：

```
template <typename T>
struct shared_ptr_finder
{
    T const & t;

    shared_ptr_finder(T const & t_) : t(t_) { }

    bool operator()(std::tr1::shared_ptr<T> const & p)
    {
        return *p == t;
    }
};

template <typename T>
shared_ptr_finder<T> find_shared(std::tr1::shared_ptr<T> const & p)
{
    return shared_ptr_finder<T>(*p);
}

#include <algorithm>

typedef std::vector< std::tr1::shared_ptr<Color> >::iterator it_type;
it_type it1 = std::find_if(myVector.begin(), myVector.end(), find_shared(p2));
it_type it2 = std::find_if(myVector.begin(), myVector.end(), shared_ptr_finder<Color>(*p2)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:41:04.173

您可以实现：

```
bool operator==(Color::Ptr const & a, Color::Ptr const & b); 
```

或者，您可以使用`std::find_if`并实现一个谓词，该谓词将按照您的意愿运行。

在 C++11 中，它可能看起来像：

```
std::find_if( myVector.begin(), myVector.end(), [&](Color::Ptr & x) { return *p2 == *x }); 
```

# android - 旋转时的 ViewPager 和空列表视图

> ID：13148597
> 
> 赞同：1
> 
> 时间：2012-10-30T22:37:54.733
> 
> 标签：android, android-fragments, android-viewpager, android-adapter

当我启动我的应用程序时，第一个活动是 TabsActivity，这是一个 FragmentActivity，在这个活动中有一个 ViewPager，我可以通过向左或向右滑动来更改片段。

但是当我旋转我的设备时，当前的片段显示得很好，如果我改变片段，列表不会被填充，如果我再次改变，列表会被正确填充。

这是我的 TabsActivity

```
public class TabsActivity extends SherlockFragmentActivity implements SearchView.OnQueryTextListener   {    
    private static ArrayList<String> CONTENT = new ArrayList<String>();

    private boolean refreshActivity = false;
    private boolean isConnected = true;

    private FragmentStatePagerAdapter adapter;
    private ViewPager pager;    

    @Override
    public void onResume(){
        super.onResume();

        refreshActivity();
    }

    @Override
    public void onStart(){
        super.onStart();

        refreshActivity();
    }

    private void refreshActivity(){
        if (refreshActivity == true && isConnected){
            Intent intent = new Intent(this, TabsActivity.class);
            intent.setFlags(Intent.FLAG_ACTIVITY_PREVIOUS_IS_TOP);
            startActivity(intent);

            refreshActivity = false;
        }
    }

    protected void onSaveInstanceState(Bundle bundle) {
        bundle.putSerializable("CONTENT", CONTENT);
        super.onSaveInstanceState(bundle);
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        File file = new File(getApplicationInfo().dataDir + "/databases/" + EventBDD.NOM_BDD);

        if (!AppStatus.getInstance(this).isOnline(this) && !file.exists()) { 

            isConnected = false;

            setContentView(R.layout.isoffline);
        }else{  

            setContentView(R.layout.tabs_layout);

            final SharedPreferences SP = PreferenceManager.getDefaultSharedPreferences(getBaseContext());

            if(savedInstanceState != null) {
                CONTENT = (ArrayList<String>) savedInstanceState.getSerializable("CONTENT");
            }else{              
                /*
                 * Generate tabs menu with preferences
                 */ 
                if (SP.getBoolean("displayConcert",true))
                    CONTENT.add("Concert");
                if (SP.getBoolean("displayConference",true))
                    CONTENT.add("Conférence");
                if (SP.getBoolean("displayTheatre",true))
                    CONTENT.add("Théatre");
                if (SP.getBoolean("displayDanse",true))
                    CONTENT.add("Danse");
                if (SP.getBoolean("displayJeunesse",true))
                    CONTENT.add("Jeunesse");
                if (SP.getBoolean("displayLoisir",true))
                    CONTENT.add("Loisir");
            }

            SP.registerOnSharedPreferenceChangeListener(new OnSharedPreferenceChangeListener(){
                @Override
                public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {
                    refreshActivity = true;                 
                }
            });

            adapter = new TabsAdapter(getSupportFragmentManager());

            pager = (ViewPager)findViewById(R.id.pager);
            TabPageIndicator indicator = (TabPageIndicator)findViewById(R.id.indicator);

            pager.setAdapter(adapter);
            indicator.setViewPager(pager);          
        }
    }

    class TabsAdapter extends FragmentStatePagerAdapter  {

        public TabsAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int position) {
            return Item.newInstance(CONTENT.get(position % CONTENT.size()));
        }

        @Override
        public CharSequence getPageTitle(int position) {
            return CONTENT.get(position % CONTENT.size());
        }

        @Override
        public int getCount() {
          return CONTENT.size();
        }
    }
} 
```

谢谢 ;）

# c - 如何在给定库名称（如 libfoo.so.1）的情况下找到完整文件路径？

> ID：13148608
> 
> 赞同：33
> 
> 时间：2012-10-30T22:38:27.590
> 
> 标签：c, linux, linker

如果不实现链接器或使用`ldd`，如何找到库的完整路径？Linux 上是否有可用的标准库？（可能是POSIX？）

在有意使用 的文件上使用`ldd`and ，它看起来像：`grep``libGL.so.1`

```
$ ldd /usr/bin/glxinfo | grep libGL
libGL.so.1 => /usr/lib/libGL.so.1 (0x00007f34ff796000) 
```

**给定一个库名称`libGL.so.1`，我怎样才能找到完整路径`/usr/lib/libGL.so.1`？**. 最好接受查找 32 位和 64 位库的选项。如果没有图书馆这样做，是否存在执行此操作的程序？类似的东西`find-library-path libGL.so.1`。`locate libGL.so.1`命令不算数。

`dlopen`如果它执行该库中的代码，我不想实际加载该库。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-31T11:24:32.767

使用管理链接空间的工具[ldconfig 。](http://linux.die.net/man/8/ldconfig)

该`-p`标志允许您浏览所有可用的可链接库。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2017-10-17T08:32:28.480

扩展 Honky Tonk 的答案，该命令`echo "$(ldconfig -p | grep libGL.so.1 | tr ' ' '\n' | grep /)"`将为您提供单独的路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T22:50:11.907

如果您不介意实际加载库并使用一些非标准但广泛可用的函数，则调用`dladdr`库中的任何符号都将返回包含已加载完整路径名的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-03-05T22:45:33.127

[我在这里](https://github.com/albertz/system-tools/blob/master/bin/find-lib-in-path.py)实现了这样一个脚本：

```
#!/usr/bin/env python3

"""
Like `type` but for libs.
"""

import sys
import os
from argparse import ArgumentParser
from glob import glob

def parse_ld_conf_file(fn):
    paths = []
    for l in open(fn).read().splitlines():
        l = l.strip()
        if not l:
            continue
        if l.startswith("#"):
            continue
        if l.startswith("include "):
            for sub_fn in glob(l[len("include "):]):
                paths.extend(parse_ld_conf_file(sub_fn))
            continue
        paths.append(l)
    return paths

def get_ld_paths():
    # To be very correct, see man-page of ld.so.
    # And here: http://unix.stackexchange.com/questions/354295/what-is-the-default-value-of-ld-library-path/354296
    # Short version, not specific to an executable, in this order:
    # - LD_LIBRARY_PATH
    # - /etc/ld.so.cache (instead we will parse /etc/ld.so.conf)
    # - /lib, /usr/lib (or maybe /lib64, /usr/lib64)
    paths = []
    if "LD_LIBRARY_PATH" in os.environ:
        paths.extend(os.environ["LD_LIBRARY_PATH"].split(":"))
    paths.extend(parse_ld_conf_file("/etc/ld.so.conf"))
    paths.extend(["/lib", "/usr/lib", "/lib64", "/usr/lib64"])
    return paths

def main():
    arg_parser = ArgumentParser()
    arg_parser.add_argument("lib")
    args = arg_parser.parse_args()

    paths = get_ld_paths()
    for p in paths:
        fn = "%s/%s" % (p, args.lib)
        if os.path.exists(fn):
            print(fn)
            return

    print("Did not found %r in %r." % (args.lib, paths), file=sys.stderr)
    sys.exit(1)

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-03T10:25:20.577

对于具有 GNU`libc`和 Python 的系统，以下是我发现的最接近的。它使用`LD_DEBUG`（在[手册页中`ld.so(8)`](http://man7.org/linux/man-pages/man8/ld.so.8.html)描述）。

```
LD_DEBUG=libs python3 -c "import ctypes; ctypes.CDLL('libssl.so.1.0.0')" 2>&1 | \
    grep -A 1000 "initialize program: python" | grep -A 3 "find library" 
```

输出（对于`libssl.so.1.0.0`）如下：

```
 15370: find library=libssl.so.1.0.0 [0]; searching
 15370:  search cache=/etc/ld.so.cache
 15370:   trying file=/lib/x86_64-linux-gnu/libssl.so.1.0.0
 15370: 
 15370: find library=libcrypto.so.1.0.0 [0]; searching
 15370:  search cache=/etc/ld.so.cache
 15370:   trying file=/lib/x86_64-linux-gnu/libcrypto.so.1.0.0
 15370: 
```

# angularjs - ngRepeat 中的指令时的绑定问题

> ID：13148609
> 
> 赞同：4
> 
> 时间：2012-10-30T22:38:34.953
> 
> 标签：angularjs

所以这就是它的样子，这里是[Plunker](http://plnkr.co/edit/IPwDLT?p=preview)

```
parent scope 
   ng-repeat
       directive 
```

在指令中有一个属性是与父范围内的变量双向绑定。

但这并没有按我的意愿工作。（但我可以理解为什么它不起作用）

原因是 ngRepeat 会创建它自己的范围，因此一旦指令中的变量发生更改，Angular 就会在 ngRepeat 中添加一个变量，但它会保持父级中的变量不变。

我可以做一些类似 scope.$parent.$parent.variable 的事情来改变变量，但这有点不是 Angular 的想法。

我应该怎么做 ？

此外，如果我更改项目集合中的重复项目，则无法更改项目。

因为同上的原因。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T03:19:44.627

编辑（再次）：看起来问题是您需要在数组中有*引用类型*，例如对象或数组。

Gloopy 在评论中完全正确。双向绑定不起作用，因为 Angular 似乎在第二个作用域配对之间创建了原始类型（字符串、数字等）的副本。所以......当您在两个范围之间嵌套双向绑定的原始类型时，这很好，因为它使用一个实例，但是当您将其嵌套超过一个深度时，它会创建原始类型的副本并且您不再更新同一个实例。

[这是一个新的演示](http://plnkr.co/edit/3mHtcp)

```
app.controller('MainCtrl', function($scope) {
  $scope.items = [
    { text: 'apples' },
    { text: 'bananas' },
    { text: 'oranges' }
  ];
  $scope.addItem = function(){
    $scope.items.push({ text: 'test' });
  };
});

app.directive('test', function(){
  return {
    restrict: 'E',
    scope: {
      foo: '=foo'
    },
    template: '<div>{{foo}} <a ng-click="bar()">bar</a></div>',
    controller: function($scope){ 
      $scope.bar = function() {
        $scope.foo += '!';
      };
    }    
  };
}); 
```

# jquery - 使用 Jquery 进行淡入/淡出。淡出似乎无法正常工作

> ID：13148613
> 
> 赞同：0
> 
> 时间：2012-10-30T22:38:56.743
> 
> 标签：jquery, fadeout, fadein

我一直在制作一个小页面来创建各种交互式地图。当前站点不代表最终产品，只是获取站点的内容和编码设置。一般来说，我对网络编码也很陌生，仅供参考。

这是我的问题。

我正在尝试基于单击按钮使用 jquery 使一系列图像淡入和淡出。按下按钮时，淡入/淡出似乎完美无缺，但在相反方向进行时，淡出似乎是立即的，尽管淡入正常工作。无论按钮单击的方向是哪个方向，我都希望淡入/淡出是统一的，但似乎无法找到编码以这种方式工作的原因。

这是我所有源代码的实时链接：http: [//users.humboldt.edu/eibenm/sheepallenge.html](http://users.humboldt.edu/eibenm/sheepallenge.html)

我猜问题出在以下部分：

```
$(document).ready(function() {
    $('#Image1').fadeIn(1500);
})      

$(button1).click(function() {
    $('#sins img').fadeOut('slow');
    $('#Image1').fadeIn(1500);
}); 

$(button2).click(function() {
    $('#sins img').fadeOut('slow');
    $('#Image2').fadeIn(1500);
}); 

$(button3).click(function() {
    $('#sins img').fadeOut('slow');
    $('#Image3').fadeIn(1500);
}); 

$(button4).click(function() {
    $('#sins img').fadeOut('slow');
    $('#Image4').fadeIn(1500);
}); 

$(button5).click(function() {
    $('#sins img').fadeOut('slow');
    $('#Image5').fadeIn(1500);
}); 

$(button6).click(function() {
    $('#sins img').fadeOut('slow');
    $('#Image6').fadeIn(1500);
}); 

$(button7).click(function() {
    $('#sins img').fadeOut('slow');
    $('#Image7').fadeIn(1500);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:04:24.750

你有很多重复的内联样式、JQuery 和 HTML 代码。它可以压缩成更小的形式。

// 为所有图像链接分配一个类

```
.links
{
    width : 130px;
    height : 49px;
    opacity: 0.5;
}

<img src="Images/1Lust.png" class="links" id="button1">

//  Assign a class to all the images as a Whole
.images
{
    width : 880px;
    height : 600px;
    display: none;
}
<img src="Images/Deadly Sin 1.jpg" class="images"> 
```

**JavaScript** // 此块将导致按钮不透明

```
$(document).ready(function() {
    $('a img').animate({
        opacity: .5
    });
    // will change opacity to 1 on hover and back to .5 when not 
    $('a img').hover(function() {
        $(this).stop().animate({
            opacity: 1
        }, 'fast');
    }, function() {
        $(this).stop().animate({
            opacity: .5
        }, 'fast');

    });

    $('#Image1').fadeIn(1500); 

    // Assign the click event to All the id's that start with button
    $('[id^="button"]').on('click', function() {
        //  fade Out All the images inside sins
        $('#sins img').fadeOut('slow');
        // Find the index of the element that was clicked
        var $index = $('#links').find(this).index();
        // Show the corresponding image
        $('#sins img:eq('+ ($index + 1) + ')').fadeIn(1500);
    });
}); 
```

# jquery - 为什么我可以禁用但不能启用可丢弃功能？

> ID：13148614
> 
> 赞同：5
> 
> 时间：2012-10-30T22:39:00.420
> 
> 标签：jquery, jquery-ui, draggable, droppable

我只需要在一个放置区域中放置 1 个块，并在需要时进行切换。为什么我可以禁用但不能启用可丢弃功能？

*   `$(this).droppable("option", "disabled", false);`- 不工作
*   `$(this).droppable("enable");`- 不工作
*   [禁用后启用可放置](https://stackoverflow.com/questions/9278165/enable-a-droppable-after-it-has-being-disable)- 不起作用

这是我的代码：

```
$('.my_block').draggable({
    revert: "invalid",        
});

$('.free').droppable({         
    accept: ".my_block",
    drop: function(ev, ui) {             
        $(this).removeClass("free");    
        $(this).addClass("1");                
        ui.draggable.appendTo($(this)).removeAttr('style');
            $(this).droppable("disable");              
        },
        out:  function(ev, ui) {                     
            $(this).droppable("enable");    
            $(this).removeClass("1");    
            $(this).addClass("free");            
        },        
    }); 
```

jsfiddle [http://jsfiddle.net/4ABCN/2/](http://jsfiddle.net/4ABCN/2/)

我怎样才能通过一键将所有红色块返回到主要位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T23:42:12.123

**工作演示** *删除了旧的演示*

**新演示**试试这个：http: [//jsfiddle.net/7EbKS/](http://jsfiddle.net/7EbKS/)

行为：现在，当用户移动红色框时，您可以将另一个放在空位置，

希望它适合原因`:)`

**代码**

```
 $(function() {
    foo();

    $('.my_block').draggable({
        revert: "invalid",
        stop: function() {
            $(this).draggable('option', 'revert', 'invalid');
        }

    });

    function foo() {
        $('.block').droppable({
            greedy: true,
            accept: ".my_block",
            // tolerance: "fit",
            drop: function(ev, ui) {
                ui.draggable.appendTo($(this)).removeAttr('style');
             }
        });
    }
    $('.my_block').droppable({
        greedy: true,
        tolerance: 'touch',
        drop: function(event, ui) {
            ui.draggable.draggable('option', 'revert', true);
        }
    });

}); 
```

# bash - Bash：不能从脚本参数中创建小写字母？

> ID：13148617
> 
> 赞同：0
> 
> 时间：2012-10-30T22:39:14.580
> 
> 标签：bash, shell

```
#!/bin/sh
var="$1";
OUTPUT=$(echo ${$var,,});
echo $OUTPUT 
```

我尝试了所有可能的组合，包括转义某些字符。

我只是不能让 shell 输出我的脚本参数小写。

错误：

```
createmodule.sh: 26: createmodule.sh: Bad substitution 
```

为什么是这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:40:52.767

有一个错误，试试这个：

```
#!/bin/bash
var="$1"
OUTPUT=${var,,}
echo $OUTPUT 
```

你有一个`$`多余的。

如讨论中所见，`sh script`如果您不确定所需的 shell 是否真的是`sh`一个，则永远不要调用脚本。更好的方法是把好的 shebang 像`#!/bin/bash`，然后`chmod+x script.sh`，最后`./script.sh`

# statistics - Rapidminer 中哪些参数最适合决策树

> ID：13148620
> 
> 赞同：1
> 
> 时间：2012-10-30T22:39:28.327
> 
> 标签：statistics, decision-tree, data-analysis, rapidminer

我有一组具有 14 个常规属性的数据。我正在尝试从该训练数据中创建**Rapidminer**中的最佳决策树，以便我可以在评分数据上使用该树。

但是我不确定决策树使用哪些参数（例如：标准、最小增益、置信度等）？我也不确定我可以/应该将哪些其他运算符（如果有的话）应用于我的模型？

谁能给我一些关于什么最有效的一般提示？

我所拥有的数据是尝试确定是否有人开设了新的银行账户，他们的信用状况是否良好。我有信用状况、账户类型、历史、就业、性别、工作等信息。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T09:18:52.770

一般来说，样本的数量会更好地帮助机器学习过程。请参考此链接，这可能对您有所帮助[http://www.simafore.com/blog/bid/55751/how-to-use-decision-trees-for-credit-scoring-using-rapidminer-part -1](http://www.simafore.com/blog/bid/55751/how-to-use-decision-trees-for-credit-scoring-using-rapidminer-part-1)

# jsf - 错误：在 ExternalContext 中找不到 /login.xhtml 作为资源

> ID：13148624
> 
> 赞同：12
> 
> 时间：2012-10-30T22:40:05.637
> 
> 标签：jsf, url-pattern

我将 JBoss 7.1 与 JSF 2.1/Prime Faces 一起使用，并不断遇到标题中列出的错误。我已经尝试了这里提出的许多建议，但都以同样的错误告终。

文件结构为：

```
WEB-INF
   faces
      login.xhtml 
```

我在 web.xml 中有以下内容：

```
<display-name>clientAccountManager</display-name>
<servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>/faces/*</url-pattern>
</servlet-mapping>
<context-param>
    <param-name>javax.faces.PROJECT_STAGE</param-name>
    <param-value>Development</param-value>
</context-param>
<context-param>
    <param-name>javax.faces.INTERPRET_EMPTY_STRING_SUBMITTED_VALUES_AS_NULL</param-name>
    <param-value>true</param-value>
</context-param> 
```

我正在使用以下 URL 访问当前文件：

```
http://localhost:8080/clientAccountManager/faces/login.xhtml 
```

我还将 URL 模式更改为 *.xhtml 并使用：

```
http://localhost:8080/clientAccountManager/login.xhtml 
```

结果相同。

我错过了什么？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-31T01:32:40.460

你犯了2个错误。

1.  `/WEB-INF`文件夹用于存放配置文件、包含文件、模板文件、标签文件等，这些文件应该是隐藏的，不能直接访问，而不是公开访问的文件。将可公开访问的文件放在`/WEB-INF`文件夹之外。

2.  `/faces`根本不应该使用文件夹。虚拟`/faces/*`URL 模式`FacesServlet`并不意味着您应该拥有这样的物理文件夹。去掉它。

所以，总而言之，只是

```
WebContent
 |-- META-INF
 |-- WEB-INF
 |    |-- faces-config.xml
 |    `-- web.xml
 `-- login.xhtml 
```

和

```
<servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.xhtml</url-pattern>
</servlet-mapping> 
```

和

```
http://localhost:8080/clientAccountManager/login.xhtml 
```

应该做。

### 也可以看看：

*   [我需要将哪些 XHTML 文件放入 /WEB-INF 而哪些不需要？](https://stackoverflow.com/questions/9031811/which-xhtml-files-do-i-need-to-put-in-web-inf-and-which-not)

# sql - 问题 SQL SERVER ROLLBACK 触发器

> ID：13148625
> 
> 赞同：2
> 
> 时间：2012-10-30T22:40:06.947
> 
> 标签：sql, sql-server

下午好，我的回滚有问题...... Treger 最初是用来调用程序并且程序被触发回滚但它是......现在我正在尝试从触发器回滚也不......

附上代码和错误

谢谢你的帮助

```
USE [Desarrollo_Pruebas]
GO
/****** Object:  Trigger [dbo].[Prueba_tre]    Script Date: 10/30/2012 17:02:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER TRIGGER [dbo].[Prueba_tre] 
   ON  [dbo].[Cliente]
    FOR INSERT
AS 
BEGIN

 SET NOCOUNT ON;

begin try
    BEGIN TRAN t1
    SAVE TRAN t1
    INSERT INTO Articulo (Articulo_Codigo, Articulo_Descripcion, Valor_unitario, Categoria_id, msg) VALUES (1040,'EURECA',15000,5,'')
    COMMIT 
    --raiserror ('Test error',16,1)
end try

begin catch
    ROLLBACK TRAN t1
    SELECT    ERROR_NUMBER() AS ERROR_NUMBER, ERROR_MESSAGE() AS ERROR_MESSAGE;
end catch

--SET NOCOUNT ON;
--exec Prueba CLIENTE_ID;

END 
```

消息 3931，级别 16，状态 1，过程 Prueba_tre，第 21 行当前事务无法提交，也无法回滚到保存点。回滚整个事务。

桌子是

这个想法是，当我插入带有插入更新的客户产品时..在此事务结束时需要从控制台返回

```
CREATE TABLE Articulo
(
   Articulo_Codigo int not null primary key
   , Articulo_Descripcion varchar (100)
   , Valor_unitario int
   , Categoria_Id int not null constraint fk_Categoria references Categoria (CATEGORIA_ID)
)

CREATE TABLE Cliente
(
   CLIENTE_ID int not null primary key
   , CLIENTE_PRIMER_NOMBRE varchar(50)
   , CLIENTE_SEGUNDO_NOMBRE varchar(50)
   , CLIENTE_PRIMER_APELLI varchar(50)
   , CLIENTE_SEGUNDO_APELLI varchar(50)
   , CLIENTE_DIRECCION varchar(90)
   , CLIENTE_TELEFONO int
   , CLIENTE_CIUDAD varchar(50)
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T08:45:31.890

继续使用程序。我认为您只是不检查异常处理和嵌套事务。

```
CREATE PROCEDURE [dbo].[Prueba_tre]
AS
BEGIN
  SET NOCOUNT ON;
  declare @trancount int;
  set @trancount = @@trancount;
  begin try
    if @trancount = 0
      begin transaction
    else
      save transaction t1

    INSERT INTO Articulo (Articulo_Codigo, Articulo_Descripcion, Valor_unitario, Categoria_id, msg) VALUES (1040,'EURECA',15000,5,'')
    if @trancount = 0 
      commit; 
  end try
  begin catch
    declare @error int, @message varchar(4000 ), @xstate int;
    select @error = ERROR_NUMBER(),
    @message = ERROR_MESSAGE(),
    @xstate = XACT_STATE();
   if @xstate = -1
     rollback;
   if @xstate = 1 and @trancount = 0
     rollback
   if @xstate = 1 and @trancount > 0
     rollback transaction t1
   raiserror ('t1: %d: %s' , 16, 1, @error, @message)
  end catch
END 
```

# c++ - 返回从常量指针向量生成的指针的函数

> ID：13148627
> 
> 赞同：0
> 
> 时间：2012-10-30T22:40:09.590
> 
> 标签：c++, pointers, vector, constants

我在为我的作业找到解决方案时遇到了麻烦。这就是我想要做的：我有一个存储在向量中的对象列表。称为“AvailableObjects”的向量是全局声明的。

```
vector<const Object*> AvailableObjects; 
```

...

```
void       read_obj_file(const char* filename){
ifstream infile (filename, ios::in);

while(!infile.eof()) {
        char name[20];
        int attribute;
        int size = 0;
        infile >> name >> attribute >> size;
        AvailableObjects.push_back(new Object(name, attribute, size));
        }
 infile.close();
 return;
 } 
```

读取对象后，我需要编写一个函数来生成单个对象，并将其推送到用户可用的对象堆栈中。

```
Object*     generate_object(){
        return AvailableObjects.at(rand_in_range(1,AvailableObjects.size()));
        } 
```

上面的代码是我想要使用的。我需要随机选择一个存储在向量中的对象，并将该对象的指针返回给任何调用函数的对象。但是，这无法做到，因为向量中的对象是 const Object*，而不是简单的 Object*。这是一个家庭作业，所以我不能修改 const 值，它们的原型必须保持不变。最后，我将分享对象类。它有一个构造函数，专门用于在传递 const Object* 时创建一个新对象，但我无法使构造函数按预期工作。

```
/**
 * object.h
 *
 * Objects are immutable (read-only) once instantiated.
 */
#ifndef OBJECT_H
#define OBJECT_H

#include<string>
    using std::string;

class object{
    private:
    string _name;
    int    _attribute;
    int    _size;

    public:
    // Constructor
    Object(string name, int attribute, int size){
        _name  = name;
        _attribute = attribute;
        _size  = size;
    }
    Treat(const Treat& t){
        _name  = t._name;
        _attribute = t._attribute;
        _size  = t._size;
    }
    // Accessors
    string name() const {return _name;}
    int    attribute()const {return _attribute;}
    int    size() const {return _size;}
    };

    #endif 
```

这里还有一个在整个代码中显示的函数，它在特定范围内选择一个随机数。

```
 int rand_in_range(int low, int high){
        init_rand();
        high < low ? throw "Invalid range." : 0 ;
        int modbase = ((high+1) - low);
        int ans = 0;
        ans = rand() % modbase + low;
        return ans;
        } 
```

感谢您的任何回复，我将积极关注此内容，因此，如果有人有任何问题，我将很乐意回复。再次总结一下，我需要帮助来让我的 generate_object 函数使用我可用的 const Object* 的向量返回一个 Object*。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:46:01.623

首先，范围应该从零开始，而不是从一开始。其次，您可以像下面的链接一样通过类型转换来删除 const

[http://msdn.microsoft.com/en-US/library/bz6at95h(v=vs.80).aspx](http://msdn.microsoft.com/en-US/library/bz6at95h(v=vs.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:35:43.483

向量是零索引的，因此 的有效范围`AvailableObjects.at`是`0 to AvailableObjects.size()-1`。

假设`Treat(const Treat& t)`应该是`Object(const Object& t)`并且您在转录时犯了错误，那么它不会`const Object*`像您所说的那样。由于它需要一个 const 引用，而不是 const 指针，因此您必须取消引用您的指针。例如，如果我们想对 AvailableObjects 中的第五个对象进行深拷贝，我们会这样做：

```
int index = 4; // 0, 1, 2, 3, 4... thus index 4 refers to the fifth item.
const Object* object = AvailableObjects.at(index);
Object* clone = new Object(*object); 
```

# mysql - 如何找到导致“等待表元数据锁定”状态的事务？

> ID：13148630
> 
> 赞同：117
> 
> 时间：2012-10-30T22:40:10.623
> 
> 标签：mysql

我正在尝试对表执行一些 DDL 并`SHOW PROCESSLIST`导致“等待表元数据锁定”消息。

我怎样才能知道哪个交易还没有结束？

我正在使用 MySQL v5.5.24。

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2012-10-31T10:24:09.333

**适用于 MySql 版本 < 5.7.3**

```
SHOW ENGINE INNODB STATUS \G 
```

寻找部分 -

```
TRANSACTIONS 
```

我们可以使用**INFORMATION_SCHEMA**表。

**有用的查询**

检查所有锁事务正在等待：

```
USE INFORMATION_SCHEMA;
SELECT * FROM INNODB_LOCK_WAITS; 
```

阻塞事务列表：

```
SELECT * 
FROM INNODB_LOCKS 
WHERE LOCK_TRX_ID IN (SELECT BLOCKING_TRX_ID FROM INNODB_LOCK_WAITS); 
```

或者

```
SELECT INNODB_LOCKS.* 
FROM INNODB_LOCKS
JOIN INNODB_LOCK_WAITS
  ON (INNODB_LOCKS.LOCK_TRX_ID = INNODB_LOCK_WAITS.BLOCKING_TRX_ID); 
```

特定表上的锁列表：

```
SELECT * FROM INNODB_LOCKS 
WHERE LOCK_TABLE = db_name.table_name; 
```

等待锁的事务列表：

```
SELECT TRX_ID, TRX_REQUESTED_LOCK_ID, TRX_MYSQL_THREAD_ID, TRX_QUERY
FROM INNODB_TRX
WHERE TRX_STATE = 'LOCK WAIT'; 
```

**参考**- [MySQL 故障排除：查询不起作用时该怎么办](https://rads.stackoverflow.com/amzn/click/com/1449312004)，第 6 章 - 第 96 页。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2014-05-20T10:26:46.857

如果您找不到锁定表的进程（因为它已经死了），它可能是一个仍在像这样清理的线程

交易部分

```
show engine innodb status; 
```

在最后

```
---TRANSACTION 1135701157, ACTIVE 6768 sec
MySQL thread id 5208136, OS thread handle 0x7f2982e91700, query id 882213399 xxxIPxxx 82.235.36.49 my_user cleaning up 
```

[正如在清除事务死锁](https://stackoverflow.com/questions/5462249/clear-transaction-deadlock)的评论中提到的那样 ？

您可以尝试直接杀死事务线程，在这里

```
 KILL 5208136; 
```

为我工作。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-03-23T10:40:43.723

mysql 5.7 通过表公开元数据锁信息 `performance_schema.metadata_locks`。

文档[在这里](https://dev.mysql.com/doc/refman/5.7/en/metadata-locks-table.html)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-12-23T04:29:57.917

我对 Datagrip 也有类似的问题，但这些解决方案都没有奏效。

重新启动 Datagrip 客户端后，它不再是问题，我可以再次删除表。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2021-06-07T14:41:38.773

对于 MySQL 版本 >= `5.7.3`，Performance Schema 现在公开元数据锁定信息。 [https://dev.mysql.com/doc/relnotes/mysql/5.7/en/news-5-7-3.html](https://dev.mysql.com/doc/relnotes/mysql/5.7/en/news-5-7-3.html)

运行此查询以了解谁持有您的元数据锁

```
SELECT OBJECT_TYPE,
       OBJECT_SCHEMA,
       OBJECT_NAME,
       LOCK_TYPE,
       LOCK_STATUS,
       THREAD_ID,
       PROCESSLIST_ID,
       PROCESSLIST_INFO
FROM performance_schema.metadata_locks
INNER JOIN performance_schema.threads ON THREAD_ID = OWNER_THREAD_ID
WHERE PROCESSLIST_ID <> CONNECTION_ID(); 
```

* * *

当我尝试在接受的答案中运行查询时，我收到了以下信息：

```
Empty set, 1 warning (0.001 sec) 
```

检查 1 个警告，我发现它`INNODB_LOCK_WAITS`已被弃用。

```
MySQL [ebdb]> SHOW WARNINGS;
+---------+------+-----------------------------------------------------------------------------------------------+
| Level   | Code | Message                                                                                       |
+---------+------+-----------------------------------------------------------------------------------------------+
| Warning | 1681 | 'INFORMATION_SCHEMA.INNODB_LOCK_WAITS' is deprecated and will be removed in a future release. |
+---------+------+-----------------------------------------------------------------------------------------------+ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-04-19T18:15:46.320

我刚遇到这个问题，上面的查询都没有显示任何锁定。但是我用这个“等待表元数据锁定”消息锁定了一个变更。我发现有一个长时间运行的查询（它运行了两个多小时）。我杀死了那个查询并且改变立即解锁。

# mysql - MySQL选择组中的最新记录

> ID：13148633
> 
> 赞同：0
> 
> 时间：2012-10-30T22:40:20.430
> 
> 标签：mysql, sql-order-by

> **可能重复：**
> [MySQL 检索组的最新记录](https://stackoverflow.com/questions/9444167/mysql-retrieve-latest-record-for-group)

我有一个查询，它将所有在“address1”字段中具有相同信息的记录分组，除非它们具有不同的 jobType。

```
SELECT * 
FROM   jobs 
WHERE  client_id = '".$id."' 
       AND status = '3' 
GROUP  BY CASE 
            WHEN jobType IN ( '0', '3', '6' ) THEN '0' 
            ELSE jobType 
          end, 
          address1 
ORDER  BY Max(id) ASC 
```

我遇到的问题是查询总是提取组中的第一个实例。我需要它来提取组中的最新实例。我已经尝试了 ORDER BY 的一些变体，但这似乎并没有奏效。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:55:07.353

你想要[分组最大值](http://dev.mysql.com/doc/en/example-maximum-column-group-row.html)：

```
SELECT jobs.*
FROM   jobs NATURAL JOIN (
  SELECT   MAX(id) id
  FROM     jobs
  WHERE    client_id = :id AND status = '3'
  GROUP BY CASE
             WHEN jobType IN ('0','3','6') THEN '0'
             ELSE jobType
           END,
           address1
) t 
```

但是，这对索引不是很友好。最好创建一个包含`CASE`表达式结果的列（然后对其进行索引）。

# ios - 在 UIViewController 之间切换的正确设计模式是什么？

> ID：13148635
> 
> 赞同：1
> 
> 时间：2012-10-30T22:40:36.843
> 
> 标签：ios, ipad, uiview, uiviewcontroller, ios6

我有一个应用程序，它有两个主要控制器：一个 GJClientSelectionController，它只是一个普通的 UIViewController，其中包含一个包含滚动视图的视图，以及一个 CGClientDetailController，它是一个自定义 UIViewController，它管理一个自定义选项卡栏和一个控制器。当用户在应用程序的每个部分之间移动时，我会在控制器之间切换。

问题是，我不确定正确的设计模式是什么。在 iOS6 之前，我只是将每个设置为窗口的 rootViewController 属性的值。它工作得很好，但是如果设备旋转然后我切换控制器，新可见的控制器将不会收到旋转通知，并且在用户旋转设备之前会被绘制错误。我还在尝试使用我称为 masterController 的常规 UIViewController，并将其设置为 rootViewController，然后将其他两个控制器添加为 childViewControllers。唯一的问题是，如果我隐藏 childViewController 的视图，它仍然会错过旋转通知。

在 UIViewController 之间移动的正确设计模式是什么？当我切换到控制器及其视图时，如何确保它们具有正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:46:06.140

查看这篇文章： [How to force a UIViewController to Portraitorientation in iOS 6](https://stackoverflow.com/questions/12520030/how-to-force-a-uiviewcontroller-to-portait-orientation-in-ios-6)

# django - 邮政编码数据库项目的问题

> ID：13148636
> 
> 赞同：0
> 
> 时间：2012-10-30T22:40:47.540
> 
> 标签：django, csv, sqlite, zipcode

我看到这里提到了 ZipCode 数据库项目，用于计算两个邮政编码之间的距离。我能够使用 Django 和 sqlite3 成功地将 csv 文件上传到我的数据库。但是，现在除了邮政编码本身（城市和州不起作用）之外，我无法执行任何查询。我认为这是因为 csv 文件在城市和州周围有引号，所以我尝试上传文件，取出所有引号。没运气。然后我认为编码关闭了，所以我再次上传，确保它是用 utf-8 编码的。再次，没有运气。有没有人有这个数据库的经验？该数据库位于[http://zips.sourceforge.net/](http://zips.sourceforge.net/) 我加载它的方式基于[http://mitchfournier.com/2011/10/11/how-to-import-a-csv-or -tsv-file-into-a-django-model/](http://mitchfournier.com/2011/10/11/how-to-import-a-csv-or-tsv-file-into-a-django-model/) 我回避了 geodjango，因为它似乎对我想做的事情有点过分了。任何帮助将不胜感激。

这是代码：

对于我的邮政编码类：

```
class ZipCode(models.Model):
    zipcode=models.CharField(max_length=5)
statecode=models.CharField(max_length=2)
lat=models.CharField(max_length=9)
long=models.CharField(max_length=9)
city=models.CharField(max_length=64)
state=models.CharField(max_length=32)
create_date=models.DateTimeField(default=datetime.datetime.now)
def __unicode__(self):
    return "%s %s %s" %(self.city,self.statecode,self.zipcode) 
```

然后我有一个描述类，在这里我想将城市和州转换为邮政编码，理想情况下

```
class Descriptions(models.Model):
name=models.CharField(max_length=50)
website=models.CharField(max_length=50,blank=True)
street1=models.CharField(max_length=50,blank=True)
street2=models.CharField(max_length=50,blank=True)
city=models.CharField(max_length=50,blank=True)
state=models.CharField(max_length=50,blank=True)
zip=models.CharField(max_length=5,blank=True)
description=models.TextField()
areas_related=models.TextField()
add_area=models.CharField(max_length=50,blank=True)
federal=models.NullBooleanField(null=True)
def get_zip(self):
    if self.city and self.state:
        real_zip=ZipCode.objects.filter(statecode=self.state) ####note this is not the real query I want to do, but even this returns None
                    ###alternatively, if I do (zip=self.zipcode) I will get an object returned
        return real_zip
    def __unicode__(self):
    return u'%s %s %s %s %s %s %s %s %s %s %s' %(self.name,self.website,self.street1,
    self.street2,self.city,self.state,self.zip,self.description,self.add_area, self.federal, self.get_zip()) 
```

对于上传文件：

```
csv_filepathname='/Users/sam/Documents/service/mysite/zips.csv'
your_djangoproject_home='/Users/sam/Documents/service/mysite/mysite'

import sys,os

sys.path.append(your_djangoproject_home)
os.environ['DJANGO_SETTINGS_MODULE']='settings'

from southtut.models import ZipCode

import csv
dataReader = csv.reader(open(csv_filepathname), delimiter=',', quotechar='"')
for row in dataReader:
    if row[0]!='ZIPCODE':
        zipcode=ZipCode()
        zipcode.zipcode=row[0]
        zipcode.statecode=row[1]    
        zipcode.lat=row[2]          
        zipcode.long=row[3]
        zipcode.city=row[4]     
        zipcode.state=row[5]            
        zipcode.save() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:40:43.917

使用了不同的数据库。仍然不确定为什么我的那个不工作。

# java - 非 jsf 应用程序的 ExternalContext 等效项

> ID：13148637
> 
> 赞同：1
> 
> 时间：2012-10-30T22:40:49.647
> 
> 标签：java, jsp, jsf, servlets

尝试使用 jsp、servlet 和 java 更改一个 jsf 应用程序，在我们使用的 jsf 应用程序中

```
ExternalContext exctx = FacesContext.getCurrentInstance().getExternalContext();
InputStream var= exctx.getResourceAsStream("/dir/file.xml"); 
```

试图用**FileInputStream替换****extc**，总是得到 filenot found 异常。在 JSF 应用程序中，这运行良好

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T23:18:57.900

使用 Servlet，您应该使用`ServletContext`加载外部资源。

```
InputStream var = servletContext.getResourceAsStream("/dir/file.xml"); 
```**

# c - 如何在 C 中的二维 char 数组中找到 char 指针？

> ID：13148643
> 
> 赞同：2
> 
> 时间：2012-10-30T22:41:22.773
> 
> 标签：c, pointers

嗨，我对 C 很陌生。

基本上我要问的是：

所以我有一个二维`char`数组，它代表一个字符串列表 ( `char array[size][20]`)。

然后我有另一个字符串，我将其表示为一个带`char`尖的 ( `char *word`)。

我希望我的函数做的是遍历数组中的每个字符串，如果找到单词 to `return 1`。

但是我对指针很困惑，所以我不确定如何写这个。我从使用 for 循环开始，遍历数组的行。然后`if(word = array[i]) return 1`。但这对我不起作用。

我希望这是有道理的，如果没有，我会再次尝试解释。我将不胜感激任何答案。我真的不需要代码。只是朝着正确的方向迈出了一步。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T22:50:29.160

假设您的数组由以*空字符结尾的*字符串（即长度最多为 19 的字符串）组成，那么[`strcmp`](http://en.cppreference.com/w/cpp/string/byte/strcmp)您的解决方案是：

```
#include <string.h>
#include <stddef.h>

size_t find_in_array(char array[][20], size_t size, char * word)
{
    for (size_t i = 0; i != size; ++i)
        if (strcmp(array[i], word) == 0)
            return i;

    return size;
} 
```

如果找到单词，这将返回偏移量，`size`否则返回。

**用法：**

```
char array[3][20] = { "Hello", "World", "Jim" };

size_t i = find_in_array(array, 3, "Jim");  // returns "2" 
```

如果“i != 3”，则找到该单词。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T22:52:31.027

您给定的比较只是比较*指针*本身的值是否相等，而不是指针指向的内存内容是否相同（此外，在您的示例中，单个相等是分配，而不是比较）。

你的数组真的看起来像我草草写下的这张图： ![字符数组的数组](../Images/c34636054c4b485c70e331b4e424a49b.png)

您要做的是使用 strcmp 或其他此类函数来比较您的 word 变量指向的内存是否等于数组中的任何单个字符串。

在带有指针的语言中，它有助于像我在这里所做的那样提取内存，请记住，指针不是内存的实际内容，而只是定位它的一种方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T22:51:05.660

这是 C，不是 C++。Using`==`将以数字方式比较字符串的地址，而不是它们的内容。要测试字符串是否相等，请使用该`strcmp()`函数，如果它的参数是相同的字符串，则返回 0：

```
int has_word(const char *word, const char list[][20], size_t n)
{
    int i;
    for (i = 0; i < n; i++) {
        if (strcmp(word, list[i]) == 0) {
            return 1;
        }
    }
    return 0;
} 
```

根据您的需要，如果此函数在字符串数组的`word`第一个`n`元素中找到以 0 结尾的字符串，它将返回 1 。`list`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T22:44:16.303

看一下中的函数`string.h`，具体来说`strstr()`。

维基百科有一个相当不错的[C 字符串处理](http://en.wikipedia.org/wiki/C_string_handling)页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T22:49:55.740

起初，`word = array[i]`绝对不是比较字符串的好方法。你应该使用`strcmp`：[http ://www.cplusplus.com/reference/clibrary/cstring/strcmp/](http://www.cplusplus.com/reference/clibrary/cstring/strcmp/)

我刚刚回答了另一个与您的问题非常相似的问题。看看这个问题，它可以给你一些想法：[Returning and printing string array index in C](https://stackoverflow.com/questions/13147515/returning-and-printing-string-array-index-in-c/13147784#13147784)

# windows - 本地主机上的慢 Drupal | windows7 EasyPHP 64x

> ID：13148645
> 
> 赞同：5
> 
> 时间：2012-10-30T22:41:45.973
> 
> 标签：windows, performance, drupal, localhost, easyphp

我在我的笔记本电脑上运行 Drupal 7.16（Windows7 x64，EasyPHP12.1 上有 6gb RAM）。
现在drupal运行很慢！

我已经尝试：

1.  增加 php.ini`realpath_cache_size`为`24M`
2.  将my.ini 更改`innodb_flush_log_at_trx_commit`为`0`
3.  更改`hosts`文件以解决 ipv6 错误..
4.  尝试另一种 wamp 解决方案
5.  似乎当我运行简单查询（`SELECT uid FROM users`）时，phpMyAdmin 返回一个快速响应（0.0009s）..
6.  另一个drupal干净安装加载也很慢......

谢谢，
~阿尔莫格

**我也尝试过 UniformServer，但它仍然很慢，并更改 my.ini 跟随这里的帖子（stackexchange 网站）和跟随 drupal.org*
***似乎 wordpress 加载速度很快，所以问题似乎只出在 drupal ?*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T07:17:26.167

你有两种方法：

1）调整你的安装：安装php-apc，安装监控软件（[sysinternals](http://technet.microsoft.com/en-us/sysinternals/bb842062.aspx)）来检测瓶颈，安装xdebug，[Wincachegrind](http://drupal.org/node/549700)等。

2）使用一些预配置的软件：[acquia](https://www.acquia.com/downloads)、[vagrant](http://drupal.org/project/vagrant)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T14:35:43.040

我现在的解决方案：

1.  删除所有 WAMP 服务
2.  重新安装和配置 EasyPHP 的最新版本（仅启用必要的 php 插件！）
3.  安装最新的“EasyPHP 组件”
4.  ***在某些地方（如 xdebug）修复最新组件目录的 php.ini***
5.  增加 memory_limit
6.  清除所有缓存（浏览器和 Drupal）
7.  使用 drupal (admin->performance) 缩小的 jquery
8.  完全重启我的电脑并从自动启动中删除一些软件

现在它运行得更好了！不完美..但这主要是因为我想要部署模式下的drupal！

* *EasyPHP的deafults设置做得很好！没什么可改变的！**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-24T09:38:33.913

有两种解决方案可以解决 Windows 机器上 Drupal 的缓慢问题：

**1.hosts文件设置**

在您的主机文件中进行以下更改...</p>

一世。通过 ip 地址调用 apache web 服务器地址。在本地计算机上是 127.0.0.1

ii. 注释主机文件中的 ::1 localhost 行，它是 TCP/IP v6 协议中的映射

**2\. 禁用/调整网络接口的 TCP/IP v6 协议**

有两种选择……</p>

一世。禁用网络接口的 TCP/IP v6 协议，以便 windows 不会尝试将您的主机名解析为 ipv6 地址。

ii. 不需要禁用 ipv6。以管理员身份打开命令提示符并在命令提示符中使用以下命令

```
netsh
interface
portproxy
add v6tov4 listenport=80 connectport=80 
```

80 当然是你的网络服务器端口

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T07:01:59.617

在 Windows 上托管时，Drupal 对我来说总是运行缓慢。我已经尝试过 xampp、简单的 apache/php/mysql 安装和 zend 服务器。32 位或 64 位似乎与速度无关，但 32 位版本似乎更可用。到目前为止，zend 似乎好一点，但不如真正的 linux 服务器快。您是否尝试过使用 Ubuntu 或其他 Linux 的 VirtualBox？我在我的办公室里运行了一个 8GB 内存的 Ubuntu 服务器，它和一个不错的 VPS 服务器一样快。如果您还没有，我建议您尝试一下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T07:21:43.057

每个人都知道慢速网站对企业和您的网站用户不利。但是，解决问题可能具有挑战性，实施起来很慢，并且通常需要从头开始。

我在 windows7 操作系统上为我的 drupal 项目使用 wamp 服务器。它工作得非常好。这完全取决于您如何配置项目。我没有为我的项目使用任何缓存技术。该系统拥有 100 万用户。我为此进行了数据库调整，因此它加载数据非常快。

对于您的申请，我会建议您做一些事情

*   性能模块设置及其工作方式
*   缓存——最大的赢家以及如何实现 Boost
*   其他快速点击：关闭搜索、调整设置以及为什么运行 crons 很重要
*   向您的主机询问 APC 以及如何确保其设置正确
*   敢看数据库吗？简单的更改将有很大帮助！
*   监控最佳实践 - 设置什么以确保您知道您的服务器正在发生什么

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-07T10:42:05.950

尝试运行另一个简单的 Drupal 安装，看看问题是出在那个特定的站点还是你的开发设置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-17T02:35:00.563

我知道这是一个旧帖子，但我刚刚经历了同样的斗争。

我在 Windows 7 64 位虚拟机上安装了非常慢的 Drupal 7。我确实有 20 秒的页面加载时间。我挣扎了一会儿，试了一下：

*   禁用 IPv6
*   调整本地主机文件设置
*   增加内存限制
*   由于我的本地主机是一台开发机器，我不想一直启用缓存和操作码缓存，尽管我确实尝试过。

最后，主机文件更改产生了一些影响，但主要问题是 Drupal CRON。

事实证明，因为我正在复制我的生产安装以在本地工作，所以 CRON 在本地运行时无法完成它应该做的事情。因此它从未成功完成执行。

由于尝试失败，每个新请求都会尝试再次运行 CRON，因此页面执行时间为 20 秒。

您可以禁用 cron（例如，在 Administration > Configuration > System > Cron (admin/config/system/cron)，通过将“Run cron every”值设置为“Never”）。

请参阅此处了解更多信息：[https ://www.drupal.org/cron](https://www.drupal.org/cron)

# java - 如何替换char数组中的元音

> ID：13148648
> 
> 赞同：0
> 
> 时间：2012-10-30T22:41:57.603
> 
> 标签：java

我无法创建一个数组，该数组将使用用户输入的内容更改数组中的元音。出现的一个问题是，当它要求我提供信件时，`i`我得到一个`inputmismatch`.

```
/******************************************************************************
 * This function will prompt the user to replace all vowels in the array
 ******************************************************************************/
public static void replace( char [] letters )
{
    Scanner scan = new Scanner(System.in);
    System.out.print(" Enter a character for i: ");
    int S = scan.nextInt();

    for(int i = 0; i < letters.length; i++)
    {
        if(letters[i] == 'A' || letters[i] == 'E' || letters[i] == 'I')
        {
            letters[i]= (char)S;
            System.out.print(letters);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:49:30.163

打印数组与打印原始数据类型不同。你有什么

```
System.out.print(letters); 
```

您可以通过遍历它来打印数组

```
for(int k =0;k < letters.length;k++){   
    System.out.println(letters[k]);
} 
```

扫描仪还要求用户输入一个数字，看来您真的希望他们输入一个字母

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:49:32.363

要从输入中读取单个字符，`Scanner`您可以简单地使用：

```
char s = scan.next().charAt(0); 
```

或者

```
char s = scan.findInLine(".").charAt(0); 
```

如果您只想消耗一个字符。

# iphone - 以编程方式实例化 ViewController 导致黑色视图

> ID：13148649
> 
> 赞同：0
> 
> 时间：2012-10-30T22:42:03.423
> 
> 标签：iphone, ipad, ios5.1

我在 Storyboard 中使用了一个简单`GLKViewController`的，它工作正常。

因为我希望它的视图显示在另一个视图的前面，为了将 openGL 对象放在另一个视图之上，我`GLKViewController`在第二个 VC 中以编程方式实例化该视图并将视图添加`GLKViewController´s`为子视图：

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle: nil]; 
AROpenGLVC *openGlVC = [storyboard instantiateViewControllerWithIdentifier:@"objects OpenGL Controller"];
[self.view addSubview:openGlVC.view]; 
```

不幸的是，结果是没有我的动画 openGL 对象的黑色视图。

我运行了调试器，它似乎也经历了所有初始化。

`- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect`也被称为，

但`- (void)update`方法不是。

一定是显而易见的，但我不明白为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:35:57.987

尝试这个：

```
-(IBAction)nextView{
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard"   
bundle:nil];
AROpenGLVC * nextView = (AROpenGLVC *) [storyboard 
instantiateViewControllerWithIdentifier:@"detailView"];
[self presentViewController:detailView animated:YES completion:nil];
} 
```

//在第 4 行显示 ...WithIdentifier:@"detailView"];，进入您的故事板，然后单击视图控制器（黄色框）并单击选项卡，您可以在其中选择视图控制器所属的类（身份检查员）。

在右侧，将情节提要与 "" 之间的名称相同。然后将该方法连接到一个按钮，它应该为您切换视图！

Ps 确保您具有与指定的故事板名称相同的故事板名称！:D

**如果您想自动呈现视图，请确保您已正确命名视图控制器！**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T01:36:05.713

您是否在根视图控制器中保留了 AROpenGLVC？

# java - Java 在 buttonPanel 的左侧和右侧显示带有画布的 JPanel

> ID：13148657
> 
> 赞同：0
> 
> 时间：2012-10-30T22:42:32.237
> 
> 标签：java, jframe, jpanel

我正在做一个项目，我需要在另外两个 JPanel 中间有一个 buttonPanel，这些 JPanel 容纳画布（画布绘制矩形）。我被困在如何做到这一点上。

我的 GUI 类：

```
import javax.swing.*; 
import java.awt.*;
import java.awt.event.*;
import java.util.ArrayList;

public class GUI extends JFrame implements ActionListener 
{
private static final Dimension PREF_SIZE = new Dimension(1350, 450);

MyCanvas leftCanvas = new MyCanvas();
MyCanvas rightCanvas = new MyCanvas();
ArrayList<JButton> buttonList = new ArrayList<JButton>(); 
JPanel buttonPanel, leftPanel, rightPanel;

public GUI()
{
  super("Elevators");
    //setSize(800,800);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    //setVisible(true);

    JPanel mainPanel = new JPanel();

    mainPanel.setLayout(new GridLayout(1,3));

    leftPanel = new JPanel(); 
    leftPanel.add(leftCanvas);
    rightPanel = new JPanel();    
    rightPanel.add(rightCanvas);

    buttonPanel = new JPanel();     
    buttonPanel.setLayout(new GridLayout(12,1));   
    buttonPanel.setSize(450,450);

    add(mainPanel); 

    for(int i=0; i<12; i++)
    {
        buttonList.add(new JButton(""+i));
        JButton btn = buttonList.get(i);
        buttonPanel.add(btn);
        l
    }
    mainPanel.add(buttonPanel, BorderLayout.CENTER);
    mainPanel.add(leftPanel, BorderLayout.EAST);
    mainPanel.add(rightPanel, BorderLayout.WEST);

    createAndShowGui();
}
@Override
public Dimension getPreferredSize() {
    return PREF_SIZE;
}
private static void createAndShowGui() {
  UI frame = new UI();
  frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
  frame.pack();
 // frame.setLocationByPlatform(true);
  frame.setVisible(true);
}

public void actionPerformed(ActionEvent e)
{

}

} 
```

我的 Canvas 类（还没有太多内容）：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.JFrame;
import javax.swing.JButton;

public class MyCanvas extends Canvas 
{
private Elevator e;

int xPos =0;
int yPos=0;

public MyCanvas()
{
   setSize(600,600);
   repaint();
}

public void paint(Graphics g)
{
   g.setColor(Color.BLACK);
   g.fillRect(xPos,yPos,100, 100);

}

public void actionPerformed(ActionEvent e)
{
    repaint();
}
public void setElevator(Elevator ev)
{
    e = ev;
}
} 
```

想要看起来像这样 ![想要看起来像这样](../Images/d330930aa800b477778ac4d7e79d3906.png)

现在的样子
![现在的样子](../Images/f0f0976750d49df32b3f37b48e7fd530.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:07:02.940

您正在与布局管理器作斗争。最后，布局管理器将获胜。

```
// You really shouldn't be doing this, mixing heavy and light weight components is
// simply asking for trouble.
//public class MyCanvas extends Canvas 
public class MyCanvas extends JPanel
{
    private Elevator e;

    int xPos =0;
    int yPos=0;

    public MyCanvas()
    {
       // Don't do this, the layout manager will overwrite the values
       //setSize(600,600);
       // Don't do this, it doesn't actually do anything as you ain't in
       // in position to paint yet...
       //repaint();
    }

    // Do this instead...
    public Dimension getPreferredSize() {
        return new Dimension(600, 600);
    }

    public void paint(Graphics g)
    {
        // You MUST do this...
        super.paint(g);
        g.setColor(Color.BLACK);
        g.fillRect(xPos,yPos,100, 100);
    }

    public void actionPerformed(ActionEvent e)
    {
        repaint();
    }

    public void setElevator(Elevator ev)
    {
        e = ev;
    }
} 
```

花一些时间阅读：

*   [使用布局管理器](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)
*   [执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)

获取一些有助于您前进的有用信息。

# iphone - 在创建较早的表后添加新的起始视图 - 不起作用

> ID：13148658
> 
> 赞同：2
> 
> 时间：2012-10-30T22:42:33.843
> 
> 标签：iphone, objective-c, xcode, uitableview, uiviewcontroller

我正在使用 UIKit 元素和 xib 文件开发一些应用程序。首先，我创建了由表和详细视图组成的主详细信息应用程序。我已经自定义了单元格和详细视图，一切都很好。然后我想添加一个新视图，它的行为就像用户将看到的第一个视图。我创建了新视图，然后想将其添加到应用程序委托中，就像添加了主视图一样。它有效，但详细视图不起作用，我不知道为什么。这里有一些代码让它更清楚。

应用委托：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
[self customizeAppearance];
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
HomeScreenViewController *homescr = [[HomeScreenViewController alloc]initWithNibName:@"HomeScreenViewController" bundle:nil];
self.navigationController = [[UINavigationController alloc] initWithRootViewController:homescr];
self.window.rootViewController = self.navigationController;
[self.window makeKeyAndVisible];
return YES;
} 
```

我的新第一个视图有一个按钮：

```
- (IBAction)goToTableView:(id)sender {
MasterViewController *tableView = [[MasterViewController alloc]initWithNibName:@"MasterViewController" bundle:nil];
[self presentViewController:tableView animated:YES completion:nil];
} 
```

它转到 masterViewController 和显示表。然后我单击表中的每个元素，没有任何反应。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath*)indexPath
{
NSLog(@"did select is up");
if (!self.detailViewController) {
    self.detailViewController = [[DetailViewController alloc] initWithNibName:@"DetailViewController" bundle:nil];
}
NSDate *object2 = [array1 objectAtIndex:[indexPath row]];
self.detailViewController.detailItem = object2;
[self.navigationController pushViewController:self.detailViewController animated:YES];
} 
```

NSLog 显示信息，但没有出现详细视图。此外，navigationController 显示在第一个视图中，在表视图中不可见。

有人可以告诉我我做错了什么吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:55:30.663

为什么不在 goToTableView 方法中推送堆栈视图 tableView。在那之后，一切都应该工作：

```
- (IBAction)goToTableView:(id)sender {
    MasterViewController *tableView = [[MasterViewController alloc]initWithNibName:@"MasterViewController" bundle:nil];
    [self.navigationController pushViewController:tableView animated:YES];
} 
```

有关更多信息，请参阅此主题：[推模态视图](https://stackoverflow.com/questions/8619805/ios-pushing-another-viewcontroller-on-a-model-view)

# objective-c - ios - 使用dismiss(modal)View 跟踪视图

> ID：13148659
> 
> 赞同：0
> 
> 时间：2012-10-30T22:42:48.100
> 
> 标签：objective-c, ios, dismiss, uistoryboardsegue, multiple-views

我正在尝试将一个数字（UILabel）发送到另一个 UIViewController。

现在我可以采用一种方式，但是当我返回到初始控制器时，我还需要将结果带回初始控制器。

最重要的是，我试图用 4 个 UILabel 来做到这一点，所以我需要区分它们。

现在要进入第二个 ViewController 我想使用这样的 segue：

```
 if ([segue.identifier isEqualToString:@"ChangeNumberSegue"])
{
    NSLog(@"Changing the Number on NumberPadViewController");

    NumberPadViewController *numberPad = segue.destinationViewController;

    if(_BtnNumber01)
    {
        numberPad.numberLine.text = _LblNumber01.text;
    }
    if(_BtnNumber02)
    {
        numberPad.numberLine.text = _LblNumber02.text;
    }
    if(_BtnNumber03)
    {
        numberPad.numberLine.text = _LblNumber03.text;
    }
    if(_BtnNumber04)
    {
        numberPad.numberLine.text = _LblNumber04.text;
    }
} 
```

问题是：一旦我完成第二个视图，正确的方法是什么？一旦我进入第二个视图，它只会更改所选标签的编号。

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:46:28.113

假设这是一个模态序列...

代替实际的返回值，只需在您要设置的第一个视图控制器中创建一个属性，例如：

```
@property (nonatomic, assign) NSInteger theValue; 
```

在第二个视图控制器中，您可以获得第一个视图控制器的句柄，例如：

```
FirstViewController *vc = (FirstViewController *) [self presentingViewController];
vc.theValue = 5; 
```

至于返回到原始视图控制器，您可以将其添加到您的第二个视图控制器中：

```
[self dismissViewControllerAnimated:YES completion:nil]; // iOS 6
// or
[self dismissModalViewControllerAnimated:YES]; // iOS 5 or earlier 
```

# php - 单元测试魔术方法

> ID：13148669
> 
> 赞同：5
> 
> 时间：2012-10-30T22:44:20.643
> 
> 标签：php, unit-testing, phpunit

当谈到 PHP 中魔术方法的单元测试实现时，调用这些方法的推荐方法是什么？

我看到三个可用的选项：

*   显式/直接调用它们：

    `$object->__get('someValue');`

*   间接调用它们（使用旨在触发它们的任何操作）：

    `$object->someValue; \\ Where __get() is implemented.`

*   使用这两种方法调用它们。

是否有任何单元测试老手可以解释哪个（如果有）是显而易见的选择，为什么会这样？

*（这可能接近主观/辩论领域，但我会问，希望在处理这个问题时我应该考虑一些普遍接受的原则。）*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T22:51:48.113

您应该测试*可观察的行为*。所以，第二个 ( `$obj->property`)*必须*测试，毫无疑问。

至于实际直接调用 getter，那更像是一个判断调用。一旦你说过`__get('someProperty')`，在我看来，你几乎已经确定它是一个神奇的属性。由于我尝试从不更改测试，如果出于某种原因，我希望它成为一个普通的旧非魔法属性，这会使事情变得相当复杂。从好的方面来说，您可以调用 getter 并以另一种方式获取属性，并确保它们都具有完全相同的结果。

# java - 为什么我的原始列表数组被修改

> ID：13148672
> 
> 赞同：1
> 
> 时间：2012-10-30T22:44:39.733
> 
> 标签：java, list, reference

为什么当我打电话

```
ArrayList<String> reversedList = ListUtils.reverse(list); 
```

正在修改原始列表，即使我在方法中制作了它的副本

```
package com.javablackbelt.utils;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;

public class ListUtils {

    public static void main(String arg[]) {
        String[] arr = {"one", "two", "three", "four", "five"};
        ArrayUtils.print(arr);

        System.out.println();

        String [] reversedArr = ArrayUtils.reverse(arr);
        ArrayUtils.print(reversedArr);

        System.out.println();

        ArrayList<String> list = ArrayUtils.toArrayList(arr);
        ListUtils.print(list);  

        ArrayList<String> reversedList = ListUtils.reverse(list);
        ListUtils.print(reversedList);

        String[] arrFromList = ListUtils.toArray(list);
        ArrayUtils.print(arrFromList);

    }

    public static void print(ArrayList<String> aStr) {
        System.out.print("list: [ ");
        for(String l: aStr)
            System.out.print(l+" ");
        System.out.println(" ] size: "+aStr.size());
    }

    public static ArrayList<String> reverse(ArrayList<String> aList) {
        ArrayList<String> newList = aList;

        Collections.reverse(newList);
        return newList;
    }

    public static String[] toArray(ArrayList<String> list) {
        ArrayList<String> newList = list;
        String[] newStr = newList.toArray(new String[list.size()]);

        return newStr;
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:46:12.290

`ArrayList<String> newList = aList;`没有创建新列表。它创建对同一列表的新引用。

可以通过以下方式创建新列表：

```
ArrayList<String> newList = new ArrayList<String>(aList.size());
for (String str : aList)
    newList.add(str); 
```

谢谢@JB Nizet 这要简单得多：

```
ArrayList<String> newList = new ArrayList<String>(aList); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:48:18.823

当您说`ArrayList<String> newList = aList;`您不是在创建新列表而是将 newList 指向`aList`. 如果您不想修改现有列表 ，请创建一个新的 ArrayList 并将其添加`aList`到其中。`newList`

```
public static ArrayList<String> reverse(ArrayList<String> aList) {
            ArrayList<String> newList= new ArrayList<>();
                     newList.addAll( aList);

            Collections.reverse(newList);
            return newList;
        } 
```

**编辑：**

```
use Collections.copy(List dest, List src) to copy. 
```

[在此处查看集合 API](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html#copy%28java.util.List,%20java.util.List%29)

# c++ - 带有生产者/消费者文件复制的 SegFault

> ID：13148673
> 
> 赞同：0
> 
> 时间：2012-10-30T22:44:41.810
> 
> 标签：c++, segmentation-fault, variable-assignment, producer-consumer, file-copying

返回另一个段错误。不知道为什么，因为这个 readdir 行与我在其他文件复制分配中使用的行相同。下面是我为代替[此处](https://stackoverflow.com/questions/13062275/file-copy-tool-w-producer-consumer-model/13062621#13062621)共享的作业而编写的代码。我已经评论了segfault发生的地方，希望帮助更好的人找到我的缺陷！

这是copyDirs.cpp

```
//cmd: ./a.out [#ofConsumerThreads] [src directory] [dest directory]

#include "copyDirs.h"

int main(int ac,char* av[])
{
pthread_mutex_init(&buflock,NULL);
pthread_t prodT;

if(ac == 4)
{
    int consNum = atoi(av[1]);

    pthread_t thread[consNum];

    strcpy(f1,av[2]);
    strcpy(f2,av[3]);

    directory = opendir(f1);
    pthread_create(&prodT,NULL,producer,NULL); //segfault happens in producer function

        pthread_join(prodT, NULL);

    for(int i=0;i<consNum && buffer.size() > 0;i++)
    {
        pthread_create(&thread[i],NULL,consumer,NULL);
            pthread_join(thread[i],NULL);
    }

    closedir(directory);
}
else cout<<"Try that again ;)"<<endl;

pthread_mutex_destroy(&buflock);
pthread_exit(NULL);

return 0;
} 
```

以及相关的头文件；

```
#ifndef COPYDIRS_H
#define COPYDIRS_H 

#include <iostream>
#include <stdio.h>
#include <sys/stat.h>
#include <string.h>
#include <dirent.h>
#include <pthread.h>
#include <time.h>
#include <stack>

using namespace std;

struct FD
{
public:
char* i ;
char* o;

FD(){}

FD(char* input, char* output)
{
    i=input;
    o=output;
}
};

char f1[PATH_MAX];
char f2[PATH_MAX];

struct dirent *curDir;
DIR* directory = NULL;

pthread_mutex_t buflock;
stack <FD> buffer;

void* producer(void*)
{
cout<<"SegTest"<<endl;
    //shows

while (curDir = readdir(directory)) //segfault on this line
{
    cout<<"SegTest"<<endl;
        //doesn't show

    char* file = curDir -> d_name;
    char* i = new char[256];
    char* o = new char[256];

    strcpy(i,f1);
    strcpy(o,f2);
    strcat(i,file);
    strcat(o,file);
    FD prodFD(i,o);

    cout<<"Pushing "<<file<<" to buffer!"<<endl;
    pthread_mutex_lock(&buflock);
        buffer.push(prodFD);
    pthread_mutex_unlock(&buflock);

    i = NULL;
    o = NULL;
}

pthread_exit(NULL);
}

void* consumer(void*)
{
FD consFD;
char c;

consFD = buffer.top();
buffer.pop();
    //ERROR: "statement cannot resolve address of overloaded function

cout << "Copying file: "<<consFD.i<<endl;
pthread_mutex_lock(&buflock);
    FILE * consIF = fopen(consFD.i,"r");
    FILE * consOF = fopen(consFD.o,"w");
pthread_mutex_unlock(&buflock);

pthread_exit(NULL);
}
#endif 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:06:48.180

`directory`在调用之前尝试检查 的值是否为 NULL `readdir`。你有这条线

```
 directory = opendir(f1); 
```

但不检查返回值是否为 NULL，这可能是段错误的原因。至少，如果您为目录传递了无效的命令行参数，这将防止出现段错误。

# graphite - 为什么这个立体主义 JS 片段不会从 Graphite 生成图形？

> ID：13148674
> 
> 赞同：0
> 
> 时间：2012-10-30T22:44:41.357
> 
> 标签：graphite, cubism.js

我正在尝试使用此 JS 片段生成图表。我似乎对metrics2有问题。

如果我将 metrics2 设置为这个，则在我的浏览器中呈现一个图表。

[1]

```
 var metrics2 = [
     graphite.metric("servers.<HOSTNAME>-1_domain_local.load.load.shortterm"), 
     graphite.metric("servers.<HOSTNAME>-2_domain_local.load.load.shortterm"), 
     graphite.metric("servers.<HOSTNAME>-3_domain_local.load.load.shortterm"), 
     graphite.metric("servers.<HOSTNAME>-4_domain_local.load.load.shortterm")
 ] 
```

但是，在以下 js 代码中，图表不会在我的浏览器中呈现。

[2]

```
var metrics = [];
graphite.find("servers.*.load.load.shortterm", function(error, results) {
    for (var i = 0; i < results.length; i++) {
        metrics[i] = results[i];
    }
});

var metrics2 = metrics.map(function(i) { 
    return graphite.metric(i);
}); 
```

这是调用 metrics2 并生成图表的立体派片段。

```
d3.select(".span4").call(function(div) {
    a = metrics.length;
    div.select(".charts2").call(context.axis().orient("top"));
    div.select(".charts2").selectAll(".horizon")
        .data(metrics2)
        .enter().append("div")
        .attr("class", "horizon")
        .call(context.horizon().height(30));
}); 
```

为什么 [2] 不会实际生成图表？metrics2 数组有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:30:47.493

我想到了。这段 JS 将使必要的事情发生。

```
graphite.find("servers.???-in-?-*.load.load.shortterm", function(error, results) {
    var metrics = results.map(function(i) {
        return graphite.metric(i);
    });

    d3.select(".span4").call(function(div) {
        div.select(".charts2").call(context.axis().orient("top"));
        div.select(".charts2").selectAll(".horizon")
            .data(metrics)
            .enter().append("div")
            .attr("class", "horizon")
            .call(context.horizon().height(30));
    });
}); 
```

# javascript - chrome 扩展脚本在某些页面上加载了两倍甚至更多

> ID：13148677
> 
> 赞同：12
> 
> 时间：2012-10-30T22:44:52.687
> 
> 标签：javascript, google-chrome-extension

这是我的 background.js 文件

```
 chrome.tabs.onUpdated.addListener(function(tabId,info, tab) {
    var sites =new Array('site2','site1');
    var url=tab.url;
    var siteFlag=0;
    for(var i in sites) {
       var regexp = new RegExp('.*' + sites[i] + '.*','i');
       if (regexp.test(url)) {siteFlag=1;}
    };
    if(siteFlag==1){
      chrome.tabs.executeScript(tabId, {file:"contentscript.js"});
      chrome.tabs.executeScript(tabId, {file:"jquery.js"});
      chrome.tabs.insertCSS(tabId,{file:"box.css"});
    }
 }); 
```

在 contentscript.js 中，我只是运行一个弹出框。

```
$(document).ready(function () {
    function popup() {...}
    if (window.addEventListener)
    {
        window.addEventListener('load', popup(), false); 
    } 
    else if (window.attachEvent)
    {
        window.attachEvent('onload', popup());
    }
}); 
```

有些页面只有一个弹出框，有些页面有两个甚至更多

问题是什么？

=============编辑===================

这些页面包含 iframe

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-31T07:13:56.830

`chrome.tabs.onUpdated.addListener`当标签状态更改时，会触发，这与iframes无关。您的脚本被多次注入到同一帧，因为您为每次状态更改注入它，并且您只想在状态更改为“完成”时注入它。通过添加修改您的代码`if (changeInfo.status == "complete") {`：

```
chrome.tabs.onUpdated.addListener(function(tabId,info, tab) {
   if (info.status == "complete") {
      /* checking & injecting stuff */
   }
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-11-15T23:00:48.673

我不确定为什么内容脚本会加载两次。但我也有这个问题。我将以下内容添加到 manifest.json 中的“content_scripts”元素中，效果很好。

```
"content_scripts" : [
    {
        "all_frames" : false,
        "run_at" : "document_end",
    }
] 
```

**最后，manifest.json：**

```
{
    "name": "ABC",
    "version": "0.0.0.1",
    "manifest_version": 2,
    "key": "longkeyhere",
    "description": "Description",
    "minimum_chrome_version": "29",
    "background": {
        "scripts": [
            "jquery.js",
            "jquery.min.js",
        ]
    },
    "content_scripts" : [
        {
            "all_frames" : false,
            "run_at" : "document_end",
            "matches" : [ "http://*/*" ],
            "js" : [
                "jquery.js",
                "jquery.min.js",
            ]
        }
    ],
    "options_page": "options.html",
    "permissions": [
        "http://*/*",
        "https://*/*",
        "contextMenus",
        "tabs",
        "identity",
        "storage"
    ]
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T13:02:05.377

您可以使用扩展的清单文件控制内容脚本的执行：您可以阻止内容脚本加载到 iframe 或一组特定的 url。这是一个示例清单部分：

```
"all_frames": true,
 "js": [ "ContentOnDocStart.js" ],
 "matches": [ "http://*/*", "https://*/*" ],
 "exclude_matches": [ ],
 "run_at": "document_start" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T22:58:32.547

这很可能是由使用框架的页面引起的。为每一帧加载脚本。如果您绝对想只执行一次脚本，您可能能够检测到您在哪一帧中加载，或者一帧是否已经有您的脚本。

# c# - 更改 OpenXML Word 文档中的字体颜色（C#）

> ID：13148679
> 
> 赞同：12
> 
> 时间：2012-10-30T22:45:04.023
> 
> 标签：c#, openxml

我一直在寻找几个小时，我似乎无法找到一个可靠的答案。我有一个包含内容控件的现有文档，我需要使用外部数据编辑文本。如果其中一个控件的数据不存在，那么我需要用适当的通知替换文本并更改字体颜色。

我有文本输入，所有工作都很好，唯一似乎无法完成工作的部分是更改字体颜色。我拥有的当前代码没有给我任何错误，并且可以很好地运行此方法，但是当我查看完成的文档时，它仍然是纯黑色文本。

我的换色方法：（输入的是所有同标签的内容控件的列表）

```
public void SetBlueText(List<SdtElement> sdtElement)
{
    foreach (SdtElement element in sdtElement)
    {
        if (element != null)
        {
            RunProperties runProperties = element.Descendants<RunProperties>().FirstOrDefault();
            runProperties.Color = new DocumentFormat.OpenXml.Wordprocessing.Color() { Val = "0EBFE9" };
        }
    }
} 
```

此外，将这两行简化为仅此 / 具有相同的效果

```
element.Descendants<RunProperties>().FirstOrDefault().Color = 
                        new DocumentFormat.OpenXml.Wordprocessing.Color() { Val = "0EBFE9" }; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-06-20T18:36:50.900

我遇到了类似的问题，并发现由于某种原因，您将对象附加到 RunProperties 对象的顺序实际上会影响格式更新是否有效（我注意到的模式是，如果您在进行格式设置之前附加文本，则该文本的格式不会粘住）。

例如这有效（文本变为粗体，Cambria 标题，颜色设置为蓝色）

```
Run formattedRun = new Run();
RunProperties runPro = new RunProperties();
RunFonts runFont = new RunFonts() { Ascii = "Cambria(Headings)", HighAnsi = "Cambria(Headings)" };
Bold bold = new Bold();
Text text = new Text("TESTING");
Color color = new Color() { Val = "365F91", ThemeColor = ThemeColorValues.Accent1, ThemeShade = "BF" };
runPro.Append(runFont);
runPro.Append(bold);
runPro.Append(color);
runPro.Append(text);
formattedRun.Append(runPro); 
```

但这不是（文本变为 Cambria Headings 和 Bold，但颜色保持标准黑色）

```
Run formattedRun = new Run();
RunProperties runPro = new RunProperties();
RunFonts runFont = new RunFonts() { Ascii = "Cambria(Headings)", HighAnsi = "Cambria(Headings)" };
Text text = new Text("TESTING");
Bold bold = new Bold();
Color color = new Color() { Val = "365F91", ThemeColor = ThemeColorValues.Accent1, ThemeShade = "BF" };
runPro.Append(runFont);
runPro.Append(bold);
runPro.Append(text);
runPro.Append(color);
formattedRun.Append(runPro); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-31T18:03:10.090

好吧，我有点粗暴地强迫自己找到答案，但它确实有效。

```
List<RunProperties> runProps = element.Descendants<RunProperties>().ToList();
foreach (RunProperties rp in runProps)
{
    rp.Color = new DocumentFormat.OpenXml.Wordprocessing.Color() { Val = "0EBFE9" };
} 
```

如果有人有更优雅的解决方案，请添加它，我会支持它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-23T12:02:15.487

我需要与 OP 非常相似的东西，因为我在运行时填充的 word 文档模板中有一大堆纯文本和其他控件。我创建了一个扩展方法来设置文本和其他格式设置。希望这将帮助像我一样来到这里有需要的人：

```
 public static void ReplaceText(this SdtElement element, string replacementText, bool? isBold = null, bool? isItalic = null, System.Drawing.Color? color = null, VerticalPositionValues? textVerticalType = null, int? fontSizeComplexScript = null)
    {

        // First try to get content blocks from the element
        IEnumerable<SdtContentBlock> childContentBlocks = element.ChildElements.OfType<SdtContentBlock>();

        //Function to generate the new run properties
        RunProperties SetupNewRunProperties(RunProperties oldRunProps) { 

            var props = new RunProperties();

            if (fontSizeComplexScript.HasValue && fontSizeComplexScript.HasValue)
                props.FontSizeComplexScript.Val = fontSizeComplexScript.ToString();
            else if (oldRunProps?.FontSizeComplexScript != null)
                props.FontSizeComplexScript = (FontSizeComplexScript)oldRunProps.FontSizeComplexScript.CloneNode(true);

            if (isBold.HasValue) 
                props.Bold.Val = OnOffValue.FromBoolean(isBold.Value);
            else if(oldRunProps?.Bold != null)
                props.Bold = (Bold)oldRunProps.Bold.CloneNode(true);

            if (isItalic.HasValue)
                props.Italic.Val = OnOffValue.FromBoolean(isItalic.Value);
            else if (oldRunProps?.Italic != null)
                props.Italic = (Italic)oldRunProps.Italic.CloneNode(true);

            if (textVerticalType.HasValue)
                props.VerticalTextAlignment.Val = textVerticalType.Value;
            else if (oldRunProps?.VerticalTextAlignment != null)
                props.VerticalTextAlignment = (VerticalTextAlignment)oldRunProps.VerticalTextAlignment.CloneNode(true);

            if (color.HasValue)
            {
                if (props.Color != null)
                    props.Color.Val = color.Value.ToHexString();
                else
                    props.Color = new Color() { Val = color.Value.ToHexString() };
            }
            else if (oldRunProps?.Color != null)
            {
                props.Color = (Color)oldRunProps?.Color.CloneNode(true);
            }

            return props;
        }

        if (childContentBlocks.Count() > 0)
        {
            SdtContentBlock contentBlock = childContentBlocks.First();
            Paragraph para = contentBlock.ChildElements.OfType<Paragraph>().First();
            if (para != null)
            {
                Run run = para.GetFirstChild<Run>();

                run.RunProperties = SetupNewRunProperties(run.RunProperties);

                Text text = run.GetFirstChild<Text>();
                text.Text = replacementText;
            }
        }
        else
        {
            // Instead, try to get content runs from the element
            IEnumerable<SdtContentRun> childContentRuns = element.ChildElements.OfType<SdtContentRun>();

            if (childContentRuns.Count() > 0)
            {
                Run run = childContentRuns.First().GetFirstChild<Run>();

                run.RunProperties = SetupNewRunProperties(run.RunProperties);

                Text text = run.GetFirstChild<Text>();
                text.Text = replacementText;
            }
        }

    } 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-07-22T06:23:14.120

颜色值应为 8 位。例如 Color.Val="FFFF0000" 以红色显示字符串。

# java - Android：每秒获取 cdmaDbm

> ID：13148680
> 
> 赞同：1
> 
> 时间：2012-10-30T22:45:10.340
> 
> 标签：java, android, networking

对你来说只是一个简单的问题，因为我找不到任何相关信息。我只想每隔一秒记录一次**CDMA信号强度。**

你有什么指示吗？

我找到了很多例子，但他们都使用了`onSignalChange()`对我来说并不适用的方法。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-03T17:26:13.097

好吧，我不确定这是否是您要查找的内容，但是在查看了 android 源代码中的 SignalStrength.java 文件后，我注意到一些代码具有 cdma dbm 和 ecio 级别的一堆级别。

```
DBM 
level 4 >= -75
level 3 >= -85
level 2 >= -95
level 1 >= -100

Ecio 
level 4 >= -90
level 3 >= -110
level 2 >= -130
level 1 >= -150 
```

而level是两者中最低的

```
actualLevel = (levelDbm < levelEcio) ? levelDbm : levelEcio; 
```

但我注意到这与通知中显示的实际条不相关。如果在 3G 中，则忽略此级别并使用信噪比。

```
signalStrength.getEvdoSnr() // value is 0 to 8 so divide by two to get the bars 
```

如果数据从 3G 下降到 1x，则使用实际级别。

这是我查找显示条数的代码。

```
 public void onSignalStrengthsChanged(SignalStrength signalStrength) {
        super.onSignalStrengthsChanged(signalStrength);
        if (signalStrength.isGsm()) {
            if (signalStrength.getGsmSignalStrength() != 99)
                signalStrengthValue = signalStrength.getGsmSignalStrength() * 2 - 113;
            else
                signalStrengthValue = signalStrength.getGsmSignalStrength();
        } else {
            final int snr = signalStrength.getEvdoSnr();
            final int cdmaDbm = signalStrength.getCdmaDbm();
            final int cdmaEcio = signalStrength.getCdmaEcio();
            int levelDbm;
            int levelEcio;
            int level = 0;

            if (snr == -1) {
                if (cdmaDbm >= -75) levelDbm = 4;
                else if (cdmaDbm >= -85) levelDbm = 3;
                else if (cdmaDbm >= -95) levelDbm = 2;
                else if (cdmaDbm >= -100) levelDbm = 1;
                else levelDbm = 0;

                // Ec/Io are in dB*10
                if (cdmaEcio >= -90) levelEcio = 4;
                else if (cdmaEcio >= -110) levelEcio = 3;
                else if (cdmaEcio >= -130) levelEcio = 2;
                else if (cdmaEcio >= -150) levelEcio = 1;
                else levelEcio = 0;

                level = (levelDbm < levelEcio) ? levelDbm : levelEcio;
            } else {
                if (snr == 7 || snr == 8) level =4;
                else if (snr == 5 || snr == 6 ) level =3;
                else if (snr == 3 || snr == 4) level = 2;
                else if (snr ==1 || snr ==2) level =1;

            }

            text.setText("Bars= " + level);

        }
    } 
```

在 on create 方法中使用下面的这个，并确保清单使用 READ_PHONE_STATE。

```
 TelephonyManager telephonyManager = (TelephonyManager)getSystemService(Context.TELEPHONY_SERVICE);
    AndroidPhoneStateListener phoneStateListener = new AndroidPhoneStateListener(text);
    telephonyManager.listen(phoneStateListener, PhoneStateListener.LISTEN_SIGNAL_STRENGTHS); 
```

# objective-c - 在并发队列中使用 dispatch_semaphore_t 死锁

> ID：13148684
> 
> 赞同：2
> 
> 时间：2012-10-30T22:45:48.373
> 
> 标签：objective-c, multithreading, macos, cocoa, grand-central-dispatch

我正在开发一个使用 GCD 运行大量后台作业的 MacOS X 应用程序。后台作业使用 CLucene 来索引文档，并在子上下文中访问 Core Data。

这些作业都是按顺序生成的（在使用 DISPATCH_QUEUE_CONCURRENT 创建的队列上使用 dispatch_async），但一次只有 4 个执行实际工作。这是使用 dispatch_semaphore_t 完成的，通过在作业开始时等待它并在作业完成时释放它。

在以下情况下，我看到了一个非常奇怪、可靠可重现的死锁：

1.  后台作业仍在运行
2.  用户将焦点切换到另一个应用程序，然后返回

NSWindow 在显示菜单栏时尝试发送通知显然是死锁的。这是发生这种情况时主线程的堆栈跟踪：

```
 #0  0x00007fff870ae6c2 in semaphore_wait_trap ()
#1  0x00007fff8b1bf486 in _dispatch_semaphore_wait_slow ()
#2  0x00007fff8b69c12b in -[_NSDNXPCConnection sendMessage:waitForAck:] ()
#3  0x00007fff8b57ced5 in _CFXNotificationPost ()
#4  0x00007fff8b58bbf3 in CFNotificationCenterPostNotification ()
#5  0x00007fff902ae174 in HIS_XPC_CFNotificationCenterPostNotification ()
#6  0x00007fff8bd3612a in BroadcastToolboxMessage ()
#7  0x00007fff8bd6d063 in MenuBarInstance::Show(MenuBarAnimationStyle, unsigned char, unsigned char, unsigned char) ()
#8  0x00007fff8bd98144 in SetMenuBarObscured ()
#9  0x00007fff8bd97e0f in HIApplication::HandleActivated(OpaqueEventRef*, unsigned char, OpaqueWindowPtr*) ()
#10 0x00007fff8bd95407 in HIApplication::EventObserver(unsigned int, OpaqueEventRef*, void*) ()
#11 0x00007fff8bd636e0 in _NotifyEventLoopObservers ()
#12 0x00007fff898dc018 in -[NSWindow sendEvent:] ()
#13 0x00007fff898d8744 in -[NSApplication sendEvent:] ()
#14 0x00007fff897ee2fa in -[NSApplication run] ()
#15 0x00007fff89792cb6 in NSApplicationMain ()
#16 0x0000000100001e52 in main at /Users/mspong/dev/Indx/Indx/Indx/main.m:13
#17 0x00007fff86b7b7e1 in start () 
```

所有正在运行的后台作业都完成了它们的工作，但没有其他作业可以访问上述信号量。每个线程都卡在 semaphore_wait_trap 上。

我无法想象我可能会做什么（显然）导致不相关的信号量（我的和苹果的）卡住。有人可以就如何进一步调查提供一些建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T23:02:50.423

您是否有可能达到 GCD 并发队列线程限制（64 个线程），然后做一些尝试在并发队列上工作的事情？这将导致整个框架的随机死锁。

如果是这种情况，我唯一的建议是：永远不要阻塞在并发队列中。

# php - 从变量中删除表情符号

> ID：13148690
> 
> 赞同：6
> 
> 时间：2012-10-30T22:46:12.330
> 
> 标签：php, smarty

我正在使用 Smarty 传入并显示`first_name`变量的内容。一些用户的表情符号字符（[http://en.wikipedia.org/wiki/Emoji](http://en.wikipedia.org/wiki/Emoji)），`first_name`我想知道如何 a）有条件地不显示`first_name`包含表情符号的用户或 b）从`first_name`. Smarty可以做到这一点吗？可以在 Smarty 中用 PHP 完成吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-30T23:16:18.207

表情符号在 U+1F300–U+1F5FF 块中编码。

```
preg_replace('/\xEE[\x80-\xBF][\x80-\xBF]|\xEF[\x81-\x83][\x80-\xBF]/', '', $first_name) 
```

这会去掉那些

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-01-05T16:26:26.260

我尝试了上面发布的一些解决方案，但是没有一个有效，但是，当我使用 mb_ 函数将字符串转换为 UTF-8 时，它可以正常工作。

您可以使用：

```
trim( preg_replace('/[\x00-\x1F\x80-\xFF]/', '', 
      mb_convert_encoding( $emojiString, "UTF-8" ) ) ); 
```

为我工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T10:21:08.423

问：这可以用 Smarty 完成吗？答：是的。

Q: Smarty 中可以用 PHP 完成吗？答：是的。但请不要在模板端使用 PHP 标签。

尝试在模板变量上使用变量修饰符。

```
{* apply modifier to a variable *}
{$first_name|emojistrip} 
```

将以下内容放入文件夹“/smarty/plugins/”中名为“modifier.emojistrip.php”的文件中。

```
function smarty_modifier_emojistrip($string)
{       
    return preg_replace('/\xEE[\x80-\xBF][\x80-\xBF]|\xEF[\x81-\x83][\x80-\xBF]/', '', $string);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-08T07:30:02.927

```
function remove_emoji($string) {

    // Match Emoticons
    $regex_emoticons = '/[\x{1F600}-\x{1F64F}]/u';
    $clear_string = preg_replace($regex_emoticons, '', $string);

    // Match Miscellaneous Symbols and Pictographs
    $regex_symbols = '/[\x{1F300}-\x{1F5FF}]/u';
    $clear_string = preg_replace($regex_symbols, '', $clear_string);

    // Match Transport And Map Symbols
    $regex_transport = '/[\x{1F680}-\x{1F6FF}]/u';
    $clear_string = preg_replace($regex_transport, '', $clear_string);

    // Match Miscellaneous Symbols
    $regex_misc = '/[\x{2600}-\x{26FF}]/u';
    $clear_string = preg_replace($regex_misc, '', $clear_string);

    // Match Dingbats
    $regex_dingbats = '/[\x{2700}-\x{27BF}]/u';
    $clear_string = preg_replace($regex_dingbats, '', $clear_string);

    return $clear_string;
} 
```

[在https://medium.com/coding-cheatsheet/remove-emoji-characters-in-php-236034946f51](https://medium.com/coding-cheatsheet/remove-emoji-characters-in-php-236034946f51)找到了这个答案

# javascript - Chrome 预渲染功能会导致交互页面出现问题

> ID：13148691
> 
> 赞同：3
> 
> 时间：2012-10-30T22:46:21.840
> 
> 标签：javascript, google-chrome, websocket

对于较新的 Google chrome 浏览器，即 17+ 版（不确定其他浏览器是否也这样做），默认情况下似乎具有预渲染功能（请参阅[http://support.google.com/chrome/bin/answer. py?hl=en&answer=1385029](http://support.google.com/chrome/bin/answer.py?hl=en&answer=1385029) ) 已启用，这意味着即使在用户完成在地址栏中输入 url 之前，页面已被加载！

我想这对于主要是静态内容的页面来说是一个很好的技巧，它可以欺骗用户通过更早地有效加载来加快页面加载速度。但是，这对于在加载时触发某些操作/逻辑的页面是有问题的。

例如，考虑一个`websocket`与服务器建立连接并在加载后立即发送消息的页面。当用户输入此页面的 url 时，很可能已经建立连接并发送了 msg，但是当用户在地址栏中实际按下“enter”时，`websocket`连接丢失并重新建立，并且 msg重新发送，可能是因为 websocket 将实际页面加载视为刷新。现在，如果您有一些响应断开连接或接收某些消息的逻辑，这可能会导致服务器端出现混乱的行为。另一个例子可能是重定向，在这种情况下可能会发生双重重定向，因为页面被有效地加载了两次。

有没有什么有效的方法来处理这个浏览器功能，除了关闭它是开发人员无法控制的？一些`JavaScript`技巧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T09:47:28.480

请参阅 [https://developers.google.com/chrome/whitepapers/pagevisibility](https://developers.google.com/chrome/whitepapers/pagevisibility)

使用 document.webkitVisibilityState 检查它是否处于“预渲染”状态。如果 websocket 处于“预渲染”状态，则不要连接它。

希望这可以帮助。欢呼！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-24T00:12:54.467

仅供参考，我遇到了这个问题并使用可见性状态来跳过套接字连接，但是从 51.0.2704.103 开始​​，突然我的页面在第一次加载时开始呈现白色。结果他们修复了它，以便预渲染将您的 Web 套接字连接持续到渲染的页面，但它不会重新运行您的代码；因此，如果您留下该代码，您最终将没有 Web 套接字或奇怪的错误或白页。有点乱，但现在我把预渲染检查拿回来了，它似乎又可以工作了。

# c++ - C++ 链表 - 从带有标记的文件中读取数据

> ID：13148692
> 
> 赞同：1
> 
> 时间：2012-10-30T22:46:24.260
> 
> 标签：c++, oop, while-loop, linked-list, sentinel

因此，我对此进行了大量研究，但无法使我的输出正常工作。我需要从文件中读取数据并将其存储到链接列表中。使用的 while 循环应在遇到 $$$$$ 标记后停止。然后我要显示数据（通过 ID 号 [用户输入] 搜索）我还没有那么远，但我只想正确显示数据并立即读取它。

我的问题是当它显示数据没有停止在 $$$$ 时（即使我执行 "inFile.peek() != EOF 并省略 $$$$）我仍然会收到额外的垃圾记录。

我知道这与我的 while 循环以及我如何创建一个新节点有关，但我无法让它以任何其他方式工作。

任何帮助，将不胜感激。

学生.txt

```
Nick J Cooley
324123
60
70
80
90
Jay M Hill
412254
70
80
90
100
$$$$$ 
```

分配6.h文件

```
#pragma once
#include <iostream>
#include <string>
using namespace std;
class assign6
{
public:
    assign6(); // constructor
    void displayStudents();

private:
struct Node
{ string firstName; 
  string midIni;    
  string lastName;
  int idNum;
  int sco1; //Test score 1
  int sco2; //Test score 2
  int sco3; //Test score 3
  int sco4; //Test score 4
   Node *next;
};
Node *head;
Node *headPtr;

}; 
```

assign6Imp.cpp // 实现文件

```
#include "assign6.h"
#include <fstream>
#include <iostream>
#include <string>
using namespace std;

assign6::assign6() //constructor
{

ifstream inFile;
inFile.open("students.txt");

head = NULL;
head = new Node;
headPtr = head;
while (inFile.peek() != EOF) //reading in from file and storing in linked list
{

    inFile >> head->firstName >> head->midIni >> head->lastName;
    inFile >> head->idNum;
    inFile >> head->sco1;
    inFile >> head->sco2;
    inFile >> head->sco3;
    inFile >> head->sco4;

    if (inFile != "$$$$$")
    {
    head->next = NULL;
    head->next = new Node;
    head = head->next;
    }
}

head->next = NULL;

inFile.close();
}

void assign6::displayStudents()
{
int average = 0;
for (Node *cur = headPtr; cur != NULL; cur = cur->next)
{
    cout << cur->firstName << " " << cur->midIni << " " << cur->lastName << endl;
    cout << cur->idNum << endl;
    average = (cur->sco1 + cur->sco2 + cur->sco3 + cur->sco4)/4;
    cout << cur->sco1 << " " << cur->sco2 << " " << cur->sco3 << " " << cur->sco4 << " " << "average: " << average << endl;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:26:03.420

也许您应该尝试逐行阅读，就像这样。

```
const string END_OF_FILE_DELIM = "$$$$$";
ifstream inFile("students.txt");
string line;
while( getline(inFile,line) ){
   cout << "line = " << line << endl;
   if(line == END_OF_FILE_DELIM){
      break;
   }
   else{
       //create new Node with value = line;
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:20:18.343

这行不通：

```
if (inFile != "$$$$$") 
```

您无法将流与“$$$$$”进行比较。您只能从流中读取一个字符串并将其与“$$$$$”进行比较。

# ruby-on-rails-3 - Rails 3：使用 json 将记录及其 has_many 关联从一个应用程序导入另一个应用程序

> ID：13148695
> 
> 赞同：2
> 
> 时间：2012-10-30T22:46:30.650
> 
> 标签：ruby-on-rails-3, json

假设我有两个具有完全相同架构和模型的数据库的 Rails 应用程序。我希望能够将一些记录从一个数据库导入到另一个数据库。例如，如果我有一个学生表，并且想将一个学生从一个数据库检索到另一个数据库怎么办？

我一直在发送学生 json 表示（`self`是学生）：

```
student_json = self.as_json(:include => [
                                 { :final_grade_batches => { :include => { :final_grade => { :include => :gradeable } } } }
                            ]) 
```

从应用程序 2 到应用程序 1。当我不包含用 has_many 定义的关联时，这有效，但是当我这样做时，如上例所示，我收到以下消息实例化学生（`Student.new(params[:student])`），其中 params[:student] 是 json从另一个应用程序检索：

```
ActiveRecord::AssociationTypeMismatch: FinalGradeBatch(#2159093540) expected, got Hash(#2151972720) 
```

当然，我已经`has_many :final_grade_batches`加入了学生模型。

有什么帮助吗？谢谢！

# c - 如何将随机数存储到以空字符结尾的字符数组中？

> ID：13148699
> 
> 赞同：1
> 
> 时间：2012-10-30T22:46:53.073
> 
> 标签：c, arrays, random, character, null-terminated

我认为 using`fgets`是最好的选择，但显然它需要来自标准输入的输入？如何使用 生成随机数`rand()`并存储它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:49:22.870

您可以使用`sprintf()`：

```
char buf[11];
int r = rand();
sprintf(buf, "%d", r); 
```

`snprintf()`如果您的运行时库提供它，则使用更强大的选项：

```
snprintf(buf, sizeof(buf), "%d", r); 
```

以`snprintf()`这种方式使用可确保生成的字符串不会溢出`buf`.

# android - TaskStackBuilder 和后栈的附加功能

> ID：13148701
> 
> 赞同：40
> 
> 时间：2012-10-30T22:47:05.847
> 
> 标签：android

我正在尝试使用带有通知的[TaskStackBuilder](http://developer.android.com/reference/android/app/TaskStackBuilder.html)来创建一个返回堆栈以供后退按钮通过。我的应用程序的正常流程：

1.  活动 A 从启动器启动。
2.  用户从 A 中选择一个项目，该项目启动 B 并附加要加载的内容。
3.  用户从 B 中选择一个项目，这将启动 C 并附加要加载的内容。

有时，在用户不使用我的应用程序时进行后台更新后，我会生成通知。如果他们单击此通知，它会启动 Activity C，跳过 A 和 B。我正在尝试遵循设计指南并创建一个后退堆栈，因此当他们按下返回时，它将转到 Activity B 而不是主屏幕。我的问题是 Activity B 在其启动意图中需要额外的内容来告诉它从数据库中获取什么。

我当前的 TaskStackBuilder 代码：

```
TaskStackBuilder sBuilder = TaskStackBuilder.create( this );
sBuilder.addParentStack( ActivityC.class );
sBuilder.addNextIntent( launchIntent );

pIntent = sBuilder.getPendingIntent( 0, PendingIntent.FLAG_ONE_SHOT ); 
```

单击通知启动 Activity C 就好了，但是当我按下它时，它会`IllegalArgumentException`从我的 ContentProvider 中爆炸，因为 Activity B 不知道要请求什么 ID。有什么办法可以把这个额外的东西放到后面的堆栈中，还是我被卡住了？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-11-08T17:25:01.107

这一行：

```
sBuilder.addParentStack( ActivityC.class ); 
```

`ActivityC`添加在`AndroidManifest.xml`in 中声明的所有父母`<meta-data>`。不知道是什么，没用过。我怀疑你需要它。

此行将意图添加到数组：

```
sBuilder.addNextIntent(launchIntent); 
```

然后意图数组用于创建 PendingIntent，可能使用[PendingIntent.getActivities](https://developer.android.com/reference/android/app/PendingIntent.html#getActivities%28android.content.Context,%20int,%20android.content.Intent%5B%5D,%20int%29)，我找不到实现，然后在某个地方使用[Context.startActivities](https://developer.android.com/reference/android/content/Context.html#startActivities%28android.content.Intent%5B%5D%29)开始。

我认为您只需要创建一组意图，您就可以在其中添加额外内容：

```
Intent activityA = new Intent(context, ActivityA.class);
activityA.putExtra(key, valueA);
Intent activityB = new Intent(context, ActivityB.class);
activityB.putExtra(key, valueB);
Intent activityC = new Intent(context, ActivityC.class);
activityC.putExtra(key, valueC); 
```

并将它们添加到构建器：

```
sBuilder.addNextIntent(activityA);
sBuilder.addNextIntent(activityB);
sBuilder.addNextIntent(activityC);
pIntent = sBuilder.getPendingIntent( 0, PendingIntent.FLAG_ONE_SHOT ); 
```

我没有测试过，这只是我快速研究的结果，如果我错了，我希望有人能纠正我。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-06-26T18:02:48.753

我找到了解决这个问题的另一种方法：使用方法[TaskStackBuilder.editIntentAt(int)](http://developer.android.com/reference/android/support/v4/app/TaskStackBuilder.html#editIntentAt%28int%29)

前任。

```
Intent intentC = new Intent(context, ActivityC.class);
intentC.putExtra(key, valueC);

TaskStackBuilder sBuilder = TaskStackBuilder.create(this)
    .addParentStack(ActivityB.class)
    .addParentStack(ActivityC.class)
    .addNextIntent(intentC);

Intent intentA = sBuilder.editIntentAt(0);
intentA.putExtra(key, value);
Intent intentB = sBuilder.editIntentAt(1);
intentB.putExtra(key, value); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-04-24T22:22:09.173

我一直在努力解决这个问题。我的研究得出了以下解决方案（与@pawelzieba 非常相似，但有一个重要的删除）：

```
Intent activityA = new Intent(context, ActivityA.class);
activityA.putExtra(key, valueA);
Intent activityB = new Intent(context, ActivityB.class);
activityB.putExtra(key, valueB);
Intent activityC = new Intent(context, ActivityC.class);
activityC.putExtra(key, valueC);

TaskStackBuilder sBuilder = TaskStackBuilder.create(this)
    .addNextIntent(activityA);
    .addNextIntent(activityB);
    .addNextIntent(activityC);
PendingIntent pIntent = sBuilder.getPendingIntent( 0, PendingIntent.FLAG_UPDATE_CURRENT ); 
```

请注意，您不应使用父关联修改清单，并且您不想使用：

```
sBuilder.addParentStack( ActivityC.class ); 
```

否则，您将在新创建的任务中重复 ActivityA 和 ActivityB，这些任务具有没有额外内容的意图。如果您不需要通过额外的意图传递，您可以在清单中添加父关联并调用 addParentStack()。

# html - 添加相对路径 - 不正确

> ID：13148704
> 
> 赞同：1
> 
> 时间：2012-10-30T22:47:42.880
> 
> 标签：html, image, relative-path, src, silverstripe

我有图像中显示的目录结构。

如果我有这个代码`HomePage.ss`

```
<img src="../../images/sprites.jpg" /> 
```

为什么这个相对路径不正确？`Failed to load the given url.`

![在此处输入图像描述](../Images/b3d40c293662b6f76f50fd4bf2362faa.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T16:12:39.753

Silverstripe 使用标签，因此所有相对 url 都是相对于根 url 而不是当前页面 url。

接受的答案是链接到主题中的图像的正确方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:12:30.040

根据 Silverstripe 的文档，您可以使用框架 URL 访问您的图像：

```
<img src="$ThemeDir/images/sprites.jpg" alt=""> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T07:04:28.480

关于 SilverStripe，您需要了解的是它会读取您的模板并输出它们。因此，如果您有 url `mysite.com/home`，那么它看起来就像文件位于文件夹内`/home`，如果您的 url 是`mysite.com/page/subpage`，它将看起来好像文件夹是`/page/subpage`

这意味着你不能**在**模板中使用像“../images/sprites.jpg”这样的相对路径（你可以在css中使用那些）。

正如@Mark 已经在评论中提到的那样，要走的路是使用`$ThemeDir`m 它将输出主题文件夹的路径，所以你的图像应该是这样的：`<img src="$ThemeDir/images/sprites.jpg" />`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T23:09:06.837

如果您不知道路径，则从 URL 加载图像并放置正确的 url...

例子：

img src="http://www.yourwebsite.com/themes/simple/images/img/sprite.jpg"

右键，单击并从浏览器查看图像位置，然后复制正确的 url。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-30T23:19:22.663

```
img src="../../../images/sprites.jpg"

img src="../../../images/**img**/sprites.jpg" 
```

# asp.net - 将 Razor 视图引擎与自定义模板框架一起使用

> ID：13148707
> 
> 赞同：2
> 
> 时间：2012-10-30T22:48:10.810
> 
> 标签：asp.net, asp.net-mvc, razor

我们的 Web 应用程序使用了一个自定义模板框架，该框架具有用多种语言编写的实现，我正在研究是否可以在使用 Razor View 引擎的 ASP.NET MVC 应用程序中使用它。我们已经有一个使用 Web 窗体视图引擎的实现，但我也希望能够使用 Razor。

该模板在一个包含宏标签的 html 文件中定义，这些宏标签在运行时被解释并替换为适用的 html。以下是此文件的高度简化版本：-

```
[doctype]
<html>
  <head>
    [HeadScript]
    [HeadSectionText]
  </head>
  <body id="[if Home][Home][else]body[end if]">
    [form]
      [Content]
    [end form] 
    [EndBodyScript]
  </body>
</html> 
```

如您所见，有机会将 html 注入文档的各个部分，其中一些由简单的条件逻辑实现处理。为了将它与 Razor 一起使用，我需要能够处理模板中的所有宏标记，包括从正在呈现的 Razor 视图中插入 HTML，并将此操作的输出用作最终发送的 HTML给客户。

当谈到 MVC 开发时，我非常熟悉，但我知道我可以创建自定义 ViewEngine 和 IView 实现。也许我可以使用它来实现我想要的，通过使用 RazorView 类的自定义引擎来呈现要插入到我们模板中的实际内容。这听起来像是一个可行的解决方案吗？如果是这样，有没有人有任何提示让我开始？

目前我有一个笨拙的解决方案，我使用 ASP.NET WebForms 引擎并呈现部分 Razor 视图，但从长远来看，我更希望有一个可以将 WebForms 引擎完全排除在等式之外的解决方案。

非常感谢任何朝着正确方向的推动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T02:31:54.687

我设法弄清楚了一些事情。尽管我的问题与您的问题不完全相同，但它肯定可以帮助您。但首先要做的事情。

**问题**

我有许多控件（在我的情况下它们是部分视图）。例如：

```
Views/Shared/EditName.cshtml
Views/Shared/EditAddress.cshtml
Views/Shared/EditEmail.cshtml
Views/Shared/EditFavoriteColour.cshtml 
```

我想定义这些控件的组（在数据库或 web.config 中），例如：

```
SimpleEditGroup:
    EditName
ExtendedEditGroup:
    EditName
    EditEmail
FullEditGroup:
    EditName
    EditAddress
    EditEmail
    EditFavoriteColour 
```

然后我想基于特定组渲染视图。我在想下面的语法就足够了。

```
@Html.Partial("ControlGroup:ExtendedEditGroup", Model) 
```

**解决方案草案**

我想创建自己的渲染引擎，它将执行以下操作：

1.  如果视图的名称以“ControlGroup:”开头，则使用先前定义的组来呈现页面。每个控件都应由 RazorViewEngine 呈现。
2.  如果视图的名称不以“ControlGroup:”开头，则让 RazorViewEngine 完成它的工作。

**研究**

我找到了以下资源：

1.  CodeProject 上的文章 - [ASP.NET MVC3 中的自定义 ViewEngine](http://www.codeproject.com/Articles/259365/Custom-ViewEngine-in-ASP-NET-MVC3)
2.  基于 StackOverflow 问题的文章 - [Creating a Widget system in ASP.NET MVC 3](http://www.paulstovell.com/widgets)
3.  我向您推荐这本书[Pro ASP.NET MVC 3 Framework](https://rads.stackoverflow.com/amzn/click/com/1430234040)。它将让您了解可以在 ASP.NET MVC 3 中自定义多少东西
4.  当然，[ASP.NET MVC 3 RTM](http://aspnet.codeplex.com/releases/view/58781)的源代码非常有帮助。

**最终解决方案**

我的视图引擎：

```
public class MyViewEngine : RazorViewEngine
{
  IDictionary<string, List<string>> groups = new Dictionary<string, List<string>>();

  public MyViewEngine()
  {
    // Temporary data source
    groups["SimpleEditGroup"] = new List<string>() { "EditName"};
    groups["ExtendedEditGroup"] = new List<string>() { "EditName", "EditEmail"};
  }

  public override ViewEngineResult FindView(ControllerContext controllerContext,
           string viewName, string masterName, bool useCache)
  {
    if (viewName.StartsWith("ControlGroup"))
    {
      var groupName = viewName.Split(':')[1];
      var controls = new List<ViewEngineResult>();

      foreach (var controlName in groups[groupName])
      {
        // Find each control using Razor magic
        var control = base.FindPartialView(controllerContext, controlName, useCache);
        if (control.View != null)
        {
          controls.Add(control);
        }
      }

      if(controls.Count > 0)
        return new ViewEngineResult(new MyView(controls), this);
    }

    return base.FindView(controllerContext, viewName, masterName, useCache);
  }
} 
```

我的视图.cs：

```
public class MyView : IView
{
  IList<ViewEngineResult> controls;

  public MyView(IList<ViewEngineResult> _controls)
  {
    controls = _controls;
  }

  public void Render(ViewContext viewContext, TextWriter textWriter)
  {
    // For simplicity I used table for layout
    textWriter.Write("<table border='1'>");

    foreach (var ctrl in controls)
    {
      textWriter.Write("<tr><td>");

      // Render control using Razor
      ctrl.View.Render(viewContext, textWriter);

      textWriter.Write("</td></tr>");
    }

    textWriter.Write("</table>");
  }
} 
```

不要忘记在 Global.asax 中注册您的新引擎`ViewEngines.Engines.Add(new MyViewEngine());`

**美好的结局**

`Render.Partial`我可以通过两种方式使用它：使用或仅从`PartialView`我的控制器返回嵌入到视图中。

让我知道它是否对您有帮助。您还可以分享您的解决方案。

# prolog - Not in Swi-Prolog 6.2

> ID：13148712
> 
> 赞同：1
> 
> 时间：2012-10-30T22:48:43.133
> 
> 标签：prolog

I have this facts:

```
morpheme(a,82).
morpheme(r,83). 
```

And i have this rule:

```
foo(er,Start) :-
    morpheme(a,Start), morpheme(r,I), I is Start+1,
    not(morfema(_,J)), J is I+1. 
```

When I ask the query:

```
foo(er,82). 
```

I got "false" (wrong answer) instead of "true" (correct answer).

In the query I've tried to say that: "if there is a morpheme AR in the start position "Start" and there are no more morphemes in higher positions (higher than Start+1), then fires the rule".

I tried using \+ and cut-fail (http://stackoverflow.com/questions/3850563/writing-prolog-statement-with-not-operator) but no success :(

I think that the problem is located in the way i wrote the rule.

Thanks in advance!!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:56:14.713

Typo: morfema / morpheme.

But the deeper problem is the variable `J`: At the point in time when the negation is tried, `J` is an uninstantiated variable. Only afterwards, it gets the value you expect.

So exchange the two goals - and better use `\+` in place of not!

The `\+` means: not provable at this point in time. It therefore reveals a bit the way how Prolog programs are executed.

* * *

There is another problem in your program: You may move `I is Start+1` one to the left. In this manner the `morpheme(r,I)` will be a ground goal. It might be executed faster.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T16:42:39.813

Thanks False! That solved the problem. The modified code is below:

```
morpheme(a,82).
morpheme(r,83).

not(X) :- \+ X.

foo(er,Start) :-
    morpheme(a,Start), I is Start+1, morpheme(r,I),
    J is I+1, not(morpheme(_,J)). 
```

# c# - IQueryable 或 IList

> ID：13148713
> 
> 赞同：4
> 
> 时间：2012-10-30T22:48:46.950
> 
> 标签：c#, collections, iqueryable, ilist, enumerable

我正在查询数据库并从中生成对象列表。

通常从我的业务层我返回这个 IList 类型缓存的对象列表。如果我将其更改为返回 IQueryable，这样做有什么好处？IQueryable 给了我什么 IList 没有？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T22:59:44.517

[IQueryable](http://msdn.microsoft.com/en-us/library/system.linq.iqueryable.aspx)是一个用于查询数据库的接口，它定义了允许实现者做一些简洁的事情的功能，比如延迟执行和构建更优化的查询（通过评估表达式树）。IList 没有给你这些。

此外，IQueryable （在大多数情况下）是一个*只读*接口。IList 定义了允许用户修改集合的 Add、Remove 等。如果这在语义上对您更有意义，那么一定要使用它，然后使用 IEnumerable Linq 扩展来获得 IQueryable 的大部分功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:03:16.930

我喜欢对所有返回类型使用 IEnumerable - 如果它们很简单，我会在返回它的方法中使用 List 来实现它们，或者如果需要，我会使用更专业的具体类来实现它们。优点是，我很少需要更改实现 IEnumerable 的类的客户端。我不在乎它是列表还是哈希表。使用 IList，您会被困在使用列表中。

但是，如果您使用的是 LINQ-to-SQL，或者您正在处理类中的大量数据，则 IQueryable 支持一些 IEnumerable 不支持的方法。IEnumerable 是 ILIst 和 IQueryable 的基本实现，这就是为什么我建议使用它作为大多数函数的返回类型

查看这些文章，了解 IQueryable 和 IEnumerable 之间的区别：

[返回 IEnumerable<T> 与 IQueryable<T>](https://stackoverflow.com/questions/2876616/returning-ienumerablet-vs-iqueryablet) 以及 [IQueryable<T> 和 IEnumerable<T> 有什么区别？](https://stackoverflow.com/questions/252785/what-is-the-difference-between-iqueryablet-and-ienumerablet)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T22:53:41.583

如果您打算使用查询数据库，那么我认为 IQueryable 更有用。APrta 从此，您可以使用 IList 从列表中添加、删除、获取特定项目。这完全取决于你想如何使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T22:55:39.180

您可以返回`IEnumerable<T>`然后强制转换以使其更灵活......但是`IQueryable<T>`更好的执行方法是您可以从字面上查询数据库。如果您想要操作集合的能力，我会选择`IList<T>`

# jquery - 在 jquerymobile 控制组中隐藏/显示复选框

> ID：13148714
> 
> 赞同：1
> 
> 时间：2012-10-30T22:48:47.883
> 
> 标签：jquery, jquery-mobile

我有一个`controlgroup`用于 jQueryMobile 的复选框。我想根据先前选择的 a 隐藏某些复选框`<select></select>`。但是，如果它恰好是控制组的最后一个或第一个元素，则复选框边框看起来很奇怪。我将如何解决这个问题，并且在隐藏之后，让它正确地显示控制组？

[http://jsfiddle.net/AyWN7/1/](http://jsfiddle.net/AyWN7/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:56:33.987

在两个函数中添加这一行：

```
$('#appointmentAddonServicesFieldset').controlgroup('refresh'); 
```

# ios - 收到推送通知时如何获取用户位置？

> ID：13148728
> 
> 赞同：0
> 
> 时间：2012-10-30T22:49:57.013
> 
> 标签：ios, push-notification, apple-push-notifications

我想做的是在他收到推送通知后立即将用户位置上传到数据库，用户不必按下任何按钮进行确认。有没有办法做到这一点？

阿图罗。

# vb.net - vb.net中相同arrayList的顺序搜索

> ID：13148733
> 
> 赞同：0
> 
> 时间：2012-10-30T22:50:10.500
> 
> 标签：vb.net, arraylist, sequential

```
Public Function Validate(updatedDetailList As List(Of DetailVO)) As Boolean
  Dim matchFound As Boolean = False

  For Each firstUpdatedDetail In updatedDetailList
    For Each nextUpdatedDetail In updatedDetailList
      If firstUpdatedDetail.PROD_ID.Equals(nextUpdatedDetail.PROD_ID) Then
        matchFound = True
      End If
    Next nextUpdatedDetail
  Next firstUpdatedDetail

  Return matchFound
End Function 
```

我有`updatedDetailList`一个列表，我想迭代并获取当前和下一个对象值并比较这两个值。如果您发现相同`PROD_ID`，`updatedDetailList`则返回`matchFound`为`TRUE`。

有什么方法可以在内部 For 循环中获取下一个对象。像...

```
For Each firstUpdatedDetail In **updatedDetailList**
  For Each nextUpdatedDetail In **updatedDetailList.Next**
    If firstUpdatedDetail.PROD_ID.Equals(nextUpdatedDetail.PROD_ID) Then
      matchFound = True
    End If
  Next nextUpdatedDetail
Next firstUpdatedDetail 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:28:30.130

似乎您正在尝试执行不同的验证，因此每个项目都`updatedDetailList`必须是唯一的。

在不改变你的方法（即使用`For`循环）的情况下，这里是代码：

```
For i = 0 to updatedDetailList.Count - 2
  If updatedDetailList(i).PROD_ID.Equals(updatedDetailList(i+1).PROD_ID) Then
    matchFound = True
    Exit For
  End If
Next 
```

但是有一种更快的方法来执行相同的操作 - 它使用 LINQ：

```
Dim matchFound As Boolean = updatedDetailList.Distinct.Count <> updatedDetailList.Count 
```

# c#-4.0 - 获取 DataRow[myColumn] 的数据类型并将另一个变量转换为该类型

> ID：13148741
> 
> 赞同：3
> 
> 时间：2012-10-30T22:51:21.990
> 
> 标签：c#-4.0

我有一个类需要一个未知数字类型的变量。我需要在运行时从特定列获取数据类型，然后将类变量强制转换/实例化为该类型，然后在迭代行时保持该列的运行总数。我想过将我的类变量表示为`dynamic`，但这并不适合我。我也考虑过使用通用方法，但我觉得有更好的方法来做到这一点。通用属性会很棒，但是，好吧，你知道这个故事是如何结束的。

更新了，这是我一直在使用的代码的剩余部分：

```
dynamic dc = dataRow["MyColumnName"];
var tempValue = Convert.ChangeType(dataRow["MyColumnName"], Type.GetType(dc.GetType().ToString())); 
total+= (Decimal)tempValue; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-06-23T07:41:08.087

这对我有用

```
if (dtRow.Table.Columns["Date"].DataType == typeof(System.DateTime)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-04T10:37:34.310

这是根据行项类型检查表中的数据行项是否包含 Null 值的解决方案

```
 Dim ds as New DataSet = MYData()
       Dim rowindex As Integer = 0
       For Each row As DataRow In ds.Tables(0).Rows
         For index As Integer = 0 To row.ItemArray.Length - 1
             If (TypeOf row(index) Is DBNull) And (IsDBNull(row(index))) Then
                ds.Tables(0).Rows(rowindex)(index) = 0
             End If
         Next
         rowindex = rowindex + 1
        Next 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-01T14:53:41.997

我最终像这样解决它：

```
public int MyMethod<T>(DataTable myDataTable)
{
    dynamic myTempVariable = default(T);
    ...
} 
```

这不是一个完美的解决方案（我不想在调用方法之前知道列数据类型），但这给了我在方法内部想要的灵活性。

# c# - 我应该如何公开一个通用列表 当属性可以合法地为空时，作为 .NET API 中的属性？

> ID：13148746
> 
> 赞同：0
> 
> 时间：2012-10-30T22:51:42.230
> 
> 标签：c#, fxcop, api-design

我正在尝试创建一个包装并与第三方 C API 接口的 .NET API。因此，API 的语义如下：

有一个属性表示二进制文件中的字符串列表。具有零条目列表的此属性之间存在区别，在这种情况下，该属性将被写入具有空列表的文件；并且该列表被完全省略，在这种情况下，该属性将从文件中省略。

在我目前的设计中，我正在使用这样的东西：

```
public class InfoWrapper
{
    // Use an IList<T> to avoid running afoul of FxCop
    // rule CA1002: Do not expose generic lists.
    public IList<string> ItemsContainer { get; set; }
} 
```

当然，这可以解决问题，让我能够区分“未设置”和“空列表”情况，但真正的问题是它触发了另一个 FxCop 警告 CA2227: Collection properties should be read only。我需要能够允许用户将属性设置为一个`null`值，如果他们在将其设置为`null`. `DeleteItemsContainer()`我可以使用一对方法（例如和）将属性设为只读`CreateNewItemsContainer()`，但实际上，我需要以相同的方式处理其中的几个属性。为每个属性添加两个方法会使 API 相当混乱。这里有什么更好的方法？

注意我意识到我可以取消 FxCop 警告并完成它，而这些规则只是一组建议。但是，如果可能的话，我希望遵守这些准则。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:14:53.530

我认为您混淆（或询问）两个问题：返回`null`与空集合，以及有一个触发 FxCop 警告的公共设置器。`null`无论类型是`List`or ，您都可以返回`IList`，因此没有问题。

如果您想避免有关公共设置器的 FxCop 警告，您需要将设置器设为私有并提供另一种设置该属性值的方法。您可以`IList`通过 的构造函数传递一个`InfoWrapper`，或者如果有意义，只需在构造函数中创建列表并在构造后将所有项目添加到其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:25:32.323

首先，该属性必须是只读的，即没有设置器。但即便如此，您也会收到另一个 FxCop 警告，因为用户仍然可以修改集合。

摆脱 FxCop 警告的一种干净方法是将属性的定义从返回 an`IList<T>`更改为返回`IEnumerable<T>`.

像这样：

```
public IEnumerable<string> StringList { get; set; } 
```

如果您可以在没有`Count`索引器等属性的情况下生活，那么使用`IEnumerable`有助于确保类用户不会弄乱列表内容。

（顺便说一下，在命名属性时，不推荐使用“String”或“List”一词。“String”不表示属性的语义，“List”暴露了应该封装的集合类型）

# math - 确定两个 IP 地址是否在同一个子网上 - 它是从 IP 地址删除前导 0 还是尾随 0？

> ID：13148747
> 
> 赞同：2
> 
> 时间：2012-10-30T22:51:45.103
> 
> 标签：math, networking, ip-address, subnet

我知道如果两个 IP 地址与子网掩码进行“与”运算，如果结果相同，那么它们就在同一个网络上。如果结果不同，则它们位于不同的网络上。我的问题是，当给定一个省略一些 0 的 IP 地址时，多余的 0 会放在哪里？

例如，如果子网掩码是 255 。128 . 0 . 0 ，你有 IP 126 。1\. 0 . 10 和 IP 126。127 . 0 . 1 如果您只是盲目地将带有子网掩码的 IP 与您得到不同的结果，即使它们在同一个网络上也是如此。

126.1.0.10 会变成 126.100.000.100 还是 126.001.000.100？

阅读回复后编辑：

255128000000 AND 126001000010 = 1085496376*32***但**255128000000 AND 126127000001 = 1085276323*84*
我错过了什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-30T23:02:38.407

IPv4 地址被写成四个**普通的十进制**数（每个都适合一个字节），用点分隔。

普通的十进制数1是“一”，也可以写成001。但是100是一个*不同*的数字，即“一百”。

* * *

AND 操作始终是*按位*与，因此要理解它，您必须首先了解点分十进制地址和网络掩码如何对应于原始二进制 32 位地址：

```
 126   .    127   .     0    .    1
     01111110   01111111   00000000   00000001

        255   .    128   .     0    .    0
AND  11111111   10000000   00000000   00000000
 -----------------------------------------------
     01111110   00000000   00000000   00000000
        126   .      0   .     0    .    0 
```

因此，网络掩码为 255.128.0.0 的 126.127.0.1 位于子网**126.0.0.0** /9

在软件中，通常*将*IPv4 地址存储在一个 32 位变量中——因此 126.127.0.1 是 01111110011111110000000000000001 二进制（它也编码 2122252289 十进制，除了*没有人关心*32 位 IP 地址的十进制值是什么），并且仅当需要向人类用户显示时，它才会转换为点分十进制。这种表示是 glglgl 所描述的乘以 256 几次。

如果您在 32 位变量中也有网络掩码（11111111100000000000000000000000 二进制或 4286578688 十进制），您可以在单个机器指令中将它们与它们一起获得网络地址 01111110000000000000000000000000。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T23:30:56.050

你完全错过了一些东西：你不只是将你的数字连接在一起，因为 AND 在二进制级别上工作。

因此，要么按字节处理 IPv4 地址，要么将它们转换为十进制数，但不是用因子 1000，而是用因子 256。

这就是说，而不是做

```
((126 * 1000 + 1) * 1000 + 0) * 1000 + 10 = 126001000010 
```

你应该做

```
((126 * 256 + 1) * 256 + 0) * 256 + 10 = 2113994762 
```

. 如果您将此应用于其他数字，您应该会成功。

或者，您可以将 4 个数字分别与在一起，所以

```
255 & 126 = 126 (in both cases), 128 & (1 resp. 127) = 0, 0 & (anything) = 0, 0 & (anything) = 0. 
```

所以你得到`126.0.0.0`了两者，使它们属于同一个子网。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T23:01:59.033

尽管这是一个相当奇怪的问题，但我会尝试回答您的具体问题：

第二个八位字节中的数字“1”实际上是数字 1，因此它是“001”，而不是“100”。

也就是说，您的示例*应该*有效，所以我怀疑您的实现有问题。你不应该担心填充或任何东西。这些是数字，按位与应该“正常工作”。

您可能希望提供有关问题所在的更多详细信息。

# objective-c - 子浏览器终止

> ID：13148752
> 
> 赞同：0
> 
> 时间：2012-10-30T22:52:15.393
> 
> 标签：objective-c, ios, xcode, cordova, phonegap-plugins

在 javascript 中调用多个函数以获取用户名/电子邮件地址/密码。当一切正常时，转到 goForLogin() 并打开一个 chrildbrowser。我收到错误消息（见下文）：

首先我的代码：

```
 function goForLogin(emailaddress, value){
            var xmlhttp;
            xmlhttp=new XMLHttpRequest();
            xmlhttp.open("POST","http://dev.server.com/test/login",true);
            xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            xmlhttp.send("email=" + emailaddress + "&password=" + value);

            xmlhttp.onreadystatechange=function()
            {
                if (xmlhttp.status==200)
                {

                    value = null;
                    window.plugins.childBrowser.showWebPage('http://dev.server.com');
                } else {
                    alert("FAILED");
                }
            }
        } 
```

> *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“应用程序试图以模态方式呈现活动控制器。” ***第一掷调用堆栈：（0x154012 0x25fce7e 0x478721 0x479777 0x4797b7 0x6a68 0x67471 0x66c5e 0x67039 0x26106b0 0x1198035 0xd7f3f 0xd796f 0xfa734 0xf9f44 0xf9e1b 0x33be7e3 0x33be668 0x38f65c 0x2366 0x2295）的libc ++ abi.dylib：终止叫做抛出异常（LLDB）

最新的 Cordova 和 Childbrowser，Xcode 4.4 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T01:08:02.827

我得到了它！由于该`xmlhttp.onreadystatechange`语句，childBrowser 将在此脚本中打开 3 次。苹果不允许 - 抱歉，我忘记了原因 - 所以我回电了。它看起来像这样：

我的 JavaScript：

```
function some_function2(url, callback) {
      var httpRequest; // create our XMLHttpRequest object
      if (window.XMLHttpRequest) {
          httpRequest = new XMLHttpRequest();
      } else if (window.ActiveXObject) {
          // Internet Explorer is stupid
          httpRequest = new
          ActiveXObject("Microsoft.XMLHTTP");
      }
      httpRequest.onreadystatechange = function() {

          // inline function to check the status
          // of our request
          // this is called on every state change
          if (httpRequest.readyState === 4 &&
             httpRequest.status === 200) {
             callback.call(httpRequest.responseXML);
             // call the callback function
         }
      };
      httpRequest.open('POST', url, true);
      httpRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded");
      httpRequest.send("email=test@test.com&password=1");
      }

function call() {
   // call the function
   some_function2("http://dev.server.com/account/login/", function() {
                 console.log(this);
                 callChildBrowser();
                 });
                 console.log("this will run before the above callback");

}

function callChildBrowser(){
    window.plugins.childBrowser.showWebPage('http://dev.server.com');
    } 
```

最后在我的html中：

```
<button id="butten" onclick="call()">WORKS</button> 
```

# javascript - jQuery 如果条件文本包含

> ID：13148758
> 
> 赞同：0
> 
> 时间：2012-10-30T22:53:13.647
> 
> 标签：javascript, jquery

我写了一个简单的 if 条件，但不是很有效。如果文本是 123 更改为 hi，如果文本是 456 将其更改为 hi2 有人可以帮我一把吗？

```
 <h1>123</h1>
    <h1>456</h1>
    <h1>789</h1>​

$(document).ready(function() {

    var changeText1 = '123';
    var changeText2 = '456';
    var text = $(h1).text();

    if (text == changeText) {
        $(this).text('hi');
    } else if (text == changeText2 ) {
        $(this).text('hi2');
    }

}); 
```

​</p>

[http://jsfiddle.net/8P2ma/](http://jsfiddle.net/8P2ma/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:59:01.210

您的代码有很多问题：

```
$(document).ready(function() {

    var changeText1 = '123';
    var changeText2 = '456';
    var text = $(h1).text(); //aside from having to iterate through, the jquery
                             //selector needs to be enclosed in quotes: $('h1')
    if (text == changeText) { //The variable 'changeText' does not exist.
        $(this).text('hi');
    } else if (text == changeText2 ) {
        $(this).text('hi2');
    }

});

//working code:
$(document).ready(function() {

    var changeText1 = '123';
    var changeText2 = '456';

    $('h1').each(function() {
        var text = $(this).text();
        if (text == changeText1) {
            $(this).text('hi');
        } else if (text == changeText2) {
            $(this).text('hi2');
        }
    });
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:00:45.073

```
$(function() {
    $('h1:contains("123")').text('hi');
    $('h1:contains("456")').text('hi2');
});​ 
```

[**小提琴**](http://jsfiddle.net/rR9Z5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T22:56:48.740

像这样做：

```
$(document).ready(function() {
    var change = {
        '123': 'hi',
        '456': 'hi2'
    };
    $('h1').text(function(i, txt) {
        return change[$.trim(txt)];
    });
}); 
```

***演示：http:*** [//jsfiddle.net/By4Ra/](http://jsfiddle.net/By4Ra/)

# javascript - Windows 8 中的就绪功能不起作用

> ID：13148760
> 
> 赞同：0
> 
> 时间：2012-10-30T22:53:15.120
> 
> 标签：javascript, windows

我正在使用 HTML 和 JS 开发 Windows 8 应用程序。当我使用 WinJS.Navigation.navigate 导航到特定的 HTML 页面时，我希望“就绪”功能能够运行。相反，它装死了：

```
 (function () {
    "use strict";

    WinJS.UI.Pages.define("../pages/editcontact.html", {
        ready: function (element, options) {
            showToast("ello"); //does not run at all
        },

        unload: function () {
        },

        updateLayout: function (element, viewState, lastViewState) {
        }
    });})(); 
```

如果我使用 jQuery 来检测以下代码是否有效，它将在我第一次导航到页面时运行，但此后不再运行：

```
$(window).ready(function () {
    showToast('hi'); //runs only on first visit to page
}); 
```

我在这里错过了什么？（showToast 已定义且工作正常，仅以它为例）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T16:20:00.367

尝试检查 .html 文件的路径。我有同样的问题，当它是错误的。它需要绝对路径，而不是相对路径。

# jquery - ASP.NET DataList 上的鼠标悬停缩略图 jQuery 实现

> ID：13148762
> 
> 赞同：0
> 
> 时间：2012-10-30T22:53:21.507
> 
> 标签：jquery, asp.net

我想在画廊上应用这个 jQuery [http://jsfiddle.net/awaises/9tFLK/ 。](http://jsfiddle.net/awaises/9tFLK/)我的朋友用 ASP.NET 开发了这个网站，他使用了 DataList。我可以在 html 中实现代码，但在 ASP.Net 中无法理解我应该在哪里应用代码。请指导我如何实现jquery？数据列表代码如下......（由于某种原因，大于和小于符号没有出现，这就是为什么我在下面的代码中使用圆括号）

```
<asp:DataList ID="dalphoto" runat="server" BorderStyle="Solid" BorderWidth="0px" RepeatColumns="6" RepeatDirection="Horizontal" DataKeyField="HotelPhoto">
    <AlternatingItemStyle BorderStyle="Solid" BorderWidth="0px" />
    <SeparatorStyle BorderStyle="Solid" BorderWidth="0px" />
    <ItemTemplate>
    <asp:Image ID="Image" width="80px" height="80px" runat="server" ImageUrl='<%# "~/Photos/HotelPhotos/" + Eval("Photourl") %>' />
    </ItemTemplate>
</asp:DataList> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:48:42.447

如下修改 DataList 的标记

```
<asp:DataList ID="dalphoto" runat="server" BorderStyle="Solid" BorderWidth="0px" RepeatColumns="6" RepeatDirection="Horizontal"  DataKeyField="HotelPhoto">
        <ItemTemplate>
            <div class="thumbnail-item">
                <asp:Image ID="Image" width="80px" height="80px" runat="server" CssClass="thumbnail" ImageUrl='<%# "~/Photos/HotelPhotos/" + Eval("Photourl") %>'/>
                <div class="tooltip"><img src="<%# "Photos/HotelPhotos/" + Eval("Photourl") %>" alt="" width="330" height="185" /><span class="overlay"></span>
            </div>
            </div>   
        </ItemTemplate>
    </asp:DataList> 
```

从小提琴中获取 css 和 javascript，无需任何修改即可使用。

**CSS**

```
.thumbnail-item { 
    /* position relative so that we can use position absolute for the tooltip */
    position: relative; 
    float: left;  
    margin: 0px 5px; 
}

.thumbnail-item a { 
    display: block; 
}

.thumbnail-item img.thumbnail {

}

.tooltip { 
    /* by default, hide it */
    display: none; 
    /* allow us to move the tooltip */
    position: absolute; 
    /* align the image properly */
}

.tooltip span.overlay { 
    /* the png image, need ie6 hack though */
    /* put this overlay on the top of the tooltip image */
    position: absolute; 
    top: 0px; 
    left: 0px; 
    display: block; 
} 
```

**JavaScript**

```
// Load this script once the document is ready
    $(document).ready(function () {

        // Get all the thumbnail
        $('div.thumbnail-item').mouseenter(function(e) {

            // Calculate the position of the image tooltip
            x = e.pageX - $(this).offset().left;
            y = e.pageY - $(this).offset().top;

            // Set the z-index of the current item, 
            // make sure it's greater than the rest of thumbnail items
            // Set the position and display the image tooltip
            $(this).css('z-index','15')
            .children("div.tooltip")
            .css({'top': y + 10,'left': x + 20,'display':'block'});

        }).mousemove(function(e) {

            // Calculate the position of the image tooltip            
            x = e.pageX - $(this).offset().left;
            y = e.pageY - $(this).offset().top;

            // This line causes the tooltip will follow the mouse pointer
            $(this).children("div.tooltip").css({'top': y + 10,'left': x + 20});

        }).mouseleave(function() {

            // Reset the z-index and hide the image tooltip 
            $(this).css('z-index','1')
            .children("div.tooltip")
            .animate({"opacity": "hide"}, "fast");
        });

    });​ 
```

​</p>

# c++ - 从初始化列表就地向量构造（对于具有构造函数参数的类）

> ID：13148772
> 
> 赞同：9
> 
> 时间：2012-10-30T22:54:27.560
> 
> 标签：c++, c++11, initialization, initializer-list

> *可能重复：*
> [我可以列出初始化只移动类型的向量吗？](https://stackoverflow.com/questions/8468774/can-i-list-initialize-a-vector-of-move-only-type)

*编辑1：请考虑重新投票：我的问题强调就地建设。移动构造是另一种选择，但不是这个问题的目的。感谢您的回答！*

*编辑 2：由于我无法回答这个问题（它已关闭），我在这里发布我自己的建议。以下内容不如我接受的答案，但可能对其他人有用。至少只有移动构造函数被调用：*

```
std::vector<A2> vec;
{
  std::array<A2,3> numbers{{{2,3},{5,6},{7,8}}};
  vec.reserve(numbers.size());
  for (auto &v: numbers) vec.emplace_back(std::move(v)) ;
} 
```

**原帖：**

在考虑这个问题的答案时：[Initialization of classes within an STL array of vectors](https://stackoverflow.com/questions/13147935/initialization-of-classes-within-an-stl-array-of-vectors/13148028#13148028)我发现我找不到从初始化列表中就地构造向量的方法。我错过了什么？

现在想更清楚，我想要这个（完全正确的）初始化

```
std::vector<A2> k{{2,3},{4,5},{8,9}}; 
```

产生更类似于此的效果：

```
 std::vector<A2> k2;
  k2.reserve(3);
  k2.emplace_back(2,3);
  k2.emplace_back(4,5);
  k2.emplace_back(8,9); 
```

但是，在第一种情况下，在插入时临时为 A2 调用*复制构造函数。*有没有办法避免这种情况？标准是怎么说的？

我拼命尝试

```
std::vector<A2> k{{2,3},{4,5},std::move(A2{8,9})}; 
```

但这会产生对移动构造函数的*额外*调用，这也是我没想到的。我只是想明确暗示 A2 是临时的，我认为是暗示的。

完整示例：

```
#include <vector>
#include <iostream>

struct A2 {
  int mk;
  int mj;
  A2(int k,int j) : mk(k),mj(j) {
    std::cout << "     constr for "<<this<< ":"<< mk<<std::endl;
  }
  A2(const A2& a2) {
    mk=a2.mk;
    mj=a2.mj;    
    std::cout << "copy constr for "<<this<< ":" << mk<<std::endl;
  }
  A2(A2&& a2) noexcept  {
    mk=std::move(a2.mk);
    mj=std::move(a2.mj);
    std::cout << "move constr for "<<this<< ":"<< mk<<std::endl;
  }
};

struct Ano {
  Ano() {
    std::cout << "     constr for "<<this <<std::endl;
  }
  Ano(const Ano& ano) {
    std::cout << "copy constr for "<<this<<std::endl;
  }
  Ano(Ano&& ano) noexcept  {
    std::cout << "move constr for "<<this<<std::endl;
  }
};

int main (){
  // here both constructor and copy constructor is called:
  std::vector<A2> k{{2,3},{4,5},std::move(A2{8,9})};

  std::cout << "......"<<std::endl;
  std::vector<A2> k2;
  k2.reserve(3);
  // here (naturally) only constructor is called:
  k2.emplace_back(2,3);
  k2.emplace_back(4,5);
  k2.emplace_back(8,9);

  std::cout << "......"<<std::endl;  
  // here only constructor is called:
  std::vector<Ano> anos(3);

} 
```

输出：

```
 constr for 0xbf9fdf18:2
     constr for 0xbf9fdf20:4
     constr for 0xbf9fdf0c:8
move constr for 0xbf9fdf28:8
copy constr for 0x90ed008:2
copy constr for 0x90ed010:4
copy constr for 0x90ed018:8
......
     constr for 0x90ed028:2
     constr for 0x90ed030:4
     constr for 0x90ed038:8
......
     constr for 0x90ed048
     constr for 0x90ed049
     constr for 0x90ed04a 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-30T23:57:54.167

via构造对象与从任何其他*对象*`std::initializer_list`构造对象没有什么不同。这不是一个神秘的、幻想的结构；它是一个活生生的 C++ 对象（尽管是一个临时对象）。因此，它遵守所有常规生活、呼吸 C++ 对象的规则。*`std::initializer_list`*

 *聚合初始化可以有效地省略复制/移动，因为它是聚合初始化，一个纯粹的编译时构造。`std::vector`是很多东西；聚合和纯编译时构造不在其中。因此，为了让它根据给定的内容进行初始化，它必须执行实际的 C++ 代码，而不是编译时的东西。它必须遍历 的每个元素`initializer_list`并复制这些值或移动它们。后者是不可能的，因为`std::initializer_list`不提供`const`对其成员的非访问权限。

初始化器列表初始化意味着*看起来*像聚合初始化，而不是像它那样执行。这就是拥有运行时、动态抽象（如`std::vector`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-31T02:52:06.123

在您的代码段中进行列表初始化`std::vector`与执行以下操作没有什么不同（如果`initializer_list`有一个公共的非显式构造函数或`std::vector`接受一个数组引用。）：

```
// directly construct with the backing array of 'initializer_list'
std::vector<A2> v(alias<A2[]>{ A2(2,3), A2(4,5), A2(8,9) }); 
```

真的，这不是构造`std::vector`可以利用实现的特殊方法。列表初始化是一种“统一”初始化类型的通用方式。因此，它不可能`std::vector`与任何其他用户定义的类型有任何不同。因此，让 OP 中的构造进行 emplace 构造是毫无疑问的。

现在，支持数组（或任何常量数组）可能会被实现放入只读内存中，这就是为什么

```
std::initializer_list<T>::iterator 
```

只是

```
typedef T const* iterator; 
```

所以搬出去`std::initializer_list`也是没问题的。

现在，有解决办法吗？是的，有，而且实际上很简单！

我们将希望有一个自由函数，它接受一个容器和一个数量等于您要放置的元素数量的元组。元组包含容器类型构造函数的参数。理论上很容易，在实践中很容易使用[索引技巧](http://loungecpp.wikidot.com/tips-and-tricks%3aindices)（代码中的位置`indices == seq`和位置`build_indices == gen_seq`）：

```
#include <type_traits>
#include <tuple>
#include <utility>

template<class T> using alias = T;
template<class T> using RemoveRef = typename std::remove_reference<T>::type;

template<class C, unsigned... Is, class Tuple>
void emplace_back_one(C& c, seq<Is...>, Tuple&& ts){
  c.emplace_back(std::get<Is>(std::forward<Tuple>(ts))...);
}

template<class T> using Size = std::tuple_size<RemoveRef<T>>;

template<class C, class... Tuples>
void emplace_back(C& c, Tuples&&... ts){
  c.reserve(sizeof...(Tuples));
  alias<char[]>{(
    emplace_back_one(c, gen_seq<std::tuple_size<RemoveRef<Tuples>>::value>{}, std::forward<Tuples>(ts))
  , '0')...};
} 
```

[`seq`实现和的活生生的例子`gen_seq`。](http://liveworkspace.org/code/b2b488cba1b266729afa03d1d24fecac)

`emplace_back_one`上面的代码准确地调用了`sizeof...(Tuples)`时间，按照传递给的顺序一次传递一个元组`emplace_back`。此代码也是从左到右排序的，这意味着构造函数的调用顺序与您为它们传递元组的顺序相同。`emplace_back_one`然后简单地用索引技巧解包元组并将参数传递给`c.emplace_back`.*

# xslt - 需要在每个循环中计算值并在 XSLT 1.0 中求和

> ID：13148780
> 
> 赞同：3
> 
> 时间：2012-10-30T22:55:12.017
> 
> 标签：xslt, sum, accumulate

假设我有一个简单的输入 XML 文档，例如：

```
<Amounts>
    <item>
        <Base>4750</Base>
        <Tax1>2800</Tax1>
        <Tax2>50</Tax2>
    </item>
    <item>
        <Base>4750</Base>
        <Tax1>2800</Tax1>
        <Tax2>50</Tax2>
    </item>
</Amounts> 
```

XSLT 为：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output  version="1.0" method="xml" omit-xml-declaration="yes" indent="yes"/>
    <xsl:template match="/">
      <xsl:element name="MyTax">
        <xsl:variable name="bf" select="sum(//item/Base)"/>
        <xsl:variable name="discount" select="$bf * 0.08"/>
        <xsl:variable name="bf1" select="$bf - $discount"/>
        <xsl:variable name="yq1" select="sum(//item/Tax1)"/>
        <xsl:variable name="yr1" select="sum(//item/Tax2)"/>
        <xsl:variable name="stax">
            <xsl:value-of select="round(format-number((($bf1 + $yq1 + $yr1) * 0.0495),'#.##'))"/>
        </xsl:variable>
        <xsl:element name="Stax"><xsl:value-of select="$stax"/></xsl:element>
      </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

我们得到一个输出 XML：

```
<MyTax>
    <Stax>715</Stax>
</MyTax> 
```

但是，现在我想为每个项目分别计算 stax ，然后将这些项目相加 - 这是因为在上面的示例中，我最终会出现舍入错误，因为单个 stax 的总和实际上是 714 - 我正在寻找的值对于，而不是上面的 715。

所以我正在寻找的输出是：

```
<MyTax>
         <item>
    <Stax>357</Stax>
         </item>
         <item>
            <Stax>357</Stax>
         </item>
         <TotalStax>714</TotalStax>
</MyTax> 
```

虽然我可以设置一个 for-each，但如何将 stax 计算为每次传递的变量，然后总结单个 stax？我受限于 XSLT 1.0，看到了一些使用键和节点集的答案，但无法理解如何应用它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:07:21.220

**这个 XSLT 1.0 转换**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common" exclude-result-prefixes="ext">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
     <xsl:variable name="vrtfTaxSeq">
       <xsl:apply-templates/>
     </xsl:variable>

     <xsl:value-of select="sum(ext:node-set($vrtfTaxSeq)/*)"/>
 </xsl:template>

 <xsl:template match="item">
  <ttax>
   <xsl:value-of select="round(0.0495*(Base - 0.08*Base + Tax1 + Tax2))"/>
  </ttax>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<Amounts>
    <item>
        <Base>4750</Base>
        <Tax1>2800</Tax1>
        <Tax2>50</Tax2>
    </item>
    <item>
        <Base>4750</Base>
        <Tax1>2800</Tax1>
        <Tax2>50</Tax2>
    </item>
</Amounts> 
```

**calculates the sums for each `item` and produces the wanted result**:

```
714 
```

**Do note** that the `xxx:node-set()` extension function is necessary (this can be avoided using recursion).

# lua - 在 MUD 房间里使用 lua 做一些事情

> ID：13148783
> 
> 赞同：-1
> 
> 时间：2012-10-30T22:55:18.993
> 
> 标签：lua

这是我第一次使用这样的嵌入式语言。

我正在尝试学习使用 lua 作为 MUSHclint 中的脚本，MUSHclint 是一种基于文本的角色扮演客户端。

在客户端中，如果您只是输入单词**帮助**并按回车键，那么它会显示一个帮助屏幕。如果你输入**“帮助”** ，那么你会得到*角色说，“帮助”*

在 lua 中，我做了：

```
function hello ()
    print("\"hello")
end 
```

我得到的是来自 lua 解释器的*“你好”*。有没有办法让它成为“你好”，就好像我直接输入它一样？

这里的最终目标是在一个人“CharacterX 想要物品”时创建一个随机响应，我知道我的想法太过分了，但请对我好点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T05:48:27.533

在 MUSH 中，您只需执行以下操作：

```
Send('"hello') 
```

至少，如果您使用的是“发送到脚本”选项（而不是“发送到世界”）。不过，MUSHClient 的论坛可能更适合询问您有关其产品的问题。

# ruby-on-rails - 在 Rails 上使用模型来执行特定操作？

> ID：13148793
> 
> 赞同：0
> 
> 时间：2012-10-30T22:56:00.867
> 
> 标签：ruby-on-rails, ruby, controller, models

我对 RoR 很陌生，我很难弄清楚何时使用控制器或其他东西，比如用于暗示业务逻辑的特定情况的模型。

假设我有一个 Post 模型，它有一种在 Twitter 上分享它的方法，比如这个：

```
class Post < ActiveRecord::Base
  def send_to_twitter!
    Twitter.update("#{self.title} #{self.url}")
  end
end 
```

然后，在某个地方我有这个：

```
Post.find(9).send_to_twitter! 
```

我不应该这样做，因为我在模型上有业务逻辑，理论上是不允许的（据我所知）。但这是完成此类任务的最简单方法。

我的问题是，这是正确的做法吗？**有没有更好的办法？** 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T23:01:48.890

业务逻辑*属于*模型。模型存储数据，并对该数据执行操作。所以这是完全正确的。

控制器是模型和渲染输出以及处理用户输入之间的粘合剂。控制器告诉模型做什么，但模型应该是做这件事的人。

古老的格言是“*瘦*的控制器，*胖*的模型”。告诉你的模型该做什么应该简单易行（控制器代码），即使执行这些操作的代码复杂且冗长（模型代码）。

* * *

把你的应用想象成一个机场。空中交通管制员是您的“管制员”。他们告诉飞机（模型）在与其他飞机（其他模型）检查它的清晰和安全时着陆。然后它告诉飞机降落，但飞机自己降落。

模型应该知道如何使用自己的数据执行任务。但决定*何时*执行这些任务通常是控制器所做的。

```
class AirPortController
  def request_landing(plane)
    if @landing_planes.size == 0
      plane.land!
      @landing_planes << plane
    else
      plane.request_again_in(5.minutes)
    end
  end
end 
```

控制器告诉模型要做什么，但模型会这样做。

# json - 使用正则表达式解析 FireFox 书签

> ID：13148794
> 
> 赞同：0
> 
> 时间：2012-10-30T22:56:03.560
> 
> 标签：json, firefox, grep, bookmarks

我尝试使用以下方法解析 Firefox 书签（JSON 导出版本）：

```
cat boo.json | grep '\"uri\"\:\"^http\://[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}\"'
cat boo.json | grep '"uri"\:"^http\://[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}'
cat boo.json | grep '"uri"\:"^http\://[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}"' 
```

其他几个但都失败了，json 书签文件将如下所示：

```
.........."uri":"http://www.google.com/?"......"uri":"http://stackoverflow.com/" 
```

所以，输出应该是这样的：

```
"uri":"http://www.google.com/?"
"uri":"http://stackoverflow.com/" 
```

我的正则表达式缺少什么？

**更新：**

书签文件上的 URL 以以下特殊字符之一结尾：

`/`，**例如：** `"uri":"http://stackoverflow.com/"`

`"`，**例如：** `"uri":"http://stackoverflow.com/questions/13148794/parsing-firefox-bookmarks-using-regular-expression"`

`}`，**例如：** `"uri":"https://fr.add-ons.mozilla.com/fr/firefox/bookmarks/"}`

使用这个修改后的正则表达式：

```
$ egrep -o "(http|https)://([^ ]*).(*\/)"  boo.json 
```

结果：

```
http://fr.fxfeeds.mozilla.com/fr/firefox/headlines.xml"},{"name":"livemark/siteURI","flags":0,"expires":4,"mimeType":null,"type":3,"value":"http://www.lemonde.fr/"}],"type":"text/x-moz-place-container","children":[]}]},{"index":2,"title":"Tags","id":4,"parent":1,"dateAdded":1344432674984000,"lastModified":1344432674984000,"type":"text/
http://stackoverflow.com/questions/13148794/parsing-firefox-bookmarks-using-regular-expression","charset":"UTF-8"},{"index":29,"title":"adrusi/
http://stackoverflow.com/
... 
```

但这仍然不能让我只有网址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:59:57.973

你试过 JSON.sh 吗？它的作品很棒！

[https://github.com/dominictarr/JSON.sh](https://github.com/dominictarr/JSON.sh)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-28T07:24:26.457

我使用这个正则表达式来提取网址，效果很好

`cat *.html | grep -Eo "(http|https)://[a-zA-Z0-9./?=_-]*" | sort | uniq`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-08T02:25:28.590

Jeff Atwood 先生发表了一篇[关于 urls 问题](http://www.codinghorror.com/blog/2008/10/the-problem-with-urls.html)的文章，通过他提出的正则表达式，我设法从 FireFox 书签中提取了所有 url：

```
egrep -o "\(?\bhttp://[-A-Za-z0-9+&@#/%?=~_()|!:,.;]*[-A-Za-z0-9+&@#/%=~_()|]"  my-bookmark.json 
```

# xml - 元素声明一致性

> ID：13148796
> 
> 赞同：0
> 
> 时间：2012-10-30T22:56:04.527
> 
> 标签：xml, xsd

元素声明一致性指定在特定的内容模型中，两个同名元素必须具有相同的类型。但是，这样的限制有什么用，如果不尊重它会产生什么影响

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T01:08:14.433

您提到的约束确保如果我们知道从验证根到节点的路径，以及验证开始的元素声明、属性声明或类型定义，那么我们就知道节点应该具有什么类型。我们不需要检查它在兄弟姐妹中的位置；任何元素的第一`foo`个子元素和该元素的第五`foo`个子元素将具有相同的声明类型。

某些类型系统（例如在 XQuery 和 XSLT 中使用的系统）利用了这一事实。

如果不遵循约束，则意味着所讨论的模式不是符合标准的模式，因此 XSD 规范定义的模式验证是不可能的。

# java - 读取文件时忽略字符

> ID：13148806
> 
> 赞同：1
> 
> 时间：2012-10-30T22:56:59.003
> 
> 标签：java, java.util.scanner

所以我正在阅读一个文件，我希望忽略某些字符。

我的文件将是这样的：

```
 5
 f1: A, B, 2
 f2: C, B, 5
 f3: C, D, 8
 2
 A, C
 B, D 
```

我将使用扫描仪。现在，读取第一个整数没问题，input.nextInt()

我到了第二行，问题就来了。我想忽略“：”和“，”我考虑过使用 BufferedReader 并逐个字符地进行，但我想了解是否可以使用扫描仪来做到这一点。

我一直在寻找，有：

```
 input.useDelimiter([\\:\\]) 
```

但它不起作用。它抛出一个异常。

我也研究过：

```
 Pattern p = Pattern.compile("\\W"); 
   // means any non-word characters, see details in the Pattern class 
```

但我真的不知道它是如何工作的。

那么我应该继续尝试使用扫描仪还是回到 BufferedReader？

**如何用扫描仪解决？**

# php - 从数据库中检索到错误的数据

> ID：13148810
> 
> 赞同：0
> 
> 时间：2012-10-30T22:57:30.100
> 
> 标签：php, mysql, database

所以，我想检索列表元素的顺序。顺序由用户预先设置，并存储在下表中。因为我还想检索列表元素的名称和描述，所以我需要组合两个表（见下文）。

但是，实际检索到的是一个包含 16 个元素的数组（应该是 4 个，因为它现在只存在 4 个元素）。该数组太长，无法在此处发布，但如果您有兴趣，我将其放在 phpFiddle[中，以便在此处找到。](http://phpfiddle.org/main/code/b2a-vtp)

好吧，我真的试图找出问题所在（可能像往常一样容易），但没有运气。

非常感谢您的时间和帮助！

**列表模型.php：**

```
public function GetOrderedElements($userId, $listId) {

// $userId = 46
// $listId = 1

        $query = "SELECT le.listElemId, le.listElemName, le.listElemDesc, lo.listElemOrderPlace
                    FROM listElement AS le
                    INNER JOIN listElemOrder AS lo
                    ON le.listId = lo.listId
                    WHERE lo.userId = ?
                    AND lo.listId = ?
                    ORDER BY listElemId";

        $stmt = $this->m_db->Prepare($query);

        $stmt->bind_param("ii", $userId, $listId);

        $listElements = $this->m_db->GetOrderedElements($stmt);

        return $listElements;       
    } 
```

**数据库.php：**

```
public function GetOrderedElements(\mysqli_stmt $stmt) {

        if ($stmt === FALSE) {
                throw new \Exception($this->mysqli->error);
        }

        if ($stmt->execute() == FALSE) {
                throw new \Exception($this->mysqli->error);
        }

        if ($stmt->bind_result($listElemId, $listElemName, $listElemDesc, $listElemOrderPlace) == FALSE) {
            throw new \Exception($this->mysqli->error);
        }

        $listElements = array();

        while ($stmt->fetch()) {
            $listElements[] = array('listElemId' => $listElemId,
                                 'listElemName' => $listElemName,
                                 'listElemDesc' => $listElemDesc,
                                 'listElemOrderPlace' => $listElemOrderPlace);
        }

        var_dump($listElements);

        $stmt->Close();

        return $listElements;
    } 
```

**从数据库：**

*listElemOrder*：

```
listElemOrderId | listId | listElemId | userId | listElemOrderPlace
      1              1          1          46           1
      4              1          2          46           4
      2              1          3          46           2
      3              1          4          46           3 
```

*列表元素*：

```
listElemId | listElemName | listId | listElemDesc | listElemOrderPlace
      1          Elem A         1         Derp             NULL
      2          Elem B         1         Herp             NULL
      3          Elem C         1         Lorum            NULL
      4          Elem D         1         Ipsum            NULL 
```

**注意：表***listElement*中的'listElemOrderPlace'是元素的最终顺序（所有用户平均），不能与其他表中同名的元素混合，这只是特定用户对列表元素的顺序（其中在这种情况下是有趣的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:59:28.887

您忘记添加`listElemId`加入条件：

```
FROM listElement AS le
INNER JOIN listElemOrder AS lo
ON le.listId = lo.listId
AND le.listElemId = lo.listElemId  -- add this criterion 
```

由于两个表中的列名称相同，因此可以缩写为：

```
FROM listElement AS le
INNER JOIN listElemOrder AS lo
USING (listId, listElemId) 
```

第二种形式还具有在实际上没有歧义时避免“歧义列”错误的优点。

# javascript - 一种 Javascript 无法读取 ajax 脚本生成的数据

> ID：13148813
> 
> 赞同：0
> 
> 时间：2012-10-30T22:57:55.257
> 
> 标签：javascript, ajax, jquery

我有一种情况，我的 Jquery Ajax 脚本生成 HTML 表。另一个脚本旨在通过提供包含该特定列中唯一值的下拉列表来过滤表列。

如果我在 html 页面中有静态内容，则过滤器脚本可以正常工作。但是在运行时通过 Ajax 生成时无法读取表内容。

任何想法可能是什么原因。我还尝试按顺序对齐脚本。

我的 Ajax 脚本在这里：-

```
$(document).ready(function() {

    $("#getResults").click(function(){ 

             bug = $("#bug").val();
             priority = $("#priority").val();
             component = $("#component").val();
             fixVersion = $("#fixVersion").val();
             dateType = $("#dateType").val();
             fromDate = $("#dp2").val();
             toDate = $("#dp3").val();

            $("#query").empty();

            $("tbody").empty();

            $.post("getRefineSearchResultsPath", {bug:bug,priority:priority,component:component,
                    fixVersion:fixVersion,dateType:dateType,fromDate:fromDate,toDate:toDate },
                    function(data) {

                // setting value for csv report button
                //clear the value attribute for button first
                $("#query_csv").removeAttr("value");

                //setting new value to "value" attribute of the csv button
                $("#query_csv").attr("value", function(){
                    return $(data).find("query").text();
                });

                $("#query").append("<p class='text-success'>Query<legend></legend><small>" +$(data).find("query").text() +"</small></p>");

                var count = 1;

                $(data).find("issue").each(function(){

                    var $issue = $(this);

                    var value = "<tr>";

                    value += "<td>" +count +"</td>";
                    value += "<td>" +$issue.find('issueKey').text() +"</td>";
                    value += "<td>" +$issue.find('type').text() +"</td>";
                    value += "<td><div id='list' class='summary'>" +$issue.find('summary').text() +"</div></td>";
                    value += "<td><div id='list' class='mousescroll'>" +$issue.find('description').text() +"</div></td>";
                    value += "<td>" +$issue.find('priority').text() +"</td>";
                    value += "<td>" +$issue.find('component').text() +"</td>";
                    value += "<td>" +$issue.find('status').text() +"</td>";
                    value += "<td>" +$issue.find('fixVersion').text() +"</td>";
                    value += "<td>" +$issue.find('resolution').text() +"</td>";
                    value += "<td>" +$issue.find('created').text() +"</td>";
                    value += "<td>" +$issue.find('updated').text() +"</td>";
                    value += "<td>" +$issue.find('os').text() +"</td>";
                    value += "<td>" +$issue.find('frequency').text() +"</td>";

                    value += "<td>";

                    var number_of_attachement = $issue.find('attachment').size();

                    if(number_of_attachement > 0){

                        value += "<div id='list' class='attachment'>";
                        value += "<ul class='unstyled'>";

                        $issue.find('attachment').each(function(){

                            var $attachment = $(this);

                            value += "<li>";
                            value += "<a href='#' onclick='document.f1.attachmentName.value='" +$attachment.find('attachmentName').text(); 
                            value += "';document.f1.issueKey.value='"+$attachment.find('attachmentissueKey').text();
                            value += "';document.f1.digest.value='"+$attachment.find('attachmentdigest').text();
                            value += "';document.f1.submit();'>"+$attachment.find('attachmentName').text();
                            value += "</a>";
                            value += "</li>";
                            value += "<br>";
                        });

                        value +="</ul>";
                        value +="</div>";
                    }

                    value += "</td>";
                    value += "</tr>";

                    $("tbody").append(value);

                    count++;

                }); 

            });

        });

}); 
```

我的过滤表脚本在这里，我从这个链接[http://www.javascripttoolbox.com/lib/table/得到了这个脚本](http://www.javascripttoolbox.com/lib/table/)

我的 JSP 页面在这里：-

```
<html>
<body>
<table class="table table-bordered table-condensed table-hover example sort01 table-autosort:0 table-autofilter table-autopage:10 table-page-number:t1page table-page-count:t1pages table-filtered-rowcount:t1filtercount table-rowcount:t1allcount">

                    <thead >
                    <tr>
                        <th class="table-sortable:numeric" Style="width:3%;">No.</th>  
                            <th class="table-sortable:default" Style="width:5.5%;">Issue Key <br> 
                            </th>

                            <th>Type</th>
                            <th Style="text-align: center;">Summary</th>
                            <th Style="text-align: center;">Description</th>

                            <th class="table-filterable table-sortable:default" id ="priorityColumn" Style="width:5%">Priority</th>

                            <th class="table-filterable table-sortable:default" >Component</th>
                            <th class="table-filterable table-sortable:default" Style="width:5%">Status</th>
                            <th class="table-filterable table-sortable:default">Fix Version</th>
                            <th class="table-filterable table-sortable:default" Style="width:6%">Resolution</th>
                            <th>Created</th>
                            <th>Updated</th>
                            <th>OS</th>
                            <th>Frequency</th>
                            <th>Attachments</th>
                        </tr>
                    </thead>

                    <tbody>

                    </tbody>

                    <tfoot>
                        <tr>
                            <td class="table-page:previous" style="cursor:pointer;"><img src="table/icons/previous.gif" alt="Previous"><small>Prev</small></td>
                            <td colspan="13" style="text-align:center;">Page <span id="t1page"></span>&nbsp;of <span id="t1pages"></span></td>
                            <td class="table-page:next" style="cursor:pointer;">Next <img src="table/icons/next.gif" alt="Previous"></td>
                        </tr>
                        <tr Style="background-color: #dddddd">
                            <td colspan="15"><span id="t1filtercount"></span>&nbsp;of <span id="t1allcount"></span>&nbsp;rows match filter(s)</td>
                        </tr>   
                        <tr class="text-success">
                            <td colspan="15">Total Results : ${count}</td>
                        </tr>
                    </tfoot>
            </table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:10:34.060

问题很可能是过滤器脚本在页面加载时读取初始表数据并存储一个大对象，然后该对象被过滤。您的 AJAX 明显改变了 html 而不是数据对象。

粗略地浏览和搜索支持文档中的文本并没有发现对我来说对 AJAX 的任何支持。它似乎也不包含`destroy`方法，因此您可以在 AJAX 之后重新初始化。脚本的 API 看起来也不是很健壮。

我建议您寻找支持 ajax 的集成表系统，例如 datatables.js 或 jQgrid。两者都在积极开发中并被广泛使用

# matlab - 无法更改绘图中的字体大小/类型

> ID：13148818
> 
> 赞同：6
> 
> 时间：2012-10-30T22:58:34.920
> 
> 标签：matlab, fonts, plot, size

我最近不得不重新安装我的操作系统（Ubuntu）。唯一不同的是我将 Matlab 安装在一个单独的分区上，而不是 Ubuntu 主分区上。重新安装后，我的绘图中的字体不再可配置。例如，如果我要求标题字体加粗，它不会发生。我在我的计算机上运行了下面的示例代码，然后在我同事的计算机上运行了 2 个结果。这不是代码的问题；而是在 Matlab 的设置中。有人可以告诉我我需要更改哪些设置吗？在此先感谢您的帮助。

问候，

萨米特。

```
x1=-pi:.1:pi;
x2=-pi:pi/10:pi;
y1=sin(x1);
y2=tan(sin(x2)) - sin(tan(x2));
[AX,H1,H2]=plotyy(x1,y1,x2,y2);
xlabel ('Time (hh:mm)');
ylabel (AX(1), 'Plot1');
ylabel (AX(2), 'Plot2');
axes(AX(2))
set(H1,'linestyle','none','marker','.');
set(H2,'linestyle','none','marker','.');
title('Plot Title','FontWeight','bold');
set(gcf, 'Visible', 'off');
[legh, objh] = legend([H1 H2],'Plot1', 'Plot2','location','Best');
set(legend,'FontSize',8); 
print -dpng Trial.png; 
```

坏图片：http: [//imageshack.us/photo/my-images/708/trial1u.png/](http://imageshack.us/photo/my-images/708/trial1u.png/)

好图：http: [//imageshack.us/photo/my-images/87/trial2.png/](http://imageshack.us/photo/my-images/87/trial2.png/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T23:16:27.560

我认为问题不在于字体，而在于 NVIDIA 的 DPI 设置。从这个关于[如何在 Ubuntu linux 中修复 MATLAB 小图形和小字体的](http://ifixdit.blogspot.com/2011/08/how-to-fix-matlab-small-figures-and.html)链接：

为了设置您的显示 DPI 设置，您需要将以下行添加到“设备”部分的 xorg.conf 文件中：

```
Option "UseEdidDpi"   "false"
Option "Dpi"          "92 x 92" 
```

如果您是 linux 新手，您可以通过以下过程完成此操作：

*   通过转到 Applications -> Accessories -> Terminal 启动终端窗口
*   键入此内容并按 Enter：sudo gedit /etc/X11/xorg.conf
*   在文件的“设备”部分添加上述两行
*   保存，重启电脑

如果不是这种情况，请尝试关注此[线程](http://ubuntuforums.org/showthread.php?t=1762805)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-19T12:28:59.953

我安装了`xfonts-100dpi`和`xfonts-75dpi`. 然后注销并登录。

It helped me perfectly with this issue in Linux Mint Petra. I did not try it in Ubuntu.

# java - date.getHours() 到 calendar.hour

> ID：13148819
> 
> 赞同：0
> 
> 时间：2012-10-30T22:59:00.277
> 
> 标签：java, calendar

我想以 24 小时为周期获取一天中的时间。我知道 date.getHours() 已贬值。但我很想使用它，因为我无法从 calendar.hour 通话中得到相同的结果。似乎调用 calendar.setTime(now) 没有获取当前日期值。有人知道这里发生了什么吗？非常感激。

```
Date d = new Date();
Calendar c = Calendar.getInstance();
c.setTime(d);
System.out.println("hour: "+Math.abs(c.HOUR-24)+", mins: "+Math.abs(c.MINUTE-60)+", d.h: "+d.getHours() +", d.m: "+d.getMinutes()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:19:36.943

您正在访问 Calendar 的`HOUR`and`MINUTE` *静态*属性。这些用作一种公共静态枚举，以便在您调用`Calendar.get()`或`Calendar.set()`引用特定字段时。要获取日历中包含的实际时间，您应该使用：

```
c.get(Calendar.HOUR); 
```

# sql - 我应该如何提高我的查询性能？

> ID：13148822
> 
> 赞同：0
> 
> 时间：2012-10-30T22:59:24.913
> 
> 标签：sql, performance, indexing, db2

我创建了一个包含几列的表。

我的表

*   Column1 -> RecordId (int)
*   Column2 -> 标题（varchar）
*   Column3 -> 短名称（varchar）
*   第 4 列 -> (varchar)
*   第 5 列 -> varchar

    ...

    ...

*   第 10 列-> varchar

我不会将这张桌子与任何其他桌子一起加入。我在表中有 4 行数据。

当我查询特定 RecordId 的标题、短名称时，查询似乎太慢了。加载页面几乎需要 7 秒。

我没有在我的表上使用任何索引。您能否建议我如何提高我的表/查询性能？

我正在从我的 jsp 建立数据库连接，以便在列表框中显示查询结果。

我的代码看起来像这样- conn= DataObjectConnectionPool.getInstance().getConnection(); prepStmt = conn.prepStmt("select title,shortname from MyTable where RecordId=1");

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T01:14:04.437

在有 4 行的表上创建索引绝对没有意义。如果您想在 dbms 中查看执行查询的时间，请在运行查询后从包缓存中获取一些数据。

```
select num_exec_with_metrics, total_act_time,  pool_read_time
  from table(mon_get_pkg_cache_stmt(null,null,null,null)) 
```

该表函数中有 100 个其他列涉及不同类型的等待等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T10:19:59.047

您应该在 RecordId 上定义一个**主键。**

这将产生在该列上创建索引的副作用。

但

如果您的页面在 7 秒内加载，并且表中只有 4 行数据，那么几乎可以肯定问题不在 DBMS 中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-01T10:14:39.943

基本上你在你的代码中使用这个 sql 查询：

```
select title,shortname from MyTable where RecordId=1 
```

`RecordID`从数据库端，您可以通过在列上创建索引然后执行 runstats ==>来加快查询速度

```
create index MyIndex on MyTable (RecordID) Compress yes Allow reverse scans;
runstats on table Mytable and indexes all shrlevel change; 
```

# c# - 使用自定义 FluentValidator 验证器验证枚举

> ID：13148825
> 
> 赞同：7
> 
> 时间：2012-10-30T22:59:38.193
> 
> 标签：c#, unit-testing, testing, lambda, fluentvalidation

我创建了一个自定义验证器，它测试一个值是否在枚举的有效值范围内：

```
public class IsInEnumValidator<T> : PropertyValidator {
  public IsInEnumValidator() : base("Property {PropertyName} it not a valid enum value.") { }
  protected override bool IsValid(PropertyValidatorContext context) {
    if (!typeof(T).IsEnum) return false;
    return Enum.IsDefined(typeof(T), context.PropertyValue);
  }
} 
```

以及链接验证器的扩展方法：

```
public static IRuleBuilderOptions<T, TProperty> IsInEnum<T, TProperty>(this IRuleBuilder<T, TProperty> ruleBuilder) {
  return ruleBuilder.SetValidator(new IsInEnumValidator<TProperty>());
} 
```

我想像这样使用它：

```
RuleFor(x => x.Day).IsInEnum<DayOfWeek>(); 
```

**我的问题：**

1.  这不能按预期工作，因为我需要指定`....IsInEnum<T, DayOfWeek>()`而不是期望的`....IsInEnum<DayOfWeek>();`. 我如何实现这一目标？

2.  我想测试这个自定义验证器——不是用这个验证器测试我的数据，而是测试验证器本身。该库的文档解释了如何测试您的数据，而不是如何测试自定义验证器。库中似乎有很多测试代码，有什么我可以重用的吗？我使用 NUnit。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-31T11:33:24.310

1：由于类型推断，您实际上不需要在`IsInEnum()`调用中指定任何内容。

2：对于测试，该项目有很多测试可以适应这个场景。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-02-26T16:10:20.753

从 6.2 版开始，IsInEnum 是内置的。从 6.2.1 开始支持 Nullable 枚举。

干杯。

# cognos - 尽管已选择所有提示值，但缺少一个或多个必需值

> ID：13148826
> 
> 赞同：0
> 
> 时间：2012-10-30T22:59:39.777
> 
> 标签：cognos

在我的 COGNOS 提示页面中，我有一个“生成”按钮。点击它，我调用脚本：

```
function generateReport(format) { 
        if(!canSubmitPrompt())
                       return;
...
..
} 
```

现在，虽然页面上的所有“必需”提示都已被选中，但我仍然收到错误消息：`'One or more of the required values are missing. Required values are needed to produce the report.'` 我还检查了使用提示的主查询主题上的所有过滤器都是可选的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T20:35:07.757

参数页面上有一个隐藏块，其中包含一些必需的参数。这就是问题的原因。隐藏的块被删除并解决了它。感谢大家阅读。

# visual-studio - 无法创建虚拟机

> ID：13148828
> 
> 赞同：39
> 
> 时间：2012-10-30T22:59:47.367
> 
> 标签：visual-studio, windows-phone-8

今天很开心，终于可以安装Windows Phone 8 SDK并试了一下。我将全新安装的 Windows 8 Pro 安装到我的虚拟机中（如果从 Parallels 运行，我正在运行），然后安装了 Windows Phone 8 SDK。

一切顺利，Visual Studio Express 已安装并运行，但是当我创建新项目并尝试部署它时，VS 失败并显示非常奇怪的消息。

首先，出现提示“Windows Phone Emulator 无法创建虚拟机：一般故障”的消息框。真正通知，真正专业 - 一般错误，这真的很好。然后出现部署失败的信息（非常感谢您让我了解这一点，我没有注意到它完全崩溃了）。然后在错误列表中，有一个关于“无效指针”的信息——甚至更好。根本不知道发生了什么失败或出了什么问题。

有人可以帮我吗？到目前为止，互联网上没有关于此主题的任何内容，我不知道问题出在哪里。我扫描了 Windows 事件和日志，但什么也没有（可能我没有正确搜索，所以如果可以的话，请指导我）。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-31T17:43:44.870

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-31T17:27:28.357

我遇到了同样的问题，我通过在此虚拟机中启用 Hypervisor 应用程序并将以下行添加到 .vmx 文件来修复它：

hypervisor.cpuid.v0 = "假"

这让模拟器工作得很好。[我在这里](http://www.veeam.com/blog/nesting-hyper-v-with-vmware-workstation-8-and-esxi-5.html)找到了这个答案。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-01T13:14:35.030

Actually, it works quite nicely with VMware Fusion 5.0.1

All I had to do is to add to the .vmx file of the virtual machine the following lines:

hypervisor.cpuid.v0 = “FALSE” vhv.enable = "true"

Save and restart VMWARE (obviously the VM must be stopped before the changes are made)

I'm right now debugging a test app from VS2012 using the emaulator inside a VM in my Macbook

I'm a happy camper

:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-01T20:14:29.427

I posted the same question on Parallels forum.

# Reply:

The emulator is actually a virtual machine, so we are talking about a vm inside a vm, this requires support for nested Hyper-V, which afaik is planned but not implemented yet, also VMWare Fusion already supports this, if you are so desperate.

————-

See Parallels forum post: [http://forum.parallels.com/showthread.php?p=646448#post646448](http://forum.parallels.com/showthread.php?p=646448#post646448)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-10T11:26:38.723

This works for me

Set RAM to 4g Set at least 2 cores

add to vmx file.

vhv.enable = "TRUE"

hypervisor.cpuid.v0="FALSE"

Goot article [http://social.msdn.microsoft.com/Forums/en-US/wptools/thread/ed72010c-321c-4667-97b2-3ff1540e7f87/](http://social.msdn.microsoft.com/Forums/en-US/wptools/thread/ed72010c-321c-4667-97b2-3ff1540e7f87/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-30T23:24:41.683

您需要[SLAT](http://en.wikipedia.org/wiki/Second_Level_Address_Translation)兼容的硬件来运行 Hyper-V，这是使用模拟器的要求。

您能否说明您尝试在哪种硬件上运行它，以及您是否在 BIOS 设置中启用了虚拟化？

“*无效指针”*错误仅表示它无法连接到模拟器（和/或设备）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-09T23:09:01.720

Just as an addition to [https://stackoverflow.com/a/13163762/1964969](https://stackoverflow.com/a/13163762/1964969) (top answer at the moment): manually appending "hypervisor.cpuid.v0" key works for VmWare Player 5 as well (the main reason - this software is free for non-commercial use so it's perfect product if you test the waters, just download from VmWare website and install, it's fully-functional).

Slightly unexpected, any of the following amends solve the problem with WP8 emulator:

```
hypervisor.cpuid.v0="FALSE"
hypervisor.cpuid.v0="TRUE"
hypervisor.cpuid.v0="" 
```

Yeah, you can apply empty value for that key - but why? Have no idea but it works. I did some notes in my blog as well: [http://windowsasusual.blogspot.ru/2013/01/how-to-launch-windows-phone-8-emulator.html](http://windowsasusual.blogspot.ru/2013/01/how-to-launch-windows-phone-8-emulator.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-05-06T15:16:25.150

Under Parallels Desktop 8 follow this guide: [http://kb.parallels.com/en/115211](http://kb.parallels.com/en/115211)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-31T13:03:13.063

**编辑**：哦，我没有注意到您正在尝试在 VM 上运行模拟器。我的答案是针对非 VM 环境。

* * *

首先，您需要在[这里检查硬件要求](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff626524%28v=vs.105%29.aspx)

请注意，SDK 安装成功**并不能**保证“您的硬件兼容” 如果您的硬件兼容并且 Hyper-V 正在运行（如上链接所述），请检查您的 BIOS 并确保在 CPU 配置中启用硬​​件虚拟化

（对我来说，我可以在 Booting > BIOS > Advanced > Advanced > CPU Configuration 找到它）

简要总结：

*   64位CPU和操作系统
*   4GB 内存
*   硬件辅助虚拟化支持的 CPU
*   二级地址转换 (SLAT) 支持的硬件
*   基于硬件的数据执行保护 (DEP) 支持的硬件
*   正确的 BIOS 设置

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-28T12:52:34.330

For me the solution adding line:

```
hypervisor.cpuid.v0 = "FALSE" 
```

I use VMware Player and added the line (`hypervisor.cpuid.v0 = "FALSE"`)in the .vmx file. My virtual machine with Windows 8 Pro runs the emulator for Windows Phone 8 perfectly.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-29T13:06:16.653

Solved the problem by uninstalling an older VPN client from the machine. It turns out some VPN clients might have compatibility issues with Windows 8\. After uninstalling VPN client I was able to run the emulator without issues (of course after making sure Hyper-V was installed and enabled on the machine)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-06-09T07:42:24.353

Not enough rep. to comment on the accepted answer, but Microsoft provide instructions specifically for Fusion [here](http://msdn.microsoft.com/en-us/library/windows/apps/jj945426.aspx). It worked for me, after a couple of reboots of both Mac and VM. I installed W8.1 without Hyper-V support initially and had to install it after the fact ("Turn Windows Features On or Off" in Control Panel), but apart from that no problems. Quite speedy on a 16Gb 2013 MBP.

# c++ - QFileSystemWatcher：检测删除和添加的文件，但没有修改一个

> ID：13148830
> 
> 赞同：1
> 
> 时间：2012-10-30T22:59:49.507
> 
> 标签：c++, qt, qfilesystemwatcher

我正在使用 Qt 在 Windows 上开发应用程序，我需要检测特定文件夹中的更改。因此，我使用了 QFileSystemWatcher，并将 directoryChanged 信号连接到一个函数，该函数将在发生更改时发送消息。

问题是，如果我修改文件的内容，则不会调用连接到 directoryChanged 的​​“插槽”函数，而只会在删除或添加文件或目录时调用。

但是，文档说，当“指定路径的目录被修改（例如，当添加、**修改**或删除文件时）或从磁盘中删除时，会发出此信号。”

有人有解释吗？提前感谢=）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T01:33:20.240

根据Qt源码4.8.2版本，如下：

```
void QFileSystemWatcherPrivate::_q_directoryChanged(const QString &path, bool removed)
{
    Q_Q(QFileSystemWatcher);
    if (!directories.contains(path)) {
        // perhaps the path was removed after a change was detected, but before we delivered the signal
        return;
    }
    if (removed)
        directories.removeAll(path);
    emit q->directoryChanged(path);
} 
```

似乎 directoryChanged 在文件被删除、添加（对于新添加的文件不包含在目录中）和重命名时发出。该实现不保证检测到文件内容的修改。希望有帮助：P

# python - 图像“黑色墨水量”的水平轴直方图

> ID：13148835
> 
> 赞同：9
> 
> 时间：2012-10-30T23:00:22.333
> 
> 标签：python, linux, image-processing, imagemagick, gnuplot

我有一个黑白图像（或 pdf）文件，并且想要获取图像水平轮廓的直方图。也就是说，对于图像中的每一列，我想要列中像素的灰度值之和。如果图像是 X x Y 像素，我将得到介于 0（对于完全黑色的列）和 255*Y（对于完全白色的列）之间的 X 数字。

请看[此漫画的第二个面板](http://xkcd.com/688/) ![漫画](../Images/7f9dd539f4751f3c63d56bc101fa4d44.png)

我想要这样的直方图，但每个 bin 都代表图像中该 x 坐标（像素）处的所有“黑色墨水”。

作为一个贫穷的研究生，我只能使用 Linux 命令行、FOSS 程序（ImageMagick、gnuplot、Perl、g++ 等）。只有当我可以通过终端运行命令时，像 GIMP 这样的东西才会有帮助，因为我无法访问 GUI。视觉输出文件对以后会有帮助，但不是必需的。

有谁知道我可以提取这些信息的方法吗？搜索“图像配置文件”只会导致有关颜色配置文件的信息。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-31T01:25:00.933

我将使用我最喜欢的两个免费实用程序：python 和 gnuplot 分两步给出答案。

作为一名（计算）研究生，我的建议是，如果你想免费做一些事情，python 是你可以学习使用的最通用的工具之一。

这是一个执行第一部分的 python 脚本，计算灰度值（从白色的 0 到黑色的 255）：

```
#!/usr/bin/python

import Image            # basic image processing/manipulation, just what we want

im = Image.open('img.png')       # open the image file as a python image object
with open('data.dat', 'w') as f: # open the data file to be written
    for i in range(im.size[0]):  # loop over columns
        counter = sum(im.getpixel((i,j)) for j in range(im.size[1]))
        f.write(str(i)+'\t'+str(counter)+'\n')  # write to data file 
```

令人震惊的无痛！现在让 gnuplot 制作直方图*：

```
#!/usr/bin/gnuplot

set terminal pngcairo size 925,900
set output 'plot.png'
#set terminal pdfcairo
#set output 'plot.pdf'
set multiplot

## first plot
set origin 0,0.025              # this plot will be on the bottom
set size 1,0.75                 # and fill 3/4 of the whole canvas

set title "Black count in XKCD 'Self-Description'"
set xlabel 'Column'
set ylabel "Black\ncount" norotate offset screen 0.0125

set lmargin at screen 0.15      # make plot area correct size
set rmargin at screen 0.95      # width = 740 px = (0.95-0.15)*925 px

set border 0                    # these settings are just to make the data
set grid                        # stand out and not overlap with the tics, etc.
set tics nomirror
set xtics scale 0.5 out 
set ytics scale 0

set xr [0:740]                  # x range such that there is one spike/pixel

## uncomment if gnuplot version >= 4.6.0
## this will autoset the x and y ranges
#stats 'data.dat'
#set xr [STATS_min_x:STATS_max_x+1]
#set yr [STATS_min_y:STATS_may_y]

plot 'data.dat' with impulse notitle lc 'black'

## second plot
set origin 0,0.75               # this plot will be on top
set size 1,0.25                 # and fill 1/4 of the canvas

unset ylabel; unset xlabel      # clean up a bit...
unset border; unset grid; unset tics; unset title

set size ratio -1               # ensures image proper ratio
plot 'img.png' binary filetype=png with rgbimage

unset multiplot         # important to unset multiplot! 
```

要运行这些脚本，请将它们与您要绘制的图像保存在同一目录中（在本例中为 XKCD 漫画，我将其保存为`img.png`）。使它们可执行。在 bash 这是

```
$ chmod 755 grayscalecount.py plot.plt 
```

然后（如果python+image module+gnuplot都安装好了），就可以运行了

```
$ ./grayscalecount.py
$ ./plot.plt 
```

在我的计算机上，运行带有 gnuplot 4.4.3 的 Ubuntu 11.10，最后我得到了这个很酷的情节：

![在此处输入图像描述](../Images/670d6516aa900975ccf3cf1c9382fb0e.png)

**旁注*：gnuplot 可以制作许多不同的直方图。我认为这种风格很好地展示了数据，但您可以查看为[gnuplot histograms](http://www.gnuplot.info/demo/histograms.html)格式化数据。

有很多方法可以让 python 自己或使用 gnuplot（matplotlib、pygnuplot、gnuplot-py）制作绘图，但我对这些并不那么容易。Gnuplot 非常适合用于绘图，并且有很多方法可以使它与 python、bash、C++ 等很好地配合使用。

# javascript - Javascript，暂停/恢复 window.load 事件

> ID：13148836
> 
> 赞同：1
> 
> 时间：2012-10-30T23:00:33.483
> 
> 标签：javascript, events, dom-events, onload

我有一个不寻常的问题，超出了我的客户端技能。我有一个 html 页面，`script`正文中有两个连续的标签。两个`script`标签都会触发一个 ajax 请求来检索内容，然后将其放入 DOM。我控制第一个`script`标签，我对第二个标签没有任何控制或知识`script`。我只知道它会进行 ajax 调用并将内容放入 DOM。我也知道我的标签是第一位的。

我希望我的脚本标签立即触发并暂停/停止第二个标签。然后，根据我的 ajax 返回的内容，我可以选择执行第二个脚本标记。我该怎么做呢？

我写了一个[小提琴](http://jsfiddle.net/SWkLX/1/)来证明我的问题。我用`settimeout`'s 代替了 ajax 调用和`Math.random`我的决定。请注意，`settimeout`第一个（我的）的持续时间很长，3 秒，第二个（我无法控制的持续时间很短，0.5 秒。现在发生的是它们都是立即运行。第二条消息在 0.5 秒到达，而来自第一条的消息在 3 秒到达 50% 的时间。

我希望第一个脚本运行，等待 3 秒，做出决定并立即打印第一条消息，或者调用第二个脚本，该脚本将再等待 0.5 秒以打印第二条消息。我不应该同时看到两条消息，也不应该在 3.5 秒之前看到第二条消息。

同样，我对脚本 2 的内容一无所知。在这种情况下，您可以轻松隐藏 id= `ext_div`，但我不知道该 id 是什么。那不是我想要的答案。我正在考虑在第一个脚本中抓住事件并对此做一些事情，`stopPropagation`或者在`TODO1`评论中做类似的事情。但这不起作用。如果确实发生了事件，我将需要一个`resumePropgation`我认为不存在的函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:14:41.083

感觉就像您想要为您的前端脚本提供某种依赖管理系统。

试试[RequireJS](http://requirejs.org/)。您可以加载您的脚本，运行您的 ajax 请求，并根据您的逻辑，决定是否加载第二个外部脚本。

这是假设您当然可以控制页面上的标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:06:44.433

> 我希望我的脚本标签立即触发并暂停/停止第二个标签。然后，根据我的 ajax 返回的内容，我可以选择执行第二个脚本标记。我该怎么做呢？

实现这一点的唯一方法是使您的 ajax 调用同步，例如，`false`作为第三个参数传递给[`XMLHttpRequest#open`](http://msdn.microsoft.com/en-us/library/ie/ms536648%28v=vs.85%29.aspx)（或您正在使用的库中的任何等效项，如果您正在使用一个）。为什么这是一个**坏主意**有**几个原因**，但是如果您绝对肯定需要在执行下一个标签之前完成 ajax 调用，那么这是唯一的方法。当然，这意味着HTML 文档中您的标签下方定义的任何 DOM 元素都不存在。**`script``script`**

# jquery - 使用 jQuery 循环遍历输入字段以找到最大值？

> ID：13148839
> 
> 赞同：6
> 
> 时间：2012-10-30T23:00:47.293
> 
> 标签：jquery

我的页面上有许多`input[type=text]`字段，我想遍历所有字段以查找并返回最高值。

有没有办法用 jQuery 做到这一点？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-30T23:02:52.767

这是一种解决方案：

```
var highest = -Infinity;
$("input[type='text']").each(function() {
    highest = Math.max(highest, parseFloat(this.value));
});
console.log(highest); 
```

这是另一个解决方案：

```
var highest = $("input[type='text']").map(function() {
    return parseFloat(this.value);
}).get().sort().pop();

console.log(highest); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-30T23:10:51.913

使用[Math.max](http://www.w3schools.com/jsref/jsref_max.asp)函数：

```
var nums = [];
$("input[type=text]").each( function() { nums.push( $(this).val() ); });
var max = Math.max.apply(Math, nums); 
```

# c# - 如何在“使用”块中更改位图的大小？

> ID：13148840
> 
> 赞同：0
> 
> 时间：2012-10-30T23:00:56.283
> 
> 标签：c#

在下面的代码中，我收到一条错误消息`bitmap = newBitmap`，说它不能分配位图，因为它是一个`using`变量。如何调整位图的大小？

```
public static Bitmap ResizeBitmap(Bitmap b, int nWidth, int nHeight)
{
            Bitmap result = new Bitmap(nWidth, nHeight);
            using (Graphics g = Graphics.FromImage((Image)result))
                g.DrawImage(b, 0, 0, nWidth, nHeight);
            return result;
}

....

using (var bitmap = new Bitmap(_width, _height, _width * 3, PixelFormat.Format24bppRgb, pBuffer))
{
    if (!this.Secondpass)
    {
        long[] HistogramValues = Form1.GetHistogram(bitmap);
        Form1.Histograms.Add(HistogramValues);
        long t = Form1.GetTopLumAmount(HistogramValues, 1000);
        Form1.averagesTest.Add(t);                            
    }
    else
    {                    
        if (_frameId > 0)
        {
            double t = Form1.averagesTest[_frameId] / 1000.0 - Form1.averagesTest[_frameId - 1] / 1000.0;
            w.WriteLine("averagesTest >>>  " + t);
            double tt = framesCounts();
            if (_frameId == framesCounts())
            {
                w.Close();
            }
            if (Form1.averagesTest[_frameId] / 1000.0 - Form1.averagesTest[_frameId - 1] / 1000.0 > 0.0) 
            {
                count = 6;
            }

            if (count > 0)
            {
                Bitmap newBitmap = ResizeBitmap(bitmap, 10, 10);
                bitmap.Dispose();
                bitmap = newBitmap;
                bitmap.RotateFlip(RotateFlipType.Rotate180FlipX);
                bitmap.Save(Path.Combine(_outFolder, _frameId.ToString("D6") + ".bmp"),ImageFormat.Bmp);
                count --;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:08:45.060

您正在尝试重新分配语句 `bitmap`中定义的变量。[根据 C# Specification](http://msdn.microsoft.com/en-us/library/aa664736%28v=vs.71%29.aspx)，这是一个错误：`using`

> 在资源获取中声明的局部变量是只读的，并且必须包含初始化程序。如果嵌入语句尝试修改这些局部变量（通过赋值或 ++ 和 -- 运算符）或将它们作为 ref 或 out 参数传递，则会发生编译时错误。

# internet-explorer-9 - Border-radius 在 IE9、IE10 和 IE11 中导致奇怪的行为

> ID：13148841
> 
> 赞同：5
> 
> 时间：2012-10-30T23:00:59.813
> 
> 标签：internet-explorer-9, internet-explorer-10, css, internet-explorer-11

这个[小提琴](http://jsfiddle.net/uvZCq/)在真实的浏览器中产生了预期的结果（我试过 FF、GC、Safari），但在 IE9、IE10 和 IE11 中意外中断。IE7或IE8没有问题。

![左边是Firefox，右边是IE9-IE11](../Images/9b972d802c7be5accf5253102a2dfc34.png)

```
<div class="root">
    Top
    <div class="footer">Bottom</div>
</div> 
```

```
.root {
    background-color: red;
    position: absolute;
    height: auto;
    bottom: 0; top: 0; left: 0; right: 0;
    margin: 25px;
    border: 0;
    border-radius: 7px;
    overflow: hidden;
}

.footer {
    background-color: green;
    position: fixed;
    left: 0;
    bottom: 0;
    width: 100%;
    height: 100px;
} 
```

如果我删除`border-radius`或`overflow:hidden`从父级删除，一切正常。但它到底与固定位置的孩子有什么关系呢？它应该始终相对于视口定位。

它是一个已知\记录的错误吗？其背后的原理是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T00:52:26.733

这就是我认为正在发生的事情。

浏览器供应商似乎已经决定`fixed`关闭溢出的位置元素剪辑，例如它们**不**被其父元素剪辑。这使事情保持一致，因为`fixed`元素是相对于窗口定位的，而不是父级。如果应用了裁剪，它将具有相对于**窗口的位置/宽度和相对于****父**级的裁剪。它在*视觉上看起来*像[这样](http://jsfiddle.net/KYP7U/1/)（除了底角应该是圆形的 - 更多内容如下）。

所以：`fixed`元素，没有溢出剪裁。查看。

但是在 IE9 中发生了一些变化。他们引入了对圆角的支持。现在来谈谈我所说的圆形剪裁。IE9 实际上做到了这一点。现在许多浏览器都会用方角剪辑，即使元素有圆角。这是不好的。显然，IE9 通过检测圆角的存在来解决这个问题，在这种情况下，*重新绘制剪辑*。当它这样做时，它会犯两个错误。

1.  它应用剪裁——撤消“`fixed`元素，没有溢出剪裁”规则。剪裁重新打开，元素现在被父元素的宽度剪裁。

2.  剪辑只是直接放在元素上，不居中，不考虑剪辑应该来自父级的事实。它只是从 0,0 开始剪裁到指定的宽度和高度——这就是绿色元素出现左对齐的原因——右/下 50px 被隐藏。

## 修复？

*   不要`fixed`在里面筑巢`absolute`。（最好的解决方案——避免将来出现奇怪的边缘情况）
*   给父（红色）div 一个宽度。
*   `div`直接在里面嵌套一个新`.root`的并移动`overflow:hidden`到它。[小提琴的例子。](http://jsfiddle.net/uvZCq/4/)（干扰最小）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-25T10:11:12.227

有同样的问题：

```
<div class="relative-parent-with-border-radius">
  ...
  <div class="container">
    <div class="fixed-child">...</div>
  </div>
  ...
</div> 
```

通过将`.container`位置设置为固定`-ms-page`

# ios - 使用 HTML Img 的文档目录

> ID：13148842
> 
> 赞同：0
> 
> 时间：2012-10-30T23:01:02.467
> 
> 标签：ios

我正在尝试使用应用程序的 Documents 目录来存储图像，然后使用带有 html 的 webview 进行访问。我尝试使用 /var/mobile/Applications/id/Documents 但这不起作用。有没有办法在 webview 中访问这些文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:39:47.413

要保存图像，您必须在 Cache 目录中下载像 NSMutableData 这样的图像：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES);
NSString *cachesDirectory = [paths objectAtIndex:0];
NSString* filePath = [NSString stringWithFormat:@"%@/imageTemp.png",cachesDirectory];
[imageData writeToFile:filePath atomically:YES]; 
```

下载后，您可以将图像移动到您的文档目录：

```
NSFileManager *fileManager = [NSFileManager defaultManager];
NSArray *arrayPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentPath = [arrayPath objectAtIndex:0];
NSString *cacheImagePath = filePath;
NSError *error;
[fileManager copyItemAtPath:cacheImagePath toPath:documentPath error:&error]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T00:00:09.743

结果我错过了一个 / 所以它应该是 file:///var/mobile/Applications/id/Documents 然后它起作用了。

# ant - 使用 XJC 将 WSDL 转换为 POJO 的 Ant 任务给出了一个错误包名称

> ID：13148843
> 
> 赞同：0
> 
> 时间：2012-10-30T23:01:16.753
> 
> 标签：ant, wsdl, xjc, jdk1.7

我有一个 Ant 任务，它需要一个 wsdl 文件并且应该自动生成 POJO（客户端 Java），所以我可以开始编写我的客户端 JAX-WS Web 服务。

但是我收到一个错误“[错误] 包名称....用于此架构不是有效的包名称”

仅当我的*wsdl*文件中包含 1 个以上的模式导入时才会发生此错误，例如

```
 <xsd:import namespace="http://service.rts.cmslink.tms.com/ProcessCustomerInquiry/Response" schemaLocation="ProcessCustomerInquiryResponse.xsd"/>
            <xsd:import namespace="http://service.rts.cmslink.tms.com/ProcessCustomerInquiry/Request" schemaLocation="ProcessCustomerInquiryRequest.xsd"/>
        </xsd:schema> 
```

下面是整个wsdl

```
<?xml version="1.0" encoding="UTF-8"?>
<wsdl:definitions xmlns:CMSLINK="http://service.rts.cmslink.tms.com/ProcessCustomerInquiry" xmlns:REQ="http://service.rts.cmslink.tms.com/ProcessCustomerInquiry/Request" xmlns:RESP="http://service.rts.cmslink.tms.com/ProcessCustomerInquiry/Response" xmlns:apachesoap="http://xml.apache.org/xml-soap" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:wsdlsoap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" targetNamespace="http://service.rts.cmslink.tms.com/ProcessCustomerInquiry" name="ProcessCustomerInquiryService">
    <wsdl:types>
        <xsd:schema>
            <xsd:import namespace="http://service.rts.cmslink.tms.com/ProcessCustomerInquiry/Response" schemaLocation="ProcessCustomerInquiryResponse.xsd"/>
            <xsd:import namespace="http://service.rts.cmslink.tms.com/ProcessCustomerInquiry/Request" schemaLocation="ProcessCustomerInquiryRequest.xsd"/>
        </xsd:schema>
    </wsdl:types>
    <wsdl:message name="ProcessCustomerInquiryRequest">
        <wsdl:part name="requestData" element="REQ:ProcessCustomerInquiryRequest"/>
    </wsdl:message>
    <wsdl:message name="ProcessCustomerInquiryResponse">
        <wsdl:part name="responseData" element="RESP:ProcessCustomerInquiryResponse"/>
    </wsdl:message>
    <wsdl:portType name="ESB_ProcessCustomerInquiryService">
        <wsdl:operation name="ReqResp">
            <wsdl:input name="processRequest" message="CMSLINK:ProcessCustomerInquiryRequest"/>
            <wsdl:output name="processResponse" message="CMSLINK:ProcessCustomerInquiryResponse"/>
        </wsdl:operation>
    </wsdl:portType>
    <wsdl:binding name="ProcessCustomerInquiryServiceSoapBinding" type="CMSLINK:ESB_ProcessCustomerInquiryService">
        <wsdlsoap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
        <wsdl:operation name="ReqResp">
            <wsdlsoap:operation soapAction="process"/>
            <wsdl:input>
                <wsdlsoap:body use="literal"/>
            </wsdl:input>
            <wsdl:output>
                <wsdlsoap:body use="literal"/>
            </wsdl:output>
        </wsdl:operation>
    </wsdl:binding>
    <wsdl:service name="ProcessCustomerInquiryService">
        <wsdl:port name="ProcessCustomerInquiry" binding="CMSLINK:ProcessCustomerInquiryServiceSoapBinding">
            <wsdlsoap:address location="http://tsesbd01.tms.toyota.com:51180/v2/MF_CMSLINK_ProcessCustomerInquiryDistributed.msgflow"/>
        </wsdl:port>
    </wsdl:service>
</wsdl:definitions> 
```

* * *

XJC Ant 任务

```
<project name="WSDLCompile" default="wsdl2java" basedir=".">
    <target name="wsdl2java" description="Run xjc -wsdl.">
        <!-- properties -->
        <property name="sourceDir" value="temp/src" />
        <echo message="sourceDir:"/>
        <echo message="${sourceDir}"/>
        <mkdir dir="temp/classes"/>
        <property name="outputDir" value="temp/classes" />
        <echo message="outputDir:"/>
        <echo message="${outputDir}"/>
        <!-- xjc properties -->
        <property name="wsdl.url" value="src/wsdl/cmslink/ProcessCustomerInquiry.wsdl" />
        <echo message="wsdl.url:"/>
        <echo message="${wsdl.url}"/>
        <property name="wsdl.mapping.package.response" value="http://service.rts.cmslink.tms.com/ProcessCustomerInquiry/Response=com.tms.cmslink.rts.service.ProcessCustomerInquiry.Response" />
        <echo message="wsdl.mapping.package.response:"/>
        <property name="wsdl.mapping.package.request" value="http://service.rts.cmslink.tms.com/ProcessCustomerInquiry/Request=com.tms.cmslink.rts.service.ProcessCustomerInquiry.Request" />
        <echo message="wsdl.mapping.package.request:"/>
        <!--C:/Program Files/Java/jdk1.7.0_09/bin/xjc -->
        <!--xjc execution-->
        <exec executable="xjc">
            <arg value="-wsdl" />
            <arg value="${wsdl.url}" />
            <arg value="-d" />
            <arg value="${outputDir}" />
            <arg value="-p"/>
            <arg value="${wsdl.mapping.package.request}"/>
            <arg value="-p"/>
            <arg value="${wsdl.mapping.package.response}"/>
            <arg value="-verbose"/>
        </exec>
    </target>
</project> 
```

如果我删除额外的模式导入*response.xsd*或*request.xsd*，并且还只包含 1 个用于 ANT 任务的“-p”包命名空间参数，那么 ANT 运行时不会出错，但是我的 wsdl 文件包含多个模式导入。

**编辑**

我更改了“-p”参数的值以遵守包约定，尽管我之前的方法是基于 JXC 错误论坛。

```
<project name="WSDLCompile" default="wsdl2java" basedir=".">
    <target name="wsdl2java" description="Run xjc -wsdl.">
        <!-- properties -->
        <property name="sourceDir" value="temp/src" />
        <echo message="sourceDir:"/>
        <echo message="${sourceDir}"/>
        <mkdir dir="temp/classes"/>
        <property name="outputDir" value="temp/classes" />
        <echo message="outputDir:"/>
        <echo message="${outputDir}"/>
        <!-- xjc properties -->
        <property name="wsdl.url" value="src/wsdl/cmslink/ProcessCustomerInquiry.wsdl" />
        <echo message="wsdl.url:"/>
        <echo message="${wsdl.url}"/>
        <property name="wsdl.mapping.package.response" value="com.tms.cmslink.rts.service.ProcessCustomerInquiry.Response" />
        <echo message="wsdl.mapping.package.response:"/>
        <property name="wsdl.mapping.package.request" value="com.tms.cmslink.rts.service.ProcessCustomerInquiry.Request" />
        <echo message="wsdl.mapping.package.request:"/>
        <!--C:/Program Files/Java/jdk1.7.0_09/bin/xjc -->
        <!--xjc execution-->
        <exec executable="xjc">
            <arg value="-wsdl" />
            <arg value="${wsdl.url}" />
            <arg value="-d" />
            <arg value="${outputDir}" />
            <arg value="-p"/>
            <arg value="${wsdl.mapping.package.request}"/>
            <arg value="-p"/>
            <arg value="${wsdl.mapping.package.response}"/>
            <arg value="-verbose"/>
        </exec>
    </target>
</project> 
```

我什至尝试过上面的蚂蚁任务，

```
-p <arg value="${wsdl.mapping.package.request }"/>
<arg value="${wsdl.mapping.package.response}"/> 
```

通过将两个包名称放在以空格分隔的 1 行，这是根据 JXC 文档，解释说您可以拥有“零个或多个包名称空间以空格分隔”。我要求 XJC 能够处理超过 1 个模式导入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:31:28.757

该`-p`选项指定一个*Java*包，该包应该用于*所有*生成的类，而不管命名空间如何。如果您希望每个命名空间 URI 映射到它自己的包，那么您不能使用`-p`，而是需要使用绑定自定义文件

```
<bindings xmlns="http://java.sun.com/xml/ns/jaxb" xmlns:xs="http://www.w3.org/2001/XMLSchema" version="2.1">
  <bindings schemaLocation="ProcessCustomerInquiryResponse.xsd" node="/xs:schema">
    <schemaBindings>
      <package name="com.example.inquiry.response"/>
    </schemaBindings>
  </bindings>
  <bindings schemaLocation="ProcessCustomerInquiryRequest.xsd" node="/xs:schema">
    <schemaBindings>
      <package name="com.example.inquiry.request"/>
    </schemaBindings>
  </bindings>
</bindings> 
```

并将其传递给`xjc`使用`-b`选项

```
<arg value="-b"/>
<arg file="bindings.xjb"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:19:27.717

我认为问题出在您的 Ant 脚本上。有两个问题：

1.  package 属性的值必须是 java 包。例如：`<property name="wsdl.mapping.package" value="com.mycompany.xml.generated"/>`
2.  您应该只指定一个包而不是两个。

祝你好运！

此外，这里是[每个模式方法的包](https://stackoverflow.com/a/3390053/1050766)的链接。

-穆尔

# haskell - 检查有向图haskell中的循环

> ID：13148844
> 
> 赞同：2
> 
> 时间：2012-10-30T23:01:18.010
> 
> 标签：haskell

我在 Haskell 中创建了一个有向图。我想编写一个算法来检查图形的周期。是否有可用的库函数可以快速做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T23:13:33.253

[http://hackage.haskell.org/package/fgl](http://hackage.haskell.org/package/fgl)相当完整，而且我听说它也很快。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T23:16:55.000

您可以尝试[containers package](http://hackage.haskell.org/package/containers-0.5.1.0)，[`Data.Graph`](http://hackage.haskell.org/packages/archive/containers/0.2.0.1/doc/html/Data-Graph.html)包括[强连接组件](http://en.wikipedia.org/wiki/Strongly_connected_component)的功能（本质上是循环）。

# java - 使用 JDBC 连接到 mysql 远程数据库？

> ID：13148852
> 
> 赞同：1
> 
> 时间：2012-10-30T23:02:29.080
> 
> 标签：java, mysql, jdbc, connection

我是一名 java 初学者，我正在开发一个使用 JDBC 连接到远程 mysql 数据库的简单应用程序。我已经在本地对其进行了测试，它工作得很好，但是我无法让它在我的远程服务器上工作。我认为它没有多大用处，但代码如下：

```
Connection connection = null;
String dburl = "jdbc:mysql://314159265:3306/Db_Name";
String userName = "user";
String passWord = "password";

    try {
        Class.forName("com.mysql.jdbc.Driver");

        connection = DriverManager.getConnection(dburl, userName, passWord);
        Statement st = connection.createStatement();                                 

        String query = "INSERT INTO Example (`TestColumn`) VALUES('hello')";
        int rsI = st.executeUpdate(query);
        System.out.println("Hi");
        }catch (Exception e) {
        System.out.println(e);
    } finally {
        if (connection != null) {
            try {
                connection.close();
                System.out.println("Database connection terminated");
            } catch (Exception e) { /* ignore close errors */ }
        }
    } 
```

当我运行它时，我收到以下消息：

```
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
The last packet sent successfully to the server was 0 milliseconds ago.The driver has not received any packets from the server. 
```

我很确定这一定是某种服务器配置问题。

```
 Notes:
 Username, password, IP, database name, etc. are just examples. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T23:27:32.110

1.  这可能是防火墙问题或配置问题。但我认为这根本不是编码问题 - 您需要开始对连接进行故障排除。

2.  通过尝试使用第三方客户端应用程序连接到 mysql 进行故障排除。这将指示它是否配置为外部访问。虽然它不能确保 JDBC 从外部可见，但它确实排除了一些潜在的防火墙问题。

3.  按照本指南帮助您弄乱您的配置

[远程 MYSQL 数据库访问](https://stackoverflow.com/questions/1700518/remote-mysql-database-access)

如果您仍然卡住，则可能是编码问题，因此请查看此页面：

[如何使用 java 连接到远程 mysql 数据库？](https://stackoverflow.com/questions/2318250/how-to-connent-to-a-remote-mysql-database-with-java)

PS 我假设您使用 unix 作为操作系统。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2014-07-22T04:54:12.507

我猜 314159265 可以用某个地址代替......比如 jdbc:mysql://localhost:3306/ 或 jdbc:mysql://127.0.0.1:3306/

# python - Python ImportError: No module named - 在 ssh 中工作但在浏览器中不工作

> ID：13148855
> 
> 赞同：0
> 
> 时间：2012-10-30T23:02:45.943
> 
> 标签：python, runtime-error, internal

不确定是什么问题。通过 ssh 工作正常。在浏览器中查看时，出现服务器错误。这是已迁移到另一个服务器/环境的已知工作代码。

它找不到明确在目录中的模块。已检查文件的权限，它们看起来不错 755。

内部服务器错误

服务器遇到内部错误或配置错误，无法完成您的请求。请联系服务器管理员，告知错误发生的时间以及您可能所做的任何可能导致错误的事情。

服务器错误日志中可能提供有关此错误的更多信息。

```
ImportError: No module named xmlproducts
mod_python (pid=16232, interpreter='realtechy.com', phase='PythonHandler', handler='mod_python.cgihandler'): Application error
ServerName: 'realtechy.com'
DocumentRoot: '/var/www/vhosts/realtechy.com/httpdocs'
URI: '/products/myproducts.py'
Location: None
Directory: '/var/www/vhosts/realtechy.com/httpdocs/'
Filename: '/var/www/vhosts/realtechy.com/httpdocs/products/myproducts.py'
PathInfo: ''
Traceback (most recent call last):
File "/usr/lib/python2.6/site-packages/mod_python/importer.py", line 1537, in HandlerDispatch\n    default=default_handler, arg=req, silent=hlist.silent)
File "/usr/lib/python2.6/site-packages/mod_python/importer.py", line 1229, in _process_target\n    result = _execute_target(config, req, object, arg)
File "/usr/lib/python2.6/site-packages/mod_python/importer.py", line 1128, in _execute_target\n    result = object(arg)
File "/usr/lib/python2.6/site-packages/mod_python/cgihandler.py", line 96, in handler\n    imp.load_module(module_name, fd, path, desc)
File "/var/www/vhosts/realtechy.com/httpdocs/products/myproducts.py", line 6, in <module>\n    import xmlproducts
ImportError: No module named xmlproducts 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:08:42.330

听起来模块没有正确安装（或根本没有安装）。要验证，请执行以下操作：

1.  打开一个shell并通过键入启动python shell`python`
2.  输入命令`help('modules')`
3.  查看返回的模块列表以查看是否`xmlproducts`包含
4.  如果没有，则安装模块

# objective-c - 用于解析的正则表达式

> ID：13148859
> 
> 赞同：0
> 
> 时间：2012-10-30T23:02:55.583
> 
> 标签：objective-c, regex, nsregularexpression

我正在寻找一个正则表达式来转换类似的东西

```
{test}hello world{/test} and {again}i'm coming back{/again} in hello world i'm coming back. 
```

我试过`{[^}]+}`了，但是使用这个正则表达式，我不能只拥有测试中的内容和再次标记。有没有办法完成这个正则表达式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T00:01:33.043

正确执行此操作通常超出了正则表达式的能力。但是，如果您可以保证这些标签永远不会嵌套，并且您的输入永远不会包含不表示标签的花括号，那么这个正则表达式可以进行匹配：

```
\{([^}]+)}(.*?)\{/\1} 
```

解释：

```
\{        # a literal {
(         # capture the tag name
[^}]+)    # everything until the end of the tag (you already had this)
}         # a literal }
(         # capture the tag's value
.*?)      # any characters, but as few as possible to complete the match
          # note that the ? makes the repetition ungreedy, which is important if
          # you have the same tag twice or more in a string
\{        # a literal {
\1        # use the tag's name again (capture no. 1)
}         # a literal } 
```

因此，这使用反向引用`\1`来确保结束标记包含与开始标记相同的单词。然后您将在 capture 中找到标签的名称，在 capture 中找到`1`标签的值/内容`2`。从这里您可以随心所欲地使用这些（例如，将值重新组合在一起）。

请注意，如果您希望标签跨越多行，则应使用`SINGLELINE`or选项。`DOTALL`

# foursquare - 我的应用程序管理员不工作

> ID：13148864
> 
> 赞同：0
> 
> 时间：2012-10-30T23:03:37.630
> 
> 标签：foursquare

今天和昨天登录 developer.foursquare.com 时，当我点击顶部导航栏中的我的应用程序（链接到[https://foursquare.com/oauth/](https://foursquare.com/oauth/)）然后我得到 404 显示。

这是网站的问题，还是只是我的帐户问题？其他导航链接（概述、端点等）都很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T15:24:42.550

我认为您应该调用的正确 URL 是：

> [https://foursquare.com/oauth](https://foursquare.com/oauth)

# c# - 使用 HtmlAgilityPack 进行抓取

> ID：13148867
> 
> 赞同：1
> 
> 时间：2012-10-30T23:04:04.853
> 
> 标签：c#, html-agility-pack

我有一个巨大的 html 页面，我想从中删除值。

我尝试使用 Firebug 来获取我想要的元素的 XPath，但它不是静态 XPath，因为它会不时更改，所以我怎么能得到我想要的值。

在下面的片段中，我想获得位于 20 中的每小时木材产量

```
 <div class="boxes-contents cf"><table id="production" cellpadding="1" cellspacing="1">
    <thead>
        <tr>
            <th colspan="4">
                Production per hour:            </th>
        </tr>
    </thead>
    <tbody>
                <tr>
            <td class="ico">
                <img class="r1" src="img/x.gif" alt="Lumber" title="Lumber" />
            </td>
            <td class="res">
                Lumber:
            </td>
            <td class="num">
                20          </td>
        </tr>
                <tr>
            <td class="ico">
                <img class="r2" src="img/x.gif" alt="Clay" title="Clay" />
            </td>
            <td class="res">
                Clay:
            </td>
            <td class="num">
                20          </td>
        </tr>
                <tr>
            <td class="ico">
                <img class="r3" src="img/x.gif" alt="Iron" title="Iron" />
            </td>
            <td class="res">
                Iron:
            </td>
            <td class="num">
                20          </td>
        </tr>
                <tr>
            <td class="ico">
                <img class="r4" src="img/x.gif" alt="Crop" title="Crop" />
            </td>
            <td class="res">
                Crop:
            </td>
            <td class="num">
                59          </td>
        </tr>
            </tbody>
</table>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:17:14.093

使用 Html 敏捷包，您将需要执行以下操作。

```
byte[] htmlBytes;
MemoryStream htmlMemStream;
StreamReader htmlStreamReader;
HtmlAgilityPack.HtmlDocument htmlDoc = new HtmlAgilityPack.HtmlDocument();
htmlBytes = webclient.DownloadData(url);
htmlMemStream = new MemoryStream(htmlBytes);
htmlStreamReader = new StreamReader(htmlMemStream);
htmlDoc.LoadHtml(htmlStreamReader.ReadToEnd());

var table = htmlDoc.DocumentNode.Descendants("table").FirstOrDefault();

var lumberTd = table.Descendants("td").Where(node => node.Attributes["class"] != null && node.Attributes["class"].Value == "num").FirstOrDefault();

string lumberValue = lumberTd.InnerText.Trim(); 
```

警告，'FirstOrDefault()' 可以返回 null，所以你应该在那里进行一些检查。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:27:11.343

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.Load(fileName);

var result = doc.DocumentNode.SelectNodes("//div[@class='boxes-contents cf']//tbody/tr")
                .First(tr => tr.Element("td").Element("img").Attributes["title"].Value == "Lumber")
                .Elements("td")
                .First(td=>td.Attributes["class"].Value=="num")
                .InnerText
                .Trim(); 
```

# drupal - Drupal 7 批处理页面示例

> ID：13148872
> 
> 赞同：4
> 
> 时间：2012-10-30T23:04:39.403
> 
> 标签：drupal, batch-file, drupal-7

我正在尝试设置一个批处理页面进行处理，我需要一个示例。示例模块中给出的示例在一个表单中，我需要一个可以独立于处理批处理请求的表单运行的页面。

例如：

```
function mymodule_batch_2() {
 $operations[] = array('mymodule_onefunction','mymodule_anotherfunction') 
 $batch = array(
  'operations' => $operations, 
  'finished' => 'mymodule_finished',
  // We can define custom messages instead of the default ones. 
  'title' => t('Processing batch 2'), 
  'init_message' => t('Batch 2 is starting.'), 
  'progress_message' => t('Processed @current out of @total.'), 
  'error_message' => t('Batch 2 has encountered an error.'),
);
  batch_set($batch);
  batch_process('');
} 
```

批处理函数将以 $operations 的形式调用其他函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:45:37.647

你需要给批处理一个 id 来工作。batch_process('mybatch') 否则 yourmexample 是正确的。你对这个策略有什么特别的问题吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T08:58:23.967

在这里，您可以看到我的批处理 relization 示例，其中包含调用批处理的表单：

```
 function my_module_menu() {
      $items['admin/commerce/import'] = array(
        'title' => t('Import'),
        'page callback' => 'drupal_get_form',
        'page arguments' => array('my_module_settings_form'),
        'access arguments' => array('administer site settings'),
        'type' => MENU_NORMAL_ITEM,
      );
      return $items;
    }

    /**
     * Import form
     */
    function my_module_settings_form() {
      $form = array();
      $form['import'] = array(
        '#type' => 'fieldset',
        '#title' => t('Import'),
        '#collapsible' => TRUE,
        '#collapsed' => FALSE,
      );

      $form['import']['submit'] = array(
        '#type' => 'submit',
        '#value' => t('Import'),
      );
      return $form;
    }

    function my_module_settings_form_submit($form, &$form_state) {
      batch_my_module_import_start();
    }

    /**
     * Batch start function
     */
    function batch_my_module_import_start() {

      $batch = array(
        'title' => t('Import products'),
        'operations' => array(
          array('_batch_my_module_import', array()),
        ),
        'progress_message' => t('Import. Operation @current out of @total.'),
        'error_message' => t('Error!'),
        'finished' => 'my_module_batch_finished',
      );

      batch_set($batch);
    }

    /**
     * Import from 1C operation. Deletes Products
     */
    function _batch_my_module_import(&$context) {
      // Your iterms. In my case select all products
      $pids = db_select('commerce_product', 'p')
          ->fields('p', array('sku', 'product_id', 'title'))
          ->condition('p.type', 'product')
          ->execute()
          ->fetchAll();

      // Get Count of products
      if (empty($context['sandbox']['progress'])) {
        $context['sandbox']['progress'] = 0;
        $context['sandbox']['max'] = count($pids);
        watchdog('import', 'import products');
      }
      // Create Iteration variable
      if (empty($context['sandbox']['iteration'])) {
        $context['sandbox']['iteration'] = 0;
      }
      // Check for the end of cycle
      if ($context['sandbox']['iteration'] < $context['sandbox']['max']) {
        // Count of operation in one batch step
        $limit = 10;
        // Counts completed operations in one batch step
        $counter = 0;
        if ($context['sandbox']['progress'] != 0) {
          $context['sandbox']['iteration'] = $context['sandbox']['iteration'] + $limit;
        }
        // Loop all Product items in xml
        for ($i = $context['sandbox']['iteration']; $i < $context['sandbox']['max'] && $counter < $limit; $i++) {

          /* Loop items here */
          /* ... */
          /* ... */
          $context['results']['added']['products'][] = $product_item->title;

          // Update Progress
          $context['sandbox']['progress']++;
          $counter++;
          // Messages
          $context['message'] = t('Now processing product %name. Product %progress of %count', array('%name' => $product_item->title, '%progress' => $context['sandbox']['progress'], '%count' => $context['sandbox']['max']));
          $context['results']['processed'] = $context['sandbox']['progress'];
        }
      }

      if ($context['sandbox']['progress'] != $context['sandbox']['max']) {
        $context['finished'] = $context['sandbox']['progress'] / $context['sandbox']['max'];
      }
    }

/**
 * Finish of batch. Messagess
 */
function my_module_batch_finished($success, $results, $operations) {
  if ($success) {
    drupal_set_message(t('@count products added.', array('@count' => isset($results['added']) ? count($results['added']) : 0)));
  }
  else {
    $error_operation = reset($operations);
    drupal_set_message(t('An error occurred while processing @operation with arguments : @args', array('@operation' => $error_operation[0], '@args' => print_r($error_operation[0], TRUE))));
  }
  watchdog('import', 'import finished');
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-01-06T12:14:29.710

```
 function module_name_import_form_submit($form, $form_state) {
  // Check to make sure that the file was uploaded to the server properly
  $uri = db_query("SELECT uri FROM {file_managed} WHERE fid = :fid", array(
    ':fid' => $form_state['input']['import']['fid'],
  ))->fetchField();
  if(!empty($uri)) {
    if(file_exists(drupal_realpath($uri))) { 
      // Open the csv
      $handle = fopen(drupal_realpath($uri), "r");
      // Go through each row in the csv and run a function on it. In this case we are parsing by '|' (pipe) characters.
      // If you want commas are any other character, replace the pipe with it.
      while (($data = fgetcsv($handle, 0, '|', '"')) !== FALSE) {
        $operations[] = array(
          'module_name_import_batch_processing',  // The function to run on each row
          array($data),  // The row in the csv
        );
      }

      // Once everything is gathered and ready to be processed... well... process it!
      $batch = array(
        'title' => t('Importing CSV...'),
        'operations' => $operations,  // Runs all of the queued processes from the while loop above.
        'finished' => 'module_name_import_finished', // Function to run when the import is successful
        'error_message' => t('The installation has encountered an error.'),
        'progress_message' => t('Imported @current of @total products.'),
      );
      batch_set($batch);
      fclose($handle);    
    }
  }
  else {
    drupal_set_message(t('There was an error uploading your file. Please contact a System administator.'), 'error');
  }
}

/**
 * This function runs the batch processing and creates nodes with then given information
 * @see
 * module_name_import_form_submit()
 */
function module_name_import_batch_processing($data) {
  // Lets make the variables more readable.
  $title = $data[0];
  $body = $data[1];
  $serial_num = $data[2];
  // Find out if the node already exists by looking up its serial number. Each serial number should be unique. You can use whatever you want.
  $nid = db_query("SELECT DISTINCT n.nid FROM {node} n " . 
    "INNER JOIN {field_data_field_serial_number} s ON s.revision_id = n.vid AND s.entity_id = n.nid " .
    "WHERE field_serial_number_value = :serial", array(
      ':serial' => $serial_num,
    ))->fetchField();
  if(!empty($nid)) {
    // The node exists! Load it.
    $node = node_load($nid);

    // Change the values. No need to update the serial number though.
    $node->title = $title;
    $node->body['und'][0]['value'] = $body;
    $node->body['und'][0]['safe_value'] = check_plain($body);
    node_save($node);
  }
  else {
    // The node does not exist! Create it.
    global $user;
    $node = new StdClass();
    $node->type = 'page'; // Choose your type
    $node->status = 1; // Sets to published automatically, 0 will be unpublished
    $node->title = $title;
    $node->uid = $user->uid;        
    $node->body['und'][0]['value'] = $body;
    $node->body['und'][0]['safe_value'] = check_plain($body);
    $node->language = 'und';

    $node->field_serial_number['und'][0]['value'] = $serial_num;
    $node->field_serial_number['und'][0]['safe_value'] = check_plain($serial_num);
    node_save($node);
  }
}

/**
 * This function runs when the batch processing is complete
 *
 * @see
 * module_name_import_form_submit()
 */
function module_name_import_finished() {
    drupal_set_message(t('Import Completed Successfully'));
} 
```

# sql - OLEDB 12.0 是否支持 FULL OUTER JOIN？

> ID：13148873
> 
> 赞同：0
> 
> 时间：2012-10-30T23:04:43.557
> 
> 标签：sql, oledb

错误：

```
Error: IErrorInfo.GetDescription failed with E_FAIL(0x80004005).
Syntax error in FROM clause. 
```

询问：

```
Select * from [tbl Proctors$] p 
FULL OUTER JOIN [tbl Proctor History$] h 
ON p.Unique = h.Unique 
```

有趣的部分是查询适用于`LEFT JOIN`or`RIGHT JOIN`但不适用于`FULL OUTER JOIN`.

有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T01:28:44.857

`OUTER`不带关键字试试：

```
Select * from [tbl Proctors$] p 
FULL JOIN [tbl Proctor History$] h 
ON p.Unique = h.Unique 
```

只是一个猜测。如果这没有帮助，请修改您的问题并确定您使用 OLEDB 连接的数据库。这可能是数据提供者配置上的设置。

# node.js - MongoDB count() 未定义

> ID：13148875
> 
> 赞同：19
> 
> 时间：2012-10-30T23:04:51.717
> 
> 标签：node.js, mongodb, express

我是 Javascript-NodeJS-MongoDB 的新手，我尝试了解查询找到的文档数量。

```
...
var page = req.params.page;  

var db = require('mongojs').connect('localhost:27017/foo', ['bar']); 

var docs = db.bar.find({x:'MME'}).sort({y:1}).skip(10*(page-1)).limit(10); 

var nbDocs = db.bar.find({x:'MME'}).count(); /*docs.count();*/

console.log(nbDocs); 
```

但不幸的是，日志给了我“未定义”，如果我编码也是一样

```
var nbDocs = docs.count(); 
```

非常感谢您的宝贵帮助。

吉尔斯。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-30T23:16:00.500

根据[文档](http://mongodb.github.com/node-mongodb-native/api-generated/cursor.html#count)，结果将在`cursor.count()`方法回调的第二个参数中。对于刚接触 javascript 的人来说，这可能更具挑战性，但我认为这样的事情应该可行：

```
docs.count(function(error, nbDocs) {
    // Do what you need the count for here.
}); 
```

# drupal - Drupal：用户帐户受限但接收工作流更新？

> ID：13148880
> 
> 赞同：0
> 
> 时间：2012-10-30T23:05:35.550
> 
> 标签：drupal

Drupal 界面中是否有一种方法可以将特定用户排除在工作流状态之外，而不必删除他的帐户并创建一个新帐户？

查看他的帐户，他没有任何角色可以接收状态，但他有。

或者，我宁愿能够以某种方式在整个系统中搜索他的实际电子邮件，并确保他没有在任何地方列出。这在 Drupal 中是否可行？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T21:38:18.380

我不得不删除他的额外帐户。他有一个较旧的帐户作为管理员深埋在用户中。

# .net - 将图表上的数据导出到 Excel/CSV LogiXML

> ID：13148883
> 
> 赞同：0
> 
> 时间：2012-10-30T23:05:57.273
> 
> 标签：.net, xml

我有一个非常简单的问题。我一直在尝试从当前在图表上使用的数据层导出一组数据（2 列）。我想要完成的是，获取包含在该图表中的数据并将其作为数据呈现在 excel 或 csv 电子表格中（而不是实际图表）。我想知道在不创建单独的数据表并将导出链接到该表的情况下这是否可行。我已经尝试了多个 Action.Export 来完成此操作，但我不确定是否可以完成。

我很感激我可能得到的任何帮助。谢谢！

更新：这是我对您的报告大卫所做的修改，以重新创建我的问题：

```
 <Body>
<Dashboard2 SaveFile="@Function.AppPhysicalPath~\SavedDashboards\Dashboard.xml" DashboardAdjustable="True" AllowFreeformLayout="False" DashboardTabs="True">
  <Panel ID="pnl1" Caption="pnl1" MultipleInstances="True">
    <PanelContent>
      <Division ShowModes="rdExportCsv" ID="divTable" IdeDisplayStatus="Collapsed">
        <DataTable ID="table">
          <DataLayer Type="Static" ID="dlStatic1">
            <StaticDataRow columnA="Test 1" columnB="100" />
            <StaticDataRow columnA="Test 3" columnB="110" />
            <StaticDataRow columnA="Test 2" columnB="105" />
            <DataLayerLink ID="linkData" />
          </DataLayer>
          <AutoColumns />
        </DataTable>
      </Division>
      <Division ID="divChart" ShowModes="rdBrowser" IdeDisplayStatus="Collapsed">
        <Chart Type="XY" ChartDataColumn="columnB" XYChartType="Bar" ChartHeight="260" ChartWidth="400" ChartLabelColumn="columnA">
          <DataLayer Type="Linked" LinkedDataLayerID="linkData" />
        </Chart>
      </Division>
      <Button ID="ExportCSV" Caption="Export CSV" IdeDisplayStatus="Collapsed">
        <Action Type="CSV">
          <Target Type="CSV" ExportDataTableID="table" />
        </Action>
      </Button>
    </PanelContent>
  </Panel>
</Dashboard2> 
```

单击导出按钮后，它导出为 CSV 文件，但出现了我在下面的评论中提到的错误。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T12:47:39.377

是的，您需要创建一个单独的数据表以将列导出为 Excel 或 CSV。原因是，Logi 引擎使用列属性来正确指示导出行为（例如宽度、数据类型、数据格式等）。但是，您构建的表格不需要显示在您的交互式报告版本中。您可以使用“ShowModes”在 Web 输出期间显示图表，并将表格用于导出的内容。此外，您可以使用“链接”数据层来填充表格和图表，这样您的查询或其他数据源调用只需执行 1 次。

这是一个简单的例子，使用了两个概念——LinkedData Layers 和 ShowModes

```
<Body>
  <Division ShowModes="rdExportCsv" ID="divTable">
    <DataTable ID="table">
      <DataLayer Type="Static" ID="dlStatic1">
        <StaticDataRow columnA="Test 1" columnB="100" />
        <StaticDataRow columnA="Test 3" columnB="110" />
        <StaticDataRow columnA="Test 2" columnB="105" />
        <DataLayerLink ID="linkData" />
      </DataLayer>
      <AutoColumns />
    </DataTable>
  </Division>
  <Division ID="divChart" ShowModes="rdBrowser">
    <Chart Type="XY" ChartDataColumn="columnB" XYChartType="Bar" ChartHeight="260" ChartWidth="400" ChartLabelColumn="columnA">
      <DataLayer Type="Linked" LinkedDataLayerID="linkData" />
    </Chart>
  </Division>
  <Button ID="ExportCSV" Caption="Export CSV">
    <Action Type="CSV">
      <Target Type="CSV" ExportDataTableID="table" />
    </Action>
  </Button>
</Body> 
```

# android - 无法在 XML 中加载自定义属性

> ID：13148884
> 
> 赞同：1
> 
> 时间：2012-10-30T23:05:58.427
> 
> 标签：android

我尝试按照[本指南](http://kevindion.com/2011/01/custom-xml-attributes-for-android-widgets/)和[这篇](https://stackoverflow.com/questions/2029719/how-can-i-create-my-custom-properties-on-xml-for-android)关于如何为自定义视图的布局 XML 制作自定义属性的帖子，但是无论我做什么，我都会返回一个零自定义属性列表，而且我在计算时遇到了很多麻烦出如何调试这个。

我制作了一个文件 res/values/attrs.xml，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <declare-styleable name="TexturedListView">
        <attr name="backgroundTexture" format="reference"/>
    </declare-styleable>
</resources> 
```

然后我在布局 XML 文件中创建了一个自定义视图，如下所示：

```
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:custom="https://schemas.android.com/apk/res/xxx.rtin.texturedlistview"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
    <xxx.rtin.texturedlistview.TexturedListView
        android:id="@+id/texturedListView"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:dividerHeight="10dp"
        android:padding="20dp"
        custom:backgroundTexture="@drawable/background" >
    </xxx.rtin.texturedlistview.TexturedListView>

</RelativeLayout> 
```

然后从我的 TexturedListView 类的构造函数中，我调用以下内容来尝试读取此自定义属性：

```
public TexturedListView(Context context, AttributeSet attrs) {
    super(context, attrs);
    TypedArray a = context.obtainStyledAttributes(R.styleable.TexturedListView);

    final int N = a.getIndexCount();
    //..snip...
} 
```

然而，毫无疑问，N 是 0。 R.styleable.TexturedListView 似乎有正确的 ID，我尝试清理和重建我的项目，但无济于事。我觉得我必须错过一些微妙的东西，但我无法弄清楚。

我究竟做错了什么？如何阅读这些自定义属性？

# git - Git-flow、gerrit 和变基到更新的上游版本

> ID：13148885
> 
> 赞同：1
> 
> 时间：2012-10-30T23:06:16.977
> 
> 标签：git, rebase, gerrit, git-pull, git-flow

考虑一个由 gerrit 管理的本地存储库，它定期从基于 github 的项目同步（具有适当的跟踪分支/标签。开发是在代码的版本 1（标签 = 1.0）上初始化的。正在对该代码进行开发并通过 gerrit 定期合并到内部开发分支，也可能合并到内部发布/主分支。

不过，最终还是希望我们迁移到外部 v2.0，或者我们从发布线中提取所有更改（在它与开发不同之后）。

鉴于这是通过 gerrit 管理的代码，您是否会直接重新设置开发分支以将内部/外部“上游”更改引入您的开发线，或者您是否会从开发分支，重新*设置**开发人员分支*到 v2.0，然后推送*开发人员*以通常的方式通过gerrit分支？

我问是因为前者在这个框架内似乎是带外的......从我读过的关于这个主题的内容（例如[这里](https://stackoverflow.com/questions/8405966/git-workflow-and-gerrit)）来看，在 gerrit 中可能无法实现这样的就地变基，如果我们会定期将所有内容推送给其他团队（最终可能会发生）。后者（pull-via-developer-branch）似乎更健壮，并且不需要开发人员具有绕过 gerrit 或正常开发过程的特殊权限。

你的意见？

# xna - XNA 跳跃后穿过瓷砖

> ID：13148886
> 
> 赞同：0
> 
> 时间：2012-10-30T23:06:20.573
> 
> 标签：xna, tile

*自从我发布这个问题以来，我发现了很多新信息，所以我完全重写了它：*

我在基于瓷砖的游戏中实现重力和跳跃时遇到了一些问题。有时，当我的角色在跳跃后落在瓷砖之间时，角色会从它们中间掉下来。

问题当然不在于我的速度太高，因为我的最大速度与我的图块大小相同。此外，每次角色跳跃后都不会出现问题。我经常可以跳跃，达到最大速度，并且仍然可以很好地着陆。但有时角色只是失败了。

我的关卡存在层层瓦片。每一层都有它自己的碰撞类型。因此，同一层中的每个图块都遵循相同的碰撞规则。在我当前的设置中，所有图层都使用逐像素碰撞。

这就是我更新播放器坐标的方式 [http://pastebin.com/qVc6gv6T](http://pastebin.com/qVc6gv6T)

这是我计算碰撞的课程。 [http://pastebin.com/7GqrFih6](http://pastebin.com/7GqrFih6)

在更新中我只是这样做：

```
 controls.Update(player); 
    physicsEngine.HandleCollissions(levelManager, player); 
```

我想问题可能是因为玩家在碰撞后被移动到另一个瓷砖。与其他瓷砖碰撞。但这不算数，因为已经检查了另一个瓷砖是否有碰撞？或者可能是因为我使用 foreach 而不是 for 循环？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T03:53:12.250

你说跳转后出现错误。所以，你的角色落向一块瓷砖（有一些积极的`velocity.Y`）并击中它。碰撞代码执行该`// the player comes FROM ABOVE and collides with the tile`块。您运行一个循环，将玩家速度设置为零并将玩家移出碰撞。此循环使用术语`tile`作为参数调用函数。我假设您循环遍历一组图块，以便与多个正方形发生碰撞。我对吗？

如果我是，那么问题发生在第一次碰撞和更正之后。现在您的玩家的 a`velocity.Y`为 0，但他们正在与新的瓷砖碰撞。因此，尽管您对 else 块的含义发表了评论，但您可能会发生更多的位置变化：

```
if (player.Velocity.Y > 0) 
else // if (moveVector.Y < 0) // what you commented

else // if (moveVector.Y <= 0) // what your else really means 
```

现在有时（仅当您的每像素碰撞稍微错位时）您会在错误的方向上进行航向校正。这将产生一个跌倒效应。您可以尝试在块中设置断点`// the player comes FROM UNDER and collides with the tile`，然后在不应导致`player.WorldPositionY += 1;`发生的情况下运行程序。如果它在不应该发生的时候发生，那么你就是罪魁祸首。

我在这里做了很多猜测。我认为您应该发布*更多*代码，以便我们确定。但也许粘贴箱是合适的地方。

# c++ - 另一个 C++ cin 循环问题

> ID：13148887
> 
> 赞同：5
> 
> 时间：2012-10-30T23:06:27.507
> 
> 标签：c++

**更新**

我找到了问题的原因。我一直在用鱼壳做[实验](http://ridiculousfish.com/shell/)。我看到评论说有人在 Mac 上成功运行了我的代码，并决定在标准的 bash shell 中尝试一下。它工作得很好。所以，我猜没有更多的鱼壳了。:)

我仍然希望知道 cin 如何以及为什么会以它的方式工作。这是我问题的主要部分。

* * *

我遇到了一个流行的问题：`cin`循环使用。代码很简单，但我找不到解决方案。Google 为我提供的答案多种多样，但通常涉及`cin.clear()`、`cin.ignore()`和的某种组合`cin.get()`。不幸的是，我无法找到解决我问题的组合或排序。此外，令我沮丧的是，我对`cin`. 我宁愿不使用反复试验来解决这个问题。我想确切地了解发生了什么。

**应该发生什么**

当我运行我的代码时，我应该会看到一个带有选项列表的提示。我应该能够输入一个将运行其中一个选项的字符。然后，它应该再次显示提示并重复该过程，直到我选择*退出*选项。

**实际发生了什么**

一旦我运行代码，它就会将提示打印到屏幕上任意次数，并最终在提示中途停止。然后我什么也做不了，只能用`^C`.

```
$ ./run

Choose an option:
[A]dd a score
[R]emove a player
[E]xit

    : That is not a valid input.

[repeated a bunch of times]

Choose an option:
[A]dd a score
[R]emove a player
[E]xit

    : That is not a valid input.

Choose ^C
$ 
```

**我的问题**

是什么导致 cin 这样做？作为一名经验丰富的 Java 开发人员（但也是一名初学者 C++ 开发人员），我熟悉缓冲区和流等概念，但我不知道如何`cin`工作。我知道这会`cin.clear()`清除错误状态，并`cin.ignore()`忽略流中的许多字符。到目前为止，我的 Google-fu 一直找不到简明的参考资料。

*为什么要这样做`cin`？`cin`在循环中使用时，应该如何想象引擎盖下会发生什么？在 C++ 中实现这个无限菜单想法的最优雅的方法是什么？*

**我的代码**

这是我的代码的简化版本，它产生与完整版本完全相同的问题：

```
#include <iostream>

using namespace std;

int main () {

    //infinite menu 
    char input;
    while(true) {

        //prompt
        cout << "\n\nChoose an option:\n";
        cout << "[A]dd a score\n";
        cout << "[R]emove a player\n";
        cout << "[E]xit\n";
        cout << "\n\t: ";

        //input
        cin >> input;

        //decide what the input means
        switch(input) {
            case 'a':
            case 'A':
                cout << "Add a score.\n";
                break;
            case 'r':
            case 'R':
                cout << "Remove a player.\n";
                break;
            case 'e':
            case 'E':
                cout << "Program Complete.\n";
                return 0;
                break;
            default:
                cout << "That is not a valid input.\n";
        }
    }
    return 0;
} 
```

我编译并运行：

```
$ g++ Test.cpp -o run
$ ./run 
```

我`gcc version 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)`在 Mac OS X 10.8.2 上运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T23:34:24.030

帮自己一个忙，不要直接从`std::cin`. 相反，逐行阅读`getline`，*然后*解释每一行。此外，您必须始终在布尔上下文中评估输入操作的结果，否则您将无法正确处理任意输入。

对于测试，如果您调用`echo "abc" | ./run`. 这应该始终是您的第一个测试之一。

现在，进入代码：

```
#include <string>
#include <iostream>

int main()
{
    for (std::string line; std::getline(std::cin, line); )
    {
        if (line.empty()) { continue; }

        if (line == "A" || line == "a") { /* ... */ continue; }

        if (line == "R" || line == "r") { /* ... */ continue; }

        if (line == "E" || line == "e") { break; }

        std::cout << "Sorry, I did not understand.\n";
    }

    std::cout << "Goodbye!\n";
} 
```

# ruby - 如何在 Ruby 中将当前时间作为 13 位整数获取？

> ID：13148888
> 
> 赞同：106
> 
> 时间：2012-10-30T23:06:31.333
> 
> 标签：ruby

我有这个`jQuery`函数，它返回当前时间作为自纪元（1970 年 1 月 1 日）以来的毫秒数：

```
time = new Date().getTime(); 
```

有没有办法在 Ruby 中做同样的事情？

现在，我正在使用 Ruby `Time.now.to_i`，它效果很好，但返回一个**10 位**整数（秒数）

我怎样才能让它显示毫秒数，如`jQuery`？

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2013-11-15T14:51:05.383

```
require 'date'

p DateTime.now.strftime('%s') # "1384526946" (seconds)
p DateTime.now.strftime('%Q') # "1384526946523" (milliseconds) 
```

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2012-10-30T23:16:29.143

Javascript`gettime()`返回自纪元以来的毫秒数。

Ruby`Time.now.to_i`会给你自纪元以来的秒数。如果将其更改为`Time.now.to_f`，您仍然可以获得秒数，但带有小数部分。只需将其乘以 1,000，您就有了毫秒数。然后使用`#to_i`将其转换为整数。你最终得到：

```
(Time.now.to_f * 1000).to_i 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2012-10-30T23:12:26.360

`(Time.now.to_f * 1000).to_i`应该做同样的事情。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2015-06-02T19:28:43.117

使用[`strftime`](http://ruby-doc.org/core-2.1.5/Time.html#method-i-strftime)，您可以获得秒数并附加小数毫秒（或更小的单位，如果需要）：

```
2.2.2 :001 > t = Time.new
 => 2015-06-02 12:16:56 -0700 
2.2.2 :002 > t.strftime('%s%3N')
 => "1433272616888" 
```

请注意，虽然这不会四舍五入，但它会截断，正如您所看到的，`to_f`或者如果您达到微秒级：

```
2.2.2 :003 > t.to_f
 => 1433272616.888615
2.2.2 :004 > t.usec
 => 888615 
```

和`to_f`/`to_i`解决方案有同样的问题（`to_i`不圆，它[截断](https://ruby-doc.org/core-3.0.0/Float.html#method-i-to_i)）：

```
2.2.2 :009 > (t.to_f * 1000).to_i
 => 1433272616888 
```

因此，如果您真的关心毫秒精度，更好的选择可能`to_f`是[`round`](https://ruby-doc.org/core-3.0.0/Float.html#method-i-round)：

```
2.2.2 :010 > (t.to_f * 1000).round
 => 1433272616889 
```

也就是说，正如[文档中所述](http://ruby-doc.org/core-2.1.5/Time.html#method-i-to_f)，“IEEE 754 双精度不足以表示自纪元以来的纳秒数”，因此，如果您真的*很*在意，请考虑[`to_r`](http://ruby-doc.org/core-2.1.5/Time.html#method-i-to_r)而不是`to_f`-

```
2.2.2 :011 > (t.to_r * 1000).round
 => 1433272616889 
```

- 虽然如果你只是四舍五入到毫秒，你可能没问题。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2015-04-10T22:06:38.563

小心，不要混淆。事实上，Ruby 支持将小数秒作为浮点数的概念，实际上并没有使它成为浮点数。当我在 Python 中进行 Wireshark 时间戳时间比较时，我遇到了麻烦…… pcap-ng 中的时间计算不起作用。只有当我将这两个部分（整数秒和整数纳秒）视为两个整数时，我才能得到正确的数字。

那是因为浮点数存在[精度问题](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems)。事实上，快速了解一下 Ruby 就会告诉你 to_f 不等于 nsec：

```
irb(main):019:0> t=Time.now
=> 2015-04-10 16:41:35 -0500
irb(main):020:0> puts "#{t.to_f}; #{t.nsec}"
1428702095.1435847; 143584844 
```

警告程序员。3 位有效数字可能是安全的，但事实仍然存在：计算机上的浮点数是近似值。现代计算机上的纳秒计数器是整数。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2013-11-15T13:16:38.083

获取一个[Time](http://www.ruby-doc.org/core-2.0.0/Time.html)对象`Time.now`，调用`#to_i`返回一个 Unix 时间戳（从纪元开始的秒数）。 `#to_f`给出小数秒，您可以使用它从纪元中获取毫秒数：

```
Time.now.to_f * 1000 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-03T00:25:27.230

类型转换 Integer(1e6*Time.now.to_f) 返回一个可以保存毫秒的 Bignum

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-11T14:03:47.897

使用`Process.clock_gettime`：

```
>> Process.clock_gettime(Process::CLOCK_REALTIME, :millisecond)
=> 1644588106765 
```

见[https://ruby-doc.org/core-3.1.0/Process.html#method-c-clock_gettime](https://ruby-doc.org/core-3.1.0/Process.html#method-c-clock_gettime)

# vector - MediaWiki：Vector Collapsible Sidebar，一级标题问题

> ID：13148897
> 
> 赞同：3
> 
> 时间：2012-10-30T23:07:06.243
> 
> 标签：vector, header, mediawiki, sidebar

Vector 的大部分可折叠侧边栏都可以正常工作。我的问题是通常用于导航的一级标题没有正确显示。格式按照我第一次在侧边栏中使用时的预期工作，标题作为没有折叠的链接。

```
* CoreTechs
** Main Page|CoreTechs 
```

第二次使用它时，我使用完全相同的格式，而是显示为一个可折叠的标题“Developlement”，带有一个标题“Home”。

```
* Development
** Dev:Home|Home 
```

我想这是在某个地方硬编码的，或者我根本不明白我在做什么。我试过在这个主题上翻阅 MediaWiki 页面，但无济于事。

```
http://www.mediawiki.org/wiki/Manual:Interface/Sidebar 
```

同样，Vector 扩展页面也不是很有帮助。

```
http://www.mediawiki.org/wiki/Extension:Vector 
```

我的 PHP 和 CSS 技能目前为零，因此指出正确的方向会很有帮助。看起来这可能是一个足够简单的修复，但它暗示了我。

如果有帮助，这是我的维基：

[http://coretechsgame.com/mediawiki-1.19.2/index.php?title=MediaWiki:Sidebar](http://coretechsgame.com/mediawiki-1.19.2/index.php?title=MediaWiki:Sidebar)

任何帮助表示赞赏。谢谢你。西杰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T10:06:51.597

the first level by default always showing like that, i don't know how to hack mediawiki to change that default, but you can tricky by adding * with empty word

like this

```
*
* CoreTechs
** Main Page|CoreTechs

* Collectibles
** Collectibles|Main 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-30T13:09:12.077

这是一个猜测。

由于 CamelCase，MediaWiki 将 CoreTech 识别为链接。它不将 Development 识别为链接，因为它不在显式 CamelCase 中。

也许如果您明确表示 Development 是一个链接，它将起作用，如下所示：

```
* Development|Development
** Dev:Home|Home 
```

由于他们从 Vector 中删除了可折叠，我没有方便的 wiki 来测试它，但这是一个你可以尝试的理论。

# php - 如果键有值

> ID：13148898
> 
> 赞同：0
> 
> 时间：2012-10-30T23:07:07.903
> 
> 标签：php, arrays

我有一个数组 $data，打印时看起来像这样：

```
[1] => Array 
    [type] => link
[2] => Array
    [type] => photo
[3] => Array
    [type] => video 
```

我有一个 $data 的 foreach 语句，所以每个 $data 都有一个 [type] 键。我需要能够检查 [type] 键的值是否为“link”，否则为“photo”，否则为“video”。

任何帮助都会很棒。我尝试了array_key_exists，但这只是为了检查数据字符串中是否存在密钥。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T23:09:51.890

```
foreach ($data as $datum) {
   switch ($datum['type']) {
      case 'link':
         //fill in
         break;
      case 'photo':
         //fill in
         break;
      case 'video':
         //fill in
         break;
      default:
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:10:32.390

```
foreach ($data as $v) {

    switch ($v['type']) {
    case 'link':
        echo "it's a link";
        break;
    case 'photo':
        echo "it's a photo";
        break;
    case 'video:
        echo "it's a video";
        break;
    }

} 
```

# java - IDEA、Hamcrest 和静态导入

> ID：13148901
> 
> 赞同：12
> 
> 时间：2012-10-30T23:07:11.130
> 
> 标签：java, intellij-idea, hamcrest

我的 Maven 项目包括

```
186         <dependency>
187             <groupId>org.hamcrest</groupId>
188             <artifactId>hamcrest-all</artifactId>
189             <version>1.3</version>
190         </dependency> 
```

当我输入`assertThat`..

我想让 IDEA 弄清楚需要以下内容

```
import static org.hamcrest.MatcherAssert.assertThat; 
```

相反，我得到了这个。

![在此处输入图像描述](../Images/03bb53528d702ffd5c717d7ab093e801.png)

这怎么能纠正？如何让 IDEA 执行静态导入？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-30T23:08:58.647

打开括号，您将收到静态导入方法的提示。在添加括号之前，IntelliJ 不会理解这是您尝试引用的方法。

换句话说，键入`assertThat(`然后`ALT`- `ENTER`。

# javascript - 如何使用 Grunt 在 Javascript 中包含静态代码？

> ID：13148902
> 
> 赞同：0
> 
> 时间：2012-10-30T23:07:20.253
> 
> 标签：javascript, node.js, include, requirejs, gruntjs

我正在使用 grunt 编写一个脚本，该脚本分为两部分：`main.js`加载一个内联工作程序，`worker.js`是内联工作程序的实际代码。

这意味着我有以下代码来加载工人，里面`main.js`：

```
function setupWorker (workerCode) {
    var blobBuilder = new BlobBuilder();
    blobBuilder.append(workerCode);
    var blob = blobBuilder.getBlob('text/javascript');
    var url = URL.createObjectURL(blob);
    return(url);
}

var workerURL = setupWorker('worker code, contents of worker.js');
var worker = new Worker(workerURL); 
```

现在的问题是，使用 Grunt，我如何`'worker code, contents of worker.js'`在示例中替换为 的实际内容`worker.js`？

我在包含静态代码的情况下做得对吗？我应该为 require.js 使用其中一个模块吗？

# mouseover - 根据用户之前在该图像上执行鼠标悬停的次数更改鼠标悬停时的图像

> ID：13148907
> 
> 赞同：-1
> 
> 时间：2012-10-30T23:08:36.337
> 
> 标签：mouseover

我有一个图像，我想在鼠标悬停时更改它，但每次用户将鼠标悬停到 4 时都会更改为不同的图像。

例如：原图是img_black.jpg。

1st mouseouver：图像变为 img_blue.jpg。在 mouseout 上，它会将其更改回 img_black。

2nd mouseouver：图像变为 img_red.jpg。在 mouseout 上，它会将其更改回 img_black。

3rd mouseouver：图像变为 img_yellow.jpg。在 mouseout 上，它会将其更改回 img_black。

第 4 次 mouseouver：图像变为 img_green.jpg。在 mouseout 上，它会将其更改回 img_black。

5th mouseouver：图像变为 img_blue.jpg。在 mouseout 上，它会将其更改回 img_black。（循环重新开始）

如果可以轻松使用计数器中的数字，我可以将名称更改为 img_1、img_2 等，并在 > 4 时重置为 1。除了这个概念，不知道从哪里开始......

任何帮助是极大的赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:30:32.917

除了将它全部构建到一个组件中之外，基本上就是这样。如果是我，我会查看图像的数组/列表和状态所以状态 0 将不是 overImage（在您的示例中为黑色）如果没有其他图像，它会像这样离开。如果有，则 State 将循环遍历 1 - Images.Count - 1 并成为列表中的索引。在不了解语言环境的情况下，很难说更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:31:57.920

我猜你在谈论 HTML，对吧？在这种情况下，看看 jQuery。你需要它来做到这一点。 [http://jquery.com/](http://jquery.com/)

# c# - 结果必须包含所有 queryTerms 的过滤器/搜索查询

> ID：13148912
> 
> 赞同：0
> 
> 时间：2012-10-30T23:08:53.350
> 
> 标签：c#

谁能建议如何改进？

```
public IEnumerable<Person> FindPersons(string queryTerms)
        {
            if (queryTerms == null)
                return new List<Person>();

            var queryTermsList = queryTerms.Split(' ').ToList();

            var first = queryTermsList.First();

            queryTermsList.Remove(first);

            var people = FindPerson(first);

            foreach (var queryTerm in queryTermsList)
            {
                people = people.Intersect(FindPerson(queryTerm));
            }

            return people;
        } 
```

基本上，它所做的是搜索包含 queryTermList 中每个 queryTerm 的人。

因为结果必须包含我使用相交的所有术语。

因为我使用的是 intersect，所以我必须对 foreach 循环外的第一个查询词进行初始搜索，这样循环内的 intersect 就会有一些相交的东西。否则你显然总是得到空的结果。

这意味着我需要在进入 foreach 循环之前从列表中删除第一个查询词。

好的，所以这行得通。似乎必须有一种更优雅的方式来写这个。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:10:56.070

您可以从整个集合开始，并将所有术语与之相交：

```
var people = AllPeople;

foreach (var queryTerm in queryTermsList)
{
    people = people.Intersect(FindPerson(queryTerm));
} 
```

# php - 如何在 PHP 的会话中存储对象？

> ID：13148917
> 
> 赞同：8
> 
> 时间：2012-10-30T23:09:05.480
> 
> 标签：php, pdo, persistence, pdostatement

您好我想在会话中存储或保存一个对象，使用像 SessionHandler 或数组 $_SESSION 这样的类，我已经看到如果我序列化对象是可能的，我不想丢失该对象的方法实例..我已经看到序列化它是可能的，但我想要存储的对象是由 PDOStatement::fetchObject() 创建的，尽管实例类是“用户”我得到这个错误：

> PDOException: 你不能序列化或反序列化 PDO 实例 为什么？它不是 PDO 实例..

对不起，我是西班牙人，我的英语不太好..谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-30T23:30:05.400

PHP 的本`$_SESSION`机会话透明地序列化和反序列化支持 PHP[序列化协议](http://php.net/manual/en/oop4.magic-functions.php)或[`Serializable`接口](http://www.php.net/manual/en/class.serializable.php)的对象。您不需要显式序列化它们。

PHP 无法序列化[`resources`](http://php.net/manual/en/language.types.resource.php)，因为这些是 PHP 无法控制的一些有状态资源的句柄。这就是您不能序列化`PDO`或`PDOStatement`对象的原因。

默认情况下，通过保存所有属性名称和值来序列化对象，并通过创建具有相同类的对象（不调用构造函数）并直接设置序列化属性来取消序列化。您可以使用`__sleep`和`__wakeup`魔术方法或通过实现`Serializable`接口来自定义对象的序列化行为。但不是两者都有！如果您使用`implements Serializable`,`__sleep`并被`__wakeup`忽略。

*一个重要的注意事项：*使用对象序列化时，您*必须*在反序列化之前加载类定义（或具有可以加载它的自动加载器），并且它*必须*与被序列化的对象的类定义相匹配。类定义不存储在序列化数据中。

例如，假设您有以下内容：

```
class Test {
    public $version = 1;
    protected $abc;
    public function setAbc($abc) {
        $this->abc = $abc;
    }
}

$t = new Test();
$t->setAbc(123);
$_SESSION['mytest'] = $t; 
```

现在想象一下，`Test`有一天你会变成这样：

```
class Test {
    public $version = 2;
    private $def;
    public function setDef ($def) {
        $this->def = $def;
    }
} 
```

现在假设您在新代码中加载了一个`Test`在版本 1 时序列化的对象：

```
$t = $_SESSION['mytest']; // this was stored yesterday, when Test was version 1

var_dump($t) 
```

你会得到这个：

```
object(Test)#1 (3) {
  ["version"]=>
  int(1)
  ["def":"Test":private]=>
  NULL
  ["abc":protected]=>
  int(123)
} 
```

此外，您不能使用旧方法：

```
if ($t->version == 1) { // Check for class version
    $t->setAbc(345); // "Fatal error: Call to undefined method Test::setAbc()"
} 
```

# javascript - javascript，限制文本字段中的字符数

> ID：13148920
> 
> 赞同：2
> 
> 时间：2012-10-30T23:10:13.190
> 
> 标签：javascript, validation

我有一个表格，它只允许在文本框中输入数字，或者出现警告：

```
<form name="formName" action="" method="post" OnSubmit="return chkSubmit();"> 
    Input Number 
    <input type="text" name="txtNumber" value="">
    <input type="submit" name="btnSubmit" value="Submit">
</form> 
```

使用以下 javascript：

```
<script>
function chkSubmit()
{
     if(isNaN(document.formName.txtNumber.value))
     {
        alert('Please input numbers only.');
        return false;
     }
}</script> 
```

如何只允许输入 4 个字符？没有警报，只是阻止用户输入超过 4 个字符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T23:11:52.343

`input`元素支持[`maxlength`属性](http://www.w3.org/TR/html5/common-input-element-attributes.html#attr-input-maxlength)，例如：

```
<input type="text" name="txtNumber" value="" maxlength="4"> 
```

...然后由用户代理（浏览器）强制执行。`chkSubmit`如果你想要一个带大括号的方法，你也可以通过检查属性的长度来强制执行它`value`，但它一直存在，我怀疑你会找到一个不处理它的用户代理。

RobG 的观点（在对该问题的评论中）也得到了很好的接受：在提交表单之前限制用户往往会激怒他们。它可能适合也可能不适合您的用例，但至少考虑不限制它们（但可能使用`keypress`事件提供一些视觉反馈），并且仅在提交时验证长度，就像 Stack Overflow 对评论所做的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:15:54.730

使用**最大长度**

```
<form name="formName" action="" method="post" OnSubmit="return chkSubmit();"> 
    <input type="text" name="txtNumber" maxlength="4" value="" />
    <input type="submit" name="btnSubmit" value="Submit" />
</form> 
```

# jquery - 我无法让 jQuery UI 菜单小部件多次接受选择

> ID：13148921
> 
> 赞同：1
> 
> 时间：2012-10-30T23:10:26.947
> 
> 标签：jquery, jquery-ui, user-interface

在选择一次之后，我无法通过鼠标单击为 jQuery UI 1.9 menu() 生成焦点事件。当我第一次单击菜单中的任何元素时，它会调用这个选择处理程序：

```
function selcatfunc(event,ui) {
  var td  = event.currentTarget;
  var cid = $(td).attr('data-cid');
  var nam = $(td).find("a").text();
  if (cid) {
    $("#cat-target").text(nam).attr('data-cid', cid);
    $( "#CatMenu" ).hide(); $( "#CatListOverlay" ).hide();
  } else {
    $( "#CatMenuList" ).focus(event, ui);
  }
};
$(function() {
$( "#CatMenuList" ).menu({ select: selcatfunc });
}); 
```

菜单中的每个`<li`> 都定义了一个 data-cid，以便我知道所选元素的内部代码。人类可读的文本位于：

```
<div id="CatMenu" class="CatList">
<ul id="CatMenuList">
<li data-cid="30.0"><a href="javascript:void(0);">Bars, Nightclubs, Sports Bars</a></li>
<li data-cid="200.14"><a href="javascript:void(0);">Used Car</a></li>
...
</ul>
</div> 
```

没有 data-cid的`<li`> 是一个扩展为子菜单的类别标题。

```
<li><a href="javascript:void(0);">Accessories</b></a>
  <ul>
<li data-cid="10.02"><a href="javascript:void(0);">Men's Accessories</a></li>
<li data-cid="10.04"><a href="javascript:void(0);">Teen Accessories</a></li>
<li data-cid="10.06"><a href="javascript:void(0);">Women's Accessories</a></li>
  </ul></li> 
```

不应该选择诸如附件之类的类别标题，这就是在选择处理程序中调用 .focus() 的原因。cat_target 是一个向用户显示选择的内容。

菜单在我第一次使用时运行良好。但是，如果我在子菜单上隐藏（）它或聚焦（），我无法在不重新加载对话框的情况下再次选择其中的任何内容。

[我通过http://jsbeautifier.org/](http://jsbeautifier.org/)上的漂亮打印机运行 //ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js 。我了解到所有 jQuery 鼠标事件都在第 1277 行传递给处理程序，并在那里添加了一条 Firebug 日志记录语句：

```
 d.handler && (o = d, d = o.handler, f = o.selector), d.guid || (d.guid = p.guid++), i = g.events, i || (g.events = i = {}), h = g.handle, h || (g.handle = h = function (a) {

 console.log("a ", a, " at ", a.type, " h ", h.elem, " args ", arguments);
 return typeof p != "undefined" && (!a || p.event.triggered !== a.type) ? p.event.dispatch.apply(h.elem, arguments) 
```

当菜单选择成功时，console.log 语句记录鼠标按下、点击、鼠标离开，最后将对象 a 打印为 Object { type= "focus", timeStamp=1351561057050, jQuery182035863344054812873=true, more...}

我的 select 函数被调用，并且 text 和 data-cid 按预期写入。选择函数在包含菜单的分区上调用 hide()。

当我使用 show() 重新出现菜单分区并尝试选择其他内容时，会发生所有鼠标事件，包括 click 和 mouseout，但没有打印 a 作为“focus”类型的对象。似乎隐藏菜单破坏了鼠标单击处理程序，使其不再生成焦点事件？

这些焦点事件是 jQuery 调用 jQuery UI 系统的方式；没有它们，就无法返回 UI。

谁能建议一种修复鼠标处理程序的方法？或者告诉我我是如何破坏焦点机制的？或者当我显示（）菜单时如何把它放回去？

# java - 带有空格的 Java 正则表达式

> ID：13148922
> 
> 赞同：0
> 
> 时间：2012-10-30T23:10:28.133
> 
> 标签：java, regex, whitespace

我正在尝试匹配这样的模式：

TR @（任何数量的单词字符都在这里）：

所以模式以 TR 开头，然后是一个空格，然后是 @，然后是任何字符，并以 a 结尾：

这是我的正则表达式：`Pattern p = Pattern.compile("TR\\s@[\\w]+:");`

它正在工作，例如将失败：

TR @abcnews：

我认为我的错误在于空格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:13:48.073

[演示](http://regex101.com/r/uC8zB3)

正则表达式：`TR\s+@(\w+):`

这甚至会反向引用文本，它接受 TR 和 @ 之间的多个空格，因此它对您来说非常有用，先生。

编辑它正常工作的java代码：

```
Matcher ma = Pattern.compile("TR\\s+@(\\w+):").matcher("TR    @asdfasd:");
while (ma.find()) {
    System.out.println(ma.group(1));
} 
```

# python - pygame中的鼠标滞后

> ID：13148928
> 
> 赞同：0
> 
> 时间：2012-10-30T23:10:54.790
> 
> 标签：python, mouse, pygame

我正在用 pygame 制作图形界面。该程序通常运行得很快，但是每当我按下按键时，鼠标都会拒绝移动半秒钟。我迷失了想法，想知道是否有人可以给我一些指导。

这是我的代码如何工作的一般意义，我确实认为这是顶级主循环、绑定或基础结构的问题，因为每个键绑定函数都会出现问题：

```
 #######PERPETUAL ACTIONS#
_perpetual_actions = []

def start_doing(function,insertAt=None):
    global _perpetual_actions
    if insertAt==None:
        insertAt=len(_perpetual_actions)
    _perpetual_actions.insert(insertAt,function)

def stop_doing(function):
    global _perpetual_actions
    if _perpetual_actions.count(function):
        _perpetual_actions.remove(function)

def do_perpetual_actions():
    global _perpetual_actions
    for action in _perpetual_actions:
        action()

def print_perpetual_actions():
    global _perpetual_actions
    for action in _perpetual_actions:
        print action.__name__

######BINDING INFRASTRUCTURE######## 

_bindings_dict = { }

def get_action(key, mod):
    try:
        action = _bindings_dict[(key,mod)]
    except KeyError:
        action = None
    return action

def get_binding(action_to_find):
    for event, action in _bindings_dict.iteritems():
        if action == action_to_find:
            return event
    return None

def bind(event, action):
    _bindings_dict[event] = action

def unbind(event):
    _bindings_dict.pop(event)

def swap_bindings(newBindings):
    _bindings_dict = newBindings

####MAIN LOOP####
if '-t' in sys.argv:
    test()
while True:
    for event in pygame.event.get():
        if event.type == MOUSEMOTION: 
            mousex, mousey = event.pos 
            mouse.x = mousex 
            mouse.y = mousey 
        elif event.type == KEYDOWN:
            action = get_action(event.key,event.mod)
            if not action == None:
                action()
        elif event.type == KEYUP:
            action = get_action(-event.key,event.mod)
            if not action == None:
                action()
        elif event.type == QUIT:
            quit()
    do_perpetual_actions()
    clock.tick(40) 
```

绑定字典是稍后定义的，并且在将来的某个时候，用户可以在程序运行时对其进行修改。如果您有不相关的建议，请告诉我，我刚刚开始，任何 pygame 建议将不胜感激:)

# php - 如何删除此 WordPress 主题上的覆盖（日期）？

> ID：13148930
> 
> 赞同：-1
> 
> 时间：2012-10-30T23:10:59.717
> 
> 标签：php, wordpress

链接 - [http://www.elegantthemes.com/preview/TheStyle/](http://www.elegantthemes.com/preview/TheStyle/)

在 Firebug 中闲逛了几个小时，没有运气。任何能让我摆脱痛苦的人都会感激不尽。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T23:13:51.850

`<span>`带有日期的包含在您的 CSS 添加的带有so`<span>`的类中：`month`

```
span.month { display: none; } 
```

# android - Android：将小部件拖放到主屏幕上时启动活动

> ID：13148932
> 
> 赞同：0
> 
> 时间：2012-10-30T23:11:11.980
> 
> 标签：android, android-widget

如果你们中的任何人熟悉 Twitter 的 Android 小部件，当您将它放在主屏幕上时，会启动一个活动，您可以在其中选择您希望小部件显示的推文类型。我希望在我自己的小部件中实现类似的东西。我阅读了它并找到了这个答案：

[在onEnabled中将小部件放置在主屏幕上时如何将更改应用于小部件？](https://stackoverflow.com/questions/7726986/how-to-apply-changes-to-widget-when-placing-it-on-the-homescreen-in-onenabled)

该用户表示，`onEnabled`由于 Android 管理小部件 ID 的方式，该方法不可靠。我想知道是否有人知道将小部件放置在主屏幕上时启动活动的替代方法。

此外，我发现一旦您从小部件菜单中选择小部件，就会调用 onEnabled，而不是在将其放置在屏幕上时。这将导致在用户准备好之前启动任何类型的设置活动。

多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T22:29:59.850

我叫错了树。这就是你想要在这里做的：http: [//developer.android.com/guide/topics/appwidgets/index.html#Configuring](http://developer.android.com/guide/topics/appwidgets/index.html#Configuring)

# android - 为什么我的 ListView 不能滚动？

> ID：13148933
> 
> 赞同：0
> 
> 时间：2012-10-30T23:11:30.647
> 
> 标签：android, android-layout, android-listview

请看下面的代码。

我有一个片段，它在代码中将具有单个 ListView“lstv”的布局膨胀到 LinearLayout 容器“llytFragmentContainer”中。我遇到的问题是 ListView 不会滚动。我知道这可能与布局的设置方式有关。

在 Fragment 中扩展布局的代码：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

    // Inflate the layout for this fragment
    View view = inflater.inflate(R.layout.frag, container, false);
} 
```

片段布局：

```
<ListView
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/lstv"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView> 
```

活动布局：

```
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:weightSum="100" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="10"
        android:padding="10dp"
        android:orientation="horizontal"
        android:weightSum="100" >

        <ProgressBar 
            android:id="@+id/progressBar"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="88"
            style="@android:style/Widget.ProgressBar.Horizontal" />

        <TextView 
            android:id="@+id/txtProgress"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="12"
            android:layout_marginLeft="10dp" />
    </LinearLayout>

    <TextView 
        android:id="@+id/txtCounter"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="8"
        android:gravity="center_horizontal"
        android:textSize="20dp" />

    <LinearLayout 
        android:id="@+id/llytFragmentContainer"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="67">

    </LinearLayout>

    <Button 
        android:id="@+id/btnEnd"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="15"
        android:text="End Tour" />
</LinearLayout> 
```

# machine-learning - Q-Value 无限制增加，在 Q-Learning 中重复相同动作后重复奖励的结果

> ID：13148934
> 
> 赞同：6
> 
> 时间：2012-10-30T23:11:32.887
> 
> 标签：machine-learning, artificial-intelligence, reinforcement-learning, q-learning

我正在通过一个简单的应用程序开发一个简单的 Q-Learning 实现，但有些事情一直让我感到困惑。

让我们考虑 Q-Learning 的标准公式

```
Q(S, A) = Q(S, A) + alpha * [R +  MaxQ(S', A') - Q(S, A)] 
```

让我们假设这种状态`K`有两种可能的动作，既授予我们的代理奖励，`R`又`R'`授予`A`和`A'`。

如果我们遵循一种几乎完全贪婪的方法（假设我们假设 0.1 epsilon），我将首先随机选择其中一个动作，例如`A`. 下一次，我可能（90% 的时间）会再次选择`A`，这将导致 Q(K, A) 不断增长和增长，即使我碰巧尝试`A'`，它的回报也可能是在与 A 相同的量级上，我们将陷入在接下来的学习过程中几乎不可能从第一次猜测中“恢复”的情况。

我想这一定不是这样，否则代理基本上不会学习——它只是遵循一个简单的方法：像你第一次那样做所有事情。

我错过了什么吗？我知道我可以调整 alpha 值（通常，随着时间的推移降低它），但这绝不会改善我们的情况。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T08:09:20.100

由此，[我们](http://books.nips.cc/papers/files/nips14/CN04.pdf)知道：

> Q-learning 的收敛性使用任何探索策略都成立，并且只需要每个状态动作对`(s,a)`被**无限频繁地**执行。

这`epsilon-greedy policy`是探索和利用之间的平衡，既保证了收敛性，又保证了良好的性能。但在实际问题中，我们往往需要一些启发式方法来改变学习速度`alpha`，以代表更好的回报。否则`infinite often`很难满足要求。

我在下面列出一个例子。这是一个经典问题，其中您有一个网格，并且每个单元格中可能有不同的奖励金额。例如，下面显示了一个 4x4 网格，其中每个单元格都包含 的奖励`1`，除了左上角的单元格（您有更大的奖励，数量为`10`）。一个机器人在网格中移动。合法动作是移动`LEFT`、和`RIGHT`，但机器人不能移出网格。`UP``DOWN`

所以我们的状态空间包含 16 个不同的状态，对应于 16 个单元格。由于边界限制，每个州都有不同数量的法律行动。我们的目标是计算最优策略（给定任何状态`s`，输出最优动作`a`）。

```
+++++++++++++++++++++
+ 10 +  1 +  1 + 1  +
+++++++++++++++++++++
+ 1  +  1 +  1 + 1  +
+++++++++++++++++++++
+ 1  +  1 +  1 + 1  +
+++++++++++++++++++++
+ 1  +  1 +  1 + 1  +
+++++++++++++++++++++ 
```

假设我们使用一个恒定`epsilon-greedy policy`的`epsilon=0.1`学习率`alpha=0.1`。我们从网格上的随机位置开始。每当我们到达左上角时，我们都会再次从一个随机位置重新开始。

下面是运行 200,000 次移动模拟的结果。最左边的块直观地显示了每个单元格的当前贪婪策略。

*   `-->`向右移动
*   `<--`向左移动
*   `^`向上
*   `v`向下移动

因此，您会发现这远非最佳策略。显然，在最优策略中，每个单元格都应该指向左或上，因为我们在位置 有更大的奖励`(0,0)`。

```
 v   v   v   v   |      2      9      5      4   
 v   v   v   v   |     14     98     75     14   
-->  v   v  <--  |    258   3430   3312    245  
--> --> <-- <--  |   3270  93143  92978   3191 
```

右边的块显示了到目前为止我们访问每个单元格的次数。您会看到我们大部分的访问都在底部，但我们很少访问顶行。这就是为什么我们还没有达到最优策略的原因。

如果我们将学习率更改为`alpha=1/(number of times you visited (s,a) so far)`，我们能够在 20,000 步内达到最优策略（如下所示）。此外，我们访问每个单元格的次数分布更均匀，尽管并不完美。

```
 --> <-- <-- <--  |     34   7997   7697    294 
  ^   ^   ^  <--  |    731    898    524    132 
  ^   ^   ^   ^   |    709    176     88     94 
  ^   ^   ^   ^   |    245    256     96     77 
```

对于具有更多状态的更大问题，例如 10x10 网格，我发现最好使用更大的`epsilon`. 例如，下面是在 10x10 网格上移动 80,000 次后的模拟结果`epsilon=0.5`。除了右下角之外，它几乎是最佳的。还有一个[想法](http://www.hjphd.iit.uni-miskolc.hu/files/disszertaciok/stefan_peter_dissertation.pdf)是使用模拟退火来帮助提高 Q-learning 的收敛速度。

```
 v  <-- <-- <-- <-- <-- <-- <-- <-- <--  |     19   2500   1464    716    386    274    216    159    121     71 
 ^  <-- <-- <-- <--  v  <-- <-- <-- <--  |   9617  11914   3665   1071    580    410    319    225    207    131 
 ^   ^   ^  <-- <-- <-- <--  v  <-- <--  |   5355   5716   2662   1675   1465    611    302    183    162    101 
 ^   ^   ^   ^   ^  <-- <-- <-- <-- <--  |   1604   1887   1192    621   1056    882    693    403    206    100 
 ^   ^   ^   ^   ^   ^   ^  <-- <-- <--  |    639    735    731    333    412    399    480    294    172    114 
 ^   ^   ^  <--  ^   ^   ^  <-- <--  ^   |    373    496    640    454    272    266    415    219    107     98 
 ^   ^   ^   ^   ^   ^   ^   ^  <--  ^   |    251    311    402    428    214    161    343    176    114     99 
 ^   ^   ^   ^  <-- -->  ^  <-- <-- <--  |    186    185    271    420    365    209    359    200    113     70 
 ^   ^   ^   ^   ^   ^   ^   ^   v   v   |    129    204    324    426    434    282    235    131     99     74 
 ^   ^   ^   ^   ^  <--  ^  <-- <-- <--  |    100    356   1020   1233    703    396    301    216    152     78 
```

顺便说一句，我的玩具问题的 Python 代码（约 100 行）在[这里](https://gist.github.com/3985998)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-31T02:10:27.063

`Q(K, A)``minus Q(S, A)`由于该术语，它不仅会无限增长。如果您将更新规则重写为：

`Q(S, A) <-- Q(S, A)(1 - a) + a(R + maxQ(S', A'))`

这表明它`Q(K, A)`慢慢地向它的“实际”值移动`R + maxQ(S', A')`。 `Q(K, A)`只会增长到接近那个；不是无限的。当它停止增长（已接近其实际值）时，`Q(K, A)`for other `A`s 可以赶上。

无论如何，epsilon 的全部意义在于控制您是否希望学习过程更贪婪（启发式）或探索性（随机），因此如果学习过程太窄，请增加它。

还要注意，QL 收敛的一个正式条件是每一对`(S, A)`都被访问了无数次（意译）！所以，是的，在训练过程结束时，你希望每一对都被访问了相当多的次数。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-31T18:49:16.820

正如其中一条评论中提到的，伽玛值小于 1 可以保证总和不会漂移到正无穷大（假设奖励本身是有界的）。

但它确实可能会在一段时间内陷入错误的选择。有一些事情可以做：

**乐观初始化：**如果你乐观地开始所有的 Q 值，那么每次你尝试新事物时，你都会得到“幻灭”，因此下次你会想尝试其他事物。这种情况会一直持续下去，直到您对每个行动的价值有了现实的认识。

**使用优势函数：**在每个动作都很好但有些比其他动作更好的情况下，使用优势函数（即这个动作比这个状态的预期奖励好多少）来更新你的参数是个好主意. 这对于策略梯度特别有用。

# jquery - Facebook 应用程序不会重定向移动网站 url

> ID：13148935
> 
> 赞同：4
> 
> 时间：2012-10-30T23:11:36.983
> 
> 标签：jquery, facebook, facebook-graph-api, mobile, facebook-authentication

在我的应用设置中，我有一个作为移动 URL 的：

```
https://example.herokuapp.com/mobile.php#&ui-state=dialog 
```

但是，当我尝试使用智能手机从 Facebook 访问应用程序时，Facebook 会重定向到 OAuth URL 几毫秒，然后重定向到：

```
https://example.herokuapp.com/?state=63903485c518f2ae5deca667b9a............#_=_ 
```

由于 /mobile.php 丢失，而是加载桌面版本。

我怎样才能解决这个问题？非常感谢任何建议。

非常感谢你

**编辑：一段安全代码**

```
try {
    $facebook = new Facebook(array(
            'appId'  => AppInfo::appID(),
            'secret' => AppInfo::appSecret(),
    ));
    $access_token=$_GET['access_token'];
    Log::debug("BaseControl:access token: ". $access_token);
    if(isset($access_token)){
        $facebook->setAccessToken($access_token);
    }
    $user_id = $facebook->getUser();
} catch (Exception $e) {
    exit("Error getting facebook data");
}

if ($user_id) {
    try {
        $basic = $facebook->api('/me');//se necesita access token, si no se tiene falla
    } catch (FacebookApiException $e) {
        if (!$facebook->getUser()) {
            exit("Invalid access token");
        }
    }
    if($basic==null){
        exit("Application not installed");
    }
    $user=UsersLogic::getUser($user_id);
    if($user==null){
        exit("User not registered in database");
    }

}
else{
    exit("No user logged");
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T23:00:25.510

Arturo，我会仔细检查您的仪表板设置是否正确。确保“使用 Facebook 登录的网站”部分具有正确的 URL，在您的情况下，它是移动 URL。当您将鼠标悬停在 [?] 上时，工具提示会显示“您网站的 URL。出于安全原因，我们只会重定向到此 URL”。因此，为了获得正确的重定向 URL，您需要确保该字段中的 URL 是您希望用户重定向到的 URL。

正如它所说，出于安全目的，Facebook 只会重定向到该 URL，因此，如果您有桌面和移动版本的应用程序，那么您需要有一个端点来处理重定向以将用户发送到正确的页面。对于您的情况，重定向 url 似乎指向您的根页面。那么你应该做的是在你的根页面中有一些逻辑来检查传入请求的用户代理并适当地路由。我会查看[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)以获取用于检测移动浏览器的开源代码片段。您应该将您的根页面 URL 放在第一个字段中，将移动版本放在第二个字段中。

让我知道这是否有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T07:27:33.973

虽然这并不能解决问题的核心，但我确实有一个想法，如果您没有得到任何其他回复，您可以尝试一下：

在您的应用程序桌面版本的索引页面上，您可以检查用户代理以测试它是否是移动设备。如果是，您可以重定向到您的 mobile.php 页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-18T08:56:16.473

用户代理嗅探**总是**一个坏主意。在应用程序的入口点，如果用户通过 Facebook 中的页面选项卡（即桌面用户）加载应用程序，则应通过检查 Facebook 发送的“签名请求”变量来确定它是桌面还是移动。如果用户在 Facebook 之外的移动设备上访问应用程序，则不会发送此变量。

php:

```
if(isset($_REQUEST['signed_request']))
    //load desktop version
else
    //load mobile version 
```

# scala - Scala：覆盖 toString 以便在字符串周围打印引号

> ID：13148936
> 
> 赞同：5
> 
> 时间：2012-10-30T23:11:48.790
> 
> 标签：scala, serialization, introspection

我想编写一个“toSource”函数来生成基本案例类的源代码。例如，我想：

```
case class Person(name: String, age: Int)
val bob = Person("Bob", 20)
println(toSource(bob)) // Should print """Person("Bob", 20)""" 
```

“toString”函数几乎给了我我想要的东西，但它去掉了字符串周围的引号：

```
println(bob.toString) // Prints """Person(Bob, 20)""" 
```

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T23:37:24.493

您可以利用案例类混合 trait 的事实`Product`：

```
def toSource(p: Product): String =
   p.productIterator.map {
      case s: String => "\"" + s + "\""
      case other => other.toString
   } mkString (p.productPrefix + "(", ", ", ")")

toSource(Person("Bob", 20))  // yields """Person("Bob", 20)""" 
```

# apache - mod_rewrite 和子域

> ID：13148937
> 
> 赞同：1
> 
> 时间：2012-10-30T23:11:50.847
> 
> 标签：apache, mod-rewrite, subdomain

我有一个“beta”子域来测试我的实际项目，这个子域指向`beta`我的根服务器中的文件夹。我也有一个`users`包含所有用户信息的文件夹。

为了显示用户 58 的个人资料，目前我们需要： `beta.domain.com/users/user58`

但是...我想隐藏 URL 的一部分，只在地址栏中显示以下内容： `beta.domain.com/user58`

同样，如果我在内部重定向到`beta.domain.com/user33`，地址栏将显示此 URL 和内容`beta.domain.com/users/user33`

我在服务器的文件夹中创建了以下`.htaccess`文件。`beta`

```
DirectoryIndex default.php index.php index.html index.htm
RewriteEngine On
RewriteRule ^([A-Za-z0-9_]+)/$ users/$1 [L,NC] 
```

但是什么都没有发生！！！我尝试将文件复制到服务器根目录，结果相同。

请给点建议好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T15:22:34.440

我认为您的问题是正则表达式末尾的 / 。这将匹配 beta.domain.com/user33/，但不能没有 /。尝试这个：

```
RewriteEngine On
RewriteRule ^([A-Za-z0-9_]+)$ users/$1 [L,NC] 
```

您始终可以通过添加 / 来选择包含 / ？之后：`^([A-Za-z0-9_]+)/?$`

# .net - 从不区分大小写的查找中检索正确的大小写

> ID：13148939
> 
> 赞同：0
> 
> 时间：2012-10-30T23:11:54.743
> 
> 标签：.net, data-structures, case-insensitive

在 .net 中，存储参考大小写的最佳数据结构是什么？

我正在寻找一种数据结构，它可以返回最初插入条目的外壳。像这样的东西：

```
Store.Add("HeLLo") //Adds a key

if (Store.Contains("hEllO")) //returns true (case-insensitive lookup)
    Store.Retreive("hEllO")) //return HeLLo, as initially inserted. 
```

我目前使用不区分大小写的字典，其键等于值，但这感觉很难看。

```
Dictionary<string, string> dic = 
    new Dictionary<string, string>(StringComparer.InvariantCultureIgnoreCase)

dic.Add("HeLLo", "HeLLo")
if (dic.ContainsKey("hEllO"))
    dic["hEllO"] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:55:41.633

我真的找不到任何方法来从任何集合中获取键，就像在 C++ 中那样（其中 std::maps 返回键/值对上的迭代器）。

如果你准备好做一些棘手的工作，它是可能的：实现你自己的 StringComparer 派生类（当然让所有东西都由 StringComparer.InvariantCultureIgnoreCase 实现），`m_key`在检索之前用搜索到的键初始化一个成员，例如，并让`Equals(a,b)`方法日志`m_actualKey`当基本实现返回 true 时，将比较值放入成员中，保持`a`if 它不是`m_key`else 保持`b`。

检索成功后，总会有一个“ `Equals(a,b)`return 1”事件，保证你在`m_actualKey`. 请注意，如果从多个线程中使用字典，则必须同步查询。

# c# - 如何检测客户端是否可以访问 iFrame 中的网站？

> ID：13148940
> 
> 赞同：1
> 
> 时间：2012-10-30T23:11:57.107
> 
> 标签：c#, javascript, jquery, asp.net, ajax

我目前有一个网站，在某些地方使用 iFrame 从我们的 Intranet 加载页面（这是不可避免的）。我想要做的是能够检测客户端是否能够从其当前位置访问 Intranet 页面。我有以下代码，但显然它只检查服务器是否可以联系 Intranet（剧透警报：它完全可以）。

```
public bool IsAvailable()
    {
        HttpWebRequest httpReq = (HttpWebRequest)WebRequest.Create("http://localintranetsite/");
        httpReq.AllowAutoRedirect = false;

        try
        {
            HttpWebResponse httpRes = (HttpWebResponse)httpReq.GetResponse();
            if (httpRes.StatusCode == HttpStatusCode.NotFound)
                return false;
            else
                return true;
        }
        catch
        {
            return false;
        }
    } 
```

当然，如果可能的话，我希望能够做到这一点而不必依赖检测网站用户的 IP 地址。

我的另一个选择是在无法联系 Intranet 站点时执行自定义 404 页面，但我不确定我是否可以这样做（或者我是否可以这样做）。

如果它有任何区别，加载 iFrame 的代码位于从 javascript 调用的 Web 服务中，因此虽然我的 Web 服务中的 asp.net 解决方案是理想的，但 javascript 函数也可以工作。

我的（没有帮助的）当前解决方案尝试检查是否可以访问 Intranet 站点，但它只能检查 Web 服务器是否可以访问它，而不是客户端。

对于那些好奇的人，这是 javascript（通过 jQuery）方式（它不起作用，因为它是跨域的）：

```
 $.ajax({
        type: 'HEAD',
        url: 'http://intranetsite/',
        success: function () {
            local = true;
        },
        error: function () {
            local = false;
        }
    }) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T00:11:28.747

由于您的 Intranet url 与主页位于不同的主机域中，因此页面上运行的 JavaScript 无法直接确定 iframe 内部发生的情况。如果 iframe 无法联系到内网站点，由于主机域的不同，错误状态对外部页面将不可见。

但是，即使在跨域情况下，iframe 也可以通过多种方式向主机页面公开数据。例如，可以从 iframe 内部或外部对 iframe 的宽度或高度进行更改，并且可以从两侧看到。

一种解决方案可能是将一些 JavaScript 代码添加到您从 Intranet 站点加载到 iframe 的 html 页面中，以将 iframe 的宽度或高度设置为特殊值。如果 iframe 在主机页面上不可见，则可以将宽度和高度设置为所需的任何整数值。如果 iframe 确实需要可见，您可以通过将宽度或高度设置为偶数或奇数值来跨边界传递布尔信息。

因此，例如，让 Intranet 网页通过在页面加载时将其增加为奇数值来修改其高度。

让主机页面中的 JavaScript 将 iframe 的初始高度设置为偶数，然后将 Intranet URL 分配给 iframe.src 属性。经过一段时间后，让主机页面 JavaScript 检查 iframe 高度。如果 iframe 高度仍然是之前的高度，则 URL 尚未加载。如果过了很长时间，那么 URL 没有加载可能是因为客户端无法访问 Intranet 站点。

如果宿主页面看到iframe高度变成了奇数，那么你就知道内网页面加载成功了。

这种方法不会为失败提供明确的信号，但应该为成功提供明确的信号。

如果您需要支持的浏览器足够现代，您可能会考虑使用 HTML5 window.postMessage 在同一浏览器内跨域边界的 DOM 元素之间进行通信。[https://developer.mozilla.org/en-US/docs/DOM/window.postMessage](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)

# javascript - javascript排序数组以与顺序数组对齐

> ID：13148941
> 
> 赞同：4
> 
> 时间：2012-10-30T23:12:01.167
> 
> 标签：javascript, arrays, sorting

这是一个例子：

```
 //    0     1       2      3       4
 var people = ['jack','jill','nancy','tom','cartman'];
 var order  = [3,1,4,0,2];

 // somehow sort people array to the order specified in the order array

          //  3      1       4        0      2
 people == ['tom','jill','cartman','jack','nancy']; 
```

我以前使用过 .sort 和一个函数，但在这个函数上仍然不知所措。

**更新**

看到一些答案后，我不敢相信这对我来说并不明显。因此有很多方法可以做到这一点，获胜者将由 jsperf 决定。

（我也用一个有效的答案来支持每个人）

**比赛！[http://jsperf.com/array-sorted-to-order-array3](http://jsperf.com/array-sorted-to-order-array3)**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T23:15:29.400

```
sorted = []
order.forEach(function(i) { sorted.push(people[i]) }); 
```

或者，更花哨但可读性更低（IMO）：

```
sorted = order.reduce(function(r, i) { 
    return r.concat([people[i]])
}, []); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T23:22:19.770

只是另一种方式:)

```
people = order.map(function(value) { return people[value]; }); 
```

[js小提琴](http://jsfiddle.net/pThsg/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T23:16:01.100

`order`是一系列指标。所以只需遍历它，按照指定的顺序取出你想要的值，创建一个新数组。

```
var people = ['jack','jill','nancy','tom','cartman'];
var order  = [3,1,4,0,2];

var sorted = [];
for (var i = 0; i < order.length; i++) {
  var desiredIndex = order[i];
  sorted.push(people[desiredIndex]);
}

console.log(sorted);
// ["tom", "jill", "cartman", "jack", "nancy"] 
```

有时排序不是“排序”。有时您只需要通过从其他事物中提取数据来制作新事物。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T23:15:54.797

不知道，大概是这样的吧？

```
var people = ['jack','jill','nancy','tom','cartman'];
var order  = [3,1,4,0,2];

var result = [], i, n=order.length;

for (i=0; i<n; i++)
{
  result[ order[i] ] = people[i];
} 
```

# apache2 - Apache httpd 配置文件 2.2

> ID：13148942
> 
> 赞同：0
> 
> 时间：2012-10-30T23:12:15.377
> 
> 标签：apache2

如果我想在 localhost 中打开一个 html 文件 - 例如 localhost/myfile.html - 我需要更改 Apache 的 httpd conf 文件吗？实际上我在一本书中读到，这个文件名应该添加到以下行：

目录索引 index.html

所以它会是：

DirectoryIndex index.html myfile.html

我之所以这样问，是因为我创建了一个 Google 地图，其中包含一些使用 PHP 和 Ajax 从用户那里获取数据的表单，但它不起作用。所以我想也许Apache的配置有问题。

提前致谢！

丹尼尔·黑山

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T20:51:52.357

不，这不是必需的！

实际上，由于某些问题，该代码无法正常工作。与 httpd 文件配置无关。一旦我修复它，该文件在 localhost 中运行良好。

谢谢，请投票！

丹尼尔

# javascript - jquery .remove() 是否在后代 DOM 元素上触发 .off()

> ID：13148943
> 
> 赞同：3
> 
> 时间：2012-10-30T23:12:18.483
> 
> 标签：javascript, jquery, memory-leaks

所以，我知道当我对 DOM 中的元素执行 .remove() 时，它及其所有子元素都会被删除并标记为删除/垃圾收集。类似地，所有元素的 jQuery UI 小部件都将触发它们的“destroy”方法，并且 .data() 空间中的所有条目将为每个元素删除。在决定清除我的 DOM 树的一部分时，我需要知道的是 remove 是否实际上也为每个元素显式地触发了 .off() ，还是我需要自己这样做？

例如，假设我有一系列 div：

```
<div id="A-1">
    <div class="HasEventListener DelegatedEventBindPoint id="B-1">
        <button class="CreatesDelegatedEvent" id="C-1" />
    </div>
    <button class="HasEventListener NonDelegatedEvent" id="B-2" />
</div> 
```

因此，如果我执行 $("#A-1").remove()，这是否有效地调用类似于 $(".HasEventListener").off() 的命令？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T23:13:12.287

是的，它解除了所有事件处理程序的绑定。

> 除了元素本身，所有与元素关联的绑定事件和 jQuery 数据都将被删除。

[来源](http://api.jquery.com/remove/)。

[`detach()`](http://api.jquery.com/detach/)如果要保留事件处理程序，可以使用。

另外，你提到...

> 所以，我知道当我`.remove()`在 DOM 中的一个元素上执行时，它和它的所有子元素都会被删除并标记为删除/垃圾收集。

这不一定是真的。您可能仍然引用这些元素。相反，引用计数将递减，如果达到 0，则可能会被标记为 GC。

[js小提琴](http://jsfiddle.net/QEdA4/)。

# neo4j - 使用 Neo4j 和 jRuby on Rails 索引旧数据

> ID：13148945
> 
> 赞同：0
> 
> 时间：2012-10-30T23:12:24.077
> 
> 标签：neo4j, jrubyonrails

我们最近切换到 JRuby on Rails 以便我们可以使用 Neo4j，尽管我们只触及了 Neo4j 的皮毛，但它已经非常棒了。也就是说，我只是在索引和查找方面遇到了一个相当棘手的问题。

我刚刚在我的用户模型的 created_at 字段和我的 Post 模型的 created_at 字段中添加了 ':index => :exact'（我的 Post 模型的 custom_date 字段上已经有一个索引）：

```
class User < Neo4j::Rails::Model
  property :created_at, :type => DateTime, :index => :exact

class Post < Neo4j::Rails::Model
  property :created_at, :type => DateTime, :index => :exact
  property :custom_date, :type => DateTime, :index => :exact 
```

然后我进入 rails 控制台尝试了这段代码（我改编自[文档](https://github.com/andreasronge/neo4j/wiki/Neo4j%3a%3aWrapper-Lucene)）：

```
User.find( :all, :created_at => 7.days.ago .. DateTime.now ).count 
```

它返回 0，我知道不是这样的代码：

```
new_users = []
User.all.each{ |user| new_users << user if user.created_at > 7.days.ago }
new_users.count 
```

返回 104。

同样，当我跑步时

```
Post.find( :all, :created_at => 7.days.ago .. DateTime.now ).count 
```

我得到0，但是当我跑步时

```
Post.find( :all, :custom_date => 7.days.ago .. DateTime.now ).count 
```

我得到 305。（帖子的 custom_date 最初设置为帖子的 created_at。）唯一的区别是当我们移植旧数据库时，我在 Post 模型的 custom_date 字段中设置了索引，而我只是将索引添加到created_at 字段。

这是我的问题：如何按 created_at 时间搜索我的用户和帖子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T09:20:42.417

问题是旧数据没有lucene索引。您只声明了一个索引，但没有更新旧节点。您需要`add_index`在所有旧节点上使用。

你应该这样做：

```
Neo4j::Transaction.run do
  User.all.each do |user|
     # Since there is a type converter on created_at, we need to find the data
     # as it is stored in neo4j.
     val = User._converter(:created_at).to_java(user[:created_at])
     user.add_index(:created_at, val) 
  end
end 
```

请参阅此[https://github.com/andreasronge/neo4j/commit/cffe7a4a2fdb83b71e781e717a2a8011e2ef494d的 RSpec](https://github.com/andreasronge/neo4j/commit/cffe7a4a2fdb83b71e781e717a2a8011e2ef494d)

我还创建了一个 github 问题，因为我认为这样做应该更容易 - [https://github.com/andreasronge/neo4j/issues/220](https://github.com/andreasronge/neo4j/issues/220)

欢迎请求请求:)

顺便说一句，在 Neo4j 的旧 0.4.6 版本中，支持通过迁移来执行此操作。

# java - 用于测试的 Android 资产

> ID：13148958
> 
> 赞同：0
> 
> 时间：2012-10-30T23:14:03.203
> 
> 标签：java, android, testing, android-assets

我有一个 CSV 文件，我想将其提供给我的 Android 测试套件。不过，我不希望它可用于主应用程序。我将它保存在`assets`我的测试项目的文件夹中。然后我尝试使用从测试中访问它

```
context.getAssets().open(DATA_ASSET); 
```

where`DATA_ASSET`被声明为

```
DATA_ASSET = "cards.csv" 
```

我将 设置`context`为引用我正在测试的活动。但是，这显然不会像我拥有的​​那样工作，因为它将查看主应用程序的资产。我看到解决此问题的两种可能性：

1.  提供与测试项目一起安装的资产的正确路径
2.  获取`Context`测试项目的资源和资产

我还没有找到任何方法来做这些。也许还有我没有想到的第三种解决方案。如何访问与测试项目一起安装的资产？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T00:18:25.080

如果您是子类化`InstrumentationTestCase`或类似的类，您可以`Context`通过执行以下操作为测试项目获取一个：

```
Context ctx = getInstrumentation().getContext(); 
```

# session - Apache Chemistry openCMIS 会话耗时过长

> ID：13148962
> 
> 赞同：1
> 
> 时间：2012-10-30T23:15:27.840
> 
> 标签：session, amazon-web-services, alfresco, bitnami, opencmis

我正在尝试使用 openCMIS 连接到 Alfresco，获取会话对象需要 6-18 秒。我的代码如下。

```
private static String ALFRESCO_ATOMPUB_URL = "http://localhost/alfresco/service/cmis";
public Session getAtomSession() {

    long time1 = System.currentTimeMillis();
    SessionFactory sessionFactory = SessionFactoryImpl.newInstance();
    Map<String, String> parameter = new HashMap<String, String>();
    parameter.put(SessionParameter.USER, SYSTEM_USER);
    parameter.put(SessionParameter.PASSWORD, SYSTEM_PASSWORD);
    parameter.put(SessionParameter.BINDING_TYPE, BindingType.ATOMPUB.value());
    parameter.put(SessionParameter.ATOMPUB_URL, ALFRESCO_ATOMPUB_URL);
    parameter.put(SessionParameter.AUTH_HTTP_BASIC, "true" );
    parameter.put(SessionParameter.COOKIES, "true" );

    /*
    List<Repository> repositories = new ArrayList<Repository>();
    repositories = sessionFactory.getRepositories(parameter);

    Repository repository = repositories.get(0);
    log.debug("REPOSITORY_ID: "+repository.getId());*/
    parameter.put(SessionParameter.REPOSITORY_ID, MY_REPOSITORY_ID);

    Session session = sessionFactory.createSession(parameter);

    //log.debug("Got a connection to repository: " + repository.getName() + ", with id: " + repository.getId());
    long time2 = System.currentTimeMillis();
    long difftime = time2 - time1;
    log.debug("Time Taken for Atom Session: "+difftime+" ms.");
    return session;
} 
```

我尝试不使用 cookie 且不使用 AUTH_HTTP_BASIC 但没有成功。我正在运行一个 bitNami Alfresco 4.0.e-0 实例并将我的应用程序与 Alfresco 一起托管在同一个 tomcat 6 服务器中。我是使用 Alfresco 编码的新手，所以无法理解我应该做些什么来防止长时间获取会话对象。如果我做错了什么或者我是否可以克服这个问题，谁能告诉我？非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T22:03:39.527

你可以试试这个：

```
private static String ALFRESCO_ATOMPUB_URL = "http://localhost:8080/alfresco/service/cmis"; 
```

# ios - 将iOS中的相机对焦模式设置为手动或微距

> ID：13148964
> 
> 赞同：1
> 
> 时间：2012-10-30T23:15:32.470
> 
> 标签：ios, ios5, camera

如果可以在 iOS 中调整相机焦点，我尝试查找信息。在 android 中，可以将相机参数调整为例如[FOCUS_MODE_MACRO](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#FOCUS_MODE_MACRO)。iphone/ipad 中是否有类似的东西。我想固定焦点（不自动）并在近距离拍摄中聚焦（微距模式）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T23:21:48.680

试试[这个文档页面](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVCaptureDevice_Class/Reference/Reference.html)（特别是“焦点模式”属性）。如果那不能满足您的要求，那么我认为什么都不会。

# ios - 试图从本地填充类中获取邮政编码到变量中，但得到一个讨厌的循环

> ID：13148965
> 
> 赞同：0
> 
> 时间：2012-10-30T23:15:32.113
> 
> 标签：ios, for-loop, nsmutablearray

我有以下名为 ZipCode 的类和一个 loadData 方法，该方法成功地从第三方服务获取数据并填充我的本地实例化 ZipCode 类。我遇到的问题是将此类中的填充值放入 5 个局部变量中，然后我可以将其传递给我的存储过程，该存储过程从数据库中拉回输入的邮政编码周围的商店。

邮编.h

```
@interface ZipCodes : NSObject

@property (strong,nonatomic) NSString *city; //adminName2
@property (strong,nonatomic) NSString *stateAbbreviation; //adminCode1
@property (strong,nonatomic) NSString *postalCode; // postalCode
@property (strong,nonatomic) NSString *distance; //distance
@property (strong,nonatomic) NSString *country; // countryCode
@property (strong,nonatomic) NSString *stateName; //adminName1

-(id)initWithName:(NSString *)city stateAbbrev:(NSString *)stateAbbreviation postalCode:(NSString *)postalCode distanceFromGPSZip:(NSString *)distance country:(NSString *)country stateFullName:(NSString *)stateName;

@end 
```

邮编.m

```
@implementation ZipCodes

-(id)initWithName:(NSString *)city stateAbbrev:(NSString *)stateAbbreviation postalCode:(NSString *)postalCode distanceFromGPSZip:(NSString *)distance country:(NSString *)country stateFullName:(NSString *)stateName {

if (self = [super init]) {

    _city = city;
    _stateAbbreviation = stateAbbreviation;
    _postalCode = postalCode;
    _distance = distance;
    _country = country;
    _stateName = stateName;
}

return self;
}

-(NSString *)description {

return [NSString stringWithFormat:@"City=%@, State=%@  Zip=%@ is %@ from the original zipCode queried", self.city, self.stateAbbreviation, self.postalCode, self.distance];
}

-(NSString *)postalCode {

return self.postalCode; // This is where I get a rather long loop...
}

@end 
```

-(void) loadData:(NSString *)zipCode {

```
NSLog(@"GetSurroundingZipCodes is in loadData...");

self.zipCodes = [NSMutableArray array];

NSURL *url = nil;

NSLog(@"Get surrounding zip codes url is: %@", url);
NSString *zipCode = @"92675";
url = [NSURL URLWithString:[NSString stringWithFormat:@"http://api.geonames.org/findNearbyPostalCodesJSON?postalcode=%@&country=US&radius=10&username=frequentz", zipCode]];

NSURLRequest * urlRequest = [NSURLRequest requestWithURL:url];
NSError *error = nil;
NSURLResponse * response = nil;
NSData *data = [NSURLConnection sendSynchronousRequest:urlRequest returningResponse:&response error:&error];

self.zipCodes = [NSMutableArray array];

id jsonObject = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingAllowFragments error:&error];

if (jsonObject != nil && error == nil) {

    NSLog(@"Successfully deserialized...");

    if ([jsonObject isKindOfClass:[NSDictionary class]]) {

        NSDictionary *deserializedDictionary = (NSDictionary *)jsonObject;
        NSLog(@"Deserialized JSON Dictionary = %@", deserializedDictionary);

        for (NSString* key in deserializedDictionary) {

            id value = [deserializedDictionary objectForKey:key];

            for (NSDictionary *item in value) {

                NSString *city = [item objectForKey:@"adminName2"];
                NSString *stateAbbreviation = [item objectForKey:@"adminCode1"];
                NSString *postalCode = [item objectForKey:@"postalCode"];
                NSString *distance = [item objectForKey:@"distance"];
                NSString *country = [item objectForKey:@"country"];
                NSString *stateName = [item objectForKey:@"stateName"];

                ZipCodes *zipCode = [[ZipCodes alloc] initWithName:city stateAbbrev:stateAbbreviation postalCode:postalCode distanceFromGPSZip:distance country:country stateFullName:stateName];

                [self.zipCodes addObject:zipCode];
            }
        }
    }
}
else if (error != nil){
    NSLog(@"An error happened while deserializing the JSON data.");
}

// Assign zip codes to first five _zipCode1..5 variables
for (int i = 1; i <= 5; i++) {

    if (i == 1) {
        // If I comment out the return of zipCode in the ZipCode.m file above the loop goes away and I get a string description that looks like this: self.zipCodes: City=San Francisco, State=CA  Zip=94123 is 1.59213 from the original zipCode queried at index: 1
        NSLog(@"self.zipCodes: %@ at index: %i", self.zipCodes[i], i);  

        // Here I get the following error:  -[ZipCodes objectForKey:]: unrecognized selector sent to instance
        _zipCode1 = [[self.zipCodes objectAtIndex:i] objectForKey:@"postalCode"];

    } else if (i == 2) {
        _zipCode2 = [[self.zipCodes objectAtIndex:i] objectForKey:@"Zip"];
    } //etc...//
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:22:15.933

只需删除：

```
-(NSString *)postalCode {

return self.postalCode; // This is where I get a rather long loop...
} 
```

你得到的*循环*`self.postalCode`是因为你的 getter 正在调用自己（只是调用这个方法）。由于您有一个不需要手动定义 getter 的属性，它会自动为您合成。

如果出于任何原因您想手动定义 getter，请执行以下操作：

```
-(NSString *)postalCode {

return _postalCode;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:24:59.547

```
-(NSString *)postalCode {

    return self.postalCode; // This is where I get a rather long loop...
} 
```

是你的问题。self.postalCode 只是调用相同的函数。在任何情况下，您实际上都不需要 getter，因为变量是综合的。如果您必须有一个覆盖的 getter 才能说，添加一些额外的处理或其他东西，您可以执行以下操作。

```
-(NSString *)postalCode {
    NSString *postCodeOut = postalCode;
    //do something to postalCodeOut
    return postalCodeOut; 
} 
```

# javascript - javascript字符串中的特殊字符

> ID：13148967
> 
> 赞同：0
> 
> 时间：2012-10-30T23:15:43.097
> 
> 标签：javascript, string

使用 Firebug 我有一个 TypeError - slice 不是一个函数。我认为这是因为我试图在数字上使用切片，尽管我认为它会是一个字符串。

有问题的字符串是`"****01814c6538032b****"`，它通过 ajax 命令进入页面，但目前我只是声明它进行测试。

```
hexString = "****01814c6538032b****" 
```

....现在终于回答我的问题了！有没有办法将其显式声明为字符串？我可以使用 toString 来更改它，但想知道我是否可以首先将其指定为字符串并确保它保持不变。

** 编辑 ** 这是所有的 javascript 代码，我的代码从 hexString = 开始。

```
<script type="text/javascript">

<!--
// Parses the xmlResponse from status.xml and updates the status box
function updateStatus(xmlData) {
    var mainstat = document.getElementById('display').style.display;
    var loadstat = document.getElementById('loading').style.display;

    // Check if a timeout occurred
    if(!xmlData)
    {
        mainstat = 'none';
        loadstat = 'inline';    

        return;
    }

    // Make sure we're displaying the status display
    mainstat = 'inline';
    loadstat = 'none';

    // Loop over all the LEDs
    for(i = 0; i < 5; i++)
        document.getElementById('led' + i).style.color = (getXMLValue(xmlData, 'led' + i) == '1') ? '#ff8b00' : '#777';

    // Loop over all the buttons
    for(i = 0; i < 5; i++)
        document.getElementById('btn' + i).innerHTML = (getXMLValue(xmlData, 'btn' + i) == 'up') ? '&Lambda;' : 'V';

    // Update the POT value
    for(i = 0; i < 2; i++)
        document.getElementById('pot'+i).innerHTML = getXMLValue(xmlData, 'pot'+i);

    // Update for bargraph
    for(i = 1; i < 3; i++)
    {
        var wd=0;
        wd= (getXMLValue(xmlData, 'pot'+(i-1)))/5;
        document.getElementById('bar'+i).style.width=wd+"px";
    }

    // Update string value
    document.getElementById('test').innerHTML =
    getXMLValue(xmlData, 'test');

var hexString="****01814c6538032b****";

s1 = hexString.slice(0,4);
document.getElementById("slice1").innerHTML=s1;
s2 = hexString.slice(4,6);
document.getElementById("slice2").innerHTML=h2d(s2);
s3 = hexString.slice(6,10);
document.getElementById("slice3").innerHTML=h2d(s3);
s4 = hexString.slice(10,14);
document.getElementById("slice4").innerHTML=h2d(s4);
s5 = hexString.slice(14,18);
document.getElementById("slice5").innerHTML=h2d(s5);
s6 = hexString.slice(18,22);
document.getElementById("slice6").innerHTML=s6;

tempString = h2d(s2);
sensorNo = parseInt(tempString); 

tempString = h2d(s3);
humVal = parseInt(tempString);

  HumidityTemp=(125/65536)*humVal;
  HumidityTemp=HumidityTemp-6;

document.getElementById("slice3").innerHTML=HumidityTemp.toString();

tempString = h2d(s4);
tempVal = parseInt(tempString);  

  TemperatureTemp=(175.72/65536)*tempVal;
  TemperatureTemp=TemperatureTemp-46.85;

  document.getElementById("slice4").innerHTML=TemperatureTemp.toString();

tempString = h2d(s5) ;
voltVal = parseInt(tempString);

  VoltageTemp = 2095/voltVal;

  document.getElementById("slice5").innerHTML=VoltageTemp.toString();

}
setTimeout("newAJAXCommand('status.xml', updateStatus, true)",500);

function h2d(h) 
{
return parseInt(h,16);

}

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T14:37:22.550

您只需向其添加一个空字符串即可将数字转换为字符串，如下所示：

```
var str = 1+""; // === "1" 
```

此外，[这](http://www.sitepoint.com/forums/showthread.php?874869-slice-a-json-array-slice-will-not-work)可能是相关的。

# asp.net-mvc-3 - MVC3 Viewmodel 和 linq

> ID：13148973
> 
> 赞同：1
> 
> 时间：2012-10-30T23:16:15.540
> 
> 标签：asp.net-mvc-3, viewmodel, ienumerable

在网页中，我希望能够返回 BlogCategoryName 以及类别中的博客数量。例如

博客名称X(3)
博客名称Y(4)
....

我正在使用实体框架并有一个博客类别类

```
namespace emoCard.Domain.Entities
{
   public class BlogCategory
   {

     public BlogCategory()
     {
        this.Blogs = new List<Blog>();
     }

     public int BlogCategoryID { get; set; }
     public string BlogCategoryName { get; set; }
     public string BlogCategoryDescription { get; set; }
     public int BlogCategoryOrder { get; set; }

     public List<Blog> Blogs { get; set; }

    }
} 
```

我可以按照以下方式设置视图模型

```
namespace emoCard.WebUI.Models
{

  public class BlogCategoryViewModel
  {
    public IEnumerable<BlogCategory> BlogCategories { get; set; }
  }
} 
```

然后有一个看起来像的控制器

```
public PartialViewResult BlogCategories()
    {

        BlogCategoryViewModel viewModel = new BlogCategoryViewModel
        {
            BlogCategories = repository.BlogCategories.Include(b => b.Blogs)
        };

        return PartialView(viewModel);
    } 
```

然后我可以计算视图中每个类别的博客数量。

这可行，但我有很多问题。这些是：

*   我需要撤回所有信息（即我并不真正需要博客信息，只需要计数）。
*   计算视图中的计数似乎不正确。

我想我需要更改我的视图模型，以便我可以填充与每个类别关联的博客类别和博客数量，然后创建一个 linq 查询，该查询类别和博客计数但不是所有博客信息。我认为新的视图模型应该遵循

```
 public BlogCategoryMenuItem(BlogCategory blogCategories, int numberOfBlogs)
  {
    BlogCategories = blogCategories;
    NumberOfBlogs = numberOfBlogs;

  }

public class BlogCategoryViewModel
{
    public IEnumerable<BlogCategoryMenuItem> BlogCategoryMenuItem { get; set; }
} 
```

我有两个问题：
1\. 这是解决我遇到的问题的最佳方法吗？
2\. 如何使用 linq 填充这个 viewmodel 对象？
谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T08:56:25.593

在我的博客中，我使用存储过程来获取此信息：

```
SELECT [Category].Name,
       [Category].DisplayName,
       COUNT(pc.PostId) AS PostCount
FROM   [Category]
       LEFT JOIN PostCategory pc
            ON  pc.CategoryId = [Category].Id
GROUP BY
       [Category].Name,
       [Category].DisplayName 
```

然后，我将它映射到实体框架中，生成一个“GetCategoryCountList_Result”类。

在我的 cshtml 视图中：

```
@model List<EdiBlog.Core.Entities.GetCategoryCountList_Result>
...
@if (Model.Count > 0)
        {
            foreach (var item in Model)
            {
                <li>
                    <a href="@Url.Content("~/Category/List/" + @item.Name)">@item.DisplayName <span class="count uiSideNavCount fr">@item.PostCount</span></a>
                </li>
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T08:56:42.030

我会看一下 Automapper，它旨在从实体创建视图模型。如果您正确命名属性，它会自动进行映射。或者，您可以自己定义映射。可以在这里找到一些使用建议[https://github.com/AutoMapper/AutoMapper](https://github.com/AutoMapper/AutoMapper)

以下文章很好地涵盖了基础知识[http://visualstudiomagazine.com/articles/2012/02/01/simplify-your-projections-with-automapper.aspx](http://visualstudiomagazine.com/articles/2012/02/01/simplify-your-projections-with-automapper.aspx)

您只需定义实体和视图模型之间的映射，然后调用 map，它可以很简单：

```
Mapper.CreateMap<Customer, CustomerInfo>();
var CustomerInfo = Mapper.Map<Customer, CustomerInfo>(customer); 
```

Automapper 尝试根据命名约定匹配字段，然后根据实体中的值等设置值。

# python - Tkinter 标签不显示图像

> ID：13148975
> 
> 赞同：14
> 
> 时间：2012-10-30T23:16:25.727
> 
> 标签：python, tkinter

我正在尝试学习一些 tkinter。我无法让 tkinter 显示图标。我不知道哪里出错了。它不会产生任何错误并且它尊重图像的大小，但它是不可见的。我在网上找到的所有内容都告诉我添加第二个引用以防止从 python 进行垃圾收集，但不知何故这并没有成功。这是我的代码出错的部分：

```
from Tkinter import *
from PIL import Image, ImageTk

class GUI:

    def __init__(self, master):

        frame = Frame(master)
        frame.pack()

        #status bar
        self.bar = Frame(root, relief=RIDGE, borderwidth=5)
        self.bar.pack(side=TOP)

        self.iconPath = 'data/icons/size.png'
        self.icon = ImageTk.PhotoImage(Image.open(self.iconPath))
        self.icon_size = Label(self.bar, image = self.icon)
        self.icon_size.pack(side=LEFT)

root = Tk()

app = GUI(root)

root.mainloop() 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-05T05:21:24.710

当您将 PhotoImage 或其他 Image 对象添加到 Tkinter 小部件时，您必须保留自己对图像对象的引用。如果不这样做，图像将不会始终显示。

决定[在这里](http://effbot.org/pyfaq/why-do-my-tkinter-images-not-appear.htm)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-11-28T18:08:28.603

出于某种原因（我不明白为什么），您必须将图像对象锚定到小部件中才能显示。因此，请在您的代码中尝试以下更改：

```
from Tkinter import *
from PIL import Image, ImageTk

class GUI:

    def __init__(self, master):

        frame = Frame(master)
        frame.pack()

        #status bar
        self.bar = Frame(root, relief=RIDGE, borderwidth=5)
        self.bar.pack(side=TOP)

        self.iconPath = 'data/icons/size.png'
        self.icon = ImageTk.PhotoImage(Image.open(self.iconPath))
        self.icon_size = Label(self.bar)
        self.icon_size.image = self.icon  # <== this is were we anchor the img object
        self.icon_size.configure(image=self.icon)
        self.icon_size.pack(side=LEFT)

root = Tk()

app = GUI(root)

root.mainloop() 
```

祝你好运！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-03-12T12:11:56.747

对于所有未来的读者来说，就我而言，问题在于透明度。从图像中删除 alpha 通道修复了它。

# java - 除法时输出为零？

> ID：13148977
> 
> 赞同：1
> 
> 时间：2012-10-30T23:16:28.090
> 
> 标签：java, math, division

也许我看不到明显的东西，但是：

```
int x1 = 2;
int y1 = 4;
int x2 = 11;
int y2 = 7;
double res = (y2-y1)/(x2-x1);
System.out.println(res); 
```

输出：

```
0.0 
```

为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T23:17:43.640

问题是你正在做整数算术。您需要进行类型转换才能首先将分子或分母转换为浮点数（例如）：

```
int x1 = 2;
int y1 = 4;
int x2 = 11;
int y2 = 7;
double res = (double)(y2-y1)/(x2-x1);
System.out.println(res); 
```

如果您对整数进行除法，则结果将被截断为最接近的整数（产生与下限运算相同的结果）。例如：

```
0 / 2 == 0
1 / 2 == 0
2 / 2 == 1
3 / 2 == 1 
```

等等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:17:54.317

您需要最初将这些变量定义为双精度数，它应该可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T23:19:45.050

尝试

```
int x1 = 2;
int y1 = 4;
int x2 = 11;
int y2 = 7;
double res = (double)(y2-y1)/(x2-x1);
System.out.println(res); 
```

您必须在“同时”进行操作时将其装箱，而不是在之后

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T23:18:34.937

像下面这样转换`(y2-y1)/(x2-x1)`成双倍：

```
 int x1 = 2;
            int y1 = 4;
            int x2 = 11;
            int y2 = 7;
            double res = (double)(y2-y1)/(x2-x1);
            System.out.println(res);

Output: 0.3333333333333333 
```

# iphone - 什么时候应该向私有接口添加方法？

> ID：13148983
> 
> 赞同：3
> 
> 时间：2012-10-30T23:16:56.920
> 
> 标签：iphone, objective-c, ipad, cocoa-touch

所以我最近在我的类中使用了更多的私有接口。我一直在.h（公共）中保留其他类所需的东西，然后将所有其他方法保留在.m中的私有接口中。我的问题是，我看不出有任何理由在我的私有界面中保留任何方法，因为没有这个应用程序可以正常工作。真正的意义是什么？为什么私有接口中没有像 viewDidLoad 这样的系统方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T23:23:49.123

使用最新的 LLVM 编译器，在私有类别中添加方法声明已过时。过去，方法必须以正确的顺序实现，或者您可以在 .m 文件的私有类别中添加方法声明。最新的编译器不需要这样做。新编译器执行 2-pass 编译，因此它知道所有方法。

所以对你的问题的简短回答是 - 从不。:)

编辑：这是一些示例代码，以反映对此答案的持续讨论：

在 .h 文件中：

```
// Only public stuff here
@interface Foo
- (void)somePublicMethod;
@end 
```

在 .m 文件中：

```
// private additions - clients don't need to know about this stuff
@interface Foo () <UIActionSheetDelegate, UIPickerViewDelegate>
@property (nonatomic) UIPickerView *pickerView; // private property
@end

@implementation Foo {
    UIActioSheet *_myActionSheet; // private ivar
}

- (void)somePrivateMethod {
    [self anotherPrivateMethod]; // yeah - I can call methods further down in the class
}

- (void)anotherPrivateMethod {
}
@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:58:40.067

> 所以我最近在我的类中使用了更多的私有接口。我一直在.h（公共）中保留其他类所需的东西，然后将所有其他方法保留在.m中的私有接口中。

那很完美。在某些情况下，您会希望使用命名约定或前缀来避免命名冲突。继续……</p>

> 我的问题是，我看不出有任何理由在我的私有界面中保留任何方法，因为没有这个应用程序可以正常工作。真正的意义是什么？

[**封装**](http://en.wikipedia.org/wiki/Encapsulation_%28object-oriented_programming%29)。对您的客户（甚至子类）隐藏您的数据和实现，以尽量减少您必须进行的任何更改的副作用。如果客户端真的只需要公共接口中的 3 个方法——只声明这 3 个方法。将实现细节的其余部分保持为类的私有。当您不使用它时，突变实现往往会在客户端使用这些不必要的方法的地方成倍增加。这意味着当您需要更改某些内容时，您将需要查看多个源文件（和应用程序，如果您编写库）的大量细节。类的公共接口是一个专注于最小化的好领域。

> 为什么私有接口中没有像 viewDidLoad 这样的系统方法？

`viewDidLoad`被*设计*为在必要时被子类覆盖。它的声明是公开的，主要有两个原因：

*   文档。您的实现将需要此初始化步骤，并且您需要知道如何正确覆盖它。
*   因此，您可以编写`[super viewDidLoad]`，并且编译器可以确保您在做正确的事情。如果`UIViewController`没有将其声明为实例方法，则至少会有一个编译器警告。

# php - 同一模型上的 CakePHP (1.3) HABTM saveAll() 不工作

> ID：13148985
> 
> 赞同：0
> 
> 时间：2012-10-30T23:17:10.287
> 
> 标签：php, mysql, cakephp, has-and-belongs-to-many, cakephp-model

这看起来很简单，但我的头撞在墙上。

我有一个简单的 HABTM 关系（艺术家有许多艺术家），我试图保存一些数据。

我有两个表： **艺术家：**（id，name，created，modified） **artist_related：**（id，artist_id，related_id）

这是我的代码的样子，**models/artist.php**：

```
class Artist extends AppModel {
var $name = 'Artist';
var $hasAndBelongsToMany = array(        
    'Related' => array(            
        'className'     => 'Artist',
        'joinTable'     => 'artists_related',         
        'foreignKey'    => 'artist_id',
        'associationForeignKey' => 'related_id'
    )   
);  

function saveArtist($slug) {

    $data = array(
        'Artist' => array(
            'name' => 'Alicia Keys'
        ),
        'Related' => array(
            array(
                'name' => 'Mariah Carey'
            ),
            array(
                'name' => 'Beyoncé'
            )
        )
    );
$result = $this->saveAll($data); 
```

saveAll() 的结果是 1 行（Alicia Keys）被插入到艺术家表中。相关艺术家没有，并且没有任何内容插入到连接表中。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T05:03:41.907

我没有得到你想要做的事情，一旦通过这个链接，这可能会有所帮助

[http://book.cakephp.org/1.3/en/view/1034/Saving-Related-Model-Data-HABTM](http://book.cakephp.org/1.3/en/view/1034/Saving-Related-Model-Data-HABTM)

# c# - 如何在 MahApps.Metro 中添加 AnimatedTabControl？

> ID：13148987
> 
> 赞同：9
> 
> 时间：2012-10-30T23:17:19.207
> 
> 标签：c#, wpf, windows-8, mahapps.metro

我已经开始学习了`MahApps.Metro`。我阅读了文档并遇到了问题。如何添加`AnimatedTabControl`？

我已经包括`ResourceDictionaries`：

```
 <ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colours.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/Purple.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseDark.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/FlatButton.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.AnimatedTabControl.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.AnimatedSingleRowTabControl.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary> 
```

之后我开始开发窗口：

```
<Controls:MetroWindow x:Class="MyProject.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:Controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
        xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
        xmlns:behaviours="clr-namespace:MahApps.Metro.Behaviours;assembly=MahApps.Metro"
        Title="MyProject" ShowIconOnTitleBar="True" SaveWindowPosition="True" Height="350" Width="525">
    <Window.Resources>
        <ResourceDictionary Source="Styles\MetroStyles.xaml" />
    </Window.Resources>

    <Controls:MetroWindow.WindowCommands>
        <Controls:WindowCommands>
            <Button Content="about" />
            <Button Content="settings" />
        </Controls:WindowCommands>
    </Controls:MetroWindow.WindowCommands>

    <Grid>
        <Controls:TransitioningContentControl x:Name="Transitioning" Transition="RightReplaceTransition">

        </Controls:TransitioningContentControl>
    </Grid>
</Controls:MetroWindow> 
```

`Metro`窗口工作正常，但我不知道如何添加`AnimatedTabControl`......它不包含在`Controls:`命名空间中。

我想做这样的事情：
![标签](../Images/97b387e9a88571140f1d67314fcaa11d.png)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-31T03:43:12.000

您添加

```
<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.AnimatedTabControl.xaml" /> 
```

到

```
 <ResourceDictionary.MergedDictionaries> 
```

.xaml 顶部的元素，然后您的 TabControl 将被动画化（您仍然使用`TabControl`标签，但它将使用 Controls.AnimatedTabControl 样式..

这是整个 ResourceDictionary 标记的示例

```
 <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colours.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/Blue.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseLight.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.AnimatedTabControl.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Window.Resources> 
```

# regex - 包含不超过 1 个点的名称空间的 php 正则表达式

> ID：13148992
> 
> 赞同：0
> 
> 时间：2012-10-30T23:18:18.707
> 
> 标签：regex, netbeans

我在这样的代码仓库中有一堆调用：

```
$out = $this->call('myApp.Settings.Menus.something.doSomething', $input); 
```

我想使用正则表达式查找它的所有实例，其中第一个参数`$this->call()`仅包含一个句点。

我想，我越来越接近了：`(?=\$this->call\(')(\.){1}(?=',)`

为什么不限制为1期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T23:20:30.307

您正在寻找的是一个简单的：

```
 '[^.]+?[.][^.]+?' 
```

这意味着任意数量的非点，后跟一个点，然后又是一些非点。

更好的是，更精确一点：

```
 '\w+?([.]\w+?)?' 
```

这匹配字母数字字符和一个点。下半场`(`可选`)?`。

（你`(\.){1}`只会匹配一个时期。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:21:51.907

以下应该可以工作，命名空间将在第一个捕获组中：

```
\$this->call\('([^'.]*\.[^'.]*)', 
```

如果您想使用后向/前瞻，以便命名空间是正则表达式匹配的字符串的唯一部分，您可以使用以下内容：

```
(?<=\$this->call\(')[^'.]*\.[^'.]*(?=',) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T23:25:55.727

这是一个安全的正则表达式：

```
\$this\s*\-\>\s*call\s*\(\s*[\'\"]\.[\'\"] 
```

它解释了语言字符之间的空格，例如：

```
$this ->   call ( '.' 
```

它在技术上仍然是正确的语法。此外，这与将单引号或双引号字符串作为第一个参数无关。

# tooltip - nv.d3 触发工具提示页面多图同时出现

> ID：13148993
> 
> 赞同：3
> 
> 时间：2012-10-30T23:18:29.320
> 
> 标签：tooltip, nvd3.js

现在使用 nv.d3 示例中的stackedAreaChart()，当您将鼠标悬停在时间序列中的某个点上时，您会得到一个工具提示。

我已经垂直对齐了 3 个时间序列。如果鼠标悬停在其中任何一个点上，我想查看该对应点的每个图形的工具提示。

照片显示了当前的行为。

谢谢

![在此处输入图像描述](../Images/53a2b7be79bc024b75e886694bc42a8b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T15:30:35.713

我不确定是否要对其进行编码，但肯定应该是在指针位置链接 x 坐标，因此在`06/10/06 on graph one`显示工具提示时`06/10/06 on graphs one, two and three`

我不确定这会有多大帮助，只是把我的想法放在页面上。

谢谢，史蒂夫。

# java - 如何刷新 AudioRecord 对象中的缓冲区？

> ID：13148995
> 
> 赞同：3
> 
> 时间：2012-10-30T23:18:43.257
> 
> 标签：java, android, audio, media

我正在尝试从我的 android 设备上的麦克风获取非常准确的定时录音。我的想法是

```
while (true) {
  audioRecord.startRecording();
  sleep(0,nanoSeconds);
  audioRecord.flush();
  audioRecord.read(buf, 0, numSamples);
} 
```

但是没有`flush()`办法`AudioRecord`。所以也许我应该做

```
while (true) {
  sleep(0,nanoSeconds);
  audioRecord.startRecording();
  audioRecord.read(buf, 0, numSamples);
  audioRecord.stop();
} 
```

当然，我无法找到关于 what `startRecording()`, `read()`, and `stop()`do 的详细文档，以了解他们实际谈论缓冲区的位置。似乎没有任何方法可以调用来告诉我缓冲区中是否有样本。或者让我进行一个读取所有现有缓冲区的 read() 调用：我需要指定要读取的样本数，并且我的调用将阻塞，直到这些样本存在。

我很想有人告诉我这是在哪里更真实地记录下来。但几乎一样好，只要告诉我如果我真的想在一个非常准确确定的开始时间启动麦克风我应该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T00:11:42.010

在这种情况下，源代码可能比文档更有帮助。大多数 Android 的媒体类都是原生代码的薄包装。例如，method 方法简单地调用JNI[`startRecording()`层](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/android/media/AudioRecord.java#AudioRecord)[`android_media_AudioRecord_start()`](http://code.metager.de/source/xref/android/4.0.3/frameworks-base/core/jni/android_media_AudioRecord.cpp#257)，而 JNI 层又调用`start()`原生[AudioRecord 实例](http://code.metager.de/source/xref/android/4.0.3/frameworks-base/media/libmedia/AudioRecord.cpp#285)。除此之外，它还与硬件驱动程序交互，[`AudioFlinger`](http://code.metager.de/source/xref/android/4.0.3/frameworks-base/media/libmedia/AudioSystem.cpp#49)并最终与硬件驱动程序交互。硬件延迟几乎肯定会因设备而异，并且组件通常不是为高精度工作而设计的。

话虽如此，如果您可以对运行应用程序的硬件做出一些假设，那么阅读上面链接的本机代码可能会有所帮助。如果您愿意编写一些 C++ (JNI) 代码，您可以通过操作`AudioRecord`. 祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-09T20:48:14.870

从 API 级别 24 开始，您可以调用 AudioRecord.getAudioTimestamp() 以获取捕获管道中最早可用点的帧传递信息。因此，您可以在开始录制后比较时间戳，看看它们是否因睡眠间隔而不同。

有关详细信息，请参阅[文档](https://developer.android.com/reference/android/media/AudioRecord.html#getTimestamp(android.media.AudioTimestamp,%20int))。

# sql-server - SQL Reporting Services Express Edition 即使没有数据也很慢

> ID：13148997
> 
> 赞同：1
> 
> 时间：2012-10-30T23:18:48.883
> 
> 标签：sql-server, sql-server-2008, ssrs-2008, reporting-services

我试图弄清楚为什么我们的 SSRS 执行如此缓慢。主页大约需要 10 秒来加载/刷新，报告需要 12-15 秒才能呈现到“输入参数设置”阶段。

我创建了一个带有单个文本框的报告 - 没有数据连接 - 没有数据集 - 所以数据库访问为零，但仍然需要 12 秒才能呈现 - 没有数据库访问的单个文本框！报告引擎中的每一次点击都需要 12-15 秒的时间来响应——这使得处理真实数据非常痛苦。

数据库和 IIS 安装也包含在同一台机器上——但它们只能由几个用户访问（不公开）——所以机器的负载并不大。此框中的所有其他服务都在快速响应： IIS 安装正在快速响应地提供 Web 服务请求 - 在一瞬间。并且所有数据库查询都以非常快的速度运行 - 与此机器上的慷慨硬件一致。

它似乎与“第一个请求”的假脱机无关 - 这发生在所有请求上。

与 SSRS 速度问题相关的所有其他答案似乎都与数据库查询调整和参数处理有关——但这个“无数据”测试报告似乎指向 SSRS 安装/执行本身存在的问题。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T00:08:45.927

我会从服务器本地运行报告管理器，并启动任务管理器来监控服务器的活动，以识别可能的服务器资源问题并排除网络/客户端连接问题。

即使您使用的是没有 DataSource 的“虚拟”报表，IIS 仍然必须与 SQL Server 对话以获取报表元数据。我会检查以确保所有 SSRS 组件都通过使用特定 SQL 版本的[Reporting Services 配置工具相互通信。](http://msdn.microsoft.com/en-us/library/ms156305%28v=sql.100%29.aspx)

# ios - UICollectionViewFlowLayout UICollectionReusableView 装饰视图不显示

> ID：13148998
> 
> 赞同：2
> 
> 时间：2012-10-30T23:18:52.600
> 
> 标签：ios, uicollectionview

我试图`decoration view`在 UIViewController 的每一行后面显示一个。

每个“行”有 3 `UICollectionViewCells`。我想通过三个单元格行后面的装饰视图显示背景。

在`viewDidLoad:`我注册装饰视图：

```
[self.collectionView.collectionViewLayout registerClass:[CollectionRowDecorationView class] forDecorationViewOfKind:@"RowDecorationView"]; 
```

我还设置了以下委托方法：

```
- (UICollectionViewLayoutAttributes *)layoutAttributesForDecorationViewOfKind:(NSString *)decorationViewKind atIndexPath:(NSIndexPath *)indexPath
{
    UICollectionViewLayoutAttributes *layoutAttributes = [UICollectionViewLayoutAttributes layoutAttributesForDecorationViewOfKind:decorationViewKind withIndexPath:indexPath];
    layoutAttributes.frame = CGRectMake(0.0, 0.0, self.collectionView.contentSize.width, self.collectionView.contentSize.height);
    layoutAttributes.zIndex = -1;
    return layoutAttributes;
} 
```

不幸的是，委托方法没有被调用。阅读文档后，我不是 100% 清楚我需要做什么才能初始化装饰视图？看起来我缺少另一个需要调用的委托方法才能正确设置所有内容。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:38:18.017

您需要`- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect`像这样添加装饰视图：

```
[attributesArray addObject:[self layoutAttributesForDecorationViewOfKind:@"BackgroundView" atIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]]]; 
```