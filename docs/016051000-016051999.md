# StackOverflow 问答 16051000-16051999

# rebol - 使用带有解析的嵌套规则

> ID：16051003
> 
> 赞同：2
> 
> 时间：2013-04-17T03:34:25.593
> 
> 标签：rebol, rebol3

我正在尝试解析一些格式如下的数据。

```
data: [a b x b x x b a a x x b b x ] 
```

我需要它来按顺序提取 a 和 b 并为每个 a 和 b 执行不同的操作。

预期的输出将是：

```
a
b
b
b
a
a
b
b
== true 
```

到目前为止，我已经想出了这个，但是重复的 a 失败了。

```
parse data [
  some [
    thru 'a (print "a")
    some [
      any [
        to 'b (print "b")
      ]
      to 'a
    ]
  ]
  to end
] 
```

任何指针？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T04:56:56.827

我可能遗漏了一些东西……但这不是您想要的：

```
 parse data [
     any [
         thru ['a (print "a") | 'b (print "b")]
     ]
     to end
 ] 
```

这会生成您请求的输出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T05:05:52.913

```
>> data: [a b x b x x b a a x x b b x ]
== [a b x b x x b a a x x b b x]

>> parse data [ some [ 'a (print "a") | 'b (print "b") | skip ] ]
a
b
b
b
a
a
b
b
== true 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-17T05:00:53.897

它是`to`and `thru`，你真的不需要它们。让我们在这里利用 R3 而不要这样做。

```
parse data [
    some [
        'a (print "a")
        any [
            'b (print "b") |
            and 'a break |
            skip
        ]
    ]
    to end
] 
```

做了`and`一个前瞻，并且`break`打破了`any`规则。这可以让您在到达下一个循环的开头时停止内部循环。

`to`and`thru`会跳过你不想跳过的东西，而在`to 'b`你的代码中它实际上并没有做任何事情。你很幸运，`any`你包裹的循环`to 'b`在 R3 中被更改为如果它不前进就不会继续，因为它没有前进。

至于你的第一个问题，内部`some`应该`(print "a")`是一个`any`，使它成为可选的。不是可选的`some`，因此它不适用于`a`没有干预数据的运行。

PARSE 可能很棘手，但你会掌握它的窍门。

# joomla - Joomla - Get the specific Menu's Details / Parameter's

> ID：16051004
> 
> 赞同：1
> 
> 时间：2013-04-17T03:34:39.080
> 
> 标签：joomla, parameters, menu

I have a menu with the alias called "cooking-baking". I want to get the parameters of that menu. Below is the code am currently using.

```
$app    = JFactory::getApplication();
$menu   = $app->getMenu();
$menu   = $menu->getItems('menutype', 'cooking-baking'); 
```

Please do help me if you have any idea. I' am really stuck. thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T07:30:49.510

您非常接近，但使用别名作为过滤条件。菜单类型是您在管理的菜单管理器中定义的一组菜单项（主菜单、侧菜单等）。注意：第三个参数决定是否返回第一个匹配项。

```
$app      = JFactory::getApplication();
$menu     = $app->getMenu();
$menuItem = $menu->getItems('alias', 'cooking-baking', true); 
```

或多个属性：

```
$menuItem = $menu->getItems(array('alias', 'menutype'), array('cooking-baking', 'mainmenu'), true); 
```

请参阅[JMenu::getItems 文档](http://docs.joomla.org/JMenu%3a%3agetItems/11.1)

$menuItem 是一个包含数据（id、menutype、title、别名等）的对象。要获取参数，请访问`$menuItem->params`JRegistry[对象](http://docs.joomla.org/JRegistry%3a%3aget/11.1)。

因此，例如要获取`show_intro`该菜单项的参数，请使用

```
$show_intro = $menuItem->params->get('show_intro', $default = null); 
```

# c# - MVC3 Multi-Part Form Posting Issue

> ID：16051007
> 
> 赞同：0
> 
> 时间：2013-04-17T03:34:56.887
> 
> 标签：c#, asp.net-mvc-3, razor

I'm working on the following form

```
 @using (Html.BeginForm("BusinessMedia", "SmallBusiness", FormMethod.Post, new { enctype = "multipart/form-data" })){
        @Html.HiddenFor(m => m.Business.BusinessID)
        <div style="padding-right:850px">
            @Html.Label(" ", "First Picture:")
            <input type="file" name="BusinessPictures" id="FirstPicture" />
            @Html.Label(" ", "Second Picture:")
            <input type="file" name="BusinessPictures" id="SecondPicture" />
            @Html.Label(" ", "Third Picture:")
            <input type="file" name="BusinessPictures" id="ThirdPicture" />
            @Html.Label(" ", "Fourth Picture:")
            <input type="file" name="BusinessPictures" id="FourthPicture" />
            @Html.Label(" ", "Fifth Picture:")
            <input type="file" name="BusinessPictures" id="FifthPicture" />
            @Html.Label(" ", "Video:")
            <input type="file" name="BusinessVideo" id="Video" />
            <div style="padding-left:40%; padding-bottom:63px;">
                <p>
                    <input type="submit" class="btn btn-info" value="Upload Media" />
                </p>
            </div>
        </div>
    } 
```

and I cannot seem to understand why the BusinessID that is hidden in the form does not come through to the model in the controller. The files come through fine. This is the controller action.

```
 [HttpPost]
public ActionResult BusinessMedia(BusinessModel model, IEnumerable<HttpPostedFileBase> BusinessPictures, HttpPostedFileBase BusinessVideo)
{
    string VideoServerPath = Server.MapPath("~/videos/");
    string ImageServerPath = Server.MapPath("~/images/");
    if (model.SaveBusinessMedia(model, BusinessPictures, BusinessVideo, VideoServerPath, ImageServerPath))
        return PartialView("PostRentalSuccess", model);
    return PartialView("PostNewRental");
} 
```

Any ideas would be greatly appreciated.

Business Model Added

```
 public class BusinessModel
{
    public List<Business> RequestedBusinesses;
    public BusinessHour RequestedBusinessHours;
    public User User;
    public RentalContext _rc;
    public Business Business;
    public List<String> PictureLinks;

    public BusinessModel()
    {
        RequestedBusinesses = new List<Business>();
        RequestedBusinessHours = new BusinessHour();
        User = new User();
        _rc = new RentalContext();
        Business = new Business();
        PictureLinks = new List<string>();

    }

    public void LoadUser(int UserID)
    {
        User = (User)_rc.Users.Find(UserID);
    }

    public void ReturnBusinesses(int ServiceTypeID)
    {
        var BusinessesRequested = from b in _rc.Businesses
                                  where b.ServiceTypeID == ServiceTypeID
                                  select b;

        RequestedBusinesses = new List<Business>();
        foreach (var item in BusinessesRequested)
        {
            RequestedBusinesses.Add(item);
        }
    }

    public static Image ResizeImage(Image image, Size size)
    {

        int newWidth = size.Width;
        int newHeight = size.Height; 
        Image newImage = new Bitmap(newWidth, newHeight);
        using (Graphics graphicsHandle = Graphics.FromImage(newImage))
        {
            graphicsHandle.InterpolationMode = InterpolationMode.HighQualityBicubic;
            graphicsHandle.DrawImage(image, 0, 0, newWidth, newHeight);
        }
        return newImage;
    }

    public void PicturesForBusiness(int BusinessID)
    {
        var Pictures = from p in _rc.Pictures
                       where p.BusinessID.Value == BusinessID
                       select new { p.PictureLink };
        if (Pictures.Count() > 0)
            foreach (var item in Pictures)
                PictureLinks.Add(item.PictureLink);
    }

    public void LoadBusiness(int BusinessID)
    {
        Business = (Business)_rc.Businesses.Find(BusinessID);
        PicturesForBusiness(Business.BusinessID);
        ReturnBusinessHours(Business.BusinessID);
    }

    public void ReturnBusinessHours(int BusinessID)
    {
        var BusinessHoursRequested = from bh in _rc.BusinessHours
                                     where bh.BusinessID == BusinessID
                                     select bh;
        if (BusinessHoursRequested.Count() > 0)
            foreach (var item in BusinessHoursRequested)
                RequestedBusinessHours = item;
    }

    public bool SaveBusinessMedia(BusinessModel model, IEnumerable<HttpPostedFileBase> BusinessPictures, HttpPostedFileBase BusinessVideo, string VideoServerPath, string ImageServerPath)
    {
        int recordCount = 0;
        Image Resized;
        FileStream SmallPicture;
        model.LoadBusiness(model.Business.BusinessID);
        Business BusinessUser = (Business)from b in _rc.Businesses
                                          where b.BusinessID == model.Business.BusinessID
                                          select b;
        model.LoadUser(BusinessUser.UserID);
        int result = 0;
        try
        {
            if (BusinessPictures != null)
            {
                foreach (HttpPostedFileBase requestFile in BusinessPictures)
                {
                    if (requestFile.ContentLength > 0)
                    {
                        string fileName = Path.GetFileName(requestFile.FileName);
                        if (!Directory.Exists(ImageServerPath))
                        {
                            Directory.CreateDirectory(ImageServerPath);
                        }
                        string path = Path.Combine(ImageServerPath, fileName);
                        requestFile.SaveAs(path);
                        Picture Picture = new Picture();
                        Picture.BusinessID = model.Business.BusinessID;
                        Picture.Description = model.Business.Name;
                        Picture.PictureLink = "/images/" + fileName;
                        Picture.UploadedBy = model.User.UserID;
                        Picture.UploadedOn = DateTime.Now;
                        _rc.Pictures.Add(Picture);
                        recordCount++;
                        Resized = ResizeImage(Image.FromFile(path), new Size(75, 75));
                        string fileExt = fileName.Substring(fileName.IndexOf('.'), fileName.Count() - fileName.IndexOf('.'));
                        fileName.Remove(fileName.IndexOf('.'), fileName.Count() - fileName.IndexOf('.'));
                        path = Path.Combine(ImageServerPath, fileName + "_s" + fileExt);
                        Resized.Save(path, ImageFormat.Jpeg);
                        Picture.PictureLink = "/images/" + fileName;
                        _rc.Pictures.Add(Picture);
                        recordCount++;                                             
                    }
                }
            }

            if (BusinessVideo.ContentLength > 0)
            {
                string fileName = Path.GetFileName(BusinessVideo.FileName);
                if (!Directory.Exists(VideoServerPath))
                {
                    Directory.CreateDirectory(VideoServerPath);
                }
                string path = Path.Combine(VideoServerPath, fileName);
                BusinessVideo.SaveAs(path);
                Video Video = new Video();
                Video.BusinessID = model.Business.BusinessID;
                Video.Description = model.Business.Name;
                Video.VideoLink = "/videos/" + fileName;
                Video.UploadedBy = model.User.UserID;
                Video.UploadedOn = DateTime.Now;
                _rc.Videos.Add(Video);
                recordCount++;
            }
            result = _rc.SaveChanges();
            if (result == recordCount)
                return true;
            else
                return false;

        }
        catch (DbEntityValidationException e)
        {
            foreach (var eve in e.EntityValidationErrors)
            {
                Console.WriteLine("Entity of type \"{0}\" in state \"{1}\" has the following validation errors:",
                    eve.Entry.Entity.GetType().Name, eve.Entry.State);
                foreach (var ve in eve.ValidationErrors)
                {
                    Console.WriteLine("- Property: \"{0}\", Error: \"{1}\"",
                        ve.PropertyName, ve.ErrorMessage);
                }
            }
            throw;
        }
        catch (DbUpdateException e)
        {
            Console.WriteLine(e.Message);
            Console.WriteLine(e.Data);
            throw;
        }
    }
} 
```

}

# javascript - Catch and Modify XHR requests from Facebook with Chrome Extension

> ID：16051010
> 
> 赞同：1
> 
> 时间：2013-04-17T03:35:14.780
> 
> 标签：javascript, google-chrome, google-chrome-extension, xmlhttprequest

Trying to catch and modify XHR requests from Facebook.com. The exact request URL is

[https://www.facebook.com/ajax/composerx/attachment/link/scraper/?scrape_url=](https://www.facebook.com/ajax/composerx/attachment/link/scraper/?scrape_url=){A URL GOES HERE}.

Is this possible with a chrome extension? Searched everywhere to no avail.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:54:04.130

我相信你想要的是[http://developer.chrome.com/extensions/webRequest.html#event-onCompleted](http://developer.chrome.com/extensions/webRequest.html#event-onCompleted)

如果您想修改要发送的内容，那么我认为您想要的是注册 onBeforeRequest 处理程序。

# javascript - jQuery/Timeago - 不在火狐上工作

> ID：16051013
> 
> 赞同：0
> 
> 时间：2013-04-17T03:35:26.883
> 
> 标签：javascript, jquery, timeago

我在使用 Timeago 时遇到问题，想知道是否其他人也遇到了同样的问题，以及是否有人知道如何解决它。

Javascript：

```
jQuery(document).ready(function() {
  jQuery("time.timeago").timeago();
}); 
```

HTML：

```
<time class="timeago" datetime="2013-04-14 16:46:24z">Not working..</time> 
```

[http://jsfiddle.net/cRzLN/](http://jsfiddle.net/cRzLN/)

（在不同的浏览器上尝试 JSFiddle。）

基本上，我要做的就是使用 timeago。但是，它在 Firefox 中不起作用。它在 Chrome 中运行良好，但我想知道为什么它在 Firefox 中不起作用。

我没有使用最新版本的 timeago 或 jQuery，所以我都更新了它们，但这并没有帮助。

尝试切换 Javascript 的位置，似乎没有帮助。

任何帮助深表感谢。:D

非常感谢，雷麦肯齐

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T06:55:30.460

查看他们的示例并与您的标记进行比较。我发现**Z**是大写

```
<abbr class="timeago" title="2008-07-17T09:24:17Z">July 17, 2008</abbr> 
```

将您的代码更改为

```
 <time class="timeago" datetime="2013-04-14 16:46:24Z">Not working..</time> 
```

见[小提琴](http://jsfiddle.net/anpsmn/cRzLN/1/)

# python - pymongo - How to create/query by indices in GridFS

> ID：16051016
> 
> 赞同：1
> 
> 时间：2013-04-17T03:35:56.930
> 
> 标签：python, pymongo, gridfs

In my case I need to ensure the uniqueness of files via SHA1 (stored as the `filename`)

```
db = pymongo.MongoClient('localhost', 27017).test
gfs = gridfs.GridFS(db)

# How may I create a unique index in GridFS?
gfs.files.create_index([('filename', 1)], unique=True) 
```

And find the file by SHA1 if the file has already been stored.

```
sha1 = hashlib.sha1(file_content).hexdigest()
try:
    return gfs.put(file_content, filename=sha1)
except pymongo.errors.DuplicateKeyError:

    # How may I find files via criterion?
    return gfs.find( { 'filename': sha1 } )['_id'] 
```

Could anybody tell me how to do those things? Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:06:54.030

`_id`您可以手动为具有自身哈希值的文件提供密钥，而不是创建索引。

```
import pymongo 
db = pymongo.MongoClient('localhost', 27017).test
gfs = gridfs.GridFS(db)

def hash(file):
   #some code to extract hash of a file from its content..

file_hash = hash(file)
if gfs.exists(_id=file_hash):
    #file exists!
else:
    #file does not exist in the database.
    gfs.put(file, _id=file_hash) #or do something else.. 
```

[http://api.mongodb.org/python/current/api/gridfs/](http://api.mongodb.org/python/current/api/gridfs/)

# android - ClassCastException - 与 JSON 解析相关，不知从何而来

> ID：16051028
> 
> 赞同：0
> 
> 时间：2013-04-17T03:37:12.843
> 
> 标签：android, classcastexception

我的应用程序现在似乎运行良好了一段时间，突然间，当我运行通过 REST API 运行查询的应用程序的一部分时，我开始收到 ClassCastException。我不知道它是从哪里来的，也不知道为什么它现在突然出现，因为它正在工作，然后当我重新运行它以测试不同的搜索查询时，它遇到了错误。错误指向以下方法，特别是`try`块中的第一行 - `JSONObject resultsWrapper = (JSONObject) new JSONTokener(json).nextValue();`：

```
 private static void getResultsFromJson(String json) {
    try {
        JSONObject resultsWrapper = (JSONObject) new JSONTokener(json).nextValue(); 
        JSONArray  results        = resultsWrapper.getJSONArray("results");

        for (int i = 0; i < results.length(); i++) {
            JSONObject result = results.getJSONObject(i);

            String name = result.getString("from_user"); 
            String geo = result.getString("text");  

            VenueList.addVenue(name, geo);
        }
    } catch (JSONException e) {
        Log.e(TAG, "Failed to parse JSON.", e);
    }
} 
```

完全公开：`VenueList`是一个用于存储从结果返回的数据并且可全局访问的类。如果认为有必要，我可以发布代码。

报错还指向了下面的方法，和上面的在同一个Fragment中，具体是在哪里`getResultsFromJson(restResult)`调用的：

```
public void onRESTResult(int code, String restResult) { 
    if (code == 200 && restResult != null) {

        getResultsFromJson(restResult);
        mResults = VenueList.venueNames;
        setResults();           
    }
    else {
        Activity activity = getActivity();
        if (activity != null) {
            Toast.makeText(activity, "Failed to load Twitter data. Check your internet settings.", Toast.LENGTH_SHORT).show();
        }
    }
} 
```

最后，上面两个方法都在一个扩展以下Fragment的Fragment中，其中错误专门指向`onRESTResult(resultCode, resultData.getString(RESTService.REST_RESULT));'：

```
public abstract class RESTResponderFragment extends Fragment {

private ResultReceiver mReceiver;

public RESTResponderFragment() {
    mReceiver = new ResultReceiver(new Handler()) {

        @Override
        protected void onReceiveResult(int resultCode, Bundle resultData) {
            if (resultData != null && resultData.containsKey(RESTService.REST_RESULT)) {
                onRESTResult(resultCode, resultData.getString(RESTService.REST_RESULT));
            }
            else {
                onRESTResult(resultCode, null);
            }
        }

    };
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setRetainInstance(true);
}

public ResultReceiver getResultReceiver() {
    return mReceiver;
}

abstract public void onRESTResult(int code, String result);
} 
```

这是完整的错误日志：

```
04-16 22:20:16.270: E/AndroidRuntime(17906): FATAL EXCEPTION: main
04-16 22:20:16.270: E/AndroidRuntime(17906): java.lang.ClassCastException: java.lang.String
04-16 22:20:16.270: E/AndroidRuntime(17906):    at com.example.blobtag2.fragment.FactualResponderFragment.getResultsFromJson(FactualResponderFragment.java:152)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at com.example.blobtag2.fragment.FactualResponderFragment.onRESTResult(FactualResponderFragment.java:106)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at com.example.blobtag2.fragment.RESTResponderFragment$1.onReceiveResult(RESTResponderFragment.java:23)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at android.os.ResultReceiver$MyRunnable.run(ResultReceiver.java:43)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at android.os.Handler.handleCallback(Handler.java:587)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at android.os.Handler.dispatchMessage(Handler.java:92)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at android.os.Looper.loop(Looper.java:150)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at android.app.ActivityThread.main(ActivityThread.java:4358)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at java.lang.reflect.Method.invokeNative(Native Method)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at java.lang.reflect.Method.invoke(Method.java:507)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
04-16 22:20:16.270: E/AndroidRuntime(17906):    at dalvik.system.NativeStart.main(Native Method) 
```

这发生在我收到有关项目无法构建的错误的同时 - “构建期间发生错误。在项目上运行构建器'Android Package Builder'时出错”。

让我知道是否有任何其他可能有用的代码。真的很困惑，因为这完全是凭空出现的，希望任何人都可以了解如何解决这个问题和/或它为什么会发生。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T03:44:09.730

nextValue 返回 JSONObject、JSONArray、String、Boolean、Integer、Long、Double 或 NULL。

所以它并不总是一个 JSONObject。如果它是其他类型之一，那就是非法演员。

我处理 JSON 的常规方法总是将字符串直接传递到 JSONObject 中，然后解析 JSONObject。但是，如果您期望长字符串，那将是低效的。如果要使用分词器，则需要通过 instanceof 检查数据类型。

# c# - 在文件夹中查找名称相同但扩展名不同的文件

> ID：16051029
> 
> 赞同：3
> 
> 时间：2013-04-17T03:37:16.017
> 
> 标签：c#, .net, file-io, compact-framework2.0

我有一个 FTP 服务器，它将客户端发送/上传的文件存储在某个文件夹中。客户端将上传 3 个名称相同但扩展名不同的文件。例如，客户端将发送file1.ext1、file1.ext2 和file1.ext3。我正在寻找一段代码，它可以帮助我找到具有相同名称（“file1”）的文件，然后压缩它们。任何帮助表示赞赏。我编写了这段代码，它获取文件夹中所有文件的名称：

```
string path = "somepath";
String[] FileNames = Directory.GetFiles(path); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T04:56:29.087

在对 的调用中使用星号通配符作为文件扩展名`GetFiles`，例如：

```
 List<string> files = Directory.GetFiles(pathName, "SpecificFileName.*"); 
```

或者：

```
 string[] files = Directory.GetFiles(pathName, "SpecificFileName.*"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T05:03:30.710

这很简单：

```
string path = "somepath";
String[] FileNames = Directory.GetFiles(path); 
```

您可以使用 LINQ 按名称对文件进行分组，无需扩展名：

```
var fileGroups = from f in FileNames
    group f by Path.GetFileNameWithoutExtension(f) into g
    select new { Name = g.Key, FileNames = g };

// each group will have files with the
// same name and different extensions
foreach (var g in fileGroups)
{
    // initialize zip file
    foreach (var fname in g.FileNames)
    {
        // add fname to zip
    }
    // close zip file
} 
```

## 更新

如果您没有 LINQ，这项任务并不会变得更加困难。首先，您要对文件进行排序：

```
Array.Sort(FileNames); 
```

现在，您有一个按文件名排序的文件列表。因此，例如，您将拥有：

```
file1.ext1
file1.ext2
file1.ext3
file2.ext1
file2.ext2
etc... 
```

然后只需浏览列表，将具有相同基本名称的文件添加到 zip 文件中，如下所示。请注意，我不知道您是如何创建 zip 文件的，所以我只是编写了一个简单的`ZipFile`类。你当然需要用你正在使用的任何东西替换它。

```
string lastFileName = string.Empty;
string zipFileName = null;
ZipFile zipFile = null;
for (int i = 0; i < FileNames.Length; ++i)
{
    string baseFileName = Path.GetFileNameWithoutExtension(FileNames[i]);
    if (baseFileName != lastFileName)
    {
        // end of zip file
        if (zipFile != null)
        {
            // close zip file
            ZipFile.Close();
        }
        // create new zip file
        zipFileName = baseFileName + ".zip";
        zipFile = new ZipFile(zipFileName);
        lastFileName = baseFileName;
    }
    // add this file to the zip
    zipFile.Add(FileNames[i]);
}
// be sure to close the last zip file
if (zipFile != null)
{
    zipFile.Close();
} 
```

不知道 Compact Framework 有没有这个`Path.GetFileNameWithoutExtension`方法。如果没有，那么您可以通过以下方式获取不带扩展名的名称：

```
string filename = @"c:\dir\subdir\file.ext";
int dotPos = filename.LastIndexOf('.');
int slashPos = filename.LastIndexOf('\\');
string ext;
string name;
int start = (slashPos == -1) ? 0 : slashPos+1;
int length;
if (dotPos == -1 || dotPos < slashPos)
    length = filename.Length - start;
else
    length = dotPos - start;
string nameWithoutExtension = filename.Substring(start, length); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:39:50.977

你可以试试下面的代码。如果文件名本身有任何点，这也将解决。

```
 string[] fileNames = Directory.GetFiles(path);

        List<string> fileNamesWithoutExtension = new List<string>(); 
        List<string> myFiles = new List<string>();

        string myFile = mySearchFileWithoutExtension;

        foreach (string s in fileNames)
        {
            char[] charArray = s.ToCharArray();

            Array.Reverse(charArray);
            string s1 = new string(charArray);

            string[] ext = s1.Split(new char[] { '.' }, 2);

            if ((ext.Length > 1))
            {
                char[] charArray2 = ext[1].ToCharArray();

                Array.Reverse(charArray2);

                fileNamesWithoutExtension.Add(new string(charArray2));

                if ((new string(charArray2)).Trim().Equals(myFile))
                {
                    myFiles.Add(s);
                }
            }
        } 
```

不带扩展名的文件列表：fileNamesWithoutExtension

您需要的文件集：myFiles

# android - PHP 到 ASP.NET 代码迁移

> ID：16051030
> 
> 赞同：2
> 
> 时间：2013-04-17T03:37:20.507
> 
> 标签：android, asp.net-mvc

我正在将图像从我的 android 上传到我的网络服务器。我的 Web 服务器是用 ASP.NET MVC 编写的。

我可以在 android 上使用 HttpPost 上传我的图像，然后使用以下 php 代码：

```
$base=$_REQUEST['image'];
$binary=base64_decode($base);
header('Content-Type: bitmap; charset=utf-8');
$file = fopen('App_Data/Image.jpg', 'wb');
fwrite($file, $binary);
fclose($file); 
```

我的问题是，是否可以将其转换为我的 ASP.NET MVC？我觉得使用 php 非常有限，因为我不确定如何做一些我可以在 ASP.NET 中做的事情。

我了解 ASP.NET 中的 Request 方法，但我不确定如何执行 base64_decode 部分。

PS。有关所用方法的更多信息，请参阅[此链接](http://www.coderzheaven.com/2011/04/25/android-upload-an-image-to-a-server/)

**编辑：** android部分的代码

这部分转换位图并base64对其进行编码

```
Bitmap bitmap = BitmapFactory.decodeFile(Environment.getExternalStorageDirectory().getAbsolutePath()+"/saved_images/2013-04-10--11-51-33-AEST--Fingerprint.jpg");          
            ByteArrayOutputStream stream = new ByteArrayOutputStream();
            bitmap.compress(Bitmap.CompressFormat.PNG, 90, stream); //compress to which format you want.
            byte [] byte_arr = stream.toByteArray();
            String image_str = Base64.encodeBytes(byte_arr);
            ArrayList<NameValuePair> nameValuePairs = new  ArrayList<NameValuePair>();
            nameValuePairs.add(new BasicNameValuePair("image",image_str)); 
```

这部分做post

```
 HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://myipaddress/Up/Upload");
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        HttpResponse response = httpclient.execute(httppost); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T03:53:33.123

在 MVC 中上传文件非常简单，只需使用以下示例：

形式：

```
<form action="controller\UploadImage" method="post" enctype="multipart/form-data">

  <label for="file">Filename:</label>
  <input type="file" name="file" id="file" />

  <input type="submit" />
</form> 
```

不要忘记`enctype="multipart/form-data"`启用文件编码。

然后在您的控制器中执行以下操作：

```
[HttpPost]
public ActionResult UploadImage(HttpPostedFileBase file) {

  if (file.ContentLength > 0) {
    var fileName = Path.GetFileName(file.FileName);
    var path = Path.Combine(Server.MapPath("~/App_Data/uploads"), fileName);
    file.SaveAs(path);
  }

  return RedirectToAction("Index");
} 
```

*编辑：* 基于以下博客文章：[http ://blog.tacticalnuclearstrike.com/2010/01/using-multipartentity-in-android-applications/](http://blog.tacticalnuclearstrike.com/2010/01/using-multipartentity-in-android-applications/)

> 为了能够从 Android 应用程序上传文件并使用 Multipart 内容类型，您需要向应用程序添加一些额外的 jar 文件。
> 
> 需要的文件是[apache-mime4j](http://james.apache.org/mime4j/)、[httpclient、httpcore 和 httpmime](http://hc.apache.org/downloads.cgi)。都是 Apache 基金会构建的开源项目。
> 
> 下载这 4 个文件并将它们添加到您的项目中，然后您应该能够使用以下代码将字符串和文件发布到页面。

这是代码示例：

```
HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost("http://www.tumblr.com/api/write");

try {
  MultipartEntity entity = new MultipartEntity();

  entity.addPart("type", new StringBody("photo"));
  entity.addPart("data", new FileBody(image));
  httppost.setEntity(entity);
  HttpResponse response = httpclient.execute(httppost);
} catch (ClientProtocolException e) {
} catch (IOException e) {
} 
```

> 在这种情况下，**图像**变量是一个文件，其中包含手机上的摄像头捕获的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T23:37:38.290

所以因为我使用的是 base64 编码方法，所以它不起作用。不得不更改我的攻击计划并使用[此答案中显示的 MultipartEntity 方法。](https://stackoverflow.com/questions/7632737/android-send-a-image-and-save-url/7632849#7632849)

还必须下载 apache-mime4j、httpclient、httpcore 和 httpmime。它现在正在工作:-)

感谢您的帮助 Mortalus。

# mfc - 在 MFC 中请求 CList Find 功能

> ID：16051037
> 
> 赞同：0
> 
> 时间：2013-04-17T03:38:15.537
> 
> 标签：mfc, clist

我创建结构如下

```
struct DoubleListDataNode
{
INT         nSequenceID;
DOUBLE          fTemp;
DOUBLE          fHumi;
INT         nTimeHour;
INT         nTimeMiin;
INT         nTS1;
INT         nTS2;
}; 
```

我创建了一个列表

```
typedef CList<DoubleListDataNode *, DoubleListDataNode *> listDoubleListDataNode; 
```

我创建公共变量

```
listDoubleListDataNode  gDoubleListDataNode;
DoubleListDataNode      *pDoubleListDataNode; 
```

现在，我在列表中有数据

```
1 1.00 2.00 001H01M 1 2
2 1.00 2.00 002H01M 1 2
3 3.00 4.00 003H02M 3 4
4 3.00 4.00 004H02M 3 4
5 5.00 6.00 005H03M 5 6
6 5.00 6.00 006H03M 5 5 
```

如何在 CList 中使用 Find 功能来查找 nSequenceID = 1 或 5 ？

没有 findindex(0) 和 findindex(5)

我尝试 gDoubleListDataNode(1, ...)，但它不起作用

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:24:24.937

CList 类的 Find() 方法的实现是它使用 == 运算符比较元素。在您的情况下，元素是指向结构的指针。Find() 将仅尝试将元素的地址与您传递给它的参数匹配。

这意味着在当前设计中，如果不将 gDoubleListDataNode 中每个元素的地址存储在单独集合中的某个位置，您将无法定位该元素，即使您`operator==`为结构定义了相等性也是如此。

你有两个选择。

1.  您可以将列表定义为`typedef CList<DoubleListDataNode, DoubleListDataNode&> listDoubleListDataNode;`. 当你这样做时，你将不得不用元素而不是指针来填充它。但是，对于您的`struct DoubleListDataNode`，您必须定义`operator=`和`operator==`。当您定义后者时，您可以实现它将使用 nSequenceID

2.  您可以使用 CMap，而不是使用 CList。将其定义为`typedef CMap<int, int&, DoubleListDataNode *, DoubleListDataNode *> mapDoubleListDataNode;`这样，您将能够使用 MFC 哈希表的强大功能在地图中快速定位所需元素。不过需要注意的是：地图中的值将是唯一的

# c# - 优化检查结果是否有值的 LINQ 查询

> ID：16051048
> 
> 赞同：-1
> 
> 时间：2013-04-17T03:39:00.697
> 
> 标签：c#, database, linq

我有 LINQ 查询检查查询结果并结束语句。该数据库有大约 600k 数据。下面是 LINQ 查询和 if 语句。

```
 var feetypelist = from feetype in dbDataContext.tbl_fee_types
                          orderby feetype.seq
                          select feetype.id;

        foreach (var fty in feetypelist)
        {
            var checkFeeCharges = from fee in dbDataContext.tbl_fee_schedules
                                  where fee.arr == arr && fee.dep == dep && fee.feetypeid == fty && fee.site_id == siteId
                                  orderby fee.seq
                                  select fee;

            if (checkFeeCharges.Count() == 0)
            {
                checkFeeCharges = from fee in dbDataContext.tbl_fee_schedules
                                  where fee.arr == arr && fee.dep == dep && fee.feetypeid == fty && fee.site_id == siteId
                                  && fee.country == country
                                  orderby fee.seq
                                  select fee;
            }

            if (checkFeeCharges.Count() == 0)
            {
                checkFeeCharges = from fee in dbDataContext.tbl_fee_schedules
                                  where fee.site_id == siteId && fee.country == country && 
                                  ((fee.arr == arr && fee.dep == dep) || (fee.arr.Equals("DOM") && fee.dep.Equals("DOM")) ||
                                  (fee.arr.Equals("*") && fee.dep == dep) || (fee.arr == arr &&  fee.dep.Equals("*")))
                                  && fee.feetypeid == fty
                                  orderby fee.seq
                                  select fee;

                if (checkFeeCharges.Count() == 0)
                {
                    var country_route = from route in dbDataContext.tbl_country_routes
                                        where route.origin_airport_cd == arr && route.destination_airport_cd == dep
                                        select route;

                    if (country_route.Count() >= 1)
                    {
                        foreach (var c in country_route)
                        {
                            if (c.air_asiax == 'Y')
                            {
                                //con_flight = "Y";
                                checkFeeCharges = from fee in dbDataContext.tbl_fee_schedules
                                                  where fee.site_id == siteId && fee.country == country &&
                                                  ((fee.arr == "AAX" && fee.dep == "AAX") || (fee.arr == "*" && fee.dep == dep) ||
                                                  (fee.arr == arr && fee.dep == "*")) && fee.feetypeid == fty
                                                  orderby fee.seq
                                                  select fee;

                                if (checkFeeCharges.Count() == 0)
                                {
                                    checkFeeCharges = from fee in dbDataContext.tbl_fee_schedules
                                                      where fee.site_id == siteId && fee.country == country &&
                                                      ((fee.arr == arr && fee.dep == dep) || (fee.arr == "INT" && fee.dep == "INT") ||
                                                      (fee.arr == "*" && fee.dep == dep) || (fee.arr == arr && fee.dep == "*") ||
                                                      (fee.arr == country && fee.dep == country)) &&
                                                      fee.feetypeid == fty
                                                      orderby fee.seq
                                                      select fee;
                                }
                            }
                            else
                            {
                                checkFeeCharges = from fee in dbDataContext.tbl_fee_schedules
                                                  where fee.site_id == siteId && fee.country == country &&
                                                  ((fee.arr == arr && fee.dep == dep) || (fee.arr == "INT" && fee.dep == "INT") ||
                                                  (fee.arr == "*" && fee.dep == dep) || (fee.arr == arr && fee.dep == "*") ||
                                                  (fee.arr == country && fee.dep == country)) &&
                                                  fee.feetypeid == fty
                                                  orderby fee.seq
                                                  select fee;
                            }

                        }
                    }
                    else
                    {
                        checkFeeCharges = from fee in dbDataContext.tbl_fee_schedules
                                          where fee.site_id == siteId && fee.country == country &&
                                          ((fee.arr == arr && fee.dep == dep) || (fee.arr == "INT" && fee.dep == "INT") ||
                                          (fee.arr == "*" && fee.dep == dep) || (fee.arr == arr && fee.dep == "*")) &&
                                          fee.feetypeid == fty
                                          orderby fee.seq
                                          select fee;
                    }
                }
            }

            if (checkFeeCharges.Count() == 0)
            {
                checkFeeCharges = from fee in dbDataContext.tbl_fee_schedules
                                  where fee.site_id == siteId && fee.country == country &&
                                  ((fee.arr == arr && fee.dep == dep) || (fee.arr == "INT" && fee.dep == "INT") ||
                                  (fee.arr == "*" && fee.dep == dep) || (fee.arr == arr && fee.dep == "*")) &&
                                  fee.feetypeid == fty
                                  orderby fee.seq
                                  select fee;
            } 
```

查询执行需要一段时间才能完成，知道如何优化此查询。

返回 json 请求

```
if (checkFeeCharges.Any())
            {
                List<FeeAndChargesModel_Fee_Schedule> feeTable = new List<FeeAndChargesModel_Fee_Schedule>();
                foreach (var p in checkFeeCharges)
                {
                    feeTable.Add(
                        new FeeAndChargesModel_Fee_Schedule()
                        {
                            arr = FlightScheduleAPIController.GetCountryName(arr, siteId),
                            dep = FlightScheduleAPIController.GetCountryName(dep, siteId), 
                            country = p.country,
                            feedesc = p.feedesc,
                            feetype = p.feetype,
                            currency = p.currency,
                            value = p.value,
                            remark = p.remark
                        }
                    );
                    label = p.feetype;

                }

                mainJson.Add(
                        new FeeAndChargesModel_Main
                        {
                            label = label,
                            con_flight = FlightScheduleAPIController.GetCountryName(GetConnectingFlight(dep, arr), siteId),
                            details = feeTable
                        }
                        );
            }
        }

        return mainJson; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:25:29.533

好的，所以这段代码真的很难阅读，但让我们给你一些建议。

我注意到的第一件事是执行了第一个 sql 语句

```
var checkFeeCharges = from fee in dbDataContext.tbl_fee_schedules
                              where fee.arr == arr && fee.dep == dep && fee.feetypeid == fty && fee.site_id == siteId
                              orderby fee.seq
                              select fee; 
```

如果它什么都不返回

```
 if (checkFeeCharges.Count() == 0)
        { 
```

它执行一个比第一个更具体的 sql 查询。它具有所有相同的 AND 语句 + 另一个。如果第一个查询什么都不返回，那么期望（所有东西都是不变的）应该是第二个什么都不返回。如果是这样，那为什么要这样做？

```
 checkFeeCharges = from fee in dbDataContext.tbl_fee_schedules
                              where fee.arr == arr && fee.dep == dep && fee.feetypeid == fty && fee.site_id == siteId
                              && fee.country == country
                              orderby fee.seq
                              select fee;
        } 
```

我个人会尝试理解或解决以下问题

**1** 预期的结果集大小是多少，我是否可以检索“少量”记录并在内存中处理这些记录。我需要了解结果集是否会随着时间及其最小、最大类型边界而增长。

**2** 是否有更好的数据库结构，我可以重构要使用的代码，这将使该查询更容易和更有效。

**3** 为了真正能够优化这个查询，我会尝试先直接在 sql 中编写它并使用 explain 来帮助准确了解 sql 数据库在做什么，正在使用哪些索引以及返回的结果集的大小每个查询。

. 我也相信您应该能够将您拥有的许多查询组合成一个表达式。

这可能不完全正确，但应该可以作为演示

```
from fee in dbDataContext.tbl_fee_schedules
where (fee.arr == arr && fee.dep == dep && fee.feetypeid == fty && fee.site_id == siteId
    && fee.country == country) || (fee.site_id == siteId && fee.country == country &&
                                              ((fee.arr == "AAX" && fee.dep == "AAX") || (fee.arr == "*" && fee.dep == dep) ||
                                              (fee.arr == arr && fee.dep == "*")) && fee.feetypeid == fty)
|| ( ..... ) | ( .... ) 
```

从我在那里看到的情况来看，您将需要几个连接或子选择，这就是为什么在 sql 中尝试它会最快的原因。还有一些 linq2sql/ORM 分析工具可能有助于诊断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:14:29.670

很难说如何优化它，因为这里有很多重复。我会先尝试减少这种情况。

一件明显需要改变的事情是：

```
if (checkFeeCharges.Count() == 0) 
```

每次调用它时都会枚举整个查询。检查同一件事的更便宜的方法：

```
if (!checkFeeCharges.Any()) 
```

这只会从查询中枚举一个结果以确定它是否为空。

# git - 是否可以使用一个 git 存储库来管理多个 git 存储库？

> ID：16051049
> 
> 赞同：1
> 
> 时间：2013-04-17T03:39:05.510
> 
> 标签：git

我在名为的远程服务器中只有一个 git repo，例如`allinone`，但我实际上有几个项目，例如，，`proj1`我将所有这些项目存储到，如下所示：`proj2``proj3``allinone`

```
allinone
 |- .git
 |-  proj1/
 |-  proj2/
 |-  proj3/ 
```

事情是这样的（如果可能的话）：

1.  我创建了`allinone`git repo
2.  我创建了`proj1`git repos，进行了一些开发、提交和完成。
3.  我在repo中创建了一个`proj1`分支，并将所有提交日志**“导入”**到'分支中。`allinone` **`proj1``allinone``proj1`**
***   proj2、proj3 也一样。*   稍后我可以签出 proj1 分支到一个独立的目录。**

 **可能吗？或者有什么建议吗？我不想再买一个回购。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:18:03.870

Git 本身并不要求存储库中的分支之间存在任何关系。因此，您可以创建任意数量的本地存储库，并将所有这些推送到单个远程存储库。如果您仔细设置每个本地存储库使用的 refspecs，它甚至可能看起来非常像您为每个本地存储库拥有单独的远程。

但是，您使用的任何提供商都可能会检查该类型的使用，特别是如果他们按存储库收费。

如果您找到一种方法为每个项目拥有一个单独的远程存储库，那么您遇到问题的可能性就会大大降低。git wiki 有一个[托管站点列表](https://git.wiki.kernel.org/index.php/GitHosting)，其中一些将允许免费托管私有存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:12:27.483

这是糟糕的架构。通过这种方式管理你的回购，你正在自杀。

我发现每个项目都没有超过一个 repo 的正当理由。

我只能想象必须不断合并所有这些 repo 以保持更新是什么感觉。

在我看来，您应该为每个“项目”创建一个单独的分支，这样您就可以更轻松地维护历史记录、工作流程并减少合并。然而，即使这样也是有缺陷的，因为无论你做什么，你都必须在你的项目中留下一个很大的合并冲突的机会。如果我是你，我会尽我所能减少你的“allinone”回购，并在你做与某​​个“项目”相关的工作时通过检查功能分支来管理它。

祝你好运！**

# rest - REST API 设计指南

> ID：16051051
> 
> 赞同：2
> 
> 时间：2013-04-17T03:39:13.300
> 
> 标签：rest, api-design

我正在为我们的 REST 接口设计一个公共 API。出现的一件事是使用 http 动词，特别是 DELETE 动词。

我们希望公开启动/停止或执行/中止特定作业的方法。这两种API设计的两种风格是：

**邮政**

```
http://localhost/api/campaignrun/1 
```

执行 id 为 1 的活动

**删除**

```
http://localhost/api/campaignrun/1 
```

中止 id 为 1 的广告系列运行

或者...

**邮政**

```
http://localhost/api/campaignrun/1

{ action=execute} 
```

执行 id 为 1 的活动

**邮政**

```
http://localhost/api/campaignrun/1

{ action=abort } 
```

中止 id 为 1 的活动

如果有我最喜欢的，哪一个更 RESTful？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T09:41:23.680

在您的两个设计之间进行选择，**我会投票给您的第二个**，它使用`POST`，但稍作修改：`PUT`改用：

```
PUT http://localhost/api/campaignrun/1

{ action: abord } 
```

这个 API 清楚地说明了它的意图：你有`campaignruns`（最好保留这个**复数**），你想要有 的campainrun `{id} = 1`，并且该资源有一个名为 action 的属性，我想**更新**它。

这样，您的 API 与http 动词的[幂等](http://en.wikipedia.org/wiki/Idempotence)`PUT`性保持一致：应该是幂等的，`POST`不应该是幂等的。对于您的情况，这意味着无论用户点击上述请求多少次，结果都是相同的：id=1 的活动运行将被中止。

*注意*：我看到您已经接受了在 URI 处提出动词的答案，然后使用`POST`它们。这篇文章不是支持或反对 REST 的地方，但由于您的问题是关于*哪种设计更 RESTful*，您应该三思而后行。您可能想查看这本非常不错的 38 页免费[电子书](https://blog.apigee.com/detail/announcement_new_ebook_on_web_api_design/)，其中介绍了设计 API 的最佳实践。除其他外，它建议*将动词放在基本 URL*之外，除非在极少数情况下。检查一下，它会证明有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T03:54:30.167

第一个是更“宁静”。您将遇到的唯一问题是您是否需要删除而不是中止将来运行的广告系列。如果您将来需要活动运行删除记录功能，您可以随时将操作传递给 DELETE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:40:28.817

如果你可以使用 DELETE，那就太好了。但是，只有在停止活动运行意味着客户端不应再次访问该资源（该特定 URL）时，您才应该这样做。如果合理地期望客户端在之后与资源交互，请使用 POST（或 PUT 到子资源，当然）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T04:52:44.917

是否可以重新启动已停止的作业？如果是这样，我建议您使用，`POST`因为您并没有真正删除任何资源。但是，您可以更改 url 以更好地指示您要实现的目标：

**邮政**

```
http://localhost/api/campaignrun/1/start 
```

和

**邮政**

```
http://localhost/api/campaignrun/1/stop 
```

因此，不需要提供请求主体来指示操作的类型。

旁注：对我来说`DELETE`，表示该活动将被永久删除，因此无法重新启动。因此，如果客户端尝试访问资源，将返回 404。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-02T08:58:47.317

正如许多人在这里所说，删除资源意味着相关的*活动*不再可访问（404 Not Found 应该在之后返回）。我猜这不是中止*竞选活动*的意图。

以下将更符合问题中提到的任何替代方案的 REST：

## 邮政

```
http://localhost/api/campaignruns 
```

注意复数名词（更 RESTful，collection->instance->collection->instance...）。

此请求创建一个*活动运行*。比方说，*campaignrun*创建的 ID 是 1。

## 邮政

```
http://localhost/api/campaignruns/1/operations

{
    "operation": "execute"
} 
```

## 邮政

```
http://localhost/api/campaignruns/1/operations

{
    "operation": "abort"
} 
```

*   *操作*API 支持以下HTTP 方法：*GET、POST*
*   *操作*API 可能被实现为异步调用（返回 202 Accepted）。

假设*中止*操作 ID 为 2。

这是它在**POST**之后的显示方式（假设是异步操作） ：

## 得到

```
http://localhost/api/campaignruns/1/operations/2

Response:

{
    "id": 2,
    "operation": "abort",
    "status": "processing"
} 
```

完成后的外观如下：

## 得到

```
http://localhost/api/campaignruns/1/operations/2

Response:

{
    "id": 2,
    "operation": "abort",
    "status": "completed"
} 
```

# scheme - 我似乎无法在方案中找到换行符匹配字符

> ID：16051054
> 
> 赞同：0
> 
> 时间：2013-04-17T03:39:31.957
> 
> 标签：scheme, newline

我正在尝试在文件中找到换行符并使用计数器跟踪它到目前为止我有

srcf 是源文件

```
(if(equal? (peek-char srcf) (#\newline) )

  (begin

    (read-char srcf)
    (Lines srcf (+ Line 1))
  )

  (begin

    (read-char srcf)
    (Lines srcf Line)                       
  )
) 
```

但是我知道我的平等吗？(peek)(#\newline) 不起作用是否有我可以用于换行符的字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T03:45:58.547

确切的字符取决于文件中使用的换行符，它可能是`\n`（如 Unix / Mac 中文件的规范）或`\r\n`（通常在 Windows 中找到）。对于初学者，请尝试比较`#\newline`并查看它是否适合您：

```
(equal? (peek-char srcf) #\newline) 
```

...注意*没有*`#\newline`被括号包围！

# node.js - 使用中间件后 req 不可读

> ID：16051055
> 
> 赞同：1
> 
> 时间：2013-04-17T03:39:37.857
> 
> 标签：node.js, express, passport.js

我正在尝试使用在 node.js 版本 0.8.2 上运行的护照来保护我的 API 端点。我拥有的控制器功能如下所示：

```
exports.create = function(req, res) {
    console.log('Request readable? ' + req.readable);

    ... stream blob in req to create blob ...
}; 
```

当没有中间件来验证传入请求并且“请求可读？真”被打印到控制台时，这非常有用。

当我引入中间件来验证传入请求时，请求在我的控制器中不再可读。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T15:01:57.780

在这种情况下发生的事情是，我正在调用以异步方式从数据库中获取 accessToken，并且在此间隙中，当流不可读时：

```
// req.readable == true here

auth(req, res, function(err) {
    // req.readable == false here 
```

在这种情况下你需要做的是暂停和恢复请求流：

```
// req.readable == true here

req.pause();
auth(req, res, function(err) {
    req.resume();
    // req.readable == true here 
```

# asp.net-mvc - mvc: route config 命令路由

> ID：16051061
> 
> 赞同：3
> 
> 时间：2013-04-17T03:40:53.383
> 
> 标签：asp.net-mvc, asp.net-mvc-3, routes

我添加了这样的自定义路线

```
 routes.MapRoute(
          name: "Default",
          url: "{coutry}/{lang}/{controller}/{action}",
          defaults: new { controller = "Home", action = "Index" }
        ); 
```

现在当我尝试从一个控制器调用方法时遇到一些问题，这在添加新路由之前运行良好

```
<a id="someId" class="link-button" href="../Documents/Create"><span>Create</span></a> 
```

现在我能做到这一点的唯一方法是使用类似的东西`href="EN/us/Documents/Create"`

有没有办法为我的客户端保留自定义路由，并且仍然`href="../Documents/Create">`为我的管理端保留路径，这是因为我在管理端开发了几个功能，但现在我必须为客户端包含该自定义路由。太感谢了。

现在有我的路线

```
 routes.MapRoute(
          name: "Default",
          url: "{controller}/{action}/{id}",
          defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
      );

routes.MapRoute(
            name: "CustomRoute",
            url: "{country}/{lang}/{controller}/{action}",
            defaults: new { controller = "Test", action = "Index" }
        ); 
```

但我只能使用 /ES/es/Test/Index 访问 CustomRoute ...为什么不采用默认值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T03:48:17.030

您只需要在默认路由**之后声明您的自定义路由：**

```
routes.MapRoute(
    name: "Default",
    url: "{controller}/{action}/{id}",
    defaults: new { controller = "Home", action = "Index",
        id = UrlParameter.Optional }
);
// SomeOther = someothercontroller
routes.MapRoute(
    name: "CustomRoute",
    url: "{coutry}/{lang}/{controller}/{action}",
    defaults: new { controller = "SomeOther", action = "Index" }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T03:52:25.487

您已将默认 RouteConfig 替换为新配置，并且它确实匹配**{coutry}/{lang}/{controller}/{action}**格式的 Url。

如果要接受`../Documents/Create`URL，则必须在末尾添加默认 RouteConfig。

```
routes.MapRoute(
  name: "CustomRoute",
  url: "{coutry}/{lang}/{controller}/{action}",
  defaults: new { controller = "Documents", action = "Index" }
);

routes.MapRoute(
  name: "Default",
  url: "{controller}/{action}/{id}",
  defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
); 
```

同样在锚标记`<a id="someId" class="link-button" href="../Documents/Create"><span>Create</span></a>`而不是硬编码中，`href`您可以编写如下内容。

`<a id="someId" class="link-button" href="@Url.Action("Create","Documents")><span>Create</span></a>`

# c# - 根据传入的值将集合分配为更派生的类型

> ID：16051063
> 
> 赞同：0
> 
> 时间：2013-04-17T03:40:55.457
> 
> 标签：c#

假设我有一堂课：

```
 public class Farm
{
  IList<Animal> Animals { get; set; }
  public Farm(string type)
  {
      if (type == "Walrus")
          Animals = new List<Walrus>();
      if (type == "Giraffe")
          Animals = new List<Giraffe>();
  }
} 
```

而且有两种动物：

```
 public class Animal
    {

    }

    public class Walrus : Animal
    {

    }

    public class Giraffe : Animal
    {

    } 
```

并且说一个农场只能养殖海象或长颈鹿。如何编写代码，以便如果将“Walrus”传递给 Farm 构造函数，则 IList 变为海象列表，但如果传递“Giraffes”，则 IList 变为 Giraffes 列表的列表。

所以以上不起作用。有谁知道如何实施

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T03:50:02.647

您可能正在寻找[泛型](http://msdn.microsoft.com/en-us/library/0x6a29h6.aspx)：

```
public class Farm<T> where T: Animal
{
   public IList<T> Animals { get; set; }
   public Farm()
   {
      Animals = new List<T>();    
   }
} 
```

以上将允许您创建一个专门的`Farm`实例，例如

```
var giraffeFarm = new Farm<Giraffe>(); 
```

同时，您可以使用[约束](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)来强制您的类型`T`派生自`Animal`

# html - 我如何制作 mailto：wordpress 中的表单工作

> ID：16051066
> 
> 赞同：0
> 
> 时间：2013-04-17T03:41:00.573
> 
> 标签：html, wordpress

[http://www.web-via.com/NinaRose/club/](http://www.web-via.com/NinaRose/club/)

该表单在普通的 html 页面上工作正常，但在 wordpress 中它给了我一个“请输入有效的电子邮件地址”错误。

```
<form action="mailto:maxp@businessrocket.net" enctype="text/plain" style="background-image:url('http://www.web-via.com/NinaRose/wp-content/uploads/2013/04/NinaBRozeClub.jpg') height:464px;" method="post">
<input type="text" name="email" style="background-color: white; height: 18px; left: 210px;     position: relative; top: 318px; width: 187px;"/>
<input type="submit" value="Submit" style="height: 25px; left: 78px; opacity: 0; position: relative; top: 350px;"/>
</form> 
```

我不确定是什么导致了这里的冲突，无论是 Wordpress 还是代码所在的 Popup Ninja 插件，我也不知道如何解决这个问题。

非常感谢，肯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:36:54.510

该消息来自 front.js 的第 82 行。它正在尝试验证使用此代码找到的地址：

```
var email = pn("#popup_form #email").val(); 
```

它期望您的电子邮件字段的 id`email`在另一个元素中的某个 id 为`popup_form`. 尝试添加`id="popup_form"`到您的`form`元素和`id="email"`电子邮件字段。

或者更好的是，检查这些`id`s 在您的工作 HTML 页面中的位置，并将它们放在 WordPress 页面中的相同元素上。

# google-places-api - Google Maps Geocoding API - 使用 API 密钥拒绝请求

> ID：16051068
> 
> 赞同：11
> 
> 时间：2013-04-17T03:41:02.030
> 
> 标签：google-places-api

我正在尝试按如下方式使用 Google API 地理编码服务：

```
https://maps.googleapis.com/maps/api/geocode/json?&address=melbourne&key=xxx&sensor=false 
```

我得到的回应总是：

```
{
   "results" : [],
   "status" : "REQUEST_DENIED"
} 
```

我同时启用了 Google maps API v3 和 Places API 服务。我什至设置了帐单。我尝试过删除和重新创建许多键 - 都具有相同的效果。我尝试过来自不同网络的服务，结果也一样。

在 Google API 仪表板的报告部分中，我可以看到请求数量在累积，但响应始终为`Request_Denied`.

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2014-08-19T01:36:14.170

[在以下情况下，Places API 返回](https://developers.google.com/places/faq#why_do_i_keep_receiving_status_request_denied)REQUEST_DENIED 状态：

*   您尚未在 API 控制台的服务选项卡中激活 Places API 服务。
*   您的请求中缺少关键参数。
*   key 参数与 API 控制台的 API 访问选项卡中的 API 密钥不匹配。
*   您的 API 密钥未在 API 控制台的 API 访问选项卡中正确设置：
*   如果您使用的是浏览器密钥，请检查您允许的推荐人是否正确。
*   如果您使用的是服务器密钥，请检查您允许的 IP 是否正确。
*   不支持 Android 和 iOS 密钥，请使用浏览器或服务器密钥。
*   该请求未作为 HTTPS 请求发送，所有 Web 服务请求都需要 HTTPS。
*   发送请求时使用了错误的 HTTP 方法：
*   所有请求都必须作为 GET 请求发送，除了 Place Actions。
*   所有地点操作都必须作为 POST 请求发送。

我未能将生产服务器的 IP 地址列入白名单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:27:06.257

似乎有意使该密钥不适用于地理编码的简单 HTTP 查询。谷歌正在阻止任何可能的数据再利用。请参阅[“使用限制”](https://developers.google.com/maps/documentation/geocoding/#Limits)：

> “地理编码 API 只能与谷歌地图一起使用；禁止地理编码结果而不显示在地图上。”

[您可以使用此处](https://developers.google.com/maps/documentation/javascript/reference#Geocoder)说明的 Javascript API 将结果加载到地图上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-19T20:35:25.627

只需像这样更改 googleapis 源

```
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places"></script> 
```

# java - 更新 ADT 后 Eclipse 不会导出 apk 文件？

> ID：16051070
> 
> 赞同：0
> 
> 时间：2013-04-17T03:41:31.683
> 
> 标签：java, android, eclipse, adt

我于 4 月 13 日在 Eclipse IDE 中更新了我的 ADT 插件，现在它不会以 apk 文件扩展名导出我的项目。有人可以帮我解决这个问题吗？我不知道出了什么问题。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-07T03:16:37.387

有同样的问题。这是我修复它的方法。

1.  首先以管理员身份打开 CMD 并将当前目录设置为您的**[JAVA_FOLDER]\bin**

2.  键入以下内容以生成您的密钥库（系统将要求您输入密码）。您的参数位于括号中的文本所在的位置。

    `keytool -genkey -v -keystore [keystore-name.keystore] -alias [key-alias] -keyalg RSA -keysize 2048 -validity 10000`

3.  在 ADT/Eclipse 中，右键单击您的项目文件夹，选择**Android Tools** >> **Export Unsigned Application Package**

4.  使用生成的密钥库对未签名的 apk 进行签名

    `jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore [keystore-name].keystore unsigned.apk [key_alias]`

5.  验证您是否正确签名

    `jarsigner -verify [signed-apk].apk`

6.  您的 apk 现在已签名并且可以分发。但是，建议对文件进行 DWORD 对齐。因此，在 CMD 中，导航到您的**[Android SDK 文件夹]\tools**并键入以下内容

    `zipalign -v 4 [path-to-unaligned].apk [path-to-final].apk`

7.  您的 apk 终于可以分发了。

**注意**：我所做的是让 keytool.exe 将密钥库保存在 JAVA bin 目录中，然后将其移动到安全位置。

您可以制作批处理脚本，这样您就不会输入很多内容。

了解更多信息：

[http://developer.android.com/tools/publishing/app-signing.html](http://developer.android.com/tools/publishing/app-signing.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T07:27:31.690

我解决了我的问题。我使用的是 android dev 网站上推荐的 Eclipse Mobile，但我使用 ADT v21 插件安装了 Eclipse Indigo，它现在可以完美地导出 .apk 文件扩展名。希望这可以帮助任何有同样问题的人。

简而言之：Eclipse 无法导出 .apk 文件的答案是改用 Eclipse Indigo。

可以在这里找到：http: [//www.eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/indigosr2](http://www.eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/indigosr2)

# javascript - 将外部 js 注入到自己创建的 iframe 中

> ID：16051076
> 
> 赞同：1
> 
> 时间：2013-04-17T03:42:17.460
> 
> 标签：javascript, jquery, iframe

因此，我尝试将外部 css 和 js 注入到自己创建的 iframe 中以提供额外的安全层，因此不存在跨域问题。

这是代码

```
<!doctype html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
</head>
<body>

<script>
$(function(){

var contents = $('iframe').contents();

styleTag = $('<link href="http://mylink.com/styles.css" media="all" rel="stylesheet" type="text/css" />').appendTo(contents.find('head'));

insertScript('https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js');
insertScript('https://myserver.com/myfile.js');

});

var insertScript = function(src){
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = src;
$('iframe').contents().find('head').append(script);
console.log("add script");
}

</script>

<div class="output">
<iframe></iframe>
</div> 
```

正在输入css文件，但没有一个js文件，任何人都可以看到为什么吗？console.log 正在输出。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T03:56:51.287

~~我认为您必须从 iframe 的文档对象创建脚本元素。它应该以 的形式提供`contents[0]`，您可以将其传递给 insertScript。~~

如果您`appendChild`直接在头节点上使用它（而不是 jQuery 包装器），它会起作用：

```
$('iframe').contents().find('head')[0].appendChild(script); 
```

[http://jsbin.com/enidiv/1/edit](http://jsbin.com/enidiv/1/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T03:52:37.397

只要 iframe 域、协议和端口匹配，您就可以添加脚本。否则，将被视为访问不同 url 的不安全尝试。

# c# - 如何使用c#获取在windows上运行的程序的名称

> ID：16051078
> 
> 赞同：2
> 
> 时间：2013-04-17T03:42:55.313
> 
> 标签：c#, process

我想要一个函数，它给我一个程序名称（如 msPaint 或记事本），当我使用记事本时，这个函数返回“Notepad”，当我使用 msPaint 时，这个函数返回“msPaint”。

请帮我...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T03:56:30.863

使用`Process.GetProcesses();`方法，您可以获得所有正在运行的应用程序，如果您想要当前活动窗口，请使用`GetForegroundWindow()`and `GetWindowText()`。

例如[点击这里](http://www.csharphelp.com/2006/08/get-current-window-handle-and-caption-with-windows-api-in-c/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T04:02:57.710

您可以使用 Process 类。它有一个 Modules 属性，列出了所有加载的模块。

将所有进程和所有模块列出到控制台：

```
Process[] processes = Process.GetProcesses();

    foreach(Process process in processes) {
    Console.WriteLine("PID:  " + process.Id);
    Console.WriteLine("Name: " + process.Name);
    Console.WriteLine("Modules:");
    foreach(ProcessModule module in process.Modules) {
        Console.WriteLine(module.FileName);
    } 
```

或者这样做，

```
[DllImport("user32.dll")]
private static extern IntPtr GetForegroundWindow();

[DllImport("user32.dll")]
private static extern int GetWindowText(IntPtr hWnd, StringBuilder text, int count);

public static void Main()
{
    int chars = 256;
    StringBuilder buff = new StringBuilder(chars);
    while (true)
    {
        // Obtain the handle of the active window.
        IntPtr handle = GetForegroundWindow();

        // Update the controls.
        if (GetWindowModuleFileName(handle, buff, chars) > 0)
        {
            Console.WriteLine(buff.ToString());
            Console.WriteLine(handle.ToString());
        }
        Thread.Sleep(1000);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T03:59:46.487

来自：[如何从 C# 中获取进程窗口类名？](https://stackoverflow.com/questions/12372534/how-to-get-a-process-window-class-name-from-c)

```
 int pidToSearch = 316;
    //Init a condition indicating that you want to search by process id.
    var condition = new PropertyCondition(AutomationElementIdentifiers.ProcessIdProperty, 
        pidToSearch);
    //Find the automation element matching the criteria
    AutomationElement element = AutomationElement.RootElement.FindFirst(
        TreeScope.Children, condition);

    //get the classname
    var className = element.Current.ClassName; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T04:05:02.700

我不确定你是如何调用这些程序的。如果通过 Process 运行这些程序，则可以通过 ProcessName 获取。

例子：

```
 Process tp = Process.Start(@"notepad.exe", "temp");

        string s = tp.ProcessName; 
```

# android - 我无法在实现 ActionTab 侦听器的另一个片段的 onTabSelected 中调用片段

> ID：16051081
> 
> 赞同：3
> 
> 时间：2013-04-17T03:43:08.847
> 
> 标签：android, android-fragments, android-actionbar, android-viewpager

我正在尝试创建一个在内容部分具有 ListView 的片段，作为默认视图。此视图有 ActionBar 选项卡。到目前为止，我能够创建它。

LaunchListFragment 代码

```
public class LaunchListFragment extends ListFragment implements ActionBar.TabListener {
public static  String LIST_TYPE = "invalid";
GenericListData g_data[] = null;
   private ViewPager mViewPager;
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    View result = inflater.inflate(R.layout.fragment_launch_list,
            container, false);

    setActionTabs();
    setList();
    return (result);
}

public static LaunchListFragment newInstance(String type) {
    LaunchListFragment frag = new LaunchListFragment();
    Bundle args = new Bundle();
    LIST_TYPE=type;

    args.putString(LIST_TYPE, type);
    frag.setArguments(args);

    return (frag);
} 
```

我想要的是，当您单击 onTabSelected() 时，想要更改视图，并且我正在使用 PagerFragment 和使用 FragmentPagerAdapter 生成的视图

```
@Override
public void onTabSelected(Tab tab, android.app.FragmentTransaction ft) {

       getChildFragmentManager().beginTransaction()
       .add(android.R.id.content,
            new PagerFragment()).commit();
} 
```

问题是，我无法使用 getChildFragmentManager 或 getFragmentManager 来调用 PagerFragment，将 PagerFragment 更改为 app.Fragment 时出现编译错误。即使我改变了它，它仍然会抱怨。

我怀疑 support.Fragment 和 app.Fragment 之间存在某种冲突。

除了使用嵌套片段之外，还有其他方法可以实现这一目标吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T06:57:43.360

我建议您使用 viewPager，让您的两个片段显示在选项卡选择上（在操作栏上）。根据需要使用 FragmentStatePagerAdapter 或 FragmentPagerAdapter，然后初始化 viewPager 并设置适配器。然后在 'onTabSelected()' 中获取标签位置，然后显示相应的 viewPager 页面。

```
 FragmentPagerAdapter fragmentStagePageAdapter = new SearchStatePagerAdapter(getFragmentManager());

public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    mView =  inflater.inflate(R.layout.venues_tabhost_layout, container, false);

    mViewPager = ( com.edenpod.goinout.view.ViewPager) mView.findViewById(R.id.pager);
    mViewPager.removeAllViews();
    mViewPager.setAdapter(fragmentStagePageAdapter);
    mViewPager.setOffscreenPageLimit(3);
    ----------------
    ---------------
   --------------
    }

    public void onTabChanged(Tab tab, android.app.FragmentTransaction ft) {
    int pos = tab.getCurrentTab();
    if( mViewPager!= null && pos == 0 ) {
        mViewPager.setCurrentItem(pos);
    } else if( mViewPager != null && pos == 1 ) {
        mViewPager.setCurrentItem(pos);
    } else if( mViewPager != null && pos == 2 ) {
        mViewPager.setCurrentItem(pos);
    }
    }

// Example PagerAdapter
public class SearchStatePagerAdapter extends FragmentPagerAdapter{

private ArrayList<Fragment> mFragmentsList;

public SearchStatePagerAdapter(FragmentManager fm) {
    super(fm);
    mFragmentsList = new ArrayList<Fragment>();
    mFragmentsList.add(new VenueSearchFragment());
    mFragmentsList.add(new PeopleSearchFragment());
}

@Override
public int getCount() {
    return mFragmentsList.size();
}

@Override
public Fragment getItem(int position) {
    Fragment fragment = null;
    switch (position) {
        case 0:
            fragment = mFragmentsList.get(position);
            break;
        case 1:
            fragment = mFragmentsList.get(position);
            break;
    }
    return fragment;
} 
```

}

# mysql - 只是想确认通过 IN 运行单个 mySQL UPDATE 是否比多个查询快

> ID：16051083
> 
> 赞同：0
> 
> 时间：2013-04-17T03:43:12.313
> 
> 标签：mysql, performance

我的脚本需要遍历很多行，分析内容，然后对它们进行更新（有选择地）

显然我有一个循环来评估每一行......

我通常会在这个循环中发出一个 SQL UPDATE 查询（对于正在评估的当前行）......事实上，我更喜欢这个，更直接地清理我的代码等。 $q = "UPDATE mytable SET status='online' WHERE id ='22'";

但最近我一直在使用“IN”子句。循环会在 csv 中收集 id，然后再做；

```
if ids exist do query 
    $q = "UPDATE mytable SET status='online' WHERE id IN(22,25,147)"; 
```

那么这两种技术中的任何一种明显更好吗？事实上？或者我也可以坚持我喜欢的地方......

是的，对于我必须做的代码和其他任务，让单个 UPDATE SQL 在循环内触发更容易......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T03:49:51.720

单个查询`IN (<multiple id's>)`应该比多个查询更好`id`。这是因为服务器必须解析您的 SQL 语句并创建查询计划，并且解析成本通常与实际执行时间相当。解析具有 100 个 id 的语句的成本与使用一个 id 的成本大致相同。

但是，如果收集的项目数超过 100，更好的方法是创建另一个包含这些 id 的表。如果此表在 上具有索引`id`，那么它对于性能来说将是理想的。

# android - 添加两个 XML 文件会导致呈现错误/某些东西。笏？

> ID：16051093
> 
> 赞同：0
> 
> 时间：2013-04-17T03:44:08.700
> 
> 标签：android, drawable, android-xml, android-2.3-gingerbread

Android项目/编译工具链中的某个点是否有一些XML/布局/资源限制？向我的 Android 项目添加单个（未使用的，任何内容）XML 布局文件会导致应用程序其他地方出现渲染错误。删除它可以修复它。这是编译工具链某些部分的错误，我该如何诊断/修复它？

* * *

**一些额外的上下文：**

我有一个比较大的Android项目。今天我在添加一个功能时遇到了一个问题：一个按钮的背景可绘制在我旋转应用程序之前没有呈现。其他背景/样式/样式按钮仍在工作，但这一个背景非常破碎，在应用程序中无处不在。旋转会修复它所在的屏幕以及按钮的每个后续实例，直到重新启动应用程序的进程。

经过*大量*的试验和错误，以及对分和实验，我得到了某种程度的完全可靠的最小复制：向我当前的项目添加另外两个 XML 布局文件会触发错误。具体来说，在唯一的 /res/layout 文件夹中添加第 40 个 XML 文件。删除它可以让按钮正确呈现，添加它会破坏它。

这些文件可以完全不使用，完全从头开始，具有任何内容和任何名称。没有其他项目更改。我正在运行最新版本的 Eclipse 和 Android SDK - 如果需要，我可以获得特定的版本号。它已在具有类似设置的同事机器上与该项目一起复制。我已经清理、重建、手动删除构建产品，重新启动计算机，错误仍然存​​在。

一定有更具体的原因导致它，我很乐意提供帮助缩小范围的建议。不幸的是，它超出了我对 Android 构建系统的了解，而且似乎不是我直接造成的。任何人都可以帮忙吗？或者指向我一些进一步的资源？

* * *

**更多详情**：

*   （不敢相信我忘记了这一点）这似乎只发生在我拥有的 2.3.6 设备上。它可能发生在其他 2.x 版本上，但 4.2.2 始终正确呈现按钮（尽管我没有/不能排除另一个位置的错误）。我今天将尝试模拟器。
*   发生在多个 Android 设备上，尽管它们基本上都是库存的（没有自定义主题等）。
*   当前的应用程序设置是一个核心应用程序项目，其他三个项目使用该核心项目通过清单合并生成不同的构建（开发、生产等）。
*   该特定的可绘制资源具有应有的唯一 R id，因此它似乎不会在那里发生冲突。我没有将它与系统 R 值进行比较 - 有没有好的方法？
*   目标 SDK = 17，最小值 = 8

* * *

**也很有趣**：将可绘制文件从“rounded_teal_button_normal”重命名为“rounded_teal_button_nrml”不会改变任何东西，但将其更改为“rounded_teal_button_aargh”*会*。我能看到的唯一重要区别是“nrml”不会改变文件的字母顺序，而“aargh”会改变（有一个“_disabled”文件和“_pressed”）。但是，这确实会导致现在处于“正常”位置的可绘制对象停止绘制。

更改按钮状态选择器的项目顺序或哪个状态获得哪个可绘制（甚至删除所有其他样式）没有任何效果。

添加*第三个*XML 文件会导致问题消失，并且似乎不会导致按字母顺序排列的可绘制对象中断，但很难确定它是否解决了*所有*问题，并且“为什么”问题仍然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:43:22.093

需要更多信息才能做出更有根据的猜测。一旦我遇到了类似的问题，这种问题发生在 GB 版本上，但不是更高版本，只有在 Mac 上编译；如果在 Windows 上编译，同样可以正常工作；问题是按钮没有显示背景图像。我的背景图片是 9-patch，最后我注意到这是由于没有将各自的图片放入所有 drawable-[m|h|x]dpi；我只在 drawable-xhdpi 目录中拥有它，因此修复了该问题。您可以检查这些类型的问题。例如，这个问题是否只出现在某些屏幕密度或某些 android 版本等上。正如另一个响应所说，40 xml 远非任何限制。

HTH，阿里。

# c# - 如何使用 LINQ 将基类对象的集合转换为它们各自子类的过滤列表？

> ID：16051096
> 
> 赞同：2
> 
> 时间：2013-04-17T03:44:28.910
> 
> 标签：c#, linq, lambda

我们有几种不同的数据类型，它们都共享一个特定的基类。我们还有一个`List<BaseClass>`包含这些子类对象的随机集合，没有特定的顺序。

使用 Linq/Lambda 表达式，我们尝试提取每个单独的子类类型，按该特定子类的属性排序，然后将其存储在强类型值中`List<SubclassType>`

这是我目前正在做的事情，但不是 LINQ 专家，我觉得有一种更简单的方法可以实现这一目标。（我感觉我的 Where 和 Select 在某种程度上是多余的，并且会导致对集合的过度传递，但我可能是错的。）

```
class baseItem{}

class subItemX : baseItem
{
    public int XSortValue{ get; set; }
}

class subItemY : baseItem
{
    public int YSortValue{ get; set; }
}

List<MyBaseClass> allItems = GetAllItems(); // Random collection of subclass objects.

// Is there an easier/less verbose way to achieve these two?
List<SubItemX> xItemsOnly = allItems
    .Where(baseItem => baseItem is SubItemX)
    .Select(baseItem => baseItem as SubItemX)
    .OrderBy(subItemX => subItemX.XSortValue)
    .ToList();

List<SubItemY> yItemsOnly = allItems
    .Where(baseItem => baseItem is SubItemY)
    .Select(baseItem => baseItem as SubItemY)
    .OrderBy(subItemY => subItemY.YSortValue)
    .ToList(); 
```

然而，我有一种感觉，我让这些变得比他们需要的复杂得多。这是最有效的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T03:48:03.047

您想利用`OfType<T>`过滤混合序列并将结果提取为所需类型。

```
var xItemsOnly = allItems.OfType<SubItemX>().OrderBy(s => s.XSortValue).ToList(); 
```

您可能希望探索的类似方法是`Cast<T>`，不是过滤和转换，而是简单地转换（如果转换不成功则抛出）。如果您*知道*一个较小派生类型的序列中的所有项目实际上是更多派生类型，请使用此选项。否则，如果您的意图是过滤可能混合的序列，请使用`OfType<T>`先前显示的方法（根据您的问题，这肯定是您会做的）。

# python - HTML 源到记事本文件

> ID：16051097
> 
> 赞同：0
> 
> 时间：2013-04-17T03:44:32.077
> 
> 标签：python, html, pywin32, notepad

我如何使用 python 保存从网站获得的源代码，然后将其保存为 .html 或 .txt 文件以用于我正在处理的项目

我用这样的东西来获取代码

```
from PAM30 import PAMIE
import win32com.client 
ie =PAMIE() 
website="http://example.url"
ie.navigate(website)
ie.setTextBox("account","my_user")
ie.setTextBox("pw","my_pass")
shell = win32com.client.Dispatch("WScript.Shell")
shell.SendKeys("{ENTER}", 0)
data = ie.outerHTML()

print(data) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T03:58:56.750

```
from PAM30 import PAMIE
import win32com.client 
ie =PAMIE() 
website="http://example.url"
ie.navigate(website)
ie.setTextBox("account","my_user")
ie.setTextBox("pw","my_pass")
shell = win32com.client.Dispatch("WScript.Shell")
shell.SendKeys("{ENTER}", 0)
data = ie.outerHTML()

with open("out.txt", "w") as f:
    f.write(data) 
```

保存到“out.txt”。你也可以改变它。

对于 unicode 错误，请尝试`codecs`module.

```
import codecs

with codecs.open("out.html", "w", encoding="utf-8") as f:
    f.write(data) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T05:42:48.833

我不确定我是否完全理解您的问题，但这是我使用 urllib2 提出的解决方案。

```
import urllib2

output_file = open('output.txt', 'w') 
url = urllib2.urlopen('http://www.python.org')
url_html = url.read()

output_file.write(url_html)
output_file.close() 
```

# unit-testing - 自动软件测试

> ID：16051101
> 
> 赞同：0
> 
> 时间：2013-04-17T03:44:37.880
> 
> 标签：unit-testing, testing, automated-tests

我想学习自动软件测试，但我无法决定我想使用什么接口（selenium、TestComplete、...）——所以我不知道我想用什么语言学习自动化测试。如果有人能告诉我在这个问题中对于新人来说什么是最好的，我会非常高兴。

*顺便说一句，我刚刚读了 Ron Patton 的一本书——软件测试，它基本上告诉你软件测试的基本问题是什么。+ 我也读过一些关于 c# 语言的东西，我可以说我知道一些关于它的基本东西。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-17T15:08:26.987

对于自动化测试，您可以使用**Selenium Web-driver**。
Selenium 是最近*开源*的 Web 应用程序功能测试 它主要用于 Web 自动化

1.  从基础开始 Selenium IDE 它是 Mozilla Firefox 附加组件

    *   [http://docs.seleniumhq.org/projects/ide/](http://docs.seleniumhq.org/projects/ide/)
2.  带有 JAVA 的 Selenium Web 驱动程序

    *   [http://docs.seleniumhq.org/projects/webdriver/](http://docs.seleniumhq.org/projects/webdriver/)

    *   [https://code.google.com/p/selenium/](https://code.google.com/p/selenium/)

    *   [http://docs.seleniumhq.org/docs/](http://docs.seleniumhq.org/docs/)

    *   [http://www.guru99.com/selenium-tutorial.html](http://www.guru99.com/selenium-tutorial.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T03:48:48.663

xUnit 框架在单元测试中非常流行，并且可以在多种语言中使用。junit 框架或 Java xUnit 实现使用特别广泛。就个人而言，我认为这是开始进行单元测试的好地方。我一般偏爱 Vogella 的 Java 教程，我认为他的 jUnit 介绍非常好：[http ://www.vogella.com/articles/JUnit/article.html](http://www.vogella.com/articles/JUnit/article.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T03:15:44.583

好吧，根据您的描述，我认为您可能不是在谈论单元测试，而是在谈论自动功能测试。正如你提到的 selenium 和 testcomplete，我猜你打算对网站进行自动网络测试？如果我的猜测是正确的，以下是我的看法：

1）首先，了解你的待测产品。不仅要从技术角度，还要从业务角度。

2）学习一些基本的概念和测试方法将有助于您进行测试（在考虑如何自动测试之前，您应该知道如何测试，对吧？）。这个主题有很多好书。

3）面对自动化的web测试，了解html、css、javascript很重要。还知道一些关于你的后端语言的知识会有所帮助（例如，如果你的后端系统是用 php 编写的，那么你最好了解一些关于它如何与网页一起工作的基本概念）

4）对于自动web测试工具，我只能说selenium是我们产品的好工具。但由您决定它是否适合您的产品。就像@Chris Kenst 在评论中所说的那样。网络测试没有灵丹妙药……

希望这有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-16T13:22:27.060

[Selenium WebDriver](http://onpathtesting.com/good-things-come-in-small-packages-selenium-webdriver/)是当今软件开发中最流行的自动化测试框架。由于它支持所有主要的编程语言，如 C#、Perl、Ruby、PHP 和 JAVA，因此您可以自由地学习和创建任何这些语言的测试代码。Selenium WebDriver+JAVA 是使用最多的组合。当然，html、javascript和css的知识很重要。请记住，测试人员的工作是亲力亲为。会有很多关于测试自动化的好书。然而，最好的培训和技能来自于实际项目的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-17T07:10:10.217

我认为使用带有 Test NG 自动化测试框架的 selenium web 驱动程序会更好，因为使用 TestNG 您可以生成适当的报告，并且您可以轻松知道有多少测试用例通过、失败和跳过。您可以单独执行失败的测试用例。例如。假设您有五个测试用例，每个测试用例编写一个方法（假设程序是使用 main 方法编写的，没有使用 testNG）。第一次运行这个程序时，三个方法执行成功，第四个方法执行失败。然后更正第四种方法中存在的错误，现在您只想运行第四种方法，因为前三种方法无论如何都已成功执行。如果不使用 TestNG，这是不可能的。TestNG 提供了一个选项，即test-output 文件夹中的testing-failed.xml 文件。如果您只想运行失败的测试用例，则意味着您运行此 XML 文件。它只会执行失败的测试用例。

# iphone - 如何使用快速对话框更新 QButtonElement 标题

> ID：16051103
> 
> 赞同：2
> 
> 时间：2013-04-17T03:44:44.580
> 
> 标签：iphone, ios6, delegates, quickdialog

现在，在 SignUpController 中，我想使用委托更新 QButtonElement 的标题之一，在委托方法中我可以从委托中获取值。但我无法将值设置为此 QButtonElement 的标题。像这样的代码：

```
#import <UIKit/UIKit.h>

@interface LoginViewController : QuickDialogController <QuickDialogStyleProvider>

@end

LoginViewController.m

- (void)pushSignUp:(QButtonElement *)buttonElement
{
    QRootElement *root = [[QRootElement alloc] initWithJSONFile:@"signUpForm"];
    //don't user quick*er allo iniwithroot
    SignUpController *loginController = (SignUpController *)[QuickDialogController controllerForRoot:root];
    [self.navigationController pushViewController:loginController animated:YES];
}

SignUpController.m

- (void)didGetCity:(City *)acity
{
    self.city = acity;
    NSLog(@"%@", self.city.city);//shows new york, so it's working.
    QButtonElement *locationElement = (QButtonElement *)[self.root elementWithKey:@"location"];
    [locationElement setTitle:acity.city]; // the title won't change.
    [self.quickDialogTableView reloadCellForElements:locationElement, nil];
} 
```

# java - 在面向对象编程 Java 中使用数组和方法

> ID：16051105
> 
> 赞同：2
> 
> 时间：2013-04-17T03:44:52.750
> 
> 标签：java, arrays, oop, methods

我正在学习Java，话虽如此，我的知识仍处于学习Java的爬行阶段。我已经阅读了有关在非常强大的数组中使用对象的信息。我正在尝试编辑这个简单的示例类和测试类，以显示谁是最快的驱动程序，以及什么是最快的速度。我在考虑如何解决这个问题有两种方法。一个是找到最大速度，并找到什么数组编号（例如数组[2]）。

我设法捕获了循环中的最高速度和数组编号。把它放到一个方法中，然后调用它让我很困惑。任何帮助深表感谢。

错误代码我得到
TestBikeWithArray.java:73: 错误：二元运算符 '>'
if (bikeRace[i] > bikeRace[0])的错误操作数类型
^
第一种类型：自行车
第二种类型：自行车
1 错误

工具完成，退出代码 1
它们都是 Bike 类，我不明白。

```
public class Bike{

private String driver;
private int gear;
private int cadence;
private int speed;
private int id;

private static int numberOfBikes = 0;

public Bike(String theDriver, int startGear,int startCadence, int startSpeed){
    driver = theDriver;
    gear = startGear;
    cadence = startCadence;
    speed = startSpeed;
    numberOfBikes++;
    id = numberOfBikes;
}

public String getDriver() {return driver;}
public void setDriver(String d) {driver = d;}

public int getGear(){return gear;}
public void setGear(int g){gear = g;}

public int getCadence(){return cadence;}
public void setCadence(int c){cadence = c;}

public int getSpeed(){return speed;}
public void setSpeed(int s) {speed = s;}

public int getID() {return id;}

public static int getNumberOfBikes() {return numberOfBikes;}

// method to print out contents of object
public String toString ()
{
    StringBuffer sb = new StringBuffer();
    sb.append("\nDriver: " + driver);
    sb.append("\nGear: " + gear);
    sb.append("\nCadence: " + cadence);
    sb.append("\nSpeed: " + speed);
    sb.append("\nID: " + id + "\n");

    return (new String(sb));
} // end toString method

} // end class 
```

主要测试自行车

```
import java.util.Scanner;
import javax.swing.JOptionPane;

class TestBike
{
public static void main(String[] args)
{
    String message ="";

    Bike[] bikeRace = new Bike[10];

    bikeRace[0] = new Bike("Cersei Lannister", 0, 0, 0);
    bikeRace[1] = new Bike("Daenerys Targaryen", 10, 60, 22);
    bikeRace[2] = new Bike("Robb Stark", 21, 50, 15);

    //testing values
    //bikeRace[3] = new Bike("Melisandre", 31,90,155);
    //bikeRace[4] = new Bike("Margaery Tyrell", 2, 3, 100);

    bikeRace[0].setGear(3);

    for(int i=0; i < Bike.getNumberOfBikes(); i++)
    {
        System.out.println(bikeRace[i].toString());

        //testing, must use a proper function call!
        //System.out.println(bikeRace[i].getDriver());
    } // end for loop

    //find max speed & driver findTheFastestDriver

    //testing stuffs get all drivers
    /*for(int i=0; i < Bike.getNumberOfBikes(); i++)
    {
        System.out.println("Driver: " + bikeRace[i].getDriver());
    }

    //testing get all speeds
    for(int i=0; i <Bike.getNumberOfBikes(); i++)
    {
        System.out.println("Speed: " + bikeRace[i].getSpeed());
    } */

    //****************************************************************/
    //finding fastest bike without a method
    //fastest speed is 22
    /*int fastestBike = bikeRace[0].getSpeed();
    int fastestBikeIndex = 0;
    for(int i=0; i<Bike.getNumberOfBikes(); i++)
    {
        if (bikeRace[i].getSpeed() >= fastestBike)
        {
            fastestBike = bikeRace[i].getSpeed();
            fastestBikeIndex = i;
        }//end if
    }//end for
    System.out.println("fastest Bike Speed: " + fastestBike + " " + " Bike index of " + fastestBikeIndex);*/
    //********************************************************************

    int fastestBikeIndex = findTheFastestDriver(bikeRace);
    System.out.println("\nThe fastest driver is " + bikeRace[fastestBikeIndex].getDriver() + " and the speed of " + bikeRace[fastestBikeIndex].getSpeed() + " mph.");

    System.out.println("\nNumber of Bikes: " + Bike.getNumberOfBikes() + "\n");

} //end of main

public static int findTheFastestDriver(Bike[] bikeRace)
{
    int fastestBike = bikeRace[0].getSpeed();
    int fastestBikeIndex = 0;
    for(int i=0; i < Bike.getNumberOfBikes(); i++)
    {
        if (bikeRace[i].getSpeed() >= fastestBike)
        {
            fastestBike = bikeRace[i].getSpeed();
            fastestBikeIndex = i;
        }//end if
    }//end for
    return fastestBikeIndex;
}

} //end of class 
```

代码有效:) 很高兴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T03:48:01.793

`if (bikeRace[i] > bikeRace[0])`

改成

`if (bikeRace[i].getSpeed() > bikeRace[0].getSpeed())`

推理：你不能用数字比较非数字对象。

# java - 从另一个类创建数组

> ID：16051106
> 
> 赞同：0
> 
> 时间：2013-04-17T03:45:02.873
> 
> 标签：java

我有一个`WordFreq`类，它有一个`processLines`从类创建数组的方法`WordCount`。我有其他行的`processLines`方法访问`WordCount`没有问题。

我有：

```
public class WordCount{

    private String word;
    private int count;

    public WordCount(String w){
        word = w;
        count = 0;
    } 
```

其次是类方法：

```
public class WordFreq extends Echo {

    String words, file;
    String[] wordArray;
    WordCount[] search; 
```

WordFreq 被传递一个文本文件（在 Echo 中处理）和一个要搜索的单词字符串。

```
public WordFreq(String f, String w){
    super(f);
    words = w;
}

public void processLine(String line){
    file = line;
    wordArray = file.split(" ");

    // here is where I have tried several methods to initialize the search
    // array with the words in the words variable, but I can't get the
    // compiler to accept any of them.

    search = words.split(" ");

    StringTokenizer w = new StringTokenizer(words);
    search = new WordCount[words.length()];

    for(int k =0; k < words.length(); k++){
        search[k] = w.nextToken(); 
```

我尝试了其他一些不起作用的东西。我尝试将`search[k]`= 右侧的内容转换为`WordCount`，但它不会通过编译器。我不断得到不兼容的类型。

```
Required: WordCount found: java.lang.String. 
```

我不知道从这里去哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T03:47:30.007

尝试这样的事情：

```
String[] tokens = words.split(" ");
search = new WordCount[tokens.length];
for (int i = 0; i < tokens.length; ++i) {
    search[i] = new WordCount(tokens[i]);
} 
```

您第一次尝试的问题是`words.split(" ")`导致`String`数组；您不能分配给`WordCount`数组变量。第二种方法的问题在于`words.length()`中的*字符*数`words`，而不是标记数。您可能可以通过使用`w.countTokens()`代替来使您的第二种方法起作用`words.length()`，但是，再次，您需要将每个`String`返回的对象转换`w.nextToken()`为`WordCount`对象。

# javascript - Javascript 发布者/订阅者模式示例

> ID：16051108
> 
> 赞同：1
> 
> 时间：2013-04-17T03:45:26.233
> 
> 标签：javascript, asp.net-mvc-4, publish-subscribe

我正在学习发布者/订阅者模式，并做了一个简单的例子来更好地理解它。

```
var Publisher = {
    subscribers: {},       
    Subscribe: function (event, callback) {
        if (Publisher[event] && typeof callback === "function") {
            if (Publisher.subscribers[event]) {
                Publisher.subscribers[event].callbacks.push(callback);
            }
            else {
                Publisher.subscribers[event] = { callbacks: [callback] };
            }
        }
    },
    Publish: function (event) {
        if (Publisher.subscribers[event].callbacks) {
            for (callback in Publisher.subscribers[event].callbacks) {
                Publisher.subscribers[event].callbacks[callback].apply(null);
            }
        }
    },

    PublishOnClick: function (event, argument) {
        Publisher.Publish(event, argument);
    }
};

var Subscriber1 = {
    initialize: function () {
        if (Publisher.Subscribe) {
            Publisher.Subscribe("PublishOnClick", Subscriber1.Action);
        }
    },
    Action: function (c) {
        document.getElementById('result').innerHTML += "Button Clicked and the count is: " + c;
        c++;
    }
};
Subscriber1.initialize();

var c = 1;
var fld2 = document.getElementById("myfield2");
if (fld2.addEventListener) {
    fld2.addEventListener("click", function() { Publisher.PublishOnClick("PublishOnClick", [c]); }, false);
} else if (fld2.attachEvent) {
    fld2.attachEvent("onclick", function() { Publisher.PublishOnClick("PublishOnClick", [c]); });
} 
```

我有一个按钮和部分视图，我试图通过按钮引发一个事件并在部分视图上显示计数。我得到了事件的提升并显示在部分视图上，但唯一的问题是计数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:18:18.240

从我所见，您的问题实际上不在于发布者-订阅者范式。

你的设置有点……复杂，我想，因为从类似的角度来看它可能更容易掌握：

```
twitter_feed.tweets = [];
twitter_feed.root_el = document.getElementById("tweets");
twitter_feed.update = function (tweet) {
    twitter_feed.tweets.push(tweet);
    // demonstration-purposes only -- please don't write live code like this
    twitter_feed.root_el.innerHTML += "<p>" + tweet.user + ": \"" + tweet.text + "\"</p>";
};

twitter_data.subscribe("new-tweet", twitter_feed.update);

// some event handler which grabs tweets from AJAX or whatever...
twitter_data.notify("new-tweet", { user : "Me", text : "my new tweet" }); 
```

目标是发布者不是对象，而是存在可以发布数据的对象，订阅者不是对象，而是可以对已发布事件做出反应的对象的扩展......

...无论如何，您的代码适用于手头的范例...

...除了：

```
Action : function (c) { /* ... */ c++; } 
```

问题是 JS***通过 VALUE 而不是 REFERENCE 传递 SCALAR 数据***。

所以在你的函数中，当它被调用时，你没有传递：

```
// .Action(c);
Action (reference_to_c) {
    /*...*/.innerHTML = reference_to_c;
    reference_to_c++;
} 
```

你实际上是通过：

```
// .Action(c);
Action (1) {
    /*...*/.innerHTML = 1;
    1++;
}; 
```

JS 中的对象是通过引用传递的。“对象”包括函数和数组。
非对象标量 ( `number`s, `string`s, `boolean`s, `null`, `undefined`, `NaN`) 是按值传递的，因此如果您有一个参数是标量的函数参数，则在函数内部编辑版本不会更改外部值。

```
var x = 1,
    say_X = function (x) { x += 1; console.log(x); };

say_X(x); // 2;
console.log(x); // 1;

// vs
var obj = { x : 1 },
    say_X = function (o) { o.x += 1; console.log(o.x); };

say_X(obj); // 2;
console.log(obj.x); //2; 
```

您在这里真正想做的是让发布者跟踪计数，或者让订阅者跟踪计数，这取决于这样做的意义所在。
看看我的 Twitter 示例，在顶部。

`twitter_feed`跟踪它打印到屏幕上的所有推文是有意义的，这样当有新推文出现时，它就会被添加到列表中。
最新的`twitter_data`不会关心以前的推文，所以在这种情况下，订阅者会跟踪状态，而发布者只会监听变化并在发生某些事情时通知其他人。

在其他情况下，发布者跟踪其状态并向订阅者宣布新状态可能是有意义的：

```
music_playlist.update_track = function (data) {
     music_playlist.current_song.innerHTML = data.current_song;
};
music_player.subscribe("song-change", music_playlist.update_track);
music_player.notify("song-change", { current_song: "Sympathy for the Daleks" }); 
```

在这种情况下，播放列表只真正关心更新用户在页面上看到的标题。
音乐播放器正在处理当前可用的歌曲以及当前所处的状态，以及所有其他好东西。

因此，您当前问题的解决方案是以下之一：

1.  为 Publisher 创建一个属性，`c`该属性添加到 c 并随后通知其订阅者
2.  做`c`一个Subscriber的property，这里每次Publisher通知Subscriber的时候，加到自己的`c`property里面，然后写出来
3.  取出( 看起来像`c`的参数，这样函数的内部就会指向...sloppy，但是可以。`Action``Action : function () { /*...*/ }``c``window.c`

这三个中的任何一个都可以解决您的问题。

# ios - 请求facebook图片时出现错误代码2500

> ID：16051114
> 
> 赞同：1
> 
> 时间：2013-04-17T03:45:49.293
> 
> 标签：ios, facebook, permissions

我正在使用社交框架和帐户框架从我的应用程序访问 facebook。在一行代码中，我做了：

```
NSURL *meInfo = [NSURL URLWithString:@"https://graph.facebook.com/me"]; 
```

哪个是成功的。我得到一个带有数据的 json 对象，然后我可以在我的应用程序中使用它。令人困惑的是，在下一个代码块中，我这样做：

```
NSURL *meInfoPic = [NSURL URLWithString:@"https://graph.facebook.com/me/picture"]; 
```

它失败了：

```
error =     {
        code = 2500;
        message = "An active access token must be used to query information about the current user.";
        type = OAuthException;
    }; 
```

我的访问令牌显然是有效的，所以我不确定发生了什么。我对两者都使用的权限是“publish_stream”。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:08:11.473

我的错误是在图片请求 URL 中使用 /me/。一旦我用登录用户的用户 ID 替换了它，我就走得更远了。所以要清楚，我需要这样做：

```
NSURL *meInfoPic = [NSURL URLWithString:@"https://graph.facebook.com/123456789/picture"]; 
```

# ios - 错误：在 url 写入中格式字符串未使用数据参数

> ID：16051117
> 
> 赞同：0
> 
> 时间：2013-04-17T03:46:22.173
> 
> 标签：ios

在这里我制作了 constant.h 文件：代码是：

```
#define ip @"some ip"
#define urlString @"@/icancer/webservice_iphone/@"
#define ws_typesOfCancer @"typesOfCancerDisplay.php" 
```

在我的 .m 文件中，字符串格式为：-

```
NSString *str=[NSString stringWithFormat:urlString,ip,ws_typesOfCancer]; 
```

str 行中的错误...如何解决...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T03:52:45.830

您在 urlString 中的格式说明符不完整，试试这个。

```
#define urlString @"%@/icancer/webservice_iphone/%@" 
```

# internet-explorer - Google Maps API v3 未在 IE 8 的 iFrame 中显示

> ID：16051123
> 
> 赞同：0
> 
> 时间：2013-04-17T03:47:02.063
> 
> 标签：internet-explorer, google-maps, iframe

我设计了一个谷歌地图（[http://ozcamps.net/mapboundaries.php](http://ozcamps.net/mapboundaries.php)），它本身可以正常工作，但是当它嵌入到我的作品网站上的 iFrame 中时（我无法访问的 CMS 系统，因此iFrame）它使地图更小（大约 100 像素 x 200 像素）仅在 IE（我使用 8）中（在 FF、Safari、Chrome 中很好）。

这是带有 iFrame 的站点的链接：http: [//www.cbchs.org.au/Our-Sites/Our-Sites/Our-Sites.asp](http://www.cbchs.org.au/Our-Sites/Our-Sites/Our-Sites.asp)并单击左侧显示“CHS 边界”的按钮. 任何关于为什么的反馈将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:07:18.273

放置一个清晰的横幅来升级浏览器。IE 8 是新的 IE 6。有一个名为 nomoreie6.com 的网站或类似的网站，您可以使用它来获得不错的 CSS 和浏览器选择弹出窗口。或者，如果你真的相信你确实有 IE8 用户，你可以使用 chrome frame。请记住，您为支持过时的浏览器所做的持续努力会稍微减慢进化速度，哈哈。

# java - tictactoe 类的二维数组有问题

> ID：16051131
> 
> 赞同：0
> 
> 时间：2013-04-17T03:48:02.823
> 
> 标签：java, methods, multidimensional-array, tic-tac-toe

对于这个程序，我正在创建棋盘，这将成为我必须构建的 tictactoe 游戏的基础。这将是一个非常简单的程序，只使用 java 的基础知识。目前我无法让我的 setX() 和 setO() 方法正常工作。这是我在构建两种方法时得到的确切文本。

public void setX(int index) 和 public void setO(int index) 如果 index 在 board 和 BLANK 的范围内，这个方法应该将 X 或 O 分配给 board 中的适当索引（setX 应该放置一个 X；setO，一个○）。请记住，井字游戏传递 1-9 范围内的数字，但棋盘中的索引比该数字小 1（在 0-8 范围内）。

我的具体问题是如何将“x”和“o”设置为正确的索引。当我运行我的单元测试文件（我正在使用 bluejay）时，它会通过这些方法使所有测试用例都失败。它将返回该数组首先在 element[0][2]（或 [1][1] 或我的数组中的任何组合）处不同；期望（或）但是是：

```
public class Board
{
    // instance variables - replace the example below with your own
    public int SIZE = 3;
    private char BLANK = 'N';
    private char [][] board;

    /**
     * Constructor for objects of class Board, intializes all elements to BLANK, 
     * creates board with SIZE elements
     */
  public Board()
    {
        // initialise instance variables
        board = new char[SIZE][SIZE];
        for(int i = 0; i < board.length; i++){
            for(int j = 0; j < board.length; j++){
                board[i][j] = BLANK;
        }
    }
   }
   /**
    * this method returns the board
    */
   public char [][] getBoard(){

       return board;
    }
    /**
     * prints the elements of the array board in a 3x3 grid
     */
   public void display(){
         for(int i = 0; i < board.length; i++){
            for(int j = 0; j < board.length; j++){
                System.out.print(board[i][j]);
        }
    }
   }
    /**
     * This method assigns X to the appropriate index in board
     */
   public void setX(int index){
       index = index - 1;
          for(int i = 0; i < board.length; i++){
            for(int j = 0; j < board.length; j++){

                if((BLANK <= index) && (index <= board[i][j])){
                    board[i][j] = 'X';
                }
        }
    }

    }
    /**
    * This method assigns O to the appropriate index in board
    */
   public void setO(int index){

       for(int i = 0; i < board.length; i++){
            for(int j = 0; j < board.length; j++){

                if((BLANK <= index) && (index <= board[i][j])){
                    board[i][j] = 'O';
                }
        }
    }
    }
   /**
    * This method returns true if the index is not occupied by an X or O
    */
    public boolean isAvailable(int index){
        boolean available = false;
        for(int i = 0; i < board.length; i++){
            for(int j = 0; j < board.length; j++){
                board[i][j] = BLANK;
               available = true;
        }
    }
        return available;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T03:56:02.197

首先，我想知道为什么你甚至需要一个二维数组。为什么不将板表示为一个九元素的单个数组？

除此之外，将 1-9 位置索引转换为适当的二维索引的方法是：

```
int i = (index - 1) / 3;
int j = (index - 1) % 3; 
```

然后`board[i][j]`只处理那一对索引。您的`setX`and`setO`方法不应该循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T03:56:16.467

想象你的板看起来像这样，行标题是你的 y“坐标”，列标题是你的 x“坐标”，表格内容是你调用时的索引`setX`或`setO`：

```
 | 0 | 1 | 2
--+---+---+---
0 | 0 | 1 | 2
--+---+---+---
1 | 3 | 4 | 5
--+---+---+---
2 | 6 | 7 | 8 
```

现在，您需要为二维数组计算 x 和 y 值，如下所示：

```
y = index / 3;
x = index % 3; 
```

# javascript - 类似 Facebook 的按钮不起作用

> ID：16051135
> 
> 赞同：0
> 
> 时间：2013-04-17T03:48:46.903
> 
> 标签：javascript, html, facebook, api, facebook-like

我在代码中使用的类似 Facebook 的按钮不起作用。我已经完成了所有必要的工作：将 JavaScript 代码放置在 body 标记下方，并将`div`它的另一个标记放置在我希望按钮出现的位置，但我没有成功。这是我的代码：

```
<head>
    <meta charset="UTF-8" />
    <title>Riparian Preserve Survey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="bootstrap-responsive.min.css"type="text/css"/>
    <link rel="stylesheet" href="bootstrap.css" type="text/css"/>
    <script src="jquery-1.9.1.js"></script>
    <script src="bootstrap.min.js"></script>
    <script src="bootstrap.js"></script>

    <style>
        img {
            max-width: 100%;
        }
        body{
            background-color: #A4A4A4 ;
        }
    </style>
</head>
    <body> 
<div id="fb-root"></div>
<script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
   js = d.createElement(s); js.id = id;
   js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
   fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>    
...
 <div class="fb-like" data-href="https://www.facebook.com/GilbertTownHall"data-  send="true" data-width="450" data-show-faces="false"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T03:57:24.727

Facebook 使用我相信首先加载的 SDK，这是在他们的网站上，您尝试过吗？

```
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : 'YOUR_APP_ID',                        // App ID from the app dashboard
      channelUrl : '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel file for x-domain comms
      status     : true,                                 // Check Facebook Login status
      xfbml      : true                                  // Look for social plugins on the page
    });

    // Additional initialization code such as adding Event Listeners goes here
  };

  // Load the SDK asynchronously
  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/all.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:19:10.820

试试这样的：

```
window.fbAsyncInit = function () {
    if (FB.init) return;
    // init the FB JS SDK
    FB.init({
        appId: 'YOUR_APP_ID', // App ID from the App
        //channelUrl: '//' + window.location.hostname + '/channel.html',
        //This to get the user details back from Facebook
        //scope: 'id,name,gender,user_birthday,email', etc
        status: true, // check the login status upon init?
        cookie: true, // set sessions cookies to allow your server to access the session?
        xfbml: true  // parse XFBML tags on this page?
    });
} 
```

在 HTML 正文的末尾...

```
<script>
    (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
        fjs.parentNode.insertBefore(js, fjs);
    } (document, 'script', 'facebook-jssdk'));
</script> 
```

您也可以使用 fb 嵌入 iframe
[Facebook Like Button Reference](https://developers.facebook.com/docs/reference/plugins/like/)

# c++ - 带有字符数组 n 指针的 C++ 赋值、strcpy 和 strlen

> ID：16051136
> 
> 赞同：4
> 
> 时间：2013-04-17T03:48:47.800
> 
> 标签：c++, arrays, pointers

我正在处理这个任务并且遇到了一个问题。有一次，我必须要求用户提供两个稍后使用的输入命令，并且我希望将它们放入一个 char 数组中。然后我想将他们的输入放入 char* 但我最终遇到了分段错误

这是我的代码的一小部分，它显示了我遇到问题的地方：

```
#include <iostream>
#include <cstring>
using namespace std;

int main(){

char firstAns[80];
char * command1[5];
int ansLen;

//Ask for command
cout << "Please enter your first command(incl. args) or quit: ";
cin >> firstAns;

ansLen = strlen(firstAns);
for(int i=0; i < ansLen; i++){
strcpy(command1[i], firstAns);
} 
```

我从中运行的程序编译得很好，但我已将分段错误缩小到程序的这一部分，并且可以作为新手程序员使用一些帮助:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T03:54:22.300

您有一个名为命令的 char* 数组。但是您没有为数组中的指针分配任何内存，甚至没有将它们设置为空。所以它们是随机值，指向随机内存位置。然后，Strcpy 会覆盖这些随机位置，从而导致段错误。您需要`command[i]=new char[80]`首先在所有 5 行上为这些指针分配内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T03:53:15.413

`char * command1[5];`

这是一个`char*`s 数组。但是，它是未初始化的——这些值可以是任何值，因此它们指向内存中随机的、无意义的位置。

然后，您稍后使用未初始化`command1[i]`的 in `strcpy(command1[i], firstAns);`。本质上，您所做的只是在内存中随机放置并尝试将 firstAns 复制到其中。难怪你的程序崩溃了！

在使用指针之前，您必须将其初始化为某个值。如果您需要在内存中存储，请使用`malloc()`返回正确大小的存储空间（`sizeof(datatype)*length`如果是字符串则为 +1），并`free()`在完成后记住从它返回的指针。

阅读更多：[http ://www.cplusplus.com/reference/cstdlib/malloc/](http://www.cplusplus.com/reference/cstdlib/malloc/)

（Gabe Sechan 的解决方案也有效。new 和 malloc 是 C++ 和 C 分配内存的方式）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:01:19.943

附加问题在这里：

```
 ansLen = strlen(firstAns);
  for(int i=0; i < ansLen; i++){
     strcpy(command1[i], firstAns);
  } 
```

`ansLen`是 的长度`firstAns`，它可能比 5 长。在这种情况下，如果您尝试访问`command1[i]`，您将访问超出范围的内存，导致段错误。

同时，您正在使用`command1`Patashu 和 Gabe 指出的单元化。

# video - 修复 Ooyala 的嵌入视频代码

> ID：16051138
> 
> 赞同：0
> 
> 时间：2013-04-17T03:48:50.267
> 
> 标签：video, ooyala

我正在使用带有自定义构建主题的 Wordpress。

我可以选择帖子格式，如音频、视频、报价等。

当我选择我的帖子作为视频时，它显示两个选项视频 URL，视频嵌入代码。

在视频嵌入代码中，如果我从 Youtube 放入嵌入代码，它就可以工作。但主要问题是我在 Ooyala.com 上上传了我的视频。当我从 ooyala 插入我的 html 嵌入代码时。它不显示视频它只显示代码。（没有视频）

在浏览了我的主题代码之后，我遇到了这个代码，它可以将嵌入代码转换为

```
function wpbandit_video_wmode_transparent($html, $url, $attr) {
if ( strpos( $html, "<embed src=" ) !== false ) {
    $html = str_replace('</param><embed', '</param><param name="wmode" value="opaque"></param><embed wmode="opaque" ', $html);
} elseif ( strpos ($html, 'feature=oembed') !== false ) {
    $html = str_replace('feature=oembed', 'feature=oembed&wmode=opaque', $html);
} 
    return $html;
}
    add_filter('embed_oembed_html','wpbandit_video_wmode_transparent',10,3);

/**
    Add container to default video embeds
**/
function wpbandit_embed_oembed_html($html, $url, $attr, $post_id) {
    return '<div class="video-container">' . $html . '</div>';
}
add_filter('embed_oembed_html', 'wpbandit_embed_oembed_html', 99, 4); 
```

我从 ooyala 获得的代码作为我的视频嵌入代码是这样的：

```
<script src='https://player.ooyala.com/v3/84b6e4bac6d945439a38bdfff895a0fd'></script>    <div id='ooyalaplayer' style='width:1280px;height:720px'></div><script>OO.ready(function() {     OO.Player.create('ooyalaplayer', 'N5MG1rYTpsId-Q4ZlUy1JEykqD5QMWEN'); });</script><noscript>    <div>Please enable Javascript to watch this video</div></noscript> 
```

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:18:11.983

尝试安装我们的 Wordpress 插件：[http ://wordpress.org/extend/plugins/ooyala-video-browser/](http://wordpress.org/extend/plugins/ooyala-video-browser/)

# mysql - 为什么 Rails 在创建新记录时在 SQL 查询中生成 BINARY

> ID：16051140
> 
> 赞同：5
> 
> 时间：2013-04-17T03:49:21.613
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3

我有模型项目和位置。

这是我的项目模型迁移文件：

```
class CreateItems < ActiveRecord::Migration
  def change
    create_table :items do |t|
      t.string :item_cd
      t.string :item_name

      t.integer :location_id
      t.timestamps
    end
  end
end 
```

我使用 form_tag 创建一个用于创建新项目的表单。但是当我创建新项目时，Rails 会生成如下 SQL：

```
Location Load (0.3ms)  SELECT `locations`.* FROM `locations` WHERE `locations`.`location_cd` = 'jp' LIMIT 1
  Item Load (0.2ms)  SELECT `items`.* FROM `items` WHERE `items`.`item_cd` = '6' LIMIT 1
   (0.1ms)  BEGIN
  Item Exists (0.2ms)  SELECT 1 FROM `items` WHERE `items`.`item_cd` = BINARY '6' LIMIT 1
  SQL (0.6ms)  INSERT INTO `items` (`created_at`, `item_cd`, `item_name`, `location_id`, `updated_at`) VALUES ('2013-04-17 03:26:42', '6', 'Glasses', 12, '2013-04-17 03:26:42')
   (27.6ms)  COMMIT 
```

为什么 SQL`BINARY`在 Item Exists 行中有？我插入一个字符串以在表单上创建 item_cd。谁能告诉我什么问题？

我正在使用mysql数据库。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T09:02:51.143

看起来您的模型中有一些验证，例如

```
validates :item_cd, :uniqueness => true 
```

显然，这将使模型检查数据库中是否存在相等的值，因此`Exist`查询。

在比较之前将字符串 '6' 转换为二进制的原因是二进制比较对`char`和`varchar`值更快。通常，比较将通过整理过程，以便（例如）'6' = '6' 或'a' = 'A'。由于查询只需要检索完全匹配（也不是值，只是它们的存在：SELECT 1），因此二进制比较就足够了。

您还可以查看相关的 MySQL 文档： [http ://dev.mysql.com/doc/refman/5.0/en/charset-binary-op.html](http://dev.mysql.com/doc/refman/5.0/en/charset-binary-op.html)

# php - 基于列名的 PHP/MySQL 匹配单元格

> ID：16051144
> 
> 赞同：0
> 
> 时间：2013-04-17T03:49:46.823
> 
> 标签：php, mysql

我有一个看起来像这样的数据库。

```
 x  2  3  4  5
 4  8 12 16 20
 5 10 15 20 25
 6 12 18 24 30
 7 14 21 28 35 
```

当最终用户插入一个值时，我想将 x 变量与 x 列中的值匹配，将另一个变量与数字列名匹配。

那么我将如何编写一个执行此操作的 SQL 查询呢？

```
SELECT * FROM times_tables WHERE x=4 and COLUMN_NAME=4; 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T04:00:07.107

```
SELECT
    `4`
FROM
    (SELECT
        4 as `x`, 8 as `2`, 12 as `3`, 16 as `4`, 20 as `5`
    UNION ALL
        SELECT 5, 10, 15, 20, 25
    UNION ALL
        SELECT 6, 12, 18, 24, 30
    UNION ALL
        SELECT 7, 14, 21, 28, 35) `times_tables`
WHERE
    `x` = 4 
```

输出：

```
4
---
16 
```

因此，在您的情况下，查询可能是这样的：

```
SELECT `{$col}` FROM `times_tables` WHERE `x` = {$row}; 
```

**升级版：**

可以用纯 SQL 完成：

```
SET @r = 4; -- row
SET @c = 5; -- col

SET @qry = CONCAT('SELECT `', @c ,'` FROM `times_tables` WHERE `x` = ', @r);

PREPARE stmt FROM @qry;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

**PS：**您可以将 SQL 包装到存储过程中以获得更好的保护。

# asp.net-mvc - 编辑视图时出现运行 MVC 项目的问题

> ID：16051156
> 
> 赞同：2
> 
> 时间：2013-04-17T03:51:14.580
> 
> 标签：asp.net-mvc, visual-studio, visual-studio-2012

简单来说，每当我在 Visual Studio 2012 上聚焦视图（在编辑器窗口中）时运行（调试）我的 MVC 项目，浏览器上显示的网页就是视图本身，而不是实际的登录页面。

例如：如果我通常的登陆页面如下：

```
http://localhost:53338/ 
```

然后，如果我关注“添加”视图并运行我的项目，它会将我发送到这里：

```
http://localhost:53338/Views/Products/Add.cshtml 
```

知道如何“解决”这个问题吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:06:40.760

您的 Web 调试配置设置为运行“*当前页面*”。

**以下是如何解决它的步骤：**

1.  转到项目的属性（右键单击项目 -> 单击*属性*）。
2.  转到*Web*选项卡。
3.  选择*开始 URL*单选按钮并将地址文本框留空。
4.  在*项目 URL*类型中：`http://localhost:[portNumber]/`

祝你好运

# dynamics-crm-2011 - CRM 2011 如何在沙盒模式下加载和管理插件？

> ID：16051158
> 
> 赞同：3
> 
> 时间：2013-04-17T03:51:30.837
> 
> 标签：dynamics-crm-2011

我有 2 个插件程序集，它们共享 crmsvcutil 生成的代理代码。代理代码文件往往很大（14+ MB），并且似乎使插件 Dll 膨胀。

我认为将代理代码偏移到单独的程序集中并将其部署到 CRM 服务器上的 GAC 可能是有意义的。这将减少插件程序集中的膨胀并减少内存占用，因为只有一个副本代理代码将被加载到进程空间中。

问题是，CRM 如何加载单个插件程序集？它们是全部加载到同一个进程空间还是加载到单独的应用程序域中？

如果它们被加载到单独的应用程序域中，那么它会破坏包含生成的代理代码的单独程序集的目的，因为无论如何它将被单独加载到两个应用程序域中。

任何想法表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T09:32:31.147

我无法直接回答您的问题，但如果问题是膨胀，那么 crmsvcutil 有许多扩展，可以让您过滤生成的类文件以仅包含您希望使用的实体。我以前做过（在以前的公司，后来丢失了源代码。Grrrr！）成功地实现了一个几 kb 而不是 mb 的类文件。

一个快速的谷歌搜索带我到... [http://fourbusyxrmarchitects.wordpress.com/2012/08/09/filtering-the-list-of-early-bound-classes-generated-by-the-code-generation-工具-crmsvcutil-for-crm-2011-2/](http://fourbusyxrmarchitects.wordpress.com/2012/08/09/filtering-the-list-of-early-bound-classes-generated-by-the-code-generation-tool-crmsvcutil-for-crm-2011-2/)

# r - 导入多个文件

> ID：16051163
> 
> 赞同：0
> 
> 时间：2013-04-17T03:52:12.330
> 
> 标签：r

我有大约三十个文件夹，每个文件夹中有许多文件，每个文件都包含不同信息的矩阵。我需要能够导入这些文件，以便我可以绘制矩阵的图像。我知道如何绘制图像，但我不知道如何获取所有文件。有没有办法遍历每个文件夹并从每个文件夹中获取我需要的单个文件？这是每年的气象数据。所以我拥有的是年度文件夹，每个文件夹都包含相同的变量。我需要一个循环，可以从 2005 文件夹中提取温度文件，然后从 2006 文件夹中提取温度文件，依此类推。这可以通过 for 循环或应用来完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:11:23.590

查看`?list.dirs`和相关功能`list.files`（两者都记录在同一个帮助页面中。）

首先列出目录，例如：

```
> (dirs <- list.dirs("~/foo", recursive = FALSE))
[1] "/home/gavin/foo/bar1" "/home/gavin/foo/bar2" 
```

然后遍历这些，列出当前目录中的文件并读入一个列表，例如

```
loadFiles <- function(dirs) {
  fs <- list.files(dirs, full.names = TRUE, no.. = TRUE)
  lapply(fs, read.table, ....)
}
fs <- lapply(dirs, loadFiles) 
```

替换`read.table`读取文件所需的任何函数，替换为（或相关函数）的`....`附加参数。`read.table`

然后，您可以使用`rapply`to 循环`fs`进行绘图。

~~请注意，以上都没有经过测试，因为没有可重现的示例，我可以快速放入几个文件和文件夹中进行测试。~~

这是这种设置的示例

```
> list.dirs("~/foo", recursive = FALSE)
[1] "/home/gavin/foo/bar1" "/home/gavin/foo/bar2"
> list.files("~/foo/bar1")
[1] "file1.csv" "file2.csv" "file3.csv"
> list.files("~/foo/bar2")
[1] "file1.csv" "file2.csv" "file3.csv"

loadFiles <- function(dirs) {
  fs <- list.files(dirs, full.names = TRUE, no.. = TRUE)
  lapply(fs, function(x) data.matrix(read.csv(x, row.names = 1)))
}
fs <- lapply(list.dirs("~/foo", recursive = FALSE), loadFiles) 
```

`fs`现在看起来像这样：

```
> str(fs)
List of 2
 $ :List of 3
  ..$ : num [1:5, 1:5] -1.65 -2.47 1.27 0.14 -0.22 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:5] "1" "2" "3" "4" ...
  .. .. ..$ : chr [1:5] "V1" "V2" "V3" "V4" ...
  ..$ : num [1:5, 1:5] 0.417 0.186 -2.452 -0.695 -1.216 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:5] "1" "2" "3" "4" ...
  .. .. ..$ : chr [1:5] "V1" "V2" "V3" "V4" ...
  ..$ : num [1:5, 1:5] 1.41924 -1.96918 0.38819 -0.41437 0.00718 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:5] "1" "2" "3" "4" ...
  .. .. ..$ : chr [1:5] "V1" "V2" "V3" "V4" ...
 $ :List of 3
  ..$ : num [1:5, 1:5] -1.791 0.805 0.302 -0.383 -0.793 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:5] "1" "2" "3" "4" ...
  .. .. ..$ : chr [1:5] "V1" "V2" "V3" "V4" ...
  ..$ : num [1:5, 1:5] 0.305 0.353 -0.342 0.515 -0.375 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:5] "1" "2" "3" "4" ...
  .. .. ..$ : chr [1:5] "V1" "V2" "V3" "V4" ...
  ..$ : num [1:5, 1:5] -0.634 -0.776 0.517 -0.845 0.83 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:5] "1" "2" "3" "4" ...
  .. .. ..$ : chr [1:5] "V1" "V2" "V3" "V4" ... 
```

我还没想好怎么去`rapply()`这里工作，但是

```
lapply(fs, function(x) lapply(x, image)) 
```

将绘制两个列表中的每一个中的 3 个矩阵中的每一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T04:12:09.820

在窗户上：

假设您有年度文件夹，`D:/data`并且每个文件夹都有文件名`temperature.csv`

```
# set the main working directory
setwd("D:/data")

# allocate a list for temperature matrices
list.temp.matrix = vector("list",length(list.dirs(recursive=FALSE)))

# iterate through each folder and load the file
i <- 1
for (dir.name in list.dirs(recursive=FALSE))
{
    file.name <- paste0(dir.name, "/temperature.csv")
    temp.matrix <- as.matrix(read.csv(file.name))

    # update the list
    list.temp.matrix[[i]] <- temp.matrix
    i <- i + 1

    # to avoid over-writing plots
    x11()                                       
    image(temp.matrix)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:44:31.313

如果您希望将所有文件作为数据帧读取到当前会话中，您可以执行类似的操作。我创建了一个名为 temp 的临时目录

```
> getwd()
[1] "/Users/homedir/tmp" 
```

它有 3 个目录，其中包含来自不同年份的数据。

```
> dir()
[1] "data2005" "data2006" "data2007" 
```

在这些文件中保存了一些文件（出于示例的目的，它们是相同的。

```
> ddfwind <- data.frame(x=runif(10), y=runif(10))
> ddfsun <- data.frame(x=runif(10), y=runif(10)) 
```

将这些文件保存到目录以设置示例...

```
> lapply(dir(), function(x) {
+       save(ddfwind, file=paste(x,"wind.dat",sep="/"))
+       save(ddfsun,file=paste(x,"sun.dat",sep="/"))
+ }) 
```

在一个新的 R 会话中，我转到目录 tmp 并从所有目录中获取所有名称中包含风的文件

```
> fn.windData <- dir(pattern="wind.dat$", recursive=TRUE) 
```

然后我曾经`lapply`遍历这些文件并将它们加载到当前的 R 会话中，将每个文件的年份附加到数据框对象的末尾。

```
> lapply(fn.windData, function(x) {
+ L1 <- load(x) 
+ assign(paste0(L1, gsub("[a-z./]", "", x)), get(L1), envir=.GlobalEnv)
+ })
> ls()
[1] "ddfwind2005" "ddfwind2006" "ddfwind2007" "fn.windData" 
```

# ios - 应用因后台定位模式而被拒绝

> ID：16051167
> 
> 赞同：0
> 
> 时间：2013-04-17T03:52:26.853
> 
> 标签：ios, background, core-location

我在其 Info.plist 文件中包含 UIBackgroundModes 键（带有位置值）。如果不包括 UIBackgroundModes，应用程序在后台运行时可以定位吗？我的应用不需要后台实时位置更新。所以我的应用被拒绝了。应用商店回复：“我们注意到您的应用在 Info.plist 中的 UIBackgroundModes 键中声明支持位置，但不包括需要持久位置的功能。”我的应用需要特定情况下的位置，而应用在后台。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-11T22:46:44.243

Apple 拒绝了您的应用程序，因为它使用了过多的电池电量。

您需要重写您的应用程序以使其不使用过多的电池电量，或者让 Apple 相信您需要按照自己的方式进行操作。

它们将允许应用程序消耗大量电池，但前提是没有其他方法来实现。由于您的应用被拒绝，因此可能还有另一种选择。

您也许可以向 Apple 提交 TSI。[https://developer.apple.com/support/technical/submit/](https://developer.apple.com/support/technical/submit/)

# ios - 关于 NSArray nil 崩溃错误

> ID：16051168
> 
> 赞同：0
> 
> 时间：2013-04-17T03:52:29.877
> 
> 标签：ios, objective-c, nsmutablearray, nsarray

如何避免这个崩溃错误！主线程日志中的崩溃是

```
ProcessArray:()
ProcessArray == 0
-[NSNull length]: unrecognized selector sent to instance 0x3c4e1090 
```

我的代码：

```
ProcessArray = [EventSheetDetailArray  valueForKey:@"Process"];
NSLog(@"ProcessArray:%@",ProcessArray);

if (ProcessArray.count > 0 ) {
    NSLog(@"ProcessArray != 0");
    [self ProcessJSONDateFormat];
}else{
    NSLog(@"ProcessArray == 0");
} 
```

下面我换评委！

```
id value = [EventSheetDetailArray valueForKey:@"Process"];
if ( ![[NSNull null] isEqual:value] )
{
    ProcessArray = value;
    NSLog(@"1111111");
}else{
    NSLog(@"2222222");
} 
```

但始终运行 NSLog(@"1111111") 这一行！不管是否有任何价值！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T04:01:56.727

验证来自 [EventSheetDetailArray valueForKey:@"Process"] 的返回值

```
id value = [EventSheetDetailArray valueForKey:@"Process"];
if ( ![[NSNull null] isEqual:value] )
{
    ProcessArray = value;
} 
```

或者

```
id value = [EventSheetDetailArray valueForKey:@"Process"];
if ( [value isKindOfClass:[NSArray class]] )
{
    ProcessArray = value;
} 
```

那么你可以调用 NSArray 成员函数，不要只是假设它是 NSArray..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T07:17:28.780

答案其实很简单。

```
if([ProcessArray count] != [NSNULL NULL]) {
    if (ProcessArray.count > 0 ) {
      NSLog(@"ProcessArray != 0");
     [self ProcessJSONDateFormat];
    }else {
      NSLog(@"ProcessArray == 0");
    }
}else {
      NSLog(@"NULL...insert some value");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-27T10:47:13.557

如果你的数组是空的，那么你不能检查计数，否则它会崩溃。我遇到了同样的问题。只需使用“if(!(array==nil))”。当你的数组为空时这是真的，否则它会移至其他部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T05:39:16.220

对不起！我找到了错误的原因，因为我的其他代码有错误，导致主线程崩溃-[NSNull length]原因！

# .htaccess - 两个 RewriteRule 是如何合二为一的？

> ID：16051169
> 
> 赞同：-1
> 
> 时间：2013-04-17T03:52:31.000
> 
> 标签：.htaccess, mod-rewrite

我有两个重写代码行：

```
RewriteRule ^([a-z]+)/meishi/*$ index.php?city=$1&category=1
RewriteRule ^([a-z]+)/meishi/([0-9]+)/*$ index.php?city=$1&category=1&page=$2 
```

如何将两个`RewriteRule`s 合二为一？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:04:27.583

如果你不介意`page=`结尾有一个空白，你可以像这样组合这两个规则：

```
RewriteRule ^([a-z]+)/meishi(/([0-9]+))?/*$ index.php?city=$1&category=1&page=$3 
```

# django - Jquery Autocomplete x Amazon CloudSearch 编码

> ID：16051173
> 
> 赞同：0
> 
> 时间：2013-04-17T03:52:43.733
> 
> 标签：django, character-encoding, amazon, jquery-autocomplete, amazon-cloudsearch

我使用**Amazon CloudSearch**作为**JQuery Autocomplete select**的源。它工作得很好，但是由于我无法识别的原因，当只返回**一个**结果时，编码变得一团糟。

该解决方案的工作原理如下：

人们输入给定城市的社区或街道的文本输入：

```
<div id="searchFormContainer">
    <input type="text" value="&nbsp;Digite o bairro ou rua" name="inputSearch" id="inputSearch"/>
</div> 
```

JQuery 自动完成配置：

```
var sourceFunction = function (request, response) {
    var successFunction = function (places) {
        var placesWithLabel = jQuery.map(places, function (place) {
            var label = (place.addressName) ? place.addressName+', ' : '';
            label += place.neighborhoodName;
            var value = label;
            return {label:label, value:value};
        });
        if(placesWithLabel.length==0){
            placesWithLabel.push({label:"Não encontrado", value:""})
        } 
        response(placesWithLabel);
    }

    var ajaxOptions = {appendTo: '#searchFormContainer', 
                       url: '/textSearch', dataType: "json", 
                       data: {strToSearch: request.term, 
                       cityName: self.place.city.name}, 
                       success: successFunction};
    jQuery.ajax(ajaxOptions);
};

var openFunction = function () {
    jQuery(this).removeClass( "ui-corner-all" ).addClass( "ui-corner-top" );
};

var closeFunction = function () {
    jQuery( this ).removeClass( "ui-corner-top" ).addClass( "ui-corner-all" );
};

var selectFunction = function (event, data) {
    if(data.item.value==""){
        return;
    }else{
        //redirect to result page
    }
};

**var autocompleteOptions = {appendTo: '#searchFormContainer',
    source: sourceFunction,
    minLength: 1,
    open: openFunction,
    close: closeFunction,
    select: selectFunction};**

**$('#searchFormContainer #inputSearch').autocomplete(autocompleteOptions);** 
```

它成功运行，调用我的名为**textSearch**的 python 视图，它执行以下操作：

```
def textSearch(request):
    results = simplejson.loads(requests.get('http://%s/2011-02-01/search?' % (settings.SEARCH_CLOUD_HOST), params=fieldsParameter).text)['hits']
    return HttpResponse(simplejson.dumps(results), mimetype='application/json') 
```

例如，在 Cerqueira César 附近搜索名为 Oscar Freire 的街道时，当我在自动完成中键入**Oscar Fr**时，Amazon CloudSearch 会返回**两个**结果：

```
[16/Apr/2013 23:59:47] "GET /textSearch?strToSearch=Oscar+F&cityName=S%C3%A3o+Paulo HTTP/1.1" 200 682
Neighbourhood from Amazon --> Cerqueira César
Returns from Amazon --> {'id_address': u'52267', 'neighborhoodName': u'Cerqueira C\xe9sar', 'addressName': u'Rua Oscar Freire', 'id_neighborhood': u'19694'}

Neighbourhood from Amazon --> Jardim Anália Franco
Returns from Amazon --> {'id_address': u'61073', 'neighborhoodName': u'Jardim An\xe1lia Franco', 'addressName': u'Rua Jos\xe9 Oscar Abreu Sampaio', 'id_neighborhood': u'19881'} 
```

但是，用搜索关键字**Oscar Fre**再输入一个字母，它只返回**一个**结果：

```
[16/Apr/2013 23:59:49] "GET /textSearch?strToSearch=Oscar+Fr&cityName=S%C3%A3o+Paulo HTTP/1.1" 200 286
Neighbourhood from Amazon --> Cerqueira CĂŠsar
Returns from Amazon --> {'id_address': u'52267', 'neighborhoodName': u'Cerqueira C\u0102\u0160sar', 'addressName': u'Rua Oscar Freire', 'id_neighborhood': u'19694'} 
```

正如我们在输出中看到的，返回的对象是相同的（两个结果的 id_address 相同）。此条目的亚马逊对象（从 CloudSearch 中提取的原始 JSON）是：

```
{"rank":"-text_relevance","match-expr":"(label 'Oscar Freire')","hits":{"found":1,"start":0,"hit":[{"id":"52267","data":{"address":["Rua Oscar Freire"],"bairro":["Cerqueira César"],"fieldtype":["address"],"id_address":["52267"],"id_neighborhood":["19694"],"latitude":["-23.568315"],"longitude":["-46.66293"],"text_relevance":["310"]}}]},"info":{"rid":"e2467862eecf73","time-ms":3,"cpu-time-ms":0}} 
```

对我来说很清楚，响应来自我的 python 视图的错误编码。但我无法意识到这个问题从哪里开始。如果这是 JQuery 自动完成的不良行为或亚马逊响应的问题。有任何想法吗？

此致

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T19:33:45.797

我认为隔离问题的可能原因很重要。这里有太多可能的编码问题来源，您应该从消除可能的问题来源开始。

如果您在浏览器中搜索“Oscar Fr”与“Oscar F”（使用 CloudSearch 搜索端点），编码是否会发生变化？如果它保持不变，那么问题不在于 CloudSearch，您可以向上移动堆栈。

# c# - C#防止控制台应用程序构建为Windows应用程序退出？

> ID：16051175
> 
> 赞同：5
> 
> 时间：2013-04-17T03:52:57.283
> 
> 标签：c#, console-application, exit, windows-applications

我有一个控制台应用程序，**构建为**Windows 应用程序，作为后台进程运行（我称之为`App 1`）。
当我运行其他应用程序时，我向 发送消息`App 1`，然后它处理消息。
我想阻止`App 1`退出直到我按下热键。

你能帮我**如何防止`App 1`自动退出**吗？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T04:07:42.730

检查这个论坛

[防止控制台应用程序在到达主程序末尾时退出](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/9268d273-b8da-4a9c-ba5a-ea9462577415/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T04:04:51.597

您正在寻找的是如何注册热键。

尝试这个：

```
[DllImport("user32.dll", CharSet = CharSet.Auto, ExactSpelling = true)]

public static extern bool RegisterHotKey(IntPtr hWnd, int id, uint fsModifiers, int vk); 
```

来源： http: [//msdn.microsoft.com/en-us/library/ms646309 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms646309(v=vs.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T07:00:05.550

```
 static void Main(string[] args)
    {
        // do something here...

        string answer = Console.ReadLine();
        while (answer != "Exit")
        {
            answer = Console.ReadLine();
        }
    } 
```

# ruby-on-rails - 如何使用 haml 向 link_to_unless_current 添加图标？

> ID：16051182
> 
> 赞同：0
> 
> 时间：2013-04-17T03:53:19.207
> 
> 标签：ruby-on-rails, haml

有没有办法在下面的link_to_unless_current 中添加一个图标？我需要在当前和非当前状态下添加它。

```
= link_to_unless_current("Stats", stats_practice_path(current_user.practice)) do content_tag(:div, content_tag(:p, "Stats"), :class => "nav-active") end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:21:45.560

我认为您为此使用了辅助方法。

前任：

```
module ApplicationHelper

   def icon(image = "youricon.png")
     raw(image_tag(image)) 
   end

end 
```

在您看来：

```
= link_to_unless_current(icon, stats_practice_path(current_user.practice)) do content_tag(:div, content_tag(:p, "Stats"), :class => "nav-active") end 
```

（注意：我自己没有对此进行测试，我认为它应该可以工作:)）

# d3.js - d3 js树布局多个父母

> ID：16051183
> 
> 赞同：4
> 
> 时间：2013-04-17T03:53:26.107
> 
> 标签：d3.js, tree, force-layout, directed-acyclic-graphs

我正在尝试为数据集获取树布局，其中我有可以有多个父节点的节点。在这种情况下创建的链接具有非常大的路径值。有没有办法克服这个问题。我可以创建一个强制布局，但是对于手头的问题，树形布局感觉更加结构化和自然。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T13:25:36.850

如果你有多个父母，你就没有真正的树状结构。网络布局是您的最佳选择。[这](http://bl.ocks.org/colin-young/5165614)是一个带有约束的力布局示例。在这种情况下，我已将 x 值强制为特定值。您可以使用树级别执行类似的操作来设置您的 x 或 y 值。

相关代码为：

```
var adjust_x = function(d) {
  return x(d.time);
};

force.on("tick", function () {
    link.attr("x1", function (d) {
        return adjust_x(d.source);
    }) // snipped remainder... 
```

# facebook-graph-api - 是否可以从 iOS/Android Facebook 应用中查询“照片同步”功能上传的照片

> ID：16051191
> 
> 赞同：1
> 
> 时间：2013-04-17T03:54:31.377
> 
> 标签：facebook-graph-api, photo

我正在开发一项功能，允许用户从 Facebook 中选择他的一张照片来做相应的事情。

事实上，我可以查询他所有的相册和照片，除了“照片同步”上传的照片，这是iOS/Android Facebook 应用程序的新功能。

我想知道是否可以通过图形 api 查询它们以供进一步使用？需要什么特别许可吗？

# javascript - jQuery 最近的类选择器

> ID：16051196
> 
> 赞同：29
> 
> 时间：2013-04-17T03:55:30.120
> 
> 标签：javascript, jquery

```
<div class="wrap">
    <div class="Level2">Click me</div>
    <div class="Level3">Information</div>
</div>

<div class="wrap">
    <div class="Level2">Click me</div>
    <div class="Level3">Information</div>
</div>

<div class="wrap">
    <div class="Level2">Click me</div>
    <div class="Level3">Information</div>
</div>

<div class="wrap">
    <div class="Level2">Click me</div>
    <div class="Level3">Information</div>
</div> 
```

jQuery

```
$('.Level2').click(function(){
   $('.Level2').closest('.Level3').fadeToggle();
}); 
```

我想选择最接近fadeIn 和fadeOut 的level3，但不起作用。我的语法错了吗？在线示例：http: [//jsfiddle.net/meEUZ/](http://jsfiddle.net/meEUZ/)

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-04-17T03:58:38.640

尝试`.next()`而不是`.closest()`遍历 DOM 元素的祖先。

[**工作演示**](http://codepen.io/rishabhp/pen/bgZBML)

另外，您应该使用`$(this)`而不是`$('.Level2')`其他方式，它会选择所有`.Level2`而不是单击的。

你也可以选择这样的东西 - `$(this).closest('.wrap').find('.Level3').fadeToggle();`。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-17T03:58:17.360

jQuery 的[.closest()](http://api.jquery.com/closest/)方法不选择兄弟选择器，而是选择父选择器。看起来您正在寻找[.siblings()](http://api.jquery.com/siblings/)方法。

```
$('.Level2').click(function(){
   $(this).siblings('.Level3').fadeToggle();
}); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-17T03:58:14.063

最接近的沿着 dom 树上行。它不会找到兄弟姐妹的东西。您可以使用 find on a parent 来实现此目的

```
$('.Level2').click(function(){
       $(this).parent().find('.Level3').fadeToggle();
    }); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-02-10T06:29:49.700

是的，在 Jquery 中有很多方法可以找到最接近的**DOM**元素

```
$('.Level1').click(function(){
   $(this).next('.Level3').fadeToggle();
});
$('.Level2').click(function(){
   $(this).closest('.wrap').find('.Level3').fadeToggle();

});
$('.Level4').click(function(){
    $(this).parent().find('.Level3').fadeToggle(); 
});

$('.Level5').click(function(){
    $(this).siblings('.Level3').fadeToggle();
});
```

```
.level{background:Red;width:200px;height:40px;}
.Level3{background:blue;width:300px;height:50px;}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div class="wrap">
    <div class="Level1 level">Click me()sing next)</div>
    <div class="Level3">Information</div>
</div>

<div class="wrap">
    <div class="Level2 level">Click me(Using closest)</div>
    <div class="Level3">Information</div>
</div>

<div class="wrap">
    <div class="Level4 level">Click me(Usingh Parent)</div>
    <div class="Level3">Information</div>
</div>

<div class="wrap">
    <div class="Level5 level">Click me(Using Sibiling)</div>
    <div class="Level3">Information</div>
</div>
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T04:02:13.550

是的！`closest`从您传递给它的选择器开始 DOM 搜索，然后向上 DOM 层次结构，搜索父母/祖先。使用`siblings`或`next`代替。像这样：

```
$('.Level2').click(function(){
    $(this).siblings('.Level3').fadeToggle();
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-19T04:46:33.667

从下面的代码中得到一个清晰的想法：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $(".add").on("click", function () {
            var v = $(this).closest(".division").find("input[name='roll']").val();
            alert(v);
        });
    });
</script>
<?php

for ($i = 1; $i <= 5; $i++) {
    echo'<div class = "division">'
        . '<form method="POST" action="">'
        . '<p><input type="number" name="roll" placeholder="Enter Roll"></p>'
        . '<p><input type="button" class="add" name = "submit" value = "Click"></p>'
        . '</form></div>';
}
?> 
```

# html - 从 iOS 上的 html 输入中删除选择灰色阴影

> ID：16051197
> 
> 赞同：4
> 
> 时间：2013-04-17T03:55:37.203
> 
> 标签：html, ios, css, xcode, uiwebview

我目前正在为我的 iOS 应用程序开发 html 富文本编辑器，所以，设置很简单，我有一个 UIWebView 加载我的编辑器代码，html 输入是一个**'contentEditable' DIV**。

问题是每次我选择这个 div 输入一些文本时，输入框上都会出现一个浅灰色框，告诉用户该文本字段已被选中。

**注意**：您可以在此快速查看效果[：您可以在此快速视频](http://litsdevelopment.com/temporary/teste.mov)

我的问题是：**如何去除这个浅灰色框架？**

我的html文件如下：

```
<html>

<head>

    <style type="text/css">

        :focus{

            outline:0px solid transparent;

        }

        DIV::-moz-focus-inner {
            background-color:#ff0000;
            border: 0;
            padding: 0;
        }

        ul{
            margin-left:-10px;
        }
        ol{
            margin-left:-10px;
        }

        blockquote {

            border-left:#ff0000 5px double;
            margin-left:0px;

        }

    </style>

</head>

<body onload="addImgAttributes();checkBlockquote();" topmargin="0" bottommargin="0" leftmargin="0" rightmargin="0">

    <div
        id="content"
        class="content"
        contenteditable="true"
        style="font-family: Helvetica; background-color:#fff; color:#000; height:258px;"
        autocapitalize="off"
        autocorrect="off"
        autocomplete="off"
        spellCheck="false"
    >
    </div>

</body>

</html> 
```

//------------------------------------------------ -------------------------------------------------- ---------------- 编辑 1 -----

在@StephenJ 发表评论后，我意识到这个灰色框架可能是 UIWebView 的子视图，而不是 css 属性。我在框架出现的那一刻从 UIWebView 记录了视图层次结构，这是日志：

```
2013-04-17 21:37:00.919 StrangeThings[1182:c07] <UIWebView: 0xa5ec3f0; frame = (7 7; 306 258); layer = <CALayer: 0xa5edf30>>
2013-04-17 21:37:00.919 StrangeThings[1182:c07] <_UIWebViewScrollView: 0xa5f7850; frame = (0 0; 306 258); clipsToBounds = YES; autoresize = H; gestureRecognizers = <NSArray: 0xa5f7e20>; layer = <CALayer: 0xa5f7aa0>; contentOffset: {0, 0}>
2013-04-17 21:37:00.920 StrangeThings[1182:c07] <UIImageView: 0xa5f90c0; frame = (0 0; 54 54); transform = [-1, 0, -0, -1, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xa5f9120>>
2013-04-17 21:37:00.920 StrangeThings[1182:c07] <UIImageView: 0xa5f9030; frame = (0 0; 54 54); transform = [0, 1, -1, 0, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xa5f9090>>
2013-04-17 21:37:00.920 StrangeThings[1182:c07] <UIImageView: 0xa5f8fa0; frame = (0 0; 54 54); transform = [0, -1, 1, 0, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xa5f9000>>
2013-04-17 21:37:00.921 StrangeThings[1182:c07] <UIImageView: 0xa5f8b90; frame = (0 0; 54 54); alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xa5f8f70>>
2013-04-17 21:37:00.921 StrangeThings[1182:c07] <UIImageView: 0xa5f8b00; frame = (-14.5 14.5; 30 1); transform = [0, 1, -1, 0, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xa5f8b60>>
2013-04-17 21:37:00.922 StrangeThings[1182:c07] <UIImageView: 0xa5f8a70; frame = (-14.5 14.5; 30 1); transform = [0, -1, 1, 0, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xa5f8ad0>>
2013-04-17 21:37:00.922 StrangeThings[1182:c07] <UIImageView: 0xa5f89e0; frame = (0 0; 1 30); transform = [-1, 0, -0, -1, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xa5f8a40>>
2013-04-17 21:37:00.922 StrangeThings[1182:c07] <UIImageView: 0xa5f8950; frame = (0 0; 1 30); alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xa5f89b0>>
2013-04-17 21:37:00.923 StrangeThings[1182:c07] <UIImageView: 0xa5f88c0; frame = (0 228; 306 30); alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xa5f8920>>
2013-04-17 21:37:00.923 StrangeThings[1182:c07] <UIImageView: 0xa5f8750; frame = (0 0; 306 30); transform = [-1, 0, -0, -1, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xa5f8630>>
2013-04-17 21:37:00.924 StrangeThings[1182:c07] <UIWebBrowserView: 0xc270400; frame = (0 0; 306 258); text = ''; gestureRecognizers = <NSArray: 0xa5f5ac0>; layer = <UIWebLayer: 0xa5f0820>>
2013-04-17 21:37:00.925 StrangeThings[1182:c07] <UIHighlightView: 0xa5ef210; frame = (-4 -4; 314 266); opaque = NO; layer = <CALayer: 0xa5c0730>>
2013-04-17 21:37:00.925 StrangeThings[1182:c07] <UIImageView: 0xa0bebc0; frame = (0 251; 306 7); alpha = 0; opaque = NO; autoresize = TM; userInteractionEnabled = NO; layer = <CALayer: 0xa0bec60>>
2013-04-17 21:37:00.925 StrangeThings[1182:c07] <UIImageView: 0xa0b37d0; frame = (299 0; 7 258); alpha = 0; opaque = NO; autoresize = LM; userInteractionEnabled = NO; layer = <CALayer: 0xa0becd0>> 
```

在分析了所有这些子视图后，我发现了一个名为`UIHighlightView`，正如名称所证实的那样，这个视图可能会突出显示 webView。所以我的第二个问题是：**如何删除这个视图？**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-19T13:40:50.700

就像设置以下 CSS 规则一样简单。

```
div {
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
} 
```

这使得应用的阴影透明，所以看起来它已经消失了。

编辑：这是一个[演示链接](http://jsfiddle.net/BJh6R/1/)。

# java - 从套接字读取和写入不会产生输出？

> ID：16051198
> 
> 赞同：1
> 
> 时间：2013-04-17T03:55:42.227
> 
> 标签：java, sockets

我正在创建一个需要在网络上的多台计算机之间来回传输数据的应用程序。由于要发送数据的方式，客户端计算机将运行套接字服务器，而协调计算机将运行客户端套接字。

我创建了简单的类，它们只是为了封装对这些套接字的读取和写入。然而，接收套接字并没有读取任何内容，而是什么都不输出。我已经确认客户端和服务器都有连接。

在以下`Server`和`Client`类中，`Socket`公开仅用于调试目的。

```
public class Server {
    public Socket client;
    private DataInputStream inStr;
    private PrintStream outStr;

    public Server() throws UnknownHostException, IOException {this("localhost");}
    public Server(String hostname) throws UnknownHostException, IOException {
        client = new Socket(hostname, 23);
        inStr = new DataInputStream(client.getInputStream());
        outStr = new PrintStream(client.getOutputStream());
    }

    public void send(String data) {outStr.print(data); outStr.flush();}
    public String recv() throws IOException {return inStr.readUTF();}
} 
```

以下是我的`Client`：

```
public class Client {
    private ServerSocket serv;
    public Socket servSock;
    private DataInputStream inStr;
    private PrintStream outStr;

    public Client() throws IOException {
         serv = new ServerSocket(23);
         servSock = serv.accept();
         inStr = new DataInputStream(servSock.getInputStream());
         outStr = new PrintStream(servSock.getOutputStream());
    }

    public void send(String data) {outStr.print(data); outStr.flush();} 
    public String recv() throws IOException {return inStr.readUTF();}
} 
```

Client 类被实例化，程序启动。然后，在一个单独的程序中，服务器被实例化并启动：

```
Server s = new Server(); System.out.println(s.client.isConnected());  
while(true) {System.out.println(s.recv()); Thread.sleep(200);}

Client c = new Client(); System.out.println(c.servSock.isConnected()); 
while(true) {c.send("Hello World!"); Thread.sleep(200);} 
```

`isConnected()`返回`true`。

这可能是什么原因造成的？我以前从未使用过套接字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:36:07.503

[`DataInputStream.readUTF()`](http://docs.oracle.com/javase/6/docs/api/java/io/DataInput.html#readUTF%28%29) expects the first two bytes to be the number of bytes to read, but [`PrintStream.print(String)`](http://docs.oracle.com/javase/6/docs/api/java/io/PrintStream.html#print%28java.lang.String%29) will convert the string to bytes and write them as-is.

[`DataOutputStream.writeUTF(String)`](http://docs.oracle.com/javase/6/docs/api/java/io/DataOutput.html#writeUTF%28java.lang.String%29) will write the length like `readUTF()` expects.

# ubuntu - Ubuntu 中的 libaugeas-ruby 和 libaugeas-ruby1.8 有什么区别？

> ID：16051199
> 
> 赞同：0
> 
> 时间：2013-04-17T03:55:44.830
> 
> 标签：ubuntu, augeas

Ubuntu 中的 libaugeas-ruby 和 libaugeas-ruby1.8 有什么区别？

我发现当我升级 libaugeas-ruby 时，它并没有升级 libaugeas-ruby1.8。

我看不出有什么不同，非常混乱

[http://packages.debian.org/squeeze/libaugeas-ruby](http://packages.debian.org/squeeze/libaugeas-ruby)

[http://packages.debian.org/squeeze/libaugeas-ruby1.8](http://packages.debian.org/squeeze/libaugeas-ruby1.8)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:16:36.413

libaugeas-ruby 只是一个元包，它根据您的 Debian/Ubuntu 版本提取 libaugeas-ruby1.8 或 libaugeas-ruby1.9。包裹实际上不包含任何东西。

# java - JSTL EL - 它在哪里获得价值？

> ID：16051200
> 
> 赞同：0
> 
> 时间：2013-04-17T03:55:52.500
> 
> 标签：java, spring, model-view-controller, jstl, el

我有一个控制器，它具有以下代码片段

```
...
model.addAttribute("parade", "Parade1");
...
session.setAttribute("parade", "Parade2"); 
```

但是当我使用它访问它时，`${parade}`它会给我`Parade1`. 我想从会话中访问另一个。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T03:59:11.583

尝试这个

```
${sessionScope.parade} 
```

# jquery - Jquery 鼠标悬停按钮集不起作用

> ID：16051216
> 
> 赞同：0
> 
> 时间：2013-04-17T03:57:32.483
> 
> 标签：jquery, jquery-ui, mouseover

我在下一个代码中未触发 mouseover 事件时遇到问题（单击事件触发正常）：

```
<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Test</title>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
    <style type="text/css">
    <!--
      body {
        font-family: "Trebuchet MS", "Helvetica", "Arial",  "Verdana", "sans-serif";
        font-size: 62.5%;
      }
      .ui-menu { width: 150px; }
      .invisible {
        display: none;
      }
    //-->
    </style>
    <script>
    $(function() {
      $( "#radio" ).buttonset();
      $('.menu').menu();
      $('#radio1').mouseover(function(){
        $('#menu1').removeClass('invisible');
      });
      $('#radio1').click(function(){
        $('#menu1').removeClass('invisible');
      });
    });
    </script>
  </head>
  <body>
    <form>
      <div id="radio">
        <input type="radio" id="radio1" name="radio" /><label for="radio1">Choice 1</label>
        <input type="radio" id="radio2" name="radio" checked="checked" /><label for="radio2">Choice 2</label>
        <input type="radio" id="radio3" name="radio" /><label for="radio3">Choice 3</label>
      </div>
    </form>

    <ul id="menu1" class="menu invisible">
      <li><a href="#">Uno</a></li>
      <li><a>Dos</a></li>
      <li><a>Tres</a></li>
    </ul>
  </body>
</html> 
```

鼠标悬停事件完全被忽略（参见此示例：http: [//jsfiddle.net/YyCde/](http://jsfiddle.net/YyCde/)），并且单击事件按预期工作。这是预期的行为还是存在错误或我遗漏了什么？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:10:50.930

因为，如果您在浏览器检查器或 FireBug 中检查 DOM，则单选按钮不会跨越。而是`label`充当按钮。因此`mouseover`不会在`radio`. 试试这个：

```
$('#radio1').next('label').on('mouseover', function(e){
    $('#menu1').removeClass('invisible');
}); 
```

**更新：**

正如[mu 所建议的那样太短了](https://stackoverflow.com/users/479863/mu-is-too-short)

```
$('label[for="radio1"]').on('mouseover', function(e){
    $('#menu1').removeClass('invisible');
}); 
```

有用。[小提琴](http://jsfiddle.net/rutwick/YyCde/2/)。

# r - 将列中的元素计数插入R中的表中

> ID：16051218
> 
> 赞同：0
> 
> 时间：2013-04-17T03:58:03.847
> 
> 标签：r

我在 R 中工作，我有一个带有`A`,`B`和`NA`值的矩阵，我想计算每列中`A`或`B`或`NA`值的数量并将结果插入表中。我使用下面的代码来计算`A`,`B`和`NA`.

```
mydata <- matrix(c(rep("A", 8), rep("B", 2), rep(NA, 2), rep("A", 4),
rep(c("B", "A", "A", "A"), 2), rep("A", 4)), ncol = 4, byrow = TRUE)

myFun <- function(x) {
data.frame(n.A = sum(x == "A", na.rm = TRUE), n.B = sum(x == "B",
na.rm = TRUE), n.NA = sum(is.na(x)))
}

count <- apply(mydata, 2, myFun) 
```

现在，我需要将 count 的结果`(count <- apply(mydata, 2, myFun))`作为只有标题的表插入到数据框中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:46:25.457

在概念上与 mnel 的答案几乎相同，您也可以在 base R 中尝试以下操作：

```
sapply(as.data.frame(mydata), 
       function(x) table(factor(x, levels = unique(as.vector(mydata))), 
                         useNA = "always"))
#      V1 V2 V3 V4
# A     4  6  6  6
# B     3  1  0  0
# <NA>  0  0  1  1 
```

在这里，我没有手动指定因子水平，而是使用了`mydata`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:11:52.323

我认为使用`plyr`and `adply`or最简单`ldply`

您可以替换`myfun`为调用表。

```
library(plyr)
adply(mydata,2, function(x) table(factor(x, levels = c('A','B')), useNA = 'always'))
#   X1 A B NA
# 1  1 4 3  0
# 2  2 6 1  0
# 3  3 6 0  1
# 4  4 6 0  1 
```

如果你有大数据，那`plyr`不是办法。`apply`会很好地工作

```
apply(mydata, 2, function(x) {
          xx <- table(factor(x, levels = c('A','B')), useNA = 'always')
          names(xx) <- c('nA','nB', 'nNA')
          xx}) 

   [,1] [,2] [,3] [,4]
nA     4    6    6    6
nB     3    1    0    0
nNA    0    0    1    1 
```

# java - 如何找出价格/额外存入的 1000 美元

> ID：16051223
> 
> 赞同：0
> 
> 时间：2013-04-17T03:58:48.780
> 
> 标签：java, logic, business-logic

我想在java中转换的公式是

**超限现金存款费用 = [（输入 $ 现金存款）-（计划中包含的 $ 现金存款）] / 1000 *（价格/每额外存入 $1000）**

我正在编写的代码是

```
int inputCash = 50;
int cashDepsitFromPlan = 40;
int cashDepositOverLimitFee = 2.5;

cashDepositOverLimit = (double) ((inputCash -cashDepsitFromPlan) / 1000) * ???; 
```

我如何找到？？？（价格/每多存 1000 美元）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:02:55.100

如果您使用浮点数，您可能需要重新考虑使用`int`数据类型。

首先，这将引起各种悲伤：

```
int cashDepositOverLimitFee = 2.5; 
```

你最好`double`什么都用。

在此处查找未知变量方面，这是特定于您的业务规则的内容，此处未显示。

我冒昧地猜测这个`price/$1000`数字与您的变量密切相关，`cashDepositOverLimitFee`例如每多出 1000 美元就是 2.50 美元。

这将使等式：

```
 inputCash - cashDepsitFromPlan
cashDepositOverLimit = ------------------------------ * cashDepositOverLimitFee
                                   1000 
```

which makes sense. The first term on the right hand side is the number of excess $1000 lots you've deposited over and above the plan. You would multiply that by a fee rate (like $2.50 or 2.5%) to get the actual fee.

However, as stated, we can't tell whether it's $2.50 or 2.5% based on what we've seen. You'll have to go back to the business to be certain.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T04:03:36.677

你必须以代数方式操纵方程来解决这个问题。

```
cashDepositOverLimitFee = (double) ((inputCash -cashDepsitFromPlan) / 1000) * ???
cashDepositOverLimitFee*1000 = (double) (inputCash -cashDepsitFromPlan) * ???
(cashDepositOverLimitFee*1000) / (double) (inputCash -cashDepsitFromPlan) = ???
??? = (cashDepositOverLimitFee*1000) / (double) (inputCash -cashDepsitFromPlan) 
```

请注意，`(double)`强制转换必须保留以确保浮点结果。

# kernel - 在 amd64 主机上交叉构建 i386 linux 内核

> ID：16051224
> 
> 赞同：2
> 
> 时间：2013-04-17T03:58:49.763
> 
> 标签：kernel, debian, cross-compiling

我正在尝试在 amd64 Debian 主机上构建 i386 Linux 内核 deb 包。

现在我通过 set 来做这件事`--cross-compile flag`。它确实对内核本身做了很大的工作。但问题是内核工具，它们仍然被编译为本地机器格式。由于链接器不匹配，仅更改`HOSTCC`变量无法解决此问题。

我知道`chroot`或`linux32`环境会工作。但是，它们是唯一的方法吗？应该有另一种解决方案，因为有人可能想要构建一个 arm 内核。

PS：这是我正在使用的命令：

```
CONCURRENCY_LEVEL=8 DEB_HOST_ARCH=i386 MAKEFLAGS="HOSTCC=/home/csl/bin/i486-linux-gnu-gcc"\
make-kpkg --rootcmd fakeroot --initrd --arch i386 --cross-compile /home/csl/bin/i486-linux-gnu- --append-to-version=-liquorix-csl binary-arch \
> >(tee stdout.log) 2> >(tee stderr.log >&2) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-04T01:02:13.240

我已经这样做了：

1.  sudo dpkg --add-architecture i386
2.  sudo apt-get update && sudo apt-get install ia32-libs gcc-multilib
3.  制作 i386_defconfig
4.  使 ARCH=i386 -j5 deb-pkg

我没有时间去探索是否真的需要 ia32-libs。但我想指出 make-kpkg 已被弃用，如 debian book 中所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-07T03:47:29.763

我现在这样做是这样的：

```
CONCURRENCY_LEVEL=6 DEB_HOST_ARCH=i386 setarch i386 make-kpkg --initrd --arch i386 binary-arch 
```

我在 debian 书中没有看到任何关于 make-kpkg 的抱怨，所以你能在 debian 书中显示你的参考吗？

我发现真正的问题是`scripts`目录中包含的内核工具必须编译为原生格式，这可能有助于内核构建。但是这个工具在做DKMS的时候是不能复用的，这是因为DKMS和交叉编译的冲突比较大。我将手动破解损坏的交叉构建内核。

# c# - Windows Phone 7.8 WideTile 图像不起作用

> ID：16051225
> 
> 赞同：0
> 
> 时间：2013-04-17T03:58:51.873
> 
> 标签：c#, windows-phone-7, live-tile

我已经尝试了以下两种解决方案，它们都有相同的结果。磁贴已创建，但图像未出现。我可以设置标题和其他属性，但是当我使用这个解决方案时它不起作用。我已经验证了图像路径并且它在构建中。有任何想法吗？

```
public static void UpdateFlipTile(
            Uri wideBackgroundImage, 
            Uri wideBackBackgroundImage)
{
   if (IsTargetedVersion)
   {
  // Get the new FlipTileData type.
  Type flipTileDataType = Type.GetType("Microsoft.Phone.Shell.FlipTileData, Microsoft.Phone");

  // Get the ShellTile type so we can call the new version of "Update" that takes the new Tile templates.
  Type shellTileType = Type.GetType("Microsoft.Phone.Shell.ShellTile, Microsoft.Phone");

  // Loop through any existing Tiles that are pinned to Start.
  foreach (var tileToUpdate in ShellTile.ActiveTiles)
  {
     // Look for a match based on the Tile's NavigationUri (tileId).

        // Get the constructor for the new FlipTileData class and assign it to our variable to hold the Tile properties.
        var UpdateTileData = flipTileDataType.GetConstructor(new Type[] { }).Invoke(null);

        // Set the properties. 
        SetProperty(UpdateTileData, "WideBackgroundImage", wideBackgroundImage);
        SetProperty(UpdateTileData, "WideBackBackgroundImage", wideBackBackgroundImage);

        // Invoke the new version of ShellTile.Update.
        shellTileType.GetMethod("Update").Invoke(tileToUpdate, new Object[] { UpdateTileData });

            break;

      }
   }

}

private static void SetProperty(object instance, string name, object value)
{
   var setMethod = instance.GetType().GetProperty(name).GetSetMethod();
   setMethod.Invoke(instance, new object[] { value });
} 
```

我也尝试了这个解决方案

```
 if (Environment.OSVersion.Version >= new Version(7, 10, 8858))
{
    var tile = ShellTile.ActiveTiles.First();
    var flipTileData = new FlipTileData
            {
                BackgroundImage = new Uri("/Icons/MediumLogo.png", UriKind.RelativeOrAbsolute),
                WideBackgroundImage = new Uri("/Icons/WideLogo.png", UriKind.RelativeOrAbsolute),
            };
    tile.Update(flipTileData);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:52:49.127

图像尺寸是否正确？您是否将图像的构建属性设置为“内容”？是否有必要在 FlipTileData 中设置所有属性？

# android - 限制 Android WiFi 流量

> ID：16051232
> 
> 赞同：2
> 
> 时间：2013-04-17T03:59:22.637
> 
> 标签：android, wifi, bandwidth, throttling, bandwidth-throttling

有谁知道如何做到这一点？如果是这样 - 有没有人看到任何包含这种方法的示例、教程或存储库？

我发现了以下内容：

[http://dinote.wordpress.com/opens-asynchronous-android-httprequest/](http://dinote.wordpress.com/opens-asynchronous-android-httprequest/)

但我想限制所有流量 - 而不仅仅是一个 HTTP 请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:32:54.140

如果您可以在模拟器上进行测试，那么您可以通过转到 Run Configuration -> Target 来更改数据延迟，然后向下滚动以查看相应的设置（在 Eclipse 中）。如果它必须在真实设备上，或者必须纯粹通过 wifi，那么我所说的无关紧要。

HTH，阿里。

# r - knitr - 设置块选项*外部*文档？

> ID：16051236
> 
> 赞同：4
> 
> 时间：2013-04-17T03:59:58.557
> 
> 标签：r, knitr

我正在尝试在我的调用*之外*`knit`设置一个全局块选项，如下所示：

```
opts_chunks$set(dev='pdf')
knit(input) 
```

但是，它不起作用，因为`knit`似乎使用了一组新的`opts_chunks`inside `knit`。

**是否可以在调用之外设置全局块选项`knit`，并将其应用于调用`knit`？**

* * *

我这样做的原因：

我正在编写`Rmd`（R markdown）文档，我希望能够将它们编织成 pdf**或**HTML，我的选择，如下所示：

```
knit2 <- function (input, out=c('pdf', 'html')) {
    # set the appropriate output image format
    opts_chunk$set(dev=ifelse(out == 'pdf', 'pdf', 'svg')) # <--

    # knit to md
    o <- knit(input)

    # knit md to html or pdf
    pandoc(input=o, format=ifelse(out == 'pdf', 'latex', 'html'))
} 
```

所以我的想法是我可以`knit2('mydoc.Rmd', 'pdf')`OR`knit2('mydoc.Rmd', 'html')`并且我**不必根据输出更改 Rmd**。

我遇到的问题是我希望我的图像是 SVG 用于 HTML 输出，PDF 用于 PDF 输出（我想要矢量图形但 SVG 在 Latex 中不起作用，而 pdf 在 HTML 中不起作用，所以我需要修改这基于输出格式），即

```
opts_chunk$set(dev=ifelse(out == 'pdf', 'pdf', 'svg')) 
```

我知道如果我将它与 的定义一起放在我的 Rmd 文件中的一个块中`out`，它将起作用。但是，我不想将它嵌入其中`mydoc.Rmd`，因为我无法分配`output`直到`knit2`被称为我知道我真正想要的输出。

因此，我希望 knit2`dev`在调用之前以某种方式为我设置选项，`knit`并让该选项适用于`knit`. （我也接受将 my 嵌入`opts_chunk$set(dev=ifelse(out=='pdf', 'pdf', 'svg'))`到我的 Rmd 文件中，前提是我可以在 Rmd 文件`out` *之外*定义，即 in `knit2`，但如果我能处理这一切，`knit2`我会更喜欢）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T05:04:47.480

可以在文档之外设置全局选项，该`dev`选项是唯一的例外。当输出为 HTML 时`dev`，`'png'`由`render_markdown()`. 如果你想改变这个选项，你必须在它之前调用这个函数：

```
knit2 <- function (input, out=c('pdf', 'html')) {
  if (out == 'html') {
    render_markdown()
    # use SVG for HTML output
    opts_chunk$set(dev='svg')
  }

  # knit to md
  o <- knit(input)

  # knit md to html or pdf
  pandoc(input=o, format=ifelse(out == 'pdf', 'latex', 'html'))
} 
```

实际上我有一个非常相似的问题，并在[示例 084](https://github.com/yihui/knitr-examples)中说明了这一点（见[`084-pandoc.R`](https://github.com/yihui/knitr-examples/blob/master/084-pandoc.R)那里；我改为`dev`Markdown `'pdf'`）。

# r - 如何在 R 中使用特定于类别的彩色文本标签制作散点图？

> ID：16051237
> 
> 赞同：1
> 
> 时间：2013-04-17T04:00:01.133
> 
> 标签：r, colors, plot, scatter-plot

我对 R 和绘图仍然很陌生。我有几个二维矩阵是

```
matrix <- matrix(c(0,1,2,3,4,4,3,2,1,0), 5, 2) 
```

它们都与带有类别标签的两列的单个数据框相关联，这些标签存储在

```
df <- data.frame(c("Class1","Class2","Class3","Class4","Class5"), c("A","B","C","B","A")) 
```

我想要做的是`matrix`使用第一列中的点标签制作散点图`df`，并将颜色编码为第二列中的类别标签。例如，我需要指定`A=red`, `B=blue`，然后散点图应该以红色和蓝色显示与`Class1`和相关的点，以此类推。我可以使用与 Class 列关联的文本标签进行绘图，但无法弄清楚颜色操作。如果您能提供帮助，请提前致谢！`Class5``Class2``Class4``matrix`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T04:43:05.620

```
A="red"; B="blue"
text( x= matrix[,1], y= matrix[,2], labels=df[,1], 
         col=c(A, B, "black")[ as.numeric(df[,2]) ]) 
```

基本做法是建立一个颜色向量，然后通过“[”运行一个选择向量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:09:17.187

这可以使用[ggplot2](http://ggplot2.org/)（您首先必须安装）轻松完成。首先将它们全部放入一个大数据框中，同时给它们一些有用的名称：

```
colnames(matrix) = c("x", "y")
colnames(df) = c("Class", "Category")
d = cbind(matrix, df) 
```

然后使用，提供您对、、（颜色）和位置`ggplot`感兴趣的新数据框的列，并指示您要使用文本制作图：`x``y``col``label``geom_text()`

```
library(ggplot2)
g = ggplot(d, aes(x=x, y=y, col=Category, label=Class)) + geom_text()
print(g) 
```

![在此处输入图像描述](https://i.stack.imgur.com/kyZGg.jpg)

# ruby-on-rails - 未知属性 - 属性存在

> ID：16051241
> 
> 赞同：2
> 
> 时间：2013-04-17T04:00:48.387
> 
> 标签：ruby-on-rails, ruby-on-rails-4, strong-parameters

我正在运行一个非常令人困惑的错误。
我正在尝试提交具有嵌套属性的表单 - 我正在通过 Rails 4 中的 strong_params 将它们列入白名单。

每当我尝试提交表单时，都会收到此错误：

> ActiveRecord::UnknownAttributeError - 未知属性：电子邮件：

我的用户模型具有以下设置：

### 用户控制器.rb

```
def update
  if @user.profile.update_attributes!(profile_params)
    respond_to do |format|
      format.js
      format.html { redirect_to edit_user_path(@profile.user) }
    end
  end
end

private 

def profile_params
  params.require(:user).permit(:email,
                               {:profile_attributes => [:first_name, :last_name, :website, :birthdate, :description,
                                 {:address_attributes => [:city, :country, :phone]}]}

  )
end 
```

这给了我以下参数：

> {"email"=>"martin@teachmeo.com", "profile_attributes"=> {"first_name"=>"Martin", "last_name"=>"Lang", "website"=>"", "birthdate"= >"", "描述"=>""}}

我的用户模型如下所示：

> 用户（id：整数，电子邮件：字符串，password_digest：字符串，created_at：日期时间，updated_at：日期时间，auth_token：字符串）

有趣的是，如果我尝试通过 pry 调试它，@user.update_attributes(profile_params) 可以正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T04:19:07.947

你在打电话

```
@user.profile.update_attributes!(profile_params) 
```

这意味着您正在更新`Profile` *(我假设那是模型名称)*的实例上的属性，**而不是** `User`. 正如您所指出的，是模型上的一列，而`:email`不是**模型**。您正在尝试将 key 的值应用于没有的列，因此出现错误。`User`**`Profile``:email``@user.profile``Profile``ActiveRecord::UnknownAttributeError - unknown attribute: email:`**

 **我会猜测而不是上面你真正想要的

```
@user.update_attributes!(profile_params) 
```

既然`User`有`:email`属性，也可能有`accepts_nested_attributes_for :profile`设置。**

# javascript - 自定义 Paypay 支付保护

> ID：16051243
> 
> 赞同：0
> 
> 时间：2013-04-17T04:01:00.760
> 
> 标签：javascript, asp.net

我正在做一个 PayPal 支付系统。步骤是：

1.  收集用户选择的所有商品和价格值，通过js从html输入中获取。
2.  重定向到 url paypal 并添加项目和价格：

    `https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_cart&upload=1&business=someemail@here.com&cy_code=USD&lc=US&item_name_1=Black Gold&item_number_1=1&quantity_1=1&amount_1=$58.00`

问题：但是使用这种方法，用户可以通过从我的站点下载页面并更改脚本来轻松更改价格。所以我可以为此做任何保护吗？

我现在有2个想法。但我不认为它们是好的解决方案。

1.  按服务器站点对价格进行编码/解码
2.  从 sql 获取价格值...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T00:30:21.430

使用 POST 请求发送数据，而不是 GET 请求（使用 URL 参数）。此外，使用 PayPal IPN 通知系统在有人使用 hack 篡改传递的值的情况下通知您：

[https://www.paypal.com/ipn](https://www.paypal.com/ipn)

# opengl - glsl 通过几何着色器问题

> ID：16051246
> 
> 赞同：4
> 
> 时间：2013-04-17T04:01:17.747
> 
> 标签：opengl, glsl, geometry-shader

此时我有一个工作的顶点和片段着色器。如果我完全删除我的几何着色器，那么我会得到预期的立方体，每个顶点都有颜色。但是添加了几何着色器后，根本没有几何图形出现。

顶点着色器：

```
#version 330 core

layout(location = 0) in vec3 vertexPosition_modelspace;
layout(location = 1) in vec3 vertexColor;

out VertexData
{
    vec3 color;
} vertex;

uniform mat4 MVP;

void main(){    

    gl_Position =  MVP * vec4(vertexPosition_modelspace,1); 
    vertex.color = vertexColor;
} 
```

几何着色器：

```
#version 330

precision highp float;

in VertexData
{
    vec3 color;
} vertex[];

out vec3 fragmentColor;

layout (triangles) in;
layout (triangle_strip) out;
layout (max_vertices = 3) out;

void main(void)
{
    for (int i = 0; i > gl_in.length(); i++) {

        gl_Position = gl_in[i].gl_Position;
        fragmentColor = vertex[i].color;
        EmitVertex();
    }

    EndPrimitive();
} 
```

片段着色器：

```
#version 330 core

in vec3 fragmentColor;

out vec3 color;

void main(){
    color = fragmentColor; 
} 
```

据我所知，我的显卡支持 OpenGL 3.3。而且，正如我所说。它可以在没有几何着色器的情况下工作。作为数据，我传入两个 GLfloat 数组，其中每个数组分别是顶点或顶点颜色。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T08:18:56.273

```
for (int i = 0; i > gl_in.length(); i++)   //note the '>' 
```

这个循环条件从一开始就是假的，所以你永远不会发出任何顶点。你最可能的意思是`i < gl_in.length()`.

# c# - 列名无效节点名（如果有） = , 列名 = d

> ID：16051250
> 
> 赞同：0
> 
> 时间：2013-04-17T04:01:51.737
> 
> 标签：c#, sql-server-2008, sql-insert

我花了几个小时试图解决这个错误，但我做不到。如果有人能帮我解决这个问题，我会很高兴。

代码：

```
FileStream fs;
fs = new FileStream(@imagename, FileMode.Open, FileAccess.Read);
byte[] picbyte = new byte[fs.Length];
fs.Read(picbyte, 0, System.Convert.ToInt32(fs.Length));
fs.Close();
string query;
SqlCeConnection conn = new SqlCeConnection(@"Data Source=C:\Users\admin\documents\visual studio 2010\Projects\WindowsFormsApplication1\WindowsFormsApplication1\hotel.sdf");
conn.Open();
SqlParameter picparameter = new SqlParameter();
picparameter.SqlDbType = SqlDbType.Image;
picparameter.ParameterName = "pic";
picparameter.Value = picbyte;
query = "insert into Staffs(name, age, qualification, mobile, landline, salary, salary_type, address, work_type, reference, picture) values(" + textBox16.Text + ", " + textBox15.Text + "," + textBox14.Text + "," + textBox13.Text + "," + textBox12.Text + "," + textBox11.Text + "," + comboBox2.Text + "," + richTextBox2.Text + "," + textBox10.Text + "," + textBox9.Text + ", " + " @pic)";
SqlCeCommand cmd = new SqlCeCommand("insert into Staffs(name, age, qualification, mobile, landline, salary, salary_type, address, work_type, reference, picture) values(" + textBox16.Text + ", " + textBox15.Text + "," + textBox14.Text + "," + textBox13.Text + "," + textBox12.Text + "," + textBox11.Text + "," + comboBox2.Text + "," + richTextBox2.Text + "," + textBox10.Text + "," + textBox9.Text + ", " + " @pic)", conn);
cmd.ExecuteNonQuery();
MessageBox.Show("Profile Added");
cmd.Dispose();
conn.Close();
conn.Dispose(); 
```

错误：

列名无效节点名（如果有） = , 列名 = d

到目前为止，我发现了什么：

错误中的“column name = d”是文本字段的值。如果我在文本字段中输入 a，错误将变为“列名 = a”。

如果我在文本字段中输入数字而不是字符，则错误会变为“缺少参数 [参数序号 = 1]。列的数据类型是 nvarchar。

我尝试编辑数据库架构，但什么也没发生。

我检查了数据库的重复副本，但没有找到，所以我想问题出在代码上。

这些列的数据类型为 nvarchar、int 或 image。

只是为了确保我检查了数据库以查看插入是否有效，数据库仍然是空的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:14:27.553

您需要使用 SQL 参数来避免 SQL 注入问题。

但是你的东西现在失败的原因是你没有在查询中引用你的字符串值。如果您调试并查看命令文本，您会看到类似 的内容`values(abc,def,ghi...)`，而字符串周围没有单引号。

该查询尝试运行，当然它失败了。SQL 参数消除了对单引号的需求，此外还使您的代码更安全、更易于阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T04:09:38.267

您的参数名称不正确。应该是`@pic`，不是`pic`。

顺便说一句，您连接文本框值的方式使您容易受到 SQL 注入攻击。当然我不知道你的上下文，但考虑用参数值设置替换字符串连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-19T09:56:32.590

我通过删除整个数据库并重新创建它来解决这个问题。

显然，如果您在数据库中的表版本比您想要使用的旧版本，则会发生这种情况，因此该表中不存在该列。

# image - 悬停时图像更改但保持不变

> ID：16051254
> 
> 赞同：0
> 
> 时间：2013-04-17T04:02:31.410
> 
> 标签：image, class, html, hover

我正在制作一个交互式地图，并希望在其上放置一些按钮，当悬停在上面时会改变颜色（单独的图像），然后链接到不同的图像。

我在完成这项工作时遇到了很大的问题......我目前的 css 一团糟：

```
a.button
{
position: inherit;
display:block;
background:transparent url('images/button.png') bottom;
background-repeat: no-repeat;
}

a.button:hover
{
position: inherit;
background-image: url('images/button_hover.png');
background-repeat: no-repeat;
}

#one
{
position: fixed;
left:225px;
top:702px;
} 
```

HTML：

```
 <div id="map"><img src="images/map.png"/></div>

        <a href="http://matthewligotti.com" class="button"/>
                <img src="images/button.png" id="one"/>
        </a>

    </div> 
```

所以我希望图像是链接，并为每个按钮悬停相同的两个图像，唯一改变的是它们带给你的链接。我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:58:42.123

如果您可以编辑图像，则可以通过将它们堆叠在一起将它们组合成一个 .png。然后，如果按钮是 100px x 200px，你可以这样做：

```
a.button
{
display:block;
height:100px;
width:200px;
background-image:url('1.jpg');
background-position:0 0;
background-repeat: no-repeat;
}

a.button:hover
{
background-position:0 -100px;
} 
```

和

```
 <a href="http://matthewligotti.com" class="button"/></a>
 <a href="http://matthewligotti.com" class="button"/></a> 
```

这将切换正在显示的新双图像的上半部分或下半部分。

你的意思是这样吗？

# java - java.lang.ClassNotFoundException: org.dom4j.DocumentException

> ID：16051267
> 
> 赞同：2
> 
> 时间：2013-04-17T04:03:37.473
> 
> 标签：java, xml, hibernate

我编写了一些代码来学习休眠。它在下面抛出错误。我如何找出问题所在并解决它？dom4j 听起来像是一个 XML 问题。hibernate.cfg.xml 有问题吗？

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/dom4j/DocumentException
at com.examscam.model.User.persist(User.java:45)
at com.examscam.model.User.main(User.java:57)
Caused by: java.lang.ClassNotFoundException: org.dom4j.DocumentException
at java.net.URLClassLoader$1.run(Unknown Source)
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
... 2 more 
```

**（为什么eclipse没有显示这个“2more”的东西？）**

**代码 -**

```
package com.examscam.model;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import org.hibernate.cfg.AnnotationConfiguration;
import org.hibernate.tool.hbm2ddl.SchemaExport;

@Entity
public class User {

private Long id;
private String password;

@Id
@GeneratedValue

public Long getId(){
    return id;

}

public void setId(Long id){

    Class c1 = User.class;
    this.id = id;

}

public String getPassword() {
    return password;
}

public void setPassword(String password) {
    this.password = password;
}

public static void persist(){

    /* 
     * Contains all the info needed to connect to database, along with
     * info from your JPA annotated class, ie this class. 
    */
    AnnotationConfiguration config = new AnnotationConfiguration();
    config.addAnnotatedClass(User.class);
    config.configure();

    SchemaExport schemaExport = new SchemaExport(config);
    schemaExport.create(true, true);

}

public static void main(String[]args){

    persist();

}

} 
```

**XML 文件 -**

```
<?xml version = '1.0' encoding='UTF-8' ?>

<!Doctype hibernate-configuration PUBLIC
"-//Hibernate/Hibernate Configuration DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">

<hibernate-configuration>
<session-factory>

<property name = "connection.url">
jdbc:mysql://localhost/examscam
</property>

<property name = "connection.username">
root
</property>

<property name = "connection.password">
password
</property>

<property name = "connection.driver_class">
com.mysql.jdbc.Driver
</property>

<property name = "dialect">
org.hibernate.dialect.MySQLDialect
</property>

<property name = "transaction.factory_class">
org.hibernate.transaction.JDBCTransactionFactory
</property>

<property name = "current_session_context_class">
thread
</property>

<!-- this will show us all the SQL statements-->

<property name = "hibernate.show_sql">
true
</property>

<!-- We dont use any mapping files as of now-->

</session-factory>
</hibernate-configuration> 
```

**更新**

**修复上述错误后，又出现了一个新问题——**

我正在用 Eclipse 编写代码。我添加了代码所需的所有可能的 jar，但我的代码仍然无法正常工作。为什么当我已经将 sl4fj ( slf4j-api-1.5.8.jar) 添加到构建路径时出现此错误**java.lang.ClassNotFoundException: org.slf4j.impl.StaticLoggerBinder ？**

错误 -

```
 SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
  SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
  Exception in thread "main" java.lang.NoClassDefFoundError: org/slf4j   
  /impl/StaticLoggerBinder
at org.slf4j.LoggerFactory.getSingleton(LoggerFactory.java:223)
at org.slf4j.LoggerFactory.bind(LoggerFactory.java:120)
at org.slf4j.LoggerFactory.performInitialization(LoggerFactory.java:111)
at org.slf4j.LoggerFactory.getILoggerFactory(LoggerFactory.java:269)
at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:242)
at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:255)
at org.hibernate.cfg.Configuration.<clinit>(Configuration.java:152)
at com.examscam.model.User.persist(User.java:45)
at com.examscam.model.User.main(User.java:57)
   Caused by: java.lang.ClassNotFoundException: org.slf4j.impl.StaticLoggerBinder
at java.net.URLClassLoader$1.run(Unknown Source)
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
... 9 more 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-17T04:11:32.927

确保 dom4j.jar 在类路径中。

你说的2more。

当您看到“...2 more”时，这意味着“由”异常的剩余行与父异常的该点之后的剩余行相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-31T10:50:55.130

添加 dom4j.jar 在项目的 lib 中。

# matplotlib - Matplotlib 绘制一条连续改变颜色的线

> ID：16051270
> 
> 赞同：15
> 
> 时间：2013-04-17T04:04:21.263
> 
> 标签：matplotlib

我想在 (x,y) 平面上绘制一条曲线，其中曲线的颜色取决于另一个变量 T 的值。x 是一维 numpy 数组，y 是一维 numpy 数组。

```
T=np.linspace(0,1,np.size(x))**2
fig = plt.figure()
ax = fig.add_subplot(111)
ax.plot(x,y) 
```

我希望线根据 T 的值从蓝色变为红色（使用 RdBu 颜色图）（每个 (x,y) 对都存在一个 T 值）。

我找到了这个，但我不知道如何将它转换为我的简单示例。我将如何在我的示例中使用 linecollection？[http://matplotlib.org/examples/pylab_examples/multicolored_line.html](http://matplotlib.org/examples/pylab_examples/multicolored_line.html)

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-17T20:39:59.050

一个想法可能是设置颜色，`color=(R,G,B)`然后将您的情节分成`n`几段，并不断改变 R、G 或 B 之一（或组合）

```
import pylab as plt
import numpy as np

# Make some data
n=1000
x=np.linspace(0,100,n)
y=np.sin(x)

# Your coloring array
T=np.linspace(0,1,np.size(x))**2
fig = plt.figure()
ax = fig.add_subplot(111)

# Segment plot and color depending on T
s = 10 # Segment length
for i in range(0,n-s,s):
    ax.plot(x[i:i+s+1],y[i:i+s+1],color=(0.0,0.5,T[i])) 
```

希望这会有所帮助

# regex - URL上的Django NoReverseMatch错误

> ID：16051272
> 
> 赞同：1
> 
> 时间：2013-04-17T04:04:31.777
> 
> 标签：regex, django

我正在尝试使用命名的正则表达式组将关键字参数传递给视图。

我对使用正则表达式（和 Django）非常陌生，并且不断收到 NoReverseMatch 错误。

在我的模板中有一个包含以下内容的表格：

```
<td><a href="{% url profile player.user %}" data-toggle="modal" data-target="#profile"><i class="icon-forward"></i></a></td> 
```

“{% url profile player.user %}”对应的URL是：

```
url(r'^profile/(?P<players_username>\w)/$', profile_page, name='profile'), 
```

另外我不确定“\w”对于这个正则表达式是否正确。理想情况下，它可以接收任何字符。

我的观点“profile_page”是：

```
@login_required
def profile_page(request,players_username):
    return render(request, 'portal/portal_partial_profile.html') 
```

我不确定为什么会收到此错误？我感谢任何反馈和专业知识。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T04:33:07.303

由于您将匹配项分配给一个变量（它是一个关键字），因此您需要将其传入，如下所示：

```
{% url profile players_username=player.user %} 
```

另一个小修正，你的正则表达式应该是`\w+`. 意思是“`+`一个或多个，但至少一个”，否则您的正则表达式将无法按预期工作（除非您的所有玩家都有一个角色用户名）。

# c# - WPF 框架如何处理 MVVM 中属性的循环更新？

> ID：16051273
> 
> 赞同：2
> 
> 时间：2013-04-17T04:04:48.340
> 
> 标签：c#, .net, wpf, xaml, mvvm

让我们假设属性 Name 在这样的视图中绑定到 TextBox。

```
private string name
public string Name
{
   get {return name;}
   set {
       name=value;
       OnPropertyChanged("Name");
   }
} 
```

看法

```
<TextBox Text="{Binding Name, Mode=TwoWay"/> 
```

当我们更新文本框中的文本时，它会调用 Name 属性中的 setter，进而引发 PropertyChanged 假设再次更新 UI。我很好奇 WPF 如何避免更新和引发事件的递归。是通过考虑该事件的发送者来完成的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T04:37:13.563

A standard implementation of a property should look like this:

```
private string name;

public string Name
{
   get { return name; }

   set
   {
       if( name != value )
       {
           name = value;
           OnPropertyChanged("Name");
       }
   }
} 
```

Note the additional `if` to make sure the event is only raised if the value of the property actually changed.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T06:01:46.483

可以从[这里](https://stackoverflow.com/questions/10947380/why-wpf-binding-handles-inotifypropertychanged-in-two-different-ways)的答案帮助你。

如果您将属性从 ui 设置为 viewmodel，它会像这样。

*   设置器调用开始
*   值集
*   INotifyPropertyChanged 已启动
*   INotifyPropertyChanged 完成
*   二传手完成
*   getter 调用并完成
*   IDataErrorInfo 调用并完成

但是如果您在视图模型中设置属性，它会像这样

*   设置器调用开始
*   值集
*   INotifyPropertyChanged 已启动
*   getter 调用并完成
*   IDataErrorInfo 调用并完成
*   INotifyPropertyChanged 完成
*   二传手完成

> 将属性从 UI 更改为 ViewModel 可能会导致死锁情况，这种情况可能会在两种情况下遇到结束较少的递归调用。为了阻止这种情况发生，当 WPF 对模型进行更改时，它会继续通过 INotifyPropertyChanged 跟踪更改，但此更改将在调度程序队列中排队，并在其当前更新完成后执行。
> 
> 由于 viewmodel 中的更改不是由 WPF 发起的，因此 WPF 不会对操作进行排队，它会立即执行更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:23:02.323

据我了解，没有递归。

1) TextBox 使用 viewmodel 属性更新值。

2) Viewmodel 引发更新，让 UI 知道发生了一些变化

3) TextBox 现在更新自己以匹配 viewmodel 值。

# javascript - 如果我在 html 和 javascript 中指定文本框的数量，则应该生成文本框

> ID：16051277
> 
> 赞同：-3
> 
> 时间：2013-04-17T04:05:02.817
> 
> 标签：javascript, html

假设我在 html 中有一个文本框，它将指定文本框的数量应该使用 html 和 javascript 的文本框 ID 序列动态生成。
怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:14:40.217

你可以这样做：

```
$("input.number").on("change", function() {
    var num = $(this).val();
    for(var i=0; i<num; i++) {
        $(this).after('<input type="text" />');
    }
}); 
```

[http://jsfiddle.net/ryanbrill/9c5jY/](http://jsfiddle.net/ryanbrill/9c5jY/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:25:12.047

可以使用java脚本完成，如果使用jquery会很容易。

如果您的代码是

```
<input type=text id=noOfTb onchange="change();"/>
<div id=tbs>
</div> 
```

然后添加 jQuery 和以下脚本

```
<script type=javascript>
function change(){
var no= $("#noOfTb").val();
for(var i=0;i<no;i++){
    $("#tbs").append("<input type=text id="+i+" >");
  }
}
</script> 
```

# visual-studio-2010 - 首先在实体框架vs2010中建模，新建数据库

> ID：16051280
> 
> 赞同：0
> 
> 时间：2013-04-17T04:05:17.003
> 
> 标签：visual-studio-2010, entity-framework

我对刚开始学习的实体框架很陌生。我一直在关注一本 MCTS 书来学习实体框架。

我有VS2010，sql server 2008，它们都是速成版。我在我的项目中创建了一个 .edmx 文件。描述了两个实体。现在我通过右键单击图表从上下文菜单中单击从模型选项生成数据库。生成数据库向导打开，现在我选择新建。

我在这里看不到任何连接到我的 sql server 实例的选项？但是，我只看到：

1.  Microsoft sql 服务器数据库文件。
2.  微软 sql server 紧凑型 3.5。

我的目标是在我的本地 sql server 实例中创建一个新数据库并将这两个实体创建为表。

任何帮助将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-16T14:58:01.643

经过一番尝试和尝试，我终于得出结论，这个功能在 VS2010 快捷版中是不可用的，因为我在 VS2010 专业版中很容易做到这一点。

# java - 在 Java 中读取 csv

> ID：16051283
> 
> 赞同：0
> 
> 时间：2013-04-17T04:05:38.960
> 
> 标签：java, csv

我有一个 csv，我试图将其读入对象数组。我不断收到以下错误... java.util.InputMismatchException 我认为这是因为它读取的文件由空格而不是逗号分隔。我相信我需要使用 String.split() 方法，但我不确定该怎么做。有什么建议么。这是我到目前为止的代码......

```
public class Prog7
{
public static void main(String[] args)
{
    Part[] parts;
    int numParts;
    int partNumber;
    String description;
    double price;
    int quantity;
    String city;

    parts = new Part[100];
    numParts = 0;

    Scanner inFile = null;

    /*
     * open file
     */
    try
    {
        inFile = new Scanner( new File( "C:/COSC        210/Assignment#7/parts.txt" ) );
    }
    catch ( FileNotFoundException e )
    {
        System.err.println( "Error: file not found" );
    }

    /*
     * read file using each record to create a State object
     * and add that State object to the PopulationData object
     */
    while( inFile.hasNext() )
    {
        partNumber = inFile.nextInt();
        description = inFile.next();
        price = inFile.nextDouble();
        city = inFile.next();
        quantity = inFile.nextInt();

        Part p = new Part(partNumber, description, price, 
                          quantity, city);
        parts[numParts]= p;
        numParts++;

        for (int i = 0; i < numParts; i++)
        {
            System.out.println(parts[i].getPartNumber());
        }
    }
}
} 
```

以下是我正在使用的文本文件：

```
12345,Left-Handed Bacon Stretcher,125.95,PGH,2

24680,Smoke Shifter,0.98,PGH,48

86420, Pre-dug Post Hole,2.49,ATL,34

25632,Acme Widget,98.29,LOU,342

97531,Anti-Gravity Turbine,895.29,ATL,3

24680,Battery-Powered Battery Charger,252.98,ATL,2

12345,Left-Handed Bacon Stretcher,125.95,LOU,35

97531,Anti-Gravity Turbine,895.29,PHL,8

00000,Glass Hammer,105.90,PGH,8

86420, Pre-dug Post Hole, 2.49,ATL,34

01020,Inflatable Dartboard,32.95,PGH,453

86420, Pre-dug Post Hole, 2.49,LOU,68

86420, Pre-dug Post Hole, 2.49,PGH,124

24680, Battery-Powered Battery Charger, 252.98, PHL, 5 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T04:14:24.277

利用`scanner.useDelimiter(",");`

```
 Scanner inFile = new Scanner(new File
                          ("C:/COSC        210/Assignment#7/parts.txt" ));
    inFile.useDelimiter(",");
    while (inFile.hasNext()) {
        int partNumber = Integer.parseInt(inFile.next());
        String description = inFile.next();
        double price = Double.parseDouble(inFile.next());
        String city = inFile.next();
        int quantity = Integer.parseInt(inFile.nextLine().replaceAll(",", ""));
        if(inFile.hasNextLine()) inFile.nextLine();
        System.out.println(partNumber+","
                +description+","
                +price+","
                +city+","
                +quantity);
    }
    inFile.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:16:04.533

扫描仪默认使用空格作为分隔符。`scanner.useDelimiter(",")`在阅读文件之前使用。

它仍然不是万无一失的，因为内容本身可以拥有`","`

如果它用于学习，那么它很好，否则你可以考虑使用一些已经这样做的库，例如[http://sourceforge.net/projects/opencsv/files/opencsv/](http://sourceforge.net/projects/opencsv/files/opencsv/)

另外，不要使用**固定的 100 长度数组**，而是使用**List**，就好像记录超过一百个一样，您的代码会因异常而中断。

# actionscript-3 - 在 for 循环中更改整数值

> ID：16051286
> 
> 赞同：0
> 
> 时间：2013-04-17T04:06:10.527
> 
> 标签：actionscript-3, for-loop, integer

嘿伙计们，我认为这是一项容易完成的任务。我在 for 循环内更改整数变量值时遇到问题，也许因为它在 for 循环内你必须做一些技术性的事情？

但是我有一个名为`addPointsToStage();`我公开的函数，因为我试图通过一个单独的函数访问它的整数变量。顺便说一句，它在同一个班级里。

这是它的外观：

```
public function addPointsToStage():void
    {
         var startPoint:Point = new Point((stage.stageWidth / 2) - 100, stage.stageHeight / 2);
         var xSpacing:Number = 70;
         ySpacing = 0;

         for (var i = 0; i < nPoints; i++)
         {
             trace(aPointsArray.length);
             points = new mcGainPoints();
             aPointsArray.push(points);
             stage.addChild(points);
             points.x = startPoint.x + (xSpacing * i);
             points.y = startPoint.y - (ySpacing *i);
         }

    } 
```

我正在尝试将`ySpacing =0;`i 提升为班级成员，并且我想`points.y = startPoint.y - (ySpacing *i);` 通过我拥有的 hitTest 函数更改这部分的值，我尝试添加它，因为我认为它很简单`ySpacing = 10;`但它没有做任何事情。

没有错误，只是没有更改 for 循环内的值。

你能看到我在这里做错了什么吗？

# java - java lucene 停用词列表

> ID：16051290
> 
> 赞同：0
> 
> 时间：2013-04-17T04:06:21.580
> 
> 标签：java, lucene, set, stop-words

我想逐字获取 lucene 停用词列表。我可以访问整个集合，但是当我迭代它时，输出不是我想要的

这是我的代码：

```
analyzer = new StandardAnalyzer(Version.LUCENE_36);
Set set=analyzer.getStopwordSet();
Iterator iterator = set.iterator();
        while (iterator.hasNext()) {
    System.out.println(iterator.next());
    } 
```

在控制台中我看到它：

```
[C@7ef955da
[C@23739c56
[C@7b1ce448
[C@25cf721d
[C@564ce14f
[C@515c35cc
[C@7cd00dce 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-24T10:11:28.670

你得到“[C@7ef955da”的原因是你被`iterator.next()`视为对象，`System.out.println(...)`所以它以十六进制打印其对象的 hashCode()。返回的对象`iterator.next()`是类型`char[]`所以试试这个

```
analyzer = new StandardAnalyzer(Version.LUCENE_36);
Set set=analyzer.getStopwordSet();
Iterator iterator = set.iterator();
        while (iterator.hasNext()) {
    System.out.println((char[])iterator.next());
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T08:18:23.603

`Set`返回的不[`getStopwordSet`](http://lucene.apache.org/core/4_0_0/analyzers-common/org/apache/lucene/analysis/util/StopwordAnalyzerBase.html#getStopwordSet%28%29)包含字符串，而是 char 数组。很容易转换，只需使用适当的[String ctor](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#String%28char%5b%5d%29)：

```
Iterator<char[]> iterator = set.iterator();
while (iterator.hasNext()) {
    System.out.println(new String(iterator.next()));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-23T19:33:42.693

您需要确保`iterator.next()`将`char[]`. 您的迭代器应如下所示：

```
while (iterator.hasNext()) {
    char[] stopWord = (char[]) iterator.next();
    System.out.println(String.valueOf(stopWord));
} 
```

# html - 从 HTML 页面读取固定宽度格式的文本表格

> ID：16051292
> 
> 赞同：2
> 
> 时间：2013-04-17T04:06:37.143
> 
> 标签：html, r, xml, web-scraping, tabular

我正在尝试使用**R从类似于以下**[http://www.fec.gov/pubrec/fe1996/hraz.htm](http://www.fec.gov/pubrec/fe1996/hraz.htm)的表中读取数据，但一直无法取得进展。我意识到要做到这一点，我需要使用 XML 和 RCurl，但尽管网络上有许多其他示例涉及类似问题，但我无法解决这个问题。

 **第一个问题是该表在查看时只是一个表，但没有这样编码。将其视为 xml 文档，我可以访问表中的“数据”，但是因为我想获得几个表，所以我不认为这是最优雅的解决方案。

将其视为 html 文档可能会更好，但我对 xpathApply 相对不熟悉，并且不知道如何获取表中的实际“数据”，因为它没有被任何东西括起来（即 i-/i 或 b-/乙）。

过去我使用 xml 文件取得了一些成功，但这是我第一次尝试使用 html 文件做类似的事情。尤其是这些文件的结构似乎比我见过的其他示例要少。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T06:58:39.640

假设您可以将`html`输出读入文本文件（相当于从您的 Web 浏览器复制+粘贴），这应该可以为您提供很大的帮助：

```
# x is the output from the website 

library(stringr)
library(data.table)

# First, remove commas from numbers (easiest to do at beginning)
x <- gsub(",([0-9])", "\\1", x)

# split the data by District
districts <- strsplit(x, "DISTRICT *")[[1]]

# separate out the header info
headerInfo <- districts[[1]]
districts <- tail(districts, -1)

# grab the straggling district number, use it as a name and remove it 

    # end of first line
    eofl <- str_locate(districts, "\n")[,2]

    # trim white space and assign as name
    names(districts) <- str_trim(substr(districts, 1, eofl))

    # remove first line
    districts <- substr(districts, eofl+1, nchar(districts))

# replace the ending '-------' and trime white space
    districts <- str_trim(str_replace_all(districts, "---*", ""))

# Adjust delimeter (this is the tricky part)

    ## more than two spaces are a spearator
    districts <- str_replace_all(districts, "  +", "\t")

    ## lines that are total tallies are missing two columns. 
    ##   thus, need to add two extra delims. After the first and third columns

        # this function will 
        padDelims <- function(section, splton) {
          # split into lines
          section <- strsplit(section, splton)[[1]]
          # identify lines starting with totals
          LinesToFix <- str_detect(section, "^Total")
          # pad appropriate columns
          section[LinesToFix] <- sub("(.+)\t(.+)\t(.*)?", "\\1\t\t\\2\t\t\\3", section[LinesToFix])

          # any rows missing delims, pad at end
          counts <- str_count(section, "\t")
          toadd  <- max(counts) - counts
          section[ ] <- mapply(function(s, p) if (p==0) return (s) else paste0(s, paste0(rep("\t", p), collapse="")), section, toadd) 

          # paste it back together and return
          paste(section, collapse=splton)
        }

    districts <- lapply(districts, padDelims, splton="\n")

    # reading the table and simultaneously addding the district column
    districtTables <- 
       lapply(names(districts), function(d) 
         data.table(read.table(text=districts[[d]], sep="\t"), district=d) )
    # ... or without adding district number: 
    ##       lapply(districts, function(d) data.table(read.table(text=d, sep="\t")))

    # flatten it 
    votes <- do.call(rbind, districtTables)
    setnames(votes, c("Candidate", "Party", "PrimVotes.Abs", "PrimVotes.Perc", "GeneralVotes.Abs", "GeneralVotes.Perc", "District") ) 
```

样品表：

```
 votes

                        Candidate      Party PrimVotes.Abs PrimVotes.Perc GeneralVotes.Abs GeneralVotes.Perc District
 1:                  Salmon, Matt          R         33672         100.00        135634.00             60.18        1
 2:            Total Party Votes:                    33672             NA               NA                NA        1
 3:                                                     NA             NA               NA                NA        1
 4:                     Cox, John     W(D)/D          1942         100.00         89738.00             39.82        1
 5:            Total Party Votes:                     1942             NA               NA                NA        1
 6:                                                     NA             NA               NA                NA        1
 7:         Total District Votes:                    35614             NA        225372.00                NA        1
 8:                    Pastor, Ed          D         29969         100.00         81982.00             65.01        2
 9:            Total Party Votes:                    29969             NA               NA                NA        2
10:                                                     NA             NA               NA                NA        2
...
51:                Hayworth, J.D.          R         32554         100.00        121431.00             47.57        6
52:            Total Party Votes:                    32554             NA               NA                NA        6
53:                                                     NA             NA               NA                NA        6
54:                  Owens, Steve          D         35137         100.00        118957.00             46.60        6
55:            Total Party Votes:                    35137             NA               NA                NA        6
56:                                                     NA             NA               NA                NA        6
57:              Anderson, Robert        LBT           148         100.00         14899.00              5.84        6
58:                                                     NA             NA               NA                NA        6
59:         Total District Votes:                    67839             NA        255287.00                NA        6
60:                                                     NA             NA               NA                NA        6
61:            Total State Votes:                   368185             NA       1356446.00                NA        6
                        Candidate      Party PrimVotes.Abs PrimVotes.Perc GeneralVotes.Abs GeneralVotes.Perc District 
```**

# c++ - 使用输出重定向打印到命令行

> ID：16051294
> 
> 赞同：1
> 
> 时间：2013-04-17T04:06:41.673
> 
> 标签：c++, unix

当我从 Linux 命令行运行它时，我在我的 C++ 应用程序中使用 printf() 来打印一些信息。现在，我正在使用输出重定向（./main > output.txt）将结果保存到文件中。我想知道是否可以同时拥有两者：在程序运行时在命令行中查看结果，并进行输出重定向；无需通过 C++ 中的文件 I/O 显式执行此操作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T04:08:15.227

您需要程序中的解决方案吗？因为如果不是，您可以通过管道将输出输入`tee`其中，并将其输入并泵入文件和标准输出。

# sql-server - SSAS 浏览器窗口中的维度属性

> ID：16051298
> 
> 赞同：2
> 
> 时间：2013-04-17T04:07:00.603
> 
> 标签：sql-server, ssis, ssrs-2008, ssas

我正面临 SSAS 的问题。我使用所需的度量和维度从数据源视图创建了数据多维数据集，但部署多维数据集后我无法在浏览器窗口中查看我的维度表属性。我想这样做是为了对我的 SSAS 报告的时间维度进行深入研究。我为维度创建了时间层次结构，然后创建了属性关系。我部署了成功进行的多维数据集。但我无法在浏览器中查看我的维度下的维度属性。

我相信这与某些属性设置问题有关。任何人都可以请对此有所了解。

谢谢， 阿布舍克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:29:18.937

谢谢回复。我想问题现在已经解决了。实际上，我在处理多维数据集时也遇到了问题。因此，我通过在处理多维数据集之前忽略所有错误来部署多维数据集

对于未来的访问者：我的解决方法是：
右键单击“Cube”=>“Process”=>“Change Settings”=>“Dimension Key Errors”

活动“用户自定义错误配置”

为这四个下拉列表设置“忽略错误”“未找到密钥”“重复密钥”“空密钥转换为未知”“不允许空密钥”

键的问题将被忽略。我的项目是一个学术项目，目前，在验证使用此设置加载的数据后，我没有看到任何严重的影响。

我会欢迎其他专家对这个问题提出其他解决方案的建议。

谢谢你。

# php - 更改json格式

> ID：16051301
> 
> 赞同：0
> 
> 时间：2013-04-17T04:07:21.167
> 
> 标签：php, javascript, json

我想使用融合图表创建图表并使用 json 作为数据格式

如果我之前的数据是这样的：

```
{
 "items": [
   {
      "2013-03-28": 1771,
      "2013-03-29": 1585,
      "2013-03-30": 1582,
      "2013-03-31": 1476
    }
  ]
} 
```

我在处理中使用 php 获得上述数据：

```
<?php
$param  = $_GET['myparam'];

$Data = file_get_contents("http://mylink.com/proccess.php?output=json");

$Proses2 = json_decode($Data);

$array = array();
$array[] = (object)$Proses2;

if ($_GET['callback']) {
    echo $_GET['callback'] . '('.json_encode($array).')';
}else{
    echo '{"items":'. json_encode($array) .'}';
} 
```

如何更改数据，使其变得像这样的图表中使用的格式？

```
{ 
   "chart": { 
        "caption" : "Weekly Sales Summary" ,
        "xAxisName" : "Week",
        "yAxisName" : "Sales",
        "numberPrefix" : "$"
},

"data" : 
   [
        { "label" : "Day 1", "value" : "14400" },
        { "label" : "Day 2", "value" : "19600" },
        { "label" : "Day 3", "value" : "24000" },
        { "label" : "Day 4", "value" : "15700" }
   ]
} 
```

后来变成了：

```
{ 
   "chart": { 
        "caption" : "Weekly Sales Summary" ,
        "xAxisName" : "Week",
        "yAxisName" : "Sales",
        "numberPrefix" : "$"
},

"data" : 
   [
        { "label" : "2013-03-28", "value" : "1771" },
        { "label" : "2013-03-29", "value" : "1585" },
        { "label" : "2013-03-30", "value" : "1582" },
        { "label" : "2013-03-31", "value" : "1476" }
   ]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:33:35.270

作为`$Proses2`一个基本对象 ( `stdClass`)，您可以轻松地添加新属性，如`chart`and `data`，用您想要的内容填充它们（在本例中，数据来自`items`），最后删除该`items`属性

这是一个例子：

```
<?php

// The json
$json = '{"items":[{"2013-03-28":1771,"2013-03-29":1585,"2013-03-30":1582,"2013-03-31":1476}]}';

// Extract the json to a STD class object
$object = json_decode($json);

// print the actual object
print_r($object);

// modify object by adding new property
$object->chart = array(
   "caption" =>"Weekly Sales Summary",
   "xAxisName" => "Week",
   "yAxisName" => "Sales",
   "numberPrefix" => "$"
);

// Remove previous property
unset($object->items);

print_r($object); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T04:52:08.350

```
var item = { 
    "items":{
      "2013-03-28": "1771",
      "2013-03-29": "1585",
      "2013-03-30": "1582",
      "2013-03-31": "1476"
      }
    };

var data = [];temp=0;
for(var key in item.items)
{
alert(key);alert(item.items[key]);
data.push({});
data[temp].label = key;
data[temp].value = item.items[key];
temp++;
}
alert(JSON.stringify(data)); 
```

[JS 小提琴演示](http://jsfiddle.net/ftqp5/)

# javascript - 在调用 FB.init() 之前调用 FB.getLoginStatus()。疯狂的

> ID：16051302
> 
> 赞同：0
> 
> 时间：2013-04-17T04:07:34.573
> 
> 标签：javascript, jquery, facebook

```
window.fbAsyncInit = function(){
FB.init({
    appID       : 'my app id is here',
    channelUrl  : '//myappname.herokuapp.com/channel.php',
    status      : true,
    cookie      : true,
    xfbml       : true,
    frictionlessRequests: true
});

// Additional auth

};

 (function(d, s, id){
 var js, fjs = d.getElementsByTagName(s)[0];
 if (d.getElementById(id)) {return;}
 js = d.createElement(s); js.id = id;
 js.src = "//connect.facebook.net/en_US/all.js";
 fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk')); 
```

好的，那是我的 scripts.js 文件，我已经将 fb-root 包含到我的页面正文中，由于某种原因，在加载页面时，它的日志记录：

在调用 FB.init() 之前调用 FB.getLoginStatus()。

两次，在对 all.js 第 52 行的调用中，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:04:43.817

这就是我的做法：

```
window.fbAsyncInit = function () {
    if (FB.init) return;
    // init the FB JS SDK
    FB.init({
        appId: 'your app ID', // App ID from the App
        //channelUrl: '//' + window.location.hostname + '/channel.html',
        //This to get the user details back from Facebook
        //scope: 'id,name,gender,user_birthday,email', etc
        status: true, // check the login status upon init?
        cookie: true, // set sessions cookies to allow your server to access the session?
        xfbml: true  // parse XFBML tags on this page?
    });
} 
```

在 HTML 正文的末尾...

```
<script>
    (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
        fjs.parentNode.insertBefore(js, fjs);
    } (document, 'script', 'facebook-jssdk'));
</script> 
```

...或者您可能会使用 fb 嵌入 iframe
[Facebook Like Button Reference](https://developers.facebook.com/docs/reference/plugins/like/)

# linq - 如何使用 LINQ 查找具有共同部分的所有项目行？

> ID：16051304
> 
> 赞同：0
> 
> 时间：2013-04-17T04:07:42.470
> 
> 标签：linq

我需要返回所有包含部分 (X) 的记录（项目），这样我就可以在一个组或 .GroupBy 之后使用它

使用此汇总数据：

```
ItemName PartName
1        A
1        B
2        A
3        C 
```

所以Item1有两个部分（A，B），等等......

我需要一个 LINQ 查询，它将 - 查找所有具有 A 部分的项目（即项目 1 和 2） - 返回所有这些项目的所有行

```
1        A
1        B
2        A 
```

请注意，最终结果返回了行 (1 B)，因为 Item1 具有 PartA，因此我需要取回 Item1 的所有行。

我在看类似的东西：

```
let items = from data in summary where data.PartName == A select new { data.ItemName }  // to get all the items I need 
```

但是，既然我有了那个列表，我需要用它来获取列出的所有项目的所有行，我似乎无法弄清楚......

实际源代码（供参考）：注意：Recipe = ITEM Ingredient = PART（我只是想让它更简单）

```
 ViewFullRecipeGrouping = (
                from data in ViewRecipeSummary
                group data by data.RecipeName into recipeGroup
                let fullIngredientGroups = recipeGroup.GroupBy(x => x.IngredientName)
                select new ViewFullRecipe()
                {
                    RecipeName = recipeGroup.Key,
                    RecipeIngredients = (
                        from ingredientGroup in fullIngredientGroups
                        select new GroupIngredient()
                        {
                            IngredientName = ingredientGroup.Key
                        }
                    ).ToList(),
                    ViewGroupRecipes = (
                        from data in ViewRecipeSummary

                        // this is where I am looking to add the new logic to define something I can then use within the next select statement that has the right data based on the information I got earlier in this query.
                        let a = ViewRecipeSummary.GroupBy(x => x.RecipeName)
                            .Where(g => g.Any(x => x.IngredientName == recipeGroup.Key))
                            .Select(g => new ViewRecipe()
                                {
                                    RecipeName = g.Key,
                                    IngredientName = g.Select(x => x.IngredientName)
                                })                                                                  

                        select new GroupRecipe()
                        {
            // use the new stuff here

                        }).ToList(),
                }).ToList(); 
```

任何帮助将非常感激。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:20:55.127

我相信这可以满足您的要求：

```
var data = /* enumerable containing rows in your table */;
var part = "X";
var items = new HashSet<int>(data
    .Where(x => x.PartName == part)
    .Select(x => x.ItemName));
var query = data.Where(x => items.Contains(x.ItemName)); 
```

如果我最后理解您的评论，我相信这也符合您的要求：

```
var query = data
    .GroupBy(x => x.ItemName)
    .Where(g => g.Any(x => x.PartName == part))
    .Select(g => new
    {
        ItemName = g.Key,
        PartNames = g.Select(x => x.PartName)
    }); 
```

# wpf - WPF ResourceDictionary 能否为每个请求返回一个新实例

> ID：16051306
> 
> 赞同：4
> 
> 时间：2013-04-17T04:07:48.160
> 
> 标签：wpf, resourcedictionary

我们正在使用 ResourceDictionaries 来存储我们的应用程序的布局信息。延迟初始化非常棒，因为我们只有在创建元素时才能获取元素所需的布局。问题是每个元素都从`ResourceDictionary`共享布局的每个元素中获取相同的实例（或者如果超出范围并且以后需要，则使用相同的实例）。

我们可以将模板存储在字典中，那么它们是否被共享并不重要，但如果不是这种缓存行为，我们会有一个相当不错的系统。

有没有办法改变字典的这种行为，还是我必须编写自己的类来按需从 XAML 创建项目？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T04:17:40.647

尝试应用 x:Shared="false" 属性。然后每个资源都应该获得单独的副本。

# android - 在带有异步 HTTP 请求的活动中触发 onSuccess

> ID：16051307
> 
> 赞同：1
> 
> 时间：2013-04-17T04:07:48.523
> 
> 标签：android, asynchronous

我正在编写一个简单的天气应用程序，以学习如何为 Android 编程，但是我遇到了困难。

目前，应用程序获取用户 GPS 位置，然后向 API 发送请求以获取天气信息。问题是，我已经将这些 API 调用抽象为另一个类`Darksky`，它们异步运行。

当我执行以下操作时，这会成为一个问题：`weeklyForecast = darksky.getWeeklyForecast();`. 因为请求在`getWeeklyForecast()`方法中异步运行，所以`weeklyForecast`会返回为空，因为方法在得到 API 响应之前返回。

这是任何有兴趣的人的方法：

```
public ArrayList<Forecast> getWeeklyForecast() {
    // Clear before inserting new data
    weeklyForecast.clear();

    client.get(BASE_URL + API_KEY + "/" + latitude + "," + longitude + "?units=uk&exclude=hourly%2Calerts%2Cflags", null, new AsyncHttpResponseHandler() {
        @Override
        public void onSuccess(String response) {
            try {
                JSONObject root = new JSONObject(response);
                JSONObject daily = root.getJSONObject("daily");
                JSONArray forecasts = daily.getJSONArray("data");

                // Loop through every day
                for (int i = 0; i < forecasts.length(); i++) {
                    JSONObject dayObject = forecasts.getJSONObject(i);

                    weeklyForecast.add(new Forecast(
                        dayObject.getInt("time"),
                        dayObject.getString("summary"),
                        dayObject.getString("icon"),
                        dayObject.getDouble("temperatureMin"),
                        dayObject.getDouble("temperatureMax"),
                        dayObject.getDouble("windSpeed"),
                        dayObject.getDouble("humidity")
                    ));
                }
            } catch(Exception e) {
                // TODO: handle   
            }
        }
    });

    return weeklyForecast;
} 
```

如何检测 HTTP 请求的`onSuccess()`事件何时从我的主要活动中触发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:21:40.857

下载完成后使用接口获取回调，如下所示。

```
class Darksky{

    interface updateUI{
        void onFinishedDownload(ArrayList<Forecast> array);
    }

    public ArrayList<Forecast> getWeeklyForecast() {
        // Clear before inserting new data
        weeklyForecast.clear();

        client.get(BASE_URL + API_KEY + "/" + latitude + "," + longitude + "?units=uk&exclude=hourly%2Calerts%2Cflags", null, new AsyncHttpResponseHandler() {
            @Override
            public void onSuccess(String response) {
                try {
                    JSONObject root = new JSONObject(response);
                    JSONObject daily = root.getJSONObject("daily");
                    JSONArray forecasts = daily.getJSONArray("data");

                    // Loop through every day
                    for (int i = 0; i < forecasts.length(); i++) {
                        JSONObject dayObject = forecasts.getJSONObject(i);

                        weeklyForecast.add(new Forecast(
                                dayObject.getInt("time"),
                                dayObject.getString("summary"),
                                dayObject.getString("icon"),
                                dayObject.getDouble("temperatureMin"),
                                dayObject.getDouble("temperatureMax"),
                                dayObject.getDouble("windSpeed"),
                                dayObject.getDouble("humidity")
                                ));
                    }
                } catch(Exception e) {
                    // TODO: handle   
                }

                updateUI.onFinishedDownload(weeklyForecast);
            }
        });

    }
} 
```

在您的 Activity 或 UIClasses 中，您只需要实例化 updateUI 接口并使用 arraylist 传递：

```
@Override
public void onFinishedDownload(ArrayList<Forecast> array) {
    // Do something with your arraylist here.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:11:00.930

使用监听器——当你开始下载时，通过 downloadComplete 方法向 Darksky 类传递一个对象。在 onSuccess 中调用它，并将结果传递给它。调用 downloadComplete 时更新 UI。

# mysql - 有没有办法在没有子选择的情况下进行此查询？

> ID：16051310
> 
> 赞同：0
> 
> 时间：2013-04-17T04:07:59.213
> 
> 标签：mysql, sql, optimization

我不是很积极，但我相信子选择不是最优的（速度方面？）。

有没有办法从我的查询中删除这个子选择（我认为查询是不言自明的）。

```
select *
from tickers
where id = (select max(id) from tickers where annual_score is not null); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T04:13:15.083

会像：

`SELECT * FROM ticker WHERE annual_score IS NOT NULL ORDER BY id desc LIMIT 1`

工作？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T04:12:15.463

那个特定的子选择根本不应该是低效的。它应该在主查询开始之前运行*一次。*

有一类子查询*效率*低下（那些在主查询和子查询之间连接列的子查询），因为它们最终对主查询的每一行都运行子查询。

但这不应该是其中之一，除非 MySQL 严重脑损伤，我对此表示怀疑。

但是，如果您仍然热衷于摆脱子查询，您可以按 id （降序）对行进行排序，并且只获取第一个，例如：

```
select * from tickers
where annual_score is not null
order by id desc
limit 0, 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T04:14:31.913

不太熟悉 MySQL，但如果你想消除子查询，那么你可以尝试这样的事情：

```
select * 
from tickers
where annual_score is not null
order by id desc
limit 1 
```

我不知道这是否或多或少的性能，因为 MySQL 不是我的背景。

# ios - 如何使用自动调整大小和自动布局并更改其默认行为？

> ID：16051311
> 
> 赞同：-6
> 
> 时间：2013-04-17T04:07:59.653
> 
> 标签：ios, uiview, autolayout, autoresizingmask

我有一个父视图作为 Scrollview。我在该滚动视图上添加了两个子视图 view1、view2。但我需要同时执行以下操作

1.  当我在运行时增加其中一个子视图 view1 的高度时，应使用 Autolayout 或 Autoresizing 更改父视图高度

2.  当我在运行时增加其中一个子视图 view2 的高度时，父视图高度不应更改自动布局或自动调整大小

3.  当我及时改变父视图的高度时，它不应该影响它的子视图。

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:52:19.723

在自动布局中：

*   在 view1 和 superview 的上边界之间建立一个最小距离。
*   在 view1 和 superview 的底部边框之间建立固定（最小）距离。
*   为 view2 留出这些最小距离。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T02:04:59.263

无需使用 -layoutSubviews。当增加子视图 view1 的高度时，您可以更新滚动视图的内容大小。当增加子视图 view2 的高度或滚动视图的高度时，什么都不做。

# php - 如何检测手机及其版本

> ID：16051317
> 
> 赞同：-4
> 
> 时间：2013-04-17T04:08:31.793
> 
> 标签：php, mobile

如何用php检测以下手机？

1.  塞班
2.  项目清单
3.  安卓
4.  黑莓版本 5-6
5.  黑莓版本 7
6.  Iphone 或 Ipad

比如， if ($mobile='Symbian') {echo "Somthing";}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:21:57.873

这对我有用。谷歌也认可它。

[https://code.google.com/p/php-mobile-detect/](https://code.google.com/p/php-mobile-detect/)

# silverlight-4.0 - 数据绑定到 SilverLight 4 .0 中的组合框

> ID：16051318
> 
> 赞同：0
> 
> 时间：2013-04-17T04:08:32.597
> 
> 标签：silverlight-4.0, silverlight-5.0

我正在尝试将数据绑定到组合框。数据来自名称为 tbltest 的数据库表，表有 2 个字段 id 和名称。

当我尝试将名称绑定到组合框时，它会在视图中显示 tbltest:name。我正在使用域服务和 MVVM 来绑定数据。

下面是我的 ViewModel 代码：

```
 public ViewModel()
    {
        var query = context.GetTblTestsQuery();
        var load = context.Load(query);
        load.Completed += (s, ea) =>
        {
            ObsCompanyCollection = new ObservableCollection<tblTest>(context.tblTests);

        };

    }
  private ObservableCollection<tblTest> _ObsCompanyCollection = new ObservableCollection<tblTest>();     
    public ObservableCollection<tblTest> ObsCompanyCollection
    {
        get
        {
            return _ObsCompanyCollection;
        }
        set
        {
            if (_ObsCompanyCollection != value)
            {
                _ObsCompanyCollection = value;
                NotifyPropertyChanged("ObsCompanyCollection");
            }
        }

    } 
```

下面是我的 XAml 文件的代码：

```
 <UserControl.Resources>
    <my:ViewModel x:Key="ViewModel"/>
</UserControl.Resources>
<Grid x:Name="LayoutRoot" Background="White" DataContext="{StaticResource ViewModel}">

    <ComboBox Height="23" HorizontalAlignment="Left" Margin="47,128,0,0" Name="comboBox1" VerticalAlignment="Top" Width="120" DisplayMemberPath="{Binding name,Mode=TwoWay}" ItemsSource="{Binding ObsCompanyCollection,Mode=TwoWay}" SelectedItem="{Binding tbldata.SelectCompanyId,Mode=TwoWay}" /> 
```

我不知道这段代码有什么问题。我只想在我的组合框中显示名称。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T06:34:55.807

尝试这个

```
 <ComboBox Height="23" HorizontalAlignment="Left" Margin="47,128,0,0" Name="comboBox1" VerticalAlignment="Top" Width="120" DisplayMemberPath="name" ItemsSource="{Binding ObsCompanyCollection,Mode=OneWay}" 
```

# c# - 尝试动态填充 ASP.NET MenuItem 时引发空引用异常

> ID：16051320
> 
> 赞同：0
> 
> 时间：2013-04-17T04:08:44.167
> 
> 标签：c#, asp.net, treeview

我正在尝试从后面的代码`ASP Menu`中动态填充一个，但我遇到了一个异常。`ASP MenuItems``object reference is not set to an instance of an object`

这是我的 ASP 的样子：

```
<asp:Menu ID="HeaderMenu" runat="server">
    <Items>
    </Items>
</asp:Menu> 
```

这就是我背后的代码的样子：

```
protected void Page_Load(object sender, EventArgs e)
{
    PopulateMenu();
}

protected void PopulateMenu()
{
    HeaderMenu.Items.Add(new MenuItem 
    {
        Text = "Register Now!",
        NavigateUrl = "~/Pages/Register.aspx"
    });
} 
```

它在调用 Add 时抛出异常，但我不知道为什么。

编辑：在页面加载时调用 PopulateMenu()

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:29:16.743

尝试这个

```
<asp:Menu ID="HeaderMenu" runat="server">
    <Items>
    </Items>
</asp:Menu>

protected void Page_Load(object sender, EventArgs e)
{
    PopulateMenu();
}

protected void PopulateMenu()
{
    HeaderMenu.Items.Add(new MenuItem 
    {
        "Register Now!",
        "","", 
        "~/Pages/Register.aspx"
    });
} 
```

# javascript - 使用 .after() 方法添加的 jquery 元素不会触发事件

> ID：16051325
> 
> 赞同：1
> 
> 时间：2013-04-17T04:10:17.583
> 
> 标签：javascript, jquery, html, jquery-after

这是代码：

```
<s:file name="upload"  id="upload"></s:file>
  $('input[id^="upload"]').change(function(){
        alert("aa");
        $(this).after('<input type="file" name="upload_3" id="upload_3"/>');
        alert($("#upload_3").attr("name"));
    });
    $('input[id^="upload"]').click(function(){
        alert("click");
    }); 
```

当我单击“上传”元素时，它会触发`click`和`change`事件，并提醒“aa”和“upload_3”。然后`<input type="file" name="upload_3" id="upload_3"/>`在 HTML 中的“上传”元素之后添加它。但是当我单击新添加的元素（“upload_3”元素）时，`click`甚至`change`没有触发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:18:24.973

您需要将事件处理程序附加到动态附加的元素。使用`jQuery`，该`.on()`方法将事件处理程序附加到`jQuery object`. 从 开始`jQuery 1.7`，该`.on()`方法提供了附加事件处理程序所需的所有功能。

这可能会帮助您：

```
$(document).on('click','input[id^="upload"]',function(){
    alert("click");
}); 
```

另请查看[文档](http://api.jquery.com/on)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T04:22:42.920

事件在加载 DOM（静态元素）时绑定到元素。当您动态添加一些元素时，您需要自己附加事件。

[以下代码将使用bind()](http://api.jquery.com/bind/)将点击事件绑定到动态添加的元素。

```
$(this).after('<input type="file" name="upload_3" id="upload_3"/>').bind('click', function(){
    alert('Click event fired for the new element');
}); 
```

您也可以使用[on](http://api.jquery.com/on/)方法。从 jQuery 1.7 开始，.on() 方法提供了附加事件处理程序所需的所有功能。

来自[jquery 文档](http://api.jquery.com/on/)：

> 事件处理程序仅绑定到当前选定的元素；当您的代码调用 .on() 时，它们必须存在于页面上。如果将新 HTML 注入页面，请在将新 HTML 放入页面后选择元素并附加事件处理程序。

```
$(this).after('<input type="file" name="upload_3" id="upload_3"/>').on('click', function(){
    alert('Click event fired for the new element');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:26:41.610

在这种情况下，您需要设置委托事件处理程序；这可以通过使用来完成[`.on()`](http://api.jquery.com/on)：

```
 $('#parent').on('click', 'input[id^="upload"]', function() {
     // do your stuff here
 }); 
```

在这种情况下，`#parent`节点指的是`<input>`元素的最近父级。单击事件首先由该父节点处理，然后在调用单击处理程序以确保`this`引用正确的节点之前进行转换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T04:39:07.370

您可以对动态添加到 DOM 的元素使用“on”或“live”。但“开”是首选。

```
$('input[id^="upload"]').change(function(){
    var _this = $(this)
    $('<input type="file" name="upload_3" id="upload_3"/>').insertAfter(_this);
    });

$(document).on('click','input[id^="upload"]',function(){
    // do your stuff
}); 
```

# c++ - 使用 Horner 方法计算多项式的 C++ 递归帮助

> ID：16051326
> 
> 赞同：0
> 
> 时间：2013-04-17T04:10:39.750
> 
> 标签：c++, recursion

到目前为止，这是我的代码。因为我一直得到一个不正确的答案，所以似乎有什么问题。我正在写一个格式化的文本文件：2 3.0 1.0

2 是数组的大小，然后 3.0 和 1.0 是系数。希望我的解释没有遗漏太多。任何帮助将不胜感激。谢谢

```
double polyeval(double* polyarray, double x, int arraySize)
{
    //int result = 0;

    if(arraySize == 0)
    {
        return polyarray[arraySize];
    }

    //result += x*(polyarray[arraySize]+polyeval(polyarray,x,arraySize-1));
      return polyarray[arraySize-1]+ (x* (polyeval(polyarray,x,arraySize-1)));
       //return result;
}

int main ()
{
    int arraySize;
    double x;
    double *polyarray;

    ifstream input;
    input.open("polynomial.txt");
    input >> arraySize;
    polyarray = new double [arraySize];
    for (int a = arraySize - 1; a >= 0; a--)
    {
        input >> polyarray[a];
    }

    cout << "For what value x would you like to evaluate?" << endl;
    cin >> x;
    cout << "Polynomial Evaluation: " << polyeval(polyarray, x, arraySize);

    delete [] polyarray;
} 
```

如果我读入一个大小不同的格式的文本文件，它将解决用户给出的任何值 x 的想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:16:37.427

只是胡乱猜测

```
for (int a = arraySize - 1; a >= 0; a--)
//                            ^^
{
    input >> polyarray[a];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:16:46.327

这里有一个错误：

```
for (int a = arraySize - 1; a > 0; a--)
{                             //^^should be a >=0 
    input >> polyarray[a];
} 
```

您以这种方式缺少一些条目。

递归函数应如下所示：

```
int polyeval(double* polyarray, double x, int arraySize)
{
   if(arraySize == 1)
   {
      return polyarray[arraySize-1];
   }

   return x*(polyarray[arraySize-1]+polyeval(polyarray,x,arraySize-1));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:37:02.837

The problem is mainly with the definition of the polynomial coefficients. Your code assumes a polynomial on the form:

```
x( p(n) + x( p(n-1) + x( p(n-2) + ... x(p(1) + p(0)))..)) 
```

This line:

```
result += x*(polyarray[arraySize]+polyeval(polyarray,x,arraySize-1)); 
```

Should become:

```
result += pow(x,arraySize)*polyarray[arraySize]+polyeval(polyarray,x,arraySize-1); 
```

This way the polynomial is defined correctly as p(n)x^n + p(n-1)x^(n-1) ... + p1 x + p0

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T05:03:08.743

无法准确计算出您要做什么，或者为什么要使用递归。因此，我创建了一个似乎可以给出正确结果的非递归版本。

```
#include <iostream>
using namespace std;

double polyeval(const double* polyarray, double x, int arraySize) {
    if(arraySize <= 0) { return 0; }
    double value = 0;
    const double * p = polyarray + (arraySize-1);
    for(int i=0; i<arraySize; ++i) {
        value *= x;
        value += *p;
        p--;
    }
    return value;
}

int main () {

    const int arraySize = 3;

    const double polyarrayA[3] = {0.0,0.0,1.0}; // 0 + 0 x + 1 x^2 
    const double polyarrayB[3] = {0.0,1.0,0.0}; // 0 + 1 x + 0 x^2 
    const double polyarrayC[3] = {1.0,0.0,0.0}; // 1 + 0 x + 0 x^2

    cout << "Polynomial Evaluation A f(x) = " << polyeval(polyarrayA, 0.5, arraySize)<<std::endl;
    cout << "Polynomial Evaluation B f(x) = " << polyeval(polyarrayB, 0.5, arraySize)<<std::endl;    
    cout << "Polynomial Evaluation C f(x) = " << polyeval(polyarrayC, 0.5, arraySize)<<std::endl;    

} 
```

你可以看到它在这里运行：

[http://ideone.com/HE4r6x](http://ideone.com/HE4r6x)

# ember.js - 如何在ember中加载带有父对象的子对象

> ID：16051330
> 
> 赞同：1
> 
> 时间：2013-04-17T04:11:08.043
> 
> 标签：ember.js, ember-data

我正在使用 Ember RC2 和 Ember-Data 12 有以下关系（简化）：

```
App.GlobalData = DS.Model.extend({
    lat: DS.attr('number'),
    lon: DS.attr('number'),
});

App.System = DS.Model.extend({
    title: DS.attr('string'),

    data: DS.belongsTo('App.GlobalData'),   
}); 
```

在我的（系统）视图中，我现在想像这样访问孩子的数据：`{{ data.lat }}`

似乎 Ember（目前我正在使用 FixtureAdapter，但我也希望将来可以与 RESTadapter 一起使用）不会自动加载子元素数据。在`{{ data.id }}`返回 id 的值（在 App.GlobalData.FIXTURES 中指定）时，`{{ data.lat }}`返回`undefined`.

我通过创建一个数组控制器在某种程度上解决了这个问题：

```
App.GlobalDatasController = Ember.ArrayController.extend({});
App.globalDatasController = App.GlobalDatasController.create({}); 
```

并在我的 ApplicationRoute 中预加载所有 GlobalData

```
App.ApplicationRoute = Ember.Route.extend({
  setupController: function() {
      App.globalDatasController.set('content', App.GlobalData.find());
  }
}); 
```

但是，这似乎不是一个好的解决方案，因为它需要我加载*所有*GlobalData，即使我可能只需要一个。

我确信有一个关于如何处理这个问题的最佳实践，但是，尽管我尽了最大的研究努力，但我还是没能找到它。

总结一下我的问题：

1.  我如何以及在哪里告诉 ember 与父级一起加载子级数据（无需旁加载）？
2.  如果侧载是唯一的选择，我将如何在 FixtureAdapter 中实现它？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T15:17:29.687

我发现了问题：在我的 FIXTURES 中，我将 ID 指定为整数而不是字符串。不知道为什么这会有所作为，但是一旦我改变了它，它就起作用了。

# c# - 在 Windows 8 Metro 应用程序中创建带圆角的图像

> ID：16051339
> 
> 赞同：0
> 
> 时间：2013-04-17T04:12:23.213
> 
> 标签：c#, xaml, windows-runtime, microsoft-metro, windows-store-apps

我正在尝试在 Windows 8 Metro 应用程序中创建动画扑克牌。我发现通过在 xaml 中使用 2 个矩形并进行变换并设置 z 顺序，我可以获得看起来不错的动画。但是，当我尝试将子图像（用于卡片的正面）添加到其中一个矩形时，我无法编译。

有什么方法可以在矩形内使用 xaml 图像标记，以便您可以使用 radiusX radiusY 属性来圆角？

这是我使用的允许旋转的东西（x 和 z 平面）

```
<Rectangle x:Name="cardRectBack"  Stroke="{StaticResource HyperlinkPointerOverForegroundThemeBrush}" RadiusX="20" RadiusY="20" Tapped="cardRect_Tapped" RenderTransformOrigin="0.5,0.5">
        <Rectangle.RenderTransform>
            <RotateTransform x:Name="rotateCard"/>
        </Rectangle.RenderTransform>
        <Rectangle.Projection>
            <!-- Apply a PlaneProjection to the image -->
            <PlaneProjection x:Name="backYRot" RotationY="20"/>
        </Rectangle.Projection>
        <Rectangle.Fill>
            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                <GradientStop Color="Black"/>
                <GradientStop Color="#FFBB4444" Offset="1"/>
            </LinearGradientBrush>
        </Rectangle.Fill>
    </Rectangle> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:44:26.723

您可以使用`ImageBrush`代替`LinearGradientBrush`：

```
<Rectangle.Fill>
    <ImageBrush ImageSource="Assets/MyImage.png" />
</Rectangle.Fill> 
```

# php - PHP - MySQL - 表不存在

> ID：16051341
> 
> 赞同：0
> 
> 时间：2013-04-17T04:12:58.317
> 
> 标签：php, mysql, exists

我使用 PHP 创建了一个表。当我去访问那个表时，我得到错误 -table 不存在。创建表时，我已将所有权限授予用户。表名是小写字母，如果我在本地机器上运行查询，它可以正常工作。我认为这是一个权限问题，但无法解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:37:24.507

try adding some error handling:

```
 $rsLogin = mysql_query($loginQuery, $connect) or die(mysql_error()); 
```

# java - ArrayList 和 JOptionPane.showInputDialog()

> ID：16051342
> 
> 赞同：1
> 
> 时间：2013-04-17T04:13:05.580
> 
> 标签：java, swing

我正在尝试学习 Java，并且已经从 PHP 中走了很长一段路，我在创建代码时尝试应用相同的心态。但正如你们许多人已经知道的那样，它并不那么容易。

话虽如此，我有一个问题。我想从`ArrayList`. 我喜欢使用这种`JOptionPane.showInputDialog()`方法来尝试这个想法。

这是我目前所拥有的，但我收到一条错误消息，告诉我`no suitable method found for showInputDialog`

```
ArrayList<String> projectList = new ArrayList<String>();

while(results.next())
    projectList.add(results.getString("project"));

String inputDialog = (String)JOptionPane.showInputDialog(this, "Choose project to open", "Open Project", JOptionPane.PLAIN_MESSAGE, null, projectList, "--"); 
```

我知道问题在于，当我将`ArrayList`数组对象作为数组对象传递时，我会抛出此错误。但是如果我做了类似的事情

```
Object[] projectList = {"one", "two"}; 
```

然后它按预期工作，然后我尝试这样做并`projects`作为我的数组对象传入。

```
Object[] projects = {projectList.toString()}; 
```

这有点工作，但随后输出看起来像`"one, two"`下拉列表中的 1 行项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:19:12.570

如果需要，您可以使用[List.toArray()](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#toArray%28%29)`ArrayList`转换为，即： `Object[]`

```
ArrayList<String> list = new ArrayList<String>();
list.add("one");
list.add("two");
Object[] result = list.toArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T04:17:41.827

projectList 是一个 ArrayList，将其转换为数组，然后将其传递给方法 JOptionPane.showInputDialog()。请检查 List.toArray() 方法。

```
String [] projects = projectList.toArray(new String[projectList.size()]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T04:20:12.697

尝试关注

```
 Object[] projectListArray =new Object[projectList.size()];
    projectList.toArray(projectListArray);

String inputDialog = (String)JOptionPane.showInputDialog(this, "Choose project to open", "Open Project", JOptionPane.PLAIN_MESSAGE, null, projectListArray , "--"); 
```

希望能帮助到你。

# utf-8 - 将标准外观字符转换为奇怪/疯狂的 UTF-8 字符？

> ID：16051344
> 
> 赞同：5
> 
> 时间：2013-04-17T04:13:28.240
> 
> 标签：utf-8

这个问题的灵感来自这个 SO 答案：[https ://stackoverflow.com/a/1732454/11125](https://stackoverflow.com/a/1732454/11125)

我想编写一个脚本来将标准外观的字符（例如英文字母表中的字母）转换为不常见的 UTF-8 字符，这让我看起来很疯狂。

是否`kiamlaluno`筛选了数千个 UTF-8 字符以找到与英文字母相似的字符，或者是否有更自动化的方法来做到这一点？

我想要 Python 中的答案，但任何编程语言都可能会给我一个合适的解决方案。

例如，转换：

> 小马

至

> P̯͍̭O̚​N̐Y̡

SO答案的一个不错的摘录：

.

co*̶͑̾̾g͇̫͛͆̾ͫ̑͆l͖͉̗̩̳̟̍ͫͥͨe̠̅sza̡͊͠͝lgό是to的to͇̹̺ͅɲ̴ȳ̳p̯͍̭o̚p̯͍̭o̚n̐y̡y̡h̸̡̪̯ͨ͊̽̅̾̎ȩ̬̩̾͛ͪ̈́̀́͘c̷̙̲̝͖ͭ̏ͥͮ͟oͮ͏̮̪̝͍m̲̖͊̒ͪͩͬ̚̚͜ȇ̴̟̟͙̞ͩ͌͝s̨̥̫͎̭ͯ̿̔̀ͅ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T04:22:03.197

[有一个名为pyzalgo](https://github.com/mjgiarlo/pyzalgo/blob/master/zalgo.py)的 python 模块。

```
>>> import zalgo
>>> print zalgo.zalgo('hello')
Ḩ̝̳͓̪̲͌̌͗̔́͌̄͢͢͢͢͢͢E̶̢̯̭̟̥̖̯̙̬ͪ̄̉ͭ͗̏́̈́L̢̢͓̺͇̠̠͉͙̪͍̽ͣͩ͂̾͒̊ͦL̵̶̶̢̬͈̬̦̜̥̲̜͓͎̝̣̙̞̝Ơ̷̸̴̷̘͙͕͈̞̜̠͙̰̬̰̣̟̭ 
```

快速查看代码后，它似乎非常简单且可自定义。

感谢@hobbs 的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-18T14:16:25.230

也许不是“看起来很疯狂”，而是类似的东西：

[https://github.com/reinderien/mimic](https://github.com/reinderien/mimic)

# python - 在 Windows 上让 pypy 可用于 pyscripter（或任何其他 ide）？

> ID：16051345
> 
> 赞同：1
> 
> 时间：2013-04-17T04:13:39.223
> 
> 标签：python, python-2.7, pypy, pyscripter

也许我遗漏了一些东西，但我刚刚下载了 pypy 2.0 beta2 windows 二进制文件（32 位），看来我可以通过执行 pypy.exe 来运行解释器。但是，我希望 pypy 可以与 pyscripter 一起使用，并且我的所有旧库都可以使用。这可能吗？还是好像我刚刚安装了新版本的 python（所以我需要再次安装我所有的库）？我可能在基本层面上感到困惑。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T04:23:11.020

这不是“好像”。:-) 您安装了新版本的 Python。是的，您必须重新安装所有库。

您似乎告诉 PyScripter 它使用哪个 Python 来调试 PYTHONHOME 变量。尝试这个：

```
SET PYTHONHOME=C:\<PathtoPyPy>
PyScripter --PYTHON27 --PYTHONDLLPATH "C:\<PathtoPyPy>" %1 %2 %3 %4 %5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-08T22:03:24.600

JetBrains 的 PyCharm 社区版 IDE 支持 pypy 或任何其他解释器

只需转到文件 > 设置 > 项目解释器并设置解释器位置

# visual-studio - vc++是语言还是工具

> ID：16051347
> 
> 赞同：0
> 
> 时间：2013-04-17T04:13:48.303
> 
> 标签：visual-studio, visual-c++

VC++（visual C++）是语言还是工具？如果不是工具，Visual Studio 和 VC++(Visual C++) 有什么区别？另外，Visual Studio 中使用了哪个编译器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:28:46.450

微软在他们的语言中很模棱两可。例如，[在一个地方](http://msdn.microsoft.com/en-US/library/vstudio/60k1461a.aspx)，他们提到了“Visual Studio 中强大而灵活的 Visual C++ 语言和工具”。在[另一个](http://msdn.microsoft.com/library/vstudio/zdbe067e.aspx)中，他们指的是“Visual C++ 编译器工具”（没有提及“Visual C++ 语言”）。

据我所知，虽然 Visual C++（和/或 Visual Studio，取决于您的观点）提供了许多 Microsoft 特定的库，但它们并未对 C++ 语言本身进行任何更改。在我看来，Visual C++ 是一种工具，而不是一种语言。这些工具支持的编程语言是 C++。（实际上，它们支持几种语言变体，例如 C++/CLI 和 WinRT C++。但其他 IDE 和工具也支持这些变体。语言和工具并不相同，尽管微软在这些问题上一直模棱两可。）

也来自[维基百科](http://en.wikipedia.org/wiki/Visual_C++)：

> Microsoft Visual C++（通常缩写为 MSVC 或 VC++）是 Microsoft 的商业（提供免费版本）集成开发环境 (IDE) 产品，用于 C、C++ 和 C++/CLI 编程语言。

# javascript - XMLDoc() 和 ActiveXObject() 之间的区别

> ID：16051352
> 
> 赞同：1
> 
> 时间：2013-04-17T04:14:28.210
> 
> 标签：javascript

我正在尝试将以下 VB 代码重写为 Javascript -

```
sub UpdateDisplay()     
    on Error resume next
    Dim objXMLDoc
    Set objXMLDoc = CreateObject("MSXML2.DOMDocument")
    objXMLDoc.async = false
    objXMLDoc.load("<%=StatsURL%>")

    If (objXMLDoc.xml ="") Then 
       'alert("error")
    Else
        document.body.innerHTML=objXMLDoc.xml   

    End If
end sub

sub StartTimer()
    setInterval "UpdateDisplay",5000
end sub 
```

我想出了以下内容，但由于某种原因它没有显示任何内容......

```
function updateDisplay(){
    var objDom = new XMLDoc();
    objDom.async = false;
    objDom.loadXML("<%=StatsURL%>");

    if (objDom.xml == ""){
        alert(e);
    } else{
        document.body.innerHTML = objDom.xml;
    }           
}

function startTimer(){
    var myVar=setInterval(function(){updateDisplay()},5000);
} 
```

这被称为 -

```
<body onload="Javascript:startTimer();"> 
```

请注意，“StatsURL”是来自另一段代码的变量。

在网上查看后，我发现 - [http://msdn.microsoft.com/en-us/library/windows/desktop/ms764708(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms764708%28v=vs.85%29.aspx)但是它显示了在 Javascript 中实例化 XML DOM Doc 的不同方法。

与实例化 `var xmlDoc = new ActiveXObject("Msxml2.DOMDocument.3.0"); 相比，实例化为 XMLDoc() 有什么区别？我只是想了解为什么我写的代码不起作用。

任何建设性的帮助都会很棒 - 谢谢！:)

# cocoa-touch - 异步请求 iOS 6 的 NSURLConnection 状态码

> ID：16051355
> 
> 赞同：1
> 
> 时间：2013-04-17T04:14:34.420
> 
> 标签：cocoa-touch, ios6, http-status-code-401, nsurlconnectiondelegate, sendasynchronousrequest

目前使用 NSURLConnection 中的 sendAsynchronous 进行发布和获取请求，但无法获取响应中的状态码。大多数帖子都建议使用 NSURLConnection 及其委托方法，我理解它们也是异步的。

我不明白代表如何将信息发送回调用方法（最终需要数据的方法）。sendAsynchronous 方法有一个我现在正在使用的回调。

我是新手，谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T12:05:07.963

当您使用`sendAsynchronousRequest:queue:completionHandle`方法时，我将尝试在这种情况下回答：

```
[NSURLConnection sendAsynchronousRequest:request 
                                   queue:queue 
                       completionHandler:
    ^(NSURLResponse *response, NSData *data, NSError *error) {

    // This will get the NSURLResponse into NSHTTPURLResponse format
    NSHTTPURLResponse* httpResponse = (NSHTTPURLResponse*)response;

    // This will Fetch the status code from NSHTTPURLResponse object
    int responseStatusCode = [httpResponse statusCode];

    //Just to make sure, it works or not
    NSLog(@"Status Code :: %d", responseStatusCode);
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-15T01:30:53.563

我有一个包装类，它使这变得非常容易并保持你的代码干净： [https ://github.com/ricardocontrerasrobles/EasyNetwork](https://github.com/ricardocontrerasrobles/EasyNetwork)

# jquery - 通过 jquery-dialog 流存储变量值

> ID：16051357
> 
> 赞同：0
> 
> 时间：2013-04-17T04:14:47.273
> 
> 标签：jquery, twitter-bootstrap, dialog

我正在做一个脏表格检查。这样做时，如果表单值发生变化，我会向用户显示一个提示，询问他/她是否要继续。如果是，我想导航到点击链接的 url。我的问题是我无法保留网址。

```
$("a").click(function (e) {
        url = $(this).attr('href');
        if(str != $("form").serialize()){
            $('#prompt').show();
            e.preventDefault();
        }
    }); 
```

我正在使用引导对话框显示表单已更改的消息。现在如果用户仍然想离开页面，我如何跟踪我需要转发的 url。

```
<div class="modal-footer">  
            <a id="hide" class="btn">Stay on Page</a>
            <a id="navigate" class="btn" href="#">Leave Page</a>  
        </div>

$('#navigate').click(function () {
        console.log(url)
    }); 
```

当我关闭对话框时，我需要一种方法来保留 url 的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:17:04.987

这可能与`url`定义的位置有关。我做了一个快速的 js fiddle，它显示了它的两个示例工作和不工作，具体取决于定义 url 的位置[http://jsfiddle.net/zdgNS/4/](http://jsfiddle.net/zdgNS/4/)。

这个 javascript 应该像我的例子所示的那样工作：

```
(function() {
     var url;
    $('#link').click(function() {
        url = $(this).attr("href");
        return false;
    });

    $('#button').click(function() {
        console.log(url);
    });
})(); 
```

如果您想了解更多关于 javascript 变量作用域的信息，请阅读这个问题：JavaScript[中变量的作用域是什么？](https://stackoverflow.com/questions/500431/javascript-variable-scope)

# c# - 如果为null，如何返回0然后导入到datagridview

> ID：16051358
> 
> 赞同：-1
> 
> 时间：2013-04-17T04:14:49.600
> 
> 标签：c#, sql, sql-server, datagridview

我有一个这样的sql数据

```
1 2m
2 3m
3 3m
6 6m
7 6m 
```

我想将其导出并显示到 datagridview 中。

```
1 2m
2 3m
3 3m
4 0m
5 0m
6 6m
7 6m 
```

这是我的代码：

```
private void laygio(string tenstore, string tenxuat)
{
    string conn = "Data Source=USER-PC;Initial Catalog=NCKHmoi;Integrated Security=True";
    SqlConnection connect = new SqlConnection(conn);
    SqlCommand command = new SqlCommand();
    command.Connection = connect;
    connect.Open();
    int stday = Convert.ToInt32(dst.Text);
    int stmonth = Convert.ToInt32(mst.Text);
    int styear = Convert.ToInt32(yst.Text);
    int sthour = Convert.ToInt32(hst.Text);
    int stminute = 0;
    int stsecond = 0;
    int eday = Convert.ToInt32(ded.Text);
    int emonth = Convert.ToInt32(med.Text);
    int eyear = Convert.ToInt32(yed.Text);
    int ehour = Convert.ToInt32(hed.Text);
    int eminute = 0;
    int esecond = 0;
    DateTime startday = new DateTime(styear, stmonth, stday, sthour, stminute, stsecond);
    DateTime endday = new DateTime(eyear, emonth, eday, ehour, eminute, esecond);
    DataTable tbl = new DataTable();
    DataColumn Col = new DataColumn("Thời gian", typeof(int));
    tbl.Columns.Add(Col);
    SqlDataAdapter adapter = new SqlDataAdapter();
    int i = 1;
    for (DateTime xday = startday; xday <= endday; xday += TimeSpan.FromHours(1))
    {
        int ngay = Convert.ToInt32(xday.Day.ToString());
        int thang = Convert.ToInt32(xday.Month.ToString());
        int nam = Convert.ToInt32(xday.Year.ToString());
        int gio = Convert.ToInt32(xday.Hour.ToString());
        command.CommandType = CommandType.Text;
        command.CommandText = @"Select SoLieuGio.LLNuoc from SoLieuGio where SoLieuGio.GioID= (select Gio.GioID from Gio where (Gio.Gio = @Gio and Gio.NgayID= (select Ngay.NgayID from Ngay where (Ngay.Ngay=@Ngay and Ngay.ThangID= (select Thang.ThangID from Thang where (Thang.Thang = @Thang and Thang.NamID=(select Nam.NamID from Nam where  (Nam.Nam = @Nam and Nam.TramID=(select Tram.TramID from Tram Where (Tram.TenTram like @TenTram and Tram.TinhID=(select Tinh.TinhID from Tinh where  (Tinh.TenTinh like @TenTinh and Tinh.KhuVucID=(select KhuVuc.KhuVucID from KhuVuc where KhuVuc.Ten=@Ten)))))))))))))";
        command.Parameters.Add("@Gio", SqlDbType.BigInt).Value = gio;
        command.Parameters.Add("@Ngay", SqlDbType.BigInt).Value = ngay;
        command.Parameters.Add("@Thang", SqlDbType.BigInt).Value = thang;
        command.Parameters.Add("@Nam", SqlDbType.BigInt).Value = nam;
        command.Parameters.Add("@Ten", SqlDbType.NVarChar, 50).Value = "Đồng Bằng Bắc Bộ";
        command.Parameters.Add("@TenTinh", SqlDbType.NVarChar, 50).Value = TinhComboBoxEx.Text;
        command.Parameters.Add("@TenTram", SqlDbType.NVarChar, 50).Value = TramComboBoxEx.Text;
        adapter.SelectCommand = command;
        adapter.Fill(tbl);
        dataGridView2.DataSource = tbl;            
        command.Parameters.Clear();
    }
    command.Dispose();
    connect.Close();
} 
```

该代码的结果是：

1 2 米 2 3 米 3 3 米 6 6 米 7 6 米

我需要修复什么才能从 1 到 7 完全显示它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T14:30:26.197

您可以使用计数表`master..spt_values`来处理系列中缺失的项目。

您可以通过左连接到您的表格并合并您的价值观来做到这一点。

例如

```
CREATE TABLE ATable
    ([Number] int, [value] varchar(2))
;

INSERT INTO ATable
    ([Number], [value])
VALUES
    (1, '2m'),
    (2, '3m'),
    (3, '3m'),
    (6, '6m'),
    (7, '6m')
; 
```

这个

```
SELECT
  v.Number,
  COALESCE(ATable.Value, '0m') Value
FROM
  master..spt_values  v
  LEFT JOIN ATable
  ON v.Number = ATable.Number
WHERE
  v.Type = 'P'
  and v.Number > 0 and v.Number < 8 
```

会产生这个值

```
| NUMBER | VALUE |
------------------
|      1 |    2m |
|      2 |    3m |
|      3 |    3m |
|      4 |    0m |
|      5 |    0m |
|      6 |    6m |
|      7 |    6m | 
```

[演示](http://sqlfiddle.com/#!6/d18bb/8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T09:08:55.107

尝试创建一个包含缺失值的临时表，然后连接主表和临时表。

这就是它的样子

```
create table #temp1
(
    ID int identity(1,1),
    M varchar(4)
)
declare @count int
SET @count = 0

declare @max int
SET @max = 20

while @count < @max
begin
insert into #temp1 (M) values ('0m') 
SET @count = @count + 1
end

select * from #temp1

select (case M1.ID when null then T1.ID else M1.ID) as ID,
(case M1.M when null then T1.M else M1.ID) as TXT
from MainTable M1
join #temp1 T1
order by ID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T06:38:21.653

在这种情况下，我认为最简单的方法是每次检查当前值是否是前一个值 + 1 的总和

```
if (current != (previous + 1)
{
    //make new 4 0m or something
}
else
{
    //continue reading
} 
```

# php - PHP：将 DB 链接标识符传递给 array_map 的内部函数

> ID：16051359
> 
> 赞同：1
> 
> 时间：2013-04-17T04:14:49.927
> 
> 标签：php

根据我之前的[问题](https://stackoverflow.com/a/16034581/188331)的回答，我必须使用内部函数`array_map()`如下：

```
 $keyword_tokens = array_map(
        function($keyword) {
            return $this->db->escape_string(trim($keyword));
        }, $keyword_tokens
    ); 
```

`$this->db`是 MySQLi 数据库包装器，而它的功能`escape_string()`是`mysqli_real_escape_string()`.

问题是，PHP提示错误：

> **致命错误：**不在对象上下文中使用 $this

但是，`array_map`代码片段位于类的公共函数中。我的问题是：如何`$this->db`在`array_map()`'s 内部函数中引用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:25:01.233

使用`use`关键字将变量包含在闭包的范围内，但`$this`如果您使用的是 5.4 之前的 PHP 版本，则必须使用不同的变量。或许这...

```
$db = $this->db;
$keyword_tokens = array_map(
    function($keyword) use ($db) {
        return $db->escape_string(trim($keyword));
    }, $keyword_tokens
); 
```

# javascript - 选中或取消选中复选框时执行操作

> ID：16051360
> 
> 赞同：0
> 
> 时间：2013-04-17T04:14:52.173
> 
> 标签：javascript, ajax, checkbox, dom-events

我正在用html制作一个表单，表单的一个元素是复选框询问用户他是否有电话号码，我正在尝试执行两个操作：如果选中了复选框，我希望一个新的输入元素出现在同一个页面让用户输入他的电话号码，如果用户改变主意并尝试取消选中复选框，则删除最后一个输入并显示另一个输入以获取其他信息。当复选框被选中并且输入似乎让用户输入他的号码时，它适用于我，但如果用户改变主意或错误地选中了此复选框并取消选中它，数字的输入仍在页面中，我表示复选框中的取消选中事件在被选中后不起作用！任何帮助请...

```
<html>
<head><script>
function change(n){
if (n.checked)
document.getElementById("message").innerHTML = "enter your number <input type="text" ....";
if (n.unchecked)
document.getElementById("message").innerHTML = "age <input type="text" ....";
}
</script>
</head>
<body><label><input type = "checkbox" onchange = "change(this)">Checkbox</label>
<div id="message"></div>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:20:10.450

你只需要一个`if..else`值`this.checked`。所以像这样的东西 -

```
document.querySelector('input[type="checkbox"]').addEventListener('change', function () {
    if (this.checked) {
        document.getElementById("message").innerHTML = 'enter your number <input type="text">';
    }
    else {
        document.getElementById("message").innerHTML = 'age <input type="text">';
    }
}, false); 
```

**[工作演示](http://cssdeck.com/labs/cfwcf4o3)**

# r - 如何绘制堆积比例图？

> ID：16051363
> 
> 赞同：2
> 
> 时间：2013-04-17T04:15:08.053
> 
> 标签：r, plot, ggplot2, dataframe, stacked

我有一个数据框：

```
x <- data.frame(id=letters[1:3],val0=1:3,val1=4:6,val2=7:9)
  id val0 val1 val2
1  a    1    4    7
2  b    2    5    8
3  c    3    6    9 
```

我想绘制一个显示每列百分比的堆积条形图。因此，每个条形代表一行，每个条形都有长度，但有三种不同的颜色，每种颜色代表 val0、val1 和 val2 的百分比。

我试着寻找它，我得到的只是绘制堆叠图而不是堆叠比例图的方法。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T04:31:07.370

## 使用 ggplot2

对于`ggplot2`和`geom_bar`

1.  以长格式工作
2.  预先计算百分比

例如

```
library(reshape2)
library(plyr)
# long format with column of proportions within each id
xlong <- ddply(melt(x, id.vars = 'id'), .(id), mutate, prop = value / sum(value))

ggplot(xlong, aes(x = id, y = prop, fill = variable)) + geom_bar(stat = 'identity') 
```

![在此处输入图像描述](https://i.stack.imgur.com/t0Vsl.png)

```
 # note position = 'fill' would work with the value column
 ggplot(xlong, aes(x = id, y = value, fill = variable)) +
       geom_bar(stat = 'identity', position = 'fill', aes(fill = variable)) 
```

## # 将返回与上面相同的图

## 碱基R

表格对象可以绘制为马赛克图。使用`plot`. 你`x`是（几乎）一个表格对象

```
# get the numeric columns as a matrix
xt <- as.matrix(x[,2:4])
# set the rownames to be the first column of x
rownames(xt) <- x[[1]]
# set the class to be a table so plot will call plot.table
class(xt) <- 'table'
plot(xt) 
```

![在此处输入图像描述](https://i.stack.imgur.com/otUul.png)

你也可以`mosaicplot`直接使用

```
mosaicplot(x[,2:4], main = 'Proportions') 
```

# c - 位向量和浮点向量的快速点积

> ID：16051365
> 
> 赞同：19
> 
> 时间：2013-04-17T04:15:44.413
> 
> 标签：c, optimization, assembly, x86-64, sse

我试图在 i7 上以最有效的方式计算浮点向量和位向量之间的点积。实际上，我在 128 或 256 维向量上执行此操作，但为了说明，让我编写 64 维的代码来说明问题：

```
// a has 64 elements. b is a bitvector of 64 dimensions.
float dot(float *restrict a, uint64_t b) {
    float sum = 0;
    for(int i=0; b && i<64; i++, b>>=1) {
        if (b & 1) sum += a[i];
    }
    return sum;
} 
```

这当然可行，但问题是，这是整个程序的时间关键点（占用 50 分钟运行的 95% 的 CPU 时间），所以我迫切需要让它更快。

我的猜测是上面的分支是游戏杀手（防止乱序执行，导致错误的分支预测）。我不确定向量指令是否可以在这里使用并有所帮助。将 gcc 4.8 与 -std=c99 -march=native -mtune=native -Ofast -funroll-loops 一起使用，我目前正在得到这个输出

```
 movl    $4660, %edx
    movl    $5, %ecx
    xorps   %xmm0, %xmm0
    .p2align 4,,10
    .p2align 3
.L4:
    testb   $1, %cl
    je  .L2
    addss   (%rdx), %xmm0
.L2:
    leaq    4(%rdx), %rax
    shrq    %rcx
    testb   $1, %cl
    je  .L8
    addss   4(%rdx), %xmm0
.L8:
    shrq    %rcx
    testb   $1, %cl
    je  .L9
    addss   4(%rax), %xmm0
.L9:
    shrq    %rcx
    testb   $1, %cl
    je  .L10
    addss   8(%rax), %xmm0
.L10:
    shrq    %rcx
    testb   $1, %cl
    je  .L11
    addss   12(%rax), %xmm0
.L11:
    shrq    %rcx
    testb   $1, %cl
    je  .L12
    addss   16(%rax), %xmm0
.L12:
    shrq    %rcx
    testb   $1, %cl
    je  .L13
    addss   20(%rax), %xmm0
.L13:
    shrq    %rcx
    testb   $1, %cl
    je  .L14
    addss   24(%rax), %xmm0
.L14:
    leaq    28(%rax), %rdx
    shrq    %rcx
    cmpq    $4916, %rdx
    jne .L4
    ret 
```

**编辑**可以排列数据（只要所有参数的排列相同），顺序无关紧要。

我想知道是否有一些东西可以以 Chris Dodd 的 SSE2 代码的 3 倍以上的速度运行。

新说明：AVX/AVX2 代码也欢迎使用！

**编辑 2** 给定一个位向量，我必须将它与 128 个（或 256，如果它是 256 位）不同的浮点向量相乘（因此一次也可以涉及多个浮点向量）。这是整个过程。任何可以加快整个过程的东西也是受欢迎的！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-17T06:50:16.620

最好的办法是使用一次对 4 个浮点数进行操作的 SSE ps 指令。您可以利用 float 0.0 全为 0 位这一事实来使用 andps 指令来屏蔽不需要的元素：

```
#include <stdint.h>
#include <xmmintrin.h>

union {
    uint32_t i[4];
    __m128   xmm;
} mask[16] = {
 {  0,  0,  0,  0 },
 { ~0,  0,  0,  0 },
 {  0, ~0,  0,  0 },
 { ~0, ~0,  0,  0 },
 {  0,  0, ~0,  0 },
 { ~0,  0, ~0,  0 },
 {  0, ~0, ~0,  0 },
 { ~0, ~0, ~0,  0 },
 {  0,  0,  0, ~0 },
 { ~0,  0,  0, ~0 },
 {  0, ~0,  0, ~0 },
 { ~0, ~0,  0, ~0 },
 {  0,  0, ~0, ~0 },
 { ~0,  0, ~0, ~0 },
 {  0, ~0, ~0, ~0 },
 { ~0, ~0, ~0, ~0 },
};

float dot(__m128 *a, uint64_t b) {
    __m128 sum = { 0.0 };
    for (int i = 0; i < 16; i++, b>>=4)
        sum += _mm_and_ps(a[i], mask[b&0xf].xmm);
    return sum[0] + sum[1] + sum[2] + sum[3];
} 
```

如果您希望掩码中有很多 0，那么短循环 0 可能会更快：

```
for (int i = 0; b; i++, b >>= 4)
    if (b & 0xf)
        sum += _mm_and_ps(a[i], mask[b&0xf].xmm); 
```

但如果 b 是随机的，这会更慢。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-12T06:43:34.153

为了扩展 Aki Suihkonen 的答案，重塑位串有助于有条件地移动浮点数。在下面的解决方案中，使用 SSE 指令 PMOVMASKB 和 PSHUFB 的两级位置换，加上指令 BLENDVPS 已用于在 Core 2 Duo 2.26GHz 上实现 1.25 个元素处理/周期，这是我参考速度的 20 倍C 代码。

[编辑：添加了 AVX2 实现。性能未知，因为我自己无法测试，但预计速度会提高一倍。]

这是我的实现和测试平台，解释如下。

# SSE4.1（旧，AVX2 见下文）

## 代码

```
/* Includes */
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <smmintrin.h>  /* SSE 4.1 */
#include <time.h>

/* Defines */
#define ALIGNTO(n) __attribute__((aligned(n)))
#define USE_PINSRW 1
#define NUM_ITERS  2260000

/**
 * Bit mask shuffle.
 * 
 * This version uses a loop to store eight u16 and reloads them as one __m128i.
 */

__m128 bitMaskShuffleStoreAndReload(__m128i mask){
    const __m128i perm    ALIGNTO(16) = _mm_set_epi8(15, 7, 14, 6, 13, 5, 12, 4,
                                                     11, 3, 10, 2, 9,  1, 8,  0);
    int i;
    uint16_t interMask[8] ALIGNTO(16);

    /* Shuffle bitmask */
        /* Stage 1 */
    for(i=7;i>=0;i--){
        interMask[i] = _mm_movemask_epi8(mask);
        mask = _mm_slli_epi32(mask, 1);
    }

        /* Stage 2 */
    return _mm_castsi128_ps(
                    _mm_shuffle_epi8(
                        _mm_load_si128((const __m128i*)interMask),
                        perm)
                );
}

/**
 * Bit mask shuffle.
 * 
 * This version uses the PINSTRW instruction.
 */

__m128 bitMaskShufflePINSRW(__m128i mask){
    const __m128i perm    ALIGNTO(16) = _mm_set_epi8(15, 7, 14, 6, 13, 5, 12, 4,
                                                     11, 3, 10, 2, 9,  1, 8,  0);
    __m128i  imask ALIGNTO(16);

    /* Shuffle bitmask */
        /* Stage 1 */
    imask = _mm_insert_epi16(imask, _mm_movemask_epi8(mask), 7);
    mask = _mm_slli_epi16(mask, 1);
    imask = _mm_insert_epi16(imask, _mm_movemask_epi8(mask), 6);
    mask = _mm_slli_epi16(mask, 1);
    imask = _mm_insert_epi16(imask, _mm_movemask_epi8(mask), 5);
    mask = _mm_slli_epi16(mask, 1);
    imask = _mm_insert_epi16(imask, _mm_movemask_epi8(mask), 4);
    mask = _mm_slli_epi16(mask, 1);
    imask = _mm_insert_epi16(imask, _mm_movemask_epi8(mask), 3);
    mask = _mm_slli_epi16(mask, 1);
    imask = _mm_insert_epi16(imask, _mm_movemask_epi8(mask), 2);
    mask = _mm_slli_epi16(mask, 1);
    imask = _mm_insert_epi16(imask, _mm_movemask_epi8(mask), 1);
    mask = _mm_slli_epi16(mask, 1);
    imask = _mm_insert_epi16(imask, _mm_movemask_epi8(mask), 0);

        /* Stage 2 */
    return _mm_castsi128_ps(
                    _mm_shuffle_epi8(
                        imask,
                        perm)
                );
}

/**
 * SSE 4.1 implementation.
 */

float dotSSE41(__m128 f[32], unsigned char maskArg[16]){
    int i, j, k;
    __m128i  mask      ALIGNTO(16) = _mm_load_si128((const __m128i*)maskArg);
    __m128   shufdMask ALIGNTO(16);
    __m128   zblended  ALIGNTO(16);
    __m128   sums      ALIGNTO(16) = _mm_setzero_ps();
    float    sumsf[4]  ALIGNTO(16);

    /* Shuffle bitmask */
#if USE_PINSRW
    shufdMask = bitMaskShufflePINSRW(mask);
#else
    shufdMask = bitMaskShuffleStoreAndReload(mask);
#endif

    /* Dot product */
    for(i=1;i>=0;i--){
        for(j=1;j>=0;j--){
            for(k=7;k>=0;k--){
                zblended  = _mm_setzero_ps();
                zblended  = _mm_blendv_ps(zblended, f[i*16+j+k*2], shufdMask);
                sums      = _mm_add_ps(sums, zblended);
                shufdMask = _mm_castsi128_ps(_mm_slli_epi32(_mm_castps_si128(shufdMask), 1));
            }
        }
    }

    /* Final Summation */
    _mm_store_ps(sumsf, sums);
    return sumsf[0] + sumsf[1] + sumsf[2] + sumsf[3];
}

/**
 * Reference C implementation
 */

float dotRefC(float f[128], unsigned char mask[16]){
    float sum = 0.0;
    int i;

    for(i=0;i<128;i++){
        sum += ((mask[i>>3]>>(i&7))&1) ? f[i] : 0.0;
    }

    return sum;
}

/**
 * Main
 */

int main(void){
    /* Variables */
        /* Loop Counter */
    int           i;

        /* Data to process */
    float         data[128] ALIGNTO(16);
    unsigned char mask[16]  ALIGNTO(16);
    float         refCSum, sseSum;

        /* Time tracking */
    clock_t       t1, t2, t3;
    double        refCTime, sseTime;

    /* Initialize mask and float arrays with some random data. */
    for(i=0;i<128;i++){
        if(i<16)
            mask[i]=rand();

        data[i] = random();
    }

    /* RUN TESTS */
    t1 = clock();
    for(i=0;i<NUM_ITERS;i++){
        refCSum = dotRefC(data, mask);
    }
    t2 = clock();
    for(i=0;i<NUM_ITERS;i++){
        sseSum  = dotSSE41((__m128*)data, mask);
    }
    t3 = clock();

    /* Compute time taken */
    refCTime = (double)(t2-t1)/CLOCKS_PER_SEC;
    sseTime  = (double)(t3-t2)/CLOCKS_PER_SEC;

    /* Print out results */
    printf("Results:\n"
           "RefC: Time: %f    Value: %f\n"
           "SSE:  Time: %f    Value: %f\n",
           refCTime, refCSum,
           sseTime,  sseSum);

    return 0;
} 
```

## 解释

BLENDVPS 使用 128 位寄存器 XMM0 的所有四个 32 位通道中的最高位来确定是否将其源操作数的相应通道中的值移动到其目标操作数中。使用 MOVAPS 加载数据时，会获得 4 个连续的浮点数：例如，第 8、第 9、第 10 和第 11 个浮点数。当然，它们的选择或取消选择必须由相应的位组控制：例如，位串中的第 8、第 9、第 10 和第 11 位。

问题是，当第一次加载掩码时，这些集合的位彼此相邻（在第 8、第 9、第 10 和第 11 位），而实际上它们应该相隔 32 位；请记住，在某些时候，它们必须占据每个通道的第 31 位位置（XMM0 寄存器中的第 31、63、95 和 127 位）。

理想情况下会发生位转置，将位 0、4、8、12、... 放入通道 0，位 1、5、9、13，...放入通道 1，位 2、6、10、14 , ... 在通道 2 和位 3, 7, 11, 15, ... 在通道 3。因此，以前连续的所有 4 位集合现在都间隔 32 位，四个 32 位通道中的每一个通道中都有一个。然后它所需要的只是一个循环 32 次，每次将一组新的 4 位转移到每个通道的最高位位置。

不幸的是，x86 不具备良好的位操作指令，因此由于缺乏一种干净的方式来进行完美的转置，因此这里是一种合理的折衷方案。

在掩码中，128 位

```
 0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
 16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31
 32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47
 48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63
 64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79
 80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95
 96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111
112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 
```

被置换，由八个 PMOVMASKB 和八个 PSLLW 指令，首先到

```
 0   8  16  24  32  40  48  56  64  72  80  88  96 104 112 120
  1   9  17  25  33  41  49  57  65  73  81  89  97 105 113 121
  2  10  18  26  34  42  50  58  66  74  82  90  98 106 114 122
  3  11  19  27  35  43  51  59  67  75  83  91  99 107 115 123
  4  12  20  28  36  44  52  60  68  76  84  92 100 108 116 124
  5  13  21  29  37  45  53  61  69  77  85  93 101 109 117 125
  6  14  22  30  38  46  54  62  70  78  86  94 102 110 118 126
  7  15  23  31  39  47  55  63  71  79  87  95 103 111 119 127 
```

并通过一条 PSHUFB 指令

```
 0   8  16  24  32  40  48  56   4  12  20  28  36  44  52  60
 64  72  80  88  96 104 112 120  68  76  84  92 100 108 116 124
  1   9  17  25  33  41  49  57   5  13  21  29  37  45  53  61
 65  73  81  89  97 105 113 121  69  77  85  93 101 109 117 125
  2  10  18  26  34  42  50  58   6  14  22  30  38  46  54  62
 66  74  82  90  98 106 114 122  70  78  86  94 102 110 118 126
  3  11  19  27  35  43  51  59   7  15  23  31  39  47  55  63
 67  75  83  91  99 107 115 123  71  79  87  95 103 111 119 127 
```

. 我们现在迭代四个“运行”，每个“运行”包含八组四位，以 32 位的间隔分布（如我们所愿），使用这些组作为 BLENDVPS 的掩码控制。bit shuffle 固有的笨拙导致在 中看起来笨拙的三重嵌套循环`dotSSE41()`，但是

```
clang -Ofast -ftree-vectorize -finline-functions -funroll-loops -msse4.1 -mssse3 dot.c -o dottest 
```

无论如何，循环都是展开的。内循环迭代由 16 次重复组成

```
blendvps    0x90(%rsi),%xmm1
addps       %xmm4,%xmm1
pslld       $0x1,%xmm2
movdqa      %xmm2,%xmm0
xorps       %xmm4,%xmm4 
```

.

顺便说一句，我无法确定我的两个 shuffle 版本中哪个最快，所以我在回答中给出了这两种实现。

# AVX2（新，但未经测试）

## 代码

```
/* Includes */
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <immintrin.h>  /* AVX2 */
#include <time.h>

/* Defines */
#define ALIGNTO(n) __attribute__((aligned(n)))
#define NUM_ITERS  2260000

/**
 * Bit mask shuffle.
 * 
 * This version uses the PINSTRW instruction.
 */

__m256 bitMaskShufflePINSRW(__m256i mask){
    __m256i  imask ALIGNTO(32);

    /* Shuffle bitmask */
    imask = _mm256_insert_epi32(imask, _mm256_movemask_epi8(mask), 7);
    mask = _mm256_slli_epi32(mask, 1);
    imask = _mm256_insert_epi32(imask, _mm256_movemask_epi8(mask), 6);
    mask = _mm256_slli_epi32(mask, 1);
    imask = _mm256_insert_epi32(imask, _mm256_movemask_epi8(mask), 5);
    mask = _mm256_slli_epi32(mask, 1);
    imask = _mm256_insert_epi32(imask, _mm256_movemask_epi8(mask), 4);
    mask = _mm256_slli_epi32(mask, 1);
    imask = _mm256_insert_epi32(imask, _mm256_movemask_epi8(mask), 3);
    mask = _mm256_slli_epi32(mask, 1);
    imask = _mm256_insert_epi32(imask, _mm256_movemask_epi8(mask), 2);
    mask = _mm256_slli_epi32(mask, 1);
    imask = _mm256_insert_epi32(imask, _mm256_movemask_epi8(mask), 1);
    mask = _mm256_slli_epi32(mask, 1);
    imask = _mm256_insert_epi32(imask, _mm256_movemask_epi8(mask), 0);

    /* Return bitmask */
    return _mm256_castsi256_ps(imask);
}

/**
 * AVX2 implementation.
 */

float dotAVX2(__m256 f[16], unsigned char maskArg[16]){
    int i, j, k;
    /* Use _mm_loadu_si128 */
    __m256i  mask      ALIGNTO(32) = _mm256_castsi128_si256(_mm_load_si128((const __m128i*)maskArg));
    __m256   shufdMask ALIGNTO(32);
    __m256   zblended  ALIGNTO(32);
    __m256   sums      ALIGNTO(32) = _mm256_setzero_ps();
    float    sumsf[8]  ALIGNTO(32);

    /* Shuffle bitmask */
    shufdMask = bitMaskShufflePINSRW(mask);
    shufdMask = _mm256_castsi256_ps(_mm256_slli_epi32(_mm256_castps_si256(shufdMask), 16));

    /* Dot product */
    for(i=15;i>=0;i--){
        zblended  = _mm256_setzero_ps();
        /* Replace f[i] with _mm256_loadu_ps((float*)&f[i]) */
        zblended  = _mm256_blendv_ps(zblended, f[i], shufdMask);
        sums      = _mm256_add_ps(sums, zblended);
        shufdMask = _mm256_castsi256_ps(_mm256_slli_epi32(_mm256_castps_si256(shufdMask), 1));
    }

    /* Final Summation */
    _mm256_store_ps(sumsf, sums);
    return sumsf[0] + sumsf[1] + sumsf[2] + sumsf[3] + sumsf[4] + sumsf[5] + sumsf[6] + sumsf[7];
}

/**
 * Reference C implementation
 */

float dotRefC(float f[128], unsigned char mask[16]){
    float sum = 0.0;
    int i;

    for(i=0;i<128;i++){
        sum += ((mask[i>>3]>>(i&7))&1) ? f[i] : 0.0;
    }

    return sum;
}

/**
 * Main
 */

int main(void){
    /* Variables */
        /* Loop Counter */
    int           i;

        /* Data to process */
    float         data[128] ALIGNTO(32);
    unsigned char mask[16]  ALIGNTO(32);
    float         refCSum, sseSum;

        /* Time tracking */
    clock_t       t1, t2, t3;
    double        refCTime, sseTime;

    /* Initialize mask and float arrays with some random data. */
    for(i=0;i<128;i++){
        if(i<16)
            mask[i]=rand();

        data[i] = random();
    }

    /* RUN TESTS */
    t1 = clock();
    for(i=0;i<NUM_ITERS;i++){
        refCSum = dotRefC(data, mask);
    }
    t2 = clock();
    for(i=0;i<NUM_ITERS;i++){
        sseSum  = dotAVX2((__m256*)data, mask);
    }
    t3 = clock();

    /* Compute time taken */
    refCTime = (double)(t2-t1)/CLOCKS_PER_SEC;
    sseTime  = (double)(t3-t2)/CLOCKS_PER_SEC;

    /* Print out results */
    printf("Results:\n"
           "RefC: Time: %f    Value: %f\n"
           "SSE:  Time: %f    Value: %f\n",
           refCTime, refCSum,
           sseTime,  sseSum);

    return 0;
} 
```

## 解释

使用与 SSE4.1 相同的概念。不同之处在于，现在我们一次处理 8 个浮点数，并使用 AVX2 的 256 位寄存器和 ymm 寄存器中的 PMOVMASKB（收集 256/8 = 32 位）。正因为如此，我们现在有了一个更简单的位掩码洗牌和一个更简单的循环。

在掩码中，256 位

```
 0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
 16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31
 32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47
 48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63
 64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79
 80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95
 96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111
112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127
128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159
160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175
176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191
192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207
208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223
224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239
240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 
```

使用 8 个 PMOVMASKB 和 8 个 PSLLW 指令进行置换，以

```
 0   8  16  24  32  40  48  56  64  72  80  88  96 104 112 120
128 136 144 152 160 168 176 184 192 200 208 216 224 232 240 248
  1   9  17  25  33  41  49  57  65  73  81  89  97 105 113 121
129 137 145 153 161 169 177 185 193 201 209 217 225 233 241 249
  2  10  18  26  34  42  50  58  66  74  82  90  98 106 114 122
130 138 146 154 162 170 178 186 194 202 210 218 226 234 242 250
  3  11  19  27  35  43  51  59  67  75  83  91  99 107 115 123
131 139 147 155 163 171 179 187 195 203 211 219 227 235 243 251
  4  12  20  28  36  44  52  60  68  76  84  92 100 108 116 124
132 140 148 156 164 172 180 188 196 204 212 220 228 236 244 252
  5  13  21  29  37  45  53  61  69  77  85  93 101 109 117 125
133 141 149 157 165 173 181 189 197 205 213 221 229 237 245 253
  6  14  22  30  38  46  54  62  70  78  86  94 102 110 118 126
134 142 150 158 166 174 182 190 198 206 214 222 230 238 246 254
  7  15  23  31  39  47  55  63  71  79  87  95 103 111 119 127
135 143 151 159 167 175 183 191 199 207 215 223 231 239 247 255 
```

. 对于 128 个元素的位与浮点点积，我们然后在八组 16 个元素上并行迭代。通过迭代 32 个元素的集合，可以轻松地将这个实现扩展到 256 个元素的 DP。现在只需要一个循环。

具体来说，要将其更改为适用于 256 元素点积，您将

*   将函数参数的大小加倍。`__m256 f[32], unsigned char maskArg[32]`.
*   将掩码负载 ( `= _mm256_castsi128_si256(_mm_load_si128((const __m128i*)maskArg));`) 与交换`= _mm256_load_si256((const __m256i*)maskArg);`。
*   在调用 的下方将补偿移位向左删除 16 `bitMaskShufflePINSRW`。
*   从第 31 组而不是第 15 组向下运行循环：`for(i=31;i>=0;i--)`

**由于我的 CPU 是 SSE4.1，我既不能测试也不能运行代码**，但是 Clang 与

```
clang -Ofast -ftree-vectorize -finline-functions -funroll-loops -mavx2 -msse4.1 -mssse3 dotavx2.c -o dottest 
```

干净地编译（您可能会获得更快的代码而无需展开），产生：

```
(gdb) disas dotAVX2
Dump of assembler code for function dotAVX2:
0x0000000100001730 <+0>:    push   %rbp
0x0000000100001731 <+1>:    mov    %rsp,%rbp
0x0000000100001734 <+4>:    vmovdqa (%rsi),%xmm0
0x0000000100001738 <+8>:    vpslld $0x1,%ymm0,%ymm1
0x000000010000173d <+13>:   vpslld $0x1,%ymm1,%ymm2
0x0000000100001742 <+18>:   vpmovmskb %ymm2,%eax
0x0000000100001746 <+22>:   vpslld $0x1,%ymm2,%ymm2
0x000000010000174b <+27>:   vpmovmskb %ymm2,%ecx
0x000000010000174f <+31>:   vxorps %ymm3,%ymm3,%ymm3
0x0000000100001753 <+35>:   vmovd  %ecx,%xmm4
0x0000000100001757 <+39>:   vpinsrd $0x1,%eax,%xmm4,%xmm4
0x000000010000175d <+45>:   vpmovmskb %ymm1,%eax
0x0000000100001761 <+49>:   vpinsrd $0x2,%eax,%xmm4,%xmm1
0x0000000100001767 <+55>:   vpslld $0x1,%ymm2,%ymm2
0x000000010000176c <+60>:   vpslld $0x1,%ymm2,%ymm4
0x0000000100001771 <+65>:   vpslld $0x1,%ymm4,%ymm5
0x0000000100001776 <+70>:   vpmovmskb %ymm0,%eax
0x000000010000177a <+74>:   vpinsrd $0x3,%eax,%xmm1,%xmm0
0x0000000100001780 <+80>:   vpmovmskb %ymm5,%eax
0x0000000100001784 <+84>:   vpslld $0x1,%ymm5,%ymm1
0x0000000100001789 <+89>:   vpmovmskb %ymm1,%ecx
0x000000010000178d <+93>:   vmovd  %ecx,%xmm1
0x0000000100001791 <+97>:   vpinsrd $0x1,%eax,%xmm1,%xmm1
0x0000000100001797 <+103>:  vpmovmskb %ymm4,%eax
0x000000010000179b <+107>:  vpinsrd $0x2,%eax,%xmm1,%xmm1
0x00000001000017a1 <+113>:  vpmovmskb %ymm2,%eax
0x00000001000017a5 <+117>:  vpinsrd $0x3,%eax,%xmm1,%xmm1
0x00000001000017ab <+123>:  vinserti128 $0x1,%xmm0,%ymm1,%ymm0
0x00000001000017b1 <+129>:  vpslld $0x10,%ymm0,%ymm0
0x00000001000017b6 <+134>:  vblendvps %ymm0,0x1e0(%rdi),%ymm3,%ymm1
0x00000001000017c0 <+144>:  vpslld $0x1,%ymm0,%ymm0
0x00000001000017c5 <+149>:  vblendvps %ymm0,0x1c0(%rdi),%ymm3,%ymm2
0x00000001000017cf <+159>:  vaddps %ymm2,%ymm1,%ymm1
0x00000001000017d3 <+163>:  vpslld $0x1,%ymm0,%ymm0
0x00000001000017d8 <+168>:  vblendvps %ymm0,0x1a0(%rdi),%ymm3,%ymm2
0x00000001000017e2 <+178>:  vaddps %ymm2,%ymm1,%ymm1
0x00000001000017e6 <+182>:  vpslld $0x1,%ymm0,%ymm0
0x00000001000017eb <+187>:  vblendvps %ymm0,0x180(%rdi),%ymm3,%ymm2
0x00000001000017f5 <+197>:  vaddps %ymm2,%ymm1,%ymm1
0x00000001000017f9 <+201>:  vpslld $0x1,%ymm0,%ymm0
0x00000001000017fe <+206>:  vblendvps %ymm0,0x160(%rdi),%ymm3,%ymm2
0x0000000100001808 <+216>:  vaddps %ymm2,%ymm1,%ymm1
0x000000010000180c <+220>:  vpslld $0x1,%ymm0,%ymm0
0x0000000100001811 <+225>:  vblendvps %ymm0,0x140(%rdi),%ymm3,%ymm2
0x000000010000181b <+235>:  vaddps %ymm2,%ymm1,%ymm1
0x000000010000181f <+239>:  vpslld $0x1,%ymm0,%ymm0
0x0000000100001824 <+244>:  vblendvps %ymm0,0x120(%rdi),%ymm3,%ymm2
0x000000010000182e <+254>:  vaddps %ymm2,%ymm1,%ymm1
0x0000000100001832 <+258>:  vpslld $0x1,%ymm0,%ymm0
0x0000000100001837 <+263>:  vblendvps %ymm0,0x100(%rdi),%ymm3,%ymm2
0x0000000100001841 <+273>:  vaddps %ymm2,%ymm1,%ymm1
0x0000000100001845 <+277>:  vpslld $0x1,%ymm0,%ymm0
0x000000010000184a <+282>:  vblendvps %ymm0,0xe0(%rdi),%ymm3,%ymm2
0x0000000100001854 <+292>:  vaddps %ymm2,%ymm1,%ymm1
0x0000000100001858 <+296>:  vpslld $0x1,%ymm0,%ymm0
0x000000010000185d <+301>:  vblendvps %ymm0,0xc0(%rdi),%ymm3,%ymm2
0x0000000100001867 <+311>:  vaddps %ymm2,%ymm1,%ymm1
0x000000010000186b <+315>:  vpslld $0x1,%ymm0,%ymm0
0x0000000100001870 <+320>:  vblendvps %ymm0,0xa0(%rdi),%ymm3,%ymm2
0x000000010000187a <+330>:  vaddps %ymm2,%ymm1,%ymm1
0x000000010000187e <+334>:  vpslld $0x1,%ymm0,%ymm0
0x0000000100001883 <+339>:  vblendvps %ymm0,0x80(%rdi),%ymm3,%ymm2
0x000000010000188d <+349>:  vaddps %ymm2,%ymm1,%ymm1
0x0000000100001891 <+353>:  vpslld $0x1,%ymm0,%ymm0
0x0000000100001896 <+358>:  vblendvps %ymm0,0x60(%rdi),%ymm3,%ymm2
0x000000010000189d <+365>:  vaddps %ymm2,%ymm1,%ymm1
0x00000001000018a1 <+369>:  vpslld $0x1,%ymm0,%ymm0
0x00000001000018a6 <+374>:  vblendvps %ymm0,0x40(%rdi),%ymm3,%ymm2
0x00000001000018ad <+381>:  vaddps %ymm2,%ymm1,%ymm1
0x00000001000018b1 <+385>:  vpslld $0x1,%ymm0,%ymm0
0x00000001000018b6 <+390>:  vblendvps %ymm0,0x20(%rdi),%ymm3,%ymm2
0x00000001000018bd <+397>:  vaddps %ymm2,%ymm1,%ymm1
0x00000001000018c1 <+401>:  vpslld $0x1,%ymm0,%ymm0
0x00000001000018c6 <+406>:  vblendvps %ymm0,(%rdi),%ymm3,%ymm0
0x00000001000018cc <+412>:  vaddps %ymm0,%ymm1,%ymm0
0x00000001000018d0 <+416>:  vpshufd $0x1,%xmm0,%xmm1
0x00000001000018d5 <+421>:  vaddss %xmm1,%xmm0,%xmm1
0x00000001000018d9 <+425>:  vmovhlps %xmm0,%xmm0,%xmm2
0x00000001000018dd <+429>:  vaddss %xmm1,%xmm2,%xmm1
0x00000001000018e1 <+433>:  vpshufd $0x3,%xmm0,%xmm2
0x00000001000018e6 <+438>:  vaddss %xmm1,%xmm2,%xmm1
0x00000001000018ea <+442>:  vextracti128 $0x1,%ymm0,%xmm0
0x00000001000018f0 <+448>:  vaddss %xmm1,%xmm0,%xmm1
0x00000001000018f4 <+452>:  vpshufd $0x1,%xmm0,%xmm2
0x00000001000018f9 <+457>:  vaddss %xmm1,%xmm2,%xmm1
0x00000001000018fd <+461>:  vpshufd $0x3,%xmm0,%xmm2
0x0000000100001902 <+466>:  vmovhlps %xmm0,%xmm0,%xmm0
0x0000000100001906 <+470>:  vaddss %xmm1,%xmm0,%xmm0
0x000000010000190a <+474>:  vaddss %xmm0,%xmm2,%xmm0
0x000000010000190e <+478>:  pop    %rbp
0x000000010000190f <+479>:  vzeroupper 
0x0000000100001912 <+482>:  retq   
End of assembler dump. 
```

正如我们所见，内核现在是 3 条指令（vblendvps、vaddps、vpslld）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-19T13:13:45.033

如果允许在 data中进行稍微不同的排列，*或者*`float data[128]`在 的位掩码中进行相应的排列，则`__m128 mask;`可以稍微改进上面 Chris Dodd 建议的算法。（不计算置换掩码所需的时间，这个实现（+开销）大约快 25%）。当然，这只是我在评论中提供的想法的快速草稿。

```
union {
    unsigned int i[4];
    float f[4];
    __m128   xmm;
} mask = { 0xFF00FF00, 0xF0F0F0F0, 0xCCCCCCCC, 0xAAAAAAAA };

float dot2(__m128 *a, __m128 mask);
// 20M times 1.161s

float dotref(__m128 *a, unsigned int *mask) // 20M times 8.174s
{
    float z=0.0f;
    int i;
    for (i=0;i<32;i++) {
       if (mask[0] & (0x80000000U >> i)) z+= a[i][0];
       if (mask[1] & (0x80000000U >> i)) z+= a[i][1];
       if (mask[2] & (0x80000000U >> i)) z+= a[i][2];
       if (mask[3] & (0x80000000U >> i)) z+= a[i][3];       
    }
   return z;
} 
```

相应的汇编器实现将是：

```
dot2:
    // warm up stage: fill in initial data and
    // set up registers
    pxor %xmm1, %xmm1      ;; // clear partial sum1
    pxor %xmm2, %xmm2      ;; // clear partial sum2
    movaps (%rdi), %xmm3   ;; // register warm up stage1
    movaps 16(%rdi), %xmm4 ;; // next 4 values
    pxor %xmm5, %xmm5
    pxor %xmm6, %xmm6
    lea 32(%rdi), %rdi
    movl $16, %ecx            ;; // process 2x4 items per iteration (total=128)
a:  ;; // inner loop -- 2 independent data paths
    blendvps %xmm3, %xmm5
    pslld $1, %xmm0
    movaps (%rdi), %xmm3   
    blendvps %xmm4, %xmm6
    pslld $1, %xmm0
    movaps 16(%rdi), %xmm4
    addps %xmm5, %xmm1
    pxor  %xmm5, %xmm5
    addps %xmm6, %xmm2
    pxor  %xmm6, %xmm6
    lea 32(%rdi), %rdi
    loop a
 ;; // cool down stage: gather results (xmm0 = xmm1+xmm2)
 ;; // in beautiful world this stage is interleaved
 ;; // with the warm up stage of the next block
    addps %xmm2, %xmm1
    movaps  %xmm1, %xmm2
    movaps  %xmm1, %xmm0
    shufps  $85, %xmm1, %xmm2
    addss   %xmm2, %xmm0
    movaps  %xmm1, %xmm2
    unpckhps %xmm1, %xmm2
    shufps  $255, %xmm1, %xmm1
    addss   %xmm2, %xmm0
    addss   %xmm1, %xmm0
    ret 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-18T10:32:00.830

我发现为 Chris Dodd 的代码生成的程序集非常依赖于编译器。在（4.6 和 4.7）和 Intel （12.x 和 13.x）展开`clang`循环时将其变成一个循环。不过，可以通过将其转换为 map-reduce来减少依赖项（需要等待前一个），`gcc``icc``sum +=`

```
float dot(__m128 *a, uint64_t b) {
    __m128 sum[8];
    int i;

    for (i = 0; i < 8; i++) {
            sum[i] = _mm_add_ps(
                    _mm_and_ps(a[2*i], mask[b & 0xf].xmm),
                    _mm_and_ps(a[2*i+1], mask[(b & 0xf0) >> 4].xmm));
            b >>= 8;
    }
    for (i = 0; i < 4; i++) {
            sum[i] = _mm_add_ps(sum[2*i], sum[2*i+1]);
    }
    sum[0] = _mm_add_ps(sum[0], sum[1]);
    sum[2] = _mm_add_ps(sum[2], sum[3]);

    sum[0] = _mm_add_ps(sum[0], sum[2]);

    sum[0] = _mm_hadd_ps(sum[0], sum[0]);
    sum[0] = _mm_hadd_ps(sum[0], sum[0]);

    i = _mm_extract_ps(sum[0], 0);
    return *((float*)(&i));
} 
```

这创建了明显*较差*的程序集 with `clang`（将 存储`sum[]`在堆栈上）但*更好*的代码（不依赖于后续`addps`） with`gcc`和`icc`。有趣的是，`gcc`最后只得到了可以原位返回较低`float`值`sum[0]`的想法......

关于如何调整特定编译器的很好的练习......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-17T04:39:52.403

这里有一些可以尝试的东西。

尝试让编译器使用`CMOV`而不是分支。（[请注意，以这种方式使用联合在 C11 中定义良好，但在 C++11 中未定义。](https://stackoverflow.com/a/11996970/77567)）

```
union {
    int i;
    float f;
} u;
u.i = 0;
if (b & 1) {
    u.f = a[i];
}
sum += u.f; 
```

使用乘法而不是分支。

```
sum += (b & 1) * a[i]; 
```

保留几个总和并在最后添加它们以减少数据流依赖性。（您可以将上述任一建议与此建议结合使用。）

```
float sum0 = 0, sum1 = 0, sum2 = 0, sum3 = 0;
for (int i = 0; i < 64; i += 4; b >>= 4) {
    if (b & 1) sum0 += a[i];
    if (b & 2) sum1 += a[i+1];
    if (b & 4) sum2 += a[i+2];
    if (b & 8) sum3 += a[i+3];
}
return sum0 + sum1 + sum2 + sum3; 
```

通过一次处理几个位来减少分支的数量：

```
for (int i = 0; i < 64; i += 4, b >>= 4) {
    switch (b & 0xf) {
        case 0:
            break;
        case 1:
            sum += a[i];
            break;
        case 2:
            sum += a[i + 1];
            break;
        case 3:
            sum += a[i] + a[i+1];
            break;
        case 4:
            sum += a[i+2];
            break;
        // etc. for cases up to and including 15
    }
} 
```

您可以保留多个总和*，并*为每个总和一次处理几个位。在这种情况下，您可能希望使用宏或内联函数并调用它四次。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-11T05:24:12.453

如果你有 i7，那么你有 SSE4.1，你可以使用`_mm_dp_ps`内在函数，它做一个点积。使用您的示例代码，它看起来像

```
#include <stdint.h>
#include <immintrin.h>

const float fltmask[][4] =
  {{0, 0, 0, 0}, {0, 0, 0, 1}, {0, 0, 1, 0}, {0, 0, 1, 1},
   {0, 1, 0, 0}, {0, 1, 0, 1}, {0, 1, 1, 0}, {0, 1, 1, 1},
   {1, 0, 0, 0}, {1, 0, 0, 1}, {1, 0, 1, 0}, {1, 0, 1, 1},
   {1, 1, 0, 0}, {1, 1, 0, 1}, {1, 1, 1, 0}, {1, 1, 1, 1}};

// a has 64 elements. b is a bitvector of 64 dimensions.
float dot(float * restrict a, uint64_t b) {
     int i;
    float sum = 0;
    for(i=0; b && i<64; i+=4,b>>=4) {
        __m128 t0 = _mm_load_ps (a);
        a += 4;
        __m128 t1 = _mm_load_ps (fltmask[b & 15]);
        sum += _mm_cvtss_f32 (_mm_dp_ps (t0, t1, 15));
    }
    return sum;
} 
```

PS。数组最好是 16 字节对齐的`a`！`fltmask`

聚苯乙烯。使用`gcc -std=c99 -msse4 -O2`循环编译时如下所示：

```
.L3:
    movq    %rdx, %rax
    movaps  (%rcx), %xmm1
    shrq    $4, %rdx
    andl    $15, %eax
    addq    $16, %rcx
    addl    $4, %r8d
    salq    $4, %rax
    testq   %rdx, %rdx
    dpps    $15, (%r9,%rax), %xmm1
    addss   %xmm1, %xmm0
    jne .L13 
```

当然，随着`-O3`它的展开。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-04-03T11:58:46.367

描述这一点的另一种方式是掩蔽缩减（总和）。

**AVX512 具有内置掩蔽功能**，例如带有[`_mm256_mask_add_ps`](https://software.intel.com/sites/landingpage/IntrinsicsGuide/#techs=SSE,SSE2,SSE3,SSSE3,SSE4_1,SSE4_2,AVX,AVX2,AVX_512&expand=6150,6150,401,2424,4728,2796,131&othertechs=ADX&text=_mm256_mask_add_ps). （对于如此短的数组，您可能只想在 Skylake-AVX512 上使用 256 位向量，以避免限制最大 turbo。除非您的代码花费大量时间执行此操作或其他可以从 512 位向量中受益的循环。

从字面上看，它是来自内存源的一条 asm 指令，`vaddps`在未设置掩码寄存器中的位的地方保持元素不变。例如，您的循环体实际上可以像

```
vaddps    zmm0{k1}, zmm0, [rdi]    ; merge-masking into ZMM0
kshiftrq  k1, k1, 16               ; bring the next 16 mask bits down to the bottom 
```

（并从零掩码加载开始初始化 zmm0。实际上，您需要多个累加器来隐藏 FP-add 延迟，因此使用掩码中的低位元向量进行多个零掩码加载是理想的。）

所以你真的想要一个编译器吐出像这样的 asm 东西。（用内在函数写起来应该很简单，但更冗长，所以我只写了 asm 而不是花时间查找内在名称。）

```
 ;float dot(float *restrict a, uint64_t b)
dot:
    kmovq     k1, rsi                  ; __mmask64 m = b
    vmovups   zmm0{k1}{z}, [rdi]       ; zero-masking
    kshiftrq  k2, k1, 16
    vmovups   zmm1{k2}{z}, [rdi+ 16*4]   ; next vector of 16x 4-byte floats
    kshiftrq  k3, k1, 32
    kshiftrq  k4, k1, 48

    vaddps    zmm0{k3}, zmm0, [rdi + 16*4 * 2]   ; merge-masking into ZMM0
    vaddps    zmm1{k4}, zmm1, [rdi + 16*4 * 3]

    ;; if you have more mask data, use it and do some more adds, or maybe run 2 more dep chains of FP add before combining.

    vaddps    zmm0, zmm0, zmm1               ; reduce down to 1 accumulator

    ;then horizontal sum down to scalar
    VEXTRACTF64x4   ymm1, zmm0, 1
    vaddps          ymm0, ymm0, ymm1    ; narrow to 256
    vextractf128    xmm1, ymm0, 1
    vaddps          xmm0, xmm0, xmm1    ; narrow to 128
    vmovshdup / vaddps / vmovhlps / vaddss

    ret 
```

请参阅[在 x86 上进行水平浮点向量求和的最快方法，](https://stackoverflow.com/questions/6996764/fastest-way-to-do-horizontal-float-vector-sum-on-x86)了解如何使用内在函数在 C 中有效地编写水平求和，以便它们编译为不糟糕的 asm。（不是`haddps`，也不是一个天真的存储来数组和循环它。）

如果掩码数据来自内存，您可以将其直接加载到掩码寄存器中。不幸的是，在当前的 Skylake-AVX512 上，这需要 3 微秒，因此您想要进行 64 位加载并使用掩码移位。或者让编译器做它的事情。

* * *

**使用 AVX2**，@IWill 的答案看起来是在正确的轨道上，但我怀疑将掩码处理与掩码使用交错会更好。

例如，从浮点数组的末尾开始，并使用掩码的前 8 位。首先将掩码的前 32 位广播到 YMM 的所有元素。然后`vpsllvd`左移`[0,1,2,3,4,5,6,7]`，将掩码的最高位留在高元素的顶部，将掩码的第 8 高位留在低元素中。

`vblendvps`然后使用或更好`vmaskmovps`（Skylake 上的 uops 更少，与 Haswell 上的 blendv 相同） 从向量的高端进行屏蔽加载。`vblendvps`总是至少 2 微秒。有趣的事实：具有隐式 XMM0 源的非 VEX 版本是 Skylake 上的单微指令。

然后`vpslld`8 使接下来的 8 个掩码位到位，并将指针减 32 个字节。

您必须在每 4 个向量中停止并广播 + 可变移位新掩码位，但与 FP 添加的交错工作可能非常适合隐藏所涉及的所有内容的延迟。

看看**[英特尔 avx2 中的 movemask 指令是否有逆指令？](https://stackoverflow.com/questions/36488675/is-there-an-inverse-instruction-to-the-movemask-instruction-in-intel-avx2/36491672#36491672)**有关将位掩码转换为矢量掩码的更多详细信息，包括我上面描述的广播 + 可变移位策略。（Chris Dodd 的 LUT 适用于 4 位 -> 4 个双字，因为表很小。除此之外，您还需要 ALU。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-12T16:24:25.587

您可以像这样消除分支：

```
for(int i=0; b && i<64; i++, b>>=1)
    sum += a[i] * (b & 1); 
```

虽然这会增加额外的 mult，但至少不会破坏您的管道。

控制分支的另一种方法是按您的方式使用它，但也使用编译器宏。我猜在 gcc 中它是`likely(if ...)`宏。您将使用该分支，但这样您就告诉编译器该分支将被更频繁地执行，并且 gcc 将进行更多优化。

另一个可以做的优化是“缓存”点积。因此，您无需使用函数来计算点积，而是在开始时将变量保存为初始化为 0 的乘积。每次插入/删除/更新向量的元素时，您还将更新保存结果的变量。

# mysql - 将 MySQL 查询的输出转换为 utf8

> ID：16051369
> 
> 赞同：46
> 
> 时间：2013-04-17T04:15:52.327
> 
> 标签：mysql, sql, utf-8

我的数据库中有一个表，我想运行一个查询

```
SELECT column1, column2 FROM my_table WHERE my_condition; 
```

但我希望 mysql 返回`column2`utf8 编码。mysql中有什么功能可以完成这样的任务吗？那是什么？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2013-04-17T04:21:28.097

您可以使用 CAST 和 CONVERT 在不同类型的编码之间切换。见：[http ://dev.mysql.com/doc/refman/5.0/en/charset-convert.html](http://dev.mysql.com/doc/refman/5.0/en/charset-convert.html)

```
SELECT column1, CONVERT(column2 USING utf8)
FROM my_table 
WHERE my_condition; 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2016-12-01T14:01:04.560

```
SELECT CONVERT(CAST(column as BINARY) USING utf8) as column FROM table 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2018-01-22T07:14:35.660

添加：

使用 MySQL**客户端库**时，应防止转换回*连接的默认字符集*。（见`mysql_set_character_set()`[[1]](https://dev.mysql.com/doc/refman/5.7/en/mysql-set-character-set.html)）

在这种情况下，对二进制使用额外的强制转换：

```
SELECT column1, CAST(CONVERT(column2 USING utf8) AS binary)
FROM my_table
WHERE my_condition; 
```

否则，该`SELECT`语句将转换为 utf-8，但您的客户端库会将其转换回（可能不同的）默认连接字符集。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2021-07-15T19:41:18.047

我已将下一个代码用于 LATIN1（或您的数据库字符集）到 UTF8 问题：

```
SELECT column1,
       CONVERT(CAST(CONVERT(column2 USING LATIN1) AS BINARY) USING UTF8) AS column2
  FROM my_table
 WHERE my_condition 
```

它从 LATIN1 转换为 BINARY，然后转换为 UTF8，因为直接从 LATIN1 转换为 UTF8 可能不起作用。

# html - 百分比 (%) 宽度在不同浏览器（firefox、safari、opera、chrome）中呈现不同

> ID：16051373
> 
> 赞同：2
> 
> 时间：2013-04-17T04:16:06.517
> 
> 标签：html, css

我使用 percent(%) in`div` `width`来包装，`image`但问题是每个浏览器都会以不同的方式呈现它，任何建议都会发生这种情况。顺便说一句，`firefox`工作完美`safari`，`chrome`但`opera`不按我想要的方式工作。

如果可能的话，你能简要解释一下为什么会这样！！

先感谢您.....

下面是显示问题的图像：

![在此处输入图像描述](https://i.stack.imgur.com/s0jmG.jpg)

html:

```
<div class="banner">
      <div class="divWrap">
        <div class="imageWrap noMarginLeft"><a href="#"><img src="images/130410_Project-tile1.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile2.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile3.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile4.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile5.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile6.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile7.jpg" alt="" /></a></div>
        <div class="imageWrap noMarginLeft"><a href="#"><img src="images/130410_Project-tile8.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile9.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile10.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile11.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile12.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile13.jpg" alt="" /></a></div>
        <div class="imageWrap"><a href="#"><img src="images/130410_Project-tile14.jpg" alt="" /></a></div>
        <div class="imageWrap noMarginLeft noMarginBottom"><a href="#"><img src="images/130410_Project-tile15.jpg" alt="" /></a></div>
        <div class="imageWrap noMarginBottom"><a href="#"><img src="images/130410_Project-tile16.jpg" alt="" /></a></div>
        <div class="imageWrap noMarginBottom"><a href="#"><img src="images/130410_Project-tile17.jpg" alt="" /></a></div>
        <div class="imageWrap noMarginBottom"><a href="#"><img src="images/130410_Project-tile18.jpg" alt="" /></a></div>
        <div class="imageWrap noMarginBottom"><a href="#"><img src="images/130410_Project-tile19.jpg" alt="" /></a></div>
        <div class="imageWrap noMarginBottom"><a href="#"><img src="images/130410_Project-tile20.jpg" alt="" /></a></div>
        <div class="imageWrap noMarginBottom"><a href="#"><img src="images/130410_Project-tile21.jpg" alt="" /></a></div>
      </div>  

    </div><!-- end banner --> 
```

CSS：

```
.banner{
  float:left;
  width:100%;
}
.banner .imageWrap {
  float:left;
  width:13.772%;
  margin:0 0 0 .6%;
  background-color:#555
}

.banner .imageWrap img {
  float:left;
  max-width:100%;
  width:100%;
}

.noMarginLeft {margin-left:0 !important}
.noMarginBottom {margin-bottom:0 !important} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T07:00:16.207

浏览器以不同的方式舍入百分比宽度。

这是 2008 年的一篇文章（但今天仍然相关）：

[http://robertnyman.com/2008/01/24/how-web-browsers-handle-rounding-when-it-comes-to-values-set-in-percentage/](http://robertnyman.com/2008/01/24/how-web-browsers-handle-rounding-when-it-comes-to-values-set-in-percentage/)

# kernel - 为什么进程切换会发生模式切换？

> ID：16051376
> 
> 赞同：0
> 
> 时间：2013-04-17T04:16:35.023
> 
> 标签：kernel

`process switch`需要吗`mode switch`？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T04:19:23.817

进程切换是将一个进程换成另一个进程的行为。

这是由内核（调度程序）完成的事情，因为它是唯一应该具有该级别功能的代码。用户模式代码（在内核之外运行的东西）不应该有交换进程的能力。

因此，为了切换进程，您必须从用户模式进入内核模式。在那里，进程切换完成，然后您将从内核模式切换回用户模式以继续运行新进程。

# android - 在不使用内置方法的情况下计算 Android 中的速度和高度

> ID：16051381
> 
> 赞同：0
> 
> 时间：2013-04-17T04:16:48.803
> 
> 标签：android, performance, geolocation, location, altitude

我正在尝试在不使用`getspeed()`and`getAltitude()`方法的情况下找出 android 中的速度和高度。如果有人对此有任何参考资料或代码片段，请分享它，以便对我有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:19:14.400

速度可以通过跟踪后续更新的位置、找到它们之间的距离并除以时间差来完成。海拔 - 祝你好运，您需要我认为您无法获得的信号强度信息。你真的不想这样做。

# sql - 从数据库中检索一个字段或整个记录时花费了多少成本

> ID：16051382
> 
> 赞同：0
> 
> 时间：2013-04-17T04:17:26.537
> 
> 标签：sql, database, database-design, architecture, hardware

例如，一条记录有 20 个字段，其中包括 20 个字段中的 5 个索引字段。给定列上的正确索引已设置，并且将使用索引字段检索数据。我想讨论以下两种情况。

1.  从记录中检索字段
2.  检索整个记录

我知道的唯一区别是，在案例 1 中，系统使用的数据量很小，因此它在总线流量上的花费更少。但是在检索时间方面，我不确定这两种情况在硬件操作方面是否会有任何差异，因为我认为在数据库上检索任务的主要成本是找到记录，而不管有多少字段。这个对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T09:57:37.697

假设您正在从基于[堆的](http://use-the-index-luke.com/sql/glossary/heap-table)表中检索，并且您的 WHERE 子句在两种情况下都是相同的：

1.  被检索的字段是否在索引中很重要。如果它在索引中，则 DBMS 将不需要访问表堆 - 这称为[index-only scan](http://use-the-index-luke.com/sql/glossary/index-only-scan)。如果它不在索引中，则 DBMS 必须访问该字段所在的堆页面，如果尚未缓存，则可能需要额外的 I/O。
2.  如果您正在读取整行，则其所有字段都不太可能被 DBMS 查询计划器选择使用的索引覆盖，因此您更有可能支付表堆访问的 I/O 成本。这对于单行来说并不是那么糟糕，但如果检索到许多行并且索引的[聚类因子](http://oracle-online-help.blogspot.com/2006/11/clustering-factor_28.html)为 bad ¹ ，则绝对会破坏性能。

[对于聚簇](http://use-the-index-luke.com/sql/clustering/index-organized-clustered-index)表，情况类似但稍微复杂一些，因为即使在 CREATE INDEX 中没有明确提及，索引也倾向于覆盖 PK 字段，并且表的“主要”部分不能（通常）直接访问，而是通过索引查找.

最重要的是，正如您已经指出的那样，传输更多数据会给网络带宽带来更大压力。

由于这些原因，请始终尝试准确地选择您需要的东西，仅此而已。

* * *

*¹一个好的查询优化器会注意到这一点并执行全表扫描，因为它更便宜，即使索引可用。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T03:17:16.840

阅读了一些材料，我得出了结论：

1.  仅选择执行查询时所需的那些字段。
2.  如果只扫描索引字段，则数据库将执行仅索引搜索，速度很快。
3.  当尝试获取许多包含未索引字段的行时，最坏的情况是查询将执行与行数一样多的块 I/O，这是非常昂贵的成本。所以更好的方法是执行全表扫描，因为块 I/O 的总数等于块的总数，可能远小于行数。

# ruby - 使用 Ruby 的 Gosu 绘图程序中的高 CPU 使用率

> ID：16051390
> 
> 赞同：2
> 
> 时间：2013-04-17T04:18:10.763
> 
> 标签：ruby, drawing, cpu-usage, ruby-1.9.3, libgosu

我一直在修补使用 Ruby 在 Gosu 中制作绘图应用程序，但我遇到了一些高 CPU 使用率。我知道一个可能的原因。

首先，我只是在每次用户单击鼠标按钮时（或者如果他们按住鼠标按钮，则每次屏幕刷新时，我认为这大约每秒发生 60 次）时向哈希添加一个原语。每次屏幕重绘时，我都会让程序循环遍历哈希并重绘所有基元。如果有人按住鼠标按钮，它只会将重叠的图元保持在彼此之上，而在其他情况下，图元只是分层。我可以看到这最终会如何消耗散列中的一堆内存。

我觉得最好的解决方案是使用某种较低级别的函数，该函数只需为屏幕上的像素着色，而不必将它们存储在哈希中。我不确定Gosu是否支持。有人可以在 Gosu 中帮我解决这个问题，还是建议使用不同的方法和/或其他程序？谢谢！

（以下是我的程序的完整代码。）

```
require 'Gosu'
require 'socket'

class GameWindow < Gosu::Window
  def initialize

    super 1280, 960, false
    self.caption = "Drawz Server"

    @background_image = Gosu::Image.new(self, "media/Space.png", true)

    @player = Player.new(self)
    # Platform is the blank image for the epicycle to be drawn on.
    @earth_image = Gosu::Image.new(self, "media/earth.bmp", true)
    @cursor_image = Gosu::Image.new(self, "media/cursor.bmp", true)

    puts "Please enter port..."
    port = gets.strip!
    puts "Server is running."

    # Initialized Instance variables for all methods.
    @square_drawing_number = 0
    @client_coordinates_array = []
    @client_coordinates_array_array = []
    @client_quad_hash = {}
    server = TCPServer.open("10.64.8.2", port)
    @client = server.accept

    manage_client_data = Thread.new do
            x = 0
            loop do
                @client_coordinates_array[x] = @client.gets
                x += 1
            end
        end

    @x = 0
    @quad_hash = {}
    # Start up value of things in draw method, because draw is called before update. Hence I put the start up values here so that when draw is called it has location of things in
    # its arguments.
    @cx = 0 
    @cy = 0
  end

class QuadCoords
    attr_reader :x1, :y1, :x2, :y2, :x3, :y3, :x4, :y4

    def initialize(x1, y1, x2, y2, x3, y3, x4, y4)
        @x1 = x1
        @y1 = y1
        @x2 = x2
        @y2 = y2
        @x3 = x3
        @y3 = y3
        @x4 = x4
        @y4 = y4
    end
end

    # Mean't to change location (x and y) and such of things in draw method.

    def update
        @cx = mouse_x
        @cy = mouse_y
        @x += 1
        # Adds square locations to hash which is then accessed by draw function to retrieve and draw squares.
        if button_down? Gosu::MsLeft
            @x += 1
            quad_coords_obj = QuadCoords.new(@cx - 5, @cy - 5, @cx, @cy - 5, @cx - 5, @cy, @cx, @cy)
            @quad_hash["quad#{@x}"] = quad_coords_obj
            # Sends location of squares to client for it to draw.
            @client.puts "#{quad_coords_obj.x1}---#{quad_coords_obj.y1}---#{quad_coords_obj.x2}---#{quad_coords_obj.y2}---#{quad_coords_obj.x3}---#{quad_coords_obj.y3}---#{quad_coords_obj.x4}---#{quad_coords_obj.y4}"
        end

        if @client_coordinates_array.length > @square_drawing_number
            new_squares_to_add = @client_coordinates_array.length - @square_drawing_number
            @client_coordinates_array[-1 * new_squares_to_add..-1].each do |value|
                @client_coordinates_array_array << value.split(/\---/)
            end
            x = 1
            new_squares_to_add.times do
                @x += 1
                @client_quad_coords_obj = QuadCoords.new(@client_coordinates_array_array[-1 * x][0].to_i,
                @client_coordinates_array_array[-1 * x][1].to_i,
                @client_coordinates_array_array[-1 * x][2].to_i,
                @client_coordinates_array_array[-1 * x][3].to_i,
                @client_coordinates_array_array[-1 * x][4].to_i,
                @client_coordinates_array_array[-1 * x][5].to_i, 
                @client_coordinates_array_array[-1 * x][6].to_i, 
                @client_coordinates_array_array[-1 * x][7].to_i)
                @client_quad_hash["quad#{@x}"] = @client_quad_coords_obj
                x += 1
                @square_drawing_number += 1
            end
        end

    end

  # Draw is called before update.
  def draw

    @background_image.draw(0,0,0)
    @earth_image.draw(295,215,1)
    # x1,y1 = Upper Left Hand Corner; x2,y2 = Lower Left Hand Corner; x3,y3 = Upper Right Hand Corner; x4,y4 = Lower Right Hand Corner
    @quad_hash.each_value do |value|
        draw_quad(value.x1, value.y1, 0xff00ffff, value.x2, value.y2, 0xff00ffff, value.x3, value.y3, 0xff00ffff, value.x4, value.y4, 0xff00ffff, z = 0, mode = :default)
    end

    @client_quad_hash.each_value do |value|
        draw_quad(value.x1, value.y1, 0xff00ff00, value.x2, value.y2, 0xff00ff00, value.x3, value.y3, 0xff00ff00, value.x4, value.y4, 0xff00ff00, z = 0, mode = :default)
    end

    @cursor_image.draw(@cx, @cy, 1)

  end

  def button_down(id)
    if id == Gosu::KbEscape
      close
    end
  end
end

class Player
    attr_accessor :x, :y, :update_called
  def initialize(window)
    @image = Gosu::Image.new(window, "media/Sun.bmp", false)
  end
end

window = GameWindow.new
window.show 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:40:39.887

您可以使用 TexPlay 在 Gosu::Image 上绘图，然后渲染此图像。 [http://banisterfiend.wordpress.com/2008/08/23/texplay-an-image-manipulation-tool-for-ruby-and-gosu/](http://banisterfiend.wordpress.com/2008/08/23/texplay-an-image-manipulation-tool-for-ruby-and-gosu/) 例如：

```
image1.paint {
  circle 20,20,10, :color => :red
  rect 40,40,50,50, :color => :green
  pixel 60,60, :color => :blue
} 
```

还有其他选择：RMagick（更强大，但安装\分发更复杂）和 Ashton（它具有渲染到 OpenGL 纹理的方法，因此速度更快，但需要对 OpenGL 有一些了解）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-04T11:28:24.383

我建议使用我的 Ashton gem 直接渲染到纹理 - 与 TexPlay 或其他软件渲染不同，这是硬件加速的，所以非常快！使用 Ashton::Texture#render，您可以将绘制操作缓存到纹理中，就像将它们绘制到屏幕上一样快。

```
def initialize(...)
  # WindowBuffer is just an Ashton::Texture that is the same size as the window
  @draw_buffer = Ashton::WindowBuffer.new 
  ...
end

def update()
  @draw_buffer.render do
    # Perform new gosu drawing actions (e.g. draw_quad)
    # here to draw directly into the texture.
    # Both the local ones and the ones pulled from the network.
  end
end

def draw()
  # Since you are drawing things in the order they should appear,
  # you don't need to worry about Z values.
  @background_image.draw 0, 0, 0
  @earth_image.draw 295, 215, 0
  @draw_buffer.draw 0, 0, 0
  @cursor_image.draw @cx, @cy, 0
end 
```

另请注意，打印文本实际上很慢，因此如果在每次更新/绘制中执行，将会影响您的 FPS。

# php - if 语句基于与数据库中的一行匹配的两个变量

> ID：16051395
> 
> 赞同：1
> 
> 时间：2013-04-17T04:18:38.967
> 
> 标签：php, mysql

我在思考如何为以下 if 语句编写条件时遇到了一些麻烦。所以我有一个包含两列的数据库：ID 和用户名。我想编写一个 if else 语句，将变量 $ID 和 $Username 与数据库的行进行比较。如果匹配，我希望语句终止，如果不匹配，我希望 }else{ 其他一些代码。所以我想它会是这样的：

```
$ID = 5;
$Username = 'Butterdog';
$result = mysqli_query($con,"SELECT * FROM database");
while($row = mysqli_fetch_array($result))
{  
 if  $ID and $Username both match any row in the database { die
 }else{ do some other code }}; 
```

所以我只是在思考如何编写将两个变量与数据库中的每一行进行比较的条件时遇到了麻烦。我知道这一定是基本的，但我还没有遇到它，我的搜索结果为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:21:24.000

试试这个（假设你的数据库列名是 id 和 username

```
if  ($ID == $row['id'] && $Username == $row['username'] {
    die;
} else {
    // do something else
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T04:26:19.947

在查询中进行实际比较会更容易（也更有效）。

```
$stmt = mysqli_prepare($con, "SELECT TRUE AS row
    FROM db WHERE id = ? AND user = ? LIMIT 1");
mysqli_stmt_bind_param($stmt, "ss", $ID, $Username);
mysqli_stmt_bind_result($stmt, $found);
mysqli_stmt_execute($stmt);

if ($found) {
    exit;
}
else { /* do something else */ } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T04:39:28.257

```
if  ($ID == $row['id'] && $Username === $row['username'] {
    die("found row");
} else {
    // do something else
} 
```

比较字符串时要小心，因为 == 会产生意想不到的结果，有时甚至是字符串。'a string' == 0 也计算为 true，因为任何字符串在与整数比较时都会转换为整数。如果 PHP 无法正确转换字符串，则将其评估为 0。因此 0 等于 0，即为真。这只是一个例子。另一个建议是要小心你在 php 中的命名风格，与其他开发人员保持一致，尝试使用驼峰或下划线，不要以大写开头你的变量。最后一个建议是也要小心 mysql 列名，因为它们仅在 linux 上区分大小写，在 Windows 上它们不区分大小写。所以尝试用小写字母命名并使用下划线。

# c# - 如何从字典中读取值 > 基于使用 linq 传递的密钥

> ID：16051398
> 
> 赞同：0
> 
> 时间：2013-04-17T04:19:06.737
> 
> 标签：c#, linq

我有一个字典对象如下：

```
Dictionary<String, List<Component>> dicCountries = new Dictionary<string, List<Component>>(); 
```

现在**dicCountries**是根据区域 ID 分组的，所以我想`List<Component>`在传递区域 ID 时获取所有信息。

是否可以使用 Linq 或者我们是否需要使用 C# 代码来阅读它。

请推荐！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T05:03:27.177

```
var result = dicCountries.FirstOrDefault(x => x.Key == regionID).Value; 
```

或者

```
var result = (from x in dicCountries
where x.Key == regionID
select x.Value).FirstOrDefault(); 
```

个人觉得第一个比较干净。顺便说一句，Linq 或没有 Linq .. 都是 C#

**更新：**

实际上，在使用时`FirstOrDefault`，它可能会返回 a `NULL`，因此您应该先检查代码。所以：

```
var result = dicCountries.FirstOrDefault(x => x.Key == regionID);

List<Component> components = null;
if (result != null)
{
    components = result.Value;
} 
```

**更新 2：**

我只记得..`KeyValuePair<TKey, TValue>`不能与 null 进行比较，您需要像这样检查：

```
if (!result.Equals(default(KeyValuePair<string, List<Component>>))) 
```

这只是证明......有时LINQ不是最干净的解决方案。在大多数情况下是这样，但在这种情况下不是......所以选择更简单的解决方案：

```
List<Component>() list;
if (dicCountries.ContainsKey(regionID))
{
    list = dicCountries[regionID];
} 
```

# xml - 在 XSLT 中转义新行

> ID：16051402
> 
> 赞同：0
> 
> 时间：2013-04-17T04:19:16.523
> 
> 标签：xml, xslt

这是我的代码行

```
<xsl:template name="Reports">
    <xsl:apply-templates select="/result/content/row"/>
 </xsl:template> 
```

这是xml中的数据

```
<description>
 <![CDATA[ test test ]]>
</description> 
```

xml中的数据是

测试

测试

我怎样才能逃避 xslt 中的新行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:29:26.640

逃生是为了

```
new line: &#10;
carriage return: &#13; 
```

# matlab - 如何绘制两个离散信号的总和？

> ID：16051407
> 
> 赞同：0
> 
> 时间：2013-04-17T04:19:47.870
> 
> 标签：matlab, signals, signal-processing

我有一个离散信号

x = [ 1 2 3 4 5 6 ] 其中 n = [ -2 -1 0 1 2 3 ]

我如何绘制 y[n] = x[n-1] + x[n-2] + x[n] ？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T04:37:50.800

您可以执行以下操作：

```
y = x(1:end-2) + x(2:end-1) + x(3:end);
plot(n(3:end), y) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T07:38:17.377

这看起来像一个过滤器......您应该考虑使用该`filter`函数来计算`y`：

```
x = [...whatever...];
% Filter coefficients from your difference equation.
b = [1 1 1];
a = 1;

y = filter(b, a, x);
plot(n, y); 
```

这将比幼稚的方法更恰当地处理初始条件，因此您将使用给定的输入获得一个 6 元素向量（尽管请注意，您的数据在前三个样本中可能部分是垃圾）。

# xml - 用vb从xml文件中删除换行符和空格

> ID：16051408
> 
> 赞同：0
> 
> 时间：2013-04-17T04:19:57.290
> 
> 标签：xml, vb.net, whitespace

我在网上看了几天关于如何做到这一点。我发现代码的小元素，但我似乎错过了较大的项目。

我有许多 xml 文件，我需要编辑标签（内部文本）中的额外空格，并且我需要删除许多换行符（或返回——不确定我是否有正确的术语）。同样，有些元素，比如一些文本，我想保留文本，但只删除标签（文本将被吸收到父标签中，这就是我需要去掉空格和返回的原因。

```
<root>
  <element>Some text here that has line breaks. Like this: 
    item        one 
    item two
  </element> 
</root> 
```

需要它看起来像：

```
<root>
 <element>Some text here that has line breaks. Like this: item item two</element>
</root> 
```

我找到了这个，但我知道它不会起作用。我知道我可能需要一些可以读取和替换的代码（例如每个节点等）。

这是我的开始：

```
Private Sub Button1_Click_1(sender As Object, e As EventArgs) Handles Button1.Click
    Dim path As String = "c:\temp\"

    Dim doc As New XmlDocument
    doc.PreserveWhitespace = False
    doc.Load(path & filenm.Text)
    'need some loop though here with a doc.replace(something???)
    doc.Save(path & filenm.Text)
    doc.PreserveWhitespace = False
End Sub 
```

有什么帮助吗？顺便说一句，我在这里得到的所有帮助都很棒。我是新手，但从你那里学到了很多，现在运行了一个非常酷的应用程序，让人们认为我知道我在做什么。;-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:25:07.717

你可以试试

```
Private Sub Button1_Click_1(sender As Object, e As EventArgs) Handles Button1.Click
    Dim path As String = "c:\temp\"

    Dim doc As New XmlDocument
    doc.Load(path & filenm.Text)

    'loop through every text node
    For Each Node As XmlNode In doc.SelectNodes("//text()")
        Node.Value = System.Text.RegularExpressions.Regex.Replace(Node.Value, "\s+", " ").Trim
    Next

    doc.Save(path & filenm.Text)
End Sub 
```

以下代码替换每个标签之间的所有空格。这没有回答问题，但可能对某人有所帮助。

```
'get XML content without whitespaces
Dim XmlContent As String = doc.OuterXml

'save the content
File.WriteAllText(path & filenm.Text, XmlContent) 
```

# r - 有人可以检查我的代码以查看为什么会弹出此消息“错误：找不到函数“N1””

> ID：16051410
> 
> 赞同：1
> 
> 时间：2013-04-17T04:20:11.037
> 
> 标签：r, rep

我知道这是一个简单的修复，但有人可以看看它：

```
a12= 0
a21= 0
K1= 1000
K2= 600
r1= 0.2
r2= 0.1
N1= ((K1 - a12*K2)/(1 - a12*a21))
N2= ((K2 - a21*K1)/(1 - a21*a12))
for(t in 1:80){
  N1[t+1]= N1(t) + r1*N1(t)*(K1 - N1 - a12*N2)/K1
  N2[t+1]= N2(t) + r2*N2(t)*(K2 - N2 - a21*N1)/K2
}
## Error: could not find function "N1" 
```

更正的代码：

```
N1= rep(0,80)
N2= rep(0,80)
a12= 0
a21= 0
K1= 1000
K2= 600
r1= 0.2
r2= 0.1
N1[1]= ((K1 - a12*K2)/(1 - a12*a21))
N2[1]= ((K2 - a21*K1)/(1 - a21*a12))
for(t in 1:80){
N1[t+1]= N1[t] + r1*N1[t]*(K1 - N1[t] - a12*N2[t])/K1
N2[t+1]= N2[t] + r2*N2[t]*(K2 - N2[t] - a21*N1[t])/K2
}
plot(1:81, N1, type="l", lwd=3, xlab="Time")
lines(1:81, N2, lwd=3, col='red') 
```

当我运行我更改 a12 和 a21 值的地块时，它们看起来就像我预期的那样，因为它们模拟了两个物种之间的竞争力。

我正在运行的三个模型：

```
no competition-        a12=0     a21=0
stable coexistence-    a12=0.25  a21=0.1
competitive exclusion- a12=0.25  a21=0.75 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:10:55.007

@e4e5f4 是正确的，因为您的主要问题是您使用的是`(`圆括号，而您需要`[`方括号。

但是，此外，您的`for`循环中有一个问题：

```
 # this is a problem, even with brackets corrected
 N1[t+1]= N1[t] + r1*N1[t]*(K1 - N1 - a12*N2)/K1
 N1[t+1]= N1[t] + r1*N1[t]*(K1 - N1 - a12*N2)/K1
                                 ^        ^
                          N1 & N2 are vectors 
```

由于大多数数学运算`R`都是向量化的，因此分配的值（即等式的右侧）是一个向量，其长度在每次迭代时都在增长。

* * *

您看到的后续警告来自尝试将多个值（即向量）分配给向量的单个元素。

如果您尝试，您将看到相同的错误

```
 foo <- c(17, 23, 31)
 foo[3] <- 1:10 
```

由于您正在迭代，您会收到 158 个此类警告。

* * *

您很可能想要索引这些值（可能使用`N1[[t]]`or`N1[[t-1]]`等​​）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:26:00.467

替换`N1(t)`为`N1[t]`。对 做同样的事情`N2`。

注意：我认为您使用`Matlab`的数组索引语法与`R`语法不同。

# c# - 访问另一个 app.config 文件中的 app.config 文件属性

> ID：16051411
> 
> 赞同：0
> 
> 时间：2013-04-17T04:20:12.463
> 
> 标签：c#, wcf, windows-services, app-config

我有一个实现 Windows 服务业务逻辑的 WCF 类库。在`app.config` 文件中，我定义了一个名为“调试模式”的属性，用于调试目的。

然后我创建了单独的 Windows 服务，并在上面创建了 WCF 类库作为参考（通过添加`.dll`文件和“使用名称”语句）。

`app.config`我需要使用 Windows 服务文件在 wcf 类库文件中设置“调试模式”属性`app.config`。

可能吗 ？还是我有任何替代方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:35:16.750

If you are using `appSettings` and `ConfigurationManager` to read your property, you **have** to put (copy - as @JohnSounders explaine) your property into your windows service config file.

In other case - you'll not be able to retrieve it from config.

In usual way, your application will look for configuration of current running executable (in your case - windows service).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:27:39.723

您应该能够拥有一个 app.config，并且 WCF 库和 Windows 服务都可以从中读取。Windows 服务是当前线程并引用 WCF 库，因此 WCF 库可以访问 Windows 服务的 app.config。

# javascript - JQueryUI .selectable 事件

> ID：16051413
> 
> 赞同：0
> 
> 时间：2013-04-17T04:20:30.733
> 
> 标签：javascript, jquery, jquery-ui

我在 JQuery .selectable 函数中遇到了一个小问题

我想做的是将一些事件绑定到每个选项卡。

我可以处理每个标签的点击事件

但问题是当我选择两个或更多选项卡时，

我无法弄清楚我是如何处理它的。

例如，如果我单击（也只是通过拖动选择）一个选项卡，

一些排序功能必须有效并且

每个不同的定义功能也必须在拖动多个选择时起作用。

当然，我可以使用一些标志作弊来解决这个问题

但这不是我真正想要的。

有没有人有一些有效的解决方案？

```
 $("#selectable2").selectable(
    {
        selected: function()
        {
           $(".arcplan").on("selectableselected", function()
           {
               $(".big-tile").hide(200);
           }) 

        }
    });

 <div class="menu">
    <div class="inner">
        <ol id="selectable2">
           <li class="alltype2">all</li>
           <li class="arcplan">Arcplan</li>
           <li class="msbi">MSBI</li></li>
           <li class="excel">Excel</li>
           <li class="etc">etc</li>
        </ol>
    </div>
 </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:02:15.380

从文档（[http://api.jqueryui.com/selectable/#event-selected](http://api.jqueryui.com/selectable/#event-selected)）：

```
$('#selectable2').selectable();
$('#selectable2').on('selectableselected', function(event, ui){
  doSomethingWithTheSelected(event.target);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T03:40:10.440

尝试

```
$("#selectable2").selectable({
  selected : function(event, ui) {
    if($(ui.selected).hasClass('arcplan')){
      $(".big-tile").hide(200);
    }
    }
}); 
```

演示：[小提琴](http://plnkr.co/edit/NMdTxlpLfR3o8P36YUQo?p=preview)- 当您单击元素`Arcplan`时`big-tile`隐藏，如果您选择其他任何内容，它会显示回来。

# delphi - 如何区分一个WCHAR是中文、日文还是ASCII？

> ID：16051416
> 
> 赞同：0
> 
> 时间：2013-04-17T04:20:45.967
> 
> 标签：delphi, ascii

例如德尔福代码

```
 wchar_IsASCii : array[0..1] of WCHAR ;

  wchar_IsASCii[0] := 'A'   ;
  wchar_IsASCii[1] := 'じ'  ; 
```

如何判断是`wchar_IsASCii[0]`属于 ASCII 还是`wchar_IsASCii[1]`不属于 ASCII？

实际上，我只需要知道一个UNICODE char 是否属于ASCII，这就是如何区分WCHAR char 是中文、日文还是ASCII。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:40:32.007

我不了解 Delphi，但我可以告诉您的是，您需要确定字符在 Unicode 中适合的范围。这是有关在 Unicode 中查找 CJK 字符的链接：Unicode[中汉字的完整范围是什么？](https://stackoverflow.com/questions/1366068/whats-the-complete-range-for-chinese-characters-in-unicode)

除非 Delphi 有一些很好的库来区分中文和日文字符，否则你将不得不自己确定。这是关于如何做到这一点的一个很好的答案： [Testing for Japanese/Chinese Characters in a string](https://stackoverflow.com/questions/786637/testing-for-japanese-chinese-characters-in-a-string)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T06:06:10.000

问题是......你所说的 ASCII 是什么意思？原始的 ASCII 标准是 7 位代码，称为`Latin1`- 它甚至不是一个字节。

然后，如果您带有所谓的“扩展 ASCII”——一个 1 字节的项目——那么它的一半可以紧挨着任何东西。它可以是希腊语在一个机器上，欧洲变音符号在另一个机器上，西里尔字母在第三个......等等。

所以我认为如果你需要的只是测试你是否有 7 位`Latin1`字符 - 排除法语、德语、西班牙语字母和所有斯堪的纳维亚字母的扩展字符，然后 - 因为 Unicode 被设计为另一个超集，`Latin1`你需要检查它`(0 <= Ord(char-var)) and ($7f >= Ord(char-var))`。

* * *

但是，如果你真的需要告诉语言，如果你认为希腊文和西里尔文有点 ASCII 和日文字母（顺便说一下，有两个，平假名和片假名）不是（或者如果你认为法语和德语或多或少类似于 ASCII，但是俄语不是）您将不得不查看 Unicode Ranges。
[http://www.unicode.org/charts/index.html](http://www.unicode.org/charts/index.html)

要附带 32 位`codepoint`标准`UCS4`，您可以使用[http://docwiki.embarcadero.com/Libraries/XE3/en/System.Character.ConvertToUtf32](http://docwiki.embarcadero.com/Libraries/XE3/en/System.Character.ConvertToUtf32)

* * *

旁边有*用于 Unicode 的标准 IBM 类，*但看起来没有很好的 Delphi 翻译存在[有人在 Delphi 中使用过 ICU 吗？](https://stackoverflow.com/questions/5473127/)

* * *

您可以使用 Jedi CodeLib，但它的表格（评论相互矛盾）来自 Unicode 4.1 或 5.0，而不是来自当前的 6.2，尽管[对于日语版本 5.0 应该足够了](http://www.unicode.org/announcements/quotations.html#murata)。

*   [http://wiki.delphi-jedi.org/wiki/JCL_Help:TUnicodeBlock](http://wiki.delphi-jedi.org/wiki/JCL_Help:TUnicodeBlock)
*   [http://wiki.delphi-jedi.org/wiki/JCL_Help:CodeBlockFromChar](http://wiki.delphi-jedi.org/wiki/JCL_Help:CodeBlockFromChar)
*   [http://wiki.delphi-jedi.org/wiki/JCL_Help:CodeBlockName@TUnicodeBlock](http://wiki.delphi-jedi.org/wiki/JCL_Help:CodeBlockName@TUnicodeBlock)

* * *

您还可以使用[Microsoft MLang 界面](http://msdn.microsoft.com/en-us/library/aa741220.aspx)来查询类似 Internet 的字符代码 (RFC 1766)

*   [http://msdn.microsoft.com/en-us/library/aa741220.aspx](http://msdn.microsoft.com/en-us/library/aa741220.aspx)
*   [http://msdn.microsoft.com/en-us/library/aa767880.aspx](http://msdn.microsoft.com/en-us/library/aa767880.aspx)
*   [http://msdn.microsoft.com/en-us/library/aa740986.aspx](http://msdn.microsoft.com/en-us/library/aa740986.aspx)
*   [http://www.transl-gunsmoker.ru/2011/05/converting-between-lcids-and-rfc-1766.html](http://www.transl-gunsmoker.ru/2011/05/converting-between-lcids-and-rfc-1766.html)
*   [http://www.ietf.org/rfc/rfc1766.txt](http://www.ietf.org/rfc/rfc1766.txt)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T05:28:46.720

通常，一个字符属于 ASCII，如果其代码在 0x0000..0x007F 范围内，请参见[http://www.unicode.org/charts/PDF/U0000.pdf](http://www.unicode.org/charts/PDF/U0000.pdf)。一个新的 Delphi 具有类功能`TCharacter.IsAscii`，但出于某种奇怪的原因，它被声明为私有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T06:00:19.823

ASCII 字符的十进制值小于 127。

但是，除非您使用 1960 年代的电传打字机，否则 ASCII 字符可能还不够。ASCII 字符仅涵盖英文字符。如果您确实需要支持德语、法语、西班牙语、瑞典语等中的元音变音符号、坟墓等“西欧”字符，那么测试 Unicode 字符值 <= 127 是不够的。只要您不需要使用东欧脚本，您就可以测试 char 值 <= 255。

# kernel - dtrace：没有捕获任何写入系统调用

> ID：16051417
> 
> 赞同：2
> 
> 时间：2013-04-17T04:20:59.833
> 
> 标签：kernel, system-calls, dtrace

我是 dtrace 的新手，正在尝试编写一些基本的 dtrace 脚本。我找到了一个在单独的终端上捕获 read(2) 和 write(2) 系统调用的示例，如下所示，

```
 syscall::read:entry,
 syscall::write:entry
 /pid==4217/
 {

 } 
```

指定的 pid 号来自其他终端的 pid id。当我看到这个例子时，如果我用 dtrace 运行这个脚本，它应该会显示一些读写系统调用。但我只观察到读系统调用，但没有观察到写系统调用。

因此，如果我理解正确，在我观察到的终端（pid 4217）上，如果我在该终端上键入某些内容，内核将读取它的字符，因此假设会发生读取系统调用。如果我输入“ls”之类的内容并回车，内核将读取并执行它，并将一些输出写入终端，因此编写系统调用假设被调用。但我没有看到任何写入系统调用。这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-05T11:09:49.993

我将首先验证 write() 是否适用于任何其他过程，例如一个简单的测试用例。在您的示例中，可能是（a）它的 pid 错误，或者它的孩子在写，或者（b）没有使用 write 调用，但可能是，例如 writev() 或其他一些调用（尝试使用验证strace 也许）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T00:03:49.253

我同意@PaulFox，这可能是一个错误的`pid`值。当终端在您按下回车之前暂停时，终端处于`read`系统调用的中间。但是，当它打印终端提示符时（在您按下回车键并`ls`运行之后），它会通过`write`系统调用来实现。请注意，输出`ls`不是`write`系统调用的来源！那`pid`将是正在运行的`ls`命令的进程 ID。

要测试`write`系统调用是否确实有效，请运行以下命令：

```
# dtrace -n 'syscall::write:entry {printf("hello")}' 
```

然后用你的终端尝试它（用你正在使用的任何东西替换'bash'）作为目标：

```
# dtrace -n 'syscall::write:entry /pid==$target/ {printf("hello")}' -c 'bash' 
```

如果您在终端中输入内容时其中一个未能显示任何写入内容，请回发。

另请注意，您的 shell 可能正在使用多个版本的 write 系统调用（尽管如果它使用的不是普通的，我会感到惊讶`write`）：

```
# dtrace -ln 'syscall::*write*:entry'
   ID   PROVIDER            MODULE                          FUNCTION NAME
  147    syscall                                               write entry
  381    syscall                                              writev entry
  447    syscall                                              pwrite entry
  777    syscall                                           aio_write entry
  933    syscall                                      write_nocancel entry
  963    syscall                                     writev_nocancel entry
  969    syscall                                     pwrite_nocancel entry 
```

# macos - 如何列出我有多少个 git 公钥

> ID：16051419
> 
> 赞同：1
> 
> 时间：2013-04-17T04:21:16.737
> 
> 标签：macos, git

在某些时候，我在我的系统中创建了很多公钥，但我忘记了它们。我想知道如何确定我有多少？哪个是活跃的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:25:20.547

查看 ~/.ssh

如果您不确定需要多少，只需复制/重命名 .ssh 目录，然后将它们一一复制回来。

# python - Patch - 修补类引入了一个额外的参数？

> ID：16051422
> 
> 赞同：22
> 
> 时间：2013-04-17T04:21:30.347
> 
> 标签：python, unit-testing, mocking, patch, typeerror

第一次使用补丁。我试图修补我的一个类进行测试。如果没有尝试运行的补丁程序可以通过测试函数定义，但是有了补丁程序，测试函数定义显然需要另一个参数，我得到一个

```
TypeError: testAddChannelWithNamePutsChannel() takes exactly 1 argument (2 given) 
```

错误。测试代码如下：

```
import unittest
import mock
from notification.models import Channel, addChannelWithName, deleteChannelWithName

class TestChannel(unittest.TestCase):
    @mock.patch('notification.models.Channel')
    def testAddChannelWithNamePutsChannel(self):
        addChannelWithName('channel1')
        Channel.put.assert_called_with() 
```

为什么补丁需要一个额外的参数，这个参数应该是什么？非常感谢！

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-04-17T07:03:21.457

Patch 将修补对象的实例传递给您的测试方法（如果您在类级别进行修补，则传递给每个测试方法）。这很方便，因为它可以让你设置返回值和副作用，或者检查调用

```
from unittest.mock import patch

@patch('some_module.sys.stdout')
def test_something_with_a_patch(self, mock_sys_stdout):
    mock_sys_stdout.return_value = 'My return value from stdout'

    my_function_under_test()

    self.assertTrue(mock_sys_stdout.called)
    self.assertEqual(output, mock_sys_stdout.return_value) 
```

如果您只是想从字面上修补某些东西以忽略它，那么您可以使用以下调用调用 patch

```
from unittest.mock import patch, Mock

@patch('some_module.sys.stdout', Mock())
def test_something_with_a_patch(self): 
```

这用一个对象替换`sys.stdout`，并且不将它传递给方法。`some_module``Mock`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-17T05:14:25.280

`patch`将修补后的对象传递给测试函数。它记录[在这里](http://docs.python.org/dev/library/unittest.mock#unittest.mock.patch)：

> patch 作为函数装饰器，为您创建模拟并将其传递给装饰函数：
> 
> ```
> >>>
> >>> @patch('__main__.SomeClass')
> ... def function(normal_argument, mock_class):
> ...     print(mock_class is SomeClass)
> ...
> >>> function(None)
> True 
> ```

# oracle10g - 如何检查远程 Oracle 服务器是否已启动并正在运行

> ID：16051425
> 
> 赞同：1
> 
> 时间：2013-04-17T04:21:38.643
> 
> 标签：oracle10g, remote-server

我在远程机器上安装了我的 Oracle 服务器，我想在我的本地机器上安装一个脚本来检查 Oracle 服务器是否启动并运行。我知道这可以通过 sqlplus 或 JDBC 创建连接来检查。但在这种情况下，oracle 客户端将不存在，我将 JDBC 方法保存为我的最后一个选择。那么有没有其他更简单的方法来检查这个，可以很容易地在 shell 脚本中实现？？？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:24:11.867

并不真地。确定数据库正在响应查询的唯一方法是在其上运行查询，例如古老的：

```
select dummy from dual 
```

# javascript - 如何在没有重定向页面的情况下使用 jquery post 发送大数据？

> ID：16051429
> 
> 赞同：1
> 
> 时间：2013-04-17T04:21:49.450
> 
> 标签：javascript, jquery, json, chat, getjson

我想知道如何在没有重定向页面的情况下使用 jquery POST 发送大数据？我有一个项目来创建移动聊天，并在用户应用程序和服务器之间进行连接，我使用 JSON。这是 jquery get json 脚本的样子，因为我们知道 jsonGet 不能处理大数据。

注意：bigNumber 有 8000 个字符。

```
$.getJSON('process.php?input='+bigNumber, function(data) {
    $.each(data.Chats, function(i,output)
    {
        $("#data").append(output.chat);
    });
}); 
```

*这是我使用 getJSON 发送大数字时得到的结果：* **414（请求 URI 太大）**

所以，在我发送 bigNumber 之后，我会从 process.php 获得响应作为 json 数据并添加到 html 的正文中。

//--- 现在这是我的代码。

**.html 文件**

```
<script src="jquery.min.js"></script>
<script>
$(function(){
    $("#senddata").click(function() {
        $.ajax({
            dataType: "json",
            url: "process.php",
            data: { input:$("#bigNumber").val() },
            success: function(data) {
                $.each(data.Chats, function(i,output)
                {
                    $("#data").append(output.key);
                });
            },
            method: "POST"
        });
    });
});
</script>
<div id="data"></div>
<input type="text" id="bigNumber"/>
<button id="senddata">Send</button> 
```

这是**process.php**

```
header('Content-type: application/json');

$key = $_POST["input"];

$simpan_array = array();

$chat = array();
$chat["key"] = $key;

array_push($simpan_array, $chat);

echo json_encode(array("Chats" => $simpan_array)); 
```

当我填写文本框并按下“发送”按钮时，什么也没有发生。怎么了？

* * *

**刚刚发现是什么问题，是json格式的错误，显示在process.php上**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:25:51.473

您需要改用 POST 请求。由于`getJSON()`只是 的门面`ajax()`，因此很容易转换：

```
$.ajax({
  dataType: "json",
  url: "process.php",
  data: { input:bigNumber },
  success: function(data) {
    $.each(data.Chats, function(i,output)
    {
        $("#data").append(output.chat);
    });
  },
  method: "post"
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T04:27:17.717

利用`$.post`

```
$.post('process.php',{input: bigNumber}, function(data) {
  $.each(data.Chats, function(i,output)
  {
    $("#data").append(output.chat);
  });
},'JSON'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T05:30:09.867

为什么你不能尝试将 websockets 用于聊天应用程序请参阅此页面 [Web Socket Server](http://www.codeproject.com/Articles/57060/Web-Socket-Server)或[HTML5 WebSocket 简介](http://www.codeproject.com/Articles/531698/Introduction-to-HTML5-WebSocket)

# r - knitr figure 制作了两次（使用 R 3.0.0）

> ID：16051436
> 
> 赞同：3
> 
> 时间：2013-04-17T04:22:43.087
> 
> 标签：r, knitr

我有一个 Rnw 文件，在升级到 R 3.0.0（和 knitr 1.2）之前运行良好。[更新到 R 3.0.0 后，我发现了 knitr 问题](https://tex.stackexchange.com/questions/108335/knitr-problem-after-update-to-r-3-0-0)中描述的类似问题

我按照答案更新到`knitr 1.2.4`（rforge 版本）。问题依旧！

现在，一个块会导致一个问题（并且只有一个块），它会产生两个数字。该块被称为`plotc`，并且两者都`plotc1.pdf`被`plotc2.pdf`生成。编织后，pdflatex抛出错误：

```
!pdfTeX error: pdflatex (file c:/repos/uws-r-manual/figure/plotc1.pdf): PDF inclusion: required page does not exist <0> ==> Fatal error occurred, no output PDF file produced! 
```

如果需要，如果有人想重现/修复此问题，我可以授予对 bitbucket 存储库的访问权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T03:25:38.957

我已经在开发版（v1.2.5）中解决了这个问题。有关安装说明，请参见[此处](https://github.com/yihui/knitr#readme)。它将最终进入稳定版本 1.3。

# php - 为Eclipse安装PHP开发工具时，PDT和PDT SDK有什么区别？

> ID：16051438
> 
> 赞同：2
> 
> 时间：2013-04-17T04:22:55.600
> 
> 标签：php, eclipse, eclipse-pdt

我即将安装 PDT，有 2 个选项：

```
PHP development tools (PDT)
PHP development tools (PDT) SDK Feature 
```

有什么不同？

# asp.net - ASP.NET：想要像这样创建家谱树

> ID：16051439
> 
> 赞同：2
> 
> 时间：2013-04-17T04:22:56.093
> 
> 标签：asp.net, tree, treeview, binary-tree, genealogy

有人可以帮我创建这样的树视图，或者至少帮我从一个例子或其他东西开始提升这就是我正在寻找的（低声誉点，所以不能发布图片） [http://s12.postimg.org/ y9lcyjhvx/Untitled.png](http://s12.postimg.org/y9lcyjhvx/Untitled.png)

# c# - Amazon AWS 简单工作流服务 SWF C# 示例

> ID：16051441
> 
> 赞同：4
> 
> 时间：2013-04-17T04:22:59.957
> 
> 标签：c#, .net, amazon-web-services, workflow, flash

我想知道是否有适用于 AWS .NET SDK 的 SWF 工作流 C# 示例代码？

AWS 论坛帖子：[https ://forums.aws.amazon.com/thread.jspa?threadID=122216&tstart=0](https://forums.aws.amazon.com/thread.jspa?threadID=122216&tstart=0)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-04T16:27:07.303

作为熟悉 SWF 的一部分，我最终编写了一个通用案例库，希望其他人也可以使用它。[它称为 SimpleWorkflowFramework.NET，可在https://github.com/sdebnath/SimpleWorkflowFramework.NET](https://github.com/sdebnath/SimpleWorkflowFramework.NET)作为开源获得。它绝对可以提供很多帮助，所以如果您有兴趣，请立即加入！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-18T18:42:13.943

我开发了一个开源 .NET 库[- Guflow](https://github.com/gurmitteotia/guflow)来对 Amazon SWF 进行编程。以下是如何编写工作流程来对视频进行转码：

```
[WorkflowDescription("1.0")]
public class TranscodeWorkflow : Workflow
{
  public TranscodeWorkflow()
  {
    //DownloadActivity is the startup activity and will be scheduled when workflow is started.
    ScheduleActivity<DownloadActivity>().OnFailure(Reschedule);

    //After DownloadActivity is completed TranscodeActivity activity will be scheduled.
    ScheduleActivity<TranscodeActivity>().AfterActivity<DownloadActivity>()
        .WithInput(a => new {InputFile = ParentResult(a).DownloadedFile, Format = "MP4"})

    ScheduleActivity<UploadToS3Activity>().AfterActivity<TranscodeActivity>()
        .WithInput(a => new {InputFile = ParentResult(a).TranscodedFile});

    ScheduleActivity<SendConfirmationActivity>().AfterActivity<UploadToS3Activity>();
  }
  private static dynamic ParentResult(IActivityItem a) => a.ParentActivity().Result();
} 
```

在上面的示例中，为了清楚起见，我省略了任务路由。以下是创建活动的方法：

```
[ActivityDescription("1.0")]
public class DownloadActivity : Activity
{
  //It supports both sync/async method.
  [ActivityMethod]
  public async Task<Response> Execute(string input)
  {
      //simulate downloading of file
      await Task.Delay(10);
      return new Response() { DownloadedFile = "downloaded path", PollingQueue = PollingQueue.Download};
  }

  public class Response
  {
      public string DownloadedFile;
  }
} 
```

为清楚起见，我省略了其他活动的示例。Guflow 由[文档](https://github.com/gurmitteotia/guflow/wiki)、[教程](https://github.com/gurmitteotia/guflow/wiki/Tutorial)和[示例](https://github.com/gurmitteotia/guflow-samples)支持。

# ios - ios xmpproom 教程

> ID：16051444
> 
> 赞同：-3
> 
> 时间：2013-04-17T04:23:21.900
> 
> 标签：ios, xmpp, chat, chatroom

我一直在寻找带有聊天室教程的好的 XMPP。我发现本[教程](http://mobile.tutsplus.com/tutorials/iphone/building-a-jabber-client-for-ios-server-setup/)很有帮助，但在实现多用户聊天方面仍然没有运气。

有人可以给我一个很好的参考吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-08T16:40:37.387

只要按照这种方式，就可以制作XMPP聊天室了。你必须配置一些关于房间的设置。

*   (void)xmppRoom:(XMPPRoom *)sender didConfigure:(XMPPIQ *)iqResult

这个委托方法将被调用~你可以通过 XMPP - 045 文档设置你想要的

```
 XMPPRoomMemoryStorage *roomMemory = [[XMPPRoomMemoryStorage alloc]init];

    roomID = [NSString stringWithFormat:@"%@@%@",_subjectOfRoom.text,szRoomName];
    XMPPJID *roomJID = [XMPPJID jidWithString:roomID];

    XMPPRoom *xmppRoom = [[XMPPRoom alloc]initWithRoomStorage:nil
                                                          jid:roomJID
                                                dispatchQueue:dispatch_get_main_queue()];

    [xmppRoom addDelegate:self delegateQueue:dispatch_get_main_queue()];

    [xmppRoom activate:[[JSXMPP_Singletone sharedInstanc]xmppStream]];

    [xmppRoom joinRoomUsingNickname:@"KIM"
                            history:nil
                           password:nil];
    [xmppRoom configureRoomUsingOptions:nil]; 
```

# optimization - 在 OpenGL ES 2.0 中使用 VBO 进行优化

> ID：16051447
> 
> 赞同：2
> 
> 时间：2013-04-17T04:23:27.087
> 
> 标签：optimization, opengl-es-2.0, vertex-buffer

我的系统由几个代表四边形的对象组成。每个四边形都由相同的顶点表示，因此，每个对象仅存储表示对象在世界中的变换及其自己的对象空间的矩阵。在每次渲染过程中，在这些矩阵用它们的帧变换更新后，它们与当前的视图和投影矩阵相乘以形成该对象的 MVP 矩阵。然后将对象顶点与 MVP 矩阵一起发送到着色器，在着色器中顶点乘以 MVP 矩阵。这里的低效率是每个四边形是单独绘制的，这意味着每个四边形都有一个单独的调用 glDrawElements。在任何给定时刻，可能存在 50 或 60 个四边形，有些超出范围并被破坏，或者它们的动画可能完成，所以它们 re也被摧毁，但更多会随机进入存在。将所有必要的值存储在 VBO 中并在每次传递期间仅调用一次 glDrawElements 会显着提高性能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T07:18:39.847

> 将所有必要的值存储在 VBO 中并在每次传递期间仅调用一次 glDrawElements 会显着提高性能吗？

是的，它会快得多。正如您正确识别的那样，第一个原因将是一个单一的`glDrawElements`呼叫。其次是 VBO 将数据保存在 GPU 本身中。

如果四边形超出范围，您可以将它们的内存重新用于新的四边形。VBO 可用于绘制缓冲区的子区域，因此您可以获得很大的灵活性而无需内存分配。

通过使用 VBO，您可以最大限度地减少与 GPU 的交互，从而获得性能优势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T08:37:01.013

让我们首先用一些简单的数学来解释它：

*   目前，您不需要将任何顶点数据推送到 GPU（每帧），但每个四边形有 12-16 个浮点矩阵数据，并在 CPU 上对每个四边形执行矩阵矩阵乘法。
*   将所有内容放入一个 VBO 时，您必须为每个四边形传输 4 个顶点（~12 个浮点数），但没有矩阵数据（当然，全局 VP 除外）并且您必须进行 4 个矩阵向量乘法（~1 个矩阵矩阵乘法）在 CPU 上。

因此，传输的工作量和数据量并没有太大变化。但变化是，传输的数据从许多小的统一更新转移到单个大 VBO 更新，这很可能更快（两者都是因为从硬件方面来看缓冲区更新可能比多个统一更新更快，但不要把我钉在这个问题上，其次是因为大大减少了驱动程序开销）。最重要的是，通过使用单个大型绘制调用而不是许多更小的绘制调用，可以进一步减少开销。

所以是的，它肯定值得一试，尽管它是否真的是您特定应用程序中的*“显着”改进必须进行评估。*

# iphone - 播放视频时状态栏不隐藏

> ID：16051448
> 
> 赞同：1
> 
> 时间：2013-04-17T04:23:37.867
> 
> 标签：iphone, objective-c, media-player

我用于`[[UIApplication sharedApplication] setStatusBarHidden:YES];`在播放视频时隐藏状态。但是 statusBar 正在显示。

代码：

```
MPMoviePlayerViewController *mpviewController = [[MPMoviePlayerViewController alloc]initWithContentURL:[NSURL fileURLWithPath:path]];
[mpviewController.view setFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
[self.view addSubview:mpviewController.view];
[[UIApplication sharedApplication]setStatusBarHidden:YES];
[self presentMoviePlayerViewControllerAnimated:mpviewController]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T04:31:18.897

使用波纹管隐藏状态栏...

```
[[UIApplication sharedApplication] setStatusBarHidden:YES animated:YES]; 
```

否则使用此波纹管..

```
mpviewController.controlStyle = MPMovieControlStyleFullscreen; 
```

**或者**

```
[self setWantsFullScreenLayout:YES]; 
```

# javascript - pac (proxy-auto-config) 文件中的 FindProxyForURL 函数在 IE 浏览器中无法使用

> ID：16051450
> 
> 赞同：2
> 
> 时间：2013-04-17T04:23:48.437
> 
> 标签：javascript, internet-explorer, browser, pac, autoproxy

我们花了三天时间仍然无法解决一个奇怪的技术问题，所以我们需要您的帮助。

我们编写的 pac (proxy-auto-config) 文件在所有其他浏览器中都可以正常工作，除了 IE (Internet Explorer)。

请求网址是

```
https://news.google.com.hk/nwshp?hl=zh-CN&tab=wn 
```

如果 pac 文件是

```
function FindProxyForURL(url, host) {

    if(/news/i.test(url)) return "PROXY 127.0.0.1:8087";

    return  "DIRECT";
} 
```

没错，就是使用代理访问网站。

但是，如果 pac 文件更改为

```
function FindProxyForURL(url, host) {

    if(/CN/i.test(url)) return "PROXY 127.0.0.1:8087";

    return  "DIRECT";

} 
```

CN，也在网址中。但 IE 并不像我们想象的那样使用代理访问网站。

但是我们在 Chrome、Safari、Firefox 等其他浏览器中测试，它们都运行良好，它们都使用代理访问网站。

好像在IE中，函数中的参数“url”`FindProxyForURL(url, host)`不是url的完整路径，它只是包含主机，但在其他浏览器中是完整的url。

我们在这个问题上花了 3 天时间，你有什么想法让 IE pac 文件中的函数获取完整的 url，或者有办法在 IE 浏览器中调试 pac 文件。

我们甚至无法在浏览器中提醒信息。

我们的 IE 版本是 10，Windows 8。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-11T19:16:55.760

对于未来的研究，以及任何偶然发现这个线程的人，这个微软博客，描述了为什么这不起作用，这是因为最近 IE 11 如何使用代理发生了一些变化。

[http://blogs.msdn.com/b/ieinternals/archive/2013/10/11/web-proxy-configuration-and-ie11-changes.aspx](http://blogs.msdn.com/b/ieinternals/archive/2013/10/11/web-proxy-configuration-and-ie11-changes.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-18T17:10:57.143

请参阅[http://support.microsoft.com/kb/271361](http://support.microsoft.com/kb/271361)

您需要将 HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\EnableAutoProxyResultCache 设置为 DWORD 0。

# android - Android SQLiteDatabase插入错误

> ID：16051452
> 
> 赞同：0
> 
> 时间：2013-04-17T04:23:57.447
> 
> 标签：android, sqlite

我的简单账簿代码存在一些问题。

单击保存按钮时，我想插入一行。

我检查了我的表创建成功。

```
save.setOnClickListener(new Button.OnClickListener(){

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

            mDbOpenHelper.open();

            try{
            mDbOpenHelper.insertColumn(
                    rButton, 
                    mEditTexts[1].getText().toString().trim(), 
                    spinnerSelected, 
                    mEditTexts[0].getText().toString().trim());
            }catch(Exception e){
                Log.d("TAG","error");
            }

            mDbOpenHelper.close();
            mCursor.close();

        }

    }); 
```

插入列（）

```
// Insert DB
        public long insertColumn(String cashORcard, String amount, String category, String detail){
            mDB = mDBHelper.getWritableDatabase();
            ContentValues values = new ContentValues();
            values.put(Database.CreateDB.CASH, cashORcard);
            values.put(Database.CreateDB.AMOUNT, amount);
            values.put(Database.CreateDB.CATEGORY, category);
            values.put(Database.CreateDB.DETAIL, detail);

            return mDB.insert(Database.CreateDB.TABLENAME, null, values);

        } 
```

定义我的数据库表

```
public class Database {

public static final class CreateDB implements BaseColumns{
    public static String firstCash="0";
    public static String firstAccount="0";
    public static String allMoney="0";
    public static final String CASH="cash";
    public static final String CATEGORY="category";
    public static final String DETAIL="detail";
    public static final String AMOUNT="0";
    public static final String ID="0";
    public static final String TABLENAME="Accountbook";
    public static final String CREATE=
            "CREATE TABLE "+TABLENAME
            +" ( _id integer primary key autoincrement, "
            +" CASH text not null , "
            +" AMOUNT text not null , "
            +" CATEGORY text not null , "
            +" DETAIL text , "
            +" firstCash text not null , "
            +" firstAccount text not null , "
            +" allMoney text not null );";  
    }
} 
```

日志

```
04-17 02:53:11.471: E/SQLiteLog(877): (1) near "0": syntax error
04-17 02:53:11.501: E/SQLiteDatabase(877): Error inserting cash=cash detail=asdf category=salary 0=567
04-17 02:53:11.501: E/SQLiteDatabase(877): android.database.sqlite.SQLiteException: near "0": syntax error (code 1): , while compiling: INSERT INTO Accountbook(cash,detail,category,0) VALUES (?,?,?,?)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.database.sqlite.SQLiteConnection.nativePrepareStatement(Native Method)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.database.sqlite.SQLiteConnection.acquirePreparedStatement(SQLiteConnection.java:882)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.database.sqlite.SQLiteConnection.prepare(SQLiteConnection.java:493)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.database.sqlite.SQLiteSession.prepare(SQLiteSession.java:588)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:58)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.database.sqlite.SQLiteStatement.<init>(SQLiteStatement.java:31)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.database.sqlite.SQLiteDatabase.insertWithOnConflict(SQLiteDatabase.java:1467)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.database.sqlite.SQLiteDatabase.insert(SQLiteDatabase.java:1339)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at com.android.accountbook_edit.DbOpenHelper.insertColumn(DbOpenHelper.java:82)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at com.android.accountbook_edit.Income$3.onClick(Income.java:99)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.view.View.performClick(View.java:4204)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.view.View$PerformClick.run(View.java:17355)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.os.Handler.handleCallback(Handler.java:725)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.os.Handler.dispatchMessage(Handler.java:92)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.os.Looper.loop(Looper.java:137)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at android.app.ActivityThread.main(ActivityThread.java:5041)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at java.lang.reflect.Method.invokeNative(Native Method)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at java.lang.reflect.Method.invoke(Method.java:511)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-17 02:53:11.501: E/SQLiteDatabase(877):  at dalvik.system.NativeStart.main(Native Method) 
```

需要更多代码，请告诉我！谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:58:52.800

首先，您插入的是*rows*而不是*columns*。

然后，你日志中的错误就很清楚了

```
android.database.sqlite.SQLiteException: near "0": ... INSERT INTO Accountbook(cash,detail,category,0) VALUES (?,?,?,?) ... 
```

您正在尝试将值插入到无效的列名中：**0**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:15:37.250

您已将值传递`mEditTexts[0].getText().toString().trim()`给字符串详细信息。检查字符串详细信息和`ID Database.CreateDB.DETAIL`. 如果它显示“0”，那么它应该是“细节”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T06:03:23.407

尝试更改您的插入查询，如下所示：

您还需要传递其他剩余列的`firstCash,firstAccount,allMoney`值**，因为在 Create Table 查询中您已将其属性定义为 NOT NULL。**

> ```
> public long insertColumn(String cashORcard, String amount, String category, String detail,String cashValue,String AccountVal,String money){
>         mDB = mDBHelper.getWritableDatabase();
>         ContentValues values = new ContentValues();
>         values.put(Database.CreateDB.CASH, cashORcard);
>         values.put(Database.CreateDB.AMOUNT, amount);
>         values.put(Database.CreateDB.CATEGORY, category);
>         values.put(Database.CreateDB.DETAIL, detail);
>         values.put(Database.CreateDB.firstCash, cashValue);
>         values.put(Database.CreateDB.firstAccount, AccountVal);
>         values.put(Database.CreateDB.allMoney, money);
>         return mDB.insert(Database.CreateDB.TABLENAME, null, values);
>     } 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T04:26:00.257

```
public static final String AMOUNT="0" 
```

这应该是

```
public static final String AMOUNT="AMOUNT" 
```

您尝试插入名为“0”的列的结果

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T05:14:17.780

看到错误是`0=567`。在这里，您的列名是`integer`类型。所以这是错误的。列名应该是有效的。所以只需尝试以下

```
public static final String CREATE=
        "CREATE TABLE "+TABLENAME
        +" (_id integer primary key autoincrement, "
        + CASH +" text not null , "
        + AMOUNT+" text not null , "
        + CATEGORY+" text not null , "
        + DETAIL+" text , "
        + firstCash+" text not null , "
        + firstAccount+" text not null , "
        + allMoney+" text not null );"; 
```

而不是这个

```
public static final String CREATE=
        "CREATE TABLE "+TABLENAME
        +" ( _id integer primary key autoincrement, "
        +" CASH text not null , "
        +" AMOUNT text not null , "
        +" CATEGORY text not null , "
        +" DETAIL text , "
        +" firstCash text not null , "
        +" firstAccount text not null , "
        +" allMoney text not null );"; 
```

也改变你的

```
firstCash,firstAccount,allMoney,AMOUNT varibales values to be valid string. 
```

喜欢

```
public static String firstCash="firstCash";
public static String firstAccount="firstAccount";
public static String allMoney="allMoney";
public static final String AMOUNT="AMOUNT"; 
```

为什么因为列名应该是有效的。

我希望这能帮到您。

# javascript - Javascript 元素在 iFrame 之上的错误

> ID：16051457
> 
> 赞同：0
> 
> 时间：2013-04-17T04:24:26.343
> 
> 标签：javascript, iframe

我正在使用 jQuery UI 框架来创建一个可拖动的面板。它工作正常，但是当我将它拖到页面上嵌入的 iframe 顶部时，它会变得有问题并停止移动。我认为它可能只是插件，但它发生在我所有动态创建的元素都移动到 iframe 之上。

有谁知道出了什么问题或如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:28:23.167

当您拖动/调整面板大小时，您必须隐藏 iframe。这可以通过在 iframe （相同大小）上放置一个隐藏的透明 div 来完成，并且仅在触发拖动/调整大小事件时才显示它。因此，一旦触发拖动/调整大小开始和停止事件，请继续切换。

# python - 使用端点原型数据存储时设置父键而不是子键

> ID：16051459
> 
> 赞同：3
> 
> 时间：2013-04-17T04:24:32.897
> 
> 标签：python, google-app-engine, google-cloud-endpoints, endpoints-proto-datastore

如何为 EndpointsModel 设置父/祖先并让数据存储区自动生成实体 ID/密钥？

我尝试调整[keys_with_ancestors](http://endpoints-proto-datastore.appspot.com/examples/keys_with_ancestors.html)示例，但似乎遇到了一些障碍，因为它需要同时指定 id 和 parent。我想做类似的事情，除了只提供父 ID 或密钥，并让应用引擎数据存储区自动生成实体 ID/密钥。

以下显示了我将如何仅使用 NDB 来完成它。

```
class Parent(ndb.Model):
    name = ndb.StringProperty()

class MyModel(ndb.Model):
    attr1 = ndb.StringProperty()
    attr2 = ndb.StringProperty()

p = Parent(name="Jerry")
p_key = p.put()  # or retrieve the key from somewhere else

mod = MyModel(parent=p_key)
mod.put() 
```

这是可能的吗？有人能指出我正确的方向吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T23:51:41.793

在[keys_with_ancestors](http://endpoints-proto-datastore.appspot.com/examples/keys_with_ancestors.html)示例之后，假设我们有相同的导入，并且已经`MyParent`以相同的方式定义了类。

TL;DR 的答案本质上是传递`parent=`给模型构造函数等同于创建一个键，`None`并将其作为种类 ID 对列表中的最后一个 ID。例如，对于一个类`MyModel`：

```
>>> parent = ndb.Key(MyModel, 1)
>>> child = MyModel(parent=parent)
>>> print child.key
ndb.Key('MyModel', 1, 'MyModel', None) 
```

为了对示例执行此操作，我们可以简单地忽略`id`：

```
class MyModel(EndpointsModel):
  _parent = None

  attr1 = ndb.StringProperty()
  attr2 = ndb.StringProperty()
  created = ndb.DateTimeProperty(auto_now_add=True) 
```

并在设置器中简单地设置半生不熟的密钥，不要尝试从数据存储中检索（因为密钥不完整）：

```
 def ParentSet(self, value):
    if not isinstance(value, basestring):
      raise TypeError('Parent name must be a string.')

    self._parent = value
    if ndb.Key(MyParent, value).get() is None:
      raise endpoints.NotFoundException('Parent %s does not exist.' % value)
    self.key = ndb.Key(MyParent, self._parent, MyModel, None)

    self._endpoints_query_info.ancestor = ndb.Key(MyParent, value) 
```

同样，在 getter 中，您可以直接从键中检索父级（尽管这并不能保证只有一对作为父级）：

```
 @EndpointsAliasProperty(setter=ParentSet, required=True)
  def parent(self):
    if self._parent is None and self.key is not None:
      self._parent = self.key.parent().string_id()
    return self._parent 
```

完成此操作后，您无需更改任何 API 代码，示例将按预期工作。

# php - 在php中更新数据库表中的记录

> ID：16051462
> 
> 赞同：-1
> 
> 时间：2013-04-17T04:24:53.663
> 
> 标签：php

我正在尝试通过从另一个 .php 文件中获取 id 来更新表中的记录。但它无法更新。请帮忙。这是我的代码。

```
<?php
include('connection.php');
$member_id = $_GET['id']; 
echo ("You are going to edit/update record of employee with id #");echo $member_id;

if(isset($_REQUEST['submit']))
{
    $firstname =$_REQUEST['firstname'];
    $lastname =$_REQUEST['lastname'];
    $phone =$_REQUEST['phone'];    
    $insert = "update emp set SET firstname ={'$firstname'}, lastname = {'$lastname'} phone = {'$phone'} WHERE id = {'$member_id'}";
    mysql_query($insert);
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:26:29.340

在这里你有两个，因为那个查询失败了，你之前`SET`也忘记了`,``phone = {`

```
$insert = "update emp set SET firstname ={'$firstname'}, lastname = {'$lastname'} phone = {'$phone'} WHERE id = {'$member_id'}"; 
```

应该

```
$insert = "update emp SET firstname ={'$firstname'}, lastname = {'$lastname'}, phone = {'$phone'} WHERE id = {'$member_id'}"; 
```

**编辑**

写这个来检查错误

```
mysql_query($insert) OR die(mysql_error()); 
```

# php - PHP 将 4 字节二进制字符串解释为无符号大端整数

> ID：16051467
> 
> 赞同：0
> 
> 时间：2013-04-17T04:25:19.530
> 
> 标签：php, endianness

我正在尝试将二进制字符串解释为无符号大端整数，正如她在此处的说明：http: [//mimesniff.spec.whatwg.org/#matches-the-signature-for-mp4](http://mimesniff.spec.whatwg.org/#matches-the-signature-for-mp4)（第 4 点）

我不太确定我需要在这里做什么，但这是我的尝试：

```
// ONE
$box_size   = substr( $sequence, 0, 4 );
$box_size   = pack( 'C*', $box_size[0], $box_size[1], $box_size[2], $box_size[3] );
$box_size   = unpack( 'N*', $box_size );

// TWO
$box_size   = substr( $sequence, 0, 4 );
$box_size   = array_map( 'ord', str_split( $box_size ) );

// THREE
$box_size   = substr( $sequence, 0, 4 );
$box_size   = bindec( $box_size );

// FOUR
$box_size   = substr( $sequence, 0, 4);
$box_size   = (int) $box_size; 
```

我没有运气，老实说，我什至不确定结果应该是什么。有没有人明白这一点？我想我可能在打包和解包方面走在正确的轨道上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T02:14:27.193

我会继续发布评论作为答案然后......

要将某事物的“紧凑”位表示*解压缩*`unpack`为本机类型，只需使用正确的参数来表示您要解压缩的位的类型。在你的情况下：

```
$unpacked = unpack('N', $unsignedBigEndianInteger);
$int = $unpacked[1]; 
```

这使得 PHP 读取字节流，假设它表示一个无符号的大端长整数，并将其转换为 PHP 原生整数。

记住：

*   `pack`: “大型原生类型” → 挤入字节表示
*   `unpack`：紧凑的字节表示→“大型本机类型”

# ios - 从 iPad 中的 UITextfield 中删除不需要的边框

> ID：16051469
> 
> 赞同：0
> 
> 时间：2013-04-17T04:25:24.780
> 
> 标签：ios, objective-c, ipad, uitextfield

我`UITextField`在 iPad 中遇到奇怪的边框问题。下面的文本字段图像在任何 iphone 中看起来都很好。

![在此处输入图像描述](https://i.stack.imgur.com/WD4hr.png)

但是当我在 iPad 上打开同一个应用程序时，`UITextField`底部会出现奇怪的不需要的边框。请参阅下图了解我想要传达的内容。如何解决这个问题？

![在此处输入图像描述](https://i.stack.imgur.com/EiMPo.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:29:22.777

为 ipad 为文本字段设置的属性，如图所示，它在 ipad 中正确显示。可能是您为 ipad 设置了错误的图像或做了其他事情。

![为 ipad 设置的 textfield 属性](https://i.stack.imgur.com/Bzfcc.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:34:49.230

添加以下代码

```
urTextField.borderStyle = UITextBorderStyleNone; 
```

# java - 在本地连接到 herokupostgresql 时出错

> ID：16051470
> 
> 赞同：2
> 
> 时间：2013-04-17T04:25:34.527
> 
> 标签：java, hibernate, postgresql, heroku

我正在编写一个 struts2 应用程序并使用 hibernate 进行持久性。我在heroku上部署了may应用程序，一切正常，但是当我在本地运行它时，我得到：

```
 org.postgresql.util.PSQLException: FATAL:no pg_hba.conf entry for host "xx.xx.xxx.xxx", user "someuser", database "somedatabase", SSL off 
```

我知道问题是我需要通过 ssl 连接到数据库，但是如何在本地设置呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T05:30:45.043

将此添加到 JDBC 连接 URL 的末尾：

```
?ssl=true&sslfactory=org.postgresql.ssl.NonValidatingFactory 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T07:10:03.010

这里的关键是“SSL 关闭”。

您必须使用 SSL 连接到 Heroku。如何启用它取决于您使用的客户端，我猜是 PgJDBC，因为您使用的是 Java 和 Hibernate。

PgJDBC 手册的[SSL 部分](http://jdbc.postgresql.org/documentation/91/ssl.html)涵盖了您需要的内容。

# java - Java 计时器和文本字段

> ID：16051471
> 
> 赞同：0
> 
> 时间：2013-04-17T04:25:39.217
> 
> 标签：java, timer, textfield

我有一个面板，其中有一个不可编辑的文本字段。我希望能够`textField.setText(timer);`在面板中添加某种东西。我基本上只是希望 JTextArea 像这样显示它：0:0:0。

我尝试过制作计时器、TimerTasks、ActionListeners 和排序。我无法掌握这个窍门。也许是因为我在哪里添加了计时器？目前我尝试将其添加到`public void guiComponents() throws Exception{...}`. 此方法保存面板、它所在的框架和其他组件的所有属性。

也许我没有低估计时器的整个概念。最初，我尝试使用双重嵌套的 for 循环来完成此任务，但因为这必须在程序的其余部分运行时继续，所以我不能这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T04:30:43.210

不要为此使用 JTextField。使用 JLabel 显示文本。就像是：

```
import java.awt.*;
import java.awt.event.*;
import java.util.*;
import javax.swing.*;

public class TimerTime extends JFrame implements ActionListener
{
    JLabel timeLabel;

    public TimerTime()
    {
        timeLabel = new JLabel( new Date().toString() );
        getContentPane().add(timeLabel, BorderLayout.NORTH);
    }

    public void actionPerformed(ActionEvent e)
    {
        timeLabel.setText( new Date().toString() );
    }

    public static void main(String[] args)
    {
        TimerTime frame = new TimerTime();
        frame.setDefaultCloseOperation( EXIT_ON_CLOSE );
        frame.pack();
        frame.setVisible(true);

        int time = 1000;
        javax.swing.Timer timer = new javax.swing.Timer(time, frame);
        timer.setInitialDelay(1);
        timer.start();
    }
} 
```

# python - 如何在 OSX 上为 Python 应用程序启用 App 沙箱（Python 应用程序针对 Mac App Store）

> ID：16051478
> 
> 赞同：2
> 
> 时间：2013-04-17T04:26:05.623
> 
> 标签：python, sandbox, mac-app-store

首先，python 应用程序是针对 Mac App Store 的。苹果给我发邮件说我的应用没有启用沙盒。

如下：

> 亲爱的开发者，
> 
> 我们发现您最近交付的“ **InternetWorks** ”存在一个或多个问题。要处理您的交付，必须更正以下问题：
> 
> **未启用应用沙箱**- 以下可执行文件必须在**权利属性列表**中包含布尔值为 true的“ **com.apple.security.app-sandbox** ”权利。有关对您的应用程序进行沙盒化的更多信息，请参阅应用程序沙盒页面。
> 
>  **InternetWorks.app/Contents/MacOS/InternetWorks
> 
> 更正这些问题后，请转到“版本详细信息”页面并单击“准备上传二进制文件”。继续完成提交过程，直到应用状态为“等待上传”。然后，您可以提供更正后的二进制文件。
> 
> 问候，
> 
> 应用商店团队**

 **由于我的应用程序是用 Python 编写的，因此我不知道如何为其创建**权利属性列表**。

根据 Apple 的文档，权利属性列表是在 Xcode 项目中创建的，并且与可执行文件有某种关联。但同样，我的应用程序是用 Python 编写的，它只是几个 *.py 文件，我使用 py2app/cx_Freeze 工具将其打包到“my_app_name.app”可执行文件中。

那么，是否可以手动为我已经打包的 python 应用程序（My_App_name.app 文件）创建/制作一个权利属性列表文件，如果没有 XCode 项目我怎么能做到呢？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:48:24.777

对于某些上下文，在[xcode4中配置](/questions/tagged/xcode4 "show questions tagged 'xcode4'")`.entitlements` [plist](/questions/tagged/plist "显示标记为“plist”的问题")的界面如下所示。![截屏](https://i.imgur.com/jiqAaO6m.png)

它会自动在您`$(SOURCE_ROOT)`调用的`AppName.entitlements`.

`.plist`s 是 Apple 用于几乎所有“传统”unix 上的文本配置文件的 XML 文件。如果您在 OSX 上使用 Python 进行开发，您可能会发现 Python [plistlib](http://docs.python.org/2/library/plistlib.html)很有帮助。Apple 有幸编辑它们的方法是使用 XCode 本身（[在 XCode4 之前有一个独立的 Property List Editor.app](https://stackoverflow.com/questions/5268389/property-list-editor-after-installing-xcode-4)）。

在这种情况下，他们想要的默认值仅包含：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>com.apple.security.app-sandbox</key>
    <true/>
</dict>
</plist> 
```

我怀疑如果您只是将其粘贴到一个名为的文件中，`InternetWorks.entitlements`您将解决他们的问题。尽管您可能需要请求更多[可用权限](http://developer.apple.com/library/ios/#documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/EnablingAppSandbox.html#//apple_ref/doc/uid/TP40011195-CH4-SW5)。**

# gwt - 删除小部件和水平面板之间的空间

> ID：16051484
> 
> 赞同：1
> 
> 时间：2013-04-17T04:26:32.917
> 
> 标签：gwt, border-spacing

![图形用户界面元素](https://i.stack.imgur.com/cckPI.png)

您可以看到的内部矩形是一个水平面板。我在其中添加了 3 个按钮。我希望所有这些按钮都位于底部 - 水平面板的大部分。我尝试了以下代码行

```
margin-bottom: 0px; 
```

但它对按钮没有影响。有人可以就此向我提出任何建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T04:45:44.870

你需要做两件事

1）`horizontalPanel.setSpacing(0);`参考：[setSpacing](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/CellPanel.html#setSpacing%28int%29)

2）`horizontalPanle.setCellVerticalAlignment(widget, HasVerticalAlignment.Align_Bottom);`参考：[setCellVerticalAlignment](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/CellPanel.html#setCellVerticalAlignment%28com.google.gwt.user.client.Element,%20com.google.gwt.user.client.ui.HasVerticalAlignment.VerticalAlignmentConstant%29)

# android - admob - 如何在我的应用中阻止谷歌播放广告

> ID：16051489
> 
> 赞同：0
> 
> 时间：2013-04-17T04:27:07.830
> 
> 标签：android, admob

大多数时候只在我的应用中显示 Google Play 商店广告。我正在使用admob。有什么方法可以阻止我的应用中的谷歌播放广告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:50:35.620

I'm not sure why you would want to do this as you are cutting out part of your revenue but you can veto any ad url from SiteAndApps->AdFilters. Just add [https://play.google.com/store](https://play.google.com/store) to there.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:31:28.717

在您的 admob 设置中，您可以转到中介并选择您使用的网络。关闭自家广告可能会做到这一点，但可能会使您的填充率直线下降。

# jquery - jQuery 中 prop() 和 attr() 的区别以及何时使用 attr() 和 prop()

> ID：16051491
> 
> 赞同：80
> 
> 时间：2013-04-17T04:27:31.127
> 
> 标签：jquery, attr, prop

我在某些地方看到 .attr() 在 jQuery 中使用。在某些地方 .prop() 被使用。但是我在 SO 和 google 中搜索我很困惑。请告诉我这两者之间的确切区别以及何时使用它们.

我看过下面的链接 [jQuery attr vs. prop，有没有 props 的列表？](https://stackoverflow.com/questions/15057281/jquery-attr-vs-prop-there-are-a-list-of-props) [jQuery attr 与道具？](https://stackoverflow.com/questions/13247058/jquery-attr-vs-prop)

但我没有得到答案。请帮助我。在此先感谢。

在投反对票之前，请解释原因，然后我将在下一篇文章中更正。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-04-17T04:30:30.597

来自[文档](http://api.jquery.com/prop/)

> 属性和属性之间的区别在特定情况下可能很重要。在 jQuery 1.6 之前，.attr() 方法在检索某些属性时有时会考虑属性值，这可能会导致行为不一致。从 jQuery 1.6 开始，.prop() 方法提供了一种显式检索属性值的方法，而 .attr() 检索属性。

例子

> 例如，应使用 .prop() 方法检索和设置 selectedIndex、tagName、nodeName、nodeType、ownerDocument、defaultChecked 和 defaultSelected。在 jQuery 1.6 之前，可以使用 .attr() 方法检索这些属性，但这不在 attr 的范围内。这些没有对应的属性，只是属性。

**评论后更新**

您可以为 HTML 元素设置属性。您在编写源代码时定义它，一旦浏览器解析您的代码，将创建相应的 DOM 节点，这是一个具有属性的对象。

简单的例子可以是..

```
<input type="test" value="test" id="test" /> 
```

这里的**type、value、id**是属性。浏览器渲染后，你会得到其他属性，如 **align、alt、autofocus、baseURI、checked**等。

如果您想了解更多关于此的[链接](http://jq4you.blogspot.com/2013/04/jquery-attr-vs-prop-difference.html)

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2013-04-17T04:35:03.093

`.attr()`更改该 HTML 标记的属性。

`.prop()`根据 DOM 树更改该 HTML 标记的属性。

正如此链接中的示例所示。输入字段可以具有属性“值”。这将等于您输入的默认值。如果用户更改输入字段中的值，则 DOM 树中的属性“值”会更改，但保留原始属性。

所以基本上，如果您想为 HTML 标签的属性设置默认值，请使用该`.attr()`函数。如果用户可以更改该值（例如输入、复选框、收音机等），请使用该`.prop()`函数获取最新值。

**参考：** [HTML：属性和属性的区别](http://jquery-howto.blogspot.com/2011/06/html-difference-between-attribute-and.html)

**示例片段**

```
$(document).ready(function() {
  console.log($('#test').attr('value') + " - With .attr()");

  $('#answer').click(function() {
    console.log($('#test').attr('value') + " - With .attr()");
    console.log($('#test').prop('value') + " - With .prop()");
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<div>Change the input value and check the console...</div>
<input type="text" id="test" value="Sample">
<button id="answer">Click Me</button>
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-17T04:30:20.640

JQuery 是一个不断变化的库，有时他们会定期改进。.attr() 用于从 HTML 标记中获取属性，虽然它功能完善，但后来添加了 .prop() 以更具语义性，并且它更适用于像“checked”和“selected”这样的无值属性。

建议如果您使用的是更高版本的 JQuery，您应该尽可能使用 .prop()。

# android - MySQLNonTransientConnectionException: Could not create connection to database server

> ID：16051493
> 
> 赞同：3
> 
> 时间：2013-04-17T04:27:40.773
> 
> 标签：android, mysql, jdbc

I am dealing with a strange problem connecting to my MySQL database on Amazon RDS using JDBC. I have two different Android phones on the same network running the same code. One connects without any problems. The other is giving me the following exception:

```
com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Could not create connection to database server.
    at java.lang.reflect.Constructor.constructNative(Native Method)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.Util.getInstance(Util.java:386)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1014)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:988)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:974)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:919)
    at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2547)
    at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2283)
    at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:822)
    at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)
    at java.lang.reflect.Constructor.constructNative(Native Method)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:404)
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:317)
    at java.sql.DriverManager.getConnection(DriverManager.java:175)
    at java.sql.DriverManager.getConnection(DriverManager.java:209)
    at edu.ucsb.cs.epsilon.ucsb360.DatabaseManager.Connect(DatabaseManager.java:32)
    at edu.ucsb.cs.epsilon.ucsb360.Global.applicationResumed(Global.java:31)
    at edu.ucsb.cs.epsilon.ucsb360.MainActivity.onResume(MainActivity.java:54)
    at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1236)
    at android.app.Activity.performResume(Activity.java:4625)
    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2834)
    at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2889)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1303)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:156)
    at android.app.ActivityThread.main(ActivityThread.java:5045)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    at dalvik.system.NativeStart.main(Native Method)
Caused by: android.os.NetworkOnMainThreadException
    at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1190)
    at java.net.InetAddress.lookupHostByName(InetAddress.java:394)
    at java.net.InetAddress.getAllByNameImpl(InetAddress.java:245)
    at java.net.InetAddress.getAllByName(InetAddress.java:220)
    at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:249)
    at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
    at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2461)
    at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2498) 
```

The database only shows 1 active connection, so I know it is not because of too many open connections. I have tried rebooting the server, but it didn't help. I am using the MySQL JDBC Connector/J version 5.1.23\. The phone that works is running Android version 2.3.5 and the one that doesn't work is running Android version 4.0.4\. Does anyone have any ideas as to what might be wrong?

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:33:04.067

```
Caused by: android.os.NetworkOnMainThreadException 
```

You can't do network IO on the main thread. Move it to an AsyncTask or thread.

# ios - 如何在 iphone 应用程序中获取数据时在 sqlite 查询中传递变量

> ID：16051494
> 
> 赞同：1
> 
> 时间：2013-04-17T04:27:44.487
> 
> 标签：ios, objective-c, sql, sqlite

我从 sqlite 表中获取数据，我想传递变量，以便如果 sub_Catgeory 等于该变量，那么它应该获取记录。

```
 const char *sql = "select * from category where sub_Category=appDelegate.sub_Category"; 
```

同样，如果不使用 appDelegate.Sub_Category 变量，那么它工作正常

```
 const char *sql = "select * from category where sub_Category='Glucagon'"; 
```

我的完整代码

```
 + (void) getInitialData:(NSString *)dbPath {

     MultipleDetailViewsWithNavigatorAppDelegate *appDelegate = (MultipleDetailViewsWithNavigatorAppDelegate *)[[UIApplication sharedApplication] delegate];

     if (sqlite3_open([dbPath UTF8String], &database) == SQLITE_OK) {

        //const char *sql = "select * from category where sub_Category='Glucagon'";

       NSLog(@"Sub Category is %@",appDelegate.subCategory);

       const char *sql = "select * from category where sub_Category='appDelegate. subcategory'";

       sqlite3_stmt *selectstmt;
       if(sqlite3_prepare_v2(database, sql, -1, &selectstmt, NULL) == SQLITE_OK {

         while(sqlite3_step(selectstmt) == SQLITE_ROW) {

            NSInteger primaryKey = sqlite3_column_int(selectstmt, 0);
            Coffee *coffeeObj = [[Coffee alloc] initWithPrimaryKey:primaryKey];
            coffeeObj.category=sqlite3_column_int(selectstmt,1);
            coffeeObj.sub_Category = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 2)];
            coffeeObj.content_Type = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 3)];
            coffeeObj.content_Title = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt,4)];

            coffeeObj.publisher = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 5)];
            coffeeObj.content_Description = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 6)];
            coffeeObj.content_Id = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 7)];
            coffeeObj.content_Source = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 8)];

            int count=[appDelegate.arrayOneC count];

            NSLog(@"count is beofore getting values %d",count);

            [appDelegate.arrayOneC addObject:coffeeObj];

            int countone=[appDelegate.arrayOneC count];

            NSLog(@"count is after getting values %d",countone);

            [coffeeObj release];
        }
    }
}
else
    sqlite3_close(database); //Even though the open call failed, close the database connection to release all the memory.
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T04:32:14.233

你可以这样做，

假设你已经声明`static sqlite3_stmt *selectStmt = nil;`了一些地方

```
const char *sqlStatement = "select * from category where sub_Category=?";

if(sqlite3_prepare_v2(database, sqlStatement, -1, &selectStmt, NULL) == SQLITE_OK) 
{
    sqlite3_bind_text(selectStmt, 1, [appDelegate.sub_Category  UTF8String], -1, SQLITE_TRANSIENT);
    while(sqlite3_step(selectStmt) == SQLITE_ROW) 
    {
            //Process data
    }
}

//Reset the select statement.
sqlite3_reset(selectStmt);
selectStmt = nil; 
```

它被称为绑定值到准备好的语句。[在这里](http://www.sqlite.org/c3ref/bind_blob.html)查看更多详细信息。

***编辑——见下面你编辑的函数。***

```
+(void)getInitialData:(NSString *)dbPath
{
    MultipleDetailViewsWithNavigatorAppDelegate *appDelegate = (MultipleDetailViewsWithNavigatorAppDelegate *)[[UIApplication sharedApplication] delegate];
    if (sqlite3_open([dbPath UTF8String], &database) == SQLITE_OK)
    {
        NSLog(@"Sub Category is %@",appDelegate.subCategory);
        const char *sql = "select * from category where sub_Category=?";
        sqlite3_stmt *selectstmt;
        if(sqlite3_prepare_v2(database, sql, -1, &selectstmt, NULL) == SQLITE_OK)
        {
            sqlite3_bind_text(selectStmt, 1, [appDelegate.sub_Category  UTF8String], -1, SQLITE_TRANSIENT);
            while(sqlite3_step(selectstmt) == SQLITE_ROW)
            {
                NSInteger primaryKey = sqlite3_column_int(selectstmt, 0);
                Coffee *coffeeObj = [[Coffee alloc] initWithPrimaryKey:primaryKey];
                coffeeObj.category=sqlite3_column_int(selectstmt,1);
                coffeeObj.sub_Category = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 2)];
                coffeeObj.content_Type = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 3)];
                coffeeObj.content_Title = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt,4)];
                coffeeObj.publisher = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 5)];
                coffeeObj.content_Description = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 6)];
                coffeeObj.content_Id = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 7)];
                coffeeObj.content_Source = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 8)];
                int count=[appDelegate.arrayOneC count];
                NSLog(@"count is beofore getting values %d",count);
                [appDelegate.arrayOneC addObject:coffeeObj];
                int countone=[appDelegate.arrayOneC count];
                NSLog(@"count is after getting values %d",countone);
                [coffeeObj release];
            }
        }
    }
    else
        sqlite3_close(database);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-17T04:33:06.753

尝试这个。

第一种方式。

```
NSString *queryString = [NSString stringWithFormat:@"select * from category where sub_Category='%@'", appDelegate.subCategory];
const char *sqlQuery = [queryString UTF8String];

     if(sqlite3_prepare_v2(database, sqlQuery, -1, &selectStatement, NULL) == SQLITE_OK){
                while (sqlite3_step(selectStatement) == SQLITE_ROW){
    //Fetching your data logic
    }
} 
```

第二种方式。

```
const char *sqlStatement = "select * from category where sub_Category=?";

if(sqlite3_prepare_v2(database, sqlStatement, -1, &selectStmt, NULL) == SQLITE_OK) 
{
    sqlite3_bind_text(selectStmt, 1, [appDelegate.subCategory  UTF8String], -1, SQLITE_TRANSIENT);
    while(sqlite3_step(selectStmt) == SQLITE_ROW) 
    {
            //Process data
    }
} 
```

感谢 HarshIT、rmaddy 和 Jennis。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-17T04:33:32.243

尝试这个 ：：

```
NSString *selectSQL = [NSString stringWithFormat:@"select * from category where sub_Category = \"%@\"", appDelegate.subCategory];

const char *sql = [selectSQL UTF8String];
sqlite3_stmt *searchStatement;

if (sqlite3_prepare_v2(dbName, sql, -1, &searchStatement, NULL) == SQLITE_OK)
{
    while (sqlite3_step(searchStatement) == SQLITE_ROW)
    {

    }
}
sqlite3_finalize(searchStatement); 
```

希望，它会帮助你。

谢谢。

# zend-framework2 - 如何从 zf 2 中的表单调用模型中的函数？

> ID：16051495
> 
> 赞同：0
> 
> 时间：2013-04-17T04:27:54.400
> 
> 标签：zend-framework2

我正在使用 zend 框架 2。我想从 zend 形式调用模型中的函数。

情况是我有一个组合框，我需要绑定数据库中的数据以填充其选项和值。

这是我的 zend 形式的选择标签

```
$this->add(array(

    'name' => 'ddlcountry',

    'type' => 'Zend\Form\Element\Select',

    'options' => array(

        'label' => 'Country',

        'value_options' => (here I've to call function),

    ),

)); 
```

对于这个值选项，我想调用下面模型中的函数是我在模型中的函数：

```
public function fetchcountry()
{

    $this->adapter = $this->getServiceLocator()->get('db');

    $dbAdapterConfig = $this->adapter;       

    $dbAdapter = $dbAdapterConfig;        

    $driver = $dbAdapter->getDriver();

    $connection = $driver->getConnection();

    $result = $connection->execute("CALL sp_showcountry()");

    $statement = $result->getResource();

    $resultdata = $statement->fetchAll(\PDO::FETCH_OBJ);

    return $resultdata;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:36:19.507

在你写这样一个问题之前，请至少检查这个页面上的前 10 个问题，因为你的问题最近被问了好几次；）

请参考我在此处提供的答案：

*   [如何从不同的模型中获取数据以供选择？](https://stackoverflow.com/questions/16022300/how-to-get-data-from-different-model-for-select)

或者参考我的博文，里面详细介绍了你的问题

*   [**Zend\Form\Element\Select 和数据库值**](http://samminds.com/2013/03/zendformelementselect-and-database-values/)

# asp.net - 如何从gridview检索检查行的主键

> ID：16051497
> 
> 赞同：2
> 
> 时间：2013-04-17T04:28:12.577
> 
> 标签：asp.net, oracle10g

你能告诉我如何在网格视图中检索选中行的主键吗？我不想显示该值或其他内容，只需使用它来修改该特定行（删除、更改列值等）。我在后端使用 Oracle 10g。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T04:30:27.433

使用`DataKeys`gridview
详细信息：- [http://msdn.microsoft.com/en-in/library/system.web.ui.webcontrols.gridview.datakeys.aspx](http://msdn.microsoft.com/en-in/library/system.web.ui.webcontrols.gridview.datakeys.aspx)

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False"  
    DataKeyNames="emp_id"> 
```

将`DataKeyNames`您的主键值放在此字段中。
详情链接
[http://www.codeproject.com/Articles/23833/DataKeyNames](http://www.codeproject.com/Articles/23833/DataKeyNames)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T05:11:29.253

在 Aspx.Page...

```
<asp:GridView ID="gv" runat="server" AutoGenerateColumns="False"  
    DataKeyNames="emp_id"> 
```

在 Cs.Page 中，在 Click 事件中。

```
for(int i=0;i<gv.rows.count;i++)
{
    GridviewRow row=gv.rows[i];
    cheakbox c1=(Cheakbox)row.FindControl("chkId");
    if(c1.cheaked)
    {
         int id=Convert.toInt32(gv.Datakeys[i]);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T05:15:35.960

尝试这个

```
 <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
        DataKeyNames="ProductId" AllowPaging="True" 
        BackColor="LightGoldenrodYellow" BorderColor="Tan" BorderWidth="1px" 
        CellPadding="2" ForeColor="Black" GridLines="None" 
        onpageindexchanging="GridView1_PageIndexChanging" 
        onrowediting="GridView1_RowEditing" onrowupdating="GridView1_RowUpdating" 
        onrowcancelingedit="GridView1_RowCancelingEdit" 
        onrowdeleting="GridView1_RowDeleting" Width="603px">
  </asp:GridView> 
```

现在在你的代码后面，例如更新

```
protected void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)
{
    int productid=int.Parse(GridView1.DataKeys[e.RowIndex].Values[0].ToString());
} 
```

# perl - 用于通过 API 附加文件的 perl 的多部分实体不起作用

> ID：16051505
> 
> 赞同：0
> 
> 时间：2013-04-17T04:29:02.020
> 
> 标签：perl, api, attachment, multipart

我有以下代码并想使用 API 附加文件。此代码向我提供 URL，但未附加文件。

```
#!/usr/bin/perl

use LWP::UserAgent; 
$ua = LWP::UserAgent->new;
my $response = $ua->post(Content_Type => 'application/xml');
#$ua->agent("Mozilla 8.0 blah...");

use HTTP::Request::Common qw(POST);
use LWP::UserAgent(POST);

my $request=(POST "http://Server/Test.jsp", 
Content =>[
        external => "false",
        Filedata => "C:/Location.jpg"
          ]);

#$request = $ua->request($request);
my $results=$ua->request($request);
$content = $request->content; 

print $content; 
exit; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:52:01.400

好吧，首先您必须指定正确的内容类型。

```
my $request=(POST "http://Server/watson/api/bug/addAttachmentAPI.jsp", 
Content_Type => 'form-data',
Content =>[
        appGUID => "Test GUID", 
```

其次，文件规范必须是可选标题字段/值对形式的数组引用`[ $file, $name, ... ]`（`...`如果不包含标题，则会猜测文件的内容类型）。

```
 Filedata => ["C:Test Location/Upload/APIs.jpg", 'APIs.jpg'],
  ]); 
```

有关详细信息，请参阅[HTTP::Request::Common](https://metacpan.org/module/HTTP::Request::Common)。

# .net - 在 .net 中注册 com interop dll

> ID：16051506
> 
> 赞同：1
> 
> 时间：2013-04-17T04:29:03.500
> 
> 标签：.net, visual-studio-2010, com-interop, installshield

我正在开发一个具有 4 个 .net com 互操作 dll 的 Installshield 项目。

*   我使用命令`C:\Windows\Microsoft.NET\Framework\v4.0.30319\Regasm.exe /tlb myassembly.dll /codebase`来注册程序集。
*   现在我的问题是，当机器上安装了 VS2010 时，Installer 可以正常工作。但是如果机器上没有安装VS2010，只安装了dot net Framework，Installer不能正常工作并抛出错误“确保在系统注册表中输入了对象”。
*   任何机构都可以告诉我问题的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:17:57.093

构建时的 COM 提取用于非托管 DLL。.NET COM Interop 属性适用于 COM Visible。这将导致 InstallShield 在构建过程中执行 regasm /regfile 并将结果收集到注册表中。在安装过程中，注册表将被写入，而无需调用 Regasm 进程。

MSDN 上的 Regasm 中有一条关于 /regfile 未执行/捕获用户注册代码的说明。如果此过程仍然不够好，请使用诸如 InstallWatch 之类的工具来捕获/比较注册表的前后，以观察“缺少”的内容，然后在注册表视图中的 InstallShield 中进行创作。重建，重置虚拟机并冲洗并重复，直到它工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-11T11:11:41.843

这个“C:\Windows\Microsoft.NET\Framework\v4.0.30319\Regasm.exe /tlb myassembly.dll /codebase”只有在目标机器上安装了 .NET 4.0 或更高版本时才有效。对于以前的 .NET 版本，从 2.0.5077 文件夹运行 Regasm.exe：“C:\Windows\Microsoft.NET\Framework\v2.0.5077\Regasm.exe /tlb myassembly.dll /codebase”

有关安装的 .NET 版本的更多信息，请参阅注册表 HKLM\Software\Microsoft.NET Framework\

# c# - InternalsVisibleTo ，不同的成员变量到不同的程序集

> ID：16051510
> 
> 赞同：0
> 
> 时间：2013-04-17T04:29:52.330
> 
> 标签：c#, .net, oop, internals, internalsvisibleto

我在项目 A 中有一个类 A_class。在类 A_class 中，有一个构造函数

```
internal A_class()
 {
  //constructor logic
 } 
```

, 和一个成员变量 internal int A_member;

现在有两个朋友程序集，说程序集 B 和程序集 C 我希望程序集 B 只能访问 A_Class() 我希望程序集 C 只能访问 A_member 这样，程序集 B 不能访问 A_member，和程序集 C 不能访问 A_class()

可能吗 ？或者还有其他选择吗？

如果我使用

```
[assembly: InternalsVisibleTo("B")]
[assembly: InternalsVisibleTo("C")] 
```

然后 B 和 C 都可以访问 A_class() 和 A_Member，这是不希望的

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T04:32:30.753

属性 InternalsVisibleTo 仅在程序集级别应用

> 该属性应用于程序集级别。

[http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)

您无法根据需要提供对类和成员的差异化访问。

# google-places-api - 从参考或 ID 中提取 CID

> ID：16051514
> 
> 赞同：0
> 
> 时间：2013-04-17T04:30:12.753
> 
> 标签：google-places-api

是否可以从参考或企业 ID 中提取企业的 CID？我宁愿不必重新编写所有脚本来获取业务的规范 URL，因为我已经获得了参考和 ID。

我相信这个问题与之前提出的问题相反。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T14:32:34.983

没有直接的方法可以这样做。一种间接的方法是进行地点详细信息请求，该请求将返回`url`字段中的 cid。

要执行地点详细信息电话，请按照他们[在此地址](https://developers.google.com/places/documentation/details#PlaceDetailsRequests)的文档进行操作。这非常简单，尽管必须执行额外的调用有点烦人。我不了解你，但由于这个原因，我从来没有非常喜欢 Places API - 太多的请求没有足够的数据。

# scope - 在 Scheme 的 lambda 中使用 let 变量

> ID：16051518
> 
> 赞同：2
> 
> 时间：2013-04-17T04:30:28.027
> 
> 标签：scope, scheme

这个问题的范围类似于：[在 R6RS 方案中，有没有办法让当前环境与 eval 一起使用？](https://stackoverflow.com/questions/6584818/in-r6rs-scheme-is-there-a-way-to-get-the-current-environment-for-use-with-eval)但我想更进一步，问你如何补救这样的事情。

我的问题进一步令人困惑，因为在我的情况下`'(+ x y)`是任意未评估的 lambda 语句。未评估，因为它可能包含对作为 let 一部分的变量的调用（并且由于 Scheme 不相信该过程将在包含这些变量的环境中调用，而当前的环境不包含这些变量，因此它会触发未定义的标识符错误） . 所以问题就变成了：我怎样才能重组我的代码，这样这个范围界定的噩梦就不再是问题了？每当调用 lambda 时，我仍然希望能够使用 let 中的环境变量。

我在用着`Pretty Big`

目的是在 Scheme 中创建类。到目前为止，我的方法相当大（没有双关语），但看起来像：

```
 (define (dispatch msg methods args)
      (if (null? methods) (display "Method signature not found.")
          (let (
                (m-name (caar methods))
                (m-args (cadar methods))
                (m-body (caddar methods)))
            (if (and (eq? msg (caar methods)) (eq? (length args) (length (cadar methods))))
                `(lambda ,m-args ,m-body)
                (dispatch msg (cdr methods) args)))))

    (define (build-lets c-def)
      (let (
            (i-vars (cadr c-def))
            (meths (caddr c-def)))
        (eval `(append ',i-vars (list (list 'methods '',meths))))))

    (define (new c-def . args)
      (apply (eval `(lambda ,(map cadr (cadr c-def))
               (let* ,(build-lets c-def)
                 (lambda (msg . args)
                   (letrec ((meth (dispatch msg methods args)))
                     (apply meth args))))))
             args)) 
```

其中 c-def 是形式的类 def（比如一个点）

```
 '(();Name of parent
      ((yvalue y) (xvalue x)) ;Instance variables: (i-var constructor-arg)
      ((getx () xvalue) ;Methods, ((name args body) ...)
       (setx (x) (set! xvalue x))))) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T06:38:59.287

这并没有实现您想到的所有语法，但它可能说明了干净地实现它所需的技术。

```
(define-syntax make-object
  (syntax-rules ()
    [(__ ([ivar ival] ...) ([method-name args body ...] ...))
      (let ([ivar ival] ...)
        (λ (msg . oargs)
          (cond
            [(eq? 'method-name msg)
              (apply (λ args body ...) oargs)] ...
            [else
              (error 'object-system "unknown message" msg)])))]))

(define o (make-object ([xvalue 'x])
                       ([getx () xvalue]
                        [setx (x) (set! xvalue x)])))

(o 'getx) => x
(o 'setx 'blah)
(o 'getx) => blah 
```

诀窍是编写一个使闭包的宏。实例变量进入`let`包含闭包的词法范围（the）。闭包是调度程序。这些方法是在调度程序中定义的 lambda，因此实例变量与方法在同一范围内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:51:37.050

如果您可以`let`参与评估，那么它将起作用。下面是一个例子：

与您的代码类似（但更简单）的东西不起作用：

```
(define (hello m)
  (let ((msg m))
    (eval '(print msg)))) 
```

让 eval 的一部分使它起作用：

```
(define (hello m)
  (eval `(let ((msg ,m))
           (print msg)))) 
```

# python - 执行 3d 绘图时 python 冻结

> ID：16051523
> 
> 赞同：1
> 
> 时间：2013-04-17T04:31:06.263
> 
> 标签：python, matplotlib, differential-equations

通过[绘制轨道轨迹](https://stackoverflow.com/questions/16049390/plotting-orbital-trajectories-in-python)，我们有以下代码。这些值已更改为可以工作的已知 IC。

如果这段代码是正确的（虽然不可能），它会生成 ![在此处输入图像描述](https://i.stack.imgur.com/Lrxz0.png)

运行此代码只会冻结我的计算机或输出绝对错误的图。有人可以帮我找到解决此问题的方法吗？

```
import numpy as np
from scipy.integrate import odeint
import matplotlib.pyplot as plt
from numpy import linspace
from mpl_toolkits.mplot3d import Axes3D

mu = 398600
# r0 = [-149.6 * 10 ** 6, 0.0, 0.0]  #  Initial position
# v0 = [29.9652, -5.04769, 0.0]      #  Initial velocity
u0 = [-4069.503, 2861.786, 4483.608, -5.114, -5.691, -5]

def deriv(u, dt):
    n = -mu / np.sqrt(u[0] ** 2 + u[1] ** 2 + u[2] ** 2)
    return [u[3],     #  dotu[0] = u[3]'
            u[4],     #  dotu[1] = u[4]'
            u[5],     #  dotu[2] = u[5]'
            u[0] * n,       #  dotu[3] = u[0] * n
            u[1] * n,       #  dotu[4] = u[1] * n
            u[2] * n]       #  dotu[5] = u[2] * n

dt = np.arange(0.0, 24 * 3600, .01)   #  Time to run code in seconds'
u = odeint(deriv, u0, dt)
x, y, z, x2, y2, z2 = z.T

fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
ax.plot(x, y, z)
plt.show() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T08:14:14.070

您遇到数值问题有几个原因：首先，您不应该要求 ODE 求解器返回 8640000 点的数据。其次，您的参数和初始条件包含大量数字，您可以通过引入适当[的无量纲量](http://en.wikipedia.org/wiki/Dimensionless_quantity)来摆脱它们。

设置后，下面的代码会产生合理的输出：

```
import numpy as np
from scipy.integrate import odeint
import matplotlib.pyplot as plt
from numpy import linspace
from mpl_toolkits.mplot3d import Axes3D

u0 = [0, 0, 1, 0, -1, 0]
mu = .1

def deriv(u, dt):
    n = -mu / np.sqrt(u[0] ** 2 + u[1] ** 2 + u[2] ** 2)
    return [u[3],     #  dotu[0] = u[3]'
            u[4],     #  dotu[1] = u[4]'
            u[5],     #  dotu[2] = u[5]'
            u[0] * n,       #  dotu[3] = u[0] * n
            u[1] * n,       #  dotu[4] = u[1] * n
            u[2] * n]       #  dotu[5] = u[2] * n

times = np.linspace(0.0, 200, 100)
u = odeint(deriv, u0, times)
x, y, z, x2, y2, z2 = u.T

fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
ax.plot(x, y, z)
plt.show() 
```

结果是![结果](https://i.stack.imgur.com/IDhRx.png)

# javascript - 如何通过 onclick 多次更改变量的值？

> ID：16051526
> 
> 赞同：0
> 
> 时间：2013-04-17T04:31:13.410
> 
> 标签：javascript, html

我是 JS 新手，最近我发现了一个 SDK，用于使用 html/css/js 创建增强现实应用程序，称为 wikiitude。当您在下面看到时，您会看到一个按钮，单击该按钮会调用 scaleModel 函数，该函数随后会为 scale 属性创建新值，这将允许我的应用程序显示的 3d 模型的大小增加。我只想能够创建一个按钮，每次按下它都会增加值，而另一个按钮会在每次按下它时减小值。这样我将有两个按钮，一个用于增加尺寸，另一个用于减小尺寸。我非常感谢您的帮助。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="viewport" content="target-densitydpi=device-dpi, width = 540, user-scalable = 0" />
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>My ARchitect World</title>
<script src="architect://architect.js"></script>
<script>
var model;
var location;

function createModel()
{
AR.logger.activateDebugMode();
AR.logger.info("info");

var modelOptions = {
    scale: {x: 0.1, y: 0.1, z: 0.1},
    rotate: {heading: -30},
    rotate: {tilt: 30},
    translate: {y: -0.5}
};

model = new AR.Model("my3dModel.wt3", modelOptions);
location = new AR.RelativeLocation(null, 0, -50, 0);
var myGeoObject = new AR.GeoObject(location, {drawables: {cam: model}});
}

function scaleModel() {
model.scale.x = 0.5;
model.scale.y = 0.5;
model.scale.z = 0.5;
}

</script>
</head> 
```

创建动画比例

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:36:56.227

If you make a new function like the `scaleModel()` function that multiplies the scale by an amount instead of setting it:

```
function scaleModelBy(amount) {
    model.scale.x = model.scale.x * amount;
    model.scale.y = model.scale.y * amount;
    model.scale.z = model.scale.z * amount;
} 
```

You can then call it in some buttons:

```
<button onclick="scaleModelBy(2);">Scale up</button>
<button onclick="scaleModelBy(0.5);">Scale down</button> 
```

# jsf - 如何使用页面导航前创建的managedBean

> ID：16051527
> 
> 赞同：0
> 
> 时间：2013-04-17T04:31:14.650
> 
> 标签：jsf, managed-bean, transient

```
Page foo.xhtml
--------------    
<f:view transient="#{fooBean.transient}">
    ...
</f:view>

@ViewScoped("fooBean")
public class FooBean {
   private boolean _transient = false;

   public void setTransient(boolean t) {
      _transient = t;
   }

   public boolean isTransient() {
      return _transient;
   }
} 
```

在页面bar.xhtml的调用应用过程中，创建了一个fooBean，fooBean.setTransient(true)，默认为false。然后导航到页面 foo.xhml，如何让页面 foo.xhtml 使用调用应用阶段创建的 fooBean？

我尝试使用 preRenderEvent 将 fooBean 设置为由

```
FacesContext context = FacesContext.getCurrentInstance();
context.getApplication ().getELResolver().setValue(context.getELContext(), null, "fooBean", fooBean); 
```

但为时已晚。UIViewRoot.transient 已在`buildView()`. 我想知道`buildView()`在调用之前是否有任何回调，`#{fooBean.transient}`以便我可以将其设置`fooBean`为由 JSF 管理。

感谢帮助。

# java - 使用会话 bean 通过 JPA 插入数据

> ID：16051531
> 
> 赞同：0
> 
> 时间：2013-04-17T04:31:24.933
> 
> 标签：java, servlets, jpa, ejb

在一个servelt中，我尝试调用会话bean方法通过JPA将数据插入数据库。插入过程写在会话 bean 中。

我尝试了另一个示例，我从数据库中选择数据。“选择”效果很好。但我不知道为什么插入不起作用。

错误信息是：

HTTP 状态 500

描述：服务器遇到一个内部错误 () 阻止它完成这个请求。

异常：javax.ejb.EJBException

注意：GlassFish Server Open Source Edition 3.0.1 日志中提供了异常的完整堆栈跟踪及其根本原因。

我认为“tx.commit()”有问题，当我评论它时没有错误。但我不知道究竟是什么问题。

这是豆类

```
@Stateless
@LocalBean
public class testSession {

  public testSession() {
    // TODO Auto-generated constructor stub
  }

  public void insertData(){
    EntityManagerFactory emf;
    EntityManager em;

    //the Entity Class-Category
    Category cat=new Category();

    //set value
    cat.setId(5);
    cat.setName("test cat");

    //the "test" is the persist unit in persistence.xml 
    emf=Persistence.createEntityManagerFactory("test");
    em=emf.createEntityManager();

    EntityTransaction tx=em.getTransaction();
    tx.begin();
    em.persist(cat);
    tx.commit();
    em.close();
    emf.close();

  }
} 
```

在小服务程序中

```
@WebServlet("/testServlet")
public class testServlet extends HttpServlet {
private static final long serialVersionUID = 1L;

@EJB
testSession ts;

public testServlet() {
   super();
}

protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    PrintWriter out=response.getWriter();
    out.print("<html><body>");
    //call the method in the session bean to insert data
    ts.insertData();
    out.print("</body></html>");
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:58:58.920

您需要通过@PersistenceContext 注入EntityManager 本身是由容器使用persistence.xml 中的信息创建的，因此要在运行时使用它，我们只需请求将其注入我们的组件之一。我们通过@PersistenceContext 做到这一点

@PersistenceContext 注释可用于任何 CDI bean、EJB、Servlet、Servlet 侦听器、Servlet 过滤器或 JSF ManagedBean。如果您不使用 EJB，则需要使用 UserTransaction 开始并手动提交事务。EntityManager 的任何创建、更新或删除方法都需要一个事务才能工作。

例子：

```
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

@Stateless
@LocalBean
public class testSession {

@PersistenceContext(unitName = "MyUNIT_PERSIS_IMPORTANT_View_THE_persistence.XML")
    private EntityManager entityManager;

  public testSession() {
    // TODO Auto-generated constructor stub
  }

  public void insertData(){
    //the Entity Class-Category
    Category cat=new Category();

    //set value
    cat.setId(5);
    cat.setName("test cat");

    entityManager.persist(cat);

  }
}

Reference
http://tomee.apache.org/examples-trunk/injection-of-entitymanager/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T13:43:57.243

我在这个演示中使用了 maven

演示

```
https://mega.co.nz/#!AxtRVQzB!MdwwOXA1e_VayWgwIdxGdREhd69QDb6la0yT0mLMaKA 
```

到 servlet 的 url

```
http://<HOST>/use-session-bean-to-insert-data-with-jpa/testServlet 
```

SQL 创建

```
CREATE TABLE category (
id INT NOT NULL AUTO_INCREMENT, 
`name` VARCHAR(200), 
PRIMARY KEY (id)); 
```

持久性.xml

```
...
<persistence-unit name="test" transaction-type="JTA">
.. 
```

Java 小服务程序

```
import com.mycompany.ejb.testSession;
import java.io.IOException;
import java.io.PrintWriter;
import javax.ejb.EJB;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 *
 * @author I2B Boris
 */
@WebServlet(name = "testServlet", urlPatterns = {"/testServlet"})
public class testServlet extends HttpServlet {

    @EJB
    testSession ts;

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        PrintWriter out = response.getWriter();
        out.print("<html><body>");
        //call the method in the session bean to insert data
        ts.insertData();
        out.print("</body></html>");
    }
} 
```

Java EJB

```
package com.mycompany.ejb;

import com.mycompany.entities.Category;
import javax.ejb.Stateless;
import javax.ejb.LocalBean;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

/**
 *
 * @author I2B Boris
 */
@Stateless
@LocalBean
public class testSession {

    @PersistenceContext(unitName = "test")
    private EntityManager entityManager;

    public void insertData() {
        //the Entity Class-Category
        Category cat = new Category();

        //set value
        cat.setId(5);
        cat.setName("test cat");

        entityManager.persist(cat);

    }
} 
```

实体

```
package com.mycompany.entities;

import java.io.Serializable;
import javax.persistence.*;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Size;
import javax.xml.bind.annotation.XmlRootElement;

/**
 *
 * @author I2B Boris
 */
@Entity
@Table(name = "category")
@XmlRootElement
@NamedQueries({
    @NamedQuery(name = "Category.findAll", query = "SELECT c FROM Category c"),
    @NamedQuery(name = "Category.findById", query = "SELECT c FROM Category c WHERE c.id = :id"),
    @NamedQuery(name = "Category.findByName", query = "SELECT c FROM Category c WHERE c.name = :name")})
public class Category implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Basic(optional = false)
    @NotNull
    @Column(name = "id")
    private Integer id;
    @Size(max = 200)
    @Column(name = "name")
    private String name;

    public Category() {
    }

    public Category(Integer id) {
        this.id = id;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @Override
    public int hashCode() {
        int hash = 0;
        hash += (id != null ? id.hashCode() : 0);
        return hash;
    }

    @Override
    public boolean equals(Object object) {
        // TODO: Warning - this method won't work in the case the id fields are not set
        if (!(object instanceof Category)) {
            return false;
        }
        Category other = (Category) object;
        if ((this.id == null && other.id != null) || (this.id != null && !this.id.equals(other.id))) {
            return false;
        }
        return true;
    }

    @Override
    public String toString() {
        return "com.mycompany.entities.Category[ id=" + id + " ]";
    }

} 
```

# ios - In-App Store Product View，在IOS 5上不工作，如何测试？

> ID：16051538
> 
> 赞同：2
> 
> 时间：2013-04-17T04:32:09.533
> 
> 标签：ios, objective-c, cocoa-touch, methods

我正在将新 API 用于应用内应用商店产品视图。我知道它应该只适用于 IOS 6 及更高版本，但是，我的应用程序适用于 ios 5 及更高版本。现在，当您点击将您带到商店的按钮时，该应用程序将变得柠檬并冻结您！

`SKStoreProductViewController`

我将如何测试此设备是否能够执行此功能？或者如果这是 ios 6 及更高版本？

我正在寻找类似于“应用内邮件”的东西，它有一个名为的方法`CanSendMail`，有这样的方法`SKStore`吗？

**此外**

我将框架弱链接为`Option`.

**更新**

我尝试使用它但仍然无法正常工作！没有任何日志:(

```
if (error) {
        NSLog(@"Error %@ with User Info %@.", error, [error userInfo]);

    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error"
                                                    message:@"Your device doesn't support In-App Product View"
                                                   delegate:nil
                                          cancelButtonTitle:@"OK"
                                          otherButtonTitles:nil];
    [alert show];

    } else {
        // Present Store Product View Controller
        [self presentViewController:storeProductViewController animated:YES completion:nil];
    }
}];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:38:05.577

测试类在运行时是否可用的一般方法是使用[`NSClassFromString`](https://developer.apple.com/library/ios/#documentation/cocoa/reference/foundation/miscellaneous/foundation_functions/reference/reference.html). 所以，你可以这样做：

```
Class cls = NSClassFromString(@"SKStoreProductViewController");
if (cls)
{
    // The device is iOS 6.0 or higher, so it's safe to use this class
    SKStoreProductViewController *viewController = [[cls alloc] init];
    ...
}
else
{
    // The device is pre-iOS 6.0; show an error message or have some other
    // reasonable fallback behavior
} 
```

如果您使用的框架在您定位的最低 iOS 版本中不可用，那么您还必须确保对框架进行**弱链接。**正如@rmaddy 指出的那样，您应该查看[SDK 兼容性指南](https://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/cross_development/Introduction/Introduction.html#//apple_ref/doc/uid/10000163i)以获取完整的血腥细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T23:23:35.327

我发现这个效果最好：

```
#define SYSTEM_VERSION_EQUAL_TO(v)                  ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedSame)
#define SYSTEM_VERSION_GREATER_THAN(v)              ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedDescending)
#define SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(v)  ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] != NSOrderedAscending)
#define SYSTEM_VERSION_LESS_THAN(v)                 ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedAscending)
#define SYSTEM_VERSION_LESS_THAN_OR_EQUAL_TO(v)     ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] != NSOrderedDescending)

if (SYSTEM_VERSION_LESS_THAN(@"6.0")) {

// iOS Version 5.1 and older    

}

if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(@"6.0")) {

// iOS Version 6.0 and later    

} 
```

将您的商店产品视图代码复制到 6.0 之后的版本，并将您的后备代码复制到 5.1 和更早版本。

我从这里学到了这一点。祝你好运！！

# ruby-on-rails - 使用 FactoryGirl 创建的 Rails 实例变量未在视图中定义

> ID：16051540
> 
> 赞同：0
> 
> 时间：2013-04-17T04:32:15.670
> 
> 标签：ruby-on-rails, ruby, factory-bot

我有一个显示欢迎消息或视频的视图，具体取决于是否`@video`定义。我正在尝试为视图编写一些测试，但我似乎无法弄清楚如何涵盖`@video`定义的情况。

这是视图：

```
<div class="container" id="contents">
  <% unless defined? @video %>
    <div class="hero-unit">
      <h1>
        Khan-O-Tron<br />
        <small>Khan Academy has a lot of great videos. So many, in fact, that choosing just one is kind of annoying. Click the button below and let us choose one for you!</small>
      </h1><br />
      <a class="btn btn-large btn-success" href="/random">Get Started By Watching A Tutorial</a>
    </div>
  <% else %>
    <div class="hero-unit">
      <h1><%= @video.title %><br /> <small><%= @video.description %></small></h1>
      <br />
      <%= raw @video.get_embed_code %>
    </div>
  <% end %>
</div> 
```

这是我的测试：

```
require 'spec_helper'

describe "[Static Pages]" do
  describe "GET /" do
    before { visit root_path }
    subject { page }

    describe "#hero-unit" do
      describe "with @video not defined" do
        it "should have an H1 tag with the text 'Khan-O-Tron'." do
          should have_selector ".hero-unit h1", text: "Khan-O-Tron"
        end
        it "should have an H1 small tag with a description of our product." do
          should have_selector ".hero-unit h1 small", text: "Khan Academy has a lot of great videos. So many, in fact, that choosing just one is kind of annoying. Click the button below and let us choose one for you!"
        end
        it "should have a link to /random with the text 'Get Started By Watching A Tutorial'" do
          should have_link "Get Started By Watching A Tutorial", href: "/random"
        end
      end
      describe "with @video defined" do

        before { @video = FactoryGirl.create(:video) }

        it "should have an H1 tag with the video's title" do
          should have_selector ".hero-unit h1", text: @video.title
        end
        it "should have an H1 small tag with the video's description" do
          should have_selector ".hero-unit h1 small", text: @video.description
        end
        it "should have the video embedded in the page" do
          should have_selector "iframe"
        end
      end
    end
  end
end 
```

为什么`@video`我定义的变量`FactoryGirl`没有传递给视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:48:06.560

那是因为您在`visit root_path`定义`@video`. 在块中的行`get root_path`之后添加它应该可以工作。`@video = ....``before`

顺便说一句，解决这个问题的正确方法是使用 rspec 助手：

`before`在第一个块的正上方添加：

```
let(:video) { FactoryGirl.create(:video) } 
```

然后在`before`您设置实例变量的第二个块中，将该行替换为：

`assign(:video, video)`

最后在您的示例中，替换`@video`为`video`.

更多信息[在这里](https://www.relishapp.com/rspec/rspec-rails/docs/controller-specs)。

# node.js - 在骨干路由器中使用初始化函数

> ID：16051541
> 
> 赞同：0
> 
> 时间：2013-04-17T04:32:17.870
> 
> 标签：node.js, backbone.js, backbone-routing, backbone.js-collections

我正在使用 Node/express 和 Mongodb 创建我的第一个主干应用程序。该应用程序是一个在线食品菜单和订购系统，它在第一页加载时从 mongo 收集所有数据并将其推送到 Backbone 集合中。我正在使用主干路由器中的初始化函数来获取（）数据并将其放入集合中。我的问题是在 Initialize 函数完成之前加载索引路由器。我已确认初始化函数运行正确，因为我可以在浏览器控制台中访问该集合。

我可能会以错误的方式解决这个问题，但这是我的路由器的简化版本：

```
GDB.Router = Backbone.Router.extend ({
    routes: {
        '': 'index',
        'drinks': 'drinks'
    },

    meals: {},

    initialize: function() {
        meals = new GDB.Collections.Meals
        meals.fetch();
    }, 

    index: function() {
            var mealsView = new GDB.Views.Meals ({collection: meals});
            $('#GDBContainer').append(mealsView.render().el);           
    },

    drinks: function() {
            var drinksView = new GDB.Views.Meals ({collection: meals.byCategory('drinks')});
            $('#GDBContainer').append(drinksView.render().el);
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T06:01:37.493

最有可能的是，该`initialize`函数在调用函数之前*已经*完成`index`，但是您`fetch`是异步的，因此当您尝试呈现您的`mealsView`.

```
GDB.Router = Backbone.Router.extend ({
    routes: {
        '': 'index',
        'drinks': 'drinks'
    },

    initialize: function() {
        this.meals = new GDB.Collections.Meals
        // fetch returns a jquery promise
        this.fetchingMeals = this.meals.fetch();
    }, 

    index: function() {
            var self = this;
            // maybe show loading spinner here
            $('#GDBContainer').html('<div>Loading</div>');

            this.fetchingMeals.done(function(){
                // now this.meals is done fetching!
                var mealsView = new GDB.Views.Meals ({collection: self.meals});
                $('#GDBContainer').html(mealsView.render().el);  
            });         
    },

    drinks: function() {
            var self = this;
            // maybe show loading spinner here
            $('#GDBContainer').html('<div>Loading</div>');

            this.fetchingMeals.done(function(){
                var drinksView = new GDB.Views.Meals ({collection: self.meals.byCategory('drinks')});
                $('#GDBContainer').html(drinksView.render().el);
            });
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T06:12:46.167

您可以使用 Paul 的解决方案，或者在视图中收听集合的 add/reset/whatever 事件。

```
view.listenTo(model, 'reset', view.render); 
```

# jquery - 如何将 div 内容转换为图像并在 IE6+ 版本中下载？

> ID：16051542
> 
> 赞同：0
> 
> 时间：2013-04-17T04:32:20.767
> 
> 标签：jquery, jqplot

我在我的项目中使用了 JQPlot，我想将绘制的图形下载为图像。我想支持IE7+。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:18:51.387

我曾经遇到过同样的问题。请参考以下 URL，这对我很有帮助 [JqPlot As Image](https://stackoverflow.com/questions/12182598/jqplot-as-image)
for IE7 support 使用以下库[http://code.google.com/p/explorercanvas/source/browse/trunk/silverlight/excanvas.js?r= 48](http://code.google.com/p/explorercanvas/source/browse/trunk/silverlight/excanvas.js?r=48)这个支持 IE 中的画布功能。

# vb.net - 在日期范围内插入星期几的记录

> ID：16051548
> 
> 赞同：0
> 
> 时间：2013-04-17T04:32:45.233
> 
> 标签：vb.net, datetime

我试图弄清楚如何做到这一点。一直在研究，找不到任何我可以弄清楚如何使用的东西。

我有一个开始日期、结束日期、重复日期、客户

开始日期 = 04/01/2013

结束日期 = 04/30/2013

客户 = 约翰

重复日=星期一

我想在每个星期一的 startdate 和 enddate 内为 john 插入一条记录，有人可以帮我吗？vb.net 的新手

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:55:43.583

使用 DayofWeek 函数检查今天是否是星期一。然后使用插入命令。

```
Dim startdate As DateTime = Convert.ToDateTime("01 Apr 2013")
Dim enddate As DateTime = Convert.ToDateTime("30 Apr 2013")

Dim DofW = Now.DayOfWeek()
dim recurringday = "Monday"

If now >= startdate And now <= enddate Then
  If DofW = recurringday Then
    'Insert Record
  End If
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T07:38:49.440

@Sweety 建议使用 .DayofWeek，但我不确定他的方法是否满足您的要求。尝试这个：

```
 Dim StartDate As DateTime = CDate("01 Apr 2013")
    Dim FinishDate As DateTime = CDate("30 Apr 2013")

    Dim RecurringDay = "Monday"

    Dim Period = FinishDate.Subtract(StartDate).TotalDays

    Dim CurrentDate As DateTime

    For Counter As Integer = 0 To Period
        CurrentDate = StartDate.AddDays(Counter)
        If CurrentDate.DayOfWeek = RecurringDay Then
            'Insert Record
        End If
    Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T13:22:26.813

尝试这个。

```
 Dim StartDate As DateTime = #4/1/2013#
    Dim FinishDate As DateTime = #4/30/2013#

    Dim RecurringDay As Integer = DayOfWeek.Monday

    'force to first RecurringDay
    If RecurringDay < StartDate.DayOfWeek Then StartDate = StartDate.AddDays(7)
    StartDate = StartDate.AddDays(RecurringDay - StartDate.DayOfWeek)

    Do While StartDate <= FinishDate
        Debug.WriteLine(StartDate.ToLongDateString)
        'insert record
        StartDate = StartDate.AddDays(7)
    Loop 
```

# image - 在R中查找二值图像的主轴/图像方向

> ID：16051549
> 
> 赞同：1
> 
> 时间：2013-04-17T04:32:49.170
> 
> 标签：image, r, matlab, image-processing, binary-data

我有一个高分辨率的二进制图像，看起来像：

![在此处输入图像描述](https://i.stack.imgur.com/VnZdY.jpg)

我正在尝试计算应该稍微向右旋转的主轴并最终获得对象的方向轴

[这里](https://stackoverflow.com/questions/9984623/drawing-the-major-and-minor-axis-of-an-elliptical-object-in-matlab)的一篇文章（在 matlab 中）建议这样做的一种方法是计算数据点的协方差矩阵并找到它们的特征值/特征向量

我正在尝试在 R 中实现类似的东西

```
%% MATLAB CODE Calculate axis and draw

[M N] = size(Ibw);
[X Y] = meshgrid(1:N,1:M);

%Mass and mass center
m = sum(sum(Ibw));
x0 = sum(sum(Ibw.*X))/m;
y0 = sum(sum(Ibw.*Y))/m; 
```

* * *

```
#R code

d = dim(im)
M = d[1]
N = d[2]

t = meshgrid(M,N)
X = t[[2]]
Y = t[[1]]
m = sum(im);
x0 = sum(im %*% X)/m;
y0 = sum(im %*% Y)/m;

meshgrid <-function(r,c){
  return(list(R=matrix(rep(1:r, r), r, byrow=T), 
          C=matrix(rep(1:c, c), c)))
} 
```

但是，计算`m`,`x0`和`y0`在 R 中花费的时间太长。

有人知道R中的实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T08:29:53.810

直接计算方差矩阵`var`需要 1/3 秒。

```
# Sample data
M <- 2736
N <- 3648
im <- matrix( FALSE, M, N );
y <- as.vector(row(im))
x <- as.vector(col(im))
im[ abs( y - M/2 ) < M/3 & abs( x - N/2 ) < N/3 ] <- TRUE
#image(im)
theta <- runif(1, -pi/12, pi/12)
xy <- cbind(x+1-N/2,y+1-M/2) %*% matrix(c( cos(theta), sin(theta), -sin(theta), cos(theta) ), 2, 2)
#plot(xy[,1]+N/2-1, xy[,2]+M/2-1); abline(h=c(1,M),v=c(1,N))
f <- function(u, lower, upper) pmax(lower,pmin(round(u),upper))
im[] <- im[cbind( f(xy[,2] + M/2 - 1,1,M), f(xy[,1] + N/2 - 1,1,N) )]
image(1:N, 1:M, t(im), asp=1)

# Variance matrix of the points in the rectangle
i <- which(im)
V <- var(cbind( col(im)[i], row(im)[i] ))
# Their eigenvectors
u <- eigen(V)$vectors
abline( M/2-N/2*u[2,1]/u[1,1], u[2,1]/u[1,1], lwd=5 )
abline( M/2-N/2*u[2,2]/u[1,2], u[2,2]/u[1,2] ) 
```

![具有长轴和短轴的二进制图像](https://i.stack.imgur.com/RY0xH.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T05:19:55.110

[尝试用此链接](http://cran.r-project.org/bin/windows/contrib/ATLAS/)中的合适的替换默认的 Rblas.dll 。

# javascript - 使用 jQuery 下载链接

> ID：16051556
> 
> 赞同：1
> 
> 时间：2013-04-17T04:33:18.177
> 
> 标签：javascript, jquery

```
<a href="style.css">Download our CSS</a> 
```

当我在 Chrome 中单击它时，它会在浏览器中打开 CSS。如何强制文件下载onclick？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T04:34:58.870

Special HTTP response headers are required to make the browser force download a file. So for example if you're using PHP a simple example would be this -

```
<?php
// We'll be outputting a CSS
header('Content-type: text/css');

// It will be called style.css
header('Content-Disposition: attachment; filename="style.css"');

// The CSS is in style.css
readfile('style.css');
?> 
```

It doesn't matter what backend language (PHP/Ruby/Python/Node.js) you're using, just send those specific HTTP headers in the response.

# javascript - 使用 HTML5 FormData 上传文件不适用于 IE10 桌面

> ID：16051558
> 
> 赞同：1
> 
> 时间：2013-04-17T04:33:25.843
> 
> 标签：javascript, html, upload, internet-explorer-10

我有使用 HTML5 FormData 上传文件的简单脚本，它在大多数支持 HTML5 的浏览器上运行良好（我针对 Chrome、FireFox、Opera 和**IE10 Metro**进行了测试）。唯一不工作的浏览器是在**IE10 Desktop**上，问题是文件从未上传，在服务器端`Request.Files.Count`总是为零。

知道为什么，或者这只是 IE10 桌面错误？

这是脚本：

```
<input type="file" id="fileInput" multiple="true"/>
<button type="button" id="uploadButton">Upload</button>
<div>
    <span>Status: </span> <strong id="status"></strong>
</div>

<script src="~/Scripts/jquery-1.9.1.js"></script>
<script type="text/javascript">

    var files = [];

    $(document).ready(function() {

        $('#fileInput').change(function (e) {
            // Add all selected files to 'files' array

            $.each(e.target.files, function(i, item) {
                files.push(item);
            });
        });

        $('#uploadButton').click(function () {

            // Put files to FormData
            var formData = new FormData();
            $.each(files, function(i, item) {
                formData.append('X-FILE-' + i, item);
            });

            // Send FormData to server
            $.ajax({
                url: '/home/upload',
                data: formData,
                cache: false,
                contentType: false,
                processData: false,
                type: 'POST',
                success: function (data) {
                    if (data == "YES") {
                        $('#status').text("File Uploaded");
                    } else {
                        $('#status').text("File NOT Uploaded");
                    }
                }
            });
        });
    });
</script> 
```

这是捕获“/home/upload”操作的服务器端代码：

```
[HttpPost]
public ActionResult Upload()
{
    var success = Request.Files.Count > 0;
    return Content(success ? "YES" : "NO");
} 
```

[我还在https://github.com/budiadiono/IE10VSHtml5](https://github.com/budiadiono/IE10VSHtml5)上的 Github 上的公共存储库中推送了我的代码。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:14:15.257

我确定这是来自 IE 10 Desktop 的错误。Telerik 的演示[http://demos.telerik.com/aspnet-ajax/asyncupload/examples/overview/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/asyncupload/examples/overview/defaultcs.aspx)在 IE 10 桌面上也不能正常工作，但在 IE 10 Metro 上工作正常。

更特别的是这里的 IE 10 桌面版：

```
Version: 10.0.9200.16540
Update Versions: 10.0.4 (KB2817183)
Product ID: 00150-20000-00003-AA459 
```

# c# - 通过视图模型构造函数（依赖注入）传递的对象实例的理想数量

> ID：16051561
> 
> 赞同：2
> 
> 时间：2013-04-17T04:33:40.587
> 
> 标签：c#, mvvm, windows-phone-8, windows-phone, mvvm-light

我正在实现一个项目，主要目标是实现松散耦合的类，例如下面，我使用简单的 IOC 容器将 PageNavigation 和 AppConfig 实例注入视图模型。

```
public MyViewModel(IPageNavigationService PageNavigation, IAppConfig AppConfig) {
   //my code
} 
```

1.  我可以通过构造函数传递的实例数量是否有限制？，这可能会导致无法预料的问题。
2.  如果我需要传递 5 到 6 个对象实例怎么办，除了构造函数之外，我还有什么其他方法可以访问对象实例，保持松散耦合和动态，并且所有视图模型都使用对象的默认实例（单例）被通过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T07:04:24.083

通过构造函数传递给视图模型实例的实例没有限制。您应该通过构造函数传递 ViewModel 正常工作所需的所有依赖项。

PropertyInjection 可以传递可选的或提供不同实现的依赖项。

您还可以定义一个构造函数来获取对 IOC-Container 的引用，以便 ViewModel 在构造函数中自行解析必要的依赖关系。但是然后让您的视图模型依赖于有时不需要的容器。

```
public MyViewModel(IocContainer container) {
   // resolve dependencies via the container
} 
```

# ios - 在导航控制器或选项卡栏中，允许按钮响应触摸而不传递到 tableview

> ID：16051563
> 
> 赞同：0
> 
> 时间：2013-04-17T04:33:54.693
> 
> 标签：ios, uiview, uibutton

我有一个 a 的子类，`UIView`它从 a 加载其内容`xib`。我采用该视图并将其插入 a 的底部，`UIViewController`它充当弹出菜单 - 有点像操作表。

在视图内部，我有视图、标题`UIImageView`、背景`UIImageView`和几个按钮，它们有效地位于背景图像的前面，它们`IBActions`在`UIView`子类中连接。

有了基本的`UIViewController`，一切都很好，没有问题。使用视图动画它打开和关闭，并且您触摸按钮，它们会按预期触发。我在 a 前面弹出了这个`UITableView`，效果很好。

当我包含`UIViewController`a`UINavigationController`或时会发生问题`UITabbarController`，当按钮突然停止响应并且 UIView 上的任何触摸开始传递到 tableview 并选择它下面的 tableview 单元格时。

我尝试了以下方法来“控制触摸”。-`exclusiveTouch`在背景上设置 = YES `UIView`，图像查看按钮，但不影响触摸。- 在图像视图上验证已`"user interaction"`禁用 - 尝试使用自定义按钮作为背景`UIView`来捕获触摸（如 SO 中所建议的那样），但触摸也会通过它。- 试图在 中覆盖`hitTest`，`UIView`没有用

*   我的按钮，并且`tableview`是标准的子类。

![查看布局示例](https://i.stack.imgur.com/aiWPP.png)

注意：动画前后的视图大小 2013-04-17 07:20:03.975 FivePad[82813:c07] 弹出会打开

2013-04-17 07:20:03.975 FivePad[82813:c07] 父框架：{{0, 0}, {320, 411}}

2013-04-17 07:20:03.976 FivePad[82813:c07] 动画前的菜单帧：{{0, 381}, {320, 51}}

2013-04-17 07:20:04.276 FivePad[82813:c07] 弹出确实打开了

2013-04-17 07:20:04.276 FivePad[82813:c07] 动画后的菜单帧：{{0, 311}, {320, 51}}

# python - pydev 大量cpu使用率

> ID：16051571
> 
> 赞同：0
> 
> 时间：2013-04-17T04:34:59.430
> 
> 标签：python, aptana, pydev

我在 Mac 上通过 Aptana Studio 3 使用 pydev。打开 Aptana 后不久，我的电脑开始发热，风扇全速运转，即使 Aptana 没有执行任何操作，它的 CPU 使用率也超过 100%。我在 Eclipse 上也有 pydev，但不会出现这种峰值。有没有其他人看过这个？有没有办法阻止它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:31:33.977

真正了解发生了什么的唯一方法是将 jvisualvm（或一些分析器或调试器）连接到您的进程以查看发生了什么（然后报告问题）。在 jvisualvm 上，您可以获得当前进程的转储，如果您能说出哪个是正在运行的线程，这可能已经足够了。

请注意，如果您能够在那里重现标题但不能在 pydev 中重现，则标题可能应该是“aptana studio 3 mass cpu usage”...

# c++ - Diagnosing unresolved externals in a static lib

> ID：16051578
> 
> 赞同：0
> 
> 时间：2013-04-17T04:35:31.530
> 
> 标签：c++, visual-c++, linker

I have a number of DLLs building and linking against my application without issues, but this static lib is giving me troubles.

Present in it is just one class. The class is declared with `__declspec(dllexport)` when building the lib and `__declspec(dllimport)` when including the class's header in the application.

When I attempt to build the application with an instance of MyClass, I get:

```
error LNK2019: unresolved external symbol "__declspec(dllimport) public: virtual __thiscall MyClass::~MyClass(void)"
error LNK2019: unresolved external symbol "__declspec(dllimport) public: __thiscall MyClass::MyClass(void)" 
```

And if I attempt to build the application with a pointer to MyClass, I get the same unresolved externals plus two additional warnings:

```
warning LNK4217: locally defined symbol ??0MyClass@@QAE@XZ (public: __thiscall MyClass::MyClass(void)) imported in function _main
warning LNK4217: locally defined symbol ??1MyClass@@UAE@XZ (public virtual __thiscall MyClass::~MyClass(void)) 
```

Searching the web for LNK4217 suggests incorrect usage of the `/M[TD]d?` `cl.exe` switch. I recreated the Visual Studio solution and dragged over the sources to make sure it was provisioned correctly. For reference, both the Lib and app have /MDd.

# c++ - c++ function parameter identifier not found

> ID：16051580
> 
> 赞同：0
> 
> 时间：2013-04-17T04:35:57.857
> 
> 标签：c++

I try to write program to manage Store. it has some users and goods and Order. this is my User.h, Good.h files:

User.h:

```
#ifndef _USER
#define _USER

#include "Store.h"
#include "Good.h"

namespace question1
{
    class User
    {
        const Store store;
    public:
        User(Store &s) : store ( s )
        {
        }
    };

    class AdminUser:User
    {
    };

    class DeliveryUser:User
    {
    };

    class OrderUser:User
    {
        void registerOrder(Order &o);
    };

    class ReceptionUser:User
    {
        void importGood(Good &g);
        void increaseGood(Good &g);
    };
}

#endif 
```

and Good.h:

```
#ifndef _GOOD
#define _GOOD

#include <string>
#include <vector>
#include "User.h"

namespace question1
{
                                                    class Date
{
 public:
    Date ();
    Date ( int mn, int day, int yr);  // constructor
    void display();                   // function to display date
    int GetMonth();
    void SetMonth(int mn);
    ~Date();
 private:
    int month, day, year;
    int DaysSoFar();
};

    enum Ordertype{Newly_registered, Check, Answered};

    class Order
    {
        int num;
        std::string customerName;
        Date registered, Check;
        Ordertype type;
        std::vector<int> codelist, numlist;
    public:
        Order();
        Order(Order& o);
    };

                        class ImportDate
{
    Date importDate;
    User importer;
    int num;
};

                            class ExportDate
{
    Date exportDate;
    User exporter;
    int num;
    Order ex;
};

    class Good
    {
        std::string name;
        int code;
        Date in;
        int innum, AvailableNum;
        User importer;
        std::vector<ImportDate> importHistory;
        std::vector<ExportDate> exportHistory;
    public:
        Good();
        Good(Good &g);
    };

                int max (int a, int b)
{
   if (a>b) return(a) ; else return (b);
}

                int min (int a, int b)
{
   if (a>b) return(b); else return (a);
}
}

#endif 
```

but when compile just this two codes, i got error in User File that

> "syntax error : identifier 'Order', Line 28
> 
> "syntax error : identifier 'Good', Line 33
> 
> "syntax error : identifier 'Good', Line 34

in the function parameter list. I use visual studio 2010\. and open empty project.

anybody can help me?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:19:19.950

你有一个循环引用。简而言之，你最终会得到这样的结果：

```
class Good
{
    User * fn() {} // What is a User?
};

class User
{
    Good * fn() {}
}; 
```

C++ 的行为不像 C# 并且自上而下地读取文件，因此当它遇到对 User 的第一个引用时，它还不知道它是什么。即使你切换类的顺序，问题也会回来。

您可能应该将它们放在同一个文件中并使用类型转发：

```
class User;

class Good
{
    User * fn() {} // Ah, User is some class. Go on.
};

class User
{
    Good * fn() {}
}; 
```

或者（正如 Agentlien 建议的那样）：

```
class User;

class Good
{
    User fn();
};

class User
{
    Good fn();
};

User Good::fn() { return User(); }

Good User::fn() { return Good(); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T06:29:54.803

这里的问题是，编译器第一次到达类或函数的定义时，它使用的所有类型都需要声明。因此，例如，具有：

```
void importGood(Good &g); 
```

在*User.h*中，意味着`Good`必须在此函数声明之前声明。这最好使用**前向声明**来完成，它简单地写成一行，例如：

```
class Good; 
```

这需要放在使用这种类型的任何函数的声明之前，因为否则编译器不知道它是一个类型的名称，你会得到编译器错误。

通常，也可以简单地`#include`定义此类型的文件。但是，这种方法有两个缺点：

1.  它要贵得多。即使您使用包含保护，系统仍然必须读取并标记文件，然后才能确定您对其内容不感兴趣。

2.  每当您有循环依赖时，例如您的情况，它都无济于事。编译器将简单地开始编译，例如*User.cpp*。然后它将包含*User.h*，并且几乎会立即遇到`#include "Good.h"`. 从那时起，它将进入*Good.h*。在那里，您（再次）尝试`#include User.h`，由于包含保护，这将在很大程度上被忽略。因此，一旦`User`在*Good.h*中出现任何使用，编译器仍然没有看到它的声明。

前向声明通过在第一次使用之前将类的声明直接放在使用它的文件中来解决这个问题。

通常，您应该更喜欢在头文件中使用前向声明，并避免包含其他头文件。只要有可能。

您真正需要直接从头文件中包含某些内容的唯一时间是当您创建在该头文件中声明的类型的实例时（例如，通过将其作为不是指针或引用的成员变量）或当您'在标题中使用该类的成员（例如函数或成员变量）。这就是为什么将函数定义放在 cpp 文件中而不是头文件中总是一个好主意的原因之一。

# php - 重定向：资源密集程度如何？

> ID：16051583
> 
> 赞同：-1
> 
> 时间：2013-04-17T04:36:18.193
> 
> 标签：php, redirect

与没有重定向的页面相比，脚本执行重定向时服务器资源（内存、处理能力）的压力是多少？如果在用户看到最终页面之前执行了两个或多个重定向，是否可以（常见/最佳实践）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:42:45.497

> 重定向的资源密集程度如何？

这取决于您涉及的资源。这意味着从客户端到服务器还有一次 HTTP 往返。这需要一点带宽，无论服务器和客户端之间的延迟是多少，服务器上都需要一点点资源来输出 HTTP 标头和关闭/打开连接。总体而言，它不会占用任何可观的资源，但每秒增加一千个用户左右确实需要*一些*. 到底有多少取决于服务器以及您到底在做什么（Apache .htaccess 规则？PHP 脚本？node.js 进程？nginx 重写？）。

> 如果在用户看到最终页面之前执行了两次或更多重定向，是否可以？

如果这是为您的服务器建模的最佳和最干燥的方法，并且所需的资源不是太苛刻（很可能不是），那么当然可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T04:44:09.177

我认为甚至没有必要详细说明您关心的资源：重定向不是什么大问题，而且很常见。我认为关键是像任何东西一样明智地使用它们。

我遇到的几个明智的例子是 SEO 重定向或返回替换以前产品（类别）的产品（类别）；在这些情况下，密集的资源使用从来没有像使用重定向那样令人担忧，因为它们是有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T04:47:51.677

对于服务器，发送 301 需要尽可能多的资源来生成 301（如果它是一个恒定的重定向，几乎没有；它需要一个数据库连接，那么就这么多）。

然而，对于客户端来说，这意味着等待一个额外的 HTTP 往返，让您的页面感觉更慢。

# c# - datetime format of datetime.now function is showing different datetime format from system datettime format

> ID：16051587
> 
> 赞同：0
> 
> 时间：2013-04-17T04:36:44.723
> 
> 标签：c#, asp.net

I am working with a `ASP.NET & C#` application residing in an `windows server` with `windows server 2008 R2` Operating System, the server I am using is a `VM`. I changed my windows datetime format to `"en-US"` and my SQL server datetime format, regional settings datetime format is showing as `"MM/dd/yyyy"` but withing my .NET application developed with c# is showing datetime format of `DateTime.Now` as `"dd/MM/yyyy"` in debug mode so i can't save the data to SQL database, it is throwing exception `"invalid datetime format"`. I will be highly obliged if anybody can help me with the idea how to change the datetime format of DatetTime.Now within my application.

Here is the code snippet - calling section -

```
saveCustomerInfo.saveInfo(txtCustomerId.Text, userNmae, objProperties.ProposalNumber.ToString(), "", "", Total_Amount, SERVICE_TAX, STAMP_DUTY, AgentID, DateTime.Now, null, null, "", "", "", product_code, MODE) 
```

called function signature is -

```
public void saveInfo(string CustomerID, string UserName, string ProposalNo, string PaymentID, string PolicyNumber, int amount, double serviceTax, double stampduty, string Agent_ID, DateTime? ProposalDate, DateTime? PaymentDate, DateTime? PolicyDate, string ClaimNo, string ClaimAmount, string ClaimStatus, int ProductCode, string mode) 
```

The sql Code section is:

```
public void saveInfo(string CustomerID, string UserName, string ProposalNo, string PaymentID, string PolicyNumber, int amount, double serviceTax, double stampduty, string Agent_ID, DateTime? ProposalDate, DateTime? PaymentDate, DateTime? PolicyDate, string ClaimNo, string ClaimAmount, string ClaimStatus, int ProductCode, string mode)
    {
        string connection = SetConnectionString(SPContext.Current.Site);
        SqlConnection con = new SqlConnection(connection);
        SqlCommand com = new SqlCommand("Select count(ProposalNo) from [aspnetdb].[dbo].[user_info_log] where ProposalNo = '" + ProposalNo + "'", con);
        con.Open();
        Int32 count = (Int32)com.ExecuteScalar();

        if (count == 0)
        {
            //string strFormattedProposalDate = ProposalDate.ToString().Split('/')[1] + "/" + ProposalDate.ToString().Split('/')[0] + "/" + ProposalDate.ToString().Split('/')[2];

            com.Dispose();
            com = new SqlCommand("insert into user_info_log(CustomerID,UserName,ProposalNo,PaymentID,PolicyNo,TotalAmount,ServiceTax,Stampduty,Agent_ID,ProposalDate,PaymentDate,PolicyDate,ClaimNumber,ClaimAmount,ClaimStatus,ProductCode,Mode) VALUES('" + CustomerID + "','" + UserName + "','" + ProposalNo + "','" + PaymentID + "','" + PolicyNumber + "','" + amount + "','" + serviceTax + "','" + stampduty + "','" + Agent_ID + "','" + ProposalDate + "','" + System.DBNull.Value + "','" + System.DBNull.Value + "','" + ClaimNo + "','" + ClaimAmount + "','" + ClaimStatus + "','" + ProductCode + "','" + mode + "')", con);
            com.ExecuteNonQuery();
        }
        con.Close();
        com.Dispose();
    } 
```

The error code is: The conversion of a varchar data type to a datetime data type resulted in an out-of-range value. The statement has been terminated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:48:09.193

您需要更改应用程序中使用的文化。将此添加到`system.web`web.config 部分：`<globalization culture="en-US" />` 此外，如果您不想更改所有应用程序的默认文化，您可以将 en-US 文化传递给`DateTime.ToString`方法：`var str = DateTime.Now.ToString(CultureInfo.GetCultureInfo("en-US"))`

除此之外，将 DateTime 值作为字符串发送到数据库是绝对错误的方法。考虑在您的 sql 命令中使用参数：[http](http://csharp-station.com/Tutorial/AdoDotNet/Lesson06) ://csharp-station.com/Tutorial/AdoDotNet/Lesson06 这样您就不会将 DateTime 转换为字符串

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:02:32.383

然后尝试

```
this.TextBox3.Text = DateTime.Now.ToString("MM.dd.yyyy"); 
```

或者试试这个......

```
string format = "MM/dd/yyyy hh:mm:ss.fff";
DateTime d = DateTime.ParseExact("05/15/2012 10:09:28.650",
                                format,
                                System.Globalization.CultureInfo.InvariantCulture) 
```

# sql - 如何从嵌套查询的结果中排除名称？

> ID：16051589
> 
> 赞同：1
> 
> 时间：2013-04-17T04:36:55.477
> 
> 标签：sql, sql-server-2008

以下是我的员工表：

```
create table EMPLOYEES
(EmpID    char(4)         unique Not null,
 Ename    varchar(10),
 Job      varchar(9),
 MGR      char(4),
 Hiredate date,
 Salary   decimal(7,2),
 Comm     decimal(7,2),
 DeptNo   char(2)         not null,
     Primary key(EmpID),
     Foreign key(DeptNo) REFERENCES DEPARTMENTS(DeptNo));

insert into EMPLOYEES values (7839,'King','President',null,'17-Nov-11',5000,null,10);
insert into EMPLOYEES values (7698,'Blake','Manager',7839,'01-May-11',2850,null,30);
insert into EMPLOYEES values (7782,'Clark','Manager',7839,'02-Jun-11',2450,null,10);
insert into EMPLOYEES values (7566,'Jones','Manager',7839,'02-Apr-11',2975,null,20);
insert into EMPLOYEES values (7654,'Martin','Salesman',7698,'28-Feb-12',1250,1400,30);
insert into EMPLOYEES values (7499,'Allen','Salesman',7698,'20-Feb-11',1600,300,30);
insert into EMPLOYEES values (7844,'Turner','Salesman',7698,'08-Sep-11',1500,0,30);
insert into EMPLOYEES values (7900,'James','Clerk',7698,'22-Feb-12',950,null,30);
insert into EMPLOYEES values (7521,'Ward','Salesman',7698,'22-Feb-12',1250,500,30);
insert into EMPLOYEES values (7902,'Ford','Analyst',7566,'03-Dec-11',3000,null,20);
insert into EMPLOYEES values (7369,'Smith','Clerk',7902,'17-Dec-10',800,null,20);
insert into EMPLOYEES values (7788,'Scott','Analyst',7566,'09-Dec-12',3000,null,20);
insert into EMPLOYEES values (7876,'Adams','Clerk',7788,'12-Jan-10',1100,null,20);
insert into EMPLOYEES values (7934,'Miller','Clerk',7782,'23-Jan-12',1300,null,10); 
```

以下是 DEPARTMENTS 表：

```
create table DEPARTMENTS
    (DeptNo   char(2)  unique Not null,
     DName    varchar(14),
     Location varchar(13),
         Primary key(DeptNo));

insert into DEPARTMENTS values (10,'Accounting','New York');
insert into DEPARTMENTS values (20,'Research','Dallas');
insert into DEPARTMENTS Values (30,'Sales','Chicago');
insert into DEPARTMENTS values (40,'Operations','Boston'); 
```

以下是我的查询：

```
select ename, salary
from EMPLOYEES
where DeptNo in
(select DeptNo
from EMPLOYEES
where Ename ='blake'); 
```

如何从我的结果中排除“布莱克”？有人告诉我`NOT IN`在子查询中使用 a 但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:39:04.903

```
select ename, salary
from EMPLOYEES
where DeptNo in
(select DeptNo
from EMPLOYEES
where Ename ='blake') and Ename <>'blake'; 
```

您也可以`not in`在第二个查询中使用 as。

[SQLFIDDLE 演示](http://sqlfiddle.com/#!3/1e563/5)

# ruby-on-rails - Rails fixtures dumping all data in the db

> ID：16051601
> 
> 赞同：1
> 
> 时间：2013-04-17T04:37:59.973
> 
> 标签：ruby-on-rails, activerecord

I've been in Factory land for the past few years and have decided to come back to fixtures but am running into a problem.

In my `test_helper.rb` I have

```
class ActiveSupport::TestCase
  fixtures :all
end 
```

Then in an individual test case I might be doing something like `users(:one)` however the data for `users(:two)` and the data for other tables that I am not calling on seems to be present in the test database.

So, is this the expected behavior? I have a hard to believing it is, seems strange from an isolated testing perspective.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:47:06.907

`fixtures :all`发生这种情况是因为您从语句中一次加载所有固定装置。测试中的经验法则是仅加载给定测试所需的数据（不是全部）。这也可能会减慢您的测试运行时间。

如果您只想加载选定的灯具，您可以这样做

```
fixtures :<fixture name> 
```

前任：

```
fixtures :users 
```

[阅读更多关于固定装置](http://guides.rubyonrails.org/testing.html#the-low-down-on-fixtures)的信息。

还有一件事，你是否有特别的理由重返赛程。工厂是要走的路；它们允许您干净地组织您的测试数据。

[阅读更多关于工厂](http://railscasts.com/episodes/158-factories-not-fixtures)的信息。

# ruby-on-rails - 狂欢。所选地点没有可用的送货方式，请更改您的地址并重试

> ID：16051605
> 
> 赞同：0
> 
> 时间：2013-04-17T04:38:54.447
> 
> 标签：ruby-on-rails, spree

尝试提交“帐单地址”表单时出现错误（消息）。(http://mystore:3000/checkout/address)

味精-> `No shipping methods available for selected location, please change your address and try again.`

如果我在“国家”字段中选择“美国”或“加拿大”，它可以正常工作，但对于其他国家，它不会提交:)

我的宝石文件

```
source 'http://rubygems.org'

gem 'rails', '3.2.13'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'debugger'
gem 'spree', '1.3.2'
gem 'spree_gateway', :github => 'spree/spree_gateway', :branch => '1-3-stable'
gem 'spree_auth_devise', :github => 'spree/spree_auth_devise', :branch => '1-3-stable' 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-09T08:53:54.713

另一件事会导致这个烦人的模棱两可的错误，**即使您`config.track_inventory_levels`设置为 false**也没有设置任何库存位置。

由于这个错误可能是由 9000 件事情中的一件造成的，所以我已经为这个错误做了很多事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T06:58:18.280

解决了 ：）

非常感谢 NICWN -> [https://groups.google.com/forum/?fromgroups=#!searchin/spree-user/No](https://groups.google.com/forum/?fromgroups=#!searchin/spree-user/No) $20shipping$20methods$20available$20for$20selected$20location,$20please$20change$20your $20address$20and$20try$20​​again/spree-user/-imHA2H9KxI/Z_-EKBhq0twJ

1.  打造“亚洲”新区
2.  添加国家“日本”
3.  在配置>州，选择“日本”并添加州“关东”

4.  当然，我为亚洲区域添加了新的运输方式。{ name -> Japan (JPY) {您必须在括号中指定货币 :) & 它必须与字段“CURRENCY:”中的相同&如果它不是美元，您必须在“GENERAL SETTINGS”中更改它通过在“CHOOSE CURRENCY”中选择货币} }

5.  不选择任何运输类别的运输方式。“运输类别”-> 无。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-11T14:50:46.143

您应该检查管理门户中的**区域**。您可以维护 2 个区域。第一个选项可以是“美国”+“加拿大”，默认为**国内运输**。另一个默认选项是用于**国际运输的****EU_VAT**。对于不属于**国内航运**的任何其他国家，应成为**国际航运**的成员。如果您使用**FedEx**，那么您还需要从 fedex 获取开发人员密钥以用于**开发环境**。

 ******可以找到有关如何获取**联邦快递开发人员测试密钥的解决方案** [http://arvind-ror.blogspot.in/2013/08/how-to-obtain-developers-test-keys-from.html](http://arvind-ror.blogspot.in/2013/08/how-to-obtain-developers-test-keys-from.html)******

# r - 分组时折叠 data.table 列值

> ID：16051608
> 
> 赞同：5
> 
> 时间：2013-04-17T04:38:59.117
> 
> 标签：r, grouping, data.table

给定一个`data.table`对象，我会将一些分组列的值折叠到一个对象中，并将生成的对象插入一个新的列中。

```
dt <- data.table(
            c('A|A', 'B|A', 'A|A', 'B|A', 'A|B'),
            c(0, 0, 1, 1, 0),
            c(22.7, 1.2, 0.3, 0.4, 0.0)
)
setnames(dt, names(dt), c('GROUPING', 'NAME', 'VALUE'))
dt
#    GROUPING NAME VALUE
# 1:      A|A    0  22.7
# 2:      B|A    0   1.2
# 3:      A|A    1   0.3
# 4:      B|A    1   0.4
# 5:      A|B    0   0.0 
```

我认为首先需要指定要分组的列，所以我应该从`dt[, OBJECTS := <expr>, by = GROUPING]`.

不幸的是，我不知道`<expr>`要使用的表达式，因此结果如下：

```
#    GROUPING   OBJECTS
# 1:      A|A  <vector>
# 2:      B|A  <vector>
# 3:      A|B  <vector> 
```

每个`<vector>`必须包含其他列的值。例如，第一个`<vector>`必须是一个命名向量，相当于：

```
eg <- c(22.7, 0.3)
names(eg) <- c('0', '1')
#    0    1 
# 22.7  0.3 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T04:50:19.827

在内部工作`j`：如果您想让列的值成为向量，则需要将输出包装在`list(.)`.

`j`本身需要调用`list`，因此您的最终表达式将类似于嵌套的`list`，例如：

```
dt[, list(allNames=list(NAME), allValues=list(VALUE)), by=GROUPING]

#    GROUPING allNames allValues
# 1:      A|A      0,1  22.7,0.3
# 2:      B|A      0,1   1.2,0.4
# 3:      A|B        0         0 
```

正如@Mnel 指出的那样，等效地：

```
dt[, lapply(.SD, list), by=GROUPING] 
```

如果您想要长篇，那么您的`<expr>`遗嘱结构是：
`list( c( list(), list(), ..., list() ) )` 例如：

```
dt[, list(c(list(NAME), list(VALUE))), by=GROUPING]

#    GROUPING       V1
# 1:      A|A      0,1
# 2:      A|A 22.7,0.3
# 3:      B|A      0,1
# 4:      B|A  1.2,0.4
# 5:      A|B        0
# 6:      A|B        0 
```

或等效地：

```
dt[, list(lapply(.SD, c)), by=GROUPING] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T05:35:43.193

我*认为*这就是您正在寻找的：

```
dt1 <- dt[, list(list(setNames(VALUE, NAME))), by = GROUPING]
dt1
#    GROUPING       V1
# 1:      A|A 22.7,0.3
# 2:      B|A  1.2,0.4
# 3:      A|B        0
str(dt1)
# Classes ‘data.table’ and 'data.frame':  3 obs. of  2 variables:
# $ GROUPING: chr  "A|A" "B|A" "A|B"
# $ V1      :List of 3
#  ..$ : Named num  22.7 0.3
#  .. ..- attr(*, "names")= chr  "0" "1"
#  ..$ : Named num  1.2 0.4
#  .. ..- attr(*, "names")= chr  "0" "1"
#  ..$ : Named num 0
#  .. ..- attr(*, "names")= chr "0"
# - attr(*, ".internal.selfref")=<externalptr> 
dt1$V1
# [[1]]
#    0    1 
# 22.7  0.3 
# 
# [[2]]
#   0   1 
# 1.2 0.4 
# 
# [[3]]
# 0 
# 0 
```

正如@Arun 在评论中指出的那样，`setNames`在这种情况下，“data.table”的替代方案是`setattr(VALUE, 'names', NAME)`，提出另一种解决方案：

```
dt1 <- dt[, list(list(setattr(VALUE, 'names', NAME))), by = GROUPING] 
```

# c# - 使用 Linq 从在线 XML 文件中读取数据

> ID：16051609
> 
> 赞同：1
> 
> 时间：2013-04-17T04:39:00.300
> 
> 标签：c#, xml-parsing, linq-to-xml

我一直在寻找一种从 C# 中的 XML 文件中读取特定数据的方法。

示例 XML 文件：[这里](http://api.eve-central.com/api/marketstat?typeid=17392&typeid=2393&regionlimit=10000002&usesystem=30000142).

我正在尝试创建一种方法，在给定 id 属性（例如“17392”，参见示例）的情况下，可以返回该特定类型 id 的最高购买价格。

我一直在寻找几个小时，老实说，我在我的头上。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T05:14:47.200

为我工作

```
 XDocument xdoc = XDocument.Load(@"MyFile.xml");
        var lv1s = from lv1 in xdoc.Descendants("type")
                   .Where(l => (string) l.Attribute("id") == "17392")
                   .Descendants("buy")
                   select (string)lv1.Element("max");

        string Result = "";
        foreach (var lv1 in lv1s)
        {
            Result = lv1.ToString();
        } 
```

**说明：**它首先加载 xml 文件，然后根据您的要求循环遍历其后代（“ **type** ”），其中其属性（“ **id** ”）为**17392**，然后向下一层选择后代（“**购买**“）并从购买中选择**最大**元素。简而言之，它只是遵循树的结构

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T04:54:42.140

您可以使用[`HttpClient`](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient.aspx)LINQ to XML：

```
string url = "...";

var client = new HttpClient();
string xml = client.GetStringAsync(url).Result;

var result = XDocument.Parse(xml).Descendants("type")
    .Where(e => (string) e.Attribute("id") == "17392")
    .Descendants("buy")
    .Select(e => (string) e.Element("max"))
    .FirstOrDefault(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:43:21.153

请通过以下[链接](http://weblogs.asp.net/scottgu/archive/2010/03/18/building-a-windows-phone-7-twitter-application-using-silverlight.aspx)。详细解释。

根据您的要求，您可以使用 contains() 方法过滤具有给节点的 id 的特定标签数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T05:03:04.590

我正在手机上打字，请原谅我的外壳，我看不到 XML 结构。所以我假设带有价格的节点称为priceNode。

var xml = XDocument.Load(URL);

var q = xml.Root.Elements().First(x=> x.Attributes.Any() && x.Attribute("id") =="17392").Elements("PriceNode").Max(n= > n.值）；

# c# - SpreadsheetGear Column Sum Calculation

> ID：16051612
> 
> 赞同：4
> 
> 时间：2013-04-17T04:39:08.330
> 
> 标签：c#, excel

Is it possible to set the Formula on Column First Say "=SUM(A1:A10)" and after that Display the value in A1 to A10 Cells and after that do the calculation.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T00:47:40.583

是的，我得到了答案。在为此做一些 RND 时，我意识到 Furmula 操作**不适用于** ：

```
SpreadsheetGear.IRange range = WorkBookViewForData.ActiveWorksheet.Cells["A10"];
range.Formula = "=SUM(A1:A9)"
SpreadsheetGear.IRange range1 = WorkBookViewForData.ActiveWorksheet.Cells["A1"];
range1.value = "1"
SpreadsheetGear.IRange range2 = WorkBookViewForData.ActiveWorksheet.Cells["A2"];
range2.value = "2"
SpreadsheetGear.IRange range3 = WorkBookViewForData.ActiveWorksheet.Cells["A3"];
range3.value = "3" 
```

**但适用于**

```
 SpreadsheetGear.IRange range = WorkBookViewForData.ActiveWorksheet.Cells["A10"];
    range.Formula = "=SUM(A1:A9)"             
     WorkBookViewForData.ActiveWorksheet.Cells["A1"].Value="1";
        WorkBookViewForData.ActiveWorksheet.Cells["A2"].Value="2";
        WorkBookViewForData.ActiveWorksheet.Cells["A3"].Value="3"; 
```

其中 WorkBookViewForData 是 SpreadsheetGear 控件的名称

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:00:34.200

**尝试使用以下内容：**

```
totalCell.Formula = "=SUM(C6,C11,C16,C21)"; 
```

**通过以下链接获取详细代码：**

[http://www.spreadsheetgear.com/support/samples/srcview.aspx?file=outline.aspx](http://www.spreadsheetgear.com/support/samples/srcview.aspx?file=outline.aspx)

希望它有帮助。

# django - Django：图像不显示

> ID：16051613
> 
> 赞同：-1
> 
> 时间：2013-04-17T04:39:14.503
> 
> 标签：django

我为创建用户配置文件创建了一个管理表单。

有一个字段用于将图像上传到服务器

```
avatar = models.ImageField("Profile Pic", upload_to="images/", blank=True, null=True) 
```

它工作正常，可以将图像上传到服务器。现在我想显示这个图像，因为我已经实现了一些代码。但它不起作用。

views.py 文件中的代码

```
user_profile = request.user.get_profile()
return render_to_response('view_profile.html',{'profile':user_profile },context_instance=RequestContext(request)) 
```

html文件中的代码

```
<img src="{{ MEDIA_URL }}{{ profile.avatar}}" alt="No Profile picture" height="420" width="420"> 
```

我打印`{{ MEDIA_URL }}{{ profile.avatar}}`然后打印输出为`"/home/calcey/Documents/login/images/Nelumno_nucifera_open_flower_-_botanic_garden_adelaide2.jpg"`. 它打印正确的图像 url，但不显示图像。

这是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:58:56.967

在这里，我忘记将`(r'^images/(?P<path>.*)$', 'django.views.static.serve', {'document_root': settings.MEDIA_ROOT}),`urls.py 文件导入。现在它工作正常

# operators - Xtend Elvis ?：操作员没有按预期工作

> ID：16051615
> 
> 赞同：2
> 
> 时间：2013-04-17T04:39:25.563
> 
> 标签：operators, xtend

我正在使用 Xtend 编写一个 Android 应用程序，并且我想使用 elvis 运算符来简化以下操作（可行）：

```
val c = if (projection != null) new MatrixCursor(projection) else new MatrixCursor(#[MediaStore$MediaColumns::DISPLAY_NAME, MediaStore$MediaColumns::SIZE]) 
```

通过使用 elvis 运算符，我写道：

```
val c = new MatrixCursor(projection ?: #[MediaStore$MediaColumns::DISPLAY_NAME, MediaStore$MediaColumns::SIZE]) 
```

据我了解，它的工作方式相同。

但是，我在 Eclipse 中遇到了这个错误：`Type mismatch: cannot convert from Object to String[]`它有什么问题？

我使用的是 Xtend 2.4，`MatrixCursor`构造函数签名是`MatrixCursor(String[])`, 并`projection`明确定义为`String[]`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T08:18:02.223

您偶然发现了类型推断的限制。elvis 运算符的定义如下：

```
def <T> T elvis(T original, T placeholder) {
  ..
} 
```

如果要绑定类型变量 T，则计算两个操作数类型。由于数组字面`#[..]`量实际上主要是一个列表字面量，因此 T 的绑定是从`String[]`和`List<String>`而不是计算的 two `String[]`。因此，常见的超类型是`Object`所以 elvis 只是一个`Object`. 您可以`String[]`通过显式强制转换来说服类型系统，您希望第二个操作数是 a：

```
val c = new MatrixCursor(projection ?: #[DISPLAY_NAME, SIZE] as String[]) 
```

# ios - iOS 目标 C 方法问题

> ID：16051617
> 
> 赞同：0
> 
> 时间：2013-04-17T04:39:33.093
> 
> 标签：ios, methods, call, declare

我正在尝试将我的一个项目从 Android 移植到 iOS，我遇到了一些一直令人烦恼的基本问题。就像目前一样，我无法调用我创建的方法，因为它似乎不存在，这令人困惑，因为它就在那里。

我不确定我做错了什么。我曾尝试查看一些关于该主题的书籍以及有关该主题的其他问题，但找不到任何可以解释我做错了什么的东西。据我所知，我做得对。

我收到以下警告：

找不到实例方法“-CheckIfTableExists:withDB”（返回类型默认为“id”）

和

接收器类型“int”不是“d”或接口指针，考虑将其转换为“id”

我收集到第二个警告是因为编译器认为它通过将我的返回值更改为“id”而不是“int”来提供帮助，所以我试图将值放入的变量不匹配。但是我不明白为什么它将返回类型从 int 更改为 id 开始，如果返回变量被弄乱了，那么编译器找到了该方法，那么为什么它说它找不到该方法？

有人可以帮忙吗？下面是有问题的代码。

```
#import "sqlite3.h"

@implementation DatabaseHelper

sqlite3 *db;

NSString *Database_Name = @"UniversalAVDatabase.db";
int Database_Version = 14;

NSString *Database_Table = @"Database";

NSString *Attribute_DB_Version = @"Database_Version";

- (NSString *)filePath
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDir = [paths objectAtIndex:0];
    return [documentsDir stringByAppendingPathComponent:Database_Name];
}

- (int) CheckIfTableExists:(NSString *) TableName withDB:(sqlite3 *) db
{
    NSString *dbQuery = [NSString stringWithFormat:@"SELECT DISTINCT tbl_name FROM sqlite_master WHERE tbl_name = '%@';", TableName];
    sqlite3_stmt *SQLStatement;
    int Result = sqlite3_prepare_v2(db, [dbQuery UTF8String], -1, &SQLStatement, nil);
    return Result;
}

- (void) Initialize
{
    int CurrentDatabaseVersion = 1;
    //attempt to open the database.
    int Result = sqlite3_open([[self filePath] UTF8String], &db);
    if (Result == SQLITE_OK)
    {
        //Check if the Database table exists
        int TableDBExists = 1;
        [TableDBExists CheckIfTableExists:Database_Table withDB:db]; //I get two warnings from this
        if (TableDBExists == 1)
        {
            //If it exists check the version of the database to see if it is a later version.
            //CurrentDatabaseVersion = dbHelper.GetDatabaseVersion(db);
        }
        if (CurrentDatabaseVersion < Database_Version)
        {
            //UpgradeDatabase();
        }
    }
    else
    {
        //If the database does not exist then create it.
    }
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:44:34.787

```
[TableDBExists CheckIfTableExists:Database_Table withDB:db]; 
```

应该：

```
TableDBExists = [self CheckIfTableExists:Database_Table withDB:db]; 
```

您需要为您的课程包含 .h 文件：

```
#include "DatabaseHelper.h" 
```

我假设您在 DatabaseHelper.h 文件中声明了遇到错误的方法：

```
- (int) CheckIfTableExists:(NSString *) TableName withDB:(sqlite3 *) db; 
```

我看到的还有很多其他的东西告诉我你来自不同的语言。请参阅：[https](https://github.com/github/objective-c-conventions) ://github.com/github/objective-c-conventions和[http://blog.gomiso.com/2011/08/15/objective-c-conventions/](http://blog.gomiso.com/2011/08/15/objective-c-conventions/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:46:31.877

`TableDBExists`是 int in 类型`Initialize`，您不能向它发送消息。
更改它以将消息发送到`self`：
`TableDBExists = [self CheckIfTableExists:Database_Table withDB:db];`

# php - php / codeigniter登录不起作用

> ID：16051631
> 
> 赞同：0
> 
> 时间：2013-04-17T04:40:35.320
> 
> 标签：php, codeigniter

我按照[这个](http://net.tutsplus.com/tutorials/php/easy-authentication-with-codeigniter/)很棒的教程创建了一个非常简单的（一级）登录系统。`login() method in controller`但每次我尝试登录时，我总是重定向回我的登录表单 ( )。

这是我的控制器的代码：

```
public function login() {
        $this->load->library('form_validation');
        $this->form_validation->set_rules('txt_email', 'Email', 'required|valid_email');    

        if($this->form_validation->run() !== FALSE)
        {
            $log_in = $this->backend_m->log_in($this->input->post('txt_email'), $this->input->post('txt_password'));
            if($log_in !== FALSE)
            {
                $_SESSION['username'] = $this->input->post('txt_email');
                redirect('backend/index');
            }
            //redirect('backend/index');
        }

        $this->load->view('backend/login_v');
    } 
```

这是第`backend/index`一个代码（登录后我重定向的**那个，我认为错误在这里，**因为我总是重定向回`backend/login`）：

```
public function index() {
    //check authorization
    if(!isset($_SESSION['username']))
        redirect('backend/login'); 
```

这是我的模型：

```
public function log_in($email, $password) {
        $result = $this->db->where('email', $email)->where('password', sha1($password))->get('mspengurus');     

        if($result->num_rows() > 0 )
            return $result->row();

        return FALSE;
    } 
```

这是我的观点：

```
<body>
    <div id="login">
        <h1>Login - GABDB</h1>
        <?php echo form_open('backend'); ?>
            <table>
                <tr>
                    <td>
                        <?php echo form_label('Email :', 'lbl_email'); ?>
                    </td>
                    <td>
                        <?php echo sha1('admin'); ?>
                        <?php echo form_input('txt_email', set_value('txt_email'), 'id="txt_email"'); ?>
                        <?php echo validation_errors(); ?>
                    </td>
                </tr>
                <tr>
                    <td>
                        <?php echo form_label('Password :', 'lbl_password'); ?>
                    </td>
                    <td>
                        <?php echo form_password('txt_password', '', 'id="txt_password"'); ?>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <?php echo form_submit('btn_submit', 'Log In', 'id = "btn_submit"'); ?>
                    </td>
                </tr>
            </table>
        <?php echo form_close(); ?>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:27:04.570

使用此方法在您的 login() 函数中设置会话

```
$this->load->library('session'); 
$seesion_data = array(
                   'username'  => $this->input->post('txt_email'),

                   'logged_in' => TRUE
               );

 $this->session->set_userdata($seesion_data); 
```

在 index() 函数中使用它

```
$this->load->library('session');
$username = $this->session->userdata('username');
if(empty($username)){
 redirect('backend/login');
} 
```

# magento - 搜索到的产品描述错误

> ID：16051632
> 
> 赞同：0
> 
> 时间：2013-04-17T04:40:48.353
> 
> 标签：magento, magento-1.7

我正在做[这个](http://toolskaart.com)。如果我们去一个特定的产品，那么该产品将被完美地展示出来。但是如果我们通过在搜索栏中找到任何产品，它会显示为[这样](http://toolskaart.com/index.php/dia-19mm-carbide-drill-1901.html)。呈现此显示的页面是相同的。我猜问题出在“$parentId = Mage::registry('current_category')->getParentId();” 问题是“当前类别”。请提出一些 if 条件，以便它可以正确显示导航和搜索项目的内容。我的代码是这样的。请帮助我。

```
<?php 
$parentId = Mage::registry('current_category')->getParentId();
$parent = Mage::getModel('catalog/category')->load($parentId);
$parentname = $parent->getName();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T07:18:01.850

当您从类别页面转到产品页面时，Magento 会保存该路径，它也显示在 url 和面包屑中。当您直接进入产品页面时，Magento 对当前类别一无所知，因为产品可能有很多类别或根本没有类别。

您可以尝试从注册表中获取当前类别，然后检查它是否为空：

```
$currentCat = Mage::registry('current_category');
if ($currentCat) {
$parent = Mage::getModel('catalog/category')->load($currentCat->getParentId());
//do what you need with parent
} 
```

如果您的产品页面布局需要，您还可以通过获取当前产品的所有类别并获取其中一个的父类别来获取*某些父类别。*

# php - 阅读电子邮件 imap php

> ID：16051633
> 
> 赞同：0
> 
> 时间：2013-04-17T04:40:50.057
> 
> 标签：php, mysql, codeigniter, imap

我使用 PHP - Codeigniter (Peeker Library) 作为后端，并使用 IMAP 从多个电子邮件地址获取电子邮件。

我们有一些复杂的搜索条件来查询 imap 文件夹，为了提高脚本的性能，我们只搜索新电子邮件并存储邮箱名称、唯一 ID（邮箱中唯一）、MySQL 表中的一些标题信息。

我想出了两个问题：

1.  我如何跟踪`Deleted / Moved`项目？
2.  有没有办法确定附件是否存在？（因为标题信息没有为附件指示提供任何线索，我尝试使用`imap_fetchstructure`但它会读取包括附件在内的整个邮件，这需要很长时间才能处理）

**笔记 ：**

> 我定期在后端运行此脚本（但不是 cron 作业，外部应用程序将定期初始化脚本）。此外，我正在使用 PHP 执行所有这些操作，但有其限制。

请帮我。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T08:06:05.463

为什么你不使用[php imap](http://php.net/manual/en/book.imap.php)？与 peeker 库和 php imap 相比，它简单且非常快，总是会收到新的电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T13:15:56.770

首先，在 IMAP 中，没有任何要求意味着`FETCH BODYSTRUCTURE`要传输带有附件的完整消息数据。要么你的假设是错误的，要么你的 IMAP 库有一个严重的错误，或者你在这里使用了错误的函数。

其次，您提到了跟踪 UID，但没有提及`UIDVALIDITY`. 阅读[RFC 3501](https://www.rfc-editor.org/rfc/rfc3501)以了解其含义。在不了解协议的情况下，您无法正确实现与 IMAP 对话的应用程序。更多的指针也在[RFC 4549](https://www.rfc-editor.org/rfc/rfc4549)中给出。

您的第三个问题是关于询问已删除或移动的项目。在基线 IMAP 中，您不能这样做。要知道哪些消息已被删除以及哪些是新消息，唯一的方法是明确跟踪 UID——假设`UIDVALIDITY`给出并且没有更改，您将自上次以来的 UID 列表与您现在得到的进行比较，并且看看哪些是新的，哪些是过去的。再次阅读 RFC，它们包含对您所有问题的答案以及有关如何优化同步过程的建议。还有[一篇关于 IMAP 的论文，](http://trojita.flaska.net/msc-thesis.pdf)其中更详细地介绍了如何进一步改进协议聊天以及哪些扩展是相关的。不过，这不是一个容易的项目。

# mysql - mysql中的日期时间数据类型

> ID：16051642
> 
> 赞同：0
> 
> 时间：2013-04-17T04:42:04.977
> 
> 标签：mysql, datetime

我的 mysql 表中有一个字段，它的数据类型是`datetime` ，默认值是`CURRENT_TIMESTAMP`. 我认为它只会将此值放在插入上。这在插入和更新时都发生了变化。合适吗？

我没有`ON UPDATE CURRENT_TIMESTAMP`，然后它也在更新该列。

我的问题是，如果我只有一个具有数据类型`datetime`和默认值`CURRENT_TIMESTAMP`的列，那么当记录更新发生时它是否会更改该列，即使`ON UPDATE CURRENT_TIMESTAMP`不存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:51:51.893

听起来好像你有：

```
DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP 
```

但是，您似乎想要：

```
DEFAULT CURRENT_TIMESTAMP 
```

这两者之间的区别在于，第一个将在插入和更新时更新时间戳列，第二个将仅在插入期间提供 TIMESTAMP，并且*不会*在更新行时更新。

`DESCRIBE`您可以通过使用MySQL 中的函数来描述特定表的模式来检查表正在使用什么。

[http://dev.mysql.com/doc/refman/5.0/en/timestamp-initialization.html](http://dev.mysql.com/doc/refman/5.0/en/timestamp-initialization.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:52:15.633

来自[mysql 文档](http://dev.mysql.com/doc/refman/5.0/en/timestamp-initialization.html)

使用`DEFAULT CURRENT_TIMESTAMP`和`ON UPDATE CURRENT_TIMESTAMP`时，该列的默认值具有当前时间戳，并自动更新为当前时间戳。

```
CREATE TABLE t1 (
  ts TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
); 
```

没有`DEFAULT CURRENT_TIMESTAMP`也没有`ON UPDATE CURRENT_TIMESTAMP`，它与同时指定`DEFAULT CURRENT_TIMESTAMP`和相同`ON UPDATE CURRENT_TIMESTAMP`。

```
CREATE TABLE t1 (
  ts TIMESTAMP
); 
```

如果有`DEFAULT`子句但没有`ON UPDATE CURRENT_TIMESTAMP`子句，则该列具有给定的默认值，并且不会自动更新为当前时间戳。

默认值取决于`DEFAULT`子句是指定`CURRENT_TIMESTAMP`还是常量值。使用`CURRENT_TIMESTAMP`时，默认为当前时间戳。

```
CREATE TABLE t1 (
  ts TIMESTAMP DEFAULT CURRENT_TIMESTAMP
); 
```

# php - 根据深度使用自定义函数对多维数组进行排序

> ID：16051646
> 
> 赞同：0
> 
> 时间：2013-04-17T04:42:39.077
> 
> 标签：php, multidimensional-array, sorting

我正在尝试根据排序函数的当前活动深度对多维数组进行排序。如果它对它接触的第一个数组进行排序，则活动深度将为 0。如果对第二个数组进行排序，则为 1，依此类推。

我的基本数组结构如下：

```
$arr[$year][$monthName][$dayNumber] = $somelink; 
```

我在文件名的 for 循环中使用正则表达式生成数组。那部分并不重要。

至于具体的数组结构..`$year`是数值，比如2012或者2013，`$monthName`是月份的名称，比如April或者March，`$dayNumber`当然是天数，补零，最后，`$somelink`包含 html 标记，目前这并不重要。

进入实际问题.. 这个脚本的一部分我不会展示（除非要求），它使用数组的当前结构来创建一个基于列表的菜单。从今天开始，剧本开始表现得很奇怪；4 月出现在 3 月之前，以及 1 之前的第 16 天。我尝试使用以下功能解决此问题，但收效甚微；我真的无法......弄清楚让它工作的逻辑。

预期的输出是从最低到最高的年份，从顶部开始，月份以相同的方式排序，尽管按编号而不是名称，天的排序方式与年份相同。最后一个链接在这里并不重要，我不打算对它进行排序。

图示的预期输出（未显示链接以保持简短）：

```
2012
 |--March
      |-1
      |-15
      |-16
 |--April
 |--May
2013
 |--March
      |-1
 |--April
      |-1
      |-15
      |-16 
```

这是我到目前为止所尝试的：

```
function mon_sort($a,$b) {
    if (date("n",strtotime($a)) == date("n",strtotime($b))) { return 0; }
    return (date("n",strtotime($a)) > date("n",strtotime($b)) ? 1 : -1);
}
function menu_sort($arr,$depth) {
    $newarr = array();
    if ($depth == 0) {
        ksort($arr);
    }
    else if ($depth == 1) {
        uksort($arr,'mon_sort');
    }
    else {

    }
    foreach ($arr as $key => $value) {
        if (is_array($value)) {
            $depth++;
            $value = menu_sort($value,$depth);
        }
        $newarr[$key] = $value;
    }
    return $newarr;
} 
```

根据`mon_sort()`函数，我还应该注意，三元运算符中的 1:-1 并不重要，因为我已经尝试过两种方式，但每次都失败，所以这不是问题。

在上述情况下，我并没有真正..问一个问题，我想知道我在这里做错了什么，以及我需要做些什么来解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:11:06.880

你应该编写你的函数来就地排序，就像`ksort`和`uksort`一样

```
function mon_sort($a,$b) {
    if (date("n",strtotime($a)) == date("n",strtotime($b))) { return 0; }
    return (date("n",strtotime($a)) > date("n",strtotime($b)) ? 1 : -1);
}
function menu_sort(&$arr,$depth = 0) {
    if ($depth == 1) {
        uksort($arr,'mon_sort');
    } else {
        ksort($arr);
    }
    foreach ($arr as $key => &$value) {
        if (is_array($value)) {
            menu_sort($value,$depth + 1);
        }
    }
} 
```

# java - 无法从接口调用方法

> ID：16051648
> 
> 赞同：0
> 
> 时间：2013-04-17T04:42:55.807
> 
> 标签：java

大家好，我有一个程序是图书馆管理程序

我有一个名为 borrowHolding(holdingId)throws BalanceLow, InvalidHolding 的方法，我从模型接口调用该方法，该接口调用外观类，将方法调用传递给库类，但从这里方法定义在接口借用者中声明，另一个接口成员扩展了这个借用者接口然后 AbstractMember 实现了 borrowHoling 方法，可以将小代码片段清晰：

所有导入都是正确的，并且每个类和接口都在不同的类中分开。

```
 public interface LMSModel {
    public void borrowHolding(int holdingId)
                throws InsufficientCreditException, MultipleBorrowingException;
    }

    public class LMSFacade implements LMSModel {
    private Library lib = new Library();
        private Member member;
    public void borrowHolding(int holdingId)
                throws InsufficientCreditException, MultipleBorrowingException {
            // TODO Auto-generated method stub
            lib.borrowHolding(holdingId);

        }
    }

    public class Library {
    public Member member;
    public void borrowHolding(int holdingId) throws InsufficientCreditException, MultipleBorrowingException {

            member.borrowHolding(holdingId);
        }
    }

        public interface Member extends Borrower{
    public abstract Holding[] getCurrentHoldings(); 
        public abstract double getMaxCredit();  
        public abstract void resetCredit();
        public abstract String getFullName();
        public abstract String getMemberId();

    }

    public abstract class AbstractMember implements Member, Borrower {
        public void borrowHolding(int holdingId)
                    throws InsufficientCreditException, MultipleBorrowingException {

            // TODO Auto-generated method stub

                System.out.println("Hello");
    //      Map<Integer, Holding> LibHoldingMap = libCollection.holdingMap;     
    //      holding = (Holding)LibHoldingMap.get((Integer)holdingId);
    //      
    //      if (holding.isOnLoan()) {
    //          System.out.println("Can not be issued Currently on Load");
    //      } else {
    //          System.out.println("Can be issued");
    //      }
        }
    }

    public interface Borrower {
        void borrowHolding(int holdingId)throws InsufficientCreditException, MultipleBorrowingException; 
    } 
```

当我调用borrowHolding 我得到nullPointerException 我不知道该方法不能被调用不知道为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:44:54.077

`member`属性永远不会在您的类中初始化，因此每次尝试使用它时`Library`都会得到一个。`NullPointerException`

由于`member`是接口的实例，`Member`因此您不能直接构造它。为此，您应该提供一个实现该`Member`接口的类。我发布了两个如何解决此问题的示例：

1.  使用实现接口的类：

    ```
    public class MemberImpl implements Member {
        public void borrowHolding(int holdingId)
            throws InsufficientCreditException, MultipleBorrowingException {
            //some code here...
        }
    }

    public class Library {
        public Member member = new MemberImpl();
        //...
    } 
    ```

2.  实例化一个实现接口的匿名类：

    ```
    public class Library {
        public Member member = new Member() {
            public void borrowHolding(int holdingId)
                throws InsufficientCreditException, MultipleBorrowingException {
                //some code here...
            }
        };
        //...
    } 
    ```

A̶l̶t̶e̶r̶n̶a̶t̶i̶v̶e̶l̶y̶,̶ ̶s̶i̶n̶c̶e̶ ̶y̶o̶u̶ ̶h̶a̶v̶e̶ ̶a̶d̶d̶e̶d̶ ̶a̶n̶ ̶i̶m̶p̶l̶e̶m̶e̶n̶t̶a̶t̶i̶o̶n̶ ̶t̶o̶ ̶t̶h̶e̶ ̶ `̶b̶o̶r̶r̶o̶w̶H̶o̶l̶d̶i̶n̶g̶`̶ ̶m̶e̶t̶h̶o̶d̶ ̶i̶n̶s̶i̶d̶e̶ ̶ `̶M̶e̶m̶b̶e̶r̶`̶ ̶i̶n̶t̶e̶r̶f̶a̶c̶e̶,̶ ̶t̶h̶i̶s̶ ̶m̶e̶a̶n̶s̶ ̶t̶h̶a̶t̶ ̶y̶o̶u̶ ̶w̶a̶n̶t̶e̶d̶ ̶t̶o̶ ̶d̶e̶c̶l̶a̶r̶e̶ ̶a̶ ̶c̶l̶a̶s̶s̶ ̶i̶n̶s̶t̶e̶a̶d̶ ̶o̶f̶ ̶a̶n̶ ̶i̶n̶t̶e̶r̶f̶a̶c̶e̶

```
public class Member implements Borrower {
    //...
} 
```

O̶t̶h̶e̶r̶w̶i̶s̶e̶,̶ ̶i̶f̶ ̶ `̶M̶e̶m̶b̶e̶r̶`̶ ̶i̶s̶ ̶i̶n̶d̶e̶e̶d̶ ̶a̶n̶ ̶i̶n̶t̶e̶r̶f̶a̶c̶e̶,̶ ̶r̶e̶m̶e̶m̶b̶e̶r̶ ̶t̶h̶a̶t̶ ̶i̶n̶t̶e̶r̶f̶a̶c̶e̶s̶ ̶*̶*̶d̶o̶ ̶n̶o̶t̶ ̶i̶m̶p̶l̶e̶m̶e̶n̶t̶ ̶a̶n̶y̶ ̶m̶e̶t̶h̶o̶d̶*̶*̶,̶ ̶t̶h̶e̶y̶ ̶j̶u̶s̶t̶ ̶d̶e̶f̶i̶n̶e̶ ̶t̶h̶e̶ ̶c̶o̶n̶t̶r̶a̶c̶t̶ ̶t̶h̶a̶t̶ ̶t̶h̶e̶ ̶i̶m̶p̶l̶e̶m̶e̶n̶t̶e̶r̶ ̶c̶l̶a̶s̶s̶ ̶m̶u̶s̶t̶ ̶f̶o̶l̶l̶o̶w̶.̶

编辑：

与接口类似，抽象类**不能直接实例化**，您需要一个扩展抽象类的类。该解决方案将类似于提供的解决方案：

1.  使用直接扩展抽象类的`AbstractMember`类：

    ```
    public ConcretMember extends AbstractMember {
    }

    public class Library {
        public Member member = new ConcretMember();
        //...
    } 
    ```

2.  实例化一个扩展抽象类的匿名`AbstractMember`类：

    ```
    public class Library {
        public Member member = new AbstractMember() {
            @Override
            public void borrowHolding(int holdingId)
                throws InsufficientCreditException, MultipleBorrowingException {
                //some code here...
            }
        };
        //...
    } 
    ```

# java - 使用弹簧定型的优点？

> ID：16051656
> 
> 赞同：25
> 
> 时间：2013-04-17T04:43:25.530
> 
> 标签：java, spring, spring-mvc, annotations

我正在使用 spring-mvc 开发一个 Web 应用程序。

现在可以使用@Controller、@Service 和@Repository 构造型。

我发现 @Controller 特别有用，特别是因为我正在使用

```
<context:component-scan base-package="my.cool.controller"/> 
```

现在，关于@Service 和@Repository，到目前为止看起来像

1.  如果使用正确的构造型注释类，则可以更好地处理异常，好的，这是我承认的优势
2.  我可以对服务和 DAO/存储库使用组件扫描，但是我不喜欢使用组件扫描的想法，因为它会减慢应用程序的启动时间，这对我来说是一个关键功能（即使它只是1 秒，我每周重新部署一次）

那么，除了更好的例外，还有其他优势吗？注释类对性能有影响吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-04-19T12:54:15.587

**刻板印象的解释：**

*   `@Service`- 使用@Service 注释所有服务类。该层知道工作单元。您所有的业务逻辑都将在服务类中。通常，服务层的方法都包含在事务中。您可以从服务方法进行多次 DAO 调用，如果一个事务失败，所有事务都应该回滚。
*   `@Repository`- 使用 @Repository 注释所有 DAO 类。您所有的数据库访问逻辑都应该在 DAO 类中。
*   `@Component`- 使用组件构造型注释您的其他组件（例如 REST 资源类）。
*   `@Autowired` - Let Spring auto-wire other beans into your classes using @Autowired annotation.

`@Component` is a generic stereotype for any Spring-managed component. `@Repository`, `@Service`, and `@Controller` are specializations of `@Component` for more specific use cases, for example, in the persistence, service, and presentation layers, respectively.

**Reasons to use them :**

*   The main advantage of using @Repository or @Service over @Component is that it's easy to write an AOP pointcut that targets, for instance, all classes annotated with @Repository.
*   You don't have to write `bean` definitions in context xml file. Instead annotate classes and use those by autowiring.
*   Specialized annotations help to clearly demarcate application layers (in a standard 3 tiers application).

Now, Practically performance impact of using context xml beans & annotations is the same. Component scanning is a bit more expensive (when you scan for @Service, @Component). The annotations are 'parsed' with reflection, the xml - with an xml parser. But, as you said, it is startup-time - it happens only once. And on a moderate machine it starts pretty quickly even with annotations.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T05:50:56.493

组件扫描使您免于通过 xml 或 java 配置手动定义每个 bean。

有多种立体类型来定义服务层、数据层等层。同样基于不同的立体类型，如果你想做一些特定的事情，那么你可以这样做。

# winapi - win32中的子窗口绘制问题

> ID：16051659
> 
> 赞同：0
> 
> 时间：2013-04-17T04:43:32.780
> 
> 标签：winapi, win32gui

首先，这是我想要实现的理想外观，但白色区域的圆角，并且没有完全成功 ![所需的外观，但白色区域的圆角](https://i.stack.imgur.com/w3IrJ.png)

为了实现这一点，我已经确定了要变为白色的矩形的屏幕坐标，并创建了一个静态文本窗口并使用以下方法设置了一个圆角区域：

```
case WM_CREATE:
    SetRect( &Rect,... );
                hSubWnd = CreateWindow("STATIC",NULL,SS_LEFT|WS_CHILD|WS_VISIBLE,Rect.left,Rect.top,(Rect.right-Rect.left),(Rect.bottom-Rect.top),hFrame,(HMENU)NULL,NULL,NULL);

                hrgn = CreateRoundRectRgn(Rect.left, Rect.top, Rect.right, Rect.bottom,15,15);
                SetWindowRgn(hSubWnd,hrgn,TRUE); 
```

然后为上面的区域设置着色，我使用了以下内容：

```
case WM_CTLCOLORSTATIC:
            //SetBkColor((HDC)wParam, RGB(0,0,0));
            if((HWND)lParam == hSubWnd)
            {
                SetBkMode((HDC)wParam,TRANSPARENT);

                return (INT_PTR )CreateSolidBrush(RGB(255,255,255));
            }
            break; 
```

这使得该区域颜色为白色，但白色区域没有像我预期的那样变圆。以下是我的问题：

1-如何使 SetWindowRgn() 为子控件工作？我的方法是正确的还是我需要采取其他方式来实现我的目标（四舍五入孩子的角落）？

2-父窗口启用了 WS_CLIPCHILDREN 样式，这意味着我在主窗口的 WM_PAINT 中所做的任何事情都不会绘制子窗口区域。我还需要将一些文本放在子窗口的白色区域中。我在哪里做呢？TextOut() 似乎在 WM_CTLCOLORSTATIC 处理程序中不起作用。

我是否应该将孩子的窗口类从“STATIC”更改为某个自定义类并为孩子编写 WindowProc()，其中我处理 WM_PAINT 以在其上绘制文本？

请提供您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T07:22:46.440

既然您说您正在处理`WM_PAINT`您的主窗口以绘制文本，我建议完全跳过子控件和区域的复杂性。

我的意思是，你想要的只是窗口背景上的一个白色圆角矩形？所以自己画吧。使用该[`RoundRect`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162944.aspx)函数可以轻松完成此操作。

如果您需要静态控件来确定 RoundRect 的坐标（这可以在处理不同的 DPI 设置时使事情变得更容易），您可以将其保留在那里但使其不可见。

示例代码：

```
void OnPaint(HWND hWnd)
{
    PAINTSTRUCT ps;
    BeginPaint(hWnd, &ps);

    // Create and select a white brush.
    HBRUSH hbrWhite = CreateSolidBrush(RGB(255, 255, 255));
    HBRUSH hbrOrig = SelectObject(ps.hdc, hbrWhite);

    // Create and select a white pen (or a null pen).
    HPEN hpenWhite = CreatePen(PS_SOLID, 1, RGB(255, 255, 255));
    HPEN hpenOrig = SelectObject(ps.hdc, hpenWhite);

    // Optionally, determine the coordinates of the invisible static control
    // relative to its parent (this window) so we know where to draw.
    // This is accomplished by calling GetClientRect to retrieve the coordinates
    // and then using MapWindowPoints to transform those coordinates.

    // Draw the RoundRect.
    RoundRect(ps.hdc, Rect.left, Rect.top, Rect.right, Rect.bottom, 15, 15);

    // If you want to draw some text on the RoundRect, this is where you do it.
    SetBkMode(ps.hdc, TRANSPARENT);
    SetTextColor(ps.hdc, RGB(255, 0, 0)); // red text
    DrawText(ps.hdc, TEXT("Sample Text"), -1, &Rect, DT_CENTER);

    // Clean up after ourselves.
    SelectObject(ps.hdc, hbrOrig);
    SelectObject(ps.hdc, hpenOrig);
    DeleteObject(hbrWhite);
    DeleteObject(hpenWhite);
    EndPaint(hWnd, &ps);
} 
```

# java - 多线程多客户端聊天服务器

> ID：16051661
> 
> 赞同：0
> 
> 时间：2013-04-17T04:43:37.557
> 
> 标签：java, multithreading, sockets, chat, outputstream

我知道标题很糟糕，但让我解释一下我的情况。好的，我正在制作一个服务器，它坐在一边并与我的 Minecraft 客户端进行通信。我可以让一个客户端连接和传输数据，第四个。当我尝试与第二个客户端连接时，出现错误：

```
java.net.SocketException: Connection reset by peer: socket write error
at java.net.SocketOutputStream.socketWrite0(Native Method)
at java.net.SocketOutputStream.socketWrite(Unknown Source)
at java.net.SocketOutputStream.write(Unknown Source)
at java.io.ObjectOutputStream$BlockDataOutputStream.drain(Unknown Source)
at java.io.ObjectOutputStream$BlockDataOutputStream.setBlockDataMode(Unknown Source)
at java.io.ObjectOutputStream.<init>(Unknown Source)
at ConnectionHandler.setupStreams(ConnectionHandler.java:71)
at ConnectionHandler.HandleChat(ConnectionHandler.java:30)
at ConnectionHandler.<init>(ConnectionHandler.java:23)
at Server.waitForConnection(Server.java:118)
at Server.RunAll(Server.java:65)
at Server.run(Server.java:50)
at ServerTest.main(ServerTest.java:9) 
```

因此，结果代码如下：

setupStreams：第 71 行

```
public static void setupStreams() throws IOException
{
    for(int i = 1; i <= Server.ConnectionArray.size(); i++)
    {
        Socket TempSocket = (Socket) Server.ConnectionArray.get(i - 1);
        output = new ObjectOutputStream(TempSocket.getOutputStream());//Line 71
        output.flush();
        input = new ObjectInputStream(TempSocket.getInputStream());
        whileChatting();
    }
} 
```

现在我觉得最好解释一下所有这些代码是如何设置的：

它从一个名为 ServerTest.Java 的类开始：

```
public class ServerTest
{
    public static void main(String[] args)
    {
        Server Minecraft = new Server();
        Minecraft.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        Minecraft.run();
    }
} 
```

我称这个对象为“我的世界”。

现在它引用的类也实现了 Runnable 类并以 run() 方法开始。这是那个方法：

```
@Override
public void run()
{  
    RunAll();
}

public void RunAll()
{
    ConnectionHandler.showMessage("Waiting for client connections...");
    try
    {

        server = new ServerSocket(1337, 10);
        while(true)
        {
            try 
            {
                waitForConnection();
            }
            catch (IOException e)
            {
                e.printStackTrace();
            }
        }
    }
    catch(IOException Exception)
    {
        Exception.printStackTrace();
    }
    finally
    {
       ConnectionHandler.closeCrap();
    }
} 
```

现在从这里开始等待连接，我认为它会反复循环，但我不知道。这是该方法的代码：

```
public void waitForConnection() throws IOException
{
   connection = server.accept();
   ConnectionArray.add(connection);
   ConnectionHandler connections = new ConnectionHandler(connection);
   connection = null; 
} 
```

现在我认为这个方法的作用是接受来自客户端的传入连接，然后将该连接添加到我的套接字数组中，然后将套接字交给处理程序类，然后将原始套接字设置回 Null 以等待另一个传入连接.

现在这将我们带到 ConnectionHandler 类。在这里，它需要一个套接字 X 并将其设置为全局套接字，如下所示：

```
static Socket Socket;
public PrintWriter Out;
String Message = "";
public static ObjectOutputStream output;
public static ObjectInputStream input;
public static int Players = 0;

public ConnectionHandler(Socket X)
{
    this.Socket = X;
    HandleChat();
} 
```

该类还实现了 Runnable 类。但正如您所看到的，它将全局套接字设置为 X 然后运行 ​​HandleChat(); 这是方法：

```
public static void HandleChat()
{
    try
    {
        setupStreams();
    }
    catch (IOException e)
    {
        e.printStackTrace();
    }

} 
```

如您所见，这一切都在运行 setupStreams(); 方法。这也是该方法：

```
public static void setupStreams() throws IOException
{
    for(int i = 1; i <= Server.ConnectionArray.size(); i++)
    {
        Socket TempSocket = (Socket) Server.ConnectionArray.get(i - 1);
        output = new ObjectOutputStream(TempSocket.getOutputStream());
        output.flush();
        input = new ObjectInputStream(TempSocket.getInputStream());
        whileChatting();
    }
} 
```

现在我“思考”这个方法创建一个名为 TempSocket 的新套接字，并使其 = 数组中的最新连接，然后将输出和输入流设置到该套接字，从而为该单个客户端生成一个套接字，然后运行 ​​whileChatting(); 这是生成的代码：

```
public static void whileChatting() throws IOException
{
    String message = "";
    do
     {
         try
         {
             message = (String) input.readObject();
             showMessage("\n" + message);
             sendMessage("", message); 
         }
         catch(ClassNotFoundException classNotFoundException)
         {
             ConnectionHandler.showMessage("\n idk wtf that user sent!");
         }
      }while(!message.equals("/stop"));
} 
```

再次与“思考”在这里。我认为读取对象被设置为字符串消息；然后被发送到客户端并显示在控制台屏幕上。(Swing) 下面是方法 (Send) 和 (Show) 的代码：

```
public static void sendMessage(String message, String returnedMessage)
{
    try
    {
    if(!message.isEmpty())
    {
        output.writeObject("\247c[Server]\247d " + message);
    }
    else
    {
        output.writeObject(returnedMessage);
    }
        output.flush();
        showMessage("\n[Server] " + message);
    }
    catch(IOException ioException)
    {
        Server.chatWindow.append("\n ERROR: DUDE I CANT SEND THAT MESSAGE");
    }
 }

static void showMessage(final String text)
   {
      SwingUtilities.invokeLater
      (
         new Runnable()
         {
            public void run()
            {
                Server.chatWindow.append(text);
            }
         }
      );
   } 
```

现在你可以在这里看到，当我想在客户端显示一条消息时；我希望它看起来像：[Server] 文本。此外，您会注意到它还 sys 返回了消息。我将客户端设置为仅发送到服务器，然后在屏幕上显示返回的内容，所以可以说我输入“Hay”它在发送时不会在我的屏幕上显示任何内容，但是一旦服务器收到它，它会将确切的文本发送回给我每个人。这就是 sendMessage(); 方法。现在的显示方法比较简单。它在接收时显示文本。

简而言之，这就是代码。我宁愿给你留下太多的信息，也不愿让你坐在这里想知道发生了什么。我将再一次更深入地解释我的情况。我正在制作一个与我的 Minecraft 客户端通信的服务器。一个客户端连接正常，但是当另一个客户端尝试连接它时出错并且当第一个客户端断开连接时，服务器将不允许客户端重新连接。我认为这可能与连接数组有关，并且套接字在断开连接时没有从数组中删除，但我不知道。现在最后，我的问题是如何解决这些错误？提前感谢我对这个问题的任何回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:49:13.510

似乎在您调用 setupStreams 的每个用户连接上都会循环所有连接。

这意味着如果用户 1 连接您为用户打开输出套接字，第二个用户连接您再次循环遍历所有连接并再次为已经打开的用户 1 打开输出蒸汽。你需要 setupStreams 你不能为用户打开输出 stearm 两次\我也认为你在这里有错误

```
 for(int i = 1; i <= Server.ConnectionArray.size(); i++) 
```

您从 1 开始而不是从 0 开始。并与 <= 而非 < 进行比较。我不知道为什么，ConnectionArray 的类型是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:43:38.710

```
public void waitForConnection() throws IOException
{
   connection = server.accept();
   ConnectionArray.add(connection);
   ConnectionHandler connections = new ConnectionHandler(connection);
   connection = null; 
} 
```

`connection`未找到，因此这不是实际代码，或者您将此临时变量存储在成员或全局中。在任何一种情况下，增加临时变量的范围以跨越不同的函数都是不好的，多线程就像杂耍电锯一样。顺便说一句：将连接处理程序存储在列表中比创建它们并将其套接字存储在列表中更自然。这是一种责任不明确的情况，导致代码不清晰和错误。

虽然上述案例可能仍然无害，但它仍然显示出糟糕和危险的风格。你继续使用这种风格（至少它是一致的！）“......它需要一个套接字 X 并将其设置为全局套接字，如图所示......”：

```
static Socket Socket;

public ConnectionHandler(Socket X)
{
    this.Socket = X;
} 
```

制作`Socket Socket`成静态的，在这个类的所有实例之间共享，这显然不是你想要的。您现在应该知道为什么全局变量被认为是不好的以及为什么类静态变量只是伪装的全局变量。

摘要：决定谁访问哪些部分。如果它只是一个对象，则将部分设为私有成员，以便编译器确保它实际上只是一个对象。尽量不要共享状态。如果多个对象和线程访问一个对象，请计划好它们如何不互相干扰。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-04T13:27:00.563

我建议使用某种 API，因为这只是（*抱歉*）混乱的代码。[这](http://netty.io/) 是我使用的那个。它为您做所有事情，它创建线程，打开套接字并且它是基于事件的！因此，您不必遍历所有套接字来读取所有数据，当有可用时您会收到通知！

# javascript - javascript字符串替换为RegExp

> ID：16051666
> 
> 赞同：0
> 
> 时间：2013-04-17T04:44:10.650
> 
> 标签：javascript, regex

我遇到了 javascript RegExp 的问题。`a.href`当我单击按钮时，我想用值替换`textbox`。但是，我不想替换整个字符串，只想找到并替换那些与我的 RegExp 完全匹配的字符串。这是我的代码

```
$(document).ready(function(){
    $('#btnRun').click(function(){
        var str = encodeURIComponent($('#mydata').val());
        var regExp = new RegExp('\\b' +encodeURIComponent( $('a').html()) + '\\b','gi');
        $('a').attr('href',$('a').attr('href').replace(regExp,str));
    });
}); 
```

这是我的测试代码 [http://jsfiddle.net/4uAp5/1/](http://jsfiddle.net/4uAp5/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:51:40.167

不要认为你需要一个正则表达式来做到这一点。此代码应完成您所描述的内容：

```
$('a').attr('href',$("#mydata").val()); 
```

另外值得注意的是，您定位链接的方式 – `$('a')`– 将选择页面上的*每个*链接...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T04:54:16.693

`\\b`不匹配，因为 href 值已编码并导致（在此特定示例中）为`cMyTest1`. `c`不满足`\\b`。根据具体情况有多种解决方案。一种是`decodeURI`在使用正则表达式之前先在 href 上使用，然后再对其进行编码（尽管可能不需要）。

[http://jsfiddle.net/4uAp5/4/](http://jsfiddle.net/4uAp5/4/)

# c# - 在 POST 编辑中保存表单不起作用

> ID：16051668
> 
> 赞同：1
> 
> 时间：2013-04-17T04:44:26.463
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, entity-framework-4

我有一个控制器方法，我试图保存在视图中编辑的表单。

```
[HttpPost]
public ActionResult ModifyContract(ModContract mod)
{
    // submit modified contract
    if (ModelState.IsValid)
    {
        OutlookMediaEntities1 db = new OutlookMediaEntities1();

        db.ObjectStateManager.ChangeObjectState(mod, EntityState.Modified);

        // save changes
        db.SaveChanges();

        return RedirectToAction("ContractDetails", "Contract", new { id = (int) ViewData["contractid"] });
    }
    else
    {
        ModelState.AddModelError("", "Missing necessary information");
        return View();
    }
} 
```

我在 db.ObjectStateManager... 行上收到 InvalidOperationException。我看到一些说这可能是因为我没有分配主键并注意到我的 ModAds 类（如下）不包含主键。添加了它，但我得到了同样的错误。我尝试按照我之前问题中回答者的建议执行 db.Attach(mod) ，但出现编译器错误。Attach 将“IEntityWithKey”作为参数。所以显然我的实体没有密钥，所以我认为我声明模型内容的方式一定有问题。

```
 public class ModContract
    {
        public int contract_id; // primary key?
        public string contract_name { get; set; }
        public List<ModAds> ads;

        public string print_product_id { get; set; }
        public string print_ad_option_id { get; set; }
    }

    public class ModAds
    {
        public int contr_ad_id; // primary key?
        public string name;
        public string product_name;
        public string adv_product;
        public List<string> editions;
        public double freq_disc;
        public double other_dis_dol;
        public double? other_dis_per;
        public string non_cash_note;
        public double non_cash_cons;
    } 
```

有没有办法指定主键是什么？我的模型有点奇怪，因为如您所见，我在 ModContract 中有一个 ModAd 列表。不确定这是否是个问题。此外，我尝试向所有字段添加 getter 和 setter 以查看是否是问题所在，但我遇到了同样的错误。

我也尝试保存`db.Entry(model).State = EntityState.Modified;`但没有用，因为我使用的是 EF 4.0。

任何帮助是极大的赞赏！

**编辑**

我想我知道出了什么问题，模型是由一堆不同的数据库表组成的，即没有表 ModContract。我很确定我必须以某种方式将模型内容分散到适当的表和列中..

**编辑 2**

OutlookMediaEntities1 的 Pastebin：http: [//pastebin.com/YyrhjGDA](http://pastebin.com/YyrhjGDA)

**编辑 3**

这是 GET ModifyContract 方法，它显示了我如何查询数据库以制作模型。

```
 public ActionResult ModifyContract(int id)
    {
        ViewData["contractid"] = id; // save id

        // get data from db
        OutlookMediaEntities1 db = new OutlookMediaEntities1();
        var cont = from printContractAd in db.print_contract_ads
                   from printContracts in db.print_contracts
                   where printContracts.contract_id == id
                   select new { printContracts.contract_id, printContracts.note }; // name

        // select the ads for this contract
        var ads = from printContractAd in db.print_contract_ads
                  from printAdOption in db.print_ad_option
                  from printContract in db.print_contracts
                  from printProduct in db.print_products
                  from contractAdCount in db.Contract_ad_edition_count
                    where printContractAd.print_ad_option_id == printAdOption.print_ad_option_id &&
                          printContract.contract_id == printContractAd.contract_id &&
                          printProduct.print_product_id == printAdOption.print_product_id &&
                          contractAdCount.contract_ad_id == printContractAd.contract_ad_id &&
                          printContract.contract_id == id
                  select new
                  {
                      printContractAd,
                      printAdOption,
                      printProduct,
                      printContract.IsSigned,
                      contractAdCount.CountFreq
                  };

        ModContract con = new ModContract();
        foreach (var c in cont) // only one
        {
            con.contract_id = c.contract_id;
            con.contract_name = c.note;

            break; // only one
        }

        List<ModAds> cads = new List<ModAds>();
        foreach (var ad in ads)
        {
            ModAds mad = new ModAds();
            mad.contr_ad_id = ad.printContractAd.contract_ad_id;
            mad.product_name = ad.printProduct.product_name;
            mad.adv_product = ad.printAdOption.name;
            mad.name = ad.printContractAd.note;
            mad.freq_disc = ad.printContractAd.frequency_discount;
            mad.other_dis_dol = ad.printContractAd.other_discount;
            mad.other_dis_per = ad.printContractAd.other_discount_percent;
            mad.non_cash_note = ad.printContractAd.non_cash_note;
            mad.non_cash_cons = ad.printContractAd.non_cash_discount; // consideration?

            // get editions
            var eds = from contractEditions in db.print_contract_editions
                      where contractEditions.contract_ad_id == ad.printContractAd.contract_ad_id
                      select new
                          {
                              contractEditions
                          };
            mad.editions = new List<string>();
            foreach (var ed in eds)
            {
                mad.editions.Add("Volume " + ed.contractEditions.vol.ToString() + " Issue " + ed.contractEditions.issue.ToString());
            }

            cads.Add(mad);
        }

        con.ads = cads;

        // bind dropdownlist ad options
        var printproductList = from printProduct in db.print_products
                               select printProduct;
        List<SelectListItem> products_list = new List<SelectListItem>();
        List<print_products> products = printproductList.ToList();
        foreach (print_products product in products)
        {
            SelectListItem temp_item = new SelectListItem();
            temp_item.Text = product.product_name;
            temp_item.Value = product.print_product_id.ToString();
            products_list.Add(temp_item);
        }
        ViewData["products_list"] = new SelectList((IEnumerable<SelectListItem>)products_list.ToList(), "Value", "Text");

        // return view with form to modify
        return View(con);
    } 
```

**编辑 4**

如果有帮助，这也是视图（我无法在此处获得格式）： http: [//pastebin.com/SZvzJ9FB](http://pastebin.com/SZvzJ9FB)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:59:36.500

要更新实体，必须将实体附加到`Data Context`.for 这样做，使用`Single`方法从数据上下文中获取实体就足够了。尝试像这样更改您的代码：

```
[HttpPost]
public ActionResult ModifyContract(ModContract mod)
{
    // submit modified contract
    if (ModelState.IsValid)
    {
        OutlookMediaEntities1 db = new OutlookMediaEntities1();

        var updatedMod = db.ModContract.Single(m=>m.contract_id == mod.contract_id);
        TryUpdateModel<ModContract>(updatedMod);
        // save changes
        db.SaveChanges();

        return RedirectToAction("ContractDetails", "Contract", new { id = (int) ViewData["contractid"] });
    }
    else
    {
        ModelState.AddModelError("", "Missing necessary information");
        return View();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:50:04.687

您可以在 ModAds 类中的主键上方添加 [Key] 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:56:04.120

你可以告诉 EF 这`contract_id`是关键：

```
public class ModContract
{
    [Key]
    public int contract_id;
} 
```

并确保属性映射到的数据库列是**`PK`**. 尽管它是否`IDENTITY`基于您使用它的方式可能很重要。

# c++ - 摩尔斯电码解码器在使用散列和计算空白 C++ 时遇到问题

> ID：16051673
> 
> 赞同：0
> 
> 时间：2013-04-17T04:44:39.150
> 
> 标签：c++

我有一个程序我必须使用我不熟悉且不太了解的散列来编写。现在我无法计算我正在阅读的单词之间的空格，如果它是一个字母，它被一个空格分隔，一旦代码生成一个单词，它在被读入时被两个空格分隔。我的解码功能工作正常，但我不知道如何计算空间。这是我尝试过的一件事，但它不起作用，任何帮助都会很棒。

```
string tmp;
MORSE TABLE[20];
int j = 0, f = 0, k = 0;
char x;
while(!infile.eof())
{
    infile >> tmp;
    infile.get(x);
     if(x == ' ') //check if x is a space
     {
       infile.get(x); //read next character
       if(x == ' ') //check and see if next char is a space
        {
          TABLE[k].insert(' '); //insert space into char array for printing
        }
      }

   if(j >= f) //if true create new object
     { 
         k++; f+=100; 
     }  

    TABLE[k].decode(tmp);//pass in string to decode
    j++;
}//end while loop 
```

任何帮助将不胜感激。我不是一个非常高级的 C++ 人，只是一个新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:11:04.400

默认情况下，流会跳过空格，您可以使用[flag](http://www.cplusplus.com/reference/ios/ios_base/flags/)来控制它。但是，我建议您使用基于行的方法，否则您还需要处理换行符：

```
string line;
while(getline(infile, line))
{ ...use line...  } 
```

顺便提一句：

*   `while(!in.eof())`不保证您可以从流中读取。尝试阅读并检查是否成功。上面已经做到了。
*   如果您提供准确的输入和准确的预期输出，将会有所帮助。从字符串流开始，使用文件内容进行初始化，然后从中读取单个元素。在剥离任何不必要的内容后，在此处提供该代码以获得进一步的帮助。

# shell - 期望脚本不向 bash 脚本返回值

> ID：16051677
> 
> 赞同：0
> 
> 时间：2013-04-17T04:45:08.883
> 
> 标签：shell

请帮我解决这个问题。

我已经编写了一个 bash 脚本，如下所示。我的目标是从 bash 脚本中包含的期望脚本中获取返回值。

我制作的脚本如下所示。

> #!/bin/bash
> x=$(expect -c '
> spawn ssh -o StrictHostKeyChecking=no root@10.3.2.0
> expect " *d: "
> send "qbcrootpass\r"
> expect "* #"
> send "res=hello\r"
> send "\$res\r"
> 交互
> ')
> echo $x

但它没有像我预期的那样工作！:(

我需要做什么修改？？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:50:35.277

如果要获取最近退出的前台管道的退出状态，则应使用[`$?`特殊参数](http://www.gnu.org/software/bash/manual/bashref.html#Special-Parameters)：

```
#!/bin/bash
x=$(expect ...)
y=$?
# $x now contains the output from the 'expect' command, and $y contains the
# exit status 
```

# android - Listview onItemClickListener 未执行

> ID：16051678
> 
> 赞同：0
> 
> 时间：2013-04-17T04:45:25.433
> 
> 标签：android, onclicklistener

我迷路了，我看不到为什么当我单击列表视图中的项目时没有执行 OnItemClickListener。我尝试将 android:focusable="false" 添加到列表视图和文本视图中。谢谢你的帮助。

```
 clistArray = new ArrayList<CustomerList>();
     clistDataAdapter = new CustomerListAdapter(this, R.layout.cus_list, clistArray);
 CustView = (ListView)findViewById(R.id.allCustomerList);

     OnItemClickListener cuslistener = new OnItemClickListener (){
        public void onItemClick(AdapterView<?> parent, View view, int position, long id){
                   selectedCustomer = cusdatasource.getCustomer(String.valueOf(id));      
              }
      }

     CustView.setAdapter(clistDataAdapter);
     CustView.setOnItemClickListener(cuslistener);
     CustView.setItemsCanFocus(true); 
```

列表视图.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="horizontal"
android:baselineAligned="False">

<ListView
    android:id="@+id/allCustomerList"
    android:layout_width="200dp"
    android:layout_height="match_parent"
    android:layout_weight="1" >

</ListView> 
```

cus_list.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="horizontal" >

<TextView
    android:id="@+id/clistStop"
    style="@style/WhiteSText"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:background="@drawable/black"
    android:gravity="center|center_horizontal"
    android:text="123" />

<TextView
    android:id="@+id/clistName"
    style="@style/WhiteSText"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:background="@drawable/black"
    android:gravity="left"
    android:text="name kkkkk" />

<CheckBox
    android:id="@+id/clistCheck"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:background="@drawable/black"
    android:textSize="20dp" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:49:23.873

那是因为 checkBox 是可点击的，而 listItem 也是可点击的，所以这里，checkBox 占据了焦点，因此 listItem 不能被点击。

你只需要设置：

设置listItem的所有项目`focusable="false"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:56:15.197

设置复选框 1.Focusable = false 和 2.FocusableInTouchMode = false 的属性。它将起作用...

# android - Android：在 removeCallback() 之后处理程序未停止

> ID：16051681
> 
> 赞同：1
> 
> 时间：2013-04-17T04:45:39.697
> 
> 标签：android, handler

我需要在我的应用程序中实现幻灯片。为此，我使用了`Handler`. 当我单击`play button`时，幻灯片放映开始，播放按钮变为`pause button`。但是当我再次单击以暂停幻灯片放映时，它永远不会暂停。尽管如此，[Runnable 的 run()](http://developer.android.com/reference/java/lang/Runnable.html#run%28%29)仍在继续执行。这是我的代码：

```
public class GalleryImageFullscreen extends TIEBaseActivity implements
    OnClickListener {
PrefStore lang_PrefStore;
Resources res;
Configuration config;
Locale mLocale = null;
String language;
boolean isLocaleChanged = false;
ViewPager imgViewPager;
ArrayList<String> imgUrlList;
private ImageLoader imageLoader;
private DisplayImageOptions options;
int position;
ImageButton btnPrev, btnPlay, btnNext;
public static final String TAG = "TIEGalleryFS";
boolean isPlaying;
Handler mHandler;
SwitchImage swImageRunnable;

protected void onCreate(Bundle savedInstanceState) {
    super.createDefaultView(savedInstanceState);

    _headerBar.view.setVisibility(View.VISIBLE);
    _footerBar.view.setVisibility(View.VISIBLE);

    imgUrlList = getIntent().getStringArrayListExtra(
            GalleryActivity.IMAGE_URL_LIST);
    Log.v(TAG, "IMAGE LIST SIZE = " + imgUrlList.size());

    position = getIntent().getIntExtra("POSITION", 0);
    Log.v(TAG, "IMAGE POSITION = " + position);

    mHandler = new Handler();
    swImageRunnable = new SwitchImage();
    super.setHeaderTitle(getResources().getString(R.string.gallery));

    res = getResources();

    lang_PrefStore = new PrefStore();
    language = lang_PrefStore.getLanguageChoice(
            GalleryImageFullscreen.this, FooterBar.LANG_SELECT);
    Log.v("GalleryImageFullscreen language choice", language);

    config = getBaseContext().getResources().getConfiguration();
    if (!language.equals("")
            && language.equals(config.locale.getLanguage())) {
        mLocale = new Locale(language);
        Locale.setDefault(mLocale);
        config.locale = mLocale;
        getBaseContext().getResources().updateConfiguration(config,
                getBaseContext().getResources().getDisplayMetrics());
        Log.v("GalleryImageFullscreen onCreate languageset", "in if loop");
    }

    init();

    imageLoader = ImageLoader.getInstance();
    imageLoader.init(ImageLoaderConfiguration
            .createDefault(GalleryImageFullscreen.this));

    options = new DisplayImageOptions.Builder()
            .showStubImage(R.drawable.image_for_empty_url)
            .showImageForEmptyUri(R.drawable.image_for_empty_url)
            .cacheInMemory().cacheOnDisc()
            .bitmapConfig(Bitmap.Config.RGB_565).build();
}// onCreate

private void init() {
    loadFormFromResource(R.layout.gallery_image_fullscreen);
    imgViewPager = (ViewPager) findViewById(R.id.imgpager);
    btnPrev = (ImageButton) findViewById(R.id.btnPrev);
    btnPlay = (ImageButton) findViewById(R.id.btnPlay);
    btnNext = (ImageButton) findViewById(R.id.btnNext);

    if ((imgUrlList != null) && (imgUrlList.size() > 0)) {
        imgViewPager.setAdapter(new ImagePagerAdapter(imgUrlList));
        imgViewPager.setCurrentItem(position);
    }

    btnPrev.setOnClickListener(this);
    btnPlay.setOnClickListener(this);
    btnNext.setOnClickListener(this);
}// init

public void onClick(View v) {
    if (v.equals(btnPrev)) {
        if (position != 0) {
            position--;
            imgViewPager.setCurrentItem(position, true);
        }
        Log.v(TAG, "PREV POSITION = " + position);
    }

    if (v.equals(btnPlay)) {
        if (!isPlaying) {
            Log.v(TAG, "in if isPlaying = " + isPlaying);
            runTimerTask();
            isPlaying = true;
            btnPlay.setBackgroundResource(R.drawable.btn_pause);
        } else {
            Log.v(TAG, "in else isPlaying = " + isPlaying);
            mHandler.removeCallbacks(swImageRunnable);
            isPlaying = false;
            btnPlay.setBackgroundResource(R.drawable.btn_play);
        }

    }

    if (v.equals(btnNext)) {
        if (position != (imgUrlList.size() - 1)) {
            position++;
            imgViewPager.setCurrentItem(position, true);
        }
        Log.v(TAG, "NEXT POSITION = " + position);
    }
}// onClick

private class ImagePagerAdapter extends PagerAdapter {

    private ArrayList<String> images;
    private LayoutInflater inflater;

    ImagePagerAdapter(ArrayList<String> images) {
        this.images = images;
        inflater = getLayoutInflater();
    }

    @Override
    public void destroyItem(ViewGroup container, int position, Object object) {
        ((ViewPager) container).removeView((View) object);
    }

    @Override
    public void finishUpdate(View container) {
    }

    @Override
    public int getCount() {
        return images.size();
    }

    @Override
    public Object instantiateItem(ViewGroup view, int position) {
        View imageLayout = inflater.inflate(R.layout.item_pager_image,
                view, false);
        ImageView imageView = (ImageView) imageLayout
                .findViewById(R.id.image);
        final ProgressBar spinner = (ProgressBar) imageLayout
                .findViewById(R.id.loading);

        imageLoader.displayImage(images.get(position), imageView, options,
                new SimpleImageLoadingListener() {
                    @Override
                    public void onLoadingStarted(String imageUri, View view) {
                        spinner.setVisibility(View.VISIBLE);
                    }

                    @Override
                    public void onLoadingFailed(String imageUri, View view,
                            FailReason failReason) {
                        switch (failReason.getType()) {
                        case IO_ERROR:
                            break;
                        case DECODING_ERROR:
                            break;
                        case NETWORK_DENIED:
                            break;
                        case OUT_OF_MEMORY:
                            break;
                        case UNKNOWN:
                            break;
                        }
                        spinner.setVisibility(View.GONE);
                    }

                    @Override
                    public void onLoadingComplete(String imageUri,
                            View view, Bitmap loadedImage) {
                        spinner.setVisibility(View.GONE);
                    }
                });

        ((ViewPager) view).addView(imageLayout, 0);
        return imageLayout;
    }

    @Override
    public boolean isViewFromObject(View view, Object object) {
        return view.equals(object);
    }

    @Override
    public void restoreState(Parcelable state, ClassLoader loader) {
    }

    @Override
    public Parcelable saveState() {
        return null;
    }

    @Override
    public void startUpdate(View container) {
    }
}

@Override
protected void onPause() {
    super.onPause();
    if (imageLoader != null) {
        imageLoader.stop();
    }
}

private void runTimerTask() {
    new Thread(new Runnable() {
        @Override
        public void run() {
            while (true) {
                try {
                    Thread.sleep(3000);
                    mHandler.post(swImageRunnable);
                } catch (Exception e) {
                }
            }
        }
    }).start();
}// runTimerTask

private class SwitchImage implements Runnable {
    @Override
    public void run() {
        if (position != (imgUrlList.size() - 1)) {
            Log.v(TAG, "in runnable if");
            position++;
            imgViewPager.setCurrentItem(position, true);
        } else {
            Log.v(TAG, "in runnable else");
            //mHandler.removeCallbacks(swImageRunnable);
            btnPlay.setBackgroundResource(R.drawable.btn_play);
            isPlaying = false;
        }
    }
}
}// GalleryImageFullscreen 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T06:11:27.100

[我使用Timer](http://developer.android.com/reference/java/util/Timer.html)和[TimerTask](http://developer.android.com/reference/java/util/TimerTask.html)解决了我的问题 这是我更新的代码：

```
public class GalleryImageFullscreen extends TIEBaseActivity implements
    OnClickListener {
PrefStore lang_PrefStore;
Resources res;
Configuration config;
Locale mLocale = null;
String language;
boolean isLocaleChanged = false;
ViewPager imgViewPager;
ArrayList<String> imgUrlList;
private ImageLoader imageLoader;
private DisplayImageOptions options;
int position;
ImageButton btnPrev, btnPlay, btnNext;
public static final String TAG = "TIEGalleryFS";
volatile boolean isPlaying;
SwitchImage swImageRunnable;
MyTimerTask myTask;
Timer myTimer;

protected void onCreate(Bundle savedInstanceState) {
    super.createDefaultView(savedInstanceState);

    _headerBar.view.setVisibility(View.VISIBLE);
    _footerBar.view.setVisibility(View.VISIBLE);

    imgUrlList = getIntent().getStringArrayListExtra(
            GalleryActivity.IMAGE_URL_LIST);
    Log.v(TAG, "IMAGE LIST SIZE = " + imgUrlList.size());

    position = getIntent().getIntExtra("POSITION", 0);
    Log.v(TAG, "IMAGE POSITION = " + position);
    swImageRunnable = new SwitchImage();
    super.setHeaderTitle(getResources().getString(R.string.gallery));

    res = getResources();

    lang_PrefStore = new PrefStore();
    language = lang_PrefStore.getLanguageChoice(
            GalleryImageFullscreen.this, FooterBar.LANG_SELECT);
    Log.v("GalleryImageFullscreen language choice", language);

    config = getBaseContext().getResources().getConfiguration();
    if (!language.equals("")
            && language.equals(config.locale.getLanguage())) {
        mLocale = new Locale(language);
        Locale.setDefault(mLocale);
        config.locale = mLocale;
        getBaseContext().getResources().updateConfiguration(config,
                getBaseContext().getResources().getDisplayMetrics());
        Log.v("GalleryImageFullscreen onCreate languageset", "in if loop");
    }

    init();

    imageLoader = ImageLoader.getInstance();
    imageLoader.init(ImageLoaderConfiguration
            .createDefault(GalleryImageFullscreen.this));

    options = new DisplayImageOptions.Builder()
            .showStubImage(R.drawable.image_for_empty_url)
            .showImageForEmptyUri(R.drawable.image_for_empty_url)
            .cacheInMemory().cacheOnDisc()
            .bitmapConfig(Bitmap.Config.RGB_565).build();
}// onCreate

private void init() {
    loadFormFromResource(R.layout.gallery_image_fullscreen);
    imgViewPager = (ViewPager) findViewById(R.id.imgpager);
    btnPrev = (ImageButton) findViewById(R.id.btnPrev);
    btnPlay = (ImageButton) findViewById(R.id.btnPlay);
    btnNext = (ImageButton) findViewById(R.id.btnNext);

    if ((imgUrlList != null) && (imgUrlList.size() > 0)) {
        imgViewPager.setAdapter(new ImagePagerAdapter(imgUrlList));
        imgViewPager.setCurrentItem(position);
    }

    btnPrev.setOnClickListener(this);
    btnPlay.setOnClickListener(this);
    btnNext.setOnClickListener(this);
}// init

public void onClick(View v) {
    if (v.equals(btnPrev)) {
        if (position != 0) {
            position--;
            imgViewPager.setCurrentItem(position, true);
        }
        Log.v(TAG, "PREV POSITION = " + position);
    }

    if (v.equals(btnPlay)) {
        if (!isPlaying) {
            Log.v(TAG, "in if isPlaying = " + isPlaying);
            runTimerTask();
            isPlaying = true;
            btnPlay.setBackgroundResource(R.drawable.btn_pause);
        } else {
            Log.v(TAG, "in else isPlaying = " + isPlaying);
            isPlaying = false;
            myTask.cancel();
            myTimer.cancel();
            btnPlay.setBackgroundResource(R.drawable.btn_play);
        }

    }

    if (v.equals(btnNext)) {
        if (position != (imgUrlList.size() - 1)) {
            position++;
            imgViewPager.setCurrentItem(position, true);
        }
        Log.v(TAG, "NEXT POSITION = " + position);
    }
}// onClick

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.tie_options_menu, menu);
    return true;
}// onCreateOptionsMenu

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case R.id.menu_Eng:
        lang_PrefStore.setLanguageChoice(GalleryImageFullscreen.this,
                FooterBar.LANG_SELECT, "en");
        mLocale = new Locale("en");
        Locale.setDefault(mLocale);
        config.locale = mLocale;
        getResources().updateConfiguration(config,
                getResources().getDisplayMetrics());
        isLocaleChanged = true;
        Toast.makeText(GalleryImageFullscreen.this, "English",
                Toast.LENGTH_SHORT).show();
        refreshActivity();
        break;

    case R.id.menu_German:
        lang_PrefStore.setLanguageChoice(GalleryImageFullscreen.this,
                FooterBar.LANG_SELECT, "de");
        mLocale = new Locale("de");
        Locale.setDefault(mLocale);
        config.locale = mLocale;
        getResources().updateConfiguration(config,
                getResources().getDisplayMetrics());
        isLocaleChanged = true;
        Toast.makeText(GalleryImageFullscreen.this, "German",
                Toast.LENGTH_SHORT).show();
        refreshActivity();
        break;

    case R.id.menu_Russian:
        lang_PrefStore.setLanguageChoice(GalleryImageFullscreen.this,
                FooterBar.LANG_SELECT, "ru");
        mLocale = new Locale("ru");
        Locale.setDefault(mLocale);
        config.locale = mLocale;
        getResources().updateConfiguration(config,
                getResources().getDisplayMetrics());
        isLocaleChanged = true;
        Toast.makeText(GalleryImageFullscreen.this, "Russian",
                Toast.LENGTH_SHORT).show();
        refreshActivity();
        break;
    }// switch
    return super.onOptionsItemSelected(item);
}// onOptionsItemSelected

private class ImagePagerAdapter extends PagerAdapter {

    private ArrayList<String> images;
    private LayoutInflater inflater;

    ImagePagerAdapter(ArrayList<String> images) {
        this.images = images;
        inflater = getLayoutInflater();
    }

    @Override
    public void destroyItem(ViewGroup container, int position, Object object) {
        ((ViewPager) container).removeView((View) object);
    }

    @Override
    public void finishUpdate(View container) {
    }

    @Override
    public int getCount() {
        return images.size();
    }

    @Override
    public Object instantiateItem(ViewGroup view, int position) {
        View imageLayout = inflater.inflate(R.layout.item_pager_image,
                view, false);
        ImageView imageView = (ImageView) imageLayout
                .findViewById(R.id.image);
        final ProgressBar spinner = (ProgressBar) imageLayout
                .findViewById(R.id.loading);

        imageLoader.displayImage(images.get(position), imageView, options,
                new SimpleImageLoadingListener() {
                    @Override
                    public void onLoadingStarted(String imageUri, View view) {
                        spinner.setVisibility(View.VISIBLE);
                    }

                    @Override
                    public void onLoadingFailed(String imageUri, View view,
                            FailReason failReason) {
                        switch (failReason.getType()) {
                        case IO_ERROR:
                            break;
                        case DECODING_ERROR:
                            break;
                        case NETWORK_DENIED:
                            break;
                        case OUT_OF_MEMORY:
                            break;
                        case UNKNOWN:
                            break;
                        }
                        spinner.setVisibility(View.GONE);
                    }

                    @Override
                    public void onLoadingComplete(String imageUri,
                            View view, Bitmap loadedImage) {
                        spinner.setVisibility(View.GONE);
                    }
                });

        ((ViewPager) view).addView(imageLayout, 0);
        return imageLayout;
    }

    @Override
    public boolean isViewFromObject(View view, Object object) {
        return view.equals(object);
    }

    @Override
    public void restoreState(Parcelable state, ClassLoader loader) {
    }

    @Override
    public Parcelable saveState() {
        return null;
    }

    @Override
    public void startUpdate(View container) {
    }
}

@Override
protected void onPause() {
    super.onPause();
    if (imageLoader != null) {
        imageLoader.stop();
    }
}

private void runTimerTask() {
    myTask = new MyTimerTask();
    myTimer = new Timer();
    myTimer.scheduleAtFixedRate(myTask, 0, 3000);
}// runTimerTask

private class SwitchImage implements Runnable {
    @Override
    public void run() {
        if (position != (imgUrlList.size() - 1)) {
            Log.v(TAG, "in runnable if");
            position++;
            imgViewPager.setCurrentItem(position, true);
        } else {
            Log.v(TAG, "in runnable else");
            btnPlay.setBackgroundResource(R.drawable.btn_play);
            isPlaying = false;
        }
    }// run
}// SwitchImage

class MyTimerTask extends TimerTask {
    final Handler mHandler = new Handler(Looper.getMainLooper());

    public void run() {
        mHandler.post(swImageRunnable);
    }// run
}// MyTimerTask

@Override
protected void onDestroy() {
    if(myTask != null) {
        myTask = null;
    }

    if(myTimer != null) {
        myTimer.purge();
    }
    super.onDestroy();
}
}// GalleryImageFullscreen 
```

# gwt - GWT 中的 UIBinder

> ID：16051682
> 
> 赞同：7
> 
> 时间：2013-04-17T04:45:40.323
> 
> 标签：gwt, uibinder

我试图理解 GWT 中的 UIBinder 概念。我在网上浏览了几个教程。这是我的问题：

1）为什么要使用UIBinder？仅仅是因为我们将编写更少的代码并像直接编写 javascript 一样进行开发吗？

2) 有没有什么可以通过使用 UiBinder 完成而 GWT 无法完成的事情，反之亦然？

我浏览了**[这个](http://www.linkedin.com/groups/What-do-you-prefer-UIBinder-1803845.S.174377889)**链接，它提供了一个直接的讨论。还有什么其他观点或建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-17T06:01:27.913

GWT 在创建 DOM 的过程中最大的优势是[UiBinders](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder?hl=te#Using_a_widget)，也称为“<strong>Declarative Layout”。

> UiBinders 为您提供了一种使用传统 HTML 和 CSS 而不是以编程方式在 java 中声明应用程序和小部件布局的方法。这为您提供了一种更丰富的方式来创建您的应用程序。
> 
> 浏览器通过将大的 HTML 字符串塞入 innerHTML 属性来构建 DOM 结构比通过**一堆 API 调用**更好。[UiBinder](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder#Overview)很自然地利用了这一点，结果是构建你的应用程序最愉快的方式也是构建它的最佳方式。

*   [UiBinder](http://www.tutorialspoint.com/gwt/gwt_uibinder.htm)是一个框架，旨在分离用户界面的功能和视图。

*   UiBinder 框架允许开发人员将 gwt 应用程序构建为 HTML 页面，并在其中配置 GWT 小部件。

*   UiBinder 框架使与更熟悉 XML、HTML 和 CSS 而非 Java 源代码的 UI 设计人员协作更容易
*   UIBinder 提供了一种定义用户界面的声明方式。

*   UIBinder 将程序逻辑与 UI 分开。

*   UIBinder 类似于 JSP 之于 Servlet。

这是一个[例子](http://www.zeddic.com/2011/11/introduction-to-gwt-ui-binders-templates/)，说明 UIBInder 如何比传统的 java 代码更有优势。

提出您的问题（*这些是在我开发时观察到*的）

1.  如果您熟悉 HTMl 和 CSS，您可以简单地`layout`了解那里的结构（在模板中的意思`ui.xml`），并且可以简单地使用 GWT。这减少了您的编译时间。

2.  同样，您可以简单地在 xml 中编写标记并应用样式和其他 DOM 属性，而在 java 代码中您必须编写代码行数（至少 2 到 3 行）准备具有样式和特定 DOM 属性的小部件.

根据我的经验，我最近在这里总结了几点。 [http://codeinventions.blogspot.in/2014/07/why-to-use-uibinder-in-gwt.html](http://codeinventions.blogspot.in/2014/07/why-to-use-uibinder-in-gwt.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-29T06:01:06.983

仅基于 Java 的布局的问题

• 难以用Java 格式化HTML – 想想servlet 与JSP – 基于HTML 的布局通常不够动态 • 如果是，就使用它！• 很难将布局可视化——通过查看 Java 代码不容易看到最终结果 • 很难有效地让图形 UI 网页设计师参与进来——他们通常不了解 Java——即使你设法将设计融入 Java，它也是难以维护

UiBinder：主要思想

• 使用 XML 文件来布置内容块 – 可以表示 HTML 或小部件 • 制作表示该内容块的 Java 类 – 涉及一些过于详细的步骤，但 Eclipse 具有自动制作大部分内容的快捷方式 • 使用主应用程序中的 Java 类 – 如果 class 代表 HTML，则使用 GWT DOM API 插入 – 如果 class 代表 Widget，则使用普通的“add”方法插入它

UiBinder 的优点 • 可以使用 HTML – 或类似 HTML 的 XML 制作复杂的页面布局 • 类似于将 JSP 添加到纯 servlet 应用程序 • 更易于维护 • 图形 Web 设计人员可以参与从初始设计到维护 – 易于从常规 HTML 和逐渐“加入” GWT 绑定 • 关注点分离——UI 的美学和功能不再混杂在一起 • XML 和 Java 之间甚至 XML 本身内部交叉引用的编译时检查

• 更好的浏览器性能– 浏览器在将长字符串填充到元素的innerHTML 中非常快 • 在执行JavaScript API 时没那么快– 教训：尽可能使用常规HTML！– UiBinder的目标：让更简单的选择成为正确的选择

# python - 在 Python 中解析 xml 时出错

> ID：16051687
> 
> 赞同：0
> 
> 时间：2013-04-17T04:45:53.063
> 
> 标签：python, xml

我试图解析这个：[http ://www.codespot.blogspot.in/atom.xml?redirect=false&start-index=1&max-results=500](http://www.codespot.blogspot.in/atom.xml?redirect=false&start-index=1&max-results=500)

问题是：

1.  我必须将 xml 存储在一个文件中，以便 ElementTree 解析它。如何避免它并仅解析来自 GET 请求的字符串响应？

2.  尽管我正在这样做，但要获得所有标题，它仍然不起作用：

    ```
    f = open('output.xml','wb+')
        f.write(r.content)
        f.close()
        tree = ""
        with open('output.xml', 'rt') as f:
            tree = ElementTree.parse(f)
            print tree
            root = tree.getroot()
            for elem in tree.iter():
                print elem.tag, elem.attrib
            for atype in tree.findall('title'):
                print atype.contents 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:08:06.317

```
import urllib2
from xml.etree import cElementTree as ET
conn = urllib2.urlopen("http://www.codespot.blogspot.in/atom.xml?redirect=false&start-index=1&max-results=500")
myins=ET.parse(conn)
for elem in myins.findall('{http://www.w3.org/2005/Atom}entry/{http://www.w3.org/2005/Atom}title'):
    print elem.text 
```

或查找标题和内容::

```
for elem in myins.findall('{http://www.w3.org/2005/Atom}entry'):
    print elem.find('{http://www.w3.org/2005/Atom}title').text ## this will be the title
    print elem.find('{http://www.w3.org/2005/Atom}content').text ## this will be the content 
```

# android-camera - 通过代码android调用camera.takepicture

> ID：16051690
> 
> 赞同：0
> 
> 时间：2013-04-17T04:46:04.093
> 
> 标签：android-camera

我试图通过代码调用camera.takepicture，它总是抛出一个运行时异常。我似乎无法在我的代码中找到错误。如果我使用按钮调用相同的东西，则拍照效果很好。我需要通过代码调用 takepicture，因为当用户实际执行不同的活动时，我需要它来随机拍摄照片。我需要设置一个计时器/间隔来查看正在拍摄的这些照片。我不能依赖程序的这一部分中的用户交互。

这是有关更多详细信息的代码。还附上了logcat。

CameraActivity.class

```
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

import android.annotation.TargetApi;
import android.app.Activity;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.hardware.Camera;
import android.hardware.Camera.CameraInfo;
import android.hardware.Camera.PictureCallback;
import android.hardware.Camera.Size;
import android.os.Build;
import android.os.Bundle;
import android.os.Environment;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceHolder.Callback;
import android.view.View.OnClickListener;
import android.view.SurfaceView;
import android.view.View;
import android.widget.Button;
import android.widget.Toast;

@TargetApi(Build.VERSION_CODES.GINGERBREAD)
public class CameraActivity extends Activity implements Callback {

final static String DEBUG_TAG = "CameraActivity";
final static String TAG = "CameraActivity";
Camera camera;
private int cameraId = 0;
Button photo;
PhotoHandler mPhotoHandler = null;

Camera.Parameters parameters;
private SurfaceHolder sHolder;

@TargetApi(Build.VERSION_CODES.GINGERBREAD)
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    // do we have a camera?
    if (!getPackageManager()
            .hasSystemFeature(PackageManager.FEATURE_CAMERA)) {
        Toast.makeText(this, "No camera on this device", Toast.LENGTH_LONG)
                .show();
    } else {
        cameraId = findFrontFacingCamera();
        if (cameraId < 0) {
            Toast.makeText(this, "No front facing camera found.",
                    Toast.LENGTH_LONG).show();
        } else {
            camera = Camera.open(cameraId);
            SurfaceView sv = new SurfaceView(getApplicationContext());
            setContentView(R.layout.camera);
            sv = (SurfaceView) findViewById(R.id.surfaceview);
            photo = (Button) findViewById(R.id.takepicture);
            photo.setText("Click a photo!!");
            // Get a surface
            sHolder = sv.getHolder();
            sHolder.addCallback(this);
            sHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
            try {
                camera.setPreviewDisplay(sHolder);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            parameters = camera.getParameters();
            // set camera parameters
            camera.setParameters(parameters);
            camera.startPreview();
            camera.setDisplayOrientation(90);
            try {

                photo.setOnClickListener(new OnClickListener() {
                    @Override
                    public void onClick(View arg0) {
                        // TODO Auto-generated method stub
                        // Toast.makeText(getApplicationContext(),
                        // "photo clicked!",
                        // Toast.LENGTH_SHORT).show();

                        // just calling the function which captures the
                        // photo
                        takePhoto();
                    }
                });
                photo.performClick();

                // finish();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
}

public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {
    try {
        camera.setPreviewDisplay(holder);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    // set any cam params you need...
    camera.startPreview();
}

private int findFrontFacingCamera() {
    int cameraId = -1;
    // Search for the front facing camera
    int numberOfCameras = Camera.getNumberOfCameras();
    for (int i = 0; i < numberOfCameras; i++) {
        CameraInfo info = new CameraInfo();
        Camera.getCameraInfo(i, info);
        if (info.facing == CameraInfo.CAMERA_FACING_FRONT) {
            Log.d(DEBUG_TAG, "CameraActivity found");
            cameraId = i;
            break;
        }
    }
    return cameraId;
}

@Override
protected void onPause() {
    if (camera != null) {
        camera.release();
        camera = null;
    }
    super.onPause();
}

Camera.ShutterCallback shuttercallback = new Camera.ShutterCallback() {

    @Override
    public void onShutter() {
        // TODO Auto-generated method stub
        Log.d(TAG, "onShutter'd");
    }
};

Camera.PictureCallback rawpicture = new Camera.PictureCallback() {

    @Override
    public void onPictureTaken(byte[] arg0, Camera arg1) {
        // TODO Auto-generated method stub
        Log.d(TAG, "onPictureTaken - raw");
    }

};

Camera.PictureCallback jpegcallback = new Camera.PictureCallback() {

    @Override
    public void onPictureTaken(byte[] data, Camera arg1) {
        // TODO Auto-generated method stub
        File pictureFileDir = getDir();

        if (!pictureFileDir.exists() && !pictureFileDir.mkdirs()) {

            Log.d(CameraActivity.DEBUG_TAG,
                    "Can't create directory to save image.");
            Toast.makeText(CameraActivity.this,
                    "Can't create directory to save image.",
                    Toast.LENGTH_LONG).show();
            return;
        }

        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyymmddhhmmss");
        String date = dateFormat.format(new Date());
        String photoFile = "Picture_" + date + ".jpg";

        String filename = pictureFileDir.getPath() + File.separator
                + photoFile;

        File pictureFile = new File(filename);

        try {
            FileOutputStream fos = new FileOutputStream(pictureFile);
            fos.write(data);
            fos.close();
            Toast.makeText(CameraActivity.this,
                    "New Image saved:" + photoFile, Toast.LENGTH_LONG)
                    .show();
        } catch (Exception error) {
            Log.d(CameraActivity.DEBUG_TAG, "File" + filename
                    + "not saved: " + error.getMessage());
            Toast.makeText(CameraActivity.this,
                    "Image could not be saved.", Toast.LENGTH_LONG).show();
        }
    }

};

@Override
public void surfaceCreated(SurfaceHolder holder) {
    // set any cam params you need...
    camera.startPreview();
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    // TODO Auto-generated method stub
    camera.stopPreview();
    camera.release();

}

private static File getDir() {
    File sdDir = Environment
            .getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES);
    return new File(sdDir, "CameraAPIDemo");
}

public void takePhoto() {

    camera.takePicture(shuttercallback, rawpicture, jpegcallback);
}

} 
```

附上logcat的输出

*

```
> 04-17 00:41:03.264: D/CameraActivity(19076): CameraActivity found
> 04-17 00:41:03.444: D/Camera(19076): app passed NULL surface 04-17
> 00:41:03.474: W/System.err(19076): java.lang.RuntimeException:
> takePicture failed 04-17 00:41:03.474: W/System.err(19076):   at
> android.hardware.Camera.native_takePicture(Native Method) 04-17
> 00:41:03.474: W/System.err(19076):    at
> android.hardware.Camera.takePicture(Camera.java:1095) 04-17
> 00:41:03.474: W/System.err(19076):    at
> android.hardware.Camera.takePicture(Camera.java:1040) 04-17
> 00:41:03.474: W/System.err(19076):    at
> com.egnoita.ignoramus.CameraActivity.takePhoto(CameraActivity.java:226)
> 04-17 00:41:03.474: W/System.err(19076):  at
> com.egnoita.ignoramus.CameraActivity$4.onClick(CameraActivity.java:93)
> 04-17 00:41:03.474: W/System.err(19076):  at
> android.view.View.performClick(View.java:4204) 04-17 00:41:03.484:
> W/System.err(19076):  at
> com.egnoita.ignoramus.CameraActivity.onCreate(CameraActivity.java:96)
> 04-17 00:41:03.484: W/System.err(19076):  at
> android.app.Activity.performCreate(Activity.java:5104) 04-17
> 00:41:03.484: W/System.err(19076):    at
> android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
> 04-17 00:41:03.484: W/System.err(19076):  at
> android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
> 04-17 00:41:03.484: W/System.err(19076):  at
> android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
> 04-17 00:41:03.484: W/System.err(19076):  at
> android.app.ActivityThread.access$600(ActivityThread.java:141) 04-17
> 00:41:03.484: W/System.err(19076):    at
> android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
> 04-17 00:41:03.484: W/System.err(19076):  at
> android.os.Handler.dispatchMessage(Handler.java:99) 04-17
> 00:41:03.484: W/System.err(19076):    at
> android.os.Looper.loop(Looper.java:137) 04-17 00:41:03.484:
> W/System.err(19076):  at
> android.app.ActivityThread.main(ActivityThread.java:5041) 04-17
> 00:41:03.484: W/System.err(19076):    at
> java.lang.reflect.Method.invokeNative(Native Method) 04-17
> 00:41:03.484: W/System.err(19076):    at
> java.lang.reflect.Method.invoke(Method.java:511) 04-17 00:41:03.484:
> W/System.err(19076):  at
> com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
> 04-17 00:41:03.484: W/System.err(19076):  at
> com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560) 04-17
> 00:41:03.484: W/System.err(19076):    at
> dalvik.system.NativeStart.main(Native Method) 04-17 00:41:03.534:
> D/libEGL(19076): loaded /system/lib/egl/libEGL_adreno200.so 04-17
> 00:41:03.534: D/libEGL(19076): loaded
> /system/lib/egl/libGLESv1_CM_adreno200.so 04-17 00:41:03.544:
> D/libEGL(19076): loaded /system/lib/egl/libGLESv2_adreno200.so 04-17
> 00:41:03.554: I/Adreno200-EGL(19076): <eglInitialize:269>: EGL 1.4
> QUALCOMM build: Nondeterministic
> AU_full_mako_PARTNER-ANDROID/JB-MR1-DEV_CL2961380_release_AU
> (CL2961380) 04-17 00:41:03.554: I/Adreno200-EGL(19076): Build Date:
> 12/10/12 Mon 04-17 00:41:03.554: I/Adreno200-EGL(19076): Local Branch:
> 04-17 00:41:03.554: I/Adreno200-EGL(19076): Remote Branch:
> m/partner-android/jb-mr1-dev 04-17 00:41:03.554:
> I/Adreno200-EGL(19076): Local Patches: NONE 04-17 00:41:03.554:
> I/Adreno200-EGL(19076): Reconstruct Branch: NOTHING 04-17
> 00:41:03.624: D/OpenGLRenderer(19076): Enabling debug mode 0 
```

* 如果您需要更多信息，请告诉我。所有权限和功能都添加到清单中

```
<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.READ_PHONE_DATA" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

<uses-feature android:name="android.hardware.camera" />
<uses-feature android:name="android.hardware.camera.autofocus" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-31T11:11:55.087

我遇到了同样的问题，为了解决这个问题，我简单地将 takephoto 定义为静态，将回调定义为静态。完成此操作后，我可以通过代码调用 takephoto。

例如：

```
public static void takePhoto() {

    camera.takePicture(shuttercallback, rawpicture, jpegcallback);
}

static Camera.PictureCallback jpegcallback = new Camera.PictureCallback() {

    @Override
    public void onPictureTaken(byte[] data, Camera arg1) {
        // TODO Auto-generated method stub
        File pictureFileDir = getDir();

        if (!pictureFileDir.exists() && !pictureFileDir.mkdirs()) {

            Log.d(CameraActivity.DEBUG_TAG,
                    "Can't create directory to save image.");
            Toast.makeText(CameraActivity.this,
                    "Can't create directory to save image.",
                    Toast.LENGTH_LONG).show();
            return;
        }

        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyymmddhhmmss");
        String date = dateFormat.format(new Date());
        String photoFile = "Picture_" + date + ".jpg";

        String filename = pictureFileDir.getPath() + File.separator
                + photoFile;

        File pictureFile = new File(filename);

        try {
             FileOutputStream fos = new FileOutputStream(pictureFile);
             fos.write(data);
             fos.close();
             Toast.makeText(CameraActivity.this,
                    "New Image saved:" + photoFile, Toast.LENGTH_LONG)
                     .show();
        } catch (Exception error) {
            Log.d(CameraActivity.DEBUG_TAG, "File" + filename
                    + "not saved: " + error.getMessage());
            Toast.makeText(CameraActivity.this,
                    "Image could not be saved.", Toast.LENGTH_LONG).show();
        }
    }

};

static Camera.ShutterCallback shuttercallback = new Camera.ShutterCallback() {

    @Override
    public void onShutter() {
        // TODO Auto-generated method stub
        Log.d(TAG, "onShutter'd");
    }
};

static Camera.PictureCallback rawpicture = new Camera.PictureCallback() {

    @Override
    public void onPictureTaken(byte[] arg0, Camera arg1) {
        // TODO Auto-generated method stub
        Log.d(TAG, "onPictureTaken - raw");
    }

}; 
```

我希望这可以帮助您或其他有同样问题的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-01T06:42:36.853

你不需要四处走动，所以它`takePhoto()`是从 onClick() 调用的。您的编程方法失败的原因是camera.takePicture( [)](http://developer.android.com/reference/android/hardware/Camera.html#takePicture(android.hardware.Camera.ShutterCallback,%20android.hardware.Camera.PictureCallback,%20android.hardware.Camera.PictureCallback,%20android.hardware.Camera.PictureCallback))只能在[camera.startPreview()完成](http://developer.android.com/reference/android/hardware/Camera.html#startPreview())**后** 调用。这恰好是对 Android 相机生命周期的[常见误解。](https://stackoverflow.com/a/20825344/192373)

底线是`onCreate()`，您应该让活动准备好拍照，并让所有必要的回调按顺序调用。这是您的代码的最小重写。我希望它不仅可以完成工作，还可以帮助您了解正确对待相机的方法。

```
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

import android.annotation.TargetApi;
import android.app.Activity;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.hardware.Camera;
import android.hardware.Camera.CameraInfo;
import android.hardware.Camera.PictureCallback;
import android.hardware.Camera.Size;
import android.os.Build;
import android.os.Bundle;
import android.os.Environment;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceHolder.Callback;
import android.view.View.OnClickListener;
import android.view.SurfaceView;
import android.view.View;
import android.widget.Button;
import android.widget.Toast;

@TargetApi(Build.VERSION_CODES.GINGERBREAD)
public class CameraActivity extends Activity implements Callback {

final static String DEBUG_TAG = "CameraActivity";
final static String TAG = "CameraActivity";
Camera camera;
private int cameraId = 0;
Button photo;
PhotoHandler mPhotoHandler = null;
private boolean wantPhoto = false;

Camera.Parameters parameters;
private SurfaceHolder sHolder;

@TargetApi(Build.VERSION_CODES.GINGERBREAD)
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    // do we have a camera?
    if (!getPackageManager()
            .hasSystemFeature(PackageManager.FEATURE_CAMERA)) {
        Toast.makeText(this, "No camera on this device", Toast.LENGTH_LONG)
                .show();
    } else {
        cameraId = findFrontFacingCamera();
        if (cameraId < 0) {
            Toast.makeText(this, "No front facing camera found.",
                    Toast.LENGTH_LONG).show();
        } else {
            camera = Camera.open(cameraId);
            SurfaceView sv = new SurfaceView(getApplicationContext());
            setContentView(R.layout.camera);
            sv = (SurfaceView) findViewById(R.id.surfaceview);
            photo = (Button) findViewById(R.id.takepicture);
            photo.setText("Click a photo!!");
            // Get a surface
            sHolder = sv.getHolder();
            sHolder.addCallback(this);
            sHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
            try {
                camera.setPreviewDisplay(sHolder);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            parameters = camera.getParameters();
            // set camera parameters
            camera.setParameters(parameters);
            camera.startPreview();
            camera.setDisplayOrientation(90);
            try {

                photo.setOnClickListener(new OnClickListener() {
                    @Override
                    public void onClick(View arg0) {
                        // TODO Auto-generated method stub
                        // Toast.makeText(getApplicationContext(),
                        // "photo clicked!",
                        // Toast.LENGTH_SHORT).show();

                        // just calling the function which captures the
                        // photo
                        takePhoto();
                    }
                });
//                photo.performClick();
                wantPhoto = true;

                // finish();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
}

public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {
    try {
        camera.setPreviewDisplay(holder);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    // set any cam params you need...
    camera.startPreview();
    if (wantPhoto) {
        wantPhoto = false;
        takePhoto();
    }
}

private int findFrontFacingCamera() {
    int cameraId = -1;
    // Search for the front facing camera
    int numberOfCameras = Camera.getNumberOfCameras();
    for (int i = 0; i < numberOfCameras; i++) {
        CameraInfo info = new CameraInfo();
        Camera.getCameraInfo(i, info);
        if (info.facing == CameraInfo.CAMERA_FACING_FRONT) {
            Log.d(DEBUG_TAG, "CameraActivity found");
            cameraId = i;
            break;
        }
    }
    return cameraId;
}

@Override
protected void onPause() {
    if (camera != null) {
        camera.release();
        camera = null;
    }
    super.onPause();
}

Camera.ShutterCallback shuttercallback = new Camera.ShutterCallback() {

    @Override
    public void onShutter() {
        // TODO Auto-generated method stub
        Log.d(TAG, "onShutter'd");
    }
};

Camera.PictureCallback rawpicture = new Camera.PictureCallback() {

    @Override
    public void onPictureTaken(byte[] arg0, Camera arg1) {
        // TODO Auto-generated method stub
        Log.d(TAG, "onPictureTaken - raw");
    }

};

Camera.PictureCallback jpegcallback = new Camera.PictureCallback() {

    @Override
    public void onPictureTaken(byte[] data, Camera arg1) {
        // TODO Auto-generated method stub
        File pictureFileDir = getDir();

        if (!pictureFileDir.exists() && !pictureFileDir.mkdirs()) {

            Log.d(CameraActivity.DEBUG_TAG,
                    "Can't create directory to save image.");
            Toast.makeText(CameraActivity.this,
                    "Can't create directory to save image.",
                    Toast.LENGTH_LONG).show();
            return;
        }

        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyymmddhhmmss");
        String date = dateFormat.format(new Date());
        String photoFile = "Picture_" + date + ".jpg";

        String filename = pictureFileDir.getPath() + File.separator
                + photoFile;

        File pictureFile = new File(filename);

        try {
            FileOutputStream fos = new FileOutputStream(pictureFile);
            fos.write(data);
            fos.close();
            Toast.makeText(CameraActivity.this,
                    "New Image saved:" + photoFile, Toast.LENGTH_LONG)
                    .show();
        } catch (Exception error) {
            Log.d(CameraActivity.DEBUG_TAG, "File" + filename
                    + "not saved: " + error.getMessage());
            Toast.makeText(CameraActivity.this,
                    "Image could not be saved.", Toast.LENGTH_LONG).show();
        }
    }

};

@Override
public void surfaceCreated(SurfaceHolder holder) {
    // set any cam params you need...
    camera.startPreview();
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    // TODO Auto-generated method stub
    camera.stopPreview();
    camera.release();

}

private static File getDir() {
    File sdDir = Environment
            .getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES);
    return new File(sdDir, "CameraAPIDemo");
}

public void takePhoto() {

    camera.takePicture(shuttercallback, rawpicture, jpegcallback);
}

} 
```

请理解，有一些重要的改进可以使您的代码受益。例如，建议在后台线程上调用 camera.open()，因为在某些设备上，这可能是一个漫长的过程，它可能会冻结 UI 超过一秒。

# mysql - 以更快的方式从 mysql 中选择数据

> ID：16051691
> 
> 赞同：2
> 
> 时间：2013-04-17T04:46:04.300
> 
> 标签：mysql, select

我有一个非常大的表，我正在使用查询从该表中获取数据。
这是查询。

```
<?php
$input = 'anyword';
SELECT * FROM foo WHERE sentence REGEXP '([^[:alnum:]]|^)$input([^[:alnum:]]|$)'
?> 
```

这个查询运行良好，但问题是它非常慢。我需要一种更快的方式，就像上面的查询一样。
谢谢....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:25:25.740

对大表的每一行执行正则表达式会很慢。查看[全文搜索](http://dev.mysql.com/doc/refman/5.6/en/fulltext-search.html)，了解如何使用全文索引来搜索文本列中的给定单词。

# awk - awk 中的二维数组处理

> ID：16051694
> 
> 赞同：3
> 
> 时间：2013-04-17T04:46:14.050
> 
> 标签：awk, syntax-error, gawk

我正在为二维数组尝试一个简单的 awk 脚本，如下所示：

```
BEGIN{
     b[1][1]=0
     split("5 4 3 2",b[1])
     print b[1][1]
} 
```

这个代码片段也在 gnu gawk 教程中提到。但是当我尝试运行它时，我得到了 b 索引的语法错误。谁能告诉问题是什么？在 gnu 教程中，他们显示了输出。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T05:31:34.027

**更新**

Normal`awk`使用`b[1,1]`语法，但它不是真正的二维数组。而是一个哈希，具有像`1 SUBSEP 1`. 因此，如果您使用`for (i in b) print i`，那么您将拥有这样的索引。默认值为`SUBSEP`0x34，但可以重新定义。

`split`无法定义数组元素。但是你可以移动到一个普通的变量并`b`用一个 for 循环填充。我们试试看：

```
BEGIN{
     #b[1,1] is automatically created if referenced, even by a read.
     split("5 4 3 2",b[1]);
     print b[1,1];
} 
```

说：“awk：./x.awk:5：致命：拆分：第二个参数不是数组”

下次尝试：

```
BEGIN{
     split("5 4 3 2",a);
     b[1] = a;
     print b[1,1];
} 
```

没有。错误：“awk：./x.awk:5：致命：尝试在标量上下文中使用数组‘a’”

您可以使用什么将拆分结果存储在数组中，然后将其复制到 2D 中，例如 stuct：

```
BEGIN{
     split("5 4 3 2",a);
     for(i in a) b[1,i]=a[i];
     print b[1,1];
} 
```

请注意，这`b`不是真正的二维数组。现在它有 4 个这样的元素：`b[1 SUBSEP 1] == 5`, `b[1 SUBSEP 2] == 4`&c。

如果您想转储 be 的值，您可以创建两个或一个循环，例如：

```
for (i in b) print i" => "b[i]; 
```

输出：

```
11 => 5
12 => 4
13 => 3
14 => 2 
```

如果您想查看分隔符，请将其设置为可见的内容：

```
BEGIN{
     SUBSEP=":"
     split("5 4 3 2",a);
     for(i in a) b[1,i]=a[i];
     print b[1,1];
     print b[1 SUBSEP 1];
     for (i in a) print "a-"i" => "a[i];
     for (i in b) print "b-"i" => "b[i];
} 
```

输出：

```
5
5
a-4 => 2
a-1 => 5
a-2 => 4
a-3 => 3
b-1:1 => 5
b-1:2 => 4
b-1:3 => 3
b-1:4 => 2 
```

如您所见，哈希元素未按数字顺序打印。我很惊讶以`b`这种方式打印。但是你不能相信这个（见`a`元素）。

**添加**

我检查了[gawk](/questions/tagged/gawk "显示标记为“gawk”的问题") 3.1.5，`b[1][1]`and`split("5 4 3 2",b[1])`符号不起作用（如预期的那样）。我还尝试了[gawk](/questions/tagged/gawk "显示标记为“gawk”的问题") 4.1.0 并且两者都在工作！似乎在较新的[gawk](/questions/tagged/gawk "显示标记为“gawk”的问题")中`b[1][1]=0`定义了一个数组，`b[1]`所以`split("5 4 3 2",b[1])`可以工作。但`b[1,1]=0`表现不同。它以旧方式运行，因此`b[1]`不是真正的数组（因为没有这样的元素，而是`b[1 SUBSEP 1]`）。

因此，请尝试检查版本并使用旧语法，因为您的[awk](/questions/tagged/awk "show questions tagged 'awk'")`awk --version`似乎对于新语法来说太旧了。

# c# - 如何在 C# 中获得正确的时间

> ID：16051700
> 
> 赞同：-6
> 
> 时间：2013-04-17T04:46:29.957
> 
> 标签：c#, date, datetime

我一直用`Datetime.UtcNow`它来获取日期。但是，这个日期比我的时间早 6 小时（我在中央时间）。有没有更正确的方法可以让我在 C# 中获得确切的日期？或者如果没有，我将如何更改现有日期？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T04:47:45.213

[`DateTime.Now`](http://msdn.microsoft.com/en-us//library/system.datetime.now.aspx)将为您提供您所在时区的当前时间。`DateTime.UtcNow`为您提供此计算机上的当前日期和时间，以[协调世界时](http://en.wikipedia.org/wiki/Coordinated_Universal_Time)(UTC) 表示。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T04:47:18.477

UTC 时间是协调世界时，无论您身在何处，它都是一个恒定的时间。它在英国基本上是同一时间，除了它不做夏令时或类似的事情。

让你的当地时间做 `DateTime.Now`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:50:44.063

> DateTime.Now 将根据您的区域为您提供当前时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T07:45:54.187

如果您希望它也显示在标签中，您可以查看此代码，它对我有用。每次计时器滴答作响时，我都会使用计时器来刷新时间。

```
public partial class Form1 : Form
{
    Timer timer = new Timer();

    public Form1()
    {
        InitializeComponent();

        timer.Tick += new EventHandler(timer_Tick); // Everytime timer ticks, timer_Tick will be called
        timer.Interval = (1000) * (1);              // Timer will tick evert second
        timer.Enabled = true;                       // Enable the timer
        timer.Start();                              // Start the timer

    }
    private void timer_Tick(object sender, EventArgs e)
    {
        label1.Text = DateTime.Now.ToString("HH:mm:ss");
} 
```

# java - Android aynctask json

> ID：16051703
> 
> 赞同：0
> 
> 时间：2013-04-17T04:47:04.570
> 
> 标签：java, android, android-asynctask

我正在使用这段代码从 Reddit 下载 json 数据。该代码在我创建的测试 java 项目中有效，但在我的 android 设备上使用时无效。在 android 设备上，它只会下载一小部分 json 数据。我不知道为什么。感谢您的任何帮助。

```
@Override
protected JSONObject doInBackground(URL... urls) {
    String c;
    StringBuilder str = new StringBuilder();
        try {
            BufferedReader in = new BufferedReader(new InputStreamReader((InputStream) urls[0].getContent()));
            while((c = in.readLine()) != null) {
                str.append(c);
            }
            in.close();
            json = new JSONObject(str.toString());
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    return json;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:03:34.067

试试这个方法

```
public resultModel getJSONfromReddit() {

        resultModel result = new resultModel();
        HttpResponse response;
        HttpClient myClient = new DefaultHttpClient();
        HttpPost myConnection = new HttpPost("http://www.reddit.com/.json");

        try {
            response = myClient.execute(myConnection);
            String JSONString = EntityUtils.toString(response.getEntity(),
                    "UTF-8");
            JSONObject json = null;
            json = new JSONObject(JSONString);
            Log.i(TAG, JSONString); //this is the whole response but it'll be cutted if you only print it in the eclipse logcat

            //PARSE YOUR JSON HERE

        }

        catch (Exception e) {
            e.printStackTrace();
        }

        return result;
    } 
```

也许您的 JSON 在 Eclipse 控制台中被剪切了，您可以尝试解析 JSON 并打印最后的数据来验证它，我希望我的答案足够清楚，但是如果您想问一些关于我的答案的问题，例如如何解析 JSON（我假设你知道如何做到这一点）随时在评论中提问：）

# facebook - F-Connect 和 FB Canvas 应用程序的应用程序 ID 相同

> ID：16051704
> 
> 赞同：1
> 
> 时间：2013-04-17T04:47:04.647
> 
> 标签：facebook, facebook-apps, policy, facebook-canvas

最近FB改变了他们的政策，并据此：

> 一个。Facebook.com 以外的桌面网页游戏只能使用 Facebook 登录（身份验证，不包括好友列表等用户连接）、社交插件和发布（例如，Feed Dialog、Stream Publish 或 Open Graph）。在进行身份验证时，这些游戏可能不会请求除年龄、电子邮件和我们的发布权限之外的其他权限。
> 
> 湾。Facebook.com 和移动设备上的游戏不得与 Facebook.com 以外的桌面网络游戏共享相同的应用 ID。您不得使用 Canvas 应用程序推广或链接到 Facebook 以外的游戏网站，也不得使用从我们那里获得的电子邮件来推广或链接到 Facebook.com 以外的桌面网络游戏。

我确实有一个 FB 游戏，当我收到开发者通知时，我为 F-connect 和 FB Canvas 应用程序创建了单独的应用程序。仍然在我的游戏中，因为我使用 FB 用户 ID 链接用户数据，在玩游戏时它从来没有引起问题。但同时，如果一个通过 FB Canvas 注册的用户后来尝试使用 F Connect 玩游戏，那么他必须再次通过 oAuth 的东西。所以我想了解，我可以为 F-Connect 和 FB Canvas 应用程序使用相同的应用程序 ID，因为它们都是完全相同的应用程序。

# java - 在 Java 中读取 csv 文件

> ID：16051709
> 
> 赞同：0
> 
> 时间：2013-04-17T04:47:24.443
> 
> 标签：java, regex, csv

我有一个 csv，我试图将其读入对象数组。我不断收到以下错误... java.util.InputMismatchException 我认为这是因为它读取的文件由空格而不是逗号分隔。我相信我需要使用 String.split() 方法，但我不确定该怎么做。有什么建议么。这是我到目前为止的代码......

```
public class Prog7
{
public static void main(String[] args)
{
    Part[] parts;
    int numParts;
    int partNumber;
    String description;
    double price;
    int quantity;
    String city;

    parts = new Part[100];
    numParts = 0;

    Scanner inFile = null;

    /*
     * open file
     */
    try
    {
        inFile = new Scanner( new File( "C:/COSC 210/Assignment#7/parts.txt" ) );
    }
    catch ( FileNotFoundException e )
    {
        System.err.println( "Error: file not found" );
    }

    inFile.useDelimiter(",");
    while( inFile.hasNext() )
    {
        partNumber = inFile.nextInt();
        description = inFile.next();
        price = inFile.nextDouble();
        city = inFile.next();
        quantity = inFile.nextInt();

        Part p = new Part(partNumber, description, price, 
                  quantity, city);
        parts[numParts]= p;
        numParts++;
    }
    inFile.close();

    for (int i = 0; i < numParts; i++)
    {
        System.out.println(parts[i].getPartNumber());
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:21:24.403

在你的地方，我创建了单独的 bean 类

```
public class MyNewBean {

    int numParts;
    int partNumber;
    String description;
    double price;
    int quantity;
    String city;

    //get, set
} 
```

然后阅读有关 OpenCSV 的优势。如果您使用逗号作为分隔符，您应该如何处理也可以包含逗号的描述。Java bean 基于 CSV 文件中的字段位置

```
 CSVReader reader = new CSVReader(new FileReader("C:/COSC210/Assignment#7/parts.txt"));
ColumnPositionMappingStrategy strat = new ColumnPositionMappingStrategy(); 
strat.setType(MyNewBean.class); 
String[] columns = new String[] {"numParts", "partNumber", "description", "price",                  "quantity", "city"}; // the fields to bind do in your JavaBean 
strat.setColumnMapping(columns); 
CsvToBean csv = new CsvToBean(); 
List list = csv.parse(strat, yourReader); 
```

阅读更多关于[OpenCSV 的更多信息](http://opencsv.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:51:20.747

您需要读取数据`String`而不是`int/double`. 读取数据后将其`String`解析为`int`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T05:04:56.383

如果您粘贴导致此失败的文本行，将会有所帮助。正如您所怀疑的，空格字符可能在分隔逗号之前或之后。只需将分隔符更改为

```
inFile.useDelimiter("\\s*,\\s*") 
```

# excel - 在 Excel 宏中求和 2 个值的问题

> ID：16051713
> 
> 赞同：0
> 
> 时间：2013-04-17T04:47:47.317
> 
> 标签：excel, vba

我正在尝试将宏中的两个单元格相加

```
Dim test1 As Variant, test2 As Variant
test1 = UsedRows.Offset(i, 25).Value
test2 = UsedRows.Offset(i, 26).Value
ActiveCell.Offset(0, 4).Value = test1 + test2 
```

但我收到类型不匹配错误。如果我使值等于 test1 或只是 test2 它可以工作，但是当我尝试将它们加在一起时它会中断（给出类型不匹配错误）。我四处寻找但找不到解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:42:48.940

只要单元格是空的或数字的，应该没问题，如果有任何其他值，你会得到一个错误。您可以使用以下方法检查和处理这些错误：

```
If Not IsNumeric(test1) Then 
```

# c - c程序除以一个数字并显示一个数字的mod将不起作用

> ID：16051715
> 
> 赞同：0
> 
> 时间：2013-04-17T04:47:55.990
> 
> 标签：c, integer, modulus, integer-division

嗨，我做了一个程序，整数除以 50 并显示该数字的模数，但编译器告诉我“值需要赋值的左操作数”对于“/”我不知道该怎么做。这是代码：

```
#include <stdio.h>

int main()
{
    int num;
    int i;
    int m;

    printf("enter number: ");
    scanf("%d", &num);

    num / 50 = i;
    num % 50 = m;

    printf("the division is: %d\n", i);
    printf("the remainder is: %d", m); 
```

返回（0）；}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T04:49:27.830

你的赋值语句是倒退的

利用：

```
i = num / 50;
m = num % 50; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T04:51:07.363

这个：

```
num / 50 = i;  
num % 50 = m; 
```

在 C 中是严重非法的。你必须这样做：

```
i = num / 50;
m = num % 50; 
```

为什么？因为 C 中的等号不像数学中那样工作。在数学中，等号确定两个表达式*已经*相等。它告诉你一些关于它们的新东西，但不会改变它们。

在 C 中，它明确用于更改变量，这是您在传统数学符号中无法做到的。它将右边的值复制到左边的变量地址中。这就是为什么有些人称它为“gets”而不是“equals”，例如“i gets num / 50”。当您以这种方式阅读时，它是有道理的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T09:03:25.103

在 C 中，虽然使用赋值运算符 LHS 应该是 L 值而不是 r 值（即它应该有与之关联的地址），因此使用 i = num / 50; m = 数量 % 50;

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T04:54:57.447

**用`num / 50 = i;`和 **替换**和`num % 50 = m;``i = num / 50;``m = num % 50;`**

# java - 将 char 连接成一个字符串

> ID：16051718
> 
> 赞同：2
> 
> 时间：2013-04-17T04:48:22.423
> 
> 标签：java

我有这种方法，它需要一个 BigInteger，生成另一个 BigInteger（通过 rsa 算法），然后将其转换为二进制，然后将其分解为 8 个块，在其中我得到该二进制字符串的 ascii 值。

所有这些都有效

但是我无法从每个二进制字符串中获取 ascii 字符并从中创建一个新字符串。我试图使用内置的 concat 方法，但它似乎不起作用！

```
 public static String Decrypt( BigInteger ct, BigInteger d, BigInteger mod ){

    String pt = null;
    BigInteger message = ct.modPow(d, mod);     //the decrypted message M but still in BigInteger form
    String plaintext = message.toString(2);

    if( plaintext.length() % 8 != 0 ){
        plaintext = "00000000".substring( plaintext.length() % 8 ) + plaintext;
    }

    String c;
    int charCode = 0;
    for( int i = (plaintext.length()/8) - 1 ; i >= 0; i--){

        charCode = Integer.parseInt((plaintext.substring(i*8, (i*8)+8)) , 2) ;
        c = new Character( (char) charCode).toString();
        System.out.print(c);        // here is where i need something like pt.concat(c) or something like that, I dont really want it printed
    }                               // i just want all of these chars to be put into the string pt 
    System.out.println();
    return pt;
} 
```

正如您在评论中看到的那样，这就是我所说的，我的意思是通过查看 concat 的 API，我所做的似乎是正确的，但它就是行不通！

谢谢你能解释/显示什么是错的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T05:53:47.180

1\. 您应该使用 StringBuilder 附加一个字符。

2\. 您的代码创建了很多字符串：`plaintext.substring(i*8, (i*8)+8))`

下面是解决这两个问题的代码。

```
public static void main(String... args) {

    String plaintext = "";

    { // preparing for test
        String input = "abc";
        for (char ch : input.toCharArray()) {
            String charAs8bits = String.format("%8s",
                    String.valueOf(Integer.toBinaryString(ch))).replace(
                    ' ', '0');
            plaintext = charAs8bits + plaintext;
        }
        System.out.println("plaintext = " + plaintext);
    }

    StringBuilder output = new StringBuilder();
    for (int i = plaintext.length() - 8; i >= 0; i -= 8) {

        boolean isDigit = Character.isDigit(plaintext.charAt(i)) //
                && Character.isDigit(plaintext.charAt(i + 1)) //
                && Character.isDigit(plaintext.charAt(i + 2)) //
                && Character.isDigit(plaintext.charAt(i + 3)) //
                && Character.isDigit(plaintext.charAt(i + 4)) //
                && Character.isDigit(plaintext.charAt(i + 5)) //
                && Character.isDigit(plaintext.charAt(i + 6)) //
                && Character.isDigit(plaintext.charAt(i + 7)) //
        ;

        if (isDigit) {
            int num = (Character.digit(plaintext.charAt(i), 2) << 7) //
                    + (Character.digit(plaintext.charAt(i + 1), 2) << 6) //
                    + (Character.digit(plaintext.charAt(i + 2), 2) << 5) //
                    + (Character.digit(plaintext.charAt(i + 3), 2) << 4) //
                    + (Character.digit(plaintext.charAt(i + 4), 2) << 3) //
                    + (Character.digit(plaintext.charAt(i + 5), 2) << 2) //
                    + (Character.digit(plaintext.charAt(i + 6), 2) << 1) //
                    + (Character.digit(plaintext.charAt(i + 7), 2)) //
            ;
            output.append((char) num);
        }
    }
    System.out.print("output = " + output);
} 
```

输出

```
plaintext = 011000110110001001100001
output = abc 
```

**UPD**

我还将`for`循环更改为对我来说看起来更自然的视图-`i`指向“基本”索引。

# machine-learning - 垃圾邮件检测中精确率和召回率的混淆

> ID：16051721
> 
> 赞同：3
> 
> 时间：2013-04-17T04:48:38.620
> 
> 标签：machine-learning, classification, spam, precision-recall

[我正在根据教程](http://streamhacker.com/2010/05/17/text-classification-sentiment-analysis-precision-recall/)做一个检测垃圾邮件帐户的项目。两个标签——“垃圾邮件”和“非垃圾邮件”用于训练和测试。分类已经完成，我要去评估了。

结果是：

```
*Spam* precision: 0.962917933131
*Spam* recall: 0.6336

*Not spam* precision: 0.72697466468
*Not spam* recall: 0.9756 
```

我已经阅读了准确率和召回率的[维基](http://en.wikipedia.org/wiki/Precision_and_recall)，仍然感到困惑，不知道如何使用它进行测量。

我的目的是减少被标记为**“垃圾邮件”的****普通**帐户的数量。一些“垃圾邮件”帐户可以逃脱并不重要。所以我想知道我应该重点改进上面的哪个结果？谢谢。

 *** * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T04:57:45.273

精度是归类为阳性的结果的分数，这确实是阳性的。

召回率是检测到的所有阳性结果的比例。

> 我的目的是减少被标记为“垃圾邮件”的普通帐户的数量。

这意味着您希望最大限度地提高*Spam的精度和**Not spam*的召回率。您链接到的 wiki 页面解释了您需要知道的所有内容 - 事实上，您的目的是最大限度地减少“误报”的数量（包括在这两个特征中）。

建议的关键词：[混淆矩阵](http://en.wikipedia.org/wiki/Confusion_matrix)。**

# java - 不能从静态上下文错误中引用非静态变量

> ID：16051726
> 
> 赞同：0
> 
> 时间：2013-04-17T04:48:57.483
> 
> 标签：java

```
public static void main(String[] args) {

Scanner input = new Scanner(System.in);
System.out.println("Enter expression: ");
String exp = input.nextLine().trim();

ExpressionTree exptree = new ExpressionTree1(); //new instance of ExpressionTree
TreeNode root = new TreeNode();
root = exptree.parseOutsideExpression(exp);
int evaluate = exptree.Compute(root);
String answer = Integer.toString(evaluate);
System.out.println("The evaluated expression is:" + answer);

}

class ExpressionTree{ 
```

我看过几个例子，我注意到一个常见的答案是在我已经完成的 main() 中创建你的对象的一个​​新实例，但我仍然得到同样的错误，我不清楚为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T10:35:14.237

如果`ExpressionTree`是与方法相同的类的内部类，`main()`则问题可能在于它不是静态的。非静态内部类只能在非静态代码中实例化......见：

> [Java内部类和静态嵌套类](https://stackoverflow.com/questions/70324/java-inner-class-and-static-nested-class)

# knockout.js - 长 ajax 调用打破淘汰赛绑定

> ID：16051727
> 
> 赞同：1
> 
> 时间：2013-04-17T04:49:05.510
> 
> 标签：knockout.js, asp.net-web-api, knockout-mapping-plugin, durandal

我正在使用 durandal 创建一个个人网站，并使用以下代码进行淘汰以绑定编辑博客页面。一切都很好，我能够将文本区域与 ajax 调用的返回文本绑定。

完成此操作后，我很好奇 Web 服务的长响应是否会破坏它，因此我将**Thread.Sleep(1000)**放入服务中，现在我无法将返回的文本绑定到文本区域。关于如何让它工作的任何建议？？？

*旁注：我认为这与 durandal 框架无关，但我想我会包括我就是它*

**javascript**

```
define(['services/logger', 'services/wysiwyg'], function (logger, wysiwyg) {

var postObservable = ko.mapping.fromJS({});
var vm = {
    activate: activate,
    post: postObservable,
};
return vm;

function activate(routeData) {
    var id = routeData.id;
    $.ajax(
        {
            type: "GET",
            url: '/api/blog/get',
            data: { id: id },
            dataType: "json",
        })
    .then(function(data){
        ko.mapping.fromJS(data, postObservable);
    });

   }

}); 
```

**C＃**

```
 public class BlogController : ApiController
    {
        public IBlogRepository _blogRepository;
        public BlogController(IBlogRepository blogRepository)
        {
            _blogRepository = blogRepository;
        }

        public BlogModel get(int id)
        {
            //Thread.Sleep(1000); <-- breaks when uncommented!!!
            return ConvertToModel(_blogRepository.ById(id));
        }

        private BlogModel ConvertToModel(BlogPost b)
        {
            return new BlogModel { DateCreated = b.DateCreated, Title = b.Title, Content = b.Content, Id = b.Id };
        }
    } 
```

**html**

```
<section>
    <div class="row">
        <textarea class="sceditor span12" data-bind="html: post.content"></textarea>
    </div>
    <div class="row">
        <button type="button" class="btn offset10 span1">Cancel</button>
        <button type="button" class="btn btn-primary span1">Save</button>
    </div>
</section> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T05:35:59.177

ajax 调用是一个异步任务，因此您应该返回一个 Promise。这样做会让 Durandal 等到 ajax 调用完成。

```
return $.ajax(
    {
        type: "GET",
        url: '/api/blog/get',
        data: { id: id },
        dataType: "json",
    })
.then(function(data){
    ko.mapping.fromJS(data, postObservable);
}); 
```

# java - 如何将我的应用程序文件夹添加到控制面板？

> ID：16051729
> 
> 赞同：0
> 
> 时间：2013-04-17T04:49:13.563
> 
> 标签：java, windows, swing, deployment

我使用 Java 创建了一个安装向导。它将我的应用程序文件夹安装到所需的位置，其快捷方式将发送到桌面和应用程序列表。但我需要将我的应用程序文件夹发送到控制面板。

如何将我的应用程序文件夹添加到控制面板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T08:54:47.603

**第1 步：**首先清理并构建您的项目并制作一个可执行的 jar 文件。

**第 2 步：**为了为您的应用程序创建设置，请使用[**Install Creator 2.0.34**](http://en.kioskea.net/download/download-9655-clickteam-install-creator)（用于为应用程序创建设置的第三方软件）并按照安装创建者中所述的步骤进行操作。

**第 3 步：**创建设置后，将其安装到您的系统中。

**第 4 步：**安装应用程序后，您可以在**“程序文件**”以及“控制面板”的“添加/删除程序”中**找到****您的应用程序**

 **否则在**Java Web-Start**中部署您的应用程序并创建一个**JNLP****

# css - 如何让 JS fiddle 使用简单的宽度和高度百分比

> ID：16051738
> 
> 赞同：0
> 
> 时间：2013-04-17T04:49:53.860
> 
> 标签：css, jsfiddle

我正在尝试发布一个我遇到的百分比问题，我在将其简化为 JS fiddle 中的简单案例时遇到了很多麻烦。我不想从这个问题中推断出太多，但 JS fiddle 迫使我这样做。

CSS：

```
.content-container {
   width: 100%;
   height: 100%;
   outline: 1px solid;
}

.inner-box {
   width: 56%;
   height: 56%;
   position: relative;
   outline: 1px solid;
} 
```

html:

```
<div class = "content-container">  
    <div class = "inner-box">

    </div>
</div> 
```

js小提琴：

[http://jsfiddle.net/XMBEq/1/](http://jsfiddle.net/XMBEq/1/)

完全相同的代码。

[http://bonkmas.com/examplejs.html](http://bonkmas.com/examplejs.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:51:57.680

你需要 -

```
html, body {
    width: 100%; height: 100%;
} 
```

[**工作演示**](http://jsfiddle.net/XMBEq/2/)

# c# - 2D CAD 画布实施

> ID：16051753
> 
> 赞同：1
> 
> 时间：2013-04-17T04:50:52.803
> 
> 标签：c#, canvas, 2d, cad

我想开发一个基于 C# 的简单交互式 2D cad 画布来显示简单的对象，如线条、弧线、文本。我也想执行对象选择和编辑。

我想评估选项，因为它是开始阶段。我做了相当多的调查，但我仍然对新想法持开放态度。我的一些创始是

1.  使用 OpenGL C# 库（OpenTK，SharpGL）[但我猜 OpenTK 被放弃了]
2.  让用户手动控制和实现所有功能，例如对象选择、对象添加等，但在这种情况下工作量非常大。

如果还有其他选择，您能告诉我吗？请给出一些提示，然后我才能做出正确的决定

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-12T00:45:57.500

WPF/Silverlight 也很合适。
看看我在后[2D CAD WPF 性能](https://stackoverflow.com/questions/9167654/2d-cad-application-in-wpf/17056012#17056012)方面的经验，尤其是在高端交互级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T05:31:42.013

我是使用 OpenTK 开发的。它为我自己的 CAD 开发提供了足够的支持，例如选择、字体支持。尽管 OpenTK 的开发在 2010 年就停止了，但仍有一些人继续在 Git 中维护源代码。

有一个 100 页的 PDF 安装手册，它对安装很有帮助。除此之外，请查看安装目录中的相应示例代码

# templates - D 类型推断取决于模板参数的顺序

> ID：16051761
> 
> 赞同：2
> 
> 时间：2013-04-17T04:51:46.773
> 
> 标签：templates, d, type-inference, dmd

```
T maybe(alias nullCheck, T)(T expr, T def)
{
    if (nullCheck(expr))
    {
        return def;
    }
    else
    {
        return expr;
    }
}

auto tokens = chomp(readln())
              .toLower()
              .split()
              .maybe!(a => a.empty)([""]) 
```

当模板参数`maybe`与别名一起排列时，编译器能够正确推断参数类型。但是，当模板参数切换为 T 先出现时，它无法推断它们，也不会编译。为什么是这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T07:18:16.033

这是因为模板参数毕竟是位置参数。如果`nullCheck`是第二个参数，则必须先指定`T`，然后才能指定`nullCheck`.

编译器只能（非正式地）尝试推断最后一个位置参数右侧的参数，就像它们是默认参数一样。

请注意，这与 C++ 中的相同，如果您考虑一下，这也是合理的。

# c - why the building a .so file involves multiple .c files

> ID：16051772
> 
> 赞同：0
> 
> 时间：2013-04-17T04:52:23.237
> 
> 标签：c, shared-libraries

I thought the `.so` file is like a `.o` file. And since the `.o` file is built directly from a single .c file, I'm confused why `.so` file involves linking of multiple `.c` files.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:55:07.617

A .so file is a library- its the end result of compiling and linking a bunch of code that goes together. It can be made from 1 .c file or multiple .c files. It all depends on how you want to organize your code. A .o file is an object file. Its the result of compiling, but not linking, a single file. Its used by the linker to combine with other .o files into an executable (.exe or equivalent) or library (.so, .dll, etc).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T04:55:38.757

> I thought the .so file is like a .o file.

No, it isn't. `.o` files are [object code](http://en.wikipedia.org/wiki/Object_code) (that's what compiling a `.c` source file results in), whereas `.so` files are [dynamically linked libraries](http://en.wikipedia.org/wiki/Dynamic-link_library). They are similar to executable files in that they can potentially be built from multiple object files, which are linked together.

The reason for this is that since dynamic libraries serve a different purpose from that of object files' (namely, providing access to functions and other symbols in a dynamically resolvable way), they need to be contain proper executable code with no dependencies. Just like a normal, stand-alone executable. Object files contain code that has unresolved dependencies, it's not directly executable, etc. That's why [linkage](http://en.wikipedia.org/wiki/Linkage_%28software%29) is performed on several object files, to resolve dependencies and to make a final file (referred to "the executable" even if it's not a stand-alone executable but a dynamic library, a kernel module, etc.)

# c - 关于 OpenCV 坐标

> ID：16051773
> 
> 赞同：4
> 
> 时间：2013-04-17T04:52:31.133
> 
> 标签：c, opencv, coordinates

我有一个关于 OpenCV 以及它在执行面部跟踪时如何呈现 ROI 坐标的快速问题。我能够打印出（x，y）坐标。但我试图找出一种绘制这些坐标的好方法。有谁知道单位是什么？它们以像素为单位吗？我可以用框架或类似的东西来绘制它们吗？谢谢，我仍然是 OpenCV 库的新手。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T05:31:09.343

OpenCV 以像素为单位表示坐标。左上角定义为**(0,0)**。向右的方向是**x**（列），向下的方向是**y**（行）。

通常，您使用 绘制点，使用 绘制`circle(img,center,radius,...)`线`line(img,point1,point2,...)`。

# python - 计算字符串中最小长度的唯一单词

> ID：16051777
> 
> 赞同：1
> 
> 时间：2013-04-17T04:53:08.980
> 
> 标签：python, function, loops, for-loop

我必须编写一个函数，它需要两个变量，即一个句子和一个数字。该函数应返回字符串中等于或大于该数字的唯一词的数量。示例结果应该是：

```
>>> unique_func("The sky is blue and the ocean is also blue.",3)
    6 
```

我能想到的解决方案是

```
def unique_func(sentence,number):
    sentence_split = sentence.lower().split()
    for w in sentence_split:
        if len(w) >= number: 
```

现在我不知道如何继续我的解决方案。谁能帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:55:38.287

尝试这个：

```
from string import punctuation

def unique_func(sentence, number):
    cnt = 0
    sentence = sentence.translate(None, punctuation).lower()
    for w in set(sentence.split()):
        if len(w) >= number:
            cnt += 1
    return cnt 
```

或者：

```
def unique_func(sentence, number):
    sentence = sentence.translate(None, punctuation).lower()
    return len([w for w in set(sentence.split()) if len(w) >= number]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T04:56:21.767

这里有一个提示：

```
>>> set('The sky is blue and the ocean is also blue'.lower().split())
{'is', 'also', 'blue', 'and', 'the', 'sky', 'ocean'}
>>> len(set('The sky is blue and the ocean is also blue'.lower().split()))
7 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T04:58:50.693

```
>>> from string import punctuation
>>> def unique_func(text, n):
        words = (w.strip(punctuation) for w in text.lower().split())
        return len(set(w for w in words if len(w) >= n))

>>> unique_func("The sky is blue and the ocean is also blue.",3)
6 
```

# android - 在 Android 上使用 phonegap 在单个事务上可以运行的 executeSql 语句的数量是否有限制？

> ID：16051778
> 
> 赞同：1
> 
> 时间：2013-04-17T04:53:10.450
> 
> 标签：android, sqlite, cordova, sp-executesql

在 Android 上使用 phonegap 在单个事务上可以运行的 executeSql 语句的数量是否有限制？我正在开始一个事务 (db.transaction(...))，然后遍历大约 4000 个产品。对于每个产品，我都在执行一个 executeSql INSERT 语句 (tx.executeSql(...))。所有的 executeSql INSERT 语句似乎都处理得很好，但是一旦它到达最后一个，我就会收到“内存不足”错误。该错误还指出“用户未能允许分配更多内存”。它在 iOS 和 Ripple 上运行良好，但在 Android 上是无用的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-15T21:42:08.087

> 在 Android 上使用 phonegap 在单个事务上可以运行的 executeSql 语句的数量是否有限制？

据我所知，sqlite、phonegap、android的具体使用没有限制。

我还尝试在循环中插入事务，每次迭代插入大约 8MB 的数据。

我也经历过Android内存不足。

就我而言，解决方案是将 executeSql() 方法包装在*匿名自执行函数*中。

仅在 Android 上导致内存溢出的原始代码：

```
db.transaction(function(){
  customers.forEach(function(customer){
    tx.executeSql(...);
  });
}); 
```

允许正确垃圾收集的解决方案：

```
db.transaction(function(){
  customers.forEach(function(customer){
    (function(){ tx.executeSql(...); })(); // <- Solution
  });
}); 
```

老实说，此刻我不完全明白为什么。我的猜测是匿名自执行函数创建了一个新的上下文，这就是影响垃圾收集周期的原因，我（也许我们）想要的行为。

试一试，让我们知道！

# c++ - 如何根据输入值调用函数？

> ID：16051779
> 
> 赞同：1
> 
> 时间：2013-04-17T04:53:15.293
> 
> 标签：c++, function

假设我只想在我的代码中调用一个函数：func()，但根据我给它的值，它是否直接指向该函数的正确“版本”？

我知道这可能与 if-statements/switch-statements 相关，但是它必须（低效地）检查传递了哪个值。我希望有一种预编译的方式来做到这一点？

这样的事情有可能以一种有效的方式进行吗？

```
func(3) 
```

将执行第三版 func()

```
func[1]{
    cout "One";
}

func[2]{
    cout "Two";
}

func[3]{
    cout "Three";
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T04:58:14.313

你可以有一个函数指针数组：

```
int foo_1() {
   cout << "One";
}

// ...

auto[] functions = {foo_1, foo_2, foo_3}; 
```

并调用它

```
 functions[0](); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T04:56:59.623

实际上，case-switch 非常有效，因为即使您有非常多的目标，它也可以在代码中将其编译为跳转表，而不是 if 链 - 所以 switch 的所有部分都将是等量的指令。

[http://en.wikipedia.org/wiki/Switch_statement#Compilation](http://en.wikipedia.org/wiki/Switch_statement#Compilation)

> 如果输入值的范围可以识别为“小”并且只有几个间隙，则某些包含优化器的编译器实际上可能将 switch 语句实现为分支表或索引函数指针数组，而不是冗长的一系列条件指令。 * 这允许 switch 语句立即确定要执行的分支，而无需通过比较列表。

此外：

1) 如果您没有将代码识别为减慢程序速度的瓶颈，请不要担心过早优化。

2）为什么调用具有不同值的函数会使其做完全不同的事情？不应该是不同的功能吗？（如果你想在一个循环中调用一堆函数，你总是可以创建一个函数指针数组 - 查找函数指针）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:56:55.787

当你这样做`func(3)`时，参数是常量，如果没有副作用，编译器将自动优化函数。这意味着函数不能修改全局变量、成员变量或写入传递给函数的任何指针。语句将`if`在运行时消失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T04:58:36.607

我相信可以为此使用模板化函数。

例如

```
template< int subfunc>
void func< subfunc>();

void func<1>(); 
```

像这样的东西应该工作:)

这样，当你调用它时，你会说：`func<1>();`它会调用另一个函数。

刚查了一下。此解决方案不会按照用户的意愿工作，因为在 V 形中输入的值必须是常量/编译时解析的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T05:16:39.653

由于我们在这里使用 C++ 是硬汉，我会使用`map`from `string`（您的输入）to `void *`（表示所有函数），这样我就不需要依赖映射中可调用函数的任何特定顺序。我也不需要将输入转换为数字（如果输入来自控制台并且是字符串）

```
#include <map>
#include <string>
#include <iostream>     // for cout

using namespace std;    // that's the way I like it

int main()
{
    map<string, void *> funcs;

    funcs["func1"] = (void *)func1;
    funcs["func2"] = (void *)func2;
    ...

    string s = myinput();
    if (funcs.find(s) != funcs.end()) {
        ((void (*)())funcs[s])();   // call the function (first casting it to the function's data type
    }
    else cout << "### Error: function " << s << " doesn't exist in map" << endl;

    return 0;
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-04-17T04:56:52.860

您可以使用值模板来做到这一点。但如果你这样做，为什么还要有一个函数呢？为什么不只是有 N 个不同命名的函数，在维护代码时它会更容易混淆。

# logging - NLog 不会写入文件名包含点的目标文件

> ID：16051780
> 
> 赞同：7
> 
> 时间：2013-04-17T04:53:21.163
> 
> 标签：logging, windows-services, windows-server-2008-r2, nlog

当使用“NT AUTHORITY\NETWORK SERVICE”凭据启动我的 Windows 服务时，我遇到了一个奇怪的 NLog 问题：如果文件名包含点，它根本不会将任何内容记录到文件目标。

我在启用了 .NET Framework 3.5 SP1 功能的 WinServer 2008 R2 Standard 上运行 Windows 服务，NLog.config 如下：

```
<targets>
  <target xsi:type="File"
    name="f" 
    fileName="${basedir}/logs/${shortdate}.txt"
    encoding="utf-8"
    concurrentWrites="true"
    keepFileOpen="false"
    layout="${longdate} ${uppercase:${level}} ${message}"/>
</targets>
<rules>
  <logger name="*" minlevel="Trace" writeTo="f" />
</rules> 
```

经过一些谷歌搜索和配置试验后，我想出了一个解决方法，在`fileName`参数中不包含文件扩展名，它工作得很好，解决了问题，但看起来不像是一个体面的解决方案。

让这个问题对我来说更像是一个奇怪的魔法的原因是，我设法解决了我的第二个 Windows 服务（它在具有相同凭据的同一台机器上运行）的配置中的日志文件扩展名的问题，只需通过更改项目选项中的装配信息。

有任何想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-17T05:16:50.920

启用 NLog 的内部日志文件后

```
<nlog 
  internalLogFile="c:\temp\nlogproblems.txt"  
  throwExceptions="true"  
  xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> 
```

我设法抓住了`UnathorizedAccessException`

```
2013-04-17 11:06:14.0445 Error Exception in asynchronous handler 
  NLog.NLogRuntimeException: Exception occurred in NLog --->
  System.UnauthorizedAccessException: Access is denied. 
  (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)) 
```

`logs`这导致我应该修复文件夹权限的结论。

终于不再有奇怪的魔法了，我只需要允许`NETWORK SERVICE`写入`logs`文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-10T13:32:05.557

在我的情况下，它是运行应用程序池的用户。

似乎在某些情况下您需要特定用户，我的案例正在运行 IHttpHandler 并且我从 ProcessRequest 调用了其他方法，并且由于某种原因从 ProcessRequest 本身它工作正常，但从我得到的子方法

```
Exception in asynchronous handler 
  NLog.NLogRuntimeException: Exception occurred in NLog --->
  System.UnauthorizedAccessException: Access is denied. 
  (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)) 
```

在阅读了 7kun 的答案后，我给了每个人完全的控制权并且它起作用了，然后改变以找到真正失踪的用户

# javascript - Javascript：需要自动舍入的解决方法

> ID：16051781
> 
> 赞同：0
> 
> 时间：2013-04-17T04:53:25.627
> 
> 标签：javascript, rounding, ieee-754

我有一个javascript计算要做：

```
var temp = ((1 + 0.07)^(1/12))-1; 
```

对此的实际答案是：

0.00565414539

在 ^(1/12) (0.833..) 你得到 1.00565414539

但是，Javascript 会自动将其四舍五入为 1。

对此有任何修复吗？

可能有一百万个这样的问题，但我在快速的谷歌搜索中找不到任何问题，而且我一直在纠结这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T04:58:58.570

`^`是按位异或运算符，而不是`power of`运算符。

你需要做：

```
var temp = (Math.pow((1 + 0.07),(1/12)))-1; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T04:58:16.200

尝试使用 Math.pow() 函数代替 ^ 进行功率计算。

```
alert(Math.pow(1 + 0.07,1/12)-1); 
```

# css - 如何在考虑滚动条宽度的同时使用引导网格布局

> ID：16051797
> 
> 赞同：2
> 
> 时间：2013-04-17T04:55:08.247
> 
> 标签：css, twitter-bootstrap, responsive-design, scrollbar

请看一下这个 jsFiddle： http: [//jsfiddle.net/arasbm/c8MBg/2/](http://jsfiddle.net/arasbm/c8MBg/2/)，它是我根据[twitter 引导脚手架示例](http://twitter.github.io/bootstrap/scaffolding.html#fluidGridSystem)制作的。

```
<div class="span9 scroll-sucker">
<div class="row show-grid">
    <div title="" data-original-title="" class="span1">1</div>
    <div title="" data-original-title="" class="span1">1</div>
    <div title="" data-original-title="" class="span1">1</div>
    <div title="" data-original-title="" class="span1">1</div>
    <div title="" data-original-title="" class="span1">1</div>
    <div title="" data-original-title="" class="span1">1</div>
    <div title="" data-original-title="" class="span1">1</div>
    <div title="" data-original-title="" class="span1">1</div>
    <div title="" data-original-title="" class="span1">1</div>
</div>
<div class="row show-grid">
    <div title="" data-original-title="" class="span4">4</div>
    <div title="" data-original-title="" class="span5">5</div>
</div>
<div class="row show-grid">
    <div title="" data-original-title="" class="span9">9</div>
</div>
</div> 
```

我正在尝试使用 twitter 引导网格系统在我的 UI 中布局一些组件，同时保持内容响应。当网格容器获得滚动条时，就会出现问题。例如，在这种情况下，当我的 9 号容器没有滚动条时，它可以按预期在一行中容纳 9 X span1 div。但是，当它有一个垂直滚动条（在任何桌面浏览器上）时，它只能连续容纳 8 x span1 div。

```
.scroll-sucker {
  overflow: scroll;   
} 
```

![在此处输入图像描述](https://i.stack.imgur.com/dhzfF.png)

我可以想到许多不同的hacky方法来解释滚动条的大小，但是解决这个问题的引导方法或推荐方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:30:56.953

我不认为有一个标准的“引导方式”来做到这一点......引导提供的响应能力是在您缩小窗口时重新调整跨度元素的大小，然后当窗口变得非常窄时，它会将它们全部堆叠起来垂直。我不认为它真的是在考虑将滚动条添加到跨度的情况下构建的。

我很好奇为什么跨度上有一个滚动条。在您的示例中，如果您在跨度*周围*创建一个 div并将滚动条放在其上，它可能会按照您的预期工作。这是您的 jsfiddle 更新：http: [//jsfiddle.net/c8MBg/5/](http://jsfiddle.net/c8MBg/5/)

```
<div class="scroll-sucker">
<div class="span9 ">
<div class="row show-grid">
    stuff....
</div>
</div>
</div> 
```

编辑也通常`span{#}`元素总是在`row`元素内。最后，我想说没有标准的方法，如果这是你真正需要的东西，你只需要让它工作......（可能是hacky）

# sphinx - 使用带密码的 SphinxQl 连接 Sphinx 服务器

> ID：16051798
> 
> 赞同：0
> 
> 时间：2013-04-17T04:55:10.867
> 
> 标签：sphinx

通常我们使用 API 连接 sphinx 服务器 sobj->("ip","port", "SphinxAttribute",5000);

在 sphinxQL 中：任何选项都可以使用用户名和密码连接 sphinx 服务器。LIKE $s->DbConn("ip",'uname','pwd','',$SPHINXQLCONIPPORT);

请建议：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T10:55:27.133

只需将用户名/密码留空即可。任何都被接受。Sphinx 不使用基于密码的安全性。（就像您也不需要指定数据库一样）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-30T13:40:57.977

> 不，没有办法设置用户名密码。如果担心，您可以使您的索引名称难以猜测。没有显示表。但一般只使用防火墙来锁定对特定 IP 地址的访问。

# django - django“无法通过用户实例访问管理器”

> ID：16051808
> 
> 赞同：0
> 
> 时间：2013-04-17T04:55:47.267
> 
> 标签：django, python-2.7, django-views

我有一个注册表格，它将用户的名字和姓氏保存到 auth_user 表中。

登录后，我有一个编辑页面，允许用户编辑他们的名字和姓氏，这些名字和姓氏应该保存（覆盖）到相应 user_id 中的 auth_user 表中

当我尝试这样做时，我收到错误，因为**“无法通过用户实例访问管理器”**

```
def editresume(request):

    if request.method == "POST":
      fname = request.POST.get('fname')
      lastname  = request.POST.get('lastname')
      User = request.user
      edit1 = User.objects.get(user_id=user)
      edit1.fname =fname
      edit1.lastname = lastname
      edit1.save()
      return HttpResponseRedirect('/accounts/Profile/')
    else:
        return render_to_response('registration/personal_information.html',context_instance=RequestContext(request)) 
```

帮我解决这个问题..！谢谢。，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:58:10.203

您在这些行中有错误

```
User = request.user
edit1 = User.objects.get(user_id=user) 
```

可能您错误地定义了变量`User`（使用大写的“U”），您应该检查`id`not `user_id`。

你想把它改成

```
user = request.user
edit1 = User.objects.get(id=user.id) 
```

或者最好不要直接定义使用`request.user`

```
edit1 = User.objects.get(id=request.user.id) 
```

或者最好不要从数据库中获取，你可以直接使用对象`request.user`

```
edit1 = request.user 
```

# c# - 访问路径被拒绝使用 c# 移动目录

> ID：16051809
> 
> 赞同：1
> 
> 时间：2013-04-17T04:55:59.090
> 
> 标签：c#, asp.net-mvc-4

当我尝试剪切和粘贴目录（子文件夹和文件）时，它给了我对路径的访问被拒绝的错误。有时当我将任何文件上传到该目录时它会起作用，然后它会显示错误。

我拥有对该目录和子目录的完全访问权限。我可以删除和上传该目录下的文件，但不能将该目录移动到任何其他位置。

我努力了：

1.  完全访问网络服务和所有人。
2.  更新应用程序池的标识。

我也试过这个

```
 DirectorySecurity dSecurity = dInfo.GetAccessControl();
 dSecurity.AddAccessRule(
    new FileSystemAccessRule("everyone", FileSystemRights.FullControl, InheritanceFlags.ObjectInherit | InheritanceFlags.ContainerInherit,PropagationFlags.InheritOnly,AccessControlType.Allow));
dInfo.SetAccessControl(dSecurity);

 //move function
 Source = Server. MapPath (source);
  destination = Server.MapPath(destination);  
  If (! Directory. Exists (destination))
   {                           
    Directory.Move(source, destination);                              

   }
   catch (Exception e)
  {
      return e.Message;
  } 
```

如果您知道为什么我会收到此错误，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:10:14.880

正如@Arsen 所说，尝试一个一个地移动每个文件，

还要检查

> > **目录模式
> > 
> > **尝试移动目录的用户权限
> > 
> > **否则，可能会尝试以超级用户身份移动目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:04:12.707

“源”目录中的某个文件可能正在使用中且无法移动。尝试循环移动目录中的每个文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T05:12:19.583

源目录中的一个文件可能正在被另一个进程使用并且无法移动。尝试一个一个地移动每个文件，然后你会得到一些文件正在被另一个进程使用。

# sharepoint-2010 - Sharepoint 移动兼容性

> ID：16051815
> 
> 赞同：1
> 
> 时间：2013-04-17T04:56:36.553
> 
> 标签：sharepoint-2010

我有一个现有的共享点站点。我怎样才能使这个网站移动兼容。当用户在移动设备上浏览网站时，我是否需要为移动视图创建单独的页面并导航到它们？您是否可以参考上述任何有用的链接

任何帮助都会得到帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T07:25:21.880

据我所知，sharepoint 已经能够处理移动视图。

![在此处输入图像描述](https://i.stack.imgur.com/nzUlr.jpg)

在这里您可以看到它已经在关于共享点站点的移动站点的站点信息中进行了指示。您可以通过站点操作>站点设置访问它，您将在屏幕的右侧看到它。

# java - 如果我们没有任何 haspmap api，如何制作 HaspMap

> ID：16051823
> 
> 赞同：-5
> 
> 时间：2013-04-17T04:57:39.523
> 
> 标签：java

**如果我们没有任何 haspmap api，如何制作 HaspMap？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:08:21.207

如果你真的需要自己设计，那么你至少应该读一本关于数据结构和算法的书。

这是一个简单的基于 C++ 向量的[HashTable 实现。](http://coliru.stacked-crooked.com/view?id=7c8bf1e747f31f7308ea591cb3bd4129-d8a6f6e6988ed9869ff36c1f09c9e787)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T04:58:34.217

只需创建一个具有两个属性（键和值）的类并提供适当的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T05:02:15.307

我赌一把，猜你的意思是`HashMap`，你没有`HashMap`API 的原因是你使用的是 Java ME。

答案是使用`HashTable`...... Java ME 所拥有的，AFAIK。

* * *

另一方面，如果这是一个家庭作业问题，并且您被要求从头开始实现自己的哈希表，那么您应该首先阅读哈希表的工作原理。请参阅您的讲义、数据结构教科书……或在 Wikipedia / Google 上查找“哈希表”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T05:07:39.423

哈希映射的基础是：

1）拥有后备存储 - 一个至少与您已经包含的条目数一样大的数组（或等价物）。两个数组，一个用于键，一个用于值，或者一个键值对元组数组（后者可能更好）

2) 决定我们将新键放入哪个键数组索引的函数。通常这将是 key.HashCode()%array.Length - 但如果它已经持有一个密钥并且它不是同一个密钥（通过 key.Equals()，那么你尝试右边的下一个桶，然后下一个，依此类推，直到我们找到一个。只要我们在从哈希映射中删除一个键时执行相反的操作，就可以这样做 - 换句话说，因为这个“滑动键”操作已经完成，因为没有洞，如果我们打了一个洞，我们必须看看是否需要将钥匙滑入其中以填补空隙（例如，不要将任何钥匙滑到比我们要检查的第一个位置更远的地方，否则如果我们可以向左滑，向左滑动）。

3) 现在，要查看 HashMap 中是否存在键，计算我们将它放在哪里并检查该索引。如果它被占用并且等于（），找到它。如果它被占用并且不匹配，请以相同的方式检查右侧的一个。如果它是空的，没有找到它。

4) 一个操作，一个艰难的操作——当我们快要填满时，重建两倍大小的后备存储（我们越接近填满，效率越差，所以你想在你之前加倍填上）。您必须为后备存储分配两倍大的空间，为新存储重新计算旧存储中每个键的位置，复制键和值，丢弃旧存储并安装新存储。

# google-app-engine - 在 GAE Channel API 中，未调用 onmessage

> ID：16051824
> 
> 赞同：1
> 
> 时间：2013-04-17T04:57:42.377
> 
> 标签：google-app-engine, webapp2, channel-api

我正在使用 python API 为 GAE 构建一个应用程序。[它在这里运行。](http://srilankanomiv1.appspot.com/)这是一款多人游戏。我使用 Channel API 在玩家之间传达游戏状态。

但在应用引擎中，不会调用通道的*onmessage处理程序。**调用 onopen*处理程序。*onerror*或*onclose*也不会被调用。奇怪的是这在本地开发服务器中完美运行。

有没有可能这样的事情可以在开发服务器上运行，但不能在应用程序引擎本身上运行？

如果有人可以查看我的应用程序的以下描述并帮助我弄清楚发生了什么，我会非常高兴。谢谢你。

我调查了[这个](https://stackoverflow.com/questions/6589559/appengine-channel-no-messages-arrive)和[这个](https://stackoverflow.com/questions/6589559/appengine-channel-no-messages-arrive)问题，但我没有犯过这些错误。

```
<script>

        sendMessage = function(path, opt_param, opt_param2) {

            path += '?g=' + state.game_key;
            if (opt_param) {
                path += '&' + opt_param;
            }
            if (opt_param2) {
                path += '&' + opt_param2;
            }
            var xhr = new XMLHttpRequest();
            xhr.open('POST', path, true);
            xhr.send();
        }; 
```

上述函数用于向服务器发出 post 请求。

```
onOpened = function() {
        sendMessage('/resp');
        console.log('channel opened');
    }; 
```

上面是我想在通道第一次打开时调用的函数。我将帖子发送到“/resp”地址。

```
onMessage = function(m) {
    console.log('message received');
    message = JSON.parse(m.data);
    //do stuff with message here 
}; 
```

我想在上述函数中处理从该请求中得到的响应。

以下是 onerror 和 onclose 处理程序。

```
onError = function() {
        console.log('error occured');
        channel = new goog.appengine.Channel('{{ token }}');
        socket = channel.open();
    };

    onClose = function() {
        console.log('channel closed');
    };

    channel = new goog.appengine.Channel('{{ token }}');
    socket = channel.open();
    socket.onopen = onOpened;
    socket.onmessage = onMessage;
    socket.onclose = onClose;
    socket.onerror = onError;

</script> 
```

该脚本位于 body 标记的顶部。这在我的本地开发服务器中运行良好。但是在应用引擎上，调用了
onOpen 函数。
我可以在服务器日志中看到对 /resp 的请求。
但永远不会调用 onMessage 。控制台中不存在日志“收到的消息”。

这是服务器端。

```
token = channel.create_channel(user.user_id() + game.user1.user_id() )
url = users.create_logout_url(self.request.uri)
template_values = {
                  'token' : token,
                  'id' : pid,
                  'game_key' : str(game.user1.user_id()),
                  'url': url
                 }
path = os.path.join(os.path.dirname(__file__), 'game.html')
self.response.out.write(template.render(path, template_values)) 
```

这是在“/resp”请求的请求处理程序中。我的应用程序是一个多人纸牌游戏。我想通知其他玩家连接了新玩家。即使是新连接的玩家也会收到此消息。

```
class Responder(webapp2.RequestHandler):            
    def post(self):
        user = users.get_current_user()
        game = OmiGame.get_by_key_name(self.request.get('g'))
        if game.user1:
            channel.send_message(game.user1.user_id() + game.user1.user_id() , create_message('%s joined.' % user.nickname()))
        if game.user2:
            channel.send_message(game.user2.user_id() + game.user1.user_id() , create_message('%s joined.' % user.nickname())) 
```

**编辑**：user1 是创建游戏的用户。我希望通过添加 user1 的 user_id 和相关用户 user_id 来创建其他玩家的令牌。这里会出问题吗？

所以当我在本地开发服务器上尝试这个时，我得到这些消息非常好。但是在 GAE 上 onMessage 没有被调用。[这是我的应用程序。](http://srilankanomiv1.appspot.com/)当单击创建按钮时，加载了上面脚本的页面并应显示“已连接玩家昵称”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T05:16:30.170

开发服务器和生产服务器上的通道行为有些不同。在开发服务器上，通道客户端只是频繁地轮询 http 请求。在生产中，使用彗星式长轮询。

我怀疑在 onOpened 处理程序中进行 XHR 调用可能存在问题。至少在 Chrome 中，我看到通道 API 使用的下一个talkgadget GET 请求被取消。

尝试在 onMessage 函数之外调用 sendMessage('/resp') 。也许通过使用 setTimeout 将其排入队列以运行，以便稍后在您返回后调用它。

# gcc - 部署共享库需要检查哪些操作系统内容

> ID：16051826
> 
> 赞同：0
> 
> 时间：2013-04-17T04:57:57.193
> 
> 标签：gcc

我面临一个问题，代码是在 gcc 版本 3.4.6（RED 有 Linux）中编译的，并且共享库部署在其他一些具有 gcc 版本 4.1.2 的 linux 系统上。退出时代码崩溃。我知道一旦创建了共享库，编译器就无事可做。我错了吗？

如果不是其他操作系统功能依赖于共享库的执行，就像在某些 linux 环境中一样，我的代码在退出时会崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:59:57.807

该代码可能取决于特定版本的 libc，因此您应该检查一下。

# c - 奇怪的 mmap 行为

> ID：16051828
> 
> 赞同：1
> 
> 时间：2013-04-17T04:58:14.060
> 
> 标签：c, linux, posix

在我的机器上 test_anon_shared 似乎可以工作，而 test_anon 因“无效参数”错误而失败。知道我哪里出错了吗？

```
#include <unistd.h>
#include <sys/mman.h>

#include <stdio.h>
#include <stdlib.h>

void *test_anon(void) {
  printf("testing MAP_ANONYMOUS only!\n");
  void *mem = mmap(NULL, 4096, PROT_READ | PROT_WRITE,
                   MAP_ANONYMOUS, -1, 0);
  if (mem == MAP_FAILED) {
    perror("test_anon");
    abort();
  }
}

void *test_anon_shared(void) {
  printf("testing MAP_ANONYMOUS | MAP_SHARED!\n");
  void *mem = mmap(NULL, 4096, PROT_READ | PROT_WRITE,
                   MAP_ANONYMOUS | MAP_SHARED, -1, 0);
  if (mem == MAP_FAILED) {
    perror("test_anon_shared");
    abort();
  }
}

int main(void) {
  printf("test_anon_shared = %p\n", test_anon_shared());
  printf("test_anon = %p\n", test_anon());
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T05:07:51.377

您必须始终指定`MAP_PRIVATE`或`MAP_SHARED`。两者都省略是错误的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T05:08:09.050

您的标志中必须有一个`MAP_SHARED`或`MAP_PRIVATE`。[`mmap(2)`](http://man7.org/linux/man-pages/man2/mmap.2.html)手册页：

> [...] 这种行为是通过在标志中包含以下值**之一来确定的：**

```
 MAP_SHARED [...]
   MAP_PRIVATE [...] 
```

# php - 使用查询值更改 youtube 嵌入代码中的视频 ID

> ID：16051831
> 
> 赞同：1
> 
> 时间：2013-04-17T04:58:16.673
> 
> 标签：php, javascript, youtube, embed

我想要做的基本上是从html页面中获取参数并将其作为视频ID放入youtube嵌入代码中，因此当页面加载时，它会显示相应视频的嵌入式播放器。

我希望它如何工作，是在网页上有按钮，该按钮将链接到带有参数中视频 id 的 video.html 页面，并加载相应的视频。

我知道我可能必须使用 javascript 或 php，但我不知道它们，所以请尽可能清楚地解释。所以我想尽可能简单地用我的查询字符串替换“VIDEOID”。

```
<iframe width="560" height="315" src="http://www.youtube.com/embed/"VIDEOID" frameborder="0" allowfullscreen></iframe> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:10:59.267

尝试按照此代码[从 html 中的 url 获取参数值](http://www.netlobo.com/url_query_string_javascript.html)

希望它对你有帮助..

# stata - 连续变量和分类变量的交互作用代表什么（Stata）？

> ID：16051837
> 
> 赞同：0
> 
> 时间：2013-04-17T04:58:45.597
> 
> 标签：stata, interaction

这是来自Stata在线教程的引用：**如果您想将连续变量与因子变量进行交互，只需在连续变量前面加上c即可。** [http://www.stata.com/capabilities/overview/factor-variables/](http://www.stata.com/capabilities/overview/factor-variables/)

他们举了下面的例子：`smoker#c.bmi`.

`smoker`是一个分类变量，编码为 1 个不吸烟者、2 个吸烟者、3 个重度吸烟者。

`bmi`是一个连续变量，体重指数。

当他们创建交互项`smoker#c.bmi`时，它显示了什么以及如何解释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:31:28.487

在我看来，这`smoker`是一个虚拟变量（1/0）[请参阅下面的注释]。请仔细检查以下句子：

我们对年龄组的全因子以及*人是否吸烟*以及连续体重指数 (bmi) 及其与*人是否吸烟*的相互作用进行了线性回归[强调]

```
cholesterol = -0.517 smoker + 0.03455 bmi + 0.0245 bmi*smoker + other parts 
```

on 的系数`bmi`表示`bmi`对非吸烟者的影响，而 on 的系数`bmi*smoker`给出了对吸烟者的增量影响`bmi`（即，对于吸烟者，它是 0.03455 + 0.0245，而对于非吸烟者，它是 0.03455）。交互项的重要性表明吸烟者对胆固醇的影响`bmi`高于非吸烟者。

注意：有三类年龄组，而不是三类吸烟者。

# python-ldap - 如何设置 Active Directory 用户的 lockoutTime 和密码

> ID：16051839
> 
> 赞同：4
> 
> 时间：2013-04-17T04:58:52.117
> 
> 标签：python-ldap

我想更改 AD 用户的 userAccountControl 和密码。用户已在 AD 中创建。用户是使用 AD 中的 python-ldap 模块创建的，处于“禁用”状态且没有密码。

AD 托管在 win2k8R2 上。

当我使用 pythion-ldap 脚本更改 uac 和密码时，它会抛出以下错误：

```
ldap://192.168.254.1:389
(97, [])
Traceback (most recent call last):
  File "C:\workspace\utils\src\u.py", line 16, in <module>
    l.modify_s(dn, mod_attrs)
  File "C:\Python26\lib\site-packages\ldap\ldapobject.py", line 336, in modify_s
    return self.result(msgid,all=1,timeout=self.timeout)
  File "C:\Python26\lib\site-packages\ldap\ldapobject.py", line 436, in result
    res_type,res_data,res_msgid = self.result2(msgid,all,timeout)
  File "C:\Python26\lib\site-packages\ldap\ldapobject.py", line 440, in result2
    res_type, res_data, res_msgid, srv_ctrls = self.result3(msgid,all,timeout)
  File "C:\Python26\lib\site-packages\ldap\ldapobject.py", line 446, in result3
    ldap_result = self._ldap_call(self._l.result3,msgid,all,timeout)
  File "C:\Python26\lib\site-packages\ldap\ldapobject.py", line 96, in _ldap_call
    result = func(*args,**kwargs)
ldap.UNWILLING_TO_PERFORM: {'info': '00002077: SvcErr: DSID-031903A4, problem 5003 (WILL_NOT_PERFORM), data 0\n', 'desc': 'Server is unwilling to perform'}

import ldap

host = "192.168.254.1"
ip = "ldap://%s:%d"%(host, 389)
l = ldap.initialize(ip)
newUser = "vishalworld"
dn = "cn=%s,%s"%(newUser, "cn=Users,DC=example,DC=com")
print l.simple_bind_s("administrator",password)
pwd = '"abcdefgh"'.encode("utf-16-le")
mod_attrs = [
                (ldap.MOD_REPLACE, "lockoutTime", 0),
                (ldap.MOD_REPLACE, "unicodePwd", pwd),
            ]
l.modify_s(dn, mod_attrs) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-15T05:53:13.240

首先，您需要为您的 AD 添加 tls 支持。[http://araihan.wordpress.com/2009/10/05/windows-server-2008-active-directory-certificate-services-ad-cs/](http://araihan.wordpress.com/2009/10/05/windows-server-2008-active-directory-certificate-services-ad-cs/)这是一个解释如何创建证书的教程

然后您需要使用 tls 向 AD 进行身份验证。像这样

```
import ldap

LDAP_SERVER_EMG = "ldaps://192.168.0.250"
BIND_DN = "Administrador@emgS.local"
BIND_PASS = "xxxXXXxxxXXXxxx"
USER_BASE = "dc=emgS,dc=local"
try:
   ldap.set_option(ldap.OPT_X_TLS_REQUIRE_CERT, 0)
   lcon_emg = ldap.initialize(LDAP_SERVER_EMG)
   lcon_emg.simple_bind_s(BIND_DN, BIND_PASS)
except ldap.LDAPError, e:
   print e 
```

然后你可以添加你的用户进行测试

```
ad_u = {
            'objectClass': ['top', 'person', 'organizationalPerson', 'user'],
            'cn': 'test',
            'displayName': 'test',
            'distinguishedName': 'CN=test,DC=emgS,dc=local',
            'givenName': 'test test',
            'sAMAccountName': 'test',
            'sn': 'test',
            'userAccountControl': '514',
            'userPrincipalName': 'test@emgS.local',
            'mail': mail_user,
             #732 is test in 3ll1t3
            'employeeID': '732'
            }
        mods = ldap.modlist.addModlist(ad_u)

        try:
            lcon_emg.add_s(ad_u.get('distinguishedName'),
                                mods)
        except Exception, e:
            response.update({'error_ad': 'ActiveD: Error  %s' % str(e)})
        else:
            response.update({'success_ad': 'ActiveD: F4ck y34h'})

    #then you can put a password for the user
    unicode_pass = unicode('\"' + "my super secret password :)" + '\"', 'iso-8859-1')
    password_value = unicode_pass.encode('utf-16-le')
    add_pass = [(ldap.MOD_REPLACE, 'unicodePwd', [password_value])]
    # 512 will set user account to enabled
    mod_acct = [(ldap.MOD_REPLACE, 'userAccountControl', '512')]

    try:
        lcon_emg.modify_s(ad_u.get('distinguishedName'), add_pass)
    except ldap.LDAPError, error_message:
        response.update({'error_ad_clave': 'ActiveD: Error %s' % str(error_message)})
    else:
        response.update({'success_ad_clave': 'ActiveD: Yeah'})

    try:
        lcon_emg.modify_s(ad_u.get('distinguishedName'), mod_acct)
    except ldap.LDAPError, error_message:
        response.update({'error_ad_hab': 'Error  %s' % str(error_message)})
    else:
        response.update({'success_ad_hab': 'Success'})
        lcon_emg.unbind_s() 
```

和TA TA！！！

# php - 使用 PHP、FPDF 的日期范围问题

> ID：16051841
> 
> 赞同：0
> 
> 时间：2013-04-17T04:58:52.710
> 
> 标签：php, mysql, fpdf

我在 FPDF 显示我想要显示的日期范围时遇到问题。它每次都会从数据库的开头提取每个日期。不管我把它放在什么范围内，它都是从开始到结束的日期。任何帮助都会有所帮助。

这是代码：

```
 <?php
      define('FPDF_FONTPATH','font/');
       require('mysql_table.php');

        class PDF extends PDF_MySQL_Table
       {
      function Header()
       {
       //Title
       $this->Image('eagle.png',10,6,30);
        $this->Image('eagle.png',170,6,30);
       $this->SetFont('Arial','',18);
       $this->Cell(0,6,'Range Report',0,1,'C');
       $this->Ln(20);
        //Ensure table header is output
        parent::Header();
        }
        } 

        //Connect to database
        mysql_connect('localhost','root','');
        mysql_select_db('charitabledb');

        $pdf=new PDF();
        $pdf->Open();
        $pdf->AddPage();
         //table: specify 4 columns
        $pdf->AddCol('date',20,'Date','C');
        $pdf->AddCol('transactiontype',30,'Transaction','L');
        $pdf->AddCol('account',40,'Account','L');
         $pdf->AddCol('description',60,'Description','L');
         $pdf->AddCol('Expense',20,'Expense','R');
         $pdf->AddCol('Income',20,'Income','R');
        $prop=array('HeaderColor'=>array(255,150,100),
        'color1'=>array(210,245,255),
        'color2'=>array(255,255,210),
        'padding'=>2);
        $startdate=$_Post['startdate'];
        $enddate=$_POST['enddate'];
         $pdf->Table("SELECT * FROM accounting WHERE date between '" . $startdate . "' AND '" . 
         $enddate . "' order by date ASC",$prop);

         $pdf->AddCol('',150,'');
         $pdf->AddCol('Sum(Expense)',40,'Total Expense','R');
         $prop=array('HeaderColor'=>array(255,150,100),
         'color1'=>array(210,245,255),
         'color2'=>array(255,255,210),
         'padding'=>2);
         $pdf->Table("select Sum(Expense) from accounting WHERE date between '" . $startdate . "' 
         AND '" . $enddate . "'",$prop);
         $pdf->AddCol('',150,'');
         $pdf->AddCol('Sum(Income)',40,'Total Income','R');
         $prop=array('HeaderColor'=>array(255,150,100),
         'color1'=>array(210,245,255),
         'color2'=>array(255,255,210),
         'padding'=>2);
          $pdf->Table("select Sum(Income) from accounting WHERE date between '" . $startdate . "' 
          AND '" . $enddate . "'",$prop);
          $pdf->AddCol('',150,'');
          $pdf->AddCol('Sum(Income)-Sum(Expense)',40,'Total Revenue','R');
           $prop=array('HeaderColor'=>array(255,150,100),
         'color1'=>array(210,245,255),
         'color2'=>array(255,255,210),
         'padding'=>2);
          $pdf->Table("select Sum(Income)-Sum(Expense) from accounting WHERE date between '" . 
           $startdate . "' AND '" . $enddate . "'",$prop);

           $pdf->Output();
            ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:26:44.487

问题出在您的 MySQL 查询中...从您的代码中提取...

```
$query = "SELECT * FROM accounting WHERE date between '" . $startdate . "' AND '" . $enddate . "' order by date ASC"; 
```

`$startdate`和的格式是`$enddate`什么？您可能会考虑对它们执行显式强制转换以确保 MySQL 做正确的事情。我假设日期是一个日期时间列。如果不是，请相应调整。

WHERE date BETWEEN CAST('$startdate' as datetime) AND CAST('$enddate' as datetime)

除此之外，您可以打印该查询的输出并单独通过数据库运行它。您可以调整查询，直到获得预期的结果。如果您可以在此处添加示例查询，那也会有所帮助。

附带说明，如果此应用程序用于生产环境，请转义来自用户的任何输入。否则，您将面临 SQL 注入攻击的风险。

# asp.net-mvc - 使用 ActionResult 时出错

> ID：16051849
> 
> 赞同：-1
> 
> 时间：2013-04-17T04:59:24.590
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

我有一个 View(FilerOverall) 并且在视图内我正在使用 renderaction 方法调用一些方法。

```
@{
Html.RenderAction("Gettemplate", "FinancialDisclosure", 
    new { FormId = "100",ScheduleId= "10" });
}; 
```

在控制器中我写了动作方法，比如

```
public ActionResult Gettemplate(string FormId ,string ScheduleId)
{
    List<FDDTO> FD1 = FDService.GetScheduleDetails(100, 10).ToList();
    return View ("EditorTemplates/FDDTO", FD1);
} 
```

当我执行应用程序时，我收到此错误：

> “在控制器 'WorldBank.DOI.Presentation.Controllers.FinancialDisclosureController' 上找不到公共操作方法 'Gettemplate'。”}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T06:08:25.593

你应该试试这个

创建像**Demo.cshtml这样的新视图**

现在

```
public ActionResult Gettemplate(string FormId ,string ScheduleId)
{
    List<FDDTO> FD1 = FDService.GetScheduleDetails(100, 10).ToList();
    return View ("Demo", FD1);
} 
```

现在把你的**FilerOverall.cshtml 放在**下面的代码中

```
@{
Html.RenderAction("Gettemplate", "FinancialDisclosure", 
    new { FormId = "100",ScheduleId= "10" });
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:54:09.950

尝试`@Html.Action`代替`Html.RenderAction`

```
@Html.Action("Gettemplate", "FinancialDisclosure",  new { FormId = "100",ScheduleId= "10" }) 
```

# java - 返回值的约定是什么？

> ID：16051850
> 
> 赞同：4
> 
> 时间：2013-04-17T04:59:24.667
> 
> 标签：java, coding-style, conventions

我在我的应用程序中编写了以下代码。（ 办公室工作 ）

```
@Override
public List<Outlet> getAllOutletForTouch() {
    return outletDao.getOutlets();
} 
```

这是我的一位同事编写的代码。

```
@Override
public List<Outlet> getAllOutletsForMobile() {
    List<Outlet> outletList = outletDao.getOutlets();
    return outletList;
} 
```

他创建了一个新变量，分配了值，然后返回了值；而我只是返回了直接调用该方法的值。这样做的惯例是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T05:10:09.660

因此，与第一个选项相比，第二个选项没有显着的性能差异，即使是大规模的，因为一旦引用超出范围，它将被 GC。

但这主要是关于编码风格。IMO，正如@Luiggi 在评论中所说，第一个选项更具可读性，但不允许您在返回时进行调试。如果 return 语句可以抛出您可能想要调试的异常，则需要使用第二个选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T05:01:57.507

在你的情况下，我更喜欢第一个。在第二种情况下，您不必要地创建一个新引用，该引用进入占用一些内存的线程堆栈。所以我会先去。

编辑：

根据评论详细说明我的答案。在堆上创建一个对象，但对该对象的所有引用都转到线程堆栈。

因此，如果多个线程引用同一个对象，那么它们会将自己的引用存储在它们的堆栈中。

编辑：

检查链接[Where is assigned variable reference, in stack or in the heap?](https://stackoverflow.com/questions/873792/where-is-allocated-variable-reference-in-stack-or-in-the-heap) 有关如何存储参考的详细信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T05:27:10.937

我认为第一个（直接返回而不创建变量）更好，因为如果变量没有用，我们应该始终避免创建变量。

对性能没有太大影响，但仍然养成不创建无用变量的习惯。

有人说一旦超出范围就会被GC，但据我了解，GC运行的时间没有固定的时间，你不能强制它运行。所以它会一直留在内存中，直到下次 GC 运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T05:37:47.190

#2 没有性能损失。如果它执行得足够频繁，VM 将负责优化它。

#2 样式是多余且不必要的，但没什么大不了的。

# javascript - 等待直到 ajax 请求完成

> ID：16051853
> 
> 赞同：1
> 
> 时间：2013-04-17T04:59:41.603
> 
> 标签：javascript, jquery, ruby-on-rails, ruby, ajax

页面上有一个链接。我想在用户点击时发送一个 ajax 请求。并且只有在（完成 ajax 请求时）它们才应该被重定向到该链接所指的页面。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:14:49.390

HTML 是这样的：

```
<a id="myAjaxLink" href="http://www.google.com">Click here</a> 
```

JavaSCript 是这样的：

```
$(document).ready(function() {

    $("#myAjaxLink").click(function(event) {
        event.preventDefault();

        $.ajax({
            url: someUrl,
            type: "GET",
            success: function (result) {
                window.location = $("#myAjaxLink").attr("href");
            },
            error: function (xhr) {
                console.log(xhr);
            }
        });
    });
}); 
```

# jquery - jQuery，使用属性选择最近的兄弟姐妹（下一个或上一个）

> ID：16051857
> 
> 赞同：4
> 
> 时间：2013-04-17T05:00:22.130
> 
> 标签：jquery, select

我有一个类似于下面的标记的选择下拉菜单。

```
<select class="myselect" name="myname">
  <option value="0" disabled="disabled">0</option>
  <option value="1" disabled="disabled">1</option>
  <option value="2" disabled="disabled">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
  <option value="6">6</option>
  <option value="7" selected="selected" disabled="disabled">7</option>
</select> 
```

我试图弄清楚如何使用 jQuery 来选择与“选定”元素最接近的“启用”同级。在上面的示例中，我想选择选项 6。我意识到我可以使用 .prev()，但这只会上升。有时用户选择的数字较小，我需要选择 next() 选项。

感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:12:49.243

一个选项是使用`nextAll`or`prevAll`方法，您可以检查所选元素的*长度*，如果存在下一个*未禁用*元素，则选择该元素，否则选择最近的前一个*未禁用* 元素。

```
var $o = $('.myselect option'),
    $s = $o.filter(':selected'),
    $next = $s.nextAll(':not(:disabled)').first();

if ($next.length) $next.foo();
else $s.prevAll(':not(:disabled)').first().bar(); 
```

[http://jsfiddle.net/DsWh6/](http://jsfiddle.net/DsWh6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:05:31.557

您应该能够在事件功能中使用：

```
if( $( this ).val( ) == 7 ){

    $( enabledNode ) = $( this ).parent( ).first( ); // which brings you to val 1

    ... validation here

} 
```

# websphere - 在 IBM Websphere Application 服务器中部署 war 文件

> ID：16051864
> 
> 赞同：0
> 
> 时间：2013-04-17T05:00:42.090
> 
> 标签：websphere, war

我创建了一个 Web 应用程序并将其部署在 IBM Websphere Application 服务器中。该应用程序安装在默认文件夹中，默认名称为“WebApp_ID”。要在浏览器中运行该应用程序，我提供了服务器 url/WebApp_ID。它运行良好。但我想在同一台服务器上安装另一个 Web 应用程序。我无法做到这一点，因为它也安装在同名的同一个文件夹中。

我在更改 webapp 名称时遇到问题。我的应用程序不包含 geronimo-web.xml。有没有办法使用 web.xml 更改它？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:18:20.313

**1）**给你的战争文件一个独特的名字，然后部署。

**2)**您还可以在 web.xml 中提供唯一的 web-app id，如下所示：

```
<web-app id="WebApp_1360725819438" metadata-complete="true" version="2.5" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"> 
```

问候，

# android - 在 Android 的 web 视图中使用后退按钮

> ID：16051870
> 
> 赞同：2
> 
> 时间：2013-04-17T05:01:19.127
> 
> 标签：android, webview, back-button

使用普通的移动浏览器时，当您按下返回按钮时，它会将您带到上一页。当在我的应用程序中使用 WebView 来显示网页并且用户想要返回上一页时，通常如何完成？按下后退按钮会自动将用户带回上一页还是带他们回到上一个活动？我会假设由于后退按钮通常意味着将用户带到上一个活动，它不应该用于返回到上一个网页。如果是这种情况，我的移动网页是否应该包含用户单击的自己的返回链接？

我想我想做的是了解我应该采用的正确行为。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T05:05:58.327

让我们看一些流行的浏览器。目前，在我的设备中，有两个浏览器

1.  铬合金
2.  默认互联网浏览器

在这两种浏览器中，它都会转到上一页。所以这是一种常见的行为。这样做

您可以覆盖`onBackPressed`以转到上一页。

```
@Override
public void onBackPressed(){
            if(mWebView.canGoBack() == true){
                mWebView.goBack();
            }
            else{
                finish();
            }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T05:17:35.957

请记住，大多数安卓设备都带有后退按钮。因此，您不需要活动中的后退按钮即可返回上一个活动。

关于 webview，如果您希望在 webview 中导航以遍历所有以前的页面，那么您可以放置​​一个后退按钮并使用方法实现 webview 的导航`webview.goBack()`。

简而言之，如果您希望您的用户导航到上一页，那么您应该提供 web 视图的功能以返回上一页，并从第一页用户再次单击后退按钮完成活动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T05:06:12.437

您可以使用它覆盖 onkeydown 事件并检查按下的键（在这种情况下是返回键）并检查是否有任何上一页

```
@Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        if(event.getAction() == KeyEvent.ACTION_DOWN){
            switch(keyCode)
            {
            case KeyEvent.KEYCODE_BACK:
                if(yourWebView.canGoBack() == true){
                    yourWebView.goBack();
                }else{
                    finish();
                }
                return true;
            }

        }
        return super.onKeyDown(keyCode, event);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T05:06:18.503

当您单击后退按钮时，您正在单击它以打开 webview 更好的方法是在您的布局中提供一个后退按钮..从而保存​​用户打开的最后一个 url

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T05:08:43.590

WebView 活动中的类似内容：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if(event.getAction() == KeyEvent.ACTION_DOWN){
        switch(keyCode)
        {
        case KeyEvent.KEYCODE_BACK:
            if(yourWebView.canGoBack() == true){
                yourWebView.goBack();
            }else{
                finish();
            }
            return true;
        }

    }
    return super.onKeyDown(keyCode, event);
} 
```

或覆盖 onBackPressed 方法：

```
@Override
public void onBackPressed() {
   if(yourWebView.canGoBack() == true){
      yourWebView.goBack();
   } else {
      finish();
   }
} 
```

# html - 使用画布渲染器（three.js）围绕 y 轴旋转矩形实体而不会出现图像失真

> ID：16051872
> 
> 赞同：3
> 
> 时间：2013-04-17T05:01:24.547
> 
> 标签：html, canvas, three.js

我花了几个小时试图解决这个问题......当渲染非常简单的形状（即复杂度非常低的立方体）并使用 Three.js 的纹理贴图功能时，当你旋转立方体时，图像似乎在旋转时被扭曲，然后你可以看到一条穿过立方体表面的线，表现为扭曲。

[http://screencast.com/t/VpSPRsr1Jkss](http://screencast.com/t/VpSPRsr1Jkss)

我知道这是画布渲染的一个限制 - 但看起来这是一件非常简单的事情 - 旋转一个在一个面上有图像而没有失真的立方体。

我可以采取其他画布库或方法吗？我真的很期待使用 Three.js 为一些徽标和其他元素设置动画 - 但我们不能在徽标或面向客户的登录页面中出现这样的失真。

感谢您的阅读，我愿意在这里提出建议。

我不接受增加面部的复杂性作为解决方案，因为这只会分散整个面部的失真。我真的只想将图像渲染到平坦的表面并能够旋转该对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T15:02:04.353

您看到的失真是因为只有两个三角形构成该平面。一个快速的解决方法是拥有更详细的平面。

如果您使用的是 PlaneGeometry，请增加段数。如果您使用的是 CubeGeometry，请增加平面上所需的段数（3 个中的 2 个）。

要在体面的外观和最佳性能之间找到最佳平衡点需要花点功夫（因为更多的细分市场需要更多的计算）。希望对于简单的场景，您不会有重大延误。

# jquery - 使网格上的本地数据类型完成后，过滤器不起作用

> ID：16051873
> 
> 赞同：0
> 
> 时间：2013-04-17T05:01:28.450
> 
> 标签：jquery, jqgrid, mvcjqgrid

目前我在 jqgrid 中面临一个问题。使用 ajax 调用加载网格后，我将数据类型更改为本地网格完成。在那之后我试图过滤但我得到零记录。任何帮助表示赞赏。

**以下是我的代码： -**

```
$("#orderformtable").jqGrid(
            {
                url : "getOrderFormProductList.htm?VENDORID=" + VENDORID
                        + "&LOCATIONID=" + LOCATIONID,
                mtype : 'GET',
                datatype : "json",
                colNames : [ 'Product', 'Pipeline Qty.', 'A', 'B', 'C',
                        'D', 'Order Qty.' ],
                colModel : [ {
                    name : 'PRODUCT_NAME',
                    index : 'PRODUCT_NAME',
                    width : 80,
                    editable : false,
                    hidden : false,
                    editrules : {
                        required : true
                    },
                    editoptions : {
                        disabled : true,
                        size : "40",
                        maxlength : "70"
                    }

                }, {
                    name : 'PIPELINE_QTY',
                    index : 'PIPELINE_QTY',
                    width : 20,
                    editable : false,
                    editoptions : {
                        size : "7",
                        maxlength : "6"
                    },
                    editrules : {
                        required : true
                    },
                    align : 'center'
                }, {
                    name : 'MAX_QTY',
                    index : 'MAX_QTY',
                    width : 15,
                    editable : true,
                    editoptions : {
                        size : "7",
                        maxlength : "6"
                    },
                    editrules : {
                        required : true
                    },
                    align : 'center'
                }, {
                    name : 'INSTOCK_QTY',
                    index : 'INSTOCK_QTY',
                    width : 20,
                    editable : false,
                    editoptions : {
                        size : "7",
                        maxlength : "6"
                    },
                    editrules : {
                        required : true
                    },
                    align : 'center'
                }, {
                    name : 'VENDOR_PIPELINE',
                    index : 'VENDOR_PIPELINE',
                    width : 20,
                    editable : false,
                    editoptions : {
                        size : "7",
                        maxlength : "6"
                    },
                    editrules : {
                        required : true
                    },
                    align : 'center'
                }, {
                    name : 'REQUIRED_QTY',
                    index : 'REQUIRED_QTY',
                    width : 20,
                    editable : false,
                    editoptions : {
                        size : "7",
                        maxlength : "6"
                    },
                    editrules : {
                        required : true
                    },
                    align : 'center'
                }, {
                    name : 'REORDER_QTY',
                    index : 'REORDER_QTY',
                    width : 20,
                    editable : true,
                    search : false,
                    editoptions : {
                        size : "7",
                        maxlength : "6"
                    },
                    editrules : {
                        required : true
                    },
                    align : 'center'
                } ],
                loadonce : true,
                localReader : {
                    repeatitems : true
                },
                hidegrid : false,
                postData : {},
                rowNum : 200,
                rowList : [ 200, 220, 230 ],
                height : 500,
                autowidth : true,
                rownumbers : true,
                pager : '#orderformpagination',
                sortname : 'PRODUCT_NAME',
                viewrecords : true,
                gridview : true,
                sortorder : "asc",
                caption : "",
                emptyrecords : "Empty records",
                loadonce : false,
                gridComplete : function() {
                    $("#orderformtable").setGridParam( {
                        datatype : 'local',
                        ignoreCase : true
                    });
                },
                loadComplete : function() {

                    var rowid = jQuery("#orderformtable").jqGrid(
                            'getDataIDs');
                    for ( var i = 0; i < rowid.length; i++) {

                        $('#orderformtable').jqGrid('editRow', rowid[i]);
                    }
                }
            }); 
```

**下面是我的 jsonarray 重排表单控制器：-**

```
{
"total": 1,
"rows": [
    {
        "cell": [
            "Ball Pen",
            4,
            100,
            10,
            0,
            90
        ],
        "id": "1220"
    },
    {
        "cell": [
            "BATTERY DURACELL 9V PER PC",
            1,
            50,
            10,
            0,
            40
        ],
        "id": "1101"
    },
    {
        "cell": [
            "Brown Tape 2 inch per pc",
            0,
            30,
            10,
            0,
            20
        ],
        "id": "1108"
    },
    {
        "cell": [
            "CELLO TAPE 1 INCH- PER PC",
            0,
            80,
            10,
            0,
            70
        ],
        "id": "1115"
    },
    {
        "cell": [
            "CUTTER PAPER MEDIUM",
            0,
            25,
            10,
            0,
            15
        ],
        "id": "1122"
    },
    {
        "cell": [
            "Scissor big (per pc)",
            0,
            0,
            0,
            0,
            0
        ],
        "id": "1199"
    }
],
"records": 6,
"page": 1 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T08:16:05.707

我认为您遇到的主要问题是 和 的`loadonce: true`使用`loadonce: false`。定义具有相同属性的对象定义两次通常会被解释为错误，但如果 Web 浏览器确实将属性的值解释为，`loadonce: false`那么您可能会遇到您描述的问题。

`datatype`to `'local'`inside of的设置`gridComplete`非常糟糕。可能你从一些非常古老的代码示例中得到了诀窍。如果你使用`loadonce: true`那么

1.  来自服务器的数据将保存在本地，因此可以在本地搜索/过滤数据。
2.  将`datatype`在首次从服务器加载数据并*在*本地保存数据*后**自动*更改为。`"local"`

 **如果设置`datatype`为`'local'`inside ，`gridComplete`则从**服务器加载的数据不会保存在本地**。所以你不能使用数据的本地过滤。

此外，我建议您通过使用列模板来减少代码。例如，您可以使用`cmTemplate`以下项更改任何属性的默认值`colModel`（请参阅[答案](https://stackoverflow.com/a/6047856/315935)）。您还可以删除许多具有默认值的选项 ( `postData: {}`, `localReader: { repeatitems: true }`, `sortorder : "asc"`, `mtype : 'GET'`, )。`caption : ""`结果，您的代码可能会被重写为以下内容

```
$("#orderformtable").jqGrid({
    url: "getOrderFormProductList.htm",
    postData: {
        VENDORID: function () { return VENDORID; },
        LOCATIONID: function () { return LOCATIONID; }
    },
    datatype: "json",
    colNames: [ 'Product', 'Pipeline Qty.', 'A', 'B', 'C', 'D', 'Order Qty.' ],
    colModel: [
        { name: 'PRODUCT_NAME', width: 80, align: 'left' },
        { name: 'PIPELINE_QTY' },
        { name: 'MAX_QTY', width: 15, template: 'myIntTemplate' },
        { name: 'INSTOCK_QTY' },
        { name: 'VENDOR_PIPELINE'},
        { name: 'REQUIRED_QTY' },
        { name: 'REORDER_QTY', editable: true, search: false }
    ],
    cmTemplate: { width: 20, align: 'center', editrules: { required: true },
        editoptions: { size: "7", maxlength: "6" }
    },
    loadonce: false,
    hidegrid: false,
    rowNum: 200,
    rowList: [ 200, 220, 230 ],
    height: "auto",
    autowidth: true,
    rownumbers: true,
    pager: '#orderformpagination',
    sortname: 'PRODUCT_NAME',
    viewrecords: true,
    gridview: true,
    emptyrecords: "Empty records",
    ignoreCase: true,
    loadComplete: function() {
        var i, $self = $(this), rowids = $self.jqGrid('getDataIDs');
        for (i = 0; i < rowids.length; i++) {
            $self.jqGrid('editRow', rowids[i]);
        }
    }
}); 
```**

# php - 如何向 MSSQL 表中插入超过 10000 行

> ID：16051875
> 
> 赞同：1
> 
> 时间：2013-04-17T05:01:30.833
> 
> 标签：php, sql, sql-server, sql-server-2008

我有一个 PHP 项目，我必须在 SQL 表中插入超过 10,000 行。这些数据从一个表中取出并检查一些简单的条件，并在每个月底插入到第二个表中。

我该怎么做。

我认为需要进一步澄清。我目前使用 PHP cronjob 进行小批量（250 个插入）传输，它工作正常。但我需要这样做是最合适的方法。

什么是最合适的。

1.  我目前使用的带有 PHP 的 Cronjob
2.  导出到文件和 BULK 导入方法
3.  某种存储过程直接传输

或任何其他。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T05:04:04.457

使用[插入](http://msdn.microsoft.com/library/ms174335.aspx)SQL 语句。:^)

> 向 SQL Server 2012 中的表或视图添加一行或多行。有关示例，请参阅[示例](http://msdn.microsoft.com/library/ms174335.aspx#InsertExamples)。

使用 mssql_* 扩展的示例。

```
$server = 'KALLESPC\SQLEXPRESS';
$link = mssql_connect($server, 'sa', 'phpfi');
mssql_query("INSERT INTO STUFF(id, value) VALUES ('".intval($id)."','".intval($value)."')"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T05:05:58.057

由于数据量大，制作500条记录的批次进行处理。

检查这 500 批的情况，到那时，准备另一批 500 并插入第一批并进行处理。

这不会给您的 sql 服务器带来负担。

通过这种方式，我每天处理 40k 条记录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T05:05:25.630

使用[BULK INSERT](http://msdn.microsoft.com/en-us/library/ms188365.aspx) - 它专为满足您的要求而设计，并显着提高了插入速度。

此外，（以防万一您确实没有索引）您可能还需要考虑添加索引 - 一些索引（大多数是主键上的索引）可能会提高插入的性能。

您应该能够插入记录的实际速率将取决于确切的数据、表结构以及 SQL 服务器本身的硬件/配置，所以我真的不能给您任何数字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T05:22:14.003

很简单，你可以使用多个 while 来完成，因为 10000 行并不是巨大的数据！

```
$query1 = mssql_query("select top 10000 * from tblSource");
while ($sourcerow = mssql_fetch_object($query1)){
      mssql_query("insert into tblTarget (field1,field2,fieldn) values ($sourcerow->field1,$sourcerow->field2,$sourcerow->fieldn)");
} 
```

这应该可以正常工作

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-17T08:23:39.740

SQL Server 不会在单个批次中插入超过 1000 条记录。您必须为插入创建单独的批次。在这里，我建议一些对您有帮助的替代方案。

创建一个存储过程。创建两个临时表，一个用于有效数据，另一个用于无效数据。一项一项地检查您的所有规则和验证，并根据将数据插入到这两个表中。

如果数据有效，则插入有效的临时表，否则插入无效的临时表。

现在，接下来使用合并语句，您可以根据您的要求将所有数据插入到源表中。

您可以在表之间传输 N 条记录，所以我希望这对您来说没问题

谢谢。

# angularjs - Angular：多个控制器一次调用服务

> ID：16051876
> 
> 赞同：4
> 
> 时间：2013-04-17T05:01:40.400
> 
> 标签：angularjs, angularjs-scope, angularjs-service, angularjs-controller

这应该是一个相当直接的问题，但我很难过。

我有一项服务可以进行 http 调用，然后对结果进行广泛的后处理。我希望将处理后的结果分配给 $scope.variable 并在几个不同的视图中使用。问题是每个视图都有单独的控制器，但我不希望每个控制器调用服务以从资源中获取相同的数据并为每个控制器进行一次后处理。

超级简化我有这个：

```
myModule.factory ('Data', function ($http, $q) {
  getData: $http.get...
  processData: this.getData().success(function(data){
    ... do a ton of cpu intensive processing ... 
    return processed_data
ctrl1 = function(Data,$scope) {
  $scope.data = Data.processData()
  }
ctrl2 = function(Data,$scope) {
  $scope.data = Data.processData()
etc...
} 
```

显然，我只想设置一次 $scope.data = Data.processData() 并让它填充到所有控制器中。就目前而言，每个控制器都独立调用服务，这会产生不必要的流量和 CPU。

我确定有一些简单的东西，但我无法弄清楚。是否有某种方法可以创建一个“超级”范围，我可以在其中定义所有控制器范围共有的变量？

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T06:55:37.117

我看到你已经注入了[$q 服务](http://docs.angularjs.org/api/ng.$q)。你为什么不在你的数据服务中返回一个承诺（就像`$http.get...`），当 CPU 密集处理完成时解决？你也可以像[angular $resource 服务](http://docs.angularjs.org/api/ngResource.$resource)一样返回一个空对象，一旦处理完成就会被填充（在下面的例子中，我假设 processes_data 是一个数组，但它也适用于一个对象）：

```
myModule.factory ('Data', function ($http, $q) {
  var deferred = $q.defer();
  var futureResult = [];
  //will get populated once processing is done, and is basically a cache

  $http.get('url').success(function(data){
    //... do a ton of cpu intensive processing ...
    for(var i=0; i<processed_data.length; i++){
      futureResult[i] = processed_data[i];
    }
    deferred.resolve(futureResult);
  });

  return {
    getProcessedDataPromise:function(){
     return deferred.promise;
    }
    ,getProcessedData:function(){
      return futureResult;
    }
  }
}); 
```

在控制器中

```
ctrl1 = function(Data,$scope){
  Data.getProcessedDataPromise().then(function(data){
    $scope.data = data;
  });
}
ctrl2 = function(Data,$scope){
  $scope.data = Data.getProcessedData();
} 
```

您还可以查看[这个 plnkr 示例](http://plnkr.co/edit/PBT5KHSNKKDdefk2y5Dv?p=preview)。

# php - 将 php 页面导出为 pdf

> ID：16051877
> 
> 赞同：12
> 
> 时间：2013-04-17T05:01:49.557
> 
> 标签：php, javascript, jquery, pdf-generation

我有一个 php 页面，其中包含表格数据和一些漏斗图。我想将页面导出为带有页眉和页脚的 pdf。

谁能告诉我如何使用 javascript 或 jquery 或任何其他形式导出它？

谢谢你

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-17T05:30:06.730

对于使用 FPDF，您可以从链接下载并了解更多信息，这里是[http://fpdf.org](http://fpdf.org/)

之后，您可以按如下方式集成..

```
<?php

require_once('fpdf.php');

class PDF extends FPDF
{
    function Header()
    {
        $query='your query';
        $row=mysql_fetch_assoc($query); // data from database 

        $this->SetXY(50,60);
        $this->Cell(45,6,'Name  :',1,1,'R');
        $this->SetXY(95,60);
        $this->Cell(80,6,$row['pdf_name'],1,1);

        $this->SetXY(50,66);
        $this->Cell(45,6,'Email Address  :',1,1,'R');
        $this->SetXY(95,66);
        $this->Cell(80,6,$row['pdf_email'],1,1);

        $this->SetXY(50,72);
        $this->Cell(45,6,'Question Paper Selected  :',1,1,'R');
        $this->SetXY(95,72);
        $this->Cell(80,6,$row['subject_sel'],1,1);

        $this->SetXY(50,78);
        $this->Cell(45,6,'Total Correct Answers  :',1,1,'R');
        $this->SetXY(95,78);
        $this->Cell(80,6,$row['right_answered'],1,1);

        $this->SetXY(50,84);
        $this->Cell(45,6,'Percentage  :',1,1,'R');
        $this->SetXY(95,84);
        $this->Cell(80,6,$row['percentage']."%",1,1);

        $this->Ln(20);
    }
    function Footer()
    {
        $this->SetY(-15);
        $this->SetFont('Arial','I',8);
        $this->Cell(0,10,'abc according to you',0,0,'C');
    }
}
$pdf=new PDF('P','mm',array(297,210));
$pdf->Output($name.'.pdf','D');
?> 
```

您可以根据需要进行编辑，它将以表格的形式显示记录并生成为pdf。希望对您有所帮助。

**更新：**

图像

```
$this->Image('image path',80,30,50); 
```

# jquery - 将 div 移到顶部：绝对位置到特定 div

> ID：16051882
> 
> 赞同：0
> 
> 时间：2013-04-17T05:02:20.163
> 
> 标签：jquery, css

这是我在桌面和移动设备上的网站布局。

![在此处输入图像描述](https://i.stack.imgur.com/2ES54.jpg)

一旦有人点击蓝色，我想在页面顶部显示搜索表单`link`。因为搜索表单位于页面底部，我发现很难将`position` `absolute`其置于顶部。是否可以根据它使其绝对定位到包装器`div`，`id`或者我可以使用一些 jquery 使其在顶部弹出。请帮我解决一下这个。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:40:01.983

试试这个....

```
<div class="link">
   <div class="search"></div>
</div> 
```

CSS 代码

```
.link{position:relative;}
.search{position:absolute; top:0px;} 
```

如果你想它底部

```
.search{position:absolute; bottom:0px;} 
```

# c# - 如何在 IEnumerable Session 属性中使用 SingleOrDefault/where

> ID：16051884
> 
> 赞同：-1
> 
> 时间：2013-04-17T05:02:39.480
> 
> 标签：c#, .net, linq, generics, ienumerable

我正在使用 VS2010 Entity Framework 在会话中存储一个值。我使用下面的语法：

```
 private IEnumerable _TransactionItem2
    {
      get
        {
         var msg = HttpContext.Current.Session["SESSION_MESSAGES_NAME"] as IEnumerable;
            if (msg == null)
            {
                msg = new BOMDetailController().GetSearchData(0, 0);
                HttpContext.Current.Session["SESSION_MESSAGES_NAME"] = msg;
            }
            return msg;
        }
      set
        {
            Session[_MenuName + "TransactionItem"] = value;
        }
    } 
```

会话初始化方法如下：

```
 public IEnumerable GetSearchData(int companyID = 0, long bOMID = 0)
        {
            var itemBrand = (from p in this.controllerCMN.Context.CmnItemBrands where p.IsDeleted == false select p).AsEnumerable();
            var itemColor = (from p in this.controllerCMN.Context.CmnItemColors where p.IsDeleted == false select p).AsEnumerable();
            var itemMaster = (from p in this.controllerCMN.Context.CmnItemMasters where p.IsDeleted == false select p).AsEnumerable();
            var itemSpecificationMaster = (from p in this.controllerCMN.Context.CmnItemSpecificationMasters where p.IsDeleted == false select p).AsEnumerable();
            var itemStyleMaster = (from p in this.controllerCMN.Context.CmnItemStyleMasters where p.IsDeleted == false select p).AsEnumerable();
            var uOM = (from p in this.controllerCMN.Context.CmnUOMs where p.IsDeleted == false select p).AsEnumerable();
            var bnOMMaster = (from p in this.Context.PlnBOMMasters where p.IsDeleted == false && p.CompanyID == companyID select p).AsEnumerable();
            var prdPhase = (from p in this.Context.PlnPrdPhases where p.IsDeleted == false && p.ComapnyID == companyID select p).AsEnumerable();
            var prdTask = (from p in this.Context.PlnPrdTasks where p.IsDeleted == false && p.ComapnyID == companyID select p).AsEnumerable();
            var bOMDetail = (from p in this.Context.PlnBOMDetails where p.IsDeleted == false && p.CompanyID == companyID select p).AsEnumerable();

            var query = from p in bOMDetail
                        select new
                        {
                            BOMDetailRecordID = p.BOMDetailRecordID,
                            CustomCode = p.CustomCode,
                            BOMID = p.BOMID,
                            BOMName = (from q in bnOMMaster where q.BOMID == p.BOMID select q.Description).FirstOrDefault(),
                            PhaseID = p.PhaseID,
                            PhaseName = (from q in prdPhase where q.PhaseID == p.PhaseID select q.PhaseName).FirstOrDefault(),
                            ItemID = p.ItemID,
                            ItemName = (from q in itemMaster where q.ItemID == p.ItemID select q.ItemName).FirstOrDefault(),
                            ColorID = p.ColorID,
                            ColorName = (from q in itemColor where q.ColorID == p.ColorID select q.ColorName).FirstOrDefault(),
                            StyleID = p.StyleID,
                            StyleName = (from q in itemStyleMaster where q.StyleID == p.StyleID select q.StyleName).FirstOrDefault(),
                            ItemSpecificationID = p.ItemSpecificationID,
                            ItemSpecificationName = (from q in itemSpecificationMaster where q.ItemSpecificationID == p.ItemSpecificationID select q.Description).FirstOrDefault(),
                            ItemBrandID = p.ItemBrandID,
                            BrandName = (from q in itemBrand where q.ItemBrandID == p.ItemBrandID select q.ItemBrandName).FirstOrDefault(),
                            UOMID = p.UOMID,
                            UOMName = (from q in uOM where q.UOMID == p.UOMID select q.UOMName).FirstOrDefault(),
                            ItemQty = p.ItemQty,
                            UnitPrice = p.UnitPrice,
                            StatusID = p.StatusID,
                        };

            return query.WhereIf(bOMID != 0, p => p.BOMID == bOMID).OrderByDescending(w => w.BOMDetailRecordID);

        } 
```

我想查询上面的属性`TransactionItem2`。

1) 我想计算房产上有多少物品`TransactionItem2`

```
`TransactionItem2.AsQueryable().Count()` 
```

2）我想这样查询：

`var entity = _ TransactionItem2.SingleOrDefault(item => item.BOMDetailRecordID == childRecordID);`

3）我想使用查询

```
var entity = _ TransactionItem2.Where(item => item.BOMDetailRecordID == childRecordID); 
```

我的扩展方法是

```
 public static TSource Single<TSource>(this IEnumerable source)
    {
        return source.Cast<TSource>().Single();
    }

    public static TSource Single<TSource>(this IEnumerable source, Func<TSource, bool> predicate)
    {
        return source.Cast<TSource>().Single(predicate);
    }

    public static TSource SingleOrDefault<TSource>(this IEnumerable source)
    {
       return source.Cast<TSource>().SingleOrDefault();
    }

    public static TSource SingleOrDefault<TSource>(this IEnumerable source, Func<TSource, bool> predicate)
    {
       return source.Cast<TSource>().SingleOrDefault(predicate);
    } 
```

工作语法：

```
var entity = _TransactionItem2.SingleOrDefault(item => item.BOMDetailRecordID == childRecordID); 
```

上面的语法显示了一条错误消息：

> “不能从用法中推断出来。尝试显式指定类型参数”</p>

上述语法不适用于该属性`TransactionItem2`。为什么 1,2,3 不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:29:07.160

`TSource`调用方法时必须明确指定：

```
var entity = _TransactionItem2.SingleOrDefault<EntityClass>(item => item.BOMDetailRecordID == childRecordID); 
```

# javascript - Javascript onclick 显示/隐藏 div 元素

> ID：16051885
> 
> 赞同：0
> 
> 时间：2013-04-17T05:02:47.090
> 
> 标签：javascript, jquery, html, javascript-events, onclick

我是 javascript 新手，我需要一些帮助。我正在开发一个网站，其中有一个名为“添加治疗说明”的按钮。

1.如果我点击“添加治疗说明”，相应的两个`<div>`应该打开，如果`<div>`处于打开状态，“添加治疗说明”按钮应该将文本更改为“隐藏治疗说明”。

```
 <div id="divpopup"><button>Add treatment notes</button></div> 
```

2.如果点击“隐藏治疗笔记”，两个div的数据应该是隐藏的。

```
<td class="ir-shade4" colspan="2">
    <div id=irid1><p><em>If injured,mark location</em></p>
    <img src="{{ STATIC_URL }}images/spotmarker.jpeg"/></div>
 </td>
 <td class="ir-shade3" colspan="2">
  <div id=irid2><p>Actions</p>
   <p><input id="ir-box" type="checkbox"/>01.Allowed to rest and returned to class</p>
   <p><input id="ir-box" type="checkbox"/>02.Contacted parents/guardians</p>
   <p><strong><em>Treatment given,or other notes</em></strong></p>
   <textarea class="textarea" name="description"></textarea>
   <p><input id="ir-box2" type="checkbox"/>No furthur action needed</p>
   </div>
   </td> 
```

编辑：

```
$(document).ready(function () {
  $("#divpopup").css("display", "none");
});

function addtreatment() {
  var hideValue = $("#irid1").val();
  var hideValue = $("#irid2").val();
  var newHideValue = 0;
    if (hideValue == 0) {
      newHideValue = 1;
      }
      else 
      {
        newHideValue = 0;
      }
    if (newHideValue == 0) {
      $("#divpopup").css("display", "none");
    }
    else 
    {
      $("#divpopup").css("display", "block");
    }
    $("#irid1").val(newHideValue);
    $("#irid2").val(newHideValue);

    return false;
  } 
```

请告诉我如何在我的页面中实现这一点。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:07:21.570

你可以用这个

```
$('#divpopup').click(function()
 {
   $('.ir-shade4').toggle();
   $('.ir-shade3').toggle();
} 
```

然后使用`$('#divpopup').text('Hide treatment notes');`

我将把它留给你自己做一个练习，放入一个 if 语句来检查你应该将文本设置为什么

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T05:05:40.730

由于您用 标记了您的问题`jQuery`，您可能想要查看 jQuery 的、[`toggle()`](http://api.jquery.com/toggle/)、[`show()`](http://api.jquery.com/show/)和[`hide()`](http://api.jquery.com/hide/)函数。这可能会让你开始。当您有一些代码要分享时，请随时回来询问更详细的问题。[`text()`](http://api.jquery.com/text/)[`click`](http://api.jquery.com/click/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T05:09:36.660

给按钮一个 id 让我们说

```
<button id="test">Add treatment notes</button> 
```

然后

```
$(document).ready(function(){

$("#test").click(function(){
    $("#irid1").toggle();
    $("#irid2").toggle();
    if ($("#irid1").is(":visible")) {
        $("#test").html('Hide treatment notes');
    } else {
        $("#test").html('Show treatment notes');
    }
});
}); 
```

# linux - Bash 脚本 - 将 Colum 2 除以 Colum 在中间，但在两侧保留 1 和 4

> ID：16051887
> 
> 赞同：0
> 
> 时间：2013-04-17T05:02:59.077
> 
> 标签：linux, bash

我有一个包含 ID、人口、地区和省份的列表，如下所示：

```
1:517000:405212:Newfoundland and Labrador
2:137900:5660:Prince Edward Island
3:751400:72908:New Brunswick
4:938134:55284:Nova Scotia
5:7560592:1542056:Quebec
6:12439755:1076359:Ontario
7:1170300:647797:Manitoba
8:996194:651036:Saskatchewan
9:3183312:661848:Alberta
10:4168123:944735:British Comumbia
11:42800:1346106:Northwest Territories
12:31200:482443:Yukon Territories
13:29300:2093190:Nunavut 
```

我需要显示人口密度（人口/面积）最低和最高的省份的名称。如何将第 1 列除以第 2 列（小数点后 2 位），但在两侧保持文件信息完整（例如 1：**1.28**：纽芬兰和拉布拉多）。在那之后，我想我可以把它泵入`sort -t: -nk2 | head -n 1`并`sort -t: -nrk2 | head -n 1`拉动它们。

给出的推荐命令是 grep。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:25:36.280

由于您似乎可以控制排序和提取，因此这里有一个适用于您的示例 awk 脚本：

```
#!/usr/bin/env awk -f

BEGIN {
    FS=":"
    OFS=":"
    OFMT="%.2f"
}

{
    print $1,$2/$3,$4
} 
```

# php - PHP消息发送脚本不起作用

> ID：16051896
> 
> 赞同：0
> 
> 时间：2013-04-17T05:03:38.973
> 
> 标签：php, mysql

如果满足所有条件并回显“成功”，则以下脚本应该发送电子邮件。这里的问题是它返回“成功”但没有发送电子邮件。我尽力找出问题所在，但由于我是 PHP 新手，所以无法弄清楚。所以我正在寻找任何可能的帮助。任何帮助将不胜感激。先感谢您

```
$sql = "SELECT id, username FROM user WHERE email='$e' AND activated='1' LIMIT 1";
    $query = mysqli_query($db_conx, $sql);
    $numrows = mysqli_num_rows($query);
    if($numrows > 0){
        while($row = mysqli_fetch_array($query, MYSQLI_ASSOC)){
            $id = $row["id"];
            $u = $row["username"];

        $emailcut = substr($e, 0, 4);
        $randNum = rand(10000,99999);
        $tempPass = "$emailcut$randNum";
        $hashTempPass = md5($tempPass);
        $sql = "UPDATE useroptions SET temp_pass='$hashTempPass' WHERE username='$u' LIMIT 1";
        $query = mysqli_query($db_conx, $sql);
        $to = "$e";
        $from = "auto_responder@geniusfree.net";
        $headers ="From: $from\n";
        $headers .= "MIME-Version: 1.0\n";
        $headers .= "Content-type: text/html; charset=iso-8859-1 \n";
        $subject ="GeniusFree Password Reset";
        $msg = '<h2>Hello '.$u.'</h2><p>This is an automated message from GeniusFree. If you did not recently initiate the Forgot Password process, please disregard this email.</p><p>You indicated that you forgot your login password. We can generate a temporary password for you to log in with, then once logged in you can change your password to anything you like.</p><br /><p><a href="http://www.geniusfree.net/passwordreset.php?u='.$u.'&p='.$hashTempPass.'">Click here now to apply the temporary password shown below to your account</a></p><p>If you do not click the link in this email, no changes will be made to your account. In order to set your login password to the temporary password you must click the link above.</p>';
        if(mail($to,$subject,$msg,$headers)) {
            echo "success";
            exit();
        } else {
            echo "email_send_failed";
            exit();
        }} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T06:40:47.507

检查 MX 条目设置。最高优先级为 0。如果您在主机中使用邮件服务器。第一个条目应该是这样的优先级编号 0 ---> mail.yoursite.com。

另一种调试方法是使用电子邮件跟踪路由。您可以在 cpanel 中执行此操作。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T06:57:09.117

首先，您需要配置 php 以从您的服务器发送电子邮件，如果您在本地主机上运行代码，那么您必须配置您的 php.ini 文件以发送电子邮件，如果代码在 Web 托管服务器上运行，则为此联系他们问题，有关配置详细信息，您可以参考[在 php 中使用 xampp 发送邮件](https://stackoverflow.com/questions/16003058/send-mail-using-xampp-in-php/16009408#16009408)

如果您使用的是另一个本地服务器，例如 wamp，那么您必须在您的服务器上单独（下载）安装 sendmail 实用程序。

希望这对你有用

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-17T05:14:25.423

你在本地主机上运行它吗？如果是这样，它可能在那里不起作用，请在虚拟主机上测试它并让我知道结果。

# linux - 源代码洞察中的汇编代码支持

> ID：16051897
> 
> 赞同：2
> 
> 时间：2013-04-17T05:03:41.887
> 
> 标签：linux, assembly, linux-kernel, source-insight, directory-browsing

有没有人尝试在源代码洞察中浏览汇编语言文件（filename.s）？

我刚刚将整个 Linux 内核项目添加到源代码洞察中，但它不支持任何汇编文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-21T11:22:42.393

当您在 Sourceinsight 中创建项目时，它会添加它知道的所有类型的文件（如 *.c、*.h、*.cpp 等）。它还添加了程序集文件，但仅添加了“.asm”和“.inc”文件。要将所有 *.s 文件作为程序集文件包含在项目中，您需要告诉 Sourceinsight 将“.s”文件视为程序集文件。

这可以通过“文档选项”->“文档类型”-> 选择 x86 ASM 源文件，然后添加 * s 内的文件过滤器框以及 *.asm 和 *.inc。完成此操作后，现在重新添加项目根目录中的所有文件（Project->add and remove files），您将在 Sourceinsight 中获得 *.s 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:12:42.840

在设置选项卡中，您应该找到它。有一个选项可以添加对所有文件类型的支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T05:59:26.670

在文件字段 -> 加载文件 -> 浏览 [给出路径]-> 文件类型 [make it as all]
然后你会发现你的“.s”文件打开它，
你可以像普通文件一样使用它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-02T14:34:55.220

无条件包含目录（文件夹）中存在的所有文件的方法：

1.  创建一个新的文档类型：转到`Options ==> Document Options ==> Document Type`。按“添加类型”按钮。创建一些名为`MY_Unconditional`.
    将此类型的“文件过滤器”设置为`*, *.*`. （`*`通配符表示所有文件。`*.*`表示所有文件所有类型的扩展名。）关闭对话框。

2.  将所有文件添加到项目：转到`Project ==> Add and Remove Project Files`

3.  选择你的目录

4.  取消选中“仅显示已知文档类型”框。现在，它将显示目录中的所有文件。

5.  现在，按“全部添加”按钮。如果需要，也可以按“添加树”按钮。

# java - 如何从 Liferay 中的另一个 portlet 调用一个 portlet？

> ID：16051898
> 
> 赞同：4
> 
> 时间：2013-04-17T05:03:44.407
> 
> 标签：java, jsp, liferay-6, portlet

我创建了 3 个 portlet（证明 portlet、目录 portlet、轮询 portlet），并且我想从**目录portlet 调用****证明**portlet。这个怎么做？请帮助我。

 **我在目录 portlet 的*view.jsp文件中编写了以下代码：*

```
<%@ taglib uri="http://liferay.com/tld/portlet" prefix="liferay-portlet" %>

<liferay-portlet:renderURL var="linkURL" portletName="testi" windowState="maximized" />
<br>
<a href="<%= linkURL%>">Testimonial</a> 
```

我可以重定向到另一个页面，但我收到了类似的错误

> 此 Portlet 已取消部署。请重新部署它或从页面中删除它。

我应该在*liferay-portlet.xml*中进行更改吗？请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:15:34.697

portletName 属性值，您指定的似乎不正确。这就是原因，您正在收到该消息。我刚刚检查了将不正确的名称“test”作为 portletName，而没有任何名称为 test 的 portlet。

如果`<portlet-name>test</portlet-name>`是 liferay-portlet.xml 中的条目，则将 portletName 指定为**test_WAR_testportlet**，它将起作用。

如果其他 portlet 是 Liferay 的 Out of Box portlet，您可以使用 PortletKeys 类。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-16T05:17:50.087

我有同样的要求。但我对 Liferay 很陌生……所以我对 Liferay API 的了解不多。

所以我使用 web 服务来获取 portlet 数据到另一个 portlet。它真的很有趣也很容易..

您可以从中找到更多帮助。

[泽西岛 RestFul 网络服务](http://www.liferay.com/web/pradip.bhatt/blog/-/blogs/integrate-jersey-restful-with-portlet-project?_33_redirect=http://www.liferay.com/web/pradip.bhatt/blog?p_p_id=33&p_p_lifecycle=0&p_p_state=normal&p_p_mode=view&p_p_col_id=column-2&p_p_col_count=1)

我做到了，一切都很好。

谢谢ssss**

# objective-c - 动态切换容器视图

> ID：16051899
> 
> 赞同：23
> 
> 时间：2013-04-17T05:03:50.980
> 
> 标签：objective-c

我正在使用情节提要容器视图。所以我有一个包含容器视图的视图控制器。我在情节提要中有第二个较小的视图，它通过嵌入转场嵌入到该容器中。到现在为止还挺好。

现在我希望能够在用户点击按钮时动态切换该容器视图的内容。该按钮将位于较大的主视图上。我制作了另一个尺寸相同的视图控制器，并为其赋予了不同的故事板 ID。

但是，我无法弄清楚如何对开关进行编码。我只能为该容器创建一个嵌入 segue。

感激地收到任何帮助。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-04-17T05:13:15.137

您需要使用自定义容器视图控制器 api 来进行控制器的切换。以下代码显示了一种方法。在这个项目中，我在主视图控制器（带有容器视图的那个）中有一个分段控件，可以在两个控制器之间切换。initialVC 是嵌入在 IB 中的控制器，而替代VC 是我要切换到的控制器。属性 container 是容器视图的 IBOutlet。

```
- (void)viewDidLoad {
    [super viewDidLoad];
    self.initialVC = self.childViewControllers.lastObject;
    self.substituteVC = [self.storyboard instantiateViewControllerWithIdentifier:@"Substitute"];
    self.currentVC = self.initialVC;
}

-(IBAction)switchControllers:(UISegmentedControl *)sender {

    switch (sender.selectedSegmentIndex) {
        case 0:
            if (self.currentVC == self.substituteVC) {
                [self addChildViewController:self.initialVC];
                self.initialVC.view.frame = self.container.bounds;
                [self moveToNewController:self.initialVC];
            }
            break;
        case 1:
            if (self.currentVC == self.initialVC) {
                [self addChildViewController:self.substituteVC];
                self.substituteVC.view.frame = self.container.bounds;
                [self moveToNewController:self.substituteVC];
            }
            break;
        default:
            break;
    }
}

-(void)moveToNewController:(UIViewController *) newController {
    [self.currentVC willMoveToParentViewController:nil];
    [self transitionFromViewController:self.currentVC toViewController:newController duration:.6 options:UIViewAnimationOptionTransitionFlipFromLeft animations:nil
                            completion:^(BOOL finished) {
                                [self.currentVC removeFromParentViewController];
                                [newController didMoveToParentViewController:self];
                                self.currentVC = newController;
                            }];
} 
```

**编辑后：**

如果你想去没有动画的新控制器，你可以这样做（这代替了我在案例 1 下的代码）。

```
[self addChildViewController:self.substituteVC];
[self.substituteVC didMoveToParentViewController:self];
self.substituteVC.view.frame = self.container.bounds;
[self.container addSubview:self.substituteVC.view];
[self.currentVC removeFromParentViewController]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-16T02:30:00.167

[rdelmar 的答案](https://stackoverflow.com/a/16052018/97464)转换为 Swift 语法

```
 override func viewDidLoad() {
        super.viewDidLoad()

        self.initialVC = self.childViewControllers.last
        self.substituteVC = self.storyboard!.instantiateViewControllerWithIdentifier("Substitute")
        self.currentVC = self.initialVC;

}
    @IBAction func switchControllers(sender: UISegmentedControl) {
        switch sender.selectedSegmentIndex{
            case 0:
                if (self.currentVC == self.substituteVC) {
                    self.addChildViewController(self.initialVC)
                    //self.initialVC.view.frame = self.containerView.bounds
                    moveToNewController(self.initialVC)
                }
            case 1:
                if (self.currentVC == self.initialVC) {
                    self.addChildViewController(self.substituteVC)
                    //self.substituteVC.view.frame = self.containerView.bounds
                    moveToNewController(self.substituteVC)
                }
            default:
            break;
        }
    }

    func moveToNewController(newController : UIViewController){
        self.currentVC.willMoveToParentViewController(nil)
        self.transitionFromViewController(
            self.currentVC!,
            toViewController: newController,
            duration: 0.2,
            options: UIViewAnimationOptions.TransitionCrossDissolve,
            animations: nil,
            completion: { finished in
                self.currentVC.removeFromParentViewController()
                newController.didMoveToParentViewController(self)
                self.currentVC = newController
        })

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-16T23:08:25.810

如果您处理超过 2 个子视图控制器，最好将它们存储在数组中。此外，每次将新子视图添加到容器视图时，都需要应用约束。这是接受答案的修改版本（使用 Swift 2 语法）：

```
import UIKit

class FooBarViewController: UIViewController
{
    // MARK: - IBOutlets

    @IBOutlet weak var containerView: UIView!

    // MARK: - Properties

    var vcs = [UIViewController]()
    var currentVC: UIViewController!

    // MARK: - ViewController Lifecycle

    override func viewDidLoad()
    {
        super.viewDidLoad()

        vcs.append(childViewControllers.last!)
        vcs.append(storyboard!.instantiateViewControllerWithIdentifier("FooViewControler"))       
        vcs.append(storyboard!.instantiateViewControllerWithIdentifier("BarViewController"))
        currentVC = vcs[0]

        for vc in vcs {
            vc.view.frame = containerView.bounds
        }
    }

    // MARK: - Methods

    func switchToViewController(targetVC: UIViewController)
    {
        addChildViewController(targetVC)
        currentVC.willMoveToParentViewController(nil)

        transitionFromViewController(
            currentVC,
            toViewController: targetVC,
            duration: 0.0, // 0.3
            options: .TransitionNone, // .TransitionCrossDissolve,
            animations: nil,
            completion: { finished in
                self.currentVC.removeFromParentViewController()
                targetVC.didMoveToParentViewController(self)
                self.currentVC = targetVC
                self.applyConstraints()
        })
    }

    func applyConstraints()
    {
        let viewsDict = ["newSubview": currentVC.view]

        currentVC.view.translatesAutoresizingMaskIntoConstraints = false

        containerView.addConstraints(
            NSLayoutConstraint.constraintsWithVisualFormat("H:|[newSubview]|",
                options: NSLayoutFormatOptions(rawValue: 0),
                metrics: nil,
                views: viewsDict))

        containerView.addConstraints(
            NSLayoutConstraint.constraintsWithVisualFormat("V:|[newSubview]|",
                options: NSLayoutFormatOptions(rawValue: 0),
                metrics: nil, views:
                viewsDict))
    }

    // MARK: - IBActions

    @IBAction func switchControllers(sender: UISegmentedControl)
    {
        let i = sender.selectedSegmentIndex

        if currentVC != vcs[i] {
            self.addChildViewController(vcs[i])
            switchToViewController(vcs[i])
        }
    }
} 
```

# jsp - 如何在中使用相同的对象名称

> ID：16051900
> 
> 赞同：0
> 
> 时间：2013-04-17T05:03:53.647
> 
> 标签：jsp, servlets, jsp-tags

编译 JSP 时出现重复变量错误。请帮助我。这里属性的范围（会话和请求）不同，那么为什么我不能使用它？它期望 id 必须不同，但在不同的范围内，为什么它期望？

```
HttpSession hs = request.getSession();
hs.setAttribute("GrandParents",new GrandParents());

request.setAttribute("GrandParents",new GrandParents());

 <jsp:useBean id="GrandParents" type="test.bean.GrandParents" class="test.bean.GrandParents" scope="request"/>
     Name in JSP Request tag is: <jsp:getProperty name="GrandParents" property="name" />

<jsp:useBean  id ="GrandParents" type="test.bean.GrandParents" class="test.bean.GrandParents" scope="session"/>
 Name in JSP Request tag is: <jsp:getProperty name="GrandParentss" property="name" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T07:02:54.297

`id`用于指定用于引用 bean 的变量的名称。所以上面的代码等价于

```
GrandParents GrandParents = (GrandParents) request.getAttribute("GrandParents");
GrandParents GrandParents = (GrandParents) session.getAttribute("GrandParents"); 
```

这是无效的，因为它定义了两个同名的变量。

jsp:useBean 无论如何都不应该使用多年。学习 JSP EL 和 JSTL，简单做

```
Name in JSP Request is: ${requestScope.GrandParents.name}
Name in JSP Session is: ${sessionScope.GrandParents.name} 
```

此外，约定以与 Java 局部变量相同的方式命名属性：以小写字母开头。

# c# - 使用 Lambda 表达式在实体框架中的两个列表中查找匹配项

> ID：16051901
> 
> 赞同：1
> 
> 时间：2013-04-17T05:03:55.653
> 
> 标签：c#, entity-framework-5

我正在尝试建立一个过滤系统。假设你有这些模型。

```
public class FilterVM
{
    public string ContentRating { get; set; }
    public List<FilterChars> FilterChars { get; set; }
    public List<FilterCats> FilterCats { get; set; }
    public List<FilterTags> FilterTags { get; set; }
}
public class FilterChars
{
    public int CharID { get; set; }
    public int CharVal { get; set; }
}

public class Book
{
    public int BookID { get; set; }
    public ICollection<BookCharacteristic> BookCharacteristic { get; set; }
}
public class BookCharacteristic
{
    public int ID { get; set; }
    public int BookID { get; set; }
    public int CharacteristicID { get; set; }
    public Book Book { get; set; }
    public int Value { get; set; }
    public Characteristic Characteristic { get; set; }
} 
```

因此，一个表单被发布，并且有`FilterVM`一个列表，`FilterChars`现在我需要找到具有特征 ( `CharID`) 并且值大于提交值的书籍。

这是我正在尝试的，但我无法找出编写查询的正确方法。

```
 List<FilterChars> fc = new List<FilterChars>();
        foreach (var filter in f.FilterChars.Where(x => x.CharVal > 0)) {
            fc.Add(filter);
        }
 var books = db.Books
      .Where(t => fc.Select(y => y.CharID)
      .Contains(t.BookCharacteristic
            .Any(u => u.CharacteristicID)
      )
      && //if there's a match, use the matched BookCharacteristic and Value?? 
         //not sure how to do that
 ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T06:14:16.747

```
 public class BookCharacteristicEqualityComparer : IEqualityComparer<BookCharacteristic>
    {
        public bool Equals(BookCharacteristic x, BookCharacteristic y)
        {
            return x.CharacteristicID == y.CharacteristicID && x.Value == y.Value;
        }

        public int GetHashCode(BookCharacteristic obj)
        {
            return obj.CharacteristicID * obj.Value;
        }
    } 
```

这是为了将 BookCharacteristics 与 id 和 value 进行比较

```
 var books = db.Books
        .Where((book) =>
        {
            foreach (var filterChar in fc)
            {
                if (!book.BookCharacteristic.Contains(new BookCharacteristic() {CharacteristicID = filterChar.CharID, Value = filterChar.CharVal},
                                                        new BookCharacteristicEqualityComparer()))
                    return false;
            }

            return true;
        }); 
```

从过滤器中找到包含所有特征和值的所有书籍

希望有帮助:)

编辑：这是我的代码，编译并运行良好（我没有结果，因为我没有数据，但没有错误）

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        var fc = new List<FilterChars>();
        var dbBooks = new List<Book>();

        var books = dbBooks
        .Where((book) =>
        {
        foreach (var filterChar in fc)
        {
            if (!book.BookCharacteristic.Contains(new BookCharacteristic() { CharacteristicID = filterChar.CharID, Value = filterChar.CharVal },
                                                    new BookCharacteristicEqualityComparer()))
                return false;
        }

        return true;
        });
    }

}

public class FilterVM
{
    public string ContentRating { get; set; }
    public List<FilterChars> FilterChars { get; set; }
}
public class FilterChars
{
    public int CharID { get; set; }
    public int CharVal { get; set; }
}

public class Book
{
    public int BookID { get; set; }
    public ICollection<BookCharacteristic> BookCharacteristic { get; set; }
}
public class BookCharacteristic
{
    public int ID { get; set; }
    public int BookID { get; set; }
    public int CharacteristicID { get; set; }
    public Book Book { get; set; }
    public int Value { get; set; }
}

public class BookCharacteristicEqualityComparer : IEqualityComparer<BookCharacteristic>
{
    public bool Equals(BookCharacteristic x, BookCharacteristic y)
    {
        return x.CharacteristicID == y.CharacteristicID && x.Value == y.Value;
    }

    public int GetHashCode(BookCharacteristic obj)
    {
        return obj.CharacteristicID * obj.Value;
    }
} 
```

# opencv - OpenCV：构建一个简单的 3d 模型

> ID：16051915
> 
> 赞同：1
> 
> 时间：2013-04-17T05:05:04.097
> 
> 标签：opencv, 3d

我决定使用 OpenCV 通过使用一系列 2D 图像来构建 3d 场景。我找到了 OpenCV 附带的示例代码 [ build3dmodel.cpp [Here](https://code.ros.org/trac/opencv/browser/trunk/opencv/samples/cpp/build3dmodel.cpp?rev=3220) ]。

我只想运行一次，看看会产生什么样的结果。我对 OpenCV 的了解很少，我不想理解整个代码，我只想知道如何给这个程序（图像集）输入以查看输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-17T10:33:41.443

此代码示例的 line 命令需要以下参数：

> build3dmodel -i intrinsics_filename.yml [-d 检测器] [-de descriptor_extractor] -m model_name.yml

第一个文件是您在校准过程后获得的相机矩阵（有一个特定的示例）。检测器和描述符检测器必须与有效的 FeatureDetector 和 DescriptorExtractor 名称匹配。模型名称有点混乱，它看起来像是将保存数据的 yml 文件名的一部分。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-17T05:20:35.933

首先看一些教程，如[OpenCv 简介](http://www.cs.iit.edu/~agam/cs512/lect-notes/opencv-intro/opencv-intro.html)或[OpenCV 教程](http://dasl.mem.drexel.edu/~noahKuntz/openCVTut1.html)。此外，请参阅[OpenCv 的输入和输出](http://www.neuroforge.co.uk/index.php/input-and-output-with-open-cv)。

# android - 如何在 facebook sdk 3 Android 中签到一个地方

> ID：16051918
> 
> 赞同：0
> 
> 时间：2013-04-17T05:05:20.743
> 
> 标签：android, facebook, facebook-graph-api, android-4.2-jelly-bean, facebook-checkins

我想使用 Facebook sdk 3 签到一个地方。它应该张贴在墙上作为签到。我有这个地方 id。有没有人知道怎么做和任何代码>>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:08:12.253

```
Bundle data = new Bundle();
data.putString("access_token", "YOUR ACCESS TOKEN");
data.putString("place", "your_place_id");  
data.putString("message","Your Text here");
JSONObject coordinates = new JSONObject();
coordinates.put("latitude", "LATITUDE");
coordinates.put("longitude", "LONGITUDE");
data.putString("coordinates",coordinates.toString());
data.putString("tags", "user_id");
String response = faceBook.request("me/checkins", data, "POST"); 
```

# android - Gingerbread vs ICS 及更高版本上的 Tabwidget 分隔符

> ID：16051920
> 
> 赞同：4
> 
> 时间：2013-04-17T05:05:30.593
> 
> 标签：android, tabwidget

我使用 TabWidget 创建了一个带有片段的选项卡，每个选项卡都有自定义布局。除了一件事之外，一切似乎都正常工作并且看起来很好。在 ICS 及更高版本上，它如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/y8xug.png)

但在 Gingerbread 上，它看起来像下面这样：

![在此处输入图像描述](https://i.stack.imgur.com/0zstT.png)

如您所见，姜饼中缺少分隔线。

所以我有两个问题。首先，无论如何我可以让分隔线出现在姜饼上吗？我已经尝试过有关 stackoverflow 的各种建议，但他们只是不想出现。

其次，是否有自定义分隔线的外观？我试过使用：

```
setDividerDrawable() 
```

使用适用于 ICS 的图像，但**我在 Gingerbread 中得到一个空指针异常。**
（更新：关于加粗的问题，我刚刚发现了一些非常烦人的东西。似乎 Gingerbread 和 ICS+ 处理分隔符的方式不同。我在 TabWidget.getChildAt() 调用中遇到空指针异常。设置分隔符时，在Gingerbread 分隔线被认为是它包含的 Tabwidget 的子视图，但在 ICS+ 中它不是（或被忽略）。因此，我用于 getChildAt 的索引在 Gingerbread 中是完全错误的，因为 tabwidget 看到 5孩子（3 个标签和 2 个分隔符），但在 ICS 中它只看到 3 个（只有 3 个标签））

我也尝试设置分隔线的颜色，但它们似乎根本不起作用。

以下是选项卡的设置方式：

```
/**
 * Setup the tab host.
 */
private void initialiseTabHost(Bundle args) {
    this.tabHost = (TabHost) findViewById(android.R.id.tabhost);
    this.tabHost.setup();
    TabInfo tabInfo = null;
    addTab( this,
            this.tabHost,
            this.tabHost.newTabSpec(TAB_DASHBOARD).setIndicator(LayoutInflater.from(getApplicationContext())
                    .inflate(R.layout.tabview_dashboard, null)),
            (tabInfo = new TabInfo(TAB_DASHBOARD, MonitoringTab.class.getName(), args)));
    this.mapTabInfo.put(tabInfo.tag, tabInfo);
    //create alert list and alert details fragments, add alert list to the tab bar
    tabInfo = new TabInfo(TAB_ALERT_DETAILS, AlertDetailTab.class.getName(), args);
    this.mapTabInfo.put(tabInfo.tag, tabInfo);
    tabInfo = new TabInfo(TAB_ALERTS, AlertListTab.class.getName(), args);
    this.mapTabInfo.put(tabInfo.tag, tabInfo);
    addTab( this,
            this.tabHost,
            this.tabHost.newTabSpec(TAB_ALERT_SHOWING).setIndicator(LayoutInflater.from(getApplicationContext())
                    .inflate(R.layout.tabview_alerts, null)),
            tabInfo);
    this.mapTabInfo.put(TAB_ALERT_SHOWING, tabInfo);

    addTab( this,
            this.tabHost,
            this.tabHost.newTabSpec(TAB_ERRORQUEUE).setIndicator(LayoutInflater.from(getApplicationContext())
                    .inflate(R.layout.tabview_errorqueue, null)),
            (tabInfo = new TabInfo(TAB_ERRORQUEUE, ErrorMessagesTab.class.getName(), args)));
    this.mapTabInfo.put(tabInfo.tag, tabInfo);
    // Default to first tab
    onTabChanged(TAB_DASHBOARD);
    this.tabHost.setOnTabChangedListener(this);
} 
```

# c# - 通过 ActionMailer 异步发送电子邮件

> ID：16051922
> 
> 赞同：1
> 
> 时间：2013-04-17T05:05:32.587
> 
> 标签：c#, asp.net, asp.net-mvc-3, asynchronous, actionmailer

我正在尝试通过 ActionMailer for MVC3/MVC4 for C# ASP.NET 异步发送一封电子邮件。

但是我遇到了两个问题：

1.  如果我尝试使用私有函数使用 Task.Run 或 Task.Start 方法，则 HttpContext 变为空，并且电子邮件将不会发送。如果我使用内置的异步交付方法，情况也是如此。

2.  如果我尝试将 async/await 放在电子邮件发送功能上，那将不起作用，因为 return 方法是无效的，并且我被告知您不能在 void 功能上等待。

这是我在这两种情况下使用的代码（在这两种情况下，假设 e 是一个模型对象）：

场景一：

```
Action mailAction = new Action(() => { OnSentEmail(e); });
Task mailTask = new Task(mailAction);
mailTask.Start();

private void OnSentEmail(Model e)
{
    new MailController().SendMail(e).Deliver();
    //HttpContext is null here, so cannot send mail
}

OR

new MailController().SendMail(e).DeliverAsync(); 
```

场景二：

```
await Task.Run(async() => await new MailController().SendMail(e).Deliver()); 
```

我对异步方法还不是很好，但这似乎是我能想到的最好的方法。我不能使用常规的 SmtpClient，因为需要发送的电子邮件是丰富的 HTML 格式，所以这就是我选择 ActionMailer 的原因，这样我就可以发送电子邮件并设置它们的样式，就好像它们是视图一样。

我需要的是能够异步发送电子邮件，或者通过强制输入 HttpContext（我不知道 MailerBase 使用 HttpContext 中的哪些信息来发送电子邮件），或者能够异步/等待它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T00:58:30.317

我最终想出的解决方案是创建一个控制器方法来发送电子邮件，然后在我原来的控制器方法中，向该控制器方法发出 Web 请求，而不考虑响应。在该方法中，模型的 id 被发送，以在电子邮件功能中从数据库中检索正确的模型。这保留了 HttpContext。

```
string url = baseUrl + "/api/Entry/SendEmail?emailId=" + emailId;
WebRequest req = WebRequest.Create(url);
req.Method = "GET";
req.BeginGetResponse(null, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-23T06:44:10.460

`HttpContext`是生成所必需的，`EmailResult` *即控制器`SendMail`方法*的返回值。

`Deliver()`方法可以在单独的线程中调用。

```
var verificationEmail = new MailController().SendMail(email, new MailModel());
Task.Run(() => verificationEmail.Deliver()); 
```

# ruby-on-rails - Tomcat 5.5 Filter 执行抛出异常，JRuby，Rails 3.2，warbler

> ID：16051929
> 
> 赞同：0
> 
> 时间：2013-04-17T05:05:53.877
> 
> 标签：ruby-on-rails, tomcat, ruby-on-rails-3.2, jruby, warbler

请帮忙。我需要将 Rails 3.2 部署到 5.5 旧版 Tomcat。不幸的是，我无法将该版本升级到 6。Java 版本为 1.6.0_43-b01。该应用程序运行良好，与 webrick 和我自己的 tomcat 一起运行（这是 6，我不知道他们使用 5）*啊*

这是我得到的例外。由于我是 Ruby 和 Java 新手，有什么想法可以解决这个问题吗？

```
HTTP Status 500 -

type Exception report

message

description The server encountered an internal error () that prevented it from fulfilling     this request.

exception

javax.servlet.ServletException: Filter execution threw an exception
root cause

java.lang.NoSuchMethodError: javax.servlet.ServletContext.getContextPath()Ljava/lang/String;
org.jruby.rack.servlet.DefaultServletRackContext.getContextPath(DefaultServletRackCont ext.java:75)
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
java.lang.reflect.Method.invoke(Method.java:597)
org.jruby.javasupport.JavaMethod.invokeDirectWithExceptionHandling(JavaMethod.java:440)
org.jruby.javasupport.JavaMethod.invokeDirect(JavaMethod.java:304)
org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:52)
org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:306)
org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:136)
org.jruby.ast.CallNoArgNode.interpret(CallNoArgNode.java:64)
org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
org.jruby.ast.LocalAsgnNode.interpret(LocalAsgnNode.java:123)
org.jruby.ast.NewlineNode.interpret(NewlineNode.java:105)
org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:139)
org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:172)
org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:306)
org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:136)
org.jruby.ast.VCallNode.interpret(VCallNode.java:88)
org.jruby.ast.NewlineNode.interpret(NewlineNode.java:105)
org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:139)
org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:172)
org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:306)
org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:136)
org.jruby.ast.CallNoArgNode.interpret(CallNoArgNode.java:64)
org.jruby.ast.NewlineNode.interpret(NewlineNode.java:105)
org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
org.jruby.ast.RootNode.interpret(RootNode.java:129)
org.jruby.evaluator.ASTInterpreter.INTERPRET_ROOT(ASTInterpreter.java:120)
org.jruby.Ruby.runInterpreter(Ruby.java:842)
org.jruby.Ruby.loadFile(Ruby.java:2659)
org.jruby.runtime.load.ExternalScript.load(ExternalScript.java:66)
org.jruby.runtime.load.LoadService.load(LoadService.java:351)
org.jruby.RubyKernel.loadCommon(RubyKernel.java:1054)
org.jruby.RubyKernel.load19(RubyKernel.java:1046)
org.jruby.RubyKernel$INVOKER$s$0$1$load19.call(RubyKernel$INVOKER$s$0$1$load19.gen)
org.jruby.internal.runtime.methods.DynamicMethod.call(DynamicMethod.java:209)
org.jruby.internal.runtime.methods.DynamicMethod.call(DynamicMethod.java:205)
org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:326)
org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:170)
org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
org.jruby.ast.NewlineNode.interpret(NewlineNode.java:105)
org.jruby.ast.RootNode.interpret(RootNode.java:129)
org.jruby.evaluator.ASTInterpreter.INTERPRET_ROOT(ASTInterpreter.java:120)
org.jruby.Ruby.evalScriptlet(Ruby.java:427)
org.jruby.Ruby.evalScriptlet(Ruby.java:404)
org.jruby.rack.rails.RailsRackApplicationFactory.createApplicationObject(RailsRackApplicationFactory.java:21)
org.jruby.rack.DefaultRackApplicationFactory$1.create(DefaultRackApplicationFactory.java:98)
org.jruby.rack.DefaultRackApplicationFactory$RackApplicationImpl.init(DefaultRackApplicationFactory.java:420)
org.jruby.rack.DefaultRackApplicationFactory.getApplication(DefaultRackApplicationFactory.java:111)
org.jruby.rack.PoolingRackApplicationFactory.createApplication(PoolingRackApplicationFactory.java:340)
org.jruby.rack.PoolingRackApplicationFactory.getApplicationImpl(PoolingRackApplicationFactory.java:180)
org.jruby.rack.RackApplicationFactoryDecorator.getApplication(RackApplicationFactoryDecorator.java:131)
org.jruby.rack.DefaultRackDispatcher.getApplication(DefaultRackDispatcher.java:37)
org.jruby.rack.AbstractRackDispatcher.process(AbstractRackDispatcher.java:32)
org.jruby.rack.AbstractFilter.doFilter(AbstractFilter.java:66) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T09:53:19.993

根据Nick Sieger 的[回复](https://stackoverflow.com/a/3881717/289466)，您需要将 jruby-rack 降级到 0.9.6（或更早版本）才能与 Tomcat 5.5 一起运行。

# ios - 与 ARC 异步块中的 EXC_BAD_ACCESS

> ID：16051948
> 
> 赞同：-3
> 
> 时间：2013-04-17T05:07:34.470
> 
> 标签：ios, objective-c, objective-c-blocks

嗨，当我尝试获取全局变量的值或设置值时，我遇到了问题。它在应用程序生命周期方法中的代码，`applicationDidEnterBackground`当我需要实时知道调用状态时，这对我有用，但有时会生成 EXC_BAD_ACCESS

这是变量声明`@property(nonatomic, copy) NSNumber *calling;`，在我的 .h 文件中。

这是我的 .m 实现文件的代码：

```
__unsafe_unretained typeof(self) weakSelf = self;

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

    @autoreleasepool
    {
        while (weakSelf.calling.intValue == 1)
        {
            callCenter.callEventHandler = ^(CTCall* call)
            {
                if([call.callState isEqualToString:CTCallStateDisconnected])
                {
                   weakSelf.calling = [[NSNumber numberWithInt:0] copy];//Error EXC_BAD_ACCESS

                }

            };
        }
    }
}); 
```

但有时会产生错误，有时不会。任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T19:00:35.780

Stop using this `weakSelf`. It is not necessary. `self` does not retain this block. There is no retain cycle.

When you say that `__weak` "does not work", it is a sign that `self` has already been deallocated by the time the block runs, so the weak reference has been set to `nil`, thus messages to it do nothing. This is also why `__unsafe_unretained` crashes -- `self` has already been deallocated; without `__weak` to set it to `nil`, it is a dangling pointer.

# css - 使用 css 将背景图像添加到列表菜单

> ID：16051950
> 
> 赞同：0
> 
> 时间：2013-04-17T05:07:39.507
> 
> 标签：css

我一直在为 tafe 做一个网站，并且我已经尝试了不同的方法来做到这一点，但到目前为止它们都没有奏效。我正在尝试使用 div id 将按钮图像添加到列表菜单，但它似乎不起作用。[这个演示页面](http://www.156.onl.checit.info/)是我的页面的在线版本，图像菜单假设在左侧，上面有文字。

我正在尝试将图像作为背景图像放入无序列表中，但它似乎不起作用。我正在尝试将它放在 css 的这一部分中

```
#navcontainer ul {
    padding: 0px;
    margin-left: 0px;
    list-style-type: none;
    width: 200px;
    display: block;
    line-height: 34px;
    background-image: url(images/pg_menu_bg.png);
} 
```

这是我的 html 和我的 css：

```
<body>
<div id="wrapper">
<div id="header"></div>
<div id="navigation"><ul><li><a href="JavaScript:void(0);">HOME</a></li><li><a href="JavaScript:void(0);">NEWS</a></li>
<li>
<a href="JavaScript:void(0);">CONTACT</a></li><li><a href="JavaScript:void(0);">ABOUT</a></li></ul></div>
<div id="leftcolumn">
  <div id="navcontainer">
  <ul>
    <li><a href="JavaScript:void(0);">Upcoming Events</a></li>
    <li><a href="JavaScript:void(0);">Members</a></li>
    <li><a href="JavaScript:void(0);">Specials</a></li>
    <li><a href="JavaScript:void(0);">Who is Snap Nature</a></li>
    </ul>
  </div>
</div>
<div id="content"></div>
<div id="footer"></div>
</div>
</body> 
```

**CSS：**

```
@charset "utf-8";
* {
    background-color: #6FF;
    margin: 0px;
    padding: 0px;
}
#wrapper {
    background-color: #F90;
    width: 960px;
    margin-top: 0px;
    margin-right: auto;
    margin-bottom: 0px;
    margin-left: auto;
}
#header {
    background-color: #6F0;
    height: 124px;
    width: 960px;
    margin-top: 0px;
    margin-right: auto;
    margin-bottom: 0px;
    margin-left: auto;
}
#navigation {
    background-color: #F3F;
    float: left;
    height: 25px;
    width: 960px;
}
#leftcolumn {
    background-color: #009;
    float: left;
    height: 350px;
    width: 250px;
    margin-top: 0px;
    margin-right: auto;
    margin-bottom: 0px;
    margin-left: auto;
}
#content {
    background-color: #69F;
    width: 710px;
    float: left;
    height: 350px;
    margin-top: 0px;
    margin-right: auto;
    margin-bottom: 0px;
    margin-left: auto;
}
#footer {
    background-color: #F00;
    clear: both;
    height: 25px;
    width: 960px;
    margin-top: 0px;
    margin-right: auto;
    margin-bottom: 0px;
    margin-left: auto;
}
#navigation ul {
    list-style-type: none;
    margin: 0px;
    padding: 0px;
    width: 960px;
    height: 0px;
}
#navigation li {
    float: left;
    background-color: #F3F;
}
#navigation a {
    line-height: 25px;
    text-decoration: none;
    color: #000;
    background-color: #F3F;
    display: block;
    text-align: center;
    vertical-align: middle;
    width: auto;
    padding-right: 10px;
    padding-left: 10px;
    padding-top: 0px;
    padding-bottom: 0px;
    height: 25px;
}

#navigation a:hover {
    color: #999;
    text-decoration: none;
}

#navcontainer ul {
    padding: 0px;
    margin-left: 0px;
    list-style-type: none;
    width: 200px;
    display: block;
    line-height: 34px;
    background-image: url(images/pg_menu_bg.png);
} 
```

请帮助 TY 贾里德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:25:14.720

**编辑：**

是的，这正是问题所在。我刚刚检查了您发布的链接，浏览器正在寻找位于以下位置的图像：[http](http://www.156.onl.checit.info/CSS/images/pg_menu_bg.png) ://www.156.onl.checit.info/CSS/images/pg_menu_bg.png - 它不存在。

看到那里的“CSS”了吗？我 99% 确定那是无意的。这是一个绝对/相对路径问题。继续阅读...

* * *

如果您的图像没有出现，我会凭直觉说这是因为您的图像路径搞砸了。

**解决方案：**

这：

```
/* ABSOLUTE PATH solution */
background-image: url(/images/pg_menu_bg.png); 
```

甚至可能是这个（取决于您的文件结构）：

```
/* RELATIVE PATH solution. This is FROM YOUR CSS FILE.*/
background-image: url(../images/pg_menu_bg.png); 
```

**解释：**

两者之间有很大区别：

```
background-image: url(images/pg_menu_bg.png); 
```

和

```
background-image: url(/images/pg_menu_bg.png); /* note the leading slash */ 
```

前导斜杠表示*绝对路径*（即“来自您的根域 url 的路径”），而没有前导斜杠表示*相对路径*（即“相对于该文件的位置，在本例中为您的 CSS 文件”）。

这意味着，假设您有这样的文件结构：

```
root
|
----images
       | pg_menu_bg.png
|
----css
       | mycss.css 
```

从您的 css 文件中，调用：

```
background-image: url(images/pg_menu_bg.png); 
```

实际上导致：

```
http://yourdomain.com/css/images/pg_menu_bg.png /* note the "css" */ 
```

而调用：

```
background-image: url(/images/pg_menu_bg.png); 
```

结果是：

```
http://yourdomain.com/images/pg_menu_bg.png 
```

所以我认为你需要看看你的目录结构，然后从那里开始工作。我的猜测是你需要使用*绝对路径*。

但是，如果您想在上面的虚拟文件结构中使用*相对路径*，您可以使用：

```
background-image: url(../images/pg_menu_bg.png); /* ".." means "parent directory" 
```

**更多信息：**
[在 CSS 文件中使用相对 URL，它相对于什么位置？](https://stackoverflow.com/questions/940451/using-relative-url-in-css-file-what-location-is-it-relative-to)

* * *

**第二个问题：**

你有另一个问题，这种风格：

```
* {
    background-color: #6FF;
    margin: 0px;
    padding: 0px;
} 
```

这种风格将蓝色背景应用于每个元素。因此，即使您通往该背景图像的路径正常，它们也会被具有蓝色背景的前景元素隐藏。

尝试更改`*`为`body`：

```
body {
    background-color: #6FF;
    margin: 0px;
    padding: 0px;
} 
```

**注意：**如果你真的想要一个`margin:0;`and`padding:0;`在每个元素上，保持上面的样式不变（但删除`background-color`），并定义一个新`body`样式并将 放在`background-color`那里。像这样：

```
* {
    margin: 0px;
    padding: 0px;
}

body {
    background-color: #6FF;
} 
```

# string - ++ 带字符串和 IO 字符串的运算符

> ID：16051951
> 
> 赞同：2
> 
> 时间：2013-04-17T05:07:44.657
> 
> 标签：string, haskell, io

```
explandDol :: String -> String -> [String] -> IO String
explandDol conclusion operators atoms =
    let (ys,zs) = splitAt (head (take 1 replacement)) conclusion in ys ++ getConclusion     operators atoms ++ (tail zs)
    where replacement = elemIndices '$' conclusion

getConclusion :: String -> [String] -> IO String
getConclusion operators atoms =
   runRVar (choice [atom1 ++ " " ++ [operator] ++ " " ++ atom2 | atom1 <- atoms, atom2 <-    atoms, operator <- operators,checkAtoms atom1 atom2]) StdRandom 
```

有没有解决这个问题的好方法？我收到此错误：

```
/home/joe/Documents/haskell/LAG/main/main.hs: line 73, column 69:
  Couldn't match expected type `IO String' with actual type `[Char]'
  In the expression: ys ++ getConclusion operators atoms ++ (tail zs)
  In the expression:
    let (ys, zs) = splitAt (head (take 1 replacement)) conclusion
    in ys ++ getConclusion operators atoms ++ (tail zs)
  In an equation for `explandDol':
      explandDol conclusion operators atoms
        = let (ys, zs) = splitAt (head (take 1 replacement)) conclusion
          in ys ++ getConclusion operators atoms ++ (tail zs)
        where
            replacement = elemIndices '$' conclusion
/home/joe/Documents/haskell/LAG/main/main.hs: line 73, column 75:
  Couldn't match expected type `[Char]' with actual type `IO String'
  In the return type of a call of `getConclusion'
  In the first argument of `(++)', namely
    `getConclusion operators atoms'
  In the second argument of `(++)', namely
    `getConclusion operators atoms ++ (tail zs)'
/home/joe/Documents/haskell/LAG/main/main.hs: line 73, column 75:
  Warning: Redundant bracket
  Found:
    getConclusion operators atoms ++ (tail zs)
  Why not:
    getConclusion operators atoms ++ tail zs 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T05:45:51.813

因为 is 返回的值`getConclusion`不能`IO String`简单地与对未包装值进行操作的函数一起使用。要么首先使用解包值，`x <- getConclusion operators atom`要么如果你想要函数组合使用`fmap`.

# ruby - 默认情况下使可枚举对象变得惰性

> ID：16051956
> 
> 赞同：3
> 
> 时间：2013-04-17T05:08:14.567
> 
> 标签：ruby, lazy-evaluation, ruby-2.0

我已经开始使用 Ruby 2.0 中的 Enumerable::Lazy 功能，它看起来非常有用。

我有一个通过远程数据源分页的 Enumerable 集合。正因为如此，我希望它是一个“懒惰”的集合。但是，我不想每次他们想要使用任何 Enumerable 方法时都指示我的班级的每个用户调用 .lazy 。相反，最好包含一个假设的 LazyEnumerable 模块并让所有可枚举的方法默认都是惰性的。

有没有人对实现这一目标的干净方式有任何想法？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:42:19.690

我有一个想法，并认为我会尝试一下：

```
module LazyEnumerable
  include Enumerable

  def self.make_lazy(*methods)
    methods.each do |method|
      define_method method do |*args, &block|
        lazy.public_send(method, *args, &block)
      end
    end
  end

  make_lazy *(Enumerable.public_instance_methods - [:lazy])
end 
```

很想知道是否有更强大的方法来做到这一点。

# pdf - 使用 ContentByteUtils 进行原始 PDF 操作

> ID：16051960
> 
> 赞同：0
> 
> 时间：2013-04-17T05:08:37.890
> 
> 标签：pdf, pdf-generation, itextsharp

这是一个后续问题：

[以编程方式更改 PDF 文件中黑框的颜色？](https://stackoverflow.com/questions/14960740/programmatically-change-the-color-of-a-black-box-in-a-pdf-file)

我有一个我在 Illustrator 中创建的 pdf，页面中间基本上是黑色的，没有别的。我需要动态更改该形状的颜色。

从对上面帖子的响应中，我使用 iTextSharp (.NET C#) 通过 ContentByteUtils.GetContentBytesForPage() 获取 PDF 的原始内容并在原始级别更改颜色。

问题是我找不到通过 iTextSharp 将结果保存回原始 PDF 或新 PDF 文件的任何方法。我目前坚持使用原始内容的字节数组，但需要弄清楚如何保存。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T10:21:14.903

你为什么用`ContentByteUtils.GetContentBytesForPage()`？

我会使用：

```
PdfReader reader = new PdfReader(src);
byte[] content = reader.GetPageContent(pageNumber);
// do stuff with content
reader.SetPageContent(pageNumber, content);
using (FileStream fs = new FileStream(outputFile, FileMode.Create, FileAccess.Write, FileShare.None)) {
    using (PdfStamper stamper = new PdfStamper(reader, fs)) {
    }
} 
```

# mysql - 从两个表中选择匹配的对

> ID：16051961
> 
> 赞同：1
> 
> 时间：2013-04-17T05:08:41.463
> 
> 标签：mysql, sql

我需要从包含相似结构数据的两个表中选择匹配的对。这里的“匹配对”是指在“匹配​​”列中相互引用的两行。

单表配对示例：

```
TABLE
----
id | matchid
1  |   2
2  |   1 
```

ID 1 和 2 是一对匹配的，因为每个都有一个匹配条目。

现在真正的问题是：选择出现在两个表中的匹配对的最佳（最快）方法是什么：

```
Table ONE (id, matchid)
Table TWO (id, matchid) 
```

示例数据：

```
ONE                TWO
----               ----
id  | matchid      id  | matchid
1   |   2          2   |   3
2   |   3          3   |   2
3   |   2
4   |   5
5   |   4 
```

所需的结果是 ID 为 2 和 3 的单行。

```
RESULT
----
id  | id
2   | 3 
```

这是因为 2 和 3 是表一和表二中的匹配对。4 & 5 是表 ONE 中的匹配对，但不是 TWO，因此我们不选择它们。1 和 2 根本不是匹配对，因为 2 没有与 1 匹配的条目。

我可以从一个表中得到匹配的对：

```
SELECT a.id, b.id 
    FROM ONE a JOIN ONE b
       ON a.id = b.matchid AND a.matchid = b.id
    WHERE a.id < b.id 
```

我应该如何构建一个只选择两个表中出现的匹配对的查询？

我是不是该：

*   为每个表选择上面的查询并将它们一起存在于哪里？
*   为每个表选择上面的查询并将它们连接在一起？
*   选择上面的查询然后 JOIN table TWO 两次，一次用于“id”，一次用于“matchid”？
*   为每个表选择上面的查询并循环以在 php 中比较它们？
*   不知何故过滤表二，所以我们只需要查看表一中匹配对的ID吗？
*   做一些完全不同的事情？

（由于这是一个效率问题，值得注意的是匹配会非常稀疏，可能是 1/1000 或更少，并且每个表将有 100,000+ 行。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:13:15.310

我想我明白你的意思。您想要过滤**两个表中存在对**的记录。

```
SELECT  LEAST(a.ID, a.MatchID) ID, GREATEST(a.ID, a.MatchID) MatchID
FROM    One a
        INNER JOIN Two b
            ON a.ID = b.ID AND
                a.matchID = b.matchID
GROUP   BY LEAST(a.ID, a.MatchID), GREATEST(a.ID, a.MatchID)
HAVING  COUNT(*) > 1 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/7ab00/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:26:49.247

试试这个查询：

 ~~```
 select 
    O.id,
    O.matchid
    from 
    ONE O
    where 
    (CAST(O.id as CHAR(50))+'~'+CAST(O.matchid as CHAR(50)))
    in (select CAST(T.id as CHAR(50))+'~'+CAST(T.matchid as CHAR(50)) from TWO T) 
```~~  ~~**编辑查询：**

```
select distinct
Least(O.id,O.matchid) ID,
Greatest(O.id,O.matchid) MatchID
from 
ONE O
where 
(CAST(O.id as CHAR(50))+'~'+CAST(O.matchid as CHAR(50)))
in (select CAST(T.id as CHAR(50))+'~'+CAST(T.matchid as CHAR(50)) from TWO T)
and (CAST(O.matchid as CHAR(50))+'~'+CAST(O.id as CHAR(50)))
in (select CAST(T.id as CHAR(50))+'~'+CAST(T.matchid as CHAR(50)) from TWO T) 
```

**[SQL小提琴](http://www.sqlfiddle.com/#!2/7ab00/6)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T16:28:17.867

Naive version, which checks *all the four rows* that need to exist:

```
-- EXPLAIN ANALYZE
WITH both_one AS (
        SELECT o.id, o.matchid
        FROM one o
        WHERE o.id < o.matchid
        AND EXISTS ( SELECT * FROM one x WHERE x.id = o.matchid AND x.matchid = o.id)
        )
, both_two AS (
        SELECT t.id, t.matchid
        FROM two t
        WHERE t.id < t.matchid
        AND EXISTS ( SELECT * FROM two x WHERE x.id = t.matchid AND x.matchid = t.id)
        )
SELECT *
FROM both_one oo
WHERE EXISTS (
        SELECT *
        FROM both_two tt
        WHERE tt.id = oo.id AND tt.matchid = oo.matchid
        ); 
```

This one is simpler :

```
-- EXPLAIN ANALYZE
WITH pair AS (
        SELECT o.id, o.matchid
        FROM one o
        WHERE EXISTS ( SELECT * FROM two x WHERE x.id = o.id AND x.matchid = o.matchid)
        )
SELECT *
FROM pair pp
WHERE EXISTS (
        SELECT *
        FROM pair xx
        WHERE xx.id = pp.matchid AND xx.matchid = pp.id
        )
AND pp.id < pp.matchid
        ; 
```~~

# logging - PBS 脚本 -o 文件到多个位置

> ID：16051964
> 
> 赞同：4
> 
> 时间：2013-04-17T05:08:51.350
> 
> 标签：logging, pbs, supercomputers

有时当我在 PBS 集群上运行作业时，我真的很喜欢两个地方的作业日志（-o 文件）。一个用于将所有东西`$PBS_O_WORKDIR`放在一起，另一个`${HOME}/jobOuts/`用于 greping/awking/etc...

从命令行进行测试适用于`tee`：

```
echo "hello" | qsub -o `tee $HOME/out1.o $HOME/out2.o $HOME/out3.o` 
```

但是，一旦我尝试将其放入我的 PBS 脚本中，如果我将其放入 PBS 脚本和 qsub 中，它就不起作用

```
####Parameterized PBS Script ####
#PBS -S /bin/bash
#PBS -l nodes=1
#PBS -l walltime=0:01:00
#PBS -j oe
#PBS -o `tee TEE_TEST.o TEE_TEST.${PBS_JOBID}.o`
#PBS -M me@email.com
#PBS -m abe
#PBS -V

cd $PBS_O_WORKDIR

echo `date` 
```

这是 qsub 和错误：

```
qsub  TEST.pbs
qsub: directive error: -o `tee TEE_TEST.o TEE_TEST.${PBS_JOBID}.o` 
```

我在下面尝试了其他一些事情 - 没有任何效果。

一个 -o 行（逗号、分号和空格）：

```
#PBS -o ${PBS_JOBNAME}.${PBS_JOBID}.o,${HOME}/jobOuts/${PBS_JOBNAME}.${PBS_JOBID}.o
#PBS -o ${PBS_JOBNAME}.${PBS_JOBID}.o,${HOME}/jobOuts/${PBS_JOBNAME}.${PBS_JOBID}.o
#PBS -o ${PBS_JOBNAME}.${PBS_JOBID}.o ${HOME}/jobOuts/${PBS_JOBNAME}.${PBS_JOBID}.o 
```

和两行：

```
#PBS -o ${PBS_JOBNAME}.${PBS_JOBID}.o
#PBS -o ${HOME}/jobOuts/${PBS_JOBNAME}.${PBS_JOBID}.o 
```

两个工作班轮只采用第二个 -o 选项，一个班轮不起作用。

有什么建议么？可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T23:16:56.560

我很惊讶您的命令行示例有效。你的工作真的运行了吗？我的猜测是跑步

```
echo "hello" | qsub -o `tee $HOME/out1.o $HOME/out2.o $HOME/out3.o` 
```

使运行的工作短路，实际上只是抓住“你好”并将其传递给发球台。我的猜测是，更了解 bash 的人可以解释这里实际发生的事情。

我能想到的唯一方法是让你的脚本写东西来完成你的请求。为了使其工作，您需要将位置放在可从任何可能的计算节点访问的网络文件系统上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-17T21:26:01.203

我研究了一个[qsub 手册页](http://www.clusterresources.com/torquedocs21/commands/qsub.shtml)，我认为没有一种方法可以为标准输出和标准错误指定多个输出文件（每个）。从[这个页面](http://www.arsc.edu/arsc/knowledge-base/job-chaining-in-three-ste/index.xml)中获取提示，这是我实现与您的目标类似的方法。您的 PBS 环境可能会有所不同。另外，我不是 bash 专家，因此可能有更简洁的方法可以实现相同的目标。

假设您使用默认的 -o 设置，请在常规作业脚本的末尾放置以下命令：

```
# change to the directory from which this job was submitted
cd $PBS_O_WORKDIR

# the standard output by default will be in file JOBNAME.oJOBID
# on my system, PBS_JOBID has ".machinename" at the end, which needs to be removed

filename=${PBS_JOBNAME}.o${PBS_JOBID%%.*}

echo "${PBS_O_WORKDIR}/copy.pbs $filename" | qsub 
```

这将使用标准输入参数启动 qsub，告诉它使用要复制的文件名参数运行“copy.pbs”。我使用的 copy.pbs 文件是：

```
#!/bin/bash

# change to the directory from which this job was submitted
cd $PBS_O_WORKDIR

newfile=${HOME}/jobOuts/$1

cp $1 $newfile 
```

这对我来说可以将第一个 PBS 标准输出复制到另一个目录。一个副作用是使用 qsub 运行 copy.pbs 会创建另外两个输出文件，STDIN.e* 和 STDIN.o*。我认为再次使用 qsub 是确保第一份工作完成的好主意。为了更安全，您可以将“取决于选项”与 qsub 一起使用，例如`"-W depend=afterok:$PBS_JOBID copy.pbs $filename" | qsub`. 但我没有测试这种方法，就像我说的，我不是这方面的专家。

# jquery - 如何在 Foundation 4 中禁用轨道计时器？

> ID：16051965
> 
> 赞同：1
> 
> 时间：2013-04-17T05:08:56.587
> 
> 标签：jquery, slider, zurb-foundation, orbit

我在 Foundation 4 中使用 Orbit 并希望完全禁用计时器功能，因此幻灯片只能由用户手动推进。这可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T05:12:39.510

```
$(document).foundation('orbit', {
    timer_speed: 0
});
$(document).foundation(); 
```

需要两次调用来初始化 Foundation 的其他组件。任何自定义都应该在 Foundation 本身初始化之前完成。

# html - 使用 JSlot 实时渲染

> ID：16051968
> 
> 赞同：0
> 
> 时间：2013-04-17T05:09:15.267
> 
> 标签：html, jquery, jquery-plugins

我也开始使用 JQPlot 来实时绘制图形。我有一个示例示例，它将仅使用两个数据绘制图形-

```
var storedData = [70, 10]; 
```

然后我添加了一个按钮，如果我单击该按钮，它将开始呈现更多数据。基本上，您可以说就像来自服务器的实时数据一样-

但我目前面临的问题是，只要我点击`Start Updates`按钮，它就不会画任何东西。所以我相信，我搞砸了按钮点击的东西。我在 Javascript 和 HTML 方面工作了很长时间，所以我忘记了很多东西。

下面是我的代码-

```
<!DOCTYPE html>

<html>
<head>

    <title>Line Charts and Options</title>

    <link class="include" rel="stylesheet" type="text/css" href="../jquery.jqplot.min.css" />
    <link rel="stylesheet" type="text/css" href="examples.min.css" />
    <link type="text/css" rel="stylesheet" href="syntaxhighlighter/styles/shCoreDefault.min.css" />
    <link type="text/css" rel="stylesheet" href="syntaxhighlighter/styles/shThemejqPlot.min.css" />

    <!--[if lt IE 9]><script language="javascript" type="text/javascript" src="../excanvas.js"></script><![endif]-->
    <script class="include" type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

</head>
<body>
    <div class="colmask leftmenu">
      <div class="colleft">
        <div class="col1" id="example-content">

<div id="chart1" style="height: 300px; width: 500px; position: relative;"></div>
<button>Start Updates</button>

<script class="code" type="text/javascript">
$(document).ready(function(){
  var storedData = [70, 10];
  var plot1;
  renderGraph();

$('button').click( function(){
    doUpdate();
    $(this).hide();
});

function renderGraph() {
    if (plot1) {
        plot1.destroy();
    }
    plot1 = $.jqplot('chart1', [storedData]);
}

var newData = [9, 1, 4, 6, 8, 2, 5];

function doUpdate() {
    if (newData.length) {
        var val = newData.shift();
        $.post('/echo/html/', {
            html: val
        }, function(response) {
            var newVal = new Number(response); /* update storedData array*/
            storedData.push(newVal);
            renderGraph();
            log('New Value '+ newVal+' added')
            setTimeout(doUpdate, 3000)
        })

    } else {
        log("All Done")
    }
}

function log(msg) {
$('body').append('<div>'+msg+'</div>')
}
});
</script>

    <script class="include" type="text/javascript" src="../jquery.jqplot.min.js"></script>
    <script type="text/javascript" src="syntaxhighlighter/scripts/shCore.min.js"></script>
    <script type="text/javascript" src="syntaxhighlighter/scripts/shBrushJScript.min.js"></script>
    <script type="text/javascript" src="syntaxhighlighter/scripts/shBrushXml.min.js"></script>

  <script class="include" type="text/javascript" src="../plugins/jqplot.canvasTextRenderer.min.js"></script>
  <script class="include" type="text/javascript" src="../plugins/jqplot.canvasAxisLabelRenderer.min.js"></script>

</body>

</html> 
```

我无法使按钮单击事件起作用。一旦我单击`Start Update`按钮，它就不会绘制任何东西。正确的行为应该是它应该开始在带有新数据集的图形上呈现。

[我试图通过这个jsfiddle](http://jsfiddle.net/ZqCXP/)使实时渲染工作

我在我的 HTML 中从上面的 JSFiddle 复制了相同的一堆代码，但它对我不起作用。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:47:36.957

给你 - 你必须在脚本标签中更新到你的 jqplot 位置。此外，我不得不将 doUpdate 更改为 doUpdate2，因为据我所知，如果没有 jfiddle，$.post 将无法工作。

```
<!DOCTYPE html>

<html>
<head>

    <title>Line Charts and Options</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript" src="jqplot/jquery.jqplot.min.js"></script>
    <script type="text/javascript" src="jqplot/plugins/jqplot.canvasAxisTickRenderer.min.js"></script>
    <script type="text/javascript" src="jqplot/plugins/jqplot.canvasTextRenderer.min.js"></script>
    <script type="text/javascript" src="jqplot/plugins/jqplot.canvasAxisLabelRenderer.min.js"></script>
    <script type="text/javascript" src="jqplot/plugins/jqplot.cursor.min.js"></script>
    <script type="text/javascript" src="jqplot/plugins/jqplot.pointLabels.min.js"></script>
    <script type="text/javascript" src="jqplot/plugins/jqplot.highlighter.min.js"></script>
    <script type="text/javascript">

        $(function(){

                /* store empty array or array of original data to plot on page load */

                    var storedData = [70, 10];

                    /* initialize plot*/

                    var plot1;
                    renderGraph();

                    $('button').click( function(){
                    doUpdate2();
                    $(this).hide();
                    });

                    function renderGraph() {
                    if (plot1) {
                        plot1.destroy();
                    }
                    plot1 = $.jqplot('chart1', [storedData]);
                    }

                    var newData = [9, 1, 4, 6, 8, 2, 5];
                    var cp = 0;
                    function doUpdate2() {
                        var newVal = new Number(newData[cp]); /* update storedData array*/
                        storedData.push(newVal);
                        renderGraph();
                        log('New Value '+ newVal+' added')
                        if (cp < newData.length-1) setTimeout(doUpdate2, 3000)
                        cp++;
                    }

                    function doUpdate() {
                    if (newData.length) {
                        var val = newData.shift();
                        $.post('/echo/html/', {
                        html: val
                        }, function(response) {
                        var newVal = new Number(response); /* update storedData array*/
                        storedData.push(newVal);
                        renderGraph();
                        log('New Value '+ newVal+' added')
                         setTimeout(doUpdate, 3000)
                        })

                    } else {
                        log("All Done")
                    }
                    }

                    function log(msg) {
                    $('body').append('<div>'+msg+'</div>')
    }

        });

    </script>

</head>
<body>
    <div id="chart1" style="height: 300px; width: 500px; position: relative;"></div>
    <button>Start Updates</button>

</body>

</html> 
```

# cocoa-touch - NSObject 调用 self 给出 XCode 错误

> ID：16051969
> 
> 赞同：0
> 
> 时间：2013-04-17T05:09:23.917
> 
> 标签：cocoa-touch, ios6, xcode4.2, implicit-conversion, nsobject

我有一个继承自 NSObject 的类 WebServices。我正在使用 xcode4.2 并打开了 ARC。当我创建类时，NSObject 中没有其他方法位于 viewDidLoad 或 init 中。

问题是当我尝试调用 self.something 或 [self someMethod] Xcode 将我的代码标记为红色并抱怨：

**Objective-C 指针类型“Class”到 C 指针类型“struct obj_class*”的隐式转换需要桥接转换**

请帮忙。为什么 cocoa 不像 java 你称之为“this”并得到你所在的对象？

```
// WebService.h file
@interface WebService : NSObject

@property (weak, nonatomic) NSString * myString;
+(void) setAndPrintMyString:(NSString*) someString;

@end

//WebService.m file

#import "WebService.h"
@implementation WebService

@synthesize myString=_myString;

+(void) printMyString:(NSString*) someString{
 [self setMyString:someString];      //XCode does not allow
 NSLog(@"myString is set to %@",self.myString); //XCode dose not allow
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:13:18.610

`viewDidLoad`方法不适合`NSObject`子类。这是一种`UI`将存在于`UIViewController`子类中的方法。

现在，谈到`self.something`OR `[self someMethod]`，这对子类非常有效`NSObject`。您需要向我们展示您面临问题的代码。

*仅供参考（我认为您应该在完成此操作后开始为 iOS 开发）：*

*   [NSObject 类参考](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/occ/cl/NSObject)
*   [UIViewController 类参考](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T00:47:23.017

声明一个方法`+`意味着它是一个类方法。在类中的方法`self`是指类本身，在您的情况下是`[WebService class]`. 如果您声明了实例方法（使用`-`），那么方法内部`self`将引用实例，这就是您想要的。

要设置实例变量 - 您需要一个实例

```
WebService *webService = [[WebService alloc] init];
webService.myString = @"some string"; 
```

现在要使您的方法工作，您需要使用 a 声明它，`-`而不是`+`使其成为实例方法

```
- (void)printMyString:(NSString *)someString
{
  [self setMyString:someString];
  NSLog(@"myString is set to %@",self.myString);
} 
```

现在

```
[webService printMyString:@"boom"]; 
```

导致实例变量`myString`被设置为`boom`并且控制台注销`myString被设置为繁荣“。

# android - 在意图中为什么 Uri 用于传输数据。

> ID：16051971
> 
> 赞同：0
> 
> 时间：2013-04-17T05:09:36.713
> 
> 标签：android, android-intent

因为我们可以使用 , File 并且对于小事情我们也可以使用 Strings &

请用一些现实世界的例子来解释意图。

在“ `ACTION_DELETE`”中，我们不处理任何活动以及意图与“`ACTION_DELETE`动作”的用途是什么，而在“ `ACTION_DIAL`”中，我们正在处理活动......这令人困惑，我得到了意图的正确含义。

# javascript - 无法在 IE 上弹出警报...在 Firefox、Chrome 等中运行良好？

> ID：16051974
> 
> 赞同：0
> 
> 时间：2013-04-17T05:09:47.760
> 
> 标签：javascript, internet-explorer, popup, emptydatatext

当没有文本/空格时，我正在尝试弹出块。它在 Firefox、Chrome 和 Safari 中运行良好。

请检查我的 JavaScript 文件中的以下代码：

```
function submitQuestion(URL,docId,errorMessage)
{
var question = $('textField').value;
if(!question.blank())
{
var submitForm = $("question-form");
submitForm.action = URL+"docId="+docId+"&question="+encodeURIComponent(question);
//alert(submitForm.action);
submitForm.submit();
}
else
{
alert(errorMessage);
return false;
}
} 
```

上述功能在 Firefox、Safari 和 Chrome 中运行良好，因为当文本框中没有任何内容（即空/空白）时，它会转到 else &prompt errorMessage 作为弹出窗口，但在 IE 中，它不会转到 else &errorMessage 弹出窗口从不来。

请检查以下代码以获取我的 forntend 表单-：

```
<form method="POST" id="question-form" onsubmit="return submitQuestion('https://localhost/question-post!input.jspa?','ABC12','Enter your question!');">
                <span class="fieldwrap">
                    <input type="text" placeholder="Ask customers about this document" value="" maxlength="255" autocomplete="off" class="questionInputField" id="textField">
                </span>
                <div class="clear"></div>
                <div id="question-submit" class="widget-div clearfix">
                    <input type="submit" value="Submit question to the portal" class="questionSubmitFormButton">

                    </div>
                </div>  

            </form> 
```

在 IE 中发生的情况是，当我们没有提供任何内容时，它将占位符作为文本字段的值，即当我们将文本字段保持为空或空白时，它将占位符作为文本字段值&而不是提供弹出警报，它转到 if 循环，这不应该是一种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:13:54.197

要使用 jQuery 访问 textField 的值，您应该使用 val() 而不是 value。

```
var question = $('textField').val();
if (question != '') {
 //
}
else {
 //
} 
```

下面是一个工作示例：

```
<!DOCTYPE html>
<head>
    <title>EXAMPLE</title>
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script>
        function submitQuestion(URL, docId, errorMessage) {
            var question = $('#textField').val();
            if (question.trim() != "") {
                var submitForm = $("#question-form");
                submitForm.attr("action", URL + "docId=" + docId + "&question=" + encodeURIComponent(question));
                return true;
            }
            else {
                alert(errorMessage);
                return false;
            }
        }
    </script>
</head>
<body>
    <form method="POST" id="question-form" onsubmit="return submitQuestion('https://localhost/question-post!input.jspa?','ABC12','Enter your question!');">
        <span class="fieldwrap">
            <input type="text" placeholder="Ask customers about this document" value="" maxlength="255" autocomplete="off" class="questionInputField" id="textField">
        </span>
        <div class="clear"></div>
        <div id="question-submit" class="widget-div clearfix">
            <input type="submit" value="Submit question to the portal" class="questionSubmitFormButton">
        </div>
    </form>
</body> 
```

# fortran - Fortran - Maxval 在指定维度时返回奇怪的结果

> ID：16051977
> 
> 赞同：1
> 
> 时间：2013-04-17T05:10:07.457
> 
> 标签：fortran, gfortran

我有一个 3x2 数组，并用数字 1-6 填充它，使其看起来像
1 4
2 5
3 6

然后我调用它的 maxval，并指定我希望找到沿维度 1 的最大值。人们会期望它应该返回 3，不是吗？

但由于某种原因，我的输出是 '3 6'

```
PROGRAM maxv
    IMPLICIT None
    INTEGER, DIMENSION(3,2) :: x
    DATA x /1,2,3,4,5,6/

    WRITE(*,*) maxval(x,dim=1)
ENDPROGRAM maxv 
```

如果问题出在我的编译器中，我使用 Gfortran 4.6.3

根据[http://www.nsc.liu.se/~boein/f77to90/a5.html](http://www.nsc.liu.se/~boein/f77to90/a5.html)，指定维度时的 maxval 应该提供该维度中的 maxval。

或者也许我忽略了一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T05:18:58.850

是的，你*忽略了一些东西*； `maxval`行为正确。

当您编写时，对于 rank-2 数组`x`

```
maxval(x,dim=1) 
```

该函数返回一个 rank-1 数组，其元素数量与 中的列相同`x`，每个元素是 中相应列的最大值`x`。相似地

```
maxval(x,dim=2) 
```

对于您的示例，将返回 rank-1 数组`[4,5,6]`- 的每一行中的最大值`x`。

[GNU 文档](http://gcc.gnu.org/onlinedocs/gfortran/MAXVAL.html)比您引用的源更好地解释了该功能，[IBM](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlf101l.doc/xlflr/maxval.htm)解释得更好，并包含该功能使用的示例。

# c# - LINQtoCSV 寻找一种将 csv 文件分块为多个数据结构的方法

> ID：16051983
> 
> 赞同：0
> 
> 时间：2013-04-17T05:10:48.423
> 
> 标签：c#, linq

我正在寻找一种创造性的方法来将多格式的 csv 文件分块成数据结构。

例如这里是我的 csv

```
FILEHEADER;00;RSRGP;12345;20130415;
542740;60;FRED ROGERS;1Z7539320359483792;4000001388;20130415;0000000800;0000000000;UPS;Grnd;
542740;70;511-59049-019;00001;00001;
542740;80;000000001;000000001;
542740;60;FRED ROGERS;1Z753932032184736528;4000002092;20130415;0000000000;0000000000;UPS;Grnd;
542740;70;511-56957-019;00001;00001;
542740;70;511-58714-019;00002;00002;
542740;70;511-58715-188;00001;00001;
542740;70;511-58717-019;00002;00002;
542740;70;511-58722-188;00001;00001;
542740;80;000000007;000000007;
FILETRAILER;99;0000022; 
```

如您所见，csv 中有不同的记录类型。这通常由第二列 (00, 60, 70, 80 99) 指示。记录类型为 60 的行表示订单标题，并在第 4 列中包含跟踪号。订单 ID 显示在记录类型 60 和 70 的第一列中。所以我有一个包含多个包裹的订单。

我想要一个很好的方法来获取第一个订单标题及其关联的订单行项目（记录类型 70）并将其推送到数据结构中，然后获取下一个订单标题及其关联的行项目并将其推送到另一个数据结构中同类型。

这并不像我最初想象的那么微不足道，现在我已经凝视了足够长的时间，以至于我认为我迷失在了树上。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:18:46.273

它必须是Linq吗？

您可以逐行读取值，然后使用行/字符串的 .split(';') 方法将其拆分为子字符串数组。

然后，您可以检查相应数组条目的值并使用它们来填充您的数据对象。

# extjs - iOS 中的 Sencha Touch 2.2 构建错误

> ID：16051990
> 
> 赞同：0
> 
> 时间：2013-04-17T05:11:15.237
> 
> 标签：extjs, build, sencha-touch-2

我有一个 sencha touch 2.0 项目，已升级到 sencha touch 2.2 将 app 文件夹从 2.0 项目移动到 2.2 项目。我已经安装了 sencha cmd，它工作正常。尝试构建项目时，出现以下错误

`[ERR] Failed to find file(s) for depdency reference /Users/mobcomp6/RSR/sencha/InfoImage(sencha2.2)/app/controller/common/workitems/CommonWIListController.js::ClassRequire:: [ERR] [ERR] BUILD FAILED`

文件 CommonWIListController.js 存在于指定位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T06:02:37.520

文件 CommonWIListController.js 有错误。清除错误然后构建成功

# c - 在 C 程序中断言

> ID：16051991
> 
> 赞同：0
> 
> 时间：2013-04-17T05:11:20.787
> 
> 标签：c

我收到关于断言的错误

对于默认情况，我的程序使用带有参数 0 的断言。

```
switch(choice)
{
    case OP_1:
        func_1();
        break;

    case OP_2:
        func_2();
        break;

    default:
        assert(0);
 } 
```

断言如何工作？它也给了我错误：未定义的对断言的引用。我必须指定，程序使用

```
#include <assert.h> 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:24:25.200

您的源文件缺少必要的包括：

代码：

```
#include <assert.h> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T05:17:54.487

断言是一个宏。如果定义了 NDEBUG，则它被定义为空。你不包括 assert.h

# ios - UITableView 背景滚动但不重复

> ID：16051992
> 
> 赞同：0
> 
> 时间：2013-04-17T05:11:20.833
> 
> 标签：ios, uitableview, uiview

我正在尝试`UITableView`使用以下方法设置背景：

```
[self.tableView setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"backgroundImage.png"]]]; 
```

这非常适合使背景与表格一起滚动。但是，我的背景图像会变成纯色，因此我希望它不会重复背景，而是向上滚动并适合屏幕高度*。*然后我可以将`self.view`'s设置`backgroundColor`为纯色，它看起来会很棒。

其他选项似乎在底部绘制一个小图像，但这似乎很复杂，我不太明白如何绘制背景和使用`CGContext`.

有人可以告诉我该怎么做吗？

![我想要的例子](https://i.stack.imgur.com/XZvKW.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T23:45:50.043

我不确定这是否可行，但您应该尝试为背景创建一个可调整大小的 UIImage：

如果您希望最后一行像素重复，您可以调用

```
- (UIImage *)resizableImageWithCapInsets:(UIEdgeInsets)capInsets resizingMode:(UIImageResizingMode)resizingMode 
```

在您的图像 ( `[UIImage imageNamed:@"backgroundImage.png"]`) 上使用 edgeinsets:`UIEdgeInsetsMake(backgroundImage.size.height-1,0,0,0)` 和 resizingMode:`UIImageResizingModeStretch`

完整的通话看起来像

```
UIImage* backgroundImage = [UIImage imageNamed:@"backgroundImage.png"];
UIImage* newBackgroundImage = [backgroundImage resizableImageWithCapInsets:UIEdgeInsetsMake(backgroundImage.size.height-1,0,0,0) resizingMode:UIImageResizingModeStretch]; 
```

现在您可以尝试使用此图像来创建模式：

```
[self.tableView setBackgroundColor:[UIColor colorWithPatternImage:newBackgroundImage]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-06T16:43:33.613

这对我有用：

```
UIImageView* bgImageView = [[UIImageView alloc] initWithFrame:self.tableView.frame];
bgImageView.image = [UIImage imageNamed:@"bg"];
bgImageView.contentMode = UIViewContentModeTop;
[self.tableView addSubview:bgImageView];
[self.tableView sendSubviewToBack:bgImageView]; 
```

就我而言，它运行良好。我没有用很多可重复使用的单元格对其进行测试。但它应该工作：D

# c# - DirectShowLib-2005 easycap USB 2.0 与 Sony Handycam 图像捕获问题的接口

> ID：16051995
> 
> 赞同：1
> 
> 时间：2013-04-17T05:11:27.427
> 
> 标签：c#, video, directshow, video-capture, directshow.net

我在 Easycap USB 2.0 上安装了 Sony Handycam，我正在使用 DirectShowLib-2005 进行图像捕捉。Capture 类的源代码如下：

```
 public Capture(int iDeviceNum, int iWidth, int iHeight, short iBPP, Control hControl)
    {
        Pic_Control = hControl;

        DsDevice [] capDevices;

        // Get the collection of video devices
        capDevices = DsDevice.GetDevicesOfCat(FilterCategory.VideoInputDevice);

        if (iDeviceNum + 1 > capDevices.Length)
        {
            throw new Exception("No video capture devices found at that index!");
        }

        try
        {
            // Set up the capture graph
            SetupGraph( capDevices[iDeviceNum], iWidth, iHeight, iBPP, hControl);

            // tell the callback to ignore new images
            m_PictureReady = new ManualResetEvent(false);
        }
        catch
        {
            Dispose();
            throw;
        }
    }

    private void SetupGraph(DsDevice dev, int iWidth, int iHeight, short iBPP, Control hControl)
    {
        int hr;

        ISampleGrabber sampGrabber = null;
        IBaseFilter capFilter = null;
        IPin pCaptureOut = null;
        IPin pSampleIn = null;
        IPin pRenderIn = null;

        // Get the graphbuilder object
        m_FilterGraph = new FilterGraph() as IFilterGraph2;

        try
        {

            m_rot = new DsROTEntry(m_FilterGraph);

            // add the video input device
            hr = m_FilterGraph.AddSourceFilterForMoniker(dev.Mon, null, dev.Name, out capFilter);
            DsError.ThrowExceptionForHR( hr );

            // Find the still pin
            m_pinStill = DsFindPin.ByCategory(capFilter, PinCategory.Still, 0);

            // Didn't find one.  Is there a preview pin?
            if (m_pinStill == null)
            {
                m_pinStill = DsFindPin.ByCategory(capFilter, PinCategory.Preview, 0);
            }

            // Still haven't found one.  Need to put a splitter in so we have
            // one stream to capture the bitmap from, and one to display.  Ok, we
            // don't *have* to do it that way, but we are going to anyway.
            if (m_pinStill == null)
            {
                IPin pRaw = null;
                IPin pSmart = null;

                // There is no still pin
                m_VidControl = null;

                // Add a splitter
                IBaseFilter iSmartTee = (IBaseFilter)new SmartTee();

                try
                {
                    hr = m_FilterGraph.AddFilter(iSmartTee, "SmartTee");
                    DsError.ThrowExceptionForHR( hr );

                    // Find the find the capture pin from the video device and the
                    // input pin for the splitter, and connnect them
                    pRaw = DsFindPin.ByCategory(capFilter, PinCategory.Capture, 0);
                    pSmart = DsFindPin.ByDirection(iSmartTee, PinDirection.Input, 0);

                    hr = m_FilterGraph.Connect(pRaw, pSmart);
                    DsError.ThrowExceptionForHR( hr );

                    // Now set the capture and still pins (from the splitter)
                    m_pinStill = DsFindPin.ByName(iSmartTee, "Preview");
                    pCaptureOut = DsFindPin.ByName(iSmartTee, "Capture");

                    // If any of the default config items are set, perform the config
                    // on the actual video device (rather than the splitter)
                    if (iHeight + iWidth + iBPP > 0)
                    {
                        SetConfigParms(pRaw, iWidth, iHeight, iBPP);
                    }
                }
                finally
                {
                    if (pRaw != null)
                    {
                        Marshal.ReleaseComObject(pRaw);
                    }
                    if (pRaw != pSmart)
                    {
                        Marshal.ReleaseComObject(pSmart);
                    }
                    if (pRaw != iSmartTee)
                    {
                        Marshal.ReleaseComObject(iSmartTee);
                    }
                }
            }
            else
            {
                // Get a control pointer (used in Click())
                m_VidControl = capFilter as IAMVideoControl;

                pCaptureOut = DsFindPin.ByCategory(capFilter, PinCategory.Capture, 0);

                // If any of the default config items are set
                if (iHeight + iWidth + iBPP > 0)
                {
                    SetConfigParms(m_pinStill, iWidth, iHeight, iBPP);
                }
            }

            // Get the SampleGrabber interface
            sampGrabber = new SampleGrabber() as ISampleGrabber;

            // Configure the sample grabber
            IBaseFilter baseGrabFlt = sampGrabber as IBaseFilter;
            ConfigureSampleGrabber(sampGrabber);
            pSampleIn = DsFindPin.ByDirection(baseGrabFlt, PinDirection.Input, 0);

            // Get the default video renderer
            IBaseFilter pRenderer = new VideoRendererDefault() as IBaseFilter;
            hr = m_FilterGraph.AddFilter(pRenderer, "Renderer");
            DsError.ThrowExceptionForHR( hr );

            pRenderIn = DsFindPin.ByDirection(pRenderer, PinDirection.Input, 0);

            // Add the sample grabber to the graph
            hr = m_FilterGraph.AddFilter( baseGrabFlt, "Ds.NET Grabber" );
            DsError.ThrowExceptionForHR( hr );

            if (m_VidControl == null)
            {
                // Connect the Still pin to the sample grabber
                hr = m_FilterGraph.Connect(m_pinStill, pSampleIn);
                DsError.ThrowExceptionForHR( hr );

                // Connect the capture pin to the renderer
                hr = m_FilterGraph.Connect(pCaptureOut, pRenderIn);
                DsError.ThrowExceptionForHR( hr );
            }
            else
            {
                // Connect the capture pin to the renderer
                hr = m_FilterGraph.Connect(pCaptureOut, pRenderIn);
                DsError.ThrowExceptionForHR( hr );

                // Connect the Still pin to the sample grabber
                hr = m_FilterGraph.Connect(m_pinStill, pSampleIn);
                DsError.ThrowExceptionForHR( hr );
            }

            // Learn the video properties
            SaveSizeInfo(sampGrabber);
            ConfigVideoWindow(hControl);

            // Start the graph
            IMediaControl mediaCtrl = m_FilterGraph as IMediaControl;
            hr = mediaCtrl.Run();
            DsError.ThrowExceptionForHR( hr );
        }
        finally
        {
            if (sampGrabber != null)
            {
                Marshal.ReleaseComObject(sampGrabber);
                sampGrabber = null;
            }
            if (pCaptureOut != null)
            {
                Marshal.ReleaseComObject(pCaptureOut);
                pCaptureOut = null;
            }
            if (pRenderIn != null)
            {
                Marshal.ReleaseComObject(pRenderIn);
                pRenderIn = null;
            }
            if (pSampleIn != null)
            {
                Marshal.ReleaseComObject(pSampleIn);
                pSampleIn = null;
            }
        }
    }

    private void SaveSizeInfo(ISampleGrabber sampGrabber)
    {
        int hr;

        // Get the media type from the SampleGrabber
        AMMediaType media = new AMMediaType();

        hr = sampGrabber.GetConnectedMediaType( media );
        DsError.ThrowExceptionForHR( hr );

        if( (media.formatType != FormatType.VideoInfo) || (media.formatPtr == IntPtr.Zero) )
        {
            throw new NotSupportedException( "Unknown Grabber Media Format" );
        }

        // Grab the size info
        VideoInfoHeader videoInfoHeader = (VideoInfoHeader) Marshal.PtrToStructure( media.formatPtr, typeof(VideoInfoHeader) );
        m_videoWidth = videoInfoHeader.BmiHeader.Width;
        m_videoHeight = videoInfoHeader.BmiHeader.Height;
        m_stride = m_videoWidth * (videoInfoHeader.BmiHeader.BitCount / 8);

        DsUtils.FreeAMMediaType(media);
        media = null;
    }

    private void ConfigVideoWindow(Control hControl)
    {
        int hr;

        IVideoWindow ivw = m_FilterGraph as IVideoWindow;

        // Set the parent
        hr = ivw.put_Owner(hControl.Handle);
        DsError.ThrowExceptionForHR( hr );

        // Turn off captions, etc
        hr = ivw.put_WindowStyle(WindowStyle.Child | WindowStyle.ClipChildren | WindowStyle.ClipSiblings);
        DsError.ThrowExceptionForHR( hr );

        // Yes, make it visible
        hr = ivw.put_Visible( OABool.True );
        DsError.ThrowExceptionForHR( hr );

        // Move to upper left corner
        Rectangle rc = hControl.ClientRectangle;
        hr = ivw.SetWindowPosition( 0, 0, rc.Right, rc.Bottom );
        DsError.ThrowExceptionForHR( hr );
    }

    private void ConfigureSampleGrabber(ISampleGrabber sampGrabber)
    {
        int hr;
        AMMediaType media = new AMMediaType();

        // Set the media type to Video/RBG24
        media.majorType = MediaType.Video;
        media.subType = MediaSubType.RGB24;
        media.formatType = FormatType.VideoInfo;
        hr = sampGrabber.SetMediaType( media );
        DsError.ThrowExceptionForHR( hr );

        DsUtils.FreeAMMediaType(media);
        media = null;

        // Configure the samplegrabber
        hr = sampGrabber.SetCallback( this, 1 );
        DsError.ThrowExceptionForHR( hr );
    }

    private void SetConfigParms(IPin pStill, int iWidth, int iHeight, short iBPP)
    {
        int hr;
        AMMediaType media;
        VideoInfoHeader v;

        IAMStreamConfig videoStreamConfig = pStill as IAMStreamConfig;

        // Get the existing format block
        hr = videoStreamConfig.GetFormat(out media);
        DsError.ThrowExceptionForHR(hr);

        try
        {
            // copy out the videoinfoheader
            v = new VideoInfoHeader();
            Marshal.PtrToStructure( media.formatPtr, v );

            // if overriding the width, set the width
            if (iWidth > 0)
            {
                v.BmiHeader.Width = iWidth;
            }

            // if overriding the Height, set the Height
            if (iHeight > 0)
            {
                v.BmiHeader.Height = iHeight;
            }

            // if overriding the bits per pixel
            if (iBPP > 0)
            {
                v.BmiHeader.BitCount = iBPP;
            }

            // Copy the media structure back
            Marshal.StructureToPtr( v, media.formatPtr, false );

            // Set the new format
            hr = videoStreamConfig.SetFormat( media );
            DsError.ThrowExceptionForHR( hr );
        }
        finally
        {
            DsUtils.FreeAMMediaType(media);
            media = null;
        }
    } 
```

代码在以下行抛出异常：hr = mediaCtrl.Run();

返回的 hr 值为 -2147023729

由于此图像捕获不起作用。有人可以帮我解决这个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T12:23:36.483

代码是[`0x8007048F` `ERROR_DEVICE_NOT_CONNECTED`“设备未连接”。](http://alax.info/blog/1383). 如果/当设备未连接时，不会发生捕获，不是吗？该错误很可能是从过滤器之一转发的，尤其是。捕获过滤器，因此您的故障排除应从检查捕获过滤器图的拓扑开始。

# c# - 对 RFC 6266 和文件名的 Asp .net 服务器支持*

> ID：16051997
> 
> 赞同：0
> 
> 时间：2013-04-17T05:11:30.863
> 
> 标签：c#, asp.net, file-upload, windows-runtime

我在 .NET 4.5 上使用 ASP.NET 服务器，客户端是 WinRT 平台上的 C# HttpClient。我想使用 HttpClient 上传文件并使用 System.Net.Http.MultipartFormDataContent 类来构造一个有效的 http 请求。一切正常，直到我有一个带有 DBCS 字符的文件名。

MultiPartFormDataContent 类正确编码上传文件名中的字符，并根据 RFC 6266 在内容处置标头中发送文件名和文件名*键。

但是，ASP.NET 服务器会忽略文件名* 并仅读取文件名，因此文件会以奇怪的字符保存在服务器上。

有没有其他人遇到过同样的问题？如何在服务器端获取文件名*并忽略 HttpRequest 中的文件名键？[这将是我的首选解决方案。]

或者，如何强制 MultiPartFormDataContent 仅发送文件名密钥并强制设置 UTF-8 编码字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-23T20:03:02.043

添加对 System.Net.Http 的引用并执行以下操作...

```
string suggestedFileName;   
string dispositionString = response.GetResponseHeader("Content-Disposition");

    if (dispositionString.StartsWith("attachment")) {
          System.Net.Http.Headers.ContentDispositionHeaderValue contentDisposition = System.Net.Http.Headers.ContentDispositionHeaderValue.Parse(dispositionString);
          if (!string.IsNullOrEmpty(contentDisposition.FileNameStar))
          {
              suggestedFileName = contentDisposition.FileNameStar;
          }
          else
          {
               suggestedFileName = contentDisposition.FileName.Trim('"');
          }

         } 
```

[来自 Microsoft 的 ContentDispositionHeaderValue](http://msdn.microsoft.com/en-us/library/system.net.http.headers.contentdispositionheadervalue.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-18T16:00:59.057

派对迟到了。。

通过控制客户端和服务器，我的（肮脏的）解决方法只是在创建内容时始终对 HttpClient 中的文件名进行 Base64 编码，并在服务器端再次对其进行解码。这样，您就不必处理恰当命名的 FileNameStar。

您也可以尝试手动检测 FileName 编码并在服务器上对其进行解码。相关主题：[System.Net.Mail 和 =?utf-8?B?XXXXX.... 标头](https://stackoverflow.com/questions/454833/system-net-mail-and-utf-8bxxxxx-headers)

# java - 带有 Jasypt 库的 BadPaddingException

> ID：16051998
> 
> 赞同：4
> 
> 时间：2013-04-17T05:11:30.903
> 
> 标签：java, encryption, junit3, jasypt, badpaddingexception

我不确定这是一个错误还是我做错了。无论哪种情况，我都需要别人的帮助。

我们在 Web 应用程序中将 Jasypt 和 Spring 2.05 结合在一起，我们在其中加密了属性文件中的一些密码。这件事在 Web 应用程序上运行良好。我们甚至可以使用 BasicTextEncrypor.decrypt(method) 从主方法中解密密码。

但是，我们在执行 JUnit 测试用例时遇到了问题。一旦我们运行测试套件，我们就会得到以下堆栈跟踪。

```
java.lang.reflect.InvocationTargetException
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestLoader.getTest(JUnit3TestLoader.java:108)
at org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestLoader.loadTests(JUnit3TestLoader.java:59)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:452)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: java.lang.ExceptionInInitializerError
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
at junit.framework.TestSuite.createTest(TestSuite.java:131)
at junit.framework.TestSuite.addTestMethod(TestSuite.java:114)
at junit.framework.TestSuite.<init>(TestSuite.java:75)
at junit.framework.TestSuite.addTestSuite(TestSuite.java:101)
at com.abc.test.dao.AllTests.suite(AllTests.java:104)
... 10 more
Caused by: org.jasypt.exceptions.EncryptionOperationNotPossibleException
at org.jasypt.encryption.pbe.StandardPBEByteEncryptor.decrypt(StandardPBEByteEncryptor.java:981)
at org.jasypt.encryption.pbe.StandardPBEStringEncryptor.decrypt(StandardPBEStringEncryptor.java:725)
at org.jasypt.util.text.BasicTextEncryptor.decrypt(BasicTextEncryptor.java:112)
at org.jasypt.properties.PropertyValueEncryptionUtils.decrypt(PropertyValueEncryptionUtils.java:78)
at org.jasypt.spring.properties.EncryptablePropertyPlaceholderConfigurer.convertPropertyValue(EncryptablePropertyPlaceholderConfigurer.java:115)
at org.springframework.beans.factory.config.PropertyResourceConfigurer.convertProperties(PropertyResourceConfigurer.java:95)
at org.springframework.beans.factory.config.PropertyResourceConfigurer.postProcessBeanFactory(PropertyResourceConfigurer.java:72)
at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:467)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:334)
at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:91)
at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:75)
at com.abc.test.ApplicationContextUtils.getTestApplicationContext(ApplicationContextUtils.java:18)
at com.abc.test.BaseTestCase.<clinit>(BaseTestCase.java:45) 
```

我深入研究了 Jasypt 的源代码，才知道在幕后抛出了 javax.crypto.BadPaddingException。我不确定为什么直接从 main 方法进行相同的调用和通过 JUnit 框架执行相同的事情之间存在差异，其他一切（例如密码）都是相同的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-05-25T13:14:00.030

当使用与解密时不同的 JVM 版本加密字符串时，也会发生此异常。在双方使用相同的 JVM 版本（加密/解密；服务器/客户端）对我们的案例有所帮助。