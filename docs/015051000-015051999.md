# StackOverflow 问答 15051000-15051999

# django - Django && Hadoop

> ID：15051000
> 
> 赞同：2
> 
> 时间：2013-02-24T10:48:41.663
> 
> 标签：django, hadoop, hdfs

我只想用 django 从 web 访问 hdfs，所以我使用 hadoopy，我只是写

```
def list(reqeust):
    return HttpResponse(hadoopy.ls(".")) 
```

在views.py中，但是有问题，有一些关于错误的信息：`"IOError at /list/ Ran[hadoop fs -ls .]: /bin/sh: 1: hadoop: not found"`，我认为shell无法解析“hadoop”命令，但我不知道该怎么办

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-26T07:23:18.223

您尝试使用的`hadoopy`库只是充当现有 Apache Hadoop bash 命令脚本（、、、等命令）的包装器`hadoop`，`hdfs`因此`mapred`需要在您的操作系统或应用程序的`PATH`env-var 上安装和使用这些脚本，因此它`hadoop fs -ls <path>`当您尝试执行时可能会调用shell 命令`hadoopy.ls(…)`。

# java - Java，用数据填充 Object[][] 数组

> ID：15051005
> 
> 赞同：4
> 
> 时间：2013-02-24T10:49:18.910
> 
> 标签：java, oop, multidimensional-array

我正在尝试`Object[][]`用我的对象类中的数据填充一个数组。但是我在填充数组时遇到问题。下面是我试图做的来填补`Object[][] data`. 目前该方法无法看到返回的数据变量。我已经尝试删除该方法并填充`rows`声明的数组，但不能因为有一个 for 循环。

我目前`object[][]`是否正确填充数组？

```
 public class CustomersDialog extends javax.swing.JDialog {
    private CustomerList customers = new CustomerList();
    Object rows[][] = getData();

    public Object[][] getData() {
       customers = dataManager.getUserData();
       int size = customers.size();
       Customer customer = new Customer();

       for(int i = 0; i < size; i++) {
           customer = customers.getCustomerAt(i);
           Object [][] data = { 
           { Integer.toString(customer.getCustomerID()), customer.getfName(), customer.getlName() } };
       }

       return data;
    }
 } 
```

进一步执行在循环外创建数组的这种方法会导致编译器发出“空语句消息”，并说它“需要语句`;`之后的行结束`.get`”：

```
 public Object[][] getData() {
    customers = dataManager.getUserData();
    int size = customers.size();
    Customer customer;

    Object [][] data;

    for(int i = 0; i < size; i++) {
        customer = customers.getCustomerAt(i);
        data = { 
        { Integer.toString(customer.getCustomerID()), customer.getfName(), customer.getlName() } };
    }

    return data;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T10:59:22.070

你没有正确地做到这一点。

在您的代码中，您声明了一个数组 INSIDE`for`循环，这意味着在循环之后，该数组不再存在。这就是你无法返回的原因`data`——它根本不存在。

有关变量的范围和生命周期的更多信息，您可以在此处阅读：[http ://www.c4learn.com/javaprogramming/the-scope-and-lifetime-of-variables-in-java-programming-language/](http://www.c4learn.com/javaprogramming/the-scope-and-lifetime-of-variables-in-java-programming-language/)

您要做的是在循环外声明数组：

```
Object [][] data;
for(int i; i < size; i++) {
   // Filling data array
}
return data; 
```

接下来是如果你想使用一个数组，你应该先初始化它：

```
Object [][] data = new Object [size][3]; 
```

`for`然后你可以在循环中填充它，如下所示：

```
for(int i; i < size; i++) {
   customer = customers.getCustomerAt(i);
   data[i][0] = Integer.toString(customer.getCustomerID());
   data[i][1] = customer.getfName();
   data[i][2] = customer.getlName();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T10:57:30.730

您必须两次分配数组。一次用于行，然后每行一次。

```
Object[][] data = new Object[size];
for(int i = 0; i < size; i++) {
   customer = customers.getCustomerAt(i);
   data[i] =
      new Object[]{
         Integer.toString(customer.getCustomerID()),
         customer.getfName(),
         customer.getlName()
      };
   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T11:08:11.970

如果您真的想使用二维数组，则必须先定义数组的大小（如果它是一维数组！）

请参阅此内容以获得一些说明：

[http://www.leepoint.net/notes-java/data/arrays/arrays-2D.html](http://www.leepoint.net/notes-java/data/arrays/arrays-2D.html)

在我看来，您的数组只有一个大小参数，所以我会使用普通数组而不是二维数组。

我会做这样的事情：

```
public Object[] getData() {
   customers = dataManager.getUserData();
   int size = customers.size();
   Object[] result = new Object[size];
   Customer customer;

   for(int i = 0; i < size; i++) {
       customer = customers.getCustomerAt(i);
       result[i] = { 
       { Integer.toString(customer.getCustomerID()), customer.getfName(), customer.getlName() } };
   }

   return data;
} 
```

如果必须使用二维对象数组，则必须定义第二个尺寸维度并像这样填充数组：

```
for(int i = 0; i < sizeDimOne; i++) {
    for(int k = 0; k < sizeDimTwo; k++) {
          result[i][k] = { { Integer.toString(customer.getCustomerID()), customer.getfName(), customer.getlName() } }; 
    }
} 
```

希望这会有所帮助。

# php - 如何使用 php 随机化链接

> ID：15051006
> 
> 赞同：2
> 
> 时间：2013-02-24T10:49:20.450
> 
> 标签：php, html, arrays, hyperlink

我正在`array_rand()`尝试随机化 3 个链接。我基本上希望在刷新页面时显示一个不同的链接。这是我到目前为止所尝试的。

```
$links = '<a href="http://google.com">google</a>, <a href="http://facebook.com">facebook</a>, <a href="http://yahoo.com">yahoo</a>';
$links_to_array = preg_split("/ ,/", $links );
$randomize = array_rand($link_to_array, 1);
echo ($links_to_array[$randomize]); 
```

所以基本上当我刷新它似乎工作但有时所有链接都会同时出现。你可以自己试一试，让我知道我需要修复的地方。

非常感谢您的参与。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T10:51:47.193

它应该是

```
$links_to_array = preg_split("/, /", $links, -1, PREG_SPLIT_NO_EMPTY); 
```

* * *

**更新：**

```
$links = array('<a href="http://google.com">google</a>', 
               '<a href="http://facebook.com">facebook</a>', 
               '<a href="http://yahoo.com">yahoo</a>');

echo $links[rand(0,2)]; // instead of 2 you can also write count($links) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T10:51:59.430

您正在使用 preg_split，逗号前有一个空格，而不是空格前的逗号。改为使用`explode(',', $links)`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T10:52:32.597

```
$links = '<a href="http://google.com">google</a>, <a href="http://facebook.com">facebook</a>, <a href="http://yahoo.com">yahoo</a>';
$links_to_array = explode(", ", $links);
$randomize = array_rand($links_to_array, 1);
echo ($links_to_array[$randomize]); 
```

# macos - 如何在 webview 完成渲染时截取屏幕截图

> ID：15051007
> 
> 赞同：0
> 
> 时间：2013-02-24T10:49:22.553
> 
> 标签：macos, webview, screenshot

我想在 webview 完成渲染时截屏。以下是我的代码：

```
-(void)webView:(WebView *)sender didFinishLoadForFrame:(WebFrame *)frame
{
    if (frame != [sender mainFrame]) {
    return;
}
    NSBitmapImageRep *rep = [[[NSBitmapImageRep alloc] initWithFocusedViewRect:[sender bounds]] autorelease];

if (rep){
    NSImage *img = [[NSImage alloc] initWithData:[rep TIFFRepresentation]];
    NSData* imgData = [img TIFFRepresentation];

    NSArray* deskTopArrayPaths = NSSearchPathForDirectoriesInDomains(NSDesktopDirectory, NSUserDomainMask, YES);
    NSString* deskTopPath = [deskTopArrayPaths objectAtIndex:0];
    NSString* pngPath = [NSString stringWithFormat:@"%@/SaveWebPage.png",deskTopPath];
    [[NSFileManager defaultManager] createFileAtPath:pngPath contents:imgData attributes:nil];
}
} 
```

正常的图像是这样的：

![在此处输入图像描述](../Images/5c5a17e427a3f9852921ee2481f469d5.png)

但我的形象是这样的：

![在此处输入图像描述](../Images/ef079552ecea8274cbd6ef7a229c5ffd.png)

任何人都告诉我为什么以及如何改善这种情况！感谢你！

# json - 将复杂的 Json 数据导入配置单元

> ID：15051016
> 
> 赞同：1
> 
> 时间：2013-02-24T10:50:25.307
> 
> 标签：json, hadoop, import, hive, bigdata

需要一点勺子喂食，如何将复杂的 json 导入 hive。Json 文件格式为：`{"some-headers":"", "dump":[{"item-id":"item-1"},{"item-id":"item-2"},...]}`. Hive 在`dump`. Json 文件大小，目前不超过 200MB，但由于是转储，很快就会达到 GB。任何其他可能的方法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-08-02T18:07:51.277

发布端到端解决方案。将 JSON 转换为 hive 表的分步过程：

步骤 1) 如果还没有安装 maven

`>$ sudo apt-get install maven`

步骤 2) 如果还没有安装 git

`>sudo git clone https://github.com/rcongiu/Hive-JSON-Serde.git`

步骤 3) 进入 $HOME/HIVE-JSON_Serde 文件夹

步骤 4) 构建 serde 包

`>sudo mvn -Pcdh5 clean package`

步骤 5) serde 文件将位于 **$HOME/Hive-JSON-Serde/json-serde/target/json-serde-1.3.7-SNAPSHOT-jar-with-dependencies.jar**

步骤 6) 在 hive 中添加 serde 作为依赖 jar

```
 hive> ADD JAR $HOME/Hive-JSON-Serde/json-serde/target/json-serde-1.3.7- SNAPSHOT-jar-with-dependencies.jar; 
```

步骤 7）在 $HOME/books.json 中创建 json 文件（示例）

```
{"value": [{"id": "1","bookname": "A","properties": {"subscription": "1year","unit": "3"}},{"id": "2","bookname":"B","properties":{"subscription": "2years","unit": "5"}}]} 
```

步骤 8) 在 hive 中创建 tmp1 表

```
 hive>CREATE TABLE tmp1 (
      value ARRAY<struct<id:string,bookname:string,properties:struct<subscription:string,unit:string>>>   
)
ROW FORMAT SERDE 'org.openx.data.jsonserde.JsonSerDe'
WITH SERDEPROPERTIES ( 
    'mapping.value' = 'value'   
) 
STORED AS TEXTFILE; 
```

步骤 9) 将数据从 json 加载到 tmp1 表

```
>LOAD DATA LOCAL INPATH '$HOME/books.json' INTO TABLE tmp1; 
```

步骤 10) 创建一个 tmp2 表对 tmp1 进行分解操作，这个中间步骤是将多级 json 结构分解为多行 注意：如果您的 JSON 结构简单且单级，请避免此步骤

```
hive>create table tmp2 as 
 SELECT *
 FROM tmp1
 LATERAL VIEW explode(value) itemTable AS items; 
```

步骤 11) 创建 hive 表并从 tmp2 表中加载值

```
hive>create table books as 
select value[0].id as id, value[0].bookname as name, value[0].properties.subscription as subscription, value[0].properties.unit as unit from tmp2; 
```

步骤 12) 删除 tmp 表

```
hive>drop table tmp1;
hive>drop table tmp2; 
```

步骤 13) 测试 hive 表

```
hive>select * from books; 
```

输出：

id名称订阅单位

1 B 1 年 3

2 B 2 年 5

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T18:32:16.853

您可以通过实现 HiveSerDe 将 JSON 导入 Hive。

此链接用作示例实现。

[https://github.com/rcongiu/Hive-JSON-Serde](https://github.com/rcongiu/Hive-JSON-Serde)

您也可以参考这些链接

[如何使用 JSON 数据制作 HIVE 表？](https://stackoverflow.com/questions/11479247/how-do-you-make-a-hive-table-out-of-json-data)

# c# - 如何从 Javascript 访问 gridview 内的面板？

> ID：15051017
> 
> 赞同：2
> 
> 时间：2013-02-24T10:50:26.180
> 
> 标签：c#, javascript, asp.net

我有一个网格视图，其中包含一个下拉列表和一个面板，我希望通过下拉列表的选定值使其不可见和可见。

不与gridview一起使用时有效的javascript代码是：

```
 function showPannel(panelId,dropdownId ) {
        var panel = document.getElementById(panelId);
        var dropDown = document.getElementById(dropdownId);
        if (dropDown.options[dropDown.selectedIndex].value = 'Diesel Deals') {
             panel.className = "visibleDiv";

       }
        else{
            panel.className = "hiddenDiv";
            }

    } 
```

我从这里传递 panelId 和 dropdownlist id：

```
 if (e.Row.RowType == DataControlRowType.DataRow)
        {
            Panel p = (Panel)e.Row.FindControl("Panel1");
            DropDownList t1 = (DropDownList)e.Row.FindControl("DropDownList1");
            t1.Attributes.Add("onchange",
                 string.Format("javascript:showPannel('{0}', '{1}')",p.ClientID, t1.ClientID ));
        } 
```

但它不工作。该函数被调用，但是当 dropDown.options[dropDown.selectedIndex].value 被警告时它给出未定义。

我试着做

```
 Gridview1 = document.getElementById('<%=GridView1.ClientID%>');
             var cell = Gridview1.rows[0].cells[2];
             var dropdownlist = cell.childNodes[0];
             var dropdownSelectedValue = dropdownlist.options[dropdownlist.selectedIndex].value;
             alert(dropdownSelectedValue); 
```

但它也不起作用。

请帮忙

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:24:55.357

```
 Panel p = (Panel)e.Row.FindControl("Panel1");
            DropDownList t1 = (DropDownList)e.Row.FindControl("DropDownList1");
            string p_id = GridView1.ClientID + "_" + p.ClientID;
            string ddL_id = GridView1.ClientID + "_" + t1.ClientID;
            t1.Attributes.Add("onchange",
                 string.Format("javascript:showPannel('{0}', '{1}')", p_id, ddL_id )); 
```

感谢有关渲染 id 的提示

# unicode - SQLite 字符串比较上的本地化 COLLATE

> ID：15051018
> 
> 赞同：5
> 
> 时间：2013-02-24T10:50:30.560
> 
> 标签：unicode, sqlite

我想比较 SQLite DB 中的两个字符串，而不关心重音和大小写。我的意思是“Événement”应该等于“evenèment”。

在 Debian Wheezy 上，SQLite 包不提供 ICU。所以我编译了包含ICU模块的官方SQLite包（版本3.7.15.2 2013-01-09 11:53:05）。现在，我确实有更好的 Unicode 支持（原来`lower()`只适用于 ASCII 字符，现在它适用于其他字母）。但我无法将排序规则应用于比较。

```
SELECT icu_load_collation('fr_FR', 'FRENCH');
SELECT 'événement' COLLATE FRENCH = 'evenement';
-- 0 (should be 1)
SELECT 'Événement' COLLATE FRENCH = 'événement';
-- 0 (should be 1 if collation was case-insensitive)
SELECT lower('Événement') = 'événement';
-- 1 (at least lower() works as expected with Unicode strings) 
```

[SQLite 文档](http://www.sqlite.org/datatype3.html#collation)确认这是应用排序规则的正确方法。我认为[这个 ICU 扩展的文档](http://www.sqlite.org/src/artifact?ci=trunk&filename=ext/icu/README.txt)有点轻（很少有例子，没有关于排序规则的区分大小写）。

我不明白为什么`COLLATE`操作员在我上面的例子中没有效果。请帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-25T10:12:50.007

我花了几个小时来了解情况......在 SQLite 中定义 ICU 排序规则的方式（几乎）没有发生比较。根据 ICU 的说法，一个例外是带有音节标记的希伯来语文本。这是 ICU 库排序规则的默认行为。使用 SQLite，`LIKE`加载 ICU 时变得不区分大小写，但无法通过这种方式实现重读字母的规范化。

我终于明白了，我需要的是 将排序规则 的[强度设置为](http://userguide.icu-project.org/collation/customization#TOC-Default-Options)[一级级别](http://userguide.icu-project.org/collation/concepts) ，而不是默认的三级。

我发现无法通过语言环境进行设置（例如，几个变体`SELECT icu_load_collation('fr_FR,strength=0', 'french')`无用）。所以唯一的解决方案是修补 SQLite 的代码。[由于ICU API](http://icu-project.org/apiref/icu4c/ucol_8h.html)`ucol_setStrength()`中的功能，这很容易。

最小的变化是一行补丁：在函数`ucol_setStrength(pUCollator, 0);`后面添加一行。对于向后兼容的更改，我添加了一个可选的第三个参数来设置强度：默认为 0，主要为 1，等等。最多为 4-quaternary。见[差异](https://gist.github.com/mytskine/5028755)。`pUCollator = ucol_open(zLocale, &status);``icuLoadCollation()``icu_load_collation()`

最后我得到了我想要的：

```
SELECT icu_load_collation('fr_FR', 'french_ci', 1); -- collation with strength=primary
SELECT 'Événement' COLLATE french_ci = 'evenèment';
-- 1 
```

# postgresql - 在 bash 中使用 psql 命令查询 postgresql 会引发错误：关系“testschema.testtable”不存在

> ID：15051022
> 
> 赞同：0
> 
> 时间：2013-02-24T10:50:57.477
> 
> 标签：postgresql, psql

在 bash 中运行以下命令时会抛出：

> 错误：关系“testschema.testtable”不存在。

命令行：

```
psql -h "localhost" -d "postgres" -U "postgres" -c "select * from TestSchema.TestTable;" 
```

为什么它搜索关系而不是模式？如何设置要搜索的默认架构，以及可以将来自多个数据库的多个架构列表设置为默认列表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T11:35:02.353

> *为什么它搜索关系而不是模式？*

`TestSchema.TestTable` **是**一个关系（表）。I 是完全限定的表名。

找不到它的原因很可能是因为您使用双引号创建了架构和表：

```
create table "TestSchema"."TestTable" (...) 
```

这使名称区分大小写并强制您始终使用引号来限定名称。有关“分隔标识符”（又名“带引号的标识符）”的详细信息，请参阅手册：

[https://www.postgresql.org/docs/current/sql-syntax-lexical.html#SQL-SYNTAX-IDENTIFIERS](https://www.postgresql.org/docs/current/sql-syntax-lexical.html#SQL-SYNTAX-IDENTIFIERS)

> *如何设置要搜索的默认架构*

请参阅“设置架构”语句：[https ://www.postgresql.org/docs/current/sql-set.html](https://www.postgresql.org/docs/current/sql-set.html)

您还可以使用该`ALTER USER`命令定义默认模式。

> *我可以将来自多个数据库的多个模式列表设置为默认列表吗*

是的，设置 search_path 配置变量：[http ://www.postgresql.org/docs/current/static/runtime-config-client.html#GUC-SEARCH-PATH](http://www.postgresql.org/docs/current/static/runtime-config-client.html#GUC-SEARCH-PATH)

这也可以通过`ALTER USER`语句永久设置。

# jquery - 如何检查是否定义了特定的 jquery-easing 方法？

> ID：15051026
> 
> 赞同：2
> 
> 时间：2013-02-24T10:51:53.267
> 
> 标签：jquery, jquery-easing

我有一个 jQuery 插件。选项之一是用于动画的缓动方法。`$.animate(...)`在继续使用指定的缓动方法调用函数之前，我希望能够检查缓动方法是否已定义。像这样：

```
var easingMethod = option.easing;
if (!IsDefined(easingMethod)) easingMethod = 'linear'; 
```

会有什么`IsDefined()`功能？

我可以做`if (typeof(easingMethod)==undefined)`但是`typeof(easingMethod)==='string'`。我想更多的是

```
function isDefined(s) {
   // If a method named 's' is defined, return true, else false
} 
```

我不知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T10:58:00.503

这个怎么样？

```
function isDefined(s) {
  return $.easing.hasOwnProperty(s);
} 
```

# jquery - BlocksIt.js jQuery 插件。如何从 url 附加内容

> ID：15051031
> 
> 赞同：1
> 
> 时间：2013-02-24T10:52:43.787
> 
> 标签：jquery, block

我正在使用[BlocksIt.js jQuery 插件](http://www.inwebson.com/jquery/blocksit-js-dynamic-grid-layout-jquery-plugin/)，当用户从顶部滚动到 90%（几乎是底部）时，我想从 URL 加载内容。如何使其从 URL 加载内容（使用 class="grid"），并将所有带有 .grid 类的内容附加到“#container”块。我已经尝试过 load()、$.get() 和 $.ajax()。[小提琴](http://jsfiddle.net/almostemp/Y8Bkd/6/)。

即使它加载了内容，它也不会正确地将其放入“#container”块中（它将内容放在后台或其他地方）。我尝试再次调用 BlocksIt() 函数：

```
 $('#container').BlocksIt({
            numOfCol: 5,
            offsetX: 8,
            offsetY: 8
        }); 
```

没有帮助。我能做的最好的事情是（同样它不起作用）：

```
 link = 'http://www.inwebson.com/demo/blocksit-js/demo2/';
        $.get(link, function (data) {
            $(data).find(".grid").appendTo("#container");
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-09T02:23:08.803

如果您说要使用 blocksit 添加新块

我就是这样做的。它会很好地附加您以前的所有块

HTML

```
<div class="grid-layout">
    <div class="grid">content</div>
</div> 
```

JS

```
$(document).ready(function() {
    dynamicGrid();
});

function dynamicGrid()
{ 
    $('.grid-layout').BlocksIt({  
      numOfCol: 4,
      offsetX: 2,
      offsetY: 2,
      blockElement: '.grid',
    });        
}; 
```

这就是您在网格布局中获得并很好地附加它的方式

```
var url='your url to get data';

$.get( url, function(data) {
    $(".grid-layout").append(data);
    dynamicGrid();
}).fail(function(){
    alert('error');    
}) 
```

只需将上述内容放在您想要的任何位置，例如单击即可。

请记住，返回到 jquery get 的数据必须在 html 中，并且每个内容都在类网格中，例如

```
<div class="grid">content2</div>
<div class="grid">content3</div> 
```

它会很好地附加在内容下。

# hadoop - 无法使用 Apache Pig 过滤数据

> ID：15051032
> 
> 赞同：2
> 
> 时间：2013-02-24T10:53:05.803
> 
> 标签：hadoop, apache-pig

我在 Ubuntu 12.04 上使用 Hadoop 1.0.3、Pig 0.11.0。HDFS的part-m-00000文件内容如下

> training@BigDataVM:~/Installations/hadoop-1.0.3$ bin/hadoop fs -cat /user/training/user/part-m-00000
> 1,Praveen,20,India,M
> 2,Prajval,5,India,M
> 3，Prathibha，15，印度，F

我将它装入一个袋子，然后按如下方式过滤。

> 用户 1 = 加载 '/user/training/user/part-m-00000' 为 (user_id, name, age:int, country, gender);
> Fltrd = 按年龄 <= 16 过滤用户 1；

但是，当我转储**Users1** 5 记录时，控制台中会显示。但是，转储**Fltrd**将不会获取任何记录。

> 转储 Fltrd;

以下警告显示在 Pig 控制台中

> 2013-02-24 16:19:40,735 [main] WARN org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 遇到警告 ACCESSING_NON_EXISTENT_FIELD 12 次。

看起来我犯了一些简单的错误，但无法弄清楚它是什么。请帮我解决一下这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:05:03.933

由于您没有定义任何加载函数，Pig 将使用默认分隔符为**'\t' 的**[PigStorage](http://pig.apache.org/docs/r0.10.0/api/org/apache/pig/builtin/PigStorage.html)。

 **如果 part-m-00000 是文本文件，则尝试将分隔符设置为 ',' ：

```
Users1 = load '/user/training/user/part-m-00000' using PigStorage(',') 
  as (user_id, name, age:int, country, gender); 
```

如果它是一个 SequenceFile，那么看看 Dolan 或[我](https://stackoverflow.com/a/12301954)对[这个](https://stackoverflow.com/questions/12286845/apache-pig-load-a-file-that-shows-fine-using-hadoop-fs-text/12301954)问题的回答。**

# ios - 核心图：未显示附加轴

> ID：15051040
> 
> 赞同：1
> 
> 时间：2013-02-24T10:53:45.887
> 
> 标签：ios, objective-c, cocoa-touch, core-plot

为了显示零值，我在绘图空间中添加了一个额外的 x 轴：

```
CPTMutableLineStyle *boldLineStyle = [xAxis.axisLineStyle mutableCopy];
boldLineStyle.lineWidth = 1;
boldLineStyle.lineColor = [CPTColor darkGrayColor];
boldLineStyle.lineCap   = kCGLineCapRound;

CPTXYAxis *xZeroAxis = [[CPTXYAxis alloc] init];
xZeroAxis.coordinate = CPTCoordinateX;
xZeroAxis.plotSpace = plotSpace;
xZeroAxis.axisLineStyle = boldLineStyle; 
```

有趣的是，显示了这个轴上的标签，但没有显示轴本身：

```
xZeroAxis.axisLabels = [NSSet setWithArray:naLabels];
xZeroAxis.axisConstraints = [CPTConstraints constraintWithLowerOffset:0.0];
xyAxisSet.axes = @[xAxis, xLabelAxis, yAxis, xZeroAxis]; 
```

我需要如何更改代码以显示 x 轴？

谢谢！

![在此处输入图像描述](../Images/0cc0ec7abb1ac68ee1f5f06b0a36a4b0.png)

`x.axisLineStyle`设置如下：

```
CPTMutableLineStyle *axisLineStyle = [CPTMutableLineStyle lineStyle];
axisLineStyle.lineWidth = 1.0;
axisLineStyle.lineCap   = kCGLineCapRound;
axisLineStyle.lineColor = [CPTColor darkGrayColor];
CPTXYAxisSet *axisSet = (CPTXYAxisSet *)graph.axisSet;
CPPTXYAxis *x = axisSet.xAxis;
x.axisLineStyle = axisLineStyle; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:57:41.413

这似乎是当前 Core Plot 版本中的一个错误。该问题已在此处报告：[Core Plot Issue 514](https://code.google.com/p/core-plot/issues/detail?id=514&sort=-id)

# java-me - 从 lwiit 表单显示 lcudi.canvas

> ID：15051041
> 
> 赞同：1
> 
> 时间：2013-02-24T10:53:46.827
> 
> 标签：java-me, lwuit

我在一个包中有两个类，一个扩展 lcudi.Canvas，另一个扩展 lwuit.Form

我在表单上创建了两个按钮

我的目的是在按下其中一个按钮时显示画布。

在我看来，这个功能应该显示 canvas 。

设置全屏模式（真）；但事实并非如此。

这是画布类

```
 [code]

 import javax.microedition.midlet.*;
 import javax.microedition.lcdui.*;
 import javax.microedition.rms.*;
import javax.microedition.media.*;
import javax.microedition.media.control.*;
import java.io.*;
import java.util.*;
import javax.microedition.rms.*;
public class MainCanvas extends Canvas implements Runnable {

HelloLWUITMidlet  mid;
int screen_width;
int screen_height;
int mode;
int selected;
String current_time;
int[] time_numbers;
long current_time_milli;
long start_timestamp;
int selected_preset;
static String s;
Random generator;

final static int MODE_SETUP = 0;
final static int MODE_RUNNING = 1;
final static int MODE_RINGING = 2;
final static int MODE_PRESETS_TYPE = 3;
final static int MODE_PRESETS_MODE = 4;

public MainCanvas(HelloLWUITMidlet h) {
    mid =h;
    this.setFullScreenMode(true);
   new Thread(this).start();

    screen_width = this.getWidth();
    screen_height = this.getHeight();

    time_numbers = new int[4];
    setCurrentTime();
    initImages();
    generator = new Random(System.currentTimeMillis());
    mode = MODE_SETUP;
    selected = 0;
}

Image back;
Image numbers;
Image font;

int numberFontWidths[];
int numberFontOffsets[];
int numberFontCodes[];

int fontData[] = new int[]
{
    0, 0, 0, 0, 4,
    0, 0, 4, 16, 3,
    4, 0, 4, 16, 4,
    8, 0, 10, 16, 10,
    18, 0, 7, 16, 7,
    25, 0, 9, 16, 9,
    34, 0, 9, 16, 8,
    43, 0, 2, 16, 2,
    45, 0, 4, 16, 4,
    49, 0, 4, 16, 4,
    53, 0, 6, 16, 6,
    59, 0, 11, 16, 10,
    70, 0, 3, 16, 3,
    73, 0, 5, 16, 5,
    78, 0, 3, 16, 3,
    81, 0, 5, 16, 4,
    86, 0, 8, 16, 8,
    94, 0, 4, 16, 4,
    98, 0, 7, 16, 6,
    105, 0, 7, 16, 7,
    112, 0, 8, 16, 8,
    120, 0, 7, 16, 6,
    127, 0, 7, 16, 7,
    134, 0, 6, 16, 6,
    140, 0, 7, 16, 7,
    147, 0, 7, 16, 7,
    154, 0, 3, 16, 3,
    157, 0, 3, 16, 3,
    160, 0, 11, 16, 10,
    171, 0, 11, 16, 10,
    182, 0, 11, 16, 10,
    193, 0, 6, 16, 6,
    199, 0, 13, 16, 13,
    212, 0, 8, 16, 8,
    220, 0, 8, 16, 8,
    228, 0, 8, 16, 7,
    236, 0, 9, 16, 9,
    245, 0, 6, 16, 6,
    0, 16, 6, 16, 6,
    6, 16, 9, 16, 9,
    15, 16, 10, 16, 9,
    25, 16, 4, 16, 3,
    29, 16, 6, 16, 5,
    35, 16, 8, 16, 8,
    43, 16, 6, 16, 6,
    49, 16, 11, 16, 11,
    60, 16, 10, 16, 9,
    70, 16, 10, 16, 9,
    80, 16, 8, 16, 7,
    88, 16, 10, 16, 9,
    98, 16, 8, 16, 7,
    106, 16, 7, 16, 7,
    113, 16, 6, 16, 6,
    119, 16, 9, 16, 9,
    128, 16, 7, 16, 7,
    135, 16, 12, 16, 11,
    147, 16, 7, 16, 7,
    154, 16, 7, 16, 6,
    161, 16, 7, 16, 6,
    168, 16, 4, 16, 4,
    172, 16, 5, 16, 4,
    177, 16, 4, 16, 4,
    181, 16, 13, 16, 13,
    194, 16, 6, 16, 6,
    200, 16, 6, 16, 6,
    206, 16, 8, 16, 7,
    214, 16, 8, 16, 7,
    222, 16, 6, 16, 6,
    228, 16, 8, 16, 7,
    236, 16, 7, 16, 7,
    243, 16, 4, 16, 4,
    247, 16, 8, 16, 7,
    0, 32, 8, 16, 7,
    8, 32, 3, 16, 3,
    11, 32, 3, 16, 3,
    14, 32, 7, 16, 6,
    21, 32, 3, 16, 3,
    24, 32, 11, 16, 11,
    35, 32, 8, 16, 7,
    43, 32, 7, 16, 7,
    50, 32, 8, 16, 7,
    58, 32, 8, 16, 7,
    66, 32, 5, 16, 4,
    71, 32, 5, 16, 5,
    76, 32, 4, 16, 4,
    80, 32, 7, 16, 7,
    87, 32, 6, 16, 6,
    93, 32, 10, 16, 9,
    103, 32, 6, 16, 6,
    109, 32, 6, 16, 6,
    115, 32, 6, 16, 5,
    121, 32, 6, 16, 6,
    127, 32, 6, 16, 6,
    133, 32, 6, 16, 6,
    139, 32, 11, 16, 10
};

int[] fontCodes = new int[]
{
    0x0020,
    0x0021,
    0x0022,
    0x0023,
    0x0024,
    0x0025,
    0x0026,
    0x0027,
    0x0028,
    0x0029,
    0x002a,
    0x002b,
    0x002c,
    0x002d,
    0x002e,
    0x002f,
    0x0030,
    0x0031,
    0x0032,
    0x0033,
    0x0034,
    0x0035,
    0x0036,
    0x0037,
    0x0038,
    0x0039,
    0x003a,
    0x003b,
    0x003c,
    0x003d,
    0x003e,
    0x003f,
    0x0040,
    0x0041,
    0x0042,
    0x0043,
    0x0044,
    0x0045,
    0x0046,
    0x0047,
    0x0048,
    0x0049,
    0x004a,
    0x004b,
    0x004c,
    0x004d,
    0x004e,
    0x004f,
    0x0050,
    0x0051,
    0x0052,
    0x0053,
    0x0054,
    0x0055,
    0x0056,
    0x0057,
    0x0058,
    0x0059,
    0x005a,
    0x005b,
    0x005c,
    0x005d,
    0x005e,
    0x005f,
    0x0060,
    0x0061,
    0x0062,
    0x0063,
    0x0064,
    0x0065,
    0x0066,
    0x0067,
    0x0068,
    0x0069,
    0x006a,
    0x006b,
    0x006c,
    0x006d,
    0x006e,
    0x006f,
    0x0070,
    0x0071,
    0x0072,
    0x0073,
    0x0074,
    0x0075,
    0x0076,
    0x0077,
    0x0078,
    0x0079,
    0x007a,
    0x007b,
    0x007c,
    0x007d,
    0x007e
};

int[] fontKerning = new int[]
{
    70, 44, -1,
    70, 46, -1,
    76, 86, -1,
    76, 89, -1,
    80, 44, -2,
    80, 46, -2,
    84, 44, -1,
    84, 45, -1,
    84, 46, -1,
    84, 97, -1,
    84, 99, -1,
    84, 101, -1,
    84, 111, -1,
    84, 115, -1,
    86, 44, -1,
    86, 46, -1,
    87, 44, -1,
    87, 46, -1,
    89, 44, -2,
    89, 45, -1,
    89, 46, -2,
    89, 58, -1,
    89, 59, -1,
    89, 97, -1,
    89, 101, -1,
    89, 111, -1,
    114, 44, -1,
    114, 46, -1
};

int[] fontCodeTable;

public void initImages() {
    try{
      //  back = Image.createImage("/numbers.png");
        numbers = Image.createImage("/numbers.png");
        font = Image.createImage("/font.png");
        numberFontWidths = new int[]
        {
            17,10,15,15,18,15,16,15,15,16,8
        };

        int offset = 0;
        numberFontOffsets = new int[numberFontWidths.length];
        for(int i=0;i<numberFontWidths.length;i++) {
            numberFontOffsets[i] = offset;
            offset+=numberFontWidths[i];
        }

        numberFontCodes = new int[256];
        numberFontCodes[(int) "0".charAt(0)] = 0;
        numberFontCodes[(int) "1".charAt(0)] = 1;
        numberFontCodes[(int) "2".charAt(0)] = 2;
        numberFontCodes[(int) "3".charAt(0)] = 3;
        numberFontCodes[(int) "4".charAt(0)] = 4;
        numberFontCodes[(int) "5".charAt(0)] = 5;
        numberFontCodes[(int) "6".charAt(0)] = 6;
        numberFontCodes[(int) "7".charAt(0)] = 7;
        numberFontCodes[(int) "8".charAt(0)] = 8;
        numberFontCodes[(int) "9".charAt(0)] = 9;
        numberFontCodes[(int) ":".charAt(0)] = 10;

        fontCodeTable = new int[256];
        for(int i=0;i<fontCodes.length;i++)
            fontCodeTable[fontCodes[i]] = i;

    } catch(Exception e) {

    }
}

public void setCurrentTime() {
    current_time = "";
    for(int i=0;i<4;i++) {
        current_time = current_time + Integer.toString(time_numbers[i]);
     if(i==1)
    current_time = current_time + ":";
    }
}

public void run() {

    while(true) {
        update();
        Refresh();
        this.repaint();
        long nexttime = System.currentTimeMillis() +60;
        // set your framerate here
        while(System.currentTimeMillis() < nexttime)

            Thread.yield();
    }
}

int blinker;

public void update() {
    switch(mode) {
        case MODE_SETUP:
        case MODE_PRESETS_TYPE:
        case MODE_PRESETS_MODE:
            blinker++;
            break;
        case MODE_RUNNING:
            int left = (int) (current_time_milli - (System.currentTimeMillis() -  start_timestamp));
            if(left<=0) {
                playMidi();
                mode = MODE_RINGING;
            }
            int minutes = left / (60*1000);
            int seconds = (left-minutes*60*1000)/1000;
            String min_string = ""+minutes;
            if(min_string.length()==1)min_string = "0"+min_string;
            String sec_string = ""+seconds;
            if(sec_string.length()==1)sec_string = "0"+sec_string;
            current_time = min_string+":"+sec_string;
            break;
        case MODE_RINGING:
            blinker++;
            shake_x = (generator.nextInt()%5);
            shake_y = (generator.nextInt()%5);
            break;
    }
}

public void keyPressed(int key) {
    if(mode == MODE_SETUP) {
        int number_pressed = -1;
        if(key == KEY_NUM0)
            number_pressed = 0;
        if(key == KEY_NUM1)
            number_pressed = 1;
        if(key == KEY_NUM2)
            number_pressed = 2;
        if(key == KEY_NUM3)
            number_pressed = 3;
        if(key == KEY_NUM4)
            number_pressed = 4;
        if(key == KEY_NUM5)
            number_pressed = 5;
        if(key == KEY_NUM6 & selected != 2)
            number_pressed = 6;
        if(key == KEY_NUM7 & selected != 2)
            number_pressed = 7;
        if(key == KEY_NUM8 & selected != 2)
            number_pressed = 8;
        if(key == KEY_NUM9& selected != 2)
            number_pressed = 9;

        if(number_pressed>-1 & selected < 4) {
            time_numbers[selected] = number_pressed;
            selected++;
        } else {
            int action = getGameAction(key);
            if(action == UP) {
                if(selected<4) {
                    if(selected==2)
                        time_numbers[2] = (time_numbers[2]+1)%6;
                    else
                        time_numbers[selected] = (time_numbers[selected]+1)%10;
                } else {
                    if(selected>4)
                        selected--;
                    else
                        selected=0;
                }
            }
            if(action == DOWN) {
                if(selected<4) {
                    int new_val = time_numbers[selected]-1;
                    if(selected==2) {
                        if(new_val==-1)
                            new_val=5;
                    } else {
                        if(new_val==-1)
                            new_val=9;
                    }
                    time_numbers[selected] = new_val;
                } else {
                    selected++;
                    if(selected>6)
                        selected = 6;
                }
            }
            if(action == FIRE) {
                if(selected<4)
                    selected++;
                else {
                    if(selected==4) {
                        start_timestamp = System.currentTimeMillis();

                        int minutes = ((time_numbers[0]*10) + time_numbers[1]);
                        int seconds = ((time_numbers[2]*10) + time_numbers[3])+1;
                        current_time_milli = (minutes * 60 * 1000) + (seconds * 1000);
                        mode = MODE_RUNNING;
                    }
                    if(selected==5) {
                        selected=0;
                        mode = MODE_PRESETS_TYPE;
                    }
                    if(selected==6) {
                        mid.notifyDestroyed();
                    }
                }
            }
            if(action == LEFT & selected>0) {
                selected--;
            }
            if(action == RIGHT & selected<6)
                selected++;

        }
    } else if(mode==MODE_PRESETS_TYPE) {
        int action = getGameAction(key);
        if(action == UP && selected>0)
            selected--;
        if(action == DOWN && selected<2)
            selected++;
        if(action == FIRE) {
            selected_preset = selected;
            selected = 0;
            mode = MODE_PRESETS_MODE;
        }
    } else if(mode==MODE_PRESETS_MODE)
    {
        int action = getGameAction(key);
        if(action == UP && selected>0)
            selected--;
        if(action == DOWN && selected<1)
            selected++;
        if(action == FIRE) {
            int[] presets = new int[]
            {
                0,3,0,0,
                0,4,3,0,
                0,5,3,0,
                0,5,0,0,
                0,6,5,0,
                0,8,0,0,
            };
            int offset = selected * 12 + selected_preset * 4;

            time_numbers[0]=presets[offset++];
            time_numbers[1]=presets[offset++];
            time_numbers[2]=presets[offset++];
            time_numbers[3]=presets[offset++];

            mode = MODE_SETUP;
            selected = 4;
        }
    }

    else {
        int action = getGameAction(key);
        if(action==FIRE)
        {
            mode = MODE_SETUP;
            stopMidi();
        }
    }

    if(mode != MODE_RUNNING)
        setCurrentTime();
}

public void keyReleased(int key) {

}

int shake_x;
int shake_y;

public void paint(Graphics g) {
    int color = 0xFFFF00;

    if(mode == MODE_RINGING && (blinker%10>5))
        color = 0xFF0000;

    g.setColor(color);
    g.fillRect( 0, 0,screen_width  ,screen_height );
    Graphics gg  ;
    color = 0x00FF00;
    g.setColor(color);
    g.fillRect(0,50,50,0);
   color = 0x000FF;

    g.drawString( s ,40,50, 0);
    int x = (screen_width-128)>>1;
    int y = (screen_height-128)>>1;

    if(mode != MODE_PRESETS_TYPE && mode != MODE_PRESETS_MODE)
        paintNumbersCentered(g);

    switch(mode) {
        case MODE_SETUP:
            y = (screen_height>>1)+10;
            if(selected!=4 | (blinker%20>10)) {
                paintTextCentered(g,"START",y);
            }
            y+=15;
            if(selected!=5 | (blinker%20>10)) {
                paintTextCentered(g,"PRESETS",y);
            }
            y+=15;
            if(selected!=6 | (blinker%20>10)) {
                paintTextCentered(g,"EXIT",y);
            }
            break;
        case MODE_PRESETS_TYPE:
            y = (screen_height>>1)-10;
            if(selected!=0 | (blinker%20>10)) {
                paintTextCentered(g,"Supreme Runny",y);
            }
            y+=20;
            if(selected!=1 | (blinker%20>10)) {
                paintTextCentered(g,"Perfect Plasma",y);
            }
            y+=20;
            if(selected!=2 | (blinker%20>10)) {
                paintTextCentered(g,"Hard Boiled",y);
            }
            break;
        case MODE_PRESETS_MODE:
            y = (screen_height>>1)-15;
            if(selected!=0 | (blinker%20>10)) {
                paintTextCentered(g,"Eggs in cold water",y);
                y+=13;
                paintTextCentered(g,"Start when water is",y);
                y+=13;
                paintTextCentered(g,"boiling",y);

            }
            y = (screen_height>>1)+30;
            if(selected!=1 | (blinker%20>10)) {
                paintTextCentered(g,"Start when putting",y);
                y+=13;
                paintTextCentered(g,"eggs in boiling water",y);
            }
            break;
    }

}

public void paintNumbersCentered(Graphics g) {

    int width = 0;

    for(int i=0;i<current_time.length();i++) {
        int c = (int) current_time.charAt(i);
        width+=numberFontWidths[numberFontCodes[c]];
    }

    int x = (screen_width - width) >>1;
    int y = (screen_height >>1)-15;

    for(int i=0;i<current_time.length();i++) {
        int c = (int) current_time.charAt(i);
        int code = numberFontCodes[c];
        int char_w = numberFontWidths[code];
        int char_off = numberFontOffsets[code];

        int sel = selected;
        if(sel>1)sel++;

        if(sel!=i | (blinker%20>10)) {
            g.setClip(x+shake_x,y+shake_y,char_w,20);
            g.drawImage(numbers,x-char_off+shake_x,y+shake_y,0);
        }
        x+=char_w;
       }

       }
       public void Refresh()

      {

      Date t = new java.util.Date(System.currentTimeMillis());
      s = t.toString();

      }

public void paintTextCentered(Graphics g,String text,int y) {
    int width = 0;
    int textlen = text.length();
    for(int i=0;i<textlen;i++) {
        int code = fontCodeTable[(int)text.charAt(i)];
        int char_width = fontData[code*5+4];
        width+=char_width;
    }

    int x = (screen_width-width)>>1;
    int last_char = -1;

    for(int i=0;i<textlen;i++) {
        int this_char = (int)text.charAt(i);
        int code = fontCodeTable[this_char];
        int offset = code*5;
        int sx = fontData[offset++];
        int sy = fontData[offset++];
        int sw = fontData[offset++];
        int sh = fontData[offset++];
        int aw = fontData[offset++];

        if(i>0) {
            int koff = 0;
            int klen = fontKerning.length / 3;
            for(int k=0;k<klen;k++) {
                koff = k*3;
                if(last_char==fontKerning[koff] && this_char==fontKerning[koff+1]) {
                    x+=fontKerning[koff+2];
                    break;
                }
            }
        }

        if(sw>0 && sh>0) {
            g.setClip(x,y,sw,sh);
            g.drawImage(font,x-sx,y-sy,0);
        }
        x+=aw;
        last_char = (int)text.charAt(i);
    }

}

Player player = null;

public void stopMidi() {
    try{
        if(player!=null) {
            player.stop();
            player.deallocate();
        }
        player = null;
        System.gc();
    } catch(Exception e) {
        System.out.println(e.getMessage());
    }
}

public void playMidi() {
    try {
        stopMidi();
        player = Manager.createPlayer(this.getClass().getResourceAsStream("/ring.mid"),"audio/midi");
        player.realize();
        VolumeControl vc = (VolumeControl) player.getControl("VolumeControl");
        vc.setLevel(100);
        player.start();
    } catch(Exception e) {
        System.out.println(e.getMessage());
    }
}

protected void hideNotify() {

}

protected void showNotify() {

}
} 
```

[/代码]

那就是表格

```
[code]
import Pes.*;
//import Pes.MainCanvas;
import javax.microedition.lcdui.*;
import javax.microedition.midlet.*;
import com.sun.lwuit.layouts.*;
 import com.sun.lwuit.*;
 import javax.microedition.lcdui.Canvas;
 import com.sun.lwuit.events.*;
   import com.sun.lwuit.plaf.*;
  public class HelloLWUITMidlet extends MIDlet implements ActionListener {
   HelloLWUITMidlet hh;

   public void startApp() {
  com.sun.lwuit.Display.init(this);

   final    com.sun.lwuit.Form f = new com.sun.lwuit.Form( " SOFTWARE SCREENS");

   final   MainCanvas    m = new MainCanvas(hh);
    f.getStyle().setBgColor(0X99CCFF);
   BoxLayout boxlayout =new BoxLayout(BoxLayout.X_AXIS);

   com.sun.lwuit.Command exitCommand = new com.sun.lwuit.Command("Exit");
  f.addCommand(exitCommand);
  f.addCommandListener(this);

  final  Button button = new Button("  GOALS  ");
  final  Button button1 = new Button("  TIME SETTING");

   Style btnstyle = button.getSelectedStyle() ;
   Style btnstyle1 = button1.getSelectedStyle() ;
   btnstyle.setBgColor(0X0000FF);
    btnstyle.setFgColor(0XFFFFFF);
  btnstyle1.setBgColor(0X0000FF);
  btnstyle1.setFgColor(0XFFFFFF);
  // button.getStyle().setBgColor(0X99CCFF);

    button1.addActionListener(new ActionListener() {
   private int c = 0;
   public void actionPerformed(ActionEvent ae) {
    c++;
     // Display.init(m);
     m.setFullScreenMode(true);

          }
       });

     button.addActionListener(new ActionListener() {
      private int c = 0;
     public void actionPerformed(ActionEvent ae) {
       c++;

      m.setFullScreenMode(true);

        }
            });
         f.addComponent(button1);
           f.addComponent(button);
            f.show();
            }

              public void pauseApp() {}

           public void destroyApp(boolean unconditional) {}

             public void actionPerformed(ActionEvent ae) {
               notifyDestroyed();
               }

                 }

   [/code] 
```

**注意：-** 如果您需要我的代码中包含的图像和声音来测试我的应用程序，您可以从这里下载 eggtime 应用程序 [http://www.bambalam.se/eggtimer/](http://www.bambalam.se/eggtimer/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T07:10:10.437

你正在混合`lwuit`和`javax.microedition`编码在一起。

这就是为什么您需要将控制权转移到另一个控制`lwuit` `Display`权的原因`javax.microedition.Display`。为此，您需要 在`javax.microedition.lcdui.Display.getDisplay(hh).setCurrent(m);` 调用.`setFullScreenMode``actionListener`

# c++ - 如何在 QGraphicsScene 上获取 XY 点的颜色？

> ID：15051045
> 
> 赞同：0
> 
> 时间：2013-02-24T10:54:46.130
> 
> 标签：c++, qt, colors, qgraphicsscene

这似乎微不足道，但找不到解决方案。我需要在 QGraphicsScene 上读取某个 x,y 点的颜色。就像是`graphScen->colorAt(x,y);`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-05T07:54:59.293

QGraphivsScene 不知道点上的颜色，而且它并不是微不足道的（您在场景和项目上都有转换）。您可以做的是访问渲染场景的像素图并访问那里的像素信息。

```
QPixmap paintDevice(sceneBoundingRect());
QPainter painter(&paintDevice);
graphScen->render(painter);
// Now you have the pixmap, get the pixel information.
QImage pixels = paintDevice.toImage();
QRgb colorAt = pixels.pixel(x,y); 
```

完毕。

# c# - IList 和 IList 的比较 - should any be preferred? Since many years, we use generic collections most of the time. Sometimes we really do need a collection of anything (well, usually only a few different things but with no common base c 问问题 问问题 2013-02-24T10:54:51.200 442 次 This question shows research effort; it is useful and clear 3 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. Since many years, we use generic collections most of the time. Sometimes we really do need a collection of anything (well, usually only a few different things but with no common base class). For such circumstances we can use either IList or the generic IList as type for method arguments and properties. Is there any reason to prefer one over the other? Performance characteristics? Personally, I'm leaning towards IList, as I think this makes it more clear that we really do accept "anything". When a parameter is typed as IList we cannot immediately tell if this method do accept anything, or if the lack of generics is due to history or sloppy coding. There's a good reason: LINQ and its extension methods. These aren't implemented for pre-generics era types. You will need to call Cast <t>on the IList to take advantage of LINQ! Other point is that, since newest .NET versions support covariance and contravariance and most of generic interfaces support one or the other (f.e. IEnumerable<out t="">, T is covariant), you can easily downcast or upcast interfaces' generic parameters from and to object or a less-unspecific type. Conclusion: why generics should be prefered? Generic types have better performance because they avoid a lot of casts. Newer APIs rely on generic collections and interfaces. There're a lot of reasons to think that mixing objects of different types in the same list could be dangerous and a bad coding/design decision. And for the few cases where you'll store any kind of object, having LINQ and many other newer APIs and features as your friend is a powerful reason to don't reinvent wheels and save a lot of time! c#generics 4 1 回答 1 This answer is useful 5 有一个很好的理由：LINQ 及其扩展方法。这些不适用于泛型之前的时代类型。您需要调用Cast<t>LINQ IList！ 另一点是，由于最新的 .NET 版本支持协变和逆变，并且大多数泛型接口都支持其中一种（feIEnumerable<out t="">是T协变的），因此您可以轻松地将接口的泛型参数向下转换或向上转换到对象或不特定的对象类型。 结论：为什么应该首选泛型？ 泛型类型具有更好的性能，因为它们避免了很多强制转换。 较新的 API 依赖于通用集合和接口。 有很多理由认为在同一个列表中混合不同类型的对象可能是危险的，并且是一个糟糕的编码/设计决策。对于您将存储任何类型的对象的少数情况，拥有 LINQ 和许多其他较新的 API 和功能作为您的朋友是不重新发明轮子并节省大量时间的有力理由！ 于 2013-02-24T11:17:03.940 回答 Related 1 mysql - mysql正确索引位置和组 1 algorithm - 访问无向图中的边、顶点 2 php - 获取 %'s 最常用的行值 4 javascript - 为什么单个 var 在 javascript 中很好用？ 3 iphone - iOS - backbarButtonItem：取消返回？ 2 java - 从数据库中获取状态 0 asp.net - 发送模型以供从布局链接的所有视图中使用 1 php - 读取 Wordpress 数据库数据 4 git - 如何为网站设置混合 (S)FTP + Git 工作流程 2 android - 集成 AdMob 时出现资源未找到异常 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：15051046
> 
> 赞同：3
> 
> 时间：
> 
> 标签：c#, generics

Since many years, we use generic collections most of the time. Sometimes we really do need a collection of anything (well, usually only a few different things but with no common base class). For such circumstances we can use either `IList` or the generic `IList<object>` as type for method arguments and properties.

Is there any reason to prefer one over the other? Performance characteristics?

Personally, I'm leaning towards `IList<object>`, as I think this makes it more clear that we really do accept "anything". When a parameter is typed as `IList` we cannot immediately tell if this method do accept anything, or if the lack of generics is due to history or sloppy coding.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T11:17:03.940

有一个很好的理由：LINQ 及其扩展方法。这些不适用于泛型之前的时代类型。**您需要调用`Cast<T>`LINQ `IList`！**

另一点是，由于最新的 .NET 版本支持协变和逆变，并且大多数泛型接口都支持其中一种（fe`IEnumerable<out T>`是`T`协变的），因此您可以轻松地将接口的泛型参数向下转换或向上转换到对象或不特定的对象类型。

结论：为什么应该首选泛型？

*   泛型类型具有更好的性能，因为它们避免了很多强制转换。
*   较新的 API 依赖于通用集合和接口。
*   有很多理由认为在同一个列表中混合不同类型的对象可能是危险的，并且是一个糟糕的编码/设计决策。对于您将存储任何类型的对象的少数情况，拥有 LINQ 和许多其他较新的 API 和功能作为您的朋友是不重新发明轮子并节省大量时间的有力理由！</out></t></out></t>

# dynamics-crm-2011 - 增强基于 MS Dynamics CRM 角色的安全模型

> ID：15051052
> 
> 赞同：1
> 
> 时间：2013-02-24T10:55:53.063
> 
> 标签：dynamics-crm-2011, dynamics-crm

我需要使用更多过滤条件来增强基于 MS CRM 角色的安全模型。即除了业务单元访问级别之外，我还需要添加位置访问级别、团队访问级别和其他一些基于自定义实体的访问层。

我浏览了互联网和 MS CRM 2011 SDK，但没有找到一个示例，我可以如何增强基于角色的安全模型。是否可以？

如果是的话，你能举例说明我如何做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T15:32:33.213

在 CRM 2011 中，您在安全模型中有更多选择：

1.  你有[团队](http://msdn.microsoft.com/en-us/library/gg328485.aspx)的概念，可以有来自不同业务部门的用户
2.  您有[security-field](http://msdn.microsoft.com/en-us/library/gg309608.aspx)，以增强字段的安全性

请参阅此处CRM 2011 中所有选项的[简历](http://msdn.microsoft.com/en-us/library/gg309524.aspx)。另请参阅[本文](http://nishantrana.wordpress.com/2011/09/24/security-roles-and-privileges-in-crm-2011-new-features/)。

您拥有的另一个选择是使用 Javascript 添加更多条件：

*   [http://www.powerobjects.com/blog/2011/10/20/how-to-hide-a-button-on-the-ribbon-in-dynamics-crm-2011/](http://www.powerobjects.com/blog/2011/10/20/how-to-hide-a-button-on-the-ribbon-in-dynamics-crm-2011/)
*   [http://blogs.infinite-x.net/2010/11/16/retreiving-user-roles-in-crm-2011/](http://blogs.infinite-x.net/2010/11/16/retreiving-user-roles-in-crm-2011/)
*   [http://crmdm.blogspot.pt/2011/03/how-to-hide-show-tab-in-crm-2011-using.html](http://crmdm.blogspot.pt/2011/03/how-to-hide-show-tab-in-crm-2011-using.html)
*   [http://crmdm.blogspot.pt/2011/02/how-to-hide-control-in-ms-crm-2011.html](http://crmdm.blogspot.pt/2011/02/how-to-hide-control-in-ms-crm-2011.html)

# mysql - 如何在表格中获得相关性分数

> ID：15051053
> 
> 赞同：0
> 
> 时间：2013-02-24T10:55:53.423
> 
> 标签：mysql, sql-order-by, relevance

我有一个带有游戏类型标签的 mysql 表，比如

表`game_typetags`：

```
 name   typetag
--------- --------
 game#1    sports
 game#1    soccer
 game#2    race
 game#2    sports 
```

`games`和另一张桌子

```
 name   playcount 
--------- --------- 
 game#1      10      
 game#2      8 
```

我想列出相关的游戏（用常见类型标签的数量给它们打分）并用 playcount 排序。

所以我试图在 PHP 中得到这样一个数组：

```
function getSimilarGames($typetags_array)
{
$pdo->query("SELECT * FROM games COUNT (*) AS ???? ORDER BY games.playcount DESC");
} 
```

所以当我用 调用这个函数时`$typetags = [race,sports]`，它应该返回

```
name   score
____   _____
game#2   2
game#1   1 
```

我应该为此使用什么查询？谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:31:57.640

我不同意您的数据库设计，您应该尝试对其进行规范化，但以下代码适用于您的设计：

```
SELECT games.name, COUNT(1) score
FROM games
INNER JOIN game_typetags ON game_typetags.name = games.name
WHERE game_typetags.typetag IN ('race', 'sports')
GROUP BY games.name
ORDER BY score DESC 
```

我建议这样的设计；

```
game
-------
id integer pk
name varchar

typetag
-------
id integer pk
tagname varchar

game_typetags
-------
game_id int pk
typetag_id int pk 
```

使用这种设计，您可以使用 ID 将表连接在一起，而不是在任何地方使用字符串。

从中获取所需数据的查询可能如下所示，请注意，您甚至可以使用标记 ID 使其更快（在数据库中处理主键而不是 where 子句中的字符串比较）

```
SELECT game.id, game.name, game.playcount, COUNT(1) score
FROM game
INNER JOIN game_typetags gtt ON gtt.game_id = game.id
INNER JOIN typetag tt ON tt.id = gtt.typetag_id
WHERE tt.typetag IN ('race', 'sports')
GROUP BY game.id
ORDER BY score DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:09:27.077

我想出了一个解决这个问题的方法，如下：

```
SELECT name, SUM(matches) as relevance_score FROM
(
SELECT
  game_typetags.*,
    (typetag =  'race'  )
+    (typetag =  'sports'  )
    AS matches
FROM game_typetags HAVING matches>0
ORDER BY matches DESC 
) a GROUP BY name ; 
```

# jquery - jQuery中的document.load和window.ready有什么区别

> ID：15051058
> 
> 赞同：-6
> 
> 时间：2013-02-24T10:56:42.557
> 
> 标签：jquery

以下有什么区别。

```
$(window).load(function(){...}); 

$(document).ready(function(){...}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T10:58:46.490

document.ready 在文档本身完成加载时发生， window.load 在加载所有资产时发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T10:58:58.787

> 当 HTML 文档被加载并且 DOM 准备就绪时，文档就绪事件已经执行，即使所有的图形还没有加载。如果您想在窗口加载之前为某些元素连接事件，那么 $(document).ready 是正确的地方。
> 
> 窗口加载事件在整个页面完全加载后执行，包括所有框架、对象和图像。因此，涉及图像或其他页面内容的功能应放置在窗口或内容标签本身的加载事件中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T10:59:24.957

load 在所有资产（包括图像）完成加载后调用。当 DOM 准备好交互时触发 ready。

# ruby-on-rails - 带有下拉框整数值的 ActiveRecord 发布错误

> ID：15051060
> 
> 赞同：0
> 
> 时间：2013-02-24T10:56:56.257
> 
> 标签：ruby-on-rails, activerecord

我要疯了。我有一个带有下拉框的表单

```
<select name="user[interest1]">
<option value="1">Something</option>
<option value="2">Another Something</option>
<option value="3">Another Something^3</option>
</select> 
```

发布此内容应使用字段“interest1”上的整数更新用户模型。发送表单时出现此错误：

```
Interest1(#70226795163000) expected, got String(#70226775629700)

Request

Parameters:

{"utf8"=>"✓",
 ...
 "interest1"=>"3"},
 "commit"=>"Update"} 
```

好的，这是一个正在发布的字符串，尽管它应该是一个整数。很简单，我想所以我要在我的控制器中捕获该参数并将其设为整数：

```
params[:user][:interest1] = params[:user][:interest1].to_i 
```

现在我明白了：

```
Interest1(#70226795828040) expected, got Fixnum(#70226775624220)

Request

Parameters:

{"utf8"=>"✓",
 ...
 "interest1"=>3},
 "commit"=>"Update"} 
```

尽管这是我真正期望的，但它不会在我的数据库中更新。我做错了什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:27:24.147

似乎您有一个与用户关联的 Interest1 模型，并且您正在尝试使用关联 ID 分配给该关联。如果是这种情况，那么您希望该字段为 interest1_id 并将其添加到用户的 attr_accessible。

如果没有，那么您能否发布您的用户模型。

# android - 滑动和滚动一起工作

> ID：15051061
> 
> 赞同：4
> 
> 时间：2013-02-24T10:57:11.143
> 
> 标签：android

我正在制作一个应用程序，其中有一个文本视图（占用了我的大部分活动）。Textview 跨多个页面显示大量文本（页面只不过是分配给字符串数组的大文本，并且每个数组元素都显示在页面更改触发器上）。我使用下面线程中的代码来介绍右/左滑动以在页面之间导航。

[Android：如何处理从右到左的滑动手势](https://stackoverflow.com/questions/4139288/android-how-to-handle-right-to-left-swipe-gestures)

以下是我在全部中使用的确切代码。

```
public class OnSwipeTouchListener extends Activity implements OnTouchListener{

private final GestureDetector gestureDetector = new GestureDetector(getBaseContext(), new GestureListener());

public boolean onTouch(final View v, final MotionEvent event) {
    //super.onTouch(v, event);
    return gestureDetector.onTouchEvent(event);
}

private final class GestureListener extends SimpleOnGestureListener {

    private static final int SWIPE_THRESHOLD = 100;
    private static final int SWIPE_VELOCITY_THRESHOLD = 100;

    @Override
    public boolean onDown(MotionEvent e) {
        return true;
    }

    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
        boolean result = false;
        try {
            float diffY = e2.getY() - e1.getY();
            float diffX = e2.getX() - e1.getX();
            if (Math.abs(diffX) > Math.abs(diffY)) {
                if (Math.abs(diffX) > SWIPE_THRESHOLD && Math.abs(velocityX) > SWIPE_VELOCITY_THRESHOLD) {
                    if (diffX > 0) {
                        onSwipeRight();
                    } else {
                        onSwipeLeft();
                    }
                }
            } 
        } catch (Exception exception) {
            exception.printStackTrace();
        }
        return result;
    }
}

public void onSwipeRight() {
}

public void onSwipeLeft() {
} 
```

然后这就是我在活动中使用这个类的方式

```
 myTextView.setOnTouchListener(new OnSwipeTouchListener() {
        public void onSwipeRight() {
            displayPreviousPage() //code to display previous page
        }
        public void onSwipeLeft() {
            displayNextPage()  //code to display next page
        }
    }); 
```

到目前为止一切正常。现在我想为我的文本视图启用垂直滚动，以防我的文本超出屏幕高度。因此，我在代码中添加了以下行来做同样的事情。

```
myTextView.setMovementMethod(new ScrollingMovementMethod()); 
```

但这似乎不起作用。任何建议为什么？是不是我在 OnSwipeTouchListener 类中重写了 onFling 方法，并且 setMovementMethod 也使用相同的（onFling 方法）来实现它？

# postgresql - 如何保存 PostgreSQL 架构？

> ID：15051064
> 
> 赞同：0
> 
> 时间：2013-02-24T10:57:32.200
> 
> 标签：postgresql, schema

我需要将 PostgreSQL 数据库的模式发送给客户。
我怎样才能做到这一点？
我在 db 目录中找不到它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-24T11:00:11.027

最好使用[pg_dump](http://www.postgresql.org/docs/8.1/static/app-pgdump.html)实用程序导出模式并重新加载到另一台机器上：

```
pg_dump -U postgres --schema-only db_name > file.txt 
```

[然后您可以使用psql](http://www.postgresql.org/docs/9.2/static/app-psql.html)实用程序将其加载回另一台机器/实例：

```
psql -U postgres db_name < file.txt 
```

# android - 如何在首次启动安卓应用程序时下载本地化文件

> ID：15051067
> 
> 赞同：0
> 
> 时间：2013-02-24T10:58:06.333
> 
> 标签：android, localization

我有一个关于位置文件的查询。我想在启动 android 应用程序时从服务器（string.xml、string_ar.xml 等）下载本地化文件，而不是之前声明。有什么办法可以完成这个任务..

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:05:16.943

如果您想知道应用程序是第一次运行，您可以在首选项中保存一个布尔值。类似的东西`first_run`。

如果您下载本地化文件，您将无法使用默认的本地化支持。（不知道你为什么不把它们放在 apk 中）

您可以做的是获得本地化并访问服务器以获得正确的翻译。您可以创建自己的类来处理获取字符串，如果它们不存在，则故障转移 android 类。

就像是：

```
public static String getString(Context ctx, int key) {
  String ret = getStringFromDB(key);
  if ( ret == null ) {
    ret = ctx.getString(key);
  }

  return ret;
} 
```

# sql - SQL查询寻找一个朋友最多的人？

> ID：15051068
> 
> 赞同：3
> 
> 时间：2013-02-24T10:58:12.373
> 
> 标签：sql, sqlite

我有一张朋友表，它有两列，**id1**是学生的 id，**id2**是学生 id2 的 id。

好友
列名：id1 -> id2

我必须找到有最多朋友的学生。

我以这种形式获取数据：
person(id) --> pp 和 ppp 中的朋友数，
通过在朋友上应用 group by
并且对于该子查询，我选择计数最高的学生。

这是我的查询：

```
select * from
(select kk.id1 as id3, count(*) as b from friend kk group by kk.id1) pp
where not exists 
(select * from
  (select kk1.id1 as id2, count(*) as b1 from friend kk1 group by kk1.id1) ppp
 where ppp.b1 > pp.b ) 
```

这是一个简单的查询，但我得到的结果不正确。谁能指出我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T18:26:06.797

确实是个好问题。我已经重新格式化了您的查询以使其更具可读性，并且我已经在 SQL Server 和 SQLite 中对其进行了测试。在 SQL Server 中，查询的行为似乎符合预期，但在 SQLite 中则不然。我找不到任何解释（还），仍在努力......

```
SELECT *
FROM   (SELECT F1.id1 as id3,
               count(*) as Count1
        FROM   Friend AS F1
        GROUP BY F1.id1) sub1
WHERE  NOT EXISTS ( SELECT *
                    FROM   (SELECT F2.id1 as id2,
                                   count(*) as Count2
                            FROM   Friend AS F2
                            GROUP BY F2.id1) sub2
                    WHERE  sub2.Count2 > sub1.Count1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:00:19.670

```
SELECT  A, COUNT(*) totalFriends
FROM
        (
            SELECT ID1 A, ID2 B FROM Friend
            UNION
            SELECT ID2 A, ID1 B FROM Friend
        ) s
GROUP   BY A
ORDER   BY totalFriends DESC
LIMIT 1 
```

# php - 可点击的链接 imagecreatefrompng

> ID：15051071
> 
> 赞同：0
> 
> 时间：2013-02-24T10:58:28.973
> 
> 标签：php, image

此时我正在尝试创建一个动态 PHP 图像，我不确定是否可以在以下代码中包含可点击的链接：

```
<?php
$image = "hotelview_val13.png";
$src = 'pixel.png';
putenv('GDFONTPATH=' . realpath('.')); 
$font = 'font.ttf';  //Ubuntu font
$im = imagecreatefrompng($image);

imagealphablending($im, true);
imagesavealpha($im, true);

imagealphablending($src_to_copy, true);
imagesavealpha($src_to_copy, true);

imagealphablending($pg, true);
imagesavealpha($pg, true);

$wc = ImageColorAllocate ($im, 255, 255, 255);
$red = ImageColorAllocate ($im, 255, 0, 0);
$blk = imagecolorallocate($im, 0, 0, 0);

{
    imagettftext($im, 12, 0, 45, 310, $blk, $font , "<A HREF=\"link.php\"     TARGET=\"_blank\">Link</A>");
    imagettftext($im, 12, 0, 45, 330, $blk, $font , "Veel plezier ;)");
}

header("Content-Type: image/png");
Imagepng($im);
ImageDestroy ($im);
?> 
```

我想要做的是制作一个可点击的链接。我试图只是简单地放入代码中，但这不起作用，因为它将代码显示为纯文本。是否可以？如果是，它是如何工作的？

非常感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:02:05.223

您不能在图像中嵌入链接。在浏览器中查看时，使图像区域可点击的唯一方法是使用 HTML [`map`](https://developer.mozilla.org/en-US/docs/HTML/Element/map)。

# php - 如何在 php 中不使用全局包含文件

> ID：15051078
> 
> 赞同：-2
> 
> 时间：2013-02-24T10:59:04.853
> 
> 标签：php

如何在不使用全局包含文件的情况下简化以下代码中的类包含。

```
enter code here
<?php
 include "class/class.Prode.php";
 include "class/class.Groupes.php";
 include "class/class.Pages.php";
 include "class/class.Links.php";
 $prod = new Prode;
 $group = new Groups;
 $page = new Pages;
 $link = new Links;
 ?> 
```

请解释并参考描述这一点的文章。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T11:06:12.663

你想看看 PHP 的 Autoload： http: [//php.net/manual/en/language.oop5.autoload.php](http://php.net/manual/en/language.oop5.autoload.php)

它将极大地帮助简化您的包含过程！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:06:07.080

使用PHP 手册中描述的类的[自动加载。](http://www.php.net/manual/en/language.oop5.autoload.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T11:11:27.200

您需要使用 PHP 的自动加载功能，我在下面为您提供了一个示例。

```
function __autoload($class_name) {
$class_name = strtolower($class_name); // you may need to omit this or rename your files
$file =  "class.{$class_name}.php";
$directory = "/path/to/your/class/directory/";

if($full_path = recursive_file_exists($file, $directory)) {
    require($full_path);
} else {
    // check if it exists with an s on the end
            // a nice fallback to cover forgetfulness
    $file =  "class.{$class_name}s.php";
    if($full_path = recursive_file_exists($file, $directory)) {
        require($full_path);
    } else {
        die("The file class.{$class_name}.php could not be found in the location ".$directory);
    } 
```

希望对您有所帮助。

# c++ - C++：如何使用 qsort 对二维数组进行排序？

> ID：15051079
> 
> 赞同：-7
> 
> 时间：2013-02-24T10:59:12.700
> 
> 标签：c++, 2d, quicksort, qsort

```
Example:     Result:

[9,1]        [0,5]
[5,2]        [2,4]
[6,3]        [5,2]
[2,4]        [6,3]
[0,5]        [9,1] 
```

我知道意义在于比较功能。如何按升序或降序排序。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:07:50.500

`std::sort`从`<algorithm>`标题使用

您可以使用 lambda 表达式作为比较函数

# java - 我可以分配的最大 jvm 内存

> ID：15051084
> 
> 赞同：-2
> 
> 时间：2013-02-24T10:59:42.687
> 
> 标签：java

我正在使用 512 mb 内存。我知道我们可以通过传递两个参数来增加 jvm 堆内存..

我可以为 512 mb ram 的参数提供的最大值是多少才能`-Xmx`顺利运行系统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:39:08.307

这取决于您正在运行的其他内容。如果可用 RAM 用完，操作系统将交换到磁盘。如果您稍微过度使用 RAM，则交换到磁盘的东西可能是未使用的东西，并且不会造成太大伤害。

如果您过多地使用 RAM，系统将在硬盘驱动器上搅动，一切都会慢得难以忍受。互联网上的人无法猜测这个精确点在您的计算机上可能是什么，因此您只需尝试`-Xmx`参数的各种值即可找出断点在哪里。

# c - 当 c 是 char 时使用 scanf("%d", &c) 会发生什么？

> ID：15051089
> 
> 赞同：1
> 
> 时间：2013-02-24T11:00:12.650
> 
> 标签：c, types

代码是这样的：

```
char c;  
scanf("%d", &c); 
```

输入 3...

我的猜测是，当`3`输入时，它是 type `int`；
然后类型降级为 char 并分配给`c`;

`c`我在说明符中打印了`%d`3 的值，似乎与预期的一样；
但是在终端上打印`c`带有说明符的值会`%c`产生--空白--这是一个问题...（1）；
为了测试更多，我还声明了一个`ch`带有类型的变量`char`并像这样初始化它：

```
char ch = 1; 
```

测试是这样的：

```
(i&j)? printf("yes") : printf("no"); 
```

结果是“否”
我打印出 的值`i&j`，`0`
但`1&3`应该是`1`？这是另一个问题....(2);
我的问题是（1）和（2）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T11:22:08.710

您实际上是在调用未定义的行为。

通过使用格式 string `%d`，您告诉`scanf`期望 an`int*`作为参数，并且您将向它传递一个指向单个字符的指针。请记住，`scanf`与您在格式字符串中输入的内容相比，您传递的内容没有更多的类型信息。

这将导致`scanf`尝试`int`在指向`char`大小保留的地址处将大小值写入内存，可能（并且对于大多数体系结构）写入越界。

调用 UB 后，您进一步计算的所有赌注都将取消。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T12:17:19.390

Suppose that scanf() were not a varargs-function, but a plain ordinary function taking a pointer-to-int as the 2nd argument:

```
int noscanf(char *format, int *ptr)
{
  *ptr = 42;
  return 1;
}

int main(void)
{
  char ch;
  int rc;

      // This should *at least* give a warning ...
  rc = noscanf("Haha!" , &ch); 

  return 0;
} 
```

Now, scanf() **is** a varargs function. The only way for scanf() to determine the type of the (pointer) arguments is by inspecting the format string. And a %d means : the next argument is supposed to be a pointer to int. So scanf can happily write `sizeof(int)` bytes to *ptr.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T11:08:04.457

我在那里看不到变量`j`。所以`i&j`将是 0。是的，如果`i == 1`然后。`j == 3``i & j == 1`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T11:20:17.510

(i&j)? printf("是") : printf("否");
语句给出输出是，对于 i=1 和 j=3。

对于 (1) 问题，ASCII 3 适用于不可打印的 STX char。

# python - PyQt4 嵌套类 - “RuntimeError：底层 C/C++ 对象已被删除”

> ID：15051090
> 
> 赞同：1
> 
> 时间：2013-02-24T11:00:14.900
> 
> 标签：python, pyqt4

我正在尝试构建一个很酷的应用程序，但似乎我缺乏一些知识。阅读互联网上的大量信息和示例，但无济于事： [Understanding the "underlying C/C++ object has been deleted" 错误](https://stackoverflow.com/questions/6002895/understanding-the-underlying-c-c-object-has-been-deleted-error)

* * *

好的，这就是我所做的：

我从我的*main.py*创建中央小部件，它工作正常，我没有在这里完全发布：

```
self.rw = ReportWidget()
self.setCentralWidget(self.rw) 
```

这是我的中心小部件*-report.py*：

```
#! /usr/bin/env python
# -*- coding: utf-8 -*-

from PyQt4 import QtGui, QtCore

class ReportWidget(QtGui.QWidget):
    def __init__(self, parent=None):
        super(ReportWidget, self).__init__(parent)
        self.setup_ui()

    def setup_ui(self):
        report = QtGui.QVBoxLayout(self)
        report.setAlignment(QtCore.Qt.AlignTop)

        head = QtGui.QHBoxLayout()
        add_label = QtGui.QLabel(u"Add")
        head.addWidget(add_label)

        report.addLayout(head)

        area = QtGui.QScrollArea()
        area.setWidgetResizable(True)
        area.setEnabled(True)
        layout = QtGui.QVBoxLayout()
        layout.setAlignment(QtCore.Qt.AlignTop)
        widget = QtGui.QWidget()
        widget.setLayout(layout)
        area.setWidget(widget)
        report.addWidget(area)

        self.s = layout

        # trying to create first line:
        first_line = Line(self)
        self.s.addWidget(first_line)        
        first_line.set_controls(True, False)

        head = QtGui.QHBoxLayout()
        ok = QtGui.QPushButton(u"Calculate")

        head.addWidget(ok)
        report.addLayout(head) 
```

继续同一个文件*report.py*：

```
class Line(QtGui.QWidget):
    def __init__(self, parent=None):
        super(Line, self).__init__(parent)
        self.setup_ui(parent)

    def setup_ui(self, parent):
        add_button = QtGui.QPushButton()
        add_button.setObjectName("add_button")

        self.add_button = add_button
        self.layout = QtGui.QHBoxLayout(line)
        self.layout.addWidget(add_button)

    def set_controls(self, add_button=True, remove_button=True):
        self.add_button.setEnabled(add_button) 
```

因此，运行*main.py*`RuntimeError: underlying C/C++ object has been deleted`会在我尝试将参数设置为新按钮的最后一段代码上引发错误`setEnabled`，就好像它从未在任何地方创建或绑定一样。

看来我有一些设计缺陷。也许在一个文件中有不同的类是错误的想法？或者也许我不太控制哪个小部件有哪个父级以及布局如何工作。

* * *

感谢您的阅读。祝你今天过得愉快！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T12:55:35.157

感谢所有试图回答的人！不幸的是，没有人说我写了一堆废话！*微笑*

My`line`已经是一个小部件，我不需要在其内部创建自己。我所要做的就是在里面创建布局`setup_ui`并向其中添加小部件。最后它看起来像：

```
class Line(QtGui.QWidget):
    def __init__(self, parent=None):
        super(Line, self).__init__(parent)
        self.setup_ui(parent)

    def setup_ui(self, parent):
        line = QtGui.QHBoxLayout(self)

        add_button = QtGui.QPushButton()
        add_button.setObjectName("add_button")

        line.addWidget(add_button)

        # to get reference from outside
        self.add_button = add_button

    def set_controls(self, add_button=True, remove_button=True):
        self.add_button.setEnabled(add_button) 
```

特别感谢[nymk](https://stackoverflow.com/users/779412/nymk)和[Avaris](https://stackoverflow.com/users/843822/avaris)！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:53:29.220

我无法使用您向我们展示的代码重现错误（除了关于`line`未在 中定义的变量的错误`Line.setup_ui`）。如果我替换`line`为`self`，我没有错误。

但是，如果我设置`line`为`QWidget`我创建的 a 并且没有保留对它的引用，我可能会崩溃。换句话说，我添加了

```
 line = QtGui.QWidget() 
```

to `Line.setup_ui`，并发现这在您报告的同一行代码上崩溃，抱怨包装的 C/C++ 对象已被删除。

# java - Java 毫秒到纳秒

> ID：15051096
> 
> 赞同：0
> 
> 时间：2013-02-24T11:00:51.230
> 
> 标签：java

我刚开始学习Java，我想制作随机数组并测量时间。我`System.currentTimeMillis();`在填充数组的开始时使用，然后和相同。然后我想将毫秒转换为纳秒并使用`long total=TimeUnit.MILLISECONDS.toNanos(time1);`但出现了问题：

```
import java.util.*;
import java.util.concurrent.TimeUnit;

public class main {
public static void main(String[] args) {

long time1,time2,time3;
int [] array =  new int[10];
Random rand =new Random(100);
time1=System.currentTimeMillis();
for(int i=0;i<array.length;i++){
array[i]=rand.nextInt(100);
}
time2=System.currentTimeMillis()-time1;

    long total=TimeUnit.MILLISECONDS.toNanos(time1);
    System.out.println("Time is:"+time1
    );

}

} 
```

最后我得到'时间是：1361703051169;' 我认为这有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T11:04:37.053

好吧，而不是使用

```
System.currentTimeMillis() 
```

您可以使用

```
System.nanoTime() 
```

这提供了以纳秒为单位的时间，而无需进行任何转换

我也认为这可能是错误的：

```
long total=TimeUnit.MILLISECONDS.toNanos(time1);
System.out.println("Time is:"+time1); 
```

也许你想打印`total`而不是`time1`？

**编辑**

请注意，正如 Mark Rotteveel 所说，在`System.nanoTime`and`System.currentTimeMillis()`中是不同的。

来自 Javadocs：

`System.currentTimeMillis()`

`Returns the current time in milliseconds. Note that while the unit of time of the return value is a millisecond, the granularity of the value depends on the underlying operating system and may be larger. For example, many operating systems measure time in units of tens of milliseconds.`

和

`System.nanoTime()`

`Returns the current value of the most precise available system timer, in nanoseconds. This method can only be used to measure elapsed time and is not related to any other notion of system or wall-clock time.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:23:34.270

你可能想像这样重写你的代码：

```
public static void main(String[] args) {
    long start, end, difference;

    start = System.nanoTime();

    //code to meassure here

    end = System.nanoTime();
    difference = end - start;

    System.out.println("Time taken:" + difference);
} 
```

# c# - 如何让代码分析发现一个参数在被调用的方法中得到了验证

> ID：15051098
> 
> 赞同：6
> 
> 时间：2013-02-24T11:01:16.223
> 
> 标签：c#, code-analysis

通常，如果我有这个：

```
public string Foo(string text)
{
    return text.Substring(3);
} 
```

`CA1062: Validate arguments of public methods`我会从代码分析中得到一个。它本来可以通过修改代码来解决的：

```
public string Foo(string text)
{
    if (text == null)
        throw new ArgumentNullException("text");
    else if (string.IsNullEmptyOrWhiteSpace(text)
        throw new ArgumentException("May not be empty or white space", "text")
    else if (text.Length < 3)
        throw new ArgumentException("Must be at least 3 characters long", "text");
    return text.Substring(3);
} 
```

但现在我想用另一种方法来做这个验证：

```
public string Foo(string text)
{
    Validator.WithArgument(text, "text").NotNullEmptyOrWhitespace().OfMinLength(3);
    return text.Substring(3);
} 
```

由于该方法验证了参数，因此代码分析规则得到满足，但您仍然会收到`CA1062`警告。有没有一种方法可以抑制此类情况的代码分析规则，而无需每次手动抑制它们或关闭特定的代码分析规则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T12:56:20.210

一个名为的属性[`ValidatedNotNullAttribute`](http://esmithy.net/2011/03/15/suppressing-ca1062/)可以用来指示一个参数在一个辅助方法中被验证。但是，对于流畅的验证 API，它不一定是一个很好的选择，因为[您需要将其添加到错误方法的参数中](https://stackoverflow.com/questions/8244958/suppress-ca1062-with-fluent-validation#8245334)（您的`WithArgument`方法，而不是您的`NotNullEmptyOrWhitespace`方法）。

# alfresco - 安排任务露天管理员

> ID：15051099
> 
> 赞同：0
> 
> 时间：2013-02-24T11:01:23.497
> 
> 标签：alfresco, alfresco-share

我对 alfresco 不是很熟悉，所以我希望这个问题不会打扰到每个人。不过我希望对你有所帮助。当我通过 webscript 为 alfresco 创建试用用户时，但我希望用户在试用 30 天后被删除。我怎样才能做到这一点？谁能给我一个想法？（我希望我不必使用 java-backend webscript，因为我以前从未这样做过。）非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T10:50:34.027

您可以使用每天触发的计划自定义操作来检查是否在 30 天前创建了某个用户。对于自定义操作，您应该查看我的博客，或者只是 google 一下，您会找到很多关于此的材料。如果您需要有关触发的 javascript 操作的帮助，请告诉我们。

# python - 发送终止后 Qthread 不会停止

> ID：15051105
> 
> 赞同：1
> 
> 时间：2013-02-24T11:02:13.383
> 
> 标签：python, multithreading, pyqt

以下代码的问题是工作线程在按下取消按钮后不会终止，并且 def pdialog(self) 在 while 循环结束之前不会停止。我想阻止进度条打印进度，从而停止后台进程。

```
import sys
from PyQt4 import QtGui, QtCore
import time

#from t6 import Ui_dialog_progress
#from t6 import Ui_dialog_file

try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    _fromUtf8 = lambda s: s

class Ui_dialog_progress(object):
    def setupUi(self, dialog_progress):
        dialog_progress.setObjectName("dialog_progress")
        dialog_progress.resize(401, 165)
        self.gridLayout = QtGui.QGridLayout(dialog_progress)
        self.gridLayout.setObjectName("gridLayout")
        self.lblFileName = QtGui.QLabel(dialog_progress)
        self.lblFileName.setText("")
        self.lblFileName.setObjectName("lblFileName")
        self.gridLayout.addWidget(self.lblFileName, 0, 0, 1, 2)
        self.pbarFileSize = QtGui.QProgressBar(dialog_progress)
        self.pbarFileSize.setProperty("value", 0)
        self.pbarFileSize.setObjectName("pbarFileSize")
        self.gridLayout.addWidget(self.pbarFileSize, 1, 0, 1, 2)
        self.label_2 = QtGui.QLabel(dialog_progress)
        self.label_2.setObjectName("label_2")
        self.gridLayout.addWidget(self.label_2, 2, 0, 1, 1)
        self.pbarTotal = QtGui.QProgressBar(dialog_progress)
        self.pbarTotal.setProperty("value", 0)
        self.pbarTotal.setObjectName("pbarTotal")
        self.gridLayout.addWidget(self.pbarTotal, 3, 0, 1, 2)
        self.lblTotal = QtGui.QLabel(dialog_progress)
        self.lblTotal.setText("")
        self.lblTotal.setObjectName("lblTotal")
        self.gridLayout.addWidget(self.lblTotal, 4, 0, 1, 2)
        spacerItem = QtGui.QSpacerItem(213, 20, QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Minimum)
        self.gridLayout.addItem(spacerItem, 6, 0, 1, 1)
        spacerItem1 = QtGui.QSpacerItem(20, 5, QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Expanding)
        self.gridLayout.addItem(spacerItem1, 5, 1, 1, 1)
        self.btnPbarCancel = QtGui.QPushButton(dialog_progress)
        self.btnPbarCancel.setObjectName("btnPbarCancel")
        self.gridLayout.addWidget(self.btnPbarCancel, 6, 1, 1, 1)

        self.retranslateUi(dialog_progress)
        QtCore.QMetaObject.connectSlotsByName(dialog_progress)

    def retranslateUi(self, dialog_progress):
        dialog_progress.setWindowTitle(QtGui.QApplication.translate("dialog_progress", "Dialog", None, QtGui.QApplication.UnicodeUTF8))
        self.label_2.setText(QtGui.QApplication.translate("dialog_progress", "Total:", None, QtGui.QApplication.UnicodeUTF8))
        self.btnPbarCancel.setText(QtGui.QApplication.translate("dialog_progress", "Cancel", None, QtGui.QApplication.UnicodeUTF8))

class Ui_dialog_file(object):
    def setupUi(self, dialog_file):
        dialog_file.setObjectName(_fromUtf8("dialog_file"))
        dialog_file.resize(101, 59)
        self.btnCreate = QtGui.QPushButton(dialog_file)
        self.btnCreate.setGeometry(QtCore.QRect(10, 20, 77, 25))
        self.btnCreate.setObjectName(_fromUtf8("btnCreate"))
        self.retranslateUi(dialog_file)
        QtCore.QMetaObject.connectSlotsByName(dialog_file)

    def retranslateUi(self, dialog_file):
        dialog_file.setWindowTitle(QtGui.QApplication.translate("dialog_file", "file", None, QtGui.QApplication.UnicodeUTF8))
        self.btnCreate.setText(QtGui.QApplication.translate("dialog_file", "Create", None, QtGui.QApplication.UnicodeUTF8))

class ProgressDialog(QtGui.QDialog):
    def __init__(self, parent=None):
        QtGui.QDialog.__init__(self, parent = None)
        self.ui = Ui_dialog_progress()
        self.ui.setupUi(self)
        self.setWindowModality(QtCore.Qt.ApplicationModal)

class MyThread(QtCore.QThread):
    trigger = QtCore.pyqtSignal()
    updatePD = QtCore.pyqtSignal()
    def __init__(self, parent=None):
        super(MyThread, self).__init__(parent)

    def run(self):
        self.trigger.emit()

class Main(QtGui.QDialog):
    def __init__(self, parent=None):
        super(Main, self).__init__(parent)
        self.ui = Ui_dialog_file()
        self.ui.setupUi(self)
        self.ui.btnCreate.clicked.connect(self.start_threads)

    def start_threads(self):
        self.mythread = MyThread(self)
        self.mythread.trigger.connect(self.pdialog)
        self.connect(self.mythread, QtCore.SIGNAL("updateFileProgress(int)"), self.updateFileProgress)
        self.connect(self.mythread, QtCore.SIGNAL("updateTotalProgress(int)"), self.updateTotalProgress)
        self.pd = ProgressDialog()
        signal = QtCore.SIGNAL("clicked()")
        self.pd.ui.btnPbarCancel.connect(self.pd.ui.btnPbarCancel, signal, self.abort)
        self.mythread.start()

    def abort(self):
        self.pd.close()
        self.mythread.terminate()

    def updateFileProgress(self, j):
        self.pd.ui.pbarFileSize.setValue(j)
        print j

    def updateTotalProgress(self, i):
        self.pd.ui.pbarTotal.setValue(i)
        print i

    def pdialog(self):
        self.pd.show()
        i = 1
        self.pd.ui.pbarTotal.setValue(0)
        self.pd.ui.pbarFileSize.setValue(0)
        j = 1
        while i < 100:
            while j <= 100:
                time.sleep(0.01)
                self.mythread.emit(QtCore.SIGNAL("updateFileProgress(int)"), j)
                QtGui.qApp.processEvents()
                j += 1
            i += 1
            j = 1
            self.mythread.emit(QtCore.SIGNAL("updateTotalProgress(int)"), i)
            QtGui.qApp.processEvents()
        self.pd.close()

if __name__ == '__main__':
    app = QtGui.QApplication(sys.argv)
    mainwindow = Main()
    mainwindow.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:02:43.563

不要`terminate()`用于终止线程。

见[http://qt-project.org/doc/qt-4.8/qthread.html#terminate](http://qt-project.org/doc/qt-4.8/qthread.html#terminate)

> void QThread::terminate () [槽]
> 
> 终止线程的执行。线程可能会或可能不会立即终止，具体取决于操作系统的调度策略。在 terminate() 之后使用 QThread::wait() 进行同步终止。
> 
> 当线程终止时，所有等待线程结束的线程都会被唤醒。
> 
> **警告：**此功能很危险，不鼓励使用。线程可以在其代码路径中的任何位置终止。修改数据时可以终止线程。线程没有机会自行清理、解锁任何持有的互斥锁等。简而言之，只有在绝对必要时才使用此功能。

有许多温和的方法可以停止线程。
例如，您可以使用标志变量来通知您的工作函数停止。

```
def start_threads(self):
    self.end_flag = False
    self.mythread = MyThread(self)
    self.mythread.trigger.connect(self.pdialog)
    self.connect(self.mythread, QtCore.SIGNAL("updateFileProgress(int)"), self.updateFileProgress)
    self.connect(self.mythread, QtCore.SIGNAL("updateTotalProgress(int)"), self.updateTotalProgress)
    self.pd = ProgressDialog()
    signal = QtCore.SIGNAL("clicked()")
    self.pd.ui.btnPbarCancel.connect(self.pd.ui.btnPbarCancel, signal, self.abort)
    self.mythread.start()

def abort(self):
    self.pd.close()
    #self.mythread.terminate()
    self.end_flag = True

def pdialog(self):
    self.pd.show()
    i = 1
    self.pd.ui.pbarTotal.setValue(0)
    self.pd.ui.pbarFileSize.setValue(0)
    j = 1
    while i < 100:
        while j <= 100:
            if self.end_flag:
                self.pd.close()
                return
            time.sleep(0.01)
            self.mythread.emit(QtCore.SIGNAL("updateFileProgress(int)"), j)
            QtGui.qApp.processEvents()
            j += 1
        i += 1
        j = 1
        self.mythread.emit(QtCore.SIGNAL("updateTotalProgress(int)"), i)
        QtGui.qApp.processEvents()
    self.pd.close() 
```

# javascript - 在 JavaScript 中将太平洋标准时间凌晨 1 点转换为当地时间？

> ID：15051106
> 
> 赞同：0
> 
> 时间：2013-02-24T11:02:15.083
> 
> 标签：javascript, date, time, safari

我们有一个每天在太平洋标准时间凌晨 1 点运行的系统脚本。我们在世界各地都有用户。我们希望提供一个简单的网页，该网页使用 JavaScript 在用户的本地时区显示 1 AM PST。例如，纽约市的用户应该看到太平洋标准时间凌晨 4 点作为系统脚本运行的时间。

PST 时间格式为 HH:MM DD.YYYY。

这只需要在移动 Safari 上工作。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:10:10.563

代码将是这样的：

```
alert(new Date(your_pst_server_time).toLocaleString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:42:15.223

您可以使用对象的`.getUTCHours()`和`.getTimezoneOffset()`方法`new Date()`。为了便于使用，我将这个新功能附加到该对象上。它将接受一个参数，该参数指定返回的时间格式。

```
Date.prototype.getLocalTime = function (format){
    var date = new Date();
        var finalTime = ((date.getUTCHours()-2))-(((date.getTimezoneOffset())/60));
    if (format+'' != '24'){
        if (finalTime < 0){ finalTime = finalTime + 24 }
    }
    else {
        if (finalTime > 12){ finalTime = (finalTime - 12)+" PM" }
        else { finalTime += " AM" }
    }
    return finalTime.toString();
} 
```

使用我的 CET 时区，调用`new Date().getLocalTime('24')`将返回`"10"`并且调用`new Date().getLocalTime()` *（不带参数或不带参数`"24"`）*将返回`"10 AM"`。

[时间转换网站检查时区](http://www.worldtimebuddy.com/?qm=1&lid=0,8,12&h=0&date=2013-2-24&sln=9-10)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-06T07:51:24.823

这个函数是一个合理的第一次开始，但不适用于印度等时间偏移为 x.5 小时（x 小时 + 30 分钟）的国家。不幸的是，你不能像那样除以 60。

# python - 相互引用的 Python 关键字参数

> ID：15051110
> 
> 赞同：2
> 
> 时间：2013-02-24T11:02:59.033
> 
> 标签：python, keyword-argument

当我尝试以下操作时出现错误

```
def test_func(key1=2.7, key2=key1*3.5):
    print(key1, key2)

NameError: name 'key1' is not defined 
```

我的解决方案是这样的

```
def test_func(key1=2.7, key2=None):
    if not key2:
        key2 = key1*3.5

    print(key1, key2) 
```

但这对我来说有点难看。有人有更好的解决方案吗？

**编辑：**

所以我的最终解决方案是

```
def test_func(key1=2.7, key2=None):
    if key2 is not None:
        key2 = key1*3.5

    print(key1, key2) 
```

感谢所有答案

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T11:04:18.587

不，没有更好的解决方案。

函数参数定义可以是表达式，但它们只被评估*一次*（这有时会让人们感到惊讶，请参阅[“Least Astonishment”和 Mutable Default Argument](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:24:40.323

我的解决方案是：

```
def t(key1=1, **kwargs):
    key2 = kwargs.get('key2', key1*2.7) 
```

从 kwargs 获取 key2 并使用默认 key1*2.7 从中获取数据

# javascript - 使用全局标志，我无法检测到“蓝色”一词的多次出现？

> ID：15051111
> 
> 赞同：1
> 
> 时间：2013-02-24T11:03:01.557
> 
> 标签：javascript, regex

通过以下脚本，我尝试检测该单词的多次出现，`blue`但它只是打印出来`e`。这是为什么 ？

```
var reg_5 = /[blue]+/g;
var str = "Sky was dark and the mood was blue.Sky was dark but the water felt blue.";
document.write("<br / >" + reg_5.exec(str)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T11:05:17.030

您的正则表达式错误，您搜索 b、l、u 或 e 出现一次或多次。

你的正则表达式应该是：

```
/blue/g 
```

然后使用循环：

```
var finder = /blue/g;
var result;
while( ( result = finder.exec( str ) ) ){
    console.log( result );
} 
```

只要结果为空，您就需要执行正则表达式。如果没有 g 标志，它就不会像这样工作。查找器有一个 lastIndex 属性，它指示最后一个匹配的索引，所以如果你想重用正则表达式而不重新创建它，只需将此属性设置回零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:05:11.977

失去角色类

`var reg_5 = /blue/g;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T11:47:48.760

它打印是因为in`e`的第一个匹配项是in 。请参阅菲利普的答案，了解为什么会这样以及正则表达式应该是什么。`/[blue]+/g;``str``e``the`

如果您正在全局匹配，即查找多个匹配项，并且您没有使用捕获组`()`，则可以使用`match`获取所有匹配项的数组。

```
var m = str.match( /blue/g );
var n = m == null ? 0 : m.length;

console.log( 'The word "blue" appeared ' + n + ' times.' ); 
```

# asp.net - Object-c url 数据加密

> ID：15051112
> 
> 赞同：-1
> 
> 时间：2013-02-24T11:03:02.260
> 
> 标签：asp.net, ios, objective-c, web-services

我有一个 iPhone 应用程序将调用 asp.net 服务器上的 web 服务。例如[http://server.ws.com/projects.wsdl?i=10](http://server.ws.com/projects.wsdl?i=10)。Web 服务是用 C# 编写的。

我想加密 iPhone 应用程序上的 url 并在 asp.net 网站上再次正确解密，这样我就不会丢失任何数据。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:11:07.040

C# 有一些非常好的本机加密类。诀窍是确保 C 加密和 C# 加密的实现相同。

经过快速的谷歌搜索，这就是我想出的：

苹果教程提供了一些关于加密的信息是 iPhone 上的 Objective C：http: [//developer.apple.com/library/ios/#documentation/Security/Conceptual/cryptoservices/Introduction/Introduction.html#//apple_ref/doc/ uid/TP40011172](http://developer.apple.com/library/ios/#documentation/Security/Conceptual/cryptoservices/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011172)

以下是您需要考虑的一些事项：

您将
如何建立连接，如何在双方建立密钥：[http](http://en.wikipedia.org/wiki/Key_exchange)
://en.wikipedia.org/wiki/Key_exchange 使用预定义算法加密信息。
沿连接传输加密数据。最后一个应该不会太难。

希望这会有所帮助:)

# algorithm - 部分排序算法

> ID：15051120
> 
> 赞同：2
> 
> 时间：2013-02-24T11:05:04.913
> 
> 标签：algorithm, perl

我对 perl 很陌生。所以，如果有一个明显的答案，我很抱歉。我的问题：Perl 中是否有 C++ 中 std::partial_sort 的内置替代方案。或者至少你能给我推荐一个实现这个算法的 CPAN 模块吗？先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T22:35:52.757

看起来你想要的是`Sort::Key::Top`.

`sort`正如我所描述的，我已经编写了一个 Perl 选择排序，虽然它比仅在整个列表中使用并选择前十名要快四倍以上，但`top`函数 from`Sort::Key::Top`再次快两倍以上。

这是我的代码和结果。`AAAA`它使用从to 到`ZZZZ`近半百万的四字符模式列表进行测试。

```
use strict;
use warnings;

use List::Util 'shuffle';
use Sort::Key::Top 'top';
use Benchmark 'timethese';

srand(0);
my @list = shuffle 'AAAA' .. 'ZZZZ';

timethese(100, {

  'Sort::Key::Top' => sub {
    my @topten = top 10 => @list;
  },

  'Pure Perl' => sub {

    my @topten;

    for my $item (@list) {
      if (@topten and $item lt $topten[-1]) {
        my $i = $#topten-1;
        --$i while $i >= 0 and $topten[$i] gt $item;
        splice @topten, $i+1, 0, $item;
        pop @topten if @topten > 10;
      }
      elsif (@topten < 10) {
        push @topten, $item;
      }
    }
  },

  'Perl sort' => sub {
    my @topten = (sort @list)[0..9];
  },
}); 
```

**输出**

```
Benchmark: timing 100 iterations of Perl sort, Pure Perl, Sort::Key::Top...
     Perl sort: 46 wallclock secs (45.76 usr +  0.11 sys = 45.86 CPU) @  2.18/s (n=100)
     Pure Perl: 11 wallclock secs (10.84 usr +  0.00 sys = 10.84 CPU) @  9.22/s (n=100)
Sort::Key::Top:  4 wallclock secs ( 3.99 usr +  0.13 sys =  4.12 CPU) @ 24.28/s (n=100) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:35:38.077

出现快速搜索，[`Sort::Key::Top`](https://metacpan.org/module/Sort%3a%3aKey%3a%3aTop)但可能还有其他选择。

# c# - 名称 <...> 不存在于命名空间 clr-namespace <...>

> ID：15051121
> 
> 赞同：95
> 
> 时间：2013-02-24T11:05:05.987
> 
> 标签：c#, .net, wpf, xaml, namespaces

我有一个小型 WPF 应用程序，它过去编译得很好，但现在不再编译了。我真的不能说它在什么时候停止了构建。前一天还好好的，第二天就不行了。

这是项目结构：

![在此处输入图像描述](../Images/61860b090a3309e21691fdeb98a6c7bf.png)

除了标准的 .net dll 之外，没有其他项目或外部参考。

这是问题所在的用户控件：

```
<UserControl x:Class="TimeRecorder.HistoryUserControl"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:local="clr-namespace:TimeRecorder.ViewModel"
         xmlns:framework="clr-namespace:TimeRecorder.Framework"
         mc:Ignorable="d" Height="Auto" Width="Auto" Padding="5">
<UserControl.Resources>
    <local:HistoryViewModel x:Key="ViewModel"/>
    <framework:BoolToColorConverter x:Key="ColorConverter"/>
</UserControl.Resources>
<StackPanel DataContext="{StaticResource ViewModel}"> 
```

这是我得到的错误： ![http://i48.tinypic.com/5u1u8w.png](../Images/302651944850b2fc3bdbf8f254c34921.png)

**请注意，这不仅仅是屏幕截图中的一个文件，而是我在此项目的所有用户控件/窗口文件中以类似方式在 xaml 中添加的所有引用。**

所以文件在那里，文件中的命名空间是正确的，xaml 文件中的命名空间/类名（据我所知）是正确的。当我输入 xaml 时，我得到了智能感知，因此它发现文件正常，但在编译时却没有。

在其他帖子中，最常见的解决方案是 .net 框架版本。我的主项目和测试项目目前都设置为 .Net Framework 4。完整版不是客户资料。

**这就是我认为我搞砸了：** 在配置管理器中，两个项目的平台都设置为任何 CPU，但是在尝试解决这个问题时，我注意到主项目设置为 x86，测试项目设置为任何中央处理器。所以我在配置管理器中为主项目手动添加了Any CPU。但是，老实说，我不知道我是否正确地这样做了，或者即使我应该这样做。所以作为一个额外的问题，有没有办法可以将配置管理器重置为其默认状态？这对主要问题有什么要说的吗？我不知道主项目是否总是设置为 x86，或者我是否以某种方式将其更改为 x86，然后它就坏了。如前所述，这个项目在一段时间内编译得很好。

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2013-03-06T12:46:32.197

每次发生在我身上时，我都只是重新启动了 Visual Studio，重新构建了解决方案，它工作得很好.. 不能说为什么

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-05-09T11:12:06.347

除了“命名空间中不存在”消息之外，我还收到了来自设计器的消息，它无法显示 x64 和 ARM 目标的窗口。

我刚刚发现将构建切换到 x86 模式，执行重建解决方案，然后切换回 x64 模式，然后再次重建修复 [both] 问题。

简单地重建 x64 解决方案什么也没做。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2016-05-04T14:18:37.737

我发现有帮助（特别是如果此错误发生在 中`App.xaml`）是**注释掉给您带来麻烦的引用，重建，然后取消注释。**我*认为*这样做是允许整个项目实际构建而不是在错误时停止构建。

据我所知，该应用程序正在尝试按特定顺序构建文件，因此当`App.xaml`或可能是引用中的任何其他类文件错误时，导致错误的文件尚未正确编译，因此为什么它没有'在该命名空间中找不到文件。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-11-05T14:03:58.237

这就是在 Visual Studio 2012（更新 3）上对我有用的方法。

*   重新启动 Visual Studio
*   将当前程序集添加到命名空间声明`xmlns:framework="clr-namespace:TimeRecorder.Framework;assembly=MyAssembly`
*   `Build`->`Build Solution`

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-02-04T02:00:54.373

重新构建您的解决方案（有时干净然后构建效果更好）。然后查看您的错误列表，滚动到最底部，它很可能会指示不允许您的程序集编译的错误，并且 XAML 编译器很可能使用的是程序集的缓存版本，而不是您的新版本意思是建造。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-01-23T15:01:34.840

什么对我有用： - 将解决方案配置从调试切换到发布 - 将配置从发布切换回调试

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-06-15T09:43:56.423

我有类似的问题。就我而言，我必须执行以下操作

*   从 xaml 中删除引用标记（在此示例中，`<local:HistoryViewModel x:Key="ViewModel"/>`）
*   构建类（在此示例文件中包含`HistoryViewModel`类）
*   构建完成后，在 xaml 中添加引用标记
*   再次构建

上述方法对我有用。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-01-20T19:06:22.400

今天使用 Visual Studio 2017 社区版遇到了这个问题。在这里尝试了所有建议（重置 VS 2017，从 x64 更改为 x32 并再次返回等）和其他来源均无济于事。Intellisense 知道一切都在那里，但我每次都遇到同样的错误。

无论如何，我的修复结果非常简单......当你花了几个小时解决这个问题时，他们不总是这样吗！

基本上，我做了以下......

1.  从 xaml 文件中删除有问题的代码（在我的例子中只有 3 行）
2.  构建项目，以便您获得成功的构建
3.  此时布局神奇地出现在设计器窗口中，这是一个好兆头！
4.  重新插入我在第 1 点中删除的代码。包括 xmlns: 条目
5.  在这一点上你不应该得到任何蓝色曲线......希望
6.  再次构建项目

似乎通过成功构建，它必须在 VS 和/或程序集中重置“某些东西”。一旦你有一个成功的构建尝试再次插入你的代码。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-08-07T14:59:09.537

没有一个解决方案对我有用。我这样修复它：

*   从引用中删除库的 dll
*   下载库的源代码（而不仅仅是 dll 文件）
*   构建库的项目以获得新的dll文件
*   将新的dll文件添加到主项目的References

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-08-30T00:44:50.370

有这个问题浪费了几个小时。我将一个单独的用户控件 dll 移到项目中，因此它是在项目中编译的，而不是引用的 dll。这破坏了整个项目，所以我仔细检查了所有命名空间、路径和文件名。尝试删除 obj 文件，在 x86 和 AnyCPU 之间切换发布和调试。打开全部保存，重新编译还是不爽。

记得之前有过类似的问题，VS2013 中标记的错误与我必须修改 XAML 的位置没有直接关系，而是通过使用

```
x:Name="myControl" 
```

在所有控件上，而不是

```
Name="myControl" 
```

修复。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-06-26T11:25:35.610

我将目标框架我的“.Net Framework 4.5”应用程序更改为“.Net Framework 4.6”并且它有效！

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-06-16T12:11:17.690

这是一个类似的奇怪例子：

```
<UserControl x:Class="Gtl.Ui.Controls.WaitControl"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:controls="clr-namespace:Gtl.Ui.Controls"
         mc:Ignorable="d" 
         d:DesignHeight="120" d:DesignWidth="120"             
         Background="Transparent">
...
</UserControl> 
```

将编译（VS2013）。

```
<UserControl x:Class="Gtl.Ui.Controls.WaitControl"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:controls="clr-namespace:Gtl.Ui.Controls"
         mc:Ignorable="d" 
         d:DesignHeight="120" d:DesignWidth="120"             
         Background="Transparent"
         IsVisibleChanged=onIsVisibleChanged>
...
</UserControl> 
```

产生错误“在 Gtl.Ui.Gtl 中找不到类型 Ui”（我向您保证处理程序方法存在于代码隐藏中）。解决方法是在类构造函数中添加处理程序，但是来吧微软，wtf 是怎么回事？

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-01-31T19:00:55.683

当我尝试在 xaml 中调用命名空间时，我遇到了同样的问题。显示该类在命名空间中不可用。我搜索了很多。最后我发现这个问题与VS有关。我正在使用 VS 2013。我尝试了以下步骤：

1.  构建-->配置管理器-->活动解决方案平台-->更改为 x64 和 x86 以及任何 CPU。
2.  关闭VS并再次打开。
3.  改变

    ```
    xmlns:VM="clr-namespace:MyFirstAppViewModel" 
    ```

    到

    ```
    xmlns:VM="clr-namespace:MyFirstAppViewModel;assembly=ViewModel" 
    ```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-02-04T06:59:08.163

此错误通常发生在上次构建期间项目未成功构建时。

步骤 1) 首先从 XAML 或 .cs 文件中删除所有导致错误的代码，然后按 F5 构建并启动项目。

步骤2）添加在XAML中一一添加导致错误的代码。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-03-11T16:03:09.863

*   我会建议重命名 `x:Key="ViewModel"`，也许有一个小故障
*   如果你输入`local:`VS 会显示给你`HistoryViewModel`吗？
*   还要检查你`Class`是否是`public`

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-06-14T11:09:34.793

只需从**Build**菜单 运行代码分析

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-07-29T13:45:25.110

我发现运行命令“运行代码分析”会重新构建所有内容，并且几乎总是可以解决问题（右键单击项目 > 分析 > 运行代码分析）。这通常也会重新构建资源文件，以便可以找到字符串等。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-01-02T06:08:41.427

尝试了此线程上的所有解决方案，但没有一个有效。原来是由解决方案配置引起的。由于某些本机依赖项需要它，我的 WPF 应用程序设置为为 X64 构建，但该项目的解决方案配置仍设置为 AnyCPU。在解决方案配置管理器中为项目创建新的 X64 配置允许 XAML 设计人员最终识别我的类型和命名空间。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-03-11T11:16:54.963

在将名称空间添加到您的 .xaml 文件之前，请确保您没有因现有代码而出现任何编译错误。

一旦所有编译检查都正常，然后重新构建您的解决方案并尝试添加所需的命名空间以使用其类或属性。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-10-17T12:53:05.403

这对我来说是一个反复出现的问题。有一次我找到了查看**警告选项卡**的解决方案。这是一个**.NET 框架版本问题**，它说明了以下内容：

> 警告 9 无法解析主要引用“myDll”，因为它是针对“.NETFramework,Version=v4.5.2”框架构建的。这是比当前目标框架“.NETFramework,Version=v4.0”更高的版本。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-04-28T14:02:01.150

他们对对象布局的缓冲存在故障。如果任何东西被重命名或移动，它就会丢失。通常对我有用的是创建一个全新的类并复制所有旧代码，让它在新类上工作，然后删除原始类。有时在使用新的类名启动并运行后，您可以尝试将其重命名为原始名称（但通常不会）

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-06-24T14:21:41.080

我在 .xaml 的标题处使用 xmlns:local="using:MyRootNamespace.ChildNamespace" ，然后我把它变成了 xmlns:local="clr-namespace:MyRootNamespace.ChildNamespace" ...好吧，我只是让智能感知做这份工作，它奏效了。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-12-15T12:12:33.100

问题是当您创建 x86 目标时，特定项目的输出路径设置为 bin\x86\Debug。看起来 Expression blend 根本不喜欢这个。它似乎只对 bin\Debug 中的内容感兴趣。

例如，如果您将 x86 项目的输出路径更改为 bin\debug，那么我相信您会发现它会起作用。好吧，无论如何对我有用:)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-08-19T10:08:27.457

您添加的 .dll 文件的目标框架应与您应用的目标框架相同。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-04-20T10:29:57.707

我面临着同样的问题。您收到此错误，但您仍然可以成功构建您的项目，不便之处在于您看不到 UI 设计（或者只是想清理代码并删除烦人的摆动线）。阅读许多帖子尝试了几件事，但以下作品就像魅力一样。

在 Visual Studio 2019 中试过这个：

**右键单击您的解决方案 -> 属性 -> 配置属性，然后将项目配置从调试更改为发布，反之亦然。**

之后，重建您的解决方案。它可以解决你的问题。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-05-24T20:59:28.077

正如一些已经回答过这篇文章的人所说，完全退出并重新启动 Visual Studio 通常可以解决这些**问题**。但是，有时错误不会得到解决，因为它实际上是构建失败或依赖问题。

当我在 Visual Studio 中处理 WPF 项目时，XAML 错误*并不总是根本原因***，**而是失败的症状。有时会出现 .net 框架依赖问题，这些问题没有出现在错误列表窗口中，您必须使用“输出”窗口来调试实际失败的内容。

我了解到，当真正的罪魁祸首来自完全独立的类或项目时，根本原因（为什么会在多个 XAML 文件中出现如此多的错误）实际上可能是不正确的表现。通常会导致构建失败。特别是在具有多个项目的解决方案中，可能存在一个项目无法生成的 DLL 依赖项，从而导致级联故障，显示为 XAML 文档错误。

XAML 的缺点之一是它需要库的构建副本才能验证 XAML，因为元素名称与实际类匹配。因此，有时您会收到 XML 错误，因为库没有正确构建。此外，在添加新控件时，如果您尚未构建项目，它将无法找到新类。只是在查看错误时需要注意的事情。

一旦您修复了 XAML 文件之外的基础构建问题，它将允许构建每个依赖项目。在这些情况下，跨多个 XAML 文件抛出的错误与文档结构*无关*，而是底层依赖关系的失败；它可能会破坏受影响的 XAML 文档呈现所需属性和绑定的能力。这最初是一种误导，但如果你理解它，它有助于找到潜在的问题。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-06-16T10:14:47.740

[https://i.stack.imgur.com/2oEWs.png](https://i.stack.imgur.com/2oEWs.png)

[https://i.stack.imgur.com/dMwNX.png](https://i.stack.imgur.com/dMwNX.png)

有同样的问题，我通过将 exe 保存在 net5.0-windows 文件夹中来解决。

不要尝试在构建后事件命令行中删除它。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-10-20T18:18:29.603

**“名称 <...> 在命名空间 clr-namespace <...> 中不存在”** 如果此错误持续存在，无论您做什么，您的解决方案中很可能存在与XAML 文件。对我来说，当我解决解决方案中的其他问题时，错误得到了解决。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-12-18T14:14:42.223

如果您还有此特定错误以外的错误，则可能会发生这种情况。更多错误可能会导致文件无法正确编译并导致此错误。

首先尝试删除其他构建错误，如果可能，还要删除警告。然后重建解决方案。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2022-01-13T03:16:15.320

如果 xaml 文件具有正确的命名空间，并且您最近修改了解决方案中任何项目的名称，那么可以尝试以下方法：

1.  清洁整个溶液
2.  从依赖层次结构中的最低层到最高层一个一个地重新构建每个项目。因此，如果项目 A 依赖于项目 B 和项目 C，两者都没有进一步的依赖关系，那么首先重建 B 和 C，然后再重建 A。
3.  卸载有错误的项目并重新加载它。如果错误仍然存​​在，则关闭并再次打开 sln。

# zend-framework2 - Zend Framework 2 - 翻译路线

> ID：15051124
> 
> 赞同：2
> 
> 时间：2013-02-24T11:05:18.150
> 
> 标签：zend-framework2

在 Zend Framework 2 中是否有任何解决方案来制作翻译路线？

例如我需要做路线：

```
/en_US/orders/show/
/pl_PL/zamowienia/pokaz/
/de_DE/germany_orders/germany_show 
```

我怎样才能做到？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T04:17:29.523

此功能尚未实现，但很可能会在 ZF 2.2 之后实现

# javascript - Facebook Like 按钮在加载时冻结页面

> ID：15051125
> 
> 赞同：1
> 
> 时间：2013-02-24T11:05:58.233
> 
> 标签：javascript, asynchronous, facebook-like

我已经阅读了许多关于如何防止点赞按钮破坏您的页面加载时间的帖子，但我尝试过的一切都没有效果。

我已按照另一篇文章中的建议将代码放在页面底部，但没有效果：

```
<div id="fb-root"></div>
<script>
  (function() {
    var e = document.createElement('script'); e.async = true;
    e.src = document.location.protocol +
      '//connect.facebook.net/en_US/all.js#xfbml=1';
    document.getElementById('fb-root').appendChild(e);
  }());
</script> 
```

在呈现此代码时，页面实际上冻结了大约 2 秒。

有没有人有办法解决吗？我认为我将剩下的唯一选择是将其从我的网站中删除:(

# actionscript-3 - 如何在动作脚本 3 中检测与父级中的每个子级的冲突？

> ID：15051126
> 
> 赞同：0
> 
> 时间：2013-02-24T11:06:00.027
> 
> 标签：actionscript-3

我有一个电影剪辑，在那个电影剪辑中还有一些电影剪辑（矩形）......我如何检测与所有这些矩形的碰撞而不必为每个矩形编写代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:01:07.667

您可以像这样迭代任何 DisplayObjectContainer 的子项：

```
for( var i:int = 0; i < clip.numChildren; i++) 
    doStuffWith( clip.getChildAt(i) ); 
```

要测试与任何子对象的碰撞，您可以使用以下命令：

```
function hitTestChildren( target:DisplayObject, parent:DisplayObjectContainer ):Boolean {
    for( var i:int = 0; i< parent.numChildren; i++)
        if( target.hitTestObject( parent.getChildAt(i))) return true;
    return false;
} 
```

**编辑**

查看源 FLA 后，以下是如何在重力模拟中包含碰撞：

```
function hitTestY( target:DisplayObject, container:DisplayObjectContainer ):Number {
    //iterate over all the child objects of the container (i.e. the "parent")
    for( var i:int = 0; i< container.numChildren; i++) {
        var mc:DisplayObject = container.getChildAt(i)
        // Test for collisions
        // There were some glitches with Shapes, so we only test Sprites and MovieClips 
        if( mc is Sprite && target.hitTestObject( mc )) 
            // return the global y-coordinate (relative to the stage) of the object that was hit
            return container.localToGlobal( new Point(mc.x, mc.y ) ).y;
    }
    // if nothing was hit, just return the target's original y-coordinate
    return target.y;
}

function onEnter(evt:Event):void {
    vy +=  ay;
    vx +=  ax;
    vx *=  friction;
    vy *=  friction;
    ball.x +=  vx;
    ball.y +=  vy;
    ball.y = hitTestY( ball, platform_mc);
} 
```

不过，您必须修改矩形对象，使它们各自的原点位于 0,0 而不是形状的中间。

**结束编辑**

但是，如果您处理的不是简单的矩形形状，而是复杂的形状或透明度，您可能需要使用不同的方法：您可以将形状的任意组合绘制到位图，然后使用`BitmapData#hitTest`来查看它们是否相交（在此在这种情况下，您可以对`parent`包含所有子项的整个文件和`target`剪辑本身执行此操作，但不能对单个子项执行此操作）。

我不会发布任何代码（它很长），但在[Mike Chambers 的博客](http://www.mikechambers.com/blog/2009/06/24/using-bitmapdata-hittest-for-collision-detection/)上有一个很好且干净的示例说明如何做到这一点。

# jquery - 阻止表单通过 event.preventDefault() 提交；不工作

> ID：15051128
> 
> 赞同：17
> 
> 时间：2013-02-24T11:06:03.617
> 
> 标签：jquery, forms, submit

我正在使用 jQuery 提交我的表单变量，并且我试图阻止表单通过通常的方式提交（单击提交按钮或在其中一个字段上按 enter）

我有这个：

```
$('#form').submit(function(){
    event.preventDefault();
}); 
```

但它似乎不起作用我的表单仍在提交，进入 process.php 页面..

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-24T11:10:50.727

如果您唯一需要做的就是阻止默认操作，则可以提供`false`而不是函数：

```
$('#form').submit(false); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-24T11:08:10.150

尝试`return false`代替`event.preventDefault()`或接受`event`作为函数的参数。

```
$('#form').submit(function(event){
  event.preventDefault();
}); 
```

不知道为什么有些人认为这不再有效，但这里有一个例子表明它仍然有效。

[https://jsfiddle.net/138z5atq/](https://jsfiddle.net/138z5atq/)

注释掉事件处理程序，它会发出警报。

关于`stopPropagation()`并且`stopImmediatePropagation()`他们根本不会阻止表单提交。他们只是防止事件冒泡dom。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-02-26T23:56:13.203

另一种方式是：

```
$('#form').submit(function(){

   //some code here

   return false;
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-12-03T16:10:33.413

我无法获得发布的答案，并且只提供 false 对我来说不是一个选择。我发现这个工作：

```
$(document).on('submit', '#form', function(event){
    event.preventDefault();
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-09-27T19:10:59.293

我还注意到（至少在 Chrome 上），如果您在 Promise 或这样的异步函数之后运行 e.preventDefault() ：

```
submitEvent(e) {

    this.sendData(formData).then((json) => {
        ...
    })
    .catch((error) => {
        ...
    });

    e.preventDefault(); // OPS. Executed but not working ????!!!
} 
```

这个以前的行不通。理想情况下，您必须在任何其他代码之前声明它：

```
submitEvent(e) {

    e.preventDefault(); // WORKING !! :-)

    this.sendData(formData).then((json) => {
        ...
    })
    .catch((error) => {
        ...
    });
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-19T16:35:59.850

为了扩展 steveukx 的回答，我通常喜欢这样做：

```
$('#form').submit(function(event){

    // The method's values go here

    event.preventDefault();

}, false); // This is a boolean (It converts all the values contained in the callback to a boolean value) 
```

# ios - 以编程方式将 iOS 应用程序发送到后台

> ID：15051131
> 
> 赞同：2
> 
> 时间：2013-02-24T11:06:18.647
> 
> 标签：ios, background

是否可以在 iOS 5 或更高版本中以编程方式输入背景？我希望能够通过 alertView 询问用户是否要继续在后台运行应用程序以节省电池。

谢谢！

# android - Android 表情符号（笑脸图标）

> ID：15051132
> 
> 赞同：1
> 
> 时间：2013-02-24T11:06:27.997
> 
> 标签：android, emoticons

我正在开发和应用程序，人们可以使用它聊天。我想使用笑脸（我的意思是笑脸图标、图像）。android sdk 有自己的笑脸图标集吗？如果是的话，我该如何在键盘上实现它？我搜索但找不到。我感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:14:37.967

您可以使用 SDK 中包含的默认 R.drawable 图标。微笑图标也包括在内。 [http://developer.android.com/reference/android/R.drawable.html](http://developer.android.com/reference/android/R.drawable.html)

你可以在你自己的 sdk-tool 目录下找到它们 android-sdk-directory/platforms/android-7/data/res/drawable-hdpi

您可以创建自己的原始 IME 键盘。参考在这里。 [http://developer.android.com/reference/android/inputmethodservice/InputMethodService.html](http://developer.android.com/reference/android/inputmethodservice/InputMethodService.html)

# python - MRjob：reducer 可以执行 2 次操作吗？

> ID：15051137
> 
> 赞同：2
> 
> 时间：2013-02-24T11:06:53.657
> 
> 标签：python, mapreduce, mrjob

我试图产生从映射器生成的每个键值对的概率。

所以，让我们说映射器产生：

```
a, (r, 5)
a, (e, 6)
a, (w, 7) 
```

我需要添加 5+6+7 = 18 然后找到概率 5/18、6/18、7/18

所以减速器的最终输出看起来像：

```
a, [[r, 5, 0.278], [e, 6, 0.33], [w, 7, 0.389]] 
```

到目前为止，我只能让 reducer 将值中的所有整数相加。我怎样才能让它返回并将每个实例除以总和？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-09-20T17:08:44.453

Pai 的解决方案在技术上是正确的，但实际上这会给您带来很多麻烦，因为设置分区可能会很痛苦（请参阅[https://groups.google.com/forum/#!topic/mrjob/aV7bNn0sJ2k](https://groups.google.com/forum/#!topic/mrjob/aV7bNn0sJ2k)）。

您可以通过使用 mrjob.step 更轻松地完成此任务，然后创建两个减速器，例如在此示例中：[https ://github.com/Yelp/mrjob/blob/master/mrjob/examples/mr_next_word_stats.py](https://github.com/Yelp/mrjob/blob/master/mrjob/examples/mr_next_word_stats.py)

按照您描述的方式进行操作：

```
from mrjob.job import MRJob
import re
from mrjob.step import MRStep
from collections import defaultdict

wordRe = re.compile(r"[\w]+")

class MRComplaintFrequencyCount(MRJob):

    def mapper(self, _, line):
        self.increment_counter('group','num_mapper_calls',1)

        #Issue is third column in csv
        issue = line.split(",")[3]

        for word in wordRe.findall(issue):
            #Send all map outputs to same reducer
            yield word.lower(), 1

    def reducer(self, key, values):
        self.increment_counter('group','num_reducer_calls',1)  
        wordCounts = defaultdict(int)
        total = 0         
        for value in values:
            word, count = value
            total+=count
            wordCounts[word]+=count

        for k,v in wordCounts.iteritems():
            # word, frequency, relative frequency 
            yield k, (v, float(v)/total)

    def combiner(self, key, values):
        self.increment_counter('group','num_combiner_calls',1) 
        yield None, (key, sum(values))

if __name__ == '__main__':
    MRComplaintFrequencyCount.run() 
```

这会进行标准字数统计并主要在组合器中聚合，然后使用“None”作为公共键，因此每个单词都间接地在同一个键下发送到减速器。在 reducer 中，您可以获得总字数并计算相对频率。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-25T02:46:11.077

您在上面所做的也应该有效，但这是假设单个键的所有数据都适合内存。如果是这样，那么在 Reducer 中，您可以将所有值保存在内存中，然后计算您的总数，然后计算每个键值对的边际。这通常称为“条纹”方法。

但是，现在大多数情况下这可能是正确的，并且数据可能不适合内存。在这种情况下，您必须找到一种方法在实际键值对之前发送值来计算您的总数，以便它们可以用于计算边际并立即发出值。

这是“反转顺序”设计模式的候选者。当您需要计算相对频率时，它很有用。基本思想是在 Mapper 端，您为每个中间数据发出 2 个键值对，其中一个键值对对所有值具有相同的公共键。这将用于计算总数。

例子：

```
For a, (r, 5) :
---------------
emit (a, r), 5
emit (a, *), 5

For a, (e, 6) :
---------------
emit (a, e), 6
emit (a, *), 6

For a, (w, 7) :
---------------
emit (a, w), 7
emit (a, *), 7 
```

完成此操作后，您需要一个分区器，该分区器将仅使用键中的第一个值对每个中间键值对进行分区。在上面的示例中使用“a”。

您还需要一个键排序顺序，始终将具有 * 的键放在键的第二部分。

这样，所有中间键在键的第一部分都有“a”，最终会出现在同一个 reducer 中。此外，它们将以如下所示的方式排序 -

```
emit (a, *), 5
emit (a, *), 6
emit (a, *), 7
emit (a, e), 6
emit (a, r), 5
emit (a, w), 7 
```

在 reducer 中，当您遍历键值对时，如果键的第二部分有 *，您将不得不简单地从键中累积值。然后，您可以使用累积值来计算所有其他键值对的边际。

```
total = 0
for(value : values){
    if (key.second == *)
        total += value
    else
        emit (key.first , key.second, value, value/total)
} 
```

这种设计模式通常称为使用对方法的反转顺序。有关此设计模式和其他设计模式的更多信息，我建议阅读本书中有关 MapReduce 设计模式的章节 - [http://lintool.github.com/MapReduceAlgorithms/](http://lintool.github.com/MapReduceAlgorithms/)。通过示例很好地解释了它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-21T08:04:20.803

您可以像您一样简单地计算总和，并将这些对保存在内存中，以发出您想要的概率，如下所示：

```
reduce (key, list<values>):
    int sum = 0;
    for (value in values) {
        sum = sum + value.frequency; //assuming you can extract two fields in each value: value.word and value.frequency
    }
    String outputValue = "[";
    for (value in values) { //iterate over the values once more
        outputValue = outputValue + "["+ value.word + ", " +value.frequency + ", "+ value.frequency/sum +"],"
    }
    outputValue = outputValue.replaceLast(",","]");
    emit (key, outputValue); 
```

当然，这只是一个伪代码，因为我不习惯 python，但我希望过渡应该很容易。

# entity-framework - 实体框架设计器错误

> ID：15051138
> 
> 赞同：2
> 
> 时间：2013-02-24T11:07:11.007
> 
> 标签：entity-framework, entity-framework-4, entity-framework-5

我创建了一个项目是 Visual Studio 2012，并通过“数据库优先”方法设置了实体框架。但是，在映射到数据库并生成应该由框架自动生成的 Designer.cs 文件后，我最终会遇到大量错误，我无法从那里得到它们。我已将错误作为 txt 文件附加，以供您查看和专业评论。

请注意，我是 .net 框架的新手，尤其是 EF 领域。因此，如果您能给我具体的答案，我将不胜感激，以便它有助​​于我的其余学习曲线。

> 错误 1 ​​'System.Data.Entity.DbContext.DbContext(string, System.Data.Entity.Infrastructure.DbCompiledModel)' 的最佳重载方法匹配有一些无效参数 C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel .Designer.cs 45 32 TRSDataModel
> 
> 错误 2 参数 2：无法从 'string' 转换为 'System.Data.Entity.Infrastructure.DbCompiledModel' C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel.Designer.cs 45 57 TRSDataModel
> 
> 错误 3“TRSModel.TRSEntities”不包含“ContextOptions”的定义，并且找不到接受“TRSModel.TRSEntities”类型的第一个参数的扩展方法“ContextOptions”（您是否缺少 using 指令或程序集引用？） C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel.Designer.cs 47 18 TRSDataModel
> 
> 错误 4 'System.Data.Entity.DbContext.DbContext(string, System.Data.Entity.Infrastructure.DbCompiledModel)' 的最佳重载方法匹配有一些无效参数 C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel .Designer.cs 54 55 TRSDataModel
> 
> 错误 5 参数 2：无法从 'string' 转换为 'System.Data.Entity.Infrastructure.DbCompiledModel' C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel.Designer.cs 54 78 TRSDataModel
> 
> 错误 6“TRSModel.TRSEntities”不包含“ContextOptions”的定义，并且找不到接受“TRSModel.TRSEntities”类型的第一个参数的扩展方法“ContextOptions”（您是否缺少 using 指令或程序集引用？） C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel.Designer.cs 56 18 TRSDataModel
> 
> 错误 7 'System.Data.Entity.DbContext.DbContext(System.Data.Common.DbConnection, bool)' 的最佳重载方法匹配有一些无效参数 C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel.Designer .cs 63 59 TRSDataModel
> 
> 错误 8 参数 2：无法从 'string' 转换为 'bool' C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel.Designer.cs 63 76 TRSDataModel 错误 9 'TRSModel.TRSEntities' 不包含 '可以找到 ContextOptions' 并且没有扩展方法 'ContextOptions' 接受类型为 'TRSModel.TRSEntities' 的第一个参数（您是否缺少 using 指令或程序集引用？） C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel .Designer.cs 65 18 TRSDataModel

```
// Lines 10-17
using System;
using System.ComponentModel;
using System.Data.EntityClient;
using System.Data.Objects;
using System.Data.Objects.DataClasses;
using System.Linq;
using System.Runtime.Serialization;
using System.Xml.Serialization;

// Lines 45-47
public TRSEntities() : base("name=TRSEntities", "TRSEntities")
{
    this.ContextOptions.LazyLoadingEnabled = true;
    OnContextCreated();
}

// Lines 54-56
public TRSEntities(string connectionString) : base(connectionString, "TRSEntities")
{
    this.ContextOptions.LazyLoadingEnabled = true;
    OnContextCreated();
}

// Lines 63-65
public TRSEntities(EntityConnection connection) : base(connection, "TRSEntities")
{
    this.ContextOptions.LazyLoadingEnabled = true;
    OnContextCreated();
}

// Error return by adding the public class TRSEntities to where Rene suggested 
Error   1   Missing partial modifier on declaration of type 'TRSModel.TRSEntities'; another partial declaration of this type exists C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel.Designer.cs 33  18  TRSDataModel
Error   2   'TRSEntities': member names cannot be the usere as their enclosing type C:\Users\user\Documents\TRS\TRSModel\TRSEntityModel.Designer.cs 40  30  TRSDataModel 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T15:19:06.290

问题正如我最初所怀疑的那样。扩展的 TRSEntities 类在错误的命名空间中声明，因此无法识别基 ObjectContext 类，导致 TRSEntities 类无法访问此基类的方法。这是由于 EF 名称从“TRSModel”更改为“TRSEntityModel”而发生的，这显然没有在 ER 引擎中注册，因此，基于先前的命名空间自动生成此上下文文件。

我仍然不确定的一件事是如何使这种名称更改沉入 EF，以便它不会继续使用旧名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-25T01:13:31.850

使用 NuGet 到 EF6 安装程序，但还必须安装VS2012 或 VS2013 EF6 的[工具](http://www.microsoft.com/en-us/download/confirmation.aspx?id=40762)

# python - 如何从另一组中删除一组？

> ID：15051140
> 
> 赞同：-1
> 
> 时间：2013-02-24T11:07:17.900
> 
> 标签：python, set

```
set1 = [1, 3, 5, 7]
set2 = [3, 5]

...
result = [1, 7] 
```

我正在尝试类似的东西

```
set1.remove(set2) 
```

但它没有用

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-24T11:08:53.383

比这更简单

```
set1 = set([1, 3, 5, 7])
set2 = set([3, 5])

result = set1 - set2 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-24T11:09:20.053

首先使用实际集合：

```
set1 = set([1, 3, 5, 7])
set2 = set([3, 5]) 
```

或者，在 python 2.7 或 3 中：

```
set1 = {1, 3, 5, 7}
set2 = {3, 5} 
```

然后使用[`.difference_update`方法](http://docs.python.org/2/library/stdtypes.html#set.difference_update)：

```
set1.difference_update(set2) 
```

或进行就地减法：

```
set1 -= set2 
```

这在原地发生变异`set1`。如果您只需要查看差异，只需使用减法：

```
result = set1 - set2 
```

# node.js - 在使用 repos Ubuntu 安装的 nodejs、node 和 nom 中加载模块时出错

> ID：15051148
> 
> 赞同：0
> 
> 时间：2013-02-24T11:08:12.950
> 
> 标签：node.js, installation, npm

我在 Ubuntu 12.10 中使用 repos 安装了 nodejs 和 npm，通常我使用

```
sudo npm install -g nodemodule 
```

但是当我尝试这样做时，`var mod = require("nodemodule")`我收到一个我必须使用的错误`require("/usr/lib/node_modules/nodemodule")`，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:12:18.637

您可能需要设置`NODE_PATH`环境变量：

```
export NODE_PATH=/usr/lib/node_modules/:$NODE_PATH 
```

之后，再次尝试您的 Node 脚本。如果可行，请将上面的行放在 shell 的启动文件中（通常是`~/.bashrc`），以便在您登录时始终设置它。

# c - C 如何在 for 循环中直接比较和递增结构数组？

> ID：15051151
> 
> 赞同：2
> 
> 时间：2013-02-24T11:08:44.847
> 
> 标签：c

我是 C 世界的新手。我是自学的，希望能在几个问题上得到帮助。

该程序是[本示例](http://publications.gbdirect.co.uk/c_book/chapter6/structures.html#section-1)中编写的程序的简化变体，用于演示指针与结构数组的使用。我无法理解的事情是：

1.  数组如何在第一个 for 循环中递增。运算符直接用于结构数组，而`++`我预计需要`in_p[i]`在循环内部执行更多操作（i 是一个递增的 int）。
2.  在此循环中进行比较的方式。我不认为这`in_p < &ar[ARSIZE]`是可能的，因为两者都是 type `struct wp_char`。这里实际比较的是什么？

本书中的示例和我的示例都可以编译和运行。

谢谢你。

```
#include <stdio.h>
#include <stdlib.h>

#define ARSIZE 5

struct wp_char{
      char wp_cval;
      short wp_font;
      short wp_psize;
}ar[ARSIZE];

void infun(struct wp_char *, char cval, int font, int psize);

int main(void)
{
    struct wp_char wp_tmp, *lo_indx, *hi_indx, *in_p;
    char c[] = {'a','b','c','d','e'};
    int i1[] = {2,3,4,5,6};
    int i2[] = {7,8,9,10,11};
    int i = 0;

    for(in_p = ar; in_p < &ar[ARSIZE]; in_p++){
        infun(in_p, c[i], i1[i], i2[i]);
        i++;
    }

    int j;

    for(j=0;j<ARSIZE;j++)
    {
        printf("%c\n",c[j]);
        printf("%d\n",i1[j]);
        printf("%d\n",i2[j]);
        puts("\n");
    }

    exit(0);
}

void infun( struct wp_char *inp, char cval, int font, int psize)
{
`
      inp->wp_cval = cval;
      inp->wp_font = font;
      inp->wp_psize = psize;

      return;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T11:13:02.643

**问题一：**

在 C 指针算术中，++ 和 -- 按**所指向事物的大小而**不是字节（或其他一些任意度量）来递增和递减指针。参见例如[http://www.eskimo.com/~scs/cclass/notes/sx10b.html](http://www.eskimo.com/~scs/cclass/notes/sx10b.html)和[http://www.cs.umd.edu/class/sum2003/cmsc311/Notes/BitOp/pointer.html](http://www.cs.umd.edu/class/sum2003/cmsc311/Notes/BitOp/pointer.html)。

请注意，这也适用于普通的旧加法和减法：

```
float x[10];
float xPtr = &x[0];  // OR could write simply "float xPtr = x;"

xPtr = xPtr + 1; // xPtr now points at x[1]
xPtr = xPtr - 1; // xPtr now points at x[0] again
xPtr = xPtr + 9; // xPtr now points at last item in the array, x[9] 
```

**问题2：**

它们不是 type `struct wp_char`，它们是 type `struct wp_char*`，即指向该结构的指针。将它们视为指向包含这些结构之一的内存位置的数字。您可以比较两个内存位置是否相等。

# java - 泛型和继承——代码中只需要超类型

> ID：15051159
> 
> 赞同：2
> 
> 时间：2013-02-24T11:09:51.473
> 
> 标签：java, generics, inheritance, interface

我需要在客户端代码中使用泛型类及其类型参数。

```
public class Usable {
    ...
}

public interface User<T extends Usable> {
    public void use(T usable);
}

//client
public class UserDemo { 
    public void demo() {
        Usable usable = getUsable();    //returns Usable
        User<? extends Usable> user = getUser();    //returns User<? extends Usable>

        user.use(usable); //compilation error.
    }

    public Usable getUsable() {
        ....
    }

    public User<? extends Usable> getUser() {
        ....
    }
} 
```

编译错误是预期的类型是`<? extends Usable>`，但传递的类型是`Usable`。我该如何解决这个问题？约束是：

1.  客户端代码（`UserDemo`）只能在`User`和`Usable`（而不是它们的子类型）上工作。
2.  用户只能处理其类型是`Usable`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T11:21:00.683

这是行不通的：

*   `user.use(usable);`期望 的 T `User<T extends Usable>`，它可以是`Usable`的子类`Usable`
*   `usable`是一个`Usable`
*   `getUser()`返回一个`? extends Usable`

所以你可以想象一个场景：

*   `getUser`返回 a `SubUsable`，一个子类`Usable`
*   意思是`user.use()`期望 a`SubUsable`并且不能接受你试图通过的 Usable

如果您将签名更改`getUser`为返回 a `Usable`，它将起作用：

```
public void demo() {
    Usable usable = getUsable();
    User<Usable> user = getUser();
    user.use(usable);
}

public Usable getUsable() { return null; }

public User<Usable> getUser() { return null; } 
```

# ios - 将 UISwitch 的状态写入文件

> ID：15051160
> 
> 赞同：0
> 
> 时间：2013-02-24T11:09:53.420
> 
> 标签：ios, objective-c, xcode, ipad, uiswitch

我正在尝试将 UISwitch 的状态写入文件，因此每次应用启动时它都会记住它之前是打开还是关闭。

```
-(IBAction) switchValueChanged {
   if (Hard1ON.on) {
   isH1 = (@"YES");
   //save above yes to file 
```

经过一番搜索，我发现这是用于保存到文件的一段代码：

```
- (BOOL)writeToFile:(NSString *)path atomically:(BOOL)useAuxiliaryFile encoding:(NSStringEncoding)enc error:(NSError **)error 
```

但是，它会引发“使用未声明的标识符“writeToFile”错误。谁能告诉我怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:45:24.827

以字符串形式保存到文件（可能*不是*最佳解决方案）：

```
- (IBAction)switchValueChanged:(id)sender
{
    NSString *stateAsString;
    if ([sender isOn]) {
        stateAsString = @"YES";
    } else {
        stateAsString = @"NO";
    }
    [stateAsString 
        writeToFile:@"/path/to/file"
        atomically:NO 
        encoding:NSUTF8StringEncoding 
        error:NULL
    ];
} 
```

将状态写入 NSUserDefaults 可能是一个更好的主意：

```
#define kSwitchStateKey @"SwitchState"

- (IBAction)switchValueChanged:(id)sender
{
    [[NSUserDefaults standardUserDefaults]
        setObject:@([sender isOn)
        forKey:kSwitchStateKey
    ];
} 
```

# qt - QStackedWidget 从一页到另一页的导航

> ID：15051161
> 
> 赞同：5
> 
> 时间：2013-02-24T11:09:59.167
> 
> 标签：qt

我认为我有一个相当基本的 Qt 问题，但我无法弄清楚：

我有一个包含 QStackedWidget 的 QMainWindow。那里的所有页面小部件都是从 QWidget 派生的单独的类。

所以：

QMainWindow 在一个类中实现了 QStacked Window。堆叠小部件内的所有其他页面都是添加的类，并且都有自己的 .ui，其中填充了通过 Designer 的按钮和列表。

为了导航到不同的页面，在主窗口中我可以访问：`ui.stackedWidget->setCurrentIndex(2);`

看来我无法访问堆叠小部件内另一个页面上的 ui.stackedWidget ？我无法访问 ui.stackedWidget 因为 Ui 是主窗口类中的私有成员。（由 Qt 自动生成 - 使用 VS 插件添加 QT4 类）

我想知道，当单击属于此小部件内另一个页面的按钮时，如何跳转到堆叠小部件中的另一个页面？

笔记：

所有页面都添加到 mainWIdow 的构造函数中的 StackedWidget 中：

```
ui.stackedWidget->addWidget(page1Widget);
ui.stackedWidget->addWidget(page2Widget);
// etc.. 
```

page1Widget 内的按钮单击信号槽示例：

```
connect(ui.btnViewData, SIGNAL(clicked()), this, SLOT(viewData()));

::viewData() 
{   
   // navigate to another page here. 
   // note: ui.stackedWidget->setCurrentIndex(3); is not accessible here!
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-25T13:51:21.460

我相信将你的 connect() 和 viewData() 函数放在你的 QMainWindow 对象中会解决你的问题，因为主窗口可以访问子窗口小部件和 QStackedWidget 项目发出的信号。

您可能需要为每个页面编写一个 Ui getter，然后执行类似的操作

```
connect(page1Widget->getUi().btnViewData, SIGNAL(clicked()), this, SLOT(viewData))); 
```

希望有帮助，加油

# ios - 在后端验证 GamceCenter 用户凭据

> ID：15051169
> 
> 赞同：3
> 
> 时间：2013-02-24T11:10:57.500
> 
> 标签：ios, game-center

我正在为支持**登录不同网络**的 ios 应用程序构建后端。

**一旦**用户**登录**到网络，客户端将消息告诉**后端**，这可以**提供**用户可能玩的世界列表，甚至删除旧世界。

窃取他人世界的一种方法是说您是他的社交网络 ID。

**为了使用 facebook**解决这个问题，我们强制客户端向我们发送**fb_token**，这是从 facebook 提供给客户端的令牌，我们在后端使用该令牌来询问 facebook 该特定用户是否是他告诉我们的那个人。

**如果苹果没有提供验证这一点的方法，我知道如果 iOS 应用程序想要使用游戏中心，*它直接迫使应用程序开发人员也使用 iCloud*，因为苹果可以验证用户凭据。**

苹果是否提供了任何方法来验证用户凭据？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-01T11:20:21.247

iOS 上的客户端可以在 GameCenter 中检索**当前登录**玩家的信息，这与 iCloud 无关。如果您想使用 iCloud 进行身份验证，您的播放器可能与您想要的播放器不同。

我认为解决方案是让客户端在 GameCenter 中检索玩家信息，并以加密方式（例如 HTTPS）将其发送到您的服务器，包括时间戳和可能的其他动态信息。这样，您将知道用户信息是从客户端应用程序本身发送的，并且没有中间人。这确实是您正在努力解决的问题：如何确保客户端-服务器通信是安全的。

# ios - 将标签栏嵌入到 iPhone 屏幕顶部

> ID：15051173
> 
> 赞同：0
> 
> 时间：2013-02-24T11:11:10.320
> 
> 标签：ios, iphone, ipad

我想设计一个顶部有标签栏的页面。在这个网站的一些文章中。（我错过了网址）我发现这不是一种常见的方式，而且这个问题得到了一些下降率。

问题是：这样的设计是否会导致苹果不批准其商店的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:52:22.813

即使它不会让 Apple 拒绝您的应用程序，也要考虑用户不习惯顶部的选项卡栏以及这将如何影响应用程序在应用商店中的表现。

每个平台都有自己的设计模式，这是有原因的。如果您坚持使用它们，那么首次使用的用户使用您的应用程序的时间会更容易，这会导致他们继续使用它的机会更高。如果他们不知道如何使用它或觉得它很难，他们会搬到另一个。

查看[人机界面指南](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/MobileHIG/Introduction/Introduction.html)并应用它们。它会做得很好。

# c# - 使用开源库时，我们应该针对源代码还是二进制文件进行编译？

> ID：15051174
> 
> 赞同：2
> 
> 时间：2013-02-24T11:11:11.243
> 
> 标签：c#, open-source

在项目中使用开源库（例如 SharpPcap 或 FakeItEasy）时，我们应该将源代码添加到解决方案中还是针对 DLL 进行编译并将它们放在解决方案中的目录中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T11:29:16.377

您应该使用二进制文件进行编译。

原因很简单：你的项目和第三方库是不同的项目，在你自己的构建过程中编译别人的库可能会引入不必要的复杂性和项目依赖。

有些库要求您在环境中安装一些工具和插件。

通常我在 Visual Studio 解决方案的根目录中有一个**依赖**项或**lib**目录，而不是在构建过程中包含开源代码，其中包含二进制文件和源代码。当我想调试第三方代码时，我只需打开另一个 Visual Studio 实例，并将调试器附加到整个过程。

想想一些第三方开源库很肥，可能你自己的代码库很小：因为你添加了很多源代码，你的构建过程会延迟很多，因为你只是添加了无用的东西（代码，插件。 ...）。

我更喜欢将构建过程委托给库的作者的原则，就我而言，我认为自己是此类库的消费者：我不需要每次都重新编译它。

啊，如果您打算修改源代码，最好的做法是联系作者并将补丁发送给他/她，以便他/她可以将其包含在官方发行版中。如果没有，您知道：每次作者发布新版本时，您都会有额外的工作将新源代码与您自己的更改合并...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:18:38.253

我想说的是，如果您使用的是最新版本的源代码，那么使用提供的二进制文件可能会不稳定。但是，如果他们提供版本化的二进制文件，那么它们很可能已经过测试并且是稳定的。

这还取决于您是开箱即用还是要对其进行修改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T11:21:10.137

通常我针对二进制文件进行编译。我的解决方案上有一个文件夹 vendor/libs，或者我只是使用 NuGet，然后重新编译 Dll。

但是，有时我需要调试开源库，而事情没有按预期发生。就在那时，我链接了源代码（仅用于调试）。

投入生产时，我使用二进制文件，因为代码已经过很好的测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-24T12:01:53.203

**我也不会**想。

以下是不放源代码的**原因**：

*   开发人员可能会不小心修改代码
*   图书馆通常会发生变化

以下是解决方案中包含 DLL 的**原因**：

*   使部署更容易
*   减少使用不兼容版本库的机会
*   减少丢失参考的机会

那么，怎么做？

1.  `Class Library`将具有唯一名称的新项目添加`ClassLibrary1`到解决方案中，例如

2.  在`Build`其项目设置页面中，配置`Output path`到应用程序输出路径

3.  在`Build Events`页面中，将以下行添加到`Post-build event command line`块中：

    ```
    del "$(TargetPath)" 
    ```

4.  将外部 DLL 复制到其文件夹并将它们添加到`ClassLibrary1`

5.  设置`Copy Local`为`true`所有添加的引用

6.  设置`Project Dependancies`其他项目，检查`ClassLibrary1`

7.  从放置 DLL 的路径添加其他项目的引用`ClassLibrary1`

8.  将`Copy Local`所有这些添加到其他项目中的 DLL 集合到`false`

因此，该项目`ClassLibrary1`成为解决方案外部库的中央控制。每次您将添加到其`Rebuild Solution`的`ClassLibrary1`最新 DLL 复制`References`到应用程序输出文件夹中，并删除它自己生成的名为`ClassLibrary1.DLL`. 并且应用程序在编译时或运行时将使用相同版本的 DLL，您无需在每次发布应用程序时进行额外的部署或检查每个部署。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-24T11:19:54.277

二进制文件：

*   除非您注意提取源的发布版本，否则更稳定
*   更轻松

来源：

*   可以修改
*   可以通过直接进入源代码来调试 API 的使用

最后一点通常很重要，因此请准备好在 IDE 中下载并打开源代码，即使您只是从二进制文件开始，尤其是在您使用的库还很年轻或测试不佳的情况下。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-03T07:38:10.190

奥卡姆剃刀说，如果您不需要修改库，则应该使用二进制文件。

# java - 使用代码从数据库创建 jtable 并在其中显示数据库表记录

> ID：15051179
> 
> 赞同：0
> 
> 时间：2013-02-24T11:12:27.663
> 
> 标签：java, database, netbeans, jtable

Yow，我正在尝试在我的 jFrame 中添加一个 jTable，并且我想将我的数据库表中的记录显示到 jTable 中。

我能够创建一个 jTable（我将代码放在构造函数中）并在代码中手动输入要显示的值。有效。但是当我尝试调用从数据库中检索数据的方法并尝试在 jtable 中显示它们时。它给了我一个错误“NullPointerException”。

**我的构造函数中创建表的代码：**

```
 String[] columnname = {"Subject Code", "Prelim", "Midterm", "SemiFinal", "Finals"};
    setTable();
    Object[][] data = {};

    gradetable = new JTable(data, columnname){
        public boolean isCellEditable(int data, int columns){
            return false;
        }

        public Component prepareRenderer(TableCellRenderer r, int data, int columns){
            Component c = super.prepareRenderer(r, data, columns);

            if (data % 2 == 0){
                c.setBackground(Color.GRAY);
            }
            else{
                c.setBackground(Color.WHITE);
            }

            if (isCellSelected(data, columns)){
                c.setBackground(Color.ORANGE);
            }
            return c;
        }
    };
    gradetable.setPreferredScrollableViewportSize(new Dimension (400, 150));
    gradetable.setFillsViewportHeight(true);
    jsp = new JScrollPane(gradetable); 
```

**我用来从数据库中检索数据并将它们添加到表中的方法：**

```
private void setTable(){
    DefaultTableModel model = (DefaultTableModel)gradetable.getModel();
    try
    {
        Class.forName("com.mysql.jdbc.Driver");            
        Connection con = (Connection)DriverManager.getConnection("jdbc:mysql://localhost:3306/grading","root","");
        Statement st = con.createStatement();      
        String sql = "SELECT * FROM student INNER JOIN grade ON student.idnumber = grade.idnumber WHERE student.idnumber = '2010-00125'";
        ResultSet rs = st.executeQuery(sql);
        model.setRowCount(0);
        while (rs.next()){

            //this.setName(rs.getString("name"));
            //this.setCourse(rs.getString("course"));
            //this.setYear(rs.getString("year"));

            String d1, d2, d4, d3, d5;

            d1 = rs.getString("subjectcode");
            d2 = rs.getString("prelim");
            d3 = rs.getString("midterm");
            d4 = rs.getString("semifinal");
            d5 = rs.getString("finals");

            model.addRow(new Object[]{d1,d2,d3,d4,d5});
        }           
        rs.close();
        con.close();
    }catch(ClassNotFoundException | SQLException ex){
            JOptionPane.showMessageDialog(null, ex);            
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:27:57.223

的原因`NPE`是您正在调用`setTable`它试图在`JTable`此处获取模型：

```
DefaultTableModel model = (DefaultTableModel)gradetable.getModel(); 
```

这是*在*你实际实例化之前`gradetable`，所以`NPE`抛出了。

除此之外，你需要`DefaultTableModel`在设置的模型时使用`JTable`，否则你会`ClassCastException`在这条线上得到一个。

# php - 用 UTF-8 编码 PHP 脚本会产生有趣的字符

> ID：15051180
> 
> 赞同：1
> 
> 时间：2013-02-24T11:12:45.167
> 
> 标签：php, utf-8

我已将 PHP 脚本的编码（如实际 .php 文件的编码）更改为 UTF-8，这是我通过在 Notepad++ 中转换编码来完成的，这导致在`ï»¿`脚本开头回显。我无法摆脱它。我在剧本中看不到任何这样的字符。我什至尝试复制并粘贴到一个新文件中，但它仍然存在。

任何想法如何摆脱它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T11:21:32.400

如评论中所述，`ï»¿`是 UTF-8 bom 签名：

> 将编码更改为 UTF-8 WITHOUT BOM，然后再次保存

# c# - 实体框架无法删除数据库，数据库正在使用中

> ID：15051185
> 
> 赞同：2
> 
> 时间：2013-02-24T11:13:12.327
> 
> 标签：c#, sql-server, entity-framework, testing, database-connection

我（像许多其他人一样）遇到了我无法让我的 NUnit 测试删除`[SetUp]`我的测试夹具中的数据库的问题。

## 我想要达到的目标

我想编写集成测试来测试我的代码并验证预期结果是否存储在数据库中（断言 CRUD 方法）。那，**我**希望能够实际显示 SqlServer 中的表并查看数据库中的结果如何。最后一部分似乎很难实现......

## 出了什么问题

我可以连续多次运行我的测试。`[SetUp]`每次都重新创建数据库，并且测试通过了断言。一旦我想在 SqlServer 的实际数据库中检查我的结果，它就会付诸东流。一旦我从 SqlServer 打开连接，该`[SetUp]`方法就不允许删除数据库，因为它有打开的连接。

## 我试过什么

*   数据库初始化器
*   ALTER 数据库 SET SINGLE_USER WITH ROLLBACK IMMEDIATE
*   Pooling=false 添加到连接字符串

我从[这个](https://stackoverflow.com/questions/5494158/entity-framework-4-1-code-first-setinitializer-not-being-called-again-after-da)和[这个](https://stackoverflow.com/questions/5288996/database-in-use-error-with-entity-framework-4-code-first/5289296#5289296)SO 帖子中获得了这些想法。

## 我有什么

`[SetUp]`方法：

```
 [SetUp]
    public void SetUp()
    {
        // TenantSeedInitializer extends the 
        // DropCreateDatabaseAlways<TenantApplicationTestContext> class

        Database.SetInitializer(new TenantSeedInitializer());
        _applicationContext = new TenantApplicationTestContext();
        _applicationContext.Database.ExecuteSqlCommand("ALTER DATABASE " + 
            TenantApplicationTestContext.DatabaseName + 
            " SET SINGLE_USER WITH ROLLBACK IMMEDIATE");
    } 
```

`[TearDown]`方法：

```
 [TearDown]
    public void TearDown()
    {
        SqlConnection.ClearAllPools();
    } 
```

还有一个非常直接的测试：

```
 [Test]
    public void AddTenant()
    {
        // add a new tenant to the database and verify that there
        // there is only one tenant present in the table  
    } 
```

正如我所说，连续多次运行这个测试就像一个魅力，直到我尝试在 SqlServer 中打开表。

## 两种不同的（对我来说未解决的）错误场景

1）*要么我不允许查看表格，因为来自 Visual Studio 的连接仍然打开。*

> > 数据库“TestTenantDatabase”已经打开，一次只能有一个用户。

添加`SqlConnection.ClearAllPools();`似乎并不能解决这个问题。

2)*或者我被允许在 SqlServer 中查看表，然后我不再被允许从我的`[SetUp]`夹具中删除数据库。*

> > 无法删除数据库“TestTenantDatabase”，因为它当前正在使用中。

关闭 SqlServer 是我知道摆脱这种情况的唯一方法。但是后来我发现自己在白天经常重启 SqlServer **......**（关闭与数据库的连接的选项也会有所帮助，但我找不到它）。

任何人都可以指导我完成这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:36:51.540

这条信息：

> 数据库“TestTenantDatabase”已经打开，一次只能有一个用户。

正在发生，因为您已将数据库设置为单用户。通常，您会这样做会杀死与数据库的其他连接，并使您的连接成为唯一可以访问它的连接。但是，如果您更改数据库上下文，则其他应用程序可能会连接进来，例如 Visual Studio，并成为单个用户，从而有效地将您锁定在外。

在您的设置夹具中尝试此操作：

```
use TestTenantDatabase;
alter database TestTenantDatabase set single_user with rollback immediate;
use master;
drop database TestTenantDatabase; 
```

如果你在设置单用户时在数据库中，你将成为单用户。然后，如果您更改为 master 然后在同一批次中删除数据库，它应该会击败任何试图连接到它的人。

另一种选择是设置离线，而不是 single_user，但是，当您删除数据库时，它不会删除数据库 .mdf 和 .ldf（以及任何 .ndf）文件，因此您可能会遇到为另一个重新创建数据库的问题一组测试。

如果在运行 single_user 时遇到与死锁相关的错误，请将死锁优先级设​​置为高。如果要重用连接，可以在删除后将其设置为正常。

# java - 无法解析标头以创建 MIME 消息

> ID：15051188
> 
> 赞同：0
> 
> 时间：2013-02-24T11:13:38.033
> 
> 标签：java, apache, api, email, jakarta-mail

我试图根据[Apache NNTP API](http://commons.apache.org/net/)仅向自己发送消息，而不是发送到或通过 intertubes 。涉及的特定类接受[NNTP 消息](http://en.wikipedia.org/wiki/Nntp)并尝试将其解析为常规 MIME 类型消息，如下所示：

```
package net.bounceme.dur.nntp;

import java.util.Arrays;
import java.util.Enumeration;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.util.Properties;
import javax.mail.Address;
import javax.mail.Header;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.NoSuchProviderException;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class MessageSender {

    private final static Logger LOG = Logger.getLogger(MessageSender.class.getName());
    private String header;
    private String body;
    private Properties p;
    private Session session;
    private MimeMessage message;

    private MessageSender() {
    }

    public MessageSender(Properties p, String... s) throws Exception {
        header = s[0];
        body = s[1];
        this.p = p;
        populate();
    }

    private void populate() throws Exception {
        String lines[] = header.split("\\n");
        session = Session.getDefaultInstance(p, null);
        message = new MimeMessage(session);
        LOG.fine("\n\n\n\nnew message************\n\n\n\n");

        for (String s : lines) {
            if (!s.contains("comp.lang.java.help")) {
                message.addHeaderLine(s);
            }
        }
        message.setContent(message, body);
        String recipient = p.getProperty("recipient");
        message.setRecipients(Message.RecipientType.TO,
                InternetAddress.parse(recipient));
        try {
            send();
        } catch (javax.mail.internet.ParseException e) {
            LOG.warning(e.toString());
        } catch (com.sun.mail.smtp.SMTPAddressFailedException e) {
            LOG.warning(e.toString());
            List<Address> addresses = Arrays.asList(message.getAllRecipients());
            for (Address a : addresses) {
                LOG.info(a.toString());
            }
        }
    }

    private void send() throws Exception {
        String protocol = p.getProperty("protocol");
        String host = p.getProperty("host");
        int port = Integer.valueOf(p.getProperty("port"));
        String username = p.getProperty("username");
        String password = p.getProperty("password");
        Transport transport = session.getTransport(protocol);
        LOG.log(Level.FINE, "{0}{1}{2}{3}{4}", new Object[]{protocol, host, port, username, password});
        Enumeration enumOfHeaders = message.getAllHeaders();
        while (enumOfHeaders.hasMoreElements()) {
            Header h = (Header) enumOfHeaders.nextElement();
            LOG.log(Level.FINE, "\n\n\nHEADER\n{0}\n{1}", new Object[]{h.getName(), h.getValue()});
        }
        transport.connect(host, port, username, password);
        transport.sendMessage(message, message.getAllRecipients());
    }
} 
```

但是我遇到了标题问题：

```
init:
Deleting: /home/thufir/NetBeansProjects/apache_nntp/build/built-jar.properties
deps-jar:
Updating property file: /home/thufir/NetBeansProjects/apache_nntp/build/built-jar.properties
Compiling 1 source file to /home/thufir/NetBeansProjects/apache_nntp/build/classes
compile:
run:
200 Leafnode NNTP Daemon, version 1.11.8 running at localhost (my fqdn: dur.bounceme.net)
GROUP comp.lang.java.help
211 35 3 37 comp.lang.java.help group selected
HEAD 3
221 3 <7e60dce5-09d7-4cee-bbc1-137207f03dd0@googlegroups.com> article retrieved - head follows
BODY 3
222 3 <7e60dce5-09d7-4cee-bbc1-137207f03dd0@googlegroups.com> article retrieved - body follows
Feb 24, 2013 3:05:04 AM net.bounceme.dur.nntp.MessageSender populate
WARNING: javax.mail.internet.ParseException: Expected '/', got wrote
HEAD 4
221 4 <kfpdt3$5g9$1@dont-email.me> article retrieved - head follows
BODY 4
222 4 <kfpdt3$5g9$1@dont-email.me> article retrieved - body follows
Exception in thread "main" javax.mail.SendFailedException: Invalid Addresses;
  nested exception is:
    com.sun.mail.smtp.SMTPAddressFailedException: 450 4.1.8 <markspace@nospam.nospam>: Sender address rejected: Domain not found

    at com.sun.mail.smtp.SMTPTransport.rcptTo(SMTPTransport.java:1863)
    at com.sun.mail.smtp.SMTPTransport.sendMessage(SMTPTransport.java:1119)
    at net.bounceme.dur.nntp.MessageSender.send(MessageSender.java:80)
    at net.bounceme.dur.nntp.MessageSender.populate(MessageSender.java:54)
    at net.bounceme.dur.nntp.MessageSender.<init>(MessageSender.java:35)
    at net.bounceme.dur.nntp.ArticleReader.<init>(ArticleReader.java:28)
    at net.bounceme.dur.nntp.Driver.<init>(Driver.java:13)
    at net.bounceme.dur.nntp.Driver.main(Driver.java:17)
Caused by: com.sun.mail.smtp.SMTPAddressFailedException: 450 4.1.8 <markspace@nospam.nospam>: Sender address rejected: Domain not found

    at com.sun.mail.smtp.SMTPTransport.rcptTo(SMTPTransport.java:1730)
    ... 7 more
Java Result: 1
BUILD SUCCESSFUL (total time: 6 seconds) 
```

现在，我很感激发件人没有域。尽管如此，我还是想继续发送消息。我需要更改发件人吗？我想尽可能少地弄脏标题。

如果有更好的方法来转换 NNTP --> MIME Message 我当然愿意接受建议。由于我不明白的原因，我已经删除了新闻组标题，因为这似乎有问题。基本上，我只是不知道如何解析这些标头，以便它们创建要发送的有效消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T09:24:34.160

是的，您需要修复发件人信息。问题不是（相当）您的代码。您的 MTA 拒绝该电子邮件。Sendmail 通常被配置为不允许出现无效的“发件人”地址。在这种情况下，它告诉您“nospam.nospam”的 DNS 查找失败。

您的信封应该反映类似 news2mail@myhost.org 的发件人，而不是尝试使用 usenet 文章海报的地址。

有多个可用的电子邮件网关新闻网新闻；您可能想考虑使用其中一个而不是自己滚动。

# r - 创建堆叠直方图

> ID：15051189
> 
> 赞同：0
> 
> 时间：2013-02-24T11:14:00.030
> 
> 标签：r, matplotlib, gnuplot, histogram

我有这个数据文件：

```
A
    169
    164
    164
    102
    150
    100
    145
B
    145
    107
    115
    120
    140 
```

我想从中创建一个堆叠的直方图。我想设置一个范围（比如 100 到 170），为 X 轴设置 bin 宽度（比如 10），并且它会计算每个 bin 中有多少（例如 140 到 149 在 A 中有 1和 B) 中的 2) 并使用条形图在 Y 轴上绘制计数。A 计数和 B 计数的着色（或阴影或其他）会有所不同。我尝试查看 gnuplot 的直方图演示，在某些情况下看起来确实相似，但我不知道如何使它工作。python+matplotlib 或 R 也没有运气。将数据重新排序为类似

```
 A B
 169 145
 164 107
 164 115
 102 120
 150 140
 100
 145 
```

如果需要，这不是问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-24T12:28:48.770

`ggplot2`使用R 中的 Hadley Wickham 包制作堆叠直方图非常容易：

```
library(ggplot2)
h <- data.frame(var=sample(letters[1:2], 100, TRUE), 
                value=rnorm(100, 0, 10))

ggplot(aes(x=value, color=var), data=h) + stat_bin(binwidth=5) 
```

删除该`color=`位将产生一个简单的直方图。

# javascript - 其他reqjest（.NET + jQuery）成功结果后的Ajax请求

> ID：15051197
> 
> 赞同：0
> 
> 时间：2013-02-24T11:15:42.930
> 
> 标签：javascript, jquery, ajax

我需要从服务器获取 xml 文档，然后客户端对其进行签名并将其发送回服务器。

在服务器端，我有保存文档的网络方法：

```
[WebMethod]
public static void SaveSignedDocument(string SignedData)
{
    SignedCms signedCms = new SignedCms();
    ....
} 
```

然后，我从服务器获取文档，成功接收后，我让客户端对其进行签名并发回。这是Javascript

```
// get xml to sign
$.ajax({
        type: "POST",
        url: "Default.aspx/GetXMLReceipt",
        data: "{'ITN': " + ITN + " }",
        contentType: "application/json; charset=utf-8",
        dataType: "xml",
        success: function (xml) {
            // xml file was got
            var xmlString = xmlToString(xmlData);
            // Sign data
            var SignedData = SignData(xmlString);

            // Send it to server
            $.ajax({
                url: 'Default.aspx/SaveSignedDocument',
                data: "{ 'SignedData': '" + SignedData + "' }",
                type: "POST",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data){
                    alert('Document was successfully sent!');
                }
                error: function (data, status, jqXHR) {
                    alert('Send signed data failed - ' + jqXHR);
                }
            });
        },
        error: function (data, status, jqXHR) {
            alert('Get data failed - ' + jqXHR);
        }
    }); 
```

问题是第二个请求的警报都不会触发。如果我将请求更改为同步，一切都很好，但为什么它不像上面写的那样工作？服务器什么也没收到，如果我们查看网络流量，我发现请求被中断了。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T15:17:34.977

正确编码您的数据，不要使用任何字符串连接。这是正确的方法：

```
data: JSON.stringify({ ITN: ITN }), 
```

在您的第二个 AJAX 请求中：

```
data: JSON.stringify({ SignedData: SignedData }) 
```

该`JSON.stringify`方法将通过正确编码参数来确保您将有效的 JSON 发送到您的服务器。

# c++ - 当我尝试输出 UTF-8 字符时，为什么会得到三个不同的数字？

> ID：15051198
> 
> 赞同：0
> 
> 时间：2013-02-24T11:15:44.910
> 
> 标签：c++, utf-8

我正在尝试标记由 UTF-8 字符组成的输入。虽然有些人尝试学习 utf8，但我得到了一个我无法理解的输出。当我输入字符 π (pi) 时，我得到三个不同的数字 207 128 10。我如何使用它们来控制它属于哪个类别？

```
ostringstream oss;
oss << cin.rdbuf();

string input = oss.str();
for(int i=0; i<input.size(); i++)
{
    unsigned char code_unit = input[i];
    cout << (int)code_unit << endl;
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T11:20:57.390

使用 UTF-8 编码的字符可能会占用一个以上的字节（而且经常如此）。用于编码单个代码点的字节数可以从 1 字节到 6 字节不等（或[RFC 3629](https://www.rfc-editor.org/rfc/rfc3629)下的 4 字节）。在 π 的情况下，UTF-8 编码（二进制）是：

```
11001111 10000000 
```

也就是说，它是两个字节。您正在单独读取这些字节。第一个字节的十进制值为 207，第二个字节的十进制值为 128（如果您将其解释为无符号整数）。您正在读取的以下字节具有十进制值 10，并且是您在按 Enter 时给出的换行符。

如果要对这些 UTF-8 字符进行任何处理，则需要解释字节的含义。你需要做什么取决于你如何对角色进行分类。

# java - 缩进空行 (IntelliJ IDEA)

> ID：15051201
> 
> 赞同：21
> 
> 时间：2013-02-24T11:15:52.370
> 
> 标签：java, intellij-idea, indentation

我想将 IDEA 格式化程序设置为在空白行上保留缩进。目前，当我重新格式化源文件时，它会去除空行上的所有缩进。

我在 Google 上找不到任何东西，也找不到格式化程序中的设置。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-10-06T01:09:09.967

您不能让 IntelliJ IDEA在空行中*添加*缩进，但*可以*阻止它删除它们，如[this answer](https://stackoverflow.com/a/2978824/1291990) to [this question](https://stackoverflow.com/q/2977324/1291990)所示。

设置 | 编辑 | 在 Save -> None**上去除尾随空格。**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-24T15:24:25.463

IntelliJ IDEA 格式化程序不缩进空行，也不提供任何选项来这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-29T16:38:23.227

尽管从 IntelliJ 14.0.3 开始我似乎无法使其工作，但似乎确实有一个选项：[Keep indents on empty lines](https://www.jetbrains.com/idea/help/code-style-java.html#keep_indents_on_empty_lines)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-28T11:30:30.773

试试这个选项：文件->设置->编辑器->代码样式。在那里找到并启用“在空行上保留缩进”复选框。（在我的 intellij idea 14.0.2 上可用）

截图：http: [//i.imgur.com/vVVlIBM.png](http://i.imgur.com/vVVlIBM.png)

# iphone - 在应用程序中购买 Apple 托管的内容 - 如何从下载的 pkg 文件中加载 nib

> ID：15051203
> 
> 赞同：1
> 
> 时间：2013-02-24T11:16:11.557
> 
> 标签：iphone, ios6, in-app-purchase, nib, iap-hosted-content

在提取所有可能的存档后，我的托管内容中有以下文件结构。

![在此处输入图像描述](../Images/08ba1e86ab70ff35cf8027d1eed00044.png)

我的托管内容最初是一个上传到 Apple 的 pkg 文件，解压后转换为上述结构。我的应用内内容包含在所示的 .nib 文件中。

我以前从未使用过 nib 文件。但我有一个想法，它就像当前 XCode 版本中的故事板。但是，当我直接将上述 nib 文件导入 xcode 4.5 时，我只看到一个纯白色符号，没有控件或任何有意义的应用程序数据。如果我将它重命名为 xib，我会看到一些带有一些混乱字符的文本，以文本“NIBArchive”开头。

我的问题：

1 - 我如何查看它是否有意义 xib。我有什么错误吗？（原来是已经不在身边的其他人提交的，所以不得不问）

2 - 我如何从 Apple 服务器下载这个 pkg（是的，我已经提到过[这个](https://stackoverflow.com/questions/12994550/how-to-download-in-app-hosted-content/13226429#comment21024162_13226429)，但它没有提到 pkg 或 xib 文件）并解压缩/解压缩它以查看上述文件结构。

3 - 如果我在上述两个步骤中成功，我如何在运行时加载这个 xib 并使功能对用户可用。

我知道 2 和 3 要求太多，但就 Apple 托管的内容而言，即使是 Apple 论坛也没有太多可提供的内容。

非常感谢您的任何指点。

# android - 下载图像并显示

> ID：15051204
> 
> 赞同：1
> 
> 时间：2013-02-24T11:16:12.663
> 
> 标签：android

应用程序的主要目的是下载和显示图像，但是当我尝试启动应用程序时它崩溃了。

这是我的代码。

```
private DownloadImageTask task;

protected void onCreate(Bundle savedInstanceState) {
    task = new DownloadImageTask();
    task.onPostExecute(task.doInBackground("http://parkcinema.az/uploads/structures/movies/images/xickok_poster1_resized.jpg"));
    }

private class DownloadImageTask extends AsyncTask <String, Void, Bitmap> {

    protected Bitmap doInBackground(String... urls) {
        String urldisplay = urls[0];
        Bitmap mIcon11 = null;
        try {
            InputStream in = new java.net.URL(urldisplay).openStream();
            mIcon11 = BitmapFactory.decodeStream(in);
        } catch (Exception e) {
        Log.e("Error", e.getMessage());
        e.printStackTrace();
    }
    return mIcon11;
}        

protected void onPostExecute(Bitmap result) {
      ImageView img = (ImageView) findViewById(R.id.imageView1);
      img.setImageBitmap(result);           
}
} 
```

这是LogCat：

```
02-24 11:04:56.814: E/Trace(957): error opening trace file: No such file or directory (2)
02-24 11:04:57.384: D/AndroidRuntime(957): Shutting down VM
02-24 11:04:57.384: W/dalvikvm(957): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
02-24 11:04:57.404: E/AndroidRuntime(957): FATAL EXCEPTION: main
02-24 11:04:57.404: E/AndroidRuntime(957): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.bakumovies/com.example.bakumovies.MainActivity}: java.lang.NullPointerException: println needs a message
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.app.ActivityThread.access$600(ActivityThread.java:130)
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.os.Handler.dispatchMessage(Handler.java:99)
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.os.Looper.loop(Looper.java:137)
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.app.ActivityThread.main(ActivityThread.java:4745)
02-24 11:04:57.404: E/AndroidRuntime(957):  at java.lang.reflect.Method.invokeNative(Native Method)
02-24 11:04:57.404: E/AndroidRuntime(957):  at java.lang.reflect.Method.invoke(Method.java:511)
02-24 11:04:57.404: E/AndroidRuntime(957):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
02-24 11:04:57.404: E/AndroidRuntime(957):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
02-24 11:04:57.404: E/AndroidRuntime(957):  at dalvik.system.NativeStart.main(Native Method)
02-24 11:04:57.404: E/AndroidRuntime(957): Caused by: java.lang.NullPointerException: println needs a message
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.util.Log.println_native(Native Method)
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.util.Log.e(Log.java:231)
02-24 11:04:57.404: E/AndroidRuntime(957):  at com.example.bakumovies.MainActivity$DownloadImageTask.doInBackground(MainActivity.java:49)
02-24 11:04:57.404: E/AndroidRuntime(957):  at com.example.bakumovies.MainActivity.onCreate(MainActivity.java:27)
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.app.Activity.performCreate(Activity.java:5008)
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
02-24 11:04:57.404: E/AndroidRuntime(957):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
02-24 11:04:57.404: E/AndroidRuntime(957):  ... 11 more 
```

这是.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:layout_marginLeft="144dp" />

</RelativeLayout> 
```

我不明白为什么它会崩溃。在新线程中启动图像下载，创建 imageview 对象。我对此完全感到困惑。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:43:08.620

我怀疑它会有所帮助，但您不（可能不应该）手动调用 doInBackground AsyncTask 方法。Android 会自己做这件事。事实上，你的 AsyncTask 的整个逻辑有点偏离。onPostExecute 在 doInBackground 完成时调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:20:02.050

NPE 的原因（空指针异常）

> Log.e("错误", e.getMessage()); //e.getMessage() 为 NULL，因此它给出了 NPE。

```
protected void onCreate(Bundle savedInstanceState)
  task = new DownloadImageTask().execute("http://parkcinema.az/uploads/structures/movies/images/xickok_poster1_resized.jpg");
}

protected Bitmap doInBackground(String... urls) {
    String urldisplay = urls[0];
    Bitmap mIcon11 = null;
    try {
        mIcon11 = BitmapFactory.decodeStream(new URL(urldisplay).openConnection().getInputStream());
    } 
    catch (Exception e) {
        e.printStackTrace();
    }
    return mIcon11;
} 
```

> 在 AndroidManifest.xml 中添加此权限，因为您正在进行互联网操作。

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

# oracle-adf - ADF EO,VO,AM 实现类

> ID：15051207
> 
> 赞同：0
> 
> 时间：2013-02-24T11:16:52.460
> 
> 标签：oracle-adf

adf eo,vo 和 AM 实现类有什么要求？？？

我们什么时候需要这个？？

有人可以举一些例子吗？

我非常需要这些信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T11:01:05.103

你的问题太大了！！

当您需要一些基本功能中没有的功能时，使用 eo、vo 或 am 实现类。

例如，在视图对象的实现中。如果您需要进行特殊查询，您可以创建自己的方法或覆盖 executeQuery 方法以获得您的目标。但是，我必须告诉你，你应该只在必要时这样做。因为大部分事情你应该可以做adf的核心。

我使用更多次的其他示例是实现 VORowImp。当您必须编辑 Row 的属性时，这非常有用，因为使用该实现可以减少写入名称和类型时出错的可能性。

此外，您可以阅读[http://www.oracle.com/technetwork/developer-tools/adf/learnmore/adfinsider-093342.html](http://www.oracle.com/technetwork/developer-tools/adf/learnmore/adfinsider-093342.html)

我希望能帮助你。马科斯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T14:42:06.073

我同意马科斯卡的观点，这是一个需要回答的大问题。听起来您是 JDeveloper 和 ADF 的新手。我强烈建议阅读“Oracle 融合开发快速入门指南：Oracle JDeveloper 和 Oracle ADF”一书[http://www.amazon.com/Quick-Start-Oracle-Fusion-Development/dp/0071744282](https://rads.stackoverflow.com/amzn/click/com/0071744282)。它涵盖了 JDeveloper 和 ADF 的所有基本领域。总的来说，这是一本写得很好的书。

或者，如果您有能力，Oracle ADF 级别 I 和 II 是非常好的课程。我自己拿了这些。

请参阅以下链接。我在高层解释了在每个模型对象类型上使用实现类的作用：http: [//pitss.com/us/2013/03/08/the-role-of-entity-object-view-object-and -应用程序模块实现类/](http://pitss.com/us/2013/03/08/the-role-of-entity-object-view-object-and-application-module-implementation-classes/)

我希望很快能在上面的帖子上写一些代码示例，但你可能要到几周后才能看到那里的任何代码。

我希望这有帮助！

谢谢，

加文伍兹

# html - 让 textarea html 应用 tinyMCE 编辑器中给出的样式，数据库问题？

> ID：15051213
> 
> 赞同：0
> 
> 时间：2013-02-24T11:17:25.317
> 
> 标签：html, sql, tinymce, textarea, plaintext

我有一个可以工作的 tinyMCE 文本编辑器。唯一的事情是我输入到编辑器的文本是这样存储和检索的：

```
<p><strong>the first line</strong></p> <p><em>the second line</em></p> 
```

代替：

**第一行**

*第二行*

我认为问题与我在数据库中使用的字段类型有关。它应该是 VARCHAR、TEXT 还是其他？有人可以给我一些指示和解决方案吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:21:52.040

你`encoding: xml`在你的配置中设置了吗？更好的是，让我们看看你的配置。

# unity3d - Unity - 汽车 AI 避障

> ID：15051219
> 
> 赞同：-1
> 
> 时间：2013-02-24T11:18:22.630
> 
> 标签：unity3d, artificial-intelligence, unityscript, raycasting, racing

抱歉问得太频繁了。我对 Andrew Gotow 的汽车 AI 有疑问。问题是**人工智能没有避开他们面前的玩家/汽车，或者他们只是继续前进并撞到他们面前的玩家/汽车。当撞到汽车或任何障碍物时，它们会停止加速或停止工作。**

请帮我。我不知道如何让 AI 不应该撞到障碍物

这是我使用的代码。谢谢你的帮助

```
function GotNewWaypoint(newWay : Vector3, newRot : Quaternion){
    wpObj.transform.position = newWay;
    wpObj.transform.rotation = newRot;// wpObj is a triggered box collider that sets GotNewWaypoint function everytime AI hits the collider
}

function NavigateTowardsWaypoint(){ // Runs in Update function
var relativePosition : Vector3;
var hit : RaycastHit;

if(!alternativeWaypointer){
    relativePosition = transform.InverseTransformPoint(Vector3(wpObj.transform.position.x,transform.position.y,wpObj.transform.position.z));
}else{// turn on alternative position if Spherecast hits object
    relativePosition = transform.InverseTransformPoint(Vector3(raycaster*wpObj.transform.position.x,transform.position.y,wpObj.transform.position.z)); // move wpObj on axis x a bit so the AI shouldn't hit the obstacle
}

if(Physics.SphereCast(transform.position,40,transform.forward,hit,30)){
    if(hit.transform != this.transform){
        if(hit.collider.tag == "Player" || hit.collider.tag == "Opponent" || hit.collider.tag == "Environtment"){
            alternativeWaypointer = true;
            raycaster = -Vector3.Normalize(hit.point).x * 5;
        }else alternativeWaypointer = false;
    }
}

inputSteer = relativePosition.x / relativePosition.magnitude;//used for ai's handling control. usually it's 1 or -1

if(Mathf.Abs(inputSteer) < .5){
    inputTorque = relativePosition.z / relativePosition.magnitude; //corner is not too tight, accelerate
}else{
    inputTorque = 0.0; // corner is too tight, stop accelerating
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T14:19:24.867

据我所知，你的人工智能有一个测试，看看它是否会与什么东西发生碰撞。此测试的结果似乎已分配给`alternativeWaypointer`允许以下 if 语句的变量：

```
if(!alternativeWaypointer){
    relativePosition = computePosition(trajectory);
}else{
    relativePosition = computePosition(adjustTrajectory(trajectory));
} 
```

您的调整轨迹逻辑可能不起作用。也许这可以测试？取而代之的是，一个可能的问题是您调整后的轨迹没有充分调整以避免碰撞。我们可以通过创建一系列假设轨迹然后选择最佳候选来解决这个问题。

```
alternativeWaypointer = isCollisionLikely(trajectory);

if(!alternativeWaypointer) {
    relativePosition = computePosition(trajectory);
} else {
    /* generate alternative trajectories, adjustments range from minimal to extreme */
    List<Trajectory> alternatives = adjustTrajectoryList(trajectory, MINIMAL, EXTREME);

    /* Of these, pick one and run with it */
    Trajectory preferred = leastLikelyCollisionTrajectory(alternatives);
    relativePosition = computePosition(preferred);
} 
```

您可以使用现有逻辑来选择首选轨迹。它不会是世界上最复杂的东西，但它会是一个起点：

```
Trajectory leastLikelyCollistionTrajectory(List<Trajectory> options) {

    /* iterate from minimal adjustment to extreme */
    foreach(Trajectory t in options) {
        if(!isCollisionLikely(t)) {
            return t; /* return the first trajectory that seems ok */
        }
    }

    /* otherwise resort to the most extreme and hope */
    return options.last();
} 
```

我将伪代码与一些 java 混合在一起，以使其更清晰。这看起来会解决您的问题吗？

# node.js - 是否可以使用连接更新一个集合

> ID：15051221
> 
> 赞同：0
> 
> 时间：2013-02-24T11:19:07.020
> 
> 标签：node.js, mongodb, mongoose

我有两个具有以下架构的集合

```
var document = new TestDocAccess({
  documentId: '50dc37d6022b2bdd07000004',
  userId : "1234",
  userName : "Test Name",
  identifier : [String]
}); 
```

和

```
var master = new TestDocMaster({
  documentId: document._id,
  masterId: "50a5e7bcda3c4d557f00847a"
}); 
```

无论如何用集合中的更新集合`documents`中的字段。`masterId``master`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:19:51.653

在像 MongoDB 这样的基于文档的数据库中进行的任何“连接”都必须在您的应用程序中进行。所以基本上你必须首先从 中查询 id `master collection`，然后使用该 id 来更新`documents collection`.

# arrays - 使用非连续数字进行 F# 数组初始化

> ID：15051223
> 
> 赞同：4
> 
> 时间：2013-02-24T11:19:37.357
> 
> 标签：arrays, f#, initialization-list

是否有一个简短的符号来初始化具有 N 的倍数的 F# 数组，其中 N > 1？例如 N = 2：

```
{|2; 4; 6; 8; 10;|] 
```

也许，类似于默认 N = 1 的情况：

```
[|a..b|] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T11:23:18.483

其语法在语言中：

```
let a = [|2..2..10|]; 
```

中间的数字是值之间的步长。更有趣的是，您还可以使用序列表达式进行数组初始化：

```
let b = [| for i in 1 .. 10 -> i * i |] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-24T12:02:43.247

您也可以使用[Array.init](http://msdn.microsoft.com/en-us/library/ee370273.aspx)

```
let arr = Array.init 5 (fun i -> (i + 1) * 2) 
```

# php - 在 codeigniter 库中使用 mysql

> ID：15051228
> 
> 赞同：0
> 
> 时间：2013-02-24T11:20:54.670
> 
> 标签：php, mysql, codeigniter, libraries

如果我想执行查询，如何在 codeigniter 的库中使用 mysql 实例。班级看起来像

```
class Dtables {

    private $_db;

    function __construct()
    {
        //initialize $_db;

    }

    function mysql()
    {
        $sQuery ="//some mysql query string";
        $this->db->query($sQuery);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T11:44:43.060

您需要在您的库中引用 CI 对象实例：

```
class Dtables {

    private $CI;

    function __construct()
    {
        $this->CI =& get_instance();
        $this->CI->load->database(); 
    }

    function mysql()
    {
        $sQuery ="//some mysql query string";
        $this->CI->db->query($sQuery);
    }
} 
```

# html - 如果网站 html 页面上提供调查，则使用 TCL 和 HTML 提醒我我的电子邮件 ID

> ID：15051237
> 
> 赞同：0
> 
> 时间：2013-02-24T11:21:49.527
> 
> 标签：html, email, tcl

对不起，如果标题不合适.. 我正在寻找 TCL 代码，它将使用我在此网站上注册的我的 gmail id 和密码自动登录到网站**“ [http://www.opinionworld.in](http://www.opinionworld.in) ” 。**
之后该代码应单击我的帐户选项卡，然后单击此图标网站后 应选择**“进行调查” ，将您重定向到另一个网页，即****“http://dkr1.ssisurveys.com/projects/plist? psid=94mUddoHeetivfuUO0ZREg** &subpanelid=2&css=http%3A%2F%2Fd1g6vijl2fr6nr.cloudfront.net%2Fweb%2FsourceStyles%2Finvo%2Fstyle.css”**和页面显示 * *“更新您的个人资料”****当没有调查时就是这种情况，因此网站会告诉您更新您的个人资料。看看我担心的另一面 如果有任何调查可用，那么当您单击**“进行调查”**时，它会向您显示可用的调查，其首字母以正则表达式开头为“ORD-79558-KJTP”或**“ORD-79350- YTBQ”。******我在这里担心的是代码应该使用我的 gmail id 密码自动登录到该网站并选择**“进行调查”**，如果它读取可用的调查为**“ORD-79558-KJTP”或“ORD-79350-YTBQ”**然后代码应该通过我的 gmail ID 向我发送电子邮件，并在主题行中使用可用的调查代码（例如“ORD-79558-KJTP”），并且邮件应该是 FROM:me 到 TO:me。登录网站和进一步查找的过程应在 15 分钟间隔后发生……非常感谢您回答这个问题，如果需要进一步的输入，请更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T13:13:36.563

自动登录……这需要代码来处理我正在处理但尚未完成的 cookie 处理。（到目前为止，我有一个[部分规范](http://www.tcl.tk/cgi-bin/tct/tip/406.html)和一个[SCM 分支](https://core.tcl.tk/tcl/timeline?r=dkf-http-cookies)，其中包含大约 80% 熟的东西。）理论上，您可以使用当前的 http 包进行 cookie 处理，但您需要做很多很多工作，因为 cookie 规范并非微不足道（有些部分只有在您在实践中尝试时才会清楚）。

但这只是您完成任务所需的*一部分（这对我来说似乎很复杂！）。*其他部分，处理 http+cookie 并使用它来登录站点，本身就是一项主要任务。也许您应该倒退几步，看看是否有其他方法可以完成这项任务？是否有用于访问站点服务的 REST API？或者其他人用另一种语言制作了自动化库？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T13:10:28.643

正如 Donal 所说：使用 API 是最好的选择，但并非总是可行的。

如果你真的需要基于 cookie 的授权（我之前用 Tcl 做过），这是可能的，但并不容易。我通常遵循以下路径：

*   使用像[firebug](https://getfirebug.com/)这样的浏览器插件（Opera 和 Chrome 内置了这样的东西）来播放场景。看一下网络面板，并找到每次玩此游戏时不同的部分。（您可能想在登录等之前删除 cookie。）
*   尝试使用[`http::geturl`](http://wiki.tcl.tk/24061)以获得相同的结果。您可能会设置一些标题，尤其是。cookie，有关带有 http 包的 cookie 的一些详细信息，请参阅[Cookies 上的 Tcl/Tk wiki](http://wiki.tcl.tk/3828)，这不能完美地处理 cookie，但谁说你必须这样做？如果你得到不同的结果，那么你做错了什么。（有些网站不允许某些用户代理，因此找出它不起作用的**原因可能非常困难）**
*   尝试从结果中提取不同的东西。您可能必须使用正则表达式、一些标头，甚至可能是[tDOM](http://wiki.tcl.tk/1948)。

你看，这是很多尝试和错误，但有可能。

如果你最终得到你想要的结果，你可以发送邮件。使用 Tcl 发送邮件并不难，那里有教程（特别是在[Tcl/Tk wiki](http://wiki.tcl.tk/1256)上）。

# ios - 参考插座

> ID：15051240
> 
> 赞同：1
> 
> 时间：2013-02-24T11:22:01.377
> 
> 标签：ios, xcode, iboutlet

我创建了新文件 .h，当我将 'New Reference Outlet' 行拖到 上时`drawImageView`，它不会突出显示。

```
#import <UIKit/UIKit.h>
#import <QuartzCore/QuartzCore.h>

@interface JCDrawView : UIView
@property (nonatomic,retain) IBOutlet UIImageView *drawImageView;
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T11:44:23.923

首先，打开您的 xib 并选择它的根视图。

![在此处输入图像描述](../Images/b8149d5e0e5be8737db61ea5a6de763b.png)

然后，验证此视图的类是否为类型`MyCustomView`（`JCDrawView`在您的情况下）。

![在此处输入图像描述](../Images/22821253828223f783bd5d7529bfb968.png)

现在，可以通过您创建的视图中的插座来引用图像视图。

**NOTE** `MyCustomView`类与`JCDrawView`.

# php - MySQL 查找两个表之间库存水平的差异并返回结果

> ID：15051242
> 
> 赞同：1
> 
> 时间：2013-02-24T11:22:18.307
> 
> 标签：php, mysql, sql

我有两个表，第一个是昨天的库存水平，称为“**昨天**”，包含两列：

```
StockNumber, StockLevel 
```

第二个表是今天的库存水平，称为“ **today** ”，并具有相同的列“StockNumber, StockLevel”。

我的问题是，我如何找到“ **StockLevel** ”更改和“today”中出现的新“ **StockNumber** ”**的“昨天”和“****今天**”表之间的库存水平差异。

 ******如果这可以用直接的 SQL 来完成，那就太好了，但是使用 PHP 添加额外的处理级别也是可以的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T11:24:31.837

```
select y.StockNumber, t.StockLevel - y.StockLevel from yesterday as y inner join today as t on (y.StockNumber = t.StockNumber) 
```

编辑：

捕获今天表中不在昨天表中的产品：

```
select y.StockNumber, t.StockLevel - coalesce(y.StockLevel,0) from yesterday as y right join today as t on (y.StockNumber = t.StockNumber) 
```

合并确保如果您有一个不在的产品`yesterday`，您将得到`t.StockLevel - 0`而不是`t.StockLevel - NULL`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:38:09.253

这会让你知道昨天的变化，对于今天的新股票返回 null （即从昨天没有变化来显示）

```
SELECT t.stocknumber, t.stocklevel-y.stocklevel difference
FROM today t
LEFT JOIN yesterday y
  ON t.stocknumber = y.stocknumber 
```

[一个用于测试的 SQLfiddle](http://sqlfiddle.com/#!2/f1d04/7)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T11:31:25.543

那么，您可以使用以下 sql 找出昨天和今天的库存水平之间的差异。

```
select y.stockNumber, (t.stockLevel-y.stockLevel) as difference
from today t, yesterday y,
where t.stockNumber=y.stockNumber
group by t.stockNumber,t.stockLevel,y.stockLevel 
```

希望这可以帮助。******

# php - ajax提交的表单提交到预览表单后模拟后退按钮

> ID：15051243
> 
> 赞同：0
> 
> 时间：2013-02-24T11:22:21.723
> 
> 标签：php, javascript, ajax, forms, codeigniter

我有一个多部分的表格，其中数据流是：

1.  回答表格，提交（通过 ajax 帖子）
    *   jQuery Form 和 CodeIgniter 验证如果存在则回显
2.  预览表格中的答案
    *   选择：**取消**、**编辑**、**提交到数据库**

这三个选项是预览表单中具有唯一名称的提交按钮。我的**提交到数据库**过程已完成，而我在执行取消和编辑时遇到了困难。我目前对这三个的方法是（在控制器内部）：

```
function preview_form_redirect() 
{
  if ( isset($_POST['submit-form']) ) {
    $this->send_to_database();
  } else if ( isset($_POST['edit-form']) ) {
    // return to form with all answers intact
  } else { // CANCEL FORM
    redirect('accounts');
  }
} // END preview_form_redirect() 
```

我对 Edit 选项的计划是**模拟后退按钮**，因为我确信数据和 DOM 将完好无损。

我知道我对这两种方法的方法并不完美，但我被卡住了，不知道还有什么其他方法可以模拟这两种方法。是否有可能且兼容的方法可以为我的设置执行这两种操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:45:21.423

尝试使用原生 js back 方法：`history.back()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:48:15.667

你必须用Javascript来做。如果您的浏览器不完全支持 HTML5 历史 API，您可以使用这个使用 html5 推送状态的库或 html 片段：[https ://github.com/browserstate/History.js/](https://github.com/browserstate/History.js/)

当用户点击编辑按钮时，执行如下操作： History.pushState({state:1}, "State 1", "?state=1");

并在后退按钮上注册一个事件： History.Adapter.bind(window,'popstate',function(){ //从页面中删除可编辑元素 });

希望能帮助到你。

# c# - 定期更换桌面壁纸

> ID：15051245
> 
> 赞同：4
> 
> 时间：2013-02-24T11:22:30.410
> 
> 标签：c#, winforms

我在使用以下代码设置桌面墙纸时遇到问题。SystemParametersInfo 返回 true，但不会更改壁纸。和以前一样，没有任何变化。但我希望代码从 *.bmp 文件的目录中定期更改壁纸。请让我知道我在哪里犯了错误。

```
class Program
{
    [DllImport("user32.dll")]
    public static extern bool SystemParametersInfo(UInt32 uiAction, UInt32 uiParam, string pvParam, UInt32 fWinIni);
    static FileInfo[] images;
    static int currentImage;

    static void Main(string[] args)
    {
        DirectoryInfo dirInfo = new DirectoryInfo(@"C:/users/Smart-PC/Desktop");
        images = dirInfo.GetFiles("*.bmp", SearchOption.TopDirectoryOnly);

        currentImage = 0;

        System.Timers.Timer imageChangeTimer = new Timer(5000);
        imageChangeTimer.Elapsed += new ElapsedEventHandler(imageChangeTimer_Elapsed);
        imageChangeTimer.Start();

        Console.ReadLine();
    }

    static void imageChangeTimer_Elapsed(object sender, ElapsedEventArgs e)
    {
        const uint SPI_SETDESKWALLPAPER = 30;
        const int SPIF_UPDATEINIFILE = 0x01;
        const int SPIF_SENDWININICHANGE = 0x02;
        bool gk;
        gk = SystemParametersInfo(SPI_SETDESKWALLPAPER, 0, images[currentImage++].FullName, SPIF_SENDWININICHANGE | SPIF_UPDATEINIFILE);
        Console.Write(gk);
        Console.WriteLine(images[currentImage].FullName);
        currentImage = (currentImage >= images.Length) ? 0 : currentImage;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T14:47:11.607

我刚刚测试了这个，它对我有用。顺便说一句，根据操作系统，它仅适用于位图，如果您要尝试任何其他格式，则需要转换为位图。

```
using System;
using System.Runtime.InteropServices;

namespace ConsoleApplication1
{
    class Program
    {
        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern Int32 SystemParametersInfo(UInt32 uiAction, UInt32 uiParam, String         pvParam, UInt32 fWinIni);
        private static UInt32 SPI_SETDESKWALLPAPER = 20;
        private static UInt32 SPIF_UPDATEINIFILE = 0x1;
        private static String imageFileName = "c:\\test\\test.bmp";

        static void Main(string[] args)
        {
            SetImage(imageFileName);
            Console.ReadKey();
        }

        private static void SetImage(string filename)
        {
            SystemParametersInfo(SPI_SETDESKWALLPAPER, 0, filename, SPIF_UPDATEINIFILE);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T13:11:59.910

`SPI_SETDESKWALLPAPER`should be`0x14`和 not的值`30`。

也`SPIF_UPDATEINIFILE`应该`SPIF_SENDWININICHANGE`是`uint`类型。

> > ```
> > const uint SPI_SETDESKWALLPAPER = 0x14;
> > const uint SPIF_UPDATEINIFILE = 0x01;
> > const uint SPIF_SENDWININICHANGE = 0x02; 
> > ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T14:05:55.110

我写了一个非常相似的应用程序，我使用这些值，它对我有用：

```
public void SetWallpaper(String path)
{
    // DLL Import
    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    private static extern int SystemParametersInfo(
        Int32 uAction, 
        Int32 uParam, 
        String lpvParam, 
        Int32 fuWinIni);

    // Consts
    private const Int32 SPI_SETDESKWALLPAPER = 20;
    private const Int32 SPIF_UPDATEINIFILE = 0x01;
    private const Int32 SPIF_SENDWININICHANGE = 0x02;

    // Changing the background.
    SystemParametersInfo(
        SPI_SETDESKWALLPAPER, 
        0, 
        path, // desktopBackground is the bmp location
        SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE);
} 
```

# java - 使用 JPanel 上的 Jbutton 隐藏/显示 JFrame

> ID：15051247
> 
> 赞同：0
> 
> 时间：2013-02-24T11:22:50.120
> 
> 标签：java, swing, jframe

在我的 Swing 应用程序中，我有 2 个 JFrame A 和 B。当我单击 JFrame A 上的按钮时，它会打开 JFrame B 并隐藏自身（我设法做到了那部分）

在 JFrame B 上，我在 JTabbedPane 上放置了 4 个 JPanel。每个 JPanel 有 2 个 JButton。

当我单击 JPanel 上的 Jbutton 并再次显示 Jframe A 时，我试图隐藏 JFrame B。

我该怎么做呢？

// JPanel 类

公共类 AddItemPanel 扩展 javax.swing.JPanel {

```
 public AddItemPanel() {
        initComponents();
  }

  private void btnCancelActionPerformed(java.awt.event.ActionEvent evt) {                                          

      if(evt.getSource() == btnCancel)
      {
        ItemFrame d = new ItemFrame();      
             d.setVisible(false);// not working
             this.setVisible(false);// not working
      }
} 
```

}

// JFrame 类

公共类 ItemFrame 扩展 javax.swing.JFrame {

```
 public ItemFrame() {

        initComponents();
        jTabbedPane1.add("Add Items",new AddItemPanel());
        jTabbedPane1.add("Delete Items",new DeleteItemPanel());
        jTabbedPane1.add("Update Items",new UpdateItemPanel());
        jTabbedPane1.add("Search Items",new SearchItemPanel());
 } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:42:45.697

试试这个例子希望它对你有用

```
 import java.awt.Color;
import java.awt.FlowLayout;
import java.awt.event.*;
import javax.swing.*;

public class JframeTest implements ActionListener
{
    JButton b1;
    JButton b2;
    JFrame f1 ;
    JFrame f2;

public void init()
{
 f1 = new JFrame("Frame one");
 f2 = new JFrame("Frame two");

 f1.setSize(400,400);
 f2.setSize(400,400);

 f1.setLayout(new FlowLayout());
 f2.setLayout(new FlowLayout());

 b1 = new JButton("Open Frame two");
 b2= new JButton("Open Fram one");
 JPanel p1 = new JPanel();
 JPanel p2 = new JPanel();

 p1.setBackground(Color.white);
 p2.setBackground(Color.white);
 p1.add(b1);
 p2.add(b2);

f1.getContentPane().add(p1);
f2.getContentPane().add(p2);

f1.setVisible(true);
f2.setVisible(false);
f1.setDefaultCloseOperation(3);
f2.setDefaultCloseOperation(3);

b1.addActionListener(this);
b2.addActionListener(this);
}
public void actionPerformed(ActionEvent evt)
{
    if(evt.getSource() == b1)
    {
        f1.setVisible(false);
        f2.setVisible(true);
    }else if(evt.getSource()==b2)
    {
        f1.setVisible(true);
        f2.setVisible(false);
    }

}

public JframeTest()
{
    this.init();
}
public static void main(String...argS)
{
    new JframeTest();
}
} 
```

# javascript - 立即在一组 div 中显示正确的 div 并再次循环

> ID：15051248
> 
> 赞同：0
> 
> 时间：2013-02-24T11:22:55.693
> 
> 标签：javascript, jquery

我正在做一个学校项目，我需要你的帮助。我所做的是通过一组 div 的无限循环。有3个div和3个链接。当我点击这些链接时，应该立即显示正确的 div（并在此之后显示所有 div 并再次循环）。问题是当我点击时会有延迟，这是我不想要的......当我点击链接时，是否有可能立即下雪？还有其他更简单/不太复杂的方法吗？你能更改/添加我需要的代码吗？先感谢您。

```
<ul id="cyclelist">
  <li><div>Div 1</div></li>
  <li><div>Div 2</div></li>
  <li><div>Div 3</div></li>
</ul>
</br></br>
<a href="#" class="className1">link1</a><br/>
<a href="#" class="className2">link2</a><br/>
<a href="#" class="className3">link3</a><br/>

var j=0;
function changeOnClick()
{

$("a").click(function(e) {
    e.preventDefault();
    if ($(this).hasClass('className1')) {
        j=-1;
    }
    else if ($(this).hasClass('className2')) {
        j=0;
    }
    else if ($(this).hasClass('className3')) {
        j=1;
    }
});
}

 var delay = 2000;
 function cycle(){
        var jmax = $("ul#cyclelist li").length -1;
        changeOnClick();
         $("ul#cyclelist li:eq(" + j + ")")
                 .animate({"opacity" : "1"} ,400)
                 .animate({"opacity" : "1"}, delay)
                 .animate({"opacity" : "0"}, 400, function(){
                         (j == jmax) ? j=0 : j++;
                         cycle();
                 });
         };
 cycle(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:33:50.380

```
.animate({"opacity" : "1"} ,400) 
```

动画的第二个参数代表速度，这就是为什么你得到延迟删除

这是 .animate 的语法

```
$(selector).animate({params},speed,callback); 
```

一旦通过它.. [http://www.w3schools.com/jquery/jquery_animate.asp](http://www.w3schools.com/jquery/jquery_animate.asp)

**编辑-** 为您的评论..我不知道天气是正确的方法..最好使用 setTimeout() 调用 cycle();

```
setTimeout(cycle,2000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:38:14.807

尝试从事件处理程序调用循环函数。像这样的东西

```
if ($(this).hasClass('className1')) {
    j=-1;
    cycle();
} 
```

这应该可以解决您的问题。

# java - 对象实例化顺序和空指针异常

> ID：15051251
> 
> 赞同：0
> 
> 时间：2013-02-24T11:23:19.897
> 
> 标签：java

我正在尝试像这样实例化两个类：

```
ball = new Ball(gc, board, player, ai, score);      
ai = new AiPaddle(gc, ball); 
```

我的问题是我的 Ball 类不断抛出空指针异常，因为我正在传递尚未实例化的 ai。

颠倒这些对象的创建顺序只会让我的 AiPaddle 类抛出错误，因为它需要球类。

解决此类问题的最佳方法是什么？我通过在我的球类中创建一个名为 addAi 的新方法来修复它，它取而代之的是 ai，所以我有这个：

```
ball = new Ball(gc, board, player, score);      
ai = new AiPaddle(gc, ball);    
ball.addAi(ai); 
```

但我确信有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:26:26.127

更好的方法是拥有第三个了解 Ball 和 AiPaddle 的“主”对象。实例化 ball 和 ai，然后将它们传递给“master”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:36:35.443

正如 Lucas Knuth 所评论的，你有一个设计问题。您找到的解决方案是一个很好的解决方案，但不要忘记约定：您正在设置 Ball 的属性，因此您应该调用方法 setAi()，而不是 addAi()。

下一次，当你设计你的课程时，尽量避免这个问题。

# jquery-ui - 如何使用 AngularJS 更新 jQueryUI Selectable 的选定项目？

> ID：15051253
> 
> 赞同：1
> 
> 时间：2013-02-24T11:23:32.083
> 
> 标签：jquery-ui, angularjs, jquery-ui-selectable, angular-ui

我想将 jQueryUI Selectable 小部件与 AngularJS 一起使用。我设法使用`ui-jq`来自 AngularUI 的 jQuery Passthrough 指令来包含它，该指令可以很好地获得所需的 UI 效果。现在我想使用 AngularJS 更新所选项目的数据，但想不出办法。

我找到了[AngularUI Sortable 指令](https://github.com/angular-ui/angular-ui/blob/master/modules/directives/sortable/REDME.md)，这可能是实现 Selectable 指令的一个很好的起点，但是当我刚开始使用 AngularJS 时，我很难让它适应我的需要。

例子：

[http://jsfiddle.net/ffeldha/2KzRt/](http://jsfiddle.net/ffeldha/2KzRt/)

如何更新所选项目的名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T14:24:50.520

您可以在不需要 angular-ui 的情况下为 selectable 创建一个指令，并`addItem()`在范围内添加具有方法的项目

HTML：

```
<ol ui-selectable> 
```

JS

```
var myApp = angular.module('soil', [])

myApp.directive('uiSelectable', function () {
    return function (scope, el, attrs) {
        el.selectable();
    };
});

function ItemCtrl($scope) {
    /* triggered by "ng-submit" on a form*/
    $scope.addItem = function () {
        /* newItem comes from "ng-model" on an input*/
        if (!$scope.newItem.length) {
            return;
        }
        $scope.items.push({
            name: $scope.newItem
        });

        $scope.newItem = '';
    };
    $scope.newItem = '';
    $scope.items = [{
        name: 'one'
    }, {
        name: 'two'
    }, {
        name: 'three'
    }];
} 
```

演示：http: [//jsfiddle.net/2KzRt/5/](http://jsfiddle.net/2KzRt/5/)

**更新** 以下是如何创建一组动态模型以在选择时更新列表项：

HTML：

```
 <div id="update_items" ng-show="updateItems.length">
        <div ng-repeat="item in updateItems"> 
           <input value="{{item.name}}" ng-model="items[item.index].name"/>
        </div>
        <button ng-click="updateItems=[]">Cancel</button>
    </div> 
```

JS：

```
var myApp = angular.module('soil', [])

myApp.directive('uiSelectable', function () {
    return function (scope, el, attrs) {
        el.selectable({
            stop:function(evt,ui){

                var selected=el.find('.ui-selected').map(function(){
                    var idx=$(this).index();
                    return {name: scope.items[idx].name, index:idx}
                }).get();

                scope.updateItems=selected;
                scope.$apply()
            }
        });
    };
});

function ItemCtrl($scope) {

    $scope.addItem = function () {
        if (!$scope.newItem.length) {
            return;
        }
        $scope.items.push({
            name: $scope.newItem
        });

        $scope.newItem = '';
    };
    $scope.newItem = '';
    $scope.updateItems=[];
    $scope.items = [{
        name: 'one'
    }, {
        name: 'two'
    }, {
        name: 'three'
    }];
} 
```

演示：http: [//jsfiddle.net/2KzRt/7/](http://jsfiddle.net/2KzRt/7/)

# php - 使用“php”命令时如何指定 PHP 版本

> ID：15051256
> 
> 赞同：0
> 
> 时间：2013-02-24T11:24:16.360
> 
> 标签：php

我有一台服务器，上面有 PHP 5.2 和 5.3，默认版本是 5.2，每当我使用命令“php”时，它都会使用 5.2 版本。有什么方法可以在运行命令时指定版本？php -v 只显示版本。

对于应用程序，我使用 .htaccess 来设置版本，比如`AddHandler application/x-httpd-php53 .php`

使用命令“php”时有没有类似的方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T11:27:16.340

`/usr/bin/php5.3`但是使用正确的php版本的路径。您可以使用它`which php`来查找路径。

如果您不想输入完整路径，可以在 .bashrc 中设置别名

# twitter4j - getURLEntities twitter4j

> ID：15051258
> 
> 赞同：0
> 
> 时间：2013-02-24T11:24:21.157
> 
> 标签：twitter4j

我正在使用 getURLEntities() (twitter 4 j)

```
 b.getURLEntities().toString(); 
```

我没有获取 url 实体，而是获取控制台输出，如下所示：

> [Ltwitter4j.URLEntity;@ccd249 [Ltwitter4j.URLEntity;@101f287 [Ltwitter4j.URLEntity;@d9973a [Ltwitter4j.URLEntity;@1578426 [Ltwitter4j.URLEntity;@a4effe

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T12:05:07.543

再次检查[文档](http://twitter4j.org/javadoc/twitter4j/URLEntity.html)。

该`getURLEntities()`方法返回一个数组`URLEntity`

```
URLEntity[] urls = b.getURLEntities(); 
```

如果您想正确输出，最好使用循环

```
for(URLEntity url : urls){
  System.out.println(url.getURL());
} 
```

# ruby-on-rails - 使用 websolr 索引文档

> ID：15051264
> 
> 赞同：0
> 
> 时间：2013-02-24T11:25:42.077
> 
> 标签：ruby-on-rails, heroku, solr, lucene, websolr

我们正在考虑使用 Websolr 插件在我们的 Rails 应用程序中搜索资源。

该应用程序包含许多资源模型。大多数资源模型是自包含的，具有一系列属性：作者、标题、一组标签等，但是一些资源模型附有 pdf。我们需要为此 pdf 的内容编制索引，以便将其作为资源的一部分进行搜索。

我应该如何处理这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T15:55:27.527

这应该让您开始：[ExtractingRequestHandler](https://wiki.apache.org/solr/ExtractingRequestHandler)，它将[Tika](https://tika.apache.org/)集成到 Solr 中。

# sql - SQL 关键字 FROM 附近的语法不正确

> ID：15051266
> 
> 赞同：-4
> 
> 时间：2013-02-24T11:26:12.973
> 
> 标签：sql, sql-server-2008

我不断收到此错误

> *关键字 from 附近的语法不正确*

当我尝试运行此查询时。我对 SQL 相当陌生，所以我可能错过了一些东西。我正在使用 SQL Server 2008

基本上我想要做的是让列`lastreturndate`具有 value `= Checkoutdate + Loanperiod`。由于`loanperiod`在不同的表中，我创建了一个包含`Checkoutdate, lastreturndate, loanperiod`.

我正在努力实现的示例

```
Checkoutdate    loanperiod      lastreturndate

  2012-1-01          3           2012-4-01 
```

SQL 代码：

```
DECLARE @lastreturndate DATETIME
SET @lastreturndate = dateadd(month,loanperiod,CheckOutDate)
INSERT INTO Loan(lastreturndate) VALUES (@lastreturndate) 
FROM dbo.returndateview 
```

`dbo.returndateview`= 是我创建的视图

[图片链接 http://imageshack.us/a/img69/3048/68810818.png](http://imageshack.us/a/img69/3048/68810818.png)到ERD

注意item_details中的category应该叫做loan period

链接到我的观点[http://img194.imageshack.us/img194/8200/viewsm.png](http://img194.imageshack.us/img194/8200/viewsm.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:30:35.567

代替

```
INSERT INTO Loan(lastreturndate) VALUES (@lastreturndate) 
FROM dbo.returndateview 
```

尝试

```
insert into Loan(lastreturndate)
select ___ from dbo.returndateview where ___ = @lastreturndate 
```

（您需要使用视图中的列填写*_*）。

..或者它可能很简单：

```
DECLARE @lastreturndate DATETIME
SELECT @lastreturndate = dateadd(month,loanperiod,CheckOutDate) FROM dbo.returndateview
INSERT INTO Loan(lastreturndate) VALUES (@lastreturndate) 
```

根据您上次的编辑，我认为这就是您想要的：

```
update loan set
    lastReturndate = dateadd(month, detail.loanperiod, CheckOutDate)
from loan
join item on loan.barcode = item.barcode
join item_detals detail on item.isbn = detail.isbn 
```

如果您需要您的观点，我相信您需要将其更改为：

```
create view returnDateView as
select
   detail.loanperiod,
   loan.CheckOutDate,
   loan.LastReturndate
from loan
join item on loan.barcode = item.barcode
join item_detals detail on item.isbn = detail.isbn 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:36:36.720

我想你正在尝试做一个`UPDATE`. 假设您的视图和 Loan 表是相关的`loanid`，您可以尝试

```
Update L set L.lastreturndate = dateadd(month,v.loanperiod,v.CheckOutDate)
From Loat L join dbo.returndateview v
            on L.loanId = v.loanId --You should have this relation 
```

或者，如果您可以将视图重新设计为

```
create view dbo.returndateview
as
  select Checkoutdate,loanperiod,
       dateadd(month,loanperiod,CheckOutDate) lastreturndate
  from YourTable 
```

# asp.net - 在 App_Code 文件夹之外对 ASP.NET 网站代码进行单元测试

> ID：15051269
> 
> 赞同：-1
> 
> 时间：2013-02-24T11:26:59.170
> 
> 标签：asp.net, unit-testing

我想对一个明显位于App_code 文件夹**之外的网页进行单元测试。**

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:32:47.293

这取决于您实际测试的内容，有针对 HTML 输出的测试，但也许在 ASP.Net MVC 中您想要测试的是控制器。如果您正在测试数据结果，那么您的测试甚至会在项目之外执行。测试 aspx 文件实际上很难测试，因为有太多东西混合在一起，以至于没有一种工具可以用单一方法来测试它们。

# php - 使用安卓模拟器访问本地数据库

> ID：15051273
> 
> 赞同：1
> 
> 时间：2013-02-24T11:27:13.100
> 
> 标签：php, android, json, login, registration

我正在使用[http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/](http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/) 。我在这里用 JSON 标记面临几个问题。我不知道现在该怎么办。我想补充一点，我的本地主机是 ar 端口 81。我只是分别更改了登录和注册 url 中的 localhost:81/android_login_api/ 和 localhost:81/android_login_api/ 。这是我的 logcat 错误-

```
02-24 11:17:58.000: E/JSON(1364): <br />
02-24 11:17:58.000: E/JSON(1364): <b>Parse error</b>:  syntax error, unexpected $end in <b>C:\xampp\htdocs\android_login_api\include\DB_Connect.php</b> on line <b>46</b><br />
02-24 11:17:58.011: E/JSON Parser(1364): Error parsing data org.json.JSONException: Value <br of type java.lang.String cannot be converted to JSONObject
02-24 11:17:58.011: D/AndroidRuntime(1364): Shutting down VM
02-24 11:17:58.011: W/dalvikvm(1364): threadid=1: thread exiting with uncaught exception (group=0x40a70930)
02-24 11:17:58.030: E/AndroidRuntime(1364): FATAL EXCEPTION: main
02-24 11:17:58.030: E/AndroidRuntime(1364): java.lang.NullPointerException
02-24 11:17:58.030: E/AndroidRuntime(1364):     at com.example.androidhive.RegisterActivity$1.onClick(RegisterActivity.java:64)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at android.view.View.performClick(View.java:4202)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at android.view.View$PerformClick.run(View.java:17340)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at android.os.Handler.handleCallback(Handler.java:725)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at android.os.Handler.dispatchMessage(Handler.java:92)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at android.os.Looper.loop(Looper.java:137)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at android.app.ActivityThread.main(ActivityThread.java:5039)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at java.lang.reflect.Method.invokeNative(Native Method)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at java.lang.reflect.Method.invoke(Method.java:511)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-24 11:17:58.030: E/AndroidRuntime(1364):     at dalvik.system.NativeStart.main(Native Method) 
```

这是我的 php 代码——

```
<?php
class DB_Connect {

    // constructor
    function __construct() {
    $sql = "CREATE TABLE IF NOT EXISTS users(
               uid int(11) primary key auto_increment,
               unique_id varchar(23) not null unique,
               name varchar(50) not null,
               email varchar(100) not null unique,
               encrypted_password varchar(80) not null,
               salt varchar(10) not null,
               created_at datetime,
               updated_at datetime null
            );
      mysql_query($sql);

    }

    // destructor
    function __destruct() {
        // $this->close();
    }

    // Connecting to database
    public function connect() {
        require_once 'include/config.php';
        // connecting to mysql
        $con = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);
        // selecting database
        mysql_select_db(DB_DATABASE);

        // return database handler
        return $con;
    }

    // Closing database connection
    public function close() {
        mysql_close();
    }

}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:59:13.570

您的文件似乎`C:\xampp\htdocs\android_login_api\include\DB_Connect.php`包含语法错误。您的服务器返回一个 HTML 站点（包含有关此错误的信息）而不是 JSON 编码的结果字符串。

JSONParser 需要类似`"{somedata:true}"`but gets`<br />`和其他 HTML-Tags 之类的东西，然后抛出一个`JSONException`最终返回的东西`null`（这本身会导致`NullPointerException`）

您可能想看看[这个问题](https://stackoverflow.com/questions/10376645/org-json-jsonexception-value-br-of-type-java-lang-string-cannot-be-converted-t)。

# matlab - 逻辑索引而不是查找

> ID：15051275
> 
> 赞同：1
> 
> 时间：2013-02-24T11:27:18.890
> 
> 标签：matlab

我想改进一段代码

```
LaserS_P=rand(20,3); % duumy data
LaserS_P(1:4:end,1)=0;
index_= find( LaserS_P(:,1)); % finds o element in first row of 20*3 matrix.
LaserS_P_new=LaserS_P(index_,:); % remove all rows (index_) from matrix 
```

在这种情况下，我如何使用逻辑索引。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T14:04:48.123

要删除所有零值行（这不是您的示例所做的），您可以使用逻辑索引，如下所示：

```
LaserS_P=rand(20,3); % dummy data
LaserS_P(1:4:end,1)=0;
index_= ( LaserS_P(:,1) == 0); %# finds 0 element in first col of 20*3 matrix.
%# index_ is a logical vector with ones wherever LaserS_P's first col is 0
LaserS_P_new=LaserS_P(~index_,:); %# remove all rows (index_) from matrix

%# alternatively
LaserS_P_new(index_,:) = []; %# remove all rows (index_) from matrix 
```

# php - Elastic Beanstalk - PHP / 强制 HTTPS

> ID：15051278
> 
> 赞同：4
> 
> 时间：2013-02-24T11:27:44.643
> 
> 标签：php, amazon-web-services, amazon-elastic-beanstalk

在将 Amazon Elastic Beanstalk 与 PHP 结合使用时，如何将所有流量从 http 重定向到 https？我已经将我的 Beanstalk 设置为具有 https 端口（所有证书和东西都已设置）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-24T11:34:36.053

Beanstalk 设置其负载均衡器以将`X-Forwarded-Proto`标头发送到您的实例。

```
if ($_SERVER['HTTP_X_FORWARDED_PROTO'] !== 'https') {
    // redirect to secure site
    header('Location: https://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']);
} 
```

[不过，由于中间人攻击中使用了SSL 剥离](http://www.thoughtcrime.org/software/sslstrip/)技术，有些人会发誓根本不启用 HTTP 。

话虽如此，您可以通过使用[HSTS](http://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security)来减轻 SSL 剥离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-10T21:21:06.367

如果您有单实例弹性 beanstalk 环境，请尝试以下解决方案：[AWS Elasticbeanstalk single instance Force SSL Redirect loop](https://stackoverflow.com/questions/20363051/aws-elasticbeanstalk-single-instance-force-ssl-redirect-loop)

# python - 使用 urllib 提交表单

> ID：15051279
> 
> 赞同：0
> 
> 时间：2013-02-24T11:27:56.097
> 
> 标签：python, forms, urllib

在 Python 2 中，在网页中提交表单时，我们可以使用 mechanize。我们也可以看到网页中的表格使用。但是如何在 Python 3 中使用 urllib 来做到这一点（即查找表单并提交值）。我知道如何使用 POST 在 urllib 中提交表单。但是如何找到表格呢？以及如何使用 urllib 覆盖只读值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:07:26.333

POST 请求中没有只读值之类的东西。如果要查找表单，则必须自己检查 HTML，也许使用[`lxml.html`](http://lxml.de/lxmlhtml.html).

所以你会手动找到`<form>`元素，然后手动找到任何`<input>`元素（等等），然后手动构造一个 POST 请求。

但是，正如 Pace 指出的（在删除他的提交之前），`lxml.html`有[一种访问表单数据的特定方法](http://lxml.de/lxmlhtml.html#forms)，您可能会觉得这很有帮助。

# c# - NHibernate 3.3 映射错误

> ID：15051282
> 
> 赞同：1
> 
> 时间：2013-02-24T11:28:11.537
> 
> 标签：c#, asp.net, asp.net-mvc, nhibernate

你知道映射文件的问题在哪里吗？

Eroor：无法编译映射文件：NHibernateTutorial.Mapping.Character.hbm.xml

我添加我所有的文件。

特点

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace NHibernateTutorial.Domain
{
    public class Character
    {
        public virtual Guid Id { get; set; }
        public virtual string Name { get; set; }
        public virtual int HealthPoints { get; set; }
        public virtual int Mana { get; set; }
        public virtual string Profession { get; set; }
    }
} 
```

映射（**Character.hbm.xml**）

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="NHibernateTutorial"
                   namespace="NHibernateTutorial.Domain">

  <class name="Character">
    <id name="Id">
      <generator class="guid" />
    </id>
    <property name="Name" />
    <property name="HealthPoints" />
    <property name="Mana" />
    <property name="Profession" />
  </class>

</hibernate-mapping> 
```

错误

![在此处输入图像描述](../Images/b5400e71a37bec2b8992c50271f57f69.png)

连接字符串

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
  <session-factory>
    <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
    <property name="dialect">NHibernate.Dialect.MsSql2012Dialect</property>
    <property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>
    <property name="connection.connection_string">Data Source=RAFAL-KOMPUTER\MSSQLSERVER4;Database=rafal;Trusted_Connection=True;</property>
  </session-factory>
</hibernate-configuration> 
```

NHibernateHelper

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using NHibernate;
using NHibernate.Cfg;
using NHibernateTutorial.Domain;

namespace NHibernateTutorial
{
    public class NHibernateHelper
    {
        private static ISessionFactory _sessionFactory;

        private static ISessionFactory SessionFactory
        {
            get
            {
                if (_sessionFactory == null)
                {
                    var configuration = new Configuration();
                    configuration.Configure();
                    configuration.AddAssembly(typeof(Character).Assembly);
                    _sessionFactory = configuration.BuildSessionFactory();
                }
                return _sessionFactory;
            }
        }

        public static ISession OpenSession()
        {
            return SessionFactory.OpenSession();
        }

    }
} 
```

字符库

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using NHibernateTutorial.Domain;
using NHibernate;

namespace NHibernateTutorial
{
    public class CharacterRepository
    {
        public void Add(Character newCharacter)
        {
            using (ISession session = NHibernateHelper.OpenSession())
            {
                using (ITransaction transaction = session.BeginTransaction())
                {
                    session.Save(newCharacter);
                    transaction.Commit();
                }
            }
        }

        public Character GetCharacterByName(string name)
        {
            using (ISession session = NHibernateHelper.OpenSession())
            {
                var result = session.QueryOver<Character>().Where(x => x.Name == name).SingleOrDefault();
                return result ?? new Character();
            }
        }

        public void Update(Character newCharacter)
        {
            using (ISession session = NHibernateHelper.OpenSession())
            {
                using (ITransaction transaction = session.BeginTransaction())
                {
                    session.Update(newCharacter);
                    transaction.Commit();
                }
            }
        }

        public void Delete(Character newCharacter)
        {
            using (ISession session = NHibernateHelper.OpenSession())
            {
                using (ITransaction transaction = session.BeginTransaction())
                {
                    session.Delete(newCharacter);
                    transaction.Commit();
                }
            }
        }

    }
} 
```

异常详情： ![在此处输入图像描述](../Images/76c6b5d4cc47eecd2ed8558f2b4c2c38.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T12:59:27.747

查看您的异常详细信息：

> 无法实例化方言类 NHibernate.Dialect.MsSql2012Dialect [...]

您的问题不在于映射，而在于您如何指定数据库服务器技术 (RDBMS) 方言。这可能是由于各种原因而发生的：

*   您正在尝试使用您下载的 NHibernate 版本中不存在的方言：*您是否拥有最新版本（3.0、3.1、3.2、3.3...？）。*

*   您在错误的地方或以错误的方式指定方言。

仔细检查您的配置以及您是否拥有最新版本的 NHibernate！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T12:46:04.997

您是否在 VS 的属性中将映射文件 Character.hbm.xml 标记为嵌入式资源？

# java - Camera.autoFocus(myAutoFocusCallback) 不起作用

> ID：15051285
> 
> 赞同：0
> 
> 时间：2013-02-24T11:28:26.847
> 
> 标签：java, android, android-camera

我的 android autoFocus() 函数有问题。我只想让我的应用在拍照时自动对焦。

```
camera.autoFocus(myAutoFocusCallback); 
```

根本不起作用。Log.i(MainActivity.TAG, params.getFocusMode()); 打印“自动”。我的相机支持自动对焦^^

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:35:57.337

你开始相机预览了吗？[Javadoc](http://developer.android.com/reference/android/hardware/Camera.html#autoFocus%28android.hardware.Camera.AutoFocusCallback%29)说：

> 此方法仅在预览处于活动状态时（在 startPreview() 和 stopPreview() 之前）有效。

# php - PHP：mb_strtoupper 不工作

> ID：15051286
> 
> 赞同：6
> 
> 时间：2013-02-24T11:28:35.093
> 
> 标签：php, utf-8, mbstring

我对 UTF-8 和 mb_strtoupper 有疑问。

```
mb_internal_encoding('UTF-8');
$guesstitlestring='Le Courrier de Sáint-Hyácinthe';

$encoding=mb_detect_encoding($guesstitlestring);
if ($encoding!=='UTF-8') $guesstitlestring=mb_convert_encoding($guesstitlestring,'UTF-8',$encoding);

echo "DEBUG1 $guesstitlestring\n";
$guesstitlestring=mb_strtoupper($guesstitlestring);
echo "DEBUG2 $guesstitlestring\n"; 
```

结果：

```
DEBUG1 Le Courrier de Sáint-Hyácinthe
DEBUG2 LE COURRIER DE S?INT-HY?CINTHE 
```

我不明白为什么会这样？我正在尝试尽可能小心地使用编码。该字符串首先作为 UTF-8 给出，经过验证并可能重新转换为 UTF-8。这是一场噩梦！

**更新**

所以我发现这是由我通过控制台输入参数和从控制台返回的参数组合引起的。因此，他们在进出时都出现了乱码。解决方案是不以这种方式输入任何参数，或者以这种方式取出参数。

感谢大家帮助解决这个问题！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T11:45:16.930

不要`strtoupper()/mb_strtoupper()`使用，`mb_convert_case()`因为大写转换在不同的编码中非常棘手，还要确保你的字符串是 UTF-8。

```
$content = 'Le Courrier de Sáint-Hyácinthe';

mb_internal_encoding('UTF-8');
if(!mb_check_encoding($content, 'UTF-8')
    OR !($content === mb_convert_encoding(mb_convert_encoding($content, 'UTF-32', 'UTF-8' ), 'UTF-8', 'UTF-32'))) {

    $content = mb_convert_encoding($content, 'UTF-8'); 
}

// LE COURRIER DE SÁINT-HYÁCINTHE
echo mb_convert_case($content, MB_CASE_UPPER, "UTF-8"); 
```

**工作示例：http: [//3v4l.org/enEfm#v443](http://3v4l.org/enEfm#v443)**

另请参阅我在 PHP 网站上关于转换器的评论：[http ://www.php.net/manual/function.utf8-encode.php#102382](http://www.php.net/manual/function.utf8-encode.php#102382)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T11:52:52.413

它对我有用，但只有当 php 文件本身保存为 UTF-8 并且我所在的终端需要 UTF-8 时。我认为您正在发生的事情是该文件保存为 ISO-8859-1 并且您的终端期待 ISO-8859-1。

首先，`mb_detect_encoding` **实际上不**适用于此字符串。即使 PHP 文件不是 UTF-8，它仍然会将其报告为 UTF-8。

当您打印小写字符串时，它会打印 ISO-8859-1 字符，并且您的终端会很好地显示它们。然后，当您使用 UTF-8 转换为大写时，它会被破坏。

我创建了这个文件的两个版本。我使用 ISO-8859-1 中的文本编辑器将其保存为`iso-8859-1.php`. 然后我使用 iconv 将整个文件转换为 UTF-8 并保存为`utf-8.php`

```
iconv iso-8859-1.php --from iso-8859-1 --to UTF-8 > utf-8.php 
```

我添加了一行来打印 mb_detect_encoding 返回的编码结果。

```
$ file iso-8859-1.php 
iso-8859-1.php: PHP script, ISO-8859 text

$ php iso-8859-1.php 
ENCODING: UTF-8
DEBUG1 Le Courrier de S�int-Hy�cinthe
DEBUG2 LE COURRIER DE S?INT-HY?CINTHE

$ file utf-8.php 
utf-8.php: PHP script, UTF-8 Unicode text

$ php utf-8.php 
ENCODING: UTF-8
DEBUG1 Le Courrier de Sáint-Hyácinthe
DEBUG2 LE COURRIER DE SÁINT-HYÁCINTHE 
```

我的终端实际上​​需要 UTF-8 文本，所以当我打印出 ISO-8859-1 文本时，它会被破坏。当文件保存为 utf-8 并且终端需要 utf-8 时，一切正常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-24T12:05:04.203

实际上，这里的工作很简单

```
<?php
mb_internal_encoding('UTF-8');

$x='Le Courrier de Sáint-Hyácinthe';
echo mb_strtoupper( $x ) . "\n"; 
```

输出

```
LE COURRIER DE SÁINT-HYÁCINTHE 
```

在这里它直接工作，但也许在你的情况下你必须添加`utf8_encode`：

```
$x = utf8_encode( 'Le Courrier de Sáint-Hyácinthe' ); 
```

--

在没有 MB 的情况下在这里工作的替代方案，

```
<?php
echo strtoupper(str_replace('á', 'Á', 'Le Courrier de Sáint-Hyácinthe')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-21T12:25:39.153

只需使用 [mb_convert_case](https://www.php.net/manual/en/function.mb-convert-case)

```
//$content = 'Le Courrier de Sáint-Hyácinthe';
$content = 'رسومات رغد';
echo mb_convert_case($content, MB_CASE_UPPER, "UTF-8"); 
```

# objective-c - 目标 c 上旧项目的新项目

> ID：15051287
> 
> 赞同：1
> 
> 时间：2013-02-24T11:28:38.567
> 
> 标签：objective-c, xcode4.5, filenames

我有一个旧项目，其中包含大量文件，我想将其用作新项目的基础。

我需要更改工作区、项目路径和一些文件名。

我做了一些，但仍然在旧路径上获取文件，尤其是在目标编译源中。

使用新名称转换为新项目需要执行哪些步骤？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:59:00.910

您可以从现有文件中添加文件。在 Xcode 中，File->Add files to "your project name"...

您选择现有文件，然后选中“将项目复制到目标组的文件夹”。

新文件将在您的新项目中创建。如果要重命名文件，可以在导航区进行更改。

# javascript - 使用 setInterval 循环遍历多维数组以创建动画

> ID：15051288
> 
> 赞同：0
> 
> 时间：2013-02-24T11:28:54.647
> 
> 标签：javascript, animation, canvas, multidimensional-array, setinterval

我在循环遍历多维数组以在画布上制作动画时遇到了相当大的麻烦。

我现在得到的是动画的最终位置而不是整个序列

为什么像这样使用多维数组？这个想法是 PHP 输出一个多维数组，然后我可以循环创建动画。

```
 <script>
           canvas = document.getElementById("myCanvas");
    ctx = canvas.getContext("2d");

    r = new Image()
    r.src = 'redsprites.png';
    image2 = new Image()
    image2.src = 'pitch.png';
    b = new Image()
    b.src = 'bluesprites.png';
    z = new Image()
    z.src = 'ball.png';

var action = [[[z,5,7],[b,9,7],[r,4,4],[b,7,24],[r,5,2],[b,10,100],[r,2,2],[b,45,2],[r,4,4],[b,3,3] ],
 [[z,8,10],[b,12,10],[r,7,7],[b,10,27],[r,8,5],[b,13,103],[r,5,5],[b,48,5],[r,7,7],[b,6,6] ],
  [[z,11,10],[b,12,13],[r,7,10],[b,10,30],[r,8,8],[b,16,103],[r,8,5],[b,51,5],[r,10,7],[b,9,6] ],
  [[z,11,13],[b,15,13],[r,7,13],[b,10,33],[r,8,11],[b,19,103],[r,11,5],[b,51,5],[r,10,10],[b,9,9] ],
 [[z,11,10],[b,12,13],[r,7,10],[b,10,30],[r,8,8],[b,16,103],[r,8,5],[b,51,5],[r,10,7],[b,9,6] ],
  [[z,8,10],[b,12,10],[r,7,7],[b,10,27],[r,8,5],[b,13,103],[r,5,5],[b,48,5],[r,7,7],[b,6,6] ],
  [[z,5,7],[b,9,7],[r,4,4],[b,7,24],[r,5,2],[b,10,100],[r,2,2],[b,45,2],[r,4,4],[b,3,3] ],
 [[z,8,10],[b,12,10],[r,7,7],[b,10,27],[r,8,5],[b,13,103],[r,5,5],[b,48,5],[r,7,7],[b,6,6] ],
  [[z,11,10],[b,12,13],[r,7,10],[b,10,30],[r,8,8],[b,16,103],[r,8,5],[b,51,5],[r,10,7],[b,9,6] ],
  [[z,11,13],[b,15,13],[r,7,13],[b,10,33],[r,8,11],[b,19,103],[r,11,5],[b,51,5],[r,10,10],[b,9,9] ],
  [[z,11,10],[b,12,13],[r,7,10],[b,10,30],[r,8,8],[b,16,103],[r,8,5],[b,51,5],[r,10,7],[b,9,6] ],
  [[z,8,10],[b,12,10],[r,7,7],[b,10,27],[r,8,5],[b,13,103],[r,5,5],[b,48,5],[r,7,7],[b,6,6] ],
  [[z,5,7],[b,9,7],[r,4,4],[b,7,24],[r,5,2],[b,10,100],[r,2,2],[b,45,2],[r,4,4],[b,3,3] ],
  [[z,8,10],[b,12,10],[r,7,7],[b,10,27],[r,8,5],[b,13,103],[r,5,5],[b,48,5],[r,7,7],[b,6,6] ],
  [[z,11,10],[b,12,13],[r,7,10],[b,10,30],[r,8,8],[b,16,103],[r,8,5],[b,51,5],[r,10,7],[b,9,6] ],
  [[z,11,13],[b,15,13],[r,7,13],[b,10,33],[r,8,11],[b,19,103],[r,11,5],[b,51,5],[r,10,10],[b,9,9] ],
  [[z,11,10],[b,12,13],[r,7,10],[b,10,30],[r,8,8],[b,16,103],[r,8,5],[b,51,5],[r,10,7],[b,9,6] ],
  [[z,8,10],[b,12,10],[r,7,7],[b,10,27],[r,8,5],[b,13,103],[r,5,5],[b,48,5],[r,7,7],[b,6,6] ],
  [[z,5,7],[b,9,7],[r,4,4],[b,7,24],[r,5,2],[b,10,100],[r,2,2],[b,45,2],[r,4,4],[b,3,3] ],
  [[z,8,10],[b,12,10],[r,7,7],[b,10,27],[r,8,5],[b,13,103],[r,5,5],[b,48,5],[r,7,7],[b,6,6] ],
  [[z,11,10],[b,12,13],[r,7,10],[b,10,30],[r,8,8],[b,16,103],[r,8,5],[b,51,5],[r,10,7],[b,9,6] ],
  [[z,11,13],[b,15,13],[r,7,13],[b,10,33],[r,8,11],[b,19,103],[r,11,5],[b,51,5],[r,10,10],[b,9,9] ],
  [[z,11,10],[b,12,13],[r,7,10],[b,10,30],[r,8,8],[b,16,103],[r,8,5],[b,51,5],[r,10,7],[b,9,6] ],
  [[z,8,10],[b,12,10],[r,7,7],[b,10,27],[r,8,5],[b,13,103],[r,5,5],[b,48,5],[r,7,7],[b,6,6] ],
  [[z,5,7],[b,9,7],[r,4,4],[b,7,24],[r,5,2],[b,10,100],[r,2,2],[b,45,2],[r,4,4],[b,3,3] ],
  [[z,8,10],[b,12,10],[r,7,7],[b,10,27],[r,8,5],[b,13,103],[r,5,5],[b,48,5],[r,7,7],[b,6,6] ],
  [[z,11,10],[b,12,13],[r,7,10],[b,10,30],[r,8,8],[b,16,103],[r,8,5],[b,51,5],[r,10,7],[b,9,6] ],
 [[z,11,13],[b,15,13],[r,7,13],[b,10,33],[r,8,11],[b,19,103],[r,11,5],[b,51,5],[r,10,10],[b,9,9] ],
  [[z,11,10],[b,12,13],[r,7,10],[b,10,30],[r,8,8],[b,16,103],[r,8,5],[b,51,5],[r,10,7],[b,9,6] ],
  [[z,8,10],[b,12,10],[r,7,7],[b,10,27],[r,8,5],[b,13,103],[r,5,5],[b,48,5],[r,7,7],[b,6,6] ]];

  var draw = function(){
  //ctx.clearRect(0, 0, 500, 700);
  ctx.drawImage(image2, 0, 0, 622, 924, 0, 0, 300, 500);
for(h = 0; h < action.length; h++)

   {

for(m = 0; m < action[h].length; m++)

       {
        ctx.drawImage(action[h][m][0], 0, 0, 100, 100, action[h][m][1], action[h][m][2], 15, 15);
        }
 }
}

setInterval(draw, 100);
 </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:18:38.263

您应该替换`setInterval`为`setTimeout`.
通过使用，您正在创建无限循环，因为您在每个函数调用`setInterval`中以特定间隔调用一个新循环。`draw`

# mootools - 在 Mootools 图像库中为每个打开的图像添加一个链接

> ID：15051289
> 
> 赞同：0
> 
> 时间：2013-02-24T11:28:56.310
> 
> 标签：mootools

我想要做的是在 Mootools 图像库中为每个打开的图像添加不同的链接。
根据下面的代码，当您单击每个小图像或缩略图时，将显示标签中的大尺寸图像。我需要做的是再次为这个打开的大图像添加一个标签。这样当用户点击打开的图像时，他将被引导到一个新页面。

```
 <table>
      <tr>   
        <td>    <a href="img/pic1.png" data-milkbox="milkbox:g1" title="Lorem ipsum...">    <img src="img/pic1a.png" alt="" width="100" height="100" />     </a>    </td>
        <td>    <a href="img/pic1.png" data-milkbox="milkbox:g1" title="Lorem ipsum...">    <img src="img/pic1a.png" alt="" width="100" height="100" />     </a>    </td>
      </tr>
    </table> 
```

演示在这里。[http://reghellin.com/milkbox/#demo](http://reghellin.com/milkbox/#demo)

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T10:15:16.400

MilkBox 脚本将显示大图像，所有 HTML 都由该插件本身控制。因此，如果插件不支持向打开的图像添加辅助链接，您将不得不解决它或修改插件。不推荐使用后者，因为这意味着您无法在不合并更改的情况下更新插件。

我唯一能想到的就是利用MilkBox 提供的事件（例如onFileReady）来挂钩一些自定义代码以围绕大图像包装链接，但这又取决于MilkBox 的工作方式。

另一种选择是寻找一个类似的灯箱插件，它允许链接打开的图像。

# android - 使用 Unity 的手机游戏 - 用于应用内购买的插件

> ID：15051292
> 
> 赞同：7
> 
> 时间：2013-02-24T11:29:23.260
> 
> 标签：android, ios, unity3d, in-app-purchase

我正在使用 Unity 开发一款手机游戏，虽然运行核心游戏循环非常容易，但我在移动设备的接口方面遇到了一些问题，特别是 Apple 和 Google 提供的应用内购买功能。我听说有插件可以帮助解决这个问题。是否有任何地方列出了所有选项并可以让我轻松比较它们？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-24T11:32:45.833

Unity 中的插件很难自行开发。寻找现有的是正确的。以下是当今 Unity 中 IAP 的 4 个主要选项的快速比较。

***Prime 31 - 适用于 iOS 和 Android 的插件***

这个插件已经存在了很长一段时间。[Prime 31](http://prime31.com/plugins)为 Unity 制作了许多插件，其中两个处理应用内购买。其中一个适用于 Android，另一个适用于 iOS。该插件声称可以消除应用内购买的所有痛苦。如果您打算只在游戏中出售一两件东西并仅在一个硬件平台上发布，这将是一个不错的选择。成本 - 70 美元 - 单一操作系统的一次性费用。但是，如果您正在使用用户可以在游戏过程中收集的硬币构建游戏并使用不同类型的商品建立商店，您将不得不努力工作并为不同的 Mobile OS 和 Tapjoy/W3i 购买更多插件。

***SOOMLA - 开源 IAP 项目***

SOOMLA 项目为虚拟商品和应用内购买创建了一个跨平台框架。这是一个社区开发的项目，已经迅速普及，最近增加了对 Unity 的支持。该插件可供下载，同时支持 iOS 和 Android，以及余额管理系统和安全功能，以防止用户入侵升级。该插件完全免费且开放，为您提供了完全的灵活性。

***SOOMLA - 店面插件***

该插件建立在开源[IAP Unity](http://soom.la/iap-unity/)插件之上，但还包括店面组件。对于正在实施在商店中有硬币和多种虚拟商品的游戏的开发人员来说，这是最佳解决方案。该商店支持不同的商品类型，如单次使用、单次购买和 Equipable 商品。它会自动从商店内触发购买请求，而无需开发人员自己实现。有一个免费试用开始，然后如果您想继续对商店进行更多更改，您每月支付 29 美元，或者您可以继续免费使用同一家商店。

***Roar Engine - 作为他们平台的一部分***

这是远程管理游戏各个方面的完整解决方案，其中包括一个应用内购买插件。这可能是过度杀戮，根据活跃用户的数量，成本可能会达到几百美元。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-19T10:12:08.657

Unibill 已在评论中提到，作为其作者，我也想将其作为一个选项提出。

它现在支持 5 种不同的计费平台；iOS、Google Play、亚马逊、Windows Phone 8 和 Mac 应用商店。

If you're targeting multiple platforms (which is presumably why you're using Unity) then Unibill can save you a lot of time. Just check out some of our [Asset store reviews](http://u3d.as/content/outline-games/unibill/45P).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-17T11:36:05.487

After long looking for any usable free solution I just recently stumbled upon [OpenIAB](https://github.com/onepf/OpenIAB/tree/master/unity_plugin) which supports all flavours of **android** stores right now but is soon to release support for **iOS** too!

[OpenIAB on Github](https://github.com/onepf/OpenIAB/tree/master/unity_plugin)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T12:10:34.423

创建自己的插件并不难。在 android 中，您需要了解其`JNI`工作原理。

如果您不想浪费时间编写 IAP 代码，只需获取现有插件之一即可。在我的特殊情况下，我使用了 Prime 31 插件。他们工作得很好。

# c# - PropertyGrid 属性列表

> ID：15051298
> 
> 赞同：19
> 
> 时间：2013-02-24T11:30:13.017
> 
> 标签：c#, propertygrid

我在 C# 中找不到 PropertyGrid 的可用属性列表，你知道在哪里可以找到吗？

谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-24T11:43:41.540

影响 PropertyGrid 的属性是间接的：有趣的代码是提供 PropertyDescriptor 实现的 TypeDescriptor。然而，这辆面包车被 ICustomTypeDescriptor 或 TypeDescriptionProvider 否决了。

但是，如果我们假设默认规则，则发挥作用的关键属性是：

*   `[DisplayName(...)]`
*   `[Description(...)]`
*   `[Category(...)]`
*   `[TypeConverter(...)]`
*   `[ReadOnly(...)]`
*   `[Browsable(...)]`
*   `[DefaultValue(...)]`
*   `[Editor(...)]`

其他一些事情可以通过模式检测到，例如是否存在 ShouldSerialize{name} 或 Reset{name} 方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-11T10:03:27.227

我还要补充

RefreshProperties 属性

NotifyParentPropertyAttribute

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-09-18T22:32:18.847

如果 PropertyGrid 来自 Xceed Extended.Wpf.Toolkit 它也依赖于 System.ComponentModel.DataAnnotations.Display 属性。

```
[Display(Name="", Description="", Order=1)] 
```

有了它，您可以提供：

1.  名称覆盖 [DisplayName(...)]
2.  描述可能覆盖 [Description(...)]
3.  **列表中的订单（唯一的，我不知道其他提供订单的方式）**
4.  还有其他几个（GroupName、Prompt、ShortName、ResourceType、AutoGenerateField、AutoGenerateFilter），但我没有测试它们，可以说它们在属性网格中工作......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-05T12:49:24.883

我还会添加“MergableAttribute”。这对于防止属性网格对标识字段进行分组很有用，因为如果您选择多个对象，您不希望能够使用属性网格修改对象的“名称”属性（例如），因为它必须每个对象保持唯一...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-11T07:28:43.487

我没有看到一个很好的解决方案来订购 WinForms PropertyGrid 的属性，所以这是我使用的解决方案：

```
pgDetails.PropertySortChanged += (s, ea) =>
{
    if (pgDetails.PropertySort == PropertySort.CategorizedAlphabetical)
    {
        pgDetails.PropertySort = PropertySort.Categorized;
    }
};

pgDetails.PropertySort = PropertySort.Categorized; 
```

这样做的方式是网格现在将维护类中属性的声明顺序。

# node.js - Expressjs 正在返回 json 而不是 html

> ID：15051299
> 
> 赞同：0
> 
> 时间：2013-02-24T11:30:22.593
> 
> 标签：node.js, express, template-engine

我正在使用[kiwi](https://github.com/coolony/kiwi)模板引擎和[express](http://expressjs.com)开发一个简单的网络应用程序。当我在浏览器中打开我的应用程序时，会正确生成模板，并且除结果之外的所有内容都是 JSON 编码的。我尝试设置 res.type('html') 但这似乎只会改变应用程序发送的 mime。我还没有使用任何 AJAX 请求。

我有以下代码：

```
"use strict";

var express = require('express');
var path = require('path');
var publicDir = path.join(__dirname, 'public');

var app = express();

app.configure(function(){
    app.set('views', __dirname + '/view');
    app.engine('kiwi', require('kiwi').__express);
    app.set('view engine', 'kiwi');

    app.use(require('less-middleware')({ src: publicDir }));
    app.use(express.favicon());
    app.use(express.static(publicDir));
});
app.configure('development', function(){
    app.use(express.logger());
});

app.get('/', function(req, res){
    res.render('index', {title: 'kiwi'});
});

app.listen(process.env.PORT || 8080); 
```

我使用这样的布局文件（为了便于阅读，删除了大部分布局 html）：

```
<div class="container">
    {{block content}}{{/block}}
</div> 
```

这是 index.kiwi 文件：

```
{{extend 'layout'}}
{{block content}}
<p>Hi ${title}</p>
{{/block}} 
```

这是我在浏览器中看到的（使用 text/json mime 发送）：

```
"<div class=\"container\">\n\t\n<p>Hi kiwi</p>\n\n</div>" 
```

我怎样才能让它发送正常的 HTML？

**更新：**好的，我设法找到[了另一个](https://github.com/mavdi/olivia)类似于我的应用程序（使用 express 和 kiwi），我发现的唯一区别是库版本。所以我下载了 express 3.0.0beta7 并且它正在工作。很奇怪吧？

**UPDATE2：**该错误介于 3.0.0rc4（html 输出）和 3.0.0rc5（json 输出）之间

**UPDATE3：**我相信只有可能相关的更改是提交[40be3ed05d](https://github.com/visionmedia/express/commit/40be3ed05d75e631d175cf63ad28897b4eff141d)和[9eb1da4568](https://github.com/visionmedia/express/commit/9eb1da4568bc5b6811fec5679e61e4a332e9122f)都更改连接版本或可能[8edf358739](https://github.com/visionmedia/express/commit/8edf358739447e259616adc474fc17c3e8e9dcff)

你可以在这里看到回购：[https ://github.com/jtojnar/srs](https://github.com/jtojnar/srs)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T12:12:34.840

FWIW（阅读您的编辑，只是分享；）：我最近检查了 Kiwi 模板并遇到了同样的问题。

我当时的修复是这样的：

```
 this.engine('kiwi', function(filename, options, callback) {
    kiwi.__express(filename, options, function(err, rendered) {
      if (! is_production && err)
        console.error(err);
      callback(err, rendered.toString());
    });
  }); 
```

`rendered`参数不是字符串，而是对象。这使 Express 感到困惑，并使得（或者更确切地说：制造）它返回 JSON。并没有给我对 Kiwi 的信心，最后我选择了[swig](http://paularmstrong.github.com/swig/)。

# c++ - 如何自动定义递增/递减/等运算符？

> ID：15051300
> 
> 赞同：0
> 
> 时间：2013-02-24T11:30:30.190
> 
> 标签：c++, templates, enums, operator-overloading, c++03

我有很多`enum`类型，像这样：

```
enum Color {COLOR_RED = 0, COLOR_GREEN = 1, COLOR_BLUE = 2, COLOR_NUM};
enum Direction {DIRECTION_FORWARD, DIRECTION_BACKWARD, DIRECTION_NUM};
enum Choice {CHOICE_THIS, CHOICE_THAT, CHOICE_NUM}; // i've just made it up 
```

在我的代码中的许多地方，我想对所有可能的值进行循环；我希望它看起来像这样：

```
for (Color c = COLOR_RED; c != COLOR_NUM; ++c)
{
    ...
} 
```

为此，我`operator++`一起定义`Color`：

```
enum Color {COLOR_RED = 0, COLOR_GREEN = 1, COLOR_BLUE = 2, COLOR_NUM};

inline Color& operator++(Color& c)
{
    c = static_cast<Color>(c + 1);
    return c;
} 
```

`operator++`我还为习惯于使用`i++`而不是编码循环的人定义后缀`++i`：

```
inline Color operator++(Color& c, int)
{
    Color r = c;
    c = static_cast<Color>(c + 1);
    return r;
} 
```

我想知道如何使用模板让编译器生成这些运算符，而无需编写太多无聊的代码。我刚刚发现[`boost::unit_steppable`](http://www.boost.org/doc/libs/1_53_0/libs/utility/operators.htm#grpd_oprs)据说`operator++`从前缀一生成后缀，但它只完成了一半的工作：我仍然必须自己提供前缀`operator++`。

以下工作，但在我看来太“强大”：

```
template <class T> T operator++(T x)
{
    return static_cast<T>(x + 1);
} 
```

我希望只为 selected `enum`s 定义运算符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:01:14.813

以下内容应该可以帮助您入门，并根据需要进行扩展：

```
#include <type_traits>

enum Foo { RED, GREEN, BLUE, SIZE };

template< typename T > struct my_enum_is_unit_steppable { enum { value = false }; };

// for each type you want the operator(s) to be enabled, do this:
template<> struct my_enum_is_unit_steppable< Foo > { enum { value = true }; };

// protect the operators with enable_if
template< typename T >
typename std::enable_if< my_enum_is_unit_steppable< T >::value, T >::type
operator++( T value )
{
    return T( value + 1 );
}

int main()
{
    for( Foo foo = RED; foo != SIZE; ++foo ) {}
} 
```

当然，这使用 C++11 `std::enable_if`，但 Boost 有可用的 C++03 版本。

# php - 为 DoctrineModule 的 ObjectRepository 提供自定义选项

> ID：15051302
> 
> 赞同：0
> 
> 时间：2013-02-24T11:30:59.717
> 
> 标签：php, doctrine-orm, zend-framework2

我正在尝试通过[DoctrineModule](https://github.com/doctrine/DoctrineModule) for Zend2 的源代码来工作，因为几乎不存在针对初学者的综合文档。

在那里，我找到了一个自定义身份验证适配器[ObjectRepository](https://github.com/doctrine/DoctrineModule/blob/master/src/DoctrineModule/Authentication/Adapter/ObjectRepository.php)。此类接受[DoctrineModule\Options\Authentication](https://github.com/doctrine/DoctrineModule/blob/master/src/DoctrineModule/Options/Authentication.php)的对象。我只需要将该`credentialCallable`值设置为自定义的、基于[BCrypt](http://framework.zend.com/manual/2.1/en/modules/zend.crypt.password.html#bcrypt)的函数。

我为我的控制器编写了一个类来包装适配器：

```
namespace User\Controller\Plugin;

class UserAuthentication extends AbstractPlugin {
    protected $_authAdapter = null;
    protected $_authService = null;

    public function __construct($authAdapter) {
        $this->setAuthAdapter($authAdapter);
    }
    // More setters/getters
} 
```

现在我需要以某种方式配置模块，以便这里的调用会给我一个有效的实例。

```
$uAuth = $this->getServiceLocator()->get('User\Controller\Plugin\UserAuthentication'); 
```

所以很自然，我将不得不使用模块配置。但是在这里我完全被卡住了，因为我找不到任何关于如何正确创建类实例的提示。到目前为止，这是我想出的：

```
return array(
    'di' => array(
        'instance' => array(
            'User\Event\Authentication' => array(
                'parameters' => array(
                    'userAuthenticationPlugin' => 'User\Controller\Plugin\UserAuthentication',
                ),
            ),
            'User\Controller\Plugin\UserAuthentication' => array(
                'parameters' => array(
                    'authAdapter' => 'DoctrineModule\Authentication\Adapter\ObjectRepository'
                ),
            ),
        ),
    ),
    'service_manager' => array(
        'factories' => array(
            'DoctrineModule\Authentication\Adapter\ObjectRepository' => function ($sm) {
                /// ????
            },
            'DoctrineModule\Options\Authentication' => function($sm) {                
                /// ????
            },
        ),
    ),
); 
```

所以我不知道在那里填写什么，或者这是否是正确的方法。也许我完全走错了路，因为在执行此操作时，我得到：

```
An abstract factory could not create an instance of usercontrollerpluginuserauthentication(alias: User\Controller\Plugin\UserAuthentication). 
```

我感谢任何想法和提示。请不要指导我`ZfcUser`或类似的，我想/需要自己实现这个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T11:46:06.227

我还没有`Di`在 ZF2 中工作过。但这是我`ObjectRepository`在 ZF2 中使用 DoctrineModule 的方式。

在我的`Module.php`我有一个 AuthenticationService 工厂，就像你有一个 AuthenticationService 一样。在工厂中，我创建了一个`ObjectRepository`具有所需所有值的新对象。

```
public function getServiceConfig()
{
    return array(
        'factories' => array(
            'AuthService' => function($services) {
                $entityManager = $services->get('doctrine.entitymanager.orm_default');
                $doctrineAuthAdapter = new ObjectRepository(array(
                    'objectManager' => $entityManager,
                    'identityClass' => 'Auth\Entity\User',
                    'identityProperty' => 'username',
                    'credentialProperty' => 'password',
                    'credentialCallable' => function($identity, $credential) {
                        return md5($identity->salt . $credential);
                    }, // this function makes the password hash salted
                       // you could also just use return md5($credential);
                ));

                // my AuthenticationService uses the entity manager
                // and the ObjectRepository
                $authService = new AuthenticationService();
                $authService->setEntityManager($entityManager);
                $authService->setAdapter($doctrineAuthAdapter);

                return $authService;
            },
        ),
    );
} 
```

这`AuthenticationService`基本上是 Zend 的 AuthenticationService 的扩展，带有一些额外的方法，我发现它很有用（并且`Zfc`使用，因为我从那里偷看）。为简洁起见，我删除了实现，但保留了声明以允许您查看我认为在服务中可能有用的内容。

```
<?php

namespace Auth\Service;

use Application\EntityManagerAwareInterface;
use Zend\Authentication\AuthenticationService as ZendAuthenticationService;

use Auth\Entity\User;

class AuthenticationService extends ZendAuthenticationService implements EntityManagerAwareInterface
{
    /**
     * This method makes sure that we always get a User-object
     * we can call methods on. In case of a non-authorized user
     * we will receive a dummy object without storage or with
     * session storage. So data might be lost!
     */
    public function getIdentity()
    {
        $storage = $this->getStorage();

        if ($storage->isEmpty()) {
            return new \Auth\Entity\User\Dummy();
        }

        $userid = $storage->read();

        $user = $this->getEntityManager()->find('Auth\Entity\User', $userid);

        if ($user == null) {
            return new \Auth\Entity\User\Dummy();
        } else {
            return $user;
        }
    }

    /**
     * Register a new user to the system. The user password will by hashed before
     * it will be saved to the database.
     */
    public function register(User $user)
    {

    }

    /**
     * Reset the users password to a random value and send an e-mail to the
     * user containing the new password.
     */
    public function resetPassword(User $user)
    {

    }

    /**
     * Delete a users account from the database. This does not really delete the
     * user, as there are too many connections to all other tables, but rather
     * deletes all personal information from the user records.
     */
    public function delete(User $user)
    {

    }

    public function setEntityManager(\Doctrine\ORM\EntityManager $entityManager)
    {
        $this->entityManager = $entityManager;
    }

    public function getEntityManager()
    {
        return $this->entityManager;
    }
} 
```

然后在控制器中，我可以使用以下代码来登录用户：

```
// getAuthService() just calls $this->getServiceLocator()->get('AuthService')

$this->getAuthService()->getAdapter()
     ->setIdentityValue($username)
     ->setCredentialValue($password);

$result = $this->getAuthService()->authenticate();

foreach($result->getMessages() as $message) {
    $this->flashmessenger()->addMessage($message);
}

if ($result->isValid()) {
     $this->getAuthService()->getStorage()->write($result->getIdentity()->getId());
     return true;
 } else {
     return false;
 } 
```

# ruby-on-rails-3 - 使用 database.yml 的 Capistrano 部署错误

> ID：15051303
> 
> 赞同：0
> 
> 时间：2013-02-24T11:31:03.860
> 
> 标签：ruby-on-rails-3, deployment, gem, capistrano

我正在尝试使用 capistrano 进行部署，但是我不断收到这个 database.yml not found 错误。我的 database.yml 文件未提交到我的存储库，我尝试设置我的 deploy.rb 文件以动态创建 database.yml，但它似乎没有工作。这是我的 deploy.rb 文件：

```
require "bundler/capistrano"

set :application, "myapp.com"
set :app_name, "myapp"
set :repository,  "git@bitbucket.org:myrepo/fltctr.git"
set :scm, :git

server "100.100.100.100", :web, :app, :db, primary: true

  set :user, "user" # As defined on your server
  set :password, "pwwd"
  set :deploy_to, "/var/www/html/myapp.com" # Directory in which the deployment will take place
  set :mysql_user, 'root_user'
  set :mysql_password, 'root_pwwd'

set :deploy_via, :remote_cache
set :use_sudo, false
ssh_options[:forward_agent] = true

namespace :deploy do
  task :start do ; end
  task :stop do ; end
  task :restart, :roles => :app, :except => { :no_release => true } do
    run "#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}"
  end
end

namespace :deploy do  
  desc "Recreate symlink"
  task :resymlink, :roles => :app do
    run "#{try_sudo} rm -f #{current_path} && ln -s #{release_path} #{current_path}"
  end

end

require 'erb'

before "deploy:setup", :db
after "deploy:update_code", "db:symlink"

namespace :db do
  desc "Create database yaml in shared path"
  task :default do
    db_config = ERB.new <<-EOF
    base: &base
      adapter: mysql
      socket: /var/run/mysqld/mysql.sock
      username: #{mysql_user}
      password: #{mysql_password}

    development:
      database: #{app_name}_dev
      <<: *base

    test:
      database: #{app_name}_test
      <<: *base

    production:
      database: #{app_name}_prod
      <<: *base
    EOF

    run "#{try_sudo} mkdir -p #{shared_path}/config"
    put db_config.result, "#{shared_path}/config/database.yml"
  end

  desc "Make symlink for database yaml"
  task :symlink do
    run "ln -nfs #{shared_path}/config/database.yml #{release_path}/config/database.yml"
  end
end

after "deploy:create_symlink", "deploy:resymlink", "deploy:update_crontab" 
```

每次我运行 cap deploy 我都会收到以下错误，之后部署停止并回滚。

```
*** [err :: ] rake aborted!
*** [err :: ] No such file or directory - /var/www/html/myapp.com/releases/20130224112516/config/database.yml
*** [err :: ] /var/www/html/myapp.com/shared/bundle/ruby/1.9.1/gems/railties-3.2.3/lib/rails/application/configuration.rb:115:in `read' 
```

请帮忙——我真的需要完成这件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T17:40:35.673

您需要写入文件而不仅仅是放入标准输出：

更改此行：

把 db_config.result, "#{shared_pa​​th}/config/database.yml"

至

File.open("#{shared_pa​​th}/config/database.yml", "w") { |f| f.puts db_config.result }

# php - preg_replace() 引号内的引号

> ID：15051315
> 
> 赞同：3
> 
> 时间：2013-02-24T11:33:11.560
> 
> 标签：php, regex, preg-replace

我有一个`serialize()`来自外部来源的 PHP 字符串：

`s:4:"0.00";s:4:"type";s:5:"price";s:3:"$20";s:12:"Foo "Bar" Baz";s:1:"y";`

我需要替换`"Bar"`为`&quot;Bar&quot;`才能成功`unserialize()`。

我该如何使用`preg_replace()`来完成此操作？

我试过`(?<!s:\d{1,4}:)("[0-9a-zA-Z ]+")`了，但 PHP 抛出后视错误：后视*断言在偏移 14 处不是固定长度*

*更新：这是我编的一个虚拟字符串。我错误地计算了字符......可以安全地假设计数是正确的......字符串实际上应该是：*

`s:4:"0.00";s:4:"type";s:5:"price";s:3:"$20";s:13:"Foo "Bar" Baz";s:1:"y";`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T12:15:32.087

如果您的字符串可以反序列化，请这样做，然后用HTML 实体`htmlspecialchars`替换引号（以及`<`和）。`>`如果您只想替换引号，请*使用*`str_replace`.

* * *

您的代码中的问题**不**在于有引号！实际上，转义引号并不能解决您的问题。

让我们看看您拥有的序列化字符串的表示形式：`s:12:"Foo "Bar" Baz";`
这意味着您有一个包含字符**的**`12`字符串 - 引号根本不需要在其中转义。

现在您拥有的序列化数据有什么问题？

```
s:12:"Foo "Bar" Baz";
      1234567890123 
```

As you can see, you have 13 characters while the parser expects only 12 characters. That's the reason why you cannot unserialize it! This however means that you need to change the `12` to `13` to fix it.

What does this actually mean? **It is impossible to fix your data using a regular expression!** What you actually need to do is fix the source which sends you invalid data!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T12:01:11.237

```
$string = preg_replace_callback('/(s:\d+:\")(.*?)(\";)/i', function($matches){
  return $matches[1] . htmlspecialchars($matches[2], ENT_QUOTES) . $matches[3];
}, $string); 
```

（如果字符串中的引号后面有分号，这将失败，例如`Foo "Bar"; Foo`）

* * *

@ThiefMaster 是对的。尝试完全更正字符串：

```
$keys = 0;
$string = preg_replace_callback('/s:(\d+):\"(.*?)\";/i',
  function($matches) use(&$keys){
    return sprintf('i:%d;s:%d:"%s";', ++$keys, strlen($matches[2]), $matches[2]);
  }, $string);

$string = sprintf('a:%d:{%s}', $keys, $string);
$result = unserialize($string); 
```

我把它包装在一个数组中，因为如果你反序列化你在那里的东西，你只会得到第一个元素的值......

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-24T11:48:34.507

```
preg_replace('|( "[0-9A-Z]+" )|ei', " stripslashes(htmlentities('$1')) ", $str) 
```

# c# - 如何在 C# 中创建对象引用？

> ID：15051316
> 
> 赞同：0
> 
> 时间：2013-02-24T11:33:36.207
> 
> 标签：c#, class, object-reference

我最近开始创建自己的课程，并决定创建一个简单的课程，但遇到了 1 个问题。这是发生了什么：

在我的 Form1 中，我有一个

```
SqlCeConnection sqlCEconn = new SqlCeConnection(@"Data Source = C:\Dropbox\Visual\Database test2 -treeview\Database test2 -treeview\Database2.sdf"); 
```

在我的名为 test 的新课程中，我有这个：

```
namespace Database_test2__treeview
{
class test
{
    public string testCHECK()
    {

        SqlCeConnection sqlCEconn = new SqlCeConnection();

        if (sqlCEconn.State == ConnectionState.Open)
        {
            return "Database connection: Open";
        }
        if (sqlCEconn.State == ConnectionState.Closed)
        {
            return "Database connection: Closed";
        }
        else
        {
            return "";
        }
    }
}
} 
```

稍后在 Form1 中，我使用我的新类来检查连接是否打开，方法是：

```
private void Form1_Load(object sender, EventArgs e)
    {
        sqlCEconn.Open();
        test testconnection = new test();

        Toolstrip1.Text = testconnection.testCHECK(); 
```

很明显，返回字符串将是“关闭”，因为我在 test.cs 中的 SqlCeConnection 没有链接到我的 Form1 中的 SqlCeConnection

我该如何以简单的方式做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T11:37:25.383

如果您想要参考，则只需将其作为参数发送：

```
public string testCHECK(SqlCeConnection thisConnection)
{
    if (thisConnection.State == ConnectionState.Open)
    {
        return "Database connection: Open";
    }
    if (thisConnection.State == ConnectionState.Closed)
    {
        return "Database connection: Closed";
    }
    else
    {
        return "";
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:36:50.877

您正在您的类中创建一个*新*的连接对象`test`- 如果您想检查*现有*连接的状态，您应该将其传递给`test`类甚至`testCheck`方法：

```
class test
{
    public string testCHECK(SqlCeConnection sqlCEconn)
    {
        if (sqlCEconn.State == ConnectionState.Open)
        {
            return "Database connection: Open";
        }
        if (sqlCEconn.State == ConnectionState.Closed)
        {
            return "Database connection: Closed";
        }
        else
        {
            return "";
        }
    }
} 
```

并这样称呼它：

```
sqlCEconn.Open();
test testconnection = new test();

Toolstrip1.Text = testconnection.testCHECK(sqlCEconn); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T11:40:39.600

我想你想在测试构造函数上打开你的连接。另一种选择可能是将您在 Form1_Load 上创建的 sqlCEconn 作为参数传递给您的测试对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T11:37:14.477

您应该创建一个名为`SqlManager`or 的类，并从那里管理对数据库的连接和操作。

这将允许多个不相关的类使用完全相同的连接对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-24T11:37:45.500

在您的检查中创建新连接，同时它应该在您的 testCHECK 中作为参数

```
public string testCHECK(SqlCeConnection sqlCEconn) 
```

和你的电话

```
Toolstrip1.Text = testconnection.testCHECK(sqlCEconn) 
```

# css - CSS div 高度基于 Content div 的高度

> ID：15051322
> 
> 赞同：0
> 
> 时间：2013-02-24T11:34:08.440
> 
> 标签：css

如何使这个 jsfiddle 中的绿色和红色 div 随蓝色 div 的内容扩展？

[http://jsfiddle.net/4ZJVh/](http://jsfiddle.net/4ZJVh/)

```
 <html style="height: 100%" >
    <head runat="server">
        <title></title>
        <asp:ContentPlaceHolder id="ContentPlaceHolder" runat="server">

        </asp:ContentPlaceHolder>
    </head>
    <body style="height: 100%; background-color: grey">
        <form id="form1" runat="server">
            <div style="background-color: fuchsia; height: 50px; width: 100%; float: left; "></div>
            <div style="background-color: green; min-height: 100%; width: 20%; float: left; ">oo</div>
            <div style="background-color: blue; float: left; width:60%; height: 100%" >            
             test
            </br> test
            </br> test
            </br> test
            </br> test
            </br> test
            </br> test
            </br> test
            </br> test
            </br> test
            </br> test
            </br> test
            </br> test
            </br>
            </div>
            <div style="background-color: red; float: left; width: 20%; height: 200px;"></div>
        </form>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T11:58:20.640

您遇到的主要问题是您的`form`元素没有`height`设置，因此其他 div 没有高度可以继承。

给你的表格一个固定的`height`或`height:100%;`它应该可以工作。

```
<form id="form1" runat="server" style="height:100%;"> 
```

您还应该考虑将 CSS 和 HTML 分开 - 内联 CSS 很难跟踪，我在 jsfiddle 上为您完成了这项工作 -> [http://jsfiddle.net/4ZJVh/2/](http://jsfiddle.net/4ZJVh/2/)

# r - cr.setup 以 rms 为单位

> ID：15051323
> 
> 赞同：1
> 
> 时间：2013-02-24T11:34:10.173
> 
> 标签：r, modeling

有人可以解释一下包中的`cr.setup`功能是如何`rms`工作的吗？我似乎无法弄清楚它如何重新映射初始数据以及**这种重新映射对延续比率模型有何用处，**并且帮助和示例没有那么有用。网上也找不到其他解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T18:12:18.153

在他的优秀著作“回归建模策略”中，Harrell 在他关于序数逻辑回归的章节末尾有三页专门讨论了延续比率模型。`cr.setup`通过复制某些行并为各种比较创建层标记来支持“欺骗普通逻辑回归”的过程：`Y >= 0; Y>=1, ... Y>=K-1`并创建适当的响应变量来表示特定层的“结果”。看看他的 cr.setup 的第一个例子：

```
y <- c(NA, 10, 21, 32, 32)
> cr.setup(y)
$y
[1] NA  1  0  1  0  0  0  0

$cohort
[1] <NA>  all   all   y>=21 all   y>=21 all   y>=21
Levels: all y>=21

$subs
[1] 1 2 3 3 4 4 5 5

$reps
[1] 1 1 2 2 2 
```

如果有 3 个级别的非 N Y，则只有 2 个级别的新结果。y 向量是新结果。向量元素是原始数据的`subs`索引。`reps`向量告诉软件需要多少次复制。您可以通过以下示例了解如何在实践中使用它：

```
combinations <- expand.grid(cohort=levels(cohort), sex=levels(sex))
combinations 
```

# javascript - 如何在过渡中移动文本标签

> ID：15051329
> 
> 赞同：2
> 
> 时间：2013-02-24T11:35:19.720
> 
> 标签：javascript, d3.js, label, transition, sunburst-diagram

我是 D3 的新手，我正在尝试扩展[http://bl.ocks.org/mbostock/4063423](http://bl.ocks.org/mbostock/4063423)中的 sunburst 示例，只是为每个弧添加文本标签。对于静态图表来说很容易，并且在此代码中标签的位置正确，但是当我添加与调整弧线大小的示例相同的转换时，文本标签不会移动。

```
<script type="text/javascript">

    function onload() {     
        var container = document.querySelector("#graph");
        var width  = $(container).width(),  
            height = 700,
            radius = Math.min(width, height) / 2,
            color  = d3.scale.category20c();

        var svg = d3.select("#graph").append("svg")
            .attr("width", width)
            .attr("height", height)
          .append("g")
            .attr("transform", "translate(" + width / 2 + "," + height * .52 + ")");

        var partition = d3.layout.partition()
            .sort(null)
            //.size([2 * Math.PI, radius * radius])
            .size([2 * Math.PI, 100000])
            // criteri per defecte: Importància
            .value(function(d) { return d.size; });

        var arc = d3.svg.arc()
            .startAngle(function(d) { return d.x; })
            .endAngle(function(d) { return d.x + d.dx; })
            .innerRadius(function(d) { return Math.sqrt(d.y); })
            .outerRadius(function(d) { return Math.sqrt(d.y + d.dy); });

          d3.json("data/CV.json", function(error, root) {
          var arcs = svg.datum(root).selectAll("path")
              .data(partition.nodes)
              .enter().append('svg:g');

          var path = arcs.append("path")
              .attr("display", function(d) { return d.depth ? null : "none"; }) // hide inner ring
              .attr("d", arc)
              .style("stroke", "#fff")
              .style("fill", function(d) { return color((d.children ? d : d.parent).name); })
              .style("fill-rule", "evenodd")
              .each(stash);     

         var label = arcs.append("svg:text")
            .attr("transform", function(d) { return "translate(" + arc.centroid(d) + ")"; })
            .attr("dy", ".35em")
            .attr("text-anchor", "middle")
            .attr("class", "label")
            .attr("style", function(d) { return d.depth ? null : "display: none"; }) // hide inner
            .text(function(d) { return d.name; });

          d3.selectAll("input").on("change", function change() {
            var value = this.value === "count"
                ? function() { return 1; }
                : function(d) { return d.size; };

            path
                .data(partition.value(value).nodes)
              .transition()
                .duration(1500)
                .attrTween("d", arcTween);

          });
        });

        // Stash the old values for transition.
        function stash(d) {
          d.x0 = d.x;
          d.dx0 = d.dx;
        }

        // Interpolate the arcs in data space.
        function arcTween(a) {
          var i = d3.interpolate({x: a.x0, dx: a.dx0}, a);
          return function(t) {
            var b = i(t);
            a.x0 = b.x;
            a.dx0 = b.dx;
            return arc(b);
          };
        }

        d3.select(self.frameElement).style("height", height + "px");
   }

</script> 
```

我怎样才能实现标签移动，只是用相应的弧移动？

问候，琼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-25T07:56:11.613

在尝试了几件事之后，我发现在功能更改中也需要更新标签，只需添加此调用即可解决问题：

```
label
     .data(partition.value(value).nodes)
   .transition()
     .duration(1500)
     .attr("transform", function(d) { return "translate(" + arc.centroid(d) + ")"; })
     }); 
```

现在它起作用了。

# ubuntu - EC2 Ubuntu Capistrano 问题（NoMethodError: undefined method `each' for "publickey":String）

> ID：15051331
> 
> 赞同：0
> 
> 时间：2013-02-24T11:35:34.387
> 
> 标签：ubuntu, ssh, amazon-ec2, jenkins, capistrano

我已经用尽了自己和我的资源，试图重新创造我上周必须奇迹般创造的东西。

我正在使用运行 Ubuntu 12.10 x64 的 EC2 微实例来使用 Jenkins 和 Capistrano 为 CI 创建测试服务器。

我能够“弄清楚”我上周在做什么，并且拥有一台似乎正在工作的服务器，但发现自己无法重新创建连接到我的 EC2 实例以将代码从 github 推送到所述实例。

这是我运行“cap deploy”时得到的结果：

```
jenkins@ip-10-170-102-174:/var/www/config$ cap deploy 
```

* 2013-02-24 11:05:11 执行`deploy' * 2013-02-24 11:05:11 executing`deploy:update' ** 事务：开始 * 2013-02-24 11:05:11`deploy:update_code' executing locally: "git ls-remote git@github.com:example/example.git master" command finished in 1871ms * executing "git clone -q git@github.com:example/example.git /var/www/example/releases/20130224110513 && cd /var/www/example/releases/20130224110513 && git checkout -q -b deploy de26b44bba59e1aa04dc3cf9dbec9dc4d9e4bdf3 && (echo de26b44bba59e1aa04dc3cf9dbec9dc4d9e4bdf3 > /var/www/example/releases/20130224110513/REVISION)" servers: ["example.us-west-1.compute.amazonaws.com"] *** [deploy:update_code] rolling back * executing "rm -rf /var/www/example/releases/20130224110513; true" servers: ["example.us-west-1.compute.amazonaws.com"] ** [deploy:update_code] exception while rolling back: Capistrano::ConnectionError, connection failed for: example.us-west-1.compute.amazonaws.com (NoMethodError: undefined method`为“publickey”执行 each':String) 连接失败：example.us- west-1.compute.amazonaws.com (NoMethodError: undefined method `each' for "publickey":String)

这是我的 deploy.rb 文件：

```
set :app_name, "example"
set :location, "example"
set :application, "example"
set :repository, "git@github.com:example/example.git"
set :user, "jenkins"
set :runner, "jenkins"
set :branch, "master"
set :port, 22
set :deploy_to, "/var/www/#{application}"
set :scm, "git"

ssh_options[:forward_agent] = true
ssh_options[:auth_methods] = "publickey"
ssh_options[:keys] = ["/var/www/jenkins"]
#set :default_stage, "dev"

role :app, "example.us-west-1.compute.amazonaws.com", :primary => true 
```

我需要注意的是，我已经关注了其他几个论坛和指导，我生成的名为“jenkins”的密钥确实允许我连接到服务器，在 /var/lib/jenkins 中工作——这使得这更加令人困惑。

我正在使用用户 Jenkins，因为我可以在我的其他服务器上使用它/它似乎可以让 Jenkins 的使用变得简单。我对此很陌生，并且肯定在努力学习，我已经阅读了几篇文章，观看了几个视频，并且非常沮丧，坦率地说，很累。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T01:20:43.283

我的设置在升级后上周开始表现出相同的行为。（[看起来这件事最近发生在我们几个人身上](https://stackoverflow.com/questions/15363003/amazon-aws-cap-deploycheck-fails/15375167#15375167)。）

该错误似乎表明`[:auth_methods]`未以使其可迭代的方式分配。

尝试改变：

```
ssh_options[:auth_methods] = "publickey"
ssh_options[:keys] = ["/var/www/jenkins"] 
```

对此：

```
set :ssh_options, {:auth_methods => "publickey"}
set :ssh_options, {:keys => ["/var/www/your_actual_key_file.pem"]} 
```

# javascript - 我不明白用于分割多行的模式

> ID：15051332
> 
> 赞同：3
> 
> 时间：2013-02-24T11:35:37.360
> 
> 标签：javascript, regex

在下面的代码片段中，谁能解释一下是如何`reg`定义的？

```
str = "This is the first line.\n" + 
      "This is the second line.\n" + 
      "This the third line.\n";
reg = /^.*$/gm;

var mtch = str.match(reg); 
```

需要拆分位于单独一行的三个句子，但我不明白定义拆分它的模式。

它说（我猜是这样！）字符串应该以开头并且`.`可以`.`出现多次。`*`当我们实际放置时需要放置`global flag`什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T11:42:20.123

“m”标志告诉 javascript 在换行符的开头和结尾处匹配 ^ 和 $ 锚点。因此，此正则表达式匹配包含在一行中的任何字符 0 次或更多次的所有情况（“g”标志）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-24T11:53:42.273

## 全局、多行匹配

g 修饰符只是意味着返回所有匹配的字符串

m 修饰符最好由[文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp)解释：

> 将开始和结束字符（^ 和 $）视为处理多行（即，匹配每行的开始或结束（由 \n 或 \r 分隔），而不仅仅是整个输入字符串的开始或结束）

因此，问题中的正则表达式匹配换行符之间的所有字符串。

```
str = "This is the first line.\n" + 
  "This is the second line.\n" + 
  "This the third line.\n";

str.match(/^.*$/gm)
//["This is the first line.", "This is the second line.", "This the third line.", ""] 
```

## 不需要 m 修饰符

开始和结束锚点实际上不是必需的。因此，一个更简单、几乎等效的正则表达式将是：

```
str.match(/.+/g)
//["This is the first line.", "This is the second line.", "This the third line."] 
```

在这种情况下，`.+`将匹配一个或多个字符的任何字符串，*不包括*换行符。默认情况下，正则表达式中的匹配是贪婪的，并且会扩展以匹配最可能的匹配，因此它将字符串拆分为行。请注意，响应中没有空字符串。

## 这不需要正则表达式

为了这个正则表达式看起来在做什么，最好不要使用正则表达式：

```
str.split("\n");
//["This is the first line.", "This is the second line.", "This the third line.", ""] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T12:12:35.600

> What is the need to put * when we are actually putting the global flag ?

The `*` is part of the pattern (used for the match), the `g` is a modifier which means "all the result, not only the first one".

`/^.$/m;` would return a line with only one character (the first one found)

`/^.*$/m;` would return a line (the first one found)

`/^.$/gm;` would return every line with only one character

`/^.*$/gm;` returns every line

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T11:37:10.030

dot(.) 表示任何字符。* 表示 0 或更多。'm' 修饰符是多行的。

# assembly - 位操作 avr 程序集

> ID：15051334
> 
> 赞同：0
> 
> 时间：2013-02-24T11:35:45.813
> 
> 标签：assembly, avr

我目前正在阅读有关 avr 汇编程序编程的教程。有说：

> 位操作 cbr 和 sbr 清除或设置寄存器中的多个位。这些指令仅适用于寄存器 r16 到 r31。它们不使用单个位作为参数，而是使用可以包含多个位的掩码：

```
sbr r16, (1<<5)+(1<<3) ;set bits 5 and 3 in register 16 
cbr r16,0x03    ;clear bits 1 and 0 in register 16 
```

谁能解释一下这两条指令的参数？为什么我必须写 (1<<5)+(1<<3) 才能设置第 5 位和第 3 位？我猜 << 有点像移位操作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-24T11:38:10.750

是的， << 是位移。你正在做的是构建一个位掩码，`00101000`它将设置位 3 和 5，零索引。在您的`cbr`指令中，您传递了掩码 0x03，即`00000011`，它将清除位 0 和 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-11T18:30:19.873

是不是更容易写

```
ldi r16, 0x28 
```

# oracle - java.lang.ClassNotFoundException：oracle.jdbc.oracore.OracleTypeCOLLECTION

> ID：15051342
> 
> 赞同：0
> 
> 时间：2013-02-24T11:36:57.373
> 
> 标签：oracle, jakarta-ee, glassfish, oracle10g, glassfish-3

我正在尝试在以下环境中运行企业应用程序（包含 EJB 和 WAR 模块）。

*   GlassFish 服务器 3.1.2
*   EJB 3.0
*   JPA 2.0
*   甲骨文 10g

~~连接池建立成功。~~

我还尝试通过向两个模块添加库来使用以下 Oracle 驱动程序。

*   10.2.0.5.0（包含在 ojdbc14.jar 中）
*   11.2.0.3.0（包含在 ojdbc6.jar 中）

尽管两个 jar 文件都包含 class `oracle.jdbc.oracore.OracleTypeCOLLECTION`，但我得到了以下异常。

> java.lang.ClassNotFoundException：oracle.jdbc.oracore.OracleTypeCOLLECTION

完整的堆栈跟踪。

```
javax.ejb.EJBException
    at com.sun.ejb.containers.BaseContainer.processSystemException(BaseContainer.java:5215)
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5113)
    at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4901)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2045)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1994)
    at com.sun.ejb.containers.EJBObjectInvocationHandler.invoke(EJBObjectInvocationHandler.java:213)
    at com.sun.ejb.containers.EJBObjectInvocationHandlerDelegate.invoke(EJBObjectInvocationHandlerDelegate.java:79)
    at $Proxy210.getAllTransporters(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.corba.ee.impl.presentation.rmi.StubInvocationHandlerImpl.privateInvoke(StubInvocationHandlerImpl.java:241)
    at com.sun.corba.ee.impl.presentation.rmi.StubInvocationHandlerImpl.invoke(StubInvocationHandlerImpl.java:152)
    at com.sun.corba.ee.impl.presentation.rmi.codegen.CodegenStubBase.invoke(CodegenStubBase.java:227)
    at admin.sessionbeans.__AdminSessionBeanRemote_Remote_DynamicStub.getAllTransporters(admin/sessionbeans/__AdminSessionBeanRemote_Remote_DynamicStub.java)
    at admin.sessionbeans._AdminSessionBeanRemote_Wrapper.getAllTransporters(admin/sessionbeans/_AdminSessionBeanRemote_Wrapper.java)
    at managedbeans.TransporterBean.getTransporters(TransporterBean.java:25)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at javax.el.BeanELResolver.getValue(BeanELResolver.java:363)
    at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176)
    at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203)
    at com.sun.el.parser.AstValue.getValue(AstValue.java:138)
    at com.sun.el.parser.AstValue.getValue(AstValue.java:183)
    at com.sun.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:224)
    at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:109)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:194)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:182)
    at javax.faces.component.UIData.getValue(UIData.java:731)
    at javax.faces.component.UIData.getDataModel(UIData.java:1798)
    at javax.faces.component.UIData.setRowIndexWithoutRowStatePreserved(UIData.java:484)
    at javax.faces.component.UIData.setRowIndex(UIData.java:473)
    at com.sun.faces.renderkit.html_basic.TableRenderer.encodeBegin(TableRenderer.java:81)
    at javax.faces.component.UIComponentBase.encodeBegin(UIComponentBase.java:820)
    at javax.faces.component.UIData.encodeBegin(UIData.java:1118)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1755)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:402)
    at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:131)
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.NoClassDefFoundError: oracle/jdbc/oracore/OracleTypeCOLLECTION
    at oracle.jdbc.driver.T4CDriverExtension.allocatePreparedStatement(T4CDriverExtension.java:67)
    at oracle.jdbc.driver.PhysicalConnection.prepareStatement(PhysicalConnection.java:3575)
    at oracle.jdbc.driver.PhysicalConnection.prepareStatement(PhysicalConnection.java:3461)
    at com.sun.gjc.spi.base.ConnectionHolder.prepareStatement(ConnectionHolder.java:502)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.prepareStatement(DatabaseAccessor.java:1474)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.prepareStatement(DatabaseAccessor.java:1423)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseCall.prepareStatement(DatabaseCall.java:697)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:585)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeCall(DatabaseAccessor.java:535)
    at org.eclipse.persistence.internal.sessions.AbstractSession.basicExecuteCall(AbstractSession.java:1717)
    at org.eclipse.persistence.sessions.server.ServerSession.executeCall(ServerSession.java:566)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:207)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:193)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeSelectCall(DatasourceCallQueryMechanism.java:264)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.selectAllRows(DatasourceCallQueryMechanism.java:646)
    at org.eclipse.persistence.internal.queries.ExpressionQueryMechanism.selectAllRowsFromTable(ExpressionQueryMechanism.java:2611)
    at org.eclipse.persistence.internal.queries.ExpressionQueryMechanism.selectAllRows(ExpressionQueryMechanism.java:2570)
    at org.eclipse.persistence.queries.ReadAllQuery.executeObjectLevelReadQuery(ReadAllQuery.java:420)
    at org.eclipse.persistence.queries.ObjectLevelReadQuery.executeDatabaseQuery(ObjectLevelReadQuery.java:1081)
    at org.eclipse.persistence.queries.DatabaseQuery.execute(DatabaseQuery.java:844)
    at org.eclipse.persistence.queries.ObjectLevelReadQuery.execute(ObjectLevelReadQuery.java:1040)
    at org.eclipse.persistence.queries.ReadAllQuery.execute(ReadAllQuery.java:392)
    at org.eclipse.persistence.queries.ObjectLevelReadQuery.executeInUnitOfWork(ObjectLevelReadQuery.java:1128)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.internalExecuteQuery(UnitOfWorkImpl.java:2871)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1516)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1498)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1463)
    at org.eclipse.persistence.internal.jpa.EJBQueryImpl.executeReadQuery(EJBQueryImpl.java:485)
    at org.eclipse.persistence.internal.jpa.EJBQueryImpl.getResultList(EJBQueryImpl.java:742)
    at admin.sessionbeans.AdminSessionBean.getAllTransporters(AdminSessionBean.java:18)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.glassfish.ejb.security.application.EJBSecurityManager.runMethod(EJBSecurityManager.java:1052)
    at org.glassfish.ejb.security.application.EJBSecurityManager.invoke(EJBSecurityManager.java:1124)
    at com.sun.ejb.containers.BaseContainer.invokeBeanMethod(BaseContainer.java:5388)
    at com.sun.ejb.EjbInvocation.invokeBeanMethod(EjbInvocation.java:619)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.doAround(SystemInterceptorProxy.java:162)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.aroundInvoke(SystemInterceptorProxy.java:144)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:370)
    at com.sun.ejb.containers.BaseContainer.__intercept(BaseContainer.java:5360)
    at com.sun.ejb.containers.BaseContainer.intercept(BaseContainer.java:5348)
    at com.sun.ejb.containers.EJBObjectInvocationHandler.invoke(EJBObjectInvocationHandler.java:206)
    ... 65 more
Caused by: java.lang.ClassNotFoundException: oracle.jdbc.oracore.OracleTypeCOLLECTION
    at com.sun.enterprise.loader.ASURLClassLoader.findClassData(ASURLClassLoader.java:782)
    at com.sun.enterprise.loader.ASURLClassLoader.findClass(ASURLClassLoader.java:696)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    ... 117 more 
```

可能是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-12T19:59:10.973

I resolved this exact error by changing the driver class in the JNDI config from `oracle.jdbc.driver.OracleDriver` to `oracle.jdbc.OracleDriver`

As noted in this [answer](https://stackoverflow.com/questions/6202653/difference-between-oracle-jdbc-driver-classes) the former class is deprecated and should not be used.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-09T18:41:31.237

异常是因为我将 Oracle 驱动程序添加为类库而不是将其放置在服务器目录中。

解决方案是将驱动程序 jar 放在`${GlassFishHome}\domains\domain1\lib\ext`.

# javascript - 在 jQuery 中获取像我这样的所有元素？

> ID：15051343
> 
> 赞同：4
> 
> 时间：2013-02-24T11:37:03.213
> 
> 标签：javascript, jquery, jquery-plugins, jquery-selectors

假设我有这个结构（没有类，没有 ID）： - 这是一个定位问题

*d[0,1,2] 是 pure `divs`。没有班级没有身份证。*

div( `d0`) 包装了一个重复的结构，如：

![在此处输入图像描述](../Images/ba3b02dbab4032b15b674c0e87c3dd9d.png)

假设我`$(this)`是第**一个** `d1`

是否有任何遍历函数，方法，解决方案可以获得其他2 `d1`？（或全部`d1's`。没关系..）

我会用文字来赞美它：

> 我是`$(this)=d1`。我有一个父级（即`d2`，可以更多......这仅适用于我的示例），它有一个父级（`d3`），因此，我有 2 个更精确的元素，例如我。

我怎样才能得到它们？[**JSBIN**](http://jsbin.com/egewok/1/edit)

# 编辑

也许我不清楚，但我不必知道结构。我只是有`$(this)`，它应该自己找到其他相对于`d0`（与其位置相同）的双胞胎

所以它应该是这样的：

```
function getLikeMyself(objWhichIsThis , contextDivElement)
{
}

execute : getLikeMyself(theDivWhishIsThis, divElemtnWhichIs_d0) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T11:49:00.197

这是我的新尝试，该`.me()`方法将返回当前元素的选择器，直到`body`.

```
$.fn.me = function(){
  return this.first().parentsUntil("body").andSelf().map(function(){
    return this.tagName;
  }).get().join(">");
}; 
```

用法：

```
var selector = $(this).me();
var $twins = $(selector); 
```

[看这里。](http://jsbin.com/egewok/19/edit)

* * *

接受根元素作为参数的替代版本：

```
$.fn.me = function(root){
  return this.first().parentsUntil(root).andSelf().map(function(){
    return this.tagName;
  }).get().join(">");
}; 
```

用法：

```
var selector = $(this).me("#root");
var $twins = $(selector, "#root"); 
```

[看这里。](http://jsbin.com/egewok/25/edit)

* * *

第三个版本保持根元素下最顶层元素的后代的相对位置。例如，它将返回`DIV>DIV:nth-child(1)>SPAN:nth-child(2)`而不是通用`DIV>DIV>SPAN`选择器。

```
$.fn.me = function(root){
  return this.first().parentsUntil(root).andSelf().map(function(){
    var eq = i ? ":nth-child(" + ($(this).index() + 1) + ")" : "";
    return this.tagName + eq;
  }).get().join(">");
}; 
```

用法：

```
var selector = $(this).me("#root");
var $twins = $(selector, "#root"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:48:44.667

您可以使用在下行过程中建立的路径遍历每个父节点并下降到它们相应的兄弟节点：

```
var chain = [$('#imthis').prop('nodeName')];

$('#imthis')
  .parentsUntil('body')
  .each(function() {
    // i'm a parent
    $(this).siblings()
      .find(chain.join('>'))
    .each(function() {
      alert(this.textContent);
    });
    chain.unshift(this.nodeName);
  }); 
```

[**演示**](http://jsbin.com/egewok/34/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T11:57:34.620

您可以使用递归函数来“冒泡”DOM，直到到达 body 元素，然后反转该树并将其用作选择器。有点像：

```
function getChain(el){

    var parents = arguments[1] || [el.nodeName.toLowerCase()];

    if (el.parentNode.nodeName != 'BODY'){

        parents.push(el.parentNode.nodeName.toLowerCase());
        el = el.parentNode;

        return getChain(el, parents);

    } else {

        return parents.reverse().join('>');

    }

} 
```

看**[一个演示小提琴](http://jsfiddle.net/rpSRp/2/)**

# android - 布局：在java类中显示字符串

> ID：15051344
> 
> 赞同：0
> 
> 时间：2013-02-24T11:37:04.403
> 
> 标签：android, eclipse, string, class, layout

如何在布局活动中显示在 java 类中创建的字符串？使用“@string/stringexample”时，它会给出字符串不存在的错误。

您能否也请提供在 java 类中制作的代码，因为我认为我制作的代码不起作用（我已经删除了它）

此外，按下按钮时，整个事情不会开始新的布局。

你能帮帮我吗？谢谢

**主类代码（不制作字符串）：**

```
 package com.barth.appie;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends Activity {

Button button1;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

}

public void addListenerOnButton() {

    button1 = (Button) findViewById(R.id.buttoncalculate);
    button1.setOnClickListener(new View.OnClickListener() {

    public void onClick(View view) {

             Intent myIntent = new Intent(view.getContext(), Calculated.class);
             startActivityForResult(myIntent, 0);

        }
    });
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public void onCreate1(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    addListenerOnButton();

}

} 
```

**第二类的代码，显示一个新的活动：**

```
package com.barth.appie;
import android.os.Bundle;

public class Calculated extends MainActivity {

 public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.calculated);

 }
} 
```

编辑：我希望按钮启动新类，它启动新布局，我想在其中显示一个字符串，由于某种原因，新布局在按下按钮时没有启动，我没有设法制作一个字符串在 java 类中并在布局活动中输出它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:42:23.543

删除这个

```
public void onCreate1(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);

    addListenerOnButton();

} 
```

加入`addListenerOnButton()`_`onCreate()`

```
@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);

       addListenerOnButton();

} 
```

你应该扩展`Activity`而不是`MainActivity`

```
public class Calculated extends Activity {

   public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.calculated);
  }
} 
```

# java - Java [android] Activity，外部类

> ID：15051345
> 
> 赞同：-2
> 
> 时间：2013-02-24T11:37:07.610
> 
> 标签：java, android

Java 新手来了。

```
AlertDialog.Builder builder = new AlertDialog.Builder(this);
AlertDialog dlg = builder.setMessage(messageText).create();
dlg.setOwnerActivity(this);
dlg.show(); 
```

^ 这段代码在主类中运行良好，但是当我尝试制作这样的外部代码时：

```
Messages myMessages = new Messages();
myMessages.SendAlert("Oh shi--!"); 
```

+

```
public class Messages extends Activity {
    public void SendAlert(String messageText) {
        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        AlertDialog dlg = builder.setMessage(messageText).create();
        dlg.setOwnerActivity(this);
        dlg.show();
    }
} 
```

^ 它根本不工作。

我能用它做什么？:-\

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T11:42:25.253

因为你不能像那样创建新的活动。将创建者活动传递给消息的构造函数，而不是扩展活动。

```
public class Messages {
private Activity activity;
public Message(Activity activity){
    this.activity = activity;
}

public void SendAlert(String messageText) {
    AlertDialog.Builder builder = new AlertDialog.Builder(activity);
    AlertDialog dlg = builder.setMessage(messageText).create();
    dlg.setOwnerActivity(activity);
    dlg.show();
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:54:05.933

我想你正在寻找一个帮助类。`Context`主要思想是拥有静态方法并为每个调用传递。

例如：

```
public class AlertHelper {

  private AlertHelper() {
  }

  public static void sendAlert(Context ctx, String messageText) {
    AlertDialog.Builder builder = new AlertDialog.Builder(ctx);
    AlertDialog dlg = builder.setMessage(messageText).create();
    dlg.show();
  }
} 
```

# c++ - 如何正确设置 CMakeLists.txt 文件？

> ID：15051347
> 
> 赞同：2
> 
> 时间：2013-02-24T11:37:13.230
> 
> 标签：c++, windows, gcc, cmake

我有一个简单的 C++ 测试项目，并将我的 CMakeLists.txt 文件编写如下；

```
 cmake_minimum_required(VERSION 2.8)

 set(CMAKE_C_COMPILER "C:/MinGW/bin/gcc")
 set(CMAKE_CXX_COMPILER "C:/MinGW/bin/g++")

 project(simpleTest)
 add_executable(main main.cpp) 
```

当我尝试运行 CMake GUI 到 MinGW 的集合生成器时，我收到以下错误消息：

```
The C compiler identification is GNU 4.6.1
The CXX compiler identification is GNU 4.6.1
Check for working C compiler: C:/MinGW/bin/gcc
CMake Error: your C compiler: "C:/MinGW/bin/gcc" was not found.   Please set CMAKE_C_COMPILER to a valid compiler path or name.
CMake Error: Internal CMake error, TryCompile configure of cmake failed
Check for working C compiler: C:/MinGW/bin/gcc -- broken
CMake Error at C:/Program Files (x86)/CMake 2.8/share/cmake-2.8/Modules/CMakeTestCCompiler.cmake:61 (message):
  The C compiler "C:/MinGW/bin/gcc" is not able to compile a simple test
  program.

  It fails with the following output:

  CMake will not be able to correctly generate this project.
Call Stack (most recent call first):
  CMakeLists.txt:7 (project)

CMake Error: your C compiler: "C:/MinGW/bin/gcc" was not found.   Please set CMAKE_C_COMPILER to a valid compiler path or name.
CMake Error: your CXX compiler: "C:/MinGW/bin/g++" was not found.   Please set CMAKE_CXX_COMPILER to a valid compiler path or name.
Configuring incomplete, errors occurred! 
```

我在 Windows 7 64 位上，我在 cmd 上确认了这一点；G++ --version 提供 G++ (GCC) 4.6.1。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T15:50:17.193

抱歉，这看起来编译器未安装在您指定的位置。另请参阅[此处](https://stackoverflow.com/questions/13054451/cmake-problems-specifying-the-compiler-2/13089688#13089688)为什么应避免在 CMakeLists.txt 中设置编译器

所以我会删除这些，清除 cmake 缓存，在调用 CMake 之前设置环境变量 CC 和 CXX，然后重试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T12:16:49.640

我认为您的问题在于路径字符串。尝试这个：

```
set(CMAKE_C_COMPILER "C:\\MinGW\\bin\\gcc")
set(CMAKE_CXX_COMPILER "C:\\MinGW\\bin\\g++") 
```

或者，您也可以在 CMake GUI 中设置编译器。单击生成后，选择“指定本机编译器”选项并设置或浏览到正确的位置。

# php - 获取用户本地时间/时区的自定义方式是什么？（或者：谷歌/Facebook 会怎么做？）

> ID：15051349
> 
> 赞同：1
> 
> 时间：2013-02-24T11:37:21.637
> 
> 标签：php, javascript, timezone

*我知道这已经在这里被问过好几次了，但是我仍然不清楚“按书本”的自定义方式。*

我正在设计一个需要知道确切用户本地时间的应用程序。在研究这个时我真的很困惑：

大多数有经验的 SO 用户建议[只询问用户她的时区](https://stackoverflow.com/a/797/806061)。其他人推荐[Javascript 时区偏移方法](https://stackoverflow.com/a/1809974/806061)。另一种方法是使用[地理定位](https://stackoverflow.com/a/15051136/806061)。

例如，Facebook 帖子和 Gmail 邮件会显示确切的当地时间，包括 DST 和所有内容。这些应用程序从未向我询问我的时区。他们可能使用哪种方法？

或者，**在上述和其他方法中，哪种方法是自定义的“按书”方式能够使用和存储用户的本地时间？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T11:47:14.890

在我看来，最好的方法是让用户选择他们自己的时区。

我总是使用地理位置来获取起点，然后要求用户确认他们需要哪个。

这允许用户选择一个快速的“点击确认”选项，但如果它不正确，仍然允许用户更改它。这非常适合允许用户可能从不是他们自己的时区的位置注册/登录，但他们希望设置时间/日期，就好像他们在他们的时区中一样。

这可能不是“按书本”的方式，但我觉得它提供了最好的用户体验，归根结底，这应该始终是首要任务！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:46:07.950

我已经明确告诉谷歌我的时区是什么，因为我和我的电脑经常四处走动，而且我实际上想要*两个*时区，而不仅仅是一个（用于谷歌日历）。所以我喜欢这个选项。我认为尝试使用地理位置或类似方法默认一些合理的猜测可能比总是假设美国东部标准时间或其他更好，但是一旦你完成它，考虑存储结果以供将来使用，直到用户明确更改它。如果它仅仅因为用户插入一个地理位置不好的网络（这些确实存在）而改变，它可能会让人迷失方向。

# windows - 未设置环境变量

> ID：15051353
> 
> 赞同：-1
> 
> 时间：2013-02-24T11:38:02.400
> 
> 标签：windows, environment-variables

我在 Windows 上有以下环境变量：

```
VISUAL_STUDIO_HOME = C:\Program Files\Microsoft Visual Studio 9.0 
WINDOWS_SDK_HOME = C:\Program Files\Microsoft SDKs\Windows\v6.0A 
```

现在我想要一个环境变量`VISUAL_STUDIO_INCLUDES`，它应该包含上述两个路径。在下面做，它不起作用。

```
VISUAL_STUDIO_INCLUDES = VISUAL_STUDIO_HOME;WINDOWS_SDK_HOME 
```

我该如何申报？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T11:45:21.053

[technet](http://technet.microsoft.com/en-us/library/cc772691%28v=ws.10%29.aspx)上的文档

环境变量需要用 % 字符括起来。请注意，变量名和 = 号之间的空格很重要，换句话说，在这种情况下，空格将成为变量名的一部分。

```
set VISUAL_STUDIO_INCLUDES=%VISUAL_STUDIO_HOME%;%WINDOWS_SDK_HOME% 
```

# css - CSS - 左侧和顶部不需要的填充

> ID：15051354
> 
> 赞同：0
> 
> 时间：2013-02-24T11:38:07.453
> 
> 标签：css

我在[theuselessweb.com](http://theuselessweb.com)网站的脉络中制作了一个愚蠢的网站。（警告：此后每个链接的页面上都有奇怪的音频。）但是，我遇到了一个问题：我在作为背景的网站上有一个晕影效果，在[这个 jsFiddle](http://tinyurl.com/ao7j42p)中，我做了所有的工作，它看起来完美的。但是，当我[将它上传到我的网络服务器](http://www.suchipi.com/oniichan.html)进行真实测试时，它在 Chrome 或 Firefox 中都不起作用：在背景颜色和页面顶部和左侧的晕影效果之间有一个不需要的空间。这是什么原因造成的？我怎样才能摆脱它？

编辑：自从我收到答案后，这已经解决了。因此，上面我的网络服务器的链接不再有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:51:35.620

默认情况下，每个浏览器都会为元素定义一些不同的边距或填充。在您的情况下，body-element 有一个边距。

在你的css中改变它，你很好。

```
body {
width: 100%;
height: 100%;
background: #666666;
margin:0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:43:12.163

尝试检查你的 css 是否有这样的东西：

```
*{
 margin:0px;
 padding:0px;
} 
```

如果问题仍然存在，可能是因为您在 CSS 中的一些低级类覆盖了样式

# git - 无法通过 capistrano 在服务器上部署 bitbucket 存储库

> ID：15051360
> 
> 赞同：1
> 
> 时间：2013-02-24T11:38:31.593
> 
> 标签：git, zend-framework, capistrano, bitbucket

我正在尝试在我的生产服务器上部署我的 bitbucket 存储库，但无法。当我从我的 Git bash 执行 push pull 时，一切正常，但 capistrano 未能达到同样的效果。

```
 set :application, "my_app"
  set :user, "username"
  set :repository,  "ssh://git@bitbucket.org/accountname/repository.git"
  role :web, "www.domain.com"
  set :deploy_to,   "/home/domaincom/domain.com"
  set :use_sudo, false
  set :scm,        :git
  set :branch,     'master'
  set :deploy_via, :copy
  set :copy_cache, true
  set :copy_exclude, %w(.git)

  task :create_symlinks, :roles => :web do
  run "rm #{current_release}/public/.htaccess"
  run "ln -s #{current_release}/shared/.htaccess #{current_release}/public/.htaccess"
  run "ln -s /home/domaincom/libraries/Zend #{current_release}/library/Zend"
  end

  after "deploy:finalize_update", :create_symlinks 
```

我得到的错误是在部署时

```
 :No such file or directory  -git  ls-remote            ssh://git@bitbucket.org/accountname/repository.git master (Error::ENOENT) 
```

请帮助我，我在过去的 4 天里一直坚持这一点。也尝试添加部署密钥。但没有任何效果

编辑：另外请不要在我的生产服务器上安装 Git 和 Capistrano。我在 Windows 机器上使用 capistrano

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T11:18:02.697

您需要`git`在服务器上安装。

使用 capistrano，您只需告诉您的服务器要执行哪些命令，然后工作就发生在服务器本身上。服务器被命令做的一件事是用来`git`克隆/拉取你的仓库。为了实现这一点，他们显然需要安装 git ......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T13:42:45.773

你不需要生产服务器上的 git 吗？

至少错误消息看起来像这就是问题所在。

# c++ - 如何在 Eigen 中近似比较向量？

> ID：15051367
> 
> 赞同：16
> 
> 时间：2013-02-24T11:39:23.430
> 
> 标签：c++, linear-algebra, eigen

Eigen 中是否有一个函数可以使用相对容差和绝对容差（又名[numpy.allclose](http://docs.scipy.org/doc/numpy/reference/generated/numpy.allclose.html) ）来比较向量（矩阵） ？如果向量之一非常接近零，则标准[isApprox失败。](http://eigen.tuxfamily.org/dox/classEigen_1_1DenseBase.html#a710e3763df8518854578a160c1a8902d)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-24T13:20:27.900

没有实现 numpy.allclose 的内置函数，但如果这确实是您需要的，您可以轻松地自己编写一个。但是，我宁愿建议使用具有参考值的[isMuchSmallerThan ：](http://eigen.tuxfamily.org/dox-devel/classEigen_1_1DenseBase.html#a40b9e8df68a52b2d46cf70c9babf2a16)

```
(a-b).isMuchSmallerThan(ref) 
```

其中 ref 是您的问题的代表非零。

编辑：这里供参考是allclose的可能实现：

```
template<typename DerivedA, typename DerivedB>
bool allclose(const Eigen::DenseBase<DerivedA>& a,
              const Eigen::DenseBase<DerivedB>& b,
              const typename DerivedA::RealScalar& rtol
                  = Eigen::NumTraits<typename DerivedA::RealScalar>::dummy_precision(),
              const typename DerivedA::RealScalar& atol
                  = Eigen::NumTraits<typename DerivedA::RealScalar>::epsilon())
{
  return ((a.derived() - b.derived()).array().abs()
          <= (atol + rtol * b.derived().array().abs())).all();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-09-01T21:22:35.667

还有一个 isApprox 函数对我不起作用。我只是在使用 (expect - res).norm() < 一些小数字。

# jquery - gmaps4rails 按 id 选择标记

> ID：15051368
> 
> 赞同：2
> 
> 时间：2013-02-24T11:40:12.717
> 
> 标签：jquery, ruby-on-rails-3, google-maps, google-maps-api-3, gmaps4rails

当用户将鼠标悬停在给定链接上时，我想打开一个信息窗口。

我已经给了所有标记 ID，并且链接具有相同的 ID。我可以让悬停打开一个信息窗口，我只是不知道如何让它根据链接的 id 和正确的标记打开它。

Js：它在地图上弹出一个信息框，只是不确定如何在地图上指定正确的id。

```
 <script type="text/javascript">
    $(document).ready(function() {
      Gmaps.map.callback = function() {
        $(".items li a").on("mouseover", function() {
          //alert(this.id);
          var marker = Gmaps.map.markers[0]; //this.id
          var map         = Gmaps.map.serviceObject
          marker.infowindow.open(map, marker.serviceObject);
        });
      }
    });
  </script> 
```

标记：

```
@json = @events.to_gmaps4rails do |event, marker|
  marker.infowindow render_to_string(:partial => "/events/hover", :locals => { :event => event })
  marker.title   "#{event.place.name}"
  marker.json({ :id => event.id })
end 
```

链接：

```
<%= link_to event.place.name, pub_path(event.place), id: event.id %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T17:13:09.427

你很亲密。您必须遍历所有标记才能找到正确的标记。使用[underscore.js](http://underscorejs.org/)您可以执行以下操作：

```
Gmaps.map.callback = function() {
  $(".items li a").on("mouseover", function() {

    //id of selected marker
    i = $(this).attr("id");
    marker = _.find(Gmaps.map.markers, function(obj) { return obj.id == i })
    var map         = Gmaps.map.serviceObject          
    marker.infowindow.open(map, marker.serviceObject);
  });
} 
```

# haskell - 是否可以使用 Visual Studio 2010 构建 qtHaskell 1.1.4？

> ID：15051369
> 
> 赞同：0
> 
> 时间：2013-02-24T11:40:18.113
> 
> 标签：haskell

我用 C++/Qt 编写了一个在 Windows 上运行的应用程序，我想使用 qtHaskell 将它移植到 Haskell/Qt。我可以使用 Visual C++ 构建 qtHaskell 还是必须安装 MinGW/Qt？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T15:00:15.280

据我所知，您不能混合和匹配 c++ 编译器，因为它们会做出不同的 ABI 选择。所以你应该按照文档所说的去做并使用 MinGW/Qt。

# entity-framework - EF6 alpha 异步等待实体存储过程/函数导入？

> ID：15051375
> 
> 赞同：5
> 
> 时间：2013-02-24T11:41:25.787
> 
> 标签：entity-framework, async-await, c#-5.0, entity-framework-6

我想将新的异步等待功能应用于在我的实体模型中导入的存储过程/函数导入，但目前还无法使用 EF6 alpha。

是否有可能在 EF6 alpha2（或 20211 年的夜间构建）中调用返回复杂类型集合的实体函数导入（调用 SQL 存储过程）上的任何新异步方法？例如

```
private async Task<IList<Company>> getInfo (string id)
{
    using (CustomEntity context = new CustomEntity())
    {
        var query = await context.customStoredProcedure(id).ToListAsync();
        // ".ToListAsync()" method not available on above line

        // OR ALTERNATIVELY
        var query = await (from c in context.customStoredProcedure(id)
                           select new Company
                           {
                              Ident = c.id,
                              Name = c.name,
                              Country = c.country,
                              Sector = c.sector, 
                              etc. etc....
                           }).ToListAsync();
        // ".ToListAsync()" method or any "...Async" methods also not available this way

        return query;
    }
} 
```

“ToListAsync”，或任何新的异步修改方法似乎不适用于上述实体存储过程/函数导入；只有标准的“ToList”或“AsNumerable”等方法可用。

我按照这个（[http://entityframework.codeplex.com/wikipage?title=Updating%20Applications%20to%20use%20EF6](http://entityframework.codeplex.com/wikipage?title=Updating%20Applications%20to%20use%20EF6)）确保代码引用新的 EF6 dll 而不是 EF5，并更新了各种使用陈述。除了上面，一切都正确构建。（.NET 框架 4.5）

我唯一能看到异步方法的情况是，我不仅从数据库中导入存储过程，还导入了一个表——然后当通过上面的实体上下文 (context.SomeTable) 引用该表时，一些异步方法出现在智能感知中。

在以 JSON 格式返回数据之前，我真的很想在多个存储过程上开始使用新的异步等待功能，但到目前为止还不能让它工作。

难道我做错了什么？实体存储过程/函数导入是否无法实现异步功能？谢谢你的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-17T04:25:31.867

现在这绝不是最好的解决方案。我添加了一个扩展方法，以便我可以在我的存储过程上调用 await。在 EF6.1+ 的较新版本中，我们应该会看到这一点已正式实施。在此之前，一个虚拟扩展方法可以完成这项工作。

```
static async Task<List<T>> ToListAsync<T>(this ObjectResult<T> source)
{
    var list = new List<T>();
    await Task.Run(() => list.AddRange(source.ToList()));
    return list;
} 
```

如果您反映 EF 的第 6 版，您将看到它`ObjectResult<T>`实际上实现了`IDbAsyncEnumerable<T>, IDbAsyncEnumerable`. 并且 for 的方法`ToListAsync<T>(this IDbAsyncEnumerable<T> source)`应该能够像 LINQ 查询一样将其连接起来。

**编辑** 当 ObjectResult 为空时，返回 null。`if (source == null) return new List<T>();`如果要返回空列表而不是 null，可以添加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-05T21:02:03.153

这是一个旧线程，但我觉得我应该分享。您应该使用 APM，然后将同步调用包装在一个任务中。

例子：

```
//declare the delegate
private delegate MyResult MySPDelegate();

// declare the synchronous method
private MyResult MySP()
{
    // do work...
} 
```

然后将同步方法包装在一个任务中：

```
// wraps the method in a task and returns the task.
public Task<MyResult> MySPAsync()
{
    MySPDelegate caller = new MySPDelegate(MySP);
    return Task.Factory.FromAsync(caller.BeginInvoke, caller.EndInvoke, null);
} 
```

要执行时调用 async 方法：

```
var MyResult = await MySPAsync(); 
```

您最多可以在方法中使用三 (3) 个参数。最佳做法是使用三个以上的参数；你应该通过一堂课。

# apache - 如何从路径 mod_rewrite 到查询？

> ID：15051376
> 
> 赞同：0
> 
> 时间：2013-02-24T11:41:41.277
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting, rewrite

我有这样的网址：

`http://olddomain.com/demo?abc=ced&ghi=jkl`

我想将其重写为单独的域作为查询：

`http://newdomain.com/legacy?url=http%3A%2F%2Folddomain.com%2Fdemo%3Fabc%3Ddef%26ghi%3Djkl`

现在我有这样的事情：

`RewriteRule (.*) http://newdomain.com/legacy?url=%{HTTP_HOST}%{REQUEST_URI}?%{QUERY_STRING}`

问题是输出是：

`http://newdomain.com/?url=olddomain.com/demo?abc=def&ghi=jkl`

所以 no`http://`和字符 /、?、= 和 & 不会被转义。除此之外，如果原始请求中没有查询，则会有尾随？，但这可能不是大问题。

# javascript - 在 img 点击时更改选择框选择

> ID：15051377
> 
> 赞同：0
> 
> 时间：2013-02-24T11:41:52.523
> 
> 标签：javascript, select

当有人单击我网站上的特定链接时，我希望选择框选项通过其设置的值更改为某个选项的选项。

我想我会通过添加某种指向每个选择的值的 onClick 来做到这一点......但无法弄清楚要使用的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T11:46:11.187

在常规 JavaScript 中，您可以执行以下操作：

```
var selectBox = document.getElementById('selectBox');
var image = document.getElementbyId('someImage');

image.addEventListener('click', function() {
  selectBox.selectedIndex = 1; // specify the selected index here.
}); 
```

您可以在其中获得对选择框和图像的引用，并向图像添加事件处理程序以设置选择框的选定索引。

如果你有可用的 jQuery，你可以做类似的事情：

```
$('img').click(function() {
  $('select').val('new value'); // specify the new value
}); 
```

# java - 使用 JPA 时如何消除“未经检查”的警告

> ID：15051381
> 
> 赞同：5
> 
> 时间：2013-02-24T11:42:24.283
> 
> 标签：java, jpa, persistence

我用 javax.persistence 做了很多查询。Java 迫使我要么遭受警告，要么受到@Suppress 警告，这两种感觉都不对。

```
@SuppressWarnings("unchecked")
@Override
public List<Area> getArea(Province province) {
    Query qry = em.createQuery("Select c from Area c where c.province = ?1");
    qry.setParameter(1, province);
    return qry.getResultList();
} 
```

如何消除上述代码中的警告？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-24T11:50:27.337

如果您使用 JPA 注释，请使用[`TypedQuery`](http://docs.oracle.com/javaee/6/api/javax/persistence/TypedQuery.html)代替`Query`：

```
TypedQuery<Area> qry = em.createQuery(
    "Select c from Area c where c.province = ?1", Area.class); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:45:49.847

您可以使用 Criteria API 来避免这种情况。查看[此问题](https://stackoverflow.com/q/3997070/49489)以获取有关如何使用它的信息。

# java - Struts2 标签在 Velocity 模板中不起作用

> ID：15051384
> 
> 赞同：2
> 
> 时间：2013-02-24T11:42:46.927
> 
> 标签：java, struts2, velocity, tiles2

我在我的 web 应用程序中使用带有 Apache Tiles2 和 Velocity 模板的 struts2。我遇到的问题是，仅当我将速度与瓷砖一起使用时，struts2 标签才在速度模板中进行评估。

但是当我只对 struts2 使用速度时，它会处理 struts2 标签。

任何人都可以帮忙吗？

**详细信息：** 我使用这篇[文章](http://tiles.apache.org/framework/tutorial/integration/velocity.html)将瓷砖与速度相结合。然后，我想将 struts2 与瓦片一起使用，因此我按照以下方式配置了 struts[瓦片](http://struts.apache.org/release/2.2.x/docs/tiles-plugin.html)

**结果：** 经过上述集成后，我已成功在浏览器上运行我的应用程序。瓷砖、速度和 struts2 瓷砖插件工作正常。

**问题：** Struts2 标签，如#stext("My Text")) 等，没有评估/工作在速度。Velocity 将它们显示为像“#stext("My Text"))”这样的文本。上面的表达式应该计算并显示 My Text 而不是 #stext("My Text"))。

**注意**：速度特定的标签在上述情况下工作得很好。

# javascript - 如何在 PDF 文件上打印打印机型号

> ID：15051394
> 
> 赞同：0
> 
> 时间：2013-02-24T11:44:23.473
> 
> 标签：javascript, pdf

打印文件时如何在 PDF 文件上打印打印机型号？

任何人都知道获得此结果的正确 Javascript 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T13:46:53.213

我不认为你能做到这一点。一旦用户在您的站点上打开了 PDF，它就有点失控了：他们有 PDF，当他们去打印它时，选择打印机的对话框由系统提供，而不是由您的站点提供，甚至可能不是浏览器，真的。我看不出您如何在用户选择打印它的时间和它实际提交到纸张的时间之间影响即将打印的 PDF 的内容。

# wordpress - Wordpress - 如何使用 PHP header() 函数

> ID：15051398
> 
> 赞同：1
> 
> 时间：2013-02-24T11:44:53.763
> 
> 标签：wordpress

我需要使用我的 wordpress 插件之类`header( 'Location: http://location.com' );`或`header("Content-disposition: attachment; filename=$fileName");`来自我的 wordpress 插件的 PHP 标头，但它似乎不会。我知道在调用页眉之前需要使用它们，所以我尝试使用 init 钩子：

```
add_action('init', 'test');

function test() {
    header( 'Location: http://location.com' ) ;
} 
```

但它没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:07:31.983

如果你想重定向任何页面然后使用 wp_redirect() 方法..或者如果你想设置特定的标题以使内容可下载..使用下面的示例..代码...

假设你的网址是这样的.. [http://example.com/download/data.csv](http://example.com/download/data.csv)

```
add_action('template_redirect','yoursite_template_redirect');
function yoursite_template_redirect() {
    if ($_SERVER['REQUEST_URI']=='/downloads/data.csv') {
        header("Content-type: application/x-msdownload",true,200);
        header("Content-Disposition: attachment; filename=data.csv");
        header("Pragma: no-cache");
        header("Expires: 0");
        echo 'data';
        exit();
    }
} 
```

# xml - 使用 XSLT 将 XML 结构转换为 TABLE TR TD

> ID：15051399
> 
> 赞同：0
> 
> 时间：2013-02-24T11:44:55.733
> 
> 标签：xml, xslt, xml-parsing, xsd, xslt-1.0

我在转换 XML 结构时遇到问题：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<?xml-stylesheet type="text/xsl" href="ceva.xsl"?>
<!-- Edited by XMLSpy® -->
<reports>
    <report_head>
        <value>product_id</value>
        <value>product_name</value>
    </report_head>
    <report_data>
        <value>1</value>
        <value>PRODUCT NAME NO 43</value>
    </report_data>
    <report_data>
        <value>2</value>
        <value>PRODUCT NAME NO 56</value>
    </report_data>
    <report_data>
        <value>3</value>
        <value>PRODUCT NAME NO 65</value>
    </report_data>
</reports> 
```

像一张桌子

```
<table>
    <tr>
        <td>product_id</td>
        <td>product_name</td>
    </tr>
    <tr>
        <td>1</td>
        <td>PRODUCT NAME NO 43</td>
    </tr>
    <tr>
        <td>2</td>
        <td>PRODUCT NAME NO 56</td>
    </tr>
    <tr>
        <td>3</td>
        <td>PRODUCT NAME NO 65</td>
    </tr>
</table> 
```

这是我正在使用的 XSL：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/">
        <html>
        <body>
        <h2>Transform a table</h2>

        <!--
        <table border="1">
            <tr>
                <xsl:for-each select="reports/report_head/value">
                    <td><xsl:value-of select="."/></td>
                </xsl:for-each>
            </tr>

            <xsl:for-each select="reports/report_data/value">
            <tr>
                <td><xsl:value-of select="."/></td>
            </tr>
            </xsl:for-each>
        </table>
        -->

        <table border="1">
            <tr>
            <xsl:apply-templates/>
            </tr>
        </table>

        </body>
        </html>
    </xsl:template>

    <!--

    <xsl:template match="value">

        <tr>
            <td><xsl:value-of select="."/></td>
        </tr>

    </xsl:template>
    </table>
    -->

    <xsl:template match="value">
        <td>
        <xsl:value-of select="."/>
        </td>
    </xsl:template>
</xsl:stylesheet> 
```

但是等等，还有更多，我不知道有多少列。一个典型的报告可能有 10 列，但它可能有 20、30+，因此 xslt 必须动态执行此操作。

我试过`for-each`了，有人建议使用 a `template`，但我没有得到任何结果。我现在该怎么办？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T11:52:20.530

这似乎对我有用：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/">
        <html>
        <body>
        <h2>Transform a table</h2>

        <table border="1">
            <xsl:apply-templates/>
        </table>

        </body>
        </html>
    </xsl:template>

    <xsl:template match="report_data | report_head">
        <tr>
          <xsl:apply-templates/>
        </tr>
    </xsl:template>

    <xsl:template match="value">
        <td>
        <xsl:value-of select="."/>
        </td>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T12:05:51.950

我使用这个（[http://www.w3schools.com/xsl/tryxslt.asp?xmlfile=cdcatalog&xsltfile=cdcatalog](http://www.w3schools.com/xsl/tryxslt.asp?xmlfile=cdcatalog&xsltfile=cdcatalog)）小工具进行快速原型制作（有关更多信息，请参见[http://www.w3schools.com/xsl/default.asp](http://www.w3schools.com/xsl/default.asp)）。如果我理解正确的话，认为这可以完成工作：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
<html>
  <body>
    <h2>Transform a table</h2>

    <table border="1">
      <tr>
        <xsl:for-each select="reports/report_head/value">
          <td><xsl:value-of select="."/></td>
        </xsl:for-each>
      </tr>
      <xsl:for-each select="reports/report_data">
      <tr> 
        <xsl:for-each select="./value">
          <td><xsl:value-of select="."/></td>
        </xsl:for-each>
      </tr>
      </xsl:for-each>
    </table>

  </body>
</html>
</xsl:template>
</xsl:stylesheet> 
```

编辑＃1：修复错位`</tr>`

它产生这张桌子......

```
product_id  product_name 
1           PRODUCT NAME NO 43 
2           PRODUCT NAME NO 56 
3           PRODUCT NAME NO 65 
```

... and worked with more columns too.

Hope that helps! Cheers

# typo3 - 排版菜单跳转到子页面

> ID：15051407
> 
> 赞同：0
> 
> 时间：2013-02-24T11:46:02.797
> 
> 标签：typo3, typoscript

我想创建一个带有子菜单的菜单，通过打字稿直接安静。挑战在于，如果包含页面的内容为空，我希望父级别直接链接到第一个子页面。

我知道你可以通过后端的快捷链接来实现，但如果可能的话，我想通过打字稿来实现。

有任何想法吗？我附上了我目前使用的打字稿菜单代码。

```
lib.mainMenu = COA
lib.mainMenu{
10 = HMENU
10{
        # Level 1, further levels are generic
        1 = TMENU
        1.noBlur = 1
        1.expAll = 0
        1.wrap = <ul data-role="listview" data-inset="true">|</ul>
        1.NO = 1
        1.NO.ATagBeforeWrap = 1
        1.NO.insertData = 1
        1.NO.wrapItemAndSub.insertData = 1
        1.NO.wrapItemAndSub = <li id="menu_{field:uid}">|</li>
        1.NO.ATagTitle.field = subtitle // title

        1.ACT = 1
        1.ACT.ATagBeforeWrap = 1
        1.ACT.wrapItemAndSub.insertData = 1
        1.ACT.wrapItemAndSub = <li id="menu_{field:uid}" class="active">|</li>
        1.ACT.ATagTitle.field = subtitle // title

        1.CUR = 1
        1.CUR.ATagBeforeWrap = 1
        1.CUR.wrapItemAndSub.insertData = 1
        1.CUR.wrapItemAndSub = <li id="menu_{field:uid}" class="active">|</li> 
        1.CUR.ATagTitle.field = subtitle // title

}
20 < .10
20.entryLevel = 1
20.1.wrap = <ul data-role="listview" data-inset="true">|</ul>
30 < .20
30.entryLevel = 2
40 < .20
40.entryLevel = 3
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T14:11:14.463

也许您可以根据此处的提示构建您的解决方案：http: [//typo3-blog.net/tutorials/news/if-funktionen-in-typo3.html](http://typo3-blog.net/tutorials/news/if-funktionen-in-typo3.html)

在上面链接的示例中，它不是菜单，但表上有一个子查询（在您的情况下为 tt_content），然后将用于定义是否有输出：

```
temp.main = COA
temp.main.20 = COA
temp.main.20 {
  [...]
  wrap=&lt;div class="meine-adressen"&gt;|&lt;/div&gt;
  stdWrap.if.isTrue.cObject = CONTENT
  stdWrap.if.isTrue.cObject{
    table = tt_address
    select {
      [...]
    }
  renderObj = TEXT
  renderObj.value = 1
  }
}

temp.main.21 = TEXT
temp.main.21 {
  wrap=&lt;div class="keine-adressen"&gt;|&lt;/div&gt;
  value = Keine Adressen gefunden
  stdWrap.if.isFalse.cObject < temp.main.20.stdWrap.if.isTrue.cObject
} 
```

但我不确定这是否不会让您在 HMENU 中感到头疼

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T05:17:55.660

我认为使用打字稿是可能的，但我不知道该怎么做。以下排版可能对您有所帮助：

用于查找页面中内容元素数量的打字稿：

```
lib.emptypage = CONTENT
lib.emptypage{
    table = tt_content
    select{
      selectFields = count(uid) AS count
      pid = id
    }
    renderObj = COA
    renderObj {
      10 = TEXT
      10 {
        value = {field:count}
        insertData = 1
      }
    }
    wrap = |
} 
```

如果 count 等于 0，则页面为空。

获取第一个子页面的打字稿：

```
lib.firstsubpage= HMENU
lib.firstsubpage {
    maxItems = 1
    1 = TMENU
    1 {
        NO = 1
    }
} 
```

请在实施后分享您的排版解决方案。

# jquery - .NET 日期/Javascript/jQuery 日期转换器

> ID：15051416
> 
> 赞同：0
> 
> 时间：2013-02-24T11:46:45.867
> 
> 标签：jquery, .net, datetime, datepicker, date-format

我正在编写一个应用程序，它需要将 .NET 日期格式字符串（例如`dd/MM/yyyy`）转换为等效的 javascript/jQuery 日期格式，以提供 jQuery UI 日期选择器插件（例如`dd/mm/yy`）。

插件格式的详细信息可以在这里找到[http://jqueryui.com/datepicker/#date-formats](http://jqueryui.com/datepicker/#date-formats)

我的问题是，是否有任何人知道的插件/库/方法已经这样做了？

否则，我将按照以下方式编写自己的服务器端方法：

```
public static string GetJavascriptDateFormat(string dotNetFormatString) {
    var resultString = dotNetFormatString;
    resultString =  resultString.Replace("yyyy","yy");
    //etc
    return resultString;
}

public static string GetDotNetDateFormat(string javascriptDateFormatString) {

} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-24T11:52:18.733

我通常避免使用 JSON 编码的日期。

JSON 日期编码和解码非常糟糕且难以调试。最好的是将传递日期作为 .Net 和 javascript 之间的字符串。换句话说，让您的 C# 代码为您格式化日期，并将格式化的日期作为 JSON 中的字符串发送。

# c++ - UI Widget按顺序绘制

> ID：15051420
> 
> 赞同：1
> 
> 时间：2013-02-24T11:47:26.450
> 
> 标签：c++

我有一个为我正在开发的游戏创建的自定义 UI 小部件库。我需要考虑绘图顺序并将其重新安装到我目前拥有的东西中，并且不确定最好的方法。我有一个从 xml 文件加载小部件的 UI 类。它将所有小部件存储在地图中，其中键是小部件的字符串名称。

Widget 可以在父子关系中保存其他 Widget（因此 Widget 类有一个 Widget 的映射，其中名称再次成为键）。当我绘制时，我循环遍历 UI 小部件映射，并且只调用没有父级（最顶层）的小部件的 Draw() 函数。在每个 Widget 的 Draw() 中，它循环遍历它的子组件并调用它们的 Draw() 函数。

问题是什么是让每个小部件的排序顺序变量在保持地图的同时按排序顺序变量的顺序绘制的好方法，因为我喜欢通过字符串键名轻松查找小部件？

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:11:23.603

当您需要多种方式来订购同一组商品时，您有两种选择：

*   存储两个订单，或
*   存储一份订单，并即时计算出另一份订单

存储第二组排序是一种用内存支付以节省 CPU 周期的方法。

在您的情况下，您有两种顺序：一种由名称到小部件映射实现，另一种用于绘图顺序。您有三种实现选择：

*   **将小部件存储在地图中（即按名称排序），并在每次需要确定绘制顺序时运行拓扑排序**- 我在这里假设绘制顺序的原因是确保在子级之前绘制父级，这意味着拓扑排序。
*   **按绘制顺序将小部件存储在列表中，并运行线性查找以按名称获取小部件**- 当您绘制大量小部件但很少按名称查找时，这可能是一个不错的选择。
*   **将小部件存储在地图中（即按名称排序），并制作一个单独的小部件或小部件名称列表，根据绘图顺序排列**- 这种双重核算会花费内存来回购您原本会浪费的 CPU 周期-按图纸顺序排序。

# templates - 变色龙中的 Mako 过滤器？

> ID：15051421
> 
> 赞同：1
> 
> 时间：2013-02-24T11:47:41.617
> 
> 标签：templates, pyramid, pylons, mako, chameleon

是否有可能像我在 Mako 中使用的那样在 Chameleon 中使用模板过滤器？在 Mako 中，可以做类似的事情

```
${s | filter} 
```

where`filter`是将字符串映射到字符串的函数，并将 Mako 应用于`filter`并`s`输出它（在转义 HTML 实体之后）。所以一个人可以很容易地做一些事情，比如

```
${s | nl2br} 
```

我知道 Chameleon 的做法是[Line Breaking in Chameleon](https://stackoverflow.com/questions/15044331/line-breaking-in-chameleon#15045703)。但是我有更多用于此过滤器的应用程序，所以我想知道 Chameleon 是否支持类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:49:29.613

不，没有。而是在您的视图中进行处理，或者在您的 TALES 表达式中使用 python 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T12:10:58.530

在 Chameleon 中，管道运算符 (" | ") 运算符表示 try-except，而不是“应用过滤器”。

但是由于表达式语言只是 Python，因此不需要使用这种语法糖。

此外，Chameleon 有一个`import:`表达式类型可以帮助您导入辅助函数：

```
<div tal:define="h import: helpers">
  ...
  ${structure: h.nl2br(s)} 
```

请注意，如果`nl2br`返回一个实现`__html__()`方法的对象，Chameleon 将调用此方法来生成输出，您无需`structure:`避免 HTML 转义。

也就是说，确实 Mako 的过滤器操作符有时会使模板代码更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T15:44:08.640

变色龙的方式是

```
${nl2br(s)} 
```

我正在这样做

*视图.py*

```
form helpers import nl2br
def my_view(request):
    return {
        'nl2br':nl2br,
    } 
```

*模板.pt*

```
${structure: nl2br(s)} 
```

# ajax - 如何使用ajax和zend上传图片？

> ID：15051426
> 
> 赞同：1
> 
> 时间：2013-02-24T11:48:33.610
> 
> 标签：ajax, zend-framework

感谢您的考虑，我很抱歉我的非信息性问题。

实际上我正在使用 ajax 和 zend 来上传文件。

我的 ajax 代码如下所示：

```
$.ajax({
       type: "POST",
       url: "/business_general/imagesave",
       enctype: 'multipart/form-data',
       data: {'file': files.getAsBinary(), 'fname' : file.fileName},
       success: function(arrReturn){
          alert( "Data Uploaded: ");
       }
}); 
```

在这里，我调用了一个控制器操作（imagesave）来将我的图像保存在数据库中

我的控制器文件操作如下所示：

```
 $config = Zend_Registry::get('config');
    $vehiclelogo = $config->paths->vehiclelogo;
    $file = $objRequest->getParam('file');
    $ret = $objRequest->getParam('fname');
    $path_parts = pathinfo($ret);

    echo $path_parts['extension'], "\n";
    echo $path_parts['filename'], "\n";

    $targetPath = mktime(date("H"), date("i"), date("s"), date("m"), date("d"), date("Y"));

    try {
        echo "POSTED FILE NAME"." ". $ret;
        echo "TYPE OF FILE UPLOADED"." "."-". gettype($ret);
        $strFilePath = $vehiclelogo.'/'.$targetPath.'.'.$path_parts['extension'];
        $OPfile = fopen($strFilePath,"w"); 
        fwrite($OPfile,$file);
        fclose($OPfile);
        echo "completed";
    }
    catch (Exception $e) {
        echo "error";
    } 
```

在这里，我将所选图像上传到一个文件夹中。实际上，我可以上传文本文件。但是如果我上传 png/jpeg 文件，它会被上传到文件夹中，但事实是它无法打开。

我应该能够上传每种类型的文件。

如何在 zend-php 和 ajax 中执行这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T11:00:03.850

抱歉。我认为现代浏览器不支持 getAsBinary()。您可以使用不可见的画布使用 ajax 上传文件。

例子

```
 var canvas = document.getElementById("canvas")
        canvas.width = img.width;
        canvas.height = img.height;
        var ctx = canvas.getContext("2d");
        ctx.drawImage(img,0,0);
      var strdata = canvas.toDataURL("image/png");
      document.getElementById("company_logo").src=strdata;
        $.ajax({
   type: "POST",                                                  
     url: "/business_vehicle/vehiclegeneralsave",                     
    data: "&data="+strdata,
    success: function(arrResult) { 
```

//做点什么

```
 }
}); 
```

在控制器端，您可以接收图像` public function vehiclegeneralsaveAction() {

```
 $file    =  $arrVehicleDetails = trim($objRequest->getParam('data'));

      $strEncodedData = str_replace(' ', '+', $file);
    $strFilteredData = explode(',', $strEncodedData);
    $strUnencoded = base64_decode($strFilteredData[1]);

    file_put_contents('../public/image/image.png', $strUnencoded);
   }` 
```

# google-maps - 如何在地图上的 cakePHP 中添加许多 GoogleMaps-Marker

> ID：15051431
> 
> 赞同：0
> 
> 时间：2013-02-24T11:48:49.010
> 
> 标签：google-maps, cakephp, view, helper, cakephp-2.3

我有一个带有大约 100 个地址的小地址数据库。[所以现在我从https://github.com/marcferna/CakePHP-GoogleMapHelper](https://github.com/marcferna/CakePHP-GoogleMapHelper)添加了 Helpper 。

我知道如何将地址添加到视图中。但是如何将所有地址添加到一张地图中？

每个人都可以帮助我吗？

提前谢谢了

马库斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:26:51.560

为什么要加逗号？

```
<?php $this->GoogleMap->addMarker("map_canvas",1, $atla['Atla']['street'].' '.$atla['Atla']['number'].', '.$atla['Atla']['zipcode'].' '.$atla['Atla']['city'],$atla['Atla']['name'])?> <?php endforeach; ?> 
```

应该是

```
<?php $this->GoogleMap->addMarker("map_canvas",1, $atla['Atla']['street'].' '.$atla['Atla']['number'].', '.$atla['Atla']['zipcode'].' '.$atla['Atla']['city'].','.$atla['Atla']['name'])?> <?php endforeach; ?> 
```

但是：[http://www.dereuromark.de/2010/12/21/googlemapsv3-cakephp-helper/](http://www.dereuromark.de/2010/12/21/googlemapsv3-cakephp-helper/)怎么样？这可能是一个更完整的选择。

如文件所述，您可以使用

```
$this->GoogleMapV3->addMarker($options); 
```

任意多次。我尝试了 500 并且 - 尽管此时您可能想要切换到集群 - 它仍然有效。

# ios - 在不增加 tmp 文件夹大小的情况下使用 NSTemporaryDirectory

> ID：15051441
> 
> 赞同：1
> 
> 时间：2013-02-24T11:49:47.367
> 
> 标签：ios, xcode

在我的应用中，用户可以上传和下载 700*700mb 的图片。这些图像被下载并显示在几个 UIImageViews 中。我的应用程序本身很小，但 Documents & Data 文件夹很大，例如 17gb，而且它一直呈指数增长。我的应用程序可以在 ipad 和 iPhone 上运行。我的 ipad 中的 docs & data 文件夹是 6mb，在我的 ipod 上是 17gb。我下载了app包，发现tmp文件夹很大。有一些堆栈日志文件 1gb 大。我发现问题与 NSTemporary 目录有关。

我以这种方式保存图像：

```
NSString *title = [[NSUserDefaults standardUserDefaults]objectForKey:@"Folder3"];
PhotoiPhoneViewController* sharedSingleton = [PhotoiPhoneViewController sharedManager];

NSString *destDir = [[NSUserDefaults standardUserDefaults]objectForKey:@"Folder2"];
NSString *filename3 = [NSString stringWithFormat:@"%@%@sizefile.pages.%@", destDir, title, sharedSingleton.tagString];

NSString *SizePath = [NSTemporaryDirectory() stringByAppendingPathComponent:[NSString stringWithFormat:@"%@sizefile.pages.%@", title, sharedSingleton.tagString]];

[self.restClient loadFile:filename3 intoPath:SizePath]; 
```

这是正确的方法吗，还是我应该使用：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
 NSString *documentsDirectory = [paths objectAtIndex:0];
 NSString *CommentPath = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"%@commentfile.txt.%ld", title, (long)sharedSingleton.tagNumber]] 
```

由于我希望文件在使用后被删除，我认为 NStemporaryDirectory 会在文件被使用后立即被删除。我该怎么办？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:57:56.923

您可以考虑使用[NSURLCache](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLCache_Class/Reference/Reference.html "NSURLCache")来管理清除。另见[NSHipster/NSURLCache](http://nshipster.com/nsurlcache/)

或者你可以使用像[SDWebImage](https://github.com/rs/SDWebImage "SDWebImage")这样的库来处理缓存大小

编辑：回答您的问题
操作系统过去常常将文件留在临时目录中，但是，从 iOS 5.0 开始，如果需要，它将从该目录中清除文件。有关更多信息，请参阅[此链接](http://www.marco.org/2011/10/13/ios5-caches-cleaning)

# image - 使用matlab查找图像中每个像素的出现次数

> ID：15051446
> 
> 赞同：0
> 
> 时间：2013-02-24T11:50:31.037
> 
> 标签：image, matlab, colors, pixel, rgb

如何找到号码。RGB 图像中每个像素的出现次数（即每种颜色）？？
我需要存储的图像的每个像素对应于它们的坐标的出现次数......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T17:00:20.123

尝试：

```
maxNoOfColors=1024;
[x,map]=rgb2ind(image,maxNoOfColors);
[counts, histmap] = imhist(x,map); 
```

这将为您提供图像中每种不同颜色的直方图（发生次数）。如果您认为图像中有更多颜色，您可以将数字 1024 放大，最多可使用 65k 种颜色，之后它可以与 bin 一起使用。您可以使用地图从 rgb 值变为直方图值。

# sql - 如何在 Tsql 和 groupby 中获取表中字段的最大计数

> ID：15051449
> 
> 赞同：0
> 
> 时间：2013-02-24T11:51:10.137
> 
> 标签：sql, tsql, group-by, aggregate-functions

我有一张桌子`Customer_Complex_LoginLogs`来记录客户入口。

我想获得一天内发生的最大入口数（并且我想知道发生这种情况的那一天）。

我知道我应该执行`group by TFEnteranceDate`

如何在 TSQL 中实现这一点？

表名：

```
Customer_Complex_LoginLogs 
```

表字段：

```
Id guid  PK
Id_Customer guid   FK
TFEnteranceDate datetime
TFEnteranceDatep nvarchar(10) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T11:55:47.883

如果没有更多信息，这可能是一个简单的 GROUP BY

```
SELECT TOP 1 TFEnteranceDate, Count(TFEnteranceDate) as Enterance
FROM Customer_Complex_LoginLogs 
GROUP BY TFEnteranceDate
ORDER BY Count(TFEnteranceDate) DESC 
```

编辑：记录最大数量的 TFEnteranceDate 的那一天

# java - 如何为 swagger 注释 Play 2 webapp 模型？

> ID：15051456
> 
> 赞同：3
> 
> 时间：2013-02-24T11:53:22.483
> 
> 标签：java, rest, playframework, playframework-2.0, swagger

我是 Play2 框架的 android/java 开发人员。我正在尝试使用[swagger](https://github.com/wordnik/swagger-core/)为我的 RESTful API 生成文档。

我设法将 swagger 包含到我的 Play2 webapp 中并生成简单的 api-docs.json。我唯一缺少的部分是模型描述。我在 /controllers 和 /models 中有相应的用户控制器和用户模型。

```
@Api(value = "/user", listingPath = "/api-docs.{format}/user", description = "User registration and authorisation")
public class User extends Controller {

    @POST
    @ApiOperation(value = "Create user", notes = "Used to register new user.")
    @ApiParamsImplicit(@ApiParamImplicit(name = "body", value = "Created user object", required = true, dataType = "User", paramType = "body"))
    @BodyParser.Of(BodyParser.Json.class)
    public static Result createUser() {
        JsonNode json = request().body().asJson();
        ObjectNode result = Json.newObject();
        JsonNode body = json.findPath("body");
        if(body.isMissingNode()) {
            result.put("status", "KO");
            result.put("message", "Missing parameter [body]");
            return badRequest(result);
        }

        JsonNode name = body.get("name");

        if(name == null) {
            result.put("status", "KO");
            result.put("message", "Missing parameter [body.name]");
            return badRequest(result);
        }

        result.put("status", "OK");
        result.put("message", "Hello " + name.getTextValue());
        return ok(result);
    }

} 
```

我试图完全按照[示例注释模型](https://github.com/wordnik/swagger-core/blob/master/samples/java-play2/app/models/User.java)

```
@XmlRootElement(name = "User")
public class User {
    public String name;

    @XmlElement(name = "name")
    public String getName() {
        return name;
    }
} 
```

结果是：

```
{
    apiVersion: "beta",
    swaggerVersion: "1.1",
    basePath: "http://localhost:9000",
    resourcePath: "/user",
    apis: [
        {
            path: "/user",
            description: "User registration and authorisation",
                operations: [
                {
                    httpMethod: "POST",
                    summary: "Create user",
                    notes: "Used to register new user.",
                    responseClass: "void",
                    nickname: "createUser",
                    parameters: [
                        {
                        name: "body",
                        description: "Created user object",
                        paramType: "body",
                        required: true,
                        allowMultiple: false,
                        dataType: "User"
                        }
                    ]
                }
            ]
        }
    ]
} 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T14:24:31.823

我自己找到了答案。看起来，当模型被用作返回值时，swagger 会确认模型，即**responseClass**：

```
@ApiOperation(  value = "Find quiz by ID",
        notes = "Returns a quiz with given ID",
        responseClass = "models.Quiz" )
@ApiErrors(     value = {
        @ApiError(code = 400, reason = "Invalid ID supplied"),
        @ApiError(code = 404, reason = "Quiz not found") })
public static Result getQuizById(
        @ApiParam(value = "ID of question that needs to be fetched", required = true) @PathParam("quizId")
        String quizId) {

    ObjectNode result = Json.newObject();
    return ok(result);
} 
```

像这样简单地添加方法会使相应的模型出现在 api-docs.json 中。

# jquery - .click() 在 Safari 中不起作用

> ID：15051460
> 
> 赞同：1
> 
> 时间：2013-02-24T11:53:55.670
> 
> 标签：jquery, safari, click

这种小小的代码和平在 Firefox 中有效，但在 Safari 中无效：

```
$('.pinterest-button').click(function() {
    $('.pinterest-button').hide();
    $('#pin1 a img').click();
    setTimeout("$('.pinterest-button').show();", 1000);
}); 
```

如果点击了 pinterest 按钮，它应该为该图片创建一个点击事件：

```
<div id="pin1" class="gallery span24 offset6">
   <a class="span24" alt="" title="bild" href="javascript:void((function()%7Bvar%20e=document.createElement('script');e.setAttribute('type','text/javascript');e.setAttribute('charset','UTF-8');e.setAttribute('src','http://assets.pinterest.com/js/pinmarklet.js?r='+Math.random()*99999999);document.body.appendChild(e)%7D)());">
      <img class="gallery-img" src="http://www.goldentree.de/wordpress/assets/bild.jpg">
   </a>
</div> 
```

如果我单击 Safari 中的按钮，它会被隐藏并且页面滚动到顶部，因此单击本身可以工作，但我认为 $('#pin1 a img').click(); 那应该触发图像href中的代码不起作用。我发现其他一些人也有同样的问题，但他们的解决方案都不适合我，所以我不完全确定它是否真的是 click() 不起作用。我也不确定，是什么让我的浏览器滚动到顶部，因为我认为这是由 pinterest 覆盖物制作的。哦，是的：直接点击图片即可。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:01:18.417

这个问题可能是由两件事引起的

**1\. 附加监听器时 DOM 尚未准备好**

**2.你的HTML代码是动态添加的**

**第一种情况**的解决方案是将您的代码放在就绪块下

```
$(document).ready(function(){
    $('.pinterest-button').click(function() {
        $('.pinterest-button').hide();
        $('#pin1 a img').click();
        setTimeout("$('.pinterest-button').show();", 1000);
    });
}); 
```

**第二种情况**的解决方案是让监听器为任何变化而活

```
 $(document).ready(function(){
        $('.pinterest-button').on('click',function() {
            $('.pinterest-button').hide();
            $('#pin1 a img').click();
            setTimeout("$('.pinterest-button').show();", 1000);
        });
    }); 
```

**并在需要**时将 on click 添加到您的图像侦听器****

 **我希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-03T16:26:52.490

我认为这很像与 Safari 本身有关的问题：

[https://github.com/webdriverio/webdriverio/issues/4565](https://github.com/webdriverio/webdriverio/issues/4565)**

# macos - osx shell 日期错误

> ID：15051463
> 
> 赞同：1
> 
> 时间：2013-02-24T11:54:06.807
> 
> 标签：macos, date

我正在尝试从当天（24Feb13 day#55）中减去上课的第一天（17Feb13 day#47）该命令`date +%j`产生 055，而不是 55，所以数学错误......

`todayIn=$(date +%j)`......= 055

`firstDay=(47)`.....................= 47

`myVal=$(todayIn-firstDay)`....= 错误（预期为 8）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:00:11.247

似乎只需用以下内容去除前导零就足够了：

```
todayIn=$(date '+%j' | sed -e 's/^0*//') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:03:09.227

或使用`expr`：

```
$ a=$(expr 055 - 5)
$ echo $a
$ 50 
```

# php - 输入单选按钮更改算法

> ID：15051464
> 
> 赞同：0
> 
> 时间：2013-02-24T11:54:38.233
> 
> 标签：php, jquery, html, algorithm, loops

店铺。大车

```
name  |  price  |  count  |  price*count
apple      2         2           4
banana     3         4           12

Delivery
(radio button) none                       | checked
(radio button) to home (+3)
(radio button) to another town (+6)

Total Count               |      16 
```

*   当您更改计数时-我的脚本会动态重新计算总计数并随 Jquery Total Count text() 更改

现在我只需要在交付更改时动态更改 Total Count 文本。

我只是不明白**如何**。

如果我将其更改为`to home`, Total Count += 3, 那么如果我更改`count`项目, Total Count += ((price*newcount)-price*count)

**但是**当我将交付更改为 时`another town`，Total Count+=（新输入 - prev.input 单选），但是当我更改回 0 时，Total Count-=（输入值）

我的 JQuery 脚本只是在更改时获取`price*count`、 乘`price`和`count`兄弟值的值并检查 - 如果不同，则更改 Total Count 文本。

```
var updating = false;
if(!updating){
   updatePrice();
}

function updatePrice(){
   var pricewas = pricecountitem.text();
   var pricenow = pricecount;
   var difference = pricenow - pricewas;
   var numadd = 1;

   if(difference < 0){
      pricecountitem.text(+pricewas - numadd);
   }else if(difference > 0) {
      pricecountitem.text(+pricewas + numadd);
   }

   if(difference !== 0){
      updating = true;
      setTimeout(updatePrice, 1000);
   }else{
      updating = false;
   }
} 
```

* * *

我只是无法编写算法如何动态地更改值，包括所有交付情况和计数更改。

我的头要炸了，你们能帮帮我吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-26T10:48:34.767

在输入信息的下一页添加了交付。问题关闭。

# c++ - #define 参数之间的空格

> ID：15051466
> 
> 赞同：3
> 
> 时间：2013-02-24T11:54:50.410
> 
> 标签：c++, c, macros

`#define`我对我们不应该在参数中有空格的概念感到困惑。

我认为唯一的限制是我们不应该在宏名称和直接`(`括号之间有空格。我对么？我不应该在`()`括号内放置空格吗？

下面的记号是否正确

```
#define AVERAGE_NUMS( min_val, max_val ) ((min_val + max_val) / 2) 
```

伙计们，我上面的#define C++ 语句只是一个例子。在使用#define 时，我实际上很关心空格。无论如何感谢您的回答。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-24T12:05:30.013

是的，这是正确的。但是您应该将每个参数括在括号中

```
#define AVERAGE_NUMS( min_val, max_val ) (((min_val) + (max_val)) / 2) 
```

以避免运算符优先级问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-24T12:06:17.613

你是对的，宏名称和紧随其后的左括号之间没有空格。其他任何地方的空格==很好。

请注意用于宏参数的名称，如果您有一个与参数同名的变量，则会发生奇怪的事情......例如在您的示例中，您的参数是`max_val`，但您输入`Max_val`了宏，所以如果有一个变量`Max_val`你碰巧使用了这个宏，代码会编译得很好，但不能在其他地方编译......

就我个人而言，我总是在宏名称上加上前缀 _ 来帮助避免这种情况......但纯粹主义者告诉我下划线是保留的，不应该使用，而是填充它们:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-24T12:05:43.230

**在 C**中，当使用宏进行类似的小型计算时，您应该始终将表达式中的每个参数放在括号中，例如：

```
#define AVERAGE_NUMS(min_val, max_val) (((min_val) + (max_val)) / 2) 
```

宏参数列表中的空格是可选的，因此它们不会“伤害”。*正如您已经说过的，左括号前*的空格会改变宏的含义：它将不接受任何参数，并用您想要的参数列表和“表达式”替换它的出现。

如果您不将表达式中的参数放在括号中，您可能会遇到奇怪的结果，因为运算符优先级可能会更改您的表达式。这是因为宏只是文本替换规则，因此不尊重编程语言 (C) 的任何内容。

一个失败的小例子（这是一个奇怪的例子，我承认，但是你可以将其他函数写成宏，但“正常”用法会失败）：

```
AVERAGE_NUMS(1 << x, y) 
```

使用您的宏定义，这将扩展为

```
((1 << x + y) / 2)           // Operator precedence:  1 << (x + y) 
```

但是使用上面的宏定义，它将扩展为

```
(((1 << x) + (y)) / 2)       // Operator precedence:  (1 << x) + y 
```

* * *

**在 C++**中，我强烈建议您不要使用宏，除非您*真的*必须这样做。

在不需要指定类型的情况下计算两个数字的平均值的更好方法是使用模板方法：

```
template<typename T>
T average_nums(T min_val, T max_val) {
    return (min_val + max_val) / T(2);
} 
```

如果您关心性能，您应该注意所有现代编译器都以与宏定义相同的方式处理这段代码，即它们**内联**代码。这意味着不涉及函数*调用*，但表达式`avg(a, b)`被替换为`(a + b) / 2`.

this 和宏之间的区别在于宏只是在*预编译*期间发生的文本替换，因此实际的编译步骤将看到类似于`(a + b) / 2`而不是`avg(a, b)`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-24T12:40:02.277

我相信以下 1999 年 C 标准的摘录涵盖了如何在宏中处理空格的问题，它们确实指出空格只不过是一个标记分隔符，除了我们区分类对象宏的情况和类似函数的宏，基于宏名称和紧随其后的左括号之间是否有空格。

**5.1.1.2 翻译阶段**

...

1.3`The source file is decomposed into preprocessing tokens and sequences of white-space characters (including comments). ... Each comment is replaced by one space character. New-line characters are retained. Whether each nonempty sequence of white-space characters other than new-line is retained or replaced by one space character is implementation-defined.`

1.4`Preprocessing directives are executed, macro invocations are expanded, and _Pragma unary operator expressions are executed. ... All preprocessing directives are then deleted.`

1.7`White-space characters separating tokens are no longer significant.`每个预处理令牌都转换成一个令牌。生成的标记在句法和语义上进行分析，并作为翻译单元进行翻译。

...

**6.4 词汇元素**

**句法**

**令牌：**

*   关键词
*   标识符
*   持续的
*   字符串字面量
*   标点符号

**`preprocessing-token:`**

*   标题名称
*   标识符
*   pp号
*   字符常量
*   字符串字面量
*   标点符号
*   每个不能是上述之一的非空白字符

**语义**

…… `Preprocessing tokens can be separated by white space; this consists of comments (described later), or white-space characters (space, horizontal tab, new-line, vertical tab, and form-feed), or both. As described in 6.10, in certain circumstances during translation phase 4, white space (or the absence thereof) serves as more than preprocessing token separation.`_

**6.10 预处理指令**

**句法**

...

*   # 定义标识符替换列表换行
*   `# define identifier lparen identifier-listopt ) replacement-list new-line`
*   `# define identifier lparen ... ) replacement-list new-line`
*   `# define identifier lparen identifier-list , ... ) replacement-list new-line`

`lparen:`

  `a ( character not immediately preceded by white-space`

**6.10.3 宏替换**

**约束**

3`There shall be white-space between the identifier and the replacement list in the definition of an object-like macro.`

**语义**

10 形式的预处理指令

*   `# define identifier lparen identifier-listopt ) replacement-list new-line`
*   `# define identifier lparen ... ) replacement-list new-line`
*   `# define identifier lparen identifier-list , ... ) replacement-list new-line`

定义一个`function-like`带参数的宏，在语法上类似于函数调用。

# c# - ArcGis 10.1 - .NET Windows 服务

> ID：15051467
> 
> 赞同：1
> 
> 时间：2013-02-24T11:54:56.603
> 
> 标签：c#, windows-services, arcgis

**背景：**

.NET Framework 2.0，C# ESRI ArcGis 10.1 64 位 Windows Server 2008 R2。

1.  我们有一个第三方程序（系统 A 为简单起见）使用 ESRI 组件运行自定义模型系统的地图。
2.  系统 A 也使用它自己的许可系统。
3.  我们正在将数据从系统 A 拉到网络上供用户查看。
4.  系统如下： Web <-> WebService (使用 .NET-Remoting 2.0) <-> WindowsService.exe <-> DataFetcherStub.dll <-> DataFetcher.dll <-> System A

**问题：**

在 ArcGIS 9.3 到 ArcGIS 10.0 上运行这个都没有问题，而且系统 A 的早期版本。

系统 A 的提供者目前使用 10.0 中的 .NET-interop 将其升级到 ArcGIS 10.1。我们也这样做了，但现在它不再使用 .NET-Remoting -> WindowsService 了。

使用 DataFetcherStub 运行 EXE 一切正常。运行 Windows 服务，它在系统 A 内崩溃。

```
Faulting application name: windows_service.exe, version: 1.0.4802.40962, time stamp: 0x51293874
Faulting module name: AfCore_libFNP.dll_unloaded, version: 0.0.0.0, time stamp: 0x4f920360
Exception code: 0xc0000005
Fault offset: 0x619fe9b0
Faulting process id: 0x14c0
Faulting application start time: 0x01ce120f632c1f0e
Faulting application path: D:\path\windows_service.exe
Faulting module path: AfCore_libFNP.dll
Report Id: a41b42dc-7e02-11e2-8e56-00155d0a11a9 
```

在使用 ArcGIS 获得许可并通过 Windows 服务运行时，是否有人遇到过此错误？

ESRI 论坛上有一个帖子，但它不会给我留下任何线索如何解决这个问题？

[http://forums.arcgis.com/threads/74546-Product-Licensing-in-Scheduled-Batch](http://forums.arcgis.com/threads/74546-Product-Licensing-in-Scheduled-Batch)

接近供应商不是一种选择，因为他们花了将近一年的时间来解决我们发现的最后一个问题。在他们最终证明这是他们的错误之前，指责我们长达 9 个月，我很确定他们也会与此作斗争。如果我们能做一个变通方法会更快。

**我已经尝试从 Windows 服务中执行此操作。**

1) System.Threading.ThreadPool.QueueUserWorkItem(o => FireAndForgetProcess()); 没运气

2）Process.Start（“FireAndForgetMe.exe”）没有运气

任何人都可以提供另一种方法来让外部 exe 从 Windows 服务“释放自身”并表现得好像它是由它自己启动的一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T02:34:00.980

Esri 开发团队给了我一个修复程序，而无需使用管理员帐户运行。

这里的问题是 FLEXnet Licensing Service（Esri 现在在 10.1 中使用，但在 10.0 中未使用）没有设置正确的执行权限，因此“网络服务”帐户可以启动它。

Esri 正在开发一个补丁，但与此同时，有一个手动解决方法：

1.  确保您以在计算机上具有管理权限的用户身份登录。

2.  从 Windows 开始菜单中，选择运行并输入“cmd”。右键单击“cmd.exe”并选择“以管理员身份运行”。</p>

3.  在命令提示符下，运行以下命令：sc sdshow "FLEXnet Licensing Service"

这将打印出向该服务注册的 DACL 权限： D:(D;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;NU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;; CCLCSWRPLOCRRC;;;IU)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)

我们需要在权限字符串中插入“(A;;CCLCSWRPWPDTLOCRRC;;;WD)”，这样它就变成：D:(D;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;NU)(A;;CCLCSWRPWPDTLOCRRC;;;WD)(A ;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;;CCLCSWRPLOCRRC;;;IU)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD) 注意：用户的 DACL 字符串可能会有所不同，并且应该小心地对字符串进行编辑。

1.  要向服务注册 DACL，请运行以下命令： sc sdset "FLEXnet Licensing Service" ${your original DACL string with the new permission string inserted}

对于上面的示例，您将输入： sc sdset "FLEXnet Licensing Service" D:(D;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;NU)(A;;CCLCSWRPWPDTLOCRRC;;;WD)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A; ;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;;CCLCSWRPLOCRRC;;;IU)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)

1.  您应该看到 [SC] SetServiceObjectSecurity SUCCESS。就是这样。网络服务现在应该可以正常运行了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T00:17:00.033

**解决方案**

我将运行 Windows 服务的帐户更改为我的管理员帐户，现在它可以工作了。10.1 需要更多运行该服务的 windows 帐户，或者他们已降级该帐户。

我想我必须在早上检查一下。然而问题解决了。

编辑：这是需要在 10.1 之后提出的帐户的权利。

# ios - Xcode 项目：针对不同目标的不同语言

> ID：15051468
> 
> 赞同：4
> 
> 时间：2013-02-24T11:55:05.083
> 
> 标签：ios, xcode, localization

我在 Xcode 中有一个项目，这个项目有 4 个不同的目标：

```
+Main Project
 -Target1
 -Target2
 -Target3
 -Target4 
```

该项目在本地化中有 7 种不同的语言：

```
En,He,Sw,Ch,It,Ko,Jap 
```

我正在寻找一种方法来为每个目标设置不同的语言。

例如：

```
+Main Project
     -Target1(En only)
     -Target2(He,Sw,Ch)
     -Target3(It,ch)
     -Target4(Jap only) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-08T14:06:30.543

您可以为每个目标设置不同的本地化文件。

只需打开实用程序，在目标成员中选择您要本地化的目标。

例子：

*   en.string（仅标记 target1）
*   he.string, sw.string（仅标记 target2）
*   cd.string（标记 target2 和 3）
*   it.string（仅标记 target3）
*   ![jap.string（仅标记 target4）](../Images/1ab979c0fcfb0f615524d1f70917496d.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-10T06:15:09.640

[在 iOS 应用程序（iPhone 和 iPad）中](https://stackoverflow.com/questions/9939885/manual-language-selection-in-an-ios-app-iphone-and-ipad)使用此答案手动语言选择

你可以设置任何你想要的语言，记住“Localizable.strings”包含语言文本

# android - Android Inputread 流准确读取给定的缓冲区大小？

> ID：15051474
> 
> 赞同：0
> 
> 时间：2013-02-24T11:55:47.760
> 
> 标签：android, memory-management, buffer, inputstream

我正在阅读一个文件：

```
char [] buffer = new char[300];
FileInputStream istream = new FileInputStream(path);
InputStreamReader file = new InputStreamReader(istream);
size = file.read(buffer);
file.close(); 
```

经过几次尝试，结果证明`file.read(buffer)`读取的字符数与为缓冲区分配的字符数完全相同（在本例中为 300，即使文件中有更多字符）。

**我可以依靠 read() 总是尽可能多地阅读而不产生任何异常吗？
或者这是一个未记录的功能？**

读取方法描述说：

> 从该读取器读取字符并将它们存储在从偏移量 0 开始的字符数组 buf 中。返回实际读取的字符数，如果已到达读取器的末尾，则返回 -1。

没有提到缓冲区分配问题。这非常重要，而且它以这种方式工作是一件好事，因为它允许您根据需要/需要定义缓冲区的大小，无需猜测，无需为异常编写代码。实际上，它是，`read(char[] buffer)`但它的工作原理是`read(char[] buffer, int size)`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T14:42:31.317

是的，您可以依赖此调用，除非发生 I/O 错误，这已在 api 中提及。

如果您查看代码，`read(char cbuf[])`您会注意到它调用了方法`public int read (char[] buffer, int offset, int length)`。

来自安卓源代码：

`public int read(char cbuf[]) throws IOException { read(cbuf, 0, cbuf.length);}`

在您的实现中，您需要继续读取文件`file.read(buffer)`以获取剩余字节。的内容`buffer`需要附加到另一个会增长的缓冲区，具体取决于您正在阅读的文件的大小。

您还可以使用该方法分配具有文件大小的缓冲区`getTotalSpace()`

# java - 如何将修改后的 GPL 软件的源代码与闭源软件正确捆绑并发布

> ID：15051475
> 
> 赞同：1
> 
> 时间：2013-02-24T11:56:03.453
> 
> 标签：java, android, gpl, software-distribution

我为 Android 编写了一个应用程序，它通过 shell 命令启动和停止修改后的 GPLv2 许可工具。

它作为一个闭源 GUI 工作，我会将它与 GPLv2 许可的部分捆绑到一个 android-apk 中。

如前所述，我已经修改了 GPLv2 软件（从不需要的东西中删除了它并对其进行了一些扩展）。我将通过命令行调用（修改的）GPLv2 软件，以免损害 GPL 许可证（通过 shell 调用不像链接）。

它将如下所示：

[闭源 GUI] -> shell-command (start/stop) -> [修改后的 GPLv2-tool]

所有部分最后都发布在一个 .apk 文件中。

我现在的问题是：

1.  我如何提供 GPL 工具的修改源？

    *   只是应要求（例如“给我发电子邮件”）？
    *   还捆绑到 APK 文件中（将是最简单的）？
    *   将其发布在网络上（在哪里？！）？
2.  我必须在我的软件的“学分”中写什么？

    *   谢谢 .. ？
    *   看看#1 以获得源代码？

我会尊重许可协议，但 GPL 对我来说是一个新领域，所以我需要一些帮助。

PS：

也许还有人有一个最终答案：我也可以通过 Java-JNI 调用 GPLed 工具吗？但我认为这会损害 GPL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:02:26.997

我真的不关心您的用例的 GPL 有效性，但就源代码分发而言，您只需链接到可以下载源代码的地方就可以了（一个 github 页面，您自己的服务器，等等...），例如来自您的 AppStore / PlayStore 页面。

[http://www.gnu.org/licenses/gpl-faq.html#AnonFTPAndSendSources](http://www.gnu.org/licenses/gpl-faq.html#AnonFTPAndSendSources)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:10:44.603

据我了解GPL：

*   可以将 GPL 涵盖的作品与其他一些作品捆绑在一起，而无需将 GPL 应用于其他产品。
*   您已将修改后的 GPL 涵盖工具的源代码提供给相同的许可证。

[常见问题解答](http://www.gnu.org/licenses/old-licenses/gpl-2.0-faq.html#TOCGPLCompatInstaller)提供了一个带有“安装程序”的示例，它看起来与您想要实现的非常相似。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T18:15:17.840

我记得 RMS 将这种基于 shell 的调用称为“边界情况”。随心所欲地思考。我们不能为您承担责任。

# android - 后退按钮不会带我进入上一个活动，而是主屏幕

> ID：15051476
> 
> 赞同：0
> 
> 时间：2013-02-24T11:56:05.790
> 
> 标签：android, gps, maps, location, google-maps-android-api-2

在我的活动中，我正在检查 GPS 和 WIFI 定位服务是否都关闭。

如果两者都关闭，则会触发定位服务的意图。但是，当我按下返回按钮时，我无法返回我的活动，而是返回主屏幕。因此屏幕卡在位置设置页面。

请注意，我正在扩展 FragmentActivity 并使用 SupportMapFragment。

```
 int status = GooglePlayServicesUtil.isGooglePlayServicesAvailable(getBaseContext());

    if (status != ConnectionResult.SUCCESS)
    { // Google Play Services are not available

        int requestCode = 10;
        Dialog dialog = GooglePlayServicesUtil.getErrorDialog(status, this,requestCode);
        dialog.show();

    } else
    { 

        fm = (SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map);
        googleMap = fm.getMap();
        googleMap.setMyLocationEnabled(true);

        LocationManager locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);

        if(locationManager != null)
        {
            gpsIsEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
            networkIsEnabled = locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);

            if(gpsIsEnabled==false && networkIsEnabled==false)
            {
                Log.i("code","both wifi and gps off.");
                Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
                startActivityForResult(intent, 1);
            }
            else
            {
                Criteria criteria = new Criteria();
                String provider = locationManager.getBestProvider(criteria, true);

                location = locationManager.getLastKnownLocation(provider);

                if (location != null)
                {
                    onLocationChanged(location);
                }

                locationManager.requestLocationUpdates(provider, 20000, 0, this);
            }
        }
        else
        {
            Log.i("app","null.");
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T13:30:37.263

确保您`ACCESS_FINE_LOCATION`的清单中有。

```
public class main extends Activity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button button = (Button)findViewById(R.id.button1);
    button.setOnClickListener( new OnClickListener() {
        @Override
        public void onClick(View v) {
            // If Gps and Wifi are off

               Intent mIntent= new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS);
               mIntent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);
               startActivityForResult(mIntent, 1);
        }
    });
}

@Override
   protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (resultCode == 1) {
       switch (requestCode) {
          case 1:
               // Fetch Location..
           break;
        }
     }  
 } 
```

# compiler-construction - 如何在任何拱门上将 long 的大小强制为 8 字节？

> ID：15051477
> 
> 赞同：0
> 
> 时间：2013-02-24T11:56:41.850
> 
> 标签：compiler-construction, 64-bit, typedef, long-integer, sizeof

无论我是在 32 位模式还是 64 位模式下编译，我都希望我的 long 为 8 个字节。我正在使用 MSVC，此时我不太关心跨平台性。我试着做类似的事情

```
#define long __int64 
```

或者

```
typedef __int64 long; 
```

但是第一个导致其他文件中出现大量编译错误，而第二个似乎编译器本身无法接受。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:02:17.630

我不会更改保留类型的默认行为。如果您喜欢并使用它，更好的做法是创建一个新类型。

考虑一下包含 thirdPartyLib 并且它的“h”文件具有类似内容的情况：

```
void func1(long number); 
```

当您的代码包含“h”文件时，它会将“number”参数视为 64 位，但是当 lib 的原始“c”文件包含“h”时，它可以认为“number”是 32 位。这将导致联动阶段出现问题。

# html - 我怎样才能为facebook制作一个标题？

> ID：15051480
> 
> 赞同：0
> 
> 时间：2013-02-24T11:57:09.913
> 
> 标签：html, css

我正在尝试制作一个与 facebook 完全相同的标题，但是当我将其固定在里面时，它的内容开始改变 window resize 上的位置。像这里[http://www.housetostay.co.za/](http://www.housetostay.co.za/) 我该如何解决这个问题下面是我的代码

```
<html>
<head>
  <style>
    .heading { 
      display:block;
      top:0px;
      left:0px;
      right:0px;
      height:20px;
      position:fixed;
      border:1px solid #888;
      padding:0px;
      text-align:center;
      font-weight:bold;
      color:#000;
      background: #ccc;
      width: 100%;
      height: 100px;
      z-index:3;
    }
  </style>
</head>
<body>
  <div class = "heading">
    <table id ="headertable" align="left">
      <tr>
        <td>
          <a href="http://www.housetostay.co.za">
            <h2 class= "logo">HouseToStay</h2>
            <td>&nbsp;</td>
          </a>
        </td>
        <td><a href="http://www.housetostay.co.za" class="button middle">How it works</a></td>
        <td><a href="http://www.housetostay.co.za" class="button middle">Contact us</a></td>
        <td><a href="register.php" class="button middle">PostAd</a></td>
        <td><a href="jobs.php" class="button middle">Jobs</a></td>
        <td><a href="http://www.housetostay.co.za" class="button middle">Buy it</a></td>
        <td>
        </td>
    </table>
    <table class ="profile">
    <tr>
      <td>
        <h2>user</h2>
      </td>
      <td>
        <img src="bhubezi/images/logos/nopic.png" width="50" height="40">
      </td>
    </tr>
  </table>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:09:44.903

您可以尝试通过 jQuery 执行此操作。

这里有一个简单的[Demo](http://viralpatel.net/blogs/demo/jquery/scroll-fix-header-facebook/)

在这里你有一个[教程](http://viralpatel.net/blogs/scroll-fix-header-jquery-facebook/)

此示例在调整页面大小时运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T12:18:50.597

使用`<table>`for 布局通常不受欢迎，在这种情况下，您更难实现您想要做的事情。我建议用`<table>`更标准的 HTML 元素替换基于 - 的布局（例如，通过将菜单放入列表`<ul>`并将用户配置文件放入其自己的`<div>`），然后绝对定位这些元素并为它们提供明确的像素位置。然后，当您调整窗口大小时，它们不应该四处移动。

这是一个示例（使用您自己的代码，尽可能少地进行修改）：

```
<html>
<head>
<style>
.heading { 
    display:block;top:0px;left:0px;right:0px;height:20px;position:fixed;border:1px solid #888;padding:0px;text-align:center;font-weight:bold;color:#000;background: #ccc;width: 100%;height: 100px;z-index:3;
}

#logo {
    position:absolute; /* This will keep it one place */
    left:200px; /* This specifies what place */
}

#menu {
    position:absolute; /* This will keep it one place */
    left:320px; /* This specifies what place */
    width:400px; /* This makes sure the menu doesn't shrink if the window is made smaller */
    list-style-type:none;
}

#menu li {
    float:left;
    margin-right:10px;
}

#profile {
    position:absolute; /* This will keep it one place */
    left:750px; /* This specifies what place */
    width:100px; /* This makes sure the profile doesn't shrink if the window is made smaller */
}

#profile h2 {
    display:inline;
}
</style>
</head>
<body>
<div class="heading">
    <a href="http://www.housetostay.co.za" id="logo">
        <h2>HouseToStay</h2>
    </a>
    <ul id="menu">
        <li><a href="http://www.housetostay.co.za" class="button middle">How it works</a>    </li>
        <li><a href="http://www.housetostay.co.za" class="button middle">Contact us</a></li>
        <li><a href="register.php" class="button middle">PostAd</a></li>
        <li><a href="jobs.php" class="button middle">Jobs</a></li>
        <li><a href="http://www.housetostay.co.za" class="button middle">Buy it</a></li>
    </ul>
    <div id="profile">
        <h2>user</h2>
        <img src="bhubezi/images/logos/nopic.png" width="50" height="40">
    </div>
</div> 
```

**编辑**：向标题元素添加了明确的像素位置。

# php - 用于浮点或双精度的 PHP 函数（bccomp 和 gmp_cmp）

> ID：15051482
> 
> 赞同：0
> 
> 时间：2013-02-24T11:57:15.493
> 
> 标签：php, floating-point, numbers, floating-accuracy

PHP 建议使用这些函数进行浮点数比较 [[这里](http://php.net/manual/en/language.types.float.php)]

[bccomp](http://php.net/manual/en/function.bccomp.php) — 比较两个任意精度数

**`int bccomp ( string $left_operand , string $right_operand [, int $scale ] )`**

[gmp_cmp](http://php.net/manual/en/function.gmp-cmp.php) — 比较数字

**`int gmp_cmp ( resource $a , resource $b )`**

我使用**了 bccomp**但我仍然无法得到正确的结果：

```
<?php
$n1 = bcdiv(1, 2.36, 4);
$n2 = bcdiv(4237288, 10000000, 4);
echo bccomp( $n1, $n2, 4); // 0! must be 1

echo "<br>\n";
var_dump(bcdiv(1, 2.36, 4)); // string(6) "0.4237" 

echo "<br>\n";
var_dump(bcdiv(4237288, 10000000, 4)); // string(6) "0.4237" 

?> 
```

到目前为止，我知道1/2.36的结果等于（0.4237288135593220338983050847457627118644067796610169491525423728813559322033898305084745762711864406......）

那么，我怎么知道这样的小数位数很大呢？

可能的解决方案：

```
$n1 = bcdiv(1, 2.36, 400);
$n2 = bcdiv(4237288, 10000000, 400);
echo bccomp( $n1, $n2, 400); //1 
```

我认为这个解决方案直到不再可用。

**有什么建议吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T15:28:23.663

首先，如果您想比较浮点数，您可以使用内置的比较运算符，如[您链接到的页面](http://php.net/manual/en/language.types.float.php)`<`上的“比较浮点数”标题下所述。

其次，如果您不想要浮点值的直接比较（但想要某种容差或部分比较），那么您还没有指定实际想要的比较。对于您的应用程序的需要，究竟在什么情况下比较应该返回小于、等于和大于？

第三，`bccomp`比较浮点值的方法很糟糕：

*   默认情况下，它会尝试使用值中的“位数”来确定要比较的容差。但是，二进制浮点值在此代码尝试测量它们的方式中没有许多十进制数字。
*   即使他们这样做了，在各种操作之后可能出现在浮点值中的错误量也不是数字中小数位数的函数，因此位数不是衡量应该有多大容差的好方法被接受。
*   一旦确定了可接受的误差容限，逐位比较就无法允许该容差。例如，如果您想接受两个相差小于 0.01 的值，但您通过比较它们的两位表示“3.5​​0”和“3.49”来比较值 3.4951 和 3.4949，它们将被报告为不相等甚至尽管它们仅相差 0.0002。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T13:49:37.443

当您比较浮点数时，您必须选择比较比例。如果 400 是必要的，那么这就是你的规模。

或者......您可以尝试定义自己的除法函数并比较除法缩放的每一步的结果。它可能是一个递归函数。

# javascript - 多页与单页和不显眼的 Javascript

> ID：15051489
> 
> 赞同：10
> 
> 时间：2013-02-24T11:58:13.453
> 
> 标签：javascript, html, navigation, unobtrusive-javascript, ujs

我有一个包含多个类别的小部件的网站部分。每个类别名称都有一个菜单。对于启用了 Javascript 的任何人，单击一个类别会显示页面内该类别的内容。他们可以随意在类别之间单击，看到 DOM 根据需要更新。url 也使用标准哈希/hashbang 更新（如果我们对 Google 友好）。因此，对于登陆 的人`example.com/widgets`，他们可以导航到`example.com/widgets#one`,`example.com/widgets#two`等`example.com/widgets#three`。

但是，要支持未启用 Javascript 的用户代理，遵循这些类别链接之一必须加载显示类别的新页面，因此对于未启用 javascript 的人，他们将导航到`example.com/widgets/one`、`example.com/widgets/two`等`example.com/widgets/three`。

我的问题是：当***启用了 Javascript 的*****人登陆这些 URL 之一****时会发生什么？*例如，启用 Javascript*的用户在登陆时应该看到什么？他们应该被重定向到?**`example.com/widgets/one``example.com/widgets#one`****

 ***请注意，我需要为启用了 Javascript 的任何人提供单页站点体验，但我希望为没有 JavaScript 的用户代理提供多页站点。任何不解决这个事实的答案都不能回答这个问题。我对 hashbang 或单页站点与多页站点的优点或问题不感兴趣。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-03T16:40:54.113

这就是我将如何构建它：

使用[HistoryJS](https://github.com/balupton/History.js/)来管理 URL。JS pushstate 浏览器得到完整正确的 URL，JS 非 pushstate 浏览器得到散列 URL。非 JS 用户通过重新加载页面正常访问完整 URL。

**当用户点击链接时：**

**如果他们有 JS：** 对其他页面的所有点击都由阻止默认操作的函数处理，获取 HREF 并将 URL 传递给 ajax 请求并同时更新 URL。然后解析该 ajax 请求的 http 响应，然后将其加载到内容区域。

**非 JS：** 页面正常刷新并加载整个文档。

**当页面加载时：**

**使用 JS：**将事件处理程序附加到所有链接以防止默认链接，以便通过 Ajax 处理它们的 href。

**没有 JS：**什么都没有。允许锚点正常工作。

我认为您绝对应该通过完整、正确的 URL 访问您的所有内容，并通过 ajax 将其加载，然后更新 URL 以反映您从中获取内容的地址。这样，当 JS 不运行时，您无需更改任何内容。

你是这个意思吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:15:15.377

显然你的问题已经包含了答案。你说：

> 我需要启用 Javascript 的任何人的单页网站体验

然后问：

> 例如，启用 Javascript 的用户在登陆时应该看到`example.com/widgets/one`什么？他们应该被重定向到`example.com/widgets#one`?

我会说**是的，他们应该被重定向**。鉴于您的要求（以及有关 JavaScript 功能和 URL 哈希片段的信息在服务器端不可用的事实），我没有看到任何其他选项。

* * *

如果您可以接受稍微放宽要求，我会看到另一种选择。还记得当网络上挤满了框架集时，我们通过 AltaVista（Google 还没有出现！）搜索进入了一个特定的框架？通常会看到一个标题说该页面应该显示为一个框架，以及一个将用户带到框架集版本的链接。

您可以做类似的事情：当脚本可用时，检测到您所在的位置`example.com/widgets/one`并添加指向单页版本的链接。我知道这并不理想，但总比没有好，也许比讨厌的客户端重定向要好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T04:38:56.893

为什么需要将它们重定向到不同的页面。用户到达页面寻找答案。即使他启用了 javascript，他也会得到答案。没关系。用户的查询已完成。

但是如果用户登陆 example.com/widgets#one 会发生什么？在这种情况下，您需要设置一个自动重定向到 example.com/widgets/one。这可以通过检查`onload`事件中是否启用了 javascript 并重定向到适当的页面来完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-03T15:09:00.070

设计此类页面的一种方法是首先在没有 javascript 的情况下进行设计。

您可以在页面中使用锚点：

```
example.com/widgets#one 
```

将是指向 id 为“one”的元素的链接

一旦您的页面在没有 javascript 的情况下工作，然后您添加 javascript 层。您可以使用 event.preventDefault 阻止链接被跟踪。

( [https://developer.mozilla.org/fr/docs/DOM/event.preventDefault](https://developer.mozilla.org/fr/docs/DOM/event.preventDefault) )，然后添加所需的 javascript 功能。**

# ios - 在事件中更改 UIButton 背景图像

> ID：15051500
> 
> 赞同：0
> 
> 时间：2013-02-24T12:00:34.340
> 
> 标签：ios, objective-c, uibutton, uiswitch

当 a`UISwitch`从“OFF”变为“ON”时，我希望 a 的背景图像发生`UIButton`变化。我有以下代码：

```
- (IBAction)switchValueChanged {
    if (Hard1ON.on) {
        UIImage *buttonImage = [UIImage imageNamed:@"red.jpg"];
        [Hard1 setImage:buttonImage forState:UIControlStateNormal];
        [self.view addSubview:Hard1];
        NSLog(@"Change");
    }
    else {
        UIImage *buttonImage = [UIImage imageNamed:@"white.jpg"];
        [Hard1 setImage:buttonImage forState:UIControlStateNormal];
        [self.view addSubview:Hard1];
    }
} 
```

当我按下开关时，控制台会正确记录，所以我知道它正在工作，但是按钮的背景没有改变。

供参考，`Hard1ON`is my`UISwitch`和`Hard1`is my `UIButton`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T12:07:38.730

添加一次按钮，最常见的方法是添加它，`viewDidLoad`然后在执行切换时更改其图像。

所以，内部`viewDidLoad`方法

```
// create the button
[self.view addSubview:Hard1]; 
```

然后，在您的值更改方法中

```
if (Hard1ON.on) {
    UIImage *buttonImage = [UIImage imageNamed:@"red.jpg"];
    [Hard1 setImage:buttonImage forState:UIControlStateNormal];
    NSLog(@"Change");
} else {
    UIImage *buttonImage = [UIImage imageNamed:@"white.jpg"];
    [Hard1 setImage:buttonImage forState:UIControlStateNormal];
} 
```

**注意** *使用驼峰命名法命名变量*。

例如，`Hard1`应该看起来像`hard1`. 最好将其命名为`hard1Button`或类似。这同样适用于开关元件。例如，`hard1OnSwicth`.

**编辑**

我会尝试在`viewDidLoad`方法中以编程方式创建按钮。

```
- (void)viewDidLoad
{ 
    [super viewDidLoad];

    self.hardButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [self.hardButton setFrame:CGRectMake(0, 0, 200, 50)]; // set the x,y,width and height based on your specs
    UIImage *buttonImage = [UIImage imageNamed:@"white.jpg"];
    [self.hardButton setImage:buttonImage forState:UIControlStateNormal];
    [self.view addSubview:self.hardButton];
} 
```

其中 hardButton 是对在 .h 中声明的按钮的引用（例如），例如

```
@property (nonatomic, assign) UIButton* hardButton; 
```

像这样合成它（如果你愿意，如果不是 Xcode 会照顾你）

```
@synthesize hardButton = _hardButton; 
```

如果您使用**strong**或**retain**而不是 assign 并且您不使用 ARC release in `dealloc`like

```
- (void)dealloc
{ 
   [_hardButton release];
   [super dealloc];
} 
```

现在，在你的开关值改变了。

```
- (IBAction)switchValueChanged
{
    UIImage* buttonImage = nil;
    if (Hard1ON.on) {
        buttonImage = [UIImage imageNamed:@"red.jpg"];
    } else {
        buttonImage = [UIImage imageNamed:@"white.jpg"];
    }

    [self.hardButton setImage:buttonImage forState:UIControlStateNormal];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T13:43:33.430

如果您使用按钮作为开关，您可以喜欢这种方式。

```
 _btnMale = [UIButton buttonWithType:UIButtonTypeCustom];
   [_btnMale setBackgroundImage:[ UIImage imageNamed:@"checkBox.png"] forState:UIControlStateNormal];
   [_btnMale setBackgroundImage:[ UIImage imageNamed:@"checkMark.png"] forState:UIControlStateSelected];
   _btnMale.tag = 1;
   _btnMale.frame = CGRectMake(150 , 9, 25, 25);
   [_btnMale addTarget:self action:@selector(selectGender:) forControlEvents:UIControlEventTouchUpInside];
   [self addSubview:_btnMale]; 
```

根据您的需要，在 viewDidLoad/viewDidAppear 方法中为选中状态和正常状态设置按钮图像。声明后，在您的目标方法中添加此代码。

```
-(void)selectGender:(UIButton*)sender{

  sender.selected = ! sender.selected;

} 
```

然后将其他按钮设置为 selected `NO`。然后按钮将像开关一样工作。

希望这会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T12:07:30.273

我想你想用`-setBackgroundImage:forState:`而不是`-setImage:forState:`

而且，正如@flexaddicted 所说，您只想添加一次按钮。

# c# - MVC4 授权属性

> ID：15051503
> 
> 赞同：0
> 
> 时间：2013-02-24T12:00:46.637
> 
> 标签：c#, asp.net-mvc-4

我在我的 routeconfig 路线中有：

```
routes.MapRoute(name: "Login", url: "login", defaults: new { controller = "Account", action = "Login" }); 
```

它工作正常，除非当用户未授权并使用 [Authorize] 调用函数时，他被重定向到帐户/登录，而不是应有的 / 登录。你能给我一个想法如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:05:20.977

您在 web.config 中设置的登录页面的 URL：

```
 <authentication mode="Forms">
      <forms loginUrl="~/Account/LogOn" timeout="2880" />
    </authentication> 
```

你应该在这里改变它。RouteTable 是关于将传入的 url 映射到控制器和操作。

# php - 在 php 中为 Web 应用程序创建临时用户帐户

> ID：15051507
> 
> 赞同：1
> 
> 时间：2013-02-24T12:01:08.757
> 
> 标签：php, javascript, user-interface, user-accounts

我正在构建一个 PHP 应用程序，用户可以在其中设计产品，然后根据需要检查到购物车。

为了让用户创建设计，我需要分配一个用户 ID 和设计 ID 以将其存储在数据库中。

有两种类型的用户可以构建设计：

*   注册用户。照顾这个，我没有问题。
*   非注册用户。这些是访客，他们可能会玩弄产品设计，然后当他们点击时`check out`，我才会要求他们注册。但为了存储他们的设计，我确实需要某种用户 ID。

我想使用时间戳作为这个用户的 ID，但是如果世界不同地区的两个用户同时创建设计怎么办？为临时/访客用户帐户生成 ID 的好策略是什么？我的意思不仅仅是暂时的`php session`，因为我希望他们*能够在以后再次访问该站点时访问他们部分保存的设计*，就像任何其他注册用户一样。我只会要求他们在结帐付款之前注册。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:09:04.070

一个简单的方法可能是：

*   使用单个用户表（用于注册用户和来宾）
*   分配一个“user_type”标志。例如注册/访客
*   对两种“类型”用户使用表主键或其他唯一值
*   当客人稍后退房时，切换他们的“user_type”。
*   将其他相关客户详细信息存储在单独的表中。

# javascript - 异步javascript - 如何传递参数？

> ID：15051508
> 
> 赞同：1
> 
> 时间：2013-02-24T12:01:09.600
> 
> 标签：javascript, database, asynchronous, parameters

这是异步 javascript 的片段：

```
var bsa = document.createElement('script');
bsa.type = 'text/javascript';
bsa.async = true;
bsa.src = 'myfile.js';
bsa.test_var = 'HI!';
(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa); 
```

我添加了这一行`bsa.test_var = 'HI!';`- 我试图将参数传递给`myfile.js`并打印出'test_var'，但它不起作用。

在 中`myfile.js`，我尝试调用`alert(bsa.test_var)`或只是`alert(test_var)`，但没有一个版本不起作用。

有什么方法可以传递参数吗？我想将参数传递到`myfile.js`并根据参数加载数据从数据库中获取适当的数据。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:03:37.687

您不将参数传递给脚本，而是将参数传递给函数。

您将需要更改脚本，以便在*调用*其中的函数之前它实际上不会做任何事情，并在此时传递参数。

然后，您的问题就变成了弄清楚脚本何时完成加载的问题，这可以通过向元素对象添加`.onload`处理程序来完成。`<script>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:25:30.577

不幸的是，您不能将参数传递给脚本。

您可以使用[RequireJS](http://requirejs.org/)来加载您的脚本。当您的脚本被加载时，您会收到通知，此时您可以使用所需的自定义参数执行初始化。不需要使用 AMD 模块，但如果你这样做，你的代码结构会更好。

```
require('myfile.js', function (MyModule) {
    var myModule = new MyModule(customParameter);
}); 
```

# excel - Excel宏 - 在一列中查找指定值并替换为另一列的所有内容（长度灵活）

> ID：15051512
> 
> 赞同：0
> 
> 时间：2013-02-24T12:01:25.217
> 
> 标签：excel, vba

我有一个超过 3000 行的电子表格，我想将 A 列中的特定值（v1，v2，...）替换为 B 列和 C 列中的内容，然后...

B、C、...列的内容长度不固定，因此无法使用 Excel 中提供的 REPLACE 功能。
由于内容很长，因此也无法对每一行进行编辑。简单的例子：

**A列**

```
{who} is the coach of {team} 
{who} is the coach of {team}
{who} is the coach of {team} 
```

**B栏**

```
Alex Ferguson
Roberto Mancini
Rafael Benitez 
```

**C栏**

```
Man United 
Man City 
Chelsea 
```

**D列**

```
Alex Ferguson is the coach of Man United
Roberto Mancini is the coach of Man City
Rafael Benitez is the coach of Chelsea 
```

D 列是我想要的（B 列替换 {who}，c 列替换 {team}）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T13:10:24.527

在 D 列试试这个： =SUBSTITUTE(SUBSTITUTE(A1,"{who}",B1),"{team}",C1)

您也可以不使用 A 列中的“{who}”：=B1 & “是” & C1 的教练

# chef-infra - 如何在 Vagrantbox 上使用 Chef-solo 设置部署用户？

> ID：15051514
> 
> 赞同：0
> 
> 时间：2013-02-24T12:01:42.957
> 
> 标签：chef-infra, vagrant

在我的 Vagrantfile 中，我有：

```
 config.vm.network :hostonly, "192.168.1.20" 
```

现在，我该如何设置我的用户

```
ssh  deploy@192.168.1.20 
```

开箱即用？（= 在`vagrant up`Chef-solo 配置之后和之后？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T15:04:51.887

您需要通过托管您的 vagrantbox 的机器的 IP SSH 到您的 vagrantbox。但是您使用的端口号与标准 ssh 端口 22 不同。通常 vagrant 为您的 vagrant 框的 ssh 端口 22 设置一个端口转发到主机的端口 2222

```
ssh -p 2222 deploy@localhost 
```

或者

```
ssh -p 2222 deploy@<port of your host machine> 
```

当然，您需要让厨师在您的一本食谱中创建部署用户，如下所述：[http ://wiki.opscode.com/display/chef/Resources#Resources-User](http://wiki.opscode.com/display/chef/Resources#Resources-User)

```
user "deploy" do
 comment "Deploy User"
 uid 1000
 gid "users"
 home "/home/deploy"
 shell "/bin/sh"
 password "$1$JJsvHslV$szsCjVEroftprNn4JHtDi."
end 
```

# android - box2d中的跳转功能

> ID：15051519
> 
> 赞同：1
> 
> 时间：2013-02-24T12:02:35.720
> 
> 标签：android, ios, box2d, game-physics

我正在开发 Box2d 世界的游戏。我在屏幕上有播放器，屏幕底部有一个地面。我想做“跳跃”功能。我看了很多例子，但我找不到我想要的。现在我用这个：

```
void jump()
{
   float impulse = body->GetMass() * 10;
   body->ApplyLinearImpulse( b2Vec2(0,-impulse), body->GetWorldCenter() );
} 
```

身体是我的播放器。但是在这个功能中，当我按下跳跃按钮时，它会一直跳跃直到我离开按钮。我想要：当我按下按钮时，它会向上和向下跳跃 10px 的位置。然后我可以再次按下。

# javascript - 使用 chrome 时，audio.js 不运行

> ID：15051523
> 
> 赞同：0
> 
> 时间：2013-02-24T12:03:00.130
> 
> 标签：javascript, jquery, google-chrome, firefox

这是我第一次使用 audio.js

很快[就](http://www.yabspor.com/mixtape/id/1)到了页面。使用firefox时没有任何问题。但是在使用 chrome 时会出现此错误。

> 加载错误：“ [http://www.yabspor.com/musics/yabspor1.mp3](http://www.yabspor.com/musics/yabspor1.mp3)

问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:10:14.317

有些浏览器不支持 mp3，尽管最新版本的 chrome 应该。尝试为 .ogg 添加一个选项，看看是否可以修复它（请注意，您还需要在同一目录中提供歌曲的 .ogg 版本）：

```
<audio src="http://www.yabspor.com/musics/yabspor1.mp3" preload="auto">
<audio src="http://www.yabspor.com/musics/yabspor1.ogg" type="audio/ogg"> 
```

如果您知道您有当前版本的 chrome，您可能只想将音频类型声明为 mp3：

```
<audio src="http://www.yabspor.com/musics/yabspor1.mp3" type="audio/mpeg" preload="auto"> 
```

[您可以在此处](http://www.w3schools.com/html/html5_audio.asp)阅读有关 html5 音频的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T00:33:00.110

如果您在 localhost 上测试 audiojs，它将无法与 Flash 后备一起正常工作。如果您尝试在 Firefox（或旧版本的 Chrome）中播放 mp3，就会发生这种情况。而是通过 IP 地址访问您的站点。

# opencv - CodeBook 背景减法与移动对象

> ID：15051525
> 
> 赞同：0
> 
> 时间：2013-02-24T12:03:29.990
> 
> 标签：opencv, background-image, background-subtraction

我正在尝试使用 OpenCV 的 CodeBook 方法来减去背景。到目前为止一切都很好，但我不确定是否可以在一段时间后更新移动物体的码本，比如 5 分钟，我需要更新码本，之后我会得到很多移动的物体。如何确保 5 分钟后我有需要更新的背景？

感谢您的提示！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T14:30:01.033

据说 kim 的算法有一个缓存层，我没有深入研究 opencv 实现，不知道如何有一个适用于曝光问题的可行版本。

### 笔记

*   opencv 书（我还没读过）应该有你需要的信息，如果它在那里的话
*   这只是 1 个频道，不在 yuv 中，虽然它可以扩展
*   需要更多的速度/测试工作（你当然可以在编译器中打开优化）
*   背景减法是一个流行词。尝试“更改检测”

bgfg_cb.h

```
#ifndef __bgfg_cb_h__
#define __bgfg_cb_h__

//http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.148.9778&rep=rep1&type=pdf
#include "opencv2/core/core.hpp"
#include "opencv2/imgproc/imgproc.hpp"
#include "opencv2/highgui/highgui.hpp"
#include <iostream>
#include <time.h>
using namespace cv;
using namespace std;

struct codeword {
    float min;
    float max; 
    float f;
    float l;
    int first;
    int last;
    bool isStale;
};
extern int alpha ;
extern float beta ;
extern int Tdel ,Tadd , Th;

void initializeCodebook(int w,int h);
void update_cb(Mat& frame);
void fg_cb(Mat& frame,Mat& fg);
#endif 
```

bgfg_cb.cpp

```
#include "opencv2/core/core.hpp"
#include "opencv2/imgproc/imgproc.hpp"
#include "opencv2/highgui/highgui.hpp"
#include <iostream>
#include <time.h>
#include "bgfg_cb.h"
using namespace cv;
using namespace std;

vector<codeword> **cbMain;
vector<codeword> **cbCache;
int t=0;
int alpha = 10;//knob
float beta =1;
int Tdel = 200,Tadd = 150,  Th= 200;//knobs

void initializeCodebook(int w,int h)
{
    cbMain = new vector<codeword>*[w];
    for(int i = 0; i < w; ++i)
        cbMain[i] = new vector<codeword>[h];

    cbCache = new vector<codeword>*[w];
    for(int i = 0; i < w; ++i)
        cbCache[i] = new vector<codeword>[h];
}

void update_cb(Mat& frame)
{
    if(t>10) return;
    for(int i=0;i<frame.rows;i++)
    {
        for(int j=0;j<frame.cols;j++)
        {
            int pix =  frame.at<uchar>(i,j);
            vector<codeword>& cm =cbMain[i][j];         
            bool found = false;
            for(int k=0;k<cm.size();k++)
            {
                if(cm[k].min<=pix && pix<=cm[k].max && !found)
                {
                    found=true;
                    cm[k].min = ((pix-alpha)+(cm[k].f*cm[k].min))/(cm[k].f+1);
                    cm[k].max = ((pix+alpha)+(cm[k].f*cm[k].max))/(cm[k].f+1);
                    cm[k].l=0;
                    cm[k].last=t;
                    cm[k].f++;
                }else
                {
                    cm[k].l++;
                }
            }
            if(!found)
            {
                codeword n={};
                n.min=max(0,pix-alpha);
                n.max=min(255,pix+alpha);
                n.f=1;
                n.l=0;
                n.first=t;
                n.last=t;
                cm.push_back(n);
            }
        }
    }
    t++;
}

void fg_cb(Mat& frame,Mat& fg)
{
    fg=Mat::zeros(frame.size(),CV_8UC1);
    if(cbMain==0) initializeCodebook(frame.rows,frame.cols);
    if(t<10)
    {
        update_cb(frame);
        return;
    }

    for(int i=0;i<frame.rows;i++)
    {
        for(int j=0;j<frame.cols;j++)
        {
            int pix = frame.at<uchar>(i,j);
            vector<codeword>& cm = cbMain[i][j];    
            bool found = false;
            for(int k=0;k<cm.size();k++)
            {
                if(cm[k].min<=pix && pix<=cm[k].max && !found)
                {
                    cm[k].min = ((1-beta)*(pix-alpha)) + (beta*cm[k].min);
                    cm[k].max = ((1-beta)*(pix+alpha)) + (beta*cm[k].max);
                    cm[k].l=0;
                    cm[k].first=t;
                    cm[k].f++;
                    found=true;
                }else
                {
                    cm[k].l++;
                }
            }
            cm.erase( remove_if(cm.begin(), cm.end(), [](codeword& c) { return c.l>=Tdel;} ), cm.end() );
            fg.at<uchar>(i,j) = found?0:255;
            if(found) continue;
            found = false;
            vector<codeword>& cc = cbCache[i][j];   
            for(int k=0;k<cc.size();k++)
            {
                if(cc[k].min<=pix && pix<=cc[k].max && !found)
                {
                    cc[k].min = ((1-beta)*(pix-alpha)) + (beta*cc[k].min);
                    cc[k].max = ((1-beta)*(pix+alpha)) + (beta*cc[k].max);
                    cc[k].l=0;
                    cc[k].first=t;
                    cc[k].f++;
                    found=true;
                }else
                {
                    cc[k].l++;
                }
            }

            if(!found)
            {
                codeword n={};
                n.min=max(0,pix-alpha);
                n.max=min(255,pix+alpha);
                n.f=1;
                n.l=0;
                n.first=t;
                n.last=t;   
                cc.push_back(n);
            }

            cc.erase( remove_if(cc.begin(), cc.end(), [](codeword& c) { return c.l>=Th;} ), cc.end() );
            for(vector<codeword>::iterator it=cc.begin();it!=cc.end();it++)
            {
                if(it->f>Tadd)
                {
                    cm.push_back(*it);
                }
            }

            cc.erase( remove_if(cc.begin(), cc.end(), [](codeword& c) { return c.f>Tadd;} ), cc.end() );
        }
    }
} 
```

主文件

```
#include "opencv2/core/core.hpp"
#include "opencv2/imgproc/imgproc.hpp"
#include "opencv2/highgui/highgui.hpp"
#include "bgfg_cb.h"
#include <iostream>
using namespace cv;
using namespace std;
void proc()
{
    Mat frame,fg,gray;
    VideoCapture cap("C:/Downloads/S2_L1.tar/S2_L1/Crowd_PETS09/S2/L1/Time_12-34/View_001/frame_%04d.jpg");
    cap >> frame;
    initializeCodebook(frame.rows,frame.cols);
    for(;;)
    {
        cap>>frame; 
        cvtColor(frame,gray,CV_BGR2GRAY);
        fg_cb(gray,fg);
        Mat cc;
        imshow("fg",fg);
        waitKey(1);
    }
}

int main(int argc, char ** argv)
{
    proc(); 
    cin.ignore(1);
    return 0;
} 
```

# c# - selectedindexchanged 事件未触发

> ID：15051529
> 
> 赞同：1
> 
> 时间：2013-02-24T12:04:56.363
> 
> 标签：c#, asp.net, drop-down-menu

我有三个`dropdownlists`，`autopostaback=true`但问题是第二个`dropdownlist`只`pageload`被调用，但它`selectedindexchanged`没有触发！我能做什么？（`dropdownlists`在`updatepanel`）

```
EDIT:
 protected void Page_Load(object sender, EventArgs e)
    {
        if (DDL_d1.Items.Count == 0)
        {
            SqlDataReader dr = null;
            DbAccessor db = new DbAccessor();
            dr = db.SqlSelectS("true", "SELECT Fname FROM [Tbl_Amoozesh]");
            DDL_d1.Items.Clear();
            while (dr.Read())
                DDL_d1.Items.Add(dr[0].ToString());
            db.Dispose();
        }
    }
    protected void d1(object sender, EventArgs e)
    {

        DDL_d1.AutoPostBack = false;
        SqlDataReader dr = null;
        DbAccessor db = new DbAccessor();
        dr = db.SqlSelectS(DDL_d1.SelectedValue,"SELECT Fname FROM [Tbl_Amoozesh] where Fname = @a");
        DDL_d2.Items.Clear();
        DDL_d2.Items.Add(new ListItem("hi"));
        while (dr.Read())
            DDL_d2.Items.Add(dr[0].ToString());
        db.Dispose();

    }
    protected void d2(object sender, EventArgs e)
    {

        SqlDataReader dr = null;
        DbAccessor db = new DbAccessor();
        dr = db.SqlSelectS(DDL_d2.SelectedValue, "SELECT Lname FROM [Tbl_Amoozesh] where Fname = @a");
        DDL_d3.Items.Clear();
        while (dr.Read())
            DDL_d3.Items.Add(dr[0].ToString());
        db.Dispose();

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:03:06.527

您必须在更新面板中放置一个异步触发器。尝试这个：

```
<asp:UpdatePanel id="up1" runat="server" updatemode="conditional">
   <Triggers>
      <asp:AsyncPostBackTrigger ControlID="ddl" EventName="SelectedIndexChanged" />
   </Triggers>
   <ContentTemplate>
      <%-- your content here --%>
      <asp:DropdownList id="ddl" AutoPostback="true" OnSelectedIndexChanged="handler" />
   </ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-13T09:25:46.343

我最近遇到了同样的问题。我还`dropdownlist`从数据库表中填充了我的内容，并尝试了所有内容，包括`AutoPostBack = true`控件上的设置。事实证明，这是一个已知错误，您可以通过将索引 0 设置为“选择人员”之类的虚拟项目来解决。看看这里的帖子：

[https://forums.asp.net/t/1275349.aspx?Dropdownlist+not+firing+SelectedIndexChanged+on+first+item+with+autopostback+true](https://forums.asp.net/t/1275349.aspx?Dropdownlist+not+firing+SelectedIndexChanged+on+first+item+with+autopostback+true)

这解决了我的问题。

# ios - @synchronized 是什么意思

> ID：15051532
> 
> 赞同：-1
> 
> 时间：2013-02-24T12:05:06.803
> 
> 标签：ios, objective-c

我遇到了这个代码：

```
 @synchronized (self.messageQueue) {
        [self.messageQueue insertObject:messageDictionaryRepresentation atIndex:0];
    } 
```

我想请教这个语法（@synchronized）的用途是什么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:10:17.957

See [Synchronization](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Multithreading/ThreadSafety/ThreadSafety.html). You find that is "a convenient way to create mutex locks on the fly in Objective-C code". a related question is [What does @synchronized() do?](https://stackoverflow.com/questions/6317889/what-does-synchronized-do).

# html - CSS - 图像可以在不影响页面宽度的情况下重叠页面边框吗？

> ID：15051539
> 
> 赞同：0
> 
> 时间：2013-02-24T12:05:43.800
> 
> 标签：html, css

我的初始页面概念中有以下元素：

[http://tinyurl.com/bcmcxp9](http://tinyurl.com/bcmcxp9)

功能区是 PNG 图像。我想要做的是将此图像精确定位在框阴影 div（表示页面内容）的边框上，而不会影响页面宽度。

我尝试了几种技术。

通过使用 position:absolute，我已经能够实现我想要的视觉效果，但是它带来了可怕的水平滚动条！我希望**div**的边缘（不是图像的边缘）代表页面的边缘。

```
#banner-ribbon {
    background-image: url(ribbon-right.png);
    background-repeat: no-repeat;
    position: absolute:
    width: 419px;
    height: 114px;
    left: 700px;
    top: 400px;
} 
```

通过使用位于内容包装器和背景之间的 div，我能够在不影响水平滚动条的情况下将图像定位在正确的位置（有点，我可能需要一些 javascript 来相对于中心），但我不能将图像的 z-index 提高到其子 div 之上！

```
#banner-ribbon-wrapper {
    background-image: url(ribbon-right.png);
    background-repeat: no-repeat;
    background-position: 90% 400px;
    z-index: 70; /* does nothing */
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:17:56.577

听起来图像正在扩展页面的边界，从而导致水平滚动条。解决此问题的一种方法可能是为页面设置宽度，然后隐藏超出页面的任何内容。这样的事情可能对你有用：

```
body {
    width: 100%;
    overflow-x: hidden;
} 
```

示例[jsFiddle](http://jsfiddle.net/8GByr/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:18:37.923

给你的内容 div

```
position: relative 
```

和你的丝带

```
position: absolute
right:0 
```

确保您的图像不会不受控制地扩展边界。

JsFiddle 上的工作示例：http: [//jsfiddle.net/BrvJk/](http://jsfiddle.net/BrvJk/)

# php - 为什么在 Windows 7 上运行的 apache Web 服务器无法允许外部传入连接

> ID：15051546
> 
> 赞同：0
> 
> 时间：2013-02-24T12:07:19.253
> 
> 标签：php, flash, apache, adobe, windows-7-x64

我在学校的 Windows 7 - 64 位上安装了 apache Web 服务器 2.4，并安装了 php 5.3 和 mysql。此 Web 服务器有一个静态 IP 地址，我已允许 Windows 7 防火墙上的 Apache httpd.exe 程序。

当我试图在学校（在同一个局域网上）访问该页面时，我能够访问该页面。但是，当我尝试从家里（使用外部 IP 地址）访问它时，我无法访问托管在 Web 服务器上的网页。当我尝试在学校 ping 网络服务器的静态 IP 地址时，它可以工作，但是当我从校外网络 ping 时，我会丢失数据包。

此外，我在同一台机器上安装了 Adob​​e Flash Media Server 4.5，监听端口 1935 和 1234。

我也尝试卸载并重新安装apache，但无济于事。

知道这里的问题是什么吗？或者有什么方法可以测试出问题？

问题是因为 Windows 7 严格的防火墙安全吗？还是64位机器？还是在同一台机器上运行的 adobe flash 媒体服务器？或者 Apache 中的任何错误配置？

注意：静态IP地址是可以访问的，并且服务器可以在服务器以前在windows xp上运行时提供一个页面。最近，我刚刚更改为 Windows 7，但 apache 服务器似乎无法提供相同的页面。

真的很感激这里的一些帮助！！！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:10:47.657

Your server machine may have a firewall which allows connections, but the machine may stand behind the router which does not forward ports correctly. Have you checked this?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:13:58.033

The LAN is being protected by the router to the external network. You need to get the administrator to configure this router.

# java - GWT - image.getHeight() 和 image.getWidth() 在第一次加载时不起作用

> ID：15051552
> 
> 赞同：0
> 
> 时间：2013-02-24T12:07:39.230
> 
> 标签：java, gwt

我是 GWT 的新手，想知道为什么我不能让它工作。

我正在尝试将大图像调整为较小的图像，同时使用以下代码保留纵横比：

```
Image image = new Image(myImageResource.getURL());
image.setPixelSize(newWidth, myImageResource.getHeight() * newWidth / myImageResource.getWidth()); 
```

但发生的情况是，当我第一次单击执行上述代码片段的 CellList 项（通过 SingleSelectionModel 处理）时，函数返回 0，并且从我第二次单击相同的列表项开始完美运行`myImageResource.getHeight()`。`myImageResource.getWidth()`这发生在所有 CellList 项上。我尝试了很多东西，但无法让它发挥作用。

有人可以帮我解决问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T20:48:04.187

当你对 进行操作时`image`，实际上它并没有添加到 DOM 中。您需要在它添加到 DOM 后对其执行该操作。

```
 Image image = new Image();
            image.addLoadHandler(new LoadHandler() {
                @Override
                public void onLoad(LoadEvent event) {
              //Do your operations on image .
       image.getElement().getStyle().setVisibility(Style.Visibility.Visible); 
                      }
                 });

    image.getElement().getStyle().setVisibility(Style.Visibility.HIDDEN); 
    RootPanel.get().add(image);
    image.setUrl(url); 
```

你可能会怀疑**Style.Visibility.Hidden 和 Visible**

**原因**：如果您正在做更改`image(resize)`，用户可以先看到原始图像，然后调整图像大小。为防止先隐藏 ige，请进行更改，最后***仅显示***。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T14:37:27.780

`You can get the correct height and width of the image only if the image is already rendered in the UI`.

我猜你正试图在点击时渲染图像。如果是这样，对于第一次单击，图像尚未呈现。所以它返回 0 作为高度和宽度。首先单击它会返回正确的值，因为图像已经渲染。所以它完美地工作。

解决方案：与 CellList Items 一起渲染图像，并使用 CSS visible 或 display 属性控制图像可见性。单击时，您可以使用计算出的高度和宽度启用图像可见性。

# c++ - Qt 信号（QueuedConnection 和 DirectConnection）

> ID：15051553
> 
> 赞同：55
> 
> 时间：2013-02-24T12:07:49.563
> 
> 标签：c++, qt, qthread, qt-signals

我在使用 Qt 信号时遇到问题。

我不明白如何`DirectConnection`工作`QueuedConnection`？

如果有人能解释何时使用其中的哪一个（示例代码将不胜感激），我将不胜感激。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2013-03-13T02:29:59.987

除非您使用具有不同线程关联性的对象，否则您不会看到太大的差异。假设您有 QObjects`A`并且`B`它们都附加到不同的线程。 `A`有一个信号叫做`somethingChanged()`并且`B`有一个槽叫做`handleChange()`.

如果您使用直接连接

```
connect( A, SIGNAL(somethingChanged()), B, SLOT(handleChange()), Qt::DirectConnection ); 
```

该方法`handleChange()`实际上将在`A`'s 线程中运行。基本上，就好像发出信号“直接”调用 slot 方法一样。如果`B::handleChange()`不是线程安全的，这可能会导致一些（难以定位）错误。至少，您错过了额外线程的好处。

如果您将连接方法更改为`Qt::QueuedConnection`（或者，在这种情况下，让 Qt 决定使用哪种方法），事情会变得更有趣。假设`B`' 的线程正在运行一个事件循环，发出信号将向`B`' 的事件循环发布一个事件。事件循环将事件排队，并最终在控制权返回时调用 slot 方法（它是事件循环）。这使得在 Qt 中处理线程之间的通信变得非常容易（再次假设您的线程正在运行它们自己的本地事件循环）。您不必担心锁等问题，因为事件循环会序列化插槽调用。

注意：如果您不知道如何更改 QObject 的线程关联，请查看`QObject::moveToThread`. 那应该让你开始。

**编辑**

我应该澄清我的开场白。*如果您指定*一个排队连接，它确实会有所不同——即使对于同一线程上的两个对象也是如此。该事件仍被发布到线程的事件循环中。因此，方法调用仍然是异步的，这意味着它可以以不可预知的方式延迟（取决于循环可能需要处理的任何其他事件）。但是，如果您不指定连接方法，直接方法将自动用于同一线程上的对象之间的连接（至少在 Qt 4.8 中是这样）。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-10-12T12:03:50.493

除了雅各布罗宾斯回答：

声明“除非您使用具有不同线程关联的对象，否则您不会看到太大的区别”是*错误*的；

向同一线程内的直接连接发出信号将立即执行该槽，就像一个简单的函数调用一样。

向同一线程中的排队连接发出信号会将调用排队到线程事件循环中，因此执行将*始终*延迟。

[基于 QObject 的类与自身有一个排队连接](https://stackoverflow.com/questions/11230080/qobject-based-class-has-a-queued-connection-to-itself)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-29T15:08:14.693

雅各布的回答很棒。我只想在嵌入式编程中添加一个比较示例。

来自嵌入式 RTOS/ISR 背景，看到 Qt 的 DirectConnection 与 ISR 的抢占行为和 Qt 的 QueuedConnection 与任务之间的 RTOS 中的队列消息的相似性是有帮助的。

Side note: Coming from an Embedded background, it's difficult for me to not define the behavior in the programming. I never leave the argument as Auto, but that is just a personal opinion. I prefer everything to be explicitly written, and yes that gets difficult at times!

# html - 非常难以解决和奇怪的 CSS3 不透明度过渡问题（......一定是一个错误？）

> ID：15051557
> 
> 赞同：39
> 
> 时间：2013-02-24T12:08:07.890
> 
> 标签：html, css

我遇到了这个非常令人沮丧和奇怪的 CSS 问题，我绝对把我所有的头发都扯掉了。

我正在使用[Bones 样板](http://themble.com/bones/)制作一个网站，它一直很棒，直到现在......

它使用流体网格系统，我最近尝试创建一个简单的画廊，并将其制成网格（4 张图片，每张图片包含在四分之一列中，第一个/最后一个类添加到第一个/最后一个图像）。

如果您将鼠标悬停在图像上（由于某种原因在前三个图像上尤其明显），您会注意到它们由于某些疯狂的原因而将宽度改变了一两个像素。图像设置为`max-width:100%`，我觉得这在某种程度上是罪魁祸首，因为如果你给图像一个“固定”宽度（例如`.gallery-icon img {max-width:165px;}`，它解决了这个问题，但是作为一个流体网格系统，我不能继续下去路线，因为如果调整浏览器大小，图像将保持 165 像素，即使我根据媒体设置了 4 个不同的宽度，在媒体大小之间，图像也不会正确对齐。

如果不是因为`transition`效果问题（如果我`transition`关闭，图像会降低`opacity`，但没有动画），它会像我想要的那样工作:(

请帮助伙计们！

这是一个空的演示站点，其中运行着骨骼样板，仅是页面上的画廊。如果您看到晃动问题，请告诉我。

（我无法在 jsfiddle 上重新创建它，所以我将它安装在一个旧域上，我一直躺在那里，呵呵）

编辑：我刚刚注意到问题似乎发生在宽度和高度都大于 div 的图像上。图像 1 + 3 是这样的，它们有错误，而图像 2,4 似乎还可以？并且图像 2+4 的高度比 div 小.....但是即使我将图像设置为最大高度，问题仍然存在..

EDIT2：添加了一个快速视频来显示问题（最新的 Firefox 和 Chrome）[http://www.youtube.com/watch?v=uL81hLfMvvw](http://www.youtube.com/watch?v=uL81hLfMvvw)

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-06-27T21:45:32.697

感谢 vals[指出 GPU 方面](https://stackoverflow.com/questions/15051557/very-difficult-to-solve-and-strange-css3-opacity-transition-issue-must-be-a#comment21167872_15056231)......这让我想起了这个 CSS-Snippet，它倾向于解决 Chrome 渲染问题：

```
-webkit-transform: translateZ(0); 
```

我已将此应用于包含有问题的项目 (i.icon-) 的容器 (div.post)，该项目具有小数宽度，问题已解决！

信用：我从[这个答案](https://stackoverflow.com/questions/15152470/chrome-rendering-issue-fixed-position-anchor-with-ul-in-body/15203880#15203880)中得到了这个解决方案，在导航到页面锚点后修复错误渲染（固定）的元素。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-24T20:22:41.747

我会说这确实是 Chrome 中的一个错误（我使用的是 24.0.1312.57 m）。

问题并不真正在图像 1 + 3 上，我在图像 2 上看到过。

我认为当您将图像的宽度设为分数（例如 146.71 像素）时，就会出现问题。在固定显示中，这会四舍五入为 146 像素。在过渡中，它向上四舍五入（更正确！）到 147 像素。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-08-07T22:55:13.927

使用以下 css 提示将受影响的元素提升到新的复合层（它为我解决了同样的问题）：

```
.<your-css-selector> {
will-change: <css style about to change. example: opacity>;} 
```

这表明合成器将元素的绘制过程隔离到一个新的合成层中。在 chrome 开发工具中检查层时，您可以确保元素已被提升，从而问题得到解决。该元素将出现在具有以下“合成原因：具有活动的加速动画或过渡”的新图层中。有一个将改变的合成提示。

看起来在以这种方式将元素提升到新层之后，浏览器能够正确呈现过渡的最终状态。

伊万。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-17T22:43:25.947

在 Thins[链接](http://nickpye.com/2013/04/03/css3-opacity-transition-image-wiggle-bug-in-mozilla-firefox/)上，您可以找到 Mozilla 错误的解决方案。

您需要添加 1 个 CSS 规则：

```
-moz-backface-visibility: hidden; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-24T20:21:15.937

我建议使用 jQuery 来处理你的不透明度，而不是使用 CSS3 属性，因为你是正确的，因为你的最大宽度在你的转换中弄乱了，令人不快。

```
$(".gallery-icon img").hover(function(){
    $(this).fadeTo(fast, 0.7);
}, function(){
    $(this).fadeTo(fast, 1.0);
}); 
```

使用 jQuery 将修复许多带有过渡的小故障，并确保您的不透明度更改是跨浏览器兼容的（是的，我知道有很多用于浏览器的过渡标签，但并非所有浏览器都没有属性.) :) 希望有帮助！

# android - 在 android 应用程序中设置标题栏渐变

> ID：15051567
> 
> 赞同：-1
> 
> 时间：2013-02-24T12:09:51.547
> 
> 标签：android, eclipse, android-drawable

我想在我的应用程序标题栏上设置一个渐变（从`#F55B53`到`#FFFF00`），使用以下代码：

```
GradientDrawable gd = new GradientDrawable(GradientDrawable.Orientation.TOP_BOTTOM, new int[] {0xF55B53,0xFFFF00});
View title = getWindow().findViewById(android.R.id.title);
View titleBar = (View) title.getParent();
titleBar.setBackgroundDrawable(gd); 
```

但日食告诉我：

> 类型视图中的方法 setBackgroundDrawable(Drawable) 已弃用

我该做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:15:51.170

Most of the time you get a deprecation warning, it comes along with the correct way of doing it. If you go to the [View class documentation](http://developer.android.com/reference/android/view/View.html), you will notice that the `setBackgroundDrawable(Drawable background)` method says:

> This method was deprecated in API level 16\. use setBackground(Drawable) instead

Depending on the android version you are targeting you might want to continue using the deprecated one.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-04T08:43:36.753

titleBar.setBackgroundDrawable(gd);

更改代码

```
int sdk = android.os.Build.VERSION.SDK_INT;
if(sdk < android.os.Build.VERSION_CODES.JELLY_BEAN) {
    setBackgroundDrawable()
} else {
    setBackground();
} 
```

# android - android.os.Binder.transact() 可以阻塞 UI

> ID：15051569
> 
> 赞同：1
> 
> 时间：2013-02-24T12:10:02.353
> 
> 标签：android, user-interface, transactions, locking

我刚刚收到了一个奇怪的 ANR 报告，看着涉及的 3 个线程，好像 transact() 方法阻塞了 UI！任何人都可以确认吗？

可能会产生误导，但 tid 23, line ~887 实际上是这种方法：

```
synchronized public void doSomething()
{
   // No sync in here, no API calls either
} 
```

为什么会这样？虚假报道？操作系统错误？应用程序错误？以后如何避免这种情况？

需要明确一点：主线程正在响应 android.app.Activity.finish() 处的后退按钮，但被 tid=21 阻止，tid=21 是一个调用 getApplicationInfo() -> transact() 的异步任务

以下是所涉及的 3 个线程的堆栈跟踪：

```
"main" prio=5 tid=1 MONITOR
| group="main" sCount=1 dsCount=0 obj=0x40aed9a0 self=0x1772cb0
| sysTid=30378 nice=0 sched=0/0 cgrp=apps handle=1074254812
| state=S schedstat=( 0 0 0 ) utm=537 stm=93 core=1
at android.app.Activity.finish(Activity.java:~4138)
- waiting to lock <0x40fa7008> (a my.app.package.activities.tm.at_process_tabs) held by tid=21 (AsyncTask #3)
at android.support.v4.app.FragmentActivity.onBackPressed(SourceFile:175)
at android.app.Activity.onKeyUp(Activity.java:2145)
at android.view.KeyEvent.dispatch(KeyEvent.java:2633)

"AsyncTask #4" prio=5 tid=23 MONITOR
| group="main" sCount=1 dsCount=0 obj=0x41364a68 self=0x1ca4ec0
| sysTid=30749 nice=-1 sched=0/0 cgrp=apps handle=28938832
| state=S schedstat=( 0 0 0 ) utm=0 stm=0 core=1
at my.app.package.activities.tm.at_process_tabs.a(SourceFile:~887)
- waiting to lock <0x40fa7008> (a my.app.package.activities.tm.at_process_tabs) held by tid=21 (AsyncTask #3)
at my.app.package.activities.tm.x.a(SourceFile:95)
at my.app.package.activities.tm.x.b(SourceFile:1)
at my.app.package.utils.android.d.call(SourceFile:203)
at java.util.concurrent.FutureTask.run(FutureTask.java:234)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
at java.lang.Thread.run(Thread.java:856)

"AsyncTask #3" prio=5 tid=21 SUSPENDED
| group="main" sCount=1 dsCount=0 obj=0x41327370 self=0x1b982a0
| sysTid=30747 nice=10 sched=0/0 cgrp=apps/bg_non_interactive handle=34484768
| state=S schedstat=( 0 0 0 ) utm=47 stm=5 core=0
at android.os.BinderProxy.transact(Native Method)
at android.content.pm.IPackageManager$Stub$Proxy.getApplicationInfo(IPackageManager.j... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T01:07:43.617

这个问题实际上很简单：一开始没看到，但它一直都在，尽管我认为它是堆栈跟踪的一部分，如果你问我很愚蠢，因为它是简单的英语：

```
waiting to lock <0x40fa7008> (a my.app.package.activities.tm.at_process_tabs) held by tid=21 (AsyncTask #3) 
```

有趣的是，用漂亮的颜色和格式在 SO 中阅读比在 ProGuard 中更容易阅读（我没有看到这个的 2 美分借口）。

at_process_tabs 是被用户终止的Activity，这个方法被tid 21和23调用：

```
synchronized public at_process_info getProcessInfo(String pid, String process_name) 
```

该方法被移动（作为一种方便的方法）到 Activity 中，因此出现了问题。

创建一个对象来锁定而不是锁定它，解决了它。

# solr - Solr Suggester 组件不返回非英语单词的命中

> ID：15051578
> 
> 赞同：1
> 
> 时间：2013-02-24T12:10:39.227
> 
> 标签：solr

我已经定义了一个这样的建议组件：

```
<searchComponent class="solr.SpellCheckComponent" name="suggest">
    <lst name="spellchecker">
        <str name="name">suggest</str>
        <str name="classname">org.apache.solr.spelling.suggest.Suggester</str>
        <str name="lookupImpl">org.apache.solr.spelling.suggest.tst.TSTLookup</str>

        <str name="field">autosuggest_general</str>
        <float name="threshold">0.005</float>
        <str name="buildOnCommit">true</str>
    </lst>
</searchComponent>
<requestHandler class="org.apache.solr.handler.component.SearchHandler" name="/suggest">
    <lst name="defaults">
        <str name="spellcheck">true</str>
        <str name="spellcheck.dictionary">suggest</str>
        <str name="spellcheck.onlymorepopular">true</str>
        <str name="spellcheck.count">5</str>
        <str name="spellcheck.collate">true</str>
    </lst>
    <arr name="components">
        <str>suggest</str>
    </arr>
</requestHandler> 
```

和`autosuggest_general`这样的字段：

```
<field name="autosuggest_general" type="autosuggest_type" indexed="true" stored="true" multiValued="true" />
<fieldType name="autosuggest_type" class="solr.TextField" positionIncrementGap="100">
    <analyzer>
        <charFilter class="solr.HTMLStripCharFilterFactory"/>
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"/>
        <filter class="solr.LowerCaseFilterFactory"/>
    </analyzer>
</fieldType> 
```

建议器组件不会返回任何非英语单词的命中。
我想自动完成单词`Marcos`

所以当我打电话时，`http://localhost:8983/solr/mycore/suggest?q=mar`我得到以下回复：

```
<response>
    <lst name="responseHeader">
        <int name="status">0</int>
        <int name="QTime">2</int>
    </lst>
    <lst name="spellcheck">
        <lst name="suggestions"/>
    </lst>
</response> 
```

常规搜索返回 10 次点击：
`http://localhost:8983/solr/mycore/select?q=autosuggest_general:marcos`

因为`de`我得到以下回复：

```
<response>
    <lst name="responseHeader">
        <int name="status">0</int>
        <int name="QTime">1</int>
    </lst>
    <lst name="spellcheck">
        <lst name="suggestions">
            <lst name="de">
                <int name="numFound">3</int>
                <int name="startOffset">0</int>
                <int name="endOffset">2</int>
                <arr name="suggestion">
                    <str>design</str>
                    <str>developer</str>
                    <str>development</str>
                </arr>
            </lst>
            <str name="collation">design</str>
        </lst>
    </lst>
</response> 
```

`design`, `developer`, and`development`都很好，但我没有得到`dejan`建议，而且这个词确实存在于`autosuggest_general`字段中。

`http://localhost:8983/solr/mycore/select?q=autosuggest_general:dejan`返回

```
<response>
    <lst name="responseHeader">
        <int name="status">0</int>
        <int name="QTime">1</int>
        <lst name="params">
            <str name="q">autosuggest_general:dejan</str>
        </lst>
    </lst>
    <result name="response" numFound="7" start="0">
    ...
    </result>
</response> 
```

我正在使用 Solr 4.1

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T16:33:41.830

这可能是一个问题：

```
<float name="threshold">0.005</float> 
```

[https://wiki.apache.org/solr/Suggester](https://wiki.apache.org/solr/Suggester)说：

`threshold - threshold is a value in [0..1] representing the minimum fraction of documents (of the total) where a term should appear, in order to be added to the lookup dictionary.`

尝试降低它，看看你是否得到匹配。

# android - 无法选择设备进行调试

> ID：15051583
> 
> 赞同：0
> 
> 时间：2013-02-24T12:11:15.127
> 
> 标签：android, debugging, ide, nexus-7

我已经在 google Nexus 7 上将我的 android 版本从 4.1.1 更新到 4.2.2，（之前完美运行）之后不幸的是我无法调试我的应用程序，我可以在“Android 设备选择器”页面上看到我的设备，但我无法选择它，并且确定按钮未激活。我的 minsdk 版本是 12，在那个页面上写着“选择与 Target android 3.1 兼容的设备”！我正在 Motodev Studio 上开发，我正在为此工作几个小时，但我不知道是什么导致了这个问题，任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T05:26:53.750

根据这个[帖子](https://stackoverflow.com/questions/15031411/after-upgrade-android-on-nexus-to-4-2-2-eclipse-shows-target-unknown-for-device)

缺少一些包，这些包没有显示在 Android SDK 管理器中，所以在 Sdk 管理器上重新加载并安装丢失的包后，我的问题已经解决了！

# mercurial - 本地提交后的差异

> ID：15051591
> 
> 赞同：1
> 
> 时间：2013-02-24T12:12:56.500
> 
> 标签：mercurial, diff, commit

我刚刚从他们的遥控器克隆了一个仓库。

我构建了软件，更改了大约 4 个文件，在本地**提交**了它们，现在想创建一个可以显示它们的补丁。

当我运行时：

```
hg diff -U8p abc efg pqr > patch_file 
```

我没有看到我所做的更改。是否`hg diff`仅将当前文件与最后提交的文件进行比较？

我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:49:17.713

1.  到`diff`针对特定修订的工作目录`REV`，使用

    ```
    hg diff -r REV 
    ```

2.  要相互比较两个修订版，请使用

    ```
    hg diff -r REV1 -r REV2 
    ```

3.  要确定要比较哪些修订，请检查`hg log`. 如果您经常这样做并且基本修订版已修复，请给它一个名称（例如*whatipulled*）

    ```
    hg tag -r REV whatipulled 
    ```

    然后，您可以指定`whatipulled`修订版本，而不是数字 rev id（或散列）。

4.  要以更丰富的格式导出您的差异，包括提交评论等，您还可以使用为此目的设计的以下内容：

    ```
    hg export -r REV 
    ```

5.  还有`hg bundle -r REV`，它会生成一个包含类似信息的二进制文件。

6.  但是，如果您要将更改发送回父 repo，最好的方法是使用`hg push`. 它将您的变更集直接传达给父级；您甚至不需要知道哪些变更集需要推送。当然，您必须有权推送到父 repo。

    ```
    hg push [ parent_repo_url ] 
    ```

    （如果您从中拉出，则 mercurial 应该已经知道路径，您可以将其排除在外）。

7.  如果父 repo 在 bitbucket 上而您没有 pu，则可以在 bitbucket 上设置自己的帐户，从本地 repo 拉/推到该帐户，然后向项目 repo 发出“拉取请求”，询问他们从你身上拉扯。

以上所有选项都有控制其行为的选项，请参阅。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T14:16:31.567

从`hg help diff`

> 如果仅指定了一个修订版，则将该修订版与工作目录进行比较

在您的 -r 差异中，您必须在差异之前使用旧提示（最新的“不是您的”变更集）并更新为提示（您的最新变更集）。

如果在您的变更集中修改了某些二进制数据，请不要忘记使用 -g 选项

`hg up & hg diff -r <CSET> -g > some.patch`

改进了任何活动变更集的差异，无需手动检测基本变更集（对于线性历史 == 在单个分支中）

`hg diff -r "parent(min(outgoing()))" -r tip`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T12:35:44.400

默认情况下，`hg diff`将当前签出的文件与上次提交进行比较。您可以通过添加选项来更改它：

*   `-r REV`将当前签出的文件与特定修订进行比较`REV`。
*   `-c REV`显示修订所做的更改`REV`

所以在你的情况下`hg diff -c 123 ...`会给你提交 123 的差异。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-24T19:24:50.557

我的猜测是这`hg outgoing`正是您想要的——它将您在本地提交的内容与默认远程服务器上的内容进行比较，并向您显示这些变更集或`-p`提交的列表。

但是，这确实会分别显示每个变更集。如果您想查看所有更改的组合，您必须这样做，`hg diff -r HERE -r THERE`或者因为`-r HERE`这是默认设置，`hg diff -r THERE`

我看到你在评论中问过“我怎么知道那里有什么”，那里*有*最后一个变更集遥控器，你可以通过`hg outgoing`. 如果`hg outgoing`显示它会发送变更集 66、67 和 68，那么您需要将`hg diff -r 65`已经存在的内容 (65) 与本地的内容 (68) 进行比较。

# php - How to find prime factors in a range in php

> ID：15051592
> 
> 赞同：0
> 
> 时间：2013-02-24T12:13:05.650
> 
> 标签：php, for-loop, logic

This is a program to find prime factors of a numbers.

Like - Prime factors for number 1125 are `3` and `5`

My Algo this goes way - (and please let me know if it is not correct)

1.  Firstly I am finding a square root of the number using `sqrt()` function to break the complexity and run time.
2.  To find prime numbers in between the range.
3.  Lastly to divide these prime numbers with the original number(yet not reached to this step as failing in the second step.

My code which is not working, let me know where exactly I am failing in my logic and code from step 2 and step 3.

**No error thrown but the code is also not outputting anything.**

```
<?php
error_reporting(E_ALL);
$number = 6006;

$sqrt_num = (int)sqrt($number);

for($i=2;$i<$sqrt_num;$i++)
{
    for($j=2;$j<=$i-1;$j++)
    {
        if($i%$j==0)
        break;
        if($i==$j) 
            echo $i;
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:15:02.923

由于我确定您是否想要一个数字的素数，或者 1 到 sqrt(number) 范围内的所有素数，所以我会给您一些我之前写的代码并展示不同的实现：

```
//Check if a number is prime
function isPrime($num, $pf = null)
{
    if(!is_array($pf)) 
    {
        for($i=2;$i<intval(sqrt($num));$i++) {
            if($num % $i==0) {
                return false;
            }
        }
        return true;
    } else {
        $pfCount = count($pf);
        for($i=0;$i<$pfCount;$i++) {
            if($num % $pf[$i] == 0) {
                return false;
            }
        }
        return true;
    }
}

//Find Prime Factors
function primeFactors($num)
{
    //Record the base
    $base = intval($num/2);
    $pf = array();
    $pn = null;
    for($i=2;$i <= $base;$i++) {
        if(isPrime($i, $pn)) {
            $pn[] = $i;
            while($num % $i == 0)
            {
                $pf[] = $i;
                $num = $num/$i;
            }
        }
    }
    return $pf;
} 
```

由此，要获得主要因素，只需使用`$myarr = primeFactors($number);`（您可以看到用于重新创建自己的逻辑。^^）

如果您想要范围内的所有素数：

```
for($i=1;$i<$sqrt_num;$i++) {
    if(isPrime($i)) {
        $myarr[] = $i;
    }
} 
```

我确实想注意`$pf`in的使用`isPrime`，因为它是一种筛子，可以减少根据已处理的素数因子找出一个数是否为素数的处理时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:19:32.990

查找素数是大多数编程语言中的常见问题。首先，看一下[number is prime](http://icdif.com/computing/2011/09/15/check-number-prime-number/)。您可以使用该[`gmp_nextprime`](http://php.net/manual/en/function.gmp-nextprime.php)功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-10T20:19:03.920

```
$namber = 1122676330;
$text = $namber.'=';
$time_start = microtime(1);

for($i=2; $i<=$namber; $i++ ){
    if($namber % $i == 0){
        $namber = $namber / $i;
        $text .= $i. '  ';
        $i--;
    }
    if($namber == 1){
            echo 'ok';
        }
}

$time_end = microtime(1);
$time = $time_end - $time_start;
echo "<br><br>$text<br><br> $time seconds\n"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-10T20:29:20.940

[您可以在PrimeModule](https://github.com/danog/PrimeModule)上使用 php 类

PHP Prime 模块能够非常快速地对大量数字进行素数分解。

链接： [https ://github.com/danog/PrimeModule](https://github.com/danog/PrimeModule)

# c# - call method in another project c#, and embedded into panel

> ID：15051595
> 
> 赞同：0
> 
> 时间：2013-02-24T12:13:23.140
> 
> 标签：c#, .net, winforms, panel

Basically I have got two projects in a same solution. Project A has a form, and on the form this is a panel. Project B's entry points is written like this:

```
namespace Demo
{    
    public static class Program
    {   
        [STAThread]
        public static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new MainForm());
        }
    }
} 
```

And my question is how do i run this project B in Project A Form's Panel? In addition Project B is a form contains a pictureBox which grabs frame from the webcam.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:18:56.753

如果Project B被编译成可执行文件，你可以看看[这个](https://stackoverflow.com/questions/1112981/how-do-i-launch-application-one-from-another-in-c)问题，它也提供了一个解决方案。提示：您正在尝试从您的 WinForms 进程运行一个新进程。

# sql - SQL 查询查找每个员工 ID 的 KPI ID 平均值

> ID：15051596
> 
> 赞同：0
> 
> 时间：2013-02-24T12:13:24.080
> 
> 标签：sql, ms-access

我希望查询语句找到每个员工 ID 的每个 KPI 的平均值

目标表：

```
-----------------------------------
ID       | KPI_ID     | Scoure    |
-----------------------------------
8543     | 5          | 1800      |
8543     | 5          | 1600      |
8543     | 3          | 80        |
9123     | 5          | 1400      |
9123     | 2          | 60        |
3789     | 1          | 40        |
8543     | 5          | 1400      |
8543     | 2          | 50        |
9123     | 5          | 1600      |
9123     | 1          | 70        |
3789     | 1          | 70        |
---------------------------------- 
```

输出表：

```
-----------------------------------
ID       | KPI_ID     | AVG_Scoure|
-----------------------------------
8543     | 5          | 1600      |
8543     | 3          | 80        |
9123     | 5          | 1500      |
9123     | 2          | 60        |
3789     | 1          | 55        |
8543     | 2          | 50        |
9123     | 1          | 70        |
---------------------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:25:06.193

仍然需要的信息是您的 DBMS，顺便说一下，您的查询应该是这样的：

```
SELECT ID, KPI_ID, Round(avg(Scoure)) AS AVG_Scoure
FROM tmpTable
GROUP BY ID, KPI_ID; 
```

有关更多信息和详细信息，请查看此 SQLFiddle [http://www.sqlfiddle.com/#!2/7e2d6/2](http://www.sqlfiddle.com/#!2/7e2d6/2)。您甚至可以更改 DBMS 并检查它是否仍然适用于您的。

# iis - IIS url rewrite Error 404.0 [edited]

> ID：15051597
> 
> 赞同：0
> 
> 时间：2013-02-24T12:13:36.617
> 
> 标签：iis, url-rewriting, web-config, webmatrix, url-rewrite-module

I want:
`domain.com/example`
to target:
`domain.com/folder/example.cshtml`

Can anyone help me with the rewrite rule for it?

Every suggestion is much appreciated :)

* * *

*I have edited the question so that it actually focuses on what is important.*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:20:54.983

你为什么不使用mod-rewrite？

```
RewriteCond %{THE_REQUEST} /folder/example.cshtml
RewriteRule ^$ /example.cshtml [R=301,L,NE]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^example.cshtml /folder/example.cshtml [L] 
```

有时你需要稍微弄乱斜线

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:40:17.193

我想它不能按照我想要的方式完成。我将不得不移动`example.cshtml`到根目录。

# objective-c - 如何在不使用 sdk 提要对话框的情况下在 facebook 上发布朋友时间轴上的大图像

> ID：15051601
> 
> 赞同：0
> 
> 时间：2013-02-24T12:14:00.627
> 
> 标签：objective-c, facebook, facebook-graph-api

我有一个应用程序，可以让用户创建一张定制的贺卡（一张大图）并将其发送给当天过生日/其他场合的 Facebook 朋友。我想让我的用户将生成的贺卡图像**发布到另一个朋友的时间轴上**。

*   自 2013 年 2 月起，不允许开发人员使用`/feed`( `stream.publish`) 在其他用户的墙上发帖，文档声明仅允许使用提要对话框（sdk 弹出窗口）。

如何允许用户在不使用 sdk 的发送对话框的情况下从 iOs 应用程序在朋友的时间轴上发布大图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T14:47:13.910

由于[`Recent Changes`](https://developers.facebook.com/roadmap/completed-changes/)Facebook Graph API 的原因，如果不使用`Feed Dialog`.

# c++ - Opengl，C ++：大量点

> ID：15051607
> 
> 赞同：0
> 
> 时间：2013-02-24T12:14:37.720
> 
> 标签：c++, opengl, vertex

我目前正在开发一个程序，该程序将能够可视化平面上沿矢量场流动的点的演变。我已经完成了我在下面粘贴的第一个版本。当运行具有大量点的程序时，似乎只有最后说的 30000 个点被绘制到窗口中。我希望能够绘制大约 1000000 点，所以我很遥远。

我已经尝试过喜欢迭代次数（迭代变量 - 控制点数），在这里它表现得很好。然而，当大幅增加它时，第一部分不再被绘制。

```
#include <iostream>
#include <stdio.h>
#include <math.h>
//#include <gsl/gsl_math.h>
//#include <gsl/gsl_sf.h>
#include <GL/freeglut.h>
#include <GL/gl.h>

using namespace std;

//Initial iterations to make the system settle:
int initIter=0;
//Iterations once system has settled:
int Iterations = 100000;
/**Starting point in time-phase-space (t,x,y,vx,vy).
For mathematical reasons the last two components should
always be 0**/
float TPS[5]={0,0.00,0.100,0.00,0.000};
//Timestep:
float dt=0.001;

/**The Step function make one Picard
iteration **/
float * Step(float * Arr){
static float NewTPS[5];
NewTPS[0] = Arr[0]+dt;
NewTPS[1] = Arr[1]+Arr[3]*dt;
NewTPS[2] = Arr[2]+Arr[4]*dt;
//This is the dynamical functions:
NewTPS[3] = -Arr[2];
NewTPS[4] = Arr[1];
return NewTPS;
}

/** This function sets up GLUT plotting
window: **/
void myInit(){
 // set the background color
 glClearColor(0.0f, 0.0f, 0.0f, 1.00f);

 // set the foreground (pen) color
  glColor4f(1.0f, 1.0f, 1.0f, 0.04f);

 // set up the viewport
  glViewport(0, 0, 800, 800);

 // set up the projection matrix (the camera)
  glMatrixMode(GL_PROJECTION);
  glLoadIdentity();
  gluOrtho2D(-2.0f, 2.0f, -2.0f, 2.0f);

 // set up the modelview matrix (the objects)
  glMatrixMode(GL_MODELVIEW);
  glLoadIdentity();

 //Computing initial iterations:
  for (int i=0;i<initIter;i++){
   //cout << TPS[1]<<" " << TPS[2] << endl;
   float * newTPS2;
   newTPS2 = Step(TPS);
   //Assigning the values of newTPS2 to TPS:
    for (int j=0; j<5;j++){
     TPS[j]=*(newTPS2+j);
 }
  }

 // enable blending
  //glEnable(GL_BLEND);
  //glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

 // enable point smoothing
  //glEnable(GL_POINT_SMOOTH);  
  //glPointSize(1.0f);
 }

/** This function draws a the point that
is passed to it: **/
 void Draw(){
 // clear the screen
  glClear(GL_COLOR_BUFFER_BIT);

 // draw some points
  glBegin(GL_POINTS);
  for (int i = 0; i <Iterations ; i++) {
   float * newTPS2;
   //cout << TPS[0]<< " " << TPS[1] << " " << TPS[2]<< endl;
    newTPS2 = Step(TPS);
    //Assigning the values of newTPS to TPS:
    for (int j=0; j<5;j++){
     TPS[j]=*(newTPS2+j);
}   
  // draw the new point
   glVertex2f(TPS[1], TPS[2]);
   }    
  glEnd();

  // swap the buffers
  glutSwapBuffers();
  //glFlush();
  }

  int main(int argc, char** argv){
  // initialize GLUT
  glutInit(&argc, argv);

  // set up our display mode for color with alpha and double buffering
  glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE);

  glutInitWindowSize(800, 800);
  glutCreateWindow("Trace of 2D-dynamics");
  myInit();
  // register our callback functions
  glutDisplayFunc(Draw);
  //  glutKeyboardFunc(mykey);

  // start the program
  glutMainLoop();
  return 0;
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T12:35:02.143

如果您只想为屏幕上的特定像素着色，则根本不应该使用`glVertex`。将它们全部放在一个连续的内存块中，从中创建一个纹理并渲染一个覆盖整个屏幕的四边形。这可能比在 OpenGL 中计算它们的位置更快。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-24T12:25:29.577

可能在您的实现中，原语的大小限制为带符号的短，即 32768 点。如果是这种情况，您必须`glEnd/glBegin`为每组 32768 点左右做：

```
for (int i = 0, x = 0; i <Iterations ; i++, x++) {
    //...
    if (x >= 32768)
    {
        x = 0;
        glEnd();
        glBegin(GL_POINTS);
    }
    //...
} 
```

顺便说一句，您可以考虑使用顶点缓冲区对象 (VBO)。此限制可能相同，但绘制速度要快得多。

# java - Roguelike 的职业系统

> ID：15051614
> 
> 赞同：0
> 
> 时间：2013-02-24T12:15:26.413
> 
> 标签：java, roguelike

什么是在 Java中实现类似于[Roguelike的竞赛系统的好方法。](http://en.wikipedia.org/wiki/Roguelike)

我一直在考虑让每个生物都成为其种族的子类，但我不确定这是做事的好方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:20:50.567

您当然不想要子类关系。我会使用[组合](http://en.wikipedia.org/wiki/Object_composition)而不是[继承](http://en.wikipedia.org/wiki/Inheritance_%28computer_science%29)。

特别是，我会上课`Race`

```
public class Race {

    public String name;

    public Race(String name) {
        this.name = name;
    }

} 
```

并确保每个生物都有一个`Race`领域。

# c# - C# Static event not fired

> ID：15051616
> 
> 赞同：-1
> 
> 时间：2013-02-24T12:15:45.423
> 
> 标签：c#, events, static, null

I am doing some kind of status reporting so I can update the new status to the UI. For e.g. the status can be - "Loading...", "Loaded..." and so on. My problem is that the StatusChanged event is always null and can't be fired.

```
public class StatusReporter
{
    public delegate void StatusChangedEventHandler(Status status);

    public static event StatusChangedEventHandler StatusChanged;

    private static Status status;

    public static Status CurrentStatus
    {
        get
        {
            return status;
        }
        set
        {
            status = value;
            OnStatusChange();
        }
    }

    private static void OnStatusChange()
    {
        if (StatusChanged != null)
        {
            StatusChanged(status);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:33:00.790

编码：

```
public class StatusReporter {
    public delegate void StatusChangedEventHandler(Status status);
    public static event StatusChangedEventHandler StatusChanged;

    public static Status CurrentStatus {
        set {
            StatusReporter.OnStatusChange(status=value);
        }

        get {
            return StatusReporter.status;
        }
    }

    static void OnStatusChange(Status status) {
        if(null!=StatusChanged)
            StatusReporter.StatusChanged(status);
    }

    static Status status;
} 
```

考试：

```
partial class Form1 {
    static void Form1_StatusChange(Status status) {
        Debug.Print("status changed");
    }

    private void button2_Click(object sender, EventArgs e) {
        StatusReporter.StatusChanged+=Form1_StatusChange;
        StatusReporter.CurrentStatus=new Status(); // assumed, you don't show the Status class
    }
} 
```

虽然我不明白为什么都是*static*。

# android - GridView children sometimes not drawing

> ID：15051619
> 
> 赞同：1
> 
> 时间：2013-02-24T12:16:19.260
> 
> 标签：android, android-gridview

I have a GridView with a custom view which basically look like buttons. The gridview starts off with no children, and everytime the user presses a button another custom view will be added.

There is some strange behaviour with this. I am drawing some things like text, lines etc on the custom view in onDraw and sometimes they are drawn at all. They are completely blank. The behaviour seems quite random in terms of which views show or don't show the drawn graphics.

I have a feeling it is to do with me setting the layoutparameters. I store the child views in an array once they are created, and in getView() I return the view relevant for the position parameter. So I only ever create buttons for each position once.

So I have two questions.

1.  What am I doing to cause this?

2.  Should I even be using a gridview for what I am doing?

The code for get view is:

```
public View getView(int position, View convertView, ViewGroup parent) 
    {
        GridButton button;
        GridView gridView = (GridView)parent;
        if(childBuittons.size() <= position) //if we need to create a new button
        {
                button = createButton(position);
                int nWidth = getButtonSize(gridView);
                GridView.LayoutParams params = new GridView.LayoutParams(nWidth, nWidth);
                button.setLayoutParams(params);
        }
        else //we already have a button that we created
        {
            button = buttons.get(position);
        }
        return button;
    } 
```

Some more information: - The gridbutton class is just a class that extends View and overrides onDraw to draw some graphics such as text and lines - What im trying to achieve is a grid of squares that the user can add or remove (although they wont do this often) and then press the squares to perform certain functions - It is possible that there will be more squares than can fit in the screen

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T15:33:12.893

> 我在做什么导致这个？

如果不提供与 GridButton 类相关的更多详细信息，没有人可以真正帮助您。最好知道您如何处理视图的测量以及您在该视图中究竟绘制了什么（以及如何）。

> 我感觉这与我设置布局参数有关。

我对此表示怀疑。为了确保您还可以在该自定义视图中绘制一个简单的颜色，并查看它是否出现在网格上。如果确实如此，`LayoutParams`则不是发生这种情况的原因。还要检查你得到什么值`nWidth`。

> 创建子视图后，我将它们存储在一个数组中，并在 getView() 中返回与位置参数相关的视图。所以我只为每个位置创建一次按钮。

这不行。使用 a 的主要原因`GridView`是您可以使用它的适配器来避免必须预先创建所有网格视图（占用内存（如果没有崩溃）并减慢您的应用程序）。您应该考虑实施特定于`GridView`/的适当回收机制`ListView`。你的`getView()`方法应该是这样的：

```
View getView(int position, View convertView, ViewGroup parent) {
    GridButton button;
    GridView gridView = (GridView)parent;
    if(convertView == null) {
            button = createButton(position);
            int nWidth = getButtonSize(gridView);
            GridView.LayoutParams params = new GridView.LayoutParams(nWidth, nWidth);
            button.setLayoutParams(params);
    } else {
        button = (GridButton) convertView;
    }
    return button;
} 
```

如果您需要访问这些按钮，请通过适配器访问它们，根据按钮的位置更改一些数据并调用`notifyDataSetChanged()`.

> 我什至应该使用 gridview 来做我正在做的事情吗？

你没有说你想做什么。如果您认为单元格的数量足够多并且预计不会看到所有单元格，请使用`GridView`. 如果您认为所有单元格都是可见的，那么您可以使用不带`GridView`.

# android - Facebook timeline like listview

> ID：15051623
> 
> 赞同：3
> 
> 时间：2013-02-24T12:16:57.923
> 
> 标签：android, facebook, listview, scrollview, horizontalscrollview

The Facebook timeline seems to display all the feeds in the listview vertically. When the user shares his/her multiple photos, then those photos are displayed in horizontal list view. Has anybody any idea, how this actually works. Because I don't think nesting a horizontal listview within vertical listview works. Nor does the horizontal listview functions smoothly within the vertical scrollbar. So, if anybody has any idea about how Facebook implements its views in timeline, do share it here.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:32:41.927

要为照片使用图库，请查看该示例： [https ://stackoverflow.com/a/11544447/944070](https://stackoverflow.com/a/11544447/944070)

您可能还需要在每个案例中实现不同的列表项，所以这个答案也会有帮助[https://stackoverflow.com/a/3515221/944070](https://stackoverflow.com/a/3515221/944070)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-23T06:38:12.730

这可以使用自定义列表视图来完成。下面的教程涵盖了使用 volley 网络库的 facebook 之类的提要视图

[Android Facebook 喜欢使用 Volley 自定义 ListView 提要](http://www.androidhive.info/2014/06/android-facebook-like-custom-listview-feed-using-volley/)

![在此处输入图像描述](../Images/a195221d0bde885dc12636d920c6f17e.png)

# python - python，加权 linspace

> ID：15051624
> 
> 赞同：3
> 
> 时间：2013-02-24T12:17:00.420
> 
> 标签：python, numpy

谁能告诉我最好的方法是生成一个包含从 0 到 100 的值的（numpy）数组，该数组由（例如）具有平均值 50 和方差 5 的正态分布函数加权。所以有更多的 50 和更少（几乎没有）零和数百。我认为这个问题不应该太难解决，但我不知何故被卡住了......

我想到了 np.linspace 的一些东西，但似乎没有重量选项。

所以要明确一点：我不想要一个从 0 到 100 的简单正态分布，而是像一个从 0 到 100 的数组，中间的值密度更高。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T12:28:21.407

您可以使用 scipy 的 stats 分布：

```
import numpy as np
from scipy import stats

# your distribution:
distribution = stats.norm(loc=50, scale=5)

# percentile point, the range for the inverse cumulative distribution function:
bounds_for_range = distribution.cdf([0, 100])

# Linspace for the inverse cdf:
pp = np.linspace(*bounds_for_range, num=1000)

x = distribution.ppf(pp)

# And just to check that it makes sense you can try:
from matplotlib import pyplot as plt
plt.hist(x)
plt.show() 
```

当然，我承认由于来回时的数值不准确，起点和终点并不完全像这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-25T10:03:19.007

重要的是要理解，您的问题并不*完全*可以解决，因为通常有限的离散样本无法准确地重现您的分布。

当您询问问题的琐碎版本时，您可以很容易地看到这一点，例如 [0,1] 中具有相等分布的一组 3 个值。这里的结果 [0,0,1] 和 [0,1,1] 都是合理的。

*但是，您可以大致*解决问题。如果您要求一个数组的`count`元素超出`[0,1,...,N]`给定概率的位置`p=[p0,p1,...,pN]`并归一化（ ），那么理论上，结果数组中的元素`p0+...+pN==1`计数是`c_k``k`

```
c[k] = p[k]*count 
```

但这些计数现在是浮点数。您必须决定一种方法来“四舍五入”它们，同时保持它们的总和。这是由于您的问题定义不足而产生的选择自由。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-02T19:29:54.710

```
>>> sorted([int(random.gauss(50,5)) for i in range(100)])
[33, 40, 40, 40, 40, 40, 42, 42, 42, 42, 43, 43, 43, 43, 44, 44, 44, 44, 44, 45, 45, 45, 46, 46, 46, 46, 46, 46, 46, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 48, 48, 48, 48, 48, 48, 48, 49, 49, 50, 50, 50, 50, 50, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 53, 53, 53, 54, 54, 54, 54, 54, 54, 54, 54, 54, 55, 55, 56, 56, 57, 57, 57, 57, 57, 57, 57, 58, 61] 
```

# iphone - 如何在调用方法之前更改 UIButton 的选定状态？

> ID：15051630
> 
> 赞同：-1
> 
> 时间：2013-02-24T12:17:21.930
> 
> 标签：iphone, ios, objective-c, uibutton

我正在从一个 uibutton 调用一个方法（在这种情况下是一个 uibuttons 数组）。问题是按钮应该`UIControlStateSelected`立即更改并为按钮显示一个新的 uiimage。它显示图像，但仅在运行该方法之后。该方法会下载一些数据并需要一两秒钟。在调用该方法并且按钮图像选择状态更改图像之前，用户显然不确定他们是否在这种情况下触摸了按钮。

这是我用于按钮选择状态的代码：

```
 [catBtn setTitle:[NSString stringWithFormat:@"Button %d", i] forState:UIControlStateNormal];
        [catBtn setImage:[UIImage imageNamed:[categoryBtnImages objectAtIndex:i]] forState:UIControlStateNormal];
        [catBtn setTitle:@"I'm selected" forState:UIControlStateSelected];

        [catBtn setImage:[UIImage imageNamed:[categoryBtnImagesSel objectAtIndex:i]] forState:UIControlStateSelected];
     //   NSLog(@"%@",[categoryBtnImagesSel objectAtIndex:i]);

        [catBtn addTarget:self action:@selector(buttonPressed:) forControlEvents:UIControlEventTouchDown];

        [catButtonArray addObject:catBtn]; 
```

感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T12:28:38.733

`IBACTION`仅给出部分代码的最佳猜测：

如果您在按钮的方法中执行同步下载，`IBACTION`这会阻止 UI 更新按钮。使用异步下载方法执行下载，以便该`IBACTION`方法可以完成并且按钮可以更新。

该`NSURLConnection`方法`sendAsynchronousRequest`是一种执行异步下载的简单方法：

```
+ (void)sendAsynchronousRequest:(NSURLRequest *)request
  queue:(NSOperationQueue *)queue
  completionHandler:(void (^)(NSURLResponse*, NSData*, NSError*))handler 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-24T12:34:32.367

接口永远不应该像那样被阻塞。想象一下用户在按下按钮时想知道发生了什么的挫败感。想象一下自己在想是否按下它。如果需要一两秒钟，它应该在主线程之外完成，这样界面就不会冻结，用户会立即知道发生了什么。

如果您尝试下载某些东西，您当然应该查看[NSURLConnection](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsurlconnection_Class/Reference/Reference.html) 文档页面，并使用该`sendAsynchronousRequest:queue:completionHandler:`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T12:29:28.470

您可以将“加载”代码移动到单独的方法中。

然后你从 action 方法中调用这个加载方法

```
[self performSelector:@selector(loadingMethod) withObject:nil afterDelay:0.0]; 
```

# asp.net-mvc-3 - 从 MVC3 导出 Excel 2003 文件

> ID：15051637
> 
> 赞同：0
> 
> 时间：2013-02-24T12:18:26.190
> 
> 标签：asp.net-mvc-3, excel, razor

我找到了一个很好的解决方案，即从 MVC3 导出 Excel 2003 文件。我使用[了这段](http://www.codeproject.com/Articles/263106/Export-Tabular-Data-in-CSV-and-Excel-Formats-Throu?fid=1656064&PageFlow=Fluid)代码，它运行良好，但仅适用于 Excel 2007 和 Excel 2010。我需要一些解决方案，使此代码也适用于 Excel 2003。我想有办法做到这一点，但我仍在寻找解决方案。在我的项目中，我已经在很多地方使用了这段代码，我真的不想完全改变它。如果有人可以帮助我，我将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T16:09:34.170

Excel 于 2007 年首次开始使用 xml 类型的电子表格。要将其转换为 Excel 2003 格式，您必须重新创建 xls 2003 二进制文件格式，如果不使用 Excel 库，这将非常困难。

有一个实用程序允许 2003 用户打开 xlsx 文件： http: [//office.microsoft.com/en-us/excel-help/open-an-office-excel-2007-workbook-in-an-earlier-版本-of-excel-HA010014107.aspx](http://office.microsoft.com/en-us/excel-help/open-an-office-excel-2007-workbook-in-an-earlier-version-of-excel-HA010014107.aspx)

这可能会在客户端对您有所帮助。

# java - Spring应用中使用Hibernate删除和更新表行的一些疑惑

> ID：15051640
> 
> 赞同：-1
> 
> 时间：2013-02-24T12:18:50.297
> 
> 标签：java, spring, hibernate, spring-mvc

我在 Spring 世界中很新，我正在尝试实现一个简单的 Hibernate DAO，但我对**删除**和**更新操作有一些疑问**

我正在使用 Spring 3.2.1 和 Hibernate 4.1.9 和 MySQL 数据库。

因此，在 MySQL 数据库中，我有一个名为**person**的表，其结构如下：

```
mysql> describe person;
+-----------+--------------+------+-----+---------+----------------+
| Field     | Type         | Null | Key | Default | Extra          |
+-----------+--------------+------+-----+---------+----------------+
| pid       | int(11)      | NO   | PRI | NULL    | auto_increment |
| firstname | varchar(255) | YES  |     | NULL    |                |
| lastname  | varchar(255) | YES  |     | NULL    |                |
+-----------+--------------+------+-----+---------+----------------+ 
```

在我的 Spring 应用程序中，我为我的 DAO 定义了以下接口，该接口定义了所需的 CRUD 操作：

```
package org.andrea.myexample.HibernateOnSpring.dao;

import java.util.List;

import org.andrea.myexample.HibernateOnSpring.entity.Person;

public interface PersonDAO {

    public void addPerson(Person p);

    public Person getById(int id);

    public List<Person> getPersonsList();

    public void delete(int id);

    public void update(Person person);

} 
```

然后我通过**PersonDAOImplement**类以这种方式实现了这个接口：

```
package org.andrea.myexample.HibernateOnSpring.dao;

import java.util.List;

import org.andrea.myexample.HibernateOnSpring.entity.Person;
import org.hibernate.Criteria;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.springframework.transaction.annotation.Transactional;

public class PersonDAOImpl implements PersonDAO {

    private SessionFactory sessionFactory;

    public void setSessionFactory(SessionFactory sessionFactory) {
        this.sessionFactory = sessionFactory;
    }

    // Metodo che inserisce un nuovo record nella tabella person
    @Transactional(readOnly = false)
    public void addPerson(Person p) {
        Session session = sessionFactory.openSession();
        session.save(p);
        session.close();
    }

    /*
     * Metodo che recupera un record, rappresentante una persona, avente uno
     * specifico id dalla tabella.
     * 
     * @param L'id univoco della persona
     */

    public Person getById(int id) {
        Session session = sessionFactory.openSession();
        try {
            return (Person) session.get(Person.class, id);
        } finally {
            session.close();
        }
    }

    /*
     * Metodo che recupera la lista di tutti le persone rappresentanti dalle
     * righe della tabella person
     */
    @SuppressWarnings("unchecked")
    public List<Person> getPersonsList() {

        Session session = sessionFactory.openSession();
        try {

            Criteria criteria = session.createCriteria(Person.class);
            return criteria.list();

        } finally {
            session.close();
        }

    }

    /*
     * Metodo che elimina dalla tabella person la riga avente uno specifico id
     * 
     * @param l'id della persona da eliminare dalla tabella person
     */
    @Transactional
    public void delete(int id) {
        Person personToDelete = getById(id);
        sessionFactory.getCurrentSession().delete(personToDelete);
        /*Session session = sessionFactory.openSession();

        try {
            Person personToDelete = getById(id);
            System.out.println("person to delete: " + personToDelete);
            session.delete(personToDelete);

        } finally {
            session.close();
        }
        */
    }

    @Transactional
    public void update(Person person){

        sessionFactory.getCurrentSession().update(person);
        /*
        Session session = sessionFactory.openSession();

        try {
            System.out.println("UPDATING");
            session.merge(person);

        } finally {
            System.out.println("CLOSE SESSION");
            session.close();
        }
        */
    }

} 
```

这个例子似乎工作正常（我已经使用包含一个主方法的主类对其进行了测试，在该主类中我执行 CRUD 方法在表中插入行，查询单行或行列表，删除一行并更新连续值）

我唯一觉得奇怪的是，要在**删除**和**更新**方法中正常工作，我必须以这种方式**从我的 sessionFactory 对象中获取当前会话**：

```
sessionFactory.getCurrentSession().delete(personToDelete);
sessionFactory.getCurrentSession().update(person); 
```

相反，当我必须**添加或查询**一行时，我必须以这种方式**打开一个新会话**：

```
Session session = sessionFactory.openSession(); 
```

为什么？

在之前的**PersonDAOImpl类中，我已经评论了****删除**和**更新**方法的旧实现，我试图打开一个新会话（就像我在 addPerson 和查询方法中所做的那样没有问题）但是这样不起作用......工作仅当我获得当前会话时才可以

为什么？DAO 对象的这个实现是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T10:07:39.493

一个好的起点是阅读编写良好的[Hibernate 关于事务的文档](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/#transactions)。明确说明`SessionFactory.openSession()`和`SessionFactory.getCurrentSession()`都可以用来获取会话实例，但是获取会话的方式不同。

与`SessionFactory.openSession()`您一起迫使 Hibernate 为您的需要打开一个新会话，这可能会导致不希望的/意外的后果。相反，如果`SessionFactory.getCurrentSession()`使用的`Session`是从当前*上下文*接收的，这可能意味着事务、请求等。

为了更好地理解它，请考虑以下示例：您有一个服务层需要从两个 DAO 对象调用方法，例如：

```
@Service
public class Service {

    @Autowired
    private FirstDao firstDao;
    @Autowired
    private SecondDao secondDao;

    @Transactional
    public void serviceMethod(int param) {
        FirstEntity firstEntity = firstDao.getFirstEntity(param);
        SecondEntity secondEntity = secondDao.updateSecondEntity(firstEntity);
    }

} 
```

你现在有两个选择：让你的每个 DAO 实现它们的方法，比如`Session session = factory.openSession();`or `Session session = factory.getCurrentSession()`。您的信念是，两个方法调用（`firstDao.getFirstEntity`和`secondDao.updateSecondEntity`）都应该使用同一个会话，因为至少在方法调用完成`firstEntity`后您处于分离状态`firstDao`（会话应该在那里关闭），您应该将其重新附加到新会话以使代码工作。

但是，当您`getCurrentSession`在两个 DAO 方法中调用时，将返回相同的会话实例（因为它是由事务管理机制预先打开的）。在这种情况下，Hibernate 文档明确指出

> *您根本不需要将 Hibernate Transaction API 与 BMT 或 CMT 一起使用，并且您可以自动传播绑定到事务的“当前”会话。*

当您通过调用在 DAO 中获取会话实例时，您的所有会话管理都会发生`Session session = factory.getCurrentSession();`，仅此而已。Hibernate 文档的另一个摘录：

> 您的应用程序代码可以通过调用 sessionFactory.getCurrentSession() 访问“当前会话”来处理请求。您将始终获得一个*Session 范围为当前数据库事务*（斜体我的）。

请注意， Spring 对服务/业务层的**声明式事务划分**，您可能需要从中调用多个使用相同`Session`对象的 DAO，该对象绑定到当前事务上下文。当标记的方法`@Transactional`被调用并提交事务时，会话打开，事务启动，方法执行时会话关闭。

当然，这并不意味着每事务会话是实现事务管理的唯一方法。还有其他概念，例如*Open session in view*、*Session-per-conversation*等。但在每种情况下，您的 DAO 都会`Session`从当前*上下文*中获取一个对象，该对象又由容器、框架或您的编写代码管理。

关于您的代码，我建议修复以下不一致之处：

*   从 DAO 层实现中删除所有`@Transactional`注释
*   仅`sessionFactory.getCurrentSession()`用于操作数据
*   寻找一个考虑事务划分的服务层：你的方法应该被我标记为`@Transactional`，这样 Spring 将为你管理会话和事务（否则在 Hibernate 文档中查找*程序化事务划分。*

相关资料：

*   [Hibernate官方文档的Transactions and Concurrency](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/#transactions)
*   [Spring会话管理中的DAO和Service层](https://stackoverflow.com/questions/2566618/dao-and-service-layer-in-spring-session-management)
*   [休眠 openSession() 与 getCurrentSession()](https://stackoverflow.com/questions/8046662/hibernate-opensession-vs-getcurrentsession)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T18:55:09.073

我会给出一些提示，但您需要深入研究源代码和文档。这里有很多概念。

对 session 进行一些操作并不意味着更改会立即推送到 db。这在很大程度上取决于您正在执行的会话和操作的刷新模式。请参阅有关此的休眠文档。刷新会话时将更改推送到 db。提交事务后，更改是持久的。

`session.flush()`如果您在注释代码中关闭之前调用它会起作用，但由于下面的解释，它是不必要的。

在上面的更新和删除代码中，当调用“getCurrentSession”时，您要么获取现有会话，要么从中获取新会话`org.springframework.orm.hibernate4.SpringJtaSessionContext`（假设您使用的是 JTA，再次挖掘代码以了解这一点）。

当创建新会话时，Hibernate 注册与事务同步。在事务完成之前，Hibernate 会得到回调。这里 Hibernate 将刷新会话。在您的情况下，弹簧通过您放置的注释划定事务。

我建议您调试从调用到“getCurrentSession”的代码，以便了解正在发生的事情。根据您的配置，您将遇到这些类/方法。

```
 org.hibernate.internal.SessionFactoryImpl.getCurrentSession()
 org.springframework.orm.hibernate4.SpringJtaSessionContext.buildOrObtainSession()
 org.hibernate.engine.transaction.synchronization.internal.RegisteredSynchronization
 org.hibernate.engine.transaction.synchronization.internal.SynchronizationCallbackCoordinatorImpl.beforeCompletion() 
```

# mongodb - mongodb中只能通过map reduce而不是聚合框架来完成的例子？

> ID：15051644
> 
> 赞同：0
> 
> 时间：2013-02-24T12:19:22.420
> 
> 标签：mongodb, mapreduce, aggregation-framework

我想了解一些与 Mongo DB 相关的示例或场景，这些示例或场景可以通过 map-reduce 而不是聚合框架来完成？

Map-reduce 被认为是聚合数据的非常强大的工具/机制。那么你们中的一些人能否分享一些 map-reduce 不可能做到的场景？

谢谢和最好的问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T12:44:28.703

在 MongoDB 中，当前聚合框架限制为 16MB 的返回结果。

MapReduce 可以将其输出写入集合，并且没有大小限制。

MapReduce 可以对整个文档进行分组，聚合框架在字段级别工作。MapReduce 可以将键映射到值，并将值映射到键，这是任何其他方式都无法做到的。MapReduce 还可以调用/使用各种 JavaScript 内置函数，其中聚合仅限于其框架内置的函数和表达式。

# css - Textarea 宽度不起作用，但偏移量起作用

> ID：15051647
> 
> 赞同：1
> 
> 时间：2013-02-24T12:19:58.047
> 
> 标签：css, twitter-bootstrap, textarea

[这是我的代码（请参见此处](http://jsfiddle.net/EK64U/)的小提琴）：

```
<div class='container'>
    <div class='row'>
        <div class='offset1 span5'>
            <textarea rows='3'></textarea>
        </div>
    </div>
</div>
<div class='container'>
    <div class='row'>
        <div class='offset1 span1'>
            <textarea rows='3'></textarea>
        </div>
    </div>
</div> 
```

我希望两个`textarea`s 具有不同的宽度，但它们具有相同的宽度。如何控制Bootstrap for s 的功能`offset`和功能？`span``textarea`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:49:11.333

有两种方法可以做到 -Jsfiddle 为你[Jsfiddle](http://jsfiddle.net/shail/EK64U/4/)

方法一：块级类的使用，比如

```
<textarea class="input-xxlarge" rows='3'></textarea>
<textarea class="input-large" rows='3'></textarea>
<textarea class="input-mini" rows='3'></textarea> 
```

方法2：网格级别调整大小，喜欢

```
<textarea class="span12" rows='3'></textarea>
<textarea class="span6" rows='3'></textarea> 
```

您可以根据自己的喜好指定任何跨度大小。

对于您的代码，您可以使用：

```
<div class='container'>
<div class='row'>
    <div class='offset1 span5'>
        <textarea class="input-large" rows='3'></textarea>
      </div>
    </div>
  </div>
  <div class='container'>
      <div class='row'>
    <div class='offset1 span1'>
        <textarea class="input-mini" rows='3'></textarea>

    </div>
    </div>
 </div> 
```

# command-line - 是否可以将命令提示符移动到屏幕上的某个位置？

> ID：15051649
> 
> 赞同：1
> 
> 时间：2013-02-24T12:20:10.330
> 
> 标签：command-line, batch-file, cmd, move

正如标题所说，有可能吗？为了找到它，我已经在整个互联网上进行了搜索，但是无论我想出什么样的搜索查询变体，我最终都会得到关于用于移动文件/文件夹的移动命令的结果，而不是实际的迅速的。

做的时候

```
mode /? 
```

我可以远程与提示的外观相关的唯一结果是显示模式，

`(mode con:cols=x lines=y)`

正如我所说，我找不到任何有关此的文档并且我非常好奇，可以做到吗？我知道它可以在 Visual Studio 中完成以设置它应该显示它的对话框的位置，所以我假设它可以完成......

PS：如果可以的话，在使用这些尺寸设置时，我应该使用什么值让它完全居中？

```
mode con:cols=50 lines=15 
```

先感谢您。

约里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:32:11.773

您不能直接从批处理文件中执行此操作。但是，您可以编写一个小程序来执行此操作。相关的 Windows API 函数是[MoveWindow](http://msdn.microsoft.com/library/windows/desktop/ms633534%28v=vs.85%29.aspx)。

# android - 即使应用程序关闭，如何向特定人员发送通知？

> ID：15051650
> 
> 赞同：0
> 
> 时间：2013-02-24T12:20:15.433
> 
> 标签：android, service

我想制作一个应用程序，如果有人单击该按钮，即使该应用程序关闭，半径 100 米内的每个人都会收到通知，当然这些人拥有该应用程序。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:22:44.190

您可以通过结合使用 Location Listeners 和 Google Cloud Messaging for Android 来实现这一点

[您可以在此处](http://developer.android.com/google/gcm/index.html)阅读有关 GCM的更多信息

# matlab - Matlab优化工具箱中的多重等式约束

> ID：15051651
> 
> 赞同：0
> 
> 时间：2013-02-24T12:20:18.507
> 
> 标签：matlab, mathematical-optimization, quadprog

如果这听起来像一个新手问题，我很抱歉！我对 Matlab 和优化工具箱都是全新的！

我有一个使用 quadprog 的优化问题，我的问题中有两个等式约束。使用一般公式：

`x = quadprog(H,f,A,b,Aeq,beq,lb,ub,x0,options)`

但在这里我只能将 Aeq 和 beq 作为等式约束！A 和 b 是不等式约束...

是否有可能为等式约束设置类似集合？即在 Aeq 和 beq 中以集合或其他形式具有多个相等变量？我一直在寻找和尝试一段时间，但没有运气！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T14:11:57.137

等式约束以矩阵形式给出`Aeq*x==beq`。因此，每一行都`Aeq`可以定义一个单独的方程。例如，如果您有三个未知数，并且您希望前两个的和等于 2，并且后两个的差 ( `x(3)-x(2)`) 等于 3，您可以写

```
Aeq = [1 1 0; 0 -1 1];
beq = [2;3]; 
```

# php - 将 PDF/.doc 文件转换为 HTML 的脚本

> ID：15051654
> 
> 赞同：2
> 
> 时间：2013-02-24T12:20:29.100
> 
> 标签：php, asp.net, pdf, file-conversion

我们运营一个网站，人们可以上传 PDF/doc 文件并共享它们（它是一个学术文献摘要网站）。

我们想创建一个预览功能，这样人们就可以在下载之前查看文件的外观。我们目前使用 Google Docs 小部件，但这些小部件的内容位于 iFrame 中，因此被 Google 忽略。

**问题：**是否有类似 PHP 脚本（或任何其他脚本语言）可以将 PDF/doc 转换为 HTML 的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:23:56.980

安装并使用 abiword，如下所示：

AbiWord --to=html archivo.doc

您可以从 php.ini 调用此命令。

# android - 将图片设置为 RemoteViews

> ID：15051655
> 
> 赞同：4
> 
> 时间：2013-02-24T12:20:39.010
> 
> 标签：android, svg, bitmap, imageview, drawable

我的资产文件夹中有一些 SVG，我需要在我的小部件（在 ImageView 上）中动态设置它们。

我正在使用这个库：[http ://code.google.com/p/svg-android/](http://code.google.com/p/svg-android/)

这个库返回一个 Picture 或 PictureDrawable。

我可以看到在 RemoteViews 上使用的唯一方法是 setImageViewBitmap，它显然需要一个位图。

我尝试寻找将 Drawable 转换为 Bitmap 的代码，如下所示：

```
PictureDrawable pictureDrawable = svg.createPictureDrawable();
Bitmap bitmap = Bitmap.createBitmap(pictureDrawable.getIntrinsicWidth(), pictureDrawable.getIntrinsicHeight(), Config.ARGB_8888); 
Canvas canvas = new Canvas(bitmap); 
canvas.drawPicture(pictureDrawable.getPicture()); 
currentBitmap = bitmap; 
```

但是位图太小了。当我在 Illustrator 中创建位图时，我将画板大小设置为 65，这是内在宽度/高度上的值。

我的小部件可以调整大小，因此 ImageView 大小是可变的。即使我将宽度和高度静态设置为像这样的大数字......

```
 Bitmap bitmap = Bitmap.createBitmap(300, 300, Config.ARGB_8888); 
```

然后生成的位图在一个小图像的下方和右侧只有一堆空白。

我想我需要以某种方式以放大的值绘制图片以及创建大小为 300 的位图。理想情况下，我可以在运行时计算出 ImageView 的大小并设置适当大小的位图（如果我知道的话）。这是最好的方法吗？我该怎么做？也许有更好的方法我什至不知道？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T15:34:25.660

我没有使用过`android-svg`，但如果它使用 vanilla `PictureDrawable`s，那么它应该只是不使用内在界限的问题。

尝试以下操作：

```
PictureDrawable pictureDrawable = svg.createPictureDrawable();
Bitmap bitmap = Bitmap.createBitmap(300, 300, Config.ARGB_8888); 
Canvas canvas = new Canvas(bitmap); 
pictureDrawable.setBounds(0, 0, bitmap.getWidth(), bitmap.getHeight());
pictureDrawable.draw(canvas); // do not access the Picture directly, that defeats the purpose
currentBitmap = bitmap; 
```

简而言之，使用 Drawable 而不是它的 Picture 并将 Drawable 的边界设置为整个画布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T14:54:26.873

您是否尝试过 createScaledBitmap？

[createScaledBitmap()](http://developer.android.com/reference/android/graphics/Bitmap.html#createScaledBitmap%28android.graphics.Bitmap,%20int,%20int,%20boolean%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T07:58:40.057

我已经尝试过`svg-android`，但出于这个原因，它对我没有用。更不用说其严重受限的功能集了。

使用矢量图形的目的是我可以生成任何合适大小的图像以适应 UI 视图大小。这意味着生成方法必须在运行时接受大小要求，而不是总是使用标签`width`中`height`声明的。`<svg>`

因此，我[使用](https://bitbucket.org/zedvoid/indico/src)了本机实现：[`libsvg-android`](https://launchpad.net/libsvg-android)，正是这样做的。

它直接呈现给给定大小的画布：

```
long objId = SvgRaster.svgAndroidCreate();
SvgRaster.svgAndroidParseBuffer(objId, readString(mInputStream, "UTF-8"));
SvgRaster.svgAndroidSetAntialiasing(objId, true);
SvgRaster.svgAndroidRenderToArea(objId, mCanvas, 0, 0, mWidth, mHeight); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-17T09:10:23.593

我最终将基础画板大小修改为 300。放大方法都不起作用。所以我使用的最终代码是我最初发布的代码：

```
PictureDrawable pictureDrawable = svg.createPictureDrawable();
Bitmap bitmap = Bitmap.createBitmap(pictureDrawable.getIntrinsicWidth(), pictureDrawable.getIntrinsicHeight(), Config.ARGB_8888); 
Canvas canvas = new Canvas(bitmap); 
canvas.drawPicture(pictureDrawable.getPicture()); 
currentBitmap = bitmap; 
```

一旦我有了一个 300x300 位图，我就可以使用 setImageViewBitmap 将它设置到 RemoteViews 中。

这种首先破坏了使用 SVG 的目的（至少就在小部件中使用它们而言）。

我的问题与 User117 不同。也许他没有按照图书馆的要求将外层命名为“边界”。无论哪种方式，我都设法让库正常工作，尽管必须修改 SVG 画板大小。

希望随着屏幕分辨率的提高，Android 将很快将 SVG 作为平台的一部分引入。

# c# - 物理磁盘大小不正确 (IoCtlDiskGetDriveGeometry)

> ID：15051660
> 
> 赞同：6
> 
> 时间：2013-02-24T12:21:13.293
> 
> 标签：c#, size, disk, ioctl, deviceiocontrol

我使用下面的代码获取**物理磁盘大小**，但返回的大小不正确。我用其他工具检查过尺寸。

下面的代码报告

> 总磁盘空间：**8.249.955.840 字节**

它应该是

> 总磁盘空间：**8.254.390.272 字节**

**如何检索实际/正确的物理磁盘大小？**在 USB 驱动器和普通硬盘驱动器上测试。代码比较长，这里分开展示。

结构：

```
[StructLayout(LayoutKind.Sequential)]
internal struct DiskGeometry {
    public long Cylinders;
    public int MediaType;
    public int TracksPerCylinder;
    public int SectorsPerTrack;
    public int BytesPerSector;
} 
```

本机方法：

```
internal static class NativeMethods {
    [DllImport("Kernel32.dll", SetLastError=true, CharSet=CharSet.Auto)]
    public static extern SafeFileHandle CreateFile(
        string fileName,
        uint fileAccess,
        uint fileShare,
        IntPtr securityAttributes,
        uint creationDisposition,
        uint flags,
        IntPtr template
        );

    [DllImport("Kernel32.dll", SetLastError=false, CharSet=CharSet.Auto)]
    public static extern int DeviceIoControl(
        SafeFileHandle device,
        uint controlCode,
        IntPtr inBuffer,
        uint inBufferSize,
        IntPtr outBuffer,
        uint outBufferSize,
        ref uint bytesReturned,
        IntPtr overlapped
        );

    internal const uint FileAccessGenericRead=0x80000000;
    internal const uint FileShareWrite=0x2;
    internal const uint FileShareRead=0x1;
    internal const uint CreationDispositionOpenExisting=0x3;
    internal const uint IoCtlDiskGetDriveGeometry=0x70000;
} 
```

主要条目：

```
internal const uint IoCtlDiskGetDriveGeometry=0x70000;

public static void Main() {
    SafeFileHandle diskHandle=
        NativeMethods.CreateFile(
            @"\\.\PhysicalDrive0",
            NativeMethods.FileAccessGenericRead,
            NativeMethods.FileShareWrite|NativeMethods.FileShareRead,
            IntPtr.Zero,
            NativeMethods.CreationDispositionOpenExisting,
            0,
            IntPtr.Zero
            );

    if(diskHandle.IsInvalid) {
        Console.WriteLine("CreateFile failed with error: {0}", Marshal.GetLastWin32Error());
        return;
    }

    int geometrySize=Marshal.SizeOf(typeof(DiskGeometry));
    Console.WriteLine("geometry size = {0}", geometrySize);

    IntPtr geometryBlob=Marshal.AllocHGlobal(geometrySize);
    uint numBytesRead=0;

    if(
        0==NativeMethods.DeviceIoControl(
            diskHandle,
            NativeMethods.IoCtlDiskGetDriveGeometry,
            IntPtr.Zero,
            0,
            geometryBlob,
            (uint)geometrySize,
            ref numBytesRead,
            IntPtr.Zero
            )
        ) {
        Console.WriteLine(
            "DeviceIoControl failed with error: {0}",
            Marshal.GetLastWin32Error()
            );

        return;
    }

    Console.WriteLine("Bytes read = {0}", numBytesRead);

    DiskGeometry geometry=(DiskGeometry)Marshal.PtrToStructure(geometryBlob, typeof(DiskGeometry));
    Marshal.FreeHGlobal(geometryBlob);

    long bytesPerCylinder=(long)geometry.TracksPerCylinder*(long)geometry.SectorsPerTrack*(long)geometry.BytesPerSector;
    long totalSize=geometry.Cylinders*bytesPerCylinder;

    Console.WriteLine("Media Type:           {0}", geometry.MediaType);
    Console.WriteLine("Cylinders:            {0}", geometry.Cylinders);
    Console.WriteLine("Tracks per Cylinder:  {0}", geometry.TracksPerCylinder);
    Console.WriteLine("Sectors per Track:    {0}", geometry.SectorsPerTrack);
    Console.WriteLine("Bytes per Sector:     {0}", geometry.BytesPerSector);
    Console.WriteLine("Bytes per Cylinder:   {0}", bytesPerCylinder);
    Console.WriteLine("Total disk space:     {0}", totalSize);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-25T18:15:07.800

在做了一些研究之后`DeviceIocontrol`，我大部分时间都花在了设计上。这里我分两部分发布代码，为了清楚起见，用命名空间和部分类分开，你可以合并它们但**不能单独使用它们**。

```
namespace DiskManagement {
    using Microsoft.Win32.SafeHandles;

    using LPSECURITY_ATTRIBUTES=IntPtr;
    using LPOVERLAPPED=IntPtr;
    using LPVOID=IntPtr;
    using HANDLE=IntPtr;

    using LARGE_INTEGER=Int64;
    using DWORD=UInt32;
    using LPCTSTR=String;

    public static partial class IoCtl /* methods */ {
        [DllImport("kernel32.dll", SetLastError=true)]
        static extern SafeFileHandle CreateFile(
            LPCTSTR lpFileName,
            DWORD dwDesiredAccess,
            DWORD dwShareMode,
            LPSECURITY_ATTRIBUTES lpSecurityAttributes,
            DWORD dwCreationDisposition,
            DWORD dwFlagsAndAttributes,
            HANDLE hTemplateFile
            );

        [DllImport("kernel32.dll", SetLastError=true)]
        static extern DWORD DeviceIoControl(
            SafeFileHandle hDevice,
            DWORD dwIoControlCode,
            LPVOID lpInBuffer,
            DWORD nInBufferSize,
            LPVOID lpOutBuffer,
            int nOutBufferSize,
            ref DWORD lpBytesReturned,
            LPOVERLAPPED lpOverlapped
            );

        static DWORD CTL_CODE(DWORD DeviceType, DWORD Function, DWORD Method, DWORD Access) {
            return (((DeviceType)<<16)|((Access)<<14)|((Function)<<2)|(Method));
        }

        public static void Execute<T>(
            ref T x,
            DWORD dwIoControlCode,
            LPCTSTR lpFileName,
            DWORD dwDesiredAccess=GENERIC_READ,
            DWORD dwShareMode=FILE_SHARE_WRITE|FILE_SHARE_READ,
            LPSECURITY_ATTRIBUTES lpSecurityAttributes=default(LPSECURITY_ATTRIBUTES),
            DWORD dwCreationDisposition=OPEN_EXISTING,
            DWORD dwFlagsAndAttributes=0,
            HANDLE hTemplateFile=default(IntPtr)
            ) {
            using(
                var hDevice=
                    CreateFile(
                        lpFileName,
                        dwDesiredAccess, dwShareMode,
                        lpSecurityAttributes,
                        dwCreationDisposition, dwFlagsAndAttributes,
                        hTemplateFile
                        )
                ) {
                if(null==hDevice||hDevice.IsInvalid)
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                var nOutBufferSize=Marshal.SizeOf(typeof(T));
                var lpOutBuffer=Marshal.AllocHGlobal(nOutBufferSize);
                var lpBytesReturned=default(DWORD);
                var NULL=IntPtr.Zero;

                var result=
                    DeviceIoControl(
                        hDevice, dwIoControlCode,
                        NULL, 0,
                        lpOutBuffer, nOutBufferSize,
                        ref lpBytesReturned, NULL
                        );

                if(0==result)
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                x=(T)Marshal.PtrToStructure(lpOutBuffer, typeof(T));
                Marshal.FreeHGlobal(lpOutBuffer);
            }
        }
    }

    public enum MEDIA_TYPE: int {
        Unknown=0,
        F5_1Pt2_512=1,
        F3_1Pt44_512=2,
        F3_2Pt88_512=3,
        F3_20Pt8_512=4,
        F3_720_512=5,
        F5_360_512=6,
        F5_320_512=7,
        F5_320_1024=8,
        F5_180_512=9,
        F5_160_512=10,
        RemovableMedia=11,
        FixedMedia=12,
        F3_120M_512=13,
        F3_640_512=14,
        F5_640_512=15,
        F5_720_512=16,
        F3_1Pt2_512=17,
        F3_1Pt23_1024=18,
        F5_1Pt23_1024=19,
        F3_128Mb_512=20,
        F3_230Mb_512=21,
        F8_256_128=22,
        F3_200Mb_512=23,
        F3_240M_512=24,
        F3_32M_512=25
    }

    partial class DiskGeometry /* structures */ {
        [StructLayout(LayoutKind.Sequential)]
        struct DISK_GEOMETRY {
            internal LARGE_INTEGER Cylinders;
            internal MEDIA_TYPE MediaType;
            internal DWORD TracksPerCylinder;
            internal DWORD SectorsPerTrack;
            internal DWORD BytesPerSector;
        }

        [StructLayout(LayoutKind.Sequential)]
        struct DISK_GEOMETRY_EX {
            internal DISK_GEOMETRY Geometry;
            internal LARGE_INTEGER DiskSize;

            [MarshalAs(UnmanagedType.ByValArray, SizeConst=1)]
            internal byte[] Data;
        }
    }

    partial class DiskGeometry /* properties and fields */ {
        public MEDIA_TYPE MediaType {
            get {
                return m_Geometry.MediaType;
            }
        }

        public String MediaTypeName {
            get {
                return Enum.GetName(typeof(MEDIA_TYPE), this.MediaType);
            }
        }

        public override long Cylinder {
            get {
                return m_Geometry.Cylinders;
            }
        }

        public override uint Head {
            get {
                return m_Geometry.TracksPerCylinder;
            }
        }

        public override uint Sector {
            get {
                return m_Geometry.SectorsPerTrack;
            }
        }

        public DWORD BytesPerSector {
            get {
                return m_Geometry.BytesPerSector;
            }
        }

        public long DiskSize {
            get {
                return m_DiskSize;
            }
        }

        public long MaximumLinearAddress {
            get {
                return m_MaximumLinearAddress;
            }
        }

        public CubicAddress MaximumCubicAddress {
            get {
                return m_MaximumCubicAddress;
            }
        }

        public DWORD BytesPerCylinder {
            get {
                return m_BytesPerCylinder;
            }
        }

        CubicAddress m_MaximumCubicAddress;
        long m_MaximumLinearAddress;
        DWORD m_BytesPerCylinder;
        LARGE_INTEGER m_DiskSize;
        DISK_GEOMETRY m_Geometry;
    }
} 
```

首先，我使用[`using`alias 指令](http://msdn.microsoft.com/en-us/library/sf0df423.aspx)使代码的本机调用更像是在 C/C++ 中。第一部分的重点是`IoCtl.Execute`方法。它是一个泛型方法，类型取决于传递的**第一个参数**。它隐藏了用`P/Invoke`方法编组结构和指针的复杂性。第二个参数是将传递给的所需控制代码`DeviceIoControl`。从第三个到最后一个参数与 完全相同`CreateFile`，并且都有默认值，它们是**可选**的。

以下是代码的下一部分，可能还有更多需要提及的内容。

```
namespace DiskManagement {
    using Microsoft.Win32.SafeHandles;

    using LPSECURITY_ATTRIBUTES=IntPtr;
    using LPOVERLAPPED=IntPtr;
    using LPVOID=IntPtr;
    using HANDLE=IntPtr;

    using LARGE_INTEGER=Int64;
    using DWORD=UInt32;
    using LPCTSTR=String;

    partial class IoCtl /* constants */ {
        public const DWORD
            DISK_BASE=0x00000007,
            METHOD_BUFFERED=0,
            FILE_ANY_ACCESS=0;

        public const DWORD
            GENERIC_READ=0x80000000,
            FILE_SHARE_WRITE=0x2,
            FILE_SHARE_READ=0x1,
            OPEN_EXISTING=0x3;

        public static readonly DWORD DISK_GET_DRIVE_GEOMETRY_EX=
            IoCtl.CTL_CODE(DISK_BASE, 0x0028, METHOD_BUFFERED, FILE_ANY_ACCESS);

        public static readonly DWORD DISK_GET_DRIVE_GEOMETRY=
            IoCtl.CTL_CODE(DISK_BASE, 0, METHOD_BUFFERED, FILE_ANY_ACCESS);
    }

    public partial class CubicAddress {
        public static CubicAddress Transform(long linearAddress, CubicAddress geometry) {
            var cubicAddress=new CubicAddress();
            var sectorsPerCylinder=geometry.Sector*geometry.Head;
            long remainder;
            cubicAddress.Cylinder=Math.DivRem(linearAddress, sectorsPerCylinder, out remainder);
            cubicAddress.Head=(uint)Math.DivRem(remainder, geometry.Sector, out remainder);
            cubicAddress.Sector=1+(uint)remainder;
            return cubicAddress;
        }

        public virtual long Cylinder {
            get;
            set;
        }

        public virtual uint Head {
            get;
            set;
        }

        public virtual uint Sector {
            get;
            set;
        }
    }

    public partial class DiskGeometry: CubicAddress {
        internal static void ThrowIfDiskSizeOutOfIntegrity(long remainder) {
            if(0!=remainder) {
                var message="DiskSize is not an integral multiple of a sector size";
                throw new ArithmeticException(message);
            }
        }

        public static DiskGeometry FromDevice(String deviceName) {
            return new DiskGeometry(deviceName);
        }

        DiskGeometry(String deviceName) {
            var x=new DISK_GEOMETRY_EX();
            IoCtl.Execute(ref x, IoCtl.DISK_GET_DRIVE_GEOMETRY_EX, deviceName);
            m_DiskSize=x.DiskSize;
            m_Geometry=x.Geometry;

            long remainder;
            m_MaximumLinearAddress=Math.DivRem(DiskSize, BytesPerSector, out remainder)-1;
            ThrowIfDiskSizeOutOfIntegrity(remainder);

            m_BytesPerCylinder=BytesPerSector*Sector*Head;
            m_MaximumCubicAddress=DiskGeometry.Transform(m_MaximumLinearAddress, this);
        }
    }
} 
```

最初是 C/C++ 代码中的`IoCtl.CTL_CODE`宏，但 c# 没有宏，因此我将声明更改`DISK_GET_DRIVE_GEOMETRY_EX`为`static readonly`值，视为**运行时常量**。一些常量的前缀如`IOCTL_`被删除，因为有类名来限定它们。这部分最大的一点是类`CubicAddress`，它是新定义的类的基础`DiskGeometry`。您可能想知道为什么甚至更多想知道。

该类`CubicAddress`实际上是一个简单的类，用于存储`CHS address`物理磁盘并提供一种将地址从`LBA`格式转换的方法，我将其命名为`Transform`. 尽管我从未听说有人将其命名`CHS`为立方体，但我认为几何/体积之类的术语在数学中具有相同的用法，并且围绕物理磁盘。

`CHS`很可能，`(x ,y, z)`或`(R, G, B)`任何其他可以以立方方式对其建模的事物。它们可能有一个用于寻址的**坐标**，它也可以用来描述几何图形，比如一个*向量*。因此，该类`CubicAddress`有两种用法：

*   提供扇区地址
*   描述几何

*`CHS`/`LBA`转换*是线性变换/组合，我只写了`Transform`for `LBA`to `CHS`。的参数`geometry`是`Transform`用于转换的几何图形，它是必需的，因为***线性地址可以转换为具有不同几何图形的不同坐标***。

关于命名，表示like的词`SectorsPerTrack`应该是like的**复数**形式`Sectors`。但是，由于 的双重用法`CubicAddress`，我宁愿使用单数形式。

最后，这是测试类

```
public partial class TestClass {
    public static void TestMethod() {
        var diskGeometry=DiskGeometry.FromDevice(@"\\.\PhysicalDrive3");
        var cubicAddress=diskGeometry.MaximumCubicAddress;

        Console.WriteLine("            media type: {0}", diskGeometry.MediaTypeName);
        Console.WriteLine();

        Console.WriteLine("maximum linear address: {0}", diskGeometry.MaximumLinearAddress);
        Console.WriteLine("  last cylinder number: {0}", cubicAddress.Cylinder);
        Console.WriteLine("      last head number: {0}", cubicAddress.Head);
        Console.WriteLine("    last sector number: {0}", cubicAddress.Sector);
        Console.WriteLine();

        Console.WriteLine("             cylinders: {0}", diskGeometry.Cylinder);
        Console.WriteLine("   tracks per cylinder: {0}", diskGeometry.Head);
        Console.WriteLine("     sectors per track: {0}", diskGeometry.Sector);
        Console.WriteLine();

        Console.WriteLine("      bytes per sector: {0}", diskGeometry.BytesPerSector);
        Console.WriteLine("    bytes per cylinder: {0}", diskGeometry.BytesPerCylinder);
        Console.WriteLine("      total disk space: {0}", diskGeometry.DiskSize);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T13:27:25.313

***您的代码以错误的方式计算它***。关于物理到逻辑扇区数计算的描述，看看维基百科上的文章

*   [逻辑块寻址](http://en.wikipedia.org/wiki/Logical_block_addressing)

以下是在线双向转换脚本

*   [CHS/LBA 转换](http://homepage2.nifty.com/cars/misc/chs2lba.html)

根据您的帖子，最后一个物理扇区将在

> chs(1003, 137, 30) = ((1003 * 255) + 137) * 63 + 30 - 1 = lba(16121855)

尺寸是

> 总扇区 = 1+16121855 = 16121856 个扇区
> 
> 16121856 * 每个扇区 512 字节 = 8254390272 字节

由于您指定它**应该是** `8,254,390,272`，我根据该大小计算最后一个物理扇区。

255*63 仅用于**对齐**，称为**圆柱边界**。通常，物理最后一个扇区**不是**在边界结束，但由于不访问**不存在**的扇区，它应该**大于**

> [柱面总数] * [每柱面的磁道（也包括磁头）] * [每磁道的扇区数]

例如，如果您的物理最后一个扇区是上面的计算值，那么只需**忽略 1002 旁边的柱面**，并使用最大扇区`chs(1002, 255, 63)`作为逻辑最后一个扇区是安全的。

要获取物理磁盘大小，您可以`DeviceIoControl`使用控制代码调用`IOCTL_DISK_GET_DRIVE_GEOMETRY_EX`。这是MSDN上的参考

*   [IOCTL_DISK_GET_DRIVE_GEOMETRY_EX 控制代码 (Windows)](http://msdn.microsoft.com/zh-tw/library/windows/desktop/aa365171.aspx)

# facebook - Facebook XMPP 聊天服务器是否实现消息归档？(XEP-0136)

> ID：15051661
> 
> 赞同：1
> 
> 时间：2013-02-24T12:21:18.303
> 
> 标签：facebook, xmpp

我正在使用 Facebook 的 XMPP 聊天服务，我需要从服务器获取旧消息。我可以在客户端上使用 XEP-0136 来做到这一点，还是有另一种更常用的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T11:18:40.627

刚刚发现自己 Facebook 没有实现该功能。我收到了这个发送智商的回复：

```
<iq xmlns='jabber:client' from='chat.facebook.com' to='my.facebook.username@chat.facebook.com/Mac-Pro-di-Michele_65563c5f_4D689E59FB8A5' type='error' id='pref1'>
  <pref xmlns='urn:xmpp:archive'/>
  <error code='501' type='cancel'>
    <feature-not-implemented xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/>
  </error>
</iq> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T10:27:59.390

没有办法知道，而且很可能它不支持，因为 facebook 不兼容 xmpp。大多数 xmpp 服务器不支持此功能。

# ios - iOS 推荐的纵向和横向界面处理方式

> ID：15051662
> 
> 赞同：3
> 
> 时间：2013-02-24T12:21:18.417
> 
> 标签：ios, uiinterfaceorientation, layoutsubviews

我正在开发一个 iPad 应用程序，并希望同时支持纵向和横向。

目前，我看到了三种处理方向的方法：

1) Apple 建议使用两个视图控制器 ( [http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/RespondingtoDeviceOrientationChanges/RespondingtoDeviceOrientationChanges.html](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/RespondingtoDeviceOrientationChanges/RespondingtoDeviceOrientationChanges.html) )

2) 我的 iPhone Dev 入门书使用带有多个 UIView 的单个 xib 文件（一个用于纵向，一个用于横向），在 willAnimateRotationToInterfaceOrientation() 方法中交换视图。

3）其他人说“正确”的方法是使用 layoutSubviews 和自动调整掩码。

以前，当我构建一个应用程序时，我会纯粹用代码编写整个应用程序，包括界面设置和布局。结果是我最终得到了大量且非常痛苦的界面代码调整。

现在，在用纯代码编写了许多应用程序之后，我有点理解为什么会有 Interface Builder - 为了帮助管理界面等等，理想情况下，视图控制器应该只用于管理数据并将其发送到视图，而不是管理如何意见应该看。

使用 Interface Builder，拥有两个单独的自定义 UIView 是有意义的，一个用于纵向，一个用于横向，但我被告知 layoutSubview 是更好的选择。

但是如果我要使用 layoutSubview，那意味着我必须回到使用代码来编写和管理我的界面，这对我来说似乎不合适。

使用 layoutSubviews() 真的可行吗？

我真的看不出它比其他方法有什么好处。有人说 layoutSubviews 允许你动画到另一个方向的过渡。

当设备旋转时，我的两个界面不是简单的调整大小按钮或文本宽度。我在文本字段旁边有相邻的滑块，当旋转到横向时应该垂直堆叠，而其他滑块需要移动到屏幕的另一侧等。

## 编辑

可能是重复的问题：

[处理 iPhone 方向横向/纵向](https://stackoverflow.com/questions/12062506/handle-iphone-orientation-landscape-portrait)

[iPad/iPhone 多方向最佳实践？](https://stackoverflow.com/questions/4253623/ipad-iphone-multiple-orientations-best-practice)

如果需要，版主可以关闭。

# sql - 为什么在 SQL Server 2008 中 column_a += @value 不等于 column_a = column_a + @value？

> ID：15051663
> 
> 赞同：0
> 
> 时间：2013-02-24T12:21:20.207
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2008-r2

我编写了一个存储过程来更新表中的数据。它看起来像这样：

```
UPDATE dbo.sample
SET column_a += @value
WHERE id = @id 
```

我发现它没有先更新总和。结果类似于以下命令：

```
UPDATE dbo.sample
SET column_a = @value
WHERE id = @id 
```

我必须使用`SET column_a = column_a + @value`它才能正确更新。我想知道为什么 SQL Server 在分配给左侧之前不会对右侧的表达式求和。我用变量进行了测试，它可以工作。它不仅在这种情况下有效。

我现在使用的命令是：

```
UPDATE dbo.sample
SET column_a = column_a + @value
WHERE id = @id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:02:37.913

我尝试了以下脚本。它对我来说很好。

我建议你尝试一次。让我知道问题是否仍然存在。

```
create table #temp1(id int, prodName varchar(max))

insert into #temp1 values(1,'a')
insert into #temp1 values(2,'b')
insert into #temp1 values(3,'c')
insert into #temp1 values(4,'d')

select * from #temp1

declare @var varchar(1);
set @var = '5'; --note that i even tried declaring it as a varchar. it still works!
update #temp1
set id +=@var

select * from #temp1

drop table #temp1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T13:24:27.880

> **column_a +=** @value在 SQL Server 2008中等于**column_a = column_a + @value**

它只是第一个很短

# c# - C#：WCF 客户端未连接到同一台机器

> ID：15051666
> 
> 赞同：1
> 
> 时间：2013-02-24T12:21:57.717
> 
> 标签：c#, wcf

我正在尝试制作我的第一个 WCF 程序。它应该很简单，但我无法让它工作。

到目前为止我已经完成的步骤：

1.  创建 C# windows 窗体应用程序
2.  添加按钮
3.  向项目添加了 WCF 服务。
4.  根据[this](http://blogs.msdn.com/b/youssefm/archive/2009/11/02/wcf-101-the-simplest-wcf-example-you-ll-ever-see.aspx?Redirected=true)和[this](http://weblogs.asp.net/ralfw/archive/2007/04/14/a-truely-simple-example-to-get-started-with-wcf.aspx) page tutorials更改了代码。

**IWCF.cs**代码：

```
using System;
...etc

namespace WCF_Application
{

    [ServiceContract]
    public interface IWCF
    {
        [OperationContract]
        string DoWork();
    }
} 
```

**WCF.cs**代码：

```
using System;
...

namespace WCF_Application
{

    public class WCF : IWCF
    {
        public string DoWork()
        {
            return " Hello There! ";
        }

    }
} 
```

按钮代码：

```
private void btnConnect_Click(object sender, EventArgs e)
        {
// Starting the Server

            ServiceHost svh = new ServiceHost(typeof(WCF));
            svh.AddServiceEndpoint(
                typeof(IWCF),
                new NetTcpBinding(),
                "net.tcp://localhost:8000");
            svh.Open();
            MessageBox.Show("Connected");

// Connecting Client to the server
            ChannelFactory<IWCF> scf;
            scf = new ChannelFactory<IWCF>(
                        new NetTcpBinding(),
                        "net.tcp://localhost:8000");

            IWCF s = scf.CreateChannel();
            string response = s.DoWork();
            MessageBox.Show(response);
            svh.Close();
} 
```

我没有收到回复消息。该程序只是冻结。当我跟踪代码时，程序卡在了这`strong response = s.DoWork();`条线上。

我还检查`netstat -a`了cmd。并且似乎端口 8000 确实在侦听模式下打开。所以问题应该出在客户端部分。

操作系统 Windows 7 / VS 2010 / C#

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T16:03:34.863

您在这里遇到了死锁问题，因为您的 WCF 服务托管在与 UI 相同的线程上。您可以尝试以下方法在另一个线程上托管服务。

```
[ServiceBehavior(UseSynchronizationContext = false)]
public class WCF : IWCF
{
    public string DoWork()
    {
        return " Hello There! ";
    }
} 
```

这是[WPF 线程模型](http://msdn.microsoft.com/en-us/library/ms741870%28v=vs.100%29.aspx)和[UseSynchronizationContext](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicebehaviorattribute.usesynchronizationcontext.aspx)的一些背景知识。或者，您可以将客户端调用线程化到您的服务，但这也可能会产生其他 UI 更新后果。

# jquery-mobile - 使用 localStorage 创建奇怪的行为

> ID：15051667
> 
> 赞同：0
> 
> 时间：2013-02-24T12:22:00.607
> 
> 标签：jquery-mobile

我有一个对话框页面，它将服务器的地址和端口保存在 localStorage 中：

```
localStorage.SERVER['address'] = address;
localStorage.SERVER['port'] = port; 
```

我已经将我的后续请求缩减为仅控制台记录 localStorage 中的数据以检查事情是否正常。

```
$("#login_submit").click(function(event) {
    event.preventDefault();

    console.log(localStorage.SERVER['address'] + ' ' + localStorage.SERVER['port']);
} 
```

但是，当我在 localStorage 中没有任何内容的情况下提交表单时，这执行得很好（我得到“未定义的未定义”）。但是，在我在 localStorage SERVER 对象中保存了一些值之后，表单恢复为正常行为并尝试打开

```
http://mydomain/?username=&password= 
```

并且不会将任何内容记录到控制台。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T13:14:08.763

看看这个**`jsFiddle`**例子： http: [//jsfiddle.net/Gajotres/J9NTr/](http://jsfiddle.net/Gajotres/J9NTr/)，我是为我的其他**[文章](http://www.gajotres.net/document-onpageinit-vs-document-ready/)**制作的，或者可以在**[这里](https://stackoverflow.com/a/14469041/1848600)**找到。

基本上**`localStorage`**可以随时添加/修改数据。

尝试像这样访问它们，此示例适用于桌面浏览器、android 和**`iOS`**设备。

```
localStorage.firstname="Dragan";
localStorage.lastname="Gaic"; 
```

# actionscript-3 - as3如何流畅播放视频循环？

> ID：15051668
> 
> 赞同：0
> 
> 时间：2013-02-24T12:22:05.403
> 
> 标签：actionscript-3, video

我必须播放视频循环（2 秒高清质量），并且从一开始就播放视频存在问题，因为方法 seek(0) 总是冻结 Flash Player 片刻。现在有办法避免这个问题。我有一个想法，在 2 个分离的工作人员中播放 2 个网络流，但不知道如何共享舞台来做到这一点；[。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T11:37:27.700

我有同样的问题。
我已经在 swf 中嵌入了 flv 视频并在时间线上播放。
使用 embed vido 你可以流畅地循环播放，在某些情况下这是一个很好的解决方案。

（当您的项目变得更复杂时，无条件地将视频嵌入 swf 会增加性能问题。另一个问题是 swf 文件大小变得越来越大）

# c++ - Mat.inv() 在 opencv 中产生全零

> ID：15051669
> 
> 赞同：7
> 
> 时间：2013-02-24T12:22:06.310
> 
> 标签：c++, opencv

我有以下代码：

```
 cv::Mat temp0 = R.t();
    cv::Mat temp1 = R * temp0;
    cv::Mat temp2(960, 960, CV_32FC1);
    temp2 = temp1.inv();

    cv::Size s = temp1.size();
    std::cout<<s.height<<" "<<s.width<<std::endl;

    std::cout<<cv::format(temp1, "numpy" ) << std::endl;
    std::cout<<cv::format(temp2, "numpy" ) << std::endl; 
```

转置工作正常，矩阵乘法也是如此。因此，`Mat temp1`它的大小为 960x960。但是，当我这样做时`temp2 =temp1.inv()`，我会收到所有零`temp2`。我的意思是零是所有 960x960 单元格。而且，`R`只是类型`CV_32FC1`。所以这可能不是数据类型问题。我无法理解这里的问题。我用谷歌搜索了很多。你能帮忙吗？

***编辑***

我正在复制该`Mat::inv()`函数的 gdb 输出下方。我很难弄清楚这一切，但如果有人更熟悉 OpenCV，也许会有所帮助:)

```
Breakpoint 1, CreateShares::ConstructShares (this=0x80556d0, channel=..., k=2, n=4) at CreateShares.cpp:165
165     temp2 = temp1.inv();
(gdb) step

cv::Mat::operator= (this=0xbffff294, e=...) at /usr/include/opencv2/core/mat.hpp:1373
1373        e.op->assign(e, *this);
(gdb) 
1374        return *this;
(gdb) step
1375    }    
(gdb) step
cv::MatExpr::~MatExpr (this=0xbfffef64, __in_chrg=<optimized out>) at /usr/include/opencv2/core/mat.hpp:1167
1167    class CV_EXPORTS MatExpr
(gdb) step
cv::Mat::~Mat (this=0xbfffefdc, __in_chrg=<optimized out>) at /usr/include/opencv2/core/mat.hpp:295
295     release();
(gdb) step
cv::Mat::release (this=0xbfffefdc) at /usr/include/opencv2/core/mat.hpp:381
381     if( refcount && CV_XADD(refcount, -1) == 1 )
(gdb) step
383     data = datastart = dataend = datalimit = 0;
(gdb) step
384     size.p[0] = 0;
(gdb) step
385     refcount = 0;
(gdb) step
386 }
(gdb) step
cv::Mat::~Mat (this=0xbfffefdc, __in_chrg=<optimized out>) at /usr/include/opencv2/core/mat.hpp:296
296     if( step.p != step.buf )
(gdb) step
298 }
(gdb) step
cv::Mat::~Mat (this=0xbfffefa4, __in_chrg=<optimized out>) at /usr/include/opencv2/core/mat.hpp:295
295     release();
(gdb) step
cv::Mat::release (this=0xbfffefa4) at /usr/include/opencv2/core/mat.hpp:381
381     if( refcount && CV_XADD(refcount, -1) == 1 )
(gdb) step
383     data = datastart = dataend = datalimit = 0;
(gdb) step
384     size.p[0] = 0;
(gdb) step
385     refcount = 0;
(gdb) step
386 }
(gdb) step
cv::Mat::~Mat (this=0xbfffefa4, __in_chrg=<optimized out>) at /usr/include/opencv2/core/mat.hpp:296
296     if( step.p != step.buf )
(gdb) step
298 }
(gdb) step
cv::Mat::~Mat (this=0xbfffef6c, __in_chrg=<optimized out>) at /usr/include/opencv2/core/mat.hpp:295
295     release();
(gdb) step
cv::Mat::release (this=0xbfffef6c) at /usr/include/opencv2/core/mat.hpp:381
381     if( refcount && CV_XADD(refcount, -1) == 1 )
(gdb) step
383     data = datastart = dataend = datalimit = 0;
(gdb) step
384     size.p[0] = 0;
(gdb) step
385     refcount = 0;
(gdb) step
386 }
(gdb) step
cv::Mat::~Mat (this=0xbfffef6c, __in_chrg=<optimized out>) at /usr/include/opencv2/core/mat.hpp:296
296     if( step.p != step.buf )
(gdb) step
298 }
(gdb) step
CreateShares::ConstructShares (this=0x80556d0, channel=..., k=2, n=4) at CreateShares.cpp:167
167     cv::Size s = temp1.size();
(gdb) step
cv::Mat::MSize::operator() (this=0xbffff284) at /usr/include/opencv2/core/mat.hpp:705
705     return Size(p[1], p[0]);
(gdb) step
cv::Size_<int>::Size_ (this=0xbffff2f8, _width=960, _height=960) at /usr/include/opencv2/core/operations.hpp:1624
1624        : width(_width), height(_height) {}
(gdb) step
cv::Mat::MSize::operator() (this=0xbffff284) at /usr/include/opencv2/core/mat.hpp:706
706 }
(gdb) step 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-03T09:27:09.097

**最有可能的是，行列式为零。**

来自维基百科：

> 不可逆的方阵称为**奇异**或退化。方阵是奇异的当且仅当其行列式为 0。

您可以像这样显示行列式...

```
std::cout<<"determinant(temp1)="<<cv::determinant(temp1)<<"\n"; 
```

从[Mat::inv() 的文档中](http://docs.opencv.org/modules/core/doc/basic_structures.html?highlight=inv#MatExpr%20Mat::inv%28int%20method%29%20const)，有三种方法可供选择：

*   DECOMP_LU（默认）是 LU 分解。**矩阵必须是非奇异的。**
*   DECOMP_CHOLESKY 是对称正定义矩阵的 Cholesky 分解。这种类型在大矩阵上比 LU 快大约两倍。
*   DECOMP_SVD 是 SVD 分解。如果矩阵是奇异的或什至是非方形的，则计算伪逆。

从[invert() 的文档中](http://opencv.willowgarage.com/documentation/cpp/core_operations_on_arrays.html#invert)，大概是 Mat::inv() 内部使用的：

> 在 DECOMP_LU 方法的情况下，函数返回 src 行列式（ src 必须是正方形）。如果为 0，则矩阵不反转，dst 用零填充。

这与您看到的结果一致。

* * *

## 关于数学的笔记

我不是数学家，但我的印象是反转矩阵可能是一件麻烦事——如果你的矩阵非常大，更是如此。事实上，这些倒数原则上确实存在，但实际上不可能以任何准确度计算。在对您的代码进行一些实验时，我发现在许多情况下，我会得到不完全为零的行列式，但非常接近于零——也许表明**数值精度可能是限制因素**。我尝试使用 64 位值而不是 32 来指定矩阵，得到了不同但不一定更好的答案。

认识到，根据您计算`temp1`矩阵的方式，它始终是*对称*的，这可能很有用。该`DECOMP_CHOLESKY`方法专门设计用于处理对称[*正定*](https://stackoverflow.com/questions/5563743/check-for-positive-or-semi-positive-definite-matrix)矩阵，因此使用它可能会提供一些优势。

在实验中，我发现归一化（如@cedrou 所建议的那样）使逆函数更有可能返回非零矩阵（带`DECOMP_LU`但不带`DECOMP_CHOLESKY`）。但是，根据我对您可能如何初始化`R`矩阵的猜测，生成的矩阵似乎从未满足逆的定义：`A*inverse(A)=Identity`. 但您不一定关心这一点——这也许就是 SVD 方法计算*伪逆*的原因。

*最后，关于为什么*反演失败的这个更深层次的问题似乎是一个数学问题，而不是一个编程问题。基于此，我在数学网站上进行了一些搜索，结果发现有人已经问过如何做到这一点：[https ://math.stackexchange.com/questions/182662](https://math.stackexchange.com/questions/182662)

* * *

## 调试注意事项

根据您的调试跟踪，我倾向于认为您感兴趣的部分被编译成不可跟踪的库并在您运行时跳过`step`。换句话说，你第一个之后的那个神秘的空白行`step`代表它实际运行`inv()`函数的部分。之后，它将结果分配给`temp2`并销毁临时对象。所以你的调试跟踪并没有告诉我们任何关于`inv()`.

```
165     temp2 = temp1.inv();
(gdb) step

cv::Mat::operator= (this=0xbffff294, e=...) at /usr/include/opencv2/core/mat.hpp:1373
1373        e.op->assign(e, *this); 
```

我自己对此运行了一个调试器，并且能够跟踪内部调用`invert()`并观察它基于对矩阵的内部分析（确定它不可逆）决定失败 - 因此返回一个填充零的矩阵，与您报告的内容相符。

该`invert()`函数在[cxlapack.cpp](https://code.ros.org/trac/opencv/browser/trunk/opencv/src/cxcore/cxlapack.cpp?rev=2245)中定义，以防您有兴趣查看源代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T10:26:52.223

对于随机矩阵`R`乘积`R^T*R`可能是奇异的。因此任何类型的 LU 分解都会过早停止，导致输出为零。

为了克服这一点，可以反转矩阵`R^T*R+alpha*I`。这`I`是单位矩阵，`alpha`- 一些正数。如果 alpha 接近于零且`R^T*R`不是奇异的，`R^T*R+alpha*I`则 的倒数接近 的倒数`R^T*R`。有关详细信息，请参阅[Tikhonov 正则化](http://en.wikipedia.org/wiki/Tikhonov_regularization)

另一种情况是矩阵`R^T*R`不是奇异的而是病态的。[大型非结构化矩阵的条件数](http://en.wikipedia.org/wiki/Condition_number)可能很大，导致矩阵求逆的奇怪行为（LU 分解仅适用于相对较小的条件数）。

## 关于规范化

归一化矩阵将改善反演行为，因为它减少了条件数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T15:06:25.277

我得出的结论与@berak 相同。希望下面的实验对你有所帮助。

我用一个填充了一些随机值的矩阵尝试了你的代码（正态分布以 0 为中心，标准偏差为`sigma`。随着`sigma`增加，最终矩阵的值减少。

这是我使用的代码：

```
cv::Mat R(960,960, CV_32FC1);

double sigma[] = { 1.0, 10.0, 100.0, 1000.0, 10000.0, 100000.0, 1000000.0, 10000000.0 };
cv::Scalar mean[_countof(sigma)] = {0};
cv::Scalar stdv[_countof(sigma)] = {0};
for (int i = 0; i < _countof(sigma); i++)
{
    cv::randn(R, cv::Scalar::all(0.0), cv::Scalar::all(sigma[i]));
    cv::Mat temp2 = (R * R.t()).inv();

    cv::meanStdDev(temp2, mean[i], stdv[i]);
} 
```

以下是增加 sigmas 的输出矩阵的均值和标准差：

```
sigma       mean        stddev
1.0         3.94e-004   1.32
10.0        1.25e-004   3.82e-002
100.0       3.32e-007   1.09e-004
1000.0      2.40e-009   2.23e-006
10000.0     9.82e-012   1.05e-008
100000.0    2.23e-013   1.73e-010
1000000.0   1.44e-015   2.88e-012
10000000.0  9.61e-017   2.77e-014 
```

因此，您的解决方案是标准化您的输入矩阵，以便所有值都适合 [0;1] 或 [-1;1]。

# java - 如何在JAXWS中从java调用webservice客户端

> ID：15051670
> 
> 赞同：0
> 
> 时间：2013-02-24T12:22:37.610
> 
> 标签：java, web-services, servlets

我想在 Eclipse 中从我的 servlet 或 java 类调用 Webservice 客户端。

以及如何使用客户端从我的 java 或 servlet 类调用 wsdl 中的特定方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:46:29.210

```
@WebServiceRef(wsdlLocation="http://localhost:8080/
    helloservice/hello?wsdl")
static HelloService service;
...  

Hello port = service.getHelloPort();

....
String response = port.sayHello(name); 
```

# wpf - 将组合框绑定到整数数组

> ID：15051672
> 
> 赞同：1
> 
> 时间：2013-02-24T12:22:45.403
> 
> 标签：wpf, binding, combobox

我在 XAML 中创建了一个整数数组，如下所示：

```
 <x:Array Type="{x:Type sys:Int16}" x:Key="intervals">
        <sys:Int16>1</sys:Int16>
        <sys:Int16>2</sys:Int16>
        <sys:Int16>3</sys:Int16>
 </x:Array> 
```

我在 ViewModel 中有一个名为 Interval 的整数属性。我正在尝试将此 Interval 属性绑定到 ComboBox 的 SelectedValue 属性。但是，ComboBox 不显示与 Interval 属性的值相对应的选定值。这是我的组合框 XAML 代码：

```
 <ComboBox SelectedValue="{Binding Path=Interval}" Height="25" ItemsSource="{StaticResource intervals}" HorizontalContentAlignment="Center" Margin="78,47,237,128" Name="comboBox1" VerticalContentAlignment="Center" Width="85" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T12:33:57.423

嗨，您应该尝试 SelectedItem 而不是 SelectedValue，因为对于 SelectedVlue，您还必须提供 SelectedValuePath。

```
public partial class MainWindow
{
    public MainWindow()
    {
        InitializeComponent();
        DataContext = this;
    }
    public Int16 Interval { get; set; }

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        var a = Interval;
    }
}

 <Window.Resources>
    <x:Array Type="{x:Type sys:Int16}" x:Key="intervals">
        <sys:Int16>1</sys:Int16>
        <sys:Int16>2</sys:Int16>
        <sys:Int16>3</sys:Int16>
    </x:Array>
</Window.Resources>

    <Grid x:Name="LayoutRoot">
    <StackPanel>
        <ComboBox SelectedItem="{Binding Path=Interval}" Height="25" ItemsSource="{StaticResource intervals}" HorizontalContentAlignment="Center" Margin="78,47,237,128" Name="comboBox1" VerticalContentAlignment="Center" Width="85" />
        <Button Content="ok" Click="Button_Click"/>
    </StackPanel>
</Grid> 
```

我希望这将有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T12:29:57.240

您创建了一个值数组[`short`](http://msdn.microsoft.com/en-us/library/ybs77ex4.aspx)。您的`Interval`属性也应该是 type `short`。

```
public short Interval { get; set; } 
```

如果您打算`int`用作项目类型，则必须`sys:Int32`用作数组元素类型。

* * *

此外，您应该绑定该[`SelectedItem`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selecteditem.aspx)属性。尽管它适用于您的情况，但它`SelectedValue`旨在与[`SelectedValuePath`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selectedvaluepath.aspx).

```
<ComboBox SelectedItem="{Binding Path=Interval}" ... /> 
```

# android - 如何使用偏好活动增加偏好高度？

> ID：15051673
> 
> 赞同：0
> 
> 时间：2013-02-24T12:22:55.637
> 
> 标签：android, preferenceactivity

我正在尝试显示图像列表`Preference`，我可以使用它`ListPreference`但想在没有对话框的情况下显示。

我尝试了[链接](https://stackoverflow.com/a/8843075/1278196)，但得到 `ClassCastException`.

它应该动态工作，否则我可以自定义每个首选项并添加它，但这会很糟糕。

请参阅随附的示例图片。

任何帮助/建议都将不胜感激。

![示例图像](../Images/dbbe796ab16cd788bda8988127fd1e80.png)

***更新。***

我可以创建每个自定义`Preference`类来显示图像，但是因为我有 5 个图像需要创建不同的类。请参阅输出附加图像。有没有其他方法可以动态而不是静态方式？

![输出图像](../Images/cd118960ec631d40c0afdebd000d4337.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T22:27:16.203

我还没有尝试过，但我会在代码中构建所有内容。所以尝试将此代码放在首选项类的*for()*语句中：

```
LinearLayout layout = new LinearLayout(this);
layout.setBackgroundResource(R.drawable.background1);
layout.setId(567890);

PreferenceScreen preference;
preference = getPreferenceScreen();
Preference new_preference = new Preference(this);
new_preference.setKey("key1");
new_preference.setTitle("");
new_preference.setLayoutResource(567890);
preference.addPreference(new_preference); 
```

# php - 偏移 PHP 数组结果

> ID：15051674
> 
> 赞同：0
> 
> 时间：2013-02-24T12:23:04.010
> 
> 标签：php, arrays, offset

我希望抵消一组 PHP 数组结果以创建多行数据。

例如，第一行将包含前四个数组结果，第二行显示结果 5-8，第三行包含结果 9-12。

目前，我在一个列表中打印出所有 12 个，但是我想要更多的显示控制（即将结果排序到我可以独立于每个样式设置的列中），因此我想抵消结果。

我当前的PHP如下：

```
<?php    
if (empty($tmdb_cast['cast'])) {

} else {?>
    <section class="cast">
        <p class="title">Cast</p>
        <ul class="section_body"><?php
            foreach($tmdb_cast['cast'] as $key => $castMember){
                if ($key < 12) {?>
                    <li class="actor_instance clearfix"><?php
                        if ($castMember['profile_path'] != '') {?>
                            <img src="http://cf2.imgobject.com/t/p/w45<?php echo $castMember['profile_path']; ?>" class="actor_image pull-left" alt="<?php echo $castMember['name']; ?>" title="<?php echo $castMember['name']; ?>" /><?php
                        } else {?>
                            <img src="assets/images/castpic_unavailable.png" class="actor_image pull-left" alt="No image available" title="No image available" /><?php
                        }?>
                    <p class="actor"><?php echo $castMember['character']; ?> - <a href="actor.php?id=<?php echo $castMember['id']; ?>"><?php echo $castMember['name']; ?></a></p>
                    </li><?php
                }
            }?>

            <div class="morecast pull-right"><a href="http://www.imdb.com/title/<?php echo $imdb_id; ?>/fullcredits" title="View full cast list on IMDb">[...view all cast]</a></div>
        </ul>
    </section><?php
}?> 
```

PS 对我如何格式化上述代码块中的代码表示歉意——我仍然不能 100% 确定如何让它在 StackOverflow 上看起来“不错”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:29:20.667

用于`array_chunk`将一维数组分解为二维数组。然后你可以遍历每个块，然后是每个结果，以获得它们之间的“偏移”效果。

```
$chunks = array_chunk($tmdb_cast['cast'], 4); // 4 here, is the number you want each group to have 

foreach($chunks as $key => $chunk)
{
    foreach($chunk as $castMember) 
    {
         //display castMember here
    }
    // add code between groups of 4 cast members here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:34:08.223

第一：以这种方式混合 php 和 html 是一个非常糟糕的习惯......有一天你将不得不维护你的代码，那天你会在你的桌子上呕吐，因为你在一个文件中混合了不同的语言......这就是说。 . 并且不创建新数组：

```
foreach($tmdb_cast['cast'] as $key => $castMember)
{
    if ($key < 12)
    {
        // your code goes here

        // if key is 3, or 7 the code below will close the listcontainer and open a new one...
        if( ($key+1)%4 == 0 AND $key <11)
            echo '</ul> <ul class="section_body">';
    }
} 
```

也替换这个：

```
if (empty($tmdb_cast['cast']))
{
}
else { 
```

有了这个：

```
if (!empty($tmdb_cast['cast']))
{ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T12:48:52.787

我不完全确定您在寻找什么，但这是我将如何格式化您的代码。'if' 的[替代语法更具可读性，并且使用](http://php.net/manual/en/control-structures.alternative-syntax.php)[for 循环](http://www.php.net/manual/en/control-structures.for.php)而不是 foreach 将使您能够控制您说要查找的行号。

```
<?php   if( ! empty($tmdb_cast['cast'])): ?>
    <section class="cast">
        <p class="title">Cast</p>
        <ul class="section_body">
<?php
            for($i = 0; $i < 12; $i++):
            $castMember = $tmdb_cast['cast'][$i];
?>
            <li class="actor_instance clearfix">
<?php           if($castMember['profile_path'] != ''): ?>
                <img src="http://cf2.imgobject.com/t/p/w45<?php echo $castMember['profile_path']; ?>" class="actor_image pull-left" alt="<?php echo $castMember['name']; ?>" title="<?php echo $castMember['name']; ?>" />
<?php           else: ?>
                <img src="assets/images/castpic_unavailable.png" class="actor_image pull-left" alt="No image available" title="No image available" />
<?php           endif; ?>
                <p class="actor"><?php echo $castMember['character']; ?> - <a href="actor.php?id=<?php echo $castMember['id']; ?>"><?php echo $castMember['name']; ?></a></p>
            </li>
<?php       endfor; ?>

            <div class="morecast pull-right"><a href="http://www.imdb.com/title/<?php echo $imdb_id; ?>/fullcredits" title="View full cast list on IMDb">[...view all cast]</a></div>
        </ul>
    </section>
<?php   endif; ?> 
```

# matlab - 定位二维数组中的公共元素

> ID：15051677
> 
> 赞同：1
> 
> 时间：2013-02-24T12:23:27.777
> 
> 标签：matlab, iteration

我有两个非常长的二维列表，分别称为“first_data*”和“second_data”，我想找到相等的元素并将它们放在列表“final_data”中。我在这里有一个 MWE：

```
first_data  = [1 2; 3 4]';
second_data = [1 2; 9 4]';

final = [];
for i=1:length(first_data(:, 1))
    for j=1:length(second_data(:, 1))
        if(first_data(i, 2) == second_data(j, 2))
            final = [final first_data(i, 1)];
        end
    end
end 
```

根据需要，这给了我 2。这是可行的，但对于非常大的数据集来说，它的计算量非常大。有没有更有效的方法来编写上述代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:58:58.453

`ismember`会让你做你想做的事。

```
%# identify the rows in first_data's second column
%# that occur in second_data's second column
goodIdx = ismember(first_data(:,2),second_data(:,2));

%# return the corresponding values of first_data's first column
final = first_data(goodIdx,1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T14:35:07.467

试试这个代码：

```
first_data  = [1 2; 3 4]';
second_data = [1 2; 9 4]';
diff_data=first_data-second_data;
Ind=find(diff_data==0);
final=first_data(Ind); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T13:57:53.590

采用：

```
[c, ia, ib] = intersect(first_data(:, 2), second_data(:, 2));
final = second_data(ib,1); 
```

注意：我没有对此进行测试，但它应该可以工作（至少到行/列混合）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T14:44:16.570

那么你的两个数据集可以完全用下面的元组来描述吗？

“first_data”由`(i,j,data_1)`- 描述，表示值 data_1 位于第 i 行第 j 列

“second_data”由`(i,j,data_2)`

你想找到这样的元组相等吗？

使用[布隆过滤器](http://en.wikipedia.org/wiki/Bloom_filter#Algorithm_description)将“first_data”和“second_data”转换为**集合**

使用“first_data”和“second_data”的布隆过滤器表示执行*集合交集*，并使用两个表示的按位与获得基本恒定的时间集合交集。

# asp.net - 获取自动创建的 webuserControl 的值

> ID：15051680
> 
> 赞同：1
> 
> 时间：2013-02-24T12:24:11.067
> 
> 标签：asp.net, vb.net

我已经动态添加了一个 WebUserControl，然后我想得到它，这是我的故事 :( 我不知道该怎么做，这是我的代码，在此先感谢，

```
 Protected Sub btngenerate_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btngenerate.Click

    For Each Str As String In Tstring
        Dim addressControl As WebUC = CType(LoadControl("WebUC.ascx"), WebUC)

        addressControl.plbl.Text = Str
        form1.Controls.Add(addressControl)
    Next

End Sub

Protected Sub btnOk_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnOk.Click

 'here is what i did , but it didn't work
 'For Each ct As WebUCIn form1.Controls
 ' ltlres.Text = ltlres.Text & ", " & ct.plbl.Text & " " & ct.ptxt.Text

 'Next

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:26:57.830

动态添加控件有一个规则。`Init`只要您需要它们，就必须重新添加它们。

只需在单击按钮时添加它们就会第一次显示它们，但您不会收到它们的任何输入。

您可以在会话中保留一个标志以表示必须添加它们`Init`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:34:29.093

因为您动态添加了该控件，所以当您回发时，您需要再次添加它以使其 ViewState 和回发数据与之关联。

在事件中重新创建它`Init`，然后当您处理控件事件（如按钮单击）时，它将存在并且将与其相关联的数据（例如其子控件的内容）。

由于您将创建控件作为对另一个事件的响应，因此您需要在 Session 中保留某种标志（布尔值？计数器？），以便知道是否在`Init`.

# mongodb - Mongo 选择自定义字段

> ID：15051681
> 
> 赞同：0
> 
> 时间：2013-02-24T12:24:12.593
> 
> 标签：mongodb

让我们假设我有一个包含

```
_id
first_name
last_name
... 
```

如何选择包括自定义在内的所有字段，如下所示：

```
db.collection_name.findOne({},{*,$full_name:{$value:first_name+' '+last_name}}); 
```

*这只是一个例子。*

我们如何选择具有一些自定义字段的所有字段，例如`full_name`

在哪里

```
full_name=first_name+' '+last_name 
```

# java - 是否可以在控制台中重写上一行？

> ID：15051688
> 
> 赞同：12
> 
> 时间：2013-02-24T12:25:25.123
> 
> 标签：java

我正在尝试在我的控制台应用程序中创建进程动画。是否可以根据需要重写以前的行？我知道，`\r`但它只适用于当前行。

如果不可能，我怎么能达到动画效果？谢谢。

*我的控制台是标准的 Ubuntu 12.04 终端模拟器。*

* * *

感谢@MrSmith42，我做了这个简单的演示，展示了覆盖行的方法：

```
public class Flush {
    public static void main(String[] args) {
        for(int i = 0; i < 5; i++) {
            System.out.println("**********************************");
        }
        // ESC[5A - cursor up 5 times
        // \r - cursor return to begin of line
        // ESC[J - erase to end of screen
        System.out.print("\033[5A\r\033[J");
        for(int i = 0; i < 5; i++) {
            System.out.println("##################################");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-24T12:27:53.467

这取决于您的控制台。很多控制台支持 [vt100 命令](http://www.termsys.demon.co.uk/vtansi.htm)，例如允许更改光标的位置或更改文本或背景的颜色。

我经常使用它在我的 java 程序中将彩色调试输出输出到 shell。

如果链接失效，请使用此谷歌搜索 [https://www.google.de/search?q=vt100+comands&oq=vt100+comands](https://www.google.de/search?q=vt100+comands&oq=vt100+comands)

# amazon-web-services - 从亚马逊下载数据集

> ID：15051693
> 
> 赞同：2
> 
> 时间：2013-02-24T12:25:33.763
> 
> 标签：amazon-web-services, amazon-s3, download, dataset, amazon

我想知道是否可以下载公共 AWS 数据集的一部分以及如何下载。

具体来说，我想从[Common Crawl Corpus](http://aws.amazon.com/datasets/41740)下载一部分来进行本地测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:17:36.013

看起来你可以。如果您将浏览器指向[Amazon 提供的公共 URL](http://s3.amazonaws.com/aws-publicdatasets/)，您可以看到整个集合和子集的链接。

您可以使用浏览器或任何 S3 客户端工具或库下载它。

# windows - 使用 7z 命令行在文件名中创建具有当前日期和时间的存档

> ID：15051694
> 
> 赞同：1
> 
> 时间：2013-02-24T12:25:39.410
> 
> 标签：windows, compression, scheduled-tasks, scheduling, 7zip

今天我突然失去了我的整个孤岛惊魂3保存游戏。所以现在我想使用windows任务调度在一段时间内自动备份它的保存游戏文件夹。

我想在存档文件名中包含日期和时间。

这是我的命令

```
C:\>"C:\Program Files\7-Zip\7z" a -r "D:\FC3\%DATE:~7,2%.%DATE:~4,2%.%DATE:~-4% %TIME% Backup".7z  "C:\ProgramData\Orbit\46" 
```

出于格式化目的，我[在超级用户上关注了这个问题](https://superuser.com/questions/206817)

执行此命令时收到日志

```
7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
Scanning

Creating archive D:\FC3\24.02.2013 17:52:10.62 Backup.7z

Error:
7-Zip cannot open file
D:\FC3\24.02.2013 17:52:10.62 Backup.7z
The filename, directory name, or volume label syntax is incorrect.

System error: Unspecified error 
```

如果我使用像“D:\abc”这样的简单文件名。它会起作用的。

请帮忙。我哪里错了..？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T12:36:45.033

我明白了

文件名不能有`:`

我通过将冒号替换为`.`

```
C:\>"C:\Program Files\7-Zip\7z" a -r "D:\FC3\%DATE:~7,2%.%DATE:~4,2%.%DATE:~-4% %TIME:~0,2%.%TIME:~3,2%.%TIME:~-5% Backup".7z  "C:\ProgramData\Orbit\46" 
```

# for-loop - for循环中的变量命名

> ID：15051697
> 
> 赞同：0
> 
> 时间：2013-02-24T12:25:43.463
> 
> 标签：for-loop, python-2.7

我正在编写一个应该与列表一起使用的函数，如果我使用这个例子：

```
def mode(year):
    monthAmount = len(year)

    for month in year:
        (month)Index = len(month) 
```

我想做的是，假设*年份*是[January, February, March]，结果应该是这样的：JanuaryIndex = *, FebruaryIndex = *, MarchIndex = *, 等等；有许多不同的月份。是否有捷径可寻？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T12:27:52.743

我不完全确定您在这里寻找什么。

*要将索引与实际值一起*循环到序列中，请使用以下[`enumerate()`函数](http://docs.python.org/2/library/functions.html#enumerate)：

```
for index, month in enumerate(year):
    print index, month 
```

您真的不想动态设置全局变量。改用字典：

```
monthindices = {}

for month in year:
    monthindices[month] = len(month) 
```

您*可以通过访问*[`globals()`映射](http://docs.python.org/2/library/functions.html#globals)来动态创建全局变量，但这样做*通常不是一个好主意*。如果你很固执，你会这样做：

```
gl = globals()
for month in year:
    gl['{}Index'.format(month)] = len(month) 
```

# javascript - 将 Knockout js json 转换为 observable

> ID：15051699
> 
> 赞同：5
> 
> 时间：2013-02-24T12:26:06.427
> 
> 标签：javascript, json, knockout.js

我正在努力返回 JSON 数据并将其转换为 observable。数据以 JSON 格式返回，但似乎没有分配给 observable。有人可以帮忙吗？我猜问题出在 ajax 调用的成功部分：

```
<script type="text/javascript">

function StandingsViewModel() {
    var self = this;

    self.standings = ko.observableArray();

    self.DivisionName = ko.observable('');

    self.afceast = ko.computed(function () {

        return ko.utils.arrayFilter(self.standings(), function (i) {
            return "AFC East" == i.DivisionName;
        });
    });

    self.afccentral = ko.computed(function () {

        return ko.utils.arrayFilter(self.standings(), function (i) {
            return "AFC Central" == i.DivisionName;
        });
    });

    self.afcwest = ko.computed(function () {

        return ko.utils.arrayFilter(self.standings(), function (i) {
            return "AFC West" == i.DivisionName;
        });
    });

    self.nfceast = ko.computed(function () {

        return ko.utils.arrayFilter(self.standings(), function (i) {
            return "NFC East" == i.DivisionName;
        });
    });

    self.nfccentral = ko.computed(function () {

        return ko.utils.arrayFilter(self.standings(), function (i) {
            return "NFC Central" == i.DivisionName;
        });
    });

    self.nfcwest = ko.computed(function () {

        return ko.utils.arrayFilter(self.standings(), function (i) {
            return "NFC West" == i.DivisionName;
        });
    });

    $.ajax({
        dataType: "json",
        url: "/api/standing/GetStandingsBySeason/2018",
        beforeSend: function (xhr) {
            $('#divStandings').html('');
            $('#divStandings').addClass('ajaxRefreshing');
            xhr.setRequestHeader('X-Client', 'jQuery');
        },
        success: function (result) {
            $('#divStandings').removeClass('ajaxRefreshing');
            self.standings(JSON.parse(result));
        }
    });
}

$(document).ready(function () {
    ko.applyBindings(new StandingsViewModel());
});

</script> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-24T13:38:39.647

您应该使用[Knockout Mapping](http://knockoutjs.com/documentation/plugins-mapping.html)插件并将您的结果映射到 observable。

```
var observableData = ko.mapping.fromJS(result); 
```

或者如果你的对象没有被 jQuery 自动解析

```
var observableData = ko.mapping.fromJSON(result); 
```

如果您的数据类型是数组，它将转换为 observableArray，因此要将其作为普通数组获取项目，您应该通过添加括号从任何其他可观察对象中获取；

```
var array = observableData(); 
```

该数组可以通过这种方式分配给您的 obsevableArray：

```
self.standings(array); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T19:27:56.940

使用 Knockout 映射插件的另一种选择是使用[Knockback](http://kmalakoff.github.com/knockback/)。它是 Knockout 和[Backbone](http://backbonejs.org/)之间的桥梁。

您可以像这样轻松获取数据：

```
//Model
var StandingsModel = Backbone.Collection.extend({ 
    url:'/api/standing/GetStandingsBySeason/2018' 
});

//View model
var StandingsViewModel = function (standings) {
    this.standings = kb.collectionObservable(standings)
    //...
};

$(document).ready(function () {
    //Get data from server
    var model = new StandingsModel();
    model.fetch( function() {
        success: //...
    });

    //Apply bindings
    ko.applyBindings(new StandingsViewModel(model));
}); 
```

# java - 有人可以告诉我我做错了什么吗？通过LinkedList计数和循环

> ID：15051700
> 
> 赞同：0
> 
> 时间：2013-02-24T12:26:25.633
> 
> 标签：java, loops, linked-list, counter

我的代码如下：

```
import net.datastructures.Node;

public class SLinkedListExtended<E> extends SLinkedList<E> {

public int count(E elem) {
    Node <E> currentNode = new Node <E>();
    currentNode = head;
    int counter = 0;

    for (int i = 0; i<size; i++){

    if (currentNode == null) {
        return 0; //current is null
    }
    else if (elem.equals(currentNode.getElement())){
                counter++;
                currentNode = currentNode.getNext();
            }
    }
    return counter;
    }

public static void main(String[] args) {

    SLinkedListExtended<String> x = new SLinkedListExtended<String>();

    x.insertAtTail("abc");
    x.insertAtTail("def");
    x.insertAtTail("def");
    x.insertAtTail("xyz");
    System.out.println(x.count("def")); // should print "2"
    //x.insertAtTail(null);
    x.insertAtTail("def");
    //x.insertAtTail(null);
    System.out.println(x.count("def")); // should print "3"
    //System.out.println(x.count(null)); // should print "2"
}

} 
```

方法 count 应该返回给定元素 elem 在列表中找到的次数。我已经写了这个循环，但每次只能得到 0 的回报。还会引发空指针异常。

编辑：SLinkedList 超类

```
import net.datastructures.Node;

public class SLinkedList<E> {
protected Node<E> head; // head node of the list
protected Node<E> tail; // tail node of the list (if needed)
protected long size; // number of nodes in the list (if needed)

// default constructor that creates an empty list
public SLinkedList() {
    head = null;
    tail = null;
    size = 0;
}

// update and search methods
public void insertAtHead(E element) {
    head = new Node<E>(element, head);
    size++;
    if (size == 1) {
        tail = head;
    }
}

public void insertAtTail(E element) {
    Node<E> newNode = new Node<E>(element, null);
    if (head != null) {
        tail.setNext(newNode);
    } else {
        head = newNode;
    }
    tail = newNode;
    size++;
}

public static void main(String[] args) { // test

}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:32:17.240

如果两个条件都不匹配，您似乎错过了转到下一个节点。

```
public int count(E elem) {
    Node <E> currentNode = new Node <E>();
    currentNode = head;
    int counter = 0;

    for (int i = 0; i<size; i++){
        if (currentNode == null) {
            return 0; //current is null
        }
        else if (elem.equals(currentNode.getElement())){
            counter++;
        }
        currentNode = currentNode.getNext();          
    }
    return counter;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T13:29:46.943

我认为，史密斯先生的回答很到位。我不会将 size 用于循环，而是将没有下一个作为底部的事实。当然，您的 count 方法必须在所有情况下都返回计数器，而不是 0。

# c - 使用 strcpy 将字符串复制到使用 atoi 检索的索引处的元素中

> ID：15051701
> 
> 赞同：0
> 
> 时间：2013-02-24T12:26:28.110
> 
> 标签：c, arrays, memory-management, strcpy, atoi

这是代码，它应该在`history`输入“history 1”时执行第一个命令：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main (int argc, char *argv[])
{
    int i=0; int j=0; int k=0;
    char inputString[100];
    char *result=NULL;
    char delims[] = " ";
    char historyArray[100][100] = {0};
    char *tokenArray[100][100] ;

    do
    {
        j = 0;
        printf("hshell>");
        gets(inputString);
        strcpy (historyArray[k], inputString);
        k++;

        // Break the string into parts
        result = strtok(inputString, delims);

        while (result!=NULL)
        {
            //result2 = result;
            strcpy(tokenArray[j], result);
            //puts(result);
            j++;
            result= strtok(NULL, delims);                  
            //puts(tokenArray[j]);     
        }
        //j = 0;
        puts(tokenArray[0]);
        puts(tokenArray[1]);

        if (strcmp(tokenArray[0], "exit") == 0)
        {
            return 0;
        }
        else if (strcmp(tokenArray[0], "history") ==  0)
        {
           if (j>1)
           {
              strcpy (result,historyArray[atoi(tokenArray[j-1])]);

           }
           else
           {
               //print history array
               for (i=0; i<k;i++)
                   printf("%i. %s\n", i+1, historyArray[i]);
           }
        }
        else
        {
          printf("Command not found\n");
        }
    }while (1);
} 
```

但是，它崩溃了。在调试时，我注意到两件事： - 数组 ( `tokenArray`) 地址**超出范围**和 -**访问冲突（分段错误）**。您可以在下图中看到错误。

![越界](../Images/bf8cdd8044d2ee9fff3d926b6e81ae62.png)

![分段故障](../Images/703ccd70b7886d874f1e143ad2b7021a.png)

我错过了什么？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:36:39.020

您处理**分段错误**的原因是因为您试图将字符串复制到尚未分配的内存中。您已定义`result`为 a`char*`并刚刚分配`NULL`给它，因此尝试将字符串复制到其中是错误的：

```
char *result = NULL;
// ...
strcpy(result, historyArray[atoi(tokenArray[j-1])]); 
```

您需要分配一些内存，这`result`将指向。然后`strcpy`可用于将字符串复制到此内存中。您可以使用`malloc`动态分配它，也可以将其定义`result`为具有自动存储持续时间的临时变量（即`char result[100];`）。

* * *

另请注意

```
char *tokenArray[100][100]; 
```

定义指向 的指针的二维数组`char`。但是在这种情况下你真正需要的是一个字符串数组，所以你需要`*`像@cnicutar 指出的那样摆脱。

* * *

还有一个注意事项：

```
strcpy(result,historyArray[atoi(tokenArray[j-1])]); 
```

这样做是非常危险的，因为当`atoi`失败时，您试图访问数组边界之外的元素，这会产生**未定义的行为**，因此我建议您执行以下操作：

```
char tokenArray[100][100] = {0};

int index;
char indexString[100] = "8";
if (sscanf(indexString, "%d", &index) == 1)     // integer successfully retrieved
{
    strcpy(tokenArray[index], "some string");
    printf("%s", tokenArray[8]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T14:42:45.617

您可能的意思是使用1 个令牌中的每个字符`char tokenArray[100][100];`创建。`100` `tokens``100`

字面`char *tokenArray[100][100]`意思`tokenArray`是一个数组`100`数组，其中包含`100` `char *`. 但是，如果没有为其分配正确的地址，则这些地址中的每一个都`char *`指向随机地址。

您收到分段违规错误，因为其中一个`char *`包含您无法访问的地址。

# iphone - 如何向 UIView 添加对角线描边

> ID：15051702
> 
> 赞同：1
> 
> 时间：2013-02-24T12:26:50.437
> 
> 标签：iphone, ios, objective-c, uiview, cglayer

如何向 UIImageView 添加一个看起来像 X 的红色笔触。

我想在 UIImageView 中添加 2 条对角红线，有没有办法使用图层或蒙版以编程方式进行？（不在drawRect中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:41:13.513

使用`CAShapeLayer`带有 X 形状的 a 作为其路径。根据您绘制路径的方式，您可能需要设置`nil`填充颜色（因为不应填充仅由两条交叉线组成的路径）。

将形状图层添加为图像视图的子图层。

# eclipse - 从关闭的项目中启动配置 DocsConnectionPropsHelper 引用类

> ID：15051705
> 
> 赞同：3
> 
> 时间：2013-02-24T12:27:05.680
> 
> 标签：eclipse, class

正如标题所说，eclipse给了我这个错误：

从已关闭的项目 foo 中启动配置 DocsConnectionPropsHelper 引用类

所以我的问题是如何找到依赖于已关闭项目的类并将其删除。

我怎样才能找到那个班级？即使关闭了另一个项目，我的项目也没有错误或任何东西。

# android - 显示键盘时的Android RelativeLayout位置问题

> ID：15051706
> 
> 赞同：0
> 
> 时间：2013-02-24T12:27:18.147
> 
> 标签：android, android-relativelayout

我正在开发一个android应用程序。我正在使用`RelativeLayout`登录页面并在底部添加一个按钮`android:layout_alignParentBottom="true"`，但是每当我输入登录框时，键盘就会显示，并且该登录按钮也会在键盘上方移动。我想要那个按钮始终保持在底部。

如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:38:45.773

添加`android:windowSoftInputMode="adjustPan"`到 中的相关活动`AndroidManifest.xml`。

```
<activity android:name="MyActivity"

   android:windowSoftInputMode="adjustPan">

</activity> 
```

希望对你有效。

# java - Play2 中 inputRadioGroup 的 Java 示例

> ID：15051711
> 
> 赞同：0
> 
> 时间：2013-02-24T12:27:55.170
> 
> 标签：java, forms, playframework, playframework-2.1

我无法找到如何为我的表单实现单选按钮。我需要在该组中有 5 个单选按钮，代表从 1 到 5 的等级。

形式：

```
public static class MobileWriteReview {

    @Constraints.MinLength(1)
    @Constraints.MaxLength(32)
    @Constraints.Required
    public String firstName;

    @Constraints.MinLength(1)
    @Constraints.MaxLength(32)
    @Constraints.Required
    public String lastName;

    @Constraints.MinLength(5)
    @Constraints.Required
    public String password;

    @Constraints.MinLength(5)
    @Constraints.Required
    public String repeatPassword;

    @Constraints.Required
    public int grade;

    @Constraints.MinLength(30)
    @Constraints.Required
    public String text;

    /**
     * Required by play.
     */
    public MobileWriteReview() {
    }

    public MobileWriteReview(int grade) {
        this.grade = grade;
    }
} 
```

控制器方法：

```
private static final Form<MobileWriteReview> MOBILE_WRITE_REVIEW_FORM = form(MobileWriteReview.class);

public static Result review(){
        MobileWriteReview mobileWriteReview = new MobileWriteReview(3);
        MOBILE_WRITE_REVIEW_FORM.fill(mobileWriteReview);
        return ok(mobileInviteToReview.render(MOBILE_WRITE_REVIEW_FORM));
    }

public static Result doReview(){
        final Form<MobileWriteReview> filledForm = MOBILE_WRITE_REVIEW_FORM.bindFromRequest();
        if (filledForm.hasErrors()) {
            // User did not fill everything properly
            return badRequest(mobileInviteToReview.render(filledForm));
        } else {
            // Everything was filled
            return ok();
        }
} 
```

view.scala.html

```
@(inviteForm: Form[_])
@styles = {

}
@scripts = {

}

@import helper._

@helper.form(routes.MobileInviteToReview.doReview) {

    @if(inviteForm.hasGlobalErrors) {
    <p class="error">
        <span class="label label-important">@inviteForm.globalError.message</span>
    </p>
    }

    @inputRadioGroup(
    // appropriate code here
    ) 
```

}

所以我的问题是如何在我的控制器中设置表单然后在视图中使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T16:07:05.047

首先，您的代码在控制器中呈现表单时出现错误。

解决方案可能如下所示：

**控制器：**

```
private static final Form<MobileWriteReview> MOBILE_WRITE_REVIEW_FORM = Form.form(MobileWriteReview.class); // this field declared as final

public static Result review(){
    MobileWriteReview mobileWriteReview = new MobileWriteReview(4);
    Logger.info("Mobile Write Review grade = " + mobileWriteReview.grade);

    // this is proper way to fill the form using existing value
    return ok(views.html.mobileInviteToReview.render(MOBILE_WRITE_REVIEW_FORM.fill(mobileWriteReview)));
}

public static Result doReview(){
    final Form<MobileWriteReview> filledForm = MOBILE_WRITE_REVIEW_FORM.bindFromRequest();
    MobileWriteReview mobileWriteReview = filledForm.get();
    Logger.info("Grade submitted = " + mobileWriteReview.grade);

    if (filledForm.hasErrors()) {
        // User did not fill everything properly
        return badRequest(views.html.mobileInviteToReview.render(filledForm));
    } else {
        // Everything was filled
        return ok("Grade submitted = " + mobileWriteReview.grade);
    }
} 
```

**意见：**

```
@(inviteForm: Form[models.MobileWriteReview])
@import views.html.helper._

@main(title = "Input Radio Group Sample") {
   @form(action = routes.Application.doReview()) {
      @****** This helper can accomodate selected value of radio button if present *****@
      @inputRadioGroup(
         inviteForm("grade"),
         options = options("1" -> "1", "2" -> "2", "3" -> "3", "4" -> "4", "5" -> "5")
      )

      <input type="submit" value="Post">
    }
} 
```

[请参阅此处](https://www.playframework.com/documentation/2.3.x/api/scala/index.html#views.html.helper.inputRadioGroup$)`inputRadioGroup`的帮助程序文档。

# facebook - 是否可以通过图形 api 或任何其他资源获取所有共享特定帖子的用户 ID？

> ID：15051715
> 
> 赞同：3
> 
> 时间：2013-02-24T12:28:16.397
> 
> 标签：facebook, post, share

我正在寻找一种方法来记录品牌公开帖子的用户 ID。如果有任何可用的资源，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-21T22:03:24.997

Facebook 似乎不正式支持使用 FB API 检索共享数据，但您可以使用[Graph API](https://developers.facebook.com/docs/reference/api/)检索帖子共享，只需执行以下操作：

*   获取您的帖子的 ID（例如 /me/posts 查询）
*   在下划线字符上拆分 ID 并获取第二部分（第一部分标识帖子作者）
*   查询分享：[id_2nd_part]/sharedposts

请注意，由于它不受官方支持，它可能会在将来的某个时候停止工作

您可以使用[Graph explorer](https://developers.facebook.com/tools/explorer)对其进行测试- 要获取共享帖子，如果我没记错的话，您需要对您的访问令牌具有 read_stream 权限

# c++ - strcat 不刷新

> ID：15051724
> 
> 赞同：0
> 
> 时间：2013-02-24T12:29:01.347
> 
> 标签：c++, arduino, strcat

我在arduino中有这个代码

```
void function(int x){
    char* response="GET /postTEST.php?first=";

    char strx[2] = {0};
    int num = x;
    sprintf(strx, "%d", num); 

    original=response;
    strcat(response,strx);
    Serial.println(response);
    //memset(response,'\0',80);
} 
```

基本上，它是将一个整数加入我的帖子字符串。不幸的是，当我增加 i 时，它会以某种方式增长并变成 GET /postTEST.php?first=0 GET /postTEST.php?first=01 GET /postTEST.php?first=012。

怎么来的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T12:31:44.337

您不能修改字符串文字。字符串文字是常量。

您必须将其声明为具有足够空间的数组来添加数字。

你也做了一些不必要的步骤，我建议这样的事情：

```
void function(int x)
{
    char response[64];

    sprintf(response, "GET /postTEST.php?first=%d", x);

    Serial.println(response);
} 
```

# c++ - Dev C++ Windows 模板中的“int main”函数在哪里？

> ID：15051726
> 
> 赞同：-3
> 
> 时间：2013-02-24T12:29:28.003
> 
> 标签：c++, user-interface, main, dev-c++

我正在制作一个 GUI 项目，当我启动时，我想要两个窗口：

一个主窗口，另一个顶部的 SYSMENU 窗口用于创建新项目等。我正在使用模板，我想从两个类中删除主要功能并将其放入不同的 init.cpp 类中。如何？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:04:47.473

Dev C++ 是一个不再使用的旧 IDE。

如果它有一个用于 Windows API 级 GUI 程序的模板，那么该模板很可能有一个 Microsoft 特定的`WinMain`函数，而不是一个标准的 C++`main`函数。

使用 Dev C++ 的默认工具链，即 GNU（g++ 及其链接器），您只需删除 Microsoft 特定的工具链`WinMain`并改用标准`main`。

请注意，使用 Microsoft 的工具链，您必须明确指示链接器接受标准的`main`.

但是，一步一个脚印。

# c# - 富文本框中的列

> ID：15051728
> 
> 赞同：0
> 
> 时间：2013-02-24T12:29:28.943
> 
> 标签：c#, richtextbox

我正在制作一个类似应用程序的微软词，并且正在使用 C#.Net。

我有一个richTextBox 控件，我想要的是我想在richtextbox 中制作2 列，就像我们在2 列中格式化我们的页面一样。

我找不到任何属性或方法来做到这一点。我可以这样做吗？

# html - UL 元素忽略填充

> ID：15051729
> 
> 赞同：1
> 
> 时间：2013-02-24T12:29:31.837
> 
> 标签：html, css

我在这里遇到了一些真正的 CSS 问题……这很奇怪。

我有一个包裹在 Nav 标签中的 UL 元素。我正在尝试对各个链接应用一些填充，并且由于某种原因，填充不会向下移动元素并因此扩展容器。

这是正在发生的事情的屏幕截图：

![CSS填充问题](../Images/4c63287a9ded51c0101eeda2424f50bb.png)

如您所见，浏览器会注意到填充，但它只是与上面的元素重叠（浮动）。我找不到将其向下推的方法，或者至少无法使容器膨胀以正确固定它。

作为参考，我使用 Skeleton 响应式样板作为基础。

这是它的实时链接：[http ://richardsonweb.co.uk/](http://richardsonweb.co.uk/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T12:34:37.363

试穿`display:inline-block;`你的`li`元素

# file-upload - 尝试上传图像时出现编码::UndefinedConversionError

> ID：15051731
> 
> 赞同：2
> 
> 时间：2013-02-24T12:29:48.660
> 
> 标签：file-upload, ruby-on-rails-3.1

我正在使用以下代码将图像上传到我的根 rails 目录的 /public/uploads/ 文件夹中。

```
 uploaded_io = params[:product_image]
 File.open(Rails.root.join('public','uploads', uploaded_io.original_filename), 'w') do |file|
    file.write(uploaded_io.read)
 end 
```

我的表格看起来像这样

```
<%= form_tag({:action => :configure_product}, :multipart => true) do %>
<%= label_tag(:product_image, "Image:") %><br />
<%= file_field_tag 'product_image' %>
<%= submit_tag "Save and add another", :name => 'save and add another' %>
<%= submit_tag "Save", :name => 'save' %> 
<% end %> 
```

但是在尝试提交表单时出现以下错误。

ConfigureCategoryController#configure_product 中的编码::UndefinedConversionError

"\xFF" 从 ASCII-8BIT 到 UTF-8

我将写作模式从“w”替换为“wb”，现在我得到了

ConfigureCategoryController#configure_product 中的 NoMethodError

nil:NilClass 的未定义方法“名称”

新的轨道。肯定会感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T14:33:56.987

您需要通过将 b 附加到 open 类型来将文件作为二进制文件打开。

```
File.open("#{ Rails.root }/tmp/uploaded_image.gif", "wb") do |f| 
```

您遇到的另一个问题特定于您的应用程序所做的任何事情。

# excel - 无法使用插件激活工作簿中的工作表

> ID：15051735
> 
> 赞同：0
> 
> 时间：2013-02-24T12:30:03.343
> 
> 标签：excel, excel-2007, vba

我在加载项中使用了以下代码：

```
Sub MacroToRunOne()

Dim S As String
S = "Hello World From One:"
MsgBox S

Workbooks("86750").Sheets("PIVOT").Activate

End Sub 
```

当我运行此宏时，出现错误：msgbox 语句后的“下标超出范围”。我的激活语句有问题还是不是编码方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:09:00.063

您指的是具有文件名`"86750"`（无扩展名）的工作簿，该文件名不存在。

您的意思是放 , `Workbooks("86750.xlsx")`，它将引用文件名 的（打开的）工作簿`86750.xlsx`。

请注意，如果您提供了一个数字参数，`i`即您将通过所有打开的工作簿的索引`Workbooks(86750)`来请求第 th 个工作簿。`i`然而，这不是你在做什么。

# ruby-on-rails - 帽独角兽：找不到开始任务

> ID：15051736
> 
> 赞同：1
> 
> 时间：2013-02-24T12:30:05.753
> 
> 标签：ruby-on-rails, capistrano, unicorn

现在可以使用以下 cap 命令，但我无法使用`unicorn:start`.

```
cap -vT
cap bundle:install                    # Install the current Bundler environment.
cap deploy                            # Deploys your project.
cap deploy:assets:clean               # Run the asset clean rake task.
cap deploy:assets:clean_expired       # Clean up any assets that haven't been...
cap deploy:assets:precompile          # Run the asset precompilation rake task.
cap deploy:assets:rollback            # to shared/assets/manifest.yml, and fi...
cap deploy:assets:symlink             # [internal] This task will set up a sy...
cap deploy:assets:update_asset_mtimes # [internal] Updates the mtimes for ass...
cap deploy:check                      # Test deployment dependencies.
cap deploy:cleanup                    # Clean up old releases.
cap deploy:cold                       # Deploys and starts a `cold' application.
cap deploy:create_symlink             # Updates the symlink to the most recen...
cap deploy:finalize_update            # [internal] Touches up the released code.
cap deploy:migrate                    # Run the migrate rake task.
cap deploy:migrations                 # Deploy and run pending migrations.
cap deploy:pending                    # Displays the commits since your last ...
cap deploy:pending:diff               # Displays the `diff' since your last d...
cap deploy:restart                    # Blank task exists as a hook into whic...
cap deploy:rollback                   # Rolls back to a previous version and ...
cap deploy:rollback:cleanup           # [internal] Removes the most recently ...
cap deploy:rollback:code              # Rolls back to the previously deployed...
cap deploy:rollback:revision          # [internal] Points the current symlink...
cap deploy:setup                      # Prepares one or more servers for depl...
cap deploy:start                      # Blank task exists as a hook into whic...
cap deploy:stop                       # Blank task exists as a hook into whic...
cap deploy:symlink                    # Deprecated API.
cap deploy:update                     # Copies your project and updates the s...
cap deploy:update_code                # Copies your project to the remote ser...
cap deploy:upload                     # Copy files to the currently deployed ...
cap development                       # Set the target stage to `development'.
cap invoke                            # Invoke a single command on the remote...
cap multistage:ensure                 # [internal] Ensure that a stage has be...
cap multistage:prepare                # Stub out the staging config files.
cap production                        # Set the target stage to `production'.
cap rvm:create_gemset                 # Create gemset
cap rvm:install_gem                   # Install a gem, 'cap rvm:install_gem G...
cap rvm:install_ruby                  # Install RVM ruby to the server, creat...
cap rvm:install_rvm                   # Install RVM of the given choice to th...
cap rvm:uninstall_gem                 # Uninstall a gem, 'cap rvm:uninstall_g...
cap shell                             # Begin an interactive Capistrano session.
cap staging                           # Set the target stage to `staging'.

Extended help may be available for these tasks.
Type `cap -e taskname' to view it. 
```

以下宝石可用

```
gem list --local | grep cap
capistrano (2.14.1)
capistrano-ext (1.2.1)
capistrano-unicorn (0.1.6)
rvm-capistrano (1.2.7) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:49:43.220

看来您在 deploy.rb 中不需要它。

```
require 'capistrano-unicorn' 
```

# android - 如何制作彩色文本视图

> ID：15051737
> 
> 赞同：0
> 
> 时间：2013-02-24T12:30:13.140
> 
> 标签：android, textview, ondraw

您知道使 textview 变得丰富多彩的简单方法，如下图所示？我搜索了太多，但找不到任何有用的东西。

![在此处输入图像描述](../Images/4db653161b1e41e686b8aabecb97e5f5.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T12:34:55.413

您可以使用 Spannable String 来格式化您喜欢的文本 ..Here is the Queston in SO类似于您的要求，但您需要增加字体高度[TextView 中的多色文本](https://stackoverflow.com/questions/14438371/how-do-i-get-show-text-in-my-text-view-with-bold-and-multi-coloured)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:33:02.307

您可以自己绘制所有 10 个数字并将它们显示为图像...

# eclipse - PMD - Eclipse 插件 - 不针对任何规则进行测试

> ID：15051738
> 
> 赞同：4
> 
> 时间：2013-02-24T12:30:13.513
> 
> 标签：eclipse, eclipse-plugin, code-analysis, pmd

我正在使用 Eclipse Juno（Service Release 1）并从[http://sourceforge.net/projects/pmd/files/pmd-eclipse/update-site/](http://sourceforge.net/projects/pmd/files/pmd-eclipse/update-site/)安装了最新版本的 PMD 插件 我可以配置插件并选择应该执行哪些规则，但不幸的是，没有检查任何规则。如果我在 PMD 子菜单中单击“检查代码”，会弹出一个对话框，显示“使用 0 个 xxx 规则检查”

必须配置什么以及在哪里启用该功能？在控制台上，PMD 运行良好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-31T15:13:23.390

1.  首选项 - > PMD（请不要在搜索栏上搜索 PMD，然后您将无法找到规则配置，尝试通过滚动每个首选项来查找）。
2.  选择所需的规则。
3.  单击应用 & 确定（它将重新构建规则）
4.  现在右键单击代码并选择 PMD-> 代码检查

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-20T10:15:25.590

检查是否在项目属性上启用了 PMD。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T16:47:54.623

如果您转到 Eclipse Preferences -> PMD -> Rule Configuration 并取消选中并重新选中所有 Rule Checkboxes 并单击“Apply”框，Eclipse 是否会弹出对话框“Rules settings has changed. Do you want to do a full rebuild? "

如果是这样，请尝试使用 PMD 检查此代码

```
public class BadClass {
    public void badMethod() {
        try {
            String bad = "";            
        } catch (Exception e) {

        }
    }    
} 
```

那应该会显示很多 PMD 错误。如果没有，能否在 Eclipse 目录下找到名为 pmd-eclipse.log 的文件并发布内容？

![我的 PMD 配置的屏幕截图](../Images/7634ecb01a1c17f9764ff57050603910.png)

# php - 用 exec() 并行化 php

> ID：15051739
> 
> 赞同：2
> 
> 时间：2013-02-24T12:30:19.057
> 
> 标签：php, parallel-processing, exec

我想并行化一个我用来读取一些.xml的php程序。我一直在谷歌搜索，并阅读了一些选项：

*   叉子
*   卷曲
*   齿轮工
*   执行

我还认为 exec 是最好的，但我不明白它是如何工作的。谁能解释一下？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:10:25.007

exec 不并行化。它在返回之前等待处理完成。curl 可以使用[curl_multi_init()](http://www.php.net/manual/en/function.curl-multi-init.php)和[curl_multi_exec()](http://www.php.net/manual/en/function.curl-multi-exec.php)进行并行化。[叉子](http://www.php.net/manual/en/function.pcntl-fork.php)是相当低的水平。我不知道[gearman](http://www.php.net/manual/en/book.gearman.php)，我只阅读了[基本用法](http://www.php.net/manual/en/gearman.examples-reverse.php)示例，所以我无法告诉你任何有关它的信息。

# python - 向量化将结果添加到 numpy 数组

> ID：15051742
> 
> 赞同：3
> 
> 时间：2013-02-24T12:30:55.120
> 
> 标签：python, numpy

我有一个像这样工作的函数：

```
def Function(x):
   a = random.random()
   b = random.random()
   c = OtherFunctionThatReturnsAThreeColumnArray()
   results = np.zeros((1,5))
   results[0,0] = a
   results[0,1] = b
   results[0,2] = c[-1,0]
   results[0,3] = c[-1,1]
   results[0,4] = c[-1,2]
   return results 
```

我要做的是多次运行此函数，将返回的一行 5 列结果附加到正在运行的数据集中。但是，据我所知，append 函数和 for 循环的效率都非常低，而且我都在尝试改进我的代码，并且运行次数将足够大，以至于这种低效率对我不起作用任何好处。

执行以下操作的最佳方法是什么，以使开销最小：

1.  创建一个新的 numpy 数组来保存结果
2.  将该函数的 N 次调用的结果插入到 1 中的数组中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:12:52.900

您的想法是正确的，`numpy.append`或者`numpy.concatenate`如果重复多次会很昂贵（这与 numpy 为前两个数组声明一个新数组有关）。

最好的建议（如果您知道总共需要多少空间）是在运行例程之前声明它，然后在结果可用时将其放置到位。

如果你要跑这个`nrows`时间，那么

```
results = np.zeros([nrows, 5]) 
```

然后添加你的结果

```
def function(x, i, results):
    <.. snip ..>
    results[i,0] = a
    results[i,1] = b
    results[i,2] = c[-1,0]
    results[i,3] = c[-1,1]
    results[0,4] = c[-1,2] 
```

当然，如果你不知道你要运行多少次函数，这是行不通的。在这种情况下，我会建议一种不太优雅的方法；

1.  声明一个可能很大的`results`数组并添加到`results[i, x]`上面（跟踪`i`结果的大小和大小。

2.  当您达到 的大小时，请在新数组上`results`执行`numpy.append`（或）。`concatenate`这比重复附加要好，并且不应该破坏性能 - 但是您必须编写一些包装器代码。

您还可以追求其他想法。从我的头顶上你可以

1.  将结果写入磁盘，具体取决于`OtherFunctionThatReturnsAThreeColumnArray`数据的速度和大小，这可能不是一个愚蠢的想法。

2.  将您的结果保存在列表理解中（`numpy`直到运行后才忘记）。如果函数返回 (a, b, c) 没有结果；

`results = [function(x) for x in my_data]`

现在做一些洗牌，把结果变成你需要的形式。

# javascript - 在画布中绘制一个完美的圆形，在铬中具有大的 lineWidth

> ID：15051745
> 
> 赞同：0
> 
> 时间：2013-02-24T12:31:23.743
> 
> 标签：javascript, canvas

我正在 HTML 画布中绘制一个圆圈（r = 100 像素和 500 像素的线宽），使用 .arc 的画布 API 方法用于谷歌浏览器应用程序。

但由于线宽较大，圆圈中的不准确被放大了，看起来不再像一个圆圈了。

这是一个演示~~[http://jsbin.com/ufofor/1/edit](http://jsbin.com/ufofor/1/edit)~~ [http://jsbin.com/ufofor/30/edit](http://jsbin.com/ufofor/30/edit)

```
var c = document.getElementById("canvas");
var g = c.getContext("2d");    
var r = 100;   

g.lineWidth = 500;    
g.arc(505, 505, r,0,2*Math.PI, true);
g.stroke(); 
```

有没有办法/hack 使用 .arc 方法或任何其他方法来制作一个完美的圆圈，在画布中具有大的 lineWidth ？

* * *

编辑

该演示在 Firefox 中运行良好，但在 chrome 中，您会发现生成的圆圈中有不规则性。

[演示的 Chrome 屏幕截图](http://i.imgur.com/ZzF35M2.png)

[Firefox 演示截图](http://i.imgur.com/Jm0BBlJ.png)

感谢@Felix 指出这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:41:46.133

将您的 .arc 代码更改为以下代码会创建一个完美的圆圈 - 该方法的输入似乎有偏差：S

```
g.arc(505, 505, r2, 0, Math.PI / 360, true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:50:08.697

的签名`arc`是

```
arc(x, y, radius, startAngle, endAngle, anticlockwise) 
```

其中`startAngle`和`endAngle`都是[弧度](http://en.wikipedia.org/wiki/Radian)。所以对于一个完整的圈子，你想从到画`0`——`Math.PI * 2`我不知道你从哪里得到的`30`。

此外，您可能想尝试使用`fill()`您的路径，而不是`stroke()`使用那种荒谬的线宽来处理它 - 这与奇数`lineCap`和`lineJoin`值相结合，可能是形状错误的结果的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-30T02:30:32.760

如果有人仍然需要 arc() 函数的“strokeWidth”之类的东西，“我自己的 2 美分”；）

```
// 10 is the strokeWidth for the arc()
for(var i=0; i<= 10; i++){
  context.arc(circleObj.center_x, circleObj.center_y, 50+i, 0, 2*Math.PI);
  context.stroke();
}
```

上面的内容甚至可以在调用“clip()”之前用作掩码；p

希望它至少帮助了一个有需要的灵魂.. ;)

奖金 ==> 我正在做的一件事让我在这里解决你的麻烦，因为我结束了我的：P

--> [https://jsbin.com/xuvogoyizu/edit?js ,输出](https://jsbin.com/xuvogoyizu/edit?js,output)

单击并拖动以控制此“strokeWidth-ed弧形蒙版”的位置；）

# asp.net-mvc - 如何扩展（System.Net.Http）HttpClient Http Verbs？

> ID：15051746
> 
> 赞同：1
> 
> 时间：2013-02-24T12:31:36.823
> 
> 标签：asp.net-mvc, dotnet-httpclient

是否可以向 System.Net.Http HttpClient 添加新的任意 HTTP 动词？

有问题的案例：

我为基于 MVC 的文档管理系统开发了一个 WebAPI。

API 支持：GET - 获取文档，POST - 创建新文档，PUT - 更新文档，DELETE - 删除文档。

我还需要支持：PRINT - 打印文档，EMAIL - 通过电子邮件发送文档。

在 MVC 端添加 VERB 很容易。添加 [AcceptVerbs("PRINT")] 装饰就完成了。

但我需要指导使用我的 API 的开发人员如何访问它。由于他们使用的是 HttpClient，我的问题是：如何使用 HttpClient 使用这些 VERB？

德罗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T14:05:55.807

这些不是标准的 HTTP 动词。我不建议您使用它们。如果您坚持使用它们，您可以使用`SendAsync`允许您指定要使用的 HTTP 动词的方法：

```
using (var client = new HttpClient())
{
    var request = new HttpRequestMessage(new HttpMethod("PRINT"), "http://example.com");
    var result = client.SendAsync(request);
} 
```

# mysql - 这个 MySQL 查询有什么问题——db 不接受？

> ID：15051747
> 
> 赞同：0
> 
> 时间：2013-02-24T12:31:36.303
> 
> 标签：mysql, sql

我有以下 MySQL 查询：

```
INSERT INTO 12:12:12:12:12(timestamp,niceTime,temperature,relative_humidity,wind_speed,gust_speed,rain_mm_per_hour,nsew,str,ip) VALUES(1361707978,'2013-02-24T12:12:58+00:00',0.0,0,0.0,0.0,0.0,0,'1010101010101010','0') 
```

表的名称是“12:12:12:12:12”。

这是架构：

```
"CREATE TABLE IF NOT EXISTS `$mac` (
  `timestamp` int(11) NOT NULL,
  `niceTime` varchar(20) NOT NULL,
  `temperature` float NOT NULL,
  `relative_humidity` int(11) NOT NULL,
  `wind_speed` float NOT NULL,
  `gust_speed` float NOT NULL,
  `rain_mm_per_hour` float NOT NULL,
  `nsew` int(11) NOT NULL,
  `str` varchar(1000) NOT NULL,
  `ip` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;" 
```

无论我做什么，我都无法接受查询；（

```
Query failed: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '12:12:12:12:12(timestamp,niceTime,temperature,relative_humidity,wind_speed,gust_' at line 1 
```

提前谢谢了，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T12:33:35.973

您将对表名 12:12:12:12:12 使用类似的反引号

尝试这个

```
 INSERT INTO `12:12:12:12:12`(timestamp,niceTime,temperature,relative_humidity,wind_speed,gust_speed,rain_mm_per_hour,nsew,str,ip) VALUES(1361707978,'2013-02-24T12:12:58+00:00',0.0,0,0.0,0.0,0.0,0,'1010101010101010','0' 
```

编辑。

命名对象的规则，包括MySql中的表：

[http://dev.mysql.com/doc/refman/5.1/en/identifiers.html](http://dev.mysql.com/doc/refman/5.1/en/identifiers.html)

> 标识符可以以数字开头，但除非引用，否则标识符可能不仅仅由数字组成。

```
The identifier quote character is the backtick (“`”): 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T12:33:26.537

在标识符周围使用反引号，尤其是在使用此类非常规表名时：

```
INSERT INTO `12:12:12:12:12`(timestamp,niceTime,temperature,relative_humidity,wind_speed,gust_speed,rain_mm_per_hour,nsew,str,ip)
VALUES(1361707978,'2013-02-24T12:12:58+00:00',0.0,0,0.0,0.0,0.0,0,'1010101010101010','0') 
```

# .htaccess - .htaccess 目录重定向用于版本发布

> ID：15051754
> 
> 赞同：0
> 
> 时间：2013-02-24T12:32:18.343
> 
> 标签：.htaccess

我有一个想法让我很生气，因为我对 htaccess 不是很好。

我有网址`http://(www./non-www.)example.com/dir/page/file`。但我想将此重定向到目录`root/release/.../dir/page/file`

所以

```
root/.htaccess
root/release/1.0/...
root/release/1.5/...
root/release/2.0/...
root/admin/1.0/...
root/admin/1.5/...
root/admin/2.0/...
etc 
```

如果他们浏览到`example.com/admin`你去`example.com/admin/2.0`。但我认为棘手的一点是我不希望看到 example.com/`release/version`或 example.com/admin/ `version`。

或者我可以只托管两个版本`release/stable`，并且`release/beta`.

我希望这对某人有意义，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:51:27.760

听起来最简单的事情是制作一个像`example.com/admin`元重定向到的页面`example.com/admin/2.0`，然后你只需做一个 mod-rewrite 回到通用 url。当您增加版本时，只需更改元刷新，因为您的 .htaccess mod-rewrite 将具有与您的版本编号系统匹配的 reg-ex。

例子：

首先对于`example.com/admin`文件，在标头中实现元刷新：

```
<meta http-equiv="refresh" content="0;URL='example.com/admin/2.0'"> 
```

现在从 2.0（或任何版本）重新写入到您想去的地方：

```
#first, we need to define the request, in this case, admin/any number
RewriteCond %{THE_REQUEST} /admin/([0-9]*)
# now we need to make it look like it's just the plain admin page
RewriteRule ^$ /admin [R=301,L,NE]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^admin /admin/([0-9]*) [L] 
```

您需要修复我的 reg-ex 匹配以使其成为 2 "point" 0

# java - 从另一个类调用 MainActivity 函数作为 MainActivity

> ID：15051755
> 
> 赞同：-3
> 
> 时间：2013-02-24T12:32:30.247
> 
> 标签：java, android

我想在数据更改后重新加载 MainActivity。所以我写了这段代码，它运行良好。

这是来自 MainActivity，我想重新加载：

```
public class MainActivity extends Activity {
private static final int RESULT_SETTINGS = 1;
LinearLayout horizontalForecast, todayForecast, tomorrowForecast;
TextView ViewSunRise, ViewSunSet, NowTatva, NextTejas, Longitude, Latitude, BeziT, TatvicForecast;
TextView Today, Tomorrow, NextTatva;
GPSTracker gps;
ImageView img;
TabHost th;

public void reload() {
    finish();
    Intent i2 = new Intent(MainActivity.this, MainActivity.class);
    startActivityForResult(i2, RESULT_SETTINGS);
}
} 
```

但是当我从另一个类（不是活动）调用它时，它不起作用。

这是来自另一个类：

```
package com.reversity.simpletatva;

import android.app.AlertDialog;
import android.app.Service;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.os.IBinder;
import android.provider.Settings;
import android.util.Log;

public class GPSTracker extends Service implements LocationListener {

private final Context mContext;

MainActivity MA;
boolean ch = false;

// flag for GPS status
boolean isGPSEnabled = false;

// flag for network status
boolean isNetworkEnabled = false;

// flag for GPS status
boolean canGetLocation = false;

Location location = null; // location
double latitude = Double.NaN; // latitude
double longitude = Double.NaN; // longitude

// The minimum distance to change Updates in meters
private static final long MIN_DISTANCE_CHANGE_FOR_UPDATES = 10; // 10 meters

// The minimum time between updates in milliseconds
private static final long MIN_TIME_BW_UPDATES = 1000 * 60 * 1; // 1 minute

protected static final int RESULT_SETTINGS = 1;

// Declaring a Location Manager
protected LocationManager locationManager;

public GPSTracker(Context context) {
    this.mContext = context;
    getLocation();
}

public Location getLocation() {
    try {
        locationManager = (LocationManager) mContext
                .getSystemService(LOCATION_SERVICE);

        // getting GPS status
        isGPSEnabled = locationManager
                .isProviderEnabled(LocationManager.GPS_PROVIDER);

        // getting network status
        isNetworkEnabled = locationManager
                .isProviderEnabled(LocationManager.NETWORK_PROVIDER);

        if (!isGPSEnabled && !isNetworkEnabled) {
            // no network provider is enabled
        } else {
            this.canGetLocation = true;
            // First get location from Network Provider
            if (isNetworkEnabled) {
                locationManager.requestLocationUpdates(
                        LocationManager.NETWORK_PROVIDER,
                        MIN_TIME_BW_UPDATES,
                        MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                Log.d("Network", "Network");
                if (locationManager != null) {
                    location = locationManager
                            .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
                    if (location != null) {
                        latitude = location.getLatitude();
                        longitude = location.getLongitude();
                    }
                }
            }
            // if GPS Enabled get lat/long using GPS Services
            if (isGPSEnabled) {
                if (location == null) {
                    locationManager.requestLocationUpdates(
                            LocationManager.GPS_PROVIDER,
                            MIN_TIME_BW_UPDATES,
                            MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                    Log.d("GPS Enabled", "GPS Enabled");
                    if (locationManager != null) {
                        location = locationManager
                                .getLastKnownLocation(LocationManager.GPS_PROVIDER);
                        if (location != null) {
                            latitude = location.getLatitude();
                            longitude = location.getLongitude();
                        }
                    }
                }
            }
        }

    } catch (Exception e) {
        e.printStackTrace();
    }

    return location;
}

/**
 * Stop using GPS listener
 * Calling this function will stop using GPS in your app
 * */
public void stopUsingGPS(){
    if(locationManager != null){
        locationManager.removeUpdates(GPSTracker.this);
    }
}

/**
 * Function to get latitude
 * */
public double getLatitude(){
    if(location != null){
        latitude = location.getLatitude();
    }

    // return latitude
    return latitude;
}

/**
 * Function to get longitude
 * */
public double getLongitude(){
    if(location != null){
        longitude = location.getLongitude();
    }

    // return longitude
    return longitude;
}

/**
 * Function to check GPS/wifi enabled
 * @return boolean
 * */
public boolean canGetLocation() {
    return this.canGetLocation;
}

/**
 * Function to show settings alert dialog
 * On pressing Settings button will lauch Settings Options
 * */
public void showSettingsAlert(){
    AlertDialog.Builder alertDialog = new AlertDialog.Builder(mContext);

    // Setting Dialog Title
    alertDialog.setTitle("GPS");

    // Setting Dialog Message
    alertDialog.setMessage("GPS není zapnuta, lokace byla nastavena na 0\. Chcete přejít do nastavení nebo nastavit vlastní?");

    // On pressing Settings button
    alertDialog.setPositiveButton("Nastavení", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog,int which) {
            Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
            mContext.startActivity(intent);
        }
    });

    // on pressing cancel button
    alertDialog.setNegativeButton("Použít vlastní", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {
            Intent i = new Intent(mContext, Preference.class);
            mContext.startActivity(i);
        }
    });

    // Showing Alert Message
    alertDialog.show();
}

@Override
public void onLocationChanged(Location location) {
    /*
    Toast changed = Toast.makeText(mContext, "Location changes", Toast.LENGTH_LONG);
    changed.show();
    MA.reload();
    startActivity(new Intent(mContext, MainActivity.class));
    invalidate();
    */
    stopUsingGPS();
    MainActivity mainActivity = new MainActivity ();
    mainActivity.reload();
}

@Override
public void onProviderDisabled(String provider) {
}

@Override
public void onProviderEnabled(String provider) {
}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {
}

@Override
public IBinder onBind(Intent arg0) {
    return null;
}

public Boolean locChanged(){
    return ch;

}

} 
```

`MainActivity`因此，`GPSTracker Class`当`onLocationChanged();` 我找不到对我有用的答案时，我想重新加载。所以我问这个问题。不要怪我。

我只需要如何调用`MainActivity`从`GPSTracker Class`. 我尝试了我所知道的一切。但它不起作用，应用程序将关闭。

错误`NullPointerException`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:42:46.120

您正在尝试从静态上下文中调用非静态方法。

要么使您的`reload`方法静态，要么使用对 MainActivity 实例的引用（例如`MainActivity myActivity; myActivity.reload()`）

或者，也许您的意思是让 Activity2 扩展 MainActivity？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T13:01:32.877

您需要向第二个类传递对 的引用`MainActivity`，并调用`reload()`该引用。

对于泛型类：

```
public class SecondClass {

    MainActivity mActivity;

    // Constructor where you pass a reference to MainActivity
    public SecondClass(Activity activity) {
        mActivity = activity;
    }

    public onChange() {
        mActivity.reload();
    }
} 
```

当您初始化`SecondClass`in时，`MainActivity`您将引用传递给`MainActivity`

```
SecondClass secondClass = new SecondClass(this); 
```

然后你可以使用`onChange()`，并且`MainActivity.reload()`应该被调用。

```
secondClass.onChange(); 
```

**编辑：**

好吧，既然你更新了你的问题，我的答案不再正确。由于您的第二类是 a `Service`，因此保留对您的引用`MainActivity`可能会造成内存泄漏。

我会通过`BroadcastReceiver`在您的`MainActivity`. 在您的中，您在需要更新时`Service`广播一个。`Intent`

这看起来像这样`MainActivity`：

```
public void MainActivity extends Activity {
    private BroadcastReceiver mReceiver;

    @Override
    public void onCreate(Bundle savedInstanceState) {
       .
       .
       .

       // We listen for a broadcasted Intent with 
       // action = com.example.ACTION_RELOAD_MAINACTIVITY
       IntentFilter filter = new IntentFilter();
       filter.addAction("com.example.ACTION_RELOAD_MAINACTIVITY");

       // Init the receiver
       mReceiver = new BroadcastReceiver() {
           @Override
           public void onReceive(Context context, Intent intent) {                   
               // Reload when we receive the broadcast
               MainActivity.this.reload();
           }
       }

       // Register the receiver
       registerReceiver(mReceiver, filter);
    }

    // In onDestroy() we unregister the receiver
    @Override
    public void onDestroy() {
        unregisterReceiver(mReceiver);
    }
} 
```

在您的`Service`中，您现在必须`Intent`在要重新加载时广播一个`MainActivity`。

```
public class GPSTracker extends Service implements LocationListener {
    .
    .
    .

    @Override
    public void onLocationChanged(Location location) {
        // Create an Intent with 
        // action = com.example.ACTION_RELOAD_MAINACTIVITY
        Intent i = new Intent("com.example.ACTION_RELOAD_MAINACTIVITY");  

        // As a side note; You can use this Intent to send data to MainActivity.
        // If you want to pass the Location object of onLocationChanged() to
        // MainActivity, you would simply call i.putExtra("current_location", location) 
        // The data can then be fetched using the supplied Intent in onReceive().

        // Broadcast that Intent
        sendBroadcast(i);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T13:27:06.403

您可以做什么只需将其添加到您在活动标签内声明主要活动的 Androidmanifest.xml 文件中

```
 android:finishOnTaskLaunch="true" 
```

并`finish();`从 reload 方法中删除。

现在在 GPSTracker 类中只需调用

```
Intent intent=new Intent(mContext,MainActivity.class);
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
mContext.startActivity(intent); 
```

# wpf - MVVM WPF中列表视图复选框的选定项目

> ID：15051763
> 
> 赞同：3
> 
> 时间：2013-02-24T12:33:19.873
> 
> 标签：wpf, listview, mvvm, listviewitem

我想在视图模型中传递列表视图复选框的选定项目，稍后我将使用进一步的过程存储在数据库中。

FormWeek.xaml 中的代码为

```
<Window.DataContext>
        <Binding Source="{StaticResource Locator}" Path="TaskExecDefModel"></Binding>
    </Window.DataContext>
    <Window.Resources>
        <ResourceDictionary>
    <DataTemplate x:Key="ItemDataTemplate">
                    <CheckBox
                x:Name="checkbox"
                Content="{Binding}" Command="{Binding CheckBoxCommand}" CommandParameter="{Binding ElementName=checkedListView, Path=SelectedItems}"                    
                IsChecked="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}, Path=IsSelected}" />
                </DataTemplate>
</ResourceDictionary>

    <StackPanel Grid.Column="1" Grid.Row="3" Margin="5">
                    <CheckBox x:Name="selectAll" Content="Select all" Click="OnSelectAllChanged"/>            

<ListView x:Name="checkedListView" SelectionMode="Multiple" ItemsSource="{Binding CollectionOfDays}"  DataContext="{Binding}"
                      ItemTemplate="{StaticResource ItemDataTemplate}" SelectedValue="WorkingDay"
                      CheckBox.Unchecked="OnUncheckItem" SelectionChanged="SelectDays" SelectedItem="{Binding SelectedItems}">                    
            </ListView>

    </StackPanel> 
```

FormWeek.xaml.cs 中的代码

```
 private void SelectDays(object sender, SelectionChangedEventArgs e)
        {
            (this.DataContext as TaskExecDefinitionViewModel).OnCheckBoxCommand(checkedListView.SelectedItems,true);

        } 
```

我的视图模型TaskWeek.cs如下

//宣言

```
private RelayCommand<object> _checkBoxCommand;

public ObservableCollection<string> CollectionOfDays { get; set; }
public ObservableCollection<string> SelectedItems { get; set; }

 public RelayCommand<object> CheckBoxCommand
        {
            get
            {              
                if (_checkBoxCommand == null)
                {
                    _checkBoxCommand = new RelayCommand<object>((args) => OnCheckBoxCommand(args,true));
                  //  _checkBoxCommand = new RelayCommand(() => OnCheckBoxCommand(object args));
                }
                return _checkBoxCommand;
            }
        } 
```

//构造函数

```
CollectionOfDays = new ObservableCollection<string>(); 
```

//方法

```
private void GetWeekDays()
        {
            try
            {
                Application.Current.Dispatcher.BeginInvoke(DispatcherPriority.Background, new Action(() =>
                    {

                        CollectionOfDays.Add("Saturday");
                        CollectionOfDays.Add("Sunday");
                        CollectionOfDays.Add("Monday");
                        CollectionOfDays.Add("Tuesday");
                        CollectionOfDays.Add("Wednesday");
                        CollectionOfDays.Add("Thursday");
                        CollectionOfDays.Add("Friday");                        
                    }));
            }
            catch(Exception Ex)
            {
                MessageBox.Show(Ex.Message, "TaskWeek:GetWeekDays");
            }
        }

public void OnCheckBoxCommand(object obj, bool _direction)
        {
            try
            {

                if (SelectedItems == null)
                    SelectedItems = new ObservableCollection<string>();

                if (obj != null)
                {
                    SelectedItems.Clear();
                    StringBuilder items = new StringBuilder();

                   if (_direction)
                    {
                        foreach (string item in CollectionOfDays)
                        {

                            items.AppendFormat(item + ",");
                        }
                    }

                    MessageBox.Show(items.ToString());
                   }
                else
                    SelectedItems.Clear();              

            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message, "TaskDefinition:OnCheckBoxCommand");
            }
        } 
```

下面是按钮单击常用来保存数据。

```
<Button Grid.Column="2" Grid.Row="2" Content="Save" HorizontalAlignment="Center" VerticalAlignment="Bottom" 
                Command="{Binding InsertExecDefCommand}"   Margin="5" > 
```

现在我的要求是通过命令对象将选定的列表视图项传递给视图模型。我通过 SelectionChanged 事件在 FormWeek.xam.cs 中使用以下代码完成了此操作

```
private void OnSelectedItems(object sender, RoutedEventArgs e)
        {
            StringBuilder items = new StringBuilder();
            foreach (string item in checkedListView.SelectedItems)
            {
                items.AppendFormat(item + ",");
            }
            string AllDays= items.ToString();
        } 
```

但是请让我知道如何通过 MVVM 来实现这个逻辑。如何在我的视图模型 TaskWeek.cs 中获取选定项目

在研发和谷歌之后，我通过 RelayCommand 完成了 chages。在 OnCheckBoxCommand 方法中，foreach 语句是错误的，它一直在传递。我只想传递选定的列表视图项。请建议我 OnCheckBoxCommand 方法有什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:04:45.703

嗨试试这样

```
 <StackPanel Grid.Column="1" Grid.Row="3" Margin="5">
    <CheckBox x:Name="selectAll" Content="Select all" Command="{Binding CheckBoxCommand}" CommandParameter="{Binding IsChecked, RelativeSource={RelativeSource Mode=Self}}"/>
    <ListView x:Name="checkedListView" SelectionMode="Extended"  ItemsSource="{Binding CollectionOfDays}" SelectedItem="{Binding SelectedItems}"/>
</StackPanel>

public class MainViewModel
{
    public MainViewModel()
    {
        CollectionOfDays = new ObservableCollection<string>();
        SelectedItems = new ObservableCollection<string>();

        CollectionOfDays.Add("Saturday");
        CollectionOfDays.Add("Sunday");
        CollectionOfDays.Add("Monday");
        CollectionOfDays.Add("Tuesday");
        CollectionOfDays.Add("Wednesday");
        CollectionOfDays.Add("Thursday");
        CollectionOfDays.Add("Friday");
    }

    private CommandHandler _checkBoxCommand;

    public CommandHandler CheckBoxCommand
    {
        get
        {
            return _checkBoxCommand ?? (_checkBoxCommand=new CommandHandler((param)=>OnCheckBoxCommand(param)));
        }
    }

    public ObservableCollection<string> CollectionOfDays { get; set; }

    public ObservableCollection<string> SelectedItems {get;set;}

    private void OnCheckBoxCommand(object obj)
    {

        if (obj is bool)
        {
            if (SelectedItems == null)
                SelectedItems = new ObservableCollection<string>();

            if ((bool)obj)
            {
                SelectedItems.Clear();
                foreach (var item in CollectionOfDays)
                {
                    SelectedItems.Add(item);
                }
            }
            else
                SelectedItems.Clear();
        }
    }

}

public MainWindow()
    {
        InitializeComponent();
        DataContext = new MainViewModel();
    } 
```

我希望这会给你一个想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T17:32:43.827

这是我的发现；
在 FormWeek.xaml 后面的代码中使用此代码：

```
 private void SelectDays(object sender, SelectionChangedEventArgs e)
    {
    (this.DataContext as TaskExecDefinitionViewModel).OnCheckBoxCommand(checkedListView.SelectedItems,true);
    } 

```

在'OnCheckBoxCommand'中： -

```
 public void OnCheckBoxCommand(object obj, bool _direction)
    {
        try
        {
            if (SelectedItems == null) SelectedItems = new ObservableCollection<string>();

            if (obj != null)
            {
              SelectedItems.Clear(); 
              var _list = ((IList)obj).Cast<string>().ToList();   
              if (_direction)
              {
                 _list.ForEach(item => SelectedItems.Add(item));
              }
            }
            else
             SelectedItems.Clear();                           
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message, "TaskDefinition:OnCheckBoxCommand");
        }
} 
```

祝你有美好的一天......继续前进。

# c# - 矩形仅在特定网格区域可见

> ID：15051765
> 
> 赞同：0
> 
> 时间：2013-02-24T12:33:34.737
> 
> 标签：c#, wpf, silverlight, xaml, windows-phone-8

![屏幕1](../Images/49e93ea55c79f3abdf8d0fdf4570e7af.png)

如何使绿色矩形仅在蓝色矩形内可见？蓝色是网格的边界。我想切断不在此网格内的所有内容。请注意，绿色矩形将移动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T12:52:06.250

由于 Silverlight 中没有`ClipToBounds`属性，因此您必须将[`Clip`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.clip%28v=vs.95%29.aspx)属性设置为[`RectangleGeometry`](http://msdn.microsoft.com/en-us/library/system.windows.media.rectanglegeometry%28v=vs.95%29.aspx).

当 Grid 的大小固定时，您可以简单地设置一个固定大小的矩形：

```
<Grid>
    <Grid.Clip>
        <RectangleGeometry Rect="0,0,400,600"/>
    </Grid.Clip>
    ...
</Grid> 
```

当 Grid 的大小可以更改时，您可以`Clip`在处理程序中设置属性`SizeChanged`：

```
<Grid SizeChanged="GridSizeChanged">
    ...
</Grid> 
```

处理程序代码：

```
private void GridSizeChanged(object sender, SizeChangedEventArgs e)
{
    ((UIElement)sender).Clip =
        new RectangleGeometry
        {
            Rect = new Rect(0, 0, e.NewSize.Width, e.NewSize.Height)
        };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T14:23:02.790

```
<Grid Width="200" Height="100">       
<Grid.Clip>
    <RectangleGeometry Rect="0, 0, 200, 100"/>
</Grid.Clip> 
```

来源：[http ://www.scottlogic.co.uk/blog/colin/2009/05/silverlight-cliptobounds-can-i-clip-it-yes-you-can/](http://www.scottlogic.co.uk/blog/colin/2009/05/silverlight-cliptobounds-can-i-clip-it-yes-you-can/)

# apache-flex - Flex 为大数据消耗大量内存

> ID：15051767
> 
> 赞同：0
> 
> 时间：2013-02-24T12:33:38.697
> 
> 标签：apache-flex, memory-management, memory-leaks, arraycollection

当使用大量数据（例如 2,00,000 个新引用的对象）处理 flex 数组集合时，flex 客户端浏览器中的内存会猛增 20MB。这个多余的 20MB 与对象中定义的变量无关。一个详细的例子如下所示。

```
var list:ArrayCollection =  new  ArrayCollection;
for(var i:int = 0;i<200000;i++)
{
    var obj:Object = new Object;
    list.add(obj);

} 
```

在执行上述代码时，flex 客户端浏览器内存增加了 20MB。对于不同的场景，我尝试将动作脚本对象添加到数组集合中。动作脚本对象定义如下。

```
public class Sample
{
    public var id:int;
    public var age:int;
    public Sample()
    {
    }

} 
```

在将 200000 个 Sample 类添加到数组集合中时，仍然存在 20MB 内存泄漏。

```
var list:ArrayCollection =  new  ArrayCollection;
for(var i:int = 0;i<200000;i++)
{
    var obj:Sample = new Sample;
    obj.id= i;
    onj.age = 20;
    list.add(obj);

} 
```

我什至尝试将示例对象添加到 flex arrayList 和数组中，但问题仍然存在。有人可以解释一下flex在哪里消耗了这些多余的内存吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:54:46.650

向操作系统请求内存非常耗时，因此 Flash 播放器请求大块内存（超过它实际需要的内存）以最小化这些请求的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T20:11:28.800

我不知道操作系统分配时间是否很重要，我们谈论的是平均 1.5-2GHz Cpu - 甚至是移动设备。但 Benoit 走在了正确的轨道上。一次保留大块主要是为了避免堆碎片。如果一次只以它需要的大小块请求内存，以及其他 IO 请求，系统内存将很快变得高度碎片化。当这些碎片返回到操作系统空间时——除非内存管理器收到相同大小或更小的请求，否则它不能重新分配这个块——从而使其丢失到可见池中。所以为了避免这个问题——Flash（和它的内存管理器）一次请求 16Mb。

在您的情况下，您创建 1 个对象还是 100,000 个对象都没有关系。你仍然会从至少 16Mb 的私有内存开始（也就是你在任务管理器中看到的）。

Flash 播放器分配机制基于 Mozilla MMgc。
你可以在这里阅读：[https ://developer.mozilla.org/en-US/docs/MMgc](https://developer.mozilla.org/en-US/docs/MMgc)

# javafx-2 - 条形图中的 JavaFx 对数轴

> ID：15051768
> 
> 赞同：0
> 
> 时间：2013-02-24T12:33:53.090
> 
> 标签：javafx-2, logarithm

我需要 JavaFx BarChart 中的对数 y 轴。我尝试使用 [valueAxis 的这个实现](http://blog.dooapp.com/logarithmic-scale-strikes-back-in-javafx-20)。该代码似乎是正确的，它在 lineChart 中作为 x 轴工作。但是它不适用于条形图，图中根本没有条形。valueAxis 应该适用于任何类型的图表，所以我认为 BarChart 是问题所在。但我找不到错误。

这是我的代码，我如何测试图表：

```
LogarithmicAxis yAxis = new LogarithmicAxis();
yAxis.setMinorTickVisible(true);
yAxis.setVisible(true);
yAxis.setLabel("label");

chart = new BarChart<String, Number>(xAxis, yAxis);
chart.setAnimated(false);

Series<String, Number> aSeries = new Series<String, Number>();
aSeries.getData().add(new XYChart.Data("test1", Math.log(90)));
aSeries.getData().add(new XYChart.Data("test2", Math.log(100)));

answer = FXCollections.observableArrayList();
answer.addAll(aSeries);
chart.getData().addAll(answer);

chartFxPanel.setScene(new Scene(chart));
chart.layout(); 
```

# php - 为什么从模板文件中的模型调用函数没有输出？

> ID：15051771
> 
> 赞同：0
> 
> 时间：2013-02-24T12:34:25.833
> 
> 标签：php, magento

我是 MVC 和 php 的新手。现在在 magento app/code/core/Mage/Review/Model/Review.php

我添加代码。

```
 public function mgtest(){
        return 'hello world!';
    } 
```

在课堂里

```
class Mage_Review_Model_Review extends Mage_Core_Model_Abstract
{ } 
```

在 magento cms 页面中，我添加代码：

```
 {{block type="core/template" name="review" template="catalog/product/reviewall.phtml"}} 
```

url 键是**review.html**

然后添加文件 reviewall.phtml(app/design/frontend/default/mytheme/template/catalog/product/reviewall.phtml)

然后在其文件中添加测试代码。

```
<?php echo $this->mgtest();?> 
```

当我访问网址时。`mysiteurl/review.html`. 没有 hello world 输出。为什么？谢谢你。如何纠正它？模型中的所有文件是做什么的？如果我想调用 phtml 文件的函数。我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T17:54:24.393

不要编辑核心来添加新功能。`app/code/local`在目录中添加所有添加/修改。

在您现有的代码中，我看到两个问题：

*   CMS页面中的块类型应该是`review/review`而不是`core/template`。
*   您已创建函数 as `matest()`，但将其称为`mgtest()`

您`$this`已从您的 reviewall.phtml 中引用，调用`matest`方法是/应该驻留在`Review_Block_Review`而不是`Core_Block_Template`，因此您的 CMS 块类型必须是`review/review`.

我只是看到你`matest`在你的模型中放置了方法，请将它放在块中，因为你不能使用 $this 直接从模板文件中查看模型。

一旦您知道如何在 Magento 中完成工作，建议您创建自己的自定义模块（在本地目录中）。

# jquery - 如何使用自动十进制（每个）查询输入数组

> ID：15051777
> 
> 赞同：0
> 
> 时间：2013-02-24T12:34:50.500
> 
> 标签：jquery, arrays, forms, decimal

我有一些输入框字段从数据库记录计数循环看起来像这样..

```
<input name="price[]" id="price_1" />
<input name="price[]" id="price_2" />
<input name="price[]" id="price_3" /> 
```

而且我还有一个用于自动十进制的 javascript，如下所示...（此脚本将自动将 2 个十进制 0.00 填充到值中。

```
function autoDecimal(el){
$(el).blur(function(){
    var myNumeric = parseFloat($(this).val());
    if (!myNumeric) {
        $(this).val('0.00');
    } else {
        $(this).val(myNumeric.toFixed(2));
    }
});
} 
```

该脚本仅可完美运行 1 个元素 id，例如

```
autoDecimal('#a'); 
```

但我需要改进它以检查所有带有数组名称的输入框。像这样或比下面的代码更好的东西。

```
$('input['price']).each(function(){
// do auto matic add decimal each input box
}); 
```

如果您有想法，请分享。

谢谢（我在 javascript 或 jquery 方面并不先进）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:38:43.183

```
$('input[name~="price"]').blur(function(){
    var myNumeric = parseFloat($(this).val());
    if (!myNumeric) 
    {
        $(this).val('0.00');
    } 
    else 
    {
        $(this).val(myNumeric.toFixed(2));
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T13:20:43.713

您可以重用函数“自动十进制”，但只需将正确的 jquery 选择器传递给它，就像 slash197 建议的那样：

```
autoDecimal('input[name~="price"]'); 
```

这应该有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T12:41:40.753

**[演示](http://jsfiddle.net/azqEp/)**

```
$("input:text").on("keyup", function(e) {
    var myNumeric = parseFloat($(this).val());
    if (!myNumeric) 
    {
        $(this).val('0.00');
    } 
    else 
    {
        $(this).val(myNumeric.toFixed(2));
    }
}); 
```

# java - netbeans 找不到主类

> ID：15051779
> 
> 赞同：0
> 
> 时间：2013-02-24T12:34:55.740
> 
> 标签：java, netbeans

我正在尝试一个简单的教程

*   将 java 程序连接到简单的 java DB
*   使用 NetBeans 7 IDE。

[这](http://www.homeandlearn.co.uk/java/connect_to_a_database_using_java_code.html)是教程的链接。

但是当我运行该项目时，NetBeans 给了我以下错误：

```
 run:
Error: Could not find or load main class database_console.DBConnect
Java Result: 1
BUILD SUCCESSFUL (total time: 0 seconds) 
```

下面是主类的代码：

```
package database_console;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class DBConnect {
    public static void main(String[] args) {
        try {
          String host = "jdbc:derby://localhost:1527/Employees";
          String uName="faisal";
          String uPass="password";
          Connection con=DriverManager.getConnection(host, uName, uPass);        
        }
        catch ( SQLException err ) {
          System.out.println( err.getMessage( ) );
        }
    }
} 
```

欢迎任何有建议的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T13:13:49.683

不得不从 Netbeans 项目窗格中关闭项目，关闭 netbeans IDE，然后再次启动 netbeans IDE，最后再次打开项目以解决问题。

# android - 以设定的时间间隔发送一系列预定义的短信

> ID：15051783
> 
> 赞同：1
> 
> 时间：2013-02-24T12:35:16.487
> 
> 标签：android, sms, broadcastreceiver, alarm, android-pendingintent

我正在开发我的第一个应用程序，我的目标是从用户设置的日期和时间开始发送一系列预定义的短信，然后在相对于第一个设置的时间（即第一个短信发送，第二个短信在 +3 分钟发送，第 3 条短信在 +7 分钟等时发送）。我已经设法通过使用不同的待处理请求代码一次设置所有警报并为每条消息设置多个广播接收器来做到这一点，但这似乎效率不高。是否可以重用相同的请求代码（以使取消系列成为可能）并在收到来自同一接收器的每个广播后设置警报？代码如下，欢迎提出任何建议。

主要活动

```
 Intent intent = new Intent(MainActivity.this,
                    Receiver1.class);
            intent.putExtra(EXTRA_MESSAGE1, message1);
            intent.putExtra(EXTRA_NUMBER, number);

            Intent intent2 = new Intent(MainActivity.this,
                    Receiver2.class);
            intent2.putExtra(EXTRA_MESSAGE2, message2);
            intent2.putExtra(EXTRA_NUMBER, number);

            PendingIntent sender = PendingIntent.getBroadcast(
                    MainActivity.this, 1, intent, 0);

            PendingIntent sender2 = PendingIntent.getBroadcast(
                    MainActivity.this, 2, intent2, 0);

            // Set alarm for this time
            Calendar cal = Calendar.getInstance();
            cal.set(Calendar.YEAR, mYear);
            cal.set(Calendar.MONTH, mMonth);
            cal.set(Calendar.DAY_OF_MONTH, mDay);
            cal.set(Calendar.HOUR_OF_DAY, mHour);
            cal.set(Calendar.MINUTE, mMinute);

            // Schedule alarm
            AlarmManager am = (AlarmManager) getSystemService(ALARM_SERVICE);
            am.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), sender);

            AlarmManager am2 = (AlarmManager) getSystemService(ALARM_SERVICE);
            am2.set(AlarmManager.RTC_WAKEUP,
                    cal.getTimeInMillis() + 30 * 1000, sender2); 
```

接收器 1

```
public class Receiver1 extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {
    String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE1);
    String number = intent.getStringExtra(MainActivity.EXTRA_NUMBER);

    sendSMS(number, message);
};

// ---sends an SMS message to another device---
private void sendSMS(String phoneNumber, String message) {
    SmsManager sms = SmsManager.getDefault();
    sms.sendTextMessage(phoneNumber, null, message, null, null);
};
} 
```

接收器 2

```
public class Receiver2 extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {
    String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE2);
    String number = intent.getStringExtra(MainActivity.EXTRA_NUMBER);

    sendSMS(number, message);
};

// ---sends an SMS message to another device---
private void sendSMS(String phoneNumber, String message) {
    SmsManager sms = SmsManager.getDefault();
    sms.sendTextMessage(phoneNumber, null, message, null, null);
};
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T14:45:39.517

将“状态”存储在文件、共享首选项或 sqlite 数据库中。然后，当您的应用程序唤醒时，您只需要做一堆工作，您就可以开始使用一个警报和广播接收器。

我在这里有一个简单的 SharedPreferences 示例：

[Android 共享首选项](https://stackoverflow.com/questions/5734721/android-shared-preferences/5734742#5734742)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T06:10:16.753

下面的代码对我来说很好......

```
Thread t = new Thread(new Runnable() {

        @Override
        public void run() {
            // TODO Auto-generated method stub
            try {

                                   for (int count = 1; count <= total_sms; count++) {
                                    Log.i("----------------ppp------------",
                                            "-----working-----------" + count);
                                    SmsManager smsManager = SmsManager.getDefault();
                                    smsManager.sendTextMessage(number1, null,
                                            "Hai this is to test duration", null, null);
                                    Log.i("SMS_COUNT", "Number of sms send---" +count);
                                    Thread.sleep(1000 * (Integer.parseInt(delay)));

                                }

                                 } catch (Exception e) {
                                           e.printStackTrace();
                                 }

        }
    }
    );
    t.start(); 
```

# gwt - GWT - 查找在动态生成的单选按钮列表中选中了哪个按钮

> ID：15051785
> 
> 赞同：0
> 
> 时间：2013-02-24T12:35:34.337
> 
> 标签：gwt

我有一个显示文本字段和单选按钮列表的 for 循环。引用小部件的最佳方法是什么，以便我可以阅读文本字段并找到选中的单选按钮。这是我的循环

```
 for(int x = 0; x<getLoopCount(); x++)
    {
        answerTable.setWidget(x,0, new Label("Answer:"));
        answerTable.setWidget(x,1, new TextBox());
        answerTable.setWidget(x,2, new RadioButton(""));
    } 
```

有没有办法识别每个小部件以便我可以引用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T13:14:52.487

`ValueChangeHandler`您可以`RadioButton`在创建它们时添加一个。

```
for(int x = 0; x<getLoopCount(); x++){

    answerTable.setWidget(x,0, new Label("Answer:"));
    answerTable.setWidget(x,1, new TextBox());

    RadioButton rb = new RadioButton("");
    rb.addValueChangeHandler(new ValueChangeHandler(){
        @Override
        void onValueChange(ValueChangeEvent<Boolean> event){
            // Do something
        }
    });

    answerTable.setWidget(x,2, rb);

} 
```

只有在选中`ValueChangeEvent`时才会触发。如果选中同一组中的`RadioButton`另一个，它将不会触发。`RadioButton`

由于您是`ValueChangeHandler`在创建时添加的，因此`RadioButton`您应该知道如何处理它，而无需为其创建 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T16:36:11.933

我建议将三个小部件组合在一个复合小部件中，如下所示：

```
class AnswerComposite extends Composite {
    private final Label label;
    private final TextBox textBox;
    private final RadioButton radioButton;

    public AnswerComposite() {
        label = new Label("Answer:");
        textBox = new TextBox();
        radioButton = new RadioButton("answerGroup");

        HorizontalPanel contentPanel = new HorizontalPanel();
        contentPanel.add(label);
        contentPanel.add(textBox);
        contentPanel.add(radioButton);

        initWidget(contentPanel);
    }

    public String getText() {
        return textBox.getValue();
    }

    public boolean isSelected() {
        return radioButton.getValue();
    }
} 
```

然后，您可以将它们添加到面板和/或将它们放在这样的列表中：

```
VerticalPanel answersPanel = new VerticalPanel();
List<AnswerComposite> answerComposites = new ArrayList<AnswerComposite>();

for (int i = 0; i < getLoopCount(); i++) {
    AnswerComposite answerComposite = new AnswerComposite();
    answersPanel.add(answerComposite);
    answerComposites.add(answersComposite);
} 
```

然后检查您的小部件变得非常容易：

```
answerComposites.get(i).getText();
answerComposites.get(i).isSelected(); 
```

将 a 添加`ValueChangeHandler`到您`RadioButton`的 s 可能也很方便（请参阅 enrybo 的答案）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T17:10:07.337

让我给你一个临时答案，所以不要关心语法而是算法思想。

1.  扩展 GWT 按钮。

```
 abstract class MyButton
    extends Button{
      // provide the appropriate constructor in impl class,
      // especially if using uibinder

      abstract public void helloDolly(... args ...);
    } 
```

1.  使用 MyButton 实例化所有这些按钮。

    ```
    MyButton[] buttons = {
      new MyButton(){
         public void helloDolly(... args ...){
           Window.alert("allo allo #1");
         }
      },

      new MyButton(){
         public void helloDolly(... args ...){
           Window.alert("allo allo #2");
         }
      },

      // blah blah black sheep ....
    } 
    ```

2.  定义处理程序时使用 clickEvent.getSource()。

    ```
    buttons[i].addEventHandler(
      new ClickHandler(ClickEvent click){
        Object src = click.getSource();
        if (src !instanceOf MyButton){
           throw new MyAngryException("For goodness' sake, pls use MyButton");
           // or ignore
           return;
        }

        ((MyButton)src).helloDolly(... args ...);
      }
    ) 
    ```

# php - 使用表单上的两个按钮将按钮值传递给 AJAX/PHP 脚本

> ID：15051786
> 
> 赞同：0
> 
> 时间：2013-02-24T12:35:42.210
> 
> 标签：php, ajax, forms, button

我有一个使用 AJAX 脚本链接到 PHP 脚本的表单。到目前为止，我只有一个提交按钮来处理将值传递给 PHP 脚本以生成电子邮件发送的表单。现在我想在表单上有两个选项，要么发送电子邮件，要么在发送之前先查看电子邮件。我认为拥有两个具有相同类的按钮来触发 AJAX/PHP 脚本将是可行的方法。每个按钮可以有不同的值，并且根据该值，脚本可以以不同的方式运行。

我不确定使用两个按钮是否是处理此问题的最佳方式。如果是这样，我不确定如何处理按钮中的值。是否只有被点击的按钮的值被传递？

我的表单中的其余值按以下方式处理（因为页面上有多个表单）：

```
var form_data = {
    name: $jform.find("[id^=name]").val(),
    date: $jform.find("[id^=date]").val(),
    time: $jform.find("[id^=time]").val(),
}; 
```

我如何包含按钮的值？会有两个按钮看起来像这样：

```
echo "<button type='submit' class='submit_s' value='view'>View</button>";
echo "<button type='submit' class='submit_s' value='email'>Email</button>"; 
```

大概我不能有两个具有相同 id 的按钮，正如我之前提到的，我不确定当我单击一个按钮时是否都传递了两个按钮值。

我希望能够在 AJAX 脚本中做这样的事情：

```
if (button == 'email') {
    $jform.fadeOut(800);
} 
```

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:55:35.723

您的输入按钮必须具有不同的名称。

```
echo "<button type='submit' name="name1" class='submit_s' value='view'>View</button>";
echo "<button type='submit' name="name2" class='submit_s' value='email'>Email</button>"; 
```

在此之后，您可以在表单中执行此操作

```
$jform.find("input[name=name1]").click(function() { 
     $jform.submit();
}) 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T13:16:45.643

使用 JS 函数来设置公共字段的值，以跟踪按下了哪个按钮。

添加代码以获取将由我们的 JS 函数设置的新字段：

```
var form_data = {
    name: $jform.find("[id^=name]").val(),
    date: $jform.find("[id^=date]").val(),
    time: $jform.find("[id^=time]").val(),
    button: $jform.find("[id^=button]").val(),
}; 
```

我们新的 JS 函数来设置隐藏字段的值：

```
function setHiddenButtonValue(buttonValue)
{
    $("#button").value = buttonValue;
    return true;
} 
```

将 onclick 事件添加到我们的按钮，以便在单击时更新隐藏字段。同时绘制新的隐藏字段：

```
echo "<input type='hidden' id='button' value='' />";
echo "<button type='submit' class='submit_s' value='view' onclick='return setHiddenButtonValue(this.value);'>View</button>";
echo "<button type='submit' class='submit_s' value='email' onclick='return setHiddenButtonValue(this.value);'>Email</button>"; 
```

# android - 如何在不刷新 Android TextView 的情况下为其设置动画，并每次都用数组中的新文本填充它？

> ID：15051788
> 
> 赞同：0
> 
> 时间：2013-02-24T12:36:26.780
> 
> 标签：android, animation, textview

我愿意在 android 应用程序中创建一个新闻栏，并使用动画将 TextView 从左向右移动，并在每一轮中用字符串数组中的新文本填充它。我遇到了很多问题，我使用了超过 5 种方法，但每一种都有不好的行为。主要问题是动画结束时它会刷新 textView 并且看起来像闪烁，这不是用户友好的行为。

这是一个代码片段：

```
 TextView my_text;
     Animation slideRight;      
     Animation slideLeft;
     String [] text = {"TwoOneOneOneOneOneOneOneOneOneTwo","OneTwoTwoTwoTwoTwoTwoTwoTwoTwoTwoOne",
        "OneThreeThreeThreeThreeThreeThreeThreeOne","OneFourFourFourFourFourFourFourOne",
        "OneFiveFiveFiveFiveFiveFiveFiveOne","OneSixSixSixSixSixSixSixOne",
        "OneSevenSevenSevenSevenSevenSevenSeveOne","OneEightEightEightEightEightEightEightOne",
        "OneNineNineNineNineNineNineNineOne"};

     int arr_length;
     int count = 0;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    arr_length = text.length;

    slideRight = AnimationUtils.loadAnimation(this, android.R.anim.slide_out_right);

    slideRight.setDuration(2000);
    slideRight.setRepeatCount(Animation.INFINITE);
    slideRight.setAnimationListener(slideRightListener);
    slideLeft = AnimationUtils.loadAnimation(this, android.R.anim.slide_in_left);
    slideLeft.setDuration(2000);
    slideLeft.setAnimationListener(slideLeftListener);

    my_text = (TextView) findViewById(R.id.textView1);
    my_text.setVisibility(TextView.VISIBLE);
    my_text.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {       
            Toast.makeText(getApplicationContext(), my_text.getText(), Toast.LENGTH_SHORT).show();
        }
    });

    slideLeft.setAnimationListener(slideLeftListener);
    my_text.startAnimation(slideLeft);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

AnimationListener slideLeftListener = new AnimationListener() {

    @Override
    public void onAnimationStart(Animation animation) {
        my_text.setVisibility(TextView.VISIBLE);

    }

    @Override
    public void onAnimationRepeat(Animation animation) {
        my_text.setVisibility(TextView.VISIBLE);

    }

    @Override
    public void onAnimationEnd(Animation animation) {
        my_text.setVisibility(TextView.VISIBLE);
        my_text.startAnimation(slideRight);
    }
}; 

AnimationListener slideRightListener = new AnimationListener() {

    @Override
    public void onAnimationStart(Animation animation) {
        my_text.setVisibility(TextView.VISIBLE);
    }

    @Override
    public void onAnimationRepeat(Animation animation) {
        my_text.setVisibility(TextView.VISIBLE);
    }

    @Override
    public void onAnimationEnd(Animation animation) {
        my_text.setVisibility(TextView.VISIBLE);
        if(count<arr_length)
        {               
            my_text.setText(text[count]);
            count+=1;
            my_text.startAnimation(slideLeft);
        }
        else
        {
            count=0;
            my_text.setText(text[count]);
            my_text.startAnimation(slideLeft);
        }

    }
}; 
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-20T03:18:08.287

我认为 ViewFlipper 更适合你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T14:42:17.993

尝试添加 setFillAfter(true) ，因为这可能会在动画结束时停止“刷新”行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T07:07:23.070

正如我在上面对@Bill 的评论，我意识到刷新问题与 Android 版本有关。

我已经在带有 Android Ice-Cream-Sandwich 的设备上测试了上面相同的代码，但它没有“刷新”。

如果对非 ICS 有任何解决方案，我会接受。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-05T11:40:17.167

我有[这个链接](https://github.com/blessenm/SlideshowDemo)，我发现它对我来说很棒，可以根据我的要求进行定制。它使用水平幻灯片。

# c++ - 从 xml QT 4.8 C++ 获取类型

> ID：15051791
> 
> 赞同：0
> 
> 时间：2013-02-24T12:37:00.967
> 
> 标签：c++, xml, qt, load, xmlreader

我制作了这个程序，其中您有某种数据，用户可以选择哪种类型。用户保存他的工作，并且在 xml 保存文件中我想写他使用什么类型的变量，所以当我必须打开保存时，我的程序分配了正确的数据示例模板：

C++：

```
template <class T>
class Data{
private:
T variable;
...
}; 
```

XML:

```
<header>
  <type>int</type>
</header> 
```

所以在这里，当我加载保存文件时，我想`Data<int>`分配一个...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T08:28:06.840

您需要创建工厂，以及将值名称（以字符串形式）“映射”到其中一个工厂的管理器。像这样：

```
class AbstractData {}

template <class T>
class Data : public AbstractData {
private:
    T variable;
    ...
};

class FactoryManager
{
    ...
    typedef std::function< AbstractData* () > Factory;   

    void registerFactory( const QString& name, const Factory& factory )
    {
        //  Check to see one is not already registered before adding.
        map_.insert( name, factory );
    }

    AbstractData* createData( const QString& name )
    {
        //  Check factory exists first.
        return map_[name]->createData();
    }

private:
    QHash< QString, Factory > map_;
}

...
FactoryManager manager;
manager.registerFactory( "int", [](){ return new Data< int >; } );
...
Data< int >* data = manager.createData( "int" ); 
```

# c++ - sscanf c++ 将字符串拆分为整数有时不起作用

> ID：15051794
> 
> 赞同：4
> 
> 时间：2013-02-24T12:37:15.973
> 
> 标签：c++, string, split, int, scanf

我正在编写一个程序，将日期字符串转换为三个独立的 int 变量：年、月、日。

```
int m,d,y;
sscanf("2011-03-08","%i %*[-] %i %*[-] %i",&y,&m,&d);
cout << y<<" "<<m<<" "<<" "<<d<<std::endl;
sscanf("2011-03-07","%i %*[-] %i %*[-] %i",&y,&m,&d);
cout << y<<" "<<m<<" "<<" "<<d; 
```

如果我转换 2011-03-08 或 2011-03-09，那么这一天将为 0，但对于 2011-03-07,06，……这一天是 7,6，……正如我所料。有人可以解释一下，为什么它不适用于 08 或 09 并且仅适用于他们？

先感谢您！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T12:48:02.147

看[`sscanf`](http://man7.org/linux/man-pages/man3/sscanf.3.html)

> **i**
> 匹配一个可选的有符号整数；下一个指针必须是指向 int 的指针。如果整数以 0x 或 0X 开头，则以 16 为基数读取，如果以 0 开头，则以 8 为基数读取，否则以 10 为基数读取。仅使用与基础相对应的字符。

`08`将被扫描为八进制整数，因为它以`0`. But`08`不是有效的八进制整数，而`07`is。如果您使用`%d`而不是`%i`，它将按预期工作。

```
sscanf("2011-03-08","%d %*[-] %d %*[-] %d", &y, &m, &d); 
```

甚至更简单

```
sscanf("2011-03-08","%d-%d-%d", &y, &m, &d); 
```

* * *

根据您想要对结果执行的操作，您还可以考虑[`strptime`](http://man7.org/linux/man-pages/man3/strptime.3.html)

> strptime - 将时间的字符串表示形式转换为时间 tm 结构

```
struct tm t;
strptime("2011-03-08, "%Y-%m-%d", &t); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T12:50:17.837

问题在于`%i`将`08`其视为八进制整数，因此可能的解决方案是使用`%d`，**但**由于这是 C++，您应该使用[`std::istringstream`](http://www.cplusplus.com/reference/sstream/istringstream/)( `#include <sstream>`) 代替：

```
int y,m,d;
char delimiter;

std::istringstream dateStream("2011-03-08");
dateStream >> y >> delimiter >> m >> delimiter >> d;

std::cout << y << " " << m << " " << d; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T12:49:48.107

你的格式字符串是错误的......它应该只是`"%4d-%02d-%02d"`

检查 sscanf 是否也可以与`if (3 != sscanf(...)) { /* failed */ }`

# c++ - 在这种情况下如何适当使用 RAII/减少内存泄漏

> ID：15051795
> 
> 赞同：2
> 
> 时间：2013-02-24T12:37:22.297
> 
> 标签：c++, opengl, renderer

我不确定如何在我所拥有的情况下充分利用 RAII。这是这种情况：

我正在创建一个基本的渲染器。几何由 Geometry 类描述，该类可能添加了顶点。为了将几何对象用于渲染，必须首先对其进行编译（即将为几何创建一个 VBO）。几何对象的编译（和反编译）是通过渲染器对象完成的，一旦完成几何对象，就必须进行反编译。如果不进行反编译，就会出现内存泄漏。

这是我所描述的示例：

```
Renderer renderer; // the renderer object

{
    Geometry geometry;

    // add vertices
    // and play around with material, etc.

    if(!renderer.compile(geometery); // compile the geometery, so we can use it
    {
        cerr << "Failed to compile geometry!\n";
    }

    // now we can use it...
    renderer.render(geometry, RenderType::TriangleStrips);

} // if I don't call renderer.decompile(geometry) here, I will get a leak 
```

我要做的是反编译我的几何图形，而不明确告诉渲染器反编译它。这是为了简单地减少内存泄漏。我的第一个想法是使用 RAII，但如果我这样做，Geometry 类将需要 Renderer 类，这看起来很混乱。因为我需要一个对编译几何图形的渲染器对象的引用。

我想到的另一种选择是让渲染器创建几何图形，但这会导致动态分配几何对象（即使用new），而且看起来也很混乱。

我还想过在几何图形中放置一个句柄对象，例如将 unique_ptr 放在抽象句柄对象中。

例如

```
class GeometeryHandle
{
   virtual ~GeometeryHandle() = 0; 
}; 
```

这实际上可能有效，因为它也可以用于存储`GLuint`手柄内。我不确定这是否合适，因为我可以直接通过渲染器引用简单地反编译几何。即如果我直接通过析构函数调用它，它会做同样的事情。

我应该如何适当地设计它，以免我不小心不反编译几何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T13:12:38.510

目前尚不清楚谁应该对您的设计中的内容负责。这是弄清楚如何使用任何形式的资源管理的第一步：决定谁负责什么。

例如，您说“几何由几何类描述，该类可能添加了顶点”。好的，但这与编译后的数据有什么关系？如果用户`Geometry`在编译后添加顶点，这些顶点是否会自动放置在编译数据中？或者编译后的数据是否与类完全分开`Geometry`，这样对类的更改`Geometry`不会更新编译数据？

在我看来，您将两个非常不同的想法混为一谈：`GeometryBuilder`和`Renderable`. `GeometryBuilder`是您将顶点数据放入的内容。然后你把它`Renderable`拿出来创造一个。是`Renderable`存储在`GeometryBuilder`. 该对象完全独立于`GeometryBuilder`创建它的对象。这`Renderable`是您实际可以渲染的内容。

所以你会这样做：

```
GeometryBuilder meshBuilder;

meshBuilder.AddVertex(...);
...

Renderable renderMesh = render.CreateRenderable(meshBuilder); 
```

在这点之后，`meshBuilder`独立于`renderMesh`。你可以删除一个，另一个很好。`renderMesh`您可以多次“编译”并获得相同数据的相同副本。等等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-24T13:00:30.960

## 方法一：

您可以使用辅助类：

```
class CompileHandler
{
    private:
        Geometry& g;
        Renderer& r;
    public:
        CompileHandler(Geometry& _g, Renderer& _r) : g(_g), r(_r) 
        {
        }
        ~CompileHandler()
        {
            r.decompile(g);
        }
}; 
```

您可以通过以下方式使用它：

```
{
    Geometry geometry;
    CompileHandler ch(geometry,renderer);

    // add vertices
    // and play around with material, etc.

    if(!renderer.compile(geometery); // compile the geometery, so we can use it
    {
        cerr << "Failed to compile geometry!\n";
    }

    // now we can use it...
    renderer.render(geometry, RenderType::TriangleStrips);
// decompilation is automatic on destruction of the CompileHandler object
} 
```

## 方法二：

创建更健壮的层次结构：

```
GeometryCompiler
   ^
   |
   | inherits
   |
Renderer 
```

在几何体编译时，几何体编译器（这里是渲染器）通知几何体它已经被编译（并`GeometryCompiler`在几何体内部设置一个指向它的指针，编译器）。然后，在破坏几何时，如果指针不为空，则可以要求`GeometryCompiler`反编译它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T13:08:46.250

RAII 要求 dstructors 执行“撤消”操作。

在您的情况下，几何体被破坏，但渲染仍然存在。您拥有的唯一触发器是几何析构函数，它应该知道编译了什么渲染，调用他进行反编译。

但是由于几何的目的不是要了解 rederes，因此您很可能需要一个帮助类（我们称之为它`Compile_guard`），它应该在几何完成后立即实例化，将 Geometry 和 Render 作为参数，并调用 Render::compile在构造和 Render::decompile 销毁时：

```
Renderer renderer; // the renderer object

{
    Geometry geometry;

    // add vertices
    // and play around with material, etc.

    Compile_guard guard(render, geometry);

    if(!guard); // Invalid compilation ....
    { 
        cerr << "Failed to compile geometry!\n";
        return; // this is exception safe!
    }

    // now we can use it...
    renderer.render(geometry, RenderType::TriangleStrips);

} //here guard will decompile 
```

关于 Compile_guard，它可能类似于

```
class Compile_guard
{
public:
   Compile_guard(Render& r, Geometry& g) :render(&r), geometry(&g), good(false)
   { good = render->compile(*geometry); }

   ~Compile_guard()
   { if(good) render->decompile(*geometry); }

   explicit operator bool() const { return good; }

   Compile_guard(const Compile_guard&) =delete;  //just avoid copy and assign.
   Compile_guard& operator=(const Compile_guard&) =delete;
private:
   Render* render;
   Geometry* geometry;
   bool good;
}; 
```

# javascript - 谷歌地图只显示半屏？

> ID：15051796
> 
> 赞同：4
> 
> 时间：2013-02-24T12:37:29.557
> 
> 标签：javascript, google-maps, google-maps-api-3

谷歌地图只显示一半的屏幕。我尝试使用调整大小进行修复： `google.maps.event.trigger(map, "resize");`但没有任何运气。

任何人都可以帮忙吗？

当它加载时，它只显示一半的屏幕，如您在此处看到的：

![在此处输入图像描述](../Images/1250e27dc0dcd373fe76806a505fcc03.png)

我已经搜索和搜索没有任何解决方案。

```
$(function () {
    var geocoder = new google.maps.Geocoder();
    var locations = [{
        location: "Brogade Odense Danmark",
        image: "brodate.png",
        text: "This is nice",
        reward: 20
    }, {
        location: "Christiansgade, Odense, Danmark",
        image: "kochsgrade.png",
        text: "Uber nice",
        reward: 100
    }, {
        location: "Overgade Odense Danmark",
        image: "overgrade.png",
        text: "smooooth :)",
        reward: 2000
    }];
    var cc = "";
    var markers = [];
    var infowindow = new google.maps.InfoWindow();
    var map;
    var userPosition = new google.maps.LatLng(55.4000, 10.3833);
    var defaultLocation = "Brogade Odense Danmark";

    //Reset all marker to defeault except the one whose id = id
    function resetMarker(id) {
        for (var i = 0; i < locations.length; i++) {
            if (markers[i].id !== id) {
                //reset marker to default
                markers[i].setIcon(locations.image);
            } else {
                markers[i].setIcon(locations.image);
            }
        }
    }

    function get_user_position() {

        geocoder.geocode({
            address: defaultLocation
        }, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                var latLng = results[0].geometry.location;

                map.setCenter(latLng);

                for (var i = 0; i < locations.length; i++) {
                    addLocation(locations[i], i);
                }

            }

        });

    }

    function addLocation(location, i) {
        geocoder.geocode({
            address: location.location
        }, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                //Get position of addres
                latLng = results[0].geometry.location;
                //create new marker
                var marker = new google.maps.Marker({
                    position: latLng,
                    map: map,
                    id: i
                });
                //add marker to the array
                markers[i] = marker;

                //call back event click
                google.maps.event.addListener(marker, "click", function () {
                    resetMarker(i);
                    infowindow.setContent("<table><tr><td><img src=\'" + location.image + "\' height=50 width=50></td><td width=\'10\'></td><td><small>" + location.text + "</small><br><strong>$" + location.reward + " reward</strong><br /><a href=\'#\' class=\'btn btn-small btn-success\'>View listing</a></td></tr></table>");
                    infowindow.open(map, marker);
                    marker.setIcon(location.image);
                });

            }
        });
    }

    function init_map() {
        //The initial map option
        mapOptions = {
            center: userPosition,
            zoom: 15,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }

        //Init map
        map = new google.maps.Map(document.getElementById("map"), mapOptions);

        get_user_position();

    }

    $(document).ready(function () {

        init_map();
        $("#map").hide();
        google.maps.event.trigger(map, "resize");
        map.setZoom(map.getZoom());
        $("#map").show();

    });
}); 
```

用于防止引导失败的 CSS：

```
 <style>#map label { width: auto; display:inline; }
   #map img { max-width: none; }</style> 
```

这是我的 div 与地图：

```
 <div id="map" class="right"  target="_blank" style="width:960px;height:350px"> </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T13:01:55.650

显示地图**后**触发调整大小事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-15T14:06:32.127

您可以在加载地图之前检查 DOM 是否已经存在

```
setTimeout(function checkDomElement() {
    var overviewMapContainer = document.getElementById('googlemaps_overview');
    if (document.body.contains(overviewMapContainer)) {
        google.maps.event.addDomListener(window, 'load', initializePhilippines(imrGlobal.imrLatitude, imrGlobal.imrLongitude));
    } else {
        console.log($('#googlemaps_overview').css('height'));
        setTimeout(checkDomElement, 30);
    }
}, 30); 
```

# ios - 如何在 iOS 中计算对数？

> ID：15051797
> 
> 赞同：1
> 
> 时间：2013-02-24T12:37:48.940
> 
> 标签：ios, objective-c, ios6

我需要计算 Log（以 10 为底）和 Log（以 e 为底 - Naperian/Natural）。

我现在假设 Log (base 10) 是：

```
double log10 ( double ); 
```

我是否正确假设 Log (base e – Naperian/Natural) 只是：

```
 double log ( double ); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:53:32.260

检查`man 3 log`手册页。在 iOS 6 中还有[vecLib](https://developer.apple.com/library/ios/#documentation/Performance/Conceptual/vecLib/Reference/reference.html#//apple_ref/doc/uid/TP40002498)，它具有对数函数。

# c# - 从数据网格视图中检索数据的格式异常

> ID：15051801
> 
> 赞同：-1
> 
> 时间：2013-02-24T12:38:15.457
> 
> 标签：c#, datagridview, formatexception

我有一个数据网格视图，其中有一列引文数。我正在尝试使用此代码从列中检索数据，但它会引发*格式异常*异常，请帮助这是我的代码：

```
 int GSCitations = int.Parse(Convert.ToString(row.Cells[2].Value)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:44:07.913

这只能意味着， 的内容`row.Cells[2]`不是有效的整数，不能转换为`int`.

改用 [Int32.TryParse](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx) _

# gtk - 构建和安装 GTK 库

> ID：15051817
> 
> 赞同：-3
> 
> 时间：2013-02-24T12:41:03.580
> 
> 标签：gtk, embedded-linux

我需要构建和安装 GTK 库，所以我需要它的源代码。所以我搜索并来到这个包含它的 GIT 集线器路径的链接。
[http://www.gtk.org/download/](http://www.gtk.org/download/)

这个程序正确吗？

```
git clone git://git.gnome.org/gtk+
cd gtk+
./configure
make
make install 
```

1> 根据链接，它声明它需要一些库。我是否需要为 ---> 执行相同的步骤 `glib, pango, gdk-pixbuf and atk`。
2> 是否`cairo`附带`pango`或必须单独下载、构建和安装？
3> 我需要`xlib`吗？

请建议`what all dependency packages are required by GTK ?`我必须单独编译和安装。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:47:50.803

这篇文章应该让您全面了解构建 GTK+ 所需的内容

[http://developer.gnome.org/gtk3/stable/gtk-building.html](http://developer.gnome.org/gtk3/stable/gtk-building.html)

# android - 如何使不同的TextView不同颜色

> ID：15051823
> 
> 赞同：0
> 
> 时间：2013-02-24T12:42:00.660
> 
> 标签：android, eclipse, colors

嗨，有没有一种方法可以在我的 textview 中使我的 textview 中的文本不止一种不同的颜色？像一些文本颜色是绿色的，而另一部分是红色的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T12:52:32.077

> 我的文本视图中的文本不止一种不同的颜色

```
TextView textView = (TextView)findViewById(R.id.textView);
String text = "<font color='green'>Green</font><font color='red'>Red</font>.";
textView.setText(Html.fromHtml(text), TextView.BufferType.SPANNABLE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T13:05:26.757

希望这可能会有所帮助：[点击这里](http://www.chrisumbel.com/article/android_textview_rich_text_spannablestring)

# java - 红黑树 - 黑色高度限制

> ID：15051824
> 
> 赞同：5
> 
> 时间：2013-02-24T12:42:10.497
> 
> 标签：java, c++, algorithm, tree

我正在阅读有关[Red-Black Trees 的](https://en.wikipedia.org/wiki/Red-black_tree)wiki 。

有人可以详细说明第五个限制：

> 1.  一个节点要么是红色的，要么是黑色的。
>     
>     
> 2.  根是黑色的。
>     
>     
> 3.  所有叶子 (NIL) 都是黑色的。（所有叶子的颜色都与根相同。）
>     
>     
> 4.  每个红色节点的两个孩子都是黑色的。
>     
>     
> 5.  从给定节点到其任何后代叶子的每条简单路径都包含相同数量的黑色节点。

我很难理解它，因为在[*插入*](https://en.wikipedia.org/wiki/Red-black_tree#Operations)[的最后一个案例](https://en.wikipedia.org/wiki/Red-black_tree#Operations)*（wiki 上的案例 5）之后给出示例 RBT 的状态给我们：*

 *![Wiki 红黑树](../Images/b60868414d2e8695d1e279e3e8fdf08b.png)

4 和 5 的黑色节点不是比 1,2 和 3 多一个吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T14:19:17.380

1、2、3、4、5都是子树。我们知道树 1、2 和 3 中根节点的颜色为黑色。我们不知道节点 1-5 中的任何一个是否是叶节点，因为这种插入情况可能已经在某个作为新插入节点的祖父母的 N 上递归调用（来自插入情况 3）。

旋转前后，子树 1、2、3 都在一个黑色节点之下（G before，P after），子树 4 和 5 在两个黑色节点之下（G 和 U before，P 和 U after）。子树 1、2 和 3 分别比子树 4 和 5 多一个黑色节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T12:57:36.793

刚仔细看了下，图好像有问题。

由于`N`是刚刚插入的节点，这意味着在最后一个节点之前`insert`有`P`子 [1,3] 或 [2,3] （并且插入分别为 2 或 1）。所以在这种情况下，在最后一次插入之前`P`，`U`必须是红色的（而 4,5 是黑色的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T18:07:33.447

恭喜 James 破译了 Wiki 图！没有错，只是模棱两可。

该页面的“谈话”选项卡提到“三角形不是代表叶子而是代表子树。一些子树的顶部有黑色圆圈，表示它们的根必须是黑色的。”

显然，没有圆圈的三角形代表子树（包括叶子），其根节点的颜色和树的深度是未知的（并且可能不相关）。

因此，这些图表根本没有提供足够的信息来判断是否违反了“规则 5”。我们必须将其视为既定事实，事实并非如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-24T00:53:15.463

NIL 节点配置是完全可选的。它们是黑色的唯一原因是因为您希望默认保存额外的红色节点。以后可以根据需要将它们变为红色。

分配的黑色节点增加了黑色高度，这也是一个可选的高度差。因为必须在某处记录 NIL 标志，所以可以将其分配为黑色节点。

只能节省 1bit 地址空间；通常系统非常接近其极限。*

# ajax - 编辑后更新部分视图

> ID：15051825
> 
> 赞同：0
> 
> 时间：2013-02-24T12:42:36.793
> 
> 标签：ajax, asp.net-mvc, asp.net-mvc-3, razor, asp.net-ajax

我有以下索引：

```
<div id='addProduct'>
   @{ Html.RenderPartial("Create", new BoringStore.Models.Product()); }
</div>

<div id='productList'>
    @{ Html.RenderPartial("ProductListControl", Model.Products); }
</div> 
```

部分 Create 视图包含一个不可见的 div，用于创建新产品。这样做之后，部分视图 ProductListControl 将被更新。

现在我想使用编辑功能来做到这一点。问题：无法在加载索引时集成编辑页面，因为此时我不知道用户要编辑哪个产品。

我的想法：我想在 jquery 模式中调用我现有的编辑视图（不是问题），以便用户可以执行更改。保存模式后关闭（仍然不是问题 - 我可以处理这个）并且 ProductListControl 被更新（这是我的问题...... :()。

我怎么能这样做？我看过一些教程，但我想让它尽可能干净和简单。他们中的大多数都在使用 dom 操作并通过 JsonResult 从服务器（控制器）获取反馈。如果可能的话，我想坚持使用剃刀语法，没有纯 JavaScript 或 jquery，如果可能的话，我想避免使用 JsonResults。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T14:58:19.630

一种方法可能是使用 Ajax.BeginForm 创建产品视图。

Ajax.BeginForm 接受许多 AjaxOptions，其中一个是 UpdateTargetId（您的 DOM id，在本例中是您的产品列表 div），更多信息请[点击此处](http://msdn.microsoft.com/en-us/library/system.web.mvc.ajax.ajaxoptions%28v=vs.108%29.aspx)。

然后在您的产品控制器代码中，您可以返回带有产品列表的部分视图。例如：

索引.cshtml

```
@using (Ajax.BeginForm("AjaxSave", "Product", new AjaxOptions { HttpMethod = "GET", UpdateTargetId = "productList", InsertionMode = InsertionMode.Replace }))
{ 
    // your form
    <p>
        <input type="submit" value="Save" />
    </p>
}

...

<div id="productList">...
</div> 
```

产品控制器.cs

```
[HttpGet]
public ActionResult AjaxSave(Product product)
{
    if (ModelState.IsValid)
    {
        // save products etc..
    }

    var allProducts = _productService.GetAllProducts();

    return PartialView("ProductListControl", allProducts);

} 
```

有一篇关于这个的好文章[here](http://blogs.msdn.com/b/stuartleeks/archive/2011/04/13/asp-net-mvc-partial-rendering-and-ajaxattribute.aspx)。

# unboundid-ldap-sdk - UnboundID LDAP SDK：获取用户的所有组

> ID：15051830
> 
> 赞同：4
> 
> 时间：2013-02-24T12:43:08.810
> 
> 标签：unboundid-ldap-sdk

使用 UnboundID LDAP sdk，如何获取特定用户所属的所有 LDAP 组？（我真的很感激一些示例代码）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-09T12:35:40.890

我也有同样的问题。但是，迈克尔的解决方案对我不起作用，因为它不能递归地工作。

显然，有一个“神奇”的 AD 查询可以递归地获取所有组，请参阅 [Find Recursive Group Membership (Active Directory) using C#](https://stackoverflow.com/questions/6252819/find-recursive-group-membership-active-directory-using-c-sharp)和[如何过滤包含特定用户的组的 LDAP 查询？](https://stackoverflow.com/questions/6050003/how-do-i-filter-an-ldap-query-for-groups-containing-a-specific-user)

虽然我们的 AD 管理员已使用 ldifde 从命令行获取所有组，但我无法让查询与 UnboundID 一起使用。我们的 CN 内部有空格，UnboundID 添加了一个奇怪的“5c”——但即使有一个没有空格的（技术）用户，我也没有得到任何结果。

* * *

无论如何，这是我的工作（和低效）源代码（使用谷歌番石榴）。我省略了一些方法和常量，我想你可以猜到常量的值`OBJECT_CLASS`是什么:-)

```
 /**
   * Gets the groups for a user which is identified by the filter.
   * @param filter The filter that identifies the user
   * @return The groups for the user
   */
  private List<String> getGroups(final Filter filter) {
    LDAPConnection connection = null;
    try {
      connection = getConnection();

      String userDN = getUserDN(connection, filter);
      if (userDN == null) {
        return Collections.emptyList(); // No user found
      }

      Multimap<String, String> groupsByDN = ArrayListMultimap.create();
      getGroupsRecursively(connection, userDN, groupsByDN);
      Set<String> groups = new HashSet<>(groupsByDN.values());
      for (String dn : groupsByDN.keySet()) {
        // The user is not a group...
        if (!dn.equals(userDN)) {
          DN distinguishedName = new DN(dn);
          for (RDN rdn : distinguishedName.getRDNs()) {
            if (rdn.hasAttribute(CN)) {
              groups.add(rdn.getAttributeValues()[0]);
              break;
            }
          }
        }
      }
      return new ArrayList<String>(groups);
    } catch (LDAPException e) {
      throw new RuntimeException("Can't search roles for " + filter, e);
    } finally {
      if (connection != null) {
        connection.close();
      }
    }
  }

  /**
   * Since LDAP groups are stored as a tree, this fetches all groups for a user, starting with the user's DN and then
   * fetching every group's groups and so on.
   * @param connection The LDAP connection
   * @param distinguishedName The distinguished name for which groups are searched
   * @param groupsByDN Contains a distinguished name as key and its group name as result; keys are only searched once!
   * @throws LDAPSearchException if the LDAP search fails
   */
  private void getGroupsRecursively(final LDAPConnection connection, final String distinguishedName,
      final Multimap<String, String> groupsByDN) throws LDAPSearchException {
    if (!groupsByDN.containsKey(distinguishedName)) {
      Filter groupFilter = Filter.createANDFilter(Filter.createEqualityFilter(OBJECT_CLASS, GROUP),
          Filter.createEqualityFilter(MEMBER, distinguishedName));
      SearchResult result = getSearchResult(connection, groupFilter, CN);
      List<SearchResultEntry> searchResults = result.getSearchEntries();
      for (SearchResultEntry searchResult : searchResults) {
        String groupName = searchResult.getAttributeValue(CN);
        groupsByDN.put(distinguishedName, groupName);
        getGroupsRecursively(connection, searchResult.getDN(), groupsByDN);
      }
    }
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-02T15:45:15.823

下面的函数仅适用于 Active Directory，因为它生成成员属性 memberOf。如果我能找到通用 LDAP 的方法，我会添加它。

```
 Entry   userEntry = ldapConnection.getEntry(userDN);

    List<Entry> entryList = new ArrayList();
    String[] memberValues = userEntry.getAttributeValues("memberOf");
    if (memberValues != null) {
        DNEntrySource entrySource = new DNEntrySource(ldapConnection, memberValues);
        while (true) {
            Entry memberEntry = entrySource.nextEntry();
            if (memberEntry == null) {
                break;
            }

            entryList.add(memberEntry);
        }
    }

    return entryList; 
```

# hibernate - Tapestry @CommitAfter 在页面外的方法上

> ID：15051831
> 
> 赞同：0
> 
> 时间：2013-02-24T12:43:11.890
> 
> 标签：hibernate, tapestry

我正在尝试在专用 DAO 类中的页面之外执行数据库事务。

[这个](https://stackoverflow.com/questions/7536659/hibernate-is-ignoring-my-persist-calls)答案有点帮助，但是在按照[官方网站](http://tapestry.apache.org/hibernate-user-guide.html)上的说明进行操作后，交易仍未提交。我没有收到任何错误 - 我可以看到正在运行插入查询，但数据库中没有出现任何条目。

DAO 类和接口是否必须在特定的包中`@Match()`才能找到它们？这是唯一可能导致我想出的问题的事情......

这是所有（我希望）相关代码：

应用模块

```
public static void bind(ServiceBinder binder) {
    binder.bind(MemberDAOInterface.class, MemberDAO.class);
}

@Match("*DAO*")
public static void adviseTransactions(HibernateTransactionAdvisor advisor,
        MethodAdviceReceiver receiver) {
    advisor.addTransactionCommitAdvice(receiver);
} 
```

成员DAO接口

```
public interface MemberDAOInterface {
    @CommitAfter
    public void addMember(MemberEntity memberEntity);

    @CommitAfter
    public void updateMember(MemberEntity memberEntity);

    @CommitAfter
    public void deleteMember(MemberEntity memberEntity);
} 
```

会员DAO

```
public class MemberDAO implements MemberDAOInterface {
    @Inject
    private Session session;

    public void addMember(MemberEntity memberEntity) {
        this.session.persist(memberEntity);
    }

    public void updateMember(MemberEntity memberEntity) {
        this.session.update(memberEntity);
    }

    public void deleteMember(MemberEntity memberEntity) {
        this.session.delete(memberEntity);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T13:07:06.177

回答你的这个问题：

> DAO 类和接口是否必须位于特定的包中，@Match() 才能找到它们？

我在您提到的问题中发现：

> @CommitAfter 注解默认情况下仅适用于页面/组件类。要在服务对象中获得相同的行为，您需要那段额外的代码。

所以**是**的，你的 DAO 必须是挂毯服务。您需要将它们放在服务包中。

希望有帮助。

# ios - 防止在已经打开时调用 UIDocument openWithCompletionHandler

> ID：15051835
> 
> 赞同：1
> 
> 时间：2013-02-24T12:43:46.660
> 
> 标签：ios, core-data, objective-c-blocks, uimanageddocument, uidocument

我有一个带有以下方法的单例类（DTTSingleton）：

```
+ (UIManagedDocument *)managedDocument
{    
    static UIManagedDocument *managedDocument = nil;
    static dispatch_once_t mngddoc;

    dispatch_once(&mngddoc, ^
    {
        if(!managedDocument)
        {
            NSURL *url = [[DTTHelper applicationDocumentsDirectory] URLByAppendingPathComponent:kDTTDatabaseName];
            managedDocument = [[DTTManagedDocument alloc] initWithFileURL:url];            
        }
    });

    return managedDocument;
}

+ (void)useDefaultDocumentWithBlock:(completion_block_t)completionBlock
{
    if (![[NSFileManager defaultManager] fileExistsAtPath:[DTTSingleton.managedDocument.fileURL path]])
    {
        [DTTSingleton.managedDocument saveToURL:DTTSingleton.managedDocument.fileURL forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success)
         {
             if (success)
             {
                 completionBlock(DTTSingleton.managedDocument.managedObjectContext);                 
             }
             else
             {
                 NSLog(@"Failed to save!");
             }
         }];
    }
    else if (DTTSingleton.managedDocument.documentState == UIDocumentStateClosed)
    {
        [DTTSingleton.managedDocument openWithCompletionHandler:^(BOOL success)
         {
             if (success)
             {
                 completionBlock(DTTSingleton.managedDocument.managedObjectContext);
             }
             else
             {
                 NSLog(@"Failed to open!");
             }
         }];
    }
    else if (DTTSingleton.managedDocument.documentState == UIDocumentStateNormal)
    {
        completionBlock(DTTSingleton.managedDocument.managedObjectContext);
    }
} 
```

在我的 UITableViewController 中，viewDidLoad 方法中有以下代码：

```
 [DTTSingleton useDefaultDocumentWithBlock:^(NSManagedObjectContext *moc)
    {
        NSFetchRequest *fetchRequest = [NSFetchRequest fetchRequestWithEntityName:@"SomeEntity"];
        self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:moc cacheName:nil];
    }];
    [DTTSingleton useDefaultDocumentWithBlock:^(NSManagedObjectContext *moc)
     {
         NSLog(@"When this is called it errors because DTTSingleton is already trying to open it!");
     }]; 
```

执行时出现错误：

> 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“尝试打开或恢复已经在运行中具有打开或恢复操作的文档

我明白为什么会出现此错误，这是因为我正在尝试打开文档，而另一个打开进程已经在运行。所以我的问题是...

1）如何确保 openWithCompletionHandler 只被调用一次？

2）如何确保文档打开后执行第二个块？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T03:48:26.660

我不确定你是否看过这个，但这里可能会有一个很好的资源：http: [//adevelopingstory.com/blog/2012/03/core-data-with-a-single-shared-uimanageddocument。 html](http://adevelopingstory.com/blog/2012/03/core-data-with-a-single-shared-uimanageddocument.html)

如果您只是想创建自己的（而不是使用上面的链接或类似链接）并且正在寻找一些输入，我可以指出我看到的一些事情（尽管我不以任何方式声称成为专家）...

无论如何，我相信你的问题源于这里：

```
// ....
} else if(DTTSingleton.managedDocument.documentState == UIDocumentStateClosed) {

    [DTTSingleton.managedDocument openWithCompletionHandler:^(BOOL success) {
         if(success) {
             completionBlock(DTTSingleton.managedDocument.managedObjectContext);
         } else {
             NSLog(@"Failed to open!");
         }
     }];

} 
```

[openWithCompletionHandler](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIDocument_Class/UIDocument/UIDocument.html#/apple_ref/occ/instm/UIDocument/openWithCompletionHandler)方法尝试异步打开到文档的连接。问题在于，在您第一次调用在 UITableView 中打开文档时，您使用的代码会通知文档已关闭 - 因此它会尝试打开它。这一切都很好，而且很花哨，但是您在此处使用的代码随后会重新尝试创建单例实例。这很可能发生得如此之快（而且紧密相连），以至于它再次尝试异步打开文档。

要对此进行测试，请尝试在 UIDocumentStateClosed 检查该行之后放置一个断点：

```
[DTTSingleton.managedDocument openWithCompletionHandler:^(BOOL success) 
```

我相信你会看到这被执行了无数次......

我不够熟练，无法解释如何解决这个问题，但我会认真建议使用上面链接中显示的方法，他在其中应用块来分配/跟踪打开文档的存在

希望这有帮助吗？

编辑：* 添加了断点的建议。

编辑： [这是另一个具有类似问题（和建议/结论）的stackoverflow票](https://stackoverflow.com/questions/11933055/uidocument-openwithcompletionhandler-crash)- 所以我可能离这里不太远=）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:25:50.030

只是想我会回复说我遇到的问题已经通过禁用访问核心数据的按钮来解决，直到文档准备好，这样你就永远不会尝试与另一个进程同时打开文档。至于像 viewDidLoad 这样的生命周期处理程序中的核心数据访问，我实现了一个系统，如果文档正在打开（使用变量手动保存状态），它会通过循环延迟调用，直到文档打开，本质上是对调用进行排队. 不要忘记在循环调用中使用 performSelector:withObject:afterDelay: ，否则会导致应用程序崩溃。

感谢您的建议约翰。

# python - 打印 RSS 提要中最新的三个项目及其标题和链接

> ID：15051836
> 
> 赞同：1
> 
> 时间：2013-02-24T12:43:55.577
> 
> 标签：python, xml

我在一段时间内遇到了这个基本问题，但不确定问题是什么。我在运行以下代码时收到的错误是：

```
AttributeError: 'list' object has no attribute 'find' 
```

这是代码：

```
import xml.etree.ElementTree as ET
import requests

r = requests.get('http://www.11alive.com/rss/local/3/10.xml')

root = ET.fromstring(r.text.encode('utf-8'))

channel = root.find('channel')

items = channel.findall('item')

news = []   
for i in range(3):
    news.append(items.find('title').text)
    news.append(items.find('link').text)

print news 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T12:45:38.583

您只需对`items`列表进行切片：

```
for item in items[:3]:
    news.append((item.find('title').text, item.find('link').text)) 
```

在上面的示例中，我还将标题和链接作为二值元组添加到`news`列表中。

对于您的示例提要，导致：

```
[('The Autism Gap: What Works', 'http://www.11alive.com/rss/article/278819/3/The-Autism-Gap-What-Works'), ('Adairsville effort continues with concert ', 'http://www.11alive.com/rss/article/279178/3/Adairsville-effort-continues-with-concert-'), ('Gold Coast Salads expands seafood salad recall on Listeria fears', 'http://www.11alive.com/rss/article/279147/3/Gold-Coast-Salads-expands-seafood-salad-recall-on-Listeria-fears')] 
```

您也可以简化`item`查找：

```
items = root.findall('channel/item') 
```

不过，您确实想查看[feedparser 库](http://code.google.com/p/feedparser/)；它处理多种提要格式以及正确处理缓存和清理等问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:43:55.577

在`for`循环中，您需要遍历单个字符串，而不是整个列表。为此，您将 i 迭代器放入 for 循环中，如下所示：

```
for i in range(3):
    news.append(items[i].find('title').text)
    news.append(items[i].find('link').text) 
```

这将为您提供 6 个项目的简单列表。`(title[0], link[0], title[1], link[1], title[2], link[2])`

# html - f# 按标签拆分 html

> ID：15051840
> 
> 赞同：0
> 
> 时间：2013-02-24T12:44:13.647
> 
> 标签：html, string, parsing, f#, split

我想解析一个 HTML 文档并将每个段落作为单独的条目打印到日志文件中。到目前为止，我有：

```
let parseTextFile (path) =
        let fileText = File.ReadAllText(path)
        fileText.Split('<p>') |> Seq.iter (fun m -> logEmail(m)) 
```

但对我来说不幸的是 string.Split 在这里没有做我想要的，似乎存在用单个字符分隔符分割字符串。我如何使用不只是一个字符的东西来分割文件，除了 <p> 之外还有其他东西可能会很好，因为我将在段落末尾有一个 </p> 。使用正则表达式或某种复杂的匹配器，我可以更具体地挑选出 <p> 标记之间的所有内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T13:27:12.053

尝试使用特定的库来解析 html，例如[HtmlAgilityPack](http://html-agility-pack.net/?z=codeplex)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T15:25:38.303

正如 wmeyer 所说，您需要`.Split()`在字符串上使用不同的方法重载。实际上，您发布的代码甚至都不会编译，因为`'<p>'`它不是字符串文字——您需要`"<p>"`改用（单引号用于字符文字）。

以下是如何使用正确的重载`.Split()`：

```
open System.IO

let parseTextFile path =
    let fileText = File.ReadAllText path
    fileText.Split ([| "<p>"; |], System.StringSplitOptions.RemoveEmptyEntries)
    |> Seq.iter logEmail 
```

在 F# Interactive 中进行快速测试：

```
> "First paragraph<p>Second paragraph.<p><p>Third paragraph.<p>"
   .Split ([| "<p>"; |], System.StringSplitOptions.RemoveEmptyEntries);;
val it : string [] =
  [|"First paragraph"; "Second paragraph."; "Third paragraph."|] 
```

最后，正如@ntr 所说——使用像 HTML Agility Pack 这样的库来解析 HTML 会好得多**。**他们的解析器非常健壮，可以为您省去很多麻烦。

# vb.net - vb.net 中的 INSERT INTO 语句中的语法错误

> ID：15051842
> 
> 赞同：0
> 
> 时间：2013-02-24T12:44:58.100
> 
> 标签：vb.net, vb.net-2010

我在插入语句中遇到语法错误。`IF`语句工作得很好，只是在尝试保存信息时出现此错误

```
Private Sub btnSave_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSave.Click
        If txt12Per.Text >= TextBox12.Text And txtGPer.Text >= TextBox11.Text And TextBox1.Text >= TextBox10.Text Then
            Try
                'Dim da As OleDb.OleDbDataAdapter
                Dim dbprovider As String = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Users\Taher\Documents\Visual Studio 2010\Projects\WindowsApplication1\WindowsApplication1\Database1.accdb;Persist Security Info=False;"
                Me.con = New OleDb.OleDbConnection()
                con.ConnectionString = dbprovider
                con.Open()

                Dim sqlquery As String = "INSERT INTO MCAscheduled (URno,SName,hsc,gper,pgper,pstatus,cname,hrname,position,hscinter,ginter,pginter,comments)" + "VALUES (" & CInt(txtUrn.Text) & ",'" & txtName.Text & "'," & CInt(txt12Per.Text) & "," & CInt(txtGPer.Text) & "," & CInt(TextBox1.Text) & ",'" & ComboBox2.Text & "','" & TextBox3.Text & "','" & TextBox4.Text & "','" & ComboBox4.Text & "'," & CInt(TextBox12.Text) & "," & CInt(TextBox11.Text) & "," & CInt(TextBox10.Text) & ",'" & TextBox9.Text & "');"
                Dim sqlcommand As New OleDb.OleDbCommand(sqlquery)

                With sqlcommand
                    .CommandText = sqlquery
                    .Connection = con
                    .ExecuteNonQuery()
                    con.Close()
                    txtUrn.Text = ""
                    txt12Per.Text = ""
                    txtGPer.Text = ""
                    txtName.Text = ""
                    cmbNameofGCourse.Text = ""
                End With
                MsgBox("Record Added")
            Catch ex As Exception
                MsgBox(ex.ToString)
            End Try
        Else
            MsgBox("Student Not eligible for the requested company")
        End If
    End Sub 
```

有人可以帮我解决这个问题吗......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T13:04:29.690

您试图插入 13 列，但只提供 11 个值！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-24T13:02:48.360

您有 13 个字段可以插入值，但只有 11 个值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-02T02:27:35.203

使用括号，它会正常工作。

```
Dim sqlquery As String = "INSERT INTO MCAscheduled **([URno],[SName],[hsc],[gper],[pgper],[pstatus],[cname],[hrname],[position],[hscinter],[ginter],[pginter],[comments])"** + "VALUES (" & CInt(txtUrn.Text) & ",'" & txtName.Text & "'," & CInt(txt12Per.Text) & "," & CInt(txtGPer.Text) & "," & CInt(TextBox1.Text) & ",'" & ComboBox2.Text & "','" & TextBox3.Text & "','" & TextBox4.Text & "','" & ComboBox4.Text & "'," & CInt(TextBox12.Text) & "," & CInt(TextBox11.Text) & "," & CInt(TextBox10.Text) & ",'" & TextBox9.Text & "');" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T18:17:23.627

不得不将位置字段更改为其他不知道为什么但它有效

```
Dim sqlquery As String = "INSERT INTO MCAscheduled (URno,sname,hsc,gper,pgper,pstatus,cname,hrname,hscinter,ginter,pginter,comments,post,course,pcourse)" + "VALUES (" & CInt(txtUrn.Text) & ",'" & txtName.Text & "'," & CInt(txt12Per.Text) & "," & CInt(txtGPer.Text) & "," & CInt(TextBox1.Text) & ",'" & ComboBox2.Text & "','" & TextBox3.Text & "','" & TextBox4.Text & "'," & CInt(TextBox12.Text) & "," & CInt(TextBox11.Text) & "," & CInt(TextBox10.Text) & ",'" & TextBox9.Text & "','" & ComboBox1.Text & "','" & cmbNameofGCourse.Text & "','" & TextBox5.Text & "');" 
```

# mongodb - 如何启动 MongoDB 服务器？

> ID：15051846
> 
> 赞同：0
> 
> 时间：2013-02-24T12:46:13.810
> 
> 标签：mongodb, mongohq

我有一个与 MongoHQ 上托管的 MongoDB 服务器连接的 PHP 网络服务，突然我得到了这个异常：

```
exception 'MongoConnectionException' with message 'Operation now in progress' in /****/classes/mongo.db.class.php:8 Stack trace: #0 /****/classes/mongo.db.class.php(8): Mongo->__construct('***********') #1 /filepath/filename.php(14): include_once('******') #2 {main}Problem during mongodb initialization. Please start mongodb server. 
```

这个例外是关于什么的？我不知道我该怎么处理它？如何启动 MongoDB 服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-11T13:13:29.843

dos mongod --dbpath "C://mongodata"

# linux - 从 TCL 文件执行 linux 命令

> ID：15051847
> 
> 赞同：0
> 
> 时间：2013-02-24T12:46:20.253
> 
> 标签：linux, tcl

我想在 tcl 文件中运行命令。根据[Unix示例](http://www.tcl.tk/man/tcl/TclCmd/exec.htm#M28)，我写道：

```
....
exec export LD_LIBRARY_PATH=/opt/gcc-4.1.2-built/lib64
puts $gofile "#!/bin/bash
.... 
```

但是我收到此错误：

```
couldn't execute "export": no such file or directory
while executing
"exec export LD_LIBRARY_PATH=/opt/gcc-4.1.2-built/lib64" 
```

如果我删除该 exec 行，则没有错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T13:03:01.010

要设置环境变量，您不要使用`exec`，而只需写入全局`env`关联数组的适当元素（`::`即“这是一个全局变量”，如果您正在编写顶级脚本，则可以省略）：

```
set ::env(LD_LIBRARY_PATH) "/opt/gcc-4.1.2-built/lib64" 
```

然后你就`exec`可以正确地继承该值：

```
puts $gofile "#!/bin/bash
...." 
```

（我有点惊讶你正在传递这样的多行脚本，但如果它对你有用，那很酷。不过，我发现如果我这样做，通常最好将事情分成多个文件。它减少了令人头疼和混乱的数量，因为您最终不会遇到比最低级别更多的引用。）

# .htaccess - apache-tomcat 中的 Gzip

> ID：15051852
> 
> 赞同：0
> 
> 时间：2013-02-24T12:47:14.033
> 
> 标签：.htaccess, tomcat, gzip, deflate

我想启用 gzip 进行压缩，并且我尝试了许多代码块。不幸的是，没有任何效果。我的主机使用的服务器是 apache-tomcat。他们是否使用不同的代码来启用 gzip 或 deflate？我只能访问 .htaccess。有人可以发布正确的代码以在 apache-tomcat 上启用 gzip（或 deflate）吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:59:41.197

Tomcat中没有`.htaccess`。此文件属于 Apache Web 服务器。可以在[HTTP 连接器](https://tomcat.apache.org/tomcat-6.0-doc/config/http.html#Standard_Implementation)中启用 GZIP 压缩。您的问题是针对 serverfault 而不是 stackoverflow。

# vb.net - vb.net 有什么好的 No OP 操作？

> ID：15051853
> 
> 赞同：4
> 
> 时间：2013-02-24T12:47:15.310
> 
> 标签：vb.net, noop

我们可以在确保它不做任何其他事情的同时设置断点。

在 c 中，这将是 while(false);

在 vb.net 中做什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-24T14:57:52.577

如果你总是需要它在那里打破你可以放 `Stop`或`Debugger.Break()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-01-09T19:03:50.700

我的两分钱...

您可以使用冒号将任何一系列命令组合到一行中：

```
If False Then : End If
Select Case False : Case Else : End Select 
```

我也把它变成了一个潜艇。然后它得到一个可识别的自己的名字：

```
'Definition...
Public Sub noop () 'Or Private, Protected, etc.
End Sub

'Usage...
Sub Main()
    If sometest Then
        noop
    Else
        MsgBox "test is false"
    End If
End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-09T14:41:09.737

有一个合法的用例。当感兴趣的语句之后需要一个临时断点并且这是 if 语句中的最后一行时，需要一个额外的 no-op 类型语句来放置临时断点。在这种情况下，我使用：

```
If someCondition >0 Then

    doSomething
    Space (1)    'Dummy line to place breakpoint
End If 
```

这将返回一个包含一个空格的字符串，但不会将其分配给任何内容。我在 VBA 中使用它，但在 .net 中也支持它

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-02T08:48:03.833

如果您出于某种原因真的想要 No-Op *（这会变成最无效的单行代码的竞赛吗？！）*，这些怎么样？

`System.Threading.Thread.Sleep(1)`- 1ms 不太可能在循环之外产生巨大影响

`Debug.Write("")`- 似乎没有输出任何东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-24T12:59:29.520

非常奇怪的问题，您可以在代码中的任何位置放置一个断点。但这里有一些无用的行：

```
 Do While False
 Loop

 While False
 End While 
```

甚至以下：

```
 Dim hello = Nothing 
```

或这个 ：

```
 Format("", "") 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-10-08T12:03:14.977

我知道这是一个旧查询，但是对于它的价值，我对原始问题的首选解决方案是 `Debug.Assert (vbTrue)`

如果您愿意，您可以使用变量而不是 vbTrue，然后通过更改一个变量来启用/禁用代码中的所有断点

```
Dim bDisableBreakpoints as Boolean: bDisableBreakpoints = vbTrue
'your code here
Debug.Assert (bDisableBreakpoints)
'rest of your code 
```

只需将 bDisableBreakpoints 更改为`vbFalse`，断点将设置在您使用过 Debug.Assert 的任何位置

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-09-26T09:42:54.030

no-op 语句也有助于很好地记录代码并使其更易于理解。例如，您可以输入 A = A 之类的语句。

例如：

如果 MyNumber => 100 则 A = A
否则：

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-08T13:56:30.933

我个人最喜欢的是

```
dim b=1 
```

然后我在那里放了一个断点。

# html - 如何在居中的 div 内对齐 div

> ID：15051857
> 
> 赞同：0
> 
> 时间：2013-02-24T12:47:54.200
> 
> 标签：html, resize, alignment

我在主要居中的 div 内对齐 div 有问题。

这是我的代码

```
<style>
body {
  max-width: 1150px;
  min-width: 900px;
  margin:0 auto; }

.container {
  text-align:center;
  background-color:#e1e1e1; }

.box {
  width: 250px; }

.inline-block {
  color: #eee;
  margin: 10px 0px 0px 10px;
  text-align: center;
  display:inline-block; }

.one {
  height: 22px;
  background: #744; }

</style>

<div class="container">
    <div class="inline-block"><div class="one box">1</div>
    </div>
    <div class="inline-block"><div class="one box">2</div>
    </div>
    <div class="inline-block"><div class="one box">3</div>
    </div>
    <div class="inline-block"><div class="one box">4</div>
    </div>
    <div class="inline-block"><div class="one box">5</div>
    </div>
    <div class="inline-block"><div class="one box">6</div>
    </div>
    <div class="inline-block"><div class="one box">7</div>
    </div>
    <div class="inline-block"><div class="one box">8</div>
    </div>
</div> 
```

我调整窗口大小时的结果

![](../Images/6dd5a97330a8e3ad8de2e221658dd3e8.png)

我需要的

![](../Images/62b01c0e0bd2e5774a411d327d43f635.png)

PS对不起我的英语，我希望你明白这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T12:53:05.243

这是[**演示**](http://jsfiddle.net/7yvqA/1/)

只是它很简单添加`Float:left`到它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T13:21:15.067

我认为`.container { text-align:left;}`会为你解决问题，当然你需要`.container > div { text-align:center;}`. 而且我还建议向这些 div 添加类，这样您就不必使用直接子选择器。

# asp.net - 对于 CRUD，以下哪一项是更好的做法？Simple.Data 还是 Dapper？

> ID：15051859
> 
> 赞同：4
> 
> 时间：2013-02-24T12:48:02.037
> 
> 标签：asp.net, sql-server-2008, orm, dapper, simple.data

我在我的应用程序中同时使用 Dapper 和 simple.Data，Dapper 仅用于检索数据以及 Simple.Data 的其他操作。我只需要知道在除检索之外的所有操作中使用 Simple.Data 是否是更好的方法，并且在性能上是否与在 Dapper 中使用 ExecuteNonQuery 一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T13:56:28.773

根据我的经验，我建议使用 Simple.Data。这主要是因为 Simple.Data 支持开箱即用的 CRUD 操作。（[https://github.com/markrendle/Simple.Data/wiki/Inserting-and-updating-data](https://github.com/markrendle/Simple.Data/wiki/Inserting-and-updating-data)）。它们都非常快，但我认为对于主要执行 CRUD 的应用程序，我会从这两者中选择 Simple.Data。

您可能还想考虑 ORMLite。ServiceStack 库中的任何东西都很棒。

谢谢。快乐编码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-24T07:23:41.567

两者现在都支持 CRUD，所以如果你对 Dapper 进行了投资，只需添加其中一个 nugets 就可以了！

1.  小巧玲珑。[扩展](https://github.com/tmsmith/Dapper-Extensions)
2.  有彩虹的衣冠楚楚
3.  小巧玲珑。[Contrib](https://github.com/StackExchange/dapper-dot-net/tree/master/Dapper.Contrib)超过 5K 用户为此加注了星标！！！

# php - 创建具有用户友好导航的 php 网站

> ID：15051860
> 
> 赞同：0
> 
> 时间：2013-02-24T12:48:05.293
> 
> 标签：php, navigation

我们正在建立一个网站，用户必须登录才能查看网站内容（类似于 facebook 和 twitter 使用的）

问题是我们网站的导航完全搞砸了：

*   当用户打开站点时，他位于：**sitename.com**
*   当用户登录时，位置更改为：**sitename.com/login_success.php**
*   当用户使用导航栏时，位置更改为：**sitename.com/login_success.php#page2**（AJAX 用于更改 div 内容）

与 facebook (url) 相比：

*   用户已登录：**sitename.com**
*   用户未登录：**sitename.com**
*   用户导航到好友搜索：**sitename.com/search**
*   用户导航到设置：**sitename.com/settings**

为什么像 facebook 这样的网站有如此干净的 URL？他们是怎么做到的呢？我想创建一个干净的网站，带有干净/用户友好的 URL（没有`#`or`?`和`&`and `=`） - 我从哪里开始？我们是否需要使用任何框架（yii、zend 等）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:05:42.510

是的，你必须使用 mod-re-write。

例如，这是如何更改`sitename.com/login_success.php#page2`为`sitename.come/page2`：

```
<IfModule mod_rewrite.c>
Options +FollowSymlinks
RewriteEngine On
</IfModule>

#first, what is the original request
RewriteCond %{THE_REQUEST} /login_success.php#page([0-9]*)
# now use regex to redirect to the clean url structure
RewriteRule ^$ /page%1? [R=301,L,NE]
# now make the clean url serve the content from the ugly one
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^page([0-9]+) /login_success.php#page$1 [L] 
```

我不太确定最后一场正则表达式匹配，但我希望这能让你走上正轨！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T12:53:13.867

我相信在你的案例中已经完成了大量的编码。所以现在不建议切换到像 yii 或 zend 这样的框架，这个决定应该更早做出。

检查[如何简化 url](https://stackoverflow.com/questions/4529552/how-to-simplify-the-url)。

您可以使用 apache web 服务器的 mod_rewrite。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T12:52:33.700

他们使用`mod_rewrite`和类似的工具来清理他们的 URL。

`mod_rewrite`在 Apache 上可用。IIS 等效项名为 URL 重写。

[http://httpd.apache.org/docs/current/mod/mod_rewrite.html](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)

[http://www.iis.net/downloads/microsoft/url-rewrite](http://www.iis.net/downloads/microsoft/url-rewrite)

您不需要使用特殊的框架来使其工作，但它有助于简化流程，因为许多框架都内置了此功能。

想到的一个是Wordpress。Wordpress 让您可以很好地控制它的工作方式，而无需过多地接触配置文件。

# python - 如何从这个字母数字对中过滤掉数字？

> ID：15051862
> 
> 赞同：-3
> 
> 时间：2013-02-24T12:48:09.757
> 
> 标签：python

我已经用漂亮的汤从网络服务器上刮下来了

```
C,9
C,9
C,9
H,8
H,9
H,9
H,9
H,9
H,9
H,9
H,7
H,5
H,2
C,0
C,7
C,8
C,4
C,1
C,7
C,6
C,6
C,0
C,2
C,1
E,2
E,4
E,1
C,5
C,9
C,9
C,9
C,7
C,7
H,5
H,4
H,8
H,9
H,9
H,7
H,6
H,5
C,7
C,9
C,9
C,9
C,8
C,6
C,4
C,1
C,1
C,0
E,2
E,4
E,1
E,3
E,7
C,6
C,9
C,9
C,9
C,5
E,7
E,8
E,8
E,6
E,4
C,8
C,9
C,9
C,9
C,9
H,6
H,7
H,7
H,9
H,9
H,9
H,9
H,9
H,9
H,6
H,3
H,2
C,9 
```

它是如何打印出来的，我没有从网络服务器编辑它。

我想删除数字，所以剩下的就是字母。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:51:19.707

使用一个简单的正则表达式：

```
import re
re.sub(r'\d', '', s) # or re.sub(r',\d', '', s) to remove the commas, too 
```

假设`s`是您拥有的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:52:58.080

最基本的方法是将chars复制到一个数组中，并测试每个char是否等于0,1,2,3,4,5,6,7,8,9。删除它后，您可以输出数组或做任何您想做的事情。

# java - 如何使用 Maven 在工件中包含 src 测试

> ID：15051864
> 
> 赞同：0
> 
> 时间：2013-02-24T12:48:12.643
> 
> 标签：java, maven

我正在尝试创建一个工件，其中包括我的测试以及 src 文件。我的 pom 有以下插件： org.apache.maven.plugins maven-jar-plugin 2.4 test-jar jar

但结果是这会创建两个工件，一个带有 src 没有测试，第二个只包含测试。

有什么方法可以只创建 1 个包含测试的工件，或者将工件复制到包含 src 的工件

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T13:02:24.840

这违反了 Maven 约定。所以插件很可能不提供这个。

# sql - 主键与聚集索引的关系

> ID：15051869
> 
> 赞同：104
> 
> 时间：2013-02-24T12:49:06.573
> 
> 标签：sql, sql-server, database, database-design

可以`TABLE`有一个没有聚集索引的主键吗？

并且可以在`TABLE`没有主键的情况下拥有聚集索引吗？

谁能简单地告诉我主键和聚集索引之间的关系？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2013-02-24T12:54:18.247

主键是一个*逻辑*概念——它是表中行的唯一标识符。因此，它有一堆属性——它可能不为空，而且它必须是唯一的。当然，由于您可能经常通过其唯一标识符搜索记录，因此最好在主键上建立一个索引。

聚集索引是一个*物理*概念——它是一个影响记录在磁盘上存储顺序的索引。这使得它在访问数据时成为一个非常快速的索引，但如果您的主键不是序列号，它可能会减慢写入速度。

是的，您可以拥有没有聚集索引的主键 - 有时，您可能想要（例如，当您的主键是连接表上的外键组合时，并且您不想招致磁盘洗牌开销写的时候）。

是的，您可以在不是主键的列上创建聚集索引。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2013-02-24T12:53:29.587

一个表可以有一个非聚集的主键，而一个聚集的表不需要主键。所以这两个问题的答案都是肯定的。

聚集索引在叶级别存储所有列。这意味着聚集索引包含表中的所有数据。没有聚集索引的表称为堆。

主键是默认聚集的唯一索引。默认情况下，当你创建主键时，如果表还没有聚集，主键将被创建为聚集唯一索引。除非您明确指定该`nonclustered`选项。

一个例子，其中`t1`有一个非聚集的主键，并且`t2`不是聚集的但有一个主键：

```
create table t1 (id int not null, col1 int);
alter table t1 add constraint PK_T1 primary key nonclustered (id);
create clustered index IX_T1_COL1 on t1 (col1);

create table t2 (id int not null, col1 int);
alter table t2 add constraint PK_T2 primary key nonclustered (id); 
```

[SQL Fiddle 的示例。](http://sqlfiddle.com/#!6/ea7d0/3/0)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-02-24T16:10:50.320

首先，看一下[Index-Organized Tables 和 Clustered Indexes](http://use-the-index-luke.com/sql/clustering/index-organized-clustered-index)。实际上，我建议阅读整个[使用索引卢克！](http://use-the-index-luke.com/)从一开始，直到您到达集群主题才能真正了解正在发生的事情。

现在，对于你的问题...

* * *

> TABLE 可以有没有聚集索引的主键吗？

是的，在声明主键以创建基于堆的表时使用 NONCLUSTERED 关键字。例如：

```
CREATE TABLE YOUR_TABLE (
    YOUR_PK int PRIMARY KEY NONCLUSTERED
    -- Other fields...
); 
```

这是不幸的，因为很多人似乎只是接受默认值（即 CLUSTERED），即使在许多情况下基于堆的表实际上会更好（如链接文章中所述）。

* * *

> 表可以有没有主键的聚集索引吗？

与其他一些 DBMS 不同，MS SQL Server 将让您拥有一个不同于主键的集群索引，甚至根本没有主键。

下面的示例创建了一个与 PK 分开的集群索引，它上面有一个 UNIQUE 约束，这在大多数情况下可能是您想要的：

```
CREATE TABLE YOUR_TABLE (
    YOUR_PK int PRIMARY KEY,
    YOUR_CLUSTERED_KEY int NOT NULL UNIQUE CLUSTERED
    -- Other fields...
); 
```

如果你选择一个非唯一的聚簇索引（使用`CREATE CLUSTERED INDEX ...`），MS SQL Server 将通过添加一个隐藏字段来自动使其唯一。

请注意，集群的好处在范围扫描中最为明显。如果您使用的集群索引与客户端应用程序完成的范围扫描不“对齐”（例如过度依赖上述隐藏列或在[代理键](https://stackoverflow.com/tags/surrogate-key/info)上进行集群时），那么您几乎违背了聚类的目的。

* * *

> 谁能简单地告诉我主键和聚集索引的关系？

*在 MS SQL Server 下，主键默认*也是集群的。如上所述，您可以更改该默认值。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-24T12:58:27.857

从[MSDN Using Clustered Indexes得到的答案](http://msdn.microsoft.com/en-au/library/aa933131%28v=sql.80%29.aspx)

*TABLE 可以有没有聚集索引的主键吗？*- 是的。

*TABLE 可以有没有主键的聚集索引吗？*- 是的。

*主键*是确保值的唯一性的约束，因此可以始终由该键专门标识 行*。*

*索引*会自动分配给主键（因为行通常通过其主键“查找”）。

*非聚集索引*是行的一个（或多个）列的逻辑排序。将其视为有效的表的另一个“副本”，按索引所在的任何列排序。

*聚集索引*是指实际*表*按特定列进行物理排序。一个表并不总是有一个聚集索引（即，虽然它会被*某些东西*物理排序，但那个东西可能是*未定义*的）。一个表不能有多个聚簇索引，尽管它可以有一个复合聚簇索引（即，该表按姓氏、名字、出生日期等物理排序）。

PK 通常（但不总是）是聚集索引。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-23T15:39:32.237

值得一提的是，在 MS SQL Server 中，主键中的所有列都必须定义为 NOT Null，而创建唯一聚集索引则不需要这样做。不过不确定其他数据库系统。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-09T19:05:40.317

它可能与这个问题的答案无关，但主键和聚集索引的一些重要方面是 ->

如果有一个带有聚集索引的主键（默认情况下是聚集索引，但是我们可以更改它），那么我们不能为该表创建一个更多聚集索引。但是如果还没有设置主键，并且有聚集索引，那么我们就不能用聚集索引创建主键。

# ruby-on-rails - 超薄换行符和格式

> ID：15051870
> 
> 赞同：13
> 
> 时间：2013-02-24T12:49:07.007
> 
> 标签：ruby-on-rails, slim-lang

我正在使用 slim 模板和 ruby​​ on rails（刚开始使用它们）。我面临的唯一问题是：呈现的 html 没有格式。即没有换行符，没有缩进。我可以理解，对于 slim 而言，本质上呈现格式可能有点棘手。

无论如何要呈现格式正确的html？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-24T13:08:07.927

从[文档](http://rdoc.info/github/slim-template/slim#Configuring_Slim)：

```
Slim::Engine.set_default_options pretty: true 
```

或直接

```
Slim::Engine.default_options[:pretty] = true 
```

扩展一点，正如@rubiii 在评论中提到的，这是 Slim 的一个特性。出于同样的原因，在生产中缩小和压缩 Javascript 和 CSS 是一种很好的做法，Slim 从它生成的 HTML 中去除不必要的空白，而无需将此`:pretty`选项设置为`true`.

如果你有一些`config/initializers/slim.rb`文件，你可以`:pretty`通过检查环境来动态配置选项。

```
Slim::Engine.set_default_options pretty: Rails.env.development? 
```

否则，您应该将此选项设置为`true`only in `config/environments/development.rb`，将其留`false`在生产环境中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T01:02:22.600

只需将`data-force-encoding="✓"`属性添加到`body`标签。这将使 Rails 以引用的可打印形式发送电子邮件（诀窍实际上是使用 UTF8 字符）。见：[https ://github.com/slim-template/slim/issues/123](https://github.com/slim-template/slim/issues/123)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-10T06:43:55.173

> 无论如何要呈现格式正确的html？

从技术上讲，HTML 可以“正确格式化”，没有换行符。如果您好奇，请查看“HTML 验证”。

至于 Slim，换行符是您必须做一些额外工作的少数几点之一。在很多人使用 HTML`<br>`标签的地方，我更喜欢使用`$/`哪个是对应于本地行分隔符的 ruby​​ 变量。我更喜欢这个，因为`<br>`元素已经过时了，虽然 slim 不会产生任何渲染它的输出，但使用实际标签是不好的做法。行尾变量对我个人来说也更熟悉和可靠:)

实际上，另一个重要的使用理由`$/`是它可以无缝地融入其他 ruby​​ 编码模式，并且总体上更加不可知。以[这个模板](https://gist.github.com/SteveBenner/a71f41e175f135b7d69b)为例。

# python - 如何在 Windows 7 上的 Aptana 中的 Pydev 中使用 Python 模块？

> ID：15051872
> 
> 赞同：0
> 
> 时间：2013-02-24T12:49:27.963
> 
> 标签：python, module, aptana, pydev, raspberry-pi

我对 Aptana Studio 3 中的 Pydev 相当陌生，但是感谢一些很棒的教程视频，我已经让 Python 3.3 在 Pydev 中在 Windows 7 上运行得很好。

我使用 Aptana/Pydev 的原因是所有 linty 代码整理的优点，但是我得到的需要重构的代码位使用[Rpi.GPIO](https://pypi.python.org/pypi/RPi.GPIO)模块。

当然，当我在 Pi 上 apt-get 模块时才能找到工作，但我需要在 Windows 上做一些大规模的整理，然后我可以稍后再回到 Pi 上的 IDLE3。

看起来您不能只是将文件夹转储到 Pydev 路径中并期望它运行，所以我阅读了 INSTALL 自述文件，并且发生了以下事情：

```
D:\RPi.GPIO>python setup.py install
running install
running bdist_egg
running egg_info
writing dependency_links to RPi.GPIO.egg-info\dependency_links.txt
writing RPi.GPIO.egg-info\PKG-INFO
writing top-level names to RPi.GPIO.egg-info\top_level.txt
reading manifest file 'RPi.GPIO.egg-info\SOURCES.txt'
reading manifest template 'MANIFEST.in'
writing manifest file 'RPi.GPIO.egg-info\SOURCES.txt'
installing library code to build\bdist.win-amd64\egg
running install_lib
running build_py
running build_ext
building 'RPi.GPIO' extension
error: Unable to find vcvarsall.bat 
```

因此，如果有人知道如何简单地让 Pydev 识别这个库，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:05:16.940

错误：

```
error: Unable to find vcvarsall.bat 
```

正在发生，因为您没有安装编译代码所需的[Visual Studio C++ 编译器。](http://www.microsoft.com/visualstudio/eng/downloads#d-2010-express)

另外，请查看[此答案](https://stackoverflow.com/questions/2667069/cannot-find-vcvarsall-bat-when-running-a-python-script)以获取更多信息。

# c# - 如何在 asp.net 中删除或更新部分查询字符串

> ID：15051881
> 
> 赞同：1
> 
> 时间：2013-02-24T12:50:26.153
> 
> 标签：c#, asp.net

我有以下查询字符串，我想删除或更新部分查询字符串

`?language=en-us&issue=5&pageid=18&search=hawaii&search=hawaii`// 这是我需要格式化的

问题是我有重复的搜索键查询字符串。

我尝试了以下代码，但它不起作用

```
public static string RemoveQueryStringByKey(string url, string key)
{
    var uri = new Uri(url);

    // this gets all the query string key value pairs as a collection
    var newQueryString = HttpUtility.ParseQueryString(uri.Query);

    // this removes the key if exists
    newQueryString.Remove(key);

    // this gets the page path from root without QueryString
    string pagePathWithoutQueryString = uri.GetLeftPart(UriPartial.Path);

    return newQueryString.Count > 0
        ? "{0}?{1}".FormatWith(pagePathWithoutQueryString, newQueryString)
        : pagePathWithoutQueryString;
} 
```

FormatWith 生成错误

```
string' does not contain a definition for 'FormatWith' and no extension method 'FormatWith' accepting a first argument of type 'string' could be found (are you missing a using directive or an assembly reference? 
```

**工作代码：**

```
public static string RemoveQueryStringByKey(string url, string key)
{
    var uri = new Uri(url);

    // this gets all the query string key value pairs as a collection
    var newQueryString = HttpUtility.ParseQueryString(uri.Query);

    // this removes the key if exists
    newQueryString.Remove(key);

    // this gets the page path from root without QueryString
    string pagePathWithoutQueryString = uri.GetLeftPart(UriPartial.Path);

    return newQueryString.Count > 0
        ? string.Format("{0}?{1}", pagePathWithoutQueryString, newQueryString)
        : pagePathWithoutQueryString;
} 
```

函数调用

```
var URL = Request.Url.AbsoluteUri;
var uri = new Uri(Helper.RemoveQueryStringByKey(URL, "search")); 
```

在我的实际逻辑中，我必须检查 QueryString`search`是否存在，然后我将其删除并用新的搜索关键字替换它。

您可以按照逻辑应用它，并且第一个不起作用的示例代码是由于`FormatWith`我无法修复，所以我使用了`Oded`对我有用的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T13:00:23.767

直接使用`string.Format`。看起来您从代码库中复制了代码，该代码库定义了`FormatWith`您未复制的扩展方法（或未包含它所在的命名空间）。

使用`string.Format`：

```
return newQueryString.Count > 0
    ? string.Format("{0}?{1}", pagePathWithoutQueryString, newQueryString)
    : pagePathWithoutQueryString; 
```

如果扩展方法在代码库中，另一种选择是使用扩展方法所在的命名空间添加[`using`声明](http://msdn.microsoft.com/en-us/library/was37tzw.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:58:51.257

```
return newQueryString.Count > 0
        ? "{0}?{1}".FormatWith(pagePathWithoutQueryString, newQueryString)
        : pagePathWithoutQueryString; 
```

> string' 不包含'FormatWith' 的定义，并且找不到接受'string' 类型的第一个参数的扩展方法'FormatWith'（您是否缺少 using 指令或程序集引用？

我相信该错误是不言自明的，您的返回代码中有错误。
字符串对象中没有 FormatWith。

* * *

QueryStrings 也可以使用[Request.QueryString](http://www.w3schools.com/asp/coll_querystring.asp)收集，它将返回键和值的集合。更改此集合，然后使用 Response.QueryString 重新发送它可能会满足您的要求。

# java - 通过所有应用程序可见的 java 对象列表

> ID：15051885
> 
> 赞同：0
> 
> 时间：2013-02-24T12:51:08.913
> 
> 标签：java, variables, interface

我有一个名为 Person(name, surname, age) 的对象，该对象由本地文件中的值填充。但我想通过应用程序保持这个对象可见，因为有一个 GUI 可以向它添加新值。我试图放置这样的接口但不起作用

```
 public interface MyInterface{

    public List<Person> myPersonObj = new ArrayList<Person>();

} 
```

并在应用程序中调用它，例如`MyInterface.myPersonObj` 有人可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:54:00.460

您必须声明变量静态，例如

```
public static (final) List<Person> persons = new ArrayList(); 
```

有关更多信息，请阅读单[格顿模式](http://en.wikipedia.org/wiki/Singleton_pattern)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:54:07.490

因为它在一个接口中，它会自动成为`final`（只读），因此您可能希望将它放在一个类中：

```
public class AnyClass{
  public static List<Person> myPersonObj = new ArrayList<Person>();
} 
```

然后你可以这样做：

```
AnyClass.myPersonObj 
```

访问它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T12:54:13.683

使列表在您填充它的类中成为**静态的。**

```
class Populate{
    public static List<Person> myPersonObj;
    public static void setMyPersonObj(List<Person> inst){
         myPersonObj =inst;
     } 
    public static List<Person> getMyPersonObj(){
        if(MyPersonObj!=null){
          return myPersonObj;
       }
       else {
         return new ArrayList<Person>();
       }
    } 
   //populate it 
}

class SomeOther {
public static void someMethod(){
  Populate.getMyPersonObj();
} 
```

}

# java - 延迟播放音频

> ID：15051889
> 
> 赞同：1
> 
> 时间：2013-02-24T12:51:28.263
> 
> 标签：java, audio, output-buffering, delay

目前我正在研究一个关于“延迟听觉反馈”（DAF）的项目。基本上我想从麦克风录制声音，将其延迟特定的时间，然后播放。使用大约 200 毫秒的延迟和一个戴着耳机的人，这个反馈会关闭这个人流利说话的能力。（非常有趣：[YouTube 上的 DAF](http://www.youtube.com/watch?v=DE8503EwdGY)）

现在我正在尝试使用具有 256 个字节的 byte[]-buffer 使用 SourceDataLine 和 TargetDataLine 进行此循环。如果缓冲区变大，延迟也会变大。我现在的问题是：我不知道以毫秒为单位的延迟是多少。

有什么方法可以根据缓冲区大小计算以毫秒为单位的实际延迟？或者是否有另一种方法可以得到这个结果？

这是我的循环目前的样子：

```
private int mBufferSize; // 256
private TargetDataLine mLineOutput;
private SourceDataLine mLineInput;
public void run() {

    ... creating the DataLines and getting the lines from AudioSystem ...

    // byte buffer for audio
    byte[] data = new byte[mBufferSize];

    // start the data lines
    mLineOutput.start();
    mLineInput.start();

    // start recording and playing back
    while (running) {
        mLineOutput.read(data, 0, mBufferSize);
        mLineInput.write(data, 0, mBufferSize);
    }

    ... closing the lines and exiting ...

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:28:16.140

您可以轻松计算延迟，因为它取决于音频的采样率。假设这是 CD 质量（单声道）音频，采样率为每秒 44,100 个样本。200 毫秒是 0.2 秒，所以 44,100 X 0.2 = 8820。

因此，您的音频播放需要延迟 8820 个样本（或 17640 个字节）。如果您将录制和播放缓冲区设置为这个大小（17640 字节），它将使您的代码非常简单。当每个记录缓冲区都被填满时，您将其传递给播放；这将实现恰好一个缓冲区持续时间的播放延迟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T13:12:52.720

您应该考虑 Android 固有的一些延迟，但除此之外......

创建一个循环缓冲区。不管多大，只要它对于 N 0 个样本足够大。现在用 N 个“0”样本写出来。

在这种情况下，N 是（以秒为单位的延迟）*（以赫兹为单位的采样率）。

示例：200 毫秒，16kHz 立体声：

0.2s*16000Hz*（2 通道）=3200*2 个样本 = 6400 个样本

您可能也会使用 pcm 数据，它是 16 位的，所以使用 short 而不是 byte。

用适量的零填充缓冲区后，开始读取扬声器的数据，同时填充来自麦克风的数据。

PCM 先进先出：

```
public class PcmQueue
{
    private short                mBuf[] = null;
    private int                  mWrIdx = 0;
    private int                  mRdIdx = 0;
    private int                  mCount = 0;
    private int                  mBufSz = 0;
    private Object               mSync  = new Object();

    private PcmQueue(){}

    public PcmQueue( int nBufSz )
    {
        try {
            mBuf = new short[nBufSz];
        } catch (Exception e) {
            Log.e(this.getClass().getName(), "AudioQueue allocation failed.", e);
            mBuf = null;
            mBufSz = 0;
        }
    }

    public int doWrite( final short pWrBuf[], final int nWrBufIdx, final int nLen )
    {
        int sampsWritten   = 0;

        if ( nLen > 0 ) {

            int toWrite;
            synchronized(mSync) {
                // Write nothing if there isn't room in the buffer.
                toWrite = (nLen <= (mBufSz - mCount)) ? nLen : 0;
            }

            // We can definitely read toWrite shorts.
            while (toWrite > 0)
            {
                // Calculate how many contiguous shorts to the end of the buffer
                final int sampsToCopy = Math.min( toWrite, (mBufSz - mWrIdx) );

                // Copy that many shorts.
                System.arraycopy(pWrBuf, sampsWritten + nWrBufIdx, mBuf, mWrIdx, sampsToCopy);

                // Circular buffering.
                mWrIdx += sampsToCopy;
                if (mWrIdx >= mBufSz) {
                    mWrIdx -= mBufSz;
                }

                // Increment the number of shorts sampsWritten.
                sampsWritten += sampsToCopy;
                toWrite -= sampsToCopy;
            }

            synchronized(mSync) {
                // Increment the count.
                mCount = mCount + sampsWritten;
            }
        }
        return sampsWritten;
    }

    public int doRead( short pcmBuffer[], final int nRdBufIdx, final int nRdBufLen )
    {
        int sampsRead   = 0;
        final int nSampsToRead = Math.min( nRdBufLen, pcmBuffer.length - nRdBufIdx );

        if ( nSampsToRead > 0 ) {
            int sampsToRead;
            synchronized(mSync) {
                // Calculate how many shorts can be read from the RdBuffer.
                sampsToRead = Math.min(mCount, nSampsToRead);
            }

            // We can definitely read sampsToRead shorts.
            while (sampsToRead > 0) 
            {
                // Calculate how many contiguous shorts to the end of the buffer
                final int sampsToCopy = Math.min( sampsToRead, (mBufSz - mRdIdx) );

                // Copy that many shorts.
                System.arraycopy( mBuf, mRdIdx, pcmBuffer, sampsRead + nRdBufIdx, sampsToCopy);

                // Circular buffering.
                mRdIdx += sampsToCopy;
                if (mRdIdx >= mBufSz)  {
                    mRdIdx -= mBufSz;
                }

                // Increment the number of shorts read.
                sampsRead += sampsToCopy;
                sampsToRead -= sampsToCopy;
            }

            // Decrement the count.
            synchronized(mSync) {
                mCount = mCount - sampsRead;
            }
        }
        return sampsRead;
    }
} 
```

你的代码，为 FIFO 修改...我没有使用 TargetDataLine/SourceDataLine 的经验，所以如果他们只处理字节数组，修改 FIFO 为字节而不是短。

```
private int mBufferSize; // 256
private TargetDataLine mLineOutput;
private SourceDataLine mLineInput;
public void run() {

    ... creating the DataLines and getting the lines from AudioSystem ...

    // short buffer for audio
    short[] data = new short[256];
    final int emptySamples = (int)(44100.0 * 0.2); 
    final int bufferSize = emptySamples*2; 
    PcmQueue pcmQueue = new PcmQueue( bufferSize );

    // Create a temporary empty buffer to write to the PCM queue
    {
        short[] emptyBuf = new short[emptySamples];
        Arrays.fill(emptyBuf, (short)emptySamples );
        pcmQueue.doWrite(emptyBuf, 0, emptySamples);
    }

    // start recording and playing back
    while (running) {
        mLineOutput.read(data, 0, mBufferSize);
        pcmQueue.doWrite(data, 0, mBufferSize);        
        pcmQueue.doRead(data, 0, mBufferSize);        
        mLineInput.write(data, 0, mBufferSize);
    }

    ... closing the lines and exiting ...

} 
```

# graphicsmagick - graphicsmagick 中的输出文件编号

> ID：15051890
> 
> 赞同：1
> 
> 时间：2013-02-24T12:51:28.727
> 
> 标签：graphicsmagick

我正在尝试使用以下命令将 pdf 转换为图像：

```
gm convert ./file.pdf -scene 1 thumbs/thumb%02d.jpg 
```

尽管我指定了 -scene 参数，但它什么也没做，因为我得到了从 thumb00.jpg 开始的输出文件。我需要他们从 thumb01.jpg 开始。

我正在使用 GraphicsMagick 1.3.12。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T18:10:32.387

为了确保编号的输出文件，添加 +adjoin 选项，如：

```
gm convert ./file.pdf -scene 1 +adjoin thumbs/thumb%02d.jpg 
```

这个额外的要求是由 GraphicsMagick 1.3.15 添加的。可以对所有早期版本使用相同的选项。

仍然无法指定起始场景编号。这是一个已知的错误。

# php - 这是处理表单 PHP 最安全的方法吗

> ID：15051891
> 
> 赞同：0
> 
> 时间：2013-02-24T12:51:31.873
> 
> 标签：php, forms

我只是想知道这是否是处理表单提交的最安全和最好的方式，我正在尝试找到最“安全”并为我的编码视图呈现的方式，

**PHP**

```
<?php
if(isset($_POST['submit'])) {
 //Handle the form here with many $_POST['namehere']
}
?> 
```

**HTML**

```
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="POST">
<label>Email</label>
     <input name="email" type="text">
<label>Password</label>     
     <input type="password" name="password">
<label>Submit</label>     
     <input type="submit" name="submit">
</form> 
```

这会被认为是唯一可行且最安全的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:05:37.783

为了增强表单的安全性，您应该考虑使用 XSRF 密钥/令牌。这些将使来自域外站点的请求更难成功调用您的脚本。

[http://en.wikipedia.org/wiki/Cross-site_request_forgery](http://en.wikipedia.org/wiki/Cross-site_request_forgery)

[http://query7.com/preventing-csrf-in-php](http://query7.com/preventing-csrf-in-php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T13:26:49.003

可以提高几点！

**1\. 不要使用 PHP_SELF**

将 action-formtag 留空

```
<form action='' method='post'> 
```

**2\. 转义 SQL 字符**

如果您想使用数据库，您应该从字符串中转义 SQL 字符。利用：

```
[mysql_real_escape_string($string)][1] 
```

**检查数据类型的值**

如果您有一个只需要完整数字的 from 字段，您应该删除所有字母。您可以通过在变量前面的括号中写入所需的类型来更改 PHP 变量的类型，如下所示：

```
$number=(int) $value; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T13:02:28.807

这很难回答，因为没有太多代码可以通过，但是：

**不要使用`PHP_SELF`**

```
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="POST"> 
```

不要这样做，或者至少清理值，因为使用原始值会使站点容易受到 XSS 攻击！发布给自己可以像这样简单地完成：

```
<form action="" method="POST"> 
```

或者，使用绝对（和静态）URI 作为表单目标。

*附录*

不要让其他人说服您认为您受到某种神奇的保护，因为您正在托管一个小型站点，使用某些框架 xyz 或者某些浏览器会阻止它。自己找出来并采取适当的行动。

**在 SSL 上**

如果您提交敏感数据，您应该使用 SSL！相比之下，其他任何事情都是笑话。

**在 CSRF 上**

导致站点状态更改并使用 cookie 使会话永久化的表单应受 CSRF 令牌保护；令牌必须是表单提交的一部分，并在使用后重新生成。

**关于 SQL 注入**

[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

**花絮（实际上与安全性无关）**

```
if(isset($_POST['submit'])) {
 //Handle the form here with many $_POST['namehere']
} 
```

此代码假定您的表单上始终有一个名为 的提交按钮`submit`。更通用的方法是使用此条件：

```
if ($_SERVER['HTTP_METHOD'] === 'POST') {
    // something was submitted
    if (isset($_POST['email'], $_POST['password']) {
        // email and password submitted
        // you may still wish to verify whether a "valid" email was given
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-24T13:04:10.533

你所拥有的只是一种形式。它既不安全也不不安全。定义表单是否安全的是您如何将数据传输到服务器以及如何处理服务器端的输入。

一个安全的登录表单...

*   通过 HTTPS (SSL) 将其内容发布到服务器
*   正确验证所有输入服务器端
*   不允许 SQL 注入
*   使用带有正确验证的反 CSRF 令牌的隐藏字段
*   使用具有强化 Apache/PHP 安装的服务器

关于`PHP_SELF`XSS 漏洞利用：

*   杰克在他的评论中链接的文章建议了一个实际上不起作用的字符串
*   在某些情况下*存在这种 XSS 攻击的可能性，问题是，它有多容易被利用？该漏洞是客户端，因此无法直接利用，您需要围绕它设计一些东西（反射攻击），例如一个虚假的电子邮件操作，我假装是您的网站，并提供一个链接供您登录，同时让您发布您对我的网站的凭据。或者存储攻击，但如果我能够做到这一点，那么您的网站比 PHP_SELF XSS 存在更大的问题。
*   当然，最好的办法是避免使用 PHP_SELF 并将其替换`htmlspecialchars($_SERVER['SCRIPT_NAME'])`为例如。

* 情况

*   该漏洞利用不适用于大多数现代 PHP 框架，即使它们没有保护并真正使用`PHP_SELF`，因为包含攻击字符串的 url 不会匹配任何允许的 url 路由。
*   浏览器已经开始实施 XSS 保护。例如，在撰写本文时，该漏洞在 Chrome/WebKit 和 IE8+ 中不起作用，但在 Firefox 中起作用。
*   小型私人站点极不可能成为此类攻击的目标，因为要设计一个站点需要付出一些努力。目标通常是社交网络和类似网站。

# javascript - localStorage 不会在两个页面之间持久存储

> ID：15051917
> 
> 赞同：7
> 
> 时间：2013-02-24T12:55:21.963
> 
> 标签：javascript, dom, local-storage

我正在开发一个应用程序，并且在某些时候，我需要存储需要在多个页面之间持久存在的信息，更有可能它只有 2 个页面。信息量在几个字节和大约 15KB 之间变化（永远不会超过 20KB）。我无法真正正确地预先预测它会是多少。

为此，我决定使用 localStorage。

现在我只在 localhost:8080 上工作。

这些页面现在只有通用名称：pageA.php 和 pageB.php。

这些页面位于域的根目录上。IE

```
http://localhost:8080/pageA.php
http://localhost:8080/pageB.php 
```

...

在某些时候，我将数据存储在 localStorage 的 pageA.php 上（我确实使用了 setItem() 方法）。

当用户移动到 pageB.php 时，pageB.php 的脚本会尝试获取存储在 pageA.php 中的数据。
问题是 getItem() 在 pageB.php 上总是返回 null

我确实检查了我正在使用的密钥，它们是相同的，所以那里应该没有问题。

我已经检查过，只要 url 没有改变，存储的数据就会在页面加载之间持续存在。

我在这里做错了什么？

注意：仅在 Firefox 19 和 chrome 24 上测试

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T18:30:30.623

这里的问题是我使用的编辑器已更改，因此它在搜索时区分大小写。
当我更改用于键的字符串时，由于区分大小写，替换器与所有字符串都不匹配。
我通过搜索和调整每个键来解决它，使所有键都具有相同的字符和相同的大小写，而不是相同的字符，无论大小写。
归根结底，只是注意力不集中。正如预期的那样，**javascript 中的字符串区分大小写，这也适用于 localStorage 和 sessionStorage 的键**

# sharepoint - Sharepoint 2010 普通用户和管理员用户的不同母版页

> ID：15051918
> 
> 赞同：1
> 
> 时间：2013-02-24T12:55:22.633
> 
> 标签：sharepoint, sharepoint-2010

如何让 Sharepoint 2010 为一组用户使用自定义母版页，并为另一组用户使用另一个自定义母版页？

基本上，我试图向一组用户展示 Sharepoint 的品牌缩减版本，并向管理员展示完整的管理界面。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:42:10.637

这是不可能的。有一个与 SPWeb ( [`SPWeb.MasterUrl`](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spweb.masterurl.aspx)) 关联的母版页。

为不同类型的用户拥有不同“母版页”的唯一可能性是使用安全修整。您将不得不使用 WebPart 和其他经过安全调整的东西来为管理员/普通用户显示不同的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T09:02:55.420

有一个解决方案。通常我们创建两个不同的母版页来管理它。一个包含所有员工的管理员母版页，可用于诸如 Ribbon 之类的管理员。

其他版本只有 fp 匿名用户，其中生成的 HTML 是干净的，并且没有为最终用户生成额外的 SharePoint 员工。这减少了匿名用户的页面流量和时间负载。

[这](http://johanleino.wordpress.com/2011/10/20/using-a-different-master-page-for-authenticated-users-in-sharepoint/)是一篇非常有用的文章，它是如何完成的。我们以同样的方式实施并且运作良好。

希望对你有帮助

安德鲁

# flash - 错误 #3661：AGAL 验证失败：临时寄存器索引超出范围

> ID：15051920
> 
> 赞同：0
> 
> 时间：2013-02-24T12:55:40.190
> 
> 标签：flash, stage3d, agal

我有这个错误

```
Error: Error #3661: AGAL validation failed: Temporary register index out of bounds for source operand 2 at token 5 of vertex program. 
```

尝试转换此 GLSL 时：

```
attribute vec3 aVertexPosition;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
    } 
```

到这段代码：

```
mov vt0.w, vc0.x
mov vt0.xyz, va0.xyz

mov vt1.xyzw, vc1
mul vt5.xyzw, vt1, vc5
m44 op.xyzw, vt0.xyzw, vt5 
```

我该如何解决这个问题？有什么建议吗？谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T17:59:03.703

只有 8 个临时寄存器 vt0 - vt7。您试图在 vt5 中存储一个 4x4 矩阵，但它后面只有两个寄存器：没有足够的空间。

我建议您使用 vt1 来存储矩阵和接收矩阵乘法的内容：

```
mov vt0.w, vc0.x
mov vt0.xyz, va0.xyz

mov vt1, vc1
mul vt1, vt1, vc5
m44 op, vt0, vt1 
```

唯一的问题是我认为 mul 不会进行真正的矩阵乘法，而是进行分量乘法，而 m44 在 4x4 矩阵和 4 分量向量之间进行乘法。根据我的阅读，我不确定如何在 agal 中将两个矩阵相乘。您可能必须在 actionscript 中进行矩阵乘法。让我知道发生什么事！

# android - 使用 PhysicsEditor 在 box2d (AndEngine) 中为碰撞创建独特的物体

> ID：15051921
> 
> 赞同：1
> 
> 时间：2013-02-24T12:55:44.833
> 
> 标签：android, box2d, andengine, collision

我最近一直在开发一个游戏，我想加入像素完美碰撞（所以它忽略了图像的 alpha 部分）

在做了一些研究之后，我被推荐使用软件 PhysicsEditor 为您创建在 box2d 中使用的独特物体：

[http://www.codeandweb.com/physicseditor](http://www.codeandweb.com/physicseditor)

软件本身很好用，我已经准备好所有 .xml 文件可以使用，并且我的项目中的所有内容都设置好了

我也一直在查看此处提供的示例：

[https://github.com/ANDLABS-Git/AndEngine-PhysicsEditor-Extension-Examples/tree/master/src/org/andlabs/andengine/extension/physicsloader](https://github.com/ANDLABS-Git/AndEngine-PhysicsEditor-Extension-Examples/tree/master/src/org/andlabs/andengine/extension/physicsloader)

我的问题是我不完全确定从哪里开始检测碰撞 - 我了解基本的 box2d 碰撞是如何工作的，但我不知道如何使用从 PhysicsEditor 创建的任何东西

我对android编程很陌生，所以我不太明白如何在我的项目中使用PhysicsEditor以及如何将它创建的内容用作可以附加到精灵的主体等 - （除非它全部包含在加载器中，它是自己的?)

在我使用了加载器（如示例中所示）之后 - 我从这里做什么？

我似乎也找不到任何其他使用 PhysicsEditor 的人在他们的项目中发生碰撞的例子，所以我被困在做什么。

（我还查找了完美像素碰撞的其他替代方案，但设置起来似乎更麻烦）

任何帮助将不胜感激，使用 PhysicsEditor 碰撞的基本项目示例或某种假人教程将是理想的。

谢谢

# vb.net - 如何从失败的 webclient.downloadstring 中获得结果？

> ID：15051923
> 
> 赞同：1
> 
> 时间：2013-02-24T12:55:56.460
> 
> 标签：vb.net

如果我们在出错的服务器上使用 webclient.downloadstring，我们什么也得不到

```
 Try
            result = webClient.DownloadString("https://api.bodis.com/domainclassification?domain=" + CurrentBlog.Domain)
        Catch ex As Exception
            System.Windows.Forms.Application.DoEvents()
        End Try 
```

通常结果包含响应。但万一出错结果为空。

我想知道一些事情。例如，即使结果不好，通常也会有自定义的 404 消息等。

api.bodis.com 是有问题的，因为它混合了安全和非安全的东西。但是，它无论如何都会在 Internet Explorer 中提供输出。我想使用 webclient，我想知道输出

得到 ex.response 没有任何结果

```
 Dim adult = webClient.DownloadString("http://googleads.g.doubleclick.net/apps/domainpark/domainpark.cgi?callback=_google_json_callback&output=js&client=ca-dp-godaddy2_xml&domain_name=" + CurrentBlog.Domain)
        'ias.NavigateTillComplete("https://api.bodis.com/domainclassification?domain=" + CurrentBlog.Domain)
        Dim result = ""
        Dim url = "http://api.bodis.com/domainclassification?domain=" + CurrentBlog.Domain
        Dim webRequest = DirectCast(System.Net.HttpWebRequest.Create(url), System.Net.HttpWebRequest)
        Dim response As HttpWebResponse
        Try
            response = DirectCast(webRequest.GetResponse(), HttpWebResponse)
        Catch ex As System.Net.WebException
            System.Windows.Forms.Application.DoEvents()
            response = DirectCast(ex.Response, HttpWebResponse) 'is nothing there
        End Try

        Dim responseStream = response.GetResponseStream 
```

# json - joomla 会话中的可用性变量

> ID：15051925
> 
> 赞同：0
> 
> 时间：2013-02-24T12:56:09.817
> 
> 标签：json, session, select, joomla

我有一个包含以下页面的框架集：

```
top.php
left.php
right.html 
```

right.html 通过 json 方法使用 database.php 访问数据库并传递变量。Left.php 具有选择列表，由数据库中的项目生成。选中后，该变量将存储在 Joomla 会话中，并刷新右侧页面。随着刷新 database.php 被 json 激活。

我的问题是：

我能够将变量存储在 Joomla 会话中。当我在 left.php 中对这个变量执行回显时，该变量会显示在屏幕上。但是，当我第一次激活 database.php 时，它不会从 joom 会话变量中获取值。虽然它已经在 left.php 中设置。但是，当我从 left.php 选择框中选择一个项目时，它确实有效。

以下代码在 left.php 中用于设置和获取变量：

```
//If the input select item was selected (when the user has selected a item from                                                     
select box) use that item to fill the Joomla session variable.
if(isset($_POST['PeriodeSelectname'])){
$JaarKwartaal=$_POST['PeriodeSelectname'];
$session->set('JaarKwartaal', $JaarKwartaal);
//echo "<P>session-set=" . $session->get('JaarKwartaal');
}

//if no item of the input select is selected (in case of the first time) the first 
item of the $periodes array to fill the Joomla session variable
if(!isset($_POST['PeriodeSelectname'])){
$session->set('JaarKwartaal', $periodes[0]);
//echo "<P>session-notset=" . $session->get('JaarKwartaal');
} 
```

我究竟做错了什么？

提前致谢！

皮特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T06:53:14.083

你做错了什么：

1.  使用框架。这不是 1995 年。继续前进
2.  如果要读取会话变量，则应设置它们；现在看来您只使用 POST，这在第二次调用时将不可用。

# ios - 在 iOS 上播放 youtube 视频

> ID：15051927
> 
> 赞同：7
> 
> 时间：2013-02-24T12:56:27.630
> 
> 标签：ios, objective-c, uiwebview, youtube, mpmovieplayercontroller

我想知道像 McTube ( [https://itunes.apple.com/us/app/mctube-for-youtube/id559618284?mt=8](https://itunes.apple.com/us/app/mctube-for-youtube/id559618284?mt=8) ) 这样的应用程序如何播放 youtube 视频。它看起来像一个习惯`MPMoviePlayerController`，但这是允许的吗？

顺便说一句，我需要我无法实现的自动播放`UIWebView`，这就是我想知道的原因。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-24T13:18:15.173

有些 YouTube 视频可以播放`MPMoviePlayerController`- 有些不能。当您通过 YouTube 数据 API（[此处的链接](https://developers.google.com/youtube/2.0/reference#Videos_feed)）查询视频时，您将获得可用于特定视频的所有内容类型，包括 Flash 播放器、3GPP、MP4（*如果可用*）等。您可以使用这些 URL加载一个`MPMoviePlayerController`.

这很好，但正如我所说 - 并非所有视频都可以以这种方式嵌入。某些视频（主要是需要显示广告的视频）无法放入原生控制器。

# php - 关于输入具有相同名称的问题

> ID：15051928
> 
> 赞同：0
> 
> 时间：2013-02-24T12:56:28.437
> 
> 标签：php, html, post

有没有办法可以区分具有相同名称的值？

```
<input type="hidden" name="id" value="name1">
<input type="hidden" name="id" value="name2">
<input type="hidden" name="id" value="name3"> 
```

有没有办法当我发布一个 id 时，将发布的值是 name2？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:02:03.257

使用数组作为名称

```
<input type="hidden" name="id[]" value="name1">
<input type="hidden" name="id[]" value="name2">
<input type="hidden" name="id[]" value="name3"> 
```

它提供了数组中的所有值。

希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T12:58:33.313

对不同的变量使用不同的名称。

```
<input type="hidden" name="id2" value="name2"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T13:01:13.910

不，你不能那样做。您需要指定不同的名称或使用类似数组的东西。这可以通过设置名称 id[] 来完成。

要你做什么？

您可以使用 javascript 动态设置隐藏字段的值，如果这是您正在寻找的。

# css - 如何通过 webkit 动画缩放图像随着时间的推移

> ID：15051935
> 
> 赞同：1
> 
> 时间：2013-02-24T12:57:41.243
> 
> 标签：css, image, webkit, transitions

我在一个简单的画廊中收集了图像，我想在鼠标悬停时从小到大平滑地转换。我目前正在通过在鼠标悬停时显示图像的实际大小但在没有时将其强制为特定大小并使用 display:none 隐藏实际大小来做到这一点。

我想包含一些 webkit 转换**，以便在 1 秒内完成此操作**以改进转换。我知道 webkit 是在两个状态之间转换一个元素但是无论如何我可以做到这一点。

我也想避免使用 JavaScript。

```
.reveal a .preview
{
    display: none;
}

.reveal a:hover .preview
{
    display: block;
    position: absolute;
    z-index: 1;
}

.reveal img
{
    background: #fff
    padding: 2px;
    vertical-align: top;
    width: 100px;
    height: 75px;
}

.reveal li
{
    background: #eee;
    display: inline;
    float: left;
    margin: 3px;
    padding: 5px;
    position: relative;
}

.reveal .preview
{
    border-color: #000;
    width: auto;
    height: auto;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T14:03:45.153

如果没有 html（即 jsfiddle），我很难在您的代码中插入解决方案。但这是一个通用解决方案[http://jsfiddle.net/9QVae/2/](http://jsfiddle.net/9QVae/2/)

```
img
{
    width:100px;
    height:100px;
    background:red;
    transition:width 1s, height 1s;
    -moz-transition:width 1s, height 1s, -moz-transform 1s; /* Firefox 4 */
    -webkit-transition:width 1s, height 1s, -webkit-transform 1s; /* Safari and Chrome */
    -o-transition:width 1s, height 1s, -o-transform 1s; /* Opera */
} 
```

悬停时：

```
img:hover
{
    width:200px;
    height:200px;
} 
```

所以[诀窍](http://www.w3schools.com/css3/css3_transitions.asp)是指定要添加效果的css属性（即宽度），然后指定事件的持续时间，即然后在选择器`transition:width 1s;`下指定最终尺寸`:hover`

**注意：** `transition`不适**用于**IE

# class - 将父类的引用传递给子类

> ID：15051936
> 
> 赞同：0
> 
> 时间：2013-02-24T12:57:47.807
> 
> 标签：class, coffeescript

我正在尝试将对父类实例的引用传递给它的子类。父类是：

```
class UI

  constructor: (parameters) ->

    @addBTS = new AddBTS
    @toolbar = new Toolbar(this) 
```

AddBts 和 Toolbar 类是：

```
class Toolbar
  constructor: (@parent) ->

  add_bts_clickhandler: () =>
    $('body').on 'click', '#add_bts', ->
      @parent.addBTS.display() 
```

```
class AddBTS
  constructor: () ->

  display: () =>
    $("#setBuildingTileSet").show()
    console.log 'Showing Sir' 
```

所有这些类都定义在单独的 CoffeeScript 文件中，并在组合之前按以下顺序连接在一起（游戏是 UI 实例所在的位置）：

```
 'src/Game'
  'src/UI/UI'
  'src/UI/AddBTS'
  'src/UI/Toolbar' 
```

不，当我打电话时，`add_bts_clickhandler: ()`我收到错误消息： * 无法读取未定义的属性 'addBTS' *

所以它认为 parent 是未定义的，但显然不是。

请有人可以帮助我，因为我的代码接缝很好，我完全被卡住了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T20:18:37.593

我的解决方案：

我调用 add_bts_clickhandler：

```
ui = new window.UI();
ui.toolbar.add_bts_clickhandler(); 
```

我的课程：

```
class window.UI
  constructor: (parameters) ->
    @addBTS = new window.AddBTS
    @toolbar = new window.Toolbar(this)

class window.AddBTS
  constructor: () ->

  display: () =>
    $("#setBuildingTileSet").show()
    console.log 'Showing Sir'

class window.Toolbar
  constructor: (@parent) ->

  add_bts_clickhandler: () =>
    p = @parent  ## introduce a new variable!
    $('body').on 'click', '#add_bts', ->
      p.addBTS.display(); ##
      #@parent.addBTS.display() 
```

让我们仔细看看 Toolbar 类：

```
class window.Toolbar
    constructor: (@parent) ->

    add_bts_clickhandler: () =>
        $('body').on 'click', '#add_bts', ->
            @parent.addBTS.display() 
```

部分生成的javascript：

```
Toolbar.prototype.add_bts_clickhandler = function() {
    return $('body').on('click', '#add_bts', function() {
        return this.parent.addBTS.display();
    });
}; 
```

在这一行：返回**这个**.parent.addBTS.display();
**this**指的是回调函数（）！不是 add_bts_clickhandler。

我希望我对你有所帮助。

# chef-infra - 如何将 Berkshelf 与 Chef-solo 一起使用？

> ID：15051938
> 
> 赞同：6
> 
> 时间：2013-02-24T12:58:03.893
> 
> 标签：chef-infra, vagrant

我正在尝试与 Berkshelf 一起管理食谱。以下是步骤

```
$ berks init  # and use a custom Vagrant box image
$ vim Berksfile  # and put cookbook 'git'
$ berks install
$ vagrant up 
```

我希望最后一步为 VM 配置`git`说明书，但是我得到：

```
$ bin/vagrant up
/Users/pmu/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/hashie-2.0.0/lib/hashie/mash.rb:80：警告：重新定义“object_id”可能会导致严重的问题
[默认] 导入基础框 'Ubuntu-11.04'...
[默认] NAT 网络的匹配 MAC 地址...
[默认] 清除任何以前设置的转发端口...
[默认] 转发端口...
[默认] -- 22 => 2222（适配器 1）
[Berkshelf] 安装食谱...
[Berkshelf] 使用 git (2.3.0)
[Berkshelf] 使用 dmg (1.1.0)
[Berkshelf] 使用 build-essential (1.3.4)
[Berkshelf] 使用 yum (2.1.0)
[Berkshelf] 使用 windows (1.8.4)
[Berkshelf] 使用 chef_handler (1.1.4)
[Berkshelf] 使用 runit (1.0.6)
[默认] 创建共享文件夹元数据...
[默认] 清除任何以前设置的网络接口...
[默认] 根据配置准备网络接口...
[默认] 正在启动虚拟机...
[默认] 等待虚拟机启动。这可能需要几分钟。
[默认] VM 已启动并可以使用！
[默认] 配置和启用网络接口...
[默认] 设置主机名...
[默认] 正在装载共享文件夹...
[默认] -- v-root: /vagrant
[默认] -- v-csc-1: /tmp/vagrant-chef-1/chef-solo-1/cookbooks
[默认] 运行供应商：Vagrant::Provisioners::ChefSolo...
[默认] 生成厨师 JSON 并上传...
[默认] 运行厨师独奏...
标准输入：不是 tty
[2013-02-24T12:51:04+00:00] 信息：***厨师 10.18.2 ***
[2013-02-24T12:51:05+00:00] 信息：从 JSON 将 run_list 设置为 ["recipe[berkshelf-test::default]"]
[2013-02-24T12:51:05+00:00] 信息：运行列表是 [recipe [berkshelf-test::default]]
[2013-02-24T12:51:05+00:00] 信息：运行列表扩展为 [berkshelf-test::default]
[2013-02-24T12:51:05+00:00] 信息：为 ubuntu-11.04 启动 Chef Run
[2013-02-24T12:51:05+00:00] 信息：运行启动处理程序
[2013-02-24T12:51:05+00:00] 信息：启动处理程序完成。
[2013-02-24T12:51:05+00:00] 错误：运行异常处理程序
[2013-02-24T12:51:05+00:00] 错误：异常处理程序完成
[2013-02-24T12:51:05+00:00] 致命：Stacktrace 转储到 /tmp/vagrant-chef-1/chef-stacktrace.out
[2013-02-24T12:51:05+00:00] 致命：Chef::Exceptions::CookbookNotFound：Cookbook berkshelf-test not found。如果您从另一本食谱加载 berkshelf-test，请确保在元数据中配置依赖项
厨师从未成功完成！任何错误都应该在
上面的输出。请修复您的食谱，以便它们正确完成。

```

Vagrantfile 中的 chef-solo 部分：

```
  config.vm.provision :chef_solo 做 |chef|
    厨师.json = {
      :mysql => {
        :server_root_password => 'rootpass',
        :server_debian_password => 'debpass',
        :server_repl_password => 'replpass'
      }
    }

    chef.run_list = [
      “配方 [berkshelf-test::default]”
    ]
  结尾

```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-24T13:14:00.160

在这种情况下，问题出`chef.run_list`在您的 Vagrantfile 中 - 它指示 Chef 从“berkshelf-test”食谱中加载“默认”配方。如果您使用 git 食谱进行测试，您可能需要`"recipe[git::default]"`。

您可能还需要添加`require 'berkshelf/vagrant'`到 Vagrantfile 的顶部。有关更多解释，请参阅[Berkshelf 主页](http://berkshelf.com)上的“Vagrant With Berkshelf”部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-08T21:27:32.167

我收到了这个错误，根本原因是插件如何处理共享文件夹的问题。此问题中的答案修复了它：[Vagrant + Chef：配置错误“Chef 需要的共享文件夹在虚拟机上丢失。”](https://stackoverflow.com/questions/27975541/vagrant-chef-error-in-provision-shared-folders-that-chef-requires-are-missin)

```
rm .vagrant/machines/default/virtualbox/synced_folders
vagrant reload --provision 
```

# mongodb - 在特定位置插入一个嵌入式阵列 - 我的解决方法可以在生产中工作吗？

> ID：15051946
> 
> 赞同：0
> 
> 时间：2013-02-24T12:59:24.353
> 
> 标签：mongodb

我在 MongoDB 中存储时间序列，结构如下：

```
{
  "_id" : ObjectId("5128e567df6232180e00fa7d"),
  "values" : [563.424, 520.231, 529.658, 540.459, 544.271, 512.641, 579.591, 613.878, 627.708, 636.239, 672.883, 658.895, 646.44, 619.644, 623.543, 600.527, 619.431, 596.184, 604.073, 596.556, 590.898, 559.334, 568.09, 568.563],
  "day" : 20110628,
} 
```

values-array 表示每小时的一个值。所以 position 很重要，因为 position`0 = first hour`等等`1 = second hour`。

更新特定小时的值非常容易。例如，要更新一天中的第 7 个小时，我这样做：

```
db.timeseries.update({day:20130203},{$set : {values.6 : 482.65}}, {upsert : true}) 
```

我的问题是我想使用**upsert**，就像这样

```
db.timeseries.update({day:20130203},{$set : {values.6 : 482.65}}) 
```

但是如果文档不存在，MongoDB 将创建一个嵌入式文档而不是嵌入式数组。像这样：

```
{
  "_id" : ObjectId("5128e567df6232180e00fa7d"),
  "values" : {"6" : 482.65},
  "day" : 20130203,
} 
```

有一张票可以添加一个功能来解决这个问题[，](https://jira.mongodb.org/browse/SERVER-2363?focusedCommentId=157076&page=com.atlassian.jira.plugin.system.issuetabpanels%3acomment-tabpanel)但同时我想出了一个解决方法来解决这个问题。

我所做的是，我首先在**day-field 上创建了一个 uniqe-index**。每当我想更新每小时的音量时，我都会执行这两个命令。

```
db.timeseries.insert({day:20130203, values : []}); // Will be rejected if it exists
db.timeseries.update({day:20130203},{$set : {values.6 : 482.65}}); 
```

第一条语句试图创建一个新文档 - 由于 uniqe-index 插入，如果它已经存在，它将被拒绝。如果没有，将创建一个包含值字段嵌入数组的文档。这可确保更新正常工作。

结果：

```
{
  "_id" : ObjectId("5128e567df6232180e00fa7d"),
  "values" : [null,null,null,null,null,null,482.65],
  "day" : 20130203,
} 
```

**这是我的问题**

在生产中，当这样的几个命令同时运行时，我可以确定我的更新命令将在我的插入命令**之后执行吗？***请注意，我想在不安全模式下运行这两个命令，即我不会等待来自服务器的任何响应。*

（这里从性能的角度评论我的解决方法也很有趣。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T15:49:47.283

通常是的，有一种方法可以确保来自客户端的两个请求使用相同的连接。通过使用相同的连接，您可以在服务器上强制执行严格的顺序。

对于不同的驱动程序，实现这一点的方法是不同的。

对于[异步 Java 驱动程序](http://www.allanbank.com/mongodb-async-driver/)，您可以从初始 MongoClient 实例创建一个“序列化”的 MongoClient，它将确保所有请求都使用单个连接。

对于 10gen java[驱动程序](https://github.com/mongodb/mongo-java-driver/downloads)，它将自动（通过 ThreadLocal）尝试使用相同的连接。您还可以通过 DB.requestStart()/DB.requestEnd() 方法向驱动程序提示一组命令需要流水线。

startRequest/endRequest 适用于大多数 10gen 驱动程序。作为另一个例子，PyMongo 驱动程序 mongo_client 有一个[start_request()](http://api.mongodb.org/python/2.4.2/api/pymongo/mongo_client.html#pymongo.mongo_client.MongoClient.start_request) /end_request() 对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T16:20:49.697

从性能的角度来看，只使用一次访问数据库比使用两次要好。您不能使用 $push 而不是 $set 来更新值字段吗？

# c - 将嗅探器的转储输出到 C 中的外部文件

> ID：15051950
> 
> 赞同：-1
> 
> 时间：2013-02-24T12:59:31.517
> 
> 标签：c, pcap, sniffer

我正在创建一个简单的嗅探器，只是为了好玩，我想将转储输出到文件中。这是嗅探器的代码：

```
#include <stdio.h>
#include <pcap.h>

#define MAX_PACKET_NUM 5

int main(void) {

    struct pcap_pkthdr header;
    const u_char *packet;
    char errbuf[PCAP_ERRBUF_SIZE];
    char *device;
    pcap_t *pcap_handle;
    int i;

    printf("## Now sniffing on: %s ##\n", device);
    printf("## Max packets number for this session: %d\n", MAX_PACKET_NUM);

    printf("[?] Sniffing...\n");

    pcap_handle = pcap_open_live(device, 1000, 1, 0, errbuf);

    for(i=0; i < MAX_PACKET_NUM; i++) {
        packet = pcap_next(pcap_handle, &header);
        printf("[!] Captured a %d bytes packet!\n", header.len);
        dump(packet, header.len);
    }
} 
```

它工作正常，但是如何将转储输出到文件？我尝试使用文件流，但我真的不知道如何输出函数。如您所见，*dump()*函数将输出打印到屏幕上，也许有输出到文件的函数？请帮帮我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T13:00:26.353

您正在寻找`fprintf`功能。用于`fopen`打开文件，`fprintf`写入文件，最后`fclose`关闭文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T19:40:36.873

如果您的嗅探器在某些版本的 UN*X 或 Windows 上从命令行运行，并且如果它通过使用`printf()`（而不是`fprintf()`）“将输出打印到屏幕”，那么它真正做的是打印其输出到“标准输出”。

在这种情况下，您可以在 UN*X 和 Windows 上，通过将标准输出“重定向”到文件来将输出发送到文件；这将完成

```
mysniffer {command-line arguments} > {pathname to the file} 
```

# paypal - 留在我的网站上还是转移到贝宝？

> ID：15051952
> 
> 赞同：-1
> 
> 时间：2013-02-24T12:59:44.423
> 
> 标签：paypal, user-experience

一般来说，客户更喜欢哪一种？留在我的网站或转移到贝宝完成购买？

客户是否更喜欢贝宝品牌页面的安全性？还是用户更愿意留在我的网站上并通过 api 处理付款？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:03:27.063

老实说，将它们发送到贝宝可能值得。大多数在线“买家”不会有偏好，因为他们不太了解。然而，有些人会再次确信他们正在与熟悉的品牌互动。

我已经在我写的一些网站上遇到过这个问题。有些人甚至不会在网站上注册，因为害怕人们窃取他们的信息。有趣的是，这些人会打电话给商店，并通过电话愉快地提供所有重要信息。太疯狂了！:)

我想这一切都取决于个人，但重定向到 Paypal 并让他们完成它可能是最简单的选择。！

# vb.net - 无法获取要编译的 lambda 代码示例

> ID：15051954
> 
> 赞同：1
> 
> 时间：2013-02-24T13:00:01.397
> 
> 标签：vb.net, syntax, lambda

我想尝试在这里找到的一些简单代码：

[http://msdn.microsoft.com/en-au/library/ff664617%28v=pandp.50%29.aspx](http://msdn.microsoft.com/en-au/library/ff664617%28v=pandp.50%29.aspx)

但是我无法编译它，我一定是做错了什么。在页面的大约三分之一处，它给出了如下代码示例：

> '使用 exManager.Process(Function() 方法名(param1, param2), _"异常策略名称")

但是如果我输入以下代码：

```
Dim exManager As ExceptionManager
exManager = EnterpriseLibraryContainer.Current.GetInstance(Of ExceptionManager)()
exManager.Process(Function() TestSub(), "Exception Policy Name") 
```

我在第三行收到一个错误，上面写着：

> 重载解决失败，因为无法使用这些参数调用可访问的“进程”：“公共可重写函数进程（TResult）（操作作为 System.Func（TResult），policyName As String）作为 TResult”：无法引用实例成员来自共享方法或共享成员初始化程序中的类，而没有该类的显式实例。
> 
> 'Public Overridable Function Process(Of TResult)(action As System.Func(Of TResult), policyName As String) As TResult'：无法从这些参数推断类型参数的数据类型。明确指定数据类型可能会更正此错误。
> 
> 等等

即使我尝试像这样修改 lambda：

```
exManager.Process(Function() Dim A As Integer=6, "Exception Policy Name") 
```

我收到类似的错误。

任何意见将不胜感激。

**更新：**

注意我正在为 .NET Framework 4 Client Profile 进行编译

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T08:50:43.910

当您调用时，您正在使用`Process(Of TResult)`重载`exManager.Process(Function() TestSub(), "Exception Policy Name")`。

该方法是通用的，期望和类型参数 ( `TResult`)，在很多情况下可以由编译器推断。现在异常告诉您，在您的情况下，编译器可以推断`TResult`.

我猜你`TestSub`真的是 a `Sub`，因此没有编译器可以用来推断的返回值`TResult`。

* * *

`Process`因此，通过使用`Sub`而不是使用非泛型方法`Function`

```
exManager.Process(Sub() TestSub(), "Exception Policy Name") 
```

或干脆使用`AddressOf`：

```
exManager.Process(AddressOf TestSub, "Exception Policy Name") 
```

# javascript - 为什么对于在更高范围和稍后在当前范围初始化的变量未定义？

> ID：15051959
> 
> 赞同：1
> 
> 时间：2013-02-24T13:00:30.257
> 
> 标签：javascript

为什么对于在更高范围和稍后在当前范围初始化的变量未定义？

当前代码输出：第一个“未定义”和第二个“我是本地的”。

为什么会这样？这是什么问题，这个问题的名称是什么？它背后的概念是什么？

```
var testVar = "i'm global";
function example( ) {
    alert(testVar); 
    var testVar = "i'm local";
    alert(testVar);   
 }
 example(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:06:04.270

你只得到本地的`testVar`，因为当你进入`example`你声明的函数的范围时`testVar`，你会覆盖`testVar`. 在第一个`alert`你应该得到`undefined`，因为`testVar`在那之后有 but的声明`alert`。在第二个警报中，您将获得本地值，因为`testVar`已定义。

要获取外部变量，只需以不同的方式命名或将其作为参数传递：

```
var testVar = "i'm global";
function example(globalTestVar) {
    alert(globalTestVar); 
    var testVar = "i'm local";
    alert(testVar);   
 }
 example(testVar); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T13:04:54.440

您的代码相当于：

```
<script type="text/javascript">
   var testVar = "i'm global";
   function example( ) {
      var testVar;
      alert(testVar); 
      testVar = "i'm local";
      alert(testVar);   
    }
    example();     
</script> 
```

所以第一个`alert`局部变量`testvar`是未定义的。`var`移动到范围的开头。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-24T13:07:28.753

`var`从局部变量中删除。它使浏览器认为`testVar`一个局部变量，在第一次警报时未定义。 [http://jsfiddle.net/N5Yf3/](http://jsfiddle.net/N5Yf3/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-24T13:08:08.117

试试这个它应该提醒两者，你需要先定义`testVar`内部函数。

```
 <script type="text/javascript">
    function example( ) {
        var testVar = "i'm global";
        alert(testVar); 
        var testVar = "i'm local";
        alert(testVar);   

     }
         example();     
</script> 
```

# c# - EntityFramework - 将复杂属性映射到 json（字符串）列

> ID：15051964
> 
> 赞同：4
> 
> 时间：2013-02-24T13:01:07.993
> 
> 标签：c#, .net, entity-framework

我有以下实体：

```
public class SampleClass
{
  public int Id { get; set; }
  public object Args {get; set; }
} 
```

因为`Args`可以是不同的类型并且不需要可查询，所以我想将它作为 json 字符串存储在数据库中。

我知道以下解决方法可以解决我的问题：

```
public class SampleClass
{
  public int Id { get; set; }
  public object Args { get { return Json.Deserialize(ArgsJson); } set { ArgsJson = Json.Serialize(value); } }
  public string ArgsJson {get; set; }
} 
```

但这很丑陋，因为它暴露了与模型无关的信息，并且又包含与模型无关的逻辑。

我想做的是这样的：

```
public class SampleClassMapper : EntityTypeConfiguration<SampleClass>
{
  public SampleClassMapper()
  {
    this.Property(e => e.Args).MapAs<string>(arg => Json.Serialize(arg), str => Json.Deserialize(str));
  }
} 
```

有什么很酷的方法吗？

（如果有帮助，我将 .Net 4.0 与 EntityFramework 5 和 Sql Server 2008 一起使用）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-23T19:05:19.997

您这样做的方式是目前 EF 中唯一可用的方式。目前 EF Code First 没有任何简单的方法来更改对象序列化，但这可以通过在运行时修改 EDMX 文件来完成。

# python - 使用 NLP 测量文本的丰富信息

> ID：15051969
> 
> 赞同：0
> 
> 时间：2013-02-24T13:01:39.893
> 
> 标签：python, nlp, nltk

是否有任何衡量文本信息丰富程度的指标？

我正在考虑任何可以在文本中可靠地显示独特信息段的东西。使用频率分布或唯一词的简单度量是可以的，但它们并不能完全显示句子中的唯一信息。

使用编码方法，我必须手动编码每个句子/单词或任何可以算作文本中唯一信息的内容，但这可能需要一段时间。所以，我想知道我是否可以使用 NLP 作为替代方案。

更新

举个例子：

Navtilos，圣托里尼火山的一个小火山岛，于 1928 年喷发形成。

如果我使用编码分析，我可以数出 4 个独特的信息点：什么是 Navtilos，它在哪里，它是如何创建的以及何时创建的。

显然，人类对文本的解释与计算机不同。我只是想知道是否有一种方法可以识别句子/文本中的独特信息。它不必产生与我相同的结果，但在不同的句子中是可靠的。

频率分布可能有效，但我想知道是否还有其他指标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T20:43:07.490

您似乎正在寻找的是关键字/术语提取器（有关关键字提取器的列表，请参见例如[this](http://en.wikipedia.org/wiki/Terminology_extraction)，“外部链接”）。提取器将提取由一个或多个单词组成的短语，这些单词捕获了文本中提到的一些概念，但不会将它们分类为类别（正如命名实体识别器所做的那样）。

例如，参见这个[演示](http://nlp.skyttle.com/api/nlp/te/submit/)。从您示例中的句子中，它提取：

```
small volcanic islet
Navtilos
Santorini 
```

如果您有很多文档，则可以使用文档中每个关键字的频率分布来衡量它对每个文档的具体程度（假设文档的关键字的唯一性反映了它对文档内容的描述程度）。为此，您可以使用[tf-idf 之](http://en.wikipedia.org/wiki/Tf%E2%80%93idf)类的度量。

# xml - 使用杰克逊将xml转换为json

> ID：15051973
> 
> 赞同：2
> 
> 时间：2013-02-24T13:02:18.970
> 
> 标签：xml, json, jackson

我想将 xml 转换为 json。

xml的格式如下——

```
 <default> 
      <column>                      
        <title>Title 1</title>
    <id>id1</id>
    <value>val1</value>
  </column>
  <column>
    <title>Title 2</title>
    <id>id2</id>
    <value>val2</value>
  </column>
  <column>
    <title>Title 3</title>
    <id>id3</id>
    <value>val3</value>
  </column>
  </default> 
```

在转换之后，我期待跟随 json -

```
{
    "column": [
        {
            "title": "Title 1",
            "id": "id1",
            "value": "val1"
        },
        {
            "title": "Title 2",
            "id": "id2",
            "value": "val2"
        },
        {
            "title": "Title 3",
            "id": "id3",
            "value": "val3"
        }
    ]
} 
```

但是当我为此目的使用杰克逊时，它给了我以下 json -

```
{
    "column": {
        "title": "Title 3",
        "id": "id3",
        "value": "val3"
    }
} 
```

我曾尝试使用杰克逊 1.9 和杰克逊 2.1，但它没有给我预期的输出。

有人可以让我知道是否有可能或我需要更改我的 xml 格式？以下是我为实现上述场景而编写的代码 -

```
 try {
            XmlMapper xmlMapper = new XmlMapper();
            Map entries = xmlMapper.readValue(new File("xmlPath"), Map.class);

            ObjectMapper jsonMapper = new ObjectMapper();
            String json = jsonMapper.writeValueAsString(entries);
            System.out.println(json);

        } catch (Exception e) {
            e.printStackTrace();
        } 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-07T19:06:38.353

[通过使用org.json](http://mvnrepository.com/artifact/org.json/json/20160212) API 将源 XML 转换为[JSONObject](http://www.docjar.com/docs/api/org/json/JSONObject.html)，然后通过 Jackson API 转换为 JSON，我能够解决这个问题。

**代码**

```
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;

import org.apache.commons.io.IOUtils;
import org.json.JSONObject;
import org.json.XML;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;

...
...

try (InputStream inputStream = new FileInputStream(new File(
                "source.xml"))) {
    String xml = IOUtils.toString(inputStream);
    JSONObject jObject = XML.toJSONObject(xml);
    ObjectMapper mapper = new ObjectMapper();
    mapper.enable(SerializationFeature.INDENT_OUTPUT);
    Object json = mapper.readValue(jObject.toString(), Object.class);
    String output = mapper.writeValueAsString(json);
    System.out.println(output);
}

...
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-13T21:07:37.017

在进行小组项目时，我遇到了您描述的相同问题。我们用来让它工作的解决方案是将我们的 Maven 依赖项从 Jackson 更改为 json-lib。我们将此站点用作指南：[http ://answers.oreilly.com/topic/278-how-to-convert-xml-to-json-in-java/](http://answers.oreilly.com/topic/278-how-to-convert-xml-to-json-in-java/)

```
<dependency>
    <groupId>net.sf.json-lib</groupId>
    <artifactId>json-lib</artifactId>
    <version>2.4</version>
    <type>jar</type>
    <classifier>jdk15</classifier>
    <scope>compile</scope>
</dependency> 
```

--$pli7

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-25T14:48:27.913

我也遇到了这个问题，使用杰克逊 2.5。我的解决方案是`javax.json.JsonObjectBuilder`用我自己的替换 in use 的实现，当添加新对象时，它的行为如下：

```
public class CustomJsonObjectBuilder implements JsonObjectBuilder {

  private final Map<String, JsonValue> jsonFragments;

  // other methods omitted for brevity

   public JsonObjectBuilder add(String name, JsonValue value) {
     if(jsonFragments.containsKey(name)) {
        JsonValue oldValue = jsonFragments.get(name);
        JsonArrayBuilder newBuilder = new JsonArrayBuilderImpl();
        if(oldValue instanceof JsonArray) {
            JsonArray theArray = (JsonArray) oldValue;
            for (JsonObject oldValues : theArray.getValuesAs(JsonObject.class)) {
                newBuilder.add(oldValues);
            }
        } else {
            newBuilder.add(oldValue);
        }
        newBuilder.add(value);
        jsonFragments.put(name, newBuilder.build());
     } else {
        jsonFragments.put(name, value);
     }
     return this;
   } 
```

# laravel - Laravel 4：如何在使用 Auth::login 登录时记住用户

> ID：15051979
> 
> 赞同：4
> 
> 时间：2013-02-24T13:02:54.307
> 
> 标签：laravel, laravel-4

我的用户可以使用社交选项（Facebook、Twitter）登录，所以我不使用该`Auth::attempt()`方法，但`Auth::login()`.

我怎样才能记住我的用户，这样他们就不必每次重新启动浏览器时都登录？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-24T13:09:47.963

它不在文档中，但是如果您查看代码；

```
public function login(UserInterface $user, $remember = false) 
```

所以就这样做

```
Auth::login($user, true); 
```

# jquery - JQuery Mobile：页面导航并不总是有效

> ID：15051986
> 
> 赞同：0
> 
> 时间：2013-02-24T13:03:31.073
> 
> 标签：jquery, asp.net-mvc, jquery-mobile

我正在使用 JQuery Mobile 和 MVC4。

**标记：**

```
<div data-role="page" data-theme="d" id="main">
    <div data-role="header">
        <h1>Test Page</h1>
    </div>
    <div data-role="content">
        <h2>Test Page</h2>

        <ul data-role="listview" data-inset="true">
            <li data-role="list-divider">Navigation</li>
            <li><a href="#Page1">Page 1</a></li>
            <li><a href="#Page2">Page 2</a></li>
        </ul>
    </div>
</div>

@Html.Partial("Page1")

@Html.Partial("Page2") 
```

假设这是在`localhost\subpage`. 当我直接导航到 时`localhost\subpage`，一切都很好，我可以在页面之间导航。但是，如果我通过链接从另一个页面转到此页面，则导航不再起作用..我无法导航到`#page1`或`#page2`不再..当我使用 Firebug 时，我可以看到页面甚至不在 DOM 中.. . 而在第一种情况下（直接 URL），我可以看到它们在那里但隐藏起来，因为它们应该是。

我在这里想念什么？

**编辑**

页面内容按要求：

```
<div data-role="page" data-theme="d" id="Page1" data-url="Page1">
    <div data-role="header">
        <h1>Page 1</h1>
    </div>
    <div data-role="content">
    <p>This is page 1</p>
</div> 
```

第2页与上面基本相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T11:13:42.550

解决方案是添加`data-ajax="false"`到锚标记。现在工作正常...

# python - 如何获取 exec 加载的任意变量，并在函数中使用它们

> ID：15051987
> 
> 赞同：0
> 
> 时间：2013-02-24T13:03:43.637
> 
> 标签：python, python-2.7, exec

我希望在[Codeacademy](http://www.codecademy.com/create/creator)上写一门基本的生物信息学课程。他们有一个很好的编写课程的界面，但是测试有点慢，因为必须保存，然后预览，然后运行。

所以我想写一个模仿他们的小测试环境。它的工作方式似乎是将用户输入代码作为字符串读入函数，`str`代码中的所有实例都转换为`unicode`（我刚刚为此使用了正则表达式），然后使用`exec`.

棘手的部分似乎是当我想合并[Submission Test](http://www.codecademy.com/docs/submission_tests)时。

提交测试需要返回`True`, `False`, 或 a `str`, 并且被写成函数的主体。例如：

我想要做的简化版本：

```
# The submission test must be a function.
def test_code(code, CC, error):
    # Use information from errors in student code
    if error:
        return "Yada yada %s" %error

    # Use information in the raw student code
    if len(code.split("\n")) is not 2:
        return "This should be accomplished in 2 lines"

    # Have direct access to variables from the student code
    # I'd like to avoid params['y'] if possible.
    try:
        y
    except NameError:
        return "Please use the variable y"

    if y is not 8:
        return "Wrong! Check stuff"

    # Use information from print output
    if str(y) not in CC:
        return "Remember to print your variable!"

    return True

# Read in student code
student_code = """y = 8
                  print y
                  potato"""

# Catch print output
CC = StringIO.StringIO()
sys.stdout = CC

# Execute student code and catch errors
try:
    exec student_code
except Exception as e:
    error = e

# Start outputting to the terminal again
sys.stdout = sys.__stdout__

# Run the submission test
submission_test = test_code(student_code, CC.split("\n"), error)

# Output the result of the submission test
if submission_test is True:
    print("Well done!")
elif submission_test is False:
    print("Oops! You failed... Try again!")
else:
    print(submission_test) 
```

但是，我似乎无法从中获取变量`exec code`以传递给提交测试函数（`test_code`在这种情况下）。

我可以在提交测试中执行代码，但如果可能的话，我想避免这种情况，否则必须将它添加到每个测试中，这看起来很不合python！

任何帮助将不胜感激 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:28:58.023

如果你`exec mystr in somedict`，那么在作为 Python 代码`somedict`执行期间分配的每个变量都有一个引用。`mystr`此外，您也可以通过这种方式传递变量。

```
>>> d = {'y': 3}
>>> exec "x = y" in d
>>> d['x']
3 
```

您需要传递从运行用户代码中获得的字典，以便提交检查代码可以验证其中的值是否合适。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T14:45:04.853

听起来您希望 the`code`和 the`test`在同一环境中运行。两者都作为字符串提交，所以也许最简单的方法是将两者连接起来并`exec`在组合字符串上运行：

```
from __future__ import unicode_literals

def wrap_body(body):
    indent = ' '*4
    return 'def test():\n' + indent + body.replace('\n','\n'+indent)    

code = '''
bool_1 = True
bool_2 = False

str_1 = 'Hello there!'
str_2 = "I hope you've noticed the apostrophe ;)"
'''

code_test = '''
try:
    bool_1, bool_2, str_1, str_2
except NameError:
    return "Please do not alter the variable names!"

if (bool_1 == bool_2 or str_1 == str_2):
    return "Please ensure that all of your variables are different " \
           "from one another"

if type(bool_1) != bool: return "bool_1 is incorrect"
if type(bool_2) != bool: return "bool_2 is incorrect"
if type(str_1) != unicode: return "str_1 is incorrect"
if type(str_2) != unicode: return "str_2 is incorrect"

return True
'''
code_test = wrap_body(code_test)
template = code + code_test
namespace = {}
try:
    exec template in namespace
    print(namespace['test']())
except Exception as err:
    print(err) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T04:50:11.670

好的，我的同事发现了这一点。

它使用了[Devin Jeanpierre](https://stackoverflow.com/users/18515/devin-jeanpierre)的回答元素。

我们使用该`exec code in dictionary`方法，然后将字典传递给检查函数，然后，在检查函数中，我们将字典解包到`globals()`.

```
# The submission test must be a function.
def test_code(code, CC, error, code_vars):

    # unpack the student code namespace into the globals()
    globs = globals()
    for var, val in code_vars.items():
        globs[var] = val

    # Use information from errors in student code
    if error:
        return "Yada yada %s" %error

    # Use information in the raw student code
    if len(code.split("\n")) is not 2:
        return "This should be accomplished in 2 lines"

    # Have direct access to variables from the student code
    # I'd like to avoid params['y'] if possible.
    try:
        y
    except NameError:
        return "Please use the variable y"

    if y is not 8:
        return "Wrong! Check stuff"

    # Use information from print output
    if str(y) not in CC:
        return "Remember to print your variable!"

    return True

# Read in student code
student_code = """y = 8
                  print y
                  potato"""

# Catch print output
CC = StringIO.StringIO()
sys.stdout = CC

# create the namespace for the student code
code_vars = {}

# Execute student code and catch errors
try:
    # execute the student code in the created namespace
    exec student_code in code_vars
except Exception as e:
    error = e

# Start outputting to the terminal again
sys.stdout = sys.__stdout__

# Run the submission test
submission_test = test_code(student_code, CC.split("\n"), error, code_vars)

# Output the result of the submission test
if submission_test is True:
    print("Well done!")
elif submission_test is False:
    print("Oops! You failed... Try again!")
else:
    print(submission_test) 
```

# java - 在 Java 中恢复到旧的对象状态

> ID：15051988
> 
> 赞同：1
> 
> 时间：2013-02-24T13:03:44.957
> 
> 标签：java, oop

我只是在学习 Java，但我一遍又一遍地遇到同样的问题

如何有效地恢复到某个对象的旧状态？

```
public class Example {
    MyObject myLargeObject;

    public void someMethod(){
        MyObject myLargeMyObjectRecovery = myLargeObject;

        /**
         * Update and change myLargeObject
         */

        if(someCondition){
            //revert to previous state of myLargeObject
            myLargeObject = myLargeMyObjectRecovery;
        }
    }
} 
```

以上是我希望代码如何工作，但显然不是，因为 myLargeObject 和 myLargeObjectRecovery 是对同一个对象的引用。

一种解决方案是创建一个复制构造函数。这对于小对象来说很好，但如果我有一个大对象（在我的项目中，对象是一个大的二维数组，这意味着我必须遍历所有条目），这种方式感觉不对。

这在Java中一定是一个很常见的问题，其他人是怎么解决的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:05:15.917

正如您所指出的，要么是深拷贝，要么可能是序列化。您可以存储一个序列化的字符串，然后稍后再从中重建对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T14:31:03.567

[备忘录模式](http://www.oodesign.com/memento-pattern.html)解决了恢复到先前状态问题的设计问题。当您需要捕获对象的一个​​或多个状态并能够恢复到它们时，这种方法很有用。将其视为 N 步撤消操作，就像在文本编辑器中一样。

在该模式中，您有一个有状态的对象`Originator`，它负责保存和恢复其状态的快照。状态本身保存在一个名为 的包装类中`Memento`，这些类存储在`CareTaker`.

在这种方法中，最简单的想法是深度复制您的对象。然而，这在性能和空间方面可能效率低下，因为您存储整个对象而不仅仅是更改集。

一些对象持久性库提供事务和快照的实现。看看[Prevayler](http://prevayler.org/)，它是 Java 的对象持久性库和[流行系统模式](http://en.wikipedia.org/wiki/System_Prevalence)的实现。该库以事务的形式捕获对对象的更改并将它们存储在内存中。如果您需要持久存储 POJO，您可以定期将对象的快照保存在磁盘上，并在需要时恢复它们。

您可以在这个 SO 问题中找到有关序列化 POJO 的更多信息：[Is there a object-change-tracking/versioning Java API out there？](https://stackoverflow.com/questions/10044476/is-there-a-object-change-tracking-versioning-java-api-out-there)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T13:26:54.277

最佳解决方案取决于您是否有对`MyObject`实例的外部引用。

如果你只使用`myLargeObject` **from`Example`类**，你可以使用

*   在保存点序列化您的对象，并在还原点反序列化（序列化的`byte[]`必须是`transient`）
*   在保存点使用复制构造函数（进行深度复制）创建一个新实例，并在还原点替换引用。

**如果您可以从外部**访问`MyObject`实例，那么它会变得更有趣，您必须引入同步。

 ***   你所有的方法都`MyObject`必须是`synchronized`（以避免不一致的读取）
*   您应该有一个`synchronized void saveState()`保存状态的方法（通过*序列化*或*复制构造函数*）（后者更好）
*   您应该有一个`synchronized void restoreState()`, 在其中内部恢复您的状态（对于复制字段，您可以使用带有复制构造函数的通用代码片段）

在所有情况下，建议在某个时候*关闭事务*（类型`commit()`），这意味着当您到达那里时，您可以删除已保存的状态。

此外，非常重要的是，如果你有一个底层数据结构，**你应该为它遍历整个结构**。否则，您可能会遇到对象引用问题。

小心*JPA 实体*或任何外部管理的对象，这些方法中的任何一个都不太可能与它们一起使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T13:51:20.833

如果将一个对象分配给另一个对象，jvm 会引用内存中的同一个对象。因此，对象上的更改将在引用的其他 objetc 中。

```
MyObject myLargeMyObjectRecovery = myLargeObject; 
```

在您的代码中也是如此。`myLargeMyObjectRecovery`并`myLargeObject`引用内存中的相同对象。

如果要精确复制任何对象，可以使用 Object.clone() 方法。此方法将复制对象并返回一个对象，该对象引用另一个对象，其字段及其值与复制的对象相同。

由于克隆方法受到保护，因此您无法直接访问它。您可以根据您的要求实现原型模式。

[http://www.avajava.com/tutorials/lessons/prototype-pattern.html](http://www.avajava.com/tutorials/lessons/prototype-pattern.html)

```
public class MyObject{

//fields, getters, setters and other methods.

public MyObject doClone()
    {
        MyObject clonedObject = this.clone(); //you may need to override clone()depending on your requirements.
return clonedObject;
    }

    } 
```

并在您的代码中调用它

```
MyObject myLargeMyObjectRecovery = myLargeObject.doClone(); 
```**

# box2d-iphone - 是否可以将一个物体从两侧连接到不同的静态物体

> ID：15051993
> 
> 赞同：2
> 
> 时间：2013-02-24T13:04:28.060
> 
> 标签：box2d-iphone, revolute-joints

```
 b2Body* foundation =[self createStaticBodyAtLocation:CGPointMake(15, 15) withSize:CGSizeMake(35, 35)];
    b2Body* beam=[self createDynamicBodyAtLocation:CGPointMake(105, 35) withSize:CGSizeMake(150, 10)];
    b2RevoluteJointDef revoluteJointDef;
    revoluteJointDef.Initialize(foundation, beam, b2Vec2(30.0/PTM_RATIO,30.0/PTM_RATIO));
    _world->CreateJoint(&revoluteJointDef); 
```

上面的代码创建了一个静态体和一个动态体，然后用一个 revolutejoint 将它们连接起来。这是我得到的：

![添加第二个静态体之前](../Images/1f4f19a0078f22d8856d0219b0fceeab.png)

然后我添加以下几行来添加另一个主体，这是一个静态圆圈，然后将圆圈和之前添加的栏连接到栏的另一端。

```
 b2Body *jointBall=[self createCircleAtLocation:CGPointMake(160, 135)];
    revoluteJointDef.Initialize(jointBall, beam, b2Vec2(100.0/PTM_RATIO,10.0/PTM_RATIO));
    _world->CreateJoint(&revoluteJointDef); 
```

但这是我得到的：

![添加第二个静态体后](../Images/423b399cac2ce8d2bf08f2cf32a81db9.png)

添加圆圈后，我无法移动栏。它是固定的。但我希望它加入这个圈子。我试图将锚点更改为不同的位置，但没有帮助。我错过了什么？也许不可能将一个动态物体连接到多个静态物体上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T16:32:52.730

来自 box2d 手册：

> 所有关节都连接在两个不同的身体之间。**一个物体可能是静止的。**
> 
> 您可以手动移动静态物体，但您应该小心，以免在两个或多个静态物体之间挤压动态物体

您在这里有效地完成了将杆体挤压在两个带有旋转接头的静态体之间。**静态物体根本**无法移动，因此您看到的输出实际上是有道理的。第一个旋转接头（连接箱和杆）允许杆的远端移动（旋转）。然而，当这个远端通过另一个限制除了旋转之外的所有运动的关节连接到另一个静态物体时，它就不能再移动了。因此，在将杆体与两个不同的静态体连接后，杆体的旋转将变得固定是有道理的。

我搜索了 box2d 代码，没有找到任何直接设置通过关节连接的身体旋转的东西。

你想做什么？看起来你可能试图让球随着杆的末端移动，在这种情况下，我建议让球成为一个动态的物体（这样它就可以移动）。此外，根据您的操作，焊接接头可能更合适。

# node.js - 安全签名算法的兼容性

> ID：15051996
> 
> 赞同：1
> 
> 时间：2013-02-24T13:04:42.927
> 
> 标签：node.js, openssl, rsa, signature, botan

经过一些研究，似乎建议使用带有 PSS 填充的 RSA，因为它的安全属性众所周知是好的。问题是签名算法很难*兼容*，尤其是有这样的要求。

我想要实现的是至少在以下环境中进行签名和验证：

*   牡丹
*   OpenSSL
*   加密++
*   Node.js（使用 OpenSSL）

在 PolarSSL 和其他方面具有兼容性也可能很有趣。

`node.js`加密页面中有一个关于创建和验证签名的示例。这很好用，但我需要与 Botan EMSAx(SHA256) 兼容，并且真的认为应该使用 RSA-PSS 之类的东西来填充签名以确保安全。Node 示例页面仅显示`'RSA-SHA256'`，但没有使用填充。

PSS 填充可以通过使用 OpenSSL 来实现：

```
openssl dgst -sha256 -sigopt rsa_padding_mode:pss -sigopt rsa_pss_saltlen:32 \
 -sign rsa.key -out data.txt.sha256 data.txt 
```

我的测试代码如下所示：

```
var s = crypto.createSign('RSA-SHA256');
var key = fs.readFileSync('rsa.key').toString();

s.update(message);

var signature = s.sign(key, 'base64'); 
```

但它为相同的输入产生相同的输出，这不是我想要的，并且显然与我使用 Botan 的 C++ 实现不兼容。

如果不可能以最小的努力实现兼容性，关于选择哪种算法的任何建议，我可能会努力尝试联系这些加密库的开发人员，看看是否有任何关于算法的共识得到作为事实上的标准实施。（是的，我知道这看起来很绝望。）是否有这样的持续努力？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T19:16:00.020

您当前正在使用 PSS 签名格式，而 Node.js 几乎可以肯定使用 PKCS#1 v1.5 兼容签名 - 如果我查看当前代码，Node.js 似乎仅限于这些。一个区别确实是 PSS 生成的签名包含随机组件，而 PKCS#1 v1.5 兼容的签名不包含。

尽管肯定首选 PSS 签名，但您似乎唯一的选择是恢复为 Botan 的 PKCS#1 v1.5 兼容签名，或者在 Node.js 中实现 PSS 签名。PKCS#1 v1.5 签名应该仍然是安全的，即使它们与 PSS 签名相比具有不太理想的属性。

# android - 更改描边颜色会更改以前的描边颜色

> ID：15051999
> 
> 赞同：1
> 
> 时间：2013-02-24T13:04:47.657
> 
> 标签：android, colors, android-canvas, paint, android-image

我正在尝试制作一个 android 儿童着色书应用程序，当我第一次用一种颜色绘图时它可以，但是当我改变画笔颜色时，所有以前的颜色也会改变颜色。有什么办法可以解决这个问题？

开始用一种颜色绘画： ![在此处输入图像描述](../Images/186a0e5e152645b1bc9fd076a025788e.png)

更改颜色并进行另一次描边后，会发生这种情况

![在此处输入图像描述](../Images/d8ece229b9a017ef2fbe97df3cfdabc6.png)

这是用于此绘图表面的 SignatureView 类：

```
public class SignatureView extends View {

    private float STROKE_WIDTH = 5;

    /** Need to track this so the dirty region can accommodate the stroke. **/
    private final float HALF_STROKE_WIDTH = STROKE_WIDTH / 2;

    private Paint paint = new Paint();
    private Path path = new Path();

    /**
     * Optimizes painting by invalidating the smallest possible area.
     */
    private float lastTouchX;
    private float lastTouchY;
    private final RectF dirtyRect = new RectF();

    public SignatureView(Context context, AttributeSet attrs) {
        super(context, attrs);
        paint.setAntiAlias(true);
        paint.setColor(Color.CYAN);
        paint.setStyle(Paint.Style.STROKE);
        paint.setStrokeJoin(Paint.Join.ROUND);
        paint.setStrokeWidth(STROKE_WIDTH);
    }

    public float getBrushSize() {
        return STROKE_WIDTH;
    }

    public void setBrushSize(float brushSize) {
        this.STROKE_WIDTH = brushSize;
    }

    public void setColor(int color) {
        paint.setColor(color);
    }

    /**
     * Erases the signature.
     */
    public void clear() {
        path.reset();

        // Repaints the entire view.
        invalidate();
    }

    @Override
    protected void onDraw(Canvas canvas) {
        canvas.drawPath(path, paint);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        float eventX = event.getX();
        float eventY = event.getY();

        switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            path.moveTo(eventX, eventY);
            lastTouchX = eventX;
            lastTouchY = eventY;
            // There is no end point yet, so don't waste cycles invalidating.
            return true;

        case MotionEvent.ACTION_MOVE:
        case MotionEvent.ACTION_UP:
            // Start tracking the dirty region.
            resetDirtyRect(eventX, eventY);

            // When the hardware tracks events faster than they are delivered,
            // the
            // event will contain a history of those skipped points.
            int historySize = event.getHistorySize();
            for (int i = 0; i < historySize; i++) {
                float historicalX = event.getHistoricalX(i);
                float historicalY = event.getHistoricalY(i);
                expandDirtyRect(historicalX, historicalY);
                path.lineTo(historicalX, historicalY);
            }

            // After replaying history, connect the line to the touch point.
            path.lineTo(eventX, eventY);
            break;

        default:
            // Log.("Ignored touch event: " + event.toString());
            return false;
        }

        // Include half the stroke width to avoid clipping.
        invalidate((int) (dirtyRect.left - HALF_STROKE_WIDTH),
                (int) (dirtyRect.top - HALF_STROKE_WIDTH),
                (int) (dirtyRect.right + HALF_STROKE_WIDTH),
                (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

        lastTouchX = eventX;
        lastTouchY = eventY;

        return true;
    }

    /**
     * Called when replaying history to ensure the dirty region includes all
     * points.
     */
    private void expandDirtyRect(float historicalX, float historicalY) {
        if (historicalX < dirtyRect.left) {
            dirtyRect.left = historicalX;
        } else if (historicalX > dirtyRect.right) {
            dirtyRect.right = historicalX;
        }
        if (historicalY < dirtyRect.top) {
            dirtyRect.top = historicalY;
        } else if (historicalY > dirtyRect.bottom) {
            dirtyRect.bottom = historicalY;
        }
    }

    /**
     * Resets the dirty region when the motion event occurs.
     */
    private void resetDirtyRect(float eventX, float eventY) {

        // The lastTouchX and lastTouchY were set when the ACTION_DOWN
        // motion event occurred.
        dirtyRect.left = Math.min(lastTouchX, eventX);
        dirtyRect.right = Math.max(lastTouchX, eventX);
        dirtyRect.top = Math.min(lastTouchY, eventY);
        dirtyRect.bottom = Math.max(lastTouchY, eventY);
    }

    public int getColor() {
        return paint.getColor();
    }

} 
```

我正在使用更改颜色

```
public void colorpicker() {
        AmbilWarnaDialog dialog = new AmbilWarnaDialog(this,
                signature.getColor(), new OnAmbilWarnaListener() {

                    @Override
                    public void onCancel(AmbilWarnaDialog dialog) {
                    }

                    @Override
                    public void onOk(AmbilWarnaDialog dialog, int color) {
                        signature.setColor(color);
                    }
                });
        dialog.show();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:22:29.717

为每个笔划使用新的路径和绘画对象。

或者，一旦您抬起手指，将路径渲染到位图并使用它进行绘图。

```
Bitmap drawing;
final Path path = new Path();

public void onMeasure(int widthMeasureSpec, int heightMeasureSpec){
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    Bitmap newDrawing = Bitmap.createBitmap(getMeasuredWidth(), getMeasuredHeight(), Config.ARGB_8888);
    if(drawing != null){
        Canvas c = new Canvas(newDrawing);
        c.drawBitmp(drawing);
    }
    drawing = newDrawing;
}

public boolean onTouchEvent(MotionEvent e){
    int action = e.getAction();
    if(action == MotionEvent.ACTION_DOWN){
        path.reset();
    }else if(MotionEvent.ACTION_MOVE){
        if(path.isEmpty()){
            path.moveTo(e.getX(), e.getY());
        }else{
            path.lineTo(e.getX(), e.getY());
        }
    }else if(MotionEvent.ACTION_UP){
        drawing.drawPath(path);
    }
} 
```